# StackOverflow 问答 16095000-16095999

# javascript - 为什么切换可能不起作用？

> ID：16095001
> 
> 赞同：-1
> 
> 时间：2013-04-18T23:52:34.347
> 
> 标签：javascript, html, wordpress

[此页面](http://wowballoons.com/wb/#)在“我们为什么这么好”部分中有切换功能。他们突然停止了工作。我不知道从那以后会发生什么变化。[这](http://themeforest.unitedthemes.com/wpversions/nevada/1/?color_scheme=F55D2D)就是他们通常的工作方式。

有人可以解释一下切换一般是如何工作的，为什么它们现在不起作用？

（另外，有什么方法可以找出 JavaScript 正在改变文档吗？）

编辑：prettyPhoto 是一个完全不相关的脚本，它做灯箱的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:09:26.963

您的应用程序中缺少该`http://wowballoons.com/wb/wp-content/themes/nevada/nevada/javascripts/jquery.prettyPhoto.js?ver=1.3`文件，这就是它无法正常工作的原因。

请下载[prettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/documentation/)脚本文件并将其添加到您的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:07:21.700

您在 html 页面上有一个脚本错误：

```
$("a[data-rel^='prettyPhoto']").prettyPhoto({ 
```

TypeError: $(...).prettyPhoto 不是函数

# wordpress - 如何将现有附件附加到帖子？

> ID：16095005
> 
> 赞同：0
> 
> 时间：2013-04-18T23:53:20.567
> 
> 标签：wordpress

我有一个保存的附件（它作为“附件”类型的帖子存储在数据库中）。它不附加到任何帖子。如何将其附加到某些帖子（或页面）？

使用 WordPress 3.5.1

**编辑：**
当然是使用 PHP。

# string - Excel 中的父目录（无 VBA）

> ID：16095006
> 
> 赞同：1
> 
> 时间：2013-04-18T23:53:33.143
> 
> 标签：string, excel, search, directory, excel-formula

如何将单元格的值设置为文件所在目录的父级？

我面临着一项乏味且重复的任务，我正在尝试尽可能多地自动化这些任务——但不允许使用 VBA。

我将有一个 Excel 电子表格的目录树，看起来像这样：

```
C:\…\Parent1\Dir2\File3.xlsx
   …\Parent4\Dir5\File6.xlsx
   … 
```

我需要一个公式来提取*父*目录，*例如*，`Parent1`或`Parent4`在本例中。

[*注意*：*文件和目录名称不遵循任何特定约定；查找数字的建议将与此匿名示例匹配，但对我没有帮助。*]

* * *

笔记：

我在网上的其他地方找到了以下公式，我也需要它并且可能指向解决方案。

*   当前工作表名称：
    `= RIGHT(CELL("filename",A1), LEN(CELL("filename",A1)) - FIND("]", CELL("filename",A1)))`

*   当前文件名：
    `= MID(CELL("filename",A1), FIND("[", CELL("filename",A1)) + 1, FIND(".", CELL("filename",A1)) - (FIND("[", CELL("filename",A1)) + 1))`

*   当前目录名称（来自[MrExcel.com](http://www.mrexcel.com/forum/excel-questions/360121-formula-display-parent-folder-name-2.html#post1780788)）：
    `= TRIM(RIGHT(SUBSTITUTE(LEFT(CELL("filename",A1), FIND("[", CELL("filename",A1), 1) - 2), "\", REPT(" ",100)), 100))`
    发帖人解释了他的方法：

    > 它通过获取 DIR 并将所有“\”替换为 100 个空格来工作。然后它会抓取正确的 100 个字符，这将是一堆空格和最终的 DIR 名称，然后它会修剪掉前面的空格。

最后这个感觉应该可以适配提取父目录了，但是我还没想好这个适配怎么写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:23:00.507

尝试这个。没有说这个公式只能在`saved`文件中使用。

`=TRIM(LEFT(RIGHT(SUBSTITUTE(LEFT(CELL("filename",A1), FIND("[", CELL("filename",A1), 1) - 2),"\",REPT(" ",100)),200),100))`

**截图**：

![在此处输入图像描述](https://i.stack.imgur.com/O9LRp.png)

**逻辑**：

要查找两个字符之间的字符串，请使用它。（在说“\”之间查找）

```
=TRIM(LEFT(RIGHT(SUBSTITUTE(A1,"\",REPT(" ",100)),200),100)) 
```

下面给出了完整的路径

```
=LEFT(CELL("filename",A1), FIND("[", CELL("filename",A1), 1) - 2) 
```

例如：`C:\Temp\Folder 1`

所以只需在第一个公式中插入第二个

# c# - 定位 XML 中的值

> ID：16095014
> 
> 赞同：1
> 
> 时间：2013-04-18T23:54:19.940
> 
> 标签：c#, xml, linq-to-xml

我有一个加载到 XDocument 中的 xml 文件，我需要从中提取一个值，但我不确定最好的方法。我想出的大多数东西似乎都是矫枉过正或没有很好地利用 xml 规则。我有以下 xml 片段：

```
 <entry>
      <observation classCode="OBS" moodCode="EVN">
        <templateId root="2.16.840.1.113883.10.20.6.2.12" />
        <code code="121070" codeSystem="1.2.840.10008.2.16.4" codeSystemName="DCM" displayName="Findings">
        </code>
        <value xsi:type="ED">
          <reference value="#121071">
          </reference>
        </value>
      </observation>
    </entry> 
```

可以有任意数量的`<entry>`节点，它们都将遵循类似的模式。`root`元素属性下的值`templateId`包含一个已知的 UID，该 UID 将该条目标识为我想要的条目。我需要得到参考值。

我的想法是找到正确的templateID节点，回到观察节点，找到`<valuexsi:type="ED">`然后得到参考值。这似乎过于复杂，我想知道是否有另一种方法可以做到这一点？

编辑

我收到的 xml 有时可以将 xml 嵌套在相同的节点名下。换句话说，`<observation>`可能位于另一个名为 的节点下`<observation>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:37:51.963

您有问题，因为您的文档使用命名空间，而您的查询缺少它们。

首先，您必须`xsi`在 XML 中的某处（可能在最顶层元素中）找到命名空间声明。

它看起来像这样：

```
xmlns:xsi="http://test.namespace" 
```

取命名空间 Uri 并`XNamespace`根据它的值创建实例：

```
var xsi = XNamespace.Get("http://test.namespace"); 
```

`xsi`并在您的查询中使用该变量：

```
var query = from o in xdoc.Root.Element("entries").Elements("entry").Elements("observation")
            let tId = o.Element("templateId")
            where tId != null && (string)tId.Attribute("root") == "2.16.840.1.113883.10.20.6.2.12"
            let v = o.Element("value")
            where v != null && (string)v.Attribute(xsi + "type") != null
            let r = v.Element("reference")
            where r != null
            select (string)r.Attribute("value");

var result = query.FirstOrDefault(); 
```

我已经针对以下 XML 结构对其进行了测试：

```
<root xmlns:xsi="http://test.namespace">
  <entries>
    <entry>
      <observation classCode="OBS" moodCode="EVN">
        <templateId root="2.16.840.1.113883.10.20.6.2.12" />
        <code code="121070" codeSystem="1.2.840.10008.2.16.4" codeSystemName="DCM" displayName="Findings">
        </code>
        <value xsi:type="ED">
          <reference value="#121071">
          </reference>
        </value>
      </observation>
    </entry>
  </entries>
</root> 
```

查询`#121071`为它返回。

对于您的输入 XML，您可能必须更改第一行查询：

```
from o in xdoc.Root.Element("entries").Elements("entry").Elements("observation") 
```

匹配`<observation>`XML 结构中的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:59:33.977

您可能必须在 LINQ 中包含命名空间。要检索它，您将执行以下操作：

```
XNamespace ns = xdoc.Root.GetDefaultNamespace(); 
```

然后在你的 linq 中：

```
var obsvlookfor = xdoc.Root.Descendants(ns + "observation") 
```

我知道如果没有这个，我在检索数据时遇到了一些问题。并不是说它只是要记住的问题，特别是如果您的 XML 文件非常深入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:13:32.600

以下内容会有所帮助吗？

```
 XDocument xdoc = GetYourDocumentHere();
   var obsvlookfor =
       xdoc.Root.Descendants("observation")
           .SingleOrDefault(el => 
                el.Element("templateId")
                    .Attribute("root").Value == "root value to look for");

   if (obsvlookfor != null)
   {
       var reference = obsvlookfor
           .Element("value")
           .Element("reference").Attribute("value").Value;
   } 
```

我的想法如下：

1.  拉出文档中的所有观察元素
2.  找到观察`templateId`元素具有`root`您正在寻找的属性的唯一一个（或空）
3.  如果您找到该观察元素，请针对该元素下的元素拉出`value`属性。`reference``value`

# python - 字符串格式运算符错误 %

> ID：16095016
> 
> 赞同：1
> 
> 时间：2013-04-18T23:54:28.923
> 
> 标签：python, string

已经研究了一段时间，似乎无法找到解决方案。我开始认为可能没有。请注意，我仍在自学 Python，因此我可能缺少一个简单的解决方案。

这是行：

```
time = time.strftime("%Y%m%d-%H%M%S")
 sys.stdout = open('/home/username/logfilesgohere/%s', % time 'w') 
```

我正在尝试使标准输出写入的文件根据**时间**变量反映当前时间戳。这在带有反引号的 bash 中很容易做到，但我是一个 python 新手。另请注意，我在我的 fabfile 中使用它来制作面料。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:00:46.517

您只是将逗号放在错误的位置。这就是你想要的：

```
sys.stdout = open('/home/username/logfilesgohere/%s' % time, 'w') 
```

这段代码

```
'/home/username/logfilesgohere/%s' % time 
```

将构建完整的文件名字符串。

# delphi - TStringGrid 中的箭头指针

> ID：16095020
> 
> 赞同：2
> 
> 时间：2013-04-18T23:54:56.920
> 
> 标签：delphi, delphi-7

是否可以将该箭头指针添加到 Delphi 7 中的 String Grind 中？您知道我的意思，您可以在 DBGrid 左侧看到的那个箭头指针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:18:30.750

是的，但不是自动的。您需要手动显示一个三角形。您可以为您的网格覆盖**OnDrawCell**。看来您需要将**FixedCols**设置为 0，因为当行选择发生更改时，它似乎不会再次重绘固定单元格。

```
procedure TForm1.StringGrid1DrawCell(Sender: TObject; ACol, ARow: Integer;
  Rect: TRect; State: TGridDrawState);
var
  aCanvas: TCanvas;
  oldColor: TColor;
  triangle: array [0..2] of TPoint;
const
  spacing = 4;
begin
  if (ACol = 0) and (aRow = StringGrid1.Row) then
  begin
    aCanvas := (Sender as TStringGrid).Canvas;  // To avoid with statement
    oldColor := aCanvas.Brush.Color;
    // Shape the triangle
    triangle[0] := TPoint.Create(Rect.Left + spacing, Rect.Top + spacing);
    triangle[1] := TPoint.Create(Rect.Left + spacing, Rect.Top + Rect.Height - spacing);
    triangle[2] := TPoint.Create(Rect.Left + Rect.Width - spacing, Rect.Top + Rect.Height div 2);

    // Draw the triangle
    aCanvas.Pen.Color := clBlack;
    aCanvas.Brush.Color := clBlack;
    aCanvas.Polygon(triangle);
    aCanvas.FloodFill(Rect.Left + Rect.Width div 2, Rect.Top + Rect.Height div 2, clBlack, fsSurface);
    aCanvas.Brush.Color := oldColor;
  end;
end; 
```

这会在框中绘制一个三角形。你应该得到一般的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:09:28.520

不是自动的；它不是标准的一部分`TStringGrid`。“箭头指针的东西”被称为`row indicator`，它是在`TDBGrid`. 它在 中声明`TDBGridOptions`，具体`dgIndicator`如下所示：

```
TDBGridOption = (dgEditing, dgAlwaysShowEditor, dgTitles, dgIndicator,
    dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect,
    dgAlwaysShowSelection, dgConfirmDelete, dgCancelOnExit, dgMultiSelect); 
```

请注意，这与单元中`TGridOption`声明的不同`Grids`，后者不包含任何类似内容。（没有`goIndicator`或等效的。）

为了获得指标，您必须自己绘制它，`OnDrawCell`以防您收到与该`ACol`值相等的值。在[这个答案](https://stackoverflow.com/a/8602877/62576)中有一个示例，尽管它演示了设置自定义行高而不是绘制行指示器。`0``ARow``Grid.Row``TStringGrid.OnDrawCell`

# c# - Monotouch iphone 自定义 UITableView

> ID：16095021
> 
> 赞同：0
> 
> 时间：2013-04-18T23:55:05.597
> 
> 标签：c#, iphone, uitableview, xamarin.ios, xamarin

我按照[本](http://www.arcticmill.com/2012/05/uitableview-with-custom-uitableviewcell.html)教程创建了一个自定义单元格。

我在 Interface Builder 中创建了一个自定义单元格，如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/n20jo.png)

在我的 ViewController 中，我添加了一个 UITableView 并将其绑定到数据：

```
myTable.Source = new ListSource(); 
```

ListSource 的 GetCell 方法：

```
public override UITableViewCell GetCell (UITableView tableView, MonoTouch.Foundation.NSIndexPath indexPath)
    { 
        // Reuse a cell if one exists 
        CustomListCell cell = tableView.DequeueReusableCell ("QCell") as CustomQuestionsListCell;

        if (cell == null)
        {  
            // We have to allocate a cell 
            var views = NSBundle.MainBundle.LoadNib ("CustomListCell", tableView, null); 
            cell = Runtime.GetNSObject (views.ValueAt (0)) as CustomListCell;
        } 

        return cell; 
    } 
```

问题是最后的显示是这样的：

![在此处输入图像描述](https://i.stack.imgur.com/0emJ6.png)

似乎有某种重叠。任何想法为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:12:59.643

您需要将表格视图设置[`RowHeight`](http://iosapi.xamarin.com/?link=P%3aMonoTouch.UIKit.UITableView.RowHeight)为 IB 中的任何视图高度。这应该是`myTable.RowHeight = ...`。

如果每行有不同的高度，则可以[`GetHeightForRow`](http://iosapi.xamarin.com/?link=M%3aMonoTouch.UIKit.UITableViewDelegate.GetHeightForRow%28MonoTouch.UIKit.UITableView%2cMonoTouch.Foundation.NSIndexPath%29)在委托中使用，但这要慢得多，导致表格视图在第一次渲染之前遍历所有单元格（因此它可以计算滚动高度）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:50:18.363

您需要为您在项目中使用的自定义单元设置 RowHeight。由于您没有提供任何 height ，因此 Table 将默认分配给 TableViewCell 。您提供的 RowHeight 应与 Interface Builder (IB) 中的相同。

# camera - Unity3D - 自上而下的相机逻辑在使用 Transform.LookAt 时被锁定

> ID：16095025
> 
> 赞同：1
> 
> 时间：2013-04-18T23:55:52.170
> 
> 标签：camera, unity3d, unityscript

我已经根据 Unity3D 的 ThirdPersonCamera.js 脚本编写了一个自定义的自上而下的相机逻辑脚本。一切似乎工作正常，相机在 XZ 平面上跟随目标玩家，甚至在玩家跳跃时适当地沿着 Y 轴移动。

只有相机没有看玩家。所以我尝试在 cameraTransform 上使用 Transform.LookAt() 让相机直接向下看播放器。这确实会导致相机正确地直接向下看播放器，但是通过 WASD 移动不再起作用。玩家只是坐在那里。不过，使用空格键进行跳跃仍然有效。

这对我来说没有意义，相机变换的方向应该如何影响玩家对象的移动？

我的脚本的代码如下：

```
// The transform of the camera that we're manipulating
var cameraTransform : Transform;

// The postion that the camera is currently focused on
var focusPosition = Vector3.zero;

// The idle height we are aiming to be above the target when the target isn't moving
var idleHeight = 7.0;

// How long should it take the camera to focus on the target on the XZ plane
var xzSmoothLag = 0.3;

// How long should it take the camera to focus on the target vertically
var heightSmoothLag = 0.3;

private var _target : Transform;
private var _controller : ThirdPersonController;

private var _centerOffset = Vector3.zero;
private var _headOffset = Vector3.zero;
private var _footOffset = Vector3.zero;

private var _xzVelocity = 0.0;
private var _yVelocity  = 0.0;
private var _cameraHeightVelocity = 0.0;

// ===== UTILITY FUNCTIONS =====

// Apply the camera logic to the camera with respect for the target
function process()
{
    // Early out if we don't have a target
    if ( !_controller )
        return;

    var targetCenter = _target.position + _centerOffset;
    var targetHead   = _target.position + _headOffset;
    var targetFoot   = _target.position + _footOffset;

    // Determine the XZ offset of the focus position from the target foot
    var xzOffset = Vector2(focusPosition.x, focusPosition.z) - Vector2(targetFoot.x, targetFoot.z);

    // Determine the distance of the XZ offset
    var xzDistance = xzOffset.magnitude;

    // Determine the Y distance of the focus position from the target foot
    var yDistance = focusPosition.y - targetFoot.y;

    // Damp the XZ distance
    xzDistance = Mathf.SmoothDamp(xzDistance, 0.0, _xzVelocity, xzSmoothLag);

    // Damp the XZ offset
    xzOffset *= xzDistance;

    // Damp the Y distance
    yDistance = Mathf.SmoothDamp(yDistance, 0.0, _yVelocity, heightSmoothLag);

    // Reposition the focus position by the dampened distances
    focusPosition.x = targetFoot.x + xzOffset.x;
    focusPosition.y = targetFoot.y + yDistance;
    focusPosition.z = targetFoot.z + xzOffset.y;

    var minCameraHeight = targetHead.y;
    var targetCameraHeight = minCameraHeight + idleHeight;

    // Determine the current camera height with respect to the minimum camera height
    var currentCameraHeight = Mathf.Max(cameraTransform.position.y, minCameraHeight);

    // Damp the camera height
    currentCameraHeight = Mathf.SmoothDamp( currentCameraHeight, targetCameraHeight, _cameraHeightVelocity, heightSmoothLag );

    // Position the camera over the focus position
    cameraTransform.position = focusPosition;
    cameraTransform.position.y = currentCameraHeight;

// PROBLEM CODE - BEGIN

    // Have the camera look at the focus position
    cameraTransform.LookAt(focusPosition, Vector3.forward);

// PROBLEM CODE - END

    Debug.Log("Camera Focus Position: " + focusPosition);
    Debug.Log("Camera Transform Position: " + cameraTransform.position);
}

// ===== END UTILITY FUNCTIONS =====

// ===== UNITY FUNCTIONS =====

// Initialize the script
function Awake( )
{
    // If the camera transform is unassigned and we have a main camera, 
    //   set the camera transform to the main camera's transform
    if ( !cameraTransform && Camera.main )
        cameraTransform = Camera.main.transform;

    // If we don't have a camera transform, report an error
    if ( !cameraTransform )
    {
        Debug.Log( "Please assign a camera to the TopDownThirdPersonCamera script." );
        enabled = false;    
    }

    // Set the target to the game object transform
    _target = transform;

    // If we have a target set the controller to the target's third person controller
    if ( _target )
    {
        _controller = _target.GetComponent( ThirdPersonController );
    }

    // If we have a controller, calculate the center offset and head offset
    if ( _controller )
    {
        var characterController : CharacterController = _target.collider;
        _centerOffset = characterController.bounds.center - _target.position;
        _headOffset = _centerOffset;
        _headOffset.y = characterController.bounds.max.y - _target.position.y;
        _footOffset = _centerOffset;
        _footOffset.y = characterController.bounds.min.y - _target.position.y;
    }
    // If we don't have a controller, report an error
    else
        Debug.Log( "Please assign a target to the camera that has a ThirdPersonController script attached." );

    // Apply the camera logic to the camera
    process();
}

function LateUpdate( )
{
    // Apply the camera logic to the camera
    process();
}

// ===== END UNITY FUNCTIONS ===== 
```

我已经用**问题代码**注释标记了问题代码部分。如果问题代码被删除，它允许 WASD 移动再次工作，但相机不再注视目标。

非常感谢您对此问题的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:49:30.897

我想通了，问题出在我使用的 ThirdPersonController.js 脚本上。在函数 UpdateSmoothedMovementDirection() 中，ThirdPersonController 使用 cameraTransform 来确定沿 XZ 平面的前进方向，基于相机正在查看的位置。这样做时，它会将 Y 轴归零并归一化剩余的内容。

我在自定义 TopDownCamera.js 脚本中执行的 cameraTransform.LookAt() 调用让相机直接向下看 Y 轴。因此，当 ThirdPersonController 抓住它并将 Y 轴归零时，我的前向方向为零，这导致 XZ 运动无处可去。

复制 ThirdPersonController.js 并更改代码，以便：

```
var forward = cameraTransform.TransformDirection(Vector3.forward);
forward.y = 0;
forward = forward.normalized; 
```

变成：

```
forward = Vector3.forward; 
```

解决了这个问题。

# c# - 从 YUIBuild 文件访问其他 XML 值

> ID：16095026
> 
> 赞同：0
> 
> 时间：2013-04-18T23:55:57.280
> 
> 标签：c#, asp.net, visual-studio-2010, msbuild, yui

我已经为缩小过程集成了 YUI MSBuild。在为 YUI 定义的 Build xml 文件中，我想从 xml 文件访问其他属性。

我在项目中的 xml 文件中定义了版本号

```
<add key="VersionNumber" value="1000"/> 
```

假设我在 sample.xml 中有上述密钥，我如何从 MSBuild 项目文件中访问它

我能做这样的事吗

```
<ItemGroup>
    <Content Include="constants.xml"/>
</ItemGroup>

Message Text="The output file value @(VersionNumber)"/> 
```

任何帮助都将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:43:11.787

我找到了解决方案，并认为发布会有所帮助。我使用了 xml 读取并得到了它，我使用了[http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)

示例代码，但我的代码虽然不同

```
 <XmlRead 
  XPath="/add/@connectionString"
  XmlFileName="app.config">
    <Output TaskParameter="Value" PropertyName="MyConnectionString" />
</XmlRead>
<Message Text="MyConnectionString: $(MyConnectionString)"/> 
```

# c# - 比较像素中的 RGB 颜色并将其原始颜色更改为最接近的颜色

> ID：16095030
> 
> 赞同：3
> 
> 时间：2013-04-18T23:56:09.370
> 
> 标签：c#, colors, pixel, rgb

我的任务需要帮助。基本上，这就是我想要做的：

*   将图像加载到`PictureBox`
*   计算每个像素中255（最大值）和R值的差值，以及255和G值的差值，也计算B值
*   从上面的计算来看，绝对值最小表示像素的颜色更接近那个颜色（例如：（255-R值）的绝对值最小，所以像素更接近那个颜色）
*   将像素颜色更改为更接近的颜色（在上面的示例中，这意味着将其更改为红色）
*   在输出图片框中显示结果

结果，我将获得具有这三种原色的图像。

我写了这样的代码：

```
 Bitmap img = new Bitmap(InputPictureBox.Image);
        byte R, G, B;
        Color pixelColor;
        for (int x = 0; x < img.Width; x++)
        {
            for (int y = 0; y < img.Height; y++)
            {
                pixelColor = img.GetPixel(x, y);
                R = (byte) Math.Abs(pixelColor.R - 255);
                G = (byte) Math.Abs(pixelColor.G - 255);
                B = (byte) Math.Abs(pixelColor.B - 255);

                if (R < G && R < B)
                {
                    pixelColor = Color.Red;
                }
                else if (G < R && G < B)
                {
                    pixelColor = Color.Green;
                }
                else if (B < R && B < G)
                {
                    pixelColor = Color.Blue;
                }
            }
        }
  OutputPictureBox.Image = img; 
```

问题是彩色图像随后会反转。那么，我的代码有什么问题？我认为这些`if`陈述不起作用，但我不知道为什么。我错了吗？

还有一个与我上面的代码相关的问题，它是否可以通过简单地计算 R/G/B 值的差距来实现，或者它绝对必须通过使用欧几里得距离来完成？

如果您不介意，请告诉我如何解决这个问题或者应该如何编写代码。我曾经读过一个非常相似的问题，但给出的答案仍然没有给我一个线索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:10:29.103

您的代码实际上可以工作，尽管其中有一些过度思考。

尝试这个：

> ***代码已移至**帖子底部的*更新部分**

 *结果：

[![结果](https://i.stack.imgur.com/DnbYG.png)](https://i.stack.imgur.com/DnbYG.png)

* * *

**我已经删除**了过度思考的部分。

*   没有理由（至少从阅读您的问题）需要反转颜色分量值；

    1.  简单地做`R = pixelColor.R`就足够了；

    2.  通过这一点，您*不必*将其视为“红色**最少**”，而是“**如果红色***最多*，那就是红色**！** ”

*   正如[LightStriker 指出的那样](https://stackoverflow.com/questions/16095030/compare-rgb-colors-in-a-pixel-and-change-its-original-color-to-the-closest-one/16095664#comment22980907_16095030)：您缺少（它不在您的代码中）将新值设置回图像的代码；

    1.  这是使用`img.SetPixel(x, y, pixelColor)`.
*   我添加了一个`else`子句来匹配**没有单一颜色分量**大于其他颜色分量的像素。

    1.  例如，Yellow (255, 255, 0) 不会与您的规则匹配；

    2.  使用此答案中的版本，它会被一个`Black`像素替换。

* * *

**更新：**根据[下面的评论](https://stackoverflow.com/questions/16095030/compare-rgb-colors-in-a-pixel-and-change-its-original-color-to-the-closest-one/16095664?noredirect=1#comment23245481_16095664)要求进一步澄清。以下是添加更多条件语句的方法：

```
// NEW (start) --------------------------------------------------
Color[] randomizedColors = new Color[] { Color.Red, Color.Green, Color.Blue };
Random randomizer = new Random();
// NEW (end) --------------------------------------------------

Bitmap img = new Bitmap(InputPictureBox.Image);
byte R, G, B;
Color pixelColor;

// NEW (start) --------------------------------------------------
Func<int, Color> ColorRandomizer = (numberOfColors) =>
{
    if (numberOfColors > randomizedColors.Length)
    {
        numberOfColors = randomizedColors.Length;
    }
    return randomizedColors[randomizer.Next(numberOfColors)];
};
// NEW (end) --------------------------------------------------

for (int x = 0; x < img.Width; x++)
{
    for (int y = 0; y < img.Height; y++)
    {
        pixelColor = img.GetPixel(x, y);
        R = pixelColor.R;
        G = pixelColor.G;
        B = pixelColor.B;

        if (R > G && R > B)
        {
            pixelColor = Color.Red;
        }
        else if (G > R && G > B)
        {
            pixelColor = Color.Green;
        }
        else if (B > R && B > G)
        {
            pixelColor = Color.Blue;
        }
// NEW (start) --------------------------------------------------
        else if (pixelColor == Color.Yellow)
        {
            // 2 = Red or Green
            pixelColor = ColorRandomizer(2);
        }
        else if (pixelColor = Color.FromArgb(152, 152, 152))
        {
            // 3 = Red, Green, or Blue
            pixelColor = ColorRandomizer(3);
        }
        /* else if (pixelColor = Some_Other_Color)
        {
            // 3 = Red, Green, or Blue
            pixelColor = ColorRandomizer(3);
        } */
// NEW (end) --------------------------------------------------
        else
        {
            pixelColor = Color.Black;
        }
        img.SetPixel(x, y, pixelColor);
    }
}

OutputPictureBox.Image = img; 
```

使用此更新的代码，将应随机选择的所有颜色添加到`randomizedColors`数组中。使用 lambda 函数 ,`ColorRandomizer`来帮助随机选择颜色；请记住，此函数将在**第一个元素**和指定的元素之间随机选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:09:19.443

以下是反转所有颜色。

```
R = (byte) Math.Abs(pixelColor.R - 255);
G = (byte) Math.Abs(pixelColor.G - 255);
B = (byte) Math.Abs(pixelColor.B - 255); 
```

您可以使用：

```
R = (byte) pixelColor.R;
G = (byte) pixelColor.G;
B = (byte) pixelColor.B; 
```*

# sql - 如何将 PL/SQL 中的输出格式化为直列？

> ID：16095032
> 
> 赞同：1
> 
> 时间：2013-04-18T23:56:20.767
> 
> 标签：sql, oracle, plsql

我想知道如何将以下代码的输出显示在整齐的列中。现在的输出没有整齐地组织。有什么我需要放在变量前面的吗？

```
DBMS_OUTPUT.PUT_LINE('Employee Name: ' || (v_name));
DBMS_OUTPUT.PUT_LINE('Job: ' || (v_job));
DBMS_OUTPUT.PUT_LINE('Total Pay: ' || TO_CHAR(v_pay, '$999G999G999D99')); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:03:12.627

您正在输出一个字符串，因此没有机会整齐地对齐这些值，因为它们可能在一个简单的选择中。串联 ( `||`) 只是将给出的内容完全结合在一起。

您需要做的就是手动填充字符串：

```
DBMS_OUTPUT.PUT_LINE('Employee Name: ' || (v_name));
DBMS_OUTPUT.PUT_LINE('Job:           ' || (v_job));
DBMS_OUTPUT.PUT_LINE('Total Pay:     ' || TRIM(TO_CHAR(v_pay, '$999G999G999D99'))); 
```

数字列的`to_char`左填充（右对齐）到格式掩码的宽度：

```
SQL> select TO_CHAR(4.97,'$999G999G999D99') from dual;

TO_CHAR(4.97,'$9
----------------
           $4.97 
```

...所以在这种情况下，你想要一个`trim`周围的，所以它只使用你自己的填充。

```
DECLARE
    v_name varchar2(30) := 'Joe Bloggs';
    v_job varchar2(20) := 'Contractor';
    v_pay number := 52657.3;
BEGIN
    DBMS_OUTPUT.PUT_LINE('Employee Name: ' || v_name);
    DBMS_OUTPUT.PUT_LINE('Job:           ' || v_job);
    DBMS_OUTPUT.PUT_LINE('Total Pay:     '
        || TRIM(TO_CHAR(v_pay, '$999G999G999D99')));
END;
/

Employee Name: Joe Bloggs
Job:           Contractor
Total Pay:     $52,657.30

PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T12:54:49.767

显示为列 - 这是一种简单的方法。您可以为此使用 Rpad()、Lpad()，我猜这会更先进：

```
DECLARE
   v_name varchar2(30) := 'Joe Bloggs';
   v_job varchar2(20) := 'Contractor';
   v_pay number := 52657.3;
BEGIN
  DBMS_OUTPUT.PUT_LINE('Employee Name'||chr(9)||chr(9)||chr(9)||'Job'||chr(9)||chr(9)||chr(9)||chr(9)||chr(9)||'Total Pay');
  DBMS_OUTPUT.PUT_LINE('--------------------------------------------------------');
  DBMS_OUTPUT.PUT_LINE(v_name||chr(9)||chr(9)||chr(9)||chr(9)||chr(9)||v_job||chr(9)||chr(9)||TRIM(TO_CHAR(v_pay, '$999G999G999D99')));
END;
/

Employee Name           Job                 Total Pay
--------------------------------------------------------
Joe Bloggs             Contractor           $52,657.30 
```

# php - 如何在 PHP API First App 中处理 PUT 和 DELETE HTTP 请求？

> ID：16095035
> 
> 赞同：0
> 
> 时间：2013-04-18T23:56:55.717
> 
> 标签：php, api, rest

我想在 PHP 中构建一个 API 第一个 RESTful 应用程序。我从来没有尝试过这样做，所以我对如何处理`PUT`和处理有一些疑问`DELETE`

例如，如果我有一个更新用户配置文件的 API 端点，我是否应该让它同时接受 a`POST`和`PUT`请求？

如果我正在为我的 API 构建一个客户端作为桌面应用程序或 iOS 应用程序等，那么向我的 API 发送请求会很容易，`PUT`但我也计划为我的 API 创建一个基于 Web 的应用程序。

因此，在我的基于 Web 的应用程序上，我将有一个 HTML 表单来更新用户配置文件，然后将其`POST`作为 HTML 表单不允许`PUT`请求发送。

有更多经验的人可以解释处理我的示例场景的最佳方法吗？

正确的方法是将我的表单作为 a 发送`POST`到我的 PHP 脚本，然后我的 PHP 脚本会`PUT`使用 cURL 向我的 PHP API 发出正确的请求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:05:40.197

您绝对也可以从浏览器执行 PUT 请求，但您需要 javascript。

一般来说，我会说一个很好的思考方式，如下：

首先构建一个遵循所有规则的优秀 REST api。只有到了那个时候，才考虑使它在其他环境中工作所需的变通方法。提交 HTML 表单是需要解决方法的有效方法。

然而，由于 'POST' 是完全开放的，并且几乎没有相关的规则，一个选择是在您的服务器上创建一个资源（或 url）来处理来自浏览器的所有 POST 请求。（类似`/browserpost`）。

您始终可以添加一个隐藏`<input>`字段，`name="url"`其中指定实际要更新的资源，以及用于意图的`<input>`with `name="method" value="PUT"`。

无论如何，您都需要添加 CSRF 保护，所以我觉得这将是解决这个问题的可靠方法。1 个端点专门“代理”基于 html 的表单提交，并在内部对正确的 REST 服务进行适当的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:01:51.313

我会使用`GET` `POST` `PUT` `DELETE`它们在 HTTP 中的描述。这很安静（在我看来）。由于常规浏览器表单不支持这一点，我将通过 AJAX 发送数据。

如果您确实需要使用浏览器表单，可能是因为未启用 javascript，那么使用`POST`带有参数的请求`?method`听起来像是一个合适的解决方案 - 尽管我不喜欢它。

# java - 无法添加记录，Java，Hibernate

> ID：16095038
> 
> 赞同：0
> 
> 时间：2013-04-18T23:57:15.157
> 
> 标签：java, hibernate

我有数据表。例如我有表 user_books。

id_user | id_book

我收到了与当前用户相关的所有书籍的每个请求。(1, 2), (1, 7) 所以我从 user_books 中删除当前用户的所有记录并重新插入它们。

问题是我不断从 Hibernate 收到错误，删除成功，但由于这个警告，我可以重新插入它们。

```
2013-04-18 15:48:40,787 INFO : org.hibernate.event.internal.DefaultDeleteEventListener - HHH000114: Handling transient entity in delete processing
2013-04-18 15:48:40,788 INFO : org.hibernate.event.internal.DefaultDeleteEventListener - HHH000114: Handling transient entity in delete processing
2013-04-18 15:48:40,788 INFO : org.hibernate.event.internal.DefaultDeleteEventListener - HHH000114: Handling transient entity in delete processing 
```

知道在哪里看吗？为什么我不能在 Java Hibernate 环境中使用 userBook.add(...) 重新插入书籍？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-22T05:17:39.577

我认为映射关系没有正确定义所以你必须在你的 POJO.hbm.xml 类中定义映射关系

尝试如下，

```
<many-to-one class="VO.regVO" name="uid" cascade="delete"></many-to-one> 
```

这里的多对一关系是通过映射 regVO POJO 类 Primarykey **'uid'**现在用于当前 POJO 类作为 Foreignkey 和级联**'delete'**将关于从数据库中删除一个对象导致删除其他对象（依赖) 对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:21:44.097

这可能是由于没有更正您的持久对象注释而出现的。我猜它连接到您的归档和级联类型的注释。

尝试这样的事情：

`@ManyToMany(fetch = FetchType.EAGER, cascade=CascadeType.PERSIST)`

# .net - 使 Visual Basic 窗体上的元素可拖动

> ID：16095045
> 
> 赞同：2
> 
> 时间：2013-04-18T23:58:26.753
> 
> 标签：.net, vb.net

我想制作一个具有一组指定元素的 Visual Basic 表单，用户可以将这些元素拖到表单上的另一个位置。我怎样才能做到这一点？我查看了谷歌，并在 StackOverflow 上进行了一些搜索，但我一无所获。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:47:39.700

我很久以前写过一篇关于这个主题的文章，这可能对你有帮助。

[将文件拖放到您的表单或控件中](http://pradeep1210.wordpress.com/2010/03/04/drag-drop-files-into-your-form-or-control/)

在该示例中，我展示了如何将文件拖到表单或控件中。您的要求略有不同，但有关拖动的基本思想保持不变。

看看这个示例，它演示了如何将一个控件拖到表单上的另一个控件中。对于此示例，在表单上放置两个列表框 -`ListBox1`和`ListBox2`，并添加以下代码：

```
Private Sub Form2_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    ListBox1.AllowDrop = True
    ListBox2.AllowDrop = True

    ListBox1.Items.Add("Test Item 1")
    ListBox1.Items.Add("Test Item 2")
    ListBox1.Items.Add("Test Item 3")
    ListBox1.Items.Add("Test Item 4")

    ListBox2.Items.Add("Test Item 5")
    ListBox2.Items.Add("Test Item 6")
    ListBox2.Items.Add("Test Item 7")
    ListBox2.Items.Add("Test Item 8")

End Sub

Private Sub ListBoxes_MouseDown(sender As Object, e As System.Windows.Forms.MouseEventArgs) Handles ListBox1.MouseDown, ListBox2.MouseDown
    Dim lb As ListBox = CType(sender, ListBox)
    lb.DoDragDrop(lb, DragDropEffects.Move)
End Sub

Private Sub ListBoxes_DragEnter(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles ListBox1.DragEnter, ListBox2.DragEnter
    e.Effect = DragDropEffects.Move
End Sub

Private Sub ListBoxes_DragDrop(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles ListBox1.DragDrop, ListBox2.DragDrop
    If TypeOf sender Is ListBox Then
        Dim lb As ListBox = CType(sender, ListBox)
        Dim srcLb As ListBox = e.Data.GetData(GetType(ListBox))
        If lb IsNot srcLb Then
            lb.Items.Add(srcLb.SelectedItem.ToString)
            srcLb.Items.Remove(srcLb.SelectedItem)
        End If
    End If
End Sub 
```

现在将项目从一个列表框拖到另一个列表框中，反之亦然，看看效果。

编辑：

**在窗体上移动控件**

（在OP在评论中澄清后添加）

在表单上移动控件与我上面展示的拖动完全不同。您可以简单地捕获 MouseDown、MouseMove 和 MouseUp 事件来执行此操作。

这是一个例子。在表单上放很多控件，并添加以下代码：

```
Private Moving As Boolean
Private Sub Controls_MouseDown(ByVal sender As Object, ByVal e As MouseEventArgs)
    Dim ctl As Control = CType(sender, Control)
    Cursor.Position = PointToScreen(ctl.Location + New Point(ctl.Width \ 2, ctl.Height \ 2))
    Moving = True
End Sub

Private Sub Controls_MouseMove(ByVal sender As Object, ByVal e As MouseEventArgs)
    If Moving Then
        Dim ctl As Control = CType(sender, Control)
        ctl.Location = PointToClient(Cursor.Position - New Point(ctl.Width \ 2, ctl.Height \ 2))
    End If
End Sub

Private Sub Controls_MouseUp(ByVal sender As Object, ByVal e As MouseEventArgs)
    Moving = False
End Sub

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    For Each ctl As Control In Me.Controls
        ctl.Cursor = Cursors.SizeAll
        AddHandler ctl.MouseDown, AddressOf Controls_MouseDown
        AddHandler ctl.MouseUp, AddressOf Controls_MouseUp
        AddHandler ctl.MouseMove, AddressOf Controls_MouseMove
    Next
End Sub 
```

运行应用程序并在窗体上到处拖动控件。

# javascript - javascript变量单独放在一行，为什么？

> ID：16095048
> 
> 赞同：3
> 
> 时间：2013-04-18T23:58:34.473
> 
> 标签：javascript, popup

```
var popup = window.open('http://twitter.com');
popup;
if ($.browser.safari && !popup) {
alert('Please allow for popups on your browser.');
} 
```

我今天遇到了上面的代码，第二行“popup”的原因（如果有的话）是什么？?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T00:16:55.423

第二行不做任何事情，您可以安全地删除它

# jquery - 无法将数组设置为 Jquery 自动完成的源

> ID：16095050
> 
> 赞同：0
> 
> 时间：2013-04-18T23:58:40.627
> 
> 标签：jquery

我无法将以下数组设置为源。请帮忙。

```
var myData=new Array();
myData.push('alertMe()');

myJqueryAlias("#textarea").autocomplete({
    source:myData,
    minLength: 0

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:06:37.470

我认为其他的东西可能不起作用。在这种情况下，源将设置为“['alertMe()']”

# facebook - apprequest 无法显示在用户页面上

> ID：16095051
> 
> 赞同：0
> 
> 时间：2013-04-18T23:58:54.477
> 
> 标签：facebook, apprequests

我能够毫无错误地使用我的应用服务器端（应用生成）发布 apprequest。返回 ID 和用户。我使用 FQL 工具使用 appid 和 userid 进行查询，我得到了结果。但是当我进入我的 Facebook 页面时，我没有收到通知，也没有在左侧看到带有计数的应用程序。这可能是设置问题（我的第一个 FB 应用程序）吗？我的应用程序处于沙盒模式，这与它有什么关系吗？

您的应用程序如何与 Facebook 设置集成已检查 Mobile Web 和 Canvas。这将主要是一个移动网络应用程序。

我可以创建帖子并显示这些帖子。

任何帮助将不胜感激。

谢谢，

瑞克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:07:46.703

实际上，这里的问题是沙盒模式。

除非发送请求的用户列在应用程序的“角色”部分中，否则不会真正发送请求。这些请求指向您的画布 URL，但在您的应用程序处于沙盒模式时，除了开发应用程序的团队之外，没有人能够访问该 URL。Facebook 不显示通知，因为它不会引导到任何地方。

就您而言，在您发送请求后收到 request_id 的那一刻 - 它已成功完成。

# c - 在 C 编程中：为新字符串分配空间时是否需要考虑 '\0'（空终止符）

> ID：16095054
> 
> 赞同：3
> 
> 时间：2013-04-18T23:59:25.507
> 
> 标签：c, malloc

例如，假设我想将字符串“str1”复制到一个新字符串“str2”：

```
void function(const char* str1){
    char* str2;
    str2 = (char *) malloc(sizeof(char) * (strlen(str1) + 1));
    strcpy(str2, str1);
    ...
} 
```

malloc 的参数是否应该是：

```
sizeof(char) * (strlen(str1)+1) 
```

要不就：

```
sizeof(char) * strlen(str1) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T00:01:46.730

是的，您需要 +1 —`strlen`返回字符串长度；要存储一个字符串，您需要存储它的长度加上一个额外的`NULL`终止符点。

话虽这么说，在这个具体的例子中（我敢肯定就是这样：一个说明这一点的例子），你可以只使用`strdup`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:01:38.613

strcpy() 函数复制包含终止 `\0' 字符的字符串，因此您需要 +1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T00:01:56.367

是的，当然你必须考虑到'\0'。所以：

```
strlen(str1)+1U 
```

是你想要的。`strdup`在这种情况下考虑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T03:27:12.493

`malloc()`您可以使用`calloc()`which 自动为您终止 null而不是使用。

# c# - 从 MainWindow 调用 UserControl 中的事件

> ID：16095055
> 
> 赞同：0
> 
> 时间：2013-04-18T23:59:25.653
> 
> 标签：c#, listview, mvvm, user-controls

我有一个带有 Button 和 ListView 的 UserControl。

模型

```
public class Item
{
    private string _name = string.Empty;

    public string Name
    {
        get
        {
            return _name;
        }
        set
        {
            _name = value;
        }
    }
} 
```

视图模型

```
public class ViewModel : NotifyProperty
{
    private Command addCommand;
    public ICommand AddCommand
    {
        get
        {
            if (addCommand == null)
                addCommand = new Command(addItem);
            return addCommand;
        }
    }

    private ObservableCollection<Item> _itemCollection;

    public ViewModel()
    {

        ItemCollection = new ObservableCollection<Item>();
        Item newItem = new Item();
        newItem.Name = "Joe";
        ItemCollection.Add(newItem);
    }

    public ObservableCollection<Item> ItemCollection
    {
        get
        {
            return _itemCollection;
        }
        set
        {
            _itemCollection = value;
            OnPropertyChanged("ItemCollection");
        }
    }

    private void addItem(Object obj)
    {
        Item newItem = new Item();
        newItem.Name = "Chris";
        ItemCollection.Add(newItem);
    }
} 
```

用户控件 (XAML)

```
<UserControl.DataContext>
    <local:ViewModel />
</UserControl.DataContext>

<UserControl.Resources>
    <DataTemplate x:Key="ItemTemplate">
        <StackPanel Orientation="Vertical">
            <Label Content="{Binding Name}" />
        </StackPanel>
    </DataTemplate>
</UserControl.Resources>

<Grid>
    <DockPanel>
        <Button Width="100" Height="30" Content="Add" Command="{Binding AddCommand}" DockPanel.Dock="Top" />
        <ListView ItemTemplate="{StaticResource ItemTemplate}" ItemsSource="{Binding ItemCollection}" />
    </DockPanel>
</Grid> 
```

然后我像这样将它添加到我的 MainWindow

```
 public partial class MainWindow : Window
{

    public MainWindow()
    {
        InitializeComponent();
        this.mainContentControl.Content = new ListControl();

    }
} 
```

这工作正常，当我单击“添加”按钮时，名称“Chris”被添加到 ListView。

现在我向 MainView 添加一个按钮并将其 Command 属性绑定到我的 ViewModel，如下所示：

```
<Grid>
    <DockPanel>
        <Button Width="100" Height="30" Content="Add" Command="{Binding AddCommand}" DockPanel.Dock="Top">
            <Button.DataContext>
                <local:ViewModel />
            </Button.DataContext>
        </Button>
        <ContentControl x:Name="mainContentControl" />
    </DockPanel>       
</Grid> 
```

当我在 MainWindow 中单击此按钮时，命令被发送到 ViewModel，addItem 事件被调用，名称“Chris”被添加到 ItemCollection，但 ListView 不会更新。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:03:34.123

您的 ViewModel 是否被设置为其他地方的另一个元素的数据上下文（在 XAML 或代码隐藏中）。

在将其设置为按钮的数据上下文的地方，它将实例化视图模型的新实例，因此与按钮有权访问的实例的任何交互都不会在其他实例中更新。

该按钮将从祖先元素（例如窗口等）继承数据上下文，因此您不需要设置它，但是如果您确实需要按钮的单独数据上下文，那么我建议创建`ViewModel`as一个资源，然后只为需要访问它的元素引用它。

# ruby-on-rails - check_box_tag 和 label_tag 点击操作

> ID：16095060
> 
> 赞同：21
> 
> 时间：2013-04-18T23:59:55.510
> 
> 标签：ruby-on-rails, ruby-on-rails-3, form-helpers

```
<%= f.label :category %><br/>
<%= check_box_tag 'category[]', '1', false %>
<%= label_tag 'community', 'community', class: 'category_select', value: '1' %>
<%= check_box_tag 'category[]', '2', false %>
<%= label_tag 'food', 'food', class: 'category_select', value: '2' %>
<%= check_box_tag 'category[]', '3', false %>
<%= label_tag 'music', 'music', class: 'category_select', value: '3' %><br/>
<%= check_box_tag 'category[]', '4', false %>
<%= label_tag 'education', 'education', class: 'category_select', value: '4' %>
<%= check_box_tag 'category[]', '5', false %>
<%= label_tag 'theatre', 'theatre', class: 'category_select', value: '5' %>
<%= check_box_tag 'category[]', '6', false %>
<%= label_tag 'art', 'art', class: 'category_select', value: '6' %><br/>
<%= check_box_tag 'category[]', '7', false %>
<%= label_tag 'culture', 'culture', class: 'category_select', value: '7' %>
<%= check_box_tag 'category[]', '8', false %>
<%= label_tag 'family', 'family', class: 'category_select', value: '8' %>
<%= check_box_tag 'category[]', '9', false %>
<%= label_tag 'sports', 'sports', class: 'category_select', value: '9' %><br/> 
```

我希望能够让这些选项显示在我的控制器中的一个`category`数组下，所以我将所有选项命名为`category[]`。我想要完成的是让`label_tag`和`check_box_tag`字段相互了解：

```
<%= check_box_tag 'community', 'community', false %>
<%= label_tag 'community', 'community', class: 'category_select' %> 
```

在这里，如果我单击单词，该框也会被选中。我尝试使用 上的值来完成此操作`label_tag`，但它似乎不起作用。这可以实现吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-19T00:35:24.267

一种方法是`label`手动添加元素（否`erb`），并将复选框和标签内容添加为子项：

```
<label class="category-select">
  <%= check_box_tag 'category[]', '1', false %>
  Community
</label>
... 
```

尽管这确实会在一定程度上改变 html 的结构，并且可能会对您的布局/css 产生影响。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-04-12T16:00:21.193

您还可以将一个块传递给`label_tag`标签标签内的复选框（以及您想要的任何其他内容），然后再传递一个复选框。

```
<%= label_tag do %>
  <%= check_box_tag 'category[]', '1', false %>
  Community
<% end %> 
```

相关文档：[http ://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-label_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-label_tag)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-09-09T18:32:45.973

好的，我很晚才回答这个问题。我正在寻找同样问题的解决方案并提出以下建议：

```
<%= label_tag "some_name", raw("#{check_box_tag('some_name')} Click label to check") %> 
```

这将创建 html 如下：

```
<label for="some_name"><input id="some_name" name="some_name" type="checkbox" value="1"> Click label to check</label> 
```

# c - 如何通过参数将二维矩阵传递给C中的函数

> ID：16095064
> 
> 赞同：1
> 
> 时间：2013-04-19T00:00:22.390
> 
> 标签：c, dynamic, matrix, global

我有一个关于矩阵的问题。我有一个计算跳棋动作的程序；我用 Java 解决了它，但它运行得不够快，所以我决定在 C 中尝试它。

问题是在 Java 中我可以将二维矩阵作为参数传递给函数，但在 C 中我不能这样做。编译器说我不能。我在这里和网上挖掘，看到了一些动态分配之类的东西，但我不太明白。

我的问题是：

*   如何将二维矩阵传递给我的函数`checagem`（它是一个递归函数）以使其工作？
*   这是否有效（`main()`代码），因为这里显示了一个 0 循环？我不知道是因为矩阵还是什么。

这是代码：

```
#include <stdio.h>
#include <stdlib.h>

int checagem(int m[][100], int xo, int xd, int yd, int n) {
    int r = 0;
    if (0 <= xd && xd < n && 0 <= yd && yd < n) {
        if (yd == 0) {
            if (m[yd][xd] != 1) {
                r += 1;
            }
        } else if (m[yd][xd] == 0 || m[yd][xd] == 2) {
            r += checagem(m, xd, xd - 1, yd - 1, n);
            r += checagem(m, xd, xd + 1, yd - 1, n);
        } else if (m[yd][xd] == 1) {
            if (xo - xd > 0) {
                if (pulavel(xd - 1, yd - 1, m, n)==1) {
                    r += checagem(m, xd, xd - 1, yd - 1, n);
                }
            } else if (xo - xd < 0) {
                if (pulavel(xd + 1, yd - 1, m, n)==1) {
                    r += checagem(m, xd, xd + 1, yd - 1, n);
                }
            }
        }
    } else {
        r += 0;
    }
    return r;
}

int pulavel(int x, int y, int m[][100], int n) {
    int r = 1;
    if (x < 0 || x > n - 1 || m[y][x] == 1) {
       r=0 ;
    }
    return r;
}

int main(){
    //variaveis
    int n = 0, t = 1, x = -1, y = -1, teste = 1;
    int i,j;
    //logica
    scanf("%d %*c",&t);

    while (teste > 0) {
        scanf("%d %*c",&n);
        if (n > 1 || n <= 100) {
            int tabuleiro[n][n];
            for (i = 0; i < n; i++) {
                char l[n];
                scanf("%s %*c", &l);
                for (j = 0; j < n; j++){
                    switch(l[j]){
                    case ('.'): tabuleiro[i][j] = 0;break;
                    case ('b'): tabuleiro[i][j] = 1;break;
                    case ('w'): tabuleiro[i][j] = 2;
                                x = j;
                                y = i;break;
                    }
                }
            }
            int r = checagem(tabuleiro, x, x, y, n);
            printf("%d", r); 
        }
    }
} 
```

输入就像来自的比赛：[http ://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=3108](http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=3108)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:49:48.180

您的问题是您在函数中声明`int tabuleiro[n][n];`，`main()`但您的`checagem()`函数不希望通过 VLA。您需要在数组之前传递维度，因此将其修改为：

```
int checagem(int n, int m[n][n], int xo, int xd, int yd)
{
    ...
} 
```

然后确保你没有溢出数组的边界（因为 C 不会阻止你，当然）。

当然，您需要对 进行并行更改`pulavel()`，并更改对这两个函数的调用。

这编译OK；我没有尝试运行它。不要取数组的地址；它会让你感到困惑，即使它不会让编译器感到困惑（它只是在抱怨 中的类型不匹配`scanf("%s %*c", &l);`）。请升级您的代码以检查`scanf()`调用是否成功。我不确定您正在阅读什么格式`scanf("%s %*c", l)`，但我怀疑它会对您不期望的数据造成损害。我重新排序了函数并制作了它们`static`（并添加`void`到`int main(void)`）以避免来自我的标准 GCC 编译选项的编译警告：

```
gcc -O3 -g -std=c99 -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes -Wold-style-definition -c ck.c 
```

代码：

```
#include <stdio.h>
#include <stdlib.h>

static
int pulavel(int n, int x, int y, int m[n][n])
{
    int r = 1;
    if (x < 0 || x > n - 1 || m[y][x] == 1)
       r=0;
    return r;
}

static
int checagem(int n, int m[n][n], int xo, int xd, int yd)
{
    int r = 0;
    if (0 <= xd && xd < n && 0 <= yd && yd < n) {
        if (yd == 0) {
            if (m[yd][xd] != 1) {
                r += 1;
            }
        } else if (m[yd][xd] == 0 || m[yd][xd] == 2) {
            r += checagem(n, m, xd, xd - 1, yd - 1);
            r += checagem(n, m, xd, xd + 1, yd - 1);
        } else if (m[yd][xd] == 1) {
            if (xo - xd > 0) {
                if (pulavel(n, xd - 1, yd - 1, m)==1) {
                    r += checagem(n, m, xd, xd - 1, yd - 1);
                }
            } else if (xo - xd < 0) {
                if (pulavel(n, xd + 1, yd - 1, m)==1) {
                    r += checagem(n, m, xd, xd + 1, yd - 1);
                }
            }
        }
    } else {
        r += 0;
    }
    return r;
}

int main(void)
{
    //variaveis
    int n = 0, t = 1, x = -1, y = -1, teste = 1;
    int i,j;
    //logica
    scanf("%d %*c",&t);

    while (teste > 0) {
        scanf("%d %*c",&n);
        if (n > 1 || n <= 100) {
            int tabuleiro[n][n];
            for (i = 0; i < n; i++) {
                char l[n];
                scanf("%s %*c", l);
                for (j = 0; j < n; j++){
                    switch(l[j]){
                    case ('.'): tabuleiro[i][j] = 0;break;
                    case ('b'): tabuleiro[i][j] = 1;break;
                    case ('w'): tabuleiro[i][j] = 2;
                                x = j;
                                y = i;break;
                    }
                }
            }
            int r = checagem(n, tabuleiro, x, x, y);
            printf("%d", r); 
        }
    }
} 
```

# python - CiteULike API '禁止'

> ID：16095065
> 
> 赞同：2
> 
> 时间：2013-04-19T00:00:32.030
> 
> 标签：python, api, urllib2, http-status-code-403

我正在尝试查询 CiteULike 中研究论文的书签数量。我正在使用“ [http://www.citeulike.org/api/posts/for/doi/](http://www.citeulike.org/api/posts/for/doi/) ” URL 来请求（使用 Python 的 urllib2 库）对包含有关书签信息的 XML 文档给定的 DOI（论文的唯一标识符）。但是我不断收到 HTTP 403 错误：禁止访问。

有谁知道我为什么会收到这个错误？我尝试将带有 DOI 的 URL 放在浏览器中，并且返回 XML 就好了，所以问题似乎与我的自动请求有关。

谢谢，纳撒尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T06:52:15.370

您应该阅读[http://wiki.citeulike.org/index.php/Importing_and_Exporting#Scripting_CiteULike](http://wiki.citeulike.org/index.php/Importing_and_Exporting#Scripting_CiteULike)

> 如果您通过自动化流程访问 CiteULike，您必须提供一种通过 User-Agent 字符串识别您自己的方法。请使用“<username>/<email> <application>”，例如“fred/fred@wilma.com myscraper/1.0”。任何无法识别您身份的网站脚本都可能导致阻止。

# java - 为什么我的 ArrayList 没有保存到我的文件中？

> ID：16095069
> 
> 赞同：0
> 
> 时间：2013-04-19T00:01:03.477
> 
> 标签：java, arraylist, printwriter

为什么 ArrayList 没有被写入“MyCalendar.txt”？即使我使用 out.write() 它仍然返回 false 但不写入文件。

```
import java.util.*;
import java.io.*;

public static Boolean addAppointment(ArrayList<String> calendar, 
                     String specifiedDay,
                         String specifiedTime) {

PrintWriter out = new PrintWriter("myCalendar.txt"); //declare calendar file    

    for (int i = 0; i<calendar.size(); i++) {
        String index = calendar.get(i);
        if (index.equals(specifiedDay + "" + specifiedTime))
        { 
         out.println(specifiedDay + "" + specifiedTime);
         return false; 
        }
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:10:01.727

以下2对于将数据刷新到文件并关闭流很重要

```
out.flush();
out.close(); 
```

问候，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:05:18.970

你忘了关闭它：

```
out.close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:27:22.900

所以，这里有几件事。

如果您使用的是 Java 7，则应考虑使用[try-with-resources](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)。这将绝对确保`PrintWriter`您在完成后关闭。

```
try (PrintWriter out = new PrintWriter("somefile.txt")) {
    // code
} catch (FileNotFoundException e) {
    System.out.println("Bang!");
} 
```

接下来，有一些文件无法部分或完全写入的情况：

*   `calendar.size() == 0`
*   `index.equals(specifiedDay + "" + specifiedTime)`

如果满足第一个条件，则不写入任何内容，并且该方法愉快地返回`true`。可能不是你所期望的。

如果满足第二个条件，则编写第*一个*元素，并提前返回。将它放在你的循环条件中可能是一个更好的主意，并在你完成循环后返回返回值。

```
int i = 0;
boolean good = true;
while(good && i < calendar.size()) {
    // critical actions
    String index = calendar.get(i);
    if(index.equals(specifiedDay + "" + specifiedTime)) {
        good = false;
    }
}
// other code
return good; 
```

如果*从未*满足该条件，则不会将*任何*内容写入文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T00:28:52.663

PrintWriter 的默认行为是不自动刷新缓冲区。有关详细信息，请参阅[PrintWriter 文档。](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html)

或者，您可能遇到数据问题：

```
String index = calendar.get(i);
if (index.equals(specifiedDay + "" + specifiedTime)) 
```

如果不满足此条件，您将不会打印任何内容。你确定这个条件是真的吗？

# assembly - HC12，存储数据并对数据执行 OR

> ID：16095074
> 
> 赞同：0
> 
> 时间：2013-04-19T00:01:43.120
> 
> 标签：assembly

问题问

*编写一个汇编程序，将程序本身可执行部分的第一个字节（用机器语言表示）或与 11110000(2) 存储在内存中的变量中。该程序应给出正确的结果，而与加载位置无关.*

解决方案是

```
; Prepared for Metrowerks Codewarrior v3.

    include preamble.inc    ; Do not change this line.

;******************************************************************
;* Your main program instructions must immediately follow the     *
;* label "ENTRY".  This label must not be changed.                *
;******************************************************************

; Data Declarations Follow:
      org   $0000

; Main Program :
      org   $0800       
ENTRY:
START     ldaa     START       ; A <== (M[START])    

      oraa    #%11110000  ; A <== (A) OR %11110000

; Halt execution
    swi
    nop

; Subroutine Area Follows:
    org $0A00

; Physical end of the program:
    end 
```

现在我的问题是，我不明白这是在做什么。例如，

```
START ldaa START 
```

这个加载到累加器 a 中的是什么？它是加载数据START并用数据START调用地址START吗？此外，START如何加载到累加器a中？你可以在那里加载字符吗？

也不明白 OR 的目的。可能有一个重要的概念我应该选择这个，但我不知道那是什么

HC12 手册：[http ://www.eng.uwo.ca/electrical/e-shop/micros/HC12%20CPU12%20Reference%20Manual.pdf](http://www.eng.uwo.ca/electrical/e-shop/micros/HC12%20CPU12%20Reference%20Manual.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:26:22.743

这一行有几个部分：

```
START ldaa START 
```

左边`START`是标签。然后是指令`ldaa`及其操作数，即对`START`刚刚声明的标签的引用。

该`ldaa`指令将在操作数指定的地址处找到的字节装入累加器 A。在这种情况下，这意味着加载`START`标签后找到的第一个字节。

这`oraa`只是执行`OR`问题陈述指定的操作。

# javascript - 如何切换 Twitter Bootstrap 选项卡窗格 ? Need to switch tabs with select. What's the best practice? My idea is to manipulate class .active with onChange event. But I believe there must be something better. Here's some code sample: <select id="m

> ID：16095080
> 
> 赞同：12
> 
> 时间：2013-04-19T00:01:56.413
> 
> 标签：javascript, jquery, html, css, twitter-bootstrap

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-19T00:30:14.887

我想您可以在任何事件中自己调用“显示”方法。

[http://jsfiddle.net/7Wv5h/40/](http://jsfiddle.net/7Wv5h/40/) [更新]

JS：

```
// jQuery and Bootstrap loaded, you're here on a $(document).on('ready') scope !
$('#your-select').on('change', function (e) {
    // With $(this).val(), you can **(and have to!)** specify the target in your <option> values.
    $('#the-tab li a').eq($(this).val()).tab('show');
    // If you do not care about the sorting, you can work with $(this).index().
    // $('#the-tab li a').eq($(this).index()).tab('show');
}); 
```

HTML：

```
<form>
    <select id='mySelect'>
        <option value='0'>Home</option>
        <option value='1'>Profile</option>
        <option value='2'>Messages</option>
        <option value='3'>Settings</option>
    </select>
</form>
<ul class="nav nav-tabs" id="myTab">
    <li class="active"><a href="#home">Home</a></li>
    <li><a href="#profile">Profile</a></li>
    <li><a href="#messages">Messages</a></li>
    <li><a href="#settings">Settings</a></li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="home">Home content</div>
    <div class="tab-pane" id="profile">Profile content</div>
    <div class="tab-pane" id="messages">Messages content</div>
    <div class="tab-pane" id="settings">Settings content</div>
</div> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-03T18:26:23.563

接受的答案将适用于一组选项卡。如果需要用不同的选择框触发多组选项卡，使用下面的js：

```
$('.select-nav').on('change', function(e) {
    var id = $(this).val();
    $('a[href="' + id + '"]').tab('show');
}); 
```

感谢这个 Flo-Schield-Bobby 的灵感！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-12-14T21:03:41.570

这是您不需要保留链接的解决方案。只是选择。

```
$('#mySelect').on('change', function (e) {
  var $optionSelected = $("option:selected", this);
  $optionSelected.tab('show')
});

<select class="form-control" id="mySelect">
    <option data-target="#home">Home</option>
    <option data-target="#profile">Profile</option>
    <option data-target="#messages">Messages</option>
    <option data-target="#messages">Settings</option>
</select>        

<div class="tab-content">
  <div class="tab-pane active" id="home">
    Home
  </div>
  <div class="tab-pane" id="profile">.
    Profile
  </div>
  <div class="tab-pane" id="messages">
    Messages
  </div>
  <div class="tab-pane" id="settings">
    Settings
  </div>
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-23T13:11:51.747

我需要一个解决方案来处理页面上的多个选项卡，而没有其他解决方案适合我。所以我很快做了这个：[https ://gist.github.com/kingsloi/7ab83b6781636df1fbf1](https://gist.github.com/kingsloi/7ab83b6781636df1fbf1)

```
$(document).ready(function(){

//set the index counter
var i = 0;

//convert all .nav-tabs, except those with the class .keep-tabs
$('.nav-tabs:not(.keep-tabs').each(function(){

    //init variables
    var $select,
        c       = 0,
        $select = $('<select class="mobile-nav-tabs-' +i+ ' mobile-tab-headings "></select>');

    //add unique class to nav-tabs, so each select works independently
    $(this).addClass('nav-tabs-index-'+i);

    //loop though each <li>, building each into an <option>, getting the text from the a href
    $(this).children('li').each(function() {
        $select.append('<option value="'+c+'">' + $(this).text() + '</option>');
        c++;
    });

    //insert new <select> above <ul nav-tabs>
    $(this).before($select);

    //increase index counter
    i++
});

//on changing <select> element
$('[class^=mobile-nav-tabs]').on('change', function (e) {

    //get index from selected option
    classArray      = $(this).attr('class').split(" ");
    tabIndexArray   = classArray[0].split("mobile-nav-tabs-")
    tabIndex        = tabIndexArray[1];

    //using boostrap tabs, show the selected option tab
    $('.nav-tabs-index-'+tabIndex+' li a').eq($(this).val()).tab('show');
});

}); 
```

可以在这里查看 JS 小提琴：http: [//jsfiddle.net/kingsloi/96ur6epu/](http://jsfiddle.net/kingsloi/96ur6epu/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-08T21:57:08.707

谢谢大家的回复。我发现 Nathan Hiemstra 提供的一个是最简单的，并且易于遵循和实施。

但是我注意到它以“一劳永逸”的方式工作。我的意思是，一旦您选择了一个选项并激活了其相应的面板并循环浏览了所有面板，您会注意到面板停止切换（至少在引导程序 4.6.* 中）。

经过一番挖掘，我发现 .tab('show') 方法向 select 的选项元素添加了一个“活动”类。有道理，因为我猜这将与一次活动 1 个的导航选项卡一起使用。

无论如何，我的简单修复（不知道它是否有任何副作用）但似乎工作是在选项元素调用.removeClass（'active'）上调用.tab（'show'）之后。我认为选定的选项无论如何都是“活动”选项，所以为什么要有这个类。但这已经使一个完成和永远工作之间产生了差异。

希望这个小小的修改有帮助

亲切的问候...

# google-cloud-storage - GCS：400 错误请求检索存储桶

> ID：16095081
> 
> 赞同：1
> 
> 时间：2013-04-19T00:02:18.240
> 
> 标签：google-cloud-storage, bad-request

刚刚开始使用 GCS 及其 Java API。改编了 Google Plus[示例](https://code.google.com/p/google-api-java-client/source/browse/plus-serviceaccount-cmdline-sample/src/main/java/com/google/api/services/samples/plus/serviceaccount/cmdline/PlusServiceAccountSample.java?repo=samples)并尝试检索存储桶。

我得到错误：

```
400 Bad Request
{
  "code" : 400,
  "errors" : [ {
    "domain" : "global",
    "message" : "Invalid Value",
    "reason" : "invalid"
  } ],
  "message" : "Invalid Value"
} 
```

这是我的相关代码：

主要的：

```
public static void main(String[] args)
{
    try
    {
        try
        {
            HTTP_TRANSPORT = GoogleNetHttpTransport.newTrustedTransport();

            // service account credential (uncomment setServiceAccountUser for domain-wide delegation)
            GoogleCredential credential = new GoogleCredential.Builder()
                    .setTransport(HTTP_TRANSPORT)
                    .setJsonFactory(JSON_FACTORY)
                    .setServiceAccountId(SERVICE_ACCOUNT_EMAIL)
                    .setServiceAccountScopes(StorageScopes.DEVSTORAGE_READ_WRITE)
                    .setServiceAccountPrivateKeyFromP12File(new File(KEY_FILE_NAME))
                    // .setServiceAccountUser("user@example.com")
                    .build();
            // set up global Storage instance
            storage = new Storage.Builder(HTTP_TRANSPORT, JSON_FACTORY, credential).setApplicationName(APPLICATION_NAME).build();
            // run commands
            getBucket();
            // success!
            return;
        } catch (IOException e)
        {
            System.err.println(e.getMessage());
        }
    } catch (Throwable t)
    {
        t.printStackTrace();
    }
    System.exit(1);
} 
```

获取桶方法：

```
/** Get a BUCKET??? for which we already know the ID. */
private static void getBucket() throws IOException
{
    View.header1("Retrieve a bucket by name.");
    String bucketName = "gs://gsdogs";
    Bucket bucket = storage.buckets().get(bucketName).execute();
    View.show(bucket);
} 
```

常数：

```
private static final String CLIENT_ID = "************.apps.googleusercontent.com";
private static final String KEY_FILE_NAME = "privatekey.p12";

private static final String APPLICATION_NAME = "Elf-MobileCCtv/1.0";

/** E-mail address of the service account. */
private static final String SERVICE_ACCOUNT_EMAIL = "************@developer.gserviceaccount.com";

/** Global instance of the HTTP transport. */
private static HttpTransport HTTP_TRANSPORT;

/** Global instance of the JSON factory. */
private static final JsonFactory JSON_FACTORY = new JacksonFactory();

// We are using GCS not Google plus.
private static Storage storage; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:23:53.753

我不得不将我的存储桶名称从 更改`gs://gsdogs`为`gsdogs`。哇。

# javascript - 使用 Ajax 显示异步函数的值

> ID：16095082
> 
> 赞同：-2
> 
> 时间：2013-04-19T00:02:18.600
> 
> 标签：javascript, ajax, callback

我正在构建一个使用名为`Chat.fetch()`;的函数的项目。它是一个异步函数，从服务器中提取字符串数组。这是一个 ajax 函数，为了项目的目的已经定义了，我只需要正确调用它。我们还有另一个名为 Chat.display() 的函数，它接受一个字符串并在控制台上以项目符号的形式显示它。现在这就是我所得到的：我收到一个错误，说无法读取未定义的属性长度。所以我猜想.length 对于 superArray 是未定义的吗？目标是创建此函数并将其用作 Chat.fetch() 的回调函数。你们知道为什么我会收到这个 .length 错误吗？我很困惑。谢谢！

```
 <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="http://chatbuilder.hackreactor.com/ChatBuilder.js"></script>
  </head>
  <body>
    <script>

    Chat.guide.start();

    <h2>Borken Chat</h2>

    <input class="draft" type="text"/> <button class="send" disabled>send</button>

    <ul class="messages">

      <script>
    var list;
    var superArray=[];
    darray=function(superArray){
      var y=superArray.length;
      for(i=0;i<y;i++){
        Chat.display(x[i]);
      }
    }
    Chat.fetch(darray(list));
  </script>

    </ul>

  </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:11:09.870

这是一个使用 Ajax 的简单页面

```
<!DOCTYPE html>
<html>
 <head>
  <script>
   function loadXMLDoc()
   {
    var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
    {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
        document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
      }
    }
    xmlhttp.open("GET","<<URL>>",true);
    xmlhttp.send();
  }
</script>
</head>
<body>

<div id="myDiv"><h2>Results will go here</h2></div>
<button type="button" onclick="loadXMLDoc()">Get Results</button>

</body>
</html> 
```

看看 xmlHttp.responseText 在哪里使用？那就是你会得到你的字符串的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:11:58.017

我不知道你有什么代码，但基本的想法是这样的（使用 jQuery，不知道它是否在你的堆栈中）。这假设 Chat.fetch() 是同步的，否则您需要在完成时触发事件或使用承诺或其他东西。

```
messages = Chat.fetch();
for (i=0; i<messages.length; i++) {
      $('#chat-window').append( '<br>' + messages[i] );
} 
```

# java - 用 Linux 读取 USB 读卡器？OMNIKEY CardMan 3121 USB

> ID：16095083
> 
> 赞同：2
> 
> 时间：2013-04-19T00:02:22.413
> 
> 标签：java, python, c, bash, driver

我有这个OMNIKEY CardMan 3121 USB，它是一个读卡器，比如读比利时身份证。我现在将它通过 USB 连接到我的 Ubuntu。

![在此处输入图像描述](https://i.stack.imgur.com/euxqm.jpg)

如何在 Linux 下使用 BASH 或 Python 或 Java 或 C 读取卡片数据？使用`lsusb/dmesg`我能看到的所有内容如下。

```
Bus 003 Device 032: ID 076b:3021 OmniKey AG CardMan 3121

[364695.783762] usb 3-2: new full-speed USB device number 32 using xhci_hcd
[364695.805281] usb 3-2: New USB device found, idVendor=076b, idProduct=3021
[364695.805288] usb 3-2: New USB device strings: Mfr=1, Product=2, SerialNumber=0
[364695.805292] usb 3-2: Product: Smart Card Reader USB
[364695.805296] usb 3-2: Manufacturer: OMNIKEY AG
[364695.805707] usb 3-2: ep 0x83 - rounding interval to 128 microframes, ep desc says 192 microframes 
```

跟进：

示例代码：[https ://www.hidglobal.com/Download-EULA?headless=®ionfree=&nid=14983](https://www.hidglobal.com/Download-EULA?headless=&regionfree=&nid=14983)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:04:55.470

您可以使用 PCSC（个人计算机 - 智能卡），它是一种框架/体系结构，用于以同质方式访问不同的卡和读卡器。

存在不同语言的代理。这是 pcsc python 教程的链接：http: [//ludovicrousseau.blogspot.pt/2010/04/pcsc-sample-in-python.html](http://ludovicrousseau.blogspot.pt/2010/04/pcsc-sample-in-python.html)

编辑：在 ubuntu 上安装 pcsc-lite

# python - 将解析的 XML 文件排序为 cfg 文件

> ID：16095084
> 
> 赞同：0
> 
> 时间：2013-04-19T00:02:49.580
> 
> 标签：python, python-2.x

我正在使用此代码将 XML 文件转换为 cfg 文件

```
import sys, lxml.etree

doc = lxml.etree.parse('settings.xml')

foo = open('settings.cfg', 'w')

for el in doc.findall('setting'):
    foo.write("%s=%s\n" % (el.attrib['id'], el.attrib['value']))
foo.close() 
```

有没有办法在我将它们写入文件之前对标签进行排序，并且可能会忽略某些标签。

输入

```
<settings>
    <setting id="auto_backup" value="false" />
    <setting id="exitonbackspace" value="true" />
    <setting id="hidemousepointer" value="true" />
    <setting id="nb_backup_files" value="10" />
    <setting id="refreshonload" value="true" />
    <setting id="screen2" value="false" />
    <setting id="separator" value="" />
    <setting id="show_batch" value="true" />
    <setting id="show_log" value="true" />
</settings> 
```

电流输出

```
auto_backup=false
exitonbackspace=true
hidemousepointer=true
nb_backup_files=10
refreshonload=true
screen2=false   
separator=
show_batch=true
show_log=true 
```

需要输出

```
exitonbackspace=true
screen2=true
refreshonload=true
hidemousepointer=false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:25:38.677

`settings_dict`为在 xml 中找到的所有设置标签创建一个字典。

`settings_order`为您希望设置出现的顺序创建一个列表。

遍历 `settings_order`，如果存在元素，`settings_dict`则可以输出它。

```
import sys

try:
    from lxml import etree
except:
    import xml.etree.cElementTree as etree

doc = etree.parse('settings.xml')

settings_dict = dict([(el.attrib['id'], el) for el in doc.findall('setting')])
settings_order = ['exitonbackspace','screen2', 'refreshonload', 'hidemousepointer']

foo = open('settings.cfg', 'w')
for setting_id in settings_order:
    if setting_id in settings_dict:
        el = settings_dict[setting_id]
        foo.write("%s=%s\n" % (el.attrib['id'], el.attrib['value']))
foo.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:57:28.793

> 电流输出
> 
> 需要输出

嗯...您的输入和当前输出似乎按 id 排序，而您的“要求”输出似乎是随机的。那么如何对您的输入进行排序以达到您的要求输出？我们需要安装读心器模块吗？

如果您的输入如下所示：

```
<settings>
    <setting id="hidemousepointer" value="true" />
    <setting id="show_batch" value="true" />
    <setting id="nb_backup_files" value="10" />
    <setting id="refreshonload" value="true" />
    <setting id="exitonbackspace" value="true" />
    <setting id="screen2" value="false" />
    <setting id="separator" value="" />
    <setting id="auto_backup" value="false" />
    <setting id="show_log" value="true" />
</settings> 
```

你可以像这样按 id 排序：

```
import sys, lxml.etree

doc = lxml.etree.parse('settings.xml')

elements = doc.findall('setting');
sorted_elmts = sorted(elements, key=lambda elmt: elmt.attrib['id']);

for el in sorted_elmts:
    attribs = el.attrib
    print("%s=%s" % (attribs['id'], attribs['value']))

--output:--
auto_backup=false
exitonbackspace=true
hidemousepointer=true
nb_backup_files=10
refreshonload=true
screen2=false
separator=
show_batch=true
show_log=true 
```

# jquery - jQuery .nextAll() 子集过滤

> ID：16095090
> 
> 赞同：0
> 
> 时间：2013-04-19T00:04:11.280
> 
> 标签：jquery, jquery-selectors

```
<ul>
   <li>list item 1</li>
   <li>list item 2</li>
   <li class="block">list item 3</li>
   <li>list item 4</li>
   <li>list item 5</li>
   <li class="block">list item 6</li>
   <li>list item 7</li>
   <li>list item 8</li>
</ul> 
```

您将如何**仅收集项目 4 和 5**？

`$('li.block').nextAll()`当然返回项目 4 到 8，包括 6。

我想知道最好的方法是什么。带有过滤功能的一些丑陋`$.each()`的循环听起来非常复杂。`li's`我希望有一种仅限选择器的方式......到目前为止失败了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:07:34.220

[`nextUntil()`](http://api.jquery.com/nextUntil/)可能是你所追求的。

```
$('li.block').first().nextUntil('.block'); 
```

[js小提琴](http://jsfiddle.net/jMm7z/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:08:17.743

我在做一个假设，但这有效：

```
$('li.block')
    .first()
    .nextUntil(".block")
    .css("background-color","yellow") 
```

演示：http: [//jsfiddle.net/gvwwy/2/](http://jsfiddle.net/gvwwy/2/)

# php - 如何更新损坏 docx 和 xlsx 文件的旧 PHP 代码？

> ID：16095091
> 
> 赞同：0
> 
> 时间：2013-04-19T00:04:23.343
> 
> 标签：php, header, docx, corruption, xlsx

我正在使用一些遗留的 PHP 代码，并且遇到了 Word Doc (docx) 和 Spreadsheet (xlsx) 损坏。

这是 download.php 文件中的当前代码：

```
$new_file_name = stripMySlashes($filename); 
    header("Content-disposition: attachment;filename=$new_file_name");
    header("Content-type: application/octetstream");
    header("Pragma: no-cache");
    header("Expires: 0");
    $client=getenv("HTTP_USER_AGENT");
    $fp=fopen('uploaded_files/'.$folder.'/'.$filename,"r");
    $str=fread($fp,filesize('uploaded_files/'.$folder.'/'.$filename));
    echo $str;
    fclose($fp); 
```

例如，如何避免在 case 语句中检查一堆文件类型？我试过这样的代码没有运气

```
$file="test.docx"; 
header("Pragma: public"); 
header('Content-disposition: attachment; filename='.$file); 
header("Content-type: ".mime_content_type($file)); 
header('Content-Transfer-Encoding: binary'); 
ob_clean(); 
flush(); 
readfile($file); 
```

非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:15:12.093

[关于如何在 chrome 和 IE 上使用 php 下载 word 文件的](https://stackoverflow.com/questions/15218231/how-to-download-word-file-using-php-on-chrome-and-ie)道具

我用它来修复 docx 损坏问题...

```
$new_file_name = stripMySlashes($filename); 

$fdl = @fopen('uploaded_files/'.$folder.'/'.$filename,'rb');
header("Status: 200");
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
header('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT');
header("Pragma: hack");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private", false);
header("Content-Description: File Transfer");
header("Content-Type: application/force-download");
header("Content-Type: application/download");
header("Content-Type: application/octetstream");
header("Content-Disposition: attachment; filename=\"".$new_file_name."\""); 
header("Content-Transfer-Encoding: binary");
header("Content-Length:".filesize('uploaded_files/'.$folder.'/'.$filename));  
if($fdl)
{
    while(!feof($fdl)) {
        print(fread($fdl, filesize('uploaded_files/'.$folder.'/'.$filename)));
        flush();
        if (connection_status()!=0) 
        {
            @fclose($fdl);
            die();
        }
    }
} 
```

# ruby - OpenStruct 和 Hash 之间有哪些重要区别？

> ID：16095094
> 
> 赞同：1
> 
> 时间：2013-04-19T00:04:40.720
> 
> 标签：ruby

他们似乎都完成了同样的事情。哪些用例需要一个又一个？

目前，我正在做一些演讲者课程。我的第一个想法是使用 OpenStruct，但我无法确定使用 Hash 和 OpenStruct 之间的有意义的区别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:14:27.993

1.  对象语法与哈希语法。

如果方法需要具有某些访问器的对象，则 Hash 将不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:15:48.077

> OpenStructs 是 slooooooooooow 和内存密集型的，并且对于大型数据集不能很好地扩展。创建 100 万个 OpenStruct 比创建 100 万个哈希慢约 100 倍。

此处已对此进行了详细讨论：

[什么时候应该使用 Struct 与 OpenStruct？](https://stackoverflow.com/questions/1177594/ruby-struct-vs-openstruct/5440064#5440064)

# jquery - 在同一数组级别嵌套 ng-repeat

> ID：16095101
> 
> 赞同：0
> 
> 时间：2013-04-19T00:05:53.440
> 
> 标签：jquery, angularjs

如何在每 3 次重复后添加一个“div”？

## 这是我的数组：

```
[
   client : "name",
   client : "name",
   client : "name",
   client : "name",
   client : "name",
   client : "name",
   client : "name",
   client : "name",
   client : "name",

] 
```

预期的结果是：

```
<div>name</div>
<div>name</div>
<div>name</div>
<div class="clear"></div>
<div>name</div>
<div>name</div>
<div>name</div>
<div class="clear"></div>
<div>name</div>
<div>name</div>
<div>name</div>
<div class="clear"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:08:46.810

为什么不拆分您的初始数组？

```
[
    [
        client : "name",
        client : "name",
        client : "name"
    ],
    [
        client : "name",
        client : "name",
        client : "name"
    ],
    [
        client : "name",
        client : "name",
        client : "name"
    ]
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T02:08:04.900

创建一个过滤器，将您的数组分成三个一组并嵌套这些组。

过滤器应该是这样的：

```
app.filter('split', function() {
  return function(target) {
    var splitted = [];

    if (!target) {
      return target;
    }

    for(var i = 0; i < target.length; i += 3) {
      splitted.push(target.slice(i, i+3));
    }

    return splitted;
 }
}); 
```

在您的控制器中，只需初始化：

```
$scope.original = [1, 2, 3, 4, 5, 6, 7, 8, 9]; 
```

最后，您的 HTML 应该是这样的：

```
<div ng-repeat="group in original | split">
  <div ng-repeat="item in group">{{item}}</div>
  <div class="clear"></div>
</div> 
```

您可以参数化组长度。这可以通过向过滤器添加第二个参数并传递来实现`ng-repeat="group in original | split:3"`。

并不是说原始数组没有被修改。这是一个[工作 Plunker](http://plnkr.co/edit/MMk8GN?p=preview)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T02:51:32.190

对此的一种解决方案是`$index`在循环内使用角度变量，就像在这个 plunker 中一样。[http://plnkr.co/edit/ycnPtBLmbtV8hwIFTsGd?p=preview](http://plnkr.co/edit/ycnPtBLmbtV8hwIFTsGd?p=preview)

此外，您发布的数据不是有效的数组或有效的 json。我假设您必须处理 json。如果你的意思是一个数组，同样的`$index`方法也可以用于数组。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-19T00:38:11.897

你可以循环遍历数组，检查迭代是否可以被三整除并插入额外的 div 吗？

# arrays - Matlab：非常大的数组每年的观察次数

> ID：16095103
> 
> 赞同：0
> 
> 时间：2013-04-19T00:06:17.320
> 
> 标签：arrays, matlab

我有一个大数组，其中包含 1926 年到 2012 年的每日数据。我想知道每年有多少观察值（每年都有所不同）。我有一个列向量，其日期格式为：

19290101 19290102。. .

这里的一年是七月到明年六月。

所以 19630701 到 19640630

我想用这个向量来查找每年的天数。我需要将观察的数量用作回归的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:33:23.903

我不知道日期是以数字形式存储还是以字符串形式存储；我假设它们是数字。我建议做的是将每个值转换为年份，然后`hist`用于计算每年的日期数。所以尝试这样的事情：

```
year = floor(date/10000);
obs_per_year = hist(year,1926:2012); 
```

这将为您提供一个向量，其中包含从 1926 年开始每年的观察次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:21:36.793

从 7 月 1 日开始的年份系列：

```
bin = datenum(1926:2012,7,1); 
```

用 bin(1) <= x < bin(2), bin(2) <= x < bin(3), ... 将每年的日期向量分箱

```
count = histc(dates,bin); 
```

# mysql - 错误编号：1064 上传 Excel 工作表时

> ID：16095106
> 
> 赞同：-3
> 
> 时间：2013-04-19T00:06:57.050
> 
> 标签：mysql, opencart

```
Notice: Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '=IF(K2>0,"7","5"),'PNW Arms',152,'data/Products Pictures/pnwpic300blkhnt125btip2' at line 1
Error No: 1064
INSERT INTO `product` (`product_id`,`quantity`,`sku`,`upc`,`ean`,`jan`,`isbn`,`mpn`,`location`,`stock_status_id`,`model`,`manufacturer_id`,`image`,`shipping`,`price`,`points`,`date_added`,`date_modified`,`date_available`,`weight`,`weight_class_id`,`status`,`tax_class_id`,`viewed`,`length`,`width`,`height`,`length_class_id`,`sort_order`,`subtract`,`minimum`) VALUES (1,5,'93579','855118002572','','','83964','300BLKHNT125BTIP20','',=IF(K2>0,"7","5"),'PNW Arms',152,'data/Products Pictures/pnwpic300blkhnt125btip20.jpg',1,23.3625,0,NOW(),NOW(),NOW(),0.8,5,0,11,0,5,2.625,1.5,'3','1','0','1'); in /hermes/bosweb26a/b1700/ipg.athetralcom/Athetral/system/database/mysql.php on line 49 
```

我正在尝试在 opencart 管理面板中导入 excel 工作表。仅当我将公式放入我的 Excel 工作表时，我才收到此错误。我尝试不使用公式并导入 excel 工作表，它可以工作，但不能使用 FORMULA。请帮助我找出此错误的根本原因。此外，我是一个托运人，在 excel 表中有大约 40k 产品。当我尝试同时上传 40 k 产品的 excel 表时，它没有给我任何错误，并且我得到空白页（没有上传或发生任何事情）。请让我知道这个错误来自哪个文件，以便我修复它。请给我你的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T07:34:58.520

此 IF 语句将在 Excel 中使用 K2 作为列 ID，但对于 SQL 则没有任何意义。

你不能在excel中复制粘贴公式一个值然后尝试上传文件吗？

* * *

如果您喜欢这个答案，请访问我们的网站[http://punegrocery.in](http://punegrocery.in)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:25:48.320

尝试编辑查询（插入值），使其看起来像这样（您不必像我一样使用折线，我这样做只是为了更好地识别） - 请注意我在要更改的具体值后面添加的注释：

```
INSERT INTO `product` 
    (`product_id`
    ,`quantity`
    ,`sku`
    ,`upc`
    ,`ean`
    ,`jan`
    ,`isbn`
    ,`mpn`
    ,`location`
    ,`stock_status_id`
    ,`model`
    ,`manufacturer_id`
    ,`image`
    ,`shipping`
    ,`price`
    ,`points`
    ,`date_added`
    ,`date_modified`
    ,`date_available`
    ,`weight`
    ,`weight_class_id`
    ,`status`
    ,`tax_class_id`
    ,`viewed`
    ,`length`
    ,`width`
    ,`height`
    ,`length_class_id`
    ,`sort_order`
    ,`subtract`
    ,`minimum`) 
VALUES 
    (1
    ,5
    ,'93579'
    ,'855118002572'
    ,''
    ,''
    ,'83964'
    ,'300BLKHNT125BTIP20'
    ,''
    ,IF(K2 > 0, '7', '5') /* <-- THIS VALUE CHANGED */
    ,'PNW Arms'
    ,152
    ,'data/Products Pictures/pnwpic300blkhnt125btip20.jpg'
    ,1
    ,23.3625
    ,0
    ,NOW()
    ,NOW()
    ,NOW()
    ,0.8
    ,5
    ,0
    ,11
    ,0
    ,5
    ,2.625
    ,1.5
    ,'3'
    ,'1'
    ,'0'
    ,'1') 
```

但我仍然很好奇这个`K2`值是什么 -`product`表中是否包含这样的列？？？

# facebook - FB Graph API：通过 API 获取对象字段列表的方法

> ID：16095115
> 
> 赞同：6
> 
> 时间：2013-04-19T00:08:00.403
> 
> 标签：facebook, facebook-graph-api

有没有办法以编程方式获取特定 facebook 对象的字段列表？

我知道有这方面的文档，但我需要一些自省 - 我们正在构建一个工具，使用户能够从现有字段中进行选择。

我的意思是：给我一个用户字段列表，响应：{“id”，“name”，“first_name”，...}

或者以某种方式获取一个对象的所有字段并从中派生？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T18:09:56.407

Facebook 允许您传递 metadata=1 参数。例如

```
cocacola?metadata=1 
```

为您提供页面的所有可用连接和字段：

```
 "metadata": {
    "connections": {
      "admins": "https://graph.facebook.com/cocacola/admins",
      "admin_settings": "https://graph.facebook.com/cocacola/admin_settings"
    },
    "fields": [
      {
        "name": "id",
        "description": "The Page's ID. No access token or user `access_token`. `string`."
      },
      {
        "name": "name",
        "description": "The Page's name. No access token or user `access_token`. `string`."
      },
      {
        "name": "link",
        "description": "Link to the page on Facebook. No access token or user `access_token`. `string` containing a valid URL."
      },
      {
        "name": "category_lists",
        "description": "The Page's categories. No access token or user `access_token`. `string`."
      },
      {
        "name": "is_published",
        "description": "Indicates whether the page is published and visible to non-admins. No access token or user `access_token`. `boolean`."
      } 
```

貌似是官方的，在[入门手册中找到的](https://developers.facebook.com/docs/getting-started/graphapi/)

# python - 使用数据结构传递多个参数

> ID：16095117
> 
> 赞同：2
> 
> 时间：2013-04-19T00:08:12.423
> 
> 标签：python

是否可以使用单个数据结构传递给具有多个参数的函数？我想做类似以下的事情，但它似乎不起作用。

```
foo_bar = (123, 546)

def a(foo, bar):
    print(foo)
    print(bar) 
```

是否可以执行以下操作：

```
a(foo_bar) 
```

代替：

```
a(foo_bar[0], foo_bar[1]) 
```

这样做的pythonic方式是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-19T00:09:42.723

你想要的是：

```
a(*foo_bar) 
```

有关详细信息，请参阅教程中的[拆包参数列表](http://docs.python.org/3/tutorial/controlflow.html#unpacking-argument-lists)……但实际上没有比这更多的了。

为了完整起见，参考文档位于[Calls](http://docs.python.org/3/reference/expressions.html#calls)中：

> 如果语法`*expression`出现在函数调用中，则`expression`必须计算为可迭代。来自这个可迭代的元素被视为附加的位置参数；如果有位置参数 x1, ..., xN，并且`expression`计算结果为序列 y1, ..., yM，则这等效于使用 M+N 个位置参数 x1, ..., xN, y1, .. 的调用., 是的。

# asp.net - CORS 选项预检悬挂

> ID：16095120
> 
> 赞同：12
> 
> 时间：2013-04-19T00:08:35.713
> 
> 标签：asp.net, asp.net-web-api, cors

我有一个通过 SSL 托管的 ASP Web API 项目。我有另一个使用 API 的 ASP MVC 项目。在调试时，我看到 OPTIONS 请求经常（但并非总是）挂起并阻止其他调用继续进行的行为。

在 Chrome 调试器中，这些只是显示为“待处理”。如果启动 Fiddler，一切正常。我根本看不到任何错误，事情只是挂起。这在它到达授权码之前就失败了，所以我什至不能设置任何断点。

这可能是证书问题吗？防火墙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T15:31:13.433

你可以试试这个：在 web.config 中添加以下节点。

```
<system.webServer>
    <handlers>
         <!-- your other handlers -->
         <remove name="OPTIONSVerbHandler" />
    </handlers>
</system.webServer> 
```

# android - 当 TextToSpeech 动作完成时实现振动

> ID：16095121
> 
> 赞同：0
> 
> 时间：2013-04-19T00:08:37.463
> 
> 标签：android, vibration, google-text-to-speech, onutterancecompleted

我正在开发一个项目，该项目需要在 TextToSpeech 函数完成消息时通过振动发出警报。我已经实现了 TextToSpeech 函数，并且知道如何创建振动，但我不确定在哪里编写振动代码。此外，我遇到的关于如何实现 OnUtteranceCompleted 方法的示例让我感到非常困惑。谁能帮我把 OnUtteranceCompleted 函数放在一起，以及在哪里插入振动代码？这是我的代码：

公共类 TypeNewMessageActivity 扩展 Activity 实现 TextToSpeech.OnInitListener{

```
Button playButton;
EditText typeNewMessageEditText;
TextToSpeech tts;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_type_new_message);
    // Show the Up button in the action bar.
    setupActionBar();
}

/**
 * Set up the {@link android.app.ActionBar}, if the API is available.
 */
@TargetApi(Build.VERSION_CODES.HONEYCOMB)
private void setupActionBar() {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        getActionBar().setDisplayHomeAsUpEnabled(true);
    }

    playButton = (Button)findViewById(R.id.playButton);
    typeNewMessageEditText = (EditText)findViewById(R.id.typeNewMessageEditText);
    tts = new TextToSpeech (this, this);

    playButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            playText();
        }
    });
}

public void onDestroy(){

    if (tts != null){

        tts.stop();
        tts.shutdown();

    }

}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        // This ID represents the Home or Up button. In the case of this
        // activity, the Up button is shown. Use NavUtils to allow users
        // to navigate up one level in the application structure. For
        // more details, see the Navigation pattern on Android Design:
        //
        // http://developer.android.com/design/patterns/navigation.html#up-vs-back
        //
        NavUtils.navigateUpFromSameTask(this);
        return true;
    }
    return super.onOptionsItemSelected(item);
}

@Override
public void onInit(int status) {
    // TODO Auto-generated method stub

    if (status == TextToSpeech.SUCCESS){

        int result = tts.setLanguage(Locale.US);

        if (result == TextToSpeech.LANG_MISSING_DATA || result == TextToSpeech.LANG_NOT_SUPPORTED){

            Log.e("tts", "This language is not supported");
        }else{

            playButton.setEnabled(true);
            playText();

        }
    }else{

        Log.e("tts", "Initialized failed");         
    }

}

public void playText(){

    String text = typeNewMessageEditText.getText().toString();
    tts.speak(text, TextToSpeech.QUEUE_FLUSH, null);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:36:40.420

如果您想在 playText() 讲话结束时振动，请按以下方式更改

```
public void playText(){

String text = typeNewMessageEditText.getText().toString();
HashMap<String, String> myHashRender = new HashMap<String, String>();
myHashRender.put(TextToSpeech.Engine.KEY_PARAM_UTTERANCE_ID, "");
tts.speak(text, TextToSpeech.QUEUE_FLUSH, myHashRender);
} 
```

然后

```
@Override
public void onUtteranceCompleted(String utteranceId)
{
    // code to vibrate.
} 
```

# javascript - 让 jsFiddle 代码在 FF 和 Chrome 上运行时遇到问题

> ID：16095125
> 
> 赞同：0
> 
> 时间：2013-04-19T00:09:22.053
> 
> 标签：javascript, html, css, jsfiddle

我在 jsFiddle 中制作了一个看起来很棒的表格，但是当我将代码复制并粘贴到本地 .html 文件中时，我在运行它时会得到一个空白页。我一直在寻找解决方案一段时间，并且在执行 JS 后我不断看到有关页面加载的信息以及有关 $(document).ready 的信息。我是 JS 新手，所以我有点迷茫。

这是我的 jsFiddle：http: [//jsfiddle.net/DBF5q/29/](http://jsfiddle.net/DBF5q/29/)

这是我将代码添加到的 HTML 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
   <head>
      <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
      <title>Find User</title>
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
      <style>
         <!-- CSS CODE HERE -->
      </style>
      <script type="text/javascript">
         <!-- JS CODE HERE --->

      </script>
   </head>
   <body>
      <div class="Web_OnlineTools_Table" >
        <table id="contact"></table>
      </div>
   </body>
</html> 
```

我很感激你们能给我的任何解决方案或建议。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:27:42.350

问题可能是，在您的 jsfiddle 中，您使用`/echo/json/`服务来模拟 ajax 请求，当您将代码复制到本地系统时，它将不起作用。

为了解决这个

您需要像`data.json`使用 ajax 数据一样创建一个本地文件

```
{
    "accounts": [{
        "customerID": "1",
            "firstName": "Test",
            "lastName": "Test",
            "company": "Humber",
            "address": "Canada",
            "postalCode": "L7Y 3F1",
            "phoneNumber": "(905)451-1313"
    }, {
        "customerID": "2",
            "firstName": "Test",
            "lastName": "Test",
            "company": "Humber",
            "address": "Canada",
            "postalCode": "L7Y 3F2",
            "phoneNumber": "(905)451-1312"
    }               
              ]
} 
```

并更改 ajax 代码，如

```
$(document).ready(function () {
    $.ajax({
        url: "<url-of-the-data.json>",
        datatype: "json"
    }).done(function (data) {
        console.log(data.accounts);
        $('#contact').append('<tr><td>' + "CustomerID" + '</td><td>' + "First Name" + '</td><td>' + "Last Name" + '</td><td>' + "Company" + '</td><td>' + "Address" + '</td><td>' + "Postal Code" + '</td><td>' + "Phone Number" + '</td></tr>');
        $(data.accounts).each(function (index, element) {
            console.log(element);

            $('#contact').append('<tr><td>' + element.customerID + '</td><td>' + element.firstName + '</td><td>' + element.lastName + '</td><td>' + element.company + '</td><td>' + element.address + '</td><td>' + element.postalCode + '</td><td>' + element.phoneNumber + '</td></tr>');
        });
    });
}); 
```

演示：[Plunker](http://plnkr.co/edit/v0T6t9y2QazztmfDwMyy?p=preview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T09:43:34.277

将示例移出 jsFiddle 的最佳方法是复制结果框架源代码（如[http://doc.jsfiddle.net/faq.html](http://doc.jsfiddle.net/faq.html)中所述）

你的小提琴还有一个问题：

您已经开始使用 JS 代码`$(document).ready(function () {`并保持`onLoad`下拉菜单。这导致：

```
 $(window).load(function(){
    $(document).ready(function () { 
```

# php - 使用 paypal 进行购买后，输入什么 js 代码进行重定向

> ID：16095140
> 
> 赞同：0
> 
> 时间：2013-04-19T00:10:52.447
> 
> 标签：php, javascript, paypal

这有点超出我的想象，但基本上我需要在某人使用贝宝从我的网站购买后重定向回我网站上的特定页面。

我正在使用一个插件，并被告知在第 27-31 行（“成功”评论下的行）编辑 paypal.ipn.php 文件。如果有人愿意帮助我，将不胜感激！

```
include "includes/header.php";
?>
<div id="index">
<h1><?php echo PP_THANK_H1?></h1>
<?php
switch ($_GET['action']) { 
    case 'success':      // Order was successful...
echo "<p>".PP_THANKYOU."</p>";
break;

case 'cancel':       // Order was canceled...
echo "<p>".PP_CANCEL."</p>";
break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:17:50.537

您可以`header()`在 PHP 中使用，但应事先删除所有输出（如 HTML 标记）。

例子：

```
<?
include "includes/header.php"; //make sure this file doesn't output anything, else the redirect will give an error

switch ($_GET['action']) { 
    case 'success':      // Order was successful...
    header("Location: www.yoursite.com/redirectothispage.php"); //redirect to this page
    break;

    case 'cancel':       // Order was canceled...
    header("Location: www.yoursite.com/redirectothispageifcancelled.php"); //redirect to this page
    break; 
```

如果您确实在 header.php 中有无法删除的输出，那么元重定向会更好。

而不是`header();`你会使用这个 HTML 代码：

```
echo '<meta http-equiv="refresh" content="0;URL=http://www.yoursite.com/redirecttothispage.com" />'; 
```

# android - 如何使用从 android-holo-colors 生成的微调器

> ID：16095141
> 
> 赞同：0
> 
> 时间：2013-04-19T00:10:54.370
> 
> 标签：android, android-spinner

在寻找自定义微调器的方法时，我听说了[http://android-holo-colors.com](http://android-holo-colors.com)，所以我去了那里并生成了一个微调器。当我下载 zip 时，它只包含一个没有布局文件夹的 res 文件。我将如何在一个简单的裸骨 android 应用程序中使用生成的微调器？正如我想象的那样，我必须将生成的文件链接到我在布局文件中创建的微调器。我该怎么做？说我在布局中的微调器是

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".MainActivity" >

    <Spinner
    android:id="@+id/my_spinner"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

如何将它与生成的 res 东西连接起来？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T00:18:47.727

该工具生成一对自定义的主题和样式 XML。您应该为您的活动/应用程序使用主题，甚至只使用您需要的样式。

编辑：根据要求添加了一个示例

假设您在生成期间选择了“MyApp”，则 zip 将包含（除了可绘制对象和主题定义）一组样式（**res/values/myapp_styles.xml**和**res/values-v11/myapp_styles.xml**）。

为了在您的布局中使用这些资源，您必须：

*   将生成的**res/**文件夹合并到你的项目**res/**文件夹中
*   相应地在您的布局中使用给定的样式。

例如：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".MainActivity" >

<Spinner
android:id="@+id/my_spinner"
style="@style/SpinnerAppTheme"
android:layout_width="wrap_content"
android:layout_height="wrap_content" />

</LinearLayout> 
```

其中**@style/SpinnerAppTheme**指的是在**res/values/myapp_styles.xml**中定义的微调器特定样式（对于 API>=11 ，还有**res/values-v11/myapp_styles.xml ）。**

# python - 将 FBX 转换为 three.js

> ID：16095145
> 
> 赞同：7
> 
> 时间：2013-04-19T00:11:12.133
> 
> 标签：python, three.js, converter, fbx

我正在尝试使用位于此处的三个.js 项目的 utils/converters/fbx/ 文件夹中的 FBX 转换器工具：

[https://github.com/mrdoob/three.js/](https://github.com/mrdoob/three.js/)

我已经安装了 FBX SDK Python 2013.3 绑定（至少我认为我正确地做了那部分）

我将 Python 2.6 安装到 C:\Python26

我将“FBX SDK”文件夹从 C:\Program Files\Autodesk\FBX 复制到 C:\Pythons26\Lib\site-packages

但是当我运行以下命令时：

converty_to_threejs.py my_fbx_file.fbx test_output_file.js

我收到以下错误：

找不到 python FBX SDK！您需要将 FBX SDK 复制到您的 python 安装文件夹中，例如“Python26/Lib/site-packages”文件夹。

我还确保将 C:\Python26 添加到我的 PATH 系统变量中。

有谁知道为什么找不到 FBX SDK 文件夹？我把它准确地放在它想要的地方，但它不会找到它。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-20T04:01:41.060

您需要将Autodesk Python SDK 中的*一些*内容复制到 PYTHONPATH 环境变量中的目录中（或更新 PYTHONPATH 以包含 Autodesk SDK）。

# 前任。Mac OS X (优胜美地)

在 OS X Yosemite 的情况下，我的 PYTHONPATH 既没有也`/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages`没有`/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages`真正在我的 PYTHONPATH 中。所以我在 ~/.bash_profile 中添加了以下内容：

```
# Python 2.7
export PYTHONPATH=/usr/local/lib/python2.7/site-packages:$PYTHONPATH 
```

`/Applications/Autodesk/FBX\ Python\ SDK/2015.1/lib/Python27`并将(FbxCommon.py, fbx.so, fbxsip.so)的内容复制到`/usr/local/lib/python2.7/site-packages`.

# 窗户等

Mac OS X 上使用的相同逻辑可以应用于其他平台，即复制`FbxCommon.py`（以及同一目录中的任何其他文件 - DLL 等）到 PYTHONPATH 中的目录中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-19T04:59:43.720

不要复制FBX SDK文件夹，将内容复制到C:\Pythons26\Lib\site-packages如：cp [FBX_SDK_ROOT]/lib/Python26_x64/* /usr/lib/python2.6/site-packages/就可以了为我工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-22T14:19:03.400

**Mac OS X**

下载[FBX SDK](http://usa.autodesk.com/adsk/servlet/pc/item?id=24535361&siteID=123112)并复制

> /Applications/Autodesk/FBX\ Python\ SDK/2016.1/lib/Python27

至

> /System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-27T16:03:29.767

在 MacOS 上，我也遇到了同样的问题：

```
Could not locate the python FBX SDK!
You need to copy the FBX SDK into your python install folder such as "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages" folder. 
```

我已经复制了`fbx.so`,`FbxCommon.py`和`sip.so`from `SDK_PATH/2014.1/lib/Python2.6/`to `/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages`。

# ruby-on-rails - 除非模型更新，否则缓存查询 - rails

> ID：16095148
> 
> 赞同：0
> 
> 时间：2013-04-19T00:11:25.573
> 
> 标签：ruby-on-rails, ruby-on-rails-3, caching, memcached

我有以下查询：

```
def home
    @posts = Post.where(:isGroup => "public").order('created_at DESC').page(params[:page]).per(20)
end 
```

我想缓存这个查询，除非一个新的 Post 被添加到 Post 模型中。

当我使用

```
expires_in 5.minutes, public: true 
```

它缓存了整个操作，而不仅仅是查询（并且弄乱了整个页面，因为结果是无限滚动的开始，并且页面有登录）。

当我做：

```
cache "home_post", expires_in: 10.minutes do
     @posts = Post.where(:isGroup => "public").order('created_at DESC').page(params[:page]).per(20)
end 
```

它似乎没有显示任何性能改进，并且在添加新帖子时也不会更新。

缓存查询的最佳方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T19:28:10.950

好吧，你也可以`caches_action :home, :expires_in => 5.minutes, :layout => false, :public => true`，它只会缓存查询和数据，而不是动作的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:20:11.087

您可以按原样缓存对象，这`Rails.cache.write`就是`Rails.cache.read`您所需要的。更多细节在这里[https://devcenter.heroku.com/articles/caching-strategies#low-level-caching](https://devcenter.heroku.com/articles/caching-strategies#low-level-caching)

要在每次创建帖子时清理缓存，您可以使用`after_create`然后清除缓存。有关更多信息，请参见此处的示例[http://guides.rubyonrails.org/caching_with_rails.html#sweepers](http://guides.rubyonrails.org/caching_with_rails.html#sweepers)

# r - 如何与两个不同的 `by=var` 变量交互张量积？

> ID：16095152
> 
> 赞同：6
> 
> 时间：2013-04-19T00:12:03.547
> 
> 标签：r, statistics, interaction, gam, mgcv

一个例子：

```
library(mgcv)
N=1000
x1 = seq(1:N)
x2 = log(x1)
x3 = sqrt(x1)
fac1 = ceiling(rnorm(N)*3)
fac2 = ceiling(runif(N)*3)
y = fac1*x2 + x1*x2 + x2 + x3*x2 + x2*(x1/x3)^(.8+fac2/10) + rnorm(N)*x2

mod = gam(y~
        s(as.factor(fac1),bs="re",by=x2) 
    +       s(x2)
    +   s(x1,by=x2)
    +   s(x3,by=x2)
    +   te(x1,x3,by=x2, by=as.factor(fac2))
    ) 
```

最后一个张量不想让我交互它两次。第一个是与模型矩阵中的每一项相乘的连续变量，第二个是一个因子——它为每个因子水平生成不同的表面。

编辑：最后一个术语将相当于`te(x1*x2,x1*x3,by=as.factor(fac2))`. 但是如果我发明了一个新变量`x1x2 = x1*x2`，我就失去了调用的能力`predict.gam`

我该如何编程？我需要上诉`SmoothCon`吗？如果是这样，如何实施的示例将非常有帮助。

谢谢！

（PS：我知道模型的异方差性质。功能，而不是错误。）

# javascript - Javascript Contenteditable - 将光标/插入符号设置为索引

> ID：16095155
> 
> 赞同：7
> 
> 时间：2013-04-19T00:12:11.953
> 
> 标签：javascript, jquery, contenteditable

我将如何修改这个（[如何在 contenteditable 元素（div）中设置插入符号（光标）位置？](https://stackoverflow.com/questions/6249095/how-to-set-caretcursor-position-in-contenteditable-element-div?rq=1)），以便它接受数字索引和元素并将光标位置设置为该索引？

例如：如果我有以下段落：

```
<p contenteditable="true">This is a paragraph.</p> 
```

我打电话给：

```
setCaret($(this).get(0), 3) 
```

光标将移动到索引 3，如下所示：

```
Thi|s is a paragraph. 
```

* * *

我有这个但没有运气：

```
function setCaret(contentEditableElement, index)
{
    var range,selection;
    if(document.createRange)//Firefox, Chrome, Opera, Safari, IE 9+
    {
        range = document.createRange();//Create a range (a range is a like the selection but invisible)
        range.setStart(contentEditableElement,index);
        range.collapse(true);
        selection = window.getSelection();//get the selection object (allows you to change selection)
        selection.removeAllRanges();//remove any selections already made
        selection.addRange(range);//make the range you have just created the visible selection
    }
    else if(document.selection)//IE 8 and lower
    { 
        range = document.body.createTextRange();//Create a range (a range is a like the selection but invisible)
        range.moveToElementText(contentEditableElement);//Select the entire contents of the element with the range
        range.collapse(false);//collapse the range to the end point. false means collapse to end rather than the start
        range.select();//Select the range (make it the visible selection
    }
} 
```

[http://jsfiddle.net/BanQU/4/](http://jsfiddle.net/BanQU/4/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-19T08:49:14.857

这是一个改编自 [Persisting the changes of range objects after selection in HTML](https://stackoverflow.com/questions/13949059/persisting-the-changes-of-range-objects-after-selection-in-html/13950376#13950376)的答案。请记住，这在几个方面并不完美（MaxArt 也是如此，它使用相同的方法）：首先，只考虑文本节点，这意味着`<br>`索引中不包含块元素所隐含的换行符；其次，考虑所有文本节点，即使是那些被 CSS 隐藏的内部元素或内部`<script>`元素；第三，页面上折叠的连续空白字符都包含在索引中；最后，IE <= 8 的规则再次不同，因为它使用了不同的机制。

```
var setSelectionByCharacterOffsets = null;

if (window.getSelection && document.createRange) {
    setSelectionByCharacterOffsets = function(containerEl, start, end) {
        var charIndex = 0, range = document.createRange();
        range.setStart(containerEl, 0);
        range.collapse(true);
        var nodeStack = [containerEl], node, foundStart = false, stop = false;

        while (!stop && (node = nodeStack.pop())) {
            if (node.nodeType == 3) {
                var nextCharIndex = charIndex + node.length;
                if (!foundStart && start >= charIndex && start <= nextCharIndex) {
                    range.setStart(node, start - charIndex);
                    foundStart = true;
                }
                if (foundStart && end >= charIndex && end <= nextCharIndex) {
                    range.setEnd(node, end - charIndex);
                    stop = true;
                }
                charIndex = nextCharIndex;
            } else {
                var i = node.childNodes.length;
                while (i--) {
                    nodeStack.push(node.childNodes[i]);
                }
            }
        }

        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    }
} else if (document.selection) {
    setSelectionByCharacterOffsets = function(containerEl, start, end) {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(containerEl);
        textRange.collapse(true);
        textRange.moveEnd("character", end);
        textRange.moveStart("character", start);
        textRange.select();
    };
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-19T01:07:51.520

`range.setStart`并且`range.setEnd`可以用于*文本*节点，而不是元素节点。否则他们将引发 DOM 异常。所以你要做的是

```
range.setStart(contentEditableElement.firstChild, index); 
```

我不明白你为 IE8 及更低版本所做的事情。你的意思是在哪里使用`index`？

总的来说，如果节点的内容不止一个文本节点，您的代码就会失败。带有 的节点可能会发生这种情况`isContentEditable === true`，因为用户可以从 Word 或其他地方粘贴文本，或者创建新行等。

这是我在框架中所做的改编：

```
var setSelectionRange = function(element, start, end) {
    var rng = document.createRange(),
        sel = getSelection(),
        n, o = 0,
        tw = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, null);
    while (n = tw.nextNode()) {
        o += n.nodeValue.length;
        if (o > start) {
            rng.setStart(n, n.nodeValue.length + start - o);
            start = Infinity;
        }
        if (o >= end) {
            rng.setEnd(n, n.nodeValue.length + end - o);
            break;
        }
    }
    sel.removeAllRanges();
    sel.addRange(rng);
};

var setCaret = function(element, index) {
    setSelectionRange(element, index, index);
}; 
```

这里的技巧是使用`setSelectionRange`函数 - 选择内部的文本范围和元素 - with `start === end`。在`contentEditable`元素中，这会将插入符号置于所需位置。

这应该适用于所有现代浏览器，以及不仅仅是一个文本节点作为后代的元素。我会让你添加检查`start`并`end`在适当的范围内。

对于 IE8 及更低版本，事情有点困难。事情看起来有点像这样：

```
var setSelectionRange = function(element, start, end) {
    var rng = document.body.createTextRange();
    rng.moveToElementText(element);
    rng.moveStart("character", start);
    rng.moveEnd("character", end - element.innerText.length - 1);
    rng.select();
}; 
```

这里的问题是这`innerText`对*这种*事情不利，因为一些空白被折叠了。如果只有一个文本节点，一切都很好，但是对于更复杂的东西，比如你在`contentEditable`元素中得到的那些，事情就搞砸了。

IE8 不支持`textContent`，所以你必须使用 . 来计算字符数`TreeWalker`。但是IE8也不支持`TreeWalker`，所以你必须自己走DOM树......

我仍然必须解决这个问题，但不知何故我怀疑我永远不会。即使我*确实*`TreeWalker`在 IE8 及更低版本中编写了 polyfill ......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-19T20:47:03.650

这是我对蒂姆答案的改进。它消除了关于隐藏字符的警告，但其他警告仍然存在：

*   仅考虑文本节点（<br> 隐含的换行符和块元素不包含在索引中）
*   考虑所有文本节点，即使是那些被 CSS 隐藏的内部元素或内部元素
*   IE <= 8 的规则再次不同，因为它使用了不同的机制。

编码：

```
var setSelectionByCharacterOffsets = null;

if (window.getSelection && document.createRange) {
    setSelectionByCharacterOffsets = function(containerEl, start, end) {
        var charIndex = 0, range = document.createRange();
        range.setStart(containerEl, 0);
        range.collapse(true);
        var nodeStack = [containerEl], node, foundStart = false, stop = false;

        while (!stop && (node = nodeStack.pop())) {
            if (node.nodeType == 3) {
                var hiddenCharacters = findHiddenCharacters(node, node.length)
                var nextCharIndex = charIndex + node.length - hiddenCharacters;

                if (!foundStart && start >= charIndex && start <= nextCharIndex) {
                    var nodeIndex = start-charIndex
                    var hiddenCharactersBeforeStart = findHiddenCharacters(node, nodeIndex)
                    range.setStart(node, nodeIndex + hiddenCharactersBeforeStart);
                    foundStart = true;
                }
                if (foundStart && end >= charIndex && end <= nextCharIndex) {
                    var nodeIndex = end-charIndex
                    var hiddenCharactersBeforeEnd = findHiddenCharacters(node, nodeIndex)
                    range.setEnd(node, nodeIndex + hiddenCharactersBeforeEnd);
                    stop = true;
                }
                charIndex = nextCharIndex;
            } else {
                var i = node.childNodes.length;
                while (i--) {
                    nodeStack.push(node.childNodes[i]);
                }
            }
        }

        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    }
} else if (document.selection) {
    setSelectionByCharacterOffsets = function(containerEl, start, end) {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(containerEl);
        textRange.collapse(true);
        textRange.moveEnd("character", end);
        textRange.moveStart("character", start);
        textRange.select();
    };
}

var x = document.getElementById('a')
x.focus()
setSelectionByCharacterOffsets(x, 1, 13)

function findHiddenCharacters(node, beforeCaretIndex) {
    var hiddenCharacters = 0
    var lastCharWasWhiteSpace=true
    for(var n=0; n-hiddenCharacters<beforeCaretIndex &&n<node.length; n++) {
        if([' ','\n','\t','\r'].indexOf(node.textContent[n]) !== -1) {
            if(lastCharWasWhiteSpace)
                hiddenCharacters++
            else
                lastCharWasWhiteSpace = true
        } else {
            lastCharWasWhiteSpace = false   
        }
    }

    return hiddenCharacters
} 
```

# c# - 值未从视图正确传递给控制器

> ID：16095157
> 
> 赞同：0
> 
> 时间：2013-04-19T00:12:36.167
> 
> 标签：c#, asp.net-mvc, razor

我有一个 MVC 应用程序，当单击链接时，需要根据另一个页面上的相同值显示页面。我不知道为什么传递的是 null 而不是字符串。我的代码如下。

控制器：

```
public string searchQ
    {
        get { return (string)Session["searchQ"]; }
        set { Session["searchQ"] = value; }
    }

    public ActionResult Index()
    {
        Session["InitialLoad"] = "Yes";
        return View();
    }

    [HttpPost]
    public ActionResult Index(string heatSearch)
    {
        ViewBag.SearchKey = heatSearch;
        searchQ = heatSearch;
        return View();
    }

    public ActionResult Index_Perm()
    {
        ViewBag.SearchKey = searchQ;

        return View();
    }

    public ActionResult PartialMainLim(string heatSearch)
    {
        HomeModel C = new HomeModel();
        ChemViewModel D = new ChemViewModel();
        D = C.QueryResults(heatSearch);

        return PartialView(D);
    }

    public ActionResult PartialMain(string heatSearch)
    {
        HomeModel C = new HomeModel();
        ChemViewModel D = new ChemViewModel();
        D = C.QueryResults(heatSearch);

        return PartialView(D);
    } 
```

索引视图中的代码如下所示（这个有效）：

```
@if (ViewBag.SearchKey != null)
{
    <div>
    @Html.Action("PartialMainLim", "Home", (string)ViewBag.SearchKey)
    </div>
 } 
```

在 index_perm 视图中：

```
@if(ViewBag.SearchKey != null)
{
    <div>
    @Html.Action("PartialMain", "Home", (string)ViewBag.SearchKey)
    </div>
 } 
```

当我在两个视图中检查 SearchKey 的值时，它是正确的。然而，尽管 SearchKey 是正确的，但对于“PartialMain”方法，传递的是 null 而不是字符串。不过，这一切都适用于另一种观点。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T07:10:40.153

将值传递回控制器时，您基本上有两种选择：

1.  制作表格

2.  将其作为 url 的一部分传递

Get 方法只接受 url 属性，而 Post 方法也能够处理表单内容。

从你想做的事情来看，我想说你可以使用类似的东西：

```
@Html.Action("PartialMain", "Home", new {heatSearch = (string)ViewBag.SearchKey}) 
```

这应该创建的 url 看起来像 /Home/PartialMain?heatSearch=[content of SearchKey]

编辑：

这只会传递 ViewBag 中存在的值。您从 Session 中得到它，这在 MVC 中是一个糟糕的想法（应该是无会话的）。请考虑您是否真的需要它。通常还有其他方法可以实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:06:23.540

我认为这个问题是你的会话将是空的。框架 ASP.NET MVC 的原则之一是无状态。在 ASP.NET MVC 中使用会话非常可怕。

目前，我认为您可以通过使用默认使用 Session 的**TempData快速修复它。**您可以查看一篇过时的文章以进一步挖掘[ViewData 与 TempData](http://www.squaredroot.com/2007/12/20/mvc-viewdata-vs-tempdata/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:45:03.297

单击 index_perm 视图时，控制器中没有 HttpPost 处理程序。

# python - 为什么 PyQt 的图标没有应有的锐利？

> ID：16095165
> 
> 赞同：4
> 
> 时间：2013-04-19T00:13:29.140
> 
> 标签：python, user-interface, icons, pyqt, ubuntu-unity

我将 Python 2.7 与 PyQt 一起使用。我正在`QtGui.QMainWindow()`使用设置图标

```
self.setWindowIcon(QtGui.QIcon("icon.ico")) 
```

每当我运行我的程序时，图标看起来非常模糊或像素化。这不是我想要的。我希望图标与 Ubuntu 的常用应用程序一样清晰。为了比较，我制作了一个 .desktop 文件，其`Icon`参数指向`icon.ico`. 这个看起来比 PyQt 的图标更清晰。请比较。您应该关注的图标是蓝色世界地图图标。

如何使 PyQt 的图标与另一个图标一样清晰？

![模糊的那个](https://i.stack.imgur.com/HBAYD.png) ![锋利的](https://i.stack.imgur.com/vnlhY.png)

# android - 连接到未经授权的 url

> ID：16095168
> 
> 赞同：1
> 
> 时间：2013-04-19T00:13:40.443
> 
> 标签：android, connection, http-get

尝试创建到 URL 的连接以检查最后的内容修改，使用创建的用户名/密码作为基本身份验证。返回的修改时间应与上次修改时间核对并保存以供参考。如果修改时间较新（较高），则应下载其余内容。

当我尝试建立连接时，我遇到了一个自动化问题。

这是我所做的：

我的登录名和密码：

```
String username = "haythem";
String key ="FU2ra88xuhuf6-#At+aseQub8f8ebr$sweh$thu!Ep?*frusAvEdRamuw9thubr";
String password = AeSimpleSHA1.SHA1(key + username); 
```

我的 SHA1 代码：

```
public static String SHA1(String text) throws NoSuchAlgorithmException, UnsupportedEncodingException {
        MessageDigest md = MessageDigest.getInstance("SHA-1");
        md.update(text.getBytes("UTF-8"), 0, text.length());
        byte[] sha1hash = md.digest();
        return convertToHex(sha1hash);
    } 
```

我的网络服务代码：

```
String mUrl = "http://app-vantage.appspot.com/api4/modified";
HttpGet request = new HttpGet(mUrl);
HttpParams params = new BasicHttpParams();
params.setParameter("Authorization",  "Basic " + android.util.Base64.encodeToString((username + ":" + password).getBytes(), android.util.Base64.DEFAULT));
params.setParameter("User-Agent", "SDKDemo/1.0");
request.setParams(params); 
```

现在我收到 401 错误。

状态 =401

```
<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>401 UNAUTHORIZED</title>
/head>
<body text=#000000 bgcolor=#ffffff>
<h1>Error: UNAUTHORIZED</h1>
</body></html> 
```

我不知道网络服务出了什么问题......

这是文档，我得到了：

身份验证阶段 1 需要使用基本身份验证通过 HTTPS。使用的基本身份验证是生成的用户名（生成类型 4 UUID），密码是应用程序密钥加上用户名作为 UTF-8 哈希，SHA-1 以十六进制发送。例如，应用程序密钥为“abcd”，surename 为 1111-2222，数据为：

用户名：1​​111-2222 密码：SHA1(abcd1111-2222) = 970e1294ff2abd10d037ec73988646584bd8840e

因此： 身份验证：基本 MTExMS0yMjIyOjk3MGUxMjk0ZmYyYWJkMTBkMDM3ZWM3Mzk4ODY0NjU4NGJkODg0MGU=

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-21T20:31:39.903

有几件事立即跳出来：

1.  您正在尝试访问 URL **http://app-vantage.appspot.com/api4/modified**，但根据您的描述，您需要使用**https** :。

2.  您的描述说“生成的用户名（生成类型 4 UUID）”（这意味着随机）。但是，您的用户名（“haythem”）似乎并不是特别随机。

    此外，您应该验证以下内容：

3.  验证您的`convertToHex()`函数是否返回与服务器端期望的相同的情况。如果您正在生成一个大写字母的十六进制并且他们期望小写字母，它有时会导致错误。

4.  如果您碰巧可以访问服务器端，请尝试查看日志以了解发生了什么。

# qt - QGraphicsView到pdf

> ID：16095169
> 
> 赞同：0
> 
> 时间：2013-04-19T00:14:00.523
> 
> 标签：qt, qgraphicsview, qgraphicsscene, qpainter, qprinter

`QGraphicsView/QGraphicsScene`借助滚动条进行导航，我的窗口中成功显示了一个大场景。一切正常。

现在我想以 pdf 格式渲染部分场景。pdf中要渲染的区域应该是窗口中可见的区域以及可见区域上方和下方的矩形。

我已经尝试过了（简单地说，如果使用了水平滚动条，我会忽略）：

```
QPrinter myPrinter(QPrinter::ScreenResolution); 
myPrinter.setOrientation(QPrinter::Landscape);
myPrinter.setPaperSize(QPrinter::A4);
myPrinter.setOutputFormat(QPrinter::PdfFormat);
myPrinter.setPageMargins(0.0, 0.0, 0.0, 0.0, QPrinter::Point);

QPainter myPainter(&myPrinter);
m_pageWidth = myPrinter.width();
m_pageHeight = myPrinter.height();
myPainter.setViewport(0, 0, m_pageWidth, m_pageHeight);

QRectF viewRender = QRect(0.0, 0.0, m_pageWidth, m_pageHeight);

for(int i = 0; i < myScene->getNbPages(); i++)
{
    QRect viewScene = QRect(0, m_pageHeight * i, m_pageWidth, m_pageHeight);
    setSceneRect(viewScene);

    render(&myPainter, viewRender, viewScene);

    if(i + 1 < myScene->getNbPages())
        myPrinter.newPage();
} 
```

但我没有得到预期的结果。例如在这个函数中，`QGraphicsView::drawBackground(QPainter *painter, const QRectF &rect)`rect的左上角不是0，第一页是0，而是107、98，然后是107、1585（但页面高度只有793？！）等等......

任何人都明白发生了什么？谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:29:58.483

[http://qt-project.org/doc/qt-4.8/qgraphicsview.html#mapToScene](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#mapToScene)

[http://qt-project.org/doc/qt-4.8/qgraphicsview.html#mapFromScene](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#mapFromScene)

适当地使用其中一种，你应该得到你想要的结果。

例如，您可以尝试：

```
render(&myPainter, this->mapToScene(viewRender), viewScene);
// assuming this is your QGraphicsView instance 
```

我在另一个我回答的问题中演示了如何使用它：

[如何在 QGraphicsScene 上绘制一个点（鼠标点击）？](https://stackoverflow.com/questions/7830054/how-to-draw-a-point-on-mouseclick-on-a-qgraphicsscene/7831708#7831708)

希望有帮助。

# java - 递归方法调用中的后递增/递减（Java）

> ID：16095176
> 
> 赞同：3
> 
> 时间：2013-04-19T00:14:49.590
> 
> 标签：java, recursion, post-increment, pre-increment

假设您有一个递归方法，并且您在递归调用中增加/减少一个值。为什么在预递增/递减不会导致堆栈溢出异常？

前任。

```
numberCount(currentNumber++); //Stack overflow exception

numberCount(++currentNumber); //No stack overflow exception 
```

提前感谢您的任何澄清。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-19T00:17:21.087

首先

```
numberCount(currentNumber++); //Stack overflow exception 
```

相当于：

```
numberCount(currentNumber);
currentNumber += 1; 
```

而第二个

```
numberCount(++currentNumber); //No stack overflow exception 
```

相当于

```
currentNumber += 1;
numberCount(currentNumber); 
```

需要我解释更多吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-13T07:00:18.553

在这种情况下`numberCount(currentNumber++);`，如果函数抛出异常`numberCount`，变量会`currentNumber`增加吗？

# objective-c - 在 Objective-C 中创建匿名委托对象

> ID：16095177
> 
> 赞同：8
> 
> 时间：2013-04-19T00:14:50.900
> 
> 标签：objective-c, cocoa-touch, cocoa

Cocoa 广泛使用委托来为异步操作提供（除其他外）回调方法。但是，我个人讨厌委托模型以及它如何通过处理非常具体的子操作来污染当前类。`UIAlertView`是一个完美的例子。

因此，我想知道是否可以`UIAlertViewDelegate`通过块简单地创建一个满足委托协议（例如）要求的匿名委托对象，并在需要委托引用的任何地方传递这个匿名对象。

我想像这样：

```
id myDelegate = @{
    alertView:alertView didDismissWithButtonIndex:index = ^ {
        ...
    }
};

UIAlertView* alertView = [[UIAlertView alloc] initWithTitle:... message:... delegate:myDelegate cancelButtonTitle:... otherButtonTitles:...;
[alertView show]; 
```

我听说 Objective-C 有一些很好的动态语言特性，但我不知道如何简单地将方法/选择器添加到对象。这可以以相对简单的方式完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:30:37.363

是的，您提到的语言功能是通过[objective-c 运行时](https://developer.apple.com/library/mac/ipad/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)公开的，尽管没有内置工具来动态创建委托类，并且运行时 api 不是最友好的东西。

有一个名为[A2DynamicDelegate](https://github.com/pandamonia/A2DynamicDelegate#readme)的库，它完全符合您的要求。我没有使用它，但它可能值得研究。

编辑：这种方法的一个问题是不保留委托，因此您需要在其他地方保留强引用，或者添加对 UIAlertView 的关联引用。您可能会发现所有这些大惊小怪是不值得的，只是向您的视图控制器添加一个额外的方法效果更好（您可以在类扩展中遵守委托协议以避免污染您的界面）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T02:49:34.233

一种选择是编写一个类，将委托协议的各个方法的块包装到委托对象中。有关详细信息，请参阅[此答案](https://stackoverflow.com/questions/4824038/how-to-simplify-callback-logic-with-a-block/4840931#4840931)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T14:35:39.983

您应该考虑使用向 中添加块支持的类别`UIAlertView`，这似乎可以解决您的用例。 [UIAlertView-Blocks](https://github.com/jivadevoe/UIAlertView-Blocks)是我最喜欢的一个，虽然还有很多其他的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T00:20:44.870

如果您想将块与基于委托的 API 一起使用，则必须进行一些子类化。例如，请参阅提供基于块的 API 的[`PSAlertView`](https://github.com/steipete/PSAlertView)子类。`UIAlertView`

# android - 无法在三星 Galaxy Tab 2 和 Note 上获取位置

> ID：16095182
> 
> 赞同：0
> 
> 时间：2013-04-19T00:15:44.327
> 
> 标签：android, samsung-mobile, android-location

我使用此代码来获取位置：

```
final LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

        final Criteria locationCritera = new Criteria();
        locationCritera.setAccuracy(Criteria.ACCURACY_COARSE);
        locationCritera.setAltitudeRequired(false);
        locationCritera.setBearingRequired(false);
        locationCritera.setCostAllowed(true);
        locationCritera.setPowerRequirement(Criteria.NO_REQUIREMENT);

        final String providerName = locationManager.getBestProvider(locationCritera, true);

        if (providerName != null && locationManager.isProviderEnabled(providerName)) {
            locationManager.requestLocationUpdates(providerName, 20000, 100, this);
        } else {
            Toast.makeText(this, "GPS turned off!", Toast.LENGTH_LONG).show();
            final Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            startActivity(intent);
        } 
```

ACCESS_FINE_LOCATION 和 ACCESS_COARSE_LOCATION 权限都在清单中定义。

网络和 GPS 都已打开，但我只使用参数“network”（一次）调用 onProviderEnabled。但是相同的代码在 4.0 模拟器和 Onda 4.1 Tab 上运行良好。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:03:47.080

我有一个 GPS 示例。也许您可以将其用作参考：示例在[这里](https://code.google.com/p/wifi-map-with-nokia-here-api/source/browse/src/com/buptcoder/wifimap/location/Locator.java)：

# python - 是否有避免与标准模块名称冲突的 python 命名约定？

> ID：16095188
> 
> 赞同：22
> 
> 时间：2013-04-19T00:16:26.843
> 
> 标签：python, naming-conventions

[PEP 8](http://www.python.org/dev/peps/pep-0008/#descriptive-naming-styles)建议使用单个尾随下划线以避免与 python 关键字冲突，但是与标准 python 模块的模块名称冲突怎么办？这也应该是一个单一的尾随下划线吗？

我在想象这样的事情：

```
import time
time_ = time.time() 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-19T00:24:30.747

PEP 8 似乎没有直接解决它。

当您与关键字冲突时，结尾的下划线显然是*必要*`SyntaxError`的，因为否则您的代码会引发 a （或者，如果您真的很不幸，编译为与您预期的完全不同的东西）。

因此，即使在您有要命名的类属性、实例属性、函数参数或局部变量的上下文中，`class`您也必须使用它`class_`。

但对于`time`. 而且我认为在这些情况下，您*不应该*为`time`.

这是有先例的——stdlib 本身中的多个类具有命名的方法或数据属性`time`（它们都没有`time_`）。

* * *

当然，在某些情况下，您要在与模块相同的范围内创建名称（通常意味着全局变量或函数）。然后你就有更多的混乱可能性，并且隐藏了`time`在当前范围的其余部分访问模块上任何内容的能力。

我认为 90% 的时间，答案将是“这不应该是全球性的”。

* * *

但这仍然留下了另外 10%。

还有一种情况是您的名字*位于*受限制的命名空间中，但该命名空间是您需要访问`time`模块的函数内部的本地范围。

或者，也许，在一个长而复杂的函数中（你不应该有任何，但是......有时你会这样做）。如果对于本地而不是模块的人类读者来说不是很明显`time`，那与混淆解释器一样糟糕。

在这里，我认为剩下的 99% 的时间，答案是“随便取个名字”。

例如，看看这段代码：

```
def dostuff(iterable):
    time = time.time()
    for thing in iterable:
        dothing(thing)
    return time.time() - time # oops! 
```

这里明显的答案是重命名变量`start`或`t0`其他东西。除了解决问题，它也是一个更有意义的名字。

* * *

但这仍然留下了 1%。

例如，有些库会根据协议规范或 .NET 或 ObjC 接口生成 Python 代码，其中的名称不受您的控制；您所能做的就是对翻译后的名称应用某种程序化且明确的规则。在这种情况下，我认为附加`_`到 stdlib 模块名称和关键字的规则可能是一个好主意。

您可能会想出其他示例，其中变量不能随意重命名，并且必须（至少可能）与`time`模块位于相同的范围内，等等。在任何这种情况下，我都会选择`_`后缀。

# ruby-on-rails - Rails：命名空间和非命名空间资源之间的冲突

> ID：16095189
> 
> 赞同：1
> 
> 时间：2013-04-19T00:16:34.940
> 
> 标签：ruby-on-rails, namespaces, associations

我有两个`Review`模型。第一个命名空间为 as `Membership::Review`，第二个命名空间为`Review`. 当我调用非命名空间模型时，Rails 会尝试查找命名空间模型。例如：

```
library.includes(:reviews) 
```

给我这个错误：

```
Expected C:/sites/shelflives/app/models/membership/review.rb to define Review 
```

在我的`Library`模型中，`Review`关联是正确的：

```
has_one :review 
```

即使我明确指定模型，我也会得到相同的错误：

```
has_one :review, :class_name => "Review" 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T03:18:13.837

`config.autoload_paths`当您在模型的`application.rb`with 子文件夹中添加额外内容时，会发生这种错误。

你不需要这样做。所有模型都将通过命名空间自动加载。您只需要使用命名空间的子文件夹来组织正确的结构。

如果您将命名空间与模型一起使用，则可以像这样使用生成器：

```
rails g model membership/review 
```

这将生成正确的命名空间模型并将其保存到`membership`子文件夹。

# javascript - JS div弹出问题

> ID：16095190
> 
> 赞同：0
> 
> 时间：2013-04-19T00:16:35.457
> 
> 标签：javascript, popup

我有一些在单击链接时出现的 div，但我正在努力做到这一点，以便当您单击第二个链接弹出时，任何打开的链接都将在新链接打开之前关闭。一次只能打开一个。

js...

```
<script>
    $.fn.slideFadeToggle = function (easing, callback) {
    return this.animate({
        opacity: 'toggle',
        width: 'toggle'
    }, "fast", easing, callback);
};

$(function () {
    function select($link) {
        $link.addClass('selected');
        $($link.attr('href')).slideFadeToggle(function () {});
    }

    function deselect($link) {
        $($link.attr('href')).slideFadeToggle(function () {
            $link.removeClass('selected');
        });
    }

    $('.contact').click(function () {
        var $link = $(this);
        if ($link.hasClass('selected')) {
            deselect($link);
        } else {
            select($link);
        }
        return false;
    });

    $('.close').live('click', function () {
        deselect();
        return false;
    });
});

                            </script> 
```

div...

```
 <div id='did_{$page_trackid}'  class='arrow_box pop_{$page_trackid}' style=''>  <img src='".$info4['Image']."' class='subtext_img'>
                                                    <h2 class='subtext'><a href='http://www.xxxxxxx.co.uk/dnb/".$info2['username']."'>".$info2['username']."</a></h2>
                                                    <p class='subtext'>".$info3['user_title']."</p>
                                                    <p class='subtext'><a href='".$info3['website_link']."' target='_blank'>".$info3['website_link']."</a>

                                                    </p>

                                                    </div>

                 <div id='did_2_{$page_trackid}'  class='arrow_box2 pop_stats_{$page_trackid}' style=''>  
                                                    <h2 class='subtext'>Stats</h2><br />
                                                    <p class='subtext'>Plays: 1m <br />
                                                                    Downloads: 527, 046

                                                    </p>

                                                    </div> 
```

链接...

```
<div style='position: absolute; z-index: 2; padding-top: 30px; padding-left: 699px;'>

                <a href='#did_{$page_trackid}' class='contact' ><img style='height: 20px;' alt='Posted by' src='http://www.xxxxxxxxxx.co.uk/play1/skin/user-profile2.png' style=''></a> 
                </div>

                <div style='position: absolute; z-index: 1; width: 20px; height: 20px; padding-top: 50px; padding-left: 699px;'>
                <a href='#did_2_{$page_trackid}' class='contact'><img style='height: 20px;' alt='Track stats' src='http://www.xxxxxxxx.co.uk/play1/skin/stats.png' style=''></a>
                </div> 
```

我试过用

```
function select($link) {
$link.addClass('selected');
$('.arrow_box:visible').slideFadeToggle(function () {});
$($link.attr('href')).slideFadeToggle(function () {}); 
```

}

但那是错误的，一个弹出重叠另一个。我有 2 个 div 类（每个 1 个）所以我尝试添加

> $('.arrow_box2:visible').slideFadeToggle(function () {});

但这也行不通。

单击链接以打开新弹出窗口时，我是否以正确的方式关闭任何打开的箭头框或箭头框2？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:36:16.180

我将您的 html 和 js 复制到 jsfiddle 并修改了`select`方法。在这里尝试一下：

[http://jsfiddle.net/mchail/wHyfK/1/](http://jsfiddle.net/mchail/wHyfK/1/)

我相信这现在可以满足您的要求。关键是在切换新的“选定”窗格（以显示它）之前切换任何显示的窗格（以隐藏它们）。

希望这可以帮助。

# entity-framework - 在实体框架中求和相关属性

> ID：16095194
> 
> 赞同：2
> 
> 时间：2013-04-19T00:16:52.133
> 
> 标签：entity-framework, aggregate-functions

我对使用实体框架的导航属性总和有疑问

这是我的示例类

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
    public virtual ObservableCollection<Call> Calls { get; set; }
    [NotMapped]
    public decimal TotalCallDuration { get { return Calls.Sum(c => c.Value); } }

}

public class Call
{
    public int Id { get; set; }
    public int CustomerID { get; set; }
    public virtual Customer Customer { get; set; }
    public decimal Value { get; set; }
    public DateTime Date { get; set; }
} 
```

这很好用，但是当我有数百条记录时，速度很慢

我怎样才能让它更快但又不会失去功能？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:21:46.093

你想要做的是： `customer.TotalCallDuration = context.Call.Sum(x => x.Value).Where(x => x.CustomerID == customer.Id);`

# sql - 列数与第 1.1 行的值数不匹配

> ID：16095198
> 
> 赞同：1
> 
> 时间：2013-04-19T00:17:10.950
> 
> 标签：sql

当我尝试插入此 SQL 语句时，我收到一条错误消息，指出列计数与第 1 行的值计数不匹配。

```
INSERT INTO APPLICANT (fullName, Email, CompanyName, Phone, Fax, GovernmentEmployee, Academic, InternationalAttendee, SpeakerOrPresenter, FirstTimeAttendee)

VALUES
('$fullName','$Email','$CompanyName','$Telephone','$Fax', $GovernmentEmployee, $Academic, $InternationalAttendee, $Speaker, $Presenter, $FirstTimeAttendee); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:20:10.110

您尝试插入列 : `SpeakerOrPresenter`。
两个不同的值：`$Speaker`和`$Presenter`。

因此，要插入的值比接收数据的列要多。

您可以更改您的查询，使其看起来像这样（其中 SpeakerOrPresenter 列分为 2 个不同的列）：

```
INSERT INTO APPLICANT (fullName, Email, CompanyName, Phone, Fax, GovernmentEmployee, Academic, InternationalAttendee, Speaker, Presenter, FirstTimeAttendee)
VALUES
('$fullName','$Email','$CompanyName','$Telephone','$Fax', $GovernmentEmployee, $Academic, $InternationalAttendee, $Speaker, $Presenter, $FirstTimeAttendee); 
```

或者像这样（将扬声器和演示者这两个值合并为一个）：

```
INSERT INTO APPLICANT (fullName, Email, CompanyName, Phone, Fax, GovernmentEmployee, Academic, InternationalAttendee, SpeakerOrPresenter, FirstTimeAttendee)
VALUES
('$fullName','$Email','$CompanyName','$Telephone','$Fax', $GovernmentEmployee, $Academic, $InternationalAttendee, $SpeakerOrPresenter, $FirstTimeAttendee); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:19:05.383

在 INSERT 子句中列出了 10 个列，在 VALUES 子句中列出了 11 个值。每个子句中的编号必须相同。您有 a`$Speaker`和 a `$Presenter`for 值，但只有一`SpeakerOrPresenter`列似乎适用于两者。

# c# - 参考父母删除二叉搜索树

> ID：16095200
> 
> 赞同：0
> 
> 时间：2013-04-19T00:17:17.897
> 
> 标签：c#, binary-search-tree

首先，这是一个学校作业，所以那里。如果不是因为我真的很伤心寻求帮助，我就不会发帖了。

现在我们有了这个我们应该实现的二叉搜索树。基本上，下面这节课就完成了，我给理解一下。

```
 public class BinarySearchTree<T> where T : IComparable<T>
{
    BinarySearchTreeNode<T> _root;

    public BinarySearchTreeNode<T> Root
    {
        get { return _root; }
    }

    public BinarySearchTree()
    {

    }

    public BinarySearchTree(BinarySearchTreeNode<T> root)
    {
        _root = root;
    }

    public void Insert(T value)
    {
        if (_root != null)
            _root.Insert(value);
        else
            _root = new BinarySearchTreeNode<T>(value);
    }

    public void Remove(T value)
    {
        if (_root == null)
            return;

        if (_root.LeftChild != null || _root.RightChild != null)
        {
            _root.Remove(value);
        }
        else if (_root.Value.CompareTo(value) == 0)
        {
            _root = null;
        }
    }

    public bool Find(T value)
    {
        if (_root != null)
            return _root.Find(value);
        else
            return false;
    }

} 
```

这里是我应该实现的类，或者至少就我所知。

```
public class BinarySearchTreeNode<T> where T : IComparable<T>
{
    private T _value;
    public T Value 
    {
        get { return _value; }
    }

    public BinarySearchTreeNode<T> LeftChild
    {
        get { return _leftChild; }
        set { _leftChild = value; }
    }
    private BinarySearchTreeNode<T> _leftChild, _parent, _rightChild;

    public BinarySearchTreeNode<T> RightChild
    {
        get { return _rightChild; }
        set { _rightChild = value; }
    }

    public BinarySearchTreeNode<T> Parent
    {
        get { return _parent; }
        set { _parent = value; }
    }

    public BinarySearchTreeNode(T value)
    {
        _value = value;
        Parent = this;
    }

    public void Insert(T value)
    {
        if (value.CompareTo(Parent.Value) < 0)
        {

            if (LeftChild != null)
            {
                LeftChild.Insert(value);
             }
            else
            {
                LeftChild = new BinarySearchTreeNode<T>(value);
                LeftChild.Parent = this;
            }

        }
        else if (Value.CompareTo(Parent.Value) >= 0)
        {
            if (RightChild != null)
                RightChild.Insert(value);
            else{
                RightChild = new BinarySearchTreeNode<T>(value); 
                Righthild.Parent = this;
                }
        }

    }

    public void Remove(T value) 
    {

        if (LeftChild != null)
            if (value.CompareTo(Parent.Value) < 0)
                    LeftChild.Remove(value);

            else if (RightChild != null)
                if (value.CompareTo(Parent.Value) >= 0)
                    RightChild.Remove(value);
    }

    public bool Find(T value)
    {
        if (value.Equals(Parent.Value)) 
            return true;

        else if (value.CompareTo(Parent.Value) < 0)
        {
            if (LeftChild != null)
                return LeftChild.Find(value);
        }
        else if (value.CompareTo(Parent.Value) > 0)
        {
            if (RightChild != null)
                return RightChild.Find(value);
        }

        return false;
    }

} 
```

问题是我似乎不太了解我应该如何正确实施删除，以便我可以简单地通过指向父母来删除一个节点，例如。任何帮助或提示表示赞赏。

编辑（！）

所以我几乎把所有东西都整理好了，只剩下一件事，那就是 remove 方法的案例 2。

```
 //Case 2: If node has only one child, copy the value of the child to your node, and assign LeftChild or RightChild to null (as is the case)   
            if (RightChild != null && LeftChild == null)
            {
                if (value.CompareTo(this.Parent._value) > 0)
                {
                    Parent.RightChild = RightChild;
                    RightChild = null;
                }
            }
            if (RightChild == null && LeftChild != null)
            {
                if (value.CompareTo(Parent._value) < 0)
                {
                Parent.LeftChild = LeftChild;
                LeftChild = null;
                }
            } 
```

基本上，我完全无法替换原来的节点。如果我有 4 - 3 - 2 （预购）并且我想删除 3，那么我可以这样做并获得 4 - 2。但是，如果我想删除 4 ，它不会做任何事情，尽管它只有一个孩子。我认为那是因为它没有父母，但我不确定如何解决这个问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:28:53.450

[二叉搜索树](http://en.wikipedia.org/wiki/Binary_search_tree#Deletion)

> 需要考虑三种可能的情况： 删除叶子（没有子节点的节点）：删除叶子很容易，因为我们可以简单地将其从树中删除。删除具有一个子节点的节点：删除节点并将其替换为其子节点。删除有两个子节点的节点：将要删除的节点称为 N。不要删除 N。而是选择它的有序后继节点或它的有序前驱节点 R。将 N 的值替换为 R 的值，然后删除 R。

![在此处输入图像描述](https://i.stack.imgur.com/SpM7V.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:38:15.147

在您的 remove 方法中再添加一个条件，其伪代码为：

```
 if (value.CompareTo(Parent.Value) == 0){
        //Case 1: If node has no children, then make Parent = null
        // Case 2: If node has only one child, copy the value of the child to your node, and assign LeftChild or RightChild to null (as is the case)
        //Case 3: Find the in-order successor, copy its value to the current node and delete the in-order successor.

    } 
```

# python - Python 函数（初级）

> ID：16095201
> 
> 赞同：1
> 
> 时间：2013-04-19T00:17:18.280
> 
> 标签：python, python-2.7

我需要编写一个函数来返回字符串的副本，其中最右边的 2 个字符移到前面。这是我的代码：

```
def go_right(mystr):
    if mystr >= 2:
        for i in range(len(mystr)):
                 a = mystr[-2:] + mystr[:-2]
        return a 
```

上面的代码工作正常，但我似乎无法理解为什么我不能这样做：

```
def go_right(mystr):
        if mystr >= 2:
            for i in range(len(mystr)-2):
                     a = mystr[-2:] + mystr
            return a 
```

如果我使用上面的函数，如果我传入 hello，它只会返回“lohello”。为什么 -2 似乎不影响 mystr？我认为它应该遍历除最后 2 个字符之外的每个字符？如果有人可以帮助我澄清这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:21:11.373

在

```
def go_right(mystr):
    if mystr >= 2:
        for i in range(len(mystr)):
                 a = mystr[-2:] + mystr[:-2]
        return a 
```

该变量`i`从不使用，并且 mystr 从不修改。执行 len(mystr) 次也是如此`a = mystr[-2:] + mystr[:-2]`，一遍又一遍地做同样的事情。

因此，改变 for 循环的长度不会改变任何事情也就不足为奇了，因为 for 循环的存在并没有做任何事情。

你的方法相当于

```
def go_right(mystr):
    if mystr >= 2:
        a = mystr[-2:] + mystr[:-2]
    return a 
```

并且这段代码仍然存在错误。您的意思不是 mystr >= 2，而是 len(mystr) >= 2，如下所示：

```
def go_right(mystr):
    if len(mystr) >= 2:
        a = mystr[-2:] + mystr[:-2]
    return a 
```

（比较字符串和数字的语义是始终将它们比较为假，例如`"a" >= 2`is `True`）

但是，现在当 mystr 的长度为 0 或 1 时，这会报错：'UnboundLocalError: local variable 'a' referenced before assignment'。解决此问题的一种方法是：

```
def go_right(mystr):
    if len(mystr) >= 2:
        return mystr[-2:] + mystr[:-2]
    return mystr 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:03:47.160

您还可以将代码大大简化为：

```
def go_right(mystr):
    return mystr[-2:] + mystr[:-2] 
```

长度为 0、1 或 2 的输入将原样返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:22:12.570

我对您为什么为此使用循环感到有些困惑……在这两种情况下，循环都没有真正为您做任何事情。不过，要回答您的问题，这是因为您将所有 mystr 添加到 mystr[-2:]。这是有道理的，因为通过循环运行， mystr 不会改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T00:26:10.227

这里有一个逻辑错误：

```
for i in range(len(mystr)):
    a = mystr[-2:] + mystr[:-2] 
```

`a`您正在为时间分配新值`len(mystr)`。您实际上需要做的就是打电话

```
return mystr[:-2] + mystr[:-2] 
```

请注意您的`i`索引，您没有使用它来访问列表元素，因为您使用的是切片表示法。

请参阅[此问题](https://stackoverflow.com/questions/509211/the-python-slice-notation)以获取更多参考。

# asp.net-mvc - 在使用 MvcContrib TestHelper 时使用 / 模拟 Request.Url

> ID：16095209
> 
> 赞同：3
> 
> 时间：2013-04-19T00:18:14.240
> 
> 标签：asp.net-mvc, unit-testing, tdd, mvccontrib

我正在使用 MvcContrib.TestHelper，并像这样初始化我的控制器：

```
var accountController = new AccountController();

var builder = new TestControllerBuilder();
builder.InitializeController(accountController); 
```

我的问题是，我的内心`AccountController`有：

```
Request.Url.GetLeftPart(UriPartial.Authority); 
```

但是，这返回为空。请求是一个代理。

如何从我的单元测试中进行设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-23T19:41:38.833

这可能已经解决了，但对我有用的是使用模拟框架（如[RhinoMocks](http://www.hibernatingrhinos.com/oss/rhino-mocks)）：

```
var contextMock = MockRepository.GenerateMock<HttpContextBase>();
contextMock.Expect(x => x.Request).Return(new FakeHttpRequest("SOME_RELATIVE_URL", new Uri("http://to.somewhere.com"), new Uri("http://from.somewhere.com")));

controller.ControllerContext.HttpContext = contextMock; 
```

# python - 你能让Counter不写出“Counter”吗？

> ID：16095220
> 
> 赞同：2
> 
> 时间：2013-04-19T00:19:19.463
> 
> 标签：python, counter

因此，当我将 Counter ( `from collections import Counter`) 打印到文件时，我总是得到这个字面量`Counter ({'Foo': 12})`

有没有办法让计数器不按字面意思写出来？所以它会改为写`{'Foo' : 12}`而不是`Counter({'Foo' : 12})`.

是的，它很挑剔，但我厌倦了 grep'n 之后从我的文件中删除的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T00:24:07.053

您可以将 to 传递`Counter`给`dict`：

```
counter = collections.Counter(...)
counter = dict(counter) 
```

* * *

```
In [56]: import collections

In [57]: counter = collections.Counter(['Foo']*12)

In [58]: counter
Out[58]: Counter({'Foo': 12})

In [59]: counter = dict(counter)

In [60]: counter
Out[60]: {'Foo': 12} 
```

* * *

不过，我更喜欢 JBernardo 的想法：

```
In [66]: import json

In [67]: counter
Out[67]: Counter({'Foo': 12})

In [68]: json.dumps(counter)
Out[68]: '{"Foo": 12}' 
```

这样，您就不会丢失`counter`的特殊方法，例如`most_common`，并且在 Python 从 构建 dict 时不需要额外的临时内存`Counter`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:28:34.943

如何将其显式格式化为您想要的形式？

```
>>> import collections
>>> data = [1, 2, 3, 3, 2, 1, 1, 1, 10, 0]
>>> c = collections.Counter(data)
>>> '{' + ','.join("'{}':{}".format(k, v) for k, v in c.iteritems()) + '}'
"{'0':1,'1':4,'2':2,'3':2,'10':1}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:23:46.843

好吧，这不是很优雅，但是您可以简单地将其转换为字符串并切断前 8 个和最后 1 个字母：

```
x = Counter({'Foo': 12})
print str(x)[8:-1] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-19T00:25:53.853

您可以通过进入集合模块的源代码来更改计数器类的 __str__ 方法，但我不建议这样做，因为这会永久修改它。也许只是改变你打印的内容会更有益？

# java - 使用 Hibernate 在数据库中插入对象时询问 ID 的程序

> ID：16095223
> 
> 赞同：0
> 
> 时间：2013-04-19T00:19:32.820
> 
> 标签：java, hibernate, spring-mvc, many-to-one, jointable

我正在尝试将一个项目保存在与图书管理员（这是用户的子类）具有多对一关系的数据库中。下面的代码创建了一个表*librarian_item*，它具有librarian_id 和item_id 作为属性。当我尝试保存数据时，程序不打印 *librarian_id*。图书管理员已设置在项目上，但仍会引发错误。

```
 @ManyToOne(cascade=CascadeType.PERSIST, fetch = FetchType.LAZY)
    @JoinTable(name = "librarian_item",
                joinColumns = @JoinColumn(name = "item_id"),
                inverseJoinColumns = @JoinColumn(name = "librarian_id"))
    @NotNull
    @Valid
    private User librarian; 
```

Item 类具有以下 Hibernate 代码：

```
@OneToMany(cascade=CascadeType.PERSIST)
@JoinTable(name = "librarian_item",
            joinColumns = @JoinColumn(name="librarian_id"),
            inverseJoinColumns = @JoinColumn(name="item_id"))
@Valid
public Collection<Item> getItemList() {
    return itemList;
} 
```

由于 Librarian 是 User 的子类，并且我使用鉴别器来识别 user 表中的每种类型的 User，所以 *librarian_id* 必然是 *user_id*。

我改变了我的代码，因为它在[这里](http://viralpatel.net/blogs/hibernate-one-to-many-annotation-tutorial/)讨论。显然，新方法不会创建新表。在表中创建一个新列，该列引用另一个表以建立关系。

# runtime - 所有可能的排序算法分析

> ID：16095225
> 
> 赞同：0
> 
> 时间：2013-04-19T00:20:00.337
> 
> 标签：runtime, big-o

“APS”（所有可能的排序）算法通过生成 n 元素的所有可能序列来对大小为 n 的数组 A 进行排序，并且对于每个序列，检查元素是否按排序（升序）顺序排列。

```
a) What is the worst-case time complexity of APS? Explain your logic / show your work. 
```

我的答案：

最坏的情况是 O(n!)，因为它会生成所有可能的序列，然后检查是否已排序。

最好，我希望有人告诉我我是对还是错，以及如何得到答案。这个大 O 的东西让我感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T00:26:51.233

APS 正在生成 N 个元素的所有可能[排列](http://en.wikipedia.org/wiki/Permutation)，这给了你 n! 不同的可能排序，所以你是正确的。

证明它是[O](http://en.wikipedia.org/wiki/Big_O_notation#Infinite_asymptotics) (n!) 只需要你证明运行时是 n! 的渐近上限，这基本上意味着你必须证明：

> f(n) = O(n!) 如果对于某些 m 和 c，|f(n)| < |m * n!| 对于所有 n > c。

如果你写出了实际的算法，证明这一点会更容易，但如果你遍历你的逻辑，它应该可以解决问题。

# jquery - 如何使用jQuery将元素居中到鼠标的位置？

> ID：16095227
> 
> 赞同：1
> 
> 时间：2013-04-19T00:20:09.493
> 
> 标签：jquery

所以我有这个盒子，当我移动鼠标时我想跟随鼠标，但希望鼠标始终位于盒子的中心。我并不是说盒子必须，而是在盒子下面，但我的意思是让盒子只能垂直上下移动以与鼠标对齐。

我尝试了几种方法，但无法让它工作，当我做了一点时，它没有正确居中。

这是我的 JS：

```
$( ".wrapper" ).mousemove(function(e) {
    var box = $( '.box' ).outerHeight();

    box = box / 2;

    $( '.box' ).css( 'top', ( e.pageY - box ) + 'px' );
} ); 
```

这是一个小提琴-> [http://jsfiddle.net/rCabj/](http://jsfiddle.net/rCabj/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:24:51.000

[http://jsfiddle.net/rCabj/1/](http://jsfiddle.net/rCabj/1/)

在 .box 上

```
position: absolute; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:25:01.170

将 CSS 更改为 position: absolute 可以解决问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T00:25:40.550

更改`top`为`marginTop`。

```
 $( '.box' ).css('marginTop', ( e.pageY - box ) + 'px' ); 
```

***[演示。](http://jsfiddle.net/rCabj/3/)***

# regex - DFA到正则表达式时间复杂度

> ID：16095230
> 
> 赞同：3
> 
> 时间：2013-04-19T00:20:13.697
> 
> 标签：regex, algorithm, time-complexity, automata

我正在研究 Ullman 等人在第 2 版第 151 页的“自动机理论、语言和计算简介”中将 DFA 转换为正则表达式的时间复杂度分析。这种方法有时被称为[传递闭包方法](https://cs.stackexchange.com/questions/2016/how-to-convert-finite-automata-to-regular-expressions)。我不明白他们是如何在 O((n^3)*(4^n)) 时间复杂度中提出 4^n 表达式的。

我知道 4^n 表达式关于空间复杂度是成立的，但是，关于时间复杂度，似乎我们在每次迭代中只对每对状态执行四个恒定时间操作，使用之前迭代的结果。我到底错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-21T12:24:51.093

这是对未使用正确数据结构的算法复杂性的粗略限制。除了作者显然不想在这里优化之外，我认为没有什么要解释的，可能是因为他们的主要观点是正则表达式至少与 DFA 一样具有表达力，并且因为他们认为优化这个指数毫无意义时间算法。

有三个嵌套循环，每个循环有 n 次迭代；在外循环的迭代 k 期间构造的正则表达式归纳地具有 O(4^k) 的大小，因为它们是由最多四个在前一次迭代期间构造的正则表达式构造的。如果算法*复制了这些子表达式*，并且我们高估了所有迭代的正则表达式大小限制在 O(4^n)，那么我们得到 O(n^3 4^n)。

显然我们可以做得更好。在不消除复制的情况下，我们可以通过适当地限制几何和得到 O(sum_{k=1}^nn^2 4^k) = O(n^2 (n + 4^n))。此外，正如您所指出的，我们根本不需要复制，除非最后我们同意 templatetypedef 输出必须完全写出，运行时间为 O(n^3) 来准备正则表达式和 O(4^n) 写出来。这个版本的空间复杂度等于时间复杂度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T05:34:37.897

我想你的疑问是关于**n ³**时间复杂度。

让我们假设**R [ij] ^k**表示将自动机从状态 **q [i]**转换到**q [j]**而不通过任何高于**q [k]**的状态的所有字符串的集合。

那么**R [ij] ^k**的迭代公式如下所示，

**R [ij] ^k = R [ik] ^(k-1) (R [kk] ^(k-1) ) ^* R [kj] ^(k-1) + R [ij] ^(k-1)**。

这种技术类似于全对最短路径问题。唯一的区别是我们采用正则表达式的并集和连接，而不是对距离求和。所有对最短路径问题的时间复杂度为**n ³**。`DFA`因此，我们也可以预期to `Regular Expression`Conversion具有相同的复杂性。同样的方法也可以用于转换`NFA`和`ε-NFA`对应的正则表达式。

的主要问题`transitive closure approach`是它创建了非常大的正则表达式。这个大的长度是由于连接项的重复联合。

# android - 选择微调器时如何更改对象的值？

> ID：16095234
> 
> 赞同：0
> 
> 时间：2013-04-19T00:20:50.463
> 
> 标签：android, object, spinner

我有一个对象：

```
PanggilOlahraga( nama, met, waktu, kalori ) 
```

我有一个微调器，其中包含*“waktu”*值。

选择旋转器值时，我想更改*“ waktu”*值。

```
@Override
        public View getView(int position, View convertView, ViewGroup parent) {

            ViewHolder holder = null;

            Log.d("ConvertView", String.valueOf(position));

            PanggilOlahraga olahraga = PanggilOlahragaList.get(position);
            if (convertView == null) {

                LayoutInflater vi = (LayoutInflater)getSystemService(
                    Context.LAYOUT_INFLATER_SERVICE);
                    convertView = vi.inflate(R.layout.olahragainet_info, null);

                    holder          = new ViewHolder();
                    holder.nama     = (TextView) convertView.findViewById(R.id.tvNamaOlgaInet);
                    holder.checkbox = (CheckBox) convertView.findViewById(R.id.cbOlga);
                    holder.sp       = (Spinner) convertView.findViewById(R.id.spWaktu);

                    ArrayAdapter<String> adapter1 = new ArrayAdapter<String>(
                                getApplicationContext(), R.layout.my_spinner_textview, items1); 

                    adapter1.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
                    holder.sp.setAdapter(adapter1);     
                    holder.sp.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {

                        public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {

                            Object item     = parent.getItemAtPosition(pos);
                            txtWaktu        = item.toString();
                            double dwaktu   = Double.parseDouble(txtWaktu);

                            olahraga.setWaktu(dwaktu);

                        }
                        public void onNothingSelected(AdapterView<?> parent) {

                        }
                   });
                    convertView.setTag(holder);

                    // ACTION CLICKED ON CHECK BOX
                    holder.checkbox.setOnClickListener( new View.OnClickListener() {  
                        public void onClick(View v) {  
                            CheckBox cb = (CheckBox) v ;  
                            PanggilOlahraga olahraga = (PanggilOlahraga) cb.getTag();  
                            olahraga.setSelected(cb.isChecked());
                        }  
                    });
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            kalori = olahraga.getMet() * olahraga.getWaktu() / 60.0 * berat;
            holder.nama.setText(olahraga.getNama());
            holder.checkbox.setChecked(olahraga.isSelected());
            holder.checkbox.setTag(olahraga);
            olahraga.setKalori(kalori);

            return convertView;

        } 
```

但是，我在*olahraga.setWaktu(dwaktu)*中有一个错误。

它说*“不能在以不同方法定义的内部类中引用非变量 olahraga”*

任何人都可以帮助我吗？

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:30:47.847

改变

```
PanggilOlahraga olahraga = PanggilOlahragaList.get(position); 
```

至

```
final PanggilOlahraga olahraga = PanggilOlahragaList.get(position); 
```

并且您将能够在您的匿名类中引用它。

# java - 修改编辑器数据时，Eclipse RCP 视图不会更新

> ID：16095237
> 
> 赞同：4
> 
> 时间：2013-04-19T00:21:10.610
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, rcp

我正在尝试做一些看起来应该很常见的事情，所以我很惊讶我很难找到解决方案。

我有一个简单的 Eclipse RCP 应用程序。它由一个视图组成，其中包含一个分层显示 xml 文件元素的 treeViewer。另一面是一个编辑器，它包含各种字段，例如文本框等，用于显示和修改 xml 值。treeviewer 在元素名称旁边显示图标，我要做的是在编辑器中进行更改时将图标更改为图标的“修改”版本 - 表示该元素的值已更改。这与 Eclipse 在与 subversion 集成时显示文件已从 Package Explorer 中的基本修订版修改后的方式非常相似。

我将尝试仅显示与此特定问题相关的代码部分，并希望我不会遗漏任何内容。这是编辑器类：

```
public class XmlEditor extends EditorPart
{
    protected boolean dirty = false;

    public void setDirty(boolean value)
    {
        dirty = value;
        firePropertyChange(PROP_DIRTY);
    }
} 
```

这是树的视图：

```
public class TreeView extends ViewPart implements IPropertyChangeListener {
    public void createPartControl(Composite parent) {
        treeViewer = new TreeViewer(parent, SWT.BORDER | SWT.MULTI | SWT.V_SCROLL);
        getSite().setSelectionProvider(treeViewer);

        treeViewer.setLabelProvider(new TreeObjLabelProvider());
        treeViewer.setContentProvider(new TreeObjContentProvider());

        PlatformUI.getWorkbench().getWorkingSetManager().addPropertyChangeListener(this);
    }

    public void propertyChange(PropertyChangeEvent event) {
        if (event.getProperty().equals(IWorkbenchPartConstants.PROP_DIRTY)) {
            treeViewer.refresh();
        }
    }
} 
```

在这种情况下，`TreeView::propertyChange()`即使`firePropertyChange()`被解雇，也不会被调用。任何想法为什么？我也对不涉及 PropertyChangeListener 的任何其他想法持开放态度，这似乎是当时最简单的方法。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T21:03:32.853

这是我最终解决问题的方法：

1.  更改 TreeView 以实现`IPropertyListener`而不是`IPropertyChangeListener`
2.  实现了`propertyChanged()`方法来执行`treeViewer.refresh()`
3.  在该`XmlEditor::createPartControl()`方法中，我获得了对该`Treeview`部分的引用，然后将其添加到属性侦听器中，如下所示：
    *   `TreeView treeView = (TreeView) getSite().getPage().findView(TreeView.ID);`
    *   `addPropertyListener(treeView);`

现在，就像我需要的那样，`TreeView::propertyChanged()`在之后被调用。`firePropertyChanged()`需要大量的实验来了解`IPropertyListener`和和`IPropertyChangeListener`之间的区别。`addPropertyListener()``addPartPropertyListener()`

感谢 nitind 给了我一个新的视角，并向我展示了装饰器，这绝对是正确的方法，而不是将树形图标更改为修改后的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T04:23:58.110

您在编辑器部分触发了与工作集管理器无关的属性更改。您所做的任何事情都没有将视图连接到编辑器。如果您希望两者相互交谈，请编写它们以相互交谈，或者至少通过进行您描述的修改来创建事件并对事件做出反应。

我也很确定这不是 SVN 显示文件已被修改的方式。SVN 可能提供了一个装饰器：[http ://eclipse.org/articles/Article-Decorators/decorators.html](http://eclipse.org/articles/Article-Decorators/decorators.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-26T06:34:09.183

在您的创建部件控件中添加这串代码，这可能会对您有所帮助

```
ResourcesPlugin.getWorkspace().addResourceChangeListener(new IResourceChangeListener() {

        @Override
        public void resourceChanged(IResourceChangeEvent event) {
            treeViewer.refresh();
        }
    }); 
```

# java - 读取未知大小的图像字节数组以在 Imageview 中显示

> ID：16095240
> 
> 赞同：0
> 
> 时间：2013-04-19T00:21:30.910
> 
> 标签：java, android, bytearray, jpeg

我找不到与我的申请类似的东西，所以我想我会问一个新问题。我是开发 android（和一般的 java）的新手，但在 C 和 Visual Basic 方面有一些编程经验。我正在使用 JPEG TTL 相机（Link Sprite LS Y201）并拍照以从 TCP 服务器发送到 android 客户端设备。在客户端，我使用异步任务不断地从套接字获取数据。到目前为止，我已经能够获取一些字节并将它们存储在一个数组中。以下是我的问题： 1\. 从套接字传入的数据量是未知的。怎么解释呢？2.如何检查是否所有的数据都被读取了？JPEG 图像数据以十六进制值 0xFFD8 开始，结束值为 0xFFD9。3.如何将这些数据更新到imageview？

也感谢您抽出宝贵时间查看此内容。我真的很感激我能得到的任何帮助！

我目前拥有的代码如下：

```
 // ----------------------- THE NETWORK TASK - begin ----------------------------
public class NetworkTask extends AsyncTask<Void, byte[], Boolean> {
    Socket nsocket; //Network Socket
    InputStream nis; //Network Input Stream
    OutputStream nos; //Network Output Stream
    BufferedReader inFromServer;//Buffered reader to store the incoming bytes

    @Override
    protected void onPreExecute() {
        //change the connection status to "connected" when the task is started
        changeConnectionStatus(true);
    }

    @Override
    protected Boolean doInBackground(Void... params) { //This runs on a different thread
        boolean result = false;
        try {
            //create a new socket instance
            SocketAddress sockaddr = new InetSocketAddress("192.168.1.115",5050);
            nsocket = new Socket();
            nsocket.connect(sockaddr, 5000);//connect and set a 10 second connection timeout
            if (nsocket.isConnected()) {//when connected
                nis = nsocket.getInputStream();//get input
                nos = nsocket.getOutputStream();//and output stream from the socket
                BufferedInputStream inFromServer = new BufferedInputStream(nis);//"attach the inputstreamreader"
                while(true){//while connected
                    ByteArrayBuffer baf = new ByteArrayBuffer(256);
                    int msgFromServer = 0;
                    while((msgFromServer = inFromServer.read()) != -1){;//read the lines coming from the socket
                        baf.append((byte) msgFromServer);
                        byte[] ImageArray = baf.toByteArray();
                        publishProgress(ImageArray);//update the publishProgress
                    }

                }
            }
        //catch exceptions
        } catch (IOException e) {
            e.printStackTrace();
            result = true;
        } catch (Exception e) {
            e.printStackTrace();
            result = true;
        } finally {
            closeSocket();
        }
        return result;
    }

    //Method closes the socket
    public void closeSocket(){
        try {
            nis.close();
            nos.close();
            nsocket.close();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    //Method tries to send Strings over the socket connection
    public void SendDataToNetwork(String cmd) { //You run this from the main thread.
        try {
            if (nsocket.isConnected()) {
                nos.write(cmd.getBytes());
                nos.flush();
            } else {
                outputText("SendDataToNetwork: Cannot send message. Socket is closed");
            }
        } catch (Exception e) {
            outputText("SendDataToNetwork: Message send failed. Caught an exception");
        }
    }

    //Methods is called every time a new byte is received from the socket connection
    @Override
    protected void onProgressUpdate(byte[]... values) {
        if (values.length > 0) {//if the received data is at least one byte
            if(values[85]== 255 ){//Start of image is at the 85th byte

                ///This is where I get lost. How to start updating imageview with JPEG bytes?

            }
        }

    }

    //Method is called when task is cancelled
    @Override
    protected void onCancelled() {
        changeConnectionStatus(false);//change the connection to "disconnected"
    }

    //Method is called after taskexecution
    @Override
    protected void onPostExecute(Boolean result) {
        if (result) {
            outputText("onPostExecute: Completed with an Error.");
        } else {
            outputText("onPostExecute: Completed.");
        }
        changeConnectionStatus(false);//change connectionstaus to disconnected
    }
}
// ----------------------- THE NETWORK TASK - end ---------------------------- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-15T00:19:25.463

1.  在服务器端，在发送每个图像之前，您可以发送一个整数，其中包含您要传输的图像的大小。
2.  该`available()`功能可以用于此。`inFromServer.available() == 0`将告诉您是否已读取所有数据。
3.  以下代码将执行此操作：

    ```
    byte[] ImageArray = baf.toByteArray();
    Bitmap bitmap = BitmapFactory.decodeByteArray(ImageArray, 0, ImageArray.length);
    imageView.setImageBitmap(bitmap); 
    ```

希望你觉得这个有用！祝你好运！

# android - 允许 Android 应用中的所有字符

> ID：16095243
> 
> 赞同：0
> 
> 时间：2013-04-19T00:21:46.217
> 
> 标签：android, character, special-characters

我正在帮助开发一个适用于 Android 的应用程序，该应用程序有时会使用来自世界不同地区的特殊字符，特别是在列出人名时。因此，一个很好的例子是名称上的西班牙或瑞典口音。该应用程序未正确呈现这些。我需要向 Web 服务添加什么才能正确显示这些重音符号？它们在我的数据库中正确显示，但在应用程序中却没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:32:31.803

这是一个示例： [http ://docs.oracle.com/javase/tutorial/i18n/text/string.html](http://docs.oracle.com/javase/tutorial/i18n/text/string.html)

```
String original;
original = new String("A" + "\u00ea" + "\u00f1" + "\u00fc" + "C"); 
```

> 打印时，命名的字符串`original`显示为：
> 
> **`AêñüC`**
> 
> 要将 String 对象转换为 UTF-8，请调用**getBytes** 方法并指定适当的**编码作为参数**。getBytes 方法返回 UTF-8 格式的字节数组。要从非 Unicode 字节数组创建 String 对象，请使用 encoding 参数调用 String 构造函数。进行这些调用的代码包含在 try 块中，以防指定的编码不受支持：

```
try {
     byte[] utf8Bytes = original.getBytes("UTF8");
     byte[] defaultBytes = original.getBytes(); 
     String roundTrip = new String(utf8Bytes, "UTF8");
     System.out.println("roundTrip = " + roundTrip);
     System.out.println();
     printBytes(utf8Bytes, "utf8Bytes");
     System.out.println();
     printBytes(defaultBytes, "defaultBytes"); 
     } catch (UnsupportedEncodingException e) {
     e.printStackTrace(); 
     } 
```

> StringConverter 程序打印出 utf8Bytes 和 defaultBytes 数组中的值来演示一个重点：转换后的文本的长度可能与源文本的长度不同。一些 Unicode 字符转换为单个字节，其他字符转换为字节对或三个字节。

# c++ - 如何将文本文件读入指针数组？(C++)

> ID：16095244
> 
> 赞同：0
> 
> 时间：2013-04-19T00:22:00.127
> 
> 标签：c++, codeblocks

我需要做的是将文本文件读入数组。每行有四个部分；名字、ID、身高和体重。文本文件有13行，所以我需要做13次。我将编写一个循环以使其工作（并将在一个函数中，我将解析数组。）我知道如何使用基本数组来完成它，但我们应该为此使用结构。我环顾四周试图找出如何做到这一点，但没有什么对我真正有用。这是我到目前为止的代码。

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <string>
using namespace std;
struct person
{
string firstname;
int id;
double height;
double weight;
};
int main()
{
person array[13];
person *ptr;
ptr = &array[0];
ifstream inData;
inData.open("peeps.txt");
while(!inData.eof())
{
    for(ptr = &array[0]; ptr < &array[13];ptr++)
    {
        inData >> person[ptr].firstname >> person[ptr].id
        >> person[ptr].height >> person[ptr].weight;

    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:24:51.553

你这样做的方式相当混乱，但它几乎是正确的。在`for`循环内部，您正在尝试 index `person`，这是一个类。这没有多大意义。相反，您在每次迭代时`ptr`都指向`person`数组中的每个对象，因此您可以取消引用它并分配给它的成员：

```
inData >> ptr->firstname >> ptr->id
>> ptr->height >> ptr->weight; 
```

然而，更糟糕的是，`for`当你这样做时，你在循环中有未定义的行为`array[13]`。索引 13 处没有元素，因此您不能尝试像这样访问它。您可以将条件更改为`ptr <= &array[12]`，但这仍然非常混乱。

不过要清楚，您绝对没有您所说的指针数组。相反，您有一个`person`s 数组。

```
ptr = &array[0]; 
```

这将获取`person`数组中第一个的地址并将其分配给指针。通过利用数组到指针的转换，您可以更轻松地做到这一点：

```
ptr = array; 
```

此外，`eof()`由于您的`while`标准通常不是一个好主意。它不能很好地指示下一组读取是否会成功。

# c - 在C中将long long转换为字符串？

> ID：16095248
> 
> 赞同：13
> 
> 时间：2013-04-19T00:22:22.183
> 
> 标签：c, string, casting, long-long

我想将 long long 转换为 C 中的字符串。

```
long long x = 999; 
```

我想将 x 转换为字符串。我怎么能这样做呢？

谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-19T00:38:02.160

```
long long x = 999;
char str[256];
sprintf(str, "%lld", x);
printf("%s\n", str); 
```

# wpf - 图像闪烁或闪烁动画

> ID：16095250
> 
> 赞同：2
> 
> 时间：2013-04-19T00:22:51.320
> 
> 标签：wpf, xaml, storyboard

我一直在寻找一段时间，但找不到任何东西。我希望能够在 wpf 中的图像元素上添加一种微光或闪亮的动画。

本质上，我在这里所追求的效果与使用“箔”的交易卡所获得的效果相同。

我想要一张图片，然后可以随意添加这个动画。我在想可能是某种用户控件或模板。希望足够通用，我可以向它扔一个图像，它只会覆盖图像并运行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:24:48.057

一个可以轻松转换为控件的简单结构是将图像嵌套在 Grid 中并添加第二个 Grid（在顶部）作为同级。

可以为第二个网格提供一个线性渐变画笔，该画笔主要是透明的，但确实包含白色微光。

这个画笔可以动画；您可以移动它并更改网格/画笔的不透明度。

这样您就不会更改图像。

# ruby-on-rails-3 - Rails 查找方法 - 从“：include”表参数中选择列

> ID：16095252
> 
> 赞同：1
> 
> 时间：2013-04-19T00:23:00.950
> 
> 标签：ruby-on-rails-3, activerecord

下面的 find 方法返回所有记录，但不包括场所表列。有没有办法可以修改以下内容以包含来自场地的列？我试过了`:select => 'venues.id'`，而且`:select => 'venues.*'`，无济于事。也许这是 rails find 方法的限制。可以将查询重写为“Item.where”以包含所有列吗？

```
@vehicles = Vehicle.find(:all, 
      :select => '*',
      :joins => [:vehicle_status, :category, :user],
      :include => [:venue],
      :conditions => ["vehicles.client_id = ? ", current_user.client_id]
      ) 
```

我正在使用导轨 3.2.11。

另外，当我`:select => 'vehicles.*, venues.*'`在控制台上使用并获取以下查询时，它会显示正在选择的场所字段，但它们不会出现在返回的 json 中：

```
 SELECT "vehicles"."id" AS t0_r0, ... "vehicles"."created_at" AS t0_r33, 
"vehicles"."updated_at" AS t0_r34, "venues"."id" AS t1_r0, "venues"."client_id" AS t1_r1, 
"venues"."venue_name" AS t1_r2, "venues"."created_at" AS t1_r3, "venues"."updated_at" AS t1_r4 
FROM "vehicles" INNER JOIN "vehicle_statuses" ON "vehicle_statuses"."vehicle_status_code" = 
"vehicles"."status_code" INNER JOIN "categories" ON "categories"."id" = 
"vehicles"."category_id" INNER JOIN "users" ON "users"."id" = "vehicles"."created_at_user_id" 
LEFT OUTER JOIN "venues" ON "venues"."id" = "vehicles"."venue_id" WHERE (vehicles.client_id = 
500 ) 
```

但是，如果我使用`:select => '*'`，控制台会显示两个查询：一个用于车辆表，另一个用于场地：Venue Load (0.3ms) SELECT "venues".* FROM "venues" WHERE "venues"."id" IN (5000 )

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:14:16.117

你应该试试

```
format.json { render json: @vehicles, :include => :venue } 
```

你也可以加入

```
@vehicles = Vehicle.where(client_id: current_user.client_id).joins(:category, :vehicle_status).includes(:venue) 
```

一个或多个场地取决于`has_many`或`has_one`。有关更多信息，请在此处查找内容[http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:17:38.043

使用来自 shihirmk 的输入，尤其是在 JSON 响应中，答案如下：

```
 #where version
   @vehicles = Vehicle.where("vehicles.client_id = ?", current_user.client_id )
   .joins(:category, :vehicle_status, :user)
   .includes(:venue)
   .select("vehicles.id, vehicles.description, categories.category_description, venues.venue_name, users.email")

------ 
   #find version
   @vehicles = Vehicle.find(:all, 
      :select => 'vehicles.id, vehicles.description, categories.category_description, venues.venue_name, users.email',
      :joins => [:vehicle_status, :category, :user],
      :include => [:venue],
      :conditions => ["vehicles.client_id = ?", current_user.client_id])

-----
   format.json { render json: @vehicles, :include => [:venue, :category, :vehicle_status, :user ] } 
```

主要经验教训：

1）如果您在选择中包含特定列，则子/父表不会被 JSON 根包装，您可以简单地将字段称为“venue_name”而不是“venues.venues_name”。所以我强烈建议在使用 WHERE 或 FIND 连接多个表时使用 SELECT 并指定列。您希望这样做，因为多个表可能会有一个“id”列。

2）您必须明确您的 JSON 返回的内容（感谢@shishirmk）。请参阅我的示例以返回多个表/模型。

3) Rails 需要对这些类型的查询提供更好的文档，特别是因为框架不赞成使用数据库视图:-)

# mysql - MySQL GROUP_CONCAT DISTINCT 排序异常

> ID：16095255
> 
> 赞同：1
> 
> 时间：2013-04-19T00:23:12.420
> 
> 标签：mysql, group-concat

过去一天我一直在读这个（甚至在这里），但还没有找到合适的资源，所以我又把它放在那里了:)

看看这两个查询：

```
SELECT DISTINCT transactions.StoreNumber FROM transactions WHERE PersonID=2 ORDER BY transactions.transactionID DESC; 
```

和

```
SELECT GROUP_CONCAT(DISTINCT transactions.StoreNumber ORDER BY transactions.transactionID DESC SEPARATOR ',') FROM transactions WHERE PersonID=2 ORDER BY transactions.transactionID DESC; 
```

从我读过的所有内容中，我希望这两个查询返回相同的结果，第二组分组为 CSV。他们不是。

查询 1 的结果集（将每个值描绘在自己的行中，此处格式化结果很麻烦）：

'611' '345' '340' '310' '327' '323' '362' '360' '330' '379' '356' '367' '375' '306' '354' '389' '343 ''346''357''733''370''347''703''355''341''342''358''351''319''365''372''368''353'' 363''349''369''336''364''202''366''416''731'

Result Set for query 2: 611,379,375,389,703,355,351,372,368,362,342,365,353,341,733,347,336,319,354,306,345,364,202,358,370,343,366,349,356,367,369,416,323,346,731,360,363,330,310,357,340,327

如果我删除 DISTINCT 子句，结果会对齐。

谁能指出我对上述查询之间的区别做错了什么？

从每个查询中删除 DISTINCT 返回相同结果的事实表明 DISTINCT 在 GROUP_CONCAT 中存在问题。在 GROUP_CONCAT 之外执行 GROUP BY 会导致返回多行，这不是我想要的。

关于如何按 TransactionID DESC 的顺序获取 StoreNumber 的 GROUP_CONCAT DISTINCT 列表的任何想法？

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:53:14.873

考虑您的第一个查询：

```
SELECT DISTINCT transactions.StoreNumber
FROM transactions
WHERE PersonID=2
ORDER BY transactions.transactionID DESC; 
```

这相当于：

```
SELECT transactions.StoreNumber
FROM transactions
WHERE PersonID=2
group by transactions.StoreNumber
ORDER BY transactions.transactionID DESC; 
```

您正在订购不在`select`列表中的东西。因此，MySQL为每个商店编号选择一个*任意的 transactionid。*这可能因一种执行方式而异。

我相信同样的事情正在发生在`group_concat()`. 问题是每个人选择的任意数字都不同。

如果您想要一致性，请考虑以下两个查询：

```
SELECT transactions.StoreNumber
FROM transactions
WHERE PersonID=2
group by transactions.StoreNumber
ORDER BY min(transactions.transactionID) DESC; 
```

和：

```
SELECT GROUP_CONCAT(DISTINCT t.StoreNumber ORDER BY t.mintransactionID DESC SEPARATOR ',')
FROM (select t.StoreNumber, min(TransactionId) as minTransactionId
      from transactions t
      WHERE PersonID=2.transactionID
      group by t.StoreNumber
     ) t 
```

这些应该产生相同的结果。

在您大声抱怨 MySQL 之前，任何其他数据库都会在第一次查询时返回错误，因为使用 时`select distinct`，您只能按列表中的`select`列（或由它们组成的表达式）排序。

# php - 相对于 CURRENT_TIMESTAMP 的 UPDATE 行没有给出正确的值

> ID：16095261
> 
> 赞同：0
> 
> 时间：2013-04-19T00:23:56.127
> 
> 标签：php, mysql, timestamp, dateadd

我正在尝试使用“到期日期”更新 MySQL 表。当人们注册到表中时，我已经为我的所有行收集了一个时间戳值，但现在我想创建一个相对于该时间戳的到期日期（而不是相对于当前时间）。这是我的代码：

```
$timestamp = $row['timestamp'];
$sql_update = "
UPDATE jobs
SET expiration_date = DATE_ADD('$timestamp',INTERVAL 56 DAY)";
$result_update = $mysqli->query($sql_update) or die($mysqli->error); 
```

了解这是在“while”循环中运行的，因此它会遍历表的每一行并随时更新它们。问题是我运行了一次，它所做的只是将“expiration_date”行更新为从现在开始的 56 天，而不是从时间戳的值开始的 56 天。时间戳设置在 CURRENT_TIMESTAMP 上，用于注册新条目时，我认为这是问题所在。我已经回显了 $timestamp 以进行故障排除，当我回显它时它会回显正确的值（不是当前时间），但是当它实际更新到期日期时，它似乎是从它是一个 CURRENT_TIMESTAMP 的事实中得出的。有没有办法显式查询时间戳的值？

我希望找到一种不涉及重组数据库的方法。我知道我可以拥有它，而不是时间戳行，我可以将其设为日期时间行并将其设置为 NOW() 的值，当最初查询数据库以添加行但我更愿意在其中找到解决方案当前设置表的方式。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:20:56.493

我想知道你为什么要循环运行这个查询？您只能使用一条 sql 语句。从选择更新；

```
update jobs a set a.expiration_date = DATE_ADD(a.timestampFieldName,INTERVAL 56 DAY), a.timestampFieldName = a.timestampFieldName; 
```

我假设 MySQL 中存在一些“错误”（不知道），因为如果您不添加`a.timestampFieldName = a.timestampFieldName`，那么该字段将设置为当前时间戳；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:31:56.457

可能不知何故，值`$timestamp`是错误的。

尝试使用列名直接在查询中添加时间戳。例如：`DATE_ADD(timestamp,INTERVAL 56 DAY)`

你目前在做什么，几乎没有任何意义。您首先从数据库中获取时间戳并将其分配给`$timestamp`变量，然后再次在查询中使用它。在这种情况下，您最好直接使用列名来访问查询中的数据。

# arraylist - 编写实现 CD 对象的 ArrayList 的驱动程序

> ID：16095262
> 
> 赞同：0
> 
> 时间：2013-04-19T00:24:00.017
> 
> 标签：arraylist, wrapper, instance-variables

我已经编写了`CDException`类和 CD 类，现在我正在尝试编写一个驱动程序类来运行其他类。我必须

*   从用户处读取艺术家姓名
*   从用户那里读取专辑名称
*   从用户那里读取价格
*   从用户那里读取有多少库存

并打印他们写的内容，但只打印有效条目。如果其他条目仅输入空白，则在打印时将被忽略。

CD类：

```
import java.text.*;
public class CD {

private String sArtist;
private String sAlbum;
private double dPrice = 0;
private int inStock = 0;
String decimalFormats = "$##.##";   

    public CD(String sArtist, String sAlbum, double dPrice, int inStock) throws Exception{//constructors

        this.setArtist(sArtist);
        this.setAlbum(sAlbum);
        this.setPrice(dPrice);
        this.setinStock(inStock);
    }
        public String toString( ){//to string method

            DecimalFormat df = new DecimalFormat(decimalFormats);   //Formats the price
            String s = "Album: " + sAlbum + "\nArtist: " + sArtist +
                "\nPrice: " + df.format(dPrice);

            if(inStock == 0)
                return "Album: " + sAlbum + "\nArtist: " + sArtist +
                "\nPrice: $" + dPrice + "\nNot in Stock"; 
            else
                return s + "\nCurrently " + inStock + " in stock";
        }

        //mutator methods
        public void setArtist(String newArtist)throws Exception{
            if(newArtist.length( ) == 0){
                CDException cde = new CDException( );
                cde.setMessage("Artist name contains no characters" + "\nCannot create CD");
                throw cde;
            }
            else{
                this.sArtist = newArtist;
            }
        }
        public void setAlbum(String newAlbum) throws Exception{
            if(newAlbum.length( ) == 0){
                CDException cde = new CDException( );
                cde.setMessage("Album name contains no characters" + "\nCannot create CD");
                throw cde;
            }
            else{
                this.sAlbum = newAlbum;
            }
        }
        public void setPrice(double newPrice)throws Exception{
            if(newPrice < 0){
                CDException cde = new CDException( );
                cde.setMessage("CD Price cannot be negative" + "\nCannot create CD");
                throw cde;
            }
            else{
                this.dPrice = newPrice;
            }
        }
        public void setinStock(int newInStock)throws Exception{
            if(newInStock < 0){
                CDException cde = new CDException( );
                cde.setMessage("In stock cannot be negative" + "\nCannot create CD");
                throw cde;
            }
            else{
                this.inStock = newInStock;
            }
        }

        public String getsArtist( ){
            return this.sArtist;
        }
        public String getsAlbum( ){
            return this.sAlbum;
        }
        public double getdPrice( ){
            return this.dPrice;
        }
        public int getinStock( ){
            return this.inStock;
        }

    }   
} 
```

这是给我的`CDException`课的

```
public class CDException extends Exception {

   private String message = "Cannot create CD";

   public CDException( ){

   }
   public String getMessage( ){
    return this.message;
   }
   public void setMessage (String message){
    this.message = message;
   }
 } 
```

这就是我到目前为止的驱动程序类，但我需要将其修改为可以询问用户并从用户那里读取艺术家姓名、专辑名称、CD 价格以及库存数量，并将其添加到`ArrayList`，但首先当然是包装然后添加到`ArrayList`.

```
 public class CDStore2{

  public static void main (String[ ] arg) throws Exception{

   ArrayList (CD) CD = new ArrayList( );

   try{
         CD cd1 = new CD("Muse", "The Resistance", 11.99, 20);
         System.out.println(cd1.toString( ));
         System.out.println("=========================");
   }
   catch(CDException cde){
        System.out.println(cde.getMessage( ));
        System.out.println("=========================");
   }

  try{
       CD cd2 = new CD("Yanni", "The Live at the Acropolis", 11.99, 0);
       System.out.println(cd2.toString( ));
       System.out.println("=========================");
   }
  catch(CDException cde){
      System.out.println(cde.getMessage( ));
      System.out.println("=========================");
  }

  try{
       CD cd3 = new CD("Muse", "Black Holes and Revelations", 10.99, 15);
       System.out.println(cd3.toString( ));
       System.out.println("=========================");
   }
  catch(CDException cde){
       System.out.println(cde.getMessage( ));
       System.out.println("=========================");
 }

 try{ 
      CD cd4 = new CD("Paul Mc Cartney", "All the Best", -0.99, 12);
      System.out.println(cd4.toString( ));  
      System.out.println("=========================");
   }
 catch(CDException cde){
      System.out.println(cde.getMessage( ));
      System.out.println("=========================");
  }

  try{
      CD cd5 = new CD("Lady Gaga", "The Fame Monster", 14.99, 44);
      System.out.println(cd5.toString( ));
      System.out.println("=========================");
   }
  catch(CDException cde){
      System.out.println(cde.getMessage( ));
      System.out.println("=========================");
  }    

  try{
      CD cd6 = new CD("", "California Gurls", 1.29, 4);
      System.out.println(cd6.toString( ));
      System.out.println("=========================");
   }
  catch(CDException cde){
      System.out.println(cde.getMessage( ));
      System.out.println("=========================");
  }    

try{   
      CD cd7 = new CD("Pitbull", "", 11.99, 12);
      System.out.println(cd7.toString( ));
      System.out.println("=========================");
   }
 catch(CDException cde){
      System.out.println(cde.getMessage( ));
      System.out.println("=========================");
   }    

  }//main method ends

 } //program ends 
```

我如何以及在哪里写要求用户输入标题、专辑、价格和库存数量？我是在 CD 类还是在驱动程序类中编写它？我将如何使用它在其中编写它`ArrayLists`？

# sql - 在报告中传递参数时出错

> ID：16095267
> 
> 赞同：0
> 
> 时间：2013-04-19T00:24:38.867
> 
> 标签：sql, reporting-services

我正在尝试使用 SSDT 部署一个报告，该报告将允许输入 2 个参数，这些参数可用于日志文件的开始和结束。我的参数在报告数据下的参数下拉列表中声明为日期时间。数据集的属性中也包含参数。这是我的 SQL 语句和错误。

```
[Declare] @StartTime DateTime 
[Declare] @EndTime Datetime 
SELECT RecordID, AnalysisID, HeatName, NewHeatName, AnalysisTime, SampleType, Grade, NewGrade, ProductID, RecordChangeTime, ChangesMade, LoggedUser
FROM Chemistry_Log
WHERE (RecordChangeTime >= @ StartTime) AND (RecordChangeTime <= @ EndTime) 
```

解析 SQL 窗格的内容时遇到以下错误：

无法解析查询文本。

我不确定从这里去哪里，因为这不是错误消息的非常有用的信息......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:35:38.823

您的查询看起来正确。我认为问题不存在。报告中是否定义了参数？也就是说，它们是否出现在报告项的参数部分？它们是否也在数据集的属性中定义？通常这些应该会自动获取任何未声明的参数，但我见过自动创建不起作用的时候。

如果您在报告定义中看到参数，请确保将它们设置为 DateTime 参数。此外，在运行示例查询时不要将它们留空：提供有效的日期值。即使您单击“确定”，也会出现询问参数值的提示。只需填写任何有效日期：SSRS 有时需要它来运行一次查询并确定查询将返回的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:35:07.497

> 无法解析查询文本

您的查询*应该*使用提供的信息。唯一缺少的部分是您的[变量](http://msdn.microsoft.com/en-ca/library/ms187953%28v=sql.105%29.aspx)声明。在这种情况下，我没有看到：

```
Declare @StartTime DateTime 
Declare @EndTime   Datetime 
```

这将声明准备好存储的变量`DateTime`。至于如何将值分配给变量，这完全取决于您要对查询执行的操作。

*   [在存储过程](http://msdn.microsoft.com/en-us/library/aa174792%28v=sql.80%29.aspx)中使用它
*   直接在您的数据库管理系统中调用您的查询
*   从应用程序调用它并将它们作为[Sql 参数传递](http://msdn.microsoft.com/en-ca/library/system.data.sqlclient.sqlparameter.aspx)

您没有提供足够的信息让我更详细地了解。

# node.js - Node 和 Mongodb - 每 24 小时运行一次脚本

> ID：16095268
> 
> 赞同：0
> 
> 时间：2013-04-19T00:24:44.500
> 
> 标签：node.js, mongodb, mongoose

我正在使用 node.js 和猫鼬。我需要每个 mongoose 文档中的数值每 24 小时增加 25,000。

有没有比以下更好的方法：

```
thing.lastUpdated = new Date(); 
```

和

```
if(/* check how many days(if any) since lase update */> 0){
    for(var i = 0;i<days;i++){
        //update value
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T00:32:26.913

您可以使用[node-cron](https://github.com/ncb000gt/node-cron)来安排增量作业

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:43:45.933

根据您的用例，您可以根据使用[virtual的](http://mongoosejs.com/docs/guide.html#virtuals)*创建日期*来计算它：

```
var ThingSchema = new Schema({
    created: { type: Date, default: Date.now }
});

ThingSchema.virtual('numerical').get(function () {
    if (!this.created) return 0;

    var delta = (Date.now() - this.created) || 0;

    return 25000 * Math.floor(delta / 86400000);
}); 
```

```
// `created` 2 days ago
new Thing({ created: Date.now() - 172800000 }).save(function (thing) {
    console.log(thing.numerical);
}); 
```

# c - 从 main 调用 void 函数时的类型不兼容

> ID：16095274
> 
> 赞同：0
> 
> 时间：2013-04-19T00:25:11.007
> 
> 标签：c

我正在编写一个程序，你有一定数量的钱，用这笔钱你可以买几袋柠檬来制作柠檬水。我有一个功能：

```
 void buy_lemons(double *pLemons, double *pMoney); 
```

每当我从 main 调用它时，都会给我这个错误：

```
 error: incompatible type for argument 1 of 'buy_lemons' 
```

在 main 之前的函数原型中还有另一个注释：

```
 note: expected 'double *' but argument is of type 'double' 
```

到目前为止，这是我的代码：

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <time.h>
    // Symbolic constants to be used.

    // Prices of bags of sugar and lemon, respectively.
    #define PRICE_LEMON 3.50
    #define PRICE_SUGAR 2.00

    // Fraction of a bag of lemons and sugar used on a single cup of lemonade.
    #define LEMON_PER_CUP 0.03
    #define SUGAR_PER_CUP 0.04

    // The initial loan the user is given to start their lemonade stand.
    #define START_MONEY 20.00

    // Using symbolic constants for true and false.
    #define FALSE 0
    #define TRUE 1

    // Function prototypes - do not change these
    void buy_lemons(double *pLemons, double *pMoney);
    void buy_sugar(double *pSugar, double *pMoney);

    // Main function
    int main() {

      int num_day, ans, climate, cost;
      double money = START_MONEY, num_lemons = 0.00, num_sugar = 0.00;

      srand(time(0));

      printf("Welcome to the Game of Lemonade!\n\n");
      printf("You start the game with $%.2lf and no supplies!\n", START_MONEY);

      // Loop through each day. Ask the user if they want to buy lemons. If so,
      // carry out the transaction. Then ask them if they want to buy sugar.
      // If so, do this transaction as well. Then, let them sell lemonade for
      // the day. Finally, print a status report after they've sold lemonade
      // at the end of the day.

      for (num_day = 1; num_day <= 10; num_day++) {
            printf("Would you like to buy some lemons? (1 - Yes, 0 - No)\n");
            scanf("%d", &ans);
            if(ans == 1)
                buy_lemons(num_lemons, money);
                printf("1a\n");

            if(ans == 0)
                printf("2a\n");

            printf("Would you like to buy some sugar? (1 - Yes, 0 - No)\n");
            scanf("%d", &ans);
            if(ans == 1)
               buy_sugar(num_sugar, money);
               printf("1b\n");

            if(ans == 0)
                printf("2b\n");
      }

      return 0;
    }

    // Pre-conditions: pLemons and pMoney are pointers to variables that store
    //                 the user's number of bags of lemons left and amount of
    //                 money left.
    // Post-condition: The user is given the opportunity to buy lemons. If
    //                 successful, the number of bags of lemons and the amount
    //                 of money the user has are adjusted accordingly.
    //
    // What to do in this function: If the user doesn't have enough money to
    // even buy one bag of lemons, tell them so and return. Otherwise, ask
    // the user how many bags of lemons they want to buy. If they answer less
    // than one, tell them they must get more and reprompt them. If they
    // answer more than they can buy, tell them they don't have that much
    // money and reprompt them. Continue prompting them until they answer with
    // a valid value. Then process the transaction.

    void buy_lemons(double *pLemons, double *pMoney) {
        double bags, total;

        if (*pMoney < PRICE_LEMON)
            printf("You do not have enough money to buy any lemons.\n");

        if(*pMoney >= PRICE_LEMON){
            printf("How many bags of lemons would you like to purchase?\n");
            scanf("%.2lf\n", &bags);

                while (bags < 1){
                    printf("You must buy at least 1 bag of lemons.\n");
                    printf("How many bags of lemons would you like to purchase?\n");
                    scanf("%.2lf\n", &bags);
                }

            total = PRICE_LEMON * bags;
            printf("The total is %lf.\n", &total);

                while(total > *pMoney){
                    printf("You don't have enough money.\n");
                    printf("How many bags of lemons would you like to purchase?\n");
                    scanf("%.2lf\n", &bags);

                    total = PRICE_LEMON * bags;
                }

            *pLemons += bags;
            *pMoney -= total;
        }

    }

    // Pre-conditions: pSugar and pMoney are pointers to variables that store
    //                 the user's number of bags of lemons left and amount of
    //                 money left.
    // Post-condition: The user is given the opportunity to buy sugar. If
    //                 successful, the number of bags of sugar and the amount
    //                 of money the user has are adjusted accordingly.
    //
    // What to do in this function: If the user doesn't have enough money to
    // even buy one bag of sugar, tell them so and return. Otherwise, ask
    // the user how many bags of sugar they want to buy. If they answer less
    // than one, tell them they must get more and reprompt them. If they
    // answer more than they can buy, tell them they don't have that much
    // money and reprompt them. Continue prompting them until they answer with
    // a valid value. Then process the transaction.

    void buy_sugar(double *pSugar, double *pMoney) {
        double bags, total;

        if (*pMoney < PRICE_SUGAR)
            printf("You do not have enough money to buy any sugar.\n");

        if(*pMoney >= PRICE_SUGAR){
            printf("How many bags of sugar would you like to purchase?\n");
            scanf("%.2lf\n", &bags);

                while (bags < 1){
                    printf("You must buy at least 1 bag of sugar.\n");
                    printf("How many bags of sugar would you like to purchase?\n");
                    scanf("%.2lf\n", &bags);
                }

            total = PRICE_SUGAR * bags;
            printf("The total is %lf.\n", &total);

                while(total > *pMoney){
                    printf("You don't have enough money.\n");
                    printf("How many bags of sugar would you like to purchase?\n");
                    scanf("%.2lf\n", &bags);

                    total = PRICE_SUGAR * bags;
                }

            *pSugar += bags;
            *pMoney -= total;
        }
    } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T00:27:30.153

代替

`buy_lemons(num_lemons, money);`

尝试

`buy_lemons(&num_lemons, &money);`

推理：& 放置在变量名之前是“地址”运算符。如果您将地址传递给一个整数，而不是数值，它可以被解释为一个指针并取消引用以编辑该值，即使在它存储的原始位置也是如此。

例如，如果`num_lemons`是类型`double`，`&num_lemons`是类型`double*`

ps这与您将 & 放在传递给函数的非指针参数之前的原因相同`scanf`

# ios - 从 URL 读取字节数组并在 iOS 中转换为 PDF

> ID：16095277
> 
> 赞同：0
> 
> 时间：2013-04-19T00:25:29.470
> 
> 标签：ios, objective-c, json, bytearray

我在 Windows 中有一项服务，它返回 PDF 数据，该数据位于数据库中的 varbinary 字段中。此服务将 PDF 数据作为 JSON 格式的字节数组返回
如何在 Xcode 的应用程序中读取此数据并将其再次转换为 PDF？
检索此字节数组的正确结构数据是什么？NSArray？NSMutableArray？
我想存储这些数据，我正在使用 NSData 结构......
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:04:02.447

An`NSArray`将用于对象数组，您需要一个字节数组，即 an `NSData`。

要从 JSON 中获取数据，您将使用`NSJSONSerialization`该类从您的 JSON 对象中提取数据——反序列化​​器可能会将您的文字数据返回为`NSString`，然后您将`NSData`通过解码将其转换为 。

大概您的原始数据[在 JSON 作为 Base64 或类似](https://stackoverflow.com/questions/1443158/binary-data-in-json-string-something-better-than-base64)的。

# java - 通过特定对象属性查找 HashSet/ArrayList 中的最大值

> ID：16095283
> 
> 赞同：1
> 
> 时间：2013-04-19T00:26:21.723
> 
> 标签：java, collections, guava, apache-commons

我有一个汽车对象列表。每个汽车对象都有一个类型，指示它是轿车、suv、双门轿车、面包车还是卡车）以及其他属性。假设我的应用程序按下面列出的顺序排列这些

*   轿车（最低）
*   轿跑车
*   范
*   越野车
*   卡车（最高）

如何从列表中找到排名最高的类型。

```
class Car {

 public Car (String type, String model, int year, long mileage){
     this.type=type;
     this.model = model;
     this.year = year;
     this.mileage = mileage;
 }

  private String type; // Sedan, SUV etc
  private String model; // Focus, Corolla, Camry, Taurus etc
  private int year; 
  private long mileage;

 //getters

}

List<Car> allCars = new ArrayList();
allCars.add(new Car("Coupe", "Focus", 1999, 50000) );
allCars.add(new Car("Sedan", "Camry", 2007, 60000) );
allCars.add(new Car("Truck", "Sierra", 2007, 50000) );
allCars.add(new Car("Truck", "F-150", 2001, 60000) );
allCars.add(new Car("Van", "Sienna", 1999, 40000) ); 
```

Java 5 中查找卡车（具有最高等级类型的汽车）的最有效方法是什么。如果需要，我可以使用 apache commons api 或 guava。

我可以循环并创建一组独特的类型。

```
 Set<String> uniqueTypes = new HashSet<String>;
 for(Car car: allCars) {
     uniqueTypes.add(car.getType);
 } 
```

使用上面的集合，我怎样才能找出最大值（即本例中的卡车）。Collections.max() 会按自然顺序返回最大值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:19:51.937

虽然引入 CarType 枚举是一个很好的方法，但如果你不能/不想将类型更改为字符串，你可以使用[`Ordering`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Ordering.html)更强大和更优美的流式`Comparator`API 的 Guava。在你的情况下使用[`Ordering#explicit(T, T...)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Ordering.html#explicit%28T,%20T...%29)：

```
final Car maxRank = Ordering.explicit("Sedan", "Coupe", "Van", "SUV", "Truck")
    .onResultOf(CarFunction.GET_TYPE)
    .max(allCars);
System.out.println(maxRank.getModel()); // Sierra 
```

其中`CarFunction.GET_TYPE`定义为：

```
private enum CarFunction implements Function<Car, String> {
  GET_TYPE {
    @Override
    public String apply(final Car car) {
      return car.getType();
    }
  };
} 
```

或作为`private static final Function`或在 Java 8 中作为 lambda `c -> c.getType()`。

[您可以在此 Wiki 页面](https://code.google.com/p/guava-libraries/wiki/OrderingExplained)上阅读有关订购的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T00:49:54.980

首先，它有助于使汽车的类型成为`enum`- 这使您可以更轻松地对值进行排序并为`Car`类添加类型安全性。

下一步是使用 中的`max(Collection<? extends T> coll, Comparator<? super T> comp)`方法`Collections`。

您需要决定如何对其他值进行排序 - 当您有两辆相同类型的汽车时。默认实现将返回它遇到的第一个最大值。如果类型相同，您可能希望对模型进行二次排序。

这是一个例子：

```
public static void main(String[] args) throws ParseException {
    List<Car> allCars = new ArrayList();
    allCars.add(new Car(CarType.COUPE, "Focus", 1999, 50000));
    allCars.add(new Car(CarType.SEDAN, "Camry", 2007, 60000));
    allCars.add(new Car(CarType.TRUCK, "Sierra", 2007, 50000));
    allCars.add(new Car(CarType.TRUCK, "F-150", 2001, 60000));
    allCars.add(new Car(CarType.VAN, "Sienna", 1999, 40000));

    Car max = Collections.max(allCars, new Comparator<Car>() {
        @Override
        public int compare(Car o1, Car o2) {
            return o1.getType().compareTo(o2.getType());
        }
    });
    System.out.println(max);
}

static class Car {

    public static enum CarType {

        SEDAN,
        COUPE,
        VAN,
        SUV,
        TRUCK;
    }
    private CarType type;
    private String model; // Focus, Corolla, Camry, Taurus etc
    private int year;
    private long mileage;

    public Car(CarType type, String model, int year, long mileage) {
        this.type = type;
        this.model = model;
        this.year = year;
        this.mileage = mileage;
    }
    //getters
    //toString
} 
```

在这种情况下`max`是“Sierra”，因为它是列表中的第一辆卡车。

或者，您可以使用 a `SortedSet`like a`TreeSet`但是您需要**非常小心地**实施 the `Comparator`，因为它需要[与 equals 一致，](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Comparable.html)否则具有相同等级但不是的项目`equals`将被简单地忽略。

**编辑**

`enum`在内部使用 a 但`String`在构造函数中使用 a 的示例：

```
static class Car {

    public static enum CarType {

        Sedan,
        Coupe,
        Van,
        SUV,
        Truck;
    }
    private CarType type;
    private String model; // Focus, Corolla, Camry, Taurus etc
    private int year;
    private long mileage;

    public Car(String type, String model, int year, long mileage) {
        this.type = CarType.valueOf(type);
        this.model = model;
        this.year = year;
        this.mileage = mileage;
    }
    //getters
    //toString
} 
```

# linux - 如何处理 Varnish 堆栈中的 Cookie

> ID：16095288
> 
> 赞同：7
> 
> 时间：2013-04-19T00:27:05.203
> 
> 标签：linux, cookies, nginx, passenger, varnish

由于网站性能缓慢，我开始寻找 info Varnish 作为缓存解决方案，并对 Google Analytics 有一些疑问。

当站点上有 5K 活跃用户时（根据 GA 的实时流量报告），后端服务器上的服务器负载飙升至 30-40 +，乘客队列开始堆积，站点几乎无法使用。我知道要获得更好的性能需要缓慢的查询和数据库工作，但目前我没有资源来优化查询和数据库架构、索引等，所以考虑添加清漆。

我创建了一个图表来更好地显示堆栈，这是当前堆栈的样子：（该站点当前在 CDN 中缓存图像/css/js - Akamai）

![在此处输入图像描述](https://i.stack.imgur.com/847QZ.png)

我想在后端服务器前面添加两个清漆实例来缓存文章，堆栈将如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/R8YuB.png)

该站点是一个新闻站点，我正在寻找有关如何正确处理 cookie 和缓存的建议。对于第 1 阶段，我想完全排除经过身份验证的用户并提供动态内容，因为同时经过身份验证的用户并不多。

令人困惑的是 Google Analytic 的 cookie。我的理解是，谷歌使用 javascript 在客户端上设置了一个 cookie，客户端直接与谷歌通信，因此后端不需要客户端发送的 GA cookie，并且在 vcl_recv 子例程期间取消设置它们是安全的。

```
sub vcl_recv {

// Remove has_js and Google Analytics __* cookies.
set req.http.Cookie = regsuball(req.http.Cookie, "(^|;\s*)(_[_a-z]+|has_js)=[^;]*", "");
// Remove a ";" prefix, if present.
set req.http.Cookie = regsub(req.http.Cookie, "^;\s*", "");
} 
```

问题

*   这是一种安全的方法吗？
*   Google 是否仍能正确跟踪，包括重复访问者？
*   在我的第一阶段政策中，我还有什么需要注意的吗？

由于默认情况下 varnish 不会缓存任何设置了 cookie 的内容，因此仅通过添加删除 GA cookie 的策略来实现上述堆栈是否安全？我知道如果不微调 VCL 策略，我不会获得高命中率，但是在我的测试中，似乎即使在后端服务器前面使用默认清漆，命中率也有 30%，在分析这些之后，我看到大多数是 js/css 和图像文件，因此很明显，其中一些静态文件不是由 Akamai 甚至 Apache 提供的，而是传递给Passenger/Rails 以提供静态文件。这绝对需要纠正。

*   Varnish 会在默认情况下提高性能吗？

我是清漆的新手，因此非常感谢我提出的关于清漆或堆栈的任何其他细节/建议。

对于第 2 阶段 +

由于内容得到更新，我计划在两个清漆服务器上执行清除，由后端服务器在应用更改时触发，例如用户评论、页面浏览量等。

有大量未更新的存档文章，永久缓存它们是否安全？

由于我计划将 RAM 用于清漆存储，我是否应该有额外的（第三个）清漆，并使用磁盘进行存储，明确地用于那些存档页面。也许在清漆服务器前面添加 nginx 堆栈以将流量引导到存档内容的特定清漆实例？负载均衡器->一对Nginx反向代理>一对清漆->（清漆LB到8个后端服务器）

我也很欣赏有关架构的任何建议。如果您需要更多详细信息以提供更好的建议，请告诉我，我很乐意为您提供更多详细信息。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-20T03:05:24.027

这是很多问题！:-)

```
Q. Is this a safe approach? 
```

表面上，我会这么说。

通常，在流量大且内容快速变化的新闻网站上设置 Varnish 可能是一项挑战。

一个非常好的检查方法是构建一个清漆盒，让它直接访问你的集群（而不是通过负载均衡器），并给它一个临时的公共 IP 地址。这将使您有机会针对 VCL 更改进行测试。您将能够测试评论、登录（如果有的话）以及其他任何事情，以确保没有意外。

```
Q. Will Google still track properly, including repeat visitors? 
```

是的。cookie 仅在客户端使用。

您应该注意的一件事是，当后端发送 cookie 时，Varnish 也不会缓存内容。您将需要删除 vcl_fetch 上不需要的任何 cookie。如果 cookie 用于跟踪用户状态，这可能是一个问题。

```
Q. Is there anything else that I need to watch for in my policies for phase1? 
```

您需要在 Rails 中禁用 rack-cache，并设置您自己的标头。请注意，如果您删除 varnish，Rails 将在没有缓存的情况下运行，并且可能会崩溃！

这就是我在 production.rb 中的内容：

```
 # We do not use Rack::Cache but rely on Varnish instead
  config.middleware.delete Rack::Cache
  # varnish does not support etags or conditional gets
  # to the backend (which is this app) so remove them too
  config.middleware.delete Rack::ETag
  config.middleware.delete Rack::ConditionalGet 
```

在我的 application_controller 我有这个私有方法：

```
def set_public_cache_control(duration)
  if current_user
    response.headers["Cache-Control"] = "max-age=0, private, must-revalidate"
  else
    expires_in duration, :public => true
    response.headers["Expires"] = CGI.rfc1123_date(Time.now + duration)
  end
end 
```

这是在我的其他控制器中调用的，因此我可以非常精细地控制对站点的各个部分应用多少 chacheing。我在作为 before_filter 运行的每个控制器中使用设置方法：

```
def setup
  set_public_cache_control 10.minutes
end 
```

（application_controller 有过滤器和空白设置方法，所以在其他控制器中可以是可选的）

如果您有部分网站不需要 cookie，您可以根据 VCL 中的 URL 将其剥离，并应用标头。

您可以像这样在 apache 配置中为静态资产设置缓存时间（假设您使用的是默认资产路径）：

```
<LocationMatch "^/assets/.*$">
    Header unset ETag
    FileETag None
    # RFC says only cache for 1 year
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
    Header append Cache-Control "public"
</LocationMatch>

<LocationMatch "^/favicon\.(ico|png)$">
    Header unset ETag
    FileETag None
    ExpiresActive On
    ExpiresDefault "access plus 1 day"
    Header append Cache-Control "public"
</LocationMatch>

<LocationMatch "^/robots.txt$">
    Header unset ETag
    FileETag None
    ExpiresActive On
    ExpiresDefault "access plus 1 hour"
    Header append Cache-Control "public"
</LocationMatch> 
```

这些标头将被发送到您的 CDN，这将使资产缓存更长时间。看着清漆，你仍然会看到请求的速度在下降。

我还会在页面不需要 cookie 但经常更改的所有内容上设置非常短的缓存。在我的例子中，我为主页设置了 10 秒的缓存时间。这对 Varnish 意味着每 10 秒会有一个用户请求发送到后端。

您还应该考虑将 varnish 设置为使用宽限模式。这允许它从缓存中提供稍微陈旧的内容，而不是将访问者暴露在后端对刚刚过期的项目的缓慢响应中。

```
Q. There are plenty of archived articles that don't get updated, is it safe to cache them forever? 
```

为此，您需要更改您的应用程序，以便为那些已归档的文章发送不同的标题。这假设他们不会有 cookie。根据我在我的网站上所做的，我会这样做： -

在上面的设置中添加一个条件来更改缓存时间：

```
def setup
  # check if it is old. This code could be anything
  if news.last_updated_at < 1.months.ago
    set_public_cache_control 1.year
  else
    set_public_cache_control 10.minutes
  end
end 
```

这会设置一个公共标头，因此 Varnish 将缓存它（如果没有 cookie），任何远程缓存（在 ISP 或公司网关处）也会如此。

这样做的问题是，如果您想删除故事或更新它（例如，出于法律原因）。

在这种情况下，您应该向 Varnish 发送一个私有标头来更改该 URL 的 TTL，但为其他所有人发送一个较短的公共标头。

这将允许您将 Varnish 设置为（例如）1 年的内容服务，同时它会发送标题以告诉客户每 10 分钟回来一次。

在这些情况下，您需要添加一个清除清漆的机制。

为了让你开始，我的 application_controller 中有第二种方法：

```
def set_private_cache_control(duration=5.seconds)
  # logged in users never have cached content so no TTL allowed
  if ! current_user
    # This header MUST be a string or the app will crash
    if duration
      response.headers["X-Varnish-TTL"] = duration.to_s
    end
  end
end 
```

在我的 vcl_fetch 我有这个：

```
call set_varnish_ttl_from_header; 
```

vcl 函数是这样的：

```
sub set_varnish_ttl_from_header {
  if (beresp.http.X-Varnish-TTL) {
    C{  
      char *x_end = 0;
      const char *x_hdr_val = VRT_GetHdr(sp, HDR_BERESP, "\016X-Varnish-TTL:"); /* "\016" is length of header plus colon in octal */
      if (x_hdr_val) {
        long x_cache_ttl = strtol(x_hdr_val, &x_end, 0);
        if (ERANGE != errno && x_end != x_hdr_val && x_cache_ttl >= 0 && x_cache_ttl < INT_MAX) {
          VRT_l_beresp_ttl(sp, (x_cache_ttl * 1));
        }
      }
    }C
    remove beresp.http.X-Varnish-TTL;
  }
} 
```

这样就不会将标头传递（s-max-age 会）传递给任何上游缓存。

设置方法如下所示：

```
def setup
  # check if it is old. This code could be anything
  if news.last_updated_at < 1.months.ago
    set_public_cache_control 10.minutes
    set_private_cache_control 1.year
  else
    set_public_cache_control 10.minutes
  end
end 
```

随时提出任何补充问题，我会更新这个答案！

# javascript - 在 Windows 上使用 git 并将更改推送到 linux debian 6

> ID：16095289
> 
> 赞同：0
> 
> 时间：2013-04-19T00:27:12.703
> 
> 标签：javascript, git, node.js, github

我的笔记本装有 Windows 7 64 位，我可以进行更改并完美提交。

我的云服务器上有一个存储库，我将笔记本中的更改推送到云存储库。

然后我创建了一个裸仓库来部署我的应用程序。裸存储库有 nodejs 应用程序。我必须重新编译 bcrypt，因为 bcrypt 云存储库具有适用于 Windows 7 的 bcrypt，

我从笔记本推送到云存储库，然后从云存储库拉到裸存储库。裸存储库具有部署应用程序。

问题是有时来自 nodejs 的预编译器会更改裸存储库。因此，如果我不提交更改，那么裸仓库会给我一个错误，并说我必须提交或添加新文件。

所以我用

```
git stash save --keep-index
git stash drop 
```

我从云服务器存储库中提取更改。

我解决了第一个问题，但我有第二个问题......当我将更改从云存储库拉到裸存储库时，我必须重新编译节点模块，因为拉取替换节点模块更改。

我不想每次必须拉取更改时都重新编译节点模块。有没有办法合并一个版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:39:59.887

1.  删除工作目录中所有更改的正确命令是`git reset --hard`.
2.  您不应该将编译后的代码保留在您的存储库中。`.gitignore`结帐后将编译的输出添加到您的系统并在您的系统上编译。

# .net - 如何避免进程终止通知和标准输出重定向事件之间的竞争条件？

> ID：16095292
> 
> 赞同：5
> 
> 时间：2013-04-19T00:27:30.377
> 
> 标签：.net, stdout, race-condition, io-redirection

我以一种非常可控的方式`ProcessJobManager`将作业排入队列，一次最多可以在 X 个并发进程中处理它们。

启动每个进程后，我将它添加到 a`List<ActiveProcessJob>`并将进程的 a 存储`WaitHandle`在我`ActiveProcessJob`的`CompleteEvent`属性中，方法是构造 a`new ManualResetEvent( false )`并将其`SafeWaitHandle`属性分配给`new SafeWaitHandle( my_process.Handle, false )`.

我通过以下代码等待进程完成（以及任何“new_jobs_queued”）：

```
WaitHandle[] wait_handles =
    active_jobs
    .Select<ActiveProcessJob,WaitHandle>( j => j.CompleteEvent )
    .Union( new WaitHandle[]{ new_jobs_queued} ).ToArray();
WaitHandle.WaitAny( wait_handles ); 
```

这可以正确检测一个或多个进程（或添加到队列的项目）的终止；但是，我也在重定向标准输出流并调用`Process.BeginOutputReadLine`以确保`Process.OutputDataReceived`触发事件。

问题是进程终止经常被检测和处理（它`active_jobs`在事件的事件处理程序最后一次触发之前从列表中删除`Process.OutputDataReceived`。在这种情况下，处理程序不能引用进程，因为它已经被删除了从队列中。

我几乎需要知道一个进程何时“即将退出”，因为否则我不知道什么时候会期待最后一个`OutputDataReceived`事件，这显然是在与我的`WaitAny`调用不同的线程上运行的，该线程等待进程终止。

也许 Process.Exit 保证在最后一个 Process.OutputDataReceived 事件之后和 Process.HasExited 方法返回 true 之前被调用？我需要这样的确定性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:09:35.263

由于重定向的输出流在与处理进程终止信号的线程不同的线程中运行，并且没有以其他方式与之同步，因此处理终止信号的线程可能会在处理终止信号的线程之前执行其所有工作标准输出事件运行或完成。

Process.Exit 不能保证在所有输出事件完成之前运行，可能是由于疏忽，它在调用 RaiseOnExited 之前不等待流结束，除非您调用 Process.WaitForExit，我已经确定了使用 .NET Reflector 反编译代码。

[更新：我实际上在文档](http://msdn.microsoft.com/en-us/library/ty0d8k56.aspx)中发现了这一点，这似乎表明您必须调用 WaitForExit TWICE 以确保它完成：

> “当标准输出被重定向到异步事件处理程序时，有可能在此方法返回时输出处理尚未完成。为确保异步事件处理已完成，请在接收到a后调用不带参数的WaitForExit()重载从这个过载来看是真的。”

原来我认为一种解决方法可能是调用 Process.CancelOutputRead 以在继续从作业队列中删除对进程的引用之前删除关联的事件侦听器，但这可能不起作用，因为 Process.CancelOutputRead 实际上并没有进行任何同步清理；它只是设置了一个标志。除了接受输出事件处理程序可能在进程终止处理程序完成后运行并处理错误之外，似乎唯一真正的解决方法是在接收到进程终止信号后调用 WaitForExit() 。

# javascript - 在 JavaScript 变量中查找最高值

> ID：16095301
> 
> 赞同：3
> 
> 时间：2013-04-19T00:28:24.133
> 
> 标签：javascript, variables

我正在开发一个基于 JS 的游戏，我正在跟踪几个用户的分数。在游戏结束时，我需要宣布获胜者。可能有联系。

所以，举两个例子：

```
player1 = 3
player2 = 5
player3 = 4 
```

（玩家 2 获胜）

```
player1 = 4
player2 = 2
player3 = 4 
```

（玩家 1 和 3 平局）

只有 3 名玩家，我可能只是用一堆嵌套的 if/else 来比较每个值，但想知道是否有更优雅的方法来解决这个问题......尤其是在你可能有的情况下以 10 个玩家为例，if/else 比较会很快变得笨拙。

一种选择似乎是将值粘贴在数组中，然后对其进行排序，但这并没有给你变量名——只是值。然后我可以做一个多维数组，但那时事情似乎又变得一团糟。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T00:32:05.227

在不使用或要求这些变量是全局变量的情况下，没有简单的方法可以遍历变量名，例如`player1`,等，这通常是一种不好的方法。`player2``eval()`

如果它们是全局变量，你可以使用这个技巧，但我建议我在下面使用我的第二种方法，将玩家信息存储为对象数组。这是使用全局变量的技巧（不推荐，但更直接地回答了您的问题）：

```
// these must be global variables
var score1 = 100;
var score2= 99;
var score3= 80;

function findHighScore() {

    var highestScore = score1;
    var highestScorePlayerNum = 1;
    var tempScore;

    for var (i = 2; i <= 3; i++) {
        // this works only because the score variables are global variables which
        // can be accessed as properties off the window object
        tempScore = window["score" + i];
        if (tempScore > highestScore) {
            highestScore = tempScore;
            highestScorePlayerNum = i;
        }
    }
    return {score: highestScore, playerNum: highestScorePlayerNum};
} 
```

更好的方法是不将每个玩家的分数保存在自己的 javascript 变量中，而是将其放入如下对象数组中：

```
var playerData = [
    {name: "John", highScore: 145, lastPlayed: 23089234},
    [name: "Bill", highScore: 99, lastPlayed: 59383945}
]; 
```

然后，您可以遍历玩家数据，找到最高分并获得该玩家的姓名。

```
function findHighScore() {
    var highScoreSoFar = 0;
    var result;
    for (var i = 0; i < playerData.length; i++) {
        if (playerData[i].highScore > highScoreSoFar) {
            result = playerDatra[i];
            highScoreSoFar = playerData[i].highScore;
        }
    }
    return result;
}

var highPlayer = findHighScore();
alert("Highest scoring player is " + highPlayer.name + " with a score of " + highPlayer.highScore); 
```

* * *

如果要返回所有得分最高的玩家，可以返回得分最高的玩家数组：

```
function findHighScore() {
    var highScoreSoFar = 0;
    var result = [];
    for (var i = 0; i < playerData.length; i++) {
        if (playerData[i].highScore > highScoreSoFar) {
            // new high score so start a new array with this player in it
            result = [playerData[i]];
            highScoreSoFar = playerData[i].highScore;
        } else if (playerData[i].highScore === highScoreSoFar) {
            // more than one player with this highScore so add this one to the array
            result.push(playerData[i]);
        }
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T00:31:56.273

```
var players = []; // Array of player scores.

// Assumes that all player scores are higher than -1\. You could change this.
var winnerScore = -1, winner = 0;
for (var i = 0; i < players.length; i++) {
    if (players[i] > winnerScore) {
        winner = i;
        winnerScore = players[i];
    }
}

alert("The winner was player " + winner + "!"); 
```

这应该可以解决问题:)如果你想处理领带，你可以这样做：

```
var players = []; // Array of player scores.

// Assumes that all player scores are higher than -1\. You could change this.
var winnerScore = -1, winners = [];
for (var i = 0; i < players.length; i++) {
    if (players[i] > winnerScore) {
        winners = [i];
        winnerScore = players[i];
    } else if (players[i] == winnerScore) {
        winners.push(i);
    }
}

if (winners.length == 1) {
    alert("The winner was player " + winners[0] + "!");
} else {
    alert("The winners were players " + winners.join(", ") + "!");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T00:37:24.060

```
var players = {
    player1: 3,
    player2: 5,
    player3: 4
};

var sorted = Object.keys(players)
                   .sort(function(keya, keyb) {
                       return players[keyb] - players[keya];
                   })
                   .forEach(function(key) {
                       console.log(key, players[key]);
                   }) 
```

***演示：http:*** [//jsfiddle.net/WUAhS/](http://jsfiddle.net/WUAhS/)

> 玩家2 5
> 
> 玩家 3 4
> 
> 播放器1 3

* * *

或者`.reduce()`，如果您想要的只是高分，请使用。

```
var high_key = Object.keys(players)
                     .reduce(function(keya, keyb) {
                         return players[keya] > players[keyb] ? keya : keyb;
                     }); 
```

# python - 如何在两个坐标数组中找到相同的 x,y 坐标？

> ID：16095304
> 
> 赞同：1
> 
> 时间：2013-04-19T00:28:42.060
> 
> 标签：python, numpy

给定两个包含 x 和 y 坐标的 2D numpy 数组，如何在另一个具有相同维度的数组中找到相同的对？

例如，我有这些数组：

```
array([[ 2,  1,  3,  4],
       [ 4,  3,  5, 10]]) 
```

和

```
array([[ 0,  2,  3,  4],
       [ 3,  4, 11, 10]]) 
```

我希望发现这对`(2, 4)`和`(4, 10)`将被检测为存在于两个阵列中。

首先十分感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T00:33:33.193

尝试这个：

```
>>> a2 = [[ 0,  2,  3,  4],
   [ 3,  4, 11, 10]]
>>> a1 = [[ 2,  1,  3,  4],
   [ 4,  3,  5, 10]]
>>> set(zip(*a1)) & set(zip(*a2))
{(4, 10), (2, 4)} 
```

您可以通过 array.tolist() 将数组转换为列表

例如，对于任何二维数组，第一行表示 X 轴，第二行表示 Y 轴。所以 zip(*a1) 将导致所有坐标对。然后 set() 构造函数将过滤掉所有重复的记录。最后，两个集合之间的 & 运算将找出两个数组中的所有坐标对。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T03:51:05.113

这样做的*numpythonic*方式如下：

```
>>> a1 = np.array([[2, 1, 3, 4], [4, 3, 5, 10]])
>>> a2 = np.array([[0, 2, 3, 4], [3, 4, 11, 10]])
>>> a1 = a1.T.copy().view([('', a1.dtype)]*2)
>>> a2 = a2.T.copy().view([('', a2.dtype)]*2)
>>> np.intersect1d(a1, a2)
array([(2, 4), (4, 10)], 
      dtype=[('f0', '<i4'), ('f1', '<i4')]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:35:56.007

一个直接的解决方案是：

```
import numpy

array1 = numpy.array([[ 1, 99, 2, 400],
                      [ 3, 98, 4, 401]])

array2 = numpy.array([[ 1,  6, 99,   7],
                      [ 8,  9, 98, 401]])

result = []
for column_1 in xrange(array1.shape[1]):
    for column_2 in xrange(array2.shape[1]):
        if numpy.array_equal(array1[:,column_1], array2[:,column_2]):
            result.append(array1[:,column_1])

print numpy.array(result).transpose()

[[99]
 [98]] 
```

# java - 由于 java 没有引用，如何在两个单独的类之间传递信息？

> ID：16095308
> 
> 赞同：0
> 
> 时间：2013-04-19T00:28:57.417
> 
> 标签：java

对不起，非常模糊/混乱，我真的不知道如何命名这个问题。如果有人有更好的，请随时编辑它。关于我的问题，

```
public class Foo()
{
    String name;
    public Foo()
    {
        Bar temp = new Bar();
    }
}    

public class Bar()
{
    public Bar()
    {
        setFooName("newName");
    }

    public void setFooName(String name)
    {   
        // Is it possible call a method in Foo?
    }
}    

public class test {
    static public void main(String[] args) 
    {
        Foo foobar = new Foo();
    }
} 
```

我还是 java 新手，所以我不确定这是否可能，但是使用 C++，我通常会在“Boo”类中有一个“Foo”的局部变量，然后将对该对象的引用传递给Bar 的构造函数，然后将其分配给 Bar 中的局部变量。

由于 java 没有引用，我被困在这件事上。我想这样做的原因是我的示例是我需要在类中创建一个 GUI 对象，然后将来自 GUI 对象的信息发送回创建它的类。

我希望这一切都有意义，如果没有，对不起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T00:36:06.633

我认为您正在关注语义学。

下面的示例传递`Foo`对`Bar`via`Bar`的构造函数的引用的副本。这现在允许`Bar`访问 的实例的属性`Foo`。它不允许你做的是改变两者之间的引用（即分配一个新的参考参考`Foo`将不会改变以前的参考）

```
public class Foo()
{
    String name;
    public Foo()
    {
        Bar temp = new Bar(this);
    }
}    

public class Bar()
{
    private Foo foo;
    public Bar(Foo foo)
    {
        this.foo = foo;
        setFooName("newName");
    }

    public void setFooName(String name)
    {   
        // Is it possible call a method in Foo?
    }
}    

public class test {
    static public void main(String[] args) 
    {
        Foo foobar = new Foo();
    }
} 
```

`Bar`然后可以调用任何`Foo`提供的修饰符，它会`Foo`为每个引用该实例的人更改这些单独的属性...

我希望这接近你的要求：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:41:51.610

实际上你可以在 Java 中做到这一点。Java 有引用，但没有指针。令人困惑的是，对于 C++ 爱好者来说，这些引用可能为空。

这意味着您当然可以执行以下操作：

```
public class Bar {
    private Foo foo;
    public Bar(Foo foo) {
        this.foo = foo;
    }
    public setFooName(String name) {
        foo.setName(name);
    }
}
public class Foo {
    private String name;
    public Foo() {
        Bar temp = new Bar(this);
        temp.setFooName("fooname");
    }
} 
```

但我不确定，在这种情况下，你为什么不直接写：

```
public class Foo {
    private String name;
    public Foo() {
        this.name = "fooname";
    }
} 
```

# python - Python/Myro：atexit._run_exitfuncs 中的错误

> ID：16095311
> 
> 赞同：1
> 
> 时间：2013-04-19T00:29:17.467
> 
> 标签：python, exception, attributeerror, python-2.4, myro

我的初学者级 Python 课程使用 Python 2.4 和 Myro，后者给我带来的只是麻烦。在课堂上的这一点上，我什至无法运行十次中有九次编写的代码，尽管有时尽管我什么也没做，但它最终还是会工作。甚至该类提供的示例程序最终也会给我错误。我假设问题出在 Myro 框架本身，而不是我自己的错误。老师没有反应，所以我转向了这个网站。这是我遇到的错误。

```
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
    File "C:\Python24\lib\atexit.py", line 24, in _run_exitfuncs
        func(*targs, **kargs)
    File "C:\Python24\lib\site-packages\myro\__init__.py", line 784, in _cleanup
        if "robot" in myro.globvars.robot.robotinfo:
AttributeError: 'SimScribbler' object has no attribute 'robotinfo'
Error in sys.exitfunc:
Myro is stopping: -------------------------------------------
Traceback (most recent call last):
    File "C:\Python24\lib\atexit.py", line 24, in _run_exitfuncs
        func(*targs, **kargs)
    File "C:\Python24\lib\site-packages\myro\__init__.py", line 784, in _cleanup
        if "robot" in myro.globvars.robot.robotinfo:
AttributeError: 'SimScribbler' object has no attribute 'robotinfo'
Exception exceptions.AttributeError: "'NoneType' object has no attribute '__del__'" in <bound method SynthAndOutput.__del__ of <pyTTS.sapi.SynthAndOutput object at 0x02392430>> ignored 
```

正如我所说，问题似乎出在 Myro 本身而不是我自己的代码上。我已经尝试根据班级的书面说明重新安装 Python 和 Myro，我什至尝试使用另一台计算机，但无济于事。这个问题太让我头疼了，我能做些什么来解决它？

# asp.net - 在 ASP.NET 中将错误作为字符串抛出

> ID：16095314
> 
> 赞同：1
> 
> 时间：2013-04-19T00:29:27.337
> 
> 标签：asp.net, exception, try-catch

我有一个使用这种方法的类：

```
public static DataTable getHeader(DALheader header)
{
    string sql = string.Format("EXECUTE getHeader @headerID = {0}", header.headerID);
    SqlDataAdapter headerAdapter = new SqlDataAdapter(sql, eformConnection);
    DataTable headerTable = new DataTable();

    try
    {
        headerAdapter.Fill(headerTable);
        return headerTable;
    }
    catch(Exception ex)
    {
        throw ex;
    }
} 
```

在 ASPX 后面的代码中，我调用了这个方法。如果我抛出`ex`，您会在浏览器中看到 asp.net 错误。我想将它们保留在页面上并显示错误。我将方法调用放在 try catch 中，但没有这样做，我无法返回，因为如果我返回任何东西`ex`，我必须返回 a 。`DataTable`我不确定如何将错误消息返回到页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:10:12.030

不要处理数据库代码上的异常，而是处理页面上的异常。

在课堂上：

```
public static DataTable getHeader(DALheader header)
{
    string sql = string.Format("EXECUTE getHeader @headerID = {0}", header.headerID);
    SqlDataAdapter headerAdapter = new SqlDataAdapter(sql, eformConnection);
    DataTable headerTable = new DataTable();
    headerAdapter.Fill(headerTable);
    return headerTable;
} 
```

在页面上：

```
try
{
    var headerTable = GetHeader();
}
catch(Exception ex)
{
     lblErrorMessage.Text = ex.Message;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:49:46.693

只是不要捕获您无法完全处理的异常。

您的类无法处理此异常，因为“处理”它包括向用户显示它。您的班级对用户一无所知。

让您的类的调用者捕获异常并将其显示给用户。你的班级应该没有 try/catch 块（并且还应该解决@Dai 指出的其他问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:40:10.467

您可以在后面的代码中捕获异常，然后打印错误消息。

可能的代码：

```
try {
      // call getHeader method
}catch(Exception ex)
{
     // assume you have a label lblErrorMessage
     lblErrorMessage.Text = ex.Message;
} 
```

# redirect - 如果您的代码被盗，这会将它们重定向回您的网站

> ID：16095315
> 
> 赞同：1
> 
> 时间：2013-04-19T00:29:34.363
> 
> 标签：redirect, encryption, header, obfuscation, copy-protection

在浏览了互联网之后，我发现除非您访问存储在服务器上的内容，否则没有真正的方法可以保护您的源代码。

即使使用混淆器使您的代码不可读，任何人仍然可以复制/粘贴它并在自己的网站上使用它。

所以我一直在尝试创建一种在被混淆/加密后将被盗代码重定向回网站的方法。

我一直在篡改以下代码以尝试使其工作，但还没有运气。

任何人都可以使这个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:34:11.907

这对我有用：

```
<script type="text/javascript">
<!--
if (window.location != "http://www.google.com") {
    window.location.href = "http://www.google.com";
} 

//-->

</script> 
```

# git - 如何合并我的 git 更改？

> ID：16095316
> 
> 赞同：1
> 
> 时间：2013-04-19T00:29:49.513
> 
> 标签：git

我是一个 GIT 新手，所以我有一些关于 git 命令、合并等的基本问题。我只是对代码做了一些更改，我做了一个 git commit，然后我尝试执行以下命令：

```
git push origin test:test 
```

（这个语法是什么意思？我知道我正在使用名为 的分支`test`）

出现错误，因为在我推送之前其他人进行了更改。所以错误说我需要做代码更改和合并。

1.  我应该执行什么命令来查看我所在区域与其他人所做更改之间的差异？有 git diff 但我应该使用语法吗？

2.  我想将我的更改与他的更改合并。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:40:35.367

您需要`git pull origin test:test`获取其他开发人员所做的更改并将它们合并到您的工作目录中。解决任何冲突并提交后，您将能够推送。

`git push origin test:test``test`意味着您正在将您在分支（左侧）上的本地存储库（克隆）中所做的更改复制回您在分支（右侧）`test`上进行克隆的原始存储库（原点）。`test``test`

严格来说，如果 local 和 origin 中的分支名称相同，那么写`git push origin test`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:43:05.200

要查看您所拥有的与其他人所做的之间的变化，请执行以下操作：

```
git diff origin/test 
```

如果您在其中，则不需要，因为您的遥控器已更新，但您需要`git fetch`确保您的遥控器状态已更新。

您需要做的就是`git pull`获取更新的更改。

我建议也这样做`git pull --rebase origin test:test` 该`--rebase`选项只会在原始更改之后添加您的提交。这将有助于保持历史更清晰，否则您将看到分支的合并提交到自身中。但这取决于你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T05:46:51.740

> `git push origin test:test`

这会将您的更改推送到名为`test`的远程分支的本地分支`test`。该`test:test`部分是 的（可选）`<refspec>`选项`git push`。

`<refspec>`格式`<src>:<dst>`为. 您使用它的方式是从本地分支推`test`送到远程分支，也称为`test`. 一个名为 test 的分支*必须*存在于远程调用的`origin`.

对于问题 1，您想要获取更改（但不将它们与您的工作文件合并）然后 diff，执行；

```
git fetch origin test:test
git diff ..origin 
```

请注意，我只包含该`refspec`选项，因为您在推送示例中使用了它 - 可能没有必要 - 默认情况下 git fetch 应该在 origin 上查找具有您签出分支名称的分支......但我离题了。 ..

对于问题 2，您希望将分支原点（在获取之后与远程原点保持同步）合并到您的工作副本中；

```
git merge origin 
```

+1 为 Felix Fling 对 pro git book 的评论...

# ruby - 如何使用 ruby gem aws-s3 设置 S3 存储桶策略？

> ID：16095321
> 
> 赞同：1
> 
> 时间：2013-04-19T00:30:13.993
> 
> 标签：ruby, amazon-s3

我正在尝试使用 aws-s3 gem 设置 S3 存储桶策略。但是，我对其他方式持开放态度。我有一个代表政策的原始 json 字符串。

我已经尝试了一段时间。我知道我能做到，只要有一个这样的日子。

如果有人知道如何，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T07:20:19.707

我推荐使用 aws-sdk gem（免责声明，我是贡献者）：

```
require 'aws-sdk'

AWS.config(:access_key_id => '...', :secret_access_key => '...')
AWS::S3.new.buckets['bucket-name'].policy = json_policy 
```

# jquery - 如何修复 iframe 拒绝显示文档，因为 X-Frame-Options 禁止显示

> ID：16095324
> 
> 赞同：0
> 
> 时间：2013-04-19T00:30:28.560
> 
> 标签：jquery, iframe

我不能这样工作。我让灯箱工作我得到了一个被点击插入到 youtube src 的链接，但我得到这个 Refused to display document 因为 X-Frame-Option 错误禁止显示。有人可以解释一下吗。

```
var $this = $(this),
      use_iframe =true,
      url = $this.attr('href'),
      name = $this.html(),
      // replace = false,
      $frame = $('#frame');

  var createvideoBox = function () {

      $('<div class="overlay"></div>').appendTo('#container');

      $frame.css({
        'top' : 50 + 'px',
        'position': 'fixed',
        'left' : 50 +'%',
        'margin-left' : -370 +'px',
        'width' : 1110 +'px',
        'z-index' : 2,
        'display' : 'block',
        'backgroundColor' : 'white'
      });

  }

  //  =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= //
  // // – Trigger Event 
  // // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 

      $('a').on("click", function(event) {

        var url = $(this).attr('href');

                  // console.log(url);

    // $('iframe').attr('src', url);

       createvideoBox();

          if(use_iframe) {

              $('iframe').attr('src', url);

          } else {

            window.open(url,name,replace);  

          }

          ///Prevent link execution 
          event.preventDefault();

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:47:23.700

听起来您正在尝试构建 YouTube`/watch`页面，例如：

```
http://www.youtube.com/watch?v=oHg5SJYRHA0 
```

YouTube 的框架选项不允许这样做 - 无论如何，该页面并不适合框架。`/embed`改为框架页面：

```
http://www.youtube.com/embed/oHg5SJYRHA0 
```

但是，对于这样的所有链接，没有通用的解决方案——许多网站（包括大多数 Google 的属性）都有禁止框架的框架选项。如果您需要此功能适用于所有链接，那么您就不走运了；没有办法做到这一点。

# html - 两列布局，右边是#navigation，但在html中的#content下面？

> ID：16095325
> 
> 赞同：0
> 
> 时间：2013-04-19T00:30:32.383
> 
> 标签：html, css, markup, two-column-layout

我有 2 列布局，出于 SEO 原因，我希望 #navigation div 位于 HTML 中的主要 #content div 下方。

**问题是 - 在某些页面上我想隐藏#navigation，所以#content 必须拉伸到 100%，但事实并非如此。**.

这是基本代码

页面类型 1：

```
<div id="wrap">
    <div id="content"></div>
    <div id="navigation"></div>
</div> 
```

页面类型 2：

```
<div id="wrap">
    <div id="content"></div>
</div> 
```

CSS

```
#wrap{
   position:relative;
}
#content{
   margin-right:200px;
}
#navigation{
   width:200px;
   position:absolute;
   right:0px;
   top:0px;
} 
```

如果你想玩它：

### **[http://jsfiddle.net/fWrAu/3/](http://jsfiddle.net/fWrAu/3/)**

我用 JS 修复它，但没有 JS 的用户会在页面类型 2 上看到右边距。
基本上我试图找到另一个**HTML/CSS 解决方案**。因为我的只是不工作。
任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:01:39.483

在正常的页面html结构中是这样的：

```
<div id="wrap">
    <div id="conten">CONTENT</div>
    <div id="navigation">NAVIGATION</div>
</div> 
```

CSS：

```
#wrap{
    position:relative;
    background-color:red;
    }
    #content{
        margin-right:200px;
        background-color:green;
    }
    #navigation{
        width:200px;
        position:absolute;
        right:0px;
        top:0px;
        background-color:blue; 
    }
    #content, #navigation {
        height:700px;
        font-size:24px;
    } 
```

如果没有导航，让我们在*“关于我们的页面”* html 中说：

```
<div id="wrap">
    <div id="content" class="aboutUs">CONTENT</div>
</div> 
```

然后添加这个CSS：

```
.aboutUs {margin-right:0 !important} 
```

[演示](http://jsfiddle.net/fWrAu/5/)

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:46:41.423

您可以将内容的宽度设置为 100% 并将 z-index 设置在导航上方吗？

# php - Codeigniter css 未加载/Google API PHP 客户端无法正常工作

> ID：16095330
> 
> 赞同：0
> 
> 时间：2013-04-19T00:30:58.680
> 
> 标签：php, codeigniter, google-api

当我将我的 Google API php 客户端代码移动到托管服务器时，它停止工作。在调试时我发现它无法获取`@_GET['code']`. [我在 SO 上发现了与链接](https://stackoverflow.com/questions/10274164/not-able-to-get-getcode-for-google-oauth-on-codeigniter)
相同的问题

但是当我更改我的 config.php 时`$config['enable_query_strings'] = TRUE;`，所有 css 文件都停止在页面上加载。所以我不知道改变这个配置值会解决我的第一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T06:14:12.103

对于 CSS ，您是否使用过

```
<?php echo base_ur('css/style.css'); ?> // ci_app_path/css/style.css 
```

这是一个很好的做法。您可以在 application/config/config.php 中设置 base_url()。

**忘记**

你可以试试 $_POST 吗？

# java - 模式匹配每个出现的第一个和第三个单词（中间的所有内容）

> ID：16095332
> 
> 赞同：0
> 
> 时间：2013-04-19T00:31:19.113
> 
> 标签：java, android, regex, pattern-matching

我正在尝试我认为是一个简单的正则表达式模式。

我有一个看起来像这样的文本文件：

> 胡说八道[http://www.google.com](http://www.google.com)。这里还有别的东西，呜呜呜。[http://x.oddree.com/image1.jpg](http://x.oddree.com/image1.jpg)。还有一些文字……等等。 [http://x.oddree.com/image2.jpg](http://x.oddree.com/image2.jpg)

我试图从那里获取的是任何以 http 开头并以 jpg 结尾的文本。不是完整的网址。只有那些以 .jpg 结尾的。

换句话说，我希望我的输出是：

> [http://x.oddree.com/image1.jpg](http://x.oddree.com/image1.jpg) [http://x.oddree.com/image2.jpg](http://x.oddree.com/image2.jpg)

我的正则表达式是： "\b(http).*(jpg)\b" 它似乎有效。但是当与模式匹配一​​起使用时，我最终会得到从 http 的第一次出现到 jpg 的最后一次出现的所有内容。我知道我必须双重转义将 \b 更改为 \b，但它仍然无法按预期工作。

为此，我已经把头撞在墙上好几个小时了。:-)

这是一个代码片段：

```
 if(file.exists())
             {
                 StringBuilder text = new StringBuilder();

                 try {
                     BufferedReader br = new BufferedReader(new FileReader(file));
                     String line;

                     while ((line = br.readLine()) != null) {
                         text.append(line);
                         text.append('n');
                     }
                 }
                 catch (IOException e) {
                     //TODO Write some error handling.
                 }

                 Pattern pattern = Pattern.compile(
                         "\\b(http).*(jpg)\\b"
                     );

                 Matcher matcher = pattern.matcher(text);
                 while (matcher.find()) {

                     result.add(matcher.group());
                 }

                 my_text.setText(result.toString());
             } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:40:31.450

尝试

```
Matcher m = Pattern.compile("\\bhttp://\\S+?\\.jpg\\b").matcher(s); 
```

# django - Django Field Error - Cannot resolve keyword 'xxxx' into field

> ID：16095334
> 
> 赞同：1
> 
> 时间：2013-04-19T00:31:40.207
> 
> 标签：django, post

I'm trying to do something fairly simple. Allow a user to type in a text field the searchterm, and select the search field from a drop down box. But I seem to be getting the above error.

Template

```
<form method='post' action=''>
<input type='text' id='searchterm'>
<select id='searchfield'>
    <option value='username'>Username</option>
    <option value='status'>Status</option>
</select>
</form> 
```

View

```
def existing(request):
        if request.method == 'POST':
                searchterm = request.POST['searchterm']
                searchfield = request.POST['searchfield']
                records = User.objects.filter(searchfield=searchterm)
        else:
                records = User.objects.all()
        return render_to_response('gpon_table.html',locals()) 
```

Models

```
class User(models.Model):
    username = models.CharField(max_length=50)
    status = models.CharField(max_length=50) 
```

Perhaps I am doing something wrong in the view.

Any help much appreciated.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T00:47:34.950

I believe the problem might be with how you're asking User.objects to search data. Since you're trying to pass in a dynamic keyword into the filter, you might have to pass it in as a `**kwargs` instead of directly as a filter parameter. I suspect that Django is reading "searchfield" as the literal keyword field name to search for rather than reading its value.

This link might provide more clarity on a possible solution. [https://stackoverflow.com/a/659419/1011998](https://stackoverflow.com/a/659419/1011998)

Here's an example of how you might implement the dynamic field with your current code setup.

**As always, sanitize and restrict user input, otherwise a malicious user may be able to expose sensitive data other than that which is intended for filtering**. *(note: this hasn't been tested locally)*

```
searchterm = request.POST.get('searchterm')
searchfield = request.POST.get('searchfield', 'username')

# Better to replace/populate this with form field choices
available_fields = ['username', 'status']

if not searchfield in available_fields:
    searchfield = 'username'

kwargs = {'{0}__{1}'.format(searchfield, 'icontains'): searchterm}
records = User.objects.filter(**kwargs) 
```

# winforms - CheckedComboBoxEdit 已创建但无法使用

> ID：16095335
> 
> 赞同：0
> 
> 时间：2013-04-19T00:31:52.720
> 
> 标签：winforms, devexpress, checkedlistbox, devexpress-windows-ui

我正在尝试将 a 添加`CheckedComboBoxEdit`到`GridView`using`WinForms`和`devexpress`。这是我现在得到的：

```
using (var _db = new DB())
{
    var isemirleri = _db.IsEmris.AsQueryable();
    var oalist = _db.OperasyonAksakliks.AsQueryable();

    gcIsEmirleri.DataSource = 
     (from i in isemirleri
      select new {
          ID = i.isEmriId,
          İşEmriNo = i.isEmriNo,
          Aksaklık = string.Join(",", 
              oalist
              .Where(o => o.operasyonId == i.Operasyons.FirstOrDefault().operasyonId)
              .Select(o => o.Durus.durusAdi).ToList())
      }).ToList();

    gvIsEmirleri.BeginUpdate();

//------------------------ THIS LINE -------------------------------------\\
    //DataColumn col = new DataColumn("Aksaklık", typeof(string));
//------------------------ THIS LINE -------------------------------------\\
    GridColumn column = gvIsEmirleri.Columns["Aksaklık"];
    column.Caption = "Aksaklık";
    column.Name = "Aksaklık";

    gvIsEmirleri.EndUpdate();

    RepositoryItemCheckedComboBoxEdit chk= new RepositoryItemCheckedComboBoxEdit();
    chk.Items.Clear();  
    foreach (Durus d in _db.Durus.Where(q => q.aksaklikMi == true))
        chk.Items.Add(new ListItem(d.durusId, d.durusAdi));
    chk.EditValueChanged += new EventHandler(chk_EditValueChanged);
    gvIsEmirleri.Columns["Aksaklık"].ColumnEdit = chk;
} 
```

它成功地在网格上显示了`Operasyons`逗号和`CheckedComboBoxEdit`s 之间的现在（它显示了单元格右侧的小按钮）。

但是，当我单击单元格时，不会显示元素列表。我调试了项目并观察到它`chk`设置正确并保持`Items`原样。

如果我取消注释我标记为的行`THIS LINE`并且没有添加`Aksaklık`到`gcIsEmirleri.DataSource`它成功添加列表并且可以正确使用，我可以将选中的元素添加到相关的数据库表中，但我看不到视图中的更改。我的意思是我看不到选定的元素，作为字符串组合或在行中检查。

我做错了什么或者我还能做些什么来让它发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T11:52:41.700

该列`Aksaklık`必须创建一次。添加新的`GridColumn`和分配`DataSource`会导致程序无法正常工作。

所以我在分配时创建了一个新列`DataSource`，命名`TempColumn`，将其设置为 false。之后，我添加了`GridColumn`并按照问题中的代码执行操作。之后，我使用`UnboundType`并从以下位置获取所需的字符串`TempColumn`：

```
column.UnboundType = DevExpress.Data.UnboundColumnType.String;
column.UnboundExpression = "[TempColumn]"; 
```

# javascript - 单击图片并转到另一张链接的图片？

> ID：16095339
> 
> 赞同：0
> 
> 时间：2013-04-19T00:32:00.533
> 
> 标签：javascript

我正在使用`onclick`两张图片，但是，一旦单击第一张图片，我希望第二张图片用作下一张图片的链接。我现在拥有的是两张来回切换的图片。

```
<html>
<head>
    <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
    <title>Starting Your Journey</title>
    <style>
        a:link {color: #ffffff;}
        .image
        {
            text-align: center;
            border: 10px solid black;
            margin-left: -30px;
            margin-right: 5px;
            margin-top: 80px;
        }
    </style>
</head>
<body style="  background-color:black;">
    <script>
        function changeImage()
        {
            element=document.getElementById('myimage')
            if (element.src.match("two"))
            {
                element.src="./choosingstarter.png";
            }
            else
            {
                element.src="./choosingstartertwo.png";
            }
        }
    </script>
    <div class="image">
        <img id="myimage" onclick="changeImage()" src="./choosingstarter.png">
    </div>
    <a href="../story_begin.html" style="text-decoration:none">Continue!</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:49:14.673

以下代码隐藏 currentImage 并显示下一个，或者在您的情况下，它会在显示所有图像后导航到其他地方。代替图像，您可以在 div 中添加几个 id 为 imgContainer 的 DIV 元素，然后隐藏并显示这些元素而不是图像。这样，您只需要一页即可显示所有带有故事文本的图像。

```
<html>
 <head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
<title>Starting Your Journey</title>
<style>
.image{
  text-align:center;
  border:10px solid black;
  margin-left:-30px;
  margin-right:5px;
  margin-top:80px;
  cursor: pointer;
}</style>
</head>
<body style="  background-color:black;">
 <script>
 // bad practice to have variables in the global scope
 // but to wrap the whole thing up in an object would
 // make this example too complicated
 var currentImage=0;
function changeImage(){
    // get all the images in the div with the id imgContainer
    var imageElements=document.getElementById("imgContainer")
        .getElementsByTagName("img");
    // set current image to 0
    imageElements[currentImage].style.display="none";
    // go to next image by adding one to current image
    currentImage++;
    // if the current image points to an image that doesn't exist
    // like 3 where there are only 3 images (0 is the first one)
    // then all the images have been shown, you can reset currentImage
    // back to 0 or navigate to another page
    if(currentImage>=imageElements.length){
       // navigate to another page
       window.location="http://www.google.com";
       // do not continue executing next lines
       return;
    }
    // this would reset the currentImage to 0 when it's
    // higher than the amount of images
    currentImage =(currentImage>=imageElements.length)
        ?0:currentImage;
    // show the next image
    imageElements[currentImage].style.display="";
}
 </script> <div class="image" id="imgContainer" onclick="changeImage()"> 
 <img src="./choosingstarter.png">
 <img src="./another.png" style="display:none">
 <img src="./and_another.png" style="display:none">
</div>
<a href="../story_begin.html" style="text-decoration:none">Continue!</a>
 </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:57:25.480

试试这个：

```
 function changeImage() {
    element = document.getElementById('myimage');
    if (/two/.test(element.getAttribute('src'))) {
            element.setAttribute('src', "./choosingstarter.png");
        }
        else {
            element.setAttribute('src', "./choosingstartertwo.png");
        }
    }; 
```

# java - Getting beginning and ending date in Java

> ID：16095342
> 
> 赞同：0
> 
> 时间：2013-04-19T00:32:07.197
> 
> 标签：java

I am writing a program in Java that allows the user to select a choice (1 : New, 2: Print Range, 3: Print All, quit). Once they choose one of the above they then enter the appointment date if they chose "New" and also enter a description for the appointment and lastly they pick if the appointment will be (1 = Once, 2 = Daily, 3 = Monthly).

I am getting an error on the line "**if (list.i.compareTo(lowDate) <= 0) && (list.i.compareTo(highDate) >= 0);**" It is giving me the error "**AppointmentNew.java:69: illegal start of expression**". I am not sure exactly why it is giving me that error!

Here is my code, I believe I have it all completed to carry out the above tasks!

```
import java.util.*;

public class AppointmentNew 
{
public static void main (String[] args)
{
  List<String> list = new ArrayList<String>();
  Scanner stdin = new Scanner(System.in);
  String choice = "";
  int choiceNum = 0;
  String date = "";
  String descrip = "";
  int type = 0;
  String typeChose = "";

  System.out.println("Welcome to Appointment App!\n");
  System.out.println("\t============================\n");

  do
  {
     System.out.print("\tMake Choice ( 1: New, 2: Print Range, 3: Print All, quit): ");
     choice = stdin.nextLine();

     choiceNum = Integer.parseInt(choice);

     if (choiceNum == 1)
     {
        System.out.print("\n\n\tEnter New Appointment Date in mm/dd/yyyy format: ");
        date = stdin.nextLine();

        System.out.print("\n\n\tEnter New Appointment Description: ");
        descrip = stdin.nextLine();

        System.out.print("\n\n\tEnter Type (1 = Once, 2 = Daily, 3 = Monthly): ");
        type = stdin.nextInt();
        if (type == 1)
        {
          Once once = new Once(date, descrip);
           typeChose = "One-Time";
        }
        else if (type == 2)
        {
          Daily daily = new Daily(date, decrip);
           typeChose = "Daily";
        }
        else
        {
          Monthly monthly = new Monthly(date, descrip);
           typeChose = "Monthly";
        }
          String stringToAdd = "";
          strinToAdd = "New " + descrip + " Appointment Added for " + date;
          list.append(stringToAdd);

        System.out.println("\n\n\tNew " + typeChose + " Appointment Added for " + date);

     }

     if (choiceNum == 2)
     {
     System.out.print("\n\n\tEnter START Date in mm/dd/yyyy format: ");
     String lowDate = stdin.nextLine();
     System.out.print("\n\n\tEnter END Date in mm/dd/yyyy format: ");
     String highDate = stdin.nextLine();

     for(int i = 0; i < list.size(); i++)
        {
         int dateSpot = list.i.indexOf(" ");
           if (list.i.compareTo(lowDate) <= 0) && (list.i.compareTo(highDate) >= 0);
        {
           System.out.println(list.i);   
       }}
     }

     if (choiceNum == 3)
     {
       for(int i = 0; i < list.size(); i++)
       {
          System.out.println(list.i);     
       }
     }

  }while (choice != "quit"); 
```

} }

Thank you in advance for any help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:33:31.077

The syntax `list.i` for accessing an element of the list is incorrect. You should use the [`get(int)`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#get%28int%29) method, e.g. `list.get(i)`, to get an element of the list.

Additionally, the entire `if` condition must be enclosed its own parentheses, and there shouldn't be a semicolon following between the `if` and the block in braces below it:

```
if ((list.get(i).compareTo(lowDate) <= 0) && (list.get(i).compareTo(highDate) >= 0))
{
    System.out.println(list.get(i));
} 
```

There are numerous other errors, including attempting to compare a `String` value with `==` (don't do that, use String's `equals` method), plus brace closing issues.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:40:13.070

There are a number of problems. To access a list item in a `Collection` you would need to use the `get(int)` method...

```
list.get(i) 
```

The if statement is formed wrong...

```
if (list.i.compareTo(lowDate) <= 0) && (list.i.compareTo(highDate) >= 0);
                                  ^-- Bad bracket
                                                                        ^-- This shouldn't be here 
```

Should be

```
if (list.get(i).compareTo(lowDate) <= 0 && list.get(i).compareTo(highDate) >= 0) 
```

Note, you have an extra closing bracket where you don't need it and the `;` at the end of the statement is going to make the statement redundant (ie it won't actually do anything)

# c++ - 如何使用 boost asio 禁用自动链接？

> ID：16095344
> 
> 赞同：0
> 
> 时间：2013-04-19T00:32:11.877
> 
> 标签：c++, xcode, boost, boost-asio, clang

我有一个包含一些 asio 头文件的项目，我已经静态链接了 boost_system，但是 ASIO 不断将 -lboost_system 添加到链接器中，因此生成的二进制文件取决于 boost_system 的动态版本，我有 -DBOOST_ALL_NO_LIB（在“其他链接标志”中) 以防止自动链接，但它似乎被忽略了。

我将 XCode 4 与 clang 和 c++11 一起使用

还有其他方法可以防止自动链接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:30:51.353

结果是，当我将 .a 文件添加到我的项目时，我需要将“文件类型”更改为 Match-O 目标代码，（正如这个答案指出的那样[https://stackoverflow.com/a/6124806/520221](https://stackoverflow.com/a/6124806/520221)注释） ，即使您将文件添加到构建阶段选项卡中的“链接文件到可执行文件”。

所以我认为 ASIO 在某种程度上知道该库是否已经包含（静态或动态）。由于“文件类型”它永远不会被链接，所以 asio 包含 -lboost_system 标志。

另一个提示，您必须使用 libstdc++ 构建 boost 和您的项目，它不适用于 libc++，我不知道为什么。看到这个[如何在 xcode/clang/macos 中针对使用 libc++ 编译的静态库编译应用程序？](https://stackoverflow.com/questions/14803622/how-i-do-compile-a-application-against-a-static-library-compiled-with-libc-in)，我认为它是一个错误或什么的

# ruby - 访问散列集合中对象的属性/方法

> ID：16095346
> 
> 赞同：0
> 
> 时间：2013-04-19T00:32:30.397
> 
> 标签：ruby

无论出于何种原因，我都无法访问每个循环内的位置属性。

这总是给我一个无方法错误。我已经尝试让@position 变量以一百万种不同的方式访问，但似乎没有任何效果。

```
class Recipe
    attr_accessor :directions
    def initialize(name,directions)
        @directions = directions
    end

    def directions
        @directions
    end

    def make
        ingredients = []
        @directions.each do |dir|
            puts dir[:ingredient].position
            #puts ingredient.position
            #direction[:ingredient].position = direction[:position]
            #ingredients.push(direction[:ingredient])
        end
    end
end

class Ingredient

    attr_accessor :name, :position
    def initialize(name)
        @name = name
        @position = nil
        @state = nil
    end

end

bread = Ingredient.new("bread")
cheese = Ingredient.new("cheese")

sandwich_recipe = Recipe.new("Sandwich",[
    { position: :on, ingredient: bread },
    { position: :on, ingredidnt: cheese }
])

sandwich = sandwich_recipe.make
#sandwich.inspect 
```

错误：

```
NoMethodError: undefined method `position' for nil:NilClass 
```

感谢您在这件事上的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:40:16.993

您在调用`Recipe`构造函数时有错字：

```
sandwich_recipe = Recipe.new("Sandwich",[
    { position: :on, ingredient: bread },
    { position: :on, ingredidnt: cheese }
])                          ^ 
```

你拼错了`ingredient`。

话虽如此，您永远不会将`@position`实例变量设置为除 之外的任何`nil`值，因此它永远不会有值。

我认为您真正想要做的是将位置传递给`Ingredient`构造函数，然后将成分数组传递给`Recipe`构造函数。

```
class Ingredient
    attr_accessor :name, :position

    def initialize(name, position)
        @name = name
        @position = position
    end
end

bread  = Ingredient.new("bread",  "on")
cheese = Ingredient.new("cheese", "on")

sandwich_recipe = Recipe.new("Sandwich", [bread, cheese])
sandwich = sandwich_recipe.make 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:40:25.997

我不确定您要做什么。但是我认为您的代码应该喜欢这样才能正常工作。

```
class Recipe
    attr_accessor :directions
    def initialize(name,directions)
        @directions = directions
    end

    def directions
        @directions
    end

    def make
        ingredients = []
        @directions.each do |element|
            puts element.name
            puts element.position
            #puts ingredient.position
            #direction[:ingredient].position = direction[:position]
            #ingredients.push(direction[:ingredient])
        end
    end
end

class Ingredient

    attr_accessor :name, :position
    def initialize(name, position)
        @name = name
        @position = position
        @state = nil
    end

end

bread = Ingredient.new("bread", "on")
cheese = Ingredient.new("cheese", "on")

sandwich_recipe = Recipe.new("Sandwich",[ bread, cheese ])
sandwich = sandwich_recipe.make 
```

# java - compareTo 方法：对象 arg？

> ID：16095349
> 
> 赞同：0
> 
> 时间：2013-04-19T00:32:50.290
> 
> 标签：java, arrays, sorting

我正在尝试使用下面的 compareTo 方法对数组进行排序。我很难理解它到底做了什么。我也不明白 Object arg 指的是什么。谁能向我解释一下这种方法的作用以及它是如何工作的？以下代码是我一直在使用的...

```
public int compareTo (Object arg)
{
    if (salary > ((Employee)arg).salary)
        return;
    else if (salary == ((Employee)arg).salary)
        return 0:
    else 
        return -1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:42:41.777

`compareTo`是比较`this`，`arg`所以`arg`是你比较。实际上，这段代码似乎通过比较员工的薪水来比较员工。假设说的那一行`return;`是`return 1;`，代码可以写成

```
public int compareTo (Object arg)
{ 
    Integer thisSalary = this.salary;
    Integer otherSalary = ((Employee) arg).salary;
    return thisSalary.compareTo(otherSalary);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:43:11.977

首先，有一个错误 - 第一个返回应该是`return 1`.

```
public int compareTo (Object arg)
{
    if (salary > ((Employee)arg).salary)
        return 1;
    else if (salary == ((Employee)arg).salary)
        return 0:
    else 
        return -1;
} 
```

现在，让我们看一下代码。

首先要注意的是，我们正在对合约进行编码——特别是[Comparable](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)接口，它要求您有一个方法，该方法`compareTo`接受一个参数，调用它`arg`并返回一个 int。`this`如果小于`arg`，则 int 必须为负，如果`this`大于则为正，如果等于 ，则为`arg`0 。`this``arg`

考虑到这一点，我们开始编码。我们唯一允许比较我们的 Employee 类的是其他Employees - 所以我们将对象`arg`转换为`Employee`. 如果不是一个，则会抛出异常。

然后，我们简单地将我们的薪水与其薪水进行比较，并根据两个员工的排序方式返回 1 或 0 或 -1。这允许员工具有自然排序和排序，例如以正确的顺序出现在`PriorityQueue`容器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:40:07.757

首先，我将假设第一个“返回”实际上应该返回 1。

它正在做的是返回一个订单。通过返回 1，表示对象 'arg' 应该出现在当前对象之后（即，它应该具有更高的索引）。类似地，值 -1 表示它应该在之前，值 0 表示它是相等的并且排序并不重要（尽管不同的排序算法可能对这些元素表现不同，这是一种称为[稳定的属性排序](http://en.wikipedia.org/wiki/Category%3aStable_sorts)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T00:44:41.217

Object 参数意味着您的 compareTo 将接收任何对象，而不仅仅是 Employee 对象。如果您想比较不同类的两个对象，这可能很有用（假设您想比较一个类 Person 和一个类 Dog，如果它们的权重相同，则返回 true）。

在这种特定情况下，您将 arg 转换为 Employee，这意味着您会将特定对象视为 Employee 实例。

我建议在您的代码之前添加一个“if (instanceof(Employee))”。这意味着您将仅在 arg 确实是 Employee 的情况下运行您的代码。（例如： if(instanceof(Dog)) 将阻止尝试将 Person 转换为 Dog）。这很有用，因为尝试强制转换不兼容的类型会导致异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T00:50:26.487

> 我也不明白 Object arg 指的是什么

为了对一组项目进行排序，您必须能够抓取其中一个项目并将其与另一个项目进行比较。为了对项目进行完全分类，需要进行许多此类比较。compareTo() 是您在数组中所有项目所属的类中定义的方法。compareTo() 方法允许排序例程抓取数组中的一项并在该项上调用 compareTo()。compareTo() 函数的参数是数组中的另一项。compareTo() 方法的返回值告诉排序例程如何对这两个项目进行排序。

# php - 将较低比特率的 mp3 转换为较高比特率

> ID：16095351
> 
> 赞同：-6
> 
> 时间：2013-04-19T00:33:04.060
> 
> 标签：php, ffmpeg

我有 2000 首 128 kbps 的歌曲，但在我的服务器空间中没有，所以我将那些 mp3 压缩到 16kbps 并在我的电脑上发现质量不错，但是当我在我的 iphone 上听这些歌曲时，我发现音质不好所以现在我想将那些 16kbps 的歌曲转换为 48kbps 的歌曲，我认为这将提供良好的音质，这样用户就无法区分歌曲是否被压缩并且加载速度也很快。这是我用来将 16kbps 文件转换为 48kbps 的 ffmpeg 代码。我可以看到转换后的文件的大小增加了大约 3 倍，但不确定当我通过转换提高比特率时它是否会提供更好质量的 mp3。请建议任何方法让我的文件恢复为良好的 mp3 质量

```
 <?php  
 if ( exec('ffmpeg  -i /pathtomp3folder/test.mp3  -acodec libmp3lame  -ab 48k -ac 1 -ar 44100  /pathtomp3folder/oputput.mp3'))

   {
  echo 'done!!';
  }

  ?> 
```

我也可以在不指定频率的情况下执行以下代码，这是最好的方法

```
 ffmpeg  -i /pathtomp3folder/test.mp3  -acodec libmp3lame  -ab 48k -ac 1   /pathtomp3folder/oputput.mp3

  {
  echo 'done!!';
   } 
```

我没有看到 16kbps 和转换后的文件质量有太大差异，但是在转换后的文件中大小增加了 3 倍

我们应该选择的最低 kbps 是多少，这样用户就无法检测到差异，而且我在没有缓冲的情况下也能获得高流传输速率。我的目标是移动设备，所以请就移动设备提出建议

16 kbps 文件大小为 745kb，48kbps 文件大小为 1840kb

我在哪里做错了任何想法，或者如果有人可以分享他的经验，这将是一个很大的帮助。我一直在努力找回我收集的 2000 首歌曲，因为我没有备份，而且在我的电脑中，mp3 的质量似乎还可以，但是当我在 iphone 上玩时，它清楚地表明它的质量很差

在我的服务器中，ffmpeg 已安装并正常工作，因此它很容易转换比特率。我想知道比特率何时从 16kbps 变为 48kbps 的另一件事是什么质量变化？？？/我可以清楚地看到尺寸在增加，但质量保持不变

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T00:39:16.070

您不能仅通过增加比特率来增加质量。这就像一个图像 - 如果你有一个 24px 正方形的图像，并将其增加到 72px，它只会变得模糊。FFMPEG 或任何其他库无法知道当您将其减少到 16kbps 时删除了哪些数据（如果数据仍然存在，您将不会减少任何文件大小），因此它无法将其放回原处。

获得体面的 48kbps 文件版本的唯一方法是将它们从更高速率的原件转换下来。如果您无法再访问它们...可以将其视为使用备份的一课。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:39:18.313

> MPEG-1 或 MPEG-2 Audio Layer III，通常称为 MP3，是一种获得专利的数字音频编码格式，它使用一种**有损数据压缩**形式。
> 
> 在 MP3 中使用有损压缩算法旨在大大减少表示音频记录所需的数据量，并且对于大多数听众来说，听起来仍然像是原始未压缩音频的忠实再现。... MP3 文件也可以以更高或更低的比特率构建，产生更高或更低的质量。

[mp3](http://en.wikipedia.org/wiki/MP3)。

您可以增加比特率，但声音不会更好。

# ssh - ssh ProxyCommand 不像常规命令那样工作

> ID：16095353
> 
> 赞同：3
> 
> 时间：2013-04-19T00:33:15.433
> 
> 标签：ssh, tunneling, ssh-tunnel

我正在尝试通过使用计算机-B 上的密钥通过计算机-B 隧道从计算机-A 到计算机-C。我已经将计算机 A 到计算机 B 和计算机 B 到计算机 C 的密钥共享

这适用于计算机A，无需密码或干预即可连接到计算机C：

```
ssh -t computerB ssh computerC 
```

如果我将相同的命令放在计算机 A 上的 ssh_config 中，它就会挂起

```
Host = computerC
  ProxyCommand = ssh -t computerB ssh computerC 
```

我收到以下错误： **不会分配伪终端，因为标准输入不是终端。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:51:50.883

尝试这个：

```
Host computerC
  ProxyCommand ssh computerB nc %h %p 
```

`nc`如果(netcat) 具有不同的名称或不在计算机 B 上的默认 PATH 中，您可能必须更改(netcat)。

* * *

解释：

`ssh -t computerB ssh computerC`通过 ssh 将您登录到计算机 B，然后从计算机 B 通过 ssh 将您登录到计算机 C。对于每一跳——从 A 到 B，然后从 B 到 C——ssh 建立一个到端口 22 的 TCP 连接，加密数据流经该端口。

ProxyCommand 禁用打开 TCP 连接，而是指定自定义命令来打开连接。连接的另一端应该有一个 ssh 守护进程，它可以与 ssh 客户端通信——shell 对它根本没有用处。

# ruby-on-rails - AngularJS 和 Rails 模板引擎

> ID：16095356
> 
> 赞同：4
> 
> 时间：2013-04-19T00:33:28.547
> 
> 标签：ruby-on-rails, angularjs, haml

作为一个 Rails 人，我爱我一些 Haml 或 Slim。但是，在使用 AngularJS 时，我都没有太多运气。是否有一个对 AngularJS 友好且比直接 HTML 更简洁的模板引擎？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T17:36:42.043

我正在为我的 angularjs 模板使用 slim。我花了很长时间才弄清楚该怎么做，但是一旦你知道怎么做就很容易了。

添加 slim gem 并捆绑安装。

确保您有一个模板目录。我的是：

```
assets/javascripts/templates 
```

然后在 config/initializers 中创建一个文件。我的只是 slim_engine.rb。名字无所谓。

然后在该文件中包含以下行：

```
Rails.application.assets.register_engine('.slim', Slim::Template) 
```

这是我拥有的使用这些模板之一的路由提供程序的片段：

```
angular.module('customer_app', ['customer_service'])
  .config(['$routeProvider', function($provider) {
    $provider.when('/:customer_id/edit/', { templateUrl: '/assets/customers/edit.html.slim', controller: 'CustomersController' });
  }])
  .config(["$httpProvider", function(provider) {
    provider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
  }]); 
```

完整的模板路径是：assets/templates/customers/edit.html.slim

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T12:00:57.010

我已经写了关于如何将haml用于带有rails的angularjs模板并在此处的一个请求中正确加载所有模板：http: [//minhajuddin.com/2013/04/28/angularjs-templates-and-rails-with-急切加载](http://minhajuddin.com/2013/04/28/angularjs-templates-and-rails-with-eager-loading)

# javascript - 在地址栏中执行 javascript 以获取并运行 cookie 的值

> ID：16095360
> 
> 赞同：0
> 
> 时间：2013-04-19T00:33:36.450
> 
> 标签：javascript, cookies

假设我只是通过浏览一个网站（我不拥有该网站）获得了一个 cookie，并且我知道 cookie 的名称。现在假设我在那个网站上，转到地址栏。我的问题是：输入某种 Javascript 代码后，我能否显示该 cookie 的值？或任何其他代码？

当我正在研究网站时，现在学习对我来说有点重要。（而且我知道我可以使用“Cookie Editor”等获取 cookie 值。我也只是想通过地址栏获取它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:47:58.827

`javascript:alert(document.cookie);`在 Chrome 的地址栏中对我来说效果很好（它会列出当前文档的所有 cookie）。请注意，出于安全原因，您必须键入而不是粘贴该`javascript:`部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:22:22.090

大多数浏览器只能向您显示您访问过的所有站点（包括当前站点）的 cookie 值。因此，在那里检查 cookie 值可能更容易。我知道 Firefox 有一个完整的内置 UI，用于显示给定域的所有 cookie。我怀疑 Chrome 也会这样做，但我现在必须寻找它，看看我是否能找到它。

在 Chrome 中，您可以访问：

```
Settings
Show Advanced Settings
Privacy/Content Settings...
All Cookies and Site Data...
Click on a Domain
Click on a cookie name
See the value for that cookie name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:25:51.790

除了使用地址栏之外，您可能还想查看 JavaScript 控制台（对于 PC，CTRL+SHIFT+J，我不确定 Apple）。您可以在那里编写 JavaScript 表达式而无需使用`window.alert()`etc。

# matlab - libSVM plotROC 使用 MATLAB 给出不一致的结果

> ID：16095363
> 
> 赞同：0
> 
> 时间：2013-04-19T00:34:20.640
> 
> 标签：matlab, libsvm

我有一个二元分类问题。我将 libSVM 与 plotROC 一起使用，但 AUC 值很奇怪。根据相同的函数，准确率为 24%（3741 中的 908），混淆矩阵为 908 0 2833 0

（所以一类总是错的）。但是 ROC 非常好 - AUC = 0.9383（满分 1）。我附上一张图片。我很乐意提供更多信息——我理解 ROC 曲线的含义——但在这种情况下，AUC 不能反映准确性（ROC 曲线上的点实际上在左边——顺便说一句'在报告准确性时，libSVM 不会选择 ROC 上沿对角线从 1 到 1 的点吗？），我不禁想到可能有问题。

感谢您的时间！

图片可以在 [http://postimg.org/image/mhj40mvnd/看到](http://postimg.org/image/mhj40mvnd/)

# sdk - DIA x64 & 本地免费

> ID：16095367
> 
> 赞同：0
> 
> 时间：2013-04-19T00:35:28.733
> 
> 标签：sdk, 64-bit, dia-sdk

我正在使用 DIA Sdk 从 PDB 文件中提取一些信息。我创建了非 com DiaSourceAlt 对象，因此我必须使用 LocalFree 来释放字符串。

以下代码在 x86 中运行良好，但在 x64 中，LocalFree 调用破坏了堆。

```
IDiaSymbol *lpSymbol;
BSTR bStrName;

...
hRes = lpSymbol->get_undecoratedNameEx(0x87FE, &bStrName);
if (SUCCEDED(hRes))
  LocalFree(bStrName); 
```

有什么建议吗？（我正在使用 msdia90.dll）

问候，毛罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:47:47.183

在做了一些逆向工程之后，我发现必须传递“(LPBYTE)bstr - 4”，因为 msdia##.dll 使用 LocalAlloc 进行分配，并在将数据返回给用户之前将指针递增 4。

我认为这种行为是为了模拟 BSTR，它将字符串的长度存储在 DWORD 中，就在指针指向的地址之前。我使用 x64 版本发现了这个问题。在 x86 中虽然有同样的问题，但应用程序不会崩溃但会产生泄漏。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-25T15:31:56.607

使用指针时请务必小心。LocalAlloc 将指针增加 4 个字节。BSTR 大小是单词，因此您只能执行“LocalFree(bstr - 2)”。

# c# - 将文件从 amazon s3 帐户转移到另一个帐户

> ID：16095368
> 
> 赞同：4
> 
> 时间：2013-04-19T00:35:35.653
> 
> 标签：c#, amazon-s3

我正在编写一个应用程序，我们需要在不同的 s3 帐户之间传输文件，我们不想在上传到目标 s3 帐户之前将文件保存在本地。
因此，我们使用以下方法获取源文件流：

```
public Stream GetFileStream(string path)
{
    var pathPieces = path.Split('/');
    string bucket = pathPieces[0];
    string fileName = pathPieces[pathPieces.Length - 1];

    GetObjectRequest request = new GetObjectRequest();
    request.BucketName = bucket;
    request.Key = fileName;

    GetObjectResponse response = Client.GetObject(request);

    return response.ResponseStream;
} 
```

之后我们使用这个流上传到目的地：

```
 TransferUtility transferUtility = new TransferUtility(Client);
    transferUtility.S3Client.PutBucket(new PutBucketRequest() { UseClientRegion = true }.WithBucketName(bucket));
    TransferUtilityUploadRequest request = new TransferUtilityUploadRequest()
    .WithBucketName(bucket)
    .WithKey(key)
    .WithPartSize(1024)
    .WithTimeout(100 * 60 * 60 * 1000)
    .WithAutoCloseStream(true)
    .WithCannedACL(S3CannedACL.PublicReadWrite)
    .WithInputStream(fileStream) as TransferUtilityUploadRequest;

    transferUtility.Upload(request); 
```

但在最后一行“上传”函数调用我总是得到这个错误： **这个流不支持搜索操作。**

有没有不同的方法来做我想做的事情？因为它接缝的方式不正确

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-11T19:34:57.377

我遇到了这个问题，并发布了我用来解决它的方法。从 Jon Skeet 那里借了一些代码。它对我有用，但我知道它有点笨拙，可能可以改进。

```
string filename = "nameoffiletocopy"

using (Stream stream = GetS3Stream(filename))
{
    AmazonS3Config config = new AmazonS3Config 
        {CommunicationProtocol = Protocol.HTTP};
    AmazonS3 client = 
        AWSClientFactory.CreateAmazonS3Client(
            "destinationaccesskey",
            "destinationsecretacceskey", 
            config);
    string destinationBucketName = "destinationbucketname";

    PutObjectRequest request = new PutObjectRequest
    {
        BucketName = destinationBucketName,
        InputStream = stream,
        Key = filename,
        CannedACL = S3CannedACL.PublicRead
    };

    PutObjectResponse response = client.PutObject(request);     
}

private static Stream GetS3Stream(string filename)
{
    AmazonS3Config config = new AmazonS3Config 
        {CommunicationProtocol = Protocol.HTTP};
    AmazonS3 client = AWSClientFactory.CreateAmazonS3Client(
        "sourceaccesskey",
        "sourcesecretacceskey", 
        config);
    string sourceBucketName = "sourcebucketname";

    GetObjectRequest request = new GetObjectRequest 
        {
            BucketName = sourceBucketName, 
            Key = filename
        };

    using (GetObjectResponse response = client.GetObject(request))
    {
        byte[] binaryData = 
        ReadFully(response.ResponseStream, -1);
        //ReadyFully from Jon Skeet's blog
        return new MemoryStream(binaryData);
    }
} 
```

[Jon Skeet](http://www.yoda.arachsys.com/csharp/readbinary.html)充分解释了 ReadFully 方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T01:52:36.307

我真的不认为有一种方法可以在帐户之间转移。我知道的唯一可以做到这一点的协议是[FXP](http://en.wikipedia.org/wiki/File_eXchange_Protocol)。您可以在将来向 AWS 提出请求以执行此操作，这将是一个不错的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T17:07:11.427

亚马逊有一个复制对象请求

```
AmazonS3Client client = new AmazonS3Client();

CopyObjectRequest request = new CopyObjectRequest {
      SourceBucket = "fromBucket",
      SourceKey = "fromFile",
      DestinationBucket = "toBucket",
      DestinationKey = "toFilename",
      CannedACL = S3CannedACL.BucketOwnerFullControl
 };

 CopyObjectResponse response = client.CopyObject(request); 
```

# opencart - Opencart 的语言切换器

> ID：16095377
> 
> 赞同：1
> 
> 时间：2013-04-19T00:36:14.007
> 
> 标签：opencart, language-switching

尽管我发现 Opencart 中的内置语言管理接近完美，但我需要为网站上任何位置的任何文本添加语言切换器扩展，其工作原理如下：

```
{en}text shown only on English site{/en}
{de}text shown only on German site{/de} 
```

类似的扩展在 Joomla 中被广泛使用并且非常流行。

有人知道 Opencart 的这种扩展吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T07:26:18.247

你为什么不直接使用你提到的标签：

```
{en}text shown only on English site{/en}
{de}text shown only on German site{/de} 
```

然后在渲染之前在输出上添加 preg_match。

在 system/engine/controller.php 中找到这一行：

```
$this->output = ob_get_contents(); 
```

替换为（在我的示例中，英语和俄语的语言 ID 分别为 1 和 2）：

```
//check for current language and do preg_replace on output

/* get current language ID */
$cur_lang_id = $this->config->get('config_language_id');

/* store buffer output in variable */
$html = ob_get_contents();
$tags = array('/\{en\}/','/\{\/en\}/','/\{ru\}/','/\{\/ru\}/');

/* do replacements */
if ($cur_lang_id == '2') {$html = preg_replace('/\{en\}.+\{\/en\}/','',$html);}
if ($cur_lang_id == '1') {$html = preg_replace('/\{ru\}.+\{\/ru\}/','',$html);}

/* remove tags */
$html = preg_replace($tags,'',$html);

//$this->output = ob_get_contents();
$this->output = $html; 
```

# c++ - 为什么要在套接字的“recv”方法上设置保守的最大字节大小？

> ID：16095380
> 
> 赞同：0
> 
> 时间：2013-04-19T00:36:21.867
> 
> 标签：c++, python, sockets, networking, tcp

我正在使用 Python 的 socket.socket 类构建一个客户端，该类接收大小不同的数据（通常在 500 到 5,000 字节之间，但理论上客户端套接字可以接收 500,000 字节）。我还在编写将与此客户端套接字通信的服务器。

我很想知道，设置我可以确信我永远不会超过的最大字节大小的风险是什么，例如：

```
socket.recv(1000000) 
```

即使我知道这远远大于套接字实际使用量的 99%。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:00:50.200

你所做的只是以史诗般的规模浪费内存。

1.  如果您以最大速度阅读，您将永远不会超过路径 MTU，它通常小于 1500 字节，并且肯定以千字节而不是兆字节为单位。

2.  如果您没有以最大速度阅读，内核内部已经有一个套接字接收缓冲区，根据您的平台，其大小在 8-64k 范围内，并且通过 TCP 的操作，recv() 完全不可能提供比该缓冲区中更多的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T12:48:33.527

套接字不像你想象的那样工作。 `socket.recv(N)`并不意味着你会得到 N 个字节。*这意味着您最多*将返回N 个字节。这与发件人尝试发送给您的字节数无关。TCP 是*面向流的*。这意味着您将按照发送者发送它们的顺序获得发送者发送给您的字节。但是你不会得到他们在发送数据时使用的相同的“消息”边界。

您*必须*编写代码才能多次调用 recv，因为据您所知，`socket.recv(1000000)`它将返回一个字节给您。现在，只要您多次调用它，您就不必考虑参数的大小与您收到的消息的大小相比。正如其他海报所说，您希望传递一个与堆栈其他级别的最大缓冲区大小相当的值。其中一个缓冲区（路径 MTU）可能约为 1500（但它可以更大或更小）。但是内核的 TCP/IP 堆栈中的本地接收缓冲区更大，可能在 64k 或 128k 左右。这些可能接近使用的合理值。

不过，我建议不要在这个级别实际编写网络代码。它已经完成了 - 或多或少地死亡。专注于应用程序的新颖部分并重新使用一些为您处理这些细节的现有库可能会好得多。我推荐[Twisted](http://twistedmatrix.com/)。

# javascript - 为什么我的背景图片会延迟？

> ID：16095383
> 
> 赞同：0
> 
> 时间：2013-04-19T00:36:36.247
> 
> 标签：javascript, sencha-touch, sencha-touch-2

我在 Sencha Touch 2.1.1 中使用项目模板来显示状态、图片和有关用户的一些详细信息作为列表中的项目。当我加载页面时，我看到加载所有图片都有延迟，除了第一个图片，这与 JSONP 调用拉状态的时间差不多。[你可以在这里](http://screencast.com/t/8hbejuvMkkCm)看到。

我的模板非常简单：

```
 itemTpl: [
        "<div class='listView people'>",
        "   <tpl if='workforceID != undefined'>",
        "       <tpl if='workforceID == \"phind\" || workforceID == \"NULL\"'>",
        "           <div class='avatar notFound user'></div>",
        "       <tpl else>",
        "     <tpl if='presence != undefined && presence != null && getAvailability(presence) == \"Available\"'><div class='avatar status available' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span></span></div>",
          "          <tpl elseif='presence != undefined && presence != null && getAvailability(presence) == \"Busy\"'><div class='avatar status busy' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span></span></div>",
          "          <tpl elseif='presence != undefined && presence != null && getAvailability(presence) == \"Away\"'><div class='avatar status away' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span></span></div>",
          "          <tpl elseif='presence != undefined && presence != null && getAvailability(presence) == \"Unavailable\"'><div class='avatar status unavailable' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span><em></em></span></div>",
          "          <tpl elseif='presence != undefined && presence != null && getAvailability(presence) == \"Offline\"'><div class='avatar status offline' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span></span></div>",
          "          <tpl elseif='presence != undefined && presence != null && getAvailability(presence) == \"Do Not Disturb\"'><div class='avatar status dnd' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);''><span><em></em></span></div>",
          "     <tpl else>",
          "         <div class='avatar status offline' style='background-image: url(https://services.xxx.com/emppics/{workforceID}.jpg);'><span><em></em></span></div>",
          "     </tpl>",
        "       </tpl>",
        "   </tpl>",
        "   <ul class='data'>",
        "      <li><h3><strong>{fullName}</strong></h3></li>",
        "      <tpl if='title != undefined && title != null'><li><span class=\"userTitle\">{title}</span></li></tpl>",
        "      <tpl if='roomNumber != undefined && roomNumber != null && roomNumber != \"\"'><li><span class=\"userOffice\">Office: {roomNumber}</span></li></tpl>",
        "   </ul>",
        "</div>"
    ] 
```

状态的 Ajax 调用是这样的：

```
function getUserPresence (record) {
    var email = record.get('mail');
    if (email && email !== 'NULL') { // Need to actually check for text value of NULL :(
        // Get Users' Presence
        Ext.data.JsonP.request({
            url: Global.presenceUrl + encodeURIComponent(email),
            callbackKey: 'callback',
            disableCaching: false,
            success: function (result, request) {
                if (result) {
                    var presence = result.Availability;
                    record.set('presence', presence);
                }
            },
            failure: function () {
                console.log('Unable to obtain Lync presence at this time');
            },
            timeout: 15000, //if no response something is wrong and just cancel
            scope: this
        });
    }
} 
```

如果我拉 JSONP 调用，图片当然会立即加载，所以我不确定为什么 JSONP 调用会阻止背景图像的加载。浏览器不应该获取图像而不管进行 JSONP 调用需要多长时间吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:18:45.250

我发现的最佳解决方案不是使用 CSS，而是使用`<img>`标签。所以现在我的代码变成了：

```
<div class='avatar status available'><img onerror='imgError(this)' src='https://services.xxx.com/pics/{id}.jpg'/></div> 
```

这会导致图像按预期加载而不会被阻止，如果图​​像无法发送默认图像，我将受益于检查错误：

```
function imgError (image) {
    image.onerror = function () {
        this.parent().addClass('user');
    }
    image.src = "/resources/img/user.png";
    return true;
} 
```

# dns - 使用 WhoIs 确定域可用性

> ID：16095386
> 
> 赞同：2
> 
> 时间：2013-04-19T00:36:41.897
> 
> 标签：dns, whois, tld, registrar

我正在使用执行 WhoIs 查询的 API 来确定域的可用性。

但是，似乎每个 TLD 都会给出不同类型的响应，因此我必须为每个 TLD 创建自定义搜索：

```
result.match("No match for") //.com
result.match("NOT FOUND") //.info, .org
!result.match("Administrative")//.biz
result.match("Invalid query or domain")//.tk
!result.message.match("registered")//.ca
result.match("No Match")//.edu
result.match("Status: free")//.de
result.match("Not found:")//.de 
```

还有数百个 TLD 需要处理。当然，这不是最好的方法。是否有更简单的方法来确定域是否已注册？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T07:42:32.063

不幸的是没有。确定域是否可用的唯一方法是通过 whois 调用。您不能使用其他方法，例如 DNS，因为即使域没有解析它也不意味着它可用。

主要问题正是这个问题：每个服务器都可以使用完全不同的字符串进行响应。如果你真的想把它做好，你必须收集所有不同的字符串或针对大量的可能性进行测试。

我是[Ruby whois library](https://github.com/weppos/whois)的作者。到目前为止，它是唯一一个为每个响应提供规范和解析器的开源库。看看吧，你可以直接使用它或者从那里得到所有不同的响应，代码是开源的。

另外请记住，如果您不想处理这个问题，可以使用一些服务来检查域的可用性。

这里有几个：

*   [RoboWhois](https://www.robowhois.com/)
*   [域工具](http://www.domaintools.com/api/docs/)

*免责声明：我是[RoboWhois](https://www.robowhois.com/)的作者。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-08T13:19:24.217

我试图通过编译一个全面的[Whois 服务器列表](https://github.com/whois-server-list/whois-server-list)来解决这个问题。此列表包含 500 多个顶级域。随意使用该列表。

但是，如果您不想费心使列表保持最新或对 whois 服务器进行速率限制，我可以向您推荐我的[Whois API](http://whois-api.domaininformation.de/)，它也在使用该列表。

# ruby - 为什么 `middleman serve` 工作，但 `middleman build` 无法编译这个 Sass？

> ID：16095388
> 
> 赞同：5
> 
> 时间：2013-04-19T00:36:51.763
> 
> 标签：ruby, sass, compass-sass, middleman

当我跑去`middleman`发球时，`all.css`编译得很好，只需要调用`+box-shadow(none)`：

```
/* line 1, /home/yang/asdf/source/stylesheets/content.css.sass */
div {
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none; } 
```

但是当我构建站点时，我得到了这个 Sass/Compass 错误：

```
$ middleman build
Slim::EmbeddedEngine is deprecated, it is called Slim::Embedded in Slim 2.0
Slim::EmbeddedEngine is deprecated, it is called Slim::Embedded in Slim 2.0
Slim::EmbeddedEngine is deprecated, it is called Slim::Embedded in Slim 2.0
/home/yang/asdf/source/stylesheets/content.css.sass:2:in `box-shadow': Undefined mixin 'box-shadow'. (Sass::SyntaxError)
  (in /home/yang/asdf/source/stylesheets/content.css.sass:2)
        from /home/yang/asdf/source/stylesheets/content.css.sass:2
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:253:in `visit_mixin'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:37:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:100:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `map'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:109:in `block in visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:121:in `with_environment'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:108:in `visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:37:in `block in visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:320:in `visit_rule'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:37:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:100:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `map'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:53:in `visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:109:in `block in visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:121:in `with_environment'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:108:in `visit_children'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:37:in `block in visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:128:in `visit_root'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/base.rb:37:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:100:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/visitors/perform.rb:7:in `visit'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/tree/root_node.rb:20:in `render'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/engine.rb:315:in `_render'
        from /var/lib/gems/1.9.1/gems/sass-3.2.7/lib/sass/engine.rb:262:in `render'
        from /var/lib/gems/1.9.1/gems/sprockets-sass-0.9.1/lib/sprockets/sass/sass_template.rb:40:in `evaluate'
        from /var/lib/gems/1.9.1/gems/tilt-1.3.7/lib/tilt/template.rb:77:in `render'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/context.rb:197:in `block in evaluate'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/context.rb:194:in `each'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/context.rb:194:in `evaluate'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/processed_asset.rb:12:in `initialize'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:374:in `new'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:374:in `block in build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:395:
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:373:in `build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:94:in `block in build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/caching.rb:51:in `cache_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:93:in `build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:287:in `find_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:61:in `find_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/bundled_asset.rb:16:in `initialize'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:377:in `new'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:377:in `build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:94:in `block in build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/caching.rb:51:in `cache_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:93:in `build_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/base.rb:287:in `find_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/index.rb:61:in `find_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/environment.rb:75:in `find_asset'
        from /var/lib/gems/1.9.1/gems/sprockets-2.9.2/lib/sprockets/server.rb:47:in `call'
        from /var/lib/gems/1.9.1/gems/middleman-sprockets-3.0.11/lib/middleman-sprockets/extension.rb:200:in `call'
        from /var/lib/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:134:in `call'
        from /var/lib/gems/1.9.1/gems/rack-1.4.5/lib/rack/urlmap.rb:64:in `block in call'
        from /var/lib/gems/1.9.1/gems/rack-1.4.5/lib/rack/urlmap.rb:49:in `each'
        from /var/lib/gems/1.9.1/gems/rack-1.4.5/lib/rack/urlmap.rb:49:in `call'
        from /var/lib/gems/1.9.1/gems/middleman-more-3.0.13/lib/middleman-more/extensions/minify_javascript.rb:51:in `call'
        from /var/lib/gems/1.9.1/gems/middleman-more-3.0.13/lib/middleman-more/extensions/minify_css.rb:50:in `call'
        from /var/lib/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:134:in `call'
        from /var/lib/gems/1.9.1/gems/rack-test-0.6.2/lib/rack/mock_session.rb:30:in `request'
        from /var/lib/gems/1.9.1/gems/rack-test-0.6.2/lib/rack/test.rb:230:in `process_request'
        from /var/lib/gems/1.9.1/gems/rack-test-0.6.2/lib/rack/test.rb:57:in `get'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli/build.rb:259:in `block in execute!'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli/build.rb:256:in `each'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli/build.rb:256:in `execute!'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli/build.rb:198:in `invoke!'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/actions.rb:95:in `action'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli/build.rb:65:in `build'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/task.rb:27:in `run'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/invocation.rb:120:in `invoke_task'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor.rb:275:in `dispatch'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/base.rb:425:in `start'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli.rb:77:in `method_missing'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/task.rb:29:in `run'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/task.rb:126:in `run'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/invocation.rb:120:in `invoke_task'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor.rb:275:in `dispatch'
        from /var/lib/gems/1.9.1/gems/thor-0.15.4/lib/thor/base.rb:425:in `start'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/lib/middleman-core/cli.rb:22:in `start'
        from /var/lib/gems/1.9.1/gems/middleman-core-3.0.13/bin/middleman:18:in `<top (required)>'
        from /usr/local/bin/middleman:19:in `load'
        from /usr/local/bin/middleman:19:in `<main>' 
```

我在下面的小简单示例中复制了这一点，如果您想在本地复制，我还将其作为 base64 编码的 tar.gz 包含在底部。它还包括完整的回溯。

这是文件树：

```
asdf
├── config.rb
├── config.ru
├── error
├── Gemfile
├── Gemfile.lock
├── source
│   └── stylesheets
│       ├── all.css.sass
│       └── content.css.sass 
```

以下是所有文件内容：

配置.rb：

```
require 'animate-sass'
require 'susy'
require 'slim'
set :css_dir, 'stylesheets'
set :js_dir, 'javascripts'
set :images_dir, 'images'
set :fonts_dir, 'fonts'
configure :build do
  activate :minify_css
  activate :minify_javascript
  activate :relative_assets
  require "middleman-smusher"
  activate :smusher 
```

配置.ru：

```
require 'rubygems'
require 'middleman/rack'
run Middleman.server 
```

宝石文件：

```
source :rubygems
gem "slim"
gem "susy"
gem "animate-sass"
gem "middleman", "~>3.0.13"
gem "middleman-smusher" 
```

Gemfile.lock：见 tar.gz

all.css.sass：

```
@import compass/css3/box-shadow
@import content 
```

内容.css.sass：

```
div
  +box-shadow(none) 
```

这是 base64 编码的 tar.gz，您可以使用以下代码对其进行解码`base64 -d`：

```
H4sIADhQcFEAA+0ca3Mbt1Gf+SsQujOiW/GePFLixJo4juK2Ezsau55+vEJ3oAjrHixwJ0uZTH57
F497UZRFSTzZbrAfbBIL7Au7e7s4iJjHC5swlrO93sABmE4n4n93Frj6f0+OO47nBL6/53quP3EC
x/FhnusGXrCHnP5EaqDkBWYI7V3j7Pxz8+7Cf6PwF5TSOE5IijN0VtIkHrxPaDqfn6RnJI5JfJKd
04wgylFMVoxEuCDxAaKFGIlwkpAYdRcgmskR5FnOV0vLXuYpscWW2lgEAM9LFhGbF9cJ4UtCCm5H
eVaQrLAizi2OOZ97c6Dwn7P8asyXOM4/7c/RhywmCxAjBiNeAXa/hbXQ6L1YNn9/nRX46kSE2PMB
QiOY9yD2YrGCBcvTh9FYI3GJmZ3QM/ucpNx2rSPLVR/F5LFvedZMosVXu2CE2JeU0yJn3F4RtshZ
arGzuRf40jISF0pD7O+MzxnmRDDxZw2P3VFvaeE6Th8cKvm1jc6SPLoQnqiMFS0h4BjpwV6aX4pX
vdHuS4XOphw9jdnaPD1X8vxEi2VIskvK8iyFKOpJwcNebbkWPl079qKR77XiKGRlQkwyMMnAJIM/
ZTJwvbZGLM97CKZvNRm0OOxSA2HkMMtjaRudi8GLYsIeQ5rIalua2w0kzXCXRL2p9xBBVww8GArd
saTuSIykXiEUH/FPWJB0lUCTINhNlFnIJU5KGNqWX0GTYuxavtZBfLXbZGezRynhwaC3Jr+s4K8K
6YZHa2F7X/HvwWmi7IOjZX/Edyq9+EA4J3EIe00UI+VSNKMFxQn9bUecmrSj9MjIp34I1/ssu3Kl
1445HalQjiiLygSzUPTNIUwrSFTQfPsnz5Z66apn1+pQCLcrweGob8NFEBA0O5dlj6oLxAjpR5me
rFVth3eo0skCOPaiwNTthf5ZmcVJJ86nPcf5rK84n5l4MPHwWPqtpkTWIEEvXDhhl4TJ2mmmNzpJ
tiVdHzCPGya+5ViuqtY2oG0oFkjG4Rmkqljn3jwZji6gVptYgUSLr7b0HaWF6092QrJkCXTVcnvX
gm13lCdH967GtiL4sC1Mc0bU7vlruycwzcaJNRldXIcf8SXmEaOropMnnoS3OPgWTL8e/ykIL6BT
meoIk3RTcJmQQ/mq/d2vurb/ljD70eTFmAwjTVfXyuGu6QcqM5xvn3Oa/Ytu3VmBsaOEKuur9w1r
50DkikRlQb7rm+303nH4SE5Popd7dKgLqMv8YntmxTJn4AluYE1UNwzfbSz7BhlzurfA9+okHqbB
NGhKg0eJX2B+ITdAN/Ll1oJvJCcsGuFCR7WrD2OUnUPB6zHUlZxK85jyFS62d8uN0laF0MRTRMVr
8V4iuXVUkhJgHYcphdyXne9m7452sncVOdebGl/o1xc8b1c8zmjWYOauymvfF/kKjcTDjjISPz9e
Z1FyYAF7k6wvV46U5PhGUrljyfcpphnw+dJXO7YCeXcgyrMFFX1cPzw+f//H8R1/Ku//+NPZxJsE
e47reVPX3P95Cnj27NngGXqVpytoFwfiG3x9X/JrdM5ozEV9VSPRz5TxYo4gBGEc7JYkiIup4/GK
kcFABxnaxxlNcUHkufx+Myzm7gv6r5ZgTFIRRsr9SibzI6AjNR6qcRTn6Hf18XdAIj3dystiVRah
vPCCXqC5XBUVMIVk8WCgFDvFwCdfybLkACX4GlbBB5xQSHEc4SxGUA9fUaJ1b2RNaCplPSVsvBJU
1GIUSdn5fCDI/5sWS5TlGgcDcubQhhS8tIvcXtCEWMsiTYYHaK4JvDhGC5xw0hDASUFYBtpfkvtS
mufFkrBqESx7icQK9GlJI0E4QUsMVGES4jhtkZdvNDWdOY6hYQI7S/NqxnLM/uuwtic6BUNdo9EC
X5DnSMjDGzGLJeXSTOMl5uMsH9cvRiqZV3I1iDysX5qMG6Uq5j9IwUPBI5SkX6DhO/lCBQoEhJFA
KJ6fpOUQPCEoPkvIsLvvfyfJirDaoV+WRQ4eSSMEjgmLY5rqVhHlmRqDp/A5WsplsEDUrZcgItim
WhqqaZz+BorDlDeyeBH3z9QVMLCgMLMiwZFqTzD4EjTANBEyyilad2G7aqrWHQghnqckrKUQMBSq
gPJD+V2oqBXlBHYOOtwwpuwAHLa5+LWvkR8rXNOD1zipTIVXXyrUIs+KCiM/AwKY/ijq6zFfkYgu
wJDdoK2+gcFkHS50QggyRs6gP8OgMznQoSOtVIW+CmKkgngBk2OySvJrcZwF65tdaBr6gaT7Rn5H
/6wVE/uo7i9uWNbor1afZHI75GklrOIQfnK8WagOMjVK4j5wghhJVJR+ePcL7zCqMOrQTQsplGTQ
aqPTt68h1yyAVi3jxmTaOgpLS9hLIVWVkYY3kMOOBNUKSftXhkqQF4OjLxaEgTW144vkIGfInV4W
xSoUQwcQla/UbUFbOYM9HICXfemnk4G+oVP/lf3wuKP+c1zHu1H/zXxT/z0F1AUPK8+uRW/Vqtfq
jCMP+uApAF0wZF49aKmXAt9Gm2PgFpDx/5qkohTri8ed8R/M1uLfnU1N/D8JqD8bgAJGh/9gIAqS
oWh/hvojdG36Y7uv00N1joAaf/jHsTqJWcc1FcuXVtfAGrTj3xItSw887oj/wHed9ef/zJma+H8K
eH3yRjYZaV6QORINwdy2q2Rg5ezcBrRo+vhcnoLKhoPwcrXKWYFG4kqn61d/mkTdwwyNXiDxhtCt
BtMyKWj4kUODNvrjGLmWozDtZIJGkDaaJfoACI2OBS3XtQKFiZZldnEdrrJzNHKB86EezqHJAUKq
ERx5gHEaUi3cWGU7jRLv1z7ymxT0LMHCt/yKhZYIxAH6NfWWQFK3GrPgPNXye9asGlW6wky/UlYJ
IXhNGqFvM5kiKii6emSJ0wSNYGnDWdxLVTh6QZSdNE62ewxabuhDhSKtRaLAk+ICr0aOkiVhmpfQ
PQoxJN+GUpRQ0VeCuWsrqf1v7b5SwbVmlQkSCh21nDOrFqWYlRdlZxkYSv7R3LpEzZ8qjtSDpjZY
532AcMHb8Okd+PoOit4mp3KydRZdAmthIZd61rRCq1trTO9mrWVlDWnc2iDVbsi5k2Z2/QZeL2iZ
i52NF5xcknqnjhpi4o2OHhVvedpuonn4laDrZurquBZmsPTOSKsZtIh0QrsVS1UkaLVrusrFj8WW
uY1FlatpOzgH6Hv5oSZWOVU1YVtHWeGY0SwfV0dzMplBoKxFsJbGayLlPKELWu+wd9OiugRSRr0p
j6bZQtULpA4T6+gGxcZV1XWq27xdU24mdJ3cs24ixnWmktfqNetWWhIxra1d2UxZtGuuzXHR7G07
IykXbSUlTjNcMFw7kbvZpb2NLu10has3tCtf243WfaDykPYKFZnyYlAzMG7uTAtc0OgnsM00Fbsd
P23n3YqgzNrgCFWstoO7Fdlqh/zm8VKbqxXR3VzSySRtoZXNNtnxAEnh6ggWjYHicFhPF0fapI61
jWTq5ZVTtzy6+zgBdq2kIJytFvpCPblb3ivvKtZU5POu+xi+7UnasYuzQWL3AH33ou1I66HRioub
AbWRoqYjXpiN3GZ7P5cTW9mmJlo9GlvPxWoHhPk1VRUi7ZSvRJF/v6IGmpzltmuUKg9LYfzPFCV6
S1tFQqtC0L4/OP3l5b9+/vXdm/eiyoSycjD46eT05O1PJ29f/eNEDLbLwEEnIernr0rOm47GhS8O
lEVNY/lAaP92QF88RJM3mwW3nv8A6N//mAQT15fnP4G/h4K+BGrDn7z/u+23I3bJ4/77P/G9mdn/
p4Db9h8nSf27IY/lcdf5rzOt93/iBuL3f6ZBYM5/ngR+oKkszXUNYsOe+3bzMzaDBi/fDpvn7P8Z
bPvbQY/hcWf8+3X8+7MpjLuzibn/9zQQ00soof/WRPwoyzPy3MS5AQMGDBgwYMCAAQMGDBgwYMCA
AQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMDAVwr/A5doTQIAeAAA 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-20T00:52:52.807

事实证明，这是由于某些不打算输出的文件的名称不以下划线开头。例如，`content.css.sass`应该是`_content.css.sass`，这样就`middleman`知道不要尝试直接构建该文件。（我们不太熟悉`middleman`etc. - 这是交给我们的一个包裹，所以花了一段时间才找到它。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-07T20:15:59.313

所以我碰到了这个，想给出一个更准确的答案：

`@import`非下划线命名文件下游链中的任何ed 文件都将因错误而中断，例如`Sass::SyntaxError` `Undefined Variable`or `Undefined mixin`。

就像确保链中的每个文件都以下划线开头一样简单；有时很容易通过！

# c++ - 如何在并行区域之外保持变量的值？

> ID：16095390
> 
> 赞同：2
> 
> 时间：2013-04-19T00:37:14.213
> 
> 标签：c++, c, openmp

一个简单的 OpenMP 程序：

```
#include <omp.h>
#include <iostream>

int main() {
  int var = 0;
  int var2 = 0;
  #pragma omp parallel private(var) shared(var2)
  {
    var = 1;
    int tid = omp_get_thread_num();
    printf("Inside the parallel region, var gets modified by thread #%d to %d\n",tid,var);
    if(tid == 0)
      var2 = var;
  }
  printf("Outside the parallel region, var  = %d\n", var);
  printf("Outside the parallel region, var2 = %d\n", var2);
} 
```

结果：

```
Inside the parallel region, var gets modified by thread #3 to 1
Inside the parallel region, var gets modified by thread #0 to 1
Inside the parallel region, var gets modified by thread #6 to 1
Inside the parallel region, var gets modified by thread #1 to 1
Inside the parallel region, var gets modified by thread #5 to 1
Inside the parallel region, var gets modified by thread #7 to 1
Inside the parallel region, var gets modified by thread #2 to 1
Inside the parallel region, var gets modified by thread #4 to 1
Outside the parallel region, var  = 0
Outside the parallel region, var2 = 1 
```

我想要做的是将 的值设置为`var`并行区域内的最后修改值。

由于它不是`#pragma omp for`循环，`lastprivate`因此无法使用。

在并行区域之外，`var`获取其原始值 0。一个技巧是使用共享变量`var2`来存储来自主线程的修改值。

但这增加了开销并且似乎不是一种优雅的方法，如果我想获得由*最后一个*线程而不是主线程修改的值（例如找出哪个线程最后完成），那么这个技巧将不行。

我对 OpenMP 很陌生，所以我可能会遗漏一些东西。如果我不是，有没有办法克服这个棘手的事情？

非常感谢。

编辑：我的问题是关于如何在并行区域完成后保留私有变量的最后一个值。或者，如果您可以解释为什么`lastprivate`在概念上在 a 中使用无效`#pragma omp parallel`，我会认为这是一个完美的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-28T15:04:11.053

我认为该条款可能存在误解`lastprivate`。OpenMP 标准（4.0，第 2.14.3.5 节）说：

> [...]当**lastprivate**子句出现在标识工作共享结构的指令上时 [...]，每个新列表项的值都来自关联循环的顺序最后一次迭代，或词​​法上的最后一个**部分**结构，被分配到原始列表项。

在这里，术语“列表项”是指您在`lastprivate`子句中传递的变量。因此，在每种情况下，分配给原始变量（声明为`lastprivate`）的值或多或少都是确定的。在循环的情况下，分配给变量的值将与在相应顺序循环的最后一次迭代中分配的值相同。在节的情况下，它是最后一节中对变量的最后一次赋值。这也是你对串行程序的期望，所以我认为很容易看出改变这些语义没有意义。

另一方面，如果`lastprivate`允许在与工作共享（或 SIMD）构造不同的东西中使用，如您的示例所示，您将破坏这些语义。因为您无法提前知道哪个线程将首先完成，所以您最终会在每次执行中最有可能发生变化（如果您愿意，可以将其称为非确定性甚至未定义）。与上一段中所述的行为相反，这很可能不是您对串行程序的期望。我希望这能回答您关于缺乏`lastprivate`非工作共享结构的问题。

关于您的示例，我认为 OpenMP 中没有任何内置功能可以实现您想要实现的目标。但由于我对这个话题也很陌生，所以我不想最终确定这一点。

顺便说一句：你说

> 在平行区域之外，`var`得到它的原始值，0。

这可能是您的 OpenMP 实施的结果。`private`但一般来说，原始变量的值在具有该变量的子句的并行区域之后是未定义的。所以我不会认为这是理所当然的。

我希望这回答了你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:32:18.070

要找出最后完成的线程，请让每个线程将其完成时间写入数组。数组的大小至少应为 omp_get_max_threads()。使用并行区域内的 omp_get_thread_num() 对其进行索引。

一旦代码离开并行区域，找到数组中的最大值。

理想情况下，应该对齐和填充数组，以便每个元素位于单独的高速缓存行中，以便线程在写入其完成时间时不必绕过共享高速缓存行。

如果并行区域位于程序的外部级别，则还有另一种更微妙的方法可以做到这一点，即利用线程私有变量在*顶级*并行区域之间保留其值的事实。以下是如何利用此技巧的示例。

```
#include <omp.h>
#include <stdio.h>
#include <unistd.h>

double tmp;
#pragma omp threadprivate(tmp)

int main() {
    double start = omp_get_wtime();
#pragma omp parallel
    {
        sleep(1);
        tmp = omp_get_wtime();
    }
    double finish=start;
#pragma omp parallel reduction(max:finish)
    {
        if( tmp>finish ) finish = tmp;
    }
    printf("last thread took time = %g\n",finish-start);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-28T17:38:37.783

每个线程都有自己的私有变量。该`private`构造只是在这里引起混乱。如果您想要一组线程中的最后一个私有值，则只有为每个线程返回一个才有意义。你可以这样做：

```
int *vala;
int nthreads;
#pragma omp parallel
{
    nthreads = omp_get_num_threads();
    int ithread = omp_get_thread_num();
    #pragma omp single
    vala = new int[nthreads];
    //
    vala[ithread] = ithread;
}
//vala[] = 0,1,2,3,4,5,6,7,8
delete[] vala; 
```

但是，一般来说，自己分配内存是个坏主意。您应该让每个线程为其自己的私有变量分配内存。问题是上面的代码在缓存行左侧（64 字节）和页面级别（4096 字节）都有错误共享。解决此问题的一种方法是不在`vala`并行循环中写入，而是仅在每个线程中写入。例如

```
int *vala;
int nthreads;
#pragma omp parallel
{
    int nthreads = omp_get_num_threads();
    int ithread = omp_get_thread_num();
    #pragma omp single
    vala = new int[nthreads];
    int val = 0;
    #pragma omp for
    for(int i=0; i<n; i++) {
        val = i;    
    }
    vala[ithread] = val;
} 
```

这仍然有错误共享，但效果微不足道，因为它是按线程而不是按迭代完成的。

在去年使用 OpenMP 时，我想不出有一次我需要知道最后一个线程退出并行部分的时间。但是，顺序很重要。例如，当一个操作是关联的但不是可交换的（例如一系列矩阵乘法）。在这种情况下，您可以将数组填充为线程编号的函数，并依赖于具有静态调度的块按线程编号递增的顺序分配的事实[C++ OpenMP：Split for loop in even chunks static and join data at the end](https://stackoverflow.com/questions/18745091/c-openmp-split-for-loop-in-even-chunks-static-and-join-data-at-the-end/18748272#18748272)。

# c++ - 我是否误用了继承？

> ID：16095391
> 
> 赞同：2
> 
> 时间：2013-04-19T00:37:16.173
> 
> 标签：c++, inheritance, polymorphism, dynamic-cast

我正在尝试建立一个程序，该程序可以根据对许多交易的总和生成资产负债表，并以如下格式显示结果：

![资产负债表](https://i.stack.imgur.com/M3tbE.jpg) 这里的重要属性是顶级账户（如 Assets）被分解为子账户树，只有最低级账户（“叶子”）跟踪自己的余额（更高级别账户的余额为只是他们子账户余额的总和）。

我的首选方法是使用继承：

```
class Account{
   string name;
   virtual int getBalance() =0; //generic base class has no implementation
   virtual void addToBalance(int amount) =0;
};
class ParentAccount : public Account{
   vector<Account*> children;
   virtual int getBalance() {
      int result = 0;
      for (int i = 0; i < children.size(); i++)
          result += children[i]->getBalance();
      return result;
   }
   virtual void addToBalance(int amount) {
      cout << "Error: Cannot modify balance of a parent account" << endl;
      exit(1);
   }
};
class ChildAccount : public Account{
   int balance;
   virtual int getBalance() { return balance; }
   virtual void addToBalance(int amount) {balance += amount;}
}; 
```

这个想法是在编译时不知道存在哪些帐户，因此必须动态生成树帐户。继承在这里很有帮助，因为它可以很容易地生成任意深度的树结构（ParentAccounts 可以有作为 ParentAccounts 的子节点），并且因为它可以很容易地实现类似的函数`getBalance()`使用递归之类的功能。

当我尝试合并派生类独有的功能时，事情变得有点尴尬，例如修改余额（这应该只适用于`ChildAccount`对象，因为`ParentAccount`余额只是由其子类的余额定义）。我的计划是这样的函数`processTransaction(string accountName, int amount)`将通过树结构搜索以寻找具有正确名称的帐户，然后调用`addToBalance(amount)`该帐户（*下面的注释）。由于上面的树结构只允许我找到一个`Account*`，因此有必要`addToBalance(amount)`像我上面所做的那样为所有类实现，或者在调用之前`dynamic_cast`实现`Account*`to a 。第一个选项似乎稍微优雅一些​​，但事实上它需要我定义`ChildAccount*``addToBalance()``ParentAccount::addToBalance()`（尽管是一个错误）对我来说似乎有点奇怪。

我的问题是：这种尴尬是否有一个名称，以及解决它的标准方法，还是我完全误用了继承？

***注意：**我认识到可能有一种更有效的方法来组织帐户以进行搜索，但我的主要目标是创建一个易于解释和调试的程序。根据我目前的理解水平，这是以计算效率为代价的（至少在这种情况下）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T07:45:30.377

是的，你猜对了，这不是一个正确的继承案例。

```
virtual void addToBalance(int amount) {
   cout << "Error: Cannot modify balance of a parent account" << endl;
   exit(1);
} 
```

清楚地表明这`class ParentAccount : public Account`是错误的：ParentAccount 与 Account 没有 IS-A 关系。

有两种方法可以解决：一种是取消继承`ParentAccount`。但`getBalance()`一致性表明这可能是过度反应。所以你可以`addToBalance()`从`Account`（和`ParentAccount`）中排除，层次结构是正确的。

当然，这意味着您必须`ChildAccount`在调用 之前获取指针`addToBalance()`，但无论如何您都必须这样做。实用的解决方案有很多，例如，您可以简单地将两个向量 in `ParentAccount`，一个用于另一个 ParentAccounts，另一个用于 ChildAccounts，或者使用`dynamic_cast`，或者...（取决于您对帐户的其他操作）。

这种尴尬的名称是打破 LSP（Liskov 替换原则），或者更简单地说，打破 IS-A 关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:35:16.177

从概念上讲，您没有子帐户和父帐户，而是帐户和对象树，其中叶节点包含指向实际帐户的指针。

我建议你直接在代码中表示这个结构：

```
class Account
{
public:
    int getBalance(); 
    void addToBalance(int amount);
// privates and implementation not shown for brevity
};

class TreeNode
{
public:
    // contains account instance on leaf nodes, and nullptr otherwise.
    Account* getAccount(); 

    // tree node members for iteration over children, adding/removing children etc

private:
    Account* _account; 
    SomeContainer _children
}; 
```

如果你现在想遍历树来收集账户余额等，你可以直接在树结构上进行。这比通过父帐户路由更简单，更不容易混淆。此外，很明显，实际帐户和包含它们的树结构是不同的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T07:21:07.583

所以你有一棵树，它的节点有两种不同类型的节点，它们来自同一个基，你想对一种类型而不是另一种类型执行操作……这听起来像是访问者模式的工作。:)

访问者模式背后的想法是这样的：它为复杂结构（树、图）的元素提供了一种方法，可以根据它们的类型（仅在运行时知道）进行不同的操作，并且特定操作本身也可以仅在运行时才知道，而不必更改元素所属的整个层次结构（即避免您想到的 addToBalance 的“错误”函数实现之类的事情）。（^它与访问无关，所以它可能是错误的名称——它更多的是为不支持它的语言实现双重调度的一种方式。）

因此，您可以对元素执行一组操作，并且可以根据元素的类型对这些操作进行重载。一个简单的方法是为所有操作定义一个基类（我在下面将其称为访问者类）。它将包含的唯一内容是空函数 - 每种类型的元素都有一个可能执行操作的元素。这些函数将被特定操作覆盖。

```
class Visitor {

  virtual void Visit(ParentAccount*) { /* do nothing by default*/ }
  virtual void Visit(ChildAccount*) { /* do nothing by default */ }
}; 
```

`ChildAccount`现在我们创建一个特定的类来仅在s上执行 AddToBalance 。

```
class AddToBalance : public Visitor {

  public:
  AddBalance(string _nameOfTarget, int _balanceToAdd) :
    nameOfTarget(_nameOfTarget), balanceToAdd(_balanceToAdd) {}

  void Visit(ChildAccount* _child) { //overrides Visit only for ChildAccount nodes
    if(child->name == _name)
      child->addToBalance(_balance); //calls a function SPECIFIC TO THE CHILD
  }

  private:
    string nameOfTarget;
    int _balanceToAdd;
}; 
```

对原始 Account 类的一些更改。

```
class Account{
   vector<Account*> children; //assume ALL Account objects could have children; \
                              //for leaf nodes (ChildAccount), this vector will be empty
   string name;
   virtual int getBalance() =0; //generic base class has no implementation

   //no addToBalance function!

   virtual void Accept(Visitor* _visitor) {
     _visitor->Visit(this);
   }
}; 
```

请注意 Account 类中的 Accept() 函数，它只是将 Visitor* 作为参数并在 上调用该访问者的 Visit 函数`this`。**这就是魔法发生的地方。**至此，类型和`this`类型`_visitor`都会被解析。如果`this`是 ChildAccount 类型并且`_visitor`是 类型`AddToBalance`，那么`Visit`将被调用的函数`_visitor->Visit(this);`将是`void AddToBalance::Visit(ChildAccount* _child)`。

恰好调用`_child->addToBalance(...);`：

```
class ChildAccount : public Account{
   int balance;
   virtual int getBalance() { return balance; }
   virtual void addToBalance(int amount) {
     balance += amount;
   } 
}; 
```

如果`this`in`void Account::Accept()`是 a `ParentAccount`，则将调用空函数 `Visitor::Visit(ParentAccount*)`，因为该函数未被 in 覆盖`AddToBalance`。

现在，我们不再需要在 ParentAccount 中定义 addToBalance 函数：

```
class ParentAccount : public Account{
   virtual int getBalance() {
      int result = 0;
      for (int i = 0; i < children.size(); i++)
          result += children[i]->getBalance();
      return result;
   }
   //no addToBalance function
}; 
```

第二个最有趣的部分是：既然我们有一棵树，我们可以有一个定义访问序列的通用函数，它决定访问树的节点的顺序：

```
void VisitWithPreOrderTraversal(Account* _node, Visitor* _visitor) {
  _node->Accept(_visitor);
  for(size_t i = 0; i < _node->children.size(); ++i)
    _node->children[i]->Accept(_visitor);

}

int main() {
  ParentAccount* root = GetRootOfAccount(...);

  AddToBalance* atb = new AddToBalance("pensky_account", 500);
  VisitWithPreOrderTraversal(atb, root);

}; 
```

最有趣的部分是定义您自己的访问者，它执行更复杂的操作（例如，仅累积所有 ChildAccounts 的余额总和）：

```
class CalculateBalances : public Visitor {

  void Visit(ChildAccount* _child) {

    balanceSum += _child->getBalance();

  }
  int CumulativeSum() {return balanceSum; }
  int balanceSum;
} 
```

# winapi - WinApi 滚动条处理

> ID：16095394
> 
> 赞同：1
> 
> 时间：2013-04-19T00:37:25.267
> 
> 标签：winapi, scrollbar, handle

我想为我的项目创建一个漂亮的用户界面。我创建一个窗口，然后创建一个子窗口，它是界面功能的主窗口。所以...我有这两个窗口，在子窗口中我想添加一个滚动条。我创建了一个滚动条类：

```
class Scrollbar
{
public:
    HINSTANCE hInstance;
    HWND hwnd;
    SCROLLINFO si;
    Scrollbar(HWND Scroll_hwnd, HINSTANCE hInstance, HWND hwnd, SCROLLINFO si, RECT Child_rect, int iHThumb);
    SCROLLINFO Initialise(SCROLLINFO si, RECT rect);
    ~Scrollbar();
}; 
```

在构造函数中，我基本上有一个 CreateWindow 函数：

```
Scroll_hwnd = CreateWindow(
L"SCROLLBAR", 
(LPCWSTR)NULL,
 WS_CHILD | WS_VISIBLE | SBS_HORZ | SBS_BOTTOMALIGN,
 Child_rect.left,Child_rect.top,Child_rect.right-iHThumb,Child_rect.bottom,
 hwnd,
 NULL,
 hInstance,
 NULL);

SetScrollRange( Scroll_hwnd, SB_CTL, 0, 10, FALSE); 
```

所以创建了滚动，但现在我想以某种方式处理它，所以我在我的子窗口 CALLBACK func 中做这样的事情：

```
case WM_HSCROLL: 
    {

    GetScrollInfo( hwnd, SB_VERT, &si );

    int position = si.nPos;

    switch( LOWORD( wParam ) ) 
    {

    case SB_LINELEFT:
        if( position > 0 ) 
        {
            position--;
        }
        break;
    case SB_LINERIGHT:
        if( position < 10 ) 
        {
            position++;
        }
        break;
    ZeroMemory( & si, sizeof( si ) );
    si.cbSize = sizeof( SCROLLINFO );
    si.fMask = SIF_POS;
    si.nPos = position;

    SetScrollInfo( hwnd, SB_VERT, & si, TRUE );
} 
```

不知道，但在我看来，一切都很好......位置变量增加得很好，但滚动仍然处于起始位置。知道有什么问题吗？另外，当我尝试做这样的事情时：

```
Scrollbar *s1;
s1 = &scroll; 
```

(...)

```
GetScrollInfo( hwnd, SB_VERT, s1->si ); 
```

我收到一个转换错误（SCROLLINFO TO LPSCROLLINFO）

知道如何解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:30:16.570

您创建了一个水平滚动条，但您正在回调中获取/设置垂直滚动条值。更改`SB_VERT`为`SB_HORZ`。

至于编译器错误，您确实传递了`SCROLLINFO`a`SCROLLINFO*`预期的地方。

改变这个：

```
GetScrollInfo( hwnd, SB_VERT, s1->si ); 
```

对此：

```
GetScrollInfo( hwnd, SB_HORZ, &(s1->si) ); 
```

或这个：

```
GetScrollInfo( hwnd, SB_HORZ, &(scroll.si) ); 
```

# algorithm - 我们如何进行并行秩排序以在 O(1) 时间内运行任意数量的处理器

> ID：16095401
> 
> 赞同：0
> 
> 时间：2013-04-19T00:38:46.093
> 
> 标签：algorithm, sorting, parallel-processing

我知道并行秩排序的实现需要 O(log n) 时间和 O(n^2) 数量的处理器，如果我们使用并发写入，那么我们可以获得 O(1) 运行时间 O(n^2)处理器。有没有其他方法我们不使用并发读取并且运行时间为 O(1)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:18:52.873

基于比较的排序至少需要 O(n log n) 次比较。如果您不允许并发读取，那么在 O(1) 时间内对 n 个值进行排序，您最多可以读取（或操作）这些值 O(n) 次。所以我认为没有并发读取的 O(1) 并行排序必须非常奇特。事实上，考虑排序输出的任何单个值，例如第一个值，它可能是最低输入值。这取决于所有 n 个输入值。如果没有并发读取，我认为您可以将计算单个值的任何进程表示为在每个节点处具有有界度的树，并且在根处计算值。所花费的时间是树的深度，它必须至少为 O(log n)。

# python - 以独立于数据库的方式检查 Python DB 游标列类型

> ID：16095404
> 
> 赞同：3
> 
> 时间：2013-04-19T00:38:52.687
> 
> 标签：python, python-db-api

我必须将一些数据从各种数据库（目前是 Oracle 和 Postgre）转储到 CSV 文件中，同时保留列类型信息，以便可以将数据正确加载到另一个应用程序中。基本上，我需要编写一个函数，该函数可以以**独立于所使用的特定 DBAPI 模块的方式将列数据中的字符串/数字数据与游标对象区分开来。**

根据[DB-API v2 文档](http://www.python.org/dev/peps/pep-0249/#type-objects)，每个 DBAPI 模块必须定义类型对象（例如`module.STRING`），这些对象“必须比较等于”每列（例如`cursor.description[n][1]`，对于第 n 列）的游标对象中的类型对象。

*我遇到的问题是......如果我只能*访问游标对象，我怎么能找出适合这个比较的类型对象是什么？如何从游标对象中获取相应 DBAPI 模块的句柄。有什么意见或建议吗？

到目前为止，我一直在使用丑陋的 kludge：

```
def FigureOutDBTypes(cursor):
    if 'psycopg2' in str(type(cursor)):
        coltypes = [(str if x[1]==1043 else int) for x in cursor.description] 
    elif 'Oracle' in str(type(cursor)):
        typemap = dict(NUMBER = int,
                       DATE = int,
                       DATETIME = int,
                       TIMESTAMP = int,
                       STRING = str)
        coltypes = [typemap.get(x[1] and x[1].__name__, int) for x in cursor.description]
    else:
        raise RuntimeError("Don't know how to get type information from DB cursor.", cursor)
    return coltypes 
```

我想要一个更强大和优雅的解决方案。有什么意见或建议吗？

编辑：到目前为止我想出的最好的事情是使用以下几乎一样可怕的黑客来处理适当的模块：

```
mod = sys.modules[cur.connection.__class__.__module__] #FIXME!
coltypes = [(str if x[1]==mod.STRING else int) for x in cursor.description] 
```

# magento - Magento：在给定类别 ID 的情况下获取 N 个产品

> ID：16095405
> 
> 赞同：0
> 
> 时间：2013-04-19T00:38:55.953
> 
> 标签：magento

我正在使用以下代码加载所有具有给定类别 ID 的搜索视图的产品：

```
 $productCollection = Mage::getModel('catalog/category')->load($categoryId)
        ->getProductCollection() 
        ->addAttributeToSelect('*')
        ->addAttributeToFilter('visibility', 3); 
```

这是否可以在拨打此电话时获取某个数字（N）？现在，我加载所有内容`$categoryId`并获取我需要的内容，但如果我可以从一开始就加载所需数量的产品，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:45:28.527

你可以这样使用`->setPageSize();`：

```
$productCollection = Mage::getModel('catalog/category')->load($categoryId)
    ->getProductCollection() 
    ->addAttributeToSelect('*')
    ->addAttributeToFilter('visibility', 3)
    ->setPageSize(10);  // load 10 products 
```

# ember.js - 在 Ember.js 中动态设置元素 id

> ID：16095406
> 
> 赞同：1
> 
> 时间：2013-04-19T00:39:07.883
> 
> 标签：ember.js, ember-data

我有一个从 FIXTURES 数据存储加载的项目列表：

```
App.ItemsController = Ember.ArrayController.extend({
    content: function() {
        return App.Item.find();
    }.property('content')
});

App.Item = DS.Model.extend({
    name: DS.attr('string')
});

App.Item.FIXTURES = [
    {id: 1,  name: 'Item 1'},
    {id: 2,  name: 'Item 2'},
    {id: 3,  name: 'Item 3'},
    {id: 4,  name: 'Item 4'},
    {id: 5,  name: 'Item 5'},
    {id: 6,  name: 'Item 6'},
    {id: 7,  name: 'Item 7'},
    {id: 8,  name: 'Item 8'},
    {id: 9,  name: 'Item 9'},
    {id: 10, name: 'Item 10'}
]; 
```

我有一个简单的模板

```
<script type="text/x-handlebars" data-template-name="items">
    <ul>
    {{#each item in content}}
        <li {{bindAttr id="elementId"}} > {{item.name}}</li>
    {{/each}}
    </ul>
</script> 
```

我`{{render 'items'}}`用来显示的（出于各种项目特定的原因）。

我遇到的问题是我想动态地将每个 li 的 id 设置为“item- `id`”，`id`模型中的项目 id 是哪里。我已经尝试了所有我能想到的计算属性组合来设置 elementId，但我无法让它工作。

有没有办法做到这一点？任何帮助将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T02:23:12.720

您可以在模型中设置计算属性，然后在`bindAttr`帮助程序中使用它。

```
App.Item = DS.Model.extend({
  name: DS.attr('string'),
  elementId: function() {
    return "item-" + this.get('id');
  }.property('id')
}); 
```

车把：

```
<script type="text/x-handlebars" data-template-name="items">
    <ul>
    {{#each item in content}}
        <li {{bindAttr id="item.elementId"}} > {{item.name}}</li>
    {{/each}}
    </ul>
</script> 
```

[JSBin 示例](http://jsbin.com/ihotef/1/edit)

# excel - 使用一次查找生成多个值

> ID：16095408
> 
> 赞同：1
> 
> 时间：2013-04-19T00:39:16.633
> 
> 标签：excel

我有一个数组，里面有多个产品的产品订单。

```
Order #    Product
N-122      C135
N-122      P223
N-122      C134
N-134      P223 
```

我已经看到其他线程将产品合并到具有相同顺序的一行中。
[Excel 宏 - 行到逗号分隔的单元格（保留/聚合列）](https://stackoverflow.com/questions/5502248/excel-macro-rows-to-comma-separated-cells-preserve-aggregate-column)

有没有办法在不将产品合并到一行的情况下查找我的订单值？

我想在另一个工作表中创建一个表格，一旦输入订单编号，它将在多行上显示与其关联的所有产品。

```
Order #     Product
N-122       C135
            P223
            C134 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:55:21.780

正如安德烈所提到的，您可以使用数据透视表，但如果您仍然想做一个公式，那么您可以这样做

`=IFERROR(INDEX($A$2:$B$5,SMALL(IF($A$2:$A$5=$D$1,ROW($A$2:$A$5)-1),ROW(A1)),2),"")`

请注意，这是一个数组公式，您必须按`CTRL`+ `SHIFT`+`ENTER`

看这个截图

![在此处输入图像描述](https://i.stack.imgur.com/VHlgv.png)

在 中输入公式后`E1`，只需将其向下拖动即可查找匹配项。

# biopython - 如何从 Biopython 运行 codeml (aaml)？

> ID：16095410
> 
> 赞同：0
> 
> 时间：2013-04-19T00:39:24.650
> 
> 标签：biopython

我正在尝试使用 BioPython 中 codeml 的 aaml 部分在系统发育树中找到一堆氨基酸序列的 dN/ds 值。不幸的是，运行它时出现错误（结果文件为空）。

```
from Bio.Phylo.PAML import codeml
cml = codeml.Codeml(alignment = "family.phy", tree = "family.phy_phyml_tree.txt", out_file = "results.out")
cml.read_ctl_file("aaml.ctl")
cml.alignment = "family.phy"
cml.tree = "family.phy_phyml_tree.txt"
cml.out_file = "results.out"
results=cml.run() 
```

我得到的错误是

```
Traceback (most recent call last):
File "<pyshell#57>", line 1, in <module>
cml.run()
File "C:\Python33\lib\site-packages\Bio\Phylo\PAML\codeml.py", line 189, in run
results = read(self.out_file)
File "C:\Python33\lib\site-packages\Bio\Phylo\PAML\codeml.py", line 210, in read
raise ValueError("Invalid results file")
ValueError: Invalid results file 
```

有没有人得到这个为他们工作？

# actionscript-3 - 如何设置动态文本的z坐标actionScript 3

> ID：16095411
> 
> 赞同：1
> 
> 时间：2013-04-19T00:39:26.227
> 
> 标签：actionscript-3, dynamic, text, actionscript, coordinate

我试图弄清楚如何设置动态文本的 z 坐标。x 和 y 是可能的。例如，我有一个实例名称为 greetMe 的动态文本。我可以设置它的 y 和 x 位置

```
greetMe.y = 100;
greetMe.x = 200; 
```

虽然我尝试时没有错误

```
greetMe.z = -100 
```

，它仍然无法正常工作。我试图查看转换按钮，但菜单已锁定或无法点击。有没有办法设置动态文本的 z 坐标？

我只是想先隐藏我的动态对象，然后当用户单击按钮时，它会显示出来。

* * *

感谢甜蜜。最好的办法是将其可见性设置为 false，然后当单击按钮时，它将通过可见性显示为 true。

```
greetMe.visible = false; 
```

然后...使其可见...

```
greetMe.visible = true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:45:48.670

听起来您想要做的就是`textField`最初隐藏并稍后显示它。如果是这种情况，您可以简单地设置字段的`visible`属性。

```
// Hide the field initially
greetMe.visible = false;  

// And show it when required
greetMe.visible = true; 
```

如果需要将`textfield`按钮放在后面，可以使用 的`swapChildren`方法`DisplayList`。从[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html#swapChildren)）：

> 交换两个指定子对象的 z 顺序（从前到后的顺序）。显示对象容器中的所有其他子对象保持在相同的索引位置。

`swapChildren(greetMe, myButton);`

或者您可以使用`setChildIndex`来确保 textField 位于`displayList`类似的底部（[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html#setChildIndex)）：

```
setChildIndex(greetMe, 0); 
```

# java - 估算天气数据项目

> ID：16095419
> 
> 赞同：0
> 
> 时间：2013-04-19T00:40:17.550
> 
> 标签：java

我不断收到消息

> 线程“main”中的异常 java.lang.NoSuchMethodError: WeatherInput: method ()V not found

在我正在从事的这个项目的客户课程中，我不知道为什么，我想知道这里是否有人能看到我缺少的东西？

这是我的服务类：

```
class WeatherInput
{

 private static final String NEWLINE = "\n";
 private double temp;
 private double tempAverage;
 private double tempHigh;
 private double tempLow;
 private double tempHundred;
 public  String newCity = new String();
 public  String city = new String();

public WeatherInput( String city) {
 temp = 0;
 tempAverage = 0;
 tempHigh = 0;
 tempLow = 0;
 tempHundred = 0;
 newCity = city;
}

public void setTemp( double temprature)
{  
    temp = temp;
    } 

        public void tempCalc(String city)
        {
            while(!city.equals("*"))
            {   

            city = newCity;
        }
                while(temp != 0)
                {

                tempAverage = (temp + temp)/2;

                if(tempHigh > temp)

                tempHigh = temp;

                if(tempLow < temp)

                tempLow = temp;

            if(temp > 100)

                tempHundred = temp;

                temp++;
                }
            System.out.print(tempAverage);
            }

        public String printString(){
        return NEWLINE + "Statistics for: " + newCity + "Average: " + tempAverage + "High: " + tempHigh + "Low: " + "Over 100: "
        + tempHundred + NEWLINE;
        }
    } 
```

这是我的客户：

```
import java.util.*;       //For Scanner and class                    
//----------------------------------------------------------------------------------
//Class Name:  KosmowsiProg2
//Description: This class has one method, the main method
//----------------------------------------------------------------------------------
public class KosmowskiProg2
{
    //-------------------------------------------------------------------------------
    //Method Name: main

//-------------------------------------------------------------------------------
public static void main(String[] args)
{
    //-----------------------Local Constants--------------------------------------

    //-----------------------Local Variables--------------------------------------
        double  newTemp;

    //-----------------------Objects----------------------------------------------
        Scanner scanner = new Scanner(System.in);
        String city = new String();
        String inputCity = new String();
        WeatherInput input = new WeatherInput();
        WeatherInput input2 = new WeatherInput();

    //---------------------Method Body--------------------------------------------

    System.out.print("Please enter the names of the cities, ending in a *");
    inputCity = scanner.next();
    System.out.print("Please enter the tempratures, ending in a 0");
    newTemp = scanner.nextDouble();

       input.setTemp(newTemp);
        input.tempCalc(inputCity);  

}//End main method

private static void printResults(WeatherInput in){

System.out.print(in.printString()); 
}
}//End class KosmowskiProg2 
```

我正在创建一个服务类，然后我可以将其传递给客户端类，该类将读取以“*”结尾的城市列表，然后为每个城市读取以“0”结尾的温度列表。然后它必须计算平均温度，最高和最低，然后将它们与任何超过 100 的温度一起输出。我和我的教授谈过，她告诉我解决方案是一个嵌套的 while 循环，并且提示最终程序应该在一个单独的客户端类中。我还需要输出每个类别的总数。问题是，我在试图弄清楚如何使用我在客户端中创建的这个服务类来获取我需要的数据时遇到了很多麻烦。我的教授似乎无法以我能理解的方式解释它，所以我希望能得到一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:46:14.160

如果你的服务类在不同的文件中，你需要确保它被声明为公共的。

```
public class WeatherInput
{ 
    ... etc 
} 
```

如果不这样做，您可能无法访问其他文件中的构造函数。

编辑：哦，我刚刚注意到，您没有默认构造函数（没有参数的构造函数），这就是它引发 NoSuchMethodError 异常的原因。您唯一的构造函数需要一个城市名称：

```
public WeatherInput(String city) {
    ... etc
} 
```

获得城市名称后，您需要声明您的课程：

```
// WeatherInput input = new WeatherInput();
// WeatherInput input2 = new WeatherInput();

//---------------------Method Body--------------------------------------------

System.out.print("Please enter the names of the cities, ending in a *");
inputCity = scanner.next();
System.out.print("Please enter the tempratures, ending in a 0");
newTemp = scanner.nextDouble();

WeatherInput input = new WeatherInput(inputCity);

input.setTemp(newTemp);
input.tempCalc(inputCity); 
```

或者创建一个不带任何参数的构造函数：

```
public WeatherInput() {
   temp = 0;
   tempAverage = 0;
   tempHigh = 0;
   tempLow = 0;
   tempHundred = 0;
   newCity = null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:47:37.837

`WeatherInput`需要 a`String`作为其构造函数的一部分...

```
public WeatherInput( String city) 
```

但你正试图在没有任何...

```
WeatherInput input = new WeatherInput(); // This is bad, must have a String value... 
```

# java - 互联网上的 Java 套接字

> ID：16095420
> 
> 赞同：1
> 
> 时间：2013-04-19T00:40:20.550
> 
> 标签：java, sockets, networking, router

我已经使用 java 套接字编写了一个客户端和服务器。两台机器在同一个网络上。当我使用本地 IP 地址连接时，没有问题。但是，如果我使用公共 IP 地址，则连接超时，客户端抛出“SocketException：连接重置”，服务器抛出“SocketException：对等方重置连接：套接字写入错误”。大多数情况下都会发生这种情况，但一旦出现蓝月亮，连接实际上就会成功。我可以从客户端机器上成功地 ping 服务器本地地址和路由器。

我进入了我的路由器，为服务器机器分配了一个永久 IP 地址，并将相关端口上的所有流量转发到该 IP 地址。不幸的是，这是我认为可以解决问题的唯一方法，但事实并非如此。我也关闭了服务器上的windows防火墙，仍然没有运气。

客户：（IP取自whatismyip.com）

```
Socket s = new Socket("xx.xxx.xxx.xx", 27499); 
```

连接。

服务器：

```
InetAddress ip = InetAddress.getLocalHost();
ServerSocket ss = new ServerSocket(27499, 0, ip);
Socket cs = ss.accept(); 
```

任何帮助，将不胜感激。如有必要，我可以提供更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:48:19.797

“SocketException：对等方重置连接：套接字写入错误”

这意味着服务器实际上正在拒绝连接，可能是防火墙问题，服务器拒绝连接，服务器实际上已关闭或过载。

# objective-c - 如何比较和合并 NSMutableArray

> ID：16095424
> 
> 赞同：0
> 
> 时间：2013-04-19T00:40:44.103
> 
> 标签：objective-c, cocoa, nsmutablearray

我有 2 个 NSMutableArrays，其中包含 Person 类的一个实例。我需要检查两个数组中是否有任何“名称”值相同的人，并将其合并并询问替换具有相同值“名称”的 Reson 实例。

看起来像：

```
empl1 = [
    Person [
        name = @"Paul",
        age = 45,
    ],
    Person [
        name = @"John",
        age = 36,
    ]
]

empl2 = [
    Person [
        name = @"Paul",
        age = 47,
    ],
    Person [
        name = @"Sean",
        age = 30,
    ]
] 
```

然后程序询问将 empl1 中的 Person @"Paul" 替换为 empl2 中的 Person @"Paul" 并将任何新人员从 empl2 添加到 empl2

结果必须是（如果我们替换 Paul）：

```
empl = [
    Person [
        name = @"Paul",
        age = 47,
    ],
    Person [
        name = @"John",
        age = 36,
    ],
    Person [
        name = @"Sean",
        age = 30,
    ]
] 
```

想想这两天，但没有成功。请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:38:27.383

您可以在 Person 上实现`-isEqual:`and`hash`并将所有对象放在一个 Set 中。

```
@interface Person : NSObject
@property(copy) NSString *name;
@property NSUInteger age;
@end

@implementation Person

-(BOOL)isEqual:(id)otherPerson
{
    if([otherPerson isKindOfClass:[self class]])
        return [self.name isEqual:otherPerson.name];
    return false;
}

-(NSUInteger)hash
{
    return [self.name hash];
}
@end 
```

如果您现在将其放入 NSSet 或 NSOrderedSet 中，则只会保留第一个具有相同名称的对象。另一个将被检测为重复并且不存储在集合中。

更多信息：[集合编程主题](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/Collections/Articles/Sets.html#//apple_ref/doc/uid/20000136-SW3)

* * *

```
#import <Foundation/Foundation.h>
@interface Person : NSObject
@property(copy) NSString *name;
@property NSUInteger age;

-(id)initWithName:(NSString *)name age:(NSUInteger)age;

@end

@implementation Person

-(id)initWithName:(NSString *)name age:(NSUInteger)age
{
    if(self = [super init])
    {
        _name = name;
        _age = age;
    }
    return self;
}

-(BOOL)isEqual:(id)otherPerson
{
    if([otherPerson isKindOfClass:[self class]]){
        Person *rhsPerson = otherPerson;
        return [self.name isEqualToString:rhsPerson.name];
    }
    return false;
}

-(NSUInteger)hash
{
    return [self.name hash];
}

-(NSString *)description
{
    return [NSString stringWithFormat:@"%@  %lu", self.name, self.age];
}
@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {
        NSArray *p1Array = @[[[Person alloc] initWithName:@"Paul" age:45] ,
                             [[Person alloc] initWithName:@"John" age:36]];
        NSArray *p2Array = @[[[Person alloc] initWithName:@"Paul" age:47] ,
                             [[Person alloc] initWithName:@"Sean" age:30]];

        NSMutableSet *resultSet = [[NSMutableSet alloc] initWithArray:p1Array];
        NSMutableSet *duplicates = [[NSMutableSet alloc] initWithArray:p2Array];
        [duplicates intersectSet:resultSet];
        [resultSet addObjectsFromArray:p2Array];

        if ([duplicates count]) {
            for (Person *p in [duplicates allObjects]) {

                NSMutableSet *interSet = [resultSet mutableCopy];
                [interSet intersectSet:[NSSet setWithObject:p]];
                Person *pInSet = [interSet allObjects][0];

                NSLog(@"%@ <-> %@", p, pInSet);
                /*
                 Here you have the pairs of duplicated objects.
                 depending on your further requierements, stror them somewhere 
                 and process it further after asking the user.
                 */
            }
        }

    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T10:12:34.363

你绝对应该使用 NSSet。

这是一个例子：

```
NSMutableArray *temp1 = @[@1, @2, @3];
NSMutableArray *temp2 = @[@4, @1, @5];

NSMutableSet *set1 = [NSMutableSet setWithArray:temp1];
NSMutableSet *set2 = [NSMutableSet setWithArray:temp2];

[set1 unionSet:set2]; 
```

[这是文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSSet_Class/Reference/Reference.html)。 [这是 NSSet 可变版本的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableSet_Class/Reference/NSMutableSet.html)。

# c# - 让 Wide Tiles 在 WP7.8 上运行的步骤是什么？

> ID：16095428
> 
> 赞同：0
> 
> 时间：2013-04-19T00:41:33.487
> 
> 标签：c#, live-tile, windows-phone-7.8

到目前为止，我正在尝试让 Application (default tile) 宽图块在 7.8 模拟器中工作
- 我已遵循本文[将宽图块添加到 WP7.8](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj720574%28v=vs.105%29.aspx)中的建议。
- 我在应用程序清单中添加了额外的元素
- 我可以看到我的反射代码正确执行以更新动态磁贴。- 这是在 7.8 模拟器上

但是，当我尝试将磁贴调整为宽尺寸时，我只能在模拟器 UI 中获得中小型选项。
有什么我错过的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T05:45:40.930

我之前尝试过这段代码，它在模拟器上运行良好。确保在调用 UpdateTileData 时添加了所有这三个参数 WideBackgroundImage、WideBackgroundImage 和 WideBackContent。检查图像路径是否正确，并将图像添加到您的项目中，并将构建操作作为内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:13:30.397

远程平铺图像是问题所在。我已经解决了这个问题，如下所示

1.  在第一次应用启动时，将磁贴设置为占位符本地图像（在设置中设置一个标志以指示磁贴已设置）
2.  在此之后像往常一样将应用程序磁贴设置为远程图像

这似乎工作正常，我发现它在我昨晚第 10 次阅读的文档页面之一中提到。

# matlab - 如何在matlab中获得相关系数

> ID：16095429
> 
> 赞同：2
> 
> 时间：2013-04-19T00:41:37.623
> 
> 标签：matlab, math, encryption, correlation

在我读到的每篇关于加密的论文中，他们喜欢通过显示 3 个值来显示加密图像的相关系数：水平相关系数。垂直相关系数。对角线相关系数。并且它们显示了加密图像和普通图像（lena）的这 3 个值。我的问题是如何在 matlab 中做到这一点？如果没有 matlab 函数，他们用来获得这 3 个值的方程是什么？

表2 两幅图像中两个相邻像素的相关系数示例：

```
 Plain-image        Ciphered image
Horizontal 0.92401               0.01589
Vertical   0.95612                 0.06538
Diagonal   0.92659                 0.03231 
```

任何线索都会有所帮助，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:53:11.450

如果我理解正确，您想对某个给定图像中的像素对执行相关分析。

原则上我会选择这个`cov`函数：在你的具体情况下，`cov`将检索一个`[2*2]`对称矩阵。对角线元素将代表您的**水平**和**垂直**相关系数，而下（上）三角形元素将保留**对角线**相关系数。

我希望这能帮到您。

# dojo - Dojo 自定义语言变体

> ID：16095430
> 
> 赞同：1
> 
> 时间：2013-04-19T00:41:40.100
> 
> 标签：dojo, internationalization

Dojo 是否支持创建用于 Dojo 的语言环境和 i18n 的自定义语言变体

有谁知道我是否能够为 Dojo 的语言环境创建与 i18n 一起使用的自定义语言变体？

```
Example

define({
   root: {
     greeting: "Hello, world!"
   }
  "de-myVariant" : true
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:03:29.303

是的，这是可以做到的。如果您有`nls/SampleApp.js`：

```
define({
   root: {
     greeting: "Hello!"
   }
  "de" : true,
  "de-at": true,
  "de-x-mundl": true
}); 
```

那么下面会有三个子目录`nls`：

```
nls/de
nls/de-at
nls/de-x-mundl 
```

对于`nls/de/SampleApp.js`：

```
define(({
    greeting: "Hallo!"
})); 
```

对于`nls/de-at/SampleApp.js`：

```
define(({
    greeting: "Gruß Gott!"
})); 
```

和`nls/de-x-mundl/SampleApp.js`：

```
define(({
    greeting: "Servus, Mundi!"
})); 
```

然后，如果您配置 Dojo 以将语言环境作为 URL 参数获取：

```
<script src="./dojo/1.8.3/dojo/dojo.js" 
        data-dojo-config="locale: location.search.substring(1).toLowerCase()">
</script> 
```

您可以通过将语言环境标记作为该参数传递来轻松切换语言：

```
 .../app.html?de-DE
   .../app.html?de-at
   .../app.html?de-x-Mundl 
```

请注意，Dojo 认为语言环境标签区分大小写，这就是为什么输入是`toLowerCase()`ed 并且在内部所有标签都保持小写。

# c# - ASP.NET - 未找到程序集

> ID：16095432
> 
> 赞同：1
> 
> 时间：2013-04-19T00:42:10.680
> 
> 标签：c#, asp.net, assemblies

我有一个在 IIS7 上运行的 ASP.NET 项目。我只是添加了 Microsoft.Practices.EnterpriseLibrary.Common.dll、Microsoft.Practices.EnterpriseLibrary.Data.dll 和 Microsoft.Practices.EnterpriseLibrary.ObjectBuilder2.dll。

我收到此错误：

```
Error   2   Could not load file or assembly 'Microsoft_Practices_EnterpriseLibrary_Common' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

我研究了这个问题，发现这意味着 dll 不在正确的位置，但它在我的 projectdirectory/bin 文件夹中。所以我不明白应该在哪里引用它。我的 Web.config 中没有引用它，但项目模板中没有生成程序集标记。

我需要引用这些程序集吗？如果是这样，我在哪里可以找到必要的属性，即 PublicToken 等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:47:18.840

如果它是一个“网站”项目，您可以将 dll 放入 bin 文件夹中。但是，如果它是“Web 应用程序”项目，则需要添加引用并设置 copy local=true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:45:50.517

有时，其他工具/框架也会出现此问题。无需拉扯头发，只需添加对缺失程序集的引用并确保将这些引用设置为“复制本地”= true。我注意到放置在 GAC 中的框架 API 往往会出现这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T16:01:04.683

我已经纠正了这个问题。我不知道为什么，但我不得不在我的项目中创建一个新文件夹并将 dll 移到那里，我能够构建解决方案。这是一个网站项目。

# css - 为什么绝对定位的表格不根据其顶部/左侧/右侧/底部值计算宽度/高度？

> ID：16095434
> 
> 赞同：7
> 
> 时间：2013-04-19T00:42:18.767
> 
> 标签：css

`<div>`我有一个相对定位并具有定义尺寸的外部。在其中，我有一个`<table>`绝对定位的对象，带有`top`, `left`,`right`并`bottom`设置为零。我希望表格能够扩展以遵守顶部/左侧/右侧/底部约束，但是，这不是发生的情况。相反，表格尺寸是根据其内容计算的。

如果我使用 inner`<div>`而不是 a `<table>`，那么它会按预期工作。另一方面，如果我放在`display: table;`inner `<div>`，那么它的行为就像一张桌子。

我的问题是：**为什么会这样？**此行为在规范中的何处定义？或者它是浏览器中的错误（非常不可能）？

我检查了[CSS 2.1 规范](http://www.w3.org/TR/CSS21/)，阅读了第[9.7 节“显示”、“位置”和“浮动”之间的关系](http://www.w3.org/TR/CSS21/visuren.html#dis-pos-flo)、[10.3.7 绝对定位、不可替换元素](http://www.w3.org/TR/CSS21/visudet.html#abs-non-replaced-width)、[17 个表格](http://www.w3.org/TR/CSS21/tables.html)。我还检查了[Mozilla Developer Network 中的 position CSS 属性](https://developer.mozilla.org/en-US/docs/CSS/position)。我也在 StackOverflow 中搜索过。而且，我仍然找不到表为什么会这样的解释。

查看现场演示： http: [//jsfiddle.net/LgCDE/2/](http://jsfiddle.net/LgCDE/2/) 我可以在 Chrome 27 和 Firefox 20.0 上重现结果。

HTML：

```
<div class="box">
    <table class="table">
        <tr>
            <td>Hey!</td>
        </tr>
    </table>
</div>
<div class="box">
    <div class="table">Hey!</div>
</div>
<div class="box">
    <div class="table" style="display: table;">Hey!</div>
</div> 
```

CSS：

```
div.box {
    position:relative;
    border: 2px dashed red;
    background: #800;
    width: 100px;
    height: 50px;
}

.table {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: auto;
    height: auto;
    margin: 0;
    border: 3px double blue;
    background: #CCF;
    table-layout: fixed;
    border-collapse: collapse;
} 
```

![显示了三个块，最上面是一个表格元素，中间是一个 div 元素，最下面是一个带有 display: table 的 div 元素。](https://i.stack.imgur.com/695Pr.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T01:01:51.873

我相信答案在于 CSS2.1 规范，特别是[第 17.5.2 节：表格宽度算法：'table-layout' 属性](http://www.w3.org/TR/CSS2/tables.html#width-layout)（强调我的）：

> 请注意，本节覆盖适用于计算宽度的规则，如第 10.3 节所述。特别是，**如果表格的边距设置为“0”且宽度设置为“自动”，表格将不会自动调整大小以填充其包含块**。但是，一旦找到表格的“宽度”计算值（使用下面给出的算法，或者在适当的时候，使用其他一些 UA 相关算法），那么第 10.3 节的其他部分就适用。因此，例如，可以使用左右“自动”边距使表格居中。

如您所述，`width`设置为`auto`时，宽度将基于内容，而不是包含块。

该部分的末尾还有这一行，尽管我猜它还没有发生：

> CSS 的未来更新可能会引入使表格自动适应其包含块的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:00:52.370

我找不到任何技术原因，但我认为当您考虑桌子应该是什么时，这是有道理的。div 的默认显示是块，一块内容。因此，它默认为 100% 的宽度。表格只是扩展到您的内容。

在您的示例中，如果您将 .table 设置为 100% 的宽度，它的行为将相同。

# regex - 正则表达式，搜索和替换直到某一点

> ID：16095437
> 
> 赞同：4
> 
> 时间：2013-04-19T00:42:52.287
> 
> 标签：regex, perl, lookbehind

# 问题

我有一个文件充满了像

```
convert.these.dots.to.forward.slashes/but.leave.these.alone/i.mean.it 
```

我想搜索和替换这样我得到

```
convert/these/dots/to/forward/slashes/but.leave.these.alone/i.mean.it 
```

这 。转换为 / 直到第一个正斜杠

# 问题

如何编写正则表达式搜索和替换来解决我的问题？

## 尝试的解决方案

我尝试在 perl 中使用look behind，但是没有实现可变长度的look behinds

```
$ echo "convert.these.dots.to.forward.slashes/but.leave.these.alone/i.mean.it" | perl -pe 's/(?<=[^\/]*)\./\//g'
Variable length lookbehind not implemented in regex m/(?<=[^/]*)\./ at -e line 1. 
```

## 解决方法

实现了可变长度前瞻，因此您可以使用这个肮脏的技巧

```
$ echo "convert.these.dots.to.forward.slashes/but.leave.these.alone/i.mean.it" | rev | perl -pe 's/\.(?=[^\/]*$)/\//g' | rev
convert/these/dots/to/forward/slashes/but.leave.these.alone/i.mean.it 
```

这个问题有更直接的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T00:58:27.697

```
s/\G([^\/.]*)\./\1\//g 
```

`\G`是一个与前一个匹配结束时的点匹配的断言。这确保了每个连续的匹配紧跟最后一个。

火柴：

```
\G          # start matching where the last match ended
([^\/.]*)   # capture until you encounter a "/" or a "."
\.          # the dot 
```

替换为：

```
\1     # that interstitial text you captured
\/     # a slash 
```

用法：

```
echo "convert.these.dots.to.forward.slashes/but.leave.these.alone/i.mean.it" | perl -pe 's/\G([^\/.]*)\./\1\//g'

# yields: convert/these/dots/to/forward/slashes/but.leave.these.alone/i.mean.it 
```

* * *

或者，如果你是一个纯粹主义者并且不想重新添加捕获的子模式——避免这样做可能更有效，但我不确定——你可以使用`\K`将“真实”匹配限制为仅`.`, 然后简单地替换为`/`. `\K`本质上“忘记”了到目前为止匹配的内容，因此最终返回的最终匹配只是`\K`.

```
s/\G[^\/.]*\K\./\//g 
```

火柴：

```
\G        # start matching where the last match ended
[^\/.]*   # consume chars until you encounter a "/" or a "."
\K        # "forget" what has been consumed so far
\.        # the dot 
```

因此，匹配替换的整个文本只是“ `.`”。

替换为：

```
\/      # a slash 
```

结果是一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T01:02:51.693

您可以将`substr`其用作左值并对其执行替换。或音译，就像我在下面所做的那样。

```
$ perl -pe 'substr($_,0,index($_,"/")) =~ tr#.#/#'
convert.these.dots.to.forward.slashes/but.leave.these.alone/i.mean.it
convert/these/dots/to/forward/slashes/but.leave.these.alone/i.mean.it 
```

这会找到斜杠的第一个实例，提取它之前的字符串部分，并对该部分执行音译。

# java - 内存不足错误：内存可用时的 Java 堆大小

> ID：16095439
> 
> 赞同：10
> 
> 时间：2013-04-19T00:43:01.497
> 
> 标签：java, memory

我正在运行java`java -Xmx240g mypackage.myClass`

操作系统是 Ubuntu 12.10。

`top`说`MiB Mem 245743 total`，并表明 java 进程`virt 254g`从一开始就有，并且`res`正在稳步增长到`169g`. 那时它看起来好像开始了很多垃圾收集，我认为是因为该程序当时是单线程的，并且`CPU%`大部分`100%`时间都到了这一点，并且此时它在 1300-2000 左右跳跃（我的结论是多线程垃圾收集器），然后`res`慢慢移动到`172g`. 那时java崩溃了

`Exception in thread "main" java.lang.OutOfMemoryError: Java heap space`

在与`new double[2000][5]`

`java -version`说

`java version "1.7.0_15" OpenJDK Runtime Environment (IcedTea7 2.3.7) (7u15-2.3.7-0ubuntu1~12.10) OpenJDK 64-Bit Server VM (build 23.7-b01, mixed mode)`

硬件是 Amazon cr1.8xlarge 实例

在我看来，即使有大量可用内存，java 也会崩溃。这显然是不可能的，我必须把一些数字解释错。我应该在哪里查看以了解发生了什么？

编辑：

我没有指定任何 GC 选项。唯一的命令行选项是`-Xmx240g`

我的程序成功地处理了许多输入，并且`top`有时说它使用了高达 98.3% 的内存。但是，我通过某些程序输入重现了上述情况。

编辑2：

这是科学应用。它有巨大的树（1-10 百万个节点），在每个节点中有几个`double`大小约为的数组。300x3 - 900x5。初始树创建程序后不会分配太多内存。大多数时候，这些数组都会进行一些算术运算。

编辑3：

HotSpot JVM 以同样的方式死机，在 170-172g 标记处大量使用 CPU，并因同样的错误而崩溃。看起来 70-75% 的内存是 JVM 不想跨越的一条神奇线。

最终解决方案：使用 -XX:+UseConcMarkSweepGC -XX:NewRatio=12 程序通过了 170g 标记并且很高兴地进一步工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T01:38:03.627

## 分析

您需要做的第一件事是获取堆转储，这样您就可以准确地确定 JVM 崩溃时堆的样子。将这组标志添加到命令行：

```
-XX:+HeapDumpOnOutOfMemoryError -verbose:gc -XX:+PrintGCDetails 
```

当发生崩溃时，JVM 会将堆写入磁盘。坦率地说，在这么大的堆上需要很长时间。如果您已经在运行 Eclipse，请下载[Eclipse MAT或安装插件。](http://www.eclipse.org/mat/)从那里，您可以加载堆转储并运行几个罐头报告。您需要检查 Leak Suspects 和 Dominator Tree 以查看内存的去向并确定您没有实际的泄漏。

之后，我建议您[阅读](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)Oracle 的有关垃圾收集的文档，但是您可以考虑以下几点：

## 并发 GC

```
-XX:+UseConcMarkSweepGC 
```

我从未听说有人在这么大的堆上使用仅并行收集器而侥幸。您可以激活并发收集器，并且您需要阅读增量模式并确定它是否适合您的工作负载/硬件组合。

## 无堆比

```
-XX:MinHeapFreeRatio=25 
```

当您进行完整收集时，将其调低以降低垃圾收集器的标准。这可能会阻止您在执行完整收集时耗尽内存。40% 是默认值，尝试使用较小的值。

## 新比率

```
-XX:NewRatio 
```

我们需要更多地了解您的实际工作量：这是一个 web 应用程序吗？一个摇摆应用程序？取决于对象在堆上保持活动的时间长短，将对新的比率值产生影响。默认情况下，像您正在运行的服务器模式 VM 具有相当高的新比率 (8:1)，如果您有很多长寿命对象，这可能不适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:03:08.177

作为一般建议，永远不要使用 OpenJDK，更不用说用于生产环境，它比 Sun/Oracle 的慢得多。

除此之外，我从未见过 VM 使用这么多内存，但我想这就是您需要的（或者您的代码使用的内存比需要的多？）

编辑：用于服务器的 OpenJDK 很好，与 Sun/Oracle JDK 的唯一区别在于桌面内容（声音、gui ...），所以忽略那部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T01:07:28.253

如果我正确理解了您的问题，那么看起来内存泄漏实际上是在程序运行之前发生的`new double[2000][5]`。似乎在命中该行时内存已经很低，因此当该行要求更多内存时它会抛出。

我会使用 jvisualvm 或类似工具来找出内存泄漏的位置。我遇到的内存泄漏主要与在循环中创建字符串、未清除缓存等有关。

# linux - 如何在屏幕上显示程序输出并将它们放入 linux 上的日志文件中

> ID：16095441
> 
> 赞同：0
> 
> 时间：2013-04-19T00:43:07.810
> 
> 标签：linux, shell

我想在屏幕上显示程序输出并将它们放入我尝试过的 linux 上的日志文件中：

```
 <program> 2>&1 | tee logfile 
```

或者

```
 <program> |& tee logfile 
```

确实，他们可以做我想做的事，但是屏幕上没有显示输出，并且`vim`在程序完成之前，当日志文件时我什么也看不到

如何处理这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:55:54.503

您可以运行该命令：

```
script -f -c "program" logfile 
```

这将启动您的程序并以无缓冲的方式将其标准输出和错误流记录到日志文件中。

一个缺点是 stdin 也会出现在输出中（除非在屏幕上没有回显），但这可能是一个有用的功能。

# trigger.io - 如何使用 Trigger.io 在 iPhone 中拨打语音电话？

> ID：16095442
> 
> 赞同：0
> 
> 时间：2013-04-19T00:43:11.247
> 
> 标签：trigger.io

我正在构建一个需要让用户拨打电话号码的应用程序。浏览文档，我无法弄清楚如何做到这一点。有一个[SMS 模块](http://docs.trigger.io/en/v1.4/modules/sms.html)，但没有一个语音模块。是否可以通过 Trigger.io 应用拨打电话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:24:53.497

是的，您可以使用`tel:`url，例如：

```
<a href="tel:123">Phone 123</a> 
```

# algorithm - 二叉搜索树中序遍历算法的时间分析

> ID：16095444
> 
> 赞同：4
> 
> 时间：2013-04-19T00:43:12.397
> 
> 标签：algorithm, data-structures, traversal, binary-search-tree

下面是一个迭代算法，可以在不使用 Stack的情况下按顺序（首先`left child`，然后是`parent`，最后）遍历二叉搜索树：`right child`

（想法：整个想法是找到一棵树的最左边的孩子，每次都找到手头节点的后继节点并打印它的值，直到没有剩下的节点为止。）

```
void In-Order-Traverse(Node root){
     Min-Tree(root); //finding left-most child
     Node current = root;
  while (current != null){
     print-on-screen(current.key);
     current = Successor(current);
  }
  return;
}

Node Min-Tree(Node root){ // find the leftmost child
   Node current = root;
   while (current.leftChild != null)
      current = current.leftChild;
   return current;
}

Node Successor(Node root){
  if (root.rightChild != null) // if root has a right child ,find the leftmost child of the right sub-tree
    return Min-Tree(root.rightChild);
  else{
    current = root;
    while (current.parent != null && current.parent.leftChild != current)
        current = current.parent;
    return current.parrent;
  }
} 
```

据称，该算法的时间复杂度是`Theta(n)`假设 BST 中有`n`节点，这肯定是正确的。但是我无法说服自己，因为我猜一些节点的遍历次数超过了常数，这取决于它们的子树中的节点数量，并且总结所有这些访问次数不会导致时间复杂度`Theta(n)`

关于如何证明它的任何想法或直觉？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T02:45:39.673

用边而不是节点来推理更容易。让我们根据`Successor`函数代码进行推理。

**案例一（`then`分公司）**

对于所有具有右孩子的节点，我们将访问一次右子树（“右转”边），然后总是访问具有`Min-Tree`函数的左子树（“左转”边）。我们可以证明，这样的遍历将创建一条边是唯一的路径——在从任何其他具有右子节点的节点进行的任何遍历中，这些边都不会重复，因为遍历确保您永远不会访问任何“右转”边树上的其他节点。（通过构造证明）。

**案例2（`else`分公司）**

对于所有没有右孩子（`else`分支）的节点，我们将通过“右转”边访问祖先，直到您必须做出“左转”边或遇到二叉树的根。同样，生成的路径中的边是唯一的——在从没有右子节点的任何其他节点进行的任何其他遍历中将永远不会重复。这是因为：

*   除了起始节点和跟随“左转”边缘到达的节点外，中间的所有其他节点都有一个右孩子（这意味着那些被排除在`else`分支之外）。起始节点当然没有右孩子。
*   每个节点都有一个唯一的父节点（只有根节点没有父节点），到父节点的路径是“左转”或“右转”（节点是左孩子或右孩子）。给定任何节点（忽略右子条件），只有一条路径可以创建模式：许多“右转”然后是“左转”。
*   由于中间的节点有一个右子节点，所以一条边不可能出现在从不同节点开始的 2 次遍历中。（因为我们目前正在考虑没有右孩子的节点）。

（这里的证明是相当随意的，但我认为它可以通过矛盾来正式证明）。

由于边是唯一的，因此仅在案例 1（或仅案例 2）中遍历的边总数将为 O(n)（因为树中的边数等于顶点数 - 1）。因此，将这两种情况相加后，有序遍历将是 O(n)。

请注意，我只知道每条边最多访问一次——我不知道证明中是否访问了所有边，但边的数量受顶点数量的限制，这是正确的。

我们可以很容易地看到它也是 Omega(n)（每个节点被访问一次），因此我们可以得出结论它是 Theta(n)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T01:53:30.357

给定的程序在 Θ(N) 时间内运行。Θ(N) 并不意味着每个节点只被访问一次。请记住，有一个常数因素。所以 Θ(N) 实际上可能受到**5 N**或**10 N**甚至**1000 N**的限制。因此，它不能准确计算节点被访问的次数。

二叉搜索树的有序迭代遍历的时间复杂度可以分析如下：

考虑一棵有 N 个节点的树，

让执行时间用复杂度函数表示`T(N)`。

让左子树和右子树分别包含 X 和 NX-1 个节点，

那么时间复杂度`T(N) = T(X) + T(N-X-1) + c`，

现在考虑 a 的两个极端情况`BST`，

**案例1：** A`BST`是完全平衡的，即两棵子树的节点数相等。例如考虑下图所示的 BST，

```
 10
                       /  \
                      5   14
                     / \  / \
                    1  6 11 16 
```

对于这样的树，复杂度函数是，

```
T(N) = 2 T(⌊N/2⌋) + c 
```

在这种情况下，主定理给了我们 Θ(N) 的复杂度。

**情况2：**完全不平衡的BST，即左子树或右子树为空。X = 0。例如，考虑`BST`如下所示，

```
 10
              /
             9
            /
           8
          /
         7 
```

现在`T(N) = T(0) + T(N-1) + c`，

```
T(N) = T(N-1) + c
T(N) = T(N-2) + c + c
T(N) = T(N-3) + c + c + c
 .
 .
 .
T(N) = T(0) + N c 
```

由于 T(N) = K，其中 K 是常数，

T(N) = K + N c

T(N) = Θ(N)。

因此，复杂性`Θ(N)`适用于所有情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T16:02:38.040

我们专注于边缘而不是节点。（为了更好地了解这张图片：http: [//i.stack.imgur.com/WlK5O.png](http://i.stack.imgur.com/WlK5O.png)）

我们声称在这个算法中，每条边最多被访问两次，（实际上它恰好被访问了两次）；

第一次向下遍历，第二次向上遍历。要访问一条边超过两次，我们必须再次向下遍历该边：向下，向上，***向下***，...。

我们证明不可能对边进行第二次向下访问。

假设我们`edge (u , v)`第二次向下遍历 ，这意味着 的祖先之一`u`有一个后继者`u`。

这是不可能的 ：

我们知道，当我们向上遍历一条边时，我们正在寻找一个左转边来寻找一个后继者，所以 while`u`是在后继者的左边，这个后继者的后继者在它的右边，由移动到后继者的右侧（以找到其后继者）`u`再次到达并因此`edge (u,v)`再次是不可能的。（要找到继任者，我们要么向右移动，要么向上移动，但不向左移动）

# ios - 在情节提要场景之间移动 - Segues 和 Unwind

> ID：16095449
> 
> 赞同：0
> 
> 时间：2013-04-19T00:44:00.467
> 
> 标签：ios, interface-builder, segue, uistoryboardsegue

我希望这是有道理的，并希望您可以在图片中看到每个场景右上角的按钮移动到其他场景。
到目前为止，我可以通过模态转场从“正弦波”移动到“锯波”，然后放松回到“正弦波”，但我需要做的是再次回到“锯波”而不调用它的一个新实例。
这可能吗？如果可以，怎么做？
[http://i50.tinypic.com/17bx1l.png](http://i50.tinypic.com/17bx1l.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:51:43.017

当然，您可以这样做，但不能使用 segue，因为 segue 总是会创建新的视图控制器（展开 segue 除外）。因此，您需要在这样的代码中呈现“Saw Wave”（来自“Sine Wave”）：

```
-(IBAction)goToSawWave:(UIButton *) sender {
    if (! self.sawWave) self.sawWave = [self.storyboard instantiateViewControllerWithIdentifier:@"SawWave"];
    [self presentViewController:sawWave animated:YES completion:nil];
} 
```

sawWave 是类 SawWave 的一个属性，您应该将其更改为真正的类名，并确保在 IB 中设置此控制器的标识符。因为您创建了对 SawWave 实例的强引用，并在呈现它之前检查它的存在，所以您将转到同一个实例。

# html - 通过 NFS 共享 1500 万个静态文件

> ID：16095450
> 
> 赞同：0
> 
> 时间：2013-04-19T00:44:17.173
> 
> 标签：html, caching, static, varnish, nfs

有一个同事提出的解决方案，为永远（几乎永远不会）更新的文件设置缓存层。目前，Ruby 应用程序必须从数据库中获取内容、呈现页面并为每个请求提供服务，但在 Akamai CDN 中缓存图像/css/js 除外。

当网站上有 5K 用户时，性能很糟糕。

建议的解决方案是一次生成 1500 万个静态页面（4T），存储在 NFS 服务器上的单个目录中，然后在 9 个 Apache/Phusion-Passenger 服务器之间共享，并将 Apache 设置为从挂载的 NFS 共享中提供静态内容。

除了最初的 1500 万个文件，每天还会生成 8K 个静态文件并添加到 NFS

虽然，我不认为这是一个好的解决方案，并且不喜欢实现它并查看 Varnish 以缓存大多数访问的文章，但我想知道其他人对提议的解决方案与 varnish 的看法。

问题：

*   Linux（CentOS）单个目录下能否存储1500万个文件（4T）
*   这么大的目录可以通过NFS共享吗？会稳定吗
*   1500 万个文件可以存储在散列目录中吗？还是坏主意？
*   NFS 共享是否有最大文件限制？

我想提前感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:51:58.453

你可以试试 GlusterFS。

首先按类别划分您的文章。然后将它们存储到 GlusterFS 目录，例如： `/mnt/articles/category1/201304/20130424/{a lot of files}`

我有一个 6 个节点的 GlusteFS 集群来存储日志文件。目前它有8T+文件，每天增加30G+没有任何问题。

# ios - 使用 GCD 下载 UITableView 标题图片

> ID：16095452
> 
> 赞同：0
> 
> 时间：2013-04-19T00:44:28.847
> 
> 标签：ios, objective-c, grand-central-dispatch

我正在使用 GCD 下载 UITableView 的标题图像。

用`dispatch_async`的时候根本看不到图片，用`dispatch_sync`的时候还是同步下载。我该如何解决 ？

```
eventDetailsTable = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height) style:UITableViewStyleGrouped];
eventDetailsTable.dataSource = self;
eventDetailsTable.delegate = self;

[self.view addSubview:eventDetailsTable];

NSString *headerImageUrl = [NSString stringWithFormat:@"%@%@", [currentEvent objectForKey:@"baseurl"], [currentEvent objectForKey:@"sessionimage"]];
NSURL *headerImageURL = [NSURL URLWithString:headerImageUrl];

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
    NSData *imageData = [[NSData alloc] initWithContentsOfURL:headerImageURL];
    UIImage *headerImage = [UIImage imageWithData:imageData];
    UIImageView *headerImageView = [[UIImageView alloc] initWithImage:headerImage];
    eventDetailsTable.tableHeaderView = headerImageView;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:17:34.470

更新 UI 时，必须在主线程上进行。所以这里是解决方案：

```
dispatch_async(global_queue, ^{
    //Do your work

    dispatch_async(dispatch_get_main_queue(), ^{
        //Update UI
    });

}); 
```

# c++ - C++ 禁止声明没有类型的“binaryTreeType”

> ID：16095454
> 
> 赞同：0
> 
> 时间：2013-04-19T00:44:54.373
> 
> 标签：c++, constructor, compiler-errors, binary-tree, enumerated-types

我试过到处移动这段代码，但我无法克服这个编译错误。我需要将 binaryTreeType 传递给 PostorderTreeEnum 的构造函数，因为根指针受到保护，我无法更改它或以任何其他方式访问它。关于如何声明类型的任何网站？我曾尝试将 BinaryTreeType 标头和方法放在首位，但这也不能解决问题。任何帮助都感激不尽！！！！

```
#ifndef H_binaryTree
#define H_binaryTree

#include <iostream>
#include <stack>

using namespace std;

     //Definition of the node
template<class elemType>
struct nodeType
{
   elemType info;
   nodeType<elemType> *llink;
   nodeType<elemType> *rlink;
};

template<class elemType>
class PostorderTreeEnumerator
{
public:
PostorderTreeEnumerator(const binaryTreeType<elemType> *&otherTree);

elemType nextElement();

bool hasMoreElements();

void slideLeft();

void reset();

//friend class binaryTreeType<elemType>;

private:
stack<nodeType<elemType>* > st;

};

template<class elemType>
PostorderTreeEnumerator<elemType>::PostorderTreeEnumerator(const binaryTreeType<elemType> *&otherTree)
{
    slideLeft(this -> root);
}

template<class elemType>
elemType PostorderTreeEnumerator<elemType>::nextElement()
{
    nodeType<elemType> *current, parent;
    st.pop(&current);

    if (!st.isEmpty())
    {
       st.pop(parent);
       if(parent -> rlink != current)
        slideleft(parent -> rlink); 
    }  
}

template<class elemType>
bool PostorderTreeEnumerator<elemType>::hasMoreElements()
{
    return st.isEmpty();
}

template<class elemType>
void PostorderTreeEnumerator<elemType>::slideLeft()
{
  nodeType<elemType> *current;
  current = this -> root;

  while(current != NULL)
  {  
    st.push(current);
    current = current->llink;
  }
  if(st.isEmpty())
    return;
  st.pop(current);
  if(current->rlink != NULL)
    slideleft(current->rlink);
}

template<class elemType>
void PostorderTreeEnumerator<elemType>::reset()
{

}

    //Definition of the class
template <class elemType>
class binaryTreeType
{
public:
    const binaryTreeType<elemType>& operator=
                 (const binaryTreeType<elemType>&);
      //Overload the assignment operator.
    bool isEmpty();
      //Function to determine if the binary tree is empty.
      //Postcondition: Returns true if the binary tree is empty;
      // otherwise, returns false.
    void inorderTraversal();
      //Function to do an inorder traversal of the binary tree.
      //Postcondition: The nodes of the binary tree are output
      // in the inorder sequence.
    void preorderTraversal();
      //Function to do a preorder traversal of the binary tree.
      //Postcondition: The nodes of the binary tree are output
      // in the preorder sequence.
    void postorderTraversal();
      //Function to do a postorder traversal of the binary tree.
      //Postcondition: The nodes of the binary tree are output
      // in the postorder sequence.

    int treeHeight();
      //Function to deteremine the height of the binary tree.
      //Postcondition: The height of the binary tree is returned.
    int treeNodeCount();
      //Function to determine the number of nodes in the
      //binary tree.
      //Postcondition: The number of nodes in the binary tree
      // is returned.
    int treeLeavesCount();
      //Function to determine the number of leaves in the
      //binary tree.
      //Postcondition: The number of leaves in the binary tree
      // is returned.
    void destroyTree();
      //Deallocates the memory space occupied by the binary tree.
      //Postcondition: root = NULL;

void nonRecursiveInTraversal();
void nonRecursivePreTraversal();
void nonRecursivePostTraversal();

    binaryTreeType(const binaryTreeType<elemType>& otherTree);
      //copy constructor

    binaryTreeType();
      //default constructor

    ~binaryTreeType();
      //destructor

void createTree1();

void inorderTraversal(void (*visit) (elemType&));
//Function to do an inorder traversal of the binary tree.
//The parameter visit, which is a function, specifies
//the action to be taken at each node.

PostorderTreeEnumerator<elemType> getPostorderEnumerator();

friend class PostorderTreeEnumerator<elemType>;

protected:
    nodeType<elemType> *root;

private:
    void copyTree(nodeType<elemType>* &copiedTreeRoot,
                  nodeType<elemType>* otherTreeRoot);
      //Function to make a copy of the binary tree to
      //which otherTreeRoot points.
      //Postcondition: The pointer copiedTreeRoot points to
      // the root of the copied binary tree.

    void destroy(nodeType<elemType>* &p);
      //Function to destroy the binary tree to which p points.
      //Postcondition: The nodes of the binary tree to which
      // p points are deallocated.
      // p = NULL.

    void inorder(nodeType<elemType> *p);
      //Function to do an inorder traversal of the binary
      //tree to which p points.
      //Postcondition: The nodes of the binary tree to which p
      // points are output in the inorder sequence.
    void preorder(nodeType<elemType> *p);
      //Function to do a preorder traversal of the binary
      //tree to which p points.
      //Postcondition: The nodes of the binary tree to which p
      // points are output in the preorder sequence.
    void postorder(nodeType<elemType> *p);
      //Function to do a postorder traversal of the binary
      //tree to which p points.
      //Postcondition: The nodes of the binary tree to which p
      // points are output in the postorder sequence.

    int height(nodeType<elemType> *p);
      //Function to determine the height of the binary tree
      //to which p points.
      //Postcondition: The height of the binary tree to which p
      // points is returned.

    int max(int x, int y);
      //Function to determine the larger of x and y.
      //Postcondition: The larger of x and y is returned.

    int nodeCount(nodeType<elemType> *p);
      //Function to determine the number of nodes in the binary
      //tree to which p points.
      //Postcondition: The number of nodes in the binary tree
      // to which p points is returned.

    int leavesCount(nodeType<elemType> *p);
      //Function to determine the number of leaves in the binary
      //tree to which p points.
      //Postcondition: The number of nodes in the binary tree
      // to which p points is returned.

void inorder(nodeType<elemType> *p, void (*visit) (elemType&));
//Function to do an inorder traversal of the binary
//tree, starting at the node specified by the parameter p.
//The parameter visit, which is a function, specifies the
//action to be taken at each node.

PostorderTreeEnumerator<elemType> *postTreeEnum;
};

template<class elemType>
PostorderTreeEnumerator<elemType> binaryTreeType<elemType>::getPostorderEnumerator()
{
return postTreeEnum;
} 
```

这是 sublime 的编译错误。

```
/Users/jason/dev/CS271/Lab9/binaryTree.h:24: error: expected ',' or '...' before '<' token
/Users/jason/dev/CS271/Lab9/binaryTree.h:24: error: ISO C++ forbids declaration of         'binaryTreeType' with no type
/Users/jason/dev/CS271/Lab9/binaryTree.h:43: error: expected ',' or '...' before '<' token
/Users/jason/dev/CS271/Lab9/binaryTree.h:43: error: ISO C++ forbids declaration of     'binaryTreeType' with no type
[Finished in 1.0s with exit code 1] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:05:45.157

因为必须先声明类型才能使用它。现在`binaryTreeType`是在使用后声明的`PostorderTreeEnumerator`。您可以通过为`binaryTreeType`.

```
template<typename elemType>
class binaryTreeType;

template<class elemType>
class PostorderTreeEnumerator
{
public:
    PostorderTreeEnumerator(const binaryTreeType<elemType> *&otherTree);

    // ... rest of PostorderTreeEnumerator ...
}; 
```

# java - 单击按钮时显示图像

> ID：16095457
> 
> 赞同：0
> 
> 时间：2013-04-19T00:45:18.603
> 
> 标签：java, arrays, function, click, show

我有这个 div：

```
<div id="flaw">
    <img id='flaw1' src='images\flaw1.png'>
    <img id='flaw2' src='images\flaw2.png'>
    <img id='flaw3' src='images\flaw3.png'>
    <img id='flaw4' src='images\flaw4.png'>
    <img id='flaw5' src='images\flaw5.png'>
    <img id='flaw6' src='images\flaw6.png'>
    <img id='flaw7' src='images\flaw7.png'>
    <img id='flaw8' src='images\flaw8.png'>
    <img id='flaw9' src='images\flaw9.png'>
</div> 
```

我正在尝试制作 3 个按钮。每次1个随机按钮应该是好的。其他 2 个坏按钮应该会显示 1 个图像。如果您按错按钮 9 次，所有图像都将可见，您将输掉游戏。

首先我尝试将所有图像放在一个数组中，但我一直失败......

最终我结束了这个；

```
$(document).ready(function () {

    var buttons = $("#buttons img");
    var flaw = $("#flaw img");

    window.onload = function () {

        flaw.hide();

    };

    buttons.on('click', function () {
        $("#flaw1").show();
    })
}); 
```

它现在要做的就是在有人单击按钮时显示第一张图像。并在有人一次又一次点击时显示下一张图片。直到所有 9 个图像都可见。但我可以弄清楚如何在每次点击时循环浏览图像。谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:57:11.300

你可以做这样的事情

```
 var flaws = $("#flaw img");
    buttons.on('click', function () {
        flaws.each(function(){
            if ( ($(this).is(":hidden") ){
                $(this).show();
                break;
            }
        });
    }) 
```

如需进一步参考，请检查

*   [http://api.jquery.com/hidden-selector/](http://api.jquery.com/hidden-selector/)
*   [http://api.jquery.com/each/](http://api.jquery.com/each/)

# scala - Akka 期货例外

> ID：16095462
> 
> 赞同：6
> 
> 时间：2013-04-19T00:46:03.743
> 
> 标签：scala, exception, exception-handling, akka, future

当未来的演员抛出异常时会发生什么？

根据[http://doc.akka.io/docs/akka/snapshot/scala/futures.html](http://doc.akka.io/docs/akka/snapshot/scala/futures.html)上的 Akka 文档：

> Actor 或调度程序是否正在完成 Future 无关紧要，如果捕获到异常，Future 将包含它而不是有效结果。如果 Future 确实包含异常，调用 Await.result 将导致它再次被抛出，以便正确处理。

我不确定这是我在运行这段代码时看到的：

```
 class Worker extends Actor {
    def receive = {
      case i: Int => throw new RuntimeException
    }         
  }

  implicit val system = ActorSystem("MySystem")
  val worker = system.actorOf(Props(new Worker), name="worker")
  implicit val timeout = Timeout(5 minutes)
  val future = worker ? 0
  val res = Await.result(future, 10 seconds) 
```

根据文档， Await.result 应该再次抛出异常，但我得到的是 TimeoutException！有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-19T02:40:01.807

对于参与者，您需要捕获异常并将[其作为失败状态返回](http://doc.akka.io/docs/akka/snapshot/scala/actors.html#Ask__Send-And-Receive-Future)。现在你没有向发件人返回任何东西，所以你得到一个超时异常：

```
class Worker extends Actor {
  def receive = {
    case i: Int => {
      try {
        throw new RuntimeException
        sender ! "Some good result"
      } catch {
        case e: Exception =>
          sender ! akka.actor.Status.Failure(e) // Alert the sender of the failure
          throw e // Alert any supervisor actor of the failure
      }
    }
  }
} 
```

Futures 可以更优雅地处理这个问题，因为它们总是发送结果，而 Actor 不发送（这会给你与上面相同的结果）：

```
 val future = Future {
    throw new RuntimeException
  } 
```

# java - 如何让 JLabel 显示已选择的按钮

> ID：16095464
> 
> 赞同：1
> 
> 时间：2013-04-19T00:46:12.070
> 
> 标签：java, swing, jpanel, jbutton

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import java.awt.*;

public class filecabinet extends JFrame implements ActionListener {

    private String folder = "";
    //create buttons

    private JButton a = new JButton("A");
    private JButton b = new JButton("B");
    private JButton c = new JButton("C");
    private JButton d = new JButton("D");
    private JButton e = new JButton("E");
    private JButton f = new JButton("F");
    private JButton g = new JButton("G");
    private JButton h = new JButton("H");
    private JButton i = new JButton("I");
    private JButton j = new JButton("J");
    private JButton k = new JButton("K");
    private JButton l = new JButton("L");
    private JButton m = new JButton("M");
    private JButton n = new JButton("N");
    private JButton o = new JButton("O");
    private JButton p = new JButton("P");
    private JButton q = new JButton("Q");
    private JButton r = new JButton("R");
    private JButton s = new JButton("S");
    private JButton t = new JButton("T");
    private JButton u = new JButton("U");
    private JButton v = new JButton("V");
    private JButton w = new JButton("W");
    private JButton x = new JButton("X");
    private JButton y = new JButton("Y");
    private JButton z = new JButton("Z");
    //create panels
    private JPanel aF = new JPanel();
    private JPanel gL = new JPanel();
    private JPanel mR = new JPanel();
    private JPanel sX = new JPanel();
    private JPanel yZ = new JPanel();
    private JPanel readout = new JPanel();
    private JLabel notify = new JLabel("You have selected folder " + folder);

    public void ComposePane(){
        //set buttons to panels
        aF.add(a);
        aF.add(b);
        aF.add(c);
        aF.add(d);
        aF.add(e);
        aF.add(f);
        //set layout of panels
        aF.setLayout(new GridLayout(2,3));
        gL.add(g);
        gL.add(h);
        gL.add(i);
        gL.add(j);
        gL.add(k);
        gL.add(l);
        gL.setLayout(new GridLayout(2,3));
        mR.add(m);
        mR.add(n);
        mR.add(o);
        mR.add(p);
        mR.add(q);
        mR.add(r);
        mR.setLayout(new GridLayout(2,3));
        sX.add(s);
        sX.add(t);
        sX.add(u);
        sX.add(v);
        sX.add(w);
        sX.add(x);
        sX.setLayout(new GridLayout(2,3));
        yZ.add(y);
        yZ.add(z);
        yZ.add(readout);
        readout.add(notify);
        yZ.setLayout(new GridLayout(2,3));
    }
    public filecabinet(){
        setTitle("File Cabinet");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new GridLayout(5,1));
        ComposePane();
        add(aF);
        add(gL);
        add(mR);
        add(sX);
        add(yZ);
        addActionListener();
    }

    public void actionPerformed(ActionEvent e) {
        folder = ((JButton) e.getSource()).getText();

    }
    public void addActionListener(){
        a.addActionListener(this);
        b.addActionListener(this);
        c.addActionListener(this);
        d.addActionListener(this);
        e.addActionListener(this);
        f.addActionListener(this);
        g.addActionListener(this);
        h.addActionListener(this);
        i.addActionListener(this);
        j.addActionListener(this);
        k.addActionListener(this);
        l.addActionListener(this);
        m.addActionListener(this);
        n.addActionListener(this);
        o.addActionListener(this);
        p.addActionListener(this);
        q.addActionListener(this);
        r.addActionListener(this);
        s.addActionListener(this);
        t.addActionListener(this);
        u.addActionListener(this);
        v.addActionListener(this);
        w.addActionListener(this);
        x.addActionListener(this);
        y.addActionListener(this);
        z.addActionListener(this);

    }
    public static void main(String[]args){
        filecabinet frame = new filecabinet();
        final int WIDTH = 600;
        final int HEIGHT = 600;
        frame.setSize(WIDTH, HEIGHT);
        frame.setVisible(true);
    }

} 
```

我宁愿不必为每个按钮都写出一个监听器，如果我能得到按钮中包含的文本，我就在徘徊。

例如“您已选择文件夹 X”，X 是选择的按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T04:49:59.360

同样，要么使用数组和/或 for 循环来整合您的代码，从而摆脱代码冗余。例如：

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.*;

@SuppressWarnings("serial")
public class FileCabinet2 extends JPanel {
   public static final char FIRST_LETTER = 'A';
   public static final char LAST_LETTER = 'Z';
   private static final float lARGE_FONT_POINTS = 32f;
   private static final int GRID_COLS = 3;
   private JLabel chosenLabel = new JLabel();

   public FileCabinet2() {
      JPanel letterPanel = new JPanel(new GridLayout(0, GRID_COLS));
      ActionListener btnListener = new ActionListener() {

         @Override
         public void actionPerformed(ActionEvent evt) {
            chosenLabel.setText(evt.getActionCommand());
         }
      };
      for (char c = FIRST_LETTER; c <= LAST_LETTER; c++) {
         String buttonTitle = String.valueOf(c);
         JButton button = new JButton(buttonTitle);
         setFontPoints(button, lARGE_FONT_POINTS);
         letterPanel.add(button);

         button.addActionListener(btnListener);
      }

      JLabel selectionLabel = new JLabel("Selection: ", SwingConstants.RIGHT);
      setFontPoints(selectionLabel, lARGE_FONT_POINTS);
      setFontPoints(chosenLabel, lARGE_FONT_POINTS);

      JPanel bottomPanel = new JPanel(new GridLayout(1, 0));
      bottomPanel.add(selectionLabel);
      bottomPanel.add(chosenLabel);
      bottomPanel.setBorder(BorderFactory.createEtchedBorder());

      setLayout(new BorderLayout());
      add(letterPanel, BorderLayout.CENTER);
      add(bottomPanel, BorderLayout.PAGE_END);
   }

   private void setFontPoints(JComponent jComp, float points) {
      jComp.setFont(jComp.getFont().deriveFont(points));
   }

   private static void createAndShowGui() {
      FileCabinet2 mainPanel = new FileCabinet2();

      JFrame frame = new JFrame("File Cabinet");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

现在如果你想改变按钮列的数量，你只需要改变一个常量，GRID_COLS，字体大小也一样，只需要改变LARGE_FONT_POINTS。

![在此处输入图像描述](https://i.stack.imgur.com/zNMyj.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T00:56:19.347

为了这：

> 宁愿不必为每个按钮写出一个监听器

创建一个接受`JPanel`作为参数的方法，然后迭代到 中的每个组件`JPanel`，如果组件是，则添加动作侦听器`JButton`

这个：

```
I was wandering if I could just get the text contained in the button. 
```

只需在`JLabel`. 您已经获得了按钮内容吗？

所以，完整的代码是：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import java.awt.*;

public class filecabinet extends JFrame implements ActionListener {

    private String folder = "";
    // create buttons

    private JButton a = new JButton("A");
    private JButton b = new JButton("B");
    private JButton c = new JButton("C");
    private JButton d = new JButton("D");
    private JButton e = new JButton("E");
    private JButton f = new JButton("F");
    private JButton g = new JButton("G");
    private JButton h = new JButton("H");
    private JButton i = new JButton("I");
    private JButton j = new JButton("J");
    private JButton k = new JButton("K");
    private JButton l = new JButton("L");
    private JButton m = new JButton("M");
    private JButton n = new JButton("N");
    private JButton o = new JButton("O");
    private JButton p = new JButton("P");
    private JButton q = new JButton("Q");
    private JButton r = new JButton("R");
    private JButton s = new JButton("S");
    private JButton t = new JButton("T");
    private JButton u = new JButton("U");
    private JButton v = new JButton("V");
    private JButton w = new JButton("W");
    private JButton x = new JButton("X");
    private JButton y = new JButton("Y");
    private JButton z = new JButton("Z");
    // create panels
    private JPanel aF = new JPanel();
    private JPanel gL = new JPanel();
    private JPanel mR = new JPanel();
    private JPanel sX = new JPanel();
    private JPanel yZ = new JPanel();
    private JPanel readout = new JPanel();
    private JLabel notify = new JLabel("You have selected folder " + folder);

    public void ComposePane() {
        // set buttons to panels
        aF.add(a);
        aF.add(b);
        aF.add(c);
        aF.add(d);
        aF.add(e);
        aF.add(f);
        // set layout of panels
        aF.setLayout(new GridLayout(2, 3));
        gL.add(g);
        gL.add(h);
        gL.add(i);
        gL.add(j);
        gL.add(k);
        gL.add(l);
        gL.setLayout(new GridLayout(2, 3));
        mR.add(m);
        mR.add(n);
        mR.add(o);
        mR.add(p);
        mR.add(q);
        mR.add(r);
        mR.setLayout(new GridLayout(2, 3));
        sX.add(s);
        sX.add(t);
        sX.add(u);
        sX.add(v);
        sX.add(w);
        sX.add(x);
        sX.setLayout(new GridLayout(2, 3));
        yZ.add(y);
        yZ.add(z);
        yZ.add(readout);
        readout.add(notify);
        yZ.setLayout(new GridLayout(2, 3));
    }

    public filecabinet() {
        setTitle("File Cabinet");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new GridLayout(5, 1));
        ComposePane();
        add(aF);
        add(gL);
        add(mR);
        add(sX);
        add(yZ);
        addActionListener(aF);
        addActionListener(gL);
        addActionListener(mR);
        addActionListener(sX);
        addActionListener(yZ);
    }

    public void actionPerformed(ActionEvent e) {
        folder = ((JButton) e.getSource()).getText();
            // set the label with folder value
        notify.setText("You have selected folder " + folder);

    }

    // Attach event handler to each JButton in JPanel
    public void addActionListener(JPanel panel) {
        Component[] components = panel.getComponents();
        for (Component component : components) {
            if (component instanceof JButton) {
                ((JButton) component).addActionListener(this);
            }
        }
    }

    public static void main(String[] args) {
        filecabinet frame = new filecabinet();
        final int WIDTH = 600;
        final int HEIGHT = 600;
        frame.setSize(WIDTH, HEIGHT);
        frame.setVisible(true);
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T03:38:20.763

*   快速审查您的代码，将您的代码缩短到这个长度。想象一下，如果你给它更多的洞察力，你可以实现什么。
*   此外，当您在代码中看到这一点时，您会一次又一次地为同一件事重复一些行，您确实可以想到一种模式，它可以以正确的方式为您完成这项工作，而且击键次数更少。

试试你的这个修改过的代码:-)

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import java.awt.*;

public class Filecabinet extends JFrame implements ActionListener {

    private String folder = "";
    //create buttons
    private JButton[] button = new JButton[26];

    //create panels
    private JPanel aF = new JPanel();
    private JPanel gL = new JPanel();
    private JPanel mR = new JPanel();
    private JPanel sX = new JPanel();
    private JPanel yZ = new JPanel();
    private JPanel readout = new JPanel();
    private JLabel notify = new JLabel("You have selected folder " + folder);

    public void ComposePane(){
        init_Buttons(button);
        //set buttons to panels
        for (int i = 0; i < 6; i++)
            aF.add(button[i]);
        //set layout of panels
        aF.setLayout(new GridLayout(2,3));
        for (int i = 6; i < 12; i++)
            gL.add(button[i]);
        gL.setLayout(new GridLayout(2,3));
        for (int i = 12; i < 18; i++)
            mR.add(button[i]);
        mR.setLayout(new GridLayout(2,3));
        for (int i = 18; i < 24; i++)
            sX.add(button[i]);
        sX.setLayout(new GridLayout(2,3));
        for (int i = 24; i < 26; i++)
            yZ.add(button[i]);
        yZ.add(readout);
        readout.add(notify);
        yZ.setLayout(new GridLayout(2,3));
    }

    private void init_Buttons(JButton[] button)
    {
        int value = 65;
        for (int i = 0; i < button.length; i++)
        {
            button[i] = new JButton(Character.toString((char) value++));
            button[i].addActionListener(this);
        }
    }
    public Filecabinet(){
        setTitle("File Cabinet");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new GridLayout(5,1));
        ComposePane();
        add(aF);
        add(gL);
        add(mR);
        add(sX);
        add(yZ);
    }

    public void actionPerformed(ActionEvent e) {
        folder = ((JButton) e.getSource()).getText();

        notify.setText(folder);
    }

    public static void main(String[]args){

        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                Filecabinet frame = new Filecabinet();
                final int WIDTH = 600;
                final int HEIGHT = 600;
                //frame.setSize(WIDTH, HEIGHT);
                frame.pack();
                frame.setVisible(true);
            }
        });        
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T01:08:42.423

您可以子类`JButton`化并为子类编写一个构造函数，该构造函数将作为参数接收到动作侦听器的引用，您的`JFrame`.

例如，您的子类可能只是：

```
public class YourButton extends JButton {
    public YourButton(String title, ActionListener listener) {
        super(title);
        this.addActionListener(listener);
    }
} 
```

所以而不是：

```
private JButton a = new JButton("A"); 
```

你会打电话给：

```
private YourButton a = new YourButton("A", this); 
```

此外，正如其他人所建议的，您的`actionPerformed(ActionEvent e)`方法要求您更新通知`JLabel`实例以反映所选按钮的标题。

希望有帮助！

# c++ - 有哪些技巧可以使具有大量计算的函数变得干净？

> ID：16095471
> 
> 赞同：0
> 
> 时间：2013-04-19T00:47:25.247
> 
> 标签：c++, oop, function, coding-style

这样的功能如何：

```
void Map::Display()
{
    if(initialized)
    {
        HRESULT hr;
        int hScrollPos = GetScrollPos(M_HWnd, SB_HORZ);
        int vScrollPos = GetScrollPos(M_HWnd, SB_VERT);

        D2D1_RECT_F region = {0,0,TILE_WIDTH,TILE_HEIGHT};
        D2D1_RECT_F tFRegion = {0,0,TILE_WIDTH,21}; // tile front's region
        Coor coor;
        int tileHeight;

        RECT rect;
        GetWindowRect(M_HWnd, &rect);
        int HWndWidth = rect.right - rect.left;
        int HWndHeight = rect.bottom - rect.top;

        pRT->BeginDraw();

        pRT->Clear(D2D1::ColorF(0.45f, 0.76f, 0.98f, 1.0f));

        pRT->SetAntialiasMode(D2D1_ANTIALIAS_MODE_ALIASED);
        for(int x=0; x<nTiles; x++)
        {
            coor = ppTile[x]->Getcoor();
            tileHeight = ppTile[x]->Getheight();

            pRT->SetTransform(D2D1::Matrix3x2F::Identity());

            if((coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos > 0 - TILE_WIDTH &&
                (coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos < HWndWidth &&
                ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos > 0 - (TILE_HEIGHT * 2.5) &&
                ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos < HWndHeight)
            {
                /* Draws tiles */
                pRT->SetTransform(D2D1::Matrix3x2F::Translation(
                    (coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos,
                    ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos
                    ));

                pRT->FillRectangle( &region, pBmpTileBrush[ppTile[x]->GetType() + 1]);

                /* Draws tiles' front */
                if((coor.Y - 1) / 2 < mapSizeY - 1) // If we are not in the front row,
                {
                    if(coor.X > 1)
                    {
                        for(int diffH = tileHeight - ppTile[x + mapSizeX - 1]->Getheight(); diffH == 0; diffH--)
                        {
                            pRT->SetTransform(D2D1::Matrix3x2F::Identity());

                            pRT->SetTransform(D2D1::Matrix3x2F::Translation(
                                (coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos,
                                ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos  + (TILE_HEIGHT * 0.75) + (diffH * TILE_PIXEL_PER_LAYER)
                                ));

                            pRT->FillRectangle( &tFRegion, pBmpTileFrontBrush[ppTile[x]->GetType()]);
                        }
                    }

                    if(((coor.X -1) / 2) + 1 < mapSizeX)
                    {
                        for(int diffH = tileHeight - ppTile[x + mapSizeX]->Getheight(); diffH == 0; diffH--)
                        {
                            pRT->SetTransform(D2D1::Matrix3x2F::Identity());

                            pRT->SetTransform(D2D1::Matrix3x2F::Translation(
                                (coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos,
                                ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos  + (TILE_HEIGHT * 0.75) + (diffH * TILE_PIXEL_PER_LAYER)
                                ));

                            pRT->FillRectangle( &tFRegion, pBmpTileFrontBrush[ppTile[x]->GetType()]);
                        }
                    }

                    if(coor.X == 1 || (coor.X - 1) / 2 == mapSizeY - 1) // If the tile if at any of left or right edge,
                    {
                        for(int n = ((TH * 1.5) / TPPL) - (ppTile[x + mapSizeY + mapSizeY - 1]->Getheight() - tileHeight); n>=0; n--)
                        {
                            pRT->SetTransform(D2D1::Matrix3x2F::Identity());

                            pRT->SetTransform(D2D1::Matrix3x2F::Translation(
                                (coor.X - 1) * (TILE_WIDTH * 0.5) - hScrollPos,
                                ((coor.Y - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos  + (TILE_HEIGHT * 0.75) + (n * TILE_PIXEL_PER_LAYER)
                                ));

                            pRT->FillRectangle( &tFRegion, pBmpTileFrontBrush[ppTile[x]->GetType()]);
                        }
                    }
                }

                else // If we are in the front row
                {
                    for(int h = tileHeight; h >= 0; h--)
                    {
                        pRT->SetTransform(D2D1::Matrix3x2F::Identity());

                        pRT->SetTransform(D2D1::Matrix3x2F::Translation(
                            (coor.GetX() - 1) * (TILE_WIDTH * 0.5) - hScrollPos,
                            ((coor.GetY() - 1) * (TILE_HEIGHT * 0.5) * 1.5f) + ((MAX_MAP_HEIGHT - tileHeight) * (TILE_PIXEL_PER_LAYER)) + TILE_HEIGHT - vScrollPos  + (TILE_HEIGHT * 0.75) + (h * TILE_PIXEL_PER_LAYER)
                            ));

                        pRT->FillRectangle( &tFRegion, pBmpTileFrontBrush[ppTile[x]->GetType()]);
                    }
                }
            }
        }
        pRT->SetAntialiasMode(D2D1_ANTIALIAS_MODE_PER_PRIMITIVE);

        hr = pRT->EndDraw();
    }
} 
```

这个：

```
Tile* Map::GetClickedTile(short xPos, short yPos)
{
    Tile* pNoClickedTile = NULL;
    int hScrollPos = GetScrollPos(M_HWnd, SB_HORZ);
    int vScrollPos = GetScrollPos(M_HWnd, SB_VERT);

    if(xPos < (mapSizeX * TILE_WIDTH) - hScrollPos) // If the click is within width of the map then...
    {
        Coor coor;
        int height;
        int currentTile;
        int tileDistanceFromTop;

        /* Checks if click is in an odd row of tiles */
        int column = (xPos + hScrollPos) / TILE_WIDTH;

        for (int y=mapSizeY-1; y>=0; y--)
        {
            currentTile = column + (y * (mapSizeX+mapSizeX-1));

            coor = ppTile[currentTile]->Getcoor();
            height = ppTile[currentTile]->Getheight();

            tileDistanceFromTop =   ((coor.Y / 2) * TILE_HEIGHT * 1.5f) + // Distance between two tiles
                                    ( (MAX_MAP_HEIGHT - height) * TILE_PIXEL_PER_LAYER) -
                                    vScrollPos +
                                    SPACE_LEFT_FOR_BACKGROUND;

            /*if (tileDistanceFromTop < 0)                               // If the tile is partially hidden,
                tileDistanceFromTop = tileDistanceFromTop % TILE_HEIGHT;     // then % TILE_HEIGHT*/

            if( yPos > tileDistanceFromTop &&
                yPos < tileDistanceFromTop + TILE_HEIGHT)
            {   
                /* Get relative coordinates */
                int rpx = xPos % TILE_WIDTH;
                int rpy =   ( (yPos - SPACE_LEFT_FOR_BACKGROUND) - 
                            (y * (TILE_HEIGHT /2) ) -
                            ( ( MAX_MAP_HEIGHT - height) * TILE_PIXEL_PER_LAYER) +
                            vScrollPos) %
                            TILE_HEIGHT;

                /* Checks if click is withing area of current tile */
                if (rpy + (rpx / (TILE_WIDTH /16)) > TILE_HEIGHT * 0.25f &&     // if click is Down Right the Upper Left slope and,
                    rpy + (rpx / (TILE_WIDTH /16)) < TILE_HEIGHT * 1.25f &&     // it is UL the LR slope and,
                    rpy - (rpx / (TILE_WIDTH /16)) < TILE_HEIGHT * 0.75f &&     // it is UR the LL slope and,
                    rpy - (rpx / (TILE_WIDTH /16)) > TILE_HEIGHT * -0.25f)      // it is DL the UR slope,
                        return ppTile[currentTile];                             // Then return currentTile
            }
        }

        /* Checks if click is in an even row of tiles */
        column = (xPos + hScrollPos - (TILE_WIDTH/2)) / TILE_WIDTH;

        for (int y=mapSizeY-2; y>=0; y--)
        {
            currentTile = column + (y * (mapSizeX+mapSizeX-1)) + mapSizeX;

            coor = ppTile[currentTile]->Getcoor();
            height = ppTile[currentTile]->Getheight();

            tileDistanceFromTop =   (((coor.Y - 1) / 2) * TILE_HEIGHT * 1.5f) + // Distance between two tiles
                                    ( (MAX_MAP_HEIGHT - height) * TILE_PIXEL_PER_LAYER) +
                                    (TILE_HEIGHT * 0.75) -
                                    vScrollPos +
                                    SPACE_LEFT_FOR_BACKGROUND;

            /*if (tileDistanceFromTop < 0)
                tileDistanceFromTop = tileDistanceFromTop % TILE_HEIGHT;*/

            if( yPos > tileDistanceFromTop &&
                yPos < tileDistanceFromTop + TILE_HEIGHT)
            {   
                /* Get relative coordinates */
                int rpx = xPos % TILE_WIDTH;
                int rpy = (int)((yPos - SPACE_LEFT_FOR_BACKGROUND) - 
                                (y * (TILE_HEIGHT /2) ) -
                                ( ( MAX_MAP_HEIGHT - height) * TILE_PIXEL_PER_LAYER) -
                                (TILE_HEIGHT * 0.675) +
                                vScrollPos) %
                                TILE_HEIGHT;

                /* Checks if click is withing area of current tile */
                if (rpy + (rpx / (TILE_WIDTH /16)) > TILE_HEIGHT * 0.25f &&     // if click is Down Right the Upper Left slope and,
                    rpy + (rpx / (TILE_WIDTH /16)) < TILE_HEIGHT * 1.25f &&     // it is UL the LR slope and,
                    rpy - (rpx / (TILE_WIDTH /16)) < TILE_HEIGHT * 0.75f &&     // it is UR the LL slope and,
                    rpy - (rpx / (TILE_WIDTH /16)) > TILE_HEIGHT * -0.25f)      // it is DL the UR slope,
                        return ppTile[currentTile];                             // Then return currentTile                      // Then return currentTile
            }
        }
    }
    return pNoClickedTile;
} 
```

甚至这样：

```
int Map::GetTileNByCoor(Coor coor)
{
    return ((coor.X / 2 + ((coor.Y - 1) * mapSizeY) - (coor.Y / 2));
} 
```

更容易阅读？随着我的代码变得越来越大，我意识到拥有一个干净、易于阅读的代码是多么重要，即使有时不是必需的。有哪些技巧可以使上述代码更清晰？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:01:02.400

我的一般重构实践通常是执行以下操作：

1.  提取代码中不明显的事物的名称。您可以使用局部变量为小段代码提供定义名称。那么，在像你上一个例子这样的情况下，`(coor.X / 2 + ((coor.Y - 1) * mapSizeY)`代表什么？

    在大多数情况下，最好有好的名字，而不是担心存储局部变量（当堆栈离开函数时它们会被删除，通常你不会太担心内存空间/代码的速度）细粒）。

2.  将执行代码组提取到方法中。一个好的经验法则是，如果您的函数超过 6 行代码，您可能可以在其中提取一个较小的函数。然后你的代码会更好地理解它实际在做什么。

    一个非常常见的地方是循环。您几乎总是可以将循环内的代码拉入它自己的函数中，并具有良好的描述性名称。

3.  提取方法后，您可以将常见的共享功能分组到更小的对象中。让较小的物体一起完成工作几乎总是比让巨大的物体完成大量工作要好。你希望你的对象每个都有一个单一的职责。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:13:40.337

相当可靠的代码，做得很好。我会考虑：

*   在高层注释函数本身，然后为代码中的所有重要块添加更好的注释，以及任何异常棘手的内容。

*   对您正在使用的所有魔术变量使用描述性常量或#defines。为什么要乘以 0.675？0.675 代表什么？同上 0.25、1.25、-0.25 等。

*   将诸如“检查单击是否在当前图块的区域内”测试（和其他）之类的内容转换为您调用的单独方法，例如 isClickInsideTile(x,y,tile)。

*   添加调试跟踪，以便下一个负责人可以启用调试以获取诊断。

PS 你的变量名和方法名做得很好。

# windows-7 - 需要一种方法来允许用户仅在其凭据在外部服务器上有效时才能登录 Windows 7

> ID：16095477
> 
> 赞同：0
> 
> 时间：2013-04-19T00:47:56.983
> 
> 标签：windows-7, windows-authentication, remote-server

我需要开发一个解决方案，仅当 Windows 7 可以访问 Internet 并且用户凭据在针对外部服务器进行探测时有效时才允许用户登录 Windows 7。你们知道任何脚本/解决方案吗？

目的是开发一种方法来限制对给定 Windows 7 机器的访问，如果用户被禁止访问外部服务器。

问候，雨果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:58:09.190

为此，您需要查阅[Windows 7 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=3138)。

# asp.net - 使用 JavaScript 自定义 ASP.NET 服务器控件的简单示例？

> ID：16095483
> 
> 赞同：0
> 
> 时间：2013-04-19T00:48:27.193
> 
> 标签：asp.net, custom-server-controls

我一直在尝试创建一个自定义服务器控件，以使我能够利用 ViewState 和 AutoPostBack，但没有成功。棘手的是我的控件是 HTML 和 JavaScript 的组合。这是渲染输出的一个很好的例子（我也在使用 JS 库，因此是缩写示例）：

```
<input type="text" id="txt" />
<script>
$(function() {
    $("#txt").TurnMeIntoDatePicker({
        value: new Date(1950,1,1)
    });
});
</script> 
```

在此示例中，输入的“id”和 JS 函数的“值”需要作为参数公开（并且它们的值在通过 ViewState 回发后维护）。我见过的每个示例都允许您将参数分配给输入元素，但不能分配给一些自定义的 JS 字符串。我也很想看看你如何添加一个 AutoPostBack 功能，但只是肉汁！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:48:44.507

你在实现 IPostBackDataHandler 吗？您可以使用它在回发时从输入字段中检索值。此外，您的示例未在输入字段中显示名称......您需要输出名称才能正确回发值。在此处查看示例...

[http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackdatahandler.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackdatahandler.aspx)

您可以使用`Page.ClientScript.GetPostBackEventReference(...)`来执行 AutoPostBack。例如，如果您想在值更改时回发，您可以呈现如下内容：

```
protected override void Render(HtmlTextWriter writer)
{
    string content = string.Format("<input type=\"text\" id=\"txt\" onchange=\"{0}\" />", Page.ClientScript.GetPostBackEventReference(this, null));
    writer.Write(content);
} 
```

# php - PHP：使用变量时不会执行Where子句

> ID：16095485
> 
> 赞同：-1
> 
> 时间：2013-04-19T00:48:56.660
> 
> 标签：php, variables, where, clause

对于我正在测试的用户，他们的 org_id 列值为“student_life”

我试图让这个函数显示任何有 student_life 列 = 1 的行。（所以是的，有一个列 student_life 是一个布尔值，然后我还有一个名为 org_id 的单独列，在这种情况下具有值 student_life）

我很确定存在语法错误，但我无法弄清楚。

```
function org_id_users_table() 
{
$org_id = mysql_real_escape_string($_POST["org_id"]);

$sql = $this->query("SELECT * FROM ".DBTBLE." WHERE '$org_id' = '1'");
$result = $sql['sql'];
$num_rows = $sql['num_rows'];
$this->create_table($result, $num_rows);
} 
```

（当我用 student_life 替换 "$sql=..." 行中的 $org_id 时，代码有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T00:51:36.923

您引用了列名，这使 MySQL 认为它是一个字符串。

```
$sql = $this->query("SELECT * FROM ".DBTBLE." WHERE $org_id = '1'"); 
```

编辑：

根据您的评论，我认为您真正想要的是：

```
$sql = $this->query("SELECT * FROM ".DBTBLE." WHERE org_id = '$org_id'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:51:36.230

更改引号。

```
$sql = $this->query("SELECT * FROM ".DBTBLE." WHERE `$org_id` = '1'"); 
```

PS[为什么我不应该在 PHP 中使用 mysql_* 函数？](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-15T14:34:13.513

这是从哪里来的？$_POST["org_id"]

您在发布该页面的页面上有表格吗？还是您只是想从数据库中获取它？如果是这样，您是否不需要另一个查询来首先获得它？

$row_MyFirstQuery['org_id']

否则如果是$_POST["org_id"]，不就是单引号而不是双引号吗？$_POST['org_id']

# vba - VBA 类属性返回空字符串

> ID：16095488
> 
> 赞同：3
> 
> 时间：2013-04-19T00:49:33.340
> 
> 标签：vba, class

我第一次尝试在 VBA 中创建一个类。我查找了一些解决方案，我的类没有发现任何问题，但是当我运行测试代码时，整数返回正确，但字符串返回空：

班级

```
Property Let Name(strName As String)
    pName = strName
End Property
Property Get Name() As String
    Name = pName
End Property
Property Let Class(strClass As String)
    pClass = strClass
End Property
Property Get Class() As String
    Class = pClass
End Property
Property Let Aggro(intAggro As Integer)
    pAggro = intAggro
End Property
Property Get Aggro() As Integer
    Aggro = pAggro
End Property 
```

测试程序

```
Sub ClassTest()
    Dim Dog1 As New Critter

    Dog1.Name = "Labrador"
    Dog1.Class = "Canine"
    Dog1.Aggro = 0     

    Debug.Print Dog1.Name  'returns ""
    Debug.Print Dog1.Class  'returns ""
    Debug.Print Dog1.Aggro  'returns 0  
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T00:53:59.950

你唯一的错误是你没有定义私有变量来保存你的属性值。看起来整数正在工作，因为整数初始化为 0，并且您正在将值“设置”为 0。只需将其添加到类的顶部，然后重试：

```
Private pName as String
Private pClass as String
Private pAggro as Integer 
```

:D

# php - 将 predis 故障转移到 redis 从站的最佳方法是什么？

> ID：16095489
> 
> 赞同：1
> 
> 时间：2013-04-19T00:49:34.120
> 
> 标签：php, session, redis, failover, predis

检测redis服务器是否不可用并故障转移到从属服务器的最佳方法是什么？

当然，这应该是及时有效的。我将它用于集中式 PHP 会话变量存储。

[我在nrk/predis 存储库](https://github.com/nrk/predis)上看到了这个示例，但我相信它仅用于分片，而不用于故障转移/复制情况？

```
$redis = new Predis\Client(array(
    array('host' => '10.0.0.1', 'port' => 6379),
    array('host' => '10.0.0.2', 'port' => 6379)
));
```

* * *

**TL;DR** — 如果主服务器不可用，我希望我的基于 redis 的 PHP 会话故障转移到从属 redis 服务器。

帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:50:03.893

Redis sentinel 监控主 redis 机器的状态并跟踪连接的从属机器。

当主人倒下时，哨兵将提升其中一个奴隶为主人。

Redis sentinel 使用与 redis 服务器相同的协议，客户端可以连接到 redis sentinel 以捕获诸如 master down / master Promotion 等事件。

您可以通知客户有关故障转移的信息。

# actionscript-3 - 如果第一个变量大于第二个，如何比较两个不同的数值变量并更改一个变量？(AS3)

> ID：16095491
> 
> 赞同：0
> 
> 时间：2013-04-19T00:49:48.367
> 
> 标签：actionscript-3, variables, numeric

一个例子：如果 A = 5 并且 b = 6 如果将 2 添加到 A，我希望 A 和 b = 7。

我希望 B 仅在 A 大于 B 时更改，然后我希望 B 复制与 A 相同的数字。

我希望这能解释我在看什么，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T00:52:08.817

```
// Suppose A is already 5, and b is already 6.
A += 2
if (A > b) b = A 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:52:23.387

您可以使用 Math.max(...)：

```
var a:Number = 5;
var b:Number = 6;
a = a + 2;
b = Math.max(a, b); 
```

b 将等于 a (5+2) 或 b (6) 中的较高值 - 在本例中为 7。

# wpf - HierarchicalDataTemplate 和多对多与有效负载实体导航绑定问题

> ID：16095496
> 
> 赞同：1
> 
> 时间：2013-04-19T00:50:45.053
> 
> 标签：wpf, xaml, binding, treeview, hierarchicaldatatemplate

我有两个带有有效负载实体的多对多，如下所示：

![实体快照](https://i.stack.imgur.com/X3lFS.png)

因此，要使用零件号制作存储在 MasterPartNumber 中的**组件**`MasterPartNumber.pn`，我使用导航属性`ParentBOMs`，它由关系给出： `MasterPartNumber.pnID = MasterPartsList.parentPnID`。这给了我该父程序集下的所有子 pnID。

要获取该**组件的子零件编号**，我使用由`ChildPn`定义的导航属性`MasterPartsList.pnID = MasterPartNumber.pnID`。

请注意，顶级装配项目未在 MasterPartsList 中列出（它们的 parentPnID 为空）。

我的 TreeView HierarchicalDataTemplate 绑定是：

```
<TreeView x:Name="AssemblyTreeView"
          ItemsSource="{Binding BOMItems}">
  <TreeView.ItemTemplate>
    <HierarchicalDataTemplate DataType="{x:Type local:MasterPartNumber}"
                              ItemsSource="{Binding ParentBOMs.ChildPn}">
      <TextBlock Text="{Binding pn}" />
    </HierarchicalDataTemplate>
  </TreeView.ItemTemplate>
</TreeView> 
```

我认为这是正确的。我可以单步调试调试器，并看到为每个具有子信息的项目填充了整个 BOMItem 导航属性 (ParentBOM.ChildPn.pn)。

为什么我无法在 TreeView 中看到这些子属性？！

```
What I should get:

Root Assembly
--Sub Assembly
----Sub Assembly
------Child (n-levels deep) 
```

和

我实际得到的：

```
Root Assembly 
```

我需要额外的转换器吗？我是否需要进一步定义我的 ObservableCollection 对象包装器的“getter”？

```
Known possible sources of the problem:
1\. Entity Framework is lazy loading, and just hasn't loaded the navigation properties I see in
   the debugger being populated. (No, set LazyLoading to false.)
2\. My HierarchicalDataTemplate isn't probing for children just on the fact that it has children
   -- aka it only understands to switch the binding path when a new DataType is available, or 
   something like that. (Not likely, because I've seen HierarchcialDataTemplates for self-referencing entities of a single entity type.)

What I have right:
1\. I can cascade down the binding route I told my TreeView to take in the debugger. 
    Parent `pn` is populated as well as its `ParentBOMs.ChildPn.pn`. 
```

请帮忙！谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:42:32.683

无法了解预期的输出应该是什么？你能画出树然后贴出来吗？

您可能必须为要呈现的域类型创建包装 VM 类型。说.. MasterPartVM。您现在可以使用 2 条路由的逻辑定义属性，例如 Children。您的分层数据模板将始终使用此属性扩展下一个级别。

这将使您有责任在 MasterPartVM.Children 的实施中找到合适的孩子——您似乎已经确定了这一点。如果我误解了这个问题，请告诉我..

例如，在链接的帖子中，您可以看到我使用包装器属性来组合子组和条目来整理单个列表。

这是另一个例子

```
public class MyPart
    {
        public string Name { get; set; }
        public bool IsRoot { get; set; }
        public string[] ChildNames { get; set; }
        public IList<MyPart> Children { 
            get {
                if (IsRoot)
                    return ChildNames.Select(c => new MyPart { Name = c, ChildNames =new[]{c} }).ToList();
                else
                    return new List<MyPart>{new MyPart { Name = "No more children" }};
        } }
    }

MyPartsCollection = new ObservableCollection<MyPart>();
            MyPartsCollection.Add(new MyPart
            {
                Name = "Root1",
                IsRoot = true,
                ChildNames = new []{"Item1", "Item2", "Item3"}
            }); 
```

```
<TreeView ItemsSource="{Binding MyPartsCollection}">
  <TreeView.ItemTemplate>
    <HierarchicalDataTemplate DataType="{x:Type local:MyPart}"
                              ItemsSource="{Binding Children}">
      <TextBlock Text="{Binding Name}" />
    </HierarchicalDataTemplate>
  </TreeView.ItemTemplate>
</TreeView> 
```

# authentication - 在 Rails 4 中测试 HTTP Digest 身份验证

> ID：16095497
> 
> 赞同：2
> 
> 时间：2013-04-19T00:50:52.033
> 
> 标签：authentication, ruby-on-rails-4

在 Rails 3 中，我们使用了这个不错的小技巧（至少它被包含并且很容易重用）——[为 HTTP Digest Authentication 编写测试/方法](https://stackoverflow.com/questions/13426529/writing-a-test-method-for-http-digest-authentication)

但是，这种方法 (process_with_new_base_test) 在 Rails 4 (master) 中完全消失了。有谁知道在 Rails 4 中测试摘要身份验证的正确方法？

[Rails 4.0.b1 ActionController::Testing](https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/metal/testing.rb)

[Rails 3.2.x ActionController::Testing](https://github.com/rails/rails/blob/860202e8b2e3579402d48d7e56fa738a9529a340/actionpack/lib/action_controller/metal/testing.rb)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-29T11:56:28.640

这里有一个更容易使用的版本：[https ://gist.github.com/murbanski/6b971a3edc91b562acaf](https://gist.github.com/murbanski/6b971a3edc91b562acaf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-08T12:39:31.123

我遇到过同样的问题。我通读了 Rails 4 测试用例并构建了以下解决方案。无论如何，它都不是完美的，但它可以在我的测试环境中使用。它是原始`authenticate_with_http_digest`辅助方法的嵌入式解决方案。

要点在这里： [https ://gist.github.com/illoyd/9429839](https://gist.github.com/illoyd/9429839)

对于后代：

```
# This should go into spec/support/auth_spec_helpers.rb (if you are using RSpec)
module AuthSpecHelpers

  ##
  # Convenience method for setting the Digest Authentication details.
  # To use, pass the username and password.
  # The method and target are used for the initial request to get the digest auth headers. These will be translated into 'get :index' for example.
  # The final 'header' parameter sets the request's authentication headers.
  def authenticate_with_http_digest(user, password, method = :get, target = :index, header = 'HTTP_AUTHORIZATION')
    @request.env[header] = encode_credentials(username: user, password: password, method: method, target: target)
  end

  ##
  # Shamelessly stolen from the Rails 4 test framework.
  # See https://github.com/rails/rails/blob/a3b1105ada3da64acfa3843b164b14b734456a50/actionpack/test/controller/http_digest_authentication_test.rb
  def encode_credentials(options)
    options.reverse_merge!(:nc => "00000001", :cnonce => "0a4f113b", :password_is_ha1 => false)
    password = options.delete(:password)

    # Perform unauthenticated request to retrieve digest parameters to use on subsequent request
    method = options.delete(:method) || 'GET'
    target = options.delete(:target) || :index

    case method.to_s.upcase
    when 'GET'
      get target
    when 'POST'
      post target
    end

    assert_response :unauthorized

    credentials = decode_credentials(@response.headers['WWW-Authenticate'])
    credentials.merge!(options)
    path_info = @request.env['PATH_INFO'].to_s
    uri = options[:uri] || path_info
    credentials.merge!(:uri => uri)
    @request.env["ORIGINAL_FULLPATH"] = path_info
    ActionController::HttpAuthentication::Digest.encode_credentials(method, credentials, password, options[:password_is_ha1])
  end

  ##
  # Also shamelessly stolen from the Rails 4 test framework.
  # See https://github.com/rails/rails/blob/a3b1105ada3da64acfa3843b164b14b734456a50/actionpack/test/controller/http_digest_authentication_test.rb
  def decode_credentials(header)
    ActionController::HttpAuthentication::Digest.decode_credentials(header)
  end

end

# Don't forget to add to rspec's config (spec/spec_helper.rb)
RSpec.configure do |config|
  # Include auth digest helper
  config.include AuthSpecHelpers, :type => :controller
end 
```

快乐的测试。

# php - 如何将 mysql 查询转换为 php 查询

> ID：16095504
> 
> 赞同：-3
> 
> 时间：2013-04-19T00:51:42.073
> 
> 标签：php, mysql

我一直在我的 mysql 数据库上运行这个查询：

```
select email from main where phno=1234567890 
```

它返回这个（[http://i.imgur.com/YiVQ4NN.png](http://i.imgur.com/YiVQ4NN.png)）

所以这是我在 php 中的尝试：

```
$search_query="select email from main where phno = 5756407850";
$to = mysql_query($search_query);
echo "hello " . mysql_query($search_query);` 
```

我在网络浏览器中的结果是`hello Resource id #34`

我怎样才能提取电子邮件部分中的内容？在这种情况下只是“HGH”字符串？

回答：

```
$search_query="select email from main where phno = 5756407850";
$result = mysql_query($search_query);
$array = mysql_fetch_array($result);
$to = $array[0];
echo "hello " . $to; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:00:18.983

$to 将只包含查询中的结果集对象。

您应该使用 mysql_fetch_array 将其拆分为一个数组并使用第 0 个元素，或者使用 mysql_result 命令从 $to 中提取第 0 个元素

这些细节在这里： http: [//php.net/manual/en/function.mysql-result.php](http://php.net/manual/en/function.mysql-result.php)

但是，这种方法已被弃用......您应该按照文档的建议查看 PDO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:02:26.420

```
$search_query="select email from main where phno = 5756407850";
$to = mysql_query($search_query);
echo "hello " . mysql_query($search_query);` 
```

您已经将此 mysql_query($search_query) 分配给变量 $to 为什么不使用它，并且您不能直接回显结果，您已经遍历了必须使用 fetch_assoc 或 fetch_array 的结果，顺便说一句，欢迎新成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T02:06:13.757

```
<?php
$search_query = mysql_query("SELECT email FROM main WHERE phno='5756407850'");

//do simple count check in your database
$count = mysql_num_rows($search_query); 
//if the count is greater than 0; if there is a match
if($count > 0){
while($row = mysql_fetch_array($search_query)){
$to = $row["phno"];/*this here will grab the number in a variable*/

}//end while statement
}//end if statement

//will echo the variable that has the number in it onto the php page
echo $to; 
?> 
```

试试上面的代码，对不起，我发现你的问题有点难以理解/与我所做的不同，但这应该对你有用。

通常，当人们想使用 php 从数据库中获取某人的详细信息时，他们会首先进行查询，在单独的页面上列出该数据库的所有条目以供用户选择，然后他们将在下一页进行此查询

```
("SELECT * FROM db_table WHERE selected_id='$selected_id'); 
```

然后从该表中获取所有数据并将它们放入 php 变量中，然后将其回显

如果我没有多大意义，那么无论如何我强烈推荐[http://shop.oreilly.com/product/9780596006303.do](http://shop.oreilly.com/product/9780596006303.do)因为它确实以非常容易理解的方式教授 php 和 mysql

# laravel - 如何将控制器操作返回到 Laravel 4 中依赖于条件的路由？

> ID：16095505
> 
> 赞同：0
> 
> 时间：2013-04-19T00:51:47.503
> 
> 标签：laravel, laravel-4

在 Laravel 4 中，您可以使用以下方式将控制器操作分配给路由：

```
Route::any('/', 'PagesController@index'); 
```

但是，在我的应用程序中，我想根据用户是否登录使用不同的控制器和操作。

我曾尝试过这样的事情，但它不起作用：

```
Route::any('/', function() {
    if (Auth::check()) {
        return 'UsersController@index';
    } else {
        return 'PagesController@index';
    }
}); 
```

我采取的解决方案是这样的，但我觉得必须有一种适当的方法来实现这一点，特别是在发生不仅仅是登录检查的情况下：

```
Route::any('/', (Auth::check() ? 'UsersController@index' : 'PagesController@index')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:06:06.270

`if`如果要为已登录的用户显示不同的主页，则该语句应位于路由组之外。

```
if (Auth::check())
{
    Route::any('/', 'UsersController@index');
}
else
{
    Route::any('/', 'PagesController@index');
} 
```

此外，您可能会考虑实现某种身份验证过滤器，然后将未登录的用户重定向到不同的页面。

# javascript - 获取用户位置的免费 JavaScript 插件

> ID：16095510
> 
> 赞同：1
> 
> 时间：2013-04-19T00:52:32.060
> 
> 标签：javascript, ssl, https, geolocation

是否有任何免费的 API/Web 服务可以让我获得访问我的 HTTP 安全网站的人的地理位置？

在我`https://ssl.geoplugin.net/`用来检查这个之前，但现在他们需要一个高级密钥来请求位置。我也尝试使用 Google Maps GeoLocation API，但它给出了错误的位置。所以我最终要求使用任何免费的 javascript 插件。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T00:55:14.660

这实际上是 HTML5 的一个特性，所以要这样做：

```
var x=document.getElementById("demo");
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else{
        x.innerHTML="Geolocation is not supported by this browser.";
    }
}
function showPosition(position) {
    x.innerHTML="Latitude: " + position.coords.latitude + 
    "<br>Longitude: " + position.coords.longitude; 
} 
```

来自[http://www.w3schools.com/html/html5_geolocation.asp](http://www.w3schools.com/html/html5_geolocation.asp)

# jquery - 每次显示页面时，使用 jQuery Mobile 在 div 中显示 JSON

> ID：16095511
> 
> 赞同：0
> 
> 时间：2013-04-19T00:52:46.077
> 
> 标签：jquery, ajax, json, html, jquery-mobile

如果用户登录并连接到相册，我正在尝试让我的 jQuery Mobile 应用程序显示有关相册的信息。我正在使用 $.ajax 发布到我的服务器并获取数据。当应用程序打开时，主页上会显示正确的数据，但是当我导航到应该显示它的另一个页面时，div 是空的，即使我知道正在检索数据。这几乎就像 div 没有被正确注入。下面是我的主页，也是上传页面。

主页：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wedding Connect</title>
    <link href="css/jquery-mobile.css" rel="stylesheet" />
    <link href="css/application.css" rel="stylesheet" />
    <script src="js/jquery.js"></script>
    <!-- <script src="js/application.js">script> -->
    <script src="js/jquery-mobile.js"></script>
    <script src="js/cordova.js"></script>
</head>
<body>
<div data-role="page" id="home" data-title="Home" data-add-back-btn="true" data-back-btn-text="Back">

    <!-- header -->
    <div id="header" data-role="header"><p align="center">Welcome to Wedding Connect</p></div>
    <!-- /header -->

    <!-- content -->
    <div id="content" data-role="content">
        <div id="album-info"></div>
        <nav>
            <ul data-role="listview" data-inset="true" data-theme="c">
                <li><a href="login.html" data-transition="slide">Enter Album Code</a></li>
                <li><a href="upload.html" data-transition="slide">Upload a Photo</a></li>
                <li><a href="instructions.html" data-transition="slide">Instructions</a></li>
            </ul>
        </nav>
    </div>
    <!-- /content -->

    <!-- footer -->
    <div id="footer" data-role="footer" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="home.html" data-transition="slide" data-icon="home" data-theme="b">Home</a></li>
                <li><a href="upload.html" data-transition="slide" data-icon="plus" data-theme="b">Upload Photo</a></li>
                <li><a href="update.html" data-transition="slide" data-icon="gear" data-theme="b">New Album</a></li>
                <li><a href="instructions.html" data-transition="slide" data-icon="info" data-theme="b">Instructions</a></li>
            </ul>
        </nav>
    </div>
    <!-- /footer -->

    <script>
    $("#home").on('pageshow', function () {
        // For testing purposes only
        localStorage.setItem('album_code', '1234');
        var album_code = localStorage.getItem('album_code');
        if (album_code !== null) {
            // Attempt to authenticate the album code
            $.ajax({  
                url: "http://localhost/weddingconnect/index.php/mobile/verify",
                type: "post",  
                data: {album_code: album_code},
                dataType: 'json',
                crossDomain: true,
                error:function() {
                    alert('Server communication error. Could not validate stored album code.');
                },
                success: function(data) {
                    if (data.response == "TRUE") {
                        // Retrieve album information
                        $.ajax({
                            url: "http://localhost/weddingconnect/index.php/mobile/get-album",
                            type: "post",
                            data: {album_code: album_code},
                            dataType: 'json',
                            crossDomain: true,
                            error: function() {
                                alert('Server communication error. Could not retrieve album information.');
                            },
                            success: function(data) {
                                if (data.response == "TRUE") {
                                    $('#album-info').html(
                                        '<p align="center"><strong>Album:</strong> ' + 
                                        data.album + ' <strong>By:</strong> ' + 
                                        data.bride + ' & ' + 
                                        data.groom + '</p>'
                                    );
                                } else {
                                    $('#album-info').html('<p align="center">Error retrieving album information.</p>');
                                }
                            }
                        });                 
                    } else {
                        localStorage.removeItem('album_code');
                        $('#album-info').html('<p align="center">You are not connected to an album at this time.</p>');
                    }
                }
            });
        }
    });
    </script>

</div>
</body>
</html> 
```

上传页面：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wedding Connect</title>
    <link href="css/jquery-mobile.css" rel="stylesheet" />
    <link href="css/application.css" rel="stylesheet" />
    <script src="js/jquery.js"></script>
    <!-- <script src="js/application.js">script> -->
    <script src="js/jquery-mobile.js"></script>
    <script src="js/cordova.js"></script>
</head>
<body>
<div data-role="page" id="upload" data-title="Upload" data-add-back-btn="true" data-back-btn-text="Back">

    <div data-role="header"><p align="center">Welcome to Wedding Connect</p></div>

    <div data-role="content">
        <div id="album-info"></div>
        <script src="js/upload.js"></script>
        <input type="hidden" id="serverUrl" value="http://localhost/weddingconnect/mobile/upload" />
        <input type="button" onclick="capturePhoto();" value="Take Picture" />
        <input type="button" onclick="getPhoto(pictureSource.PHOTOLIBRARY);" value="Select Picture" />
        <input type="button" onclick="uploadPhoto();" value="Upload" data-theme="b" />
        <img id="smallImage" src="" />
        <img id="largeImage" src="" />
    </div>

    <div id="footer" data-role="footer" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="home.html" data-transition="slide" data-icon="home" data-theme="b">Home</a></li>
                <li><a href="upload.html" data-transition="slide" data-icon="plus" data-theme="b">Upload Photo</a></li>
                <li><a href="update.html" data-transition="slide" data-icon="gear" data-theme="b">New Album</a></li>
                <li><a href="instructions.html" data-transition="slide" data-icon="info" data-theme="b">Instructions</a></li>
            </ul>
        </nav>
    </div>

    <script>
    $("#upload").on("pageshow", function() {
        //alert('upload');
        var album_code = localStorage.getItem('album_code');
        //alert(album_code);

        // If no album code is present send the user to the login page
        if (album_code === null) {
            $.mobile.changePage("login.html", {
                transition: "slide"
            });
        }
        // Retrieve the album information
        $.ajax({  
            url: "http://localhost/weddingconnect/index.php/mobile/get-album",
            type: "post",  
            data: {album_code: album_code},
            dataType: 'json',
            crossDomain: true,
            error:function() {
                alert('Server communication error. Could not retrieve album information.');
            },
            success: function(data) {
                if (data.response == "TRUE") {
                    alert(data.groom);
                    $('#album-info').html(
                        '<p align="center"><strong>Album:</strong> ' + 
                        data.album + ' <strong>By:</strong> ' + 
                        data.bride + ' & ' + 
                        data.groom + '</p>'
                    );
                } else {
                    $('#album-info').html('<p align="center">Error retrieving album information.</p>');
                }
            }
        });
    });
    </script>

</div>
</body>
</html> 
```

我觉得我错过了一些简单的事情。我知道您不能将 $(document).ready(function(){ 与 jQM 一起使用，因此我对每个页面都使用 pagebeforeshow。如何在每次显示页面时正确显示它？提前致谢。

# html - 从 WebAudio 生成的声音中删除流行/嘶嘶声

> ID：16095519
> 
> 赞同：2
> 
> 时间：2013-04-19T00:54:16.137
> 
> 标签：html, audio, chromium, web-audio-api

我正在使用 Web Audio API 中的 nodeOscillator 函数来生成声音，但是当声音中断时，它会发出流行声音（剪切时幅度不为零）。有谁知道一种方法来检查 nodeOscillator 的幅度并在我调用 nodeOff() 之前等到它为零？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:42:10.373

只需在 1 毫秒左右的短时间间隔内将其在增益节点上淡出 - 使用 setTargetAtTime - 并将停止时间安排为比该间隔更长的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-07T16:30:32.423

如果您使用的是 Apple 计算机，请查看以下内容：[https ://vsee.zendesk.com/hc/en-us/articles/204973595-Mac-audio-pop-click-sound](https://vsee.zendesk.com/hc/en-us/articles/204973595-Mac-audio-pop-click-sound)

# haskell - 文件夹到联合列表

> ID：16095521
> 
> 赞同：2
> 
> 时间：2013-04-19T00:54:48.967
> 
> 标签：haskell

考虑以下`myUnion`函数，它必须以如下方式开始：

```
myUnion xs ys = foldr .... 
```

我想做的是使用`foldr`创建一个新列表，其中包含所有元素`xs`且`ys`没有任何重复项。我必须先复制所有`xs`不在`ys`的元素，然后再复制`ys`检查后剩余的所有元素。

我已经尝试解决这个问题很长一段时间了，但没有任何成功。我自然会尝试分解`xs`or`ys`并使用 prelude 函数`x:rest`来检查某个元素是否在列表中，但是必须使用表明可能有一种更简单的方法来解决它，这让我很难思考关于解决这个问题的方法，因为它必须以 foldr 开头。`y:rest2``elem``foldr`

我感谢有关如何解决此问题的任何建议。

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:01:57.003

请注意，将列表用于 set 并不是一个好主意：

```
myUnion xs ys = Data.List.foldr Data.Set.insert Data.Set.empty (xs ++ ys) 
```

如果您对 uniq 值列表进行了排序，您可能希望使用展开器：

```
myUnions xs0 ys0 = unfoldr walk (xs0, ys0) where
    walk ([], []) = Nothing
    walk ([], (y:ys')) = Just (y, ([], ys'))
    walk ((x:xs'), []) = Just (x, (xs', []))
    walk (xs@(x:xs'), ys@(y:ys')) | x < y = Just (x, (xs', ys))
                                  | x > y = Just (y, (xs, ys'))
                                  | otherwise = Just (x, (xs', ys')) 
```

但如果你仍然坚持：

```
myUnion xs ys = foldr myInsert [] (xs++ys) where
    myInsert x zs = if x `elem` zs then zs else (x:zs)

-- this one expects that both lists have uniq items
-- and checks only elements from xs for presence in ys
myUnion xs ys = foldr myInsert ys xs where
    myInsert x zs = if x `elem` ys then zs else (x:zs)
-- but this should be written differently I guess
myUnion xs ys = filter (`notElem` ys) xs ++ ys 
```

# arduino - 如何让触摸屏进入休眠状态？

> ID：16095533
> 
> 赞同：0
> 
> 时间：2013-04-19T00:55:55.823
> 
> 标签：arduino

嗨，我有一个带有 Adafruit TFT 触摸屏的 Arduino mega 2560，我现在正在使用 tft 库来写我的东西。我想知道是否有关闭屏幕（省电）的功能，然后实现一个物理按钮重新打开它？我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:09:31.910

您无法直接开箱即用地控制背光。查看 AdaFruit 网站上的链接：

[控制背光](http://learn.adafruit.com/2-8-tft-touch-shield/controlling-the-backlight)

您将需要用刀和烙铁对您的 TFT 屏蔽进行物理更改（但焊接工作应该很容易）。

至于使用物理按钮唤醒它——是的。对您来说还有好消息，因为您使用的是 Mega，您可以连接到 I/O 引脚！（使用 UNO 会更困难）。

因此，您可以添加一个按钮开关接地并将 pinMode 设置为 INPUT_PULLUP。

# android - 对元标记和媒体查询中设备宽度差异的困惑

> ID：16095536
> 
> 赞同：2
> 
> 时间：2013-04-19T00:56:10.650
> 
> 标签：android, css, mobile

我正在努力让我的网站在不同的移动设备上运行，我遇到了一些关于设备宽度的问题。我知道以前有人问过这样的问题，但我在这里和其他地方都读过相互矛盾的东西，但没有找到任何可以说明我在寻找什么的东西。

假设我使用的是分辨率为 480x800 的 Nexus One。现在，如果制作一个元标记，例如：

```
<meta name="viewport" content="width=device-width"> 
```

如果是纵向的，视口宽度是 320px，如果是横向的，视口宽度是 533px。这是有道理的，因为逻辑分辨率是 320x533。但是当我进行媒体查询时：

```
@media only screen and (max-device-width: 320px) {
    /*CSS rules here */
} 
```

设备宽度是指物理分辨率，不会根据方向而改变。因此，对于 Nexus One，设备宽度为 480 像素，无论方向如何，因此不包含在媒体查询中。

这是正常行为吗？如果是，为什么 device-width 在两者之间表现如此不同？他们不仅使用不同的值，而且其中一个值会根据方向发生变化，而另一个则不会。这非常令人困惑，更糟糕的是，我已经阅读了完全相反的内容（媒体查询设备宽度受方向影响，而元标记设备宽度不受）网络上的其他地方。

任何帮助澄清将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T01:43:28.390

'device-width' 媒体特征描述了输出设备的渲染表面的宽度。对于连续媒体，这是屏幕的宽度。对于分页媒体，这是页面尺寸的宽度。

我不是移动网页设计方面的专家，但我认为方向不会影响设备宽度值。

[您可以在此处阅读有关媒体查询的更多信息](http://www.w3.org/TR/css3-mediaqueries/)

# php - 使用 PHP 从包含 pdo/sql 获取结果的数组中过滤掉

> ID：16095537
> 
> 赞同：0
> 
> 时间：2013-04-19T00:56:13.540
> 
> 标签：php, sql, arrays, pdo, count

我正在从这样的 PDO 查询中获取所有结果：

```
$orders = $ordersQuery->fetchAll(PDO::FETCH_ASSOC); 
```

现在，我想计算字段“状态”等于“打开”的行数。我知道我可以直接构建我的 SQL 以仅加载 OPEN 状态行，但我认为使用 PHP 和类似的东西可能会更快

```
$openOrders = count(array_keys($orders,"OPEN")); 
```

它虽然返回 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:35:54.017

作为记录，这是我在 PHP 中的做法：

```
$orders = $ordersQuery->fetchAll(PDO::FETCH_ASSOC);
$open = array_reduce($orders, function ($num, array $order) {
    return $num + (int)($order['status'] == 'OPEN');
}, 0); 
```

以下是实际操作方法：

```
$query = "SELECT COUNT(*) FROM orders WHERE status = 'OPEN'"; 
```

# java - 在错误/恢复下一个模式上是否有与 vb 等效的 java？

> ID：16095539
> 
> 赞同：1
> 
> 时间：2013-04-19T00:56:39.437
> 
> 标签：java, vb.net, try-catch, next, resume

在 VB 中，对于错误捕获有

```
Public Sub MySub()
    On Error GoTo Errr
    'do stuff
Errr:
    'handle error
    Resume Next
End Sub 
```

它使用了宏伟的 Resume Next 命令。

在 Java 中，你有一个 try catch 块

```
try 
{
//some code
}
catch (Exception e)
{
//handle error
} 
```

这似乎等同于 VB 错误捕获，但特别是没有 Resume Next 选项，因此 Java 只是在错误后退出整个代码块，而不是在错误后尝试运行其余代码。有没有办法在 Java 中获得 Resume Next 的强大功能？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:05:00.117

只需在 catch 块之后放置您想要运行的代码，而不考虑任何错误。

```
try {
    // stuff that could cause error
} catch(Exception e) {
    // handle error
}

// do stuff 
```

如果你要从 catch 块中抛出一个异常，但你仍然希望“do stuff”代码运行，你可以把它放在 finally 块中，如下所示：

```
try {
    // stuff that could cause error
} catch(Exception e) {
    // throw exception here
} finally {
  // do stuff that will run even when the exception is thrown
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T16:39:09.757

Java 中没有与 VB 的 resume 语句等价的语句；在 VB 中，根据错误情况，您可以选择在代码中的特定标签处恢复，以便在修复错误后重新运行代码，类似于 goto 语句；这在 java 中是不可能的，除非你在一个循环中，然后你可以使用 continue 到一个定义的标签块。

# java - 与 Math.random() 和 ArrayList.remove() 相关的逻辑

> ID：16095542
> 
> 赞同：0
> 
> 时间：2013-04-19T00:56:57.773
> 
> 标签：java, math, random, arraylist

我想为联盟中 20 支足球队的女孩随机分配球衣号码。

**修复：我最终为每个团队使用 Collections.shuffle(shirtnums) 并处理顶部的数字。**

这是我用来执行此操作的代码-

*   我有一个整数和一个 ArrayList：

    ```
    int shirtnum = 0;
    ArrayList<Integer> shirtnums;
    shirtnums = new ArrayList<Integer>(); 
    ```

*   在每个团队的开头，我将数字添加到其中：

    ```
    for(int number = 1; number < 31; number++){shirtnums.add(number);} 
    ```

*   在每个团队结束时，我都会清除它：

    ```
    shirtnums.clear(); 
    ```

*   在 22 个女孩的循环中，我试图获取一个随机数，然后将其从 ArrayList 中删除：

    ```
    double shirt = Math.floor(Math.random() * shirtnums.size());
    shirtnum = (int) shirt;
    shirtnums.remove(shirtnum); 
    ```

但是，这是一个团队的示例输出：

```
pid lname       fname       DOB         posid   tid shirtnum
1   Smith       Mary        1997-09-05  1       1   23
2   Johnson     Patricia    1997-04-03  2       1   15
3   Williams    Linda       1998-03-03  3       1   10
4   Jones       Barbara     1998-08-14  4       1   13
5   Brown       Elizabeth   1998-02-24  5       1   13
6   Davis       Jennifer    1998-08-27  6       1   12
7   Miller      Maria       1997-09-06  7       1   2
8   Wilson      Susan       1998-03-02  8       1   16
9   Moore       Margaret    1997-01-04  9       1   2
10  Taylor      Dorothy     1997-04-01  10      1   11
11  Anderson    Lisa        1997-01-25  11      1   7
12  Thomas      Nancy       1997-08-05  1       1   1
13  Jackson     Karen       1997-01-18  2       1   8
14  White       Betty       1997-01-16  3       1   5
15  Harris      Helen       1998-06-12  4       1   7
16  Martin      Sandra      1998-07-08  5       1   13
17  Thompson    Donna       1997-10-11  6       1   11
18  Garcia      Carol       1998-03-06  7       1   7
19  Martinez    Ruth        1998-08-00  8       1   7
20  Robinson    Sharon      1998-02-20  9       1   8
21  Clark       Michelle    1997-00-00  10      1   2
22  Rodriguez   Laura       1998-06-12  11      1   3 
```

显然，我们不能让三个#13 和两个#2 在球场上跑来跑去……那我做错了什么？

根据要求，这是完整的代码：

```
import java.sql.*;
import java.lang.*;
import java.util.*;

public class GetSoccerNames
{
public static void main(String [] args)
{

    //declare variables
    Connection getconn  = null;
    Connection setconn  = null; 
    Statement getstmt       = null;
    ResultSet names_rs  = null;
    String lastname     = null;
    String firstname        = null;
    double year             = 0;
    double month            = 0;
    double day              = 0;
    String DOB              = null;
    int posid               = 0;
    int tid                     = 1;
    int shirtnum            = 0;
    int pid                 = 0;
    ArrayList<Integer> shirtnums;
    shirtnums = new ArrayList<Integer>();

    try{
        Class.forName("com.mysql.jdbc.Driver");
        getconn = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/playernames", "root", "");

        //setconn = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/league", "root", "");

        getstmt = getconn.createStatement();
        names_rs = getstmt.executeQuery("select fname, lname from names");

        //for each team
        for(tid = 1; tid < 4; tid++){           
            System.out.println("pid" + "\t" + "lname" + "\t" + "fname" + "\t" + "DOB" + "\t\t" + "posid" + "\t" + "tid" + "\t" + "shirtnum"); 

            //int[] shirtnums = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30};

           for(int number = 1; number < 31; number++){shirtnums.add(number);}

            //for each player on the team
            for(int teamplayer = 1; teamplayer < 23; teamplayer++){
                //PID
                // print i value ... remove for insert
                pid++;

                //NAME
                names_rs.next();
                lastname = names_rs.getString(2);
                firstname = names_rs.getString(1);

                //DOB
                year        = Math.round(Math.random() + (2013-16));
                month   = Math.round(Math.random() * 12);
                day         = Math.round(Math.random() * 28);
                int yyyy = (int) year;
                int mm  = (int) month;
                int dd  = (int) day;

                        if (mm>9 && dd>9)   {DOB = yyyy + "-" + mm + "-" + dd;}
                else    if (mm<10 && dd>9){DOB = yyyy + "-0" + mm + "-" + dd;}
                else    if (mm>9 && dd<10){DOB = yyyy + "-" + mm + "-0" + dd;}
                else    if (mm<10 && dd<10){DOB = yyyy + "-0" + mm + "-0" + dd;}

                //POSID
                posid = ((pid-1)%11)+1;

                //TID
                //tid is determined outside the loop

                //SHIRTNUM
                double shirt = Math.ceil(Math.random() * shirtnums.size());
                shirtnum = (int) shirt;
                shirtnums.remove(shirtnum - 1);

                //TEST PRINT
                System.out.println(pid + "\t" + lastname + "\t" + firstname + "\t" + DOB + "\t" + posid + "\t" + tid + "\t" + shirtnum); 
            }
            shirtnums.clear();
        }
    }
    catch(ClassNotFoundException cnfe){
        System.out.println("Class Not Found: " + cnfe.getMessage());        
    }
    catch(SQLException sqle){
        System.out.println("SQL Error: " + sqle.getMessage());
    }
    finally{
        if (getconn != null)        try{getconn.close();}       catch(SQLException ignore){}
        if (getstmt != null)        try{getstmt.close();}       catch(SQLException ignore){}
        if (names_rs != null)       try{names_rs.close();}          catch(SQLException ignore){}
    }
}
} 
```

我希望这会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:05:45.880

更好的方法是使用[Collections.shuffle()](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)。

这样：

```
Collections.shuffle(shirtnums, new Random(System.nanoTime())); 
```

然后你可以简单地遍历洗牌列表：

```
for(Integer shirtnum : shirtnums) {
    ... etc
} 
```

您可以为每个团队执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:10:30.300

为什么不使用`Collections.shuffle(List<?>)` 随机播放所有 33 个数字并从顶部发牌？

```
private void assignJerseys(int availableJerseys, List<Player> players) {

    assert players.size() < availableJerseys : "Not enough jerseys.";
    List<Integer> numbers = new ArrayList<>();
    for(int i = 1; i <= jerseys; ++i {
       numbers.add(i);
    }
    Collections.shuffle(numbers);
    for (int p = 0; p < players.size(); ++p) {
        players.get(p).setJerseyNumber(numbers.get(p));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:59:34.010

您的问题是您直接使用随机数作为衬衫编号，而不是数组内容。

您应该从数组的内容中检索您的衬衫号码，而不是直接从随机数中检索。

```
shirtnum = shirtnums.remove((int) shirt); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T01:05:43.850

在将球衣号码分配给玩家之前，您不会检查是否已经从列表中删除了球衣号码。检查生成的随机衬衫号码是否可以解决您的问题。

# php - 使用 preg_match "script" 在 cakephp 1.3 控制器中验证字符串

> ID：16095544
> 
> 赞同：1
> 
> 时间：2013-04-19T00:57:21.400
> 
> 标签：php, regex, preg-match, cakephp-1.3

如何查找字符串是否包含带有 preg_match,... 的“脚本”标签？如果数据作为“脚本”传递，我试图避免/提交提交

```
 $short_status = $this->params['form']['value'];

 $regex = '/^[<script>]$/i'; 
 if(preg_match($regex, $short_status))
 {
 die();
 }
 else
 {
 to process post and save to database,... 
```

提前谢谢，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T21:49:21.567

使用以下正则表达式：`#</?script[^>]*>#i`.

测试：

```
if(preg_match('#</?script[^>]*>#i', '<script type="text/javascript">')){
    echo 'SCRIPT FOUND';
}else{
    echo 'Baah, nothing';
} 
```

带有一些示例数据的[在线演示。](http://regex101.com/r/aB1iF5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T04:56:37.690

毕竟，...这对我有用：

```
 $short_status = $this->params['form']['value'];
   $regex = '/^<\w+|script|java|javascript|>$/';

       if(preg_match($regex, $short_status))
      {
    die(); // aboard submission
      }

else
{
     // go to submission and save 
```

好好享受，...

# jquery - HTML5 本地存储问题

> ID：16095548
> 
> 赞同：1
> 
> 时间：2013-04-19T00:57:45.737
> 
> 标签：jquery, html, local-storage, jquery-mobile

我在 HTML5 中的本地存储遇到了这个问题。代码如下：`key1`是一个问题，并且`value1`是`value2`我要检查的单选按钮的值。

```
function setAnswers() {

    $(function () {
        if ($('#id1').is(':checked')) {
            alert(localStorage['key1'] = "value1");
        }

        if ($('#id2').is(':checked')) {
            alert(localStorage['key1'] = "value2");
        }
    });
} 
```

和 HTML：

```
 <div id="next1">
       <a class="next" type="button" data-inline="true" data-theme="a" value="Next"
        data-icon="arrow-r" data-iconpos="right" href="page2.html" data-rel="external" onClick="alert(setAnswers())">Next</a>
       </div> 
```

到目前为止，它适用于第一个`alert()`，甚至显示我存储的密钥`localstorage`，但随后我得到第二个`alert`显示`undefined`，然后转到下一页。当我回到第一页时，它会删除我已经存储的密钥。

编辑：我为属性发布了错误的代码，`onClick`这是正确的：

```
onClick="alert(setAnswers())" 
```

# android - Android - 为乒乓球游戏创建计时器循环

> ID：16095557
> 
> 赞同：1
> 
> 时间：2013-04-19T00:58:53.180
> 
> 标签：android, loops, timer, android-asynctask, pong

我有一个用 Java 编写的**Pong**游戏，我正在尝试将它移植到 Android。（这是我的第一个安卓游戏；）。

在 Java 中，我使用了一个`Timer`对象，它基本上更新了游戏值（球/桨位置），然后重新绘制了屏幕。

我正在尝试在 Android 中实现相同的功能，但遇到了许多错误。

我的程序由一个`PongView`作为游戏视觉部分的`PongDriverActivity`类和一个`PongView`用于其视图的类组成。如果我有一个循环线程无效`PongView`，我会收到一个错误，因为该线程无法触及在另一个线程上生成的视图。

我想我需要做一些事情`AsyncTask`，但我不知道如何循环。

关于什么是实现这一点的最佳方法的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T07:35:45.297

有很多方法可以做到这一点。Android 确实支持普通的 Java`Thread`对象，您*可以*使用它们。您可以搜索（SO）`android game loop`并可能找到很多示例。但是，如果您想尝试`AsyncTask`，这里有一个示例实现：

```
public class PongView extends View {

    public PongView(Context context) {
        super(context);
    }    
    public void setBallPosition(int x, int y) {
        // relocate the ball graphic
    }    
} 
```

然后，您的活动：

```
public class PongDriverActivity extends Activity implements OnSeekBarChangeListener {

    private enum GameSpeed { SLOW, MEDIUM, FAST };

    private PongView mGameView;
    private PongDriverTask mWorker;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mGameView = new PongView(this);
        mWorker = new PongDriverTask(GameSpeed.MEDIUM);

        // if you need to pass some data to the worker:
        mWorker.execute("one", "two", "three");  
        // else, declare the AsyncTask's first generic param as Void, and do:
        //mWorker.execute();

        setContentView(mGameView);
    }

    // you would connect this up to a button, to allow the user to stop  
    public void onStopClicked(View sender) {
        if (mWorker.isRunning()) {
            mWorker.stopRunning();
        }
    }

    // you could connect this up to a slider, to allow the user to control the paddle
    public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
        // you may need to convert progress to a y-coordinate
        mWorker.setPaddlePosition(progress);
    } 
```

然后（可能在内部类 PongDriverActivity.java 中）：

```
private class PongDriverTask extends AsyncTask<String, Integer, Integer> {

    private int mDelay;
    private boolean mRunning = true;
    private int mPaddleY = 0;

    public PongDriverTask(GameSpeed speed) {
        if (speed == GameSpeed.SLOW) {
            mDelay = 100;
        } else if (speed == GameSpeed.MEDIUM) {
            mDelay = 50;
        } else if (speed == GameSpeed.FAST) {
            mDelay = 10;
        }
    }

    public synchronized boolean isRunning() {
        return mRunning;
    }
    public synchronized void stopRunning() {
        mRunning = false;
    }
    public synchronized void setPaddlePosition(int y) {
        mPaddleY = 0;
    }
    private synchronized int getPaddlePosition() {
        return mPaddleY;
    }

    @Override
    protected void onPostExecute(Integer score) {
        super.onPostExecute(score);
        // here you could show a UI that shows the final score
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();

        mGameView.setBallPosition(0, 0);
        // here you could throw up some UI that shows just
        //  before the game really starts
    }

    @Override
    protected void onProgressUpdate(Integer... params) {
        super.onProgressUpdate(params);
        // retrieve updated game coordinates from params
        mGameView.setBallPosition(params[0], params[1]);  // x,y
    }

    @Override
    protected Integer doInBackground(String... args) {
        // If you have some information to pass to the background worker, 
        //  it would be passed in args[0], args[1], etc.
        // It doesn't have to be String data.  you could change the generic 
        //  to take something other than String as the first param, in which
        //  case, doInBackground() would take a variable length list of that
        //  other data type.
        int ballX = 0;
        int ballY = 0;
        int score = 0;

        while (isRunning()) {
            // use your game engine to recalculate the ball position
            //  on this background thread
            int paddleY = getPaddlePosition();
            ballX += 1;
            ballY += 2;
            score++;

            // now, update the UI, which must happen on the UI thread
            publishProgress(ballX, ballY);

            try {
                Thread.sleep(mDelay);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        return score;
    }
} 
```

任务的`doInBackground()`方法将在后台线程上运行，因此您不能直接从那里修改 UI。但是，`AsyncTask`我在上面覆盖的所有其他方法都是在 UI 线程上调用的，因此在其中任何一个中执行 UI 工作都是安全的。

此代码假定桨由搜索栏控制，您将`Activity`为其设置更改侦听器。还有很多其他方法可以做到这一点。

我刚刚实现了一个粗略的游戏停止机制，你可以连接到一个按钮。如果您想允许用户暂停和恢复，您可以搜索暂停/恢复线程的实现，这也应该适用于此。例如：

[如何在 Java 中从另一个线程暂停和恢复一个线程](https://stackoverflow.com/q/11989589/119114)

## 更多阅读...

[有关游戏循环速度的一些讨论，请参阅此文章](http://www.mysecretroom.com/www/programming-and-software/android-game-loops)...

[也许也看看这个讨论](https://gamedev.stackexchange.com/a/21205)

# vb6 - 如果默认是 Chrome 或 IE，ShellExecute 挂起打开新的浏览器窗口

> ID：16095560
> 
> 赞同：2
> 
> 时间：2013-04-19T00:59:13.703
> 
> 标签：vb6, shellexecute, default-browser

我使用此代码（来自 MSDN）打开默认浏览器。

```
Private Declare Function ShellExecute _
                            Lib "shell32.dll" _
                            Alias "ShellExecuteA"( _
                            ByVal hwnd As Long, _
                            ByVal lpOperation As String, _
                            ByVal lpFile As String, _
                            ByVal lpParameters As String, _
                            ByVal lpDirectory As String, _
                            ByVal nShowCmd As Long) _
                            As Long

Private Sub Command1_Click()
   Dim r As Long
   r = ShellExecute(0, "open", "http://www.microsoft.com", 0, 0, 1)
End Sub 
```

仅当实例已打开时，它才适用于 IE 和 chrome，然后它只是广告一个选项卡并返回请求的页面。

如果没有实例已经打开，则会创建一个新实例，但页面永远不会加载并最终超时。

在这两种情况下，似乎只有 firefox 可以正常工作。

然后，我尝试了一种技术（[在此处](http://www.vb-helper.com/howto_get_associated_program.html)详细介绍），在该技术中，我创建了一个临时 htm 文件，以便找到关联的应用程序，然后使用以下 Shell 调用之一：

```
Shell "C:\Program Files\Internet Explorer\iexplore.exe https://www.google.co.uk/", vbNormalFocus

 Shell "C:\Program Files\Mozilla Firefox\firefox.exe https://www.google.co.uk/", vbNormalFocus

 Shell "C:\Users\Kjack\AppData\Local\Google\Chrome\Application\chrome.exe https://www.google.co.uk/", vbNormalFocus 
```

这次 FF 和 IE 都可以工作，但 chrome 仍然有同样的问题。

有谁知道解决这个问题？

**编辑以添加有关操作系统和浏览器版本的详细信息：**

操作系统：Windows Vista Home Basic 32 位

火狐 20.0.1

即 9.0.8112.16421

歌剧 12.15 构建 1748

铬 26.0.1410.64 m

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T05:46:47.200

自从 Win2k & Me 出现以来，您还拥有一个干净的基于 COM 的界面。它提供了 Unicode 支持而无需旋转：

[Shell.ShellExecute 方法](http://msdn.microsoft.com/en-us/library/windows/desktop/gg537745%28v=vs.85%29.aspx)

```
 With CreateObject("Shell.Application")
        .ShellExecute "http://www.microsoft.com"
    End With 
```

该示例允许所有可选参数（包括动词）默认。正如肯怀特的回答中已经指出的那样，在这种情况下，您希望动词默认。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T01:44:26.630

您的代码假设有一个`open`动词分配给`http:`协议，并且不能保证它已经被浏览器的安装。

相反，只需将动词留空。如果您不指定一个，Windows 将使用协议或文件关联的默认操作。

```
Private Sub Command1_Click()
   Dim r As Long
   r = ShellExecute(0, "", "http://www.microsoft.com", 0, 0, 1)
End Sub 
```

提示：您可以通过在 Windows 资源管理器中右键单击文件来查看文件的默认操作。**默认操作是以粗体**文本显示的上下文菜单顶部的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-07T19:55:09.010

这将打开默认浏览器（例如 Chrome）而不挂起：

VB6：

```
Call Shell("explorer """ & sURL & """", vbNormalFocus) 
```

或者试试这个：

```
Dim objShell As Object
Set objShell = CreateObject("WScript.Shell")
Call objShell.Run("explorer """ & sURL & """", vbNormalFocus) 
```

# typo3 - Typ3 环绕 ACT 子菜单

> ID：16095565
> 
> 赞同：-1
> 
> 时间：2013-04-19T01:00:00.633
> 
> 标签：typo3, submenu

如果它是实际页面的子菜单，是否可以对子菜单进行不同的环绕？（或子菜单的站点之一是实际页面）我试过了

```
menu.2.ACT.allWrap 
```

但这仅在子菜单的站点是实际站点时才有效。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:50:43.447

尝试

```
menu.2.ACT.wrapItemAndSub = your | wrap 
```

或者

```
menu.2.CUR.wrapItemAndSub = your | wrap 
```

这将包装链接和孩子。

`CUR`当您在该页面上时使用，因此当它是当前页面时`ACT`使用，并且当其中一个孩子是当前页面时使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:54:14.673

请尝试以下代码：

```
menu.2.ACT.allWrap #will work if the branch is active
menu.2.CUR.allWrap #will work for current page.
menu.2.NO.allWrap #will other inactive branches. 
```

# ios - 在 iPhone 上可以创建多少个文本视图？

> ID：16095566
> 
> 赞同：0
> 
> 时间：2013-04-19T01:00:06.717
> 
> 标签：ios, resources

我正在开发非标准富文本视图来显示其他程序的输出。我发现只需将大量 UITextView 添加到 ScrollView 中，然后为每个标签设置各种属性，就可以很容易地做到这一点。像文本大小、颜色、透明度等。其中一些可能是可点击的按钮。

但现在的逻辑问题是，iPhone 可以安全地处理多少个 TextView？

当然，我可以自己做一些测试，（我会做）但它可能不可靠，也许有人从经验或一些文档或计算中知道得更好？也许这个问题可以概括为“有多少视图”？但到目前为止，我主要对 TextViews 感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:06:03.413

我认为您不必担心`UITextView`可以使用的安全数量。因为你知道 iPhone 的屏幕是如此之小。您是否认为您需要`UITextView`在一个屏幕上使用 iOS 甚至无法处理的这么多？

# javascript - 无法在移动设备的浏览器中创建 RTCIceCandidate 实例

> ID：16095568
> 
> 赞同：0
> 
> 时间：2013-04-19T01:00:13.450
> 
> 标签：javascript, html, node.js, webrtc

我最近在尝试 HTML5 和 WebRTC 的一些很棒的功能，并且正在构建一个允许多人视频聊天的网站。

在我的 PC 上一切正常，HTML5 的媒体捕获就像一个魅力。但是当我在我的 PC 上设置一个视频源，并尝试通过我的 android/iphone/ipad 连接到它时，它就是不起作用。我检查了日志，它表明 RTCIceCandidate 的创建由于某些未知原因而失败：

```
// To be processed as either Client or Server
case "CANDIDATE":
    trace("************important*********", "we get in");
    var candidate = new RTCIceCandidate({candidate: msg.candidate});
    trace("************important*********", JSON.stringify(candidate));
break; 
```

原来第二个日志永远不会出现。

有人有什么想法吗？是因为这些功能目前在移动设备上不可用吗？或者我应该为移动设备做些什么？

哦，这是 IceCandidatem 的回调，它从未被调用：

```
// This function sends candidates to the remote peer, via the node server
var onIceCandidate = function(event) {
    if (event.candidate) {

       trace("openChannel","Sending ICE candidate to remote peer : " +  event.candidate.candidate);
       var msgCANDIDATE = {};
       msgCANDIDATE.msg_type  = 'CANDIDATE';
       msgCANDIDATE.candidate = event.candidate.candidate;
       msgCANDIDATE.peer = server;
       msgCANDIDATE.me = weAreActingAs;
       //trace("openChannel","candidate peer : " + JSON.stringify(event));
       socket.send(JSON.stringify(msgCANDIDATE));

    } else {
       trace("onIceCandidate","End of candidates");
    }
} 
```

服务器在nodejs中。

非常感谢你们！需要你的双手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T03:47:27.957

您应该可以在这里测试设备支持：[http ://www.simpl.info/getusermedia/](http://www.simpl.info/getusermedia/)

我不是 webrtc 方面的专家，但根据以下站点，应该支持 IOS 和 Android：[http](http://updates.html5rocks.com/2012/12/WebRTC-hits-Firefox-Android-and-iOS) ://updates.html5rocks.com/2012/12/WebRTC-hits-Firefox-Android-and-iOS但你需要使用爱立信浏览器

在其中一条评论中，它确实说爱立信浏览器使用了折旧的 ROAP 信号，并且不能用于与（例如）Chrome 的对等通信。一条评论指出，blackbarry 原生浏览器现在支持 getUserMedia，因此 Android 和 iOS 可能会跟进。不过目前没有原生支持。而爱立信浏览器的实现似乎是基于折旧的标准。

# java - 如何通过在 Java 中查询数据库来填充对象构造函数

> ID：16095570
> 
> 赞同：0
> 
> 时间：2013-04-19T01:00:16.943
> 
> 标签：java, resultset

我正在尝试通过查询数据库来创建一个 UserInfo 对象构造函数，但我不断收到该部分的`cannot find symbol`错误`UserInfo thisUserInfo = new UserInfo()`。我正在尝试使用`ResultSet rs`并填写构造函数来为登录的用户创建一个“会话”。

我在这里做错了什么？这是我的代码：

```
private UserInfo getUserInfo(HttpServletRequest request, HttpServletResponse response) throws SQLException {
    String userName = request.getParameter("userName");
    String nullString = null;
    char nullChar = ' ';

    ResultSet rs = null;

    stmt = conn.createStatement();
    String getInfoSQL = "SELECT * FROM " + studentsTable + " WHERE USERNAME = '" + userName + "'";
    rs = stmt.executeQuery(getInfoSQL);
    if(rs.next()) {
        UserInfo thisUserInfo = new UserInfo(rs.getString(userName), rs.getString(passWord), rs.getString(lastName), rs.getString(firstName), rs.getString(age), rs.getString(sex), rs.getString(email));
        rs.close();
        stmt.close();
    } else {
        UserInfo thisUserInfo = new UserInfo(nullString, nullString, nullString, nullString, nullString, nullChar, nullString);
        rs.close();
        stmt.close();
    }
    return thisUserInfo;
} 
```

这是我的 UserInfo 类：

```
public class UserInfo {
private final String userName;
private final String passWord;
private final String lastName;
private final String firstName;
private final String age;
private final char sex;
private final String email;

public UserInfo(String userName, String passWord, String lastName, String firstName, String age, char sex, String email) {
    this.userName = userName;
    this.passWord = passWord;
    this.lastName = lastName;
    this.firstName = firstName;
    this.age = age;
    this.sex = sex;
    this.email = email;
}

public String getUserName() {
    return this.userName;
}
public String getPassWord() {
    return this.passWord;                
}
public String getLastName() {
    return this.lastName;
}
public String getFirstName() {
    return this.firstName;
}
public String getAge() {
    return this.age;    
}
public char getSex() {
    return this.sex;
}
public String getEmail() {
    return this.email;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:09:26.827

您需要`UserInfo`为初学者发布课程的代码。我敢打赌，尽管您没有定义采用这些参数的构造函数。

**编辑**您正在尝试从 a 隐式转换为`String`a`char`我怀疑您做不到。而不是`rs.getString(sex)`尝试`rs.getChar(sex)`。或者，您可以添加一个额外的构造函数，该构造函数接受 a`String`作为 sex 参数。

**编辑**哦，我现在看到了这个问题。您从未定义任何其他变量，例如`passWord`等。这些变量必须是列名的字符串或列索引的整数。

此外，这是不相关的，但永远不要在这样的查询中传递未经处理的输入。您正在为[SQL Injection 敞开心扉](http://en.wikipedia.org/wiki/SQL_injection)。您应该改用[准备好的语句，](http://download.oracle.com/javase/tutorial/jdbc/basics/prepared.html) 或者确保至少转义输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:20:50.570

我对所有事情都不是100％，但这对我来说似乎是错误的......

```
if(rs.next()) {
    // UserInfo is declared within a local context
    UserInfo thisUserInfo = new UserInfo(rs.getString(userName), rs.getString(passWord), rs.getString(lastName), rs.getString(firstName), rs.getString(age), rs.getString(sex), rs.getString(email));
    rs.close();
    stmt.close();
} else {
    // UserInfo is declared within a local context
    UserInfo thisUserInfo = new UserInfo(nullString, nullString, nullString, nullString, nullString, nullChar, nullString);
    rs.close();
    stmt.close();
}
// thisUserInfo does not exist
return thisUserInfo; 
```

应该更像...

```
UserInfo thisUserInfo = null;
if(rs.next()) {
    thisUserInfo = new UserInfo(rs.getString(userName), rs.getString(passWord), rs.getString(lastName), rs.getString(firstName), rs.getString(age), rs.getString(sex), rs.getString(email));
    rs.close();
    stmt.close();
} else {
    thisUserInfo = new UserInfo(nullString, nullString, nullString, nullString, nullString, nullChar, nullString);
    rs.close();
    stmt.close();
}
return thisUserInfo; 
```

请注意，我个人会更喜欢......

```
try {
    stmt = conn.createStatement();
    String getInfoSQL = "SELECT * FROM " + studentsTable + " WHERE USERNAME = '" + userName + "'";
    rs = stmt.executeQuery(getInfoSQL);
    UserInfo thisUserInfo = null;
    if(rs.next()) {
        thisUserInfo = new UserInfo(rs.getString(userName), rs.getString(passWord), rs.getString(lastName), rs.getString(firstName), rs.getString(age), rs.getString(sex), rs.getString(email));
    } else {
        thisUserInfo = new UserInfo(nullString, nullString, nullString, nullString, nullString, nullChar, nullString);
    }
} finally {
    try {
        rs.close();
    } catch (Exception exp) {
    }
    try {
        rs.close();
    } catch (Exception exp) {
        stmt.close();
    }
}
return thisUserInfo; 
```

正如（现在）所指出的那样......`UserInfo`期望参数是a `char`，`sex`但您传递的是a`String`

您应该尝试使用类似的方法从数据库中提取值`String sexValue = rs.getString(sex)`，如果它不为空，请使用`sexValue.getCharAt(0)`.

我也不知道`userName`, `passWord`, `lastName`, `firstName`, `age`,`sex`和`email`是在哪里定义的。这让我有点担心……

# php - 如何检查字段是否为空白？

> ID：16095580
> 
> 赞同：3
> 
> 时间：2013-04-19T01:01:09.767
> 
> 标签：php, html, redirect

所以我在 PHP 中有这段代码，但由于某种我不知道的原因它不起作用：

```
if(!empty($ccle))
{
    header("Location: http://google.com");
}

else
{
    header("Location: http://yahoo.com");
} 
```

我想要的是：如果“ccle”字段为空，则转到 google.com 或者如果“ccle”字段不为空（值在哪里），则转到 yahoo.com

如何让它做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T01:04:49.260

你需要切换它们...

```
if(!empty($ccle))
{
    // Go to Yahoo if $ccle is NOT empty
    header("Location: http://yahoo.com");
}
else
{
    // Else, go to Google
    header("Location: http://google.com");
} 
```

只是为了详细说明。你的`if`说法是……

```
if($ccle IS NOT empty) 
```

PHP 中的感叹号是逻辑**非**运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T01:06:58.923

如果您想在它为空时重定向到 Google，而在它不是时重定向到 Yahoo。然后你会改变：

```
if(!empty($ccle)) 
```

至：

```
if(empty($ccle)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T01:09:16.793

```
if(empty($ccle)) {
    header('Location: http://google.com/');
} else {
    header('Location: http://yahoo.com/');
} 
```

这应该按照您的描述执行。唯一的区别是我删除了感叹号。你的原始代码说如果 ccle 是 ndt 空的，去谷歌。这说如果它是空的去谷歌。

您必须确保在将其他任何内容输出到浏览器之前调用它。如果它仍然无法正常工作，则发布任何错误或输出实际是什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T01:19:42.357

所有其他答案都在现场

我只想添加表示“NOT”的`!`部分`!empty`，所以您输入的内容本质上是“如果该字段不为空，则转到谷歌”而不是“如果该字段为空，则转到去谷歌”

另外，你是如何获得变量的？如果您有类似这样的表格：

```
<input name="ccl" type="text" id="ccl" /> 
```

以及与此类似的东西，用于获取表单内容并将其放入变量中，

```
<?php
//making sure the forms button is pressed
if(isset($_POST["button"])){
//grabbing input and putting into a variable 
$ccl = ($_POST["ccl"]);
}
?> 
```

那么提供的其他答案应该有效

# c# - LINQ 搜索记录直到 parentid = 0

> ID：16095581
> 
> 赞同：-4
> 
> 时间：2013-04-19T01:01:21.203
> 
> 标签：c#, linq

我有一个包含 3 个字段的 C# 列表`ID`：`Name`和`ParentID`. 我将它绑定到树视图。现在我还有一个搜索功能，我想过滤列表并重新绑定树视图。

如果我搜索`child-1-1`，我的 linq 应该能够获得以下记录：`parent-1`, `child-1-1`. 所以我必须获取包含我的搜索文本的记录，而不是获取带有 ID 的记录`ParentID`。所有`ParentID`s(roots) 都有`ParentID`价值`0`，所以我必须继续获取记录，直到`ParentID`is `0`。

数据示例：

```
ID  Name       ParentID
1   parent-1   0
2   parent-2   0
3   child-1-1  1
4   child-1-2  1
5   child-2-1  2 
```

所以我的问题是如何获得 LINQ 表达式来获取如上所述的记录？

我的意思是像`var mydata = from p in this.mylist where...`？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T03:54:06.927

假设您的`List<Node> myList`where`Node`类具有`(Id, ParentId, ...)`基于[https://stackoverflow.com/a/7063002/1594178](https://stackoverflow.com/a/7063002/1594178)变体的属性

```
static IEnumerable<Node> Parents(this IEnumerable<Node> nodes, int startId)
{
    Node node = nodes.Where(n => n.Id = startId).Single();
    yield return node;
    while (node.ParentId != 0)
    {
        node = nodes.Where(n => n.Id = node.ParentId).Single();
        yield return node;
    }
} 
```

填充`mydata`id = 3 的孩子的父母以及该孩子使用

```
var mydata = mylist.Parents(3) 
```

# java - matlab生产服务器能提高性能吗

> ID：16095584
> 
> 赞同：1
> 
> 时间：2013-04-19T01:01:39.333
> 
> 标签：java, performance, matlab, matlab-deployment

我使用 matlab Builder JA 生成 java 代码。我看到运行时间有了很大的增加。

有人告诉我改进的选项之一是 MPS（matlab 生产服务器）。这是一个相当新的功能，我想知道是否有人对此有任何经验，以及它可以提供多少帮助。

谢谢。

# java - 如何根据 ?, ! 分割文本 int 句子数组 和 。在 Java 中？

> ID：16095588
> 
> 赞同：-5
> 
> 时间：2013-04-19T01:02:03.580
> 
> 标签：java, string, sentence

如何根据 ?, ! 分割文本 int 句子数组 和 。在 Java 中？

例如，我想将字符串中的句子存储到一个超大的数组中。myArray[0] = 第 1 句，myArray[1] = 第 2 句等等/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:05:19.463

您可以使用`String.split(regex)`方法，如下所示：

```
String[] sentendes = text.split("(?<=[.!?])\\s*"); 
```

使用*lookbehind*应该可以帮助您保留句后的标点符号。

[这是一个关于 ideone](http://ideone.com/lyCNVO)的小演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:04:43.047

试试这个正则表达式：

```
String[] myArray = "sentence! sentence. sentence?".split("(<=[\\!\\?\\.])\\s*") 
```

解释：

```
(<=       lookbehind, to preserve punctuation as in @dasblinkenlight's answer
[         start category (which would be !, ?, or .)
\\!\\?\\. punctuation (must be escaped)
]         end category
)         end lookbehind
\\s*      any amount of whitespace 
```

# objective-c - 调用类方法并返回目标 c 类别的字典

> ID：16095595
> 
> 赞同：0
> 
> 时间：2013-04-19T01:03:03.003
> 
> 标签：objective-c, class, methods, nsdictionary, anagram

我在我的 x-code 项目中创建了一个类别，如下所示：

```
+ (NSDictionary *)anagramMap {
static NSDictionary *anagramMap;
if (anagramMap != nil)
    return anagramMap;

// this file is present on Mac OS and other unix variants
NSString *allWords = [NSString stringWithContentsOfFile:@"/usr/share/dict/words"
                                               encoding:NSUTF8StringEncoding
                                                  error:NULL];

NSMutableDictionary *map = [NSMutableDictionary dictionary];
@autoreleasepool {
    [allWords enumerateLinesUsingBlock:^(NSString *word, BOOL *stop) {
        NSString *key = [word anagramKey];
        if (key == nil)
            return;
        NSMutableArray *keyWords = [map objectForKey:key];
        if (keyWords == nil) {
            keyWords = [NSMutableArray array];
            [map setObject:keyWords forKey:key];
        }
        [keyWords addObject:word];
    }];
}

anagramMap = map;
return anagramMap;}

  - (NSString *)anagramKey {
NSString *lowercaseWord = [self lowercaseString];

// make sure to take the length *after* lowercase. it might change!
NSUInteger length = [lowercaseWord length];

unichar sortedWord[length];
[lowercaseWord getCharacters:sortedWord range:(NSRange){0, length}];

qsort_b(sortedWord, length, sizeof(unichar), ^int(const void *a, const void *b) {
    unichar c1 = *(const unichar *)a;
    unichar c2 = *(const unichar *)b;
    if (c1 > c2)
        return -1;
    if (c1 < c2)
        return 1;
    return 0;
});

return [NSString stringWithCharacters:sortedWord length:length];} 
```

基本上，这段代码循环遍历 Mac OSx 字典并将其转换为 NSDictionary，其中键是按字母顺序排序的单词，对象是该单词所有字谜的数组。

我想知道的是，如何调用此方法，例如在实现文件的 viewDidLoad 部分中，该部分将分配一个 NSDictionary（或可变）这个创建的排序键和对象数组的字典？基本上在伪代码中我做了类似的事情：

NSMutableArray *englishDictionary = [[NSMutableArray alloc] init]; EnglishDictionary = [NSMutableArray anagramMapScrabble]; //应该意味着现在englishDictionary已经变成了NSDictionary，其中key = sorted word，object是那个sorted word的英文字谜数组

我想我必须在方法中添加一些额外的代码，但我不确定。我们欢迎所有的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:08:56.113

类别是对现有类的修改。它的工作方式与在该类中声明该类别的方法完全相同 - 因为它们是。所以它像其他所有方法一样工作。如果你在 NSObject 上创建一个类别，声明如下：

```
+ (NSDictionary *)anagramMap; 
```

然后这是 NSObject 的一个类方法，你可以这样调用它：

```
NSDictionary* d = [NSObject anagramMap]; 
```

如果您在 NSObject 上创建一个类别，声明如下：

```
- (NSDictionary *)anagramMap; 
```

然后这是 NSObject 的一个方法，你可以这样调用它：

```
NSObject* o = [NSObject new];
NSDictionary* d = [o anagramMap]; 
```

# vba - VBA - 使用 Dim 值获取范围 - 对象 __global 的范围失败

> ID：16095596
> 
> 赞同：1
> 
> 时间：2013-04-19T01:03:04.623
> 
> 标签：vba, excel

我有以下 Dims

```
Dim PlayersStartAt As Integer
Dim PlayersEndAt As Integer

PlayersStartAt = 101
PlayersEndAt = PlayersStartAt + 50

Selection.AutoFill Destination:=Range("B & PlayersStartAt:B & PlayersEndAt"), Type:=xlFillDefault 
```

并想要执行以下代码行。

它与伟大的`Range("B101:B151")`;

我的语法有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T01:04:09.697

改变这个

```
Range("B & PlayersStartAt:B & PlayersEndAt") 
```

至

```
Range("B" & PlayersStartAt & ":B" & PlayersEndAt) 
```

`PlayersStartAt`并且`PlayersEndAt`是变量。您放在引号之间的任何内容都将被视为字符串:)

# php - [IMG] 标签之间的预匹配内容

> ID：16095598
> 
> 赞同：1
> 
> 时间：2013-04-19T01:03:21.053
> 
> 标签：php, regex, preg-match-all

我正在编写一个脚本来检索帖子中的第一个图像链接

`$content = [center]Hello World, this is my house: [img]myhouse.png[/img] blah blah blah blah [/center] This is another house [img]anotherhouse.png[/img] , blah blah blah`

我只想返回“myhouse.png”并将其保存到变量中也`img`应该不区分大小写，这意味着它可以工作`[img]text-here[/img]`或`[IMG]text-here[/IMG]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:32:26.580

这将返回第一张图片：

```
$content = '[center]Hello World, this is my house: [img]myhouse.png[/img] blah blah blah blah [/center] This is another house [img]anotherhouse.png[/img] , blah blah blah';

preg_match('#\[img\]\s*(?P<png>.*?)\s*\[/img\]#i', $content, $m);
echo $m['png']; // myhouse.png 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:32:40.910

这是一个正则表达式：

```
$content = '[center]Hello World, this is my house: [img]myhouse.png[/img] blah blah blah blah [/center] This is another house [img]anotherhouse.png[/img] , blah blah blah';

$pattern = '/\[img\](.*)\[\/img\]/U'; // <-- the U means ungreedy

preg_match_all($pattern, $content, $matches);
var_dump($matches[1]); 
```

解释：

正则表达式匹配一对`[img] ... [/img]`标签之间的所有内容。为了确保它不会匹配第一个`[img]`和最后一个 [/img] 标记之间的所有文本，我使用了*ungreedy*修饰符。

了解有关 PHP 正则表达式语法的[更多信息。](http://php.net/manual/de/reference.pcre.pattern.syntax.php)

# ios - 如何在 RESTkit 0.2 中设置缓存策略

> ID：16095599
> 
> 赞同：4
> 
> 时间：2013-04-19T01:03:32.313
> 
> 标签：ios, restkit

我不清楚如何使用 RESTKit 0.2 API 来设置缓存策略。我每次打开应用程序时都会重新运行一个请求，但我希望它被缓存。如何将缓存策略设置为始终缓存请求？

**更新** 我了解到 RestKit 会自动缓存 Core Data 支持的映射。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T06:43:46.980

缓存由[RKObjectRequestOperation](http://cocoadocs.org/docsets/RestKit/0.24.0/Classes/RKObjectRequestOperation.html)类控制。检查文档的“缓存”部分。

# r - 读取固定宽度格式，其中宽度是从列标题中推断出来的

> ID：16095605
> 
> 赞同：1
> 
> 时间：2013-04-19T01:04:06.713
> 
> 标签：r, dataframe, read.table

我有一个相当奇怪的文件格式需要阅读。它有以空格分隔的列，但列宽必须从标题中推断出来。

此外，还有一些必须忽略的虚假行，包括空白行和非空白行。

数据的表示：

```
The first line contains some text that is not important, and shoud be ignored.
The second line also.  In addition, the third and fifth lines are blank.

       col1          col2    col3  col4     col5

  ab   cd e      132399.4     101     0 17:25:24  Ignore anything past the last named column
       blah        773411      25    10 17:25:25  Ignore this too 
```

这里，第一列 ,`col1`包含从行首到文本字符串结尾的字符位置的文本`col1`。第二列`col2`包含从`1`in之后的下一个字符`col1`到文本字符串结尾的文本`col2`。等等。

实际上，有 17 列而不是 5 列，但这不应该改变代码。

我正在寻找包含以下内容的数据框：

```
 col1     col2 col3 col4      col5
1   ab   cd e 132399.4  101    0  17:25:24
2        blah 773411.0   25   10  17:25:25 
```

这是一个相当不优雅的方法：

```
read.tt <- function(file) {
  con <- base::file(file, 'r')
  readLines(con, n=3);
  header <- readLines(con, n=1)
  close(con)
  endpoints <- c(0L, gregexpr('[^ ]( |$)', header)[[1]])
  widths <- diff(endpoints)
  names <- sapply(seq_along(widths),
                  function(i) substr(header, endpoints[i]+1, endpoints[i]+widths[i]))
  names <- sub('^ *', '', names)
  body <- read.fwf(file, widths, skip=5)
  names(body) <- names
  body
} 
```

一定会有更好的办法。

要忽略的行是这个难题的一小部分。我将接受一种适用于已从文件中删除的解决方案（但当然更喜欢不需要预处理的解决方案）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:39:28.720

如果您知道标题行，则可以使用以下方法获取宽度。

```
x
## [1] "         col1     col2 col3 col4      col5"

nchar(unlist(regmatches(x, gregexpr("\\s+\\S+", x))))
## [1] 13  9  5  5 10 
```

# r - 在 R 中矢量化简单的基于循环的交易系统？

> ID：16095609
> 
> 赞同：0
> 
> 时间：2013-04-19T01:04:23.630
> 
> 标签：r, vectorization, algorithmic-trading

在研究了以下两个链接中使用的矢量化方法后，我尝试创建一个简单的交易策略模板（代码如下所示），该模板可以在 R 中进行矢量化，以实现比基于循环的结构更快的速度。我很难矢量化，因为必须维护和构建变量状态，例如：

1）我使用的信号对于多头和空头并不相互排斥（如在简单的 MA 交叉系统中）。

2) 一旦触发，信号会一直徘徊，直到得到相反的指示（例如 RSI 在 80 以上做空，在 20 以下做多类型系统）。

3) 头寸被持有多个时期，因此不是每个信号都进入或在信号为假后退出的情况（我希望能够像在停止和反转或 SAR 系统中那样只进入一次）。

我认为这是一个简单的示例系统，但它比此处列出的示例要复杂一些：

[http://blog.fosstrading.com/2011/03/how-to-backtest-strategy-in-r.html](http://blog.fosstrading.com/2011/03/how-to-backtest-strategy-in-r.html)

[交易策略测试中的累积回报](https://stackoverflow.com/questions/14912747/cumulative-return-in-trading-strategy-test)

系统逻辑总结：当 zscore 低于（高于）-2 (2) 时，系统开始持平然后在卖出（买入）价格做多（做空）。系统会跟踪绩效统计数据，例如“交易”、“获胜”、关闭的损益（为简单起见，其他省略）。该系统还保持一个运行“公平”，以便在系统运行后进行绘图。

```
# assume vectors bid, ask, and zscore containing those price series respectively
# pos = current position where 1 == long, -1 == short, 0 == flat
# entryP = entry price, pnl = open pnl, cpnl = closed pnl
pos = 0; entryP = 0.0; pnl = 0; cpnl = 0; trades = 0; wins = 0
ub = length(bid)
equity = rep(0, ub)
for (i in 10000:ub) {
pnl = 0
if (pos > 0) pnl = bid[i] - entryP
if (pos < 0) pnl = entryP - ask[i]
if (zscore[i] > 2.0 && pos != -1) { # go short
    if (pos > 0) { # exit long and record pnl
        cpnl = cpnl + pnl
        if (pnl > 0) wins = wins + 1
        trades = trades + 1
        pnl = 0
    }
    pos = -1
    entryP = bid[i]
} else if (zscore[i] < -2.0 && pos != 1) { # go long
    if (pos < 0) { # exit short and record pnl
        cpnl = cpnl + pnl
        if (pnl > 0) wins = wins + 1
        trades = trades + 1
        pnl = 0
    }
    pos = 1
        entryP = ask[i]
    }

    equity[i] = cpnl + pnl
}
# assume close-out of final position
cpnl = cpnl + pnl
if (pnl > 0) wins = wins + 1
if (pos != 0) trades = trades + 1
# plot equity chart and report performance stats
plot(equity, t='l', lwd=3)
cpnl;trades; cpnl / trades; wins/trades 
```

是否可以在 R 中矢量化这个简单的基于循环的均值回归交易系统？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T02:04:05.947

“我很难矢量化，因为必须保持可变状态”

这总结了一切。如果您在任何迭代中的结果取决于先前的迭代，则无法避免循环。

# c - 当您写入超出数组范围的内存时会发生什么？

> ID：16095614
> 
> 赞同：0
> 
> 时间：2013-04-19T01:04:48.053
> 
> 标签：c, arrays, gcc

在最近的一个测试问题中，我被要求打印以下程序的输出。我得到了正确的答案，但是这个程序给我带来了极大的精神痛苦，因为我不知道在写入超出数组范围的内存时会发生什么行为。

这是有问题的程序，评论是我的笔记：

```
#include <stdio.h>

#define MAX 4

void RecordArgs(int x);

int main()
{
    RecordArgs(1);
    RecordArgs(7);
    RecordArgs(-11);
    return 0;
}

void RecordArgs(int x)
{
    static int i = 0;
    int call_count = 0;
    int arg_history[MAX] = {0};
    if (call_count == MAX)
    {
        # call_count is not static and is initialized to 0 on each call
        # as a result, under no circumstance can call_count == MAX and
        # this printf is never executed
        printf("Too many calls to RecordArgs\n");
    }
    else
    {
        # index out of bounds on second/third call (i + call_count will be 4??)  
        arg_history[i + call_count] = x;
        ++call_count;
        ++i;
        for (i = 0; i < MAX; ++i)
            printf("%d ", arg_history[i]);
        printf("\n");
    }
} 
```

和预期的输出：

```
1 0 0 0
0 0 0 0
0 0 0 0 
```

第二次和第三次调用 RecordArgs 时，7 和 -11 值会写入哪里？我尝试在不同的设置下编译它，看看我是否可以让它两次写入它不应该的东西，但我尝试过的一切都导致了没有任何段错误的确切输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:16:50.953

扩展 Patashu 的评论，当您以与内存页面的权限冲突的方式从页面访问内存时，会发生[分段错误。](http://en.wikipedia.org/wiki/Segmentation_fault#Segmentation.2C_page_fault.2C_and_access_violation)换句话说，它们发生在您以不允许的方式访问内存页面时。在您的情况下可能发生的情况是您仍在访问存储在同一页面上的内存`arg_history`，您显然有权读取和写入。

另一种可能的情况是，您正在处理的内存页面之后的内存页面具有相同的权限，允许您以相同的方式访问它。

无论如何，这是 C 语言中未定义的行为。尽管您见证了“预期结果”，但这不应该向您表明该程序是正确的。事实上，在这种情况下，越界错误可能会被忽视，如果它不会导致分段错误的话。

# java - Android 如何获取随机的 sqlite 数据？

> ID：16095619
> 
> 赞同：1
> 
> 时间：2013-04-19T01:05:08.623
> 
> 标签：java, android, sqlite

这是我的 DateBaseHelper 公共游标 getQuestionsFromQuizID(int quizID){

```
 Integer quiz = Integer.valueOf(quizID);

             return myDataBase.rawQuery("select * from Questions where quizID ="+quiz.toString(), null );

     }

     public Cursor getAnswersFromQuestionID(int questionID, int quizID){

             Integer question = Integer.valueOf(questionID);
             Integer quiz = Integer.valueOf(quizID);

             return myDataBase.rawQuery("select * from Answers where questionID = "+question.toString()+" and quizID = "+quiz.toString(), null );
     }

    public Boolean isAnswerCorrect(int answerID) {

            Integer answer = Integer.valueOf(answerID);
            int correctBit;

            Cursor cursor = myDataBase.rawQuery("select * from Answers where _id ="
                            + answer.toString(), null);

            cursor.moveToFirst();
            correctBit = cursor.getInt(3);

            if (correctBit == 1) {
                    return true;
            } else {
                    return false;
            }

    }

    public int getQuestionCountByQuizID(int quizID){

            Integer quiz = Integer.valueOf(quizID);

            Cursor cursor = myDataBase.rawQuery("select * from Questions where quizID ="+quiz.toString(), null);

            cursor.moveToFirst();

            return cursor.getCount();

    } 
```

...我有测验活动的方法

private void getNextQuestion() { 字符串问题；

```
 // set question count text at the top of screen using string
            // concatenation
            Integer currentCount = new Integer(curQuestion + 1);
            ((TextView) findViewById(R.id.questioncount)).setText("Question "
                            + currentCount.toString() + " of "
                            + totalQuestionCount.toString());

            // get quizID based on which button was pressed on PickQuizActivity
            int quizID = getIntent().getExtras().getInt("quizID");

            // use returned cursor to get question as string
            Cursor questionCursor = myDbHelper.getQuestionsFromQuizID(quizID);

            questionCursor.moveToPosition(curQuestion);

            // getString(3): gets the zero-indexed column 2 from current row cursor
            // is on
            question = questionCursor.getString(2);

            // update UI to show question pulled from database
            ((TextView) findViewById(R.id.question)).setText(question);

            Cursor answerCursor = myDbHelper.getAnswersFromQuestionID(
                            curQuestion + 1, quizID);

            // set each answer text, there will always be 4 answers
            // also collect questionID for isCorrect check when onClick is called
            answerCursor.moveToFirst();
            ((TextView) findViewById(R.id.answer1)).setText(answerCursor
                            .getString(4));
            answerID1 = answerCursor.getInt(0);

            answerCursor.moveToNext();
            ((TextView) findViewById(R.id.answer2)).setText(answerCursor
                            .getString(4));
            answerID2 = answerCursor.getInt(0);

            answerCursor.moveToNext();
            ((TextView) findViewById(R.id.answer3)).setText(answerCursor
                            .getString(4));
            answerID3 = answerCursor.getInt(0);

            answerCursor.moveToNext();
            ((TextView) findViewById(R.id.answer4)).setText(answerCursor
                            .getString(4));
            answerID4 = answerCursor.getInt(0);

            // increment question counter, will be used to retrieve next question
            curQuestion++;

            // set flag for last question reached
            if (questionCursor.isLast()) {
                    lastQuestionReached = true;
            }
    } 
```

所以...当我不显示随机问题时，我编辑 sql，只需添加 SORT BY RANDOM() LIMIT 10，我的问题就会与答案混淆...

任何人都可以知道如何获得随机问题而不重复的解决方案吗？以及如何避免混合来自问题和答案的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:13:52.073

您可以在 sqlite 数据中有一个额外的列，如果不使用，则为 0，如果使用，则为 1。我会标记该问题已与 1 一起使用。您可以查询数据库以仅返回该字段为 0 的问题。如果没有可用的问题为 0（它们都已被使用），只需重置所有值该列为 0，所有问题都同样可用。

如果您有多个会话，并且希望确保随着时间的推移，所有问题都得到解决，这将有所帮助。

我假设您将答案存储在与您的问题相同的行中。

我会首先进行查询以获取 1 个未使用的问题/答案对。然后，当然，将其标记为已使用。我会用它作为“问题”。然后我会再次查询 3 或 4 个问题/答案对，不用担心它们是否被使用。选择那些错误的答案，并随机将它们与多项选择题的正确答案混合。

# ruby-on-rails - 未知操作：无法为 CommentsController 找到操作“创建”

> ID：16095623
> 
> 赞同：1
> 
> 时间：2013-04-19T01:05:33.473
> 
> 标签：ruby-on-rails

我正在开发一个允许用户评论单个“作品”的应用程序（想想博客文章）。模型中的关联如下：

```
class User < ActiveRecord::Base
  has_many :works  
  has_many :comments

class Work < ActiveRecord::Base
  belongs_to :user
  has_many :comments

class Comment < ActiveRecord::Base
  belongs_to :user
  belongs_to :post
  belongs_to :work 
```

Works 展示页面上有一个表单，允许用户发表评论：

```
<%= form_for(@comment) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="field">
    <%= f.text_area :content, placeholder: "Post a comment!" %>
  </div>
  <%= f.submit "Post", class: "btn btn-small btn-primary" %>
<% end %> 
```

Works 控制器如下。请注意，我在这里添加了构建评论功能，以便 Works 页面上的表单起作用：

```
class WorksController < ApplicationController
   #before_filter :current_user,   only: [:edit, :update]

  def index
    @works = Work.all
    @comment = @work.comments.build(params[:comment])
    @comment.user = current_user

respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :xml => @works }
end
end
def create
    @work = current_user.works.create(params[:work])
    redirect_to current_user
  end

def edit
    @work = current_user.works.find(params[:id])
end

def new
  @work = current_user.works.new
end

def destroy
  @work = current_user.works.find(params[:id]).destroy
  flash[:success] = "Work deleted"
  redirect_to current_user
end

 def update
    @work = current_user.works.find(params[:id])
    if @work.update_attributes(params[:work])
      flash[:success] = "Profile updated"
      redirect_to @work
    else
      render 'edit'
    end
  end

  def show 
  @work = Work.find(params[:id])
  @comment = @work.comments.build
  @comment.user = current_user
  @activities = PublicActivity::Activity.order("created_at DESC").where(trackable_type: "Work", trackable_id: @work).all
  @comments = @work.comments.order("created_at DESC").where(work_id: @work ).all 
    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @work }
    end
  end
end 
```

最后，这里是 Comments 控制器：

```
class CommentsController < ApplicationController

  before_filter :authenticate_user!

  def index
    @comments = Comment.all
  end

  def show
    @comment = Comment.find(params[:id])
    @activities = PublicActivity::Activity.order("created_at DESC").where(trackable_type: "Comment", trackable_id: @comment).all
   respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @comment }
  end

  def update
     @comment = current_user.comments.find(params[:id])
    if @comment.update_attributes(params[:comment])
      flash[:success] = "Comment updated"
      redirect_to @comment
    end
  end

  def create
    @work = Work.find(params[:id])
    @comment = @work.comments.build(params[:comment])
    @comment.user = current_user
    if @comment.save
      #flash[:success] = "Post created!"
      redirect_to @work
    else
      render 'home#index'
    end
  end
  end
end 
```

当我尝试使用作品展示视图页面上的评论表单提交评论时，我收到以下错误：

**未知操作无法为 CommentsController 找到操作“创建”**

为什么在 Comments 控制器上找不到创建操作？任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:11:37.017

您的评论控制器`show`操作缺少`end`，即：

```
 def show
    @comment = Comment.find(params[:id])
    @activities = PublicActivity::Activity.order("created_at DESC").where(trackable_type: "Comment", trackable_id: @comment).all
   respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @comment }
  end 
```

应该是这样的：

```
 def show
    @comment = Comment.find(params[:id])
    @activities = PublicActivity::Activity.order("created_at DESC").where(trackable_type: "Comment", trackable_id: @comment).all
   respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @comment }
    end
  end 
```

（现在它正在“落入”创建操作中，因此永远不会设置创建操作）。

然后您可能需要更改最终结果：

```
 end
  end
  end
end 
```

成为

```
 end
  end
end 
```

因为这可能是为了“补偿”不匹配并允许页面在 Ruby 中进行预编译。

# javascript - 使用 phantomjs 无头运行 jasmine 规范

> ID：16095634
> 
> 赞同：3
> 
> 时间：2013-04-19T01:06:32.070
> 
> 标签：javascript, ruby-on-rails, jasmine, phantomjs, poltergeist

我一直在使用 jasmine-headless-webkit 在我的 Rails 3.2 应用程序上运行我的 jasmine 规范，但我最近切换到 phantomjs/poltergeist 来运行我的请求规范，所以我需要升级我的 jasmine 测试以在 phantom 上运行。我不想在我的 CI 服务器上使用 xvfb。

有没有人有任何在控制台中使用 phantom 运行 jasmine 测试的好方法？我在网上发现的关于它的信息令人惊讶地少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-08T21:24:32.733

我找到的最简单的解决方案是设置guard-jasmine（[Guard::Jasmine 在 Guard 之外](https://github.com/netzpirat/guard-jasmine#guardjasmine-outside-of-guard)），然后添加`guard-jasmine -u http://localhost:3001/`到您的构建脚本中。在我的詹金斯上工作得很好。您还需要在服务器上安装 phantomJS。就我而言，我还需要 node.js

# jquery - 任何人都知道一个 jQuery 插件来排列像谷歌图像这样的图像？

> ID：16095635
> 
> 赞同：0
> 
> 时间：2013-04-19T01:06:40.420
> 
> 标签：jquery, html, css, plugins

*我不想要砌体。

如果您注意到 Google 图片的工作方式，图片会“调整大小”以在容器内完美对齐。换句话说，右侧和左侧对齐。

当您调整浏览器窗口的大小时，图像会调整以保持外观。

我对图像加载到页面上的方式感兴趣，而不是单击它们后会发生什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:43:53.307

我用这个：[http ://webdesignledger.com/tutorials/create-a-resizable-image-grid-with-jquery](http://webdesignledger.com/tutorials/create-a-resizable-image-grid-with-jquery)

然后将这些元素中的每一个放入带有砖石的容器中。

此外，我的每个图像都具有相同的高度但不同的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T07:57:40.420

我写了一个 jQuery 插件，它使用随机大小的元素创建一个完美的网格 - 如果你愿意，你可以控制大小。它的工作是填补来自砖石或同位素布局的任何空白。可以是流动的或静态的，支持排水沟，还允许严格的打字尺寸。

[https://github.com/DrewDahlman/Mason](https://github.com/DrewDahlman/Mason)

一个例子 - [https://drewdahlman.com/experiments/mason/example/fluid_gutters.html](https://drewdahlman.com/experiments/mason/example/fluid_gutters.html)

需要注意的是，它需要填充块，可以根据需要进行设置，否则它会从网格中复制和复制随机块。

# forms - symfony2 构建表单实体 oneToMany

> ID：16095639
> 
> 赞同：0
> 
> 时间：2013-04-19T01:06:58.643
> 
> 标签：forms, symfony, doctrine, entity, builder

我正在学习 symfony 框架并且有一个大问题。

我有两个数据库表：类别（主键：categoryid）和产品（主键：productid 和外键：categoryid）。

在控制器中添加一个“editAction”用于编辑产品数据（包括字段 category_categoryid）并保存在数据库中。

表单必须包含一个类别下拉列表，用于对产品进行分类。

编码：

ORM yml 中的关系

实体：产品...

```
manyToOne:
 category:
  targetEntity: Category
   inversedBy: products
   joinColumn:
    name: category_categoryid 
    referencedColumnName: categoryid 
```

实体：类别...

```
oneToMany:
 products:
  targetEntity: Product
   mappedBy: category 
```

形式/类型 产品类型

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
...

$builder->add('category_categoryid', 'entity',
array('class' => 'SysCatalogoBundle:Category',

'property' => 'name',));

...
} 
```

产品控制器

```
public function editAction(Request $request)
{
$id = 1;
$em = $this->getDoctrine()->getManager();
$products= $em->getRepository('SysCatalogoBundle:Product')->find($id);
$form = $this->createForm(new ProductType(), $products);

...
} 
```

该视图使用元素中的类别列表呈现表单，但未选择产品类别（保存在 DB 中）。我证明使用类型“query_builder”但不起作用，也尝试使用类“新类别”也不起作用。如果我将“选择”类型与更简单的数组 (array(1,2,3)) 一起使用，则选择该类别。

哪个可能是问题？ORM实体的关系？我遵循官方 symfony2 文档。

非常感谢您的帮助！（对不起我的英语）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T05:39:19.413

我认为 Symfony 的官方文档中几乎涵盖了解决方案。 [http://symfony.com/doc/current/book/doctrine.html#add-mapping-information](http://symfony.com/doc/current/book/doctrine.html#add-mapping-information)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:45:25.880

您没有在表单构建器中使用 orm 映射。尝试将 Form/Type ProductType 更改为：

```
public function buildForm(FormBuilderInterface $builder, array $options) { 
...

    $builder->add('category', 'entity', array());

... 
} 
```

# css - 使用纯 CSS 切换文本显示：hover 伪类

> ID：16095644
> 
> 赞同：4
> 
> 时间：2013-04-19T01:07:35.180
> 
> 标签：css

当有人将鼠标悬停在文本上时，我希望文本完全改变。我在网上找到了应该可以工作的代码，但它没有。有什么建议么？

```
<span class="show">
     <p>if {&nbsp;<br /></p>
     <p>yourSite < awesome;&nbsp;<br /></p>
     <p>solution = aislingDouglas (HTML5 + CSS3 +&nbsp;<br /></p>
     <p>JavaScript + PHP);&nbsp;<br /></p>
     <p>}&nbsp;<br /></p>
     <p>else {&nbsp;<br /></p>
     <p>solution = null;&nbsp;<br /></p>
     <p>}&nbsp;</p>
 </span>

 <span class="noshow">
     <p>Need a website? &nbsp;<br /></p>
     <p>You found your dream developer!&nbsp;<br /></p>
     <p>And hey - I already helped you on the web,&nbsp;<br /></p>
     <p>why not let me help you&nbsp;<br /></p>
     <p>build an amazing site!&nbsp;<br /></p>
 </span> 
```

这是CSS：

```
.noshow, p:hover .show { display: none }
p:hover .noshow { display: inline } 
```

我不反对使用 JavaScript（欢迎提出编码建议），但我更希望它保留在 CSS 中。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T02:49:24.933

你有正确的想法，有点...

目标是拥有一个包含两个文本部分的容器元素。
当该元素被鼠标悬停时，它被分配为 pseudoclass `:hover`。使用此选择器，您可以适当地重新设置子项（下方`.first`和`.second`）的样式。

请注意，我已经使用`<span>`了文本和`<p>`下面的父级，但是如果您想使用**块级**子级（如更多`<p>`元素）来执行此操作，那么您应该使用`<div>`作为父级。

[http://jsfiddle.net/G28qz/](http://jsfiddle.net/G28qz/)

HTML：

```
<p class="hovertext">
    <span class="first">This is what you see first</span>
    <span class="second">But this shows up on mousehover</span>
</p> 
```

CSS：

```
/* Hide the second piece of text by default */
p.hovertext .second {
     display:none;
}

/* Hide the first piece of text on hover */
p.hovertext:hover .first {
     display:none;
}

/* Re-show the second piece of text on hover */
p.hovertext:hover .second {
    display:inline;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T02:56:38.713

我想你想要这样的东西：

```
<div class="wrap">
    <div class="show">
        <p>if {&nbsp;</p>
        <p>yourSite
            < awesome;&nbsp; </p>
                <p>solution = aislingDouglas (HTML5 + CSS3 +&nbsp;</p>
                <p>JavaScript + PHP);&nbsp;</p>
                <p>}&nbsp;</p>
                <p>else {&nbsp;</p>
                <p>solution = null;&nbsp;</p>
                <p>}&nbsp;</p>
    </div>
    <div class="noshow">
        <p>Need a website? &nbsp;</p>
        <p>You found your dream developer!&nbsp;</p>
        <p>And hey - I already helped you on the web,&nbsp;</p>
        <p>why not let me help you&nbsp;</p>
        <p>build an amazing site!&nbsp;</p>
    </div>
</div> 
```

使用以下 CSS：

```
.wrap {
    outline: 1px dotted blue;
    height: 300px;
}
.noshow, .wrap:hover .show {
    display: none
}
.wrap:hover .noshow {
    display: block
} 
```

您需要一个外部容器来包装将打开和关闭的两个块。

为了获得最佳效果，请为外包装设置一个高度，否则您可以获得摆动的显示/隐藏效果，因为面板会由于文本数量的不同而自行调整大小，这意味着鼠标可能不会在面板上被显示，因此悬停状态将立即恢复为非悬停，从而重新触发显示/隐藏效果。

小提琴：http: [//jsfiddle.net/audetwebdesign/zAt7f/](http://jsfiddle.net/audetwebdesign/zAt7f/)

# android - AsyncTask 在开始时挂起

> ID：16095645
> 
> 赞同：1
> 
> 时间：2013-04-19T01:07:37.067
> 
> 标签：android, android-asynctask

`AsyncTask`在 Android 4.x 中运行良好，但不适用于 Android 2.3.6。我已经使用物理移动设备逐步调试了 Android 2.3.6。

它挂在这里：

```
myTask = new GetDataFromServer(); 
```

`GetDataFromServer`是 的类`AsyncTask`。

这是怎么回事？

下面是我的代码，我在代码中只使用了 1 个 AsyncTask 并从服务器接收到消息。就这样。

```
class GetDataFromServer extends AsyncTask<String, String, String>
{

    protected void onPreExecute ()
    {

        progressDialog1=ProgressDialog.show(MainActivity.this, "Loading data", "Please wait...",true);
    }
    protected String doInBackground(String... params)
    {

        String resulttxt="";
        try {

            serverIp = InetAddress.getByName("192.168.1.123");

            int serverPort=31000;

            Socket clientSocket=new Socket(serverIp,serverPort);

            BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(clientSocket.getOutputStream()));
            bw.write(params[0]);
            bw.flush();

            BufferedReader  br=new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

            resulttxt=br.readLine();
            if(resulttxt.contains("OK"))
            {
                publishProgress(resulttxt);

            }
            else
            {
                publishProgress(resulttxt);
                clientSocket.close(); 
                bw.close();
                br.close();
                return null;

            }
            resulttxt="";
            resulttxt=br.readLine();
            resulttxt=resulttxt.trim();

            clientSocket.close(); 

        } catch (IOException e) {

            if(Status_txt!=null)
                Status_txt.append( "Server is done.");
        }
        catch (NetworkOnMainThreadException e){
            if(Status_txt!=null)
                Status_txt.append( "NetworkOnMainThreadException");
        }

        return resulttxt;

    }
    protected void onProgressUpdate(String...inStr){

        String[] strData=inStr[0].split("_");
        String szTemp="Last Purchase Date: ";

        szTemp+=strData[1];

        szTemp+="  ,Valid days: ";
        szTemp+=strData[2];
        //Status_txt.setText(szTemp);
        if(Status_txt!=null)
            Status_txt.setText("You Are The Super User");

    }
    protected void onPostExecute(String data) {
        tl_prediction2.removeAllViews();

        if (data == null)
        {

        }
        else {

            if((data.contains("#")==true) || (data.contains("*")==true) 
                    ||data.contains("&")==true)
            {

                String[] arrayTmp=data.split("#");
                for(Integer i=0;i<arrayTmp.length;i++)
                {
                    String[] SubArrayTmp=arrayTmp[i].split("_");

                    tl_prediction2.addView(generateRow(4,SubArrayTmp));

                }
            }

        }
        progressDialog1.dismiss();
    }

}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T03:05:55.343

由于您没有发布任何代码，我只能给您一些随机可能的解决方案：

1.  可能是您的 AsyncTask 需要花费大量时间来下载。尝试使用`android.os.Process.setThreadPriority(9)`inside增加其优先级`doInBackground()`

2.  检查您的代码中是否还有其他先前运行的长 AsyncTask。默认情况下，AsyncTask 在单个后台线程上运行。这意味着除非您之前的 AsyncTask 完成，否则您的 AsyncTask 任务不会被执行。为了允许并行执行使用`executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, params)`. [你可以在这里](https://stackoverflow.com/questions/4068984/running-multiple-asynctasks-at-the-same-time-not-possible)阅读更多

3.  检查清单中的 Internet 和其他权限。这主要是人们犯错误的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:16:41.330

AsyncTask 与 ThreadPool 一起工作。如果执行的同步任务太多，后面的 AsyncTask 会被其他人阻塞。我认为您可以使用 DDMS 中的线程工具来检查正在执行的 ayncTask 数量。

# php - 页面重定向到错误的位置

> ID：16095648
> 
> 赞同：0
> 
> 时间：2013-04-19T01:08:17.863
> 
> 标签：php, session

我不确定我对我的代码做了什么，但出于某种原因，我到 updatestore.php 的链接将我带到了 admin/index.php。下面的两个文件都位于 localhost/portal/admin 中，但我无法理解导致不良行为的原因。我的 session_start() 变量位于 ../login.php 中。我测试了从该文件中取出 session_start 并且我的所有其他链接都开始以相同的方式运行 - 他们只会将我带到 admin/index.php 而不是他们应该去的地方。我对该怎么做感到沮丧。

这是 updatestore.php

```
<?php
    require ("../login.php");

    if ($_SESSION['admin'] != 1)
        header('Location: ../index.php');

    if (isset($_POST['submit'])) {
        $_SESSION['store'] = $_POST['store'];
        header('Location:updatestore2.php');
    }

    include ("header.php");
    include ("adminnav.php");

?>

    <h2>Update Store</h2>

    <?php
        $stmt = $db->prepare("SELECT short_name FROM store ORDER BY short_name");
        $stmt->execute();
        $rows = $stmt->fetchAll();
        $num_rows = count($rows);
        if ($num_rows == 0)
            echo '<p>There are no store\'s currently in the system.';
        else { ?>
            <form action="" method="post">
                <ul>
                    <li>
                        <b>Select Store To Edit:</b><br>
                        <select name="store">
                        <?php
                        foreach($rows as $row) {
                            echo '<option value ="'. $row['short_name'] . '">' . $row['short_name'] . '</option>';  
                        }   ?>
                        </select>
                    </li>
                    <li>
                        <br><input type="submit" value="Select Store" name ="submit" id="submit">
                    </li>
                </ul>
            </form>
<?php    } ?>

<?php   
    include ("footer.php");
?> 
```

这是另一个正常工作的页面，addshortages.php

```
<?php
    require ("../login.php");

    if ($_SESSION['admin'] != 1)
        header('Location: ../index.php');

    $success = false;

    if (isset($_POST['submit'])) {
        $_SESSION['store'] = $_POST['store'];
        header('Location: addshortages2.php');
    }

    include ("header.php");
    include ("adminnav.php");

?>

    <h2>Update Shortages List</h2>

    <?php
        if (!empty($errors))
            foreach($errors as $error)
                echo $error;

        if ($success == true)
            echo '<p>The FAQ has succesfully been submitted!</p>';
    ?>

    <?php

        $stmt = $db->prepare("SELECT * FROM store ORDER by short_name");
        $stmt->execute();
        $rows = $stmt->fetchAll();
        $num_rows = count($rows);

    ?>
    <?php if ($success == false) { ?>
            <form action="" method="post">
                <ul>
                    <li>
                        <b>Select Store To Modify Shortages:</b><br>
                        <select name="store">
                        <?php
                        foreach($rows as $row) {
                            echo '<option value ="'. $row['short_name'] . '">' . ($row['short_name']) . '</option>';  
                        }   ?>
                        </select>
                    </li>
                    <li>
                        <br><input type="submit" value="Select Store" name ="submit" id="submit">
                    </li>
                </ul>
            </form>
<?php       } ?>

<?php   
    include ("footer.php");
?> 
```

我也有尝试注销页面的问题，但他们也只是将我带到 admin/index.php。注销将 ?logout=1 附加到 GET 变量，但它没有做它应该做的事情。

索引.php

```
<?php
    require ("login.php");
    require_once ('Bcrypt.php');

    if ((isset($_GET['logout'])) == 1) {
        session_destroy();
        header('Location: ../index.php');
    }

    if (isset($_SESSION['user'])) {
        if ($_SESSION['admin'] == 1)
            header('Location: admin/index.php');
        else
            header('Location: customer/index.php');
    }

    if (isset($_POST['submit'])) {
        if ((empty($_POST['email'])) || (empty($_POST['password']))) 
            $errors[] = 'Please fill out all fields of the registration process.<br>';
        else {
            $email = trim($_POST['email']);
            $password = trim($_POST['password']);

            $stmt = $db->prepare("SELECT * FROM users WHERE email=:email");
            $stmt->bindValue(':email', $email, PDO::PARAM_STR);
            $stmt->execute();
            $rows = $stmt->fetchAll();
            $num_rows = count($rows);
            if ($num_rows) {
                foreach($rows as $row) {
                    $result = Bcrypt::checkPassword($password,$row['password']);
                    if ($result) {
                        $_SESSION['user'] = $row['id'];
                        $_SESSION['admin'] = $row['admin'];
                        $_SESSION['name'] = $row['name'];
                        $_SESSION['email'] = $row['email'];
                        if ($_SESSION['admin'] == 1)
                            header('Location: admin/index.php');
                        else
                            header('Location: customer/index.php');
                    }
                    else
                        $errors[] = 'Your password is incorrect. Please try again.';
                }
            }
            else
                $errors[] = 'We do not have a record of your credentials in our system. To register go <a href="register.php">here</a>. ';
        }

    }

    include ("header.php");
    include ("subnav.php");
?>

    <h2>System Log-In</h2>

    <?php
        if (!empty($errors))
            foreach($errors as $error)
                echo $error;
    ?>

    <form action="" method="post">
        <ul>
            <li>
                <b>E-Mail:*</b> <br>
                <input type="text" name="email"></li>
            <li>
                <b>Password:*</b> <br>
                <input type="password" name="password">
            </li>
            <li>
                <br><input type="submit" value="Log-In" name ="submit" id="submit">
            </li>
            <li>
                <br><a href="register.php">Activate Account Here.</a>
            </li>
            <li>
                If you are having problems with the log-in process, please send us an <a href="mailto:jayl@jays.us">e-mail</a>.
            </li>
        </ul>
    </form>

<?php   
    include ("footer.php");
?> 
```

我已经在 IE、Firefox 和 Chrome 上测试过这种情况。updatestore.php 文件仅不适用于 Firefox。我不知道为什么会这样。此外，对于 IE 和 Chrome，我必须在页面注销并转到相应位置之前两次单击注销链接。我在这里拉头发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:29:54.893

更改：
`header('Location:updatestore2.php');`
至：
`header('Location:http://google.com');`
并查看它是否正确重定向。
如果是这样，那么您的问题在于`updatestore2.php`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:18:22.473

这行代码在两个页面中，但看起来它只是将您重定向到 index.php。

```
if ($_SESSION['admin'] != 1)
        header('Location: ../index.php'); 
```

但是，我不知道这是否是问题所在。

功能页面有以下内容：

```
$success = false; 
```

* * *

这可能会导致问题 #2：

```
if ((isset($_GET['logout'])) == 1) {
        session_destroy();
        header('Location: ../index.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:15:04.993

正确的格式是使用绝对 URL，例如：

```
 header('Location: http://www.site.com/index.php'); 
 header('Location: http://www.site.com/admin/updatestore2.php'); 
```

`/`但是如果你不在你的 url 中放一个它会起作用，浏览器将重定向到当前文件夹的文件。

为了从管理员内部定位索引，

```
 header('Location: /index.php'); 
```

从 admin 内部定位到 admin/updatestore2.php：

```
 header('Location: updatestore2.php'); 
```

这些应该工作

# c# - ASP MVC过滤器，在哪里实现接口？

> ID：16095650
> 
> 赞同：3
> 
> 时间：2013-04-19T01:08:26.100
> 
> 标签：c#, asp.net, asp.net-mvc, filter, action-filter

只是想知道，谷歌搜索如何在 asp mvc 4 中使用过滤器。我发现有些人这样定义它们：

```
public class CustomFilter : ActionFilterAttribute 
```

还有一些是这样的：

```
public class CustomFilter : ActionFilterAttribute, IActionFilter 
```

ActionFilterAttribute 已经有所有要覆盖的操作，为什么还要实现接口呢？

同样例如在下一个代码中，最后再次调用过滤器，这是为什么呢？

```
public class 

CustomActionFilter : ActionFilterAttribute, IActionFilter
{
    void IActionFilter.OnActionExecuting(ActionExecutingContext filterContext)

    {
        // TODO: Add your acction filter's tasks here

        // Log Action Filter Call
        MusicStoreEntities storeDB = new MusicStoreEntities();

        ActionLog log = new ActionLog()
        {
            Controller = filterContext.ActionDescriptor.ControllerDescriptor.ControllerName,
            Action = filterContext.ActionDescriptor.ActionName + " (Logged By: Custom 

Action Filter)",
            IP = filterContext.HttpContext.Request.UserHostAddress,
            DateTime = filterContext.HttpContext.Timestamp
        };

        storeDB.ActionLogs.Add(log);
        storeDB.SaveChanges();

        this.OnActionExecuting(filterContext);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:13:57.127

如果您检查[ActionFilterAttribute 的 MSDN 定义，](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionfilterattribute%28v=vs.108%29.aspx)您将看到它是一个继承接口*IActionFilter*和*IResultFilter*的抽象类。

实际上继承自*ActionFilterAttribute*，

```
public class CustomFilter : ActionFilterAttribute 
```

相当于继承类 *FilterAttribute*和接口*IActionFilter*和*IResultFilter*

```
public class CustomFilter : FilterAttribute, IActionFilter, IResultFilter 
```

和没有什么不同

```
public class CustomFilter : ActionFilterAttribute, IActionFilter, IResultFilter 
```

因此，从*ActionFilterAttribute继承与从**ActionFilterAttribute*和*IActionFilter*继承没有什么不同。

# c - 使用 TCP 写入远程文件

> ID：16095651
> 
> 赞同：0
> 
> 时间：2013-04-19T01:08:34.430
> 
> 标签：c, networking, network-programming

我正在为一个项目开发服务器/客户端程序，以便它能够正常工作，我需要在客户端上使用`fopen`它`fprintf`。服务器将从 USB 操纵杆（轴旋转）获取实时数据输出，并通过 TCP 将该信息发送到客户端，然后客户端将该信息写入文件。我已按照[此](http://en.wikibooks.org/wiki/C_Programming/Networking_in_UNIX)教程进行 TCP 设置并使其正常工作。我能够将消息从服​​务器发送到客户端。如何`fprintf(fp, "2=%d\n", zAxis)`从服务器获取命令并将其发送到客户端以写入文件？也许我忽略了一些简单的事情来完成这个。我不知道从哪里开始，如果我可以将`zAxis`变量从服务器发送到客户端，我想我可以从那里弄清楚。

这是我的代码

服务器.C

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/socket.h>

#define PORTNUM 2343

int main(int argc, char *argv[])
{

    char msg1[10];
        printf("Please enter info\n");
        fgets(msg1, 20, stdin);

    struct sockaddr_in dest; /* socket info about the machine connecting to us */
    struct sockaddr_in serv; /* socket info about our server */
    int mysocket;            /* socket used to listen for incoming connections */
    socklen_t socksize = sizeof(struct sockaddr_in);

    memset(&serv, 0, sizeof(serv));           /* zero the struct before filling the fields */
    serv.sin_family = AF_INET;                /* set the type of connection to TCP/IP */
    serv.sin_addr.s_addr = htonl(INADDR_ANY); /* set our address to any interface */
    serv.sin_port = htons(PORTNUM);           /* set the server port number */    

    mysocket = socket(AF_INET, SOCK_STREAM, 0);

    /* bind serv information to mysocket */
    bind(mysocket, (struct sockaddr *)&serv, sizeof(struct sockaddr));

    /* start listening, allowing a queue of up to 1 pending connection */
    listen(mysocket, 1);
    int consocket = accept(mysocket, (struct sockaddr *)&dest, &socksize);

    while(consocket)
    {
        printf("Incoming connection from %s - sending welcome\n", inet_ntoa(dest.sin_addr));
        send(consocket, msg1, strlen(msg1), 0); 
        consocket = accept(mysocket, (struct sockaddr *)&dest, &socksize);
    }

    close(consocket);
    close(mysocket);
    return EXIT_SUCCESS;
}` 
```

客户端.C

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/socket.h>

#define MAXRCVLEN 500
#define PORTNUM 2343

int main(int argc, char *argv[])
{
   char buffer[MAXRCVLEN + 1]; /* +1 so we can add null terminator */
   int len, mysocket;
   struct sockaddr_in dest; 

   mysocket = socket(AF_INET, SOCK_STREAM, 0);

   memset(&dest, 0, sizeof(dest));                /* zero the struct */
   dest.sin_family = AF_INET;
   dest.sin_addr.s_addr = inet_addr("192.168.254.16"); /* set destination IP number */ 
   dest.sin_port = htons(PORTNUM);                /* set destination port number */

   connect(mysocket, (struct sockaddr *)&dest, sizeof(struct sockaddr));

   len = recv(mysocket, buffer, MAXRCVLEN, 0);

   /* We have to null terminate the received data ourselves */
   buffer[len] = '\0';

   printf("Received %s (%d bytes).\n", buffer, len);

   close(mysocket);
   return EXIT_SUCCESS;
} 
```

# vba - 如何在 MS Word 中编写 VBA 宏以在表格中插入饼图

> ID：16095659
> 
> 赞同：0
> 
> 时间：2013-04-19T01:09:36.980
> 
> 标签：vba, ms-word

我正在尝试在 MS Word 中编写一个 VBA 宏，该宏创建一个在特定单元格内插入饼图的表格。饼图的数据将由宏请求。以下是我到目前为止的内容，但我很难弄清楚如何在表格内创建饼图。

```
Sub InsertChart()
' Inserts a custom chart

Dim data1 As Variant
data1 = InputBox("What was the Moving Water damage value (enter as 0.0 - 1.0).")

Dim data2 As Variant
data2 = InputBox("What was the Settlement damage value (enter as 0.0 - 1.0).")

Dim data3 As Variant
data3 = InputBox("What was the Pre-Exisiting damage value (enter as 0.0 - 1.0).")

Dim i As Integer

i = ActiveDocument.Tables.Count
i = i + 1

' Create table if there is more than 1 table
ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=5, NumColumns:=2
ActiveDocument.Tables(i).Cell(1, 2).Split NumColumns:=3
ActiveDocument.Tables(i).Cell(1, 3).Range.Text = "Quantity (Measurable Area):"
ActiveDocument.Tables(i).Cell(2, 1).Range.Text = "Description:"
ActiveDocument.Tables(i).Cell(3, 1).Range.Text = "Analysis:"
ActiveDocument.Tables(i).Cell(4, 1).Range.Text = "Cause(s) of Damage:"
ActiveDocument.Tables(i).Cell(5, 1).Range.Text = "Recommended Repairs:"

With ActiveDocument.Tables(i)
    .Borders(wdBorderTop).LineStyle = wdLineStyleSingle
    .Borders(wdBorderLeft).LineStyle = wdLineStyleSingle
    .Borders(wdBorderBottom).LineStyle = wdLineStyleSingle
    .Borders(wdBorderRight).LineStyle = wdLineStyleSingle
    .Borders(wdBorderHorizontal).LineStyle = wdLineStyleSingle
    .Borders(wdBorderVertical).LineStyle = wdLineStyleSingle
End With

Dim small As Boolean
small = False
Dim twoSeries As Boolean
twoSeries = False
Dim pieChart As Boolean
pieChart = True

Dim salesChart As Chart
Dim chartWorkSheet As Excel.Worksheet

With ActiveDocument.Tables(i)
    .Borders(wdBorderTop).LineStyle = wdLineStyleSingle
    .Borders(wdBorderLeft).LineStyle = wdLineStyleSingle
    .Borders(wdBorderBottom).LineStyle = wdLineStyleSingle
    .Borders(wdBorderRight).LineStyle = wdLineStyleSingle
    .Borders(wdBorderHorizontal).LineStyle = wdLineStyleSingle
    .Borders(wdBorderVertical).LineStyle = wdLineStyleSingle
End With

' Add in a new chart
Set salesChart = ActiveDocument.InlineShapes.AddChart.Chart
Set chartWorkSheet = salesChart.ChartData.Workbook.WorkSheets(1)

' Resize the chart area
chartWorkSheet.ListObjects("Table1").Resize chartWorkSheet.Range("A1:B4")

' Rename Series 1 as Sales
chartWorkSheet.Range("Table1[[#Headers],[Series 1]]").FormulaR1C1 = "Damage"

' Add data to the chart
chartWorkSheet.Range("A2").FormulaR1C1 = "Moving Water"
chartWorkSheet.Range("A3").FormulaR1C1 = "Settlement"
chartWorkSheet.Range("A4").FormulaR1C1 = "Pre-Exisiting"
chartWorkSheet.Range("B2").FormulaR1C1 = data1
chartWorkSheet.Range("B3").FormulaR1C1 = data2
chartWorkSheet.Range("B4").FormulaR1C1 = data3

' Quit Excel, since we no longer need it
salesChart.ChartData.Workbook.Application.Quit

' Put a box around the legend
salesChart.Legend.Format.Line.Visible = msoCTrue

' Fill the background with theme color accent 1
With salesChart.ChartArea.Format.Fill
    .Visible = msoTrue
    .Solid
    .ForeColor.ObjectThemeColor = wdThemeColorAccent1
End With

' Add a title and format it
salesChart.HasTitle = True
With salesChart.ChartTitle
    .Characters.Font.Italic = True
    .Characters.Font.Size = 18
    .Characters.Font.color = RGB(0, 0, 100)
    .Text = "Damage"
End With

If small Then
' Size and move the chart
With salesChart.Parent
    .Left = 100
    .Width = 300
    .Height = 150
End With
End If

If pieChart Then
' Set chart type
    salesChart.ChartType = xl3DPie
End If

'Move chart to specific cell
ActiveDocument.Tables(i).Cell(1, 1).Select
Selection.Cut

ActiveDocument.Tables(i).Cell(4, 2).Select
Selection.Paste

ActiveDocument.Tables(i).Cell(1, 1).Range.Text = "Location:"

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:30:22.860

尝试这个

```
salesChart.CopyPicture
salesChart.Delete
tbl.Cell(1, 1).Range.Select
Selection.PasteAndFormat (wdChartPicture)
Selection.Tables(1).AutoFitBehavior (wdAutoFitContent) 
```

在最后一个之后`End If`和之前添加这个`End Sub`

**截屏**

![在此处输入图像描述](https://i.stack.imgur.com/bYMp8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T05:51:06.863

在我看来，将这一行放在前面就足够了`End Sub`：

```
salesChart.Parent.ConvertToInlineShape 
```

它将图表从形状转换为将位于表格内的内联形状。我确实对空文档进行了测试，它可以满足您的要求。

您可以稍后将此行添加到自动调整单元格/列：

```
ActiveDocument.Tables(1).Columns(1).AutoFit 
```

**编辑**转换为表 1 中的某个单元格。

以这种方式进行转换：

```
Dim InSHP As InlineShape
Set InSHP = salesChart.Parent.ConvertToInlineShape
InSHP.Range.Cut
ActiveDocument.Tables(1).Cell(4, 2).Range.Paste 
```

# java - 在 AudioTrack 中播放随机短数组没有任何结果

> ID：16095660
> 
> 赞同：0
> 
> 时间：2013-04-19T01:09:45.117
> 
> 标签：java, android

我想知道 Audiotrack 是如何工作的，所以我生成了一个长度为 60000 的随机短数组，并尝试用 AudioTrack 播放它：

```
public short[] generatedNoise=new short[60000];
for(int i=0;i<=59999;i++){
                generatedNoise[i]=(short) random.nextInt(Short.MAX_VALUE + 1);
            }
AudioTrack  at=new AudioTrack(AudioManager.STREAM_MUSIC, 48000, AudioFormat.CHANNEL_OUT_MONO,
                        AudioFormat.ENCODING_PCM_16BIT, 48000*7 /* 1 second buffer */,
                        AudioTrack.MODE_STREAM);
                at.write(generatedNoise, 0, generatedNoise.length);
                at.play(); 
```

但是扬声器什么也没输出，我的控制台中也没有错误消息。我尝试使用这种方法播放 wav 文件并且效果很好，有人可以告诉我原因吗？我的目标是从扬声器中输出一些噪音。

更新：我刚刚使用以下代码生成了一个短数组，但仍然没有输出：

```
 short[] wave=new short[100000];

          int i=0;
          while(i<=99997){
              wave[i]=32767;
              wave[i+1]=0;
              wave[i+2]=-32767;
              wave[i+3]=0;
              i=i+4;
          } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:00:16.700

问题解决了，对于缓冲区大小，我只是将其更改为数组的实际大小，并且工作正常。感谢您的关注。

# bash - 带有日期时间戳的 Bash mkdir

> ID：16095661
> 
> 赞同：0
> 
> 时间：2013-04-19T01:10:15.787
> 
> 标签：bash, date, mkdir

为了创建一个包含一些信息、服务器名称和日期的目录，我使用：

```
mkdir ~/abcd-$(home -f)-$(date +"Y%m%d%H%M%S") 
```

试图得到`~/abcd-servername-20130418210802`

我`?`最后得到一个。如果我使用一个变量和一个子字符串（即`{STR1:0:29}`）函数，我会得到一个或多个`?`. 真的只是一个烦恼，但想知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:27:10.147

您的目录名称中有“非图形”字符。从手册页`ls`：

> -q 强制将文件名中的非图形字符打印为字符“？”；这是输出到终端时的默认设置。

此外，正如您所说，您的目录似乎存在一些问题。你`Y`应该`%Y`和你`home`应该是`hostname`（但你没有说明你的操作系统）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-27T11:39:28.677

在 openSUSE 42.3 上测试：

```
NEWCOMPUTER=`uname -n`
THEDATE=`date +%Y%m%d%H%M%S`
mkdir ~/Desktop/computers/$NEWCOMPUTER-$THEDATE 
```

# python - 对齐整数（基本python）

> ID：16095662
> 
> 赞同：0
> 
> 时间：2013-04-19T01:10:25.550
> 
> 标签：python

嘿伙计们，我需要一些帮助来对齐我的整数。我将向您展示我的代码是什么，我的输出是什么，以及我希望我的输出是什么。谢谢！

代码：

```
test_sign='#'
test_numbers=[100000,5000000,7000000]
test_calc_list=[]
test_sum=sum(test_numbers)
test_list=['Testcase1','Testcase2','Testcase3']
test_sign_list=[]

for x in test_numbers:
    test_calc=round((x/float(test_sum)*10))
    test_calc_list.append(test_calc)

for y in test_calc_list:
    y=int(y)
    signs=y*test_sign
    test_sign_list.append(signs)

for z in range(len(test_list)):
    print "%8s"%test_list[z]+":",test_sign_list[z],test_numbers[z] 
```

输出：

```
Testcase1:  100000
Testcase2: #### 5000000
Testcase3: ###### 7000000 
```

期望的输出：

```
Testcase1:         100000
Testcase2: ####   5000000
Testcase3: ###### 7000000 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:18:27.930

选项一，以格式指定长度：

[http://docs.python.org/2/library/string.html#format-specification-mini-language](http://docs.python.org/2/library/string.html#format-specification-mini-language)

“宽度是定义最小字段宽度的十进制整数。如果未指定，则字段宽度将由内容确定。”

选项二，使用 ljust、rjust 和 center 预填充字符串：

[http://docs.python.org/2/library/string.html#string.ljust](http://docs.python.org/2/library/string.html#string.ljust)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T01:24:48.997

这可能是学习`{}`-formatting 的好时机，而不是更深入地学习（不完全弃用，但不鼓励）`%`-formatting。

`%`特别是因为您使用的唯一格式似乎不正确。（没有充分的理由使用`%8s`您知道将是 9 个字符长的字符串……）

所以：

```
print '{}: {:<6} {:>7}'.format(test_list[z], test_sign_list[z], test_numbers[z]) 
```

有关所有选项的详细信息，请参阅[字符串格式](http://docs.python.org/2/library/string.html#string-formatting)。

* * *

作为旁注，我认为您的循环以这种方式更具可读性：

```
for test, sign, number in zip(test_list, test_sign_list, test_numbers):
    print '{}: {:<6} {:>7}'.format(test, sign, number) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T01:21:58.700

改变

```
print "%8s"%test_list[z]+":",test_sign_list[z],test_numbers[z] 
```

至

```
print "%8s: %-6s %7i" % (test_list[z], test_sign_list[z], test_numbers[z]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T01:18:23.277

```
strings = ["abc", "sakjfslkdfnds", "7"]
maxlength = max(map(len, strings))
for index, string in enumerate(strings):
  print("Testcase%d: %s" % (index, string.rjust(maxlength, "."))) 
```

省略“。” 如果您只想要空格，请争论。

# php - WordPress php文件中的DOMDocument？

> ID：16095663
> 
> 赞同：1
> 
> 时间：2013-04-19T01:10:27.240
> 
> 标签：php, wordpress

我正在 WordPress 中编辑 wp-comments-post.php 文件。我尝试在非 wordpress 程序中运行以下代码，它返回了[http://mysmallwebpage.com/](http://mysmallwebpage.com/)网站中的所有 URL。但是当我将以下代码放入 wp-comments-post.php 文件时，`DOMDocument`似乎不起作用。如果我在这里做错了什么，请告诉我。

```
if ( 'abc' == $comment_content )//if the comment page only have the letters abc
{
    $html = file_get_contents("http://mysmallwebpage.com/");
    $dom = new DOMDocument;
    @$dom->loadHTML($html);    
    $links = $dom->getElementsByTagName('a');

    foreach ($links as $link)
    {       
       $returnLink =  $link->getAttribute('href');
       if (strpos($returnLink, 'http') === 0) //To check if the line contain the keyword 'http'
       {
           $returnLink = "<a href=\"$returnLink\">$returnLink</a>";
           array_push($URL_List, (string)$returnLink);
           //I inserted the following wordpress termination code to see if it contain at least one element
           wp_die( __('<strong>ERROR</strong>: Program Reached here! ') );
       }
    }
    //if I put wp_die( …… ), It works in this location. Just not above.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:52:09.770

根据发帖人在[这个问题](https://stackoverflow.com/questions/16094933/php-code-in-wordpress-page-template-doesnt-execute)中解决问题的方式，尝试使用`wp_remote_get`而不是`file_get_contents`. 尝试解决问题时不要禁用错误检查；这很可能`loadHTML`是失败的，因为`file_get_contents`没有返回任何东西，但是使用 at-sign 会剥夺你的这些信息。

# java - Spring MVC RESTful 多视图 - 404 未找到

> ID：16095666
> 
> 赞同：0
> 
> 时间：2013-04-19T01:10:38.147
> 
> 标签：java, spring-mvc, view, restful-architecture

我有一个以 JSP 作为视图的 Web 应用程序。但现在我正在尝试在同一个 Web 应用程序中实现 RESTful。我创建了一个新控制器，我的 RESTful 将在哪里（我不确定它是否有意义）。

我在互联网上找到了一些示例，并且我一直在尝试按照这些示例制作我的 RESTful。

当我访问我的 RESTful URL 时，它返回给我**404 Not Found**。我在stackoverflow中查看了一些类似的问题，并尝试更改一些XML配置，但到目前为止它不起作用。

```
当我访问：
网址：localhost:8080/restfultest/rest/suggestions/11
返回我：404。

当我访问：
网址：localhost:8080/restfultest/loginForm
向我返回正确的 JSP 页面。

```

我想，也许我需要设置 XML 以兼容这两种类型，RESTful 和一个常见的 Web 应用程序，但我不确定，也不知道具体该怎么做。

感谢并遵循我的代码：

我的 web.xml

```
<servlet>

    <servlet-name>springmvc</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>

    <init-param>

        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring-context.xml</param-value>

    </init-param>

    <load-on-startup>1</load-on-startup>

</servlet>

<servlet-mapping>
    <servlet-name>springmvc</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

弹簧上下文.xml

```
 <context:component-scan base-package="com.restfultest." />

    <mvc:annotation-driven />

    <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
        <property name="contentType" value="application/json"/>
    </bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="messageConverters">
            <util:list id="beanList">
                <ref bean="jsonMessageConverter"/>
            </util:list>
        </property>
    </bean>

    <bean id="jsonMessageConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"/>

    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/views/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

    <mvc:interceptors>

        <bean class="com.restfultest.interceptor.AutorizadorInterceptor"></bean>
        <bean class="com.restfultest.interceptor.ConnectionInterceptor"></bean>

    </mvc:interceptors>

<mvc:resources location="/resources/" mapping="/resources/**" /> 
```

控制器

```
public class SuggestionController {

    @Autowired
    private SuggestionService suggestionService;

    @Autowired
    private View view;

    private static final String DATA_FIELD = "data";
    private static final String ERROR_FIELD = "error";

    private static final String CONTENT_RANGE_HEADER = "Content-Range";
    private static final String ACCEPT_JSON = "Accept=application/json";

    @RequestMapping(value = "/rest/suggestions/{suggestionId}", method = RequestMethod.GET, headers=ACCEPT_JSON)
    public ModelAndView getSuggestion(@PathVariable("suggestionId") String suggestionId) {

        Suggestion suggestion = null;

        if (isEmpty(suggestionId) || suggestionId.length() < 5) {
            String sMessage = "Error invoking getSuggestion - Invalid suggestion Id parameter";
            return createErrorResponse(sMessage);
        }

        try {

            suggestion = suggestionService.getSuggestionById(suggestionId);

        } catch (Exception e) {
            String sMessage = "Error invoking getSuggestion. [%1$s]";
            return createErrorResponse(String.format(sMessage, e.toString()));
        }

        return new ModelAndView(view, DATA_FIELD, suggestion);
    }

    private ModelAndView createErrorResponse(String sMessage) {
        return new ModelAndView(view, ERROR_FIELD, sMessage);
    }

    public static boolean isEmpty(String s_p) {
        return (null == s_p) || s_p.trim().length() == 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:53:40.813

问题是您的 SuggestionController 上应该有一个 @Controller 注释，因此 Spring 会将其视为控制器（它也应该在 com.restfultest 包中）。

现在我不确定这是否重要，但在你拥有的 spring-context.xml 中

```
 <context:component-scan base-package="com.restfultest." /> 
```

我从来没有见过它的末尾有一个点。因此，您可能会考虑将其删除，但它可能不会产生影响。

# java - Java 迭代器不适用于单个可迭代对象

> ID：16095668
> 
> 赞同：0
> 
> 时间：2013-04-19T01:10:42.653
> 
> 标签：java, foreach, iterator, iterable

我遇到了迭代器的问题。我正在编写一个自定义链表，因为它使用迭代器来遍历列表。

迭代器如下所示：

```
public class NodeIterator implements Iterator<Node> {
private Node current = head;
private Node lastReturned = head;

public boolean hasNext() {
    return lastReturned.getLink() != null;
}

public Node next() {
    lastReturned = current;
    current = current.getLink();
    return lastReturned;
}

public void remove() {
    removeNode(lastReturned);
    lastReturned = null;
}
} 
```

我仍处于早期阶段，因此我正在通过使用此方法填充节点来从控制台测试数据结构。

```
private static void MethodToPopulateNodes() {
MyObject o = new MyObject();
String[] responses = new String[prompts.length];
scanner = new Scanner(System.in);

boolean done = false;
String s = null;

while (!done) {
    int i = 0;
    for (String prompt : prompts) {
        System.out.println(prompt);
        s = scanner.nextLine();
        if (s.equalsIgnoreCase("stop")) {
            done = true;
            break;
    } else {
        responses[i] = s;
    }
        i++;
    }
    if (done) {
        break;
    }
        o = new MyObject(responses);
        myNode.add(c);
}
} 
```

当我在只有一个节点时尝试使用迭代器时，它什么也没做。没有错误或任何东西。但是，如果我有多个节点，则此 foreach 可以完美运行。

```
public static void main(String[] args) {
myNode = new Node();

methodToPopulateLinkedList();

for (Node node : myNode) {
        //toString is overridden for my object
    System.out.println(node.getData().toString());
}

} 
```

更新：我编辑了迭代器以`hasNext() == true`在第一次迭代时返回：

```
public class NodeIterator implements Iterator<Node> {
private boolean done = false;
private Node current = head;
private Node lastReturned = head;

public boolean hasNext() {
    if (head == tail && head != null && !done) {
    done = true;
    return true;
    }
    return lastReturned.getLink() != null;
}

public Node next() {
    lastReturned = current;
    current = current.getLink();
    return lastReturned;
}

public void remove() {
    removeNode(lastReturned);
    lastReturned = null;
}
} 
```

我觉得那是超级笨拙的，但它有效。似乎 Java`hasNext()`在调用 next 之前先调用，所以我必须以不同的方式处理特殊情况。

|123

```
hasNext() == true
next() == 1 
```

1|23

```
hasNext() == true
next() == 2 
```

12|3

where`|`等于光标。那准确吗？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:15:09.990

如果只有一个节点，则它的 ->next 为空的特殊情况。在循环之前，尝试打印出第一个节点，我认为您的循环可能正在向前看。

# mysql - MySQL 查询具有非常长的列和表列表

> ID：16095673
> 
> 赞同：0
> 
> 时间：2013-04-19T01:11:17.837
> 
> 标签：mysql, sql

我的数据库包含一个`tab0`具有两列`id`和`mjd`的表，以及数千个表`tab1`......`tabM`具有五列，`id`，`A`，`B`，`C`和`D`。这些列包含数千个元素。

获得这样的东西的最佳方法是什么？

```
+-----+-------------+-------------+-------------+
| mjd | A (of tab_1)| A (of tab_2)| A (of tab_m)|
+-----+-------------+-------------+-------------+
|  1  | 123         | 423         | 523         |
|  2  | 233         | 243         | 633         |
| ... | ...         | ...         | ...         |
|  n  | 353         | 343         | 753         |
+-----+-------------+-------------+-------------+ 
```

我可以从中获取列和表的列表， `INFORMATION_SCHEMA`然后使用它来构造我的查询，例如

```
SELECT t0.mjd, t1.A, t2.A, ... tM.A FROM tab0 as t0, tab1 as t1, ... tabM as tM 
WHERE  t0.id=t1.id and ... and t0.id=tM.id; 
```

或者这是一种完全疯狂的方法？

# vb.net - 我的二进制到十进制转换器有问题

> ID：16095676
> 
> 赞同：-2
> 
> 时间：2013-04-19T01:11:30.857
> 
> 标签：vb.net

当我输入一个二进制数时，它会在 messagebox.show 中给我多个结果。

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim s As String
    Dim a, b, c As Long
    a = CLng(Val(TxtBoxInput.Text))
    s = TxtBoxInput.Text
    TxtBoxInput.Clear()

    For i = 1 To Len(s) Step 1
        b = CLng(Mid(s, i, 1))
        c = Len(s) - i
        b = CLng(Val(b) * (2 ^ c))
        TxtBoxInput.Text = CStr(MessageBox.Show(CStr(Val(TxtBoxInput.Text) + b)))
    Next i
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:19:12.777

您将使用[MsgBox 方法](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.interaction.msgbox%28v=vs.100%29.aspx)。从您的示例中不确定结果是您想要展示的地方。

```
MsgBox("Information Here", MsgBoxStyle.Information, "MyTitle") 
```

* * *

*根据评论编辑*

将您的 MessageBox 放在循环之外，如下所示：

```
Dim s, temp As String
Dim a, b, c As Long

a = CLng(Val(TxtBoxInput.Text))
s = TxtBoxInput.Text
TxtBoxInput.Clear()
For i = 1 To Len(s) Step 1
    b = CLng(Mid(s, i, 1))
    c = Len(s) - i
    b = CLng(Val(b) * (2 ^ c))
    temp = CStr(Val(temp) + b)
 Next i

MessageBox.Show(temp) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T03:16:04.997

```
Dim s As String
Dim a, b, c As Long
a = CLng(Val(TxtBoxInput.Text))
s = TxtBoxInput.Text
TxtBoxInput.Clear()

For i = 1 To Len(s) Step 1
    b = CLng(Mid(s, i, 1))
    c = Len(s) - i
    b = CLng(Val(b) * (2 ^ c))
    TxtBoxInput.Text = CStr(Val(TxtBoxInput.Text) + b)
Next i 
```

MSGBOX(TXTBOXINPUT)

# c# - 在 Uint64 中打包和解包多个整数

> ID：16095679
> 
> 赞同：1
> 
> 时间：2013-04-19T01:11:50.800
> 
> 标签：c#, .net, int

需要将以下内容打包解包成 UInt64
UInt25
UInt5
UInt7
UInt27

具有以下用于将 UInt27 和 UInt5 打包和解包到 UInt32
但我无法通过 2
我的背景是数学（不是计算机科学）

```
UInt32 highlow;
UInt32 high;
byte  low;
int two27 = (Int32)Math.Pow(2, 27);
for (UInt32 i = 0; i < two27; i++)
{
    highlow = ((UInt32)i) << 5;
    high = highlow >> 5;
    if (high != i)
    {
        Debug.WriteLine("high wrong A " + high.ToString() + " " + i.ToString());
    }
    for (byte j = 0; j < 32; j++)
    {
        highlow = (((UInt32)i) << 5) | j;
        high = highlow >> 5;
        if (high != i)
        {
            Debug.WriteLine("high wrong B " + high.ToString() + " " + i.ToString());
        }
        low = (byte)(highlow & 0x1f);
        if (low != j)
        {
            Debug.WriteLine("low wrong " + low.ToString() + " " + j.ToString());
        }
    }               
} 
```

基于接受答案的代码（没有测试 i27 循环达到 2 的完整循环）

```
UInt32 bits27;
UInt32 bits25;
UInt32 bits7;
UInt32 bits5;
UInt32 int27 = (UInt32)Math.Pow(2,27);
UInt32 int25 = (UInt32)Math.Pow(2,25);
UInt32 int7  = (UInt32)Math.Pow(2,7);
UInt32 int5  = (UInt32)Math.Pow(2,5);
UInt64 packed;
//ulong packed = (bits27) | ((ulong)bits25 << 27) | ((ulong)bits7 << 52) | ((ulong)bits5 << 59);
for             (UInt32 i27 = 0; i27 < int27; i27++)
{
    for         (UInt32 i25 = 0; i25 < int25; i25++)
    {
        for     (UInt32  i7 = 0;  i7 <  int7; i7++)
        {
            for (UInt32  i5 = 0;  i5 <  int5; i5++)
            {
                packed = (UInt64)(i27) | ((UInt64)i25 << 27) | ((UInt64)i7 << 52) | ((UInt64)i5 << 59);

                bits27 = (UInt32)(packed & ((1 << 27) - 1));
                bits25 = (UInt32)((packed >> 27) & ((1 << 25) - 1));
                bits7 =  (UInt32)((packed >> 52) & ((1 << 7) - 1));
                bits5 =  (UInt32)((packed >> 59) & ((1 << 5) - 1));
                if (bits27 != i27) Debug.WriteLine("bits27 != i27");
                if (bits25 != i25) Debug.WriteLine("bits25 != i25");
                if (bits7  != i7)  Debug.WriteLine("bits7  !=  i7");
                if (bits5  != i5)  Debug.WriteLine("bits5  !=  i5");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T01:19:53.107

移位运算符是正确的解决方案，但请注意，它们不会自动使结果比输入更宽——您需要转换输入。

盒：

```
ulong packed = (bits27) | ((ulong)bits25 << 27) | ((ulong)bits7 << 52) | ((ulong)bits5 << 59); 
```

打开包装：

```
bits27 = (uint) (packed        & ((1 << 27) - 1));
bits25 = (uint)((packed >> 27) & ((1 << 25) - 1));
bits7  = (uint)((packed >> 52) & ((1 <<  7) - 1));
bits5  = (uint)((packed >> 59) & ((1 <<  5) - 1)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:16:52.113

似乎将数字转换为二进制、填充或截断到正确的长度、连接它们然后从二进制构造您的 64 位类型会容易得多。

```
var packedInt64 = Convert.ToInt64(Convert.ToString(ui25, 2).PadLeft(25, '0') +
                                  Convert.ToString(ui5, 2).PadLeft(5, '0') +
                                  Convert.ToString(ui7, 2).PadLeft(7, '0') +
                                  Convert.ToString(ui27, 2).PadLeft(2, '0'), 2); 
```

解包：

```
var binary = Convert.ToString(packedInt64, 2);
ui25 = Convert.ToUInt32(binary.Substring(0, 24));
ui5 = Convert.ToUInt32(binary.Substring(24, 5));
etc. 
```

# r - 在匹配的 A、B 和 *closest* C 上合并数据帧？

> ID：16095680
> 
> 赞同：14
> 
> 时间：2013-04-19T01:12:08.603
> 
> 标签：r

我有两个这样的数据框：

```
set.seed(1)
df <- cbind(expand.grid(x=1:3, y=1:5), time=round(runif(15)*30))
to.merge <- data.frame(x=c(2, 2, 2, 3, 2),
                       y=c(1, 1, 1, 5, 4),
                       time=c(17, 12, 11.6, 22.5, 2),
                       val=letters[1:5],
                       stringsAsFactors=F) 
```

我想合并`to.merge`到`df`(with `all.x=T`) 中，这样：

*   `df$x == to.merge$x`和
*   `df$y == to.merge$y`和
*   `abs(df$time - to.merge$time) <= 1`; 在满足多个的情况下`to.merge`，我们选择最小化这个距离的那个。

**我怎样才能做到这一点？**

所以我想要的结果是（这只是为匹配行添加`df`了相应`value`的列`to.merge`）：

```
 x y time val
1  1 1    8  NA
2  2 1   11   c
3  3 1   17  NA
4  1 2   27  NA
5  2 2    6  NA
6  3 2   27  NA
7  1 3   28  NA
8  2 3   20  NA
9  3 3   19  NA
10 1 4    2  NA
11 2 4    6  NA
12 3 4    5  NA
13 1 5   21  NA
14 2 5   12  NA
15 3 5   23   d 
```

在哪里`to.merge`：

```
 x y time val
1 2 1 17.0   a
2 2 1 12.0   b
3 2 1 11.6   c
4 3 5 22.5   d
5 2 4  2.0   e 
```

注意 - (2, 1, 17, a) 不匹配，`df`因为对于 (X, Y) = (2, 1)，`time`17 与 11 的距离大于 1 。`df$time`

此外，有两行`to.merge`满足匹配`df`'s (2, 1, 11) 行的条件，但是选择了 'c' 行而不是 'b' 行，因为它`time`最接近 11。

最后，可能有一些行`to.merge`与`df`.

* * *

一种可行的方法是 for 循环，但我的数据需要很长时间（`df`有 ~12k 行和`to.merge`~250k 行）

```
df$value <- NA
for (i in 1:nrow(df)) {
    row <- df[i, ]
    idx <- which(row$x == to.merge$x &
                 row$y == to.merge$y &
                 abs(row$time - to.merge$time) <= 1)
    if (length(idx)) {
        j <- idx[which.min(row$time - to.merge$time[idx])]
        df$val[i] <- to.merge$val[j]
    }
} 
```

我觉得我可以以某种方式进行合并，例如：

```
to.merge$closest_time_in_df <- sapply(to.merge$time,
                                  function (tm) {
                                     dts <- abs(tm - df$time)
                                     # difference must be at most 1
                                     if (min(dts) <= 1) {
                                         df$time[which.min(dts)]
                                     } else {
                                         NA
                                     }
                                  })
merge(df, to.merge,
      by.x=c('x', 'y', 'time'),
      by.y=c('x', 'y', 'closest_time_in_df'),
      all.x=T) 
```

但这不会合并该`(2, 1, 11)`行，因为`to.merge$closest_time_in_df`for`(2, 1, 11.5, c)`是 12，但是 12 in 的时间`df`对应于 (x, y) = (2, 5) 而不是 (2, 1) 因此合并失败。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-19T01:54:01.227

使用`data.table`and`roll='nearest'`或 限制为 1，`roll = 1, rollends = c(TRUE,TRUE)`

例如

```
library(data.table)
# create data.tables with the same key columns (x, y, time)
DT <- data.table(df, key = names(df))
tm <- data.table(to.merge, key = key(DT))

# use join syntax with roll = 'nearest'

tm[DT, roll='nearest']

#     x y time val
#  1: 1 1    8  NA
#  2: 1 2   27  NA
#  3: 1 3   28  NA
#  4: 1 4    2  NA
#  5: 1 5   21  NA
#  6: 2 1   11   c
#  7: 2 2    6  NA
#  8: 2 3   20  NA
#  9: 2 4    6   e
# 10: 2 5   12  NA
# 11: 3 1   17  NA
# 12: 3 2   27  NA
# 13: 3 3   19  NA
# 14: 3 4    5  NA
# 15: 3 5   23   d 
```

您可以通过设置`roll=-1`和`rollends = c(TRUE,TRUE)`

```
new <- tm[DT, roll=-1, rollends  =c(TRUE,TRUE)]
new
    x y time val
 1: 1 1    8  NA
 2: 1 2   27  NA
 3: 1 3   28  NA
 4: 1 4    2  NA
 5: 1 5   21  NA
 6: 2 1   11   c
 7: 2 2    6  NA
 8: 2 3   20  NA
 9: 2 4    6  NA
10: 2 5   12  NA
11: 3 1   17  NA
12: 3 2   27  NA
13: 3 3   19  NA
14: 3 4    5  NA
15: 3 5   23   d 
```

或者你可以先roll=1，然后roll=-1，然后合并结果（整理来自第二个rolling join的val.1列）

```
new <- tm[DT, roll = 1][tm[DT,roll=-1]][is.na(val), val := ifelse(is.na(val.1),val,val.1)][,val.1 := NULL]
new
    x y time val
 1: 1 1    8  NA
 2: 1 2   27  NA
 3: 1 3   28  NA
 4: 1 4    2  NA
 5: 1 5   21  NA
 6: 2 1   11   c
 7: 2 2    6  NA
 8: 2 3   20  NA
 9: 2 4    6  NA
10: 2 5   12  NA
11: 3 1   17  NA
12: 3 2   27  NA
13: 3 3   19  NA
14: 3 4    5  NA
15: 3 5   23   d 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-19T02:26:34.603

使用`merge`几次`aggregate`一次，这里是如何做到的。

```
set.seed(1)
df <- cbind(expand.grid(x = 1:3, y = 1:5), time = round(runif(15) * 30))
to.merge <- data.frame(x = c(2, 2, 2, 3, 2), y = c(1, 1, 1, 5, 4), time = c(17, 12, 11.6, 22.5, 2), val = letters[1:5], stringsAsFactors = F)

#Find rows that match by x and y
res <- merge(to.merge, df, by = c("x", "y"), all.x = TRUE)
res$dif <- abs(res$time.x - res$time.y)
res
##   x y time.x val time.y dif
## 1 2 1   17.0   a     11 6.0
## 2 2 1   12.0   b     11 1.0
## 3 2 1   11.6   c     11 0.6
## 4 2 4    2.0   e      6 4.0
## 5 3 5   22.5   d     23 0.5

#Find rows that need to be merged
res1 <- merge(aggregate(dif ~ x + y, data = res, FUN = min), res)
res1
##   x y dif time.x val time.y
## 1 2 1 0.6   11.6   c     11
## 2 2 4 4.0    2.0   e      6
## 3 3 5 0.5   22.5   d     23

#Finally merge the result back into df
final <- merge(df, res1[res1$dif <= 1, c("x", "y", "val")], all.x = TRUE)
final
##    x y time  val
## 1  1 1    8 <NA>
## 2  1 2   27 <NA>
## 3  1 3   28 <NA>
## 4  1 4    2 <NA>
## 5  1 5   21 <NA>
## 6  2 1   11    c
## 7  2 2    6 <NA>
## 8  2 3   20 <NA>
## 9  2 4    6 <NA>
## 10 2 5   12 <NA>
## 11 3 1   17 <NA>
## 12 3 2   27 <NA>
## 13 3 3   19 <NA>
## 14 3 4    5 <NA>
## 15 3 5   23    d 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-19T12:05:15.867

[mnel 的答案](https://stackoverflow.com/a/16095985/3817004)`roll = "nearest"`在连接中使用，`data.table`但不限于 OP 要求的 +/- 1。此外，[MichaelChirico 建议](https://stackoverflow.com/questions/16095680/merge-dataframes-on-matching-a-b-and-closest-c#comment64251902_16095985)使用该`on`参数。

这种方法使用

*   `roll = "nearest"`,
*   *通过引用*更新，即不复制，
*   `setDT()`强制 data.frame`data.table`不复制（2014-02-27 引入 v.1.9.2 of `data.table`），
*   用于显式设置密钥的`on`参数（在 2015-09-19 与 v.1.9.6 中引入）。

所以，下面的代码

```
library(data.table)   # version 1.11.4 used
setDT(df)[setDT(to.merge), on  = .(x, y, time), roll = "nearest",
          val := replace(val, abs(x.time - i.time) > 1, NA)]
df 
```

已更新`df`：

> ```
>  x y time  val
>  1: 1 1    8 <NA>
>  2: 2 1   11    c
>  3: 3 1   17 <NA>
>  4: 1 2   27 <NA>
>  5: 2 2    6 <NA>
>  6: 3 2   27 <NA>
>  7: 1 3   28 <NA>
>  8: 2 3   20 <NA>
>  9: 3 3   19 <NA>
> 10: 1 4    2 <NA>
> 11: 2 4    6 <NA>
> 12: 3 4    5 <NA>
> 13: 1 5   21 <NA>
> 14: 2 5   12 <NA>
> 15: 3 5   23    d 
> ```

请注意，行的顺序没有改变（与[钦梅帕蒂尔的回答](https://stackoverflow.com/a/16096226/3817004)相反）

如果`df`不能更改，可以创建一个新的 data.table

```
result <- setDT(to.merge)[setDT(df), on  = .(x, y, time), roll = "nearest",
                .(x, y, time, val = replace(val, abs(x.time - i.time) > 1, NA))]
result 
```

它返回与上面相同的结果。

# c# - 为什么 Moq 看不到在 .Select 方法中调用此方法？

> ID：16095682
> 
> 赞同：1
> 
> 时间：2013-04-19T01:12:18.490
> 
> 标签：c#, moq

我创建了这个要点来描述正在发生的事情：

[https://gist.github.com/IanRandall/5417410](https://gist.github.com/IanRandall/5417410)

简要说明： .Verify 断言在存储库上的 .Get() 方法的第一个实现中失败，因为 Moq 没有注意到正在调用映射器。

还有人看到这个吗？我错过了什么吗？

干杯:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:17:04.123

经典的 IEnumerable 概念错误。

您将使用 linq 查询返回一个迭代器。迭代器实际上不会调用该函数，直到您对其进行迭代。

如果你这样做（例如），你应该会看到它工作，因为它强制迭代：

```
return results.Select(entity => _mapper.Transform(entity)).ToList(); 
```

# c++ - g ++致命错误在代码块ubuntu上没有输入文件

> ID：16095683
> 
> 赞同：0
> 
> 时间：2013-04-19T01:12:24.253
> 
> 标签：c++, ubuntu, build, codeblocks

我是代码块的新手，在尝试构建时遇到以下错误。

`g++ fatal error no input file`

不知道这意味着什么。我尝试在项目属性中设置执行目录，但没有成功，我遇到了这个错误。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-19T05:13:38.917

你创建了什么类型的项目？

创建一个这样的项目

`File->New->Project`并选择`Console Application`模板

# javascript - 尽管 responsetext 是有效的.net webservice，但响应 xml 为空

> ID：16095688
> 
> 赞同：0
> 
> 时间：2013-04-19T01:13:36.890
> 
> 标签：javascript, ajax, asp.net-web-api

我有一个用 .NET 编写的小型 Web 服务，如下所示 -

```
[WebMethod]  
public XmlDocument GetInfo(string key)  
{  
       //do stuff  
       string final = "<finalURL>" +"sample"+"</finalURL>";  
       XmlDocument doc = new XmlDocument();  
       doc.LoadXml(final);  
       return doc;    
} 
```

浏览器中的 Web 服务响应 - [http://i.stack.imgur.com/yBryl.png](http://i.stack.imgur.com/yBryl.png)

我正在像这样的简单Javascript中使用这个网络服务 -

```
xmlhttp=new XMLHttpRequest();  
xmlhttp.onreadystatechange=function()  
{  
  if (xmlhttp.readyState == 4 && xmlhttp.status == 200)  
  {  
   alert("REsponse Text = " + xmlhttp.responseText); //this is fine  
   //alert(xmlhttp.responseXML);  // does not even open the alert box, is null
  }  
};  
xmlhttp.open("GET","http://localhost:64400/WebService.asmx/GetInfo?key="+str,true);  
xmlhttp.setRequestHeader("Content-Type", "text/xml");  
xmlhttp.send(); 
```

responseText 很好，但 responseXML 始终为空。我已经发送了内容类型，并通过验证我的浏览器是否能够读取 Web 服务响应来检查是否返回了有效的 xml。

[http://i.stack.imgur.com/3rg4J.png](http://i.stack.imgur.com/3rg4J.png)

这是来自 IE9 的 xmlhttpRequest 对象本身（它在 responseBody 中有一些非 unicode 字符）-

```
xmlhttp 
[object XMLHttpRequest] {
    ontimeout : null,
    responseBody : 㼼浸⁬敶獲潩㵮ㄢ〮•湥潣楤杮∽瑵ⵦ∸㸿਍昼湩污剕㹌慳灭敬⼼楦慮啬䱒>,
    timeout : 0,
    onload : null,
    onreadystatechange : function()    {    if (xmlhttp.readyState == 4 && xmlhttp.status == 200)      {    alert("REsponse Text = " + xmlhttp.responseText);   parser = new DOMParser();   xmlDoc = parser.parseFromString(xmlhttp.responseText, "text/xml");      alert(xmlDoc);      path =,
    readyState : 4,
    responseText : "<?xml version="1.0" encoding="utf-8"?>  <finalURL>sample</finalURL>",
    responseXML : ,
    status : 200,
    statusText : "OK"
    ...
} 
```

我究竟做错了什么？任何帮助是极大的赞赏。

Webservice 修改为使用 UTF-16 -

```
string final = "<root>"+"<finalURL>" + "sample" + "</finalURL>" + "</root>";
XmlDocument doc = new XmlDocument();
doc.LoadXml(final);

XmlDeclaration xmldecl;
xmldecl = doc.CreateXmlDeclaration("1.0", "UTF-16", null);
XmlElement root = doc.DocumentElement;
doc.InsertBefore(xmldecl, root);
return doc; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T21:31:04.940

哎呀！终于想通了。
出于某种原因，仅访问 responseXML 会导致错误。
但是在访问 XML 中实际需要的元素时，没有错误，我能够访问该元素。
以下将有助于更好地说明我所做的。
我稍微更改了 Web 服务端的 XML，以包含我正在寻找的字符串作为值属性 -

```
[WebMethod]
public XmlDocument GetInfo(string key)
{
    //do stuff  
    string final = "<root>"+"<finalURL value=\"" + "sample" + "\"></finalURL>" + "</root>";
    XmlDocument doc = new XmlDocument();
    doc.LoadXml(final);
    return doc;
} 
```

我在 javascript 中访问了 XML 的 value 属性，如下所示 -

```
xmlhttp=new XMLHttpRequest();
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState == 4 && xmlhttp.status == 200)
    {
    alert("REsponse Text = " + xmlhttp.responseText 
        + "\n---------------\n"
        + "ResponseXML value = "+xmlhttp.responseXML.getElementsByTagName("finalURL")[0].getAttribute("value"));
    }
  };
xmlhttp.open("GET","http://localhost:64400/WebService.asmx/GetInfo?key="+str,true);
xmlhttp.setRequestHeader("Content-Type", "text/xml");
xmlhttp.send(); 
```

它奏效了。！-
[http://i.stack.imgur.com/u5ySS.png](http://i.stack.imgur.com/u5ySS.png)

# android - MapView 和 GoogleMap 在同一个应用程序中

> ID：16095692
> 
> 赞同：0
> 
> 时间：2013-04-19T01:14:08.603
> 
> 标签：android, google-maps

我可以在 Android 的同一个应用程序中使用 MapView 和 GoogleMap 吗？我为地图使用 API V2。我的意图是我想在地图上覆盖地理围栏应用程序。但是 GoogleMap 不能很好地支持覆盖。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:41:44.387

如果您的意思是来自 Android API v1 的 MapView，那么不，您不能。

API v1 需要您扩展`MapActivity`，而 v2 需要`FragmentActivity`（使用 SupportMapFragment 时）。您可以将 Maps v1 和 v2 合并为一个`Activity`，但只能作为两个单独`Views`的。

无论如何`GoogleMap`，对叠加层都有很好的支持。有`GroundOverlay`和`TileOverlay`。如果遇到问题，您可能想问一个新问题，如何与他们一起实现某些目标。

# php - 为什么特定变量导致html打印出来

> ID：16095693
> 
> 赞同：0
> 
> 时间：2013-04-19T01:14:09.290
> 
> 标签：php, wordpress, background-image

我正在尝试在我的 wordpress 网站中显示一些图像。我正在尝试通过制作背景 div 和图像`style=""`

所以当我这样做时：

```
<?php
if(has_post_thumbnail($property->ID)){
    $image_url = get_the_post_thumbnail($property->ID,array(300,220),array('class' => "post_thumbnail"));
}else{
    $image = $image_url = '';
}
?>
<div class="property_photo" style="background-image:url('<?php echo $image_url;?>') no-repeat;">
</div> 
```

照片不再显示，它正在打印`') no-repeat;">`图像应显示的位置。当我使用名称中没有“_”的变量时，它不会打印任何内容。所以为了避免这种情况，我试图`$image = $image_url = '';`解决这个问题。

这是一个简单的语法问题，还是 php 中的某些东西导致了这个问题？它看起来不像语法，因为当我使用其他变量时它不会这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:23:05.303

您的`get_the_post_thumbnail()`函数返回的是 HTML，而不是 URL。您需要更改函数以仅返回 URL（或使用执行此操作的其他函数），或更改 HTML 以将图像放入其中，`div`而不是将其设置为背景图像。

# javascript - ExtJS 如何在两个异步事件之后设置一个动作

> ID：16095696
> 
> 赞同：1
> 
> 时间：2013-04-19T01:14:18.273
> 
> 标签：javascript, extjs

我有两家`autoload: true`正在加载数据的商店。我想在**这两个**都加载后填充我的 UI。我正在遵循 MVC 架构，所以在我的控制器中，我正在尝试做这样的事情：

```
store1.on('load', me.setUpIfBothStoresReady, me);
store2.on('load', me.setUpIfBothStoresReady, me);

setUpIfBothStoresReady: function() {
    if(store1.isSuccessfullyLoaded() && store2.isSuccessfullyLoaded()) {
        // do work
    }
} 
```

问题是此时可能已经加载了一个或两个商店。除了手动控制这些商店的负载之外，是否有一些设计模式我只能在两者都完成后才能使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:35:04.713

您可以将 whenjs 之类的东西与延迟事件一起使用。

[https://github.com/cujojs/when/wiki/Examples](https://github.com/cujojs/when/wiki/Examples)

或者自己写：

```
loadStores: function() {
    ...
    me.loaded = 0;
    store1.on('load', me.setUpIfBothStoresReady, me);
    store2.on('load', me.setUpIfBothStoresReady, me);
},

...

setUpIfBothStoresReady: function() {

    ++this.loaded;
    if (this.loaded == 2) {
        //do work
    }
} 
```

如果您有几家商店，最好使用数组。

# ios - 将 Flex 3.5/4 Web 应用程序迁移到 Flash Builder 4.6 for Mobile iOS 的快捷方式是什么？

> ID：16095697
> 
> 赞同：0
> 
> 时间：2013-04-19T01:14:56.773
> 
> 标签：ios, spring, apache-flex, migration, builder

我目前在 Flex 3.5/4 中使用 java 后端和使用 TomCat 的 Spring Framework 构建了一个完全工作的 Web 应用程序。

我需要将此项目迁移或转换为 Flash Builder 4.6 以创建移动 iOS 应用程序并使用与 TomCat 相同的 SpringFramework。我怎样才能做到这一点？

1.  我只是复制代码并调整吗？
2.  我是否从 flex 3.5/4 导出并导入到 flash builder 4.6 并针对移动设备进行调整？
3.  是否有某种导出功能可以导出到移动设备？
4.  我必须手动将代码更改为移动组件吗？有什么自动化的吗？

我花了大约 3 天的时间试图搜索并找出有关该做什么的具体详细信息，但奇怪的是，我没有找到任何有用的信息。我说这很奇怪，因为 Adob​​e 声称使用 Flash Builder 4.6 和 4.7，迁移到不同的平台，将删除大约 70% 的最新 Flash Builder 工作。但是，我没有找到关于该做什么的教程或步骤。我什至不知道 Spring 框架是否可以与 TomCat 一起用于 iOS 应用程序。

以下是我通过研究发现的： 1\. 迁移到移动设备，我将不得不更改各种代码以使用移动设备优化组件来提高性能。

我需要做什么？

编辑：我什至尝试将 mx.swc 添加到我的库路径中，只是为了测试目的，以使迁移/转换更容易，但它仍然无法修复我在 Flash Builder 4.6 移动项目中使用 mx:Application: [http:// i.stack.imgur.com/dFdIk.jpg](http://i.stack.imgur.com/dFdIk.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:54:32.347

很多东西要涵盖；我不知道从哪里开始。首先，我想澄清一下，您为 72-ish dpi 15+ 英寸电脑屏幕开发的基于浏览器的应用程序可能不会轻易迁移到 3.5/4 英寸 iPhone 或 9.7 英寸 iPad 屏幕。牢记这一点

> ```
> Do i just copy code over and adjust? 
> ```

我会从那里开始，是的。如果您将“共享”代码移动到库项目中，这样您就可以将它用于您的网络应用程序和移动项目，那就更好了。Flex 3.5 没有正式的移动支持；所以我不希望在移动设备上表现出色。您还必须在 Flash Builder Mobile 项目中手动将一些“非移动优化”库添加到库路径中。正如您已经提到的，MX.swc 可能是最大的。

> ```
> Do I export from flex 3.5/4 and import into flash builder 4.6 and adjust for mobile? 
> ```

在 Flash Builder 4.6 中，移动项目不同于 Web 项目。您很可能希望将尽可能多的共享代码移动到库项目中，然后创建一个 Web 项目——用于维护您当前的应用程序——以及一个用于部署到 iOS 和其他移动设备的移动项目。

> ```
> Is there a certain export feature that exports to mobile? 
> ```

如果您创建了 Flash Builder Mobile 项目；那么是的，您可以导出到 iOS、Android 或 Blackberry。

> ```
> Do I have to change the code to mobile components by hand? Is there anything automated? 
> ```

是的，您必须手动将代码更改为移动组件。也就是说，如果您要用移动优化的组件替换非移动优化的组件。但是，如果您使用的是 Spark 组件 [Flex 4 中引入的]，例如 List，那么您可以在 web 项目中使用带有默认主题的 spark 列表，而在您的移动项目中使用带有移动主题的 spark 列表，而无需任何变化。

> ...Adobe 声称，使用 Flash Builder 4.6 和 4.7，迁移到不同的平台，将删除大约 70% 的最新 Flash Builder 工作。

我不知道这样的说法。但是，我相信您可以在移动项目和非移动项目之间重用大量代码。我花了 3-4 个月的时间使用 AIR/Flex 构建了一款手机游戏。我花了不到一天的时间将代码移植到 Web 浏览器中工作。

> 我什至不知道 Spring 框架是否可以与 TomCat 一起用于 iOS 应用程序。

如果您希望您的 iOS 应用程序调用服务器，那么是的，它可以正常工作。如果您想将 Tomcat 和 Spring 部署到 iOS 设备上，我不希望它能够工作。

这个问题有点不具体；但我试图提供帮助。如果这不能为您指明方向，那么我可能会问您尝试了什么，遇到了什么问题？

# python - Python GDAL：使用其他文件进行投影的地理参考数组

> ID：16095699
> 
> 赞同：2
> 
> 时间：2013-04-19T01:15:07.940
> 
> 标签：python, gdal

我有一个数据数组，对于每个点我都知道该点的纬度和经度，并且我想将数据写入 GTiff，并从另一个文件中获取投影。如何正确地理参考新文件？

这就是我现在正在尝试的：

```
import numpy as np
import gdal
from gdalconst import *
from osgeo import osr

def GetGeoInfo(FileName):
    SourceDS = gdal.Open(FileName, GA_ReadOnly)
    GeoT = SourceDS.GetGeoTransform()
    Projection = osr.SpatialReference()
    Projection.ImportFromWkt(SourceDS.GetProjectionRef())
    return GeoT, Projection

def CreateGeoTiff(Name, Array, driver, 
                  xsize, ysize, GeoT, Projection):
    DataType = gdal.GDT_Float32
    NewFileName = Name+'.tif'
    # Set up the dataset
    DataSet = driver.Create( NewFileName, xsize, ysize, 1, DataType )
            # the '1' is for band 1.
    DataSet.SetGeoTransform(GeoT)
    DataSet.SetProjection( Projection.ExportToWkt() )
    # Write the array
    DataSet.GetRasterBand(1).WriteArray( Array )
    return NewFileName

def ReprojectCoords(x, y,src_srs,tgt_srs):
    trans_coords=[]
    transform = osr.CoordinateTransformation( src_srs, tgt_srs)
    x,y,z = transform.TransformPoint(x, y)
    return x, y

# Some Data
Data = np.random.rand(5,6)
Lats = np.array([-5.5, -5.0, -4.5, -4.0, -3.5])
Lons = np.array([135.0, 135.5, 136.0, 136.5, 137.0, 137.5])

# A raster file that exists in the same approximate aregion.
RASTER_FN = 'some_raster.tif'

# Open the raster file and get the projection, that's the
# projection I'd like my new raster to have, it's 'projected',
# i.e. x, y values are numbers of pixels.
GeoT, TargetProjection, DataType = GetGeoInfo(RASTER_FN)
# Meanwhile my raster is currently in geographic coordinates.
SourceProjection = TargetProjection.CloneGeogCS()

# Get the corner coordinates of my array
LatSize, LonSize = len(Lats), len(Lons)
LatLow, LatHigh = Lats[0], Lats[-1]
LonLow, LonHigh = Lons[0], Lons[-1]
# Reproject the corner coordinates from geographic
# to projected...
TopLeft = ReprojectCoords(LonLow, LatHigh, SourceProjection, TargetProjection)
BottomLeft = ReprojectCoords(LonLow, LatLow, SourceProjection, TargetProjection)
TopRight = ReprojectCoords(LonHigh, LatHigh, SourceProjection, TargetProjection)
# And define my Geotransform
GeoTNew = [TopLeft[0],  (TopLeft[0]-TopRight[0])/(LonSize-1), 0,
           TopLeft[1], 0, (TopLeft[1]-BottomLeft[1])/(LatSize-1)]

# I want a GTiff
driver = gdal.GetDriverByName('GTiff')
# Create the new file...
NewFileName = CreateGeoTiff('Output', Data, driver, LatSize, LonSize, GeoTNew, TargetProjection) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:28:46.493

如果您只想将数据保存到栅格中以在 QGIS 中使用，您可以简单地从您的数据中构造一个新的 Geotiff（或任何其他 GDAL 格式）。除非您想做某种形式的重投影或插值，否则不需要“目标栅格”。

这是一个例子：

```
import gdal
import osr
import numpy as np

data = np.random.rand(5,6)
lats = np.array([-5.5, -5.0, -4.5, -4.0, -3.5])
lons = np.array([135.0, 135.5, 136.0, 136.5, 137.0, 137.5])

xres = lons[1] - lons[0]
yres = lats[1] - lats[0]

ysize = len(lats)
xsize = len(lons)

ulx = lons[0] - (xres / 2.)
uly = lats[-1] - (yres / 2.)

driver = gdal.GetDriverByName('GTiff')
ds = driver.Create('D:\\test.tif', xsize, ysize, 1, gdal.GDT_Float32)

# this assumes the projection is Geographic lat/lon WGS 84
srs = osr.SpatialReference()
srs.ImportFromEPSG(4326)
ds.SetProjection(srs.ExportToWkt())

gt = [ulx, xres, 0, uly, 0, yres ]
ds.SetGeoTransform(gt)

outband = ds.GetRasterBand(1)
outband.WriteArray(data)

ds = None 
```

在此示例中，我假设您的纬度/经度指的是像素的中心，因为 GDAL 与边缘一起工作，因此需要添加半个像素大小。

# java - 从对象中的数组中获取元素时，Java 是否必须读取整个数组？

> ID：16095701
> 
> 赞同：1
> 
> 时间：2013-04-19T01:15:18.467
> 
> 标签：java, performance

例如给出以下方法：

```
 public double[] getCoord(){
        return coord;
}

    public double getCoord(int variable){
        return coord[variable];
} 
```

打电话会更好吗

```
object.getCoord()[1] 
```

或者

```
object.getCoord(1) 
```

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:18:16.440

虽然没有性能差异，但第二种方法提供了一个更优越的 API，因为 Java 数组总是*可变*的。第一个 API 让您的用户编写

```
object.getCoord()[1] = 12.345; 
```

并在背后修改对象的内部结构。这绝不是一件好事：即使是非恶意用户也可能会做一些你从未想过的事情，只是犯了错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:18:17.943

就性能而言，这并不重要。第一个方法返回对数组的引用，而不是副本。

也就是说，第二种方法保护数组不被类外修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:18:16.487

`[]`不，当您使用下标运算符 ( )时，Java 不会读取整个数组。关于首先使用访问器方法获取数组，然后对其进行索引而不是调用执行相同操作的方法会更好，它可能可以忽略不计。您仍然会产生调用函数并以任何一种方式返回结果的开销（请注意）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T01:21:00.160

我猜测#2 会稍微慢一些，因为在调用 getCoord(int) 之前必须将参数压入堆栈。虽然不多。

两者都不必读取整个数组。

两者都比直接数组访问慢，例如 coord[1]。

# javascript - 使用 Javascript 将文本 CSS 解析为 JSON

> ID：16095703
> 
> 赞同：8
> 
> 时间：2013-04-19T01:15:32.463
> 
> 标签：javascript, jquery, css, json, textarea

我只是想要一些可以使用 CSS JSON 方法将其转换为 JSON 的文本区域。

```
{
    "selector-1":{
        "property-1":"value-1",
        "property-n":"value-n"
    }
} 
```

[http://www.featureblend.com/css-json.html](http://www.featureblend.com/css-json.html)

有谁知道可以将 CSS 解码为 JSON 的东西？如果它也可以对其进行编码，那也会很有帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T21:28:30.403

这个 js 解析器具有您正在寻找的两种方法。

[CSS JSON 解析器](https://github.com/aramk/CSSJSON)

```
// To JSON
var json = CSSJSON.toJSON(cssString);

// To CSS
var css = CSSJSON.toCSS(jsonObject); 
```

或 jQuery 插件解析器。

[jQuery 解析器](http://bililite.com/blog/2009/01/16/jquery-css-parser/)

示例 CSS：

```
div div:first {
  font-weight: bold;
  -jquery: each(function() {alert(this.tagName);})
}

div > span {
  color: red;
} 
```

发送到回调的 JSON 输出：

```
{
  'div div:first' : {
    'font-weight' : 'bold',
    '-jquery': 'each(function() {alert(this.tagName);})'
  },
  'div > span' : {
    'color': 'red'
  }
} 
```

您可以将 css 字符串应用于这样的元素：

```
var cssJSON = '{ "display": "none" }';
var obj = JSON.parse(json);

$("#element").css(obj); 
```

# android - 使用对话框片段时出现 NoClassDefFound 异常

> ID：16095704
> 
> 赞同：0
> 
> 时间：2013-04-19T01:15:45.730
> 
> 标签：android, eclipse-adt

我是android开发的新手。我正在关注此[链接](http://developer.android.com/reference/android/app/DialogFragment.html)以创建一个警报对话框。但我收到 NoClassDefFound 错误

`newFragment.show(getFragmentManager(), "dialog");`

编辑：堆栈跟踪

> 04-19 06:40:08.640: E/AndroidRuntime(1656): 致命异常: main 04-19 06:40:08.640: E/AndroidRuntime(1656): java.lang.NoClassDefFoundError: org.poovelil.gpstest.MainActivity$ MyAlertDialogFragment 04-19 06:40:08.640: E/AndroidRuntime(1656): at org.poovelil.gpstest.MainActivity.onCreate(MainActivity.java:37) 04-19 06:40:08.640: E/AndroidRuntime(1656):在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836) 04-19 06 :40:08.640: E/AndroidRuntime(1656): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 android.app.ActivityThread。访问$1500(ActivityThread.java:135) 04-19 06:40:08.640:E/AndroidRuntime(1656): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1054) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 android.os.Handler.dispatchMessage(Handler .java:99) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 android.os.Looper.loop(Looper.java:150) 04-19 06:40:08.640: E/AndroidRuntime(1656 ): 在 android.app.ActivityThread.main(ActivityThread.java:4389) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 java.lang.reflect.Method.invokeNative(Native Method) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 java.lang.reflect.Method.invoke(Method.java:507) 04-19 06:40:08.640: E/AndroidRuntime(1656): 在 com.android .internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849) 04-19 06:40:08.640: E/AndroidRuntime(1656): at com.android.internal.os.ZygoteInit。main(ZygoteInit.java:607) 04-19 06:40:08.640: E/AndroidRuntime(1656): at dalvik.system.NativeStart.main(Native Method)

我的代码如下。

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
        boolean gpsOn = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
        boolean networkOn = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER); 
        if(!gpsOn) {
            Toast.makeText(getApplicationContext(), "GPS Provider is off", Toast.LENGTH_LONG).show();
        } else {
            Toast.makeText(getApplicationContext(), "GPS Provider is on", Toast.LENGTH_SHORT).show();
        } 

        if(!networkOn) {
            Toast.makeText(getApplicationContext(), "Network provider is off", Toast.LENGTH_LONG).show();
        } else {
            Toast.makeText(getApplicationContext(), "Network provider is on", Toast.LENGTH_LONG).show();
        }

        if(!networkOn || !gpsOn) {
            DialogFragment newFragment = MyAlertDialogFragment.newInstance(1);
            newFragment.show(getFragmentManager(), "dialog");
             //startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    public static class MyAlertDialogFragment extends DialogFragment {

        public static MyAlertDialogFragment newInstance(int title) {
            MyAlertDialogFragment frag = new MyAlertDialogFragment();
            Bundle args = new Bundle();
            args.putInt("title", title);
            frag.setArguments(args);
            return frag;
        }

        public Dialog onCreateDialog(Bundle savedInstanceState) {
            int title = getArguments().getInt("title");

            return new AlertDialog.Builder(getActivity())
                //.setIcon(R.drawable.alert_dialog_icon)
                .setTitle(title)
                .setPositiveButton("Ok", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface arg0, int arg1) {
                        //((FragmentAlertDialog) getActivity()).doPositiveClick();

                    }
                })
                .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface arg0, int arg1) {

                    }
                })
                .create();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:35:55.023

NoClassDefFound 错误让我相信您使用的是 pre-HC 设备，这意味着它没有对 Fragments 的本机支持。您将需要使用 android 支持库并改用 FragmentActivity `getSupportFragmentManager()`。

查看此页面：[使用支持库](http://developer.android.com/training/basics/fragments/support-lib.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:42:37.843

如果您使用`minSdk=8`添加支持库是不够的。您应该相应地使用片段内容，在您的情况下：

*   您的自定义片段应该继承自`android.support.v4.app.DialogFragment`
*   你的活动应该继承自`android.support.v4.app.FragmentActivity`
*   您应该通过以下方式检索支持`FragmentManager`实例`android.support.v4.app.FragmentActivity.getSupportFragmentManager()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:27:36.573

您需要先将对话框添加到 FramgmentManager：

```
 FragmentManager fm = getFragmentManager();
    DialogFragment newFragment = null;

    final FragmentTransaction transaction = fm.beginTransaction();
    newFragment = (DialogFragment)fm.findFragmentByTag("dialog");
    if (newFragment == null) {
        newFragment = MyAlertDialogFragment.newInstance(1)
        transaction.add(0x11313123, newFragment, "dialog");
    }
   newFragment.show(getFragmentManager(), "dialog");
} 
```

# c++ - 重载函数产生模棱两可的错误

> ID：16095705
> 
> 赞同：0
> 
> 时间：2013-04-19T01:15:53.150
> 
> 标签：c++, standards, overloading

我有一些重载的功能，但在我的测试代码中产生了一些错误。

```
inline void tt(uint8_t& v) { }
inline void tt(int8_t& v) { }
inline void tt(char& v) { }
inline void tt(uint16_t& v) { }
inline void tt(int16_t& v) { }
inline void tt(uint32_t& v) { }
inline void tt(int32_t& v) { }
inline void tt(uint64_t& v) { }
inline void tt(int64_t& v) { }

int main(int argc, char* argv[]) {
    unsigned char t1;
    signed char t2;
    unsigned short t3;
    short t4;
    unsigned int t5;
    int t6;
    unsigned long t7;
    long t8;
    char t9;

    tt(t1);  // ok
    tt(t2);  // ok
    tt(t3);  // ok
    tt(t4);  // ok
    tt(t5);  // ok
    tt(t6);  // ok
    tt(t7);  // error
    tt(t8);  // error
    tt(t9);  // ok
} 
```

**为什么除了（无符号）长之外的所有工作？**看[标准](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3485.pdf)长至少（像所有其他类型一样）32位。

`There are five standard signed integer types: “signed char”, “short int”, “int”, “long int”, and “long long int”. In this list, each type provides at least as much storage as those preceding it in the list.`

我可以通过插入来避免这种情况

```
inline void tt(unsigned long int& v) { }
inline void tt(long int& v) { } 
```

到代码。我只想知道为什么这个演员表不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:47:13.353

因为，在您的编译器上，您重载的所有类型`tt`都与`long`. 在其他编译器上，它们中的一个或多个可能是。最有可能`int32_t`是 的别名，`int`并且`int64_t`是 的别名`long long`。

例如，即使`int`和`long`是相同的*size*，它们也不是相同的*type*，因此对一个的引用不能转换为对另一个的引用。事实上，您已经引用了标准中说它们是不同类型的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:39:54.207

C++ 标准（草案 N3225）说：

> 有五种标准有符号整数类型：“signed char”、“short int”、“int”、“long int”和“long long int”。在此列表中，每种类型提供的存储空间至少与列表中它前面的类型一样多。

在 MSVC12 上，我进入`typedef unsigned int uint32_t;`了 stdint.h。

尽管 unsigned long 也是 32 位，但它仍然是不同的类型。

因此，您的任何函数都没有被重载以将（无符号）长引用作为参数。

-edit- 如果您更改函数以按值获取参数，则由于对 tt() 的模棱两可的调用，最终会出现错误。

# debugging - 为什么我们需要将程序路径与核心文件一起传递给调试器？

> ID：16095708
> 
> 赞同：1
> 
> 时间：2013-04-19T01:16:32.660
> 
> 标签：debugging, gdb, core, dbx

该程序是否与生成核心文件时崩溃的程序完全相同？

```
dbx <program path> <core path> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T01:20:08.123

该程序包含符号表，用于将核心转储中的位置转换为程序语句和变量名。如果您使用不同的构建，这些位置通常会发生变化，因此许多（也许是大多数）符号引用在调试时将无法正常工作。

# windows - 获取带有第一个出现标记的常见字符串列表

> ID：16095711
> 
> 赞同：0
> 
> 时间：2013-04-19T01:16:42.027
> 
> 标签：windows, string, batch-file

我有一堆包含一些内容的文本文件。首先，我想在全球范围内对线路进行编号。然后我提取了在某处重复的所有行（在任何给定文件中至少出现两次）。但是现在我需要用该行第一次出现的文件名和行号来标记所有这些行。现在有趣的部分 - 它需要是一个 Windows 批处理文件，使用本机 Windows 工具。这就是为什么我一开始就有这个问题。

所以，总结一下：

我有一个文件**A**，据说它们中的每一个在给定的文件集中至少出现两次。

我需要搜索这些文件并标记**A中所有出现的给定行**文件中标记所有出现的给定行，其中该行首先出现在该文件中的行号 -file name

这是我努力编号行和格式化文件的代码。

```
@echo off
setlocal EnableDelayedExpansion
set /a lnum=0
if not [%1]==[] pushd %1

for /r %%F in (*.txt) do call :sub "%%F"
echo Total lines in %Files% files: %Total%
popd
exit /b 0
:Sub
set /a Cnt=0

for /f %%n in ('type %1') do (
  set /a Cnt+=1
  set /a lnum=!lnum!+1
  echo ^<!lnum!^> %%n >> %1_ln.txt && echo ^<!lnum!^> >> %1_ln.txt && echo. >> %1_ln.txt
)
set /a Total+=Cnt
set /a Files+=1
echo %1: %Cnt% lines 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:18:18.697

```
@echo off
setlocal EnableDelayedExpansion
set lnum=0
if not "%~1" == "" pushd %1

rem "I've got bunch of text files..." (%%F is file name)
for /r %%F in (*.txt) do call :sub "%%F"
echo Total lines in %Files% files: %lnum%
popd
exit /b 0

:Sub "filename"
set Cnt=0

rem "... with some content." (%%n is line contents)
(for /f "usebackq delims=" %%n in (%1) do (
   set /a Cnt+=1
   rem "First I wanted to number the lines globally."
   set /a lnum+=1
   echo ^<!lnum!^> %%n 
   rem "Then I extracted all lines that are duplicated somewhere" (that were defined before)
   if defined line[%%n] (
      rem "I need to mark all of these lines with the filename and line number of the first occurrence of this line."
      echo ^<!line[%%n]!^>
      echo/
   ) else (
      REM (Store the first occurrence of this line with *local* line number and filename)
      set line[%%n]=!Cnt!: %1
   )
)) > "%~PN1_ln.txt"
set /A Files+=1
echo %1: %Cnt% lines
exit /B 
```

上面的批处理程序会忽略输入文件中的空行，如果它们包含特殊的批处理字符，例如`! & < > |`; 如果需要，可以修复此限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T14:07:15.247

```
@ECHO OFF & setlocal
for /f "tokens=1*delims==" %%i in ('set "$" 2^>nul') do set "%%i="

for %%a in (*.txt) do (
 for /f %%b in ('find /v /c "" ^<"%%a"') do echo(%%b lines in %%a.
 set /a counter=0, files+=1
 for /f "usebackqdelims=" %%b in ("%%~a") do (
    set /a counter+=1, total+=1
    set "line=%%b"
    setlocal enabledelayedexpansion
    if not defined $!line! set "$!line!=%%a=!counter!=!line!"
    for /f "delims=" %%i in ('set "$" 2^>nul') do (if "!"=="" endlocal)& set "%%i"
    )
)
echo(%total% lines in %files% files.
for /f "delims=" %%a in (a) do set "#%%a=%%a"
for /f "tokens=2,3*delims==:" %%i in ('set "$" 2^>nul') do (
    if defined #%%k echo("%%k" found in %%i at line %%j.
) 
```

脚本可以处理`!&<>|%`，但不行`=`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T06:17:31.587

```
@ECHO OFF
SETLOCAL

FOR /f "delims=" %%s IN (A) DO (
 SET searching=Y
 FOR /f "delims=" %%f IN (
  'dir /s /b /a-d *.txt') DO IF DEFINED searching (
  FOR /f "tokens=1delims=:" %%L IN (
   'findstr /b /e /n /l /c:"%%s" ^<"%%f"') DO IF DEFINED searching (
ECHO Line %%L IN "%%f" FOUND "%%s"
SET "searching="
 )
 )
) 
```

这是一个例行程序的核心，它应该做你正在寻找的事情——这就像泥巴一样清晰。

它依次查看每个字符串的“A”文件，将字符串分配给`%%s`并设置标志`searching`

然后它查看文件列表，将文件名分配给`%%f`

然后它执行 a以在或文字模式（即不使用正则表达式）中`findstr`查找`/c:"%%s"`完整的字符串`%%s`（包括任何空格），以查找以目标开头和结尾的行（即完全匹配）并对这些行编号。`/l``/b``/e``/n`

findstr 的输出将采用格式，因此如果使用选项`linenumber:linecontents`检查此行，则将第一个分区分配给`FOR``"delims=:"``:``%%L`

所以 -`%%L`包含行号、`%%f`文件名、`%%s`字符串 Clearing`searching`通过将其值设置为 [nothing] 检测到该行意味着它不是，`NOT DEFINED`因此不会从当前文件报告更多行，也不会检查更多文件名。

现在，如果您想获得目标行的所有出现的列表，您需要做的就是 REM-out 该`SET "searching="`行。搜索将永远不会被重置，因此会报告每个文件中的每一行。

如果您想要其他组合，请澄清。

我完全不知道“标记”一条线是什么意思。

# objective-c - 从 JSON 调用的坐标没有出现

> ID：16095726
> 
> 赞同：0
> 
> 时间：2013-04-19T01:18:34.723
> 
> 标签：objective-c, arrays, json, mapkit

我正在尝试显示我的 JSON 文件中的图钉，但它们没有出现任何帮助将不胜感激：按钮也将调用单独的 JSON 页面。

```
my code for mapview.m:

- (void)viewDidLoad
{
[super viewDidLoad];

NSURL *url = [NSURL URLWithString:@"https://w1281595.users.ecs.westminster.ac.uk/shops.php"];
NSData *data = [NSData dataWithContentsOfURL:url];

NSError *error;
NSArray *shoparray = [NSJSONSerialization JSONObjectWithData:data
                                                     options:0
                                                       error:&error];
if (error != nil)
{
}

CLLocationCoordinate2D location;                         
NSMutableArray *newAnnotations = [NSMutableArray array]; 
MKPointAnnotation *newAnnotation;                       

for (NSDictionary *dictionary in shoparray)
{
        location.longitude = [dictionary[@"Longitude"] doubleValue];
        location.latitude = [dictionary[@"Latitude"] doubleValue];

        newAnnotation = [[MKPointAnnotation alloc] init];
        newAnnotation.title = dictionary[@"Name"];
        newAnnotation.coordinate = location;      

    }

    [self.mapview addAnnotations:newAnnotations]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T07:24:24.160

`newAnnotation`您的循环每次都会创建一个。`newAnnotations`然后添加一个调用到地图的数组。但是您忘记将任何内容放入`newAnnotations`数组中。

# ruby - 使用 ruby 将数据写入现有 CSV 文件的问题

> ID：16095728
> 
> 赞同：0
> 
> 时间：2013-04-19T01:18:40.073
> 
> 标签：ruby, file, csv, fwrite

# 测试1.csv

```
yearID,teamID,lgID,playerID,salary
1985,BAL,AL,boddimi01,625000
1985,BAL,AL,dauerri01,480000
1985,BAL,AL,davisst02,437500
1986,BAL,AL,dempsri01,512500
1986,BAL,AL,dwyerji01,375000
1987,BAL,AL,flanami01,641667 
```

这是我的红宝石代码！

```
File.foreach('test1.csv') do |csv_line|
    row = CSV.parse_line(csv_line)

    if File.exist?("year_#{row[0]}_info.csv")
        File.open("year_#{row[0]}_info.csv", 'w') do |f|     
            f.write("\n#{row[4]}")   
        end
    else
        File.open("year_#{row[0]}_info.csv", 'w') do |f|     
            f.write("#{row[4]}")   
        end
    end
end 
```

我正在尝试获得以下输出之一

```
#year_1985_info.csv
625000
480000
437500 
```

但我只得到这个输出

```
#year_1985_info.csv

437500 
```

如何获得所需的输出？

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:23:50.737

您需要以“附加”模式打开文件。像这样：

```
File.open("year_#{row[0]}_info.csv", 'a') 
```

注意“一”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:37:06.307

如果文件存在，您希望附加到它而不是创建一个空文件：

```
require 'csv'

File.foreach('test1.csv') do |csv_line|
  row = CSV.parse_line(csv_line)

  ofname = "year_#{row[0]}_info.csv";
  if File.exist?(ofname)
    File.open(ofname, 'a') do |f|       # Note the 'a' here
      f.write("\n#{row[4]}")
    end
  else
    File.open(ofname, 'w') do |f|
      f.write("#{row[4]}")
    end
  end
end 
```

我实际上认为在每行末尾都有一个换行符会更好。这使 CSV 文件更易于使用。它还简化了您的代码：

```
require 'csv'

File.foreach('test1.csv') do |csv_line|
  row = CSV.parse_line(csv_line)

  File.open("year_#{row[0]}_info.csv", 'a') do |f|
    f.write("#{row[4]}\n")
  end
end 
```

请注意，`'a'`实际上可以很好地创建或附加。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T02:03:50.950

保持打开和关闭同一个文件效率低下。

我要做的是按年份对它们进行分组，然后一次将它们打印到每个文件中。

```
scores = CSV.read('test1.csv').drop(1) #drop header line
grouped = scores.group_by(&:first)     #group by year

grouped.each do |year, rows|
  File.open("year_#{year}_info.csv", "w") do |f|
    f.puts rows.map(&:last)  #just want last column
  end
end 
```

# javascript - 如何让 Visual Studio 显示内置 JavaScript 的内联文档？

> ID：16095730
> 
> 赞同：2
> 
> 时间：2013-04-19T01:18:44.180
> 
> 标签：javascript, visual-studio-2010, visual-studio-2012, intellisense, jsdoc

在 Visual Studio 2010 和 2012 中，JavaScript 编辑器支持显示 JavaScript 事物（例如函数）的内联文档。但是，Visual Studio 似乎没有为 JavaScript 自己的内置部件提供此文档。

这是我想要实现的具体示例。如果我访问 a`String`的`charAt`方法，这就是当前发生的情况：

![Visual Studio 显示返回和参数类型，但不显示文档。](https://i.stack.imgur.com/Dq3Cf.png)

对于内置的 .NET 类，Visual Studio 提供了文档。我想为 JavaScript 做同样的事情。

关于如何做到这一点，我认为可以通过提供一个包含使用 JsDoc 或 VsDoc 记录的存根的 JavaScript 文件来完成。然后我可以告诉 Visual Studio 将其用作 IntelliSense 的参考。不幸的是，我找不到任何已经这样做的现有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T12:16:47.443

在 VS2012 中，您可以使用所有 VSDoc 文档创建一个 JavaScript 文件，然后将其保存为参考文件。

要配置参考文件：

1.  `TOOLS > Options`从主菜单栏中选择
2.  导航`Text Editor > JavaScript > IntelliSense > References`
3.  `Implicit (Web)`从参考组下拉列表中选择
4.  找到您的文件，然后单击`Add`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-19T08:50:26.843

在 VS12 中，你需要的魔法文件是`~/Scripts/_reference.js`

像这样放置线条，当然要替换正确的路径。

如果它在那里，它应该拿起 jQuery VSDOC。

```
/// <reference path="~/Scripts/Frameworks/Kendo/kendo.web.exploded.js"/>
/// <reference path="~/Scripts/Frameworks/jQuery/jquery.1.8.2.js"/>
/// <reference path="~/Scripts/kendoize/kendoize.js" />
/// <reference path="~/Scripts/kendoize/validation.js" /> 
```

# ruby-on-rails - 在 rails 3.2 应用程序中，后台作业完成后更新页面的最佳方式是什么？

> ID：16095740
> 
> 赞同：0
> 
> 时间：2013-04-19T01:19:56.643
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3

我的 rails 3.2 应用程序有一个报告页面，通常需要 90 多秒才能呈现，因此我将报告生成器作为延迟作业任务运行，然后显示“等一下”视图（带有刷新按钮），直到内容准备好（那里是`content_ready`视图中用于显示“等待消息”或报告的标志，视情况而定）。在我的原型中，用户必须手动刷新页面，直到`content_ready`设置（然后呈现报告视图）。

我想让页面自动刷新`content_ready`为真时自动刷新。

什么是最简单的方法来实现这一点，因为它是一个很少被点击的页面，因此是一种低效的方法，例如告诉用户的浏览器每 10 秒轮询一次服务器（或重绘整个页面），就可以了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:30:27.477

设置页面上的元刷新或 ajax 更新程序（如果使用 jquery，[请参阅此处](https://stackoverflow.com/a/5052661/403664)），以检查特定的控制器操作，告诉您作业是否已完成，或者文件是否存在于预期的位置。

或者，假设您正在使用delayed_job gem，请查看作为作业排队执行的一部分提供的挂钩。[gem 的 GH page](https://github.com/collectiveidea/delayed_job)上有文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T01:30:35.413

我推荐以下策略：

*   创建延迟作业后，立即将作业的 id 传回浏览器。
*   在您的站点上公开一个将返回作业状态的端点。
*   使用 jQuery + setTimeout 或 setInterval 来命中端点。
*   作业完成后，将用户重定向到相应的页面。

这是一个非常简单的策略，但它确实有效。

# java - 子类 Java 中的“找不到符号”

> ID：16095743
> 
> 赞同：0
> 
> 时间：2013-04-19T01:20:23.757
> 
> 标签：java

我正在尝试创建一个名为“ **public class Once ”的子类，并且在“** **return date** ;”行中收到错误“ **Cannot Find Symbol ”。**和“**返回描述**；”。我知道这可能是我错过的一些非常愚蠢的事情，但任何帮助都会很棒。

 ****这是我的代码！

```
import java.util.*;

public class Once
{
public Once(String dateIn, String descripIn)
{
  String date = dateIn;
  String descrip = descripIn;
}

public String getDate()
{
  return date;
}

public String getDescrip()
{
  return descrip;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:27:20.620

您没有将这些设置为[字段](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)。字段定义有关对象的特定属性。

您要做的就是将它们设置为：

```
public class Once {

    private String date;
    private String descrip;

    //initialize in constructor
    public Once(String dateIn, String descripIn) {
        date = dateIn;
        descrip = descripIn;
    }
    //Add getters and setters.
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:22:15.677

您已经在构造函数中定义了本地日期和描述。

它应该是

```
public class Once{
    String date;
    String descrip;

    public Once(String dateIn, String descripIn)
    {
      date = dateIn;
      descrip = descripIn;
    }
    // other methods
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:22:34.803

这些变量仅在 Once() 方法的范围内。您需要在类范围内声明它们：

```
public class Once
{
    String date, descrip;
    // ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T01:23:07.040

日期和描述需要在类级别定义，而不是作为局部变量。****

# sql - SQL Developer：无效的关系运算符错误，还有格式化问题

> ID：16095744
> 
> 赞同：0
> 
> 时间：2013-04-19T01:20:25.323
> 
> 标签：sql, oracle, case, to-date, to-char

我正在尝试向我们的数据库的查询添加一些格式化的列，但我认为我在 CASE 语句中弄错了运算符。

我也不清楚如何为 TO_CHAR 操作编写格式。它与 TO_DATE 操作相同吗？（在 oracle 文档中找不到）

我也不确定我是否应该使用 TO_DATE 或其他调用来创建一个对象，该对象存储为来自四个数字的字符串的时间。

最重要的是，我的代码产生了错误，所以我什么也没看到。

我收到此错误：

```
ORA-00920: invalid relational operator
00920\. 00000 -  "invalid relational operator"
*Cause:    
*Action:
Error at Line: 53 Column: 30 
```

从这段代码

```
/* Code written for exercize 3 in the Banner Tutorials by Alex Ackroyd on 18april2013*/
/* Objective: use functions to transform and shape data in the result set*/
/* Tables: SSRMEET ( add to SPRIDEN, SFRSTCR, SSBSECT ) */
/* Select: in addition to the columns from exercize 2, add the following values: 
    - SSRMEET_ROOM_CODE, 
    - a computed column for the start time, 
    - a computed column for the end time, and
    - a computed column that shows the days the class meets*/
/* Hint: The computed columns are created by passing table columns through functions. 
          You can use any non-analytical database function documented by Oracle to transform data from one thing to another.
          You can also write your own functions! Whoa there Shadowfax, coming soon to the tutorial near you!*/

/* Note:ssrmeet_begin_time and ssrmeet_end_time are are in a 4 character string 24hr format
        so I'm trying to read that in, convert it to a datetime type variable, 
        then convert it to the final standard format am/pm (ex: 5:00 A.M. , 3:30 P.M., etc.*/
/* Start code from this exercize, 3*/

select 
  ssrmeet.ssrmeet_room_code, 
  TO_CHAR(
          TO_DATE( ssrmeet.ssrmeet_begin_time, 'HH24MI' )
          /*, char format*/
          ), 
  TO_CHAR(
          TO_DATE( ssrmeet.ssrmeet_end_time, 'HH24MI' ) 
          /*, char format*/
          ),

  CASE
    when
/* line 53*/   ssrmeet.ssrmeet_sun_day,
             | ssrmeet.ssrmeet_mon_day, 
             | ssrmeet.ssrmeet_tue_day,
             | ssrmeet.ssrmeet_wed_day,
             | ssrmeet.ssrmeet_thu_day,
             | ssrmeet.ssrmeet_fri_day,
             | ssrmeet.ssrmeet_sat_day
      IS NOT NULL   
    END

from ssrmeet

/* End code from this exercize, 3*/ 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T03:46:33.110

我认为 SELECT 子句中的 CASE 构造也应该有一个 THEN 块。如果一个或所有工作日不为空，就像你想要做的那样。请参考以下示例 -

```
select
CASE
  WHEN a < b THEN 'hello'
  WHEN d < e THEN 'goodbye'
END
from my_table; 
```

所以在你的情况下，它应该是这样的 -

```
select 
ssrmeet.ssrmeet_room_code, 
TO_CHAR(
    TO_DATE( ssrmeet.ssrmeet_begin_time, 'HH24MI' )
      /*, char format*/
      ), 
TO_CHAR(
      TO_DATE( ssrmeet.ssrmeet_end_time, 'HH24MI' ) 
      /*, char format*/
      ),

CASE
when
/* line 53*/   ssrmeet.ssrmeet_sun_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_mon_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_tue_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_wed_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_thu_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_fri_day IS NOT NULL   
       OR  ssrmeet.ssrmeet_sat_day IS NOT NULL   
then 
/*Here comes the value that you want to show if one or all of the weekdays is not null*/
'WEEKDAY NOT NULL'
END
from ssrmeet; 
```

请让我知道这是否适合您。

谢谢，阿迪亚

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T23:04:06.687

谢谢您的帮助！你是对的，这将是使用 case 语句的正确方法，但它最终并没有给我我正在寻找的结果。

```
/* Code written for exercize 3 in the Banner Tutorials by Alex Ackroyd on 18april2013*/
/* Edited last: 22april2013*/
/* Objective: use functions to transform and shape data in the result set*/
/* Tables: SSRMEET ( add to SPRIDEN, SFRSTCR, SSBSECT) */
/* Select: in addition to the columns from exercize 2, add the following values: 
    - SSRMEET_ROOM_CODE, 
    - a computed column for the start time, 
    - a computed column for the end time, and
    - a computed column that shows the days the class meets*/
/* Hint: The computed columns are created by passing table columns through functions. 
          You can use any non-analytical database function documented by Oracle to transform data from one thing to another.
          You can also write your own functions! Whoa there Shadowfax, coming soon to the tutorial near you!*/

/* Start code from exercizes 1, 2, unt 3 that queries my student record*/

select 
  spriden.spriden_id, spriden.spriden_pidm,
  sfrstcr.sfrstcr_term_code, sfrstcr.sfrstcr_crn,
  ssbsect.ssbsect_subj_code, ssbsect.ssbsect_crse_numb, ssbsect.ssbsect_seq_numb,
    ssbsect.ssbsect_crn,
  ssrmeet.ssrmeet_term_code, ssrmeet.ssrmeet_crn, ssrmeet.ssrmeet_room_code, 

  TO_CHAR( TO_DATE( ssrmeet.ssrmeet_begin_time, 'HH24MI' ), 'HH12:MI PM') as start_time, 
  TO_CHAR( TO_DATE( ssrmeet.ssrmeet_end_time, 'HH24MI' ), 'HH12:MI PM') as end_time,

  ( nvl(       decode( ssrmeet.ssrmeet_sun_day, null, '', 'Su')
            || decode( ssrmeet.ssrmeet_mon_day, null, '', 'M')
            || decode( ssrmeet.ssrmeet_tue_day, null, '', 'T')
            || decode( ssrmeet.ssrmeet_wed_day, null, '', 'W')
            || decode( ssrmeet.ssrmeet_thu_day, null, '', 'Th')
            || decode( ssrmeet.ssrmeet_fri_day, null, '', 'F')
            || decode( ssrmeet.ssrmeet_sat_day, null, '', 'Sa'),
            'TBA')
    ) as meetDays

from spriden, sfrstcr, ssbsect, ssrmeet

where
  spriden.spriden_id = /* insert id code here ->'XXXXXXXX' */
  and
  sfrstcr.sfrstcr_pidm = spriden.spriden_pidm
  and
  ssbsect.ssbsect_crn = sfrstcr.sfrstcr_crn
  and
  ssbsect.ssbsect_term_code = sfrstcr.sfrstcr_term_code
  and
  ssbsect.ssbsect_term_code = ssrmeet.ssrmeet_term_code
  and 
  ssbsect.ssbsect_crn = ssrmeet.ssrmeet_crn
  ;

/* End code from exercizes 1, 2, unt 3 */ 
```

# sql - SQLITE ON 更新操作

> ID：16095746
> 
> 赞同：1
> 
> 时间：2013-04-19T01:20:53.813
> 
> 标签：sql, database, sqlite, foreign-keys

根据[SQLite外键文档](http://www.sqlite.org/foreignkeys.html)，应该是创建两个数据库的方式，如果父字段更新，引用父字段的字段也会更新。

问题：一旦我按照以下步骤操作，直到最后一个命令之前一切正常， `SELECT * FROM track;`因为结果仍然与以下相同，因此它应该更改为最后显示的结果。

```
 trackid  trackname          trackartist
    -------  -----------------  -----------
    11       That's Amore       1
    12       Christmas Blues    1
    13       My Way             2 
```

编码：

```
-- Database schema
CREATE TABLE artist(
  artistid    INTEGER PRIMARY KEY, 
  artistname  TEXT
);
CREATE TABLE track(
  trackid     INTEGER,
  trackname   TEXT, 
  trackartist INTEGER REFERENCES artist(artistid) ON UPDATE CASCADE
);

sqlite> SELECT * FROM artist;
artistid  artistname       
--------  -----------------
1         Dean Martin      
2         Frank Sinatra    

sqlite> SELECT * FROM track;
trackid  trackname          trackartist
-------  -----------------  -----------
11       That's Amore       1
12       Christmas Blues    1
13       My Way             2  

sqlite> -- Update the artistid column of the artist record for "Dean Martin".
sqlite> -- Normally, this would raise a constraint, as it would orphan the two
sqlite> -- dependent records in the track table. However, the ON UPDATE CASCADE clause
sqlite> -- attached to the foreign key definition causes the update to "cascade"
sqlite> -- to the child table, preventing the foreign key constraint violation.
sqlite> UPDATE artist SET artistid = 100 WHERE artistname = 'Dean Martin';

sqlite> SELECT * FROM artist;
artistid  artistname       
--------  -----------------
2         Frank Sinatra    
100       Dean Martin      

sqlite> SELECT * FROM track;
trackid  trackname          trackartist
-------  -----------------  -----------
11       That's Amore       100
12       Christmas Blues    100  
13       My Way             2 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:19:15.653

您应该更加仔细地阅读[精美的手册](http://www.sqlite.org/foreignkeys.html#fk_enable)：

> **2\. 启用外键支持**
> [...]
> 假设库是在启用外键约束的情况下编译的，它仍然必须由应用程序在运行时使用 PRAGMA foreign_keys 命令启用。例如：
> 
> ```
> sqlite> PRAGMA foreign_keys = ON; 
> ```
> 
> 默认情况下禁用外键约束（为了向后兼容），因此必须分别为每个数据库连接单独启用。

所以如果你这样说：

```
sqlite> PRAGMA foreign_keys = ON;
sqlite> UPDATE artist SET artistid = 100 WHERE artistname = 'Dean Martin'; 
```

然后你会看到`track`你所期待的100。当然，这假设您的 SQLite 是使用 FK 支持编译的。

# php - 将 mysql_num_rows 更新为新的 Mysqli 标准：mysqli_stmt_num_rows

> ID：16095749
> 
> 赞同：1
> 
> 时间：2013-04-19T01:21:00.440
> 
> 标签：php, mysql, mysqli

我有一个 PHP 页面，其中包含一些我试图从 MySql 转换的 Mysqli。我想我已经正确转换了大部分内容，但是当我尝试执行代码时收到以下错误消息（如下）：

```
 Connection was OK!
    Warning: mysqli_stmt_num_rows() expects parameter 1 to be mysqli_stmt, object given in /quantityremaining5.php on line 25
    9999 
```

我对此有点陌生，所以请保持温和 - 我做错了什么？谢谢！

```
<?php

include 'quantitytest_config.php';

// Create connection to MySQL
$link = mysqli_connect($hostname, $username, $password); 
// Check connection
if (mysqli_connect_errno($link))
  {
  echo "Failed to connect to MySQL: " . mysqli_connect_error();
  } else { echo "Connection was OK!\n";}

//select a database to work with
$selected = mysqli_select_db($link, "grace59_countdown");
  // or die("Could not select countdown");

// use if TWO SEPARATE columns for date and time
//execute the SQL query and return records
$result = mysqli_query($link,
        "SELECT items 
        FROM cases 
        WHERE datetime<=NOW()
        Limit 1 ");

if(mysqli_stmt_num_rows($result) == 0){
   echo "9999";
    } else {
        //fetch tha data from the database
        while ($row = mysqli_fetch_array($result)) {
        echo "Quantity:".$row{'items'}."<br>";
        }
}

//close the connection
mysqli_close($link);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:23:29.653

使用`mysqli_num_rows($result)`或`$result->num_rows`。顾名思义，`mysqli_stmt_num_rows()`旨在与`mysqli_stmt`对象一起使用（由 返回`mysqli_prepare()`）。

请参阅[文档](http://php.net/manual/en/mysqli-result.num-rows.php)。

# emacs - 有什么方法可以让 Emacs 键盘快捷键建议静音吗？

> ID：16095750
> 
> 赞同：5
> 
> 时间：2013-04-19T01:21:06.643
> 
> 标签：emacs, elisp, dot-emacs, emacs24, minibuffer

Emacs 有时会很烦人，它会在 minibuffer 中发出太多信息。例如，当我运行时`M-x gnus`，它告诉我

```
You can run `gnus' with <menu-bar><tools><gnus> 
```

当某些命令有键盘映射时也会发生这种情况。我不需要它们，但我不知道如何删除。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T01:56:05.013

自定义变量`suggest-key-bindings`：值`nil`将禁用键绑定建议。

# c# - 将一维数组插入多维数组

> ID：16095751
> 
> 赞同：1
> 
> 时间：2013-04-19T01:21:10.020
> 
> 标签：c#, multidimensional-array

我正在寻找一种将 4 个一维数组输入 4x4 多维数组的方法。

在我花时间寻找这个的时候，我发现使用锯齿状数组似乎要简单得多。但是，我觉得我遗漏了一些明显的东西，想寻求帮助。

```
for (int x = 0; x <= 3; x++)
{
    //reads in 4 separate values e.g. A B C D
    unitReader = sr.ReadLine();  

    //creates a char array with 4 separate elements
    char[] line = unitReader.ToCharArray();

    //places that array into a bigger jagged array
    fullArray[x] = line; 

    //just to test that it's worked
    Console.WriteLine(fullArray[x]);
} 
```

这就是我如何使用之前定义为的锯齿状数组来做到这一点：

```
char[][] fullArray = new char[4][]; 
```

是否有与此类似的代码允许我按行将值分配给多维数组，而无需执行 16 次传递来分配单个元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:48:33.147

为了可扩展性，您可以尝试这样的自定义集合

```
public class FixedSizeCollection<T> : Collection<T>
{
    protected bool _initializing;
    public int Size { get; private set; }

    public FixedSizeCollection(int size)
    {
        Size = size;
        Init();
    }

    public FixedSizeCollection(int size, IList<T> list) 
    {
        Size = size;
        Init();
        if (list.Count != Size)
            throw new InvalidOperationException("Changing size is not supported.");

        foreach (T item in list)
            Items[list.IndexOf(item)] = item;
    }

    protected virtual void Init()
    {
        _initializing = true;
        base.ClearItems();
        for (int j = 0; j < Size; j++)
            Add(default(T));
        _initializing = false;
    }

    protected override void ClearItems()
    {
        Init();
    }

    protected override void InsertItem(int index, T item)
    {
        if (!_initializing)
            throw new InvalidOperationException("Changing size is not supported.");
        base.InsertItem(index, item);
    }

    protected override void RemoveItem(int index)
    {
        if (!_initializing)
            throw new InvalidOperationException("Changing size is not supported.");
        base.RemoveItem(index);
    }

    protected override void SetItem(int index, T item)
    {
        base.SetItem(index, item);
    }
}

public class SquareArray<T> : FixedSizeCollection<FixedSizeCollection<T>>
{
    public SquareArray(int size) : base(size)
    {
    }

    protected override void Init()
    {
        _initializing = true;
        for (int i = 0; i< Size; i++)
        {
            FixedSizeCollection<T> row = new FixedSizeCollection<T>(Size);
            Add(row);
        }
        _initializing = false;
    }

    protected override void SetItem(int index, FixedSizeCollection<T> item)
    {
        if (item.Count != Size)
            throw new InvalidOperationException("Changing size is not supported.");
        base.SetItem(index, item);
    }
} 
```

那么您的循环将如下所示：

```
SquareArray<char> fullarray = new SquareArray(4);

for (int x = 0; x <= 3; x++)
{
    //reads in 4 separate values e.g. A B C D
    unitReader = sr.ReadLine();  

    //creates a char array with 4 separate elements
    char[] line = unitReader.ToCharArray();

    //places that array into a bigger jagged array
    fullArray[x] = new FixedSizeCollection(4, line); 

    //just to test that it's worked
    Console.WriteLine(fullArray[x]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T02:32:03.917

我认为您正在寻找**Buffer.BlockCopy()**

有关更多详细信息，请参阅[BufferCopy.BlockCopy 文档](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)

# google-drive-api - 对 Google 文档/电子表格/演示文稿的实时更改

> ID：16095754
> 
> 赞同：12
> 
> 时间：2013-04-19T01:21:37.043
> 
> 标签：google-drive-api

是否可以获得对 Google 文档（文档/电子表格/演示文稿）所做更改的实时通知（无需广泛轮询）？如果是这样，模型结构是什么（如果有意义的话）？任何指向文档或示例的指针都会有所帮助！

[https://developers.google.com/drive/manage-changes](https://developers.google.com/drive/manage-changes)上的文档提供了一个 API 调用，该调用会立即返回，并告诉您自上次调用以来是否有任何更改。但是，您几乎在进行更改后就想知道这一点是没有用的——您必须每秒或更早地进行背靠背的 API 调用，并搅动大量资源。相比之下，[Drive Real-time API](https://developers.google.com/drive/realtime/overview)提供了一种无需进行广泛而频繁的轮询即可立即通知任何更改的方法。它通过一个“挂起”的 HTTP 调用来执行此操作，直到准备好更改（或计时器到期）。这是一种经典的长轮询技术。

我的问题是谷歌文档/电子表格/演示文稿是否存在这样的设施。或者它是否仅适用于这些标准文件以外的自定义应用程序特定文件。如果它不可用，是否有任何计划使它们可用？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-28T09:05:38.273

据我所知 - 答案是“不”。我以前试过这个，只能通过定时轮询来做到这一点。API 仅限于仅在您询问时告诉您，而不是在发生某些事情时告诉您。

我想到了一个嵌入到文档中的代码，并对特定的 URL 或某个侦听器进行自我广播。我的实验是使用[Google App Scripts](https://developers.google.com/apps-script/?hl=en)进行的。详细的想法是创建一个在“保存”事件上触发的自定义函数。但是我不能再进一步了，因为据我所知，文档中没有足够的东西来实现这一特定目标。

关于此可用性的时间表，脚本论坛中有关于此的问题，但没有人回答这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T02:55:03.973

看起来像，请参阅[https://developers.google.com/drive/v2/reference/changes](https://developers.google.com/drive/v2/reference/changes)
它也有示例
编辑： [https](https://developers.google.com/drive/manage-changes) ://developers.google.com/drive/manage-changes 有关跟踪更改的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T22:08:07.057

恐怕答案是否定的。当前，当云端硬盘文本文档发生更改时，您无法通过电子邮件收到通知。此功能适用于电子表格，但不适用于文本文件。如果您的文档是公开的，您可以订阅其 RSS 源以查看更改，或使用 Drive 中的工具 -> 修订历史记录功能。有一个可下载的程序 googledocsnotifier [--information--](http://www.techaloud.com/2011/04/get-notified-of-changes-to-your-google-docs-with-google-docs-notifier/)在进行编辑时会向您发送电子邮件，并允许您打开已编辑的文档，但它似乎仅在您在线时才有效。你可以[在这里下载。](http://code.google.com/p/googledocsnotifier/wiki/UserGuide) 希望这可以帮助！

# cordova - 什么是 cordova_plugins.json 文件？Cordova 在初始化时请求它

> ID：16095757
> 
> 赞同：33
> 
> 时间：2013-04-19T01:22:21.977
> 
> 标签：cordova, phonegap-plugins

我正在尝试调试 cordova_plugins.json 文件的用途？

到目前为止，我正在使用多个插件，并且从未与此文件进行过交互。我想弄清楚为什么cordova 在初始化时对该文件发出 xhr 请求。

在查看我的控制台时，每次我在 Chrome 中测试我的应用程序时都会看到这个 404 错误，并且想了解为什么需要这个文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-22T04:40:38.990

It seems like a feature introduced in Cordova 2.6.0, at least I just noticed in this version. At this point I could not find any documentation and I don't have many details on it, but right now I solved the 404 issue adding a dummy cordova_plugins.json file to the root of my project.

As it expects a valid json file I added the following content to the file: "just a dummy file required by Cordova 2.6.0"

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-28T02:37:54.763

似乎这是一个讨论过的已知问题：[here](https://issues.apache.org/jira/browse/CB-3029)

创建一个虚拟 json 文件并没有解决我的问题......确实，在 cordova-2.7.0.js 的末尾删除这整个代码块

```
// Try to XHR the cordova_plugins.json file asynchronously.
try { // we commented we were going to try, so let us actually try and catch
    var xhr = new context.XMLHttpRequest();
    xhr.onload = function() {
        // If the response is a JSON string which composes an array, call handlePluginsObject.
        // If the request fails, or the response is not a JSON array, just call finishPluginLoading.
        var obj = this.responseText && JSON.parse(this.responseText);
        if (obj && obj instanceof Array && obj.length > 0) {
            handlePluginsObject(obj);
        } else {
            finishPluginLoading();
        }
    };
    xhr.onerror = function() {
        finishPluginLoading();
    };
    xhr.open('GET', 'cordova_plugins.json', true); // Async
    xhr.send();
}
catch(err){
    finishPluginLoading();
} 
```

并将其替换为对 finishPluginLoading() 的调用将解决问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-05-03T00:27:16.117

Adobe 的 Filip Maj 在其他地方表示，这是由于（到目前为止）部分实现了插件工具。在 Cordova 的未来版本中，插件工具将自己生成 cordova_plugins.json。

目前，他说完全忽略 404 错误是有好处的。如果您觉得它影响了您的应用程序，您应该向 Cordova 提交错误。

[注意，如果你自己添加一个dummy文件，可能会影响Plugins的集成]

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-05-20T13:47:44.860

i confirm francis answer and would note that on 2.7 if a dummy file is inserted, sometimes it starts an infinite loop on error "processMessage failed: invalid message:" (line cordova-2.7.0.js:971). keeping the 404 error seems indeed safer. (ref: [https://groups.google.com/forum/?fromgroups#!topic/phonegap/slbvvtEw0aw](https://groups.google.com/forum/?fromgroups#!topic/phonegap/slbvvtEw0aw))

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-26T15:32:23.307

该文件确实代表了以前版本的 Cordova/PhoneGap 中的一个错误/松散的结局——并且 nurieta 建议的修复确实解决了在其缺席时引发的（无害的）错误。该文件的后继文件现在完全由[Cordova/PhoneGap CLI](http://cordova.apache.org/docs/en/3.0.0/guide_cli_index.md.html)创建和处理，位于 /myapp/platforms/#platform#/www/cordova_plugins.js

底线 - 尽管文件排序仍然存在，但从 Cordova 3.0 开始，这不再是问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-13T10:14:25.507

我实际上将此文件模拟为一个空的 json 文件，其内容是：“{}”并且 - 使用 cordova 2.6 - 这似乎可以解决问题。没有丑陋的 404，cordova 似乎工作正常。

编辑：您可以从cordova中删除执行ajax请求的代码，一切都会正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-26T14:09:39.640

[您可以在此处](https://issues.apache.org/jira/browse/CB-3029)了解更多信息。

SDK/XDK 中的位置如：xdk-new\xdk\components\server\emulator\resources\cordova_plugins.json

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-05-22T19:25:59.143

你在用煎茶触摸吗？

您可以忽略该错误，但如果您想为 iOS 打包应用程序，您将无法做到。我通过返回 cordova-2.5.0.js 解决了这个问题。

# unit-testing - 这个通用/非通用组合存储库示例是否可模拟？

> ID：16095759
> 
> 赞同：0
> 
> 时间：2013-04-19T01:22:29.337
> 
> 标签：unit-testing, mocking, repository-pattern

我读到使用工作单元/存储库模式的主要原因之一是可以在单元测试期间模拟您的数据访问层。如果这是真的，那么在我看来，制作这样的存储库（在有关该主题的各种博客上看到）似乎会使事情变得比模拟时更复杂。鉴于您只有*ICustomerRepository*可以在模拟框架中使用，您将如何模拟*GenericRepository*的方法？

 *```
public class CustomerRepository : GenericRepository<Customer>, ICustomerRepository
{
    public CustomerRepository(ObjectContext context) : base(context) { }

    public IList<Customer> NewlySubscribed()
    {
        var lastMonth = DateTime.Now.Date.AddMonths(-1);

        return GetQuery().Where(c => c.Inserted >= lastMonth)
        .ToList();
    }

    public Customer FindByName(string firstname, string lastname)
    {
        return GetQuery().Where(c => c.Firstname == firstname && c.Lastname == lastname).FirstOrDefault();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:33:26.160

是的，在我问这个问题之前，也许我应该读过一本关于面向对象编程的书（但它们非常耗时），ICustomerRepository 继承自 IGenericRepository 并且所有单元测试都很好。*

# java - 在 Eclipse 中搜索常量中定义的文本

> ID：16095761
> 
> 赞同：1
> 
> 时间：2013-04-19T01:22:34.603
> 
> 标签：java, eclipse

我正在剖析一些可怕的应用程序，我的部分任务是找到一些数据库行的数据来自哪里。我知道列的名称是什么，并且应用程序使用`public static final String`在共享的已编译 .jar 中定义的 s 来引用它们。我的目标是找到定义列的实际常量 String 对象，并使用 Eclipse 的调用层次结构功能向后工作并找到它的使用位置。

但是，“Java 搜索”不起作用，因为它只查看字段/类型名称，而不是值，并且基本文本或文件搜索不起作用，因为常量位于已编译的“.class”文件中。字段名称也不是很整齐 ( `public static final String COLUMN_CUSTOMER = "customerId";`)，因此很难真正找到它们。

Eclipse 中是否有搜索字符串常量值的搜索功能？我正在使用 Eclipse 3.8（靛蓝）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:44:23.040

[http://java.decompiler.free.fr/](http://java.decompiler.free.fr/)

你应该尝试这个来反编译你的 jar，这样你就可以搜索它，但如果它被混淆，它不会完全有帮助。我希望它可以帮助你！

# java - 更改预定义的 java 日期格式化程序的格式

> ID：16095762
> 
> 赞同：1
> 
> 时间：2013-04-19T01:22:40.057
> 
> 标签：java, jakarta-ee, localization, date-format

有没有办法更改 DateFormat 类用于打印特定语言环境的日期的日期（模式）格式？

让我解释一下我所处的情况。我有一个大型 Web 应用程序，它在一些基于 java 的专有服务器 (IBM Domino) 上运行（版本 1.6 + 自定义 jsf 1.1 实现）。此应用程序使用了一些无法更改的现成组件。这些组件在内部使用 DateFormat 在某些页面上显示漂亮的日期。

它们是多语言的，并且在大多数语言中，使用的日期格式都可以。但是有一种语言使用了错误的格式（至少在某种意义上——没有官方标准，所以一些主要组织为自己选择不同的格式）。

那么，是否有可能对此进行配置，或者它只是在 java 标准库中的某个地方硬编码并且无法更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T05:32:37.143

实现[DateFormatProvider](http://docs.oracle.com/javase/7/docs/api/java/text/spi/DateFormatProvider.html)的实例，创建文件`META-INF/services/java.text.spi.DateFormatProvider`并将实现的完全限定名称放入其中。
打包为 jar，将 jar 放入类路径，然后您“拥有” `DateFormat`.

也可以看看：

*   [http://docs.oracle.com/javase/7/docs/api/java/util/spi/LocaleServiceProvider.html](http://docs.oracle.com/javase/7/docs/api/java/util/spi/LocaleServiceProvider.html)

# java - java方法中while语句的逻辑问题

> ID：16095765
> 
> 赞同：0
> 
> 时间：2013-04-19T01:23:11.207
> 
> 标签：java, crash, while-loop

背景资料：

我正在开发一款战舰游戏，在游戏中我有一个 10x10 int[][]（网格）。

我开发了一种方法，只要尚未尝试过相同的位置，它就会尝试命中该阵列或网格上的单元格。（这是为了与我对战的计算机）。

```
 public boolean randomShot()
{
    int row;
    int col;
    boolean wasHit = false;
    boolean complete = false;

   while (complete == false)
   {
    // Randomly generate a row and column
       row = randomizer.nextInt(ROW_COUNT);
       col = randomizer.nextInt(COLUMN_COUNT);

    if(compShots.contains("" + row + col) == false)
    {
        complete = true;
        if(checkHit(row, col) == true)
        {
            wasHit = true;

        }
        compShots.add("" + row + col);
    }

   }
    return wasHit;
} 
```

上述方法效果很好，我很满意。

问题 ：

我想开发一种基于上述方法的方法，但是在某种意义上说，如果他击中第 3 行和第 3 列，则计算机的行为会更聪明一些。然后它接下来会尝试击中第 3 行和第 4 列等。但是如果下一列或下一行超出了棋盘的边界，那么它将尝试以另一种方式进行。

while 循环目前正在使游戏崩溃，知道为什么吗？

这是我必须用更多的大脑来打阵列的方法可以这么说

```
 public boolean randomShotClever()
{
    int row;
    int col;
    boolean wasHit = false;
    boolean complete = false;

   while (complete == false)
   {

    // Randomly generate a row and column
       row = randomizer.nextInt(ROW_COUNT);
       col = randomizer.nextInt(COLUMN_COUNT);

       if(previousRows.size() == 0 || compShots.contains("" + (previousRows.size() -1) + (previousCols.size() -1) ))       
       {
           finalRow = previousRows.get(previousRows.size());
           if((finalRow + 1) < (ROW_COUNT -1))
           {
               finalRow = finalRow + 1;
           }
           else 
           {
               finalRow = row;
           }

           finalCol = previousCols.get(previousCols.size());
           if((finalCol + 1) < (COLUMN_COUNT -1 ))
           {
               finalCol = finalCol + 1;
           }
           else 
           {
               finalCol = col;
           }

           if(compShots.contains("" + finalRow + finalCol) == false)
           {
            complete = true;
            if(checkHit(finalRow, finalCol) == true)
            {
                previousCols.add(finalCol);
                previousRows.add(finalRow);
                wasHit = true;
            }
            compShots.add("" + finalRow + finalCol);
           }

       }

   }
    return wasHit;
} 
```

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:25:20.690

比较是倒退的

```
if((finalRow + 1) > (ROW_COUNT -1))
       {
           finalRow = finalRow + 1; 
```

又在

```
 if((finalCol + 1) > (COLUMN_COUNT -1)) 
```

“如果我太大，让我变得更大”。

可能还有其他人喜欢它。

# perl - 打开目录并按创建日期对文件进行排序

> ID：16095767
> 
> 赞同：8
> 
> 时间：2013-04-19T01:23:33.470
> 
> 标签：perl, file, sorting

我需要在创建文件时打开目录并对其进行排序。我可以找到一些讨论，使用 Perl、排序和文件的标签，根据修改日期对文件进行排序。我认为这是比按创建日期排序更常见的需求。我使用 Perl。以前有一些关于 Perl 以外的其他语言（例如 php 或 java）按创建日期排序的帖子。

例如，我需要执行以下操作：

```
opendir(DIR, $ARGV[0]);                             
my @files = "sort-by-date-created" (readdir(DIR)); 
closedir(DIR);

do things with @files... 
```

CPAN 有一个关于排序命令的页面，但对我来说不是很容易访问，而且我在页面上找不到“日期”或“创建”字样。

作为对编辑的回应，我应该说我使用的是 Mac，OS 10.7。我知道在 Finder 中，有一个按创建日期排序的选项，因此必须有某种指示以某种方式附加到该系统中的文件的创建日期。

作为对答案的回应，这里是尝试对文件进行排序的脚本的另一个版本：

```
#!/usr/bin/perl
use strict; use warnings;

use File::stat; # helps with sorting files by ctime, the inode date that hopefully can serve as creation date

my $usage = "usage: enter name of directory to be scanned for SNP containing lines\n";
die $usage unless @ARGV == 1;

opendir(DIR, $ARGV[0]);                             #open directory for getting file list
#my @files = (readdir(DIR));
my @file_list = grep ! /^\./, readdir DIR; 
closedir(DIR);  

print scalar @file_list."\n";

for my $file (sort {
        my $a_stat = stat($a);
        my $b_stat = stat($b);
        $a_stat->mtime <=> $b_stat->mtime;
    }  @file_list ) {
    say "$file";
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-19T01:49:29.163

您可以通过向[排序](http://perldoc.perl.org/functions/sort.html)函数提供子例程或代码块来自定义排序顺序。

*   在这个子块或块中，您需要使用特殊变量`$a`和`$b`，它们表示比较 @array 中的值。
*   sub 或 block 需要返回一个小于、等于或大于的值`0`来指示`$a`是小于、等于还是大于`$b`（分别）。
*   您可以使用特殊的比较运算符（`<=>`用于数字、`cmp`字符串）为您执行此操作。

所以默认排序`sort @numbers`等价于`sort {$a <=> $b} @numbers`.

在按创建时间排序的情况下，您可以使用[stat](http://perldoc.perl.org/functions/stat.html)函数来获取有关文件的信息。它返回有关文件的一系列信息，其中一些可能不适用于您的平台。文件的最后修改时间通常是安全的，但*创建时间不是*。（它返回的`ctime`第 11 个值）尽可能接近（它表示 *nix 上的 inode 更改时间，win32 上的创建时间），它表示为自 epoch 以来的秒数，这很方便，因为它意味着你可以做一个简单的数字排序。

```
my @files = sort {(stat $a)[10] <=> (stat $b)[10]} readdir($dh); 
```

我不确定您是否也想过滤掉目录。如果是这种情况，您可能还想使用`grep`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T03:07:30.463

> ***我需要在创建文件时***打开目录并对文件进行排序。

你不能。*创建时间*根本不存在。*nix 类操作系统跟踪三个时间元素：

*   **mtime**：这是文件最后一次*修改*的时间。
*   **atime**：这是上次*访问*文件的时间。
*   **ctime**：这是上次修改[inode的时间。](https://en.wikipedia.org/wiki/Inode)

在 Unix 中，某些文件信息存储在*inode*中。这包括您在获取文件的 Perl 时看到的各种内容`stat`。这是用户的名称、文件的大小、它所在的设备、链接数，以及具有讽刺意味的是*mtime*、*atime*和*ctime*时间戳。

为什么没有*创建时间*？因为你会如何定义它？如果我移动文件怎么办？如果有新的创建时间（顺便说一句，*ctime*不会随着移动而改变）。如果我复制文件怎么办？新副本是否应该有新的创建时间？如果我做了一个副本，然后删除了原件怎么办？如果我编辑了一个文件怎么办？如果我用我的编辑更改了文件中的所有内容呢？还是我编辑了文件，然后将其重命名为全新的名称？

即使在具有*文件创建时间*的 Windows 上，也不会真正跟踪文件的创建。它仅跟踪创建目录条目的时间，这有点`ctime`像。而且，您甚至可以通过 Windows API修改此*创建时间。*我怀疑 Mac 的文件创建时间是 HFS 文件系统的遗物，实际上并没有像首次创建目录条目的时间那样指向文件创建时间。

* * *

正如其他人指出的那样。您可以在排序例程中添加一段代码，说明您希望如何排序。这是一个快速的例子。注意我使用[File::stat](http://perldoc.perl.org/File/stat.html)它为我提供了旧命令的良好*名称接口。*`stat`如果我使用旧的*stat*命令，我会得到一个数组，然后必须找出我想要的项目在数组中的位置。在这里，`stat`命令给了我一个*stat*对象，我可以使用`mtime`, `atime`, 或`ctime` *方法*来提取正确的时间。

我还使用which 是专门为命令块`<=>`制作的比较运算符。`sort`

排序命令给你两个项目`$a`和`$b`。您使用这两个项目来确定您想要什么，然后使用或者`<=>`说`cmp`是否`$a`更大，`$b`更大，或者它们的尺寸相同。

```
#! /usr/bin/env perl

use 5.12.0;
use warnings;

use File::stat;

my $dir_name = shift;

if ( not defined $dir_name ) {
    die qq(Usage: $0 <directory>);
}

opendir(my $dir_fh, $dir_name);

my @file_list;
while ( my $file = readdir $dir_fh) {
    if ( $file !~ /^\./ ) {
        push @file_list, "$dir_name/$file"
    }
}
closedir $dir_fh;

say scalar @file_list;

for my $file (sort {
        my $a_stat = stat($a);
        my $b_stat = stat($b);
        $a_stat->ctime <=> $b_stat->ctime;
    }  @file_list ) {
    say "$file";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T01:43:46.663

OS X 将创建日期存储在 Mac 特定的元数据中，因此标准 Perl 文件系统函数不知道它。您可以使用[MacOSX::File](http://search.cpan.org/dist/MacOSX-File/)模块来访问此信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T01:30:17.673

```
#!/usr/bin/env perl
use strict;
use warnings;
opendir(DIR, $ARGV[0]);
chdir($ARGV[0]);
my @files = sort { (stat($a))[10] <=> (stat($b))[10] } (readdir(DIR));
closedir(DIR);
print join("\n",@files); 
```

`stat`为您提供文件的各种状态信息。其中字段 10 是 ctime（在支持它的文件系统上），它是 inode 更改时间（不是创建时间）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-17T17:29:42.223

[`Mojo::File`](https://metacpan.org/pod/Mojo::File)带来了一些有趣且可读的方法来做到这一点。

```
#!/usr/bin/env perl
use Mojo::File 'path';

my $files_list = path( '/whatever/dir/path/' )->list;

# Returns an array of Mojo::File
my @files = sort { $a->stat->ctime <=> $b->stat->ctime }
  map { $_ }  $files_list->each;

# Returns an array of paths sorted by modification date (if needed)
my @paths = map { $_->realpath->to_string } @files; 
```

# global-variables - 当组件调用单元时，c ++ builder XE2中的变量未初始化

> ID：16095768
> 
> 赞同：0
> 
> 时间：2013-04-19T01:23:37.153
> 
> 标签：global-variables, c++builder, c++builder-xe2

我有一个带有声明的单元（WebFunctions.h）

```
String RawURLAllowedChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~.-_"; 
```

这个单元在应用程序中运行良好。但是当我添加一个也声明的组件时，不会发生`WebFunctions.h`初始化（ ）。`RawURLAllowedChars``RawURLAllowedChars = NULL`

要让应用程序恢复工作，加上删除组件的类声明仍然需要删除`WebFunctions.obj`文件。

注意：`.cpp`文件中的任何声明，无论是否有文件中的`extern`声明`.h`，都不起作用。

这是 XE2 中的错误还是我遗漏了什么？谢谢。

Obs.: 内部变量声明`#ifndef .. #endif`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T05:20:53.890

不要在头文件中初始化全局变量。在.h文件中声明变量`extern`，然后在对应的.cpp文件中进行初始化，例如：

WebFunctions.h：

```
extern const String RawURLAllowedChars; 
```

WebFunctions.cpp：

```
const String RawURLAllowedChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~.-_"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:29:10.313

这更像是一种解决方法，而不是真正的解决方案......但是......

注释（在主应用程序的 .cpp 文件中）带有**#pragma link "Component"**的行，添加使用 WebFunctions.h 的组件（不是初始化单元）。

删除 Debug\Win32 文件夹中的所有构建文件。

重新编译应用程序。

# tfs - 通过 Visual Studio Team Services 分发开源项目

> ID：16095771
> 
> 赞同：0
> 
> 时间：2013-04-19T01:23:47.247
> 
> 标签：tfs, open-source, azure-devops

我使用 Visual Studio Team Services (visualstudio.com) 进行所有源代码控制。我想让我的几个项目开源并授予公共访问权限以下载源代码。有谁知道是否有办法配置 Visual Studio Team Services 项目来促进这一点？具体来说，我需要一种方法来授予每个人读取权限，但限制写入权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T07:10:52.343

在撰写本文时，这是不可能的，但我为它创建了一个 UserVoice 请求。所以，如果你想要它，就去投票吧。

[http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3701461-in-team-foundation-service-allow-projects-to-be-](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3701461-in-team-foundation-service-allow-projects-to-be-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:41:31.037

我不相信您可以授予“每个人”的访问权限。我不相信托管系统中*有*“每个人”的概念。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T10:59:43.977

正如[明眼人所说](https://stackoverflow.com/a/16099150/6438)，目前这是不可能的。 [CodePlex](http://codeplex.com)将用于基于 TFS 的开源项目。

# java - 试图用 Java 制作多个客户端服务器？

> ID：16095778
> 
> 赞同：0
> 
> 时间：2013-04-19T01:24:20.840
> 
> 标签：java, sockets

出于某种原因，当我运行我的服务器代码时，服务器窗口会弹出，但随后它会冻结并且不允许我做任何事情。我已经对我的代码进行了试验，似乎`while`循环是问题所在，因为当我删除它时，它工作正常。但我需要`while`为许多客户提供服务的循环。这是代码：

注意：该变量`numClients`已经在其他地方初始化和实例化。

```
 try{

        ServerSocket serverSocket = new ServerSocket(8000);
        textArea.append("Server started on " + new Date() + "\n");          

        while(numClients <= 5){

         Socket socket = serverSocket.accept();

         InetAddress inetAddress = socket.getInetAddress();

             textArea.append("Client \"" + inetAddress.getHostName() + "\" has                          
                             connected!");
         textArea.append("The IP address of \"" + inetAddress.getHostName() +     
                         "\" is   " + inetAddress.getHostAddress());    

         HandleClient task = new HandleClient(socket);
         new Thread(task).start();

         numClients++;

    }
}
catch(IOException ex){
    ex.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:35:28.777

方法调用：`serverSocket.accept()`是阻塞的，这意味着它将停止当前线程，直到有人连接。这意味着如果在读取输入的同一线程中完成，则不会收到用户输入。

这意味着如果没有`while`循环，您将收到一个连接并保留此代码，但使用`while`循环您将继续阻塞并接收新连接。

要解决您的问题，您需要`while`在单独的线程上运行循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:36:35.453

发生的事情是当你调用`Socket socket = serverSocket.accept();`线程“阻塞”直到它收到一个 connected `Socket`。并导致你的 GUI 和`Socket`包含在同一个线程中，你的 GUI 出现无响应。

您要做的是查看线程并在 GUI 的单独线程中运行连接接受代码。这样，您的 GUI 将保持独立于您的线程，并且在您等待连接`Socket`时不会被阻塞。`Socket`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:37:45.530

您不应该尝试让多个线程在同一个端口上接受连接。您应该有一个线程接受（多个客户端请求在端口排队），然后您可以生成一个新线程来处理每个接受的连接。

看：

*   [http://www.oracle.com/technetwork/java/socket-140484.html#multi](http://www.oracle.com/technetwork/java/socket-140484.html#multi)

*   [基于线程的服务器套接字](http://www.java2s.com/Tutorial/Java/0320__Network/ThreadbasedServerSocket.htm)

# spring - 使用 Spring Session Factory 时如何配置 Hibernate

> ID：16095779
> 
> 赞同：2
> 
> 时间：2013-04-19T01:24:37.833
> 
> 标签：spring, hibernate-tools

我正在尝试在 Eclipse 中设置休眠工具。问题是它找不到任何映射文件。

我创建了一个控制台配置，它指向我的 environment.properties 文件和 hibernate.cfg.xml。问题是 hibernate.cfg.xml 中没有映射。

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
  <session-factory>
  </session-factory>
</hibernate-configuration> 
```

似乎它正在使用 myproject-persistence.xml（如下）中的 spring bean sessionFactory 来查找所需的映射文件。我看不到可以将此文件添加到 Eclipse 中的控制台配置的任何地方。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
      <property name="driverClass" value="${hibernate.connection.driver_class}" />
      <property name="jdbcUrl" value="${hibernate.connection.url}" />
      <property name="user" value="${hibernate.connection.username}" />
      <property name="password" value="${hibernate.connection.password}" />
      <property name="initialPoolSize" value="5" />
      <property name="minPoolSize" value="5" />
      <property name="maxPoolSize" value="25" />
      <property name="acquireIncrement" value="5" />
      <property name="maxIdleTime" value="1800" />
      <property name="numHelperThreads" value="5" />
    </bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
      <property name="dataSource" ref="dataSource" />
      <property name="hibernateProperties">
        <props>
          <prop key="hibernate.dialect">${hibernate.dialect}</prop>
          <prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</prop>
        </props>
      </property>
      <property name="configLocation" value="classpath:hibernate.cfg.xml" />
      <property name="mappingLocations">
        <list><value>classpath*:com/mybusiness/myproject/platform/api/**/*.hbm.xml</value></list>
      </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <tx:annotation-driven />
</beans> 
```

我怎样才能得到这个工作？

* * *

**更新**

通过将其添加到“编辑配置”中的“映射”选项卡中，我设法使单个映射工作。但是，我不能在这里使用通配符，并且必须手动添加每个映射。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T05:06:32.793

Hibernate Tools 在 Hibernate 4.x 版本下不可用。它适用于 3.2 版。如果您使用的是 maven，则依赖项如下：

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-tools</artifactId>
    <version>3.2.4.GA</version>
    <scope>runtime</scope>
</dependency> 
```

现在，工具的休眠配置与 spring 无关。一个示例 xml 将是（此示例中的值适用于 sql server）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory name="reversengineeringfactory">
        <property name="hibernate.connection.driver_class">net.sourceforge.jtds.jdbc.Driver</property>
        <property name="hibernate.connection.url">jdbc:jtds:sqlserver://myinstance:port/mydb</property>
        <property name="hibernate.connection.username">dbuser</property>
        <property name="hibernate.connection.password">dbpass</property>
        <property name="hibernate.default_catalog">mydb</property>
        <property name="hibernate.dialect">org.hibernate.dialect.SQLServerDialect</property>
    </session-factory>
</hibernate-configuration> 
```

现在，为了在 eclipse 中配置 hibernate config xml，你应该选择 Hibernate Perspective --> Edit Configuration --> Go for configuration File Setup。

下面是一个示例逆向工程 xml（对代码生成进行精细控制）

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-reverse-engineering PUBLIC "-//Hibernate/Hibernate Reverse Engineering DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-reverse-engineering-3.0.dtd" >

<hibernate-reverse-engineering>
    <table-filter match-schema="dbo" match-name="Employee"
        package="com.maggu.domain.model" />
    <table-filter match-schema="dbo" match-name="Company"
        package="com.maggu.domain.model" />

    <table schema="dbo" name="Employee">
        <primary-key>
            <generator class="identity" />
        </primary-key>
    </table>
    <table schema="dbo" name="Company">
        <primary-key>
            <generator class="identity" />
        </primary-key>
    </table>
</hibernate-reverse-engineering> 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T19:33:28.073

如果您使用注释来创建持久性实体，那么您可以这样做：

```
<bean id = "mySessionFactory" class = "org.springframework.orm.hibernate4.LocalSessionFactoryBean">

        <property name = "packagesToScan">
        <list>
            <value>entityclasses</value>
        </list>
        </property> 
```

其中 entityclasses 是包含所有实体类的包。让我知道它是否有帮助！

# javascript - Windows Phone 8 HTML5 应用程序和主题

> ID：16095784
> 
> 赞同：3
> 
> 时间：2013-04-19T01:25:26.470
> 
> 标签：javascript, html, windows-phone-8

我正在开发一个 WP8 HTML5 游戏，并试图响应用户选择的主题。

我知道我可以在 CSS 中使用 Background 标签

```
body {
    font-size: 11pt;
    font-family: "Segoe WP";
    letter-spacing: 0.02em;
    background-color: Background;
    color: #FFFFFF;
    margin-
} 
```

所以现在背景从黑色变为白色，但不是文本颜色，显然是因为我将它设置为#FFFFFF

我尝试在 javascript 中更改它，但奇怪的是，当我尝试 document.body.style.backgroundcolor 时它返回“”，甚至使用由 HEX 或 RGB 设置的变量也会返回 false。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T15:03:53.353

MainPage.xaml.cs

```
private void Browser_Loaded(object sender, RoutedEventArgs e)
{
    Browser.IsScriptEnabled = true;

    // Add your URL here
    Browser.Navigate(new Uri(MainUri, UriKind.Relative));

    Browser.Navigated += (o, s) => {
        string theme = ((Visibility)Application.Current.Resources["PhoneLightThemeVisibility"] == Visibility.Visible) ?
            "light" : "dark";

        Browser.InvokeScript("eval", String.Format("document.body.className += ' {0}'", theme));
    };

} 
```

电话.css

```
body {
    font-size: 11pt;
    font-family: "Segoe WP";
    letter-spacing: 0.02em;
    background-color: Background;
    margin-left: 24px;
}

.light {
    color: #000000;
}

.dark {
    color: #FFFFFF;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:52:51.767

`document.body.style.backgroundcolor`拼写错误...

尝试：`document.body.style.backgroundColor`
使用大写字母`C`。

要更改正文的颜色文本，您可以使用`document.body.style.color`

* * *

**编辑：**

顺便说一句，可能有更好的方法来解决您的问题，如果您要更改很多 css 属性，您应该创建 css 类，如下所示：

```
body {
    /* default body css */
}

.myFirstColorSet {
    background-color: #FFF;
    color: #000;
    ...
}

.mySecondColorSet {
    background-color: #000;
    color: #FFF;
    ...
} 
```

然后用javascript，只需切换body类

```
document.body.className = "mySecondColorSet"; 
```

这是这个例子的小提琴：http: [//jsfiddle.net/promatik/K75TG/](http://jsfiddle.net/promatik/K75TG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T18:00:21.227

虽然上面的 XAML 有效，但这个简单的 jQuery 脚本也有效

```
 <script>
    if ($("body").css("background-color") == 'rgb(0, 0, 0)'){
      $("body").css("color","rgb(255, 255, 255)");
    }
    else{
      $("body").css("color","rgb(0, 0, 0)");
    }
  </script> 
```

# java - 在预设鼠标上绘制自定义鼠标

> ID：16095791
> 
> 赞同：1
> 
> 时间：2013-04-19T01:27:03.733
> 
> 标签：java, awt, paint, mouse-cursor

我正在制作游戏，当我将精灵添加到屏幕上时，它们自然就在我的鼠标后面。但我想在鼠标上向我的屏幕添加自定义鼠标图像。

我已经有了鼠标的精灵，而且我知道要让图像出现在鼠标所在的任何地方。唯一的事情是我已经知道它会出现在我的鼠标下方。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:28:45.890

将图像设置为自定义[`Cursor`](http://docs.oracle.com/javase/7/docs/api/java/awt/Cursor.html). 参见[`Toolkit.createCustomCursor(Image,Point,String)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Toolkit.html#createCustomCursor%28java.awt.Image,%20java.awt.Point,%20java.lang.String%29)将图像变成光标。

# backbone.js - Backbone - 通过视图中的集合访问模型默认值

> ID：16095799
> 
> 赞同：0
> 
> 时间：2013-04-19T01:28:03.983
> 
> 标签：backbone.js, backbone.js-collections

好的，可能不太清楚。

我将一个集合传递给我的视图。我的收藏有一个模型，模型在数组中有默认值。当我从视图中记录集合时，它没有显示长度。但是我的模型中有 4 个默认值。我怎样才能让我的模型的默认值出现在我的视图中？

查看调用：

```
var menuLinks = new App.Collections.MenuLinks ;
var newView = new App.Views.Navbar({ collection: menuLinks }) ; 
```

看法：

```
App.Views.Navbar = Backbone.View.extend({

   initialize: function(){

   console.log(this.collection) ;
     //this.render() ;

   }

}); 
```

收藏：

```
App.Collections.MenuLinks = Backbone.Collection.extend({

model: App.Models.MenuLinks

}); 
```

模型：

```
App.Models.MenuLinks = Backbone.Model.extend({

//Default menus
defaults:[
    {
        name: 'Home',
        href: ''
    },
    {   name: 'Trips',
        href: '#trips'
    },
    {   name: 'Login',
        href: '#login'
    },
    {   name: 'LogoutOhYeah',
        href: '#logout'
    },
]

 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:39:34.787

所以......你只是想要这样的东西：

```
var collection = this.options.collection, defaults;
defaults = collection.length && collection.models[0].defaults ||{}; 
```

# php - 在 PHP 中运行密集的批处理，并避免内存耗尽

> ID：16095802
> 
> 赞同：5
> 
> 时间：2013-04-19T01:28:56.300
> 
> 标签：php, json, cakephp, memory, memory-management

我有几千条记录（存储在 MYSQL 表的表中）需要“批处理”。所有记录都包含一个大型 JSON。在某些情况下，JSON 超过 1MB（是的，我的数据库远远超过 1GB）。

我有一个获取记录、解码 JSON、更改一些数据、将 PHP 数组重新编码回 JSON 并将其保存回数据库的函数。很简单。FWIW，这是在 CakePHP 应用程序的上下文中。

给定一组 ID，我正在尝试做这样的事情（非常简单的模拟代码）：

```
foreach ($ids as $id) {
    $this->Model->id = $id;
    $data = $this->Model->read();
    $newData = processData($data);
    $this->Model->save($newData);
} 
```

问题是，PHP 很快就会耗尽内存。像这样运行 foreach 时，几乎就像 PHP 从一条记录移动到另一条记录，而没有释放前面操作所需的内存。

无论如何运行一个循环，以便在进入循环的下一次迭代之前释放内存，以便我可以实际处理大量数据？

编辑：添加更多代码。该函数采用我的 JSON，将其转换为 PHP 数组，进行一些操作（即，根据另一个数组中存在的内容重新配置数据），并替换原始数组中的值。JSON 有很多层，因此 foreach 循环非常长。

```
function processData($theData) {
    $toConvert = json_decode($theData['Program']['data'], $assoc = true);
    foreach($toConvert['cycles'] as $cycle => $val) {
        foreach($toConvert['cycles'][$cycle]['days'] as $day => $val) {
            foreach($toConvert['cycles'][$cycle]['days'][$day]['sections'] as $section => $val) {
                foreach($toConvert['cycles'][$cycle]['days'][$day]['sections'] as $section => $val) {
                    foreach($toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'] as $exercise => $val) {
                        if (isset($toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFolder'])) {
                            $folderName = $toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFolder']['folderName'];
                            if ( isset($newFolderList['Folders'][$folderName]) ) {
                                $toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFolder'] = $newFolderList['Folders'][$folderName]['id'];
                            }
                        }
                        if (isset($toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFile'])) {
                            $fileName = basename($toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFile']['fileURL']);
                            if ( isset($newFolderList['Exercises'][$fileName]) ) {
                                $toConvert['cycles'][$cycle]['days'][$day]['sections'][$section]['exercises'][$exercise]['selectedFile'] = $newFolderList['Exercises'][$fileName]['id'];
                            }
                        }
                    }
                }
            }
        }
    }
    return $toConvert;
} 
```

Model->read() 本质上只是告诉 Cake 从数据库中提取一条记录，并将其返回到一个数组中。幕后发生了很多事情，需要更有知识的人来解释一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:11:50.100

我要做的第一步是确保所有内容都通过引用传递。

例如，

```
foreach ($ids as $id) {
processData($data);
}

function processData(&$d){} 
```

[http://php.net/manual/en/language.references.pass.php](http://php.net/manual/en/language.references.pass.php)

# php - 在 PHP 中上传文件

> ID：16095805
> 
> 赞同：0
> 
> 时间：2013-04-19T01:29:43.647
> 
> 标签：php, html, forms, file-upload, upload

我正在尝试建立一个用户可以上传文件的网站。我在此代码上方有一些基本参数（例如确保他们已登录等）。我已经缩小了我的错误所在。每当我尝试上传文件时，它都会加载很长时间（即使它只是一个小的 JPG），并且什么也不显示。我已经浏览了一堆以前的问题，但它们并没有真正帮助。

HTML

```
<form name="contact" action="action.php" method="post" enctype="multipart/form-data">
<input type="file" name="file" id="file" multiple><br><div id="adder"></div>
<input type="submit" name="submit" value="Submit">
</form> 
```

PHP

```
for($i=0; $i<count($_FILES['file']['name']); $i++) {
    //Get the temp file path
    $tmpFilePath = $_FILES['file']['tmp_name'][$i];
    //Make sure we have a filepath
    if ($tmpFilePath != ""){
        //Setup our new file path
        $newFilePath = "uploads/".$_FILES['file']['name'][$i];
        //Upload the file into the temp dir
        if(move_uploaded_file($tmpFilePath, $newFilePath)){ 
            set_time_limit(0);  
            echo "Thanks for your submission! Your file was uploaded.;  
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:50:05.543

改变你的这一行：

```
<input type="file" name="file" id="file" multiple><br><div id="adder"></div> 
```

到

```
<input type="file" name="file[]" id="file" multiple><br><div id="adder"></div> 
```

并且请编写正确的代码，因为不完整的信息会因为代码不起作用的实际原因而将人们带走。（您没有在那里关闭 for 循环）

我还假设您在保存任何内容之前使用 $_POST[] 检查了 POST 请求，以确保有人实际提交了表单。

# c++ - ruby 按引用传递与按值传递引用

> ID：16095820
> 
> 赞同：2
> 
> 时间：2013-04-19T01:31:18.520
> 
> 标签：c++, ruby, pass-by-reference

来自沉重的 C++ 背景，我很难理解 ruby​​ 函数参数是如何传递的，或者更确切地说，我很难理解传递引用和传递引用值之间的语义差异，这似乎成为红宝石社区中的区别。有很多关于这个主题的信息相互矛盾的资源（包括这个网站，我在下面发布了这个网站，回复似乎有很大不同）。

[Ruby 是按引用传递还是按值传递？](https://stackoverflow.com/questions/1872110/is-ruby-pass-by-reference-or-by-value)

我的困惑是在 C++ 中通过引用：

```
int function(Object& i)
{
    //cannot change the memory location of i in this function

    //only the value can change
    Object.param1 = 3;
} 
```

或通过指针：

```
int function(Object* i)
{ 
    //this change will be visible in the calling function scope
    Object->param1 = 4;

    //this however will have no effect from the calling code
    i = new Object(); 
} 
```

在这两种情况下，在我看来，包含在 Object 中的值可以改变。但是，它的引用/指针不能。然而，我看到人们根据您无法更改引用所指向的内容这一事实来区分按引用传递和按值传递引用。但是，鉴于如果没有指向指针的指针就无法做到这一点，我不明白为什么要进行这种区分。

在我看来，Ruby 的行为方式相同：

```
class TestObject
    attr_accessor :param1

    def initialize()
        @param1 = 0
    end
end

def func(objtst)
    objtst.param1 = 12
end

obj_test = TestObject.new
puts obj_test.param1 #outputs 0
func(obj_test)
puts obj_test.param1 #now outputs 12 
```

那么按引用传递和按引用传递值有什么区别呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:43:51.427

> 我不明白为什么要进行这种区分。

这种区别是传递引用的*本质。*在您的第一个函数中，您可以对参数进行简单的赋值：`i = something`，它会做与调用范围内的赋值相同的事情。在您的第二个函数中，`i = something`永远不会对调用范围产生影响。事实上，在第二个函数中没有什么可以做的，它的语义与在调用范围内分配给变量的语义完全相同。就是这样。这就是区别。

在 Ruby（以及 Python、Java 和许多其他语言）中，分配给参数变量（带`=`）永远不会影响调用范围。因此，它们是按值传递的。

# codeigniter - 会话数据在codeigniter中丢失得如此之快

> ID：16095821
> 
> 赞同：-3
> 
> 时间：2013-04-19T01:31:27.450
> 
> 标签：codeigniter, session

我已经使用 codeignitet 构建了一个 Web 应用程序。我的应用程序中有大约 200 个用户。当用户登录时，它成功，但会话数据只保留大约一分钟，然后自动终止。

我使用 ci_sessions 来存储自定义会话数据。

这是我的会话配置：

```
$config['sess_cookie_name']     = 'ci_session';
$config['sess_expiration']      = 7200;
$config['sess_expire_on_close'] = FALSE;
$config['sess_encrypt_cookie']  = FALSE;
$config['sess_use_database']    = TRUE;
$config['sess_table_name']      = 'ci_sessions';
$config['sess_match_ip']        = FALSE;
$config['sess_match_useragent'] = TRUE;
$config['sess_time_to_update']  = 900; 
```

在我的应用程序中，如果会话终止，它将重定向到登录页面。它总是重定向并重定向到登录页面，我认为它会导致会话数据迅速丢失。需要帮助和感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:06:50.520

您的会话配置看起来不错，并且您还将它存储在数据库中，这也是一个很好的做法。

似乎您的代码中的某个地方正在破坏会话或其中的一部分。如果您无法自己追踪，我们必须查看一些代码。

祝你好运！

# ant - Groovy AntBuilder 文件排序

> ID：16095831
> 
> 赞同：-1
> 
> 时间：2013-04-19T01:32:37.470
> 
> 标签：ant, groovy

groovy AntBuilder 风格选择排序文件：

```
def ant = new AntBuilder();
def files =   ant.first(count:1){
        sort(){
            fileset(dir:/R:\goagent2/){
                depth  max:0
            }
           // reverse(){ date(); }
            date()
        }
    }*.file; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:20:32.233

为什么不直接用普通的 Groovy 来做呢？

```
def oldestFile = new File( /R:\goagent2/ ).listFiles()
                                          .sort { it.lastModified() }
                                          .head() 
```

# c# - Automapper 复杂对象

> ID：16095832
> 
> 赞同：4
> 
> 时间：2013-04-19T01:32:37.783
> 
> 标签：c#, automapper

我已经开始实施了；
[Automapper，映射到一个复杂的对象](https://stackoverflow.com/questions/9498242/automapper-mapping-to-a-complex-object)，但认为必须有更好的方法。

所以我创造了这个；

```
Mapper.CreateMap<StoreTransportWindow, CSVWindow>()
    .ForMember(dest => dest.DC, opt => opt.ResolveUsing(fa => fa.DC.number))
    .ForMember(dest => dest.Type, opt => opt.ResolveUsing(fa => fa.Type))
;

Mapper.CreateMap<Store, CSVStore>()
    .ForMember(dest => dest.StoreName, opt => opt.ResolveUsing(fa => fa.name))
    .ForMember(dest => dest.StoreNumber, opt => opt.ResolveUsing(fa => fa.number))
; 
```

现在我想在主地图中使用上述映射；

```
Mapper.CreateMap<Store, CSVLineObject>()
    .ForMember( dest => dest.store, opt => opt.ResolveUsing(/* This is where I'd like to use the above Store to  CSVStore mapping */)) 
; 
```

这可能吗？

**编辑**

```
public class CSVStore
{
    public string StoreNumber { get; set; }
    public string StoreName { get; set; }
}

public class CSVWindow
{
    public string Type { get; set; }
    public string DC { get; set; }
    public string TPC { get; set; }

public class CSVLineObject
{
    public CSVStore store { get; set; }
    public List<CSVWindow> storeWindows { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:56:42.910

如评论中所述，初始映射可能更像：

```
Mapper.CreateMap<StoreTransportWindow, CSVWindow>()
    .ForMember(dest => dest.DC, opt => opt.MapFrom(src => src.DC.number));
// Mapping for property Type not required

Mapper.CreateMap<Store, CSVStore>()
    .ForMember(dest => dest.StoreName, opt => opt.MapFrom(src => src.name))
    .ForMember(dest => dest.StoreNumber, opt => opt.MapFrom(src => src.number)); 
```

现在说你有以下内容：

```
public class Source
{
    public Store Store { get; set; }
}

public class Destination
{
    public CSVStore Store { get; set; }
} 
```

那么以下映射就足够了（因为您已经将嵌套映射定义`Store`为`CSVStore`）：

```
Mapper.CreateMap<Source, Destination>(); 
```

但是，如果`Destination`更像这样：

```
public class Destination
{
    public CSVStore CSVStore { get; set; }
} 
```

然后，您需要明确定义要映射的属性：

```
Mapper.CreateMap<Source, Destination>()
    .ForMember(dest => dest.CSVStore, opt => opt.MapFrom(src => src.Store)); 
```

（请注意，从`Store`to的映射`CVStore`是自动应用的。）

如果由于某种原因确实需要显式定义嵌​​套映射，则可以执行以下操作：

```
Mapper.CreateMap<Source, Destination>()
    .ForMember(dest => dest.destproperty,
               opt => opt.MapFrom(
                   src => Mapper.Map<SrcType, DestType>(src.srcproperty)); 
```

我有时需要使用它，但不是很频繁，因为默认功能会自动为您处理它。

如果您可以扩展您的要求，我可以提供更多详细信息。

# c++ - 自定义堆栈的“seek”函数返回数组中的位置，而不是数组中位置的值

> ID：16095836
> 
> 赞同：0
> 
> 时间：2013-04-19T01:33:17.187
> 
> 标签：c++, for-loop, stack

我有一个 for 循环，旨在接收一个目标数字，并循环遍历堆栈，直到它在 stack[target] 找到数据并且它应该返回该数据。

不幸的是，我只能让它返回它所在的数组的位置或一串随机数字（它会像我的代码一样定期更改）。

我试图只返回 stackArray[counter] 但这就像我只返回计数器一样。然后我更改了代码以创建一个新变量，然后返回该变量，然后我又回到了数字字符串。我认为这与我的堆栈数组是指针这一事实有关吗？这里有点撞砖墙，所以任何输入都会有所帮助。

这是我的循环（至少是最新版本。我已经尝试了很多不同的方法）：

```
 for (int counter = 0; counter < target; counter++ )
    {
        if (stackArray[counter] == target)
        {
            answer = stackArray[counter];

        }
        cout << "beep " << counter << " " << target << endl;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:42:01.017

`for`返回循环中匹配的值很简单。`if`只需在块内添加一个 return 语句。

```
for (int counter = 0; counter < target; counter++ )
{
    if (stackArray[counter] == target)
    {
        answer = stackArray[counter];

        return answer; // <---
    }
} 
```

这没有什么意义，因为您已经知道`answer`会是什么，因为您正在使用`target`. 您的`for`循环似乎不正确，因为您正在迭代，`target`这意味着答案是已知的并且可以直接使用`stackArray[target]`. 在执行此搜索时，您希望一直搜索到数组的末尾。

# java - 从方法返回值而不创建对象

> ID：16095837
> 
> 赞同：1
> 
> 时间：2013-04-19T01:33:21.240
> 
> 标签：java, class, methods

好的，所以我有一个很大的类结构，看起来像[**这样**](http://uaa.ryannixon.com/uploads/cs201/scReference.pdf)

它是为学校准备的，我的教练喜欢星际争霸，所以就随它去吧。

无论如何，我在*GeneratorBuilding*类中有一个方法，它应该能够实例化一个新的*海洋*对象。*但是我需要知道一个Marine*对象需要多少资源。

我在名为 unitCost()的抽象*Unit*类中有一个抽象 int 方法。然后*Marine*类覆盖这个方法并返回一个类似 50 的值。

我正在寻找一种方法让我的*GeneratorBuilding类获取**Marine*类中 unitCost() 方法的返回值，而无需调用任何特定的 Marine 对象。

我知道我可能会创建一个海洋对象，然后询问它的成本是多少，然后如果我没有资源，我会删除该对象而不是将其推入 ArrayList。但这似乎几乎是一种解决方法。

编辑：重点是能够让我所有的具体类继承和覆盖 UnitCost() 方法。所以我可以让它成为静态的，但这会破坏继承结构的全部意义......

EDIT2：由于有示例代码的请求（不完全难以想象）

```
public void makeMarine(){

    //uses resources and throws exception etc if there are not enough resources
    Game.useResources(Marine.unitCost());

    //creates a marine
    Game.addMarine();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T05:03:55.443

如果你真的想要一个好的、抽象的 OO 解决方案来解决这个问题，你应该使用*[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)*。

基本上，这意味着您创建一个“工厂”类，其唯一工作是创建特定类型的单元。工厂类的好处是您可以创建一个接口来表示您的整个工厂集，然后传递工厂的实例——这对于普通的类构造函数来说实际上是无法做到的。

一种常见的模式（我在这里推荐）是使用*[匿名内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/anonymousclasses.html)*和抽象工厂类或接口来为每个单元类型创建“工厂”的单个实例。

这里有一些示例代码可以帮助您入门：

```
/**
 * Abstract class for Starcraft units
 */
public abstract class AUnit {
  // . . .
}

/**
 * Abstract factory for creating Starcraft units
 */
public abstract class AUnitFactory {
  public abstract int unitCost();
  public abstract AUnit createUnit();
}

public class Marine extends AUnit {

  public static final int COST = 50;

  /**
   * Using an anonymous inner class to create an
   * AUnitFactory instance for Marines
   */
  public static final FACTORY = new AUnitFactory() {
    public int unitCost() { return COST; }
    public AUnit createUnit() { return new Marine(); }
  }

  // . . .

}

public class Zergling extends AUnit {

  public static final int COST = 25;

  /**
   * Using an anonymous inner class to create an
   * AUnitFactory instance for Zerglings
   */
  public static final FACTORY = new AUnitFactory() {
    public int unitCost() { return COST; }
    public AUnit createUnit() { return new Zergling(); }
  }

  // . . .

}

/**
 * Starcraft game!
 */
public class Game {

  public addUnit(Player player, AUnitFactory unitFactory) {
    // Get unit's cost
    int cost = unitFactory.unitCost();
    // Now deduct it from the player's resources
    // . . .
    // Create the unit
    AUnit unit = unitFactory.createUnit();
    // Now add the unit to the game for the given player
    // . . .
  }

  // . . .

} 
```

现在你可以做类似的事情`Game.addUnit(player1, Zergling.FACTORY)`or `Game.addUnit(player2, Marine.FACTORY)`。

好处是您可以传递*FACTORY*实例，因为它们只是 type 的对象`AUnitFactory`。这意味着您可以执行一些操作，例如使用*组合框*来选择单位类型，然后在单击时创建一个按钮，该按钮会创建当前在组合框中选择的任何单位类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T01:45:43.133

您可以通过在每个类中声明一个专门命名的静态字段并通过*反射*获取它来做到这一点}。

假设您的课程如下所示：

```
class ClassNumber1 {
    public static final int cost = 123;
}
class ClassNumber2 {
    public static final int cost = 321;
} 
```

然后你可以`cost`像这样获取他们的字段：

```
public static <T> int getCost(Class<T> cl) throws Exception {
    // This is oversimplified: you need to check that the class
    // indeed has a field called "cost" by null-checking the return value
    // of getField(), verifying your cast, catching exceptions, and so on.
    // But this will work in a "closed" system, when you know for sure
    // that an int constant field does exist:
    return (int)cl.getField("cost").get(null);
} 
```

您按如下方式调用该方法：

```
System.out.println(getCost(ClassNumber1.class));
System.out.println(getCost(ClassNumber2.class)); 
```

这是[关于 ideone 的演示](http://ideone.com/5YU5Yc)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T01:36:04.820

这正是类方法的用途。在类方法中，unitCost()是Marine类本身的方法（即static public int UnitCost()），所以可以调用Marine.unitCost()，而不是m =new Marine()再调用m.UnitCost( ）。

很酷的导师。希望我在服用 OO 时有一个。

# java - 读取视频数据并写入另一个文件java

> ID：16095838
> 
> 赞同：1
> 
> 时间：2013-04-19T01:33:22.300
> 
> 标签：java, file, file-io, copy, video-streaming

我正在读取以字节为单位的视频文件数据并发送到另一个文件，但接收到的视频文件无法正常播放并且出现抖动。

谁能解释我为什么会发生这种情况并感谢解决方案。

我的代码如下

```
import java.io.*;

public class convert {

  public static void main(String[] args) {

    //create file object
    File file = new File("B:/music/Billa.mp4");

    try
    {
      //create FileInputStream object
      FileInputStream fin = new FileInputStream(file);

       byte fileContent[] = new byte[(int)file.length()];
       fin.read(fileContent);

       //create string from byte array
       String strFileContent = new String(fileContent);

       System.out.println("File content : ");
       System.out.println(strFileContent);

       File dest=new File("B://music//a.mp4");
       BufferedWriter bw=new BufferedWriter(new FileWriter(dest));
       bw.write(strFileContent+"\n");
       bw.flush();

    }
    catch(FileNotFoundException e)
    {
      System.out.println("File not found" + e);
    }
    catch(IOException ioe)
    {
      System.out.println("Exception while reading the file " + ioe);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-10-17T14:11:25.893

这个问题可能已经死了，但有人可能会觉得这很有用。

您不能将视频作为字符串处理。这是使用 Java 7 或更高版本读取和写入（复制）*任何文件的正确方法。*

请注意，缓冲区的大小取决于处理器，通常应该是 2 的幂。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/16068166/6561533)。

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;

public class FileCopy {
public static void main(String args[]) {

    final int BUFFERSIZE = 4 * 1024;
    String sourceFilePath = "D:\\MyFolder\\MyVideo.avi";
    String outputFilePath = "D:\\OtherFolder\\MyVideo.avi";

    try(
            FileInputStream fin = new FileInputStream(new File(sourceFilePath));
            FileOutputStream fout = new FileOutputStream(new File(outputFilePath));
            ){

        byte[] buffer = new byte[BUFFERSIZE];

        while(fin.available() != 0) {
            bytesRead = fin.read(buffer);
            fout.write(buffer, 0, bytesRead);
        }

    }
    catch(Exception e) {
        System.out.println("Something went wrong! Reason: " + e.getMessage());
    }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-17T08:37:23.297

```
import java.awt.image.BufferedImage;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileWriter;

import javax.imageio.ImageIO;

public class Reader {

    public Reader() throws Exception{

        File file = new File("C:/Users/Digilog/Downloads/Test.mp4");

        FileInputStream fin = new FileInputStream(file);
        byte b[] = new byte[(int)file.length()];
        fin.read(b);

        File nf = new File("D:/K.mp4");
        FileOutputStream fw = new FileOutputStream(nf);
        fw.write(b);
        fw.flush();
        fw.close();

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-14T16:48:28.800

In addition to [Jakub Orsula's answer](https://stackoverflow.com/a/46792255/9643785), one needs to check the result of read operation to prevent garbage being written to end of file in last iteration.

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;

public class FileCopy {
public static void main(String args[]) {

    final int BUFFERSIZE = 4 * 1024;
    String sourceFilePath = "D:\\MyFolder\\MyVideo.avi";
    String outputFilePath = "D:\\OtherFolder\\MyVideo.avi";

    try(
            FileInputStream fin = new FileInputStream(new File(sourceFilePath));
            FileOutputStream fout = new FileOutputStream(new File(outputFilePath));
            ){

        byte[] buffer = new byte[BUFFERSIZE];
        int bytesRead;

        while(fin.available() != 0) {
        bytesRead = fin.read(buffer);
        fout.write(buffer, 0, bytesRead);
        }

    }
    catch(Exception e) {
        System.out.println("Something went wrong! Reason: " + e.getMessage());
    }

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-22T08:43:46.443

希望这对您也有帮助 - 这可以读取文件并将其写入另一个文件（您可以使用任何文件类型来执行此操作）

```
import java.io.FileInputStream;
import java.io.FileOutputStream;

public class Copy {
    public static void main(String[] args) throws Exception {
        FileInputStream input = new FileInputStream("input.mp4");      //input file
        byte[] data = input.readAllBytes();
        FileOutputStream output = new FileOutputStream("output.mp4");  //output file
        output.write(data);
        output.close();
    }
} 
```

# php - 获取完整的 Mac OS 版本，包括 PHP 修订版

> ID：16095844
> 
> 赞同：0
> 
> 时间：2013-04-19T01:35:14.370
> 
> 标签：php, macos, operating-system, revision

好的，我到处找，找不到这个。

我有一个 Windows XP，做成服务器，我用 PHP 创建了一个网页，显示当前的 IP 地址、操作系统和当前的浏览器，我正在使用命令`$_SERVER['HTTP_USER_AGENT']`，它可以工作，但它缺少我需要的一部分。运行命令时，我得到字符串

Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0'

但是对于 Mac 上的操作系统，我也需要修改。

例如安装了 Intel Mac OS X 10.8 - 我想要 Intel Mac OS X 10.8`.2`

我需要 Mac OS 版本中的额外 2。

我可以运行`sw_vers`命令，但不知道如何通过 PHP 进入变量。

有任何想法吗 ？？

干杯

詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:58:26.063

这可能是不可能的。由用户浏览器决定它想告诉你的 PHP 服务器关于它自己的信息。

如果它不愿意告诉您它正在运行的操作系统的次要版本，则无法获得它

# facebook - 从 Facebook API 中的 /home 或流表获取比过去几天更多的信息

> ID：16095848
> 
> 赞同：2
> 
> 时间：2013-04-19T01:35:57.297
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我一直在使用[home](https://developers.facebook.com/docs/reference/api/user/#home) graph api 以及[流](https://developers.facebook.com/docs/reference/fql/stream/)fql 表，我希望能获得用户新闻提要的最后一两周。到目前为止，使用较大的限制（最大值为 5000）和时间戳来尝试获取过去两周的帖子（使用`until`and`since`用于家庭和`created_time >`流表中），但我只得到最后 2 或 3 天的新闻提要帖子，大约 200-300 个帖子。

有人遇到过这种情况么？有没有办法得到一整周？我意识到 Facebook 会限制 api 并阻止应用程序获取数年甚至数月的数据，但 2-3 天似乎不是很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T02:54:48.700

现在我已经等了几天，看来我仍然只能回到 4 月 14 日（这是我之前可以去的最远的地方），但 14 日现在是一周前，而不是 3 天前。我相信这是由于[这个错误](https://developers.facebook.com/bugs/525301577527928?browse=search_5174a5dabacf74b77690235)，其中一些帖子会导致新闻提要 api 返回错误。我相信 Facebook 修复了这个错误，并在修复后对 api 进行了限制，以防止进一步的问题。

# sql - Sql Server 选择并更新 X 行

> ID：16095849
> 
> 赞同：0
> 
> 时间：2013-04-19T01:36:02.830
> 
> 标签：sql, sql-server, common-table-expression, row-number

我正在使用 Sql Server 2012。

我需要从表中选择行进行处理。行数需要是可变的。我需要将我选择的行更新为“正在处理”状态 - 为此我有一个要填充的 guid。

我遇到了几个使用 row_number() 的例子和几个使用 CTE 的方法的例子，但我不确定如何组合它们（或者这是否是正确的策略）。我将不胜感激。

这是我到目前为止所拥有的：

```
DECLARE @SessionGuid uniqueidentifier,  @rowcount bigint
SELECT @rowcount = 1000
SELECT @sessionguid = newid()

    DECLARE @myProductChanges table (
            ProductChangeId bigint
        ,   ProductTypeId smallint
        ,   SourceSystemId tinyint
        ,   ChangeTypeId tinyint );

    WITH NextPage AS 
    (
       SELECT 
           ProductChangeId, ServiceSessionGuid,
           ROW_NUMBER() OVER (ORDER BY ProductChangeId) AS 'RowNum' 
       FROM dbo.ProductChange
       WHERE 'RowNum' < @rowcount
    )
    UPDATE dbo.ProductChange
    SET ServiceSessionGuid = @sessionguid, ProcessingStateId = 2, UpdatedDate = getdate()
    OUTPUT
        INSERTED.ProductChangeId,
        INSERTED.ProductTypeId,
        INSERTED.SourceSystemId,
        INSERTED.ChangeTypeId
    INTO @myProductChanges
    FROM dbo.ProductChange as pc join NextPage on pc.ProductChangeId = NextPage.ProductChangeId 
```

从这里我将从我的临时表中选择并返回数据：

```
SELECT mpc.ProductChangeId
    ,   pt.ProductName as ProductType
    ,   ss.Name as SourceSystem
    ,   ct.ChangeDescription as ChangeType
FROM @myProductChanges as mpc 
        join dbo.R_ProductType pt on mpc.ProductTypeId = pt.ProductTypeId
        join dbo.R_SourceSystem ss on mpc.SourceSystemId = ss.SourceSystemId
        join dbo.R_ChangeType ct on mpc.ChangeTypeId = ct.ChangeTypeId
ORDER BY ProductType asc 
```

到目前为止，这对我不起作用。当我尝试运行它时出现错误：

```
Msg 8114, Level 16, State 5, Line 20
Error converting data type varchar to bigint. 
```

我不清楚我做错了什么 - 所以 - 感谢任何帮助。

谢谢！

顺便说一句，以下是我用来尝试解决此问题的一些问题：

[https://stackoverflow.com/questions/9777178](https://stackoverflow.com/questions/9777178/sql-server-how-to-select-a-fixed-amount-of-rows-select-every-x-th-value)

[https://stackoverflow.com/questions/3319842](https://stackoverflow.com/questions/3319842/select-rows-and-update-same-rows-for-locking)

[https://stackoverflow.com/questions/6402103](https://stackoverflow.com/questions/6402103/sql-update-updating-selected-rows)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:42:01.767

这个子查询没有意义：

```
 SELECT 
       ProductChangeId, ServiceSessionGuid,
       ROW_NUMBER() OVER (ORDER BY ProductChangeId) AS 'RowNum' 
   FROM dbo.ProductChange
   WHERE 'RowNum' < @rowcount 
```

您不能`RowNum`在同一范围内引用别名（并且您正在尝试比较字符串，而不是别名），因为在`WHERE`解析子句时，`SELECT`列表尚未具体化。您需要的是另一个巢：

```
SELECT ProductChangeId, ServiceSessionGuid, RowNum
FROM (SELECT ProductChangeId, ServiceSessionGuid, 
       ROW_NUMBER() OVER (ORDER BY ProductChangeId) AS RowNum
   FROM dbo.ProductChange
) AS x WHERE RowNum < @rowcount 
```

或者：

```
SELECT TOP (@rowcount-1) ProductChangeId, ServiceSessionGuid, 
  ROW_NUMBER() OVER (ORDER BY ProductChangeId) AS RowNum
FROM dbo.ProductChange
ORDER BY ProductChangeId 
```

另外请停止使用`'alias'`- 当您需要分隔别名时（在这种情况下不需要），请使用`[square brackets]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T02:16:37.187

我猜，但我认为你想要`<=`而不是`<`如果你想要影响`@rowcount`行，而不是更少。

另一个提示是 CTE 可以直接更新*，如下所示：

```
WITH NextPage AS 
(
   SELECT TOP(@rowcount) *           
   FROM dbo.ProductChange
)
UPDATE NextPage
SET ServiceSessionGuid = @sessionguid, ProcessingStateId = 2, UpdatedDate = getdate()
OUTPUT
    INSERTED.ProductChangeId,
    INSERTED.ProductTypeId,
    INSERTED.SourceSystemId,
    INSERTED.ChangeTypeId
INTO @myProductChanges 
```

** 更新影响 CTE 中的基表，即 dbo.ProductChange*

# android - 如何在 Android 上从 Java 写入 localStorage

> ID：16095851
> 
> 赞同：5
> 
> 时间：2013-04-19T01:36:08.133
> 
> 标签：android

我正在研究[http://developer.android.com/reference/android/webkit/WebStorage.html](http://developer.android.com/reference/android/webkit/WebStorage.html) API，但它不支持从 Java 写入 localStorage。我想做的是存储来自 android 应用程序的 Java 端的数据，以供应用程序的 JavaScript 端读取。

例如，在 JavaScript 中，我可以使用 localStorage.getItem()、localStorage.setItem()。但是，我找不到类似的 API 来完成 Java 中的任务。是否有解决方法或尚未被 Android 平台实现？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:42:02.060

有很多方法可以在 Android 应用程序中存储数据，如[存储选项指南](http://developer.android.com/guide/topics/data/data-storage.html)中所述：

*   [Shared Preferences](http://developer.android.com/guide/topics/data/data-storage.html#pref) - 特定于您的应用程序的简单键/值对。这可能是最接近 WebStorage 的。
*   [内部存储](http://developer.android.com/guide/topics/data/data-storage.html#filesInternal)- 读/写文件
*   [外部存储](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)- SD 卡文件存储
*   [数据库](http://developer.android.com/guide/topics/data/data-storage.html#db)- 更适合大量结构化数据
*   [网络](http://developer.android.com/guide/topics/data/data-storage.html#netw)- 显然，如果需要，您可以远程存储/检索数据

# guard - 使用 vcr 进行使用guard-rspec 进行集成测试时要跳过的任何标志？

> ID：16095852
> 
> 赞同：1
> 
> 时间：2013-04-19T01:36:21.330
> 
> 标签：guard, vcr

vcr gem 非常适合加速调用外部 API 的测试套件......

如果不使用 VCR，检查测试套件是否仍能通过的最佳程序是什么？有没有使用guard-rspec传递环境变量或标志以跳过VCR的默认方法？

还是我应该将 VCR 初始化块包装在有条件地检查环境变量中？

```
# spec/support/vcr.rb
require 'vcr'

unless ENV['SKIP_VCR'] && ENV['SKIP_VCR'].casecmp('YES') == 0
  puts "Using VCR to speed up test suite!"
  VCR.configure do |c|
    c.cassette_library_dir = 'spec/cassettes'
    c.hook_into :fakeweb
    c.ignore_localhost = true
    c.configure_rspec_metadata!
  end
end 
```

# git - 在本地添加到 git 子模块

> ID：16095854
> 
> 赞同：1
> 
> 时间：2013-04-19T01:36:35.807
> 
> 标签：git, git-submodules

所以我有一个 git 存储库，里面有我所有常用的 wordpress 插件。
我还有一个 wordpress 环境，其中包含 git 中的主题和插件。

我想要做的是在我的 wordpress 环境中将常用插件作为子模块，但是有些网站可能需要额外的插件。问题是据我所知，wordpress 要求所有插件都需要在 1 个插件文件夹中（所以不能有子文件夹）。

我可以添加到子模块并将其提交到环境存储库而不提交子模块吗？

那么当我克隆这个环境仓库时，我可以得到所有的插件，而不仅仅是常用插件仓库中的那些吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T06:13:23.553

如果您不需要对这些子模块进行任何修改，您可以设置一个[post-checkout 挂钩](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)，它将您的子模块与 wordpress 插件目录同步。
rsync 只会复制增量（已更改的内容）。

# python - 迭代多个文件的所有行的最pythonic方法是什么？

> ID：16095855
> 
> 赞同：14
> 
> 时间：2013-04-19T01:36:55.690
> 
> 标签：python, file, parsing, logging

我想将许多文件视为一个文件。将 [filenames] => [file objects] => [lines] 与生成器/不将整个文件读入内存的正确 pythonic 方式是什么？

我们都知道打开文件的正确方法：

```
with open("auth.log", "rb") as f:
    print sum(f.readlines()) 
```

我们知道将多个迭代器/生成器链接成一个长的一个的正确方法：

```
>>> list(itertools.chain(range(3), range(3)))
[0, 1, 2, 0, 1, 2] 
```

但是如何将多个文件链接在一起并保留上下文管理器？

```
with open("auth.log", "rb") as f0:
    with open("auth.log.1", "rb") as f1:
        for line in itertools.chain(f0, f1):
            do_stuff_with(line)

    # f1 is now closed
# f0 is now closed
# gross 
```

我可以忽略上下文管理器并做这样的事情，但感觉不对：

```
files = itertools.chain(*(open(f, "rb") for f in file_names))
for line in files:
    do_stuff_with(line) 
```

或者这就是[Async IO - PEP 3156](http://www.python.org/dev/peps/pep-3156/)的用途，我只需要稍后等待优雅的语法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-19T01:49:37.880

总是有的[`fileinput`](http://docs.python.org/2/library/fileinput.html#fileinput.input)。

```
for line in fileinput.input(filenames):
    ... 
```

然而，阅读[源代码](http://hg.python.org/cpython/file/2.7/Lib/fileinput.py#l184)，它似乎`fileinput.FileInput`不能用作上下文管理器¹。要解决这个问题，您可以使用，[`contextlib.closing`](http://docs.python.org/2/library/contextlib.html#contextlib.closing)因为`FileInput`实例有一个合理实现的`close`方法：

```
from contextlib import closing
with closing(fileinput.input(filenames)) as line_iter:
    for line in line_iter:
        ... 
```

* * *

上下文管理器的另一种选择是编写一个简单的函数循环遍历文件并生成行：

```
def fileinput(files):
    for f in files:
        with open(f,'r') as fin:
            for line in fin:
                yield line 
```

恕我直言，这里没有真正的必要`itertools.chain`……这里的魔力`yield`在于用于将普通函数转换为极其惰性的生成器的语句。

* * *

¹顺便说一句，从 python3.2 开始，它`fileinput.FileInput` *被*实现为一个上下文管理器，它与我们之前用`contextlib`. 现在我们的例子变成了：

```
# Python 3.2+ version
with fileinput.input(filenames) as line_iter:
    for line in line_iter:
        ... 
```

尽管另一个示例也适用于 python3.2+。

# android - Appcelerator Titanium 国际化无法正常工作

> ID：16095859
> 
> 赞同：1
> 
> 时间：2013-04-19T01:37:37.653
> 
> 标签：android, iphone, titanium, appcelerator, titanium-alloy

这是让我发疯的一个：

我最近开始研究 Appcelerator Titanium。我已经使用普通项目和使用 Alloy 构建了一些小应用程序，因此我至少了解基础知识。

我无法工作的一件事是 i18n 文件夹/文件。

这是我所做的： - 创建一个“默认项目” - 将文件夹添加到根目录“i18n” - 将“en”和“es”文件夹添加到“i18n” - 将“strings.xml”添加到这两个新文件夹。- 添加：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <resources>
       <string name="welcome_message">Welcome TEST</string>
    </resources> 
```

到strings.xml，除了es字符串中我放了“ES Welcome TEST”。- 在 Resources -> app.js 我将“I am Window 1”更改为 L('welcome_message') - 运行应用程序

普通版和合金版都只是显示一个空白屏幕。我想让我的合金应用程序工作得最好，但据我了解，本地化代码在两个应用程序中应该是一样的。在合金中，我可能只需要把它放在风格中。

任何指针都会很棒！我看过其他声称它不起作用的帖子，但所有这些帖子要么是语法错误，要么只是设置错误。我已经复制了他们的代码并且遇到了完全相同的问题，它无法正常工作，所以我感觉我错过了新手步骤。

-- 这是一些截图，我刚刚创建了一个全新的常规（不是合金）项目，添加了上面的代码并尝试使用 L('welcome_message') 没有运气。我尝试在新 PC 上安装所有内容，以确保我的主计算机上没有搞砸任何东西。 ![在此处输入图像描述](https://i.stack.imgur.com/5SAIs.png) ![在此处输入图像描述](https://i.stack.imgur.com/99dkW.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T17:21:12.363

以下是答案：

[https://wiki.appcelerator.org/display/guides/Internationalization](https://wiki.appcelerator.org/display/guides/Internationalization)

默认情况下，您的清单文件不会默认设置为允许本地化，除非您选择选项卡式项目。

如果你问我，有点傻。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T13:29:08.460

对于主题海报：

我的新 string.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
    <string name="welcome_message">Don't Help Austin</string>
    <string name="user_agent_message">user agent set to</string>
    <string name="format_test">Your name is %s</string>
    <string name="base_ui_title">Base UI</string>
    <string name="controls_win_title">Controls</string>
    <string name="phone_win_title">Phone</string>
    <string name="platform_win_title">Platform</string>
    <string name="mashups_win_title">Mashups</string>
    <string name="ordered">Hi %1$s, my name is %2$s</string>
</resources> 
```

我的非合金实验截图：

![在此处输入图像描述](https://i.stack.imgur.com/SNvGm.png)

**对于那些希望回答该主题中的问题的人，这可能是下面的答案。**

我的 i18n 文件夹与应用程序和插件位于同一层次结构级别，因此我的文件夹不像其他合金资源那样位于应用程序文件夹中。

索引.xml

```
<Alloy>
    <Window class="container">
        <Label id="label" onClick="doClick"></Label>
    </Window>
</Alloy> 
```

索引.tss

```
".container": {
    backgroundColor:"white"
},
"Label": {
    width: Ti.UI.SIZE,
    height: Ti.UI.SIZE,
    color: "#000",
    text: L("welcome_message")
} 
```

字符串.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
    <string name="welcome_message">Welcome to Kitchen Sink for Titanium</string>
    <string name="user_agent_message">user agent set to</string>
    <string name="format_test">Your name is %s</string>
    <string name="base_ui_title">Base UI</string>
    <string name="controls_win_title">Controls</string>
    <string name="phone_win_title">Phone</string>
    <string name="platform_win_title">Platform</string>
    <string name="mashups_win_title">Mashups</string>
    <string name="ordered">Hi %1$s, my name is %2$s</string>
</resources> 
```

当我将 L("welcome_message") 放在 index.xml 中时，它不起作用。

# python - 在列表中重复列表 X 次

> ID：16095865
> 
> 赞同：3
> 
> 时间：2013-04-19T01:38:08.157
> 
> 标签：python, list, nested-lists

我正在做一个项目，我需要在一个列表中重复一个列表一定次数。显然，`L.append(L)`只需再次添加元素而不创建单独的列表。我只是对如何使列表在大列表中分开感到困惑。

简而言之，这就是我所拥有的：

```
L = [1,2,3,4,5] 
```

如果我想重复它，比如 3 次，那么我会：

```
L = [[1,2,3,4,5],[1,2,3,4,5],[1,2,3,4,5]] 
```

我如何实现这一目标？我正在寻找大名单中的名单。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-19T01:39:24.553

不需要任何功能：

```
>>> L = [1,2,3,4,5]
>>> [L]*3
[[1, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5]] 
```

但是，您应该注意，如果您更改任何列表中的一个值，则所有其他值都会更改，因为它们引用了同一个对象。

```
>>> mylist = [L]*3
>>> mylist[0][0] = 6
>>> print mylist
[[6, 2, 3, 4, 5], [6, 2, 3, 4, 5], [6, 2, 3, 4, 5]]
>>> print L
[6, 2, 3, 4, 5] 
```

为了避免这种情况：

```
>>> L = [1,2,3,4,5]
>>> mylist = [L[:] for _ in range(3)]
>>> mylist[0][0] = 6
>>> print L
[1, 2, 3, 4, 5]
>>> print mylist
[[6, 2, 3, 4, 5], [1, 2, 3, 4, 5], [1, 2, 3, 4, 5]] 
```

注意`L`没有改变，只有第一个列表`mylist`改变了。

感谢评论中的每个人的帮助:)。

# c# - 托管 ADB 无法通过 TCP 检测设备

> ID：16095872
> 
> 赞同：1
> 
> 时间：2013-04-19T01:39:14.533
> 
> 标签：c#, android, adb, android-wifi

我目前正在使用 Madb 来控制我的 android 设备。它在 USB 接口上确实工作得很好，但是当我使用命令更改监听端口时

```
setprop service.adb.tcp.port 5555
stop adbd
start adbd 
```

在 Madb 库的 AndroidDebugBride 类中，我将 HostAddress 更改为 Wifi Switch 的 DefaultGateWay，即：192.168.0.1。

我可以使用 adb 命令将文件连接、推送、拉取到我的设备：

```
adb connect 192.168.0.xxx
adb -s 192.168.0.xxx push yyy zzz 
```

但是 Madb 无法检测到设备，我的初始代码是

```
AndroidDebugBridge bridge = AndroidDebugBridge.CreateBridge("adb.exe", true);
List<Device> devices = bridge.Devices 
```

我不知道确切的问题，因为没有任何关于 madb 的文档。

任何帮助将不胜感激

# c++ - 如何从 QT 中检索 Windows 中的文件属性元数据？

> ID：16095874
> 
> 赞同：2
> 
> 时间：2013-04-19T01:39:20.943
> 
> 标签：c++, windows, file, qt, metadata

我找不到一个好的答案。

查看可执行文件的元数据（如描述和公司）的代码是什么，或者执行此类操作的 API 参考指南是什么？

我查看了[QFileInfo](https://qt-project.org/doc/qt-4.8/qfileinfo.html "QFileInfo")，但代码只能读取和输出基本的跨平台信息，如名称、路径和时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T05:40:05.830

我不认为有 Qt'ish 的方式来做到这一点，因为这样的信息并不是真正的跨平台。正如评论中提到的，为此使用 Windows API 的最佳方式。

当我不得不在跨平台项目中处理所有这些信息时，我曾经遇到过类似的问题。因此，目标是通过跨平台构建保持所有元数据可用，并在 Windows 文件属性对话框中正确显示。我能想出的最快速的解决方案是通过#define 在一个 version.h 中定义所有这些信息，因此它可以在软件中使用，并在包含 version.h 的 Windows RC 文件中重用相同的定义，并且本身也包含在内在win32条件下的.pro中。

# php - 如果它在与另一个字符分开的字符串的中间引导、结束或存在，则在单个数字前面添加 0

> ID：16095876
> 
> 赞同：4
> 
> 时间：2013-04-19T01:39:37.797
> 
> 标签：php

需要前置 0 的“句子”示例：

`5 this is 3`变成`05 this is 03`

`44 this is 2`变为`44 this is 02`（注释 44 未添加，因为它不是单个数字）

`this 4 is`变成`this 04 is`

* * *

不会获得前缀 0 的“句子”示例：

`44 this is`

`22 this3 is`（注 3 没有放在前面，因为它作为字符串的一部分存在）

`this is5`

我尝试想出一个正则表达式并惨遭失败。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T01:45:27.680

```
$str = '5 this is 3';

$replaced = preg_replace('~(?<=\s|^)\d(?=\D|$)~', '0\\0', $str); // 05 this is 03 
```

正则表达式的意思是：每个`\d`数字（`(?<=\s|^)``(?=\D|$)``0`

现场演示：http: [//ideone.com/3B7W0n](http://ideone.com/3B7W0n)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T01:44:20.283

`'/((?<= |^)[0-9](?![0-9]))/'`使用以下模式`preg_replace()`：

我写了一个小测试脚本：

```
$pattern = '/((?<= |^)[0-9](?![0-9]))/';
$replacement = "0$1";

$tests = array(
    '5 this is 3' => '05 this is 03',
    '44 this is 2' => '44 this is 02',
    'this 4 is' => 'this 04 is',
    '44 this is' => '44 this is',
    'this is5' => 'this is5'
);

foreach($tests as $orginal => $expected) {
    $result = preg_replace($pattern, $replacement, $orginal);
    if($result !== $expected) {
        $msg  = 'Test Failed: "' . $orginal . '"' . PHP_EOL;
        $msg .= 'Expected: "' . $expected . '"' . PHP_EOL;
        $msg .= 'Got     : "' . $result . '"'. PHP_EOL;
        echo 'error' . $msg;
    } else {
        $original . '=>' . $result . PHP_EOL;
    }      
} 
```

解释：

我使用[断言](http://www.php.net/manual/en/regexp.reference.assertions.php)来确保只有以下数字`[0-9]`：

*   后面不跟数字本身：`(?![0-9])`
*   并以空格或行首开头：`((?<= |^)`

将以 . 为前缀`0`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T01:51:26.617

这是实现它的非正则表达式方法：

```
$line = "this 4 is";

$words = explode(' ', $line);
foreach ($words as &$word) {
    if (ctype_digit($word)) {
        $word = str_pad($word, 2, '0', STR_PAD_LEFT);
    }
}

echo implode(' ', $words); 
```

# java - 与 Web 交互的应用程序的集成测试

> ID：16095881
> 
> 赞同：1
> 
> 时间：2013-04-19T01:40:27.547
> 
> 标签：java, unit-testing, junit, integration-testing

如何为与网站交互的应用程序编写集成测试？更具体地说，我有一个与 Flickr 网站交互的应用程序。在 OAuth 授权过程中，flickr 网站显示验证器代码，用户必须将其复制并粘贴到我的应用程序中。现在我如何自动化这个过程，以便我可以自动测试应用程序。我正在使用swing for GUI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T06:17:20.267

编写依赖于外部服务的自动化可能很棘手。对于这样的事情，我建议你设置一个模拟服务，或者其他使用预设响应的方式。

我已经通过几种方式成功地做到了这一点：

*   编写一个外部模拟服务，使用类似[bottle.py](http://bottlepy.org)的东西。这样做的好处是几乎不需要对现有代码库进行修改，但显然需要做一些工作来确保这个外部进程作为测试套件的一部分得到正确管理，尤其是当您在 CI 环境中运行测试时。

*   使用依赖注入，您可以编写模拟网络组件，并将真实网络组件交换为模拟组件以进行测试。我推荐这种方法，但它需要对您的代码库进行一些修改。

# java - JSTL 适合循环语法

> ID：16095882
> 
> 赞同：0
> 
> 时间：2013-04-19T01:40:32.390
> 
> 标签：java, performance, jstl

我对 JSTL 和 Java 很陌生。有没有更好的方法来格式化这个 for 循环，似乎我可以把它再分解一点，让它更干净。理想情况下，我不想逃避字符串，但不确定如何或是否有更好的方法？我知道在 JSTL 中声明变量时，您可以使用 c: 标记内的属性执行如下操作。你可以用 for 循环做类似的事情吗？

```
<c:set var="childNode"><%= properties.get("childrenNode", "") %></c:set>

<c:forEach items="<%=childResults.getPath((Child)pageContext.getAttribute(\"childPage\"), currentPage, new showChildrenFilter())%>" var="segment" varStatus="status">
   ${displaySomething}
</c:forEach> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:33:53.503

您的 JSP 上有很多 java 代码（scriptlet）。使用 JSTL 可以帮助您摆脱对 scriptlet 的使用，因此可以帮助您将代码逻辑从演示文稿中分离出来，从而更好地维护可维护性。如您所见，您的页面上有很多直接的 java 代码。

这就是我将 JSTL 用于循环的方式。通常在服务器端，我将在请求属性中准确设置我需要的内容。所以这可能取决于您的工具/框架，但通常您可以以某种方式访问​​ HttpServletRequest。仅以 HttpServlet 的 doGet() 方法为例

```
// this is in my servlet
public void doGet(HttpServletRequest req, HttpServletResponse resp) 
{
   Collection<Circle> circles = // some logic here 
   req.setAttribute("circles", circles);
} 
```

然后在 JSP 上，我将遍历我设置的任何内容

```
<c:forEach items="${circles}" var="circle">
   Radius: ${circle.radius}, Color: ${circle.color} <br/>
</c:forEach> 
```

# ruby-on-rails - 从部分重定向回具有部分的同一页面后保持验证错误

> ID：16095883
> 
> 赞同：4
> 
> 时间：2013-04-19T01:40:33.570
> 
> 标签：ruby-on-rails

所以我试图从我的表单中获取错误，这些错误在我的 root_path 中呈现为部分。在我尝试发布它并且它失败（或成功）之后，我想重定向回 root_path。但是，redirect_to 决定不保存任何验证信息。

想知道如何做到这一点。

```
class PostsController < ApplicationController
  def new
    @post = Post.new
  end

  def create
    @nom = current_user.noms.build(params[:nom])
    if @nom.save
      flash[:success] = "Nom created!"
      redirect_to root_path
    else
      flash[:error] = @nom.errors
      redirect_to root_path
  end 
```

在我的主页/索引中，我将部分呈现为帖子的形式。

```
= form_for [current_user, @post] do |f|
  = f.text_field :name
  = f.select :category
  = f.text_area :description
  = f.submit "Post", class: "btn btn-primary"

  - @post.errors.full_messages.each do |msg|
    %p
      = msg 
```

重定向到 root_path 后，它应该将错误保留在表单的底部。

我还想保留验证失败后的信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:49:03.650

在这种情况下，您不应该使用重定向，而是使用渲染：

```
class PostsController < ApplicationController
  #..

  def create
    @nom = current_user.noms.build(params[:nom])
    if @nom.save
      flash[:success] = "Nom created!"
      redirect_to root_path
    else
      flash[:error] = @nom.errors
      render :template => "controller/index"
    end
  end 
```

替换`controller/index`为您的控制器和操作的名称

还要检查这个[问题](https://stackoverflow.com/questions/5767222/rails-call-another-controller-action-from-a-controller)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-22T06:12:15.663

这似乎对我有用

```
format.html { redirect_to :back, flash: {:errors => "Document "+@requested_doc.errors.messages[:document][0] }} 
```

我不知道这是否会导致任何其他异常问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-05-31T08:32:56.903

您不能使用**redirect_to**来显示对象的错误消息，因为在重定向时它会丢弃与 error_messages 链接的对象并使用新对象来重定向路径。

所以在这种情况下，你只需要使用**render**。

```
respond_to do |format|
        format.html { 
          flash[:error] = @account.errors.full_messages.join(', ')
          render "edit", :id => @account._id, sid: @account.site._id
        }
end 
```

# symfony-2.1 - 在 preUpdate Sonata Admin Bundle 中获取旧数据

> ID：16095886
> 
> 赞同：12
> 
> 时间：2013-04-19T01:40:49.203
> 
> 标签：symfony-2.1, sonata-admin

我有一个`product`实体，它有一个`images`存储产品图像名称的字段，但图像名称取决于一个`part_number`唯一的字段，所以如果用户在部件号中出错并且他想编辑它，那么我也有更改图像名称

我试过了，但它不起作用：

```
// class ProductsAdmin extends Admin

public function preUpdate($product) {

    $old_product = $this->getSubject();

    if ($old_product->getPartNumber() != $product->getPartNumber)
    {
         // change file names
    }

    $this->saveFile($product);
} 
```

如何在 preUpdate() 函数中获取原始行？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-01-19T22:15:05.993

根据从官方 SonataAdmin 谷歌论坛获取的主题： [https](https://groups.google.com/forum/#!topic/sonata-devs/0zML6N13i3U) ://groups.google.com/forum/#!topic/sonata-devs/0zML6N13i3U 您需要使用 UnitOfWork 类： **[http://www.doctrine -project.org/api/orm/2.3/class-Doctrine.ORM.UnitOfWork.html](http://www.doctrine-project.org/api/orm/2.3/class-Doctrine.ORM.UnitOfWork.html)**

这样做：

```
public function preUpdate($object)
{
    $em = $this->getModelManager()->getEntityManager($this->getClass());
    $original = $em->getUnitOfWork()->getOriginalDocumentData($object);
} 
```

因此，您将获得数据库实体的一组值。例如：要访问您的实体的值*密码，请执行以下操作：*

```
$password = $original['password']; 
```

就这样。享受 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T13:44:40.500

如果您只是在 preUpdate 函数中进行原则查询以从数据库中获取产品，您将拥有旧对象。然后进行比较，您就可以开始了。

# ios - 我如何将应用程序提交到 iTunes 并以我的客户的名义拥有它？

> ID：16095888
> 
> 赞同：0
> 
> 时间：2013-04-19T01:41:05.830
> 
> 标签：ios, app-store-connect, appstore-approval

我正在为客户构建一个应用程序，他们想以他们的名义提交到应用程序商店。我假设他们必须购买 99 美元的应用程序许可证。他们必须有一台安装了 Xcode 的 Mac 才能这样做吗？他们是否以某种方式设置它并允许我访问提交应用程序/更新应用程序/等？我应该把我的 MacBook 带给他们，让他们在我的电脑上创建他们的帐户吗？这甚至有意义吗？我已经创建了大量应用程序，但还没有向应用程序商店提交任何应用程序，所以我有相当长的学习曲线要​​经历。任何提示/建议/等表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:52:58.713

如果您的客户想要上传应用程序，那么他们需要拥有自己的开发者许可证才能将应用程序上传到 App Store。他们不需要 Mac，因为如果他们使用 Windows，他们可以使用应用程序加载器。除非他们希望您完成这项工作，否则无需设置您进行上传，在这种情况下，他们必须将您包括在他们的团队开发中并让您负责上传。我认为不需要您的 MacBook 机器，除非他们希望您完成所有操作，所以不需要。不把你的机器带给他们没有任何意义。我希望这能回答你所有的问题 Ryan。并且 + 1 用于提出一个好问题，尽管它不是一个编程问题。:)

# node.js - 如何在使用猫鼬填充的几个案例中只返回一个客户？

> ID：16095890
> 
> 赞同：0
> 
> 时间：2013-04-19T01:41:10.607
> 
> 标签：node.js, mongodb, express, mongoose

我正在使用 mongoose populate 尝试在我的模式中创建一对多关系

```
var clientSchema = new mongoose.Schema({
    name:  { type: String, required: true },
    title: { type: String, default: "N/S" },
    birthDate: { type: Date },
    ssn: { type: String, default: "N/S" },
    spouse: { type: String, default: "N/S" },
    notes: { type: String, default: "N/S" },
    address: { type: String, default: "N/S" },
    city: { type: String, default: "N/S" },
    state: { type: String, default: "N/S" },
    zip: { type: String, default: "N/S" },
    homePhone: { type: String, default: "N/S" },
    workPhone: { type: String, default: "N/S" },
    mobilePhone: { type: String, default: "N/S" },
    fax: { type: String, default: "N/S" },
    email: { type: String, default: "N/S" }
});
var caseSchema = mongoose.Schema({
    _client: { type: mongoose.Schema.Types.ObjectId, ref: 'Client' },
    name: { type: String, required: true },
    lead: { type: String },
    priority: { type: String },
    dateOpened: { type: Date },
    dateAccident: { type: Date },
    status: { type: String },
    sol: { type: Date },
    description: { type: String }
}); 
```

我想要做的是查询数据库以获取具有给定 _client id 的所有案例。我有这个工作，但不是我想要的方式。截至目前，当我在我的路线中使用填充方法时，我得到了具有该客户端 ID 的所有案例，但我也得到了所有客户端，即使所有客户端都完全相同. 为每种情况返回相同的客户端似乎是一种资源浪费。有没有办法只返回一次客户，然后所有相关的案例都用它？

```
app.get('/cases/:id', function( req, res ) {
    Case
    .find( { _client: req.params.id } )
    .populate('_client')
    .exec( function( err, cases ) {
        res.send( cases );
    });
}); 
```

这是我要回来的：

```
[
    {
        "_client": {
            "name": "John Doe",
            "birthDate": null,
            "_id": "51705a7ed0ecd0a906000001",
            "__v": 0,
            "email": "",
            "fax": "",
            "mobilePhone": "",
            "workPhone": "",
            "homePhone": "",
            "zip": "",
            "state": "",
            "city": "",
            "address": "",
            "notes": "",
            "spouse": "",
            "ssn": "",
            "title": "Mr"
        },
        "name": "test",
        "lead": "",
        "priority": "",
        "dateOpened": null,
        "dateAccident": null,
        "status": "",
        "sol": null,
        "description": "",
        "_id": "5170679df8ee8dd615000001",
        "__v": 0
    },
    {
        "_client": {
            "name": "John Doe",
            "birthDate": null,
            "_id": "51705a7ed0ecd0a906000001",
            "__v": 0,
            "email": "",
            "fax": "",
            "mobilePhone": "",
            "workPhone": "",
            "homePhone": "",
            "zip": "",
            "state": "",
            "city": "",
            "address": "",
            "notes": "",
            "spouse": "",
            "ssn": "",
            "title": "Mr"
        },
        "name": "newest case",
        "lead": "",
        "priority": "",
        "dateOpened": null,
        "dateAccident": null,
        "status": "",
        "sol": null,
        "description": "",
        "_id": "517067d8806f060b16000001",
        "__v": 0
    },
    {
        "_client": {
            "name": "John Doe",
            "birthDate": null,
            "_id": "51705a7ed0ecd0a906000001",
            "__v": 0,
            "email": "",
            "fax": "",
            "mobilePhone": "",
            "workPhone": "",
            "homePhone": "",
            "zip": "",
            "state": "",
            "city": "",
            "address": "",
            "notes": "",
            "spouse": "",
            "ssn": "",
            "title": "Mr"
        },
        "name": "adding new case",
        "lead": "Me",
        "priority": "Urgent",
        "dateOpened": null,
        "dateAccident": null,
        "status": "",
        "sol": null,
        "description": "",
        "_id": "51709a16806f060b16000002",
        "__v": 0
    }
] 
```

将所有这些臃肿发送到我的视图进行渲染似乎并不正确。我什至应该像这样使用填充一对多吗？我在 mongoose.com 上看到的所有示例都是一对一的，嵌入式文档除外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:06:57.690

如果您不希望客户端为每种情况重复，您最好单独查询客户端，然后以您需要的任何方式将该结果与`Case`查询结果（不带）组合。`populate`

顺便说一句，`'/cases/:id'`这是一个非常令人困惑的 URL，用于通过客户端 ID 而不是案例 ID 获取案例。

# ios - UITapGestureRecognizer 不捕获水龙头......“捕获”代码应该去哪里？

> ID：16095891
> 
> 赞同：-1
> 
> 时间：2013-04-19T01:41:13.720
> 
> 标签：ios, objective-c, uitapgesturerecognizer

我有一个 iPad 应用程序（XCode 4.6、Storyboards、iOS 6.2）。我有一个这样组成的场景：

1.  UIView（subViewData - 覆盖#2 的右象限，下方和右侧不包括#2 的时间和名称 - 包含约会信息（客户名称，持续时间为阴影）
2.  UIView（subViewGrid - 覆盖下半部分（在图像中，它包含左边距的时间和上边距的名称。）
3.  UIScrollView（覆盖下半部分视图）
4.  UIView ------- UIView（一个在窗口的上半部分，另一个在下半部分）
5.  UIViewController（命名为 CalendarViewController）

![日历和时间表](https://i.stack.imgur.com/buhcA.png)

这是初始化在 CalendarViewController 的 -viewDidLoad 中找到的 UITapGestureRecognizer 的代码：

```
 //  setup for tap recognizer
UITapGestureRecognizer *fingerTap = [[UITapGestureRecognizer alloc] initWithTarget:self
                                    action:@selector(singleFingerTap:)];
fingerTap.numberOfTapsRequired = 1;
fingerTap.numberOfTouchesRequired = 1;
[subViewData addGestureRecognizer:fingerTap]; 
```

这是未执行的 subViewData (#1) 中的代码：

```
- (void)singleFingerTap:(UITapGestureRecognizer*)gesture {

CGPoint pt = [gesture locationInView:self];
UIView *v = [self hitTest:pt withEvent:nil];

if(v.tag == 100)  //  if this is for calendar, return
    return;

CGRect dataRect = CGRectMake(110.0,48.0,670.0,1450);
CGPoint dataPoint = CGPointMake(pt.x, pt.y);

//  check to see if point is within the rectangle
if(!CGRectContainsPoint(dataRect, dataPoint))  {
    NSLog(@"\n\nNOT within subViewData");
    return;
}
else  {
    NSLog(@"\n\nIS within subViewData");
} 
```

}

问题是它为什么不捕获水龙头？识别器代码应该在控制器中还是应该在被点击的视图中？我已经阅读了几乎所有我能找到的关于这个主题的东西，但是在这个特定的场景中找不到任何东西。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:48:52.030

你说：

> 这是初始化在 CalendarViewController 的 -viewDidLoad 中找到的 UITapGestureRecognizer 的代码

那个代码说：

```
 [[UITapGestureRecognizer alloc] initWithTarget:self
                                action:@selector(singleFingerTap:)]; 
```

然后你必须放入`singleFingerTap:`CalendarViewController，因为你已经告诉手势识别器目标是`self`，并且`self`是 CalendarViewController 的一个实例。

你还说：

> 这是未执行的 subViewData (#1) 中的代码

但我不知道“in subViewData”是什么意思；您在对界面的解释中没有提到任何称为“subViewData”的内容。反正也没关系。您已指定`self`，因此代码需要位于`self`.

然而，在我看来，所讨论的观点似乎根本没有受到影响。也许它没有暴露（即它被另一个视图覆盖）。也许它`userInteractionEnabled`是NO。可能有很多原因。

# android - View.getDrawingCache() 具有半透明视图的背景

> ID：16095893
> 
> 赞同：-1
> 
> 时间：2013-04-19T01:41:23.800
> 
> 标签：android, android-view

是否可以使用视图后面的视图获取绘图缓存？例如，我有一个半透明的视图，我可以看到它背后的视图。那么，我可以在后面的视图可见的情况下获得该视图的绘图缓存吗？

我将视图添加到 WM 的代码：

```
 final View screenshotView = new View(this) {
                    @Override
                    protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
                        super.onLayout(changed, left, top, right, bottom);

                        if (!changed) {
                            buildDrawingCache();
                            final Bitmap bitmap = Bitmap.createBitmap(getDrawingCache());
                            final File file = new File("/sdcard/test.png");
                            try {
                                file.createNewFile();
                                FileOutputStream ostream = new FileOutputStream(file);
                                bitmap.compress(Bitmap.CompressFormat.PNG, 100, ostream);
                                ostream.close();
                            } catch (Exception e) {
                                Log.e(TAG, e.toString());
                            }
                        }
                    }
                };

WindowManager.LayoutParams screenShotViewLp = new WindowManager.LayoutParams(WindowManager.LayoutParams.TYPE_SYSTEM_ALERT, WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE, PixelFormat.RGBA_8888);
                screenShotViewLp.width = WindowManager.LayoutParams.MATCH_PARENT;
                screenShotViewLp.height = WindowManager.LayoutParams.MATCH_PARENT;
                screenShotViewLp.gravity = Gravity.LEFT | Gravity.TOP;

                wm.addView(screenshotView, screenShotViewLp); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:13:25.260

**[编辑]**根据问题的最后编辑，我认为这个答案不再适合。将视图直接添加到 WindowManager 事实上将讨论引向一个众所周知的问题：不允许在 Android 中以编程方式截取屏幕截图，然后下面公开的想法似乎完全不切实际。所以请不要低估。**[/编辑]**

AFAIK 这不能通过单个视图的绘图缓存来实现。为了获得背景上的其他视图，您应该获取视图树中最顶层节点的绘图缓存，即包含 Activity 的内容。获取这样的位图非常简单：

```
View root = currActivity.getWindow().getDecorView().findViewById(android.R.id.content);
root.setDrawingCacheEnabled(true);
Bitmap bmp = root.getDrawingCache(); 
```

然后，为了只获取您感兴趣的位图部分，您必须根据`View.getLocatonInWindow(int[])`值裁剪生成的位图。

还没有证明自己，但我很有信心它应该会奏效。

# c# - 如何从另一个可枚举的 c# 中插入可枚举

> ID：16095895
> 
> 赞同：3
> 
> 时间：2013-04-19T01:41:45.833
> 
> 标签：c#, linq, merge, ienumerable

我浏览了这个网站上的问题，但没有找到与我的特定问题相匹配的问题。

假设我有以下内容：

```
Product[] store1 = { new Product { Name = "apple", Code = 9, Code1="1" }, 
                   new Product { Name = "orange", Code = 4 } };

Product[] store2 = { new Product { Name = "apple", Code = 9, Code2="2" }, 
                   new Product { Name = "lemon", Code = 12 } }; 
```

和：

```
public class Product : IEquatable<Product>
{
    public string Name { get; set; }
    public int Code { get; set; }
    public string Code1 { get; set; }
    public string Code2 { get; set; }

    public bool Equals(Product other)
    {

        //Check whether the compared object is null. 
        if (Object.ReferenceEquals(other, null)) return false;

        //Check whether the compared object references the same data. 
        if (Object.ReferenceEquals(this, other)) return true;

        //Check whether the products' properties are equal. 
        return Code.Equals(other.Code) && Name.Equals(other.Name);
    }

    // If Equals() returns true for a pair of objects  
    // then GetHashCode() must return the same value for these objects. 

    public override int GetHashCode()
    {

        //Get hash code for the Name field if it is not null. 
        int hashProductName = Name == null ? 0 : Name.GetHashCode();

        //Get hash code for the Code field. 
        int hashProductCode = Code.GetHashCode();

        //Calculate the hash code for the product. 
        return hashProductName ^ hashProductCode;
    }
} 
```

如何返回单个 Enumerable，其中 store1 中的数据在匹配时被 store2 中的数据覆盖，并且在不匹配时从 store2 插入到 store1 中。基本上，我正在寻找与 TSQL Merge 语句等效的 C#。

在一天结束时运行这个：

```
foreach (var product in union)
      Console.WriteLine(product.Name + " " + product.Code + " " + product.Code1 + " " + product.Code2); 
```

我想回来：

苹果 9 1 2

橙色 4

柠檬 12

然而，当我运行这个：

```
IEnumerable<Product> union = store1.Union(store2); 
```

我得到：

苹果 9 1

橙色 4

柠檬 12

当我运行这个时：

```
IEnumerable<Product> union = store1.Concat(store2); 
```

我得到：

苹果 9 1

橙色 4

苹果 9 2

柠檬 12

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:37:49.847

```
 //
        // Summary:
        //     Produces the set union of two sequences by using the default equality comparer.
        //
        // Parameters:
        //   first:
        //     An System.Collections.Generic.IEnumerable<T> whose distinct elements form
        //     the first set for the union.
        //
        //   second:
        //     An System.Collections.Generic.IEnumerable<T> whose distinct elements form
        //     the second set for the union.
        //
        // Type parameters:
        //   TSource:
        //     The type of the elements of the input sequences.
        //
        // Returns:
        //     An System.Collections.Generic.IEnumerable<T> that contains the elements from
        //     both input sequences, excluding duplicates.
        //
        // Exceptions:
        //   System.ArgumentNullException:
        //     first or second is null.
public static IEnumerable<TSource> Union<TSource>(this IEnumerable<TSource> first, IEnumerable<TSource> second); 
```

因为函数

> 不包括重复项。

所以你必须为 Product[] 编写你的联合函数

```
public static class ProductExtension
{
    public static IEnumerable<T> Union<T>(this IEnumerable<T> store1, IEnumerable<T> store2)
    {
        List<T> List = new List<T>();
        foreach (var item in store2)
        {
            if (store1.Any(n=>n.Equals(item)))
            {
                var obj = store1.First(n => n.Equals(item));
                foreach (System.Reflection.PropertyInfo pi in obj.GetType().GetProperties())
                {
                    object v1 = pi.GetValue(obj, null);
                    object v2 = pi.GetValue(item, null);
                    var value = v1;
                    if (v2 != null && (v1 == null || v1.ToString() == string.Empty) && v1 != v2)
                    {
                        value = v2;
                    }
                    pi.SetValue(obj, value, null);
                }
                List.Add(obj);
            }
            else {
                List.Add(item);
            }            
        }

        foreach (var item in store1) { 
            if(!store2.Any(n=>n.Equals(item))){
                List.Add(item);
            }
        }
        return List.AsEnumerable();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T11:55:36.957

`Product`我会在课堂上为它编写自己的功能，而不是依赖反射。类似于`AsCombo`or`CombineWith`方法的东西：

```
public IEnumerable<Product> AsCombo(Product p)
{
    //if not equal, return both
    if (!Equals(p))
    {
        yield return this;
        yield return p;
        yield break;
    }

    //if equal return the one desired by checking all properties
    yield return new Product //always better to return new instance for linq queries
    { 
        Name = Name, 
        Code = Code, 
        Code1 = Code1 ?? p.Code1, //I give preference to 'this'
        Code2 = Code2 ?? p.Code2  //I give preference to 'this'
    };
} 
```

现在您所有的标准 Linq 查询都应该可以工作了。

```
var combo = store1.Concat(store2)
                  .GroupBy(x => x)
                  .Where(x => x.Count() == 1)
                  .Select(x => x.Key) //get non duplicated products
                  .Concat(store1.Distinct() //concat them with combined form of duplicated products
                                .Join(store2.Distinct(), x => x, x => x, (x, y) => x.AsCombo(y))
                                .SelectMany(x => x))
                  .ToList(); 
```

下面的查询稍微容易一些，但这取决于实现`Union`（假设`Union`保留第一个或外部序列的副本并丢弃后续/内部序列的重复项）。不建议。

```
var combo = store1.Join(store2, x => x, x => x, (x, y) => x.AsCombo(y))
                  .SelectMany(x => x)
                  .Union(store1)
                  .Union(store2)
                  .ToList(); 
```

# php - 显示 5 个最近的论坛帖子

> ID：16095896
> 
> 赞同：-2
> 
> 时间：2013-04-19T01:41:49.913
> 
> 标签：php

所以我的数据库中有 3 个表，比如说 1_comments、2_comments 和 3_comments，我想在 PHP 中一次显示所有 3 个表的最新 5 个帖子并按最近时间排序。我的代码是：

```
<?php
  $row="";

  $link = mysql_connect("localhost","username","password");
  mysql_select_db("database");
  $query = "SELECT * from 1_comments  ORDER by timestamp DESC limit 5";
  $result = mysql_query($query);

  while($row = mysql_fetch_array($result)) {
    echo "<ul>";
    echo "<li>".$row['comment']."</li>";
    echo "</ul>";
  } 

  mysql_close($link);
?> 
```

因此，它从 1_comments 的评论行中获取最近的 5 个帖子，并按它们最近的时间戳对其进行排序，但我似乎无法同时为 1_comments、2_comments 和 3_comments 工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:46:09.330

如果所有表都具有相同的结构，您可以使用[`UNION`](http://dev.mysql.com/doc/refman/5.0/en/union.html).

就像是：

```
(SELECT * from 1_comments  ORDER by timestamp DESC limit 5)
UNION
(SELECT * from 2_comments  ORDER by timestamp DESC limit 5)
UNION
(SELECT * from 3_comments  ORDER by timestamp DESC limit 5)
ORDER BY timestamp DESC limit 5 
```

但是，我会仔细查看数据库结构并尝试将 3 个相似的表减少到只有一个。

# nhibernate - NHibernate 2 FKs 到同一个 PK 的一对一关系

> ID：16095903
> 
> 赞同：0
> 
> 时间：2013-04-19T01:42:37.843
> 
> 标签：nhibernate, nhibernate-mapping

我在信封和交易之间有一对一的关系。我使用主键关联映射它，如下所示：

```
<class name="Envelope" table="T_ENVELOPE">
    <id name="EnvelopeId" column="ENVELOPE_ID"><generator class="identity"/></id>
    <one-to-one class="Transaction" cascade="all" name="Transaction" />
</class>
<class name="Transaction" table="T_TRANSACTION">
    <id name="TransactionID" column="TRANSACTION_ID" type="long"><generator class="foreign"><param name="property">Envelope</param></generator></id>
    <one-to-one name="Envelope" class="Envelope" constrained="true" />
</class> 
```

这很好用，但我的情况很复杂，因为`T_TRANSACTION`有 2 个 FK 都映射到`T_ENVELOPE's PK (ENVELOPE_ID): TRANSACTION_ID`（如上所示）和`OLD_DEPRECATED_TXN_ID`. 所以，我有 2 个 FK`T_ENVELOPE`具有完全相同的值（信封的 id）。我怎样才能让 NHibernate`ENVELOPE_ID`不仅保存在其中，`TRANSACTION_ID`而且还保存在其中`OLD_DEPRECATED_TXN_ID`？

我希望我没有这个要求，但我正在处理遗留代码模式和代码。我知道我也可以做类似的事情：

1.  envelope.Save // 这会保存 Envelope 和 Transaction 的事务 ID，但不保存 OLD_DEPRECATED_TXN_ID
2.  信封.transaction.old_deprecated_txn_id = 信封.id
3.  信封.Save 但是，这会导致一次插入和一次更新。我如何只做一个插入？

这是一个例子：

```
T_ENVELOPE
----------
ENVELOPE_ID
1
9
121

T_TRANSACTION
-------------
TRANSACTION_ID | OLD_DEPRECATED_TXN_ID
1|1
9|9
121|121 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T10:21:10.777

根据您的要求，您可以：

1.  编写一个存储过程来执行插入并配置 NHibernate 以在映射中使用此过程。在处理未使用但必须填充的遗留数据库和历史字段时，我采用了这种方法

2.  使用[拦截器](http://nhforge.org/doc/nh/en/#manipulatingdata-interceptors)。以下内容应该可以工作。虽然没有测试！

    ```
    public class TransactionEntityInterceptor : EmptyInterceptor
    {

      public override boolean OnSave(object entity,
                      object id,
                      object[] state,
                      string[] propertyNames,
                      IType[] types)
      {
          if (entity is Transaction)
          {
              Object TransactionID;
              for ( int i=0; i<propertyNames.Length; i++ )
              {
                  if ( "TransactionID" == propertyNames[i] )
                  {
                      TransactionID = state[i];
                      return true
                  }
              }

              for ( int i=0; i<propertyNames.Length; i++ )
              {
                  if ( "OLD_DEPRECATED_TXN_ID" == propertyNames[i] )
                  {
                      state[i] = TransactionID;
                      return true;
                  }
              }
              return false;
          }
          else
          {
              return true;
          }
      }
    } 
    ```

# c - 在 C 中创建一个数组来持有扑克手？

> ID：16095906
> 
> 赞同：-11
> 
> 时间：2013-04-19T01:42:54.723
> 
> 标签：c, poker

我在我的计算机科学课上有一项作业（我几周前发布了这个问题，但它的解释方式不适合我应该做的程序）。我已经有一个程序可以在这里洗牌和发牌。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void shuffle( int [][ 13 ] );
void deal ( const int[][ 13 ], const char *[], const char *[] );

 int main()
 {
  const char *suit[4] ={"Hearts","Diamonds","Clubs","Spades"};
    const char *face[13] ={"Ace", "Duece", "Three", "Four", "Five", "Six", 
    "Seven", "Eight","Nine", "Ten", "Jack", "Queen", "King"};
    int deck[4][13] = {0};
    int row, column, card = 1;

    for( row = 0; row <= 3; row++ )
    {
        for(column = 0; column <= 12; column++)
            {
            deck[row][column] = card;
            card++;
            }
    }

        srand(time(0));
        shuffle(deck);
        deal(deck, face, suit);
    return 0;
 }

 void shuffle( int wDeck[][13] )
 {
    int row, column, randomColumn, randomRow, card = 1, counter1, counter2, hold;

    for( counter1 = 0; counter1 <= 3; counter1++) 
    {
        for(counter2 = 0; counter2 <= 12; counter2++)
            {
                randomColumn = rand() % 13;
                randomRow = rand() % 4;

                    hold = wDeck[counter1][counter2];
                    wDeck[counter1][counter2] = wDeck[randomRow][randomColumn]; 
                    wDeck[randomRow][randomColumn] = hold;
            }
       }
    }

 void deal( const int wDeck[][13], const char *wFace[], const char *wSuit[] )
{
  int card, row, column;

        for ( card = 1; card <= 52; card++ )
            for (row = 0; row <= 3; row++ )
                for ( column = 0; column <= 12; column++ )
                    if( wDeck[row][column] == card )
                    {
                    printf("%5s of %-8s%c",wFace[ column ], wSuit[row], card % 2 == 0 ? '\n' : '\t');
                    break;
                    }
} 
```

我应该修改发牌功能以发一张 5 张牌的扑克手，然后检查他们有什么“等级”扑克手（两种，同花）。我的老师提到创建一个单独的双脚本数组来做到这一点，但我可以用不同的方式来做。问题是，我必须使用当前的牌组/洗牌设置来做到这一点。谁能解释如何做到这一点？如果它效率低下也没关系，只要它有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:30:05.280

对于现有的`deal`原型，没有办法从它返回信息——它没有返回值，所有的参数都是`const`. 由于牌组已经洗过（由`shuffle()`），我假设这个想法是让发牌函数查看牌组数组中的前五张牌，并找到它们的等级。这可以完全在`deal`函数内完成，或者（更好）通过`int rank(int hand[5])`从函数内调用函数来完成`deal`。

# image - Wordpress & CSS：圆角框上方的图像问题

> ID：16095909
> 
> 赞同：0
> 
> 时间：2013-04-19T01:43:21.770
> 
> 标签：image, wordpress, css

我有一个在 WordPress 博客中无法解决的问题。我不知道这是错误还是它们存在冲突。首先，看图片：http: [//i.imgur.com/K4gWjh9.png](http://i.imgur.com/K4gWjh9.png)

请注意此图像中的 3D 圆形边框和白色和黑色阴影。此图像在作者头像图像的框上方。我无法纠正它。见 JSFiddle 的例子：http: [//jsfiddle.net/ZUben/](http://jsfiddle.net/ZUben/)

我为 Wordpress 使用石墨烯主题，该主题已更新： [http ://www.khairul-syahir.com/wordpress-dev/graphene-theme#.UXCgoivwLRY](http://www.khairul-syahir.com/wordpress-dev/graphene-theme#.UXCgoivwLRY)

遵循我的风格：

```
.gutter-right {
    margin-right: 10px;
}

...

.post-avatar-wrap {
    float: right;
    width: 48px;
    height: 48px;
    background: #fff center;
        -moz-border-radius: 15px;
        -webkit-border-radius: 15px;
        border-radius: 15px;
        -moz-box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        -webkit-box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        margin-top: -10px;
}

...

.author-avatar-wrap {
    width: 48px;
    height: 48px;
    background: #fff center;
        -moz-border-radius: 15px;
        -webkit-border-radius: 15px;
        border-radius: 15px;
        -moz-box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        -webkit-box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        box-shadow: 1px 3px 1px rgba(255,255,255,0.35), inset 0px 3px 5px rgba(0,0,0,1);
        margin-top: -10px;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:12:00.473

好的，我们开始：设置图像`relative`并`z-index`为此图像应用一个低于`z-index`包装器的图像。此外，我们必须将 CSS3 边框样式应用于`div`和`img`.

所以去看看我的小提琴叉：http:  [//jsfiddle.net/ShwkP/](http://jsfiddle.net/ShwkP/)

我还创建了一个单独的类`border-styles`，以防我们有更多具有相同效果的元素。只需将其应用于所有元素即可获得这种边框。

请记住，这是 CSS3 并且不能跨浏览器工作，因为既不完全支持[边框半径](http://caniuse.com/#search=border-radius)也不完全支持[框阴影](http://caniuse.com/#search=box-shadow)！

# php - 如何卷曲表单提交的结果

> ID：16095911
> 
> 赞同：2
> 
> 时间：2013-04-19T01:43:23.963
> 
> 标签：php, forms, redirect, curl

我正在尝试制作一个将表单提交到另一个网站上的页面的页面，然后检索“结果页面”html并将其存储为变量。

问题有两个方面：首先，我是一个编程新手，不知道要搜索什么，即使我已经用谷歌搜索了好几天（我最初尝试在框架中这样做并了解了 SOP）。其次，如果我只是提交表单，它会在另一个域的下一页上正确加载，但该页面会做一些事情，然后重定向到具有我想要的实际结果的页面。

关于表单提交本身的一切工作正常，我只是不知道如何将结果（它重定向到的最终页面的 HTML）作为 PHP 中的变量提取。

它去：

```
mysite.com/mypage.php 
```

至

```
othersite.com/results1.php?session_key=abcdefghi123 
```

至

```
othersite.com/results2.php?session_key=abcdefghi123 
```

我需要最后一个的html。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:53:16.507

您可以使用类似这样的东西，其中 CURLOPT_POSTFIELDS 数组是您的 html 表单字段。

```
$h = curl_init();

  curl_setopt($h, CURLOPT_URL, "path/to/form.php"); 
  curl_setopt($h, CURLOPT_POST, true);
  curl_setopt($h, CURLOPT_POSTFIELDS, array(
  'txtfield1' => 'x',
  'txtfield2' => 'y'
  ));
  curl_setopt($h, CURLOPT_HEADER, false);
  curl_setopt($h, CURLOPT_RETURNTRANSFER, 1);

  $result = curl_exec($h);
  echo $result; 
```

再次阅读关于重定向的问题。请参阅下面的“Du D”评论，您还需要该行

# php - php imagecopyresampled isn't working

> ID：16095914
> 
> 赞同：3
> 
> 时间：2013-04-19T01:44:03.940
> 
> 标签：php, image, gd

I'm creating a website where I need to use a jQuery zoom script. the problem is I need a 4x larger image of the original file uploaded by the admin. The code i wrote is:

```
$allowedExts = array("jpeg", "jpg");
$extension = end(explode(".", $_FILES["file"]["name"]));
if (in_array($extension, $allowedExts))
{
    if ($_FILES["file"]["error"] > 0)
    {
        $out = "Error: " . $_FILES["file"]["error"] ."<br>";
    }
    else
    {
        $fname =  "img/" . $_POST["map"] . "." . $extension;
        move_uploaded_file($_FILES["file"]["tmp_name"], $fname);

        //crear imagen grande
        if(file_exists($fname)){
            list( $width, $height ) = getimagesize($fname);
            $nwidth = $width * 4;
            $nheight = $height * 4;
            $nimage = imagecreatetruecolor( $nwidth, $nheight );
            $image = imagecreatefromjpeg( $fname );
            if(imagecopyresampled( $nimage, $image, 0, 0, 0, 0, $nwidth, $nheight, $width, $height)){
                $nfname = "img/" . $_POST["map"] . "_big." . $extension;
                imagejpeg( $nimage, $nfname, 100 );
            }
            else{
                echo "Failed At re-sizing the image";
            }
            imagedestroy($image);
            imagedestroy($nimage);
        }
        else{
            echo "Can't find the file";
        }

        $out = $_FILES["file"]["name"] . " has been uploaded sucessfully <br>";
    }
}
else
{
    $out = "Invalid file (JPG-JPEG Only)<br>";
} 
```

And the form that sends the file is:

```
<form action="handler.php" method="post"
                enctype="multipart/form-data">
                <label for="file">Surface:</label>
                <input type="file" name="file" id="file"><br>
                <input type="hidden" name="id" value="2">
                <input type="hidden" name="map" value="surf">
                <input type="submit" class="buttons" name="submit" value="Submit" onmouseover="butOn(this,true)" onmouseout="butOn(this,false)">
              </form> <br><br> 
```

The thing is that when the image is uploaded it gives me the "failed at re-sizing" thing so its the imagecopyresampled function that is failing. Also I checked the width and height vars by echo function and they are ok. The GD library is also working fine.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:01:36.453

The typical problem with GD functions is that they quickly reach the upper PHP memory limit.

Do a `phpinfo()` and check the current limit.

I'd suggest you to increase it to 64M or even 128M. You can change this in the PHP.ini file or add a .htaccess file with:

```
php_value memory_limit 64M 
```

this is also possible from the .php file:

```
ini_set('memory_limit', '64M'); 
```

The column on the right of `phpinfo()` should show you the modified value.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:55:44.213

Solved: it turns out that the uploaded image was broken or something, the OS image viewer couldn't open it

# javascript - Javascript datepicker弹出窗口没有出现

> ID：16095920
> 
> 赞同：0
> 
> 时间：2013-04-19T01:44:27.870
> 
> 标签：javascript, jquery, datepicker

单击文本框时，我的 java 脚本日期选择器弹出窗口没有出现。我尝试了几乎 8 种不同的日期选择器，但都没有工作。

```
<tr>
<td >Date Of Birth</td>
<td ><input name="bdate" type="text" id="datepick2" disabled="disabled"/>
<script type="text/javascript" src="datepickr.js"></script>
<script type="text/javascript">
    new datepickr('datepick');
    new datepickr('datepick2', {
        'dateFormat': 'm/d/y'
    });

    new datepickr('datepick3', {
        'fullCurrentMonth': false,
        'dateFormat': 'l, F j'
    });
</script>
</td>
</tr> 
```

这就是我的代码的外观。我尝试在 Firefox 和 IE 中打开，但无法正常工作。没有错误单击文本框时不会出现任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:54:55.993

我猜它很快就会尝试，但没有看到其余的代码或不知道你正在使用什么插件，很难确定。试试这个：

```
$(function() {
   new datepickr('datepick');
   new datepickr('datepick2', {
    'dateFormat': 'm/d/y'
   });

   new datepickr('datepick3', {
    'fullCurrentMonth': false,
    'dateFormat': 'l, F j'
   });
}); 
```

等待 document.ready 事件，然后调用函数。或者你可能需要做

```
$('#id-of-input-you-want').datepickr(); 
```

# python - 从 Linux 上的虚拟环境安装distribute_setup.py 时出错

> ID：16095922
> 
> 赞同：1
> 
> 时间：2013-04-19T01:44:35.207
> 
> 标签：python, linux, python-3.x, distribute

我已经尝试了几个小时来让 Distribute_setup.py 在活动的虚拟环境中正确安装。我让它运行，但我总是得到一个错误。任何帮助，将不胜感激。我目前正在尝试在 Ubuntu 12.10 中执行此操作。

谢谢！

```
 python distribute_setup.py
 Extracting in /tmp/tmpvmrkpz
 Traceback (most recent call last):
 File "distribute_setup.py", line 546, in <module>
 sys.exit(main())
 File "distribute_setup.py", line 543, in main
 return _install(tarball, _build_install_args(options))
 File "distribute_setup.py", line 76, in _install
 tar = tarfile.open(tarball)
 File "/usr/local/lib/python3.3/tarfile.py", line 1571, in open
 raise ReadError("file could not be opened successfully")
 tarfile.ReadError: file could not be opened successfully
 (DjangoTutorial) test@ubuntu:~$ 
```

(DjangoTutorial) 是活动的虚拟环境

这是我尝试构建依赖项时得到的结果

```
test@ubuntu:~/Code/Tutorial$ sudo apt-get build-dep python3
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: You must put some 'source' URIs in your sources.list
test@ubuntu:~/Code/Tutorial$ 
```

Python3.3 安装在 /usr/local/lib

我也试过重新安装 ubuntu 和 python3.3 还是不行！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T13:27:41.427

这似乎不是虚拟环境问题。而是缺少 python 安装的依赖项的问题。尝试

```
sudo apt-get build-dep python3 
```

然后再次尝试配置和构建python3.3。还要添加 -dev 包

```
sudo apt-get install python3.3-dev 
```

现在尝试安装你的包。您很可能想再次创建虚拟环境。

tarfile.py 尝试使用四种提取方法（tar、gzip、bz2、xopen）之一打开压缩包，如果在 python 库中找不到相应的模块，则会出错，其中一些可能不包含在基本 python 中包裹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T16:40:21.367

`distribute_setup.py`将尝试下载包（从网上），然后安装它。也许您的下载由于某种原因无法完成，这就是下一步（提取 tarball）失败的原因。

您可以尝试从[此处](https://pypi.python.org/packages/source/d/distribute/distribute-0.6.36.tar.gz#md5=a923385de72dcdca68cd4ac2b9dc1148)下载源代码，然后手动安装。

1.  解压下载的tar

    `$ tar -xzvf distribute-0.6.36.tar.gz`

2.  切换到解压目录

    `$ cd distribute-0.6.36`

3.  运行安装

    `$ python setup.py install`

# php - 如何从 PHP 或 MySql 停止 mysqli bind_param 自动转换？

> ID：16095923
> 
> 赞同：2
> 
> 时间：2013-04-19T01:44:49.413
> 
> 标签：php, mysqli

我对 PHP 5.3.2 的 bind_param 函数有疑问。

假设我有一个数据库表名“tbl_user”和数据如下：

```
--------------------------------------
user_id [整数] | 用户名 [varchar(15)]
--------------------------------------
350 | 约翰·斯密奇
351 | 凯莉安
--------------------------------------

```

**第一次编码：**

```
$stmt = $mysqli->prepare("SELECT * FROM tbl_user WHERE user_id = ? ");
$stmt->bind_param('s', $v_user_id);
$v_user_id = '350a';
$stmt->execute(); 
```

系统将返回 1 个结果，其中 user_id 为 350，名称为“John Smitch”。

**二次编码：**

```
$stmt = $mysqli->prepare("SELECT * FROM tbl_user WHERE user_id = ? ");
$stmt->bind_param('s', $v_user_id);
$v_user_id = 'a350';
$stmt->execute(); 
```

系统将返回空结果给我。

到目前为止，我知道 PHP 5.3 会自动将值转换为字符串，一旦 MySql 从 php 接收数据，它将再次自动转换为它自己的数据类型，该数据类型在表结构中定义。

**那么我该如何处理这种情况，以便系统在我传递值'350a'时向我返回空结果？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-11-25T00:02:50.797

您需要在执行语句之前验证该值。验证它的最简单方法是检查字符串是否为数字。

```
$v_user_id = '350a';
if(is_numeric($v_user_id)) {
    $stmt = $mysqli->prepare("SELECT * FROM tbl_user WHERE user_id = ? ");
    $stmt->bind_param('s', $v_user_id);
    $stmt->execute();
} 
```

# ruby - Ruby将wget输出存储在变量中

> ID：16095928
> 
> 赞同：0
> 
> 时间：2013-04-19T01:45:21.947
> 
> 标签：ruby, wget

我正在使用`-O`or`--output-document`选项`wget`来存储从网站获取的 http。但是 -O 选项需要一个文件来存储输出，我想将它存储在我的程序中的一个变量中，以便我可以更轻松地操作它。有没有办法在不从文件中重新读取它的情况下做到这一点？本质上，我是在手动创建一个粗略的缓存。

**示例代码**

```
#!/usr/bin/ruby
url= "http://www.google.com"
whereIWantItStored = `wget #{url} --output-document=outsideFile` 
```

**参考**：我发现这篇文章有助于在`wget`我的程序中使用：[Using wget via Ruby on Rails](https://stackoverflow.com/questions/12789369/using-wget-via-ruby-on-rails)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T01:59:05.730

```
#!/usr/bin/ruby
url= "http://www.google.com"
whereIWantItStored = `wget #{url} -O -` 
```

一定要清理你的 url 以避免 shell 注入。-O 之后的 - 表示标准输出，它被 ruby​​ 反引号捕获。

[https://www.owasp.org/index.php/Command_Injection](https://www.owasp.org/index.php/Command_Injection) 解释了 shell 注入。

[http://apidock.com/ruby/Shellwords/shellescape](http://apidock.com/ruby/Shellwords/shellescape) 对于 Ruby >=1.9 或[Escape Gem](http://www.a-k-r.org/escape/ "逃脱宝石")对于 ruby​​ 1.8.x

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:53:44.190

我不会使用 wget。我会使用类似[HTTParty](https://github.com/jnunemaker/httparty)的东西。

然后你可以这样做：

```
require 'httparty'
url = 'http://www.google.com'
response = HTTParty.get(url)

whereIWantItStored = response.code = 200 ? response.body : nil 
```

# mongodb - 在 MongoDB Doctrine 中选择字段有危险吗？

> ID：16095934
> 
> 赞同：0
> 
> 时间：2013-04-19T01:46:07.850
> 
> 标签：mongodb, doctrine, doctrine-odm

我不确定这是否是我的错。但我发现 mongodb 学说查询中的选择字段会导致可怕的后果。

例如，我有一个页面文档，例如：

```
class Page
{
    /**
     * @MongoDB\String
     */
    private $title;

    /**
     * @MongoDB\Int
     */
    private $nbClicks = 0;

    /**
     * @MongoDB\Int
     */
    private $nbShares = 0;

    // other fields ...
} 
```

我可能会写一些查询，例如

```
$queryBuilder->select('title')->getQuery()->execute(); 
```

我在这背后的某个地方

```
$dm->flush(); 
```

我之前检索到的页面的 nbClicks 和 nbShares 设置为 0。

这是预期的还是可能是错误？

谢谢！

# asp.net - 意外调用了相同的操作

> ID：16095937
> 
> 赞同：0
> 
> 时间：2013-04-19T01:46:36.753
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-routing

此 ASP.NET MVC 应用程序的布局如下所示（这是一个移动 Web 应用程序）：

1.  **第1页**是第1个问题 -> 提交表格并返回**第2页的视图**
2.  **第 2 页**是问题 2 -> 提交表单并返回**第 3 页的视图**
3.  **第 3 页**是最后一个问题 -> 提交以完成处理

在每个表单提交后，我希望下一页的视图会出现并相应地提交。但是，当我点击提交按钮时，真正发生的事情是在**第 1 页上，它***显示了* **第 2 页的**视图，但是现在我在**第 2 页**上并且我在该页面上点击了提交，它调用了**第 1 页的** `HttpPost`操作。

什么会导致**第 2 页的**提交调用**第 1 页的** `HttpPost`操作？

这是我正在做的事情的基本想法：

```
public ActionResult Index()
{
    return View();
}

[HttpPost]
public ActionResult Index(MyModel myModel)
{
    return View("Page2", myModel);
}

[HttpPost]
public ActionResult Page2(MyModel myModel)
{
    return View("Page3", myModel);
}

[HttpPost]
public ActionResult Page3(MyModel myModel)
{
    if (ModelState.IsValid)
    {
        // do something and complete
    }

    return RedirectToAction("Index", "Home");
} 
```

这显然过于简单化了，但你应该明白这一点。的`Page2`视图得到渲染没有问题。但是在那个页面上，当点击提交按钮时，它会直接回到`HttpPost`.`Index()`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:55:52.803

发生这种情况的原因是，当您使用 mvc 的`BeginForm`HTML 帮助程序时，它会提交给呈现操作，而不是提交给与视图名称相同的操作，但您可以修复它！

两种选择：

**首先**：在 HTML 帮助器中设置控制器和操作的值：

```
@BeginForm("Page3", "controllerName") 
```

**第二**：重定向到动作而不是返回视图：

```
[HttpPost]
public ActionResult Index(MyModel myModel)
{
    return RedirectToAction("Page2", myModel);
}

[HttpPost]
public ActionResult Page2(MyModel myModel)
{
    return RedirectToAction("Page3", myModel);
} 
```

# mobile - Joomla 3 隐藏模块仅适用于移动设备

> ID：16095938
> 
> 赞同：2
> 
> 时间：2013-04-19T01:46:53.577
> 
> 标签：mobile, module, hide, joomla2.5, joomla3.0

我在 Joomla 3 中使用移动就绪主题开发我的新网站。有人可以告诉我，如何为移动设备（iPhone 等）访问者隐藏几个模块？我在两个模块中有一个很长的横幅，如果使用计算机浏览器访问该站点看起来不错。但是，如果有人使用移动设备访问我的网站，我该如何隐藏这些模块？太长了，打破了一个很好的观点......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T20:39:18.323

假设您的模板正在使用 Bootstrap（大多数 3.0 模板都将使用），您只需在模块中添加一个特殊的类来为手机隐藏它。编辑模块时，转到选项 -> 高级选项并查找一个框以添加“模块类后缀”。添加“隐藏电话”（空间在开始时很重要，因为某些模块不会为您放置它......）以隐藏小于 767 像素的屏幕尺寸。如果您想在 767px 到 979px 宽度范围内隐藏它，也可以将“hidden-tablet”添加到列表中（也用空格分隔）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:43:06.220

我不知道这是否是最好的解决方案，但这是我现在想到的解决方案。

您可以使用 JBrowser 类

`$browser = JBrowser::getInstance();` `$browser->isMobile()`

它返回一个布尔值。

您可以直接从模板中隐藏模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-22T12:27:37.227

在新版本的 bootstrap 中有一个用于隐藏模块的新 css 名称，请在[http://getbootstrap.com/css/上查看](http://getbootstrap.com/css/)

例如：“hidden-xs”代表旧的“隐藏电话”

但是，如果您仍然有一个 truble 和“隐藏电话”或“隐藏 xs”作品。你可以自己添加这个类：

将此代码添加到您的 Css 文件之一（您的 style.css 或 custom.css）：

```
 @media (max-width : 768px) {
  .hidden-phone {
        display: none;
  }
} 
```

然后按照上面的建议并将模块类后缀添加到所需的模块。

> 编辑模块时，转到选项 -> 高级选项并查找一个框以添加“模块类后缀”。添加“隐藏电话”

# groovy - 如何从 HttpResponseDecorator 获取原始响应和 URL

> ID：16095941
> 
> 赞同：10
> 
> 时间：2013-04-19T01:47:27.780
> 
> 标签：groovy, httpresponse, httpbuilder

[HTTP Builder](http://groovy.codehaus.org/modules/http-builder/)的[REST 客户端](http://groovy.codehaus.org/modules/http-builder/doc/rest.html)返回一个[HttpResponseDecorator](http://groovy.codehaus.org/modules/http-builder/apidocs/groovyx/net/http/class-use/HttpResponseException.html)。如何从中获取原始响应（用于记录目的）？

编辑（一些代码可能很方便）：

```
 withRest(uri: domainName) {
        def response = post(path: 'wsPath', query: [q:'test'])
        if (!response.success) {
            log.error "API call failed. HTTP status: $response.status"
            // I want to log raw response and URL constructed here
        } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-30T13:29:07.153

我一直在做同样问题的噩梦。这是我使用 HTTPBuilder 的解决方案：-

```
response.failure = {resp ->
    println "request failed with status ${resp.status}, response body was [${resp.entity.content.text}]"
    return null
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-08T10:49:05.007

我使用了 XmlUtil，它返回漂亮的打印 xml：

```
 def data = respXml.data
    assert data instanceof groovy.util.slurpersupport.GPathResult

    println "${XmlUtil.serialize(data)}" 
```

如果您的数据是来自 groovyx.net.http.HttpResponseDecorator 的解析响应

希望能帮助到你。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-02-16T08:53:30.890

尝试这个：

`println response.data`

# macos - SQLite 标头和源版本不匹配

> ID：16095942
> 
> 赞同：2
> 
> 时间：2013-04-19T01:47:35.010
> 
> 标签：macos, sqlite

刚刚用自制软件安装了 SQlite3，但是当我运行它时，我得到以下信息：

```
SQLite header and source version mismatch
2011-06-25 16:35:41 8f8b373eed7052e6e93c1805fc1effcf1db09366
2012-01-16 13:28:40 ebd01a8deffb5024a5d7494eef800d2366d97204 
```

注意到 Linux 和 Ubuntu 上的人有时会遇到这个问题，但我在 Mac（OS X 10.7.5）上，所以同样的解决方案无法通过终端解决。

假设某处必须安装另一个版本，但不确定如何解决问题（相当新，请过度解释）。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-03T19:46:20.883

我在评论中留下了答案，但想正式回答对我有用的东西：

1.  我复制了 /usr/bin 中的 sqlite3 exec 文件
2.  我将 /usr/local/bin 中的 sqlite3 exec 替换为从 /usr/bin 制作的副本

现在它工作正常！（我还将旧的 Sqlite3 exec 文件保存为 .old 以防我遇到任何错误）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T10:05:18.377

在 Ubuntu 12.04 LTS 上，通过从 复制版本来替换`libsqlite3.so.0`和`libsqlite3.so.0.8.6`in并覆盖 in 版本也为我解决了 sqlite3 问题。`/usr/lib/i386-linux-gnu``/usr/local/lib``/usr/lib/i386-linux-gnu`

但是，这会干扰`Skype 4.2 for Linux`工作，导致消息

> $ Skype
> 
> skype：加载共享库时出错：libsqlite3.so.0：错误的 ELF 类：ELFCLASS64

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-20T02:41:31.617

这主要是因为 sqlite3 客户端和其他二进制文件不匹配而发生的。就我而言

> IN-PF1CCNV7:/usr/lib64 # rpm -qa | grep sqlite sqlite3-3.28.0-lp151.2.3.1.x86_64 libsqlite3-0-3.23.1-1.10.x86_64 sqlite3-devel-3.23.1-lp150.1.1。

我卸载了 sqlite3 并安装了与 sqlite3-devel 相同的 rpm

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-09T07:09:22.420

我认为您曾经安装 sqlite3 作为另一个安装的依赖项。此安装由 pkg-manager 执行，会将 sqlite3 安装到`/usr/bin/`.

我假设这次你想从构建它的源代码中安装 sqlite3。当您手动安装 sqlite3 时，`./configure`脚本将假定您的前缀是：`/usr/local/bin`。

因此，如果您不想发生这种冲突，请尝试： `./configure --prefix=/usr/`表明您要安装到`/usr/bin/`中，从而替换旧的。

问候

# git - 简单的服务器到客户端同步

> ID：16095943
> 
> 赞同：1
> 
> 时间：2013-04-19T01:47:36.627
> 
> 标签：git, svn, sync

我有一个设置，我的网络服务器托管了一个游戏的模组包，我将有几个朋友玩，我需要一种方法让他们非常轻松地下载我对模组所做的任何更改或更新盒。

我尝试查看 SVN 和 GIT，但我无法对它们做出正面或反面以使它们按我想要的方式工作。

对于 GIT，我能找到的每个客户端至少有 15MB，并且需要在 Windows 上进行重大安装。这是行不通的。我只想要一个小的独立程序，可以为他们拉下更新/更改。

至于SVN。我记得 Garry 的 mod 使用过它并且效果很好。但是我花了几个小时查看它的文档，不仅我必须在服务器上设置一些复杂的东西，而且在客户端，我什至不知道如何让它从服务器中提取。

有谁知道我可以使用的简单系统，这样当朋友想要更新他们的模组包以匹配我在服务器上的当前版本时，他们可以简单地打开更新程序并下载/替换/删除任何不匹配的文件服务器端副本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T04:09:06.130

我最终设法弄清楚如何使用 SVN (Subversion) 来做我想做的事。使用 subversion，我现在可以很容易地向用户推送更改，因为他们有一个小的命令行版本，可以对我的服务器执行 svn checkout，我可以只从服务器端维护包。

# memory-leaks - gdb转储特定区域的内存，将格式化的输出保存到文件中

> ID：16095948
> 
> 赞同：35
> 
> 时间：2013-04-19T01:48:13.390
> 
> 标签：memory-leaks, gdb, dump, coredump

我有一个错误（内存泄漏）软件。作为证据，我有 1GB 的 core.dump 文件。堆大小是 900MB，所以很明显，分配了一些东西，但没有释放内存。

所以，我有一个内存区域要像这样检查。

```
(gdb) x/50000s 0x200000000 
```

但是，仅凭肉眼很难猜到，哪个对象或结构没有被释放。我的想法是，“将 gdb 格式的输出保存到文件中，并运行模式匹配以查看哪个魔术字符串出现最多。” 所以，这是我的问题：

如何将以下命令的输出保存到文本文件中，以便编写分析器？

```
(gdb) x/10000000s 0x20000000    <-- I need this output into a file 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-11-18T17:22:30.990

您可以使用 gdb 的“转储”功能，参见：[https ://sourceware.org/gdb/onlinedocs/gdb/Dump_002fRestore-Files.html](https://sourceware.org/gdb/onlinedocs/gdb/Dump_002fRestore-Files.html)

对于您的示例：

```
dump binary memory result.bin 0x200000000 0x20000c350 
```

这将为您提供一个普通的二进制转储 int 文件`result.bin`。您还可以使用以下命令以十六进制格式转储它：

```
dump ihex memory result.bin 0x200000000 0x20000c350 
```

使用转储命令比使用 gdb 日志记录 hack 更清晰（它甚至对我不起作用）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-19T05:20:28.087

> 如何将以下命令的输出保存到文本文件中，以便编写分析器？
> 
> ```
>  (gdb) x/10000000s 0x20000000 
> ```

这实际上很容易：

```
(gdb) set height 0    # prevent GDB from stopping every screenfull
(gdb) set logging on  # GDB output is now also copied into gdb.txt
(gdb) x/10000000s 0x20000000
(gdb) quit 
```

瞧，享受你的输出`gdb.txt`。

> 我有一个错误（内存泄漏）软件。...“将 gdb 格式的输出保存到文件中，并运行模式匹配以查看出现最多的魔术字符串。”

这种想法不太可能产生令人满意的结果。考虑：

```
void some_function() {
   std::vector<string> *v = new std::vector<string>();
   // code to insert and use 1000s of strings into "v".
   return;  // Oops: forgot to delete "v".
} 
```

即使您可以有效地“看到出现最多的魔术字符串”，您也会发现您正在泄漏所有字符串；但它们*不是*问题，泄漏“v”是问题。

所以你真正想要的是构建一个图，其中分配的区域指向其他分配的区域，并找到该图的“根”。这几乎是不可能手工完成的。

那么什么*更有*可能帮助您找到内存泄漏？幸运的是，有*很多*工具可以为您解决这个问题：

*   [瓦尔格林德](http://valgrind.org)_
*   谷歌堆泄漏[检查器](http://google-perftools.googlecode.com/svn/trunk/doc/heap_checker.html)，
*   [杰马洛克](http://linux.die.net/man/3/jemalloc)，
*   ……等等等等。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2017-05-10T16:55:36.343

你可以写简单的 lkm 就可以了

```
lkm:
#include <linux/kernel.h>
#include <linux/module.h>

int  *ptr=(int*)0Xc18251c0; //the address you want to read from kernel space
int module_i(void)
{
 printk("%d\n",*ptr);
}
module_init(module_i); 
```

并且数据将显示在日志中，所以请写

```
enter code here
dmesg 
```

# java - 找不到捆绑“ExceptionMessages_en_US”的资源，Android 中的键

> ID：16095949
> 
> 赞同：0
> 
> 时间：2013-04-19T01:48:13.840
> 
> 标签：java, android

我又是 Java 的新手。不能说我记得使用 ResourceBundle。我收到异常 Can't find resource for bundle 'ExceptionMessages_en_US'，键。

这是我的 ListResourceBundle 类：

（我直接从 JavaDoc 中获取了示例，并用我自己的字符串对其进行了修改）

```
public class ExceptionMessages extends ListResourceBundle {

@Override
protected Object[][] getContents() {
     return new Object[][] {

             {"interfaceCount", "Device should have 1 interface."},
             {"epCount", "Device should have 3 endpoints."},
             {"noIntrIn", "Device does not have an interrupt input endpoint."},
             {"noBulkIn", "Device does not have a bulk input endpoint."},
             {"noBulkOut", "Device does not have a bulk output endpoint."},
             {"openFailed", "A call to deviceOpen has failed."},
             {"claimFailed", "A call to claimInterface has failed."},
             {"startSessionFailed", "Start USB Session has failed."},
             {"sessionNotStarted", "USB Session not started."},
             {"bulkTxError", "Bulk endpoint transmit error."},
             {"intrRxError", "Interrupt endpoint recieve error."},

        };  
}

} 
```

我也尝试命名类 ExceptionMessages_en_US 没有运气

我得到这样的资源包：

```
public void Test()
{
    try
    {
        ResourceBundle rb = ResourceBundle.getBundle("ExceptionMessages");
    }
    catch (Exception e)
    {
        e.printStackTrace();

    }

    int i = 0;
    i++;

} 
```

我也累了：

```
 public void Test()
 {
    try
    {
        ResourceBundle rb = ResourceBundle.getBundle("ExceptionMessages",new Locale("en", "US"));
    }
    catch (Exception e)
    {
        e.printStackTrace();

    }

    int i = 0;
    i++;

} 
```

但仍然得到异常。

我错过了什么？我敢肯定这是愚蠢的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T07:06:40.740

我需要添加包含 ExceptionMessages 的完整包。

例子：

```
 ResourceBundle rb = ResourceBundle.getBundle("com.mycomp.ExceptionMessages"); 
```

# machine-learning - 在 scikit-learn 中，DBSCAN 可以使用稀疏矩阵吗？

> ID：16095955
> 
> 赞同：10
> 
> 时间：2013-04-19T01:49:00.967
> 
> 标签：machine-learning, scikit-learn, cluster-analysis, data-mining, dbscan

运行 scikit 的 dbscan 算法时出现内存错误。我的数据大约是 20000*10000，它是一个二进制矩阵。

（也许DBSCAN不适合用这样的矩阵。我是机器学习的初学者。我只想找到一个不需要初始簇号的簇方法）

无论如何，我发现了 scikit 的稀疏矩阵和特征提取。

[http://scikit-learn.org/dev/modules/feature_extraction.html](http://scikit-learn.org/dev/modules/feature_extraction.html) [http://docs.scipy.org/doc/scipy/reference/sparse.html](http://docs.scipy.org/doc/scipy/reference/sparse.html)

但我仍然不知道如何使用它。在 DBSCAN 的规范中，没有关于使用稀疏矩阵的指示。不允许吗？

如果有人知道如何在 DBSCAN 中使用稀疏矩阵，请告诉我。或者你可以告诉我一个更合适的集群方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-25T12:36:39.293

`scikit`不幸的是，DBSCAN的实现非常*幼稚*。它需要重写以考虑索引（球树等）。

到目前为止，它显然会坚持计算一个完整的距离矩阵，这会浪费*大量*内存。

我可以建议您自己重新实现 DBSCAN。这相当容易，例如在维基百科和原始出版物中都有很好的伪代码。它应该只有几行，然后您就可以轻松地利用您的数据表示。例如，如果您已经有一个稀疏表示的相似图，那么进行“范围查询”通常相当简单（即仅使用满足您的距离阈值的边）

这是[scikit-learn github](https://github.com/scikit-learn/scikit-learn/issues/1938)中的一个问题，他们谈论改进实现。一个用户报告他使用球树的版本快了 50 倍（这并不让我感到惊讶，我之前已经看到类似的索引加速 - 当进一步增加数据集大小时它可能会变得更加明显）。

**更新**：自编写此答案以来，scikit-learn 中的 DBSCAN 版本已获得实质性改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T12:56:43.600

您可以将距离矩阵传递给`DBSCAN`，因此假设`X`是您的示例矩阵，以下应该可以工作：

```
from sklearn.metrics.pairwise import euclidean_distances

D = euclidean_distances(X, X)
db = DBSCAN(metric="precomputed").fit(D) 
```

**但是**，矩阵`D`甚至会大于`X`：`n_samples`² 条目。对于稀疏矩阵，k-means 可能是最好的选择。

（DBSCAN 可能看起来很有吸引力，因为它不需要预先确定数量的集群，但它会用它换取您必须调整的*两个*参数。它主要适用于样本是空间点并且您知道距离有多近的设置希望这些点在同一个集群中，或者当你有一个 scikit-learn 不支持的黑盒距离度量时。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-18T13:02:13.897

是的，从 0.16.1 版开始。这是一个测试的提交：

[https://github.com/scikit-learn/scikit-learn/commit/494b8e574337e510bcb6fd0c941e390371ef1879](https://github.com/scikit-learn/scikit-learn/commit/494b8e574337e510bcb6fd0c941e390371ef1879)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T06:57:17.063

Sklearn 的 DBSCAN 算法不采用稀疏数组。但是，[KMeans](http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html)和[Spectral 聚类](http://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html)可以，您可以尝试这些。有关 sklearns 聚类方法的更多信息：http: [//scikit-learn.org/stable/modules/clustering.html](http://scikit-learn.org/stable/modules/clustering.html)

# google-maps-api-3 - Google Maps APIV3 侦听器 set_at 直到第二次才触发

> ID：16095957
> 
> 赞同：0
> 
> 时间：2013-04-19T01:49:19.003
> 
> 标签：google-maps-api-3

我有以下代码，当多边形形状发生变化时应该会触发警报。此警报仅在形状更改两次后出现。意思是，在触发事件之前，我必须调整形状两次。

关于可能导致这种行为的任何想法？

```
function drawListener(drawingManager) {
    var coord_listener = google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {

        var coordinates = (polygon.getPath().getArray()); //get
        var bounds = new google.maps.LatLngBounds(); 
        var people = [];

        google.maps.event.addListener(polygon.getPath(), 'set_at', function () { //check to see if the item has been changed //THIS ONLY GETS CALLED AFTER POLYGON HAS BEEN CHANGED TWICE
            alert('changed');
        });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:56:09.977

我找到了答案：除了“set_at”之外，我还必须使用“insert_at”

```
 google.maps.event.addListener(polygon.getPath(), 'set_at', function () { 
        alert('changed');
    });

 google.maps.event.addListener(polygon.getPath(), 'insert_at', function () {
        alert('also changed');
    }); 
```

谢谢。

# linux - 在 bash 中，如何在不同机器之间拆分或合并文件？

> ID：16095963
> 
> 赞同：0
> 
> 时间：2013-04-19T01:50:03.123
> 
> 标签：linux, performance, shell, unix, client-server

实际上，我有一台服务器和许多客户端。这些客户端每个都有自己的配置文件。服务器将获取所有客户端的配置文件，然后将它们合并到一个文件中，然后工作。有时，客户端会获取服务器的合并文件然后修改它的一部分，把它寄回去。像这张照片：

![在此处输入图像描述](https://i.stack.imgur.com/0hbCW.jpg)

好吧，我尝试了一种方法来做到这一点。

每个客户端都有一个自己的拆分配置文件并更新它。当客户端修改它的片段时，然后尝试获取所有客户端的片段并将它们合并到一个文件中。然后将此文件发送到服务器。

```
cat split.1 >> all.config
cat split.2 >> all.config
cat split.3 >> all.config 
```

当客户端同步配置文件时，它会从服务器获取 all.config，然后通过“拆分标志”将其拆分为多个部分......

我认为这是一种非常愚蠢的方式，但它确实有效。还有其他更漂亮的方式来实现这种需求吗？

# java - 在静态块中初始化线程？

> ID：16095965
> 
> 赞同：4
> 
> 时间：2013-04-19T01:50:22.170
> 
> 标签：java, multithreading, static, jvm

如果我在静态块中启动一个线程。jvm会在加载类之前等待线程完成吗？

```
static {
    System.out.println("static block");
    DataRetrievalThread t = new DataRetrievalThread();
    t.run();
} 
```

我尝试这样做的原因是因为我想从服务器检索数据并且获取它的时间太长了。因此，为了持久化我想要检索的数据并将其存储在一个文件中，这样当客户端要求它时 - 它不需要调用服务器来获取信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:57:27.237

> 如果我在静态块中启动一个线程。jvm会在加载类之前等待线程完成吗？

呃。是的，不是的，不是的。

1.  首先，您的代码不是分叉线程。因此，尽管从技术上讲，该类在该部分运行之前已“加载”，但正如它所写的那样，*它将支持类构造。*`static`那是因为您`run()`直接在当前主线程中执行该方法。如果你想分叉线程，那么你应该调用`t.start();`.

2.  如果你真的用`t.start()`then no 分叉线程，线程将在后台运行并且不会阻止类初始化。

3.  你真的*不*应该做这样的事情。这是一个非常糟糕的模式。如果您解释您要完成的工作，我们应该能够提供*真正*的帮助。

如果您尝试将数据预加载到您的程序中，那么您应该尽早运行加载部分`main()`并且不要将其停放在`static`类的初始化程序中。但是如果你在主线程中运行它，阻止程序，我不明白为什么这比按需发出请求更快。

要考虑的一件事是分叉（使用`t.start()`）一个后台线程来加载数据，然后拥有一个保存数据的类。如果线程及时完成，那么它将预先加载数据。当程序需要数据时，它应该调用类来获取它。如果线程尚未完成，它可以执行`countDownLatch.await()`. 当线程完成下载它可以做`countDownLatch.countDown()`。所以你会得到一些并行性。

就像是：

```
public class DataLoader {
    private volatile Stuff data;
    private final CountDownLatch latch = new CountDownLatch(1);
    // start the thread, called early in main()
    public void init() {
        // you pass in this so it can call setData
        DataRetrievalThread t = new DataRetrievalThread(this);
        t.start();
    }
    // called from the DataRetrievalThread
    public void setData(Stuff data) {
        this.data = data;
        latch.countDown();
    }
    public Stuff getData() {
        if (data == null) {
            latch.await();
        }
        return data;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T01:56:30.153

随着`run()`您在当前线程中执行该方法，之后该类将完成加载。您需要调用`start()`以在新线程中运行该方法。

# c - 如何避免将数据写入磁盘花费太长时间

> ID：16095966
> 
> 赞同：2
> 
> 时间：2013-04-19T01:51:01.070
> 
> 标签：c, linux

```
 static const int MAX_BUFFER_LEN = 1024*12; //in byets
    char *bff = new char[MAX_BUFFER_LEN];
    int fileflag = O_CREAT | O_WRONLY | O_NONBLOCK;

    fl = open(filename, fileflag, 0666);

    if(fl < 0)
    {
        printf("can not open file! \n");
        return -1;
    }

    do
    {

        ///begin one loop
        struct timeval bef;
        struct timeval aft;
        gettimeofday(&bef, NULL);

        write(fl, bff, MAX_BUFFER_LEN);

        gettimeofday(&aft, NULL);

        if(aft.tv_usec - bef.tv_usec > 20000) //ignore second condition
        {   
            printf(" cost too long:%d \n", aft.tv_usec - bef.tv_usec);
        }   
        //end one loop

        //sleep
        usleep(30*1000); //sleep 30ms

    }while(1); 
```

当我在 Linux ubuntu 2.6.32-24-generic 上运行程序时，我发现 COST TOO LONG 打印在一分钟内显示 1~2 次。我尝试了U盘和硬盘。我也在arm平台上尝试了这个程序。这种情况也发生了。我认为 3.2Mbps 对于低速 IO 设备来说太高了。所以我降低到0.4Mbps。它显着降低了打印频率。有什么办法可以控制时间成本吗？write() 只是将数据复制到 kenal 缓冲区并立即返回还是等待磁盘 IO 完成？kenal IO缓冲区是否已满并且必须等待刷新但为什么只有几次花费这么长时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T02:06:35.503

你不能加速磁盘，但你可以在磁盘工作时做其他事情。您无需等待它完成。

然而，这在 C 中非常重要。您需要非阻塞 I/O、多线程或多处理。尝试搜索这些关键字以及如何使用不同的技术（您已经在那里使用了非阻塞 fd）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T02:10:02.080

您的磁盘 I/O 性能受到每次写入周围代码以测量时间的负面影响（并且在此粒度测量时间会随着计算机执行其他操作而偶尔出现峰值）。

相反，测量代码的性能以写入整个数据 -循环*外*的开始/结束时间（当然，循环有适当的界限）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T13:07:41.470

如果您正在调用您认为会花费大量时间的文件写入，那么让您的进程运行两个线程，而一个正在执行主要任务让另一个写入磁盘。

# jquery - 防止 .slideUp 设置 display:none 完成

> ID：16095971
> 
> 赞同：0
> 
> 时间：2013-04-19T01:51:51.530
> 
> 标签：jquery

.slideUp 功能完成后，有没有办法阻止元素更改为 display:none？

如果可能，我希望该功能在达到 div 的最低高度后停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:58:16.023

只需在 height 属性上使用 $.animate 即可。

```
$('#myelement').animate({ height: 0 }, { duration: 'slow' }); 
```

[http://jsfiddle.net/sZX2s/](http://jsfiddle.net/sZX2s/)

# c++ - 在越来越多的坐标范围内运行 prim 的最快方法

> ID：16095972
> 
> 赞同：4
> 
> 时间：2013-04-19T01:52:09.380
> 
> 标签：c++, algorithm

我希望有人能给我一个通用的方法来计算 MST 的问题，该问题的输入格式如下：

```
<number of vertices>
<x> <y>
<x> <y>
... 
```

我了解如何实现 prim 算法，但我正在寻找一种方法（使用 prim 算法）将需要最少的内存/时间来执行。我应该将所有内容存储在邻接矩阵中吗？如果顶点数增加到 10,000，那么解决这个问题的最佳方法是什么（假设使用 prim 的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:11:05.200

您真的需要使用 Prim 的吗？

一种简单的方法是每次添加节点时使用 Kruskal 算法重新计算生成树（仅使用先前选择的边）。由于 Kruskal 是 O(E log E) 并且在每次迭代中，您将正好有 2*V-1 边要计算（前一棵树的 V-1 + 新添加的节点的 V）。每次插入都需要 O(V log V)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T02:50:07.420

如果你有一个密集的图（一个有很多边的图），Prim 的算法会更快。如果使用邻接矩阵，Prim 算法的复杂度为`O(|V|^2)`.

这可以通过使用具有由邻接表表示的图的二进制堆数据结构来改进。使用这种方法，复杂度将是`O(|E|log|V|)`.

使用带有邻接表的斐波那契堆数据结构会更快，复杂度为`O(|E| + |V|log|V|)`.

注：`E`指图中边数，而`V`指图中顶点数。

`STL`已经实现了二进制堆数据结构，`std::priority_queue`. A`std::priority_queue`调用`heap`算法库中的算法。您还可以使用 a `std::vector`（或任何其他具有随机访问迭代器的容器）并调用`make_heap`、`push_heap`、`pop_heap`等。这些都在算法库中。更多信息在这里：[http](http://www.cplusplus.com/reference/algorithm/) ://www.cplusplus.com/reference/algorithm/ 。

您也可以实现自己的堆数据结构，但这可能太复杂且不值得性能优势。

# ios - 找不到实例方法“-presentViewController:animated”

> ID：16095977
> 
> 赞同：4
> 
> 时间：2013-04-19T01:53:15.280
> 
> 标签：ios, objective-c, cocoa-touch, uiviewcontroller

我对此很陌生，所以请耐心等待。我的代码中有 2 个错误需要修复。在这两种情况下，我的实例方法都没有找到：

```
-(IBAction)goFlipSide {
    NSLog(@"goFlipSide has been called:");
    FlipsideViewController *controller = [[FlipsideViewController alloc] initWithNibName:@"FlipsideViewController" bundle:nil];

    controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
    [self presentViewController:controller animated:YES];

    [controller release];
}

- (void)flipsideViewControllerDidFinish:(FlipsideViewController *)controller {
    [self dismissViewControllerAnimated:YES];

    //This method gets fired when the user clicks done on the modal FlipsideViewController.  This is different
    //than the viewWillAppear.
    self.navigationController.navigationBarHidden = TRUE;
    /*
    if (self.goViewSuccess == TRUE) {
        //if the goViewSuccess boolean is set to YES - then we can load the load the goViewController
        NSLog(@"goViewSuccess is YES");
        [self loadGoViewController];
    }
    */
} 
```

两个未找到的实例方法是：`presentViewController:`和`dismissViewControllerAnimated:`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T01:56:32.920

什么课`self`？这些方法只能在`UIViewController`. 完整的选择器是：

*   `presentViewController:animated:completion:`
*   `dismissViewControllerAnimated:completion:`

尝试添加完成块参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T01:57:00.370

代码应该是这样的

```
[self dismissViewControllerAnimated:YES completion:nil]; 
```

或者如果你在完成后想要一些东西，

```
[self dismissViewControllerAnimated:YES completion:^{
//do stuff
}]; 
```

而对于另一个

```
[self presentViewController:controller animated:YES completion:nil]; 
```

# android - textview 显示 html 数据：ListAcitivity 不显示图像

> ID：16095979
> 
> 赞同：0
> 
> 时间：2013-04-19T01:53:23.807
> 
> 标签：android, image, android-listview, textview

我想用 textview 显示 html 数据。所以我用这个`Html.fromHTML()`方法。除图像外，所有 HTML 数据均正确显示。这些图像只是在一个小 dastbox 中显示了一个“OBJ”。我无法弄清楚这个问题。

我的代码可能更清楚地表达了我的问题：

```
public class MyActivity extends ListActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    fetchData();
}

private void fetchData() {
    new fetchDataTask().execute();
}

private class fetchDataTask extends AsyncTask<Void, Integer, ArrayList<Map<String, CharSequence>>> {

    @Override
    protected void onPostExecute(ArrayList<Map<String, CharSequence>> result) {
        // set adapter
        String[] from = { "title", "content" };
        int[] to = { R.id.title, R.id.content };
        SimpleAdapter adapter = new SimpleAdapter(MyActivity.this,
                result, R.layout.detail_item, from, to);
        setListAdapter(adapter);
    }

    @Override
    protected ArrayList<Map<String, CharSequence>> doInBackground(Void... params) {
        ArrayList<Map<String, CharSequence>> contentList = new ArrayList<Map<String, CharSequence>>();

        try {
            String dataid = getIntent().getExtras().getString("dataid");
            // fetch json data from webapi
            String result = MyUtil.fetchJsonData("http://www.mywebsite.com/datacontent" + dataid);
            JSONObject data = new JSONObject(result);
            JSONArray contentJArray = data.getJSONArray("content");
            for (int i = 0; i < contentJArray.length(); i++) {
                JSONObject oneObject = contentJArray.getJSONObject(i);
                Map<String, CharSequence> map = new HashMap<String, CharSequence>();
                map.put("id", oneObject.getString("id"));
                map.put("title", oneObject.getString("title"));

                // process content which is html format
                // the content is a html format data as following:
                // hello world, <img src="www.mysite.com/hello.jpg">.<br/>
                ImageGetter imageGetter = new ImageGetter() {
                    @Override
                    public Drawable getDrawable(String source) {
                        Drawable d = null;
                        try {
                            InputStream is = (InputStream) new URL(source)
                                    .getContent();
                            d = Drawable.createFromStream(is, "src");
                        } catch (MalformedURLException e) {
                            e.printStackTrace();
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                        d.setBounds(0, 0, d.getIntrinsicWidth(), d.getIntrinsicHeight());
                        return d;
                    }

                };
                CharSequence content = Html.fromHtml(
                        oneObject.getString("content"), imageGetter, null);
                map.put("content", content);
                contentList.add(map);
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }
        return contentList;
    }

} 
```

}

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/title"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:padding="10dp"
        android:textSize="16sp" >
    </TextView>

    <TextView
        android:id="@+id/content"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:padding="10dp"
        android:textSize="16sp" >
    </TextView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:11:34.843

使用`Html.fromHTML()`时，HTML 中的任何标签都将显示为通用替换图像，然后您的程序可以通过它并用真实图像替换。

# android - Android主题中的windowIsFloating属性

> ID：16095980
> 
> 赞同：27
> 
> 时间：2013-04-19T01:53:23.870
> 
> 标签：android, window, themes

这个属性的真正作用是什么？

我已经阅读了[文档](http://developer.android.com/reference/android/view/Window.html#isFloating%28%29)，并且理解它应该是什么。但是，当我在主题中使用它时（我创建了一个以`android:Theme.Dialog`为父的样式），更改此属性的值似乎没有任何效果。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-01-01T22:52:56.280

我不知道设置`windowIsFloating`为的所有效果`true`，但我注意到的一件事是，当它设置为 时`true`，活动不会扩展宽度以填充屏幕，即使您将布局宽度设置为`match_parent`（即`android:layout_width="match_parent"`）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-09-16T03:30:53.540

从我的实验来看，它似乎会影响窗口对软输入的反应。如果您将此设置为 false，则当键盘可见时，窗口不会向上滑动。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-04-12T03:32:24.023

当您使用**Dialog Theme**时，此属性默认为 true。

```
<style name="Base.V7.Theme.AppCompat.Light.Dialog" parent="Base.Theme.AppCompat.Light">
        ...
        <item name="android:windowIsFloating">true</item>
        ...
</style> 
```

在这种情况下，`Dialog`将使用以下代码创建 PhoneWindow：

```
 if (mIsFloating) {
        setLayout(WRAP_CONTENT, WRAP_CONTENT);
        setFlags(0, flagsToUpdate);
    } 
```

这将导致 contentView 总是将内容包装得尽可能小。您可以将其设置为 false 或手动将`Dialog`窗口布局更新为 MATCH_PARENT，如下所示：

```
override fun onStart() {
    super.onStart()
    dialog?.window?.setLayout(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-02T08:29:29.870

我正在使用非常幼稚的代码来显示底部工作表对话框片段。但是，我的对话框在浅色模式下覆盖了底部导航栏。见下图：

将该项目添加到我的对话框主题后，此问题得到解决。

```
<style name="myTheme" parent="Theme.MaterialComponents.BottomSheetDialog">
    <item name="android:windowSoftInputMode">stateAlwaysHidden|adjustNothing</item>
    <item name="android:statusBarColor">@android:color/transparent</item>
    <item name="android:windowIsFloating">false</item>
</style> 
```

[![在此处输入图像描述](https://i.stack.imgur.com/1TAD1.png)](https://i.stack.imgur.com/1TAD1.png)

# r - R：向量化有限差分方程

> ID：16095984
> 
> 赞同：1
> 
> 时间：2013-04-19T01:53:47.557
> 
> 标签：r, fortran95

我正在尝试将一些 Fortran 代码移至 R，以获得与化学动力学相关的有限差异。

示例 Fortran 循环：

```
DOUBLE PRECISION, DIMENSION (2000,2) :: data=0.0
DOUBLE PRECISION :: k1=5.0, k2=20.0, dt=0.0005
DO i=2, 2000
  data(i,1) = data(i-1,1) + data(i-1,1)*(-k1)*dt
  data(i,2) = data(i-1,2) + ( data(i-1,1)*k1*dt - data(i-1,2)*k2*dt )
  ...
END DO 
```

类似的 R 代码：

```
k1=5
k2=20
dt=0.0005
data=data.frame(cbind(c(500,rep(0,1999)),rep(0,2000)))
a.fun=function(y){
     y2=y-k1*y*dt
     return(y2)
 }
apply(data,2,a.fun) 
```

这会覆盖我在数据框中的第一个值，并在其他地方留下零。我想运行这个矢量化而不使用 for 循环，因为它们在 R 中*太慢*了。此外，我的函数到目前为止只计算第一列。在第一列的语法正确之前，我无法让第二列正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:45:44.543

可能这会有所帮助。

我认为你需要有初始条件`data[1,2]`。我在初始条件下都假设`data[1,1]`为 500 和0。`data[1,2`

代码如下：

```
> ## Define two vectors x and y
> x <- seq(from=0,length=2000,by=0)
> y <- seq(from=0,length=2000,by=0)
> 
> ## Constants
> k1 = 5.0
> dt = 0.0005
> k2 = 20.0
> 
> ## Initialize x[1]=500 and y[1]=0
> x[1]=500
> y[1] = 0
> 
> for (i in 2:2000){
+   x[i]=x[i-1]+x[i-1]*-k1*dt
+   y[i] = y[i-1]+x[i-1]*k1*dt-y[i-1]*k2*dt
+ }
> 
> finaldata <- data.frame(x,y)
> head(finaldata)
         x        y
1 500.0000 0.000000
2 498.7500 1.250000
3 497.5031 2.484375
4 496.2594 3.703289
5 495.0187 4.906905
6 493.7812 6.095382 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T03:19:48.693

R 不擅长循环并不一定是真的。这在很大程度上取决于你在做什么。使用`k1`、`k2`和问题（即以 开头的四行）`dt`并根据迭代矩阵制定问题，下面最后一行中的循环几乎立即在我的 PC 上返回：`data``k1=5`

```
z <- as.matrix(data)
m <- matrix(c(1-k1*dt, k1*dt, 0, 1-k2*dt), 2)

for(i in 2:nrow(z)) z[i, ] <- m %*% z[i-1, ] 
```

（您也可以尝试将向量存储在 z 的列中而不是行中，因为 R 按列存储矩阵。）

这是结果的第一位：

```
> head(z)
           X1       X2
[1,] 500.0000 0.000000
[2,] 498.7500 1.250000
[3,] 497.5031 2.484375
[4,] 496.2594 3.703289
[5,] 495.0187 4.906905
[6,] 493.7812 6.095382 
```

# ruby-on-rails - 复合键上的 Mongoid 唯一约束

> ID：16095986
> 
> 赞同：0
> 
> 时间：2013-04-19T01:54:08.610
> 
> 标签：ruby-on-rails, mongodb, mongoid

我正在尝试遵循[Mongoid 3 中的建议 - 检查复合键的唯一性，](https://stackoverflow.com/questions/11856015/mongoid-3-check-for-uniqueness-of-composite-key)以拥有一个对 2 个字段具有唯一约束的模型。

id 声明是这样的：

```
field :_id, type: String, default: &method(:generate_id)

private

  def generate_id
    user.id.to_s + offering.id.to_s
  end 
```

但是，如果我这样做，当我通过 new 实例化一个对象时，它就会有一个 conniption，因为它会尝试在它拥有用户和产品之前生成 id，并且它（正确地）不想使用 nil 的 id。我可以传入用户并作为构造函数参数提供，一切都很好。

我的问题是，这是正确的做法吗？考虑到我为了获得一个独特的约束而必须做的所有愚蠢的古怪行为，这感觉很脏。该代码根本不是很有意透露。有没有更好的办法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T02:18:33.400

使用普通的 MongoDB，您可以像这样使用 JavaScript 创建这个索引（假设您的集合名称是注册）：

```
db.registrations.ensureIndex( { "user_id": 1, "offering_id": 1 }, { unique: true } ) 
```

要使用 Mongoid 生成此索引，请将其添加到您的模型中：

```
index({ user_id: 1, offering_id: 1 }, { unique: true }) 
```

并运行`rake db:mongoid:create_indexes`。

如果您想继续生成`_id`with `generate_id`，可以将生成移至`before_validate`回调。

```
field :_id, type: String

before_validate :generate_id

private

def generate_id
  self._id ||= "#{user.id}:#{offering}"
end 
```

# javascript - jquery 加载调用导致空查询字符串

> ID：16095987
> 
> 赞同：0
> 
> 时间：2013-04-19T01:54:19.457
> 
> 标签：javascript, jquery, query-string, jquery-load

我有这个文件：“myFile.html”，我只想从查询字符串中显示 xxx 的值。我在其他线程的帮助下提取了以下内容。我使用了 purl 和一个自定义函数。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="js/purl.js"></script>

<script type="text/javascript">
$(document).ready(function(){
    console.debug($.url().param('xxx'));
    console.debug(getParameterByName('xxx'));
}); 

function getParameterByName(name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(window.location.search);
  if(results == null)
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
}
</script> 
```

从 firefox 调用 url: "localhost..../myFile.html?xxx=hi" 工作正常，并且 xxx 的值通过 purl 和自定义函数显示在控制台中。

但是，如果我通过 JQuery.load 在另一个页面“myHome.html”中加载“myFile.html”，则 xxx 的值会产生一个空字符串：

```
<script type="text/javascript">
$(document).ready(function(){
    $('#myDiv').load("myFile.html?xxx=hi");
}); 
</script> 
```

我想不通这是为什么...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:10:04.583

我认为您看到的行为是预期的，因为您正在使用这条线

```
$('#myDiv').load("myFile.html?xxx=hi"); 
```

将原始 HTML 转储到 myDiv div 标记中。包含页面的 URL 不受此操作的影响。因此，您对 xxx 查询字符串参数的调用不会返回任何内容，因为该参数嵌入在 div 标记中，而不是附加到查询字符串中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T07:41:10.980

我在这里找到了答案： [jquery get querystring of loaded page in a div](https://stackoverflow.com/questions/3180841/jquery-get-querystring-of-loaded-page-in-a-div)

这似乎不可能，但使用回调函数我克服了这个问题。

# object - 将对象数组从一个类传递到另一个类

> ID：16095989
> 
> 赞同：0
> 
> 时间：2013-04-19T01:54:48.167
> 
> 标签：object, constructor, arraylist, parameter-passing

我一直在尝试创建一个程序，它通过对象获取数组输入并传递参数（ArrayList 的模拟）。

我不断收到 **java.lang.ArrayIndexOutOfBoundsException**我猜我没有正确访问数组..

我可以做些什么来增强测试对象和/或构造函数？

```
public class MyArrayList{

 public int[] x; 

 public MyArrayList(  ){
    x = new int[0];
 }

 public MyArrayList(int[] k)
 {
    for (int i = 0; i < x.length; i++)
    x[i] = k[i];
    k = x; 
 }

 public void add(int index).......
 public int size().....
 public int get(int index).....
 public void set(int index, int value).......
 public String toString( )........ 
```

以下是我遇到问题的课程。

```
public class TestMyArrayList
 {
  public static void main(String[] args)
  {
     MyArrayList test = new MyArrayList();

     test.x[0] = 1;
     test.x[1] = 2;
     test.x[2] = 3;
     test.x[3] = 4;
     test.x[4] = 5;

     test.add(2);
     test.set(1,3);

     int a, b;
     String c;

     a = test.size( );
     b = test.get(5);
     c = test.toString( );

     System.out.println("The size of the array is" + a);
     System.out.println("The value at that position is " + b);
     System.out.println("The resulting string is: " + c);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:09:34.457

`x`构造函数中的这一行是初始化数组的唯一位置（在您显示的代码中） ：

```
x = new int[0]; 
```

它创建了一个零长度数组。假设您没有在其他地方重新初始化数组，那么所有这些行肯定会失败：

```
 test.x[0] = 1;
 test.x[1] = 2;
 test.x[2] = 3;
 test.x[3] = 4;
 test.x[4] = 5; 
```

因为您的数组长度为零。所以：

1.  将您的数组初始化为更合理的值
2.  考虑封装数组，以便调用者无法直接访问它。从长远来看，这将使您的应用程序更容易编写代码

### 旁注（又名奖金）：

你的另一个构造函数：

```
public MyArrayList(int[] k) {
    for (int i = 0; i < x.length; i++)
    x[i] = k[i];
    k = x; 
} 
```

也有一些问题：

1.  在复制值之前，您应该将数组重新初始化`x`为与提供的数组相同的大小。
2.  分配`k = x`基本上是无操作的，因为它实际上并没有改变`k`指向方法之外的内容。

总的来说，它应该看起来更像这样：

```
public MyArrayList(int[] k) {
    super();
    if(k != null) {
        x = new int[k.length];

        for (int i = 0; i < x.length; i++) {
            x[i] = k[i];
        }
    } else {
        x = null;
    }
} 
```

# c - 使用clock()确定函数的运行时间

> ID：16095991
> 
> 赞同：1
> 
> 时间：2013-04-19T01:55:03.020
> 
> 标签：c, time, clock

我正在尝试使用`clock()`. 这是到目前为止的代码：

```
time_t start, end;
start = clock();
// Function here
end = clock();
printf("Time was: %lf\n", ((double)(end-start)/CLOCKS_PER_SEC)); 
```

它返回`Time was: 0.030000`。如果我添加几秒钟的延迟，则会显示`Time was: 0.500000`. 如何让它在毫秒内正确显示？例如。`Time was: 500 milliseconds`还是`Time was: 30 milliseconds`？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T02:02:03.190

要以毫秒为单位显示时间，请将以秒为单位的时间乘以`1000`：

```
printf("Time was: %d\n", (1000*(end-start)/CLOCKS_PER_SEC)); 
```

上面的代码将时间截断到最小毫秒。

# c - C memcpy 未按预期运行

> ID：16095994
> 
> 赞同：0
> 
> 时间：2013-04-19T01:56:00.523
> 
> 标签：c, pointers, memcpy

这个问题与[在 C 中制作一个数组来保存字符数组的数组有关](https://stackoverflow.com/questions/16091848/making-an-array-to-hold-arrays-of-character-arrays-in-c)

从那里借用代码，我有一些看起来像这样的东西（感谢 luser droog 的漂亮示例代码）：

```
enum { BUFSZ = 50 };
enum { STRVSZ = 40 };
enum { STRVVSZ = 20 };
char buf[BUFSZ + 1];
char *strv[STRVSZ + 1];
char **strvv[STRVVSZ + 1];

int j;
int i;

while(1){
    fgets(buf, BUFSZ, infile);

    i = 0;
    strv[i] = strdup(buf);
    strv[i+1] = NULL;

    j = 0;
    strvv[j] = calloc(i+1, sizeof *strvv[j]); // assuming i is the count of elements 
    memcpy(strvv[j], strv, i * sizeof *strvv[j]);
    j++;
} 
```

这可能不会马上跑出去，但它说明了与我正在运行的类似的东西。基本上，strv 的内容需要在每次循环迭代后存储在 strvv 中，并且 strv 根据用户输入随时间变化。

使用 calloc 和 memcpy 应该会导致 strvv 在循环的每次迭代中维护 strv 的副本，而与 strv 中的值无关。但是，当我打印出 strvv 的内容时，它会为每个条目打印出相同的字符串，这意味着当前的方法仍在移动指针，而不是在每个 strvv 条目中复制 strv。

我完全不确定为什么会发生这种情况或如何解决它。memcpy 应该制作 strv 中的指针指向 =/ 的字节级副本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:23:29.043

这更接近我之前试图提出的建议。

```
enum { BUFSZ = 50 };
enum { STRVSZ = 40 };
enum { STRVVSZ = 20 };
char buf[BUFSZ + 1];
char *strv[STRVSZ + 1];
char **strvv[STRVVSZ + 1];

int j; // indexes strv slices in strvv
int i; // indexes strings (char *s) in strv

j = 0; // j is index into strvv

while(!feof(infile)) {

    i = 0; // i is index into strv
    while(i < STRVSZ){
        fgets(buf, BUFSZ, infile);
        if (strcmp(buf,"END")==0) break; // end of a set

        strv[i] = strdup(buf);
        strv[i+1] = NULL;
        i++;
    }  // i is count of strv

    // copy strv into strvv
    strvv[j] = calloc(i+1, sizeof *strvv[j]); // assuming i is the count of elements 
    memcpy(strvv[j], strv, (i+1) * sizeof *strvv[j]);  // i+1 to copy the NULL pointer
    j++; // index next element in strvv and a count of strvv

} // j is count of sets in strvv 
```

感觉还是一团糟。

功能。它需要更小、定义明确的功能。这里的变量都是*更有意义的*占位符。