# StackOverflow 问答 15666000-15666999

# css - IE10 - 使用 CSS 样式高度并在关注 SELECT 元素时添加边框需要用户双击 SELECT 元素

> ID：15666000
> 
> 赞同：1
> 
> 时间：2013-03-27T17:57:10.160
> 
> 标签：css, height, border, internet-explorer-10

我有一个表格，里面有一个 SELECT 元素。

```
<form name="something">
    <select>
        <option>One</option>
        <option>Two</option>
    </select>
</form> 
```

和CSS：

```
select
{  
    height:20px;
} 

form select:focus
{
    border: #ffdead solid 2px;
} 
```

我正在做的是确保所有 SELECT 始终具有相同的高度，但是当用户通过页面上的元素 TABS 时，我希望 SELECT 在焦点时具有边框。

这适用于大多数浏览器，但在 IE10 中，当用户单击 SELECT 时，选择不会展开 - 它是聚焦的，用户必须再次单击才能展开选项。

这是一个 JSFIDDLE，看看它在 IE10 中是如何工作的：http: [//jsfiddle.net/rtKGE/3/](http://jsfiddle.net/rtKGE/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T14:50:38.940

我发现它更多地与在 css 中设置 select 的**边框**有关：focus

您可以尝试在小提琴中使用它并查看它的工作原理

```
form select:focus
{
    color:red;
} 
```

无论如何，这很奇怪，因为除了你的小提琴之外，我可以设置其他边框属性，如边框颜色或边框样式，并且它只会在我设置边框宽度时再次中断，就像在这个 css 中一样

```
select:focus 
{
    border-color:#666666;
    border-style:solid;
    } 
```

希望能帮助到你。

问候，丹尼尔

# php - 使用 while 循环选择表并在表中显示其数据

> ID：15666005
> 
> 赞同：1
> 
> 时间：2013-03-27T17:57:36.013
> 
> 标签：php, mysql, while-loop, html-table

我正在尝试使用 php while 循环在 html 表中显示 db.table 中的 25 行数据以循环 25 行。目前我没有 25 行限制器，只是想在此刻显示数据。这就是我所拥有的。

```
<table>
    <td><strong>User Name</strong></td>                 
    <td><strong>User Email</strong></td>                        
    <td><strong>Is User an Admin</strong></td>
    <td><strong>Is User Active</strong></td>
<?php
$sql = 'SELECT name, login, is_admin, active
        FROM db.users';
$result = db_exec_prepared_stmt($sql);
while($rows = mysql_fetch_assoc($result)) {
    $user_name = $rows['name'];
    $user_email = $rows['login'];
    $user_admin = $rows['is_admin'];
    $user_active = $rows['active'];

    echo '<tr>
             <td>' . $user_name . '</td>
             <td>' . $user_email . '</td>
             <td>' . $user_admin . '</td>
             <td>' . $user_active . '</td>
         </tr>';
}
?>
</table> 
```

**我知道 mysql_fetch_assoc() 在这里不起作用，但我需要帮助才能获得正常运行的代码。**

这是 db_exec_prepared_stmt() 函数。

```
function db_exec_prepared_stmt($sql, $params=array(), $query_type='select') {
$types = '';
foreach($params as $p)  {
    if( is_numeric($p)
        && ($p <= 2147483647) 
        && (numberOfDecimals($p) === 0)
    ) $types .= 'i';
    else $types .= 's';
}
$db = db_open_connection();

if($stmt = $db->prepare($sql))  { 
    if($types != '')    {
        $binds = array_merge( array($types), $params );

        call_user_func_array( array($stmt, 'bind_param'), makeValuesReferenced($binds) );
    }

    switch($query_type) {
        case 'select':
            $results = db_fetch_assoc($stmt);
            break;

        case 'insert':
            $stmt->execute();
            $results = $db->insert_id;
            break;

        default:
            $stmt->execute();
            $results = null;
            break;
    }

    if('' != $stmt->error) printf("Error %s: %s.\n", $stmt->errno, $stmt->error);
}
else    {
    printf("Error %s: %s.\n", $db->errno, $db->error);
    $results = null;
}

db_close_connection($db);

return $results;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:03:53.953

我不熟悉你`db_exec_prepared_stmt`是如何准备连接的。但它看起来像是`db_exec_prepared_stmt`在查询数据库并使用 db_fetch_assoc 来处理所有结果并将它们作为结果数组返回。我会`var_dump($result = db_exec_prepared_stmt($sql));`看看你得到了什么。如果你得到一个单维数组，那么你需要修改`db_exec_prepared_stmt`，以便在选择查询类型时

```
case 'select':
    while($row=db_fetch_assoc($stmt)){
      $results[]=$row;
    }
    break; 
```

如果你得到一个包含行数组的数组，那么我会切换到`foreach`

```
foreach(db_exec_prepared_stmt($sql) as $row){
  //WORK
} 
```

或者，如果您必须使用 while 循环

```
while(next($results)){
  //WORK
} 
```

老实说，我不会使用，`db_exec_prepared_stmt`因为它试图成为每个人的一切，并且做得不太好。此外，您可能想查看 PDO 对象。

# r - mapply 和 SIMPLIFY 而不是剥离类

> ID：15666007
> 
> 赞同：1
> 
> 时间：2013-03-27T17:57:39.030
> 
> 标签：r

我在使用 lapply 和 mapply 返回数据时遇到问题。即 mapply / lapply 返回一个列表列表。如果我“简化”调用，它会删除类信息。

例如：

```
library(lubridate)

addBusDays <- function(d, dd) {
 d 
}

# start with datframe
dates <- c(ymd('2013-03-04'), ymd('2013-03-07'))
my.df <- data.frame(n=c(1,2), d=dates)

mapply(addBusDays, my.df$d, 1, SIMPLIFY=F) 
```

返回

```
[[1]]
[1] "2013-03-03 19:00:00 EST"

[[2]]
[1] "2013-03-06 19:00:00 EST"

class(mapply(addBusDays, my.df$d, 1, SIMPLIFY=F)[[1]]
[1] "POSIXct" "POSIXt" 
```

看起来它正在返回一个列表列表，这是可行的，但我不喜欢这个解决方案。允许函数简化剥离 POSIX 类：

```
mapply(addBusDays, my.df$d, 1, SIMPLIFY=T)
class(mapply(addBusDays, my.df$d, 1, SIMPLIFY=T))

> mapply(addBusDays, my.df$d, 1, SIMPLIFY=T)
[1] 1362355200 1362614400
> class(mapply(addBusDays, my.df$d, 1, SIMPLIFY=T))
[1] "numeric" 
```

这看起来返回一个列表，但去掉了类信息。任何帮助/想法？

根据 Gavin 的建议工作

```
library(lubridate)

addBusDays <- function(d, dd) {
  d 
}

# start with datframe
dates <- c(ymd('2013-03-04'), ymd('2013-03-07'))
my.df <- data.frame(n=c(1,2), d=dates)
my.df$d.2 <- as.POSIXct(mapply(addBusDays, my.df$d, 2, SIMPLIFY=T), origin="1970-01-01")

typeof(my.df$d)
class(my.df$d)
mode(my.df$d)
typeof(my.df$d.2)
class(my.df$d.2)
mode(my.df$d.2)

my.df 
```

返回

```
> my.df
  n                   d        d.2
1 1 2013-03-03 19:00:00 2013-03-04
2 2 2013-03-06 19:00:00 2013-03-07 
```

该技术将日期移动 1 - 在此示例中不应该，因为函数返回传入的日期......除了类等似乎是正确的。

而且我的眼睛在愚弄我——我的问题在于加载数据框——而不是加文的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:07:29.397

一种选择是`do.call()`成语：

```
> do.call("c", mapply(addBusDays, my.df$d, 1, SIMPLIFY = FALSE))
[1] "2013-03-03 18:00:00 CST" "2013-03-06 18:00:00 CST" 
```

其中，我们让 R 安排`c()`使用从返回的列表中给出的输入数据调用函数`mapply()`。

`do.call`一种替代方法，对于惯用语的大数据，这很可能会更快：

```
> as.POSIXlt(mapply(addBusDays, my.df$d, 1), origin = "1970-01-01 00:00.00")
[1] "2013-03-03 18:00:00 CST" "2013-03-06 18:00:00 CST" 
```

或更多包裹回一个`"POSIXct"`对象

```
> as.POSIXct(as.POSIXlt(mapply(addBusDays, my.df$d, 1),
+                       origin = "1970-01-01 00:00.00"))
[1] "2013-03-03 18:00:00 CST" "2013-03-06 18:00:00 CST" 
```

# android - Android小部件未更新

> ID：15666010
> 
> 赞同：1
> 
> 时间：2013-03-27T17:57:46.950
> 
> 标签：android, android-widget

我正在尝试编写一个 Android 小部件，它可以将自身更新为 text[] 中的不同消息。它输出第一条消息“Test1”，但不继续。当我选择一个新的小部件放置在主屏幕上时，它会更新。它不会在 logcat 中吐出任何内容。它应该每 5 秒更新一次小部件。我选择 5 秒只是为了测试。

清单.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.messageswidget"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <receiver android:name="main.MessagesWidget" android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>
        <meta-data android:name="android.appwidget.provider"
            android:resource="@xml/widgetinfo" />
    </receiver>

</application> 
```

MessagesWidget.java

```
package main;

import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.util.Log;
import android.widget.RemoteViews;

import com.example.messageswidget.R;

public class MessagesWidget extends AppWidgetProvider {
    private static int n = 0;
    String[] text = {"Test1", "More2", "Good3"};

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {
        super.onUpdate(context, appWidgetManager, appWidgetIds);
        Log.d("test", "good");
        // TODO Auto-generated method stub
        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widgetlayout);
        views.setTextViewText(R.id.msg, text[n]);
        n = (n + 1) % text.length;

        ComponentName cname = new ComponentName(context, MessagesWidget.class);
        appWidgetManager.updateAppWidget(cname, views);
    }
} 
```

小部件布局.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

<TextView android:id="@+id/msg"
    android:textIsSelectable="true"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

小部件信息.xml

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:minWidth="72dip"
    android:minHeight="72dip"
    android:updatePeriodMillis="5000" >

</appwidget-provider> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:48:02.523

您不能每 5 秒更新一次小部件（至少不是您这样做的方式） `android:updatePeriodMillis`限制为 30 分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:52:52.913

我今天遇到了类似的问题。它追求的是一种[黑魔法仪式](https://stackoverflow.com/questions/15665491/who-and-how-create-an-instance-of-appwidgetprovider)。

不知道它是什么以及下次出现问题时该怎么办。

# html - 使用图像精灵的水平导航菜单

> ID：15666012
> 
> 赞同：0
> 
> 时间：2013-03-27T17:57:48.603
> 
> 标签：html, css, menu, navigation

我已经建立了一个网站，但问题是我无法为其修复导航菜单。我有一个带有 6 个菜单项的图像精灵。但是将鼠标悬停在它上面时，我看不到下拉菜单。我尝试了很多不同的东西。我很沮丧，准备放弃整个网站。

这是代码

## HTML部分：

[http://www.codesend.com/view/3256019e6d25498ae6327284a187b1f6/](http://www.codesend.com/view/3256019e6d25498ae6327284a187b1f6/)

## CSS部分：

[http://www.codesend.com/view/77b1a413d602ef76dbe47ae2478c7ecf/](http://www.codesend.com/view/77b1a413d602ef76dbe47ae2478c7ecf/)

请帮忙 。无法弄清楚问题所在。万一没有任何效果。我想放弃精灵但创建相等的宽度和空间菜单。请帮助非常紧急和关键

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:08:24.203

请看这个例子，jsfiddle.net/qt9Uj/。我希望有简单的 html 和 css 可以帮助您解决问题。

# javascript - 提交表单时，萤火虫中的表单为空错误

> ID：15666022
> 
> 赞同：0
> 
> 时间：2013-03-27T17:58:08.913
> 
> 标签：javascript, jquery, ajax, form-submit

我正在使用 json 格式从数据库中获取值并将它们显示在表格中。我希望用户浏览数据并输入一个名为 city 的新字段。所以我在同一张表中添加了一个表格。问题是没有提交表单。

```
$('table').append('
    <tr><td>' + element.id + '</td><td>' + element.aid + '</td><td>' + element.aname +
    '</td></td>' + '</td><td>' + element.acountry +  '</td><td>' + element.trips +
    '</td><td>' + element.comments + '</td><td>' + element.likes + '</td>
    <td>

    <form action="storecity.php" method="POST">
        <input type="text" name="id" value="' + element.id + '" >
        <input type="text" name="city" value="">
        </td><td>
        <input type="submit" value="Submit" >
    </form>
    </td></tr>'); 
```

当我使用 form.submit() - 我在萤火虫中得到表单为空。我尝试使用 ajax 发布请求提交表单，但仍然无法正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:04:00.193

表单会自动将关闭表单标记提前填充到您放置它的位置。

这

```
<input type="submit" value="Submit"> 
```

没有包含在表单中，这是一个问题。您可以尝试使用跨越两个单元格并将整个表单包含在单个单元格中的 td`<td></td>`

# java - 如何避免多个 if null 语句

> ID：15666023
> 
> 赞同：2
> 
> 时间：2013-03-27T17:58:10.510
> 
> 标签：java, android

我正在尝试获取可能尚未初始化或尚未初始化的几个片段的 id

`int i = myFragment.getId();`, `int j = mySecondFragment.getId();`.

我的问题：是否有一种更清洁/更好的方法来获取每个**有效**片段的 ID，而不是

`if (myFragment != null) {int i = myFragment.getId();}`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:14:50.257

你可以使用[谷歌番石榴](https://code.google.com/p/guava-libraries/)。

当然你也可以实现类似的功能，但是 Guava 给出了一些令人惊叹的例子。

例如，假设一个参数可能为空，我们称它为`Optional`这个想法是，如果是，你会很快失败，只是不要接受空值。甚至，为它定义一个默认值。

```
public void method(Integer arg){
    Optional<Integer> possible = Optional.fromNullable(arg);
    Integer myNum = possible.get(); // Throws exception if arg is null
    Integer myNum2 = possible.or(0); // returns 0 if arg is null
} 
```

这个想法是你不要让空值通过你的应用程序的某个级别，理想的情况是它永远不会超过视图（或从数据库返回的持久层）。

如果这个想法一直贯彻到底。在业务层的核心，您不必担心空值。

你可以用番石榴做很多其他的事情，如果你决定听从我的建议，一定要充分利用它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:46:57.657

如果这是您经常做的事情，那么您可以创建一个为您进行检查的函数。所以而不是打字

```
if (myFragment != null) {int i = myFragment.getId();} 
```

一直以来你都可以做类似的事情

```
public ID getFragmentId(Fragment myFragment){
    if (myFragment != null) {
        return myFragment.getId();
    } else {
        return someDefaultValue;
    }
} 
```

然后打电话

```
i = getFragmentID(myFragment); 
```

避免大量重复输入，并使您的代码更清晰。

# layout - 我在哪里可以找到关于 Laravel 4 模板的好的信息/教程？

> ID：15666028
> 
> 赞同：0
> 
> 时间：2013-03-27T17:58:28.390
> 
> 标签：layout, laravel, templating, laravel-4, blade

我一直在寻找有关如何在 laravel 4 中构建漂亮布局的信息或教程，但我真的找不到太多。大多数人似乎只是说“它从 3 改变了很多”。太好了....有人可以发布信息或关于 L4 模板的教程吗？具体来说，很高兴知道如何创建统一的设计，或引入其他模板，而不必使用 Blade 引擎。

我在这里找到了有关更改的一些详细信息：[https ://github.com/jasonlewis/jasonlewis.me/blob/master/articles/laravel-4-illuminating-your-laravel-3-applications.md](https://github.com/jasonlewis/jasonlewis.me/blob/master/articles/laravel-4-illuminating-your-laravel-3-applications.md)

但是，作者提到“render_each()”之类的东西已被删除，但没有提及改用什么。

理想情况下，我想要一个单一的设计模板，它为设计的各个部分引入更小的子布局。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:51:41.837

您仍然可以使用 Blade 模板引擎执行此操作。此外，Laravel 4 的 Composer 集成的优点之一是你可以很容易地放入任何你想要的模板系统，比如[Twig](https://packagist.org/packages/twig/twig)。Blade 是内置的，定义模板和继承非常容易。

如 Laravel 4 [Blade 文档](http://four.laravel.com/docs/templates)中所述，您可以为整个控制器（或`BaseController`类中的所有控制器）指定模板

```
protected $layout = 'layouts_folder.master_layout_name'; 
```

然后在您的控制器方法中，您只需添加以下内容，它将从`$layout`您指定的继承（无需显式返回任何内容）：

```
$this->layout->content = View::make('layout_folder.layout_name'); 
```

您仍然可以`@yield('things')`定义 a`@section('like_a_sidebar')`并使用`@extends('layouts.another_layout')`.

# python - python 运算符何时是续行？

> ID：15666030
> 
> 赞同：8
> 
> 时间：2013-03-27T17:58:39.480
> 
> 标签：python, syntax

以下在语法上无效：

```
if extremely_long_condition_that_takes_up_a_whole_line and
  another_condition:
    #do something 
```

以下是有效的：

```
if (extremely_long_condition and
  another_condition):
    #do something 
```

为什么这些不同？更一般地说，为什么 #2 可以，但 #1 有点危险/模棱两可？我看不出第一个陈述是如何或概括为一个模棱两可的陈述。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T17:59:50.747

括号意味着行延续直到它们被关闭。

[PEP-8 谈到了这一点](http://www.python.org/dev/peps/pep-0008/#maximum-line-length)：

> 包装长行的首选方法是在括号、方括号和大括号内使用 Python 的隐含行继续。通过将表达式括在括号中，可以将长行分成多行。这些应该优先使用反斜杠来继续行。

[或者，在语言参考](http://docs.python.org/3/reference/lexical_analysis.html#explicit-line-joining)中更正式地讨论：

> 可以使用反斜杠字符 (\) 将两个或多个物理行连接成逻辑行
> 
> 括号、方括号或花括号中的表达式可以在多个物理行上拆分，而无需使用反斜杠。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-27T18:01:59.973

没有大括号，在存在一元运算符的情况下肯定是模棱两可的。

考虑这一行：

```
a = 3 + 4
+1 
```

在这里，您有一个简单的加法，然后是一元正运算符。

您可能会争辩说带有尾随运算符的行并不模棱两可（我目前想不出一个反例），所以我将求助于“特殊情况不足以打破规则”部分蟒蛇之禅。

* * *

另请注意，现在的方式是，您可以在*没有操作符的情况下*跨多行连接字符串：

```
a = ("Hello "
     "World") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:06:14.140

另一个有效的，丢失括号*（[PEP 8](http://www.python.org/dev/peps/pep-0008/)不推荐）*：

```
if extremely_long_condition_that_takes_up_a_whole_line and \
  another_condition:
    #do something 
```

从[PEP 8](http://www.python.org/dev/peps/pep-0008/)开始：

> 包装长行的首选方法是在括号、方括号和大括号内使用 Python 的隐含行继续。通过将表达式括在括号中，可以将长行分成多行。**这些应该优先使用反斜杠来继续行。**确保适当缩进续行。

我建议你阅读[PEP 8](http://www.python.org/dev/peps/pep-0008/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:00:21.257

所有括号都带有内置的行继续。我不确定`and`，但不鼓励继续行（`\`-style ）的原因是尾随空格会使命令无效，而且很难看到。但是，括号内的尾随空格永远不会破坏它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:16:46.390

当然，您可以使用函数使其更易于理解。

代替：

```
if (extremely_long_condition_that_takes_up_a_whole_line and
  another_condition):
    #do something 
```

你可以这样做：

```
def cond():
    extremely_long_condition_that_takes_up_a_whole_line

def another_condition():
     # whatever

if cond() and another_condition():
     #do something 
```

或者，如果你有一堆条件：

```
if all(conditions(x) for x in seq):
     #do something 
```

Python 的设计旨在鼓励将长行和块分解成更小的更易读的位。你遇到了这种鼓励。

我尝试将行数保持在 70 个字符以内。

对我来说最难的是限制嵌套理解的长度。我打破了这些，以便打破实际上有助于可读性。

# php - 重置时清除表的功能

> ID：15666031
> 
> 赞同：0
> 
> 时间：2013-03-27T17:58:50.567
> 
> 标签：php, jquery, ajax

团队，我创建了代码来使用用户输入打印 9X9 矩阵而不刷新页面。现在我想在不刷新页面的情况下重置（清除）该 9X9 矩阵的表或字段。

请帮帮我，告诉我一些关于 ajax 或其他代码的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:06:19.047

试试[jQuery 表单插件](http://www.malsup.com/jquery/form/)：

`$('#myFormId').resetForm();`

# php - 维护 PHP 文件的会话

> ID：15666032
> 
> 赞同：-2
> 
> 时间：2013-03-27T17:58:52.593
> 
> 标签：php, html, database, oracle

我以表格形式获取数据并验证它们并将它们放入数据库中的表中。现在的问题是我想维护用户的会话。意思是如果我给他addstudent文件的直接链接，那么他应该首先询问登录信息然后参考添加学生:)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:02:04.330

有很多方法可以做到这一点。一种更简单的方法是使用一个名为 Login 的会话变量。( `$_SESSION['login']`)

在您的登录处理页面上，当用户被验证并正确登录时，只需将此变量设置为 true。然后，在您要通过登录保护的任何页面的顶部，只需添加以下代码：

```
<?php
session_start();
if(!isset($_SESSION['login']))
{
header("Location: login.php");
}
?> 
```

登录过程示例：

```
<?php 
session_start(); 
if(ENTERED USERNAME CORRECT && ENTERED PASSWORD CORRECT) 
{
    $_SESSION['login'] = 1; 
}
?> 
```

它的作用是当您的系统验证登录时，它会设置会话变量。任何您想保护的页面，代码都会检查是否有经过验证的登录，然后允许您查看该页面，否则，它会将您重定向到登录页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:08:15.947

首先**开始会话**：

```
<?php
session_start(); 
?> 
```

检查**session**是`set`还是`unset`。

**如果设置了会话**：

```
 if(isset($_SESSION['username'])) 
  {
  /*Code for adding student*/
  } 
```

**如果未设置会话：**

询问**用户名**和**密码**。

将用户名和密码与数据库条目进行比较。

```
 if username and password matched
      {
       $_SESSION['username']=$username; //set the session variable
      /*Code for adding student*/
      }

     else
     {
        /*Re-enter username/password*/
     } 
```

# excel - 基于条件语句遵循两条不同路径的消息框

> ID：15666033
> 
> 赞同：0
> 
> 时间：2013-03-27T17:58:53.170
> 
> 标签：excel, vba

我有一种感觉，我又把事情复杂化了。下面的脚本是我正在尝试做的基础知识。我遇到的问题是msgboxes。

基本上，我需要一个用于条件 B 失败（并退出）的 msgbox 和一个用于成功完成循环的 msgbox。所以，他们每个人都需要遵循不同的条件，但我不知道该怎么做？

```
For i = 1 To Val(days)
If hasrun = False Then
    If condition A <> 0 Then do nothing
        ElseIf condition A = 0 Then
            Do this...
    End If
If condition B <> 0 Then
    Exit For
ElseIf condition B  = 0 Then
    Do that…
End If
 Do this other code...   
hasrun = True
Next i
    MsgBox "Script exited because condition B already existed"

    MsgBox "Script finished successfully."
End if 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:02:21.203

您可以只记录使用标志变量发现问题的事实：

```
Dim blnBFail As Boolean     
For i = 1 To Val(days)
If hasrun = False Then
    If condition A <> 0 Then do nothing
        ElseIf condition A = 0 Then
            Do this...
    End If
If condition B <> 0 Then
    blnBFail = True
    Exit For
ElseIf condition B  = 0 Then
    Do that…
End If
 Do this other code...   
hasrun = True
Next i

If blnBFail then
    MsgBox "Script exited because condition B already existed"
Else
    MsgBox "Script finished successfully."
EndIf
End if 
```

# wpf - prism wpf中的模块依赖关系

> ID：15666034
> 
> 赞同：2
> 
> 时间：2013-03-27T17:58:57.943
> 
> 标签：wpf, prism, unity-container, modularity

我正在尝试编写类似于“统一模块化”项目的代码。我构建了 2 个模块：模块 A（通过代码加载）和模块 D（从目录加载）。两者都成功加载。

但是当我尝试设置依赖时它不起作用。我真的无法弄清楚这个项目中提到的依赖关系。（我在 ModuleA 类中将依赖项设置为属性，在构建后复制 moduleD）这是我的实现：

引导程序.cs

```
protected override IModuleCatalog CreateModuleCatalog()
{
    return new AggregateModuleCatalog();
}

protected override void ConfigureModuleCatalog()
{
    base.ConfigureModuleCatalog();

    Type moduleAType = typeof(ModuleAModule);
    ModuleCatalog.AddModule(new ModuleInfo()
    {
        ModuleName = ModuleNames.ModuleA,
        ModuleType = moduleAType.AssemblyQualifiedName
    });    

    DirectoryModuleCatalog directoryCatalog = new DirectoryModuleCatalog() { ModulePath = @".\Modules" };
    ((AggregateModuleCatalog)ModuleCatalog).AddCatalog(directoryCatalog);
}

protected override void ConfigureContainer()
{
    base.ConfigureContainer();

    this.RegisterTypeIfMissing(typeof(IModuleTracker), typeof(ModuleTracker), true);
} 
```

模块A.cs

```
[Module(ModuleName = ModuleNames.ModuleA)]
[ModuleDependency(ModuleNames.ModuleD)]
public class ModuleAModule : IModule
{
    private ILoggerFacade _logger;
    private IModuleTracker _moduleTracker;

    public ModuleAModule(ILoggerFacade logger, IModuleTracker moduleTracker)
    {
        _logger = logger;
        _moduleTracker = moduleTracker;

        _moduleTracker.ModuleConstructed("ModuleA");
    }

    public void Initialize()
    {
        _logger.Log("ModuleA demonstrates logging during Initialize().", Category.Info, Priority.Medium);

        _moduleTracker.ModuleInitialized("ModuleA");
    }
} 
```

模块D.cs

```
[Module(ModuleName = ModuleNames.ModuleD)]
public class ModuleDModule : IModule
{
    private ILoggerFacade _logger;
    private IModuleTracker _moduleTracker;

    public ModuleDModule(ILoggerFacade logger, IModuleTracker moduleTracker)
    {
        _logger = logger;
        _moduleTracker = moduleTracker;

        _moduleTracker.ModuleConstructed("ModuleD");
    }

    public void Initialize()
    {
        _moduleTracker.ModuleInitialized("ModuleD");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T09:41:39.313

也许这与加载模块的顺序有关？据我所见，模块 A 在具有依赖关系的 ModuleD 之前被加载。不知道这是否对您有帮助，但这是我的第一个想法。您收到哪个错误消息？

# algorithm - 递归算法的目的是什么？

> ID：15666035
> 
> 赞同：-5
> 
> 时间：2013-03-27T17:59:00.577
> 
> 标签：algorithm, recursion

我在思考递归算法的真正目的是什么。我们都知道递归算法在某些方面是紧凑且易于理解的。然而，递归的最大缺点是递归算法在运行时需要*大量*的系统资源。这导致递归算法只能在非常“简单的数据”上运行的结果（我不确定我是否使用了正确的词）。

例如：虽然我编写了一个算法来使用递归算法计算某个矩阵的格路径数。该算法适用于较小的矩阵大小，但在处理大于 20 的矩阵大小时，计算机需要很长时间才能完成任务。所以我必须用正常的方法重写我的算法。

**谁能为我解释使用递归算法的目的？**因为它对系统资源的使用不是很有效，并且可以通过常规方法完全重写（我知道有时可能很难重写递归算法）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:04:54.323

其实在这种情况下，一个人的垃圾就是另一个人的宝物。但是作为备份，让我们考虑一下您关于“大量系统资源”的说法：忽略缓存和流水线的问题，递归算法“隐形”使用的资源是用于进行递归调用的系统堆栈空间：当前指令指针被推送在堆栈上以及递归函数的所有参数。加上递归过程的局部变量是在堆栈上创建的，尽管在任何函数中都是这种情况，但是局部变量占用的内存是递归深度的乘积。尽管如此，这并不一定意味着“巨大”。

递归方法的优点（除了你提到的那些）是......等待它......您可以将系统堆栈用作另一种数据结构。考虑一个探索二叉树的递归算法：通过传递**节点**递归函数的参数，您实际上是在维护一个数据结构（即堆栈），您需要以非递归方法显式维护它，不同之处在于在递归函数中您不必实际声明并明确维护您的堆栈。因此，唯一额外的“浪费”资源是堆栈帧中需要的任何其他内容，加上堆栈上指令指针的大小*递归深度。对于通过不必声明显式数据结构来存储节点指针而变得更简单的易于理解的算法，这是一个很小的代价。

请记住，对于许多递归函数，递归方法不涉及实际递归：如果递归调用是递归函数中的最后一次调用，并且递归调用的结果由调用函数本身返回，则[尾调用优化](http://en.wikipedia.org/wiki/Tail_call)（在许多编译器上可用）将生成非递归代码。

# nhibernate - NHibernate Override ISession 在测试期间伪造数据库

> ID：15666040
> 
> 赞同：1
> 
> 时间：2013-03-27T17:59:09.787
> 
> 标签：nhibernate, sessionfactory, isession

我正在做一个项目，该项目有超过 2000 个完整的数据库集成测试。我想加快这个过程，所以我想为什么不伪造数据库。

我们使用 Fluent NHibernate 作为我们的 ORM，这可能就是我遇到这种麻烦的原因。我们已经在一个不使用 NHibernate 而是使用基本 CRUD 操作的程序中实现了这个概念。

基本上在任何 CRUD 操作中，我都想将对象保存在内存中以表示字典列表。这将加快我们的测试过程，有望减少我们的构建时间。更不用说酷的因素了。

我已经研究过有两个单独的会话并让会话工厂使用一个或另一个，但我必须实现许多我真的不关心的方法/属性。

我还考虑在课堂上使用 go between 来进行自己的翻译，但它可能包括我更改大量现有代码。我试图尽可能地限制对项目其余部分的影响，因此回归测试不会是一个巨大的因素。

请让我知道任何人有任何其他建议！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T15:52:14.677

Use a SQLite in-memory database. Here's the blog post that originally showed me how...

[http://jasondentler.com/blog/2009/08/nhibernate-unit-testing-with-sqlite-in-memory-db/](http://jasondentler.com/blog/2009/08/nhibernate-unit-testing-with-sqlite-in-memory-db/)

# java - 构造函数和对象 - 面试

> ID：15666041
> 
> 赞同：-5
> 
> 时间：2013-03-27T17:59:07.563
> 
> 标签：java, c++

这是采访中提出的问题。在下面的代码片段中做什么`foo a`和表示什么。`foo a()`

```
class foo
    {
        foo a;
        foo a();
    } 
```

foo a 和 foo a() 会做什么？面试官没有提到这是java还是c++。他们希望我用 C++ 和 Java 给出答案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T18:01:01.117

在 C++ 中，第一行是错误（类不能包含自身的实例）。第二行声明了一个`foo`按值返回实例的方法。最后还有一个缺少的分号。

在 Java 中，第一行声明了一个数据成员，它是对`foo`. 第二行是一个错误，因为该方法必须有一个主体。

总之，这两种语言中的任何一种都不是有效的代码。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:12:51.077

从语法上讲，它在 Java 方面是不正确的。其他人已经解释过了。

然而，假设它是伪代码，我想基本的答案是这样的：

`foo a;`是一个名为`a`type的变量`foo`。

`foo a();`是一个名为`a`返回类型对象的方法`foo`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:14:28.333

```
foo a; 
```

声明一个对 .的引用的*字段* 。`a``foo`

```
foo a(); 
```

是 Java 中的错误。这是一个*方法*声明（没有主体的方法）。在 Java 中，这样的抽象方法必须用`abstract`关键字限定：

```
abstract foo a(); 
```

这声明了一个返回引用的*抽象*方法。每个包含抽象方法*声明*的类定义都必须使用关键字本身进行限定。在您的情况下，类声明应如下所示：`a``foo`*`abstract`*

 *```
abstract class foo { 
```

来自 Java 语言规范 - [**§8.1.1.1**](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.1.1.1)：

> 普通类可能有抽象方法，即已声明但尚未实现的方法，前提是它们是抽象类。如果非抽象的普通类包含抽象方法，则会发生编译时错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:00:27.183

它是一个返回类型 foo 的方法，因为类不是抽象的编译器会抛出错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:02:32.593

对于 Java

```
class foo
    {
        foo a;
        foo a();
    } 
```

第一行声明了对名为“a”的“foo”对象的引用。该值将为空。

第二行是一个错误。它试图声明一个名为“a”的方法，该方法返回一个“foo”，但该方法没有主体。需要将类和方法声明为抽象才能使其工作，或者必须为“a”方法提供一个主体。*

# hibernate - 休眠多对一/N+1 问题

> ID：15666042
> 
> 赞同：1
> 
> 时间：2013-03-27T17:59:15.460
> 
> 标签：hibernate

我有一个持久类，其中包含与我的用户表的 ManyToOne 关系，用于审计目的。事实上，我所有的类都有这些字段，甚至是 User 类。

```
public class MyClass implements Serializable {

@Fetch(value=FetchMode.SELECT)
@ManyToOne(optional=false, fetch=FetchType.LAZY)
@NotFound(action = NotFoundAction.IGNORE)
@JoinColumn(name = "CREATE_USER_ID")
public User getCreatedBy() {
    return createdBy;
}

@Fetch(value=FetchMode.SELECT)
@ManyToOne(optional=false)
@NotFound(action=NotFoundAction.IGNORE)
@JoinColumn(name="USER_ID")
public User getLastUpdatedBy() {
    return lastUpdatedBy;
}
} 
```

为了更好地做到这一点，一些栗色使大多数表中的审计字段为 CHAR(8)，但 T_USER 中的字段为 VARCHAR2(8)，这意味着无法在它们上创建外键。

Anyhoo，对 MyClass 的查询将启动查询以填充审计字段，然后依次启动查询以填充用户的审计字段。

我很少需要审计字段，所以我想让它们变得懒惰。不幸的是，我认为我在这里有很多不利于我的工作，其中最重要的是设计不佳的架构。

有谁可以帮我离开这里吗？

杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:21:17.797

似乎 @Fetch(value=FetchMode.SELECT) 注释和 @ManyToOne(optional=false, fetch=FetchType.LAZY) 会互相争斗，您是否尝试过删除 @Fetch(value=FetchMode.SELECT)为每个实体添加 fetch=FetchType.LAZY 到两个关联？

另一个原因可能是 @NotFound 注释与 optional=false 注释参数作斗争。一个说可以有一个 NULL 而另一个说不能。我相信在 *toOne 关联中可以有空值的情况下，除非关联不能为空，否则不能进行延迟加载。

# angularjs - AngularJS：服务vs提供者vs工厂

> ID：15666048
> 
> 赞同：3370
> 
> 时间：2013-03-27T17:59:46.853
> 
> 标签：angularjs, dependency-injection, angularjs-service, angularjs-factory, angularjs-provider

AngularJS 中的`Service`,`Provider`​​ 和有什么区别？`Factory`

* * *

## 回答 #1

> 赞同：2891
> 
> 时间：2013-03-27T17:59:46.853

从 AngularJS 邮件列表中，我得到了[一个很棒的线程](https://groups.google.com/forum/#!msg/angular/56sdORWEoqg/HuZsOsMvKv4J)，它解释了服务、工厂、提供者以及它们的注入用法。编译答案：

# 服务

语法：`module.service( 'serviceName', function );`
结果：将 serviceName 声明为可注入参数**时，将为您提供该函数的一个实例。换句话说** `new FunctionYouPassedToService()`。

# 工厂

语法：`module.factory( 'factoryName', function );`
结果：当将 factoryName 声明为可注入参数时，您将获得**通过调用传递给 module.factory 的函数引用返回的值**。

# 提供者

语法：`module.provider( 'providerName', function );`
结果：将 providerName 声明为可注入参数**时，将为您提供** `(new ProviderFunction()).$get()`. 构造函数在调用 $get 方法之前被实例化 -`ProviderFunction`是传递给 module.provider 的函数引用。

提供程序的优点是可以在模块配置阶段进行配置。

有关提供的代码，请参见[此处](http://jsbin.com/ohamub/1/edit)。

这是 Misko 的进一步解释：

```
provide.value('a', 123);

function Controller(a) {
  expect(a).toEqual(123);
} 
```

在这种情况下，注入器只是按原样返回值。但是如果你想计算这个值呢？然后使用工厂

```
provide.factory('b', function(a) {
  return a*2;
});

function Controller(b) {
  expect(b).toEqual(246);
} 
```

`factory`负责创造价值的功能也是如此。请注意，工厂函数可以请求其他依赖项。

但是如果你想要更多的面向对象并且有一个名为 Greeter 的类呢？

```
function Greeter(a) {
  this.greet = function() {
    return 'Hello ' + a;
  }
} 
```

然后实例化你必须写

```
provide.factory('greeter', function(a) {
  return new Greeter(a);
}); 
```

然后我们可以像这样在控制器中要求“问候”

```
function Controller(greeter) {
  expect(greeter instanceof Greeter).toBe(true);
  expect(greeter.greet()).toEqual('Hello 123');
} 
```

但这也太啰嗦了。写这个的更短的方法是`provider.service('greeter', Greeter);`

但是如果我们想`Greeter`在注入之前配置类呢？然后我们可以写

```
provide.provider('greeter2', function() {
  var salutation = 'Hello';
  this.setSalutation = function(s) {
    salutation = s;
  }

  function Greeter(a) {
    this.greet = function() {
      return salutation + ' ' + a;
    }
  }

  this.$get = function(a) {
    return new Greeter(a);
  };
}); 
```

然后我们可以这样做：

```
angular.module('abc', []).config(function(greeter2Provider) {
  greeter2Provider.setSalutation('Halo');
});

function Controller(greeter2) {
  expect(greeter2.greet()).toEqual('Halo 123');
} 
```

作为旁注，`service`、`factory`和`value`都来自提供者。

```
provider.service = function(name, Class) {
  provider.provide(name, function() {
    this.$get = function($injector) {
      return $injector.instantiate(Class);
    };
  });
}

provider.factory = function(name, factory) {
  provider.provide(name, function() {
    this.$get = function($injector) {
      return $injector.invoke(factory);
    };
  });
}

provider.value = function(name, value) {
  provider.factory(name, function() {
    return value;
  });
}; 
```

* * *

## 回答 #2

> 赞同：818
> 
> 时间：2013-07-30T10:20:42.027

## [JS 小提琴演示](http://jsfiddle.net/pkozlowski_opensource/PxdSP/14/)

## “Hello world”示例与`factory`/ `service`/ `provider`：

```
var myApp = angular.module('myApp', []);

//service style, probably the simplest one
myApp.service('helloWorldFromService', function() {
    this.sayHello = function() {
        return "Hello, World!";
    };
});

//factory style, more involved but more sophisticated
myApp.factory('helloWorldFromFactory', function() {
    return {
        sayHello: function() {
            return "Hello, World!";
        }
    };
});

//provider style, full blown, configurable version     
myApp.provider('helloWorld', function() {

    this.name = 'Default';

    this.$get = function() {
        var name = this.name;
        return {
            sayHello: function() {
                return "Hello, " + name + "!";
            }
        }
    };

    this.setName = function(name) {
        this.name = name;
    };
});

//hey, we can configure a provider!            
myApp.config(function(helloWorldProvider){
    helloWorldProvider.setName('World');
});

function MyCtrl($scope, helloWorld, helloWorldFromFactory, helloWorldFromService) {

    $scope.hellos = [
        helloWorld.sayHello(),
        helloWorldFromFactory.sayHello(),
        helloWorldFromService.sayHello()];
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
<body ng-app="myApp">
<div ng-controller="MyCtrl">
    {{hellos}}
</div>
</body>
```

* * *

## 回答 #3

> 赞同：656
> 
> 时间：2014-05-15T15:53:00.907

**TL;DR**

**1)**当您使用**工厂**时，您创建一个对象，向其添加属性，然后返回相同的对象。当您将此工厂传递给您的控制器时，对象上的这些属性现在将通过您的工厂在该控制器中可用。

```
app.controller(‘myFactoryCtrl’, function($scope, myFactory){
  $scope.artist = myFactory.getArtist();
});

app.factory(‘myFactory’, function(){
  var _artist = ‘Shakira’;
  var service = {};

  service.getArtist = function(){
    return _artist;
  }

  return service;
}); 
```

**2)**当您使用**Service**时，AngularJS 会在后台使用 'new' 关键字对其进行实例化。因此，您将向“this”添加属性，服务将返回“this”。当您将服务传递到您的控制器时，“this”上的那些属性现在将通过您的服务在该控制器上可用。

```
app.controller(‘myServiceCtrl’, function($scope, myService){
  $scope.artist = myService.getArtist();
});

app.service(‘myService’, function(){
  var _artist = ‘Nelly’;
  this.getArtist = function(){
    return _artist;
  }
}); 
```

**3)** **提供者**是您可以传递给 .config() 函数的唯一服务。如果您想在服务对象可用之前为其提供模块范围的配置，请使用提供程序。

```
app.controller(‘myProvider’, function($scope, myProvider){
  $scope.artist = myProvider.getArtist();
  $scope.data.thingFromConfig = myProvider.thingOnConfig;
});

app.provider(‘myProvider’, function(){
 //Only the next two lines are available in the app.config()
 this._artist = ‘’;
 this.thingFromConfig = ‘’;
  this.$get = function(){
    var that = this;
    return {
      getArtist: function(){
        return that._artist;
      },
      thingOnConfig: that.thingFromConfig
    }
  }
});

app.config(function(myProviderProvider){
  myProviderProvider.thingFromConfig = ‘This was set in config’;
}); 
```

**非 TL;DR**

**1) 工厂**
工厂是最流行的创建和配置服务的方式。没有什么比 TL;DR 所说的更多了。您只需创建一个对象，为其添加属性，然后返回相同的对象。然后，当您将工厂传递给您的控制器时，对象上的这些属性现在将通过您的工厂在该控制器中可用。下面是一个更广泛的示例。

```
app.factory(‘myFactory’, function(){
  var service = {};
  return service;
}); 
```

现在，当我们将“myFactory”传递给我们的控制器时，我们附加到“服务”的任何属性都将可供我们使用。

现在让我们在回调函数中添加一些“私有”变量。这些将无法从控制器直接访问，但我们最终会在“服务”上设置一些 getter/setter 方法，以便能够在需要时更改这些“私有”变量。

```
app.factory(‘myFactory’, function($http, $q){
  var service = {};
  var baseUrl = ‘https://itunes.apple.com/search?term=’;
  var _artist = ‘’;
  var _finalUrl = ‘’;

  var makeUrl = function(){
   _artist = _artist.split(‘ ‘).join(‘+’);
    _finalUrl = baseUrl + _artist + ‘&amp;callback=JSON_CALLBACK’;
    return _finalUrl
  }

  return service;
}); 
```

在这里，您会注意到我们没有将这些变量/函数附加到“服务”。我们只是创建它们以便以后使用或修改它们。

*   baseUrl 是 iTunes API 需要的基本 URL
*   _artist 是我们要查找的艺术家
*   _finalUrl 是我们将调用 iTunes 的最终且完全构建的 URL
*   makeUrl 是一个函数，它将创建并返回我们的 iTunes 友好 URL。

现在我们的辅助/私有变量和函数已经到位，让我们为“服务”对象添加一些属性。我们在“服务”上放置的任何内容都可以直接在我们将“myFactory”传入的任何控制器中使用。

我们将创建简单地返回或设置艺术家的 setArtist 和 getArtist 方法。我们还将创建一个方法，该方法将使用我们创建的 URL 调用 iTunes API。此方法将返回一个承诺，一旦数据从 iTunes API 返回，该承诺将履行。如果您没有太多在 AngularJS 中使用 Promise 的经验，我强烈建议您深入了解它们。

下面的**setArtist**接受一个艺术家并允许您设置艺术家。**getArtist**返回艺术家。**callItunes**首先调用 makeUrl() 以构建我们将在 $http 请求中使用的 URL。然后它设置一个promise对象，用我们的最终url发出一个$http请求，然后因为$http返回一个promise，我们可以在请求之后调用.success或.error。然后我们用 iTunes 数据解决我们的承诺，或者我们拒绝它并显示一条消息说“有一个错误”。

```
app.factory('myFactory', function($http, $q){
  var service = {};
  var baseUrl = 'https://itunes.apple.com/search?term=';
  var _artist = '';
  var _finalUrl = '';

  var makeUrl = function(){
    _artist = _artist.split(' ').join('+');
    _finalUrl = baseUrl + _artist + '&callback=JSON_CALLBACK'
    return _finalUrl;
  }

  service.setArtist = function(artist){
    _artist = artist;
  }

  service.getArtist = function(){
    return _artist;
  }

  service.callItunes = function(){
    makeUrl();
    var deferred = $q.defer();
    $http({
      method: 'JSONP',
      url: _finalUrl
    }).success(function(data){
      deferred.resolve(data);
    }).error(function(){
      deferred.reject('There was an error')
    })
    return deferred.promise;
  }

  return service;
}); 
```

现在我们的工厂已经完工。我们现在可以将“myFactory”注入任何控制器，然后我们就可以调用我们附加到服务对象的方法（setArtist、getArtist 和 callItunes）。

```
app.controller('myFactoryCtrl', function($scope, myFactory){
  $scope.data = {};
  $scope.updateArtist = function(){
    myFactory.setArtist($scope.data.artist);
  };

  $scope.submitArtist = function(){
    myFactory.callItunes()
      .then(function(data){
        $scope.data.artistData = data;
      }, function(data){
        alert(data);
      })
  }
}); 
```

在上面的控制器中，我们注入了“myFactory”服务。然后，我们使用来自“myFactory”的数据在我们的 $scope 对象上设置属性。上面唯一棘手的代码是如果您以前从未处理过承诺。因为 callItunes 返回了一个承诺，所以我们可以使用 .then() 方法，并且只有在我们的承诺通过 iTunes 数据实现时才设置 $scope.data.artistData。你会注意到我们的控制器非常“瘦”（这是一个很好的编码实践）。我们所有的逻辑和持久数据都位于我们的服务中，而不是我们的控制器中。

**2) 服务**
在处理创建服务时，最重要的事情可能是它是用“new”关键字实例化的。对于您的 JavaScript 专家，这应该会给您一个关于代码性质的重要提示。对于那些 JavaScript 背景有限或不太熟悉“new”关键字实际作用的人，让我们回顾一些 JavaScript 基础知识，这些基础知识最终将帮助我们理解服务的本质。

要真正看到使用“new”关键字调用函数时发生的变化，让我们创建一个函数并使用“new”关键字调用它，然后让我们展示解释器在看到“new”关键字时会做什么。最终结果将是相同的。

首先让我们创建我们的构造函数。

```
var Person = function(name, age){
  this.name = name;
  this.age = age;
} 
```

这是一个典型的 JavaScript 构造函数。现在，每当我们使用“new”关键字调用 Person 函数时，“this”都会绑定到新创建的对象。

现在让我们在 Person 的原型上添加一个方法，这样它就可以在我们的 Person“类”的每个实例上使用。

```
Person.prototype.sayName = function(){
  alert(‘My name is ‘ + this.name);
} 
```

现在，因为我们将 sayName 函数放在原型上，所以 Person 的每个实例都可以调用 sayName 函数以提醒该实例的名称。

现在我们的原型上已经有了 Person 构造函数和 sayName 函数，让我们实际创建一个 Person 实例然后调用 sayName 函数。

```
var tyler = new Person(‘Tyler’, 23);
tyler.sayName(); //alerts ‘My name is Tyler’ 
```

因此，所有用于创建 Person 构造函数、向其原型添加函数、创建 Person 实例，然后在其原型上调用函数的代码看起来像这样。

```
var Person = function(name, age){
  this.name = name;
  this.age = age;
}
Person.prototype.sayName = function(){
  alert(‘My name is ‘ + this.name);
}
var tyler = new Person(‘Tyler’, 23);
tyler.sayName(); //alerts ‘My name is Tyler’ 
```

现在让我们看看在 JavaScript 中使用“new”关键字时实际发生了什么。您应该注意到的第一件事是，在我们的示例中使用 'new' 之后，我们可以在 'tyler' 上调用方法（sayName），就好像它是一个对象一样——因为它是。所以首先，我们知道我们的 Person 构造函数正在返回一个对象，无论我们是否可以在代码中看到它。其次，我们知道因为我们的 sayName 函数位于原型上而不是直接位于 Person 实例上，所以 Person 函数返回的对象必须在查找失败时委托给它的原型。更简单地说，当我们调用 tyler.sayName() 时，解释器会说“好的，我要查看我们刚刚创建的 'tyler' 对象，找到 sayName 函数，然后调用它。等一下，我在这里看不到——我看到的只是名字和年龄，让我检查一下原型。是的，看起来它在原型上，让我称之为。”。

下面是如何思考“new”关键字在 JavaScript 中实际作用的代码。它基本上是上一段的代码示例。我已经放置了“解释器视图”或解释器在注释中查看代码的方式。

```
var Person = function(name, age){
  //The below line creates an object(obj) that will delegate to the person’s prototype on failed lookups.
  //var obj = Object.create(Person.prototype);

  //The line directly below this sets ‘this’ to the newly created object
  //this = obj;

  this.name = name;
  this.age = age;

  //return this;
} 
```

现在了解了 'new' 关键字在 JavaScript 中的真正作用，在 AngularJS 中创建服务应该更容易理解。

创建服务时要了解的最重要的事情是知道服务是使用“新”关键字实例化的。将这些知识与我们上面的示例相结合，您现在应该认识到您将直接将属性和方法附加到“this”，然后将从服务本身返回。让我们来看看这个实际操作。

与我们最初对 Factory 示例所做的不同，我们不需要创建一个对象然后返回该对象，因为就像之前多次提到的那样，我们使用了 'new' 关键字，因此解释器将创建该对象，让它委托给它是原型，然后将其返回给我们，而无需我们进行工作。

首先，让我们创建我们的“私有”和辅助函数。这看起来应该很熟悉，因为我们对我们的工厂做了完全相同的事情。我不会在这里解释每一行的作用，因为我在工厂示例中做过，如果您感到困惑，请重新阅读工厂示例。

```
app.service('myService', function($http, $q){
  var baseUrl = 'https://itunes.apple.com/search?term=';
  var _artist = '';
  var _finalUrl = '';

  var makeUrl = function(){
    _artist = _artist.split(' ').join('+');
    _finalUrl = baseUrl + _artist + '&callback=JSON_CALLBACK'
    return _finalUrl;
  }
}); 
```

现在，我们将把控制器中可用的所有方法附加到“this”。

```
app.service('myService', function($http, $q){
  var baseUrl = 'https://itunes.apple.com/search?term=';
  var _artist = '';
  var _finalUrl = '';

  var makeUrl = function(){
    _artist = _artist.split(' ').join('+');
    _finalUrl = baseUrl + _artist + '&callback=JSON_CALLBACK'
    return _finalUrl;
  }

  this.setArtist = function(artist){
    _artist = artist;
  }

  this.getArtist = function(){
    return _artist;
  }

  this.callItunes = function(){
    makeUrl();
    var deferred = $q.defer();
    $http({
      method: 'JSONP',
      url: _finalUrl
    }).success(function(data){
      deferred.resolve(data);
    }).error(function(){
      deferred.reject('There was an error')
    })
    return deferred.promise;
  }

}); 
```

现在就像在我们的工厂中一样，setArtist、getArtist 和 callItunes 将在我们将 myService 传递到的任何控制器中可用。这是 myService 控制器（与我们的工厂控制器几乎完全相同）。

```
app.controller('myServiceCtrl', function($scope, myService){
  $scope.data = {};
  $scope.updateArtist = function(){
    myService.setArtist($scope.data.artist);
  };

  $scope.submitArtist = function(){
    myService.callItunes()
      .then(function(data){
        $scope.data.artistData = data;
      }, function(data){
        alert(data);
      })
  }
}); 
```

就像我之前提到的，一旦你真正理解了“new”的作用，Services 几乎与 AngularJS 中的工厂相同。

**3) 提供者**

关于 Providers 最重要的一点是，它们是您可以传递到应用程序的 app.config 部分的唯一服务。如果您需要在应用程序中的其他任何地方都可用之前更改服务对象的某些部分，那么这一点非常重要。尽管与服务/工厂非常相似，但我们将讨论一些差异。

首先，我们以与 Service 和 Factory 类似的方式设置 Provider。下面的变量是我们的“私有”和辅助函数。

```
app.provider('myProvider', function(){
   var baseUrl = 'https://itunes.apple.com/search?term=';
  var _artist = '';
  var _finalUrl = '';

  //Going to set this property on the config function below.
  this.thingFromConfig = ‘’;

  var makeUrl = function(){
    _artist = _artist.split(' ').join('+');
    _finalUrl = baseUrl + _artist + '&callback=JSON_CALLBACK'
    return _finalUrl;
  }
} 
```

*再次，如果上述代码的任何部分令人困惑，请查看工厂部分，我会在其中详细解释它的作用。

您可以将 Providers 视为具有三个部分。第一部分是稍后将修改/设置的“私有”变量/函数（如上所示）。第二部分是将在您的 app.config 函数中可用的变量/函数，因此可以在它们在其他任何地方可用之前进行更改（也如上所示）。重要的是要注意这些变量需要附加到“this”关键字。在我们的示例中，只有“thingFromConfig”可以在 app.config 中进行更改。第三部分（如下所示）是当您将“myProvider”服务传递到特定控制器时控制器中可用的所有变量/函数。

使用 Provider 创建服务时，控制器中唯一可用的属性/方法是那些从 $get() 函数返回的属性/方法。下面的代码将 $get 放在“this”上（我们知道最终会从该函数返回）。现在，该 $get 函数返回我们希望在控制器中可用的所有方法/属性。这是一个代码示例。

```
this.$get = function($http, $q){
    return {
      callItunes: function(){
        makeUrl();
        var deferred = $q.defer();
        $http({
          method: 'JSONP',
          url: _finalUrl
        }).success(function(data){
          deferred.resolve(data);
        }).error(function(){
          deferred.reject('There was an error')
        })
        return deferred.promise;
      },
      setArtist: function(artist){
        _artist = artist;
      },
      getArtist: function(){
        return _artist;
      },
      thingOnConfig: this.thingFromConfig
    }
  } 
```

现在完整的 Provider 代码如下所示

```
app.provider('myProvider', function(){
  var baseUrl = 'https://itunes.apple.com/search?term=';
  var _artist = '';
  var _finalUrl = '';

  //Going to set this property on the config function below
  this.thingFromConfig = '';

  var makeUrl = function(){
    _artist = _artist.split(' ').join('+');
    _finalUrl = baseUrl + _artist + '&callback=JSON_CALLBACK'
    return _finalUrl;
  }

  this.$get = function($http, $q){
    return {
      callItunes: function(){
        makeUrl();
        var deferred = $q.defer();
        $http({
          method: 'JSONP',
          url: _finalUrl
        }).success(function(data){
          deferred.resolve(data);
        }).error(function(){
          deferred.reject('There was an error')
        })
        return deferred.promise;
      },
      setArtist: function(artist){
        _artist = artist;
      },
      getArtist: function(){
        return _artist;
      },
      thingOnConfig: this.thingFromConfig
    }
  }
}); 
```

现在就像在我们的工厂和服务中一样，setArtist、getArtist 和 callItunes 将在我们将 myProvider 传递到的任何控制器中可用。这是 myProvider 控制器（与我们的工厂/服务控制器几乎完全相同）。

```
app.controller('myProviderCtrl', function($scope, myProvider){
  $scope.data = {};
  $scope.updateArtist = function(){
    myProvider.setArtist($scope.data.artist);
  };

  $scope.submitArtist = function(){
    myProvider.callItunes()
      .then(function(data){
        $scope.data.artistData = data;
      }, function(data){
        alert(data);
      })
  }

  $scope.data.thingFromConfig = myProvider.thingOnConfig;
}); 
```

如前所述，使用 Provider 创建服务的重点是能够在最终对象传递给应用程序的其余部分之前通过 app.config 函数更改一些变量。让我们看一个例子。

```
app.config(function(myProviderProvider){
  //Providers are the only service you can pass into app.config
  myProviderProvider.thingFromConfig = 'This sentence was set in app.config. Providers are the only service that can be passed into config. Check out the code to see how it works';
}); 
```

现在你可以看到 'thingFromConfig' 在我们的提供程序中是如何作为空字符串的，但是当它出现在 DOM 中时，它将是 'This sentence was set...'。

* * *

## 回答 #4

> 赞同：513
> 
> 时间：2013-12-24T13:15:49.647

所有服务都是**单例**；它们在每个应用程序中被实例化一次。它们可以是**任何类型**，无论是原始类型、对象字面量、函数，甚至是自定义类型的实例。

、`value`、`factory`、`service`和方法都是提供者`constant`。`provider`他们教注入器如何实例化服务。

> 最冗长但也是最全面的一个是 Provider 配方。其余**四种**配方类型——值、工厂、服务和常量——**只是提供者配方之上的语法糖**。

*   **Value Recipe**是最简单的情况，您自己实例化 Service 并将**实例化的值**提供给注入器。
*   **Factory recipe**为 Injector 提供了一个工厂函数，它在需要实例化服务时调用该函数。调用时，**工厂函数**创建并返回服务实例。服务的依赖项作为函数的参数注入。所以使用这个配方增加了以下能力：
    *   能够使用其他服务（有依赖关系）
    *   服务初始化
    *   延迟/延迟初始化
*   **Service recipe**与Factory recipe 几乎相同，但这里 Injector使用 new 运算符而不是工厂函数调用**构造函数。**
*   **Provider 配方**通常是**矫枉过正**的。它允许您配置工厂的创建，从而增加了一层间接性。

    > 仅当您希望为应用程序范围的配置公开 API 时才应使用 Provider 配方，该 API 必须在应用程序启动之前进行。这通常只对可重用服务感兴趣，这些服务的行为可能需要在应用程序之间略有不同。

*   **Constant 配方**就像 Value 配方一样，只是它允许您定义在配置阶段可用的**服务**。比使用价值配方创建的服务更快。与 Values 不同，它们不能使用`decorator`.

请参阅[提供程序文档](http://docs.angularjs.org/guide/providers)。

* * *

## 回答 #5

> 赞同：224
> 
> 时间：2015-02-01T12:58:09.617

**了解 AngularJS 工厂、服务和提供者**

所有这些都用于共享可重用的单例对象。它有助于在您的应用程序/各种组件/模块之间共享可重用的代码。

> 从文档[**服务/工厂**](https://docs.angularjs.org/guide/services)：
> 
> *   **惰性实例化——Angular**仅在应用程序组件依赖于它时实例化服务/工厂。
> *   **单例**——依赖于服务的每个组件都获得对服务工厂生成的单个实例的引用。

## 工厂

工厂是一个函数，您可以在其中在创建对象之前操作/添加逻辑，然后返回新创建的对象。

```
app.factory('MyFactory', function() {
    var serviceObj = {};
    //creating an object with methods/functions or variables
    serviceObj.myFunction = function() {
        //TO DO:
    };
    //return that object
    return serviceObj;
}); 
```

**用法**

它可以只是一个类的函数集合。因此，当您将它注入到您的控制器/工厂/指令函数中时，它可以在不同的控制器中实例化。每个应用程序仅实例化一次。

## 服务

只需在查看服务时考虑数组原型。服务是使用“new”关键字实例化新对象的函数。您可以使用`this`关键字向服务对象添加属性和功能。与工厂不同，它不返回任何东西（它返回一个包含方法/属性的对象）。

```
app.service('MyService', function() {
    //directly binding events to this context
    this.myServiceFunction = function() {
        //TO DO:
    };
}); 
```

**用法**

当您需要在整个应用程序中共享单个对象时使用它。例如，经过身份验证的用户详细信息、可共享的方法/数据、实用程序功能等。

## 提供者

提供者用于创建可配置的服务对象。您可以从配置功能配置服务设置。它使用`$get()`函数返回一个值。该`$get`函数在运行阶段以角度执行。

```
app.provider('configurableService', function() {
    var name = '';
    //this method can be be available at configuration time inside app.config.
    this.setName = function(newName) {
        name = newName;
    };
    this.$get = function() {
        var getName = function() {
             return name;
        };
        return {
            getName: getName //exposed object to where it gets injected.
        };
    };
}); 
```

**用法**

当您需要在使服务对象可用之前为其提供模块式配置时，例如。假设您想根据您的环境设置您的 API URL，例如`dev`，`stage`或`prod`

> **笔记**
> 
> 只有提供者将在 Angular 的配置阶段可用，而服务和工厂则不可用。

希望这已经澄清了您对**Factory、Service 和 Provider**的理解。

* * *

## 回答 #6

> 赞同：190
> 
> 时间：2014-11-14T06:25:16.053

对我来说，当我意识到它们都以相同的方式工作时，我得到了启示：运行**一次**，存储它们获得的值，然后在通过[依赖注入引用时咳出](http://en.wikipedia.org/wiki/Dependency_injection)**相同的存储值**。

假设我们有：

```
app.factory('a', fn);
app.service('b', fn);
app.provider('c', fn); 
```

三者的区别在于：

1.  `a`的储值来自于跑步`fn`。
2.  `b`的储值来自`new`ing `fn`。
3.  `c`的存储值来自首先通过`new`ing获取一个实例`fn`，然后运行`$get`该实例的一个方法。

这意味着在 AngularJS 中有类似缓存对象的东西，每次注入的值只分配一次，当它们第一次被注入时，以及在哪里：

```
cache.a = fn()
cache.b = new fn()
cache.c = (new fn()).$get() 
```

这就是我们`this`在服务中使用并在提供者中定义 a的原因`this.$get`。

* * *

## 回答 #7

> 赞同：137
> 
> 时间：2014-07-22T11:39:14.920

**服务 vs 供应商 vs 工厂：**

我试图保持简单。这都是关于基本 JavaScript 概念的。

首先，让我们谈谈AngularJS中的**服务！**

**什么是服务：** 在 AngularJS 中，**服务**只不过是一个可以存储一些有用方法或属性的单例 JavaScript 对象。这个单例对象是基于 ngApp（Angular 应用程序）创建的，它在当前应用程序中的所有控制器之间共享。当 Angularjs 实例化一个服务对象时，它会为这个服务对象注册一个唯一的服务名称。所以每次我们需要服务实例时，Angular 都会在注册表中搜索这个服务名称，并返回对服务对象的引用。这样我们就可以在服务对象上调用方法、访问属性等。您可能会质疑是否也可以将属性、方法放在控制器的作用域对象上！那么为什么需要服务对象呢？答案是：服务在多个控制器范围之间共享。如果您将一些属性/方法放在控制器的作用域对象中，它将仅对当前作用域可用。

因此，如果存在三个控制器范围，分别是控制器 A、控制器 B 和控制器 C，它们都将共享同一个服务实例。

```
<div ng-controller='controllerA'>
    <!-- controllerA scope -->
</div>
<div ng-controller='controllerB'>
    <!-- controllerB scope -->
</div>
<div ng-controller='controllerC'>
    <!-- controllerC scope -->
</div> 
```

**如何创建服务？**

AngularJS 提供了不同的方法来注册服务。这里我们将重点介绍三个方法 factory(..),service(..),provider(..);

[使用此链接获取代码参考](http://jsbin.com/vaken/16/edit?html,js,output)

## **工厂功能：**

我们可以定义一个工厂函数如下。

```
factory('serviceName',function fnFactory(){ return serviceInstance;}) 
```

AngularJS 提供了**'factory('serviceName', fnFactory)'**方法，它接受两个参数，serviceName 和一个 JavaScript 函数。Angular 通过调用**fnFactory()**函数来创建服务实例，如下所示。

```
var serviceInstace = fnFactory(); 
```

传递的函数可以定义一个对象并返回该对象。AngularJS 只是将此对象引用存储到作为第一个参数传递的变量中。从 fnFactory 返回的任何内容都将绑定到 serviceInstance 。除了返回对象，我们还可以返回函数、值等，无论我们返回什么，都将可用于服务实例。

例子：

```
var app= angular.module('myApp', []);
//creating service using factory method
app.factory('factoryPattern',function(){
  var data={
    'firstName':'Tom',
    'lastName':' Cruise',
    greet: function(){
      console.log('hello!' + this.firstName + this.lastName);
    }
  };

  //Now all the properties and methods of data object will be available in our service object
  return data;
}); 
```

## 服务功能：

```
service('serviceName',function fnServiceConstructor(){}) 
```

这是另一种方式，我们可以注册一个服务。唯一的区别是 AngularJS 尝试实例化服务对象的方式。这次 Angular 使用“new”关键字并调用构造函数，如下所示。

```
var serviceInstance = new fnServiceConstructor(); 
```

在构造函数中，我们可以使用“this”关键字向服务对象添加属性/方法。例子：

```
//Creating a service using the service method
var app= angular.module('myApp', []);
app.service('servicePattern',function(){
  this.firstName ='James';
  this.lastName =' Bond';
  this.greet = function(){
    console.log('My Name is '+ this.firstName + this.lastName);
  };
}); 
```

## **提供者功能：**

Provider() 函数是另一种创建服务的方法。让我们有兴趣创建一个只向用户显示一些问候消息的服务。但是我们还想提供一个功能，让用户可以设置自己的问候消息。用技术术语来说，我们想要创建可配置的服务。我们应该怎么做 ？必须有一种方法，以便应用程序可以传递他们的自定义问候消息，并且 Angularjs 将使其可用于创建我们的服务实例的工厂/构造函数。在这种情况下，provider() 函数可以完成这项工作。使用 provider() 函数，我们可以创建可配置的服务。

我们可以使用提供者语法创建可配置服务，如下所示。

```
/*step1:define a service */
app.provider('service',function serviceProviderConstructor(){});

/*step2:configure the service */
app.config(function configureService(serviceProvider){}); 
```

## **提供程序语法在内部如何工作？**

1.Provider对象是使用我们在provider函数中定义的构造函数创建的。

```
var serviceProvider = new serviceProviderConstructor(); 
```

2.我们传入app.config()的函数，被执行。这称为配置阶段，在这里我们有机会自定义我们的服务。

```
configureService(serviceProvider); 
```

3.最后调用serviceProvider的$get方法创建服务实例。

```
serviceInstance = serviceProvider.$get() 
```

## 使用提供语法创建服务的示例代码：

```
var app= angular.module('myApp', []);
app.provider('providerPattern',function providerConstructor(){
  //this function works as constructor function for provider
  this.firstName = 'Arnold ';
  this.lastName = ' Schwarzenegger' ;
  this.greetMessage = ' Welcome, This is default Greeting Message' ;
  //adding some method which we can call in app.config() function
  this.setGreetMsg = function(msg){
    if(msg){
      this.greetMessage =  msg ;
    }
  };

  //We can also add a method which can change firstName and lastName
  this.$get = function(){
    var firstName = this.firstName;
    var lastName = this.lastName ;
    var greetMessage = this.greetMessage;
    var data={
       greet: function(){
         console.log('hello, ' + firstName + lastName+'! '+ greetMessage);
       }
    };
    return data ;
  };
});

app.config(
  function(providerPatternProvider){
    providerPatternProvider.setGreetMsg(' How do you do ?');
  }
); 
```

[工作演示](http://jsbin.com/senufu/6/edit?html,js,output)

**概括：**

* * *

**工厂**使用返回服务实例的工厂函数。 **服务实例 = fnFactory();**

**服务**使用构造函数，Angular 使用“new”关键字调用此构造函数来创建服务实例。 **serviceInstance = new fnServiceConstructor();**

**Provider**定义了一个 providerConstructor 函数，这个 providerConstructor 函数定义了一个工厂函数**$get**。Angular 调用 $get() 来创建服务对象。提供程序语法具有在实例化之前配置服务对象的额外优势。 **服务实例 = $get();**

* * *

## 回答 #8

> 赞同：88
> 
> 时间：2015-11-19T13:36:14.010

正如这里的几个人正确指出的那样，工厂、提供者、服务，甚至价值和常数都是同一事物的版本。您可以将更一般的内容`provider`分解为所有内容。像这样：

[![在此处输入图像描述](../Images/45efa66223a7f0092054ad6ad87c629d.png)](http://www.simplygoodcode.com/2015/11/the-difference-between-service-provider-and-factory-in-angularjs/)

这是这张图片来自的文章：

[http://www.simplygoodcode.com/2015/11/the-difference-between-service-provider-and-factory-in-angularjs/](http://www.simplygoodcode.com/2015/11/the-difference-between-service-provider-and-factory-in-angularjs/)

* * *

## 回答 #9

> 赞同：64
> 
> 时间：2014-08-02T05:37:39.273

### 工厂

你给 AngularJS 一个函数，AngularJS 会在工厂被请求时缓存并注入返回值。

例子：

```
app.factory('factory', function() {
    var name = '';
    // Return value **is** the object that will be injected
    return {
        name: name;
    }
}) 
```

用法：

```
app.controller('ctrl', function($scope, factory) {
     $scope.name = factory.name;
}); 
```

### 服务

你给 AngularJS 一个函数，AngularJS 会调用***new***来实例化它。当请求服务时，AngularJS 创建的实例将被缓存和注入。由于***new***用于实例化服务，因此关键字***this***有效并引用实例。

例子：

```
app.service('service', function() {
     var name = '';
     this.setName = function(newName) {
         name = newName;
     }
     this.getName = function() {
         return name;
     }
}); 
```

用法：

```
app.controller('ctrl', function($scope, service) {
   $scope.name = service.getName();
}); 
```

### 提供者

你给 AngularJS 一个函数，AngularJS 会调用它的`$get`函数。它是`$get`函数的返回值，在请求服务时将被缓存和注入。

Providers 允许你在AngularJS 调用方法来获取注入***之前配置提供程序。***`$get`

例子：

```
app.provider('provider', function() {
     var name = '';
     this.setName = function(newName) {
          name = newName;
     }
     this.$get = function() {
         return {
            name: name
         }
     }
}) 
```

用法（作为控制器中的注射剂）

```
app.controller('ctrl', function($scope, provider) {
    $scope.name = provider.name;
}); 
```

用法（在`$get`调用之前配置提供程序以创建可注入）

```
app.config(function(providerProvider) {
    providerProvider.setName('John');
}); 
```

* * *

## 回答 #10

> 赞同：57
> 
> 时间：2013-05-19T19:53:03.497

在与提供者玩耍时，我注意到了一些有趣的事情。

对于供应商而言，注射剂的可见性与对于服务和工厂的可见性不同。如果你声明一个 AngularJS“常量”（例如，`myApp.constant('a', 'Robert');`），你可以将它注入到服务、工厂和提供者中。

但是如果你声明一个 AngularJS 的“值”（例如，`myApp.value('b', {name: 'Jones'});`），你可以将它注入到服务和工厂中，但不能注入到提供者创建函数中。但是，您可以将其注入`$get`您为提供者定义的函数中。这在 AngularJS 文档中有所提及，但很容易忽略。您可以在 %provide 页面上的值和常量方法部分找到它。

[http://jsfiddle.net/R2Frv/1/](http://jsfiddle.net/R2Frv/1/)

```
<div ng-app="MyAppName">
    <div ng-controller="MyCtrl">
        <p>from Service: {{servGreet}}</p>
        <p>from Provider: {{provGreet}}</p>
    </div>
</div>
<script>
    var myApp = angular.module('MyAppName', []);

    myApp.constant('a', 'Robert');
    myApp.value('b', {name: 'Jones'});

    myApp.service('greetService', function(a,b) {
        this.greeter = 'Hi there, ' + a + ' ' + b.name;
    });

    myApp.provider('greetProvider', function(a) {
        this.firstName = a;
        this.$get = function(b) {
            this.lastName = b.name;
            this.fullName = this.firstName + ' ' + this.lastName;
            return this;
        };
    });

    function MyCtrl($scope, greetService, greetProvider) {
        $scope.servGreet = greetService.greeter;
        $scope.provGreet = greetProvider.fullName;
    }
</script> 
```

* * *

## 回答 #11

> 赞同：46
> 
> 时间：2015-10-09T03:43:21.683

这对新手来说是非常令人困惑的部分，我试图用简单的话来澄清它

**AngularJS Service：**用于与控制器中的服务引用共享实用程序功能。服务本质上是单例的，因此对于一项服务，仅在浏览器中创建一个实例，并且在整个页面中使用相同的引用。

在服务中，我们使用*该*对象创建函数名称作为属性。

**AngularJS Factory：Factory**的目的也与 Service 相同，但是在这种情况下，我们创建一个新对象并添加函数作为该对象的属性，最后我们返回该对象。

**AngularJS Provider：**这个目的还是一样的，但是 Provider 给出了它的 $get 函数的输出。

定义和使用服务、工厂和提供者在[http://www.dotnetfunda.com/articles/show/3156/difference-between-angularjs-service-factory-and-provider进行了解释](http://www.dotnetfunda.com/articles/show/3156/difference-between-angularjs-service-factory-and-provider)

* * *

## 回答 #12

> 赞同：35
> 
> 时间：2014-04-30T11:20:20.343

对我来说，理解差异的最好和最简单的方法是：

```
var service, factory;
service = factory = function(injection) {} 
```

AngularJS 如何实例化特定组件（简化）：

```
// service
var angularService = new service(injection);

// factory
var angularFactory = factory(injection); 
```

所以，对于服务来说，成为AngularJS组件的是服务声明函数所代表的类的对象实例。对于工厂来说，就是工厂声明函数返回的结果。工厂的行为可能与服务相同：

```
var factoryAsService = function(injection) {
  return new function(injection) {
    // Service content
  }
} 
```

最简单的思维方式如下：

*   服务是一个单例对象实例。如果您想为代码提供单例对象，请使用服务。
*   工厂是一个阶级。如果您想为您的代码提供自定义类，请使用工厂（不能通过服务完成，因为它们已经被实例化了）。

工厂“类”示例在评论中提供，以及提供者差异。

* * *

## 回答 #13

> 赞同：34
> 
> 时间：2014-11-21T00:59:27.947

我对此事的澄清：

基本上所有提到的类型（服务、工厂、提供者等）都只是创建和配置全局变量（当然对整个应用程序来说都是全局的），就像老式的全局变量一样。

虽然不推荐使用全局变量，但这些全局变量的真正用途是通过将变量传递给相关控制器来提供[依赖注入。](http://en.wikipedia.org/wiki/Dependency_injection)

为“全局变量”创建值有很多复杂程度：

1.  **常量**
    这定义了一个在整个应用程序中不应修改的实际常量，就像其他语言中的常量一样（JavaScript 缺少的东西）。

2.  **Value**
    这是一个可修改的值或对象，它充当一些全局变量，甚至可以在创建其他服务或工厂时注入（参见这些内容的进一步说明）。但是，它必须是一个“*字面值*”，这意味着必须写出实际值，并且不能使用任何计算或编程逻辑（也就是说*39*或*myText*或*{prop: "value"}*都可以，但是*2 +2*不是）。
3.  **Factory**
    一个更通用的值，可以立即计算。它的工作原理是向 AngularJS 传递一个函数，其中包含计算值所需的逻辑，AngularJS 执行它，并将返回值保存在命名变量中。
    请注意，可以返回一个对象（在这种情况下，它的功能类似于*service*）或一个函数（将作为回调函数保存在变量中）。
4.  **服务服务是***工厂*
    的更精简版本，仅当值是对象时才有效，它允许直接在函数中编写任何逻辑（就像它是构造函数一样），以及声明和访问使用*this*关键字的对象属性。
***   **提供者**
    与作为*工厂*简化版本的服务不同，提供者是一种更复杂但更灵活的初始化“全局”变量的方法，最大的灵活性是从 app.config 设置值的选项。
    它的工作方式类似于使用*service*和*provider*的组合，通过向 provider 传递一个函数，该函数具有使用*this*关键字声明的属性，可以从`app.config`.
    然后它需要有一个单独的*$.get*函数，在通过文件设置上述属性后由 AngularJS 执行`app.config`，这个*$.get*函数的行为就像*工厂一样*上面，因为它的返回值用于初始化“全局”变量。**

 *** * *

## 回答 #14

> 赞同：27
> 
> 时间：2014-06-05T07:18:39.173

下面我的理解很简单。

**工厂：** 您只需在工厂内部创建一个对象并返回它。

**服务：**

你只有一个标准函数，它使用这个关键字来定义一个函数。

**提供者：**

您定义了一个`$get`对象，它可用于获取返回数据的对象。

* * *

## 回答 #15

> 赞同：26
> 
> 时间：2016-04-27T22:32:50.683

[来自Angular 文档](https://docs.angularjs.org/guide/providers)的摘要：

*   有五种配方类型定义了如何创建对象：**[Value](https://docs.angularjs.org/guide/providers#value-recipe)**、 **[Factory](https://docs.angularjs.org/guide/providers#factory-recipe)**、**[Service](https://docs.angularjs.org/guide/providers#service-recipe)**、**[Provider](https://docs.angularjs.org/guide/providers#provider-recipe)**和**[Constant](https://docs.angularjs.org/guide/providers#constant-recipe)**。
*   **工厂**和**服务**是最常用的配方。它们之间的唯一区别是**Service**配方更适用于自定义类型的对象，而**Factory**可以生成 JavaScript 原语和函数。
*   **Provider** recipe 是核心的recipe 类型，所有其他的只是它的语法糖。
*   **Provider**是最复杂的配方类型。除非您正在构建需要全局配置的可重用代码，否则您不需要它。

[![在此处输入图像描述](../Images/b64cbca5a6cf12bd759d499bf401b702.png)](https://i.stack.imgur.com/CsuYG.png)

* * *

**SO的最佳答案：**

[https://stackoverflow.com/a/26924234/165673](https://stackoverflow.com/a/26924234/165673) (<-- 好) [https://stackoverflow.com/a/27263882/165673](https://stackoverflow.com/a/27263882/165673)
[https://stackoverflow.com/a/16566144/165673](https://stackoverflow.com/a/16566144/165673)

* * *

## 回答 #16

> 赞同：22
> 
> 时间：2017-09-27T12:21:19.200

所有好的答案已经。我想在**Service**和**Factory**上再补充几点。以及服务/工厂之间的区别。人们还可能有以下问题：

1.  ***我应该使用服务还是工厂？有什么不同？***
2.  ***他们做同样的事情还是有同样的行为？***

让我们从 Service 和 factory 的区别开始：

1.  **两者都是单例**：每当 Angular 第一次发现这些作为依赖项时，它都会创建一个服务/工厂的单个实例。创建实例后，将永远使用同一个实例。

2.  **可用于对具有行为的对象进行建模**：它们都可以具有方法、内部状态变量等。尽管您编写该代码的方式会有所不同。

**服务：**

服务是一个构造函数，Angular 会通过调用 new 来实例化它`yourServiceName()`。这意味着几件事。

1.  函数和实例变量将是`this`.
2.  您不需要返回值。当 Angular 调用`new yourServiceName(`) 时，它会接收到`this`包含您放置在其上的所有属性的对象。

示例：

```
angular.service('MyService', function() {
  this.aServiceVariable = "Ved Prakash"
  this.aServiceMethod = function() {
    return //code
  };
}); 
```

> 当 Angular 将此`MyService`服务注入依赖于它的控制器时，该控制器将获得一个`MyService`它可以调用函数的对象，例如 MyService.aServiceMethod ()。

**小心`this`**：

由于构造的服务是一个对象，它里面的方法在被调用时可以引用这个：

```
angular.service('ScoreKeeper', function($http) {
  this.score = 0;

  this.getScore = function() {
    return this.score;
  };

  this.setScore = function(newScore) {
    this.score = newScore;
  };

  this.addOne = function() {
    this.score++;
  };
}); 
```

您可能很想调用`ScoreKeeper.setScore`一个承诺链，例如，如果您通过从服务器获取分数来初始化分数：`$http.get('/score').then(ScoreKeeper.setScore).`这样做的问题是`ScoreKeeper.setScore`它将被`this`绑定到调用`null`并且您会得到错误。更好的方法是`$http.get('/score').then(ScoreKeeper.setScore.bind(ScoreKeeper))`。无论你是否选择在你的服务方法中使用它，都要小心你如何调用它们。

**从 a 返回一个值`Service`**：

由于 JavaScript 构造函数的工作方式，如果您`(i.e., an Object)`从`constructor`函数返回一个复杂值，调用者将获得该 Object 而不是 this 实例。

这意味着您基本上可以从下面复制粘贴工厂示例，替换`factory`为`service`，它会起作用：

```
angular.service('MyService', function($http) {
  var api = {};

  api.aServiceMethod= function() {
    return $http.get('/users');
  };
  return api;
}); 
```

所以当 Angular 用 new MyService() 构造你的服务时，它会得到那个 api 对象而不是 MyService 实例。

这是任何复杂值（对象、函数）的行为，但不适用于原始类型。

**工厂：**

工厂是一个简单的旧函数，它返回一个值。返回值是注入到依赖于工厂的东西中的东西。Angular 中一个典型的工厂模式是返回一个具有函数作为属性的对象，如下所示：

```
angular.factory('MyFactory', function($http) {
  var api = {};

  api.aFactoryMethod= function() {
    return $http.get('/users');
  };

  return api;
}); 
```

> 工厂依赖的注入值是工厂的返回值，它不一定是对象。它可能是一个函数

上述1和2问题的答案：

> 在大多数情况下，只要坚持使用工厂来处理所有事情。他们的行为更容易理解。是否返回值没有选择，而且如果你做错了也不会引入错误。
> 
> 不过，当我谈论将它们作为依赖项注入时，我仍然将它们称为“服务”。
> 
> Service/Factory 的行为非常相似，有些人会说任何一个都可以。这有点正确，但我发现遵循 John Papa 风格指南的建议并坚持使用工厂更容易。**

* * *

## 回答 #17

> 赞同：17
> 
> 时间：2014-04-30T17:20:23.413

另一个说明是工厂可以创建函数/基元，而服务不能。查看这个基于 Epokk 的 jsFiddle：[http :](http://jsfiddle.net/) [//jsfiddle.net/skeller88/PxdSP/1351/](http://jsfiddle.net/skeller88/PxdSP/1351/)。

工厂返回一个可以调用的函数：

```
myApp.factory('helloWorldFromFactory', function() {
  return function() {
    return "Hello, World!";
  };
}); 
```

工厂还可以返回一个带有可调用方法的对象：

```
myApp.factory('helloWorldFromFactory', function() {
  return {
    sayHello: function() {
      return "Hello, World!";
    }
  };
}); 
```

该服务返回一个带有可以调用的方法的对象：

```
myApp.service('helloWorldFromService', function() {
  this.sayHello = function() {
     return "Hello, World!";
  };
}); 
```

有关更多详细信息，请参阅我写的关于差异的帖子：http: [//www.shanemkeller.com/tldr-services-vs-factories-in-angular/](http://www.shanemkeller.com/tldr-services-vs-factories-in-angular/)

* * *

## 回答 #18

> 赞同：17
> 
> 时间：2015-06-23T00:04:37.310

已经有很好的答案了，但我只想分享这个。

首先：**Provider**是创建`service`假设由 $injector 注入的（单例对象）的方式/配方（AngulaJS 如何处理 IoC 模式）。

还有**价值、工厂、服务和常量**（4 种方式）——**提供者**方式/接收器的语法糖。

有`Service vs Factory`部分已覆盖： [https ://www.youtube.com/watch?v=BLzNCkPn3ao](https://www.youtube.com/watch?v=BLzNCkPn3ao)

**服务**实际上与关键字有关`new`，据我们所知，它做了 4 件事：

1.  创建全新的对象
2.  将其链接到其`prototype`对象
3.  连接`context`到`this`
4.  并返回`this`

**工厂**是关于工厂模式的 - 包含返回类似服务的对象的函数。

1.  使用其他服务的能力（有依赖关系）
2.  服务初始化
3.  延迟/延迟初始化

这个简单/简短的视频：还涵盖了**提供者**：[https](https://www.youtube.com/watch?v=HvTZbQ_hUZY) ://www.youtube.com/watch?v=HvTZbQ_hUZY （在那里你可以看到它们是如何从工厂到提供者的）

**在应用程序完全启动/初始化之前，提供程序**配方主要用于应用程序配置。

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2017-05-11T09:32:07.317

在阅读了所有这些帖子之后，它给我带来了更多的困惑..但仍然都是有价值的信息..最后我找到了下表，它可以提供简单比较的信息

*   注入器使用配方创建两种类型的对象：服务和特殊用途对象
*   有五种配方类型定义了如何创建对象：Value、Factory、Service、Provider 和 Constant。
*   工厂和服务是最常用的配方。它们之间的唯一区别是 Service 配方更适用于自定义类型的对象，而 Factory 可以生成 JavaScript 原语和函数。
*   Provider recipe 是核心的 recipe 类型，所有其他的只是它的语法糖。
*   Provider 是最复杂的配方类型。除非您正在构建需要全局配置的可重用代码，否则您不需要它。
*   除控制器外的所有特殊用途对象均通过工厂配方定义。

[![在此处输入图像描述](../Images/3a22e18c500990ccb4d15d99f07b5d79.png)](https://i.stack.imgur.com/1rkve.png)

**对于初学者来说：-**这可能不正确的用例，但在高层次上，这就是这三个的用例。

1.  如果您想在 Angular 模块中使用配置功能，则应将其创建为**提供者**

```
angular.module('myApp').config(function($testProvider){
$testProvider.someFunction();
})
```

2.  Ajax 调用或第三方集成需要**服务**。
3.  对于数据操作，将其创建为**工厂**

对于基本场景，工厂和服务的行为相同。

* * *

## 回答 #20

> 赞同：13
> 
> 时间：2015-03-30T15:26:46.270

这是我为 AngularjS 中的对象工厂提供的一些代码模板。我以 Car/CarFactory 为例进行说明。在控制器中制作简单的实现代码。

```
 <script>
        angular.module('app', [])
            .factory('CarFactory', function() {

                /**
                 * BroilerPlate Object Instance Factory Definition / Example
                 */
                this.Car = function() {

                    // initialize instance properties
                    angular.extend(this, {
                        color           : null,
                        numberOfDoors   : null,
                        hasFancyRadio   : null,
                        hasLeatherSeats : null
                    });

                    // generic setter (with optional default value)
                    this.set = function(key, value, defaultValue, allowUndefined) {

                        // by default,
                        if (typeof allowUndefined === 'undefined') {
                            // we don't allow setter to accept "undefined" as a value
                            allowUndefined = false;
                        }
                        // if we do not allow undefined values, and..
                        if (!allowUndefined) {
                            // if an undefined value was passed in
                            if (value === undefined) {
                                // and a default value was specified
                                if (defaultValue !== undefined) {
                                    // use the specified default value
                                    value = defaultValue;
                                } else {
                                    // otherwise use the class.prototype.defaults value
                                    value = this.defaults[key];
                                } // end if/else
                            } // end if
                        } // end if

                        // update 
                        this[key] = value;

                        // return reference to this object (fluent)
                        return this;

                    }; // end this.set()

                }; // end this.Car class definition

                // instance properties default values
                this.Car.prototype.defaults = {
                    color: 'yellow',
                    numberOfDoors: 2,
                    hasLeatherSeats: null,
                    hasFancyRadio: false
                };

                // instance factory method / constructor
                this.Car.prototype.instance = function(params) {
                    return new 
                        this.constructor()
                                .set('color',           params.color)
                                .set('numberOfDoors',   params.numberOfDoors)
                                .set('hasFancyRadio',   params.hasFancyRadio)
                                .set('hasLeatherSeats', params.hasLeatherSeats)
                    ;
                };

                return new this.Car();

            }) // end Factory Definition
            .controller('testCtrl', function($scope, CarFactory) {

                window.testCtrl = $scope;

                // first car, is red, uses class default for:
                // numberOfDoors, and hasLeatherSeats
                $scope.car1     = CarFactory
                                    .instance({
                                        color: 'red'
                                    })
                                ;

                // second car, is blue, has 3 doors, 
                // uses class default for hasLeatherSeats
                $scope.car2     = CarFactory
                                    .instance({
                                        color: 'blue',
                                        numberOfDoors: 3
                                    })
                                ;
                // third car, has 4 doors, uses class default for 
                // color and hasLeatherSeats
                $scope.car3     = CarFactory
                                    .instance({
                                        numberOfDoors: 4
                                    })
                                ;
                // sets an undefined variable for 'hasFancyRadio',
                // explicitly defines "true" as default when value is undefined
                $scope.hasFancyRadio = undefined;
                $scope.car3.set('hasFancyRadio', $scope.hasFancyRadio, true);

                // fourth car, purple, 4 doors,
                // uses class default for hasLeatherSeats
                $scope.car4     = CarFactory
                                    .instance({
                                        color: 'purple',
                                        numberOfDoors: 4
                                    });
                // and then explicitly sets hasLeatherSeats to undefined
                $scope.hasLeatherSeats = undefined;
                $scope.car4.set('hasLeatherSeats', $scope.hasLeatherSeats, undefined, true);

                // in console, type window.testCtrl to see the resulting objects

            });
    </script> 
```

这是一个更简单的例子。我正在使用一些第三方库，它们期望“位置”对象公开纬度和经度，但通过不同的对象属性。我不想破解供应商代码，所以我调整了我传递的“位置”对象。

```
 angular.module('app')
.factory('PositionFactory', function() {

    /**
     * BroilerPlate Object Instance Factory Definition / Example
     */
    this.Position = function() {

        // initialize instance properties 
        // (multiple properties to satisfy multiple external interface contracts)
        angular.extend(this, {
            lat         : null,
            lon         : null,
            latitude    : null,
            longitude   : null,
            coords: {
                latitude: null,
                longitude: null
            }
        });

        this.setLatitude = function(latitude) {
            this.latitude           = latitude;
            this.lat                = latitude;
            this.coords.latitude    = latitude;
            return this;
        };
        this.setLongitude = function(longitude) {
            this.longitude          = longitude;
            this.lon                = longitude;
            this.coords.longitude   = longitude;
            return this;
        };

    }; // end class definition

    // instance factory method / constructor
    this.Position.prototype.instance = function(params) {
        return new 
            this.constructor()
                    .setLatitude(params.latitude)
                    .setLongitude(params.longitude)
        ;
    };

    return new this.Position();

}) // end Factory Definition

.controller('testCtrl', function($scope, PositionFactory) {
    $scope.position1 = PositionFactory.instance({latitude: 39, longitude: 42.3123});
    $scope.position2 = PositionFactory.instance({latitude: 39, longitude: 42.3333});
}) // end controller 
```

;

* * *

## 回答 #21

> 赞同：12
> 
> 时间：2015-01-30T20:04:12.223

使用此页面和[文档](https://docs.angularjs.org/guide/providers)作为参考（自上次查看以来似乎已经有了很大改进），我整理了以下真实（-ish）世界演示，它使用了 5 种提供程序中的 4 种；价值，恒定，工厂和成熟的供应商。

**HTML：**

```
<div ng-controller="mainCtrl as main">
    <h1>{{main.title}}*</h1>
    <h2>{{main.strapline}}</h2>
    <p>Earn {{main.earn}} per click</p>
    <p>You've earned {{main.earned}} by clicking!</p>
    <button ng-click="main.handleClick()">Click me to earn</button>
    <small>* Not actual money</small>
</div> 
```

**应用程序**

```
var app = angular.module('angularProviders', []);

// A CONSTANT is not going to change
app.constant('range', 100);

// A VALUE could change, but probably / typically doesn't
app.value('title', 'Earn money by clicking');
app.value('strapline', 'Adventures in ng Providers');

// A simple FACTORY allows us to compute a value @ runtime.
// Furthermore, it can have other dependencies injected into it such
// as our range constant.
app.factory('random', function randomFactory(range) {
    // Get a random number within the range defined in our CONSTANT
    return Math.random() * range;
});

// A PROVIDER, must return a custom type which implements the functionality 
// provided by our service (see what I did there?).
// Here we define the constructor for the custom type the PROVIDER below will 
// instantiate and return.
var Money = function(locale) {

    // Depending on locale string set during config phase, we'll
    // use different symbols and positioning for any values we 
    // need to display as currency
    this.settings = {
        uk: {
            front: true,
            currency: '£',
            thousand: ',',
            decimal: '.'
        },
        eu: {
            front: false,
            currency: '€',
            thousand: '.',
            decimal: ','
        }
    };

    this.locale = locale;
};

// Return a monetary value with currency symbol and placement, and decimal 
// and thousand delimiters according to the locale set in the config phase.
Money.prototype.convertValue = function(value) {

    var settings = this.settings[this.locale],
        decimalIndex, converted;

    converted = this.addThousandSeparator(value.toFixed(2), settings.thousand);

    decimalIndex = converted.length - 3;

    converted = converted.substr(0, decimalIndex) +
        settings.decimal +
        converted.substr(decimalIndex + 1);    

    converted = settings.front ?
            settings.currency + converted : 
            converted + settings.currency; 

    return converted;   
};

// Add supplied thousand separator to supplied value
Money.prototype.addThousandSeparator = function(value, symbol) {
   return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, symbol);
};

// PROVIDER is the core recipe type - VALUE, CONSTANT, SERVICE & FACTORY
// are all effectively syntactic sugar built on top of the PROVIDER construct
// One of the advantages of the PROVIDER is that we can configure it before the
// application starts (see config below).
app.provider('money', function MoneyProvider() {

    var locale;

    // Function called by the config to set up the provider
    this.setLocale = function(value) {
        locale = value;   
    };

    // All providers need to implement a $get method which returns
    // an instance of the custom class which constitutes the service
    this.$get = function moneyFactory() {
        return new Money(locale);
    };
});

// We can configure a PROVIDER on application initialisation.
app.config(['moneyProvider', function(moneyProvider) {
    moneyProvider.setLocale('uk');
    //moneyProvider.setLocale('eu'); 
}]);

// The ubiquitous controller
app.controller('mainCtrl', function($scope, title, strapline, random, money) {

    // Plain old VALUE(s)
    this.title = title;
    this.strapline = strapline;

    this.count = 0;

    // Compute values using our money provider    
    this.earn = money.convertValue(random); // random is computed @ runtime
    this.earned = money.convertValue(0);

    this.handleClick = function() { 
        this.count ++;
        this.earned = money.convertValue(random * this.count);
    };
}); 
```

工作[演示](http://jsfiddle.net/net_uk_sweet/6ubnppnu/1/)。

* * *

## 回答 #22

> 赞同：12
> 
> 时间：2015-04-13T22:55:00.233

这个答案解决了主题/问题

## Factory、Service 和 Constant — 如何只是提供程序配方之上的语法糖？

**或者**

## 工厂、服务和供应商在内部是如何相似的

基本上发生的事情是

当您将在第二个参数中提供的`factory()`它设置为提供者并返回它（）时，*您得到的**只是除此之外没有属性/方法*（意味着您无法配置它）`function``$get``provider(name, {$get:factoryFn })`*`provider``$get`*`provider`

**工厂源代码**

```
function factory(name, factoryFn, enforce) {
    return provider(name, {
      $get: enforce !== false ? enforceReturnValue(name, factoryFn) : factoryFn
    });
}; 
```

当`service()`它返回时，您提供了一个带有`function`注入的factory() `constructor`（返回您在服务中提供的构造函数的实例）并返回它

**服务源代码**

```
function service(name, constructor) {
    return factory(name, ['$injector', function($injector) {
      return $injector.instantiate(constructor);
    }]);
}; 
```

因此，基本上在这两种情况下，您最终都会为您提供的函数设置一个 providers $get ，但是您可以提供除 $get 之外的任何内容，因为您最初可以在 provider() 中为配置块提供

* * *

## 回答 #23

> 赞同：11
> 
> 时间：2015-04-07T01:25:52.397

我知道很多很好的答案，但我必须分享我的使用经验
1.`service`对于大多数默认情况
2.`factory`用于创建特定实例的服务

```
// factory.js ////////////////////////////
(function() {
'use strict';
angular
    .module('myApp.services')
    .factory('xFactory', xFactoryImp);
xFactoryImp.$inject = ['$http'];

function xFactoryImp($http) {
    var fac = function (params) {
        this._params = params; // used for query params
    };

    fac.prototype.nextPage = function () {
        var url = "/_prc";

        $http.get(url, {params: this._params}).success(function(data){ ...
    }
    return fac;
}
})();

// service.js //////////////////////////
(function() {
'use strict';
angular
    .module('myApp.services')
    .service('xService', xServiceImp);
xServiceImp.$inject = ['$http'];

function xServiceImp($http) {  
    this._params = {'model': 'account','mode': 'list'};

    this.nextPage = function () {
        var url = "/_prc";

        $http.get(url, {params: this._params}).success(function(data){ ...
    }       
}
})(); 
```

并使用：

```
controller: ['xFactory', 'xService', function(xFactory, xService){

        // books = new instance of xFactory for query 'book' model
        var books = new xFactory({'model': 'book', 'mode': 'list'});

        // accounts = new instance of xFactory for query 'accounts' model
        var accounts = new xFactory({'model': 'account', 'mode': 'list'});

        // accounts2 = accounts variable
        var accounts2 = xService;
... 
```

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2015-12-28T19:26:13.977

晚会有点晚了。但我认为这对那些想学习（或清楚）使用工厂、服务和提供者方法开发 Angular JS 自定义服务的人更有帮助。

我看到了这个视频，它清楚地解释了开发 AngularJS 自定义服务的工厂、服务和提供者方法：

[https://www.youtube.com/watch?v=oUXku28ex-M](https://www.youtube.com/watch?v=oUXku28ex-M)

源代码：[http ://www.techcbt.com/Post/353/Angular-JS-basics/how-to-develop-angularjs-custom-service](http://www.techcbt.com/Post/353/Angular-JS-basics/how-to-develop-angularjs-custom-service)

此处发布的代码直接从上述来源复制，以使读者受益。

基于“工厂”的自定义服务的代码如下（同步和异步版本以及调用 http 服务）：

```
var app = angular.module("app", []);
app.controller('emp', ['$scope', 'calcFactory',
  function($scope, calcFactory) {
    $scope.a = 10;
    $scope.b = 20;

    $scope.doSum = function() {
      //$scope.sum = calcFactory.getSum($scope.a, $scope.b); //synchronous
      calcFactory.getSum($scope.a, $scope.b, function(r) { //aynchronous
        $scope.sum = r;
      });
    };

  }
]);

app.factory('calcFactory', ['$http', '$log',
  function($http, $log) {
    $log.log("instantiating calcFactory..");
    var oCalcService = {};

    //oCalcService.getSum = function(a,b){
    //	return parseInt(a) + parseInt(b);
    //};

    //oCalcService.getSum = function(a, b, cb){
    //	var s = parseInt(a) + parseInt(b);
    //	cb(s);
    //};

    oCalcService.getSum = function(a, b, cb) { //using http service

      $http({
        url: 'http://localhost:4467/Sum?a=' + a + '&b=' + b,
        method: 'GET'
      }).then(function(resp) {
        $log.log(resp.data);
        cb(resp.data);
      }, function(resp) {
        $log.error("ERROR occurred");
      });
    };

    return oCalcService;
  }
]);
```

自定义服务的“服务”方法的代码（这与“工厂”非常相似，但从语法角度来看不同）：

```
var app = angular.module("app", []);
app.controller('emp', ['$scope', 'calcService', function($scope, calcService){
	$scope.a = 10;
	$scope.b = 20;

	$scope.doSum = function(){
		//$scope.sum = calcService.getSum($scope.a, $scope.b);

		calcService.getSum($scope.a, $scope.b, function(r){
			$scope.sum = r;
		});		
	};

}]);

app.service('calcService', ['$http', '$log', function($http, $log){
	$log.log("instantiating calcService..");

	//this.getSum = function(a,b){
	//	return parseInt(a) + parseInt(b);
	//};

	//this.getSum = function(a, b, cb){
	//	var s = parseInt(a) + parseInt(b);
	//	cb(s);
	//};

	this.getSum = function(a, b, cb){
		$http({
			url: 'http://localhost:4467/Sum?a=' + a + '&b=' + b,
			method: 'GET'
		}).then(function(resp){
			$log.log(resp.data);
			cb(resp.data);
		},function(resp){
			$log.error("ERROR occurred");
		});
	};

}]);
```

自定义服务的“提供者”方法的代码（如果您想开发可以配置的服务，这是必要的）：

```
var app = angular.module("app", []);
app.controller('emp', ['$scope', 'calcService', function($scope, calcService){
	$scope.a = 10;
	$scope.b = 20;

	$scope.doSum = function(){
		//$scope.sum = calcService.getSum($scope.a, $scope.b);

		calcService.getSum($scope.a, $scope.b, function(r){
			$scope.sum = r;
		});		
	};

}]);

app.provider('calcService', function(){

	var baseUrl = '';

	this.config = function(url){
		baseUrl = url;
	};

	this.$get = ['$log', '$http', function($log, $http){
		$log.log("instantiating calcService...")
		var oCalcService = {};

		//oCalcService.getSum = function(a,b){
		//	return parseInt(a) + parseInt(b);
		//};

		//oCalcService.getSum = function(a, b, cb){
		//	var s = parseInt(a) + parseInt(b);
		//	cb(s);	
		//};

		oCalcService.getSum = function(a, b, cb){

			$http({
				url: baseUrl + '/Sum?a=' + a + '&b=' + b,
				method: 'GET'
			}).then(function(resp){
				$log.log(resp.data);
				cb(resp.data);
			},function(resp){
				$log.error("ERROR occurred");
			});
		};		

		return oCalcService;
	}];

});

app.config(['calcServiceProvider', function(calcServiceProvider){
	calcServiceProvider.config("http://localhost:4467");
}]);
```

最后是与上述任何服务一起使用的 UI：

```
<html>
<head>
	<title></title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js" ></script>
	<script type="text/javascript" src="t03.js"></script>
</head>
<body ng-app="app">
	<div ng-controller="emp">
		<div>
			Value of a is {{a}},
			but you can change
			<input type=text ng-model="a" /> <br>

			Value of b is {{b}},
			but you can change
			<input type=text ng-model="b" /> <br>

		</div>
		Sum = {{sum}}<br>
		<button ng-click="doSum()">Calculate</button>
	</div>
</body>
</html>
```

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2016-01-21T20:44:58.963

只是为了澄清一下，从 AngularJS 源代码中，您可以看到一个服务只是调用了工厂函数，而工厂函数又调用了提供者函数：

```
function factory(name, factoryFn) { 
    return provider(name, { $get: factoryFn }); 
}

function service(name, constructor) {
    return factory(name, ['$injector', function($injector) {
      return $injector.instantiate(constructor);
    }]);
} 
```

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2016-12-09T07:27:50.113

让我们以简单的方式讨论在 AngularJS 中处理业务逻辑的三种方式：（**灵感来自 Yaakov 的 Coursera AngularJS 课程**）

**服务**：

句法：

**应用程序.js**

```
 var app = angular.module('ServiceExample',[]);
 var serviceExampleController =
              app.controller('ServiceExampleController', ServiceExampleController);
 var serviceExample = app.service('NameOfTheService', NameOfTheService);

 ServiceExampleController.$inject = ['NameOfTheService'] //protects from minification of js files

function ServiceExampleController(NameOfTheService){
     serviceExampleController = this;
     serviceExampleController.data = NameOfTheService.getSomeData();
 }

function NameOfTheService(){
     nameOfTheService = this;
     nameOfTheService.data = "Some Data";
     nameOfTheService.getSomeData = function(){
           return nameOfTheService.data;
     }     
} 
```

**索引.html**

```
<div ng-controller = "ServiceExampleController as serviceExample">
   {{serviceExample.data}}
</div> 
```

服务特色：

1.  *惰性实例化*：如果它没有被注入，它永远不会被实例化。所以要使用它必须将它注入一个模块。
2.  *Singleton*：如果注入到多个模块中，所有模块都只能访问一个特定的实例。这就是为什么在不同控制器之间共享数据非常方便的原因。

**工厂**

首先让我们看一下语法：

**应用程序.js**：

```
var app = angular.module('FactoryExample',[]);
var factoryController = app.controller('FactoryController', FactoryController);
var factoryExampleOne = app.factory('NameOfTheFactoryOne', NameOfTheFactoryOne);
var factoryExampleTwo = app.factory('NameOfTheFactoryTwo', NameOfTheFactoryTwo);

//first implementation where it returns a function
function NameOfTheFactoryOne(){
   var factory = function(){
      return new SomeService();
    }
   return factory;
}

//second implementation where an object literal would be returned
function NameOfTheFactoryTwo(){
   var factory = {
      getSomeService : function(){
          return new SomeService();
       }
    };
   return factory;
} 
```

现在在控制器中使用上述两个：

```
 var factoryOne = NameOfTheFactoryOne() //since it returns a function
 factoryOne.someMethod();

 var factoryTwo = NameOfTheFactoryTwo.getSomeService(); //accessing the object
 factoryTwo.someMethod(); 
```

工厂特点：

1.  遵循工厂设计模式。工厂是生产新物品或功能的中心场所。
2.  不仅产生单例，而且产生可定制的服务。
3.  该`.service()`方法是一个总是产生相同类型的服务的**工厂**，它是一个单例，并且没有任何简单的方法来配置它的行为。该`.service()`方法通常用作不需要任何配置的快捷方式。

**提供者**

让我们先看一下语法：

```
angular.module('ProviderModule', [])
.controller('ProviderModuleController', ProviderModuleController)
.provider('ServiceProvider', ServiceProvider)
.config(Config); //optional

Config.$inject = ['ServiceProvider'];
function Config(ServiceProvider) {
  ServiceProvider.defaults.maxItems = 10; //some default value
}

ProviderModuleController.$inject = ['ServiceProvider'];
function ProviderModuleController(ServiceProvider) {
  //some methods
}

function ServiceProvider() {
  var provider = this;

  provider.defaults = {
    maxItems: 10
  };

  provider.$get = function () {
    var someList = new someListService(provider.defaults.maxItems);

    return someList;
  };
}

} 
```

提供者的特点：

1.  Provider 是在 Angular 中创建服务的最灵活的方法。
2.  我们不仅可以创建一个可动态配置的工厂，而且在使用工厂时，通过提供者方法，我们可以在整个应用程序的引导时自定义配置工厂一次。
3.  然后可以通过自定义设置在整个应用程序中使用工厂。换句话说，我们可以在应用程序启动之前配置这个工厂。`.service`事实上，在 Angular 文档中提到，当我们使用or方法配置我们的服务时，提供者方法实际上是在幕后执行的`.factory`。
4.  这`$get`是一个直接附加到提供程序实例的函数。该函数是**工厂**函数。换句话说，它就像我们用来*提供*给`.factory`方法的那个。在该函数中，我们创建自己的服务。**这个`$get`属性，也就是一个函数，使提供者成为提供者**。*AngularJS 期望提供者有一个 $get 属性，它的值是 Angular 将作为工厂函数处理的函数。*但是，使整个提供程序设置非常特别的是，我们可以`config`在服务提供程序内部提供一些对象，并且通常带有默认值，我们可以稍后在步骤中覆盖这些默认值，我们可以在其中配置整个应用程序。

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2015-03-04T11:12:38.417

**工厂：**您实际上在工厂内部创建一个对象并返回它的工厂。
**服务：**您只有一个标准功能的服务，它使用 this 关键字来定义功能。
**provider：**提供者有一个你定义的$get，它可以用来获取返回数据的对象。

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2016-12-28T11:41:07.937

本质上，提供者、工厂和服务都是服务。当您只需要一个 $get() 函数时，工厂是服务的一种特殊情况，允许您用更少的代码编写它。

**服务、工厂和供应商之间的主要区别在于它们的复杂性。服务是最简单的形式，工厂更健壮一些，提供者在运行时是可配置的。**

以下是何时使用每种方法的摘要：

**工厂**：您提供的值需要根据其他数据计算。

**服务**：您正在返回一个带有方法的对象。

**提供者**：您希望能够在配置阶段配置要在创建之前创建的对象。在应用程序完全初始化之前，主要在应用程序配置中使用 Provider。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2016-10-30T23:39:31.173

1.服务是在必要时创建的单例对象，并且在应用程序生命周期结束（浏览器关闭时）之前永远不会被清理。当不再需要控制器时，它们会被销毁和清理。

2.创建服务最简单的方法是使用 factory() 方法。factory() 方法允许我们通过返回包含服务功能和服务数据的对象来定义服务。服务定义函数是我们放置可注入服务的地方，例如 $http 和 $q。前任：

```
angular.module('myApp.services')
.factory('User', function($http) { // injectables go here
var backendUrl = "http://localhost:3000"; var service = {
    // our factory definition
user: {},
setName: function(newName) {
      service.user['name'] = newName;
    },
setEmail: function(newEmail) { service.user['email'] = newEmail;
},
save: function() {
return $http.post(backendUrl + '/users', { user: service.user
}); }
};
return service; }); 
```

在我们的应用程序中使用 factory()

在我们的应用程序中使用工厂很容易，因为我们可以在运行时将它简单地注入到我们需要的地方。

```
angular.module('myApp')
.controller('MainController', function($scope, User) {
  $scope.saveUser = User.save;
}); 
```

3.  另一方面，service() 方法允许我们通过定义构造函数来创建服务。我们可以使用原型对象来定义我们的服务，而不是原始的 javascript 对象。与 factory() 方法类似，我们还将在函数定义中设置可注入对象。
4.  创建服务的最低级别方法是使用 provide() 方法。这是创建可以使用 .config() 函数配置的服务的唯一方法。与前面的 to 方法不同，我们将在定义的 this.$get() 函数定义中设置注射剂。

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2016-04-03T19:50:08.663

**语法糖就是区别**。只需要提供者。或者换句话说，只有提供者是真正的角度，所有其他的都是派生的（以减少代码）。还有一个简单的版本，称为 Value()，它只返回值，不返回计算或函数。甚至 Value 都来源于 provider！

那么为什么会有这样的复杂性，为什么我们不能只使用提供者而忘记其他一切呢？它应该可以帮助我们轻松编写代码并更好地沟通。诙谐的回答是，它变得越复杂，框架的销售就会越好。

* * *

*   可以返回值的提供者 = 值
*   一个可以实例化并返回的提供者 = Factory (+ Value)
*   可以实例化+做某事的提供者=服务（+工厂，+价值）
*   提供者 = 必须包含一个名为 $get (+Factory, + Service, + Value) 的属性

    * * *

Angular 注入给了我们得出这个结论的第一个提示。

“$injector 用于检索**提供者**定义的对象实例”不是服务，不是工厂，而是提供者。

更好的答案是：“Angular 服务是由服务工厂创建的。这些服务工厂是由服务提供者创建的函数。服务提供者是构造函数。实例化时，它们必须包含一个属性称为 $get，它拥有服务工厂功能。”

所以主提供者和注入器，一切都会到位:)。当 $get 可以通过从 IServiceProvider 继承在提供程序中实现时，Typescript 会变得很有趣。**

# javascript - 当我放置标记时，谷歌地图中出现灰色矩形

> ID：15666054
> 
> 赞同：1
> 
> 时间：2013-03-27T17:59:52.220
> 
> 标签：javascript, google-maps-api-3

我的 Python/GAE webapp 中有一个谷歌地图，当我自己放置地图时，没有大头针，它可以正确显示。但是，当我在上面放置一个标记时，地图的很大一部分会被一个灰色矩形抹去。![在此处输入图像描述](../Images/b342249195b3868ce03150cb5a6396c4.png)

这是我的 JS 代码：

```
//Places a Google Map with a pin at the coordinates of the stopimap
 function initialize(lat, lng) {                                 
    var mapProp = {
       center:new google.maps.LatLng(37.761586,-122.4477),
       zoom:12,
       mapTypeId:google.maps.MapTypeId.ROADMAP
    };

    var point=new google.maps.LatLng(lat,lng)
    var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
    marker = new google.maps.Marker({
        position: point,
        map: map,
    }); 
}//initialize 
```

# php - wordpress 重写

> ID：15666055
> 
> 赞同：0
> 
> 时间：2013-03-27T17:59:53.167
> 
> 标签：php, wordpress, rewrite

试图为 wordpress 网站工作添加重写规则但没有乐趣

```
function wptuts_add_rewrite_rules() {

add_rewrite_rule('^dukebox/([0-9-]*)/?','index.php?pagename=dukebox&startdate=$matches[1]','top');
flush_rewrite_rules();
}
add_action( 'init', 'wptuts_add_rewrite_rules' ); 
```

我想要的是

[http://www.mikekeelin.co.uk/dukebox/?startdate=2013-02-25](http://www.mikekeelin.co.uk/dukebox/?startdate=2013-02-25)

读书

[http://www.mikekeelin.co.uk/dukebox/2013-02-25](http://www.mikekeelin.co.uk/dukebox/2013-02-25)

也试过

```
index.php?p=85&startdate=$matches[1]','top'); 
```

但没有快乐

非常感谢任何帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:06:49.597

你的重写规则很好，试试这一行：

```
add_action('generate_rewrite_rules', 'wptuts_add_rewrite_rules'); 
```

而不是在初始化时添加你的重写规则:)

**编辑 ：**

如果这不起作用，我认为你应该只调用`add_rewrite_rule`一次函数，然后调用`flush_rules`将它们保存到数据库中，那么你应该能够使用你的新 url 而没有任何钩子。

# scala - Jenkins 标签名称无效

> ID：15666056
> 
> 赞同：1
> 
> 时间：2013-03-27T17:59:57.587
> 
> 标签：scala, jenkins

有没有人看到詹金斯的以下异常？

```
FATAL: org.eclipse.jgit.api.errors.InvalidTagNameException: tag name jenkins-Push Notifications API (Master)-3 is invalid
hudson.plugins.git.GitException: org.eclipse.jgit.api.errors.InvalidTagNameException: tag name jenkins-Push Notifications API (Master)-3 is invalid
    at org.jenkinsci.plugins.gitclient.JGitAPIImpl.tag(JGitAPIImpl.java:179)
    at hudson.plugins.git.GitAPI.tag(GitAPI.java:220)
    at hudson.plugins.git.GitSCM$4.invoke(GitSCM.java:1239)
    at hudson.plugins.git.GitSCM$4.invoke(GitSCM.java:1196)
    at hudson.FilePath.act(FilePath.java:865)
    at hudson.FilePath.act(FilePath.java:838)
    at hudson.plugins.git.GitSCM.checkout(GitSCM.java:1196)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:1353)
    at hudson.model.AbstractBuild$AbstractBuildExecution.defaultCheckout(AbstractBuild.java:689)
    at jenkins.scm.SCMCheckoutStrategy.checkout(SCMCheckoutStrategy.java:88)
    at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:594)
    at hudson.model.Run.execute(Run.java:1567)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:237)
Caused by: org.eclipse.jgit.api.errors.InvalidTagNameException: tag name jenkins-Push Notifications API (Master)-3 is invalid
    at org.eclipse.jgit.api.TagCommand.processOptions(TagCommand.java:198)
    at org.eclipse.jgit.api.TagCommand.call(TagCommand.java:112)
    at org.jenkinsci.plugins.gitclient.JGitAPIImpl.tag(JGitAPIImpl.java:175)
    ... 14 more 
```

这是一个 Scala 项目，我们使用 SBT 12.1 来构建它。我的谷歌搜索只返回了我过去的旧版本 Jenkins 的问题。我们有 1.506。

我们还有很多其他项目正在建设中，其中一些也是 Scala。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T19:26:40.107

我在构建 Java 项目时遇到了这个错误。我不确定为什么会突然出现这种情况，但我可以通过执行以下操作来解决它：

转到构建配置的**源代码管理**部分的**高级...**配置设置，然后选中“跳过内部标记”。

 **（从评论升级）**

# loops - 编程计数系统 C++ 还显示结果的条形图

> ID：15666070
> 
> 赞同：0
> 
> 时间：2013-03-27T18:00:32.653
> 
> 标签：loops, for-loop, nested

```
#include <iostream> //include header files
#include <string>

using namespace std;

int main () //main body fcn

{
    int answer;//delcaring integers and initializing them
    int a = 0;
    int b = 0;
    int c = 0;
    int i = 0;
    int j = 0;
    int k = 0;
    while( answer!=0) //start of while loop condition to execute unless equal to 0
    {
       cout << "How do you like your eggs in the morning? " << endl; //writes to std o/p
       cout << "Enter 1 for scrambled, 2 for fried or 3 for poached, 0 to exit " << endl; //prompts user for i/p
       cin >> answer; //stores i/p from user

       if (answer == 1 ) //if 1 is selected increments a by 1
       {
          a+=1;
       }
       else if (answer == 2) //if 2 is selected increments b by 1
       {
          b+=1;
       }
       else if (answer == 3) //if 3 is selected increment c by 1
       {
          c+=1;
       }

   }

   for (i = 0; i < a; i++) //initialises i at 0, loop commences compares it with a, increments i by 1
    {
        cout << "Scrambled eggs" <<  "*" << endl; //prints out tally result
    }
    for (j = 0; j < b; j++) //initialises j at 0, loop to commence if b is greater than j, increments j by 1
    {
        cout << "Fried Eggs " << "*" << endl; //prints out tally result
    }

    for (k = 0; k < c; k++) //initialises j at 0, loop commences if c is greater than a, increments j by 1
    {
            cout << "Poached Eggs" << "*" << endl; //prints out tally result
    }

} 
```

我遇到的问题是 for 循环。我想我需要使用嵌套循环来获得正确的条形图，但是我遇到了问题。目前，结果只是打印在一个列表中，而不是一个“栏”。如果有人能提供一些启示，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:24:17.450

替换这部分代码：

```
 for (i = 0; i < a; i++) //initialises i at 0, loop commences compares it with a, increments i by 1
    {
        cout << "Scrambled eggs" <<  "*" << endl; //prints out tally result
    }
    for (j = 0; j < b; j++) //initialises j at 0, loop to commence if b is greater than j, increments j by 1
    {
        cout << "Fried Eggs " << "*" << endl; //prints out tally result
    }

    for (k = 0; k < c; k++) //initialises j at 0, loop commences if c is greater than a, increments j by 1
    {
            cout << "Poached Eggs" << "*" << endl; //prints out tally result
    } 
```

这样：

```
cout << left << setw(20) << "Scrambled eggs " << right;
for (i = 0; i < a; i++) //initialises i at 0, loop commences compares it with a, increments i by 1
    {
        cout << "*"; //prints out tally result
    }
cout << endl << left << setw(20) << "Fried Eggs " << right;
    for (j = 0; j < b; j++) //initialises j at 0, loop to commence if b is greater than j, increments j by 1
    {
      cout << "*"; //prints out tally result
    }
cout << endl << left << setw(20) << "Poached Eggs " << right;
    for (k = 0; k < c; k++) //initialises j at 0, loop commences if c is greater than a, increments j by 1
    {
            cout << "*"; //prints out tally result
    }
cout << endl; 
```

还将答案初始化为非零值。

**注意：**包括 setw 的 iomanip 头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:25:51.223

如果您在相应的 for 循环之前显示类型，如下所示：

```
cout << endl << "Scrambled eggs : \t";
for (i = 0; i < a; i++)
{
    cout << "*";
}

cout << endl << "Fried eggs : \t";
for (j = 0; j < b; j++)
{
    cout << "*";
}

cout << endl << "Poached eggs : \t";
for (k = 0; k < c; k++)
{
    cout << "*";
} 
```

[a=3,b=6,c=4] 的预期结果将是：

```
Scrambled eggs : ***
Fried eggs :     ******
Poached eggs :   **** 
```

# javascript - Javascript 将 div 移动到标记结束主体

> ID：15666071
> 
> 赞同：7
> 
> 时间：2013-03-27T18:00:33.060
> 
> 标签：javascript

如何将 div 移动到标签结束正文之前`</body>`。我正在使用openx，我无法更改div内容，因为内容归他人所有。我只是从 openx 中放置代码 javascript 以获得横幅，我将代码放在标记之后`<body>`，然后放在内容中的任何标记之前。我的问题是，当我从 openx 放置 javascript 来生成横幅时，我得到了两个平行的 div，横幅在其中，`<div id="div1">`并且`<div id="div2">`在下面的标签中`<body>`，我想在内容中任何标签上方的`<div id="div1">`标签开始正文之后。`<body>`并且`<div id="div2">`在任何标签之后的标签结束体之前`</body>`。

这是我从 openx 获取的 html，如下所示：

```
<!DOCTYPE html>
<html>
    <head>
    </head>
    <body>
        <div id="div1"><img src="blablabla" /></div>
        <div id="div2"><img src="blablabla" /></div>
        Here is content other div id or div class,
        I not define example insert after div id footer
        Because this is content owned by others.
        This is justexample content.
    </body>
</html> 
```

我想转换为如下：

```
<!DOCTYPE html>
<html>
    <head>
    </head>
    <body>
        <div id="div1"><img src="blablabla" /></div>
        Here is content other div id or div class,
        I not define, example insert after div id footer
        Because this is content owned by others.
        This is justexample content.
        <div id="div2"><img src="blablabla" /></div>
    </body>
</html> 
```

因为我想将横幅一放在内容上方，将横幅二放在内容下方。我不想使用 CSS `position: fixed`。

那么，可以将标签 div 移动到标签结束体之前吗？如果可能的话，请帮我编写javascript代码来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-27T18:05:00.120

简单的javascript：

```
document.body.appendChild(document.getElementById('div2')); 
```

要移动节点，您只需使用[appendChild](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)方法。

和演示[http://jsfiddle.net/6GsbB/](http://jsfiddle.net/6GsbB/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T18:02:20.880

是的。你可以这样做，但你需要[jQuery](http://jquery.com)。

```
a = $("#div2").clone();
$("#div2").remove();
$("body").append(a); 
```

### 小提琴：http: [//jsfiddle.net/praveenscience/zc8Ze/](http://jsfiddle.net/praveenscience/zc8Ze/)

* * *

纯 JavaScript 方法。

```
var a = document.getElementById("div2");
document.body.appendChild(a); 
```

### 小提琴：http: [//jsfiddle.net/praveenscience/zc8Ze/1/](http://jsfiddle.net/praveenscience/zc8Ze/1/)

* * *

根据评论，这可以通过[dfsq](https://stackoverflow.com/users/949476/dfsq)以更有效的方式进行：

```
document.body.appendChild(document.getElementById('div2')); 
```

# c# - 从数据表中获取布尔值？

> ID：15666072
> 
> 赞同：1
> 
> 时间：2013-03-27T18:00:33.773
> 
> 标签：c#, datagridview, datatable, boolean

![在此处输入图像描述](../Images/1388070fc487b7bcfdf107a83f4913bd.png)我从（DataTable）DataGridView.DataSource 获取 DataTable。此 datagridview 有两列，其值为布尔值，显示为复选框。但是当我尝试从数据表中获取值时，我在布尔列中得到一个“无效的转换异常”。这是我获取值的代码...

```
private void WriteDataGridChanges( int grupoIndex ) {
        if( dataGridView1.RowCount > 0 ) {
            escuela.Grupos[grupoIndex].Alumnos.Clear();
            DataTable dt = (DataTable)dataGridView1.DataSource;
            foreach( DataRow r in dt.Rows ) {
                /*crear un alumno, usar sus modificadores para los datos acorde con
                 el datagridview y añadirlo al grupo indicado 'lulz'
                 */
                Alumno al = new Alumno();
                al.Nombre = (String)r["Nombre"];
                al.Apellidos = (String)r["Apellidos"];
                al.Cuota = (double)r["Cuota Total"];
                al.CostoMaterial = (double)r["Costo de Materiales"];
                al.MaterialEntregado = (Boolean)r["Material entregado?"];
                al.CuotaCubierta = (Boolean)r["Cuota Cubierta?"];
                al.Parcialidad = (double)r["Parcialidad total"];
                al.ParcialidadMaterial = (double)r["Parcialidad de material total"];
                al.UltimaParcialidad = (DateTime)r["Fecha último pago colegiatura"];
                al.UltimoPagoMaterial = (DateTime)r["Fecha último pago de material"];
                escuela.Grupos[grupoIndex].Alumnos.Add(al);
            }
        }
        edited = false;
    } 
```

这是创建dataTable并将其传递给dataGridView的代码

```
 private DataTable RefreshGruposGrid( Grupo g ) {
        DataTable t = new DataTable();
        t.Columns.Add("Nombre", typeof(String));
        t.Columns.Add("Apellidos", typeof(String));
        t.Columns.Add("Cuota Total", typeof(double));
        t.Columns.Add("Costo de Materiales", typeof(double));
        t.Columns.Add("Material entregado?", typeof(Boolean));
        t.Columns.Add("Cuota Cubierta?", typeof(Boolean));
        t.Columns.Add("Parcialidad total", typeof(double));
        t.Columns.Add("Parcialidad de material total", typeof(double));
        t.Columns.Add("Fecha último pago colegiatura", typeof(DateTime));
        t.Columns.Add("Fecha último pago de material", typeof(DateTime));
        foreach( Alumno a in g.Alumnos ) {
            DataRow r = t.NewRow();
            r["Nombre"] = a.Nombre;
            r["Apellidos"] = a.Apellidos;
            r["Cuota Total"] = a.Cuota;
            r["Costo de Materiales"] = a.CostoMaterial;
            r["Material entregado?"] = a.MaterialEntregado;
            r["Cuota Cubierta?"] = a.CuotaCubierta;
            r["Parcialidad total"] = a.Parcialidad;
            r["Parcialidad de material total"] = a.ParcialidadMaterial;
            r["Fecha último pago colegiatura"] = a.UltimaParcialidad;
            r["Fecha último pago de material"] = a.UltimoPagoMaterial;
            t.Rows.Add(r);
        }
        return t;
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:35:36.680

好的，所以事情是 DataGridView 的默认值，每当我按下复选框列时，我都会得到一个值，但如果我不选中它，它会返回一个空值。

# c# - NavigationService.navigate 空引用异常

> ID：15666075
> 
> 赞同：2
> 
> 时间：2013-03-27T18:00:38.940
> 
> 标签：c#, windows-phone-7

我正在学习 WP 编码，但遇到无法解决的问题：/

```
try
 {
    NavigationService.Navigate(new Uri("/edit.xaml", UriKind.Relative));
 }
 catch (Exception ex)
 {
     MessageBox.Show(ex.Message.ToString(),"Error!",MessageBoxButton.OK);
 } 
```

edit.xaml 与 MainPage.xaml 位于同一目录中

它抛出“NullReferenceException”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-27T21:59:18.680

因为你得到一个`NullReferenceException`，我猜你正试图提前调用`NavigationService.Navigate`，例如在 MainPage 构造函数中。

相反，如果您想在页面加载时立即导航，请尝试`OnNavigatedTo`通过将以下代码添加到 MainPage 类来覆盖事件：

```
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
   NavigationService.Navigate(new Uri("/Page1.xaml", UriKind.Relative));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-26T20:08:54.117

这解决了问题：

```
(Application.Current.RootVisual as PhoneApplicationFrame).Navigate(new Uri("/edit.xaml", UriKind.Relative)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-26T08:46:05.073

使用这个....这解决了我的问题。

```
this.Loaded += (a, b) => {my code} 
```

# css - Grunt 指南针和 sass/css 目录

> ID：15666076
> 
> 赞同：1
> 
> 时间：2013-03-27T18:00:41.510
> 
> 标签：css, node.js, sass, compass-sass, gruntjs

我更新了最新版本的 grunt (0.4.1) 并安装了 compass 包 (grunt-contrib-compass)。这里我使用的配置：

```
compass: {                  
  dist: {                   
    options: {              
      sassDir : "src/theme/sass",
      cssDir : "src/theme/css",
      imagesDir: "src/theme/img",
      javascriptsDir : "src/js",
      fontsDir : "src/theme/fonts",
      environment : "production"
    }
  }
} 
```

每次 sass 目录发生更改时，都会执行 compass 任务并创建 css 目录（包含生产 css 文件）。一切都很好，但**css 文件、config.rb 文件和 sass 缓存也在 sass 目录中重新复制。**

有人遇到过同样的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T08:39:45.567

正如你有一个`config.rb`，考虑实际使用它：

```
compass: {
  dist: {
    options: {
      config: 'config/config.rb'
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-17T00:53:51.340

老问题，但我曾经遇到过这个问题。但问题是我运行`compass`命令而不是`grunt compass`使用默认配置。

# java - 在 Scala 中编写了一个库后，我可以通过 Java 代码使用它吗？

> ID：15666077
> 
> 赞同：3
> 
> 时间：2013-03-27T18:00:44.403
> 
> 标签：java, scala

我很清楚很多线程都致力于这个主题，但在我看来，混合 Scala 和 Java 并不是那么明显。

所以我的背景和期望首先：

我曾经在 Groovy 中编写代码，并将其与 Java 混合起来非常简单。Java 是有效的 Groovy 代码（几乎总是如此），在 Groovy 中您甚至可以实现*纯 Java*接口，以便其他*纯 Java*代码使用这些接口。简单的！

所以我的问题是：

*   在 Scala（Java 接口，Scala 实现，Java 使用）中也可以这样做吗？
*   编译后的实现是否需要 Scala 库/运行时/jar（大约 7MB...）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:13:33.083

1.  是的，它们都是可以互换的。看[这里](http://www.scala-lang.org/faq/4)。
2.  是的，要运行 Scala 代码，您将需要 JAR 文件。（检查这个结论[。](http://www.codecommit.com/blog/java/interop-between-java-and-scala)）大小是 Scala 开发人员的一个已知问题。我记得听说过一个精简版的库，但我不知道它是否存在。

# iphone - 如何使用全局/静态变量 OBJ-C

> ID：15666079
> 
> 赞同：3
> 
> 时间：2013-03-27T18:00:52.163
> 
> 标签：iphone, ios, objective-c

我正在寻找保存用于一种方法的变量，然后在另一种方法中为 App 调用它。这与全局/外部/静态变量有关吗？如果是这样，我想知道它将如何设置。我尝试使用全局和静态但没有成功。

我正在尝试保存 newX 和 newY 的信息

```
-(void) accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration
{
...
    int newX = (int)(Button.center.x + valueX);
    int newY = (int)(Button.center.y + valueY);
...
} 
```

然后调用它

```
-(IBAction)clicked:(id)sender

{
    randX = arc4random() % 320;
    randY = arc4random() % 548;

    CGPoint randNewPlace = CGPointMake(randX, randY);
    Rand.center = randNewPlace;

    if (newX == randX || newY  == randY)
    {
        [Rand sendActionsForControlEvents:UIControlEventTouchUpInside];
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:09:20.953

只需执行以下操作

声明属性

```
@property(nonatomic,weak) int newX;
@property(nonatomic,weak) int newY;

-(void) accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration
{
...
    self.newX = (int)(Button.center.x + valueX);
    self.newY = (int)(Button.center.y + valueY);
...

}

-(IBAction)clicked:(id)sender

{
   randX = arc4random() % 320;
   randY = arc4random() % 548;

   CGPoint randNewPlace = CGPointMake(randX, randY);
   Rand.center = randNewPlace;

   if (self.newX == randX || self.newY  == randY)
   {
      [Rand sendActionsForControlEvents:UIControlEventTouchUpInside];
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:13:54.067

如果您想定义一个不变的常量变量，请在 .h 和 .m 中定义它

例如，如果我想在我的 .h 中将黑色定义为十六进制字符串，我将其放在**@interface**上方。

```
// Default Black
extern NSString * const Black; 
```

* * *

然后在我的.m 上面**@implementation**

```
// Default Black
NSString * const Black      = @"0xFF000000"; 
```

每当我调用变量**Black**时，就会出现**0xFF000000** 当然你可以定义任何类型的变量，它不必是 NSString。`extern`只是将变量暴露给应用程序的其余部分。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:07:52.397

@property (nonatomic) int newX,newY;

要访问它们，只需实例化类，然后使用点表示法。类.newX

# web-services - 如何知道 GlassFish 中哪个 Web 服务方法引发了异常？

> ID：15666080
> 
> 赞同：2
> 
> 时间：2013-03-27T18:00:52.483
> 
> 标签：web-services, jakarta-ee, glassfish, glassfish-3

日志文件中出现以下错误消息。我的 Web 服务发布了许多方法，并且此堆栈跟踪未显示发生此异常时调用了哪个方法。有太多的客户在使用这个 Web 服务，我无法告诉他们他们发送的内容类型不正确，以及他们使用的具体方法。

是否可以以某种方式配置 GlassFish，以便我知道在引发此异常时调用了哪些 Web 服务方法？

```
[#|2013-03-27T14:13:20.910-0300|SEVERE|glassfish3.1.2|com.sun.xml.ws.transport.http.HttpAdapter|_ThreadID=27;_ThreadName=Thread-2;|Unsupported Content-Type: text/xml; charset="utf-8" Supported ones are: [application/soap+xml]
com.sun.xml.ws.server.UnsupportedMediaException: Unsupported Content-Type: text/xml; charset="utf-8" Supported ones are: [application/soap+xml]
at com.sun.xml.ws.encoding.StreamSOAPCodec.decode(StreamSOAPCodec.java:315)
at com.sun.xml.ws.encoding.StreamSOAP12Codec.decode(StreamSOAP12Codec.java:102)
at com.sun.xml.ws.encoding.StreamSOAPCodec.decode(StreamSOAPCodec.java:149)
at com.sun.xml.ws.encoding.SOAPBindingCodec.decode(SOAPBindingCodec.java:361)
at com.sun.xml.ws.transport.http.HttpAdapter.decodePacket(HttpAdapter.java:343)
at com.sun.xml.ws.transport.http.HttpAdapter.access$400(HttpAdapter.java:99)
at com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:623)
at com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:263)
at com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:163)
at org.glassfish.webservices.JAXWSServlet.doPost(JAXWSServlet.java:145)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:688)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)
|#] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-08T15:27:46.993

实际上是“调用了什么 WS 方法？”这个问题的答案。是“无”。发生此异常时，尚未调用任何 Web 服务方法（在服务器端），因为它在尝试解析请求时事先失败了。

关于您关于将“?wsdl”附加到服务参数的评论：“xxx/CentralWebService”可能是指您的*服务端点*，而“xxx/CentralWebService?wsdl”为您提供*WSDL*。通过将“?wsdl”附加到服务端点来获取 WSDL 的常见约定，但它们是完全不同的东西。不要把它们混在一起。服务构造函数采用 WSDL-URL，从中提取服务端点。后者可以通过属性 BindingProvider.ENDPOINT_ADDRESS_PROPERTY 在端口上覆盖。

# android - 如何检测耳机功能

> ID：15666084
> 
> 赞同：6
> 
> 时间：2013-03-27T18:01:09.923
> 
> 标签：android, headset, android-audiomanager

我知道如何[检测耳机是否已插入，但某些耳机（例如三星](https://stackoverflow.com/a/6366238)[EHS60ANNBE ）](http://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_HEADSETHOOK)**仅**带有 PAUSE/PLAY（又名 KeyEvent.KEYCODE_HEADSETHOOK ）按钮，**没有**PREV/NEXT...

我希望能够检测当前插入 Android 设备的耳机是否具有 PREV/NEXT（又名 KeyEvent.KEYCODE_ [MEDIA_PREVIOUS](http://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_MEDIA_PREVIOUS) /KeyEvent.KEYCODE_ [MEDIA_NEXT](http://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_MEDIA_NEXT)）。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-04T17:49:25.210

你在使用广播接收器吗？我猜你是。

来自 Android 开发：

```
public void onReceive(Context context, Intent intent) {
    if (Intent.ACTION_MEDIA_BUTTON.equals(intent.getAction())) {
        //receive the key press event
        KeyEvent event = (KeyEvent)intent.getParcelableExtra(Intent.EXTRA_KEY_EVENT);
        //check the keypress
        if (KeyEvent.**** == event.getKeyCode()) {
            // Handle key press.
        }
    }
  }
} 
```

[*** * 带有各种按键代码的链接](http://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_MEDIA_PREVIOUS)

# java - 当一周从星期一开始时，如何获取给定日期的星期几？

> ID：15666086
> 
> 赞同：1
> 
> 时间：2013-03-27T18:01:15.773
> 
> 标签：java

日历 API 让我很困惑。我正在尝试做的事情似乎很简单，但似乎并不适合我。

我想将一周的第一天设置为星期一，而不是默认的星期日（我知道它因区域设置而异，但我想始终强制执行星期一）。最重要的是，对于给定的日期，我想检索它所代表的星期几（例如，1 代表星期一，7 代表星期日）。

有没有办法使用默认的日历 API 来做到这一点？我试过类似的东西：

```
Calendar cal = Calendar.getInstance();
cal.setFirstDayOfWeek(Calendar.MONDAY);
cal.setTime(<some Date object that's a monday>);
System.out.println(cal.get(Calendar.DAY_OF_WEEK)); 
```

它给了我 2，而不是 1。我怀疑这是因为它给了我 的值`Calendar.MONDAY`，但我不完全确定。基于这种怀疑，以下方法确实有效：

```
Calendar cal = Calendar.getInstance();
cal.setTime(<some Date object that's a monday>);
System.out.println(
    (cal.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY) ? 
        7 : cal.get(Calendar.DAY_OF_WEEK) - 1); 
```

...但我宁愿没有那个 if 语句。有没有办法用直接的日历 API 做我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:09:45.407

查看日历源，似乎 setFirstDayOfWeek 实际上只影响 WEEK_OF_MONTH 和 WEEK_OF_YEAR 计算。无论您的一周从哪一天开始，MONDAY 仍然是 MONDAY，并且在日历中 MONDAY 的值为 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:10:26.360

> 块引用

一周的第一天派生自当前语言环境。如果不设置日历的区域设置（Calendar.getInstance(Locale) 或 new GregorianCalendar(Locale)），它将使用系统的默认值。系统的默认值可以被 JVM 参数覆盖：

public static void main(String[] args) { Calendar c = new GregorianCalendar(); System.out.println(Locale.getDefault() + ":" + c.getFirstDayOfWeek()); }

这应该显示具有不同 JVM 参数的语言/国家/地区的不同输出：

```
-Duser.language=en -Duser.country=US -> en_US: 1 (Sunday)
-Duser.language=en -Duser.country=GB -> en_GB: 2 (Monday) 
```

不要忘记这也可能改变其他行为（u）r。

> 块引用

详细信息可以在以下链接中找到

[如何使用 JVM 参数为 java.util.Calendar 指定 firstDayOfWeek](https://stackoverflow.com/questions/269486/how-to-specify-firstdayofweek-for-java-util-calendar-using-a-jvm-argument)

# javascript - 为什么雅虎邮件无法识别使用带有转义字符的 mailto 链接？

> ID：15666087
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:01:13.820
> 
> 标签：javascript, yahoo, mailto, html-escape-characters, yahoo-mail

我创建了一个带有 mailto 链接的 html 页面。电子邮件的正文有转义字符（\'、\"、\n、\r），雅虎邮箱似乎都无法识别这些字符（当雅虎邮件设置为我的默认电子邮件时）。mailto 链接解析副本正文没有回车（\r）或换行（\n），当它到达单引号（\'）或双引号（\“）时，它会停止解析副本。我还没有在互联网上遇到任何解决此问题的方法。如果有人遇到此问题并有修复，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:02:39.210

mailto-link 是一个 URI，因此对其进行相应的编码。我认为要使用的正确功能是`encodeURIComponent`每个`value`.

所以：

```
var link = "mailto:john@doe.com?subject="
    + encodeURIComponent(subject) + "&body="
    + encodeURIComponent(body) 
```

# jquery - jQuery 附加到 jQuery 变量而不是 DOM 元素

> ID：15666092
> 
> 赞同：0
> 
> 时间：2013-03-27T18:01:23.807
> 
> 标签：jquery

是否可以附加到 jQuery 变量？

像这样`$($tnail).appendTo($collection);`

我需要优化代价高昂的 DOM 修改，并且想一次性完成。

像这样的东西：

```
 var $collection;

 $.each(items, function (i, item) {

        var $tnail = $("<div></div>");

        $($tnail).appendTo($collection);

    });

    $($collection).appendTo("#Container"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:04:04.100

是的！你只需要确保`$collection`是一个 jQuery 对象：

```
var $collection = $('<x/>');

$.each(items, function (i, item) {

    var $tnail = $("<div></div>");

    $tnail.appendTo($collection);

});

$($collection.html()).appendTo("#Container"); 
```

您还有 2 位在其中将 jQuery 对象包装在新的 jQuery 调用中：`$tnail`已经是 jQuery 包装的 div，因此它已经具有该`appendTo`方法。更多性能优势！

**编辑：**正如凯文指出的那样，你不能附加到一个空的 jQuery 对象。在内部，jQuery 使用空文档片段，但它不会通过它的 API 公开它。所以我改变了我的解决方案来创建一个虚拟元素，然后只将其*内容*附加到`#Container`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:07:32.027

您实际上并不想将元素附加到 $collection，而是要将它们添加到其中。

```
var $collection = $(); // must be a jquery object
$.each(items, function (i, item) {

    var $tnail = $("<div></div>");

    // add to collection
    $collection.add($tnail);

}); 
```

# jquery - 如何为不同的设备创建单独的按钮？

> ID：15666096
> 
> 赞同：1
> 
> 时间：2013-03-27T18:01:54.110
> 
> 标签：jquery, css, twitter-bootstrap, responsive-design

我一直在使用引导程序来创建响应式网站。我刚刚遇到了一个新场景，我不确定如何解决它。我有以下html代码：

```
 <!-- button color depending on desktop vs. phone -->
        <button class="btn visible-desktop" id="modifyVLANS">Modify VLANS</button>
        <button class="btn hidden-desktop lsm-visible-phone btn-warning" id="modifyVLANS">Modify VLANS</button> 
```

后来，我有以下jquery：

```
 //show list
    $('#modifyVLANS').click(function()  {
            do something.... 
```

但是，因为我有两个名称相同的按钮，所以在移动设备上，onclick 事件不会触发。我不想使用单独的事件处理程序创建两个单独的按钮......因为代码将完全相同。我怎样才能解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:12:16.747

我不会根据设备隐藏按钮，而是隐藏整个表单。在尝试`<input type="search">`为移动设备实现一种样式，为桌面实现另一种样式时，我遇到了同样的问题。

然后，将您的事件处理程序绑定到按钮`class`而不是`id`，因为即使其中一个按钮根据视图隐藏，您**仍然只能有一个元素，`id`每页**。

这是一个[简单的小提琴](http://jsfiddle.net/adamdehaven/pfbBY/)。

# php - 从插件向 wordpress 上的 MySQL 表添加数据时出错

> ID：15666097
> 
> 赞同：0
> 
> 时间：2013-03-27T18:01:56.293
> 
> 标签：php, mysql, wordpress

最近我开始制作一个 WordPress 插件，它可以与`MySQL`WordPress 中的数据库一起使用。但是，一些错误正在阻止我在这个主题上取得成功。实际上，我想在数据库上创建一个唯一表，该表只有用户名和密码才能登录该站点。

首先，我的插件会在插件管理面板的首次访问时在数据库上创建一个表。我已经在 SQL 上尝试过这段代码，它工作正常。

```
function jal_install() {
global $wpdb;
$table_name = $wpdb->prefix . "mydb"; // so the table name will be similar as: wp_mydb

$sql = "CREATE TABLE IF NOT EXISTS $table_name (
id INT( 10 ) NOT NULL AUTO_INCREMENT PRIMARY KEY ,
u_name VARCHAR( 100 ) NOT NULL ,
p_word VARCHAR( 100 ) NOT NULL ,
UNIQUE (
u_name
)
) ENGINE = MYISAM ;";

   require_once( ABSPATH . 'wp-admin/includes/upgrade.php' );
   dbDelta( $sql );

   add_option( "jal_db_version", $jal_db_version );
}
jal_install(); 
```

现在，插件的管理面板页面有一个通过 Excel 文件（.xls）上传数据的表单。我对这段代码使用了excel阅读器，它工作正常。首先，看代码：-

```
$path  = plugin_dir_path( __FILE__); 
$path .= 'upload'; 
$data = new Spreadsheet_Excel_Reader($path . "/" . $_FILES["xlsfile"]["name"]);
$rows_c = $data->rowcount($sheet_index=0);
$rows_c = $rows_c + 1;
$table_name = $wpdb->prefix . "mydb"; // it will look like -> wp_mydb with wp_ prefix
echo "<br />Data are added:-<br />";
for ($i = 1; $i < $rows_c; $i++) {
    $u1nam2e = $data->val($i,'A'); // Should be a username like: myuname, uname_1 etc.
    $p1wor2d = $data->val($i,'B'); // Should be a password like: mypword, asdfghjk!123 etc.
    echo "=>When username-><b>" . $u1nam2e . "</b> Then Password-><b>" . $p1wor2d . "</b>;<br />";
    $sql = "INSERT INTO excel_db (u_name,p_word) 
        VALUES ('$u1nam2e','$p1wor2d')";
    $wpdb->query($sql);
} 
```

当我在插件的管理页面上运行代码时，它会显示如下内容：-

> 致命错误：调用 C:\xampp\htdocs.......\my plugin's path\admin_panel.php 中非对象的成员函数 query() 第 XX 行

我看不到任何添加到数据库的数据。

现在，请任何人帮助我如何使用上面的代码在数据库中成功添加数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:47:36.837

我找到了我的答案。其实我得写

```
global $wpdb; 
```

调用 $wpdb 数组之前的代码。所以，代码将是： -

```
$path  = plugin_dir_path( __FILE__); 
$path .= 'upload'; 
$data = new Spreadsheet_Excel_Reader($path . "/" . $_FILES["xlsfile"]["name"]);
$rows_c = $data->rowcount($sheet_index=0);
$rows_c = $rows_c + 1;

$table_name = $wpdb->prefix . "mydb"; // it will look like -> wp_mydb with wp_ prefix
echo "<br />Data are added:-<br />";
global $wpdb;
for ($i = 1; $i < $rows_c; $i++) {
    $u1nam2e = $data->val($i,'A'); // Should be a username like: myuname, uname_1 etc.
    $p1wor2d = $data->val($i,'B'); // Should be a password like: mypword, asdfghjk!123 etc.
    echo "=>When username-><b>" . $u1nam2e . "</b> Then Password-><b>" . $p1wor2d . "</b>;<br />";
    $sql = "INSERT INTO excel_db (u_name,p_word) 
        VALUES ('$u1nam2e','$p1wor2d')";
    $wpdb->query($sql);
} 
```

# javascript - 使用 FetchXML 条件组合 RetrieveMultiple 查询

> ID：15666098
> 
> 赞同：0
> 
> 时间：2013-03-27T18:01:56.957
> 
> 标签：javascript, soap, dynamics-crm-2011

我在`MS CRM 2011`—中使用新的 OrganizationService 端点`/XRMServices/2011/Organization.svc`。

它似乎不支持旧`Fetch`命令。而且我发现我仍然可以`fetchXML`通过将查询传递给`RetrieveMultiple`方法来使用它。

在 C# 中，它看起来确实很简单：

```
string expression = @"<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false'>
<entity name='systemuser'>
<attribute name='businessunitid' />
<attribute name='systemuserid' />
<order attribute='businessunitid' descending='false' />
<filter type='and'>
<condition attribute='systemuserid' operator='eq-userid' />
</filter>
<link-entity name='businessunit' from='businessunitid' to='businessunitid' alias='ah'>
<attribute name='name' />
</link-entity>
</entity>
</fetch>";

FetchExpression fetch = new FetchExpression(expression);
// let's assume GetOrganisationService will return correct instance of IOrganizationService
IOrganizationService service = GetOrganisationService();
EntityCollection result = service.RetrieveMultiple(fetch); 
```

但我需要从 JavaScript 执行相同的操作。而且我不太确定在这种情况下如何编写正确的查询。

显然，这`fetchXML`需要以`SOAP`某种方式转换，但我刷遍了互联网和SDK，找不到如何去做。

我怎么能提出这样的要求：

```
<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false'>
<entity name='systemuser'>
<attribute name='businessunitid' />
<attribute name='systemuserid' />
<order attribute='businessunitid' descending='false' />
<filter type='and'>
<condition attribute='systemuserid' operator='eq-userid' />
</filter>
<link-entity name='businessunit' from='businessunitid' to='businessunitid' alias='ah'>
<attribute name='name' />
</link-entity>
</entity>
</fetch> 
```

在以下`SOAP`消息中？

```
<soap:Body>
<RetrieveMultiple xmlns='http://schemas.microsoft.com/crm/2007/WebServices'>
<query xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:QueryExpression'>

Some magic here

</RetrieveMultiple>
</soap:Body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:49:48.197

设置 c[所有 SOAP Retrieve multiple via SOAP from JavaScript](http://community.dynamics.com/crm/b/crmsoftwareblog/archive/2011/07/10/using-the-fetchxml-crm-2011-service-within-a-javascript-web-resource.aspx#.UVM-vhyfjIc)所需的代码相当冗长。

您的查询很简单...您不使用 OData 休息电话的任何原因？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T14:48:57.010

没有必要手工构建类似的东西。[有像XrmServiceToolkit](http://xrmservicetoolkit.codeplex.com/ "XrmService 工具包")这样的第三方库可以处理所有 SOAP 内容，并且只需要您提供实际的 FetchXml。结果将返回已解析为 JavaScript 对象。

# game-engine - 有哪些最适合创建策略/模拟游戏的平台？

> ID：15666103
> 
> 赞同：0
> 
> 时间：2013-03-27T18:02:08.457
> 
> 标签：game-engine, game-physics

我对策略/模拟游戏有一个精心策划的想法。但是，我不想使用“game-builder-package”来做到这一点，因为我认为这会限制我的能力，而且因为它们针对的是没有编程经验的人。你认为什么样的平台/语言适合这样的游戏？我想要图形，但它们可以是 2D 或基于 sprite 的。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T12:03:29.253

如果是 2d 游戏，那么现在我会选择 javascript/html5。您的游戏将在 Win8、android、facebook 上运行...

或者，即使我不是一个超级粉丝，这个也可以做得很好：[haxe 语言](http://haxe.org/)

# hibernate - @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW) 何时提交？- 跟进

> ID：15666104
> 
> 赞同：3
> 
> 时间：2013-03-27T18:02:09.190
> 
> 标签：hibernate, jakarta-ee, jboss, hsqldb, container-managed

请参阅此链接： [@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW) 何时提交？](https://stackoverflow.com/questions/11614364/when-does-transactionattributetransactionattributetype-requires-new-commit)

B怎么可能是正确答案？我认为使用 REQUIRES_NEW 注释的方法将在外部暂停事务继续之前提交。

我之所以问这个问题，是因为当涉及到从 for 循环中的另一个 bean 的 requires_new 开始的事务时，我看到了奇怪的行为。就像 Aby 在 for 循环中调用 bob 一样。如果其中一个事务由于例如 UniqueConstraintViolation 而回滚，则 HSQLDB 和 db2 也会间歇性地回滚先前的事务，并且间歇性地只有事务失败，并提交其他事务。只有当我重新启动我的 jboss 时，行为才会改变。当事务失败并且我得到前一个事务回滚的行为时，我还会得到一个 jdbcException: Connection closed in next call from the loop。所以，首先我想知道 requires_new 的预期行为。我正在使用 Hibernate、jboss 5、CMT、db2 和内存 HSQLDB（我已经尝试过 1.8 版本和 2.2.9）谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T10:25:00.047

所以我发现这是奇怪行为的原因

[jboss 重启后忽略 requires_new](https://stackoverflow.com/questions/15702602/jboss-ignores-requires-new-after-restart)

在链接中：

[@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW) 何时提交？](https://stackoverflow.com/questions/11614364/when-does-transactionattributetransactionattributetype-requires-new-commit)

替代 a 是正确答案，因此该帖子中的答案是错误的。

# android - 为 Android 应用程序安装 NewRelic 移动代理

> ID：15666106
> 
> 赞同：2
> 
> 时间：2013-03-27T18:02:16.170
> 
> 标签：android, newrelic

我正在尝试为 Android 应用安装 NewRelic 的移动代理。我按照他们的指示设置了 NEWRELIC_HOME（指向代理目录）和 ANDROID_HOME（指向 Android SDK 位置）。当我从应用程序目录运行 nrandroid-setup 时（如建议的那样），我收到以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/android/utils/ILogger
Caused by: java.lang.ClassNotFoundException: com.android.utils.ILogger
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: com.newrelic.agent.install.Main.  Program will exit.
error: java returned a non-zero status code 
```

我看过他们的安装视频，很简单，所以不知道为什么我的安装不起作用（唯一的区别，我在 64 位 Windows 7 下运行，他们使用的是 Mac）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T18:16:33.547

我想你可能已经用 New Relic 开了一张票，但在以前的情况下，这个问题是通过检查你的环境变量和更新 SDK 来解决的（我包括更新 New Relic 监控 SDK，但它不太可能是原因)

1) 验证您是否已声明 NEWRELIC_HOME 和 ANDROID_HOME，通常通过运行“导出”命令确保两者都已声明。然后确保您可以根据这些变量进行导航，并查看它们指向正确的位置。如果您仍然遇到问题，请在回复中包含“导出”的结果。

在 PowerShell 中使用`Get-ChildItem Env:`

在终端使用`export`

从 cmd 使用`SET`

2) 更新您的 Android SDK

要将 Eclipse 的 ADT 插件更新到最新版本，请执行以下步骤：

选择帮助 > 软件更新 > 查找并安装...。

选择搜索当前安装功能的更新，然后按完成。

如果有任何 ADT 更新可用，请选择并安装。

3) 确保您拥有最新版本的 New Relic for Mobile Apps for Android。

登录 rpm.newrelic.com 并转到移动设备>“查看说明”或“添加新的移动应用程序”，即可获得最新版本的 Android 代理

值得注意的是，我们的需求页面上没有列出 Android SDK，我们只是意识到这给一些用户带来了麻烦，我认为步骤 2) 将解决问题。一旦我们完成所有测试和验证，我还将根据该要求更新我们的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T21:11:17.557

基本上，托比所说的所有事情，也检查了你正在运行的 Java 版本。就我而言，我无法使用 java 1.6.0_32 构建，它仅在我升级到版本 1.7.0_13 时才有效

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T10:36:58.707

您必须更改您的 android sdk，这可能是因为您的 android sdk_> tools->sdklibs.jar 没有记录器类请更改最新的 sdk 我已经更改了 sdk 并解决了我的问题。

# java - 安卓应用程序错误5

> ID：15666111
> 
> 赞同：1
> 
> 时间：2013-03-27T18:02:22.140
> 
> 标签：java, android, eclipse, error-handling, eclipse-plugin

我尝试实现一个基于 rscm（中间件）的应用程序。当我尝试在模拟器上运行时，我收到下面列出的错误：

> 错误：03-27 16:58:20.490：E/Trace(1508)：打开跟踪文件时出错：没有这样的文件或目录 (2)
> 
> 03-27 21:53:21.610: D/AndroidRuntime(3803): 关闭 VM 03-27 21:53:21.610: W/dalvikvm(3803): threadid=1: 线程退出未捕获异常 (group=0x40a71930) 03 -27 21:53:21.760: E/AndroidRuntime(3803): 致命异常: main 03-27 21:53:21.760: E/AndroidRuntime(3803): java.lang.RuntimeException: 无法实例化活动 ComponentInfo{com.example .context_application/com.example.context_application.MyContextAwareActivity}：java.lang.ClassNotFoundException：在路径上找不到类“com.example.context_application.MyContextAwareActivity”：/data/app/com.example.context_application-2.apk 03 -27 21:53:21.760: E/AndroidRuntime(3803): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 android.app .ActivityThread。handleLaunchActivity(ActivityThread.java:2230) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 android.app.ActivityThread.access$600(ActivityThread.java:141) 03-27 21:53:21.760: E /AndroidRuntime(3803): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 android.os.Handler.dispatchMessage(Handler. java:99) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 android.os.Looper.loop(Looper.java:137) 03-27 21:53:21.760: E/AndroidRuntime(3803) : 在 android.app.ActivityThread.main(ActivityThread.java:5041) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 java.lang.reflect.Method.invokeNative(Native Method) 03-27 21 :53:21.760: E/AndroidRuntime(3803): 在 java.lang.reflect.Method.invoke(Method.java:511) 03-27 21:53:21.760: E/AndroidRuntime(3803):在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 com.android.internal.os.ZygoteInit.main( ZygoteInit.java:560) 03-27 21:53:21.760: E/AndroidRuntime(3803): at dalvik.system.NativeStart.main(Native Method) 03-27 21:53:21.760: E/AndroidRuntime(3803):引起：java.lang.ClassNotFoundException：在路径上找不到类“com.example.context_application.MyContextAwareActivity”：/data/app/com.example.context_application-2.apk 03-27 21:53:21.760: E /AndroidRuntime(3803): 在 dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 java.lang.ClassLoader.loadClass(ClassLoader.java: 501) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 java.lang.ClassLoader。loadClass(ClassLoader.java:461) 03-27 21:53:21.760: E/AndroidRuntime(3803): 在 android.app.Instrumentation.newActivity(Instrumentation.java:1054) 03-27 21:53:21.760: E/ AndroidRuntime(3803): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097) 03-27 21:53:21.760: E/AndroidRuntime(3803): ... 11 更多

任何人都可以帮忙吗？

```
package com.example.context;

import android.os.Bundle;
import android.widget.TextView;
import android.widget.Toast;
import org.aspectsense.rscm.ContextValue;
import org.aspectsense.rscm.context.client.ContextListenerActivity;
import org.json.JSONException;

import java.util.Date;

public class MyContextAwareActivity extends ContextListenerActivity
{
    @Override public String[] getRequestedScopes()
    {
        return new String[] { "battery.level" };
    }

    private TextView messageTextView;

    @Override protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        messageTextView = new TextView(this);
        setContentView(messageTextView);
        appendMessage("Activity created");
    }

    private void appendMessage(final String message)
    {
        final String currentMessage = messageTextView.getText().toString();
        messageTextView.setText(currentMessage + "\n" + message);
    }

    @Override public void onContextValueChanged(ContextValue contextValue)
    {
       try
        {
            appendMessage(new Date() + ": The battery level is " +         contextValue.getValueAsInteger() + "%");
        }
        catch (JSONException jsone)
        {
            Toast.makeText(this, "Error while displaying context event: " + contextValue, Toast.LENGTH_SHORT).show();
        }
    }
}

<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.context"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
  <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>  
    <application
        android:allowBackup="true"
       android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.context.MyContextAwareActivity"
            android:label="@string/app_name" >
            <intent-filter>
               <action android:name="android.intent.action.MAIN" />

               <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
       </activity>
   </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:35:55.930

您告诉它写入外部存储。你在eclipse中设置了SD卡吗？

这些答案有帮助吗？[打开跟踪文件时出错：没有这样的文件或目录 (2)](https://stackoverflow.com/questions/11446049/error-opening-trace-file-no-such-file-or-directory-2)

# java - java中是否有任何等效的实体框架？

> ID：15666112
> 
> 赞同：48
> 
> 时间：2013-03-27T18:02:24.477
> 
> 标签：java, .net

使用 C# 编程的每个人都知道有实体框架作为 ORM（对象关系映射器），它使程序员能够仅使用 C# 代码查询数据库。

例如，如果我有一个名为 的数据库`Shop`，并且在`Shop`我有表的数据库中，我可以通过以下方式获取价格低于 2 美元`Products`的表的所有产品：`Products`

```
ShopEntity _Db = new ShopEntity();
List<Product> products = _Db.Products.Where(p => p.Price < 2).ToList(); 
```

上面的代码等价于这条 SQL 语句：

```
Select * From Products Where Price < 2 
```

我想知道Java中有这样的框架吗？

我也看到了[quaere](https://stackoverflow.com/questions/1083080/what-are-the-java-equivalents-to-linq-and-entity-framework)。但它只是查询集合。我想查询数据库。java中有另一个框架叫做[Hibernate](http://hibernate.org)，它没有提供很好的数据库查询功能。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-03-27T18:03:56.403

Java 中的标准 ORM API 称为[JPA](http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html)，是 Java EE 规范的一部分。另一种选择是使用[Hibernate](http://hibernate.bluemars.net)。两者都提供自己的查询语言（分别为[JPQL](http://docs.oracle.com/html/E24396_01/ejb3_langref.html)和[HQL](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html)），但在 Java 下不存在像 LINQ 为 C# 那样提供语言级别的直接集成的查询框架。

# math - 找到给定旋转角度的旋转轴

> ID：15666115
> 
> 赞同：1
> 
> 时间：2013-03-27T18:02:34.320
> 
> 标签：math, opencv

我有一个围绕未知轴旋转 90 度的平面。我知道旋转前后平面的点和法线。如何找到旋转轴？

我做了一个草图来说明 - 它是 2D 但问题实际上是 3D。![问题的可怕草图。](../Images/0ac6765e34da88517ddff6dbaa9e64fe.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T02:58:31.560

我在@davin 的帮助下解决了这个问题。

使用叉积找到旋转轴的方向。平面上的两个已知点和旋转轴上的未知点组成一个等腰三角形，所以简单几何找到未知点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T22:34:12.680

旋转*轴*是旋转矩阵的特征向量。此外，它的特征值为 1。每个旋转矩阵都有这样一个特征向量。然后只需将平移应用于特征向量（假设您正在旋转然后平移）以获得最终的旋转轴。

在数学上，你需要解`Rv = v`，这相当于找到 的零空间`R-I`。

# c++ - 二叉树搜索和跟踪

> ID：15666117
> 
> 赞同：1
> 
> 时间：2013-03-27T18:02:34.647
> 
> 标签：c++, algorithm, binary-tree, huffman-code

我有一个包含整数和字符的节点二叉树。我正在研究霍夫曼编码，我想获得节点的二进制表示。'0' 被附加到每个左分支的字符串中，'1' 被附加到每个右分支。

我正在考虑搜索 char 但跟踪其分支，如果它不在左侧节点中，请删除附加到字符串的最后一个 '0' 并返回并检查右侧。这看起来非常有任务。我还有其他方法可以跟踪节点吗？

编辑：我必须使用二叉树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:19:25.920

您是在谈论对霍夫曼输出进行编码吗？

您需要为每个可能的输入字符构建输出代码和长度表 - 不要遍历每个输入字符的树。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:23:30.233

听起来像一个堆栈数据结构：

*   [维基百科](http://en.wikipedia.org/wiki/Stack_%28abstract_data_type%29)
*   [C++ 参考](http://en.cppreference.com/w/cpp/container/stack)

您可以通过以下方式使用堆栈来跟踪您在树中的位置：

*   路径 =`std::stack<int>`
*   向上移动到父级 ==`pop()`
*   移动到左孩子 ==`push(0)`
*   移动到右孩子 ==`push(1)`

编辑：

您可能希望实际使用`std::vector<int>`with `push_back`and`pop_back`来代替。它仍然表现得像一个堆栈，但如果你使用向量，你可以在最后得到整个 0 和 1 的列表。

# extjs - EXTJS 商店加载回调问题

> ID：15666122
> 
> 赞同：7
> 
> 时间：2013-03-27T18:02:41.983
> 
> 标签：extjs, extjs4.1

我按如下方式加载我的商店：

```
store.load({
    params: {
        paramMap
    },
    callback: function(records, options, success) {
        if (success) {
            var form = formPanel.getForm();
            var jsonStr = Ext.JSON.encode(records[0].raw);
            var jsonObj = Ext.JSON.decode(jsonStr);
            form.loadRecord(jsonObj);
        }
    }
}); 
```

问题是我只希望在第一次加载商店时触发这个回调。之后我想将其删除，这样当我再次重新加载或加载商店时，它就不会再次调用此回调。

任何想法，我尝试在选项配置中获取回调，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-27T18:14:31.787

不完全确定问题是什么。只有在商店加载回调时才会调用回调。

```
store.load({callback:myCallback});
//callback will be called
store.load();
//callback will not be called 
```

如果你只想做某事，你可能想使用一个设置为 true 的监听器。侦听器而不是回调是我的首选方式。

```
store.on('load', onStoreLoad, this, {single:true}); 
```

回调函数参数 api 与负载侦听器略有不同，请查看文档以查看。

# javascript - 自动生成具有绝对位置的左侧和顶部 css

> ID：15666132
> 
> 赞同：0
> 
> 时间：2013-03-27T18:03:16.497
> 
> 标签：javascript, jquery, html, css

以这些为例：

> [http://www.truedigital.co.uk](http://www.truedigital.co.uk)
> [http://www.tinsels.fr](http://www.tinsels.fr)
> [http://www.pinterest.com](http://www.pinterest.com)

在那里我看到每个帖子的一列框都整齐地定位，我尝试使用多种方式来做到这一点，但我制作的每个框列都不能与网站上的完全一样。

看起来他们使每个字段框都使用自动值和在每个框上使用绝对定位来制作 css left 和 top。使用 javascript / jquery 的可能性，是否有一个 javascript 的例子，比如他们用来使 css left 和 top auto 的值像网站上一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:30:53.923

无需重新发明轮子。

您正在寻找[砌体](http://masonry.desandro.com/)插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:11:57.167

这似乎是他们正在使用的：[jQuery Isotope](http://isotope.metafizzy.co/)。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:25:25.783

类似的东西：

```
i = 0;
columnwidth = 300;
$('.box').each(function(){
    i++;
    if ( i > 4 ){
        i = 1;
    }
    $(this).addClass('column-' + i);
    $(this).css('left', (i-1) * columnwidth + 'px');

    columnheight = 0;
    $('column-' + i).each(function(){
        columnheight += $(this).css('height');
    }

    $(this).css('height', columnheight + 'px');
}); 
```

**看这里：**

这是我离开办公室时匆匆忙忙的，它可能行不通。这应该让您了解您必须做什么才能达到您想要的效果。

# jquery - 单击它时，Div 没有正确向上滑动

> ID：15666133
> 
> 赞同：0
> 
> 时间：2013-03-27T18:03:19.063
> 
> 标签：jquery

我有一个 div 在单击按钮/链接后向上滑动，但它似乎先稍微向下移动然后备份，这使它看起来有点奇怪。单击按钮/链接时，它应该向上滑动而不先向下移动。

这是我正在使用的 jquery 代码：

```
 $(document).ready(function($){
    $('#hide_cookie').click(function() {
      $('.cookie').slideUp('slow', function() {
        // Animation complete.
      });
    });
}); 
```

这是html代码：

```
<div class="cookie">
    <div class="container_12">
        <span>header here</span>
        <p>tex there</p>
    </div>
    <div class="button">
       <a href="#" id="hide_cookie" class="read-more">Continue</a>
    </div>
</div> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:28:23.877

该元素需要具有高度属性。否则 jQuery 不会做一个流畅的动画。

### 阅读更多

> [基本的 jQuery slideUp 和 slideDown 让我发疯！](https://stackoverflow.com/questions/1092245/basic-jquery-slideup-and-slidedown-driving-me-mad)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:07:07.133

尝试`event.preventDefault()`

这里

```
 $('#hide_cookie').click(function(e) {
  e.preventDefault();
  $('.cookie').slideUp('slow', function() {
    // Animation complete.
  });
}); 
```

# asp.net - Gridview 中的分页不起作用 第二页数据不显示数据？

> ID：15666136
> 
> 赞同：5
> 
> 时间：2013-03-27T18:03:20.820
> 
> 标签：asp.net, gridview, paging

我的网格视图

```
<div style="margin-left: 280px">
   <asp:GridView ID="exportGrdVw" runat="server" BackColor="White"  
        AllowPaging="True" PageSize="3" 
        OnPageIndexChanging="exportGrdVw_PageIndexChanging" 
        onpageindexchanged="exportGrdVw_PageIndexChanged">
   </asp:GridView>
</div> 
```

我的代码

```
SqlConnection con = new SqlConnection("server=acer-Pc\\Sql;database=MYDB;trusted_connection=yes");  
//DataSet ds = new DataSet();
DataTable table = new DataTable();    
protected void Page_Load(object sender, EventArgs e)
{        
    if (!IsPostBack)
    {
        SqlDataAdapter da = new SqlDataAdapter("select customername,contactno,address from employee ", con);
        da.Fill(table);
        BindEmployee();
    }
 }
 public void BindEmployee()
 {
    exportGrdVw.DataSource = table;
    exportGrdVw.DataBind();
 }
 protected void exportGrdVw_PageIndexChanging(object sender, GridViewPageEventArgs e)
 {
    exportGrdVw.PageIndex = e.NewPageIndex;
    BindEmployee();
 } 
```

问题是 gridview 正在显示，但是当我单击第 2 页时。第 2 页数据未显示（空白）。请帮我解决这个问题。查看代码是否正确

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-28T15:29:11.533

像下面这样使用

```
SqlConnection con = new SqlConnection("server=acer-Pc\\Sql;database=MYDB;trusted_connection=yes");
//DataSet ds = new DataSet();
DataTable table = new DataTable();    
protected void Page_Load(object sender, EventArgs e)
{        
   if (!IsPostBack)
   {              
       BindEmployee();
   }
}
public void BindEmployee()
{
    SqlDataAdapter da = new SqlDataAdapter("select customername,contactno,address from employee ", con);
    da.Fill(table);
    exportGrdVw.DataSource = table;
    exportGrdVw.DataBind();
}
protected void exportGrdVw_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    exportGrdVw.PageIndex = e.NewPageIndex;
    BindEmployee();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T15:22:35.197

您的数据表在每次页面加载时都会被初始化，因此您需要在每次将其绑定到网格之前获取数据表。在将页面绑定到网格之前设置页面索引

所以你的代码应该是这样的

```
public void BindEmployee(int newPageIndex = -1)
{
    SqlDataAdapter da = new SqlDataAdapter("select customername,contactno,address from employee ", con);
    da.Fill(table);
    exportGrdVw.PageIndex = newPageIndex;
    exportGrdVw.DataSource = table;
    exportGrdVw.DataBind();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-15T18:59:48.667

无需在**exportGrdVw_PageIndexChanging**上调用数据库。只需将 DataTable 表声明为**静态**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-17T01:26:58.070

你可以试试这个：

```
GridView1.PageIndex = e.NewPageIndex;
SqlCommand cmd = new SqlCommand("Select * from Emp_Data ORDER BY [ID] DESC", con);

SqlDataAdapter DA1 = new SqlDataAdapter(cmd);
DA1.Fill(DT1);

GridView1.DataSource = DT1;
GridView1.DataBind(); 
```

# iphone - 将请求与响应相关联

> ID：15666137
> 
> 赞同：1
> 
> 时间：2013-03-27T18:03:23.260
> 
> 标签：iphone, ios, objective-c, httprequest, httpresponse

我有一个应用程序，我想在其中发出几个异步请求，然后在收到响应后刷新视图或类似的东西。如何确定响应与特定请求相关联？由于这是异步的，我不想维护 URL 的属性，因为会发出多个请求。

```
 [HttpRequestManager makeASynchronousRequest:url withTarget:self withSelector:@selector(receivedImageData:)];

    - (void) receivedImageData:(NSMutableData *) data
    {
        if (data) {
            UIImage *image = [[[UIImage alloc] initWithData:data] autorelease];

            NSString *path = [self savePngImage:image withLocalURL:**URL should be the one I created earlier**];
            if (path) {
                [self.delegate receivedImage:image];
            }
            else
           {
           }
        }
    } 
```

我可以在@selector(receivedImageData:) 中传递 URL 吗？

# javascript - 在 Javascript 中访问对象字面量

> ID：15666139
> 
> 赞同：0
> 
> 时间：2013-03-27T18:03:27.163
> 
> 标签：javascript, backbone.js, marionette

此代码是 Marionette 的示例：

```
AppLayout = Backbone.Marionette.Layout.extend(
{
    template: "#layout-template",

    regions: 
    {
        menu: "#menu",
        content: "#content"
    }
});

var layout = new AppLayout();

layout.menu.show(new MenuView());
layout.content.show(new MainContentView()); 
```

最后两行让我感到困惑。为什么不读：

```
layout.regions.menu.show(new MenuView());
layout.regions.content.show(new MainContentView()); 
```

有人可以解释为什么 layout.menu 有效而 layout.regions.menu 无效吗？

如果我想访问模板怎么办？那不是 layout.template 吗？模板和区域在布局内部的深度相同。

这是木偶代码中的构造函数：

```
// Ensure the regions are avialable when the `initialize` method
        // is called.
        constructor: function () {
            this._firstRender = true;
            this.initializeRegions();

            var args = Array.prototype.slice.apply(arguments);
            Marionette.ItemView.apply(this, args);
        }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:50:01.830

我相信它是这样实现的，因为“layout.menu”比“layout.regions.menu”更短更简单。看起来您希望将文字“#menu”替换为区域管理器对象。

您在创建视图时传入的选项，包括模板，可以在 layout.options 中找到。所以在你的情况下 layout.options.template 应该等于'#layout-template'，并且区域定义哈希将在 layout.options.regions... 仍然是同一级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:56:49.897

除非该示例有更多内容，否则您会像方法一样显示，否则它不会像您想象`Backbone.Marionette.Layout`的那样访问。`regions.menu`

仅使用您提供的代码，上面的代码实际上是创建一个`menu`属性，然后该属性具有一个`show`属性，因此您的`layout`对象实际上看起来像这样：

```
layout {
    menu : {
        show : new MenuView
    },
    content : {
         show : new MainContentView
    },

    template: "#layout-template",

    regions: 
    {
        menu: "#menu",
        content: "#content"
    }
} 
```

在 javascript 中，`(dot)`运算符可用于访问属性的属性，或者如果不存在具有该名称的属性，则它将创建该属性。

我不熟悉该`backbone.js`框架，但我的猜测是它们提供了跳过[属性查找链的一部分。](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)这意味着上面的内容最终会产生这个作为你的布局对象：

```
 layout {
    template: "#layout-template",

    regions: 
    {
        menu : {
            show : new MenuView
        },
        content : {
            show : new MainContentView
        }
    }
} 
```

但这又只是我的猜测，因为我不使用`backbone`.

您可以在此处了解有关[对象模型以及它如何与继承一起工作的更多信息。](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Details_of_the_Object_Model)

# asp.net - 如何向 ASP.Net MVC 中的角色添加第二个维度/轴？

> ID：15666141
> 
> 赞同：1
> 
> 时间：2013-03-27T18:03:35.847
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

我有一个需要角色和站点的 ASP.NET 应用程序。

简化示例：

站点 A：管理员、编辑、只读

站点 B：管理员、编辑、只读

站点 C：管理员、编辑、只读

内置的 ASP.NET 角色操作过滤器可以处理我们需要的一个维度，即角色，但它不考虑角色来自哪个站点。

```
[Authorize(Roles = "Admin, Editor")]
public ActionResult EditSiteStatus(int SiteId)
{
  // do work for this site
  // should only be done by Admins or Editors authorized for this site only.
} 
```

有没有办法为第二个维度/轴（站点）配置/扩展角色？每个站点都需要与原始站点相同的角色。

来自站点 B 的“编辑”不应该能够为站点 C 进行编辑，除非获得该权限。

（我担心这可能最终会陷入主观问题边缘的灰色地带，但我相信如果你对如何更好地用词提出建议，其中有一个对许多人有用的知识核心）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:17:41.627

你最好自己写`AuthorizeAttribute`来做到这一点，像这样：

用法：

```
[AuthorizeSiteLevel(SiteLevel = "A", Roles = "Admin, Editor")]
public ActionResult EditSiteStatus(int SiteId)
{
    // do work for this site
    // should only be done by Admins or Editors authorized for this site only.
} 
```

执行：

```
public class AuthorizeSiteLevelAttribute : FilterAttribute, IAuthorizationFilter
{
    protected List<string> Roles { get; private set; }
    protected string SiteLevel { get; private set; }
    protected AuthorizeUserAttribute(string siteLevel, params string[] roles)
    {
        SiteLevel = siteLevel;
        Roles = roles.ToList();
    }

    protected virtual bool Authorize()
    {
        //Authorize logic here, checking User.IsInRole for each of the Roles

        return authorized;
    }

    public void OnAuthorization(AuthorizationContext filterContext)
    {
        Controller = (BaseController)filterContext.Controller;

        if (!Authorize())
        {
            filterContext.Result = RedirectToAction("Index", "Home");
        }
    }        
} 
```

# node.js - 如何在 node.js 中的“require”之后删除模块？

> ID：15666144
> 
> 赞同：65
> 
> 时间：2013-03-27T18:03:37.693
> 
> 标签：node.js, module, require

比方说，在我需要一个模块并执行以下操作之后：

```
var b = require('./b.js');
--- do something with b --- 
```

然后我想带走模块b（即清理缓存）。我该怎么做？

原因是我想在不重新启动节点服务器的情况下动态加载/删除或更新模块。任何的想法？

-------- more -------- 根据删除require.cache的建议，它仍然不起作用......

```
what I did are few things:
1) delete require.cache[require.resolve('./b.js')];
2) loop for every require.cache's children and remove any child who is b.js
3) delete b 
```

但是，当我调用 b 时，它仍然存在！它仍然可以访问。除非我这样做：

```
b = {}; 
```

不确定这是否是处理该问题的好方法。因为如果以后，我需要 ('./b.js') 在 b.js 已被修改时再次。它需要旧的缓存 b.js（我试图删除）还是新的？

------------ 更多发现 --------------

行。我做了更多的测试和玩弄代码..这是我发现的：

```
1) delete require.cache[]  is essential.  Only if it is deleted, 
 then the next time I load a new b.js will take effect.
2) looping through require.cache[] and delete any entry in the 
 children with the full filename of b.js doesn't take any effect.  i.e.
u can delete or leave it.  However, I'm unsure if there is any side
effect.  I think it is a good idea to keep it clean and delete it if
there is no performance impact.
3) of course, assign b={} doesn't really necessary, but i think it is 
 useful to also keep it clean. 
```

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-03-27T18:07:45.917

您可以使用它来删除它在缓存中的条目：

```
delete require.cache[require.resolve('./b.js')] 
```

`require.resolve()`将找出 的完整路径`./b.js`，该路径用作缓存键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-16T09:22:24.520

最简单的方法之一（尽管在性能方面不是最好的，因为即使是不相关的模块的缓存也会被清除）是简单地清除缓存中的每个模块

请注意，清除`*.node`文件（本机模块）的缓存可能会导致未定义的行为，因此不受支持（[https://github.com/nodejs/node/commit/5c14d695d2c1f924cf06af6ae896027569993a5c](https://github.com/nodejs/node/commit/5c14d695d2c1f924cf06af6ae896027569993a5c)），因此需要一个 if 语句来确保那些不也不要从缓存中删除。

```
 for (const path in require.cache) {
      if (path.endsWith('.js')) { // only clear *.js, not *.node
        delete require.cache[path]
      }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-07-20T09:38:16.223

花了一些时间尝试在 Vuex 商店的 Jest 测试中清除缓存，但没有成功。似乎 Jest 有自己的机制，不需要手动调用来删除 require.cache。

```
beforeEach(() => {
  jest.resetModules();
}); 
```

和测试：

```
let store;

it("1", () => {
   process.env.something = true;
   store = require("@/src/store.index");
});

it("2", () => {
   process.env.something = false;
   store = require("@/src/store.index");
}); 
```

两个商店将是不同的模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-15T05:35:34.207

我发现这对客户端应用程序很有用。我想根据需要导入代码，然后在完成后将其垃圾收集。这似乎有效。我不确定缓存，但一旦不再引用并被删除，它应该会被垃圾`module`收集`CONTAINER.sayHello`。

```
/* my-module.js */

function sayHello { console.log("hello"); }

export { sayHello };

/* somewhere-else.js */

const CONTAINER = {};

import("my-module.js").then(module => {

  CONTAINER.sayHello = module.sayHello;

  CONTAINER.sayHello(); // hello

  delete CONTAINER.sayHello;

  console.log(CONTAINER.sayHello); // undefined

}); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-08-01T22:06:29.700

我发现处理使缓存失效的最简单方法实际上是重置暴露的缓存对象。从缓存中删除单个条目时，子依赖项的迭代变得有点麻烦。

```
require.cache = {};
```

# javascript - 允许在 div 内允许 dom 使用 javascript 附加到表

> ID：15666147
> 
> 赞同：0
> 
> 时间：2013-03-27T18:03:47.300
> 
> 标签：javascript, html, dom

我 ajax 获取包含在 div 框中的一堆表行，以附加到页面上的表中。但是`<tr/>`不是 的直接子代`<table/>`，而是`<div/>`从页面中删除的子代，并且只有 tr 内的内容存在。我想将 tr 保留在 dom 中，以便我可以追加到表中。

表格已经在页面上：

```
<table>
    <tr>
        <th> (title and Location here)</th>
        <th>Expires in </th> 
        <th>Views</th> 
    </tr>
</table> 
```

我想在页面上保留如下所示的 html，以便我应该使用 javascript 将 div 内的行（如下所示）附加到上表

```
<div>
    <tr>
         <td> a
         </td>
    </tr>
    <tr>
         <td> b
         </td>
    </tr>
</div> 
```

如何防止 tr 从页面中隐藏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:10:46.477

[HTML 表格行元素](https://developer.mozilla.org/en-US/docs/HTML/Element/tr)

> 允许的父元素： `A <table>, <thead>, <tbody> or <tfoot> element.`

将`<tr>`元素作为 a 的子元素`<div>`是无效的 HTML，因此浏览器将其删除。

此外，`<div>`直接在 a 内部`<table>`也是无效的。

要解决您的问题，请删除包装`<div>`，或`<tr>`在附加到`<table>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:14:36.813

只需在`<table>`中包含一个标签，并在需要时从其中`<div>`拉出s 。`<tr>`就此而言，你可以用 div 做的事情并不多，而你不能用`<table>`.

# ios - DynamoDB：提供的过滤器参数计数不支持尝试的过滤器操作

> ID：15666150
> 
> 赞同：4
> 
> 时间：2013-03-27T18:03:55.260
> 
> 标签：ios, amazon-web-services, amazon-dynamodb

我正在使用带有 Amazon Web Services 的 iOS SDK

我正在尝试使用以下代码发出扫描请求：

```
DynamoDBScanRequest *request = [[DynamoDBScanRequest alloc] initWithTableName:self.tableName];
DynamoDBCondition *condition = [[DynamoDBCondition alloc] init];
[condition setComparisonOperator:@"GT"];
NSString *key = [[alertView textFieldAtIndex:0] text];    //Returns NSString @"00610"

[request setScanFilterValue:condition forKey:key];

DynamoDBScanResponse *response = [self.dbClient scan:request]; 
```

我收到此错误：

> 提供的过滤器参数计数不支持尝试的过滤器操作

求大神帮忙解释一下是怎么回事！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T00:33:45.560

`AttributeValueList`条件需要根据条件名称为条件名称指定特定大小；此错误意味着您尝试使用`GT`（大于）错误数量的属性值。大于需要 1 个属性值，因此您可能提供 0 或 2。

以下是其他条件，以及它们所需的属性值数量：

```
NOT_NULL     0  (exists)
NULL         0  (not exists)
EQ           1  (equal) 
NE           1  (not equal)
IN           1  (exact matches)
LE           1  (less than or equal to)
LT           1  (less than)
GE           1  (greater than or equal to)
GT           1  (greater than)
CONTAINS     1  (substring or value in a set)
NOT_CONTAINS 1  (absence of a substring or absence of a value in a set)
BEGINS_WITH  1  (a substring prefix)
BETWEEN      2  (between) 
```

# java - ServletContextListener：这不是错误的用法吗？

> ID：15666155
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:05.007
> 
> 标签：java, multithreading, jakarta-ee, servlet-3.0

我正在阅读有关“Servlet 3.0 中的异步处理支持”的专家（？）教程（[http://www.javaworld.com/javaworld/jw-02-2009/jw-02-servlet3.html?page=2](http://www.javaworld.com/javaworld/jw-02-2009/jw-02-servlet3.html?page=2)） . 其中有以下代码片段：

```
@WebServlet(name="myServlet", urlPatterns={"/slowprocess"}, asyncSupported=true)
public class MyServlet extends HttpServlet {

    public void doGet(HttpServletRequest request, HttpServletResponse response) {
        AsyncContext aCtx = request.startAsync(request, response);
        ServletContext appScope = request.getServletContext();
        ((Queue<AsyncContext>)appScope.getAttribute("slowWebServiceJobQueue")).add(aCtx);
    }
}

@WebServletContextListener
public class SlowWebService implements ServletContextListener {

    public void contextInitialized(ServletContextEvent sce) {
        Queue<AsyncContext> jobQueue = new ConcurrentLinkedQueue<AsyncContext>();
        sce.getServletContext().setAttribute("slowWebServiceJobQueue", jobQueue);
        // pool size matching Web services capacity
        Executor executor = Executors.newFixedThreadPool(10);
        while(true)
        {
            if(!jobQueue.isEmpty())
            {
                final AsyncContext aCtx = jobQueue.poll();
                executor.execute(new Runnable(){
                    public void run() {
                        ServletRequest request = aCtx.getRequest();
                        // get parameteres
                        // invoke a Web service endpoint
                        // set results
                        aCtx.forward("/result.jsp");
                    }
                });
            }
        }
    }

    public void contextDestroyed(ServletContextEvent sce) {
    } 
```

}

因为，这是一篇专家“这是如何完成的”文章，我假设他们不会编写一些愚蠢的代码。但我无法接受在“contextInitialized()”中有一个“while(true)”循环。

1.  据我了解，此上下文侦听器线程永远不会退出“contextInitialized()”方法。对 ？
2.  我的应用程序中的任何其他 Servlet 会发生什么情况？他们可以免费服务请求吗？或者这是否会降低整个 servlet 容器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:23:49.623

1）我会改变代码如下：

```
@WebServletContextListener
public class SlowWebService implements ServletContextListener, Runnable {
    private volatile boolean running;
    ExecutorService executor;
    Thread runner;
    Queue<AsyncContext> jobQueue;

    public void contextInitialized(ServletContextEvent sce) {
        jobQueue = new ConcurrentLinkedQueue<AsyncContext>();
        sce.getServletContext().setAttribute("slowWebServiceJobQueue", jobQueue);
        // pool size matching Web services capacity
        executor = Executors.newFixedThreadPool(10);
        runner = new Thread(this);
        runner.start();
    }

    public void run() {
        running = true;
        while(running)
        {
            try {
                if(!jobQueue.isEmpty())
                {
                    final AsyncContext aCtx = jobQueue.poll();
                    executor.execute(new Runnable(){
                        public void run() {
                            ServletRequest request = aCtx.getRequest();
                            // get parameteres
                            // invoke a Web service endpoint
                            // set results
                            aCtx.forward("/result.jsp");
                        }
                    });
                }
            }
            catch (InterruptException e) {
            }
        }
    }

    public void contextDestroyed(ServletContextEvent sce) {
        running = false;
        runner.interrupt();
        executor.shutdown();
    }
} 
```

2) 其他 Servlet 不应该受到影响，只要它们具有不同的 urlPattern。

# asp.net - DeleteCommand 在 asp.net 2.0 中不起作用

> ID：15666156
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:14.040
> 
> 标签：asp.net, sql, sql-server, vb.net

我有以下 SqlDataSource：

```
<asp:SqlDataSource ID="LDetails" runat="server" ConnectionString="<%$ ConnectionStrings:NormCon %>"
    SelectCommand ="SELECT l.Link_ID,l.Link_Name,l.Link_Path,l.Link_Desc
                    FROM HyperLinks l
                    WHERE l.link_id = @Link_ID;"
    UpdateCommand ="UPDATE Hyperlinks SET Link_Name = @Link_Name, Link_Path = @Link_Path, Link_Desc = @Link_Desc WHERE Link_ID = @Link_ID;"
    DeleteCommand ="DELETE FROM Hyperlinks_Groups WHERE Join_Link = @Link_ID; DELETE FROM Hyperlinks WHERE Link_ID = @Link_ID;"
    <SelectParameters>
        <asp:ControlParameter Name="Link_ID" ControlID="linkList" PropertyName="SelectedDataKey.Value" />
    </SelectParameters>
    <UpdateParameters>
        <asp:Parameter Name="Link_Name" />
        <asp:Parameter Name="Link_Path" />
        <asp:Parameter Name="Link_Desc" />
        <asp:ControlParameter Name="Link_ID" ControlID="linkList" PropertyName="SelectedDataKey.Value" />
    </UpdateParameters>
    <DeleteParameters>
        <asp:ControlParameter Name="Link_ID" ControlID="linkList" PropertyName="SelectedDataKey.Value" />
    </DeleteParameters>
</asp:SqlDataSource> 
```

这是我的详细信息视图：

```
<asp:DetailsView ID="LinkDetails" runat="server" DataSourceID="LDetails" 
    DataKeyNames="Link_ID" AutoGenerateRows="False" OnItemDeleted="deleteLinkReload" >
    <Fields>
    <asp:BoundField DataField="Link_ID" />
        <asp:TemplateField HeaderText="Link Name">
            <ItemTemplate>
                <asp:Label ID="lblLinkName" runat="server" Text='<%# Bind("Link_Name") %>' />
            </ItemTemplate>
            <EditItemTemplate>
                <asp:TextBox ID="txtLinkName" runat="server" Text='<%# Bind("Link_Name") %>' MaxLength="50" /> 
            </EditItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Link">
            <ItemTemplate>
                <asp:HyperLink ID="lnkLinkPath" runat="server" Text='<%# Bind("Link_Path") %>' NavigateUrl='<%# Bind("Link_Path") %>' />
            </ItemTemplate>
            <EditItemTemplate>
                <asp:TextBox ID="txtLinkActual" runat="server" Text='<%# Bind("Link_Path") %>' MaxLength="250" /> 
            </EditItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Comment">
            <ItemTemplate>
                <asp:Label ID="lblLinkComment" runat="server" Text='<%# Bind("Link_Desc") %>' />
            </ItemTemplate>
            <EditItemTemplate>
                <asp:TextBox ID="txtLinkComment" runat="server" Text='<%# Bind("Link_Desc") %>' MaxLength="250" />
            </EditItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField ShowHeader="False">
            <ItemTemplate>
                <asp:LinkButton ID="linkDetailsEdit" runat="server" CommandName="edit" Text="Edit" />
                <asp:LinkButton ID="linkDetailsDelete" runat="server" OnClientClick="return confirm('OK to delete link?');" CommandName="Delete" Text="Delete Link" /> <%--OnClick="DeleteLink" --%>
            </ItemTemplate>
            <EditItemTemplate>
                <asp:LinkButton ID="linkDetailsAccept" runat="server" CommandName="update" Text="Accept" />
                <asp:LinkButton ID="linkDetailsCancel" runat="server" CommandName="Cancel" CausesValidation="false" Text="Cancel" />
            </EditItemTemplate>
        </asp:TemplateField>
    </Fields>
</asp:DetailsView> 
```

当我单击链接到此的详细信息视图中的删除按钮时，页面会刷新但该项目不会被删除。我认为 DeleteCommand 返回 0 行或出错，而我无法捕捉到错误。我已经尝试通过将 SQL 切换到此来查看它是否是 DeleteCommand 的情况：

```
 DeleteCommand ="INSERT INTO mis_test (string) VALUES ('Hi');" 
```

它仍然没有做任何事情。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:06:36.843

尝试使用 SQL Server Profiler 查看数据库上运行的内容以及它给出的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:12:29.887

我敢打赌，您的连接字符串包含`User Instance=true`and之类的内容`AttachDbFileName=...`，并且在运行 delete 命令后，您将通过 SSMS 或 Visual Studio（不是您的应用程序）进行连接并检查表。

如果是这种情况，那么您需要*停止*使用此`User Instance`功能（已弃用）。这样做是为连接的任何应用程序的每个实例创建数据库的副本。

您需要做的是将数据库正确附加到 SQL Server 的真实实例，并从所有应用程序连接到该数据库的副本。

# google-app-engine - 为什么我的 API 没有在部署时显示？

> ID：15666157
> 
> 赞同：4
> 
> 时间：2013-03-27T18:04:14.440
> 
> 标签：google-app-engine, google-cloud-endpoints

我怀疑这是由 Endpoints 中的以下错误（如果有效）引起的，但我也确信某处有解决方法。

[https://code.google.com/p/googleappengine/issues/detail?id=9050&can=4&colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log](https://code.google.com/p/googleappengine/issues/detail?id=9050&can=4&colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log)

重现步骤：

1.  更改 Endpoints 类中的方法名称、方法的 API 名称或参数列表。
2.  运行 endpoints.sh 脚本以生成 API 文件。
3.  在本地检查 API 文件并见证其中的更改。到现在为止还挺好。
4.  部署到服务器上应用的默认版本。
5.  检查日志以了解对 /_ah/spi/BackendService.getApiConfigs 的调用。没有错误！
6.  转到 API Explorer 并清除浏览器缓存。检查 API。变化不存在。
7.  直接在浏览器中请求 API 文件，例如。https://[app-id].appspot.com/_ah/api/discovery/v1/apis/[api-name]/v1/rpc 没有变化。

对上述情况感到沮丧，我决定完全从头开始使用新的应用程序 ID。我仍然在 API Explorer 中看不到任何 API，并且在上面的第 7 步中的 URL 上得到 404！

这是我的端点类：

```
@Api(name = "ditto", version = "v1")
public class CategoryEndpoint extends BaseEndpoint {

    @SuppressWarnings("unused")
    private static final Logger log = Logger.getLogger(CategoryEndpoint.class.getName());

    @ApiMethod(name = "category.list")
    public WireCategory list() {
        Category root = categoryDao.getRoot();
        WireCategory wireRootCategory = new WireCategory(root);

        return wireRootCategory;
    }

} 
```

这是生成的 .api 文件：

```
{
  "extends" : "thirdParty.api",
  "abstract" : false,
  "root" : "https://1.eliot-dev-uk-ditto-do.appspot.com/_ah/api",
  "name" : "ditto",
  "version" : "v1",
  "defaultVersion" : false,
  "adapter" : {
    "bns" : "https://1.eliot-dev-uk-ditto-do.appspot.com/_ah/spi",
    "deadline" : 10.0,
    "type" : "lily"
  },
  "auth" : {
    "allowCookieAuth" : false
  },
  "frontendLimits" : {
    "unregisteredUserQps" : -1,
    "unregisteredQps" : -1,
    "unregisteredDaily" : -1,
    "rules" : [ ]
  },
  "cacheControl" : {
    "type" : "no-cache",
    "maxAge" : 0
  },
  "methods" : {
    "ditto.category.list" : {
      "path" : "list",
      "httpMethod" : "GET",
      "scopes" : [ ],
      "audiences" : [ ],
      "clientIds" : [ ],
      "rosyMethod" : "ditto.api.CategoryEndpoint.list",
      "request" : {
        "body" : "empty"
      },
      "response" : {
        "body" : "autoTemplate(backendResponse)"
      }
    }
  },
  "descriptor" : {
    "schemas" : {
      "WireCategory" : {
        "id" : "WireCategory",
        "type" : "object",
        "properties" : {
          "webSafePath" : {
            "type" : "string"
          },
          "prettyPath" : {
            "type" : "string"
          },
          "children" : {
            "type" : "array",
            "items" : {
              "$ref" : "WireCategory"
            }
          },
          "path" : {
            "type" : "array",
            "items" : {
              "type" : "string"
            }
          },
          "name" : {
            "type" : "string"
          },
          "id" : {
            "type" : "string",
            "format" : "int64"
          }
        }
      }
    },
    "methods" : {
      "ditto.api.CategoryEndpoint.list" : {
        "response" : {
          "$ref" : "WireCategory"
        }
      }
    }
  }
} 
```

这个 URL 给了我一个 404，我希望在其中看到我的 API JSON：

[https://eliot-dev-uk-ditto-do.appspot.com/_ah/api/discovery/v1/apis/ditto/v1](https://eliot-dev-uk-ditto-do.appspot.com/_ah/api/discovery/v1/apis/ditto/v1)

这要死我了！

编辑：

这是我刚刚在 App Engine 1.7.5 和 1.7.6 生成的 .api 文件之间发现的差异。不知道为什么 URL 已更改。

```
ditto-v1.api from 1.7.6:

    {
      "extends" : "thirdParty.api",
      "abstract" : false,
      "root" : "https://1.eliot-dev-uk-ditto-do.appspot.com/_ah/api",
      "name" : "ditto",
      "version" : "v1",
      "defaultVersion" : false,
      "adapter" : {
        "bns" : "https://1.eliot-dev-uk-ditto-do.appspot.com/_ah/spi",
        "deadline" : 10.0,
        "type" : "lily"
      }
      ...

    ditto-v1.api from 1.7.5:

     {
      "extends" : "thirdParty.api",
      "abstract" : false,
      "root" : "https://eliot-dev-uk-ditto-do.appspot.com/_ah/api",
      "name" : "ditto",
      "version" : "v1",
      "defaultVersion" : false,
      "adapter" : {
        "bns" : "http://eliot-dev-uk-ditto-do.appspot.com/_ah/spi",
        "deadline" : 10.0,
        "type" : "lily"
      }
      ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T10:59:50.573

正如您已经指出的那样，这是由于 SDK 1.7.6 中的一个奇怪问题，它`1.`在 .api 文件中的端点根 url 的开头添加了这个问题......

我已经尝试过新的**SDK 1.7.7**，它似乎已经解决了......

# python - 如何使用“python setup.py develop”撤消/卸载本地模块设置或替换为“easy_install”？

> ID：15666158
> 
> 赞同：2
> 
> 时间：2013-03-27T18:04:17.360
> 
> 标签：python, distutils, easy-install

当我在处理模块 fork 时，我经常将 fork（正在进行中）添加到完整项目的 virtualenv 中以进行集成测试，使用

```
python setup.py develop 
```

（它会更新 easy_install.pth 以指向本地副本）

完成后，我想出如何清楚地摆脱它的唯一方法是从 easy_install.pth 中删除条目或编辑它以指向已安装的版本。

我也不能`easy_install --upgrade`，因为它意识到开发版本是最新的。

我认为 pip 可以强制升级，但随后它会尝试重新安装每个依赖项。

有没有人有很好的技术/策略来管理这类东西。我知道我在这里遗漏了一些明显的东西。

# facebook - 获取在照片中标记的我的朋友列表

> ID：15666162
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:28.503
> 
> 标签：facebook, subquery, facebook-fql, photo, photo-tagging

用户、事件和组都可以[在照片中标记](https://developers.facebook.com/docs/reference/fql/photo_tag)。在 photo_tag 的可用字段中，您无法区分哪个主题 ID 是用户、事件或组。我只想返回在照片中标记的朋友列表，忽略不是我朋友的事件、群组和用户。

有谁知道为什么这会返回 0 个结果？

```
SELECT subject, xcoord, ycoord, text
FROM photo_tag
WHERE object_id = [PHOTO_OBJECT_ID] 
AND subject IN (SELECT uid2 FROM friend WHERE uid1 = me()) 
```

虽然...

```
SELECT subject, xcoord, ycoord, text
FROM photo_tag
WHERE object_id = [PHOTO_OBJECT_ID] 
```

返回一个用户列表，其中包括我的朋友，由...验证

```
SELECT uid2 FROM friend where uid1 = me() and uid2 = [SUBJECT_USER_ID] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T12:25:53.337

显然这是“设计使然”！

脸书的回应：

> 这是设计使然，在获得主题列表后，您可以查询用户表以查看该主题是否是用户。

[https://developers.facebook.com/bugs/549553255066877](https://developers.facebook.com/bugs/549553255066877)

# javascript - 如果未定义元素，document.getelementbyId 将返回 null？

> ID：15666163
> 
> 赞同：47
> 
> 时间：2013-03-27T18:04:30.947
> 
> 标签：javascript, domdocument

在我的代码中，我看到了这个：

```
if (document.getElementById('xx') !=null) {
    //do stuff
} 
```

如果`xx`未定义元素，这将评估为真还是假？

我应该写：

```
if (document.getElementById('xx')) 
```

为了安全？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-03-27T18:07:34.540

```
console.log(document.getElementById('xx') ) evaluates to null.

document.getElementById('xx') !=null evaluates to false 
```

你应该使用`document.getElementById('xx') !== null`它，因为它是一个更强的平等检查。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-03-27T18:11:06.790

`getElementById`由[DOM Level 1 HTML](http://www.w3.org/TR/REC-DOM-Level-1/level-one-html.html#method-getElementById)定义为在没有元素匹配的情况下返回`null`。

`!==null`是检查的最明确的形式，并且可能是最好的，但是没有可以返回的非`null`虚假值`getElementById`- 您只能获取`null`或始终真实的 Element 对象。所以这里没有实际的区别`!==null`，`!=null`或者更宽松的`if (document.getElementById('xx'))`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-27T18:08:32.447

是的，如果它不存在，它将返回 null 你可以在下面的演示中尝试这个。两者都将返回 true。第一个元素存在，第二个元素不存在。

[**演示**](http://jsfiddle.net/rBLVz/1/)

**html**

```
<div id="xx"></div> 
```

**Javascript：**

```
 if (document.getElementById('xx') !=null) 
     console.log('it exists!');

   if (document.getElementById('xxThisisNotAnElementOnThePage') ==null) 
     console.log('does not exist!'); 
```

# ios - ios应用中购物车的管理

> ID：15666165
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:38.180
> 
> 标签：ios, shopping-cart

我正在使用购物车实现 iOS 应用程序。用JSON把所有数据发送到服务器后，但是当用户填写购物车时我可以存储数据吗？我必须使用 PList 还是在应用程序中构建本地数据库类型 SQlite？你有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:45:49.067

如果数据需要实时而不是在启动时持久化，请将其存储在一个数组（NSArray 或 NSMutableArray）中，很可能是可变数组。用户完成后，根据需要构建它并通过 JSON 发送。

如果您需要跨启动存储，请使用 Coredata。 [https://www.youtube.com/watch?v=mEAav7dM4hk](https://www.youtube.com/watch?v=mEAav7dM4hk)

Plist 不是为了这个...

# ruby-on-rails - 每次都必须重新启动瘦服务器（使用 SSL）才能正常触发 Ruby Debugger？

> ID：15666166
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:38.380
> 
> 标签：ruby-on-rails, ruby-debug

我在我正在处理的项目中安装了调试器 gem。他们正在使用带有 ssl 的瘦服务器。当我在代码中放入调试器时，它不会触发，直到我重新启动服务器。然后如果我删除一个调试器，它不会消失，直到我重新启动服务器。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:07:42.587

这取决于您放置调试器的位置。Rails 配置为`/app`在每个请求上重新加载所有内容。如果您在`debugger`那里拨打电话，那么它将在每次请求时重新加载。

否则，如果您将其放在其他地方，例如 in `lib`，则不会。

此外，您可能希望将调试器与自动化测试结合使用，而不是浏览器测试。它将使测试更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:21:01.863

为了使用瘦调试器，您需要使用 --debugger 提示符启动 rails 服务器

```
 rails s --debugger 
```

每当服务器遇到调试器语句时，rails 服务器连接到调试控制台。在这种情况下，不会提供其他请求。当您通过 continue 语句完成调试或没有断点时，服务器开始正常运行，直到再次遇到调试器语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:53:57.723

使用此命令修复它：

```
thin --ssl --debug start 
```

# php - PHP array_rand 总是返回相同的

> ID：15666167
> 
> 赞同：0
> 
> 时间：2013-03-27T18:04:38.643
> 
> 标签：php, multidimensional-array

我已经研究了很多这个问题，但还没有找到合适的解决方案。

我所拥有的是一些使用专辑封面的图像，当您单击它们时，我希望从专辑中随机抽取一首歌曲。专辑是01-05，封面图片在里面。单击时，他们调用`song = "<?php echo (random_song("album_number")); ?>";`它，然后将其嵌入带有 id 的 div 中`#player`。

PHP：

```
<?php
 function random_song($dir) {
  $files = array (
   (array) glob('01/*.mp3'),
   (array) glob('02/*.mp3'),
   (array) glob('03/*.mp3'),
   (array) glob('04/*.mp3'),
   (array) glob('05/*.mp3')
  );

  $set = substr($dir,0,2) - 1;
  shuffle($files[$set]);
  $key = array_rand($files[$set]);
  $file = $files[$set][$key];
  return $file;
 }
?> 
```

到目前为止，我已经让它播放了一首歌曲；但是，它从不选择另一首歌曲。如果我点击一张专辑，它会选择一首歌；单击第二个，它将播放一首歌曲。单击第一个，它会播放同一首歌曲。

`shuffle()`如您所见，我已尝试添加，但并没有什么不同。我还`var_dump()`对每个部分进行了`$files`检查以确保其`glob()`正常工作；没有问题。

我被困住了。我需要做什么？

* * *

**解决方案：**

Fritz van Campen 所说的是正确的：php 只被调用一次。它被写入`<script>`并在解析后立即调用，因此每张专辑只调用它最初编码的歌曲。正如他所建议的，我需要做的是将歌曲选择器移至 JavaScript。我的解决方案：

```
var songs = <?php echo json_encode($files); ?>;
...
var set = parseInt(dir.substr(0,2))-1;
var song = songs[set][Math.floor(Math.random() * songs[set].length)]; 
```

...它将由 php 创建的数组传输到 JavaScript，并使用相同的系统来选择一首随机歌曲。

谢谢你的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:07:00.367

您只要求 PHP 选择一次随机值。你使用的另一种语言是什么，JavaScript？如果是这样，请将随机歌曲选择器移至 JavaScript。

PHP 在服务器上运行。JavaScript 在浏览器中运行。一旦服务器返回 HTML 页面，PHP 就完成了，不会再次运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:00:04.893

**解决方案 1 = 服务器端**

我假设单击专辑会发送一个新页面的新查询，其中包含您单击的专辑中的随机歌曲。我还假设您有一个树结构，例如：

```
Albums/
  01/
    Track01.mp3
    Track02.mp3
    Track03.mp3
    ...
  02/
  03/
  ... 
```

我会让链接包含专辑的专辑编号并将其传递给 $dir。然后只需 glob 该目录。一旦我有了一个文件名数组，我就使用 array_rand 来提取一个随机文件名。

```
<?php
  function random_song($dir) {
    $root = "Albums/"
    if(is_dir($root.$dir)){
      $songs = glob($root.$dir.'/*.mp3');
      return $root.$dir.array_rand($songs);
    }
    //Error
  }
?> 
```

**解决方案 2 - 客户端** 如果每次单击专辑图片时页面都没有重新加载，我会在专辑图片 div 中包含一个 ul，`display:none;`每个 li 中都有每首歌曲的路径。然后，当单击专辑 div 时，我将使用 JQuery 选择一个随机子 li（[此处为示例](https://stackoverflow.com/questions/1764160/select-5-random-elements)）并读取 li 的内容并将该字符串传递给播放器。

# r - 根据周围的行值对数据框进行子集化

> ID：15666168
> 
> 赞同：3
> 
> 时间：2013-03-27T18:04:42.103
> 
> 标签：r, for-loop, indexing, subset

我正在分析收集的有关鸟类行为的数据，并想计算海鸟在觅食潜水（潜入水下追鱼）之间游荡（否则被认为是休息）时停留在水面上的时间。目前数据就是这种形式。

```
structure(list(alt_id = c(10L, 10L, 12L, 12L, 12L, 12L, 13L, 
13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 2L, 2L, 2L, 2L), 
    act = c("l", "d", "l", "d", "l", "d", "l", "d", "l", "d", 
    "l", "d", "l", "d", "l", "d", "l", "d", "l", "d"), action_time = c("15", 
    "0", "5", "24", "10", "0", "43", "28", "16", "37", "9", "35", 
    "15", "34", "11", "0", "12", "33", "15", "33")), .Names = c("alt_id", 
"act", "action_time"), row.names = c(NA, 20L), class = "data.frame") 
```

该数据子集包含 4 个不同个体的行为信息（由唯一 ID 号索引）。我需要首先评估数据框，以便我只考虑个体鸟类的行为。为此，我需要确保我正在考虑的行正下方的 ID 号是相同的。然后我需要隔离小鸟闲逛的时间（在数据库中用“l”表示）。然后我想确保它在游荡期前后都下降（用“d”表示）。通过这样做，我确保我不会将鸟只是愉快地漂浮在水面上的时间算作潜水之间的游荡时间，因为它们可能会在它们吃饱后一次数小时这样做。

理想情况下，这将在 for 循环或其他表达式中运行，允许我一次运行所有 4,000 多行数据，创建一个懒散 (l) 次向量，然后我可以使用它来计算平均值、sd 等。

关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:48:40.417

我们称这些数据为“loafers”。如果这不是“由鸟”完成的，您将丢弃第一行和最后一行，因为无法确定它们的前任和继任者并执行以下操作：

```
dtest <- function(dfrm) dfrm[c(FALSE, 
                               dfrm$act [2:(nrow(dfrm)-1)] =="l" &
                               dfrm[ 1:(nrow(dfrm)-2), "act"] =="d" &
                               dfrm[ 3:(nrow(dfrm)), "act"] =="d" ,
                               FALSE) , ] 
```

应用到完整的数据并再次抛出bird中的第一行和最后一行：

```
lapply( split(loafers, loafers$alt_id), dtest)
$`2`
   alt_id act action_time
19      2   l          15

$`10`
[1] alt_id      act         action_time
<0 rows> (or 0-length row.names)

$`12`
  alt_id act action_time
5     12   l          10

$`13`
   alt_id act action_time
9      13   l          16
11     13   l           9
13     13   l          15
15     13   l          11 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T21:43:44.247

尽管 DWin 回答了我提出的问题，但我继续沿着我在回答之前的路径（以及如何构建 for 循环的一些技巧）并提出了这个问题。这个向量比原始数据集少一个观察值，但是在添加一个 FALSE 之后，它可以被附加并用于子集，因为这只是更大问题的一小部分。我正在使用的较大数据框称为“土地”

```
rest <- function(x)
{
    output <- vector(length=NROW(x$alt_id)-1)
    for(i in 2:(length(x$alt_id)-1))
    {
    if(x$alt_id[i]==x$alt_id[i+1] &&
    x$alt_id[i]==x$alt_id[i-1] &&
    x$act[i]=="l" &&
    x$act[i+1]=="d" &&
    x$act[i-1]=="d")
        {
        output[i] <- "TRUE"
        }
        else
        {
        output[i] <- "FALSE"
        }
    }
    return(output)
}

resting <- rest(land)
resting <- append(resting,"FALSE")
land <- cbind(resting, land) 
```

代码的第二行只是向向量添加了一个 FALSE，因为该行没有被评估，但问题的性质不能是休息时间。最后一行将新向量“resting”附加到原始数据库中。

# python - python + pymongo：如何从 for 循环中在 mongo 中的现有文档上插入新字段

> ID：15666169
> 
> 赞同：21
> 
> 时间：2013-03-27T18:04:51.980
> 
> 标签：python, mongodb, insert, pymongo

我在 python 中使用 for 循环来循环使用 pymongo 的查询结果。这是代码：

```
from pymongo import MongoClient
connection = MongoClient()
db = connection.Test

myDocs = db.Docs.find( { "geolocCountry" : { "$exists" : False } } )

for b in myDrives:
    my_lat = b['TheGpsLog'][0]['latitude']
    my_long = b['TheGpsLog'][0]['longitude']

    myGeolocCountry = DoReverseGeocode(lat_start,long_start) 
    #    Here I perform a reverse geocoding, it does not matter for this example. 
    #    The important thing is: it returns a string, like 'US', 'UK', etc... 
```

我的问题是，如何将变量插入到现有文档（）上`myGeolocCountry`的非现有字段中？`geolocCountry``b`

我试过了

```
b['geolocCountry'] = myGeolocCountry 
```

但它根本不起作用，它甚至不会产生错误。

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-27T18:11:15.210

您应该像这样执行更新查询：

```
db.Doc.update({"_id": b["_id"]}, {"$set": {"geolocCountry": myGeolocCountry}}) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-12-03T13:48:14.033

对于**pymongo > 3**

```
db.Doc.update_one({"_id": b["_id"]}, {"$set": {"geolocCountry": myGeolocCountry}}) 
```

在多次更新的情况下：

```
db.Doc.update_many({"geolocCountry": {"$exists": False}}, {"$set": {"geolocCountry": myGeolocCountry}}) 
```

对于**pymongo < 3**

以上/以前的答案是正确的

```
db.Doc.update({"_id": b["_id"]}, {"$set": {"geolocCountry": myGeolocCountry}}) 
```

在多次更新的情况下：

```
db.Doc.update({"geolocCountry": {"$exists": False}}, {"$set": {"geolocCountry": myGeolocCountry}}) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-27T18:12:08.107

您必须使用该功能[`update()`](http://api.mongodb.org/python/current/api/pymongo/collection.html#pymongo.collection.Collection.update)才能更新集合中的记录。

使用 update 您可以指定一个查询（就像您在上面所做的一样，`collection.find()`但还提供了第二个字典，用于定义您希望如何更新在查询中找到的文档。例如：

```
db.Docs.update({"geolocCountry":{"$exists":False}}, {"$set": "geolocCountry": myGeolocCountry}) 
```

查看 API 以了解其余参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-18T23:02:33.033

您需要在更新后保存集合。

```
for b in myDrives:
    my_lat = b['TheGpsLog'][0]['latitude']
    my_long = b['TheGpsLog'][0]['longitude']

    myGeolocCountry = DoReverseGeocode(lat_start,long_start)

    b['geolocCountry'] = myGeolocCountry
    **db.Docs.save(b)** 
```

# c# - 非静态回调如何从本机代码工作？

> ID：15666173
> 
> 赞同：5
> 
> 时间：2013-03-27T18:04:59.003
> 
> 标签：c#, c++, callback, thunk

问这个问题有点奇怪，因为我的代码似乎不应该工作，但它确实有效，虽然我没有抱怨，但我想确认为什么？哈哈

简单地说，我有一个 C++ 本机 DLL（根本没有 CLR/托管支持），它从 C# 代码中获取回调。native 端存储一个 stdcall 回调函数，由 C# 端提供。我一直认为回调方法（在 C# 中）必须是静态的，但非静态和 lambda 表达式都可以正常工作！？如何从本机代码封送“this”指针？我一直以为原生代码只存储非实例函数指针？

现在，我确实找到了一篇文章，其中有人发出 IL 代码以在本机和非静态托管回调之间“架起”桥梁。我还注意到了这种贬值的方法：“Marshal.GetUnmanagedThunkForManagedMethodPtr()”。该方法不再受支持，我假设这意味着它是内置的？

问题总结：

1.  thunking 现在是通过发出 IL 代码在 .NET 中内置的吗？如果是这样，它在哪个版本的 .NET 中成为本机支持的？

2.  Mono 是否也支持隐式“thunking”？

3.  当为托管回调发出 IL 时，当 thunk 引用的实例被删除时会发生什么？IL 是否被删除，或者这可能会导致内存“泄漏”？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:17:21.917

> thunking 现在是通过发出 IL 代码在 .NET 中内置的吗？如果是这样，它在哪个版本的 .NET 中成为本机支持的？

thunk 中不涉及 IL，它是通过发出本机代码来发生的——一个重新排列参数以满足 .NET 调用约定的蹦床，包括在`this`关闭委托的情况下保存的指针，然后对 .NET 执行尾调用方法本身。

> Mono 是否也支持隐式“thunking”？

这称为“反向 p/invoke”，应该可以在 Mono 文档中轻松查找。

> 当为托管回调发出 IL 时，当 thunk 引用的实例被删除时会发生什么？

当委托被垃圾回收时，蹦床使用的内存也被释放。因此，只要本机代码具有指向蹦床的指针，您就需要让委托保持活动状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:15:34.900

互操作编组器只是编组一个代表。委托可以是类委托（没有`this`）或实例委托（有`this`）。从 C# 的角度来看，它只是调用一个委托。即`this`有效地使用了用于管理实例委托的相同语义（例如，类实例的解耦）。

很明显，还有其他事情（如钉住等）在幕后发生了更多事情——但它们通常与你所问的无关。

# css - 可拉伸的 DIV 问题

> ID：15666178
> 
> 赞同：0
> 
> 时间：2013-03-27T18:05:04.980
> 
> 标签：css, css-float

我目前正在处理此[页面](http://newbarter.siteprogression.com/benefits-of-barter/)，但包含在给定页面上看到的溢出文本的 DIV 不会拉伸以包含文本，除非高度从“自动”更改为固定的“高度”CSS如图所示以下：

```
.single #intro {
    width: 100%;
    height: auto;
    position:relative;
    float: left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:11:10.910

如果你想让它伸展，那么你有多个位置 height: 需要简单地删除。

那是...

这里：（第 349 行）

```
#rack #main #intro #content-area {
    float: left;
    height: 370px;
    width: 750px;
    padding: 20px 30px 10px 30px;
} 
```

在这里：（第 117 行）

```
#rack #main #intro {
    width: 100%;
    height: 400px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:07:30.490

您可以使用该`overflow`属性来显示滚动条，如下所示：

```
#rack #main #intro {
    width: 100%;
    height: 400px;
    overflow: auto;
} 
```

这样你可以保持高度，但仍然显示所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:25:12.140

您的问题在于使用 float 属性后的页脚 div，下一个元素只是认为它应该在导航栏之后定位它只需使用

```
<div style="clear:both"></div> 
```

或将 clear:both 属性放在内容区域 div 的末尾或页脚 div 的开头

[您可能需要浮动：正确的内容区域才能正常工作]

# qt - 使用 Qt 的独立于平台的屏幕保护程序

> ID：15666184
> 
> 赞同：4
> 
> 时间：2013-03-27T18:05:27.977
> 
> 标签：qt, screensaver

有没有人尝试过使用 Qt 的独立于平台的屏幕保护程序。我的目标系统是 Win 和 Mac，在进一步挖掘之前，我想知道是否可以不用过多摆弄本机调用……谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-09T18:56:33.323

*Andi Peredri在 2004 年* [写了一篇](http://qt.osdn.org.ua/screensaver.en.html)关于使用 Qt 3.2 构建**QStars**为 KDE 开发屏幕保护程序的文章。

![在此处输入图像描述](../Images/ac83aebd01984d496fbc9c884cabce6a.png)

文章共享源代码，但文章中的链接已过时。最新版本[可在此处获得](http://qt.osdn.org.ua/qstars-0.4.tar.gz)（2005 年）。

# c# - 之前引入 SortDescriptions 时，CollectionViewSource 过滤器不起作用

> ID：15666190
> 
> 赞同：1
> 
> 时间：2013-03-27T18:05:58.263
> 
> 标签：c#, wpf, collectionviewsource

我定义了一个`CollectionViewSource`这样的，但似乎过滤器不起作用。

```
CollectionViewSource cvs = new CollectionViewSource();

//oc IS AN OBSERVABLE COLLECTION WITH SOME ITEMS OF TYPE MyClass
cvs.Source = oc;           

//IsSelected IS A bool? PROPERTY OF THE MyClass
cvs.View.Filter = new Predicate<object>(input=>(input as MyClass).IsSelected == true);

//Major IS AN string PROPERTY OF THE MyClass
cvs.SortDescriptions.Add(new SortDescription(
                           "Major", ListSortDirection.Ascending)); 
```

但是我以这种方式更改了代码，一切都解决了！

```
CollectionViewSource cvs = new CollectionViewSource();
cvs.Source = oc;           

cvs.SortDescriptions.Add(new SortDescription(
                           "Major", ListSortDirection.Ascending));

cvs.View.Filter = new Predicate<object>(input=>(input as MyClass).IsSelected == true); 
```

有人知道方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:49:02.463

你应该问自己的第一件事是......

> 为什么我要将排序描述添加到 CollectionViewSource 并将筛选器添加到视图？我不应该将它们都添加到同一个对象中吗？

**答案是肯定的！**

要`CollectionViewSource`直接添加过滤器逻辑，请为事件添加事件处理程序`Filter`。

直接来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.filter.aspx)，这是一个示例

```
listingDataView.Filter += new FilterEventHandler(ShowOnlyBargainsFilter);
private void ShowOnlyBargainsFilter(object sender, FilterEventArgs e)
{
    AuctionItem product = e.Item as AuctionItem;
    if (product != null)
    {
        // Filter out products with price 25 or above 
        if (product.CurrentPrice < 25)
        {
            e.Accepted = true;
        }
        else
        {
            e.Accepted = false;
        }
    }
} 
```

现在，至于为什么添加排序描述时过滤器会被删除。

当您将 a 添加`SortDescription`到 a`CollectionViewSource`时，它最终会在幕后命中此代码块。

```
Predicate<object> filter;
if (FilterHandlersField.GetValue(this) != null)
{
    filter = FilterWrapper;
}
else
{
    filter = null;
}

if (view.CanFilter)
{
    view.Filter = filter;
} 
```

显然，它正在覆盖您在视图上设置的过滤器。

如果您仍然好奇，这里是[CollectionViewSource 的源代码](http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/wpf/src/Framework/System/Windows/Data/CollectionViewSource@cs/1305600/CollectionViewSource@cs)。

# excel - 来自 excel 的 CSV 文件，其中双引号内的字段

> ID：15666195
> 
> 赞同：2
> 
> 时间：2013-03-27T18:06:19.583
> 
> 标签：excel, csv

我想从 excel 创建一个 CSV 文件，其中字段中的所有数据都在双引号内。我从类似的问题中找到了这段代码，它几乎可以工作......

```
Sub CSVFile()

Dim SrcRg As Range
Dim CurrRow As Range
Dim CurrCell As Range
Dim CurrTextStr As String
Dim ListSep As String
Dim FName As Variant
FName = Application.GetSaveAsFilename("", "CSV File (*.csv), *.csv")

If FName <> False Then
  ListSep = Application.International(xlListSeparator)
  If Selection.Cells.Count > 1 Then
    Set SrcRg = Selection
  Else
    Set SrcRg = ActiveSheet.UsedRange
  End If    
  Open FName For Output As #1    
  For Each CurrRow In SrcRg.Rows
    CurrTextStr = ""
    For Each CurrCell In CurrRow.Cells
      CurrTextStr = CurrTextStr & """" & CurrCell.Value & """" & ListSep
    Next
    While Right(CurrTextStr, 1) = ListSep
      CurrTextStr = Left(CurrTextStr, Len(CurrTextStr) - 1)
    Wend    
    Print #1, CurrTextStr    
  Next    
  Close #1    
  End If
End Sub 
```

它让我可以将选定的字段保存在 CSV 中，结果是这样的：

```
"A1","B1","C3"
"A2","B2","C3" 
```

我还需要它做的是在最后一个字段后加一个逗号，如下所示：

```
"A1","B1","C3",
"A2","B2","C3", 
```

我不知道这种代码，可以使用一些帮助。

此外，如果这可行，我如何将宏保存在 Excel 工作表中，以便我可以在需要时随时使用它。

谢谢约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:15:25.057

我认为这段代码正在从每一行中删除列表分隔符/逗号。尝试删除这三行，看看是否可以修复它。

```
While Right(CurrTextStr, 1) = ListSep
  CurrTextStr = Left(CurrTextStr, Len(CurrTextStr) - 1)
Wend 
```

将包含此脚本的代码模块放在您的“个人”Excel 工作簿中，以便您始终可以使用它，无论打开什么文件。

否则，只需将此代码模块放在所需工作簿的代码模块中，并确保另存为 XLSM。

# django - 在 Django admin 中创建的新行不会显示在站点上

> ID：15666199
> 
> 赞同：0
> 
> 时间：2013-03-27T18:06:45.377
> 
> 标签：django, apache, python-3.x, mod-wsgi, postgresql-9.2

在做 Django 教程时会注意到这个问题。

1.  在管理站点上成功进行投票，然后在管理站点上显示该选项：

![在管理站点上成功创建投票](../Images/b0b811af7da80e0b3d8387ef3278749b.png)

2.  转到`mysite.com/polls`并且投票不存在：“没有可用的投票。”

3.  我可以要么 要么`apachectl restart`得到`touch mysite/wsgi.py`相同的结果，即新行然后正确显示在`mysite.com/polls`

`mysite.com/polls`为什么在不重新启动服务器的情况下，在管理站点上创建新行后不会立即显示？

来自 urls.py 的相关代码：

```
from django.conf.urls import patterns, url
from django.views.generic import DetailView, ListView
from django.utils import timezone
from polls.models import Poll

urlpatterns = patterns('',
    url(r'^$',
        ListView.as_view(
            queryset=Poll.objects.filter(pub_date__lte=timezone.now) \
                .order_by('-pub_date')[:5],
            context_object_name='latest_poll_list',
            template_name='polls/index.html'),
        name='index'),
... 
```

views.py中没有代码`mysite.com/polls`。

模板代码为`mysite.com/polls`

```
{% if latest_poll_list %}
    <ul>
    {% for poll in latest_poll_list %}
    <li>
        <a href="{% url 'polls:detail' poll.id %}">{{ poll.question }}</a>
    </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No polls are available.</p>
{% endif %} 
```

使用：

1.  姜戈 1.5
2.  蟒蛇 3.3.0-3
3.  mod_wsgi 3.4-2
4.  PostgreSQL 9.2.3-1
5.  阿帕奇 2.2.24-1
6.  linux 3.8.4-1

额外说明：

1.  Django (1.5) 开发服务器上的相同行为
2.  当我在 python 2.7 和 MySQL 下做 Django (1.5) 教程时，以前没有出现相同的行为
3.  在管理站点创建后，这些行可以`SELECT`从 postgresql shell
4.  当在管理站点上使用`django.test.client.Client`
5.  当我使用 shell 从 shell 进行`django.test.client.Client`新轮询时，新轮询无法从 shell 客户端或 on`mysite.com/polls`读取，但是在服务器重新启动之前`psql`和之前都可以读取。`mysite.com/admin`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:27:30.233

Django 中的查询集通常是“懒惰地”评估的，这意味着您可以编写类似`Poll.objects.filter(pub_date__lte=timezone.now).order_by('-pub_date')`一次的内容，然后每次评估它（尝试从中实际获取数据）时，它都会立即去获取数据。

但是，将其添加`[:5]`到最后会立即评估它。这意味着您传递给 ListView 的内容实际上并不是一个查询集，而只是一个值列表；一个列表，在创建视图时创建一次，然后永远不会重新评估。

为了实现您的目标，我建议您创建一个覆盖该方法的自定义`ListView`。有关如何执行此操作的更多信息，只需查看[文档](https://docs.djangoproject.com/en/1.3/topics/class-based-views/#extending-generic-views)。`views.py``queryset`

# c# - 使用字符串类型变量中存在的值作为表名

> ID：15666200
> 
> 赞同：-2
> 
> 时间：2013-03-27T18:06:48.170
> 
> 标签：c#, .net, dynamic

在我的 C# 代码中，我正在使用存储过程从数据库中检索数据，并且正在动态创建表（我的意思是 .Net 中的 GUI 表）并将行和列动态添加到该表中。我有 4 个表和 4 个各自的存储过程。我不想为每个表编写一个方法，而是编写一个方法，该方法将从四个方法（4 个按钮单击方法）中调用，因为只有存储过程名称和表名称会被更改，其他一切都保持不变。我正在尝试使用下面的代码。

```
 public String StoredProcName; //Values will be "GetFirstYearCSESubjects","GetSecondYearCSESubjects","GetThirdYearCSESubjects","GetFourthYearCSESubjects"
    public String TableName; //Values will be "tblCSE1","tblCSE2","tblCSE3","tblCSE4"
    protected void tabCSE1_Click(object sender, EventArgs e)
    {
        CSEView.ActiveViewIndex = 0;      
        StoredProcName = "GetFirstYearCSESubjects";
        TableName = "tblCSE1";
        phCSE1.Controls.Clear();
        Table tblCSE1 = new Table();
        phCSE1.Controls.Add(tblCSE1);
        addCurriculumData(StoredProcName, TableName);
        ViewState["dynamictable"] = true;
    }

    public void addCurriculumData(String StoredProcName,String TableName)
    {
        String strCon = ConfigurationManager.ConnectionStrings["ConStr"].ConnectionString;
        SqlConnection sqlCon = new SqlConnection(strCon);
        SqlCommand cmd = new SqlCommand(StoredProcName, sqlCon);
        cmd.CommandType = CommandType.StoredProcedure;
        sqlCon.Open();
        SqlDataReader rdr = cmd.ExecuteReader();
        if (rdr.HasRows)
        {
            while (rdr.Read())
            {
                TableRow tr = new TableRow();
                for (int j = 0; j < 1; j++)
                {
                    TableCell tc = new TableCell();
                    Label lbl = new Label();
                    lbl.Text = rdr["Subject"].ToString();
                    tc.Controls.Add(lbl);
                    tr.Cells.Add(tc);
                }
                TableName.Rows.Add(tr);***//How should I write this statement???***
            }
        }
        else
            lblMessage.Text = "No Data found";
    } 
```

我不知道我应该如何写声明`TableName.Rows.Add(tr)`。由于 TableName 是一个字符串，它不能有行，因此会引发错误。所以我应该提到 TableName 而不是 TableName 的值。我该怎么做？我可以使用指针的概念吗？我不太确定指针。还是有其他方法可以做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:19:03.840

将表（不是字符串）传递给方法并与表交互

```
public void addCurriculumData(String StoredProcName,Table table) 
```

# php - 将值从数组插入数据库

> ID：15666203
> 
> 赞同：0
> 
> 时间：2013-03-27T18:06:51.647
> 
> 标签：php, mysql

我的 php 看起来像这样：

```
for ($i = 0, $count = count($ingredientQTY); $i < $count; $i++) {

            $rows[] = array(
                'ingredientamount'         => $ingredientQTY[$i],
                'ingredientType' =>  $measurements[$i],
                'ingredientname'        => $ingredientNAME[$i]
            );
            print_r($rows[$i]);
} 
```

打印出这样的数组：

```
Array ( 
[ingredientamount] => 34 
[ingredientType] => Centiliter 
[ingredientname] => CHicken ) 

Array ( 
[ingredientamount] => 26 
[ingredientType] => Grams 
[ingredientname] => Cheddar Cheese ) 
```

我的数据库中有三个字段名称，分别称为成分数量、成分类型和成分名称，它们对应于分配给 $rows[] 的两个数组。所以，如果我让数组正常工作，我的数据库将如下所示：

1.  成分数量 => 34，成分类型 => 厘升，成分名称 => 鸡肉
2.  成分数量 => 26，成分类型 => 克，成分名称 => 切达干酪

我的问题是：如何使用我的代码获取 $rows[] （这是一个多维数组）并将每一行插入到像我这样的数据库中？

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:12:44.797

试试这个代码：

```
<?php

$rows = array();
$rows[] = array('ingredientamount' => '34', 'ingredientType' => 'Centiliter', 'ingredientname' => 'CHicken' );
$rows[] = array('ingredientamount' => '26', 'ingredientType' => 'Grams', 'ingredientname' => 'Cheddar Cheese' );

$sql = "INSERT `myTableName` (`ingredientamount`,`ingredientType`,`ingredientname`) VALUES ";
$coma = '';
foreach ($rows as $oneRow) {
    $sql .= $coma."('".implode("','",$oneRow)."')";
    $coma = ', ';
}

$result = $db->query($sql);

?> 
```

`$sql`毕竟你会得到这样的东西
`INSERT `myTableName` (`ingredientamount`,`ingredientType`,`ingredientname`) VALUES ('34','Centiliter','CHicken'), ('26','Grams','Cheddar Cheese')`
它只是草稿代码，没有实际需要的错误检查或输入控制，但它给出了它如何工作的想法。我相信您可以自己添加所有其余部分。

**编辑**

> 感谢您的回答，但成分数量、成分类型和成分名称的值是动态的，所以我认为这不起作用？

根本不是问题。只需将此行更改
`$sql = "INSERT `myTableName` (`ingredientamount`,`ingredientType`,`ingredientname`) VALUES ";`
为此
`$sql = "INSERT `myTableName` (`".implode('`,`',array_keys($rows[0]))."`) VALUES ";`

# java - 为什么我不能在这个 java 程序中打印数组 token[] 中的内容

> ID：15666207
> 
> 赞同：1
> 
> 时间：2013-03-27T18:07:08.163
> 
> 标签：java, arrays, filereader

该程序的整个想法是逐行读取文件并将每个单词保存到数组token[]中。我正在尝试使用 for 循环将数组 token[] 中的元素打印到控制台上。但它说变量令牌尚未初始化。

```
import java.io.*;

public class ReadFile{
    public static void main(String args[]){
        String[] token;
        int i;

            try{
                // Open and read the file
                FileInputStream fstream = new FileInputStream("a.txt");
                BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
                String strLine;
                //Read file line by line and storing data in the form of tokens
                while((strLine = br.readLine()) != null){
                    token = strLine.split(" ");
                }   
                in.close();//Close the input stream
            }
            catch (Exception e){//Catch exception if any
                System.err.println("Error: " + e.getMessage());
            }

                   // Why can't I do this printing part?
            for(i=0;i<=token.length;i++){
                System.out.println(token[i]);
            }``
        }// close main()
}// close Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:09:32.450

当你在一个方法中时，比如 main，变量声明没有被初始化，你必须自己为它们提供一个初始值。

例如：

字符串 [] 数组 = 新字符串 [0];

甚至

字符串 [] 数组 = 空；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:11:10.293

以下代码：

```
 public class ReadFile{
    public static void main(String args[]){
    String[] token;
    int i;
    try{
        // Open and read the file
        FileInputStream fstream = new FileInputStream("a.txt");
        DataInputStream in = new DataInputStream(fstream);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        String strLine;
        //Read file line by line and storing data in the form of tokens
        while((strLine = br.readLine()) != null){
            token = strLine.split(" ");
        }   
        in.close();//Close the input stream
    }
    catch (Exception e){//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    } 
```

**应该改为这个：**

```
 public class ReadFile{
    public static void main(String args[]){
    String[] token = null;//initialize token with null
    int i;   
try{
        // Open and read the file
        FileInputStream fstream = new FileInputStream("a.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(fStream));//Don't use DataInputStream as this class is good for reading primitives, length-prefixed strings e.t.c 
        StringBuilder sBuilder = new StringBuilder();
        String strLine;
        //Read file line by line and storing data in the form of tokens
        while((strLine = br.readLine()) != null){
            //token = strLine.split(" ");
            sBuilder.append(strLine);
        }   
        token = (sBuilder.toString()).split(" ");//Write this line here.
        in.close();//Close the input stream
    }
    catch (Exception e){//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    } 
```

还要更改 for 循环结构：

```
for(i=0;i<=token.length;i++){//This will give ArrayOutOfBoundException
        System.out.println(token[i]);
    } 
```

至

```
if (token != null)
for(i=0; i<token.length; i++){// condition should be checked for i < token.length
        System.out.println(token[i]);
    } 
```

**注意：**正如@Peter Lawrey 所建议的，[`DataInputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/DataInputStream.html)应该特别用于阅读原语。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:13:54.993

这是一个范围问题。

范围内`main()`。`token`已定义但未初始化。如果要`token`在此范围级别使用，则必须对其进行初始化。

在 try...catch 块的范围内，`token`被初始化。奇怪的是，它的值只对最后一行很重要，因为每次都会`split()`创建一个新的`String[]`，并且您将它重新分配给`token`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:08:56.937

检查此代码，您将了解问题所在。

```
import java.io.*;
import java.util.*;
public class ReadFile{
public static void main(String args[]){
ArrayList<String[]> tokenlist = new ArrayList<>();
int i;

try{
    // Open and read the file
    FileInputStream fstream = new FileInputStream("health.txt");
    BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
    String strLine;
    //Read file line by line and storing data in the form of tokens
    while((strLine = br.readLine()) != null){
         String[] token = strLine.split(" ");
        tokenlist.add(token);
    }   
    //in.close();//Close the input stream
}
catch (Exception e){//Catch exception if any
    System.err.println("Error: " + e.getMessage());
}

       // Why can't I do this printing part?
for(int count=0; count<tokenlist.size();count++){
    String[] token = tokenlist.get(count);
    for(i=0;i<token.length;i++){
        System.out.println(token[i]);
    }
 }

 }// close main()
 } 
```

# php - 要显示的 Json 记录

> ID：15666211
> 
> 赞同：0
> 
> 时间：2013-03-27T18:07:17.867
> 
> 标签：php, json

```
<?php require_once('Connections/mycon.php'); ?>
<?php

mysql_select_db($database_mycon, $mycon);
$query_Recordset1 = 'SELECT country.name as country, country_Message.name as Message
FROM country, country_Message
WHERE country.id = country_Message.country_id';

//$Recordset1 = mysql_query($query_Recordset1) or die(mysql_error());

$query_Recordset2='select name from country';
$Recordset2=mysql_query($query_Recordset2) or die(mysql_error());
$json_output=array();

$json_countryoutput=array();
while($mainrow=mysql_fetch_assoc($Recordset2))
{
$json_countryoutput[]=array($mainrow['name']=>$mainrow['name'] );

}

mysql_free_result($Recordset2);

$Recordset2=mysql_query($query_Recordset2) or die(mysql_error());
while($mainrow=mysql_fetch_assoc($Recordset2))
{

$Recordset1 = mysql_query($query_Recordset1) or die(mysql_error());
while($row=mysql_fetch_assoc($Recordset1))
{

if(strcmp ( $mainrow['name'] , $row['country'])==0)
{
//echo $row['country'];
$json_output[]=array($mainrow['name']=>$row['Message'] ); 
```

/

```
/$json_output[]1=array('country'=>$row['country'],'Message'=>$row['Message'] );
}

mysql_free_result($Recordset1);

}
//$json_output=array_merge($json_output, $json_countryoutput);

echo json_encode(array('item'=>$json_output,'country'=>$json_countryoutput));

mysql_free_result($Recordset1); 
```

输出：

{"item":[{"German":"Hello"},{"German":"guten Morgen"},{"German":"gute Nacht"},{"English":"Hello"},{"英语":"早安"},{"英语":"晚安"},{"法语":"bonjour"},{"法语":"bonne nuit"},{"法语":"bonjour"} ],"country":[{"German":"German"},{"English":"English"},{"French":"French"}]}

我想改变基本上我有不同的国家和每个国家我想显示所有记录：{“German”：[{“hello”}，{“gutton Morgan”}]，“English”：[{“”}，{ ““}]，“法语”：[{””}，{””}] }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:46:26.213

我不确定我是否理解您的尝试是否正确，但也许这可能会有所帮助：

```
$recordSet = mysql_query($queryRecordSet1);
$results = array();
while ($row = mysql_fetch_assoc($recordSet)) {
  if (isset($results[$row["name"]])) {
    $results[$row["name"]][] = $row["Message"];
  } else {
    $results[$row["name"]] = array($row["Message"]);
  }
}
echo json_encode($results); 
```

可能会有一些语法错误，但我希望我能给你这个想法。因为结果集会给你这样的东西：

“德语”“你好”

"德语" "gutten tag"

将它们添加到结果集时，检查“德语”键是否已设置。如果键存在，那么你应该只追加到数组，如果不存在，你应该创建一个新数组并向其中添加一个新元素。

# jquery - jQuery listview - 单击项目时如何隐藏列表

> ID：15666213
> 
> 赞同：1
> 
> 时间：2013-03-27T18:07:24.833
> 
> 标签：jquery, listview

我正在使用 jQuery 创建一个列表视图和一个过滤器。如果用户单击一个项目，我希望过滤器将文本设置为单击的项目并隐藏列表。但不是永久的！如果用户更改过滤器文本，列表需要返回。

这是我所拥有的：

```
 $(document).ready(function () {

        jQuery.support.cors = true;
        $("#groupSelectList").listview({
            filter: true,
            filterPlaceholder: '',
            icon: false
        });

        $('#groupSelectList').children('li').on('click', function () {
            $('#groupName').val($(this).text());
            $("input[data-type='search']").val($(this).text())
            //$("#groupSelectList").listview("refresh");//this refresh doesn't appear to do anything.
            $("#groupSelectList").listview().hide()//hide works, but the list won't come back if the user changes the input text.
        });
    }); 
```

...

此页面上的小部件是我正在使用的控件的示例：http: [//view.jquerymobile.com/master/demos/](http://view.jquerymobile.com/master/demos/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T17:40:06.623

我想出了如何做到这一点。如果有人感兴趣，为了让 jQuery 移动列表视图控件在单击时消失，然后在更改时重新出现，我将一个临时 keyup 事件绑定到搜索框。我的代码现在看起来像这样：

```
 var groupSelectHandler = function () {
        $("#groupSelectList").listview().show()
        $("#groupSelectList").listview("refresh");
        $("input[data-type='search']").unbind('keyup', groupSelectHandler);
    }

    $(document).ready(function () {
        $("#groupSelectList").listview({
            filter: true,
            filterPlaceholder: ''

        });

        $('#groupSelectList').children('li').on('click', function () {
            $('#groupName').val($(this).text());
            $("input[data-type='search']").val($(this).text());
            $("#groupSelectList").listview().hide();
            $("input[data-type='search']").bind('keyup', groupSelectHandler);
        });
    }); 
```

你可以在这个例子中看到，当点击被触发时，groupSelectHandler 被绑定到 keyup。当 keyup 触发时，它会显示列表并删除 keyup 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-06T10:38:14.587

一个可能的、更简单的解决方案可能是：

```
$( document ).on( "pageinit", "#myPage", function() {
    $('#groupName').val($(this).text());
        $("input[data-type='search']").val($(this).text());;
    $('#groupSelectList li').each(function (index) {
        $(this).addClass("ui-screen-hidden");
    });
}); 
```

# json - 无法让控制器将 JSON 解析回模型

> ID：15666223
> 
> 赞同：1
> 
> 时间：2013-03-27T18:07:58.633
> 
> 标签：json, asp.net-mvc-4

我有一个控制器，它有一个应该采取 POST'ed json 对象的操作：

```
[HttpPost]
public ActionResult EditProject(ProjectDetails project)
{
    return Json(project);
} 
```

但是，实际返回的是一个新的空项目对象。它似乎实际上并没有用 ID（例如来自 url `mywebsite/mycontroller/EditProject/3`）以外的任何东西填充项目对象。

我的`ProjectDetails`对象看起来像这样：

```
public class ProjectDetails
{
    public int ID { get; set; }
    public string Name { get; set; }
    public DateTime Date { get; set; }
    public List<Factor> factors { get; set; }

    public ProjectDetails() 
    { 
        factors = new List<Factor>();
    }

    public ProjectDetails(Project p)
    {
        ID = p.PrjID; 
        Name = p.Name;
        Date = p.PrjDate;
        factors = p.factors;
    }
} 
```

要发布的 JavaScript 代码如下所示：

```
 function save() {
        var data = {
            ID: 4,
            Name: "foo",
            Date: Date.now(),
            factors: []
        };

        $.ajax(window.location.href, {
            type: "POST",
            dataType: "json",
            data: JSON.stringify({ project: data }),
            success: function () {
                alert("done");
            }
        });
    } 
```

几个小时以来，我一直在搞砸这方面的变化，它顽固地忽略了我发送的帖子数据，而是`ProjectDetails`只用`ID`定义的内容构建了一个新数据。

有任何想法吗？

我什至尝试使用 GET 请求生成的 JSON 数据到同一个控制器并将其直接发送回（所以它必须采用正确的格式，对吗？）它仍然忽略它。

**更新**

再看一下，我的请求被发送为`application/json`，但是当我在控制器中设置断点并检查请求时，`application/x-www-form-urlencoded`我可以在`Request.Form[0]`. 但是从我正在阅读的所有其他内容来看，这应该*可以正常工作*。我不应该自己检索 json 字符串并反序列化它。那么我在这里错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:33:59.903

好的，我已经修好了。事实证明，尽管 Firebug 将请求标头显示为 is `application/json`，但您必须通过添加以下内容在 AJAX 设置中明确设置它们：

```
contentType: "application/json" 
```

*掌心*

# jquery - 用咖啡脚本编写 jquery

> ID：15666225
> 
> 赞同：0
> 
> 时间：2013-03-27T18:08:08.887
> 
> 标签：jquery, coffeescript

我如何在咖啡脚本上写这个？我无法获得第二个功能。

```
$(document).ready(function() {  
        $('.box_container').hover(function(){   
            var width = $(this).outerWidth() / 2;  
            $(this).find('.left').animate({ right :0  },{queue:false,duration:300});  
            $(this).find('.right').animate({ left :0  },{queue:false,duration:300});  
        }, function(){  

            $(this).find('.left').animate({ right : width},{queue:false,duration:300});  
            $(this).find('.right').animate({ left : width},{queue:false,duration:300});  

        });  

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:20:04.977

```
$(document).ready ->
    arg1 = ->   
        width = $(this).outerWidth() / 2
        $(this).find('.left').animate { right :0  },{queue:false,duration:300}  
        $(this).find('.right').animate { left :0  },{queue:false,duration:300} 
    arg2 = ->
        $(this).find('.left').animate { right : width}, {queue:false,duration:300} 
        $(this).find('.right').animate { left : width}, {queue:false,duration:300}  

    $('.box_container').hover arg1, arg2 
```

我会这样做（我喜欢保留 jQuery 函数的括号，因为我认为没有它们链接变得不可读）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:41:40.937

您提到的代码的传统咖啡脚本将如下所示：

```
jQuery ->
  $('.box_container').hover ->
      width = $(@).outerWidth()/2
      $(@).find('.left').animate
        right: 0
       ,
        queue:false
        duration: 3000
      $(@).find('.right').animate
        left: 0
       ,
        queue:false
        duration: 3000

   ,
    ->
      $(@).find('.left').animate
        right: width
       ,
        queue: false
        duration: 3000
      $(@).find('.right').animate
        left: width
       ,
        queue: false
        duration: 3000 
```

这是[并排 JS 视图的链接](http://coffeescript.org/#try%3a%0AjQuery%20-%3E%0A%20%20%24%28%27.box_container%27%29.hover%20-%3E%0A%20%20%20%20%20%20width%20=%20%24%28@%29.outerWidth%28%29/2%0A%20%20%20%20%20%20%24%28@%29.find%28%27.left%27%29.animate%0A%20%20%20%20%20%20%20%20right%3a%200%0A%20%20%20%20%20%20%20,%0A%20%20%20%20%20%20%20%20queue%3afalse%0A%20%20%20%20%20%20%20%20duration%3a%203000%0A%20%20%20%20%20%20%24%28@%29.find%28%27.right%27%29.animate%0A%20%20%20%20%20%20%20%20left%3a%200%0A%20%20%20%20%20%20%20,%0A%20%20%20%20%20%20%20%20queue%3afalse%0A%20%20%20%20%20%20%20%20duration%3a%203000%0A%0A%20%20%20,%0A%20%20%20%20-%3E%0A%20%20%20%20%20%20%24%28@%29.find%28%27.left%27%29.animate%0A%20%20%20%20%20%20%20%20right%3a%20width%0A%20%20%20%20%20%20%20,%0A%20%20%20%20%20%20%20%20queue%3a%20false%0A%20%20%20%20%20%20%20%20duration%3a%203000%0A%20%20%20%20%20%20%24%28@%29.find%28%27.right%27%29.animate%0A%20%20%20%20%20%20%20%20left%3a%20width%0A%20%20%20%20%20%20%20,%0A%20%20%20%20%20%20%20%20queue%3a%20false%0A%20%20%20%20%20%20%20%20duration%3a%203000)。我确实知道它看起来比原始 JS 本身非常复杂。

所以，这里是带有括号的简单咖啡脚本，这也表示如何合并第二个函数。

```
jQuery ->
  $('.box_container').hover ->
      width = $(@).outerWidth()/2
      $(@).find('.left').animate({right: 0}, {queue:false, duration: 3000 });
      $(@).find('.right').animate({left: 0}, {queue:false, duration: 3000 });
   ,
    ->
      $(@).find('.left').animate({right: width}, {queue: false, duration: 3000});
      $(@).find('.right').animate({left: width}, {queue: false, duration: 3000}); 
```

快乐的咖啡:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:20:28.240

Parens 使这更简单。

```
$('.box_container').hover(
  ->
    # function one content
    doStuff()

  ->
    # function two content
    doMoreStuff()
) 
```

# r - 如何在 R 中按名称模式删除列？

> ID：15666226
> 
> 赞同：50
> 
> 时间：2013-03-27T18:08:10.057
> 
> 标签：r

我有这个数据框：

```
state county city  region  mmatrix  X1 X2 X3    A1     A2     A3      B1     B2     B3      C1      C2      C3

  1      1     1      1     111010   1  0  0     2     20    200       Push      8     12      NA      NA      NA
  1      2     1      1     111010   1  0  0     4     NA    400       Shove      9     NA 
```

现在我想排除名称以某个字符串结尾的列，比如“1”（即 A1 和 B1）。我写了这段代码：

```
df_redacted <- df[, -grep("\\1$", colnames(df))] 
```

但是，这似乎删除了每一列。如何修改代码，使其仅删除与模式匹配的列（即以“3”或任何其他字符串结尾）？

该解决方案必须能够处理具有数值和分类值的数据框。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2018-04-11T06:04:24.300

`dplyr`我使用/找到了一个简单的答案`tidyverse`。如果您`colnames`包含“This”，那么所有包含“This”的变量都将被删除。

```
library(dplyr) 
df_new <- df %>% select(-contains("This")) 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-03-27T18:17:34.417

如果我将它应用到一个最小的例子并且只搜索字符串“A”，你的代码就像一个魅力：

```
df <- data.frame(ID = 1:10,
                 A1 = rnorm(10),
                 A2 = rnorm(10),
                 B1 = letters[1:10],
                 B2 = letters[11:20])
df[, -grep("A", colnames(df))] 
```

所以你的问题更多的是一个正则表达式问题，而不是如何删除列。如果我运行你的代码，我会得到一个错误：

```
df[, -grep("\\3$", colnames(df))]
Error in grep("\\3$", colnames(df)) : 
  invalid regular expression '\3$', reason 'Invalid back reference' 
```

更新：你为什么不直接使用下面的表达式？

```
df[, -grep("1$", colnames(df))]
   ID         A2 B2
1   1  2.0957940  k
2   2 -1.7177042  l
3   3 -0.0448357  m
4   4  1.2899925  n
5   5  0.7569659  o
6   6 -0.5048024  p
7   7  0.6929080  q
8   8 -0.5116399  r
9   9 -1.2621066  s
10 10  0.7664955  t 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-03-30T09:12:38.717

作为一个额外的答案，因为我在寻找`data.table`这个问题的解决方案时偶然发现了这个。

```
library(data.table)
dt <- data.table(df)
drop.cols <- grep("1$", colnames(dt))
dt[, (drop.cols) := NULL] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-03-27T18:18:44.743

对于排除任何字符串，您可以使用...

```
 # Search string to exclude
 strng <- "1"
 df <- data.frame(matrix(runif(25,max=10),nrow=5))
 colnames(df) <- paste( "EX" , 1:5 )
 df_red <- df[, -( grep(paste0( strng , "$" ) , colnames(df),perl = TRUE) ) ]

    df
#         EX 1     EX 2        EX 3     EX 4     EX 5
#   1 7.332913 4.972780 1.175947853 6.428073 8.625763
#   2 2.730271 3.734072 6.031157537 1.305951 8.012606
#   3 9.450122 3.259247 2.856123205 5.067294 7.027795
#   4 9.682430 5.295177 0.002015966 9.322912 7.424568
#   5 1.225359 1.577659 4.013616377 5.092042 5.130887

    df_red
#         EX 2        EX 3     EX 4     EX 5
#   1 4.972780 1.175947853 6.428073 8.625763
#   2 3.734072 6.031157537 1.305951 8.012606
#   3 3.259247 2.856123205 5.067294 7.027795
#   4 5.295177 0.002015966 9.322912 7.424568
#   5 1.577659 4.013616377 5.092042 5.130887 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-09-21T02:53:48.700

如果您正在专门寻找出现在列名称末尾的模式，要删除这些列，您可以使用以下命令：

```
library(dplyr) 
df_new <- df %>% select(-ends_with("linear")) 
```

所有以该字符串结尾的列`linear`都将被删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-28T22:04:49.413

您可以使用正则表达式进一步扩展它以进行更广泛的模式搜索。我有一个数据框，它有一堆带有`"name"`“upper_name” `and`“lower_name”`的列，因为它们代表了一堆系列的置信区间，但我并不需要它们。因此，使用正则表达式，您可以执行以下操作：

```
pattern = "(upper_[a-z]*)|(lower_[a-z]*)"
policyData <- policyData[, -grep(pattern = pattern, colnames(policyData))] 
```

“|” 允许我在正则表达式中包含一个 or 语句，这样我就可以用一个模式执行一次，而不是查找每个模式。

# mysql - 在 MySQL 中保留重复记录的运行记录

> ID：15666232
> 
> 赞同：0
> 
> 时间：2013-03-27T18:08:27.103
> 
> 标签：mysql, sql

有很多类似的问题被问到这个问题，但我找不到一种方法来做我想做的事情。我需要在列中保留重复条目的运行记录，并在“所有者编号”列中报告该数字。下面的例子：

```
Roll Number  |  Owner Name  |  Owner Number
000001       |  Patrick H.  |  1
000001       |  Paula H.    |  2
000002       |  Fred R.     |  1
000003       |  Chris P.    |  1
000003       |  Kayla A.    |  2
000003       |  Phil J.     |  3 
```

换句话说，我只需要计算每个卷到目前为止有多少所有者，而不仅仅是每个卷的所有者总数。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:18:51.793

Mysql 不支持窗口函数，但可以使用变量来完成：

```
SET @num=0;
SET @roll='';
SELECT `Roll Number`,`Owner Name`,`Owner Number`
FROM
(
SELECT `Roll Number`,
`Owner Name`,
(CASE WHEN @roll=`Roll Number` 
                            THEN @num:=@num+1 ELSE
                            @num:=1 END) as `Owner Number`,
@roll:=`Roll Number`
FROM table1
  ) as q; 
```

[http://sqlfiddle.com/#!2/788a4/5](http://sqlfiddle.com/#!2/788a4/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:19:40.883

您可以使用一个或两个子查询和一个 @variable 来执行此操作

即[http://sqlfiddle.com/#!2/7c2fa/7](http://sqlfiddle.com/#!2/7c2fa/7)

```
SELECT

  -- Re-selected at this level to tidy up the calculation fields
  f.rollNumber,
  f.ownerName,
  f.ownerNumber

FROM (
  SELECT

    d.rollNumber,
    d.ownerName,
    -- If the current roll number equals the previous, increment, else reset to 1
    @i := IF(d.rollNumber=@last,@i+1,1) AS ownerNumber,
    -- Sets @last to be == the "current" one for use on next row
    @last := d.rollNumber

  FROM
  (
      -- Get the raw data ordered by roll number
      SELECT

          LPAD(rollNumber,6,'0') rollNumber,
          ownerName

      FROM someTable
      -- Reorder / filter as much as you like, but always rollNumber ASC first
      ORDER BY
          rollNumber ASC,
          ownerName ASC
  ) d,(
      -- Set up the variables we will need shortly
      SELECT @i:=0,@last:=0
  ) v
) f; 
```

# matlab - 将一个 m 文件中的变量值调用到另一个 m 文件中

> ID：15666245
> 
> 赞同：0
> 
> 时间：2013-03-27T18:09:13.780
> 
> 标签：matlab

我有一个名为 motor_model.m 的 m 文件。我有另一个名为 controller.m 的 m 文件，我在第一行调用 motor_model.m。现在 motor_model.m 的输出是稳态电流，它存储在一个名为 I_steadystate 的变量中，该变量的值需要在 controller.m 中调用。

你能给我关于如何做到这一点的代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:14:25.023

在 m 文件 controller.m 中：

```
function [] = controller()
steadyState = motor_model() 
```

在 m 文件 motor_model.m 中

```
function [I_steadystate] = motor_model()
I_steadystate = 0; % 0 is an example. I_steadyState should be defined somewhere in your code. 
```

# android - Maven：无法解析 pom.xml 中的属性

> ID：15666251
> 
> 赞同：2
> 
> 时间：2013-03-27T18:09:24.827
> 
> 标签：android, maven, pom.xml, maven-dependency-plugin

我刚开始将我的 Android 项目转换为 Maven。
我正在尝试`properties`在我的*pom.xml*中使用，但出现错误：

> 未找到依赖项 com.google.android:android${android.version}

除了`${junit.version}`.
下面是我的*pom.xml*：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
    http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>

<parent>
    <groupId>org.sonatype.oss</groupId>
    <artifactId>oss-parent</artifactId>
    <version>7</version>
</parent>

<groupId>com.myproject.app</groupId>
<artifactId>parent</artifactId>
<packaging>pom</packaging>
<version>1.0</version>

<modules>
    <module>myapp</module>
    <module>mytests</module>
</modules>

<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>

    <java.version>1.6</java.version>
    <abs.version>4.2.0</abs.version>
    <noa.version>2.4.0</noa.version>
    <junit.version>4.8.1</junit.version>
    <android.version>4.1.1.4</android.version>
    <android-support.version>r12</android-support.version>
    <android.sdk.platform>16</android.sdk.platform>
</properties>

<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>${android.version}</version>
        </dependency>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>support-v4</artifactId>
            <version>${android-support.version}</version>
        </dependency>
        <dependency>
            <groupId>com.nineoldandroids</groupId>
            <artifactId>library</artifactId>
            <version>${noa.version}</version>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>${junit.version}</version>
        </dependency>
    </dependencies>
</dependencyManagement>

<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.5</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                </configuration>
            </plugin>

            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.3.2</version>
                <configuration>
                    <sdk>
                        <platform>${android.platform}</platform>
                    </sdk>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-javadoc-plugin</artifactId>
                <version>2.8</version>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-checkstyle-plugin</artifactId>
                <version>2.9.1</version>
                <configuration>
                    <failsOnError>true</failsOnError>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-site-plugin</artifactId>
                <version>3.0</version>
                <configuration>
                    <skip>true</skip>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>

    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-release-plugin</artifactId>
            <version>2.2.2</version>
            <configuration>
                <autoVersionSubmodules>true</autoVersionSubmodules>
            </configuration>
        </plugin>

        <plugin>
            <groupId>com.github.github</groupId>
            <artifactId>site-maven-plugin</artifactId>
            <version>0.5</version>
            <executions>
                <execution>
                    <phase>site</phase>
                    <goals>
                        <goal>site</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <message>Creating site for ${project.version}.</message>
                <outputDirectory>website</outputDirectory>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:39:18.250

它为我获取了依赖项。我建议检查几件事：

*   运行`mvn -X compile`以获取有关正在使用哪些镜像的更多信息
*   检查您的 Maven`settings.xml`以查看您正在使用哪些镜像
*   验证没有防火墙阻止对存储库的访问

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T09:38:59.997

我建议使用 androidKickstartR ( [http://androidkickstartr.com/](http://androidkickstartr.com/) ) 创建一个 android maven 项目，并将 pom.xml 复制到您自己的项目中，您可以根据需要对其进行编辑。

准备好构建项目时：

```
mvn clean install android:deploy 
```

# java - 家庭自动化、解耦设备和对它们执行的操作

> ID：15666252
> 
> 赞同：0
> 
> 时间：2013-03-27T18:09:26.813
> 
> 标签：java, oop, home-automation

我有一个 OOP 设计问题（我使用的是 java，但问题更笼统）。我正在编写家庭自动化模拟器，但我在设计它时遇到了一些麻烦。每个设备都有一个类，例如带有相应方法的*TV*或*Heating ，例如**volumeUp()*，......我想为设备和传感器解耦类，它们正在生成事件并在它们上执行操作。我可以想到这一点：我将实现观察者模式以将事件从传感器传播到警报类。警报类如下所示：

```
class Alarm implements Observer {
    Action action;
    public update(...) { action.do() }
} 
```

现在，因为我想让用户能够任意耦合传感器和他们在用户界面中触发的动作，所以我考虑为每个设备上的每个动作创建单独的类

```
class ActionTVVolumeUp implements Action {
    Television tv;
    ActionTVVolumeUp(Television tv) { this.tv = tv; }
    public void do() { tv.volumeUp() }
} 
```

然后当用户在用户界面中指定传感器（MotionSensor，LightSensor，...）并触发动作时，我将创建具有所需动作的警报实例，观察所需的传感器。这样做的问题是我将需要很多很多动作类（可能通过使用诸如 VolumeControllable 之类的设备将实现的接口来减少它们）。

有什么我遗漏的吗？这可以更简单/不需要使用这么多的 Action 类吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:28:00.343

下面的情况如何：每个设备都提供了它可以执行的操作的查找，例如将人类可读名称映射到方法的字典。每个传感器都有一个在触发时应该调用的操作（方法）列表。UI 只是向传感器添加方法。

在 C# 中，传感器的方法列表将是一个事件处理程序，而设备方法将是某种委托。然后在 UI 中，将设备操作挂钩到传感器的代码只是`aSensor.actions += anAppliance.aMethod;`我不记得这是否/如何转换为 Java，但我确信有一种方法 - 也许其他人可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-26T19:10:06.833

一个通用的发布-订阅控制器如何实现一个通用的事件处理程序？您将创建一个名称为 TV 的 Appliance 实例，而不是 TV 设备。在每个设备中，您将添加适用于该特定设备的命令。并且任何命令都不会与另一个设备对话，它总是会与控制器对话。这样，控制器维护所有设备的所有状态的副本，并且它会知道何时进行更改，并且还会知道何时需要进行更改。

这样，您的控制器可以处理规​​则（或者您甚至可以将规则设备插入控制器。它可以监视“IF living-room-tv is turn-on-event AND motion-detector-living-room is active in the controller.最后 60 秒 THEN 执行调暗客厅灯场景”

显然，当设备想要控制自己时会出现问题（如果您点击电视上的频道向上按钮，控制器怎么知道？）但否则，只要电视不自行调暗灯光，控制器将永远处于正确的状态，让规则做正确的事情。

如果您可以避免将特定的设备活动嵌入到一个类中，而是一般处理与可执行操作相关的名称，那么它应该永远灵活。

# childbrowser - Phonegap 构建 - 在 InAppBrowser 或没有工具栏的子浏览器中打开外部页面并关闭它？

> ID：15666258
> 
> 赞同：9
> 
> 时间：2013-03-27T18:09:54.437
> 
> 标签：childbrowser, phonegap-build, inappbrowser

1.  我想在 InAppBrowser 或子浏览器中打开一个外部页面，我不显示任何工具栏，并且我可以在我的外部页面中有一个按钮来关闭浏览器并从我打开浏览器的位置返回到应用程序。那么在没有 DONE 按钮的情况下如何关闭呢？我已经看到，如果我有 var ref = window.open(encodeURI(url), '_self', 'location=yes'); 然后可以使用 ref.close() 关闭浏览器；但是如果我在打开的外部页面中使用它不起作用，它不会关闭浏览器？

2.  如果我在配置文件中将方向设置为纵向，是否有任何方法可以自动旋转它们？我知道如果您手动操作，而不是通过构建服务，您可以自动旋转子浏览器。还是我必须将方向设置为两者？

3.  我已经测试了打开 ChildBrowser 和 InAppBrowser 的所有不同方法，但我真的看不出它们之间有什么大的区别？InAppBrowser 是否可以使用本机功能而 ChildBrowser 不能使用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T10:05:35.863

OK，关闭的问题1就解决了。这是我用来在 InAppBrowser 中打开外部页面的方法。从我在 InAppBrowser 中加载的页面，我可以关闭 InAppBrowser 本身，从我打开浏览器的位置返回到我的应用程序。

在您的服务器上创建一个页面 - closeInAppBrowser.html 只是一个空的 html 页面，它没有做任何事情

我用这个打开浏览器：

```
<a href="#" onclick="openInAppBrowserBlank('http://www.mypage.asp?userId=1');">open InAppBrowser</a>

var ref = null;
function openInAppBrowserBlank(url)
{
    try {
ref = window.open(encodeURI(url),'_blank','location=no'); //encode is needed if you want to send a variable with your link if not you can use ref = window.open(url,'_blank','location=no');
         ref.addEventListener('loadstop', LoadStop);
         ref.addEventListener('exit', Close);
    }
    catch (err)    
    {
        alert(err);
    }
}
function LoadStop(event) {
         if(event.url == "http://www.mypage.com/closeInAppBrowser.html"){
            // alert("fun load stop runs");
             ref.close();
         }    
    }
function Close(event) {
         ref.removeEventListener('loadstop', LoadStop);
         ref.removeEventListener('exit', Close);
    } 
```

[为了从我在浏览器中打开的页面（ http://www.mypage.asp](http://www.mypage.asp) ）关闭 InAppBrowser，我有一个像这样的按钮链接。

```
<a href="http://www.mypage.com/closeInAppBrowser.html"></a> 
```

我希望它可以帮助别人！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-18T04:25:29.360

这是一个更简单的解决方案，可以帮助某人。

```
// open win and turn off location 
var ref = window.open('http://myloginapp.com', '_blank', 'location=no');

// attach listener to loadstart
ref.addEventListener('loadstart', function(event) { 
    var urlSuccessPage = "http://myloginapp/success/";
    if (event.url == urlSuccessPage) {
    ref.close();    
    }
}); 
```

# android - URLConnection Android 4.2 不起作用

> ID：15666260
> 
> 赞同：-2
> 
> 时间：2013-03-27T18:09:58.583
> 
> 标签：android, sdk, intellij-idea, urlconnection, android-4.2-jelly-bean

请帮我。有一个简单的应用程序，通过单击 TextView 代码 html 页面中的按钮来显示。我尝试在 android 2.3 上运行...有效。但在 android 4.2 上，按下错误会显示“不幸的是，name_app 已停止”。

MainActivity.java

```
 public class MainActivity extends Activity {
    TextView txtview;
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        txtview = (TextView) findViewById(R.id.txtview);

    }
    public void OnClickBtn (View v) {
        URL url = null;
        try {
            url = new URL("http://ya.ru/");
            URLConnection con1 = url.openConnection();
            BufferedReader reader = new BufferedReader(new InputStreamReader(con1.getInputStream()));
            String line = "";
            while ((line = reader.readLine()) != null){
                txtview.append(line);
            }
        } catch (Exception e){

        }
    }
} 
```

清单.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.example.test">
    <uses-sdk android:minSdkVersion="10" android:targetSdkVersion="17" android:maxSdkVersion="17"/>
    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".MainActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
    <uses-permission android:name="android.permission.INTERNET"></uses-permission>
</manifest> 
```

也许它在android sdk中。我正在编写另一个您想在互联网上查询的应用程序。在 Android 2.3 上运行，但不适用于 4.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:11:16.697

在 3.0+ 中，您不能在主线程上运行 HTTP 请求 - 您必须在 AsyncTask 或线程中执行此操作，否则会引发异常。

# asp.net-mvc - Webgrid，第一个 td 应该是不同的

> ID：15666261
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:01.537
> 
> 标签：asp.net-mvc, webgrid

我打算使用 MVC3/MVC4 的 Webgrid

但是我在表中的所有行都应该具有相同的列格式，除了第一个。

在第一行应该有一个跨越表格所有列的文本框。所有其他行都应填充我作为输入提供的列表

我怎样才能做到这一点:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:46:38.457

目前唯一可以做到这一点的方法是在网格渲染后使用客户端脚本。jQuery 将是一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T11:15:46.563

```
 function createSearchTextBox(){
        var numberOfColumns = $("#grid >table").find("th").length;
        var firstTableRow = "<tr><td id='searchBox'colspan='" + numberOfColumns + "' ><input type='text'></input></td></tr>";
        $("#grid >table tr:first").after(firstTableRow);
        PlaceCheckBoxInHeader();
    } 
```

# android - Google TV ― 视频播放停止工作

> ID：15666263
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:09.457
> 
> 标签：android, android-videoview, google-tv, audiovideoplayback

我创建了一个 Google TV 应用程序，可以播放存储在该`res/raw`文件夹中的两个本地视频。应用程序开始运行良好，但随后随机锁定。锁定后，我收到*“抱歉，无法播放此视频”。*当我尝试重新启动应用程序时出现消息。不仅我的应用程序受到影响，而且所有其他应用程序的视频播放似乎都像 YouTube 应用程序一样受到影响。即使重新启动系统，错误仍然存​​在。有没有其他人遇到过这样的事情，或者知道可能是什么原因造成的？

这是我在 SonyNSZ-GS7 上运行的代码：

`MainActivity`：_

```
public class MainActivity extends Activity {

    int currentVideo = R.raw.ahwvideo;
    VideoView videoView;

    @SuppressLint("DefaultLocale")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     
        setContentView(R.layout.activity_main);

        // Code to Display Video
        videoView = (VideoView)findViewById(R.id.VideoView);          
        videoView.setVideoURI(Uri.parse(
                "android.resource://" + getPackageName() +"/"+R.raw.ahwvideo1));
        videoView.setMediaController(new MediaController(this));
        videoView.requestFocus();       
        videoView.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {

            public void onCompletion(MediaPlayer mp) {
                switchVideo(videoView);
                videoView.start();
            }
        });

        videoView.start();
    }

    public void switchVideo(VideoView videoView) {
        if (currentVideo == R.raw.ahwvideo1) {
            videoView.setVideoURI(Uri.parse("android.resource://"
                    + getPackageName() +"/"+R.raw.ahwvideo2));
            currentVideo = R.raw.ahwvideo2;
        } else {
            videoView.setVideoURI(Uri.parse("android.resource://"
                    + getPackageName() +"/"+R.raw.ahwvideo1));
            currentVideo = R.raw.ahwvideo1;
        }
    }
} 
```

和布局`activity_main.xml`：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    tools:context=".MainActivity" >

    <VideoView
        android:id="@+id/VideoView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:09:23.650

不知道这是否真的很重要，但视频名称似乎有错误：

> videoView.setVideoURI(Uri.parse("android.resource://" + getPackageName() +"/"+R.raw.video2));

应该是：R.raw.* *ahw* *video2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:10:46.807

在 switchVideo() 中，在开头添加：

```
videoView.setVisibility(View.GONE); 
```

最后：

```
videoView.setVisibility(View.VISIBLE); 
```

以便它包含 setVideoURI()。我知道，这似乎很奇怪，但试一试，看看它是否有所作为。

# javascript - 如何在javascript函数中清除超时

> ID：15666267
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:26.823
> 
> 标签：javascript, ajax, jquery

我有两个 javascript 函数，都适用于点击事件。对于我使用的每个功能，设置超时属性。问题是，如果调用第一个函数并调用第二个函数，则两个超时都会一起激活。启用一项功能时，有什么方法可以禁用一项功能的计时器。

脚本：

```
function overall(){
    $(".one").show();
    $(".two").hide();
    $(".three").hide();
    $(".four").hide();
    setTimeout(overall,1000);       
    }

function mobile(){
    $(".one").hide();
    $(".two").show();
    $(".three").hide();
    $(".four").hide();
    setTimeout(mobile,1000);        
    } 
```

如果这是这种情况，我该怎么办？因为这两个功能都将被激活，我不知道如何在启用一个时关闭超时

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:11:25.853

`setTimeout`返回一个值（“计时器句柄”），它是一个除`0`. `clearTimeout`您可以通过在超时发生之前将该值传递给来取消计时器。

因此，您可以记住您已安排的一个或两个计时器的计时器句柄（取决于您的需要），并且当发生某些事情让您想要取消其中一个计时器时，请`clearTimeout`使用相关句柄进行调用。

* * *

你问了一个例子。由于我仍然完全不清楚你想在什么时候取消，我猜一下：你想要一个电话`overall`来取消任何待处理的电话，`mobile`反之亦然：

```
// Variables to hold the timers
var overallTimer = 0,
    mobileTimer = 0;

function overall(){
    // If a pending call to mobile exists, cancel it
    if (mobileTimer) {
        clearTimeout(mobileTimer);
        mobileTimer = 0;
    }
    $(".one").show();
    $(".two").hide();
    $(".three").hide();
    $(".four").hide();
    // Schedule a call to ourselves, remember the timer handle
    overallTimer = setTimeout(overall,1000);       
    }

function mobile(){
    // If a pending call to overall exists, cancel it
    if (overallTimer) {
        clearTimeout(overallTimer);
        overallTimer = 0;
    }
    $(".one").hide();
    $(".two").show();
    $(".three").hide();
    $(".four").hide();
    // Schedule a call to ourselves, remember the timer handle
    mobileTimer = setTimeout(mobile,1000);       
    } 
```

如果您愿意，您可以将计时器存储在函数中，尽管它并不能真正为您带来太多收益：

```
function overall(){
    // If a pending call to mobile exists, cancel it
    if (mobile.timer) {
        clearTimeout(mobile.timer);
        mobile.timer = 0;
    }
    $(".one").show();
    $(".two").hide();
    $(".three").hide();
    $(".four").hide();
    // Schedule a call to ourselves, remember the timer handle
    timer = setTimeout(overall,1000);       
    }
overall.timer = 0;

function mobile(){
    // If a pending call to overall exists, cancel it
    if (overall.timer) {
        clearTimeout(overall.timer);
        overall.timer = 0;
    }
    $(".one").hide();
    $(".two").show();
    $(".three").hide();
    $(".four").hide();
    // Schedule a call to ourselves, remember the timer handle
    mobile.timer = setTimeout(mobile,1000);       
    }
mobile.timer = 0; 
```

# c# - ASP.NET - 获取用户的安全组

> ID：15666269
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:28.243
> 
> 标签：c#, asp.net

我有一个在 Intranet 上运行的网站，该网站具有集成的 Windows 安全性。

```
<authentication mode="Windows" />
<identity impersonate="true" />
<authorization>
    <allow roles="MyDomain\Group1,MyDomain\Group2"/>
</authorization> 
```

如何确定当前用户属于 MyDomain\Group1 还是 MyDomain\Group2。我在下面尝试了这个，但它会抛出一个错误：

```
PrincipalContext principalContext = new PrincipalContext(ContextType.Domain);
        GroupPrincipal group = GroupPrincipal.FindByIdentity(principalContext, "MyDomain\Group1");
        PrincipalSearchResult<Principal> user = UserPrincipal.Current.GetGroups();

        foreach (Principal principal in group.Members)
        {
            if (UserPrincipal.Current.Name == principal.Name)
            {
                // Enable Functionality

                break;
            }
        } 
```

如何确定当前用户属于 Mydomain\Group1 还是 Mydomain\Group2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:20:15.263

您可以简单地使用 Roles 类，而不是使用 Active Directory API：

[Roles.GetRolesForUser()](http://msdn.microsoft.com/en-us/library/8ak75t41.aspx)

只需将其添加到您的 web.config 中：

```
<roleManager defaultProvider="WindowsProvider" 
  enabled="true"
  cacheRolesInCookie="false">
  <providers>
    <add name="WindowsProvider" type="System.Web.Security.WindowsTokenRoleProvider" />
  </providers>
</roleManager> 
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.web.security.windowstokenroleprovider.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.windowstokenroleprovider.aspx)。

# jquery - Chrome使用动态内容折叠内联元素的宽度

> ID：15666271
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:37.617
> 
> 标签：jquery, html, css

如果您在 google chrome 中打开以下 URL，您会看到问题，第一次加载时没问题，但如果您不断刷新顶部 3 个项目（Bedingungen、Preise 和 So geht's）的宽度，则会崩溃。在 Firefox 中它没问题，但我不知道为什么它在 chrome 中这样做，任何人都知道它为什么会发生或有解决方案吗？谢谢！

文本是用 Ajax/json 加载的，它们是内联的，因为我希望它们是文本的宽度。我不想设置固定宽度。

[http://alexanderlloyd.info/test/](http://alexanderlloyd.info/test/)

代码

```
CSS:

#game-nav li a {
    background: none repeat scroll 0 0 rgb(255, 255, 255);
    border: 1px solid rgb(217, 195, 169);
    color: rgb(34, 34, 34);
    display: inline-block;
    padding: 8px 12px 8px 8px;
    text-decoration: none;
    text-transform: uppercase;
}

    JavaScript:

        $(document).ready(function() {
        var data;
        function loadContent(){ 
            $.ajax({
                url: "json/content.json",
                data: "nocache=" + Math.random(),
                type: "GET",
                contentType: "application/json",
                dataType: "json",
                success: function(source){
                    data = source;
                    showInfo();
                },
                error: function(data){
                    alert("Failed to load content");
                }
            }); 

        }

        loadContent();
            function showInfo(){
                $(".text").html(data[lang]['startpage']['text']);
        }
       showInfo();
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:38:11.207

问题在于您的 li.game-nav 的 float:left 属性，因为它动态更新它无法正确调整尝试从列表中删除 float:left 并将其添加到其 div 容器

# ios - iOS Category Inheritance 封装 NSJSONSerialization

> ID：15666273
> 
> 赞同：3
> 
> 时间：2013-03-27T18:10:38.007
> 
> 标签：ios, objective-c, objective-c-category

我试图将[NSJSONSerialization](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)方法封装在一个`Category`on中，`NSObject`而不是在整个代码中重复 [de]/serialization。

### 。H

```
#import <Foundation/Foundation.h>

@interface NSObject (AYIAdditions)

+ (NSString *)JSONString;
+ (id)objectFromJSONString;
+ (id)objectFromJSONData;

@end 
```

但是，我收到错误消息：*“NSMutableDictionary”没有可见的@interface 声明选择器“JSONString”*

`NSMutableDictionary`继承`NSObject`，因此应该继承这些类别方法，对吗？我错过了什么？

顺便说一句，使用类别是一种好方法（[Ray Wenderlich 提到](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)）。或者我应该简单地使用一些类方法创建一个自定义对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:20:46.537

在代码中：

```
+ (NSString *)JSONString; 
```

（`+`加号）表示一个类方法。您很可能需要一个实例方法，如下所示：

```
- (NSString *)JSONString; 
```

**关于如何实现序列化的方法：**这是相当“旁白”。你所问的范围很广，你给出的细节很少。这实际上取决于您的需求范围以及您想要投入多少时间/精力，但要权衡一下意见：

一个类别对`NSObject`我来说似乎有点过于宽泛。我认为它不太可能产生比看起来更合乎逻辑的选择协议更好的结果。

坦率地说，我希望`NSJSONSerialization`声明一个用于序列化我们自己的自定义模型对象的协议，类似于`NSCoding`，但他们没有。这仍然是我将对象编码为`JSON`. 协议可能看起来像这样：

```
NSString * const MySerializationClassKey = @"MySerializationClassKey";
@protocol MySerializationProtocol <NSObject>
@required
-(NSDictionary *)dictionarySerialization;
-(id)initFromDictionarySerialization:(NSDictionary *)dictionary;
@end 
```

然后您的自定义模型对象可以像这样序列化和反序列化：（过于简单化）

```
@interface MyModel() <MySerializationProtocol>
@property (strong) NSString *name;
@end
@implementation MyModel
NSString * const MyModelNameKey = @"MyModelNameKey";
@synthesize name = _name;
-(NSDictionary *)dictionarySerialization{
    // encode object as dictionary
    return @{MySerializationClassKey: NSStringFromClass(self.class), MyModelNameKey: _name.copy};
}
-(id)initFromDictionarySerialization:(NSDictionary *)dictionary{
    if ((self = [super init])){
        _name = [dictionary objectForKey:MyModelNameKey];
    }
    return self;
}
@end 
```

现在假设，为了不将完整的序列化库输入到答案中，您只拥有`NSArray`这些模型对象的平面。您可以创建一个`NSJSONSerialization`与这些方法配合使用的类。为了使每次通话更轻松，如下所示：

```
@interface MySerializer : NSObject
@end
@implementation MySerializer
+(NSData *)jsonDataFromObject:(NSMutableArray *)array{
    for (NSUInteger index = 0; index < array.count; index++) {
        NSObject *object = [array objectAtIndex:index];
        if ([object conformsToProtocol:@protocol(MySerializationProtocol)]){
            NSDictionary *dictRep = [(id<MySerializationProtocol>)object dictionarySerialization];
            [array replaceObjectAtIndex:index withObject:dictRep];
        }
    }
    return [NSJSONSerialization dataWithJSONObject:array options:0 error:nil];
}
+(NSMutableArray *)objectFromJSONData:(NSData *)data{
    NSMutableArray *array = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:nil];
    for (NSUInteger index = 0; index < array.count; index++) {
        NSObject *object = [array objectAtIndex:index];
        if ([object isKindOfClass:[NSDictionary class]]){
            NSDictionary *dict = (NSDictionary *)object;
            NSString *className = [dict objectForKey:MySerializationClassKey];
            if (className.length > 0) {
                NSObject *deserialized = [[NSClassFromString(className) alloc] initFromDictionarySerialization:dict];
                if (deserialized) [array replaceObjectAtIndex:index withObject:deserialized];
            }
        }
    }
    return array;
}
@end 
```

现在显然要从这样的代码中获得任何里程，您必须递归遍历可能的数组和字典。但这是我的首选路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:14:21.263

您确定您确实导入了该类别的标题吗？

```
#import "NSObject+AYIAdditions.h"
```

这是否是一个正确的方法是有争议的。我认为添加一个`NSObject`不能在所有对象上调用的方法不是一个好的解决方案（并非所有对象都可以进行 JSON 序列化）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:36:12.543

> 您使用 NSJSONSerialization 类将 JSON 转换为 Foundation 对象并将 Foundation 对象转换为 JSON。
> 
> 可以转换为 JSON 的对象必须具有以下属性：
> 
> *   顶级对象是 NSArray 或 NSDictionary。
> *   所有对象都是 NSString、NSNumber、NSArray、NSDictionary 或 NSNull 的实例。
> *   所有字典键都是 NSString 的实例。
> *   数字不是 NaN 或无穷大。其他规则可能适用。
> 
> 调用`isValidJSONObject:`或尝试转换是判断给定对象是否可以转换为 JSON 数据的确定方法。[资料来源：[Apple 的文档](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40010946-CH1-DontLinkElementID_1)]

所以你应该在 NSObject 上定义那个类别。一个有意义的地方是 NSArray 和 NSDictionary。

我还将创建一个序列化程序类，它提供一个`sharedSerializer`, 将从这两个类别中调用。

* * *

另一种方法可能是确实在 NSObject 上声明类别，但传入一个失败块以处理 n 个对象不能序列化的情况。

# java - J2SE 上的 SQLCipher

> ID：15666274
> 
> 赞同：3
> 
> 时间：2013-03-27T18:10:38.690
> 
> 标签：java, sqlcipher

我正在尝试在我的桌面 J2SE 应用程序中使用 SQLCipher。根据 SQLCipher 网站，Java 是受支持的。我们目前在我们的 Android 应用程序中使用它，但我不知道在 J2SE 端从哪里开始？关于这个话题的内容不多。我已经了解了一些关于构建 JDBC 驱动程序的知识，但在完全了解之前我并不想开始任何事情。任何人都可以提供任何方向吗？

# php - 将使用隐藏输入元素的动态 jquery 数组发布到 php 脚本

> ID：15666275
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:46.023
> 
> 标签：php, jquery, arrays

我有一个列表框，用户可以在其中添加、删除和更新并保存列表。单击“保存”按钮后，我正在调用 jquery 以在列表框中构建元素数组，然后使用隐藏的 INPUT elememt 进行 POST。但我得到一个空数组 PHP POST。这是jquery

```
$("#saveCategory").click (function() {
    var items = $("#jqxlistbox").jqxListBox('getItems');
    var length = items.length; 
    var mylist = new Array();
    for (var i = 0; i < length; i++) {
        var row = {};
        row["cname"] = items[i].value;
        row["cvalue"] = items[i].label;
        mylist[i] = row;
    }
    $("#myCatgories").value(mylist);  
}); 
```

这是我的 html 表单

```
<form id="addcategory" method="post" action="index.php">
<div style="float: left">
    <input type="button" value="Add" id="addCategory" style="margin-left: 3px" />
        <input type="button" value="Update" id="updateCategory" style="margin-left: 3px" />
        <input type="button" value="Delete" id="deleteCategory" style="margin-left: 3px" />
        <br />                                            
        <input type="submit" value="Save" id="saveCategory" style="margin-left: 3px" />
    </div>
    <div>
    <input type="hidden" name="myCatgories[]" id="myCatgories" value="">
</div> 
```

有人可以告诉我我在这里做错了什么并指出正确的方向。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:15:10.690

试试下面的代码（你的数组初始化有问题）， .value() 不是一个合适的 jQ 方法，它应该是`.val()`

```
$("#saveCategory").click (function() {
    var items = $("#jqxlistbox").jqxListBox('getItems');
    var length = items.length; 
    var mylist = [];
    for (var i = 0; i < length; i++) {
        var row = [];
        row["cname"] = items[i].value;
        row["cvalue"] = items[i].label;
        mylist[i] = row;
    }
    $("#myCatgories").val(mylist);  
}); 
```

如果这不起作用，我建议使用`console.log(mylist)`and`console.log(items)`以确保您正在获取数据而不是空字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:17:14.000

将您的输入类型从提交更改为按钮并在其点击事件中......使用`submit()`

试试这个

**HTML**

```
<input type="button" value="Save" id="saveCategory" style="margin-left: 3px" /> 
```

**jQuery**

```
$("#saveCategory").click (function() {
  var items = $("#jqxlistbox").jqxListBox('getItems');
  var length = items.length; 
  var mylist = new Array();
  for (var i = 0; i < length; i++) {
    var row = {};
    row["cname"] = items[i].value;
    row["cvalue"] = items[i].label;
    mylist[i] = row;
  }
  $("#myCatgories").val(mylist);
  $('#addcategory').submit(); //<-- submit you form here
}); 
```

# android - Android 阅读 CSV

> ID：15666277
> 
> 赞同：0
> 
> 时间：2013-03-27T18:10:59.880
> 
> 标签：android, csv

在此先感谢您的帮助。我想将 CSV 读入数组，然后在 textView 中输出内容。当我在 android 模拟器中运行此代码时，我的 textView 为空。我不知道我做错了什么。文件的读取在带有打印语句的普通 java 中工作。有人可以告诉我这里有什么错误吗？为什么代码没有在 textView 中显示 array[0][1] 内的字符串，是因为我在哪里调用它？我已经尽我所能，但似乎无法让它发挥作用。谢谢一堆。

```
package com.example.trivia;
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;
import android.app.Activity;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.widget.Button;
import android.widget.TextView;

public class PlayActivity extends Activity {
//define buttons and arrays
String [][]array;
TextView timer, questions;
Button answerA, answerB, answerC, answerD;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_play);
    initialize();

    try {
        play();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

      }

public void initialize(){
  timer = (TextView) findViewById(R.id.timer); 
  questions = (TextView) findViewById(R.id.questions);
  answerA = (Button) findViewById(R.id.buttonA);
  answerB = (Button) findViewById(R.id.buttonB);
  answerC = (Button) findViewById(R.id.buttonC);
  answerD = (Button) findViewById(R.id.buttonD);
  array = new String [117][6];
       }

public void play() throws FileNotFoundException{ 
    String delimiter = ",";
    int row =0;
    File file = new File("questions1.csv");
    Scanner sc = new Scanner(file);     

   while (sc.hasNextLine()) 
   {
   String line = sc.nextLine();
   String [] temp = line.split(delimiter);
   for(int i = 0; i< temp.length; i++){
      array[row][i] = temp[i];   
    }
   row++;
   }
   String show = array[0][1];
   questions.setText(show);

 }
} 
```

# vbscript - 如何在 vbscript 中解压缩受密码保护的文件？

> ID：15666282
> 
> 赞同：2
> 
> 时间：2013-03-27T18:11:14.027
> 
> 标签：vbscript

我对 VBScript 相当陌生。我对我想要完成的事情进行了一些广泛的研究，甚至找到了如何做的例子，但无法让它正常工作。

在我的完美世界中，我需要解压缩从第三方供应商发送到文件夹的所有压缩文件，将解压缩文件导入另一个文件夹，然后删除压缩文件。

下面的脚本适用于不受密码保护的 zip 文件，但从供应商发送的所有文件都有密码。正如在另一篇[文章](https://stackoverflow.com/questions/291406/extract-files-from-zip-file-with-vbscript)中看到的那样，我注释掉的以下几行应该插入密码，但不要。“ `...(pwd+myZipfile)`”和“ `...(pwd+extractTo)`”。

提前感谢您的帮助。请提出任何代码改进或其他方法来实现这一点。

```
pathToZipFile = "P:\ZipFiles"  
extractTo = "P:\UnZip"    
Dim fso
Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.GetFolder(pathToZipFile)
Set fc = f.Files
Dim myZipFile 
Dim intOptions, objShell, objSource, objTarget
Dim pwd
pwd = "password" 

For Each f1 in fc
On Error Resume Next

    myZipFile = f1

    '    Create the required Shell objects
    Set objShell = CreateObject( "Shell.Application" )

    '    Create a reference to the files and folders
    'Set objSource = objShell.NameSpace(pwd+myZipFile).Items( ) 
    Set objSource = objShell.NameSpace(myZipFile).Items( )

    '     Create a reference to the target folder
    Set objTarget = objShell.NameSpace(pwd+extractTo)
    Set objTarget = objShell.NameSpace(extractTo)
    intOptions = 256

    '     UnZIP the file
    objTarget.CopyHere objSource, intOptions

    '     Release the objects
    Set objSource = Nothing
    Set objTarget = Nothing
    Set objShell  = Nothing

    'Delete File from "P:\ZipFiles" after unzipping
    fso.DeleteFile f1, True

Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T21:04:42.210

如果您仔细查看来自的[答案](https://stackoverflow.com/a/6710371/1630171)`pwd+...`，您会注意到`pwd`不包含*密码*，*而是**路径*。该变量可能是以 Unix command 命名的，它代表“打印工作目录”。**[`pwd`](http://linux.die.net/man/1/pwd)**

 **据我所知，该`Shell.Application`对象不支持解压缩受密码保护的 Zip 文件。您引用的问题的[另一个答案建议使用](https://stackoverflow.com/a/692498/1630171)[DotNetZip library](http://dotnetzip.codeplex.com/)。或者你可以使用[7-zip](http://downloads.sourceforge.net/sevenzip/7za920.zip)：

```
Function qq(str)
  qq = Chr(34) & str & Chr(34)
End Function

zipfile  = "..."
password = "..."

Set sh = CreateObject("WScript.Shell")
sh.Run "7za.exe x " & qq(zipfile) & " -p" & qq(password), 0, True 
```**

# java - TCP 和服务器套接字中的 Java 线程

> ID：15666287
> 
> 赞同：2
> 
> 时间：2013-03-27T18:11:19.190
> 
> 标签：java, multithreading, sockets, serversocket

我写了以下两行

```
ServerSocket mobCom = new ServerSocket(9846);
Socket server = mobCom.accept(); 
```

我希望创建一个新的 TCP 连接并由一个新线程处理该连接。例如上面的代码创建了一个服务器套接字。并且有多个客户。每当客户端连接到服务器时，可能会创建一个新线程来满足来自该特定客户端的请求。我如何实现相同的。

**编辑**

我还想将线程池限制为 10 个用户。如果出现更多用户，我想在不处理来自他们的进一步请求的情况下向他们发送错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:09:57.920

[您可以使用 java util concurrent 的SynchronousQueue](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/SynchronousQueue.html)来实现所需的结果。创建固定数量的工人。使用**take**调用启动对 SynchronousQueue 的块读取。因此，如果所有工作人员都已完成一项工作并忙于处理它们（与套接字通信），则不会从 SynchronousQueue 读取任何内容，因此对同步队列的**提议**将失败。检查此故障（这意味着所有固定数量的工作人员都忙，现在没有人锁定到队列中），拒绝下一个请求。

以下行中的示例代码 [未经测试 - 为简洁起见避免异常，请根据您的需要进行修改]。

```
public class BoundedServer 
{
    public static void main(String[] args) 
    {
        /**
         * Port to serve
         */
        final int port = 2013;

        /**
         * Max Workers
         */
        final int maxworkers = 10; 

        /**
         * The server socket.
         */
        ServerSocket mServerSocket = null;

        /**
         * Queue of work units to process if there is a worker available.
         */
        final SynchronousQueue<WorkUnit> mQueueToProcess = new SynchronousQueue<WorkUnit>();

        /**
         * Queue of work units to reject if there is no current worker available.
         */
        final LinkedBlockingQueue<WorkUnit> mQueueToReject = new LinkedBlockingQueue<WorkUnit>(); 

        /**
         * A thread pool to handle the work.
         */
        final ExecutorService communicationservice = Executors.newFixedThreadPool(maxworkers);

        /**
         * Let a single thread take care of rejecting the requests when needed to do so.
         */
        final ExecutorService rejectionservice = Executors.newSingleThreadExecutor();

        try 
        {
            Runnable communicationlauncher = new Runnable() 
            {
                public void run() 
                {
                    try
                    {
                        /**
                         * Set of workers to handle the work.
                         */
                        final CommunicationWorker[] workers = new CommunicationWorker[maxworkers];

                        communicationservice.invokeAll(Arrays.asList(workers));
                    }
                    finally
                    {
                        communicationservice.shutdown();
                    }
                }
            };

            new Thread(communicationlauncher).start();

            Runnable rejectionlauncher = new Runnable() 
            {
                public void run() 
                {
                    try
                    {
                        RejectionWorker rejectionworker = new RejectionWorker(mQueueToReject);

                        rejectionservice.submit(rejectionworker);
                    }
                    finally
                    {
                        rejectionservice.shutdown();
                    }
                }
            };
            new Thread(rejectionlauncher).start();

            mServerSocket = new ServerSocket(port);

            while(true)
            {
                WorkUnit work = new WorkUnit(mServerSocket.accept());

                if(!mQueueToProcess.offer(work))
                {
                    mQueueToReject.add(work);
                }
            }
        } 
        finally
        {
            try
            {
                mServerSocket.close();
            }
        }
    }
}

public class WorkUnit 
{
    private Socket mSocket = null;

    public WorkUnit(Socket socket) 
    {
        super();
        this.setSocket(socket);
    }

    public Socket getSocket() {
        return mSocket;
    }

    public void setSocket(Socket mSocket) {
        this.mSocket = mSocket;
    }
}

public class CommunicationWorker 
implements Callable<Boolean> 
{
    private SynchronousQueue<WorkUnit> mQueueToProcess;

    public CommunicationWorker(SynchronousQueue<WorkUnit> queueToProcess) 
    {
        super();
        this.mQueueToProcess = queueToProcess;
    }

    @Override
    public Boolean call() throws Exception 
    {
        while(true)
        {
            WorkUnit work = mQueueToProcess.take();

            Socket socket = work.getSocket();

            // Code to handle socket communication and closure.
            // Once the communication is finished, this thread will get blocked to mQueueToProcess.
        }
    }
}

public class RejectionWorker 
implements Callable<Boolean> 
{
    private LinkedBlockingQueue<WorkUnit> mQueueToReject;

    public RejectionWorker(LinkedBlockingQueue<WorkUnit> queueToReject) 
    {
        super();
        this.mQueueToReject = queueToReject;
    }

    @Override
    public Boolean call() throws Exception 
    {
        while(true)
        {
            WorkUnit work = mQueueToReject.take();

            Socket socket = work.getSocket();

            // Code to reject the request.
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T18:13:53.060

您将不得不执行以下操作。ServiceThread 是线程将服务请求。

```
 while (true) {
              try {
                  Socket clientSocket = null;
                  if (null != serverSocket) {
                    clientSocket = serverSocket.accept();
                    ServiceThread serverThread = new ServiceThread(clientSocket); // Create a new thread for each client
                    serverThread.start();
                  }
              }  catch( Exception ex ) {
                  System.out.println("Exception while accepting connection " + ex.getMessage());
                  ex.printStackTrace();
              } 
```

# observer-pattern - 公告与经典的 Smalltalk-80 依赖/更改/更新机制有何关系？

> ID：15666290
> 
> 赞同：3
> 
> 时间：2013-03-27T18:11:34.963
> 
> 标签：observer-pattern, smalltalk, pharo

有了 Pharo Smalltalk 中可用的 Announcements 框架，还有理由使用经典的 Smalltalk-80 依赖/更改/更新机制吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:31:30.430

主要区别在于公告是从事件的发布者传播到订阅者的第一类对象，而在旧的依赖机制中只发送一个符号。因此，一个真实的对象增加了很多灵活性，但保留了旧 pub/sub 方法的优雅和简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T19:04:49.280

虽然基本原理相同，但 Announcements 框架更灵活，恕我直言更优雅。例如，您可以定义公告的层次结构并像处理异常一样处理它们。假设`Ann2`是 的子类`Ann1`，您可以：

```
anObject when: Ann1 do: [...] 
```

该块将捕获两类公告。另一个很酷的事情是，您可以为一组通知定义一个处理程序，而不是一个通知。假设`Ann3`和`Ann4`是公告，您可以：

```
anObject when: Ann3, Ann4 do: [...] 
```

并且当任何这些公告被触发时，该块将被评估。最后，由于您的事件现在是对象，您可以将行为委托给它们，这非常好。[Vassili Bykov](http://www.cincomsmalltalk.com/userblogs/vbykov/blogView?searchCategory=Announcements%20Framework&index=11)有一组关于您可能会感兴趣的主题的帖子。

回到最初的问题：我能想到的唯一“缺点”是你必须去定义一个类，而不仅仅是使用一个符号。但老实说，与您从公告中获得的收益相比，这种努力是如此之低，以至于对我来说是轻而易举的事。我真的想不出任何理由不使用公告。

高温高压

# android - google 地方 api 按距离排名

> ID：15666294
> 
> 赞同：0
> 
> 时间：2013-03-27T18:11:50.980
> 
> 标签：android, gps, google-places-api

我如何使用 rankBy=distance 按距离对地点列表进行排序，并在列表视图中的商家名称旁边显示该距离？？？

```
protected String doInBackground(String... args) {
    googlePlaces = new GooglePlaces();                      
    try {
        String types = null;
        double radius = 400;
        nearPlaces = googlePlaces.search(gps.getLatitude(),gps.getLongitude(), radius, types);
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:43:47.820

我目前正在自己​​做这件事。

1.  如 Google Places API 文档所述，请勿在 rankBy=distance 中包含“radius”参数。
2.  获取地点列表后，您将不得不再次调用以获取每个地点的详细信息，以便您可以获取每个地点的地址和纬度/纬度。
3.  然后使用当前位置，计算结果中每个地方的距离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-28T13:13:13.530

您可以使用此搜索 URL 来实现您所描述的内容：

```
private static final String PLACES_SEARCH_URL = "https://maps.googleapis.com/maps/api/place/search/json?rankby=distance&";

public PlacesList search(double latitude, double longitude, double radius, String types) throws Exception {
    this._latitude = latitude;
    this._longitude = longitude;
    this._radius = radius;
    //this._rankby=_rankby;

    try {
        HttpRequestFactory httpRequestFactory = createRequestFactory(HTTP_TRANSPORT);
        HttpRequest request = httpRequestFactory.buildGetRequest(new GenericUrl(PLACES_SEARCH_URL));
        request.getUrl().put("key", API_KEY);
        request.getUrl().put("location", _latitude + "," + _longitude);
        //  request.getUrl().put("radius", _radius);
        request.getUrl().put("rankBy", _radius);
        // in meters
        request.getUrl().put("sensor", "false");
        //request.getUrl().put("rankby", _rankby);
        if(types != null) {
            request.getUrl().put("types", types);
        }

        PlacesList list = request.execute().parseAs(PlacesList.class);
        // Check log cat for places response status
        Log.d("Places Status", "" + list.status);
        return list;
    } catch (HttpResponseException e) {
        Log.e("Error:", e.getMessage());
        return null;
    }
} 
```

# javascript - 带有函数索引器的打字稿数组

> ID：15666296
> 
> 赞同：0
> 
> 时间：2013-03-27T18:11:52.890
> 
> 标签：javascript, typescript

我想将一些函数保存到一个数组中并使用相同的函数获取它们。需要一个函数或函数引用，而不是字符串作为数组的索引器。

```
myArray: SomeClass[] = [];
myArray[func].func = func; 
```

这可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:38:37.993

这是不可能的。JavaScript 中的属性名称始终是字符串。您必须自己编写查找代码（例如使用并行数组）。

# entity-framework - 急切地加载 DbContext 中的所有实体

> ID：15666298
> 
> 赞同：0
> 
> 时间：2013-03-27T18:11:53.903
> 
> 标签：entity-framework, ef-code-first

有没有办法配置 DbContext 以急切地加载其所有实体？我们尝试过：

```
 Configuration.LazyLoadingEnabled = false;
        Configuration.ProxyCreationEnabled = false; 
```

我们尝试了关闭和不关闭 ProxyCreationEnabled。

我只是碰巧知道我们正在加载的数据库不是很大，不会经常更改，并且被大量引用。因此，将其全部保存在内存中将是非常有利的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:56:00.937

不，`LazyLoadingEnabled`禁用并不意味着“EagerLoadingEnabled”。它是：“甚至没有启用*延迟*加载，仅加载您明确请求的内容”。EF 上下文永远不会自动进行预加载。试想一下实体和大型数据库之间的许多关联会发生什么。

除非您使用仅访问本地实体的方法，否则您不会从将所有内容预加载到您的上下文中获得太多好处。[`DbSet.Local`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.local%28v=vs.103%29.aspx)您可以通过或访问本地实体[`DbSet.Find`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.find%28v=vs.103%29.aspx)。

无论如何，只要访问`DbSet`(like `context.Customers`) 就会执行数据库查询。如果延迟加载被禁用，它可能会使用本地实体作为导航属性（称为关系修复），但访问导航属性也会导致数据库查询。

听起来您应该使用上下文从数据库中填充对象图，并将其缓存在上下文之外。请注意，如果您以只读方式获取数据，则可能需要使用[`AsNoTracking`](http://msdn.microsoft.com/en-us/library/gg679352%28v=vs.103%29.aspx)扩展方法。（喜欢`context.Customers.AsNoTracking()`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:30:30.813

不...但是如果您正在寻找将批量数据加载到 EF DbContext 中的最高效方式，我建议您编写一个返回多个结果集（每个实体类型一个）的存储过程。当实体加载到上下文中时，EF 将自动连接导航属性。

以下是关于如何从数据库优先和代码优先的角度进行操作的说明：

[http://msdn.microsoft.com/en-us/data/jj691402.aspx](http://msdn.microsoft.com/en-us/data/jj691402.aspx)

# javascript - 我有由 javascript 动态创建的输入按钮，它应该调用服务器 c# 函数，但它们没有

> ID：15666299
> 
> 赞同：3
> 
> 时间：2013-03-27T18:11:55.233
> 
> 标签：javascript, asp.net

我的页面中有这个 JavaScript，它在表格中动态创建一些按钮，这些按钮必须调用服务器端的函数：

JavaScript 代码是这样的：

```
var rowContent = document.createElement('td');
rowContent.style.width = '12%';
var chk = document.createElement('input');
chk.type = 'submit';
chk.value = 'Adicionar';
chk.setAttribute('Id', 'Sub' +id);
chk.name = "ftps"
chk.setAttribute('runat', 'server');
chk.setAttribute('onserverclick', 'BtnAdicionar_Click');

rowContent.appendChild(chk); 
```

而Server端函数是这样的：

```
public void BtnAdicionar_Click(object sender, EventArgs e)
{
   Response.Redirect("Default.aspx"); //just to see if something happens.
} 
```

PS.：我在 MasterPage 中的页面中。

如果我得到 Google Chrome 的 Inspect Element 生成的按钮代码，它会给我这个：

```
<input type="submit" value="Adicionar" id="Sub1" name="ftps" runat="server" onserverclick="BtnAdicionar_Click"> 
```

如果我把这个 HTML 代码直接放在页面上，它就可以工作。只是在动态生成按钮时不起作用。

任何机构可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:01:32.097

您在这里缺少一些概念。

首先，无法使用 javascript 创建服务器元素，因为它是一种客户端语言。请记住，当您声明一个`<asp:Button runat="server">`标签时，它将由 ASP.NET 引擎解释并呈现为 HTML（`<input type="submit" />`在这种情况下）。此外，`onserverclick`事件不存在。

如果您确实需要使用 Javascript 创建此元素，您可以使用 jQuery on click 事件直接调用 ASP.NET AJAX 页面方法，如此[处所述](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)。

更好的解决方案是在页面后面的代码中动态创建 Button，例如：

```
 TableCell td = new TableCell();
 Button button = new Button();
 button.Text = "Adicionar";
 button.ID = "Sub" + id; // Whatever "id" is
 button.Click += new EventHandler(BtnAdicionar_Click);
 td.Controls.Add(td); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:46:24.687

您是否尝试将属性设置为：

```
chk.setAttribute('onclick', 'BtnAdicionar_Click'); 
```

# vba - 运行时错误“424：需要对象”

> ID：15666301
> 
> 赞同：1
> 
> 时间：2013-03-27T18:11:56.983
> 
> 标签：vba, excel, runtime-error

我在使用这段代码时遇到了困难。我正在努力做到这一点，以便根据单元格`D25`的值，值`F25`会发生变化。我在 VBA 中编写了代码（不知道这是否真的是最好的方法），它给了我一个`424 runtime error: Object Required`. 有人可以指出我正确的方向吗？

```
Sub Storage_vesel_Controle()

   Sheets("NSR Form").Select

   If Range("D25") = "1" Then Range("F25").Select.Value = "0"

   If Range("D25") = "2" Then Range("F25").Select.Value = ".95"

   If Range("D25") = "3" Then Range("F25").Select.Paste = ".98"

End Sub 
```

另外，我需要添加什么才能使代码“始终运行”......我认为循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:23:58.027

除了我上面的评论之外，我不打算发布答案，但我认为我会引起您注意的事情很少，而且评论不会​​容纳这么多的文字。

我建议不要使用`.Select`来选择工作表，而是直接使用工作表（参见下面的代码）您可能还想查看此[链接](https://stackoverflow.com/questions/10714251/excel-macro-avoiding-using-select/10718179#10718179)

```
Sub Storage_vesel_Controle()
    With Sheets("NSR Form")
        Select Case .Range("D25").Value
           Case 1: .Range("F25").Value = 0
           Case 2: .Range("F25").Value = 0.95
           Case 3: .Range("F25").Value = 0.98
        End Select
    End With
End Sub 
```

**编辑**：

关于您的编辑。您可以使用`Worksheet_Change`事件来确保 F25 的值自动更新，或者如果您想要非 VBA 解决方案，则只需使用公式`F25`

如果你有兴趣`Worksheet_Change`那么看看[这个](https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640)。否则，像这样的简单公式`F25`将足以满足您的需求:)

```
=IF(D25=1,0,IF(D25=2,0.95,IF(D25=3, 0.98,""))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:23:28.617

稍微清理一下。使用一个`Select Case`语句比使用多个 If/Then 语句更容易使用。

```
Sub Storage_vesel_Controle()
    With Sheets("NSR Form")
        .Activate  '<this line is not actually necessary unless you want to be on the sheet.
        Select Case .Range("D25").Value
            Case 1
                .Range("F25").Value = 0
            Case 2
                .Range("F25").Value = 0.95
            Case 3
                .Range("F25").Paste = 0.98
            Case Else
                'do nothing, or, modify as needed
        End Select
    End With
End Sub 
```

# javascript - 谷歌图表 - 图表不显示

> ID：15666302
> 
> 赞同：1
> 
> 时间：2013-03-27T18:12:05.907
> 
> 标签：javascript, google-visualization

这段代码旨在显示图表，但不会：

```
 google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    data.addcColumn('string', 'Type');
    data.addColumn('number', 'Job Registration');
    data.addRows([
  <?php foreach ($chart_result as $result) {
            echo $result;
        }?>  
    ]);

    var options = {
      title: 'Job Registration by Type',
      hAxis: {title: '',  titleTextStyle: {color: 'red'}}
    };

    var chart = new google.visualization.ColumnChart(document.getElementById('visualization'));
    chart.draw(data, options);
  } 
```

当我提交表单并查看页面源时，这是 data.addRows 的结果：

```
data.addRows([
  [' Engineer',1],['Assistant',1],['Developer',4],[' Ninja!',1],['Web Application Developer',1],  
    ]); 
```

这对我来说是正确的，但这是我第一次使用谷歌分析（或 JavaScript ......）并且我非常密切地关注现有图表的示例，所以它可能根本不正确。任何想法为什么这可能不起作用？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:02:33.407

你有两个问题。

首先是您没有定义数据。

将以下行添加到您的代码中：

```
var data = new google.visualization.DataTable(); 
```

第二个是愚蠢的语法错误：

```
data.addcColumn('string', 'Type'); 
```

应该：

```
data.addColumn('string', 'Type'); 
```

有了这些，就像魔法一样，它起作用了：

```
function drawVisualization() {
  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Type');
  data.addColumn('number', 'Job Registration');
  data.addRows([
    [' Engineer',1],
    ['Assistant',1],
    ['Developer',4],
    [' Ninja!',1],
    ['Web Application Developer',1],  
  ]);

  var options = {
    title: 'Job Registration by Type',
    hAxis: {title: '',  titleTextStyle: {color: 'red'}}
  };

  var chart = new google.visualization.ColumnChart(document.getElementById('visualization'));
  chart.draw(data, options);
} 
```

# c++ - 如何对向量或双端队列 KeyPair 进行排序

> ID：15666305
> 
> 赞同：1
> 
> 时间：2013-03-27T18:12:29.657
> 
> 标签：c++, vector, int, deque, std-pair

我有一个`deque <pair<int, int> > r;`. 我需要按第二个参数对所有参数进行排序，并返回`deque<int>`第一个参数。例如：

```
deque<pair<int, int> > r;
r.push_back(make_pair(1, 5));
r.push_back(make_pair(0, 8));
r.push_back(make_pair(7, 3));
r.push_back(make_pair(2, 1)); 
```

我需要这个结果

```
{2, 7, 1, 0} 
```

我有一种“蛮力”所有价值的工作方法 N ²，但它非常糟糕。也许存在这样的东西`std::`？我希望你能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:33:36.297

您可以使用[`std::sort`](http://www.cplusplus.com/reference/algorithm/sort/)并提供自己的比较器：

```
struct myclass {
    bool operator() (std::pair<int, int> i, std::pair<int, int> j) {
        return (i.second < j.second);
   }
} myobject;

std::sort(r.begin(), r.end(), myobject); 
```

我没有`deque`特别尝试过这个，但这通常是这样做的。不过，该链接有一个更详尽的示例：-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:33:43.387

您只需要定义一个比较运算符即可使用对中的第二项：

```
std::sort(r.begin(), r.end(), 
    [](std::pair<int, int> const &a, std::pair<int, int> const &b) {
         return a.second < b.second;
    }
); 
```

...或者，如果您不能使用 lambda（例如，使用太旧的编译器），您可以明确定义您的仿函数：

```
template <class T>
struct by_second { 
    bool operator()(T const &a, T const &b) { 
        return a.second < b.second;
    }
};

std::sort(r.begin(), r.end(), by_second()); 
```

从那里开始，获取每对中的第一个项目并将其放入您的结果中：

```
std::transform(r.begin(), r.end(), std::back_inserter(result),
    [](std::pair<int, int> const &p) { return p.first; }); 
```

# java - 使用 EasyMock 模拟一个抽象基类

> ID：15666311
> 
> 赞同：3
> 
> 时间：2013-03-27T18:12:38.767
> 
> 标签：java, unit-testing, junit, mocking, easymock

我有一个抽象基类（父）和一个派生类（子）

```
public class child extend parent{
    public void child(...) {
        super(..)
    }
}

public abstract class parent{
   .
   .
   .
} 
```

在这里，我想在子类中测试一个公共方法。而且我在父类中没有任何依赖关系。所以我想模拟我的抽象父类。找不到任何可靠的例子。请分享您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T11:47:04.077

你不能做这个。`child`是 的子类`parent`。你无法改变这一点。您能做的最好的事情就是在`parent`.

# database - 数据生成：生成一个具有多个日期约束的实体

> ID：15666312
> 
> 赞同：0
> 
> 时间：2013-03-27T18:12:43.033
> 
> 标签：database, date, test-data, data-generation

一个快速的，我正在寻找一种用于数据生成的工具。我有一个带日期的实体；它的日期`made`，`start`日期和`end`日期。我希望数据生成能够处理这些约束：

1.  `made`也许今天或后天
2.  `start`可能等于`made`但不是之前
3.  `end`可能只是之后的一天`start`或之后的任何其他日期`start`

我查看了[http://generatedata.com](http://generatedata.com)和[http://mockaroo.com](http://mockaroo.com)，但他们没有办法保持约束。我只需要那个约束，但不确定要尝试维护这些约束的软件。我只需要快速数据来测试我的应用程序。谢谢

渐渐地，你有没有遇到过你需要的东西找不到的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T16:43:57.383

benerator 是一种使用工具，它非常灵活，但需要快速学习它。在上述情况下，在 benerator 的 xml 文件中（这就是它所使用的），我只写了以下内容，我很高兴。事实上，我现在甚至可以为`made`、`start`和`end`日期设置范围。这是包含这些日期的实体（我们称之为 MY_ENTITY）的 30 条记录的生成标记的一部分

```
<import class="org.databene.commons.TimeUtil"/>

<generate name="MY_ENTITY" count="30" consumer="ENTITY_OUT">
    <attribute name="MADE_DATE" type="date" script ="TimeUtil.today()" />
    <variable name= "for_startDate" type="int" min="0" max="10" />
    <attribute name="START_DATE" type="date" script="TimeUtil.addDays(this.MADE_DATE, 
         for_startDate)" nullable="false"/>
    <variable name="for_endDate" type="int" min="1" max="10" />
    <attribute name="END_DATE" type = "date" script="TimeUtil.addDays(this.START_DATE, 
         for_endDate)"  nullable="false"/>
</generate> 
```

并且 benerator 通过 JDBC 支持许多数据库，并且它带有几个 JDBC 驱动程序。在这里试试[http://bergmann-it.de/test-software/index.php?lang=en](http://bergmann-it.de/test-software/index.php?lang=en)。它是开源的

# python - 使用 python 解析 xml - 根据祖父母的兄弟姐妹选择孩子

> ID：15666315
> 
> 赞同：2
> 
> 时间：2013-03-27T18:12:46.687
> 
> 标签：python, xml, elementtree

我正在尝试使用 ElementTree 来解析 xml 文件。鉴于下面的xml，我需要写入文件'chain_id'（在标题'm'下）和'name'（在标题'r'下），但前提是满足以下条件：1.）'css'（在标题'i'下）不是-0，并且2。）'bsa'> 0

当满足第二个标准时，我可以跟踪“名称”：

```
for r in root.iter('r'):
        name = r.find('name').text
        bsa = r.find('bsa').text
        if eval(bsa) > 0:
            print name 
```

但我最终得到了很多我不需要的名字，因为我不知道如何以第一个标准为条件。我已经研究过 Xpath，但我很难实现它。

总而言之，如果“m”（“css”）的兄弟姐妹具有一定的价值，我只对“m”的孩子和曾孙感兴趣。

xml 文件相当大，有 > 20 个“i”，每个“i”至少有两个“m”，每个“m”有 >100 个“r”。

我更喜欢使用标准的 python 方法（不是 lxml 或美丽的石汤）

```
<pi>
  <pe>
    <ni>20</ni>
    <i>
      <id>1</id>
      <css>-0</css>
      <m>
        <id>1</id>
        <chain_id>B</chain_id>
        <int_nres>19</int_nres>
        <rs>
          <r>
            <ser_no>1</ser_no>
            <name>MET</name>
            <seq_num>0</seq_num>
            <asa>157.15526405</asa>
            <bsa>0</bsa>
          </r>
          <r>
           .
           .
           .            
          </r>  
      <m>
        .
        .
        .
      </m>
    </i>
    <i>
      .
      .
      .
    </i>
  </pe>
</pi> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:30:42.160

```
myxml=ET.parse('path_to_yourxml')
for elem in myxml.getroot().findall('pi/pe/i'):
    if elem.find('css').text!='-0':
        for elem1 in elem.findall('m'):
            if eval(elem1.find('rs/r/bsa').text)>0:
                print elem1.find('rs/r/name').text 
```

# c - c线程和资源锁定

> ID：15666322
> 
> 赞同：1
> 
> 时间：2013-03-27T18:13:21.157
> 
> 标签：c, multithreading, resources, mutex, locks

我有一个二维数组和 8 个并发线程写入该数组。如果每个线程读取/写入不同的数组，会导致段错误吗？

例如：

```
char **buffer;
//each thread has its own thread ID
void set(short ID, short elem, char var)
{
     buffer[ID][elem] = var;
} 
```

这样可以吗？我知道这是伪代码，但你明白了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:15:07.277

如果每个线程写入不同的子数组，您的代码的这方面会很好，您将不需要锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:40:13.057

多个线程读取或写入内存本身不会导致段错误。它可以做的是导致[竞争条件](http://en.wikipedia.org/wiki/Race_condition)，其中结果不确定地取决于多个线程的操作顺序。结果取决于您对读取的内存所做的操作...如果您读取一个值然后将其用作索引或取消引用指针，即使运行代码的逻辑也可能导致越界访问只有一个线程不能。

在您的特定情况下，如果每个线程由于使用不同的 ID 而写入非重叠内存，则在访问数组时不可能出现竞争条件。*但是，在分配 ID*时可能存在竞争条件，导致两个线程接收相同的 ID ...因此您需要使用锁或其他方式来保证不会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:43:55.550

您需要注意的主要事情是如何或何时分配 2D 数组。如果所有分配都发生在工作线程开始访问数组之前，并且每个工作线程在线程的生命周期内仅读取和写入主数组的“行”之一，并且它是唯一的线程访问该行，那么访问或更新数组中的条目应该不会有任何线程问题。

如果只有一个线程正在写入一行，但多个线程可能正在从同一行读取，那么您可能需要制定一些同步计划，否则您的读者可能偶尔会看到由于并发写入者的部分写入而导致的不一致/不连贯的数据.

如果每个工作线程都硬绑定到主数组中的单个“行”，那么工作线程本身也可以分配和重新分配每行所需的内存，包括更新主数组中的插槽以指向由线程（重新）分配的行数据。主数组中的指针槽不应该有争用，因为只有这个工作线程对该槽感兴趣。确保在任何工作线程开始之前分配主数组。对于这种情况，还要确保您的 C RTL malloc 实现是线程安全的。（您可能必须在构建选项中选择线程安全的 RTL）

# ios - coretext 从文本字段的底部到顶部显示文本

> ID：15666325
> 
> 赞同：0
> 
> 时间：2013-03-27T18:13:26.987
> 
> 标签：ios, objective-c, core-text

我正在绘制一个文本字段，并在 UIView 中添加了一个文本字段。文本在路径内。它正确绘制，但内容从底部开始并在顶部结束。有没有办法来解决这个问题？

这是我的代码：

```
// Draw text into a circle using Core Text and Quartz
 - (void) drawRect:(CGRect)rect
 {
[super drawRect: rect];

CGContextRef context = UIGraphicsGetCurrentContext();
self.layer.rasterizationScale = [[UIScreen mainScreen] scale];

// Flip the context
CGContextTranslateCTM(context, 0, 3);
CGContextSetTextMatrix(context, CGAffineTransformIdentity);

CGContextSetTextMatrix(context, CGAffineTransformMakeScale(1.0f, -1.0f));

// Stroke that path
CGContextAddPath(context, backPath);
CGContextSetLineWidth(context, 1.0f);
//[[UIColor blackColor] setStroke];
CGContextStrokePath(context);

// Fill that path
CGContextAddPath(context, backPath);
[[UIColor whiteColor] setFill];
CGContextFillPath(context);

CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)string);
CTFrameRef theFrame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, string.length),backPath, NULL);
CTFrameDraw(theFrame, context);

CFRelease(framesetter);
CFRelease(theFrame);
CFRelease(backPath);

 } 
```

这就是我制作路径的方式：

```
 - (id) initWithAttributedString: (NSAttributedString *) aString path:   (vector<ofPoint>)paths
 {
 backPath = CGPathCreateMutable();

CGPathMoveToPoint(backPath, NULL, paths[0].x, paths[0].y);  // Bottom left

for(int x=1; x< paths.size(); x++){
CGPathAddLineToPoint(backPath, NULL, paths[x].x,paths[x].y);    // Bottom right
}
CGPathCloseSubpath(backPath);

 if (!(self = [super initWithFrame:CGRectZero])) return self;

 self.backgroundColor = [UIColor clearColor];
 string = aString;
 return self;
 } 
```

![图像](../Images/c0d5e0541dfe54771ee1552cf91742ab.png)

并制作文本字段：

```
 path.push_back(ofPoint(ofGetWidth()/4,ofGetHeight()/4));
    // point to user
 //   path.push_back(ofPoint((position.x-(ofGetWidth()/4))/2,ofGetHeight()/4));
    // point to right top
    path.push_back(ofPoint(ofGetWidth()/4,ofGetHeight()/4));
    // point to  end x, pos y user
    path.push_back(ofPoint((ofGetWidth()/4),(position.y-(ofGetHeight()/4))/2));

    path.push_back(ofPoint((position.x-(ofGetWidth()/4))/2-100,(position.y-(ofGetHeight()/4))/2-100));

    path.push_back(ofPoint((position.x-(ofGetWidth()/4))/2,(position.y-(ofGetHeight()/4))/2)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:22:16.033

您正在翻转文本矩阵。相反，翻转整个 CTM：

```
CGContextScaleCTM(context, 1, -1);
CGContextTranslateCTM(context, 0, self.bounds.size.height); 
```

# wpf - 在 wpf 树视图中对子节点进行分组

> ID：15666326
> 
> 赞同：0
> 
> 时间：2013-03-27T18:13:27.757
> 
> 标签：wpf, xaml, treeview, groupstyle

我想在树视图中对项目进行分组，但在第一级没有。

例如，我有一个树视图，显示如下分层视图：

```
Organization 1
 Department 1
   Person 1
   Person 2
 Department 2
   Person 1
Organisation 2
 Department 1 
```

哪里

```
 <TreeView.GroupStyle> 
```

您可以按组织分组，但我想按属性（即性别）的顺序对人员进行分组

```
 <TreeView.GroupStyle> 
```

正在为分组组织工作，但我无法为这样的树视图项目设置组样式：

```
<Style x:key="PersonNodeStyle" TargetType="TreeViewItem" >
    <Setter Property="GroupStyle">
        <Setter.Value>
            <GroupStyle>...</GroupStyle>
        </Setter.Value>
    </Setter>
</Style> 
```

为什么我无法设置 TreeViewItem 的 GroupStyle 值？

# android - 在使用 GPS 获取地理位置时出现的 android 问题

> ID：15666329
> 
> 赞同：0
> 
> 时间：2013-03-27T18:13:34.170
> 
> 标签：android, geolocation, gps

我需要一些关于位置跟踪的说明，我使用以下代码片段来获取当前用户位置，在我的代码中，我会延迟一分钟调用位置侦听器。**每次我得到不同的位置值**时，我都不会移动/干扰设备，设备放在桌子上，我不明白为什么会这样，我的代码有什么问题还是我需要做一些事情指导我，提前谢谢，

```
locationManager = (LocationManager) HomeActivity.this
                .getSystemService(Context.LOCATION_SERVICE);
        locationListener = new LocationListener() {
            public void onLocationChanged(Location location) {

                currentLatitude = Double.toString(location.getLatitude());
                currentLongitude = Double.toString(location.getLongitude());
            }

            public void onStatusChanged(String provider, int status,
                    Bundle extras) {
            }

            public void onProviderEnabled(String provider) {
            }

            public void onProviderDisabled(String provider) {
            }
        };

        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                60000, 0, locationListener);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:28:50.563

这对于 GPS 来说是正常的：
表示为 double 或 float 变量的坐标将具有几厘米或几毫米的分辨率。
但是有效精度要低得多：在天空视野良好的情况下，（外部）10m经常发生，最高可达30m。

在办公室内，您的位置会剧烈移动，最高可达 50-60m，如果您松开 GPS 并且手机切换到手机信号塔位置，则可能会发生最高 1000m 的移动。

这取决于 GPS 应用程序，但每个 GPS 应用程序都必须根据需要过滤 GPS 位置。

（设备移动时 GPS 更准确）

# ios - OpenGL ES 在动画一百层时会比 CoreAnimation 表现更好吗？

> ID：15666331
> 
> 赞同：0
> 
> 时间：2013-03-27T18:13:34.483
> 
> 标签：ios, ipad, opengl-es, core-animation

我有一个对象，它由一个 CATransformLayer 和两个 CAKeyframeAnimated 子图层组成。仅将 10 个该对象的实例添加到视图层，fps 真的下降到 ~ 10/15 fps。我不知道具体多少钱，但看起来不太好。这只制作了 20 个动画。对象的位置未设置关键帧。

我在 iPad Mini 上运行它。

这对于 iPad Mini 来说是否太过分了，还是我可以使用 OpenGL ES 获得更好的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:37:00.620

对于相当复杂的场景，我建议使用 Cocos2d。网上有一些很棒的教程。Ray 一直对这个主题有一些很好的理解，这也是我第一次学习 cocos2d 的地方。它并不像看起来那么复杂。另外，由于大量的社区支持，添加物理是轻而易举的事。（[http://www.raywenderlich.com/28602/intro-to-box2d-with-cocos2d-2-x-tutorial-bouncing-balls](http://www.raywenderlich.com/28602/intro-to-box2d-with-cocos2d-2-x-tutorial-bouncing-balls)）

# mysql - MySQL加入最大值

> ID：15666332
> 
> 赞同：11
> 
> 时间：2013-03-27T18:13:46.723
> 
> 标签：mysql, join

通过加入 entry.id 上的下表，我想从 food_brands 表中提取具有最高 type_id 的行 - 所以我应该得到下面的前 3 行，type_id 为 11940

food_brands

```
 id      brand       type_id 
        15375   cesar       11940
        15374   brunos      11940
        15373   butchers    11940
        15372   bakers      11939
        15371   asda        11939
        15370   aldi        11939 
```

类型

```
 id      type      quantity      food_id 
        11940   comm      53453         10497
        11939   comm      999           10496 
```

食物

```
 id      frequency   entry_id 
        10497   twice       12230
        10496   twice       12230
        10495   once        12230 
```

条目

```
 id     number  
         12230  26 
```

我的查询尝试没有过滤掉较低的 type.id 记录 - 所以从 food_brands 下面的表记录中，我得到了 type_id 为 11940 和 11939 的那些。感谢任何帮助解决这个问题！

```
SELECT fb.*
                        FROM food_brands fb
                        INNER JOIN types t ON fb.type_id = t.id
                        INNER JOIN
                        (
                            SELECT MAX(id) AS MaxID
                            FROM types
                            GROUP BY id
                        ) t2 ON t.food_id = t2.food_id AND t.id = t2.MaxID
                        INNER JOIN foods f ON t.food_id = f.id
                        INNER JOIN entries e ON f.entry_id = e.id
                        WHERE entries.id = 12230 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T19:00:07.417

一个简单的子查询应该就可以了；

```
SELECT * FROM food_brands WHERE type_id=
  (SELECT MAX(t.id) tid FROM types t
   JOIN foods f ON f.id=t.food_id AND f.entry_id=12230) 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!2/01d83/1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:23:13.483

如果您只想返回`food_brands`带有`max`类型 id 的行，您应该可以使用：

```
SELECT fb.*
FROM food_brands fb
INNER JOIN
(
  select max(id) id
  from types
) t
  on fb.type_id = t.id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/859f2/5)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T11:51:14.963

我不知道你为什么要在`t2`子查询之后执行所有这些内部连接，因为你只是检索 的列`fb`，但我想你没有显示整个查询，你只是想得到一个修复.

问题实际上出在子查询中`t2`：在那里，出于某种不为人知的原因，您选择执行 a`GROUP BY id`更改`MAX`函数语义以生成每个最大值的最大值`id`，并且由于您要询问该列的最大值，`MAX`并`GROUP BY`相互消除. 只需删除该`GROUP BY`子句即可修复查询。

如果由于某种不为人知的原因您不能删除该子句，也许替换`MAX(id)`并`id`添加`ORDER BY id DESC LIMIT 1`就可以了。

此外，您的子查询可能也应该选择，`food_id`因为它在后续`INNER JOIN`子句中使用。

# javascript - 在 settimeout 功能中防止 onclick 功能处于活动状态

> ID：15666335
> 
> 赞同：1
> 
> 时间：2013-03-27T18:13:48.367
> 
> 标签：javascript

我创造了一个记忆，我几乎完成了一切。我剩下的问题是，在 setTimeout 函数中，

```
setTimeout(function(){
    for(i = 0; i < guesses.length; i++){
        if(clearedPairs[i] != i){
            var reset = document.getElementById(cardPosition[i]);
            reset.removeAttribute("style");
        }
    }
    score.innerHTML = parseInt(score.innerHTML,10) - 10;
    resetValues();
}, 800); 
```

如果在另一张牌上发生点击，当它等待将两张打开的牌翻过来时，玩家将获得额外的减分，这不是应该发生的。任何人都可以帮忙吗？

如果需要，我可以发布更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:42:47.747

您可以使用变量来观察您的状态：在 setTimeout 函数中，将其设置为`true`. 完成并且可以接受点击后，将其设置为`false`. 然后只需在单击处理程序中使用`if`语句来检查状态。

```
var inFunction = false;

setTimeout(function(){
    inFunction = true;
    for(i = 0; i < guesses.length; i++){
        if(clearedPairs[i] != i){
            var reset = document.getElementById(cardPosition[i]);
            reset.removeAttribute("style");
        }
    }
    score.innerHTML = parseInt(score.innerHTML,10) - 10;
    resetValues();
    inFunction = false;
}, 800); 
```

这能解决你的问题吗？

# python - 迭代器卡住，导致无限循环

> ID：15666339
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:13:58.700
> 
> 标签：python, for-loop, python-2.7, infinite-loop

在 Python 2.7.3 中，我创建了一个 2 人游戏的自动玩游戏，其中 2 名玩家中的每一个，当轮到他们时，从以下开始：2、3、4、5、6。如果 2牌是 6，回合结束。否则，将卡片的 2 个值相加，掷出 2 个骰子并将它们的值相加。玩家在该回合获得的总点数是两张牌值的总和乘以两个骰子值的总和。第一个达到 300 分的玩家赢得比赛。

我希望能够执行 100 次“玩游戏”，每次都显示结果，并在所有游戏结束时显示每个玩家获胜的总次数。但是，我`game`在 for 循环中迭代的变量卡在`1`，即第一个游戏，导致无限循环。

这是我的代码：

```
import random
playerone = 0
playertwo = 0
playeronewins = 0
playertwowins = 0
currentplayer = 1
scoreToWin = 300
games = 100
for game in range(1,games+1):
    while playerone < scoreToWin and playertwo < scoreToWin:
        cardone = random.randint(2,6)
        cardtwo = random.randint(2,6)
        if cardone != 6 and cardtwo != 6:
            cardtotal = cardone + cardtwo
            dieone = random.randint(1,6)
            dietwo = random.randint(1,6)
            dietotal = dieone + dietwo
            points = cardtotal * dietotal
            if currentplayer == 1:
                playerone += points
            else:
                playertwo += points
            if playerone >= scoreToWin:
                print 'Game ' + str(game) + ': Player 1 wins with ' + str(playerone) + ' points. Player 2 loses with ' + str(playertwo) + ' points.'
                playeronewins += 1
                if game != games:
                    playerone = 0
                    playertwo = 0
            if playertwo >= scoreToWin:
                print 'Game ' + str(game) + ': Player 2 wins with ' + str(playertwo) + ' points. Player 1 loses with ' + str(playerone) + ' points.'
                playertwowins += 1
                if game != games:
                    playerone = 0
                    playertwo = 0
        currentplayer = 2 if currentplayer == 1 else 1
print 'Player 1 won ' + str(playeronewins) + ' times.'
print 'Player 2 won ' + str(playertwowins) + ' times.' 
```

是什么导致了这个问题，如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:21:04.463

*您在 while 循环*中将玩家分数设置为 0 ，因此它会永远持续下去。

De-dent 分数测试：

```
while playerone < scoreToWin and playertwo < scoreToWin:
    # card game loop
    # this line still belongs in the loop:
    currentplayer = 2 if currentplayer == 1 else 1

# *Now* test for the scores, *outside* the while loop
if playerone >= scoreToWin:
    print 'Game ' + str(game) + ': Player 1 wins with ' + str(playerone) + ' points. Player 2 loses with ' + str(playertwo) + ' points.'
    playeronewins += 1
if playertwo >= scoreToWin:
    print 'Game ' + str(game) + ': Player 2 wins with ' + str(playertwo) + ' points. Player 1 loses with ' + str(playerone) + ' points.'
    playertwowins += 1
playerone = 0
playertwo = 0 
```

也不需要`game != games`在那里测试。

通过这些更改，测试运行会产生：

```
Game 1: Player 2 wins with 330 points. Player 1 loses with 214 points.
Game 2: Player 2 wins with 301 points. Player 1 loses with 261 points.
Game 3: Player 1 wins with 348 points. Player 2 loses with 207 points.
# .. ~ ..
Game 98: Player 2 wins with 344 points. Player 1 loses with 248 points.
Game 99: Player 1 wins with 323 points. Player 2 loses with 173 points.
Game 100: Player 2 wins with 354 points. Player 1 loses with 105 points.
Player 1 won 45 times.
Player 2 won 55 times. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:22:34.293

您的`while`循环永远不会终止，因此您永远不会退出游戏 1。最好的解决方案是重构您的代码，以便更容易理解和推理。（提示：使用一些函数。）但是，作为对原始代码的快速修复，只需添加以下`break`语句：

```
 if playerone >= scoreToWin:
            print 'Game ' + str(game) + ': Player 1 wins with ' + str(playerone) + ' points. Player 2 loses with ' + str(playertwo) + ' points.'
            playeronewins += 1
            if game != games:
                playerone = 0
                playertwo = 0
   >>>>     break
        if playertwo >= scoreToWin:
            print 'Game ' + str(game) + ': Player 2 wins with ' + str(playertwo) + ' points. Player 1 loses with ' + str(playerone) + ' points.'
            playertwowins += 1
            if game != games:
                playerone = 0
                playertwo = 0
   >>>>     break 
```

# java - 有向加权图的复合模式

> ID：15666340
> 
> 赞同：2
> 
> 时间：2013-03-27T18:13:59.187
> 
> 标签：java, design-patterns, composite, directed-graph

将复合模式用于有向图的最佳方法是什么？该图表示软件的时间进度。节点是软件的事件（例如活动的开始）。边是活动，边的权重是活动的持续时间。例如，我有两个事件 A 和 B，以及这种关系：

A ----4---> B

这意味着完成事件 A 并启动 B 需要 4 毫秒。

显然，该图具有起始节点（仅输出边）、中间节点和最后一个节点（仅输入边）。

复合模式的一些想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:49:06.570

复合模式主要用于建模嵌套关系，其中一组对象共享单个对象的相同特征。对于您所描述的图表，我看不到任何需要像这样建模的嵌套或分组。

图可以简单地用具有通常连接的 a`Node`和 a`Edge`类建模。

# java - 如何获取没有实例或类名的类对象

> ID：15666355
> 
> 赞同：2
> 
> 时间：2013-03-27T18:14:40.037
> 
> 标签：java, class, static

我有一个`MyClass`带有静态方法的抽象类，可以用许多`MyClassDescendant`对象填充给定的集合。这个方法应该调用一个静态`getRandom()`方法`MyClassDescendant`来获取对象实例。

我当前的代码如下所示：

```
public static void populate(Collection<MyClass> coll, Class<? extends MyClass> cl, int num) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException {
    for (int i = 0; i < num; i++) {
        Method m;
        m = cl.getMethod("getRandom");
        coll.add((MyClass)(m.invoke(null)));
    }
} 
```

然后我这样称呼它：

```
MyClass.populate((Collection<MyClass>)(Collection<?>)collection, MyClassDescendant.class, 3); 
```

此代码有效，但很难看。我真正想要达到的效果是这样的：

```
MyClassDescendant.populate(collection, 3); 
```

如果它不是静态方法，我会使用`this.getClass()`. 我知道这`MyClass.class`适用于静态方法，但我不想要`class`for `MyClass`，而是特定的`MyClassDescendant`（后代类型很少）。

有没有办法在没有实例或类名的情况下获取类对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:34:22.610

由于您处于静态上下文中，因此您必须复制一些代码，但您可以进行委托。

```
public class MyClassDescendant extends MyClass {
    public static void populate(Collection<MyClass> coll, int count) {
        MyClass.populate(coll, MyClassDescendant.class, count);
    }
} 
```

现在你可以打电话 `MyClassDescendant.populate(collection, 3);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:26:38.440

如果 get random 是一个静态方法，你不能直接调用它吗？

```
public interface MyClassInterface { 
    MyClass getRandom();
}

public abstract class MyClass implements MyClassInterface {
    public static void populate(Collection<MyClass> coll, int num) {
        for (int i = 0; i < num; i++) {            
            coll.add((MyClass)MyClassDescendant.getRandom());
        }
    }
}

public class MyClassDescendant extends MyClass {
    public MyClass getRandom() {
        // implementation of getRandom
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:35:58.633

尝试以这种方式重组您的方法：

```
public static <T extends Base> void populate(Collection<T> coll, int num) throws Exception{
    for (T item : coll) {
        Method m;
        m = item.getClass().getMethod("getRandom");
        coll.add((T)(m.invoke(null)));
    }
} 
```

关于注释之一，您还可以使用[模板方法](http://en.wikipedia.org/wiki/Template_method_pattern)`getRandom()`设计模式通过将其抽象化并在您的填充方法中调用它来为您的方法利用继承。

# php - 我需要从 magento 获取 handling_fee 和 handling_type 的值

> ID：15666357
> 
> 赞同：1
> 
> 时间：2013-03-27T18:14:43.857
> 
> 标签：php, magento

我正在尝试从 Magento 中提取配置数据以执行一些前端计算。出于某种原因，表中的费率处理费被证明是困难的。

我需要从 core_config_data 中提取这些值

```
(1,'default',0,'carriers/tablerate/handling_type','P'),
(2,'default',0,'carriers/tablerate/handling_fee','18.5'), 
```

我已经尝试过其中的每一个（分别）：

```
$handlingFee = Mage::getModel('shipping/carriers/tablerate')->getHandlingFee();
$handlingFee = Mage::getModel('shipping/carriers')->getHandlingFee();
$handlingFee = Mage::getModel('carriers/tablerate')->getHandlingFee(); 
```

我也尝试了这些（基于我看到的引用我需要的值的模型：

```
$handlingFee = Mage::getModel('shipping/carriers/tablerate')->getConfigData('handling_fee');
$handlingFee = Mage::getModel('shipping/carriers')->getConfigData('handling_fee');
$handlingFee = Mage::getModel('carriers/tablerate')->getConfigData('handling_fee'); 
```

其次是：

```
echo $handlingFee; 
```

我仍在努力了解如何遍历 Magento。我错过了什么？我已经能够从其他一些桌子上拉出来就好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:39:06.570

该`core_config_data`表是一个特殊的表，它不像 Magento 的其他 CRUD 数据存储那样工作。从此表中提取数据的方法是

```
Mage::getStoreConfig('carriers/tablerate/handling_type', $store_id); 
```

其中`$store_id`等于商店视图的数字 ID。回复：`$store_id`，您在该部分的后端的此表中设置数据`System -> Configuration`- 此 UI 允许您为不同的商店设置不同的值。这就是为什么`getStoreConfig`接受 store id 参数的原因。如果你省略它

```
Mage::getStoreConfig('carriers/tablerate/handling_type'); 
```

Magento 将选择当前商店 ID 的值。您还可以使用以下方式获取数据数组

```
$array = Mage::getStoreConfig('carriers/tablerate');
var_dump($array); 
```

如果你**真的**想跳下兔子洞（你不需要）——当你使用上面的静态方法调用时，你实际上并没有从这个表中读取数据。这些配置值存储在 Magento 的全局 XML 配置树中，当 Magento 加载此树时，它会将`core_config_data`表中的值合并到主配置树中。对于一个 Stack Overflow 问题来说，详细信息太长了，但是如果您对那种深度书呆子感兴趣，那么[本系列文章](http://alanstorm.com/category/magento#magento_config)（自链接）将解释这些值是如何实际加载的。

# ios - 在未实例化的视图控制器上设置徽章值的正确方法？

> ID：15666359
> 
> 赞同：0
> 
> 时间：2013-03-27T18:14:47.527
> 
> 标签：ios, uinavigationcontroller, uitabbarcontroller, uitabbaritem

我在标签栏控制器中有 2 个视图控制器。我的第二个导航控制器想要设置一个徽章值。应用程序启动时未加载此控制器，因此不显示徽章。如果我转到该选项卡，则徽章已正确更新。

此代码段在选项卡的视图控制器加载/重新加载/更新/等时运行...

[self.navigationController.tabBarItem setBadgeValue:[NSString stringWithFormat:@"%u",[self.photos count]]];

这样做的正确方法是：使用自定义类覆盖导航控制器并将徽章值放在该级别？看来我应该把这些信息放在那里，但我还没有找到明确的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:10:49.007

当 TabBarController 被加载时，它所包含的所有初始视图控制器都被初始化。但是在您导航到相应的选项卡项之前，不会加载他们的*视图。*因此，此时您无法在任何视图加载方法（`viewDidLoad`等）中执行代码。但是，您可以通过覆盖其中一种初始化方法来执行代码。

如果使用情节提要，取消归档 viewController 的过程会在 NIB 加载时触发此方法：

```
- (void) awakeFromNib
{

} 
```

如果不使用 Storyboard，则在加载 NIB 之前调用此初始化程序：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
} 
```

在任何一种情况下，您都可以覆盖这些方法来执行一些代码......

```
- (void) awakeFromNib
    [super awakeFromNib];
    [self.navigationController.tabBarItem 
           setBadgeValue:[NSString stringWithFormat:@"badgeValue"]]];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        [self.navigationController.tabBarItem 
           setBadgeValue:[NSString stringWithFormat:@"badgeValue"]]];
    }
    return self;
} 
```

但是，您需要注意从哪里获取数据。例如，此时`self.photos`可能未初始化。如果此数据来自 userdefaults，您应该能够在此处阅读这些数据并相应地设置您的徽章。

# java - 以编程方式添加未知数量的按钮

> ID：15666362
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:06.243
> 
> 标签：java, android, eclipse

我写了一个简单的应用程序，我想在其中以编程方式添加一些按钮。问题是不确定必须添加多少按钮。我试图将“Button button = new Button”放入 for 循环中，因为我认为它只会创建一个局部变量。我想那是我的错；）

这是我的代码：

```
public class MainActivity extends Activity {

LinearLayout auswahl;

String element [] = new String [10]; //This is just an example, it would take many pages to show how this array gets created.

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    auswahl = (LinearLayout)findViewById(R.id.LinearLayout2);

    element [1] = "A";
    element [2] = "B";
    element [3] = "C";
    element [4] = "D";
    element [5] = "E";
    element [6] = "F";
    element [7] = "G";
    element [8] = "H";
    element [9] = "I";
    element [0] = "J";

    int anzahl = element.length;

    for (int i = 0; i <= anzahl; i++){
        schreibeButtons(i, element[i]);
    }

}

public void schreibeButtons(int i, String string){

    Button button = new Button(this);

    button.setText(sortiment);
    button.setWidth(auswahl.getWidth());
    button.setHeight(40);
    button.setId(i*100);

    auswahl.addView(button);
} } 
```

对我想要达到的目标有任何疑问吗？如何达到我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:24:31.160

错误 ：

```
int anzahl = element.length; 
```

大小为 n 的数组包含来自`0 to n-1,`

[prasperK](https://stackoverflow.com/users/1202025/k)已经指出了这一点。

您正在将每个按钮添加到您的`LinearLayout` `auswahl`.

您只能从中访问您的按钮

示例：按钮数量 - `auswahl.getChildCount()`; 你可以像这样访问每个按钮

获取按钮 1

```
Button button1=auswahl.getChildAt(0); 
```

或简单地使用 ID

```
Button button1=(Button)auswahl.findViewById(101); 
```

# single-sign-on - 单点登录在电视上不起作用

> ID：15666366
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:10.540
> 
> 标签：single-sign-on, samsung-smart-tv

我创建了一个基本应用程序（实际上没有内容，只是一个空白页面）来测试 SSO 功能。它不起作用，当我在电视上测试时，它给出了错误`error_cp_001`。

**config.xml**包含以下内容：

```
<cpauthjs>Authorization8888.js</cpauthjs>
<login>y</login> 
```

**Authorization8888.js**文件包含：

```
var Authorization8888 = {};
Authorization8888.checkAccount = function(id, pw, cb) {
    cb("TRUE");
}; 
```

我已经试过了`<cpauthjs>Authorization8888</cpauthjs>`。我也尝试过`Authorization`不使用 8888 作为文件名和变量。它总是显示该错误。

我也在 SDK 模拟器中尝试过，与真实电视上的错误相同。在模拟器上，我看到了这些额外的调试行：

```
[JS ALERT]:  @@@@@@@@@@@@@@@@@@@@22222eval(accountCheckFunc) error
[JS ALERT]:  Fail to load Account check moudule. 
Error : Can't find variable: Authorization8888 
```

我可以共享包含整个应用程序的 zip 文件，但复制起来非常简单，因为它除了这个基本的 SSO 相关代码之外什么都没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T09:40:14.613

我找到了答案，发布它以防其他人遇到同样的问题。

问题是通过 USB 部署。显然，使用 U 盘部署的应用程序功能有限。通过 Web 服务器部署应用程序解决了很多问题，包括这个问题。

# jquery - 覆盖jquery移动按钮边距

> ID：15666367
> 
> 赞同：3
> 
> 时间：2013-03-27T18:15:15.027
> 
> 标签：jquery, css, html, jquery-mobile, jquery-mobile-button

我在旋转我的车轮，我确信这是一个简单的错误。

考虑以下jqm（1.3版）视图（在haml中）

```
#main-header{'data-role' => 'header'}

#main-content{'data-role' => 'content'}   #main-buttons
    %input#a{'type' => 'button', 'name' => 'a', 'value' => 'A'}
    %input#b{'type' => 'button', 'name' => 'b', 'value' => 'B'} 
```

样式表：

```
#main-buttons {
  margin: 30px;
  margin-top: 160px;
}   

#a {
  margin-bottom: 60px !important;
} 
```

在这里，我应用于按钮“a”的 margin-bottom 样式没有影响。我的目标是在两个按钮之间添加一些垂直空间。我错过了什么？

渲染的 UI 如下所示：

![渲染的用户界面](../Images/776feadd5cb792bd823ef1e974859403.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T19:28:09.997

这是我谦虚的回答。以上答案更多地解释了您的问题。

要覆盖按钮样式，请将您的样式添加到`.ui-btn`.

我很高兴我得到了帮助:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:46:26.650

# 解决方案 1

这是一个从 a 标签创建的按钮。

这是一个工作示例：http: [//jsfiddle.net/Gajotres/9bPA2/](http://jsfiddle.net/Gajotres/9bPA2/)

```
<div data-role="content">
    <a data-role="button" id="button1">Button 1</a>
    <a data-role="button" id="button2">Button 2</a>
</div>

#button1 {
    margin-bottom: 50px;
} 
```

# 解决方案 2

这是您正在使用的按钮。不幸的是，您可以使用 css 来修复它，它需要通过 jQuery 来完成，如下所示：

HTML：

```
<input type="button" value="Button 3" id="button3">
<input type="button" value="Button 4" id="button4"> 
```

Javascript：

```
$('#button3').parent().css('margin-top','50px');
$('#button4').parent().css('margin-top','50px'); 
```

Live 示例是顶级 jsFiddle 示例的一部分，因此请看一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:26:55.660

首先确保您的样式表的链接列在您的 HTML 页面头部的 jQuery 移动样式表的链接之后。如果两种样式冲突，浏览器将使用第二个样式表（例如下面列出的 css）。

此外，您正在将您的 margin-bottom 添加到 ID #a。虽然这是完全有效的，但请查看 css 的其余部分以查看是否有应用于 INPUT 的边距，因为应用于标签的样式优于应用于 ID 的样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-23T11:37:40.130

也可以在每个按钮元素周围设置 div 元素。然后为这些 div 元素设置底部和顶部边距，按钮垂直间隔，因为 div 元素在 DOM 结构中是 jQuery Mobile .ui-btn:s 的父级。

这种方式的边距设置不是为整个应用程序设置的，而只是为这些按钮设置的。

HTML/CSS 示例：

```
<div class="ButtonDiv">
    <a data-role="button">Button 1</a> 
</div>

<div class="ButtonDiv">
    <a data-role="button">Button 2</a> 
</div>

<div class="ButtonDiv">
    <a data-role="button">Button 3</a> 
</div>

.ButtonDiv {
margin-top: 8px;
margin-bottom: 8px;
} 
```

# qt - 有弹性的 QListBoxWidget

> ID：15666369
> 
> 赞同：1
> 
> 时间：2013-03-27T18:15:23.730
> 
> 标签：qt, pyside, stretch, qlistwidget

### 问题

即使布局已经具有拉伸组件，如何创建具有最小高度但拉伸以填充所有可用空间的 QListWidget？

### 背景

我正在使用 PySide 创建动态用户界面。界面的组件根据上下文而变化。我的目标是有这样的垂直布局：

控件（带有标签的网格布局）
拉伸
按钮（主要操作按钮）
状态栏

按钮和状态栏只是 QHBoxLayouts。我使用的是 QDialog 而不是 QMainWindow，因为这通常在其他应用程序（如 Maya 或 Nuke）中使用。对话框是即时构建的，有时可以在显示对话框后添加 QListWidget。我无法预测何时添加拉伸以及何时不添加。

### 试验

我尝试使用其中一些代码无济于事：

```
# Set the size Policy.
listWidget.setSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Expanding)

# Set a minimum Height
count = min(listBox.count(),12)
bestHeight = count*listBox.sizeHintForRow(0)+5
listBox.setMinimumHeight(bestHeight) 
```

setMinimumHeight() 以及 setSizeHint()，我什至尝试子类化 QListWidget 来控制 sizeHint 函数。*[如何设置 QListWidgetItem 的最小高度？](https://stackoverflow.com/questions/10747752/how-to-set-minimum-height-of-qlistwidgetitem) * [QListWidget 根据内容调整大小](https://stackoverflow.com/questions/6337589/qlistwidget-adjust-size-to-content)

### 例子

这是一个完整的例子。QListWidget 没有拉伸以填充高度。如果我删除 addStretch() 行，QListWidget 会按照我的意愿执行，但我真的希望这是动态的。

```
#!/usr/bin/env python
import sys
from PySide import QtCore, QtGui

class myDialog(QtGui.QDialog):
    def __init__(self, parent=None):
        QtGui.QDialog.__init__(self, parent)
        self.setWindowTitle("Testing 123")

        # Declare Layouts.
        self.mainLayout=QtGui.QVBoxLayout()
        self.gridLayout=QtGui.QGridLayout()
        self.buttons = QtGui.QHBoxLayout()
        self.statusBarLayout = QtGui.QHBoxLayout()

        # Set margins.
        self.mainLayout.setContentsMargins(0, 0, 0, 0)
        self.gridLayout.setContentsMargins(4, 4, 4, 4)
        self.buttons.setContentsMargins(0, 0, 0, 0)
        self.statusBarLayout.setContentsMargins(0, 0, 0, 0)

        # Assemble Layouts.
        self.mainLayout.addLayout(self.gridLayout)
        self.mainLayout.addStretch()
        self.mainLayout.addLayout(self.buttons)
        self.mainLayout.addLayout(self.statusBarLayout)

        self.setLayout(self.mainLayout)

        # Fill in Grid Layout.
        row = 0
        self.gridLayout.addWidget(QtGui.QLabel("ComboBox"), row, 0)
        combo = QtGui.QComboBox()
        combo.addItems(['A','B','C','1','2','3'])
        self.gridLayout.addWidget(combo, row, 1)
        row += 1

        self.gridLayout.addWidget(QtGui.QLabel("List"), row, 0)
        listWidget = QtGui.QListWidget()
        listWidget.addItems(['A','B','C','1','2','3'])
        self.gridLayout.addWidget(listWidget, row, 1)
        row += 1

        self.gridLayout.addWidget(QtGui.QLabel("LineEdit"), row, 0)
        self.gridLayout.addWidget(QtGui.QLineEdit(), row, 1)
        row += 1

        # Add some buttons.
        for x in ['One','Two']:
            self.buttons.addWidget(QtGui.QPushButton(x))

        # Add the psuedo status bar.
        self.statusBar = QtGui.QStatusBar()
        self.statusBarLayout.addWidget(self.statusBar, 4 )

        self.statusBar.showMessage("Hello World")

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)
    dialog = myDialog()
    sys.exit(dialog.exec_()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T23:28:19.847

我已经想通了。当我将它添加到 mainLayout 时，我需要增加 gridLayout 的拉伸因子。它与 QListWidget 无关。

这是它的简短之处：

```
self.mainLayout.addLayout(self.gridLayout, 1) # stretch factor > 0
self.mainLayout.addStretch(0) # Default is 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T23:31:59.757

如果您知道分隔符的索引，请使用该[`takeAt ( int index )`](http://doc-snapshot.qt-project.org/4.8/qboxlayout.html#takeAt)方法将其删除，或者使用 a`QSpacerItem`代替，例如：

```
self.spacerItem = QtGui.QSpacerItem(
    20, 40,
    QtGui.QSizePolicy.Minimum,
    QtGui.QSizePolicy.Expanding
)
self.layout.addItem(self.spacerItem) 
```

然后删除它[`removeItem ( QLayoutItem * item )`](http://doc-snapshot.qt-project.org/4.8/qlayout.html#removeItem)：

```
self.layout.removeItem(self.spacerItem) 
```

# javascript - 三.js light 不是静态的

> ID：15666371
> 
> 赞同：1
> 
> 时间：2013-03-27T18:15:30.917
> 
> 标签：javascript, three.js, webgl

我需要创建静态光（相机移动不变），并且我需要在片段着色器中获取光的实际位置。

我现在在做什么：

```
 scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(60, canvas.width() / canvas.height(), 1, 10000);
        camera.position.z = 2000;
        camera.lookAt(0, 0, 0);

        var light = new THREE.SpotLight(0xFFFFFF, 1);
        light.position.set(0.5, 0.5, 0.1).normalize();
        camera.add(light);

        ....

        var lambertShader = THREE.ShaderLib['lambert'];
        uniformsVolume = THREE.UniformsUtils.clone(lambertShader.uniforms);

        ....

        materialVolumeRendering = new THREE.ShaderMaterial({
            uniforms: uniformsVolume,
            vertexColors: THREE.VertexColors,
            vertexShader: vertVolumeRendering,
            fragmentShader: fragVolumeRendering,
            vertexColors: THREE.VertexColors,
            lights :true
        });

        ....
        scene.add(camera); 
```

比在片段着色器中我设置统一变量：

```
uniform vec3 spotLightPosition; 
```

并计算体素的光：

```
float dProd = max(0.0, dot(getGradient(posInCube), normalize(lightPos
- posInCube)));             
voxelColored.rgb = voxelColored.rgb * dProd + voxelColored.rgb * 0.2; 
```

问题是，它不能正常工作。我的想法是，我将随着物体移动（实际上是用相机）。光仍然会从同一侧发光（在场景中是静态的）。这时光线不是静止的，工作很奇怪。

任何的想法？请问有人...

坦克很多。托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T01:41:07.333

尝试使用`PointLight`。`SpotLight`使用起来有点棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:57:56.977

要使您的灯光在位置上保持静止，请不要将其添加到相机中，而是将其添加到场景中：

场景。添加（灯光）；

要找到位置参考您用于灯光的变量。

灯光位置

# c++ - 如何在 C++ 中安全地比较 32 位整数和 64 位整数，以及如何在内部比较有符号整数？

> ID：15666372
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:15:33.403
> 
> 标签：c++, c, 64-bit, 32bit-64bit

这个问题实际上来自这个片段

```
 int a = -1;
 unsigned int c=1;
 long long b = c<<31;

 printf("%d %lld %d\n",a,b,a>b); 
```

我在 Linux gcc (GCC) 4.4.6 20110731 (Red Hat 4.4.6-3) 上测试过，结果是：-1 2147483648 0

其实我无法理解结果。我认为，当您执行 a>b 时，a 首先转换为 long long，因此 a 为 0000...01111...1（32 个零 + 32 个），b 为 000..01000...00（ 32 个零 + 一个 + 31 个零），那么 a 应该大于 b。

我是否缺少 C++ 中的整数比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:20:17.707

在比较之前， 的值`a`被转换为`long long`仍然具有值 -1 的 a。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:52:19.870

结果是正确的。a 是有符号整数，所以 -1 是负数。b 是有符号的 long long；它有一个积极的迹象。当然负数不大于正数。

如果您想（出于某种原因！）将 a 显示为 unsigned long long，则可以这样做：

printf("%ull %lld %d\n",a,b,a>b);

如果您想将其强制为 unsigned long long：

无符号 long long a=ax;

如果您想将其与 b 进行比较，从而将其视为 unsigned long long 而无需这样声明：

printf("%d %lld %d\n",a,b, a > (unsigned long long) b);

# c++ - 在 MSVC2010 Express 和 Qt 4.8 (Qt Creator 2.4.1) 中调试资源文件编译 (rc.exe)

> ID：15666375
> 
> 赞同：1
> 
> 时间：2013-03-27T18:15:39.937
> 
> 标签：c++, visual-studio-2010, resources, qt4

在将我的源文件重新组织到子目录并定向输出之后

```
CONFIG( debug, debug|release ) {
DESTDIR = $$PWD/build/debug
} else {
DESTDIR = $$PWD/build/release
}
OBJECTS_DIR = $$DESTDIR/.obj
MOC_DIR = $$DESTDIR/.moc
RCC_DIR = $$DESTDIR/.qrc
UI_DIR = $$DESTDIR/.ui 
```

似乎包含的资源文件

```
RC_FILE += res/projectname.rc 
```

没有编译成对应的.res文件，因为jom.exe快速返回

```
C:\QtSDK\QtCreator\bin\jom.exe -f Makefile.Debug
Error: dependent '"c:\path\to\projectname\build\debug\.obj\projectname.res"' does not exist. 
```

该文件确实不存在。

如果我手动运行“C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\RC.exe /r projectname.rc”并将生成的 .res 文件复制到 LIBS 的 Makefile.Debug 中指定的文件夹中， RES_FILE 并且在第一个构建规则中它工作正常。

所以问题是，为什么不再创建文件（它适用于旧项目，项目目录中的所有源文件以及默认的“发布”和“调试”目录）。

将调试选项添加到 Qt Creator 的 Project>Build Settings for qmake (-Wall) 和 jom (VERBOSE=2) 并没有产生更多关于出错的信息。

Makefile.Debug 有一个 .res 文件的目标，其中源文件没有绝对路径，但即使我完成了路径它也不起作用。

如何从 jom 获得更多调试输出以查看是否调用了 rc.exe？

这是失败时的输出：

```
18:39:45: The process "c:\qtsdk\desktop\qt\4.8.1\msvc2010\bin\qmake.exe" exited normally.
18:39:45: Starting: "C:\QtSDK\QtCreator\bin\jom.exe" VERBOSE=2
C:\QtSDK\QtCreator\bin\jom.exe -f Makefile.Debug
Error: dependent '"c:\path\to\projectname\build\debug\.obj\projectname.res"' does not exist.
jom 1.0.8 - empower your cores

jom: c:\path\to\projectname\Makefile [debug] Error 2
18:39:46: The process "C:\QtSDK\QtCreator\bin\jom.exe" exited with code 2.
Error while building project projectname (target: Desktop)
When executing build step 'Make' 
```

我还将 SDK 的路径添加到系统变量中。我正在使用 VS C++ 2010 Express 进行编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:15:39.937

**可能原因：**重新定义构建目录显然导致工具使用包含空格的绝对路径，导致程序调用失败（但哪个？rc.exe's`）

**解决方案**：没有关于获得工具链（jom 和 qmake）的正确调试输出的更多信息，但确保路径中没有空格解决了问题：可执行文件再次嵌入了其资源信息。

# iphone - 销售队伍上的 SSL 证书/流 API

> ID：15666377
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:40.407
> 
> 标签：iphone, ssl, salesforce, apple-push-notifications, urbanairship.com

我正在使用 Salesforce 开发一个混合移动应用程序。我正在处理 Apple 的推送通知服务。在苹果的开发者指南中，它要求我们在提供者服务器上安装 SSL 证书

[http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW6](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW6)

我如何在 Salesforce 上做到这一点？有没有我错过的教程。甚至可能吗？我还研究了 Saleforce 如何与 APNS 通信，并提出了两个选项。城市飞艇和流媒体 API。Urban Airship 需要花钱（在 100 万条通知之后？）所以我想使用 Streaming API。关于如何使用 Streaming API 的任何好的教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-09T19:05:43.063

从 Spring 14 版本开始，Salesforce 通过 Connected Apps 框架支持 Apple (APNS) 和 Google (GCM) 移动推送通知。请查看 Developer Force 上的移动推送通知提示表以获取更多信息：[http ://www2.developerforce.com/en/mobile/resources](http://www2.developerforce.com/en/mobile/resources)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T09:00:42.037

我对 APN 不是很熟悉，但是通过查看您提供的文档，它说：“流式 TCP 套接字设计，用于将推送通知作为二进制内容发送到 APN。” Apex 不提供制作原始 TCP 标注的方法，因此听起来这不起作用。您可以[为 HTTP callouts 设置客户端证书](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_callouts_client_certs_http.htm)，但这在这里没有帮助。

如果您想留在 Salesforce 系列中，您可以在[Heroku](http://heroku.com)上创建一个服务来监听来自 Salesforce 的事件，然后通过 TCP 套接字将它们流式传输到 APN。要将事件从 Salesforce 获取到 Heroku（或您选择的任何其他外部服务），您可以使用[Streaming API](http://wiki.developerforce.com/page/Getting_Started_with_the_Force.com_Streaming_API)、[Apex HTTP callouts](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_callouts_http.htm)或[Outbound Messaging](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_om_outboundmessaging.htm)。

# matlab - 在 Matlab 中使用负值

> ID：15666378
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:41.623
> 
> 标签：matlab

为了找到最佳拟合（通过 polyfit），我得到了负 p 值，但 matlab 不接受它（下标索引必须是真正的正整数或逻辑。）。有什么方法可以使用它吗？我想不出替代方法。我总是会得到负值。

**编辑：**

为此，我正在尝试使曲线的基线变平。我正在运行 for 循环以适应 1 到 3 个订单。然后我使用最小 normr 的值来找到最佳拟合，然后从整个曲线中减去它以获得直线基线。由于上面描述的问题，我尝试了几条曲线，但效果很好，但不适用于所有数据。

我正在处理的部分代码：

```
for i=1:3 
  [p,s]=polyfit(x,y,i); 
  a=s.normr; 
  b(i,1)=p(1); 
  normr(i,1)=a; 
  ind=find(b==min(b)); 
  mn=b(ind,1); 
  Yflat=y-mn(1)*(x-mean(x)); 
  ca{2,2}=Yflat; 
  clear a b normr p s rte ind ind2 Yflat 
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:06:46.010

当我将图像转换为负坐标时，

我通常记录一个偏移量，例如 `offset = [ -5, -8.5 ]` 并像往常一样将强度值保存在以 (1, 1) 开头的矩阵中，

但是在计算时，让坐标数组加上偏移量

例如`[ actualX, actualY ] = [ x, y ] + offset ;`

它可能需要额外的努力，但它确实有效。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:06:13.200

下面的代码（来自注释的代码 + x, y 的初始化）执行。问题是什么？

```
x = 1:50;
y = randn(size(x));

for i=1:3
    [p,s]=polyfit(x,y,i);
    a=s.normr;
    b(i,1)=p(1);
    normr(i,1)=a;
    ind=find(b==min(b));
    mn=b(ind,1);
    Yflat=y-mn(1)*(x-mean(x));
    ca{2,2}=Yflat;
end 
```

# qtp - 在 QTP 中将 HTML 标记属性捕获为对象属性

> ID：15666380
> 
> 赞同：2
> 
> 时间：2013-03-27T18:15:43.030
> 
> 标签：qtp

我有以下 HTML 标记，QTP 将其正确识别为`WebEdit`对象：

```
<input style="width: 228px;" aria-describedby="x-auto-0" _id="Tenant" name=""
tabindex="1" id="x-auto-23-input" class="x-form-field x-form-text x-form-invalid"
type="text"> 
```

如何`_id`从 HTML 标签中获取属性到 QTP 中的对象属性中？我已经使用 Object Identification 对话框将`_id`和`html _id`属性添加到`WebEdit`类中。但是，当我使用 Object Spy 或 Recorder 时，都没有填写。

请注意，正在测试的页面包含许多这样的文本输入，每个输入都有一个空白`name`但具有描述性的`_id`. 我正在尝试`_id`进入 WebEdit 的属性，以便可以通过`Browser("Browser").Page("Page"),WebEdit("_id:=Tenant")`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:11:54.893

可以通过该`.Object.GetAttribute()`函数获取 HTML 属性。这对于获取非标准属性（即“_id”）特别有用。

属性“id”与运行时对象属性“html id”对齐，因此可以使用`GetROProperty()`或上面的方法获得。

使用这些方法的示例如下：

```
Dim objUI    
Set objUI = Browser("Browser").Page("Page").WebEdit("WebEdit")
Print objUI.GetROProperty("html id")
Print objUI.Object.GetAttribute("id")
Print objUI.Object.GetAttribute("_id")
Set objUI = Nothing 
```

要使用描述性编程来访问对象，您可以使用`attribute/`符号以及正则表达式。例如：

```
Set objUI = Browser("Browser").Page("Page").WebEdit("attribute/_id:=Tenant", "html id:=x-auto-\d*-input") 
```

默认情况下，.Object 方法和属性不会在调试查看器中为 Web 元素公开。可以通过注册 IE8 中包含的 Process Debug Manager (PDM) 来增强 QTP 调试。这将帮助您发现 QTP 中可用的其他属性和方法，方法是使用`.Object`. 有关在 QTP 11 中增强调试的更多信息，请参阅以下文章： http: [//northwaysolutions.com/blog/qtp-11-how-to-enable-enhanced-debugging-features/](http://northwaysolutions.com/blog/qtp-11-how-to-enable-enhanced-debugging-features/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T09:05:13.953

您可以使用`attribute/customAttributeKey:=customAttributeValue`标识符获取具有自定义属性（属性）的对象。在你的情况下：

```
Set TenantWebEdit = Browser("Browser").Page("Page").WebEdit("attribute/_id:=Tenant") 
```

如果您想使描述唯一，这也允许您输入更多标识符：

```
Set TenantWebEdit = Browser("Browser").Page("Page").WebEdit("attribute/_id:=Tenant", "class:=.*x-form-text.*") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T23:19:38.317

我不知道这是否是*正确*`WebEdit`的方法，但我能够通过将所有对象加载到`Dictionary`它们的键控中来破解我需要的东西`_id`。

```
Dim WebEdit_desc
Set WebEdit_desc = Description.Create
WebEdit_desc("micClass").value = "WebEdit"

Dim WebEdits
Set WebEdits = CreateObject("Scripting.Dictionary")

Dim WebEdit_list
Set WebEdit_list = Browser("Browse Catalog").Page("Add Tenant").ChildObjects(WebEdit_desc)
Dim i
For i = 0 to WebEdit_list.Count() - 1
    If NOT IsNull(WebEdit_list(i).Object.GetAttribute("_id")) Then
        WebEdits.Add WebEdit_list(i).Object.GetAttribute("_id"), WebEdit_list(i)
    End If
Next
Set WebEdit_list = Nothing

WebEdits.Item("Tenant").Set DataTable("Tenant", dtLocalSheet) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-14T07:29:27.000

从浏览器文档中提取**lang**属性

`Msgbox browser("creationtime:=0").Page("index:=0").GetROProperty("attribute/lang")`

# java - 排序数组列表

> ID：15666382
> 
> 赞同：1
> 
> 时间：2013-03-27T18:15:45.800
> 
> 标签：java, sorting, arraylist

因为我刚开始使用 JAVA，所以我很好奇在 JAVA（对于 ArrayLists）中实现排序的最佳选择是什么。下面我提供我的 PHP 代码。

```
public int cmp($a, $b) {
    if ( $a[0] < $b[0] ) return 1;
    else if ( $a[0] > $b[0] ) return -1;
    else if ( $a[1] < $b[1] ) return 1;
    else if ( $a[1] > $b[1] ) return -1;
    else return 0;
}

$selected = array();

for ($i=0; $i<$len; $i++) {
    $rank = getRank();
    $cub = getCub_len();
    $selected[] = array($rank,$cub);
}

uasort($selected, 'cmp') 
```

好吧，我用JAVA写了以下代码：

```
ArrayList<ArrayList<Double>> selected = new ArrayList<ArrayList<Double>>();
ArrayList<Double> rank = new ArrayList<Double>();
ArrayList<Double> cub = new ArrayList<Double>();

for (int i=0; i<len; i++) {
 rank.add(getRank(i));
 cub.add(getCub(i));
}

selected.add(0,rank);
selected.add(1,cub); 
```

如何以`selected`正确的方式排序（类似于 PHP 函数`cmp`）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T18:19:44.743

```
Collections.sort(a); 
```

资料来源：[对 ArrayList 进行排序](http://www.mkyong.com/java/how-to-sort-an-arraylist-in-java/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T18:23:39.143

[在你的例子上试试这种方式：](https://stackoverflow.com/a/4699836/1743852)

```
public static void main(String[] args) throws Exception {
        ArrayList<String[]> listOfStringArrays = new ArrayList<String[]>();
        listOfStringArrays.add(new String[] {"x","y","z"});
        listOfStringArrays.add(new String[] {"a","b","c"});
        listOfStringArrays.add(new String[] {"m","n","o"});
        Collections.sort(listOfStringArrays,new Comparator<String[]>() {
            public int compare(String[] strings, String[] otherStrings) {
                return strings[1].compareTo(otherStrings[1]);
            }
        });
        for (String[] sa : listOfStringArrays) {
            System.out.println(Arrays.toString(sa));
        }
        /* prints out 
          [a, b, c]
          [m, n, o]
          [x, y, z]
        */ 

    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T18:18:27.127

试试这个解决方案：

```
public class SortArrayList{
    public static void main(String args[]){

        List<String> unsortList = new ArrayList<String>();

        unsortList.add("CCC");
        unsortList.add("111");
        unsortList.add("AAA");
        unsortList.add("BBB");
        unsortList.add("ccc");
        unsortList.add("bbb");
        unsortList.add("aaa");
        unsortList.add("333");
        unsortList.add("222");

        //before sort
        System.out.println("ArrayList is unsort");
        for(String temp: unsortList){
            System.out.println(temp);
        }

        //sort the list
        Collections.sort(unsortList);

        //after sorted
        System.out.println("ArrayList is sorted");
        for(String temp: unsortList){
            System.out.println(temp);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-31T14:45:40.313

```
for(int j = 0; j < myArray.size(); j++) {
        for (int i = j+1 ; i < myArray.size(); i++){
            if(myArray.get(i)[2].compareTo(myArray.get(j)[2]) < 0){
                String[] temp = myArray.get(j);
                myArray.set(j, myArray.get(i)); 
                myArray.set(i, temp); 
            }
        }
    } 
```

我正在使用第三个字段`(myArray.get(j)[2])`进行比较。我希望这会对某人有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:23:57.900

在 Java Collections 中实现排序的最简单方法是使用[Collections#sort](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List%29)方法。

它使用修改后的[合并排序](http://pt.wikipedia.org/wiki/Merge_sort)算法来完成这项工作。

重要的是，它只能对实现[Comparable](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)接口的类的对象进行排序，因此您可能需要考虑到这一点。当您实现此接口时，您应该知道最好考虑相关对象的自然顺序。例如字符串的字母顺序，如果您需要在特定上下文中以不自然的方式对其进行排序，请不要使用此接口。

为此，最好在调用该方法时定义一个[Comparator 。](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-27T18:23:58.043

这样做的方法是使用 Collections 类，并调用`Collections.sort(java.util.List, java.util.Comparator)`您的列表。它记录[在这里](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)。这里的 Comparator 是一个接口，您需要实现它才能进行自定义排序。要实现`Comparator`接口，您需要提供实现

`int compare(T o1,T o2)`和 `boolean equals(Object obj)`。

使用您在 PHP 文件中已有的逻辑。

# mysql - MYSQL：MySql 导入失败错误号：150

> ID：15666383
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:47.433
> 
> 标签：mysql

我有两个表，我正在导出这两个表模式并重命名它。我再次将相同的内容导入其中。

**脚本**

```
mysql -uroot  audit --add-drop-table=false --no-data SignInAudit UAAudit > out.sql
mysql -uroot audit -e "RENAME TABLE SignInAudit TO SignInAudit1"
mysql -uroot audit -e "RENAME TABLE UAAudit TO UAAudit1"
#Create the table again.
mysql -uroot audit < out.sql 
```

**架构**

```
CREATE TABLE `SignInAudit` (
  `SID` int(11) NOT NULL,
  `Uname` varchar(100) DEFAULT NULL,
  `IP` varchar(255) DEFAULT NULL,
  `LOGIN_TIME` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`SID`)
) ENGINE=InnoDB 

CREATE TABLE `UAAudit` (
  `SID` int(11) NOT NULL,
  `UserAgent` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`SID`),
  CONSTRAINT `UAAudit_ibfk_1` FOREIGN KEY (`SID`) REFERENCES `SignInAudit` (`SID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 | 
```

我得到了这个错误`ERROR 1005 (HY000)`。这可能是由于“UAAudit”引用了“SignInAudit”。但是，我正在以更正的顺序（SignInAudit，UAAudit）导出。

如何导入 sql？

# jquery - jquery覆盖：关闭子覆盖而不关闭父

> ID：15666384
> 
> 赞同：0
> 
> 时间：2013-03-27T18:15:52.277
> 
> 标签：jquery, click, overlay

我有一个从可点击图像调用的“父”覆盖。叠加层本身有一个图像、一个文本表、一个关闭按钮 (Close) 和“链接”，这些标记元素调用具有与父级相同格式的“子”叠加层，包括关闭按钮（尽管没有子“链接”本身）。

每次我单击“子”覆盖层上的关闭按钮时，即使我只希望孩子关闭，孩子和父母都会关闭。我认为这是因为 jquery 认为 close 事件是针对父母和孩子的，因为它们具有相同的标签和类名。

这是脚本：

```
<script type="text/javascript">
$(document).ready(function () {
    $('img[rel]').overlay({
        oneInstance: false
    });

    $('a[rel]').overlay({
        oneInstance: false,
        onLoad: function () {
            $('.close').click(function (event) {
                event.preventDefault();
                $('a[rel]').overlay().close();
            });
        }
    });
});
</script> 
```

如您所见，我试图拦截孩子的关闭点击并只关闭孩子，但它不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:20:22.123

改变

```
$('a[rel]').overlay({
    oneInstance: false,
    onLoad: function () {
        $('.close').click(function (event) {
            event.preventDefault();
            $('a[rel]').overlay().close();
        });
    }
}); 
```

至

```
$('a[rel]').each(function () {
    var that = $(this);
    that.overlay({
        oneInstance: false,
        onLoad: function () {
            $('.close').click(function (event) {
                event.preventDefault();
                that.overlay().close();
            });
        }
    });
}); 
```

# php - 序列化数组并压缩字符串以在 url 中使用它

> ID：15666390
> 
> 赞同：7
> 
> 时间：2013-03-27T18:16:21.957
> 
> 标签：php, serialization, compression

## 问题：

*   我们需要将一个数组序列化为一个短字符串，越短越好。
*   重要性更多地反映在较大的阵列上而不是较小的阵列上。
*   该字符串将在获取请求中使用，因此必须对其进行 url 解码。

## 当前代码片段

```
 /* 
    array (size=3)
      0 => string '/js/dhdbm78hdfb.js' (length=18)
      1 => string '/js/dfg4dg.js' (length=13)
      2 => string '/js/fg8hfhrt.js' (length=15)
      2 => string '/js/yjtdygj.js' (length=14)
      2 => string '/js/2q5g54rvfd.js' (length=17)
   */

  $json = json_encode($data);
  $gz = gzdeflate($json, 9);
  $base64 = base64_encode($gz);
  $paths = urlencode($base64);

  // outputs: i1aK0c8qjtFPyUhJyjW3yEhJS9LLKlbSgQmnpZukpCOLpKVbZKRlFJUgi1VmlaRUpmchCxkVmqabmhSVpaWARGMB 
```

*不是很令人印象深刻而且很慢，我认为应该有更好的方法来做到这一点......*

## 问题

解决这个问题的最佳方法是什么？我们如何呈现尽可能小的字符串？

## 附言

如果它很慢，这不是最大的问题，但它是一个需要考虑的变量。如果可能，该数组将被散列并从缓存中检索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:44:55.430

如果您希望它尽可能快且尽可能小，请放弃通用工具并使用适合您发送的特定数据的方法。去除所有数组值之间重复的任何内容（例如“/js/”和“.js”），从序列化中去除所有数组语法，只需发送一个字符串连接的唯一值列表，然后重新构建它接收端。

如果必须的话，用 gz 和 base64_encode 进一步压缩它，但是拥有唯一数据的缺点之一是它必须被唯一地表示。

在此处查看所选答案：[如何在 PHP 中压缩/解压缩长查询字符串？](https://stackoverflow.com/questions/2996049/how-to-compress-decompress-a-long-query-string-in-php)

* * *

编辑：您是否有余地来发布数据？这至少可以避免与查询字符串相关的直接大小限制。它还将避免对 URL 的字符串进行编码、增加长度的必要性，并且您应该能够直接发送压缩内容，以节省大部分费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:23:44.190

```
serialization = json_encode
compression = gzdeflate
urlsafe = base64_encode 
```

`urlencode`不需要，因为`base64_encode`只产生安全字符。我会把它`base64_encode`留在那里。您可以考虑寻找更快的串行器或更快的压缩器。如果您的输入足够短，您甚至可以省略压缩器。

* * *

算法在两个维度上具有性能特征：指令数和内存使用量。通常你会发现，如果你试图减少一个，另一个就会上升。数据库中的索引允许快速查找但占用大量空间。无索引查找速度很慢，但不需要额外的索引空间。

既然你想要*short这意味着你需要在**fast*方面做出牺牲。

* * *

老实说，我认为你在这里有一个非常理想的设置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-27T18:22:14.300

尝试使用 `gzcompress()`函数

[http://php.net/manual/en/function.gzcompress.php](http://php.net/manual/en/function.gzcompress.php)

# c# - 如何关闭 Linq-to-SQL DataClasses 连接？

> ID：15666401
> 
> 赞同：0
> 
> 时间：2013-03-27T18:16:52.980
> 
> 标签：c#, sql-server, linq-to-sql

我有一个用于进行数据库调用的 Linq-to-SQL DataClasses 对象。我把它包装成这样：

```
 public class DataWrapper {

    private DataClassesDataContext _connection = null;
    private static DataWrapper _instance = null;
    private const string PROD_CONN_STR = "Data Source=proddb;Initial Catalog=AppName;User ID=sa;Password=pass; MultipleActiveResultSets=true;Asynchronous Processing=True";

    public static DataClassesDataContext Connection {
      get {
        if (Instance._connection == null)
            Instance._connection = new DataClassesDataContext(DEV_CONN_STR);

        return Instance._connection;
      }
    }

    private static DataWrapper Instance {
      get {
        if (_instance == null) {
          _instance = new DataWrapper();
        }
        return _instance;
      }
    }
  } 
```

我有几个线程使用这个包装器来进行存储过程调用，如下所示：

```
DataWrapper.Connection.Remove_Message(completeMessage.ID); 
```

在极少数情况下，我的 DataClasses 对象会抛出异常：

> ExecuteNonQuery 需要一个开放且可用的连接。连接的当前状态为关闭。

我没有以任何方式管理连接的状态——我认为 Linq-to-SQL 应该处理这个问题。每次我拨打电话时，我都可以检查 Connection 的连接状态，如果它已关闭则打开它，但这似乎是一种黑客行为。

我尝试在连接字符串上放置`MultipleActiveResultSets=true`和`Asynchronous Processing=True`尝试处理 SQL 强制关闭连接的可能性，但这似乎没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:41:44.037

您**不应该**缓存和重用数据库连接对象......尤其是来自多个线程。

您**应该**在每次需要访问数据库时打开连接、执行操作并关闭连接。

底层数据库访问基础结构 (ASP.NET/OLEDB) 将以将大多数重新连接成本降低到（有效）零的方式管理连接池。

# clearcase - rsync 本地代码与远程 clearcase 动态视图

> ID：15666402
> 
> 赞同：2
> 
> 时间：2013-03-27T18:16:55.110
> 
> 标签：clearcase, rsync

我想将本地路径与托管在只能通过 ssh 访问的远程计算机中的动态 clearcase 视图同步：

本地：/我 | <== ssh == | 我@remote_host:/vobs/me/view_1

熟悉 clearcase 的人都知道，为了创建动态视图，您必须在远程主机“cleartool setview view_1”中发出以下命令，其中 view_1 是对预先存在的标记动态视图的引用，问题是当我尝试运行它时带有 rsync 的 --rsync-path 选项的命令，它永远不会回来：

```
$ rsync '--rsync-path=`cleartool setview view_BAAAAAD;/usr/bin/rsync`'  
 me@remote_host:/vobs/me/view_1 . 
```

cleartool：错误：未找到视图标签：“setview view_BAAAAAD”

所以看起来命令实际上是发出的，但是当我输入正确的标签时：

```
$ rsync '--rsync-path=`cleartool setview view_1;/usr/bin/rsync`'  
me@remote_host:/vobs/me/view_1 . 
```

然后它永远不会回来，当我通过 ssh 在远程主机中使用命令时，它不会要求输入（tty 或 stdin 都不是）。

所以我坚持使用静态视图。任何的想法？

PD：

*   实际方案稍微复杂一点，因为ssh连接是转发的
*   我可以使用静态视图，但我更喜欢动态视图
*   我无法在远程主机上安装任何守护程序或脚本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:27:10.647

> 为了创建动态视图，您必须在远程主机“cleartool setview view_1”中发出以下命令，其中 view_1 i

不，你没有。

*   你只需要启动它：`cleartool startview view_1`
*   你可以使用它`/view/view_1/vobs/avob/....`

[避免`setview`创建一个](https://stackoverflow.com/a/10252612/6309)PATH 可能不正确的子shell。

# video-streaming - 无法让 gstreamer 生成去隔行视频

> ID：15666405
> 
> 赞同：2
> 
> 时间：2013-03-27T18:17:08.660
> 
> 标签：video-streaming, gstreamer, video-processing, rtsp, interlacing

背景：

*   我正在从 Bosch VideoJet x40 网络视频编码器流式传输视频。它最多可读取 4 个模拟摄像机输入并输出 RTP 流。
*   我正在提供来自旧 VCR（拯救大兵瑞恩！）的测试镜头，使用一根黄色视频复合电缆将其连接到网络编码器的输入。
*   这些**RTP 流作为 H.264 编码视频**在 UDP/RTP 数据包上发送。**YUV I420 颜色空间**中的编码视频数据。

我的 gstreamer 管道读取 RTP 数据包，将它们从 YUV 转换为原始 RGB，然后保存它们。到目前为止，它在这方面工作正常：

```
gst-launch --gst-debug=2 -vv udpsrc caps="application/x-rtp,media=(string)video,clock-rate=(int)90000,encoding-name=(string)H264" port=33314 ! rtph264depay ! h264parse ! ffdec_h264 ! ffmpegcolorspace ! "video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false" ! filesink location="privateryan.rgb" 
```

这是该命令的调试输出，该命令大部分正常工作并保存 RAW RGB 视频输出。这个文件在几秒钟后就很大（正如预期的那样），所以如果你运行这个命令要小心：

```
Setting pipeline to PAUSED ...
/GstPipeline:pipeline0/GstUDPSrc:udpsrc0.GstPad:src: caps = application/x-rtp, media=(string)video, payload=(int)96, clock-rate=(int)90000, encoding-name=(string)H264
Pipeline is live and does not need PREROLL ...
Setting pipeline to PLAYING ...
New clock: GstSystemClock
/GstPipeline:pipeline0/GstRtpH264Depay:rtph264depay0.GstPad:src: caps = video/x-h264
/GstPipeline:pipeline0/GstRtpH264Depay:rtph264depay0.GstPad:sink: caps = application/x-rtp, media=(string)video, payload=(int)96, clock-rate=(int)90000, encoding-name=(string)H264
/GstPipeline:pipeline0/GstH264Parse:h264parse0.GstPad:sink: caps = video/x-h264
/GstPipeline:pipeline0/GstH264Parse:h264parse0.GstPad:src: caps = video/x-h264, parsed=(boolean)true, stream-format=(string)byte-stream, alignment=(string)au
/GstPipeline:pipeline0/ffdec_h264:ffdec_h2640.GstPad:sink: caps = video/x-h264, parsed=(boolean)true, stream-format=(string)byte-stream, alignment=(string)au
/GstPipeline:pipeline0/GstH264Parse:h264parse0.GstPad:src: caps = video/x-h264, width=(int)704, height=(int)240, parsed=(boolean)true, stream-format=(string)byte-stream, alignment=(string)au
/GstPipeline:pipeline0/ffdec_h264:ffdec_h2640.GstPad:sink: caps = video/x-h264, width=(int)704, height=(int)240, parsed=(boolean)true, stream-format=(string)byte-stream, alignment=(string)au
/GstPipeline:pipeline0/ffdec_h264:ffdec_h2640.GstPad:src: caps = video/x-raw-yuv, width=(int)704, height=(int)240, framerate=(fraction)25/1, format=(fourcc)I420, interlaced=(boolean)false, pixel-aspect-ratio=(fraction)5/11
/GstPipeline:pipeline0/GstFFMpegCsp:ffmpegcsp0.GstPad:src: caps = video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false, width=(int)704, height=(int)240, pixel-aspect-ratio=(fraction)5/11, red_mask=(int)16711680, green_mask=(int)65280, blue_mask=(int)255, endianness=(int)4321
/GstPipeline:pipeline0/GstFFMpegCsp:ffmpegcsp0.GstPad:sink: caps = video/x-raw-yuv, width=(int)704, height=(int)240, framerate=(fraction)25/1, format=(fourcc)I420, interlaced=(boolean)false, pixel-aspect-ratio=(fraction)5/11
/GstPipeline:pipeline0/GstCapsFilter:capsfilter0.GstPad:src: caps = video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false, width=(int)704, height=(int)240, pixel-aspect-ratio=(fraction)5/11, red_mask=(int)16711680, green_mask=(int)65280, blue_mask=(int)255, endianness=(int)4321
/GstPipeline:pipeline0/GstCapsFilter:capsfilter0.GstPad:sink: caps = video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false, width=(int)704, height=(int)240, pixel-aspect-ratio=(fraction)5/11, red_mask=(int)16711680, green_mask=(int)65280, blue_mask=(int)255, endianness=(int)4321
/GstPipeline:pipeline0/GstFileSink:filesink0.GstPad:sink: caps = video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false, width=(int)704, height=(int)240, pixel-aspect-ratio=(fraction)5/11, red_mask=(int)16711680, green_mask=(int)65280, blue_mask=(int)255, endianness=(int)4321 
```

录制后，我使用 Vooya 原始序列播放器检查文件并播放它们。但是，如果没有告诉 Vooya 视频是隔行扫描的，文件就无法正确播放。

我需要平面封装框架，以后可以提取这些框架用于计算机视觉应用。

在这里您可以看到正在播放的视频，尽管视频格式错误（隔行扫描）：

[http://i.imgur.com/QDZSWdJ.png](http://i.imgur.com/QDZSWdJ.png)

当我将设置更改为所需的设置时，您可以在此处看到视频未播放：

[http://i.imgur.com/zSrOvFj.png](http://i.imgur.com/zSrOvFj.png)

因此，我尝试将 deinterlace 插件添加到我的管道中，但没有成功。我可能做错了什么？

这是我的新管道，在文件接收器之前有**去隔行：**

```
gst-launch --gst-debug=1 -v udpsrc caps="application/x-rtp,media=(string)video,clock-rate=(int)90000,encoding-name=(string)H264,frame-rate=(fraction)25/1" port=33314 ! rtph264depay ! ffdec_h264 ! ffmpegcolorspace ! "video/x-raw-rgb, bpp=(int)24, depth=(int)24, framerate=(fraction)25/1, interlaced=(boolean)false" ! deinterlace ! filesink location="privateryan.rgb"
0:00:00.096569700 12969       0x607080 ERROR           GST_PIPELINE ./grammar.y:614:gst_parse_perform_link: could not link ffmpegcsp0 to deinterlace0
WARNING: erroneous pipeline: could not link ffmpegcsp0 to deinterlace0 
```

为什么我的视频在所有这些处理之后仍然出现隔行扫描，关于隔行扫描插件我可能做错了什么？

我认为 VCR 或 B&W 摄像机可能会在其末端交错视频，但我不确定。即使它们是，我也无法改变它，仍然需要去隔行扫描。

谢谢！

# javascript - 了解一个 JS 不明显的 oneliner。逗号分隔符

> ID：15666407
> 
> 赞同：1
> 
> 时间：2013-03-27T18:17:18.040
> 
> 标签：javascript

我不明白这行 javascript ：

（我是一个循环计数器）

```
var m;

t[i] == '@' ? m = '' : t[i] == '_' ? m = null : (c = t[i].charAt(0), m = c == '@' || c == '_' ? t[i].substring(1) : t[i]) 
```

我可以理解这个`value == other ? true : false`技巧，但是我完全被其中一个的嵌套、括号的使用和逗号的使用弄得一团糟。

谁能猜出这是怎么想的？我什至没有示例用法：/因为调用是错误的...

我也对该`m = c == '@`条款有疑问必须将其理解为`m = c ;`紧随其后`c == '@'`还是`m = condition ? value if true : value if false) ?`

此处逗号的用法与使用 a 相同；?

我认为这样做的目的是去除一些特殊的字符 @ 和 _ 但它太复杂了！

我希望有许多带有明确`if`条款的行，而不是这一行

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:35:07.830

您始终可以重新格式化三元运算符语句以使其更具可读性。格式化是您发现`if`更具可读性的原因之一：

```
t[i] == '@' ?
    m = '' :           // if it's an @
    t[i] == '_' ?      // else:
        m = null :     // if it's a _
        (              // else:
             c = t[i].charAt(0), // c = first character
             m =                 // m = one of the following:
                 c == '@' || c == '_' ?   // if @ or _ is first character
                     t[i].substring(1) :  // the string minus @ or _
                     t[i]                 // else the string itself
        ) 
```

请注意，最外面的三元运算符的结果被丢弃，这是非常非常难看的代码。相反，它滥用了三元运算符的条件部分可以是一个表达式并在那里对 m 进行赋值的事实。

基本上上面是一种复杂的写作方式：

```
if (t[i] =='@') {
    m = '';
}
else if  (t[i] =='_') {
    m = null;
}
else {
    m = t[i].replace(/^[@_]/,''); // replace leading @ or _ with nothing
} 
```

如果您仍然需要使用三元运算符并且没有正则表达式，则更好的实现将是：

```
var str = t[i];
var c = str.charAt(0);

m = str == '@' ?             // if @
        '' :
    str == '_' ?             // if _
        null :
    (c == '@' || c == '_') ? // if starts with @ or _
        str.substring[1] :
                             // else don't modify the string
        str; 
```

请注意，在上面的语句中，我们将三元运算符的结果分配给，`m`而不是在任何评估的语句中进行分配。这首先是三元运算符的优势`if`。另请注意，大括号`()`严格来说不是必需的，但它们增加了代码的可读性（恕我直言）。

# django - “instancemethod”对象没有属性“__getitem__”

> ID：15666408
> 
> 赞同：14
> 
> 时间：2013-03-27T18:17:16.953
> 
> 标签：django, django-views

我不断收到此错误：

```
TypeError: 'instancemethod' object has no attribute '__getitem__' 
```

以我对我正在玩的 django 网站的特殊看法。我不知道为什么，但我觉得这可能与我从模型中检索特定对象的方式有关。

错误发生在这里：

```
def myview(request):
    if request.method == 'POST':
        tel = request.POST.get['tel_number']
        person = get_object_or_404(Employee,phone_number=tel) # HERE 
```

我有一个这样的 Employee`phone_number`模型`CharField`：

```
class Employee(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)
    phone_number = models.CharField(max_length=10) 
```

request.POST 数据是从 android 应用程序发送的。我要做的就是检索具有特定 phone_number 值的 Employee 对象。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-27T18:20:33.273

问题出在这一行`tel = request.POST.get['tel_number']`。如果您正在使用`.get`，则应将密钥作为参数传递：

```
tel = request.POST.get('tel_number') # if key is not present by default it will return None 
```

否则你可以这样做：

```
tel = request.POST['tel_number'] # raise KeyError Exception if key is not present in dict 
```

# java - GWT 客户端全局配置值

> ID：15666414
> 
> 赞同：3
> 
> 时间：2013-03-27T18:17:25.907
> 
> 标签：java, gwt

我需要在我的 GWT 应用程序的客户端存储一些配置参数——我只使用框架的客户端。我只想存储 API 访问 URL 库之类的东西。

理想情况下，如果动态读取它会很好，但我可以忍受在每次编译时静态烘焙这些值。

在网上搜索答案时，我不断遇到所有延迟绑定和语言环境管理的东西。我不在乎这些。我只想设置一些属性`api.url`，并从 Java 代码中读取它。如果做不到这一点，我想将它设置在一个外部 JavaScript 文件中，并以某种方式从生成的主要 JS 代码中读取它。但是，保持简单是一个重要目标。我不想走一些 Rube Goldberg 式的 JSNI 怪物的道路。

有什么方法可以通过某种属性文件或*简单*的JSNI 导入机制来实现吗？还是我非常坚持使用`Constants`基于 - 的配置类（仍然需要重新编译才能烘烤）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:06:59.117

这就是您要查找的内容：http: [//www.gwtproject.org/articles/dynamic_host_page.html](http://www.gwtproject.org/articles/dynamic_host_page.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:55:35.447

为了在每次配置更改时避免编译，我想建议`RPC call of configuration parameters in onmodule load`.

如果成功，您可以将这些参数分配给您的 Gwt 静态变量，这些变量在整个 Gwt 代码中都可用。

这可能会减轻痛苦，您可以更改服务器端的参数并再次部署，**无需每次编译单行更改**。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-27T18:36:06.810

您可以在模块 xml 上定义一个属性。像这样：

```
<define-property values="desenv, production" name="environment"/>
<set-property name="environment" value="production"/> 
```

# cuda - 在 CUDA 上处理双精度值（计算能力 1.1）

> ID：15666415
> 
> 赞同：0
> 
> 时间：2013-03-27T18:17:27.723
> 
> 标签：cuda, compute-capability

我的代码正在为大量数据计算 3D-DCT。

它在 GeForce 9400M 上运行，计算能力 1.1（据我所知不支持双精度）。

有没有办法启用它，或者正确处理这些值？

# windows - Windows 命令解释器中历史缓冲区的押韵或原因？

> ID：15666417
> 
> 赞同：2
> 
> 时间：2013-03-27T18:17:31.360
> 
> 标签：windows, command-line, windows-xp, command-prompt

当我在 bash 之类的 shell 中时，如果我使用向上箭头浏览命令行历史缓冲区，它会以可预测的方式运行：向上点击会转到我最近执行的命令。

在 Windows cmd.exe（“DOS”）shell 中，有时点击向上箭头会转到最近的命令，有时会转到第二个最近的命令，甚至是第三个最近的命令。有时，要访问我输入的最新命令，我实际上必须按下*向下*箭头！*有时我必须按两次*向下箭头！

这是什么逻辑？很长一段时间以来，它一直让我发疯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T05:47:00.540

向上/向下箭头选择的命令是相对于最后选择的重复。

所以如果你已经执行

```
line 1
line 2
line 3
line 4 
```

然后按向上箭头 3 次，`enter`将重新选择并执行`line 2`

从那里，您可以向下箭头一次以重新选择`line 3`或两次为`line 4`或向上箭头一次为`line 2`，两次为`line 1`

但是执行的新行被附加到列表中，如果您手动输入一行，选择器会再次移动到列表的底部。

如果该行与最后一个条目重复，则不会将其输入到列表中，因此您可以根据需要向上箭头并执行一千次，向上箭头两次将获得 (-1001st) 命令进入。

# c# - 如何找到 2 个 IEnumerable 对象之间的差异

> ID：15666418
> 
> 赞同：7
> 
> 时间：2013-03-27T18:17:33.200
> 
> 标签：c#, .net

我有 2 个指南列表：

```
IEnumerable<dynamic> userids = null;
IEnumerable<dynamic> lsCheckedUsers = null; 
```

userids 和 lsCheckedUsers 列表是使用 dapper 从 SQL 数据库填充的。

我现在希望找到所有不在 lsCheckedUsers 中的用户 ID。

我试过以下

```
var userdifference = userids.Where(i => !lsCheckedUsers.Contains(lsCheckedUsers));
var userdifference = userids.Except(lsCheckedUsers); 
```

以上实际均未返回 2 之间的差异。

如何获得两者中都不存在的 guid 的差异。

我确定 lsCheckedUsers 在用户 ID 中有 Guid

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T18:51:06.343

**这是对的：**

`var userdifference = userids.Except(lsCheckedUsers);`

`IEnumerable<dynamic>`如果你们两个都实际包含，它将起作用`Guids`。打印或检查每个项目以确保它们是`Guids`.

如果这是您所期望的，您应该真正使用`IEnumerable<Guid>`并将传入的项目转换为。`Guids`它有望防止像您可能看到的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:27:38.447

沿着这些线的东西..

```
var difference = list1.Where (e => !list2.Any(a => a == e)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:22:18.737

你有：

```
var userdifference = userids.Where(i => !lsCheckedUsers.Contains(lsCheckedUsers)); 
```

但我认为你的意思是：

```
var userdifference = userids.Where(i => !lsCheckedUsers.Contains(i)); 
```

**更新：**

对于由于“参考”比较而标记这些答案的每个人，请考虑 Guid 是一种值类型，因此其相等性的评估方式不同。试试这个简单的测试来说服自己：

```
var guid = Guid.NewGuid();
var guids = new[] { new Guid(guid.ToString()) };

Console.WriteLine(guids.Contains(guid)); 
```

您会看到结果为 True。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T18:43:18.663

Enumerable 有一个 except 方法

[Enumerable.Except 方法（IEnumerable、IEnumerable）](http://msdn.microsoft.com/en-us/library/bb300779%28v=vs.100%29.aspx)

并使用字符串或 GUID。
它将比较等于的值。

HashSet exceptWith 可能会有更好的性能。
但如果您需要允许重复，则不能使用 HashSet。

[HashSet.ExceptionWith 方法](http://msdn.microsoft.com/en-us/library/bb299875.aspx)

# jquery - 为什么 jQuery Font Resizer 不调整大小？

> ID：15666424
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:18:03.240
> 
> 标签：jquery

我在这个[页面上](http://energync.ehclients.com/news/article/usgbc-nc-the-nc-sustainable-energy-association-collaborate-on-legislative-a#)添加了一个字体调整器，它看起来不错，但字体没有调整大小。

我的目标 HTML 是 .news p

jQuery是这样的：

```
<script type="text/javascript">
 $('.news p').jfontsize();
</script> 
```

但是，当我单击放大字体时，没有任何反应。我将不胜感激有关如何解决此问题的指导。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:24:37.843

这是你的错误。

`Uncaught TypeError: Cannot read property 'btnMinusClasseId' of undefined`

查看您的 html 和插件的文档，您没有`ids`在调整大小按钮上正确放置。[http://www.jfontsize.com/](http://www.jfontsize.com/)

改变：

```
<div id="font-resizer">
      <a class="jfontsize-button" id="jfontsize-m2" href="#">A-</a>
      <a class="jfontsize-button" id="jfontsize-d2" href="#">A</a>
      <a class="jfontsize-button" id="jfontsize-p2" href="#">A+</a>
</div> 
```

到：

```
<div id="font-resizer">
      <a class="jfontsize-button" id="jfontsize-minus" href="#">A-</a>
      <a class="jfontsize-button" id="jfontsize-default" href="#">A</a>
      <a class="jfontsize-button" id="jfontsize-plus" href="#">A+</a>
</div> 
```

如果它引用旧的`id`.

# scala - Scala REPL：如何将远程 Maven 存储库添加到 Scala REPL 类路径？

> ID：15666425
> 
> 赞同：8
> 
> 时间：2013-03-27T18:18:04.677
> 
> 标签：scala, maven, read-eval-print-loop

Scala REPL 非常适合尝试不同的代码片段。如果可以使用 Scala REPL 中的 Maven 存储库中的库运行代码，那就太好了。如何将远程 Maven 存储库添加到 Scala REPL 类路径？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-27T18:24:55.323

你可以做到这一点，使用[maven-scala-plugin](http://scala-tools.org/mvnsites/maven-scala-plugin/usage_console.html)：

```
$ mvn scala:console
...
import com.some.dependency 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T22:56:11.417

我在 SBT 中做的每一件事都非常重要。在一个地方，您定义所有依赖项的 SBT `build.sbt`（或用于高级用途）、生成 IDE 项目文件并使用类路径中存在的所有依赖项运行 REPL。`.scala`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-06T19:57:45.457

您可以从头开始 - 使用 sbt - 但无需 build.sbt

首先创建 sbt 项目：

```
sbt -sbt-create 
```

现在添加解析器（或其他变量）

```
set resolvers += "Sonatype OSS Snapshots" at "https://oss.sonatype.org/content/repositories/snapshots" 
```

您可以修改所有设置。例如添加依赖

```
set libraryDependencies += "ch.qos.logback" % "logback-classic" % "1.2.3" 
```

仅供测试：

```
sbt:test> console
[info] Updating ...
[info] Done updating.
[info] Starting scala interpreter...
Welcome to Scala 2.12.7 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_201).
Type in expressions for evaluation. Or try :help.

scala> import org.slf4j._
import org.slf4j._

scala> val logger = LoggerFactory.getLogger("Test")
logger: org.slf4j.Logger = Logger[Test]

scala> val logger = LoggerFactory.getLogger("Test")
logger: org.slf4j.Logger = Logger[Test] 
```

如果您想保留您的设置，只需调用（您可以使用 CRTL+D 离开交互式控制台模式）

```
sbt:test> session save 
```

您的输出将保存在当前目录的 build.sbt 中。

对于 linux/mac

```
> cat build.sbt 
```

对于 Windows（未测试）

```
> type build.sbt 
```

输出：

```
resolvers += "Sonatype OSS Snapshots" at "https://oss.sonatype.org/content/repositories/snapshots"

libraryDependencies += "ch.qos.logback" % "logback-classic" % "1.2.3" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-19T22:44:36.607

您可以仅使用 build.sbt 文件测试您的代码，我必须访问 S3 Java 代码才能在远程服务器上对其进行测试。

```
$ mkdir code-test
$ mkdir -p code-test/project
$ cd code-test
$
$ touch build.sbt
$
$ touch project/build.properties
$ echo 'sbt.version = 1.3.10' > project/build.properties
$
$ touch project/plugins.sbt
$ echo 'addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.14.7")' > project/plugins.sbt 
```

在这里，我使用多个依赖项以及解析器进行演示。

随意填充你的 build.sbt 。

我的作为参考

```
$ cat build.sbt

resolvers ++= Seq(
  "Redshift" at "http://redshift-maven-repository.s3-website-us-east-1.amazonaws.com/release"
)

libraryDependencies ++= Seq(
        "com.amazonaws" % "aws-java-sdk-s3" % "1.11.785",
        "com.amazon.redshift" % "redshift-jdbc42" % "1.2.41.1065"
)

assemblyMergeStrategy in assembly := {
  case PathList("META-INF", xs@_*) => MergeStrategy.discard
  case x => MergeStrategy.first
} 
```

一旦您的文件中有适当的依赖项。

```
$ sbt

[info] Loading project definition from /home/snk01/code-test/project
[info] Loading settings for project code-test from build.sbt ...
...
[info] Starting scala interpreter...
Welcome to Scala 2.12.10 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_181).
Type in expressions for evaluation. Or try :help.

$ sbt:code-test> 
```

这将加载所有依赖项

```
$ sbt:code-test> console 
```

上面的行将启动一个 scala repl，其中所有依赖项都加载到你的类路径中。

如果您正在开始/尝试新事物，我建议您使用@Andrzej 的方法。

学分-@Andrzej

# android - 向网络服务器发送数据时强制关闭

> ID：15666427
> 
> 赞同：0
> 
> 时间：2013-03-27T18:18:17.837
> 
> 标签：android

我尝试将数据发送到 Web 服务器。

第一的。我只`HttpResponse`用来知道数据是否在设备中发送并且它有效

我试图`ResponseHandler`知道数据是在网络服务器中发送还是未读取。

我创建了两个响应。

当数据未发送或失败时，
错误消息和 toast 都会显示并正常工作

但是当发送数据时，显示吐司但不显示错误消息然后强制关闭

这是我的代码

```
private boolean SendDataFoto(CPetakRecord rec){

        String slon=String.format("%f", rec.dLongitude);
        String slat=String.format("%f", rec.dLatitude);
        String sacc=String.format("%f", rec.dAccuracy);
        String jnsHm=String.format(rec.jenisHm);
        String jmlHm=String.format(rec.jumlahHm);
        String jnsMsh=String.format(rec.jenisMsh);
        String jmlMsh=String.format(rec.jumlahMsh);
        String intens=String.format(rec.intensitas);
        String luasAncam=String.format(rec.luasTerancam);
        String nmPetak=String.format(rec.nmPetak);
        String code=String.format(rec.code);
        String userId=String.format(rec.userId);
        String varietas=String.format(rec.varietas);
        String dbLon=String.format("%f", rec.dbLon);
        String dbLat=String.format("%f", rec.dbLat);

        File file=new File(rec.sFilename);
        String sfname=file.getName();
        String cfname=file.getName();
        String lfname=rec.sFilename;
        sfname = sfname.substring(0, sfname.lastIndexOf("."));
        Calendar cal=Calendar.getInstance();
        cal.setTime(new Date(rec.lDate));
        String sdat=CUtilities.DateToString(cal);

        String url;
        String spetak;
        if (CGeneral.nPetakTetap==CGeneral.ACTIVITY_FOR_PETAK){
            url = CGlobalConfig.getURLRcvrPetak();
            spetak="petak";
        }
        else{
            url = CGlobalConfig.getURLRcvrPeliharaImage();
            spetak="pelihara";
        }

        Bitmap bmp=BitmapFactory.decodeFile(lfname);
        ByteArrayOutputStream bao = new ByteArrayOutputStream();

        bmp.compress(Bitmap.CompressFormat.JPEG, 90, bao);

        byte[] ba = bao.toByteArray();

        HttpEntity entity=null;

        try {

            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(url);
            ByteArrayBody bab = new ByteArrayBody(ba, spetak+"_"+cfname);
            MultipartEntity reqEntity = new MultipartEntity(
            HttpMultipartMode.BROWSER_COMPATIBLE);
            reqEntity.addPart("image", bab);
            reqEntity.addPart("category", new StringBody(spetak));
            reqEntity.addPart("foto", new StringBody(spetak+"_"+cfname));//
            reqEntity.addPart("tgl", new StringBody(sdat));//
            reqEntity.addPart("lat_petak", new StringBody(slat));//
            reqEntity.addPart("lon_petak", new StringBody(slon));//
            reqEntity.addPart("accuracy", new StringBody(sacc));
            reqEntity.addPart("jenis_hama", new StringBody(jnsHm));//
            reqEntity.addPart("jumlah_hama", new StringBody(jmlHm));//
            reqEntity.addPart("jenis_musuh", new StringBody(jnsMsh));//
            reqEntity.addPart("jumlah_musuh", new StringBody(jmlMsh));//
            reqEntity.addPart("int_serangan", new StringBody(intens));//
            reqEntity.addPart("luas_terancam", new StringBody(luasAncam));//
            reqEntity.addPart("nama_petak", new StringBody(nmPetak));//
            reqEntity.addPart("code_db", new StringBody(code));//
            reqEntity.addPart("user_id", new StringBody(userId));//
            reqEntity.addPart("varietas", new StringBody(varietas));//
            reqEntity.addPart("lon_db", new StringBody(dbLon));//
            reqEntity.addPart("lat_db", new StringBody(dbLat));//

            httppost.setEntity(reqEntity);
            HttpResponse response = httpclient.execute(httppost);
            ResponseHandler<String> responseHandler = new BasicResponseHandler();
            String response2 = httpclient.execute(httppost, responseHandler);
            //if (response.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
            final String reverseString = response2;
            runOnUiThread(new Runnable() {
                  public void run() {
                      Toast.makeText(UpdateLog.this, "response : " + reverseString, Toast.LENGTH_LONG).show();
                  }
                });
            entity = response.getEntity();
            //}

        }

        catch (final ClientProtocolException e) {
            runOnUiThread(new Runnable() {
                  public void run() {
                      Toast.makeText(UpdateLog.this, "CPE response " + e.toString(), Toast.LENGTH_LONG).show();
                  }
                });
        // TODO Auto-generated catch block
        } catch (final IOException e) {
            runOnUiThread(new Runnable() {
                  public void run() {
                      Toast.makeText(UpdateLog.this, "IOE response " + e.toString(), Toast.LENGTH_LONG).show();
                  }
                });
        // TODO Auto-generated catch block
        }
        catch (Exception e) {
            Log.e(e.getClass().getName(), e.getMessage());
        }
        String temp = null;

        try {

            if(entity == null){
                publishProgress(0,"Send Fail");
                SystemClock.sleep(500);
                return false;
            }
            else{
            temp = EntityUtils.toString(entity);
            }
        } catch (ParseException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        if (temp.compareTo("SUCCESS") == 0) {
            publishProgress(0,"Send Ok");
            SystemClock.sleep(500);
            return true;
        }
        else{
            publishProgress(0,"Send Fail");
            return false;               
        }   

    } 
```

这是我的日志猫

```
03-28 00:38:43.421: ERROR/AndroidRuntime(3028): FATAL EXCEPTION: AsyncTask #2
03-28 00:38:43.421: ERROR/AndroidRuntime(3028): java.lang.RuntimeException: An error occured while executing doInBackground()
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.FutureTask.run(FutureTask.java:138)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.lang.Thread.run(Thread.java:1019)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028): Caused by: java.lang.NullPointerException
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at hariff.ltis.petaktetap.UpdateLog$MyAsyncTaskPetak.SendDataFoto(UpdateLog.java:961)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at hariff.ltis.petaktetap.UpdateLog$MyAsyncTaskPetak.doInBackground(UpdateLog.java:814)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at hariff.ltis.petaktetap.UpdateLog$MyAsyncTaskPetak.doInBackground(UpdateLog.java:1)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
03-28 00:38:43.421: ERROR/AndroidRuntime(3028):     ... 4 more 
```

错误在行`if (temp.compareTo("SUCCESS") == 0) {`

如何解决这个问题？，我希望吐司和错误消息在发送数据时一起显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:26:41.343

在这里：

```
if(entity == null){
    publishProgress(0,"Send Fail");
    SystemClock.sleep(500);
    return false;
} 
```

似乎抛出了一个异常，阻止了代码运行`return false`。异常被捕获，但`temp`仍未初始化。因此，您会在几行下方看到 NullPointerException。

您应该从初始错误中看到橙色堆栈跟踪，解决那里的错误，此 NullPointerException 将不再是问题。（您可能还想添加`return false;`到您的捕获块。

最后我假设`SystemClock.sleep(500);`是问题，阻塞任何线程是不必要的，你应该使用处理程序和 Runnable 在延迟后运行代码。

# java - 透明背景 png - Java - BufferedImage

> ID：15666428
> 
> 赞同：0
> 
> 时间：2013-03-27T18:18:19.333
> 
> 标签：java, bufferedimage

我正在尝试从具有透明而不是白色背景的 Java 显示中的图像创建一个 png。尝试在 new Color(0,0,0,0) 中将 alpha 设置为 0 - 背景仍然显示为白色？

我正在使用 BufferedImage

```
            WritableRaster 光栅 = onscreenImage.getRaster();
            WritableRaster newRaster;
            newRaster = raster.createWritableChild(0, 0, width, height, 0, 0, new int[] {0, 1, 2});
            DirectColorModel cm = (DirectColorModel) onscreenImage.getColorModel();
            DirectColorModel newCM = new DirectColorModel(cm.getPixelSize(),
                                                          cm.getRedMask(),
                                                          cm.getGreenMask(),
                                                          cm.getBlueMask());
            BufferedImage rgbBuffer = new BufferedImage(newCM, newRaster, false, null);
            尝试 { ImageIO.write(rgbBuffer, 后缀, 文件); }
            catch (IOException e) { e.printStackTrace(); }

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:44:46.913

您没有在颜色模型中指定 alpha 分量。以这种方式尝试：

```
newRaster = raster.createWritableChild(0, 0, width, height, 0, 0, null);
DirectColorModel cm = (DirectColorModel) onscreenImage.getColorModel();
DirectColorModel newCM = new DirectColorModel(cm.getPixelSize(),
                                                      cm.getRedMask(),
                                                      cm.getGreenMask(),
                                                      cm.getBlueMask(),
                                                      cm.getAlphaMask()); 
```

# javascript - 为什么我不能在 Javascript 中创建引用内部函数的对象？

> ID：15666431
> 
> 赞同：0
> 
> 时间：2013-03-27T18:18:36.193
> 
> 标签：javascript

我正在尝试在 Javascript 中做一些面向多态对象的事情，其中​​我有一个对象“类型”的映射，每个对象都有自己可以调用的属性和函数。

虽然属性工作正常，但功能却没有，我不明白为什么。在 Firefox 中，我收到错误：TypeError: this.functionmap[type].action is not a function

这是我的代码：

```
var object = {
    flapWings : function(count) { alert("I am flapping my wings "+count+" times"); },
    kick : function(count) { alert("I am kicking my legs "+count+" times"); },
    functionmap : {
        "bird" : { label : "Bird", action : this.flapWings },
        "horse" : { label : "Horse", action : this.kick }
    },
    doAction : function (type, count) {
         alert("I am a "+this.functionmap[type].label);
         this.functionmap[type].action(count);
    }
};

object.doAction("horse", 5); 
```

这是 JSFiddle 示例：

[http://jsfiddle.net/JKvyP/](http://jsfiddle.net/JKvyP/)

我只是不明白为什么： action : this.kick 没有得到对在它上面创建的 kick 函数的引用！

我想避免一些愚蠢的事情，比如 action : function(count) : this.kick(count); 即使那也不起作用-我想要直接引用而不必重新输入参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:28:11.893

您不能神奇地将参数传递给刚刚引用的函数，因此您需要一些匿名函数，并直接在该范围内引用对象等：

```
var object = {
    flapWings : function(count) { 
        alert("I am flapping my wings "+count+" times"); 
    },
    kick : function(count) {
        alert("I am kicking my legs "+count+" times"); 
    },
    functionmap : {
         "bird" : { 
                   label : "Bird", 
                   action : function(param) {
                                object.flapWings(param);
                           }
                  },
        "horse" : { 
                   label : "Horse", 
                   action : function(param) {
                               object.kick(param);
                            }
                   }
    },
    doAction : function (type, count) {
         alert("I am a "+this.functionmap[type].label);
         this.functionmap[type].action(count);
    }
};

object.doAction("horse", 5); 
```

[**小提琴**](http://jsfiddle.net/JKvyP/2/)

# ios - 带有 SwipeGestureRecognizer 的 UIWebview

> ID：15666432
> 
> 赞同：0
> 
> 时间：2013-03-27T18:18:38.027
> 
> 标签：ios, objective-c, uiwebview, uiswipegesturerecognizer

我有一个`UIWebview`，当用户点击一个时`UIButton`，我的 webview 将被加载。我有 10 个 HTML 文件，`bundle`我想在 webview 中显示第一个 html，当用户`**swipes**`想显示下一个 HTML 文件时。当用户想要查看以前的 HTML 文件时，我想允许滑动查看。我用过`UISwipeGesture`，但我怎样才能一一加载文件..请帮助我。我已经从包中加载了文件并且我使用了

```
NSURLREQUEST *req = [NSURLREQUEST  requestwithURL : myURL];
[webView loadRequest:req]; 
```

myURL 是第一个 HTML 的路径。我如何使用**SWIPE对 10 个 HTML 文件执行此操作**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:10:25.083

您可以做的一件简单的事情是重命名您的 HTML 文件，如 1.html、2.html ..... 10.html 在您的 .h 文件中声明一个整数变量，在 viewDidLoad 中对其进行初始化，并检测该变量中的向右滑动增量，然后使用 formatString 生成正确的 url 并重新加载 webview，并在检测到该变量中的向左滑动减量时生成正确的 url 并重新加载 webview。

```
-(void)swipeRightDetected
{
    if(fileNumber <= 10)
    {
        fileNumber++;
        NSString *urlString = [NSString stringWithFormat:@"http://172.161.331.25/casa/admmathematic/Page00%d.html",fileNumber];
        NSURL *url = [NSURL URLWithString:urlString];
        NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];
        [webview loadRequest:request];
    }
    else
   {
        //No more files
   }
}

-(void)swipeLeftDetected
{
    if(fileNumber > 0)
    {
        fileNumber--;
        NSString *urlString = [NSString stringWithFormat:@"http://172.161.331.25/casa/admmathematic/Page00%d.html",fileNumber];
        NSURL *url = [NSURL URLWithString:urlString];
        NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];
        [webview loadRequest:request];
    }
    else
    {
        //No more files
    }
} 
```

# excel - 基于一列答案添加列的VBA计算

> ID：15666436
> 
> 赞同：2
> 
> 时间：2013-03-27T18:18:45.737
> 
> 标签：excel, vba

到目前为止，我有以下代码从另一列中减去一列，但随后需要获取该结果，如果`D`为**负**，则为`F = D + F`其他`E = E + D`

```
 Sub PopCol()
      Range("D3:D19").Formula = "=RC[-1]-RC[-2]"  'D=C-B 
```

我迷路了！一直在尝试不同的范围格式，但没有运气-帮助！

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:42:25.473

这是你正在尝试的吗？

```
Sub PopCol()
    Dim rng As Range, aCell As Range

    Set rng = Range("D3:D19")

    rng.Formula = "=RC[-1]-RC[-2]"

    For Each aCell In rng
        Select Case aCell.Value

        Case Is < 0 '<~~ If value in D is negative
            '~~>  F = F + D
            aCell.Offset(, 2).Value = aCell.Offset(, 2).Value + aCell.Value
        Case Else
            '~~>  E = E + D
            aCell.Offset(, 1).Value = aCell.Offset(, 1).Value + aCell.Value
        End Select
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:55:31.960

试试下面的代码：

```
 Sub PopCol()
    For i = 3 To 19
        Range("D" & i) = CLng(Range("C" & i) - Range("B" & i))
        If (Range("D" & i) < 0) Then
            Range("F" & i) = Range("D" & i) + Range("F" & i)
        Else
            Range("E" & i) = Range("E" & i) + Range("D" & i)
        End If
    Next
End Sub 
```

# css - CSS 在 IE7 中加载，但显示为无 CSS

> ID：15666439
> 
> 赞同：0
> 
> 时间：2013-03-27T18:18:51.690
> 
> 标签：css, internet-explorer-7

在 IE7 中加载时，我的网站[http://achensee.info/出现问题。](http://achensee.info/)

起初，一切都很完美，您可以看到标题和一些 HTML 元素的正确样式。然而，在主样式表之后和一段时间之后，IE7 会从网站中剥离所有样式并在没有 CSS 的情况下显示它。

因此，文件已加载，但已应用。这是一个常见的问题，还是有办法解决这个问题？

会不会是样式太多导致 IE7 崩溃 CSS 视图？

感谢您的帮助和来自奥地利的问候:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:42:17.703

问题是您对 ie8.js 文件的调用。它使用对您的 CSS 文件的 AJAX 调用来重新应用所有样式，但它可能已损坏（因为它从未超过 beta 阶段，最后一次触及是在 2010 年 4 月）。

# c++ - 哪些 std::async 实现使用线程池？

> ID：15666443
> 
> 赞同：45
> 
> 时间：2013-03-27T18:19:05.943
> 
> 标签：c++, multithreading, c++11, stdasync

`std::async`使用而不是手动创建对象的优点之一`std::thread`应该是`std::async`可以在幕后使用线程池来避免超额订阅问题。但是哪些实现可以做到这一点？我的理解是微软的实现可以，但是这些其他的`async`实现呢？

*   Gnu 的 libstdc++
*   LLVM 的 libc++
*   Just Software的图书馆
*   提升（对于`boost::thread::async`，不是`std::async`）

感谢您提供的任何信息。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-02T22:53:10.090

# 黑盒测试

虽然“白盒”检查可以通过检查 boost、libstdc++ 或 libc++ 源，或检查文档如[just::thread](http://www.stdthread.co.uk/doc/headers/future/async.html)或[MSVC Concurrency Runtime](http://msdn.microsoft.com/en-us/library/dd984036.aspx)来完成，但我不能否认自己编写 C++11 代码的乐趣！

我做了[黑盒测试](http://en.wikipedia.org/wiki/Black-box_testing)：

[**现场演示**](http://coliru.stacked-crooked.com/a/710f914687e3639d)

```
#define BOOST_THREAD_PROVIDES_FUTURE
#define BOOST_RESULT_OF_USE_DECLTYPE
#include <boost/exception/exception.hpp>
#include <boost/range/algorithm.hpp>
#include <boost/move/iterator.hpp>
#include <boost/phoenix.hpp>
#include <boost/thread.hpp>
#include <boost/config.hpp>

#include <unordered_set>
#include <functional>
#include <algorithm>
#include <iterator>
#include <iostream>
#include <ostream>
#include <cstddef>
#include <string>
#include <vector>
#include <future>
#include <thread>
#include <chrono>
#include <mutex>

// _____________________[CONFIGURATION]________________________ //
namespace async_lib = std;
const bool work_is_sleep = false;
// ____________________________________________________________ //

using namespace std;
using boost::phoenix::arg_names::arg1;
using boost::thread_specific_ptr;
using boost::back_move_inserter;
using boost::type_name;
using boost::count_if;
using boost::copy;

template<typename Mutex>
unique_lock<Mutex> locker(Mutex &m)
{
    return unique_lock<Mutex>(m);
}

void do_work()
{
    if(work_is_sleep)
    {
        this_thread::sleep_for( chrono::milliseconds(20) );
    }
    else
    {
        volatile double result=0.0;
        for(size_t i=0; i!=1<<22; ++i)
            result+=0.1;
    }
}

int main()
{
    typedef thread::id TID;
    typedef async_lib::future<TID> FTID;

    unordered_set<TID> tids, live_tids;
    vector<FTID> ftids;
    vector<int> live_tids_count;
    async_lib::mutex m;
    generate_n
    (
        back_move_inserter(ftids), 64*thread::hardware_concurrency(),
        [&]()
        {
            return async_lib::async([&]() -> TID
            {
                static thread_specific_ptr<bool> fresh;
                if(fresh.get() == nullptr)
                    fresh.reset(new bool(true));
                TID tid = this_thread::get_id();
                locker(m),
                    live_tids.insert(tid),
                    live_tids_count.push_back(int(live_tids.size()) * (*fresh ? -1 : 1));
                do_work();
                locker(m),
                    live_tids.erase(tid);
                *fresh = false;
                return tid;
            });
        }
    );
    transform
    (
        begin(ftids), end(ftids),
        inserter(tids, tids.end()),
        [](FTID &x){return x.get();}
    );

    cout << "Compiler = " << BOOST_COMPILER                             << endl;
    cout << "Standard library = " << BOOST_STDLIB                       << endl;
    cout << "Boost = " << BOOST_LIB_VERSION                             << endl;
    cout << "future type = " << type_name<FTID>()                       << endl;
    cout << "Only sleep in do_work = " << boolalpha << work_is_sleep    << endl;
    cout << string(32,'_')                                              << endl;
    cout << "hardware_concurrency = " << thread::hardware_concurrency() << endl;
    cout << "async count = " << ftids.size()                            << endl;
    cout << "unique thread id's = " << tids.size()                      << endl;
    cout << "live threads count (negative means fresh thread):"                ;
    copy(live_tids_count, ostream_iterator<int>(cout," "));        cout << endl;
    cout << "fresh count = " << count_if(live_tids_count, arg1 < 0)     << endl;
} 
```

* * *

```
Compiler = Microsoft Visual C++ version 11.0
Standard library = Dinkumware standard library version 540
Boost = 1_53
future type = class std::future<class std::thread::id>
Only sleep in do_work = false
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 4
live threads count (negative means fresh thread):-1 -2 2 2 -3 -4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 3 4 4 4 4 4 4 4 4 4
 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
fresh count = 4 
```

* * *

```
Compiler = Microsoft Visual C++ version 11.0
Standard library = Dinkumware standard library version 540
Boost = 1_53
future type = class std::future<class std::thread::id>
Only sleep in do_work = true
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 34
live threads count (negative means fresh thread):-1 -2 -3 -4 -5 -6 -7 -8 -9 -10 -11 -12 -13 -14 -15 -16 -17 -18 18 18 18 18 18 18 18 18 18 18 18 18 18
 18 18 18 18 -19 19 -20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 -21 21 21 -22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 -
23 23 23 23 -24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 -25 25 25 25 25 -26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26
26 26 26 -27 27 27 27 27 27 -28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 -29 29 29 29 29 29 29 -30 30 30 30 30 30 30 30 30 30
 30 30 30 30 30 30 30 30 30 30 30 30 30 30 -31 31 31 31 31 31 31 31 -32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 -33 33
 33 33 33 33 33 33 33 -34 34 34 34 34 34 34 34 34 11 12 11 12 13 14 15 16 15 10 11 12 13 14
fresh count = 34 
```

* * *

```
Compiler = Microsoft Visual C++ version 11.0
Standard library = Dinkumware standard library version 540
Boost = 1_53
future type = class boost::future<class std::thread::id>
Only sleep in do_work = false
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 256
live threads count (negative means fresh thread):-1 -2 -2 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -3 -4 -4 -4 -4 -4 -4 -4
 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -2 -3 -3 -3 -3 -4 -4 -4 -4 -2 -2 -2 -2 -3
 -2 -2 -3 -1 -2 -2 -3 -3 -1 -2 -1 -2 -3 -2 -2 -2 -2 -1 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -3 -3 -2 -2 -2 -2 -3 -3 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2
 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -3 -1 -2 -1 -2 -1 -2 -1 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -3 -3 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2
 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -3 -3 -2 -2 -3 -1 -2 -1 -2 -2 -2 -3 -2 -3 -1 -2 -2 -2 -3 -2 -3 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2
 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -3 -3 -3 -2 -2 -2 -3
fresh count = 256 
```

* * *

```
Compiler = Microsoft Visual C++ version 11.0
Standard library = Dinkumware standard library version 540
Boost = 1_53
future type = class boost::future<class std::thread::id>
Only sleep in do_work = true
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 256
live threads count (negative means fresh thread):-1 -2 -3 -4 -5 -6 -7 -8 -9 -10 -11 -12 -13 -14 -15 -16 -17 -18 -19 -20 -21 -22 -23 -24 -25 -26 -27 -2
8 -29 -30 -31 -32 -33 -34 -35 -36 -37 -38 -39 -40 -41 -42 -43 -44 -45 -46 -47 -48 -49 -50 -51 -52 -53 -54 -55 -56 -57 -58 -59 -60 -61 -62 -63 -64 -65
-66 -67 -68 -69 -70 -71 -72 -73 -74 -75 -76 -77 -78 -79 -80 -81 -82 -83 -84 -85 -86 -87 -88 -89 -90 -91 -92 -93 -94 -95 -96 -97 -98 -99 -100 -101 -102
 -103 -104 -105 -106 -107 -108 -109 -110 -111 -112 -113 -114 -115 -116 -117 -118 -119 -120 -121 -122 -123 -124 -125 -126 -127 -128 -129 -130 -131 -132
 -133 -134 -135 -136 -137 -138 -139 -140 -141 -142 -143 -144 -145 -146 -147 -148 -149 -150 -151 -152 -153 -154 -155 -156 -157 -158 -159 -160 -161 -162
 -163 -164 -165 -166 -167 -168 -169 -170 -171 -172 -173 -174 -175 -176 -177 -178 -179 -180 -181 -182 -183 -184 -185 -186 -187 -188 -189 -190 -191 -192
 -193 -194 -195 -196 -197 -198 -199 -200 -201 -202 -203 -204 -205 -206 -207 -208 -209 -210 -211 -212 -213 -214 -215 -216 -217 -218 -219 -220 -221 -222
 -223 -224 -225 -226 -227 -228 -229 -230 -231 -232 -233 -234 -235 -236 -237 -238 -239 -240 -241 -242 -243 -244 -245 -246 -247 -248 -249 -250 -251 -252
 -253 -254 -255 -256
fresh count = 256 
```

* * *

```
Compiler = GNU C++ version 4.8.0-alpha20121216 20121216 (experimental)
Standard library = GNU libstdc++ version 20121216
Boost = 1_53
future type = std::future<std::thread::id>
Only sleep in do_work = false
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 1
live threads count (negative means fresh thread):-1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
fresh count = 1 
```

* * *

```
Compiler = GNU C++ version 4.8.0-alpha20121216 20121216 (experimental)
Standard library = GNU libstdc++ version 20121216
Boost = 1_53
future type = boost::future<std::thread::id>
Only sleep in do_work = false
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 122
live threads count (negative means fresh thread):-1 -2 -3 -4 -5 -6 -7 -8 -9 -10 -11 -12 -13 -14 -15 -16 -17 -18 -19 -20 -21 -20 -21 -22 -23 -24 -25 -25 -26 -27 -28 -29 -29 -30 -31 -32 -33 -34 -35 -36 -37 -38 -39 -40 -41 -42 -43 -44 -45 -46 -47 -48 -49 -50 -51 -52 -53 -54 -55 -56 -57 -58 -59 -59 -60 -61 -62 -63 -64 -64 -64 -63 -61 -55 -48 -41 -33 -34 -27 -27 -28 -29 -29 -30 -31 -31 -30 -28 -29 -28 -28 -28 -29 -30 -30 -31 -30 -31 -31 -31 -32 -31 -26 -24 -25 -26 -25 -23 -23 -22 -20 -21 -19 -20 -20 -19 -20 -21 -21 -22 -21 -22 -23 -24 -24 -25 -26 -27 -25 -25 -25 -22 -23 -22 -23 -23 -24 -25 -26 -27 -27 -28 -29 -29 -30 -31 -32 -33 -34 -35 -36 -37 -38 -39 -40 -41 -42 -43 -44 -45 -46 -47 -48 -49 -50 -51 -51 -52 -53 -54 -55 -56 -57 -56 -54 -3 -3 -4 -4 -5 -6 -7 -8 -9 -10 -11 -12 -13 -14 -15 -16 -17 -18 -19 -20 -21 -22 -23 -24 -25 -26 -27 -28 -29 -30 -31 -32 -33 -34 -35 -36 -37 -38 -39 -40 -41 -42 -43 -44 -45 -46 -47 -48 -49 -50 -51 -52 -53 -54 -55 -55 -56 -57 -58 -59 -60 -61 -61 -61 -62 -63 -64 -65 -64 -62 -63 -63 -61 -62 -61 -59 -60 -59 -57 -55 -56
fresh count = 256 
```

* * *

```
Compiler = Clang version 3.2 (tags/RELEASE_32/final)
Standard library = libc++ version 1101
Boost = 1_53
future type = NSt3__16futureINS_11__thread_idEEE
Only sleep in do_work = false
________________________________
hardware_concurrency = 4
async count = 256
unique thread id's = 255
live threads count (negative means fresh thread):-1 -2 -3 -4 -5 -6 -7 -8 -9 -10 -11 -12 -12 -13 -14 -15 -16 -17 -18 -19 -20 -21 -22 -23 -24 -25 -26 -27 -27 -28 -29 -30 -31 -32 -33 -34 -35 -36 -37 -38 -39 -40 -41 -42 -43 -44 -45 -46 -47 -48 -49 -50 -51 -52 -53 -54 -55 -56 -57 -58 -59 -60 -61 -62 -63 -64 -65 -66 -67 -68 -69 -69 -70 -71 -72 -73 -74 -75 -76 -77 -78 -79 -80 -81 -82 -83 -84 -85 -86 -87 -88 -89 -90 -91 -92 -93 -94 -95 -96 -97 -98 -99 -100 -101 -102 -102 -103 -104 -105 -106 -107 -108 -109 -110 -111 -112 -113 -114 -115 -116 -117 -118 -119 -120 -121 -121 -122 -122 -123 -123 -124 -125 -126 -127 -126 -127 -128 -129 -129 -128 -129 -128 -129 -129 -128 -129 -129 -128 -126 -127 -128 -128 -129 -129 -130 -129 -129 -128 -129 -129 -130 -131 -132 -133 -134 -135 -136 -134 -132 -133 -134 -134 -133 -132 -133 -132 -133 -134 -133 -131 -129 -127 -124 -125 -121 -119 -120 -118 -119 -118 -117 -115 -111 -107 -105 -106 -103 -100 -97 -95 -96 -94 -90 -87 -81 -73 -74 -71 -72 -73 -74 -75 -70 -71 -66 -60 -59 -60 -61 -62 -63 -64 -61 -58 -55 -55 -52 -53 -54 -54 -55 -56 -56 -57 -54 -55 -56 -56 -57 -57 -58 -56 -54 -55 -56 -56 -57 -58 -58 -59 -58 -58 -58 -58 -59 -60
fresh count = 256 
```

* * *

可以看出——MSVC 确实重用了线程，也就是说，它的方案很可能是某种线程池。

# groovy - 常规缺失属性执行

> ID：15666444
> 
> 赞同：0
> 
> 时间：2013-03-27T18:19:13.237
> 
> 标签：groovy

我是 groovy 的新手。我试图弄清楚基本语法。以下代码片段：

```
def CRITICAL = 2;
def MAJOR = 3;
def MINOR = 9;
def GetPriorityFromString(String priorityStr) {
    switch (priorityStr){
        case "Critical" : return CRITICAL;
        case "Major" : return MAJOR;
        case "Minor" : return MINOR;
    }
    return 0;
}
GetPriorityFromString("Minor") 
```

导致此错误：

```
groovy.lang.MissingPropertyException: No such property: MINOR for class: Script21 
```

我做错了什么？

（而且由于我是这种语言的新手，请随意提出任何“groovier”方法来将字符串转换为枚举值。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:23:59.927

只需使用地图

```
def mapping =["CRITICAL": 2, "MAJOR" : 3, "MINOR": 9]
println mapping["MINOR"] 
```

至于您的原始代码：您的变量范围有问题。如果您在脚本上下文中，您可能不会使用“def”来声明全局变量，只需将其省略即可。

```
CRITICAL = 2;
MAJOR = 3;
MINOR = 9;
def GetPriorityFromString(String priorityStr) {
    switch (priorityStr){
        case "Critical" : return CRITICAL;
        case "Major" : return MAJOR;
        case "Minor" : return MINOR;
    }
    return 0;
}
GetPriorityFromString("Minor") 
```

如果你把它放到一个普通的类中，那么你必须使用 defs

```
class Test {
def CRITICAL = 2;
def MAJOR = 3;
def MINOR = 9;
def GetPriorityFromString(String priorityStr) {
    switch (priorityStr){
        case "Critical" : return CRITICAL;
        case "Major" : return MAJOR;
        case "Minor" : return MINOR;
    }
    return 0;
}
}
new Test().GetPriorityFromString("Minor") 
```

# javascript - 从 Web 服务获取 json 字符串

> ID：15666448
> 
> 赞同：1
> 
> 时间：2013-03-27T18:19:23.897
> 
> 标签：javascript, jquery, json, web-services

我有一个 Web 服务，它从外部系统获取用户列表并以 json 格式返回。我通过 jquery ajax 调用该网络服务。我在下面放置了ajax代码

```
 $.ajax({
        type: "GET",
        url: webMethod,
        data:"",
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        success: function(msg) {
            alert(msg.d);
        },
       error: function(e) {
         alert(e);
        }
    }); 
```

即使输出格式正确，我从 jquery.ajax 得到的输出似乎是错误的。它正确返回大块数据，然后添加“; (”并继续显示输出。

基本上，输出是（“大约 %75 的数据”）；（其余数据）这使我的 json 无效。我不确定它是否与 maxJasonLenght 有关，但我也将其设置为最大值。您可以从 Web 服务获得多少数据似乎是有限制的，就像我向该 json 添加更多数据一样，故障点会发生变化。

**样本输出**

* * *

[{"UserName":"ab","FullName":"ab"},{许多其他用户},{"UserName":"cd","FullName":"c d"},{"UserName":"ef ",);jsonp1364397526212("FullName":"e f"}, {"UserName":"gh","FullName":"g f"},{其他用户}}

你知道我为什么会遇到这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:15:08.647

您是否将 crossDomain 选项设置为 TRUE？如果我没记错的话，如果您将 crossDomain 选项设置为 TRUE，则响应将是 JSON-P。

查看这篇文章，以便您了解如何处理响应： [JSONP 到底是什么？](https://stackoverflow.com/questions/2067472/what-is-jsonp-all-about)

我希望它会有所帮助！

# ruby-on-rails - 电子邮件已发送但未到达邮箱，使用设计方法“可确认”通过电子邮件确认用户

> ID：15666453
> 
> 赞同：0
> 
> 时间：2013-03-27T18:19:28.767
> 
> 标签：ruby-on-rails, ruby, authentication, devise

我正在实施设计“可确认”方法，通过在 Rails App 上发送电子邮件来确认用户。我的应用程序“development.log”文件显示电子邮件已发送但未到达目的地。以下是我包含代码的文件：-

用户.rb

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :confirmable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me
  attr_accessible :title, :body
  def password_match?
    self.errors[:password] << 'must be provided' if password.blank?
    self.errors[:password] << 'and confirmation do not match' if password != password_confirmation
    password == password_confirmation and !password.blank?
  end
end 
```

确认控制器.rb

```
class ConfirmationsController < Devise::ConfirmationsController
  def show
    @user = User.find_by_confirmation_token(params[:confirmation_token])
  end
ef confirm_user
    @user = User.find_by_confirmation_token(params[:user][:confirmation_token])
    if @user.update_attributes(params[:user]) and @user.password_match?
      @user = User.confirm_by_token(@user.confirmation_token)
      set_flash_message :notice, :confirmed
      sign_in_and_redirect("user", @user)
    else
      render :show
    end
  end 
```

注册页面

```
<h2>Sign up</h2>

<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= devise_error_messages! %>

  <div><%= f.label :email %><br />
  <%= f.email_field :email, :autofocus => true %></div>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

发展.rb

```
Gt::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb

  # In the development environment your application's code is reloaded on
  # every request. This slows down response time but is perfect for development
  # since you don't have to restart the web server when you make code changes.
  config.cache_classes = false

  config.action_mailer.default_url_options = { :host => 'localhost:3000' }
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {:address => "localhost", :port => 1025}

  # Log error messages when you accidentally call methods on nil.
  config.whiny_nils = true

  # Show full error reports and disable caching
  config.consider_all_requests_local       = true
  config.action_controller.perform_caching = false
  ActionMailer::Base.delivery_method = :smtp
  ActionMailer::Base.smtp_settings = {
   :tls => true,
   :address => "smtp.gmail.com",
   :port => 587,
   :domain => "gmail.com",
   :authentication => :login,
   :user_name => "[username]",
   :password => "[password]"
 }

  # Don't care if the mailer can't send
  config.action_mailer.raise_delivery_errors = false

  # Print deprecation notices to the Rails logger
  config.active_support.deprecation = :log

  # Only use best-standards-support built into browsers
  config.action_dispatch.best_standards_support = :builtin

  # Raise exception on mass assignment protection for Active Record models
  config.active_record.mass_assignment_sanitizer = :strict

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  config.active_record.auto_explain_threshold_in_seconds = 0.5

  # Do not compress assets
  config.assets.compress = false

  # Expands the lines which load the assets
  config.assets.debug = true
end 
```

日志输出

```
Sent mail to xy@gmail.com (2027ms)
Date: Wed, 27 Mar 2013 23:29:12 +0530
From: please-change-me-at-config-initializers-devise@example.com
Reply-To: please-change-me-at-config-initializers-devise@example.com
To: xy@gmail.com
Message-ID: <515333707f095_3501ae36c81486e@Vinay-PC.mail>
Subject: Confirmation instructions
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<p>Welcome xy@gmail.com!</p>

<p>You can confirm your account email through the link below:</p> 
```

问题：正如我从开发日志中看到的那样，电子邮件已发送，但它没有到达给定的电子邮件 ID。我在本地主机上。任何帮助都将不胜感激。

问候， 维奈·辛格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:07:45.250

您需要在 config/application.rb 文件中设置默认主机和邮件程序设置。

![Rails 的电子邮件配置](../Images/eafc44bcb0a7552754e288cd0c0ed53c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T08:43:06.353

我也遇到了这个问题，但通过以下技巧解决了这个问题。

解决方案是在 config/initialisers/setup_mail.rb 中创建一个初始化程序，其中包含以下内容

如果 Rails.env != 'test'
email_settings = YAML::load(File.open("#{Rails.root.to_s}/config/email.yml"))
ActionMailer::Base.smtp_settings = email_settings[Rails.env ] 除非 email_settings[Rails.env].nil?
结尾

然后添加 config/email.yml 包含开发和生产电子邮件帐户的详细信息

开发:
:address: smtp.gmail.com
:port: 587
:authentication: plain
:user_name: xxx
:password: yyy

生产:
:address: smtp.gmail.com
:port: 587
:authentication: plain
:user_name: xxx
:password: yyy

# c++ - 通过复制或引用传递指针

> ID：15666454
> 
> 赞同：0
> 
> 时间：2013-03-27T18:19:40.467
> 
> 标签：c++, pointers

我正在编写一个函数来将某个特定类（二维直方图`TH2F*`）的内容复制到另一个`TH2F*`. 实际上，我希望能够做到

```
SafeCopy( in, out ) 
```

`in`我的输入在哪里`TH2F*`，`out`是我的目的地`TH2F*`。特别是，我想以这样一种方式实现，以便在以前没有分配`SafeCopy`的情况下也能工作。`out`在第一个实例中，我以这种（错误）方式实现了该功能

```
void SafeCopy( const TH2F * h_in, TH2F *h_out )
{
    cout << "SafeCopy2d: output histogram address is " << h_out << endl;
    if( h_out != NULL )
    {
        cout << "SafeCopy2d: h_out has been identified as non-zero pointer\n"; 
        (*h_out) = *h_in; // I'm making use of the copy-constructor
                          // it wouldn't work if h_out == NULL 
    }
    else 
    {
        cout << "SafeCopy2d: h_out has been identified as null pointer\n";
        h_out = new TH2F( *h_in );
        cout << "SafeCopy2d: h_out address is now " << h_out << endl;
    }
} 
```

输出是

```
SafeCopy2d: output histogram address is 0x0
SafeCopy2d: h_out has been identified as null pointer
SafeCopy2d: h_out address is now 0xblahblah 
```

但当然这不起作用，因为退出函数时，“真实”指针 h_out 仍然为 0，因为我通过复制而不是通过引用传递它。然后我将函数的原型（不更改其实现）更改为

```
void SafeCopy( const TH2F * h_in, TH2F *&h_out ) 
```

为了通过引用传递 h_out 指针。在后一种情况下，会发生一些奇怪的事情：如果我调用 SafeCopy 并传递一个 NULL h_out 我会得到以下输出：

```
SafeCopy2d: output histogram address is 0x*a non-zero value*
SafeCopy2d: h_out has been identified as non-zero pointer 
```

我的问题是：为什么如果我通过复制传递 h_out，它被正确识别为 NULL 指针，而不是当我通过引用传递它时，它显示为非零？

**编辑** 这是调用代码：

```
//TH2F * h_migration is created and filled previously in the program
TH2F * h_smearedMigration;//  
for (int ntoy=0; ntoy < NTOY; ntoy++ ) {

         //matrix smearing
    SmartCopy( h_migration, h_smearedMigration ); //copy the original matrix to a temporary one
    RunToy( h_smearedMigration ); //smear the matrix
... 
```

我想避免类似的事情

```
h_smearedMigration = SmartCopy( h_migration, h_smearedMigration ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:26:33.260

您没有显示调用代码，但听起来问题来自类似`SafeCopy(something, NULL)`. 是的，行不通。传入指针并返回结果：

```
TH2F *SafeCopy(constTH2F *in, TH2F *out) {
    if (!out)
        out = whatever;
    *out = *in; // or whatever...
    return out;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:37:44.777

> 如果我调用 SafeCopy 传递一个 NULL h_out 我得到这个输出：
> ...
> * 编辑 这是调用代码：
> TH2F * h_smearedMigration;
> ...
> SmartCopy( h_migration, h_smearedMigration );

那不是空指针，那是未初始化的指针。它包含随机垃圾，不太可能是 0x0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:24:39.537

首先，不清楚为什么要使用指针。理想情况下，您只想直接持有对象。那么您不需要特殊的复制约定：

```
TH2F RunToy(TH2F const &in);

//TH2F h_migration is created and filled previously in the program
for (int ntoy=0; ntoy < NTOY; ntoy++ ) {
    TH2F h_smearedMigration = RunToy(h_migration); 
```

如果`TH2F`复制起来很昂贵，那么您可以通过 pImple 之类的东西来实现它，这样移动起来很便宜，但仍然像值类型一样。

如果您确实需要指针，那么您应该使用智能指针并且从不拥有​​原始指针（例如，几乎可以保证拥有原始指针会使您的代码异常不安全）。

```
void RunToy(std::unique_ptr<TH2F> in_out);

void SafeCopy(TH2F const &in, std::unique_ptr<TH2F> &out)
{
    if(h_out) {
        *out = in; // copy assignment
    } else {
        out = make_unique<TH2F>(h_in); // copy construction
    }
}

for (int ntoy=0; ntoy < NTOY; ntoy++ ) {
    std::unique_ptr<TH2F> h_smearedMigration;
    SmartCopy(h_migration, h_smearedMigration);
    RunToy(h_smearedMigration ); 
```

当然，您通常不需要一个`SmartCopy`函数来动态确定是使用复制分配还是复制构造。您应该根据您是否已经分配了对象来知道您需要什么。

```
// std::unique_ptr<TH2F> h_migration is created and filled previously in the program
for (int ntoy=0; ntoy < NTOY; ntoy++ ) {
    auto h_smearedMigration = make_unique<TH2F>(*h_migration);
    RunToy(h_smearedMigration); 
```

# c# - 更新会话值

> ID：15666457
> 
> 赞同：0
> 
> 时间：2013-03-27T18:19:46.257
> 
> 标签：c#, asp.net, session-variables, session-state

我在登录时创建了一个会话，在该会话中我放置了用户对象。

```
public sealed class MyContext
{

    [ThreadStatic]
    private static MyContext staticContext = null;
    public HttpContext Context
    {
        get
        {
            return HttpContext.Current;
        }
    }

    private MyContext()
    {

    }

    public static MyContext Current
    {
        get
        {
            MyContext myContext = null;
            HttpContext context = HttpContext.Current;
            if (context != null)
            {

                //it in the Items collection (a per request store)
                if (context.Items.Contains("CONTEXT_KEY"))
                    myContext = context.Items["CONTEXT_KEY"] as MyContext;
                else
                {
                    myContext = new MyContext();
                    myContext.Context.Items["CONTEXT_KEY"] = myContext;
                }
            }
            else if (staticContext != null)
            {
                myContext = staticContext;
            }
            else
            {
                //create a new instance of static context as there is no web request
                staticContext = new MyContext();
                myContext = staticContext;
            }
            return myContext;
        }
    }

    public MyUser User
    {
        get
        {
            MyUser user = null;
            if (Current.Context.Session["LoggedInUser"] != null)
                user = (MyUser)Current.Context.Session["LoggedInUser"];
            else
            {
                user = UserDetail.GetUser(HttpContext.Current.User.Identity.Name);
                if (user == null)
                {
                    //if there is no userID, create anonymous user
                    user = new MyUser();
                    user.IsAnonymous = true;
                    user.UserID = 0;
                }
                //cache in session
                Current.Context.Session["User"] = user;
            }
            return user;
        }
        set
        {
            Current.Context.Session["User"] = value;
        }
    }

}//end class 
```

现在我在整个应用程序中使用这个上下文，如果用户登录并且同时管理员停用该用户，我无法停止用户活动，这是因为用户的信息在会话中。因此，请建议我在管理员停用该用户时如何更新该特定用户的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:25:45.957

如果我能很好地理解您的问题，您只能创建一个活动！当管理员停用用户时，它可能会生成一个事件，并且您的用户会话会立即响应它。这只是一个想法，我不习惯会话！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:26:56.267

如果我在那种情况下。我将不得不重构一些代码以偶尔检查后端以重新验证用户 - 这样如果登录被停用，它就会被捕获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:31:26.993

您需要检查每个传入的页面请求，以查看用户是否已被停用，如果是，则重置会话变量。例如，您可以编写一个继承 Page 类并覆盖 Page_Load 的基类。基类 Page_Load 可以执行检查。对于所有需要检查的页面（可能是所有页面），它们应该简单地继承 Base 类而不是 Page 类。

# ruby - 与 ARGF#set_encoding 混淆

> ID：15666458
> 
> 赞同：2
> 
> 时间：2013-03-27T18:19:51.817
> 
> 标签：ruby, encoding, character-encoding

[`ARGF.set_encoding`](http://www.rubydoc.info/stdlib/core/ARGF#set_encoding-instance_method)说：

> 如果指定了单个参数，则从 ARGF 读取的字符串将使用指定的编码进行标记。
> 
> 如果给出了用冒号分隔的两个编码名称，例如“ascii:utf-8”，则读取的字符串从第一个编码（外部编码）转换为第二个编码（内部编码），然后用第二个编码标记。

所以我尝试了以下方法：

```
p RUBY_VERSION
p ARGF.external_encoding
ARGF.set_encoding('ascii')
p ARGF.readlines($/) 
```

*输出：*

```
D:\Rubyscript\My ruby learning days>ruby true.rb a.txt
"2.0.0"
#<Encoding:IBM437>
["Hi! How are you?\n", "I am doing good,thanks."]

p RUBY_VERSION
p ARGF.external_encoding
ARGF.set_encoding(ARGF.external_encoding,'ascii')
p ARGF.readlines($/) 
```

*输出：*

```
D:\Rubyscript\My ruby learning days>ruby true.rb a.txt
"2.0.0"
#<Encoding:IBM437>
["Hi! How are you?\n", "I am doing good,thanks."] 
```

未发现编码更改。所以请告诉我正确的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T19:19:01.250

编码`IBM437`和`ASCII`（和`UTF-8`）对于 ASCII 字符具有相同的字节序列。所以你不会看到与 的区别`String#inspect`。但是，您可以检查`String#encoding`输入字符串的值。

```
p RUBY_VERSION
p ARGF.external_encoding
ARGF.set_encoding(ARGF.external_encoding,'ascii')
p ARGF.readlines($/).map{|s| s.encoding} 
```

在 Ruby（**1.9 及更高版本**）中，String 是带有某种编码标记的字节序列。您可以从中获取编码`String#encoding`。

所以中文单词“中”可以用不同的方式表示：

```
e4 b8 ad          # tagged with encoding UTF-8
d6 d0             # tagged with encoding GBK
2d 4e             # tagged with encoding UTF-16le 
```

我将始终使用 UTF-8 编写我的脚本，也就是说，我的脚本的内部编码是 UTF-8。有时我想处理用 GBK 编码的文本文件（例如，名为“a.txt”并且内容为“中”）。然后我可以为 IO 对象设置外部编码和内部编码，Ruby 将为我进行转换。

```
ARGF.set_encoding('GBK', 'UTF-8')
str = ARGF.readline
puts str.encoding

# run             $ script.rb a.txt 
```

Ruby`"\xd6\xd0"`从“a.txt”中读取数据，并且由于我已将外部编码指定为 GBK，因此它使用编码 GBK 标记数据。而且我已将内部编码指定为 UTF-8，因此 Ruby 将 GBK 字节序列转换为 UTF-8，从而产生`"\xe4\xb8\xad"`标记 UTF-8。而且这个字符串与我脚本中的其他字符串具有相同的编码，所以我可以轻松使用它。

这很有用，因为当两个 String 操作数具有不同的、不兼容的编码时，许多 String 方法都会失败。例如：

```
# encoding: utf-8
a = "中"                  # tagged with UTF-8
b = "中".encode('gbk')    # tagged with GBK
puts a + b
#=> Encoding::CompatibilityError: incompatible character encodings: UTF-8 and GBK 
```

# xml - ePUB 3.0 文件结构

> ID：15666459
> 
> 赞同：0
> 
> 时间：2013-03-27T18:19:54.173
> 
> 标签：xml, xhtml, epub, epub3

如果 ePUB 2.0 是这样的：

```
folder/
    META-INF/
        container.xml
    mimetype
    OEBPS/
        content.opf
        toc.ncx
        [etc] 
```

那么ePUB 3.0上面显示的有什么区别，还是结构和2.0一样？IDPF 已经很好地证明了 3.0，但他们没有明确说明这个明显的问题。IBM 为 2.0 提供了出色的“ePUB from Scratch”，但当前的 3.0 教程没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:34:03.517

结构是相同的，但请注意，对于 epub 3.0，您还需要一个 toc.xhtml 进行导航。您也可以包含 toc.ncx，以实现向后兼容性。更多信息可[在此处](http://www.idpf.org/epub/30/spec/epub30-publications.html#ncx-superseded)获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-30T22:54:02.477

EPUB 容器内的目录/文件层次结构是任意的，除了：

*   `mimetype`（必须在容器的根目录中）
*   `META-INF/container.xml`（必须完全在这条路径上）

所有其他文件可能位于 EPUB 容器内的任何位置（但不在`META-INF`目录内）。

简而言之：您要求的指示在 EPUB 规范中不存在，因为 EPUB 容器内的结构取决于 EPUB 生产者。您在问题中写的只是一个示例，但这不是强制性的。

# c++ - 为什么使用 ifstream 从管道中读取“dd”的速度比我自己的程序快？

> ID：15666460
> 
> 赞同：8
> 
> 时间：2013-03-27T18:20:02.323
> 
> 标签：c++, linux, pipe, ifstream

我有两个程序通过 linux 管道（命名或其他方式）相互传递数据。我需要在两个程序之间达到 ~2600 MB/s 的传输速率，但目前看到的传输速率较慢，约为 ~2200 MB/s。但是，我发现如果我用 'dd' 替换我的第二个进程，传输速率会跃升至超过 3000 MB/s。我的程序从管道读取的方式是否比“dd”的方式效率低？我可以做些什么来提高这个吞吐量？'ifstream' 本质上是否比从管道读取二进制数据的其他方法慢？

总结一下这两种情况：

> **场景一：**
> 
> 程序 1 -> [命名管道] -> 程序 2
> 
> *产生约 2200 MB/s 的传输速率*
> 
> **场景2：**
> 
> 程序 1 -> [命名管道] -> 'dd if=pipename of=/dev/null bs=8M'
> 
> *产生约 3000 MB/s 的传输* 速率。

这是我的程序 2 当前从管道读取的方式：

```
ifstream inputFile;
inputFile.open(inputFileName.c_str(), ios::in | ios::binary);
while (keepLooping)
{
    inputFile.read(&buffer[0], 8*1024*1024);
    bytesRead = inputFile.gcount();
    //Do something with data
} 
```

**更新：**

我现在尝试使用 'read(fd, &buffer[0], 8*1024*1024)' 而不是 istream，似乎有*轻微*的改善（但不如 dd）

我还尝试使用 stream->rdbuf()->sgetn(&buffer[0], 8*1024*1024) 而不是 stream->read()，但没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:09:02.213

差异似乎是由于使用数组而不是 std::vector，我仍然很难相信。我的两组代码如下所示以进行比较。第一个可以从 Program 1 以大约 2500 MB/s 的速率摄取。第二个可以以 3100 MB/s 的速率摄取。

**程序 1 (2500 MB/s)**

```
int main(int argc, char **argv)
{
    int fd = open("/tmp/fifo2", O_RDONLY);

    std::vector<char> buf(8*1024*1024);

    while(1)
    {
       read(fd, &buf[0], 8*1024*1024);
    }
} 
```

**程序 2 (3100 MB/s)**

```
int main(int argc, char **argv)
{

    int fd = open("/tmp/fifo2", O_RDONLY);

    char buf[8*1024*1024];

    while(1)
    {
       read(fd, &buf[0], 8*1024*1024);
    }
} 
```

两者都是使用 gcc 版本 4.4.6 使用 -O3 编译的。如果有人能解释这个原因，我会很感兴趣（因为我理解 std::vector 基本上是一个数组的包装器）。

**编辑**：我刚刚测试了下面的程序 3，它可以使用 ifstream 并以 3000 MB/s 的速度运行。因此，使用 ifstream 而不是 'read()' 似乎会导致非常轻微的性能下降。比使用 std::vector 所获得的命中要少得多。

**程序 3 (3000 MB/s)**

```
int main(int argc, char **argv)
{
    ifstream file("/tmp/fifo2", ios::in | ios::binary);

    char buf[8*1024*1024];

    while(1)
    {
       file.read(&buf[0], 32*1024);
    }
} 
```

**编辑2：**

我修改了程序 2 的代码以使用 malloc 的内存而不是堆栈上的内存，并且性能下降以匹配向量性能。谢谢，ipc，让我明白这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:53:48.033

此代码编译为`g++ -Ofast`：

```
int main(int argc, char *argv[])
{
  if (argc != 2) return -1;
  std::ifstream in(argv[1]);
  std::vector<char> buf(8*1024*1024);
  in.rdbuf()->pubsetbuf(&buf[0], buf.size());
  std::ios_base::sync_with_stdio(false);
  std::cout << in.rdbuf();
} 
```

根本没有表现那么糟糕。

```
$ time <<this program>> <<big input file>> >/dev/null
0.20s user 3.50s system 9% cpu 40.548 total
$ time dd if=<<big input file>> bs=8M > /dev/null
0.01s user 3.84s system 9% cpu 40.786 total 
```

您必须考虑`std::cout`共享一个缓冲区，`stdout`如果不关闭该缓冲区，则非常耗时。因此`std::ios_base::sync_with_stdio(false);`，如果您想要速度并且不打算使用 C 的输入输出方法（反正速度较慢），请致电。

此外，对于 C++ 中的原始和快速输入/输出，请使用 中的方法`streambuf`，获得者`rdbuf()`。

# r - R将等高线保存到数据框中

> ID：15666466
> 
> 赞同：2
> 
> 时间：2013-03-27T18:20:13.870
> 
> 标签：r, ggplot2

ggplot 允许我为数据系列 x 和 y 绘制等高线：

```
library(ggplot2)
df <- data.frame(x=c(1:100),y=rnorm(100))
ggplot(df,aes(x=x,y=y))+geom_density2d() 
```

我希望能够将主要四个等高线 (95,75,50,25)max 和 (95,75,50,25)min 的数据输出保存在数据框中。我会很感激你的帮助。也许有一种方法可以直接执行此操作，而无需使用 ggplot。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:42:06.017

在对象周围使用 function `ggplot_build(`)，`ggplot()`您可以访问用于绘图的所有数据。数据存储在列表元素中`data`。

```
p<-ggplot_build(ggplot(df,aes(x=x,y=y))+geom_density2d())

str(p$data)
List of 1
 $ :'data.frame':   1895 obs. of  6 variables:
  ..$ level: num [1:1895] 5e-04 5e-04 5e-04 5e-04 5e-04 5e-04 5e-04 5e-04 5e-04 5e-04 ...
  ..$ x    : num [1:1895] 1 2 3 4 5 ...
  ..$ y    : num [1:1895] 1.42 1.44 1.45 1.45 1.46 ...
  ..$ piece: int [1:1895] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ group: Factor w/ 13 levels "1-001","1-002",..: 1 1 1 1 1 1 1 1 1 1 ...
  ..$ PANEL: int [1:1895] 1 1 1 1 1 1 1 1 1 1 ... 
```

您可以将这些数据存储为单独的数据框。

```
gg<-p$data[[1]]
head(gg)
  level        x        y piece group PANEL
1 5e-04 1.000000 1.423926     1 1-001     1
2 5e-04 2.000000 1.435286     1 1-001     1
3 5e-04 3.000000 1.445293     1 1-001     1
4 5e-04 4.000000 1.454166     1 1-001     1
5 5e-04 5.000000 1.462106     1 1-001     1
6 5e-04 5.255343 1.463967     1 1-001     1 
```

`group`变量显示每个值属于哪一行（在这种情况下，`piece`1 - 外线，13 - 内线）。

# oracle - Oracle 11g 中正确的更新语句是什么

> ID：15666468
> 
> 赞同：0
> 
> 时间：2013-03-27T18:20:15.397
> 
> 标签：oracle, oracle11g

我原来的更新语句在 Sybase 中仍然运行良好（见下文），但我们正在迁移到 Oracle 11g，我必须将此更新语句转换为 Oracle 更新。我尝试了这么多版本并不断出错，我想我还没有了解 Oracle Update 语句的工作原理。任何人都可以帮忙吗？

我原来好的更新语句（在 Sybase 中）：

```
UPDATE Valid
    SET A.status = 'X',
        A.reason = 'Missing'
  FROM Valid A, Valid B
  WHERE A.id_number = B.id_number
  AND A.session_id = 69
  AND A.userid = 'BS'
  AND A.status = 'A' 
  AND isnull(B.street1, ' ') = ' ' 
```

以下是我的 Oracle 版本，无论我做什么都无法正常工作：

```
MERGE
  INTO um_valid Target
  USING (select * from um_valid) SOURCE
  ON (t1.id_number = t2.id_number)                
  WHEN MATCHED THEN
  UPDATE
   SET status = 'X',
       reason = 'Missing (street 1)'
  WHERE Target.session_id = 69
  AND Target.userid = 'BS'
  AND Target.status = 'A' 
  AND NVL(SOURCE.street1, ' ') = ' ') 
```

我得到的错误： `ORA-00933: SQL command not properly ended`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T23:31:26.627

这应该这样做：

```
UPDATE Valid a
    SET status = 'X',
        reason = 'Missing'
  WHERE A.session_id = 69
  AND A.userid = 'BS'
  AND A.status = 'A' 
  AND exists (select null
              from   valid b
              where  a.id_number = b.id_number
                 AND coalesce(B.street1, ' ') = ' ') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:33:59.077

最后的 WHERE 子句不合适。也许你需要这个：

```
MERGE
   INTO um_valid Target
   USING (
      select distinct id_number 
      from um_valid 
      where street1 is null
   ) SOURCE
   ON (
      Target.id_number = SOURCE.id_number
      AND Target.session_id = 69
      AND Target.userid = 'BS'
      AND Target.status = 'A' 
   )                
   WHEN MATCHED THEN UPDATE SET 
      status = 'X',
      reason = 'Missing (street 1)' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T21:57:43.410

您可以使用正常的更新语句。合并用于批量操作。如果您需要在存在时更新某些内容或在不存在时插入，那么您可以使用合并语句。因此，对于您的示例，请尝试使用以下内容：

```
UPDATE Valid
SET status = 'X',
    reason = 'Missing'
WHERE session_id = 69
AND userid = 'BS'
AND status = 'A' 
AND street1 is null 
```

上面的语句将更新表“Valid”中的所有行，其中 session_id 等于 69，userid 等于 BS，status 等于 A，street1 为空（null）。

我认为这就是您所需要的，如果不是这种情况，请让我知道您为什么加入 valid 和 valid。我会调整我的更新。

# c# - 通过 HttpWebRequest 登录 SSL 页面

> ID：15666470
> 
> 赞同：0
> 
> 时间：2013-03-27T18:20:17.207
> 
> 标签：c#, ssl, httpwebrequest

我正在尝试通过 HttpWebRequest 访问 SSL 页面。看起来该页面使用了 JavaScript。我可以进入登录页面，但是在我登录后（我认为它已登录），我无法进入下一页。这是我的代码：

```
private void fetch(String password)
    {
        try
        {
            ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true);
            CookieContainer cookies = new CookieContainer();
            HttpWebRequest http = (HttpWebRequest)WebRequest.Create("https://facebook.com/");
            http.CookieContainer = cookies;
            http.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 6.0)";

            IWebProxy proxy = http.Proxy;
            if (proxy != null)
            {
                Console.WriteLine("Proxy: {0}", proxy.GetProxy(http.RequestUri));
            }
            else
            {
                Console.WriteLine("Proxy is null; no proxy will be used");
            }

            WebProxy myProxy = new WebProxy();
            Uri newUri = new Uri("myproxy");
            myProxy.Address = newUri;
            myProxy.Credentials = new NetworkCredential("username", password);
            http.Proxy = myProxy;

            HttpWebResponse response = (HttpWebResponse)http.GetResponse();           

            /////////////////////////////////////////////////////////
            HttpStatusCode responseStatus;
            responseStatus = response.StatusCode;

            if (responseStatus == HttpStatusCode.OK)
            {                
                UriBuilder urlBuilder = new UriBuilder("https://facebook.com/");

                ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true);                    
                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(urlBuilder.ToString());
                request.CookieContainer = cookies;
                request.Referer = formUrl.ToString();
                request.Method = "POST";
                request.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 6.0)";
                request.ContentType = "application/x-www-form-urlencoded";
                request.AllowAutoRedirect = false;                    

                using (Stream requestStream = request.GetRequestStream())
                using (StreamWriter requestWriter = new StreamWriter(requestStream, Encoding.ASCII))
                {
                    request.PreAuthenticate = true;
                    ICredentials credentials = new NetworkCredential("username", password);
                    request.Credentials = credentials;                        
                    request.Method = "POST";
                }
                string responseContent = null;

                using (HttpWebResponse response2 = (HttpWebResponse)request.GetResponse())
                {
                    using (Stream responseStream = response2.GetResponseStream())
                    {

                        using (StreamReader responseReader = new StreamReader(responseStream))
                        {
                            responseContent = responseReader.ReadToEnd();
                        }

                        Console.WriteLine(responseContent);
                        response.Close();
                        response2.Close();
                    }
                }
            }
            else
            {
                Console.WriteLine("Client was unable to connect!");
            }               
        }
        catch (UriFormatException e)
        {
            Console.WriteLine("Invalid URL");
        }
        catch (IOException e)
        {
            Console.WriteLine("Could not connect to URL");
        }            
    } 
```

# ruby-on-rails - 为什么 bundle install 会尝试安装 linecache19？

> ID：15666473
> 
> 赞同：2
> 
> 时间：2013-03-27T18:20:24.533
> 
> 标签：ruby-on-rails, bundle, linecache

我正在尝试运行“捆绑安装”。它尝试安装尚未发布的 linecache19 版本 0.5.13。我在 Gemfile 中找不到 linecache19 gem。它被安装为其他一些 gem 的依赖项。我想知道 linecache19 gem 用于什么以及谁需要它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T22:17:49.960

您可以`gem dependency GEMNAME`在 gemfile 中的每个 gem 上运行（可能还有它们的依赖项），以查看谁需要 linecache19 0.5.13。

也许其他人会知道一种一次性搜索整个依赖树的方法。

# iphone - 游戏中心邀请未显示

> ID：15666479
> 
> 赞同：4
> 
> 时间：2013-03-27T18:20:42.543
> 
> 标签：iphone, ios, game-center, multiplayer

我一直在开发一款允许多人比赛的游戏。我之前测试过多人邀请，它们都有效。从一台设备发送请求会在另一台设备上显示横幅，如果邀请被接受，则游戏开始。

就在两天前提交应用程序之前，我再次测试了这个功能，却发现它已经停止工作。

```
- (void)authenticateLocalUser:(UIViewController *)viewController :(id<GCHelperDelegate>)theDelegate
{ 
    delegate = theDelegate;
    self.presentingViewController = viewController;

    if (!gameCenterAvailable) {
        // Game Center is not available. 
        userAuthenticated = FALSE;
    } 
    else{
        GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];

        /*
         The authenticateWithCompletionHandler method is like all completion handler methods and runs a block
         of code after completing its task. The difference with this method is that it does not release the 
         completion handler after calling it. Whenever your application returns to the foreground after 
         running in the background, Game Kit re-authenticates the user and calls the retained completion 
         handler. This means the authenticateWithCompletionHandler: method only needs to be called once each 
         time your application is launched. This is the reason the sample authenticates in the application 
         delegate's application:didFinishLaunchingWithOptions: method instead of in the view controller's 
         viewDidLoad method.

         Remember this call returns immediately, before the user is authenticated. This is because it uses 
         Grand Central Dispatch to call the block asynchronously once authentication completes.
         */

        //ios 6
        [localPlayer setAuthenticateHandler:(^(UIViewController* viewcontroller, NSError *error) {
            if (viewcontroller != nil){
                userAuthenticated = FALSE;
                [self.presentingViewController presentViewController: viewcontroller animated: YES completion:nil];
            }
            else if (localPlayer.isAuthenticated){
                // Enable Game Center Functionality
                userAuthenticated = TRUE;

                [self checkForInvite:self.presentingViewController :delegate];

                if (! self.currentPlayerID || ! [self.currentPlayerID isEqualToString:localPlayer.playerID]) {

                    // Current playerID has changed. Create/Load a game state around the new user.
                    self.currentPlayerID = localPlayer.playerID;

                    // get friends of local player
                    [localPlayer loadFriendsWithCompletionHandler:^(NSArray *friends, NSError *error) {
                        if (friends != nil)
                        {
                            [self loadPlayerData: friends];
                        }
                    }];
                }
            }
            else{
                userAuthenticated = FALSE;
            }
            [scoreHandler setGameCentreAvailable:userAuthenticated];
        })];
    }
}

- (void)checkForInvite :(UIViewController *)viewController :(id<GCHelperDelegate>)theDelegate
{
    delegate = theDelegate;
    self.presentingViewController = viewController;
    NSLog(@"Invite handler installed");

    [GKMatchmaker sharedMatchmaker].inviteHandler = ^(GKInvite *acceptedInvite, NSArray *playersToInvite) {

        // Insert application-specific code here to clean up any games in progress. 
        if (acceptedInvite){
            NSLog(@"Accepted");
            GKMatchmakerViewController *mmvc = [[[GKMatchmakerViewController alloc] initWithInvite:acceptedInvite] autorelease];
            mmvc.matchmakerDelegate = self;
            [viewController presentViewController: mmvc animated: YES completion:nil];

        } else if (playersToInvite) {
            NSLog(@"Match Request");
            GKMatchRequest *request = [[[GKMatchRequest alloc] init] autorelease];
            request.minPlayers = 2; 
            request.maxPlayers = 2; 
            request.playersToInvite = playersToInvite;
            GKMatchmakerViewController *mmvc = [[[GKMatchmakerViewController alloc] initWithMatchRequest:request] autorelease];
            mmvc.matchmakerDelegate = self;
            [viewController presentViewController: mmvc animated: YES completion:nil];
        }
    };
} 
```

xcode 中的调试窗口显示如下：

```
2013-03-27 18:06:20.112 MyApp[791:907] Authentication changed: player authenticated.
2013-03-27 18:06:21.219 MyApp[791:907] Invite handler installed
Mar 27 18:06:21 Neils-iPhone MyApp[791] <Notice>: 18:06:21.356712 com.apple.GameKitServices: -[GKDiscoveryManager startAdvertisingLocalPlayer:discoveryInfo:]: I am [<nil>] [7989F444CF2BDA83] discoveryInfo [{
        e = 2;
        h = A42FD7FD;
    }] 
```

上面几行中的“我是 [] ...”是否重要？

我什至已经从 Ray Wenderlich 的网站下载并运行了创建多人游戏的教程并尝试过。这表现出相同的问题，除非它在两个设备上都在前台运行。即使在前台运行，我的应用程序也不会显示邀请请求。

有没有其他人遇到过这个问题或对发生了什么有任何想法？从 applicationDidFinishLaunching 调用 authenticateLocalUser

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-12T18:32:37.250

我可以通过名称邀请工作的唯一方法是转到`Settings/Notifications/Game Center`并让 Game Center 显示***Alerts***，而不是 Banners 。

如果你有 GC 显示警报，你会得到一个像这样的弹出框：

![在此处输入图像描述](../Images/b9cf1b1edef861aab9c6d945b5851e3f.png)

这个对话框就像一个大父母。如果用户点击`Accept`，那么你的`[GKMatchmaker sharedMatchmaker].inviteHandler`被调用。

如果用户点击`Decline`，那么**您的游戏永远不会知道他曾被邀请参加任何聚会**。用户点击`Decline`意味着父母撕毁了邀请，并且根本没有告诉他的孩子他被邀请参加游戏。

这是我可以通过姓名获得工作的唯一方法。

# java - 俄罗斯方块，移动一块

> ID：15666480
> 
> 赞同：0
> 
> 时间：2013-03-27T18:20:42.890
> 
> 标签：java, swing

我正在用 Java 制作俄罗斯方块...我可以让单个俄罗斯方块方块移动得很好...但是如果我尝试将整个方块（由多个方块组成）移动，任何方块移动到当前存在的瓦片（当前俄罗斯方块）的位置设置为空。

我的目标是这样的：

1）计算所有瓦片的新位置（现在只使用2个瓦片来测试）

```
if (keycode == KeyEvent.VK_DOWN) {  
    newX = tile.getX();     //tile x
    newY = tile.getY()+1;   //tile y
    newX2 = tile2.getX();   //tile 2 x
    newY2 = tile2.getY()+1; //tile 2 y 
```

2）将板上的当前瓷砖设置为空（基本上，从板上拾取所有瓷砖）

```
board.setTileAt(null, tile.getX(), tile.getY());
board.setTileAt(null, tile2.getX(), tile2.getY()); 
```

Board的setTileAt方法供参考：

```
public void setTileAt(Tile tile, int x, int y) {
    grid[x][y] = tile;
} 
```

3) 执行有效的移动检查（移动是否在边界内？并且... grid[x][y] 是否为空？）

4）最后，如果有效，将瓷砖放回新位置的板上

```
tile.setLocation(newX, newY);
tile2.setLocation(newX2, newY2); 
```

* * *

![在此处输入图像描述](../Images/699a03bca2f7f36769549efd55646389.png)

输出：

```
Game running...
original: 1, 1
new: 1, 2
original: 1, 2
new: 1, 3 
```

有什么想法吗？我从棋盘上捡起棋子的单个瓷砖然后在新位置更换它们的逻辑是否正确？

谢谢！

* * *

编辑：

向 Board 类添加了有效的移动检查：

界内？

```
 public boolean isValidCoordinate(int x, int y) {
    return x >= 0 && y >= 0 && x < width && y < height; 
} 
```

是开场吗？

```
public boolean isOpen(int x, int y) {
    return isValidCoordinate(x, y) && getTileAt(x, y) == null;
} 
```

在 Piece 类上，如果 isOpen 为真，我将当前图块位置设置为 null ......另外，我设置了新位置......

```
public void move(int keycode) {
    //move
    int newX, newY, newX2, newY2;
    if (keycode == KeyEvent.VK_DOWN) {  
        newX = tile.getX();
        newY = tile.getY()+1;
        newX2 = tile2.getX();
        newY2 = tile2.getY()+1;

        if (board.isOpen(newX2, newY2) && board.isOpen(newX, newY)) {
            board.setTileAt(null, tile.getX(), tile.getY());
            board.setTileAt(null, tile2.getX(), tile2.getY());

            System.out.println("original: " + tile.getX() + ", " + tile.getY());
            System.out.println("new: " + newX + ", " + newY);
            System.out.println("original: " + tile2.getX() + ", " + tile2.getY());
            System.out.println("new: " + newX2 + ", " + newY2);
            tile.setLocation(newX, newY);
            tile2.setLocation(newX2, newY2);
        }               
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:43:26.413

你有正确的步骤，但错误的顺序。

1.  计算所有图块的新位置（现在只使用 2 个图块来测试）

2.  执行有效的移动检查（移动是否在界限内？并且...是 grid[x][y] 为空吗？）

3.  如果有效，则将板上的当前图块设置为空（基本上，从板上拾取所有图块）

4.  最后，如果有效，将瓷砖放回新位置的板上

# jquery - $.post 之后 $(data).filter("…") 的奇怪行为

> ID：15666483
> 
> 赞同：0
> 
> 时间：2013-03-27T18:20:53.870
> 
> 标签：jquery

我不习惯为这些琐碎的事情打扰互联网，但这令人费解：`filter()`根据我使用的选择器，该函数要么返回一个 HTML 对象，要么返回未定义，甚至一些明显万无一失的选择器也可能返回未定义。

一个例子会更清楚： http: [//www.whisno.be/marice/contact.php](http://www.whisno.be/marice/contact.php)

只需点击按钮，您就会得到反馈：

```
alert(data);
alert($(data).filter($("#debug").val()).html()); 
```

我尝试了几个选择器，这让我感到困惑。任何人都明白发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:28:09.453

使用`find`代替`filter`：

```
alert($(data).find(debugValue).html()); 
```

输出：

> Les delices de Marice

这是`data`使用 jQuery 解析得到的值：

![在此处输入图像描述](../Images/0de3016c5c70c8b0ab3b76c667042912.png)

如您所见，它不`h1`直接包含，但确实包含`container`div。`filter`删除所有与选择器不匹配的元素 - 在这种情况下不匹配。`find`返回`h1`它可以在提供的元素列表中找到的所有元素。

# url - 重写我的基本 URL - Vbulletin

> ID：15666484
> 
> 赞同：0
> 
> 时间：2013-03-27T18:20:59.353
> 
> 标签：url, base-url

我目前有一个 vbulletin 论坛，我将其主题复制到另一个站点以进行应用程序。

在文件的顶部有这个：

```
<base href="http://example.com/forums/"/><!--[if IE]></base><![endif]--> 
```

所以我只是简单地复制/粘贴了源代码，然后修改了正文。

这里的问题是我有一个“submit.php”按钮，它的作用基于基本 url，所以它变成了`http://example.com/forums/submit.php` ，但我希望它这样做： `http://application.example.com/submit.php`

如果我从源代码更改 BASEURL，主题将不再起作用，我正在尝试保留主题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T02:09:12.347

如果你使用 apache 和 mod_rewrite，你可以在根目录下创建 .htaccess 文件

```
RewriteEngine on

# Don't apply to URLs that go to existing files or folders.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Only apply to URLs that aren't already under folder forums.
RewriteCond %{REQUEST_URI} !^/forums/

# Rewrite all those to insert /forums.
RewriteRule ^(.*)$ /forums/$1 
```

文档 [http://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

# log4net - Log4Net 中的 DateTimeOffset

> ID：15666485
> 
> 赞同：5
> 
> 时间：2013-03-27T18:20:59.373
> 
> 标签：log4net, datetimeoffset

将 DateTimeOffset 数据类型输出到数据库的 log4net.Layout.PatternLayout 值是什么？

这是我目前在 log4net 的配置文件中的内容：

```
<log4net>
....
<parameter>
      <parameterName value="@log_date" />
      <dbType value="DateTime" />
      <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'-'MM'-'dd HH':'mm':'ss'.'fff}" />
</parameter>
...
</log4net> 
```

我想要类似的东西：

```
<log4net>
....
<parameter>
      <parameterName value="@log_date" />
      <dbType value="DateTimeOffset" />
      <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'-'MM'-'dd HH':'mm':'ss'.'fff **OFFSET**}" />
</parameter>
...
</log4net> 
```

基本上，我们重用相同的数据库来记录来自不同时区的客户端的事件 - 所以我们想知道事件的确切本地时间。

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T03:06:26.963

您应该能够使用任何有效的[DateTime 格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。试试这个：

```
%date{yyyy-MM-ddTHH:mm:ss.fffzzz} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:53:42.923

将您的数据库列定义为 DateTime 并使用`%utcdate`而不是`%date`帮助？这应该使所有时间戳兼容。

# knockout.js - 使用 KnockoutJS，如何在加载可观察图片时显示临时图片？

> ID：15666489
> 
> 赞同：0
> 
> 时间：2013-03-27T18:21:05.733
> 
> 标签：knockout.js, knockout-2.0, preloading

想象一下，您有以下代表一本书的“轻”对象：

```
 var BookModel = function(data) {
        var self = this;
        self.id = ko.observable(data.id);
        self.title = ko.observable(data.title);
        self.pages = ko.observable(data.pages);
        self.pictureURL = ko.observable(data.pictureURL);
    }; 
```

现在，假设您必须在屏幕上显示很多书籍，因此需要在屏幕上显示很多书籍图片。这些图片不一定在您的网站上，即使它们在，也可能需要一些时间才能全部显示出来。

我想做的是在`pictureURL`更新此特定属性时使用给定的图片预加载图片，以便能够显示“延迟加载 gif”。图片预加载时，应该显示而不是延迟加载gif。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:21:05.733

好吧，我用[扩展器](http://knockoutjs.com/documentation/extenders.html)通过以下方式做到了：

```
ko.extenders.preloadImage = function(target, lazyImage) {
    var preloadedImage = null;
    var lazyLoadImage = lazyImage || "img/ajax-loader.gif";

    //create a writeable computed observable to intercept writes to our observable
    var result = ko.computed({
        read: target,  //always return the original observables value
        write: function(newValue) {
            var current = target();

            if(newValue == lazyLoadImage || newValue == preloadedImage) {
                valueToWrite = newValue;
            } else {
                preloadedImage = newValue;
                valueToWrite = lazyLoadImage;

                $('<img />').attr('src', newValue).load(function() {
                    valueToWrite = newValue;
                    preloadedImage = null;

                    target(valueToWrite);
                    target.notifySubscribers(valueToWrite);
                });
            }

            //only write if it changed
            if (valueToWrite !== current) {
                target(valueToWrite);
            } else {
                //if the rounded value is the same, but a different value was written, 
                // force a notification for the current field
                if (newValue !== current) {
                    target.notifySubscribers(valueToWrite);
                }
            }
        }
    });

    //initialize with current value
    result(target());

    //return the new computed observable
    return result;
}; 
```

您可以通过以下方式使用它：

```
 var BookModel = function(data) {
        var self = this;
        self.id = ko.observable(data.id);
        self.title = ko.observable(data.title);
        self.pages = ko.observable(data.pages);
        self.pictureURL = ko.observable(data.pictureURL).extend({ preloadImage : null });
    }; 
```

它适用于默认`img/ajax-loader.gif`图片或您作为`lazyImage`参数传递的另一张图片。基本上，每当要显示新图片时，都会显示延迟加载 gif。只有当浏览器预先加载了原始图片时，它才会真正显示在屏幕上。

这并不多，但它可能对这里的 KnockoutJS 爱好者有所帮助 :-) 另外，如果您认为它可能会更好，请编辑代码。

# java - Hibernate 4 自动删除多对多关系

> ID：15666507
> 
> 赞同：1
> 
> 时间：2013-03-27T18:22:21.130
> 
> 标签：java, hibernate, jpa

我将休眠从 3.5.6 更新到 4.10，我遇到了多对多关系的问题：

**用户类**

```
@Entity
@Table(name="user")
public class User {
    @ManyToMany(fetch=FetchType.LAZY)
    @Cascade(value={CascadeType.PERSIST, CascadeType.MERGE,CascadeType.REFRESH}) 
    @JoinTable(name="usersroles", joinColumns = { @JoinColumn(name ="usersroles_user" )}, inverseJoinColumns = { @JoinColumn(name = "usersroles_role") }) 
    @JSON(serialize=false)
    public Set<Role> getRoles() {
        return roles;
    }
} 
```

**角色类**

```
@Entity
@Table(name="role")
public class Role {  
    @ManyToMany(cascade {CascadeType.REFRESH},fetch=FetchType.LAZY,mappedBy="roles")
    @JSON(serialize=false)
    public Set<User> getUsers() {
        return users;
    }
} 
```

那是一种**查询方法**：

```
public List<User> getUserAndRoleList() {
    String jpql = "SELECT DISTINCT u FROM User u , Role r, UserRole ur  WHERE u.id = ur.userId AND r.id = ur.roleId ORDER BY u.username";
    QueryResult<User> qr = super.getDataWithOriginalJPQL(jpql);

    userList = qr.getResultList();
    return userList;
} 
```

当我想获得角色时：

```
userList = userService.getUserAndRoleList();
for(int i=0;i<userList.size();i++){
    Iterator<Role> it = userList.get(i).getRoles().iterator();
    Role role ;
} 
```

这行得通。但是当代码执行时

```
userList.get(i).getRoles() 
```

Hibernate 4.1 会自动删除 usersroles 表中的 User 和 Role 关系。但是在 Hibernate 3.6.5 中，它并没有删除这种关系。

事实上，我根本没有删除任何东西，也没有要求 hibernate 删除任何东西。可能会发生一些我不明白的事情。如何防止 Hibernate 删除？还是我做错了什么？

# c++ - 在 Windows 上创建包含 C++ 的 R 包

> ID：15666508
> 
> 赞同：2
> 
> 时间：2013-03-27T18:22:25.260
> 
> 标签：c++, r, installation, packaging

我的目标是用 C++ 代码在 R 中创建一个包：所以我的问题是如何？

我正在按照教程[http://www.stat.columbia.edu/~gelman/stuff_for_blog/AlanRPackageTutorial.pdf](http://www.stat.columbia.edu/~gelman/stuff_for_blog/AlanRPackageTutorial.pdf)创建包含 C++ 代码的 R 包。我试图编译和打包的具体代码与教程中描述的完全一样。

R CMD SHLIB 似乎正在创建 .dll 文件。我可以使用 dyn.load() 在 R 中加载并在模拟数据上进行测试（如教程中所述）

R CMD INSTALL 是问题开始的地方。我做了两件事，遇到了两个不同的错误，据说是相关的：

1）教程说 NAMESPACE 文件应该包含代码：

```
useDynLib(XDemo)
export(XDemoAutoC) 
```

当它确实 R CMD INSTALL 失败时导致错误：

> inDL(x,as.logical(local), as.logical(now),...) 中的错误：无法加载共享对象“C:/.../libs/i386/XDemo.dll”：加载库失败： 1% 不是有效的 Win32 程序

2) 删除 NAMESPACE 文件中的上述行将导致安装包。我可以在 R 中成功加载它，但是当我尝试使用对 C++ 编写函数进行 .C() 调用的 R 函数时，出现另一个错误：

```
library(newpackage)
ls(package:newpackage)
[[1]] "XDemoAutoC"
  Warning message:
 In ls(package:newpackage) :
 ‘package:newpackage’ converted to character string
 XDemoAutoC(c(1,2,3,4))
Error in .C("DemoAutoCor", OutVec = as.double(vector("numeric", OutLength)),  : 
 C symbol name "DemoAutoCor" not in load table 
```

我在 Windows 64 位上运行版本 R2.15.2 并使用 R64 位。

我阅读了以下类似问题的帖子： [http://r.789695.n4.nabble.com/Include-C-DLL-error-in-C-symbol-name-not-in-load-table-td3464021。 html](http://r.789695.n4.nabble.com/Include-C-DLL-error-in-C-symbol-name-not-in-load-table-td3464021.html)

除了他们没有提到命名空间问题。

我还阅读了这篇文章： [Problem with loading compiled c code in R x64 using dyn.load](https://stackoverflow.com/questions/4916853/problem-with-loading-compiled-c-code-in-r-x64-using-dyn-load)

所以我在想：基于我能够在 Rx64 中使用 dyn.load() 的事实意味着我已经成功创建了 x64 .dll。假设 NAMESPACE 文件应该保留在教程中 - 希望修复 >>not in load table<< 错误 - 这意味着我应该专注于解决问题一。这个问题似乎是由与 32 位相关的东西引起的。我在 .dll 文件上使用了 Dependency Walker，但我不确定如何解释结果![在此处输入图像描述](../Images/a343b2f0bbfed0669427448e40758bd7.png)

我真的对如何解决这个问题没有任何想法，所以欢迎任何关于如何做的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:50:07.013

我认为你做错了。两个快速建议：

1.  阅读[编写 R 扩展](http://cran.r-project.org/doc/manuals/r-release/R-exts.html)手册来解释这一点：*编写 R 扩展*，包括那些带有编译代码的扩展

2.  看看[Rcpp](http://dirk.eddelbuettel.com/code/rcpp.html)，它使 R 和 C++ 扩展，包括包构建*变得更加容易*。或者我们认为。编写一个包就像调用`Rcpp.package.skeleton()`. 1) 中的文档仍然有帮助。

也就是说，如果`R CMD INSTALL`失败，您的`$PATH`. 永远不要混合 MinGW 和 Cygwin。确保在构建或调用 R 时没有找到 Cygwin DLL。路径顺序*非常*重要。有关详细信息，请参阅手册。

# asp.net-mvc - 如何使用现有的 MVC 应用程序启用 OAuth？

> ID：15666511
> 
> 赞同：1
> 
> 时间：2013-03-27T18:22:31.233
> 
> 标签：asp.net-mvc, oauth

我有一个带有 MVC 4 互联网应用程序的 SQL Server 数据库。如何将 OAuth 与现有数据库和现有用户表（不幸的是，称为“客户”）一起使用。我尽量避免改变。有没有人有任何有用的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:34:16.953

看看[DotNetOpenAuth](http://www.dotnetopenauth.net/)。它与 VS2012 一起提供，可通过 NuGet 获得，并且似乎比更简单的 WCF 设置更适合 ASP.NET MVC 受众。

# string - 如何使用 If 语句使扫描仪只接受字母字符

> ID：15666514
> 
> 赞同：0
> 
> 时间：2013-03-27T18:22:45.527
> 
> 标签：string, java.util.scanner, alphabetical

我是 Java 编程的初学者，我正在编写一个按字母顺序对名称进行排序的程序。如何编写“ `if`”语句，使其只接受字母字符？在我的代码中，我有“ `if (in.hasNext() != String)`”，这显然是错误的，但我现在只是在尝试任何事情。这是我的代码。

```
import java.util.*;

public class AlphaOrder
{
    public static void main(String[] args)
    {
        ArrayList<String> names = new ArrayList<String>();

        System.out.println("Enter a name, enter \"Sort\" to sort the names alphabetically, enter \"Quit\" to end: ");
        Scanner in = new Scanner(System.in);

        while (in.hasNext())
        {
            names.add(in.next());

            if (in.hasNext("Sort"))
            {
                System.out.println("The names in alphabetical order are: " + names);
            }   
            if (in.hasNext("Quit"))
            {
                System.out.println("This Program has stopped.");
            }
            if (in.hasNext() != String)
            {
                System.out.println("Please enter only alphabetical characters.");
            }                       
        }       
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:30:33.790

1）您可能想稍微改变一下逻辑：

```
import java.util.*;

public class AlphaOrder
{
  public static void main(String[] args) {
    ArrayList<String> names = new ArrayList<String>();

    System.out.println("Enter a name, enter \"Sort\" to sort the names alphabetically, enter \"Quit\" to end: ");
    Scanner in = new Scanner(System.in);

    while (in.hasNext()) {
      String sLine = in.next ();
      if (sLine.equals ("Sort")) {
        System.out.println("The names in alphabetical order are: " + names);
        doSort ();
      }
      if (sLine.equals ("Sort")) {
        System.out.println("This Program has stopped.");
        doExit ();
      }
      if (!isAlpha (sLine)) {
         System.out.println("Please enter only alphabetical characters.");
         continue;
      }
      names.add(sLine);
    }
  }
} 
```

2) 有很多方法可以检查“isAlpha()”。我会看“正则表达式”：

[http://www.vogella.com/articles/JavaRegularExpressions/article.html](http://www.vogella.com/articles/JavaRegularExpressions/article.html)

3）这是一个“天真的”实现：

```
boolean isAlpha (String s)
{
  String s2 = s.toUpperCase();

  for (int i = 0; i < s2.length(); i ++) {
    if (s2.charAt(i) < 'A' || s2.charAt(i) > 'Z')
      return false;
  }
  return true;
} 
```

# ajax - CakePHP-AjaxMultiUpload 和 Auth

> ID：15666522
> 
> 赞同：0
> 
> 时间：2013-03-27T18:23:18.397
> 
> 标签：ajax, cakephp, authentication, upload

我的问题是，我使用了这个插件[https://github.com/srs81/CakePHP-AjaxMultiUpload/](https://github.com/srs81/CakePHP-AjaxMultiUpload/)并且一切正常。但是现在我在一个新项目中再次“安装”了它，并且收到了“失败”消息。与我的旧项目相比，唯一不同的是，我使用了 Auth-Component。我不能同时使用两者吗？

对不起我的英语，但我来自德国:)

提前致谢！

我的上传控制器：

```
 <?php
App::uses('AppController', 'Controller');

class UploadController extends AppController { 

    public function beforeFilter() {
        parent::beforeFilter();
        $this->Auth->allow(array('add')); 
    }

    public function isAuthorized() {
         return true; 
    }

    public function add() {

    }

} ?> 
```

我的观点：

```
<?php    
echo $this->Form->create('Upload', array('type' => 'file'));
    echo $this->Upload->edit('Upload', 'test');
    echo $this->Form->end();
    echo $this->Upload->view('Upload', 'test');
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:11:07.377

以下内容取自插件（在问题中）的 github gotchas 部分，此处重新引用[https://github.com/srs81/CakePHP-AjaxMultiUpload/](https://github.com/srs81/CakePHP-AjaxMultiUpload/)

感谢 rscherf@github 进行了以下两个修复。

使用身份验证

如果您使用 Auth（CakePHP 核心 Auth 或一些兼容或不兼容的），您需要修改控制器以允许上传工作。

将这些行添加到 UploadsController.php（根据您的 Auth 设置，您可能需要稍作修改）：

```
public function isAuthorized() {
    return true;
}

public function beforeFilter() {
    $this->Auth->allow(array('upload','delete'));
} 
```

# regex - 正则表达式捕捉弗吉尼亚伍尔夫小说 The Waves 中的对话？

> ID：15666526
> 
> 赞同：1
> 
> 时间：2013-03-27T18:23:35.457
> 
> 标签：regex

我们一群英语研究生正在学习[弗吉尼亚伍尔夫的小说 The Waves](http://www.gutenberg.net.au/ebooks02/0201091.txt)中的对话，我一直在尝试在 TEI 中标记小说。为此，编写一个捕获对话框的正则表达式会很有用。值得庆幸的是，The Waves 非常有规律，几乎所有的对话都是这样的：

“现在他们都走了，”路易斯说。'我独自一人。他们已经进屋吃早餐了，”

但可以持续几段。我正在尝试编写一个正则表达式来匹配给定演讲者的所有段落。

[这在Chris Foster 的博客文章](http://cforster.com/2013/02/reading-the-waves-with-stephen-ramsay/)中进行了简要讨论，他在其中提出了类似的建议`/'([\^,]+,)' said Louis, '(*)'/`，尽管我认为这只会匹配单个段落。这就是我的思考方式：

*   对于在该段落的第一行中包含文本“Said Louis”（或任何其他角色的名字）的每个段落，匹配每一行直到到达另一个角色的演讲，即“Said Rhodha”。

我可能可以用大量笨拙的python来做到这一点，但我很想知道这是否可以用正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:26:01.910

从您的链接看来，文本遵循以下规则。

1.  每条“线”确实是严格意义上的一条*线*，*即*用 .分隔`\n`。
2.  段落由两个或多个连续的新行分隔，_i.e. `\n\n+`.
3.  只有无方向的单引号`'`用于区分语音。

**[这是一个快速的尝试](http://rubular.com/r/z38jGRm3VC)（一直向下滚动以查看比赛组）** ——我敢肯定，有缺陷——但这里有足够的内容可以引导你朝着正确的方向前进。请注意，如果您连接三个捕获组（习惯上称为`$1`、`$2`和`$3`），您将如何获得每个字符的语音，包括“所说”分隔符之间的标点符号。但是，请注意语言的某些怪癖如何摆脱这个正则表达式 - 例如，我们不会在段落末尾关闭引号，但如果演讲继续到下一段，则打开新引号，这会破坏整个平衡 -引用策略——撇号也是如此。

```
\n\n.*?'([^^]+?[?]?),?' said (?:[A-Z][a-z]+)(?:([.])  |, )'([^^]+?)'(?=[^']*(?:'[^']')*[^']*\n\n.*'(?:[^^]+?[?]?),?' said (?:[A-Z][a-z]+)(?:[.]  |, ))
|   |  | <----><--> <>|<-------------------><------------>| <----> |<--------------------------------------------------------------------------------->
|   |  | |     |    | ||                    |             | |      ||
|   |  | |     |    | ||                    |             | |      |assert that this end-quote is followed by a string of non-quote characters, then
|   |  | |     |    | ||                    |             | |      |zero or more strings of quoted non-quote characters, then another string of non-
|   |  | |     |    | ||                    |             | |      |quote characters, a new paragraph, and the next "said Bernard"; otherwise fail.
|   |  | |     |    | ||                    |             | |      |
|   |  | |     |    | ||                    |             | |      match an (end-)quote
|   |  | |     |    | ||                    |             | |
|   |  | |     |    | ||                    |             | match any character as needed (but no more than needed)
|   |  | |     |    | ||                    |             |
|   |  | |     |    | ||                    |             match a (start-)quote
|   |  | |     |    | ||                    |
|   |  | |     |    | ||                    match either a period followed by two spaces, or a comma followed by one space
|   |  | |     |    | ||
|   |  | |     |    | |match the "said Bernard"
|   |  | |     |    | |
|   |  | |     |    | match an (end-)quote
|   |  | |     |    |
|   |  | |     |    match a comma, optionally
|   |  | |     |
|   |  | |     match a question mark, optionally
|   |  | |
|   |  | match any character as needed (but no more than needed)
|   |  |
|   |  match a (start-)quote
|   |
|   match as many non-newline characters as needed (but no more than needed)
|
new paragraph 
```

Rubular 匹配（摘录）：

```
Match 3

1\.  But when we sit together, close
2\.   
3\.  we melt into each
    other with phrases. We are edged with mist. We make an
    unsubstantial territory.

Match 4

1\.  I see the beetle
2\.  .
3\.  It is black, I see; it is green,
    I see; I am tied down with single words. But you wander off; you
    slip away; you rise up higher, with words and words in phrases. 
```

# java - 如何拆分java类文件（.java）

> ID：15666527
> 
> 赞同：0
> 
> 时间：2013-03-27T18:23:36.363
> 
> 标签：java, file, class, split, project

在我的项目中，我有许多类，其中包含许多子类，因此我想将它们拆分为多个 .java 文件，就像我见过的其他项目一样，例如 miglayout 开源项目，有一个名为 MigPane.java 的类，并且看起来它被拆分为多个文件（MigPane$subClassName.java、MigPane$subClassName2.java）。

请问这样怎么办？对不起，我的英语不好。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:27:06.977

当您看到类文件时，例如`MigPane$subClassName.class`它是`MigPane`包含名为`subClassName`. 编译器自动将这样一个类从一个名为的源编译为`MigPane.java`两个单独的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:26:50.597

不，你不能这样做。您在目录或项目中看到的这些多个文件（例如`MigPane$subClassName.class`）基本上是在类中`subClassName`定义的内部类（例如）`MigPane.java`。这些嵌套类以某种方式与封闭类相关联，因此您无法将它们隔离开来。

# c# - 如果您使用通用 System.action() 调用，如何从 WCF 调用返回值？

> ID：15666538
> 
> 赞同：0
> 
> 时间：2013-03-27T18:24:01.713
> 
> 标签：c#, wcf

为了减少代码量，我们的团队在 StartProcess 方法中放置了一个方法，以便为来自单个方法的所有调用调用 WCF 实现。这一切都很好，但由于来自通用方法的实际调用使用 System.Action 来调用，它永远不能返回值，并且由于我正在进行的调用之一我想发出请求/回复，我可以' t 得到那个返回值。

这是处理 WCF 请求的通用方法：

```
public static ProcessResultDC StartProcess<T>(T setupData, string processName, Action<T> action, string exteriorAccountNumber, string companyCode) where T : IAmValidatable, IHaveAProcessGuid {

    var result = new ProcessResultDC { Status = ProcessStatusEnum.Accepted };
    // Do some authentication stuff here

    try {

        action(setupData);    // <-- This returns void, but I would like to return a string to the client

    } catch (Exception exc) {
        result.Status = ProcessStatusEnum.Error;
        result.Messages.Add(exc.Message);
    }
    return result;
} 
```

这是客户电话：

```
var createOnDemandDataDc = new CreateOnDemandDataDc { RawData = punchRawData };
var result = TimeForceProcessHelper.StartProcess(createOnDemandDataDc, "Create On Demand Data", x => new CreateOnDemandDataProxy().CreateOnDemandData(createOnDemandDataDc), "NA", companyCode); 
```

即使我的 createOnDemandDataDc 实现返回一个字符串，结果变量也无法知道来自操作调用的字符串。

有一个更好的方法吗？或者我可以简单地执行 Action() 调用以外的操作来获取返回字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:55:35.623

`Action<T>`您可以使用`Func<T, TResult>`允许回调将值返回给调用者，而不是使用回调参数`StartProcess`。但是，这将要求您的所有回调都需要更改为返回值的函数。如果您只有一个需要返回回复的回调，则可能不是一个愉快的想法。

另一种有点脏的方法可能是直接在 CreateOnDemandDataDc 回调函数中写入对当前活动 OperationContext 的响应。查看`OperationContext.Current.RequestContext.Reply`和相关的属性/方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:06:47.623

这也是我做AOP的方式。每个方面都需要两种方法 - 一种用于 an `Action`，一种用于 a`Func`

如果你先写一个`Func`：

```
public static ProcessResultDC StartProcess<T, TResult>(
  T setupData,
  string processName,
  Func<T, TResult> fn,
  string exteriorAccountNumber,
  string companyCode
)
  where T : IAmValidatable, IHaveAProcessGuid
{
  var result = new ProcessResultDC { Status = ProcessStatusEnum.Accepted };

  // Do some authentication stuff here

  try
  {
    result.Result = fn(setupData);
  }
  catch (Exception exc)
  {
    result.Status = ProcessStatusEnum.Error;
    result.Messages.Add(exc.Message);
  }

  return result;
} 
```

然后你可以编写一个用于`Action`使用`Func`实现：

```
public static ProcessResultDC StartProcess<T>(
  T setupData,
  string processName,
  Action<T> fn,
  string exteriorAccountNumber,
  string companyCode
)
  where T : IAmValidatable, IHaveAProcessGuid
{
  return StartProcess(
    setupData,
    processName,
    t => { fn( t ); return 0; },
    exteriorAccountNumber,
    companyCode
  );
} 
```

# jquery - jQuery Mobile 和规模

> ID：15666544
> 
> 赞同：0
> 
> 时间：2013-03-27T18:24:22.780
> 
> 标签：jquery, cordova, jquery-mobile

我正在玩 Phonegap 和 jQuery Mobile，我发现默认样式在我的测试设备（HTC nexus one）上看起来相当小，坦率地说，我是移动 Web 开发的新手（哎呀，一般是智能手机......），所以我不完全确定这是否是典型的，但一切都太小/很难阅读和填写。

我试过类似的东西：

```
<meta name="viewport" content="width=device-width,initial-scale=3, maximum-scale=4"> 
```

（增加规模和所有），但到目前为止没有成功。

我应该如何扩展我的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:01:42.047

I've managed to "fix" this, I set the `target-densitydpi` in viewport to `medium-dpi`, so in final: `target-densitydpi=medium-dpi`, on this phone, everything looks proper sized.

I do not know how this affects other phones though.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T04:37:34.047

jQuery Mobile 能够扩展您的移动应用程序。如果你开始为你的 Nexus One 扩展你的手机，那么在更大的屏幕上情况会变得很糟糕。按钮和其他 UI 元素看起来会更大。

您为什么不访问一些[jQuery Mobile 网站](http://www.jqmgallery.com/)，看看它在您的 Nexus One 上的外观。如果它们看起来也很小，请保持原样。不要搞砸它并破坏其他使用 Nexus S 以外设备的用户的可用性。

# html - pdo 在服务器上插入消毒 html，而不是在本地

> ID：15666545
> 
> 赞同：1
> 
> 时间：2013-03-27T18:24:30.857
> 
> 标签：html, mysql, pdo, sanitization

我正在将来自 html 编辑器的数据插入到我的数据库中。我有 html 净化器设置，但已将其删除作为示例，因为无论如何问题都存在。

```
GLOBAL $DB;

        $queryHandle = $DB->prepare("UPDATE support SET
                                    help = :help
                                    WHERE id = :id");
        $queryHandle->BindParam(':id', $id);
        $queryHandle->BindParam(':help', PDO::PARAM_STR);           
        $queryHandle->execute();
        $queryHandle->setFetchMode(PDO::FETCH_ASSOC);

        return $queryHandle;
        } 
```

帮助是 html 文本。在本地它工作正常。当我将我的网站上传到我的服务器时，html 会在每个引用后面加上 \'s。我没有魔术引号或任何其他清理设置。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:26:26.757

您打开了[魔术引号，这意味着您的服务器配置错误。](http://php.net/manual/en/security.magicquotes.php)把它关掉。

# macos - 如何从 x86_64-apple-darwin 主机为 i386-apple-darwin 目标构建交叉编译器？

> ID：15666547
> 
> 赞同：7
> 
> 时间：2013-03-27T18:24:32.290
> 
> 标签：macos, gcc, cross-compiling, gnu, darwin

**问题概述**

我正在尝试学习如何构建交叉编译器，特别是`gcc`在 64 位 Intel OS X 主机上以`i386-apple-darwin`（32 位 Intel）为目标的 GNU 4.7.2 版本。但是，我一直陷入同样的​​错误：

```
...
checking for i386-apple-darwin-gcc... /Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/xgcc -B/Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/bin/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/lib/ -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/include -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/sys-include
checking for suffix of object files... configure: error: in `/Users/alexpreynolds/Developer/third-party/build-gcc/i386-apple-darwin/libgcc':
configure: error: cannot compute suffix of object files: cannot compile
See `config.log' for more details.
make[1]: *** [configure-target-libgcc] Error 1
make: *** [all] Error 2 
```

**构建过程**

我首先构建了一个 GNU 版本`binutils`，`i386-apple-darwin`它可以通过 GNU`gcc`构建文件夹访问：

```
$ cd third-party
$ wget http://ftp.gnu.org/gnu/binutils/binutils-2.23.2.tar.bz2
$ tar xjvf binutils-2.23.2.tar.bz2
$ mkdir i386-apple-darwin
$ mkdir build-binutils && cd build-binutils
$ ../binutils-2.23.2/configure --target=i386-apple-darwin --prefix="/Users/alexpreynolds/Developer/third-party/i386-apple-gcc"
$ make all && make install
... 
```

然后我尝试构建`gcc`如下的目标版本：

```
$ cd ..
$ pwd
/Users/alexpreynolds/Developer/third-party
$ wget http://ftp.gnu.org/pub/gnu/gcc/gcc-4.7.2/gcc-4.7.2.tar.bz2
$ tar xvjf gcc-4.7.2.tar.bz2
$ cd gcc-4.7.2
$ ./contrib/download_prerequisites
... /* this grabs GMP, MPC and MPFR dependencies */
$ cd ..
$ mkdir build-gcc && cd build-gcc
$ ../gcc-4.7.2/configure --target=i386-apple-darwin --prefix="/Users/alexpreynolds/Developer/Bedops/bedops/third-party/i386-apple-gcc"
$ make
... 
```

编译大约 30 分钟后，它卡在上面显示的错误消息中。

**错误详情**

为了追查错误的来源，这里有一个片段`build-gcc/i386-apple-darwin/libgcc/config.log`：

```
configure:3344: /Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/xgcc -B/Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/bin/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/lib/ -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/include -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/sys-include    -V >&5
xgcc: error: unrecognized command line option '-V'
xgcc: fatal error: no input files
compilation terminated.
configure:3355: $? = 1
configure:3344: /Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/xgcc -B/Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/bin/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/lib/ -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/include -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/sys-include    -qversion >&5
xgcc: error: unrecognized command line option '-qversion'
xgcc: fatal error: no input files
compilation terminated.
configure:3355: $? = 1
configure:3371: /Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/xgcc -B/Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/bin/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/lib/ -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/include -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/sys-include    -o conftest -g -O2   conftest.c  >&5
Assembler messages:
Fatal error: invalid listing option `r'
configure:3374: $? = 1
configure:3562: checking for suffix of object files
configure:3584: /Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/xgcc -B/Users/alexpreynolds/Developer/third-party/build-gcc/./gcc/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/bin/ -B/Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/lib/ -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/include -isystem /Users/alexpreynolds/Developer/third-party/i386-apple-gcc/i386-apple-darwin/sys-include    -c -g -O2  conftest.c >&5
Assembler messages:
Fatal error: invalid listing option `r'
configure:3588: $? = 1
configure: failed program was:
| /* confdefs.h */
| #define PACKAGE_NAME "GNU C Runtime Library"
| #define PACKAGE_TARNAME "libgcc"
| #define PACKAGE_VERSION "1.0"
| #define PACKAGE_STRING "GNU C Runtime Library 1.0"
| #define PACKAGE_BUGREPORT ""
| #define PACKAGE_URL "http://www.gnu.org/software/libgcc/"
| /* end confdefs.h.  */
|
| int
| main ()
| {
|
|   ;
|   return 0;
| }
configure:3602: error: in `/Users/alexpreynolds/Developer/third-party/build-gcc/i386-apple-darwin/libgcc':
configure:3605: error: cannot compute suffix of object files: cannot compile
See `config.log' for more details. 
```

**我正在引导的编译器**

```
$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/opt/local/libexec/gcc/x86_64-apple-darwin12/4.7.2/lto-wrapper
Target: x86_64-apple-darwin12
Configured with: ../gcc-4.7.2/configure --prefix=/opt/local --build=x86_64-apple-darwin12 --enable-languages=c,c++,objc,obj-c++,lto,fortran,java --libdir=/opt/local/lib/gcc47 --includedir=/opt/local/include/gcc47 --infodir=/opt/local/share/info --mandir=/opt/local/share/man --datarootdir=/opt/local/share/gcc-4.7 --with-libiconv-prefix=/opt/local --with-local-prefix=/opt/local --with-system-zlib --disable-nls --program-suffix=-mp-4.7 --with-gxx-include-dir=/opt/local/include/gcc47/c++/ --with-gmp=/opt/local --with-mpfr=/opt/local --with-mpc=/opt/local --with-ppl=/opt/local --with-cloog=/opt/local --enable-cloog-backend=isl --disable-cloog-version-check --enable-stage1-checking --enable-lto --enable-libstdcxx-time --with-as=/opt/local/bin/as --with-ld=/opt/local/bin/ld --with-ar=/opt/local/bin/ar --with-bugurl=https://trac.macports.org/newticket --disable-ppl-version-check --with-pkgversion='MacPorts gcc47 4.7.2_2+universal'
Thread model: posix
gcc version 4.7.2 (MacPorts gcc47 4.7.2_2+universal) 
```

**问题**

在设置构建环境`coreutils`或`gcc`导致此错误的过程中，我是否错过了一个步骤？

在尝试解决此错误时，我还能排除哪些故障？我对这条错误消息的谷歌搜索没有取得太多成果。

* * *

**变化**

我将构建脚本更改如下：

```
#!/bin/bash -x

WORK_DIR=$PWD
INSTALL_DIR=$WORK_DIR/gcc-4.7.2-darwin
MIN_OSX_VERSION=10.5

if [ -d "$INSTALL_DIR" ]; then
    echo "Directory $INSTALL_DIR already exists";
    exit 1
fi

BINUTILS=binutils-2.23.2
TARBALL_BINUTILS=$BINUTILS.tar.bz2
URL_BINUTILS=http://ftp.gnu.org/gnu/binutils/$TARBALL_BINUTILS
SOURCE_BINUTILS_DIR=$WORK_DIR/$BINUTILS
BUILD_BINUTILS_DIR=$WORK_DIR/build-$BINUTILS

GCC=gcc-4.7.2
TARBALL_GCC=$GCC.tar.bz2
URL_GCC=http://ftp.gnu.org/pub/gnu/gcc/$GCC/$TARBALL_GCC
SOURCE_GCC_DIR=$WORK_DIR/$GCC
BUILD_GCC_DIR=$WORK_DIR/build-$GCC

curl -O $URL_BINUTILS
mkdir -p $SOURCE_BINUTILS_DIR
tar -xjvf $TARBALL_BINUTILS
rm $TARBALL_BINUTILS
mkdir -p $BUILD_BINUTILS_DIR
cd $BUILD_BINUTILS_DIR
$SOURCE_BINUTILS_DIR/configure --prefix=$INSTALL_DIR
make -j $(sysctl -n hw.availcpu) all CFLAGS='-Wno-error' && make install

find $INSTALL_DIR -name '*strip*' -delete

cd $WORK_DIR

curl -O $URL_GCC
mkdir -p $SOURCE_GCC_DIR
tar -xvjf $TARBALL_GCC
rm $TARBALL_GCC
cd $SOURCE_GCC_DIR
sed -i '' -e 's/wget/curl -O/g' $SOURCE_GCC_DIR/contrib/download_prerequisites
$SOURCE_GCC_DIR/contrib/download_prerequisites
cd $WORK_DIR
mkdir -p $BUILD_GCC_DIR
cd $BUILD_GCC_DIR
$SOURCE_GCC_DIR/configure --prefix=$INSTALL_DIR --enable-languages=c,c++
make -j $(sysctl -n hw.availcpu) CFLAGS="-mmacosx-version-min=$MIN_OSX_VERSION" && make install

find $INSTALL_DIR -name '*.a' -print0 | xargs -0 -n1 ranlib

rm -Rf $BUILD_GCC_DIR
rm -Rf $BUILD_BINUTILS_DIR
rm -Rf $SOURCE_GCC_DIR
rm -Rf $SOURCE_BINUTILS_DIR 
```

`ranlib`由于在构建库的过程中出现了许多错误，因此该步骤是必要的。

要构建`i386`二进制文件，我必须对我的 执行以下操作`Makefile`：

```
ARCH                 = i386
...
GCCDIR               = ${PARTY3}/gcc-4.7.2-darwin
GCCBINDIR            = ${GCCDIR}/bin
GCCLIBDIR            = ${GCCDIR}/lib
GCCINCDIR            = ${GCCDIR}/include
...
LIBCPP               = libgcc_eh.a
LIBCXX               = libstdc++.a
...
INCLUDES             = -I${GCCINCDIR} ...
...
CC                   = ${GCCBINDIR}/gcc
CXX                  = ${GCCBINDIR}/g++
...
GCCCPPLIBPATH        = ${GCCLIBDIR}/gcc/x86_64-apple-darwin12.3.0/4.7.2/${ARCH}/${LIBCPP}
GCCCXXLIBPATH        = ${GCCLIBDIR}/${ARCH}/${LIBCXX}
...
FLAGS                = ${SFLAGS} ${NONSTATICFLAGS} ${OBJS} -L${GCCLIBDIR} ...
...
run: dependencies
    mkdir -p ${BIN} && ${CXX} -o ${BIN}/${PROG}_${ARCH} ${FLAGS} -static-libgcc -mmacosx-version-min=${MIN_OSX_VERSION} -arch ${ARCH} ... ${GCCCPPLIBPATH} ${GCCCXXLIBPATH} ${SOURCE1} 
```

变更摘要`Makefile`：

1.  我必须添加`-static-libgcc`标志并省略`-static-libstdc++`，这没有任何效果（除了导致构建失败，直到我`ranlib`在静态库上运行，它修复了构建失败但对 没有影响`-static-libstdc++`）。

2.  我将`${GCCCPPLIBPATH}`和添加`${GCCCXXLIBPATH}`到`run`目标中，每个都分别指向静态 C anc C++ 库`libgcc_eh.a`和`libstdc++.a`。

这使我能够编译一个工作`i386`（32 位）二进制文件，但相同的 GCC 安装未能构建一个工作`x86_64`（64 位）二进制文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T11:38:27.953

稍微考虑一下之后，我想到到目前为止最简单的解决方案是为 x86_64 编译 GCC，然后`-m32`在您希望为 i386 构建时通过。由于某种原因，这还不足以满足您的需求吗？以这种方式构建非常简单，并且不需要下面描述的任何疯狂。执行以下事件序列会生成一个工作编译器，该编译器将在请求时输出 i386 二进制文件：

```
WORK_DIR=$PWD
INSTALL_DIR=$WORK_DIR/install

curl -O http://ftp.gnu.org/gnu/binutils/binutils-2.23.2.tar.bz2
tar xjvf binutils-2.23.2.tar.bz2
mkdir build-binutils && cd build-binutils
../binutils-2.23.2/configure --prefix=$INSTALL_DIR
make -j $(sysctl -n hw.availcpu) all CFLAGS='-Wno-error' && make install

find $INSTALL_DIR -name '*strip*' -delete

cd $WORK_DIR

curl -O http://ftp.gnu.org/pub/gnu/gcc/gcc-4.7.2/gcc-4.7.2.tar.bz2
tar xvjf gcc-4.7.2.tar.bz2
cd gcc-4.7.2
sed -i '' -e 's/wget/curl -O/g' ./contrib/download_prerequisites
./contrib/download_prerequisites
cd ..
mkdir build-gcc && cd build-gcc
../gcc-4.7.2/configure --prefix=$INSTALL_DIR --enable-languages=c,c++
make -j $(sysctl -n hw.availcpu) && make install 
```

完成后，您可以看到它的运行情况，如下所示：

```
mrowe@falcon:~/tmp$ cat > test.cpp
#include <iostream>

int main(int argc, char **argv) {
    std::cerr << "Built with GCC 4.7" << std::endl;
    return 0;
}

^D
mrowe@falcon:~/tmp$ ./install/bin/g++ -o test test.cpp 
mrowe@falcon:~/tmp$ file test
test: Mach-O 64-bit executable x86_64
mrowe@falcon:~/tmp$ ./install/bin/g++ -m32 -static-libgcc -static-libstdc++ -o test test.cpp 
mrowe@falcon:~/tmp$ file test
test: Mach-O executable i386
mrowe@falcon:~/tmp$ otool -L ./test
./test:
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1192.0.0)
mrowe@falcon:~/tmp$ ./test 
Built with GCC 4.7
mrowe@falcon:~/tmp$ 
```

如果您看到如下警告：

```
ignoring file …/4.7.2/i386/libgcc.a, file was built for archive which is not the architecture being linked (i386) 
```

`ranlib`您可以通过在静态库上运行来修复它们：

```
find $INSTALL_DIR -name '*.a' -print0 | xargs -0 -n1 ranlib 
```

* * *

以下是我试图帮助你沿着你试图遵循的道路的尝试。我认为这不是理想的方法，而且充满了问题。

您报告看到的错误是由于您的 GCC 构建尝试使用 binutils 中的 GNU 汇编器，而生成的程序集打算使用 Apple cctools 中的 GNU 汇编器进行汇编。由于 Apple 的汇编器在多年前与上游的 GNU 汇编器分道扬镳，因此两者所支持的汇编方言有所不同。

我能够找到的用于构建 cctools 的所有说明都已过时，因此我进行了试验，直到我得到了一些工作。我做了一些接近以下的事情：

```
curl -O http://opensource.apple.com/tarballs/cctools/cctools-829.tar.gz
tar xvzf cctools-829.tar.gz
cd cctools-829 
```

然后，您需要修补两个文件才能在不依赖 LLVM 的情况下构建：

```
diff -ru cctools-829/libstuff/lto.c cctools-829.modified/libstuff/lto.c
--- cctools-829/libstuff/lto.c  1969-12-31 16:00:00.000000000 -0800
+++ cctools-829.modified/libstuff/lto.c 2013-04-05 03:18:34.000000000 -0700
@@ -376,4 +376,18 @@
        lto_dispose(mod);
 }

+#else 
+
+#include <stdlib.h>
+
+__private_extern__
+int
+is_llvm_bitcode(
+                struct ofile *ofile,
+                char *addr,
+                size_t size)
+{
+    return 0;
+}
+
 #endif /* LTO_SUPPORT */
diff -ru cctools-829/misc/libtool.c cctools-829.modified/misc/libtool.c
--- cctools-829/misc/libtool.c  1969-12-31 16:00:00.000000000 -0800
+++ cctools-829.modified/misc/libtool.c 2013-04-05 03:20:21.000000000 -0700
@@ -1369,8 +1369,11 @@
                    }
                }
                 }
-                else if(ofiles[i].arch_type == OFILE_Mach_O ||
-                        ofiles[i].arch_type == OFILE_LLVM_BITCODE){
+                else if(ofiles[i].arch_type == OFILE_Mach_O
+#ifdef LTO_SUPPORT
+                            || ofiles[i].arch_type == OFILE_LLVM_BITCODE
+#endif
+                            ){
                if(cmd_flags.ranlib == TRUE){
                    error("for architecture: %s file: %s is not an "
                          "archive (no processing done on this file)", 
```

然后构建：

```
make install USE_DEPENDENCY_FILE=NO BUILD_DYLIBS=NO LTO= TRIE= DSTROOT=../build-cctools 
```

并手动安装必要的部件：

```
cd ..
cp build-cctools/usr/bin/as i386-apple-gcc/bin/i386-apple-darwin-as
cp build-cctools/usr/bin/as i386-apple-gcc/i386-apple-darwin/bin/as
cp build-cctools/usr/bin/lipo i386-apple-gcc/bin/i386-apple-darwin-lipo
cp build-cctools/usr/bin/lipo i386-apple-gcc/i386-apple-darwin/bin/lipo
cp build-cctools/usr/bin/strip i386-apple-gcc/bin/i386-apple-darwin-strip
cp build-cctools/usr/bin/strip i386-apple-gcc/i386-apple-darwin/bin/strip 
```

如果我们随后再次尝试构建 GCC，我们会发现构建过程被打乱了，因为我们新构建的汇编器无法以 x86_64 为目标。由于这似乎与您尝试实现的目标无关，您可以将`--disable-multilib`参数添加到 GCC 的配置脚本中以防止它尝试这样做。

在这一点上，我在尝试构建 libgcc 时遇到了错误。这些错误是因为找不到合适的链接器，所以我想现在您也需要[下载](http://opensource.apple.com/tarballs/ld64/ld64-134.9.tar.gz)并构建 ld64。

正是在这一点上，我已经没有时间再进一步了。祝你好运！

# python - python字符串匹配时间复杂度

> ID：15666550
> 
> 赞同：2
> 
> 时间：2013-03-27T18:24:48.413
> 
> 标签：python, string, time, match, complexity-theory

我需要这个问题的帮助。我认为时间复杂度是 O(n)，但我朋友坚持认为这是 O(n^2)。原因之一是因为`fn = fn[index+1 ::]`

```
#filename: string_expression_matcher.cc
#string: stxpm.c
#should return

import sys
string = "string_expression_matcher.cc"
subStr = "stxpm.c"

fn = list(string)
for i in subStr:
    try:
        index = fn.index(i)
        fn = fn[index+1 ::]
    except:
        print ("can't dup")
        sys.exit()

print ("found") 
```

这是我的算法：

1.  subStr 中的 s：
    *   循环开始于：“string_expression_matcher.cc”
    *   此步骤剩余的字符串输出为：“tring_expression_matcher.cc”
2.  subStr 中的 t
    *   循环开始于：“tring_expression_matcher.cc”
    *   剩下的是：“ring_expression_matcher.cc”
3.  x in subStr
    *   循环开始于：“ring_expression_matcher.cc”
    *   剩下的是：“pression_matcher.cc”
4.  p in subStr
    *   循环开始于：“pression_matcher.cc”
    *   剩下的是：“ression_matcher.cc”

等等到最后一步。

鉴于：

```
n = len(subStr)
m = len(string)` 
```

这个程序的时间复杂度是多少？谢谢大家，但我真的很想知道是 O(n) 还是 O(n^2)。我知道代码并不完美，但请关注时间复杂度。非常感谢

有谁知道python字符串复制是如何工作的？当我们执行 fn = fn[index+1 ::] 时会发生什么？

我问了一位杰出的工程师。他说结果是 O(m*n)。你呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:17:02.247

您的算法（就比较次数而言）是`O(n)`，其中`n`是字符串的长度。在最坏的情况下，字符串和模式都将是相同的，然后对于您中的每个字符，`subStr`您将移动到`string`. 它相当于字符串的简单比较。

但是，您的实现可能是`O(n^2)`在其他操作方面，正如您在问题中提到的那样，其原因是以下行：

```
fn = fn[index+1 ::] 
```

这实际上是在复制字符串（假设上面的切片是作为副本实现的）。如果您再次考虑前面的示例，对于字符串中的每个字符，您必须复制所有剩余的字符，即`O(n^2)`. 这是因为您将首先复制`n-1`字符，然后`n-2`是 ，`n-3`依此类推，在最后一次迭代中，您将只复制一个字符。那么要复制的项目总数将是`n-1`+ `n-2`+ `...`+ `1`，作为[等差数](http://en.wikipedia.org/wiki/Arithmetic_progression)列，它等于`(n-1)*((n-1)+1)/2 = (n-1)*n/2 = O(n^2)`。对于其他情况，这可以概括为`O(m*n)`，其中`m`是模式的长度。

你的朋友可能想告诉你的是：你的算法是线性的，但你的实现不是。不过也很容易解决。使用@thkang 提供的解决方案或更透明的方法来消除隐藏的复杂性，例如：

```
try:
  si = iter(string)
  for c in subStr:
    while c != si.next():
      pass
except StopIteration:
  print "no match"
else:
  print "match" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T10:26:25.767

很抱歉，但这既不是 O(n) 也不是 O(n+m)。它们都比 O(n^2) 好，这个算法是 O(n^2)。为什么？

1.  您迭代具有 O(n) 复杂度的源字符串
2.  在每次迭代中，您在字符串上调用“索引”，该字符串也具有 O(n) 复杂度

所以这具有由 O(n^2) 限制的最坏情况性能，实际上是朴素搜索算法的一种实现。如果您想查看 O(n)/O(mn)，我建议您查看[Boyer-Moore 算法](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:32:51.573

如果您不想复制整个列表，请使用`.index`指定的起始索引。

```
last_index = 0
for i in subStr:
    try:
        last_index = fn.index(i, last_index) + 1
    except ValueError:
        print ("can't dup")
        sys.exit()
else:
    #string matches 
```

# ruby-on-rails - 如何使用 STI 从 form_tag 参数进行批量分配

> ID：15666551
> 
> 赞同：0
> 
> 时间：2013-03-27T18:24:54.433
> 
> 标签：ruby-on-rails, ruby, single-table-inheritance, sti

我正在使用 STI 创建一个应用程序，它有一个用户父级和两个子级雇主和求职者。关系已经建立和测试。

我想使用 STI 仅使用 1 个用户控制器将雇主用户和求职者用户存储到 Postgres 中。

我正在使用 form_tag 输入详细信息。我创造了

```
<%= hidden_field_tag :user_type, :jobseeker %>
<%= hidden_field_tag :user_type, :employer %> 
```

因此用户控制器可以识别输入的类型（雇主或求职者）

用户控制器创建动作如下；

```
if params[:user_type] == "employer"
  @employer = Employer.new(params[:employer])
  @employer.save

elsif params[:user_type] == "jobseeker"
  @jobseeker = Jobseeker.new(params[:jobseeker])
  @jobseeker.save

end 
```

当我输入参数时，我可以在调试器中看到所有正确的参数。使用上述方法，我可以创建一个类型为求职者或雇主的记录。

我只是无法将其余数据放入 Db，因为我没有参数“句柄”可供使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:37:44.387

使用字段的嵌套名称将用户属性相关参数与其他参数值分开。在这里，我使用`user`字段名称：

**看法：**

```
<% form_tag .. %>
  <%= text_field_tag 'user[name]' %>      #Assuming you have name attribute
    ...
  <%= hidden_field_tag 'user_type', 'employer' %>
<% end %> 
```

**控制器：**

```
if params[:user_type] == "employer"
  @employer = Employer.new(params[:user])
  @employer.save

elsif params[:user_type] == "jobseeker"
  @jobseeker = Jobseeker.new(params[:user])
  @jobseeker.save
end 
```

# javascript - Jquery stopImediatePropagation 问题

> ID：15666552
> 
> 赞同：0
> 
> 时间：2013-03-27T18:24:54.633
> 
> 标签：javascript, jquery

我有三个事件处理程序，mouseenter、mouseleave 和 click 如果用户单击“li”，我想停止事件传播以便不执行 mouseleave 处理程序这是我的代码：

```
$('.list ul li').mouseenter(function()
    {
        $(this).addClass('listItemSelected');
    });   
    $('.list ul li').mouseleave(function()
    {
        $(this).removeClass('listItemSelected');
    });
    $('.list ul li').click(function(b)
    {
        b.stopImmediatePropagation();   
        $('.list ul').removeClass('listItemSelected');
        $(this).addClass('listItemSelected');
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:27:57.723

更新

```
$('.list ul li').click(function(e)
{
    e.preventDefault();
    $('.list ul').removeClass('listItemSelected');
    // first remove from the rest of the list items then add to clicked
    $('.list ul li').removeClass('listItemClicked');
    $(this).addClass('listItemClicked');
}); 
```

使 listItemSelected 与 listItemClicked 相同

# bash - 如何构建自定义 grep 函数

> ID：15666556
> 
> 赞同：1
> 
> 时间：2013-03-27T18:24:59.023
> 
> 标签：bash, shell

我是 bash 的新手，我正在尝试构建自己的 grep 别名来搜索文件，这是我构建的脚本：

```
function gia() {
  if [ -z "$1" ]; then
    echo "-You need to define what are you looking for-"
  else
    echo "-Looking for \"$1\".-"
    if [ -z $2 ]; then
      echo "-no path passed, searching all files-"
      grep -i --color "$1" ./*
    else
      echo "-Looking in \"$2\".-"
      grep -i --color "$1" $2
    fi
  fi
} 
```

第二个选项效果不佳，如果我尝试一下，我会得到以下输出：

```
$$ gia 'sometext' ./*.html
-Looking for "sometext".-
-Looking in "./login.html".- 
```

我从未指定**login.html**，但它获取了我目录中的一个文件并在其中进行了搜索。并且 grep 失败了。

例如，如果我在**myfiles**目录中有 3 个文件：

**1.html**、**2.txt**和**3.html**

和 3.html 有文本“反引号”

如果我这样搜索：

```
cd myfiles
gia 'backquotes' 
```

我得到结果

```
-Looking for "backquotes".-
-no path passed, searching all files-
./3.html:    <backquotes>...</backquotes> 
```

但是如果我是root用户，然后像这样搜索：

```
gia 'backquotes' ~/myfiles/*.html 
```

我明白了：

```
-Looking for "backquotes".-
-Looking in "./1.html".- 
```

没有结果返回，因为它只在 1.html 中搜索。如果我在 1.html 中有“反引号”。它会回来，但我没有从其他文件中得到任何东西，它只是在第一个文件中搜索并退出。

我知道星号是 bash 中的一个特殊字符，但我该如何解决呢？

提前感谢您的帮助。

EMMNS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:31:26.187

如果您要在函数中使用“通配符”文件名，则必须解析 $@。这是函数的参数列表。我暂时离开了这个解决方案的路径解析。

```
function gia() {
  if [ -z "$1" ]; then
    echo "-You need to define what are you looking for-"
  else
      for f in $@
      do
         grep -i --color "$f" ./*
      done
    fi
  fi
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:22:38.390

`$@`您可以使用`${@:2}`符号拼接从第 2 个开始的所有参数。还要引用，`"${@:2}"`因为您的文件名可以包含空格和任何需要转义的特殊字符。

这应该有效：

```
function gia() {
if [ -z "$1" ]; then
    echo "-You need to define what are you looking for-"
else
    echo "-Looking for \"$1\".-"
    if [ -z $2 ]; then
        echo "-no path passed, searching all files-"
        grep -i --color "$1" ./*
    else
        echo "-Looking in \"${@:2}\".-"
        grep -i --color "$1" "${@:2}"
    fi
fi
} 
```

**输出：**

```
$ gia ABC file*.html
-Looking for "ABC".-
-Looking in "file1.html file 2.html file 3.html file4.html file5.html".-
file 2.html:ABC
file 3.html:ABC
file5.html:ABC 
```

# javascript - 具有 JSON 数据和多个系列的 Highcharts

> ID：15666557
> 
> 赞同：5
> 
> 时间：2013-03-27T18:25:01.400
> 
> 标签：javascript, json, highcharts

我正在尝试渲染 Highcharts 折线图，但是在页面加载时显示系列时遇到了一些问题。Firebug 没有显示任何错误，所以我猜这是我的数据结构或如何传递给 Highcharts 的问题。

数据来自 JSON 文件，使用我从[另一个站点](http://jonathanmanning.com/2012/10/31/highcharts-jquery-graphing-library-example-with-json-data-source/)获得的方法加载变量......我的数据是每个月的数字 y 值，customTooltip 是我想在悬停时显示的附加数据。

```
$.getJSON("json/mydata.txt",function(jdata) {

var arr = [];
$.each(jdata, function(key, val) {
    var y = val.y;
    var name = key;
    var customTooltip = val.n;
    arr.push({y: y, customTooltip: customTooltip})
})

var jseries = {name:arr.name, data:[{ny:arr.customTooltip, y:arr.y}]};

var options = {
            chart: {
                renderTo: 'fallcontainer',
                defaultSeriesType: 'line'
                },
            title: {
                text: 'Monthly Rate',
                style: {
                    margin: '10px 100px 0 0' // center it
                }
                },
            subtitle: {
                text: 'Source',
                style: {
                    margin: '0 100px 0 0' // center it
                }
                },
            xAxis: {

                categories: ['Jan 12', 'Feb 12', 'Mar 12']
                },
            yAxis: {
                title: {
                    text: 'Rate',
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }],
                min:0
                },
            legend: {
                layout: 'vertical',
                align:'right',
                verticalAlign:'middle',
                x:0,
                title:'Care Setting'
                },
            plotOptions: {
                },
            credits: {
                enabled:false
                },
            series:[]
};

options.series.push(jseries);

var chart = new Highcharts.Chart(options);

}); 
```

这是一个更好的例子。我真正想要显示的是 'y' 作为 y 轴，悬停时有 'n' 和 'y' 数据。JSONLint 说这是有效的。

```
{
"Total": {
    "y": [
        9.39,
        90.35,
        90.36,
        92.69,
        93.02,
        90.32,
        90.6,
        9.09,
        9.5,
        90.69,
        9.6,
        90.69,
        9.53,
        6.92
    ],
    "name": "Total",
    "n": [
        962,
        969,
        999,
        233,
        235,
        968,
        999,
        963,
        989,
        293,
        986,
        293,
        989,
        908
    ]
},
"Cat1": {
    "y": [
        6.38,
        6.63,
        90.3,
        9.65,
        90.25,
        8.99,
        92.39,
        99.39,
        9.28,
        99.35,
        99.36,
        93.38,
        8.69,
        8.03
    ],
    "name": "Cat1",
    "n": [
        6,
        6,
        90,
        90,
        90,
        8,
        93,
        93,
        99,
        93,
        93,
        96,
        99,
        9
    ]
}
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T04:13:23.467

你应该看看这个：[http ://api.highcharts.com/highcharts#series.data](http://api.highcharts.com/highcharts#series.data)

如果您将每个点指定为一个对象，您可以向每个点添加您想要的任何属性，并通过 this.point 在您的工具提示格式化程序中访问它。

使用当前格式化的数据

```
var seriesArr = [];
$.each(jdata, function(key, data) {
  var series = {name : key, data : []};

  $.each(data.y, function(index, value) {
    series.data.push({y: value });
  });

  $.each(data.n, function(index, value) {
    series.data[index].n = value;
  });
  seriesArr.push(series);
}); 
```

这应该产生：

```
seriesArr : [{
    name : 'Total',
    data : [
      {y:9.39, n:9.62},
      ...
    ]
  },
...
] 
```

然后在您的格式化程序功能中，您可以访问每个 this.point.y 或 this.point.n

```
tooltip: {
  formatter: function () {
    return 'Y value is : ' + this.point.y + '<br>' + 'N value is : ' + this.point.n;
  }
}, 
```

工作：http: [//jsfiddle.net/sgearhart2/9P5fC/](http://jsfiddle.net/sgearhart2/9P5fC/)

# javascript - 为什么我的处理程序被多次调用？

> ID：15666563
> 
> 赞同：0
> 
> 时间：2013-03-27T18:25:31.730
> 
> 标签：javascript, jquery

当我在日历中放置某些内容并显示一个日程安排对话框时，我会调用它，当我按下该对话框上的按钮时，它会进行 ajax 调用。

我注意到第一次单击它时，会进行 1 次 ajax 调用，下一次按下，2 次 ajax 调用，依此类推。

我只想要 btnSchedule 的 1 个处理程序：

看：

```
 $('#btnSchedule').on('click', function () { 
```

.

```
 drop: function(date, allDay, ev, ui, resource) { // this function is called when something is dropped

                    // retrieve the dropped element's stored Event Object
                    var originalEventObject = $(this).data('eventObject');

                    // we need to copy it, so that multiple events don't have a reference to the same object
                    var event = $.extend({}, originalEventObject);

                    var obj = this;

                    var hours = 1;

                    var id = event.id;
                    var type = event.type;

                   $('#txtFrom').change(function () {
                       $('#txtHours').val('');
                       fillPriorityList("#<%= ddlPriority.ClientID %>",type + id,resource.id,$('#txtFrom').val());
                    });
                    showScheduler(
                        event.title,
                        $.fullCalendar.formatDate(date,'dddd MMMM dd yyyy'),
                        $.fullCalendar.formatDate(date, 'MM/dd/yyyy'),
                        event.canReoccur,event.reoccurVal,"#<%= ddlPeriod.ClientID %>",
                        "#<%= cbPeriod.ClientID %>");

                    fillPriorityList("#<%= ddlPriority.ClientID %>",type + id,resource.id,$('#txtFrom').val());

                    $('#btnSchedule').on('click', function () {
                        var hrs = $('#txtHours').val();
                        var usingHrs = (isNaN(hrs) == false && hrs > 0);
                        var usingRange = isDateRangeValid('#txtFrom','#txtTo');
                        var canRec = event.canReoccur;
                        var periodChecked = $("#<%= cbPeriod.ClientID %>").prop('checked');
                        var recVal = $("#<%= ddlPeriod.ClientID %>").prop('selectedIndex');
                        var priority = $("#<%= ddlPriority.ClientID %>").val();

                        if(usingHrs || usingRange)
                        {
                            var  f = $.datepicker.parseDate('m/d/yy', $('#txtFrom').val());
                            var  t = $.datepicker.parseDate('m/d/yy', $('#txtTo').val());
                            var correctStart = usingHrs ? date : f;
                            $.ajax({
                                type: "POST",
                                url: "CalendarServices.aspx/RegisterEvent",
                                data: 'id=' + id + '&start=' + $.fullCalendar.formatDate(correctStart, 'yyyy-MM-dd')
                                    + '&end=' + $.fullCalendar.formatDate(t, 'yyyy-MM-dd') + '&type=' + type + '&hours=' + hrs + '&resource=' + resource.id
                                 + '&canRec=' +  canRec + '&periodChecked=' + periodChecked + '&recVal=' + recVal + '&priority=' + priority,

                                success: function (data) {
                                    $(obj).remove();
                                    changeUnscheduledHeaders();
                                    closeScheduler();                              
                                    $('#calendar').fullCalendar('refetchEvents');
                                }
   ,
                                error: function () {
                                }
                            });
                        }

                    })

                }

                , 
```

我该怎么做才能让它只调用一次我的ajax？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:27:24.063

在再次绑定之前尝试取消绑定点击处理程序

```
$('#btnSchedule').off('click').on('click'... 
```

如果多次绑定，每次绑定都会执行回调。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T18:27:39.970

使用[event.stopPropagation();](http://api.jquery.com/event.stopPropagation/) 像这样：

```
 $('#btnSchedule').on('click', function () {

    event.stopPropagation();

    [the rest of your code] 
```

# java - 在 jpql 中使用多个 AND

> ID：15666568
> 
> 赞同：1
> 
> 时间：2013-03-27T18:25:51.007
> 
> 标签：java, jpql

我正在使用以下 jpql 进行查询，但它给了我一个错误，我不知道如何在一个语句中使用多个 AND。我添加了我要质疑的例外情况。

1) 查询

```
Query query = em.createQuery(
                "SELECT n FROM Notification n WHERE (n.recipientEmail='"
                        + user.getEmail()
                        + "' AND n.isUnread='"+1+"') AND n.growToshow='" + 1
                        + "' ORDER BY n.createdTime desc", Notification.class); 
```

2) 例外

```
SEVERE: Servlet.service() for servlet [Faces Servlet] in context with path [/FreeBird_New] threw exception [An exception occurred while creating a query in EntityManager: 
Exception Description: Error compiling the query [SELECT n FROM Notification n WHERE (n.recipientEmail='amlan@ymail.com' AND n.isUnread='1') AND n.growToshow='1' ORDER BY n.createdTime desc], line 1, column 97: unknown state or association field [growToshow] of class [com.entity.Notification].] with root cause
Local Exception Stack: 
Exception [EclipseLink-8030] (Eclipse Persistence Services - 2.3.3.v20120629-r11760): org.eclipse.persistence.exceptions.JPQLException
Exception Description: Error compiling the query [SELECT n FROM Notification n WHERE (n.recipientEmail='amlan@ymail.com' AND n.isUnread='1') AND n.growToshow='1' ORDER BY n.createdTime desc], line 1, column 97: unknown state or association field [growToshow] of class [com.entity.Notification].
    at org.eclipse.persistence.exceptions.JPQLException.unknownAttribute(JPQLException.java:457)
    at org.eclipse.persistence.internal.jpa.parsing.DotNode.validate(DotNode.java:87)
    at org.eclipse.persistence.internal.jpa.parsing.Node.validate(Node.java:92)
    at org.eclipse.persistence.internal.jpa.parsing.BinaryOperatorNode.validate(BinaryOperatorNode.java:34)
    at org.eclipse.persistence.internal.jpa.parsing.EqualsNode.validate(EqualsNode.java:41)
    at org.eclipse.persistence.internal.jpa.parsing.Node.validate(Node.java:95)
    at org.eclipse.persistence.internal.jpa.parsing.LogicalOperatorNode.validate(LogicalOperatorNode.java:39)
    at org.eclipse.persistence.internal.jpa.parsing.WhereNode.validate(WhereNode.java:34)
    at org.eclipse.persistence.internal.jpa.parsing.ParseTree.validate(ParseTree.java:207)
    at org.eclipse.persistence.internal.jpa.parsing.ParseTree.validate(ParseTree.java:183)
    at org.eclipse.persistence.internal.jpa.parsing.ParseTree.validate(ParseTree.java:173)
    at org.eclipse.persistence.internal.jpa.parsing.JPQLParseTree.populateReadQueryInternal(JPQLParseTree.java:110)
    at org.eclipse.persistence.internal.jpa.parsing.JPQLParseTree.populateQuery(JPQLParseTree.java:84)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.buildEJBQLDatabaseQuery(EJBQueryImpl.java:219)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.buildEJBQLDatabaseQuery(EJBQueryImpl.java:190)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.<init>(EJBQueryImpl.java:142)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.<init>(EJBQueryImpl.java:126)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.createQuery(EntityManagerImpl.java:1475)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.createQuery(EntityManagerImpl.java:1497)
    at com.bean.NotificationBean.getGrowlNotificationList(NotificationBean.java:73)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at javax.el.BeanELResolver.getValue(BeanELResolver.java:87)
    at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:67)
    at com.sun.faces.el.FacesCompositeELResolver.getValue(FacesCompositeELResolver.java:71)
    at org.apache.el.parser.AstValue.getValue(AstValue.java:169)
    at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:106)
    at com.sun.faces.facelets.tag.jstl.core.ForEachHandler.apply(ForEachHandler.java:158)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:131)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:162)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:114)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:94)
    at com.sun.faces.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:89)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:94)
    at com.sun.faces.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:79)
    at com.sun.faces.facelets.impl.DefaultFacelet.apply(DefaultFacelet.java:148)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.buildView(FaceletViewHandlingStrategy.java:734)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:96)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:97)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:135)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:309)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:46:13.847

您的问题似乎是您的课程中没有`growToshow`属性`Notification`，但我还有另一个建议：

不要**使用**串联来设置参数。

JPA 为您提供了一种更安全的方法来定义参数，我将以您的查询为例：

```
StringBuilder jpql = new StringBuilder()
jpql.append(" SELECT n FROM Notification n ");
jpql.append("   WHERE n.recipientEmail = :recipientEmail ");
jpql.append("   AND n.isUnread = :isUnread ");
jpql.append("   AND n.growToshow = :growToshow ");
jpql.append(" ORDER BY n.createdTime DESC ");

TypedQuery<Notification> query = em.createQuery(jpql.toString(), Notification.class);

query.setParameter("recipientEmail", user.getEmail());
query.setParameter("isUnread", 1);
query.setParameter("growToshow", 1); 
```

看？只需使用命名参数，您的查询看起来更具可读性，并且可以避免 SQL 注入等问题。

# actionscript-3 - 在数组中查找 XML 节点的值

> ID：15666570
> 
> 赞同：1
> 
> 时间：2013-03-27T18:25:52.580
> 
> 标签：actionscript-3, apache-flex, e4x

为什么@assigned 总是0？

```
var gates:XML = <gates>
    <gate_id>
      10991
    </gate_id>
    <gate_id>
      10999
    </gate_id>
    <gate_id>
      11000
    </gate_id>
    <gate_id>
      11001
    </gate_id>
  </gates>;

var assignedGateIds:Array = ["10991","10999"];

for each(var xgate:XML in gates..gate_id){
    var gateId:String = xgate.text();

    if(assignedGateIds.indexOf(xgate.text())>-1){
        xgate.@assigned = 1;
    }else{
        xgate.@assigned = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:33:10.217

改变

```
 if(assignedGateIds.indexOf(xgate.text())>-1){ 
```

至

```
 if(assignedGateIds.indexOf(gateId)>-1){ 
```

或者

```
 if(assignedGateIds.indexOf(String(xgate.text()))>-1){ 
```

或者

```
 if(assignedGateIds.indexOf(xgate.text().toString())>-1){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:04:15.820

很简单，因为 text() 函数返回的不是字符串而是对象。当您使用跟踪时，它会转换为字符串，但如果您检查一下，`trace(getQualifiedSuperclassName(xgate.text()));`您会看到它返回一个对象。

为了解决这个问题，我通常使用 `trace(getQualifiedSuperclassName(xgate.text()+''));`并将其强制为字符串，您也可以使用`as String`

```
var gates:XML = <gates>
    <gate_id>
      10991
    </gate_id>
    <gate_id>
      10999
    </gate_id>
    <gate_id>
      11000
    </gate_id>
    <gate_id>
      11001
    </gate_id>
  </gates>;

var assignedGateIds:Array = ["10991","10999"];

for each(var xgate:XML in gates..gate_id){
    var gateId:String = xgate.text();

    if(assignedGateIds.indexOf(xgate.text()+"")>-1){ // <- added +'' here
        xgate.@assigned = 1;
    }else{
        xgate.@assigned = 0;
    }
} 
```

# c# - 使用 EF 查询数据不会返回所有实体

> ID：15666571
> 
> 赞同：1
> 
> 时间：2013-03-27T18:26:00.010
> 
> 标签：c#, windows, entity-framework, wcf-data-services

我目前正在将项目从 LINQ 更改为 SQL 到 LINQ 到 Entity。我有以下实体：

```
Customer -> Address 
```

我使用这种方法通过 WCF 数据服务异步查询我的数据库：

```
public static async Task<IEnumerable<TResult>> ExecuteAsync<TResult>(this DataServiceQuery<TResult> query)
{
    var queryTask = Task.Factory.FromAsync<IEnumerable<TResult>>(query.BeginExecute(null, null), (asResult) =>
    {
        var result = query.EndExecute(asResult);
        return result;
    });

    return await queryTask;
} 
```

如果我对此实体进行查询，我可以访问客户，但地址仍然为空：

```
var query = (DataServiceQuery<Customer>)client.Customer.OrderBy(session => session.LastName);
var data = await query.ExecuteAsync();
Test2.Text = data.LastName(); //returns the lastname
Test2.Text = data.First().Address.Stret; //Address is Null 
```

我检查了数据库并且外键设置正确。为什么地址为空？我必须以其他方式查询吗？在 LINQ to SQL 中可以访问相关实体，如何在 LINQ to Entity 中存档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:33:20.010

这完全取决于您的型号。有三种方法：显式加载、急切加载和延迟加载。对于急切加载，您必须使用`Include`. 或者您想通过`Virtual`在属性旁边指定关键字并`LazyLoadingEnabled = true`为您的`DataContext`. 在此处查看有关加载相关实体的更多信息：http: [//msdn.microsoft.com/en-us/data/jj574232.aspx](http://msdn.microsoft.com/en-us/data/jj574232.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T19:02:30.273

[nkvu - 移动作为原始海报所示的答案。还强烈推荐@RAS 对这个问题的回答，以解释不同的加载策略。]

在构建查询以加载相关实体时，也许尝试对 Address 使用 [Expand]( [http://msdn.microsoft.com/en-us/library/ee358709.aspx ) 调用。](http://msdn.microsoft.com/en-us/library/ee358709.aspx)

# servlets - 将无状态 EJB 注入 Servlet

> ID：15666572
> 
> 赞同：5
> 
> 时间：2013-03-27T18:26:01.640
> 
> 标签：servlets, ejb, cdi, inject

我正在尝试将无状态 EJB 注入 servlet。但它不起作用。我理解错了吗？如果我在一个带`@WebService`注释的类中这样做，我可以毫无问题地使用注入的 EJB。

我的 EJB：

```
@Stateless
public class doSomethingService
{
  public void doSomething()
  {
    System.out.println("DO SOMETHING");
  }
} 
```

我的小服务程序：

```
@WebServlet("/testservlet")
public class test_servlet extends HttpServlet
{
  private static final long serialVersionUID = 1L;

  @Inject
  private doSomethingService injBean;

  public test_servlet() 
  {
    super();
    injBean.doSomething(); 
  } 
```

这会导致`NullPointerException`. 我尝试进行 JNDI-Lookup 并且效果很好。`@Inject`这是在 Servlet 中不起作用的事实吗？

我正在使用 Glassfish 3.1.2.2

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T18:31:54.850

您正在尝试在构造函数中访问它。注入的依赖项在构造函数中不可用。如果尚未构造实例，则无法设置实例变量。你基本上期望它像这样工作：

```
test_servlet servlet;
servlet.injBean = new doSomethingService();
servlet = new test_servlet(); 
```

显然不是这样。`init()`您可以通过servlet的方法最早访问它。它也仅在`doXxx()`servlet 的任何方法中可用。

开始，更换

```
public test_servlet() {
    super();
    injBean.doSomething(); 
} 
```

经过

```
@Override
public void init() {
    injBean.doSomething(); 
} 
```

* * *

**与具体问题无关**，我强烈建议您使用[Java 命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)。小写和下划线的类名不符合标准的 Java 命名约定，这会减慢经验丰富的 Java 开发人员对代码的解释。

# javascript - Knockout JS 级联状态/城市下拉列表（使用 JSON）

> ID：15666574
> 
> 赞同：1
> 
> 时间：2013-03-27T18:26:05.623
> 
> 标签：javascript, jquery, ajax, json, knockout.js

我有两个领域，州和城市。当用户选择他们的状态时，我正在向正在返回的服务器发送调用：

```
[{"id":"4488","rc_abbr":"BILLINGS"},{"id":"4489","rc_abbr":"MISSOULA"},{"id":"4490","rc_abbr":"GREATFALLS"},{"id":"4491","rc_abbr":"HELENA"},{"id":"4492","rc_abbr":"BOZEMAN"},{"id":"4493","rc_abbr":"BUTTE"},{"id":"4494","rc_abbr":"HAMILTON"},{"id":"4495","rc_abbr":"BELGRADE"},{"id":"4496","rc_abbr":"LIVINGSTON"},{"id":"4497","rc_abbr":"LAUREL"},{"id":"4498","rc_abbr":"MILES CITY"},{"id":"4499","rc_abbr":"STEVENSVL"},{"id":"4500","rc_abbr":"LEWISTOWN"},{"id":"4501","rc_abbr":"ANACONDA"},{"id":"4502","rc_abbr":"DILLON"},{"id":"4503","rc_abbr":"HARDIN"},{"id":"4504","rc_abbr":"GLENDIVE"},{"id":"4505","rc_abbr":"DEER LODGE"},{"id":"4506","rc_abbr":"SIDNEY"},{"id":"4507","rc_abbr":"CUT BANK"},{"id":"4508","rc_abbr":"MANHATTAN"},{"id":"4509","rc_abbr":"RED LODGE"},{"id":"4510","rc_abbr":"FRENCHTOWN"},{"id":"4511","rc_abbr":"THREEFORKS"},{"id":"4512","rc_abbr":"COLUMBUS"},{"id":"4513","rc_abbr":"CONRAD"},{"id":"4514","rc_abbr":"SHELBY"},{"id":"4515","rc_abbr":"COLSTRIP"},{"id":"4516","rc_abbr":"WYELLOWSTN"},{"id":"4517","rc_abbr":"FORSYTH"},{"id":"4518","rc_abbr":"GALATNGTWY"},{"id":"4519","rc_abbr":"JOLIET"},{"id":"4520","rc_abbr":"GARDINER"},{"id":"4521","rc_abbr":"CLYDE PARK"},{"id":"4522","rc_abbr":"FROMBERG"},{"id":"4523","rc_abbr":"FAIRVIEW"},{"id":"4524","rc_abbr":"BRIDGER"},{"id":"4525","rc_abbr":"WIBAUX"},{"id":"4526","rc_abbr":"TERRY"},{"id":"4527","rc_abbr":"WILSALL"},{"id":"4528","rc_abbr":"WOLF CREEK"},{"id":"4529","rc_abbr":"COOKE CITY"},{"id":"4530","rc_abbr":"SILVERTIP"},{"id":"4531","rc_abbr":"NO PARKMAN"}] 
```

在淘汰赛中，我需要使用此数据更新城市字段。我的问题与我获取 ajax 数据成功响应并将其放入的方式有关，我不确定语法是否正确。

这是小提琴：http: [//jsfiddle.net/VJbVs/](http://jsfiddle.net/VJbVs/)

HTML

```
<select data-bind="value: selectedState">
<option value="AL">Alabama</option>
<option value="AK">Alaska</option>
<option value="AZ">Arizona</option>
<option value="AR">Arkansas</option>
<option value="CA">California</option>
<option value="CO">Colorado</option>
<option value="CT">Connecticut</option>
<option value="DE">Delaware</option>
<option value="DC">District of Columbia</option>
<option value="FL">Florida</option>
<option value="GA">Georgia</option>
<option value="HI">Hawaii</option>
<option value="ID">Idaho</option>
<option value="IL">Illinois</option>
<option value="IN">Indiana</option>
<option value="IA">Iowa</option>
<option value="KS">Kansas</option>
<option value="KY">Kentucky</option>
<option value="LA">Louisiana</option>
<option value="ME">Maine</option>
<option value="MD">Maryland</option>
<option value="MA">Massachusetts</option>
<option value="MI">Michigan</option>
<option value="MN">Minnesota</option>
<option value="MS">Mississippi</option>
<option value="MO">Missouri</option>
<option value="MT">Montana</option>
<option value="NE">Nebraska</option>
<option value="NV">Nevada</option>
<option value="NH">New Hampshire</option>
<option value="NJ">New Jersey</option>
<option value="NM">New Mexico</option>
<option value="NY">New York</option>
<option value="NC">North Carolina</option>
<option value="ND">North Dakota</option>
<option value="OH">Ohio</option>
<option value="OK">Oklahoma</option>
<option value="OR">Oregon</option>
<option value="PA">Pennsylvania</option>
<option value="RI">Rhode Island</option>
<option value="SC">South Carolina</option>
<option value="SD">South Dakota</option>
<option value="TN">Tennessee</option>
<option value="TX">Texas</option>
<option value="UT">Utah</option>
<option value="VT">Vermont</option>
<option value="VA">Virginia</option>
<option value="WA">Washington</option>
<option value="WV">West Virginia</option>
<option value="WI">Wisconsin</option>
<option value="WY">Wyoming</option>
</select>
<select data-bind="options: cities, optionsText: 'Name', optionsValue: 'ID', value: selectedCity"></select> 
```

脚本

```
(function () {

    var ViewModel = function () {

        this.selectedState = ko.observable();
        this.selectedState.states = [];

        this.selectedCity = ko.observable();

        this.selectedState.subscribe(function () {
            this.selectedCity(undefined);
        }, this);

        var getById = function (items, id) {
            return ko.utils.arrayFirst(items, function (item) {
                $.ajax({
                    url: 'activate/get/coverage',
                    type: 'POST',
                    beforeSend: function(){},
                    data: ko.toJSON({state: item.ID}),
                    contentType: 'application/json',
                    complete: function(data){}, 
                    success: function (result) {this.selectedState.states = result;}
                });
                return item.ID == id;
            });
        };

        this.cities = ko.computed(function () {
            var state = getById(this.selectedState.states, this.selectedState());
            return state ? ko.utils.arrayMap(state.States, function (item) {
                return {
                    id: item.ID,
                    rc_abbr: item.Name
                };
            }) : [];
        }, this);

    };

    var model = new ViewModel();
    ko.applyBindings(model, document.getElementById('didScreen'));

})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T22:50:05.147

我将其发布为答案，我们花了很多时间[聊天](https://chat.stackoverflow.com/rooms/27045/room-for-tyrsius-and-stephen-harman)（不知道其他人是否可以打开该链接）。

的HTML：

```
<div data-bind="foreach: items">
    <select data-bind="options: $parent.states, optionsText: 'name', value: state"></select>
    <select data-bind="options: cities, optionsText: 'name', value: city"></select>
    <button data-bind="click: $parent.remove">Remove</button>
</div>
<button data-bind="click: newItem">Add Item</button> 
```

JS：

```
var Item = function() {
    var self = this;
    self.state = ko.observable();
    self.city = ko.observable();
    self.cities = ko.observableArray([]);
    self.state.subscribe(function(state) {
        self.city("");
        self.cities.removeAll();
        $.ajax({
            url: '/echo/json/',
            type: 'POST',
            data: {
                json: ko.toJSON([
                    { id: 1, name: "Billings"},
                    { id: 2, name: "Sweego"},
                    { id: 3, name: "NorthFall"}
                ]),
                delay: 2
            },
            success: function(response) {
                self.cities(response);
            }
        });
    });
};

var ViewModel = function(states) {
    var self = this;
    self.states = states;
    self.items = ko.observableArray([new Item()]);
    self.newItem = function() {
        self.items.push(new Item());
    };
    self.remove = function(item) {
        self.items.remove(item);
    };
}; 
```

这是[最后的小提琴](http://jsfiddle.net/tyrsius/qCEvH/2/)

# r - 安装 DescribeDisplay R 包

> ID：15666576
> 
> 赞同：0
> 
> 时间：2013-03-27T18:26:21.157
> 
> 标签：r

多次尝试安装 rggobi R 包，但由于 DescribeDisplay 包而总是失败。

如前所述，以下命令用于安装 DescribeDisplay

```
install.packages("DescribeDisplay", dep=T)

package 'DescribeDisplay' is not available (for R version 2.15.2) 
```

还使用了 chooseCRANmirror() 来选择不同的镜像，但这也失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:58:33.303

看着[CRAN](http://cran.r-project.org/web/packages/DescribeDisplay/index.html)，我发现

> 软件包“DescribeDisplay”已从 CRAN 存储库中删除。
> 
> 以前可用的版本可以从存档中获得。
> 
> 这个包已经存档：它在 ggplot2 更新后检查了警告。即使在提醒之后，这些警告也没有修复。

这解释了为什么您无法以您尝试的方式安装软件包。您可以下载存档版本并从下载的本地 zip 文件安装包。

# mobile - 仅在流体视网膜标签上使用宽度是否安全

> ID：15666578
> 
> 赞同：1
> 
> 时间：2013-03-27T18:26:23.083
> 
> 标签：mobile, responsive-design, fluid-layout

让`<img>`标签在 Retina 显示器上良好显示的标准解决方案是将图像尺寸加倍，并将原件`width=`和`height=`属性放在标签上以将其压缩到合适的尺寸。

我正在研究一种流畅的布局，我`img { min-width: xx%; }`在媒体查询中有各种风格。问题是当我有`height=`属性`<img>`但`max-width`有效时，图像纵横比变得扭曲，因为高度仍然受到尊重。

高分辨率视网膜解决方案是否有任何理由仅适用于一个`width=`属性？

这样会自动计算 img 高度。它似乎有效，但我无法找到有关仅使用`width`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T22:09:59.410

你有没有尝试过

```
img { 
min-width: xx%; 
height: auto;
} 
```

在你的 CSS 中？

# .net - 与外围设备交互

> ID：15666582
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:26:30.020
> 
> 标签：.net, device

我正在使用**.net** 如何使用连接到 PC 的任何设备开始**学习编程？**您能否建议使用**关键字**来获取有关此的教程和电子书，因为我不知道如何开始？

编辑：让我很困扰的是，当我看到任何关于 elance 的提案谈论这个时，我忽略了它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:34:03.090

除非该设备具有编程所需的软件（大多数都没有），否则您无法开始使用任何设备（甚至连接到 PC）进行编程。只有很少见的设备具有兼容的编程软件它。）。您主要使用 Android 等其他设备测试编程。您可以在多种设备上测试应用程序，从手机和平板电脑到虚拟机再到 PC。要为任何设备编写代码，您必须使用设备操作系统支持的语言编写代码。

# java - 图的两个节点之间需要一条边

> ID：15666585
> 
> 赞同：0
> 
> 时间：2013-03-27T18:26:40.080
> 
> 标签：java, graph

当我想在两个节点之间添加一条边以通过或失败时，我可以很容易地做到这一点，但是验证存在问题，如果我们再次在相同的两个节点之间创建一条边，我不想要。我只需要私有类 ConnectAction 在相同的两个节点之间创建一条边。我在那里尝试了一些东西，但它不起作用。如果我们删除迭代器并只创建它被创建的边缘。

这是节点类

```
private static class Node { 
    private Point p;
    private int r;
    private String NAME;
    private String nodeid;
    private boolean selected = false;
    private Rectangle b = new Rectangle();

    /**
     * Construct a new node.
     */
    public Node(String nodeid,Point p, int r,String NAME) {
        this.nodeid=nodeid;
        this.p = p;
        this.r = r;
        this.NAME = NAME;

        setBoundary(b);

    }

    /**
     * Calculate this node's rectangular boundary.
     */
    private void setBoundary(Rectangle b) {
        b.setBounds(p.x - r, p.y - r, 2 * r, 2 * r);
    }

    /**
     * Draw this node.
     */
    public void draw(Graphics g) {
        g.setColor(Color.white);

                g.fillRect(b.x, b.y, b.width, b.height);
                g.setColor(Color.black);
                g.drawString(NAME,b.x+25,b.y+40);

        if (selected) {
            g.setColor(Color.darkGray);
            g.drawRect(b.x+3, b.y+3, b.width, b.height);
        }
    }

    /**
     * Return this node's location.
     */
    public Point getLocation() {
        return p;
    }

    /**
     * Return true if this node contains p.
     */
    public boolean contains(Point p) {
        return b.contains(p);
    }

    /**
     * Return true if this node is selected.
     */
    public boolean isSelected() {

        return (selected);

    }

    /**
     * Mark this node as selected.
     */
    public void setSelected(boolean selected) {
        this.selected = selected;
    }

    /**
     * Collected all the selected nodes in list.
     */
    public static void getSelected(List<Node> list, List<Node> selected) {
        selected.clear();
        for (Node n : list) {
            if (n.isSelected()) {
                selected.add(n);
            }
        }
    }

    /**
     * Select no nodes.
     */
    public static void selectNone(List<Node> list) {
        for (Node n : list) {
            n.setSelected(false);
        }
    }

    /**
     * Select a single node; return true if not already selected.
     */
    public static boolean selectOne(List<Node> list, Point p) {
        for (Node n : list) {
            if (n.contains(p)) {
                if (!n.isSelected()) {
                    Node.selectNone(list);
                    n.setSelected(true);
                }
                return true;
            }
        }
        return false;
    }

    /**
     * Select each node in r.
     */
    public static void selectRect(List<Node> list, Rectangle r) {
        for (Node n : list) {
            n.setSelected(r.contains(n.p));

        }
    }

    /**
     * Toggle selected state of each node containing p.
     */
    public static void selectToggle(List<Node> list, Point p) {
        for (Node n : list) {
            if (n.contains(p)) {
                n.setSelected(!n.isSelected());
            }
        }
    }

    /**
     * Update each node's position by d (delta).
     */
    public static void updatePosition(List<Node> list, Point d) {
        for (Node n : list) {
            if (n.isSelected()) {
                n.p.x += d.x;
                n.p.y += d.y;
                n.setBoundary(n.b);

            }
        }
    }

} 
```

这是边缘类

```
private static class Edge{

    private Node n1;
    private Node n2;
    private String Ctype;
    private String eid;

    private static String edgeid;

    public Edge(String eid,Node n1, Node n2, String Ctype) {
        this.eid = eid;
        this.n1 = n1;
        this.n2 = n2;
        this.Ctype=Ctype;

    }

    public void draw(Graphics g) {
        Point p1 = n1.getLocation();
        Point p2 = n2.getLocation();
        g.setColor(Color.darkGray);
        g.drawLine(p1.x, p1.y, p2.x, p2.y);
        g.drawString(Ctype,(p1.x+p2.x)/2,(p1.y+p2.y)/2);
    }        
} 
```

并且在这里面临的问题是在同一对节点之间仅创建一条边。

```
private class ConnectAction extends AbstractAction {
    String ConnectionType;

    public ConnectAction(String name) {
        super(name);
        this.ConnectionType=name;
    }

    public void actionPerformed(ActionEvent e) {
        Node.getSelected(nodes, selected);
        if (selected.size() > 1) {
            for (int i = 0; i < 1; ++i) {
                Node n3 = selected.get(i);
                Node n4 = selected.get(i + 1);
               String a= n3.nodeid;
               String b= n4.nodeid;
              // System.out.println(a);
               //System.out.println(b);

               //System.out.println(Edgeid);

               ListIterator<Edge> iter = edges.listIterator();
               while (iter.hasNext()) {
                   Edge e1 = iter.next();
                   if (!(n3.nodeid == e1.n1.nodeid && n4.nodeid == e1.n2.nodeid) || (n4.nodeid == e1.n1.nodeid && n3.nodeid == e1.n2.nodeid)) {
                       String Edgeid=ID.giveid();
                       Edge ed=new Edge(Edgeid,n3, n4,ConnectionType);
                       edges.add(ed);

                   } iter.remove();

               }                                                                                                                                                                                                                                                                         
            }                                                             
        }     
        repaint();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:54:44.240

也许我误解了你想要的（或你的代码）但是这个

```
ListIterator<Edge> iter = edges.listIterator();
while (iter.hasNext()) {
    Edge e1 = iter.next();
    if (!(n3.nodeid == e1.n1.nodeid && n4.nodeid == e1.n2.nodeid) || (n4.nodeid == e1.n1.nodeid && n3.nodeid == e1.n2.nodeid)) {
        String Edgeid=ID.giveid();
        Edge ed=new Edge(Edgeid,n3, n4,ConnectionType);
        edges.add(ed);
    }
    iter.remove();
} 
```

创建并删除许多边缘。（并且您的条件有误（ ! 仅适用于第一部分）

我认为你应该有这样的东西：

```
boolean exists = false;
ListIterator<Edge> iter = edges.listIterator();

while (iter.hasNext()) {
    Edge e1 = iter.next();
    if ( (n3.nodeid.equals(e1.n1.nodeid) && n4.nodeid.equals(e1.n2.nodeid)) || (n4.nodeid.equals(e1.n1.nodeid) && n3.nodeid.equals(e1.n2.nodeid)) ) {
        exists = true;

    }
} 

if ( !exists )  {
    String Edgeid=ID.giveid();
    Edge ed=new Edge(Edgeid,n3, n4,ConnectionType);
    edges.add(ed);
} 
```

此外，您通常应该使用 String.equals(String) 来比较字符串。

# ruby-on-rails - 使用 Devise、Backbone.js 和 Marionette.js 进行用户身份验证

> ID：15666587
> 
> 赞同：2
> 
> 时间：2013-03-27T18:26:42.147
> 
> 标签：ruby-on-rails, backbone.js, marionette

我在 Rails 3.2 中使用 token_authenticable 使用了一个非常标准的设计身份验证设置。它工作得很好，但我决定使用backbone.js 和marionette.js 重新编写我的应用程序，以获得更丰富的客户端javascript 环境。

我想我的主要问题是如何在主干视图中通过客户端 javascript 访问当前用户令牌？

我已经阅读了这篇文章：[如何在 Rails、Devise 和 Backbone.js 中使用令牌身份验证？](https://stackoverflow.com/questions/7785079/how-use-token-authentication-with-rails-devise-and-backbone-js)但我真的不明白批准的答案。

# security - 让我的处理程序绕过某些 API 方法的安全性是否存在任何重大漏洞？

> ID：15666589
> 
> 赞同：1
> 
> 时间：2013-03-27T18:26:53.253
> 
> 标签：security, asp.net-web-api

我有一个 Web API 服务，其中包含所有需要安全性的方法，这些方法通过 CustomAuthenticationHandler 处理程序中实现的逻辑使用以下内容进行处理：

```
protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
{
    //Security Logic

    //Return Task
} 
```

*但是，我有一种不需要*安全性的公开方法。我试图阻止仅针对这种不需要任何安全信息的方法提供单独的服务。以下是我如何做到这一点，*它的工作原理*：

```
protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
{

  if (request.RequestUri.AbsolutePath == "/api/MyPublicNoSecurityNeededMethod")
       return base.SendAsync(request, cancellationToken).ContinueWith(task => task.Result);

    //Security Logic

    //Return Task
} 
```

因此，我基本上早早返回，并且从不通过安全逻辑。我想知道这种方法是否有任何问题，或者是否有更安全的方法来处理这种需求？如果答案是 URL 可以被欺骗，那么这种查看请求的方法可能会打开一个后门，等等。这就是我想要确定的。如果我实现此方法的方式不是解决此需求的正确方法，我只是不想将我的其他方法暴露给漏洞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:04:09.980

你使用的 HttpMessageHandler 是不正确的。如果 Web Api 托管在 ASP.NET 中，则处理程序应仅对客户端进行身份验证并在 Thread.CurrentPrincipal 和可选的 HttpContext.Current.User 中设置当前主体。然后，框架提供可用于定义操作授权规则的属性，例如 [AuthorizeAttribute] 和 [AllowAnonymous] 属性。这些属性依赖于 Current Principal 来执行授权。

```
public class HelloWorldController : ApiController
    {
        [Authorize]
        public string Get()
        {
            return "hello " + User.Identity.Name;
        }
    }

    public class HelloWorldAnonymousController : ApiController
    {
        [AllowAnonymous]
        public string Get()
        {
            return "hello anonymous";
        }
    } 
```

Authorize 指定该操作需要经过身份验证的用户。AllowAnonymous 不需要任何经过身份验证的用户。关于您的问题，不需要身份验证的操作没有错。

# java - 当字符串包含破折号时打开枚举

> ID：15666593
> 
> 赞同：4
> 
> 时间：2013-03-27T18:26:57.953
> 
> 标签：java, enums, switch-statement

我想使用枚举作为切换字符串的一种方式，但是 java 抱怨我的字符串包含“-”。如下代码所示，IC19-01 和 IC19-02 包含“-”。

```
public class CMain {
    public enum Model {
        IC19-01, IC19-02
    }

    public static void main(String[] args){
        String st = "IC19-01"; 
        switch (Model.valueOf(st)) {
            case IC19-01: 
                System.out.println("Case IC19-01");
                break;
        }
    }
} 
```

我能为此做些什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:30:14.533

这在 Java 中是不可能的，因为每个项目都必须是一个有效的标识符（并且有效的 Java 标识符可能不包含破折号）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T18:42:34.527

这在 Java 中是不可能的。但是你可以做你自己的实现作为一种解决方法，尽管它会产生更多的代码。您可以更改`enum`如下：

```
 public enum Model {
    IC19_01("IC19-01"), 
    IC19_02("IC19-02")

    private final String name;

    private Model(String name){
     this.name = name;
    }

    public String getName(){
       return name;
    }

   public static Model getByName(String aName){
         for(Model current: Model.values()){
           if(current.getName().equalsIgnoreCase(aName.trim())){
              return current;
           }
          }
          return null;
    }
} 
```

然后你应该可以打电话`Model.getByName(st)`而不是`Model.valueOf`. 或者，在 Java 7 中，您应该能够切换实际的`String`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:30:05.560

> 块引用

枚举是类，应该遵循类的约定。枚举的实例是常量，应该遵循常量的约定。

> 块引用

可以在以下链接中找到有关此的详细信息

[编码约定 - 命名枚举](https://stackoverflow.com/questions/3069743/coding-conventions-naming-enums) 希望它有所帮助

# java - Java：如何检查给定 X509TrustManager 的证书吊销？

> ID：15666597
> 
> 赞同：2
> 
> 时间：2013-03-27T18:27:07.490
> 
> 标签：java, cryptography

给定一个候选证书链和一个包含受信任证书的 X509TrustManager，我如何检查证书是否被吊销？Java API 是否可用于提取和下载 CA 证书中的 CRL（如果存在）？

# python - Komodo Edit 禁用自动补全

> ID：15666599
> 
> 赞同：7
> 
> 时间：2013-03-27T18:27:22.163
> 
> 标签：python, autocomplete, komodo

我正在使用 Komodo Edit 8，它的自动完成功能非常烦人。只要我输入**"for i"**，它就会自动填充：

```
for i in range:
  code 
```

现在我必须手动删除它才能继续输入。我试图从“**编辑”>“偏好”>“代码智能**”中关闭**“键入时启用自动自动完成和调用提示触发”** ，但问题仍然存在。

 **关闭它的真正方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T18:42:20.167

尝试这个：

> 编辑 > 首选项 > 智能编辑 > 自动缩写 >**取消选中**“启用带有触发字符的自动缩写”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T16:24:58.317

选项“在您键入时启用自动自动完成和调用提示触发”是指弹出的工具提示，例如在调用模块中的函数时。键入“math.sq”，它将为 sqrt 函数建议其余的文本。

要关闭自动完成，您指的是取消选中“编辑”>“首选项”>“智能编辑”>“自动缩写”下的“使用触发字符启用自动缩写”。

有关概述，请参阅[https://www.youtube.com/watch?feature=player_detailpage&v=FLbFCkNHLI4 。](https://www.youtube.com/watch?feature=player_detailpage&v=FLbFCkNHLI4)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-17T12:07:42.643

在 Mac 上它位于 Preference -> Editor -> Smart Editing -> Auto-Abbreviations**

# java - 排序数组字符串 java ie input="aab cde abc aaa" output="aaa aab abc cde"

> ID：15666604
> 
> 赞同：0
> 
> 时间：2013-03-27T18:27:32.037
> 
> 标签：java, string

这没有给出预期的输出，我的核心逻辑是否有任何问题，任何帮助都会对我有用。

```
 public static String sortedWord(String s){

        String[] words = s.split("\\s+");
        int length = words.length;
        String temp="";

        for(int i=0;i<length;i++){
          for(int j=1;j<length-i;j++){
                if(words[j-1].compareTo(words[j])>0)
                       temp = words[j-1];
                       words[j-1] = words[j];
                       words[j] = temp;

            }

        }

            StringBuilder sb = new StringBuilder();
            for(int k=0;k<length;k++)
            sb.append(words[k]);

             return   sb.toString();
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:45:15.297

您忘记了 if 块周围的大括号。

您还需要为最后一个“for”循环加上大括号，并在附加单词后附加一个空格。即使只有一行，也总是添加大括号是一种很好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:31:06.270

看看这个[例子](http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/)。我个人会做一个列表并使用比较器。

# javascript - JavaScript 多重测试

> ID：15666607
> 
> 赞同：0
> 
> 时间：2013-03-27T18:27:36.883
> 
> 标签：javascript, html

我有一个带有 12 组 11 个输入组合框的 HTMl Web 表单。

每个组中第一个组合框中的第一个/默认选项是“NO”。

用户可以选择“是”。

我想在每个组中的第一个组合框上运行初始测试，如果返回值为 YES (true)，那么我想在剩余的 10 个输入框上运行进一步测试，如果测试为 false（默认值为 " NO" 然后跳过这组并测试下一组中的第一个盒子。

我失败了，我确定答案很简单，但我就是想不出来。

请有人可以帮我解决这个问题。

```
if (UserRoomSelection_Room_01 == "YES") {

if (userFirstDayOfBooking_Room_01 == "0") {
alert("Please Select First Day Of Booking!");
    return false;
}
if (userFirstDateOfBooking_Room_01 == "0") {
alert("Please Select First Date Of Booking!");
    return false;
}
if (userFirstMonthOfBooking_Room_01 == "0") {
alert("Please Select First Month Of Booking!");
    return false;
}
if (userFirstYearOfBooking_Room_01 == "0") {
alert("Please Select First Year Of Booking!");
    return false;
}
if (userLastDayOfBooking_Room_01 == "0") {
alert("Please Select Last Day Of Booking!");
    return false;
}
if (userLastDateOfBooking_Room_01 == "0") {
alert("Please Select Last Date Of Booking!");
    return false;
}
if (userLastMonthOfBooking == "0") {
alert("Please Select Last Month Of Booking!");
    return false;
}
if (userLastYearOfBooking_Room_01 == "0") {
alert("Please Select Last Year Of Booking!");
    return false;
}       
if (userBoard_Room_01 == "0") {
alert("Please Select Boarding!");
    return false;
}
if (!userRate_Room_01) {
alert("Please Enter The Rate For This Booking!");
    return false;
       }
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:49:15.253

返回假；在您的代码中中断任何进一步的执行。您可以使用 Iesus Sonesson 提供的标记解决方案，但这不是最佳做法。

您已经描述了算法，应该使用循环来实现。例如，您可以将文本消息和组合存储在数组中，然后对其进行迭代。

```
for (var i in combos) {
    if(combos[i]['0'] == 'YES')
    {
        //iterate other combos
    } else {
        // go to next combo group
        break;     
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:16:13.190

也许是这样的？确保将其包装在一个函数中并使用`return YourFunctionXXY();`

```
var ErrorMessage;
var AllOk=true;
    if (UserRoomSelection_Room_01 == "YES") {

        if (userFirstDayOfBooking_Room_01 == "0") {
        ErrorMessage+="Please Select First Day Of Booking!\n";
           AllOk=false;
        }
        if (userFirstDateOfBooking_Room_01 == "0") {
        ErrorMessage+="Please Select First Date Of Booking!\n";
           AllOk=false;
        }
        ........
    }
   if(UserRoomSelection_Room_02 == "YES"){
        .................... 
   }

        if(ErrorMessage!=""){
         alert(ErrorMessage);
          return false;
        }else{
          return true;
        } 
```

# c# - Web 服务接口错误的委托

> ID：15666608
> 
> 赞同：2
> 
> 时间：2013-03-27T18:27:36.800
> 
> 标签：c#, web-services, interface, delegates, transparentproxy

我正在尝试使用委托调用在 Web 服务上调用方法：

```
public IEnumerable<MyDataType> List(bool showDeleted)
{
    var result = ResponseHelper<dynamic[], IEnumerable<MyDataType>>(new dynamic[] {InstanceGuid, showDeleted}, "List");
    return result;
}

public MyDataType Get(int myDataTypeId, bool showDeleted)
{
    var result = ResponseHelper<dynamic[], MyDataType>(new dynamic[] {InstanceGuid, myDataTypeId, showDeleted}, "Get");
    return result;
}

public static R ResponseHelper<T, R>(T parameters, string serviceAction)
{
    var results = default(R);
    foreach (var service in _webServiceCoordinator.GetServices())
    {
        var func = (Func<T, R>)Delegate.CreateDelegate(typeof(Func<T, R>), service, serviceAction);
        try
        {
            results = func(parameters);
            break;
        }
        catch
        {
            _webServiceCoordinator.LastServiceFaulted();
        }
    }
    return results;
} 
```

该方法返回包含此合同服务`_webServiceCoordinator.GetServices()`的 IEnumerable ：`System.Runtime.Remoting.Proxies.__TransparentProxy`

```
public interface IOverrideService : IWebService
{
    IEnumerable<MyDataType> List(Guid instanceGuid, bool showDeleted);
    MyDataTypeGet(Guid instanceGuid, int myDataTypeId, bool showDeleted);
} 
```

我在该`Delegate.CreateDelegate`行收到的错误是：

```
Cannot bind to the target method because its signature or security transparency is not compatible with that of the delegate type. 
```

我的想法是它失败了，因为它是代理类的代表，但是（在我看来）指针的指针应该仍然有效。

我想知道它是否与这个[问题有关](https://stackoverflow.com/questions/7136615/open-delegate-for-generic-interface-method)，即使我收到了不同的错误消息。

这是一个 .Net 4.0 项目，但我使用的是 VS2012（所以安装了 .NET 4.5）

# css - 相互重叠的链接

> ID：15666609
> 
> 赞同：1
> 
> 时间：2013-03-27T18:27:37.600
> 
> 标签：css, wordpress

当您将鼠标悬停在本网站上的链接上时，它们似乎重叠。已为 div 指定了正确的高度，但是一旦将鼠标悬停在链接上，它似乎会获得 165px 的高度

[http://www.dawaf.co.uk/animate/](http://www.dawaf.co.uk/animate/)

有没有办法将高度设置为 93px 以停止重叠？

```
#about {
    position: absolute;
    left: 0;
    top: 0;
    height: 89px;
    width: 336px;
}
span.title-link {
    font-size: 6.8em;
    font-weight: bold;
    font-family: 'Titillium Web', Arial, sans-serif;
    text-decoration: none;
    line-height: 93px;
    cursor: pointer;
    opacity: 0;
}

span.title-link a {
    color: #FFF;
    text-decoration: none;
}

span.title-link a:hover {
    color: #E91F4C;
}

#about-red {
    left: -104px;
    width: 545px;
}

#logo-red {
    height: 93px;
    width: 209px;
    position: absolute;
    left: 336px;
}   

/*Echo
------------------------------------------------------------ */
#gallery {
    position: absolute;
    left: 0;
    top: 0;
    height: 92px;
    width: 434px;
}   

#gallery-echo {
    left: -202px;
    width: 714px;
}

#logo-echo {
    height: 93px;
    width: 280px;
    position: absolute;
    left: 434px;
}   

/*Events
------------------------------------------------------------ */
#contact-events {
    left: -216px;
    width: 862px;
}   

#contact {
    position: absolute;
    left: 0;
    top: 0;
    height: 92px;
    width: 448px;
}   

#logo-events {
    height: 93px;
    width: 414px;
    position: absolute;
    left: 448px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:40:55.607

跨度、`a`链接等内联元素会忽略“高度”属性。尝试：

```
.title-link {
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:21:10.037

如果您绝对定位元素并固定大小，您将遇到更多的工作您的问题很复杂，因为您将 px 与 %/em 单位混合在一起。您的时间最好花在调整方法上，而不是解决这个问题。

*   将绝对定位限制为尽可能少的元素。在这种情况下，您希望将导航项目包装在容器中，并绝对定位容器。
*   不要固定高度；`font-size`与 with 一起`line-height:SOME_MULTIPLE(i.e. 1.5)`使用（`vertical-align:middle`无论元素是 inline/inline-block/block 都可以使用）。
*   尝试概括您的样式并通过类将它们应用于多个元素，而不是通过 id 为单个元素设置样式。它使您的 CSS 更易于维护。

给你这些提示而不回答你的问题的原因......

1.  最初将这个网站整合在一起会容易得多
2.  更改导航项的文本或添加新的导航项的工作量会减少。
3.  我已经看到了这种带有 id 的样式和使用的所有内容的固定位置/大小方法。它太多余和死板而无用。忘记最佳实践；它违反了基本的 CSS 和 HTML 原则，使每个人都难以处理简单的事情。打破习惯，让这个和你未来的所有项目变得更容易！

# c# - 您可以在 ReportViewer 文本框中放置一个内联表达式吗？

> ID：15666610
> 
> 赞同：0
> 
> 时间：2013-03-27T18:27:38.113
> 
> 标签：c#, reportviewer

我有一个文本框，里面有一些文本。我希望能够用日期值表达式替换一些文本。该值将来自数据集字段。我已经尝试了一些事情（在这个文本框上放置一个带有表达式的文本框，使用 {{Expr}} 标记以及其他一些东西）但没有运气。

只是想知道这是否可能和/或是否有人想出了一个可行的简单解决方案？

编辑，我想做这样的事情（其中 SCARED 是一个表达式而不是静态的）：

今天我发现了一只老鼠，它把我**吓坏**了，我昏倒了。

我想保持格式（粗体、下划线等）并插入一个表达式。在这一点上，我只能做一个或另一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:40:42.110

右键单击`Textbox`并选择表达式。您将看到丢失了可用的选项。此外，还丢失了可应用于字段和参数的分类功能以及...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T13:45:01.823

为了在文本中添加表达式并同时保留格式（粗体和下划线），我将三个文本框链接在一起。表达式文本将具有自己的格式化文本框。您可以在表达式中添加表达式中间文本（右键单击文本框等），但您不能只使表达式加粗（至少我发现）。

# excel - 如何创建工作表的动态视图（过滤器）？

> ID：15666613
> 
> 赞同：1
> 
> 时间：2013-03-27T18:27:41.023
> 
> 标签：excel

我正在尝试修改一个 excel 文件以改进其功能，但不幸的是我对 excel 没有太多经验。

为了解释我的问题，假设我有 2 个工作表：WS1 和 WS2。WS1 包含用户输入的所有数据。第一列包含整数。我希望 WS2 包含 WS1 的动态视图。特别是 WS2 应该包含 WS1 中第一列包含“1”的所有行。每次更新 WS1 时，WS2 的内容都会自动更改。

我可以使用标准的 Excel 功能/技术来实现此功能吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T02:35:44.243

您可以使用数组公式来实现这一点。假设您的数据在列`A`和`B`工作`C`表中`WS1`。`A1`在工作表的单元格中输入以下公式`WS2`：

```
=INDEX('WS1'!$A:$A,SMALL(IF('WS1'!$A:$A=1,ROW(INDIRECT("1:"&COUNTA('WS1'!A:A)))),ROWS('WS1'!$A$1:$A1))) 
```

`Ctrl`使用-确认此公式`Shift`，`Enter`表示这是一个数组公式。结果，您会在它周围看到大括号`{}`。

`B1`同样，在单元格和`C1`工作表中输入以下数组公式`WS2`：

```
=INDEX('WS1'!$B:$B,SMALL(IF('WS1'!$A:$A=1,ROW(INDIRECT("1:"&COUNTA('WS1'!A:A)))),ROWS('WS1'!$A$1:$A1)))       
=INDEX('WS1'!$C:$C,SMALL(IF('WS1'!$A:$A=1,ROW(INDIRECT("1:"&COUNTA('WS1'!A:A)))),ROWS('WS1'!$A$1:$A1))) 
```

然后选择单元格`A1`，`B1`然后`C1`在工作表上将`WS2`右下角一直向下拖动到需要包含所有行的位置。请注意，如果您向下拖得太远，您将看到`#NUM`。为避免这种情况，请将公式包装在公式中`IFERROR()`（对于 Excel 2007 及更高版本），如

```
=IFERROR(INDEX('WS1'!$A:$A,SMALL(IF('WS1'!$A:$A=1,ROW(INDIRECT("1:"&COUNTA('WS1'!A:A)))),ROWS('WS1'!$A$1:$A1))),"") 
```

如果调整了on列中的值，则工作表上列的内容`WS2`会自动更新。`A``WS1`

一个更有效的解决方案使用辅助列，让我们在 worksheet 上说`WS3`。它首先使用以下公式计算相关行的索引（作为 中的数组公式`A1`）：

```
=IFERROR(SMALL(IF('WS1'!$A:$A=1,ROW(INDIRECT("1:"&COUNTA('WS1'!A:A)))),ROWS('WS1'!$A$1:$A1)),"") 
```

`B1`然后在,`C1`和中输入以下公式`D1`（正则，不是数组公式）：

```
=IF(ISBLANK($A1),"",INDEX('WS1'!$A:$A,$A1))
=IF(ISBLANK($A1),"",INDEX('WS1'!$B:$B,$A1))
=IF(ISBLANK($A1),"",INDEX('WS1'!$C:$C,$A1)) 
```

并选择并向下拖动。

您可以在此处找到上传的[示例工作簿](http://temp-share.com/show/YgFHvdnfy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-09T12:14:12.610

另一种方法是：在工作表 WS1 的主表左侧创建一个顺序键列，然后使用 WS2 中的 vlookup 仅检索这些行，使用 WS2 上的行号作为查找键。

例如，假设您的数据在 WS1!C2:D8 中，并且您只想要列 D 的值为“a”的行。然后在 B2 中输入以下内容，然后粘贴到 B2:B8 中：

```
=IF(D2="a",ROW(),"") 
```

然后在 A2 中输入以下内容，并粘贴到 A2:A8 中：

```
=IF(B2="","",RANK(B2,$B$2:$B$8,-1)) 
```

最后，在 WS2!A1 中输入这个公式，并尽可能地向下和向下粘贴（为了安全起见，就您在 WS1 中的原始表格而言）：

```
=IF(ROW() > MAX(Sheet1!$A$2:$A$8),"",VLOOKUP(ROW(),Sheet1!$A$2:$D$8,COLUMN())) 
```

# c# - .csproj 程序集的多个提示路径

> ID：15666618
> 
> 赞同：72
> 
> 时间：2013-03-27T18:27:54.177
> 
> 标签：c#, visual-studio-2010, msbuild, csproj

我正在为 SDK 分发打包示例代码。在发行版中，从代码到 SDK 程序集的相对路径与构建机器不同。例如：

**分配**

```
csharp/bin/assembly.dll
example/ex1/ex1.csproj 
```

**建造机器**

```
foo/sdk/csharp/bin/assembly.dll
bar/baz/quux/ex1/ex1.csproj 
```

假设我不能移动任何东西。有没有办法我可以指示`ex1.csproj`查看两者

`../../csharp/bin/` **而** `../../../../foo/sdk/csharp/bin/`对于`assembly.dll`？

在 C++ 中，我会将依赖路径放在独立的属性表中，并使用 SDK 分发不同的版本。但是 C# 没有属性表，我不想维护完整项目的两个版本。

我已经看到[这个问题](https://stackoverflow.com/questions/462564/hintpath-on-a-added-reference-in-visual-studio)指出我不能使用多个`<HintPath>`标签，所以我正在寻找另一种方法来近似相同的行为。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2014-11-04T14:59:04.440

由于只能使用 ONE HintPath，因此最简单的方法是使用非常棒的 Condition 属性，如下所示：

```
<Reference Include="TheAssembly">
    <HintPath Condition="Exists('..\My\Assembly\Path')">..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\My\Assembly\Path')">..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\My\Assembly\Path')">..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\My\Assembly\Path')">..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    etc...
</Reference> 
```

所以这个问题的答案是这样的：

```
<Reference Include="assembly">
    <HintPath Condition="Exists('..\..\csharp\bin')">..\..\csharp\bin\assembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\foo\sdk\csharp\bin')">..\..\..\..\foo\sdk\csharp\bin\assembly.dll</HintPath>
</Reference> 
```

如果多个条件匹配，将使用最后一个。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-27T19:23:45.993

我找到了一个适用于我的案例的 hacky 解决方案，其中父目录保证在树上的某处不同：

```
<Choose>
  <When Condition="Exists('$(MSBuildProjectDirectory)\..\..\example')">
    <ItemGroup>
      <Reference Include="Assembly ...">
        <HintPath>..\..\csharp\bin\assembly.dll</HintPath>
      </Reference>
    </ItemGroup>
  </When>
  <Otherwise>
    <ItemGroup>
      <Reference Include="Assembly ...">
         <HintPath>..\..\..\..\..\foo\sdk\csharp\bin\assembly.dll</HintPath>
      </Reference>
    </ItemGroup>
  </Otherwise>
</Choose> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-27T20:29:13.890

将如下所示的辅助路径添加到常规属性组。在 csproj 文件中

```
<PropertyGroup>
    <ReferencePath>..\..\..\..\..\foo\sdk\csharp\bin\</ReferencePath>
    ...
</PropertyGroup> 
```

该`ReferencePath`属性旨在在执行 MsBuild 时指定，但它会像这样正常工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-02-14T15:46:00.150

我正在使用这个解决方案没有任何问题：

```
<Reference Include="log4net">
  <HintPath>
     $(SolutionDir)packages\log4net.2.0.8\lib\net45-full\log4net.dll
  </HintPath>
</Reference> 
```

从这里得到它： [使用来自 LeonidVasilyev 的提示路径相对答案](https://github.com/NuGet/Home/issues/738)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:30:19.420

例如，您可以将`/csharp/bin`文件夹替换为驱动器（在每台机器上不同），`X:`然后在两台机器上引用`X:\`或引用`X:\bin`，因为路径现在相同。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-05-22T16:13:07.247

只需将 DLL 的构建服务器位置添加为项目的参考路径。似乎做得很好，而且非常简单。仅当您知道 DLL 的构建服务器的文件夹时才有效。

![在此处输入图像描述](../Images/9c088d34d40b552dd13c9381f75b2cba.png)

# javascript - 使用 JavaScript 从 url 获取属性

> ID：15666619
> 
> 赞同：-3
> 
> 时间：2013-03-27T18:27:54.553
> 
> 标签：javascript

假设我有网页 1，它将我重定向到网页 2，但是像 xyz.com?a=qwerty 使用 JavaScript，我将如何检索 a 的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:30:10.047

这是处理它的小功能

```
<script type="text/javascript">
function $_GET(q,s) { 
    s = s ? s : window.location.search; 
    var re = new RegExp('&'+q+'(?:=([^&]*))?(?=&|$)','i'); 
    return (s=s.replace(/^?/,'&').match(re)) ? (typeof s[1] == 'undefined' ? '' : decodeURIComponent(s[1])) : undefined; 
} 
</script> 
```

用法

```
<script type="text/javascript">
    alert('GET var myVar = '+$_GET('myVar'));
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:30:38.983

Javascript 作为一种语言没有直接的 URL 解析工具。但是，有许多库可供选择，它们提供这种类型的支持

*   [http://blog.stevenlevithan.com/archives/parseuri](http://blog.stevenlevithan.com/archives/parseuri)
*   [https://code.google.com/p/jsuri/](https://code.google.com/p/jsuri/)
*   [https://github.com/websanova/jquery-url#url](https://github.com/websanova/jquery-url#url)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:29:41.827

你可以试试这样的脚本。

```
var str=window.location.href; var n=str.split("="); alert(n[1]); 
```

此代码在 = 处拆分 URL，然后返回数据。

# java - 我需要一个数据结构来保存两种数据类型

> ID：15666627
> 
> 赞同：3
> 
> 时间：2013-03-27T18:28:19.350
> 
> 标签：java, data-structures, binary-tree, binary-search-tree

我正在制作一棵二叉树，当我向树中添加一个新的字符串节点时，我必须首先搜索该节点是否已经存在。如果是这样，我需要将其值增加一，而不是将其添加到不同的节点。

哪种数据结构最适合这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:56:28.380

巴尼的回答很好。但要更具体地回答您的问题，您可能希望您的节点类看起来像：

```
public class Node
{
    String value;
    int count;

    Node leftChild;
    Node rightChild;
} 
```

您将为您的树创建这些实例。这些实例之一将是“根”。`leftChild`所有其他实例将通过和直接或间接地挂起路由`rightChild`。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:33:49.000

除非我误解了你，否则你的问题很简单。只需创建一个包含两个成员变量的类：

```
public class Node {
    v1 data_type_1;
    v2 data_type_2;
} 
```

将其用作二叉树的节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:53:37.563

呵呵，基本上可能

[https://github.com/JohannesLichtenberger/sirix/tree/master/bundles/sirix-core/src/main/java/org/sirix/index/avltree](https://github.com/JohannesLichtenberger/sirix/tree/master/bundles/sirix-core/src/main/java/org/sirix/index/avltree)

有帮助。它是 AVLTree 的实现，一种平衡的二叉树。我会用泛型类型（我有）来实现它，这样你也可以存储其他内容。

在我的情况下，它被用作索引结构，它应该能够大部分存储在主内存中（但也可以使用使用版本控制算法的磁盘表示）。我正在存储一个字符串/路径组合（键）和一组属于路径（值）的简单 ID。

但是，您可能必须存储两个指向两个子节点的“指针”或对两个节点对象的内存引用。

编辑：您还可以仔细看看 Google Guava 即将推出的 BinaryTreeTraverser：[https ://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/collect/BinaryTreeTraverser .java](https://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/collect/BinaryTreeTraverser.java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:43:10.357

因此，结构的座右铭是通过减少重复次数来最小化内存。并按排序顺序存储数据。

那么这个节点可能对你的树有一些用处。

```
public class node
{
   String value;
   int count;
   node left;
   node right;
} 
```

但是即使它是 TreeMap 也有更好的解决方案，因为这里的搜索需要 O(1) （重复计数增量相当于搜索），在前一种情况下为 O(log(n))。

```
Map testTreeMap = new TreeMap();
if(testTreeMap.get(MyString)!=null)
{
testTreeMap.put(MyString, testTreeMap.get(MyString) +1)
}
else
{
testTreeMap.put( MyString , Integer(count) ) // count=1
} 
```

有了这个你就完成了..!!

[http://tutorialswithexamples.com/java-treemap-tutorial-and-examples/](http://tutorialswithexamples.com/java-treemap-tutorial-and-examples/)

# java - 批量发送对象比单独发送对象更快吗？

> ID：15666631
> 
> 赞同：1
> 
> 时间：2013-03-27T18:28:30.043
> 
> 标签：java, networking

快速提问。我有一个游戏，一群僵尸四处走动。我需要将每个僵尸的位置从服务器发送到客户端。如果我收集所有职位并将它们放在一个大包裹中发送，而不是单独发送每个职位，是否会加快流程？或者它有什么不同？

如果它取决于平台，我正在使用 Java 编码并使用 Kryonet 进行网络连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:30:43.770

当然，在批量上，它需要的开销比每个单独的要少。每个 tcp/ip 数据包都有一个标头，与单个数据包相比，散装该标头的需要更少。同样适用于通信协议。

但是对于游戏，如果需要实时行为，请考虑使用 udp；然后您必须查看适合一个 udp 数据包的内容。

# c++ - Xcode #从 3.2.6 更新到 4.5.1 后包含文件问题

> ID：15666633
> 
> 赞同：0
> 
> 时间：2013-03-27T18:28:34.963
> 
> 标签：c++, xcode, include, xcode4.5

自从将 C++ 项目从 Xcode 3.2.6 升级到 Xcode 4.5.1 以来，我遇到了最奇怪的 #include 文件问题：无法找到我的一个静态链接库的 #include 头文件。对于整个项目，我没有其他未定义的符号错误。

#include 位于前缀标头“MacClient_Prefix.pch”中（我不是预编译标头）：

```
#include "Framework/Base/BaseEnvironment.h" 
```

此头文件 (BaseEnvironment.h) 位于与静态链接库相关的完全不同的文件夹层次结构中。

错误：

```
/Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/WordMenuBaseEnv.h
/Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/WordMenuBaseEnv.h:26:10: 'Framework/Base/BaseEnvironment.h' file not found
/Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/<built-in>:148:2: In file included from <built-in>:148:
/Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/<command line>:4:10: In file included from <command line>:4:
/Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/MacClient_Prefix.pch:9:10: In file included from
     /Users/StephenDev/Documents/dev/WordMenu/Projects/MacClient/Xcode/MacClient_Prefix.pch:9: 
```

我相当确定为项目正确设置了用户头文件路径。

奇怪的是，如果我注释掉#include，那么我会从其余代码中得到数百个缺少符号的实际错误。很明显，当前缀头用于编译项目文件时，文件被找到。

我什至尝试在#include 中明确指定头文件的完整路径，但这破坏了项目构建其余部分的包含。

我在构建选项中的包含路径是项目相关的，我认为这可能与这个问题有关。该问题是否与派生数据或中间体的包含路径有关？

静态链接库的构建项目（包含在有错误的“主”项目中）确实将头文件定义为“公共”。但是，主项目的干净构建/重建（目前）似乎不会重新构建静态链接库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:38:30.483

> 奇怪的是，如果我注释掉#include，那么我会从其余代码中得到数百个缺少符号的实际错误。很明显，当前缀头用于编译项目文件时，文件被找到。

#include 错误是致命的，因此编译器将不会继续显示因缺少#include 而导致的所有错误。

```
#include <foo>
There's no way this is legal C++... 
```

结果：

```
main.cpp:1:10: fatal error: 'foo' file not found
#include <foo>
         ^
1 error generated. 
```

没有其他错误的事实并不意味着第二行被解释为有效的 C++ 代码。

# javascript - 如何避免javascript命名空间冲突？

> ID：15666634
> 
> 赞同：3
> 
> 时间：2013-03-27T18:28:43.010
> 
> 标签：javascript, javascript-framework

我有一个企业应用程序，它导入了一些 java 脚本库（比如说 A），其中包含全局命名空间中的一些函数。

我们的客户可以扩展我们的平台并导入 jquery，这将导致命名空间冲突。

因为 jquery 非常流行并且每个客户都会使用它，所以对我来说，帮助客户避免命名空间冲突的最佳方法是什么。

如何更改库 A 的命名空间？什么是最方便和最安全的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:31:10.613

对于 jQuery，最简单的方法是使用[jQuery.noConflict()](http://api.jquery.com/jQuery.noConflict/)来获取新的选择器变量而不是 $。

```
var j$ = jQuery.noConflict();

j$('#test-id') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:33:06.340

您应该构建一个不允许您的客户影响全局空间的界面。

将客户的代码包装在自己的函数中。

```
(function () {
  var window, global;  // Keep these private to this function
  // Customer code here
])(); 
```

您将需要为他们提供一个接口来访问您的功能，但是您如何做到这一点取决于您的应用程序，因此我无法提供示例。它可能就像传递一个参数一样简单，该参数可以访问包含需要由该客户代码操作的对象的对象。

现在，这并不适用于所有事情。显然，您极大地限制了他们的代码可以访问的内容。您需要自己提供对该功能的访问权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T18:34:09.770

使用此构造：

```
(function ($, a, b) {
   // ... place your code here   
})(jQuery, myLibraryA, otherLibraryB); 
```

它被称为“匿名函数”，它创建一个局部范围（在内部声明的所有变量和函数都是局部的，不会干扰其他代码）。它导入三个库，jQuery、myLiberrayA 和 otherLibraryB，并且在本地范围内，它们在名称 $、a 和 b 下可见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-26T19:55:57.370

如果您想使用第三方 javascript 库的组合，您也可以这样做：基本上为每个对象创建另一个命名空间；

```
if(window.jQuery && !(window.MyjQuery)){
  var window['MyjQuery'] =  window.jQuery;
  var j$ = window['MyjQuery']; //alias

  j$(document).ready(function(){
    //code goes here...
  });

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:33:45.633

AdSafe 可能对您来说也很有趣，请参阅[http://www.adsafe.org/](http://www.adsafe.org/)了解更多信息。

祝你好运

# python - pyqt - 使用现有数据将颜色放入 QTableView

> ID：15666635
> 
> 赞同：2
> 
> 时间：2013-03-27T18:28:48.807
> 
> 标签：python, qt, pyqt, pyqt4, tableview

我需要帮助为我的 QTableView 着色。@rainer 帮助我在初始化表格时添加颜色，但是现在，我已经有一个带有数据的表格（但没有颜色//我的数据是在我的表格中打开的 csv），我想创建一个单击它时的按钮在某些行中为表格视图着色，例如当有一行带有-2（数据）时，它将是蓝色的颜色。--我有一个按钮和一个表格。此按钮将 csv 数据加载到我的 tableview 中。我想要一个新按钮来为这个表的行着色。（但仅对具有-2数据的行着色，例如）一些代码：

```
 self.fileName = (_fromUtf8('tweets.csv'))
    self.tableView = QTableView(self.tabSentimento)
    self.tableView.setGeometry(QRect(550,10,510,700))
    self.tableView.setObjectName(_fromUtf8("TabelaSentimento"))
    self.tableView.setModel(self.model)
    self.tableView.horizontalHeader().setStretchLastSection(True)

    self.pushButtonLoad = QPushButton(self.tabSentimento)
    self.pushButtonLoad.setGeometry(QRect(550,720,130,30))
    self.pushButtonLoad.setObjectName(_fromUtf8("buttonLoadCSV"))
    self.pushButtonLoad.setText(QApplication.translate("Form", "Process!", None, QApplication.UnicodeUTF8))
    self.pushButtonLoad.setStyleSheet('color:red;background-color:rgb(255, 255, 153);border:1px solid purple;')
    self.pushButtonLoad.clicked.connect(self.on_pushButtonLoad_clicked)

    def loadCsv(self, fileName):
        with open(fileName, "rb") as fileInput:
            for row in csv.reader(fileInput):    
                items = [
                    QStandardItem(field)
                    for field in row
            ]
                self.model.appendRow(items)

    def on_pushButtonLoad_clicked(self):
        print self.fileName
        self.loadCsv(self.fileName) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:37:12.257

例如，您可以子类化模型并重新实现该方法，如果选中 并且单元格的值等于 1 `data`，此代码示例会将单元格的背景颜色更改为蓝色。它也会影响同一行中的单元格。`pushButtonColorize`

```
#!/usr/bin/env python
#-*- coding:utf-8 -*-

import sip
sip.setapi('QString', 2)
sip.setapi('QVariant', 2)

import random
from PyQt4 import QtGui, QtCore

class MyStandardItemModel(QtGui.QStandardItemModel):
    _colorize = False
    def __init__(self, parent=None):
        super(MyStandardItemModel, self).__init__(parent)

    def setColorized(self, state):
        self._colorize = state

    def data(self, index, role=QtCore.Qt.DisplayRole):
        if role == QtCore.Qt.BackgroundColorRole \
        and not self._colorize:
            return QtGui.QBrush()

        return super(MyStandardItemModel, self).data(index, role)

class MyWindow(QtGui.QWidget):
    def __init__(self, parent=None):
        super(MyWindow, self).__init__(parent)

        self.pushButtonColorize = QtGui.QPushButton(self)
        self.pushButtonColorize.setText("Colorize Cells!")
        self.pushButtonColorize.setCheckable(True)
        self.pushButtonColorize.toggled.connect(self.on_pushButtonColorize_toggled)

        self.pushButtonReload = QtGui.QPushButton(self)
        self.pushButtonReload.setText("Reload Data!")
        self.pushButtonReload.clicked.connect(self.on_pushButtonReload_clicked)

        self.modelSource = MyStandardItemModel(self)

        self.tableView = QtGui.QTableView(self)
        self.tableView.horizontalHeader().setStretchLastSection(True)
        self.tableView.setModel(self.modelSource)

        self.layoutVertical = QtGui.QVBoxLayout(self)
        self.layoutVertical.addWidget(self.pushButtonReload)
        self.layoutVertical.addWidget(self.pushButtonColorize)
        self.layoutVertical.addWidget(self.tableView)

        self.pushButtonReload.click()

    @QtCore.pyqtSlot()
    def on_pushButtonReload_clicked(self):
        self.modelSource.clear()

        for rowNumber in range(3):
            items = []
            for columnNumber in range(3):
                item = QtGui.QStandardItem()
                item.setText(str(random.getrandbits(1)))

                items.append(item)

            self.modelSource.appendRow(items)

        if self.pushButtonColorize.isChecked():
            self.on_pushButtonColorize_toggled(True)

    @QtCore.pyqtSlot(bool)
    def on_pushButtonColorize_toggled(self, state):
        self.modelSource.setColorized(state)

        rowCount    = self.modelSource.rowCount()
        columnCount = self.modelSource.columnCount()

        for rowNumber in range(rowCount):
            for columnNumber in range(columnCount):
                cellIndex = self.modelSource.index(rowNumber, columnNumber)
                cellData  = self.modelSource.data(cellIndex, QtCore.Qt.DisplayRole)

                if str(cellData).isdigit() \
                and int(cellData) == 1:
                    for cellColumn in range(columnCount):
                        self.modelSource.setData(
                            self.modelSource.index(rowNumber, cellColumn),
                            QtGui.QColor(QtCore.Qt.blue),
                            QtCore.Qt.BackgroundColorRole
                        )

        self.modelSource.endResetModel()

if __name__ == "__main__":
    import sys

    app = QtGui.QApplication(sys.argv)
    app.setApplicationName('MyWindow')

    main = MyWindow()
    main.resize(333, 222)
    main.show()

    sys.exit(app.exec_()) 
```

# php - PHP MySQL 按日期排序（自定义）

> ID：15666639
> 
> 赞同：-3
> 
> 时间：2013-03-27T18:29:16.163
> 
> 标签：php, mysql, sql-order-by

这是我的 PHP/SQL 请求

```
<?php $events = $wpdb->get_results( 
    "
    SELECT * 
    FROM  `wp_em_events` 
    LIMIT 5
    // HERE'S MY ORDER BY DATE
    "
);

$dt = new DateTime($event->event_start_date);
$formattedDate = $dt->format('d M Y');

foreach ( $events as $event ) 
{

echo '<div class="home-event">';
    echo $formattedDate;
    echo $event->event_name;
echo '</div>';

}

?> 
```

根据包含列“ **event_start_date** ”的表，其中值如下所示：

```
2013-03-27 
2013-04-03
2013-03-31 
```

**我想在这些日期之前订购我的活动（首先是离我们最近的）**

我试过单

```
ORDER BY event_start_date DESC 
```

但它“烧毁”了我的请求

-------- 奖金问题 --------

我怎样才能增加我的事件才能拥有：

```
<div class="home-event-1">
<div class="home-event-2">
<div class="home-event-3">
... 
```

非常感谢你 ！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:33:57.247

`ORDER BY`出现在*之前*`LIMIT`。_ 你会想要：

```
SELECT
    * 
FROM
    `wp_em_events` 
ORDER BY
    event_start_date DESC
LIMIT 5 
```

此外，您在错误的位置获取日期。它需要*在*迭代内：

```
foreach ( $events as $event ) 
{

  $dt = new DateTime($event->event_start_date);

  $formattedDate = $dt->format('d M Y');

  // ... 
```

至于增量：

```
foreach ( $events as $key => $event ) 
{

    echo '<div class="home-event-' . ($key + 1) . '">';
    echo $formattedDate;
    echo $event->event_name;
    echo '</div>';

} 
```

当然，假设`$events`不是关联数组。如果是：

```
$i = 0;

foreach ( $events as $event ) 
{

    echo '<div class="home-event-' . ++$i . '">';
    echo $formattedDate;
    echo $event->event_name;
    echo '</div>';

} 
```

# matlab - 我对matlab数字有疑问。我在 matlab 中使用 bar3 函数并想调整我的轴

> ID：15666644
> 
> 赞同：0
> 
> 时间：2013-03-27T18:29:25.907
> 
> 标签：matlab

我有一个名为 myval 的二维矩阵。它的大小是 21x11。

我想要做的是只绘制前 11 行和所有列，即 11x11。所以我在 matlab 中使用了一个 bar3 函数来做到这一点，这给了我一个很好的情节。

现在 z 轴是存储在`myval`矩阵中的实际值。但碰巧我希望 x 和 y 轴值（代表相应的行和列）从 0 开始。也就是说，(1,1) 的值将是 (0,0)，而 (1,2) 的值将是 (0,1)。我不想更改`myval`矩阵中的实际值。我只想移动轴。这是我的实际代码

```
 bar3(myval(1:t,:));
     xlim([0 p]); 
     ylim([0 t]);
     zlim([0 1); 
     set(gca,'fontsize',16); 
     set(gca,'XTick',(0:2:p)); 
     set(gca,'YTick',0:2:t); 
     set(gca,'ZTick',0:1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:34:01.233

您需要`bar3`同时提供 x 和 Y 输入，然后列将出现在您想要的位置。

```
x = 0:10;
Y = myval(1:t,:);
bar3(x,Y) 
```

或者，要同时控制 x 和 y 轴，您可以使用：

```
x = 0:10;
bar3(Y)
set(gca,'YTickLabel', x)
set(gca,'XTickLabel', x) 
```

# c# - 修改实体模型后每个属性的“X 和 X 之间的歧义”

> ID：15666646
> 
> 赞同：10
> 
> 时间：2013-03-27T18:29:33.307
> 
> 标签：c#, asp.net, entity-framework-4

在对实体模型进行小幅更改并尝试重新编译后，每次引用实体模型中的属性时，都会出现“'XYZ.EntityX.PropertyX' 和 'XYZ.EntityX.PropertyX' 之间的歧义”错误。在每种情况下，这两个属性都是相同的。还有很多“类型'XYZ.EntityX'已经包含'PropertyX'的定义”。有没有人遇到过这样的事情？

我最近将代码放入源代码安全中，我会大胆猜测并说可能与它有关。也许它不能更新一个没有签出的文件，也没有提示它？我不知道。

我所做的只是进入 XYZModel.edmx，选择一个表，添加一个标量属性（字符串，50 个字符，可为空）并重新编译。在那之前一切正常。当我“从数据库更新模型”时也会发生这种情况。我猜对模型的任何改变都会导致它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-09T06:12:12.307

我在 Visual Studio 2015 中遇到了完全相同的问题，但我使用了 TFS 而不是 Sourcesafe。

第一个选项是确保您已连接到源代码管理（在线）。

如果这不起作用

1.  确保您的 Visual Studio 解决方案已连接到 TFS/源代码管理。当您使用离线模式时，可能会出现此问题。如果您处于离线状态，请右键单击解决方案并选择联机。
2.  在 Visual Studio 中在线连接到 TFS 后，右键单击 edmx 并选择 Goto Source Control->Undo Pending changes。这将撤消 edmx 和相关生成文件的所有未决更改。
3.  从 edmx 中删除更改的表并重新添加。
4.  构建您的解决方案

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-14T12:28:01.730

我有同样的问题。由于某种原因，在更新我的实体框架模型时，它创建了第二个 Model.Context.cs 文件。

这似乎是因为原来的模型与模型脱节了，它必须创建一个新模型。我删除了**原来**的那个，它解决了这个问题。

这些 .cs 文件应该在解决方案资源管理器中可见，方法是找到展开的 Model.edmx，然后找到并展开 Context.tt 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-10T13:33:37.513

刚才遇到了同样的错误，我发现我已经将类复制到一个新文件夹并且没有更改它们的名称。

我有一个文件夹名称`Group`，`City`然后我将类从复制`Group`到`City`何时`Group`，并且`City`在我收到错误的 appservice 上引用了文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-17T10:15:50.267

我认为您将某些文件移动或复制到其他文件夹，因此它们会出现此错误！

# java - 如何计算两个数组中相等值的数量？

> ID：15666650
> 
> 赞同：-3
> 
> 时间：2013-03-27T18:29:48.280
> 
> 标签：java, arrays

例如：

```
int[] a = [0,1,2,3,4,5];
int[] b = [3,4,5,6,7,8];

count = 3; 
```

数组不必是连续数字。我如何获得这些数组之间相等的值的数量？

编辑：所以我尝试了以下操作：

```
List<int[]> w = Arrays.asList(winning);
List<int[]> s = Arrays.asList(F1Select);            
w.retainAll(s);
int equalNums = w.size(); 
```

但是我收到了 retainAll 行的以下错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.UnsupportedOperationException
    at java.util.AbstractList.remove(Unknown Source)
    at java.util.AbstractList$Itr.remove(Unknown Source)
    at java.util.AbstractCollection.retainAll(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:35:44.567

您可以只转换为列表，然后使用retainAll 找到交集。

```
List<Integer> aList =  Arrays.asList(a);
List<Integer> bList =  Arrays.asList(b);
aList.retainAll(bList);
return aList.size(); 
```

aList 将只包含也在 bList 中的项目，aList 的大小让您知道计数。

如果您只想要唯一值，您可以将数组转换为 a`Set`并执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:43:17.333

[尝试这个 ：](https://stackoverflow.com/a/9233119/1743852)

```
 Integer[] a = new Integer[]{0, 1, 2, 3, 4, 5};
 Integer[] b = new Integer[]{3, 4, 5, 6, 7, 8};

  List<Integer> list1 = Arrays.asList(a);
  Set<Integer> commonSet = new TreeSet<Integer>();
     for (Integer i : b) {
         if (list1.contains(i)) {
           commonSet.add(i);
            }
        }

        System.out.println(commonSet.size()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:36:32.403

如果允许`O(m + n)`在计算期间使用额外的空间，则可以为每个数组保留一个 HashMap。键是每个数组元素，值是它出现的次数。一旦您计算出每个数字出现的频率，您就可以将问题简化为比较两张地图。

每当您在两个地图中都有一个键时，您就会在两个数组中都有一个数字。这些值可以让您决定数字在两个数组中出现的次数。

# ruby-on-rails-3 - 如何在rails的初始化程序中模拟变量？

> ID：15666652
> 
> 赞同：0
> 
> 时间：2013-03-27T18:29:59.870
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

```
Class Client 
def initialize(options = {})
      @key = options['oauth_key']
      @secret = options['oauth_secret']
      @access_token_url = options['oauth_access_token_url']
      @signature_method = options['signature_method']
      @consumer = OAuth::Consumer.new(@key, @secret, {access_token_url: @access_token_url, signature_method: @signature_method})
    end 
```

我如何在 Rails 中使用 mocha 模拟所有这些（主要是消费者）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:37:09.870

```
oauth_mock = mock('oauth')
OAuth::Consumer.stubs(:new).returns(oauth_mock) 
```

# shell - Zsh 中 `find` 命令的文档

> ID：15666654
> 
> 赞同：1
> 
> 时间：2013-03-27T18:30:09.047
> 
> 标签：shell, zsh

我`find`在很多地方多次看到这个命令，几个例子是：

```
for source in `find $dotfiles_root -maxdepth 2 -name \*.symlink` 
```

或者：

```
if ! [ -f git/gitconfig.symlink ] 
```

或者：

```
if [ -f $dest ] || [ -d $dest ] 
```

等等。我知道，如果你这样做`[ -f $dest ]`，你基本上是在做`find -f $dest`.

那么有没有关于这个命令的可靠文档？如果有的话，我在任何地方都找不到。

例如，我希望它能够知道它是如何`find $dotfiles_root -maxdepth 2 -name \*.symlink`工作的，但是我不知道它是如何工作的`-maxdepth`。

任何帮助表示赞赏。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:34:35.577

```
man find 
```

由于可用选项因您使用的平台而异，因此对命令执行*man*应该为您提供可用选项和特定版本的语法。

# c# - 设置 MDI 表单的背景图片

> ID：15666656
> 
> 赞同：0
> 
> 时间：2013-03-27T18:30:12.300
> 
> 标签：c#, mdi

我正在使用[这种](http://www.dreamincode.net/forums/topic/113335-change-background-of-an-mdi-form/)技术，它可以很好地改变背景颜色而不是图像。我的图像比窗口小，所以我使用 BackgroundImageLayout 来拉伸，但它没有任何区别。

在我的 MDI 表单的构造函数中，我使用以下代码：

```
InitializeComponent();

            Image img = Image.FromFile("C:\\duk.jpg");
            foreach (Control control in this.Controls)
            {
                if (control is MdiClient)
                {

                    control.BackgroundImageLayout = ImageLayout.Stretch;
                    control.BackgroundImage = System.Drawing.Image.FromFile("C:\\duk.jpg");

                   // control.BackColor = Color.AliceBlue;
                    //Properties.Resources.duk;
                    MessageBox.Show("MDI");
                    break;
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-06T16:12:49.563

很清楚为什么会发生这个问题。MDIClient 对象不支持 ImageLayout.Stretch。这是记录在案的。要真正正确地做到这一点是一个巨大的痛苦。尝试从与此类似的东西继承您的 MDI 表单（根据需要进行编辑）：

```
public class MdiForm : System.Windows.Forms.Form
{
    private static readonly float _bg_scale = FormGraphics.mdi_background.Width / (float)FormGraphics.mdi_background.Height;

    private MdiClient _mdi_client = null;

    private Image _background_cache = null;

    public MdiForm()
    {
        SetStyle(
            ControlStyles.UserPaint |
            ControlStyles.AllPaintingInWmPaint |
            ControlStyles.OptimizedDoubleBuffer, true);

        Shown += MdiForm_Shown;
        SizeChanged += MdiForm_SizeChanged;

        IsMdiContainer = true;
    }

    private void MdiForm_Shown(object sender, EventArgs eventArgs)
    {
        foreach (MdiClient control in Controls.OfType<MdiClient>())
        {
            _mdi_client = control;
            control.Paint += MdiClient_Paint;
            control.BackColor = Color.White;

            //LA LA LA I CAN'T HEAR YOU
            //this DOES work and IS required to avoid flicker
            MethodInfo mInfoMethod = typeof(MdiClient).GetMethod(
                                               "SetStyle",
                                               BindingFlags.Instance | BindingFlags.NonPublic,
                                               Type.DefaultBinder,
                                               new[] { typeof(ControlStyles), typeof(bool) },
                                               null);
            mInfoMethod.Invoke(control, new object[] {
                ControlStyles.UserPaint |
                ControlStyles.AllPaintingInWmPaint |
                ControlStyles.OptimizedDoubleBuffer, true });
        }
    }

    private void MdiClient_Paint(object sender, PaintEventArgs e)
    {
        if(_background_cache == null) { _background_cache = new Bitmap(FormGraphics.mdi_background, (int)(Height * _bg_scale), Height); }
        e.Graphics.DrawImageUnscaled(_background_cache, Point.Empty);
    }

    private void MdiForm_SizeChanged(object sender, EventArgs e)
    {
        if (_background_cache != null) { _background_cache.Dispose(); }
        _background_cache = null;
        if (_mdi_client != null) { _mdi_client.Invalidate(); }
    }
} 
```

显然，您需要自己处理错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-15T11:38:39.610

我认为这段代码将帮助您更正，在您的界面中设置背景图像及其填充属性......

```
private void MDIParent1_Load(object sender, EventArgs e)
    {
        BackgroundImage =              
  System.Drawing.Image.FromFile("C:\\Users\\sanoop\\Downloads\\2137969.png");
        BackgroundImageLayout = System.Windows.Forms.ImageLayout.Stretch;
    } 
```

# python - 基于 INSTALLED_APPS Django 在 urls.py 中导入 url

> ID：15666659
> 
> 赞同：3
> 
> 时间：2013-03-27T18:30:15.280
> 
> 标签：python, django

我有`social_networks`一个受控的应用程序，`settings.py`即是否将其导入主应用程序。

我实现的方式是：

```
`from  social_networks import fb_settings`

`fb_settings.modify(globals())` 
```

如果我想停止对应用程序及其功能的支持，我必须手动注释掉`modify`不会被调用的代码。

在我作为应用程序`fb_settings.py`的一部分的`social_networks`应用程序中，我更新了`INSTALLED_APPS`以反映新应用程序的`modify`功能。

我有 main`urls.py`我有`include('social_networks.urls')`，但我想让它更加模块化，以便在未安装应用程序时不包括在内。目前我正在检查`settings.INSTALLED_APPS`变量以检查应用程序是否存在并基于它`include('social_networks.urls')`。

这是做事的正确方法`django`还是我错过了可以帮助我的 django 已经可用的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:35:19.677

我认为这是一个好方法（你已经提到过）：

```
# define necessary urls of your app which should always be present
urlpatterns = patterns('',
    url(r'^$', 'myapp.views.home', name='home'),
)

# then add urls of external apps if the app is present in INSTALLED_APPS
if 'social_networks' in settings.INSTALLED_APPS:
    urlpatterns += patterns('',
        url(r'^social/', include('social_networks.urls')),
    ) 
```

# javascript - JavaScript 中的自定义事件

> ID：15666660
> 
> 赞同：2
> 
> 时间：2013-03-27T18:30:16.780
> 
> 标签：javascript

是否可以在 JavaScript 中创建将在某些条件下触发的自定义事件（例如，三次单击或滑动）？也许要听这个自定义事件：

```
addEventListener('trplclick', handler, false); 
```

因此，例如，仅当在 600 毫秒内完成 3 次点击时才会调用处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:35:09.240

您需要自己触发`triplclick`事件。`triplclick`监听单个点击事件，计算它们，并在有意义时触发。

看看[`document.dispatchEvent`](https://developer.mozilla.org/en-US/docs/DOM/EventTarget.dispatchEvent?redirectlocale=en-US&redirectslug=DOM/element.dispatchEvent)。

我正在使用 jQuery 来演示这个概念，但您不需要：

```
var count = 0;
var resetTimeout - 1;
$(element).on("click", function(){
    count++;
    clearTimeout(resetTimeout);
    if (count === 3)
    {
        count = 0;
        $(element).trigger("trplclick");
    }
    else 
    {
        resetTimeout = setTimeout(function(){
            count = 0; // Don't count if no click within the last second.
        }, 1000);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:43:52.180

在此处查看类似问题：[如何在 JavaScript 中侦听三次点击？](https://stackoverflow.com/questions/6480060/how-do-i-listen-for-triple-clicks-in-javascript)

基本上它所做的是将双击事件和单击事件组合在一起以模拟三次单击。当双击事件触发时，设置一个 200ms 的超时时间。如果出现以下点击，请检查计时器是否超时。如果在上一次双击后 200 毫秒后发生此单击（此时，双击处理程序中的计时器设置为 null），则丢弃此单击，否则将其计为三次单击。

对于一般设置自定义事件，我将向您推荐 Nicholas C. Zakas 的博客文章：[http ://www.nczonline.net/blog/2010/03/09/custom-events-in-javascript/](http://www.nczonline.net/blog/2010/03/09/custom-events-in-javascript/)

# r - 识别纵向数据集中“ID”中的最后一个“字母”

> ID：15666663
> 
> 赞同：3
> 
> 时间：2013-03-27T18:30:22.420
> 
> 标签：r

我正在尝试识别纵向数据集中的最后一个`letter`。`ID`

假设我的数据看起来像这样，

```
dfL <- data.frame(ID = c(1L, 1L, 1L, 4L, 4L, 4L, 4L, 4L, 9L, 9L, 9L, 9L, 9L, 10L), week = c("BS", 4L, 6L, "BS", 6L, 9L, 9L, 12L, "BS", 4L, 6L, 9L, 12L, "BS"), outcome = c(14L, 28L, 42L, 14L, 46L, 64L, 71L, 85L, 14L, 28L, 51L, 66L, 84L, 0L), letter = c("a", "b", "a", "b", "a", "b", "a", "b", "a", "b", "a", "b", NA, NA)); dfL 
```

每个`ID`都有 s 串字母（`a`和`b`'s），我需要找到其中的最后一个字母`ID`并将*其*放在基线上。

```
 ID week outcome letter
1   1   BS      14      a
2   1    4      28      b
3   1    6      42      a
4   4   BS      14      b
5   4    6      46      a
6   4    9      64      b
7   4    9      71      a
8   4   12      85      b
9   9   BS      14      a
10  9    4      28      b
11  9    6      51      a
12  9    9      66      b
13  9   12      84   <NA>
14 10   BS       0   <NA> 
```

我想最终的结果会是这样的，

```
 ID week outcome letter last_letter
1   1   BS      14      a      a
2   1    4      28      b   <NA>
3   1    6      42      a   <NA>
4   4   BS      14      b      b
5   4    6      46      a   <NA>   
6   4    9      64      b   <NA>
7   4    9      71      a   <NA>
8   4   12      85      b   <NA>
9   9   BS      14      a      b
10  9    4      28      b   <NA>
11  9    6      51      a   <NA>
12  9    9      66      b   <NA>
13  9   12      84   <NA>   <NA>
14 10   BS       0   <NA>   <NA> 
```

我已经摆弄了`which.max`from the `data.table`package 和 with `ave`，但我还是有点卡住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T18:58:19.700

使用 base R's`ave`我会用这样的自定义函数来处理它：

```
FUN <- function(x) {
    if (all(is.na(x))) return(NA)
    tail(na.omit(x), 1)
}

dfL$lastL <- with(dfL, ave(letter, ID, FUN=FUN))

##    ID week outcome letter lastL
## 1   1   BS      14      a     a
## 2   1    4      28      b     a
## 3   1    6      42      a     a
## 4   4   BS      14      b     b
## 5   4    6      46      a     b
## 6   4    9      64      b     b
## 7   4    9      71      a     b
## 8   4   12      85      b     b
## 9   9   BS      14      a     b
## 10  9    4      28      b     b
## 11  9    6      51      a     b
## 12  9    9      66      b     b
## 13  9   12      84   <NA>     b
## 14 10   BS       0   <NA>  <NA> 
```

**编辑：**

如果您希望它看起来像您的，`<NA>`那么这种方法`tapply`将起作用。

```
FUN <- function(x) {
    if (all(is.na(x))) {
        first <- NA
    } else {
        first <- tail(na.omit(x), 1)
    }
    out <- as.character(rep(NA, length(x)))
    out[1] <- as.character(first)
    out
}

dfL$lastL <- factor(unlist(with(dfL, tapply(letter, ID, FUN=FUN))))

##    ID week outcome letter lastL
## 1   1   BS      14      a     a
## 2   1    4      28      b  <NA>
## 3   1    6      42      a  <NA>
## 4   4   BS      14      b     b
## 5   4    6      46      a  <NA>
## 6   4    9      64      b  <NA>
## 7   4    9      71      a  <NA>
## 8   4   12      85      b  <NA>
## 9   9   BS      14      a     b
## 10  9    4      28      b  <NA>
## 11  9    6      51      a  <NA>
## 12  9    9      66      b  <NA>
## 13  9   12      84   <NA>  <NA>
## 14 10   BS       0   <NA>  <NA> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T18:54:19.883

我希望我的问题是正确的（我真的不知道每个 ID 的最后一个字母是什么；我会假设它是结果最高的那个）：

然后是一个`data.table`解决方案：

```
library(data.table)
dfL <- as.data.table(dfL)
setkey(dfL, ID, outcome)
intDT <- dfL[!is.na(letter), list(lastL = tail(letter, 1)), by=ID]
setkey(intDT, ID)
intDT[dfL]
    ID lastL week outcome letter
 1:  1     a   BS      14      a
 2:  1     a    4      28      b
 3:  1     a    6      42      a
 4:  4     b   BS      14      b
 5:  4     b    6      46      a
 6:  4     b    9      64      b
 7:  4     b    9      71      a
 8:  4     b   12      85      b
 9:  9     b   BS      14      a
10:  9     b    4      28      b
11:  9     b    6      51      a
12:  9     b    9      66      b
13:  9     b   12      84     NA
14: 10    NA   BS       0     NA 
```

只是对我在这里所做的事情的简短解释：我`dfL`首先进行排序，然后为每个 ID ( `by=ID`) 获取最后一个值`letter`（使用 function 完成`tail`）。之后，我必须再次合并这两个 data.tables。

更容易（感谢 Luciano 的评论）：

```
dfL[!is.na(letter), lastL := tail(as.character(letter), 1), by=ID]
    ID week outcome letter lastL
 1:  1   BS      14      a     a
 2:  1    4      28      b     a
 3:  1    6      42      a     a
 4:  4   BS      14      b     b
 5:  4    6      46      a     b
 6:  4    9      64      b     b
 7:  4    9      71      a     b
 8:  4   12      85      b     b
 9:  9   BS      14      a     b
10:  9    4      28      b     b
11:  9    6      51      a     b
12:  9    9      66      b     b
13:  9   12      84     NA    NA
14: 10   BS       0     NA    NA 
```

在这里，这一切都是一步完成的。但是，这仅在将列转换`letter`为字符时才有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T18:59:07.370

这是使用 plyr 的一种方法：首先省略 NA，按 id 拆分并查看最后一个值。然后合并回来。

```
library(plyr)

last_letter <- ddply(na.omit(dfL), .(ID), function(x) tail(as.character(x$letter),1))
last_letter$week <- "BS"
names(last_letter)[2] <- "last_letter"
merge(dfL, last_letter, by = c("ID", "week"), all=TRUE)

   ID week outcome letter last_letter
1   1    4      28      b        <NA>
2   1    6      42      a        <NA>
3   1   BS      14      a           a
4   4   12      85      b        <NA>
5   4    6      46      a        <NA>
6   4    9      64      b        <NA>
7   4    9      71      a        <NA>
8   4   BS      14      b           b
9   9   12      84   <NA>        <NA>
10  9    4      28      b        <NA>
11  9    6      51      a        <NA>
12  9    9      66      b        <NA>
13  9   BS      14      a           b
14 10   BS       0   <NA>        <NA> 
```

# mysql - MySQL REGEXP 查找单词

> ID：15666664
> 
> 赞同：1
> 
> 时间：2013-03-27T18:30:29.060
> 
> 标签：mysql, regex

我正在使用 twitter API 用推文填充我的数据库。我现在希望能够在推文中搜索单词。我意识到这并不像使用 LIKE 那样简单，因为 LIKE 会执行以下操作：

> 如果搜索“pan”like 将返回包含包含该字符串的单词的推文，例如“companion”。

我决定我需要使用正则表达式来解决这个问题。基本上，我希望能够在我正在搜索的推文中找到完整的单词（如果它们包含在上面的其他单词中，则不是）。那么我怎么能做到这一点呢？

以下是我到目前为止所拥有的：

```
SELECT tweet_id, text FROM tweets WHERE text REGEXP '' 
```

我只是不确定正则表达式应该包含什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T18:33:08.250

您可以分别使用`[[:<:]]`和`[[:>:]]`作为匹配单词开头和结尾的单词边界：http: [//dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

```
SELECT tweet_id, text FROM tweets WHERE text REGEXP '[[:<:]]pan[[:>:]]' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:32:45.623

如果你访问[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)，你可以输入一些测试数据并使用你的正则表达式字符串，直到你得到一个工作正常的字符串。

作为一个起点，你可能想要类似的东西`'.* pan .*'`

`.`= 通配符 `.*`= 匹配 1 个或多个通配符

这适用于您的*大多数*搜索示例，但您需要使用 regexr 才能获得适用于所有可能性的示例

# git - git缺少工作树

> ID：15666667
> 
> 赞同：2
> 
> 时间：2013-03-27T18:30:36.577
> 
> 标签：git, workflow

我收到“[remote denied] master branch is current check out”错误——与这篇文章中的 OP 基本上是相同的问题（[Git push error '[remote denied] master -> master (branch is current check out)'](https://stackoverflow.com/questions/2816369/git-push-error-remote-rejected-master-master-branch-is-currently-checked/15630603#15630603)） ，以下是我迄今为止为修复它所做的工作，但现在我似乎可以在上述问题或新问题之间做出选择 - “缺少工作树”错误，如下所述，这是我目前陷入困境的地方。

另请注意，我的要求与其他问题不同。我不想要两个仓库，一个是裸的，一个是非裸的——只是一个仓库（源/远程），本地机器将从中提取/推送代码——它是一个实时 Web 服务器。另一篇文章没有按照这些要求指定任何要求（那里没有解决这个选项），但我的需求非常具体，因此提出了这个问题。

另请注意，有时可能会在服务器上直接编辑此目录的文件（尽管仍在使用 Git），而不是从本地工作站推送到服务器（远程），这是不可避免的。

首先，我重置了 repo，将其设置为 bare（最初在服务器上设置 Git 的开发人员只`git init`在设置 repo 时使用了该命令）：

```
 git init --bare 
```

然后，因为我所有的服务器文件都已经存在（它不是一个空目录），所以我通过这种方法（通常）做了一个初始提交：

```
 git add .
    git commit -m "initial commit" 
```

然后我就这样编辑了`.git/config`文件：

```
 git config receive.denyCurrentBranch ignore 
```

我当前的服务器`.git/config`文件如下所示：

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true

[receive]
        denyCurrentBranch = false 
```

我能够成功推送提交，但是如果我尝试应用这个：

```
 git checkout -f 
```

如上所述（大概是接受所有提交并重置 HEAD 以包含我的所有更改？），我收到以下致命错误：

```
 fatal: This operation must be run in a work tree 
```

我需要将工作树设置为此目录吗？如果是这样，我该怎么做？如果我这样做，结果是否仍然符合我的既定目标（同样，没有单独的裸和非裸回购 - 只是单个目录，它也服务于实时网站并位于网络根目录中） ?

还有什么我需要做的我想念的吗？

我在 stackoverflow 上广泛阅读了有关此主题的内容，包括： [Git init --bare - Not Working on working tree](https://stackoverflow.com/questions/11525004/git-init-bare-not-working-on-working-tree?rq=1) [fatal: This operation must be run in a work tree](https://stackoverflow.com/questions/9262801/fatal-this-operation-must-be-run-in-a-work-tree) [Git 中 HEAD / Working Tree / Index 之间的区别](https://stackoverflow.com/questions/3689838/difference-between-head-working-tree-index-in-git) The Pro-Git book (尤其是这里：[http](http://git-scm.com/book/ch2-2.html) ://git-scm.com/book/ch2-2.html） Git-Flow（nvie）：[http ://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

非常感谢所有帮助和评论。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:17:29.937

您已经创建了一个裸 git 存储库（它本身没有工作树）。当您想要推送更改时，推荐使用裸 git 存储库。

根据您的问题，我了解到您有某种服务器设置，并且每次您执行 a`git push`时，您都希望更新服务器上的文件以反映新推送的更改。

是的，它是可行的，但是您需要将裸仓库和工作树分开。工作树位置应对应于您的文件需要在服务器上部署的位置。让我们假设它是`/foor/bar`. 通过设置接收后挂钩，您可以在每次推送后自动将新文件部署到此工作树位置。

以下是此设置的步骤：

1.  如果工作树目录不存在，则创建它。

    ```
    mkdir -p /foo/bar 
    ```

2.  创建以下脚本并将其作为裸仓库复制`hooks/post-receive`

    ```
    #! /bin/sh
    GIT_WORK_TREE=/foo/bar git checkout -f 
    ```

3.  将此脚本标记为可执行文件：

    ```
    chmod +x hooks/post-receive 
    ```

这就是所有需要的。现在尝试 a `git push`，您的新更改将自动部署到`/foo/bar`位置。

**注意事项：** `git checkout -f`破坏任何跟踪文件中的所有本地更改，并且任何此类更改`/foo/bar`都将丢失在新的`checkout -f`. 任何未在 git 中跟踪但在 下创建/生成的文件`/foo/bar`不应受到影响。

另外，我建议摆脱您在 中所做的更改`.git/config`，尤其是对`receive.denyCurrentBranch`.

您的配置应如下所示：

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = true
    logallrefupdates = true 
```

# excel - VBA Excel 比较两个列表的匹配项，在单独的工作表上输出结果

> ID：15666673
> 
> 赞同：2
> 
> 时间：2013-03-27T18:30:55.547
> 
> 标签：excel, vba, loops, compare

情况如下：

我正在验证数据库中的机构数据。每个机构都有一个与之关联的代码。我想确保我们数据库中的代码是正确的，并检查我们数据库中的名称是否包含错误。我会手动执行此操作，但要检查大约 1200 条记录。

我的所有数据都包含在一个工作簿中。

*   第一张表是我们数据库中的信息。机构名称在 B 列，代码在 K 列。代码以数字形式存储。
*   第二张表是最新信息。机构名称在 A 列，代码在 D 列。代码也以数字形式存储。
*   第三张表是为结果设置的

我想将第一张表中的代码与第二张表中的代码匹配，然后在第三张表上输出结果。我希望每个代码都有一行包含：表 1 中的机构名称、代码和第二张表中的机构名称。我想这样做，以便我可以检查代码是否有效，我们数据库中的代码是否对应于正确的机构，最后我可以检查机构名称的格式和其他差异。

这是我的问题：

1.  我没有使用原始工作簿并以某种方式破坏数据，而是创建了一个副本来测试代码。我编写了一个在测试文件中工作的程序，但是当我将它复制到原始文件并进行任何适当的更改时，代码不再有效。 **为什么会这样？**
2.  由于复制代码似乎会产生一些问题，因此我将代码逐字逐句重新输入到原始文件中。有效。但是，只是一种。代码运行，但只会执行条件中包含的部分代码。它将执行块中的第一行，但随后跳过其余部分，然后不再进入条件。 **由于一切都正确缩进，什么可能导致这种情况发生？**
3.  为了尝试检测为什么会出现所有这些问题，我尝试使用 F8 单步执行该程序。它逐步通过，但从不进入条件。它只是遍历循环。 **使用 Step Into (F8) 命令时，它不会评估 IF 语句吗？**
4.  为了测试我的循环是否正常运行，而不是遍历所有记录并不得不等待，我将 FOR 循环条件从 1170 更改为 11。除了循环运行的次数外，没有任何变化。然而，程序不再执行。当我改回号码时，它可以工作。 **为什么会这样？**

这是我的代码。它可能不是最佳的，但我只需要运行一次比较。即使花费了 2 个小时，也比手动检查它们要少。我知道这段代码有效，因为我让它在测试文件中工作。但是为什么它在原版中不起作用，我该怎么做才能使它起作用？

```
Sub FindMatches()

    Dim oldRow As Integer
    Dim newRow As Integer
    Dim i As Integer

    i = 2

    For oldRow = 2 To 1170
        For newRow = 2 To 1170
            If Worksheets("Sheet1").Cells(oldRow, 9) = Worksheets("Sheet2").Cells(newRow, 4) Then

                Worksheets("Sheet3").Cells(i, 1) = Worksheets("Sheet1").Cells(oldRow, 2)
                Worksheets("Sheet3").Cells(i, 2) = Worksheets("Sheet1").Cells(oldRow, 9)
                Worksheets("Sheet3").Cells(i, 3) = Worksheets("Sheet2").Cells(newRow, 1)

                i = i + 1

                Exit For
            End If
        Next newRow
    Next oldRow

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:41:49.010

我认为您引用了错误的列。K 列是 11 而不是 9

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:51:21.577

也许使用 Find() 而不是内部循环：

```
Sub FindMatches()

    Dim shtOld As Worksheet, shtNew As Worksheet, shtMatch As Worksheet
    Dim oldRow As Integer
    Dim newRow As Integer
    Dim i As Integer, id, f As Range

    i = 2

    Set shtOld = ThisWorkbook.Sheets("Sheet1")
    Set shtNew = ThisWorkbook.Sheets("Sheet2")
    Set shtMatch = ThisWorkbook.Sheets("Sheet3")

    For oldRow = 2 To 1170

        id = shtOld.Cells(oldRow, 9)

        Set f = shtNew.Range("D2:D1170").Find(id, , xlValues, xlWhole)
        If Not f Is Nothing Then
            With shtMatch.Rows(i)
                .Cells(1).Value = shtOld.Cells(oldRow, 2)
                .Cells(2).Value = id
                .Cells(3).Value = f.EntireRow.Cells(1)
            End With
            i = i + 1
        End If

    Next oldRow

End Sub 
```

# solr - Solr - 编写自定义请求处理程序

> ID：15666676
> 
> 赞同：1
> 
> 时间：2013-03-27T18:31:05.593
> 
> 标签：solr, lucene

有没有很好的在线教程来解释如何编写自定义请求处理程序？

我用谷歌搜索和搜索并没有找到任何东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:55:38.547

检查示例[@link](http://sujitpal.blogspot.in/2011/02/solr-custom-search-requesthandler.html)。
您也可以随时参考现有请求处理程序的当前 Solr 源代码，并以类似的方式实现它

# android - Android ndk-gdb 调试成分布式.so

> ID：15666680
> 
> 赞同：2
> 
> 时间：2013-03-27T18:31:08.970
> 
> 标签：android, android-ndk, gdb, gdbserver

我们有一套“核心”本机代码，将分发给 Android 开发人员，他们可以从中将其链接到他们自己的本机代码。所以Android .apk中有两个.so。为了帮助调试，我们希望能够调试到我们的“核心”.so 当它没有在同一个项目中显式编译时。

澄清。

1) ndk-build NDK_DEBUG=1 在可分发文件中运行。

2) 生成的“核心”.so 包含在我们的依赖项目的 Android.mk 文件中（在本例中为测试应用程序）

3) 我们在测试应用程序上运行 ndk-build NDK_DEBUG=1。

一切都会按要求编译和运行，但我们只能调试到“测试”.so。我对 ndk-gdb 如何使用 libs 文件夹下的 gdb.setup 文件（通过启用 NDK_DEBUG 创建）链接有很高的了解。我目前正在尝试以某种方式将两者都包含在内。

有没有人做过类似的事情？我已经搜索了很多，但没有找到任何结果。我们可以将“测试”项目和“核心”项目的本地方面编译成一个 .so 并调试到任何本地源代码（核心或测试），不幸的是，这不是对我们预期结果的良好测试。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T09:44:30.180

我有同样的事情，你是在你的第一个活动中加载图书馆吗？否则 gdb 将不会加载它。检查这个问题：[Android GDB is not loading c++ shared library](https://stackoverflow.com/questions/21532229/android-gdb-is-not-loading-c-shared-library/21533990#21533990)

# jquery - jQuery在网页初始加载时调整图像大小

> ID：15666686
> 
> 赞同：0
> 
> 时间：2013-03-27T18:31:28.830
> 
> 标签：jquery, resize, margins

好的，在 MAC OSX 上的 Google Chrome 中查看此页面： [http ://opportunityfinance.net/Test/2013conf/index.html](http://opportunityfinance.net/Test/2013conf/index.html)

向下滚动以查看以下内容：

![Chrome 中的初始加载问题](../Images/b202bef6e84bc31f71b74b9b270c34ac.png)

如果您调整浏览器窗口的大小，它会正确对齐，如下图所示：

![它应该是什么样子以及调整浏览器窗口大小时的外观](../Images/5b67bc1b6ee28bb044a54b259d7b1088.png)

所以，我的问题是如何在页面初始加载时获得第二张图片的外观？`<div class="gold">`谷歌浏览器最初使用以下代码将高度设置为 0px：

```
jQuery(document).ready(function($){

    var gold = $(".gold");

    $(window).bind("resize", function(){
        gold.css({'height': gold.children(":first").children("img").height()});             
    }).trigger("resize");
}); 
```

这是我正在使用的 HTML：

```
<div class="gold" style="width: 100%; position: relative; margin-top: 1em; margin-bottom: 1em;">
    <div style="position: absolute; bottom: 0px; right: 0px; width: 32%;">
        <img src="images/wellsfargo.png" alt="Wells Fargo" style="border: none; max-width: 100%;">
    </div>
    <div style="float: left; width: 32%; bottom: 0px; left: 0px; position: absolute;">
        <img src="images/citi.png" alt="Citi" style="max-width: 100%; border: none;">
    </div>
    <div style="margin: 0 auto; width: 34%; position: absolute; bottom: 0px; left: 0px; right: 0px;">
        <img src="images/gs10ksb.png" alt="Goldman Sachs 10000 Small Businesses" style="border: none; max-width: 100%;">
    </div>
</div> 
```

# ajax - 无法让 JSF 数据表仅提交 1 行

> ID：15666695
> 
> 赞同：0
> 
> 时间：2013-03-27T18:32:03.897
> 
> 标签：ajax, jsf, richfaces

我正在尝试更新 an 中的值，`h:dataTable`并且已达到我在单个 POST 中允许的请求参数的限制。对其进行萤火虫攻击后，我看到正在发送整个表以对单行进行更新。我尝试将 移动`h:form`到仅包围，`a4j:commandButton`但这不会更新属性值。我想过使用`f:ajax`，但我在那里看到的所有内容都在谈论`ManagedBean`s 的变化。这样做的问题是，支持类也在标准 Java 应用程序中使用，所以我想将它保持为一个干净的 POJO，而不是添加对 Java EE 特定库的依赖项。

**更新**

按照@Luiggi Mendoza 的要求，我已将问题分解为具有两个Java 类和一个xhtml的[SSCCE ：](http://sscce.org/)

测试DT.xhtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"> 

<h:head></h:head> 
<body>
    <rich:panel id="props">

      <h:form>
      <h:dataTable value="#{propertyEditor.properties}" var="prop">
        <h:column>
          <f:facet name="header">
            <h:outputText value="Value"/>
          </f:facet>
          <h:inputText value="#{prop.value}">
            <f:ajax/>
          </h:inputText>
        </h:column>
        <h:column>
          <a4j:commandButton
              value="Update Property"
              action="#{propertyEditor.updateProperty(prop.id)}"
              render="props"
              execute="@this"/>
        </h:column>
      </h:dataTable>
    </h:form>
    </rich:panel>
</body> 
</html> 
```

属性编辑器.java

```
package com.test;

import java.io.Serializable;
import java.util.ArrayList;

import javax.annotation.PostConstruct;
import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

@Named
@SessionScoped
public class PropertyEditor implements Serializable
{

  private ArrayList<Property> properties = new ArrayList<Property>();

  public PropertyEditor() {}

  @PostConstruct
  private void initProperties() {
    for (int i = 0; i < 510; i++) {
      Property p = new Property(i,"key"+i,"value"+i);
      properties.add(p);
    }
  }

  public ArrayList<Property> getProperties() {
    return properties;
  }

  public void updateProperty(int id) {
    System.out.println("we are updating: " + id);
  }

} 
```

属性.java

```
package com.test;

public class Property
{
  private int id;
  private String key;
  private String value;
  public Property(int id, String key, String value)
  {
    super();
    this.id = id;
    this.key = key;
    this.value = value;
  }
  public int getId()
  {
    return id;
  }
  public void setId(int id)
  {
    this.id = id;
  }
  public String getKey()
  {
    return key;
  }
  public void setKey(String key)
  {
    this.key = key;
  }
  public String getValue()
  {
    return value;
  }
  public void setValue(String value)
  {
    this.value = value;
  }

} 
```

此外，这是我的配置文件（beans.xml、faces-config.xml 和 web.xml）：

豆类.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:plidm="urn:java:org.jboss.seam.security.management.picketlink"
       xmlns:security="urn:java:org.jboss.seam.security"
       xmlns:s="urn:java:ee"
       xsi:schemaLocation="
      http://java.sun.com/xml/ns/javaee
      http://jboss.org/schema/cdi/beans_1_0.xsd">

</beans> 
```

面孔-config.xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">

</faces-config> 
```

网页.xml：

```
<?xml version="1.0"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
  <display-name>DataTableSubmit1</display-name>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
      <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
  </servlet-mapping>
</web-app> 
```

我的`WEB-INF/lib`目录中还有以下 jar：

```
common-annotations.jar
commons-beanutils.jar
commons-collections.jar
commons-digester.jar
commons-logging.jar
cssparser-0.9.5.jar
guava.jar
jsf-api-2.0.4-b09.jar
jsf-impl-2.0.4-b09.jar
jstl.jar
richfaces-components-api-4.2.0.Final.jar
richfaces-components-ui-4.2.0.Final.jar
richfaces-core-api-4.2.0.Final.jar
richfaces-core-impl-4.2.0.Final.jar
sac-1.3.jar
standard.jar 
```

我正在使用 Java 1.6 在 JBoss 7.1.1.Final 上运行。每次我尝试更新 1 行时，这仍然会提交整个表。我知道我可以增加允许的请求参数的数量，但这似乎是一个彻底的黑客攻击。我在 firebug 中查看时得到的响应消息是：

```
<?xml version='1.0' encoding='UTF-8'?>
<partial-response><error><error-name>class java.lang.IllegalStateException</error-name><error-message><![CDATA[More than the maximum number of request parameters (GET plus POST) for a single request ([512]) were detected. Any parameters beyond this limit have been ignored. To change this limit, set the maxParameterCount attribute on the Connector.]]></error-message></error></partial-response> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:38:37.380

假设您的`updateProperty`方法接收一个`int`参数（或 的类型`prop.id`），那么您必须使用`action`而不是`actionListener`.

解决方案：

```
<h:dataTable value="#{propertyEditor.properties}" var="prop">
    <!-- columns with data -->
    <h:column>
        <a4j:commandButton value="Update Property"
            action="#{propertyEditor.updateProperty(prop.id)}"
            render="props notif"/>
    </h:column>
</h:dataTable> 
```

还有你的托管bean：

```
@ManagedBean
@ViewScoped
public class PropertyEditor {

    //attributes, constructor, getters, setters and other methods...

    public void updateProperty(int id) {
        //current implementation...
    }
} 
```

如果你使用 CDI，基本上是相同的方法，只是不同的注释：

```
@Named
@SessionScoped
public class PropertyEditor {

    //attributes, constructor, getters, setters and other methods...

    public void updateProperty(int id) {
        //current implementation...
    }
} 
```

两者的区别参考这里：[action和actionListener的区别](https://stackoverflow.com/q/3909267/1065197)

# c# - 实体框架连接优化

> ID：15666696
> 
> 赞同：0
> 
> 时间：2013-03-27T18:32:06.043
> 
> 标签：c#, sql-server-2008, entity-framework, code-first

我最近开始使用实体框架和代码优先迁移。我的应用程序现在是“实时”的，我开始看到事情变得越来越慢。我的数据库表中有大约 30.000 行使用最多。

这是一种我返回很多的方法，因为我必须返回表格，一个带有消息数据，一个带有每个收件人：

```
IQueryable<CompleteMessageModel> completeMessageModels = 
    from msg in db.NewMessageItems
    join mr in db.MessageRecipients on msg.MessageId equals mr.MessageId
    select
    new CompleteMessageModel()
    {
          MessageId = msg.MessageId,
          RecipientMessageId = mr.MessageRecipientId,
          Title = msg.Title,
          Message = msg.Message,
          Recipients = msg.Recipients,
          AuthorUserId = msg.AuthorId,
          RecipientUserId = mr.RecipientId,
          StatusCode = mr.StatusCode,
          Timestamp = msg.Timestamp,
          IsRead = mr.ReadTimestamp > 0,
          ReadTimestamp = mr.ReadTimestamp,
          GeoTag = msg.GeoTag
    }; 
```

然后我使用这个 IQueryable 来询问高于某个时间戳和类似操作的消息。

**我的问题是：这个查询可以进一步优化吗？**

这是最常用查询的执行计划：

```
SELECT TOP (90) 
[Project1].[MessageId] AS [MessageId], 
[Project1].[MessageRecipientId] AS [MessageRecipientId], 
[Project1].[Title] AS [Title], 
[Project1].[Message] AS [Message], 
[Project1].[Recipients] AS [Recipients], 
[Project1].[AuthorId] AS [AuthorId], 
[Project1].[RecipientId] AS [RecipientId], 
[Project1].[StatusCode] AS [StatusCode], 
[Project1].[Timestamp] AS [Timestamp], 
[Project1].[C1] AS [C1], 
[Project1].[ReadTimestamp] AS [ReadTimestamp], 
[Project1].[GeoTag] AS [GeoTag]
FROM ( SELECT 
    [Extent1].[MessageId] AS [MessageId], 
    [Extent1].[Message] AS [Message], 
    [Extent1].[Title] AS [Title], 
    [Extent1].[AuthorId] AS [AuthorId], 
    [Extent1].[Timestamp] AS [Timestamp], 
    [Extent1].[Recipients] AS [Recipients], 
    [Extent1].[GeoTag] AS [GeoTag], 
    [Extent2].[MessageRecipientId] AS [MessageRecipientId], 
    [Extent2].[RecipientId] AS [RecipientId], 
    [Extent2].[ReadTimestamp] AS [ReadTimestamp], 
    [Extent2].[StatusCode] AS [StatusCode], 
    CASE WHEN ([Extent2].[ReadTimestamp] > 0) THEN cast(1 as bit) WHEN ( NOT ([Extent2].[ReadTimestamp] > 0)) THEN cast(0 as bit) END AS [C1]
    FROM  [dbo].[NewMessageModels] AS [Extent1]
    INNER JOIN [dbo].[MessageRecipients] AS [Extent2] ON [Extent1].[MessageId] = [Extent2].[MessageId]
    WHERE ([Extent2].[RecipientId] = @p__linq__0) AND (1 <> [Extent2].[StatusCode]) AND (3 <> [Extent2].[StatusCode]) AND ([Extent1].[Timestamp] >= @p__linq__1)
)  AS [Project1]
ORDER BY [Project1].[Timestamp] DESC 
```

**如果它可以被优化，这在 c# 中会是什么样子？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:37:31.517

您不需要在 linq 查询中加入 - 只需访问投影中的 msg.MessageRecipient nav 属性。它将通过将返回的字段数减少为仅在投影中使用的字段数来简化您的 SQL 语句，但连接仍然是必需的。

例如改变

```
RecipientMessageId = mr.MessageRecipientId 
```

到

```
RecipientMessageId = msg.MessageRecipient.MessageRecipientId 
```

检查 SSMS 中生成脚本的执行计划 - 它应该建议一个可以提高性能的索引。

编辑：修改您的示例以删除不必要的 linq 连接。您可以像访问投影中的任何其他属性一样访问导航属性：

```
IQueryable<CompleteMessageModel> completeMessageModels = 
    from msg in db.NewMessageItems
    //join mr in db.MessageRecipients on msg.MessageId equals mr.MessageId
    select
    new CompleteMessageModel()
    {
          MessageId = msg.MessageId,
          RecipientMessageId = msg.MessageRecipient.MessageRecipientId,
          Title = msg.Title,
          Message = msg.Message,
          Recipients = msg.Recipients,
          AuthorUserId = msg.AuthorId,
          RecipientUserId = msg.MessageRecipient.RecipientId,
          StatusCode = msg.MessageRecipient.StatusCode,
          Timestamp = msg.Timestamp,
          IsRead = msg.MessageRecipient.ReadTimestamp > 0,
          ReadTimestamp = msg.MessageRecipient.ReadTimestamp,
          GeoTag = msg.GeoTag
    }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T00:29:28.447

与您手头的具体问题无关（莫霍已经部分回答了）......

您还可以尝试[性能提示](http://msdn.microsoft.com/en-us/library/cc853327.aspx)，尤其是[Entity Framework 5 的性能注意事项](http://msdn.microsoft.com/en-us/data/hh949853.aspx)

> 最重要的是，下载[EF Power Tools](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d) - 并检查该`generate views`功能。

有关更多信息，我几天前发布了更多信息（只是一点点，但可能会有所帮助）。

[使用 EF 5 Code First 将视图映射到实体](https://stackoverflow.com/questions/15774566/mapping-view-to-entity-using-ef-5-code-first/15791197#15791197)

[为什么当我想使用 EF Power 工具查看我的模型时出现错误？](https://stackoverflow.com/questions/14586061/why-when-i-want-use-ef-power-tools-for-view-my-model-i-get-error/15792960#15792960)

# c# - 可测试性与过度设计？

> ID：15666698
> 
> 赞同：3
> 
> 时间：2013-03-27T18:32:22.493
> 
> 标签：c#, unit-testing, tdd, moq, assembly.load

这是一位与我感兴趣的同事实际提出的情况：

```
public DoSomething()
{
    //Do Stuff
    var assembly = Assembly.LoadFrom("Path");
    //Do More Stuff
} 
```

所以，为了模拟这个，你有两个选择

创建一个`internal virtual`方法：

```
internal virtual IAssembly LoadAssembly(String path){...Load Here...} 
```

或者，添加一个可以传入的新类

```
public class AssemblyLoader
{
    public virtual IAssembly LoadAssembly(String path){...Load here...}
} 
```

这两个选项似乎都是一个问题，因为第一个似乎它应该是一个私有方法，而第二个似乎是为简单的静态调用创建包装器的过度设计？

所以，我想我会把它带到社区。我正在寻找最实用的方法，同时保持**单元**可测试。

这类似于[这个 SO question](https://stackoverflow.com/questions/1397876/tdd-how-to-write-test-case-for-a-method-that-as-assembly-loadfrom)，但是我真的想更深入地研究它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T16:12:59.937

这个问题太笼统了，所以很难回答。

一般来说，**我认为你的问题是人为的**。您认为为 3rd 方服务创建包装器是过度设计，但同时说此包装器是解决实际问题的方法。如果它解决了一个真正的问题，这听起来不像是过度设计，**一个包装器实际上听起来像是好的设计。**

**当您需要在您无法控制的代码上配置状态时，**为 3rd 方服务创建包装器通常是明智的。**它没有你想象的那么难闻。事实上，我没有看到另一种方法来做到这一点。无论你如何分割它，无论你是在使用一些 3rd 方库进行模拟，使用一些反射魔法，还是使用你有目的的解决方案，这一切都归结为包装真正的 3rd 方 api。**

 **如果您的直觉仍然认为包装这个外部 api 是过度设计，那么您可能需要重新构建您的问题。问问自己，**是否应该测试这段代码？**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T02:02:10.647

这里很难一概而论，但是加载程序集前后的评论表明该`DoSomething`方法可能违反了[单一责任原则](https://docs.google.com/file/d/0ByOwmqah_nuGNHEtcU5OekdDMkk/edit?pli=1)。也就是说，代码做了太多的事情。有很多方法可以编写代码，这样您就可以避免这种情况，您在问题中提到了其中两种。我想我会听从 Greg 的建议并在这里实施依赖注入。根据这个例子，我很难说什么是过度设计，什么不是过度设计。**

# actionscript-3 - 在 Flash as3 中设置定时器

> ID：15666700
> 
> 赞同：2
> 
> 时间：2013-03-27T18:32:35.403
> 
> 标签：actionscript-3, flash, timer, try-catch, flash-cs5

我有一个几周后到期的项目，我几乎完成了它。我还有一个问题需要解决，我很困惑。

我将在下面粘贴到目前为止的代码。

如果您还可以解释代码在做什么，那么我知道它在做什么，如果它不是太麻烦的话，代码是从课堂活动中获取的，我更改了标识符以匹配我的图形被调用的内容。我正在尝试在我的 drop and catch 游戏中实现一个计时器，它每 15 秒增加一次下落物体的速度。计时器将从 60 秒开始，当它达到 0 秒时，它应该进入一个单独的页面。

有人可以解释一下我会怎么做吗？我不太擅长理解 Flash 中的代码，所以如果你能让它尽可能简单，我将不胜感激。

我拥有的代码如下。它工作得很好，我只需要将部分更改为计时器：

```
package {
import flash.display.*;
import flash.events.*;
import flash.text.*;
import flash.utils.Timer;
import flash.utils.getDefinitionByName;

public class CatchingGame extends MovieClip {
    var catcher:Catcher;
    var nextObject:Timer;
    var objects:Array = new Array();
    var score:int = 0;
    const speed:Number = 7.0;

    public function CatchingGame() {
        catcher = new Catcher();
        catcher.y = 350;
        addChild(catcher);
        setNextObject();
        addEventListener(Event.ENTER_FRAME, moveObjects);
    }

    public function setNextObject() {
        nextObject = new Timer(1000+Math.random()*1000,1);
        nextObject.addEventListener(TimerEvent.TIMER_COMPLETE,newObject);
        nextObject.start();
    }

    public function newObject(e:Event) {
        var goodObjects:Array = ["Circle1","Circle2"];
        var badObjects:Array = ["Square1","Square2"];
        if (Math.random() < .5) {
            var r:int = Math.floor(Math.random()*goodObjects.length);
            var classRef:Class = getDefinitionByName(goodObjects[r]) as Class;
            var newObject:MovieClip = new classRef(); 
            newObject.typestr = "good";
        } else {
            r = Math.floor(Math.random()*badObjects.length);
            classRef = getDefinitionByName(badObjects[r]) as Class;
            newObject = new classRef(); 
            newObject.typestr = "bad";
        }
        newObject.x = Math.random()*500;
        addChild(newObject);
        objects.push(newObject);
        setNextObject();
    }

    public function moveObjects(e:Event) {
        for(var i:int=objects.length-1;i>=0;i--) {
            objects[i].y += speed;
            if (objects[i].y > 400) {
                removeChild(objects[i]);
                objects.splice(i,1);
            }
            if (objects[i].hitTestObject(catcher)) {
                if (objects[i].typestr == "good") {
                    score += 5;
                } else {
                    score -= 1;
                }
                if (score < 0) score = 0;
                scoreDisplay.text = "Score: "+score;
                removeChild(objects[i]);
                objects.splice(i,1);
            }
        }

        catcher.x = mouseX;

    }
}
} 
```

感谢您花时间阅读我的问题以及提供的任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T21:58:07.007

因此，您需要一个每 15 秒计时一次的计时器，持续 60 秒。这意味着它必须打勾 4 次 ( `60 / 15`)。让我们称之为`speedTimer`; 你必须像这样实例化它：

```
speedTimer = new Timer(60 * 1000, 4); 
```

然后你需要添加两个不同的事件监听器。每次计时器滴答时都会调用一个，当它停止时会调用一个。

```
speedTimer.addEventListener(TimerEvent.TIMER, onSpeedTimer);
speedTimer.addEventListener(TimerEvent.TIMER_COMPLETE, onSpeedTimerComplete); 
```

在第一个事件处理程序中，您增加`speed`. 为此，您需要将其从常量更改为变量。

在第二个处理程序中，您将代码转到另一个页面。

有几点需要说明：

当你声明一个变量时，你应该指定一个范围（即私有、公共等），就像你为你的函数所做的那样：

```
private var catcher:Catcher; 
```

当你声明一个函数时，你应该指定一个返回值，除了你的类的构造函数。如果函数什么都不返回，你可以使用 void：

```
public function setNextObject():void {
    [...]
} 
```

命名很重要，尤其是在您稍后阅读代码时理解您的代码。如果您使用 a `Timer`，最好将其命名为类似`myTimer`而不是`nextObject`.

函数名称也是如此：`setNextObject()`创建一个新的`Timer`并启动它，所以我将它命名为`startTimer()`.

当您像这样创建新计时器时：

```
new Timer(1000 + Math.random() * 1000, 1); 
```

您指定重复计数为 1。这意味着您的计时器将在满足延迟后停止。因为您希望它一遍又一遍地运行，所以您应该指定一个 repeatCount `0`（无限）。为了保持计时器以随机间隔滴答的功能，您需要在事件处理程序中设置一个新的延迟值

```
myTimer.delay = 1000 + Math.random() * 1000; 
```

`goodObjects`并且`nadObjects`永远不会被修改，因此您应该将它们提取为常量：

```
private const GOOD_OBJECTS:Array = ["Circle1","Circle2"];
private const BAD_OBJECTS:Array  = ["Square1","Square2"]; 
```

通过所有这些更改，现在应该更容易理解您的代码在做什么。这是更新的代码：

```
package
{
    import flash.display.*;
    import flash.events.*;
    import flash.text.*;
    import flash.utils.Timer;
    import flash.utils.getDefinitionByName;

    public class CatchingGame extends MovieClip
    {
        private const GOOD_OBJECTS:Array = ["Circle1","Circle2"];
        private const BAD_OBJECTS:Array = ["Square1","Square2"];

        private var catcher:Catcher;
        private var myTimer:Timer;
        private var speedTimer:Timer;
        private var objects:Array = new Array();
        private var score:int = 0;
        private var speed:Number;

        public function CatchingGame()
        {
            speed = 7.0;
            catcher = new Catcher();
            catcher.y = 350;
            addChild(catcher);
            startTimer();
            startSpeedTimer();
            addEventListener(Event.ENTER_FRAME, onEnterFrame);
        }

        public function startTimer():void
        {
            myTimer = new Timer(1000 + Math.random() * 1000, 0);
            myTimer.addEventListener(TimerEvent.TIMER, onTimer);
            myTimer.start();
        }

        public function startSpeedTimer():void
        {
            speedTimer = new Timer(60 * 1000, 4);
            speedTimer.addEventListener(TimerEvent.TIMER, onSpeedTimer);
            speedTimer.addEventListener(TimerEvent.TIMER_COMPLETE, onSpeedTimerComplete);
            speedTimer.start();
        }

        public function onTimer(e:Event):void
        {
            myTimer.delay = 1000 + Math.random() * 1000;
            if (Math.random() < .5)
            {
                var r:int = Math.floor(Math.random() * GOOD_OBJECTS.length);
                var classRef:Class = getDefinitionByName(GOOD_OBJECTS[r]) as Class;
                var newObject:MovieClip = new classRef(); 
                newObject.typestr = "good";
            }
            else
            {
                r = Math.floor(Math.random() * BAD_OBJECTS.length);
                classRef = getDefinitionByName(BAD_OBJECTS[r]) as Class;
                newObject = new classRef(); 
                newObject.typestr = "bad";
            }
            newObject.x = Math.random() * 500;
            addChild(newObject);
            objects.push(newObject);
            startTimer();
        }

        private function onSpeedTimer(e:Event):void
        {
            speed++;
        }

        private function onSpeedTimerComplete(e:Event):void
        {
            // Go to some page...
        }

        public function onEnterFrame(e:Event):void
        {
            moveObjects2();
        }

        public function moveObjects2():void {
            for(var i:int = objects.length - 1; i >= 0; i--)
            {
                objects[i].y += speed;
                if (objects[i].y > 400)
                {
                    removeChild(objects[i]);
                    objects.splice(i, 1);
                }
                if (objects[i].hitTestObject(catcher))
                {
                    if (objects[i].typestr == "good")
                    {
                        score += 5;
                    }
                    else
                    {
                        score -= 1;
                    }
                    if (score < 0)
                    {
                        score = 0;
                    }
                    scoreDisplay.text = "Score: "+score;
                    removeChild(objects[i]);
                    objects.splice(i,1);
                }
            }
            catcher.x = mouseX;
        }
    }
} 
```

如果还有不明白的地方，欢迎在评论中提出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:16:07.870

声明`speed`为变量而不是`const`，否则您的代码无法更改其值。你可以初始化变量，所以`var speed:Number=7.0`是有效的。

```
var speed:Number=7.0; 
var gameTimer:Timer=new Timer(15000,4);
var speedCounter:int=0;
gameTimer.addEventListener(TimerEvent.TIMER,gameTicks);
function gameTicks(e:TimerEvent):void {
    if (speedCounter==3) {
        gameTimer.removeEventListener(TimerEvent.TIMER,gameTicks);
        gameOver(); // implement this
        return;
    }
    speedCounter++;
    speed+=2.0; // balance this yourself
} 
```

# java - 奇怪的乐观锁异常

> ID：15666701
> 
> 赞同：2
> 
> 时间：2013-03-27T18:32:40.997
> 
> 标签：java, exception, locking, optimistic

我一直在为这个问题苦苦挣扎，最后决定与你分享作为我最后的选择。请帮帮我。我正在从事一个涉及 JSF、EcllipseLink JPA、Glassfish 3.1.2.2 开源版和 ms sql 的项目server 2008。问题是我无法在我的应用程序的任何地方更新数据库。每次我这样做时，我都会得到如下所示的乐观锁异常......

```
[#|2013-03-27T23:18:40.798+0530|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/C:/Users/user/Documents/NetBeansProjects/Change 31/PBG/TelephonyMetaDirectory/target/TelephonyMetaDirectory/WEB-INF/classes/_pbg|_ThreadID=124;_ThreadName=Thread-2;|javax.persistence.OptimisticLockException: Exception [EclipseLink-5006] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.OptimisticLockException
**Exception Description: The object [nl.pbgroep.tmd.model.TelephoneNumber@32df613] cannot be updated because it has changed or been deleted since it was last read. 
Class> nl.pbgroep.tmd.model.TelephoneNumber Primary Key> 85000**
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitToDatabase(RepeatableWriteUnitOfWork.java:638)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1505)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.issueSQLbeforeCompletion(UnitOfWorkImpl.java:3143)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.issueSQLbeforeCompletion(RepeatableWriteUnitOfWork.java:346)
    at org.eclipse.persistence.transaction.AbstractSynchronizationListener.beforeCompletion(AbstractSynchronizationListener.java:157)
    at org.eclipse.persistence.transaction.JTASynchronizationListener.beforeCompletion(JTASynchronizationListener.java:68)
    at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:435)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:855)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5136)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4915)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy267.update(Unknown Source)
    at nl.pbgroep.tmd.dao.__EJB31_Generated__TelephoneNumberDao__Intf____Bean__.update(Unknown Source)
    at nl.pbgroep.tmd.services.manager.PhoneAllocationService.allocatePhoneNumber(PhoneAllocationService.java:42)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at org.jboss.weld.ejb.SessionBeanInterceptor.aroundInvoke(SessionBeanInterceptor.java:42)
    at sun.reflect.GeneratedMethodAccessor126.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.GeneratedMethodAccessor125.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy273.allocatePhoneNumber(Unknown Source)
    at nl.pbgroep.tmd.services.manager.__EJB31_Generated__PhoneAllocationService__Intf____Bean__.allocatePhoneNumber(Unknown Source)
    at nl.pbgroep.tmd.ui.control.FunctionRoomPhoneAllocationService.allocateAndSetPhoneNumber(FunctionRoomPhoneAllocationService.java:36)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at org.jboss.weld.ejb.SessionBeanInterceptor.aroundInvoke(SessionBeanInterceptor.java:42)
    at sun.reflect.GeneratedMethodAccessor126.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.GeneratedMethodAccessor125.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy262.allocateAndSetPhoneNumber(Unknown Source)
    at nl.pbgroep.tmd.ui.control.__EJB31_Generated__FunctionRoomPhoneAllocationService__Intf____Bean__.allocateAndSetPhoneNumber(Unknown Source)
    at nl.pbgroep.tmd.ui.control.FunctionRoomNumberController.saveNewFunctionRoomNumber(FunctionRoomNumberController.java:234)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:39)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:50)
    at javax.faces.event.MethodExpressionActionListener.processAction(MethodExpressionActionListener.java:153)
    at javax.faces.event.ActionEvent.processListener(ActionEvent.java:88)
    at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:769)
    at javax.faces.component.UICommand.broadcast(UICommand.java:300)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.jboss.solder.servlet.exception.CatchExceptionFilter.doFilter(CatchExceptionFilter.java:65)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.jboss.solder.servlet.event.ServletEventBridgeFilter.doFilter(ServletEventBridgeFilter.java:74)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: Exception [EclipseLink-5006] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.OptimisticLockException
Exception Description: The object [nl.pbgroep.tmd.model.TelephoneNumber@32df613] cannot be updated because it has changed or been deleted since it was last read. 
Class> nl.pbgroep.tmd.model.TelephoneNumber Primary Key> 85000
    at org.eclipse.persistence.exceptions.OptimisticLockException.objectChangedSinceLastReadWhenUpdating(OptimisticLockException.java:137)
    at org.eclipse.persistence.descriptors.VersionLockingPolicy.validateUpdate(VersionLockingPolicy.java:778)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.updateObjectForWriteWithChangeSet(DatabaseQueryMechanism.java:1050)
    at org.eclipse.persistence.queries.UpdateObjectQuery.executeCommitWithChangeSet(UpdateObjectQuery.java:84)
    at org.eclipse.persistence.internal.queries.DatabaseQueryMechanism.executeWriteWithChangeSet(DatabaseQueryMechanism.java:287)
    at org.eclipse.persistence.queries.WriteObjectQuery.executeDatabaseQuery(WriteObjectQuery.java:58)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:844)
    at org.eclipse.persistence.queries.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:743)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWorkObjectLevelModifyQuery(ObjectLevelModifyQuery.java:108)
    at org.eclipse.persistence.queries.ObjectLevelModifyQuery.executeInUnitOfWork(ObjectLevelModifyQuery.java:85)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2871)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1516)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1498)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1449)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitChangedObjectsForClassWithChangeSet(CommitManager.java:265)
    at org.eclipse.persistence.internal.sessions.CommitManager.commitAllObjectsWithChangeSet(CommitManager.java:128)
    at org.eclipse.persistence.internal.sessions.AbstractSession.writeAllObjectsWithChangeSet(AbstractSession.java:3799)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabase(UnitOfWorkImpl.java:1415)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitToDatabase(RepeatableWriteUnitOfWork.java:636)
    ... 130 more
|#] 
```

数据只是首先读取以显示在 jsf 数据表中的网页上，可以在其中选择和编辑它。我知道没有其他线程在运行，这不仅用于编辑以前存储的记录，甚至创建新记录也会抛出同样的例外。我知道代码没有问题，因为我所有的队友都没有这个问题。我是团队的新手。我的应用程序在每个地方都会发生这种情况，无论是创建新记录还是修改现有记录。我试图调试，但我能达到的深度是 entityManager.persist(entity); 此时它会引发异常。有什么方法可以深入潜水吗？我认为这里不需要任何代码示例，因为每个使用此代码的人都没有这个问题。我从我的团队收到了现成的代码并进行了设置。问题的原因可能是什么？如果需要其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-03T12:26:09.140

问题是我使用的驱动程序。它有一个日期处理错误。我们在数据库中使用日期作为版本。我更新了我的 jdbc 驱动程序，一切都开始工作了。

# c# - C# 中的列表字符串列表视图显示错误

> ID：15666703
> 
> 赞同：3
> 
> 时间：2013-03-27T18:32:44.153
> 
> 标签：c#, winforms, listview, outofrangeexception

我在 C# WinForms 中有一个 listView1，它显示 2 个列表

```
List<string> pths;
List<string> rec;

public void Disp ()
        {

            DisplayListInColumns(listView1, pths, 0);
            DisplayListInColumns(listView1, rec, 1);
        }
private static void DisplayListInColumns(ListView listView, List<string> values, int columnIndex)
        {
            for (int index = 0; index < values.Count; index++)
            {
                while (index >= listView.Items.Count)
                {
                    listView.Items.Add(new ListViewItem());
                }
                ListViewItem listViewItem = listView.Items[index];
                while (listViewItem.SubItems.Count <= columnIndex)
                {
                    listViewItem.SubItems.Add(new ListViewItem.ListViewSubItem());
                }
                listViewItem.SubItems[columnIndex].Text = values[index];
            }
        } 
```

我正在使用全局列表进行更改并将其显示在 listview1 中，但只有在用户单击 apply_button 后才会保存更改（保存到 xml）。

编辑和添加详细信息按钮工作正常并且显示完美。但是当我删除数据时，我会抛出一个错误。

以下是删除操作：

```
//Configuration - DELETE button
        private void button6_Click(object sender, EventArgs e)
        {
            string select = null;

            if (listView1.SelectedItems.Count > 0)
            {
                select = (listView1.SelectedItems[0].Text);
            }
            int count = listView1.SelectedItems[0].Index;

            if (select != null)
            {
                pths.RemoveAt(count);
                rec.RemoveAt(count);
                string s = String.Join("; ", pths.ToArray());
                string r = String.Join("; ", rec.ToArray());
                //MessageBox.Show(s);
                //MessageBox.Show(r);                                
            }
            Disp();
        } 
```

我认为经过几次尝试，我的索引出错了。即使在删除之后，在调试时我`listView.Items.Count = 5.` 猜我猜计数仍然是 5（列表中的样本 - 5 个字符串），当删除后它应该减少到 4 并且索引相应地减少到 0-3。我收到以下错误

```
ArgumentOutOfRangeException at pths.RemoveAt(count)
Index was out of range. Must be non-negative and less than the size of the collection.
Parameter name: index 
```

作为替代我尝试`pths.Remove(select);`但没有解决这个问题。

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:36:18.317

更改您的 if 语句

```
if (select != null) 
```

对此

```
if(!string.IsNullOrWhiteSpace(select)) 
```

您的 text 属性不会为空，它将是空字符串，因此当您认为自己不是时，您正在输入该部分。

编辑：

根据您的评论，我将引导您使用此解决方案，将您的整个删除功能替换为以下内容：

```
private void button6_Click(object sender, EventArgs e)
{
  foreach (ListViewItem eachItem in listView1.SelectedItems)
  {
    listView1.Items.Remove(eachItem);
    if (pths.Any(o => o == eachItem.Text))
    {
        pths.Remove(eachItem.Text);
    }
    if (rec.Any(o => o == eachItem.Text))
    {
        rec.Remove(eachItem.Text);
    }
  }
} 
```

您可能需要 eachItem.Value ，但我认为 .Text 会起作用。

注意：我绝对只是从这里复制的这个答案（我不相信这个解决方案）：

[从 ListView 中删除所选项目](https://stackoverflow.com/questions/1425623/remove-the-selected-item-from-listview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:47:40.440

在尝试`SelectedItem`将其从`List`.

```
 private void button6_Click(object sender, EventArgs e)
    {
        string select = (listView1.SelectedItems.Count > 0) ? (listView1.SelectedItems[0].Text) : null;
        if (!string.IsNullOrWhiteSpace(select))
        {
            listView1.BeginUpdate();
            pths.Remove(select);
            rec.Remove(select);
            listView1.EndUpdate();

            string s = String.Join("; ", pths.ToArray());
            string r = String.Join("; ", rec.ToArray());                     
        }
        Disp();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T12:04:07.853

听起来你只需要重新加载你的列表......

```
//Clear it
listView1.Items.Clear();
//reload it.
listView1.Refresh(); 
```

# performance - 排序算法效率/性能

> ID：15666711
> 
> 赞同：3
> 
> 时间：2013-03-27T18:33:01.603
> 
> 标签：performance, algorithm, sorting, bubble-sort, memory-efficient

我是编程的初学者，只是在玩排序并制作了这个算法。它类似于气泡，但它不是比较相邻的对，而是比较像：第一和第二，第一和第三......第二和第三，第二和第四等等。你能告诉我算法的性能/效率是什么，或者将它与气泡进行比较吗？或者至少建议我如何自己解决问题。我感兴趣的是有多少泡沫比这个更好。谢谢你。

```
void sortArray(int a[]) {

int q, x, temp;

for ( q = 0; q < SIZE - 1; q++ ) {
    for ( x = q + 1; x < SIZE; x++ ) {
        if (a[q] < a[x]) {
            temp = a[q];
            a[q] = a[x];
            a[x] = temp;
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:08:33.940

您的排序类似于经典冒泡排序，并且应该具有基本相同的性能。

您的排序和冒泡排序都可以被视为选择排序的低效版本。对于所有三种算法，内部循环的每次遍历都会遍历数组的未排序区域，找到最小/最大元素，并将其留在最终位置。这些算法并不相同，因为它们在未排序的区域上执行不同的排列——但是，这种差异在功能上对算法的操作没有贡献。

一旦你认识到这一点，就很容易理解为什么选择排序比其他两种排序具有常数因子优势：其内部循环的每一次通过都需要最少的交换次数（即，最后一次）。相比之下，冒泡排序和你的排序最终可能会在每次内部循环*迭代*中进行一次交换......

然而，渐近地，所有三种类型都将花费 O(N^2) 时间——具体来说，将有`N*(N-1)/2`内部循环的迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:13:54.480

简短的回答-您的算法具有复杂性 O(n ² )-就像冒泡排序一样，即两种算法的复杂性基本相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:08:04.387

@Kevin 在外循环的第 n 次迭代中说前 n 个元素处于正确位置时是对的。传统的冒泡排序（比较和交换相邻元素）也可以做到这一点，但它的优点是它也对列表中的其他项目进行部分排序，从而增加了在所有迭代完成之前对列表进行排序的机会（当在排序可以完成的外循环迭代期间未检测到交换）。

# ios - ipa 无法从 iTunes 同步到设备

> ID：15666712
> 
> 赞同：2
> 
> 时间：2013-03-27T18:33:04.887
> 
> 标签：ios, xcode, installation

当我尝试通过 xcode 直接安装时，应用程序将安装在设备中。当我尝试从 iTunes 同步 ipa 或应用程序文件同步时。应用程序未安装在设备中。而不是安装应用程序状态将是“将安装”

我不明白。是否有任何证书问题？

我附上了图片文件链接以供详细了解

[https://skydrive.live.com/?cid=eb7f2f7c40e359ee#cid=EB7F2F7C40E359EE&id=EB7F2F7C40E359EE!499](https://skydrive.live.com/?cid=eb7f2f7c40e359ee#cid=EB7F2F7C40E359EE&id=EB7F2F7C40E359EE!499)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:18:04.953

尝试使用 iPhone 配置实用程序安装 ipa

[http://support.apple.com/kb/dl1465](http://support.apple.com/kb/dl1465)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:34:31.457

单击 iTunes 底部的**应用/同步**按钮。

**第 1步**：单击您需要同步的应用程序的**安装**按钮（状态将更改为“将安装”）

**第二步**：点击**应用/同步**。

而已。

# facebook - 用户允许我的应用程序有哪些权限

> ID：15666714
> 
> 赞同：0
> 
> 时间：2013-03-27T18:33:07.257
> 
> 标签：facebook, facebook-graph-api

我正在寻找有关查看用户实际允许应用程序的权限的文档。我可以使用“已安装”字段 (/[UID]?fields=installed) 来查看应用程序是否已安装，但它只是一个布尔值。没有关于允许的实际权限的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:41:53.433

使用 /[UID]/permissions 获取权限列表。

例如[https://graph.facebook.com/me/permissions](https://graph.facebook.com/me/permissions)

您还可以按字段限制

# midi - 我被一个简单的 MIDI 程序困住了

> ID：15666721
> 
> 赞同：0
> 
> 时间：2013-03-27T18:33:24.233
> 
> 标签：midi, coremidi

我的目标是编写一个像这样的简单（控制台）程序：

1.  从 MIDI 输入获取 MIDI 信息
2.  修改消息（或添加消息）
3.  将消息写入 MIDI 输出

由于我对 C++ 完全陌生，并且距离我上次编写一些 C 代码已经 15 年了，所以我搜索了一段时间，发现了我认为的 RtMidi ( [http://www.music.mcgill.ca/~gary/rtmidi/](http://www.music.mcgill.ca/~gary/rtmidi/) )可以帮助我达到我的目标。

我正在使用 Xcode 进行编译和处理。

我还认为使用回调函数是有意义的。

RtMidi 的代码开箱即用。我可以打开虚拟 MIDI 端口，并将我的 MIDI 消息输入到回调函数中，然后将其输出到控制台。

但是现在我被困住了，因为我还不了解回调实现的工作原理（我认为）。

我的问题是：

*   我是否必须在回调函数中修改 MIDI 消息？
*   如果是，我如何从回调函数中写入 MIDI？
*   如果不是：如何将 MIDI 消息放入我的 cpp 代码中（可能通过将指针传递给用户数据字段）？
*   但是，当消息到达回调函数时，我的主要代码是如何触发来处理消息的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:49:55.967

好的 - 已解决。

我肯定缺乏对 C++ 的理解……我指定了一个指针而不是一个变量。

马特

# c - 一个简单的功能需要用 10 种不同的方式实现

> ID：15666722
> 
> 赞同：0
> 
> 时间：2013-03-27T18:33:33.183
> 
> 标签：c, ruby

我需要一个函数，它可以在给定 7 时返回 5，并且在给定 5 时可以返回 7。但不允许使用条件语句。我需要通过 10 种不同的技术（都没有条件语句）。

但是，我已经以 5 种不同的方式实现了。如果你帮我写其他5个，那将是一种乐趣:)

```
int returner( int input ) {
    return 12 - input;
}

int returner( int input ) {
    if(input != 0) {
        return 35 / input;
    }
    return 0;
}

int returner( int input ) {
    return input ^= 2;
}

int returner( int intput ) {
    return ( 7 % input ) + 5;
} 
```

最后，在红宝石中

```
def returner(input)
    return ([5,7]-[input]).pop
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:59:19.357

这里还有5个：

```
p RUBY_VERSION
require 'set'

def fun1(x)

 [5,7].to_set.delete(x).to_a[0]

end

p fun1(7)

def fun2(x)

 a = [5,7].to_set
 b = [x].to_set
 p a.difference(b).to_a[0]

end

fun2(5)

def fun3(x)

 a = [5,7]
 a.slice!(a.index(x),1)
 p a[0]

end

fun3(5)

def fun4(x)
 a = [5,7]
 a.delete(x)
 p a[0]
end

fun4(5)

def fun5(x)

 a = '57'
 a = a.rpartition(7.to_s)
 p a[a.index(7.to_s)].to_i

end

fun5(7) 
```

*输出：*

```
"2.0.0"
5
7
7
7
5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T19:08:19.230

我不认为这是一个很好的问题，但我认为有机会在这里学习一些不同的想法。`i`代表输入。尝试以下操作，`i=7`然后将“其他任何内容”作为输入。请注意，这些方法都没有对输入值使用数学。

*注意：需要对这些进行调整以返回逆*-作为练习。

哈希。默认情况下，失败的查找返回`nil`。可以使用 指定默认值[`Hash.new`](http://ruby-doc.org/core-2.0/Hash.html)。

```
h = {7: 5}
h[i] // 5 or nil

h = Hash.new(0)
h[7] = 5
h[i] // 5 or 0 
```

[数组](http://www.ruby-doc.org/core-2.0/Array.html)枚举方法 - 学习它们。在这里，我们只计算存在多少特定值 (7) 的元素。

```
a = [7,7,7,7,7]
a.grep {|x| x == i }.count  // 0 or 5
// or more idiomatic
a.count(i) 
```

布尔运算符链接 - 和的结果`&&`是`||`成功的表达式或“最少失败”的表达式。

```
i == 7 && 5        // false or 5
(i == 7 && 5) || 0 // 0 or 5 
```

错误使用[throw/catch](http://phrogz.net/ProgrammingRuby/tut_exceptions.html)和内联异常填充。

```
catch (:"7") do
    throw i.to_s.to_sym rescue nil;
    // only here if i is not 7 or convertible to "7" AND
    // there is no matching catch further up
    return 0
end
return 5 
```

在类似的说明中，如何在没有`if`. 当然，如果函数域*只有*{5, 7}，那么即使这也不是必需的，因为 0 永远不可能是 [有效] 输入 - 并且无效输入在方法合同之外。

```
return (35 / i rescue 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:56:34.637

我可以使用逻辑运算符及其排序电路行为再贡献两种方法：

**首先**，它自己的：

```
int r(char x){
    (x == 7 && (x=5)) || ( (x == 5) && (x=7));
    return x;
}
int main(){
    printf("\n If r(5) then return = %d", r(5));
    printf("\n If r(7) then return = %d", r(7));

    printf("\n");
    return 1;
} 
```

跑：

```
$ ./a.out 

 If r(5) then return = 7
 If r(7) then return = 5 
```

**其次，**几天前我看到了这个技巧：

```
int r(char x){                      
    int l[8] = {0,0,0,0,0,7,0,5};
    return l[x];
} 
```

**第三**：我第一次使用的技巧使用

```
int r(char x){
    (x > 5 && (x=5)) || (x < 7 && (x=7));
    return x;
} 
```

**第四**：

```
int r(char x){
    ((x & 2) && (x&=~2)) || ( (!(x & 2)) && (x|=2));
    return x;
} 
```

**五十**：你自己的异或

```
int r(int x){
    x = (x & ~2) | (~x & 2) ;
    return x;
} 
```

# actionscript-3 - AS3 : #1009: 无法访问空对象引用的属性或方法

> ID：15666726
> 
> 赞同：0
> 
> 时间：2013-03-27T18:33:40.433
> 
> 标签：actionscript-3, flash, actionscript, air

我想就我的代码寻求您的帮助。它编译正常，但在达到以下代码时会引发此错误：

> 错误 #1009：无法在 HiddenObjects_fla::MainTimeline/myFunction()[HiddenObjects_fla.MainTimeline::frame12:9] 访问空对象引用的属性或方法

我的主时间线中没有第 12 帧。

```
import flash.display.Sprite;
import flash.events.*;

addEventListener(Event.ENTER_FRAME,myFunction);
function myFunction(event:Event):void {
var lazania:int = 0;
typewriter_piece1.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
typewriter_piece1.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
typewriter_piece2.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2); 
typewriter_piece2.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
typewriter_piece3.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
typewriter_piece3.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
typewriter_piece4.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
typewriter_piece4.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
typewriter_piece5.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
typewriter_piece5.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
typewriter_piece6.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
typewriter_piece6.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
stop();

//typewriter piece 1 = K 
function start_drag_piece1(event:MouseEvent):void{
typewriter_piece1.startDrag();
};
function stop_drag_piece1(event:MouseEvent):void{
if (Target1.hitTestObject(typewriter_piece1.Target1_Button)){
    typewriter_piece1.stopDrag();
    typewriter_piece1.x = Target1.x;
    typewriter_piece1.y = Target1.y;
    typewriter_piece1.mouseEnabled = false;
    typewriter_piece1.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }
    //checklazania(lazania);
}
else{
    typewriter_piece1.x = 25;
    typewriter_piece1.y = 139,95;
    typewriter_piece1.stopDrag();
}
};

//typewriter piece 2 = Y 
function start_drag_piece2(event:MouseEvent):void{
typewriter_piece2.startDrag();
};
function stop_drag_piece2(event:MouseEvent):void{
if (Target2.hitTestObject(typewriter_piece2.Target2_Button)){
    typewriter_piece2.stopDrag();
    typewriter_piece2.x = Target2.x;
    typewriter_piece2.y = Target2.y;
    typewriter_piece2.mouseEnabled = false;
    typewriter_piece2.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }
    //checklazania(lazania);

}
else{
    typewriter_piece2.x = 25;
    typewriter_piece2.y = 179,95;       
    typewriter_piece2.stopDrag();
}
};

//typewriter piece 3 = Π
function start_drag_piece3(event:MouseEvent):void{
typewriter_piece3.startDrag()
};
function stop_drag_piece3(event:MouseEvent):void{
if (Target3.hitTestObject(typewriter_piece3.Target3_Button)){
    typewriter_piece3.stopDrag();
    typewriter_piece3.x = Target3.x;
    typewriter_piece3.y = Target3.y;
    typewriter_piece3.mouseEnabled = false;
    typewriter_piece3.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }
    //checklazania(lazania);
}
else{
    typewriter_piece3.x = 25;
    typewriter_piece3.y = 219,95;       
    typewriter_piece3.stopDrag();
}
};

//typewriter piece 4 = P
function start_drag_piece4(event:MouseEvent):void{
typewriter_piece4.startDrag()
};
function stop_drag_piece4(event:MouseEvent):void{
if (Target4.hitTestObject(typewriter_piece4.Target4_Button)){
    typewriter_piece4.stopDrag();
    typewriter_piece4.x = Target4.x;
    typewriter_piece4.y = Target4.y;
    typewriter_piece4.mouseEnabled = false;
    typewriter_piece4.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }   
    //checklazania(lazania);
}
else{
    typewriter_piece4.x = 25;
    typewriter_piece4.y = 259,95;
    typewriter_piece4.stopDrag();
}
};

//typewriter piece 5 = O
function start_drag_piece5(event:MouseEvent):void{
typewriter_piece5.startDrag()
};
function stop_drag_piece5(event:MouseEvent):void{
if (Target5.hitTestObject(typewriter_piece5.Target5_Button)){
    typewriter_piece5.stopDrag();
    typewriter_piece5.x = Target5.x;
    typewriter_piece5.y = Target5.y;
    typewriter_piece5.mouseEnabled = false;
    typewriter_piece5.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }
    //checklazania(lazania);
}
else{
    typewriter_piece5.x = 25;
    typewriter_piece5.y = 299,95;

    typewriter_piece5.stopDrag();
}
};

//typewriter piece 6 = Σ
function start_drag_piece6(event:MouseEvent):void{
typewriter_piece6.startDrag()
};
function stop_drag_piece6(event:MouseEvent):void{
if (Target6.hitTestObject(typewriter_piece6.Target6_Button)){
    typewriter_piece6.stopDrag();
    typewriter_piece6.x = Target6.x;
    typewriter_piece6.y = Target6.y;
    typewriter_piece6.mouseEnabled = false;
    typewriter_piece6.mouseChildren = false;
    lazania++;
    if(lazania == 6){
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
        typewriter_piece1.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2);
        typewriter_piece2.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
        typewriter_piece3.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
        typewriter_piece4.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
        typewriter_piece5.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
        typewriter_piece6.removeEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
        gotoAndStop(1, "Scene 5");
    }
    //checklazania(lazania);
}
else{
    typewriter_piece6.x = 25;
    typewriter_piece6.y = 339,95;
    typewriter_piece6.stopDrag();
}
};

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:03:35.483

你的问题可能是这样的：

```
addEventListener(Event.ENTER_FRAME,myFunction); 
```

即使您调用`stop()`，您`myFunction`将根据您的应用程序帧速率继续每帧运行一次。因此，如果您将帧速率设置为 24，则 myFunction 每秒运行 24 次。这意味着您每秒钟一次又一次地添加所有这些侦听器 24 次。（假设你`myFunction`在那些鼠标事件监听器之后结束，你错过了结束`}`，所以我不得不猜测）。

您也永远不会删除该`ENTER_FRAME`侦听器，因此即使您转到程序的另一部分（通过您的`gotoAndStop`线路），它`myFunction`仍将继续每秒被调用 24 次。1009 错误很可能是因为您已移至`typewriter_piece`实例不再存在的另一个框架，但 ENTER_FRAME 处理程序仍在一遍又一遍地运行该函数。

采取以下代码：

```
typewriter_piece1.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece1);
typewriter_piece1.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece1);
typewriter_piece2.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece2); 
typewriter_piece2.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece2);
typewriter_piece3.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece3);
typewriter_piece3.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece3);
typewriter_piece4.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece4);
typewriter_piece4.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece4);
typewriter_piece5.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece5);
typewriter_piece5.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece5);
typewriter_piece6.addEventListener(MouseEvent.MOUSE_DOWN, start_drag_piece6);
typewriter_piece6.addEventListener(MouseEvent.MOUSE_UP, stop_drag_piece6);
stop(); 
```

在 myFunction 之外（所以它只在框架上运行），并删除 ENTER_FRAME 侦听器代码行。

* * *

作为效率和理智的提示，请尝试执行以下操作：

```
//This will add all your listeners with just 3 lines of code
for(var i:int=1;i<7;i++){
    this["typewriter_piece"+i].addEventListener(MouseEvent.MOUSE_DOWN, startDrag);
}

//you can use the same drag handler function, and get the item with event.currentTarget
function startDrag(event:MouseEvent):void {
    var typewriter:MovieClip = event.currentTarget as MovieClip; //gets the one that was clicked/mouse downed

    var target:MovieClip = getTarget(typewriter); //get the appropriate target

    if(target.hitTestObject(typewriter)){
        typewriter.stopDrag();
        //do the rest
    }
}

//get the appropriate target
function getTarget(typeWriter:MovieClip):MovieClip {
    for(var i:int=1;i<7;i++){
        if(typeWriter == this["typewriter_piece"+i]){
            return this["Target"+i];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:43:03.330

尝试删除 myfunction 函数。只要它是一个函数，它对整个程序都是有效的。如果你把它拿出来，它只适用于特定的框架。这样程序就不会在您搬出后立即询问、检查或打扰此代码。由于代码顶部的 enter frame 命令，它会在您进入框架后立即生效。让其他一切保持原样......很高兴看到解决方案有效！:p

# android - 更新sdk后没有广告

> ID：15666736
> 
> 赞同：0
> 
> 时间：2013-03-27T18:33:58.013
> 
> 标签：android, admob

我使用 admob 已经一年多了，但是自从我更新了 sdk 后，我无法获得广告。所以，我客人说我可能做错了什么..我下载了新的 sdk，添加到我的应用程序中，然后放置了以下代码进入我的 xml 文件

```
 <com.google.ads.AdView
        xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
        android:id="@+id/adView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10px"
        ads:adSize="BANNER"
        ads:adUnitId="a14d3813d4df3d5d" /> 
```

我的活动中的这段代码：

```
 AdView adView = (AdView)this.findViewById(R.id.adView);
                AdRequest adRequest = new AdRequest();
                adRequest.setTesting(true);
                 adView.loadAd(adRequest); 
```

我哪里错了？我可以再做点什么吗？非常感谢，我已经花了很多时间来解决它..:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:19:37.460

我注意到您正试图让 adview 在整个布局中独立运行。这不是推荐的方法。你应该把它放在一个相对布局中，然后试着把

```
android:layout_width="wrap_content"    
ads:adSize="SMART_BANNER" 
```

不确定它是否有足够的帮助。

# c++ - 多次读取txt

> ID：15666738
> 
> 赞同：1
> 
> 时间：2013-03-27T18:34:00.253
> 
> 标签：c++, text-files, iostream, fstream

我有一个使用 text_file 存储大量数字的程序。当我必须加载这些数字时，我必须一次加载 2500 个数字。我有一个while循环来一次又一次地加载它......

现在，我猜这个问题出现在while循环中。

```
ifstream mfile("abc.txt", ifstream::out);
if(mfile.is_open())
{
    getline(mfile, b);
    char* ch = new char[b.length() + 1];
    strcpy(ch, b.c_str());
    result = atof(strtok (ch,";"));
    while(i<125)
    {
        cout<< strtok (NULL,";")<<" ";
        i++;
    }
    i=0;
}
else
{
    cout<<"probleem";
}
mfile.close(); 
```

这是问题所在的更复杂代码的简短示例。

请注意，这段代码必须在 while 循环中。

但它只运行一次代码，可能是因为`mfile`不能多次使用。当我想多次读取文件时，有必要从上一次读取的末尾开始读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:39:31.193

```
 ifstream mfile("abc.txt", ifstream::out);  // why out ?? 
```

--->

```
 ifstream mfile("abc.txt");
  if(mfile.is_open())
 {  while(getline(mfile, b))
    {   char* ch = new char[b.length() + 1];
        strcpy(ch, b.c_str());
        result = atof(strtok (ch,";"));
        while(i<125)
        {    cout<< strtok (NULL,";")<<" ";
          i++;
        }
        i=0;
    }
 }
 else     {     cout<<"probleem";      }
 mfile.close(); 
```

您也可以组合[`streampos tellg();`](http://www.cplusplus.com/reference/istream/istream/tellg/)和`seekg(pos)`

编辑：

[`istream& getline (istream& is, string& str);`](http://www.cplusplus.com/reference/string/string/getline/)

will return `mfile`，其中`while(mfile)`will 被隐式转换为 a `bool`，因此有效地迭代直到无法再读取任何字符串，通常在文件末尾。

# mysql - MYSQL JOINING 三张表（一张是自己）

> ID：15666745
> 
> 赞同：0
> 
> 时间：2013-03-27T18:34:10.987
> 
> 标签：mysql

我终于能够让这个（下面的第一个）查询工作，它给了我 action_list_table 的行，它具有最大的 action_id 值（所以它给了我每个用户输入的这个表上的最后一个“动作”）

现在我需要用我的 MAIN_TABLE 加入它，这样我也可以从中提取信息（名称等）

```
SELECT * FROM `action_list_table` a  

LEFT OUTER JOIN `action_list_table` b
ON (a.`record_id` = b.`record_id` AND a.`action_id` < b.`action_id`) 
WHERE a.`record_id` = '".$ID."' AND b.`record_id` IS NULL" 
```

我厌倦了这个，但它没有用，我确定我对于如何加入 3 个表（或者在这种情况下将一个表加入自身，然后加入另一个表......）

```
"SELECT * FROM `action_list_table` a  

LEFT OUTER JOIN `MAIN_TABLE`
ON a.`record_id` = `MAIN_TABLE.ID`

LEFT OUTER JOIN `action_list_table` b
ON (a.`record_id` = b.`record_id` AND a.`action_id` < b.`action_id`) 
WHERE b.`record_id` IS NULL"); 
```

同样，我试图：在每个用户的操作表中找到行（具有最高 action_id 的用户（这将是自自动递增以来创建的最后一个），然后还从 MAIN_TABLE 中提取一些列其中 action_list_table 上的 ID (record_id) = MAIN_TABLE 上的 ID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:40:36.753

如果您的查询以您需要的方式工作，则加入 main_table 的一种选择是将其放入子查询中，然后进行联接：

```
SELECT * 
FROM (
    SELECT a.* 
    FROM `action_list_table` a  
        LEFT OUTER JOIN `action_list_table` b
            ON (a.`record_id` = b.`record_id` AND a.`action_id` < b.`action_id`) 
    WHERE a.`record_id` = '".$ID."' AND b.`record_id` IS NULL
   ) tablealias  
       LEFT JOIN `MAIN_TABLE`
           ON tablealias.`record_id` = `MAIN_TABLE`.`ID` 
```

或者，我不确定你为什么需要子查询——你应该能够加入所有三个表：

```
SELECT * 
FROM `action_list_table` a  
     LEFT OUTER JOIN `action_list_table` b
         ON (a.`record_id` = b.`record_id` AND a.`action_id` < b.`action_id`) 
     LEFT JOIN `MAIN_TABLE`
           ON a.`record_id` = `MAIN_TABLE`.`ID`
WHERE a.`record_id` = '".$ID."' AND b.`record_id` IS NULL 
```

最后，正如其他人所建议的，您可以使用 MAX(Action_ID) 加入：

```
SELECT * 
FROM `action_list_table` a  
     INNER JOIN 
         (SELECT MAX(Action_ID) max_action_id, Record_ID
          FROM action_list_table
          GROUP BY Record_ID) t 
           ON a.action_id = t.max_action_id and a.record_id = t.record_id
     LEFT JOIN `MAIN_TABLE`
           ON a.`record_id` = `MAIN_TABLE`.`ID`
WHERE a.`record_id` = '".$ID."' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:43:10.180

您可以通过使用简单的 GROUP 语句来更简单地执行此操作来获取必要的信息，即

```
SELECT
    *,
    MAX(a.action_id) AS last_action_id
FROM MAIN_TABLE mt
INNER JOIN action_list_table a
ON a.record_id = mt.ID
GROUP BY mt.id 
```

不过，这只会为您提供表格中 action_id 的正确值`a`。如果你想变得更聪明，你可以使用子查询首先只从 action_list_table 获取感兴趣的记录加入到 MAIN_TABLE

```
SELECT
    a.*,
    MAX(a.action_id) AS last_action_id
FROM MAIN_TABLE mt

INNER JOIN (
    SELECT
        *
    FROM (
        SELECT 
            *
        FROM action_list_table
        ORDER BY action_id DESC
    ) o
    GROUP BY o.record_id
) a 
ON a.record_id = mt.ID 
```

# c# - 扩展器关闭时缩小窗口大小

> ID：15666746
> 
> 赞同：1
> 
> 时间：2013-03-27T18:34:14.903
> 
> 标签：c#, wpf, xaml, window-resize, expander

嘿伙计们，我有 3 个列扩展器，当您将它们全部打开并调整窗口大小时，它们会正确拉伸以适应窗口。当您关闭扩展器时，我希望它在打开时将窗口缩小该扩展器的宽度。它目前将扩展器关闭到 20 像素，但打开的扩展器会更大（它会拉伸以填充空白空间）。

代码：

```
<UserControls:ExpanderWindow x:Class="Lainezor.Windows.ExpanderWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:xt="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit.Extended"
    xmlns:pg="clr-namespace:Microsoft.Windows.Controls.PropertyGrid;assembly=WPFToolkit.Extended"
    xmlns:MyUserControls="clr-namespace:Lainezor.UserControls.ExpanderControls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    SizeToContent="WidthAndHeight" Background="AliceBlue" 
    ResizeMode="CanResize" WindowStartupLocation="Manual" Loaded="Window_Loaded">
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition>
            <ColumnDefinition.Style>
                <Style TargetType="ColumnDefinition">
                    <Setter Property="Width" Value="20" />
                    <Setter Property="MinWidth" Value="20" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsExpanded, ElementName=Expander1}" Value="True">
                            <Setter Property="Width" Value="20*" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ColumnDefinition.Style>
        </ColumnDefinition>
        <ColumnDefinition Width="2"/>
        <ColumnDefinition>
            <ColumnDefinition.Style>
                <Style TargetType="ColumnDefinition">
                    <Setter Property="Width" Value="20" />
                    <Setter Property="MinWidth" Value="20" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsExpanded, ElementName=Expander2}" Value="True">
                            <Setter Property="Width" Value="20*" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ColumnDefinition.Style>
        </ColumnDefinition>
        <ColumnDefinition Width="2"/>
        <ColumnDefinition>
            <ColumnDefinition.Style>
                <Style TargetType="ColumnDefinition">
                    <Setter Property="Width" Value="20" />
                    <Setter Property="MinWidth" Value="20" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsExpanded, ElementName=Expander3}" Value="True">
                            <Setter Property="Width" Value="20*" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ColumnDefinition.Style>
        </ColumnDefinition>
    </Grid.ColumnDefinitions> 
    <Grid.RowDefinitions>
        <RowDefinition Height="1*"/>
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Expander Name="Expander1" Grid.Column="0" IsExpanded="True" IsEnabled="True" ExpandDirection="Right">
        <Expander.Header>
            <TextBlock Text="{Binding Source={StaticResource ResourceWrapper}, Path=MyStrings.Expander1Label}"  RenderTransformOrigin="0,0" >
                <TextBlock.LayoutTransform>
                        <RotateTransform Angle="90"/>
                </TextBlock.LayoutTransform>
            </TextBlock>
        </Expander.Header>
        <MyUserControls:UserControl1 x:Name="UserControl1" SizeChanged="UserControl1_SizeChanged"/>
    </Expander>
    <GridSplitter x:Name="gridSplitter" Grid.Column="1" Width="2" Background="#CBE5FE" ResizeDirection="Columns" ResizeBehavior="PreviousAndNext" VerticalAlignment="Stretch" />
    <Expander Grid.Column="2" Grid.RowSpan="2" Name="Expander2" ExpandDirection="Right" Grid.IsSharedSizeScope="True">
        <Expander.Header >
            <TextBlock Text="{Binding Source={StaticResource ResourceWrapper}, Path=MyStrings.Expander2Label}">
                <TextBlock.LayoutTransform>
                        <RotateTransform Angle="90" />              
                </TextBlock.LayoutTransform>
            </TextBlock>
        </Expander.Header>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <MyUserControls:UserControl2 x:Name="UserControl2" HorizontalAlignment="Stretch"/>
        </Grid>
    </Expander>
    <GridSplitter x:Name="gridSplitterTwo" Grid.Column="3" Width="2" Background="#CBE5FE" ResizeDirection="Columns" ResizeBehavior="PreviousAndNext"  VerticalAlignment="Stretch" />
    <Expander Grid.Column="4" Grid.RowSpan="2" Name="Expander3" ExpandDirection="Right">
        <Expander.Header >
            <TextBlock Text="Lainezor">
                <TextBlock.LayoutTransform>
                        <RotateTransform Angle="90" />              
                </TextBlock.LayoutTransform>
            </TextBlock>
        </Expander.Header>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <MyUserControls:UserControl3 x:Name="UserControl3" HorizontalAlignment="Stretch" />
        </Grid>
    </Expander>
</Grid> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T18:57:33.890

将`SizeToContent`Window 设置为`"WidthAndHeight"`并且不设置它的`Width`or`Height`或 designWidth 或 designHeight。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T19:49:28.223

将事件处理程序附加到展开器的折叠事件并`((Expander)sender).ActualWidth -20`从窗口宽度中减去

# php - 我的正则表达式不适用于最大限制

> ID：15666748
> 
> 赞同：0
> 
> 时间：2013-03-27T18:34:16.890
> 
> 标签：php, regex

您好，我有一个正则表达式，它几乎可以接受每个字符，包括特殊字符。我已将其设置为接受最少 8 个和最多 30 个字符。一切都适合最低限度，但它不能最大限度地发挥作用。

如果字符串大于 30 或任何长度。结果是真的。

模式在这里：

```
 $pattern = '/[A-Za-z0-9' . preg_quote( '.%^&()$#@!/-+/', '/') . ']{8,30}/'; 
```

整个测试代码为：

```
 $pattern = '/^[A-Za-z0-9' . preg_quote( '.%^&()$#@!/-+/', '/') . ']{8,30}$/';

 if(preg_match($pattern, $pass))
   {
     echo '<br>true';
   }
 else
   {
 echo '<br>false';
    }

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:36:45.737

这将匹配字符串中最多 30 个字符的任何字符串。您需要包括字符串的开头和结尾：

```
$pattern = '/^[A-Za-z0-9' . preg_quote( '.%^&()$#@!/-+/', '/') . ']{8,30}$/'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:02:08.420

您问题中的第一个`$pattern`表达式缺少必需的：`^`以及行首`$` *和行尾断言*- （但下面的示例代码片段正确使用了它们。）

您还需要转义字符类中的破折号/连字符 - 连字符定义了一系列字符。（请注意，正斜杠`/`不是转义字符！）试试这个：

```
$pattern = '/^[A-Za-z0-9.%^&()$#@!\-+\/]{8,30}$/'; 
```

# hadoop - Hive 表的名称现在是保留关键字

> ID：15666749
> 
> 赞同：7
> 
> 时间：2013-03-27T18:34:23.503
> 
> 标签：hadoop, hive

我的一个 hive 表有一个名为“location”的列，它现在是一个保留关键字。我想在开发中创建表的副本，有没有办法在创建表语句期间绕过名称？如果我做类似的事情

```
CREATE TABLE users (id int, location string); 
```

我懂了：

```
FAILED: Parse Error: line 1:0 mismatched input ''location'' expecting Identifier near ',' in column specification 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T20:18:47.653

弄清楚了：

```
CREATE TABLE users (`id` int, `location` string); 
```

# asp.net - 检查 ASP.Net 网站是否设置为调试配置

> ID：15666770
> 
> 赞同：0
> 
> 时间：2013-03-27T18:35:22.227
> 
> 标签：asp.net

从一位渗透测试人员那里获得了一份公司网站列表，该列表已确定它们是在调试模式下发布的。我正在寻找确认调试模式已更改为发布模式，但无权访问产品服务器。

我可以简单地尝试访问一个不存在的页面来确认调试模式是打开还是关闭？我假设如果我处于调试模式，我会得到“'/'应用程序中的服务器错误”，如果我处于发布模式，我将被重定向到错误页面>

谢谢，

克里斯

# php - Javascript 访问 PHP 信息

> ID：15666771
> 
> 赞同：-2
> 
> 时间：2013-03-27T18:35:22.887
> 
> 标签：php, javascript, ajax, dom, modal-dialog

我希望为日历程序生成由 Javascript 生成的模态窗口，其作用类似于工具提示（在事件链接上挥动鼠标指针，您会得到一个描述事件的模态弹出窗口）。事件存储在 MySQL 中，由 PHP 访问。

根据我正在阅读的内容，我可以通过两种方式将该信息放入我的 Javascript 模式弹出窗口中：

*   一个 Ajax 调用：编写一个 PHP 脚本来生成该信息，并在我打开模式窗口时使用 Ajax 调用它

*   让 PHP 为日历中的每个链接生成一个隐藏的模态窗口；Javascript 可以在打开模态窗口时激活相应的。

这些中的任何一个都不起作用，还是看起来像可怕的编程风格？我正在为一门课做准备（教而不是上课），所以我希望事情尽可能简单易读。无论在何种程度上，我都在使用 Javascript 和 DOM，而不是 jQuery 或 Ajax（但我会尽我所能让它工作。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:24:53.363

鼠标悬停时的 Ajax 调用使您能够在显示之间刷新模式窗口内容，因为每次鼠标悬停都会触发对该窗口内容的查询，并且您只会获得您专门查看的数据。但是，您不仅需要一个 php 脚本来生成日历，还需要以任何格式（xml、json、ical）返回单个事件数据并将其解释为内容。

隐藏的模式窗口只需要一个 php 脚本并且不需要 Ajax 调用。但是你得到的数据比你可以使用的多。

我建议使用第二种选择，除非您正在教授有关客户端/服务器模型、转换数据格式和 Ajax 的课程。

# api - 通过客户端的 GUI 测试 api

> ID：15666773
> 
> 赞同：0
> 
> 时间：2013-03-27T18:35:33.433
> 
> 标签：api, testing

我的老板想要一个基于 GUI 的 api 请求发送器 - 他最初要求已经存在的东西（所以我不必构建任何东西）

任何人都知道在线资源或工具可以让您在 10 分钟内发送 1000 个请求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:55:06.517

如果您谈论的是基于 Web 的 API，请查看 Apache JMeter ( [http://jmeter.apache.org/](http://jmeter.apache.org/) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-10T19:37:13.993

soundcloud 有一个很好的使用 apigee 的 api 控制台。[http://developers.soundcloud.com/console](http://developers.soundcloud.com/console)

# ms-access - 如何使用基于另一个字段选项的表中的信息更新字段

> ID：15666775
> 
> 赞同：0
> 
> 时间：2013-03-27T18:35:36.893
> 
> 标签：ms-access, ms-access-2007

我正在使用 Access 2007 构建数据库。我对 Access 没有太多经验，也不知道如何完成这项任务。

我已经建立了一个输入表单，并且有一个名为“产品”的字段，它是一个下拉列表，可以从产品表中提取信息。Product 表是这样设置的：

```
Product Name        Commodity
--------------------------------------------
Product #1          Soybean
Product #2          Soybean Meal
Product #3          Corn 
```

我在名为“HTS Commodity”的表单中有另一个字段，它是一个下拉列表，用于从 HTSUS 表中提取信息。此字段已锁定，我希望有人从“产品”字段中选择产品后自动更新该值。这是HTSUS表：

```
Commodity           HTSUS Value
--------------------------------------------
Soybean             1.1.1
Soybean Meal        2.2.2
Corn                3.3.3 
```

当一个人在“产品”字段中选择一个项目时，它会显示产品名称。一旦他们选择了该项目，我希望字段“HTS Commodity”根据表格中的 Commodity 列自动更新，但显示 HTSUS Value 列。

```
 Product: Product #2 (Soybean Meal)
HTS Commodity: 2.2.2 (Soybean Meal) 
```

我希望这是有道理的。我了解如何使用不同的构建器创建宏，但我只是不确定如何实现这一点。我一直在尝试使用 AfterUpdate() 宏。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:49:16.420

这是一种方法：

首先创建一个名为的已保存查询`HTSUS_by_Product`，其 SQL 代码为

```
SELECT Product.[Product Name], HTSUS.[HTSTS Value]
FROM Product INNER JOIN HTSUS ON Product.Commodity = HTSUS.Commodity; 
```

它会产生这样的结果

```
Product Name    HTSUS Value
------------    -----------
Product #1      1.1.1
Product #2      2.2.2
Product #3      3.3.3 
```

现在，在您的表单上，假设您有一个名为的组合框`cbxProductName`，它从 [Product] 表中的 [Product Name] 字段获取其值。当您从列表中选择“产品#1”时，`cbxProductName.Text`将是“产品#1”。

现在在表单上创建一个文本框并命名它`txtHtsus`。将其`Locked`属性设置为`Yes`，并输入以下内容作为其`Control Source`属性：

```
=DLookUp("[HTSUS Value]","HTSUS_by_Product","[Product Name]=""" & [cbxProductName].[Text] & """") 
```

现在，在组合框控件的`After Update`事件`cbxProductName`中，单击省略号按钮`[...]`，选择“代码生成器”，然后`.Requery`在过程中添加一条语句`cbxProductName_AfterUpdate()`，如下所示

```
Private Sub cbxProductName_AfterUpdate()
Me.txtHtsus.Requery
End Sub 
```

试一试，看看它是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:49:42.137

你需要使用我最喜欢的：dlookup

[http://allenbrowne.com/casu-07.html](http://allenbrowne.com/casu-07.html)

# javascript - 如何使用 javascript 从 xml 文件中提取 html 片段？

> ID：15666777
> 
> 赞同：0
> 
> 时间：2013-03-27T18:35:40.033
> 
> 标签：javascript, html, xml

我有 javascript 代码从 xml 文件中提取网页信息并生成 html 并插入数据。这很好用。

```
getElementsByTagName("XmlNode")[0].childNodes[0].nodeValue; 
```

当我将数据更改为 html 超链接块时，nodeValue 返回 null。

`<XmlNode><a href='URL'>URL text</a></XmlNode>`

是否有其他属性可用于返回此 XML 节点的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:58:55.223

我发现这样做：

```
var xmlSerializer = new XMLSerializer();
function innerXml(node)
{
return xmlSerializer.serializeToString(node)
} 
```

来源：[http ://forums.asp.net/t/1341879.aspx/1](http://forums.asp.net/t/1341879.aspx/1)

编辑：在做了更多研究之后，我实际上使用了这个：

```
function innerXml(node)
{
    var innerXml = "";
    var nodes = node.childNodes;
    for(q=0;q<nodes.length;q++)
    {
        if (typeof window.XMLSerializer != "undefined")
            innerXml += xmlSerializer.serializeToString(nodes[q]);

        else if (typeof nodes[q].xml != "undefined")
            innerXml += nodes[q].xml;
    }

    innerXml = innerXml.trim();

    return innerXml;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:45:24.397

您正在尝试获取 nodeValue`<a>`而不是其中的文本节点。您可以将另一个 .childNodes[0] 添加到链中以获取文本节点，也可以使用 .textContent 代替 .nodeValue

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:47:40.617

您应该使用 CDATA 在您的 XML 节点中保存标记。

```
<![CDATA[  html mark up  ]]>

<XmlNode><![CDATA[<a href='URL'>URL text</a>]]></XmlNode> 
```

# c# - 将实体类型映射到投影

> ID：15666781
> 
> 赞同：0
> 
> 时间：2013-03-27T18:35:54.570
> 
> 标签：c#, linq, entity-framework, entity

我正在阅读一个教程，他们说你不应该使用实体类型来映射到投影。所以这样的事情是不允许的（其中产品是一个实体创建的类）：

```
from p in db.Products
               where p.ProductID== ProductID
               select new Product { Name = p.Name}; 
```

因此，我将创建一个具有以下内容的新类：

```
public string Name { get; set; } 
```

然后使用这样的查询：

```
from p in db.Products
            where p.ProductID == ProductID
            select new SomeNewClassName { Name = p.Name }); 
```

这真的有必要吗，或者这只是额外的工作？如果我要创建这个类，它将拥有与我的实体对象完全相同的属性，那么重点是什么？如果需要，我对这个新类使用的命名约定是什么，因为它几乎与我的 Entity 类相同。我也不应该使用实体对象在 ASP.net MVC 项目中创建强类型视图吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T18:47:57.720

他们的意思是您不想使用实际的实体类型作为投影。例如，您不应该从 Person 实体投影到 Address 实体。

投影意味着您正在“塑造”与原始结果不同的结果。如果您只是返回原始实体，那么这不是投影。你只需这样做：

```
from p in db.Products
        where p.ProductID == ProductID
        select p; 
```

至于景色，没有。通常，您不应将实体直接传递给您的视图。有许多哲学和安全原因您不应该这样做，但在大多数情况下只是不这样做。如果您正在创建概念验证，或者它是一个微不足道的内部应用程序，您可能能够逃脱它，但任何面向互联网的应用程序都不应该。

您应该创建一个单独的视图模型，即使它与实体完全相同。我知道这是额外的工作，但从长远来看，这是有回报的，因为在某些时候你可能想要一个与你的实体不同的视图模型，然后你必须重新做更多的事情。

# asp.net-mvc - EditorFor 将值传递给 viewModel 中的 POST 控制器，但 DisplayFor 和 HiddenFor 没有？

> ID：15666785
> 
> 赞同：1
> 
> 时间：2013-03-27T18:35:57.747
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

在我看来，我有：

```
@Html.EditorFor(m => m.Contact, new{style="width: 650px"}) 
```

控制器：

```
[HttpGet]
        public ActionResult Backflip()
        {
            // TODO: Make sure name is what we expect
            var contact = getContact();
            return View(new BackflipViewModel(contact));
        }

 [HttpPost]
    public ActionResult Broadcast(BackflipViewModel vm)
    {... 
```

视图模型：

```
public class BackflipViewModel
{

    public BackflipViewModel()
    {
    }

    public BackflipViewModel(Contact contact)
    {
        Sender = contact;
    }

    public Contact Sender { get; set; }

} 
```

我真的只是想要一个 hiddenFor，但如果我尝试 @Html.HiddenFor(m => m.Sender)，我的 POST 控制器方法中的“vm”包含一个空值用于 Sender。DisplayFor 也一样。我怎样才能让 HiddenFor 工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:02:49.783

这是因为`HiddenFor`- 不像`EditorFor`- 不能为复杂对象生成一整组字段。

相反，您应该执行以下操作。

**查看模型**

```
public string SenderId { get; set; } 
```

**看法**

```
@Html.HiddenFor(m => m.SenderId) 
```

**控制器**

```
[HttpPost]
public ActionResult Broadcast(BackflipViewModel vm)
{
    If (ModelState.IsValid)
    {
        Sender sender = getContact(Model.SenderId);
    }
} 
```

# ruby-on-rails - 如何在 Rails 中处理非 gem 依赖项

> ID：15666795
> 
> 赞同：1
> 
> 时间：2013-03-27T18:36:22.247
> 
> 标签：ruby-on-rails

我有一个可能是愚蠢的问题。如果是，对不起。

我最近接手了一个 Rails 项目，该项目需要 PhantomJS 才能使其 Cucumber 场景正常运行。不幸的是，该应用程序并没有说它依赖于 PhantomJS，所以当场景失败时，它看起来就像坏了一样，而且还不清楚为什么。

使错误停止的唯一方法是做`brew install phantomjs`. 显然，这不是一个 gem，安装 PhantomJS gem 也没有做任何事情。

**在 Rails 项目中处理非 gem 依赖项的正确方法是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:55:10.897

我不相信有一个标准的方法。

PhantomJS 是一个独立的应用程序，需要单独安装。如果您的应用程序依赖于它，它与安装 redis 或 postgreSQL 相同。

不过，您使用自制软件安装是对的，这使得更新删除更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:17:34.333

这不是一件小事。AFAIK，没有内置实用程序来声明对宝石/红宝石以外的其他事物的依赖关系。Ruby 是一种解释型语言，因此可以在各种环境中运行；在这个级别管理依赖项将是一项相当复杂的任务。

许多人使用[capistrano](https://github.com/capistrano/capistrano)或[puppet](https://puppetlabs.com/puppet/what-is-puppet/)等**部署工具**来处理此问题，以确保运行应用程序的环境足够，并在需要时安装所需的依赖项。通常，您会创建一个 rake 任务来执行此操作，并通过 capistrano 调用它，或者让用户手动调用它。

如果你想警告人们依赖关系，一个选项是**使用初始化程序**来检查应用程序启动时所需的依赖项是否安装在环境中，如果没有则发出警告（或完全关闭应用程序）。

另一种选择只是将**依赖项检查作为一系列测试来执行**。因此，如果这些测试失败，您可以提供有关缺失内容的详细说明。

总而言之，您至少可以**在文档中列出环境依赖项**。确保这是在您的主要文档文件之上。

# html - 如何阻止 Gmail 从 URL 中删除值？

> ID：15666796
> 
> 赞同：13
> 
> 时间：2013-03-27T18:36:26.663
> 
> 标签：html, email, gmail

`target="_blank"`我最近了解到像 Gmail 这样的网络邮件客户端会对 HTML 电子邮件进行更改，例如添加`<a>`标签。

我还发现其他变化也会发生。当我从我的 PHP 脚本向 Gmail（可能还有其他 Web 邮件客户端）发送 HTML 电子邮件时，任何链接的 URL 中包含的变量值都被删除了。因此，例如，这是我在 PHP 代码中设置的值：

```
$mailContent = '<p><a target="_blank" href="https://example.com/confirmation.html?verification=x1x1x1x1x1x1x1x&email=yyyy@email.com">click here to go to the web site and activate your account!</a></p>'; 
```

但是当在 Gmail 中收到电子邮件时，HTML 代码如下所示：

```
<p><a target="_blank" href="https://example.com/confirmation.html?verification=&email=">click here to go to the web site and activate your account!</a></p> 
```

值`x1x1x1x1x1x1x1x`和`yyyy@email.com`已从`<a>`标签中删除。

如何保护要传递给 URL 的变量的值，以便 Gmail 不会删除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:00:44.763

在 Gmail 中的邮件上单击*查看原始/来源*，以查看 URL 是否看起来应该如此。如果是这样，您知道问题在于 Gmail 如何格式化邮件以供您查看。如果即使在源代码中也被肢解了，我想知道您的网页/php/CMS 中是否有任何更改代码的内容（您是否使用过）。

您应该按照@Crisp 所说[的那样尝试 URL 编码。](http://meyerweb.com/eric/tools/dencoder/)这是[W3 参考](http://www.w3schools.com/tags/ref_urlencode.asp)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-28T00:24:19.283

在 html 中发送电子邮件使用[Quoted-printable](https://en.wikipedia.org/wiki/Quoted-printable)编码。您的 $mailContent 的问题是“=”必须由 =3D 表示

尝试添加： $mailContent =quoted_printable_encode($mailContent);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:43:51.370

这可能不是完美的答案，但如果您的应用程序允许，我已经多次使用 URL 缩短器。

[http://goo.gl/](http://goo.gl/)是我的首选，因为 API 非常易于实现，而且 google 速度非常快。我在一个类中有一个函数，我只是通过它运行我的 url 并将返回发送到我需要的任何地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-08T02:12:40.743

这里的另一个不完美的答案但是，我的问题是我在 html 正文中包含了一个 http url，显然是无效的，所以我将它们更改为 https。这是在开发环境中，因此在生产中没有问题。

[以下](https://support.google.com/mail/thread/25063764?hl=en)是有关此的更多信息：

> 邮件正文中导致不安全站点的任何 URL 也可能需要删除。使用 [https://transparencyreport.google.com/safe-browsing/search](https://transparencyreport.google.com/safe-browsing/search)验证这些链接。所有链接都应正确地以“https”为前缀。 [https://en.wikipedia.org/wiki/HTTPS](https://en.wikipedia.org/wiki/HTTPS) 谷歌似乎拒绝“http”。有时，但并非总是如此，从任何签名中删除链接会有所帮助。

# python - 在更大的画布上合并 pyPDF 中的 PDF

> ID：15666797
> 
> 赞同：2
> 
> 时间：2013-03-27T18:36:30.117
> 
> 标签：python, pypdf

我在 pyPDF 中要做的是创建一个脚本，该脚本将生成一个 17x11 PDF“画布”，将第一个 PDF 添加到左侧，将第二个 PDF 添加到右侧。

我最初的问题是：生成不共享原始 PDF 尺寸的输出 PDF 的方法是什么？IE：如何生成 17x11 PDF？

![我的 PDF 指南](../Images/4cfd6cf997b4e8dd7ce78401e6da53a6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-05T03:39:04.323

```
input1 = PdfFileReader(open('pdf1.pdf', 'rb'))
page1 = input1.getPage(0)

input2 = PdfFileReader(open('pdf2.pdf', 'rb'))
page2 = input2.getPage(0)

page3 = PageObject.createBlankPage(None, 17*72, 11*72)
#create a blankPage size is 17*11,1 inch equal 72 px

page3.mergeScaledTranslatedPage(page1, 1, 0, 0)

#merge your pdf1 and pdf2 into the blank canvas
page3.mergeScaledTranslatedPage(page2, 1, 8.5*72, 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-07T03:05:37.887

将[PyPDF2](https://github.com/mstamy2/PyPDF2)与[PageObject 类](https://pythonhosted.org/PyPDF2/PageObject.html)一起使用。

它有一个`page1.mergeRotatedTranslatedPage(page2, rotation, tx, ty, expand=True)`命令。随着`expand=True`将`page1`延长。

请参阅我对另一个问题的回答：[Python PyPDF2 join pages](https://stackoverflow.com/a/34646677/4187194)

# c# - WebAuthenticationBroker.AuthenticateAsync 不工作

> ID：15666802
> 
> 赞同：3
> 
> 时间：2013-03-27T18:37:01.510
> 
> 标签：c#, windows-8, windows-runtime, oauth-2.0, winrt-async

我正在构建一个 Windows 8 应用程序，并在应用程序启动时尝试从 Google 数据 API 获取令牌。我构建了一个函数来执行此操作，它具有以下代码：

```
string authCodeUrl = UrlHelpers.BaseUrlFactory(UrlType.OAuth) +
                    "?client_id=" + _clientId +
                    "&redirect_uri=" + _redirectUri +
                    "&response_type=code" +
                    "&scope=" + _scope;

Uri startUri = new Uri(authCodeUrl);
Uri endUri = new Uri("https://accounts.google.com/o/oauth2/approval?");

WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(WebAuthenticationOptions.UseTitle, startUri, endUri); 
```

`OnLaunched()`在调用之前，我在 App.xaml.cs 中调用该函数`Window.Current.Activate()`。我这样做的原因是因为我的`MainViewModel`.

奇怪的是：当我以正常方式（通过 Visual Studio）启动我的应用程序时，它会卡在启动画面上（启动画面会持续很长时间），但是当我在这一行上放置一个断点时：

```
WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(WebAuthenticationOptions.UseTitle, startUri, endUri); 
```

一步一步通过它，我突然得到一个登录窗口，允许我登录并获取令牌，这意味着启动画面消失了，我可以使用我的应用程序。

当我从 App.xaml.cs 中删除调用并仅从 ViewModel 请求令牌时，我遇到了同样的问题：它仍然卡在 SplashScreen 上。当我确实从我的 App.xaml.cs 请求令牌但在`Window.Current.Activate()`调用后移动请求时，我也遇到了这个问题。但在这些情况下，登录后启动画面消失，但屏幕保持黑色。我没有看到我的应用程序。

Ps，这就是我从 App.xaml.cs 请求令牌的方式（`OnLaunched`标记为`async`）：

```
IOAuth2Service oAuth2Service = new OAuth2Service();
await oAuth2Service.GetToken(); 
```

OAuth2Service 只是一个有方法的对象`GetToken()`。这种方法只是做我上面描述的。

有谁知道为什么当我使用断点单步执行应用程序时它会起作用，但当我不单步执行它就启动它时却不行？

我已经隔离了问题并创建了一个仅包含此代码的 Github 项目。你可以在这里找到它：[https](https://github.com/Avalaxy/OAuth2WinRT/tree/master/App1) ://github.com/Avalaxy/OAuth2WinRT/tree/master/App1 。有一个 app.xaml.cs 调用 OAuth2.GetToken()。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T06:54:48.843

根据[文档](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.window.activate.aspx)-

> 如果应用程序或其启动画面保持在屏幕上，则没有时间限制，但最终应用程序**需要调用激活才能进行。**

诚然有点含糊，需要解释，但在`GetToken`请求之前将调用移动到激活将使您摆脱看似潜在的竞争条件。

# html - 在将实际图像加载到框架之前，如何根据 CSS 使浏览器缩放图像框架？

> ID：15666803
> 
> 赞同：0
> 
> 时间：2013-03-27T18:37:05.953
> 
> 标签：html, css, image, lazy-loading, loading

在一个网页中，我有几张相互堆叠的图像。图像的 CSS 是

```
img {
    width: 100%;
    height: auto;
    padding: 0;
    border: 0;
    margin-bottom: 0.66em;
} 
```

所有图像都在 html img 标签中指定了适当的高度和宽度。

当页面在慢速连接上加载时，我希望**在实际图像加载到它们之前，**图像会显示缩放的框架。这是因为它有时看起来像这样：

```
[----------------]
[  Loaded image  ]
[----------------]

[ Not loaded image ]

[----------------]
[  Loaded image  ]
[----------------] 
```

其中加载的图像具有正确的大小，但未加载的图像仍然只是显示的一行`alt=text`。

![加载图像](../Images/4c2ce8cb56a36f48380d671a015164ff.png)

然后，当三个负载的中间膨胀到合适的大小并移动其他负载时。

我希望外观和加载与没有 CSS 的情况相同：图像将出现的空帧以正确的像素大小显示，然后用图像填充。

请注意，这当然只是连接缓慢时的问题，图像实际上并没有那么大。

图像是渐进式 JPG。

**我想：**

*   在填充图像之前，根据 css 设置缩放图像帧。
*   按顺序加载图像，从顶部的图像开始，然后继续向下。

使用伟大的[Lazyloading 插件](http://www.appelsiini.net/projects/lazyload)当然可以是一个解决方案，但它似乎有点矫枉过正。

我也可以使用 javascript 来检测窗口宽度，然后更改 html 标记中的`width`and `height`，但这似乎没有必要。

我更喜欢不需要更改图像本身代码的解决方案。如果可以实现，最好仅使用 css。

非常期待您的想法！感谢您阅读这篇长文：）！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T19:45:48.147

据我所知，页面中对象的加载顺序只能通过使用 javascript 进行控制。不同的浏览器加载页面的方式也不同：

Firefox 倾向于一个接一个地加载渐进式 JPEG，而 Chrome 则同时开始加载所有这些。

jQuery 的 Lazyload 插件可能是一个解决方案，它可以很好地处理图像的占位符和缩放，但它会禁用 JPEG 的渐进式下载。

我**认为**为图像添加css`height: auto;`会有所改进（图像框架的尺寸会更快），但这是一个微小的差异，我不确定。

解决方案是编写一个javascript，它首先使用占位符图像，然后顺序读取图像并允许它们逐步显示。

感谢您对如何编写此脚本或对我的问题的不同解决方案提出进一步的意见！

# java - Box2d - 加速和限制车轮的速度

> ID：15666805
> 
> 赞同：0
> 
> 时间：2013-03-27T18:37:08.593
> 
> 标签：java, android, box2d

我正在制作 android 游戏，使用 box2d 进行物理，我有车辆，轮子使用 WheelJoints 连接到主体车身。现在我正在寻找一种适当的方法来加速这些车辆，并将它们的速度限制在某个值，目前我正在这样做：

```
public void accelerate(int direction)
{
    if (Math.abs(wheel1.getAngularVelocity()) < maxSpeed)
    {
        wheel1.applyAngularImpulse(accelerateRatio * direction);
        wheel1.applyAngularImpulse(accelerateRatio * direction);
    }
} 
```

在哪里：

*   **wheel1**和**wheel2**是我的轮体。
*   int direction 是我们想要加速的方向（1 右，-1 左）
*   AccelerateRatio - 加速度的比率，例如 10。
*   maxSpeed - 车辆的最大速度，例如 12 等。

我不认为它是一个完美的解决方案，特别是因为它有烦人的错误，而让我们说向右加速，而不是向左加速，车辆必须首先减速，因为有最大速度的检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:40:50.660

如果有办法检查车轮旋转的当前方向，那么只有在尝试加速时才应该检查它是否是最大速度。正如您所说，现在您在加速和减速时检查最大速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:14:06.993

您可以`accelerateRatio`根据当前速度和所需速度进行调整。

```
accelerateRatio = k * (float) Math.abs((
                getDesiredAngularVelocity() - wheel.getAngularVelocity()); 
```

这样，如果所需的速度沿相反方向，您将获得更大的减速度，它可以帮助您更快地停止。

# jquery - 两行或多行触摸 jQuery 轮播

> ID：15666809
> 
> 赞同：1
> 
> 时间：2013-03-27T18:37:22.380
> 
> 标签：jquery, jquery-mobile, backbone.js, slider, carousel

有什么解决办法吗？

描述：我正在尝试使用[touchcarousel](http://dimsemenov.com/plugins/touchcarousel/)，但它的旋转木马中只有 1 个 solition 中的 2 个项目。这不合适，因为我使用“每个循环”，我无法将 2 项粘贴到 1 中。在我看来，我需要找到具有 API 能力集成的轮播。

我想，我明白了 - [jQuery RS Carousel](http://www.richardscarrott.co.uk/assets/javascript/jquery/ui-carousel/demo/)，但我有两个原因不能使用它。- 看起来很便宜 - 多行 API 不能正常工作。

# r - 在 Rstudio 中重新启动 R

> ID：15666810
> 
> 赞同：39
> 
> 时间：2013-03-27T18:37:31.203
> 
> 标签：r, rstudio

我正在尝试使用 system2() 从 R 中调用一个简单的 python 脚本。我已经阅读了一些我发现含糊不清的信息，即如果使用了“太多”内存，它将无法正常工作。

如果我加载一个大型数据集并使用其中的一些信息作为参数传递给 system2()，那么只有在调用 Rstudio 中手动单击“重新启动 R”时它才会起作用。

我想要的是：

```
df <- read.csv('some_large_file.csv')
###extracting some info called 'args_vec'
for(arg in args_vec){
    system2('python', args)
} 
```

这不会按原样工作。for 循环被简单地传递了。

我需要的：

```
df <- read.csv('some_large_file.csv')
###extracting some info called 'args_vec'
###something that 'restarts' R
for(arg in args_vec){
    system2('python', args)
} 
```

[这个答案](https://stackoverflow.com/questions/6313079/quit-and-restart-a-clean-r-session-from-within-r)并没有得到我想要的。也就是说，它在 Rstudio 中对我不起作用，它调用“system”（在这种情况下与“system2”存在相同的问题）。事实上，当我将上面引用的答案放在我的 Rprofile.site 文件中时，它只是立即关闭了 rstudio：

我将该建议作为正常功能尝试（而不是使用“makeActiveBinding”，但效果不佳。

```
##restart R in r session  -- doesn't work
makeActiveBinding("refresh", function() { system("R --save"); q("no") }, .GlobalEnv)

##nor did this:
refresh <- function() { system("R --save"); q("no") } 
```

我尝试了上面这两个选项的多种变体，但这对于一个简单的问题来说已经很长了。关于启动过程我还有很多不明白的地方，“makeActiveBinding”有点神秘。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2014-09-09T14:53:53.300

在 Rstudio 中，您可以通过以下方式重新启动 R 会话：

```
command/ctrl + shift + F10 
```

您还可以使用：

```
.rs.restartR() 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-02-01T14:45:19.487

RStudio 有这个未记录的文件`rs.restartR()`，它应该这样做：重新启动 R。

但是，它不会卸载已加载的包，也不会清理环境，因此我怀疑它是否会重新启动 R。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-19T19:15:36.237

如果您使用 RStudio，请使用菜单项 Session > Restart R 或相关的键盘快捷键`Ctrl+Shift+F10`（Windows 和 Linux）或`Command+Shift+F10`(Mac OS)。额外的键盘快捷键使您可以轻松地从中断的地方重新开始开发，即说“重新运行所有代码到这里”：

在 R 脚本中，使用`Ctrl+Alt+B`(Windows 和 Linux) 或`Command+Option+B`(Mac OS) 在 R markdown 中，使用`Ctrl+Alt+P`(Windows 和 Linux) 或`Command+Option+P`(Mac OS) 如果从 shell 运行 R，请使用`Ctrl+D`或`q()`退出，然后重新启动 R。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-14T13:01:14.430

Have you tried embedding the function call within the apply function, rather than a for loop?

I've had some pieces of code that ran the system out of memory in a for loop run perfectly with apply. It might help?

# html - 在 twitter bootstrap nav-list 中对齐文本

> ID：15666816
> 
> 赞同：5
> 
> 时间：2013-03-27T18:37:46.330
> 
> 标签：html, css, twitter-bootstrap, alignment

我想让文本在Twitter Bootstrap的同一`<li>`元素内左右对齐。`nav-list`这是我的代码：

```
<ul class="nav nav-list">
  ...
  <li class="active"><a href="/">All<p class="pull-right">100</p></a></li>
  <li><a href="/mon/warnings/">Warning<p class="pull-right">100</p></a></li>
  <li><a href="/mon/errors/">Error<p class="pull-right">100</p></a></li>
  ...
</ul> 
```

这是它的外观：

![在此处输入图像描述](../Images/7acb1a5bf8c96268e8b0be6e86b11c6e.png)

**编辑：** 谢谢大家的回复。以这种方式解决了这个问题：

*   替换`<p>`为`<span>`
*   添加`class="clearfix"`到`<li>`元素

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T05:13:31.360

**HTML：**

```
 <ul class="nav nav-list">
      ...
    <li class="active"><a href="/"><label>All</label><span>100</span></a><div class="clr"></div></li>
    <li><a href="/mon/warnings/"><label>Warning</label><span>100</span></a><div class="clr"></div></li>
    <li><a href="/mon/errors/"><label>Error</label><span>100</span></a><div class="clr"></div></li>
      ...
    </ul> 
```

**CSS：**

```
.nav-list ul li a{ padding:5px 10px; display:block;}
.nav-list ul li a label{ cursor:pointer; display:block; float:left; width:80%;}
.nav-list ul li a span{ cursor:pointer; display:block; float:left; width:20%; text-align-right;}

.clr{ clear:both;} 
```

**注意：**相应地调整标签左侧文本的宽度和跨度右侧的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:42:08.643

**选项一：更改标记：**

只需稍微更改您的标记即可。放置`<p>`锚标记的外部。

```
<ul class="nav nav-list">
  <li class="active"><a href="/">All</a><p class="pull-right">100</p></li>
  <li><a href="/mon/warnings/">Warning</a><p class="pull-right">100</p></li>
  <li><a href="/mon/errors/">Error</a><p class="pull-right">100</p></li>
</ul>

.pull-right {float:right;} 
```

**选项二：更改 CSS：**

否则，如果在`<p>`锚标签内需要，那么你可以做这样的事情。

```
a { 
display:block;       
width:100%;
}

p{ float:right;} 
```

**示例：（** *请注意，我在示例中使用了 css 重置）*

[http://jsfiddle.net/vRSMZ/1/](http://jsfiddle.net/vRSMZ/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:43:30.000

HTML：

```
<ul class="nav nav-list">
  ...
<li class="active"><a href="/">All<span class="num">100</span></a></li>
<li><a href="/mon/warnings/">Warning<span class="num">100</span></a></li>
<li><a href="/mon/errors/">Error<span class="num">100</span></a></li>
  ...
</ul> 
```

CSS：

```
.num{
float: right;
} 
```

我将您的更改`<p>`为，`<span>`因为这更有意义...然后`.nums`在跨度中添加了一个类，然后向右浮动。

# c# - 有没有办法指示 Visual Studio 在类的底部而不是顶部自动添加字段？

> ID：15666817
> 
> 赞同：2
> 
> 时间：2013-03-27T18:37:46.847
> 
> 标签：c#, visual-studio, formatting, styles

```
namespace Guilds
{
  public class Wizard
  {
    public void Wear(IClothing clothing)
    {
      Console.WriteLine("Puts on the {Robe} and {WizardHat}".Fmt(clothing));
    }

    IClothing _clothes;
    IWeapon   _weapon; // <== I want my fields added at the bottom of the class!
  }
} 
```

我知道，如果您将字段放在底部，它也会开始将后续字段添加到类的底部。即使对于第一个字段，我也希望将其作为默认行为。

此行为通常在按下 Ctrl + 时触发。在未声明的字段之上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:25:29.017

使用[Regionerate](http://www.rauchy.net/regionerate/)并创建您自己的格式模板。它是与 Visual Studio 一起使用的免费工具。

编辑：您也可以使用[CodeMaid](http://www.codemaid.net/)，因为似乎 Regionerate 和 VS2012 不能一起工作（虽然我根本没有测试过这种组合。我有 VS2010）

**编辑**在我之前的回复中添加更多内容。CodeMaid 真的很酷，你可以在配置中指定布局。同样在配置中，您可以指定该文件应在保存时格式化。这样，您可以随心所欲地编写代码，并在按下 Ctrl+S 时将其格式化！我是 CodeMaid 的一名快乐用户。我也在使用 Visual Studio 2013。

# c# - 从 WebAPI 返回 PageResult 未格式化为 OData

> ID：15666818
> 
> 赞同：4
> 
> 时间：2013-03-27T18:37:47.753
> 
> 标签：c#, .net, asp.net-web-api, odata

我正在尝试将基于 WebAPI 的应用程序从 WebAPI RC 迁移到发布版本。它接受一些查询参数，并返回 ATOM 格式的 OData。由于它是一个正在运行的服务，我需要保持当前的行为。

我已更改 API 方法以返回`PageResult<T>`包含我的数据的 a。根据 MSDN 上的*[Supporting OData Query Options](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/supporting-odata-query-options)*文章，这应该是我需要做的所有事情，但它不起作用。我得到了结果，但它总是格式化为 JSON。我尝试将`Accept`请求标头更改为`application/atom+xml`，但似乎没有任何区别。

我还尝试在我的中添加以下几行，`WebApiConfig`但没有明显效果：

```
configuration.EnableQuerySupport();
configuration.Formatters.InsertRange(0, ODataMediaTypeFormatters.Create()); 
```

我尝试清除现有的格式化程序，看看会发生什么。我只是得到`406 Not Acceptable`错误。因此，OData 格式化程序似乎没有报告他们可以处理请求/响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:11:45.873

请阅读此博客文章以了解有关启用 OData 的信息：

[http://blogs.msdn.com/b/webdev/archive/2013/01/29/getting-started-with-asp-net-webapi-odata-in-3-simple-steps.aspx](http://blogs.msdn.com/b/webdev/archive/2013/01/29/getting-started-with-asp-net-webapi-odata-in-3-simple-steps.aspx)

您缺少 OData 路由 - 格式化程序需要该路由才能正常工作。

# ios - iOS应用程序上的Titanium Studio错误-未定义不是对象

> ID：15666819
> 
> 赞同：0
> 
> 时间：2013-03-27T18:37:50.857
> 
> 标签：ios, ipad, titanium

在 Titanium 中出现错误，似乎已经解决了。这是错误：

未定义不是对象（评估'e.source.center.x'）

这是发生错误的函数：

```
function MoveStart(e) {
    switch(win.orientation)
    {
        // LANDSCAPE_RIGHT
        default:
        e.source.ox = e.globalPoint.y - e.source.center.x;
            e.source.oy = win.height - e.globalPoint.x - e.source.center.y;
        //alert('x: ' + e.source.ox + ' y: '+ e.source.oy);
        break;
    }
                       } 
```

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:40:46.513

错误消息清楚地表明该`center`属性未定义`e.source`

改用**布局后**事件 `center.x`来实现您的目标。

# javascript - Extjs 保存动态选项卡并在页面加载时重新呈现它们，这可能吗？

> ID：15666821
> 
> 赞同：1
> 
> 时间：2013-03-27T18:38:19.753
> 
> 标签：javascript, extjs, tabs, state, state-saving

我正在使用 Extjs 动态添加新选项卡。但是有没有办法可以将新添加的选项卡保存在某处（可能在数据库中），因为每当用户重新访问页面时，我都必须呈现用户动态创建的所有选项卡.

我可以制作标签，将标签的状态保存在 cookie 中。但我知道，为了保存新创建的标签的状态，我必须先将标签的 Html(?) 片段保存在某处？

这是我的代码：

```
var tab;
var tabIndex = 0;
var tabArray = [];

Ext.application({
  launch: function() {
    Ext.state.Manager.setProvider(new Ext.state.CookieProvider({
      expires: new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * 7))
    }));
    Ext.create('Ext.container.Viewport', {
      layout: 'absolute',
      items: [{
        x: 50,
        y: 50,
        width: 300,
        height: 300,
        xtype: 'tabpanel',
        stateful: true,
        stateId: 'tp1',
        stateEvents: ['tabchange'],
        getState: function() {
          return {
            activeTab: this.items.findIndex('id',this.getActiveTab().id)
          };
        },
        applyState: function(s) {
          this.setActiveTab(s.activeTab);
        },
        items: [{
          id: 'c0',
          title: 'Tab One'
        }, {
          id: 'c1',
          title: 'Tab Two'
        }, {
          id: 'c2',
          title: 'Tab Three'
        }],
        bbar: [
                  {
                      text: 'Add Tab',
                      //region: 'south',
                      xtype: 'button',
                      handler: function () {
                          var tabs = this.up('tabpanel');
                          tab = tabs.add({
                              title: 'Tab ',
                              closable:true,
                              xtype:'panel',
                              width: '100%',
                              height: '100%',
                              items: []                                                 
                          }).show();
                      }
                  }
              ]
        }]
    });
  }
}); 
```

我想在这里做一些不切实际的事情吗？或者是否有可能以某种方式存储新创建的选项卡并在页面加载时使用新创建的选项卡呈现整个选项卡面板？

对于提出如此广泛的问题，我深表歉意:)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:48:27.583

我过去做过类似的事情。这就是我们的设计方法。**它含糊不清，但我们仍然这样做了**

当您动态创建选项卡并将项目（面板/输入字段）添加到其中并更改这些项目的值（例如在文本框中输入文本，选中复选框）时，当您最终点击保存时，我们将提取所有数据作为 JSON。

您需要根据需要保存的值自定义构建 - 例如项目的类型、值、其子结构等。

然后，当您想要重新渲染页面时，您可以使用 JSON 来构建它。构建这个解决方案并不容易。但是，一旦你完成了，它就可以对所有的标签重复使用——不管是动态的。

最后，它**绝对有可能**

# android - 在 Android SDK 中（使用 4.2.2）HttpClient Basic preemptive-auth with HttpPost 总是返回 401

> ID：15666823
> 
> 赞同：1
> 
> 时间：2013-03-27T18:38:22.890
> 
> 标签：android, http-post, httpclient, exchangewebservices, preemptive

使用的 Web 服务是：[https](https://domain.name.com/EWS/Exchange.asmx) : //domain.name.com/EWS/Exchange.asmx，在soapUI 中完美运行。对于 AuthScope，也尝试过`new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT)`但没有运气。

下面的代码基于版本 4.0.3中`ClientPreemptiveBasicAuthentication.java`的Apache 示例代码。`HttpClient`在[http://archive.apache.org/dist/httpcomponents/httpclient/source/](http://archive.apache.org/dist/httpcomponents/httpclient/source/)

```
private void callBasicAuthencationWebService() {
    DefaultHttpClient httpclient = new DefaultHttpClient();

    Credentials creds = new UsernamePasswordCredentials(username, password);

    httpclient.getCredentialsProvider().setCredentials(
            new AuthScope("domain.name.com", 443), 
            creds);

    BasicHttpContext localcontext = new BasicHttpContext();

    // Generate BASIC scheme object and stick it to the local 
    // execution context
    BasicScheme basicAuth = new BasicScheme();
    localcontext.setAttribute("preemptive-auth", basicAuth);

    HttpHost targetHost = new HttpHost("domain.name.com", 443, "https"); 

    HttpPost httppost = new HttpPost(urlString);
    // add headers
    httppost.setHeader("soapaction", soapAction);
    httppost.setHeader("Content-Type", "text/xml; charset=utf-8");

    try {
        httppost.setEntity(new StringEntity(envelope));
        //httppost.addHeader(BasicScheme.authenticate(creds,"US-ASCII",false));
        Header bs = new BasicScheme().authenticate(creds, httppost);
        httppost.addHeader("Proxy-Authorization", bs.getValue());
    }
    catch (Exception e) {
        System.out.println(e.toString());
    }

    // Add as the first request interceptor
    httpclient.addRequestInterceptor(new PreemptiveAuth(), 0);

    System.out.println("executing request: " + httppost.getRequestLine());
    System.out.println("to target: " + targetHost);

    for (int i = 0; i < 3; i++) {
        try {
        HttpResponse response = httpclient.execute(targetHost, httppost, localcontext);
        HttpEntity entity = response.getEntity();

        System.out.println("----------------------------------------");
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();
        String statusMessage = statusLine.getReasonPhrase();
        System.out.println("Status Code: " + statusCode + statusMessage);

        if (entity != null) {
            System.out.println("Response content length: " + entity.getContentLength());
            entity.consumeContent();
        }
        } catch (Exception e) {
            System.out.println(e.toString());
        }
    }

    // When HttpClient instance is no longer needed, 
    // shut down the connection manager to ensure
    // immediate deallocation of all system resources
    httpclient.getConnectionManager().shutdown();        
} 
```

`PreemptiveAuth`内部类，使用`HttpRequestInterceptor`：

```
static class PreemptiveAuth implements HttpRequestInterceptor {

    public void process(
            final HttpRequest request, 
            final HttpContext context) throws HttpException, IOException {

        AuthState authState = (AuthState) context.getAttribute(
                ClientContext.TARGET_AUTH_STATE);

        // If no auth scheme avaialble yet, try to initialize it preemptively
        if (authState.getAuthScheme() == null) {
            AuthScheme authScheme = (AuthScheme) context.getAttribute(
                    "preemptive-auth");
            CredentialsProvider credsProvider = (CredentialsProvider) context.getAttribute(
                    ClientContext.CREDS_PROVIDER);
            HttpHost targetHost = (HttpHost) context.getAttribute(
                    ExecutionContext.HTTP_TARGET_HOST);
            if (authScheme != null) {
                Credentials creds = credsProvider.getCredentials(
                        new AuthScope(
                                targetHost.getHostName(), 
                                targetHost.getPort()));
                if (creds == null) {
                    throw new HttpException("No credentials for preemptive authentication");
                }
                authState.setAuthScheme(authScheme);
                authState.setCredentials(creds);
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T14:11:53.187

它的基于 NTLM 的 Web 服务调用。您可以使用以下代码连接到 Web 服务。

```
 HttpClient httpclient = new DefaultHttpClient();
            ((AbstractHttpClient) httpclient).getAuthSchemes().register("ntlm",new NTLMSchemeFactory());

            NTCredentials creds = new NTCredentials("username", "password", "", "domain");

            ((AbstractHttpClient) httpclient).getCredentialsProvider().setCredentials(AuthScope.ANY, creds);
            HttpConnectionParams.setConnectionTimeout(httpclient.getParams(), 5000);

            HttpPost httppost = new HttpPost("https://domain.xxx.com/EWS/Exchange.asmx");
            httppost.getParams().setBooleanParameter(CoreProtocolPNames.USE_EXPECT_CONTINUE, false);

            try {
                StringBuffer sbnew = new StringBuffer();
                sbnew.append("your soap request body");
                StringEntity se = new StringEntity(sbnew.toString(), HTTP.UTF_8);
                se.setContentType("text/xml");
                httppost.setEntity(se);

                HttpResponse httpresponse = httpclient.execute(httppost);
                HttpEntity resEntity = httpresponse.getEntity();

                System.out.println("Status OK: \n" + EntityUtils.toString(resEntity));

            } catch (ClientProtocolException e) {
                e.printStackTrace();
                System.out.println("Status NOT OK: \n" + e.getMessage());
            } catch (IOException e) {
                e.printStackTrace();
                System.out.println("Status NOT OK: \n" + e.getMessage());
            } 
```

请记住从以下链接中包含 JCIFS 库 [http://hc.apache.org/httpcomponents-client-ga/ntlm.html](http://hc.apache.org/httpcomponents-client-ga/ntlm.html)

# entity-framework - 实体框架和调用 context.dispose()

> ID：15666824
> 
> 赞同：75
> 
> 时间：2013-03-27T18:38:27.827
> 
> 标签：entity-framework, dbcontext, idisposable

什么时候应该调用`DbContext.dispose()`实体框架？

1.  **这种想象的方法不好吗？**

    ```
    public static string GetName(string userId)
    {
        var context = new DomainDbContext();
        var userName = context.UserNameItems.FirstOrDefault(x => x.UserId == userId);
        context.Dispose();
        return userName;
    } 
    ```

2.  **这是否更好？**

    ```
    public static string GetName(string userId)
    {
        string userName;
        using(var context = new DomainDbContext()) {
            userName = context.UserNameItems.FirstOrDefault(x => x.UserId == userId);
            context.Dispose();
        }
        return userName;
    } 
    ```

3.  **这是否更好，也就是说，在使用 using() 时不应该调用 context.Dispose() 吗？**

    ```
    public static string GetName(string userId)
    {
        string userName;
        using(var context = new DomainDbContext()) {
            userName = context.UserNameItems.FirstOrDefault(x => x.UserId == userId);
        }
        return userName;
    } 
    ```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2013-03-27T18:52:01.683

实际上这是两个问题合二为一：

1.  我应该什么时候`Dispose()`的上下文？
2.  我的上下文的生命周期应该是多少？

答案：

1.  **从不** ¹。`using`是一个隐含`Dispose()`在一个`try-finally`块中。`Dispose`当异常发生较早时，可能会遗漏单独的语句。此外，在最常见的情况下，根本不调用`Dispose`（隐式或显式）[是无害](http://blog.jongallant.com/2012/10/do-i-have-to-call-dispose-on-dbcontext.html#.U9efX_ldXpo)的。

2.  参见例如[实体框架 4 - winform 应用程序中上下文的生命周期/范围](https://stackoverflow.com/questions/5663754/entity-framework-4-lifespan-scope-of-context-in-a-winform-application)。简而言之：寿命应该“短”，静态上下文不好。

* * *

¹正如一些人所评论的，当上下文是实现`IDisposable`自身并共享其生命周期的组件的一部分时，此规则的例外情况。在这种情况下，您将调用组件`context.Dispose()`的`Dispose`方法。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2014-06-21T15:09:31.200

我遵循了一些很好的教程来使用 EF，它们没有处理上下文。

我对此有点好奇，我注意到即使是备受尊敬的 Microsoft VIP 也不会处理上下文。我发现**您不必**在正常情况下处理 dbContext 。

如果您想了解更多信息，可以阅读这篇总结了原因[的博客文章。](https://blog.jongallant.com/2012/10/do-i-have-to-call-dispose-on-dbcontext/)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-04-16T20:03:31.650

**更好的是：**

```
public static string GetName(string userId)
{
    using (var context = new DomainDbContext()) {
        return context.UserNameItems.FirstOrDefault(x => x.UserId == userId);
    }
} 
```

无需从作用域外返回结果`using`；只需立即返回它，您仍然可以获得所需的处置行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-05T21:39:00.527

您可以将数据库上下文定义为类字段，并实现`IDisposable`. 如下所示：

```
public class MyCoolDBManager : IDisposable
{
    // Define the context here.
    private DomainDbContext _db;

    // Constructor.
    public MyCoolDBManager()
    {
        // Create a new instance of the context.
        _db = new DomainDbContext();
    }

    // Your method.
    public string GetName(string userId)
    {           
        string userName = _db.UserNameItems.FirstOrDefault(x => x.UserId == userId);

        return userName;
    } 

    // Implement dispose method.
    // NOTE: It is better to follow the Dispose pattern.
    public void Dispose()
    {
         _db.dispose();
         _db = null;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-15T15:34:01.310

正如丹尼尔所提到的，您不必处理 dbContext。

从[文章](https://blog.jongallant.com/2012/10/do-i-have-to-call-dispose-on-dbcontext/)：

*尽管它确实实现了 IDisposable，但它只是实现了它，因此您可以在某些特殊情况下调用 Dispose 作为保护措施。默认情况下，DbContext 会自动为您管理连接。*

所以：

```
public static string GetName(string userId) =>
    new DomainDbContext().UserNameItems.FirstOrDefault(x => x.UserId == userId); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-11T11:39:57.853

在某些情况下，可能需要处理上下文。

在 OP 示例的简单术语中，`using`关键字就足够了。

那么我们什么时候需要使用`dispose`呢？

看看这个场景：您需要处理一个大文件或通信或 Web 服务合同，这将生成数百或数千个 BD 记录。

在 EF 中添加（+400）数千或数百个实体对性能来说是一种痛苦：[实体框架性能问题，saveChanges 非常慢](https://stackoverflow.com/questions/21272763/entity-framework-performance-issue-savechanges-is-very-slow)

该解决方案在此站点上描述得非常好：[https ://entityframework.net/improve-ef-add-performance](https://entityframework.net/improve-ef-add-performance)

TL;DR - 我实现了这个，所以我最终得到了这样的东西：

```
 /// <summary>
    /// Convert some object contract to DB records
    /// </summary>
    /// <param name="objs"></param>
    public void SaveMyList(WCF.MyContract[] objs)
    {
        if (objs != null && objs.Any())
        {
            try
            {
                var context = new DomainDbContext();
                try
                {
                    int count = 0;
                    foreach (var obj in objs)
                    {
                        count++;

                        // Create\Populate your object here....
                        UserNameItems myEntity = new UserNameItems();

                        ///bla bla bla

                        context.UserNameItems.Add(myEntity);

                        // https://entityframework.net/improve-ef-add-performance
                        if (count % 400 == 0)
                        {
                            context.SaveChanges();
                            context.Dispose();
                            System.Threading.Thread.Sleep(0); // let the system breathe, other processes might be waiting, this one is a big one, so dont use up 1 core for too long like a scumbag :D
                            context = new DomainDbContext();
                        }
                    }

                    context.SaveChanges();
                }
                finally
                {
                    context.Dispose();
                    context = null;
                }

                Log.Info("End");
            }
            catch (Exception ex)
            {
                Log.Error(string.Format("{0}-{1}", "Ups! something went wrong :( ", ex.InnerException != null ? ex.InnerException.ToString() : ex.Message), ex);
                throw ex;
            }
        }
    } 
```

# c# - 发生异常时 Visual Studio 和进程冻结（我认为）C#

> ID：15666828
> 
> 赞同：4
> 
> 时间：2013-03-27T18:38:43.737
> 
> 标签：c#, visual-studio-2010, visual-studio

我正在使用 Windows 窗体和 Visual Studio 2010 Professional 编写 C# 应用程序。该机器使用的是 Windows 7 Enterprise，它是 32 位的。尽管我认为这无关紧要，但我正在使用虚拟机（使用远程桌面连接）。

问题是，当在表单的 Load 方法中生成异常时，VS 和程序都会冻结/挂起（实际上，我什至无法显示文件夹或转到桌面），当我终止进程时它就会停止我正在调试的应用程序。

这发生在调试模式 (F5) 而不是非调试模式 (ctrl+F5)。我对此进行了很多搜索，这是 x64 机器的一个已知问题。这就是为什么我觉得它的发生真的很奇怪，就像很多人报告的 64 位计算机一样，但是在 x86 架构中。

到目前为止，我正在通过运行我想在 Load 之外的另一个函数中调试的代码来解决这个问题，但将来它可能会出现问题。

提前感谢您的任何输入。

- - - - - - - - - - - - - - - 编辑 - - - - - - - - - - --------------------------

我只是注意到我什至无法在 Load 方法中使用断点进行调试（而不是显示断点，它只是挂起......）。以前没人遇到过这个问题吗？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T15:21:02.277

好吧，伙计们，找出问题所在。

问题在于我将表单的属性“TopMost”设置为 true。奇怪的是，当异常发生时，我什至无法最小化我的应用程序，模拟挂断情况，而发生的只是我的表单正在等待 VS 的回答（这显示了异常，但它是可见的）。就像在“加载”方法中一样，表单保持冻结状态，让我别无选择，只能杀死它。

感谢您的建议，我想最后我错了，它确实在代码上:)（尽管我仍然认为由于我什至无法最小化我的应用程序而发生了一些奇怪的事情）。

（您可以关闭此线程或在确定解决某些问题时执行任何操作：P）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T10:43:07.763

安装适用于 Windows 的 Microsoft 调试工具：http: [//msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx)

将此工具附加到VS并产生您的错误，该工具会在异常时创建程序的转储/快照，您可以使用此工具获取有关应用程序运行状况的所有信息，使用起来并不容易，但会有所帮助你很多。

# javascript - 如何使用 Twitter Bootstrap 创建类似 Gmail 的布局

> ID：15666834
> 
> 赞同：13
> 
> 时间：2013-03-27T18:39:07.180
> 
> 标签：javascript, html, css, twitter-bootstrap

是否可以使用 Twitter Bootstrap 创建类似 GMail/GoogleGroups 的布局，以便布局始终适合视口（窗口高度）并且侧边栏和内容区域可以单独滚动？

```
--------------------------------------------------------------------------
|                                                                        |
|                    Fixed top navbar                                    |
--------------------------------------------------------------------------
|         |                                                              |   
| Sidebar |       Content area scrollable                                |
| scrollable                                                             |
|         |                                                              |
|         |                                                              |
|         |                                                              |
|         |                                                              |
|------------------------------------------------------------------------| 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-04-21T21:09:43.157

您不需要使用 Bootstrap 来创建此布局（我认为 Bootstrap 也不支持它，至少在没有重大修改的情况下不支持）。

当然，您仍然可以将 Bootstrap 用于页面上的所有其他内容。如果您真的想要 Google Apps 的外观，您需要调整一些默认的 Bootstrap 样式。

## 什么是可能的

为了好玩，这里使用我在下面描述的基本技术和各种 Bootstrap 组件快速仿制了 Gmail 界面。

**演示：http:** [//jsfiddle.net/Ly6wmyr2/1/](http://jsfiddle.net/Ly6wmyr2/1/)

[这里的代码绝对是演示质量，超出了 Stack Overflow 问题的范围。我会留给读者去剖析。]

## 简单故障

**演示：http:** [//jsfiddle.net/vLm26g4g/1/](http://jsfiddle.net/vLm26g4g/1/)

**笔记**

1.  我们使用绝对定位。
2.  仅仅因为它绝对定位并不意味着它不能响应（如果需要）。
3.  使用 100% 高度主体内的所有 4 个侧面定位容器。
4.  这种方法适用于所有浏览器 IE 7+。如果可以支持 IE8+，那么使用`box-sizing: border-box`会使维度计算更容易。
5.  像这样的布局确实受益于 LESS CSS，因为您可以在单个位置声明基本尺寸。

```
HTML {
    height: 100%;
}
BODY {
    position: relative;
    height: 100%;
}
HEADER {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 64px;
    padding: 8px;
    background-color: #ddd;
}
#side {
    position: absolute;
    top: 80px;
    left: 0;
    bottom: 0;
    width: 20%;
    background-color: #eee;
    overflow: auto;
}
#content {
    position: absolute;
    top: 80px;
    left: 20%;
    bottom: 0;
    right: 0;
    overflow: auto;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-26T20:42:18.173

我认为没有开箱即用的 Bootstrap 解决方案，但是**对 Bootstrap CSS**和**左侧导航**`position:absolute`周围的容器和 **宽内容进行*了一些覆盖，这应该可以工作。你会看到左/右跨度都有独立的滚动条......

 ***## [类似 Gmail 的 Bootstrap 布局演示](http://bootply.com/render/60116)

```
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">

      <!-- top nav --->

    </div>
  </div>
</div>
<div class="box">
  <div class="row-fluid">
    <div class="column span3">

     <!-- left-side nav --->

    </div>
    <div class="column span9">

     <!-- content area --->

    </div>
  </div>
</div> 
```

添加一些 Bootstrap CSS 覆盖，并调整 .box 和 .column 容器。

```
html, body {
    height: 100%;
}

.row-fluid {
    height: 100%;
}

.column:before, .column:after {
    content: "";
    display: table;
}

.column:after {
    clear: both;
}

.column {
    height: 100%;
    overflow: auto;
}

.box {
    bottom: 0; /* increase for footer use */
    left: 0;
    position: absolute;
    right: 0;
    top: 40px;
}

.span9.full {
    width: 100%;
} 
```

这是有效的 Bootply：**[http](http://bootply.com/60116)** ://bootply.com/60116 （还包括内容区域行和分页）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T18:43:53.910

查看脚手架部分

[http://twitter.github.com/bootstrap/scaffolding.html#layouts](http://twitter.github.com/bootstrap/scaffolding.html#layouts)

特别是在流体布局/固定布局部分下

如果您想让这些部分可滚动，只需添加

```
overflow-y:auto; 
```

到你的 div 中的 css

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T20:14:20.820

那将是您的代码使用滚动间谍来突出显示正文中当前的“可见”部分

```
 <body data-spy="scroll" data-target=".bs-docs-sidebar">
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3 bs-docs-sidebar">
        <ul class="nav nav-list bs-docs-sidenav affix">
          <li class="active"><a href="#global"><i class="icon-chevron-right"></i> Global styles</a></li>
          <li><a href="#gridSystem"><i class="icon-chevron-right"></i> Grid system</a></li>
          <li><a href="#fluidGridSystem"><i class="icon-chevron-right"></i> Fluid grid system</a></li>
          <li><a href="#layouts"><i class="icon-chevron-right"></i> Layouts</a></li>
          <li><a href="#responsive"><i class="icon-chevron-right"></i> Responsive design</a></li>
        </ul>
      </div>
    <div class="span9">
        <section id="global"></section>
        <section id="gridSystem</section>
        <section id="fluidGridSystem"></section>
        <section id="layouts"></section>
        <section id="responsive"></section>
    </div>
  </div>
</div>
</body> 
```

如果要添加固定导航栏，只需将“位置：固定”添加到导航栏 css***

# big-o - 为函数提供 Big O、Big Theta 和 Big Omega

> ID：15666843
> 
> 赞同：-8
> 
> 时间：2013-03-27T18:39:54.937
> 
> 标签：big-o, time-complexity, asymptotic-complexity

一个人怎么能给大 O、大 Theta 或大欧米茄这样的功能

```
T(n) = n + 10*log n 
```

有人可以告诉我如何获得这种事情的复杂性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:42:03.400

去掉所有低阶项和常数，你会得到：

```
Θ(T(n)) = Θ(n + 10*log(n)) = Θ(n) 
```

由于这是一个紧界 ( `Θ`)，我们还将上限和下界推断为`O(n)`和`Ω(n)`。

# android - 具有多列的 ORMLITE ORDER_BY

> ID：15666847
> 
> 赞同：15
> 
> 时间：2013-03-27T18:40:17.630
> 
> 标签：android, sql-order-by, ormlite

我在我最近的 android 项目中使用**ormlite 。**我想对表中的多个列（比如两列）的查询进行排序。我怎样才能做到这一点？

这是单个订单的代码...

```
QueryBuilder<Visit, Integer> qb = getHelper().getVisitDao().queryBuilder();
qb.where().eq("FOREIGN_ID", id);
qb.orderBy("VISIT_DATE", false); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-27T18:52:05.807

> 我想对表中的多个列（比如两列）的查询进行排序。我怎样才能做到这一点？

您需要做的就是`orderBy(...)`多次调用。

```
qb.orderBy("VISIT_DATE", false);
qb.orderBy("order-column", false);
... 
```

文档对此进行了[介绍](http://ormlite.com/docs/order-by)。去引用：

> 在 SQL 查询语句中添加“ORDER BY”子句，以按指定的列名对结果进行排序。使用升序布尔值获取升序或降序。这可以多次调用以按多列分组。

还有[javadocs](http://ormlite.com/javadoc/ormlite-core/com/j256/ormlite/stmt/QueryBuilder.html#orderBy(java.lang.String,%20boolean))：

> 在 SQL 查询语句中添加“ORDER BY”子句。这可以多次调用以添加额外的“ORDER BY”子句。先应用较早的。

# java - 用 MyBatis 调用 Oracle 存储过程

> ID：15666856
> 
> 赞同：6
> 
> 时间：2013-03-27T18:40:39.183
> 
> 标签：java, oracle, mybatis, ibatis, database-cursor

我正在将我们的数据库从 SQL Server 2008 迁移到 Oracle，但无法让 MyBatis 工作。

给定以下示例：

**UserMapper.xml**（示例）

```
<resultMap type="User" id="UserResult">
    <id property="userId" column="userId"/>
    <result property="firstName" column="firstName"/>
    <result property="lastName" column="lastName"/>
</resultMap>

<select id="getUsers" statementType="CALLABLE" resultMap="UserResult">
    {CALL GetUsers()}
</select> 
```

**用户DAO.java**

```
public interface UserDAO {
    public List<User> getUsers();
} 
```

**SQL Server 过程**

```
CREATE PROCEDURE [dbo].[GetUsers]
AS
BEGIN
    SET NOCOUNT ON;
    SELECT userId, firstName, lastName
    FROM Users
END 
```

...在 SQL Server 2008 中工作。有人可以向我解释如何从 UserMapper.xml 调用 Oracle 过程（与上面的 SQL Server 过程具有相同的名称和列）并使用 Oracle 游标填充我的 User 类?

这是我尝试过的：

```
<resultMap type="User" id="UserResult">
    <id property="userId" column="userId"/>
    <result property="firstName" column="firstName"/>
    <result property="lastName" column="lastName"/>
</resultMap>

<select id="getUsers" statementType="CALLABLE" resultMap="UserResult">
    {CALL GetUsers(#{resultSet,mode=OUT,jdbcType=CURSOR,resultMap=UserResult})}
</select> 
```

我得到这个错误：

```
Caused by: org.apache.ibatis.reflection.ReflectionException: 
Could not set property 'resultSet' of 'class java.lang.Class'
with value 'oracle.jdbc.driver.OracleResultSetImpl@476d05dc' 
Cause: org.apache.ibatis.reflection.ReflectionException: 
There is no setter for property named 'resultSet' in 'class java.lang.Class' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T18:54:07.447

结果映射如下所示：

```
<resultMap id="UserResult" type="User">
    <id property="userId" column="userId"/>
    <result property="firstName" column="firstName"/>
    <result property="lastName" column="lastName"/>     
</resultMap> 
```

在您的 select 语句中，将参数类型更改为 java.util.Map。

```
<select id="getUsers" statementType="CALLABLE" parameterType="java.util.Map"> 
    {call GetUsers(#{users, jdbcType=CURSOR, javaType=java.sql.ResultSet, mode=OUT, resultMap=UserResult})} 
</select> 
```

您的映射器界面看起来像这样，看起来您当前正在将其称为 DAO。我过去的做法是制作一个映射器接口，该接口被注入到 DAO 中，而 DAO 就是调用映射器上的方法。这是一个示例映射器接口：

```
public interface UserMapper {
    public Object getUsers(Map<String, Object> params);
} 
```

然后，该映射器类将被注入 DAO 类并进行如下调用：

```
public List<User> getUsers() {
    Map<String, Object> params = new HashMap<String, Object>(); 
    ResultSet rs = null;
    params.put("users", rs);
    userMapper.getUsers(params);
    return ((ArrayList<User>)params.get("users"));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-06T10:59:10.547

使用 MyBatis/iBATIS 3 从 Oracle 11 获取结果集是一个非常奇怪的过程。这对我来说毫无意义，但它奏效了。我的例子是不同的，但你会明白的：

```
create or replace 
PROCEDURE SP_GET_ALL_STORED_PROC (l_cursor out SYS_REFCURSOR) IS
BEGIN
open l_cursor for select account_id, totalLegs, born, weight, mammal, animal from copybittest;
END SP_GET_ALL_STORED_PROC;

Map map = new HashMap();
session.selectList("ibatis_3_test.selectProductAllOracleStoredProc", map); 
List productList = (List) map.get("key");

<resultMap id="productResultMap" type="test.Product">
</resultMap>

<select id="selectProductAllOracleStoredProc" parameterType="java.util.Map" statementType="CALLABLE">
    {call SP_GET_ALL_STORED_PROC(#{key, jdbcType=CURSOR, mode=OUT, javaType=java.sql.ResultSet,resultMap=productResultMap})}
</select> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-13T19:37:18.190

只是对 clav 注释的补充，Snoozy，您需要从中删除 resultSet

```
<select id="getUsers" statementType="CALLABLE" resultMap="UserResult">
    {CALL GetUsers(#    {resultSet,mode=OUT,jdbcType=CURSOR,resultMap=UserResult})} 
```

并将其更改为“key”，如下所示：

```
<select id="getUsers" statementType="CALLABLE" resultMap="UserResult">
    {CALL GetUsers(#{key,mode=OUT,jdbcType=CURSOR,resultMap=UserResult})}
</select> 
```

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-02T07:58:16.517

我也遇到了同样的错误。

> 原因：org.apache.ibatis.reflection.ReflectionException：“class java.lang.Class”中没有名为“columnNames”的属性的设置器
> 
> 在 mapper.java 中 getSearchResult(searchCriteriaVO vo)
> 
> 在 mapper.xml 中

```
 #{userId, mode=IN, jdbcType=VARCHAR},
    #{resultList, mode=OUT, jdbcType=CURSOR, javaType=ResultSet,  resultMap=inquiryResult}, 
```

其中inquiryResult 定义为

```
<resultMap type="java.util.LinkedHashMap" id="inquiryResult">
<result property="name" jdbcType="VARCHAR" javaType="String" column="name"/> 
```

挣扎了一天 但是我调试的时候，是我犯了一个简单的错误。我的值对象作为 null 传递给我的映射器类。即使我的 VO 为空，查询也会被执行，因为 mybatis 将值传递为空。但是当 mybatis 尝试将结果设置为我的 VO 时，由于它为 null，因此抛出了上述错误。

希望这是有用的信息

# simulink - 在 simulink 中更改 ODES 是什么意思

> ID：15666857
> 
> 赞同：0
> 
> 时间：2013-03-27T18:40:41.890
> 
> 标签：simulink, ode

我在 simulink 中实现了两个控制器；PID和模糊控制器。两个控制器的实现方式不同。PID 在 ode45 中实现，而模糊控制器在 ode14x 中实现。这样做是为了实现所需的响应，即收敛到参考值。但是我仍然无法理解更改 ode 是什么意思....我知道有不同的方法可以解决 odes，但是当我在 simulink 中更改 ode 时我正在做什么......请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T23:14:27.340

可以在以下位置找到对求解器的适度详细描述/比较

[http://www.mathworks.com/help/simulink/ug/choosing-a-solver.html](http://www.mathworks.com/help/simulink/ug/choosing-a-solver.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:10:01.350

ODE 是求解器。Simulink 逐步计算所有内容，因此 ODE 定义了步长（嵌套点将在 0.0001 秒后还是 0.5 秒后？）并且还计算了数值导数。

例如 ODE1 是欧拉。导数是最简单的：`dF(n)=(F(n)-F(n-1))/At` 并且`At`（时间步长）始终是用户定义的常数。

当然 ODE 并不总是完美的，也不总是在所有情况下都有效，这就是 Matlab 有这么多的原因。是的，您的 PID 有几次会在 ODE 中工作，但在其他情况下则不行。

Simulink 调试的噩梦是改变你的模型好几天，直到你意识到它是 ODE ......浪费了这么多小时......

# php - PHP/MySQL 搜索不起作用

> ID：15666859
> 
> 赞同：0
> 
> 时间：2013-03-27T18:40:44.387
> 
> 标签：php, mysql, search, field

我的 PHP/MySQL 搜索遇到了一些困难。一年前它工作得很好，但由于某种原因它刚刚停止工作。我已经尝试过搜索，但无法弄清楚。我让它回显我的查询，但它从未添加到 WHERE 子句中。任何帮助深表感谢。

表格代码：

```
<form name="search" method="post">
    <p><b>Name of Property:</b> <input type="text" id="NameSrch" name="NameSrch" /> (optional)</p>
    <p><b>City Your Looking to Stay In:</b> <input type="text" id="CitySrch" name="CitySrch" /> (optional)</p>
    <p><b>Listing ID Number:</b> <input type="text" id="RentalIDSrch" name="RentalIDSrch" /> (optional)</p>
    <p><b>Number of Bedrooms:</b> <input type="text" id="BedroomSrch" name="BedroomSrch" /> (optional)</p>
    <p><b>Number of Bathrooms:</b> <input type="text" id="BathroomSrch" name="BathroomSrch" /> (optional)</p>
    <p><b>Maximum Occupancy:</b> <input type="text" id="SleepsSrch" name="SleepsSrch" /> (optional)</p>
    <input type="hidden" name="method" value="exSearch">
    <p><input type="submit" value="Search" /></p>
</form> 
```

PHP代码：

```
<? 
                        $method = $_POST['method'];

                        if($method == 'exSearch') {

                            // Start Results Display 

                            $con = mysql_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql: ' . mysql_error());
                            mysql_select_db($dbname);

                            $query_string = 'SELECT * FROM TABLE ';

                            $location_result_string = "";
                            $location_count = 0;

                                if ($NameSrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propName) LIKE ("%$NameSrch%") ';
                                }

                                if ($CitySrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propCity) LIKE ("%$CitySrch%") ';
                                }

                                if ($RentalIDSrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propID) LIKE ("%$RentalIDSrch%") ';
                                }

                                if ($BedroomSrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propBedrooms) LIKE ("%$BedroomSrch%") ';
                                }

                                if ($BathroomSrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propBaths) LIKE ("%$BathroomSrch%") ';
                                }

                                if ($SleepsSrch) {
                                    if ($location_count > 0) {
                                        $location_result_string = $location_result_string . " AND ";
                                    }
                                    $location_count = $location_count + 1;
                                    $location_result_string = $location_result_string . ' (propSleeps) LIKE ("%$SleepsSrch%") ';
                                }

                            if ($location_count > 0) {
                                $location_result_string = "WHERE (" . $location_result_string . ")";

                                $query_string = $query_string . $location_result_string;    
                            }

                            $re = mysql_query($query_string, $con) or die (mysql_error());

                            $number_of_rows = mysql_num_rows($re);

                            // Loop through each item in the result set                 
                            for ($h = 0; $h < $number_of_rows; $h++)
                            {

                            $propID = mysql_result($re, $h, 'propID');
                            $propAvail = mysql_result($re, $h, 'propAvail');
                            $propPets = mysql_result($re, $h, 'propPets');
                            $propName = mysql_result($re, $h, 'propName');
                            $propPropertyType = mysql_result($re, $h, 'propPropertyType');
                            $propPriceRange = mysql_result($re, $h, 'propPriceRange');
                            $propBedrooms = mysql_result($re, $h, 'propBedrooms');
                            $propBaths = mysql_result($re, $h, 'propBaths');
                            $propPropertyType = mysql_result($re, $h, 'propPropertyType');
                            $propSleeps = mysql_result($re, $h, 'propSleeps');
                            $propPic1 = mysql_result($re, $h, 'propPic1');
                            $propPicDesc1 = mysql_result($re, $h, 'propPicDesc1');

                            $nameLen = strlen($propName);
                            $petsLen = strlen($propPets);
                            $pets = $propPets;

                                                           //Results go here

                            }
                            echo $query_string;
                            }

                            // End Results Display

                            ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:55:34.903

如果我对直接从表单中提取的变量的假设是正确的，那么您必须注册全局变量，这是不建议的，因为它会带来很大的安全风险。相反，我以正确的方式调整了您的 PHP 代码，还修复了查询字符串中包含的变量。

```
<?php
$method = $_POST['method'];
if($method == 'exSearch') {
    // Start Results Display 
    $con = mysql_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql: ' . mysql_error());
    mysql_select_db($dbname);
    $query_string = 'SELECT * FROM TABLE ';
    $location_result_string = "";
    $location_count = 0;
    if ($_POST['NameSrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propName) LIKE ("%'.$_POST['NameSrch'].'%") ';
    }
    if ($_POST['CitySrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propCity) LIKE ("%'.$_POST['CitySrch'].'%") ';
    }
    if ($_POST['RentalIDSrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propID) LIKE ("%'.$_POST['RentalIDSrch'].'%") ';
    }
    if ($_POST['BedroomSrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propBedrooms) LIKE ("%'.$_POST['BedroomSrch'].'%") ';
    }
    if ($_POST['BathroomSrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propBaths) LIKE ("%'.$_POST['BathroomSrch'].'%") ';
    }
    if ($_POST['SleepsSrch']) {
        if ($location_count > 0) {
            $location_result_string = $location_result_string . " AND ";
        }
        $location_count = $location_count + 1;
        $location_result_string = $location_result_string . ' (propSleeps) LIKE ("%'.$_POST['SleepsSrch'].'%") ';
    }
    if ($location_count > 0) {
        $location_result_string = "WHERE (" . $location_result_string . ")";
        $query_string = $query_string . $location_result_string;    
    }
    $re = mysql_query($query_string, $con) or die (mysql_error());
    $number_of_rows = mysql_num_rows($re);
    // Loop through each item in the result set                 
    for ($h = 0; $h < $number_of_rows; $h++)
    {
        $propID = mysql_result($re, $h, 'propID');
        $propAvail = mysql_result($re, $h, 'propAvail');
        $propPets = mysql_result($re, $h, 'propPets');
        $propName = mysql_result($re, $h, 'propName');
        $propPropertyType = mysql_result($re, $h, 'propPropertyType');
        $propPriceRange = mysql_result($re, $h, 'propPriceRange');
        $propBedrooms = mysql_result($re, $h, 'propBedrooms');
        $propBaths = mysql_result($re, $h, 'propBaths');
        $propPropertyType = mysql_result($re, $h, 'propPropertyType');
        $propSleeps = mysql_result($re, $h, 'propSleeps');
        $propPic1 = mysql_result($re, $h, 'propPic1');
        $propPicDesc1 = mysql_result($re, $h, 'propPicDesc1');
        $nameLen = strlen($propName);
        $petsLen = strlen($propPets);
        $pets = $propPets;
        // Results go here
    }
    echo $query_string;
}
// End Results Display

?> 
```

我还建议验证您的输入并检查您是否获得了所需的数据类型，例如如果您想要数字，请验证它是一个数字，这样您就不太容易受到 SQL 注入的影响。还使用 mysql_real_escape_string( [http://php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php) ) 来清理数据。

如果您希望您的脚本在未来也能正常工作，我建议您学习一两节 PDO，因为在不久的将来，PHP 将摆脱 MySQL 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:56:26.143

您正在使用 variables`$NameSrch`等`$CitySrch`而不定义它们。由于它们与表单输入的名称匹配，我假设您最初已[`register_globals`](http://www.php.net/manual/en/ini.core.php#ini.register-globals)打开，现在已关闭（或者如果您使用的是 PHP 5.4.0，则已删除）。

您需要将它们更改为`$_POST['NameSrch']`,`$_POST['CitySrch']`等。

# sql - 无法放下触发器

> ID：15666865
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:41:05.960
> 
> 标签：sql, sql-server, tsql

我在表上创建了一个触发器，现在我无法更改或删除它。我什至无法访问该表。我能做些什么？

触发脚本：

```
create  trigger [Products].[InsertLessThen5InStock]
on [Products].[Products]
after update
as
BEGIN
    DECLARE @ck int

            select UnitsInStock from Products.Products where UnitsInStock<5
    set @ck=@@ROWCOUNT
    print @ck
    if @ck >0
    BEGIN
        DECLARE @mails varchar (200)
        exec dbo.Manager_email @mails output
        EXEC msdb.dbo.sp_send_dbmail
        @profile_name =             'DefaultMailSender',
        @recipients =               @mails ,
        @body =                     'Products that will expire in less then 5 days',
        @subject =                  'Products that will expire in less then 5 days',
        @body_format =              'HTML',
        @query =                    'EXECUTE MadCat.dbo.SaveTableAsHTML 
                                @DBFetch =''select UnitsInStock from Products.Products where UnitsInStock<5'''

    END
END
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:49:21.157

由于它抱怨无法获得锁，这意味着某些进程已独占保留该表。您应该尝试重新启动服务器，然后发出 drop trigger 命令。

```
drop trigger [Products].[InsertLessThen5InStock] 
```

# object-recognition - 从混淆矩阵到 ROC 图

> ID：15666866
> 
> 赞同：2
> 
> 时间：2013-03-27T18:41:14.903
> 
> 标签：object-recognition, roc, confusion-matrix

我最近基于[本文](http://217.109.185.161/layout/set/print/content/download/20785/148346/file/2004_010.pdf)中描述的算法实现了一个词袋分类算法。

一切都很好，但我想使用 ROC 曲线或精确召回图来测量分类器的准确性。

我可以很容易地得到每个分类器的混淆矩阵，但我不知道我应该改变什么参数来获得更多的点并实际绘制曲线。

有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-24T05:13:47.057

我认为分类器的输出必须是连续值而不是离散值才能绘制 ROC 曲线。如果预测的标签是连续值，那么您可以设置一个阈值来计算 ROC 曲线中的点。如果预测的标签属于两类（离散值），那么您只会在 ROC 曲线中得到一个点。

[http://en.wikipedia.org/wiki/Receiver_operating_characteristic](http://en.wikipedia.org/wiki/Receiver_operating_characteristic)

# django - Django自定义模型方法抛出属性错误

> ID：15666878
> 
> 赞同：3
> 
> 时间：2013-03-27T18:41:59.193
> 
> 标签：django, django-models

我真的希望我不必为此求助于 SO ，但现在它让我发疯了，所以这里......

```
# models.py
[...]
from datetime import datetime as dt

class Foo(models.Model):
    [...]
    date_time = models.DateTimeField(auto_now_add=True)

    class Meta:
        ordering = ['-date_time']

    def is_fresh(self):
        if (dt.now() - self.date_time).seconds < settings.FOO_LIFESPAN:
            return True
        else:
            return False

    def __unicode__(self):
        return u'%s|%s %s' % ([...], self.date_time) 
```

当我尝试使用`is_fresh()`我得到的方法时`AttributeError: 'Foo' object has no attribute 'is_fresh'`。

我已经看到其他在 SO 上遇到此问题的人已通过修复缩进来解决它。我相信这里的情况并非如此（著名的遗言）。我在 Eclipse 中工作，没有任何其他与缩进相关的偷偷摸摸的错误......

有什么想法吗？

## 编辑

我将其用作 Dajaxice/Dajax 函数的一部分。

```
# ajax.py

def seek_bar(request, name):
    # Other stuff goes here. I know that it works 100%
    foo_list = []
    [...]
    for receipt in receipts:
        foo_list.append((receipt.foos.all()[0], receipt.pk))
        [...]

    # Check freshness
    for (foo, bar) in foo_list:
        if foo.is_fresh():
            dajax.add_css_class('#timer_0%s' % bar, 'fresh')
        else:
            dajax.remove_css_class('#timer_0%s' % bar, 'fresh')
            dajax.add_css_class('#timer_0%s' % bar, 'stale') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T11:19:30.847

我想通了，我想踢墙！

问题与我的文件结构以及我如何导入模型有关。我有两个应用程序共享相同的models.py，所以我把它放在一个单独的文件夹中，如下所示：

```
my_project/
        |
      backend/
            |
          models/
             - __init__.py
             - models.py 
```

在 ajax.py 中，我像这样导入 Foo `from my_project.backend.models import Foo, ...,`：. 它适用于我需要的一切，直到`is_fresh()`出现。我刚试过`from my_project.backend.models.models import Foo, ...,`，你瞧——它奏效了！而且我觉得很傻...

如果有人能告诉我为什么`...backend.models`除了我的自定义方法之外的所有东西都有效，但我需要`...backend.models.models`完整的功能，很高兴知道。

# c - 一个 C 结构中的一个 TCHAR 成员 - 如何动态分配结构的成员和数组？

> ID：15666880
> 
> 赞同：0
> 
> 时间：2013-03-27T18:42:04.190
> 
> 标签：c, struct

我有这个结构：

```
struct sArray {
TCHAR *sName;
}; 
```

我现在想为 sArray 数组动态分配内存，并为 sName 动态分配内存。所以我可以使用 var[0].sName、var[1].sName...var[x].sName 之类的东西。

我正在寻找一个简单的解决方案——这里和网上有大量关于动态分配的文章，但没有人回答这个问题。

那么，我该怎么做呢？完成后如何释放成员和数组内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:49:38.900

```
// +1 for the NULL terminal byte
TCHAR *names = (TCHAR *)calloc(1, (maxNameLen+1) * NumberOfNames);
struct sArray *array = (struct sArray *)malloc(numberOfArrays);
array[0].sName = names[0];
...
...

free(names);
free(array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:49:54.940

试试这个：

```
int len = 20; //number of elements (sArray's) you want in ar.
struct sArray *arr = malloc(length*sizeof(struct sArray));
int i;
int nameLength = 30; // max length of name
for (i = 0; i < length; ++i)
    arr[i].sName = malloc(nameLength*sizeof(TCHAR)); 
```

并释放内存：

```
for (i = 0; i < length; ++i)
    free(arr[i].sName);
free(arr); 
```

# javascript - 无法使用 jsbn 正确加密 Javascript 中的数据

> ID：15666885
> 
> 赞同：0
> 
> 时间：2013-03-27T18:42:14.617
> 
> 标签：javascript, encryption, cryptography, rsa, jsbn

我无法使用 Tom Wu 的 jsbn 库在 JavaScript 中加密数据。

我最终得到了一个加密数据，但是当我尝试在 PHP 上解密数据时，openssl_private_decrypt 返回 false。

我编码公钥的方式有可能吗？

这是加密数据的 JavaScript 代码。

```
function encryptData(data)
{
    var $oDataEncrypted = "";

    // Do not forget to escape the lines:
    var $pem = "-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCoEu5N3x/6aK7E4A9f+7AV/A9T\nT6zu5zdM6L+6XViYC6JssiV1JVE/x/5yd4mVrG8CFkOaF9QqOIFFnQnQw+O+5B/3\nRdoIAssExytGyjY7k11u9jKZI+xRslCxQRoQnUzEVE29Vr6TWUwpxrnpsl+z/5ej\n+Yk8UsMJRkBvmSMdDwIDAQAB\n-----END PUBLIC KEY-----";

    // Create the RSA object.
    var $key = RSA.getPublicKey($pem);

    $oDataEncrypted = RSA.encrypt(data, $key);

    return $oDataEncrypted;
} 
```

一种想法是“\n”，也许 JavaScript 与 PHP 不同，它不会自动理解结构，或者库不会。

我正在使用在以下位置获得的最新文件：

[http://www-cs-students.stanford.edu/~tjw/jsbn/](http://www-cs-students.stanford.edu/~tjw/jsbn/)

[https://github.com/ziyan/javascript-rsa/tree/master/src](https://github.com/ziyan/javascript-rsa/tree/master/src)

为了进行测试，我将加密值（使用 Visual Studio 用于 JavaScript 端进行测试）复制并粘贴到我的 PHP 文件中。我将密钥传递给 openssl_private_decrypt() 并返回 FALSE。遗憾的是，openssl_private_decrypt 没有返回原因，JavaScript 代码似乎返回了一个值，并且没有抛出或返回错误。

我的猜测是与公钥有关，但显然问题可能出在其他地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T21:11:25.627

为了后代，我会给出答案。答案已经在我面前出现了一段时间，只是太密集而无法意识到。

JavaScript 以 base-64 编码数据，因此必须先对数据进行解码，然后 PHP 才能识别它。因此，在 PHP 端，需要做一个简单的添加：

```
if(!openssl_private_decrypt(base64_decode($dataArg1), $sensitiveData, $key)) 
```

我将 data 参数包装在 base64_decode() 中。

# c# - C# WndProc 事件处理程序

> ID：15666891
> 
> 赞同：1
> 
> 时间：2013-03-27T18:42:34.113
> 
> 标签：c#, controls, wndproc

我在设计器中向我的表单添加了一个表单控件。但我需要覆盖该控件的 WndProc。我可以在不创建扩展旧控件的新控件的情况下做到这一点吗？因为当我像这样扩展旧的时，我的设计师将不再工作：

```
partial class ThatControlWithWndProc : TheControlIActuallyWant {} 
```

或者我怎样才能让我的设计师使用我创建的这个新控件而不给我一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:45:01.010

如果您只是`.Designer.cs`直接编辑文件以引用您的重写控件，并确保它遵循控件与设计器兼容的规则（例如具有默认构造函数，并且不依赖任何其他初始化），那么您应该没问题。

# file - LOG4PHP 文件大小错误

> ID：15666893
> 
> 赞同：1
> 
> 时间：2013-03-27T18:42:36.620
> 
> 标签：file, logging, shared-hosting, log4php

我在 GoDaddy 共享主机（php 5.3.13）上将此脚本作为 cron 作业运行，并且正在使用 log4php。该脚本似乎运行良好，并完成。但是当 log4php 试图完成时，它会抛出这个错误。

它似乎确实输出了文件及其内容。我什至将文件的权限更改为 777。它似乎在进行文件大小检查时抛出了这个错误......

任何有关此错误的原因/解决方案的帮助将不胜感激。

错误：

```
<b>Fatal error</b>: Uncaught exception 'ErrorException' with message '2: filesize() [&lt;a href='function.filesize'&gt;function.filesize&lt;/a&gt;]: stat failed for log.txt, file: /home/content/89/10338789/html/Forum/phpBB3/program/log4php/appenders/LoggerAppenderRollingFile.php, line: 223' in /home/content/89/10338789/html/Forum/phpBB3/program/log4php/appenders/LoggerAppenderRollingFile.php:223
Stack trace:
#0 [internal function]: errorHandler(2, 'filesize() [&lt;a ...', '/home/content/8...', 223, Array)
#1 /home/content/89/10338789/html/Forum/phpBB3/program/log4php/appenders/LoggerAppenderRollingFile.php(223): filesize('log.txt')
#2 /home/content/89/10338789/html/Forum/phpBB3/program/log4php/appenders/LoggerAppenderFile.php(165): LoggerAppenderRollingFile-&gt;write(NULL)
#3 /home/content/89/10338789/html/Forum/phpBB3/program/log4php/LoggerAppender.php(85): LoggerAppenderFile-&gt;close()
#4 [internal function]: LoggerAppender-&gt;__destruct()
#5 {main}
thrown in <b>/home/content/89/10338789/html/Forum/phpBB3/program/log4php/appenders/LoggerAppenderRollingFile.php</b> on line <b>223</b><br /> 
```

配置文件：

```
<configuration xmlns="http://logging.apache.org/log4php/">

    <appender name="myConsoleAppender" class="LoggerAppenderConsole">
        <filter class="LoggerFilterLevelRange">
            <param name="levelMin" value="info" />
        </filter>
    </appender>

    <appender name="myFileAppender" class="LoggerAppenderRollingFile">
        <layout class="LoggerLayoutPattern">
            <param name="conversionPattern" value="%date %-5level - %message%newline" />
        </layout>
        <param name="file" value="log.txt" />
        <param name="maxFileSize" value="10MB" />
    </appender>

    <appender name="myEmailAppender" class="LoggerAppenderMail">
        <layout class="LoggerLayoutSimple" />
        <param name="to" value="jonathonwisnoski@hotmail.com" />
        <param name="from" value="logger@xxx.ca" />
        <filter class="LoggerFilterLevelRange">
            <param name="levelMin" value="info" />
        </filter>
    </appender>

    <root>
        <appender_ref ref="myConsoleAppender" />
        <appender_ref ref="myFileAppender" />
        <appender_ref ref="myEmailAppender" />
    </root>
</configuration> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-13T14:56:17.423

...或者您将 LoggerAppenderRollingFile.php 中的错误代码行更改为：

```
if (filesize(realpath($this->file)) > $this->maxFileSize) { 
```

[http://php.net/manual/en/function.realpath.php](http://php.net/manual/en/function.realpath.php)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T00:23:42.113

这是一个 LoggerAppenderRollingFile 问题，您需要使用绝对路径来记录文件（解决方法）。脚本执行后 LoggerAppender::__destruct 被调用并且相关文件日志 (log.txt) 找不到。

改变：

```
log4php.appender.<yourappender>.file=log.txt 
```

到

```
log4php.appender.<yourappender>.file=/absolutepath/log.txt 
```

相关主题：

1.  [http://www.php.net/manual/en/function.register-shutdown-function.php#92657](http://www.php.net/manual/en/function.register-shutdown-function.php#92657)
2.  [为什么 getcwd() 在 __destruct() 中返回 /？](https://stackoverflow.com/questions/14678947/why-does-getcwd-returns-in-destruct)
3.  [https://bugs.php.net/bug.php?id=34206](https://bugs.php.net/bug.php?id=34206)

# ios - 可可点与像素和 PPI

> ID：15666896
> 
> 赞同：1
> 
> 时间：2013-03-27T18:42:49.973
> 
> 标签：ios, pixel, screen-resolution, ppi

好吧，关于 iOS 设备的屏幕分辨率，我基本上有两个问题。

1) 在 iOS 文档中，在 Point vs Pixels 部分，它声明坐标作为点传递给框架，并且“一个点不一定对应于屏幕上的一个像素”。在这里找到：[https ://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/WindowsandViews/WindowsandViews.html](https://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/WindowsandViews/WindowsandViews.html)

当它们不同时？到目前为止，我假设它们相等并传入像素坐标。这是一个随设备变化的参数吗？

2）我对PPI也有点困惑。我知道这在硬件屏幕上意味着什么（如果 10" 和 7" 显示器具有相同的像素分辨率，那么 7" 显示器将具有更好的图像质量，因为 PPI 更高）。但是如果我保存它有什么区别72ppi 或 96 甚至 326 的 .png？它只是用于打印还是在我的屏幕上视觉上有什么不同？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T19:01:52.413

在 Retina 设备（iPhone 4、4S 或 5，以及 iPad 3 或 4）上，每个点有 2 个像素。在非视网膜设备上，每个点有 1 个像素。

除 iPhone 5 外，所有 iPhone 的屏幕尺寸均为 320x480 点。视网膜 iPhone 的屏幕尺寸为 640x960 像素（但点大小与非视网膜设备相同）。

在 iOS 中处理图像时，重要的是像素大小，而不是 PPI。请记住，您的 @2x 图像的宽度和高度应该是常规非视网膜图像的两倍。

# php - strpos() 期望参数 1 是字符串，给定资源

> ID：15666902
> 
> 赞同：-6
> 
> 时间：2013-03-27T18:43:22.060
> 
> 标签：php, strpos

**我希望 $description 是从 Description 列中提取的一串单词。然后我想检查字符串是否有 $searchterm（在这段代码之前定义的一个词）。**

```
//3\. (a)for each, (b) if search term is in the description column, put line into sorted table.
// a. number of rows in spreadsheet
    $results = mysql_query("SELECT * FROM csv"); 
    $num_rows = mysql_num_rows($results);

// b. check rows and put into sorted table
    $i=1;
do
  {
  $i++;
  $description = mysql_query("SELECT Description FROM csv");

  if (strpos($description,$searchterm) !== false) {
          echo $description . "<br><br>";
      } // end if 

  } // end do
while ($i<=$num_rows); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:45:15.580

这是一个基本的 PHP/MySQL 教程将教你的东西。`mysql_query()`产生一个资源标识符。您仍然需要使用`mysql_fetch_assoc()`.

```
$result= mysql_query("SELECT Description FROM csv");
$row = mysql_fetch_assoc($result);

  if (strpos($row['description'],$searchterm) !== false) { 
```

我还建议遵循上述评论中的建议。您正在编写的代码在您键入时已过时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:46:16.520

```
if(mysql_num_rows($description) >=1){
 $result = mysql_fetch_assoc($description);
  $words = $result['Description'];
 if (strpos($word ,$searchterm) !== false) {
          echo $word. "<br><br>";
      } 
} 
```

计数是否先返回行然后获取。重要的是，使用[PDO](http://php.net/pdo)而不是`mysql`. 它已被弃用。

# php - 使用 $_GET 从 URL 中获取具有相同 id 的多个值并更新数据库

> ID：15666906
> 
> 赞同：0
> 
> 时间：2013-03-27T18:43:40.273
> 
> 标签：php, mysql, forms, get, checkbox

我遇到了一个问题，试图使用一系列复选框从列表中选择多个设备，以便用户可以“签出”这些项目。

这是我提交数据的第一页

```
 <div class="list"><form action="remove.php" enctype="multipart/form-data"
         name="form" id="form">

<input type="submit" style="color: white; background: none repeat scroll 0% 0%
 black; font-size: 21px; padding-bottom: 30px; position: fixed; height: 30px;
 right: 0px; margin-right: 1px;"
     value="Checkout" />
    <table cellpadding="0" cellspacing="0" border="0" id="table">
<thead>
<tr>
<th>Select</th>
<th>Equipment Number</th>
<th>Equipment</th>
</tr></thead>
    <tbody>
  <? $sql    = "SELECT * FROM equipment";
    $result = mysql_query($sql);
    while ($rows = mysql_fetch_array($result)) {
        if ($rows['equip_avail'] == "1") {
?>

<tr>
<td width="5%"><input type="checkbox" name="equip_id" value="<?php echo 
$rows['equip_id']; ?>" /></td>
<td width="13%"><?php echo $rows['equip_num'];?></td>
<td width="20%"><?php echo $rows['equipment']; ?></td>
</tr>
<?php
        }
    }
    echo '</tbody></table></form></div>';
}
?> 
```

这是然后从 url 获取数据并将其发布以确认的页面，我需要此页面能够从 url 获取多个“equip_id”（或我目前不知道的其他解决方法）并更新信息正确的“user_id”。我可以让多个出现在 URL 中，但只有最后一个被抓取。

```
 $id = $_SESSION['id'];
$equip_id =$_GET['equip_id'];
$sql = mysql_query("SELECT * FROM equipment WHERE equip_id='$equip_id'"); 
while($row = mysql_fetch_array($sql)){
    $equip_id = $row['equip_id'];
    $equipment = $row["equipment"];
    $equip_num = $row["equip_num"];
    $equip_avail = $row["equip_avail"];
    $user_id= $row['user_id'];
}

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $user_id = $_POST['user_id'];
    $equip_avail = $_POST['equip_avail'];
    $sql = mysql_query("UPDATE equipment SET user_id='$user_id', 
    equip_avail='$equip_avail' WHERE equip_id='$equip_id'"); 

    header("Location: equipment_checkout.php");
exit();
} // close if post
?> 
```

这是 HTML

```
 <table height="225px">
<form action="<? echo 'remove.php?equip_id='.$equip_id.' '?>"
   method="post" enctype="multipart/form-data" name="form" id="form">
<td width="423" valign="top"><h2>Equipment: <?php echo $equipment?></h2>
    <h2>Equipment Number: <?php echo $equip_num?></h2>
<input name="equip_avail" type="hidden" id="equip_avail" value="0" size="30"
maxlength="24" />
<?if(($_SESSION['id'] !=='0') && ($uaccounttype !== 'e') &&
($uaccounttype !== 'd')){?>
<input name="user_id" type="hidden" id="user_id" value="<? echo $_SESSION['id']
?>" size="30" maxlength="64" />
    </tr><?} else {
        $sql="SELECT * FROM members WHERE accounttype IN ('b', 'c', 'e')";
    $result = mysql_query($sql);            
        ?> 
<h2>Select Employee: <select name="user_id" id="user_id">
<?  $count = 1;
    while($rows = mysql_fetch_array($result)){
        if($count == 1){?>
<option value="<?echo $rows['id'];?>">
<?  echo $rows['firstname']. " ". $rows['lastname'] ;}} ?></option>
</select></h2>
<?}?>       
    <input name="Submit" type="submit" value="Check Out"/>
    </br>
   </td>
  </form>
</table>
</div> 
```

我需要这最后一部分做的是从第一页中选择的每个“equip_id”都显示在这里，然后用正确的“user_id”为每个选定的设备更新数据库。就像我说的，我可以一次更新一个，我只需要制作它以便可以编辑大量内容。

**注意：我知道这不是一种*安全*的数据发送方式，如果有任何关于如何更安全的建议，我会喜欢的。谢谢你！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:46:08.820

您需要将输入名称设为数组 ( `equip_id[]`)：

```
<input type="checkbox" name="equip_id[]" value="<?php echo $rows['equip_id']; ?>" /> 
```

然后`$_GET['equip_id']`将是一个`$rows['equip_id']`s 数组。

虽然肯定会更好用`$_POST`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T17:10:00.310

这是我根据答案想出的，它会根据“equip_id”发布所有选择的设备，然后相应地更新设备。我在这里发帖以防其他人正在寻找相同的解决方案。

我按照你的建议更新了这一行

```
<input type="checkbox" name="equip_id[]" value="<?php echo $rows['equip_id']; ?>" 
```

这是从第一页读取数据的第二页。

```
<?foreach ($_GET['equip_id'] as $equip_id) {

$sql = mysql_query("SELECT * FROM equipment WHERE equip_id='$equip_id'") or
die(mysql_error()); 
while($row = mysql_fetch_array($sql)){
$equipment = $row["equipment"];
$equip_num = $row["equip_num"];
$equip_avail = $row["equip_avail"];
$user_id= $row['user_id'];
$equip_id= $row['equip_id'];}?>
<td width="423" valign="top"><h2>Equipment:
<?php echo $equipment?></h2>
    <h2>Equipment Number:<?php echo "$equip_num"?></h2>
<?} 
```

这是发布数据的部分。

```
if ($_SERVER['REQUEST_METHOD'] === 'POST'){
foreach ($_GET['equip_id'] as $equip_id) {
    $equip_id = $equip_id ;
    $user_id = $_POST['user_id'];
$sql = mysql_query("UPDATE equipment SET user_id='$user_id', equip_avail='0'
WHERE equip_id='$equip_id'") or die(mysql_error());} 
header("Location: member_equipment.php?id='$id'");
exit();} 
```

# c# - 如何在 ssis 中使用 YYYYMMDDHHMMSS.txt 格式的脚本任务创建文件

> ID：15666912
> 
> 赞同：-5
> 
> 时间：2013-03-27T18:43:56.173
> 
> 标签：c#, sql

如何使用脚本任务创建 Employee_YYYYMMDDHHMMSS.txt 格式的文本文件，并且每次我们运行该任务时，秒数都应该增加

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:47:15.523

```
 string Filename = "Employee_" + DateTime.Now.ToString("yyyyMMddHHmmss") + ".txt";
    StreamWriter Writer = new StreamWriter(Filename);
    Writer.WriteLine("Line");
    Writer.Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:50:10.330

在 C# 中，您可以像这样构建该字符串：

```
var fileName = string.Format("Employee_{0}.txt",
    DateTime.Now.ToString("yyyyMMddHHmmss")); 
```

在 T-SQL 中，您可以通过以下方式获取该字符串：

```
SELECT 'Employee_'
    + CAST(DATEPART(year, GETDATE()) AS VARCHAR(4))
    + RIGHT('0' + CAST(DATEPART(month, GETDATE()) AS VARCHAR(4)), 2)
    + RIGHT('0' + CAST(DATEPART(day, GETDATE()) AS VARCHAR(4)), 2)
    + RIGHT('0' + CAST(DATEPART(hour, GETDATE()) AS VARCHAR(4)), 2)
    + RIGHT('0' + CAST(DATEPART(minute, GETDATE()) AS VARCHAR(4)), 2)
    + RIGHT('0' + CAST(DATEPART(second, GETDATE()) AS VARCHAR(4)), 2)
    + '.txt' 
```

# java - 暂停并等待按钮被点击，然后继续

> ID：15666914
> 
> 赞同：0
> 
> 时间：2013-03-27T18:44:07.040
> 
> 标签：java, multithreading, swing

我正在尝试构建一个简单的tictactoe 网络游戏。我需要程序等到玩家移动然后继续。在我的代码底部的 whileConnected() 函数中，我有一个 while(true) 循环，它应该永远运行并在按下按钮时显示一条确认消息（这表明字符串的内容变量“消息”的变化）。

问题是，即使单击按钮时字符串消息变量发生变化，我的 whileConnected() 函数也永远不会意识到这一点，并且函数内的 if 语句永远不会计算为真。ButtonListener 类中的相同 if 语句可以正常工作并显示所需的确认消息。

我怎么解决这个问题？我读了又读，我知道我应该使用线程（我读过它们，但我以前从未使用过它们，这就是为什么它只是一个猜测）。我需要线程吗？有人可以简单地解释一下应该用于这个特定问题的原则吗？（如何让程序暂停直到单击按钮，然后继续使用单击按钮时创建的相关信息）。一个代码示例真的会减轻我对线程的阅读——对于初学者来说，这是一个非常抽象的话题。

以下是我的代码，在此先感谢。

```
public class Test extends JFrame
{
    private Container contentPane;
    private JButton btn00;
    private static String message = "";

    private class ButtonListener implements ActionListener
    {

        @Override
        public void actionPerformed(ActionEvent e)
        {
            String buttonText = e.getActionCommand();

            if (buttonText.equals("My Button"))
            {
                message = "pressed";
                if (message != "")
                    System.out.println(message+"(executed by ButtonListener)");
            }           
        }

    }

    public Test()
    {
        this.contentPane = this.getContentPane();
        btn00 = new JButton("My Button");
        btn00.setSize(btn00.getPreferredSize());
        btn00.setLocation(20,20);
        ButtonListener listener = new ButtonListener();
        btn00.addActionListener(listener);

        // configure frame
        this.setSize(300,300);
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);

        // make panel
        JPanel panel = new JPanel();
        panel.setSize(200,200);
        panel.setLocation(10,10);
        panel.add(btn00);
        this.contentPane.add(panel);        
    }

    public static void main(String[] args)
    {
        Test gui = new Test();
        gui.setVisible(true);
        // connected
        whileConnected();

    }

    private static void whileConnected()
    {
        System.out.println("message is at first empty: "+message);
        while (true)
        {
            // the if below never evaluates to true... why?

            if (message != "") // this is never true
                System.out.println(message+"(executed by whileConnected)");         
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:54:39.043

如果您使用的是 swing，那么您已经在使用线程。Swing 本质上具有一个用于 I/O 的线程和一个用于后端的线程。你确实想在这里使用线程——除此之外，让一个线程等待比给它一个无限循环来搅动要便宜得多。

侦听器是线程的另一种应用，如果您可以通过使用结构良好的侦听器获得大部分或全部所需内容，我不会感到惊讶。或者，这些东西称为信号量。信号量是线程处理时间的一种方式——如果一个线程试图锁定一个已经锁定的信号量，它会等到另一个线程解锁它后再继续（并再次锁定它）。在您的情况下，您可以尝试以下方法。

*   有一个按钮监听器、一个主函数和一个锁定信号量。
*   主函数启动，执行任何初始行为，并尝试获取信号量。由于信号量已经被锁定，所以它保持不变。
*   当按钮监听器触发时，它所做的一件事就是解锁信号量。
*   一旦信号量解锁，主函数就会抓住它（从而再次锁定它）并执行它应该做的任何事情。最终，它完成了，并尝试再次获取（锁定的）信号量，从而等待按钮侦听器下一次触发。
*   重复。

编辑：包括并解释实际接受的解决方案（来自下面的评论）。

修复：`Thread.sleep(1000);`在 whileConnected 函数中添加到 while 循环的内部。

说明：while 循环是一个无限循环，只包含一个 if 语句。这个 if 语句在很长一段时间内（至少就计算机而言）评估为假（因此什么也不做）。这与电气短路的作用大致相同——没有什么可以减慢它的速度，因此运行该 main 函数的线程会消耗大量计算资源而无所事事。这是不好的。有可能某些故障安全机制启动并杀死了线程。线程可能以更丑陋的方式失败或破坏了某些东西。在任何情况下，包括一个 sleep 语句（在这种情况下，每个循环都休眠一秒钟，因为它以 ms 为单位）可以防止这种情况发生，从而允许函数无限期地继续。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T19:22:56.447

Swing 与大多数 GUI 框架一样，是一个事件驱动的环境。基本上这意味着，应用程序将等待某种事件发生，然后将触发任何注册的侦听器，它们正在等待该事件的通知。

在您的情况下，您只需将 a 注册`AdtionListener`到按钮。当用户单击它（或通过键盘激活）时，`actionPerformed`将调用该方法，您可以执行所需的任何代码。

查看[如何编写动作监听](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)器以获取更多信息。

Swing 也是一个单线程框架。也就是说，与 UI 的所有交互都必须在 Event Dispatching Thread 的上下文中执行。

这也意味着，任何长时间运行或阻塞的任务必须从单独的线程中执行，以免阻塞 EDT 处理传入事件和重绘请求，这可能会使您的应用程序看起来好像它已挂起。

查看[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)获取更多详细信息

在我看来，您的游戏协议将需要某种方式来跟踪它是谁的回合。这将通过使用虚拟令牌简单地实现。

基本概念是，除非玩家拥有令牌，否则他们无法移动。一旦玩家移动，该移动和令牌被发送给其他玩家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:12:39.447

我认为根据定义，游戏会暂停，直到按下按钮，因为 gui 不会运行主线程，它应该在事件调度线程中运行。

Swing 在线程和侦听器方面肯定有许多陷阱，如果没有正确实施，可能会导致一些不可预知的行为。

您是否阅读过有关 Oracle for Swing 的 Java 教程？最相关的是[http://docs.oracle.com/javase/tutorial/uiswing/events/index.html](http://docs.oracle.com/javase/tutorial/uiswing/events/index.html)中针对 Listeners 和 [http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index的示例.html](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)用于 WorkerThreads

我发现 Swing 最好的办法是在此处下载示例并尝试对其进行扩展

不过，我同意 Ben Barden 的观点，根据我对您需要什么的理解，我认为您可以使用侦听器来实现您所需要的。

# javascript - 如何动态调用图像？

> ID：15666915
> 
> 赞同：0
> 
> 时间：2013-03-27T18:44:17.563
> 
> 标签：javascript, html

我想调用`pic1`并`pic2`...`picn`使用名为`image`.

`image`对象示例代码。

```
for (var src in images) {
    image[src] = new Image();
    image[src].onload = function () {
        counter++;
    };
    image[src].src = images[src];
} 
```

```
image.pic1,image.pic2 ......image.picn 
```

image: Object 我尝试使用几种方式来调用图像对象：

```
col = 1; image.pic+col: NaN image.'pic'+col: image.'pic'+'1': image.pic+'1': "undefined1" image.[pic+col] image.[pic1]: 
```

运行下一个代码：

```
for(var col = 1; col < n ; col++) {
    CanvasA.drawImage(image.pic1, x, y, 300, 300);
    //CanvasA.drawImage(image.pic2, x, y, 300, 300);
    //...............
    //...............
    //CanvasA.drawImage(image.picn, x, y, 300, 300);
} 
```

这是代码的一部分：

```
for(var squer = 1;squer < 8 ; squer++ ) {
    y = (squer * 100)-100;

    for(var col = 0; col < 14 ; col++) {
        if (map.raw[squer][col+1] == 1) {
            x = ((col+1) * 100)-100;
            CanvasA.drawImage(image.LEAF1, x, y, BACKGROUND.LEAF.w, BACKGROUND.LEAF.h);
            //CanvasA.fillRect(x,y,100,100);
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:56:53.897

你有一个错字：“图像”应该是“图像”；

尝试：

```
var counter = 0;

for (var src in image) {
    image[src] = new Image();
    image[src].onload = function () {
        counter++;
    };
    image[src].src = images[src];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:58:02.110

将新创建的图像推送到另一个数组中

```
var imageObjects = [];
for (var src in images) {
    image[src] = new Image();
    ...
    imageObjects.push( image[ src ] );
} 
```

然后

```
for(var col = 1; col < n ; col++){
    for ( var i; i < imageObjects.length; i ++ ){
        CanvasA.drawImage( imageObjects[i], x, y, 300, 300 );
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:09:36.870

它应该是

```
image.["pic" + col] 
```

# php - 奇怪的 var_dump 行为

> ID：15666916
> 
> 赞同：4
> 
> 时间：2013-03-27T18:44:17.860
> 
> 标签：php, xdebug

我有以下代码行：

```
var_dump(array()); 
```

在一个文件中，它输出以下内容：

```
array (size=0)
  empty 
```

在第二个文件中，它输出：

```
string '<pre class='xdebug-var-dump' dir='ltr'>
<b>array</b> <i>(size=0)</i>
  <i><font color='#888a85'>empty</font></i>
</pre>' (length=119) 
```

任何想法是什么导致第二个文件中出现这种情况？当我查看第二个文件的渲染标记的来源时，我看到了：

```
<pre class='xdebug-var-dump' dir='ltr'><small>string</small> <font color='#cc0000'>'&lt;pre class=&#39;xdebug-var-dump&#39; dir=&#39;ltr&#39;&gt;&#10;&lt;b&gt;array&lt;/b&gt; &lt;i&gt;(size=0)&lt;/i&gt;&#10;  &lt;i&gt;&lt;font color=&#39;#888a85&#39;&gt;empty&lt;/font&gt;&lt;/i&gt;&#10;&lt;/pre&gt;'</font> <i>(length=119)</i>
</pre> 
```

**更新1：**视图->第一个文件的源：

```
<pre class='xdebug-var-dump' dir='ltr'>
<b>array</b> <i>(size=0)</i>
  <i><font color='#888a85'>empty</font></i>
</pre> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:48:40.230

`var_dump()`替换为 Xdebugs 自定义函数，如下所述：

> Xdebug 替换了 PHP 的 var_dump() 函数来显示变量。Xdebug 的版本包括针对不同类型的不同颜色，并对数组元素/对象属性的数量、最大深度和字符串长度进行了限制。还有一些其他函数处理变量显示。

[http://xdebug.org/docs/display](http://xdebug.org/docs/display)

猜猜你在第二个文件中以某种方式/在哪里实现 xdebug。

# javascript - JavaScript：数组的最大值不起作用

> ID：15666917
> 
> 赞同：1
> 
> 时间：2013-03-27T18:44:18.683
> 
> 标签：javascript, jquery

我有这个 javascript 代码：http: [//jsfiddle.net/MvWV7/5/](http://jsfiddle.net/MvWV7/5/)

我想要实现的是用户应该从 1 开始填充输入。在用户输入 1 之后，下一个值必须是 2（不是 nanother 数字）等等。

我正在尝试通过这样做来填充数组中的输入值（如小提琴所示）：

```
var ary = [];   
$(".activity_order").not(self).each(function(t) {ary.push(this.value);}) 
```

但是当我这样做时

```
ary.max() 
```

我明白了

```
Uncaught TypeError: Object ,,,,,,,, has no method 'max' 
```

在控制台中，`ary.max()`如果没有数字，我会得到 0

**更新**

我的错，我在 jsfiddle 中使用谷歌控制台，我开始在里面查找数组方法。当我做 ary.max() 它给出 0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:48:59.007

您大概是`[].max`在 jsfiddle 域的控制台中输入内容。注意输出：

```
function () {
    return Math.max.apply(null, this); // 'this' is your array
} 
```

这里的原因是 jsfiddle 域上的代码修改了原型`Array`以包含该`max`方法。它被映射到`Math.max`方法，并且本身并不驻留在`Array`对象本身或其原型上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:47:45.440

数组没有`.max()`方法。如果要创建一个，则必须编写或获取一个函数来遍历数组并找到数组中的最大值。

事实证明，您可以使用该`Math.max()`函数来解决此问题，如下所示：

```
var m = Math.max.apply(null, ary); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:48:01.320

*数组*没有`max`方法。但是`Math.max`你可以使用它。

`var m = Math.max.apply(0, ary);`

你不能这样称呼它的原因`Math.max(ary)`是它`Math.max`接受一系列值而不是数组。调用 using `apply`，将第二个数组参数转换为参数序列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T18:48:27.680

问题是，`.max`不`.min`存在。它们不是方法，就像抛出的错误所说的那样。

您必须修改数组原型以按照您提供的语法执行某些操作。

这已经在这里讨论过：[JavaScript: min & max Array values?](https://stackoverflow.com/questions/1669190/javascript-min-max-array-values)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:49:08.840

数组对象本身没有`max()`和`min()`方法。您应该在尝试使用它之前添加它们。

```
Array.prototype.min = function () {
  return this.reduce(function (p, v) {
    return ( p < v ? p : v );
  });
}

Array.prototype.max = function () {
  return this.reduce(function (p, v) {
    return ( p > v ? p : v );
  });
} 
```

这是添加了此方法[的您的代码的工作分支。](http://jsfiddle.net/MvWV7/6/)

# ios - 使用 UITableViewCellStyle 注册 UITableViewCell

> ID：15666918
> 
> 赞同：4
> 
> 时间：2013-03-27T18:44:23.973
> 
> 标签：ios, uitableview, xcode4

我知道我可以将类或 NIB 文件注册为 UITableViewCell。但我想做iOS 6的方式

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (!cell) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle
                                  reuseIdentifier:CellIdentifier]; 
```

我怎么能在仍然使用的同时实现这一点（指定单元格样式）`registerClass:ForReuseIdentifier:`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:17:28.433

如果您使用注册类或注册笔尖，那么您根本不使用 if(!cell) 子句，您应该使用 dequeueReusableCellWithIdentifier:forIndexPath: 而不是您正在使用的那个。您将获得您在笔尖或类中创建的任何样式。通常，这不会是任何 Apple 默认样式，而是您自己的自定义样式。

如果您只想要 Apple 的预定义样式之一，那么最简单的方法是在 IB 中选择该样式并给它一个重用标识符——在这种情况下，您应该注册任何内容，系统将自动从情节提要中获取单元格。

# python - 扫描大型文本语料库，计算词汇中的短语

> ID：15666919
> 
> 赞同：0
> 
> 时间：2013-03-27T18:44:24.813
> 
> 标签：python, mysql, text-mining

我需要扫描大约 150 万个文本文档的语料库，并将长度在 1 到 4 之间的任何单词集与大约 180 万个短语的词汇表进行匹配。

从每个文本文件中提取单词 n-gram 不成问题，而且速度非常快；瓶颈在于对词汇的检查。

我的词汇表存储在 MySQL 表中，并已正确编入索引，并且我正在查询每个短语，如下所示：

```
SELECT (1) FROM vocab WHERE phrase=%s; 
```

整个事情运行得非常缓慢。有什么优化思路吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:48:22.213

我的建议是将整个词汇表读入内存一次，然后你就可以很快地对其进行一些查询。你可以把它放在 a`set`或 a`dict`中，或者如果你觉得很花哨，你甚至可以使用布隆过滤器来检查是否包含。我对这一点有偏见，但如果你选择走那条路，我推荐[pybloomfiltermmap 。](https://github.com/axiak/pybloomfiltermmap)

如果您使用布隆过滤器，一个优点是它比必须将 a 存储在内存中要紧凑得多，`set`而且速度非常快。它们确实对假阳性率有限制，并且在实践中可以控制在可接受的水平。

# python - sys.stdin 不会在 ctrl-d 上关闭

> ID：15666923
> 
> 赞同：5
> 
> 时间：2013-03-27T18:44:30.830
> 
> 标签：python, linux, command-line, eof

我在 program.py 中有以下代码：

```
from sys import stdin
for line in stdin:
    print line 
```

我运行，输入行，然后按`Ctrl`+ `D`，但程序没有退出。

这确实有效：

```
$ printf "echo" | python program.py 
```

为什么按`Ctrl`+时程序不退出`d`？我正在使用 Fedora 18 终端。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-27T20:29:44.827

`Ctrl`+`D`有一个奇怪的效果。它不会关闭输入流，而只会导致 C 级别`fread()`返回空结果。对于常规文件，这样的结果意味着文件现在已结束，但可以阅读更多内容，例如检查其他人是否在此期间向文件写入了更多数据。

另外，还有缓冲的问题——三级！

*   Python 对文件的迭代会进行块缓冲。避免它从交互式流中读取。

*   默认情况下，C 级标准输入文件有一个行缓冲区。

*   终端本身（！），在其默认模式（“熟模式”）下，在将数据发送到进程之前读取一行数据，这解释了为什么在一行中间键入`Ctrl`+`D`时没有任何效果。

这个例子避免了第一个问题，如果你想要的只是检测`Ctrl`+`D`键入它自己的行，这就是你所需要的：

```
import sys

while True:
   line = sys.stdin.readline()
   print repr(line) 
```

你得到的每一行都有一个 final `'\n'`，除了当“行”来自一个`Ctrl`+`D`时，在这种情况下你得到的只是`''`（但阅读继续，除非我们当然添加`if line == '': break`）。

# date - FireBreath：如何将日期从我的插件传递到 Java Script

> ID：15666924
> 
> 赞同：3
> 
> 时间：2013-03-27T18:44:33.387
> 
> 标签：date, plugins, parameters, firebreath

我正在尝试创建一个简单的 FireBreath 插件。我需要将 JavaScript 中的日期传递给我的插件，并从我的插件中获取日期并在 JavaScript 中使用它。

我有一个关于从 JS 获取 FB 插件中的日期的想法。我可以使用 FB::JSObjectPtr 参数并使用 GetAttribute 获取它的属性。

**主要问题是如何将日期传递回 JS？**我能在脑海中找到的唯一方法是创建从 FB::JSAPIAuto 派生的类 DateJSAPI 并实现所有方法，以便 JS 可以将我的类的实例用作 JS Date。我不喜欢这种奇怪的方式。

谁能告诉我一些将日期返回给 JS 的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T01:12:05.620

我花了几个小时试图找到一种在 NPAPI 插件（特别是在 FireBreath 中）中创建日期对象的方法，似乎唯一的方法是创建一个返回日期对象的 javascript 函数。鉴于您必须将字符串或时间戳传递给所述函数，这样做似乎很愚蠢。

如果我是你，我只会将它作为时间戳（数字）发送，这样你就可以在它到达 javascript 后将其转换为 Date 对象。

# android - 如何限制多行EditText中的返回？

> ID：15666925
> 
> 赞同：0
> 
> 时间：2013-03-27T18:44:35.997
> 
> 标签：android, enter

我在我的应用程序中放置了多行`EditText`。问题是，如果用户按下回车键，则`EditText`经常与我的应用程序中的图标发生冲突。我想避免这种情况。

我想知道如何做到这一点，以便用户只能按 Enter 5 次而不能再按一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:36:37.017

要限制 EditText 的高度，可以使用 maxLines 属性

```
<EditText
...
android:maxLines="5"
...
/> 
```

# bash - 使用 nc 检查多个 ips 并获取 HEADER 信息的 Bash 脚本

> ID：15666927
> 
> 赞同：0
> 
> 时间：2013-03-27T18:44:42.027
> 
> 标签：bash

我对编程完全陌生，并且在尝试找到如何编写脚本时遇到了一些`netcat`麻烦

```
HEAD / HTTP/1.0 
```

检查端口 80 是否有多个 IP 地址。任何人都可以帮助制作一个可以使用此命令连接到多个 ip 的 bash 脚本。

```
nc -v 192.x.x.x 80
HEAD / HTTP/1.0
(GRAB THE INFORMATION HERE) 
```

断开连接并转到下一个 IP 地址

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:19:45.393

尝试使用[bash4](/questions/tagged/bash4 "显示标记为“bash4”的问题")执行此操作：

```
declare -A array
for i in 192.168.0.{1..10}; do
    array["$i"]="$(
        printf '%s\n\n' 'HEAD / HTTP/1.0' | nc -w1 $i 80
    )"
done 
```

数组键列表：

```
printf '%s\n' "${!array[@]}" 
```

数组值

```
printf '%s\n' "${array[@]}" 
```

遍历数组：

```
for ip in "${!array[@]}"; do
    # "something with ${array[$ip]} or $ip"
done 
```

* * *

如果您没有[bash4](/questions/tagged/bash4 "显示标记为“bash4”的问题")，只需使用传统数组

```
for i in {1..10}; do ... 
```

# java - 序列化字符串 - 可能吗？

> ID：15666934
> 
> 赞同：-2
> 
> 时间：2013-03-27T18:45:02.513
> 
> 标签：java, serialization

现在这是一个我搜索了很多地方的问题，做了很多编码，但仍然很困惑。我是 Java 新手，所以我正在编写这个程序，它将对象数据保存为序列化对象。数据成员是两个字符串。我读到，当一个对象被序列化并存储在一个文件中时，整个对象状态都会被保存。真的。然后数据也是二进制形式，人类或普通文本编辑器无法读取。因此，当我使用 writeObject 存储对象时，它成功保存了数据，但是当我打开文件时，它包含大量乱码数据，字符串分散在其中。如果我再仔细看一点，我可以清楚地辨认出琴弦。那么在数字的情况下，字符串是否被转换成其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:48:08.270

> 那么在数字的情况下，字符串 nit 是否被转换为其他东西？

我相信，这些字符串以长度前缀修改的 UTF-8 序列化。

虽然通常序列化的数据不容易被人类读取，但这不应该被视为对想要阅读它的人的任何形式的保护。序列化格式有据可查，任何知道它是 Java 二进制序列化结果的人都可能能够从中获取重要数据。

如果您需要保持数据安全，则需要另一种方案*以及*序列化。（我还鼓励您研究其他序列化选项。我不是 Java 序列化的忠实粉丝 - 它非常脆弱。面对代码更改，让您的数据向后和向前兼容有点挑战。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:49:20.780

没有限制序列化的结果必须是不可读的。当您序列化一个字符串时，该字符串需要放在数据中，不妨把它连同它的长度一起放在那里。

序列化可能不是最紧凑的形式，因此您不应该对字符串在添加到字节流之前没有以某种方式压缩感到惊讶。

# c++ - 重载模板函数的调用不明确

> ID：15666936
> 
> 赞同：0
> 
> 时间：2013-03-27T18:45:05.420
> 
> 标签：c++

我有以下代码。

```
#include <iostream> 
#include <string> 
#include <vector> 
#include <algorithm>

template <typename Type> inline Type max(Type t1, Type t2) { 
    return t1 > t2 ? t1 : t2; 
}

template <typename Type> inline Type max(const std::vector<Type> &vec) { 
    return *std::max_element(vec.begin(),vec.end());
} 

template <typename Type> inline Type max(const Type *parray, int size) {
return *std::max_element(parray,parray+size);
} 

int main(int argc, char *argv[]) {
    std::string sarray[] = {"we","were","her","pride","of","ten"};
    std::vector<std::string> svec(sarray,sarray+6);

    int iarray[] = {12,70,2,169,1,5,29};
    std::vector<int> ivec(iarray,iarray+7);

    float farray[] = {2.5,24.8,18.7,4.1,23.9};
    std::vector<float> fvec(farray,farray+5);

    int imax = max(max(ivec),max(iarray,7));
    float fmax = max(max(fvec),max(farray,5));
    std::string smax = max(max(svec),max(sarray,6));

    std::cout << "imax should be 169  -- found: " << imax << '\n'
              << "fmax should be 24.8 -- found: " << fmax << '\n'
              << "smax should be were -- found: " << smax << '\n';
    return 0; 
} 
```

我正在尝试实现两个简单的模板函数来输出向量和数组的最大元素。但是，当类型为字符串时，我收到以下错误。

```
error: call of overloaded 'max(std::string, std::string)' is ambiguous 
```

为什么会发生这种情况，最好的补救方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T18:54:44.970

问题是编译器正在寻找多个匹配的`max`via [ADL](http://en.wikipedia.org/wiki/Argument-dependent_name_lookup)定义，并且不知道该选择哪个。

尝试将调用更改`max`为使用其限定 ID：

```
std::string smax = ::max(max(svec),max(sarray,6)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T19:02:17.173

你的代码

```
std::string smax = max(max(svec),max(sarray,6)); 
```

翻译为：

```
std::string smax = max(string ,string ); 
```

之后使用您的模板进行评估`max(svec)`。`max(sarray,6)`现在问题出现了：标准库已经带有一个模板化的 max() 函数。编译器将无法判断您是否需要您的版本`max()`或`std::max()`. 现在你会问为什么它适用于整数和浮点数。答案在您特别提到的这一行中`std::string`。因此编译器变得混乱。可以有变通办法。但是由于您需要最好的解决方案，我会说将您的 max 函数重命名为 MAximum。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:58:41.043

**为什么会出现这种情况？**
编译器错误已经告诉你原因。它不知道`max`使用哪个版本。

> 注意：候选人是：
> main.cpp:6:38：注意：类型 max(Type, Type) [with Type = std::basic_string]
> ...
> /usr/include/c++/4.7/bits/stl_algobase.h:210 :5: 注意： const _Tp& std::max(const _Tp&, const _Tp&) [with _Tp = std::basic_string]

**解决方案：**
要么显式调用你的`max`函数，要么只调用`std::max`（它已经存在，那么你为什么要重新实现它？）。

另外，后面还有一个`;`太多`<< "fmax should be 24.8 -- found: " << fmax << '\n'`

# boost - 如何将 Boost Interprocess 分配器与 CGAL Nef_polyhedron_3 一起使用？

> ID：15666937
> 
> 赞同：0
> 
> 时间：2013-03-27T18:45:11.903
> 
> 标签：boost, interprocess, cgal

CGAL 中有两种类型的 3D 多边形，Polyhedron 和 Nef_polyhedron。前者允许将分配器指定为其第四个模板：

[http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Polyhedron/Chapter_main.html#Subsection_25.3.5](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Polyhedron/Chapter_main.html#Subsection_25.3.5)

但是， Nef_polyhedron_3 似乎没有。

然而，它确实有 iostream 运算符，用于解析到/从内部字符串表示：

[https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_3/SNC_io_parser.h](https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_3/SNC_io_parser.h)

但这确实非常缓慢。

然而，看看那个 SNC 解析器代码，它似乎在内部仍然使用分配器作为其内部结构（一个 snc 对象）。但是，即使我可以将这些分配给我的静态缓冲区（传递给另一个进程），我也看不到 Nef_polyhedron_3 构造函数或访问器函数中允许我重建一个的任何内容。

编辑：进一步研究一下，我注意到有一个来自 SNC 结构的构造函数[https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_polyhedron_3.h](https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_polyhedron_3.h)：

```
Nef_polyhedron_3( const SNC_structure& W, SNC_point_locator* _pl, 
          bool clone_pl,
          bool clone_snc) { 
```

SNC_structure 对其内部数据使用分配器（但不为其自身）：

[https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_3/SNC_structure.h](https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Nef_3/SNC_structure.h)

麻烦的是，这似乎只在编译时设置 - 我只需要为我知道需要发送到另一个进程的多边形分配一个特定的缓冲区。

编辑 2：我刚刚注意到 Nef_polyhedron_3 超类之一是 Handle_for：

```
class Nef_polyhedron_3 : public CGAL::Handle_for< Nef_polyhedron_3_rep<Kernel_, Items_, Mark_> >, 
             public SNC_const_decorator<SNC_structure<Kernel_,Items_,Mark_> > 
```

在那里，它本身也使用了分配器：

[https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Handle_for.h](https://github.ugent.be/divhaere/cgal/blob/master/include/CGAL/Handle_for.h)

我仍然不清楚我到底是如何插入的。

马科斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:02:59.143

Nef_polyhedron_3 目前不支持自定义分配器。但是，可以通过[CGAL_ALLOCATOR](http://www.cgal.org/Manual/latest/doc_html/Developers_manual/Developers_manual/Chapter_memory_management.html)宏使 CGAL 使用不同的分配器。但是，这将影响所有可能过多的 CGAL 标头。但是，应该可以在现有代码中添加分配器支持而不会有太多麻烦。

# sql - 在 SQLite 中显示/更改工作目录

> ID：15666943
> 
> 赞同：11
> 
> 时间：2013-03-27T18:45:29.240
> 
> 标签：sql, sqlite

SQLite 是否有一个命令显示我在命令行上工作的目录？

另外，如何在那里更改工作目录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-03-07T05:42:33.640

`.shell cd`可以帮助你显示当前目录。

要更改目录，您需要在开始时进行设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-01-29T15:26:23.533

`sqlite3`确实有当前目录的概念（尽管它“推迟”到底层 shell）；否则它不会有[`.cd DIRECTORY`](https://www.sqlite.org/cli.html#special_commands_to_sqlite3_dot_commands_)命令。

要模仿`pwd`，您可以使用：

```
sqlite> .shell pwd
/Users/brad/ 
```

语法是`.shell CMD ARGS...`，它允许您

> `CMD ARGS...`在系统外壳中运行

要更改目录，请使用`.cd`：

```
sqlite> .cd /Users/yourname/directory/ 
```

该`.cd`命令[是在版本 3.20.0](http://docs.w3cub.com/sqlite/changes/)（2017-08-01 发布）中添加的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-04-03T00:48:46.020

是的，除此之外，`.cd`您还可以`ls`在终端中输入以显示您正在处理的目录及其内容

# javascript - requirejs r.js 中的多个路径优化

> ID：15666944
> 
> 赞同：0
> 
> 时间：2013-03-27T18:45:29.870
> 
> 标签：javascript, requirejs, require, r.js

有没有办法保留一个paths.js文件来跟踪所有路径

```
//i know you can do this where configobject.paths = require('paths');
requirejs.config(configobject)

//and r.js build config
({
     paths:require('paths'),
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-27T02:02:46.320

我还想集中我的 AMD 模块路径。这是 curl 中的一个实现，但同样的方法适用于 RequireJS：

基本上，但文件中的配置： [https ://github.com/SimpleAsCouldBe/appCore/blob/master/shared/appCore/setCurlPaths.js](https://github.com/SimpleAsCouldBe/appCore/blob/master/shared/appCore/setCurlPaths.js)

并在您想要的任何页面中使用配置： [https ://github.com/SimpleAsCouldBe/appCore/blob/master/exampleApp1/index.html](https://github.com/SimpleAsCouldBe/appCore/blob/master/exampleApp1/index.html)

您可以在构建期间使用 grunt concat 或其他东西对其进行优化。你也可以告诉 grunt 的 requirejs 优化器这个共享配置文件：

```
# https://github.com/jrburke/r.js/blob/master/build/example.build.js
requirejs:
  oneForAll:
    options:
      mainConfigFile: "shared/appCore/requireConfig.js" 
```

# ember.js - 从 itemController 调用控制器

> ID：15666946
> 
> 赞同：1
> 
> 时间：2013-03-27T18:45:38.723
> 
> 标签：ember.js

如果我有一个这样定义的 itemController：

```
{{#each item in items itemController="item"}}
  {{#with item}}
    <tr>
      <td class="check">
        <label {{action  selectItem this bubbles="false"}}>
          {{description}}
        </label>
      </td>
    </tr>
  {{/with}} 
```

上面的动作将被路由到 itemController。

反正有没有覆盖这种行为和主控制器？

# symfony - Symfony2 登录时出现错误“用户提供程序必须返回一个 UserInterface 对象”

> ID：15666948
> 
> 赞同：1
> 
> 时间：2013-03-27T18:45:54.657
> 
> 标签：symfony, symfony-2.2

我正在尝试将 symfony 附带的现有演示登录从 in_memory 修改为用户的数据库存储。我仍然得到：

```
[2013-03-27 19:24:34] security.INFO: Authentication request failed: The user provider must return a UserInterface object. [] [] 
```

所以我改变了：

`security.yml`

```
 providers:
  user_db:
        entity: { class: Cremesk\AgentisBundle\Entity\Pouzivatel, property: meno } 
```

还创建了提到的实体：

```
'use Doctrine\ORM\Mapping as ORM;
 use Symfony\Component\Security\Core\User\UserInterface;

 /**
 * Pouzivatel
 *
 * @ORM\Table('pouzivatel')
 * @ORM\Entity
 */
 class Pouzivatel implements UserInterface
 .etc 
```

并保持原样：

```
 use Symfony\Bundle\FrameworkBundle\Controller\Controller;
 use Symfony\Component\Security\Core\SecurityContext;
 use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
 use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;
 use JMS\SecurityExtraBundle\Annotation\Secure;

 /**
  * @Route("/demo/secured")
  */
 class SecuredController extends Controller
 {
     /**
      * @Route("/login", name="_demo_login")
      * @Template()
      */
     public function loginAction()
     {
         if ($this->get('request')->attributes->has(SecurityContext::AUTHENTICATION_ERROR)) {
        $error = $this->get('request')->attributes->get(SecurityContext::AUTHENTICATION_ERROR);
    } else {
        $error = $this->get('request')->getSession()->get(SecurityContext::AUTHENTICATION_ERROR);
    }

    return array(
        'last_username' => $this->get('request')->getSession()->get(SecurityContext::LAST_USERNAME),
        'error'         => $error,
    );
}

/**
 * @Route("/login_check", name="_security_check")
 */
public function securityCheckAction()
{
    // The security layer will intercept this request
}

/**
 * @Route("/logout", name="_demo_logout")
 */
public function logoutAction()
{
    // The security layer will intercept this request
}

/**
 * @Route("/hello", defaults={"name"="World"}),
 * @Route("/hello/{name}", name="_demo_secured_hello")
 * @Template()
 */
public function helloAction($name)
{
    return array('name' => $name);
}

/**
 * @Route("/hello/admin/{name}", name="_demo_secured_hello_admin")
 * @Secure(roles="ROLE_ADMIN")
 * @Template()
 */
public function helloadminAction($name)
{
    return array('name' => $name);
}
 } 
```

我无法使登录工作。将不胜感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T19:32:10.570

检查用户实体的命名空间和安全配置是否匹配。

```
namespace Cremesk\AgentisBundle\Entity;

use ....

class Pouzivatel implements UserInterface
{
    .... 
```

在你的 security.yml

```
providers:
    user_db:
        entity: { class: Cremesk\AgentisBundle\Entity\Pouzivatel, property: meno } 
```

# java - 如何删除SD卡中的文件？

> ID：15666950
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:04.077
> 
> 标签：java, android, file, android-sdcard, delete-file

我使用这段代码：

```
String path = "mnt/sdcard/ten-file.mp3";
File file = new File(path);
boolean result = file.delete(); 
```

但它不会删除文件。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:51:10.453

```
String fileName = Environment.getExternalStorageDirectory().getAbsolutePath() + File.separator + "ten-file.mp3";  
File soundFile = new File(fileName);
if (soundFile.exists())
{
    boolean result = file.delete(); 
} 
```

清单许可

```
uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:54:37.707

您要在实际删除文件之前确保文件存在：

```
File file = getBaseContext().getFileStreamPath("/sdcard/appname/data.xml");
if(file.exists()) { 
    boolean result = file.delete()
} 
```

我认为您的原始代码存在的问题是您实际上并未进行测试以确保文件存在。您刚刚创建了一个文件变量，然后告诉它删除它。我提到了与您有类似问题的个人的以下问题：

[Android如何检查文件是否存在并创建一个？](https://stackoverflow.com/questions/6476635/android-how-to-check-if-file-exist-and-else-create-one)

# javascript - Firefox - 获取 Windows 用户名并将其传递到网页的扩展程序。

> ID：15666956
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:16.987
> 
> 标签：javascript, firefox-addon

我正在寻找开发一个 Firefox 扩展/附加组件，它能够获取 Windows 用户名并将其保存为变量，以便网页可以访问它。这是一个严格的内部网站，用于验证目的，为不同的用户提供某些权限。我打算使用以下代码段

Components.classes["@mozilla.org/process/environment;1"].getService(Components.interfaces.nsIEnvironment).get('USERNAME')

这种方法在错误控制台中为我提供了正确的用户名，同时在 [https://builder.addons.mozilla.org/](https://builder.addons.mozilla.org/)使用附加组件构建器。

我不确定如何实际构建一个附加组件，该附加组件将完全符合错误控制台输出的功能。当我尝试将该代码添加为变量并安装插件时，它给了我错误 XPI not build。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:59:56.243

Firefox 已经内置了集成身份验证（很多人不知道）。
请参阅：[https ://developer.mozilla.org/en-US/docs/Integrated_Authentication](https://developer.mozilla.org/en-US/docs/Integrated_Authentication)

这是一个流行的 Firefox 插件，可以简化配置： [https ://addons.mozilla.org/nl/firefox/addon/integrated-auth-for-firefox/](https://addons.mozilla.org/nl/firefox/addon/integrated-auth-for-firefox/)

这里有一些额外的解释：http:
[//justgeeks.blogspot.nl/2011/01/firefox-supports-integrated-windows.html](http://justgeeks.blogspot.nl/2011/01/firefox-supports-integrated-windows.html)

祝你好运！

# c# - 重新启动 WPF 应用程序更改主窗口线程所有者

> ID：15666959
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:21.300
> 
> 标签：c#, wpf

我有一个非常强大的线程应用程序，效果很好......但是当单击重新启动按钮时......它遵循代码，处理视图模型并关闭主窗口......从而返回对话框结果并返回到 app.xaml 。CS。

这就是我实施重启的方式......

```
base.OnStartup(e);

        // Register required assemblies.
        RegisterAssemblies();

        foreach (FolderType type in FolderType.GetValues())
        {
            if (!Directory.Exists(type.Value))
            {
                Directory.CreateDirectory(type.Value);
            }
        }

        bool? restart = true;
        ShutdownMode = System.Windows.ShutdownMode.OnExplicitShutdown;
        dynamic window;
        MainWindowViewModel viewModel;

        while (restart == true)
        {
            running = true;
            string[] files = Directory.GetFiles(FolderType.LASTCONFIGURATION.Value);
            lastConfiguration = string.Empty;

            if (files.Length != 0)
            {
                lastConfiguration = files[0];
            }

#if (!DEBUG)
            if (SystemParameters.PrimaryScreenHeight == 1080)
            {
                window = new MainWindowHD();
            }
            else
            {
                window = new MainWindow();
            }

            Mouse.OverrideCursor = Cursors.None;
#else
            window = new MainWindow();
#endif

            window.ShowInTaskbar = false;
            viewModel = new MainWindowViewModel(lastConfiguration, "saved_settings.xml", FolderType.CASES + "\\" + "case_configuration.xml");

            Application.Current.Dispatcher.BeginInvoke(new Action(() =>
                {
                    window.DataContext = viewModel;
                }
            ));

            restart = window.ShowDialog();
        }

        if (systemShutdown)
        {
            Process.Start("shutdown", "/s /t 0");
        }

        Shutdown(0); 
```

这又会再次循环并重置窗口对象和视图模型对象，但现在我所有其他类中的 Application.Current.MainWindow 抱怨拥有它的不同线程。我想我可以通过放置 ((App)Application).Dispatcher.Invoke 来解决这个问题，但是我不希望这样做，因为在重新启动之前不需要。

什么可以解释 Application.Current.MainWindow 不是它创建的同一个线程？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:03:13.527

该`MainWindow`属性仅`Window`在应用程序中创建第一个时设置。重新创建窗口时，您需要`MainWindow`手动更新属性。

此外，`Application.Current`如果您的代码`OnStartup`在`Application`.

```
this.MainWindow = window = new MainWindow();
window.ShowInTaskbar = false;
viewModel = new MainWindowViewModel(...);
Dispatcher.BeginInvoke(new Action(() => window.DataContext = viewModel));
restart = window.ShowDialog(); 
```

* * *

另一条评论：不要忘记高清屏幕的分辨率可能大于 1080p。您应该更新您的支票以说明这一点：

```
if (SystemParameters.PrimaryScreenHeight >= 1080) 
```

# c# - 如何使用 MonoTouch.dialog 创建自定义样式的 EntryElement？

> ID：15666960
> 
> 赞同：1
> 
> 时间：2013-03-27T18:46:24.567
> 
> 标签：c#, xamarin.ios, styles, subclass, monotouch.dialog

我正在尝试使用 monotouch.dialog 创建自定义条目元素。我了解如何对 StringElement 进行子类化以设置我自己的字符串元素的样式 - 请参见下面的示例：

```
public class CustomStyledStringElementPlain : MonoTouch.Dialog.StyledStringElement
{
    public CustomStyledStringElementPlain (string _caption, UIColor _backgroundcolour, UITextAlignment _alignment) : base(string.Empty,string.Empty)
    {
        TextColor = UIColor.White;
        Font = UIFont.FromName ("Helvetica-Bold", 14f);
        Caption = _caption;
        Alignment = _alignment;
        BackgroundColor = _backgroundcolour;
    }
} 
```

但是，当对 EntryElement 进行子类化时，例如，我无法访问 BackgroundColor 的属性（这是我要更改的主要内容！）这是我到目前为止所拥有的...关于如何更改的任何指针或建议背景颜色或其他样式条目元素将不胜感激！

```
public class CustomStyledEntryElementPlain : MonoTouch.Dialog.EntryElement
{
    public CustomStyledEntryElementPlain (string _caption, UIColor _colour, UITextAlignment _alignment) : base(string.Empty,string.Empty)
    {
        ReturnKeyType = UIReturnKeyType.Done;
        Caption = _caption;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T08:10:52.677

要自定义 MonoTouch.Dialog 元素，您可以覆盖 GetCell 方法并在单元格对象上设置所需的外观。像这样的东西：

```
public override UITableViewCell GetCell(UITableView tableView) {
    var cell = base.GetCell(tableView);
    cell.BackgroundColor = _colour;
    return cell;
} 
```

# java - 每秒 HttpRequest 中的 FileNotFoundException

> ID：15666964
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:27.033
> 
> 标签：java, android, network-programming

在我的 android 应用程序中，我想让用户从网站获取数据（通过发送 http 请求）。然后将 http 响应发送到另一个显示数据的活动。（我在这个示例代码中简化了一点。实际上，数据被解析为一个对象并发送该对象）。

这一切都适用于我的代码。但是当用户通过按返回键返回主活动并尝试另一个请求时，应用程序会抛出一段`java.io.FileNotFoundException`时间从 URLConnection 获取输入流。如果应用程序关闭（再次按下）然后重新打开，一切都会再次正常运行。

我很确定这是连接未正确关闭或类似问题的问题，但我在代码中找不到错误。知道这里有什么问题吗？

MainActivity.java

```
*no interessting code here.
it just calls the static function from MainMethods.java
when a button is pressed* 
```

MainFunctions.java - 我想从几个类中调用方法，所以它在一个额外的类中

```
class MainFunctions {

    public static void search(final Activity, final String searchString) {

        new AsyncTast<String, String, String>() {

            protected void onPreExecute() {
                // im opening a progress dialog for the activity here
            }

            protected String doInBackground(String... searchString) {
                try{
                    return new HttpUtils().sendRequest(searchString)
                } catch (Exception e) {
                    // print a dialog, stacktrace and stuff
                    return null;
                }
            }

            protected void onPostExecute(String result) {
                if(result != null) {
                    // dismiss the dialog etc..
                    Intent i = new Intent("packagename");
                    i.putExtra("key", result);
                    activity.startActivity(i);
                }
           }           
        }.start(searchString)
    }
} 
```

HttpUtils.java

```
public class HTTPUtils {

    public String sendRequest(String data)
        throws IOException {

     String answer = "";

     URL url = new URL("http://myURL.com/" +  data);
     URLConnection conn = url.openConnection();
     conn.setReadTimeout(5000);
     BufferedReader in = new BufferedReader(new InputStreamReader(
                 conn.getInputStream()));

             String inputLine;

     while ((inputLine = in.readLine()) != null)
         answer += inputLine;

     in.close();

     return answer; 
}
} 
```

Stacktrace 显示在`conn.getInputStream()`调用时抛出了异常。

```
java.io.FileNotFoundException: http://myURL.com/danijoo
at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java)
at com.elophant.utils.HTTPUtils.sendRequest(HTTPUtils.java:20)
at com.elophant.Elophant.getSummoner(Elophant.java:183)
at com.lolsummoners.datacollector.Collecter.getSummonerInfo(Collecter.java:39)
at com.lolsummoners.utils.MainFunctions$1.doInBackground(MainFunctions.java:106)
at com.lolsummoners.utils.MainFunctions$1.doInBackground(MainFunctions.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java)
at java.util.concurrent.FutureTask.run(FutureTask.java)
at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java)
at java.lang.Thread.run(Thread.java) 
```

Methods`getSummoner()`和`getSummonerInfo()`是从响应字符串中解析对象的方法。我把它说出来是为了让问题更容易被理解。

谢谢！

# php - 比较值以提供不同的输出

> ID：15666965
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:27.780
> 
> 标签：php, mysql

我有一个已转换为 MySQL 的 Access 数据库。我有一个表格，联系人，其中包含“EmailAddress”、“HideEmailAddress”、“FaxNumber”、“HideFaxNumber”、“PhoneNumber”和“HidePhoneNumber”字段。隐藏字段都是复选框，因此值为 1 或 0，其中 1 为 TRUE。

如果隐藏字段的值为 1，我需要在我的 MySQL Select 语句或 PHP 查询中不显示信息。此外，通常只有三个字段中的一个会被标记为隐藏，所以我不能做毯子“如果其中任何一个是 1 隐藏所有这些。” 我需要将查询输出到网页，并根据每列隐藏字段的值显示或隐藏上面的三个字段。我的 SELECT 语句正在检索所有六个值，而 PHP 正在将其转换为数组，但我认为数组比较在这里没有任何帮助。

我只是不知道我应该在这里做什么。我一直在寻找几天，似乎没有什么能接近我需要的。我有一个非常特别的 if-elseif-else 在我的 PHP 循环中运行，以便在截止日期前完成它，但这需要 9 或 12 条不同的语句，我确信有更好的方法来做到这一点。

这是我的代码。我已经从原始查询中删减了很多，但是该查询确实有效，所以如果这里有拼写错误，那就是删减了。我只是不知道如何根据另一个字段的值来抑制一个字段。这也是为什么我在 SELECT 语句中有两个 AS 语句的原因 - 在原始查询中，有来自五个不同表的信息，并且它们都有“FaxNumber”和“EmailAddress”。我离开了 AS，以防万一它改变了事情。

```
<?php

$dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) or die('Error connecting to MySQL server.');

$query = 'SELECT Contact.CompanyID, Contact.WebContact, Contact.FirstName, Contact.LastName, Contact.WorkPhone, Contact.HidePhoneNumber, Contact.FaxNumber AS ConFaxNumber, Contact.HideFaxNumber, Contact.EmailAddress AS ConEmailAddress, Contact.HideEmailAddress FROM Contact WHERE TDAT_Contact.WebContact = "1"';

mysqli_query($dbc, $query);    

if($r = mysqli_query($dbc, $query)) { 
   while ($row = mysqli_fetch_array($r)) {
        if(($row['HidePhoneNumber'] == 1) && ($row['HideFaxNumber'] == 1)) {
    echo '<hr><div align="query"><span class="strong">Contact:</span> ' . $row['FirstName'] . ' ' . $row['LastName'] . '<br /><br /><span class="strong">Direct Email Address: </span>' . $row['ConEmailAddress'] . '</div>';    
        } elseif($row['HidePhoneNumber'] == 0) && ($row['HideFaxNumber'] == 0) {
    echo '<hr><div align="query"><span class="strong">Contact:</span> ' . $row['FirstName'] . ' ' . $row['LastName'] . '<br /><span class="strong">Direct Telephone: </span>' . $row['WorkPhone'] . '<br /><span class="strong">Direct Fax: </span>' . $row['ConFaxNumber'] . '<br /><span class="strong">Direct Email Address: </span>' . $row['ConEmailAddress'] . '</div>';}
}
     ...                          
     else { // Query didn't run.
          echo '<p style="color: red;">Could not retrieve the data because:<br />' . mysqli_error($dbc) . '.</p><p>The query being run was: ' . $query . '</p>';
               }
            }}

   mysqli_close($dbc); // Close the connection.

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T18:54:47.070

您可以在 mysql 中完成并避免额外的 php 编码

像这样假设隐藏字段是布尔值

```
$query = 'SELECT Contact.CompanyID, Contact.WebContact, Contact.FirstName,Contact.LastName, 
case when Contact.HidePhoneNumber then '' else Contact.WorkPhone end as WorkPhone,
case when Contact.HideFaxNumber then '' else Contact.FaxNumber end  AS ConFaxNumber,
case when Contact.HideEmailAddress then '' else Contact.EmailAddress and AS ConEmailAddress FROM Contact WHERE TDAT_Contact.WebContact = "1"'; 
```

然后在php上你只是

```
if($r = mysqli_query($dbc, $query)) { 
    while ($row = mysqli_fetch_array($r)) {
        echo '<hr><div align="query"><span class="strong">Contact:</span> ' . $row['FirstName'] . ' ' . $row['LastName'] . '<br /><span class="strong">Direct Telephone: </span>' . $row['WorkPhone'] . '<br /><span class="strong">Direct Fax: </span>' . $row['ConFaxNumber'] . '<br /><span class="strong">Direct Email Address: </span>' . $row['ConEmailAddress'] . '</div>';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:00:54.970

```
<?php

$dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) or die('Error connecting to MySQL server.');

$query = 'SELECT Contact.CompanyID, Contact.WebContact, Contact.FirstName, Contact.LastName, Contact.WorkPhone, Contact.HidePhoneNumber, Contact.FaxNumber AS ConFaxNumber, Contact.HideFaxNumber, Contact.EmailAddress AS ConEmailAddress, Contact.HideEmailAddress FROM Contact WHERE TDAT_Contact.WebContact = "1"';

mysqli_query($dbc, $query);    

if($r = mysqli_query($dbc, $query)) { 
    while ($row = mysqli_fetch_array($r)) {
        echo '<hr><div align="query"><span class="strong">Contact:</span> ' . $row['FirstName'] . ' ' . $row['LastName'] . '<br />';
        if ($row['HidePhoneNumber'] == 0) {
            echo '<span class="strong">Direct Telephone: </span>' . $row['WorkPhone'] . '<br />';
        }
        if ($row['HideEmailAddress'] == 0) {
            echo '<span class="strong">Direct Email Address: </span>' . $row['ConEmailAddress'] . '<br />';
        }
        if ($row['HideFaxNumber'] == 0) {
            echo '<span class="strong">Direct Fax: </span>' . $row['ConFaxNumber'];
        }
        echo '</div>';
    }
} else { // Query didn't run.
    echo '<p style="color: red;">Could not retrieve the data because:<br />' . mysqli_error($dbc) . '.</p><p>The query being run was: ' . $query . '</p>';
}

mysqli_close($dbc); // Close the connection. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:07:58.130

将您的 html 输出分成小块，观察常见模式，并将其分解为函数：

```
function hide($field, $label, $row){
    if ($row['Hide'.$field] == 0)
        echo '<span class="strong">'.$label.'</span>'.$row[$field].'<br/>';
}

$hiddenfields = array ('EmailAddress' => 'Email Address', 'PhoneNumber' => 'Direct Telephone' /* etc. */);

foreach($hiddenfields as $field => $label)
     hide($field,$label,$row); 
```

这应该让你开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T19:20:51.150

您正在使用 AND 运算符(($row['HidePhoneNumber'] == 1) && ($row['HideFaxNumber'] == 1) 这意味着两个条件都必须为真才能执行条件代码。要解决您的问题，您可以在您的 while 循环中使用“嵌套循环”并检查表达式，例如：

```
 $conditions=array("0"=>"phonenumber","1"=>"fax","2"=>"email") //associative array
   for($i=0;$i<count($conditions);$i++){
   if($row[$conditions[$i]]==1){
   echo $row.[$conditions[$i]];
    }
   else{
   echo "user doesn't want to share this information";
   }
  } 
```

如果条件返回 1，它将回显关联的数组成员。

# drop-down-menu - 下拉菜单仅在一个域上失败

> ID：15666966
> 
> 赞同：1
> 
> 时间：2013-03-27T18:46:32.760
> 
> 标签：drop-down-menu

我有一个下拉菜单，可以处理多个网站上的 script.js 文件。它适用于多个域，但最近它停止在一个域上工作，现在我无法让任何 script.js 菜单下拉菜单在该域上工作。

什么可能阻止脚本工作？

# mongodb - 烧瓶 mongoengine 通过 uri 连接

> ID：15666968
> 
> 赞同：5
> 
> 时间：2013-03-27T18:46:37.077
> 
> 标签：mongodb, heroku, flask, mongoengine

我有一个要部署到 Heroku 的小型烧瓶应用程序。

我的本地配置如下所示：

```
from flask import Flask
from flask.ext.mongoengine import MongoEngine

app = Flask(__name__)
app.debug = True
app.config["MONGODB_SETTINGS"] = {'DB': "my_app"}
app.config["SECRET_KEY"] = "secretpassword"

db = MongoEngine(app) 
```

所以，我知道我需要将应用程序配置为使用 Mongo`URI`连接方法，并且我有我的连接信息：

```
mongodb://<user>:<password>@alex.mongohq.com:10043/app12345678 
```

对于修改我的应用程序以通过`URI`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T18:34:07.857

所以我让它工作（最后）：

```
from flask import Flask
from mongoengine import connect

app = Flask(__name__)

app.config["MONGODB_DB"] = 'app12345678'
connect(
    'app12345678',
    username='heroku',
    password='a614e68b445d0d9d1c375740781073b4',
    host='mongodb://<user>:<password>@alex.mongohq.com:10043/app12345678',
    port=10043
) 
```

尽管我预计其他各种配置都可以使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-27T22:00:29.260

查看[flask-mongoengine 代码](https://github.com/sbook/flask-mongoengine/blob/master/flaskext/mongoengine/__init__.py#L34-L40)时，可以看到有哪些配置变量可用

所以这应该工作：

```
app.config["MONGODB_HOST"] = 'alex.mongohq.com/app12345678'
app.config["MONGODB_PORT"] = 10043
app.config["MONGODB_DATABASE"] = 'dbname'
app.config["MONGODB_USERNAME"] = 'user'
app.config["MONGODB_PASSWORD"] = 'password'
db = MongoEngine(app) 
```

我不确定`app123`是应用程序名称还是数据库名称。您可能需要稍微摆弄一下才能获得连接。我在 Heroku 上使用 Mongokit + MongoLab 时遇到了同样的问题 :)

你也可以像这样使用URI。

```
app.config["MONGODB_SETTINGS"] = {'DB': "my_app", "host":'mongodb://<user>:<password>@alex.mongohq.com:10043/app12345678'} 
```

我实际上不知道在什么时候读取“MONGODB_SETTINGS”，但是当我在 shell 中尝试它时它似乎有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T00:05:13.450

我想出了如何使用`flask.ext.mongoengine.MongoEngine`包装类来做到这一点，而不是`mongoengine.connect()`：

```
from flask import Flask
from flask.ext.mongoengine import MongoEngine

app = Flask(__name__)

HOST = '<hostname>'  # ex: 'oceanic.mongohq.com'
db_settings = {
    'MONGODB_DB': '<database>',
    'MONGODB_USERNAME': '<username>',
    'MONGODB_PASSWORD': '<password>',
    'MONGODB_PORT': <port>,
}
app.config = dict(list(app.config.items()) + list(db_settings.items()))
app.config["MONGODB_HOST"] = ('mongodb://%(MONGODB_USERNAME)s:%(MONGODB_PASSWORD)s@'+
                               HOST +':%(MONGODB_PORT)s/%(MONGODB_DB)s') % db_settings

db = MongoEngine(app)

if __name__ == '__main__':
    app.run() 
```

如果您使用的是 mongohq，`app.config["MONGODB_HOST"]`则应匹配 Databases->Admin->Overview 下的 Mongo URI。

然后，您可以按照**MongoDB**的[tumblelog 教程](http://docs.mongodb.org/ecosystem/tutorial/write-a-tumblelog-application-with-flask-mongoengine/)使用此设置编写您的第一个名为**tumblelog**的应用程序。

使用 python 漂亮的对象自省（python 哦，我多么*爱*你），你可以看到 MongoEngine 包装类是如何完成这个的：

```
from flask.ext.mongoengine import MongoEngine
import inspect
print(inspect.getsource(MongoEngine))
    ...
    conn_settings = {
        'db': app.config.get('MONGODB_DB', None),
        'username': app.config.get('MONGODB_USERNAME', None),
        'password': app.config.get('MONGODB_PASSWORD', None),
        'host': app.config.get('MONGODB_HOST', None),
        'port': int(app.config.get('MONGODB_PORT', 0)) or None
    }
     ...
     self.connection = mongoengine.connect(**conn_settings)
     ...
     self.app = app 
```

# mysql - PDO 准备好的语句查询未遵循 WHERE

> ID：15666969
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:37.157
> 
> 标签：mysql, pdo

```
/**
 * Query the database, and grab a random banner.
 *
 * @return object Database row.
 */
protected function getRandomBanner()
{
    try 
    {
        $stmt = $this->db->prepare("SELECT * FROM banners WHERE Type=:type BETWEEN Start AND End ORDER BY RAND() LIMIT 1");
        $stmt->execute(array(':type' => $this->type));
        return $stmt->fetch(PDO::FETCH_OBJ);
    } catch (PDOException $e) {
        echo $e->getMessage();
    }
} 
```

此代码是类的一部分。它根据简单的查询字符串**display_banner.php?banner_type=leaderboard**查询数据库以显示横幅广告。它完美地工作。

但是，我想包含“BETWEEN”，以便它可以检查横幅开始日期和结束日期。

同样，此查询运行 - 并显示横幅！但是......当我添加“BETWEEN”时，它不再跟随“Type”。现在，它显示矩形和排行榜。疯狂的是，当我运行此查询时，它在 phpMyAdmin 中运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:53:02.533

您需要比较当前日期，然后您必须`NOW()`进行检查。

```
SELECT * 
FROM banners 
WHERE Type=:type 
    AND NOW() BETWEEN Start AND End 
ORDER BY RAND() 
LIMIT 1 
```

# android - 每当用户输入一个单词时，如何显示祝酒词？

> ID：15666974
> 
> 赞同：0
> 
> 时间：2013-03-27T18:46:51.833
> 
> 标签：android

我有一个带有 EditText 和 Button 的简单布局。每当用户在 EditText 中输入特定单词时，我都希望出现祝酒词。我该怎么做？

```
Button btn;
EditText edt;
String Event;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    btn=(Button)findViewById(R.id.Button1);
    edt=(EditText)findViewById(R.id.editText1);
    btn.setOnClickListener(this);
    Event=new String(edt.getText().toString());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public void onClick(View arg0) {
    // TODO Auto-generated method stub
    if(Event.equals("Test")){
        Toast.makeText(this, "Great!",Toast.LENGTH_LONG).show();
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:00:34.047

添加一个`TextWatcher`到您的`EditText`.

本教程向您展示了您需要做什么：http: [//karanbalkar.com/2012/10/tutorial-11-using-textwatcher-in-android/](http://karanbalkar.com/2012/10/tutorial-11-using-textwatcher-in-android/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:00:43.820

从以下位置删除`new String`：

```
Event=new String(edt.getText().toString()); 
```

像这样：

```
Event= edt.getText().toString(); 
```

并将所有这些放在按钮的 onClick 中：

```
btn.setOnClickListener(new View.OnClickListener() 
{
    public void onClick(View v) 
    {
        Event = edt.getText().toString();
        if(Event.equals("Test"))
        {
           Toast.makeText(this, "Great!",Toast.LENGTH_LONG).show();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:02:41.347

```
 EditText e = (EditText)findViewById(..); 
   e.addTextChangedListener(new TextWatcher(){

   @override
   void afterTextChanged(Editable s)
   {
        if(the word is in s.toString())
        {
         Toast...show();
        }
   }

   }); 
```

# vb6 - VB6 中的日志消息

> ID：15666975
> 
> 赞同：-1
> 
> 时间：2013-03-27T18:46:53.433
> 
> 标签：vb6

这似乎是一个非常愚蠢的问题..但事实是我对 VB 完全陌生，而且对它的了解最少。我必须对代码进行一些更改。我需要知道 LogMessage 是一个内置或预定义的函数（或方法或类），如 C 中的 print f。如果是这样..那么为什么它本质上是在代码中定义的......像这样：

```
 Sub LogMessage(From As String, Msg As String)
                txtLog.Text = txtLog.Text & From & ": " & Msg & CRLF
                txtLog.SelectionStart = txtLog.Text.Length
                End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:52:46.777

它不是预定义的函数/方法。

当您看到它前面只定义了一个“子”或“功能”字样时，这意味着它是用户编写的代码。

好的机会

# java - 在这种情况下，可以使 ForkJoinPool 比 ExecutorService 更快吗？

> ID：15666978
> 
> 赞同：2
> 
> 时间：2013-03-27T18:47:11.983
> 
> 标签：java, multithreading, java-7, fork-join

只要我在池中给 ForkJoinPool**一个额外的线程**，它的执行速度就与 ExecutorService 一样快。以下是使用的三个类：Main、RunnableTask 和 ForkJoinTask。在 16 核盒子上运行，程序每次输出如下： **Executor Time: 5002 ForkJoin Time: 5002**

主类：

```
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.ForkJoinPool;

public class Main {

    public static void main(String[] args) throws InterruptedException {
        runExecutor(80);
        runForkJoin(80);
    }

    public static void runForkJoin(int size) {
        ForkJoinPool fjp = new ForkJoinPool(17);
        long start = System.currentTimeMillis();
        fjp.invoke(new ForkJoinTask(size));
        System.out.println("ForkJoin Time: "
                + (System.currentTimeMillis() - start));
        fjp.shutdown();
    }

    public static void runExecutor(int size) throws InterruptedException {
        ExecutorService exec = Executors.newFixedThreadPool(16);
        CountDownLatch latch = new CountDownLatch(size);
        long start = System.currentTimeMillis();
        for (int i = 0; i < latch.getCount(); i++) {
            exec.submit(new RunnableTask(latch));
        }
        latch.await();
        System.out.println("Executor Time: "
                + (System.currentTimeMillis() - start));
        exec.shutdown();
    }
} 
```

可运行类：

```
import java.util.concurrent.CountDownLatch;

public class RunnableTask implements Runnable {
    private CountDownLatch latch;

    public RunnableTask(CountDownLatch latch) {
        this.latch = latch;
    }

    @Override
    public void run() {
        try {
            Thread.sleep(1000);
            latch.countDown();
        } catch (Exception e) {
        }
    }
} 
```

递归任务类：

```
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.RecursiveTask;

public class ForkJoinTask extends RecursiveTask {
    private List<RecursiveTask> tasks;
    private int size;

    public ForkJoinTask(int size) {
        super();
        this.tasks = new ArrayList<>();
        this.size = size;
    }

    @Override
    protected Object compute() {
        for (int i = 0; i < size; i++) {
            RecursiveTask task = new RecursiveTask() {
                @Override
                protected Object compute() {
                    try {
                        Thread.sleep(1000);
                    } catch (Exception e) {

                    }
                    return null;
                }
            };
            task.fork();
            tasks.add(task);
        }

        for (RecursiveTask task : tasks) {
            task.join();
        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:32:07.937

您的个人任务使得**两者都** `ForkJoinPool`可以`ExecutorService`比现在运行得更快，而且任何一个都不应该比另一个拥有实质性优势。

原因是如果单个计算任务是，`Thread.sleep(1000)`那么该任务不需要 CPU 资源。您可以增加线程数以匹配您的作业大小 (80)，并在 1 秒多一点的时间内完成 80 秒的“工作”，因为线程不会真正竞争任何类型的资源。

至于 和 之间的比较，差异`ForkJoinPool`与`ExecutorService`您的测试用例无关，因为您的工作不会导致任何应该作为进一步计算输入的内容（[MapReduce](http://en.wikipedia.org/wiki/MapReduce)中的“减少”步骤）。所以对你来说，它们都是具有不同 API 的线程池。

# ssis - SSIS中转换表的SQL查询

> ID：15666979
> 
> 赞同：0
> 
> 时间：2013-03-27T18:47:15.443
> 
> 标签：ssis, staging

我已经加入了 5 个表并对这些表进行了转换。现在我最后得到了一张桌子。现在我想对这个单表执行 sql 查询来过滤记录。但我不知道如何在这张表上执行简单的 sql 查询。我附上了一张快照，显示了结果表。我如何将这个结果数据集作为源？我想在过滤掉这些数据后填充我的目的地。我正在使用 SSIS 2008。

[单击此处查看我要在其上执行简单 sql 查询的表](http://imageshack.us/photo/my-images/199/70752939.png/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:53:54.630

```
SELECT * FROM `first_table`
where `some_column` = 
(
SELECT `*`
FROM second_table
WHERE
`some_column2`='something'
LIMIT 1
) 
```

试试这个代码这会有所帮助。您甚至可以使用它来连接所有这四个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:24:59.983

从您发布的图像来看，您尝试查询的数据流中似乎有一组数据。此时您需要做两件事之一。要么将数据插入数据库中的表并使用另一个数据流来查询它，要么使用条件拆分（或多播和条件拆分）从那里进一步过滤行。

如果没有更多关于您实际尝试完成的任务的详细信息，这些是我可以确定的建议。

您*可以*将行发送到记录集目的地，但您无法像常规表一样查询它，并且您需要一些 C#/VB 技能来访问它，以完成 FOR EACH 循环之外的更多操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T03:11:25.110

假设您要对结果表运行的 sql 查询很简单，您可以使用脚本组件任务。简单来说，我的意思是，如果它具有这种性质：SELECT * FROM T WHERE a = 'zz' and b = 'XX' 等等。

但是，如果您的查询具有自连接，那么您最好将连接这 5 个表的结果转储到一个物理表中，然后从那里开始。

看起来查询将是真正的直截了当；在这种情况下，使用脚本组件会很有帮助。

一个单独的问题：建议在数据库级别进行排序。您在解决方案中使用了 5 个排序任务。你能解释一下原因吗？

# c# - 将控制器与模型连接以在视图页面中显示结果

> ID：15666981
> 
> 赞同：1
> 
> 时间：2013-03-27T18:47:16.690
> 
> 标签：c#, asp.net-mvc-4, viewmodel

所以我有这个 aps.net mvc 项目，我在其中创建了一个服务层、模型视图、控制器和一个视图页面。但我无法将我的结果显示到视图页面。我开始这将通过在服务层中传递一个特定的 linq 语句，所以我应该能够返回它以显示在视图上。这是我所拥有的：

**服务：**

```
public IEnumerable<RoleUser> GetUsers(int sectionID)
    {
        var _role = DataConnection.GetRole<RoleUser>(9, r => new RoleUser
        {
            Name = RoleColumnMap.Name(r),
            Email = RoleColumnMap.Email(r)
        }, resultsPerPage: 20, pageNumber: 1);
        return _role;
    } 
```

**楷模：**

```
public partial class Role
{
    public RoleView()
    {
        this.Users = new HashSet<RoleUser>();
    }
    public ICollection<RoleUser> Users { get; set; }
}

public class RoleUser
{
    public string Name { get; set; }
    public string Email { get; set; }
} 
```

**控制器：**

```
public ActionResult RoleUser(RoleView rvw)
    {
        var rosterUser = new RosterService().GetUsers();
        ViewBag.RosterUsers = rosterUser;
        return View();
    } 
```

**看法：**

```
<div>
<span>@Model.Name</span>
</div> 
```

我不确定我错过了什么或做错了什么，但任何提示都会很棒。我基本上想从我正在测试的 linq 语句中返回结果，以查看连接是否正确并且在增强之前功能是否存在。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:00:31.820

好吧，如果我要关闭您提供的代码，我会说我不确定它是如何编译的：

```
public partial class Role
{
    public RoleView()
    {
        this.Users = new HashSet<RoleUser>();
    }
    public ICollection<RoleUser> Users { get; set; }
} 
```

感觉应该是：

```
public partial class RoleView 
```

然后我会说，在你的观点的顶部，你错过了这个：

```
@model NamespaceToClass.RoleView 
```

然后我会说你不能发出这个：

```
@Model.Name 
```

因为`RoleUser`不是你的模特。您将需要遍历用户：

```
@foreach (RoleUser ru in Model.Users) 
```

然后在该循​​环中，您可以使用以下内容构建一些 HTML：

```
ru.Name 
```

但我也会质疑你的控制器。现在它正在接收一个模型以返回该模型。这里缺少一些代码，但一般来说，在方法内部：

```
public ActionResult RoleUser(RoleView rvw) 
```

您实际上会去获取数据，构建模型，然后返回：

```
var users = serviceLayer.GetUsers(...);

// now construct the RoleView model
var model = ...

return View(model); 
```

* * *

根据我们的对话，您目前的控制器中有这样的内容：

```
public ActionResult View(int id) 
{ 
    // get the menu from the cache, by Id 
    ViewBag.SideBarMenu = SideMenuManager.GetRootMenu(id); 
    return View(); 
} 

public ActionResult RoleUser(RoleView rvw) 
{ 
    var rosterUser = new RosterService().GetUsers(); 
    ViewBag.RosterUsers = rosterUser; 
    return View(); 
} 
```

但这确实需要看起来像这样：

```
public ActionResult View(int id) 
{ 
    // get the menu from the cache, by Id 
    ViewBag.SideBarMenu = SideMenuManager.GetRootMenu(id); 

    var rosterUser = new RosterService().GetUsers(); 
    ViewBag.RosterUsers = rosterUser; 

    return View(); 
} 
```

因为您是从侧边栏启动此页面的，因为您在 URL 中传递了 id。***您甚至不需要其他操作。***

# ios - 如何在将 JSON 数据流式传输到 NSURLConnection 时处理分块

> ID：15666986
> 
> 赞同：1
> 
> 时间：2013-03-27T18:47:41.160
> 
> 标签：ios, nsurlconnection

我有一个将 JSON 结果异步传输回 iOS 客户端的 Web 服务器。客户端正在使用 NSURLConnection 进行连接，我从该方法访问数据：

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData) 
```

数据当前以 1024 字节块的形式返回。但是，除了将收到的所有数据附加到字符串并尝试每次将其解析为 JSON 之外，我不确定如何判断消息是否完整何时收到数据。这种方法似乎很容易出错 - 有没有更好的方法来处理这个问题？发送完整响应时会在标头中标记的内容或其他内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:02:10.580

你有两种方法

第一个更好的方法是实现`connectionDidFinishLoading:` `NSURLConnectionDataDelegate` 委托，它将在连接成功完成加载时触发。

第二种方法是手动处理它，如下所示。

您可以在 Web 服务器端执行以下操作，

**Step1：** 在开始发送原始数据之前先发送以下信息。

```
 a.Number of Chunks.[totalSize/1024] (mandatory).
      b.TotalSize(not mandatory). 
```

您可以在客户端执行以下操作，

**Step1：**存储以上信息。

**Step2：** 编写以下代码

```
@property (nonatomic,assign) int chunkNumber;

@property (nonatomic,strong) NSData *receivedData;

Self.chunkNumber = 1;

    -(void)connection:(NSURLConnection *)connection didReceiveData:(NSData)myata{

       if(self.chunkNumber != Number of Chunks)
       {
          if(!self.receivedData)
          {
            //allocate and initialize self.receivedData
          }

          [self.receivedData appendData:myData];    

       }
       else
       {

         //completed . do whatever with self.receivedData.
         //if you want to validate, just check the self.receivedData size with TotalSize

        self.chunkNumber = 1;

       }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T18:58:25.783

在 NSURLConnectionDataDelegate 中，有一个方法`connectionDidFinishLoading:`应该在服务器完成发送时调用。您还可以在 didReceiveResponse 中检索预期长度，但这不可靠且需要服务器端支持。

# ember.js - 控制台中的 emberjs 我看到记录已创建，但车把未显示它们

> ID：15666988
> 
> 赞同：0
> 
> 时间：2013-03-27T18:47:44.010
> 
> 标签：ember.js, handlebars.js, ember-data

首先**非常感谢 Mike Grassotti**对 IRC 的帮助。他通过 save 方法帮助解决了错误。

我的问题是在控制台中我看到记录已创建但未显示。

我正在使用 ember-data 创建新记录。**addComment 函数**在**事务中** 创建记录，而**save 函数**只调用**this.transaction.commit**。

在我单击 save() 后的控制台中，记录似乎已创建，但车把不显示新创建的记录。这是我在深入研究 console.log 的结果时在控制台中看到的摘录

```
 >committed: Object
    firstRecordKind: "belongsTo"
    firstRecordName: "post"
 >firstRecordReference: Object
   clientId: 4
   id: "ember411"
>type: EmBlog.Comment
   ClassMixin: Ember.Mixin
  >FIXTURES: Array[1]
    0: Object
      body: "ty"
      id: "ember411"
      post: "1" 
```

要创建一个新记录，点击post -> 然后'post title' -> 在底部的addComment-> 然后保存，你会看到记录没有被创建。

**来自[jsfiddle](http://jsfiddle.net/VMkQ2/2/)的相关代码。该控制器将没有路由，因为它将被侧载**

```
EmBlog.CommentNewController = Em.ObjectController.extend({

 needs: ['postsShow'],
 isAddingNew: false,

 addComment: function(body){
    console.log("this: ", this.toString());
    var post = this.get('controllers.postsShow.content');
    console.log(post);

   transaction = this.get('store').transaction();
   console.log(transaction);
   console.log(this.get('content').toString());

   this.set('content', transaction.createRecord(EmBlog.Comment, ({post: post })));
   this.transaction = transaction;

   console.log(this.get('content').toString());

   this.set('isAddingNew', true);
 },

 save: function(){
   var comment = this.get('content');

   comment.one('didCreate', this, function() {
      this.set('isAddingNew', false);
   });

  this.transaction.commit();

 }  

}); 
```

**车把模板中的相关位**

```
<script type="text/x-handlebars" data-template-name="posts/show">
  <h1>Post</h1>

  <h3> {{title}} </h3>
  <h3> {{body}} </h3>
   <br/>
  <p> {{#linkTo 'posts.index'}} back {{/linkTo}}</p>
  <p> {{#linkTo 'posts.edit' content}} Edit the post  {{/linkTo}}</p> 

  <br/>
  <b> Comments</b>
   {{render 'comment/new' comments}}
</script>

<script type='text/x-handlebars' data-template-name='comment/new'>
     {{#if controller.isAddingNew}}
     <form {{action save on='submit'}}>
    {{view Ember.TextArea valueBinding="body" placeholder="body"}}
    <button type="submit"> save comment </button>  
    </form>
     {{/if}} 

    <br/>

   <div>
   <button {{action addComment}} {{bindAttr disabled="isAddingNew"}}>Add Comment</button>
  </div>
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T10:11:35.790

嗯，也许我是盲人，但我看不到任何用于在您的模板中显示评论的代码。

就像是

```
<ul>
{{#each comment in comments}}
  <li>{{comment.body}}</li>
{{/each}}
</ul> 
```

应该可以解决问题。

# python - 将 raw_input 打印到文本文件时如何限制每行字符？

> ID：15666990
> 
> 赞同：0
> 
> 时间：2013-03-27T18:47:48.667
> 
> 标签：python, printing, word-wrap

我正在尝试编写报告创建脚本。简单地说，我让用户通过几个 raw_input()s 提交字符串。这些字符串被分配给全局变量，当它们完成后，我需要脚本来打印字符串，但将其限制为每行仅 80 个字符。我查看了 textwrap 模块并四处寻找其他提出此问题的人。但我只发现有人试图从原始输入或预先存在的文件中限制脚本中打印的字符，而从不尝试打印到新文件。继承人的一些代码基本上是我尝试做的事情的较短版本。

这是代码：

```
def start():
    global file_name
    file_name = raw_input("\nPlease Specify a filename:\n>>> ")
    print "The filename chosen is: %r" % file_name
    create_report()
    note_type()

def create_report():
    global new_report
    new_report = open(file_name, 'w')
    print "Report created as: %r" % file_name
    new_report.write("Rehearsal Report\n")
    note_type()

def note_type():
    print "\nPlease select which type of note you wish to make."
    print """
1\. Type1
2\. Print
"""
    answer = raw_input("\n>>> ")
    if answer in "1 1\. type1 Type1 TYPE1":
        type1_note()
    elif answer in "2 2\. print Print PRINT":
        print_notes()
    else:
        print "Unacceptable Response"
        note_type()

def type1_note():
    print "Please Enter your note:" 
    global t1note_text
    t1note_text = raw_input(">>> ")
    print "\nNote Added."
    note_type()

def print_notes():
    new_report.write("\nType 1: %r" % t1note_text)
    new_report.close
    print "Printed. Goodbye!"
    exit(0)

start() 
```

* * *

这是我的终端输入

```
---
new-host-4:ism Bean$ python SO_Question.py  

Please Specify a filename:  
">>> " test3.txt  
The filename chosen is: 'test3.txt'  
Report created as: 'test3.txt'  

Please select which type of note you wish to make.  

1\. Type1  
2\. Print  

">>> " 1  
Please Enter your note:  
">>> "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam at dignissim diam.        Donec aliquam consectetur pretium. Sed ac sem eu nulla tincidunt accumsan. Praesent vel velit   odio. Donec porta mauris ut eros bibendum consequat. Class aptent taciti sociosqu ad litora  torquent per conubia nostra, per inceptos himenaeos. Integer adipiscing nibh in turpis  placerat non interdum magna convallis. Phasellus porta mauris at nibh laoreet ac vulputate   elit semper.

Note Added.  

Please select which type of note you wish to make.  

1\. Type1  
2\. Print  

">>> "2  
Printed. Goodbye!  
new-host-4:ism Bean$ 
```

* * *

唯一的问题是，当我打开文件（test3.txt）时，lorem ipsum 的整个段落都打印到一行。像这样：

```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam at dignissim diam. Donec aliquam consectetur pretium. Sed ac sem eu nulla tincidunt accumsan. Praesent vel velit odio. Donec porta mauris ut eros bibendum consequat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Integer adipiscing nibh in turpis placerat non interdum magna convallis. Phasellus porta mauris at nibh laoreet ac vulputate elit semper. 
```

有人有任何建议让 textwrap 每行打印 80 个字符到文件中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:19:39.477

如果您不想使用任何其他模块，您可以自己将用户输入的值拆分为 80 个字符块：

```
def split_input(string, chunk_size):
    num_chunks = len(string)/chunk_size
    if (len(string) % chunk_size != 0):
        num_chunks += 1
    output = []
    for i in range(0, num_chunks):
        output.append(string[chunk_size*i:chunk_size*(i+1)])
    return output 
```

然后您可以将输出列表打印到文件中：

```
input_chunks = split_input(user_input, 80)
for chunk in input_chunk:
    outFile.write(chunk + "\n") 
```

**更新：**

此版本将尊重空格分隔的单词：

```
def split_input(user_string, chunk_size):
    output = []
    words = user_string.split(" ")
    total_length = 0

    while (total_length < len(user_string) and len(words) > 0):
        line = []
        next_word = words[0]
        line_len = len(next_word) + 1

        while  (line_len < chunk_size) and len(words) > 0:
            words.pop(0)
            line.append(next_word)

            if (len(words) > 0):
                next_word = words[0]
                line_len += len(next_word) + 1

        line = " ".join(line)
        output.append(line)
        total_length += len(line) 

    return output 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-12T09:59:12.747

在 python 3 中，您可以使用**textwrap.fill**打印 80 个字符行：

```
import textwrap

print (textwrap.fill(your_text, width=80)) 
```

见[https://docs.python.org/3.6/library/textwrap.html](https://docs.python.org/3.6/library/textwrap.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T18:59:51.450

您可以尝试使用[Textwrap](http://docs.python.org/2/library/textwrap.html)模块：

```
from textwrap import TextWrapper

def print_notes(t1note_text):
    wrapper = TextWrapper(width=80)
    splittext = "\n".join(wrapper.wrap(t1note_text))
    new_report.write("\nType 1: %r" % splittext)
    new_report.close
    print "Printed. Goodbye!"
    exit(0) 
```

# jquery - 无法将事件绑定到 datetimepicker 插件

> ID：15666993
> 
> 赞同：5
> 
> 时间：2013-03-27T18:48:01.257
> 
> 标签：jquery, datetimepicker

我正在使用 Trent Richardson 的 jQuery UI Timepicker。我知道插件已被修改为覆盖 $.datepicker._selectDate 以便选择器在选择日期时保持打开状态。那太棒了。

但是，我被要求在双击日期时关闭选择器。其他一切都保持不变，包括完成后关闭选择器的按钮等，只是他们希望双击也能正常工作。

我尝试以多种方式将双击事件绑定到日历日期（主要是变体`$('.ui-datepicker-calendar a').bind('dblclick', function () {/*do something*/});)`——事实上，我也尝试过绑定其他事件——但似乎没有任何效果。我已经尝试了针对[如何发布的建议双击关闭 DateTimePicker](https://stackoverflow.com/questions/13198715/how-to-close-datetimepicker-with-a-double-click)没有喜悦。

这甚至可能吗？是否需要修改onSelect函数来区分单击和双击？（以及如何，何时`event.type`未定义？）我是否绑定到错误的元素？（我尝试过绑定`$('.ui-datepicker-calendar a')`、`$('#ui-datepicker-div')`、`$('#ui-datepicker-div .ui-datepicker-calendar a')`和许多其他变体。）

为了完整起见，这是我的代码：

```
$('#date-range-from, #date-range-to').datetimepicker({
    changeYear: true,
    changeMonth: true,
    controlType: 'select',
    dateFormat: 'M dd, yy ',
    minDate: 'Jan 01, 2010 ',
    maxDate: 'Dec 31, xxxx '.replace('xxxx', new Date().getFullYear() + 1),
    showAnim: '',
    showMinute: false,
    showOtherMonths: true,
    showTime: false
}).on('change', function () {
    var t = $(this),
        date = t.val().slice(0, 12),
        fromto = t.attr('id').replace('date-range-', ''),
        time = t.val().slice(-5);
    dashboardOpts.dateRange[fromto].date = date;
    dashboardOpts.dateRange[fromto].time = time;
}).mousedown(function () {
    $('#ui-datepicker-div').toggle();
    $(this).blur();
});
$('#ui-datepicker-div .ui-datepicker-calendar a').bind('dblclick', function () {
    console.log('I just want to see if this event can be bound!');
}); 
```

提前感谢您的帮助！

**编辑：** 为澄清起见，“...的变体`.bind('dblclick', ...)`”是指我尝试过`.live('dblclick', ...)`（即使我知道它已被弃用）和`$(element).on('dblclick', ...)`and `$(document).on('dblclick', element, ...)`。

我也尝试过`.stopPropagation()`，`.stopImmediatePropagation()`即使我不相信这是一个传播问题。

我相信 datetimepicker 插件的代码中有一些东西在劫持日历中的事件。不幸的是，我还没有找到它。非常感谢任何见解！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T16:37:32.100

在 datetimepicker 的源代码中，您可以看到作者在选择日期时使用 hack 来禁用关闭。他称自己为糟糕的黑客行为。

无论如何，这是一种解决方法，可以在您双击日期时关闭日期选择器。我使用`onSelect`函数回调：

[看演示](http://jsfiddle.net/PfQh4/11/)

```
 $('#mydatepicker').datetimepicker({
     onSelect: function (e, t) {
         if (!t.clicks) t.clicks = 0;

         if (++t.clicks === 2) {
             t.inline = false;
             t.clicks = 0;
         }
         setTimeout(function () {
             t.clicks = 0
         }, 500);
     }
 }); 
```

所以，在某种程度上，我使用超时来模拟 dblclick 行为。我将它设置为 500 毫秒，但如果您希望您的 dblclick 或多或少敏感，只需使用它即可。

**更新**

@JaredKnipp看来切换月份时焦点设置为输入（无效？？？），我没有足够的时间详细检查，对不起。作为一个简单的解决方法，您可以尝试以下代码段，将其添加到 endDateTextBox onClose 回调：

```
 var focusHandlers = $._data(endDateTextBox[0], "events").focus;
         $._data(endDateTextBox[0], "events").focus = {};
         endDateTextBox.one('focusin.datetimepicker mouseenter.datetimepicker', function () {
             setTimeout(function () {
                 $._data(endDateTextBox[0], "events").focus = focusHandlers;
                 endDateTextBox.blur();
             }, 0);
             $(this).off('focusin.datetimepicker mouseenter.datetimepicker');
         }); 
```

请注意，如果您使用的是 1.8 之前的 jq 版本，则必须使用`$.data()`not`$._data()` 希望它有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:52:30.247

下面的工作吗？

```
$('#ui-datepicker-div .ui-datepicker-calendar a').dblclick(function () {
  console.log('I just want to see if this event can be bound!');
}); 
```

[dblclick 文档](http://api.jquery.com/dblclick/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:06:43.823

**编辑**

`live`也可以在 jquery 1.7 或`on`jquery 1.9中尝试：

```
$('#ui-datepicker-div .ui-datepicker-calendar a').live('dblclick', function () {
  alert('I just want to see if this event can be bound!');
}); 
```

* * *

`a tag`在绑定之前尝试取消绑定。也许它与另一个函数绑定：

```
$('#ui-datepicker-div .ui-datepicker-calendar a').unbind('dblclick');
$('#ui-datepicker-div .ui-datepicker-calendar a').bind('dblclick', function () {
  alert('I just want to see if this event can be bound!');
}); 
```

# join - 将许多表加入到地图中

> ID：15666999
> 
> 赞同：0
> 
> 时间：2013-03-27T18:48:13.617
> 
> 标签：join, map, spring-3, hibernate-4.x

我有 3 个表：用户、角色、项目。此外，我创建了一个将它们链接在一起的表，其结构如下：id、id_user、id_role、id_project。我想在用户类中使用注释创建一个地图：`Map <Project, Role>`。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:53:50.610

这取决于您的休眠版本，但您应该能够使其正常工作。我不确定创建 Map 是什么意思（您希望在其中存储什么以及您希望密钥是什么？）

查看[http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-association](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-mapping-association)

您可以查看与使用 @JoinTable 和 @MapKey 相关的所有选项