# StackOverflow 问答 16201000-16201999

# html - 文本变长时行为会发生变化

> ID：16201000
> 
> 赞同：0
> 
> 时间：2013-04-24T19:56:18.380
> 
> 标签：html

我在我的网站上使用以下 div 结构进行布局，

```
<div>
     <div style="float: left; width: 200px;">1</div>
     <div style="float: left;">2</div>
     <br style="clear: left;" />
</div>
<div>
     <div style="float: left; width: 200px;">3</div>
     <div style="float: left;">4</div>
     <br style="clear: left;" />
</div> 
```

这个例子很好用，输出如下，

```
1 2
3 4 
```

我一直在寻找。但是，当我将“4”文本加长时，行为会更改为以下内容，

```
1 2
3 
44444444444444444444444444444444 
```

虽然我期待以下，

```
1 2
3 44444444444444444444444444444..
  44444 
```

我基本上可以使用两行两列的表格，而不是为这个 div 问题而苦苦挣扎。但是他们说使用 div 是一种更好的做法。那么，解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:34:27.233

为了达到您期望的结果，最好将 div 1 和 3 包装在另一个中（或任何元素，就此而言，如果您想要语义）并将其以固定宽度和 2 和 4 浮动到左侧第二个容器漂浮在它旁边。为了获得您描述的包装，您还必须修复正确的容器，或者按照评论中的建议使用 max-width，'word-wrap: break-word;' 因为对于浏览器来说，这是一个很长的词。

你可以这样做：

```
<div style="width: 30%; float:left;">
  <div>1</div>
  <div>3</div>
</div>
<div style="width: 70%; float: left; word-wrap: break-word;">
  <div>2</div>
  <div>4</div>
</div> 
```

这是一个 jsfiddle，因此您可以看到它的实际效果并使用它：http: [//jsfiddle.net/gSEtW/](http://jsfiddle.net/gSEtW/)

注意：只使用 div 是不好的，你应该对 HTML 语义做一些研究。使用内联样式也很糟糕，您应该使用单独的样式表。

# matlab - 使用matlab或其他软件在图像中设置原点并输出另一点的坐标

> ID：16201001
> 
> 赞同：0
> 
> 时间：2013-04-24T19:56:25.857
> 
> 标签：matlab

我试图找到一种简单的方法来查找图像中从一个点（设置在原点）到另一点（任意设置）的距离（x，y 坐标）。理想情况下，这将是 matlab 代码，允许在图像上单击两次以设置原点，然后设置第二个点，然后输出坐标。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:46:52.780

图像坐标系的原点在图像的左上角点 (1,1)（不是 (0,0)）。无论如何，如果您保留该点或任何其他点的原点，假设您的原点为 P1(x1,y1)，另一个点为 P2(x2,y2)。不用于计算这些点之间的距离，您可以使用不同的指标。三个著名的指标是： 三个著名的指标（计算两点之间的距离）： 1- 曼哈顿距离

```
d = abs(x1-x2) + abs(y1-y2) 
```

2-欧几里得距离

```
d = sqrt((x1-x2)^2 + (y1-y2)^2) 
```

3- 闵可夫斯基距离

```
d = (abs(x1-x2)^c + abs(y1-y2)^c)^(1/c) 
```

有关指标的更多信息，请参阅这些链接[1](http://en.wikipedia.org/wiki/Euclidean_distance)、[2](http://en.wikipedia.org/wiki/Manhattan_distance)、[3](http://en.wikipedia.org/wiki/Minkowski_distance)。

在 MATLAB 中，您可以使用 ginput 函数，它提供了鼠标选择像素的功能，因此您首先加载图像，然后选择点：

```
I = imread('c:\test.jpg');
imshow(I);
[X,Y] = ginput(2); 
```

2 是选择数据的数量（从图像中选择像素），那么你可以使用这样的东西：

```
d = ((X(1) - X(2)) ^ 2 + (Y(1) - Y(2)) ^ 2) ^ 0.5; 
```

您还可以使用任何其他指标....

# pharo - 如何显示 Pharo 2 欢迎信息？

> ID：16201004
> 
> 赞同：2
> 
> 时间：2013-04-24T19:56:32.740
> 
> 标签：pharo

我关闭了标题为“Welcome to Pharo 2.0”的工作区。我如何再次打开它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T20:18:31.293

尝试打开一个新的空工作区并使用右上角的三角形进入“以前的内容”条目。你应该在那里找到默认的“Welcome to Pharo 2.0”文本：

![在此处输入图像描述](https://i.stack.imgur.com/Sg5Xk.png)

# matlab - 独立 matlab 应用程序的“内存不足”错误 - 内存碎片

> ID：16201005
> 
> 赞同：3
> 
> 时间：2013-04-24T19:56:44.683
> 
> 标签：matlab, fragmentation, out-of-memory, matlab-compiler

我必须将应用程序作为*独立的 Matlab 可执行文件*交付给客户端。该代码包括对内部创建多个元胞数组的函数的一系列调用。

我的问题是，当调用此函数的次数随着用户负载的增加而增加时，就会发生内存不足错误。我猜这是*低级内存碎片*，因为工作区变量与循环数无关。

[如此处](https://stackoverflow.com/a/3301971/2026975)所述，退出并重新启动 Matlab 是目前此类内存不足错误的唯一解决方案。

我的问题是，我如何在独立应用程序中实现这样的机制来保存数据，在出现内存不足错误的情况下（或以某种方式预测此类错误的可能性很高时）自行退出并重新启动。

有没有可用的最佳实践？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:29:02.680

这有点难。您可以更改代码以将工作分解为块以提高效率，而不是寻求重新启动以清除问题？碎片主要与单元相关的内存使用*峰值*以及数据项大小的变化程度成正比，而随着时间的推移与总使用量成正比。如果您可以将一大块工作分成按顺序完成的小块，这可以降低碎片化内存使用的“高水位线”。您还可以通过使用共享其支持数据值的“享元”数据结构来节省内存使用量，或者有时转换为基于单元格的结构以引用对象或数字代码。你能和我们分享一个你的代码和数据结构的例子吗？

从理论上讲，您可以通过将工作区和相关状态保存到 mat 文件并让可执行文件启动另一个实例并选择重新加载该状态并继续，然后让原始可执行文件退出来获得一个干净的状态。但就用户体验和调试能力而言，这将是非常难看的。

另一种选择是将高碎片代码卸载到另一个可以被杀死并重新启动的工作进程，而主要的可执行进程仍然存在。如果你有并行计算工具箱，现在可以编译成独立的 Matlab 可执行文件，这将非常简单：打开一个由一两个工人组成的工人池，并使用同步调用在其中运行脆弱的代码，定期杀死工人并提出新的。工人是独立的进程，从非碎片化的内存空间开始。如果您没有 PCT，您可以通过将您的应用程序编译为两个单独的应用程序（驱动程序应用程序和工作程序应用程序）来推出自己的应用程序，并让主应用程序启动一个工作程序并通过 IPC 控制它，来回传递您的数据作为 MAT 文件或字节流。那'

也许您也可以将一些零碎的代码下推到 Java 层，它可以更优雅地处理类似单元格的数据结构。

首先将代码更改为不那么脆弱可能是更简单和更容易的方法，并且导致应用程序设计不那么复杂。根据我的经验，这通常是可能的。如果您分享一些代码和数据结构细节，也许我们可以提供帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T13:32:06.947

[另一种选择是使用chkmem 之](http://www.mathworks.com/matlabcentral/fileexchange/13548)类的函数定期检查内存碎片。

您可以集成此函数，以便在每两次迭代的代码中静默调用，或者使用一个`timer`对象每隔 X 分钟调用一次...

这个想法是使用这些未记录的函数`feature memstats`并`feature dumpmem`获得除了当前分配的最大变量之外的最大可用内存块。使用它，您可以猜测是否有内存碎片的迹象。

检测到时，您会警告用户并指导他们如何保存当前会话（导出到 MAT 文件）、重新启动应用程序以及在重新启动时恢复会话。

# jquery - 使用名称作为选择器附加到元素

> ID：16201010
> 
> 赞同：0
> 
> 时间：2013-04-24T19:57:00.403
> 
> 标签：jquery

我已将一堆代码移至 .net 用户控件。为了使事情保持相当通用，我试图将所有依赖唯一 ID 的 jQuery 选择器更改为类或名称选择器。

现在，我在将使用 jQuery 生成的 HTML 附加到使用名称选择器的元素时遇到问题。

这就是我所说的：

```
var displayResultsName = $(this).data("str");
$(html).appendTo('[name=' + displayResultsName + ']'); 
```

出于某种原因，jQuery 不喜欢这样。有没有更好或更正确的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:05:58.060

你错过了引号试试这个

```
$(html).appendTo('[name="' + displayResultsName + '"]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:23:00.180

[http://jsfiddle.net/U6WGH/](http://jsfiddle.net/U6WGH/)

```
//simple value added to selector by name
$('input[name="myInput"]').val('Hello!');

//object created in memory and appended to div by name
var domObject = $('<span>Yo.</span>');
$('div[name="myDiv"]').append(domObject);

//object created on the fly and appended to div by name
$('<span>Wasup?</span>').appendTo($('div[name="otherDiv"]')); 
```

# javascript - jquery 将元素与序列化进行比较

> ID：16201015
> 
> 赞同：0
> 
> 时间：2013-04-24T19:57:10.863
> 
> 标签：javascript, jquery

我正在尝试将表单元素的值与其默认文本（通过 title 属性设置）进行比较。如果 VALUE == TITLE，请将值更改为零长度字符串。但是，我似乎无法让它工作。我确定这只是我缺乏 Javascript 和 jQuery 的经验。非常感谢。

HTML

```
<form name="results-form" id="results-form">

    <input type="text" name="price-min" class="form-textbox-small no-radius defaultText" data="Minimum" title="Minimum" onchange="UpdateSearch()">

    <input type="text" name="price-max" class="form-textbox-small no-radius defaultText" data="Maximum" title="Maximum" onchange="UpdateSearch()">

</form> 
```

Javascript

```
function updateSearch(){
    $.each($("#results-form").serializeArray(),function(){
        console.log("value: "+this.value+"     data: "+this.data+"     title: "+this.title);
       if(this.value == this.title){

          this.value = '';

       }

    });
    var FormData = $("#results-form :input[value!='']").serialize();
    console.log(FormData);
    $(".defaultText").blur();
}

$(document).ready(function () {

    $(".defaultText").focus(function (srcc) {
        if ($(this).val() == $(this)[0].title) {
            $(this).removeClass("defaultTextActive");
            $(this).val("");
        }
    });

    $(".defaultText").blur(function () {
        if ($(this).val() == "") {
            $(this).addClass("defaultTextActive");
            $(this).val($(this)[0].title);
        }
    });

    $(".defaultText").blur();
}); 
```

控制台输出

```
value: 3     data: undefined     title: undefined 
value: Maximum     data: undefined     title: undefined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:03:17.217

尝试这个：

```
var arr = $("#results-form").serializeArray();

$.each(arr, function (i, input) {

    var value = input.value;
    var $elem = $("[name='" + input.name + "']");
    var data = $elem.attr('data');
    var title = $elem.attr('title');

    console.log("value: " + value  + "     data: " + data  + "     title: " + title );

    // You can process the parameters here now
}); 
```

# wix - WiX IISMain 如何设置？

> ID：16201017
> 
> 赞同：2
> 
> 时间：2013-04-24T19:57:15.003
> 
> 标签：wix

我的安装程序使用 IISMain 安装到典型的 IIS 文件夹结构：

```
<Fragment>
  <Directory Id="TARGETDIR" Name="SourceDir">
    <Directory Id="IISMain" Name="inetpub"> 
```

当只有一个`C:\`驱动器时，它会安装到`C:\inetpub\`. 但是，我们最近添加了一个`E:\`驱动器并在其上创建了一个`Inetpub`文件夹。除此之外，我们没有对系统进行任何更改 - 我们所做的只是添加`E:\`驱动器并使用典型`New Folder`功能来创建新`Inetpub`文件夹。但是，我的安装程序现在安装到新`E:\Inetpub\`文件夹中。

虽然这是安装程序所需的功能，但我对如何`IISMain`知道指向新文件夹而不是原始文件夹感到困惑。`IISMain`目录路径如何设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:34:14.170

`TARGETDIR`是一个 Windows Installer 文件夹，最终将指向机器上最大（最多可用空间）驱动器的根目录。所以如果`E:\`大于`C:\`那么`TARGETDIR`将是`E:\`。

# algorithm - 如何将相对重力转换为坐标

> ID：16201019
> 
> 赞同：0
> 
> 时间：2013-04-24T19:57:17.370
> 
> 标签：algorithm, mapping, coordinate

我有个问题。我有 N 个对象和 N x N 矩阵 M。每个条目 M(i, j) 包含（一种）相对重力，表示 i 将 j 拉向它（或相反地将它拉离它）的强度。我想通过为每个对象分配一个坐标来将这些 N 个对象放置在二维 R x R 平面上。

有没有这样做的算法/方法？天体物理、物理、化学等方面肯定有一些常用的方法，谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:57:07.183

问题是，鉴于我们知道 n 个物体之间的 n*n 距离，如何获得它们的位置？

```
1\. Put the first one, say a, at (0,0)
2\. Put the second one b at ( |b-a|, 0 )
3\. For the third one c, it is at the one of the two intersections of the two circles:
     |p-a|=|c-a| and |p-b|=|c-b|. 
     Solve this system of quadratic equations using the well-known formula, choose
     either of the solutions as the position of c.
4\. For any other points p, do the same thing as we're done for c, but choose one of the
     two solutions that is consistent with the distance |p-c|. And check the distance
     between p and all previous points. If the check fails, return with failure. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:35:54.047

您有兴趣为每个物体分配坐标 (xi,yi,zi) 和质量 (mi)，以使引力一致，对吧？

一次考虑 8 个点。你总共有 32 个未知数和 28 个方程。您可以假设第一个点位于原点，第二个点位于 x 轴上。这意味着，您将有 28 个未知数和 28 个方程。

因此，第一个设备和算法一次解决 8 个点。然后在每次迭代中递增地添加一个点。

**===演练===**

考虑在 D 维中给定 n 个点。您只有点之间的距离，但没有坐标。目标是找到每个点的坐标。

如果 D=1，您一次只需要考虑两个 (+1) 点。将第一个点放在原点。将第二个点放在原点的正侧。您可以相对于原点放置第三个点，但根据到第一个点的距离等将其放置在它的右侧或左侧...

如果 D=2，将点 1 放在原点，指向 x 轴的正侧，第三个点位于 y 轴的正侧，具体取决于距离。从第四点开始，您可以使用任何两个放置的点来放置下一个，并使用任何其他点来优化选项（将有两个选项）。

与 D=3 类似。将前三个点都放在 xy 平面 (z=0) 上。接下来，放置 z 轴正向部分的第 4 个点。等等。

**回到重力：** 你的问题很复杂，因为你不能准确地将质量放在原点。所以你需要超过 5 个点来放置它们。正如我上面所展示的，你最多需要 8 分。

如果你的质量都相等，你可以计算距离（~重力的反比）并应用 D=3 时的情况。

# vb.net - 工具提示显示两次

> ID：16201022
> 
> 赞同：1
> 
> 时间：2013-04-24T19:57:35.620
> 
> 标签：vb.net, winforms, tooltip, mousehover

我正在显示`ToolTip`某个按钮的`MouseHover`事件。如果我在它工作后检查它，但如果我离开，请等待工具提示消失并返回按钮，它会出现两次。我尝试取消它，`MouseLeave`但它仍然出现第二次时间的两倍。

```
Private Sub someButton_MouseHover(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles someButton.MouseHover

   Dim tooltipSearch As New ToolTip()
   tooltipSearch.Show("I'm a tooltip"), someButton)

End Sub

 Private Sub someButton_MouseLeave(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles someButton.MouseLeave

    Dim toolTip As New ToolTip()
    toolTip.GetToolTip(someButton)
    toolTip.Hide(someButton)
    toolTip.Dispose()

End Sub 
```

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:28:22.020

您使用的`ToolTip`不是应该使用的方式（另请查看[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.aspx):)）。它就像任何其他控件一样，首先将其拖到您的表单上（就像您使用其他控件一样）。

如果您的工具提示中没有要显示的动态文本，您可以使用方法轻松地在构造函数中设置文本[`SetToolTip`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.settooltip.aspx)。如果您确实想要一些动态文本，您可以在您的`MouseHover`活动中使用此方法。

除此之外，你不应该做任何其他事情。只需在您的工具提示上设置正确的延迟，它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T13:40:28.007

```
Private Sub someButton_MouseHover(sender As Object, e As System.EventArgs) _
                                  Handles someButton.MouseHover
  ToolTip1.SetToolTip(someButton, "My name is Steve chamba from south Africa")
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-14T23:58:54.697

关于将 ToolTip 控件拖到窗体的答案很棒。不过，Button 控件有一个微妙之处。他们似乎会自动将工具提示设置为按钮的文本，因此如果您还调用，`ToolTip1.SetToolTip(myButton, "Button Text")`那么当您将鼠标悬停在按钮上时，dot-net 会绘制工具提示文本的两个副本。

# sql - 构建不包含基于层次结构的数据的 SQL 查询

> ID：16201029
> 
> 赞同：2
> 
> 时间：2013-04-24T19:57:56.217
> 
> 标签：sql, sql-server, sql-server-2008-r2

过去几天我在 Google 和 SO 上花了很多时间，但我似乎找不到我的问题的答案。不确切知道如何将问题表述为一个合理的问题会使其变得更加困难。你不知道你不知道什么，对吧？

由于业务限制，我无法发布我的确切代码和数据库结构，所以我会尽力给出一个可靠的例子。

**客户表**- 保存客户数据

```
[CustId] | [CustName]  
---------------------
1        | John Smith  
2        | Jane Doe
3        | John Doe 
```

**代码表**- 保存代码数据

```
[CodeId] | [CodeDesc]
---------------------
A        | A Desc
B        | B Desc
C        | C Desc
D        | D Desc
E        | E Desc 
```

**CustomerCode 表**- 将客户与代码组合在一起

```
[CustId] | [CodeId]
-------------------
1        | A
1        | B
2        | B
2        | C
2        | D
3        | C
3        | E 
```

**CodeHierarchy 表**- 如果客户有 ConditionCode，则不应包含的代码层次结构 (DropCode)

```
[ConditionCode] | [DropCode]
----------------------------
A               | B
B               | C
B               | D 
```

现在我将尝试解释我的实际问题。

我想要完成的是编写一个查询（视图），它将根据 CodeHierarchy 表列出代码。

结果将是这样的：

```
[CustName] | [CodeId]
-------------------
John Smith | A
Jane Doe   | B
John Doe   | C
John Doe   | E 
```

没有为 John Smith 列出代码 B，因为他有代码 A。没有为 Jane Doe 列出代码 C 和 D，因为她也有代码 B。John Doe 列出了所有代码（请注意，E 甚至不在 CodeHierarchy 中桌子）。

我尝试了一些不同的东西（内部连接、左/右连接、子查询等），但我无法得到我正在寻找的结果。

作为基本查询，这将返回所有代码：

```
SELECT 
    Customer.CustomerName, 
    Code.CodeDesc  
FROM 
    Customer 
        INNER JOIN CustomerCode
            ON Customer.CodeId = CustomerCode.CodeId
        INNER JOIN Code
            ON CustomerCode.CodeId = Code.CodeId 
```

这只返回 ConditionCodes 的代码（我明白为什么，但我认为当时可能值得一试）：

```
SELECT 
    Customer.CustomerName, 
    Code.CodeDesc  
FROM 
    Customer 
        INNER JOIN CustomerCode
            ON Customer.CodeId = CustomerCode.CodeId
        INNER JOIN Code
            ON CustomerCode.CodeId = Code.CodeId
        INNER JOIN CodeHierarchy
            ON Customer.CodeId = CodeHierarchy.ConditionCode
            AND Customer.CodeId != CodeHierarchy.DropCode 
```

我尝试了一个子查询（没有可用的代码），无论成员是否有合格的层次结构，最终都会删除所有 DropCodes（即，即使没有 A，也不会返回带有 B 的客户行)

我有一个想法，将基本查询置于子查询之上，并将其与 CodeHierarchy 表连接起来，但我一直坚持如何编写查询：

```
SELECT
    *
FROM
    (
        base query (with all codes)
    ) CustomerCodesAll
        INNER/LEFT JOIN CodeHierarchy
            ON ? 
```

我也一直在阅读 CTE，但我不确定如何使用该技术。

这最终将成为为了报告目的而被查询的视图。客户表包含更多数据，包括出生日期、性别、公司状态等。视图将很简单，可以提取所有内容。针对视图的查询将包括 dob、gender 等的 where 子句。

谁能指出我正确的方向？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:25:09.433

```
SELECT 
    Customer.CustName, 
    Code.CodeDesc
FROM 
    Customer 
        INNER JOIN CustomerCode AS posCustomerCode
            ON Customer.CustId = posCustomerCode.CustId
        INNER JOIN Code
            ON posCustomerCode.CodeId = Code.CodeId
        LEFT JOIN CodeHierarchy
            ON posCustomerCode.CodeId = CodeHierarchy.DropCode

WHERE 
    CodeHierarchy.ConditionCode NOT IN (
      SELECT CodeId 
      FROM CustomerCode AS negCustomerCode
      WHERE negCustomerCode.CustId=posCustomerCode.CustId
     )
     OR CodeHierarchy.ConditionCode IS NULL 
```

[SQLfiddle](http://sqlfiddle.com/#!3/b1981/11)

# ios - iOS 程序结构 - SQLite 和视图控制器

> ID：16201031
> 
> 赞同：0
> 
> 时间：2013-04-24T19:57:58.717
> 
> 标签：ios, database, sqlite, uitableview, uiviewcontroller

在我深入研究可能设置不佳的项目之前，我希望对我的项目有所了解。该应用程序是一个带有几个表视图的简单数据库集合。

快速示例：第一个表格视图填充了教师姓名。选择教师，下一个表格视图将填充该班级的所有学生。此外，选择该学生，然后会出现一个包含该学生详细信息的信息视图。

计划是使用 SQLite，所以我希望确保正确设置视图，以便以后自己更轻松。

到目前为止我的想法：

TeacherViewController - 从数据库中获取信息以填充表格视图。在 didSelectRowAtIndexPath 中包含 segue 以跳转到 StudentView。

StudentViewController - 再次从该教师表中的数据库中获取信息以填充学生，并使用 segue 跳转到信息页面。

StudentInfoView - 包含准备填充信息的表单。

需要能够添加教师，以及在每个教师/班级中添加学生。由于我还没有深入研究 SQLite，因此我希望得到有经验的人的建议。

谢谢，让我回答你可能有的任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:12:50.720

我在使用 SQLite 时发现的最重要的事情是确保您根据大数据捕获来安排视图。

例如，我有一个文字游戏，对 DB 最强烈的调用是生成游戏的起始位置。因此，当 viewController 第一次加载时，我在播放教程时在单独的线程中执行此操作。其余的调用既快速又简单，因此可以在游戏中的所需时间完成，而不会对性能产生任何影响（即，这包括 select count(*) from 6 where word = '%@' - 其中 DB 表有22000字）

你会发现 sqlite 调用非常快。我认为您的方法听起来不错，因为大型调用将在 viewControllers 的负载上完成，您可以在其中轻松添加加载指示器。

需要记住的一件事 - 可以让应用程序被拒绝的是您存储 sqlite 数据库的位置 - 因为如果它太大，那么您需要确保它不会在未经用户许可的情况下通过 iCloud 备份。

# ios - 如果它变得无响应，iOS 会杀死我的应用程序吗？

> ID：16201032
> 
> 赞同：3
> 
> 时间：2013-04-24T19:58:01.607
> 
> 标签：ios

我正在为办公室大厅安装开发一个 iOS 应用程序。该应用程序只会安装在六台 iPad 上，并且永远不会通过应用程序商店分发。该应用程序需要每天下载一次大型内容文件，并且在任何时候重新启动。此外，该应用程序将需要预加载一堆图像，以便它们可以快速显示。整个过程需要一段时间——大约 45 秒。它足够长，以至于操作系统在启动时杀死了应用程序。我已将加载过程推迟到启动后，这似乎可行。

我现在想知道的是我是否可能会遇到另一个操作系统强加的时间限制，如果运行循环的迭代需要太长时间才能返回（并且操作系统观察到应用程序没有响应），它会杀死它。是否存在这样的约束？或者，对于我的特定情况，我不需要担心用户界面无响应而烦人，只要我想在应用程序启动后在主线程上执行任务，我就可以安全地花时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:05:11.463

是的。如果您阻塞主线程并且应用程序响应系统事件的时间过长，看门狗将终止您的应用程序。不过，我不相信 Apple 会给出实际的时间。

更多信息在这里[https://developer.apple.com/library/ios/#technotes/tn2008/tn2151.html](https://developer.apple.com/library/ios/#technotes/tn2008/tn2151.html)或谷歌`0x8badf00d`。这是与看门狗超时相关的异常代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:06:52.800

从技术上讲，如果您的用户不介意等待无响应的 UI，您可以在应用程序启动后同步运行长时间运行的任务。但是，用户可能会锁定他们的设备并稍后解锁。如果您的应用程序无法响应应用程序生命周期回调 (`applicationWillResignActive:`和`applicationDidBecomeActive:`)，它仍然可能会被杀死。

有关 iOS 看门狗的技术信息，请参阅此[Q/A](http://developer.apple.com/library/ios/#qa/qa1693/_index.html) - 一个确保应用程序运行良好的守护进程。

请注意，当您从 Xcode 启动应用程序时，看门狗无论如何都不会杀死它。但是一旦你从主屏幕启动了你的应用程序，看门狗就会接管它。它实际上与 App Store 无关。

为了安全起见，我建议您在后台线程中执行长时间运行的任务。这很容易做到`[self performSelectorInBackground:withObject:]`。您可以显示活动指示器，甚至在 UI 中显示下载文件的数量，以便用户知道某些东西在幕后工作。

要从后台线程更新 UI，您必须调用主线程来执行更新代码。可以这样做：

```
- (void)methodRunningInBackground
{
    // some work is done here ...

    dispatch_async(dispatch_get_main_queue(), ^{
         // update your UI here
    });
} 
```

# javascript - jquery 和 HTML 放置

> ID：16201033
> 
> 赞同：0
> 
> 时间：2013-04-24T19:58:01.610
> 
> 标签：javascript, jquery, html, jquery-ui, jquery-dialog

我正在尝试使用 jQuery UI，尤其是对话框。首先我尝试了示例代码，它工作正常：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>dialog demo</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>

</head>
<body>
<button id="opener">open the dialog</button>
<div id="dialog" title="Dialog Title">I'm a dialog</div>
<script>

$( "#dialog" ).dialog({ autoOpen: false });
$( "#opener" ).click(function() {   
$( "#dialog" ).dialog( "open" );
});

</script>
</body>
</html> 
```

现在，我正在尝试在脚本中动态创建按钮和对话框，因此我将代码重写为：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>dialog demo</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>

<script>

// Create button
var open_button = document.createElement("button");
open_button.appendChild(document.createTextNode("Open the dialog"));
open_button.setAttribute("id", "opener");

document.body.appendChild(open_button);

// Creating dialog
var my_dialog = document.createElement("div");
my_dialog.setAttribute("title", "Dialog");
my_dialog.setAttribute("id", "dialog");

document.body.appendChild(my_dialog);

$( "#dialog" ).dialog({ autoOpen: false });
$( "#opener" ).click(function() {
    $( "#dialog" ).dialog( "open" );
});
</script>

</head>
<body>
</body>
</html> 
```

现在它失败并出现错误“body is null”。这是为什么？

但即使我在体内创建虚拟 DOM：

```
<div id="dummy_div"></div> 
```

...然后，在脚本中，将按钮和对话框都附加到它而不是正文，它仍然不起作用。

```
$("#dummy_div").append(open_button);
$("#dummy_div").append(my_dialog); 
```

我可能缺少一些 HTML 基础知识，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:02:14.343

您正在尝试在呈现 HTML 之前创建元素。

用这个：

```
 $(function() {
   $("#dummy_div").append(open_button);
   $("#dummy_div").append(my_dialog);

   $( "#dialog" ).dialog({ autoOpen: false });
   $( "#opener" ).click(function() {
     $( "#dialog" ).dialog( "open" );
   });
 }); 
```

祝你好运

**笔记**

```
$(function() { ... }); is the same thing as $(document).ready() 
```

[在此处阅读有关 document.ready() 的信息](http://docs.jquery.com/Tutorials%3aIntroducing_%24%28document%29.ready%28%29)

阅读该内容以获取有关 DOM 就绪的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:04:32.393

JavaScript 在页面中遇到时会立即执行。`<body>`所以在你的第二种情况下，你试图在浏览器创建元素之前写入元素。因此为什么它是空的。

将脚本包装在一个`window.load()`或一个`$(document).ready()`函数中，您应该一切正常。这将使 JavaScript 等到整个 DOM 都被渲染后，然后再尝试执行您的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:34:14.437

这是您在 jsfiddle 上的代码。这是工作

[http://jsfiddle.net/abdennour/795Yp/](http://jsfiddle.net/abdennour/795Yp/)

如果要将其嵌入网页中，则应在以下函数中调用它：

```
$(function(){

}) 
```

所以 ：

```
$(function(){
   // Create button
var open_button = document.createElement("button");
open_button.appendChild(document.createTextNode("Open the dialog"));
open_button.setAttribute("id", "opener");

document.body.appendChild(open_button);

// Creating dialog
var my_dialog = document.createElement("div");
my_dialog.setAttribute("title", "Dialog");
my_dialog.setAttribute("id", "dialog");

document.body.appendChild(my_dialog);

$( "#dialog" ).dialog({ autoOpen: false });
$( "#opener" ).click(function() {
    $( "#dialog" ).dialog( "open" );
});

}) 
```

# javascript - 多级选择器。Javascript 没有打印出结果。

> ID：16201039
> 
> 赞同：0
> 
> 时间：2013-04-24T19:58:15.620
> 
> 标签：javascript, select, option, options-menu

我试图让 javascript 打印出手机的价格，但由于某种原因它不会打印。我已经做了一个 js lint 测试，但我不明白为什么它没有连接起来。我希望有人能指出我正确的方向。这是我的jsfiddle。[http://jsfiddle.net/blimbam/HEu55/1/](http://jsfiddle.net/blimbam/HEu55/1/)。

这是我的 Javascript 代码。

```
 var priceBooks = {
    'iphone': {
        'prepay': {
            '12': "n/a",
                '18': "n/a",
                '24': "n/a",
                'prepay': 619
        },
            'CFM': {
            '12': "n/a",
                '18': 229,
                '24': 129,
                'prepay': "n/a"
        },
            'Band B': {
            '12': "n/a",
                '18': 219,
                '24': 119,
                'prepay': "n/a"
        }
    },
    HTCOne: {
        prepay: {
            '12': "n/a",
                '18': "n/a",
                '24': "n/a",
                'prepay': 599
        },
            'CFM': {
            '12': "n/a",
                '18': 179,
                '24': 79,
                'prepay': "n/a"
        },
            'Band B': {
            '12': "n/a",
                '18': 169,
                '24': 69,
                'prepay': "n/a"
        }
    },
    S3: {
        'prepay': {
            '12': "n/a",
                '18': 'n/a',
                '24': 'n/a',
                'prepay': 569
        },
            'CFM': {
            '12': "n/a",
                '18': 79,
                '24': 0,
                'prepay': 'n/a'
        },
            'BandB': {
            '12': 'n/a',
                '18': 69,
                '24': 0,
                'prepay': 'n/a'
        }
    }
},

    phone = document.GetElementById('phone'),
    plan = document.GetElementById('plan'),
    term = document.GetElementById('term'),
    price = document.GetElementById('price');

function showPrice() {
    'use strict';
    if (term.value !== '') {
        price.value = priceBooks[phone.value][plan.value][term.value];
    } else {
        price.value = 'wrong input';
    }
}
phone.onchange = plan.onchange = term.onchange = showPrice; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:06:42.203

它应该读取`getElementById`而不是`GetElementById`，使用开发人员控制台会在抛出错误时向您显示此问题。CTRL-SHIFT-J 将带您进入许多浏览器上的开发者控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:16:28.407

除了 Xotic750 建议更改`GetElementById`为之外`getElementById`，还有几个错位的逗号和分号。这是我修改后的代码：

```
var priceBooks = {
    'iphone': {
        'prepay': {
            '12': "n/a",
                '18': "n/a",
                '24': "n/a",
                'prepay': 619
        },
            'CFM': {
            '12': "n/a",
                '18': 229,
                '24': 129,
                'prepay': "n/a"
        },
            'Band B': {
            '12': "n/a",
                '18': 219,
                '24': 119,
                'prepay': "n/a"
        }
    },
    HTCOne: {
        prepay: {
            '12': "n/a",
                '18': "n/a",
                '24': "n/a",
                'prepay': 599
        },
            'CFM': {
            '12': "n/a",
                '18': 179,
                '24': 79,
                'prepay': "n/a"
        },
            'Band B': {
            '12': "n/a",
                '18': 169,
                '24': 69,
                'prepay': "n/a"
        }
    },
    S3: {
        'prepay': {
            '12': "n/a",
                '18': 'n/a',
                '24': 'n/a',
                'prepay': 569
        },
            'CFM': {
            '12': "n/a",
                '18': 79,
                '24': 0,
                'prepay': 'n/a'
        },
            'BandB': {
            '12': 'n/a',
                '18': 69,
                '24': 0,
                'prepay': 'n/a'
        }
    }
};

phone = document.getElementById('phone');
plan = document.getElementById('plan');
term = document.getElementById('term');
price = document.getElementById('price');

function showPrice() {
    'use strict';
    if (term.value !== '') {
        price.value = priceBooks[phone.value][plan.value][term.value];
    } else {
        price.value = 'wrong input';
    }
}
phone.onchange = plan.onchange = term.onchange = showPrice; 
```

# javascript - IFrame portlet 中的 JIRA - javascript 不起作用

> ID：16201040
> 
> 赞同：0
> 
> 时间：2013-04-24T19:58:16.200
> 
> 标签：javascript, liferay, jira

我正在尝试将 JIRA 应用程序作为 IFrame portlet 嵌入到 Liferay 中。我可以成功导航到 JIRA 站点并登录，但之后所有的 Javascript 元素都不起作用。所以我无法使用任何下拉菜单，甚至 JIRA 字段本身也无法正常显示。

我还应该提到 Liferay 和 JIRA 应用程序由同一个 Tomcat 服务器托管。

谁能想到会发生这种情况的原因？

谢谢！卡琳

编辑：最终运行 Firebug 后，我看到我收到以下错误：“访问属性 BLAH 的权限被拒绝”。当 Liferay 和 JIRA 从同一台服务器托管时，为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:34:16.843

这仍然是[XSS](https://en.wikipedia.org/wiki/Cross-site_scripting)并且同时它不违反[SOP](http://en.wikipedia.org/wiki/Same_origin_policy)。

但是，当然有一种符合标准的方式:)

您可以使用[window.postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)。

# haskell - Haskell 回报与预期不符

> ID：16201041
> 
> 赞同：0
> 
> 时间：2013-04-24T19:58:17.810
> 
> 标签：haskell, return, return-type

有人能告诉我为什么下面的代码不起作用吗？

```
test :: String
test =
    do
        return ("Hi") 
```

我一直在努力使 do 语句工作一段时间，我一直在努力解决这个问题。我知道这不是你应该如何做一个常数，但这巧妙地总结了我遇到的问题。

我收到以下错误：

```
Test.hs:5:21:
Couldn't match expected type `Char' with actual type `[Char]'
In the first argument of `return', namely `("Hi")'
In a stmt of a 'do' block: return ("Hi")
In the expression: do { return ("2") } 
```

**更新：**啊，我明白了。在我努力抽象到导致我出现问题的部分时，我刚刚创建了另一个问题。尽管如此，这确实无意中让我解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:03:00.267

GHCi 给出以下信息：

```
:t do {return ("Hi")}
do {return ("Hi")} :: Monad m => m [Char] 
```

这意味着`do {return ("Hi")}`不是`String`aka类型`[Char]`，而是`Monad m => m [Char]`.

列表是一个 monad，因此它会处理`Monad m`类型中的 ，但会留下 [Char]；但是从 中取出列表后`String`，剩下的只是`Char`，无法匹配`[Char]`，所以报错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T20:03:01.967

`return`在 Haskell 中不是关键字——它只是一个正常的函数，恰好有这个名字。在函数中，表达式会自动返回：

```
test :: String
test = "Hi" 
```

即使您的函数带有参数也是如此：

```
double x = 2 * x 
```

看来您对 Haskell 很陌生。您应该阅读一本好书，例如[“Learn You a Haskell”](http://learnyouahaskell.com/)来熟悉它，因为它与您曾经使用过的任何其他语言完全*不同*，因此您现有的经验不会很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:01:59.933

要定义一个常量值（在模块内），您只需要

```
test :: String
test = "Hi" 
```

但我猜你正在尝试做 IO。

*请*向**[您学习 Haskell for the Great Good！](http://learnyouahaskell.com/)**

# java - Java读取第n行

> ID：16201045
> 
> 赞同：5
> 
> 时间：2013-04-24T19:58:25.467
> 
> 标签：java, file-io

我正在尝试从文本文件中读取特定行，但是我不想将文件加载到内存中（它会变得非常大）。

我一直在寻找，但我发现的每个示例都需要读取每一行（这会减慢我的代码，因为有超过 100,000 行）或将整个内容加载到数组中并获取正确的元素（文件将有很多行输入）。

我想做的一个例子：

```
String line = File.getLine(5); 
```

“代码不是实际的代码，它是为了显示我想要的原理而编造的”

有没有办法做到这一点？

- - -编辑 - - -

我刚刚意识到这个文件也将被写入读取行之间（添加到文件末尾）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-24T20:00:15.067

> 有没有办法做到这一点？

除非每行都有固定数量的字节，否则不会。

您实际上不必*将*每一行都保存在内存中 - 但您必须通读整个文件才能找到您想要的行，否则您将不知道从哪里开始阅读。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:00:22.807

您*必须*逐行读取文件。否则，您怎么知道何时到达第 5 行（如您的示例中所示）？

编辑：

正如 Jon Skeet 所说，您可能还想查看[Random Access Files](http://docs.oracle.com/javase/tutorial/essential/io/rafs.html)，如果您知道每行有多少字节，这可能会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T20:08:41.667

最简单的方法是使用 BufferedReader ( [http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html) )，因为您可以指定缓冲区大小。您可以执行以下操作：

BufferedReader in = new BufferedReader(new FileReader("foo.in"), 1024);

```
in.readLine();
in.readLine();
in.readLine();
in.readLine();
String line = in.readLine(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-25T04:39:22.970

> 1）读取用户选择的一行，

如果您只需要一次或不经常读取用户选择的行（或者如果文件足够小），那么您只需从头开始逐行读取文件，直到到达所选行。

另一方面，如果您需要经常读取用户选择的行，则应建立行号和偏移量的索引。因此，例如，第 42 行对应于文件中 2347 字节的偏移量。理想情况下，您只需读取整个文件一次并存储索引——例如，在映射中，使用行号作为键，偏移量作为值。

> 2) 读取自上次读取后添加的新行。我计划每 10 秒读取一次文件。我有行数，可以找出新的行号，但我需要阅读该行

对于第二点，您可以简单地将当前偏移量保存到文件中，而不是保存当前行号——但如果它继续提供显着的性能优势，继续构建索引肯定不会有什么坏处。

1.  使用 RandomAccessFile.seek(long offset) 将文件指针设置为最近保存的偏移量（首先确认文件比最近保存的偏移量长——如果不是，则没有附加任何新内容）。
2.  使用 RandomAccessFile.readLine() 读取文件的一行
3.  在读取行后调用 RandomAccessFile.getFilePointer() 以获取当前偏移量，并可选择将(currLineNo+1, offset) 放入索引中。
4.  重复步骤 2-3，直到到达文件末尾。

但是，除非性能已经是一个问题或者很可能是一个问题，否则不要对性能优化太过分了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-10T10:09:44.420

对于小文件：

```
String line = Files.readAllLines(Paths.get("file.txt")).get(n); 
```

对于大文件：

```
String line;
try (Stream<String> lines = Files.lines(Paths.get("file.txt"))) {
    line = lines.skip(n).findFirst().get();
} 
```

爪哇 7：

```
String line;
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    for (int i = 0; i < n; i++)
        br.readLine();
    line = br.readLine();
} 
```

资料来源：[从文件中读取第 n 行](https://programming.guide/java/reading-nth-line-from-file.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T20:04:26.837

做到这一点的唯一方法是建立每行所在位置的索引（您只需要记录每行的结尾）如果无法从一开始就根据索引随机访问一行，则必须读取每个字节在那条线之前。

顺便说一句：在快速机器上读取 100,000 行可能只需要一秒钟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T20:19:34.657

如果性能在这里是一个大问题，并且您经常从静态文件中读取随机行，那么您可以通过读取文件并构建文件`long[]`每一行的起始偏移量的索引（基本上只是一个）来优化这一点。

一旦你有了这个，你就知道在文件中跳转到哪里，然后你可以读到下一个换行符来检索整行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-15T16:54:18.087

这是我拥有的一些代码片段，它将读取一个文件并将包括第一行在内的每 10 行写入一个新文件（编写器）。您始终可以将 try 部分替换为您想要执行的任何操作。要更改要读取的行数，只需将 if 语句 "lc.endsWith("0")" 中的 0 更改为您要读取的任何行。但是，如果在您读取文件时正在写入文件，则此代码仅适用于您运行此代码时文件中包含的数据。

```
 LineNumberReader  lnr = new LineNumberReader(new FileReader(new File(file)));
            lnr.skip(Long.MAX_VALUE);
            int linecount=lnr.getLineNumber();
            lnr.close();

        for (int i=0; i<=linecount; i++){

            //read lines
            String line = bufferedReader.readLine();
            String lc = String.valueOf(i);

            if (lc.endsWith("0")){

                try{

                    writer.append(line+"\n");
                    writer.flush();

                    }catch(Exception ee){
                }
            }
        } 
```

# opencv - OpenCV 245 first building errors

> ID：16201049
> 
> 赞同：6
> 
> 时间：2013-04-24T19:58:42.957
> 
> 标签：opencv

I downloaded the sources of opencv-2.4.5 and I followed the tutorial (on the opencv site for windows) about the installing my own libraries everything. Ok. I created the opencv.sln file with cmake then I opened it with visual studio 2010 professional and I click the build solution but just 9 succeeded. Most of the 200 failed and most of the errors about tbbd.lib not found and opencv_core245d.lib not found with LNK1104 error. I'm trying to solve it for how many days. I've tried to show the ways of files... Anyone can help please? This is about my dissertation. (Build with No Common Language Support)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-19T08:13:03.753

Collapse

I spent a good 15 hours or so to get the homework finished using OpenCV. 14.5 of those hours were spent just getting it setup properly. I ran through about 7 tutorial videos, several set up guides, and read hundreds of posts containing resolutions to the same erros I was getting.So I understand that simply installing OpenCV is not a trivial task and there are several steps to do this. So here is a straightforward tutorial for setting it up if you want to use openCV.

It is important to understand how things work as far as linking goes. There are three types of files, your headers that you include, the .dlls that contain the functions, and the libraries that contain instructions for how to call the functions in the .dlls. So here, rather than add just the .dlls as dependencies in the input linker, we are going to add the lib files. We will then create a System Environment variable that will tell the machine where to look for the .dll files when their corresponding library files are referenced. We will be creating a Property Sheet so that when we create a new project, we can simply add the settings to our project by clicking "Add Existing Property Sheet" instead of adding a new one. This way, we never have to go through this again.

FOLLOW THESE STEPS EXACTLY AND MAKE SURE VISUAL STUDIO IS CLOSED BEFORE CONTINUING

NOTE: When text is given in quotes with instructions to copy said text, do not include the quotes.

*   First of all, the easy part - download OpenCV 2.4.5 from their website. [http://opencv.org/](http://opencv.org/) and click OpenCV for Windows. It will download OpenCV 2.4.5.exe.

Install OpenCV

*   When the download finishes, double click OpenCV-2.4.5.exe to run it.

*   When asked where to extract the files, type ino the text box: "C:\"

*   C:\opencv should have been created upon completion. Navigate there to make sure.

Setup Environment Variables

*   WINDOWS 8 USERS:

    ```
     - Right click the bottom left corner of your screen when the start icon pops up.

     - Click "Command Prompt (Admin)"

     - Type "SETX -m OPENCV_DIR C:\opencv\build" and press enter to set the opencv build directory as a System Environment Variable. Wait for the console to give you confirmation that it is set.

     - Right click the bottom left corner of your screen when the "Start" icon pops up. Click  System -> Advanced System Settings -> Environment Variables

     - In the "System Variables" list box, under the "Variable" collumn, find "Path".

     - Highlight the "Path" row and click edit.

     - Click in the "Variable Value" text box and hit the "end" key on your keyboard to scroll to the end of the line and add a semicolon.

     - Type the following: "C:\opencv\build\x86\vc10\bin;C:\opencv\build\x86\vc10" and click "OK". This will add the openCV bin directory to the system path. 
    ```

*   WINDOWS 7 USERS:

    Follow the same steps. The only difference is how you get to the command prompt and the system settings. Google how to set up an environment variable on Windows 7 if needed.

Setup Visial Studio

NOTE: I highly recommend VS2012 Professional because of advanced syntax highlighting that makes life so much easier when programming C++. This version can be downloaded and installed for free from DreamSpark. Just make and account with your student ID. However, the steps for VS2010 and VS2012 are the same.

*   Open Visual Studio

    *   Click "New Project" and under "C++" select "Win32 Console Application".
*   When the window opens click "Next", check "Empty Project", and click "Finish". It is very important that you start with an EMPTY PROJECT without a precompiled header.

*   Locate the "Property Manager." By default, it should be a tab that is sometimes hard to miss. Alternatively it can be accessed by clicking from the toolbar "View" -> "Property Manager".

*   Right Click "Debug | Win32" and select "Add New Project Property Sheet". Name it "OpenCVProps" and click "Add".

*   Right Click your new property sheet and select "Properties".

*   From the left column, go to "C/C++" -> "General" and in the listbox on the right, select "Additional Include Directories" and click "Edit".

*   Add the following THREE directories:

    *   "$(OPENCV_DIR)\include"

    *   "$(OPENCV_DIR)\include\opencv"

    *   "$(OPENCV_DIR)\include\opencv2"

*   From the left column, go to "Linker" -> "General" and in the listbox on the right, select "Additional Library Directories" and click "Edit".

*   Add the following directory:

    *   "$(OPENCV_DIR)\x86\vc10\lib"
*   From the left column, go to "Linker" -> "Input" and in the listbox on the right, select "Additional Dependenies" and click "Edit".

*   Add the following .lib files to the depedencies. You may do this by copying and pasting these into that edit box. I have purposely not included a bulletpoint to make it easy for you to copy paste these.

    opencv_core245d.lib opencv_imgproc245d.lib opencv_highgui245d.lib opencv_ml245d.lib opencv_video245d.lib opencv_features2d245d.lib opencv_calib3d245d.lib opencv_objdetect245d.lib opencv_contrib245d.lib opencv_legacy245d.lib opencv_flann245d.lib

NOTE: If building for release, these steps are the same. However, when copying and pasting these files, remove the 'd' from the end of each of them. The 'd' denotes that it is a release library and links to a release .dll.

*   Congrats! The difficult part is almost done! Click "OK" to close the Window.

Creating and Building a Test Project

*   Head over to our Solution Explorer. This can be focused from the toolbar via "View" -> "Solution Explorer"

*   Right click "Source Files" and select "Add" -> "New Item".

*   Select "C++ File (.cpp)" and name the file "main.cpp". Click "Add".

*   Copy and paste the following program and press "F7" on your keyboard and watch the bottom left corner of your screen to see if you get a "Build Succeeded" message. If so, only one step left before you compile and run! If not, please retrace your steps, or comment below and maybe I can help.

```
    #include <opencv\cv.h>
    #include <opencv\highgui.h>

    int main(int argc, char* argv) 
    {  // openCV .image object
        cv::Mat inputImage;

        //Create a Window
        cv::namedWindow("window",1);

        // Initialize our image.
        inputImage = cv::imread("Lenna.png");

        // Always check to make sure that image has data.
        if(inputImage.empty())
        {
            std::cout << "Image Failed to Load.";
            return -1;
        }
        else
        {
            // All is well, display me.
            cv::imshow("window",inputImage);

            // Wait for user to press a key to exit.
            cvWaitKey(0);
        }

        return 0; 
    } 

```

*   If the build succeeded, then all that is left is to add the image to your folder. The placement is very important. I have copied the directoy that I have placed mine in. Follow the same directory pattern.

    *   "C:\Users\Josh\Documents\Visual Studio 2012\Projects\ConsoleApplication3\ConsoleApplication3\Lenna.png"
*   Now hit "Ctrl + F5" To build, compile, and run to observe your image in the window!!

****IF YOU HAVE A WEBCAM****

*   Copy and paste the following code to check if OpenCV is working without being required to add an image. This is useful because if the above code doesn't work, but this code does, then you know you put the image in the wrong folder.

```
    #include 
    #include 

    int main(int argc, char* argv) 
    {  // openCV .image object
        cv::Mat image;

        //Create a Window
        cv::namedWindow("window",1);

        // Create the capture object.
        cv::VideoCapture device;

        // Open your webcam.
        device.open(0);

        while (1)
        {
            // Read data from your device and store it to the image frame.
            device >> image;

            // Always check to make sure that image has data.
            if(image.empty())
            {
                std::cout<< "Image Failed to Load.";
                return -1;
            }
            else
            {
                // All is well, display me.
                cv::imshow("window",image);

                // Wait for user to press a key to exit.
                cvWaitKey(33);
            }
        }

        return 0; 
    } 

```

Happy Coding!! Let me know if something didn't work so I can fix it!

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-10T10:44:36.147

**Quick Answer**

I have managed to compile OpenCV with TBB support using the tutorial [here](http://docs.opencv.org/doc/tutorials/introduction/windows_install/windows_install.html).

Specs: Visual Studio 2012/ Win 7 (64 bit)/ OpenCV 2.4.5/ CUDA 5

I have downloaded the latest TBB zip and extracted it to *C:/src/OpenCV/dep* (as suggested in the tutorial linked above).

You have to use the following TBB settings in CMake (adapt depending on your file paths):

```
TBB_LIB_DIR       ::  C:/src/OpenCV/dep/tbb41_20130314oss/lib/intel64/vc11
TBB_INCLUDE_DIRS  ::  C:/src/OpenCV/dep/tbb41_20130314oss/include/
TBB_STDDEF_PATH   ::  C:/src/OpenCV/dep/tbb41_20130314oss/include/tbb/tbb_stddef.h
WITH_TBB          ::  checked
BUILD_TBB         ::  unchecked 
```

**More Information**

Initially, I also wanted to install OpenCV with CUDA 5 support, but it seems that CUDA 5 is incompatible with VS2012\. This is the error I got when compiling OpenCV:

```
Building NVCC (Device) object modules/core/CMakeFiles/cuda_compile.dir/src/cuda/Debug/cuda_compile_generated_matrix_operations.cu.obj
nvcc : fatal error : nvcc cannot find a supported cl version. Only MSVC 9.0 and MSVC 10.0 are supported 
```

The good news is that you are using VS2010, which can be used with CUDA, as suggested [here](http://answers.opencv.org/question/3601/243rc-visual-studio-2012-cuda-50/?answer=5207#post-id-5207). VS2012 can be set up to create projects with CUDA, but there is currently no way (AFAIK) to compile OpenCV with CUDA support for VS2012 (read [this](http://blog.norture.com/2012/10/gpu-parallel-programming-in-vs2012-with-nvidia-cuda) for more info).

In conclusion, people that need CUDA support should compile and use OpenCV with VS2010.

Also, when compiling OpenCV, I got the following errors:

```
error C3859: virtual memory range for PCH exceeded; please recompile with a command line option of '-Zm118' or greater
fatal error C1076: compiler limit : internal heap limit reached; use /Zm to specify a higher limit 
```

I used the instructions [here](https://stackoverflow.com/a/4595831/1792932) to finally compile OpenCV. I created a Property Sheet which had `/Zm130` as an additional option in *Common Properties > C/C++ > Command Line* and added it to all of the generated OpenCV projects.

For your reference, I also attach the CMake configuration and *CMakeCache.txt* file that I've used (CUDA is disabled as I am using VS2012):

*   CMake configuration: [http://pastebin.com/8rJZGZ3T](http://pastebin.com/8rJZGZ3T)
*   CMakeCache.txt: [http://pastebin.com/A0q8YgJg](http://pastebin.com/A0q8YgJg)

Hope this helps and please comment if you need me to elaborate on any step.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-21T10:33:08.563

I installed again opencv-master, opencv-2.4.5 and opencv-2.4.7 both to my new laptop. OpenCV-2.4.7's imread function returned always null but C-cvImageLoad worked well and opencv-master's cvLoadImage didn't work cvImageLoad or I missed something. But TBB's dir must be .../bin/ia32 not intel64 my OS is 64-bit but VS201x 32-bit this was my error. And I've get stitching and gpu errors and visual studio is telling about the error and this is usually memory allocation limit error and I did same things like your said @dilgenter and now it's working well but just 2.4.5 well and the python_d.lib error can be occur this is not a problem at debug mode I've read about this from a lot of forum sites. I'll try to find why 2.4.7's imread returning null Mat element. But now I'm too busy and this is

# matlab - 将符号数学 (sym) 的输出转换为浮点数

> ID：16201050
> 
> 赞同：1
> 
> 时间：2013-04-24T19:58:42.997
> 
> 标签：matlab, double, symbolic-math

我的问题与[这个问题](https://stackoverflow.com/questions/11114101/how-to-convert-mupad-symbol-i-sqrt-1-to-i-in-matlab/11114959#11114959)相似，但我认为它更笼统。
我使用 Matlab 的符号数学工具箱来求解一个方程：

```
MAZ = 0.5;
MAU = 1.0;
XI = 1.0;
ALPHA = 2.0;

DRG = 0.5;
SRG = 1.0;

PHI = 1 / (2 * MAU);

syms L;

f = 1 - DRG - sqrt(1 + (ALPHA * XI - L / (2 * XI * PHI) ) ^ 2 ) / ...
    sqrt(1 + (ALPHA * XI) ^ 2) + L / (4 * PHI * SRG * sqrt(1 + (ALPHA * XI)^2));

a = solve(f,L,'Real',true); 
```

答案是：

```
a =
5^(1/2)/3 + (10*((4*5^(1/2))/25 + 6/25)^(1/2))/3 + 8/3
5^(1/2)/3 - (10*((4*5^(1/2))/25 + 6/25)^(1/2))/3 + 8/3 
```

如何自动将这些`a`不包含任何符号表达式的表达式转换为浮点数，以便稍后在我的代码中访问它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T19:58:42.997

Matlab 的符号数学工具箱包含一个名为[`double`](http://www.mathworks.com/help/symbolic/double.html).
此函数将函数的结果`solve`- 即 a `sym`- 转换为双精度数：

```
double(a)

ans =

      5.98921078320145
     0.834834535131742 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-03T16:50:36.260

虽然`double`是正确的，但它仅限于 64 位浮点的精度。`vpa`如果需要更高的精度，请使用：

```
>> vpa(a)

ans =

  5.9892107832014511063435699584181
 0.83483453513174202459587915406938

>> digits(99)

>> vpa(a)

ans =

  5.98921078320145110634356995841813862213621375395128614574627036653958858547362556353272837962692249
 0.834834535131742024595879154069378868157531819123064337100994463734092031618244369410214559292265698 
```

# gcc - gcc 预处理器：如何在参数中转义引号

> ID：16201054
> 
> 赞同：1
> 
> 时间：2013-04-24T19:58:54.080
> 
> 标签：gcc, c-preprocessor

我正在尝试使用 gcc 预处理器来实现其宏扩展功能（我不是在尝试生成代码）。

我有一个宏——MY_MACRO——需要获取一个内部有双引号的参数如您所见，预处理器产生一个错误：未终止的参数列表

有没有办法逃避引号？

```
#define MY_MACRO(X)
MY_MACRO(prefix"suffix) 
```

例如：

```
$ gcc -E -P -w a.txt
error: unterminated argument list invoking macro "MY_MACRO"
$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:23:32.913

C 预处理器处理 C 源代码。一个单独`"`的不是有效的 C，所以 cpp 拒绝它。只有当您愿意遵守 C 语法规则时，您才能将 cpp 用于其他目的。

`m4`是一个通用的宏处理器和标准安装在任何类 Unix 上，尽管没有人喜欢它。没有多少选择。

# java - Android有没有办法只旋转一个组件，同一布局中的其他组件不会旋转

> ID：16201058
> 
> 赞同：1
> 
> 时间：2013-04-24T19:59:23.033
> 
> 标签：java, android

我希望`webview`设备旋转时垂直到水平的内容，而不是其他组件。我的意思是 webview 下方的按钮不应该旋转，

所以我试图将`webview`垂直的内容旋转到水平，反之亦然，但不能这样做。

有没有办法只旋转一个组件，同一布局中的其他组件不会旋转

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:10:29.337

假设您想使用系统为您执行此操作，答案是“不”。

# function - 将 FromArgb() 作为参数传递给函数

> ID：16201059
> 
> 赞同：1
> 
> 时间：2013-04-24T19:59:23.740
> 
> 标签：function, powershell, system.drawing.color

我有以下功能：

```
Function Color-Cells {
    Param (
        [Parameter(
            Mandatory = $true,
            Valuefrompipeline = $true)]
        [String]$Range,
        [Parameter(
            Mandatory = $true)]
        [System.Drawing.Color]$Color
    )
    $Global:WorkSheet.range($Range).Interior.color = $Color
}#End Function 
```

我可以这样称呼：

```
Color-Cells -Range "A1" -Color LightBlue 
```

没有任何问题。

我希望能够像这样调用函数：

```
Color-Cells -Range "A1" -Color FromArgb(217,217,217) 
```

为了更精细地选择单元格的颜色，但是当我这样做时，出现以下错误：

```
Color-Cells : Cannot process argument transformation on parameter 'Color'. Cannot convert value 
"FromArgb(217,190,238)" to type "System.Drawing.Color". Error: "FromArgb(217 is not a valid value for Int32."
At line:70 char:32
+ Color-Cells -Range "A1" -Color "FromArgb(217,217,217)"
+                                ~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Color-Cells], ParameterBindingArgumentTransformationException
    + FullyQualifiedErrorId : ParameterArgumentTransformationError,Color-Cells 
```

我试过这样调用函数：

1.  `"FromArgb(217,217,217)"`
2.  `'FromArgb(217,217,217)'`
3.  ``"FromArgb(217,217,217)`"`

它们都会产生错误。我对.Net不是很熟悉，所以我不确定如何解决这个问题。`[System.drawing.color]`我的最终目标是创建一个函数，该函数可以根据已知名称或 RGB 值对一系列单元格进行着色。

为清楚起见进行编辑：

TypeName 特定于函数中的参数类型。当我调用函数`Color-cells`时，`-Color`参数是 type `[System.Drawing.Color]`。当我使用静态属性（`Color-Cells -Color LightBlue`例如）调用该函数时，它只是查找。但是，当我尝试调用一个方法（`Color-Cells -Color FromArgb(217,217,217)`例如）时，就会收到错误消息。有没有办法只将方法传递给函数？

根据迈克的回答，我可以成功地完全调用这样的函数：

```
Color-Cell -Range "A1" -Color $([System.Drawing.Color]::FromArgb(217,190,238)) 
```

但是，我想调用函数（使用方法）而不`$()`在命令周围添加命令，也没有`[System.Drawing.Color]::`像我可以只使用属性（例如 LightBlue）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:15:43.387

要调用静态方法，请使用`[TYPENAME]::MethodName(args)`.

所以做你想要的，使用这个：

```
[System.Drawing.Color]::FromArgb(217,217,217) 
```

# javascript - 如何将值附加到存储在元素中的自定义数据

> ID：16201061
> 
> 赞同：1
> 
> 时间：2013-04-24T19:59:26.133
> 
> 标签：javascript, jquery, attributes

假设我想在一个元素中存储一些自定义值，我需要：

```
$('div').data('k','v'); 
```

但现在我需要向该元素添加更多数据：`v2`.

我能想出的唯一方法是以某种方式存储或引用以前的数据，并附加到它，但它看起来不是最好的方法，也不是最有效的：

```
$('div').data('k','v');
var prevData = $('div').data('k');
$('div').data('k',prevData + ',v2');
alert($('div').data('k')); 
```

这将发出警报`v,v2`，但这是正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:02:05.637

您可以使用列表作为`data`属性：

```
$('.selector').data('test', []);
var list = $('.selector').data('test');
list.push('foo') 
```

`data-`它非常有用，还因为您可以在页面生成时用 HTML 中的 JSON填充属性，并`.data()`自动将它们转换为普通的 JS 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:05:58.140

如果你使用数组作为`data`属性，你可以这样做

```
$('.selector').data('list', []);
$('.selector').data('list').push(1);
$('.selector').data('list').push(2);
$('.selector').data('list'); // Will return [1,2] 
```

# directx - GPU 纹理飞溅

> ID：16201064
> 
> 赞同：0
> 
> 时间：2013-04-24T19:59:41.867
> 
> 标签：directx, shader, textures, hlsl, alphablending

# 举个简单的例子，我正在尝试执行以下操作：

* * *

![污垢](https://i.stack.imgur.com/ZIyNE.png)+ ![草](https://i.imgur.com/2PWKNbp.png)+ ![Α](https://i.imgur.com/ygbKah7.png)=![混合](https://i.imgur.com/t6aOMf8.png)

* * *

使用第三张图像作为 Alpha 贴图，如何在兼容 DX9 的像素着色器中实现前两张图像之间的“混合”，从而创建类似于第四张图像的效果？
此外，如何将这个新创建的纹理返回给 CPU，然后将其放回原始纹理数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:10:46.130

粗略的方法是将纹理的颜色与 alphamap 混合并从像素着色器返回：

```
float alpha = tex2D(AlphaSampler,TexCoord).r;
float3 texture1 = tex2D(Texture1Sampler,TexCoord).rgb;
float3 texture2 = tex2D(Texture2Sampler,TexCoord).rgb;
float3 color = lerp(texture1,texture2,alpha);
return float4(color.rgb,1); 
```

因此，您需要一个纹理作为 rendertarget ( [doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174455%28v=vs.85%29.aspx) )，其大小与 inputtextures 相同，并且需要一个全屏四边形作为渲染几何图形，xyzrhw 四边形将是最简单的。您可以进一步使用此纹理进行渲染。如果您想读取纹素或其他内容，您必须锁定结果，您可以使用`StretchRect`( [doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174471%28v=vs.85%29.aspx) ) 或`UpdateSurface`( [doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205857%28v=vs.85%29.aspx) ) 将数据复制到普通纹理中。

如果性能不重要（例如你预处理纹理），你可以更容易地在 cpu 上计算它（但它更慢）。锁定 4 个纹理，遍历像素并直接合并它们。

# naming - 提出如何命名一个“get/create & get”函数

> ID：16201065
> 
> 赞同：11
> 
> 时间：2013-04-24T19:59:47.370
> 
> 标签：naming

我正在研究一个按值（例如按名称）从容器（例如数组）返回对象的函数。如果对象不存在，则创建并返回对象的默认副本（默认构造函数）。

这样，该函数总是返回一个对象，无论该对象在调用该函数之前是否存在。

现在我的问题是：如何命名这个函数？***GetOrCreateThenGet***听起来很愚蠢。有任何想法吗？

**编辑：**我觉得这样的东西更接近函数的本质：***GetForSure*** ...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-01-04T20:45:03.780

最适合该功能的名称是“提供”，例如，如果您提供商品，您可以从仓库发货或制作/购买新商品然后交付。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T22:13:42.370

为什么你需要除`getXXX()`. 任何具有`and`/`or`意味着它正在做很多事情并且正在混合关注点并严重破坏`Single Responsibility Principle`.

如果调用者只需要从合约中获取对象，那么调用者是否应该真正关心对象是否是按需创建的？

`getOrCreate`意味着您将得到它但不会返回`get`的对象。`or``created`

再说一遍，我为什么要关心这个`create`部分？

如果我真的应该关心它，那将`getOrCreateAndGet`是语义上正确的，但高度非正统，并且容易与同行讨论处理许多事情的方法，混合关注点并打破`Single Responsiblity Principle`? 仅仅因为其他人将事情命名为古怪和无意义的事情也不是做错事的好借口。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T20:31:56.797

***GetGuaranteed*** seems to cover all the caller needs to know...

# ajax - 来自 JSON 文件的谷歌地图

> ID：16201066
> 
> 赞同：0
> 
> 时间：2013-04-24T19:59:47.223
> 
> 标签：ajax, json, jquery, google-maps-api-3, heatmap

我正在尝试使用谷歌地图 API 和 heatmaps.js 创建一个有 2 层的热图。我可以通过硬编码我的纬度/经度变量来创建我的地图，但最终我希望我的图层从可以轻松刷新的 JSON 文件中提供。

这是我当前的 HTML，效果很好。

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href='css/bootstrap.css' rel='stylesheet' type='text/css'></link>
    <link href='css/bootstrap-responsive.css' rel='stylesheet' type='text/css'></link>

    <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.3.js'></script>
    <script type='text/javascript' src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=visualization&.js"></script>

    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>

    <script>
      var map, pointarray, heatmap;

      var layer1 = [
        {location: new google.maps.LatLng(42.071523,-72.624257), weight:13.747727085},
        {location: new google.maps.LatLng(42.37686,-72.46914), weight:6.6332495807},
        {location: new google.maps.LatLng(42.40524,-72.528427), weight:5.1961524227},
        {location: new google.maps.LatLng(42.383945,-72.511834), weight:1.7320508076},
        {location: new google.maps.LatLng(42.433317,-72.114488), weight:5.6568542495}
      ];

      var layer2 = [
        {location: new google.maps.LatLng(41.513113,-74.37616), weight:2.4494897428},
        {location: new google.maps.LatLng(41.147711,-73.941171), weight:10},
        {location: new google.maps.LatLng(41.329376,-74.347207), weight:4.8989794856},
        {location: new google.maps.LatLng(41.338977,-73.987248), weight:1.7320508076}
      ];

      function initialize() {
        var mapOptions = {
          zoom: 4,
          center: new google.maps.LatLng(38.82, -99.408660),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);

        pointArray1 = new google.maps.MVCArray(layer1);
        pointArray2 = new google.maps.MVCArray(layer2);

        heatmap1 = new google.maps.visualization.HeatmapLayer({
          data: pointArray1
        });
        heatmap2 = new google.maps.visualization.HeatmapLayer({
          data: pointArray2
        });

        heatmap1.setMap(map);
        heatmap2.setMap(map);
      }

    //FUNCTION TO CHANGE LAYERS
    function changeMap(layerNum) {

    if (layerNum == 1) {
    updateMap(heatmap1);
    }
    if (layerNum == 2) {
    updateMap(heatmap2);
    }
    }

    //FUNCTION TO UPDATE LAYERS
    function updateMap(layer) {
       var layerMap = layer.getMap();
       if (layerMap) {
          layer.setMap(null);
       } else {
          layer.setMap(map);
       }
    } 
    </script>

    <link href='css/DT_bootstrap.css' rel='stylesheet' type='text/css'></link>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

 </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">Test Page</a>
          <div class="nav-collapse collapse">
            <p class="navbar-text pull-right">
              Logged in as <a href="#" class="navbar-link">...</a>
            </p>
            <ul class="nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="#about">About</a></li>
              <li><a href="#contact">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

<body class="container-fluid">
    <div class="row">
        <div class="span12" style="float: none; margin: 0 auto;">
          <body onload="initialize()">
          <h3>Test Layers</h3>
            <input type='checkbox' name='system_type17' value='1' onclick="changeMap(this.value);" checked="checked" />
            <span style="width:100px;display:inline-block;">Layer 1</span>
            <input type="checkbox" name="system_type3" value="2" onclick="changeMap(this.value);" checked="checked" />
            <span style="width:100px;display:inline-block;">Layer 2</span>
            <br><br/>
            <div id="map-canvas" style="height: 575px; width: 1000px;"></div>
          </body>
        </div>
    </div>
</body>

  </body>
</html> 
```

我想做的是用我可以查询的单个 JSON 文件替换 var layer1 和 layer2，我只是不确定如何执行这样的事情。例如，一个看起来像这样的 JSON 文件：

```
{
    "datapoints": [
        {
            "lat": "38.1513366000",
            "lon": "-97.4341659000",
            "weight": "0",
            "layer":"1"
        },
        {
            "lat": "38.1513748000",
            "lon": "-97.4341125000",
            "weight": "0",
            "layer":"1"
        },
        {
            "lat": "38.1513938000",
            "lon": "-97.4341125000",
            "weight": "0",
            "layer":"1"
        },
        {
            "lat": "38.1493263000",
            "lon": "-97.4339447000",
            "weight": "0",
            "layer":"1"
        },
        {
            "lat": "38.1493339000",
            "lon": "-97.4339447000",
            "weight": "0",
        "layer":"2"
        },
        {
            "lat": "38.1493377000",
            "lon": "-97.4339447000",
            "weight": "0",
            "layer":"2"
        },
        {
            "lat": "38.1483650000",
            "lon": "-97.4358291000",
            "weight": "0",
            "layer":"2"
        },
        {
            "lat": "38.1484031000",
            "lon": "-97.4358062000",
            "weight": "0",
            "layer":"2"
        }
    ]
} 
```

根据 Yehia 的建议更新代码：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href='css/bootstrap.css' rel='stylesheet' type='text/css'></link>
    <link href='css/bootstrap-responsive.css' rel='stylesheet' type='text/css'></link>

    <script type='text/javascript' src='js/jquery-1.8.3.js'></script>
    <script type='text/javascript' src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=visualization&.js"></script>

    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>

    <script>
      var map, pointarray, heatmap;

      /*var layer1 = [
        {location: new google.maps.LatLng(42.071523,-72.624257), weight:13.747727085},
        {location: new google.maps.LatLng(42.37686,-72.46914), weight:6.6332495807},
        {location: new google.maps.LatLng(42.40524,-72.528427), weight:5.1961524227},
        {location: new google.maps.LatLng(42.383945,-72.511834), weight:1.7320508076},
        {location: new google.maps.LatLng(42.433317,-72.114488), weight:5.6568542495}
      ];

      var layer2 = [
        {location: new google.maps.LatLng(41.513113,-74.37616), weight:2.4494897428},
        {location: new google.maps.LatLng(41.147711,-73.941171), weight:10},
        {location: new google.maps.LatLng(41.329376,-74.347207), weight:4.8989794856},
        {location: new google.maps.LatLng(41.338977,-73.987248), weight:1.7320508076}
      ];*/

      function initialize() {
        var mapOptions = {
          zoom: 4,
          center: new google.maps.LatLng(38.82, -99.408660),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
      }

    //FUNCTION TO CHANGE LAYERS
    function changeMap(layerNum) {

    if (layerNum == 1) {
    updateMap(heatmap1);
    }
    if (layerNum == 2) {
    updateMap(heatmap2);
    }
    }

    //FUNCTION TO UPDATE LAYERS
    function updateMap(layer) {
       var layerMap = layer.getMap();
       if (layerMap) {
          layer.setMap(null);
       } else {
          layer.setMap(map);
       }
    } 
    </script>

    <link href='css/DT_bootstrap.css' rel='stylesheet' type='text/css'></link>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

 </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">Test Page</a>
          <div class="nav-collapse collapse">
            <p class="navbar-text pull-right">
              Logged in as <a href="#" class="navbar-link">...</a>
            </p>
            <ul class="nav">
              <li class="active"><a href="index.html">Home</a></li>
              <li><a href="#about">About</a></li>
              <li><a href="#contact">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

<body class="container-fluid">
    <div class="row">
        <div class="span12" style="float: none; margin: 0 auto;">
          <body onload="initialize()">
          <h3>Test Layers</h3>
            <input type='checkbox' name='system_type17' value='1' onclick="changeMap(this.value);" checked="checked" />
            <span style="width:100px;display:inline-block;">Layer 1</span>
            <input type="checkbox" name="system_type3" value="2" onclick="changeMap(this.value);" checked="checked" />
            <span style="width:100px;display:inline-block;">Layer 2</span>
            <br><br/>
            <div id="map-canvas" style="height: 575px; width: 1000px;"></div>
          </body>
        </div>
    </div>
      <script type="text/javascript">
        $.getJSON("testdata.json").then(function(data) {
              $.each(data, function(i,datapoints) {
                $.each(datapoints, function(j,datapoint) {
                  layers.push({
                    location: new google.maps.LatLng(datapoint.lat, datapoint.lng),
                    weight: datapoint.weight,
                    layerID: datapoint.layer
                  });
                });
              });
            });
    <script>
</body>

  </body>
</html> 
```

好吧，我想差不多了。非常感谢您到目前为止的帮助，我知道这很痛苦。这是我的初始化函数，我仍然收到 Uncaught ReferenceError: layers is not defined

```
<script type='text/javascript'>
      var map, pointarray, heatmap;

      function initialize() {

            function loadData() {
            var layers = [ ];
            $.ajax({
              url: 'testdata.json',
              async: false,
              dataType: 'json',
              success: function (data) {
                for (var i=0; i<data.datapoints.length; i++) {
                  var datapoint = data.datapoints[i];
                  if (layers[datapoint.layer]===undefined) {
                    layers[datapoint.layer] = [];
                  }
                  layers[datapoint.layer].push({
                    location: new google.maps.LatLng(datapoint.lat, datapoint.lon),
                    weight: datapoint.weight,
                    layerID: datapoint.layer
                  });
                }
              }
            });
            return layers;
          }
        var mapOptions = {
          zoom: 4,
          center: new google.maps.LatLng(38.82, -99.408660),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);

        pointArray1 = new google.maps.MVCArray(layers[1]);
        pointArray2 = new google.maps.MVCArray(layers[2]);

        heatmap1 = new google.maps.visualization.HeatmapLayer({
          data: pointArray1
        });
        heatmap2 = new google.maps.visualization.HeatmapLayer({
          data: pointArray2
        });

        heatmap1.setMap(map);
        heatmap2.setMap(map);
      }

    //FUNCTION TO CHANGE LAYERS
    function changeMap(layerNum) {

    if (layerNum == 1) {
    updateMap(heatmap1);
    }
    if (layerNum == 2) {
    updateMap(heatmap2);
    }
    }

    //FUNCTION TO UPDATE LAYERS
    function updateMap(layer) {
       var layerMap = layer.getMap();
       if (layerMap) {
          layer.setMap(null);
       } else {
          layer.setMap(map);
       }
    } 
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:26:24.583

您需要一种读取 JSON 并将其解析为所需变量的方法。由于您使用的是 jQuery，因此这里有一个适用于您拥有的 JSON 结构的方法。

```
$.getJSON("layers.json").then(function(data) {
      $.each(data, function(i,datapoints) {
        $.each(datapoints, function(j,datapoint) {
          layers.push({
            location: new google.maps.LatLng(datapoint.lat, datapoint.lng),
            weight: datapoint.weight,
            layerID: datapoint.layer
          });
        });
      });
    }); 
```

根据需要进行调整。

为了响应 davids12 的更新，这里有一个函数，它返回一个数组数组，其中每个复合数组都有来自某个层的数据点。因此，运行您的示例，`layers`其中将有 2 个数组（`layers[1]`和） ，`layers[2]`它们基本上是您在代码中描述的（带有一个附加变量；如果您愿意，可以将其删除）。这允许您通过使用您现在拥有的格式将它们放入 JSON 中来加载更多的层和点。`layer1``layer2``layerID`

```
 function loadData() {
    var layers = [ ];
    $.ajax({
      url: 'j.json',
      async: false,
      dataType: 'json',
      success: function (data) {
        for (var i=0; i<data.datapoints.length; i++) {
          var datapoint = data.datapoints[i];
          if (layers[datapoint.layer]===undefined) {
            layers[datapoint.layer] = [];
          }
          layers[datapoint.layer].push({
            location: new google.maps.LatLng(datapoint.lat, datapoint.lng),
            weight: datapoint.weight,
            layerID: datapoint.layer
          });
        }
      }
    });
    return layers;
  } 
```

# android - 使用字符串值设置日历订单日期

> ID：16201067
> 
> 赞同：0
> 
> 时间：2013-04-24T19:59:50.453
> 
> 标签：android, calendar

我已经卡了2天，终于放弃了。我需要你在日历功能方面的帮助。该人选择产品（在按钮上）并设置消息并允许他们在可以重新订购时添加提醒。现在我让它打开日历，但无法让日历根据该产品设置日期。我不确定如何设置字符串值、调用它并设置日历日期。我知道这是基本的东西，但我感谢您的帮助！对不起，冗长的代码。我想确保我包含了所有相关的内容。

这是我的代码：

```
Button reorder1 = (Button) findViewById(R.id.rotramadol);
Button reorder2 = (Button) findViewById(R.id.roaciphex);
Button reorder3 = (Button) findViewById(R.id.roflexeril);
reorder1.setOnClickListener(this);
reorder2.setOnClickListener(this);
reorder3.setOnClickListener(this);

@Override
public void onClick(View v) {
    if (v.getId() == R.id.rotramadol) {
//this one needs the calendar set 10 days from now
        AlertDialog ad = new AlertDialog.Builder(this)
                .setMessage(
                        "Order Quantity 90 tabs requires 10 days")
                .setTitle("Tramadol")
                .setPositiveButton("Set Reminder", this)
                .setNegativeButton("OK", this).setCancelable(false)
                .create();
        ad.show();
    } else if (v.getId() == R.id.roaciphex) {
//this one needs the calendar set 25 days from now
        AlertDialog ad1 = new AlertDialog.Builder(this)
                .setMessage("Order Quantity 30 tabs requires 25 days")
                .setTitle("Aciphex")
                .setPositiveButton("Set Reminder", this)
                .setNegativeButton("OK", this).setCancelable(false)
                .create();
        ad1.show();
    } else if (v.getId() == R.id.roflexeril) {
//this one needs the calendar set 7 days from now
        AlertDialog ad2 = new AlertDialog.Builder(this)
                .setMessage("Order Quantity 30 tabs requires 7 days")
                .setTitle("Flexeril")
                .setPositiveButton("Set Reminder", this)
                .setNegativeButton("OK", this).setCancelable(false)
                .create();
        ad2.show();

@Override
public void onClick(DialogInterface dialog, int which) {
    // TODO Auto-generated method stub

    switch (which) {
    case DialogInterface.BUTTON_POSITIVE: // yes

        Intent intent = new Intent(Intent.ACTION_INSERT);
        intent.setType("vnd.android.cursor.item/event");
        intent.putExtra(Events.TITLE, "Reorder");
        intent.putExtra(Events.EVENT_LOCATION, "");
        intent.putExtra(Events.DESCRIPTION,
                "https://www.place they reorder.com");

        GregorianCalendar calDate = new GregorianCalendar();
        intent.putExtra(CalendarContract.EXTRA_EVENT_BEGIN_TIME,
                calDate.getTimeInMillis());
        intent.putExtra(CalendarContract.EXTRA_EVENT_END_TIME,
                calDate.getTimeInMillis());

        intent.putExtra(CalendarContract.EXTRA_EVENT_ALL_DAY, true);

        intent.putExtra(Events.RRULE, "FREQ=DAILY;COUNT=1;");

        intent.putExtra(Events.ACCESS_LEVEL, Events.ACCESS_PRIVATE);
        intent.putExtra(Events.AVAILABILITY, Events.AVAILABILITY_BUSY);

        startActivity(intent);

        break;

    case DialogInterface.BUTTON_NEGATIVE: // no

        dialog.cancel();

        break;
    default:
        break;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:14:36.523

我假设您正在尝试根据用户选择设置日历事件，请尝试以下代码

```
 Calendar calendar = Calendar.getInstance();
                    calendar.add(Calendar.DATE, 5/*how many days from today*/); 
                    Intent intent = new Intent(Intent.ACTION_EDIT);
                    intent.setType("vnd.android.cursor.item/event");
                    intent.putExtra(Events.TITLE, "your title");
                    intent.putExtra("beginTime", calendar.getTime());
                    intent.putExtra("endTime", calendar.getTime() + DateUtils.MINUTE_IN_MILLIS * 30);
                    intent.putExtra(Events.EVENT_TIMEZONE, calendar.getTimeZone());
                    startActivity(intent); 
```

# python - Python 模块和包加载混淆

> ID：16201068
> 
> 赞同：3
> 
> 时间：2013-04-24T19:59:50.943
> 
> 标签：python, python-3.x, python-module

假设我有这样的事情：

```
.
├── 运行.py
└── 测试
    ├── __init__.py
    ├── 型号
    │ ├── foo
    │ │ ├── baby.py
    │ │ └── __init__.py
    │ ├── __init__.py
    │ └── user.py
    └── start.py

```

运行.py

```
from test import start 
```

开始.py

```
from .models import user 
```

用户.py

```
from . import foo

print(foo.baby.Baby) 
```

宝贝.py

```
Baby = "I am a baby" 
```

现在，当您运行`run.py`文件时...

```
>>> python run.py
... traceback ...
AttributeError: 'module' object has no attribute 'baby' 
```

但是，如果你改变`start.py`这样的：

```
from .models.foo import baby
from .models import user 
```

一切正常。

当`baby`模块中的模块`start.py`没有提前加载时，`foo`包对象没有对它的引用（`foo.baby.Baby`throw an `AttributeError`）。但是当我在中加载`baby`模块时`start.py`，`foo`包对象自动获得了对`baby`模块的引用。

有人可以解释一下这是如何工作的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T20:02:16.653

在导入之前，子模块不会自动成为包的属性。

您需要先导入`test.models.foo.baby` *才能*工作`foo.baby.Baby`。您可以在`foo/__init__.py`文件中执行此操作：

```
from . import baby 
```

# java - JRuby：从机架应用程序调用 Java 代码并将其保存在内存中

> ID：16201075
> 
> 赞同：3
> 
> 时间：2013-04-24T20:00:12.163
> 
> 标签：java, sinatra, jruby, rack

我目前了解 Java 和 Ruby，但从未使用过 JRuby。我想在 Rack (sinatra) Web 应用程序中使用一些 RAM 和计算密集型 Java 代码。特别是，这段 Java 代码将大约 200MB 的数据加载到 RAM 中，并提供了使用这些内存数据进行各种计算的方法。

我知道可以在 JRuby 中从 Ruby 调用 Java 代码，但在我的情况下还有一个额外的要求：这个 Java 代码需要加载一次，保存在内存中，并作为 sinatra 代码的共享资源（这是由多个网络请求触发的）来调用。

### 问题

1.  这样的设置甚至可能吗？
2.  我需要做什么来完成它？我什至不确定这本身是一个 JRuby 问题，还是需要在 Web 服务器中配置的东西。我有使用Passenger 和Unicorn/nginx 的经验，但没有使用Java 服务器的经验，所以如果这确实涉及配置Java 服务器（如Tomcat），任何有关这方面的信息都会有所帮助。

我真的不知道从哪里开始寻找，或者是否有更好的方法来解决这个问题，所以任何和所有建议或相关链接都表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T14:14:28.323

[以下](http://www.jefflembeck.com/jruby-plus-sinatra-all-warred-up)是有关如何将 sinatra 应用程序部署到[Tomcat](http://tomcat.apache.org/)的一些说明。

如果您保留对已加载的 java 实例的引用，则可以加载一次并重复使用 java 代码。您可以在 ruby​​ 中保留来自全局变量的引用。

需要注意的一件事是，您使用的 java 库可能不是线程安全的。如果您在 tomact 中运行您的 ruby​​ 代码，则可以同时执行多个请求，并且这些请求可能都访问您的共享 java 库。如果您的库不是线程安全的，则必须使用某种[同步](http://www.javamex.com/tutorials/synchronization_concurrency_synchronized1.shtml)来防止多个线程访问它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-29T11:36:05.433

是的，它是可能的设置（见下文关于部署），为了完成它，我建议使用[单例](http://en.wikipedia.org/wiki/Singleton_pattern)

### Jruby 中的单例

参考问题：[在机架安装的应用程序/中间件堆栈之间共享对象的最佳/最优雅的方式？](https://stackoverflow.com/questions/5517753/best-most-elegant-way-to-share-objects-between-a-stack-of-rack-mounted-apps-midd)我同意[Colin Surprenant](https://stackoverflow.com/users/460868/colin-surprenant)的回答，即我更喜欢使用单例 mixin 的单例模块模式

### 例子

我在这里发布了一些测试代码，您可以将其用作概念证明：

JRuby sinatra 方面：

```
#file: sample_app.rb

require 'sinatra/base' 
require 'java' #https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby
java_import org.rondadev.samples.StatefulCalculator #import you java class here

# singleton-as-module loaded once, kept in memory
module App
  module Global extend self    
    def calc
      @calc ||= StatefulCalculator.new 
    end
  end
end
# you could call a method to load data in the statefull java object
App::Global.calc.turn_on  

class Sample < Sinatra::Base
  get '/' do
     "Welcome, calculator register:#{App::Global.calc.display}"
  end

  get '/add_one' do
    "added one to calculator register, new value:#{App::Global.calc.add(1)}"
  end
end 
```

您可以在 tomcat 中使用`trinidad`或简单地启动它，`rackup config.ru`但您需要：

```
#file: config.ru
root = File.dirname(__FILE__)            # => "."
require File.join( root, 'sample_app' )  # => true
run Sample  # ..in sample_app.rb ..class Sample < Sinatra::Base 
```

关于 Java 端的一些事情：

```
package org.rondadev.samples;

public class StatefulCalculator {

        private StatelessCalculator calculator;

        double register = 0;

        public double add(double a) {       
            register = calculator.add(register, a); 
            return register;
        }

        public double display() {       
            return register;
        }

        public void clean() {
            register = 0;       
        }

        public void turnOff() {
            calculator = null;
            System.out.println("[StatefulCalculator] Good bye ! ");
        }

        public void turnOn() {
            calculator = new StatelessCalculator();
            System.out.println("[StatefulCalculator] Welcome !");
        }   
} 
```

请注意，`register`这里只是一个`double`，但在您的真实代码中，您可以在真实场景中拥有大数据结构

### 部署

您可以使用 Mongrel、Thin（实验性）、Webrick（但谁会这样做？）甚至以 Java 为中心的应用程序容器（如 Glassfish、Tomcat 或 JBoss）进行部署。[来源：jruby 部署](http://recipes.sinatrarb.com/p/deployment/jruby)

使用构建在 JBoss 应用服务器上的 TorqueBox。JBoss AS 包括高性能集群、缓存和消息传递功能。

[trinidad](https://github.com/trinidad/trinidad)是一个 RubyGem，它允许您在嵌入式 Apache Tomcat 容器中运行任何基于 Rack 的小程序包装

### 线程同步

Sinatra 将使用 Mutex#synchronize 方法在每个请求上放置一个锁，以避免线程之间的竞争条件。如果您的 sinatra 应用程序是多线程的并且不是线程安全的，或者您使用的任何 gem 都不是线程安全的，您会想要执行 set `:lock`，`true`以便在给定时间只处理一个请求。.. 否则默认`lock`为`false`，这意味着`synchronize`将直接屈服于块。

来源：[https ://github.com/zhengjia/sinatra-explained/blob/master/app/tutorial_2/tutorial_2.md](https://github.com/zhengjia/sinatra-explained/blob/master/app/tutorial_2/tutorial_2.md)

# c# - 如何为devexpress gridview设置css格式

> ID：16201079
> 
> 赞同：0
> 
> 时间：2013-04-24T20:00:18.677
> 
> 标签：c#, asp.net, gridview, devexpress

我正在尝试学习 devexpress gridview。我设置了所有东西并且工作正常，但是有一个样式问题。

在过去，当你从 Visual Studio 的工具栏中拖放一个 gridview 时，它看起来很完美，但 devexpress 的 gridview 看起来并不好。这有什么问题。

这是图像...

![在此处输入图像描述](https://i.stack.imgur.com/UK4LG.png)

似乎网格位于 div 块中，并且在右侧和顶部有一个边距。我正在使用 devexpress 的试用版。你认为这是因为审判还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T07:52:39.147

DevExpress controls allow for a lot of customization. You can do that via the "Run Designer" button, or via events like "CustomDrawColumnHeader", "CustomDrawCell" etc. You can also contact them, they have a great Support Team. I've been using them for a while and the results I'm getting are way better of the standard Visual Studio controls.

# email - GitLab 电子邮件通知未发送

> ID：16201090
> 
> 赞同：14
> 
> 时间：2013-04-24T20:01:06.837
> 
> 标签：email, ubuntu-12.04, sidekiq, gitlab

我最近刚刚在 Ubuntu 12.04 服务器上安装了 GitLab v5.0，现在遇到了电子邮件通知问题。我无法让 GitLab 发送任何类型的电子邮件。

我已将`config/environments/production.rb`文件设置为使用 sendmail 作为传输服务：

```
config.action_mailer.delivery_method = :sendmail
config.action_mailer.perform_deliveries = true
config.action_mailer.raise_delivery_errors = true 
```

我可以从 shell 成功地手动使用 sendmail，如下所述：http: [//scratching.psybermonkey.net/2011/03/sendmail-how-to-test-sending-email.html](http://scratching.psybermonkey.net/2011/03/sendmail-how-to-test-sending-email.html)

我的`config/gitlab.yml`文件是使用以下电子邮件设置设置的：

```
email_from: gitlab@myops.com 
```

我读到这可能是 Sidekiq 没有运行的问题，所以我运行了以下命令，但没有任何改变。我仍然无法发送电子邮件：

```
$ sudo -u git -H bundle exec rake sidekiq:start RAILS_ENV=production
$ ps aux |grep -i sidekiq
git       2791  2.1  4.2 206476 86620 pts/0    Sl   14:45   0:23 sidekiq 2.7.5 gitlab [0 of 25 busy] 
```

这向我表明 Sidekiq 确实在运行......这里还有什么问题？不幸的是，GitLab 的 wiki 上似乎没有太多关于电子邮件设置的文档......

我发现 sidekiq.log 中记录了以下错误：

```
2013-04-24T21:09:01Z 2791 TID-1jaur8 Sidekiq::Extensions::DelayedMailer JID-21bd3ec0f086351088992396 INFO: start
2013-04-24T21:09:01Z 2791 TID-1jaur8 Sidekiq::Extensions::DelayedMailer JID-21bd3ec0f086351088992396 INFO: fail: 0.004 sec
2013-04-24T21:09:01Z 2791 TID-1jaur8 WARN: {"retry"=>true, "queue"=>"default", "timeout"=>30, "class"=>"Sidekiq::Extensions::DelayedMailer", "args"=>["---\n- !ruby/class 'Notify'\n- :new_user_email\n- - 4\n - pSzzULp8\n"], "at"=>1366819034.5969028, "jid"=>"21bd3ec0f086351088992396", "error_message"=>"Couldn't find User with id=4", "error_class"=>"ActiveRecord::RecordNotFound", "failed_at"=>"2013-04-24T15:57:19Z", "retry_count"=>10, "retried_at"=>2013-04-24 21:09:01 UTC}
2013-04-24T21:09:01Z 2791 TID-1jaur8 WARN: Couldn't find User with id=4
2013-04-24T21:09:01Z 2791 TID-1jaur8 WARN: /home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.13/lib/active_record/relation/finder_methods.rb:343:in `find_one'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.13/lib/active_record/relation/finder_methods.rb:314:in `find_with_ids'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.13/lib/active_record/relation/finder_methods.rb:107:in `find'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.13/lib/active_record/querying.rb:5:in `find'
/home/git/gitlab/app/mailers/notify.rb:23:in `new_user_email'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.13/lib/abstract_controller/base.rb:167:in `process_action'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.13/lib/abstract_controller/base.rb:121:in `process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.13/lib/abstract_controller/rendering.rb:45:in `process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionmailer-3.2.13/lib/action_mailer/base.rb:459:in `process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionmailer-3.2.13/lib/action_mailer/base.rb:453:in `initialize'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionmailer-3.2.13/lib/action_mailer/base.rb:439:in `new'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/actionmailer-3.2.13/lib/action_mailer/base.rb:439:in `method_missing'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/extensions/action_mailer.rb:20:in `perform'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/processor.rb:45:in `block (3 levels) in process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:109:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:109:in `block in invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/timeout.rb:11:in `block in call'
/usr/local/lib/ruby/1.9.1/timeout.rb:68:in `timeout'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/timeout.rb:10:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:111:in `block in invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/active_record.rb:6:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:111:in `block in invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/retry_jobs.rb:49:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:111:in `block in invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/logging.rb:11:in `block in call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/logging.rb:22:in `with_context'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/server/logging.rb:7:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:111:in `block in invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:114:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/middleware/chain.rb:114:in `invoke'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/processor.rb:44:in `block (2 levels) in process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/processor.rb:80:in `stats'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/sidekiq-2.7.5/lib/sidekiq/processor.rb:43:in `block in process'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/calls.rb:23:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/calls.rb:23:in `public_send'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/calls.rb:23:in `dispatch'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/future.rb:18:in `block in initialize'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/internal_pool.rb:48:in `call'
/home/git/gitlab/vendor/bundle/ruby/1.9.1/gems/celluloid-0.12.4/lib/celluloid/internal_pool.rb:48:in `block in create' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-22T11:44:31.140

This is my entries at the end in /config/environment/production.rb and that is working for me.

* * *

## Comment out sendmail options and use external SMTP relays

```
 ##config.action_mailer.delivery_method = :sendmail ## Comment out this
  # Defaults to:
  ## config.action_mailer.sendmail_settings = {
  ##   :location => '/usr/sbin/sendmail',
  ##   :arguments => '-i -t'
  ## }

  config.action_mailer.perform_deliveries = true
  config.action_mailer.raise_delivery_errors = true

  ## SMTP Settings
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
      :address => '10.146.10.90', ## My SMTP Relay/Gateway
      :port => 25, ## SMTP Port
      :domain => 'gitlab.example.com', ## My Domain
      :authentication => :plain, ## Let it be plain as it is inside my LAN
      ##:user_name => 'gitlab@yourserver.com', ## This is not required as long as 
      ##:password => 'yourPassword', ## SMTP Gateway allows anonymous relay
      ##:enable_starttls_auto => true ## In LAN
      ##:user_name => '',
      ##:password => '',
      :enable_starttls_auto => true
  }
end 
```

* * *

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-04T11:20:44.110

在 CentOS 上，这对我有帮助：

检查你的文件 /home/git/gitlab/config/environments/production.rb （如果你在生产中运行，这是标准的）

在那里您可以更改您的发送邮件设置。您应该尝试删除 -t 参数，为我修复它！一些邮件服务器不接受此参数（请检查您的邮件日志以确保）

```
 config.action_mailer.sendmail_settings = {
    :location => '/usr/sbin/sendmail',
    :arguments => '-i'
  } 
```

# python - 如何在 Python 中引用异常类？

> ID：16201094
> 
> 赞同：3
> 
> 时间：2013-04-24T20:01:11.290
> 
> 标签：python, exception, namespaces, python-import, gpx

我想捕捉[gpxpy](https://github.com/tkrajina/gpxpy/blob/master/gpxpy/gpx.py#L64)库抛出的[GPSException](https://github.com/tkrajina/gpxpy)。

```
try:
    gpx = gpxpy.parse(open(filepath))
except GPXException:
    print "GPXException for %s." % filepath 
```

由于我是 Python 新手，我不明白如何通过命名空间（如`gpxpy.gpx.GPSException`..）或导入语句引用异常。

```
import gpxpy
import gpxpy.gpx
import gpxpy.gpx.GPSException 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T20:05:04.103

您需要正确引用异常。

将异常直接导入您的模块，或使用完整参考：

```
import gpxpy.gpx

try:
    # ...
except gpxpy.gpx.GPSException:
    # ... 
```

或者

```
from gpxpy.gpx import GPSException

try:
    # ...
except GPSException:
    # ... 
```

# boost - Boost Graph Library A* 实现一致的启发式

> ID：16201095
> 
> 赞同：1
> 
> 时间：2013-04-24T20:01:15.680
> 
> 标签：boost, a-star, boost-graph

我已经读过，在将 A* 应用于问题时，如果您的启发式是一致的，那么您可以进一步优化 A* 搜索。Boost Graph Library 提供了两个版本的 A* 算法：`astar_search`和`astar_search_tree`. 文档对两者之间的区别不是很清楚；其中之一是否执行假设一致启发式的优化搜索？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-30T21:16:13.017

通过查阅 Boost 邮件列表，我得到了我正在寻找的答案。我将在这里为后代重现答案：

> 区别在于是否应该努力避免多次访问同一个顶点。对于通常可以使用许多路径到达顶点的图，您应该更喜欢 astar_search 以避免重新访问该顶点及其后续节点的额外工作。如果同一顶点不太可能出现在多条路径上，或者检查顶点的成本足够低以至于不值得避免重复工作，请使用不记得之前访问过哪些顶点的 astar_search_tree。尝试查找重复顶点的缺点是它需要越来越多的内存来存储以前见过的顶点的查找表，并且搜索和更新该表需要时间。两个版本的算法都需要允许的启发式才能正常工作。

[链接到线程](http://lists.boost.org/boost-users/2013/04/78681.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T20:12:43.803

`_tree`和非`_tree`boost 图算法版本之间的区别在于，该`_tree`版本假定您的图实际上是一棵树，因此它没有循环，并且只有一个箭头表示节点。

# linux - 使用 shell 计算学生的平均值

> ID：16201096
> 
> 赞同：0
> 
> 时间：2013-04-24T20:01:17.490
> 
> 标签：linux, bash, shell, sorting, awk

我有一个名为：'winter'witch 的文件，每行包含一个学生姓名和他在冬季期末考试中的平均成绩：

```
John 4
Brian 8.5 
```

另一个名为：'summer' 的文件在每行包含一个学生姓名和他夏季期末考试的 5 个成绩：

```
John 8 7 9 4 7
Brian 10 9 4 5 8 
```

我想计算每个学生的年平均成绩：

```
John ((8+7+9+4+7)/5 + 4)/2
Brian ((10+9+4+5+8)/5 + 8.5)/2 
```

输出将按年平均排序，因此成绩最高的学生排在第一位。

我希望使用 shell 编程来完成。

我尝试使用 awk 计算平均值：

```
awk '{print $1 " " ($2 + $3 + $4 + $5 + $6)/5}' summer 
```

但我不知道如何继续，甚至不知道如何开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:06:40.283

这是一种方法：

```
$ awk 'FNR==NR{a[$1]=$2;next}{print $1,(a[$1]+($2+$3+$4+$5+$6)/5)/2}' winter summer | sort -rnk2
Brian 7.85
John 5.5 
```

**解释：**

`FNR==NR`仅当我们在第一个文件中时，该条件才成立，`winter`因此该块仅针对该文件执行。该块只是创建一个数组，其中学生姓名是键，成绩是值。该`next`语句跳转到文件中的下一行。当我们在第二个文件中时，脚本与您的脚本大致相同，但我们使用数组从第一个文件中获取成绩。排序是对第二个字段的简单`-r`反向数字排序。`-n``-k2`

应该注意的是，这个脚本假设没有两个学生有相同的名字。

# iphone - 另一个方法内的方法完成等待

> ID：16201098
> 
> 赞同：0
> 
> 时间：2013-04-24T20:01:26.073
> 
> 标签：iphone, objective-c, objective-c-blocks, completion-block

我怎样才能等待某种方法完成然后继续工作？

```
- (void)loadMoreDataOnBottomOfTableview
{
NSLog(@"LOADING ITEMS ON BOTTOM");
[self refreshStream];

[self.mainTableView reloadData];

...
} 
```

所以我需要等待 refreshStream 方法完成，然后重新加载 tableview 数据和 loadMoreDataOnBottomOfTableview (...) 的其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:04:07.973

使用完成块。这就是他们的设计目的。

请参阅本指南中的完成处理程序部分。[http://developer.apple.com/library/ios/#featuredarticles/Short_Practical_Guide_Blocks/index.html](http://developer.apple.com/library/ios/#featuredarticles/Short_Practical_Guide_Blocks/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:22:34.163

重新定义刷新流

```
 -(void)refreshStream:(void (^)(void))complete;

 -(void)loadMoreDataOnBottomOfTableview
 {
     [self refreshStream:^{
           [self.mainTableView reloadData];
     }];
 } 
```

这应该做对了，还请查看此页面，使用 typedef 是不言而喻的标准。

[http://developer.apple.com/library/mac/#featuredarticles/BlocksGCD/_index.html](http://developer.apple.com/library/mac/#featuredarticles/BlocksGCD/_index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T05:10:41.613

```
[self performSelectorOnMainThread:<#(SEL)#> withObject:<#(id)#> waitUntilDone:<#(BOOL)#>]; 
```

您可以使用它调用您的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T06:19:25.680

我可以迅速回答您的问题。同样，您可以在代码中使用完成块来完成任务。

```
class TestClosure
{

func calculateAdditionData() {

    countNumbers({ (result) -> Void in

        println("[self refreshStream] completed")
        //[self.mainTableView reloadData];
    })
}

func refreshStream(completion: (() -> Void)!) {

    //Your refresh code
    completion()
}

} 
```

完成块/闭包是等待某事完成的正确方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-24T20:05:33.837

您可以`performSelectorOnMainThread:withObject:waitUntilDone:`按如下方式使用：

```
 [self performSelectorOnMainThread:@selector(refreshStream) withObject:nil waitUntilDone:YES]

 [self.mainTableView reloadData]; 
```

但是请注意，这不是推荐的设计模式。异步调用应该使用回调（你的`refreshStream`方法应该回调到你的视图控制器中的一个方法，然后触发`reloadData`

# user-interface - 特定事件后的结束阶段

> ID：16201115
> 
> 赞同：1
> 
> 时间：2013-04-24T20:02:20.183
> 
> 标签：user-interface, javafx-2

发生某些特定外部事件后，如何关闭 JavaFX 2 中的阶段？假设我有一个带有简单进度条的阶段，该进度条由一个任务填充（从另一个答案借来的）：

```
Task<Void> task = new Task<Void>(){
                @Override
                public Void call(){
                    for (int i = 1; i < 10; i++)    {
                        try {
                            Thread.sleep(200);
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                        System.out.println(i);
                        updateProgress(i, 10);
                    }
                return null;                
                }
            }; 
```

任务完成并且进度条填充到 100% 后，如何自动关闭窗口（并打开下一个窗口）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:26:39.193

在返回 null 之前；你可以加

```
Platform.runLater(
    new Runnable() {
        public void run() {
            stage.close();
        }
    }
); 
```

或者

```
progressBar.progressProperty().addListener(new ChangeListener<Number>(){
//add checking, that progress is >= 1.0 - epsilon
//and call stage.close();
}) 
```

第一个更好。但请注意，该任务是在单独的线程上完成的。所以你应该使用特殊调用在 JFX 线程上的 stage.close() 上提出请求。

此外，jewelsea 在对问题的评论中提供了关于阶段结束问题的链接。

# arrays - 有没有办法在scala中选择数组中的所有内容？

> ID：16201118
> 
> 赞同：0
> 
> 时间：2013-04-24T20:02:30.157
> 
> 标签：arrays, scala

我有这个数组：

```
val lines: Array[LineSprite] = new Array[LineSprite](26) 
```

我希望能够一次选择其中的所有内容。我该怎么做呢？

我知道在数组中选择一个元素看起来像这样：lines(0)

但是我如何一次选择所有？

* * *

该数组有 26 个元素。我需要更改每个元素的颜色。要为一个元素做到这一点，我会这样做：

```
lines(0).setColor(Color.blue) 
```

我怎样才能一次完成所有这些，而不是为每个元素使用其中的一段代码？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:12:34.357

我猜“选择”是指对所有人应用相同的操作。在这种情况下，您应该使用`foreach`所有`Traversable`s 上可用的方法，例如：

```
lines.foreach( _.setColor(Color.blue)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:14:20.377

它通常使用任何`foreach`一种方法（如果您正在执行一些副作用，例如设置颜色、打印或其他东西）或`map`方法（如果您关心结果）完成：

```
lines.foreach(l => l.setColor(Color.blue))
val squares = List(1,2,3,4).map(n => n * n) 
// squares are now List(1,4,9,16)
// note that line below is wrong
val squares = List(1,2,3,4).foreach(n => n * n) 
// squares now is Unit (aka void) because foreach doesn't return anything 
```

这些方法实际上是为每个内置集合和数组定义的。

# delphi - 如何使编辑控件不接受 0 作为第一位？

> ID：16201121
> 
> 赞同：3
> 
> 时间：2013-04-24T20:02:46.937
> 
> 标签：delphi, delphi-7

好吧，我有一个只需要数字的编辑（没有字母，没有符号，只有数字）。问题是我不希望用户将 0 作为第一位数字，例如 (0239847)。

我正在考虑制作一个变量“x”-> byte，它将计算编辑的长度并删除第一个数字，如果它是 0：

```
var l:length; number:string100;
begin
l:length(edit1.text); 
```

现在，如果第一个数字是 0（0239847），则将其删除，但如果没有其他数字（只有 0），则保持原样。

天哪，我终于找到了最简单的方法：

```
procedure TForm1.Edit1Change(Sender: TObject);
var digit1:string;
begin
digit1:=edit1.Text;
if (digit1='00') or (digit1='01') or (digit1='02') or (digit1='03') or (digit1='04') or
(digit1='05') or (digit1='06') or (digit1='07') or (digit1='08') or (digit1='09') then
edit1.Text:=clear;    //or edit1.text:=0;  it's the same

end;

end. 
```

仍然可以复制和粘贴数字，但我不介意

这是一个非常愚蠢的问题，因为答案简单明了，但是如果您太累了，很难找到它，很抱歉让您忙于这个问题，Andreas，感谢您的帮助和提示。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-24T20:09:24.407

很难做到这一点。最雄心勃勃的方法是在按键、粘贴等方面做很多逻辑，就像在[这个答案](https://stackoverflow.com/a/15069650/282848)中一样。您会惊讶地发现有多少案件需要处理！

这很好用，我认为：

```
type
  TEdit = class(StdCtrls.TEdit)

...

procedure TEdit.KeyPress(var Key: Char);

  function InvalidKey: boolean;
  begin
     InvalidKey :=
       (
         (Key = '0') and
           (
             ((SelStart = 0) and (Length(Text) - SelLength <> 0))
             or
             ((SelStart = 1) and (Text[1] = '0'))
           )
       )
       or
       (
         not (Key in ['0'..'9', #8, ^Z, ^X, ^C, ^V])
       )
  end;

begin
  inherited;

  if InvalidKey then
  begin
    beep;
    Key := #0;
  end else if (SelStart = 1) and (Text[1] = '0') then
  begin
    Text := Copy(Text, 2);
  end;
end;

procedure TEdit.WMPaste(var Message: TWMPaste);    
var
  ClipbrdText: string;

  function ValidText: boolean;
  var
    i: Integer;
  begin
    result := true;
    for i := 1 to Length(ClipbrdText) do
      if not (ClipbrdText[i] in ['0'..'9']) then
      begin
        result := false;
        break;
      end;
  end;

  function RemoveLeadingZeros(const S: string): string;
  var
    NumLeadingZeros: integer;
    i: Integer;
  begin
    NumLeadingZeros := 0;
    for i := 1 to Length(S) do
      if S[i] = '0' then
        inc(NumLeadingZeros)
      else
        break;
    result := Copy(S, NumLeadingZeros + 1);
  end;

begin
  if Clipboard.HasFormat(CF_TEXT) then
  begin

    ClipbrdText := Clipboard.AsText;

    if not ValidText then
    begin
      beep;
      Exit;
    end;

    if SelStart = 0 then
      ClipbrdText := RemoveLeadingZeros(ClipbrdText);

    SelText := ClipbrdText;

  end
  else
    inherited;
end; 
```

这看起来很复杂，但所有这些逻辑都是必要的。例如，代码很好地处理了所有这些情况：

*   您只能输入数字。

*   如果*不是每个*`SelStart = 0`字符都被选中，则不能输入，因为那样会得到前导零。*`0`*

**   如果*每个*字符都被选中，`SelStart = 0`您*可以*输入. 因为您应该能够输入此有效数字。**`0`**

     ***   一个特殊情况：如果有零个字符，那么当然选择了零个字符，所以通过简单的逻辑你*就*可以`0`从空字符串的状态进入！** ***   if`SelStart = 1`和`Text[1] = '0'`[if `SelStart = 1`, then`Text[1]`存在，所以我们这里依赖布尔短路评估]，那么你不能输入`0`。

    *   如果编辑字段的内容是`0`并且您在零之后添加了一个非零字符，则将删除零（并且不会干扰插入符号的位置）。

    *   您只能粘贴数字。如果`SelStart = 0`，则丢弃前导零（在剪贴板数据中）。*** 

 **事实上，要使行为完美，您需要*更多的*代码。例如，假设编辑字段的内容是`123000456`. 与现在一样，您可以选择前三个字符 ( `123`)，然后按`Backspace`或`Delete`获取无效文本`000456`。解决方案是*添加额外的代码*来删除这两个操作中的任何一个导致的前导零。**更新：**我一直在做一些思考，并且已经意识到最好*不要*实施这个（为什么？）。

然而，一种捷径是在编辑内容没有聚焦时“美化”编辑的内容，因为当它没有聚焦时，你不太可能通过对编辑。

例如，您可以执行类似的操作

```
function PrettifyNumber(const S: string): string;
var
  NumLeadingZeros: integer;
  i: Integer;
begin
  NumLeadingZeros := 0;
  for i := 1 to Length(S) do
    if S[i] = '0' then
      inc(NumLeadingZeros)
    else
      break;
  result := Copy(S, NumLeadingZeros + 1);
  if length(result) = 0 then
    result := S;
end; 
```

然后在失去键盘焦点时将编辑字段的内容替换为其美化版本。当然，您应该考虑将此功能添加到派生的编辑类中，但为了进行测试，您可以简单地使用`OnExit`事件：

```
procedure TForm1.Edit1Exit(Sender: TObject);
begin
  Edit1.Text := PrettifyNumber(Edit1.Text);
end; 
```

我想您希望在主要应用程序（或不那么重要）的大量编辑中使用此功能。因此，您实际上将编写自己的子类控件。那么我想除了简单地删除前导零之外，您还需要其他类型的验证？因此，您必须将此代码与其余代码很好地集成。如果实际上您将在大型应用程序中的任何地方使用此编辑“子类”，您还可以考虑在编辑控件类中添加一个快捷方式，以便您可以按需美化/验证文本，而不仅仅是在退出时（如果编辑控件单独在其窗体上，则特别困难！）

# 更新

根据要求，这是一个效果不佳的简单解决方案：

```
procedure TForm1.Edit1KeyPress(Sender: TObject; var Key: Char);
begin
  if (Key = '0') and (Edit1.SelStart = 0) then Key := #0;
end; 
```

我把它作为一个练习来找出这种方法的问题。如果你一一解决问题，当你发现它们时，你最终会得到我上面的长代码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T10:39:41.540

您可以使用 TmaskEdit。这迫使用户输入数字。添加 eventchange 后删除第一个数字（如果为 0）。

例子.dfm

```
.
.
object MaskEdit1: TMaskEdit
  Left = 352
   Top = 8
   Width = 120
   Height = 21
   EditMask = '0999999;0;_'
   MaxLength = 7
   TabOrder = 3
   OnChange = MaskEdit1Change
end
.
. 
```

例子.pas

```
.
.
Procedure TForm1.MaskEdit1Change(Sender: TObject);
Begin
  If Length(TMaskEdit(Sender).Text) > 1 Then
    TMaskEdit(Sender).Text := IntToStr(StrToInt(TMaskEdit(Sender).Text));
End;
.
. 
```**

# c# - 需要一些初学者 C# 代码的解释

> ID：16201122
> 
> 赞同：5
> 
> 时间：2013-04-24T20:02:46.610
> 
> 标签：c#

我已经开始学习c#了。我正在尝试声明一个类和一些变量，并尝试对字符串进行简单的连接。但是我遇到了一些错误-代码如下

```
namespace ConsoleApplication1
{
    class Class1
    {
        string s1 = "hi";
        string s2 = "hi";
        string s3 = s1 + s2;
    }
} 
```

我得到的错误是 - ***字段初始化程序无法引用非静态字段、方法、属性'ConsoleApplication1.Class1.s1***

有人可以解释这里发生了什么。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-24T20:05:20.523

> 有人可以解释这里发生了什么。

好吧，编译器错误消息说明了一切，真的，一旦你超越了术语。此行无效：

```
string s3 = s1 + s2; 
```

您正在声明实例变量，并且`s1 + s2`不允许实例变量初始化程序（此处）引用正在创建的实例中的其他字段 - 或者实际上是实例本身。请记住，上述声明等同于：

```
string s3 = this.s1 + this.s2; 
```

从 C# 4 规范的第 10.5.5.2 节：

> 实例字段的变量初始值设定项不能引用正在创建的实例。因此，`this`在变量初始化器中引用是编译时错误，因为变量初始化器通过*simple-name*引用任何实例成员是编译时错误。

（诚​​然，这是规范中更奇怪的措辞之一......）

您必须将逻辑放入构造函数主体中：

```
class Class1
{
    string s1 = "hi";
    string s2 = "hi";
    string s3;

    public Class1()
    {
        s3 = s1 + s2;
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-24T20:04:34.363

变量不是 [逻辑上] 以特定顺序初始化的。最好将您的程序设计为无论变量初始化的顺序如何，它们都能正常工作。

对于局部变量的非平凡赋值，您可以使用该类型的构造函数：

```
class Class1
{
    string s1 = "hi";
    string s2 = "hi";
    string s3;

    public Class1()
    {
         s3 = s1 + s2;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-24T20:03:57.423

尝试`s3`在方法中初始化，最好是构造函数

```
class Class1
{
    string s1 = "hi";
    string s2 = "hi";
    string s3;

    public Class1()
    {
        s3 = s1 + s2;
    }
} 
```

# java - 使用 KeyEventDispatcher 设置 jframe 大小

> ID：16201126
> 
> 赞同：0
> 
> 时间：2013-04-24T20:03:01.083
> 
> 标签：java, swing, size, jframe, keyevent

这是我的主要课程

```
package Apocalypse;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Main extends JFrame{
    private int xSize, ySize;

    public Main(){
        super("Zombie Apocalypse");
        Toolkit tk = Toolkit.getDefaultToolkit();
        xSize = (int) tk.getScreenSize().getWidth();
        ySize = (int) tk.getScreenSize().getHeight();
        setSize(xSize,ySize);
        setUndecorated(true);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        KeyboardFocusManager kfm = KeyboardFocusManager.getCurrentKeyboardFocusManager();
        kfm.addKeyEventDispatcher(new MyDispatcher());
        add(new Level1());
        setVisible(true);
    }

    public static void main(String[] args){
        new Main();
    }

    private class MyDispatcher implements KeyEventDispatcher{
        public boolean dispatchKeyEvent(KeyEvent e){
            if(e.getID() == KeyEvent.KEY_PRESSED){
                if(e.getKeyCode() == KeyEvent.VK_ESCAPE){
                    System.out.println("It Worked");
                    setUndecorated(false);
                }
            }
            return false;
        }
    }
} 
```

正如您在我的 KeyEventDispatcher 类中看到的那样，我想将 setUndecorated 设置为 false，这样您就可以关闭游戏，但它不起作用。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:17:23.327

一旦显示框架，您就无法更改其装饰，因为在这种情况下会抛出[setUndecorated() 。](http://docs.oracle.com/javase/6/docs/api/java/awt/Frame.html#setUndecorated%28boolean%29)`IllegalComponentStateException`要解决这个问题，您可以创建新的装饰框架，将您的内容移动到其中并处理旧框架。

# rest - 使用 Jersey Pojo 映射功能和 Jquery 将多个 POJO 传递给 restful api

> ID：16201127
> 
> 赞同：1
> 
> 时间：2013-04-24T20:03:01.567
> 
> 标签：rest, mapping, jersey, pojo

目前我们启用了 Pojo 映射功能，如下所示：

```
<servlet-class>
com.sun.jersey.spi.spring.container.servlet.SpringServlet
</servlet-class>
<init-param>
<param-name>com.sun.jersey.config.property.packages</param-name>
<param-value>com.rest.services</param-value>
</init-param>
<init-param>
<param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
<param-value>true</param-value>
</init-param> 
```

休息方法如下

```
 @POST
        @Path("/test")
        @Produces(MediaType.APPLICATION_JSON)
        public Response addSomething(POJOObject pObj){
           } 
```

是否可以传递多个 Pojo 对象，如下所示

```
 @POST
            @Path("/test")
            @Produces(MediaType.APPLICATION_JSON)
            public Response addSomething(POJOObject pObj,POJOObject2 pObj1){
               } 
```

这可以通过创建一个包含两个对象（pObj 和 pObj1）的聚合对象来实现

但想知道是否有其他解决方案可以实现这一目标。

# bash - sed - 删除破折号之前的所有字符

> ID：16201134
> 
> 赞同：4
> 
> 时间：2013-04-24T20:03:28.907
> 
> 标签：bash, sed, awk

我有一个文件名列表，我想在第一个实例之前删除所有字符`-`。因此，Before: 列表中的以下名称显示为 After: 列表中的名称。

```
Before:
Adam James - Welcome Home.txt
Mike & Harry - One Upon - A Time.txt
William-Kent - Prince & The Frog.txt

After:
Welcome Home.txt
One Upon - A Time.txt
Prince & The Frog.txt 
```

我一直在玩 sed 几个小时但无济于事。

我发现`sed 's/ - .*//'`在第一个实例之后删除了所有字符，`-`但之前我找不到相同的字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:30:55.240

```
$ awk '{print substr($0,index($0," - ")+3)}' file
Welcome Home.txt
One Upon - A Time.txt
Prince & The Frog.txt 
```

i.e. just print from the end of the first occurrence of " - " to the end of the line.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:12:58.727

像这样。

```
sed 's/^[^-]* - //' 
```

许多正则表达式引擎允许`*?`非贪婪搜索，但 sed 不允许。

编辑：这不会改变 William-Kent 示例，嵌入的连字符会阻止匹配。

（此外，Perl 提供了一个非常方便的`rename`脚本来使用正则表达式批量重命名文件，但并非每个发行版都安装它。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T20:30:03.823

Simplest approach is too use `grep`:

```
$ grep -Po ' - \K.*' file
Welcome Home.txt
One Upon - A Time.txt
Prince & The Frog.txt 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-24T20:15:28.913

使用 awk 你可以：

```
awk 'BEGIN{FS=OFS="- "} NF>1{$1="";sub(/^- */, "")}'1 inFIle 
```

### 现场演示：http: [//ideone.com/2tBU4v](http://ideone.com/2tBU4v)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-24T21:08:30.567

这可以在没有 bash 功能的普通 POSIX sh 中完成：

```
$ cat the_file_names 
Adam James - Welcome Home.txt
Mike & Harry - One Upon - A Time.txt
William-Kent - Prince & The Frog.txt

$ { while read FN; do echo ${FN#* - }; done; } < /tmp/the_file_names 
Welcome Home.txt
One Upon - A Time.txt
Prince & The Frog.txt

$ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-24T20:27:31.993

在纯 Bash 中（没有产生额外的子进程）：

```
list=('Adam James - Welcome Home.txt' 'Mike & Harry - One Upon - A Time.txt')
for str in "${list[@]}"; do echo ${str#*-}; done 
```

印刷：

```
Welcome Home.txt
One Upon - A Time.txt 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-25T06:22:29.747

这可能对您有用（GNU sed）：

```
 sed 's/ - /\n/;s/.*\n//' file 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-24T20:26:18.000

我认为`gawk`这份工作可能更容易。

的使用`FPAT`可以简化问题：

```
awk -v FPAT="- .*$" 'sub(/^- /,"",$1)' file 
```

使用您的数据：

```
kent$  echo "Adam James - Welcome Home.txt
Mike & Harry - One Upon - A Time.txt
William-Kent - Prince & The Frog.txt"|awk -v FPAT="- .*$" 'sub(/^- /,"",$1)'
Welcome Home.txt
One Upon - A Time.txt
Prince & The Frog.txt 
```

# maven - Maven 插件：将所有可用属性传递给插值器

> ID：16201135
> 
> 赞同：1
> 
> 时间：2013-04-24T20:03:29.690
> 
> 标签：maven, maven-plugin

在 Maven 插件中，我想通过 ValueSource 使用通常可用于插值器内的 pom 的所有属性。

我可以使用 MavenProject#getProperties()、MavenSession#getProperties() 或 MavenProject#getModel()#getProperties 之一访问 pom 中定义的属性、系统属性和环境变量属性。这适用于这样的代码：

```
import org.codehaus.plexus.interpolation.PropertiesBasedValueSource;

ValueSource valueSource = new PropertiesBasedValueSource( project.getModel()
                   .getProperties() ) 
```

但是，标准项目属性类似于`project.version`或`project.build.directory`不属于任何这些 Properties 实例。如何在属性实例中一次获得所有这些？

我的插件使用 Maven 2.2.1 或 3.0.3 在生成源阶段运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T09:03:08.647

回答我自己的问题:-)：

我想传递过滤器中通常可用的所有属性。虽然我可以将每个可用的属性设置为我的插件的参数，但该解决方案需要修改插件源代码并在向 maven 添加新属性时重新编译它。此外，mojo 的源代码会增长到很多行。

在过滤器中使用时，这些`project.*`属性实际上并不是通过该方法可用的属性。`Project#getProperties`相反，它们直接映射到项目对象本身的 getter 方法。这样做的类`PrefixedObjectValueSource`与`PropertiesBasedValueSource`. 它将每个 getter 方法（bean 属性）映射到一个属性，用定义的字符串作为前缀，并递归地公开每个属性的 bean 属性。

```
 import org.codehaus.plexus.interpolation.PrefixedObjectValueSource;
  import org.codehaus.plexus.interpolation.PropertiesBasedValueSource;

  ValueSource allProperties = new PropertiesBasedValueSource( getProject().getModel()
                   .getProperties() );
  ValueSource projectProperties =
              new PrefixedObjectValueSource( "project.", getProject() ) ); 
```

# css - 站点下拉菜单在 IE8 兼容模式下不起作用

> ID：16201137
> 
> 赞同：1
> 
> 时间：2013-04-24T20:03:33.897
> 
> 标签：css, internet-explorer-8, suckerfish

我正在一个网站上工作，该网站的菜单在新浏览器中看起来很棒，甚至在 vista 上也有 IE8，但是在`IE8 compatibility`模式或 XP 中，导航不起作用。

我在这里做了一个 jsfiddle 来看看我的意思（抱歉，我很着急；将鼠标悬停在“结果”部分上，你会看到下拉菜单在起作用）

[http://jsfiddle.net/K3PFd/](http://jsfiddle.net/K3PFd/)

它只是在兼容模式下不起作用，或者我假设是旧版本的 IE。当然，客户端使用的是 IE8，这就是为什么我必须解决这个问题......

你能帮忙吗？

# wordpress - 使 S3 存储桶内容始终公开

> ID：16201138
> 
> 赞同：1
> 
> 时间：2013-04-24T20:03:41.410
> 
> 标签：wordpress, amazon-s3, s3fs

我已经设法使用 S3FS 将 Amazon S3 文件夹挂载到我的 Wordpress 站点中。基本上，我的 NextGEN 画廊的画廊文件夹是指向已安装的存储桶 S3FS 文件夹的符号链接，因此当我上传图像时，该文件会自动添加到 S3 存储桶中。

我正忙着编写一个 Apache 重写规则来替换链接，取而代之的是从 S3 获取图库图像，而不必使用 NextGEN 破解或更改任何内容，但我发现的一个问题是图像在 S3 上默认不公开.

有没有办法更改父文件夹，使其子文件夹始终公开，包括生成的新文件？

是否可以或建议使用 cron 任务使用 S3 命令行 API 手动公开文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-28T13:56:46.137

我是开源项目[RioFS](https://github.com/skoobe/riofs)的主要开发人员和维护人员：一个用于挂载 Amazon S3 存储桶的用户空间文件系统。

我们的项目是“s3fs”项目的替代方案，与“s3fs”相比的主要优势是：简单、操作速度和无错误代码。目前[该项目](https://github.com/skoobe/riofs)处于“测试”状态，但它已经在几个高负载文件服务器上运行了相当长的一段时间。

我们正在寻求更多的人加入我们的项目并帮助进行测试。从我们这边，我们提供快速的错误修复，并会听取您添加新功能的请求。

关于你的问题：

如果您使用[RioFS](https://github.com/skoobe/riofs)，您可以使用以下命令安装存储桶并对其具有写入/读取访问权限（假设您已安装[RioFS](https://github.com/skoobe/riofs)并已导出 AWSACCESSKEYID 和 AWSSECRETACCESSKEY 环境变量）：

```
riofs  -o allow_other http://s3.amazonaws.com bucket_name /mnt/static.example.com 
```

（命令行参数请参考项目描述）

请注意，该项目仍在开发中，可能仍存在许多错误。

如果您发现某些事情没有按预期工作：请在[项目的 GitHub 页面](https://github.com/skoobe/riofs/issues?state=open)上填写问题报告。

希望它有所帮助，我们期待看到您加入我们的社区！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T07:53:21.680

我下载了 s3curl 并用它来将存储桶策略添加到 S3。

请参阅此链接：[http ://blog.travelmarx.com/2012/09/working-with-s3curl-and-amazon-s3.html](http://blog.travelmarx.com/2012/09/working-with-s3curl-and-amazon-s3.html)

您可以使用 Amazon Policy Generator 生成存储桶策略：

[http://awspolicygen.s3.amazonaws.com/policygen.html](http://awspolicygen.s3.amazonaws.com/policygen.html)

# php - 在mysql中将带参数的过程调用到事件中

> ID：16201140
> 
> 赞同：0
> 
> 时间：2013-04-24T20:03:48.477
> 
> 标签：php, mysql, events, stored-procedures

如何使用此参数调用此过程？

```
SET @newday = current_date() + INTERVAL 6 DAY;
CALL add_day('20','@newday') 
```

我无法保存它，因为它给了我一些语法错误，我找不到它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:27:14.027

你说它是一个函数。如果它是一个函数，你应该使用`SELECT`而不是`CALL`.

如果它是一个过程，那么您正在正确地调用它。在这种情况下，错误在过程的主体中，而不是在调用中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T20:17:42.763

遵循我所做的并努力工作。

我创建的功能：

```
create function add_day(days int, date_from datetime)
returns datetime 
return date_add(date_from, interval days day); 
```

我打的电话：

```
SET @newday1 = current_date() + INTERVAL 6 DAY;
select add_day('20',@newday1); 
```

如果您在运行上述脚本时遇到错误，则错误可能在函数内部。我改变了你调用函数的方式，因为你告诉我们是一个函数而不是一个过程。

# java - 强制转换 int 是否与普通 int 相同

> ID：16201145
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:04:03.533
> 
> 标签：java, jdbc

我正在尝试将一个值插入 JDBC，我从一个组合框中获取一个值，在该组合框中我必须转换为一个 int 但查询没有将其识别为一个 int？它以数字形式打印到控制台。

这是最能复制问题的代码示例。

我尝试将输入转换为字符串然后解析它，但它仍然无法识别它。它就像它不会识别int。我有点难过。谢谢

```
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class AddingItemToComboBox implements ActionListener{

    JButton click = new JButton("Click me");
    JComboBox qty = new JComboBox();

    public AddingItemToComboBox(){
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel1 = new JPanel();
        panel1.setLayout(new FlowLayout());
        panel1.setSize(500,500);   

        click.addActionListener(this);
        qty.setBounds(10,270, 150, 20 );
        qty.setSize(80,30);
        qty.addItem(1);
        qty.addItem(2);
        qty.addItem(3);
        panel1.add(qty);
        panel1.add(click);
        frame.add(panel1);

        frame.setSize(300, 200);
        frame.setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent e) {

        if(e.getSource() == click){

            int quan  =  (int)qty.getSelectedItem();    
            System.out.println(quan);

            //Connection to database
                    // Here is the problem "quan"
            con.insertProduct(qaun);

        }

    }
    public static void main(String[] args){

        AddingItemToComboBox aic = new AddingItemToComboBox();
    }

} 
```

错误：线程“AWT-EventQueue-0”中的异常 java.lang.Error：未解决的编译问题：qaun 无法解析为变量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:09:37.097

你的变量是`quan`你正在使用的`qaun`

看着那（这`con.insertProduct(qaun);`

编译错误清楚地向您展示了这一点

错误：线程“AWT-EventQueue-0”中的异常 java.lang.Error：未解决的编译问题：**qaun**无法解析为变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:07:19.067

> 它以数字形式打印到控制台

此代码与

```
int quan  =  (int)qty.getSelectedItem();    
System.out.println(quan); 
```

是相同的

```
System.out.println(Integer.toString(quan)); 
```

无法将数字打印为 int，因为您的控制台只能显示字符，因此必须将其转换为文本。

# android - 为什么我的 AlarmManager 会立即启动？

> ID：16201148
> 
> 赞同：4
> 
> 时间：2013-04-24T20:04:10.940
> 
> 标签：android, time, calendar, alarmmanager, alarm

我正在尝试构建一个警报应用程序。我之前有闹钟工作，我可以设置不同的时间，闹钟会适当地响起。然后我将 ChangeAlarmActivity 的布局更改为 TableLayout，现在它不起作用了吗？我没有触摸代码。以下是我设置闹钟的方法：

```
Intent alarmIntent = new Intent(ChangeAlarmActivity.this, AlarmReceiver.class);
PendingIntent pendingAlarmIntent = PendingIntent.getBroadcast(ChangeAlarmActivity.this, (int)alarm.getID(),
        alarmIntent, 0);

AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
System.out.println("Alarm time: " + hour + ":" + min);
Calendar alarmCal = Calendar.getInstance();
//alarmCal.setTimeInMillis(System.currentTimeMillis());
alarmCal.set(Calendar.HOUR_OF_DAY, hour);  
alarmCal.set(Calendar.MINUTE, min);        
//alarmCal.set(Calendar.SECOND, 0);

alarmManager.set(AlarmManager.RTC_WAKEUP,
        alarmCal.getTimeInMillis(),
        pendingAlarmIntent); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-24T20:08:11.537

可能是因为您的小时和分钟已过去。

假设您当前时区是 16:07 小时（使用 24 小时制），您使用`hour`as`3`和`min`as执行此代码`27`。03:27 已经过去，因此警报立即响起。

打完你的两个`set()`电话后，看看时间是否比现在早，如果是，`add()`一天。

# silverlight - 使用 Telerik Radgridview 列进行十进制排序

> ID：16201151
> 
> 赞同：0
> 
> 时间：2013-04-24T20:04:17.650
> 
> 标签：silverlight, telerik-grid, rad-controls

我正在使用带有 silverlight4.0 的 Telerik radcontrols。在这里，我的 radgridview 中有货币列，但是发生的问题不是以升序和降序方式排序，例如：

```
 1500.44 , 12229.21 , 1021.30 230.15 , 1400.36 
```

顺序应该是

```
230.15,1021.30,1400.36,1500.44,12229.21 
```

谁能告诉我们如何获得这些值的排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T22:50:18.750

检查这个

```
 <telerik:GridViewDataColumn Header="Price" DataMemberBinding="{Binding Price}" DataFormatString="#,#.000" TextAlignment="Right" Width="80"/> 
```

用于排序：

```
 <telerik:RadGridView.SortDescriptors>
                    <telerik:SortDescriptor Member="Price" SortDirection="Descending"/>
 </telerik:RadGridView.SortDescriptors> 
```

# sql - 根据重复行和空值显示特定的输出数据 [postgresql]

> ID：16201154
> 
> 赞同：0
> 
> 时间：2013-04-24T20:04:20.590
> 
> 标签：sql, postgresql

我正在使用以下 SQL（与两个类似查询的联合）：

```
SELECT
    distinct a.source,
    a.p_id,
    a.name,
    b.prod_count,
    b.prod_amt,
    'Def' as prod_type
FROM
    dwh.attribution_product_count a
        LEFT OUTER JOIN
        (
SELECT
    distinct source,
    p_id,
    name,
    sum(acct_count) as prod_count,
    sum(acct_amt) as prod_amt
FROM
    dwh.prod_count
WHERE
    month = 3 AND
    default_banner_flag = 0 AND
    loan_flag = 3
GROUP BY
    source,
    name,
    p_id ) as b
        ON
        a.p_id = b.p_id
UNION
SELECT
    distinct a.source,
    a.p_id,
    a.name,
    b.prod_count,
    b.prod_amt,
    'Other' as prod_type
FROM
    dwh.attribution_product_count a
        LEFT OUTER JOIN
        (
SELECT
    distinct source,
    p_id,
    name,
    sum(acct_count) as prod_count,
    sum(acct_amt) as prod_amt
FROM
    dwh.prod_count
WHERE
    month = 3 AND
    default_banner_flag = 1 AND
    loan_flag = 3
GROUP BY
    source,
    name,
    p_id
ORDER BY
    name ) as b
        ON
        a.p_id = b.p_id 
```

我得到的输出如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/c1I0r.png) 本质上，因为 FakeName #2 有一行显示实际数字（非空），我只希望 FakeName #2 出现。这意味着我还想要 FakeName #2 的空行。但是，由于 FakeName #1 和 #3 有 2 个空行，我不需要它们显示。什么类型的 SQL 命令（或对我的查询进行编辑）可以完成此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:30:49.453

`UNION`首先，如果我正确阅读了您的查询，您可以使用`CASE`and消除对 a 的需要`IN`。你也有几个 bogus`DISTINCT`在那里（因为你`GROUP BY`无论如何都在使用）。这给出了：

```
SELECT DISTINCT
    a.source,
    a.p_id,
    a.name,
    b.prod_count,
    b.prod_amt,
    Case When default_banner_flag = 0 Then 'Def' Else 'Other' End as prod_type
FROM
    dwh.attribution_product_count a
LEFT OUTER JOIN
    (
    SELECT
        source,
        p_id,
        name,
        default_banner_flag,
        sum(acct_count) as prod_count,
        sum(acct_amt) as prod_amt
    FROM
        dwh.prod_count
    WHERE
        month = 3 AND
        default_banner_flag in (0, 1) AND
        loan_flag = 3
    GROUP BY
        source,
        name,
        p_id,
        default_banner_flag
) as b
ON
a.p_id = b.p_id 
```

但是，您真正想要的是有关`p_id`在 中至少有一行的 s 的信息`dwh.prod_count`，因此我认为您可以更改整个查询以将其用作子选择：

```
SELECT
    a.source,
    a.p_id,
    a.name,
    sum(acct_count) as prod_count,
    sum(acct_amt) as prod_amt,
    Case When default_banner_flag = 0 Then 'Def' Else 'Other' End as prod_type
FROM
    dwh.attribution_product_count a
LEFT OUTER JOIN
    dwh.prod_count b
    On a.p_id = b.p_id
INNER JOIN
    (
    SELECT DISTINCT
        p_id
    FROM
        dwh.prod_count
    WHERE
        month = 3 AND
        default_banner_flag in (0, 1) AND
        loan_flag = 3
    ) as c
    ON a.p_id = c.p_id
WHERE
    month = 3 AND
    default_banner_flag in (0, 1) AND
    loan_flag = 3 
```

（您也可以将其重写为 a`WHERE p_id IN ( sub-select )`或稍作`WHERE EXISTS ( ... )`修改，但这似乎是最容易演示的版本。）

请注意，我实际上没有测试任何这些查询，但我认为它们在逻辑上是合理的。

# php - 西里尔文 PHP 和 Node.JS 中 sha1 哈希值的差异

> ID：16201155
> 
> 赞同：2
> 
> 时间：2013-04-24T20:04:25.073
> 
> 标签：php, node.js, sha

如果我尝试从“ABC”获取 sha1，它们在 PHP 和 Node.JS 中是相同的。

```
function sha1(input) {
  return crypto.createHash('sha1').update(input).digest('hex');
}; 
```

但是，如果我尝试对像这样的西里尔字母进行散列：“ЭЮЯЁ”，它们不是。

如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:26:04.873

问题可能是[字符集/编码不匹配](http://nodejs.org/api/crypto.html#crypto_hash_update_data_input_encoding)。

如果 PHP 中的字符串是 UTF-8 编码的，您可以通过指定在 Node.js 中进行镜像`'utf8'`：

```
function sha1(input) {
  return crypto.createHash('sha1').update(input, 'utf8').digest('hex');
}; 
```

```
> crypto.createHash('sha1').update('ЭЮЯЁ').digest('hex')
'da7f63ac9a3b5c67c8920871145cb5904f3df29a' 
```

```
> crypto.createHash('sha1').update('ЭЮЯЁ', 'utf8').digest('hex')
'f78c3521413a8321231e35665f8c4a16550e182a' 
```

`'ABC'`将有更好的匹配机会，因为这些都是[ASCII](http://en.wikipedia.org/wiki/ASCII)字符，而 ASCII 是许多其他字符集的起点。当您超越 ASCII 时，您会更经常地遇到冲突。

# python - 计算一个数字在达到 1 之前可以减半的次数

> ID：16201165
> 
> 赞同：-3
> 
> 时间：2013-04-24T20:04:46.867
> 
> 标签：python

问题是编写一个函数，告诉在达到 1 之前 'n' 可以减半的次数。我一直在努力使这段代码工作，但它不起作用。我以为我有这个，但是当我尝试用神秘（4）或其他任何东西测试它时，它总是返回 0。有人可以告诉我需要修复什么。这是我所拥有的：

```
def mystery(n):
    count = 0
    while n > 0
      if n//2 > 1:
         count = count + 1
    print (count) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:07:54.100

问题是您没有修改 n 的值。尝试：

```
def mystery(n):
    count = 0
    while n > 1:
        n = n // 2
        count += 1
    return count 
```

（未经测试）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:08:56.697

对不起，我是个聪明人；）

```
from math import log, ceil
def mystery(n):
  return ceil(log(n, 2)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:11:39.910

一旦你修复了已经做出的评论，你的代码将永远运行的原因是你有一个`while n>0`. 由于您通过`n/2`此更新的每次迭代都不会是负数！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:13:00.320

```
def mystery (n):
    count = 0
    while n > 1:
        n = n / 2
        count = count + 1
    if n == 1:
        return count
    return 0 
```

# knockout.js - Knockout.js 自动保存表单

> ID：16201174
> 
> 赞同：1
> 
> 时间：2013-04-24T20:05:27.310
> 
> 标签：knockout.js

我是 knockout.js 的新手。我有一个要自动保存的 html 表单，因此如果用户离开表单并返回之前输入的所有内容仍然存在。

如果无法自动保存，那么我仍然需要了解如何保存表单。

在某个地方有一个很好的例子或教程可以开始这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:55:42.340

> .....那么我仍然需要了解如何保存表单。

当用户提交表单时，html表单中的字段会保存在服务器上。如：

```
<form action="place the server path where you want to send the form data" method="post">
     Username: <input type="text" name="user">
     <input type="submit" value="Submit">
</form> 
```

**在上面的表单中，当用户按下提交按钮时，表单内的所有输入字段都会发送到服务器。您应该在表单标签的action**属性中提及要发送数据的路径。有关更多信息，[请查看此](http://www.w3schools.com/html/html_forms.asp)。

> ......所以如果用户离开表单并返回之前输入的所有内容仍然存在。

在这里，我假设用户离开表单而不点击提交按钮。因此，在这种情况下，您可以将表单数据保存在浏览器内存中。为此，您可以使用：

1）。[LocalStorage](http://www.w3schools.com/html/html5_webstorage.asp) [来自 Html5 网络存储]

2）。[从 amplifyjs](http://amplifyjs.com/api/store/) [插件]存储 api

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-02T10:58:54.837

AutoSave 依赖于 isDirty 标志，其在 KnockoutJS 中的实现自动将所需的脏文件保存到服务器并将其更新为干净。rniemeyer 在他的下面的网站上友好地解释了整个实现。它正在此处更新，因为它对我的项目有帮助，因此阅读此问题的其他任何人都知道去哪里获得完整答案。

[http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html](http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html)

以防万一，如果链接断开，这里是基本代码。

这是您的 HTML。

```
<style>
  li { padding: 2px; margin: 2px; }
  input { width: 75px; }
  .dirty { border: solid yellow 2px; }
</style>

<ul data-bind="foreach: items">
  <li data-bind="css: { dirty: dirtyFlag.isDirty }">
    <span data-bind="text: id"></span>
    <input data-bind="value: name" />
    <button data-bind="click: dirtyFlag.reset">Reset</button>
  </li>
</ul>
<button data-bind="enable: isDirty, click: save">Save</button>
<hr />
<h3>Just Dirty Items</h3>
<div data-bind="text: ko.toJSON(dirtyItems)"></div> 
```

**这是你的 JavaScript**

```
<script src="http://knockoutjs.com/downloads/knockout-2.2.0.js"></script>
<script>
ko.oneTimeDirtyFlag = function (root) {
   var _initialized;

   //one-time dirty flag that gives up its dependencies on first change
   var result = ko.computed(function () {
       if (!_initialized) {
           //just for subscriptions
           ko.toJS(root);

           //next time return true and avoid ko.toJS
           _initialized = true;

           //on initialization this flag is not dirty
           return false;
       }

       //on subsequent changes, flag is now dirty
       return true;
   });

   return result;
};

ko.dirtyFlag = function(root, isInitiallyDirty) {
    var result = function() {},
        _initialState = ko.observable(ko.toJSON(root)),
        _isInitiallyDirty = ko.observable(isInitiallyDirty);

    result.isDirty = ko.computed(function() {
        return _isInitiallyDirty() || _initialState() !== ko.toJSON(root);
    });

    result.reset = function() {
        _initialState(ko.toJSON(root));
        _isInitiallyDirty(false);
    };

    return result;
};

function Item(id, name) {
    this.id = ko.observable(id);
    this.name = ko.observable(name);
    this.dirtyFlag = new ko.dirtyFlag(this);
}

var ViewModel = function(items) {
    this.items = ko.observableArray([
        new Item(1, "one"),
        new Item(2, "two"),
        new Item(3, "three")
    ]);

    this.save = function() {
        alert("Sending changes to server: " + ko.toJSON(this.dirtyItems));  
    };

    this.dirtyItems = ko.computed(function() {
        return ko.utils.arrayFilter(this.items(), function(item) {
            return item.dirtyFlag.isDirty();
        });
    }, this);

    this.isDirty = ko.computed(function() {
        return this.dirtyItems().length > 0;
    }, this);
};

ko.applyBindings(new ViewModel());

</script> 
```

这就是它的来源。 [http://jsfiddle.net/rniemeyer/dtpfv/](http://jsfiddle.net/rniemeyer/dtpfv/)

# sql - sql server查询外连接在哪里问题

> ID：16201180
> 
> 赞同：2
> 
> 时间：2013-04-24T20:05:48.213
> 
> 标签：sql, sql-server

我有 3 个表：帖子、用户和收藏夹

```
Post
----------
PostId
Nombre
UserId
Banned

User
----------
UserId
UserName
Info

Favorites
-----------
PostId
UserId 
```

我正在尝试获取所有帖子并判断帖子是否是收藏夹，因此如果帖子不在收藏夹中，它将出现在查询中，但收藏夹标志将为假。

这是我的查询：

```
SELECT
 p.Nombre as title,
 CASE ISNULL(f.PostId,0) WHEN 0 THEN 'false' ELSE 'true' END as favorito
 FROM Post p 
 inner join User u on p.UserId = u.UserId 
 left outer join Favorite f on p.PostId = f.PostId 
 where 
 p.Banned = 0 
```

它返回所有内容，并告诉收藏夹中是否有记录，但是当我在 where 部分添加过滤器时

```
 and f.UsuarioId = 4 
```

只返回用户喜欢的帖子。不应该在使用左外连接或完全外连接时，如果辅助表中的记录不存在，则无论如何都应该返回主表中的记录？

¿如何使用辅助表上的过滤器返回所有帖子？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:11:18.433

由于您已过滤，因此通过要求具有特定值的记录`f.UsuarioId = 4`，有效地将 转换`LEFT OUTER JOIN`为。要仍然返回所有没有相关的 ，您必须在该表中测试 a ：`INNER JOIN``Favorite``Favorite``NULL`

```
SELECT
 p.Nombre as title,
 CASE ISNULL(f.PostId,0) WHEN 0 THEN 'false' ELSE 'true' END as favorito
FROM
  Post p 
  INNER JOINUser u ON p.UserId = u.UserId 
  LEFT OUTER JOIN Favorite f ON p.PostId = f.PostId 
WHERE 
 p.Banned = 0 
 -- Return either those related Favorite records for UsuarioId = 4 or the NULLs
 -- meaning a related record does not exist
 AND (f.UsuarioId = 4 OR f.UsuarioId IS NULL) 
```

# fabricjs - 如何使用fabricjs获取导入的svg文件的宽度

> ID：16201181
> 
> 赞同：0
> 
> 时间：2013-04-24T20:05:49.433
> 
> 标签：fabricjs

我正在从 Corel 导入一个 svg ... Corel 舞台很大，大约 3000x3000px。Corel 创建的 svg 在`<svg>`元素中包含舞台的 w/h：

```
<svg ... width="2479px" height="3504px" ... > 
```

我通过fabricjs将该svg导入html：

```
$("#loadSVG")
  .click( function()
            { fabric.loadSVGFromURL( gvs_svgSrc                             , 
                                     function( A , B ){ callback( A , B ) } ,
                                     function( M , N ){ reviver ( M , N ) } 
                                   );
            }); 
```

现在我想根据我的画布 w/h 与 svg w/h 之间的关系来缩放我的织物对象。

问题：如何`<svg>`使用fabricjs 获取w/h 属性？

注意：*我想我可以用 javascript/jquery 做到这一点，但我想认为面料已经存储了这些信息。*

注意：*我应该提一下，来自 Corel 的矢量形状在 fabric 的 reviver 函数中被分成许多不同的组。换句话说，他们并不都在一个组中（这将允许我查询该组的 w/h.*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T16:19:51.837

在您的回调函数（第二个参数）中，B 是一个具有 svg 画布宽度和高度属性的对象。

# html - css hover想要显示一个框

> ID：16201184
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:07.167
> 
> 标签：html, css, hover

我想创建一个菜单，每当您将鼠标悬停在菜单中的“按钮”上时，它都会显示一些文本，但是在 css 中执行此操作时会出现问题。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link type = "text/css" rel = "stylesheet" href = "home.css"/>

</head>

<body>
<div id = "menu">

<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>
<a class = "button"><span>222</span></a>

</div>
<span class = "box_menu"><p>asfqwqs</p></span>

</body>
</html> 
```

css

```
#menu {
width:70%;
height:35px;
margin:0 auto;
border-radius:0px 0px 3px 3px;
box-shadow:1px 2px 3px 2px #1F0000;
}
body{
background-color:#562500;
background:url('image_for_website.jpg') repeat;
}

a.button{
display:inline;
position:relative;
font-size:12px;
font-family:"Comic Sans MS", cursive, sans-serif;
color:white;
height:26px;

}
a.button span {
display: block;
line-height: 30px;
border-right:1px solid rgb(0,0,0);
float:left;
width:10%;
padding:3px;
} 
a.button:hover span{
background:rgba(0,0,0,0.3);
cursor: pointer;
}
a.box_menu{
position:absolute;
display:none;
width:20px;
border:1px solid #333333;
color:white;
font-size:12px;
font-family:"Comic Sans MS", cursive, sans-serif;
background:rgba(2,2,2,0.7);
margin-top:18%;
margin-left:15%;
border:1px solid white;
}
a.box_menu:hover span{
display:block;
} 
```

所以，每当我将鼠标悬停在锚类按钮的跨度上时（比如说第一个），我想要一个文本框，它本质上是一个带有 box_menu 类的跨度到 apper。那么我该怎么做呢？请帮助。提前谢谢.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:11:45.830

好吧，您实际上无法通过`<a>`使用当前 HTML 设置单个样式来实现这种效果，例如

```
.button:nth-child(1):hover + span {} 
```

不起作用，因为`<span>`当它的容器是兄弟姐妹时，这意味着它是链接`<div>`的兄弟姐妹。您显然可以在整个悬停时显示跨度文本，`<div>`但听起来您只希望一个或几个链接使用它，如果您不介意这种行为，您可以使用

```
#menu:hover + .box_menu {} 
```

[http://jsfiddle.net/RtK7M/](http://jsfiddle.net/RtK7M/)

# sql - 使用 sql (sql*plus) 从一个表复制到另一个表

> ID：16201188
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:12.733
> 
> 标签：sql, sqlplus

这很简单，我看到网站上有很多帖子，但我无法让它为我工作。

这是我想要做的事情：从表“学生”中复制数据。Student 包含三列：studentID、name 和major。

我需要将此数据复制到另一个名为“dw_student”的表中。

这是我到目前为止所拥有的：

```
INSERT INTO dw_student (studentID, name, major, studentKey)
SELECT studentID, name, major, STUDENTSEQ.nextval
FROM student 
```

Studentseq.nextval 为每一行分配一个唯一编号。到目前为止，它在我的代码中的其他地方工作。

有什么明显的我做错了吗？

这是Studentseq.nextval：

```
create sequence STUDENTSEQ increment by 1 start with 4000; 
drop table holdcounter3; 
CREATE TABLE holdcounter3 
( PKsequence3 number(5), 
 dataname1 char(4), 
 CONSTRAINT pk_sequence3 PRIMARY KEY (PKsequence3) ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:39:21.673

SQL 语法看起来不错。确保您发出 a`COMMIT`以永久保存结果。否则退出 sql*plus 时事务将被丢弃。事务不会在 sql*plus 中自动提交。

# php - 带有标题的拆分表以打印出来

> ID：16201189
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:13.027
> 
> 标签：php, javascript, jquery, mysql, printing

我正在使用 PHP 从 MySQL 读取一些数据并尝试在 a 上打印（纸质）数据，`<table>`但我需要拆分`<table>`以使每张纸仅保留 30 行，并且每张纸必须在里面有一个`<table>`我正在做的标题标头，`<thead>`但我不知道如何拆分`<table>`，因为我不知道有多少行将返回 MySQL

我试过用jQuery这样的东西（不是这个）：

```
if($('#my_table tbody tr').length > 30) {
    $('#div_page').html($('#my_table thead') + $('#my_table').slice(0 , 30));
} 
```

这只需要从第 0 行到第 30 行，所以如果我再次这样做，它需要从第 31 行到第 60 行（对于 jQuery，前 30 行现在不存在，因为它已打印到文档中）所以脚本需要 30 x 30原始行`<table>`

但我不知道如何让 jQuery 重复该脚本，直到所有行都被打印出来

我不在乎它是否必须使用 jQuery、PHP、JavaScript 或其他语言来完成，但我需要的是它能够正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:11:31.033

将您的 if 语句包装在一段时间内，以测试长度是否大于 0。然后使用 else 来获取最后的剩余行。

```
while ($('#my_table tbody tr').length > 0) {
    if($('#my_table tbody tr').length > 30) {
        $('#div_page').html($('#my_table thead') + $('#my_table').slice(0 , 30));
    }
    else {
    //handle rows less than 30 if its the last iteration
    }
} 
```

# mysql - Hibernate 不会插入数据库

> ID：16201191
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:27.110
> 
> 标签：mysql, hibernate, insert

现在我有一个非常奇怪的问题，我无法理解。

我已经正确配置了休眠。我可以毫无问题地从我的 mysql 数据库加载数据。但我无法插入数据。这是我的 hibernate.cfg.xml：

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD//EN"
"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
<session-factory>
<property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
<property name="hibernate.connection.url">jdbc:mysql://localhost:3306/bookmaker</property>
<property name="hibernate.connection.username">root</property>
<property name="hibernate.connection.password">password</property>
<property name="hibernate.connection.pool_size">10</property>
<property name="show_sql">true</property>
<property name="dialect">org.hibernate.dialect.MySQLDialect</property>
<property name="hibernate.current_session_context_class">thread</property>
<property name="javax.persistence.validation.mode">none</property>

<mapping class="de.wettprofi.objects.Bookmaker"/>
<mapping class="de.wettprofi.objects.Match"/>
<mapping class="de.wettprofi.objects.LogEntry"/>

</session-factory>
</hibernate-configuration> 
```

这是关于 LogEntry 类的。这是一些应该将对象保存到数据库中的代码：

```
public void doPost( HttpServletRequest request, HttpServletResponse response ) throws ServletException, IOException
    {
        BufferedReader reader = request.getReader();
        String json = reader.readLine();

        try {
            LogEntry log_entry = null;

            if (json != null && !json.isEmpty()) {
                log_entry = new LogEntry();

                JSONParser parser = new JSONParser();
                JSONObject json_dict = (JSONObject) parser.parse( json );

                //initalize proper LogEntry object
            } 
            if( log_entry != null ) {
                Session session = get_hibernate_session();
                System.out.println("Logging of LogEntry into the database\n" + log_entry.toString() );
                session.save( log_entry );
                session.flush();
                System.out.println("Logging DONE");
            }

        } catch( Exception e ) {
            e.printStackTrace();
        }
    }

    public Session get_hibernate_session()
    {
        //Opening a hibernate session
        SessionFactory sessionFactory = null;
        try {
            Configuration hibConfiguration = new Configuration().addResource("hibernate.cfg.xml").configure();       
            ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(hibConfiguration.getProperties()).buildServiceRegistry();
            sessionFactory = hibConfiguration.buildSessionFactory(serviceRegistry);
        } catch( Exception e ) {
            e.printStackTrace();
        }

        return sessionFactory.withOptions().openSession();
    } 
```

这就是 LogEntry 类对象的样子（省略了 getter 和 setter）：

```
@Entity
@Table( name = "LogEntries" )
public class LogEntry {

    public static int MESSAGE = 1;
    public static int BOOKMAKER = 2;
    public static int CLICKLOG = 3;

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column( name = "lid" )
    public int lid;

    @Column( name = "id" )
    public String id;

    @Column( name = "date" )
    public Date date;

    @Column( name = "type" )
    public int type;

    @Column( name = "message" )
    public String message;

    @Column( name = "bookmaker" )
    public String bookmaker;

    @Column( name = "match_id" )
    public int match_id;

    @Column( name = "result" )
    public String result;

    public String toString()
    {
        StringBuffer sb = new StringBuffer();
        sb.append("      lid = " + lid  + "\n");
        sb.append("       id = " + id  + "\n");
        sb.append("     date = " + date.toString()  + "\n");
        sb.append("     type = " + type  + "\n");
        sb.append("  message = " + message  + "\n");
        sb.append("bookmaker = " + bookmaker  + "\n");
        sb.append(" match_id = " + match_id  + "\n");
        sb.append("   result = " + result  + "\n");
        return sb.toString();
    } 
```

因此，当我现在运行我的 tomcat 实例并查看发生了什么时，我得到以下输出：

```
INFO: HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
Apr 24, 2013 9:55:18 PM org.hibernate.engine.transaction.internal.TransactionFactoryInitiator initiateService
INFO: HHH000399: Using default transaction strategy (direct JDBC transactions)
Apr 24, 2013 9:55:18 PM org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory <init>
INFO: HHH000397: Using ASTQueryTranslatorFactory
Logging of LogEntry into the database
      lid = 0
       id = 50569803719166097161
     date = Mon Apr 22 21:01:53 CEST 2013
     type = 1
  message = MainVC
bookmaker = null
 match_id = 0
   result = null

Hibernate: insert into LogEntries (bookmaker, date, id, match_id, message, result, type) values (?, ?, ?, ?, ?, ?, ?)
Logging DONE 
```

但是，在查看我的数据库之后，发现表中没有任何内容。

这是我的表架构：

```
mysql> describe LogEntries;
+-----------+--------------+------+-----+---------+----------------+
| Field     | Type         | Null | Key | Default | Extra          |
+-----------+--------------+------+-----+---------+----------------+
| lid       | int(11)      | NO   | PRI | NULL    | auto_increment |
| bookmaker | varchar(255) | YES  |     | NULL    |                |
| date      | datetime     | YES  |     | NULL    |                |
| id        | varchar(255) | YES  |     | NULL    |                |
| match_id  | int(11)      | YES  |     | NULL    |                |
| message   | varchar(255) | YES  |     | NULL    |                |
| result    | varchar(255) | YES  |     | NULL    |                |
| type      | int(11)      | YES  |     | NULL    |                |
+-----------+--------------+------+-----+---------+----------------+
8 rows in set (0.00 sec) 
```

有没有人知道什么可能导致这个麻烦。我一无所知:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:12:20.980

您需要根据 Hibernate 文档为每个属性[声明 get/set 对。](http://docs.jboss.org/hibernate/orm/3.3/reference/en-US/html/persistent-classes.html)这些方法可以是公共的、受保护的或私有的，但它们必须存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:53:47.470

实体类应该具有属性的 getter 和 setter。

在您获得会话之后，您需要开始您的交易。

[http://docs.jboss.org/hibernate/orm/3.5/javadoc/org/hibernate/Session.html](http://docs.jboss.org/hibernate/orm/3.5/javadoc/org/hibernate/Session.html)

```
Session sess = factory.openSession();
 Transaction tx;
 try {
     tx = sess.beginTransaction();
     //do some work
     ...
     sess.save(entityObjectToBeinserted);
     tx.commit();
 }
 catch (Exception e) {
     if (tx!=null) tx.rollback();
     throw e;
 }
 finally {
     sess.close();
 } 
```

# java - 使用 HTTP POST 时，Solr 查询字符串是否有大小或期限限制？

> ID：16201195
> 
> 赞同：18
> 
> 时间：2013-04-24T20:06:40.033
> 
> 标签：java, solr, http-post

我正在使用 Java 向 Solr 服务器查询具有我感兴趣的一组已知 ID 中的 ID 的结果。

我认为获得我感兴趣的这些结果的最佳方法是创建一个长查询字符串，如下所示：

`q=(item_id:XXX33-3333 OR item_id:YYY42-3445 OR item_id:JFDE-3838)`

我在提出请求之前生成了这个字符串，`queryString`并且我最终想要提出的请求中包含超过 1500 个这样的 id。我正在使用 HTTP POST 来进行这样的查询：

```
 HttpPost post = new HttpPost(url);
        post.setHeader("Content-Type", "application/x-www-form-urlencoded; charset=utf-8");

        StringEntity entity = new StringEntity(queryString, "UTF-8");
        entity.setContentType("application/x-www-form-urlencoded; charset=utf-8");
        post.setEntity(entity);

        HttpClient client = new DefaultHttpClient();
        HttpResponse response = client.execute(post); 
```

如果我将查询限制为前 1000 个 id，它会成功并且我会按预期返回结果。但是，如果我增加查询以包含我真正感兴趣的所有 1500，我会得到一个 HTTP 400 响应代码，并带有以下错误：

`HTTP/1.1 400 org.apache.lucene.queryParser.ParseException: Cannot parse '[my query here...]`

在 Solr 查询中我可以 OR 一起的 id 数量是否有限制？当我超过 1000 时，还有其他原因可能会失败吗？我已经尝试过了，它在 1024 左右失败（我的 id 长度几乎都一样），所以这似乎表明存在字符或期限限制。

或者，如果有人对我如何以另一种更智能的方式检索我正在寻找的项目有很好的建议，我很想听听。我的备份解决方案只是查询 Solr 的*所有*项目，解析结果，并使用属于我感兴趣的集合的那些。我不想这样做，因为数据源可能有数万个项目，这将是低效的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-25T02:49:06.323

Solr 方面没有限制——我们经常以类似的方式使用 Solr，查询中有数万个 ID。

您需要查看 servlet 容器（Tomcat、Jetty 等）的设置并增加最大 POST 大小。查找`maxPostSize`您是否使用 Tomcat 以及`maxFormContentSize`是否使用 Jetty。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-28T12:17:06.683

从 Solr 6.0 开始，Solr 中有一个`maxBooleanClauses`配置 - 默认为 1024。

我编写了一个单元测试来确认和确认限制（使用 Solr 5.3）。

在此处查看更多信息[https://wiki.apache.org/solr/SolrConfigXml#The_Query_Section](https://wiki.apache.org/solr/SolrConfigXml#The_Query_Section)

FWIW 有一个开放的 Solr JIRA 可以将其删除，因此将来可能会被删除 [https://issues.apache.org/jira/browse/SOLR-4586](https://issues.apache.org/jira/browse/SOLR-4586)

# compilation - 尝试在 minix3 中编译

> ID：16201199
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:44.650
> 
> 标签：compilation, compiler-errors, system-calls, minix

我在 VMware Player 上使用 minix3，但在编译系统调用时遇到问题。我实际上试图看看我是否可以在系统调用中添加一个简单的命令来查看它的工作情况，然后我在它所在的文件中`printf("my message");`放置了一个简单的命令。`protect.c``usr/src/servers/vfs`

`make`我保存了它，并在我位于 vfs 目录时尝试使用命令对其进行编译。它说这`protect.c`是最新的。

我尝试更改文件的所有者（`protect.c`其中包含 chown 模式代码），结果我正在等待我的消息。相反，它只是正确运行命令而不打印我的消息。

我认为我在编译时做错了，我在互联网上搜索了几个小时试图修复它。但唯一反复传来的命令是`make hdboot`。我知道这个命令不起作用，因为我使用 minix3 作为虚拟操作系统，但我尝试它只是为了确认它，正如我所说的那样不起作用。

有人知道在minix3中编译吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T00:24:22.573

如果您的问题确实与编译有关并且您已经正确实现了系统调用，那么在 /usr/src 中进行任何编辑后，您应该从 /usr/src/releasetools 调用“make install”，然后调用“rebo​​ot”重新启动 minix

# javascript - Struts 1 在jsp中使用显示标签删除确认

> ID：16201201
> 
> 赞同：1
> 
> 时间：2013-04-24T20:06:50.890
> 
> 标签：javascript, html, jsp, struts, displaytag

一旦用户单击显示：列中的删除按钮，我试图显示删除确认框。我有要显示的对话框，但是一旦用户确认他要删除该操作就不会被调用。该页面只是重新加载而不删除该行。如果没有删除确认，该行将被成功删除。我在确认时做错了什么。任何帮助将不胜感激，谢谢

我现在拥有的是：

jQuery：

```
$(".btnShowDeleteConfirmation").click(function (e)
          {
             ShowDialog(true);
             e.preventDefault();
          });

          $("#btnClose, #btnNo").click(function (e)
          {
             HideDialog();
             e.preventDefault();
          });

          $("#btnYes").click(function (e)
          {

            }); 
```

Javascript：

```
 function deleteEntry(rowId)
  {
    document.getElementById('rowId').value=rowId;
    document.forms['myForm'].action='/myAction/deleteAction.action?method=deleteRow';
    document.forms['myForm'].submit;       
  } 
```

显示标签表：

```
<form action="" method="POST" id="mainForm" name="MyFormBean">

<display:table requestURIcontext="true"  requestURI="/unavailability/loadUnavailability.action?method=loadForm" uid="myList" name="requestScope.unavailList" class="simple" pagesize="10" defaultsort="2" sort="list"  cellspacing="0" excludedParams="*">    

<display:column  property="startDate" title="Start Date" width="18%"   decorator="com.mhngs.util.DisplayTagDateWrapper" sortable="true" headerClass="sortable"/>
<display:column  property="endDate" title="End Date" width="18%"  decorator="com.mhngs.util.DisplayTagDateWrapper" sortable="true" headerClass="sortable" />
<display:column  property="reason" title="Comments" width="30%" sortable="true" headerClass="sortable" />   

<display:column media="html" width="10%" class="btnShowDeleteConfirmation">
<a href="#">Delete</a>
</display:column>

</display:table> 
<input type="hidden" name="rowId" id="rowId" />
</form> 
```

HTML：一旦用户单击删除按钮，就会显示此内容

```
<div id="overlay" class="delete_overlay"></div>

        <div id="dialog_delete" class="delete_overlay">
        <form method="post" action="">  
            <table style="width: 100%; border: 0px;" cellpadding="3" cellspacing="0">
                 <tr>
                    <td class="web_dialog_title">Delete Row Confirmation</td>
                    <td class="web_dialog_title align_right"><a href="#" id="btnClose">Close</a></td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-left: 15px;">
                        <label>You seleted a row to be deleted</label>
                    </td>
                </tr>
          <tr>
             <td>&nbsp;</td>
             <td>&nbsp;</td>
          </tr>
          <tr>
             <td colspan="2" style="text-align: center;">
                <input id="btnYes" type="submit" value="Yes" onClick="javascript:deleteEntry('<c:out  value="${myList.rowId}"/>')"/>
                <input id="btnNo" type="button" value="No" />
             </td>
             </tr>
             </table>
        </form>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:24:55.210

您尚未在 html 中指定表单名称。您在表单标签中哪里提到了“myForm”名称？

```
<form name="myForm" .. > 
```

# iphone - UIScrollView 中 UIView 的 CAShapeLayer 子层非常慢

> ID：16201203
> 
> 赞同：1
> 
> 时间：2013-04-24T20:06:54.393
> 
> 标签：iphone, ios, cocoa-touch, quartz-core, cashapelayer

我有一个自定义 UIView，它应该是一个圆形矩形，当您开始在其中编辑 UILabel 时，圆形矩形将增长其形状（CAShapeLayer 蒙版路径和轮廓路径上的 CABasic 动画）。所以要清楚，自定义 UIView 是这样组织的：

MyCustomView 有一个 ClipView。ClipView 使用 drawRect 绘制圆角矩形的背景。（clipview == 被剪辑的视图）

然后，我调用以下代码来执行 CAShapeLayer 操作：

```
//0\. CLIP

shapeLayer = [CAShapeLayer layer];
CGRect shapeRect = self.bounds;
[shapeLayer setBounds:shapeRect];
[shapeLayer setPosition:CGPointMake((shapeRect.size.width)/2.0f, (shapeRect.size.height)/2.0f)];
[shapeLayer setFillColor:[[UIColor colorWithRed:0 green:1 blue:0 alpha:1.0f] CGColor]];
[shapeLayer setStrokeColor:[[UIColor redColor] CGColor] ];
[shapeLayer setLineWidth:1];
[shapeLayer setLineJoin:kCALineJoinRound];
[shapeLayer setOpacity:1];

CGRect shapeLayerPathRect = CGRectMake(0, 0, self.bounds.size.width, 44.0f);
shapeLayer.path = [self roundRectPathForRectangle:shapeLayerPathRect andRadius:CORNER_RADIUS];
[[self.clipView layer] setMask:shapeLayer];

//1\. draw the shaded outline of a round rectangle
outlineLayer = [self topDownShadowShapeLayer]; //setup for my CAShapeLayer, involving shadow stuff, line color, etc
outlineLayer.path = [self roundRectPathForRectangle:shapeLayerPathRect andRadius:CORNER_RADIUS];
[self.clipView.layer addSublayer:outlineLayer]; 
```

虽然动画收益是最快的方法（拉伸两个 CAShapeLayers），但整个元素（MyCustomView）导致一切都变慢了！例如，持续的 UIView 动画，当 MyCustomView 在 ScrollView 中时，它也非常跳跃。

我最关心的是 UIScrollView 问题。为什么 UIScrollView 翻译这些图层会如此不稳定？有没有好的解决方案/可以达到相同效果的另一种方法是什么？

# scala - 如何使用 CSS 绑定向我的 Lift 表单添加 onsubmit 或 onclick 验证逻辑？

> ID：16201205
> 
> 赞同：0
> 
> 时间：2013-04-24T20:06:57.670
> 
> 标签：scala, lift

我有一个使用 CSS 选择器绑定和 Scala 端验证的表单。现在我想通过我自己调用的 jQuery 代码或 JsIf 等内置命令添加 javascript 验证。

这是我当前的代码：

```
def create = {
    "#description" #> SHtml.textarea(maintRV.is.description.get,
        name => maintRV.is.description(name) ) &
    "#submit" #> SHtml.onSubmitUnit(processSubmit)
} 
```

如何将 onclick 或 onsubmit 行为添加到 SHtml.onSubmitUnit 绑定？我已经在我的代码的其他部分使用了 Ajax 表单，但是对于这个页面来说，这似乎有点过头了。我不介意提交常规表单。我只想添加客户端验证。

我已经梳理了 SimplyLift、Exploring Lift 和这些团体，但找不到它。

# java - 创建一个对象，然后将其从 Intent 中传回的数据添加到 ArrayList

> ID：16201206
> 
> 赞同：2
> 
> 时间：2013-04-24T20:07:02.203
> 
> 标签：java, android, android-intent, arraylist

大致了解我想要做什么：我有一个名为 Events 的类，它将包含一个日期对象、一些字符串和一些布尔值。我使用在 DiaryMain.java 中调用 startActivityForResult 时传回的数据创建它。我想把那个对象放入一个名为 Diary 的 ArrayList 中。我得到一个`NullPointer Exception(DiaryMain.java:111)`，这`diary.add(new Event(date, lengthOfEvent, typeOfEvent, trigger, notes, amb_called, amb_needed, awake));`是`DiaryMain.onActivityResult()`. 我已经包含了 DiaryMain.java、DiaryEventCreate.java 和 Event.java 的相关代码。我没有正确地将数据传递回 DiaryMain 还是我的 ArrayList 没有正确初始化？

谢谢您的帮助。

DiaryMain.java - 我的应用程序的主要活动

```
package org.daringer.EpApp;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.GregorianCalendar;

import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentTransaction;
import android.widget.Toast;

import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.SherlockFragment;
import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;

public class DiaryMain extends SherlockFragmentActivity {

public static Context appContext;
public ArrayList<Event> diary;
...

public boolean onOptionsItemSelected(MenuItem item){
    switch(item.getItemId()){
    ...
    case R.id.menu_add_event:{
        makeToast("add event");
        Intent i = new Intent(DiaryMain.this,DiaryEventCreate.class);
        startActivityForResult(i, 0);
        break;
    }
    }
    return true;
}

/* (non-Javadoc)
 * @see android.support.v4.app.FragmentActivity#onActivityResult(int, int, android.content.Intent)
 */
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    if(resultCode == RESULT_OK){
        if(requestCode == 0){ //new event [add this event to the end of the diary]
            String notes, lengthOfEvent, typeOfEvent, trigger;
            boolean amb_called, amb_needed, awake; 
            GregorianCalendar date;
            makeToast("CREATED NEW EVENT");
            date = (GregorianCalendar) data.getSerializableExtra("date");
            notes = data.getStringExtra("notes").toString();
            lengthOfEvent = data.getStringExtra("lengthOfEvent").toString();
            typeOfEvent = data.getStringExtra("typeOfEvent").toString();
            trigger = data.getStringExtra("trigger").toString();
            amb_called = data.getBooleanExtra("amb_called", false);
            amb_needed = data.getBooleanExtra("amb_needed", false);
            awake = data.getBooleanExtra("awake", false);
            diary.add(new Event(date, lengthOfEvent, typeOfEvent, trigger, notes, amb_called, amb_needed, awake));

        }
        else if(requestCode == 1){ //edit event [HAVE TO REFERENCE THE EVENTS INDEX]

        }
    }
    super.onActivityResult(requestCode, resultCode, data);
}

} 
```

DiaryEventCreate.java - 接受输入并将其发送回 DiaryMain.java 的活动

```
package org.daringer.EpApp;

import java.util.GregorianCalendar;

import net.kapati.widgets.DatePicker;

import android.content.Intent;
import android.os.Bundle;
import android.text.format.DateFormat;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.Toast;

import com.actionbarsherlock.app.SherlockActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;

public class DiaryEventCreate extends SherlockActivity{

private GregorianCalendar date;
private String lengthOfEvent;
private String typeOfEvent;
private String trigger;
private String notes;
private boolean amb_called;
private boolean amb_needed;
private boolean awake;
private DatePicker ETDate;
private EditText ELength;
private EditText EType;
private EditText ETrigger;
private EditText ENotes;
private CheckBox EAmbCalled;
private CheckBox EAmbNeeded;
private CheckBox EAwake;

private void saveEvent(){

    int   day  = ETDate.getDay();
    int   month= ETDate.getMonth()+1;
    int   year = ETDate.getYear();

    date = new GregorianCalendar(year, month, day);
    makeToast("Saving event...");
    lengthOfEvent = ELength.getText().toString();
    typeOfEvent = EType.getText().toString();
    trigger = ETrigger.getText().toString();
    notes = ENotes.getText().toString();
    amb_called = EAmbCalled.isChecked();
    amb_needed = EAmbNeeded.isChecked();
    awake = EAwake.isChecked();

    if(isInteger(lengthOfEvent)){
        int len = Integer.parseInt(lengthOfEvent);
        if(len>0){
            Intent i = getIntent();
            i.putExtra("lengthOfEvent", lengthOfEvent);
            i.putExtra("date", date);
            i.putExtra("typeOfEvent", typeOfEvent);
            i.putExtra("trigger", trigger);
            i.putExtra("notes", notes);
            i.putExtra("amb_called", amb_called);
            i.putExtra("amb_needed", amb_needed);
            i.putExtra("awake", awake);
            setResult(RESULT_OK, i);
            finish();
        }
        else
            makeToast("Length of event cannot less than 0");
    }
    else{
        makeToast("Length of Event is not an integer");
    }   
}

public boolean onOptionsItemSelected(MenuItem item){
    switch(item.getItemId()){
    ...
    case R.id.event_discard:{
        makeToast("Discarding all entries...");
        finish();
        break;
    }
    case R.id.event_save:{
        saveEvent();
        break;
    }
    }
    return true;
}

public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.diary_create_event_menu, menu);
    return super.onCreateOptionsMenu(menu);
}
} 
```

事件.java

```
package org.daringer.EpApp;

import java.util.GregorianCalendar;

public class Event{
private GregorianCalendar date;
private String lengthOfEvent;
private String typeOfEvent;
private String trigger;
private String notes;
private boolean amb_called;
private boolean amb_needed;
private boolean awake;

public Event(GregorianCalendar date, String lengthOfEvent, String typeOfEvent, String trigger, String notes, boolean amb_called, boolean amb_needed, boolean awake){
    this.date = date;
    this.lengthOfEvent = lengthOfEvent;
    this.typeOfEvent = typeOfEvent;
    this.trigger = trigger;
    this.notes = notes;
    this.amb_called = amb_called;
    this.amb_needed = amb_needed;
    this.awake = awake;
}

/**
 * @return the amb_called
 */
public boolean isAmb_called() {
    return amb_called;
}

/**
 * @param amb_called the amb_called to set
 */
public void setAmb_called(boolean amb_called) {
    this.amb_called = amb_called;
}

/**
 * @return the amb_needed
 */
public boolean isAmb_needed() {
    return amb_needed;
}

/**
 * @param amb_needed the amb_needed to set
 */
public void setAmb_needed(boolean amb_needed) {
    this.amb_needed = amb_needed;
}

/**
 * @return the awake
 */
public boolean isAwake() {
    return awake;
}

/**
 * @param awake the awake to set
 */
public void setAwake(boolean awake) {
    this.awake = awake;
}

/**
 * @return the date
 */
public GregorianCalendar getDate() {
    return date;
}

/**
 * @param date the date to set
 */
public void setDate(GregorianCalendar date) {
    this.date = date;
}

/**
 * @return the lengthOfEvent
 */
public String getLengthOfEvent() {
    return lengthOfEvent;
}

/**
 * @param lengthOfEvent the lengthOfEvent to set
 */
public void setLengthOfEvent(String lengthOfEvent) {
    this.lengthOfEvent = lengthOfEvent;
}

/**
 * @return the typeOfEvent
 */
public String getTypeOfEvent() {
    return typeOfEvent;
}

/**
 * @param typeOfEvent the typeOfEvent to set
 */
public void setTypeOfEvent(String typeOfEvent) {
    this.typeOfEvent = typeOfEvent;
}

/**
 * @return the trigger
 */
public String getTrigger() {
    return trigger;
}

/**
 * @param trigger the trigger to set
 */
public void setTrigger(String trigger) {
    this.trigger = trigger;
}

/**
 * @return the notes
 */
public String getNotes() {
    return notes;
}

/**
 * @param notes the notes to set
 */
public void setNotes(String notes) {
    this.notes = notes;
}
} 
```

日志猫

```
04-24 14:38:45.978: E/AndroidRuntime(6137): FATAL EXCEPTION: main
04-24 14:38:45.978: E/AndroidRuntime(6137): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=0, result=-1, data=Intent { cmp=org.daringer.EpApp/.DiaryEventCreate (has extras) }} to activity {org.daringer.EpApp/org.daringer.EpApp.DiaryMain}: java.lang.NullPointerException
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3319)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:3362)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread.access$1100(ActivityThread.java:141)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1282)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.os.Looper.loop(Looper.java:137)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at java.lang.reflect.Method.invokeNative(Native Method)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at java.lang.reflect.Method.invoke(Method.java:511)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at dalvik.system.NativeStart.main(Native Method)
04-24 14:38:45.978: E/AndroidRuntime(6137): Caused by: java.lang.NullPointerException
04-24 14:38:45.978: E/AndroidRuntime(6137):     at org.daringer.EpApp.DiaryMain.onActivityResult(DiaryMain.java:111)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.Activity.dispatchActivityResult(Activity.java:5293)
04-24 14:38:45.978: E/AndroidRuntime(6137):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3315)
04-24 14:38:45.978: E/AndroidRuntime(6137):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:11:29.680

在您的代码中，我看不到您在哪里进行了初始化`diary`，因此 Java`null`为您初始化了它。您必须创建`ArrayList`：

```
public ArrayList<Event> diary = new ArrayList<Event>(); 
```

# javascript - KendoUI Datasoure Fetch 函数追加到数组

> ID：16201207
> 
> 赞同：2
> 
> 时间：2013-04-24T20:07:04.880
> 
> 标签：javascript, kendo-ui

我有一些代码正在尝试演变成更复杂的代码，但是由于某种原因，我什至无法将其附加到我当前的数组中。如果我使用 console.log 那么它将输出所需的数据。这是代码...

```
var p = [];
DataSource.fetch(function () {
    var item = CREAInfo.SiteSelector.DataSource.at(0);
    p.push(item.Phase); 
}); 
```

无论出于何种原因，数组'p'仍然是空的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T21:21:37.047

你几乎肯定会遇到某种比赛条件。如果没有更广泛的上下文来说明您发布的代码片段是如何执行的，就不可能更具体。为了证明这个假设，请尝试对您要推送到阵列的项目执行 console.log，然后在将其推送到阵列后，执行 console.log `p.length`。

假设该项目确实被正确推动，有两种可能性可以解释该行为。

1) 检查数组的代码在填充数组的回调执行之前执行。

2) 另一段代码在回调执行后、检查之前清空数组。

# jquery - 旋钮多重值不起作用

> ID：16201208
> 
> 赞同：0
> 
> 时间：2013-04-24T20:07:05.160
> 
> 标签：jquery, jquery-animate, jquery-knob

我正在使用 jQuery 1.8 和[aterrien 的 jQuery-Knob](https://github.com/aterrien/jQuery-Knob/)

我通过输入动画制作了一个圆圈，并通过`rel`属性管理值。检查以下代码：

```
<input class="knob" data-readOnly=true type="text" data-width="100" data-bgColor="#e0e0e0" data-thickness=".4" rel="75" value="0"> 
```

[您可以在http://jsfiddle.net/itskawsar/U72TB/](http://jsfiddle.net/itskawsar/U72TB/)检查工作小提琴

但是我需要在一页中有多个圆圈，每个圆圈都有不同的值。所以我只是多次复制输入字段，并更改了每个字段的值。但是这次它在不改变圆值的情况下运行良好。

例如，我有 3 个输入，每个输入都有 20、35、95 的`rel`属性。现在，当我运行脚本时，脚本使所有 3 个圆圈都带有动画并填充 20。但它应该填充 20、35 和 95。请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:11:55.287

将您的代码放在 .each 函数中，如下所示：

```
var myColor = 'rgba(41,100,159,.5)';

$('.knob').each(function(){

    var self = $(this);

    self.knob({
        'fgColor': myColor,
    });

    if(self.val() == 0)
    {   
        $({value: 0}).animate({value: parseInt(self.attr("rel"))}, {
            duration: 2000,
            easing:'swing',
            step: function()
            {
                self.val(Math.ceil(this.value)).trigger('change');
                self.val(self.val() + '%');
            }
        })
    }
}); 
```

小提琴：http: [//jsfiddle.net/frostyterrier/wMQnk/1/](http://jsfiddle.net/frostyterrier/wMQnk/1/)

在您的示例中，它仅获取第一个输入字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:12:19.730

像这样改变你的js：

```
var myColor = 'rgba(41,100,159,.5)';
$(".knob").knob({
    'fgColor' : myColor,
});
$('.knob').each(function() {
    var dis = this;
    if ($(dis).val() == 0) {
        $({
            value : 0
        }).animate({
            value : parseInt($(dis).attr("rel"))
        }, {
            duration : 2000,
            easing : 'swing',
            step : function() {
                $(dis).val(Math.ceil(this.value)).trigger('change');
                $(dis).val($(dis).val() + '%');
            }
        })
    }
}); 
```

# iphone - iPhone Safari - 重定向错误过多

> ID：16201209
> 
> 赞同：0
> 
> 时间：2013-04-24T20:07:07.473
> 
> 标签：iphone, wordpress, .htaccess, safari, mobile-safari

我有一个客户，她目前在她的 iPhone 4 上从 Safari 收到“重定向过多”错误。我已经在其他 iPhone 上进行了测试，包括 4，但没有收到此错误。有这方面的经验吗？这是一个由 Go-Daddy 托管的 wordpress 站点。我在 HTACCESS 文件中添加了一些内容，但没有什么疯狂的。

我知道她可能能够通过清除浏览器的 cookie 来解决问题，但如果这是一个可能影响其他 iPhone 用户的问题并且是由我的某些事情引起的，我想防止该问题发生在未来..

有什么建议么？

*编辑*这里是htaccess：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress

Redirect 301 /Testimonials.html /testimonials/
Redirect 301 /Wedding_Accessories.html /dyeable-shoes-bride-on-a-budget/
Redirect 301 /Wedding_Shoes_Styles.php /shoes/
Redirect 301 /Custom_Shoes.html /custom-shoes/
Redirect 301 /Custom_Wedding_Sashes.php /custom-sashes/
Redirect 301 /Wedding_Album.php /gallery/
Redirect 301 /Customizable_shoe_styles.php /custom-shoes/
Redirect 301 /Home_Page.html /
Redirect 301 /Custom_Shoe_Inquiry.html /custom-shoes/
Redirect 301 /comments/feed/ /
Redirect 301 /Etsy_Shop.html /shoes/
Redirect 301 /about/terms/ /terms-and-conditions/
Redirect 301 /Dyeable_Shoes.html /shoes/
Redirect 301 /about/privacy/ /example-privacy-policy/
Redirect 301 /faqs/ /FAQs/
Redirect 301 /ShoeNews.html /blog/
Redirect 301 /About_Us.html /about-us/

# BEGIN wtwp_cache
# END wtwp_cache

# BEGIN wtwp_security
# END wtwp_security 
```

# python - .NET 在 Python 中是否有 **kwargs 的等价物？

> ID：16201210
> 
> 赞同：3
> 
> 时间：2013-04-24T20:07:08.457
> 
> 标签：python, .net, equivalent

我一直无法通过典型渠道找到这个问题的答案。

在 Python 中，我可以有以下函数定义

```
def do_the_needful(**kwargs):
    # Kwargs is now a dictionary
    # i.e. do_the_needful(spam=42, snake='like eggs', spanish='inquisition')
    # would produce {'spam': 42, 'snake': 'like eggs', 'spanish': 'inquisition' } 
```

我知道 .NET 有`ParamArray`，它会产生一系列未命名的参数，类似于`*args`Python 中的语法...... .NET 是否有等价的`**kwargs`或类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:12:49.687

您要查找的内容称为**可变参数函数**。如果您想知道如何在各种编程语言中实现它，最好查看有关它的[Wikipedia 页面](http://en.wikipedia.org/wiki/Variadic_function)。

因此，根据 Wikipedia，在 C# 和 VisualBasic 中实现可变参数函数是这样完成的：

> 其他语言，如 C#、VB.net 和 Java 使用不同的方法——它们只允许将可变数量的相同（超）类型的参数传递给可变参数函数。在方法内部，它们被简单地收集在一个数组中。
> 
> ### C# 示例
> 
> ```
> public static void PrintSpaced(params Object[] objects)
> {
>     foreach (Object o in objects)
>         Console.Write(o + " "); 
> }    
> // Can be used to print: PrintSpaced(1, 2, "three"); 
> ```
> 
> ### VB.Net 示例
> 
> ```
> Public Shared Sub PrintSpaced(ParamArray objects As Object())
>     For Each o As Object In objects
>         Console.Write(o & " ")
>     Next
> End Sub 
> ```
> 
> ' 可用于打印：PrintSpaced(1, 2, "three")

# r - ggplot2 热图为中断分配颜色

> ID：16201221
> 
> 赞同：0
> 
> 时间：2013-04-24T20:08:05.457
> 
> 标签：r, ggplot2

我正在尝试使用 ggplot 创建一个热图来为服务器着色 15 个 cpu 平均值。数据为每天 24 小时，以 15 分钟为增量。如果 CPU 利用率在 20%、30%、40% 等范围内，则需要显示不同的颜色。当我执行以下操作时，我的图表看起来不正确。看起来颜色代表不同的 CPU 利用率。下面是一个示例数据。任何想法，我该如何解决这个问题？

```
dput(head(y,20))
structure(list(DATE = structure(c(15795, 15795, 15795, 15795, 
15795, 15795, 15795, 15795, 15795, 15795, 15795, 15795, 15795, 
15795, 15795, 15795, 15795, 15795, 15795, 15795), class = "Date"), 
    Time = c("20:14", "20:29", "20:44", "20:59", "21:14", "21:29", 
    "21:44", "21:59", "22:14", "22:29", "22:44", "22:59", "23:14", 
    "23:29", "23:44", "23:59", "00:14", "00:29", "00:44", "00:59"
    ), CPU = c(34.2, 34.6, 33.9333333333333, 33.2666666666667, 
    36.6333333333333, 33.1333333333333, 27.2666666666667, 26.4333333333333, 
    27, 26.6, 26.3666666666667, 26.5666666666667, 26.0666666666667, 
    24.9333333333333, 24.9333333333333, 25.3, 28.4857142857143, 
    23.5, 20.8, 19.2666666666667)), .Names = c("DATE", "Time", 
"CPU"), row.names = 2861:2880, class = "data.frame")

pals<-c("#F0FFFF","#F0FFFF","#AEEEEE","#ADD8E6","#00BFFF","green","#E4F224","#C9821E", "#FF0000")
vals<-c(0.19,0.29,0.39,0.49,0.59,0.69,0.79,0.89,0.99)
brk<- c(20, 30, 40, 50, 60, 70, 80, 90, 100)

ggplot(y, aes(DATE, Time, fill=CPU)) + geom_tile() + theme_bw() + 
      scale_fill_gradientn(name="CPU Utilization", colours=pals,  
                           values=vals,limits=c(0,100), breaks = brk) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:27:08.380

嗯..我一定是错过了什么。代码对我来说看起来不错。例如，如果我设置

```
y$CPU <- seq(5,100,5) 
```

和情节，

```
ggplot(y, aes(DATE, Time, fill=CPU)) + geom_tile() + theme_bw() + 
       scale_fill_gradientn(name="CPU Utilization", colours=pals,  
                            values=vals,limits=c(0,100), breaks = brk) 
```

我得到以下情节，符合您的要求：![在此处输入图像描述](https://i.stack.imgur.com/fG5WV.png)

# mysql - 为预订数据库构建查询

> ID：16201226
> 
> 赞同：0
> 
> 时间：2013-04-24T20:08:35.747
> 
> 标签：mysql, sql, database

我有一个保存汽车预订的数据库。我正在尝试编写一个查询，该查询将为我提供足够的信息来填充具有以下属性的视图：

1.  前几个月（最多 3 个），即 1 月的行将是 12 月、11 月、10 月
2.  当月预订最多的位置。
3.  当月该地点的预订数量。
4.  当月在该位置保留的总小时数。

预订表的布局如下：

```
ResID, PickUpDateTime, ReturnDateTime, LocationName, VehicleSno 
```

我已经尝试了两个小时来解决它，但我很难过。我有 COUNT(*) 语句来获取每个位置的小时数，但它有点偏离，因为它不受它应该属于的月份的限制。：/我真的很讨厌约会。

```
SELECT
    MONTH(PickupDateTime) AS Month,
    LocationName as Location,
    COUNT(*) AS NoOfRes,
    TIMESTAMPDIFF(HOUR, PickUpDateTime, ReturnDatetime) AS Hours   
FROM
    Reservation   
GROUP BY
    Location   
ORDER BY
    NoOfRes DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:16:49.640

要获取日期的月份，您可以使用该[`MONTH()`](https://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_month)功能。

因此，要获得 2 月份预订最多的位置，

```
select LocationName, count(*) num_reservations
  from reservation
 where month(PickUpDateTime) = 2 --This can be parameterized if needed
 group by LocationName
 order by num_reservations desc 
```

# javascript - 绘制后立即刷新页面（x3Dom）

> ID：16201227
> 
> 赞同：2
> 
> 时间：2013-04-24T20:08:38.320
> 
> 标签：javascript

我希望“添加锥体”按钮绘制一个锥体，但似乎下面的代码在绘制锥体后立即刷新浏览器。我希望页面在每次单击按钮后保持在锥形页面上，而无需刷新。任何帮助将非常感激。

```
 <script>
      function addCone() {
        var scene = document.getElementsByTagName("scene")[0];

        var cone = document.createElement("cone");
        var shape = document.createElement("shape");
        var appearance = document.createElement("appearance");
        var material = document.createElement("material");

        appearance.appendChild(material);
        shape.appendChild(appearance);
        shape.appendChild(cone);
        scene.appendChild(shape);
        return true;
      }
    </script>

    <div id="content">
      <form>
        <button onclick="addCone()">Add Cone</button>
      </form>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:16:39.917

你可以试试这个

**HTML**

```
<button onclick="return addCone()">Add Cone</button> 
```

**JS**

```
function addCone() {
    // ...    
    return false;
} 
```

# javascript - 在 jsRender 中，如何访问要更新的元素？

> ID：16201232
> 
> 赞同：1
> 
> 时间：2013-04-24T20:08:49.513
> 
> 标签：javascript, jquery, jsrender

我是第一次使用 jsRender，我找不到太多完整的文档。

我正在使用此模板填充网格 -

```
<script id="my-grid" type="text/x-jsrender">
    <div class="grid-item">
         <img class="grid-item-image" src="img.gif" />
         <div class="grid-item-description">{{clean:Name}}</div>
    </div>
</script> 
```

我设置了一个转换器来清理返回的数据`Name`-

```
$.views
    .converters({
        clean: function (x) {
            if (x) {
                x=x.replace(/<br \/>/gi, " - ");
            } else {
                x="";
            }
            return x;
        }
    }); 
```

转换器工作正常，但我想要做的实际上是删除元素`grid-item-description`的这个实例`else`（当没有要显示的文本时）。

如何找出我当前在 jsRender 中的哪个元素来删除该元素？

谢谢！- 迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:08:49.343

首先，您可以在此页面上找到示例：http: [//borismoore.github.io/jsrender/demos/demos.html](http://borismoore.github.io/jsrender/demos/demos.html)

您的问题需要的示例是： [http ://borismoore.github.io/jsrender/demos/step-by-step/04_if-else-tag.html](http://borismoore.github.io/jsrender/demos/step-by-step/04_if-else-tag.html)

你需要做的是用 if 标签包围元素：

```
<script id="my-grid" type="text/x-jsrender">
    {{if Name}}
    <div class="grid-item">
         <img class="grid-item-image" src="img.gif" />
        <div class="grid-item-description">{{clean:Name}}</div>
    </div>
    {{/if}}
</script> 
```

您甚至不需要`else`函数中的条件。

可以在[jsfiddle上找到这方面的工作示例](http://jsfiddle.net/YT49p/)

# android - AndroidViewClient 错误：设备是安全的

> ID：16201239
> 
> 赞同：0
> 
> 时间：2013-04-24T20:09:11.640
> 
> 标签：android, monkeyrunner, androidviewclient

我正在尝试使用 AndroidViewClient 进行一些自动化。在 [github][1] 上有一个关于“安全模式”的页面。它指出：

**AndroidViewClient 有两个可能的后端：**

*   视图服务器
*   UiAutomator

**UiAutomator 适用于 Android API 16 及更高版本，因此如果您的设备有以前的版本，您唯一的选择是 ViewServer。**

我正在尝试运行 dump.py，但出现“设备安全”错误。安全模式页面指出“您唯一的选择是 ViewServer”。什么是 viewServer 以及如何将它与 monkeyrunner 一起使用？

我很难理解这一点，因为根据 github 页面上的这张图片，如果我没有 API lvl 16 或更高版本，我可以使用 id 名称（如果我有）（我有）我只是不知道该怎么做。

总之，

我有 API 级别 15 及更低级别的设备和源代码，我想使用 viewID 自动化我的应用程序。**那可能吗？**

## 最后一个错误：

```
C:\Users\EGHDK\android-sdk\tools>monkeyrunner C:\AndroidViewClient-master\Andro
idViewClient-master\AndroidViewClient\examples\dump.py --ignore-secure-device --
do-not-start-view-server
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
] Script terminated due to an exception
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]Traceback (most recent call last):
  File "C:\AndroidViewClient-master\AndroidViewClient-master\AndroidViewClient\e
xamples\dump.py", line 79, in <module>
    ViewClient(*ViewClient.connectToDeviceOrExit(**kwargs1), **kwargs2).traverse
(transform=transform)
  File "C:\AndroidViewClient-master\AndroidViewClient-master\AndroidViewClient\s
rc\com\dtmilano\android\viewclient.py", line 991, in __init__
    subprocess.check_call([adb, '-s', self.serialno, 'forward', 'tcp:%d' % self.
localPort,
  File "C:\Users\EGHDK\android-sdk\tools\lib\jython.jar\Lib\subprocess.py", lin
e 469, in check_call
  File "C:\Users\EGHDK\android-sdk\tools\lib\jython.jar\Lib\subprocess.py", lin
e 456, in call
  File "C:\Users\EGHDK\android-sdk\tools\lib\jython.jar\Lib\subprocess.py", lin
e 755, in __init__
  File "C:\Users\EGHDK\android-sdk\tools\lib\jython.jar\Lib\subprocess.py", lin
e 1269, in _execute_child
OSError: Cannot run program "C:\Windows\system32\adb.exe" (in directory "C:\User
s\EGHDK\android-sdk\tools"): CreateProcess error=2, The system cannot find the
file specified

130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyException.doRaise(PyException.java:219)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.Py.makeException(Py.java:1159)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.Py.makeException(Py.java:1163)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.Py.makeException(Py.java:1167)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py._execute_child$36(C:\Users\EGHDK\android-sdk\tools\lib
\jython.jar\Lib\subprocess.py:1270)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.call_function(C:\Users\EGHDK\android-sdk\tools\lib\jyt
hon.jar\Lib\subprocess.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:297)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:191)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:385)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.__call__(PyMethod.java:215)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.instancemethod___call__(PyMethod.java:221)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.__call__(PyMethod.java:206)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObject.__call__(PyObject.java:367)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObject.__call__(PyObject.java:371)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.__init__$19(C:\Users\EGHDK\android-sdk\tools\lib\jytho
n.jar\Lib\subprocess.py:844)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.call_function(C:\Users\EGHDK\android-sdk\tools\lib\jyt
hon.jar\Lib\subprocess.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:297)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:191)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:385)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.__call__(PyMethod.java:215)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.instancemethod___call__(PyMethod.java:221)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyMethod.__call__(PyMethod.java:206)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObjectDerived.dispatch__init__(PyObjectDerived.java
:1097)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyType.invoke_new_(PyType.java:444)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyType.type___call__(PyType.java:1374)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyType.__call__(PyType.java:1365)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObject._callextra(PyObject.java:537)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.call$7(C:\Users\EGHDK\android-sdk\tools\lib\jython.jar
\Lib\subprocess.py:456)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.call_function(C:\Users\EGHDK\android-sdk\tools\lib\jyt
hon.jar\Lib\subprocess.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:297)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:370)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.function___call__(PyFunction.java:375)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:365)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObject._callextra(PyObject.java:537)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.check_call$8(C:\Users\EGHDK\android-sdk\tools\lib\jyth
on.jar\Lib\subprocess.py:475)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at subprocess$py.call_function(C:\Users\EGHDK\android-sdk\tools\lib\jyt
hon.jar\Lib\subprocess.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:297)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:124)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:317)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at com.dtmilano.android.viewclient$py.__init__$54(C:\AndroidViewClient-m
aster\AndroidViewClient-master\AndroidViewClient\src\com\dtmilano\android\viewcl
ient.py:995)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at com.dtmilano.android.viewclient$py.call_function(C:\AndroidViewClient
-master\AndroidViewClient-master\AndroidViewClient\src\com\dtmilano\android\view
client.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:297)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyBaseCode.call(PyBaseCode.java:191)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:385)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyFunction.__call__(PyFunction.java:380)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyInstance.__init__(PyInstance.java:120)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyClass.__call__(PyClass.java:194)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyObject._callextra(PyObject.java:537)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.pycode._pyx0.f$0(C:\AndroidViewClient-master\AndroidViewCl
ient-master\AndroidViewClient\examples\dump.py:79)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.pycode._pyx0.call_function(C:\AndroidViewClient-master\And
roidViewClient-master\AndroidViewClient\examples\dump.py)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyTableCode.call(PyTableCode.java:165)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.PyCode.call(PyCode.java:18)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.Py.runCode(Py.java:1197)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.core.__builtin__.execfile_flags(__builtin__.java:538)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at org.python.util.PythonInterpreter.execfile(PythonInterpreter.java:156
)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at com.android.monkeyrunner.ScriptRunner.run(ScriptRunner.java:116)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at com.android.monkeyrunner.MonkeyRunnerStarter.run(MonkeyRunnerStarter.
java:77)
130425 14:05:23.047:S [MainThread] [com.android.monkeyrunner.MonkeyRunnerOptions
]       at com.android.monkeyrunner.MonkeyRunnerStarter.main(MonkeyRunnerStarter
.java:189) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:29:18.077

如果您的设备**API**级别**< 16 ，您的替代方案是（**[如图](https://raw.github.com/wiki/dtmilano/AndroidViewClient/images/select-implementation-activity-diagram.png)所示）：

*   如果您有权访问应用程序源代码，[则为 LocalViewServer 。](https://github.com/dtmilano/AndroidViewClient/wiki/Localviewserver)LocalViewServer 是 ViewServer 的一个分支
*   使用模拟器（安全模式已禁用）
*   根设备并自行禁用安全模式

**LocalViewServer**具有**LocalViewServerActivity**功能，您可以对其进行扩展以简化Activity 中的**ViewServer**实现。

检查[TemperatureConverterActivity](https://github.com/dtmilano/TemperatureConverter/blob/master/src/com/example/i2at/tc/TemperatureConverterActivity.java)的示例源代码。

您发布错误的原因似乎是：

```
OSError: Cannot run program "C:\Windows\system32\adb.exe" (in directory "C:\User
s\EGHDK\android-sdk\tools"): CreateProcess error=2, The system cannot find the
file specified 
```

您应该正确设置环境变量 ANDROID_HOME 以指向 Android SDK 安装。

# python - 列表中的项目以通过索引设置

> ID：16201240
> 
> 赞同：0
> 
> 时间：2013-04-24T20:09:12.467
> 
> 标签：python, list, python-3.x

给定一个清单，

```
a_list=['chicken','pizza','burger','beer','vodka','potato','fries','mustache'] 
```

我正在尝试为每六个单词的短语制作一组新的...

```
a_set=(['chicken','pizza','burger','beer','vodka','potato'],['pizza','burger','beer','vodka','potato','fries],['burger','beer','vodka','potato','fries','mustache']) 
```

我试图通过索引来做到这一点..

```
index1=0
index2=6
a_set=[]
while True:
    a_set.append(a_list[index1:index2])
    index1+=1
    index2+=1
print (a_set) 
```

我似乎无法弄清楚我做错了什么。另外，一旦循环完成并创建了所有六个单词短语并到达列表的末尾，我将如何结束循环，以便它不会从头开始并再次执行所有操作？感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:15:12.317

您正在寻找一个[滑动窗口生成器](https://stackoverflow.com/questions/6822725/rolling-or-sliding-window-iterator-in-python)：

```
from itertools import islice

def window(seq, n=2):
    "Returns a sliding window (of width n) over data from the iterable"
    "   s -> (s0,s1,...s[n-1]), (s1,s2,...,sn), ...                   "
    it = iter(seq)
    result = tuple(islice(it, n))
    if len(result) == n:
        yield result    
    for elem in it:
        result = result[1:] + (elem,)
        yield result

list(window(a_list, 6)) 
```

这使：

```
>>> list(window(a_list, 6)) 
[('chicken', 'pizza', 'burger', 'beer', 'vodka', 'potato'), ('pizza', 'burger', 'beer', 'vodka', 'potato', 'fries'), ('burger', 'beer', 'vodka', 'potato', 'fries', 'mustache')] 
```

你不是在这里创建[python](http://docs.python.org/3/library/stdtypes.html#set-types-set-frozenset) [，`set`](http://docs.python.org/3/library/stdtypes.html#set-types-set-frozenset)你需要小心你的术语。

具体来说，当第二个索引到达列表末尾时，您不会进行测试：

```
a_windows = []
index1 = 0
index2 = 6

while index2 <= len(a_list):
    a_windows.append(a_list[index1:index2])
    index1 += 1
    index2 += 1 
```

哪个有效：

```
>>> a_windows
[['chicken', 'pizza', 'burger', 'beer', 'vodka', 'potato'], ['pizza', 'burger', 'beer', 'vodka', 'potato', 'fries'], ['burger', 'beer', 'vodka', 'potato', 'fries', 'mustache']] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:30:44.247

Perhaps this would help

```
def get_set(li, phrase_len):
    l = len(li)
    for i in range(l):
        if phrase_len <= l-i:
            yield(li[i:i+phrase_len])

a_list=['chicken','pizza','burger','beer','vodka','potato','fries','mustache']
print list(get_set(a_list, 6)) 
```

Run the code here [http://codebunk.com/bunk#-IsxjI9Up1AgOfi0nuCd](http://codebunk.com/bunk#-IsxjI9Up1AgOfi0nuCd)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:59:28.880

如果我理解正确，您需要列表中六项的所有可能组合。`itertools.combinations`应该使这很容易：

```
>>> import itertools
>>> a_list=['chicken','pizza','burger','beer','vodka','potato','fries','mustache']
>>> a_set=set(itertools.combinations(a_list, 6))
>>> pprint(a_set)
{('burger', 'beer', 'vodka', 'potato', 'fries', 'mustache'),
 ('chicken', 'beer', 'vodka', 'potato', 'fries', 'mustache'),
 ('chicken', 'burger', 'beer', 'potato', 'fries', 'mustache'),
 ('chicken', 'burger', 'beer', 'vodka', 'fries', 'mustache'),
 ('chicken', 'burger', 'beer', 'vodka', 'potato', 'fries'),
 ('chicken', 'burger', 'beer', 'vodka', 'potato', 'mustache'),
 ('chicken', 'burger', 'vodka', 'potato', 'fries', 'mustache'),
 ('chicken', 'pizza', 'beer', 'potato', 'fries', 'mustache'),
 ('chicken', 'pizza', 'beer', 'vodka', 'fries', 'mustache'),
 ('chicken', 'pizza', 'beer', 'vodka', 'potato', 'fries'),
 ('chicken', 'pizza', 'beer', 'vodka', 'potato', 'mustache'),
 ('chicken', 'pizza', 'burger', 'beer', 'fries', 'mustache'),
 ('chicken', 'pizza', 'burger', 'beer', 'potato', 'fries'),
 ('chicken', 'pizza', 'burger', 'beer', 'potato', 'mustache'),
 ('chicken', 'pizza', 'burger', 'beer', 'vodka', 'fries'),
 ('chicken', 'pizza', 'burger', 'beer', 'vodka', 'mustache'),
 ('chicken', 'pizza', 'burger', 'beer', 'vodka', 'potato'),
 ('chicken', 'pizza', 'burger', 'potato', 'fries', 'mustache'),
 ('chicken', 'pizza', 'burger', 'vodka', 'fries', 'mustache'),
 ('chicken', 'pizza', 'burger', 'vodka', 'potato', 'fries'),
 ('chicken', 'pizza', 'burger', 'vodka', 'potato', 'mustache'),
 ('chicken', 'pizza', 'vodka', 'potato', 'fries', 'mustache'),
 ('pizza', 'beer', 'vodka', 'potato', 'fries', 'mustache'),
 ('pizza', 'burger', 'beer', 'potato', 'fries', 'mustache'),
 ('pizza', 'burger', 'beer', 'vodka', 'fries', 'mustache'),
 ('pizza', 'burger', 'beer', 'vodka', 'potato', 'fries'),
 ('pizza', 'burger', 'beer', 'vodka', 'potato', 'mustache'),
 ('pizza', 'burger', 'vodka', 'potato', 'fries', 'mustache')} 
```

# c# - 基本 RX TestScheduler 时序

> ID：16201249
> 
> 赞同：3
> 
> 时间：2013-04-24T20:09:41.057
> 
> 标签：c#, unit-testing, system.reactive

我正在使用 RX 进行一些（非常基本的）事件订阅：-

```
public void StartListening(IObservable<Item> observable)
{
   subscription = observable
      .Buffer(TimeSpan.FromSeconds(5))
      .Where(Enumerable.Any)
      .Subscribe(events => service.DoStuffInBatch(events));
} 
```

现在我想要的只是一组单元测试来证明这个方法的行为。像： -

*   如果我得到数据但时间还没有过去 5 秒，我们永远不会调用 DoStuffInBatch。
*   如果我得到数据并且时间已经过去了 5 秒，我会用数据调用 DoStuffInBatch。
*   如果我没有得到数据并且时间已经过去了 5 秒，我不会调用 DoStuffInBatch。
*   如果我通过两个窗口获取数据，例如一些在 3 秒和一些在 8 秒，我会两次调用 DoStuffInBatch。

我一直在阅读 Bart 提出的所有示例（例如[http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling .aspx](http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx)），但我真的在为我的测试而苦苦挣扎。这是一个例子： -

```
[Test]
public void StartListening_SomeDataAndBatchTimeHasNotPassed_DoesNotDoStuffInBatch()
{
    var scheduler = new TestScheduler();

    // Act - call the class under test, supplying a set of dummy data on the test scheduler
    listener.StartListening(GenerateTestData(5).ToObservable(scheduler));

    // Move the scheduler forward by one second
    scheduler.AdvanceBy(TimeSpan.FromSeconds(1).Ticks);

    // Assert that we never called the service as we haven't yet advanced 5 seconds
    Mock.Assert(() => mockService.DoStuffInBatch(null), Args.Ignore(), Occurs.Never());
} 
```

然而，这个测试失败了。只要我调用 AdvanceBy，订阅就会触发并调用 DoStuffInBatch。

我显然做错了什么 - 但不知道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:48:27.483

也许您可以尝试将`IScheduler`参数传递给`StartListening`方法，并使用它将`TestScheduler`实例传递给 .Buffer() 或 .SubscribeOn() 调用？

在运行时，您只需默认为您的案例敏感的默认值。

# asp.net-mvc - 新的 MVC 4 项目基于使用 Subsonic 作为 ORM 的 ASP.net 网络论坛应用程序......从哪里开始......？

> ID：16201252
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:09:51.563
> 
> 标签：asp.net-mvc, asp.net-mvc-4, orm, webforms, subsonic

我的任务是尝试将我们公司现有的 ASP.NET Web 窗体应用程序转换为 MVC 4 应用程序（作为研发启动项目）。我对 MVC 2 有一点经验，但我的问题是试图真正开始。我们有现有的存储过程，我们通过 Subsonic 作为我们的 ORM 访问（以便可以在我们的代码中调用它们）。我们还有一个与 Subsonic 相关的数据访问层。

我知道这是一个模糊的问题，但是有没有一种已知的方法可以使用我们现有的存储过程和具有不同 ORM（例如 NHibernate 或其他东西）的表来开始创建这个 MVC 应用程序？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:13:54.940

没有理由仅仅因为 ORM 发生变化而需要更改 SP；您可能想要改进您正在做的一些事情并重写其中一些，但不是因为 ORM 发生了变化。

# android - 从 SupportMapFragment 中删除按钮覆盖

> ID：16201253
> 
> 赞同：2
> 
> 时间：2013-04-24T20:09:53.140
> 
> 标签：android, google-maps-android-api-2, supportmapfragment

我有一个非常简单的 SupportMapFragment 来显示我在此视图中使用的小型 Google 地图 ![在此处输入图像描述](https://i.stack.imgur.com/PLUxM.jpg)

这个想法是用户可以单击它来查看全屏地图。如何摆脱地图上的 +/- 按钮？如果不可能，是否有另一种获取地图的方法？

这是我的 MapFragment 代码：

```
public class CustomMapFragment extends SupportMapFragment {
    private static LatLng mPosFija;

    public CustomMapFragment() {
        super();

    }

    public static CustomMapFragment newInstance(LatLng position) {
        CustomMapFragment fragment = new CustomMapFragment();
        mPosFija = position;
        return fragment;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        if (getMap() != null) {
            initMap();
            Log.d(getClass().getSimpleName(), "Map ready for use!");
        }
    }

    @Override
    public void onResume() {
        super.onResume();
        initMap();
    }

    private void initMap() {
        Log.v("CustomMapFragment", "initMap");
        if (getMap() != null) {
            UiSettings settings = getMap().getUiSettings();
            settings.setAllGesturesEnabled(true);
            settings.setMyLocationButtonEnabled(false);

            getMap().clear();
            getMap().moveCamera(CameraUpdateFactory.newLatLngZoom(mPosFija, 5));
            getMap().addMarker(new MarkerOptions().position(mPosFija).draggable(false));
        }
    }
} 
```

这是将 mapFragment 添加到视图的 DialogFragment 的代码：

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        if (GooglePlayServicesUtil.isGooglePlayServicesAvailable(getActivity()) == ConnectionResult.SERVICE_INVALID
                || GooglePlayServicesUtil.isGooglePlayServicesAvailable(getActivity()) == ConnectionResult.SERVICE_MISSING) {
            Log.e("HERE", "Google play not active");

            TextViewFragment tvf = new TextViewFragment();
            getChildFragmentManager().beginTransaction().replace(R.id.mapview, tvf).commit();

        } else {

            CustomMapFragment mMapFragment = CustomMapFragment.newInstance(new LatLng(offer.latitude, offer.longitude));
            getChildFragmentManager().beginTransaction().replace(R.id.mapview, mMapFragment).commit();
        }

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T14:08:56.613

好的，所以这正盯着我看，很简单

```
UiSettings settings = getMap().getUiSettings();
            settings.setAllGesturesEnabled(false);
            settings.setMyLocationButtonEnabled(false);
            settings.setZoomControlsEnabled(false); 
```

# entity-framework - 在同一个objectContext中插入多条记录

> ID：16201254
> 
> 赞同：0
> 
> 时间：2013-04-24T20:09:53.053
> 
> 标签：entity-framework, linq-to-entities, objectcontext, savechanges

当我尝试使用相同的 objectContext 插入数据时遇到了一些麻烦。

我的问题是，实体读取我的代码的**顺序**不是我“添加”它的顺序。

例子：

**EntityAB**将**EntityA**的 PK 作为 FK。1-N 关系。

```
objContext.DbSet.Add(EntityA);
objContext.DbSet.Add(EntityAB);
objContext.SaveChanges(); 
```

代码到达时的错误消息`SaveChanges()`：

```
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_EntityAB_EntityA". The conflict occurred in database "dbTest", table "dbo.EntityA", column 'IdEntityA'.
The statement has been terminated. 
```

所以，我的实体框架在读`objContext.DbSet.Add(EntityAB);` **之前** `objContext.DbSet.Add(EntityA);`

* * *

如果我将代码更改为：

```
objContext.DbSet.Add(EntityA);
objContext.SaveChanges();
objContext.DbSet.Add(EntityAB);
objContext.SaveChanges(); 
```

有用。

* * *

但我不能。由于审计，需要**一次性完成。** `SaveChanges()`

我的问题是，
**我可以按照添加的顺序阅读代码吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:23:23.390

你的上下文是如何设置的？

我认为以下可能有效..

在上下文中

```
public DbSet<EntityA> EntityAs { get; set; }
public DbSet<EntityAB EntityABs { get; set; } 
```

然后在你的其他代码中

```
objContext.EntityAs.Add(EntityA);
objContext.EntityAB.Add(EntityAB);
objContext.SaveChanges(); 
```

如果这不起作用，我会探索

```
objContext.local 
```

# asp.net-mvc - MVC 控制器没有正确解析 Ajax 请求？

> ID：16201256
> 
> 赞同：0
> 
> 时间：2013-04-24T20:09:55.230
> 
> 标签：asp.net-mvc, json, jquery

我有一个 MVC .NET 4.5 应用程序，它使用带有 JSON 的 Ajax 请求来访问服务器端的 MVC 控制器。控制器中的函数如下所示：

```
[HttpPost]
public void SomeFunction(int int1, List<int> listOfInts, int int2)
    {
        someOtherFunction(int1, listOfInts, int2);
    } 
```

ajax 请求如下所示：

```
actionData = {
            int1: 1,
            int2: 2,
            listOfInts: list
        }
 $.ajax({
        type: 'POST',
        url: actionURL,
        data: JSON.stringify(actionData),
        traditional: true,
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: functionIfSuccessful() },
        error: functionIfNotSuccessful() }
    }); 
```

如果我查看 Fiddler 中的请求，则传递的 JSON ojbect 具有以下格式：

```
int1=1
int2=2
listOfInts=[1,2] 
```

问题是当 MVC 控制器中的函数被命中时，从请求中正确设置了`int1`和`int2`属性，但`listOfInts`参数为空。我也尝试将其更改为使用原始数组而不是 List 对象，但这并没有改变任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:06:18.137

固定的。这个问题是由提供的代码之外的东西引起的。构建整数列表的 javascript 不应该在末尾添加括号。删除了那些，它就像一个魅力。

# ios - FetchedResults 控制器过滤计算值

> ID：16201259
> 
> 赞同：0
> 
> 时间：2013-04-24T20:09:59.553
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller

我有一个由 NSFetchedResultsController 管理的 tableview。

我的问题是我正在尝试根据计算值过滤数据，该计算值需要查看核心数据实体上的相关值。

进一步说明：我有一个名为“Task”的核心数据实体，以及一个名为“TaskActions”的一对多关系。

我想通过查看操作并使用一些自定义逻辑来对任务表视图进行排序。

问题是我真的不知道如何最好地实现这一点。

**这是我尝试过的**：

```
 NSFetchRequest *requestForAll = [[NSFetchRequest alloc] initWithEntityName:@"Task"];
 NSPredicate *actionPredicate = [NSPredicate predicateWithFormat:@"taskActionPerformed == %@",@YES];
 requestForAll.predicate = actionPredicate;
 [self setFetchedResultsController:[[NSFetchedResultsController alloc] initWithFetchRequest:requestForAll managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil]]; 
```

我可以通过将属性“taskActionPerformed”放在实体上并覆盖 getter 值来完成此“过滤”工作，如下所示：

```
 - (NSNumber*)taskActionPerformed
{
    for (TaskActions *action in self.actions)
    {
        //Perform Logic
        return @YES;
    } 
    return @NO;
} 
```

但是，我读过不鼓励，甚至不推荐重写 KVO 方法（就像我正在使用 getter 一样）。

此外，上述解决方案仅在我保留数据之前有效。保存数据后，不调用 taskActionPerformed 并且不加载 fetchedresultscontroller。

我真的很想知道解决这个一般问题的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:22:21.217

最佳实践是在内存中过滤。

[来自获取托管对象](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW3)中的核心数据编程指南

> 您不能使用基于瞬态属性的谓词进行获取（尽管您可以使用瞬态属性自己在内存中进行过滤）。...总而言之，如果您直接执行 fetch，则通常不应将基于 Objective-C 的谓词或排序描述符添加到 fetch 请求中。相反，您应该将这些应用于获取的结果。

# ios - CGImageRef 的 NSArray 的问题（但不在模拟器上！）

> ID：16201262
> 
> 赞同：2
> 
> 时间：2013-04-24T20:10:07.250
> 
> 标签：ios, nsarray, cgimageref

我正在尝试将一些 CGImageRefs 放入 NSArray。它可以在模拟器上正常工作，但不能在设备上工作 - 它在我尝试使用 EXC_BAD_ACCESS 代码 = 1 错误形成数组时崩溃。我也尝试了其他的东西，比如从一个可变数组开始，但它也不起作用。在控制台输入 bt 的结果是

```
(lldb) bt
* thread #1: tid = 0x2403, 0x3a9b25b6 libobjc.A.dylib`objc_msgSend + 22, stop reason = EXC_BAD_ACCESS (code=1, address=0x86ea78f7)
frame #0: 0x3a9b25b6 libobjc.A.dylib`objc_msgSend + 22
frame #1: 0x32a98b5e CoreFoundation`+[__NSArrayI __new:::] + 58
frame #2: 0x00042388 NameOfMyApp 
```

所以基本上我有很多图像，字母，我有很多层代表单词中的位置，每个层都应该循环遍历它们。例如，图层 1 显示字母 C，然后是字母 F，然后是字母 P 等，而图层 2 显示其他序列。

我以为我会加载每个字母一次...

```
CGImageRef letterH = [UIImage imageWithContentsOfFile:letterHfilename].CGImage;
CGImageRef letterI = [UIImage imageWithContentsOfFile:letterIfilename].CGImage; 
```

...并将 CGImageRefs 放在 NSArray 属性中，转换为 id：

```
self.titleLetters = @[(__bridge id)letterH, (__bridge id)letterI; 
```

然后我再做

```
layerN.contents = self.titleLetters[i]; 
```

但更重要的是，我必须能够将它们（可能每次）放在另一个数组中：

```
[contentsValuesArray addObject:self.titleLetters[j]]; 
```

然后将该数组用作 keyFrameAnimation 的值：

```
CAKeyframeAnimation* contentsAnim = [CAKeyframeAnimation animationWithKeyPath:@"contents"];
contentsAnim.values = contentsValuesArray; 
```

所有这些都在模拟器中正常工作，每次。

正如我所说，我尝试了一些变体，唯一可行的方法是当我使用 arrayWithObject 形成一个只有一个 letter-imageref 的可变数组时。即使那样，它也只是有时有效，而且它在我的程序中进一步崩溃。

我似乎在某处读到没有保留 CGImageRefs，因此它们可能在我使用它们之前就被释放了。自从我在引入 ARC 后开始编码以来，我对发布知之甚少，而且由于它一直在模拟器上工作，我认为这不适用于我的情况。

另外，在这个回复中：

[如何创建一个可变的 CGImageRefs 数组？](https://stackoverflow.com/questions/1392321/how-do-i-create-a-mutable-array-of-cgimagerefs)

一个在 Cocoa Frameworks 上工作的人说它应该可以工作，尽管他没有给出任何细节，所以它可能是暗示的。

任何帮助和建议将不胜感激。

**编辑已解决** 似乎问题确实是当我尝试将它们添加到数组时图像引用不存在，这是因为它们已经被释放了。显然他们需要使用 CGImageRetain 来保留。它现在可以工作了，我只需要确保它们在之后被释放。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:38:42.007

解决方案是在我还没来得及使用它们之前就发布了 imagerefs。似乎这会立即发生（至少在设备上），除非它们使用 CGImageRetain 保留。

# c# - C# 使用设计模式重构具有不同细节的相同操作

> ID：16201265
> 
> 赞同：0
> 
> 时间：2013-04-24T20:10:18.170
> 
> 标签：c#, design-patterns, refactoring, template-method-pattern

我试图找到重构代码的方法，但不知道如何做到这一点。

例如，我们有几个类

```
class A {
     string name;
     int year;
}

class B {
      long id;
      string code; 
      DateTime currentTime;
}

class C {
      string lastname;
      DateTime currentDate; 
} 
```

后者我需要返回这些类 List、List、List 的对象列表并将它们转换为 Object[][]。

对于每次转换，我都做同样的事情

```
private Object[][] converAListToObjectArray(List<A> dataList)
        {
            long countRecords = dataList.Count();
            const int countProperty = 2;
            var arrayRes = new object[countRecords][];

            for (int i = 0; i < countRecords; i++)
            {
                var arrayObjProperty = new object[countProperty];
                arrayObjProperty[0] = dataList[i].Name;
                arrayObjProperty[1] = dataList[i].Year;

                arrayRes[i] = arrayObjProperty;
            }
            return arrayRes;
        }

private Object[][] converBListToObjectArray(List<B> dataList)
        {
            long countRecords = dataList.Count();
            const int countProperty = 3;
            var arrayRes = new object[countRecords][];

            for (int i = 0; i < countRecords; i++)
            {
                var arrayObjProperty = new object[countProperty];
                arrayObjProperty[0] = dataList[i].Id;
                arrayObjProperty[1] = dataList[i].Code;
                arrayObjProperty[2] = dataList[i].CurrentTime; 

                arrayRes[i] = arrayObjProperty;
            }
            return arrayRes;
        } 
```

是否可以使用某种设计模式来分离这种转换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:23:59.770

您可以编写一个通用函数，该函数使用反射来获取每个对象的字段名称和值。您需要决定它是适用于公共领域还是私有领域。下面的示例同时获取公共和私有字段：

```
static object[][] ConvertToObjectArray<T>(IList<T> objects)
{
    var fields = (from fieldInfo in typeof(T).GetFields(
        System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance)
                  orderby fieldInfo.Name
                  select fieldInfo).ToArray();

    object[][] table = new object[objects.Count][];
    for (int i = 0; i < table.Length; i++)
    {
        table[i] = (from fieldInfo in fields
                    select fieldInfo.GetValue(objects[i])).ToArray();
    }
    return table;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:22:05.913

您可以使用一个动作并执行以下操作：-

```
class Program
{
    // Your new function, (doesn't have to be static; just did it for the demo)
    // If you really really want to return object[][] still,
    // You'll need to pass an index to foo as well
    private static List<IList<object>> convert<T>(IList<T> dataList, Action<IList<object>, T> foo)
    {
        var arrayRes = new List<IList<object>>();

        foreach (var item in dataList)
        {
            var arrayObjProperty = new List<object>();
            foo(arrayObjProperty, item);

            arrayRes.Add(arrayObjProperty);
        }
        return arrayRes;
    }

    // The rest is just calling the function with two examples
    static void Main(string[] args)
    {
        var bar = new List<A>();
        bar.Add(new A() { name = "qux", year = 2013 });

        var objects1 = convert(bar, (a, b) =>
        {
            a.Add(b.name);
            a.Add(b.year);
        });

        var baz = new List<B>();
        baz.Add(new B() { code = "qux", id = 2013 });

        var objects2 = convert(baz, (a, b) =>
        {
            a.Add(b.code);
            a.Add(b.id);
        });
    }
} 
```

您可以将其复制到您的 IDE 中进行播放，看看它是如何工作的。基本上，这使用泛型，然后使用一个操作来允许您在传递给该方法的 lambda 中执行每次不同的唯一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:28:21.693

你的`Object[][]`结构在我看来有点不寻常。你知道`Cast`列表有一种方法吗？

您可以执行以下操作：

```
List<A> foo = new List<A> ();

// initialize foo here
var bar = foo.Cast<Object>().ToArray(); 
```

这将为您提供一个字段名称完整的对象数组。如果您绝对需要将字段作为数组元素（为什么要这样做），您可以为每个类添加一个 ToObject 方法：

```
class A
{
    public string name;
    public int year;
    public Object[] ToObject()
    {
        return new Object[] {name, year};
    }
}

    List<A> foo = new List<A>
    {
        new A{name="reacher",year=2013},
        new A{name="Ray",year=2013}
    }; 
    var bux = foo.Select(a => a.ToObject()).ToArray() ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:18:05.920

您可以简化并使用这样的东西 - 例如对于`B`...

```
List<B> list = new List<B> 
{
    new B{ id = 1, code = "", currentTime = DateTime.Now},
    new B{ id = 1, code = "", currentTime = DateTime.Now},
    new B{ id = 1, code = "", currentTime = DateTime.Now},
};

var array = list.Select(x => new object[] { x.id, x.code, x.currentTime }).ToArray(); 
```

# java - Java 静态字段不适用于继承

> ID：16201267
> 
> 赞同：-3
> 
> 时间：2013-04-24T20:10:29.147
> 
> 标签：java, oop, inheritance, static, field

好吧，这可能很简单，但我就是不明白。

```
 package foo.foo.foo;

public class Vars {
    public static boolean foo = false;
} 
```

好的，这就是我的 Vars 课程。

然后我有一个 JFrame，有一个 JMenuBar、JMenu 和一个 JMenuItems。

```
 items = new JCheckBoxMenuItem("Foo");
        items.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                AbstractButton ab = (AbstractButton)e.getSource();
                Vars.foo = ab.getModel().isSelected();
                System.out.println(Vars.foo);
            }
        });
    menu.add(items, 0);
    menuBar.add(menu,0); 
```

一切都很好，它为 println 返回 true。现在，这是实际的问题部分......我有一个 if 语句 `if(Vars.foo)` 这 - 应该 - 工作，对吗？它从不执行 if 括号内的代码，除非我在它上面添加这行代码。

```
System.out.println(Vars.foo); 
```

这自然打印为 true，然后 if 语句有效，但如果我注释掉该行，它就不起作用。

我也一直在谷歌搜索，并尝试了这个：

```
Vars v = null;
if(v.yoo) 
```

除非我有 println，否则仍然不会这样做，我不知道为什么 println 使它工作。你能解释一下为什么/如何工作吗？

编辑：

```
public class painthandling implements Runnable {
@Override
public void run() {
    Vars y = null;
    while(true){
        if(y.foo){
            //some code here
        }
        System.out.println(y.foo);

    }
} 
```

}

那是不工作的部分，if 语句。总是返回假。

```
 frame f = new frame();
       (new Thread(new painthandling())).start();
        System.out.print("Got it."); 
```

JFrame 部分在新框架中被调用，然后另一个类在那里被调用，Vars 类在两者中被调用。在painthandling() 中，如果if 语句没有println，则返回false。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:17:54.560

**简短回答：**制作变量`volatile`

**长答案：**

我做了一些测试，我实际上可以重现你的情况（至少我认为它是一样的）。考虑这段代码：

```
public class Test {
    public static boolean foo = false;

    public static void main(String[] args) {

        new Thread(new Runnable(){

            @Override
            public void run() {
                while(true) {
                    try {
                        Thread.sleep(2000);
                        System.out.println("Swapping");
                        Test.foo = !Test.foo;
                    }
                    catch(Exception e) {
                        e.printStackTrace();
                    }
                }
            }
        }).start();

        while(true) {
            if(Test.foo) {
                System.out.println("I'm here");

            }

        }

    }
} 
```

这从不打印`I'm here`。但是，正如 OP 所述`System.out.println`，在 while 循环中添加 a 确实会使其打印出来。但有趣的是，它可以是任何 println 语句。它不需要打印变量值。所以这有效：

```
public class Test {
    public static boolean foo = false;

    public static void main(String[] args) {

        new Thread(new Runnable(){

            @Override
            public void run() {
                while(true) {
                    try {
                        Thread.sleep(2000);
                        System.out.println("Swapping");
                        Test.foo = !Test.foo;
                    }
                    catch(Exception e) {
                        e.printStackTrace();
                    }
                }
            }
        }).start();

        while(true) {
            if(Test.foo) {
                System.out.println("I'm here");

            }
            System.out.println(""); // Doesn't have to be System.out.println(Test.foo);
            // This also works (lock is just an object)
            // synchronized(lock) {
            //     int a = 2;
            // }

        }

    }
} 
```

还有一些其他情况也会产生“预期的”输出，那就是制作变量`volatile`，或者在`Thread.sleep()`完成测试的 while 循环内进行。它工作的原因`System.out.println`可能是因为`println`是同步的。事实上，在循环内进行任何同步操作都具有相同的效果。总而言之，这是一个线程（内存模型）问题，可以通过将变量标记为`volatile`. 但这并没有改变使用静态变量进行多线程访问是一个坏主意的事实。

我建议阅读[Java 语言规范的第 17 章，](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html)以了解有关线程、同步和 Java 内存模型的更多信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T20:25:58.647

我并没有真正阅读您的帖子，但在浏览后看起来您正在尝试使用这样的静态方法。

```
someMethod() {
    Var var = null;
    boolean bool = var.foo
} 
```

静态方法和字段的好处是你不必实例化它们，试试这个：

```
someMethod() {
    boolean bool = Var.foo
} 
```

# jquery - 验证 JQueryUI 模态表单保持模型数据注释

> ID：16201273
> 
> 赞同：0
> 
> 时间：2013-04-24T20:10:43.247
> 
> 标签：jquery, validation, asp.net-mvc-4, modal-dialog

我对 Javascript 和 jQuery 很陌生。

我正在关注此线程中提出的代码：[Validate JQuery UI modal form inside another form in MVC 4](https://stackoverflow.com/questions/13868980/validate-jquery-ui-modal-form-within-another-form-in-mvc-4) to create a modal form using the Data Annotations validation。

它可以很好地进行验证，但是当我正确填写表单并尝试保存信息并关闭它时，它会保存，但对话框不会关闭并保持这种状态，直到我刷新页面。

这是我的表单的编码方式：

```
@using (Ajax.BeginForm(new AjaxOptions { HttpMethod = "POST", UpdateTargetId ="editDialog", OnSuccess = "editSucces" }))
{        
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Editar Usuário</legend>

        <div class="display-field">
            @Html.EditorFor(model => model.IdUsuario, new { id = "idUsuario"})
        </div>

        Nome
        <div class="editor-field">
            @Html.EditorFor(model => model.Nome, new { id = "nomeUsuario"})
            <br />
            @Html.ValidationMessageFor(model => model.Nome)
        </div>

        E-mail / Login
        <div class="editor-field">
            @Html.EditorFor(model => model.Login, new { id = "loginUsuario"})
            <br />
            @Html.ValidationMessageFor(model => model.Login)
        </div>

        Senha
        <div class="editor-field">
            @Html.EditorFor(model => model.Senha, new { id = "senhaUsuario"})
            <br />
            @Html.ValidationMessageFor(model => model.Senha)
        </div>
        <p>
            <input type="submit" value="Confirmar" />
        </p>
    </fieldset>
<div>
    @Html.ActionLink("Cancelar", "Index")
</div>
 } 
```

这是我的控制器动作：

```
public ActionResult Edit(Usuario usuario, string confsenha)
{
        if (usuario.Senha == confsenha)
        {
            usuario.DataCadastro = DateTime.Now;

            if (ModelState.IsValid)
            {
                db.Entry(usuario).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            if (Request.IsAjaxRequest())
            {
                return PartialView("_Edit", usuario);
            }
            return View(usuario);

        }
} 
```

这是我的javascript调用：

```
$(function () {
$('.openDialog').click(function () {
    $.ajax({
        url: this.href,
        type: 'GET',
        cache: false,
        data: { idUsuario: $('#idUsuario').val() },
        success: function (result) {
            $('#result').html(result).dialog('open');
        }
    });
    return false;
});
$('#result').dialog({
    autoOpen: false,
    modal: true,
    closeOnEscape: false
});
});
function editSucces(result) {
if (result.value) {
    $('#result').dialog('close');        
    window.location.href = '/usuario/index';
} else {
    $('#result').html(result);
}
} 
```

运行它，我看到它永远不会进入这部分 javascript 代码：

```
if (result.value) {
    $('#result').dialog('close');        
    window.location.href = '/usuario/index';
} 
```

因此，它永远不会进入应该关闭对话框的部分。有谁知道为什么会这样？或者应该传递什么`result.value`？

谢谢，如果有人可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:08:09.427

修复。

只需将 Json 值返回给 if `(result.value)`。很简单，虽然我不得不睡在上面才能得到它>.<

这是修复后的代码：

控制器：

```
 if (ModelState.IsValid)
            {
                db.Entry(usuario).State = EntityState.Modified;
                db.SaveChanges();
                if (Request.IsAjaxRequest())
                {
                    return Json(new { cadastro = true });
                }
                else
                {
                    return RedirectToAction("Index");
                }
            } 
```

Javascript：

```
function editSucces(result) {
    if (result.cadastro) {
        $('#result').dialog('close');        
        window.location.href = '/usuario/index';
    } else{
        $('#result').html(result);
    } 
```

}

# linq - 实体框架/IQueryable 中的交叉连接语法

> ID：16201274
> 
> 赞同：2
> 
> 时间：2013-04-24T20:10:44.767
> 
> 标签：linq, entity-framework, linq-to-entities, iqueryable, linq-expressions

我正在尝试加深对 IQueryable 自定义提供程序和表达式树的了解。我对自定义解析交叉连接（即 SelectMany）感兴趣，我试图了解这是否正是 EF 在处理此问题时所做的事情：

```
var infoQuery =
    from cust in db.Customers
    from ord in cust.Orders
    where cust.City == "London"
    select ord; 
```

据称[EF 可以处理 cross joins](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/ea0fc561-3148-4afd-8b1f-01b49a23a4a7/)，尽管该链接中的语法对我来说看起来不正确。然后我为 EF找到了一个标题为“ [Cross Product Queries ”的链接。](http://msdn.microsoft.com/en-us/library/bb399397.aspx)语法看起来“正确”，但文章本身就好像这些是正常的内部连接而不是交叉连接。

事实上，上面的代码片段来自上一篇文章——这让我想知道 EF 是否只是说“我知道这两个实体是如何相关的，所以我将自动形成内部连接”。

EF 和这个所谓的“交叉连接”样本的真实故事是什么？

## 脚注

当我尝试构建自己的 IQueryable LINQ 提供程序时，我为自己设定的*教育*目标是为上面的代码片段创建自己的查询上下文，以便在查询上调用 ToList() 时：

1.  一个 Console.WriteLine() 被自动触发，打印“这是一个交叉连接：`Customer`和`Order`
2.  在查询被完全解释之前，运算符被神奇地转换为 a （可能是ExpressionVisitor `==`，[不确定](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expressionvisitor.aspx)）。`!=`

如果有人知道可以加快我的教育目标的文章或代码片段，请分享！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:44:59.710

仔细看语法：

```
from cust in db.Customers
from ord in cust.Orders       // cust.
select ... 
```

因为*`cust.Orders`*这是一个常规的内部连接。它甚至是进行连接的首选方式，因为它比常规的连接语句要简洁得多。

我不明白这篇“跨产品查询”文章的标题。首先，因为据我所知，“叉积”适用于三维向量而不是关系代数。其次，因为示例中没有单个交叉连接，只有内部连接。也许他们想说的是上面的语法*看起来像*一个交叉连接？但事实并非如此，所以在标题中如此突出地使用这个词只会让人感到困惑。

此代码段

```
from cust in db.Customers
from ord in db.Orders         // db.
select ... 
```

是真正的交叉连接（或笛卡尔积）。如果有`n`客户和`m`订单，则结果集包含 n * m 行。对订单和客户几乎没有用，但在两个序列中获取元素的所有组合可能很有用。如果您想加入但在加入中还需要第二个条件，则此构造也很有用，例如

```
from cust in db.Customers
from ord in db.Orders
where cust.CustomerId == ord.CustomerId && ord.OrderDate > DateTime.Today 
```

这有效地把它变成了一个内部连接。也许不是最好的例子，但在某些情况下这会派上用场。`join - on - equals`语法中不支持它。

# javascript - jQuery 的 $(form).submit() 仅针对 IE 不触发（MVC3 应用程序）

> ID：16201278
> 
> 赞同：7
> 
> 时间：2013-04-24T20:11:04.983
> 
> 标签：javascript, asp.net-mvc-3, forms, internet-explorer, submit

我一直在搜索互联网（包括 SO），我找不到任何可以帮助我解决我的情况的东西，所以希望我能从你们那里得到一些帮助。

基本上，就像标题所说的那样， .submit() 不会在 IE 中触发。所有其他浏览器都可以正常工作，但在 IE 中（目前有 8、9、10 个）它只是不会触发提交。

这是视图代码：

```
 <form id="@formId" method="post" enctype="multipart/form-data" action="@Url.Content("/ActivityEvent/SubmitCheckpointApproval")">
            <table id="checkpoint-approval" style="width:100%" align="center" class="noBorders">
                <tr>
                    <td style="width: 520px;">
                        <div>
                            Please enter any relevant comments:
                        </div>
                        <div style="margin: 10px 0;">
                            <textarea class="wysiwygSimple" rows="4" cols="60" name="comment" id="checkpoint-comment-@(actTplId)"></textarea>
                        </div>
                    </td>
                    <td style="border: 0; padding-top: 30px; text-align: center; width:70px;">
                        <img alt="key" src="/Content/Images/checkmarkInCircle.png" align="middle" style="width: 100px;
                            height: 100px;" /><br />
                        <p style="text-align: left; margin-top: 10px;">
                            The notes and resources entered here are shared with the student.</p>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" class="ResourcesUploadList">
                        Suggest some resources:<br />
                        <div style="float: left;">
                            <input class="Multi" type="file" name="resourceFiles[]" /></div>
                        <div style="float: left; margin-left: 10px; font-style: italic;">
                            (click browse for each file you want to upload)</div>
                        <div style="clear: both;">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 0; text-align: center; width:600px;" colspan="2">
                        @if (hasAdminRights)
                        {
                            <input type="button" @Html.Raw(btnStyle) class="activityApprove" name="actionApprove" id="actionApprove" value="Tutor Completion Approval" title = "Approves all activities preceding this checkpoint as complete." onclick="Activity.submitCheckpointApproval('@(formId)', '@(ActivityEvent.EVENT_TYPE_APPROVED)',@(actTplId));" />
                            <input type="button" @Html.Raw(btnStyle) class="activityAttention" name="actionAttention" id="actionAttention" value="Needs Attention" title = "Notifies the student that this project needs additional work prior to completion." onclick="Activity.submitCheckpointApproval('@(formId)', '@(ActivityEvent.EVENT_TYPE_NEEDS_ATTENTION)',@(actTplId));" /> 
                        }
                        <input type="button" @Html.Raw(btnStyle) value="Cancel" title = "Close this." onclick="javascript:$('#checkpoint-approval@(actTplId)').toggle();" />
                    </td>
                 </tr>
            </table>
        </form> 
```

单击按钮时：

```
Activity = {

submitCheckpointApproval: function (formId, activityEventStatusId, activityTemplateId) {
    var resultsDivId = $("#checkpointResults" + activityTemplateId);
    Activity.showCheckpointLoading(resultsDivId); //Just shows a spinner for loading
    $("#checkpoint-activityEventStatusId-" + activityTemplateId).val(activityEventStatusId);
    $("#" + formId).submit(); //PROBLEM IS HERE??
},
...
}; 
```

最后，控制器：

```
 [HttpPost]
    [ValidateInput(false)]
    public ActionResult SubmitCheckpointApproval()
         //Save everything in here
    } 
```

在 IE 中调试时，我进入 js 中的 .submit() 行，然后从那里运行它。在此之前的一切工作都很好，但随后 .submit() 来了，它停止做任何事情。没有 javascript 错误，控制台中没有任何内容，根本没有任何问题的迹象。在所有其他浏览器中， .submit() 触发得很好，控制器会中断被调用的方法。

关于为什么在 IE 中发生这种情况的任何想法？我敢肯定有人以前遇到过这个！请帮忙，我整个下午都在把头从桌子上敲下来！

多谢你们！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-03-19T18:57:13.137

我有一个类似的错误。我的解决方案是：

将 JS 表单附加到 DOM 中的 div 中，这样 IE 就知道它在那里并可以提交它。

希望能帮助到你

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-24T20:21:31.393

您可能最适合尝试`$.trigger()`在 jQuery 中使用该函数。

以类似于您调用的方式调用它`.submit()`：

```
$('#' + formId).trigger('submit'); 
```

祝你好运！

**还**

IE中存在一个错误，如果没有，表单将无法正确提交

```
 <input type="submit" value="Submit" /> element. 
```

尝试添加一个并用 CSS 隐藏它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-10T11:47:23.147

您可以在要发送的表单中创建输入提交，然后通过 Jquery 单击按钮。

它适用于 IE。

例如：

```
<form id="@formId" method="post" enctype="multipart/form-data" action="@Url.Content("/ActivityEvent/SubmitCheckpointApproval")">
<input type="submit" class="HiddenBtn" />
</form> 
```

和 JS：

```
$(".HiddenBtn").click(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-16T06:32:05.667

您需要将按钮/输入的类型设置`submit`为如下：

`<button type="submit">Submit</button>`

`<input type="submit" value="submit">Submit</button>`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-01T11:13:02.820

您能否告诉我您正在直接使用文件上传控件或其隐藏控件，并且您正在另一个按钮控件上触发/调用它？其实我有同样的问题。我的客户希望我们显示一个精美的按钮来作为文件上传控件。因此，我们添加了一个可见性为 false 的按钮和文件上传控件，在按钮单击时，我们触发了文件上传单击事件，并且在 jquery 的帮助下，我们获取了文件的路径并将其保存在数据库中。除了 IE 之外，所有浏览器中的一切都运行良好，因为表单没有像您解释的那样在 IE 中提交。经过真正的努力，我们找到了解决方案，解决方案是**我们展示了 fileupload 控件，并通过设置它的位置将它准确地放置在按钮的顶部，并应用了 css opacity :0。所以现在文件上传是不可见的，因为不透明度为 0，但是当用户点击花哨的按钮时，他/她实际上点击了 fileupload，因为它放置在 button 的顶部**。在此解决方案之后，它在每个浏览器中都像魅力一样工作。希望这对你也有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-30T16:34:57.813

IE11 的确切问题，至少是我的构建，导致 MS “你永远一无所知”，如果你允许我进行街头谈话的话。

是，当您创建这样的表单元素时

```
var formX = $(document.createElement('form')); 
```

并最终添加一些这样的字段

```
field1=$("<input type='hidden' id='myid' name='myid' value='whatever' />");
formX.append(field1); 
```

元素并没有真正添加到 DOM 中，它仍然存在于一些开发者炼狱中，等待你最终将它添加到 DOM 中

```
$("#formdiv").append(formX); 
```

正如 Arturo Igualada 上面评论的那样，您可以将其添加到 HTML 中的某个 div 中，在我的示例中 id **formdiv**

**最重要的是**，即使通过将动态表单附加到某个 DIV 来添加该元素，也不会在 DOM 中找到该元素。至少如果您使用 JQuery，因为常规选择器会在您加载页面时查找 DOM 中存在的元素。因此，您将需要使用某种选择来再次遍历 DOM 以搜索新添加的元素。我使用了**find**，尽管我猜想使用**.on**也应该可以。

```
$(document).find(formX).submit(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-09T07:38:34.907

我遇到了同样的问题，仅在 IE 10 和 IE 11 中。对我来说，解决方案是首先使用以下代码附加表单：

```
document.documentElement.appendChild(form); 
```

我把那行放在提交函数之前

```
form.on("submit", function (event) {
            event.preventDefault();
...more code
)} 
```

# python - Python - 将字符串转换为浮点数（传统方法 float() 在这种情况下不起作用）

> ID：16201286
> 
> 赞同：2
> 
> 时间：2013-04-24T20:11:34.427
> 
> 标签：python, type-conversion

在处理我们的一些数据时，我必须执行非常基本的列条件组合。填充空值后，试图在列中添加一个新变量的赋值。其中一列最终成为对象，这并非史无前例。然而，我发现看似有效的值不会转换为浮点数（例如 4,789.67）。经过大量搜索，似乎我看到的每个解决方案都指向存在不规则字符（这没有描述我的情况）。因此，我尝试在 IPython 中进行实验以重新创建错误，并且我成功了。但是，我不明白为什么会出现此错误：

测试

```
z='4,534.07' #initial assignment
print z
print type(z) #checked type
print repr(z) #tried to reveal hidden characters
print repr(z.replace("'","")) #tried to remove excess quotes
print z[1:-1] #tried again to remove excess quotes
print float(z) #failed conversion attempt 
```

输出

```
4,534.07
<type 'str'>
'4,534.07'
'4,534.07'
,534.0

---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-70-8a3c46ebe6ab> in <module>()
      6 print z[1:-1]
      7 print z
----> 8 print float(z)

ValueError: invalid literal for float(): 4,534.07 
```

我看到的基本转换问题的解决方案总是建议将“x”转换为浮点数->> float(x)。我将非常感谢任何能够解释我错过了什么的人。（我以前没有发生过这种情况。）

我一直在使用 Enthought 平台：

* * *

发行说明 Canopy 1.0.0.1160

天篷 1.0.0

第一次发布。请参阅 Documention Browser、Canopy 用户指南以获取描述新功能和任何已知问题和解决方法的发行说明

* * *

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:13:58.500

唯一的问题是您必须删除逗号。`4,534.07`不是有效的浮点文字，但是`4534.07`是。

（这正是 the`ValueError: invalid literal for float(): 4,534.07`告诉你的内容，只是它缺少“你的意思是......？”的建议。）

所以：

```
z='4,534.07'
print float(z.replace(',', '')) 
```

* * *

此外，所有那些“删除多余引号”的尝试都无济于事，因为字符串中没有引号。当然，当您打印出`repr`字符串时会有引号，但这并不意味着它们在字符串本身中，这意味着`repr`任何字符串的 都包含在一对额外的引号中。由于这些引号不在字符串中，因此它们不会影响您在该字符串上调用的任何函数（除非该函数确实做了一些非常非常愚蠢的事情，比如调用`repr`它的参数来构建一个要调用的字符串`eval`……）。

另外，即使问题*是*多余的引号，只是`print z[1:-1]`或`print z.replace("'", "")`实际上不会*将它们从`z`*中删除，它只会打印出如果你这样做了会是什么样子。要真正改变 的值`z`，你必须给它赋值。例如，如果您添加`print z.replace(',', '')`到现有代码中，`float(z)`仍然会失败。但是，如果您添加`z = z.replace(',', '')`，`float(z)`则将成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:17:51.650

我会用 re 替换任何不是数字或点的东西。像

```
>>> import re
>>> float(re.sub(r'[^0-9.]', '', '1.234,567'))
1.234567 
```

如果您关心符号，则在您的模式中包含 - 和 +

```
float(re.sub(r'[^-+\d.]', '', '-1.234,567')) 
```

# python-2.7 - Python Tornado：这安全吗？

> ID：16201292
> 
> 赞同：1
> 
> 时间：2013-04-24T20:11:49.633
> 
> 标签：python-2.7, security, tornado, cryptographic-hash-function

我在这里有点菜鸟，所以我试图找出一些关于网络安全的基础知识。我有一个非常基本的 Tornado 服务器正在运行，虽然它仅供我使用，但我想确保我没有犯任何明显的安全错误。

1）除了登录处理程序之外的每个处理程序都由`@tornado.web.authenticated`. 未经身份验证的用户是否可以提交给我的 AJAX 处理程序等？（即我需要为他们担心多少？）

2）这是我的登录和身份验证交易：

```
def do_auth(name, password):
  with open(auth_file) as f:
    lines = f.readlines()
  for l in lines:
    u,s,h = l.strip().split(':')
    if name == u:
      s5 = hashlib.sha512()
      s5.update(s.decode('hex'))
      s5.update(password)
      if h == s5.hexdigest():
        return True
  return False

class LoginHandler(BaseHandler):
  def get(self):
    self.write('<html><body><form action="/login" method="post">'
               'Name: <input type="text" name="name"><br />'
               'Password: <input type="password" name="password"><br />'
               '<input type="submit" value="Sign in">'
               '</form></body></html>')

  def post(self):
    if do_auth(self.get_argument("name"), self.get_argument("password")):
      self.set_secure_cookie("user", self.get_argument("name"))
      self.redirect("/")
    else:
      self.redirect("/login") 
```

关键是不受信任的输入仅用于 python 的 urllib.sha512.update() 函数和字符串比较。这是“安全的”吗？[注意：授权文件是手工制作的，代码中没有更改它的功能。]

3）一般来说，我还应该担心什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:06:48.963

让我尝试回答其中的一些问题：

(1)

> > 除了登录处理程序之外的每个处理程序都由@tornado.web.authenticated 修饰。未经身份验证的用户是否可以提交给例如 AJAX 处理程序

如果您的 AJAX 处理程序使用 @tornado.web.authenticated 修饰，则用户必须登录才能调用它。

如果它没有被装饰，任何人都可以访问它，并且您可以使数据公开可见和/或可写。公开可见可能没问题，但公开可写可能不好。这取决于你的数据是什么。

(2) 你不需要编写自己的 do_auth() 函数只是一个

```
def get_login_url(self):
        return u"/login" 
```

指向您的登录页面的函数

# java - JSON lib 来处理循环引用和抽象类？

> ID：16201293
> 
> 赞同：0
> 
> 时间：2013-04-24T20:11:53.667
> 
> 标签：java, json, serialization

我正在寻找一个可以

*   序列化 List() 和嵌套列表等集合
*   可以与循环引用竞争，这在休眠映射中经常发生
*   可以处理带有实现抽象类的对象的列表

我试过：

*   Gson（既没有抽象类也没有循环 dep 支持。有一些 hack 额外的类，但它们不能很好地工作）

*   flexjson（深度列表有问题）

有什么东西可以通过不必应用“hacky”的东西来处理所有这些吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:46:58.573

也许使用 YAML 而不是 JSON 是一种选择？YAML 是 JSON 的超集，内置了对循环引用和高级数据类型的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:59:58.463

尝试使用自定义循环引用处理的[http://x-stream.github.io/](http://x-stream.github.io/)（快速且功能丰富）或[http://json-lib.sourceforge.net （如@Cleber Alberto 建议的那样）。](http://json-lib.sourceforge.net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T08:42:30.133

我终于发现 JACKSON 非常直观且易于配置，可以满足我的所有需求。 [https://github.com/FasterXML/jackson-annotations](https://github.com/FasterXML/jackson-annotations)

# java - 服务器接受套接字，但之后套接字无法接收任何内容

> ID：16201298
> 
> 赞同：0
> 
> 时间：2013-04-24T20:12:12.953
> 
> 标签：java, sockets, client-server

在构建客户端-服务器聊天程序时，我遇到了一个非常奇怪的问题（因为以前总是这样）。

服务器套接字毫无问题地接受客户端的传入连接，但是当我尝试从套接字的输入流中读取时，整个方法会阻塞并且仅在我关闭客户端的套接字时才释放。

我什至用 docs.oracle.com 上的示例代码尝试过它，但问题仍然存在。

谁能指出我显然没有看到的错误？

服务器代码：

```
public class Server {

/**
 * @param args the command line arguments
 */
public static void main(String[] args) throws IOException {
    System.out.println("Creating server socket");

    ServerSocket internetSocket = new ServerSocket(60000);
    if(!internetSocket.isClosed()) {

        while(true) {
            Socket s = internetSocket.accept();
            System.out.println("accepted socket!");

            BufferedReader reader = new BufferedReader(new InputStreamReader(s.getInputStream()));

            String line = null;
            while((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        }
    }
}
} 
```

客户端代码：

```
public class Client {

public static void main(String[] args) throws IOException {
    Socket s = null;
    try {
        s = new Socket("localhost", 60000);
    } catch (UnknownHostException ex) {
        Logger.getLogger(Start2.class.getName()).log(Level.SEVERE, null, ex);
    }

    PrintWriter outStream = new PrintWriter(s.getOutputStream());
    for(int i=0; i<10; i++) {
        outStream.println("test");
        System.out.println("Sending the message \"test\"");

        try {
            Thread.sleep(5000);
        } catch (InterruptedException ex) {
            Logger.getLogger(Start2.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    s.close();
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:27:41.830

[您在创建 printwriter printwriter](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#PrintWriter%28java.io.Writer,%20boolean%29)时忘记添加 true 作为第二个参数

```
new PrintWriter(s.getOutputStream(), true); 
```

它会自动冲洗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:15:48.380

该方法`readLine()`正在等待 \n 字符出现在流中（该方法阻塞，直到它看到结束行分隔符）。

尝试`"test\\n"`从客户端发送，看看会发生什么。

并记住`flush()`客户端的输出流

# python - Python Newaxis vs for 循环

> ID：16201303
> 
> 赞同：2
> 
> 时间：2013-04-24T20:12:21.637
> 
> 标签：python, loops, numpy

我正在努力使我的程序更快。我有一个矩阵和一个向量：

```
GDES = N.array([[1,2,3,4,5],
[6,7,8,9,10],
[11,12,13,14,15],
[16,17,18,19,20],
[21,22,23,24,25]])
Ene=N.array([1,2,3,4,5])
NN=len(GDES); 
```

我定义了一个矩阵乘法函数：

```
def Gl(n,np,k,q):
    matrix = GDES[k,np]*GDES[k,n]*GDES[q,np]*GDES[q,n]
    return matrix 
```

我在计算中做了一个 for 循环：

```
SIl = N.zeros((NN,NN),N.float)
for n in xrange(NN):
    for np in xrange(NN):
        SumJ = N.sum(N.sum(Gl(n,np,k,q) for q in xrange(NN)) for k in xrange(NN))
        SIl[n,np]=SumJ 

print 'SIl:',SIl 
```

输出：

```
SIl: [[ 731025\. 828100\. 931225\. 1040400\. 1155625.]
[ 828100\. 940900\. 1060900\. 1188100\. 1322500.]
[ 931225\. 1060900\. 1199025\. 1345600\. 1500625.]
[ 1040400\. 1188100\. 1345600\. 1512900\. 1690000.]
[ 1155625\. 1322500\. 1500625\. 1690000\. 1890625.]] 
```

我想用`newaxis`它来让它更快：

```
def G():
    Mknp = GDES[:, :, N.newaxis, N.newaxis]
    Mkn = GDES[:, N.newaxis, :, N.newaxis]
    Mqnp = GDES[:, N.newaxis, N.newaxis, :]
    Mqn = GDES[N.newaxis, :, :, N.newaxis]
    matrix=Mknp*Mkn*Mqnp*Mqn
    return matrix

tmp = G()
MGI = N.sum(N.sum(tmp,axis=3), axis=2)
MGI = N.reshape(MGI,(NN,NN))
print 'MGI:', MGI 
```

输出：

```
MGI: [[ 825 3900 9225 16800 26625]
[ 31200 92400 169600 262800 372000]
[ 146575 413400 722475 1073800 1467375]
[ 403200 1116900 1911600 2787300 3744000]
[ 857325 2352900 3980725 5740800 7633125]] 
```

知道我怎样才能得到正确的答案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T23:48:07.193

您的问题非常适合[`np.einsum`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.einsum.html)：

```
>>> GDES = np.arange(1, 26).reshape(5, 5)
>>> np.einsum('kj,ki,lj,li->ij', GDES, GDES, GDES, GDES)
array([[ 731025,  828100,  931225, 1040400, 1155625],
       [ 828100,  940900, 1060900, 1188100, 1322500],
       [ 931225, 1060900, 1199025, 1345600, 1500625],
       [1040400, 1188100, 1345600, 1512900, 1690000],
       [1155625, 1322500, 1500625, 1690000, 1890625]]) 
```

对于您的特定情况，这种其他语法可能更容易弄清楚：

```
>>> np.einsum(GDES, [2,1], GDES, [2,0], GDES, [3,1], GDES, [3,0], [0,1])
array([[ 731025,  828100,  931225, 1040400, 1155625],
       [ 828100,  940900, 1060900, 1188100, 1322500],
       [ 931225, 1060900, 1199025, 1345600, 1500625],
       [1040400, 1188100, 1345600, 1512900, 1690000],
       [1155625, 1322500, 1500625, 1690000, 1890625]]) 
```

# ios - ios通过垂直线滑动

> ID：16201304
> 
> 赞同：0
> 
> 时间：2013-04-24T20:12:31.830
> 
> 标签：ios, swipe, gesture

我正在尝试从主视图的顶部到底部制作一条垂直线，当有人从任一方向滑动并越过这条线时，它将触发一个动作。我已经尝试过创建一个又高又薄的标签并在其中放置一个滑动识别器，但它并没有按照我想要的方式工作。它仅在您从标签内部开始并滑动时检测到滑动，但如果您从标签外部开始并穿过它，则不会检测到滑动。

到目前为止，这是我的代码，

```
UISwipeGestureRecognizer *swipe = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(doSomething)];
swipe.direction = UISwipeGestureRecognizerDirectionLeft | UISwipeGestureRecognizerDirectionRight;
swipe.numberOfTouchesRequired = 1;
[self.myLabel setUserInteractionEnabled:YES];
[self.myLabel addGestureRecognizer:swipe]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:16:19.237

最简单的方法是在 a 上使用`touchesBegan:`and`touchesMoved:`方法`UIView`来确定它是否越过中线。然后，您只需在此视图之上添加一个视图（您的线），并且您可能希望禁用“线”视图上的用户交互。顺便说一句，创建线条的一种快速肮脏的方法是创建一个 2px 宽（或您想要的任何宽度）的视图，并将其背景颜色设置为您的“线条”颜色......

你需要决定`touchesBegan:`他们从哪一边开始，然后在下面做这样的事情`touchesMoved:`：

```
- (void) touchesMoved: (NSSet *)touches withEvent:(UIEvent *)event {
    CGPoint tappedPt = [[touches anyObject] locationInView: self];
    if (tappedPt.x > self.frame.width/2 && self.userStartedOnLeftSide)
        // User crossed the line...
    else if (tappedPt.x < self.frame.width/2 && !self.userStartedOnLeftSide)
        // User crossed the line...
    else
        // You probably don't need this else, the user DID NOT cross the line...
} 
```

同样，您可以使用类似`UIViewController`这样的滑动手势识别器来执行此操作：

```
- (void)swipe:(UISwipeGestureRecognizer *)recognizer{
   CGPoint point = [recognizer locationInView:[recognizer view]];
   if (recognizer.state == UIGestureRecognizerStateBegan)
       // The user began their swipe at point
   else if (recognizer.state == UIGestureRecognizerStateEnded)
       // The user ended their swipe at point
   // Add some logic to decide if they crossed the line... 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:50:40.563

如果你只是想检测左右滑动，你可以把它放在你的主视图上，如下所示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    UISwipeGestureRecognizer *swipe;

    swipe = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
    swipe.direction = UISwipeGestureRecognizerDirectionLeft;
    [self.view addGestureRecognizer:swipe];

    swipe = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
    swipe.direction = UISwipeGestureRecognizerDirectionRight;
    [self.view addGestureRecognizer:swipe];
}

- (void)handleSwipe:(UISwipeGestureRecognizer *)gesture
{
    NSLog(@"%d", [gesture numberOfTouches]);

    if (gesture.direction == UISwipeGestureRecognizerDirectionLeft)
    {
        NSLog(@"LEFT");
    }
    if (gesture.direction == UISwipeGestureRecognizerDirectionRight)
    {
        NSLog(@"RIGHT");
    }
} 
```

如果你想真正测试看看你是否越过了中点，你可以使用`UIPanGestureRecognizer`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self.view addGestureRecognizer:[[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)]];
}

- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static CGPoint startLocation;
    static BOOL startAtLeft;

    CGPoint location = [gesture locationInView:gesture.view];

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        startLocation = location;
        startAtLeft = (location.x < (gesture.view.frame.size.width / 2.0));
    }
    else if (gesture.state == UIGestureRecognizerStateEnded)
    {
        BOOL nowAtLeft = (location.x < (gesture.view.frame.size.width / 2.0));
        if (startAtLeft != nowAtLeft)
        {
            if (startAtLeft)
                NSLog(@"swiped across midpoint, left to right");
            else
                NSLog(@"swiped across midpoint, right to left");
        }
    }
} 
```

使用平移手势，您可以根据自己的意愿对其进行自定义（例如，只要用户手指交叉就识别手势，而不是等待他们结束手势等）。

# matlab - 点积：* 命令与循环给出不同的结果

> ID：16201305
> 
> 赞同：4
> 
> 时间：2013-04-24T20:12:33.797
> 
> 标签：matlab, floating-point, floating-accuracy, dot-product

我在 Matlab 中有两个向量，`z`并且`beta`. 向量`z`是 1x17：

`1 0.430742139435890 0.257372971229541 0.0965909090909091 0.694329541928697 0 0.394960106863064 0 0.100000000000000 1 0.264704325268675 0.387774594078319 0.269207605609567 0.472226643323253 0.750000000000000 0.513121013402805 0.697062571025173`

...并且`beta`是 17x1：

`6.55269487769363e+26 0 0 -56.3867588816768 -2.21310778926413 0 57.0726052009847 0 3.47223691057151e+27 -1.00249317882651e+27 3.38202232046686 1.16425987969027 0.229504956512063 -0.314243264212449 -0.257394312588330 0.498644243389556 -0.852510642195370`

我正在处理一些奇点问题，我注意到如果我想计算 的点积`z*beta`，我可能会得到 2 个不同的解决方案。如果我使用`*`命令，`z*beta = 18.5045`. 如果我编写一个循环来计算点积（如下），我会得到 0.7287 的解。

```
summation=0;
for i=1:17
    addition=z(1,i)*beta(i);
    summation=summation+addition;
end 
```

知道这里发生了什么吗？

这是数据的链接：[https ://dl.dropboxusercontent.com/u/16594701/data.zip](https://dl.dropboxusercontent.com/u/16594701/data.zip)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T20:41:43.277

这里的问题是浮点数的加法**不是关联**的。当对一系列相当数量的数字求和时，这通常不是问题。但是，在您的序列中，大多数数字都在 1 或 10 左右，而几个条目的大小为 10^26 或 10^27。在这种情况下，数值问题几乎是不可避免的。

维基百科页面[http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)`(a + b) + c`显示了一个不等于的工作示例`a + (b + c)`，即证明您添加浮点数的顺序确实很重要。

我猜这是一项旨在说明这些确切问题的家庭作业。如果没有，我会询问数据代表什么以找出适当的方法。首先找出为什么会产生如此大量的数字可能比试图理解包含它们的点积更有效率。

# javascript - 如何定位相同的多个实例 .class 一次一个？

> ID：16201307
> 
> 赞同：0
> 
> 时间：2013-04-24T20:12:34.920
> 
> 标签：javascript, jquery, arrays

我目前有同一类的 x 重复设置：

```
<div class="span3">..content1</div>
<div class="span3">..content2</div>
<div class="span3">..content3</div> 
```

如何单独定位每个 .span3 类而不为每个类添加一些唯一的 id？这甚至可能吗？

我想要做的是一次在每个 .span3 上应用一些动画，每个动画之间有一点延迟 - 比如一次淡化一个 .span3 类，或者做一些其他动画，比如从 0 到 1 的缩放。

试图弄清楚我是否可以以某种方式将它们添加到数组中？从那里开始， id 就可以做任何我想做的事情来遍历数组。

更多 HTML 上下文中的 .span 类：

```
<div class="row-fluid">
      <div class="span3">
        <span>Headline</span>
        <img src="images/thumb_1.gif" class="img-polaroid">
      </div>
      <div class="span3 frameColor_yellow">
        <span>Headline</span>
        <img src="images/thumb_2.gif" class="img-polaroid">
      </div>
</div>
<div class="row-fluid">
      <div class="span3">
        <span>Headline</span>
        <img src="images/thumb_3.gif" class="img-polaroid">
      </div>
      <div class="span3 frameColor_yellow">
        <span>Headline</span>
        <img src="images/thumb_4.gif" class="img-polaroid">
      </div>
</div>
//etc... 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:14:33.153

像这样 -

```
$('.span3').each(function(index,element){
    var sp = $(this);
    // do your stuff with this span
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:21:35.747

尝试这个：

```
$(".row-fluid > .span3").each(function (index) {
    $(this).delay(index * 500).animate({
        opacity: 0
    }, 500);
}); 
```

[**小提琴**](http://jsfiddle.net/mYMYX/1/)

根据@Rodrigo 的建议更新了答案！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:23:03.087

可能您想将所有 span3 包装在一个容器中，可以说

```
<div class="my-loop-divs">
   <div class="span3"></div>
   <div class="span3"></div>
</div> 
```

我假设您使用的是 zepto 或 jQuery

```
$(document).ready(function () {
    $('.my-loop-divs .span3').each(function (index, element) {
        // do the animation on $(this)
    });
}); 
```

# html - Ruby on Rails 如何在索引视图中包含表单

> ID：16201311
> 
> 赞同：1
> 
> 时间：2013-04-24T20:12:51.830
> 
> 标签：html, ruby-on-rails, ruby

我已经把头撞到墙上好几个小时了，我无法完成这项工作。我正在尝试添加一堆复选框来验证我的索引页面上的项目。我发现[这个](http://railscasts.com/episodes/52-update-through-checkboxes?view=comments)旧的 rails cast 完全符合我的要求，但我遇到了问题。包含在我的表单中的任何内容都会从索引页面中删除，就像刚刚消失一样。这是索引视图中的代码。

```
 <% form_tag verify_products_path, :method => :put do %>
    <% @products_unverified.each do |products| %>
      <% if product.deleted != 'true' %>
        <tr data-link="<%= product_path(product) %>">
          <td><%= product.name %></td>
          <td><%= product.description %></td>
        </tr>
      <% end %>
    <% end %>
    <%= submit_tag "Mark as Verified" %>
  <% end %>
  </tbody> 
```

这是路线的东西

```
 resources :products do
    put :verify, :on => :collection
  end 
```

控制器现在只有一个虚拟方法。

```
def verify

end 
```

关于为什么在引入表单时索引视图会空白的任何线索？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:15:09.030

在 form_tag 前面放一个 = 而不是

```
<% form_tag verify_products_path, :method => :put do %> 
```

尝试

```
<%= form_tag verify_products_path, :method => :put do %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:15:44.747

你忘记了`=`之前的`form_tag`：

```
<%= form_tag verify_products_path, :method => :put do %> 
```

# c# - WebClient 将文件下载到 0KB？

> ID：16201318
> 
> 赞同：2
> 
> 时间：2013-04-24T20:13:29.553
> 
> 标签：c#, webclient

我需要覆盖的文件在我的本地机器上。我正在检索的文件来自我的 FTP 服务器。这些文件都具有相同的名称，但字节不同，例如，它们被更新。

我将本地计算机上的文件用作目标文件——这意味着我使用它们的名称可以在 FTP 服务器上轻松找到它们。

这是我写的代码：

```
private void getFiles () {

    string startupPath = Application.StartupPath;
    /*
     * This finds the files within the users installation folder
     */
    string[] files = Directory.GetFiles(startupPath + "\\App_Data", "*.*",
    SearchOption.AllDirectories);

    foreach (string s in files)
    {
        /*
         * This gets the file name
         */
        string fileName = Path.GetFileName(s);
        /*
         * This gets the folder and subfolders after the main directory
         */
        string filePath = s.Substring(s.IndexOf("App_Data"));
        downloadFile("user:pass@mysite.tk/updates/App_Data/" + fileName,
        startupPath + "\\" + filePath);
    }
}

private void downloadFile (string urlAddress, string location)
{
    using (WebClient webClient = new WebClient())
    {
        System.Uri URL = new System.Uri("ftp://" + urlAddress);
        webClient.DownloadFileAsync(URL, location);
    }
} 
```

代码完成后，由于某种原因，子文件夹中的文件显示为 0KB。这很奇怪，因为我知道我的 FTP 服务器上的每个文件都大于 0KB。

我的问题是：为什么子文件夹中的文件显示为 0KB？

如果这篇文章不清楚，请告诉我，我会尽力澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:34:31.110

为了回答评论中的问题，以下是一种可能的方法，但目前尚不清楚是否`getFiles`应该是阻塞方法。在我的示例中，我假设它是（在所有下载完成之前该方法不会退出）。我不确定它的功能，因为我是在脑海中写下这个，但它是一个一般的想法。

```
private void getFiles () {

    string startupPath = Application.StartupPath;
    /*
     * This finds the files within the users installation folder
     */
    string[] files = Directory.GetFiles(startupPath + "\\App_Data", "*.*",
        SearchOption.AllDirectories);
    using (WebClient client = new WebClient())
    {
        int downloadCount = 0;
        client.DownloadDataCompleted += 
            new DownloadDataCompletedEventHandler((o, e) => 
            {
                    downloadCount--;
            });
        foreach (string s in files)
        {
            /*
             * This gets the file name
             */
            string fileName = Path.GetFileName(s);
            /*
             * This gets the folder and subfolders after the main directory
             */
            string filePath = s.Substring(s.IndexOf("App_Data"));
            downloadFile(client, "user:pass@mysite.tk/updates/App_Data/" + fileName,
            startupPath + "\\" + filePath);
            downloadCount++;
        }
        while (downloadCount > 0) { }
    }
}

private void downloadFile (WebClient client, string urlAddress, string location)
{
    System.Uri URL = new System.Uri("ftp://" + urlAddress);
    client.DownloadFileAsync(URL, location);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:35:03.797

您可以为此使用 FTPWebRequest。

[http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)

# php - PHP：从站点抓取数据时连接中止

> ID：16201319
> 
> 赞同：0
> 
> 时间：2013-04-24T20:13:30.910
> 
> 标签：php

我正在从一个列出一些产品的网站上抓取，我已经将产品页面的 url 保存在数据库中，并循环遍历表格以获取 url 并使用简单的 html dom 解析器进行抓取，我正在使用以下代码。

```
<?php
error_reporting(E_ALL);
ignore_user_abort(true);
require_once('lib/simple_html_dom.php');
set_time_limit(0);
ini_set('memory_limit', '1024M');
ini_set('max_input_time ', '99999');
$catid = $_REQUEST['catid']; //passing category id from url
//getting category product url's from DB.
$query = mysql_query("select * from cat_prod where catid='".$catid."' ") or die(mysql_error());
if($query){

    while($arr = mysql_fetch_array($query)){

        $html = file_get_html($arr['purl']);

            if(is_object($html)){
                $i=1;   
                foreach ( $html->find('h1') as $elem ){
                    if(is_object($elem) && isset($elem))
                        echo $i.' : '.$elem->plaintext.'<br/>';
                    if($i==2) exit;
                $i++;   
                }
                $html->clear();
                unset($html);
            }
    }
}

?> 
```

当我在一次迭代后终止执行时它很好，但不止一次它抛出连接中止错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-20T20:56:32.340

尝试在循环中加入睡眠。您可能正在使用 DOS 攻击来攻击该网站。

此外，您的脚本存在 SQL 注入问题`$catid`

# perl - Perl 词性标记：需要为 Lingua::EN::Tagger 设置标记

> ID：16201320
> 
> 赞同：1
> 
> 时间：2013-04-24T20:13:41.190
> 
> 标签：perl

所以，我想使用 Lingua::EN::Tagger，但我似乎找不到标签的域（也就是词性：即 MD、NN 等。

我在这里找到了与我想要的类似的东西：http: [//engtagger.rubyforge.org/](http://engtagger.rubyforge.org/) 但这是用于 ruby​​，而不是 perl，我不确定标签是否会完全相同。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:23:09.790

标签集在 Lingua0EN-Tagger-0.23 ( [http://cpansearch.perl.org/src/ACOBURN/Lingua-EN-Tagger-0.23/README](http://cpansearch.perl.org/src/ACOBURN/Lingua-EN-Tagger-0.23/README) )的自述文件中可用

```
Lingua::EN::Tagger 

This module uses part-of-speech statistics from the Penn Treebank
to assign POS tags to English text. The tagger applies a bigram (two-word)
Hidden Markov Model to guess the appropriate POS tag for a word.  That means
that the tagger will try to assign a POS tag based on the known POS tags
for a given word and the POS tag assigned to its predecessor.

The tagger tends to assume unknown words are nouns, but this behavior is 
configurable.

The POS tagger can also be used to find maximal noun phrases in tagged text.  
You can also use this module to extract all nouns and/or noun phrases.

TAG SET

----------------------------------------------------------------
The set of POS tags used here is a modified version of the
Penn Treebank tagset. Tags with non-letter characters have been 
redefined to work better in our data structures. Also, the 
``Determiner'' tag (DET) has been changed from `DT', in order to
avoid confusion with the HTML tag, <DT>. 
-----------------------------------------------------------------
CC      Conjunction, coordinating               and, or
CD      Adjective, cardinal number              3, fifteen
DET     Determiner                              this, each, some
EX      Pronoun, existential there              there
FW      Foreign words           
IN      Preposition / Conjunction               for, of, although, that
JJ      Adjective                               happy, bad
JJR     Adjective, comparative                  happier, worse
JJS     Adjective, superlative                  happiest, worst
LS      Symbol, list item                       A, A.
MD      Verb, modal                             can, could, 'll
NN      Noun                                    aircraft, data
NNP     Noun, proper                            London, Michael
NNPS    Noun, proper, plural                    Australians, Methodists
NNS     Noun, plural                            women, books
PDT     Determiner, prequalifier                quite, all, half
POS     Possessive                              's, '
PRP     Determiner, possessive second           mine, yours
PRPS    Determiner, possessive                  their, your
RB      Adverb                                  often, not, very, here
RBR     Adverb, comparative                     faster
RBS     Adverb, superlative                     fastest
RP      Adverb, particle                        up, off, out
SYM     Symbol                                  *
TO      Preposition                             to
UH      Interjection                            oh, yes, mmm
VB      Verb, infinitive                        take, live
VBD     Verb, past tense                        took, lived
VBG     Verb, gerund                            taking, living
VBN     Verb, past/passive participle           taken, lived
VBP     Verb, base present form                 take, live
VBZ     Verb, present 3SG -s form               takes, lives
WDT     Determiner, question                    which, whatever
WP      Pronoun, question                       who, whoever
WPS     Determiner, possessive & question       whose
WRB     Adverb, question                        when, how, however

PP      Punctuation, sentence ender             ., !, ?
PPC     Punctuation, comma                      ,
PPD     Punctuation, dollar sign                $
PPL     Punctuation, quotation mark left        ``
PPR     Punctuation, quotation mark right       ''
PPS     Punctuation, colon, semicolon, elipsis  :, ..., -
LRB     Punctuation, left bracket               (, {, [
RRB     Punctuation, right bracket              ), }, ] 
```

# node.js - 画布上的元素随着 jsfiddle 消失

> ID：16201321
> 
> 赞同：0
> 
> 时间：2013-04-24T20:13:44.160
> 
> 标签：node.js, canvas, html5-canvas, fabricjs

我在画布中使用 fabric.js 时遇到问题。以 5 倍的比例因子调整大小后，单击 ZoomIn 2 次，画布上的元素消失。请看：http: [//jsfiddle.net/ptCoder/Q3TMA/90/](http://jsfiddle.net/ptCoder/Q3TMA/90/)

画布尺寸（仅举例）：

```
<canvas id="c" width="400" height="400"></canvas> 
```

缩放比例因子：

```
var SCALE_FACTOR = 5; 
```

有什么解决办法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:43:31.390

问题是你也在调整画布的大小，所以缩放 2 倍后，它的大小是 10000px * 10000px，意思是 100 兆像素，需要几百兆的内存。

如果您保持画布大小不变（像[这样](http://jsfiddle.net/Q3TMA/91/)），或者将其限制为足够小的值，则缩放将按预期工作。

要保持大小不变​​，您只需删除这两行：

```
canvas.setHeight(canvas.getHeight() * SCALE_FACTOR);
canvas.setWidth(canvas.getWidth() * SCALE_FACTOR); 
```

# c# - c# LDAP 成员资格枚举

> ID：16201322
> 
> 赞同：1
> 
> 时间：2013-04-24T20:13:52.887
> 
> 标签：c#, active-directory, ldap

这是我的问题：我需要枚举 Active Directory 中某些组的成员。复杂之处在于组的“membersOf”属性中的对象的 DN 不包含我需要的标识符。具体来说，`CN`用户对象的 对我来说没用，只有用户对象的一个​​属性（`userID`）是有用的。

于是想到了三种方法：

1.  我可以先枚举组以获取组中的列表`DN`，然后查找每个用户 DN 以找出他们的`userID`

2.  我可以枚举广告中的每个用户，获取他们`userID`的`membersOf`收藏，然后检查他们是否拥有正确的会员资格。

3.  `CN`我可以使用他们的 ' 和'获取所有用户的列表`userID`，然后枚举组以获取成员 CN。然后我可以加入原始列表中的列表以获取我的成员列表`userID`。

一些问题立即出现 - 选项 1) 将生成大量子查询和拥塞网络流量（不受欢迎），选项 2) 从 AD 中提取大量数据（大约 30mb）。选项 3) 处于中间状态 - 但它仍然会提取大量数据并且有多个查询。是否有另一种选择可以做到这一点而没有这些问题？

我正在使用`System.DirectoryServices`工具在 c# 中执行此操作。

提前感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:37:07.223

也许还有一个选项＃4：

*   你可以设置一个`DirectorySearcher`枚举用户
*   您可以定义`memberOf=.......`为您的搜索条件之一
*   您可以很容易地从目录搜索器中定义您需要的属性

如果这行得通（而且我的印象是我以前就可以做到这一点 - 但已经有一段时间了！）然后你可以做一个单一的相当集中的搜索并自动获取你需要的信息。

尝试这样的事情：

```
// define the "root" of your search (where to begin)
DirectoryEntry searchRoot = new DirectoryEntry("LDAP://cn=users,dc=yourcompany,dc=com");

DirectorySearcher searcher = new DirectorySearcher(searchRoot);

// set properties
searcher.SearchScope = SearchScope.Subtree;

// define search filter
searcher.Filter = "(&(objectCategory=Person)(memberof=CN=YourGroup,OU=Users,DC=YourDomain,DC=com))";

// define attributes to load
searcher.PropertiesToLoad.Add("userid"); 
... add more if needed .....

foreach(SearchResult entry in searcher.FindAll())
{
   string userid = entry.Properties["userid"][0].ToString();
} 
```

# ios - 我可以将 AVAudioRecorder 与外部麦克风一起使用吗？

> ID：16201327
> 
> 赞同：1
> 
> 时间：2013-04-24T20:13:58.640
> 
> 标签：ios, objective-c, core-audio, avaudiorecorder

对不起，如果这个问题很明显或重复。我 30 分钟的研究让我一无所获。

我们有一个 iPhone 应用程序，可以将视频从设备实时传输到我们的远程 Wowza 服务器。我们希望将 Swivl（运动跟踪三脚架）集成到我们的产品中，它使用无线麦克风连接到我们 iPhone 的 30 针端口。Swivl 的 SDK 不包含任何关于从其硬件捕获音频的内容，因此我认为它将由 iPhone 本身处理。

如果我使用 AVAudioRecorer，它会自动从 30 针端口而不是默认麦克风路由音频输入，还是我必须明确定义音频源？

任何线索都有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:22:42.417

经过几次测试，iOS 似乎自动路由传入的音频信号。无需明确指定音频的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:24:55.250

直接来自 AVAudioRecorder 文档：

在 iOS 中，录制的音频来自用户连接的设备——例如内置麦克风或耳机麦克风。在 OS X 中，音频来自用户在系统偏好设置中设置的系统默认音频输入设备。

# django - Django加好友查询

> ID：16201329
> 
> 赞同：1
> 
> 时间：2013-04-24T20:14:16.053
> 
> 标签：django, django-queryset

我正在尝试创建一个查询，在其中检索登录用户的所有“活动”及其按最近排序的“朋友”。（使用 Django-Simple-Friends 连接朋友）。

以下查询非常适合检索按最近排序的登录用户的所有活动，但我不确定如何还包括用户的连接“朋友”。

```
activity = Activity.objects.filter(user=request.user).order_by('-created_date') 
```

我的活动课是：

```
class Activity(models.Model):
    user = models.ForeignKey(User)
    created_date = models.DateTimeField(default=datetime.now)
    activity_type = models.IntegerField(default=0) 
```

我很感激时间和专业知识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:14:56.953

以这种方式尝试查询：

```
friend_user_list = list(friends_list) + [request.user]
activity = Activity.objects.filter(user__in=friend_user_list).order_by('-created_date') 
```

我正在尝试做的是连接到列表，`[request.user]`以及他们的朋友列表（假设这`friends`是友谊关系的相关名称），并且`user__in`应该修改 WHERE 条件以允许列表中的所有用户满足查询。

希望能帮助到你。

# java - 网格布局无法正确显示

> ID：16201336
> 
> 赞同：0
> 
> 时间：2013-04-24T20:14:38.120
> 
> 标签：java, swing

我正在尝试构建带有显示屏和 9 个按钮的简单计算器 gui

```
public void init()
    {
        setSize(60,80);
        inf = new InfoButton(this);
        zero = new CalcButton(this,"0");
        one = new CalcButton(this,"1");
        add = new CalcButton(this,"+");
        sub = new CalcButton(this,"-");
        div = new CalcButton(this,"/");
        mlt = new CalcButton(this,"*");
        modu = new CalcButton(this,"%");
        blank = new JButton("");
        wys = new Wyswietlacz(); // its JTextPane
        wys.setSize(60,20);
        przyciski = new JPanel();
        przyciski.setSize(60,60);
        przyciski.setLayout(new GridLayout(3,3));
        przyciski.add(zero);
        przyciski.add(one);
        przyciski.add(add);
        przyciski.add(sub);
        przyciski.add(mlt);
        przyciski.add(div);
        przyciski.add(modu);
        przyciski.add(inf);
        przyciski.add(blank);
        calosc = new JPanel();
        calosc.setLayout(new BoxLayout(calosc,BoxLayout.Y_AXIS));
        calosc.add(wys);
        calosc.add(przyciski);
        calosc.setSize(60,80);
        add(calosc);

    } 
```

主要是我制作有大小的框架，`(60,80)`但是当我让它可见时，我能看到的只是显示和一排按钮。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:38:19.017

在 wys 和 przyciski 上调用 setPreferredSize(..) 而不是 setSize()。然后使用 JFrame 的 pack() 而不是为其指定大小。

# ruby-on-rails - 在屏幕上以相反的顺序打印 ruby on rails backstraces/stracktraces/errorss

> ID：16201338
> 
> 赞同：2
> 
> 时间：2013-04-24T20:14:43.733
> 
> 标签：ruby-on-rails, ruby, debugging, runtime-error, stack-trace

这是我对 rails 中的 strack 跟踪的烦恼——它们首先打印错误，这意味着查看任何错误，您已经在您的 termanl 中向上滚动以查看错误是什么。

有没有一种方法可以以相反的顺序打印错误和 stracktrace，因此您无需滚动即可查看错误。例如：

这是 rails/ruby 当前打印的 stracktraces：

```
 /activesupport/lib/active_support/dependencies.rb:228:in `require': cannot load such file -- pry (LoadError)
        from /activesupport/lib/active_support/dependencies.rb:228:in `block in require'
        from /activesupport/lib/active_support/dependencies.rb:213:in `load_dependency'
        from /activesupport/lib/active_support/dependencies.rb:228:in `require'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:307:in `normalize_path'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:79:in `normalize_path!'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:65:in `initialize'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1429:in `new'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1429:in `add_route'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1408:in `decomposed_match'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1389:in `block in match'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1380:in `each'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:1380:in `match'
        from /actionpack/lib/action_dispatch/routing/mapper.rb:502:in `mount'
        from /ruby-2.0.0-p0/bundler/gems/sprockets-rails-bbf755e8b3aa/lib/sprockets/railtie.rb:125:in `block (2 levels) in <class:Railtie>'
        from /actionpack/lib/action_dispatch/routing/route_set.rb:315:in `instance_exec'
        from /actionpack/lib/action_dispatch/routing/route_set.rb:315:in `eval_block'
        from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `block in clear!'
        from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `each'
        from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `clear!'
        from /railties/lib/rails/application/routes_reloader.rb:35:in `block in clear!'
        from /railties/lib/rails/application/routes_reloader.rb:33:in `each'
        from /railties/lib/rails/application/routes_reloader.rb:33:in `clear!'
        from /railties/lib/rails/application/routes_reloader.rb:15:in `reload!'
        from /railties/lib/rails/application/routes_reloader.rb:26:in `block in updater'
        from /activesupport/lib/active_support/file_update_checker.rb:75:in `call'
        from /activesupport/lib/active_support/file_update_checker.rb:75:in `execute'
        from /railties/lib/rails/application/routes_reloader.rb:27:in `updater'
        from /railties/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
        from /railties/lib/rails/application/finisher.rb:69:in `block in <module:Finisher>'
        from /railties/lib/rails/initializable.rb:30:in `instance_exec'
        from /railties/lib/rails/initializable.rb:30:in `run'
        from /railties/lib/rails/initializable.rb:55:in `block in run_initializers'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:150:in `block in tsort_each'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:183:in `block (2 levels) in each_strongly_connected_component'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:219:in `each_strongly_connected_component_from'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:182:in `block in each_strongly_connected_component'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each_strongly_connected_component'
        from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:148:in `tsort_each'
        from /railties/lib/rails/initializable.rb:54:in `run_initializers'
        from /railties/lib/rails/application.rb:214:in `initialize!'
        from /railties/lib/rails/railtie/configurable.rb:30:in `method_missing'
        from /demo/config/environment.rb:5:in `<top (required)>'
        from /demo/config.ru:3:in `require'
        from /demo/config.ru:3:in `block in <main>'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `instance_eval'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `initialize'
        from /demo/config.ru:in `new'
        from /demo/config.ru:in `<main>'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:49:in `eval'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:49:in `new_from_string'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:40:in `parse_file'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:277:in `build_app_and_options_from_config'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:199:in `app'
        from /railties/lib/rails/commands/server.rb:48:in `app'
        from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:314:in `wrapped_app'
        from /railties/lib/rails/commands/server.rb:75:in `start'
        from /railties/lib/rails/commands.rb:80:in `block in <top (required)>'
        from /railties/lib/rails/commands.rb:75:in `tap'
        from /railties/lib/rails/commands.rb:75:in `<top (required)>'
        from bin/rails:4:in `require'
        from bin/rails:4:in `<main>' 
```

有没有一种方法可以让我以相反的顺序获得相同的 stracktrace，所以每次出现错误时我都不必滚动终端。类似的东西：

```
 from bin/rails:4:in `<main>'
    from bin/rails:4:in `require'
    from /railties/lib/rails/commands.rb:75:in `<top (required)>'
    from /railties/lib/rails/commands.rb:75:in `tap'
    from /railties/lib/rails/commands.rb:80:in `block in <top (required)>'
    from /railties/lib/rails/commands/server.rb:75:in `start'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:314:in `wrapped_app'
    from /railties/lib/rails/commands/server.rb:48:in `app'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:199:in `app'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/server.rb:277:in `build_app_and_options_from_config'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:40:in `parse_file'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:49:in `new_from_string'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:49:in `eval'
    from /demo/config.ru:in `<main>'
    from /demo/config.ru:in `new'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `initialize'
    from /ruby-2.0.0-p0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `instance_eval'
    from /demo/config.ru:3:in `block in <main>'
    from /demo/config.ru:3:in `require'
    from /demo/config/environment.rb:5:in `<top (required)>'
    from /railties/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /railties/lib/rails/application.rb:214:in `initialize!'
    from /railties/lib/rails/initializable.rb:54:in `run_initializers'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:148:in `tsort_each'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each_strongly_connected_component'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:182:in `block in each_strongly_connected_component'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:219:in `each_strongly_connected_component_from'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:183:in `block (2 levels) in each_strongly_connected_component'
    from ruby-2.0.0-p0/lib/ruby/2.0.0/tsort.rb:150:in `block in tsort_each'
    from /railties/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /railties/lib/rails/initializable.rb:30:in `run'
    from /railties/lib/rails/initializable.rb:30:in `instance_exec'
    from /railties/lib/rails/application/finisher.rb:69:in `block in <module:Finisher>'
    from /railties/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
    from /railties/lib/rails/application/routes_reloader.rb:27:in `updater'
    from /activesupport/lib/active_support/file_update_checker.rb:75:in `execute'
    from /activesupport/lib/active_support/file_update_checker.rb:75:in `call'
    from /railties/lib/rails/application/routes_reloader.rb:26:in `block in updater'
    from /railties/lib/rails/application/routes_reloader.rb:15:in `reload!'
    from /railties/lib/rails/application/routes_reloader.rb:33:in `clear!'
    from /railties/lib/rails/application/routes_reloader.rb:33:in `each'
    from /railties/lib/rails/application/routes_reloader.rb:35:in `block in clear!'
    from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `clear!'
    from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `each'
    from /actionpack/lib/action_dispatch/routing/route_set.rb:330:in `block in clear!'
    from /actionpack/lib/action_dispatch/routing/route_set.rb:315:in `eval_block'
    from /actionpack/lib/action_dispatch/routing/route_set.rb:315:in `instance_exec'
    from /ruby-2.0.0-p0/bundler/gems/sprockets-rails-bbf755e8b3aa/lib/sprockets/railtie.rb:125:in `block (2 levels) in <class:Railtie>'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:502:in `mount'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1380:in `match'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1380:in `each'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1389:in `block in match'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1408:in `decomposed_match'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1429:in `add_route'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:1429:in `new'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:65:in `initialize'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:79:in `normalize_path!'
    from /actionpack/lib/action_dispatch/routing/mapper.rb:307:in `normalize_path'
    from /activesupport/lib/active_support/dependencies.rb:228:in `require'
    from /activesupport/lib/active_support/dependencies.rb:213:in `load_dependency'
    from /activesupport/lib/active_support/dependencies.rb:228:in `block in require'
  /activesupport/lib/active_support/dependencies.rb:228:in `require': cannot load such file -- pry (LoadError) 
```

可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-12T14:06:51.223

有几种方法可以做到这一点。

如果您在 irb 或调试器中，例如：

```
caller.reverse 
```

会给你你想要的。然后另一种方法是像这样包装所有代码

```
begin
  all the code
rescue StandardError => e 
  puts e.backtrace.reverse
end 
```

最后，您可以在 Exception 上扩展回溯以打印 caller.reverse，但扩展核心模块根本不是一个好主意。

# python - Input_formats 到 DateTimeField

> ID：16201343
> 
> 赞同：8
> 
> 时间：2013-04-24T20:15:01.657
> 
> 标签：python, django, datetime

我有一个 DateTimeField ：

```
 start_time=forms.DateTimeField(input_formats='%y-%m-%d %H:%M') 
```

并在 html

```
 {{form.start_time}} 
```

但无论我在该字段中输入什么，例如：2013-07-07 19:00 它总是会给我一个错误：输入有效的日期/时间，这里有什么磨损？提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-24T20:38:38.693

像这样写定义：

```
start_time=forms.DateTimeField(input_formats=['%Y-%m-%d %H:%M']) 
```

注意 input_formats 是一个列表，Y 是大写的。那应该行得通。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-26T13:31:57.580

只是做了一些试验和错误。指定时`input_formats`，您必须考虑小部件`format='whatevers in here'`是字符串，`input_formats=['whatevers in here', 'whatever else']`而是列表。

# css - 如何组合媒体查询？

> ID：16201345
> 
> 赞同：1
> 
> 时间：2013-04-24T20:15:02.770
> 
> 标签：css, media-queries

我有两个媒体查询现在正在做同样的事情。如何将这些组合成一个查找两种宽度的查询？

```
@media (max-width : 480px) {...}
@media (max-width : 320px) {...} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:18:23.863

无需结合，这涵盖了两者：

```
@media (max-width : 480px) {...} 
```

这适用于宽度小于 480px 且 320px 小于 480px 的情况。

# java - 从前一个循环中获取一个值以在当前循环中使用

> ID：16201357
> 
> 赞同：0
> 
> 时间：2013-04-24T20:16:07.303
> 
> 标签：java, arrays, for-loop

如何在当前循环中使用上一次迭代中的值？我正在生成 a`double [] v`并想做`v - w`w 是上一次迭代中 v 的值。显然我需要为 2 个数组实现减法。

```
if (!e.getValueIsAdjusting()) 
                {
                    double[] v = new double[uaCount.get(table.getValueAt(table.getSelectedRow(),0)).singleValues.size()];
                    int i = 0;
                    for(Long j : uaCount.get(table.getValueAt(table.getSelectedRow(),0)).singleValues) 
                    {
                      v[i++] = j.doubleValue();
                    }
                    double [] w, r;
                    //implement r = v-w
                    System.out.println(String.valueOf(uaCount.get(table.getValueAt(table.getSelectedRow(),0)).singleValues));
                    dataset.addSeries("Histogram",r, 1000, 0, 120000);  
                } 
```

这样做的目的是在我的直方图中添加一个新数据集，同时摆脱以前的直方图。现在我想多了，减去这些值会给我不同的答案，对吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:18:02.457

> 如何在当前循环中使用上一次迭代中的值？

只需将循环的当前值保存为循环`previous`末尾的最后一行。
在您重新输入时循环的第一行中，`previous`具有先前的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:18:20.213

在循环外声明一个变量来保存它

```
int val;
int prev;

for(int i=0; i<n; i++)
{
    //do stuff with val
    ...
    prev = val;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:49:36.480

从您的解释中假设您的要求是执行以下操作：

```
for(initialization;condition;increment){
curr[i] = i;//holds your current ittration value
if(prev != null){
//do some operation
//these extra things can also be done by cure[i-1] instead of using extra variable just    //check if i>0 then get the previous value from your curr array and perform operation //accordingly
}
prev = curr[i];
} 
```

方法2：根据其他用户的建议，您可以使用更简单的集合框架。

# mysql - 将数据从excel添加到MySQL中的现有表

> ID：16201359
> 
> 赞同：1
> 
> 时间：2013-04-24T20:16:15.350
> 
> 标签：mysql, excel

我在 MySQL 上有一个包含 7 个字段的现有表 - 4 个是整数（一个充当主键和自动增量）和 3 个文本。此表已有数据。

我正在 Excel 中收集新数据，并希望将数据批量添加到 Mysql 表中。Excel 中的某些单元格将是空白的，需要在 MySQL 中显示为 null 并且主键不会是 excel 的一部分，我让 MYSQL 自动添加它。以前我是通过 PHPmyadmin 手动添加每条记录，但这太费时间了（我有 1000 条记录要添加）。

如何以正确的方式设置 Excel 工作表并确保添加到现有数据而不是替换它？我听说CSV文件是这样的？如果有帮助，我会使用 PHPmyadmin。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:39:49.050

如果您想将数据附加到 MySQL 表中，我会使用 .csv 文件来完成。

在 MySQL 中：

```
load data local infile 'yourFile'
into table yourTable (field1, field2, field3)
fields terminated by ',' optionally enclosed by '"'
lines terminated by '\n'  -- On windows you may need to use `\r\n'
ignore 1 lines;           -- Ignore the header line 
```

查看参考手册：[http ://dev.mysql.com/doc/refman/5.0/en/load-data.html](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)

# python - Python 中 if 语句的求值顺序

> ID：16201362
> 
> 赞同：32
> 
> 时间：2013-04-24T20:16:23.423
> 
> 标签：python

如果您有一个 if 语句，其中评估了多个变量或函数，它们的评估顺序是什么？

```
if foo > 5 or bar > 6:
    print 'foobar' 
```

在这种特定情况下，是否会针对 5 评估 foo 然后针对 6（从左到右）评估 bar 还是从右到左评估它？我假设 a`or`和`and`以相同的顺序进行评估。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-24T20:18:19.673

左边的子句将首先被评估，只有当第一个是 时，才会评估右边的子句`False`。

这就是为什么您可以执行以下操作的原因：

```
if not person or person.name == 'Bob':
    print "You have to select a person and it can't be Bob" 
```

没有它打破。

相反，对于一个`and`子句，只有当第一个子句是时才会评估正确的子句`True`：

```
if person and person.name:
   # ... 
```

`person`否则is时会抛出异常`None`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-24T20:19:04.650

它将从左到右进行评估。

```
>>> def a():
...     print 'a'
...     return False
... 
>>> def b():
...     print 'b'
...     return False
... 
>>> print a() or b()
a
b
False
>>> def c():
...     print 'c'
...     return True
... 
>>> print c() or a()
c
True 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-24T21:02:47.543

为了进一步扩展 Blender 的解释，`or`操作符还内置了一些东西：

```
<expression A> or <expression B> 
```

这将首先评估`expression A`；如果计算结果为`True`then`expression A`则由运算符返回。所以将`5 or <something>`返回`5`为.`5``True`

如果`expression A`计算结果为`False`，`expression B`则返回。所以`0 or 5`会返回`5`，因为`0`计算结果为`False`.

当然，您可以根据需要将其链接起来：

```
<expr 1> or <expr 2> or <expr 3> or ... or <expr n> 
```

通常，`or`将返回计算结果为 的*第一个*表达式`True`，但保留其原始值。如果没有计算结果为 的表达式`True`，它将简单地返回最后一个表达式（计算结果为`False`）。

`and`操作员以类似但相反的方式工作。它将返回第*一个*计算结果为 的表达式`False`，但保留其原始值。如果没有计算结果为 的表达式`False`，它将简单地返回最后一个表达式（计算结果为`True`）。

例如，`0 and 5`和`5 and 0`都将返回`0`，因为`0`计算结果为`False`，但`2 and 3`将返回`3`，因为`3`是最后一个表达式并且所有内容都计算为`True`。

无论如何（回到问题）：所有表达式都是从左到右评估的，如果上面的规则允许，则不会触及其他表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T20:21:28.467

Python 的`or`运算符短路，它将从左到右进行评估：

```
if (foo > 5) or (bar > 6):
    print 'foobar' 
```

如果`foo > 5`, 那么`bar > 6`甚至不会被测试，`True or <anything>`就像`True`. 如果`foo`不是`> 5`，`bar > 6`则将进行测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-13T10:55:56.133

运算符从左到右求值。但仅当所有运算符的优先级相同时。当运算符的优先级不相等时，运算符将根据优先级执行。

前任。

> > 假或假或真假假
> > 
> > 真或假和真或假真
> > 
> > 假或假和真或假假

即首先在表达式中执行具有最高优先级的运算符，然后进一步执行。

# php - OOP 和 AJAX 表单提交问题

> ID：16201363
> 
> 赞同：0
> 
> 时间：2013-04-24T20:16:27.163
> 
> 标签：php, jquery, ajax

通过 ajax 在下面提交我的表单后，即使使用正确的登录信息，消息总是返回失败！我也以非 oop 样式对此进行了编码，并且效果很好，但是当我使用这种代码样式时，它会挂断。实时站点是[http://andyholmes.me/demo/summersproperty/OOP/login.php](http://andyholmes.me/demo/summersproperty/OOP/login.php)，用户名是 admin@summersproperty.com，密码是 admin

登录.php -

```
 <?PHP
session_start();

include('includes/class.login.php');

$login = new Login();

$token = $_SESSION['token'] = md5(uniqid(mt_rand(), true));

if ($_POST['ajax']) {
    exit($login->getStatus());
}

?>
<style>
    #message { display: none; cursor: pointer; }
    .loader { display: none; }
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("#loginForm").submit(function(e) {
        $(this).fadeOut(300);
        $('.loader').delay(300).fadeIn(100);
        $.post("<?=$_SERVER['PHP_SELF'];?>", { username: $('#username').val(), password: $('#password').val(), ajax: true }).done(function(data) {
            if (data.logged_in == true) {
                // Redirect with javascript
                $('.loader').delay(2000).fadeOut(100);
                $('#message').html('<p>Success! We\'ll redirect you in a minute...</p>').delay(2200).fadeIn(200);
            } else {
                $('.loader').delay(2000).fadeOut(100);
                $('#message').html('<p>Failed... Click to try again!').delay(2200).fadeIn(200);
                $('#message').on('click', function(){
                    $(this).fadeOut(200);
                    $('#loginForm').delay(350).fadeIn(200);
                });
            }
        }); 
        return false;
    });
});
</script>
<form id="loginForm" method="POST" action="">
    <table>
        <tr><td>Username:</td><td><input type="text" name="username" id="username"/></td></tr>
        <tr><td>Password:</td><td><input type="password" name="password" id="password"/></td></tr>
    </table>
    <input type="hidden" name="token" value="<?=$token;?>"/>
    <input type="submit" name="login" value="Log In"/>
</form>
<div class="loader">
    <img src="loader.gif"/>
</div>
<div id="message"></div> 
```

和登录类 -

```
<?PHP

class Login 
{
    private $_id;
    private $_username;
    private $_password;
    private $_passmd5;

    private $_errors;
    private $_access;
    private $_login;
    private $_token;

    public function __construct()
    {
        $this->_errors = array();
        $this->_login  = isset($_POST['login']) ? 1 : 0;
        $this->_access = 0;
        $this->_token  = $_POST['token'];

        $this->_id     = 0;
        $this->_username = ($this->_login) ? $this->filter($_POST['username']) : $_SESSION['username'];
        $this->_password = ($this->_login) ? $this->filter($_POST['password']) : '';
        $this->_passmd5  = ($this->_login) ? md5($this->_password) : $_SESSION['password'];

    }

    public function isLoggedIn()
    {
        ($this->_login) ? $this->verifyPost() : $this->verifySession();

        return $this->_access;
    }

    public function filter($var)
    {
        return preg_replace('/[^a-zA-Z0-9]/','',$var);
    }

    public function verifyPost()
    {
        try
        {
            if(!$this->isTokenValid())
                throw new Exception('Invalid form submission');

            if(!$this->isDataValid())
                throw new Exception('Invalid form data entered');

            if(!$this->verifyDatabase())
                throw new Exception('Invalid username/password combination');

        $this->_access = 1;
        $this->registerSession();
        }
        catch(Exception $e)
        {
            $this->_errors[] = $e->getMessage();
        }
    }

    public function verifySession()
    {
        if($this->sessionExist() && $this->verifyDatabase())
            $this->_access = 1;
    }

    public function verifyDatabase()
    {
        include('dbConfig.php');

        $data = mysql_query("SELECT user_id FROM users WHERE user_username = '{$this->_username}' AND user_password = '{$this->_passmd5}'");

        if(mysql_num_rows($data))
        {
            list($this->_id) = @array_values(mysql_fetch_assoc($data));
            return true;
        }
        else 
        {
            return false;
        }
    }

    public function isDataValid()
    {
        return (preg_match('/^[a-zA-Z0-9]/', $this->_username) && preg_match('/^[a-zA-Z0-9]/', $this->_password)) ? 1 : 0;
    }

    public function isTokenValid()
    {
        return (!isset($_SESSION['token']) || $this->_token != $_SESSION['token']) ? 0 : 1;
    }

    public function registerSession()
    {
        $_SESSION['id'] = $this->_id;
        $_SESSION['username'] = $this->_username;
        $_SESSION['password'] = $this->_passmd5;
    }

    public function sessionExist()
    {
        return (isset($_SESSION['username']) && isset($_SESSION['password'])) ? 1 : 0;
    }

    public function showErrors()
    {
        echo "<h3>Errors</h3>";
        foreach($this->_errors as $key=>$value)
            echo $value."<br>";
    }

    public function getStatus()
    {
    return json_encode(array('logged_in' => $this->isLoggedIn(), 'errors' => $this->showErrors()));
    }   
}

?> 
```

顺便说一句，我知道我需要使用 PDO 等，但我只想在我更改数据库连接数据之前让脚本运行良好。我知道我很接近，但这真的很令人沮丧！

如果你能帮助我，我将不胜感激！

编辑说明：此代码已针对使用 user1781670 的建议后出现的问题进行了更新

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:44:43.747

```
<?PHP
session_start();

include('includes/class.login.php');

$login = new Login();

$token = $_SESSION['token'] = md5(uniqid(mt_rand(), true));

if ($_POST['ajax']) {
    exit($login->getStatus());
}

?>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("#loginForm").submit(function(e) {
        $.post("<?=$_SERVER['PHP_SELF'];?>", { username: $('#username').val(), password: $('#password').val(), ajax: true }).done(function(data) {
            if (data.logged_in == true) {
                // Redirect with javascript
            } else {
                // Inject errors to html
                // data.errors
            }
        }); 
        return false;
    });
});
</script>
<form id="loginForm" method="POST" action="">
    <table>
        <tr><td>Username:</td><td><input type="text" name="username" id="username"/></td></tr>
        <tr><td>Password:</td><td><input type="password" name="password" id="password"/></td></tr>
    </table>
    <input type="hidden" name="token" value="<?=$token;?>"/>
    <input type="submit" name="login" value="Log In"/>
</form> 
```

正如你所看到的，我修改了你的 jquery，删除了你的 PHP 代码，因为那不是它所在的地方，而且我至少对我来说将语法改得更清楚一点。另请注意，“数据”是您的 PHP 函数 getStatus 返回的 json，该函数将登录状态返回为 json。

现在您只需要创建返回 json 的 PHP 函数。也许可以帮助您检查[json_encode](http://php.net/manual/en/function.json-encode.php)。如果您遇到困难，请告诉我们。

getStatus 函数示例：

JavaScript 对象类似于 PHP 中的关联数组，只是 JavaScript 对象可以具有函数。因此，您需要将关联数组传递给 json_encode 也就不足为奇了。

```
public function getStatus()
{
    return json_encode(array('logged_in' => $this->isLoggedIn(), 'errors' => $this->showErrors()));
} 
```

$.post 自动知道它收到了 JSON（这是默认选项），因此您可以使用 data.logged_in 和 data.errors 访问它的属性。

这就是问题所在：您显示您的登录表单，当用户提交表单时，您通过 ajax 打开连接并发送用户输入的数据，并且您希望服务器返回信息。但是这些数据将如何返回呢？你打算怎么处理？好吧，那是 JSON 的。这是一种编写 JavaScript 对象的语法，因此使用 json_encode 您返回一个 JSON，当您的 JavaScript 接收到该 JSON 时，您可以访问它的数据并检查它是否成功登录。

# c++ - OpenCV中的鸟瞰投影错误

> ID：16201365
> 
> 赞同：1
> 
> 时间：2013-04-24T20:16:29.193
> 
> 标签：c++, opencv, computer-vision, perspective

我正在使用 OpenCV 尝试对该图像进行鸟瞰投影：![这个图片](https://i.imgur.com/lrqEllT.jpg)
我首先找到棋盘的所有内角并绘制它们，如此处所示![图片](https://i.imgur.com/F0EUtYZ.jpg)
然后我在其上使用 warpPerspective() 但它产生了一个非常小的扭曲图像如图所示![这里](https://i.imgur.com/IidNUlm.png)。谁能弄清楚是什么原因造成的？

这是我的代码：

```
#include <ros/ros.h>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/calib3d/calib3d.hpp>
#include <vector>

using namespace cv ;

int main(int argc, char* argv[] ) {
  ros::init( argc, argv, "bird_view" ) ;
  int board_w = atoi(argv[1]);
  int board_h = atoi(argv[2]);

  cv::Size board_sz( board_w, board_h );
  cv::Mat image = cv::imread( "image.jpg" ) ;
  cv::Mat gray_image, tmp, H , birds_image;
  cv::Point2f objPts[4], imgPts[4] ;
  std::vector<cv::Point2f> corners ;
  float Z = 1 ; //have experimented from values as low as .1 and as high as 100
  int key = 0 ;
  int found = cv::findChessboardCorners( image, board_sz, corners ) ;

  if (found) {
    cv::drawChessboardCorners(image, board_sz, corners, 1) ;
    cvtColor( image, gray_image, CV_RGB2GRAY ) ;
    cornerSubPix( gray_image, corners, Size(11, 11), Size(-1, -1),
                  TermCriteria(CV_TERMCRIT_EPS | CV_TERMCRIT_ITER, 30, 0.1) ) ;
    cv::resize( image, tmp, Size(), .5, .5 ) ;
    namedWindow( "IMAGE" ) ;
    cv::imshow( "IMAGE" , tmp ) ;
    waitKey(0) ;
  }

  objPts[0].x = 0 ;
  objPts[0].y = 0 ;
  objPts[1].x = board_w-1 ;
  objPts[0].y = 0 ;
  objPts[0].x = 0 ;
  objPts[0].y = board_h-1 ;
  objPts[0].x = board_w-1 ;
  objPts[0].y = board_h-1 ;

  imgPts[0] = corners.at(0) ;
  imgPts[1] = corners.at(board_w-1) ;
  imgPts[2] = corners.at((board_h-1) * board_w) ;
  imgPts[3] = corners.at((board_h-1) * board_w + board_w-1) ;

  H = cv::getPerspectiveTransform( objPts, imgPts ) ;

  birds_image = image ;

  while ( key != 27 ) {

    H.at<float>(2,2) = Z ;

    cv::warpPerspective( image, birds_image, H, Size( 2 * image.cols, 2 * tmp.rows ) ,
                         CV_INTER_LINEAR | CV_WARP_INVERSE_MAP | CV_WARP_FILL_OUTLIERS ) ;

    cv::imshow( "IMAGE", birds_image ) ;
    cv::waitKey(0) ;
  }

  return 0 ;
} 
```

所有这些代码都基于 O'Reilly 的 OpenCV 书的鸟瞰投影示例。我认为生成的图片是正确的，但在我确定之前我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T13:17:11.213

首先，我看到您正在覆盖 objPts[0] 而不是使用 objPts[1] 到 [3]：

```
objPts[0].x = 0 ;
objPts[0].y = 0 ;
objPts[1].x = board_w-1 ;
objPts[0].y = 0 ;
objPts[0].x = 0 ;
objPts[0].y = board_h-1 ;
objPts[0].x = board_w-1 ;
objPts[0].y = board_h-1 ; 
```

现在，**getPerspectiveTransform**所做的是找到将一组点 p0...p3 转换为 p0'...p3' 的转换，假设它们通过[单应性](http://en.wikipedia.org/wiki/Homography "单应性")相关。如果你想在这样的变换中使用**warpPerspective**，那么 p0...p3 和 p0'...p3' 都必须用图像坐标（像素）表示，而 objPts 不是用任意空间坐标表示的。

您对**getPerspectiveTransform**说，您希望在图像坐标（像素）中的国际象棋图案的角与生成的图像坐标（像素）之间进行以下映射：

```
corner0 -> (0,0)
corner1 -> (board_w-1, 0)
corner2 -> (0, board_h-1)
corner3 -> (board_w-1, board_h-1) 
```

因此，如果 board_w 为 10，则将棋盘映射到 10 像素宽的图像！这解释了您获得的结果。

为了得到你想要的，你应该在上面示例的第二列中使用你想要的鸟瞰图像中的国际象棋图案的图像（像素）坐标。例如，如果您希望每个正方形为 10x10 像素，请将值乘以 10。

另外，请记住，您没有校正镜头失真（无论如何看起来并不大），并且图案似乎不是完全平坦，因此您可能会在生成的图像中以略微弯曲的线条形式出现一些“瑕疵” .

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-28T21:04:05.023

因此，感谢 Milo 对 getPerspectiveTransform 所做的澄清，我稍微改变了在指定映射点时所做的事情：

```
std::vector<cv::Point2f> objPts(4) ;
objPts[0].x = 250 ;
objPts[0].y = 250 ;
objPts[1].x = 250 + (board_w-1) * 25 ;
objPts[1].y = 250 ;
objPts[2].x = 250 ;
objPts[2].y = 250 + (board_h-1) * 25 ;
objPts[3].x = 250 + (board_w-1) * 25 ;
objPts[3].y = 250 + (board_h-1) * 25 ; 
```

而且效果很好！每个图像都会有所不同，因此请使用基本值以及要将图像转换为多大/小。

# sap - 使用直接 Rfc 调用而不是 BAPI 是否有优势？

> ID：16201374
> 
> 赞同：3
> 
> 时间：2013-04-24T20:17:12.400
> 
> 标签：sap, saprfc, bapi, sap-dotnet-connector

我对使用 SAP 不是很熟悉，但我目前的任务是利用 Rfc 调用通过我正在处理的 ac# 项目在 SAP 中创建采购订单。

使用直接 Rfc 调用而不是 BAPI 有什么优势吗？我问过我的主管，他的理由是“避免未知/不必要的混乱”。

我们的旧程序使用 BAPI。我发现通过这项任务，我现在正在追赶我的尾巴，因为我深入研究元数据并解决使用/获取我需要的结构的问题。

事情进展顺利，但我只是不明白坚持使用 Rfc 而不是 BAPI。

编辑以澄清我糟糕的术语：我们目前使用一个包装器，然后为我们调用 BAPI。我的任务是不使用包装器，而是使用与 BAPI 相同的 Rfc 调用。

例子：

```
IRfcFunction poCreateFunction = _dest.Repository.CreateFunction("BAPI_PO_CREATE1");
IRfcStructure poHeader = poCreateFunction.GetStructure("POHEADER");
poCreateFunction.SetValue("POHEADER", poHeader);
...
poCreateFunction.Invoke(_dest); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T06:51:30.153

你的主管给了你一个非常半途而废的答案，这让你想知道他是否理解他通过强迫你使用自定义（我假设）RFC 来实现的目标。

在 .NET 集成项目中，我（作为 ABAP 程序员）通常会提供包装 RFC 模块来隐藏 BAPI 的一些复杂性，或者因为 .NET 端可能没有 BAPI 所需的所有信息。这通常会导致界面更简单，但功能有限。但最后只是将 BAPI 调用从 .NET 移动到 ABAP 堆栈中。

如果您在使用 BAPI 时没有出现所提供的 RFC 功能模块的问题，则该功能模块可能有问题。或者至少，它没有达到将 SAP 的复杂性从 .NET 程序中隐藏的目的，也没有为您提供比使用标准 BAPI 的任何好处，至少它有很好的文档记录和支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T06:13:41.240

一个技术上正确但有点无益的答案是`?SYNTAX ERROR`，然后是一个巨大的蓝色闪烁光标。

BAPI 是支持 RFC 的功能模块，因此调用 BAPI 和任何其他支持 RFC 的功能模块在技术上没有区别。不同之处在于 BAPI 是正式发布的，供客户和合作伙伴使用。它们得到支持、维护并且大部分都有很好的文档记录——与某些内部功能模块相反，由于某些技术原因必须启用 RFC。任何想要提供 BAPI 的开发人员都必须遵守一组严格的规则，以便在整个编程接口中维护一组特定的标准。的确，BAPI 具有相当长的参数名称和庞大的数据结构来涵盖各种特殊应用程序，但称其为“一团糟”并没有给人留下积极的印象……

# html - 在 html 和 css 中创建菜单

> ID：16201380
> 
> 赞同：2
> 
> 时间：2013-04-24T20:17:31.370
> 
> 标签：html, css, menu

我想创建这样的菜单：

![菜单](https://i.stack.imgur.com/IV34V.png)

我想在活动页面上和悬停后看到红色方块。菜单由以下人员创建：

```
<div id="menu">
    <ul>
    <li><a href="#"><span>Home</span><a></li>
    <li><a href="#"><span>About</span><a></li>
    <li><a href="#"><span>Contact</span><a></li>
    </ul>
</div> 
```

我试图创建这个 2 小时，但什么也没有：（你能给我一个建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:36:35.910

这是一个适合您的工作jsfiddle：

[http://jsfiddle.net/6sCZh/](http://jsfiddle.net/6sCZh/)

```
li { list-style: none; float: left; background: url(http://getpersonas.cdn.mozilla.net/static/9/0/66090/preview_small.jpg) repeat-x; background-position: 0px 10px;   }

ul {  }

li a { display: block;   color: #fff; text-decoration: none; margin: 14px;   }

li a.active, li a:hover {  background-color: brown;  padding: 11px; margin: 3px; } 
```

我添加了一个 css 类“活动”，它应该使用您的 php 代码设置在服务器端，或者通过在 html 标记中将其设置为静态。不幸的是，我不知道更好的方法。由于浮动，“清晰”标签也会很好:)

但也许它有点帮助;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:24:55.773

一个简单的方法是在你的锚标签（或者，更好的是，它们的父 li 元素）被选中时给它们一个类。

然后创建一个以 li.selected 和 li:hover 为目标的规则，其中放置红色框。

**如果没有看到您的 HTML和**CSS ，我无法更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:26:14.990

对于渐变，您需要 CSS3 或图像。我为演示使用了渐变生成器 - [http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

这个想法是活动链接高于菜单，并且具有负的顶部和底部边距，以补偿高度差。并且不要放入`overflow: hidden`菜单:)

[http://jsfiddle.net/23zZE/](http://jsfiddle.net/23zZE/)

# css - 如何垂直居中绝对定位的项目？

> ID：16201382
> 
> 赞同：1
> 
> 时间：2013-04-24T20:17:33.110
> 
> 标签：css, position, css-position

我想对齐一个绝对定位的 div。顶部：50%，底部：50% 不工作，解决方案是什么？

CSS

```
#container {
    position:relative;
    background:red;
    width:600px;
    height:600px;
}

#cen {
    position:absolute;
    width:300px;
    height:300px;
    background:grey;
    top:50%;
    bottom:50%;
} 
```

HTML

```
<div id="container">
    <div id="cen"></div>
</div> 
```

[http://jsfiddle.net/2xq5F/](http://jsfiddle.net/2xq5F/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:20:23.810

要垂直居中，您需要添加 a`top: 50%`和负数`margin-top: -(elementHeight/2)`。

在你的情况下，它将是

```
#cen {
    position:absolute;
    width:300px;
    height:300px;
    background:grey;
    top:50%;
    margin-top: -150px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:28:24.003

你也可以这样做：

```
#cen {
    position:absolute;
    width:150px;
    height:150px;
    background:grey;
    top:0;
    bottom:0;
    left: 0;
    right: 0;
    margin: auto;
} 
```

演示：http: [//jsfiddle.net/audetwebdesign/EBmy3/](http://jsfiddle.net/audetwebdesign/EBmy3/)

很大的优势，不需要数学。

但是，这是有效的，因为您指定了宽度和高度。当您使用百分比时，这会变得更加棘手。

注意：我将块大小缩小了一半，以便它们适合小提琴窗口......也适用于较大的块。

**适用于替换元素**

如果您要定位具有特定尺寸的图像（尽管您可能不知道它们），这种技术会做得很好。

请参阅小提琴中的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:32:15.427

Vertical alignment is based off of other inline elements. The best way I've found to vertically align something is to add a psuedo class.

It's easy to vertically align something if you know the dimensions, like some of the other answers have noted. It makes it harder though, when you don't have specific dimensions and needs to be more free.

Basically, the method aligns the psuedo class with the rest of the content to align middle whatever is inside the container.

```
div#container {
  width: 600px;
  height: 600px;
  text-align:center;
}
div#container:before {
  content:'';
  height:100%;
  display:inline-block;
  vertical-align:middle;
}
div#cen {
  display:inline-block;
  vertical-align:middle;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T21:16:14.923

我不确定你需要它绝对定位什么，但如果你欺骗 CSS 认为你的容器是一个表格单元格，你可以使用 vertical-align 属性来实现完全动态的布局。

```
#container {
    position:relative;
    background:red;
    width:100px;
    height:200px;
    display: table-cell;
    vertical-align: middle;
}

#cen {
    width:100px;
    height:20px;
    background:grey;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T20:18:45.623

如果这些是真正的测量结果，为什么不这样做呢？

```
#cen {
    position: absolute;
    width: 300px;
    height: 300px;
    top: 150px;
    background:grey;
} 
```

# ios - 使用 FB SDK v3.5 的 iOS 应用程序未显示在“允许这些应用程序使用您的帐户”列表中

> ID：16201383
> 
> 赞同：0
> 
> 时间：2013-04-24T20:17:37.840
> 
> 标签：ios, facebook, login

我正在为我的应用程序使用 FB ios SDK v3.5。对于部分登录，我不使用 FBLoginView 登录，而是使用 UIButton 并在该 UIButton 的处理程序中调用 [FBSession openActiveSessionWithReadPermission]。

在 FB SDK v3.2.1 中，我使用以下代码来处理不同的登录场景，效果很好：

```
self.useAccountAllowed = true;
    ACAccountStore *accountStore;
    ACAccountType *accountTypeFB;
    if ((accountStore = [[ACAccountStore alloc] init]) &&
        (accountTypeFB = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook] ) ){

        NSArray *fbAccounts = [accountStore accountsWithAccountType:accountTypeFB];
        id account;
        if (!fbAccounts)
        {
            //do not log into FB on the device
        }
        else if ([fbAccounts count] == 0) {
            [FBSession.activeSession closeAndClearTokenInformation];
            self.useAccountAllowed = false; //User does not allow the app to use the account
        }
        else if ([fbAccounts count]>0 && (account=[fbAccounts objectAtIndex:0])) {
            [accountStore renewCredentialsForAccount:account completion:^(ACAccountCredentialRenewResult renewResult, NSError *error) {  //User allowes the app to use the account
                //we don't actually need to inspect renewResult or error.
                if (error){

                }
            }];
        }
    } 
```

然后在 UIButton 的处理函数中：

```
if (self.useAccountAllowed) {
        [FBSession openActiveSessionWithReadPermissions:nil allowLoginUI:YES completionHandler:^(FBSession* session, FBSessionState status, NSError* error){
            [self sessionStateChanged:session state:status error:error];}];
    }
    else {
        NSArray* lPermission = FBSession.activeSession.permissions;
        [FBSession openActiveSessionWithPermissions:lPermission allowLoginUI:YES completionHandler:^(FBSession* session, FBSessionState status, NSError* error){
            [self sessionStateChanged:session state:status error:error];}]; 
```

也就是说如果用户不允许app使用账号，我们只需要通过safari使用快速切换的方式登录即可；否则我们使用本机登录。

但是在 SDK v3.5 中，还是一样的代码，但是有时候当应用程序执行并登录 facebook 时，应用程序不在“允许这些应用程序使用您的帐户”列表中，所以这段代码无法区分这两种情况： 1.该应用不在列表中；2\. 用户不允许该应用使用该帐号。所以应用程序无法本地登录。

请注意，此问题是随机存在的。有时我硬编码直接调用 openActiveSessionWithPermissions，这个问题就消失了。但我不确定是不是这个原因。

我只是想知道在 FB SDK v3.5 中，我是否需要显式调用一些与 iOS 设置相关的 SDK 函数？

# php - 为什么我的会话变量没有被传递到其他页面？

> ID：16201389
> 
> 赞同：0
> 
> 时间：2013-04-24T20:17:54.510
> 
> 标签：php, oop, session, login

我有一个类 Authenticator，它使用 Datatype User 来登录用户。

```
include('User.datatype.php');

$usher = new Authenticator;
$usher->checkCreds();
$usher->startSession();

Class Authenticator {
    protected $user;
    protected function getCreds() {
        if (!isset($_POST['login']))
                throw new Exception("There was an error processing your request", 1);
        else if ($_POST['username'] == '' || $_POST['password'] == '')
            throw new Exception("You must enter a username and password", 1);
        $username = filter_input(INPUT_POST, 'username', FILTER_SANITIZE_STRING);
        $password = filter_input(INPUT_POST, 'password', FILTER_SANITIZE_STRING);
        $this->user = new User;
        $this->user->username = $username;
        $this->user->password = $password;
    }

    public function checkCreds() {
        $this->getCreds();
        if (empty($this->user->username) || empty($this->user->password))
            throw new Exception("Error Processing Request", 1);
        include('dbconnect.php');       // Normally I'd store the db connect script outside of webroot
        $pdo = new PDO("mysql:host=$db_host;dbname=$db_name;", $db_user, $db_password);
        $stmt = $pdo->prepare('SELECT username FROM Users WHERE username = :uname AND password = :pword');
        $stmt->bindParam(':uname', $this->user->username);
        $stmt->bindParam(':pword', $this->user->password);
        $stmt->execute();
        $status = $stmt->fetch(PDO::FETCH_NUM);
        $this->user->status = $status;
    }

    protected function createSessionID() {
        $seshID = mt_rand(99999, 1000000000);
        return $seshID;
    }

    public function startSession() {
        if ($this->user->status === false)
            throw new Exception("There was a problem connecting to the database", 1);
        session_start();
        $_SESSION['username'] = $this->user->username;
        $_SESSION['id'] = $this->createSessionID();
        $secret = $_SESSION['id'];
        header('Location:loggedin.php?' . $secret);
        return true;
    }
} 
```

登录有效并且 session_starts() 有效，但是当我尝试 `print 'Welcome, ' . $_SESSION['username'];`登录.php 时，会话变量为空。

登录的 HTML.php

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Product Cost Calculator</title>
            <link rel="stylesheet" type="text/css" href="style.css" />
        </head>

        <body>
            <div id="container">
                <?php
                    /*require_once ('Authenticator.php');
                    if (!Authenticator::startSession())
                        print 'you are not logged in';*/
                    print 'Welcome, ' . $_SESSION['username'];
                ?>
            </div>
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:24:23.760

您应该在当前页面中设置一个会话以使用与会话相关的代码

```
session_start();
include('User.datatype.php');
//rest of code etc etc 
```

# authentication - 使用谷歌身份验证应用程序进行双向身份验证

> ID：16201400
> 
> 赞同：1
> 
> 时间：2013-04-21T18:01:33.743
> 
> 标签：authentication, php

有人可以指导我在实施 Google 身份验证应用程序时做错了什么吗？这是我尝试过但没有成功的方法：

> 1#创建密钥

```
$chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'; // allowed characters in Base32
$secret = ''; 
for ( $i = 0; $i < 16; $i++ )
{   $secret .= substr( $chars, mt_rand( 0, strlen( $chars ) - 1 ), 1 );  } 
```

> 2#通过谷歌服务创建二维码（描述+密钥）并通过智能手机扫描，谷歌认证应用每30秒生成6位数字
> 
> 3#。现在我正在尝试验证它...（[使用 base32 算法][1]）

```
$tm = floor( time() / 30 );    // for time purpose  
$secretkey=Base32::decode($secretkey); // return blank
$time=chr(0).chr(0).chr(0).chr(0).pack('N*',$tm+$i);

// Hash it with users secret key
$hm = hash_hmac( 'SHA1', $time, $secretkey, true );

// Use last nipple of result as index/offset
$offset = ord(substr($hm,-1)) & 0x0F;

// grab 4 bytes of the result
$hashpart=substr($hm,$offset,4);

// Unpak binary value
$value=unpack("N",$hashpart);
$value=$value[1];

// Only 32 bits
$value = $value & 0x7FFFFFFF;
$value = $value % 1000000; 
```

上面的代码基于其他来源（wordpress google authentication app）......但它不起作用。

> $secretkey=Base32::decode($secretkey); 总是返回空白（空）

是否有另一种方法来验证或实施基于时间的算法？或者一个链接，我可以在其中阅读有关如何为站点的 2 路身份验证编码的信息？

感谢您的提前和可观的努力。（我认为这是一个安全目的问题，所以我放在这里而不是stackoverflow .. :)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T08:00:36.263

使用 github.com/chregu/GoogleAuthenticator.php 实现

# visual-studio - 添加 IIS Express 上的其他静态内容的条目导致 500

> ID：16201406
> 
> 赞同：38
> 
> 时间：2013-04-24T20:19:21.177
> 
> 标签：visual-studio, iis, visual-studio-2012, mime-types, iis-express

我正在使用带有 Update 2 和 IIS Express 的 Visual Studio 2012。

当我向 staticContent 部分添加记录时，所有其他静态内容（.js、.css、.jpg 等）都会返回 500 错误。

任何建议将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-06-19T11:32:17.930

mimetype 可能已经添加到您的 IIS 中。

尝试先删除 mimetype，然后在 web.config 中再次添加它

```
<remove fileExtension=".woff"/>
<mimeMap fileExtension=".woff" mimeType="application/font-woff" /> 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-11T09:01:11.523

Behavior of `system.webServer/staticContent/mimeMap` element has changed in IIS 7.0 and apparently one has to list all types **explicitly** to have them returned properly.

Here is a description from [IIS configuration documentation](http://www.iis.net/configreference/system.webserver/staticcontent/mimemap):

> **Note**: IIS 7 will not return file types that are not added to the element or that have mappings in the element by default. This behavior prevents unauthorized access to files that do not have mappings in the IIS 7 configuration settings.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-19T08:12:45.737

如果您在 Visual Studio 中使用 IIS Express，则无需定义`staticContent`，因此将其删除。

默认情况下，Visual Studio IIS Express 允许所有 MIME 类型。

# r - 在 R 中使用 NCEP/NOAA .bin 文件

> ID：16201408
> 
> 赞同：2
> 
> 时间：2013-04-24T20:19:35.523
> 
> 标签：r

我正在尝试在 PC 上使用 R 版本 2.14.0从 NOAA ( [ftp://ftp.cpc.ncep.noaa.gov/wd53rl/cfsr/ ) 读取 .bin 文件。](ftp://ftp.cpc.ncep.noaa.gov/wd53rl/cfsr/)当我使用函数 readBin 读取文件时，值非常高（从 1e16 到 9e16），但不应高于 330。

我编写了下面的代码来下载包含信息的 .zip 文件（注意：数字 20130422 与日期相关，因此可能有其他日期可用）。

```
 file.name <- 'Data.zip' 
    file.URL <- 'ftp://ftp.cpc.ncep.noaa.gov/wd53rl/cfsr/cargill.20130422.zip' 
    download.file(file.URL,file.name) 
```

我手动解压缩文件并使用具有最高温度数据的文件（tmax.20130422.daily.latlon.bin）

然后，我写了一段代码来读取最高温度文件（720*720是我要读取的行数和列数）：

```
 to.read <- 'tmax.20130422.daily.latlon.bin' 
    bin <- readBin(to.read, what = 'numeric',n = 720*720,endian='little') 
```

我尝试使用不同的“endian”或“what”，但对我没有任何帮助。如何从 bin 文件中提取正确的值？

谢谢，爱德华多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T13:46:58.640

我不确定你是否设法解决了这个问题，但我在 NOAA 数据方面遇到了类似的问题。我的数据是从 lat -40 到 40 和 lon -20 到 55，间距为 0.1 度。因此它有 751 列和 801 行。尽管 NOAA 说它是“小”端，但我发现“大”端适用于我的机器。此外，我必须翻转我的数据，以便矩阵与 R 读取并绘制它的方式相匹配。最后我覆盖了一张非洲地图，因为我的数据是非洲的降雨数据。我还安装了“raster”、“maps”和“mapdata”包。

以下是我的解决方案：

```
infile <- file("clim.bin.0101", "rb")
outfile <- matrix(readBin(infile, "numeric", 
                      n = 751 * 801, size = 4, 
                      endian = "big"), ncol= 751, 
              nrow = 801, byrow = TRUE);    
close(infile)
tran_outfile <- apply(outfile,2,rev) #flips the matirx so data is in correct order 
r = raster(tran_outfile)
extent(r) = extent(c(xmn=-20,xmx=55,ymn=-40,ymx=40))
plot(r)
plot(wrld_simpl, add=T) 
```

希望有帮助

# javascript - Javascript 如果代码

> ID：16201409
> 
> 赞同：-2
> 
> 时间：2013-04-24T20:19:38.847
> 
> 标签：javascript, jquery, html

这段代码有什么问题：

```
if($(window).scrollTop() > 290) && ($(window).width > 500) {

} else {

} 
```

我想检查两者 - 屏幕宽度和滚动大小

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:23:28.943

您在整个`if`条件周围缺少一对括号。另外，`width`是一种方法，所以你必须调用它：

```
if (($(window).scrollTop() > 290) && ($(window).width() > 500)) {

} else {

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:21:03.887

你的意思是用这个吗？

```
if( $(window).scrollTop() > 290  &&  $(window).width() > 500 ) { 
```

我取出了您用来可能对各个条件进行分组的额外括号。

（我迟到了，提到`.width`需要`.width()`，@Blender 意识到）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:20:54.097

你有太多或太少的括号。

```
 if( $(window).scrollTop() > 290  &&  $(window).width() > 500 ) {

   } else {

   } 
```

# ios - 查询苹果应用商店？

> ID：16201410
> 
> 赞同：1
> 
> 时间：2013-04-24T20:19:39.100
> 
> 标签：ios, app-store, itunes-search-api

我希望能够收集有关特定用户在其 Apple ID 下部署/注册的应用程序的信息。我知道 Apple 有一个可用的 iTunes 搜索 API，但我没有看到任何查询给定 Apple ID（通常表示为电子邮件地址）的方法。有什么办法吗？是否还有其他我错过的提供此功能的搜索 API？我知道我可以使用“artistId”参数查询应用程序，但找不到将 artistId 的数值映射到 Apple ID 的方法。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-10T05:28:20.437

我不希望 Apple 允许访问私人信息。你能做的最好的（如果这对你有帮助的话）就是在应用商店中搜索艺术家，比如 Tapbots

```
http://itunes.apple.com/search?term=tapbots&entity=allArtist 
```

然后使用该 ID 搜索他们所有的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T14:18:04.657

由于 iTunes API 是唯一提供的搜索机制，因此您必须使用来自[http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-的过滤器组合api.html#搜索](http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html#searching)

# android - ListView 包含 TabHost 和其他 ListViews

> ID：16201412
> 
> 赞同：2
> 
> 时间：2013-04-24T20:19:44.833
> 
> 标签：android, android-listview, android-tabhost, android-tabs

我想创建一个`ListView`最后一行显示`TabHost`带有两个选项卡的 a 。我想`ListView`为每个标签加载另一个。为此，我创建了三个 XML 文件。

main.xml 是我加载初始列表的位置。mainlistdata.xml 是列表中每一行的呈现方式。最后一个xml是tabslayout.xml。此布局用于主列表视图的最后一行。它将加载标签主机。[这是](http://pastebin.com/spvCrhpJ)所有xml的代码：

我的主要课程是这样的：

```
public class MainActivity extends Activity {
    ArrayList<testData> myData = new ArrayList<testData>();
    ListView listContent;
    TestAdapter dataAdapter;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String[] aString = { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z" };

        for (int i = 0; i < aString.length; i++) {
            myData.add(new testData(i, aString[i]));
        }

        listContent = (ListView) findViewById(R.id.mainlist);
        dataAdapter = new TestAdapter(this, myData,1);
        listContent.setAdapter(dataAdapter);
    }
} 
```

这是在列表视图上加载内容的类，也是我设置 tabhost 的地方：

```
public class TestAdapter extends ArrayAdapter<testData> {
    private Context context;
    private ArrayList<testData> data;
    private ListView listContent,listContent2;
    public TabHost tabs;
    TestAdapter dataAdapter;
    private int choice;
    public TestAdapter(Context context, ArrayList<testData> data, int choice) {
        super(context, R.layout.mainlistdata, data);
        this.context = context;
        this.data = data;
        this.choice = choice;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView;
        if (choice == 1) {
            if (position == data.size()-1) {
                rowView = inflater.inflate(R.layout.tabslayout, parent, false);

                TextView first = (TextView) rowView.findViewById(R.id.dataTitle);
                TextView second = (TextView) rowView.findViewById(R.id.dataValue);
                TextView third = (TextView) rowView.findViewById(R.id.dataValueString);

                first.setText("Item " + data.get(position).getIntValue());
                second.setText(String.valueOf(data.get(position).getIntValue()));
                third.setText(data.get(position).getStringValue());

                tabs = (TabHost) rowView.findViewById(android.R.id.tabhost);
                tabs.setup();
                TabSpec tab1 = tabs.newTabSpec("Tab 1");
                TabSpec tab2 = tabs.newTabSpec("Tab 2");
                tab1.setContent(R.id.tabOne);
                tab2.setContent(R.id.tabTwo);
                tab1.setIndicator("One");
                tab2.setIndicator("two");
                tabs.addTab(tab1);
                tabs.addTab(tab2);
                tabs.setup();

                listContent = (ListView) rowView.findViewById(R.id.listOne);
                dataAdapter = new TestAdapter(context, data,2);
                listContent.setAdapter(dataAdapter);

                listContent2 = (ListView) rowView.findViewById(R.id.listTwo);
                dataAdapter = new TestAdapter(context, data,3);
                listContent2.setAdapter(dataAdapter);
            } else {
                rowView = inflater.inflate(R.layout.mainlistdata, parent, false);
                TextView first = (TextView) rowView.findViewById(R.id.dataTitle);
                TextView second = (TextView) rowView.findViewById(R.id.dataValue);
                TextView third = (TextView) rowView.findViewById(R.id.dataValueString);

                first.setText("Item " + data.get(position).getIntValue());
                second.setText(String.valueOf(data.get(position).getIntValue()));
                third.setText(data.get(position).getStringValue());
            }
        } else if (choice == 2) {
            rowView = inflater.inflate(R.layout.mainlistdata, parent, false);
            TextView first = (TextView) rowView.findViewById(R.id.dataTitle);
            TextView second = (TextView) rowView.findViewById(R.id.dataValue);
            TextView third = (TextView) rowView.findViewById(R.id.dataValueString);

            first.setText("Item tab1 " + data.get(position).getIntValue());
            second.setText(String.valueOf(data.get(position).getIntValue()));
            third.setText(data.get(position).getStringValue());
        } else {
            rowView = inflater.inflate(R.layout.mainlistdata, parent, false);
            TextView first = (TextView) rowView.findViewById(R.id.dataTitle);
            TextView second = (TextView) rowView.findViewById(R.id.dataValue);
            TextView third = (TextView) rowView.findViewById(R.id.dataValueString);

            first.setText("Item tab2 " + data.get(position).getIntValue());
            second.setText(String.valueOf(data.get(position).getIntValue()));
            third.setText(data.get(position).getStringValue());
        }
        return rowView;
    }
} 
```

正如您在下一张图片中看到的那样，我正在加载数据，然后我正在加载选项卡。问题是每个选项卡只加载第一行数据。任何想法我该如何解决这个问题？ ![在此处输入图像描述](https://i.stack.imgur.com/8zfwC.png) ![在此处输入图像描述](https://i.stack.imgur.com/pnaUc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T14:53:27.487

正如Sherif elKhatib 在他的评论中已经说过的那样，应该避免`ListView`在另一个中使用。`ListView`您的问题的解决方案是使用单个`ListView`以及不同的行类型来给人一种在`ListView`包含其他选项卡的错觉`ListViews`，所有这些都由自定义适配器处理。根据您的示例，您将有四种行类型：

*   普通行（带字母的）
*   包含选项卡的一行
*   每个伪的两个行类型`ListViews`（除非您的选项卡应该具有相同的行外观，在这种情况下您将有一个选项卡行类型）

要实现这些行类型，您需要使用适配器的`getItemViewType()`and方法：`getViewTypeCount()`

```
// different row types
private static final int NORMAL_ROW = 0;
private static final int TAB_ROW = 1;
private static final int TAB1_TYPE = 2;
private static final int TAB2_TYPE = 3;

@Override
public int getItemViewType(int position) {
    if (position < mData.size()) {
            // we are in the initial list's range so it's a normal row
        return NORMAL_ROW;
    } else if (position == mData.size()) {
        // we are at the tab level, so it's a tab row
        return TAB_ROW;
    } else {
        // based on the current selected tab(0 by default) we have
        // either a tab 1 row type or tab 2 row type
        return mCurrentSelectedTab == 0 ? TAB1_TYPE : TAB2_TYPE;
    }

}

@Override
public int getViewTypeCount() {
    // if your list-tabs need different row types then you'll need to
    // make the calculations here and update appropriately
    return 4;
} 
```

在`getView()`您将根据这些行布局类型膨胀适当的布局（您的布局）并设置数据。适配器还需要处理用户选择要使用的选项卡，`notifyDataSetChanged()`并为其选项卡部分更新`ListView`正确的行类型（和数据）。

你可以在[这里看到整个示例](https://github.com/luksprog/DroidPlayground/blob/master/src/com/luksprog/dp/adapter/ListWithTabs.java)，也可以看看[使用的 xml 布局](https://github.com/luksprog/DroidPlayground/tree/master/res/layout)，应该很容易理解。

# c++ - C++程序挂在函数之间？

> ID：16201413
> 
> 赞同：2
> 
> 时间：2013-04-24T20:19:57.247
> 
> 标签：c++, function

我有一个冗长的程序，基本上管理一个哈希表；添加，删除等。不过，我在我的程序中遇到了一个非常奇怪的错误。

基本上我有一个删除函数，它散列一个值，检查存储在一个由适当对象的散列值给出的数组中的链表，如果找到，删除它并退出函数。它看起来基本上是这样的：

```
template<typename T>
void HashTable<T>::remove(T* t){
    LinkedList<T> list= data[(hash(t))];
    Node<T>* prev = NULL;
    Node<T>* cur = list.head;
    bool running = cur != NULL;
    while(running){
      T key = cur->getKey();
      if(t == key){
          if(prev == NULL){ 
              cur = cur->getNext();
              running = false;
          }else{
              prev->setNext(cur->getNext());
              cout << &key << '\n';
              cur = NULL;
              running = false;
          }
      }
      prev = cur;
      cur = cur->getNext();
    }
    cout << "Are we getting here?"; //yes
} 
```

我以这种方式调用此函数：

```
Type* b = buildType(); //produces a Type* from CL arguments
hash.remove(b);
cout << "Are we getting to THIS SPOT?"; //no 
```

基本上，上面的程序输出“我们到了吗？” 但不是“我们到达这个地点了吗？”

我不知道在这种情况下可能是什么问题，我花了很长时间才意识到这里可能存在问题。有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:28:45.943

在这一行

```
LinkedList<T> list= data[(hash(t))] 
```

您正在创建从数据中获取的 LinkedList 的副本。我敢打赌，您并不是要复制，而是要使用参考。此外，我猜它使用的是默认的复制构造函数，而不是你故意创建的。然后，当调用该 LinkedList 副本的析构函数时，它会删除仍由原始 LinkedList 持有的堆条目，从而导致堆损坏并最终挂起。

# grails - 有没有办法做空安全的 GORM 动态查找器？

> ID：16201417
> 
> 赞同：0
> 
> 时间：2013-04-24T20:20:30.647
> 
> 标签：grails, null, grails-orm

有没有办法确保 GORM 动态查找器中的空值安全？

如果我想做类似的事情`Book.findByName(author.bookname)`，我可以通过将其更改为来防止空作者，`Book.findByName(author?.bookname)`但如何避免空值异常？

```
Book.findByName() is applicable for argument types: () values: [] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:09:45.417

`auther?.bookname ? Book.findByName(author.bookname) : null //or do nothing`

根据示例中的事实，`bookname`即`NOT NULL`.

或者你可以使用`find`

`Book.find {name == author?.bookname} //Returns null if no records found`

# php - PHP Docblock #@+ 含义

> ID：16201418
> 
> 赞同：4
> 
> 时间：2013-04-24T20:20:34.477
> 
> 标签：php, comments, docblocks

php docblock中以下内容的含义是什么：

```
#@+ 
```

Zend 框架代码中的一个示例：

```
/**#@+
 * @const string Version constant numbers
 */
const VERSION_10 = '1.0';
const VERSION_11 = '1.1';
/**#@-*/ 
```

我假设它用于对相关项目进行分组，但无法确定。

此外，它的语法也很奇怪——从它生成文档时它是如何翻译的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:28:31.317

这是一个 docblock[模板](http://manual.phpdoc.org/HTMLSmartyConverter/HandS/phpDocumentor/tutorial_phpDocumentor.howto.pkg.html#basics.docblocktemplate)，因此模板之间的每个可记录元素（本示例中的每个 const）都具有相同的文档。

# ruby-on-rails - Rails：使用命名空间的 STI 创建错误的表名

> ID：16201419
> 
> 赞同：1
> 
> 时间：2013-04-24T20:20:34.557
> 
> 标签：ruby-on-rails, activerecord, namespaces, sti

我有一个使用 STI 的模型：

```
class Contributor::Name < Contributor::NameBase
  ...
end 
```

从这个模型：

```
class Contributor::NameBase < ActiveRecord::Base
  ...
end 
```

每当`Contributor::Name`实例化时，我都会收到此错误：

```
Mysql2::Error: Table 'shelflives_development.contributor_basis_name_bases' doesn't exist: SHOW FULL FIELDS FROM `contributor_basis_name_bases` 
```

似乎`contributor_name_bases`ActiveRecord 不是在查找表，而是在查找`contributor_basis_name_bases`。为什么要在and`basis`之间添加？我怎样才能让它停止？`contributor``name_bases`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:26:30.557

好的，这不是关于为什么 rails 添加 ' `basis`' 的答案，但它会为你工作。在您的模型中
使用。`set_table_name 'contributor_name_bases'`

# java - @ResponseBody\npublic ReturnType .. 和 public @ResponseBody ReturnType 之间的区别？

> ID：16201422
> 
> 赞同：1
> 
> 时间：2013-04-24T20:20:50.940
> 
> 标签：java, json, spring, jakarta-ee

有没有区别

```
@ResponseBody
public Object method(etc..) {
    etc..
} 
```

和

```
public @ResponseBody Object method(etc..){
    etc..
} 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:26:15.683

它们之间没有区别。

如果该方法使用 @ResponseBody 注释，则返回类型将写入响应 HTTP 正文。返回值将使用 HttpMessageConverters 转换为声明的方法参数类型

[http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html#mvc-ann-responsebody](http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html#mvc-ann-responsebody)

# c - C 编程语言 (scanf)

> ID：16201425
> 
> 赞同：0
> 
> 时间：2013-04-24T20:20:55.373
> 
> 标签：c, whitespace, scanf

我使用以下`scanf()`语句读取了带有空格的字符串。

```
scanf("%[^\n]", &stringVariableName); 
```

控制字符串的含义是什么`[^\n]`？

可以这样读取带有空格的字符串吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:25:18.140

这意味着“阅读任何内容，直到找到'\n'”

这没关系，但最好这样做“读取任何内容，直到找到'\n'，或者读取比我的缓冲区支持更多的字符”

```
char stringVariableName[256] = {}
if (scanf("%255[^\n]", stringVariableName) == 1)
    ... 
```

编辑：从参数中删除 & ，并检查 scanf 的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:22:44.550

格式说明符`"%[^\n]"`指示[`scanf()`](http://en.cppreference.com/w/c/io/fscanf)最多读取但不包括换行符。从链接的参考页面：

```
    匹配字符集中的非空字符序列。

如果集合的第一个字符是 ^，那么所有字符都不是
在集合中匹配。如果集合以 ] 或 ^] 开头，则 ]
字符也包含在集合中。

```

如果字符串在单行上，则是另一种选择，但在将其写入输出缓冲区时[`fgets()`](http://en.cppreference.com/w/c/io/fgets)必须删除换行符。还强制程序员指定可以读入缓冲区的最大字符数，从而降低发生缓冲区溢出的可能性：`fgets()``fgets()`

```
char buffer[1024];
if (fgets(buffer, 1024, stdin))
{
    /* Remove newline. */
    char* nl = strrchr(buffer, '\n');
    if (nl) *nl = '\0';
} 
```

可以通过以下方式指定要读取的最大字符数`scanf()`：

```
scanf("%1023[^\n]", buffer); 
```

但是不可能忘记这样做，`fgets()`因为编译器会抱怨。虽然，当然，程序员可以指定错误的大小，但至少他们被迫考虑它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T20:40:49.230

从技术上讲，这不能很好地定义。

> 匹配一组预期字符（扫描集）中的非空字符序列。
> 
> 如果不存在 l 长度修饰符，则相应的参数应是**指向字符数组的初始元素的指针，该元素数组的**大小足以接受序列和终止空字符，它将自动添加。

假设`stringVariableName`看起来像的声明`char stringVariableName[x];`，那么`&stringVariableName`是 a `char (*)[x];`，而不是 a `char *`。类型不对。行为未定义。它*可能*是巧合，但任何依赖巧合的东西都不*适用*于我的定义。

形成`char *`using的唯一方法`&stringVariableName`是 if `stringVariableName`is a **char**！这意味着*字符数组*仅大到足以接受终止空字符。如果用户在按下回车键之前输入了一个或多个字符，scanf 将写入*字符数组*的末尾并调用未定义的行为。如果用户只是按回车键，该`%[...]`指令将失败，甚至`'\0'`不会将 a 写入您的*字符数组*。

* * *

现在，说了这么多，我假设你的意思是这样的：（`scanf("%[^\n]", stringVariableName);`注意*省略的＆符号*）

你真的应该检查返回值！

指令使 scanf 检索由方括号`%[`之间指定的字符组成的字符序列。集合开头的 A 表示所需的集合包含除括号之间的字符之外的所有字符。因此，告诉 scanf 尽可能多地读取非字符，并将它们存储到对应的 . 指向的数组中。`[``]``^``%[^\n]``'\n'``char *`

将`'\n'`未读。这可能会导致问题。空字段将导致匹配失败。在这种情况下，可能不会将*任何数据*复制到您的数组中（甚至不是终止`'\0'`字符）。出于这个原因（和其他原因），*您确实需要检查返回值*！

哪本手册包含有关 scanf 的返回值的信息？[scanf 手册](http://pubs.opengroup.org/onlinepubs/009695399/functions/scanf.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T20:28:50.610

其他人已经解释了什么`%[^\n]`意思。

这***不是***读取字符串的好方法。它与臭名昭著的 unsafe 一样危险`gets`，并且出于同样的原因：它不知道缓冲区的`stringVariableName`大小。

从文件中读取一整行的最佳方法是[`getline`](http://linux.die.net/man/3/getline)，但并非所有 C 库都有它。如果不这样做，您应该使用[`fgets`](http://linux.die.net/man/3/fgets)，它知道缓冲区有多大，并注意您可能无法获得完整的行（如果该行对于缓冲区来说太长）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T20:22:59.037

从手册页中阅读`scanf()`...

> [ 匹配指定的可接受字符集中的非空字符序列；next 指针必须是指向 char 的指针，并且必须有足够的空间容纳字符串中的所有字符，外加一个终止空字节。前导空白的通常跳过被抑制。字符串由特定集合中（或不在）中的字符组成；该集合由左括号 [ 字符和右括号 ] 字符之间的字符定义。如果左括号后的第一个字符是抑扬符 (^)，则该集合排除这些字符。要在集合中包含右括号，请将其作为左括号或抑扬符之后的第一个字符；任何其他位置将结束该组。连字符 - 也很特殊；当放置在其他两个角色之间时，它将所有中间字符添加到集合中。要包含连字符，请将其设为最后一个右括号之前的最后一个字符。例如，[^]0-9-] 表示集合“除了右括号、0 到 9 和连字符之外的所有内容”。字符串以出现不在（或，带有抑扬符，in）集中的字符或字段宽度用完时结束。

简而言之， [^\n] 意味着从字符串中读取不是 a 的所有内容`\n`并将其存储在参数列表中的匹配指针中。

# php - 更新查询在 joomla 中不起作用

> ID：16201430
> 
> 赞同：0
> 
> 时间：2013-04-24T20:21:12.010
> 
> 标签：php, mysql, joomla, joomla-extensions

我正在开发一个 joomla 扩展，我正在尝试使用我的模型中的以下代码更新我的 joomla 扩展数据库表中的条目：

```
$this->_db->setQuery(
    $this->_db->getQuery(true)
    ->update('#__my_table')
    ->set('position=position+1')
);
$dbres = $this->_db->result(); 
```

但是它什么也不做，也没有输出错误（全局配置中的开发和错误报告最大值）

我直接在 PHPmyAdmin 中输入查询：

```
UPDATE cprn7_my_table SET position=position+1 
```

它可以正常工作。我读过关于用 orso 引用键和值的信息`$this->_db->quoteName()`，但是我找不到任何带有类似查询的示例，`SET position=position+1`但只是`SET position=$newval`因为我不知道要引用什么以及如何引用。

**//编辑：**发现错误，它必须是`$this->_db->query()`而不是`$this->_db->result()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:41:42.190

我想到了几种可能性。首先是启用该设置，防止其子句缺少主键列规范`--safe-updates`的更新（和删除） 。`WHERE`

phpMyAdmin 可能会关闭此设置，而您的默认 MySQL 客户端设置（在`my.cnf`、 下`[client]`）可能会启用它。您可以使用该`show variables`语句来发现设置的值。此外，有关更多信息，请参阅此文档：http: [//dev.mysql.com/doc/refman/5.5/en/mysql-command-options.html#option_mysql_safe-updates](http://dev.mysql.com/doc/refman/5.5/en/mysql-command-options.html#option_mysql_safe-updates)

第二个想法：您可以使用反引号引用列名，例如：

```
SET `position`=`position` + 1 
```

但是，如果这似乎仍然没有效果，并且如果您的服务器具有管理员级别的 MySQL 帐户，则可以打开常规登录，然后运行查询，然后再次将其关闭，然后检查结果。`--general-log`有关使用和相关设置的信息，请参阅此文档：http: [//dev.mysql.com/doc/refman/5.5/en/query-log.html](http://dev.mysql.com/doc/refman/5.5/en/query-log.html)

顺便说一句，如果您的 MySQL 客户端提供商（或 Joomla，或混合中的任何其他层）正在`--safe-updates`使用`SET`命令进行设置（即，在连接时），您还将在常规日志中将其视为已执行的语句。

# ruby - 块第一次无法识别变量

> ID：16201433
> 
> 赞同：1
> 
> 时间：2013-04-24T20:21:24.243
> 
> 标签：ruby, lambda, block

```
y = lambda { z }
z = 9

y.call
=> NameError: undefined local variable or method `z' for main:Object

y = lambda { z }
y.call
=> 9 
```

我认为拥有一个块的想法是推迟块内代码的执行。你能解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:31:31.330

When you define a lambda, it gets a **closure**, consisting of references to all the variables in scope *at the time of definition*. The lambda always has access to the current value of each variable it has "closed over", but newly defined variables aren't added to the closure retroactively. So when you do this:

```
x = 5
y = lambda { x + z }
z = 7 
```

the lambda `y` has access to the value of `x`, but not `z`, because only `x` was in existence at the time you defined the lambda. But if you do this:

```
x = 5
z = 0
y = lambda { x + z }

z = 7
y.call
# => 12 
```

then all will be well.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:41:00.380

`lambda`创建所谓的[词法闭包](http://en.wikipedia.org/wiki/Lexical_closure)，这意味着它捕获对封闭环境的引用，并且可以使用创建闭包时范围内的变量。

```
y = lambda { z } # Woops! There's no variable named `z`! 
```

是否创建一个以创建闭包`z` *命名的变量并不重要；*闭包的想法是它捕获了那个特定时刻的环境。

从理论上讲，您可能希望在创建该 lambda 时出现错误，因为可以对其进行分析并确定将取消引用尚未定义的变量。然而，Ruby 不是这样工作的。只有在评估代码时，您才会因尝试访问未定义的变量而出错。

当您在几行之后创建第二个闭包时，该闭包*确实*捕获了一个`z`存在的环境：

```
y = lambda { z } # This closure is broken and can't be fixed
z = 9
y = lambda { z } # This is a new closure, and `z` is accessible within it 
```

*我认为拥有一个块的想法是推迟块内代码的执行。*

有点，但它与简单地从 lambda 复制和粘贴代码并在调用它时对其进行评估不同。 `eval`一个字符串会这样做：

```
y = "z"
z = 9
eval(y)
# => 9 
```

同样，闭包的想法是它同时捕获代码*和*环境。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T20:24:21.043

在第一行中，当创建块时，还没有任何东西`z`可以被块“捕获”。当你写`y = lambda { z }`第二次时，有一个`z`.

该块拍摄周围变量的一种快照。`z`在这种情况下，第一次没有出现命名变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T20:23:02.070

`undefined local variable or method 'z' for main:Object`在未创建局部变量时出现。`assignment`仅由操作创建的局部变量。

您的第一个`y = lambda { z }`无法`z`按照`z`此定义后的定义进行绑定`lambda`。

以下作品：

```
y = lambda { z }
y.call
=> 9 
```

正如您`z = 9`在第二个 lambda 定义之前定义的那样。

# c# - 流利的 NHibernate 多对多与额外的列不插入

> ID：16201439
> 
> 赞同：1
> 
> 时间：2013-04-24T20:21:46.950
> 
> 标签：c#, nhibernate, orm, fluent-nhibernate

我正在与流利的 nhibernate 作斗争[Fluent Nhibernate 的流利的 nhibernate 多对多映射和额外的列](https://stackoverflow.com/questions/2455473/fluent-nhibernate-many-to-many-mapping-with-extra-column)

我已经复制了映射并编写了我能写的最小程序……但它不会保存……有人能提供一些见解吗？？？

```
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IList<Inventory> Inventory { get; set; }

    public Product()
    {
        Inventory = new List<Inventory>();
    }
}

public class Warehouse
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IList<Inventory> Inventory { get; set; }

    public Warehouse()
    {
        Inventory = new List<Inventory>();
    }
}

public class Inventory
{
    public Product Product { get; set; }
    public Warehouse Warehouse { get; set; }
    public bool StockInHand { get; set; }

    // override object.Equals
    public override bool Equals(object obj)
    {
        if (obj == null || GetType() != obj.GetType())
        {
            return false;
        }
        var i = obj as Inventory;

        return ((i.Product.Id == this.Product.Id) 
             && (i.Warehouse.Id == this.Warehouse.Id));
    }

    // override object.GetHashCode
    public override int GetHashCode()
    {
        return 9999;
    }
}
public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Not.LazyLoad();
        Table("Product");
        Id(x => x.Id).GeneratedBy.Assigned();
        Map(x => x.Name);
        HasMany(x => x.Inventory).AsBag()
         .Cascade.All()
         //.Inverse()
         .Table("Inventory");
    }
}
public class WarehouseMap : ClassMap<Warehouse>
{
    public WarehouseMap()
    {
        Not.LazyLoad();
        Table("Warehouse");
        Id(x => x.Id).GeneratedBy.Assigned();
        Map(x => x.Name);
        HasMany(x => x.Inventory).AsBag()
         .Cascade.All()
         .Inverse()
         .Table("Inventory");
    }
}
public class InventoryMap : ClassMap<Inventory>
{
    public InventoryMap()
    {
        Not.LazyLoad();
        Table("Inventory");
        CompositeId()
          .KeyReference(x => x.Product, "Product_id")
          .KeyReference(x => x.Warehouse, "Warehouse_id");

        Map(x => x.StockInHand);
    }
} 
```

而节目...

```
using (var session = sessionFactory.OpenSession())
{
    using (var transaction = session.BeginTransaction())
    {
        Product p = new Product() { Id = 1, Name="product" };
        Inventory i = new Inventory() { StockInHand = true };
        i.Product = p;
        p.Inventory.Add(i);
        Warehouse w = new Warehouse() { Id = 1, Name = "warehouse" };
        i.Warehouse = w;
        w.Inventory.Add(i);

        session.SaveOrUpdate(p);

        session.Flush();

        transaction.Commit();
    }
} 
```

我得到的例外是

```
constraint failed\r\nforeign key constraint failed 
```

我还输出了 create 语句，这对我来说看起来是正确的......

```
create table Inventory (
    Product_id INT not null,
   Warehouse_id INT not null,
   StockInHand BOOL,
   primary key (Product_id, Warehouse_id),
   constraint FK2B4C61665C5B845 foreign key (Product_id) references Product,
   constraint FK2B4C616A6DE7382 foreign key (Warehouse_id) references Warehouse)

create table Product (
    Id INT not null,
   Name TEXT,
   primary key (Id)
)

create table Warehouse (
    Id INT not null,
   Name TEXT,
   primary key (Id)
) 
```

以及在异常之前运行的 SQL....

```
NHibernate:
INSERT
INTO
    Warehouse
    (Name, Id)
VALUES
    (@p0, @p1);
@p0 = 'warehouse' [Type: String (0)], @p1 = 1 [Type: Int32 (0)]
NHibernate:
INSERT
INTO
    Inventory
    (StockInHand, Product_id, Warehouse_id)
VALUES
    (@p0, @p1, @p2);
@p0 = True [Type: Boolean (0)], @p1 = 1 [Type: Int32 (0)], @p2 = 1 [Type: Int32 (0)] 
```

那么这应该如何正常工作？！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T19:12:16.603

您的问题的原因是 NHibernate 试图在`Inventory`记录之前插入`Warehouse`记录。这是因为插入的顺序由`session.Save`调用的顺序决定。基于此信息，我尝试了许多代码变体来防止外键约束错误。我在下面发布了我最好的解决方案。

```
using (var session = sessionFactory.OpenSession())
using (var transaction = session.BeginTransaction())
{
    var warehouse = new Warehouse() { Id = 1, Name = "warehouse" };
    session.Save(warehouse);

    var product = new Product() {Id = 1, Name = "product"};
    var inventory = new Inventory 
                     { StockInHand = true, Product = product, Warehouse = warehouse};

    product.Inventory.Add(inventory);
    warehouse.Inventory.Add(inventory);

    session.Save(product);

    transaction.Commit();
} 
```

我发现的一件让我相当吃惊的事情是，如果你把它放在`session.Save(warehouse)`后面，`warehouse.Inventory.Add(inventory)`那么 NHibernate 不会`Warehouse`先插入记录并且会抛出外键错误。

最后一点，要获得下面列出的三个插入语句，必须在映射类`Inverse()`中重新设置。`ProductMap`否则 NHibernate 将发出一个额外的更新语句。

```
INSERT INTO Warehouse (Name, Id) VALUES (@p0, @p1);@p0 = 'warehouse' 
[Type: String (4000)], @p1 = 1 [Type: Int32 (0)]

INSERT INTO Product (Name, Id) VALUES (@p0, @p1);
@p0 = 'product' [Type: String (4000)], @p1 = 1 [Type: Int32 (0)]

INSERT INTO Inventory (StockInHand, Product_id, Warehouse_id) VALUES (@p0, @p1, @p2);
@p0 = True [Type: Boolean (0)], @p1 = 1 [Type: Int32 (0)], @p2 = 1 [Type: Int32 (0)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-26T20:39:45.157

对于任何可能追随我脚步的人...

我的问题是我想在链接表中存储有关实体之间关系的一些信息。数据库术语中的经典多对多关系在域对象之间具有链接表。

使用问题中概述的结构，需要先插入仓库和产品，然后才能插入库存项目。必须最后插入 Inventory 项目，以便在保存之前两个外键约束都到位。

```
Insert into Product

Insert into Warehouse

Insert into Inventory (Note this happens **after** the primary keys are 
inserted in Warehouse and Product!) 
```

但是我使用我的映射 Fluent NHibernate 生成以下...

```
Insert into Product

Insert into Inventory (Foreign Key constraint violated, no Warehouse) 
```

..这一定是不正确的，因为仓库没有主键！我理解这个问题，但不是解决方案......我已经设法产生了如下两个解决方案，但我认为两者都不是最理想的。

```
public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Not.LazyLoad();
        Table("Product");
        Id(x => x.Id, "Product_id").GeneratedBy.Assigned();
        Map(x => x.Name).Column("Name").Length(10);
        HasMany(x => x.Inventory)
            .Cascade.Delete()
            .KeyColumn("Product_id");
    }
}
public class WarehouseMap : ClassMap<Warehouse>
{
    public WarehouseMap()
    {
        Not.LazyLoad();
        Table("Warehouse");
        Id(x => x.Id, "Warehouse_id").GeneratedBy.Assigned();
        Map(x => x.Name).Column("Name").Length(10);
        HasMany(x => x.Inventory)
            .Cascade.All()
            .KeyColumn("Warehouse_id");
    }
}
public class InventoryMap : ClassMap<Inventory>
{
    public InventoryMap()
    {
        Not.LazyLoad();
        Table("Inventory");
        CompositeId()
          .KeyReference(x => x.Product, "Product_id")
          .KeyReference(x => x.Warehouse, "Warehouse_id");
        Map(x => x.StockInHand);
    }
} 
```

我可以按预期执行保存并让一半的代码工作，但它以序数为前提。即，我必须了解这些对象需要保存的顺序。我还没有测试过删除会发生什么，但这确实意味着我必须按照正确的顺序来保存这些对象。/* 工作 */ session.Save(product); session.Save(仓库); // 也会保存库存

```
/* would fail */
session.Save(warehouse);
session.Save(product); 
```

或者（我更不喜欢这个）我可以告诉 Nhibernate 我想对所有事情负责......

```
public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Not.LazyLoad();
        Table("Product");
        Id(x => x.Id, "Product_id").GeneratedBy.Assigned();
        Map(x => x.Name).Column("Name").Length(10);
        HasMany(x => x.Inventory).Inverse();
    }
}
public class WarehouseMap : ClassMap<Warehouse>
{
    public WarehouseMap()
    {
        Not.LazyLoad();
        Table("Warehouse");
        Id(x => x.Id, "Warehouse_id").GeneratedBy.Assigned();
        Map(x => x.Name).Column("Name").Length(10);
        HasMany(x => x.Inventory).Inverse();
    }
}
public class InventoryMap : ClassMap<Inventory>
{
    public InventoryMap()
    {
        Not.LazyLoad();
        Table("Inventory");
        CompositeId()
          .KeyReference(x => x.Product, "Product_id")
          .KeyReference(x => x.Warehouse, "Warehouse_id");
        Map(x => x.StockInHand);
    }
} 
```

现在我得到以下

```
/* works */
session.save(Product);
session.Save(Warehouse);
session.Save(Inventory);

/* works */
session.Save(Warehouse);
session.Save(Product);
session.Save(Inventory);

/* fails */
session.Save(Inventory);
session.Save(Warehouse);
session.Save(Product); 
```

任何人都可以对此进行改进并给我我真正想要的映射，这样我就可以保存一个仓库或一个产品和 Fluent NHibernate，这将使订购正确！？？例如。

```
session.Save(warehouse); // or session.Save(product); 
```

所以这会导致

```
Insert into Warehouse... 
Insert into Product...
Insert into Inventory... // where NHibernate determines this goes last so that primary keys are in place on both previous tables! 
```

# sql-server - SQL Server：返回带有值的相关xml，节点方法

> ID：16201446
> 
> 赞同：1
> 
> 时间：2013-04-24T20:22:07.410
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, sql-server-2012

我有一个在 SQL Server 2012 中查询的以下示例 XML 架构。我有一个带有 XML 列的表。我想在返回每一行时包含 xml 的片段。

以下是现有查询和更详细的说明。

```
<dev:Doc xmlns:dev="http://www.w3.org/2001/XMLSchema" Number="0" SchemaVersion="0.1" Settings="Testing" Title="Ordering">
  <dev:Forms FormId="A1">
    <dev:A1 ItemNumber="1" ItemGuid="{F402C584-555E-4D07-8C35-E88889B9DA44}">
      <dev:Codes>D</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Visitors>
        <dev:Visitor Name="Dev01" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev02" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev03" Location="FGRTY">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="FGY(14A)" />
      </dev:Senders>
    </dev:A1>
  </dev:Forms>
  <dev:Forms FormId="A2">
    <dev:A2 ItemNumber="1" ItemGuid="{3563F33E-B03A-4859-850E-A87D35BD8562}">
      <dev:Codes>C</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Support</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="GHFF">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>LOPO</dev:FromLocation>
              <dev:ToLocation>RDSS</dev:ToLocation>
              <dev:Description>Rich Filter</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="W33R" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
    <dev:A2 ItemNumber="2" ItemGuid="{CCFB2D5D-A23E-412D-8541-536451873713}">
      <dev:Codes>A</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Loader Ready</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="UDT">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>TYUJ</dev:FromLocation>
              <dev:ToLocation>DETF</dev:ToLocation>
              <dev:Description>Web Enhance</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="RJ4" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
  </dev:Forms>
</dev:Doc> 
```

示例查询

```
;WITH XMLNAMESPACES (Default 'http://www.w3.org/2001/XMLSchema' )
  SELECT 
     a.value('@Number[1]', 'int') as Number
    ,b.value('(@FormId)[1]', 'NVARCHAR(50)') Form
  --,XmlDocument.query('Doc/Forms') as FormXml, 
    ,c.value('@ItemGuid[1]', 'uniqueidentifier') as ItemGuid
    ,c.value('@ItemNumber[1]', 'INT') AS ItemNumber
    ,d.value('(@Name)[1]','nvarchar(50)') As  Visitor
    ,d.value('(@Location)[1]','nvarchar(50)') As Location
    ,e.value('(@Name)[1]', 'NVARCHAR(50)') As Sender        
  FROM
    XmlTable As X
  CROSS APPLY XmlDocument.nodes('Doc') As aa(a)
  CROSS APPLY a.nodes('Forms') As bb(b)
  CROSS APPLY b.nodes('*') As cc(c)
  CROSS APPLY c.nodes('Visitors/Visitor') as dd(d)
  CROSS APPLY c.nodes('Senders/Sender') as ee(e) 
```

我想做的是在 Form 列之后包含 xml 片段以显示它来自的片段。

我正在尝试这个

```
 XmlDocument.query('Doc/Forms') as FormXml, 
```

以上是从该元素返回，我只想将所有内容`<dev:Forms FormId="A1">`从`</dev:A1>`与`A1`. 所以当`A2`我想要表格时`A2`- `/A2`<--- 之间的一切

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:31:11.540

我相信您想要得到的是`b`“表”引用的 XML，不是吗？

试试这条线：

```
, b.query('.') as FormXml 
```

这会给你想要的吗？它应该为您提供`<Forms>`节点的 XML。

# java - 如何在开始更多 Java 之前等待线程完成

> ID：16201450
> 
> 赞同：0
> 
> 时间：2013-04-24T20:22:34.797
> 
> 标签：java, multithreading

所以说我有 10 件事情要运行，但我一次只能运行 3 个线程。

```
ArrayList<NewThread> threads = new ArrayList<NewThread>();

for(int i = 1; i < args.length; i++) {
   NewThread t = new NewThread(args[i]);
   threads.add(newThread);

   if( (i%3) == 0) {
      for (NewThread nt : threads) {
         nt.join();
      }
      threads.clear();
   }
} 
```

NewThreads 类实现了 Runnable。我认为 join() 方法可以让它等待线程完成，然后再次循环并启动下一批线程，但是我得到了堆栈溢出异常。我认为我执行 join() 不正确，但我不确定该怎么做。我目前正在这样做

```
public void join() {
   this.join();
} 
```

在我的 NewThread 类中。关于如何让这个工作或更好的方法去做的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:24:48.047

您正在实施或覆盖连接以无休止地调用自己

```
public void join() {
   this.join(); // call myself until I blow up.
} 
```

最简单的解决方案是使用已经存在的 Thread.join()，但更好的解决方案是使用固定大小的线程池，这样您就不必启动和停止线程，这会浪费大量时间和代码。

您可以使用 ExecutorService

```
ExecutorService es = Executors.newFixedThreadPool(3);
for(int i=0;i<10;i++)
    es.submit(new Task(i)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:29:15.843

这只是一个简单的错误。

删除方法

```
 public void join() {
      this.join();
    } 
```

这个方法一次又一次地调用自己。NewThread 应该扩展 Thread。

或第二种方式：

保留方法并调用

```
 Thread.currentThread.join(); 
```

其余的看起来不错。

# excel - Avaya CMS 的 VBA 代码不会在不同的用户上运行

> ID：16201451
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:22:40.390
> 
> 标签：excel, vba, avaya

在我们的呼叫中心，我们使用 Excel VBA 通过 Avaya CMS 主管提取集成数据。多年来，我们一直在使用相同的代码。

我们的一位主管无法使用她的 Windows NT 登录名运行报告。她在尝试时收到 OLE 超时错误。如果每个其他用户尝试在同一台计算机上使用他们的 NT，他们都可以运行该报告。

我们没有足够了解 VBA 或 Avaya 的人来进行故障排除（雇用了一个临时工来编码）。我充其量只是中级水平，并且发现逻辑没有任何问题-正如我之前所说，它对我来说运行良好。

当我询问我们的专门 IT 部门这是否可能是用户配置文件问题时，他们告诉我所有主管都拥有相同的“千篇一律”配置文件。他们说这一定是VBA代码的问题。

**此时我可以尝试其他故障排除方法吗？**除了 Avaya 的用户权限和代码本身，还有什么会干扰 VBA 的吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:07:01.050

如果该主管将其设置在比其他人更高的级别，则可能是用户帐户控制 (UAC) 的问题。当 UAC 打开时，它会限制您在 VBA 中可以执行的操作。要检查 UAC 级别，请打开控制面板，然后打开“用户帐户”、“更改用户帐户控制设置”

使用 Excel VBA 提取数据的一种替代方法是使用基于 Web 浏览器的报告工具，该工具具有定期导出到 Excel 的完整权限控制。NetLert 的 N-Focus Plus 报告工具可以做到这一点 - 它从 CMS 中提取数据，将其存储到服务器上的数据库中（因此，您可以存储无限的历史间隔数据），允许您设置任意数量的无限制权限'主管，因此他们只能看到他们的数据或他们的组的数据，他们可以将报告导出到 Excel 或设置自己的自动每日/每周/每月报告分发。它还在一个基于 Web 的界面中将多个 CMS 服务器联系在一起，并进行实时和历史报告...查看[http://www.netlert.com/nfocus_video_overview.php](http://www.netlert.com/nfocus_video_overview.php)

# r - R sum list of data.frame 具有几乎相同的结构

> ID：16201453
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:22:56.027
> 
> 标签：r

这是我的问题，

我有一个 data.frames 列表。它是由具有不同数据的同一段代码产生的。

所有的 data.frames 看起来像

US 100（不保证存在于另一个data.frame中，因为数据不同）CA 50 ...

是否有任何快速/简洁的方法来总结所有 data.frames？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:52:19.797

我不确定我是否正确理解了您的问题，但这里有一个可能的解决方案：

尝试将所有数据帧放在一个列表中，例如，`your_list=list(df1,df2,...)` 然后用于`total_df=do.call(rbind,your_list)`组合所有数据帧（按行）。

之后，您可以使用`ddply(total_df,"country",function (x) sum(x$value))`聚合数据。在这里，我假设`US`and`CA`代表`country`列中的条目`100`和列`50`中的条目`value`。

# java - 在另一个字符串中查找字符串子集的最快方法？

> ID：16201458
> 
> 赞同：1
> 
> 时间：2013-04-24T20:23:06.820
> 
> 标签：java, string, complexity-theory, huffman-code

我正在解码由霍夫曼编码生成的字节文件，我将字节转换为字符串，然后搜索霍夫曼树给出的值。我有一个哈希表，其中包含原始文件的编码值和字节值。这是我的代码。

```
for(int i = 0, j = 1; j <= encodedString.length(); j++){

        if(huffEncodeTable.get( encodedString.substring(i, j)) != null){

            decodedString.append(huffEncodeTable.get( encodedString.substring(i, j)));
            i = j;      

        } 
```

它非常简单，它是一个遍历所有字符串的循环，当字符串太大时问题就来了 - 压缩文件的大小大于 100KB - 处理它们需要很长时间，所以我想知道是否这是一种以更快的方式进行此过程的方法，或者如果将我的编码值存储在另一个结构中而不是 hastable 中更好。

huffEncodeTable -> 哈希表

encodedString -> 带有霍夫曼值的字符串

decodedString -> 表示原始文件的原始字节的字符串

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:53:36.020

对不同长度的字符串使用子字符串确实会减慢速度。在 Java 7 中，它使用原始字符串的副本创建两个对象。您最好创建一个子字符串并针对 NavigableMap 进行搜索。

使用 NavigableMap 将允许您在一次操作中找到最长的匹配字符串，并减少您需要存储在地图中的字符串数量。

注意：即使如此 Map 的大小将是 O(N^2) 其中 N 是您可以回顾的最大字符串长度，因此您必须对 N 的大小设置合理的限制。

注意 2：您将很幸运能够达到内置霍夫曼代码（为您编写，标准且有效）的十分之一的速度，因此如果性能很重要，请使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:45:29.070

几个建议：

每次附加到字符串时，都会创建一个新字符串。你应该`StringBuilder`改用。正如我所看到的，这可能是主要问题。

另外，我会使用`hashtable.containsKey`而不是`get`检查密钥的存在。我怀疑它会影响你的表现。

如果将调用结果存储到子字符串，也可以节省一点时间，因此只调用一次。

所以，类似的东西。

```
StringBuilder sb = new StringBuilder()
String currentString;
for(int i = 0, j = 1; j <= encodedString.length(); j++){
    currentString = encodedString.substring(i, j)
    if(huffEncodeTable.containsKey( currentString )){

        sb.append(huffEncodeTable.get( currentString ));
        i = j;      

    }
}
return sb.toString(); //Or whatever you do with it. 
```

# java - 特定大小的所有可能的唯一集

> ID：16201459
> 
> 赞同：0
> 
> 时间：2013-04-24T20:23:09.207
> 
> 标签：java, math, set

是否有任何库可以进行此类设置操作。

我有一组 (x,y) 点。然后我需要创建一个集合（系列）。族中的每个 Set 都应包含一定数量的元素。集合中元素的顺序无关紧要。所以 [m, l, n] 与 [l, m, n] 是同一个集合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:26:19.540

你要求的是所谓的[组合](https://en.wikipedia.org/wiki/Combination)。Guava 有[一种方法](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Collections2.html#permutations%28java.util.Collection%29)来计算相关的排列。但是，如果您只需要组合，则鲜为人知的[combinatoricslib](https://code.google.com/p/combinatoricslib/)看起来像[The Right Thing](https://code.google.com/p/combinatoricslib/#3._Simple_combinations)。`String`这是该图书馆网站上使用s的示例：

```
// Create the initial vector
ICombinatoricsVector<String> initialVector = Factory.createVector(
   new String[] { "red", "black", "white", "green", "blue" } );

// Create a simple combination generator to generate 3-combinations of the initial vector
Generator<String> gen = Factory.createSimpleCombinationGenerator(initialVector, 3);

// Print all possible combinations
for (ICombinatoricsVector<String> combination : gen) {
   System.out.println(combination);
} 
```

# macos - g++ x86_64 NS_NewGenericModule2

> ID：16201461
> 
> 赞同：0
> 
> 时间：2013-04-24T20:23:17.230
> 
> 标签：macos, mozilla, xpcom

我正在尝试进行扩展开发，但在链接我的代码时遇到了错误——它没有找到 NS_NewGenericModule2。

架构 x86_64 的未定义符号：“NS_NewGenericModule2(nsModuleInfo const*, nsIModule**)”，引用自：meta.old 中的 _NSGetModule：未找到架构 x86_64 的符号

我正在使用 MacOsX lion... 有没有人有 XPCOM 模块或带有 c++ 的 Mozilla 扩展并且可以共享源代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:28:41.017

您似乎使用了一些非常过时的示例代码 -`NS_NewGenericModule2`已从 Firefox 4 的 Firefox 代码库中删除，以及[XPCOM 的主要更改](https://developer.mozilla.org/en/XPCOM/XPCOM_changes_in_Gecko_2.0)。我不确定您是如何编译代码的，以及为什么仅在链接时出现问题 - 通常（使用当前 XULRunner SDK 版本时）您应该在编译期间已经收到错误。

至于当前的示例代码，[Firefox 代码库中](http://mxr.mozilla.org/mozilla-central/source/xpcom/sample/)有一个。查看`nsSampleModule.cpp`模块定义示例，`nsSample.cpp`包含实际的 XPCOM 对象实现。

# java - 猜数字游戏每次猜都会产生不同的数字

> ID：16201463
> 
> 赞同：1
> 
> 时间：2013-04-24T20:23:33.457
> 
> 标签：java, jsp, random

我有一个 Java 服务器页面，它允许用户从 1 到 1000 中选择他们选择的数字。然后该页面使用输入的号码并确定该号码是否与生成的号码匹配。-- 如果 ^ 不清楚，请参见下面的图片。目前，每当用户猜测一个数字时，该程序都会生成一个不同的数字——无论它是否正确。如何使程序仅在用户刷新页面或正确猜测时生成一个数字？

JSP代码：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">
<%@ page import = "Chapter12.RandomGuess" %>
<jsp:useBean id = "randomGuessId" class = "Chapter12.RandomGuess" scope = "page" >
</jsp:useBean>
<jsp:setProperty name = "randomGuessId" property = "*" />
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Guess Random Number</title>
</head>
<body>
<h3>Guess a number from 1 to 1000</h3>
<form method = "post">
    Enter guess: <input name = "guess" /><br /><br />
    <input type = "submit" name = "Submit" value = "Take Guess" />
    <input type = "reset" value = "Reset" /><br /><br />
    Your guess of <jsp:getProperty name = "randomGuessId" property="guess" />
    is <%= RandomGuess.guess(randomGuessId.getAnswer()) %>
    </form>
</body>
</html> 
```

Java代码：

```
import java.util.Random;

public class RandomGuess {
private int guess;
Random r = new Random();
private int low = 1;
private int high = 1000;
int R = r.nextInt(high-low) + low;

public int getGuess() {
    return guess;
}

public void setGuess(int newValue) {
    guess = newValue;
}

public String getAnswer() {
    String tooLow = "too low.";
    String tooHigh = "too high.";
    String correct = "correct!";
    if(guess == R) 
        return correct;
    else if(guess < R) 
        return tooLow;
    else
        return tooHigh;
}   
public static String guess(String s) {
    return s;
}
} 
```

图片：http: [//i.imgur.com/dMSZ7SD.png](http://i.imgur.com/dMSZ7SD.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:28:35.873

每次页面刷新时，都会创建一个新的 bean 实例 - 使用一个新编号。

要在通话中保留号码，请在您的类中使用静态字段。

* * *

更好的是，使用 JavaScript！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-12T18:56:00.080

在这里找到完整的程序：http: [//sickprogrammersarea.blogspot.in/2014/01/creating-number-guesser-in-jsp_8296.html](http://sickprogrammersarea.blogspot.in/2014/01/creating-number-guesser-in-jsp_8296.html)

你好朋友这是一个在JSP中创建数字猜测器的简单程序......看看......

**数字.jsp：**

```
<html>
<head><title>Number Guesser</title></head>
<body>
<%              int num=(int)(Math.random()*100);        %>
<h2>Welcome To Number Guesser</h2>
<br><h3>Want To Check Your Guessing Power.....GIVE IT A TRY?????</h3>
<form name="guess" action="try.jsp?c=0" method="post">
<input type="text" name="val" value="<%=num %>" hidden>
<input type="submit" value="GO">
</form>
</body>
</html> 
```

**尝试.jsp：**

```
<html>
<head><title>Number Guesser</title></head>
<body>
<%    String str=request.getParameter("val");
      boolean flag=true;      
      int num=Integer.parseInt(str);
      int c=Integer.parseInt(request.getParameter("c"));
      if(c!=0)
      {
                  int guess=Integer.parseInt(request.getParameter("guess"));
                  if(num==guess){
                              flag=false;
      %>
                  <h3>Congratulation...You Successes After <%=c%> attempts</h3>
                  <b>Want to Improve...<a href="Number.jsp">try again</a></b>
      <%       }else if(num>guess) { %>
                  <h3>You Guessed Lower...Try Bigger Number</h3>
      <%       }else{ %>       
                  <h3>You Guessed Higher...Try Smaller Number</h3>
      <%       }
      }
      if (flag) { c++; %>     
      <h3>I Guessed a Number between 1 to 100\. Try To Guess..</h3>
      <form name="guess" action="try.jsp?c=<%= c%>" method="post">
      <input type="text" value="<%=num %>" name="val" hidden>
      Make Your Guess : <input type="text" name="guess" size=10 maxlength=3>
      <input type="submit" value="GO">
      </form>
      <% } %>

</body> 
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:31:43.847

You could pass the user number back as a query parameter.

I'm guessing you are not too familiar with the MVC pattern or Spring, but there are plenty of resources available to get you quickly up and running. I'll try to make a strip down demo later, if I remember.

# ios - 将 FacebookSDK AppDelegate 调用封装到静态库中的问题

> ID：16201466
> 
> 赞同：1
> 
> 时间：2013-04-24T20:23:48.597
> 
> 标签：ios, facebook, multithreading, appdelegate

我正在为不同目的开发一个库，但我无法理解 FacebookSDK 的问题。我已经在我的库中封装了所有 Facebook SSO 登录过程，它完美地集成在我正在开发的应用程序中，少了一个与线程相关的小细节。如 Facebook 开发者页面中的 iOS SDK 教程所示，我必须调用我的应用程序 AppDelegate 中的 appDidBecomeActive 方法中的“handleDidBecomeActive”方法，但检查 Facebook 中打开的会话的一些内容，以便重定向（或不重定向）到 Facebook Native iOS 应用程序、Safari 或其他：

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    if(//Notice that I can reveal code here, but checks if the session in Facebook is 
    opened){
        [FBSession.activeSession handleDidBecomeActive];
    }
} 
```

考虑到我对这个库的目标，并将登录过程的其余部分封装在我的库中，我通过调用封装的方法封装了这些行：

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    [[MyLibrarySingleton sharedInstance] handleDidBecomeActive];
} 
```

显然，该方法执行与第一个代码块中所示相同的 Facebook 会话检查和 Facebook 会话 handleDidBecomeActive 调用。出乎意料的是，第一种方法与我的库的其余部分完美配合，并集成在应用程序中。但是第二种方式（封装在我的库中）使 FacebookSDK 在内部检查您是否只能从一个线程访问 FBSession 对象的方法中崩溃（这意味着，似乎封装的方法会抛出与当前线程不同的线程，即与创建了 FBSession 对象并能正常工作的相同）。我不会在流程中抛出任何新线程，只是更改第一个代码块中的代码，将其插入第二个代码块中显示的方法中。有任何想法吗？？

谢谢！

# c - Linux内核中wake_up_sync/wake_up_interruptible_sync的用途

> ID：16201468
> 
> 赞同：3
> 
> 时间：2013-04-24T20:23:55.777
> 
> 标签：c, linux, multithreading, linux-kernel, linux-device-driver

我正在关注[Linux Device Drivers 3rd Edition](http://www.makelinux.net/ldd3/chp-6-sect-6#chp-6-sect-6.3)书中的一个示例：

```
if (temp =  = 0)
    wake_up_interruptible_sync(&scull_w_wait); /* awake other uid's */
return 0; 
```

作者指出：

> 这是一个调用 wake_up_interruptible_sync 有意义的示例。当我们进行唤醒时，我们正要返回用户空间，这是系统的自然调度点。与其在我们进行唤醒时潜在地重新安排，不如只调用“同步”版本并完成我们的工作。

我不明白为什么`wake_up_interruptible_sync`在这种情况下使用更好。作者暗示这个调用将阻止重新调度——它确实在调用中阻止了它——但是在返回之后，另一个线程不能在该行`wake_up_interruptible_sync`之前控制 CPU吗？`return 0`

那么，如果一个线程在每次调用之后都可以控制 CPU，那么调用`wake_up_interruptible_sync`典型的有什么区别呢？`wake_up_interruptible`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T09:24:43.983

使用的原因`_sync`是我们*知道*调度器会在短时间内运行，所以不需要第二次运行。然而，这只是一个优化；如果调度程序*确实*再次运行，则不会发生任何不好的事情。

定时器中断确实可以在任何时候发生，但只有当调度程序最近由于某些其他原因没有运行时才需要它。

# python - 在 python 中使用 try 和 except

> ID：16201479
> 
> 赞同：1
> 
> 时间：2013-04-24T20:24:32.043
> 
> 标签：python, class, try-catch, except

我最近听说过使用语句在 python 中处理异常的可能性

```
try: 
```

和

```
except  WhateverError: 
```

我只是想知道在定义下一个类时使用它是否是个好主意。它应该代表一个地形。矩阵的每个数字代表它的一个坐标，数字是该坐标的高度。

```
class base_terreny(object):
    # create default mxn terrain #

    def __init__(self, rows, columns):
        self.rows=rows
        self.columns=columns
        self.terrain=[[0]*columns for _ in range(rows)]

    def __getitem__(self, pos): #return height of coordinate
        try:
            return self.terrain[pos[1]][pos[0]]
        except (IndexError,TypeError):
            return 0

    def __setitem__(self, pos, h): #set height
        try:
            self.terrain[pos[1]][pos[0]]=h
        except (IndexError,TypeError):
            return None 
```

或者这样做会更好：

```
if pos[0]<=self.columns and pos[1]<=self.rows:       
   self.terrain[pos[1]][pos[0]]=h 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-18T00:25:27.363

两种方式都可以接受，但是使用第二种方式可能更干净。虽然异常通常很有用，但您实际上尝试使用异常进行测试的是第二种技术。虽然在这种情况下确实无关紧要，但通常认为使用 if 语句更好，除非您实际上试图以不同的方式处理错误。在不同的情况下，除了您要测试的内容之外，可能还有其他事情可能会触发错误。

# java - 在 Java Swing 应用程序中检查元素

> ID：16201493
> 
> 赞同：2
> 
> 时间：2013-04-24T20:25:03.883
> 
> 标签：java, eclipse, swing, element, inspect

例如，在 Eclipse 中使用 Tomcat 运行的 Web 应用程序中，我们可以右键单击页面中的元素并检查它（例如使用 Firebug），我们可以看到元素的 ID、类等。如果我们有我们从 Eclipse 运行的 JAVA Swing 应用程序（右键单击项目 ==> 调试为 ==> eclipse 应用程序），我们可以做同样的事情，以便我们可以看到哪个方法，例如处理该元素，或其他什么？我们可以在运行时检查 JAVA Swing 元素（来自 Eclipse）吗？我已经检查了 swing-inspector，但我不想要它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-29T10:35:47.487

很抱歉，我无法为您提供 Eclipse 的解决方案。如果您可以使用 Netbeans，它包含一个[可视化调试器功能](https://netbeans.org/kb/docs/java/debug-visual.html)。它使用简单，默认集成在 Netbeans 中。

# android - 找出我使用的密钥库文件

> ID：16201495
> 
> 赞同：2
> 
> 时间：2013-04-24T20:25:13.510
> 
> 标签：android, android-keystore

我不记得我用于我的 Android 应用程序的密钥库文件。有什么办法可以查到吗？
或者我可以在我的硬盘上搜索所有的 Keystore 文件吗？问题是该文件没有扩展名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:28:24.847

密钥库文件可以有任何扩展名，因此搜索不太可能对您有所帮助。

您可以从已签名的文件中提取某些详细信息，例如公钥，但这些都不能帮助您在设备上找到相应的文件。

如果您是通过 Eclipse 完成的，它可能会记住该位置。

如果你是通过终端完成的，而且不是很久以前，你可以一直按向上箭头键并希望你到达你用来签名它的命令，其中将包含文件路径，或者你可能会到达一个`cd`which在运行签名命令之前切换到包含文件的目录。

如果这些都不起作用，那么您很不走运，将不得不手动搜索您的文件，或者创建一个新的密钥库（在这种情况下，如果您的应用程序已发布，您将必须以新的包名称重新发布您的应用程序）。

将来，请将您的密钥库备份到多个（安全）位置，以防止出现此类情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-07T04:04:27.337

如果您是通过 Eclipse 完成的，请尝试使用以下命令重新导出您的应用程序：

文件>>导出>>导出安卓应用

并希望它仍然指向您的密钥库的最后一个位置。

# python - Django 测试在 0.000 秒内运行 0 次测试

> ID：16201497
> 
> 赞同：5
> 
> 时间：2013-04-24T20:25:19.193
> 
> 标签：python, django, unit-testing

我使用命令 manage.py test myApp 运行了 Django 测试。我禁用了南，以便进行测试以在数据库中创建数据。tests.py 仅包含以下内容。

```
from django.test import TestCase

class SimpleTest(TestCase):
    def test_basic_addition(self):
        """
        Tests that 1 + 1 always equals 2.
        """
        self.assertEqual(1 + 1, 2) 
```

输出结果如下。

```
Creating test database for alias 'default'...

----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK
Destroying test database for alias 'default'... 
```

# c# - C#：无法写入已关闭的 TextWriter

> ID：16201502
> 
> 赞同：0
> 
> 时间：2013-04-24T20:25:51.123
> 
> 标签：c#

为什么当程序点击//这里。它因未处理的异常而崩溃：System.ObjectDisposedException：无法写入已关闭的 TextWriter。？Print() 方法在LogClose()*之前调用。*我想要实现的是如果它点击这里然后打印出消息和程序退出

```
foreach (string sf in ff)
{

    if (File.Exists(sf))
    {
        File.Move(sf, copy_dir + "\\" + sf);
    }
    else
    {
        //HERE
        l.ExitAndOut("Error: " + sf + " not found");
    }
}

class logger {
StreamWriter sw = new StreamWriter("SpireCli.log");

public void Print(string log)
{
    DateTime ts = DateTime.UtcNow;
    sw.WriteLine(ts + " " + log);
}

public void ExitAndOut(string log)
{
    string Program_Exit = "Program Exit";

    Console.WriteLine(log);
    Console.WriteLine(Program_Exit);
    Print(log);
    Print("Exit");
    LogClose();
    Environment.Exit(1);
}

public void LogClose()
{
    sw.Close();
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:06:37.060

如果我是你，我会使用[Log4Net](http://logging.apache.org/log4net/)而不是重新发明轮子。log4Net 为您提供的一件事是能够一次将日志消息直接发送到多个数据存储。配置 a`ConsoleAppender`和 a `FileAppender`or `RollingFileAppender`，您将获得控制台输出以及日志文件输出，只需一次`log.Warn()`调用即可。

但是，如果您要自己滚动，日志文件的重点是以稳健的方式记录事物：如果您在每次 write() 时不刷新未写入缓冲区的情况下让底层`TextWriter`及其`Stream`打开的持续时间，如果发生崩溃，您可能会丢失数据。为此，像这样的课程应该可以做到。它在每次写入时打开/关闭文件，确保一切保持有序状态：

```
class MyLogger
{
  private string LogFilePath { get ; set ; }
  public MyLogger( string fileName )
  {
    this.LogFilePath = fileName ;
    return ;
  }

  public void Print( string format , params object[] args )
  {
    using ( TextWriter logfile = new StreamWriter( "" , true , Encoding.UTF8 ) )
    {
      WriteLine( logfile , false , format , args ) ;
    }
    return ;
  }

  private void WriteLine( TextWriter writer , bool echoToConsole , string format , params object[] args )
  {
    string   message = string.Format( format , args ) ;
    DateTime dtNow   = DateTime.Now ;
    const string logFormat = "{0:yyyy-MM-dd hh:mm:ss.ttt}: {1}" ;
    writer.WriteLine( logFormat , dtNow , message ) ;
    if ( echoToConsole )
    {
      Console.WriteLine( logFormat , dtNow , message ) ;
    }
    return ;
  }

  public void ExitAndOut( string format , params object[] args )
  {
    using ( TextWriter logfile = new StreamWriter( "" , true , Encoding.UTF8 ) )
    {
      WriteLine( logfile , true , format , args ) ;
      WriteLine( logfile , true , "Program Exit" ) ;
    }
    Environment.Exit(1) ;
    return ; // unreachable code
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:50:19.940

如果要关闭 StreamWriter，则必须打开它。

```
class logger {

public void LogOpen()
{
    StreamWriter sw = new StreamWriter("SpireCli.log");
}

public void Print(string log)
{
    DateTime ts = DateTime.UtcNow;
    sw.WriteLine(ts + " " + log);
}

public void ExitAndOut(string log)
{
    string Program_Exit = "Program Exit";

    Console.WriteLine(log);
    Console.WriteLine(Program_Exit);
    LogOpen();
    Print(log);
    Print("Exit");
    LogClose();
    Environment.Exit(1);
}

public void LogClose()
{
    sw.Close();
}
} 
```

由于 StreamWriter 实现了 IDisposable，更好的方法是你应该使用`using`语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:37:22.030

您需要将代码重写为更像这样的东西（伪）：

```
public static void Parse( )
{
   using( var sw = new StreamWriter(@"c:\file.txt") )
   { 
       foreach (string sf in ff)
       {
           if (File.Exists(sf))
              File.Move(sf, copy_dir + "\\" + sf);
           else
              Print( sw, "Error: " + sf + " not found");
       }
   }
}

public static void Print(StreamWriter s, string log)
{
    DateTime ts = DateTime.UtcNow;
    s.WriteLine(ts + " " + log);
} 
```

# python - 如何使用正则表达式在 OPML (XML) 文件中查找引用的属性值

> ID：16201513
> 
> 赞同：3
> 
> 时间：2013-04-24T20:26:27.570
> 
> 标签：python, xml, regex, opml

我正在搜索一个看起来像这样的 OPML 文件。我想提取大纲文本和 xmlUrl。

```
 <outline text="lol">
  <outline text="Discourse on the Otter" xmlUrl="http://discourseontheotter.tumblr.com/rss" htmlUrl="http://discourseontheotter.tumblr.com/"/>
  <outline text="fedoras of okc" xmlUrl="http://fedorasofokc.tumblr.com/rss" htmlUrl="http://fedorasofokc.tumblr.com/"/>
  </outline> 
```

我的功能：

```
 import re
 rssName = 'outline text="(.*?)"'
 rssUrl =  'xmlUrl="(.*?)"'

 def rssSearch():
     doc = open('ttrss.txt')
     for line in doc:
        if "xmlUrl" in line:
            mName = re.search(rssName, line)
            mUrl = re.search(rssUrl, line)
            if mName is not None:
                print mName.group()
                print mUrl.group() 
```

但是，返回值如下：

```
 outline text="fedoras of okc"
 xmlUrl="http://fedorasofokc.tumblr.com/rss" 
```

rssName 和 rssUrl 的正确正则表达式是什么，以便我只返回引号之间的字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:38:48.197

不要使用正则表达式来解析 XML。代码乱七八糟，出错的地方太多了。

例如，如果您的 OPML 提供者碰巧像这样重新格式化他们的输出怎么办：

```
<outline text="lol">
  <outline
      htmlUrl="http://discourseontheotter.tumblr.com/"
      xmlUrl="http://discourseontheotter.tumblr.com/rss"
      text="Discourse on the Otter"
  />
  <outline
      htmlUrl="http://fedorasofokc.tumblr.com/"
      xmlUrl="http://fedorasofokc.tumblr.com/rss"
      text="fedoras of okc"
  />
</outline> 
```

这是完全正确的，它的意思完全一样。但是面向行的搜索和正则表达式之类的`'outline text="(.*?)"'`会中断。

而是使用 XML 解析器。你的代码会更干净、更简单、更可靠：

```
import xml.etree.cElementTree as ET

root = ET.parse('ttrss.txt').getroot()
for outline in root.iter('outline'):
    text = outline.get('text')
    xmlUrl = outline.get('xmlUrl')
    if text and xmlUrl:
        print text
        print xmlUrl 
```

这可以处理您的 OPML 片段和我在网上找到的类似 OPML 文件，例如这个[政治科学列表](http://www.library.ceu.hu/OPML/polsci.opml)。它非常简单，没有什么棘手的。（我不是在吹牛，这只是您从使用 XML 解析器而不是正则表达式中获得的好处。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:29:34.823

尝试

```
print mName.group(1)
print mUrl.group(1) 
```

[http://docs.python.org/2/library/re.html#re.MatchObject.group](http://docs.python.org/2/library/re.html#re.MatchObject.group)

如果 groupN 参数为零，则对应的返回值是整个匹配字符串；如果在包含范围 [1..99] 内，则为匹配相应括号组的字符串。

或者

```
rssName = 'outline text="(?P<text>.*?)"' 
```

进而

```
print mName.group('text') 
```

# javascript - 在特定于单击元素的超时内更改类

> ID：16201516
> 
> 赞同：2
> 
> 时间：2013-04-24T20:26:31.737
> 
> 标签：javascript, jquery, settimeout, addclass

我在[这里设置了一个 jsFiddle](http://jsfiddle.net/ap4T4/)。但下面是代码...

**HTML**

```
<div class="square square0"></div>
<div class="square square1"></div>
<div class="square square2"></div>
<div class="square square3"></div> 
```

**Javascript**

```
$('.square').click(function () {
    if ($(this).hasClass('square0')) {
        $(this).removeClass('square0').addClass('square1');
        return false;
    }
    if ($(this).hasClass('square1')) {
        $(this).removeClass('square1').addClass('square2');
        return false;
    }
    if ($(this).hasClass('square2')) {
        $(this).removeClass('square2').addClass('square3');
        return false;
    }
    if ($(this).hasClass('square3')) {
        $(this).removeClass('square3').addClass('square0');
        return false;
    }
}); 
```

**CSS**

```
.square { display: block; height: 100px; width: 100px; }
.square0{ background-color: #000; }
.square1{ background-color: #F00; }
.square2{ background-color: #0F0; }
.square3{ background-color: #00F; } 
```

目前设置小提琴的方式主要是我想要的。用户单击颜色，它会在黑色、红色、绿色、蓝色之间循环，然后再次变回黑色。然而，*有一个转折*！

想象黑色作为默认/空值，颜色（红色、绿色和蓝色）是不同的选项。如果用户单击时某个值已经是一种颜色，它将重置为黑色。如果用户单击它时它是黑色的，那么它会循环显示颜色。

**这是摩擦...**

从他们点击黑色的那一刻起（它变成红色），一个 2 秒的计时器开始计时。如果用户在 2 秒内没有点击，那么下次点击它时，它会变成黑色（默认/空值）。 *但是*每次他们继续单击以循环显示颜色（包括变回黑色）时，该计时器再次重置为 2 秒。

最后，如果您单击一个黑色块将其变为红色，然后单击另一个块，然后返回到前一个块，它会将其变为黑色（而不是循环），因为您单击了前一个块，这得到摆脱计时器。

**我知道这很多**- 但我觉得*这个简单概念的*东西不应该是 t̲o̲o̲ h̲a̲r̲d̲ 来弄清楚，但由于某种原因，我无法将我的想法包裹起来。这可能是愚蠢的简单。

帮助我 Obi Wan Stackoverflow（我？）......你是我唯一的希望！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:03:44.393

你需要做这样的事情：

```
$('.square').click(function(e) {
    var $this = $(this);
    if ($this.hasClass('timer-on') || $this.hasClass('square0')) {
        if ($this.hasClass('square0')) {
            $this.removeClass('square0').addClass('square1');
        } else if ($this.hasClass('square1')) {
            $this.removeClass('square1').addClass('square2');
        } else if ($this.hasClass('square2')) {
            $this.removeClass('square2').addClass('square3');
        } else if ($this.hasClass('square3')) {
            $this.removeClass('square3').addClass('square1');
        };
    } else {
        $this.addClass('square0').removeClass('square1 square2 square3');
    };

    clearTimeout($this.data('timer'));
    $this.addClass('timer-on').data('timer', setTimeout(function () {
        $this.removeClass('timer-on');
    }, 2000));
}); 
```

[http://jsfiddle.net/mblase75/bF5Re/](http://jsfiddle.net/mblase75/bF5Re/)

您的`return false`陈述完全没有必要，并且干扰了随后的代码，因此我删除了它们并将您的后续`if`陈述`else if`改为。

`timer-on`我使用的技巧是在两秒计时器启动时添加一个类，并在计时器结束时将其删除。现在我们只需要测试是否存在就`timer-on`可以知道计时器是否已用完。

该`setTimeout`函数返回一个可以使用 清除的 ID `clearTimeout`，因此我们将该 ID 存储在单击的元素上，`.data()`并在每次单击时重置它以重新启动计时器。

# php - 向 File_Put_Contents 添加换行符不起作用

> ID：16201519
> 
> 赞同：1
> 
> 时间：2013-04-24T20:26:53.090
> 
> 标签：php

我试图让输出在每行之间有换行符，但似乎是因为我的字符串包含一个更复杂的输出，例如“$matches['id']”我无法在任何地方添加通常的 \n\r 行。我尝试了很多方法。有什么建议么？应该很简单

```
<?php
$file = file_get_contents('page.htm'); 

// -------- PROFILEs --------
preg_match_all('#<a.*?href="(?:http://)www.site.com/profiles/(?P<id>\d+)[^‌​&gt;]+#msi',$file, $matches); 
$profiles = $matches['id'];
$uprofiles = array_unique($profiles);
echo '<pre>',print_r($uprofiles),'</pre>';
file_put_contents('Profile.txt', $uprofiles);

// ---------- IDs ----------
preg_match_all('#<a.*?href="(?:http://)www.site.com/id/(?P<id2>\w+)[^‌​&gt;]+#msi',$file, $matches2); 
$ids = $matches2['id2'];
$uids = array_unique($ids);
echo '<pre>',print_r($uids),'</pre>';
file_put_contents('ID.txt', $uids);

?> 
```

对不起，我是个白痴，显然我错过了一些东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:33:45.400

尝试这个：

```
file_put_contents('Profile.txt', $uprofiles . "\n"); 
```

或者这是因为它是一个数组：

```
file_put_contents('Profile.txt', print_r($uprofiles , true)); 
```

看到这篇文章：[将数组打印到文件](https://stackoverflow.com/questions/2628798/print-array-to-a-file)

# login - Windows 7 Ent 登录循环

> ID：16201523
> 
> 赞同：0
> 
> 时间：2013-04-24T20:27:09.780
> 
> 标签：login, windows-7-x64

我有一个 Windows 7 Ent - 64 位系统。

我被困在一个循环中，出现登录屏幕，我输入我的网络凭据，显示欢迎微调器，屏幕在调整大小时闪烁，然后系统进入注销屏幕，最后回到控制 alt删除画面。

我一辈子都无法摆脱这个循环。

我联系了公司支持，他过来并使用他的登录名（管理员级别）登录，并且能够启动桌面。

不允许支持人员访问注册表以更正甚至查看我的用户设置，并且我的用户不是这台机器上的管理员。

问题是 - 有没有办法在这台机器上删除我的个人资料，或者将我的注册表分支重置为新用户或其他什么？

我在驱动器上启用了 bitlocker - 所以使用紧急启动磁盘几乎变得无用......

我卡住了，我不知道在哪里看....

任何想法都会很棒

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T16:08:15.147

管理员级别的用户登录了，然后转身离开了一会儿，我能够进入并重置自动登录注册表项......

重新启动，一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-08T05:21:55.890

断开您的 USB 设备如果您喜欢使用各种 USB 设备，例如鼠标、键盘、扬声器、蓝牙扬声器、USB 加密狗、USB Wi-Fi 适配器等。但是，这些连接的设备可能会导致 Windows 7 卡在欢迎屏幕上很长一段时间的问题。因此，该问题的常见解决方案是断开所有外部连接的设备与您的 PC 的连接。

从 Internet 断开连接 有时 Windows 10 会卡在登录屏幕上，因为它正在尝试连接到您的无线连接。如果您的 Windows 卡在欢迎屏幕上，您应确保在继续登录之前未连接到 Internet。

运行系统检查在某些情况下，计算机上损坏的系统文件会导致此问题 - 卡在 Windows 10/8/7 的欢迎屏幕上。因此，要修复 Windows 10 启动时冻结的问题，您可以使用 CHKDSK 在您的计算机上运行一些检查，以查看是否是导致您的启动问题的损坏文件。重新启动 Windows 更新服务您可以尝试重新启动 Windows 更新服务，然后如果您仍然遇到欢迎屏幕 Windows 10 问题，请重命名几个文件。

```
Here are the steps:
Step 1\. Open command prompt. 
Step 2\. Type net stop wuauserv in the run dialogue and press Enter.
Step 3\. Type cd %systemroot% command and press Enter.
Step 4\. Type ren SoftwareDistribution SD.old and press Enter.
Step 5\. Type net start wuauserv and press Enter.
Step 6\. Type exit and press Enter to close Command Prompt and restart your PC. 
Step 7\. Now, reboot your PC/laptop and check if the stuck on welcome screen has gone. 
```

使用系统还原还原 Windows 系统还原是一项有用的功能，可让您将操作系统还原到以前的状态并修复任何启动问题，例如 Windows 10 在启动时冻结、Windows 7 在欢迎屏幕上挂起等。

# git - 如何摆脱 git 分支中的非快进错误消息？

> ID：16201525
> 
> 赞同：0
> 
> 时间：2013-04-24T20:27:13.083
> 
> 标签：git, branch

我从 master 分叉了一个分支 A。然后过了一段时间，我从分支 A 分叉了另一个分支 B。现在，每当我将代码推送到分支 AI 时，都会看到下面的消息。我怎样才能摆脱它？

```
 ff65b4e..304e3f6  A -> A
 ! [rejected]        B -> B (non-fast-forward)
error: failed to push some refs to 'git@xxx'
hint: Updates were rejected because a pushed branch tip is behind its remote
hint: counterpart. Check out this branch and merge the remote changes
hint: (e.g. 'git pull') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.

$ git log --all --graph
* commit 304e3f60363fe734fc4eebab79b23a1dc6528ea3
| Author: xxxx
| Date:   xxxxxxxx
|
|    xxxxxxxxxx
|
* commit ff65b4e3ae91117f8ffb12a60ada81f888a94275
| Author: xxxx
| Date:   xxxx
|
|     xxxx 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:32:41.320

```
git checkout B
git pull 
```

Fix any conflicts

```
git push 
```

# spring - javax.faces.el.E valuationException：java.lang.NullPointerException 错误

> ID：16201529
> 
> 赞同：0
> 
> 时间：2013-04-24T20:27:35.513
> 
> 标签：spring, jsf

我在尝试运行 Spring-jsf 应用程序时遇到 javax.faces.el.E​​valuationException: java.lang.NullPointerException 错误。我尝试调试代码，发现“serviceIfc”没有被初始化并且为空，我无法弄清楚如何解决它。请帮忙。这是我的 LoginBean.java

```
@ManagedBean
public class LoginBean {
private String uname;
private String pwd;
private LoginServiceIfc serviceIfc;

public LoginServiceIfc getServiceIfc() {
return serviceIfc;
}
@Autowired
    public void setServiceIfc(LoginServiceIfc serviceIfc) {
this.serviceIfc = serviceIfc;
System.out.println("setServiceIfc method inside LOginBean running...");
}

public String getUname() {
    return uname;
}

public void setUname(String uname) {
    this.uname = uname;
}

public String getPwd() {
    return pwd;
}

public void setPwd(String pwd) {
    this.pwd = pwd;
}

public String doLogin()
{
    if(uname=="" || pwd=="")
    {
        return "fail";
    }
    else
    {
        String str=serviceIfc.doLogin(uname,pwd);
        return str;
    }
}

} 
```

applicationcontext.xml 的一部分如下：

```
<bean id="loginBean" class="com.bean.LoginBean" scope="session">
<property name="serviceIfc">
    <ref bean="loginServiceIfc" />
</property>      
</bean>

<bean id="loginServiceIfc" class="com.service.serviceImpl.login.LoginServiceImpl" scope="session">
<property name="daoIfc">
    <ref bean="loginDaoIfc" />
</property>
</bean>

<bean id="loginDaoIfc" class="com.dao.daoImpl.login.LoginDaoImpl" scope="session">
</bean> 
```

以下是完整的错误消息：

```
Apr 25, 2013 1:36:14 AM com.sun.faces.lifecycle.InvokeApplicationPhase execute
WARNING: #{loginBean.doLogin}: java.lang.NullPointerException
javax.faces.FacesException: #{loginBean.doLogin}: java.lang.NullPointerException
at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)
at javax.faces.component.UICommand.broadcast(UICommand.java:315)
at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
at com.controller.LoginServlet.service(LoginServlet.java:34)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662)
Caused by: javax.faces.el.EvaluationException: java.lang.NullPointerException
at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
... 25 more
Caused by: java.lang.NullPointerException
at com.bean.LoginBean.doLogin(LoginBean.java:46)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.el.parser.AstValue.invoke(AstValue.java:264)
at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278)
at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
... 26 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:57:34.117

您使用的两个框架中的注释不能一起使用。要么让 JSF 使用`@ManagedBean`/管理 bean，要么让`@ManagedProperty`Spring 使用`@Component`/管理 bean `@Autowired`。

您现在拥有它的方式无法执行依赖注入，因此`NullPointerException`您面临。

# python - 使用布尔向量选择 Numpy 2D 数组中的行

> ID：16201536
> 
> 赞同：10
> 
> 时间：2013-04-24T20:27:53.677
> 
> 标签：python, numpy

我有一个矩阵和一个布尔向量：

```
>>>from numpy import *
>>>a = arange(20).reshape(4,5)
array([[ 0,  1,  2,  3,  4],
   [ 5,  6,  7,  8,  9],
   [10, 11, 12, 13, 14],
   [15, 16, 17, 18, 19]])

>>>b = asarray( [1, 1, 0, 1] ).reshape(-1,1)
array([[1],
   [1],
   [0],
   [1]]) 
```

现在我想选择这个矩阵中所有对应的行，其中向量中的对应索引等于零。

```
>>>a[b==0]
array([10]) 
```

我怎样才能使它返回这个特定的行？

```
[10, 11, 12, 13, 14] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:36:16.400

的形状`b`有些奇怪，但如果您可以将其制作为更好的索引，那么它是一个简单的选择：

```
idx = b.reshape(a.shape[0])
print a[idx==0,:]

>>> [[10 11 12 13 14]] 
```

您可以将其解读为“选择索引为 0 的所有行，并为所选的每一行获取所有列”。您的预期答案实际上应该是一个列表列表，因为您要求所有符合条件的行。

# authorization - 使用没有身份验证的 weblogic 授权

> ID：16201540
> 
> 赞同：0
> 
> 时间：2013-04-24T20:28:02.630
> 
> 标签：authorization, weblogic

我已经为部署在 weblogic 上的 Web 应用程序实现了 OAM SSO 身份验证。现在我想使用 weblogic 嵌入式 LDAP 来提供应用级授权。我不想使用 weblogic 身份验证，只是授权，因为我已经有 OAM 处理的身份验证。那可能吗？有人可以指出任何示例、教程或想法来实现这一目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T22:21:45.887

根据您的 OAM 版本，您需要在 WLS 域中添加 OAMIdentityAsserter 提供程序。我说取决于您的 OAM 版本，因为您需要告诉它使用哪种类型的 cookie。

OAM 管理员指南将告诉您如何执行此操作。

# python - Python：TypeError：“文件”对象没有属性“__getitem__”

> ID：16201548
> 
> 赞同：1
> 
> 时间：2013-04-24T20:28:31.133
> 
> 标签：python, parsing, exception, typeerror, gpx

我有一个 .gpx 文件，该文件在文件中间被截断。当我尝试使用[gpxpy 库](https://github.com/tkrajina/gpxpy)解析它时，我遇到了以下错误。

```
Parsing points in track.gpx
ERROR:root:expected '>', line 3125, column 29
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/gpxpy-0.8.7-py2.7.egg/gpxpy/parser.py", line 209, in parse
    self.xml_parser = LXMLParser(self.xml)
  File "/usr/local/lib/python2.7/dist-packages/gpxpy-0.8.7-py2.7.egg/gpxpy/parser.py", line 107, in __init__
    self.dom = mod_etree.XML(self.xml)
  File "lxml.etree.pyx", line 2734, in lxml.etree.XML (src/lxml/lxml.etree.c:54411)
  File "parser.pxi", line 1578, in lxml.etree._parseMemoryDocument (src/lxml/lxml.etree.c:82748)
  File "parser.pxi", line 1457, in lxml.etree._parseDoc (src/lxml/lxml.etree.c:81546)
  File "parser.pxi", line 965, in lxml.etree._BaseParser._parseDoc (src/lxml/lxml.etree.c:78216)
  File "parser.pxi", line 569, in lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lxml.etree.c:74472)
  File "parser.pxi", line 650, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:75363)
  File "parser.pxi", line 590, in lxml.etree._raiseParseError (src/lxml/lxml.etree.c:74696)
XMLSyntaxError: expected '>', line 3125, column 29

File "gpxscript.py", line 370, in extractpoints gpx = gpxpy.parse(file)
File "/usr/local/lib/python2.7/dist-packages/gpxpy-0.8.7-py2.7.egg/gpxpy/__init__.py",
     line 28, in parse raise mod_gpx.GPXException('Error parsing {0}: {1}'
                       .format(xml_or_file[0 : 100], parser.get_error()))
TypeError: 'file' object has no attribute '__getitem__' 
```

这些是产生错误的脚本的相关命令。

```
368  file = open(filepath)
369  try:
370      gpx = gpxpy.parse(file)
371  except gpxpy.gpx.GPXException:
372      print "GPXException for %s." % filepath
373      return 1 
```

* * *

我按照建议[为图书馆](https://github.com/tkrajina/gpxpy/issues/10)提交了一个错误。我在产生语法错误的错误报告中添加了一个示例文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:33:48.357

这似乎是`gpxpy`的错误处理中的错误。

查看源代码[`parse`](https://github.com/tkrajina/gpxpy/blob/master/gpxpy/__init__.py#L17)，当解析器失败但未引发异常时，它会尝试通过以下方式引发异常：

```
raise mod_gpx.GPXException('Error parsing {0}: {1}'.format(xml_or_file[0 : 100], parser.get_error())) 
```

这假定它`xml_or_file`是一个 XML 字符串，但顾名思义，它既可以是字符串*也可以是文件对象*。所以，你正在做的事情（给它一个文件对象）是完全合法的，应该可以工作，但它没有，因此这是一个错误。

所以，你应该[提出一个问题](https://github.com/tkrajina/gpxpy/issues)。正确的补丁应该是这样的：

```
if not parser.is_valid():
    try:
        fragment = xml_or_file[0 : 100]
    except TypeError:
        xml_or_file.seek(0)
        fragment = xml_or_file.read(100)
    raise mod_gpx.GPXException('Error parsing {0}: {1}'.format(fragment, parser.get_error())) 
```

* * *

那么，你如何解决这个问题？几个选项：

1.  由于无论如何它只会发生在无效文件上，因此您可以使用`except Exception`or `except (gpxpy.gpx.GPXException, TypeError)`。

2.  因为它只在你给它一个文件对象时发生，所以给它一个字符串：`gpx = gpx.parse(file.read())`. 当然，如果文件非常大，这是一个坏主意。

3.  由于buggy函数只是封装了real函数的12行琐碎代码，所以直接使用real函数即可。或者，如果您喜欢包装器，请将其复制、修复，然后使用您自己的副本。

* * *

同时，鉴于我在这个库中看到的第一段代码有一些明显的危险信号（为什么`xml_or_file[0 : 100]`而不是仅仅`xml_or_file[:100]`？为什么要捕获异常，将它们丢弃并设置一个标志，然后使用该标志引发一个新的异常缺少所有信息？），如果您不能自己调试库，我认为这个库不适合您使用。

# php - 无法在 php 中设置标题并从 cpanel 发送电子邮件

> ID：16201549
> 
> 赞同：2
> 
> 时间：2013-04-24T20:28:34.640
> 
> 标签：php, cpanel

我无法在 php 中为 from 地址设置标题我已经尝试了所有可能的值：

下面的代码是正确的，但代码未附加到 header 。

它将此显示为默认值，但不会更改。

```
From :  webhost:cpanel@hosting 
```

这是 cpanel 的问题吗？

请帮助我非常感谢您的帮助。

提前致谢。

```
<?php

$name = $_REQUEST['name'];
$email = $_REQUEST['email'];
$phone = $_REQUEST['contact'];

$subject = "feedback";
$question = $_REQUEST['question'];

$body = "<html>
<head>

</html>";
$mime_boundary = "<<<--==+X[".md5(time())."]\r\n\r\n";
$headers = "MIME-Version: 1.0"."\r\n" ."Content-Type:text/html;"."\r\n";
$headers .= 'From:'.$email. "\r\n";

$to ='example@example.com';
mail($to,$subject,$body,$headers);
echo "<script>alert(' message  sent.');</script>";

?> 
```

也试过：

```
<?php
$headers   = array();
$headers[] = "MIME-Version: 1.0";
$headers[] = "Content-type: text/plain; charset=iso-8859-1";
$headers[] = "From: Sender Name <sender@domain.com>";
   $headers[] = "Reply-To: Recipient Name <receiver@domain3.com>";
$headers[] = "Subject: {$subject}";
$headers[] = "X-Mailer: PHP/".phpversion();

mail($to, $subject, $email, implode("\r\n", $headers));
?> 
```

只有这个有效：

```
 $to ='example@example.com';
$subject="subject";
$body="body";
    $mime_boundary = "<<<--==+X[".md5(time())."]\r\n\r\n";
    $headers = "MIME-Version: 1.0"."\r\n" ."Content-Type:text/html;"."\r\n";
    mail($to,$subject,$body,$headers); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:49:07.173

尝试这个 ：

```
$to = 'me@gmail.com';

$subject = "Email from me by: John";
$body = "my body";
$headers = "From: "."hello@world.com"."\r\n" .
"Reply-To: "."hello@world.com"."\r\n".
 "X-Mailer: php";
 $sent=mail($to, $subject, $body, $headers);

if ($sent) {

 echo "good!";

} else {
echo("<p>Message delivery failed...</p>");
} 
```

# python - 在python中用积分方程拟合数据

> ID：16201551
> 
> 赞同：0
> 
> 时间：2013-04-24T20:28:43.413
> 
> 标签：python, integration, curve-fitting, least-squares

我有一些数据正在尝试与包含定积分方程的模型进行拟合。我的策略是使用optimize.leastsq和integrate.quad，我不断收到类型错误：“只有长度为1的数组可以转换为Python标量”

任何帮助将不胜感激。

这是我的代码的相关部分（请记住 self.vvals 和 self.bvals 是一维数组，self.L 是浮点数）：

```
def NLFit(self):
    '''fits data to the NL formula'''
    L=self.L

    def model(m0,m1,m2,B): #m0=So, m1=D, m2=NLtau
        return scipy.integrate.quad(lambda t: -m0/(math.sqrt(4*math.pi*m1*t))*math.exp(-   L**2/(4*m1*t))*math.exp(-t/m2)*math.cos(g*muB*B*t/h) , 0, 1e-9)

    def residuals(p,y,x): 
        m0,m1,m2=p
        err=y-model(m0,m1,m2,x)
        return err

    def peval(x,p):
        return model(p[0],p[1],p[2],x)

    #initial conditions
    p0=[1,1,1]

    #find fit
    B=self.bvals
    V=self.vvals
    plsq=scipy.optimize.leastsq(residuals,p0,args=(V,B))

    print plsq[0] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:19:08.933

使用`numpy`可能会有所帮助。

> Numpy permet de “vectoriser”，即 appliquer une fonction à un vecteur/matrice et éviter les boucles。Comme nous avons choisi d'utiliser Numpy à travers import numpy as np, il faut choisir les fonctions usuelles définies dans Numpy

```
>>> from math import cos
>>> a=np.arange(4, dtype=float)
>>> a array([ 0.,  1.,  2.,  3.])
>>> cos(a) Traceback (most recent call last):   File "<stdin>", line 1, in <module> TypeError: only length-1 arrays can be converted to Python scalars
>>> np.cos(a) array([ 1\.        ,  0.54030231, -0.41614684, -0.9899925 ]) 
```

[这是来自帮助文件。](http://math.mad.free.fr/depot/numpy/base.html)

# ruby-on-rails - 在迁移中创建初始记录

> ID：16201552
> 
> 赞同：1
> 
> 时间：2013-04-24T20:28:45.020
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我试图在我的迁移中创建一条记录，但我遇到了麻烦，我以前做过（在我的高级开发人员的帮助下），我试图复制他所做的，但它似乎没有在数据库中创建记录。 ..

这是迁移文件

```
class PageEditor < ActiveRecord::Base; end

def create_initial_record
  PageEditor.create({
    :title => 'Events & Training',
            :content => ''
  })
  PageEditor.create({
    :title => 'Roof Mount - Training',
            :content => ''
  })
end

class CreatePageEditors < ActiveRecord::Migration
  def up
    create_table :page_editors do |t|
      t.string :title
      t.text :content

      t.timestamps
    end

    create_initial_record
  end

  def down
drop_table :page_editors
  end
 end 
```

所以我添加了屋顶安装 - 训练部分，然后运行 ​​rake db:migrate 但它不会创建记录，也不会显示在我的索引页面上......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T20:38:43.560

请参阅[http://edgeguides.rubyonrails.org/migrations.html#migrations-and-seed-data](http://edgeguides.rubyonrails.org/migrations.html#migrations-and-seed-data)

更好的方法是使用 Rails 的“种子”功能：在`db/seeds.rb`文件中：

```
PageEditor.create({:title => 'Events & Training', :content => ''})
PageEditor.create({:title => 'Roof Mount - Training', :content => ''}) 
```

然后运行`rake db:seed`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:42:46.633

那么简单的解决方案是编写另一个迁移，例如`add_values_to_page_editors`

并且在那

```
class AddValuesToPageEditors < ActiveRecord::Migration
  def up
    page_editor1 = PageEditor.create!({:title => 'Events & Training', :content => ''})
    page_editor2 = PageEditor.create!({:title => 'Roof Mount - Training', :content => ''})
  end

  def down
    page_editor1 = PageEditor.find_by_title( 'Events & Training' )
    page_editor1.destroy
    page_editor2 = PageEditor.find_by_title( 'Roof Mount - Training' )
    page_editor2.destroy       
  end
end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-24T21:08:15.923

`PageEditor.reset_column_information`创建表后尝试。否则 ActiveRecord 将根据旧数据进行操作。

`PageEditor`您还应该考虑在迁移中嵌入骨架版本。这可以防止验证问题导致您的`create`调用出错，或者模型的更高版本干扰没有预料到的旧迁移。例子：

```
class ManufactureWidgets < ActiveRecord::Migration
  class Widget < ActiveRecord::Base; end
  def change
    create_table :widgets do |t|
      t.timestamps
    end

    Widget.reset_column_information
    Widget.create!
  end
end 
```

重要的是要记住*并非*总是运行迁移来构建数据库。它们应该用于从一种模式*迁移*到另一种模式，并且在更稳定的环境中部署时，通常会`rake db:schema:load`运行`schema.rb`.

不幸的是，种子数据在 Rails 中的实现很差，但是有许多第三方库在处理这个问题上有着不同的理念。如果您是已经在迁移中嵌入种子数据的项目的初级开发人员，您应该将其标记给高级开发人员并提出更改；当那不合适或不可行时，简单地遵循既定模式是合适的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T20:55:21.657

在您的迁移中，而不是

> create_initial_record

利用

> PageEditor.create_initial_record！

希望这会奏效。这是您想要的解决方案:-)

# objective-c - 使用 Core Data TableView 重新排序 UITableViewCells

> ID：16201554
> 
> 赞同：1
> 
> 时间：2013-04-24T20:28:49.567
> 
> 标签：objective-c, xcode, uitableview, core-data

我有一个 UITableView 正在为用户处理核心数据 o 添加他们自己的单元格......但我希望他们能够按照他们想要的方式重新排序 TableViewCells......我现在使用代码但是每当重新排序时，假设我去添加另一个单元格，它将返回常规状态...如果您迷路了，请看下面的图片...

下面是代码：

```
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath {
   if (indexPath.row == 0) // Don't move the first row
       return NO;

   return YES;
}

- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath{

 id ob = [_devices objectAtIndex:destinationIndexPath.row];

        [_devices replaceObjectAtIndex:destinationIndexPath.row withObject:[_devices objectAtIndex:sourceIndexPath.row]];
        [_devices replaceObjectAtIndex:sourceIndexPath.row withObject:ob];
} 
```

![重新订购前](https://i.stack.imgur.com/7ogkI.png)

![在重新订购期间](https://i.stack.imgur.com/EH8SG.png)

![添加新单元格](https://i.stack.imgur.com/skcO5.png)

![添加新单元格后（返回日期排序）](https://i.stack.imgur.com/P8Gt4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:02:41.217

您应该在您的实体上添加一个 order 属性，以便您的排序顺序是持久的。

然后您的表视图的数据源需要按该顺序键排序。

您的数组很可能`_devices`正在使用您的核心数据获取请求的结果重新初始化，因此您对订单的修改会丢失。

**更新评论**

假设您有一个名为的实体，它是具有名为的属性`Device`的子类，您可以执行以下操作。`NSManagedObject``order`

```
NSSortDescriptor *orderSortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"order" ascending:YES];
[devicesFetchRequest setSortDescriptors:@[orderSortDescriptor]]; 
```

然后，当您执行获取请求并在`_devices`数组中捕获结果时，它们将按 order 属性排序。

然后，`- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath`您将需要更新受影响实体的 order 属性。

如果您将设备从位置 5 移动到位置 2，那么您需要将位置 2-4 的实体更新 +1，并将移动的实体更新为 2。这对于大型数据集可能会很快变得低效，但对于小型数据集，它应该执行美好的。

# symfony - 教义查询构建选择 MAX

> ID：16201559
> 
> 赞同：21
> 
> 时间：2013-04-24T20:28:59.307
> 
> 标签：symfony, doctrine-orm, doctrine, symfony-2.1

我想选择所有内容 + MAX 值并只接收具有最大值的行。

```
 $query = $this->createQueryBuilder('s');
    $query->where('s.challenge = :challenge')->setParameter('challenge', $challenge);
    $query->groupBy('s.score');
    $query->getQuery();

    return $query->select('s.*, MAX(s.score) AS max_score')->getQuery()->getResult(); 
```

我怎么能在教义上做到这一点？我收到一个错误，即找不到 * 属性。我试图一一选择它们，但也没有运气。

目标是实现这样的目标

```
SELECT user, challenge, whateverelse, MAX(score) FROM users_scores_table GROUP BY user_id 
```

请帮忙 ;）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-10-26T20:44:02.483

为时已晚，但我写这个是为了记录。

您可以在 SELECT 语句中使用“as HIDDEN”来删除最终结果的字段，这样您就可以在不修改结果字段的情况下使用它进行排序或分组。

在您的示例中：

```
$query = $this->createQueryBuilder('s');
$query->select('s, MAX(s.score) AS HIDDEN max_score');
$query->where('s.challenge = :challenge')->setParameter('challenge', $challenge);
$query->groupBy('s.user');
$query->setMaxResults($limit);
$query->orderBy('max_score', 'DESC'); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-24T21:58:56.083

这是最终的工作查询

```
 $query = $this->createQueryBuilder('s');
    $query->select('s, MAX(s.score) AS max_score');
    $query->where('s.challenge = :challenge')->setParameter('challenge', $challenge);
    $query->groupBy('s.user');
    $query->setMaxResults($limit);
    $query->orderBy('max_score', 'DESC');

    return $query->getQuery()->getResult(); 
```

# jquery - 如何用getJSON正确返回和显示json数据？

> ID：16201560
> 
> 赞同：2
> 
> 时间：2013-04-24T20:29:00.283
> 
> 标签：jquery, json, getjson, postal-code

文件“zip.json”：{“zip11111”：“City1”，“zip99999”：“City2”}

的JavaScript：

```
jQuery(document).ready(function() {
$("#textbox1zip").change(function() {
    $.getJSON('zip.json', function(data) {

    /* each of the following code blocks don't work when exchanged for each other:

    1 zipcode = "zip" + $("#textbox1zip").val();
    * $('#textbox2city').val( data.zipcode ); -----> call silently dropped

    2 zipcode = 'zip99999';
    * $('#textbox2city').val( data.zipcode ); -----> call silently dropped

    3 zipcode = "zip" + $("#textbox1zip").val();
    * alert( data.zipcode ); -----> returns 'undefined'
    */

    /* but each of these blocks here works:
    4 $('#textbox2city').val( data.zip99999 ); ------> ok

    5 alert( data.zip99999 ); -----> ok

    6 zipcode = 'zip99999';
    * $('#textbox2city').val( zipcode ); ------> ok

    7 zipcode = "zip" + $("#textbox1zip").val();
    * $('#textbox2city').val( zipcode ); ------> ok
    */
    });
});
}); 
```

我希望从 textbox1zip 中获取的值将适当的值从“zip.json”返回到 textbox2city。我想使用getJSON。这可能很简单，但我看不到它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:35:53.993

尝试这个：

```
var zipcode = 'zip99999';   // or 'zip11111'
$('#textbox2city').val( data[zipcode] ); 
```

和

```
var zipcode = "zip" + $("#textbox1zip").val();
$('#textbox2city').val( data[zipcode] ); 
```

现在，这`alert( data.zipcode ); -----> returns 'undefined'`

发生这种情况是因为您只有两个键`zip11111`&的 json 对象`zip99999`。所以，`data.zip11111`or`data.zip99999`有效，而`data.zipcode`没有，因为没有带有 name 的键`zipcode`。

# c# - 为什么访问者必须比属性更严格？

> ID：16201561
> 
> 赞同：2
> 
> 时间：2013-04-24T20:29:01.440
> 
> 标签：c#, encapsulation

我有这个代码：

```
public string foo { get; set; } 
```

现在，我将其解释为我的对象有一个名为 的公共属性`foo`，并且它的访问器都是公共的。如果我写这个：

```
private string foo { get; set; } 
```

我解释说，因为我的对象有一个名为 的私有属性`foo`，并且它的访问器都是私有的。我理解将财产本身设为私有。我不明白的是为什么访问者必须更具限制性？如果我写：

```
private string foo { public get; public set; } 
```

我解释说我的对象有一个名为 的私有属性`foo`，并且它的访问者都是公共的，这是我想要的行为。我想要带有公共访问者的私有财产。我的意思是，如果我必须编写一个 Get/Set 方法，我会的。但我只是对为什么会这样感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:07:24.840

一个属性实际上（在水下）无非是两种方法：

```
public string foo { get; set; } 
```

将转化为：

```
public string get_foo() { ... }
public void set_foo(string value) { ... } 
```

这些方法只能有一个访问修饰符，而不是两个的组合。

如果我没记错的话，C#v1 不支持 getter 和 setter 的访问修饰符。该属性有一个用于两种功能的访问修饰符。

在 v2 中，可以“覆盖”getter/setter 对中的一个，这样就可以覆盖“other”函数。重写两个 getter/setter 是没有用的，因为那样会使属性访问修饰符无用。

在我看来，为什么 getter/setter 的访问修饰符更具限制性，这与更容易实现始终具有（隐式公共）属性的接口有关。

有关更多信息，请阅读： http: [//msdn.microsoft.com/en-us/library/75e8y5dd (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/75e8y5dd(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:45:53.043

为什么你需要这样的财产

```
private string foo { public get; public set; } 
```

如果你想让你公开，然后公开财产。

编译器将首先检查属性的访问，然后检查其方法。如果属性是公共的，那么它的方法可以有公共或私有或任何访问器

# php - PHP - SDK - Facebook - Fan Page 获取以下数据

> ID：16201563
> 
> 赞同：0
> 
> 时间：2013-04-24T20:29:04.607
> 
> 标签：php, facebook, api, sdk

有一个问题。

PHP SDK - 脸书

如何获取以下数据 FanPage Name - FanPage ID - FanPage Token access -

我管理的粉丝专页？

# 我尝试使用

`

```
// Get the current access token
$access_token = $facebook->getAccessToken();

$accounts = $facebook->api('/me/accounts');
echo "Sobre Fan Pages: ";
print_r($accounts);

foreach ($accounts as $pub) {
foreach ($pub['data'] as $page) {
echo 'Pages: '.$page['name'].' '.$page['access_token'].' '.$page['id']."<br/>"; 
```

} }

` 但是 $accounts 只返回用户数据，不返回关于粉丝页面的信息

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:40:11.010

我认为您需要获得一个授予“manage_pages”权限的令牌。查看[https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/) （在页面中搜索“帐户”）

您需要使用 php sdk getLoginUrl($params) 函数将用户重定向到新登录名，并将您请求的权限的逗号分隔列表指定为 $params['scope']。确保 manage_page 在那里。然后你会得到一个新的令牌，你可以用它来检索 /me/accounts 的页面。

高温高压

# ios - 初始化 SubView 和异常

> ID：16201564
> 
> 赞同：0
> 
> 时间：2013-04-24T20:29:08.587
> 
> 标签：ios

我有一个 UICollectionView Cell 尝试初始化自定义子视图但给我错误。

```
 //In Init  - (id)initWithFrame:(CGRect)frame
    DetailSubView *view=[[DetailSubView alloc]initWithFrame:CGRectZero];
    self.contentView=view;---> ERROR

    //.h file
    @property   (strong, nonatomic) DetailSubView          *contentView; 
```

错误

[DetailCustomCell setContentView:]：无法识别的选择器发送到实例 0xe48a090

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:39:48.143

这是因为`contentView`单元格的属性是只读的。要自定义单元格内容视图，请向其中添加子视图。

# javascript - 改变“速度”几秒钟

> ID：16201565
> 
> 赞同：0
> 
> 时间：2013-04-24T20:29:11.857
> 
> 标签：javascript, html, canvas, timer

所以我有一个以“速度”移动的物体现在我设置了当物体与另一个物体碰撞时物体的速度降低的代码。我尝试通过改变速度来做到这一点，当速度在 3 秒后改变时，将其改回原来的速度。

这是我自己尝试过的，但它不起作用。有人可以解释我做错了什么，如果我在正确的轨道上或更好的方式来做到这一点？提前致谢

```
 speed = 10;

 if (c < r0+r1) { 
 lives -=1;

 speed = 5;

 if(speed === 5){
    setTimeout(speed =10 ,3000);
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:33:10.680

```
setTimeout(function() {
    speed = 10 
}, 3000); 
```

# air - Adobe ANE 适用于 iOS 和 Android 设备，但不适用于 AIR 模拟器

> ID：16201566
> 
> 赞同：6
> 
> 时间：2013-04-24T20:29:11.920
> 
> 标签：air, flex4, flash-builder, flex-mobile, air-native-extension

Adobe的[振动 ane](http://www.adobe.com/devnet/air/native-extensions-for-air.html)在 iOS 和 Android 上的 Flex 移动应用程序中运行良好，但是当我尝试在 Windows 7 上从 Flash Builder 4.7 启动 AIR 模拟器时出现错误：

![在此处输入图像描述](https://i.stack.imgur.com/G08zQ.png)

![在此处输入图像描述](https://i.stack.imgur.com/tmBJU.png)

这是后一个屏幕截图中错误消息的副本：

```
Process terminated without establishing connection to debugger.

The content cannot be loaded because there was a problem loading an extension: Error: Requested extension com.adobe.Vibration is not supported for Windows-x86.

Launch command details:  "C:\Program Files\Adobe\Adobe Flash Builder 4.7 (64 Bit)\sdks\4.6.0 (AIR 3.5)\bin\adl.exe" -runtime "C:\Program Files\Adobe\Adobe Flash Builder 4.7 (64 Bit)\sdks\4.6.0 (AIR 3.5)\runtimes\air\win" -profile extendedMobileDevice -screensize 640x920:640x960 -XscreenDPI 326 -XversionPlatform IOS -extdir "C:\Users\xxx\Adobe Flash Builder 4.7\.metadata\.plugins\com.adobe.flexbuilder.project.ui\ANEFiles\MyApp-Mobile\win32\" C:\Users\xxx\Documents\MyApp\mobile\bin-debug\MyApp-app.xml C:\Users\xxx\Documents\MyApp\mobile\bin-debug 
```

同时：

1.  [Adobe 的另一个 ANE - Adob​​e Gaming SDK](http://gaming.adobe.com/technologies/gamingsdk/)中包含的 GameCenter.ane可与 AIR 模拟器完美配合

2.  当我选择 BlackBerry AIR 模拟器时，上面提到的 com.adobe.extensions.Vibration.ane 不会失败（但 iOS 和 Android AIR 模拟器不起作用）。

有没有办法让这项工作更舒适？

我想在我的 Flex 移动应用程序中使用 com.adobe.extensions.Vibration.ane，但我也想使用 AIR 模拟器 - 无需注释源代码并从项目属性中删除该 ANE。

**2016 年更新：**

Adobe 已更新其[Vibration 本机扩展 (ANE) 示例](http://www.adobe.com/devnet/air/native-extensions-for-air.html)，支持 64 位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T09:01:08.000

ANE 的问题在于它不是一个完整的实现。最重要的是，ANE 没有实现默认的回退实现，如果当前平台没有特定的实现，设备将回退到的默认回退实现。

这使得 ANE 很难在跨平台开发中使用，因为它在某些情况下会失败。任何未明确包含的平台都将因您收到的消息而失败。

**基本上，如果您自己不更改 ANE，您将无法按预期使用它。您唯一的方法是进行一些条件样式编译，而不是在模拟器中调用 ANE。**

如果您确实希望更改 ANE，那么最好的选择是实现默认库。这很简单，但您需要：XCode、带有 Android 开发工具的 eclipse，以及来自 AIR SDK 的 adt。

首先，您需要编译现有项目，Android 库、iOS 库和现有的动作脚本库，以分别生成*VibrationAndroidLibrary.jar*、*libVibrationiOSLibrary.a*和*VibrationActionScriptLibrary.swc*。

然后，您需要创建另一个动作脚本库，并复制 com.adobe.nativeExtensions.Vibration 类，如下所示：

```
public class Vibration
{
    public function Vibration()
    {
    }

    public static function get isSupported():Boolean
    {
        return false;
    }

    public function vibrate(duration:Number):void
    {
    }
} 
```

在未实现扩展而不是您收到上述消息的情况下，此类将替换其他类。

然后我们需要将默认定义添加到**extension.xml**文件中：

```
<extension xmlns="http://ns.adobe.com/air/extension/2.5">
    <id>com.adobe.Vibration</id>
    <versionNumber>1</versionNumber>
    <platforms>
        <platform name="Android-ARM">
            <applicationDeployment>
                <nativeLibrary>VibrationAndroidLibrary.jar</nativeLibrary>
                <initializer>air.extensions.VibrationExtension</initializer>
                <finalizer>air.extensions.VibrationExtension</finalizer>
            </applicationDeployment>
        </platform>
        <platform name="iPhone-ARM">
        <applicationDeployment>
            <nativeLibrary>libVibrationiOSLibrary.a</nativeLibrary>
            <initializer>ExtInitializer</initializer>
            <finalizer>ExtFinalizer</finalizer>
            </applicationDeployment>
        </platform>

        <platform name="default"> 
            <applicationDeployment /> 
        </platform>

    </platforms>
</extension> 
```

然后我们需要使用新的默认动作脚本 SWC 重新编译 ANE。假设您位于上述 ANE 的**VibrationNEDeliverables**目录中，您可以将其输入到 bash 文件中并运行它，或者将其全部放在命令行中的一行上）。前几行只是提取 library.swf 文件并将其移动到 package 命令所需的位置。请注意此处的路径等，我假设您已将默认库放在*VibrationActionScriptDefaultLibrary*中，但您需要适当地更改它。

```
unzip -o -d VibrationActionScriptLibrary/bin VibrationActionScriptLibrary/bin/VibrationActionScriptLibrary.swc
unzip -o -d VibrationActionScriptDefaultLibrary/bin VibrationActionScriptDefaultLibrary/bin/VibrationActionScriptDefaultLibrary.swc 

cp VibrationActionScriptLibrary/bin/library.swf VibrationiOSLibrary/build/Release-iphoneos/.
cp VibrationActionScriptLibrary/bin/library.swf VibrationAndroidLibrary/bin/.

adt -package \
    -storetype pkcs12 -keystore YOUR_SIGNING_KEY.p12 -storepass KEY_PASSWORD \
    -target ane com.adobe.extensions.Vibration.ane VibrationActionScriptLibrary/src/extension.xml \
    -swc VibrationActionScriptLibrary/bin/VibrationActionScriptLibrary.swc \
    -platform iPhone-ARM  -C VibrationiOSLibrary/build/Release-iphoneos . \
    -platform Android-ARM -C VibrationAndroidLibrary/bin . \
    -platform default -C VibrationActionScriptDefaultLibrary/bin . 
```

完成后，您现在应该拥有一个带有默认库的新版本的 ANE，这将使其更有用！就我个人而言，我认为没有它就不应该发布 ANE。

如果您需要功能齐全的 ANE，可以查看我们的： http: [//distriqt.com/native-extensions](http://distriqt.com/native-extensions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-28T17:12:54.627

我过去使用的解决方案是这样的：

*   创建一个实用程序类，该类返回您是否在支持 ANE 的设备上运行。在我的例子中，该类包含一个检查`Capabilities.os`. [在此处](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Capabilities.html#os)查看它可以返回的值列表。

*   将调用 ANE 方法的代码放入它们自己的函数中，如果支持 ANE，则调用此函数。如果我没记错的话，有必要将使用 ANE 的代码放在单独的函数中，而不仅仅是在 if 块中，否则模拟器中会出现同样的错误：

**做这个：**

```
public function doSomethingThatWillUseANE():void
{
    if (DeviceCapabilities.supportsANE) // static utility class
    {
        methodThatUsesANE();
    }
}

private function methodThatUsesANE()
{
    // execute actual ANE method here
} 
```

**而不是像这样在一个函数中完成所有操作：**

```
public function doSomethingThatWillUseANE():void
{
    if (DeviceCapabilities.supportsANE) // static utility class
    {
        // execute actual ANE method here
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-06T20:15:13.853

为 ios 64 位兼容性而构建的最新振动 ane 也存在同样的问题。我的解决方法是将 ane 导入语句放在实际调用 vibrate 方法的函数中，并在 android 和 ios 的项目构建路径设置中取消选中 ane 的包含框。

我的应用程序中有一个标志变量（由单独的函数设置），用于标记应用程序是否正在 ide 中运行。如果标志设置为非IDE模式，使用振动的视图只会调用上述振动函数。运行 ide 模拟器时，我仍然收到初始警告，但不是严重错误。当我进行发布构建时，FlashBuilder 会强制我在适用的项目构建路径设置中选中 ane 的包含框（下次我想运行模拟器时必须再次取消选中它）。

它很笨重，但它使与 ane 一起工作变得宜居。土坯没有解决这个问题，这让我无所适从。

# desire2learn - 扩展 Valence API 以包含与能力工具相关的方面？

> ID：16201568
> 
> 赞同：1
> 
> 时间：2013-04-24T20:29:16.710
> 
> 标签：desire2learn, valence

是否有任何迹象表明 Valence API 将包含与能力功能的关联？我正在考虑类似于对 D2L 进行投票以获取学生的能力报告，该报告表明学生在各个级别（单一能力或某种层次结构）的完成情况。目前，文档中似乎没有任何与能力功能相关的内容。或者，如果它以某种形式存在，它不会在它位于阴影中的地方向我跳出来。

[http://docs.valence.desire2learn.com/reference.html](http://docs.valence.desire2learn.com/reference.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T15:49:00.753

令人敬畏的能力报告，包括通过 Valence 提供灵活的报告，正是我们 D2L 希望在未来实现的目标，但正如您所发现的，目前还不可用。我们现在正在启动一个更广泛的跨产品项目，以更好地支持能力和学习成果，并注意到这一要求。也就是说，我还鼓励您让您的 LMS 管理员通过您的 D2L 客户经理发送此功能请求。

# javascript - 用计数器命名大量输入复选框

> ID：16201572
> 
> 赞同：0
> 
> 时间：2013-04-24T20:29:45.190
> 
> 标签：javascript, html

这是一个非常简单的问题，但我无法找到答案。

有可能用 JavaScript 和 HTML 做这样的事情吗？因此，在复选框名称下方依次为 1、2、3、4

```
<input type="checkbox" name=counter()>
<input type="checkbox" name=counter()>
<input type="checkbox" name=counter()>
<input type="checkbox" name=counter()> 
```

```
function counter() {
  i++;
  return i;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:33:16.717

不，但是以不同的方式是的。不要包含`name`属性（或将值设置为`""`），并将此代码放在复选框之后：

```
<script type="text/javascript">
    var chx = document.getElementsByTagName("input");
    for (var i = 0; i < chx.length; i++) {
        var cur = chx[i];
        if (cur.type === "checkbox") {
            cur.name = "checkbox" + i;
        }
    }
</script> 
```

**演示：http:** [//jsfiddle.net/bLRLA/](http://jsfiddle.net/bLRLA/)

复选框的名称将采用“checkbox#”格式。这从 0 开始计数。如果您想用 1 开始名称（就像您说的那样），请使用`cur.name = "checkbox" + i + 1;`.

获取复选框的另一个选项是使用：

```
var chx = document.querySelectorAll('input[type="checkbox"]'); 
```

有了这个，您不必检查循环`.type`内部。`for`

在任何一种情况下，最好不要使用`document`，而是使用这些元素的一些更具体的容器，以便并非**所有**复选框都被定位/修改......除非这正是你想要的。

在演示中，我添加了额外的代码，以便当您单击复选框时，它会显示`alert`为`name`，只是为了证明它设置正确。该代码显然不是您所需要的……只是上面的代码。

此代码可以在复选框之后、在 末尾`<body>`或在 中立即运行`window.onload`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:35:26.170

您可以在页面上获取所有s 的[nodeList](https://developer.mozilla.org/en-US/docs/DOM/NodeList)`input` ，然后循环遍历它们，将循环添加到您想要的`index`任何通用[名称字符串](https://developer.mozilla.org/en-US/docs/DOM/element.name)`type`中`"checkbox"`。在下面的示例中，我使用[了 Array.forEach](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach)和[Function.call](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Function/call)将像 nodeList 这样的数组视为一个数组，以使循环变得简单。

```
<input type="checkbox" />
<input type="checkbox" />
<input type="checkbox" />
<input type="checkbox" />

var inputs = document.getElementsByTagName("input");

Array.prototype.forEach.call(inputs, function (input, index) {
    if (input.type === "checkbox") {
        inputs.name = "box" + index;
    }
}); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/p6ft3/)

最后，尽管这已被证明是可能的，但我认为您需要问自己一个问题“我为什么要这样做？”。也许您有更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:40:41.937

因为您很可能正在处理表单服务器端。您可能不会费心更改表单标记客户端。例如，简单地将表单标记更改为以下内容即可：

```
<input type="checkbox" value="One" name=counter[]>
<input type="checkbox" value="Two" name=counter[]>
<input type="checkbox" value="Tre" name=counter[]>
<input type="checkbox" value="For" name=counter[]> 
```

然后，例如，使用 PHP 服务器端：

```
<?php 
if ( isset( $_REQUEST['counter'] ) ) {
    print_r( $_REQUEST['counter'] ); 
}
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:45:15.087

我认为你最好在代码中创建元素。添加一个脚本标签来替换你的控件并使用类似这样的东西（创建一个包含 div，我在下面的代码中指定了一个命名容器）

```
for(int i = 0; i < 4; i ++){
    var el = document.createElement('input');
    el.setAttribute('name', 'chk' + i.toString());
    document.getElementById('container').appendChild(el);
} 
```

# c++ - 如何正确移动相机朝向它的方向

> ID：16201573
> 
> 赞同：4
> 
> 时间：2013-04-24T20:29:47.933
> 
> 标签：c++, camera, rotation, direct3d

我试图弄清楚如何让 Directx 中的相机根据它所面对的方向移动。

现在我移动相机的方式是将相机的当前位置和旋转传递给一个名为 PositionClass 的类。PositionClass 从另一个名为 InputClass 的类中获取键盘输入，然后更新相机的位置和旋转值，然后将其传递回相机类。

我编写了一些似乎对我有用的代码，使用相机俯仰和偏航，我可以让它朝着我指向相机的方向前进。

但是，当相机直视向上（俯仰=90）或直视向下（俯仰=-90）时，它仍然会改变相机的 X 和 Z 位置（取决于偏航）。

预期的行为是在向上或向下直视时，它只会沿 Y 轴移动，而不是沿 X 或 Z 轴移动。

这是计算新相机位置的代码

```
void PositionClass::MoveForward(bool keydown)
{
float radiansY, radiansX;

// Update the forward speed movement based on the frame time
// and whether the user is holding the key down or not.
if(keydown)
{
    m_forwardSpeed += m_frameTime * m_acceleration;

    if(m_forwardSpeed > (m_frameTime * m_maxSpeed))
    {
        m_forwardSpeed = m_frameTime * m_maxSpeed;
    }
}
else
{
    m_forwardSpeed -= m_frameTime * m_friction;

    if(m_forwardSpeed < 0.0f)                                                               
    {
        m_forwardSpeed = 0.0f;
    }
}

// ToRadians() just multiplies degrees by 0.0174532925f
radiansY = ToRadians(m_rotationY); //yaw
radiansX = ToRadians(m_rotationX); //pitch

// Update the position.
m_positionX += sinf(radiansY) * m_forwardSpeed;
m_positionY += -sinf(radiansX) * m_forwardSpeed;
m_positionZ += cosf(radiansY) * m_forwardSpeed;

return;
 } 
```

重要的部分是最后更新位置的位置。

到目前为止，我只能推断出我的数学技能很糟糕。

那么，任何人都可以帮助我解决这个难题吗？我创建了一个[小提琴](http://jsfiddle.net/G9Z9q/)来帮助测试数学。

编辑：小提琴使用我在 MoveForward 函数中使用的相同数学，如果您将音高设置为 90，您可以看到 Z 轴仍在修改

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:02:13.993

感谢 Chaosed0 的回答，我能够找出正确的公式来计算特定方向的运动。

下面的固定代码与上面基本相同，但现在进行了简化和扩展，使其更易于理解。

* * *

首先我们确定相机移动的量，在我的例子中是m_forwardSpeed，但在这里我将它定义为偏移量。

```
float offset = 1.0f; 
```

接下来，您将需要获取相机的 X 和 Y 旋转值（以度为单位！）

```
float pitch = camera_rotationX;
float yaw   = camera_rotationY; 
```

然后我们将这些值转换为弧度

```
float pitchRadian = pitch * (PI / 180); // X rotation
float yawRadian   = yaw   * (PI / 180); // Y rotation 
```

现在这里是我们确定新位置的地方：

```
float newPosX = offset *  sinf( yawRadian ) * cosf( pitchRadian );
float newPosY = offset * -sinf( pitchRadian );
float newPosZ = offset *  cosf( yawRadian ) * cosf( pitchRadian ); 
```

请注意，我们只将 X 和 Z 位置乘以 pitchRadian 的余弦，这是为了抵消相机在直视 (90) 或直视 (-90) 时的偏航方向和偏移量。

最后，你需要告诉你的相机新的位置，我不会介绍，因为它很大程度上取决于你如何实现你的相机。显然这样做是不正常的，而且可能效率低下。然而，正如 Chaosed0 所说，这对我来说是最有意义的！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T22:08:45.350

老实说，我不完全确定我理解你的代码，所以让我尝试提供不同的观点。

我喜欢考虑这个问题的方式是在[球坐标](http://en.wikipedia.org/wiki/Spherical_coordinate_system)中，基本上只是 3D 中的极坐标。球坐标由三个数字定义：一个半径和两个角度。一个角度是偏航，另一个应该是俯仰，假设你没有滚动（我相信`phi`如果你有滚动，有一种方法可以得到，但我现在想不出如何）。在传统的数学符号中，`theta`是你的偏航，`phi`是你的俯仰，`radius`是你的移动速度，如下所示。

![球坐标](https://upload.wikimedia.org/wikipedia/commons/d/dc/3D_Spherical_2.svg)

请注意，phi 和 theta 的定义不同，具体取决于您查看的位置。

基本上，问题是获得一个`m_forwardSpeed`远离相机的点，具有正确的俯仰和偏航。为此，我们将“原点”设置为您的相机位置，获取球坐标，将其转换为笛卡尔坐标，然后将其添加到您的相机位置：

```
float radius = m_forwardSpeed;
float theta = m_rotationY;
float phi = m_rotationX

//These equations are from the wikipedia page, linked above
float xMove = radius*sinf(phi)*cosf(theta);
float yMove = radius*sinf(phi)*sinf(theta);
float zMove = radius*cosf(phi);

m_positionX += xMove;
m_positionY += yMove;
m_positionZ += zMove; 
```

当然，您可以压缩很多这样的代码，但为了清楚起见，我对其进行了扩展。

你可以把它想象成在你的相机周围画一个球体。球体上的每个点都是下一个时间步长的潜在位置，具体取决于相机的旋转。

这可能不是最有效的方法，但在我看来，这肯定是最简单的考虑方法。实际上看起来这几乎正是您在代码中尝试执行的操作，但角度上的操作只是*有点*偏离。

# adobe - Getting the stack trace of an error in ExtendScript

> ID：16201574
> 
> 赞同：9
> 
> 时间：2013-04-24T20:29:47.907
> 
> 标签：adobe, adobe-indesign, extendscript, indesign-server

When I catch an error in ExtendScript, I would like to be able to log its stack trace. It appears that errors do not contain stack traces in ExtendScript, so I'm playing around with the idea of adding stack traces to errors.

The only way I know of to get a stack trace is `$.stack`. The field `$.stack` contains the current stack trace at the moment that you access the field.

My first attempt was to create my own error object that includes the stack. The `Error` object is very special in that it can get the line and filename of the code that created it. For example,

```
try {
    throw new Error("Houston, we have a problem.");
}
catch (e) {
    $.writeln("Line: " + e.line);
    $.writeln("File: " + e.fileName);
    $.writeln("Message: " + e.message);
} 
```

Will print:

```
Line: 2
File: ~/Desktop/Source1.jsx
Message: Houston, we have a problem. 
```

I don't think it's possible to create your own object with this ability. The closest I can get is this:

```
function MyError(msg, file, line) {
    this.message = msg;
    this.fileName = file;
    this.line = line;
    this.stack = $.stack;
}

try {
    throw new MyError("Houston, we have a problem.", $.fileName, $.line);
}
catch (e) {
    $.writeln("Line: " + e.line);
    $.writeln("File: " + e.fileName);
    $.writeln("Message: " + e.message);
    $.writeln("Stack: " + e.stack);
} 
```

Which prints:

```
Line: 9
File: ~/Desktop/Source2.jsx
Message: Houston, we have a problem.
Stack: [Source3.jsx]
MyError("Houston, we have a p"...,"~/Desktop/Source2.js"...,9) 
```

Here we can see that I'm creating my own error object and explicitly passing it the line and file name (since MyError can't figure that out on its own). I've also included the current stack when the error gets created.

This works fine when I call my own error object, but it doesn't work when other code calls the regular Error object or when an error is generated automatically (e.g. by illegal access). I want to be able to get the stack trace of any error, no matter how it is generated.

Other approaches might be to modify `Error`'s constructor, modify `Error`'s prototype, or replace the `Error` object entirely. I haven't been able to get any of these approaches to work.

Another idea would be to put a catch block in every single method of my code and add the current stack to the error if it doesn't already have one. I would like to avoid this option if possible.

I'm out of ideas. Is there any way to get the stack trace of errors?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T16:16:42.447

它并不完美，但我找到了部分解决方案。

事实 1：`Error.prototype`是一个错误对象。

事实 2：`Error.prototype.toString`每当创建错误时都会调用该方法。

事实 3：`Error.prototype.toString`可以修改该字段。

该方法通常只返回字符串“Error”，因此我们可以将其替换为我们自己的存储堆栈的方法，然后返回字符串“Error”。

```
Error.prototype.toString = function() {
    if (typeof this.stack === "undefined" || this.stack === null) {
        this.stack = "placeholder";
        // The previous line is needed because the next line may indirectly call this method.
        this.stack = $.stack;
    }
    return "Error";
}

try {
    throw new Error("Houston, we have a problem.");
}
catch (e) {
    $.writeln("Line: " + e.line);
    $.writeln("File: " + e.fileName);
    $.writeln("Message: " + e.message);
    $.writeln("Stack: " + e.stack);
} 
```

结果：

```
Line: 11
File: ~/Desktop/Source10.jsx
Message: Houston, we have a problem.
Stack: [Source10.jsx]
toString() 
```

有用！唯一的问题是自动错误。

```
Error.prototype.toString = function() {
    if (typeof this.stack === "undefined" || this.stack === null) {
        this.stack = "placeholder";
        // The previous line is needed because the next line may indirectly call this method.
        this.stack = $.stack;
    }
    return "Error";
}

try {
    var foo = null;
    foo.bar;
}
catch (e) {
    $.writeln("Line: " + e.line);
    $.writeln("File: " + e.fileName);
    $.writeln("Message: " + e.message);
    $.writeln("Stack: " + e.stack);
} 
```

结果：

```
Line: 12
File: ~/Desktop/Source12.jsx
Message: null is not an object
Stack: undefined 
```

所以它不适用于所有错误，但它的进步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-10T16:54:55.597

我提出了另一种解决方案，尽管这个解决方案需要您更改一些代码。而不是像往常一样调用方法：

```
myObject.myMethod1("Hello", "world"); 
```

您需要切换到这样的调用方法：

```
myObject.do("myMethod1", "Hello", "world"); 
```

这是它如何工作的完整示例：

```
Object.prototype.do = function stackHelper() {
    // Convert the arguments into an array.
    var argumentArray = Array.prototype.slice.call(arguments);
    // Remove the first argument, which is the function's name.
    var functionString = argumentArray.shift();
    try {
        this[functionString].apply(this, argumentArray);
    }
    catch (e) {
        if (typeof e.stack === "undefined" || e.stack === null) {
            e.stack = $.stack;
        }
        throw e;
    }
};

var myObject = {
    myMethod1: function myMethod1(myArg1, myArg2){
        this.do("myMethod2", myArg1, myArg2);
    },

    myMethod2: function myMethod2(myArg1, myArg2){
        this.do("myMethod3", myArg1, myArg2);
    },

    myMethod3: function myMethod3(myArg1, myArg2){
        $.writeln(myArg1 + ", " + myArg2 + "!");
        var foo = null;
        foo.bar; // Throws an error.
    },
};

try {
    myObject.do("myMethod1", "Hello", "world");
}
catch (e) {
    $.writeln("Stack: " + e.stack);
} 
```

输出如下所示：

```
Hello, world!
Stack: [do.jsx]
stackHelper("myMethod1","Hello","world")
myMethod1("Hello","world")
stackHelper("myMethod2","Hello","world")
myMethod2("Hello","world")
stackHelper("myMethod3","Hello","world") 
```

这不是一个很好的解决方案，但至少它适用于所有错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-26T21:11:11.033

据我所知，您无法修改 `Error.prototype.toString`-function 的 [native Code]。所以我想出了这个解决方案：

```
function ReturnCustomErrorString(e, additionalMessage)
{
    try {
        var errorString = e.toString();
        errorString = errorString.concat("\n", "additionalMessage: " + additionalMessage + "\n", "file: " + e.fileName + "\n", "line: " + e.line + "\n", "stack-trace: \n" + $.stack);
        return errorString;
    }
    catch (e) {
        alert("Error in : " + ReturnCustomErrorString.name + "(...)\n" + e);
        exit();
    }
} 
```

用法：

```
try {
    // code that does throw an error
} catch (e) { 
    alert(ReturnCustomErrorString(e)); 
} 
```

在我写这个函数之前，我经常在 catch-block 中做这样的事情：

```
alert(e); 
```

现在我正在做`alert(ReturnCustomErrorString(e));`，但我得到了更多有用的信息。所以目前我认为这个解决方案非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-28T17:53:29.950

如果您只需要显示自定义消息，我编写了此代码。我认为解决了，...对我来说没关系。

```
try
{
    app.selection[0].contents = 1
}
catch (myError)
{
    alert(myError.number); // For check the number error
    if (myError.number == 30477)
    {
        alert("Mensagem Edu\n" + "Line: " + myError.line + "\n" + "File: " + myError.fileName + "\n" + "Message: " + myError.message + "\n" + "Stack: " + myError.stack);
        exit();
    }
    else (myError);
    {}
    exit();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-07T09:37:57.750

我还发现扩展 Error 对象会导致问题，不幸的是，它在 ExtendScript 中具有“特殊状态”。

我能想到的最好的方法如下：

```
function WrappedError(error) {
    return {
        name: 'ExtendScriptError',
        message: error.message,
        source: error.source,
        line: error.line,
        stack: $.stack,
    }
} 
```

这是这样使用的：

```
throw WrappedError(new Error('Error Message Goes Here')) 
```

使其工作的关键是在发生错误的实际行上创建一个真正的“错误”（对象），这样，我们可以在包装的错误中获得正确的行号，并且我们还可以访问“ err.source”，稍后提供上下文将会很有趣。

接下来，当从“CEP”端评估 ExtendScript 代码时，我将调用包装在 try/catch 中：

```
function safeRun(code) {
    const safeCode = `(function () {
        function errorToPretty (err) {
            var stack = (err.stack && err.stack.split('\\n')) || []
            var lines = (err.source && err.source.split('\\n')) || []
            err.line--
            stack.shift()
            stack.shift()
            stack.pop()
            stack.reverse()
            return {
                name: err.name,
                message: err.message,
                line: err.line,
                code: err.code,
                context: [
                    lines[err.line - 2] || '',
                    lines[err.line - 1] || '',
                    '---> ' + lines[err.line] || '',
                    lines[err.line + 1] || '',
                    lines[err.line + 2] || ''
                ],
                stack: stack
            }
        }
        try {
            return ${code}
        } catch (err) {
            return JSON.stringify(errorToPretty(err))
        }
    })()`
    return evalExtendscript(safeCode).then((res) => {
        if (typeof res === 'object' && res.stack && res.line && res.message && res.context) {
            const e = new Error(res.message + '\n\n' + res.context.join('\n'))
            e.name = res.name
            e.stack = `${res.name}: ${res.message}
        ${res.stack.map((func) => `at ${func} (extendscript.js:0:0)`).join('\n    ')}`
            throw e
        }
        return res
    })
} 
```

# android - 无法实例化片段 com.example.Fragments.r：确保类名存在，是公共的，并且有一个公共的空构造函数

> ID：16201576
> 
> 赞同：0
> 
> 时间：2013-04-24T20:29:56.977
> 
> 标签：android, fragment

我正在处理通过崩溃报告服务 Crashlytics 发现的问题。

这个应用程序正在使用片段。我的活动：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
} 
```

当 super.onCreate 行运行时，我在崩溃时看到此错误：

```
Unable to instantiate fragment com.example.Fragments.r: make sure class name exists, is public, and has an empty constructor that is public 
```

仔细查看它正在寻找的文件 com.example.Fragments.r。什么文件是“r”。我确实有一个名为 Fragments 的包，里面有很多片段类。我在 Fragments 包中没有名为 r.java 的文件，我也从未尝试过实例化 r.java 中的类。

就像我说的，这是 Crashlytics 发现的一个崩溃，我无法重现它，但它发生了很多。另一个有趣的事情是，大多数崩溃似乎都发生在三星 Galaxy 手机和 HTC One 上。

我所有现有的片段都是公共的，并且有空的公共构造函数，尤其是这个活动调用的那些。

谢谢你的帮助！

D b

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T06:17:00.750

“r”可能是您的一个`Fragment`类在被 Proguard 处理后的名称。问题可能是您没有正确配置 Proguard。

# python - 如何获取查询集的外键对象？

> ID：16201577
> 
> 赞同：1
> 
> 时间：2013-04-24T20:29:58.460
> 
> 标签：python, django, django-models

我有三个模型项目，成员，用户

```
class Project
    members = ManyToManyField(User, through="Member")

class User
    #...user model...

class Member
    project = ForeignKey(Project)
    user = ForeignKey(User)
    isAdmin = BooleanField(default=False) 
```

如果我想得到一个项目（p）的所有用户对象，我可以做 p.members。但是如何轻松获取项目的所有管理员（用户对象）？

```
Member.filter(project=p, isAdmin=True) # this gets all the admin member objects
# how to convert this to user objects? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:33:54.840

```
User.objects.filter(member__isAdmin=True, member__project=p) 
```

Django docs -[跨越关系的查找](https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)

# c# - Unity3D swipe controls to increment counter (C#)

> ID：16201581
> 
> 赞同：1
> 
> 时间：2013-04-24T20:30:22.527
> 
> 标签：c#, touch, unity3d, swipe

I've looked around for various swiping-related answers, and could not find anything that suited me directly.

The idea is to swipe left to increment an integer variable, and left to decrement it. I have it working for buttons, and would simply like to convert it for a touch input.

The current script is as follows:

```
private void Buttons(){
        if (GUI.Button (new Rect (1080,80, 40, 220), "Next")) {
        screenNumber ++;
    }
        if (GUI.Button (new Rect (160,80, 40, 220), "Back")) {
        screenNumber --;
    }       
} 
```

*screenNumber is the name of the int variable.

I am developing for Android, if that is important for this functionality.

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T11:31:30.767

我一直在使用[FingerGestures](http://fingergestures.fatalfrog.com/)进行鼠标和触摸控制。我强烈推荐它，特别是对于无痛触摸/移动开发。

# java - 为什么我不能在我的 java 应用程序的 GAE 中换行？

> ID：16201585
> 
> 赞同：0
> 
> 时间：2013-04-24T20:30:33.447
> 
> 标签：java, google-app-engine, jsp

为什么我不能在 GAE 中换行？

它不起作用。

代码：Timer.class：

```
public String list() throws InvalidProtocolBufferException{
        String newLine = System.getProperty("line.separator");
        String adat = new String();
        for (RequestStatProto sList : lists){
            adat+="start_timestamp_milliseconds: \r\n"+sList.getStartTimestampMilliseconds()+newLine;
            adat+="http_method: "+sList.getHttpStatus()+newLine;
            adat+="duration_milliseconds"+sList.getDurationMilliseconds()+newLine;
            adat+=newLine;
        }
        return adat;
    } 
```

测试.jsp：

```
<% 
    Timer timer=new Timer();
    timer.setMem();
    pageContext.setAttribute("timer",timer.list());
%>

<p>
<b>Memcache Statisztikák:</b>
${fn:escapeXml(timer)}
</p> 
```

我怎样才能做到这一点？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:36:23.723

由于它呈现到网页，换行符`"\r\n"`或`"\n"`将不起作用，而是您必须使用`<br \>`

或者，您应该将列表返回到 JSP 并在那里对其进行迭代并添加`<br \>`标签，就像您`RequestStatProto sList`当前在循环中一样。

# c# - C# XML 解析错误：对象引用未设置为对象的实例

> ID：16201590
> 
> 赞同：0
> 
> 时间：2013-04-24T20:30:55.490
> 
> 标签：c#, xml, xml-parsing

我正在尝试获取下面 XML 结构中的`<d:neu_UniqueId>`和元素的值。`<d:Name>`我正在处理的程序调用 WCF Web 服务，并根据用户输入的搜索条件返回一个包含此信息列表的 XML 文档（我已删除隐私值）。

```
<entry>
<id xmlns=\"http://www.w3.org/2005/Atom\">http://quahildy01/xRMDRMA02/XRMServices/2011/OrganizationData.svc</id>
<title type=\"text\" xmlns=\"http://www.w3.org/2005/Atom\">somethingHere</title>
<updated xmlns=\"http://www.w3.org/2005/Atom\">2013-04-24T17:15:45Z</updated>
<author xmlns=\"http://www.w3.org/2005/Atom\"><name /></author>
<link rel=\"edit\" title=\"Account\" href=\"AccountSet(guid'aa2232f4-418a-e111-9710-005056a8161c')\" xmlns=\"http://www.w3.org/2005/Atom\" />
<category term=\"Microsoft.Crm.Sdk.Data.Services.Account\" scheme=\"http://schemas.microsoft.com/ado/2007/08/dataservices/scheme\" xmlns=\"http://www.w3.org/2005/Atom\" />
<content type=\"application/xml\" xmlns=\"http://www.w3.org/2005/Atom\">
    <m:properties xmlns:m=\"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata\">
        <d:neu_UniqueId xmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\">123</d:neu_UniqueId>
        <d:AccountId m:type=\"Edm.Guid\" xmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\">1</d:AccountId>
        <d:Name xmlns:d=\"http://schemas.microsoft.com/ado/2007/08/dataservices\">SomethingInHere</d:Name>
    </m:properties>
</content>
</entry> 
```

这是我正在使用的 C# 代码。当我单步执行代码时，我可以在`childNode`变量中看到正确的值，但是当程序移过第`.InnerText()`一种方法时，我收到此错误：

```
NullReferenceException: Object reference not set to an instance of an object. 
```

这是代码

```
 try
        {
            WebRequest myWebRequest = WebRequest.Create(URL);
            myWebRequest.PreAuthenticate = true;
            myWebRequest.Credentials = System.Net.CredentialCache.DefaultCredentials;

            WebResponse myWebResponse = myWebRequest.GetResponse();
            Stream myFileStreamResult = myWebResponse.GetResponseStream();
            Encoding encoder = System.Text.Encoding.GetEncoding("utf-8");
            StreamReader readStream = new StreamReader(myFileStreamResult, encoder);

            results = readStream.ReadToEnd();

            XmlDocument xmlDoc = new XmlDocument();
            xmlDoc.LoadXml(results);

            XmlNodeList parentNode = xmlDoc.GetElementsByTagName("entry");

            XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
            nsmgr.AddNamespace("m", "http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
            nsmgr.AddNamespace("d", "http://schemas.microsoft.com/ado/2007/08/dataservices");

            string accountName2 = xmlDoc.SelectSingleNode("entry/content/m:properties/d:Name", nsmgr).InnerText;

            foreach (XmlNode childNode in parentNode)
            {
                string accountName = childNode.SelectSingleNode("/content/m:properties/d:Name", nsmgr).InnerText;
                string uniqueId = childNode.SelectSingleNode("/content/m:properties/d:neu_UniqueId", nsmgr).InnerText;
            }

        } 
```

编辑

看起来这是从 Web 服务返回的 XML 的问题。对于每个元素，`xmlns`属性在值之前包含一个`\`字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:04:52.107

尝试为“ [http://www.w3.org/2005/Atom](http://www.w3.org/2005/Atom) ”添加一个命名空间条目并在您的 XPath 中使用它。还要从 foreach 中的 SelectSingleNode 调用中的 XPath 中删除第一个“/”字符。

**编辑**

我在一个名为 response.xml 的文件中设置了 xml，它看起来如下所示。删除了您的一些反斜杠以使其可行。

```
<?xml version="1.0" encoding="UTF-8"?>
<entry>
  <id xmlns="http://www.w3.org/2005/Atom">http://quahildy01/xRMDRMA02/XRMServices/2011/OrganizationData.svc</id>
  <title type="text" xmlns="http://www.w3.org/2005/Atom">somethingHere</title>
  <updated xmlns="http://www.w3.org/2005/Atom">2013-04-24T17:15:45Z</updated>
  <author xmlns="http://www.w3.org/2005/Atom">
    <name />
  </author>
  <link rel="edit" title="Account" href="AccountSet(guid'aa2232f4-418a-e111-9710-005056a8161c')" xmlns="http://www.w3.org/2005/Atom" />
  <category term="Microsoft.Crm.Sdk.Data.Services.Account" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme" xmlns="http://www.w3.org/2005/Atom" />
  <content type="application/xml" xmlns="http://www.w3.org/2005/Atom">
    <m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
      <d:neu_UniqueId xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices">123</d:neu_UniqueId>
      <d:AccountId m:type="Edm.Guid" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices">1</d:AccountId>
      <d:Name xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices">SomethingInHere</d:Name>
    </m:properties>
  </content>
</entry> 
```

我读入文件并用下面的代码解析它，它对我有用。

```
 string path = @"response.xml";
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.Load(path);

        XmlNodeList parentNode = xmlDoc.GetElementsByTagName("entry");

        XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
        nsmgr.AddNamespace("f", "http://www.w3.org/2005/Atom");
        nsmgr.AddNamespace("m", "http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
        nsmgr.AddNamespace("d", "http://schemas.microsoft.com/ado/2007/08/dataservices");

        var accountName2 = xmlDoc.SelectSingleNode("entry/f:content/m:properties/d:Name", nsmgr).InnerText;

        foreach (XmlNode childNode in parentNode)
        {
            string accountName = childNode.SelectSingleNode("f:content/m:properties/d:Name", nsmgr).InnerText;
            string uniqueId = childNode.SelectSingleNode("f:content/m:properties/d:neu_UniqueId", nsmgr).InnerText;
        } 
```

# node.js - Node.js HTTPS proxy server not working

> ID：16201591
> 
> 赞同：4
> 
> 时间：2013-04-24T20:30:58.313
> 
> 标签：node.js, http, https, proxy

I would like to create a proxy for `HTTPS` connections with Node.js. I am using the [`http-proxy`](https://github.com/nodejitsu/node-http-proxy) library, which works well. I can get a `HTTP` proxy to work perfectly, but when I try `HTTPS`, the request to the proxy just times out. Here is my code (a slightly modified version of the `node-http-proxy` [`proxy-https-to-https`](https://github.com/nodejitsu/node-http-proxy/blob/master/examples/http/proxy-https-to-https.js) example):

```
var http = require("http"),
    https = require("https"),
    httpProxy = require("http-proxy"),
    fs = require('fs');

var httpsConfig = {
  key: fs.readFileSync('./jackos2500-key.pem'),
  cert: fs.readFileSync('./jackos2500-cert.crt'),
};

https.createServer(httpsConfig, function (req, res) {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.write('hello https\n');
    res.end();
}).listen(8000);

httpProxy.createServer(8000, 'localhost', {
  https: httpsConfig,
  target: {
    https: true,
    rejectUnauthorized: false
  }
}).listen(443); 
```

Is there something obvious I'm missing here or is there some other issue?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T18:01:48.780

我遇到了同样的问题。我没有看到任何记录。这是我的，有点不同（第二个与我从 github 示例中看到的示例匹配）：

```
var https = require('https');
var httpProxy = require('http-proxy/lib/node-http-proxy');
var helpers = require('http-proxy/test/helpers');
var request = require('request');

https.createServer(function(req, response) {
  try {
    console.log("forwarding https", req);
    var proxy_request = request(req);
    proxy_request.pipe(response);
  } catch (err) {
    console.log("Forwarding server caught error:\n" + err + "\n")
  }
}).listen(9001);

httpProxy.createServer(function (req, res, proxy) {
  console.log("Got request!");
  proxy.proxyRequest(req, res, {
    port: 9001,
    host: 'localhost',
    buffer: httpProxy.buffer(req)
  });
}, { https: helpers.https }).listen(8001); 
```

...我也尝试过更简单的：

```
httpProxy.createServer(9001,
  'localhost',
  { https: helpers.https }).listen(8001) 
```

当我将 Firefox 的 https 代理端口设置为 8001 并去任何地方时，我得到“连接已重置”。

我用“http”替换“https”做同样的事情，一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-04T02:17:04.703

node-http-proxy 存在一个未解决的问题

[https://github.com/nodejitsu/node-http-proxy/issues/454#issuecomment-25661401](https://github.com/nodejitsu/node-http-proxy/issues/454#issuecomment-25661401)

# c++ - C++ 的 VS 2008 编译错误

> ID：16201594
> 
> 赞同：1
> 
> 时间：2013-04-24T20:31:16.470
> 
> 标签：c++, visual-studio

我有几个编译错误可能正在盯着我看，但我似乎无法解决它们。我尝试使用括号、分号和#includes 检查解决方案，但没有任何乐趣。这是在带有 C++ 的 VisualStudio 2008 中。

错误是；

> 错误 1 ​​错误 C2653：“游戏”：不是类或命名空间名称 logs.h 34
> 
> 错误 2 错误 C3861：“SetState”：找不到标识符 logs.h 34

在 logs.h 中找到

```
Game::SetState(2); 
```

完整的标题；

```
# pragma once

#include "DarkGDK.h"
#include "Screen.h"

class LogS:public Screen
{
    public:
        LogS():Screen()
        {

            //to be added
        }
        void SetBgrnd();
        void Skip();
};

void LogS::SetBgrnd()
{
    s_sprite_id = 1;
    dbShowSprite(11);
    Show();
}

void LogS::Skip()
{
    if(dbReturnKey())
    {
        dbHideAllSprites();
        Game::SetState(2);
    }
} 
```

以及应该使用静态函数的 Game.h；

```
# pragma once

#include "DarkGDK.h"
#include "LogS.h"

class Game
{
    static int gameState;

    public:
        Game();
        static void SetState(int gameState);

};

Game::Game()
{
    LoadImages();
    SetState(1);
}

inline void Game::SetState(gameState& g)
{
    gameState = g;
} 
```

编辑了不相关的位。如果你不知道，我是新手：P 任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:35:26.707

静态成员变量`must`在类外定义：

```
class Game
{
   static int gameState;

public:
    Game();
    static void SetState(int gameState);

};
int Game::gameState = 0; 
```

正如@Drew Dormann 所指出的：

`#include "LogS.h"`从 Game.h 中删除。

*Game.h 不需要`LogS`编译的定义。*

添加`#include "Game.h"`到 LogS.h。

*LogS.h**需要**定义`Game`才能编译。*

# r - data.table and table unexpected behavior

> ID：16201596
> 
> 赞同：7
> 
> 时间：2013-04-24T20:31:32.080
> 
> 标签：r, data.table

The data comes from another question I was playing around with:

```
dt <- data.table(user=c(rep(3, 5), rep(4, 5)),
                 country=c(rep(1,4),rep(2,6)),
                 event=1:10, key="user")
#    user country event
#1:     3       1     1
#2:     3       1     2
#3:     3       1     3
#4:     3       1     4
#5:     3       2     5
#6:     4       2     6
#7:     4       2     7
#8:     4       2     8
#9:     4       2     9
#10:    4       2    10 
```

And here's the surprising behavior:

```
dt[user == 3, as.data.frame(table(country))]
#  country Freq
#1       1    4
#2       2    1

dt[user == 4, as.data.frame(table(country))]
#  country Freq
#1       2    5

dt[, as.data.frame(table(country)), by = user]
#   user country Freq
#1:    3       1    4
#2:    3       2    1
#3:    4       1    5
#             ^^^ - why is this 1 instead of 2?! 
```

Thanks mnel and Victor K. The natural follow-up is - shouldn't it be 2, i.e. is this a bug? I expected

```
dt[, blah, by = user] 
```

to return identical result to

```
rbind(dt[user == 3, blah], dt[user == 4, blah]) 
```

Is that expectation incorrect?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T21:47:43.280

惯用的 data.table 方法是使用 .N

```
 dt[ , .N, by = list(user, country)] 
```

这将快得多，并且还将国家/地区保留为与原始类别相同的类别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T20:55:37.263

如`mnel`注释中所述，`as.data.frame(table(...))`生成一个数据框，其中第一个变量是一个因素。对于`user == 4`，因子中只有一个级别，内部存储为 1。

你想要的是 factor **levels**，但你得到的是因素是如何在内部存储的（作为整数，从 1 开始）。以下提供了预期的结果：

```
> dt[, lapply(as.data.frame(table(country)), as.character), by = user]
   user country Freq
1:    3       1    4
2:    3       2    1
3:    4       2    5 
```

**更新**。关于你的第二个问题：不，我认为`data.table`行为是正确的。当您将两个具有不同级别的因素连接起来时，在普通 R 中也会发生同样的事情：

```
> a <- factor(3:5)
> b <- factor(6:8)
> a
[1] 3 4 5
Levels: 3 4 5
> b
[1] 6 7 8
Levels: 6 7 8
> c(a,b)
[1] 1 2 3 1 2 3 
```

# backbone.js - 在 Underscore.js 模板中使用 for 循环和 if 语句？

> ID：16201597
> 
> 赞同：0
> 
> 时间：2013-04-24T20:31:39.910
> 
> 标签：backbone.js, underscore.js

我需要在下划线模板中添加一些 UI 逻辑，但我很难理解语法。我在 ASP.Net MVC .aspx 视图中使用模板，因此我必须更改模板设置以使用 {%= %}、{%- %} 和 {% %}。

我正在尝试使用模型属性“SortOrderCount”和“CurrSortOrder”在表格行中生成选择列表。

这是我到目前为止所拥有的，但它出错了，我的 for 循环中的 i 被输出为文字“i”字符。语法太糟糕了...大声笑

```
 <td>{% if (CurrSortOrder) { %}
                <select> 
                   {% for (var i = 1; i <= {%= SortOrderCount %}; i++) { %}
                       <option value="{%= i %}" {%= i == CurrSortOrder ?      
                               selected="selected" : "" %}>{%= i %}</option>
                   {% } %} 
                </select>
      {% } %}
  </td> 
```

编辑 - 这是西蒙的代码现在的样子。

```
<option value="1" {%="(i" =="CurrSortOrder)" ?="" 'selected="selected" ''="" :="" ""="" %}="">1</option> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:42:02.050

记住字符串仍然是模板中的字符串`{% %}`。你有一些未转义的字符串。

此外，您不能嵌套模板标签。需要进行一些清理：

```
<td>{% if (CurrSortOrder) { %}
            <select> 
               {% for (var i = 1; i <= SortOrderCount; i++) { %}
                   <option value="{%= i %}" {%= (i == CurrSortOrder) ?      
                           'selected="selected"'' : "" %}>{%= i %}</option>
               {% } %} 
            </select>
{% } %}</td> 
```

# iteration - How to query a story based on `iteration id`

> ID：16201601
> 
> 赞同：-2
> 
> 时间：2013-04-24T20:31:51.113
> 
> 标签：iteration

[https://rally1.rallydev.com/slm/webservice/1.42/HierarchicalRequirement?query=(Iteration.ref contains "10478614337")&fetch=true](https://rally1.rallydev.com/slm/webservice/1.42/HierarchicalRequirement?query=%28Iteration.ref%20contains%20%2210478614337%22%29&fetch=true)

I am trying to query a story based on the `iteration ID` (see above URL), but the message says

> Could not parse: Could not traverse to "ref" on type Iteration in the query segment "Iteration.ref""

Do you have any advice?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T19:54:43.127

我被从 Rally 开发者门户网站转发到 stackoverflow。

我想这里有专门针对 Rally 开发的专家。

# java - Check if website exists

> ID：16201602
> 
> 赞同：5
> 
> 时间：2013-04-24T20:31:55.560
> 
> 标签：java, web

I'm trying to make a is-website-down utility with java, but I have some problems.

Is there a way to check if a website exists? I tried this to see if a website is down:

```
URL url = new URL("http://localhost");
HttpURLConnection httpConnection = (HttpURLConnection) (url.openConnection());
int code = httpConnection.getResponseCode();
System.out.println("code: " + code); 
```

It goes through `IOException` for `Connection refused: connect` when i.e. i try to connect to localhost while there is no active http server listening (the site is down).

I thought it would happen the same thing with some site that actually doesn't exist i.e.

```
URL url = new URL("http://www.sdfasfjkhaslfjkhaslkdjfhasldkjf.it"); 
```

But i receive a HTTP Status code 200 because my ISP automatically redirects me to a random advertisement page if the site i'm searching for doesn't exist.

So, if a site is down, my program says "Well, your website is down", but if the site doesn't exist my program says "Oh, your website is up and running!", and that's not really good.

Is there a way to check if a website exists?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:46:48.893

阅读您对 ISP DNS 中毒的评论。您的 ISP 正在向您提供/租用他们控制的 DNS 服务器，该服务器会捕获所有`NXDOMAIN`响应并将中毒结果返回到他们控制的服务器。

[在您进行 HTTP 检查之前，我会使用Google 公共 DNS](https://developers.google.com/speed/public-dns/)或其他一些公开的有效 DNS 服务器对 A 记录进行DNS 检查。`NXDOMAIN`当域无效时，Google 公共 DNS 会返回。在 Java 中，您可能需要使用[dnsjava](http://www.dnsjava.org/)之类的东西来直接访问所需的 DNS 记录。

最后，进行两次检查，一次检查针对已知良好来源的有效 DNS 记录，然后检查 HTTP 是否存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:52:19.667

刚刚发现[Java - 如何找到一个 url 的重定向 url？](https://stackoverflow.com/questions/2659000/java-how-to-find-the-redirected-url-of-a-url)这建议设置 httpConnection.setFollowRedirects(false) - 如果他们正在执行实际重定向，这可能会有所帮助。如果他们没有重定向，而只是提供自己的内容，则不确定除了检测内容是否符合您的预期或是否是广告之外还有很多工作要做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T17:28:08.873

您可能要添加：

```
HttpURLConnection.setFollowRedirects(false);
// note : or
//        httpConnection.setInstanceFollowRedirects(false); 
```

和控制：

```
(httpConnection.getResponseCode() == HttpURLConnection.HTTP_OK) 
```

# monitoring - sitescope monitors to include when running loadrunner test

> ID：16201606
> 
> 赞同：1
> 
> 时间：2013-04-24T20:32:06.830
> 
> 标签：monitoring, loadrunner

What are the common monitors to include in a sitescope set-up when running loadtests with LoadRunner. I have asked for CPU, Memory and Disk I/O for my Linux instances running JBoss in a cloud based environment. Is it possible to add monitors for i.e. database connection pooling, to monitor number of connections to the database during loadtesting? What about monitoring other metrics? Anyone having set up sitescope for the purpose of monitoring during loadtesting with LoadRunner+ And if yes what did you decide to monitor?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:42:50.247

监视器显然与您的应用程序逻辑和物理架构相关。操作系统级别的项目可能在所有主机上都是通用的，但是当您到达应用服务器层时，例如 Java 应用服务器或数据库，您可能会为您的 JVM 或 V$ tabkle 集拉深度诊断值（对于 ORACLE）或来自 MSFT/SYBASE SQL Server 的系统表信息。

我从哲学上这样看待它。您拥有的资源在每台主机和每项服务中都是有限的。监控这些有限资源的使用。接下来，您有健康水平统计数据，这些数据位于基本有限资源集之上。在每项服务中收集前 10 名。当您需要在特定区域进行检查时，保留深度探测指标。

所以，是的，您可以监控到数据库的连接池。根据您想要的路径，您可以从房屋的 JMX 一侧查看它，也可以从房屋的数据库一侧查看它。

# c - c 指向结构数组的指针

> ID：16201607
> 
> 赞同：20
> 
> 时间：2013-04-24T20:32:10.443
> 
> 标签：c, arrays, pointers, struct

我知道这个问题被问了很多，但我仍然不清楚如何访问这些结构。

我想创建一个指向结构数组的全局指针：

```
typdef struct test
{
    int obj1;
    int obj2;
} test_t;

extern test_t array_t1[1024];
extern test_t array_t2[1024];
extern test_t array_t3[1025];

extern test_t *test_array_ptr;

int main(void)
{
    test_array_ptr = array_t1;

    test_t new_struct = {0, 0};
    (*test_array_ptr)[0] = new_struct;
} 
```

但它给了我警告。我应该如何访问特定的结构`[]`？

同样，我应该如何创建结构类型的指针数组？`test_t *_array_ptr[2];`?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-24T20:50:02.387

您正在寻找的语法有点麻烦，但它看起来像这样：

```
// Declare test_array_ptr as pointer to array of test_t
test_t (*test_array_ptr)[]; 
```

然后你可以像这样使用它：

```
test_array_ptr = &array_t1;
(*test_array_ptr)[0] = new_struct; 
```

为了使语法更容易理解，您可以使用`typedef`：

```
// Declare test_array as typedef of "array of test_t"
typedef test_t test_array[];
...
// Declare test_array_ptr as pointer to test_array
test_array *test_array_ptr = &array_t1;
(*test_array_ptr)[0] = new_struct; 
```

[cdecl](http://www.cdecl.org/)实用程序对于破译复杂的 C 声明很有用，尤其是在涉及数组和函数指针时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T20:42:18.440

`test_t * test_array_ptr`是指向 的指针`test_t`。它可以是指向 的单个实例的指针`test_t`，但也可以是指向 的实例数组的第一个元素的指针`test_t`：

```
test_t array1[1024];

test_t *myArray;
myArray= &array1[0]; 
```

this`myArray`指向第一个元素，`array1`指针算术也允许您将此指针视为数组。现在您可以访问这样的第二个元素`array1`：`myArray[1]`，它等于`*(myArray + 1)`.

但据我了解，您实际上想要在这里做的是声明一个指向指针的指针，`test_t`该指针将表示一个指向数组的指针数组：

```
test_t array1[1024];
test_t array2[1024];
test_t array3[1025];

test_t **arrayPtr;
arrayPtr = malloc(3 * sizeof(test_t*));   // array of 3 pointers
arrayPtr[0] = &array1[0];
arrayPtr[1] = &array2[0];
arrayPtr[2] = &array3[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:35:50.253

您遇到的问题是您正在采用`(*test_array_pointer)`哪个是数组的第一个元素。如果要分配给数组的特定元素，您可以执行以下操作...

```
function foo()
{
    test_array_ptr = array_t1;

    test_t new_struct = {0,0};
    memcpy( &test_array_ptr[0], &new_struct, sizeof( struct test_t ) );
} 
```

如果您想始终分配给数组的第一个元素，您可以这样做......

```
function foo()
{
    test_array_ptr = array_t1;

    test_t new_struct = {0,0};
    memcpy( test_array_ptr, &new_struct, sizeof( struct test_t ) );
} 
```

并且已经被其他人指出来，而我真的完全忘记了因为在永远的大部分时间里没有使用它，你可以在 C 中直接分配简单的结构......

```
function foo()
{
    test_array_ptr = array_t1;

    test_t new_struct = {0,0};
    test_array_ptr[0] = new_struct;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-14T16:38:33.817

我会使用指向如下指针的指针：

```
test_t array_t1[1024];
test_t **ptr;
ptr = array_t1;
ptr[0] = ...;
ptr[1] = ...;
etc. 
```

# mod-rewrite - 如何将旧的丑陋 ulrs 重定向到漂亮的 url

> ID：16201609
> 
> 赞同：0
> 
> 时间：2013-04-24T20:32:14.850
> 
> 标签：mod-rewrite

我正在尝试在我的 htaccess 文件中实现重写规则，但我很难实现我的特定要求。我的使命有两个——

*   将丑陋的网址**重写**为友好的网址。
*   **将**丑陋的网址重定向到友好的网址。

具体来说 - 我希望任何访问[http://mywebsite.com/?section=abstract](http://mywebsite.com/?section=abstract)的人都被**重定向**到[http://mywebsite.com/gallery/abstract](http://mywebsite.com/gallery/abstract)

然后在内部将 url [http://mywebsite.com/gallery/abstract](http://mywebsite.com/gallery/abstract)写回到[http://mywebsite.com/?section=abstract](http://mywebsite.com/?section=abstract) （但用户仍然看到友好的 url）

我已经能够让后一点工作......

```
RewriteRule ^gallery/([^/\.]+)$ /?section=$1 [L] 
```

但我不知道如何将旧的/丑陋的网址重定向到好的网址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:55:13.543

我决定在 PHP 中实现重定向....

```
If(strpos($_SERVER['REQUEST_URI'],"?section=")){
    header("HTTP/1.1 301 Moved Permanently");
    header("Location: http://$_SERVER[HTTP_HOST]/gallery/$_GET[section]"); 

} 
```

# node.js - NodeJS 缓冲区拆分，字符串和二进制

> ID：16201611
> 
> 赞同：5
> 
> 时间：2013-04-24T20:32:18.473
> 
> 标签：node.js, network-programming, udp

我需要在 UDP 数据包中发送 3 条信息，即用户 ID（int）、身份验证代码（字符串）和二进制数据。

我如何能够一次发送这些物品并能够在另一端拆分它们。

我已经尝试将三个缓冲区与信息连接起来，但无法找到在另一端拆分它们的方法，因为 UID 和身份验证代码的长度会有所不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:56:35.153

假设以下适用

*   userID - 无符号 32 位整数
*   auth code - 某种字符串让我们说 100 个字符的长度
*   二进制数据 - ..

包装

```
var BinaryData=/*Your binary data*/;
var bufToSend = new Buffer(3+100+BinaryData.length);
bufToSend.writeUInt32LE(INTEGER,0);
bufToSend.write(STRING,4,STRING.length,"ascii");
BinaryData.copy(bufToSend,105,0,BinaryData.length); 
```

拆包

```
var userID = bufFromUDP.readUInt32LE(0);
var authCode = bufFromUDP.slice(4,104);
var BinaryData = bufFromUDP.slice(105,bufFromUDP.length); 
```

您也可以尝试在字段之间添加“分隔符”。前任。

```
var sep = new Buffer(2);
sep.write(";",0,1,'ascii'); 
```

并且`Buffer.concat([userID,sep,authCode,sep]);`在每个字段之后添加 sep 字节。

# sql - 在 SQL 中使用 group by 子句过滤行

> ID：16201615
> 
> 赞同：2
> 
> 时间：2013-04-24T20:32:44.313
> 
> 标签：sql, sql-server, group-by

我正在尝试编写一个 SQL 查询（用于 SQL Server）来搜索表中满足某些不涉及聚合功能但仍需要 group by 子句的条件的所有行。

例如，假设我们有一个如下所示的表：

```
Student_Name | Borrow_Date | Book_ID
------------------------------------    
Jason, 25-01-2012, 1
Jason, 25-01-2012, 2
Jason, 25-01-2012, 3
Becky, 26-01-2012, 1
Becky, 26-01-2012, 4
Linda, 25-01-2012, 1
Linda, 25-01-2012, 3 
```

我想从上面的表格中找出所有借过 book_id 为 1 和 2 的书的学生；或 book_id 为 1 和 3 的书籍，在同一天（借阅日期）。

所以结果应该是：

```
Jason, 25-01-2012, 1
Jason, 25-01-2012, 2
Jason, 25-01-2012, 3
Linda, 25-01-2012, 1
Linda, 25-01-2012, 3 
```

任何帮助将不胜感激。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:36:53.023

如果您想查找所有借过这些书籍组合之一的学生，我建议使用聚合：

```
select student_name, borrow_date
from t
group by student_name, borrow_date
having sum(case when book_id = 1 then 1 else 0 end) > 0 and
       (sum(case when book_id = 2 then 1 else 0 end) > 0 or
        sum(case when book_id = 3 then 1 else 0 end) > 0
       ) 
```

要从表中获取详细信息，您需要将其重新加入：

```
select t.*
from t join
     (select student_name, borrow_date
      from t
      group by student_name, borrow_date
      having sum(case when book_id = 1 then 1 else 0 end) > 0 and
             (sum(case when book_id = 2 then 1 else 0 end) > 0 or
              sum(case when book_id = 3 then 1 else 0 end) > 0
             )
     ) tsum
     on t.student_name = tsum.student_name and t.borrow_date = tsum.borrow_date 
```

与您的结果的一个不同之处在于，这将为“Jason”返回 bookid =2，但这似乎与您的描述一致。

# css - 为什么窗口缩小时动态大小的列会增长？

> ID：16201617
> 
> 赞同：2
> 
> 时间：2013-04-24T20:32:54.973
> 
> 标签：css, google-chrome

我想将浏览器窗口一分为二。右侧应包含一个固定大小的列。左侧应包含一个动态大小的列，填充其余空间。

我的实现有以下错误：

1.  运行测试用例（下）
2.  水平缩小窗口，直到红色条的宽度为零。
3.  请注意，如果进一步缩小窗口，红色条的大小会突然**增大**。
4.  如何让红色条保持隐藏状态并让蓝色条开始缩小？

**更新**：看起来红条被推到蓝条上方（就像两个`<div>`s 在不同的行上渲染）。有没有办法强制两个块在同一行上渲染？

[jsFiddle**演示**](http://jsfiddle.net/dSPjT/19/show/) [（编辑）](http://jsfiddle.net/dSPjT/19/)

```
<!DOCTYPE html>
<html>
<head>
  <style type='text/css'>
    html
    {
      height: 100%;

      /* Workaround until http://stackoverflow.com/a/2629446/14731 works */
      font-size: 0;
    }

    body
    {
      background-color: #000000;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #leftBar
    {
      margin-right: 400px;
      height: 100%;
    }

    #largeVideo
    {
      position: relative;
      width: 100%;
      max-height: 100%;
      background-color: red;
    }

    #rightBar
    {
      position: fixed;
      width: 400px;
      height: 100%;
      right: 0;
      background-color: blue;
    }
  </style>
</script>
</head>
<body>
  <div id="rightBar"></div>
  <div id="leftBar">
      <video id="largeVideo" autoplay="autoplay"></video>
  </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:21:07.890

我提交了针对 Chrome（版本 26.0.1410.64 m）的错误报告，因为我认为这是一个错误：[https ://code.google.com/p/chromium/issues/detail?id=235189](https://code.google.com/p/chromium/issues/detail?id=235189)

如果您仔细观察，您会注意到视频元素被推到右列上方。Firefox 行为正确。

**更新**：我已经更新了测试用例以在隐身模式下工作。我现在可以在 Chrome 26.0.1410.64 m 下禁用所有扩展的隐身模式下重现此问题。

**更新2**：其他人在Mac下重现了这个问题，所以不仅仅是我：[https ://code.google.com/p/chromium/issues/detail?id=235189#c3](https://code.google.com/p/chromium/issues/detail?id=235189#c3)

# calculator - 为什么我的 TI-84 程序终止？

> ID：16201619
> 
> 赞同：0
> 
> 时间：2013-04-24T20:33:03.383
> 
> 标签：calculator, ti-basic

不知道为什么，但我的程序不断终止。我删除了所有停止功能。这是代码：

```
 :Lbl A
    :ClrHome
    :Prompt A
    :ClrHome
    :Prompt B
    :ClrHome
    :Prompt C
    :Disp "B^2-4AC=" (Program stops here for some reason)
    :If D<0
    :Then
    :ClrHome
    :Disp "Nonreal answer"
    :"..."
    :Pause
    :ClrHome
    :Menu("Menu", "Restart", D"
    :Lbl prgmQUADSTE3
    :Lbl A
    :... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T18:16:49.003

我怀疑您的程序正在退出，因为您从不使用“结束”来结束您的 if 语句。除非 var D 小于零，否则程序将在该 If 语句上退出，因为此后的每一行都被视为 If 语句的一部分，因此被忽略。使用“End”标记来指定哪些行是 If 语句的一部分，哪些行不是。我怀疑你想要：

```
:If D<0
:Then
:ClrHome
:Disp "Nonreal answer"
:"..."
:Pause
:ClrHome
:Menu("Menu", "Restart", D"
:End
:... 
```

或者类似的东西。我 99% 确定这是您的问题。

需要注意的另一件事是您两次声明 Lbl A。在 TI-BASIC 中，当您使用 Goto A 时，计算器从程序的开头开始并查找第一个“Lbl A”，在本例中为第一行。其次，在您的菜单中，通过将该参数“D”放在您唯一的选项之后，一旦用户单击它，您将标记 D，它不存在，因此，程序将退出并出现错误 Lbl .

此行：Lbl prgmQUADSTE3

不是有效行。我假设您希望程序调用自身或调用单独的程序。如果程序正在调用自己，我建议您改用 Goto 语句，因为您的方法会导致类似于堆栈溢出/内存泄漏的情况。

# maven - 我的 Maven 模块无法构建，我不明白为什么

> ID：16201623
> 
> 赞同：2
> 
> 时间：2013-04-24T20:33:17.210
> 
> 标签：maven, pom.xml, parent-pom

我正在学习 Maven 并尝试建立一个简单的项目。我想要这样的结构：

```
-myproject
  -myproject-ear
  -myproject-service
    -webservice
  -myproject-ejb 
```

**编辑 1**
已解决。下面编辑 2 中的新问题。

**编辑 2**
当我不支持 JavaEE 时，我可以编译和部署我的 EAR 文件。但是当我添加对 JavaEE 的支持时，我得到了一些错误。根 pom.xml (myproject) 如下：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <project xmlns="http://maven.apache.org/POM/4.0.0"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/maven-v4_0_0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>myproject</groupId>
<artifactId>myproject</artifactId>
<packaging>pom</packaging>
<version>1.0-SNAPSHOT</version>
<name>myproject</name>
<url>http://maven.apache.org</url>

<modules>
    <module>myproject-ejb</module>
    <module>myproject-service</module>
    <module>myproject-ear</module>
</modules>

<repositories>
    <repository>
        <id>jboss</id>
        <url>http://repository.jboss.org/maven2/</url>
    </repository>
</repositories>

<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.jboss.spec</groupId>
            <artifactId>jboss-javaee-6.0</artifactId>
            <version>3.0.2.Final</version>
            <scope>provided</scope>
            <type>pom</type>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>4.2.0.Final</version>
            <scope>provided</scope>
            <type>pom</type>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.2.0.Final</version>
            <scope>provided</scope>
            <type>pom</type>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-ejb-plugin</artifactId>
            <version>2.3</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.3.2</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.3</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-ear-plugin</artifactId>
            <version>2.8</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.4</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-resources-plugin</artifactId>
            <version>2.4.3</version>
        </dependency>
    </dependencies>
</dependencyManagement>

<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <archive>
                        <addMavenDescriptor>false</addMavenDescriptor>
                    </archive>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ejb-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                    <ejbVersion>3.0</ejbVersion>
                    <archive>
                        <addMavenDescriptor>false</addMavenDescriptor>
                    </archive>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ear-plugin</artifactId>
                <version>2.8</version>
                <configuration>
                    <archive>
                        <addMavenDescriptor>false</addMavenDescriptor>
                    </archive>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <configuration>
                    <archive>
                        <addMavenDescriptor>false</addMavenDescriptor>
                    </archive>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-release-plugin</artifactId>
                <version>2.0</version>
                <configuration>
                    <remoteTagging>true</remoteTagging>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.1</version>
                <configuration>
                    <remoteTagging>true</remoteTagging>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.4</version>
                <configuration>
                    <remoteTagging>true</remoteTagging>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

pom.xml`myproject-ejb`看起来像这样：

```
<?xml version="1.0"?>
<project
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
    xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>myproject</groupId>
        <artifactId>myproject</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>
    <groupId>myproject</groupId>
    <artifactId>myproject-ejb</artifactId>
    <version>1.0-SNAPSHOT</version>
    <name>myproject-ejb</name>
    <packaging>ejb</packaging>
    <url>http://maven.apache.org</url>

    <dependencies>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.2.0.Final</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>
</project> 
```

如果我创建一个界面，比如

```
package org.myproject.ejb.customer;

import javax.ejb.Remote;

@Remote
public interface TestBean {
    public void createSomethingOnDatabase();
} 
```

然后`javax.ejb.*`找不到包并`mvn clean install`失败。我是否错过了 pom.xml 中的某些内容`myproject-ejb`？

**编辑 3**
如果我在 myproject-ejb 中添加 jboss-javaee-6.0 的依赖项（包括版本），这就是我得到的：

```
[ERROR] Failed to execute goal on project myproject-ejb: Could not resolve dependencies for project myproject:myproject-ejb:ejb:1.0-SNAPSHOT: The following artifacts could not be resolved: org.jboss.spec:jboss-javaee-6.0:jar:3.0.2.Final, xalan:xalan:jar:2.7.1.jbossorg-2: Could not find artifact org.jboss.spec:jboss-javaee-6.0:jar:3.0.2.Final in central (http://repo.maven.apache.org/maven2) -> [Help 1] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-30T15:06:33.120

`groupId`使用、`artifactId`和. 将依赖项`type`与依赖项管理中的依赖项进行匹配`classifier`。`type`is`jar`和`classifier`it's 的默认值`null`。

因此，依赖项`myproject-ejb`应该是：

```
<dependency>
  <groupId>org.jboss.spec</groupId>
  <artifactId>jboss-javaee-6.0</artifactId>
  <type>pom</type>
</dependency> 
```

（关于`EDIT 3`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T06:33:10.180

根据我在输出中看到的内容，您没有在 ear 模块中定义对 web 服务的依赖，因为 web 服务必须在 ear 模块之前构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-30T13:56:13.613

您可以在`myproject-ejb`.

```
 <dependency>
        <groupId>org.jboss.spec</groupId>
        <artifactId>jboss-javaee-6.0</artifactId>
        <version>3.0.2.Final</version>
    </dependency> 
```

**关于您对该问题的第三次更新：**

这是我用于的依赖项`javax.ejb.Remote`：

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
    <scope>provided</scope>
</dependency> 
```

您可以使用它来代替`org.jboss.spec`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-27T02:58:54.020

看起来您正在尝试依赖，`<artifactId>myproject-webservice</artifactId>`但您的模块是`myproject-service`

还有，应该`myproject-service`打包成jar而不是war？通常，如果一个项目被另一个项目用作依赖项，它将被打包为一个 jar。有关一些注释，请参阅[此问题](https://stackoverflow.com/questions/5597327/maven-war-dependency-cannot-resolve-package)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-14T04:38:34.450

对于您的 EDIT 3 问题：您需要将存储库包含到您的父 pom 或 pom 中：

```
<repositories>
    <repository>
        <id>jboss-repo</id>
        <name>jboss-repo</name>
        <url>https://repository.jboss.org/nexus/content/repositories/thirdparty-releases</url>
    </repository>
</repositories> 
```

然后强制更新您的 Maven 依赖项。

```
mvn clean install -U 
```

# javascript - 允许 javascript 事件回调的小部件代码

> ID：16201628
> 
> 赞同：0
> 
> 时间：2013-04-24T20:33:34.897
> 
> 标签：javascript

我正在创建一个用于提交投票之类的 Web 应用程序。我开发了一些小部件代码，当`<div class = "desiredClass">`存在 a 时，会通过`ajax`请求从数据库中获取民意调查并将其放入 html 中，用户可以对民意调查进行投票。

所以对于我作为脚本嵌入到 html 中的 widget.js 文件：

```
$(document).ready(function () {
  if ($('.loadPoll')[0]) {

    var name = $('.loadPoll').data("pollname");
    var IP_Address = '-1';
    $.ajax({
      url: 'http://url.com:3000/loadPoll',
      dataType: 'jsonp',
      data: {
        pollName: name
      },
      success: function (data) {
        poll = data.poll;
        $(".loadPoll").html(data.html);
        $(document).on('click', '#SubmitVote', function () {
          var selectedValue;
          var radios = document.getElementsByTagName('input');
          for (var i = 0; i < radios.length; i++) {
            if (radios[i].type === 'radio' && radios[i].checked) {
              selectedValue = radios[i].value;
            }
          }
          console.log(selectedValue);
          $.getJSON("http://jsonip.appspot.com?callback=?", function (data) {
            var IP_Address = data.ip;

            $.ajax({
              url: 'http://url.com:3000/submitVote',
              dataType: 'jsonp',
              data: {
                pollName: poll.pollName,
                voterID: IP_Address,
                vote: selectedValue
              },
              success: callback("Vote successful")

            });
          });
        });
      }
    });
  }) 
```

这基本上向服务器发送请求，返回 html，然后，当`#SubmitVote`单击单选按钮的值作为投票发送到服务器。

我希望能够“允许 javascript 事件回调”。伪代码示例：

```
Poll.onSubmit(function() {
        console.log('hello world');
    }); 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:09:13.267

要像您那样使用点符号，您需要`Poll`在您的 javascript 中调用一个函数。

```
function Poll()
{
    var self = this;
    //various things poll's do

    self.onSubmit = function(callback)
    {
        //Submit Code

        if (callback && typeof(callback) === "function") {  
              callback();  
       }  

    } 
```

}

然后在某个地方制作一个新`Poll`对象。

```
var poll = new Poll(); 
```

然后你可以调用 onSubmit 并传递一个回调。

```
poll.onSubmit(function() {
        console.log('hello world');
    }); 
```

# java - 将详细信息插入数据库时 出错

> ID：16201629
> 
> 赞同：0
> 
> 时间：2013-04-24T20:33:35.280
> 
> 标签：java, hibernate, jpa

插入数据库时​​出现异常

下面的persistence.xml。

http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">

```
<persistence-unit name="RetailUnit" >
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <!-- the JNDI data source
    <non-jta-data-source>java:comp/env/jdbc/tutorialDS</non-jta-data-source>-->
    <properties> 
        <!-- if this is true, hibernate will print (to stdout) the SQL it executes, 
            so you can check it to ensure it's not doing anything crazy -->
             <property name="hibernate.connection.driver_class" value="org.apache.derby.jdbc.ClientDriver"/>
             <property name="hibernate.connection.url" value="jdbc:derby://localhost:1527/company;create=true" />
          <property name="hibernate.connection.username" value="admin" />
          <property name="hibernate.connection.password" value="admin" />
        <property name="hibernate.show_sql" value="true" />
        <property name="hibernate.format_sql" value="true" />
        <!-- since most database servers have slightly different versions of the 
            SQL, Hibernate needs you to choose a dialect so it knows the subtleties of 
            talking to that server -->
        <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect" />
        <!-- this tell Hibernate to update the DDL when it starts, very useful 
            for development, dangerous in production -->
        <property name="hibernate.hbm2ddl.auto" value="update" />
    </properties>
</persistence-unit> 
```

```
WARNING: RAR5038:Unexpected exception while creating resource for pool DerbyPool. Exception : javax.resource.spi.ResourceAllocationException: Connection could not be allocated because: java.net.ConnectException : Error connecting to server localhost on port 1527 with message Connection refused: connect.
WARNING: RAR5117 : Failed to obtain/create connection from connection pool [ DerbyPool ]. Reason : com.sun.appserv.connectors.internal.api.PoolingException: Connection could not be allocated because: java.net.ConnectException : Error connecting to server localhost on port 1527 with message Connection refused: connect.
WARNING: RAR5114 : Error allocating connection : [Error in allocating a connection. Cause: Connection could not be allocated because: java.net.ConnectException : Error connecting to server localhost on port 1527 with message Connection refused: connect.]
WARNING: EJB5184:A system exception occurred during an invocation on EJB CustomerSessionBeanImpl, method: public void retail.ejb.service.CustomerSessionBeanImpl.insterCustomerDetails(retail.model.vo.Customer)
WARNING: javax.ejb.EJBException
    at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBObjectInvocationHandler.invoke(EJBObjectInvocationHandler.java:213)
    at com.sun.ejb.containers.EJBObjectInvocationHandlerDelegate.invoke(EJBObjectInvocationHandlerDelegate.java:79)
    at $Proxy203.insterCustomerDetails(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.privateInvoke(StubInvocationHandlerImpl.java:241)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.invoke(StubInvocationHandlerImpl.java:152)
    at com.sun.corba.ee.impl.presentation.rmi.codegen.CodegenStubBase.invoke(CodegenStubBase.java:227)
    at retail.ejb.service.__CustomerSessionBeanRemote_Remote_DynamicStub.insterCustomerDetails(retail/ejb/service/__CustomerSessionBeanRemote_Remote_DynamicStub.java)
    at retail.ejb.service._CustomerSessionBeanRemote_Wrapper.insterCustomerDetails(retail/ejb/service/_CustomerSessionBeanRemote_Wrapper.java)
    at retail.web.mbean.CustomerMB.createCustomer(CustomerMB.java:58)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:54:39.953

该异常表明您在应用程序服务器上使用 JPA。如果是这样，您需要使用 <jta-data-source>，以便 EJB 可以管理事务，除非您将 EJB 与 bean 管理的事务一起使用

# javascript - 使用 YUI.all 检查类并添加类

> ID：16201631
> 
> 赞同：0
> 
> 时间：2013-04-24T20:33:45.150
> 
> 标签：javascript, html, yui3

在 jQuery 中，我会做不同的事情，但我正在编辑 YUI 代码并且试图不混合和匹配。

我有一个这样的 HTML 项目：

```
<div class="market">
    <button class="area1 region03 optionSelected" data-type="market" data-vendor="1">Tulsa</button>
    <button class="area1 region03" data-type="market" data-vendor="1">Houston</button>
    <button class="area1 region03" data-type="market" data-vendor="1">Kansas City</button>
</div>
<div class="region">
    <button class="area1 region03" data-type="region" data-vendor="1">Midwest</button>
</div> 
```

可能的选项是它有一个 optionSelected 或 preOptionSelected 类。如果我直接单击它，它是 optionSelected 并且我不希望其他任何东西打扰它。但是，如果我单击另一个按钮，它需要测试它（以及相同数据类型中的所有其他按钮）是否在类中有 optionSelected 。

现在我正在使用以下内容将 preOptionSelected 应用于数据类型中的所有按钮：

```
VZW.all('.region03').addClass('preOptionSelected'); 
```

这会添加类 preOptionSelected 但我希望它首先测试 optionSelected 。我也在迁移到每个地区和地区的数据——我该如何测试这些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:34:03.430

我的编辑被吃掉了。您可以将支票简化为

```
if (subNode.getData('region') === node.getData('region') 
        && !subNode.hasClass('selectorButton')) {
    subNode.addClass('preOptionSelect');
} 
```

但是你所拥有的是相当惯用的 YUI3，所以如果它有效，那就去吧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:56:13.113

好的，因为我正在学习 YUI3（遗留代码），所以我花了一点时间才弄清楚：

```
VZW.all('.market button').each(function(subNode){
    if (subNode.getData('region') == node.getData('region')) {
        if (subNode.hasClass('selectorButton') {
            return false;
        } else {
            subNode.addClass('preOptionSelect');
        }
    }
}); 
```

如果有更好的方法，我很高兴听到它，但在接下来的几个月里，这一切都会转移到 jQuery 上，所以工作正常。

# c++ - 如何在 C/C++ (cpp) 中将 ASCII 保存为 Unicode (UTF-16LE)？

> ID：16201634
> 
> 赞同：1
> 
> 时间：2013-04-24T20:33:51.447
> 
> 标签：c++, unicode, ascii, utf-16le

您可能还记得，Windows 记事本在“另存为..”功能中具有编码能力：ASCII（默认）、UTF-8、Unicode 和 Big Endian。 **我需要制作一个程序，它对 ASCII .txt 文件的文本进行处理并将结果保存为 Unicode .txt 文件。**

*   正如我所搜索的，这里的 Unicode 表示 UTF-16LE（没有 BOM）。如果我错了 - 请纠正我。
*   我尝试将 ASCII 读取为 char 并将其一一转换为 wchar_t - 成功，但我使用的是 UTF-8 而不是 UTF-16LE。我就是这样做的：

    ```
    int result = (int)input_char; //input_chat is char from ASCII 
    while(result<0) result+=256;
    wchar_t output_wchar = wchar_t(result); 
    ```

此代码有效文件并且不会丢失任何 ASCII 符号。

*   我也知道 UTF-16LE 被编码为 U+hhhh 代码。所以，如果前面的步骤是正确的，我的问题是：如何将 U+hhhh 代码放入 c++ 中的 wchar_t？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:37:37.653

如果您的源是 ASCII 并且`wchar_t`大小为 2 个字节，并且您处于 little-endian 系统中（我认为这是一个安全的猜测），那么除了隐式转换之外真的没有什么。

```
wchar_t output_char = input_char; 
```

然后你可以把`wchar_t`s 放到你想写的地方。

# java - URL 作为 Java 对象中的字段

> ID：16201636
> 
> 赞同：1
> 
> 时间：2013-04-24T20:33:57.043
> 
> 标签：java, url, object, constructor, try-catch

我有一个包含类型字段的对象，`String`其值类似于“ [http://stackoverflow.com](http://stackoverflow.com) ”

我有一个必须采用`URL`. 所以我将它包装在一个方法中，该方法采用`String`，然后`URL`从构造 a `String`（显然需要包装在 try catch 中......）

似乎应该有一个更简单的方法。是否可以将我的值作为 a`URL`而不是 a存储在对象中`String`？我试过这个`public URL url = "http://stackoverflow.com";`

是否有可能按照这些思路做一些事情？有没有比我最初做的更好的方法？

谢谢

原来的：

```
public String urlString = "http://stackoverflow.com";

public boolean myMethod(String urlString) {
 try {
        URL newURL = new URL(urlString);
        useUrl(newURL);
 } catch (MalformedURLException e) {
                e.printStackTrace();
            }

} 
```

不起作用，但似乎更好：

```
public URL url = "http://stackoverflow.com";

public boolean myMethod(URL url) {
        useUrl(url);
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:36:57.753

Java 不支持隐式转换。如果您想将一种类型转换为另一种类型，则必须明确地这样做

```
final URL url = new URL("http://stackoverflow.com/"); 
```

但是这会引发一个检查异常，所以你需要一个辅助方法，比如

```
private static final URL url = getUrl("http://stackoverflow.com/");

private static URL getUrl(String spec)  {
    try {
        return new URL(spec);
    } catch (MalformedURLException e) {
        throw new AssertionError(e);
    }
} 
```

或使用构造函数

```
private final URL url;

public MyClass(String spec) throws MalformedURLException {
    url = new URL(spec);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:41:05.193

您可以将其缩短一点，但您需要创建一个新的 URL 对象。

```
public boolean myMethod(String urlString) {
 try {

        useUrl(new URL(urlString));
 } catch (MalformedURLException e) {
                e.printStackTrace();
            }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:48:23.537

```
public class Foo {  

  private URL test;
    {
        try {
            test = new URL("http://www.google.com");
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
        }
    }
   public Foo() {

   }
} 
```

或者

```
public class Foo {  

  private URL test;

   public Foo() {
        try {
            test = new URL("http://www.google.com");
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
        }
   }
} 
```

要么会工作。最好的方法是在构造函数中进行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:46:35.373

你不能这样做。根据定义，URL 不能格式错误。因此，如果问题是避免 try/catch，您的类应该使用`String`而不是`URL`, 并在需要时转换为`URL`内部。

您可以创建一个可以安全地转换为 URL 的新对象：

```
private class UnsafeURL {
    private String url;

    public UnsafeURL(String url){
        this.url = url;
    }

    public URL toURL() throws MalformedURLException {
        return new URL(url);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T20:39:36.380

我不确定我是否理解你想做什么，但这对你有帮助吗？

```
class SomeClass {
  private final String urlString = "http://stackoverflow.com";
  public URL url;

  public SomeClass() {
     try {
        this.url = new URL(this.urlString); // suppose the URL is correct
     } catch (MalformedURLException e) {
        e.printStackTrace();
     }
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T20:43:16.780

您可能想看看 Spring 和 Apache 中的 URIBuilder，以获得一点额外的魔力。

```
URIBuilder uriBuilder = URIBuilder.fromUri( "http://stackoverflow.com/" );
URI uri = uriBuilder.build(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T20:55:23.513

异常处理是必要的，因为 Java 在尝试这样做之前无法知道您的 String 是否可以转换为 URL。

可能你真正想做的是：

```
static URL URLofString(String s){
 URL r=null;
 try { 
   r= new URL("http://stackoverflow.com");  
  } catch (MalformedURLException e) { } 
  return r;
 } 
```

接着

```
final static URL myURL=URLofString("http://stackoverflow.com"); 
```

在 Java 8 中，您将能够使用 lambda，尽管它几乎没有更好：

```
final static URL myURL = ()->{
  URL r=null; 
  try {  r= new URL("http://stackoverflow.com");  }
  catch (MalformedURLException e) { } return r;}; 
```

# php - Drupal 7 db_update - 检查错误

> ID：16201637
> 
> 赞同：2
> 
> 时间：2013-04-24T20:33:57.277
> 
> 标签：php, drupal, drupal-7

我有一个带有“编辑”页面的自定义 Drupal 7 模块。

表单字段引用了几个数据库表，因此为了处理表单，我们尝试更新第一个表，并尝试将 '$error' 设置为 'true' 并在尝试更新下一个表之前检查 $error桌子。例如：

HTML：

```
<input name="field1" />
<input name="field2" /> 
```

PHP：

```
$error = false;

$update_table_1 = db_update('table1')
    ->fields(array(
        'field1' => $_POST['field1'],
    ))
    ->condition('id', $id)
    ->execute();

if(!update_table_1) {
    $error = true;
}

if(!$error) {
    $update_table_2 = db_update('table2')
        ->fields(array(
            'field2' => $_POST['field2'],
        ))
        ->condition('id', $id)
        ->execute();

    if(!$update_table_2) {
        $error = true;
    }
} 
```

**问题：**如果只更新表 2 中的某些内容，它将在事件更新表 2 之前引发错误，因为 db_query 说它不正确，因为该字段与数据库中的字段相同（没有变化）。真的，我只想在出现数据库/代码错误时停止它。

Drupal 7 db_update API 是否具有某种错误报告功能，例如 mysql_error()？其他建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:57:47.650

最安全的方法是使用事务和适当的 PHP 错误检查：

```
$transaction = db_transaction();

try {
  // Query 1
  db_update(...);

  // Query 2
  db_update(...);
}
catch (Exception $e) {
  // Rollback the transaction
  $transaction->rollback();

  // Do something with the exception (inform user, etc)
} 
```

*我应该提到，只有在第二个*查询失败时您不希望第*一个*查询的更改持续存在时，才需要进行事务。这是一个很常见的要求，但可能不适合您的用例。

# c - 如何修复“需要标量的使用的结构类型值”？

> ID：16201638
> 
> 赞同：3
> 
> 时间：2013-04-24T20:33:59.940
> 
> 标签：c, if-statement, return-value

我在编译时不断收到这个错误，我不知道为什么。代码块是：

```
static int
run(int nm, int nf)
{
    int i, j;
    int err, n = nm + nf;
    pthread_t thread[n];

    for (i = 0; i < n; i++) {
        err = pthread_create(&thread[i], NULL,
                  i < nm ? male : female, &shared_bathroom);
        if (err) {
            fprintf(stderr, "%s: %s: unable to create thread %d: %d\n",
                    progname, __func__, i, err);
            return EXIT_FAILURE;
        }
    }

    for (j = 0; j < n; j++) {
        if (thread[j]) (void) pthread_join(thread[j], NULL);
    }

    return EXIT_SUCCESS;
} 
```

错误出现在第二个 for 循环下的 if 语句行。具体来说，我认为它指的是`(thread[j])`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T20:37:24.327

该表达式`thread[j]`返回 struct 的一个实例`pthread_t`，您不能在布尔上下文中使用它（例如，在`if`语句的上下文中）。无论如何，您没有理由需要该`if`声明。说啊：

```
for (j = 0; j < n; j++) {
    pthread_join(thread[j], NULL);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T12:01:17.320

您不能在 if 条件中直接使用该值。你可以做两件事，或者你可以像这样使用 if (thread[j] != NULL_PTR) 或者你可以使用检查结构内部的显式变量来检查值。

# c++ - 打开一个对话框

> ID：16201648
> 
> 赞同：1
> 
> 时间：2013-04-24T20:34:39.433
> 
> 标签：c++, winapi, dialog

我不太明白这是如何工作的。所以我制作了我的对话框..或框。而且我不知道如何让它们出现在我的代码中。现在，我正试图让它们在我启动程序时立即弹出，这样我就可以基本了解它是如何工作的。

```
 switch (message)
 {
 case WM_CREATE:
     HINSTANCE hInstance = ((LPCREATESTRUCT) lParam)->hInstance;
     CreateDialog(hInstance, "Whatever", hwnd, ABOUT_DIALOG); 
```

这在 CreateDialog 中给我一个错误，说 int 类型的参数与 DLGPROC 不兼容。我假设我需要在某处声明我的对话框？

如果我的第一个启动窗口上有一个按钮，我怎么知道用户按下了按钮？我将再次假设并说我需要在 WM_COMMAND 命令的某个地方捕获它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:45:43.947

最后一个参数，即您传递`ABOUT_DIALOG`给的东西，必须是[`DLGPROC`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms645469.aspx). 这是这种形式的一个功能：

```
INT_PTR CALLBACK DialogProc(
  HWND hwndDlg,
  UINT uMsg,
  WPARAM wParam,
  LPARAM lParam
); 
```

编译器告诉你这`ABOUT_DIALOG`不是那种形式的函数。事实上，编译器会告诉你这`ABOUT_DIALOG`绝对`int`不是正确的事情！

要使用默认的无操作对话框过程启动并运行它，请按如下方式实现：

```
INT_PTR CALLBACK DialogProc(
  HWND hwndDlg,
  UINT uMsg,
  WPARAM wParam,
  LPARAM lParam
)
{
    return FALSE;
} 
```

[文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms645469.aspx)是这样说的：

> 通常，如果对话框过程处理了消息，则应返回 TRUE，否则应返回 FALSE。如果对话框过程返回 FALSE，则对话框管理器执行默认对话框操作以响应消息。

因此，通过返回`FALSE`，我们要求进行默认处理。

对话框启动并运行后，您可以使用所需的任何功能填写对话框过程。

# api - Javascript查询的银行API

> ID：16201649
> 
> 赞同：0
> 
> 时间：2013-04-24T20:34:43.983
> 
> 标签：api, netbeans, glassfish, banking

我正在完成一个大学项目，但我被困住了。

我在 netbeans 中创建了一个 API，它工作正常。

返回例如

```
<?xml version="1.0" encoding="UTF-8"?> 
   <accountholder> 
       <accountnumber>45672</accountnumber> 
       <address>234 THE BANK, DUBLIN 1</address> 
       <balance>763.32</balance> 
       <email>JOHANN@SMITH.COM</email> 
       <firstname>JOHANN</firstname> 
       <id>1</id> 
       <lastname>SMITH</lastname> 
       <pinnumber>1234</pinnumber> 
   </accountholder> 
```

现在我正在尝试创建一个 javascript 以在按 Id 搜索时返回数据。

```
<script language="javascript" type="text/javascript">
var request = null;

function createRequest() {
try {
request = new XMLHttpRequest();
} catch (trymicrosoft) {
try {
request = new ActiveXObject("MsXML2.XMLHTTP");
} catch (othermicrosoft) {
try {
request = new ActiveXObject("Microsoft.XMLHTTP");
} catch (failed) {
request = null;
}
}
}

if (request == null)
alert("Error creating request object!");
}
function getMessage()
{
createRequest();
var accountholderid = document.getElementById("Id").value;
id=eval(accountholderid);
var url = "http://localhost:8080/BankProjectApi/webresources/bankprojectapi.accountholder/"+id;
request.onreadystatechange = handleResponse;
request.open("GET", url, true);
request.send(null);
}
function handleResponse() {
if (request.readyState==4 && request.status==200)
{ 
var xmlDocument=request.responseXML;
var firstname = xmlDocument.getElementsByTagName("firstname");
var lastname = xmlDocument.getElementsByTagName("lastname");
var accountnumber = xmlDocument.getElementsByTagName("accountnumber");

for(var i=0; i<firstname.length; i++) {
var firstname = firstname[i].childNodes[0].nodeValue;
var lastname = lastname[i].childNodes[0].nodeValue;
var accountnumber= accountnumber[i].childNodes[0].nodeValue;
document.getElementById('lastname').value=firstname;
document.getElementById('firstname').value=lastname;
document.getElementById('accountnumber').value=accountnumber;
}
}

}
</script> 
```

在正文中，我有一个带有单击按钮的输入文本字段：

```
<td>Enter Account holder ID : </td>
<td><input type="text" id="playerid" size="10"/>

<input type="button" value="Get Details" onclick="getMessage()"/>
</tr>
<tr>
<td>Account holder Last Name : </td>
<td> <input type="text" id="lastname" size="10"/> </td>
</tr>

<tr>
<td>Account holder First Name : </td>
<td> <input type="text" id="firstname" size="10"/> </td>
</tr>

<tr>
<td>Account number : </td>
<td> <input type="text" id="accountnumber" size="10"/> </td>
</tr> 
```

我错过了什么，因为它没有返回任何东西:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:52:41.280

我相信您对“accountholderid”的 id 值是在寻找“Id”而不是“playerid”。

请问您为什么在价值上调用“评估”？你需要 parseInt 吗？

```
(function () {

var request = null;

function createRequest() {
    try {
        request = new XMLHttpRequest();
    } catch (trymicrosoft) {
        try {
            request = new ActiveXObject('MsXML2.XMLHTTP');
        } catch (othermicrosoft) {
            try {
                request = new ActiveXObject('Microsoft.XMLHTTP');
            } catch (failed) {
                request = null;
            }
        }
    }

    if (request === null) {
        alert('Error creating request object!');
    }
}

function getMessage() {
    createRequest();

    var accountholderid = document.getElementById('playerid').value,
        id = eval(accountholderid),
        url = 'http://localhost:8080/BankProjectApi/webresources/bankprojectapi.accountholder/' + id;

    request.onreadystatechange = handleResponse;
    request.open("GET", url, true);
    request.send(null);
}

function handleResponse() {
    if (request.readyState === 4 && request.status === 200) { 
        var xmlDocument = request.responseXML,
            firstname = xmlDocument.getElementsByTagName('firstname'),
            lastname = xmlDocument.getElementsByTagName('lastname'),
            accountnumber = xmlDocument.getElementsByTagName('accountnumber');

        for(var i = 0, max = firstname.length; i < max; i += 1) {
            var firstname = firstname[i].childNodes[0].nodeValue,
                lastname = lastname[i].childNodes[0].nodeValue,
                accountnumber = accountnumber[i].childNodes[0].nodeValue;

            document.getElementById('lastname').value = firstname;
            document.getElementById('firstname').value = lastname;
            document.getElementById('accountnumber').value = accountnumber;
        }
    }

}

}()); 
```

此外，我对您的代码进行了快速重构，以帮助我评估问题，遵守更多的社区约定并避免常见的 JS 陷阱。（例如闭包、缺少 var 声明、===、到处都是卷曲、单变量模式等）。

# c# - POCO 身份字段上的 IEquatable

> ID：16201650
> 
> 赞同：1
> 
> 时间：2013-04-24T20:34:51.170
> 
> 标签：c#, poco, iequalitycomparer, iequatable

我有来自具有身份 ID 字段的 SQL Server 数据库的 POCO。我想实现 IEquatable 所以我可以检查它们是否是相同的记录，使用`.Contains()`等`List<T>` 。

假设我永远不需要比较未保存的实例，仅使用以下方法就足够了：

```
 public bool Equals(MyClass other)
    {
        return this.ID == other.ID;
    }

    public override int GetHashCode()
    {
        return this.ID;
    } 
```

我正要这样做，但只是想检查一下，因为我不是 100% 确定 GetHashCode 与它有什么关系，或者是否有任何其他考虑因素（例如“未保存的实例”，其中我可以丢弃）我不知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T20:42:58.133

`GetHashCode()`每当您覆盖时都需要覆盖`Equals()`（在实现时也应该这样做`IEquatable<T>`），以便依赖它的类（例如 `Dictionary<TKey, TValue>`）可以正确处理它。这是令人讨厌的泄漏的内部细节之一。[更多信息](https://stackoverflow.com/questions/371328/why-is-it-important-to-override-gethashcode-when-equals-method-is-overridden)。

至于比较您的 ID 是否足以确定相等性，如果您绝对确定具有相同 ID 的两个实体在所有情况下都应该被视为等效，那么就去做吧。这是一个只有您的应用程序要求才能回答的问题。我自己已经做过很多次了，几乎总是使用只读实体。

我会这样实现它：

```
// IEquatable<MyClass> implementation
public bool Equals(MyClass other) 
{
  if (other == null) 
  {
    return false;
  }

  return this.ID == other.ID;
}

// Override of default Object.Equals()
public override bool Equals(object other) 
{
  return this.Equals(other as MyClass);
}

public override int GetHashCode()
{
  // Call ID.GetHashCode() because ID may not always be int,
  // and the ID type might have a more useful implementation
  // of GetHashCode() to offer.
  return this.ID.GetHashCode(); 
} 
```

在这种情况下，您可能还应该覆盖`==`and运算符。如果您想区分具有相同 ID 的两个不同引用，`!=`您可以随时使用。`Object.ReferenceEquals()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:47:31.313

如果根据您的业务规则，当它们的 ID 相等时，您的对象彼此相等，那么您做得很好！

对象状态的哈希码表示每个具有不同状态的对象都应该返回不同的哈希码。这个哈希码不是唯一的，但我们可以尝试使它们尽可能不同。只需检查字符串的哈希码`"Hello".GetHashCode()`和`"Goodbye".GetHashCode()`.

HashCode 用于某些集合中，例如`System.Collections.Generic.Dictionary<K,V>`和`System.Collections.Generic.HashSet<T>`。通过使用这个哈希码，那些字典可以通过使用这个“唯一”哈希码非常快速地搜索和找到一个项目（几乎是 O(1) 操作）。使用实体字段的哈希码计算此哈希码。

如果你实施`IEquatable<T>.Equals`，也覆盖`Equals(object)`。

# python - 当前 3 列相同时添加第 4 列

> ID：16201655
> 
> 赞同：0
> 
> 时间：2013-04-24T20:35:12.733
> 
> 标签：python, unix, awk

我有这样的文件，其中前 3 列中的某些行相同，第 4 列中的值不同。如果前 3 列相同，我想对第 4 列中的所有值求和：

```
chr1 241783  286397   52
chr1 241783  286397   53
chr1 241783  286397   53
chr2 10500  25700   57
chr2 10500  25700   59
chr2 10500  25700   59 
```

我想要这样的输出文件：

```
chr1 241783  286397 158
chr2 10500  25700   175 
```

我可以从文件中打印出单个相同的值`awk`，我在其中一篇文章中看到了 .`awk '!array[$1,$2,$3]++'`但我想对它们求和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:38:12.073

这应该可以解决问题：

```
$ awk '{a[$1FS$2FS$3]+=$4}END{for(k in a)print k,a[k]}' file
chr2 10500 25700 175
chr1 241783 286397 158 
```

# javascript - 如何在 JavaScript 中交换两个变量

> ID：16201656
> 
> 赞同：207
> 
> 时间：2013-04-24T20:35:13.110
> 
> 标签：javascript, variables, swap

我有这两个变量：

```
var a = 1,
    b = 2; 
```

我的问题是如何交换它们？只有这个变量，没有任何对象。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2013-04-24T20:39:39.250

这是一个交换两个变量值的单行代码。
给定变量`a`和`b`：

```
b = [a, a = b][0]; 
```

下面的演示：

```
var a=1,
    b=2,
    output=document.getElementById('output');

output.innerHTML="<p>Original: "+a+", "+b+"</p>";

b = [a, a = b][0];

output.innerHTML+="<p>Swapped: "+a+", "+b+"</p>";
```

```
<div id="output"></div>
```

* * *

## 回答 #2

> 赞同：245
> 
> 时间：2014-09-18T10:58:37.187

ES6（Firefox 和 Chrome 已经支持它（解构赋值数组匹配））：

```
let a = 5, b = 6;
[a, b] = [b, a];
console.log(`${a} ${b}`);
```

* * *

## 回答 #3

> 赞同：128
> 
> 时间：2013-04-24T20:37:07.897

你可以这样做：

```
var a = 1,
    b = 2,
    tmp;
tmp = a;
a = b;
b = tmp; 
```

就可读性和可维护性而言，这是无可匹敌的（至少在 JavaScript 中）。任何维护代码的人（包括六个月后的你）都会确切地知道发生了什么。

由于这些是整数，因此您还可以使用任意数量的巧妙技巧¹进行交换，而无需使用第三个变量。例如，您可以使用按位异或运算符：

```
let a = 1, b = 2;
a = a ^ b;
b = a ^ b;
a = a ^ b;

console.log('a is now:', a);
console.log('b is now:', b);
```

这称为 XOR 交换算法。它的操作原理在[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/XOR_swap_algorithm)中进行了描述。

¹ *“称职的程序员完全意识到自己头骨的有限大小。因此，他以完全谦逊的态度完成任务，并避免像瘟疫这样的聪明伎俩。”* — Edsger W. Dijkstra

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-12-11T23:04:21.460

**不要使用下面的代码。不*推荐*交换两个变量的值（只需[使用临时变量](https://stackoverflow.com/a/16201688/476820)）。它只是展示了一个 JavaScript 技巧。**

该解决方案不使用临时变量，不使用数组，只使用一个加法，而且[速度很快](http://jsperf.com/swap-two-numbers-without-tmp-var/9)。事实上，它*[有时比几个平台上的临时变量更快](http://jsperf.com/swap-two-numbers-without-tmp-var/9)*。
它适用于所有数字，永不溢出，并处理诸如 Infinity 和 NaN 之类的边缘情况。

```
a = b + (b=a, 0) 
```

它分两步工作：

*   `(b=a, 0)`设置`b`为的旧值`a`和产量`0`
*   `a = b + 0`设置`a`为旧值`b`

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-11-04T10:24:31.023

从 ES6 开始，您还可以更优雅地交换变量：

```
var a = 1,
    b = 2;

[a, b] = [b, a];

console.log('a:', a, 'b:', b); // a: 2 b: 1 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2013-11-19T01:37:11.000

这是一个单线，假设`a`并且`b`已经存在并且具有需要交换的值：

```
var c=a, a=b, b=c; 
```

正如@Kay 提到的，这*实际上*比数组方式执行得更好（几乎快 2 倍）。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2017-04-05T07:34:39.143

你现在终于可以做到了：

```
let a = 5;
let b = 10;

[a, b] = [b, a]; // ES6

console.log(a, b);
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-04-24T20:38:08.310

您可以使用临时交换变量或 XOR。

```
a = a ^ b
b = a ^ b
a = a ^ b 
```

这只是一个基本的逻辑概念，适用于所有支持 XOR 操作的语言。

**编辑：**见评论。忘了告诉这肯定只适用于整数。假设问题线程中的整数变量

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-04-24T20:38:57.833

像这样使用第三个变量：

```
var a = 1,
    b = 2,
    c = a;

a = b; // must be first or a and b end up being both 1
b = c; 
```

* * *

[**演示**](http://jsfiddle.net/Cezqf/)- 使用第三个变量

* * *

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2013-04-24T20:40:31.573

由于您的问题很宝贵“只有这个变量，而不是任何对象。”，答案也很宝贵：

变量 a = 1, b = 2

```
a=a+b;
b=a-b;
a=a-b; 
```

这是一个技巧

正如罗德里戈·阿西斯所说，它“可以更短”

```
 b=a+(a=b)-b; 
```

演示：http: [//jsfiddle.net/abdennour/2jJQ2/](http://jsfiddle.net/abdennour/2jJQ2/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-02-13T07:34:22.883

**ES6 解构：**

使用数组：`[a, b] = [b, a]; // my favorite`

使用对象：`{a, b} = {a:b, b:a}; // not bad neither`

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-05-07T17:02:16.303

我们怎么能错过这些经典的oneliners

```
var a = 1, b = 2
a = ({a:b, _:(b=a)}).a; 
```

和

```
var a = 1, b = 2
a = (_=b,b=a,_); 
```

最后一个公开了全局变量'_'，但这并不重要，因为典型的javascript约定是将它用作'dont care'变量。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-01-24T12:18:47.870

单行交换

```
a = a^b^(b^=(a^b)); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-03-26T05:17:58.393

```
var a = 5;
var b = 10;

b = [a, a = b][0];
//or
b = [a, a = b];
b = b[0];

//or
b = [a, b];
a = b[1];
b = b[0];

alert("a=" + a + ',' + "b=" + b); 
```

删除或注释 2 //or 并使用一组代码运行

[http://jsfiddle.net/USdv8/57/](http://jsfiddle.net/USdv8/57/)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-11-21T07:49:47.150

我在这里看到了一种编程奥林匹克。一种更棘手的单线解决方案：

```
b = (function(){ a=b; return arguments[0]; })(a); 
```

小提琴：http: [//jsfiddle.net/cherniv/4q226/](http://jsfiddle.net/cherniv/4q226/)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-01-13T10:35:34.510

我们可以像这样交换 var：

```
var val1 =  117,
    val2 = 327;

val2 = val1-val2; 
console.log(val2);
val1 = val1-val2;
console.log(val1);
val2 = val1+val2;
console.log(val2); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-04-16T17:55:54.613

因为我听说这种方法运行速度较慢：

```
b = [a, a = b][0]; 
```

如果您打算将变量存储在一个对象（或数组）中，这个函数应该可以工作：

```
function swapVars(obj, var1, var2){
    let temp = obj[var1];
    obj[var1] = obj[var2];
    obj[var2] = temp;
} 
```

用法：

```
let test = {a: 'test 1', b: 'test 2'};

console.log(test); //output: {a: 'test 1', b: 'test 2'}

swapVars(test, 'a', 'b');

console.log(test); //output: {a: 'test 2', b: 'test 1'} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-12-31T12:04:28.133

直到 ES5，要交换两个数字，你必须创建一个临时变量然后交换它。但是在 ES6 中，使用数组解构来交换两个数字非常容易。见例子。

```
let x,y;
[x,y]=[2,3];
console.log(x,y);      // return 2,3

[x,y]=[y,x];
console.log(x,y);      // return 3,2 
```

[进一步了解 JavaScript ES6 解构](https://tutorial.techaltum.com/js-destructuring.html#swap)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-04-23T11:06:49.570

我们可以使用 IIFE 交换两个值而无需额外的参数

```
var a = 5, b =8;
b = (function(a){ 
    return a 
}(a, a=b));

document.write("a: " + a+ "  b:  "+ b);
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-01T02:51:23.537

虽然之前给出了相同的答案，但这里是一个png来描述它。

可能的最简单形式：

[![在此处输入图像描述](https://i.stack.imgur.com/6dLlV.png)](https://i.stack.imgur.com/6dLlV.png)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-02-13T02:11:55.437

```
let a = 2, b = 4;
[b, a] = [a, b]; 
```

更详细的方法是

```
let a = 2, b = 4;
a = [a, b];
b = a[0];
a = a[1]; 
```

# c++ - 如何在 Objective C 模块中使用 C++ 内存管理例程？

> ID：16201668
> 
> 赞同：0
> 
> 时间：2013-04-24T20:36:01.223
> 
> 标签：c++, ios, memory-management

我需要在我的 Objective C iOS 项目中使用 C++ 内存分配例程。但是，编译器无法识别`new/delete`产生`Use of undeclared identifier "new"`.

```
char *armsciiBuffer = new char[numberOfUnicodeChars];
...
delete [] armsciiBuffer; 
```

这里的解决方法是什么？我可以使用`malloc`，但 new/delete 会好得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:39:41.533

将代码编译为 Objective-C++。添加`-x obj-c++`编译器标志，或将源文件命名为`Foo.mm`.

# cakephp - CakePHP 2.4.2：评论模型关系-获取原始帖子的标题

> ID：16201672
> 
> 赞同：0
> 
> 时间：2013-04-24T20:36:16.460
> 
> 标签：cakephp, model, relationship, cakephp-2.1

我有一个非常典型的评论模型，其中评论属于许多其他模型，例如文章、评论、照片等，而这些模型中的每一个都有很多评论。这是我在评论模型上建立关系的方式......

```
<?php
App::uses('AppModel', 'Model');

class Comment extends AppModel {

var $name = "Comment";

public $belongsTo = array(
    'User' => array(
        'className' => 'User',
        'foreignKey' => 'user_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    ),
    'Article' => array(
        'className' => 'Article',
        'foreignKey' => 'post_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    ),
    'Photo' => array(
        'className' => 'Photo',
        'foreignKey' => 'post_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    ),
    'Review' => array(
        'className' => 'Review',
        'foreignKey' => 'post_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    )
);
} 
```

这就像一个魅力，如果我正在查看一篇特定的文章，那么我可以从该文章中检索所有评论，并且它对其他模型的工作方式相同。**我要做的是显示所有带有原始帖子标题的最新评论，无论原始帖子来自什么模型**（文章，评论，照片等），格式为`$comment['Original']['title']`. 我认为在 Comment 模型的 belongsto 中添加以下代码会起作用，但它不会....

```
 'Original' => array(
        'className' => 'Article',
        'foreignKey' => 'post_id',
        'conditions' => array('Comment.module_id' => 3),
        'fields' => '',
        'order' => ''
    ),
    'Original' => array(
        'className' => 'Review',
        'foreignKey' => 'post_id',
        'conditions' => array('Comment.module_id' => 2),
        'fields' => '',
        'order' => ''
    ),
    'Original' => array(
        'className' => 'Photo',
        'foreignKey' => 'post_id',
        'conditions' => array('Comment.module_id' => 8),
        'fields' => '',
        'order' => ''
    ), 
```

不幸的是，如果最近的评论是在一张照片上，这只会显示正确的标题`(Comment.module_id = 8)`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:44:22.297

您可以使用 CakePHP 的[Containable Behavior](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)并执行以下操作：

```
//within a method of the Comment model
$recentComments = $this->find('all', array(
    'contain' => array(
        'Article',
        'Photo',
        'Review',
        'User'
    ),
    'limit' => 10,
    'order' => $this->alias . '.created DESC'
)); 
```

然后，您将取回评论和他们的任何父母，无论它在哪个模型中。之后，当您重复每条评论时，您可以做一个案例陈述，或者做一些`if(!empty())`事情来确定哪个模型有内容你想显示的。

（旁注：每次尝试使用“原始”创建多个具有相同名称的关联并不是一个好主意）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:52:01.840

您仅收到带有条件的评论也就不足为奇了`Comment.module_id = 8`。你犯了一个基本的 PHP 错误。`Original`通过多次使用相同的键，您每次都有效地覆盖它的值。为每个关联选择唯一的别名（数组键）。

# ios - 使用 Django 通过 Pyapns（iOS 推送通知）发送其他数据

> ID：16201676
> 
> 赞同：1
> 
> 时间：2013-04-24T20:36:24.570
> 
> 标签：ios, django, push-notification, apple-push-notifications

是否可以通过 pyapns 获取其他数据？例如，假设我有一个帖子模型。每个帖子都有一个 post_id。我想发送带有推送通知的 post_id。收到推送通知的用户会收到类似“Alex 评论了你的帖子”之类的信息。

用户将看不到 post_id。它对用户是隐藏的，但我仍然想发送这些额外的数据，以便当用户点击推送通知时，它会将他们引导到正确的帖子。

这就是我的 util.py 中的内容：

```
import pyapns
import xmlrpclib

class PyapnsWrapper(object):

     def __init__(self, host, app_id, apns_certificate_file, mode='production'):
         self.app_id = app_id
         pyapns.configure({'HOST': host})
         pyapns.provision(app_id,
                          open(apns_certificate_file).read(),
                          mode)

     def notify(self, token, message):
         try:
             pyapns.notify(self.app_id,
                           token,
                           {'aps':{'alert': message}})
         except xmlrpclib.Fault, e:
             print e 
```

我怎么可能修改它以发送带有通知参数的额外字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:55:14.027

尝试更换

`{'aps':{'alert': message}}`

和

`{'aps':{'alert': message},'post-id':post_id}`.

我不熟悉`pyapns`也不懂 python，但是 APNS 有效负载格式允许向有效负载添加自定义属性。我不确定我的语法是否准确（正如我所说的我不知道 python），但你应该从中得到想法。

JSON 有效负载应如下所示：

```
{

    "aps" : {

        "alert" : "Alex commented on your post.",

    },

    "post-id" : 435472

} 
```

当用户单击通知并打开应用程序时，您将能够以这种方式访问​​自定义数据（`notificationInfo`将包含`post-id`键及其值）：

```
- (BOOL)application:(UIApplication *)app didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    NSDictionary* notificationInfo =
        [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];
    if (notificationInfo) {
        [self someProcessing:notificationInfo];
    }
    ...
    return YES;
} 
```

# xml - 在 DTD 中，为什么将命名空间作为 URL 给出？

> ID：16201678
> 
> 赞同：3
> 
> 时间：2013-04-24T20:36:45.453
> 
> 标签：xml, xsd, namespaces, xml-namespaces, dtd

显然，`xmlns`HTML 和 XML 页面中的命名空间 URL 是没有意义的。一直以来，我虽然这些地址实际上有命名空间......

当我第一次阅读/听说命名空间时，我想象在提供的 URL 中有一些大文件，其中包含可以在文档实例中使用的所有有效“名称”的列表。我来了解我想象错了。

但如果 URL 完全没用，那么命名空间的意义何在？如果某个东西实际上并不存在于任何地方，你怎么知道它是否属于一个命名空间？当我指定一个“命名空间”时，我真的在做什么吗？

在我看来，这在每个意义上都是完全任意的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:05:29.070

XML 中命名空间名称的基本功能是提供一个唯一标识符，它允许需要处理 XML 文档的软件或人员知道输入中遇到的特定元素是否是他们负责的元素之一加工。假设您是一个专门用于处理名为“blort”的元素并将结果显示在用户显示器区域的软件。每当您在输入中看到名为“blort”的元素时，您必须确定您在输入中看到的“blort”元素是您应该处理的“blort”元素，还是另一个具有相同名称但不同的结构或含义。没有名称空间，您无法确定。

如果满足以下条件，则可以解决此问题：

*   每个发明 XML 词汇表（并且关心避免名称冲突）的人都会为其词汇表选择一个唯一的名称。出于各种历史、技术和风格的原因，我们将此名称称为“命名空间名称”。

*   我们找到了一些方法来使 XML 元素或属性的全名包含命名空间名称。这就是一些规范所称的“扩展名称”：由命名空间名称和“本地名称”组成的一对。

现在，只要满足第三个标准，您就可以将您设计处理的词汇表中的“blort”与您可能找到的任何其他“blort”区分开来（只需查看它们的扩展名称！）：

*   没有两个 XML 词汇表的发明者为其词汇表选择相同的名称空间名称。

确保任意标识符唯一性的常用方法是拥有某种中央注册表。然而，中央注册中心难以构建和维护，XML 名称空间使用 URI 作为一种捎带最成功的注册机构之一的方式：在互联网核心维护域名系统的注册机构。只要命名空间名称的发明者遵循仅在他们拥有或控制的部分URI空间中分配命名空间名称的基本规则，不同的发明者将永远不会选择相同的命名空间名称。

使用 URI 作为命名空间名称还有一个很好的属性，即命名空间的定义者*可以*将人类和机器可读的命名空间文档放在命名空间 URI 中。一些权威机构推荐这是一种良好的做法，但 W3C 的[XML 命名空间](http://www.w3.org/TR/xml-names/)建议中并不要求这样做，以保持命名空间处理尽可能简单。我熟悉的大多数供公众使用的 XML 词汇表都在它们的名称空间 URI 中提供了文档，尽管并非全部都提供。因此，您可以通过查找由负责实体发布的文档来找出属于名称空间的内容。如果他们在命名空间 URI 中提供它，那很容易；如果没有，那就更难了；在某些情况下，这个问题在实践中可能无法回答。生活有时很艰难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T20:55:30.420

URL（实际上是一个 URI）根本不是没有意义的，它是一个唯一的标识符。有了它，您就不需要所有可能的命名空间的中央注册表。只需在您控制的域中创建一个 URL，您就可以确保您拥有唯一的标识符。（URI 不仅是在 Web 上检索资源的一种方式，它们也是*标识符*。）

如果您将此 URL 提供给 Web 浏览器，则将名称空间标识符作为实际 URL 并提供一些文档被认为是一种很好的做法。但这不是强制性的。

# android - 无法将文件附加到 ACTION_SEND 意图

> ID：16201682
> 
> 赞同：1
> 
> 时间：2013-04-24T20:36:53.857
> 
> 标签：android, email, android-intent, attachment

我正在尝试将文本文件附加到电子邮件中，但遇到了一个奇怪的错误，希望有人能帮助我。当用户从选择器中选择 gmail 应用程序时，它工作正常，但如果他们选择内置邮件应用程序，他们会看到一个显示“无法附加文件”的 toast。

代码如下所示：

```
public static void sendMail(Context context, String emailBody, String emailSubject, String emailAddress, String attachmentFilename){
    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.setType("plain/text");

    emailIntent.putExtra(Intent.EXTRA_EMAIL, new String[] { emailAddress});
    emailIntent.putExtra(Intent.EXTRA_SUBJECT, emailSubject);
    emailIntent.putExtra(Intent.EXTRA_TEXT, emailBody);

    if(attachmentFilename != null) {
        //Add the attachment by specifying a reference to our custom ContentProvider and the specific file of interest
        emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("content://" + Settings.VYPR_LOG_PROVIDER_AUTHORITY + "/" + attachmentFilename));
    }
    context.startActivity(emailIntent);
} 
```

有人对这里可能发生的事情有任何想法吗？我在这里看到的大部分内容都与 SD 卡上的附件有关。实际上我自己并没有编写此代码，但似乎这不是问题所在，因为如果用户选择 gmail 应用程序而不是内置应用程序，它*确实可以工作。*

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:49:45.200

我很久以前遇到过同样的问题。必须使用 Gmail 应用程序来发送附件。我无法弄清楚为什么内置的电子邮件应用程序不起作用。

如果您尝试接收特定电子邮件地址的附件，您还可以考虑部署 Web 服务来上传附件。

希望能帮助到你。

# azure - 测试 Azure 死信服务总线队列

> ID：16201691
> 
> 赞同：3
> 
> 时间：2013-04-24T20:37:16.420
> 
> 标签：azure, integration-testing, azureservicebus

我们有一个监听 Azure 服务总线队列的服务。我们有另一个服务来监听这个队列的死信队列。我们还进行了一系列测试，这些测试在部署后针对我们的 Azure 应用程序运行。

我们想扩展我们的自动化测试，以便也测试处理死信的部分，但不确定我们如何编写测试来确保消息到达死信队列，因为在正常情况下消息不会死信。

目前我们正在手动测试这个，但我觉得这不是一个长期的选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:02:31.203

在服务总线 API 中，Microsoft 不提供直接将消息发送到死信队列而不将消息放入主队列的功能。如果您尝试使用死信队列的路径创建[MessageSender ，它将失败并出现异常。](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.messagesender.aspx)

[您需要使用调用BrokeredMessage.DeadLetter()](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.brokeredmessage.deadletter.aspx)方法将消息传输到死信队列的虚假实现来模拟您的主队列接收器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T22:03:23.323

根据服务总线[文档](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.queuedescription.enabledeadletteringonmessageexpiration.aspx)，如果您设置`EnableDeadLetteringOnMessageExpiration`为 true，则如果消息过期，它将进入死信队列。所以，你可以这样做：

```
var desc = new QueueDescription(QueueName);
desc.EnableDeadLetteringOnMessageExpiration = true;
desc.DefaultMessageTimeToLive = TimeSpan.FromSeconds(1); // one second is the min value 
```

您只需等待 > 1 秒即可进行测试，以确保消息进入死信队列。

**编辑**：您也可以通过做死信收到的消息`receivedMessage.DeadLetter()`。这将自动将其放入死信队列。

# javascript - Javascript / jQuery - 抓取 IMG SRC

> ID：16201692
> 
> 赞同：2
> 
> 时间：2013-04-24T20:37:19.043
> 
> 标签：javascript, jquery, screen-scraping

我正在尝试使用 Javascript 和 jQuery 库来抓取数据。

到目前为止，一切都很好。我能够从标签之间抓取数据。例如我想从`<li>`标签中获取数据，我这样做如下：

```
stuff_found = $(data).find('li'); 
```

但是，如果我尝试`<img>`使用以下代码从标签中获取 src，则仅返回第一张图像。

```
stuff_found =  $(data).find('img').attr(); 
```

我需要知道如何返回完整列表（页面上的每张图片），而不仅仅是第一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T23:07:06.940

最简单的方法是编写图像选择器以仅获取`<li>`标签内的图像。然后你可以用 or 遍历它们`.each()`，如果你真的只需要图像`src`属性值，`.map()`. 例如：

```
var imageList = $('li img').map(function()
{
    return $(this).attr('src');
}).get(); 
```

在代码示例中会发生这种情况：

1.  你首先得到`<li>`标签内的所有图像 -`$('li img')`部分。
2.  然后`.map()`你应用一个函数来遍历所有这些并提取一个值。基本上`.map()`，它需要一个列表，将给定的函数应用于列表的所有元素，并返回带有新处理元素的结果列表。
3.  带有的部分从图像标签中`$(this).attr('src')`获取实际值。`src`
4.  最后，因为 jQuery 返回它自己的数组类型而不是标准的 javascript 数组，所以您需要做`.get()`的就是将返回的对象从 jQuery 数组转换为标准数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:40:05.260

```
$('img').each(function(){
    alert($(this).prop('src'));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:39:06.397

*页面上的每个图像*..？

```
$('li img').each(function(){
  var src = $(this).attr('src');
}); 
```

或获取它们的列表 -

```
var list = $('li img').map(function() {
              return $(this).attr('src');
           }).get(); 
```

# python - 仍然无法停止线程

> ID：16201698
> 
> 赞同：0
> 
> 时间：2013-04-24T20:37:29.847
> 
> 标签：python, multithreading, pycurl

我想用简单的 CTR+C 来停止线程，但是数据源源不断，所以我必须关闭窗口并重新启动它。请帮我解决这个问题。为了看到我在说什么，只需在用户中输入您的推特用户名和密码并通过

```
import threading
import random
import time
import Queue
import urllib2
import sys
import simplejson, pycurl
import sys, signal

queue = Queue.Queue()
keep_running = True
user = "" # username
pswd = "" # password
headers = [ "Content-Type: text/xml; charset: UTF-8; "]

class MyThread(threading.Thread):

    def __init__(self, queue):
        threading.Thread.__init__(self)
        self.queue = queue
        self.buffer = ""
        self.streaming_url = "https://stream.twitter.com/1/statuses/filter.json?track=justinbieber"

    def start_crawl(self, user, pswd):
        self.conn = pycurl.Curl()
        self.conn.setopt(pycurl.USERPWD, "%s:%s" % (user, pswd))
        self.conn.setopt(pycurl.URL, self.streaming_url)
        #self.conn.setopt(pycurl.POST, 1)
        self.conn.setopt(pycurl.HTTPHEADER, headers)
        self.conn.setopt(pycurl.READFUNCTION, self.storage)
        self.conn.setopt(pycurl.VERBOSE, 1)
        self.conn.setopt(pycurl.HTTPAUTH, pycurl.HTTPAUTH_BASIC)
        self.conn.perform()

    def storage(self, data):
        self.buffer += str(data)
        if isinstance(self.buffer, str):
            if self.buffer.endswith("\r\n") and self.buffer.strip():
                content = json.loads(self.buffer)
                self.buffer = ""
                self.queue.put(content)
                self.queue.task_done()
                #if "text" in content:
                    #print u"{0[user][name]}: {0[text]}".format(content)
        else:
            return data

    def run(self):
        while keep_running:
            self.start_crawl(user,pswd)
            if signal.signal(signal.SIGINT, signal.SIG_DFL):
                sys.exit()
            #line = self.names[random.randint(0,len(self.names)-1)]
            #queue.put(line)

class Starter():
    def __init__(self):
        self.queue = queue
        t = MyThread(self.queue)
        t.start()
        self.next()

    def next(self):
        while True:
            time.sleep(0.1)
            if not self.queue.empty():
                line = self.queue.get(timeout=0.2)
                print line, self.queue.qsize()
            else:
                print 'waiting for queue'

def main():  
    try:
        Starter()   
        queue.join()  
    except KeyboardInterrupt, e:
        print 'Stopping'
        global keep_running
        keep_running = False
        #Join all existing threads to main thread.
        for thread in threading.enumerate():
            if thread is not threading.currentThread():
                thread.join()
        sys.exit(1)

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:39:28.907

将线程设置为守护进程，它将被您的程序杀死

```
import threading
import random
import time
import Queue
import urllib2
import sys
import simplejson, pycurl
import sys, signal

queue = Queue.Queue()
keep_running = True
user = "" # username
pswd = "" # password
headers = [ "Content-Type: text/xml; charset: UTF-8; "]

class MyThread(threading.Thread):

    def __init__(self, queue):
        threading.Thread.__init__(self)
        self.queue = queue
        self.buffer = ""
        self.streaming_url = "https://stream.twitter.com/1/statuses/filter.json?track=justinbieber"

    def start_crawl(self, user, pswd):
        self.conn = pycurl.Curl()
        self.conn.setopt(pycurl.USERPWD, "%s:%s" % (user, pswd))
        self.conn.setopt(pycurl.URL, self.streaming_url)
        #self.conn.setopt(pycurl.POST, 1)
        self.conn.setopt(pycurl.HTTPHEADER, headers)
        self.conn.setopt(pycurl.READFUNCTION, self.storage)
        self.conn.setopt(pycurl.VERBOSE, 1)
        self.conn.setopt(pycurl.HTTPAUTH, pycurl.HTTPAUTH_BASIC)
        self.conn.perform()

    def storage(self, data):
        self.buffer += str(data)
        if isinstance(self.buffer, str):
            if self.buffer.endswith("\r\n") and self.buffer.strip():
                content = json.loads(self.buffer)
                self.buffer = ""
                self.queue.put(content)
                self.queue.task_done()
                #if "text" in content:
                    #print u"{0[user][name]}: {0[text]}".format(content)
        else:
            return data

    def run(self):
        while keep_running:
            self.start_crawl(user,pswd)
            if signal.signal(signal.SIGINT, signal.SIG_DFL):
                sys.exit()
            #line = self.names[random.randint(0,len(self.names)-1)]
            #queue.put(line)

class Starter():
    def __init__(self):
        self.queue = queue
        t = MyThread(self.queue)
        t.daemon = True
        t.start()
        self.next()

    def next(self):
        while True:
            time.sleep(0.1)
            if not self.queue.empty():
                line = self.queue.get(timeout=0.2)
                print line, self.queue.qsize()
            else:
                print 'waiting for queue'

def main():  
    try:
        Starter()   
        queue.join()  
    except KeyboardInterrupt, e:
        print 'Stopping'
        raise

main() 
```

# spring - @Transactional on Spring shutdown 正确关闭 Hsqldb

> ID：16201704
> 
> 赞同：5
> 
> 时间：2013-04-24T20:37:38.683
> 
> 标签：spring, hsqldb, shutdown, transactional

这个问题的核心是：是否可以从由 Spring 关闭挂钩触发的方法执行事务？

目前我有一个实现 SmartLifeCycle 的 HyperSqlDbServer 类，如以下问题所示： [In a spring bean is it possible to have a shutdown method that can use transactions？](https://stackoverflow.com/questions/5891032/in-a-spring-bean-is-it-possible-to-have-a-shutdown-method-which-can-use-transact)

我在该类中有一个标记为事务的方法，该方法作为停止方法的一部分被调用：

```
@Transactional
public void executeShutdown() {
    hsqlDBShutdownService.executeShutdownQuery();
    hsqlDBShutdownService.closeEntityManager();
} 
```

该方法中使用的服务有点像我必须做的，因为我无法在 EntityManager 中自动装配到此类：

```
@Service
public class HsqlDBShutdownService {

    @PersistenceContext
    private EntityManager entityManager;

    @Autowired
    private HyperSqlDbServer hyperSqlDbServer;

    @Transactional
    public void executeShutdownQuery() {
        entityManager.createNativeQuery("SHUTDOWN").executeUpdate();
    }

    @Transactional
    public void closeEntityManager() {
        entityManager.close();
    }

    @PostConstruct
    public void setHsqlDBShutdownService() {
        hyperSqlDbServer.setShutdownService(this);
    }
} 
```

您可能会注意到，我真正想要完成的只是在停止服务器之前调用查询“SHUTDOWN”。如果没有这个，hsqldb 锁定文件会在服务器重新启动时保留，并且服务器会引发异常。

上面的代码产生以下异常：

```
javax.persistence.TransactionRequiredException: Executing an update/delete query
    at org.hibernate.ejb.AbstractQueryImpl.executeUpdate(AbstractQueryImpl.java:96)
        ... 
```

所以我最初的问题是存在的，但是如果有人对如何以另一种方式执行此查询有想法，我也会尝试。

仅供参考，我也尝试过 @PreDestroy 注释，但得到相同的 TransactionRequiredException。

编辑：为了完整起见，我正在使用 JpaTransactionManager 和 @Transactional 注释在我的整个项目中工作，除了关机......

编辑 2：数据源和事务管理器配置：

```
@Configuration
@EnableTransactionManagement
@PropertySource("classpath:persistence.properties")
public class PersistenceConfig implements TransactionManagementConfigurer {

    private static final String PASSWORD_PROPERTY = "dataSource.password";
    private static final String USERNAME_PROPERTY = "dataSource.username";
    private static final String URL_PROPERTY = "dataSource.url";
    private static final String DRIVER_CLASS_NAME_PROPERTY = "dataSource.driverClassName";

    @Autowired
    private Environment env;

    @Bean
    @DependsOn("hsqlDb")
    public DataSource configureDataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(env.getProperty(DRIVER_CLASS_NAME_PROPERTY));
        dataSource.setUrl(env.getProperty(URL_PROPERTY));
        dataSource.setUsername(env.getProperty(USERNAME_PROPERTY));
        dataSource.setPassword(env.getProperty(PASSWORD_PROPERTY));
        return dataSource;
    }

    @Bean
    @DependsOn("hsqlDb")
    public LocalContainerEntityManagerFactoryBean configureEntityManagerFactory() {
        LocalContainerEntityManagerFactoryBean entityManagerFactoryBean = new LocalContainerEntityManagerFactoryBean();
        entityManagerFactoryBean.setDataSource(configureDataSource());
        entityManagerFactoryBean.setPackagesToScan("com.mycompany.model.db");
        entityManagerFactoryBean.setJpaVendorAdapter(new HibernateJpaVendorAdapter());

        Properties jpaProperties = new Properties();
        jpaProperties.put(org.hibernate.cfg.Environment.DIALECT, env.getProperty(org.hibernate.cfg.Environment.DIALECT));
        jpaProperties.put(org.hibernate.cfg.Environment.HBM2DDL_AUTO, env.getProperty(org.hibernate.cfg.Environment.HBM2DDL_AUTO));
        jpaProperties.put(org.hibernate.cfg.Environment.SHOW_SQL, env.getProperty(org.hibernate.cfg.Environment.SHOW_SQL));
        jpaProperties.put(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES_SQL_EXTRACTOR, env.getProperty(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES_SQL_EXTRACTOR));
        jpaProperties.put(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES, env.getProperty(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES));
        entityManagerFactoryBean.setJpaProperties(jpaProperties);

        return entityManagerFactoryBean;
    }

    @Override
    @Bean()
    @DependsOn("hsqlDb")
    public PlatformTransactionManager annotationDrivenTransactionManager() {
        return new JpaTransactionManager();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T16:14:56.273

我找到了关闭 HsqlDB 数据库的解决方法，但它涉及避免使用 Spring 的 EntityManager 和 @Transactional，因为它们在服务器关闭期间显然不起作用。我修改后的 HsqlDBShutdownService 如下。关键的变化是，我没有使用 EntityManager 来调用查询，而是手动创建了一个新的 jdbc 连接，并以这种方式调用查询。这避免了对@Transactional 的要求：

```
@Service
public class HsqlDBShutdownService  {

    @Autowired
    private ApplicationContext applicationContext;

    @PersistenceContext
    private EntityManager entityManager;

    @Autowired
    private HyperSqlDbServer hyperSqlDbServer; 

    public void executeShutdownQuery() {

        Connection conn = null;
        try {
            JdbcTemplate jdbcTemplate = new JdbcTemplate(this.applicationContext.getBean(DataSource.class));
            conn = DataSourceUtils.getConnection(jdbcTemplate.getDataSource());
            conn.setAutoCommit(true);
            jdbcTemplate.execute("SHUTDOWN"); 
        } catch(Exception ex) {
            ex.printStackTrace();
        } finally {
            try {
                if(conn != null)
                    conn.close();
            } catch(Exception ex) {
                ex.printStackTrace();
            }
        }
    }

    @Transactional
    public void closeEntityManager() {
        entityManager.close();
    }

    @PostConstruct
    public void setHsqlDBShutdownService() {
        hyperSqlDbServer.setShutdownService(this);
    }

} 
```

服务器现在可以成功重新启动，而不会留下 Hsqldb 锁定文件。

# c# - WebBrowser控件上的透明覆盖c#

> ID：16201705
> 
> 赞同：1
> 
> 时间：2013-04-24T20:37:41.977
> 
> 标签：c#, .net, winforms, browser, overlay

下图表示 c# 中 WebBrowser 控件上的面板。

![在此处输入图像描述](https://i.stack.imgur.com/Bysj0.png)

但是，如果我将面板背景属性设置为“透明”，它将显示颜色“银色”，因为我的表单背景是银色。

我的问题是；如何在我的自定义 WebBrowser 控件上绘制叠加层，以便当它“透明”时，它将显示 WebBrowser 控件而不是表单的背景颜色。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:40:24.083

我相信这归结为`OnPaint`面板的方法。

如果有多个控件相互重叠，则只会为屏幕的该区域绘制顶部控件。通过使控件透明，您可以使屏幕的该区域成为窗体背景色

我相信这个问题对解决方案有一些建议；这个问题似乎也指向`OnPaintBackground`更具体的

[问题链接](https://stackoverflow.com/questions/450381/how-to-overlap-two-controls)

# sql-server-2008 - 为什么 datediff 一周不工作？

> ID：16201707
> 
> 赞同：0
> 
> 时间：2013-04-24T20:37:48.793
> 
> 标签：sql-server-2008, tsql, date

这是一个需要一段时间才能找到的错误。我把它贴在这里是为了拯救别人这个错误。

（一旦找到它就非常简单，但它很容易犯 - 并且代价高昂 - 错误。）

为什么`select datediff(w, getdate()-7, getdate())`给出 7 而不是 1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:39:01.623

被`w`解释为天。[这里](http://msdn.microsoft.com/en-us/library/ms189794.aspx)从未提及，但莫名其妙地似乎意味着天。（我不知道为什么这不会出错，就像`datediff(foo, getdate()-7, getdate())`......）

星期的正确单位是`ww`或`wk`。

编辑：@Lamak 说那`w`是工作日而不是白天。没有任何（我可以找到）记录在案`w`，但这可能是正确的。

# ios - 手指跟踪和手势识别

> ID：16201710
> 
> 赞同：0
> 
> 时间：2013-04-24T20:38:12.987
> 
> 标签：ios, objective-c, cocos2d-iphone, uiimageview, uipangesturerecognizer

所以我正在开发一个应用程序，我的所有手势都可以被识别。当我尝试添加`UIImageViews`手指触摸屏幕的任何位置时，我的问题就出现了。

这些视图将跟随手指，他们这样做，但问题是我相信他们正在吞咽触摸，不允许手势被识别。我试过了：

```
[_fingerHolder1 setUserInteractionEnabled:NO];
[_fingerHolder2 setUserInteractionEnabled:NO]; 
```

但它似乎并没有改变任何东西。我在`ccTouchesBegan/Moved/Ended`方法中添加了这些视图，而手势在它们各自的处理程序中被识别。

我已经研究过使用，`UIPanGesture`但在识别滑动以及设置`UIImageViews`手指跟踪器的坐标时遇到了一些问题。我应该更多地尝试这个还是有不同的解决方案？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:04:32.310

UIImageView 将接收和处理触摸，因此它们不会被转发到 cocos2d OpenGL 视图（也是 UIView）。

要完成这项工作，您需要创建 UIImageView 的子类并覆盖每个 touches... 方法并手动将事件转发到 cocos2d 的视图，这里是 touchesBegan 的示例：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [[CCDirector sharedDirector].view touchesBegan:touches withEvent:event];
} 
```

使用此 UIImageView 子类代替您当前使用的原始子类。

这将使常规的 cocos2d 触摸事件起作用，并且如果您将这些事件添加到 cocos2d 的视图中，它还应该使 UIGestureRecognizers 的行为符合预期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:39:59.383

如果我理解您的需求（如果我错了，请纠正我），您希望在检测到拖动（平移）事件时移动一些 UIView，但是当用户触摸屏幕并且这会禁用触摸时，您还需要添加 UIImageView。

您应该设置`UIIMageView.userInteractionEnable = YES`（默认设置为 NO），基本上每个应该检测到触摸的视图都应该具有`userInteractionEnable = YES`.

如果你想忽略对某些子视图的一些改动，你应该实现： `-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch`method of `UIGestureRecognizerDelegate`.

要处理不同类型的手势，您应该实现以下方法： `-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer { return YES; }`

# regex - 正则表达式反斜杠和双引号例外

> ID：16201711
> 
> 赞同：1
> 
> 时间：2013-04-24T20:38:20.120
> 
> 标签：regex

我想要正则表达式让每一行都包含 1 个“单词”而不是 1 个“otherExpression”。

示例：获取带有表达式 '\"' 的每一行（一次或多次），而不是表达式 'otherExpression'

```
otherExpression1 \"
otherExpression 2 \"
\"
word \"
word
anything \"word\" here
before \"word    
something 
```

结果

```
\"
word \"
anything \"word\" here
before \"word 
```

样品 2

用 goodExpression 和 not badExpression

```
badExpression goodExpression 
goodExpression 
this is goodExpression 
this is badExpression
goodExpression2
badExpression1 
```

结果

```
goodExpression 
this is goodExpression
goodExpression2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:08:44.077

你需要一个消极的前瞻：

```
^(?!.*otherExpression).*(\\\") 
```

第 1 组有您匹配的`\"`

您还没有说您使用的是什么语言，但我认为需要转义双引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:45:13.743

不是 100% 确定你想要什么。尝试这个;

```
/^[^(?:otherExpression)].*$/gm 
```

火柴;

```
\"
word \"
word
anything \"word\" here
before \"word 
```

或这个;

```
/^[^(?:otherExpression)].*\"$/gm 
```

火柴;

```
\"
word \" 
```

或这个;

```
/^[^(?:otherExpression)].*\\"$/gm 
```

火柴;

```
word \" 
```

最后要真正匹配一个词，试试这个；

```
^[^(?:otherExpression)]\w+\s+\\"$ 
```

火柴;

```
word \" 
```

# nsstring - 将 NSString 转换为双精度

> ID：16201719
> 
> 赞同：0
> 
> 时间：2013-04-24T20:38:57.930
> 
> 标签：nsstring, double

我已经使用 JSON 将 mysql 数据库导入到 NSStrings 中，但现在我需要将其中两个转换为双精度来表示纬度和经度，但我不确定如何完成我的代码。

危害.h

```
#import <Foundation/Foundation.h>
#import <MapKit/MapKit.h>

@interface Hazards : NSObject <MKAnnotation>

// @property (nonatomic, readonly) CLLocationCoordinate2D coordinate;
@property (nonatomic, assign) CLLocationDegrees latitude;
@property (nonatomic, assign) CLLocationDegrees longitude;
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *subtitle;

@property (nonatomic, strong) NSString * ID;
@property (nonatomic, strong) NSString * ROUTE;
@property (nonatomic, strong) NSString * ADDRESS;
@property (nonatomic, strong) NSString * LATITUDE;
@property (nonatomic, strong) NSString * LONGITUDE;
@property (nonatomic, strong) NSString * HAZARD;
@property (nonatomic, strong) NSString * RISK;

// Methods
- (id) initWithID: (NSString *) hazardsID andROUTE: (NSString *) hazardsROUTE andADDRESS: (NSString *) hazardsADDRESS andLATITUDE: (NSString *) hazardsLATITUDE andLONGITUDE: (NSString *) hazardsLONGITUDE andHAZARD: (NSString *) hazardsHAZARD andRISK: (NSString *) hazardsRISK;

@end 
```

危害.m

```
#import "Hazards.h"

@implementation Hazards
@synthesize coordinate, title, subtitle, ID, ROUTE, ADDRESS, LATITUDE, LONGITUDE, HAZARD, RISK;

- (id) initWithID: (NSString *) hazardsID andROUTE: (NSString *) hazardsROUTE andADDRESS: (NSString *) hazardsADDRESS andLATITUDE: (NSString *) hazardsLATITUDE andLONGITUDE: (NSString *) hazardsLONGITUDE andHAZARD: (NSString *) hazardsHAZARD andRISK: (NSString *) hazardsRISK {

    self = [super init];
    if (self)
    {
        ID = hazardsID;
        ROUTE = hazardsROUTE;
        ADDRESS = hazardsADDRESS;
        LATITUDE = hazardsLATITUDE;
        LONGITUDE = hazardsLONGITUDE;
        HAZARD = hazardsHAZARD;
        RISK = hazardsRISK;

        latitude = ; // convert the string hazardsLatitude to a double here
        longitude = ; // convert the string hazardsLongitude to a double here

    }
return self;
}

/*-(CLLocationCoordinate2D)coordinate
{
    return CLLocationCoordinate2DMake(self.LATITUDE, self.LONGITUDE);
}*/

-(NSString *)title
{
    return self.HAZARD;
}

-(NSString *)subtitle
{
    return self.ADDRESS;
}
@end 
```

# php - 如何在 PHP 中跳过 CSV 的第一行

> ID：16201727
> 
> 赞同：0
> 
> 时间：2013-04-24T20:39:26.047
> 
> 标签：php, csv

我有一个 CSV 上传文件，我正在努力跳过 CSV 文档的第一行。我正在上传一个 CSV 文档，第一行包含一个单元格，该单元格包含一个抛出数组的文本。我不确定要编辑哪个计数？

```
$fields_firstrow = true;
$i = 0; 
$a = 0;
$fields = array();
$content = array(); 

$allowedExts = array("csv");
$extension = end(explode(".", $_FILES["file"]["name"]));
if (($_FILES["file"]["size"] < 2000000)&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {

    if (file_exists($_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],$_FILES["file"]["name"]);
      }
    }
  }
else
  {
  echo "Invalid file";
  }
$file = $_FILES["file"]["name"];

if (($handle = fopen($file, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 0, ",")) !== FALSE) { 
        if($fields_firstrow == true && $i<1) {
            foreach($data as $d) {
                $fields[] = strtolower(str_replace(" ", "_", $d));
            }
            $i++; 
            continue;
        }
        $c = 0;
        foreach($data as $d) {
            if($fields_firstrow == true) {
                $content[$a][$fields[$c]] = $d;
            } else {
                $content[$a][$c] = $d;
            }
            $c++;
        }
        $a++;
    }
} else { 
    echo "Could not open file"; 
    die();
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T08:05:04.227

**只需在while 循环**开始的行之前添加额外的代码行，如下所示：

```
....
.....
fgetcsv($handle);//Adding this line will skip the reading of th first line from the csv file and the reading process will begin from the second line onwards
while (($data = fgetcsv($handle, 0, ",")) !== FALSE) {
.......
....... 
```

就是这么简单…………！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:23:05.293

您没有更改变量 $fields_firstrow 的值。对于所有循环迭代，它仍然是正确的。

在我看来，根据我对您的代码的理解，您应该在第一次继续之前将其更改为 false。

```
...
if (($handle = fopen($file, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 0, ",")) !== FALSE) { 
        if($fields_firstrow == true && $i<1) {
            foreach($data as $d) {
                $fields[] = strtolower(str_replace(" ", "_", $d));
            }
            $i++; 
            $fields_firstrow = false;
            continue;
        }
        $c = 0;
        foreach($data as $d) {
            if($fields_firstrow == true) {
                $content[$a][$fields[$c]] = $d;
            } else {
... 
```

也许在那之后你不需要 $i 变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:17:32.733

这是一个来自[http://php.net/fgets](http://php.net/fgets)的示例，稍作修改：

```
<?php
$handle = @fopen("/tmp/inputfile.txt", "r");
$firstLine = true;
if ($handle) {
while (($buffer = fgets($handle, 4096)) !== false) {
    if(firstLine) {
        $firstLine = false;
        continue;
    }
    echo $buffer;
}
if (!feof($handle)) {
    echo "Error: unexpected fgets() fail\n";
}
fclose($handle);
}
?> 
```

我假设您明白这一点，并且可以相应地修改您的脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:45:50.573

```
 $i=0;
    if($fields_firstrow == true) {
        foreach($data as $d) {
            if ($i == 0){continue;}
            $i++;
            $fields[] = strtolower(str_replace(" ", "_", $d));
        }
    } 
```

# mpmusicplayercontroller - AVQueuePlayer 正在暂停，但播放图标不会消失

> ID：16201733
> 
> 赞同：0
> 
> 时间：2013-04-24T20:39:42.590
> 
> 标签：mpmusicplayercontroller, avaudiosession, avqueueplayer

我正在构建一个使用 AVQueuePlayer 流式传输音频的应用程序。我将我的 AVAudioSession 设置为 AVAudioSessionCategoryPlayback 类别，并且我能够从 remoteControlReceivedWithEvent: 接收事件。但是，当我暂停音频会话时，状态栏中的图标不会消失，App Switcher 中的暂停/播放按钮也不会变为播放。音频暂停，但图标永远不会改变。你知道为什么会发生这种情况吗？

我还使用 MPMusicPlayerController 从 iPod 音乐播放器播放音乐。两个播放器总是被初始化，但是一次只有一个播放器。当应用程序打开时，如果我先从 MPMusicPlayerController 播放某些内容，则 AVQueuePlayer 不再有此暂停冲突。仅当您首先从 AVQueuePlayer 播放时才会出现此问题。我包含了代码来向您展示我在做什么。

仅供参考-我的 MPMusicController 是 self.musicPlayer。我的 AVQueuePlayer 是 self.radioPlayer。暂停后，我的 AVQueuePlayer 的状态是 AVPlayerStatusReadyToPlay。

```
- (void)viewDidLoad {

    [super viewDidLoad];
    self.musicPlayer = [MPMusicPlayerController iPodMusicPlayer];
    self.musicPlayer.nowPlayingItem = self.currentSong;
    self.musicPlayer.shuffleMode = MPMusicShuffleModeSongs;
    self.musicPlayer.repeatMode = MPMusicRepeatModeAll;

    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback withOptions:nil error:nil];
    [[AVAudioSession sharedInstance] setActive:YES error:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(radioItemDidReachEnd:) name:AVPlayerItemDidPlayToEndTimeNotification object:[_radioPlayer currentItem]];
    [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
    [self becomeFirstResponder];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [self resignFirstResponder];

    if (self.source == LIBRARY)
    {
        [self.parentDelgate reloadInformation];
    }
}

- (void)viewDidAppear:(BOOL)animated
{
    if (self.source == RADIO)
    {
        // Code that sets the URLs for the AVQueuePlayer

        [self initializeMusicPlayer];

        [self prepareRadioPlayer];

    }
    else if ( self.source == LIBRARY ) {
        if ( self.currentSong != self.musicPlayer.nowPlayingItem || self.playlist != nil)
        {
            [self initializeMusicPlayer];
            self.musicPlayer.nowPlayingItem = self.currentSong;
        }
    }
}

- (void)initializeMusicPlayer {
    if ( self.source == LIBRARY )
    {
        [self.musicPlayer setQueueWithItemCollection:[MPMediaItemCollection collectionWithItems:(NSArray *)self.tracks]];

        if ([self.radioPlayer rate] != 0.0)
            [self.radioPlayer pause];

        [self.musicPlayer play];
        self.status = PLAYING;
    }
    else if ( self.source == RADIO )
    {
        if ( self.musicPlayer.playbackState == MPMusicPlaybackStatePlaying )
            [self.musicPlayer pause];
    }
}

- (IBAction)pausePressed:(UIButton *)sender {
    if ( self.source == LIBRARY )
    {
        [self.musicPlayer pause];
    }
    else if (self.source == RADIO)
    {
        [self.radioPlayer pause];
    }

    [self onStatePaused];
}

- (void)onStatePaused {
    // UI Stuff
}

- (void)endSession {
    [self.musicPlayer stop];
    [self.radioPlayer pause];
    [self.radioPlayer removeAllItems];

    // Present different view
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T18:06:51.157

我解决了这个问题。我正在向干扰此的 AVQueuePlayer/AVPlayerItems 添加多个观察者实例。

# javascript - jQuery 连接或选择器问题

> ID：16201739
> 
> 赞同：0
> 
> 时间：2013-04-24T20:39:55.797
> 
> 标签：javascript, jquery, attributes

我有以下内容：

```
changeDegreeLabel: {
        "Certificate" : "Diploma"
}

this.changeDegreeLabel = function(labelReplacements)
{ 
```

这个有效

```
 $.each(labelReplacements, function(oldValue, newValue) {
            $('#programList dt:contains(' + oldValue + ')')
                .text(newValue);
        }); 
```

这个还不行

```
 $.each(labelReplacements, function(oldValue, newValue) {
            $("#program_id>optgroup[label="+oldValue+"]")
                .attr('label', newValue);
        });
 } 
```

基本上，我只想将证书更改为文凭。它适用于第一个功能，但不适用于第二个功能。我尝试了多种不同的引号组合来连接属性选择器中的变量，但无济于事。想法？

编辑：这是“这个还不行”部分的 HTML

```
<select id="program_id" class="required" name="program_id">
<option value="" selected="selected">— Select —&lt;/option>
<optgroup label="Associate">
</optgroup>
<optgroup label="Certificate">
</optgroup> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:42:13.840

您需要在值周围添加引号，例如，您的字符串可能包含空格。您需要使用单引号或转义双引号：

```
$('#program_id>optgroup[label="'+ oldValue +'"]')
 -^-                          -^-          -^--^-

//OR

$("#program_id>optgroup[label=\""+ oldValue +"\"]")
                             -^-             -^- 
```

# haskell - 使用快速检查

> ID：16201741
> 
> 赞同：6
> 
> 时间：2013-04-24T20:40:04.093
> 
> 标签：haskell, ghci, fold, quickcheck

我为 foldl 编写了一个实现并想检查它是否有效，我尝试了一些案例，它似乎运行良好，但我想确定一下。

我阅读了有关 quickCheck 并尝试了它，但我似乎无法使其工作，这是代码

```
foldl'' :: (b -> a -> b) -> b -> [a] -> b

test :: Eq b => (b -> a -> b) -> b -> [a] -> Bool
test f e ls = foldl'' f e ls == foldl f e ls 
```

当我运行`quickCheck test`它时会引发以下错误：

```
No instance for (Show (b0 -> a0 -> b0))
  arising from a use of `quickCheck'
Possible fix:
  add an instance declaration for (Show (b0 -> a0 -> b0))
In the expression: quickCheck prueba
In an equation for `it': it = quickCheck prueba 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T21:47:06.060

您的属性需要三个输入：一个函数、一个元素和一个列表。问题是 QuickCheck 通常不知道如何处理函数。

QuickCheck 需要工作的一件事是能够将失败的测试用例写入控制台。为此，它需要可以在类中变成`String`--anything 的值`Show`。由于函数不在 中`Show`，因此不能将它们用于输入。这就是您的错误消息的来源。

一般来说，使用随机生成的函数进行测试会非常棘手。我只是写一些具体的函数，让 QuickCheck 随机生成起始值和元素列表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-25T02:17:19.993

有一种方法可以避免`Show`使用修饰符对输入的约束[`Blind`](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Modifiers.html#t%3aBlind)，这将允许您使用 QuickCheck 的机制来生成随机函数。

```
-- Using Int instead of a, b which would be defaulted to () in GHCi
prueba :: Blind (Int -> Int -> Int) -> Int -> [Int] -> Bool
prueba (Blind f) e ls = foldl'' f e ls == foldl f e ls 
```

也就是说，这意味着故障输出对于调试几乎没有用，因为它只会打印`(*)`盲输入。（为了演示，我定义了`foldl'' = foldr . flip`）

```
> quickCheck prueba 
*** Failed! Falsifiable (after 4 tests and 2 shrinks):    
(*)
0
[1,0] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T21:47:34.010

据我了解，在 QuickCheck 中有创建随机函数的机制（请参阅[Test.QuickCheck.Function](http://hackage.haskell.org/packages/archive/QuickCheck/2.6/doc/html/Test-QuickCheck-Function.html)），但我不能说我对这些东西的了解足以告诉你如何使用它。

话虽如此，使用您自己选择的功能测试您的属性可能更有意义，因此您可以编写类似 的`quickCheck $ prueba (+)`内容，这样可以正常工作。

# c# - C# 2010，ODP.net，调用存储过程传递数组

> ID：16201743
> 
> 赞同：5
> 
> 时间：2013-04-24T20:40:10.123
> 
> 标签：c#, oracle, odp.net

我有一个需要 4 个输入的 PL/SQL 存储过程。其中一个输入是关联数组（Oracle 类型：PLS_INTEGER 索引的 VARCHAR2(1) 表）。

我想要一个 C# 程序，它使用正确的输入（包括关联数组）调用这个存储过程。

我将 ODP.net 11.2 与 Visual C# 2010 Express 和 Oracle 11gR2 一起使用。

我找不到任何关于如何从 C# 将数组传递给 pl/sql 过程的好例子。谁能给我一个例子？遵循 Oracle 文档准确地给了我错误，说错误的数量或类型的参数。

我的 C# 代码：

```
 OracleCommand cmd = new OracleCommand("begin sdg_test.sdg_test2(:1); end;", conn);

        OracleParameter Param1 = cmd.Parameters.Add("1", OracleDbType.Varchar2);

        Param1.Direction = ParameterDirection.Input;

        Param1.CollectionType = OracleCollectionType.PLSQLAssociativeArray;

        Param1.Value = new string[22] { "Y", "Y", "N", "Y", "N", "Y", "Y", "Y", "Y", "Y", "N", "Y", "N", "Y", "Y", "Y", "Y", "Y", "N", "Y", "N", "Y" };

        Param1.Size = 22;
        Param1.ArrayBindSize = new int[22] { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };

        cmd.ExecuteNonQuery();

        conn.Close();
        conn.Dispose(); 
```

我的程序所做的只是记录一条消息。我只是想让这个概念发挥作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T10:50:46.867

您可以从（更简单的方式）开始：

```
List<int> idList = yourObjectList;
List<int> nameList = yourObjectList;

using (OracleConnection oraconn = new OracleConnection())
{
    oraconn.ConnectionString = "Your_Connection_string";

    using (OracleCommand oracmd = new OracleCommand())
    {
        oracmd.Connection = oraconn;

        oracmd.CommandType = CommandType.StoredProcedure;
        oracmd.CommandText = "Your_Procedura_name";
        oraconn.Open();

        // To use ArrayBinding, you need to set ArrayBindCount   
        oracmd.BindByName = true;
        oracmd.ArrayBindCount = idList.Count;

        // Instead of single values, we pass arrays of values as parameters   
        oracmd.Parameters.Add("ids", OracleDbType.Int32, oyourObjectList.ToArray(), ParameterDirection.Input);
        oracmd.Parameters.Add("names", OracleDbType.Varchar2, oyourObjectList.ToArray(), ParameterDirection.Input);

        oracmd.ExecuteNonQuery();
        oraconn.Close();
    }
} 
```

然后，在 db 中添加包/过程：

```
PROCEDURE Your_Procedure_name(
      name IN VARCHAR2,
      id IN NUMBER
      )    IS     
BEGIN

    INSERT INTO your_table VALUES( id, name);
END Your_Procedure_name; 
```

另一种选择是：

```
using (OracleConnection oraconn = new OracleConnection())
{
    oraconn.ConnectionString = "Your_Connection_string";

    using (OracleCommand cmd = new OracleCommand())
    {

        cmd.Connection = oraconn;

        cmd.CommandType = CommandType.StoredProcedure;
        cmd.CommandText = "Your_Procedure_name";
        oraconn.Open();

        OracleParameter idParam = new OracleParameter("i_idList", OracleDbType.Int32, ParameterDirection.Input);
        idParam.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
        idParam.Value = idList.ToArray();
        idParam.Size = idList.Count;

        OracleParameter nameParam = new OracleParameter("i_nameList", OracleDbType.Varchar2, ParameterDirection.Input);
        nameParam.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
        nameParam.Value = nameList.ToArray();
        nameParam.Size = nameList.Count;

        // You need this param for output
        cmd.Parameters.Add("ret", OracleDbType.RefCursor).Direction = ParameterDirection.Output;
        cmd.Parameters.Add(idParam);
        cmd.Parameters.Add(nameParam);

        conn.Open();

        //If you need to read results ...
        using (OracleDataReader dr = cmd.ExecuteReader())
        {
            while (dr.Read())
            {
                ...
            }
        }
        conn.Close();
    }
} 
```

但它更复杂，因为您需要为存储过程定义新类型，例如

```
TYPE integer_list IS TABLE OF Your_table.id_column%TYPE INDEX BY BINARY_INTEGER;
// same for names 
```

创建一个模式级类型，如

```
create or replace TYPE T_ID_TABLE is table of number; 
```

然后在存储过程中使用它们，比如

```
PROCEDURE Your_Procedure_name(
      v_ret IN OUT SYS_REFCURSOR,
      i_idList integer_list,
      i_nameList string_list)
  IS  
  begin
    -- Store passed object id list to array
 idList T_ID_TABLE := T_ID_TABLE(); 
  ...
  begin

    -- Store passed object id list to array
    idList.Extend(i_idList.Count);
    FOR i in i_idList.first..i_idList.last loop
     idList(i) := i_idList(i);
    END LOOP;    

    ...
END Your_Procedure_name; 
```

# java - 将 Java 字节读取为 CharSet

> ID：16201745
> 
> 赞同：0
> 
> 时间：2013-04-24T20:40:14.870
> 
> 标签：java, character-encoding

具体`CharSet`会影响与每个字节相关的二进制（或整数）值吗？

例子：

```
String original = foo(); // makes string

byte[] utf8Bytes = original.getBytes("UTF8"); // CharSet is UTF8
byte[] defaultBytes = original.getBytes(); // default CharSet 
```

从二进制/整数值点`utf8Bytes[1]`总是相等？`defaultBytes[1]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:43:33.170

它将影响值，并且 UTF-8 并不是所有 JVM 的默认值 - 始终使用`getBytes("UTF-8")`以确保编码一致是一​​个好主意。

例如，使用`getBytes("UTF-8")`和`getBytes("UTF-16")`比较结果（后者的字节数可能是前者的两倍）

# javascript - javascript回调，如何包含附加参数

> ID：16201750
> 
> 赞同：2
> 
> 时间：2013-04-24T20:40:33.560
> 
> 标签：javascript

我有一种情况，我正在使用具有绑定功能的包/插件。

我使用代码调用绑定，该代码是 myevents 触发回调时的过滤器。在这个场景中，将进行三个调用来绑定，一个带有参数“t1”，第二个用于“t2”，第三个用于“t3”。

当从 myevents 对象触发事件时，将使用 data 参数调用回调（取决于代码）。

我的问题是当回调函数被调用时，我需要知道循环最初绑定时的索引号。例如，我在 alert 语句中有 i 变量，但我不知道如何获取那里的值以便在最终触发回调时保存。

似乎会有一些“函数（数据，i）”的组合来实现这一点。

```
bindList = array('t1','t2','t3');

for (var i = 0; i < bindList.length; i++) {
        myevents.bind(bindList[i], function(data) {
            alert('data arrive on item ' + i + ': ' + data);
        });
    } 
```

我将不胜感激任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:42:44.083

使用闭包。由于 JS 变量是“函数范围的”，因此at 0在迭代中的任何点都`i`指代相同的变量。`i`我们需要为每次迭代创建一个范围，以便绑定代码引用闭包`i`而不是循环的`i`.

```
for (var i = 0; i < bindList.length; i++) {
  (function(i){
    myevents.bind(bindList[i], function(data) {
      alert('data arrive on item ' + i + ': ' + data);
    });
  }(i));
} 
```

# perl - mysqldump 输出到 log4perl

> ID：16201751
> 
> 赞同：0
> 
> 时间：2013-04-24T20:40:36.597
> 
> 标签：perl, mysqldump, stderr, log4perl

我有一个 Perl 脚本，它使用 log4perl 将所有内容记录到文件中。log4perl 的配置存储在一个外部文件中。

此脚本使用 qx 运行 mysqldump 命令。mysqldump 命令的输出打印到屏幕（我假设 STDERR），但不打印到日志文件。

我想将 mysqldump（以及任何其他打印到屏幕的 stmt）的输出定向到 log4perl 日志文件。

我不确定这是否涉及使用 qx 以外的东西，或者更改 log4perl 配置。

注意：我在网上看到过一些这样的例子，但它们都使用 log4perl easy-config。

这是 log4perl 配置文件 -

```
log4perl.rootLogger              = DEBUG, SCREEN, file
log4perl.appender.SCREEN         = Log::Log4perl::Appender::Screen
log4perl.appender.SCREEN.stderr  = 0
log4perl.appender.SCREEN.layout  = Log::Log4perl::Layout::PatternLayout
log4perl.appender.SCREEN.layout.ConversionPattern = %d %r %p %F{1} %M{1}.%L - %m%n
log4perl.appender.file          = Log::Log4perl::Appender::File
log4perl.appender.file.filename = log/mbackup.log
log4perl.appender.file.mode     = append
log4perl.appender.file.layout   = Log::Log4perl::Layout::PatternLayout
log4perl.appender.file.layout.ConversionPattern = %d %r %p{5} %F{1} %M{1}.%L - %m%n 
```

这是 perl 脚本 -

```
use strict;
use warnings 'FATAL' => 'all';
use Sys::Hostname;
use Log::Log4perl;

my $log_conf = "log4perl.conf";
Log::Log4perl::init($log_conf);
my $logp        = Log::Log4perl->get_logger();
my $dirTemp     = "temp";
my $fileTemp    = "temp_backup.gz";
my $dbSchema = 'test';
my $dbToken01 = 'root';
my $dbToken02 = 'haha';

sub create_backup {
    $logp->info("creating temp mysqldump...");
    my $backupCmd = "mysqldump -R --triggers -u $dbToken01 -p$dbToken02 -v --quick --single-transaction $dbSchema | gzip > $dirTemp/$fileTemp";
    qx($backupCmd);
}

#main
$logp->info("start backup script");
eval {
    create_backup();
};
if ($@) {
    $logp->error( 'error: ', $@ );
}
$logp->info("end backup script"); 
```

这是脚本输出 -

```
[root@localhost perl]# perl test.pl
2013/04/24 16:35:33 3 INFO test.pl main::.22 - start backup script
2013/04/24 16:35:33 4 INFO test.pl create_backup.16 - creating temp mysqldump...
-- Connecting to localhost...
-- Disconnecting from localhost...
2013/04/24 16:35:33 22 INFO test.pl main::.29 - end backup script 
```

澄清 - 当我说输出时，我指的是 mysqldump 命令的 stderr 输出。我希望将写入屏幕上的 mysqldump 命令的所有文本输出发送到 log4perl 日志文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:25:53.687

如果你想同时做：记录你可以做这样的`mysqldump`事情`gzip`：

通过修改`sub create_backup`

```
sub create_backup {
    my $sqlDumpFile = "$dirTemp/$fileTemp";
    $logp->info("creating temp mysqldump...");

    my $backupCmd = "mysqldump -R --triggers -u $dbToken01 -p$dbToken02 -v --quick --single-transaction $dbSchema 2>&1 | tee $sqlDumpFile";
    my $dumpOutput = `$backupCmd`;
    $logp->info($dumpOutput);
    `gzip $sqlDumpFile`; # note you will have renamed this file to "filename".gz
} 
```

*更新*

如果你只想记录错误，那么你可以做这样的事情。

[`IPC::Run`](http://search.cpan.org/~toddr/IPC-Run-0.92/lib/IPC/Run.pm)可以让您在这里的生活更轻松。

```
sub create_backup {
    require IPC::Run qw(run); # or load this at the top of you script...
    my ($in, $out, $err);
    my $backupCmd = "mysqldump";
    my $sqlDumpFile = "$dirTemp/$fileTemp";

    $logp->info("creating temp mysqldump...");

    run([$backupCmd, '-R', '--triggers', '-u', $dbToken01, '-p', $dbToken02, 
      '-v', '--quick', '--single-transaction', $dbSchema, '>', $sqlDumpFile],
      \$in, \$out, \$err);

    if( $err ) {
        $logp->info($err);
        # do other stuff?
        # Eg. `unlink($sqlDumpFile);            
    } else {
        `gzip $sqlDumpFile`; # note you will have renamed this file to "filename".gz
    }
} 
```

# php - php计算过去每一天的成本

> ID：16201755
> 
> 赞同：0
> 
> 时间：2013-04-24T20:40:47.893
> 
> 标签：php, mysql

```
 $1date =$row['Date1'];
     $2date = $row['Date2'];
       $datediff = $1date - $2date;
echo $datediff; 
```

我想计算之间的天数并将结果放入表格中（过去每天 10 美元）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:50:48.237

您可以在 MySQL 中执行此操作，然后将其转换为变量。进行初始呼叫

```
SELECT TIMESTAMPDIFF('Date1','Date2'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:50:51.507

```
// convert to unix timestamp
$1date = strtotime($row['Date1']);
$2date = strtotime($row['Date2']);

// 86400 seconds in a day
// floor to round down, change to ceil to round up
$datediff = floor(($1date - $2date) / 86400);

$cost = $days * 10; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:45:53.880

尝试：

```
$days = date_diff(date_create($row['Date1']), date_create($row['Date2']))->format('%a');
$cost = $days * 10; 
```

# mysql - 根据与用户关联的项目获取数据列表

> ID：16201761
> 
> 赞同：0
> 
> 时间：2013-04-24T20:41:02.360
> 
> 标签：mysql, sql

我有一张桌子叫`reviews`. 我得到最新的用户评论是这样的：

```
SELECT b.item, b.item_id, a.review_id, a.review, c.category, u.username, c.cat_id 
FROM reviews a
INNER JOIN items b
     ON a.item_id = b.item_id
INNER JOIN master_cat c
     ON c.cat_id = b.cat_id
INNER JOIN users AS u
     ON u.user_id = a.user_id               
ORDER BY a.review_id DESC; 
```

我想要做的是稍微改变它，使其对用户更人性化。

我有另一个用户“连接”表。有点像推特。当用户关注某人时，它会登录到名为`profile_follow`. 这有三列。 `id`, `user_id`, `follow_id`. 简单地说：如果我是用户 #1，并且我“关注”用户 #3 和用户 #5，则此表中将添加两行：

```
 profile_follow
------------------------
id | user_id | follow_id
   | 1       | 3
   | 1       | 5 
```

这是我想要更改上面的查询的方式。我只想显示**您关注的人的**最新评论。

因此，对于 table ，我至少需要一个连接`profile_follow`。而且我需要传入一个 user_id（它是一个`php`函数），执行类似 `WHERE profile_follow.user_id = '{$user_id}' 之类的操作。我想我将不得不对此添加一个子查询，而不是使用。

*有人可以告诉我如何完成这个查询吗？*我不知道如何从这里处理它？到目前为止，我所有的尝试都失败了。

我想我需要做类似的事情：

`Select`follow_id 用户`where`ID`= (logged in user)`

然后在主查询中：

`Select reviews only with profile_follow.follow_id = review.user_id.`

我不知道如何使这个过滤器工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:55:03.307

没有测试总是很困难，但是：

```
SELECT b.item, b.item_id, a.review_id, a.review, c.category, u.username, c.cat_id 
FROM reviews a
INNER JOIN items b
     ON a.item_id = b.item_id
INNER JOIN master_cat c
     ON c.cat_id = b.cat_id
INNER JOIN profile_follow pf
     ON pf.follow_id = a.user_id
WHERE profile_follow.user_id = '{$user_id}'
ORDER BY a.review_id DESC; 
```

# ios5 - iPhone应用程序启动图像上的不同纹理？

> ID：16201765
> 
> 赞同：0
> 
> 时间：2013-04-24T20:41:12.517
> 
> 标签：ios5, ios6, uinavigationbar

我正在尝试制作一个与应用程序上的第一个屏幕非常相似的启动屏幕。但是，我注意到 iOS 5 和 6 导航栏的“纹理”略有不同。

有没有办法根据版本显示不同的启动图像，或者确实有另一种方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:23:23.477

答案是“不”。理想情况下，您应该能够在 info.plist 中设置“UILaunchImageFile”键值。但是由于没有这样的预定义密钥来获取设备的当前操作系统版本，因此您将无法指定任何动态文件名。

# paypal - 贝宝虚拟终端问题

> ID：16201766
> 
> 赞同：1
> 
> 时间：2013-04-24T20:41:12.857
> 
> 标签：paypal, paypal-sandbox

首先，我如何使用我的沙盒帐户访问虚拟终端？我曾尝试前往“我的销售工具”区域，但它从未加载过。我想可能是 Chrome，所以我尝试了 IE10 和 FireFox。IE10 根本无法加载 PayPal 开发者页面，而 FireFox 与 Chrome 完全一样。

其次，使用虚拟终端，有没有办法自定义字段？我们有几十个网站将使用主帐户，但我们希望能够通过网站区分付款。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:42:46.053

您可以通过几种不同的方式从沙箱中访问虚拟终端。最直接的方法是在您登录后，在页面中间的主页上应该有一个“工具”部分。在本节中，您应该会看到虚拟终端的链接。如果您单击此链接，它将带您到虚拟终端。

至于您的第二个问题，您将无法自定义虚拟终端页面。如果您正在寻找定制的外观，您可能希望按照您希望的方式构建您自己的界面。然后在后台，当您填写客户信息并点击提交时，该页面将使用 DoDirectPayment API。这将为您提供类似于虚拟终端的界面，并且可以像虚拟终端一样工作。

# java - 我将如何在循环中循环一个值？

> ID：16201767
> 
> 赞同：-2
> 
> 时间：2013-04-24T20:41:14.193
> 
> 标签：java, arrays, loops

因此，如果这看起来像是在要求您做作业，我深表歉意……我保证不是，我只是需要一些帮助，因为我以前从未使用过多维数组。我会问一个朋友或我的老师......但它是一个在线课程，因此得到回应......需要更长的时间然后从这里等待一个。到目前为止......我是唯一参加这门课程的人，所以朋友们对这些东西一无所知等等等等。所以......好吧，这个程序正在制作中......但我只是担心到目前为止，关于第一步，在他们的名字旁边列出每个学生和他们的 4 个分数。

前任。

```
John Smith 67 87 56 97

Jane Doe 87 56 76 92 
```

等等等等等等

所以这就是目标。很简单……至少我是这么想的。下面是我的一些变量...

```
public class StudentGradesView extends FrameView {

    int [][] aryStudent = new int [15][4]; //This is for the 15 students that can be inputted and 4 marks each.
    int numOfStudents = 0; //number of students start of at zero until inputted...
    int marks = 0; // not in use at this given moment

public StudentGradesView(SingleFrameApplication app) {

//unimportant....

}

 private void addButtonActionPerformed(java.awt.event.ActionEvent evt) {                                          

        numOfStudents ++;
        String currentList = studentListField.getText();

        //This picks up the four different marks from four different Fields...

        aryStudent[numOfStudents][0] = Integer.parseInt(test1Field.getText());
        aryStudent[numOfStudents][1] = Integer.parseInt(test2Field.getText());
        aryStudent[numOfStudents][2] = Integer.parseInt(test3Field.getText());
        aryStudent[numOfStudents][3] = Integer.parseInt(test4Field.getText());

        //now the problem is when I press the add button which adds student names and mark) it only inputs 
        //the name and the last mark inputted in the test4field. What am I missing that loops all the grades from test1Field - test4Field?

    for (int x=0; x < numOfStudents ; x++) {
        for (int y=0; y < 4; y++) {

        studentListField.setText("" + firstNameField.getText() + " " + lastNameField.getText() + " " + aryStudent[numOfStudents][y] + "\n" + currentList);

        }
        System.out.println("");
    } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:51:44.473

连接一个字符串并在你建立它之后将它显示在 studentListField 中。现在，您只是将最后显示的成绩替换为当前成绩，所以从用户的角度来看，您只会看到最后一个成绩，是吗？

```
for(int x = 0; x < numOfStudents; x++)
{
    String str = firstNameField.getText() + " " + lastNameField.getText();
    for(int y = 0; y < 4; x++)
    {
        str = str + " " + aryStudent[x][y];
    }
     studentListField.setText(str);
} 
```

要么这个解决方案是正确的，要么你将不得不更好地解释一下（准确描述你的期望和实际发生的事情），我将不得不喝更多的咖啡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:51:57.533

已编辑：如果您想在文本字段中打印所有学生和成绩，那么您可能还需要一些地方来记住学生姓名（以及成绩），对吗？将其声明为：

```
String[] studentNames=new String[15]; 
```

然后，按下按钮后，还将名称添加到数组中：

```
studentNames[numOfStudents] = firstNameField.getText() + " " + lastNameField.getText(); 
```

最后，使用 a[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)构建您的字符串，然后将其设置为文本字段：

```
 numOfStudents++; // only increase the count right before the loop, after you've added the new student to the arrays. 

StringBuilder sb = new StringBuilder();

for (int x=0; x < numOfStudents ; x++) {
    sb.append(studentNames[x]);
    for (int y=0; y < 4; y++) {
        sb.append(" " + aryStudent[x][y]);
    }     
    sb.append("\n");   
} 
studentListField.setText(sb.toString()); 
```

# jquery - Bootstrap动态工具提示绑定到输入字段？

> ID：16201771
> 
> 赞同：1
> 
> 时间：2013-04-24T20:41:37.783
> 
> 标签：jquery, twitter-bootstrap

我有一系列名为 price1[324]、price2[324]、price3[324] 的输入字段，我想根据它们的输入值生成工具提示，例如**，如果客户输入 100，他们将看到 80。**

我试图让这个工作，但不能让工具提示以任何方式成为动态的。

[http://jsfiddle.net/CtFrx/5/](http://jsfiddle.net/CtFrx/5/)

这是基本形式：

```
<input type="text" id="nav-search" name="price1[324]" rel="tooltip" />
<input type="text" id="nav-search" name="price2[324]" rel="tooltip" />
<input type="text" id="nav-search" name="price3[324]" rel="tooltip" /> 
```

这是基本的Javascript：

```
$('body').tooltip({
    selector: '[rel=tooltip]'
});

$("#nav-search").tooltip('hide')
    // The following does NOT work
    //.attr('data-original-title', 'You receive ' + ($(this).val() * .8) )

    // The following DOES work
    .attr('data-original-title', '80' )
    .tooltip('fixTitle')
    .tooltip('show'); 
```

我也无法引用动态命名的字段，但我认为这是一个单独的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:28:35.073

将输入ID更改为类并尝试以下操作：

```
$('body').tooltip({
    selector: '[rel=tooltip]'
});

$('.nav-search').tooltip();

$('.nav-search').on({
        focus:
           function()
           {
               $(this).attr('data-original-title', 'You receive ' + ($(this).val() * .8) )
                .tooltip('fixTitle')
                .tooltip('show');
           }
       }
    ); 
```

[http://jsfiddle.net/CtFrx/19/](http://jsfiddle.net/CtFrx/19/)

# wpf - 在 shift 双击时显示对话框

> ID：16201772
> 
> 赞同：0
> 
> 时间：2013-04-24T20:41:39.830
> 
> 标签：wpf, dialog, command, mouseevent, routed-commands

我的 WPF 应用程序中有一个`TextBlock`控件。当用户按住 shift 键并右键双击它时，我想显示一个“复活节彩蛋”。

我`RoutedUiCommand`在我的应用程序中添加了一个静态类，在该类中定义了所有命令。我为我的新命令添加了一个命令绑定：

```
<UserControl.CommandBindings>
    <CommandBinding CanExecute="ShowDiagnostics_CanExecute" Command="cs:CarSystemCommands.ShowDiagnostics"  Executed="ShowDiagnostics_Executed" />
</UserControl.CommandBindings> 
```

当我创建 时`RoutedUiCommand`，我指定了 a `MouseGesture`of`RightDoubleClick`和 a `ModifierKey`of `Shift`。到目前为止，一切都很好。

如何将命令与`TextBlock`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T08:25:06.323

您可以使用此处描述的 InputBindings 和 MouseBinding：http: [//thejoyofcode.com/Invoking_a_Command_on_a_Double_Click_or_other_Mouse_Gesture.aspx](http://thejoyofcode.com/Invoking_a_Command_on_a_Double_Click_or_other_Mouse_Gesture.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:13:13.960

将[InputBinding](http://msdn.microsoft.com/en-us/library/system.windows.input.inputbinding.aspx)放在将调用命令的文本块上怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:52:02.100

我最终做的是把`CommandBinding`从`UserControl.Resources`移到`TextBlock`：

```
<TextBlock ...>
    <TextBlock.CommandBindings>
        <CommandBinding CanExecute="ShowDiagnostics_CanExecute" Command="cs:CarSystemCommands.ShowDiagnostics"  Executed="ShowDiagnostics_Executed" />
    </TextBlock.CommandBindings>
</TextBlock> 
```

现在，直到您按住 shift 键并右键双击`TextBlock`.

我给其他答案投票，因为它们也会起作用。

# c# - 如何在 WPF 中获取“选定的菜单项”

> ID：16201773
> 
> 赞同：6
> 
> 时间：2013-04-24T20:41:41.550
> 
> 标签：c#, xaml, wpf-controls

我想知道如何从菜单中获取“选定”菜单项。基本上，我想获得“选定的”MenuItem，这样我就可以对我的 ListBox 进行排序。这是我的菜单 XAML。

```
<Menu>
    <MenuItem Header="Sort by" ItemsSource="{Binding SortByOptions}"
                            *SelectedItem="{Binding GroupBy}"*/>
</Menu> 
```

我用菜单切换了我的组合框，但在菜单中，“SelectedItem”不像在组合框中那样存在。我想知道我怎样才能从菜单中选择什么项目。

**C＃**

ItemsSource 绑定“SortByOptions”是包含要排序的选项的字符串的 ObservableCollection。绑定“GroupBy”是每次用户选择另一个菜单项时设置的字符串。

每次用户选择另一个菜单项时，我都在搜索设置变量“GroupBy”。

以前，我的 ComboBox 运行良好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-14T21:04:04.740

**解决方案**

我需要像这样指定属性“Command”和“CommandParameter”的样式：

```
<Menu Layout="Text" Margin="10,0,0,0">
  <MenuItem Header="Group by" ItemsSource="{Binding GroupByOptions}">
    <MenuItem.ItemContainerStyle>
      <Style TargetType="{x:Type MenuItem}">
        <Setter Property="Command"
                Value="{Binding ViewModel.GroupCommand, RelativeSource={RelativeSource AncestorType={x:Type Views:MyView}}}" />
        <Setter Property="CommandParameter" Value="{Binding}" />
      </Style>
    </MenuItem.ItemContainerStyle>
  </MenuItem>
</Menu> 
```

请注意，CommandParameter 是用户选择的实际“标题”。（这就是我要搜索的内容）我不知道，但是当您执行 {Binding} 时，它需要实际的字符串。

在我的 ViewModel 中，它看起来是这样的：

```
private ICommand mSortCommand;
//Implement get and set with NotifyPropertyChanged for mSortableList
private ICollectionView mSortableList; 

public ICommand SortCommand
{
  get { return mSortCommand ?? (mSortCommand = new RelayCommand(SortMyList)); } 
}

public void SortMyList(object sortChosen)
{
  string chosenSort = sortChosen as string;
  CampaignSortableList.SortDescriptions.Clear();
  Switch(chosenSort){
    "Sort my List"
  }
  CampaignSortableList.Refresh();
} 
```

现在一切正常。

# windows - （Cygwin - make）文件无法识别：文件格式无法识别collect2：ld返回1退出状态

> ID：16201775
> 
> 赞同：0
> 
> 时间：2013-04-24T20:41:46.213
> 
> 标签：windows, terminal, makefile, cygwin

我正在使用 Cygwin（在 Windows 7 中）模拟 Linux 终端，但是，当我对其中一个文件执行“make”时，出现以下错误，（请注意，这在 Linux 终端中有效）

```
cd ./agents/randomAgentJava/ && make
make[1]: Entering directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/randomAgentJava'
javac -source 5 -d bin -cp ../../system/libraries/RLVizLib.jar src/RandomAgent/RandomAgent.java
warning: [options] bootstrap class path not set in conjunction with -source 1.5
1 warning
make[1]: Leaving directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/randomAgentJava'
cd ./agents/randomAgentCPP/ && make
make[1]: Entering directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/randomAgentCPP'
make[1]: Nothing to be done for `all'.
make[1]: Leaving directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/randomAgentCPP'
cd ./agents/mountainCarAgentCPP/ && make
make[1]: Entering directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/mountainCarAgentCPP'
make[1]: Nothing to be done for `all'.
make[1]: Leaving directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/mountainCarAgentCPP'
cd ./agents/realTimeStrategyAgentJava/ && make
make[1]: Entering directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/realTimeStrategyAgentJava'
javac src/**/*.java -d bin -cp ../../system/libraries/RLVizLib.jar
make[1]: Leaving directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/realTimeStrategyAgentJava'
cd ./agents/helicopterAgentCPP/ && make
make[1]: Entering directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/helicopterAgentCPP'
g++ -c -I../../system/RL-Glue/RL-Glue -I../../system/RL-Glue/Utils -I./src src/weak_baseline_controller.cpp -o bin/weak_baseline_controller.o
g++ -o ./bin/RL_agent bin/weak_baseline_controller.o bin/Glue_utilities.o bin/RL_client_agent.o bin/RL_network.o -lm
bin/Glue_utilities.o: file not recognized: File format not recognized
collect2: ld returned 1 exit status
Makefile:25: recipe for target `bin/RL_agent' failed
make[1]: *** [bin/RL_agent] Error 1
make[1]: Leaving directory `/cygdrive/f/Linux Files/Helicopter_Control/rl-competition/agents/helicopterAgentCPP'
Makefile:13: recipe for target `all' failed
make: *** [all] Error 2 
```

提前致谢！

# vba - 以编程方式在 Excel 中按多个字段值进行分组、计数和复制

> ID：16201777
> 
> 赞同：1
> 
> 时间：2013-04-24T20:41:55.573
> 
> 标签：vba, excel, for-loop

您好我有一个电子表格，我需要根据多个值进行计数和分组。使用下面的示例，仅当 Shipper - Shipper city、Recipient 和 Recipient city 都相同时，我才需要它来计算一行。否则我需要它来创建一个新条目。

除了计数之外，如果可能的话，我必须以编程方式而不是使用数据透视表，因为它将经常从 SQL DB 更新并由各种用户通过按钮控制。我已经使用 VBA 在这里获取数据，但我不知道如何继续进行排序/分组。

我尝试了一个带有嵌套条件的 for 循环，但对 VBA 还是很陌生，所以我收效甚微。

表格当前的外观；

```
# - Shipper - City -  Recipient - City     -   Bool
1   Bob       L.A.    Jenny      Las Vegas    True
2   Bob       L.A.    Jenny      Las Vegas    False
3   Bob       L.A.    Jenny      Portland     True
4   Bob       L.A     Jenny      Orem         True
5   Bob       L.A     Jenny      Orem         True
6   Sam       L.A     Jenny      Portland     True
7   Sam       L.A     Jenny      Portland     True
8   Sam       L.A     Jenny      Reno         False
9   Sam       L.A     Jenny      Reno         False 
```

最终结果应该在一张新纸上；

```
# - Shipper - City -  Recipient - City     -   Count - Bool
1   Bob       L.A.    Jenny      Las Vegas      2     50%
2   Bob       L.A.    Jenny      Portland       1     100%
3   Bob       L.A.    Jenny      Orem           2     100%
4   Sam       L.A     Jenny      Portland       2     100%
5   Sam       L.A     Jenny      Reno           2     0% 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T15:21:39.747

假设您的数据如下所示

![在此处输入图像描述](https://i.stack.imgur.com/NHXzM.png)

您现在要做的就是将以下代码粘贴到模块中并运行它。输出将显示在新工作表中。您不必担心增加/减少数据中的行数。只需确保数据在列 A 到 E 中，并且从第一行开始，如上面的屏幕截图所示。否则，您将不得不修改宏。

**逻辑（代码的作用）**：

1.  仅将 Col 复制`A-D`到新工作表
2.  使用内置`.RemoveDuplicates`删除过多数据
3.  用于`COUNTIFS()`统计记录数并在 Col E 中显示
4.  然后再用Col`COUNTIFS()`来统计个数并显示`TRUE``F`
5.  用于`COUNTIFS()`统计个数`FALSE`并以Col显示`G`
6.  在 Col`H`中，找到百分比。完成后，将其转换为值
7.  删除 Col F 和 Col G
8.  `G`将 Col （现在的 Col `F`）格式化为`%`

**代码**：

```
Sub Sample()
    Dim ws As Worksheet, wsOutput As Worksheet
    Dim lRow As Long

    Set ws = ThisWorkbook.Sheets("Sheet1")
    Set wsOutput = ThisWorkbook.Sheets.Add

    With wsOutput
        ws.Range("A:D").Copy .Range("A:D")

        .Range("A:D").RemoveDuplicates Columns:=Array(1, 2, 3, 4), Header:=xlYes

        lRow = .Range("A" & .Rows.Count).End(xlUp).Row

        .Range("E2:E" & lRow).Formula = "=COUNTIFS(" & ws.Name & "!A:A,A2," & _
                                                       ws.Name & "!B:B,B2," & _
                                                       ws.Name & "!C:C,C2," & _
                                                       ws.Name & "!D:D,D2)"

        .Range("F2:F" & lRow).Formula = "=COUNTIFS(" & ws.Name & "!A:A,A2," & _
                                                       ws.Name & "!B:B,B2," & _
                                                       ws.Name & "!C:C,C2," & _
                                                       ws.Name & "!D:D,D2," & _
                                                       ws.Name & "!E:E,""TRUE"")"

        .Range("G2:G" & lRow).Formula = "=COUNTIFS(" & ws.Name & "!A:A,A2," & _
                                                       ws.Name & "!B:B,B2," & _
                                                       ws.Name & "!C:C,C2," & _
                                                       ws.Name & "!D:D,D2," & _
                                                       ws.Name & "!E:E,""FALSE"")"

        .Range("H2:H" & lRow).Formula = "=F2/SUM(F2:G2)"
        .Range("H2:H" & lRow).Value = .Range("H2:H" & lRow).Value

        .Columns("F:G").Delete Shift:=xlToLeft
        .Columns("F:F").NumberFormat = "0%"
        .Cells(1, 5).Value = "Count": .Cells(1, 6).Value = "BOOL"
    End With
End Sub 
```

**输出**：

![在此处输入图像描述](https://i.stack.imgur.com/mmhDL.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:11:07.110

您可以使用 SUMPRODUCT 函数，例如

```
=SUMPRODUCT((A1:A500="Bob")*(B1:B500="L.A")*(D1:D500="Las Vegas")*1) 
```

数据透视表也是一个不错的选择...

[]的

# php - 使用 PHP 更新 MySQL 数据库

> ID：16201779
> 
> 赞同：1
> 
> 时间：2013-04-24T20:42:07.027
> 
> 标签：php, mysql

基本上我正在尝试使用 PHP 来更新 MySQL 数据库，并且我正在使用 HTML 表单对其进行测试。

我打算在 android 应用程序中使用它，以便从中获取值，但目前我只是使用 HTML 表单进行测试以测试 PHP 代码。当我使用 HTML 表单进行测试时，当前没有更新相应的数据。

我的代码有什么问题导致这种情况？

PHP代码：

```
/*
* Following code will create a new product row
* All player details are read from HTTP Post Request
*/

// array for JSON response
$response = array();

// check for required fields
if (isset($_POST['PlayerID']) && isset($_POST['Score']) && isset($_POST['LastHolePlayed'])&&     
isset($_POST['Overall'])) {

$playerid = $_POST['PlayerID'];
$score = $_POST['Score'];
$lastholeplayed = $_POST['LastHolePlayed'];
$overall = $_POST['Overall'];

// include db connect class
require('db_connection.php');

// mysql inserting a new row
$result = mysql_query("UPDATE `week1` SET Score = `$score`, LastHolePlayed = `$lastholeplayed`, 

Overall` = $overall` WHERE PlayerID = `$playerid`");

// check if row inserted or not
if ($result) {
    // successfully inserted into database
    $response["success"] = 1;
    $response["message"] = "Player successfully added.";

    // echoing JSON response
    echo json_encode($response);
} else {
    // failed to insert row
    $response["success"] = 0;
    $response["message"] = "An error occurred.";

    // echoing JSON response
    echo json_encode($response);
}
} else {
// required field is missing
$response["success"] = 0;
$response["message"] = "Required field(s) is missing";

// echoing JSON response
echo json_encode($response);
} 
```

html代码：

```
<form action="http://localhost/realdeal/updateplayer.php" method="POST">
PlayerID <input type="text" id='PlayerID' name='PlayerID'><br/><br/>
Score <input type="text" id='Score' name='Score'><br/><br/>
LastHolePlayed <input type="text" id='LastHolePlayed' name='LastHolePlayed'><br/><br/>
Overall <input type="text" id='Overall' name='Overall'><br/><br/>

    &nbsp;  <input type="submit" value="submit">

</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:45:47.137

将您的查询更改为：

```
$result = mysql_query("UPDATE `week1` SET `Score` = '$score', `LastHolePlayed` = '$lastholeplayed', `Overall` = '$overall' WHERE `PlayerID` = '$playerid'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:04:35.950

你的sql语句是错误的。您可以按上述方式编写，也可以直接将不带撇号的语句编写为 - $result = mysql_query("UPDATE week1 SET Score=$score, LastHolePlayed=$lastholeplayed,Overall=$overall WHERE PlayerID=$playerid");

此外，您能否解释“未更新适当的数据”是什么意思。如果你给出/说明你得到的错误会更清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:00:49.167

您的查询分隔符需要更正：

```
$result = mysql_query("UPDATE `week1` SET Score = '$score', `LastHolePlayed` = '$lastholeplayed', `Overall` = '$overall' WHERE `PlayerID` = '$playerid'"); 
```

请注意列和表名称周围的反引号 (`) 以及值周围的单引号 (')。

此外，在调试查询时，请始终检查 MySQL 错误：

```
$result mysql_query(...) or die("Query failed: " . mysql_error() ); 
```

最后，您应该知道您的查询会使您容易受到 SQL 注入攻击。在将其包含在查询中之前，请始终清理您的输入数据。

# c++ - 编写一个可以与多个版本的 Tcl 一起工作的 Tcl 扩展

> ID：16201783
> 
> 赞同：0
> 
> 时间：2013-04-24T20:42:15.493
> 
> 标签：c++, dll, visual-studio-2012, tcl, compatibility

在我的公司，我们目前正在使用 Tcl 8.4，我们希望更新到 8.6。我们想要做到这一点的方法是编写所有新的 C++ 扩展以与 8.6 和 8.4 兼容，以便所有新扩展都可以在我们由于兼容性问题而无法更新到 8.4 的旧测试仪上运行。

有没有办法编写代码或配置 VS 2012 以便 dll 检测 Tcl 的版本并动态加载它需要的库？

如果我使用茶壶扩展架构，我会得到相同的结果吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T08:12:54.967

# flash - 多人Flash测验AS2

> ID：16201786
> 
> 赞同：0
> 
> 时间：2013-04-24T20:42:38.700
> 
> 标签：flash, actionscript-2, multiplayer

我正在使用 AS 2 进行基于 Flash Web 的测验。我使用 Adob​​e Flash cs3、sql 数据库和 PHP 进行连接。但是对于问题和答案的选择，我使用的是我从 sql 数据库生成的 XML。

游戏规则就像谁想成为亿万富翁..我已经完成了单人模式游戏..这是问题所在，我必须开发它，这样我们才能玩多人模式..哪里可以处理 2 个或多个相同的玩家问题，他们可以在游戏结束时将自己的分数与其他人进行比较。

老实说，我对多人游戏的东西很盲目。我已经下载了许多多人游戏的教程和免费模板，但所有这些都很难理解，而且其中许多人使用 AS3。

请帮忙，或者给我一些关于这个多人游戏的想法。无论如何，对不起我的语法，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:15:27.337

好吧，尽管在这种情况下使用 as3 会容易得多，因为它可以读取二进制套接字和 xml 套接字，但还是有一些针对 as2 的解决方案。

由于您从未使用过这些东西，因此您肯定想要一个中央服务器进行通信，而不是试图通过尝试制作 p2p 游戏来破解您的方式。已经实现了一些多人游戏 API。

我知道有一些支持 as2 的可用多人 api，请查看：

*   [nonoba 多人游戏 api](http://www.nonoba.com/developers/documentation/multiplayerapi/ "nonoba 多人游戏 api")
*   [智能狐狸服务器](http://www.smartfoxserver.com/ "智能狐狸服务器")

如果您像[这样](http://www.google.com/search?q=as2%20smartfox)或[这样](http://www.google.com/search?q=as2%20nonoba)进行搜索，您不仅会获得 API/文档，还会获得大量教程。

好吧，尽情探索吧！

# jquery - Firefox Jquery 计算错误

> ID：16201788
> 
> 赞同：0
> 
> 时间：2013-04-24T20:42:42.687
> 
> 标签：jquery, firefox

我在 jquery 中创建了一个滑块，它`.slides-container`根据单击的链接移动。这在除 Firefox(20.0) 之外的所有主流浏览器（甚至 ie9）中都能很好地工作。问题似乎是 Firefox 忽略了填充，`.info-container`因为当我禁用填充时，一切正常。如何告诉 jquery`.info-container`在进行计算时确认填充而不弄乱其他浏览器？任何人都知道如何解决它？

**JS**

```
var contentwidth = parseInt($('.slides-content').innerWidth(), 10);
$('.slides-container').css({'width': $('.info-container').length*contentwidth});
$('.info-container').css({'width': contentwidth}); 
```

**HTML**

```
<div class="slides-content clearfix">
                <div class="slides-container">
                    <div class="info-container me clearfix">
                        <div class="info"><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Rem, aliquam amet minus porro animi assumenda error esse sit explicabo quam quisquam ipsum nihil dignissimos. Dolorem quisquam quaerat maiores ducimus optio.</p></div>
                    </div>
                    <div class="info-container pics clearfix">
                        <div class="info"><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Corrupti, asperiores, fugit, necessitatibus officia facere tempora ad officiis sed est architecto voluptatibus enim in. Aspernatur amet fugiat repellat incidunt placeat voluptas.</p></div>
                    </div>
                    <div class="info-container about clearfix">
                        <div class="info"><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quas, et perspiciatis quasi voluptatem maxime vero dolores iusto fugiat corporis ducimus cum at consectetur repellat culpa eius blanditiis ut? Eaque, assumenda?</p></div>
                    </div>
                </div>
            </div> 
```

**CSS**

```
.slides-content {
    overflow: hidden;
    width: 100%;
}
.slides-container {
    overflow: hidden;
    position: relative;
}
.info-container {
    padding: 35px;
    position: relative;
    background-color: #F8F8F8;
    color: #7F7F7F;
    font-size: 17px;
    float: left;
    line-height: 19px;
    font-weight: 300;
    .info {
        position: relative;
        float: left;
    }
} 
```

**错误** ![在此处输入图像描述](https://i.stack.imgur.com/luvEg.png) **更正** ![在此处输入图像描述](https://i.stack.imgur.com/meu6J.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:02:47.273

检查 info 和 info-container 的内部宽度是否相同。

# java - 为什么我的 RadioGroup 返回“假”

> ID：16201791
> 
> 赞同：0
> 
> 时间：2013-04-24T20:42:45.797
> 
> 标签：java, android, dialog, radio-button

我有一个包含两个 RadioButtons 的 RadioGroup 的自定义对话框。选择的 RadioButton 确定要设置的字符串。当我做

```
 Toast.makeText(NewFile.this, checkedId, Toast.LENGTH_LONG)
                            .show(); 
```

无论选择哪个 RadioButton，它都会将 checkedId 显示为 false，并且只有第二种情况将 String 设置为正确的值。以下是我目前的代码：

```
AlertDialog.Builder customDialog = new AlertDialog.Builder(NewFile.this);
        LayoutInflater layoutInflater = (LayoutInflater) getApplicationContext()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View view = layoutInflater.inflate(R.layout.jquery_dialog, null);
        final EditText idTxt = (EditText) view.findViewById(R.id.idName);
        final CheckBox headerChk = (CheckBox) view.findViewById(R.id.headerChk);
        final CheckBox footerChk = (CheckBox) view.findViewById(R.id.footerChk);
        final RadioGroup group = (RadioGroup) view
                .findViewById(R.id.jqmNavigation);
        customDialog.setView(idTxt);
        customDialog.setView(headerChk);
        customDialog.setView(footerChk);
        group.setOnCheckedChangeListener(new OnCheckedChangeListener() {

            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId) {

                switch (checkedId) {
                case R.id.ol: // First RadioButton
                    Toast.makeText(NewFile.this, checkedId, Toast.LENGTH_LONG)
                            .show();
                    jqMobNavbar = "<div data-role=\"navbar\">\n" + "        <ol>\n"
                            + "         <li><a href=\"#\">Page 1</a></li>\n"
                            + "         <li><a href=\"#\">Page 2</a></li>\n"
                            + "         <li><a href=\"#\">Page 3</a></li>\n"
                            + "     <ol>\n" + " </div>\n";
                    break;
                case R.id.ul: // Second RadioButton
                    Toast.makeText(NewFile.this, checkedId, Toast.LENGTH_LONG)
                            .show();
                    jqMobNavbar = "<div data-role=\"navbar\">\n" + "        <ul>\n"
                            + "         <li><a href=\"#\">Page 1</a></li>\n"
                            + "         <li><a href=\"#\">Page 2</a></li>\n"
                            + "         <li><a href=\"#\">Page 3</a></li>\n"
                            + "     <ul>\n" + " </div>\n";
                    break;

                }

            }
        }); 
```

和我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <com.androidwebtoolkit.TransparentPanel
        android:id="@+id/transparentPanel1"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_weight="0"
        android:paddingBottom="10dp"
        android:paddingTop="10dp" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerVertical="true"
            android:layout_toRightOf="@+id/imageView1"
            android:text="jBuilder"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_marginLeft="11dp"
            android:src="@drawable/jquerymobileicon" />

    </com.androidwebtoolkit.TransparentPanel>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="10dp"
        android:layout_weight="0"
        android:text="ID:"
        android:textSize="25sp" />

    <EditText
        android:id="@+id/idName"
        android:layout_width="160dp"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <CheckBox
        android:id="@+id/headerChk"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="10dp"
        android:layout_weight="0"
        android:text="Header" />

    <CheckBox
        android:id="@+id/footerChk"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="10dp"
        android:layout_weight="0"
        android:text="Footer" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:paddingLeft="10dp"
        android:text="Navigation"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <RadioGroup
        android:id="@+id/jqmNavigation"
        android:layout_width="312dp"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <RadioButton
            android:id="@+id/ol"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Ordered List" />

        <RadioButton
            android:id="@+id/ul"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Unordered List" />

    </RadioGroup>

</LinearLayout> 
```

我也试过

```
group.setOnCheckedChangeListener(new OnCheckedChangeListener() {

            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId) {
                int radioButtonID = group.getCheckedRadioButtonId();
                View radioButton = group.findViewById(radioButtonID);
                int idx = group.indexOfChild(radioButton);
                switch (idx) {
                case 1:
                    Toast.makeText(NewFile.this, checkedId, Toast.LENGTH_LONG)
                            .show();
                    jqMobNavbar = "<div data-role=\"navbar\">\n" + "        <ol>\n"
                            + "         <li><a href=\"#\">Page 1</a></li>\n"
                            + "         <li><a href=\"#\">Page 2</a></li>\n"
                            + "         <li><a href=\"#\">Page 3</a></li>\n"
                            + "     <ol>\n" + " </div>\n";
                    break;
                case 2:
                    Toast.makeText(NewFile.this, checkedId, Toast.LENGTH_LONG)
                            .show();
                    jqMobNavbar = "<div data-role=\"navbar\">\n" + "        <ul>\n"
                            + "         <li><a href=\"#\">Page 1</a></li>\n"
                            + "         <li><a href=\"#\">Page 2</a></li>\n"
                            + "         <li><a href=\"#\">Page 3</a></li>\n"
                            + "     <ul>\n" + " </div>\n";
                    break;

                }

            }
        }); 
```

检查所选 RadioButton 值的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:10:30.167

你是什​​么意思checkedId是假的？这是一个整数，不能为假。如果您的任何一个 case 语句都有效，这意味着 checkedId 是它应该是的 id 值。

如果您将第一个 RadioButton 设置为在 XML 中选中，则在按下另一个按钮之前不会调用您的任何案例。或者，您也可以 在每个按钮上设置：http: [//developer.android.com/reference/android/widget/CompoundButton.OnCheckedChangeListener.html 。](http://developer.android.com/reference/android/widget/CompoundButton.OnCheckedChangeListener.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T17:56:18.520

它返回`false`是因为它是一个`Integer`. 尝试使用：

```
Toast.makeText(getApplicationContext(), Integer.toString(checkedId), Toast.LENGTH_SHORT).show(); 
```

# regex - GNU Sed 匹配第一个竖线并改变

> ID：16201795
> 
> 赞同：1
> 
> 时间：2013-04-24T20:43:03.770
> 
> 标签：regex, sed

我有以下数据，尽我所能，但没有成功......

```
Las Vegas Nevada 89102|US|Katrina Roetteler
zhen fo shan guang dong 528318|CN|tu min jung
Zurich  CH8022|CH|Kevin M Pearl
Cheltenham GL52 8XX|UK|Kevin M Pearl
Melbourne Vic 3000|AU|brent chandler
Bratislava  821 03|Slovak Republic|SUSTRIK MARTIN MGR.
Zurich 8032|CH|David Graf
Tokyo 178-0063|JP|takahiro ichihashi 
```

我需要像这样改变它：

```
Las Vegas Nevada|89102|US|Katrina Roetteler
zhen fo shan guang dong|528318|CN|tu min jung
Zurich |CH8022|CH|Kevin M Pearl
Cheltenham|GL52 8XX|UK|Kevin M Pearl
Melbourne Vic|3000|AU|brent chandler
Bratislava |821 03|Slovak Republic|SUSTRIK MARTIN MGR.
Zurich|8032|CH|David Graf
Tokyo|178-0063|JP|takahiro ichihashi 
```

基本上将邮政编码/邮政编码放在另一列（我的全球客户的不同类型的邮政编码），邮政编码/邮政编码在第一个垂直条之前。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:48:18.823

使用 sed：

```
sed 's/^\([A-Za-z ]*\) \([-A-Z 0-9]*|\)/\1|\2/' input 
```

**输出**

```
Las Vegas Nevada|89102|US|Katrina Roetteler
zhen fo shan guang dong|528318|CN|tu min jung
Zurich |CH8022|CH|Kevin M Pearl
Cheltenham|GL52 8XX|UK|Kevin M Pearl
Melbourne Vic|3000|AU|brent chandler
Bratislava |821 03|Slovak Republic|SUSTRIK MARTIN MGR.
Zurich|8032|CH|David Graf
Tokyo|178-0063|JP|takahiro ichihashi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:53:23.833

以下正则表达式执行此操作：

```
sed 's/ \([A-Z]*[0-9][0-9]*\)/\|\1/' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:03:28.587

让你开始使用 awk 的一些东西：

```
{
    for (i = 1; i < NF; i++) {
        if ($i~/\|/) {
            if ($(i-1)~/[0-9]/) {
                $(i-1) = "|"$(i-1)
            } else {
            $i = "|"$i
            }
            break
        }
    }
}
{print} 
```

输出：

```
Las Vegas Nevada |89102|US|Katrina Roetteler
zhen fo shan guang dong |528318|CN|tu min jung
Zurich |CH8022|CH|Kevin M Pearl
Cheltenham |GL52 8XX|UK|Kevin M Pearl
Melbourne Vic |3000|AU|brent chandler
Bratislava |821 03|Slovak Republic|SUSTRIK MARTIN MGR.
Zurich |8032|CH|David Graf
Tokyo |178-0063|JP|takahiro ichihashi 
```

# c# - 单例的可能有效使用？

> ID：16201797
> 
> 赞同：5
> 
> 时间：2013-04-24T20:43:08.073
> 
> 标签：c#, design-patterns, servicestack

在我的设计中，我已经到了一个重点，我正在认真考虑单例。

众所周知，“常见”的论点是“永远不要这样做！这太可怕了！”，就好像我们在代码中乱扔一堆[`goto`](https://stackoverflow.com/questions/46586/goto-still-considered-harmful/46638#46638)语句一样。

[ServiceStack](http://www.servicestack.net/)是一个很棒的框架。我自己和我的团队都在使用它，并且我们有一个复杂的基于 Web 服务的基础架构要实施。我一直在鼓励异步设计，并尽可能`SendAsync`在服务堆栈客户端上使用。

鉴于我们有所有这些不同的系统在做不同的事情，我突然想到我想要一个通用的记录器，（实际上是一个 Web 服务本身，如果 Web 服务不可用，则回退到本地文本文件- 例如，一些恶魔正在跟踪建筑物）。虽然我是依赖注入的忠实拥护者，但将“使用此记录器客户端”的引用传递给每个异步请求似乎并不干净（至少对我而言）。

鉴于 ServiceStack 的失败签名是一个`Func<TRESPONSE, Exception>`（并且我对此没有错），我什至不确定最初进行调用的封闭方法是否具有有效的句柄。

*但是，如果此时我们有一个单例记录器，那么我们在世界的哪个位置、*我们在哪个线程上以及我们在无数匿名函数的哪个部分都无关紧要。

这是一个公认的有效案例，还是一个非争论 - 单例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:05:53.083

单例的经典实现只有一个问题——它很容易访问，并且可以直接使用，这会导致强耦合、上帝对象等。

在经典实现下，我的意思是：

```
class Singleton
{
   public static readonly Singleton Instance = new Singleton();
   private Singleton(){}
   public void Foo(){}
   public void Bar(){}
} 
```

如果您仅在对象生命周期策略方面使用单例，并让 IoC 框架为您管理它，保持松散耦合 - 只要您在应用程序的整个生命周期中拥有“只有一个”类的实例就没有错确保它是线程安全的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:18:51.813

日志记录是单例有意义的领域之一，它永远不会对您的代码产生任何副作用，并且您几乎总是希望全局使用相同的记录器。使用 Singleton 时您应该关心的主要事情是 ThreadSafety，在大多数 Logger 的情况下，它们默认是 ThreadSafe。

[ServiceStack 的 Logging API](https://github.com/ServiceStack/ServiceStack.Logging)允许您通过在 App_Start 上全局配置它来提供可替代的 Logging 实现：

```
LogManager.LogFactory = new Log4NetFactory(configureLog4Net:true); 
```

此后，每个类现在都可以访问上面 Factory 中定义的 Log4Net 记录器：

```
class Any
{
    static ILog log = LogManager.GetLogger(typeof(Any));
} 
```

在所有测试项目中，我更喜欢将所有内容都记录到控制台，所以我只需要设置一次：

```
LogManager.LogFactory = new ConsoleLogFactory(); 
```

默认情况下，ServiceStack.Logging 会记录到忽略每个日志条目的良性 NullLogger。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:58:12.313

如果您将通用日志记录放置在应用程序代码调用的静态外观之后，请问问自己您将如何实际对该代码进行单元测试。这是依赖注入试图解决的一个问题，但是您通过让应用程序逻辑依赖于静态类来重新引入它。

您可能还会遇到另外两个问题。我要问你的问题是：你确定你没有记录太多，你确定你没有违反 SOLID 原则。

一年前我写了一个[SO 答案来讨论这两个问题](https://stackoverflow.com/a/9915056/264697)。我建议你阅读它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:59:03.083

和往常一样，我更喜欢有一家工厂。这样我可以在将来更改实现并维护客户合同。

你可以说单例的实现也可以改变，但工厂只是更通用。例如，工厂可以实施任意生命周期策略，并随着时间或根据您的需要更改此策略。另一方面，虽然这在技术上可以为单例实现不同的生命周期策略，但您得到的可能不应该被视为“单例”，而是“具有特定生命周期策略的单例”。这可能和听起来一样糟糕。

每当我要使用单例时，我首先考虑的是工厂，大多数时候，工厂只是胜过单例。如果你真的不喜欢工厂，那就创建一个静态类——一个只有静态方法的无状态类。很有可能，你不需要一个对象，只需要一组方法。

# iphone - UIPageViewController 检查何时向后或向前滑动

> ID：16201799
> 
> 赞同：6
> 
> 时间：2013-04-24T20:43:22.480
> 
> 标签：iphone, ios, objective-c

我想使用`UIPageViewController`. 每当我刷卡时，我需要`index++`或`index--`。每当您向后或进一步滑动时，都会调用此委托方法：

```
- (void)pageViewController:(UIPageViewController *)pvc didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed
{
    // If the page did not turn
    if (!completed)
    {
        // You do nothing because whatever page you thought
        // the book was on before the gesture started is still the correct page
        return;
    }

    // I want to check here whenever the page was swiped back or further
} 
```

如果用户向后或进一步滑动，我如何检查此方法？我知道有 2 个 DataSource 方法“viewControllerAfterViewController”和“viewControllerBeforeViewController”，但我无法检查页面转换是否已完成（我可以在上述方法中执行此操作）知道我如何知道用户是否向后滑动或进一步滑动上面的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-12-20T02:23:24.147

使用协议：

```
MyClass : UIViewController <UIPageViewControllerDataSource,UIPageViewControllerDelegate 
```

声明一个属性：

```
@property(nonatomic) NSInteger currentIndex;
@property(nonatomic) NSInteger nextIndex; 
```

在方法中：

```
-(void)pageViewController:(UIPageViewController *)pageViewController willTransitionToViewControllers:(NSArray *)pendingViewControllers{
    NewsTableViewController *controller  = [pendingViewControllers firstObject];
    self.nextIndex = [self.arrViews indexOfObject:controller];
}

-(void)pageViewController:(UIPageViewController *)pageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed{
    if (completed) {
        self.currentIndex = self.nextIndex;
    }
    self.nextIndex = 0;
} 
```

在那里你将有当前页面。感谢 Corey Floyd 在[此处输入链接描述](https://stackoverflow.com/questions/8400870/uipageviewcontroller-return-the-current-visible-view)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T20:48:26.997

根据[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPageViewControllerDelegateProtocolRef/UIPageViewControllerDelegate.html)，似乎没有办法判断用户是向前还是向后滑动了页面。布尔值“完成”将告诉您用户是否已完成翻页。

一种解决方法：

创建一个 int 变量并使用 viewControllerAfterViewController 和 viewControllerBeforeViewController 方法增加或减少变量的值。用它来测试他们是向前还是向后移动。

编辑：您可以`presentationIndexForPageViewController` 从[文档中使用](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPageViewControllerDataSourceProtocolRef/UIPageViewControllerDataSource.html)

编辑2：[在此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html#//apple_ref/occ/instm/UIPageViewController/setViewControllers%3adirection%3aanimated%3acompletion%3a)检查此链接有一个名为`setViewControllers:direction:animated:completion:`方向的方法将是`UIPageViewControllerNavigationDirectionForward`或`UIPageViewControllerNavigationDirectionReverse`

编辑 3：代码 - 这是假设您知道将通过前进或后退调用哪个视图控制器：

在您的 appDelegate 和 setter 方法上创建一个变量：

```
int indexVar;

- (void)setIndex:(int)indexVar; 
```

然后在您的视图控制器（向前或向后）上增加值或减少值（viewDidLoad）：

```
(AppDelegate *)[[UIApplication sharedApplication] delegate] setIndex:<whatever>]; 
```

类似的东西。这不是实现目标的确切方法，但希望它能让你朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-09T16:22:00.983

我认为最简单的解决方案是创建一个自己的 ViewController 类，该类具有跟踪当前显示的索引的属性。在大多数情况下，无论如何我都需要为我的 PageViewController 自定义 ViewController。在我的示例中，这是以下类。

```
@interface PageZoomViewController : UIViewController

@property (nonatomic) int pageIndex;

@end 
```

然后在 viewControllerAfter/Before 方法中，您可以将索引传递给新页面。

```
-(UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController {

    int nextPageIndex = ((PageZoomViewController *)viewController).pageIndex-1;

    PageZoomViewController *controller = [[PageZoomViewController alloc] initWithPageViewControlParent:self andFrame:[self frameForPagingScrollView] andPageIndex:nextPageIndex];

    return controller;
} 
```

下一页动画完成后，您可以像这样轻松设置当前索引。

```
-(void)pageViewController:(UIPageViewController *)thePageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed {

    if(completed) {
        index = ((PageZoomViewController *)thePageViewController.viewControllers[0]).pageIndex;
    }
} 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-05T09:13:19.787

我通过在每个 ViewController 类中创建协议来做到这一点，并在 viewWillAppear 方法中调用协议方法。然后在 PageViewController 中，每当我实例化其中一个视图控制器时，我将其委托设置为 PageViewController。这是我项目中的第三个 ViewController（请注意，我在每个视图控制器中都这样做了）

```
@class ViewController3;
@protocol ViewControllerPageNumber <NSObject>

-(void)viewWillAppearMyPageNumber:(int)myPageNumber;

@end
@interface ViewController3 : UIViewController
@property (nonatomic, weak) id <ViewControllerPageNumber> delegate;
@end 
```

并在 viewWillAppear 方法中的 .m 文件中

```
-(void)viewWillAppear:(BOOL)animated{
    [self.delegate viewWillAppearMyPageNumber:3];//The 3 will be different for each ViewController 
} 
```

接下来，在 PageViewController.m 中，每当我实例化视图控制器时，我都会将其委托设置为 self（或 PageViewController）。viewCons 只是一个带有我的 viewControllers 名称的字符串数组。

```
- (UIViewController *)viewControllerAtIndex:(NSUInteger)index {
    id vc = [[NSClassFromString([viewCons objectAtIndex:index]) alloc] init];
    if([vc isMemberOfClass:[NSClassFromString(@"ViewController3") class]]){
        ViewController3 *vc3=(ViewController3 *) vc;
        vc3.delegate=self;
    }else if([vc isMemberOfClass:[NSClassFromString(@"ViewController2") class]]){
        ViewController2 *vc2=(ViewController2 *) vc;
        vc2.delegate=self;
    }else if([vc isMemberOfClass:[NSClassFromString(@"ViewController") class]]){
        ViewController *vc1=(ViewController *) vc;
        vc1.delegate=self;
    }
    return vc;
} 
```

最后，我正在实现我的自定义委托方法，在我的例子中是刷新我在 PageViewController 顶部设置的标签文本。

```
-(void)viewWillAppearMyPageNumber:(int)myPageNumber{
    [self refreshLabelsOnCurrentPageWithIndex:myPageNumber];
} 
```

# iphone - AVAudioPlayer 的averagePowerForChannel 平均值是多少？

> ID：16201806
> 
> 赞同：4
> 
> 时间：2013-04-24T20:43:52.207
> 
> 标签：iphone, ios, audio, avfoundation, avaudioplayer

文档`AVAudioPlayer`说`averagePowerForChannel:`“返回给定通道的平均功率，以分贝为单位，用于播放的声音。” 但它没有说明“平均”是什么意思，或者如何/是否对该平均值进行加权。我对样本的范围特别感兴趣，特别是时间间隔以及它是否会进入未来。

[AVAudioRecorder：峰值和平均功率](https://stackoverflow.com/questions/1240846/avaudiorecorder-peak-and-average-power)表示用于计算功率的公式是多个样本的 RMS（均方根），但也没有说明使用了多少样本。

*可选的额外问题：如果我**想*计算平均功率，例如 100 毫秒——足够的时间让动画现在开始并很快达到适当的水平——我应该研究什么框架？[与 AVAudioRecorder 中的仪表混淆](https://stackoverflow.com/questions/5689774/confusion-with-meters-in-avaudiorecorder)表示我可以使用 AudioQueue 或 RemoteIO 获取原始样本数据，然后我可以使用类似这样的东西：[Android 版本的 AVAudioPlayer 的 averagePowerForChannel——](https://stackoverflow.com/questions/1808899/android-version-of-avaudioplayers-averagepowerforchannel)但我还没有找到示例代码（请原谅双关语）。

# asp.net - SQL统计分析

> ID：16201807
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:43:52.847
> 
> 标签：asp.net, sql, vb.net, ms-access

我正在为一个大学项目计划一个“统计”页面，其中将根据我的 Access 数据库中的数据显示许多事实。

统计信息将以文本格式显示，如下所示：

*23%*的**饮酒者**喜欢**Life of Pi**，而只有*15%*的**非饮酒者**喜欢它。

*65%*的教师读过**威廉·莎士比亚的《奥赛罗》，**而只有*40%*的**警察**读过。

[我将我知道如何在 SQL 语句中检索的值**加粗**，并将我不知道如何计算的百分比用*斜体表示]*

用户详细信息包括布尔值，例如吸烟者：是/否或饮酒者：是/否以及用户的职业（组合框中列出的职业数量有限）。这些都存储在一个名为“userprofiles”的表中

我有一个名为“booklist”的单独表，用于存储书籍的名称、作者、标题等，还有一个名为“booklikejunction”的表，其中记录了每本书的喜欢以及用户的当前`User.Identity.Name`

我的 SQL 语句会是什么样子？我将如何以上面概述的格式显示我的查询结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:55:24.483

只是一个提示（使用 ms-access SQL 语法）：

```
select sum(iif([field1]='drinker',1,0)) / count([field1])
from [tbl_questions]
where ... 
```

不是最干净的方法，但它有效

# python - 可靠、跨平台的方式来发现 python 中所有本地接口的 IP 地址，无需额外的库

> ID：16201811
> 
> 赞同：0
> 
> 时间：2013-04-24T20:44:18.523
> 
> 标签：python, cross-platform, ip-address

我认为这个问题说明了一切。我想要一种方法来发现 python 中本地接口的 ip 地址。

我在这个问题上看到了很多变体（例如[这个](https://stackoverflow.com/questions/166506/finding-local-ip-addresses-using-pythons-stdlib)，但似乎它们都没有完全涵盖所有的基础。（例如，我引用的那个询问如何找到“本地 IP 地址”，而不是他们全部）。

总结一下要求：

1.  我希望它能够可靠地跨平台
2.  我希望它不需要额外的库（例如，我知道 netifaces）
3.  我希望它发现所有本地接口，而不仅仅是一些
4.  任何数据包都不应从任何接口发送出去。

这有点苛刻，我意识到:-)。关键是这是一个在各种情况下都会出现的常见问题，恕我直言，应该有一个“复制和粘贴”解决方案（即我可以在我的代码中放入一个片段以提供跨平台的此功能）。

**编辑**

作为参考，还有[这个](https://stackoverflow.com/questions/8281371/python-how-to-get-all-external-ip-addresses-with-multiple-nics?rq=1)问题，假设发送数据包。

# elasticsearch - 在 ElasticSearch 中忽略撇号（所有格）

> ID：16201814
> 
> 赞同：3
> 
> 时间：2013-04-24T20:44:31.473
> 
> 标签：elasticsearch, tire

我试图让用户提交的查询“Joe Frankle”、“Joe Frankle”、“Joe Frankle's”以匹配原始文本“Joe Frankle's”。现在我们正在索引这个文本所在的字段（轮胎/红宝石格式）：

```
{ :type => 'string', :analyzer => 'snowball' } 
```

并搜索：

```
query { string downcased_query, :default_operator => 'AND' } 
```

我试过这个不成功：

```
 create :settings => {
              :analysis => {
                :char_filter => {
                   :remove_accents => {
                     :type => "mapping",
                     :mappings => ["`=>", "'=>"]
                   }
                },
                :analyzer => {
                  :myanalyzer => {
                    :type => 'custom',
                    :tokenizer => 'standard',
                    :char_filter => ['remove_accents'],
                    :filter => ['standard', 'lowercase', 'stop', 'snowball', 'ngram']
                  }
                },
                :default => {
                  :type => 'myanalyzer'
                }
            }
          }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-10T19:35:15.840

There's two official ways of handling possessive apostrophes:

1) Use the "possessive_english" stemmer as described in the ES docs: [http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-stemmer-tokenfilter.html](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-stemmer-tokenfilter.html)

Example:

```
{
  "index" : {
    "analysis" : {
        "analyzer" : {
            "my_analyzer" : {
                "tokenizer" : "standard",
                "filter" : ["standard", "lowercase", "my_stemmer"]
            }
        },
        "filter" : {
            "my_stemmer" : {
                "type" : "stemmer",
                "name" : "possessive_english"
            }
        }
    }
  }
} 
```

Use other stemmers or snowball in addition to the "possessive_english" filter if you like. Should/Must work, but it's untested code.

2) Use the "word_delimiter" filter:

```
{
  "index" : {
    "analysis" : {
        "analyzer" : {
            "my_analyzer" : {
                "tokenizer" : "standard",
                "filter" : ["standard", "lowercase", "my_word_delimiter"]
            }
        },
        "filter" : {
            "my_word_delimiter" : {
                "type" : "word_delimiter",
                "preserve_original": "true"
            }
        }
    }
  }
} 
```

Works for me :-) ES docs: [http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-word-delimiter-tokenfilter.html](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-word-delimiter-tokenfilter.html)

Both will cut off "'s".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T18:09:13.073

我遇到了类似的问题，单独的雪球分析仪对我不起作用。不知道该不该。这是我使用的：

```
properties: {
  name: {
    boost: 10,
    type:  'multi_field',
    fields: {
      name:      { type: 'string', index: 'analyzed', analyzer: 'title_analyzer' },
      untouched: { type: 'string', index: 'not_analyzed' }
    }
  }
}

analysis: {
  char_filter: {
    remove_accents: {
      type: "mapping",
      mappings: ["`=>", "'=>"]
    }
  },
  filter: {},
  analyzer: {
    title_analyzer: {
      type: 'custom',
      tokenizer: 'standard',
      char_filter: ['remove_accents'],
    }
  }
} 
```

使用分析器时，[管理索引分析工具](http://www.elasticsearch.org/guide/reference/api/admin-indices-analyze/)也很棒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:45:06.743

看起来在您的查询中您正在搜索`_all`字段，但您的分析器仅应用于单个字段。要为该`_all`字段启用此功能，只需[将 snowball 设为您的默认分析器](https://stackoverflow.com/questions/9670016/how-do-i-set-the-default-analyzer-for-elastic-search-with-tire/9670873#9670873)。

# wpf - WPF - 选择器 - 自定义控件 - SelectionChanged 事件未触发

> ID：16201817
> 
> 赞同：1
> 
> 时间：2013-04-24T20:44:45.283
> 
> 标签：wpf, custom-controls, selector, itemtemplate, selectionchanged

我是自定义控件创建的新手。我已经为基于 Selector 类的新自定义控件奠定了一些基础。我的理解是我应该使用这个类，因为我需要控件来拥有一个 Items 集合和处理选择的能力。我相信更改 ItemTemplate 可能会覆盖其中的某些功能，因为我没有在控件级别或应用程序级别收到 SelectionChanged 事件。我想如果我是对的，我可以将 DataTemplate 内部放入某种 SelectionRegion XAML 标记。我没有运气找到这样的东西。在谷歌浏览了一段时间后，我准备问一下。我错过了什么？下面是 ItemTemplate 标记。谢谢你的帮助。

```
<Setter Property="ItemTemplate">
    <Setter.Value>
        <DataTemplate>
            <Border BorderBrush="Black" BorderThickness="1">
                <TextBlock Text="{Binding}" Foreground="Black" Background="White" MinHeight="12" MinWidth="50"/>
            </Border>
        </DataTemplate>
    </Setter.Value>
</Setter> 
```

应评论者的要求，这是迄今为止该控件的完整 XAML：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:SourceMedicalWPFCustomControlLibrary">
    <Style TargetType="{x:Type local:MultiStateSelectionGrid}">
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <WrapPanel/>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Border BorderBrush="Black" BorderThickness="1">
                        <TextBlock Text="{Binding Code}" Foreground="Black" Background="White" MinHeight="12" MinWidth="50" Padding="2" ToolTip="{Binding Description}"/>
                    </Border>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:MultiStateSelectionGrid}">
                    <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,0,0,0" Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,0,0,0" Content="{TemplateBinding Content}"/>
                        <ItemsPresenter/>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary> 
```

还有贫血的代码隐藏：

```
namespace SourceMedicalWPFCustomControlLibrary
{
    public class MultiStateSelectionGridState
    {
        public Brush Background { get; set; }
        public Brush Foreground { get; set; }
        public Brush Border { get; set; }
        public string Text { get; set; }

        public MultiStateSelectionGridState()
        {
            Background = Brushes.White;
            Foreground = Brushes.Black;
            Border = Brushes.Black;
            Text = String.Empty;
        }
    };

    public class MultiStateSelectionGrid : Selector
    {
        public static readonly DependencyProperty ContentProperty =
            DependencyProperty.Register("Content", typeof(object), typeof(MultiStateSelectionGrid),
            new FrameworkPropertyMetadata(null,
                  FrameworkPropertyMetadataOptions.AffectsRender |
                  FrameworkPropertyMetadataOptions.AffectsParentMeasure));

        public object Content
        {
            get { return (object)GetValue(ContentProperty); }
            set { SetValue(ContentProperty, value); }
        }

        public static readonly DependencyProperty StatesProperty =
            DependencyProperty.Register("States", typeof(List<MultiStateSelectionGridState>), typeof(MultiStateSelectionGrid),
            new FrameworkPropertyMetadata(new List<MultiStateSelectionGridState>(),
                FrameworkPropertyMetadataOptions.AffectsRender));

        public List<MultiStateSelectionGridState> States
        {
            get { return (List<MultiStateSelectionGridState>)GetValue(StatesProperty); }
            set { SetValue(StatesProperty, value); }
        }

        static MultiStateSelectionGrid()
        {
            DefaultStyleKeyProperty.OverrideMetadata(typeof(MultiStateSelectionGrid), new FrameworkPropertyMetadata(typeof(MultiStateSelectionGrid)));
        }

        public override void OnApplyTemplate()
        {
            base.OnApplyTemplate();
            this.SelectionChanged += new SelectionChangedEventHandler(MultiStateSelectionGrid_SelectionChanged);
        }

        void MultiStateSelectionGrid_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            MessageBox.Show("Hi");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:12:33.887

这就是我所做的。我使用自定义控件的应用模板功能并将处理程序添加到我想要的控件的选择更改事件中。

这里的简单示例：

```
public event EventHandler<SelectionChangedEventArgs> YourControlSelectionChanged;

private void Selector_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (ListSelectionChanged != null) {
        ListSelectionChanged(sender, e);
    }
}

public override void OnApplyTemplate()
{
    base.OnApplyTemplate();
    //find or declare your control here, the x:name in xaml should be YourControl
    YourControl== this.Template.FindName("YourControl", this) as YourControlType
    YourControl.SelectionChanged += ResultListBox_SelectionChanged;
} 
```

然后，您可以绑定到您在 xaml 中的自定义控件类中声明的公共事件 (YourControlSelectionChanged) 的名称。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T17:13:14.037

通过阅读一些不同控件的完整代码示例，我相信我的答案是我做错了。相反，我需要在 ControlTemplate 中有一个像 ListBox 一样的 Selector 控件。那么，@JKing 的建议将帮助我到达我需要去的地方。实际问题的答案是前面提到的从使用 Selector 作为基类到在控件模板中使用选择器的变化。谢谢您的帮助。

# javascript - 自定义的 Javascript 函数没有按我的预期工作？

> ID：16201822
> 
> 赞同：5
> 
> 时间：2013-04-24T20:45:08.233
> 
> 标签：javascript, html

几年前我开发了一个类似 LOGO 的基本海龟图形解释器，我不想把它放到网上（因为我表弟一直在烦我）。尽管我对 HTML、Javascript 编码还是很陌生，但我想我会尝试一下并将其作为学习经验。

下面的代码只是用于基本的 UI（我的 UI 看起来很丑，稍后我会清理它）。

我编写了一个 Javascript 函数 pushCmd，它被称为“cmd-form”的 onsubmit。

```
function pushCmd()
            {   var cmdText = document.forms["cmd-form"]["cmd-text"].value;
                var srcElement = document.getElementById("source-container");
                var srcText = new String(srcElement.innerHTML);
                srcText = srcText.toUpperCase();
                if (srcText.indexOf("NO CODE") != 0)
                {
                    srcText = cmdText;
                }
                else
                {
                    srcText += "<br>" + cmdText;
                }
                srcElement.innerHTML = srcText;
            } 
```

表格声明如下。

```
<div id="command-container">
                                    <form name="cmd-form" action="" onsubmit="pushCmd()" onreset="resetSource()" method="post">
                                        <input type="text" name="cmd-text" size="80">
                                        <input type="submit" value="Send">
                                        <input type="reset" value="Reset">
                                        <input type="button" value="Run">
                                    </form>
                                </div> 
```

pushCmd 函数应该改变 div "source-container" 的 HTML 内容，默认情况下如下所示。

```
<div id="source-container">NO CODE</div> 
```

在我提交第一个文本（比如“FWD 100”）之后。“源容器”的内容应更改为“FWD 100”。那么如果我提交“RT 90”，内容应该是“FWD 100
RT 90”。这就是我所期望的。

但是当我提交文本时。“源容器”的内容只是瞬间改变，然后又回到“无代码”。为什么会这样，谁能指出我的错误在哪里？

我尝试了 get 和 post 方法，但结果是一样的。我在 Javascript 控制台中也看不到任何错误或警告。如果这很重要，我正在使用 Google chrome 版本 26.0.1410.63（我猜不是）。

如果您需要任何进一步的信息或完整的 HTML 源代码，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:53:02.437

发生这种情况是因为 HTML 表单通过发送一个新的 HTTP 请求提交给服务器，在您的情况下，该请求具有空操作属性，类似于在浏览器中刷新页面。为了防止浏览器执行默认操作（提交表单），您可以`false`从函数返回，方法是`return false;`在其中添加最后一行：

```
function pushCmd() {
    var cmdText = document.forms["cmd-form"]["cmd-text"].value;
    var srcElement = document.getElementById("source-container");
    var srcText = srcElement.innerHTML.toUpperCase();

    if (srcText.indexOf("NO CODE") !== 0)
    {
        srcText = cmdText;
    }
    else
    {
        srcText += "<br>" + cmdText;
    }
    srcElement.innerHTML = srcText;
    return false;
} 
```

然后更改您的 HTML 属性以从以下位置返回函数的返回值`onsubmit`：

```
onsubmit="return pushCmd()" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T20:51:41.000

`false`您需要从中返回`pushCmd`，并将`onsubmit`属性更改为，`onsubmit="return pushCmd();"`否则表单将自行提交并刷新页面。

此外，您需要更改此行：

```
srcText = "<br>" + cmdText; 
```

到：

```
srcText += "<br>" + cmdText; 
```

这相当于：

```
srcText = srcText + "<br>" + cmdText; 
```

这意味着您要附加`cmdText`到`srcText`. 如果你没有`+=`，你基本上最终会被`srcText`覆盖`cmdText`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T20:51:58.373

您正在提交表单，因此页面正在刷新，将其设置回原始状态。

根据您最终的需要，一种解决方案是阻止表单提交。`return false;`您可以在函数结束时使用简单的方法来执行此操作。

```
function pushCmd() {
    var cmdText = document.forms["cmd-form"]["cmd-text"].value;

    var srcElement = document.getElementById("source-container");
    var srcText = srcElement.innerHTML;
    srcText = srcText.toUpperCase();

    if (srcText.indexOf("NO CODE") != 0) {
        srcText = cmdText;
    } else {
        srcText = "<br>" + cmdText;
    }
    srcElement.innerHTML = srcText;

    return false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T21:11:01.243

您的表单实际上正在提交给空操作。一个空的动作通常会刷新当前页面。因此，您的页面可能刷新得如此之快，以至于它似乎是`source-container`div 的即时更改。

不要使用提交按钮，而是尝试 type=button 然后在 javascript 中设置该按钮的 onclick。（注意`id=""`HTML 中的发送按钮）

**HTML**

```
<div id="command-container">
  <form id="cmd-form" action="" onreset="resetSource()" method="get">
    <input type="text" id="cmd-text" name="command" size="80" />
    <input type="button" id="btnSend" value="Send" />
    <input type="reset" value="Reset" />
    <input type="submit" value="Run" />
  </form>
</div>

<div id="source-container">NO CODE</div> 
```

**Javascript**

```
function pushCmd()
{
    var cmdText = document.forms["cmd-form"]["cmd-text"].value;
    var srcElement = document.getElementById("source-container");
    var srcText = new String(srcElement.innerHTML);
    srcText = srcText.toUpperCase();
    alert(cmdText);
    if (srcText.indexOf("NO CODE") != 0)
    {
        srcText = cmdText;
    }
    else
    {
        srcText += "<br>" + cmdText;
    }
    srcElement.innerHTML = srcText;
}

document.getElementById('btnSend').onclick = pushCmd; 
```

请参阅此 codepen 作为此代码的示例：[http ://codepen.io/keithwyland/pen/scAJy](http://codepen.io/keithwyland/pen/scAJy)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T20:51:39.677

您可能会将整个页面发送到服务器，这将导致它刷新，因此您将获得相同的默认值。

为了防止这种情况发生，您可以尝试使用 AJAX，这将允许您在不刷新整个页面的情况下将数据发送到服务器。

阻止您的页面提交到服务器的一种方法是添加`return false;`到您的功能。

```
function pushCmd()
            {   var cmdText = document.forms["cmd-form"]["cmd-text"].value;
                var srcElement = document.getElementById("source-container");
                var srcText = new String(srcElement.innerHTML);
                srcText = srcText.toUpperCase();
                if (srcText.indexOf("NO CODE") != 0)
                {
                    srcText = cmdText;
                }
                else
                {
                    srcText = "<br>" + cmdText;
                }
                srcElement.innerHTML = srcText;
                retrun false;
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T20:52:43.553

您需要`false`从`onsubmit`事件处理程序返回以防止页面自行刷新。当您按下提交按钮时，您的事件处理程序会触发，但随后会立即提交表单，这会再次加载页面。如果您`false`从事件处理程序返回，它会阻止默认行为。

```
`function pushCmd()
            {   var cmdText = document.forms["cmd-form"]["cmd-text"].value;
                var srcElement = document.getElementById("source-container");
                var srcText = new String(srcElement.innerHTML);
                srcText = srcText.toUpperCase();
                if (srcText.indexOf("NO CODE") != 0)
                {
                    srcText = cmdText;
                }
                else
                {
                    srcText = "
" + cmdText;
                }
                srcElement.innerHTML = srcText;
                return false;
            }` 
```

`此外，您需要`return pushCmd()`而不是仅仅`pushCmd()`在您的事件处理程序中。`

# c# - 如何在另一个异步方法中创建调用异步方法而不会停止

> ID：16201826
> 
> 赞同：4
> 
> 时间：2013-04-24T20:45:14.743
> 
> 标签：c#, winforms, .net-4.5, async-await

我需要调用多个异步方法，并在其中调用另一个异步方法。让我演示一下

```
private async void button1_Click(object sender, EventArgs e)
{
    for(int i = 0; i< 100; i++)
    {
        await Method1();
    }
}

public async Task Method1()
{
    await Task.Delay(3*1000);
    await Method2();
}

public async Task Method2()
{
    await Task.Delay(10*1000);
} 
```

我的问题是，for 语句仅在 Method2 的等待开始后激活迭代，而我想要的是一次创建 100 个任务。其他一切都将异步完成。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T21:05:58.767

I think you are confused as to what "await" means. "await" means "start processing this thing asynchronously, and while that is ticking away, go back to the windows message loop and keep on processing messages so that the UI keeps on re-drawing. When the asynchronous task is done, pick up the code where I awaited".

So when you `await` in a loop like that, you are saying:

*   Start the first asynchronous job...
*   and while it is running, keep processing the message loop.
*   When the first asynchronous job is done...
*   pick up in the loop where we awaited. We go around the loop and...
*   Start the second asynchronous job...

If that's not what you want then *don't await the task*. If you want to start a hundred tasks that run concurrently then *start a hundred tasks and don't await any of them*. Why is there *any* await in the click handler?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:05:28.593

而不是`await`在 for 循环中创建每个任务时对其进行 -ing，您只想启动所有任务。您不想将下一个任务的调度延迟到上一个任务完成之前，所以不要`await`：

```
private void button1_Click(object sender, EventArgs e)
{
    for(int i = 0; i< 100; i++)
    {
        var task = Method1();
    }
} 
```

完毕。

If it's important that you do something after all of the tasks finish, while still doing all of them in parallel, then you can rely on `Task.WhenAll` to generate a task that will be completed when all of the other tasks are done:

```
private async void button1_Click(object sender, EventArgs e)
{
    var tasks = new List<Task>();
    for(int i = 0; i< 100; i++)
    {
        tasks.Add(Method1());
    }
    await Task.WhenAll(tasks);
    textbox1.Text = "Done!"; //or whatever you want to do when they're all done
} 
```

# android - 当前活动未在按钮单击时关闭（完成）

> ID：16201830
> 
> 赞同：2
> 
> 时间：2013-04-24T20:45:39.370
> 
> 标签：android

嗨，我正在使用 ImageButton click 调用一个活动，但它不会完成当前活动。

```
btn_home.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {

                Intent i = new Intent(getApplicationContext(), GridActivity.class);
                i.putExtra("feed", _rssFeed);
                startActivity(i);

                SwipeDetailView.this.finish();
            }
        }); 
```

但是，如果我单击同一类中操作栏菜单上的主页按钮，它会正常关闭。

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {

    case android.R.id.home:

        finish();
        return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:48:57.603

您正在`View.OnClickListener`上下文中调用完成，而不是您需要做`ACTIVITYCLASSNAME.this.finish ()`

# mysql - 使用结果集更新角色杀戮和死亡

> ID：16201831
> 
> 赞同：0
> 
> 时间：2013-04-24T20:45:41.290
> 
> 标签：mysql

我试图根据其他问题找到答案，但我无法将逻辑实现为我的必要性。

我可以轻松获得所需的信息，但是我无法使用这些信息更新表格。

我使用以下查询选择了所有必要的值：

```
select `roleid`, 
(select count(`killerid`) from `kills` where `killerid`=`roleid`) as `kills`, 
(select count(`corpseid`) from `kills` where `corpseid`=`roleid`) as `deaths` 
from `characters` 
```

因此，此查询返回角色的 ID 及其各自的杀戮和死亡人数。

现在，我需要知道：如何更新表“字符”，将“杀死”和“死亡”行设置为查询中的返回值？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:04:12.950

```
UPDATE characters c 
  LEFT JOIN 
    ( SELECT killerid, count(*) as kill_num FROM kills GROUP BY killerid ) k1
  ON c.roleid = k1.killerID 
  LEFT JOIN
    ( SELECT corpseid, count(*) as death_num FROM kills GROUP BY corpseid ) k2
  ON c.roleid = k2.corpseID
SET c.kills = k1.kill_num, c.deaths = k2.death_num 
```

# .net - SQL Server + .net C# 应用程序的性能问题

> ID：16201838
> 
> 赞同：1
> 
> 时间：2013-04-24T20:45:56.330
> 
> 标签：.net, sql-server, oracle

我支持在 SQL Server 上运行并在 .net c# 上开发的应用程序。该应用程序从本地系统 (ERP) 获取其信息，并在白天分几批处理（大多数情况下，它只会分批处理）。然后它以图表和报告的形式呈现给用户（该应用程序基本上是一个报告的应用程序；几乎没有在其上进行数据输入，而是在公司的本地系统上）。

在实施该应用程序的几家大公司中，随着一些重要表中的历史记录开始堆积，处理时间开始大幅增长，从每个批处理的 30 分钟增加到 6 或 7 小时。软件中的其他一些任务也遭受了性能下降。

每天处理的记录数量（在批处理中）或多或少保持不变（每天在 500.000 到 1'000.000 条记录之间，分布在多个表中）。

这是在 SQL Server 上运行的系统所期望的吗？使用 Oracle 作为数据库是否会消除或至少减少此类问题？或者您认为我们应该专注于数据库和应用程序设计，而不考虑使用的数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:54:12.140

SQL Server 和 Oracle 都是管理大量数据的可靠平台。切换数据库平台不太可能解决您的问题，而且当您将代码调整到新的目标数据库时，确实可能会使事情变得更糟。

您需要确定性能瓶颈的确切位置。调优任何 SQL 服务器都是一项艰巨的任务。如果可以，请让 DBA 处理该问题。如果没有，这里有一些提示：

*   准确衡量性能时间花在哪里。如果可以，重新创建大型生产系统并使用分析器。如果没有，请添加一个记录模式，该模式会写出您可以打开或关闭的关键性能指标（例如，获取数据的时间、C# 中的时间处理数据）。
*   使用[sp_Blitz对生产 SQL 服务器进行健康检查](http://www.brentozar.com/blitz/)
*   使用数据库引擎优化顾问。它发现了许多常见问题，包括索引缺失或选择不当。详细步骤见[http://www.sqlservercentral.com/articles/Database+Engine+Tuning+Advisor/97860/](http://www.sqlservercentral.com/articles/Database+Engine+Tuning+Advisor/97860/)
*   查看最昂贵的数据操作，以确保您获取的数据不会超出实际需要（没有额外的列，以及只返回必要行的 WHERE 子句）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:32:32.850

SQL Server 可以轻松处理 TB 级的信息。可能的问题是，您没有真正知道如何设计或维护大型数据库的人。如果您没有大型系统方面的 dba 经验，则需要聘请一名。您应该让数据库专家进行设计。如果您使用 ORM，它很可能会导致问题。问题也可能出现在索引、sql 代码、网络中的表设计、动力不足的硬件、过时的统计数据等方面。您处于专家领域，您需要雇用或创建专家. 您至少需要从头到尾阅读几本关于性能调优的书籍。有很多事情会导致系统在生产负载下表现不佳。

# virtualbox - Vagrant 停止调度

> ID：16201841
> 
> 赞同：0
> 
> 时间：2013-04-24T20:46:05.667
> 
> 标签：virtualbox, shutdown, vagrant

我将 Vagrant 与几个依赖的虚拟机一起使用。

例如 A 有一个 NFS 服务器，B 是 A 的 NFS 客户端，等等。

当我制作 a`vagrant up`时，A 是启动，然后是 B，等等。

但是当我制作 a 时`vagrant halt`，A 被击落，然后 B 无法正确停止，因为它试图卸载离线的 NFS 磁盘。

他们是一种扭转关机顺序的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:48:27.580

你在使用[Vagrant Multi-Machines](http://docs.vagrantup.com/v2/multi-machine/index.html)选项吗？有了它，您可以在同一个 Vagrantfile 中指定两台机器，并且在使用时`vagrant up`会`vagrant halt`影响两者。

还要看看[vagrant load order](http://docs.vagrantup.com/v2/vagrantfile/index.html#load-order)。

# android - 如何在后台正确监控和记录 Android 操作系统事件/活动

> ID：16201842
> 
> 赞同：0
> 
> 时间：2013-04-24T20:46:13.190
> 
> 标签：android, events, operating-system, monitor, polling

我想知道在 Android 中监视系统事件和操作系统活动的正确方法。到目前为止，我的研究表明有多种方法可以运行活动、服务、BroadCastReceivers 等，但对于我想要完成的所有事情，我还没有一个全面的答案。我今天确实遇到了一个名为“Carrier IQ”的应用程序，我想知道他们是如何做到的。我相信他们的应用程序内置在内核或至少手机的操作系统映像中，我想尽可能避免这样做。

我知道Android SDK提供了多种获取方式，既然我的应用不能被挂起，是不是应该作为前台服务运行呢？如果我这样做，如果我需要轮询各种活动，我会消耗太多资源吗？我问这个是因为我不认为我可以通过接收事件（即，使用 BroadCastReceiver）获得所有内容。我认为我需要将投票和事件结合起来。

我想记录传感器、事件、操作系统活动等以进行用户研究。这不是为了黑客或网络钓鱼目的！

这些是我认为可能完成与我想要实现的目标类似的前三个项目，但我尚未确定它们是否是可行的解决方案：

[android-hci-提取器](https://code.google.com/p/android-hci-extractor/)

[手机机器人数据记录器](https://code.google.com/p/cellbots/source/browse/trunk/android/java/dataLogger/#dataLogger/src/com/cellbots/logger)

[安卓操作系统监视器](https://code.google.com/p/android-os-monitor/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:50:30.300

Android 清单权限列表是否包含您的应用所需的所有权限？

[http://developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html)

然后，您可以在安装应用程序时请求权限，并且您应该能够访问它们。

# python - Python：将列表列表插入另一个列表列表

> ID：16201852
> 
> 赞同：7
> 
> 时间：2013-04-24T20:46:45.297
> 
> 标签：python, list

我想列出以下清单：

```
matrix1 = [
[1, 2, 3, 4],
[5, 6, 7, 8],
[9, 10, 11, 12]
]

matrix2 = [
[A, B, C, D],
[E, F, G, H]
] 
```

并将它们组合成：

```
new_matrix = [
[A, B, C, D],
[E, F, G, H],
[1, 2, 3, 4],
[5, 6, 7, 8],
[9, 10, 11, 12]
] 
```

而且我似乎找不到一个好的方法。Insert() 将整个列表放入其中，从而生成列表列表的列表。任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T20:48:10.610

只需添加它们！

```
new_matrix = matrix1 + matrix2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T20:48:45.477

用于`+`添加它们：

```
In [59]: new_matrix = matrix2 + matrix1

In [60]: new_matrix
Out[60]: 
[['A', 'B', 'C', 'D'],
 ['E', 'F', 'G', 'H'],
 [1, 2, 3, 4],
 [5, 6, 7, 8],
 [9, 10, 11, 12]] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T20:48:13.363

使用`extend`它来扩展另一个列表，而不是将其插入其中。

```
>>> matrix2.extend(matrix1) 
```

但是，这将进行适当的更改，而不是创建一个新列表，这可能是您想要的。如果您宁愿创建一个新的，那么`+`这就是您所需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:48:50.613

只需使用`+`运算符

```
>>> a = [[1],[2],[3]]
>>> b = [[4],[5],[6]]
>>> a+b
[[1], [2], [3], [4], [5], [6]]
>>> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T20:49:17.180

许多列表的通用解决方案：

任何一个：

```
new_matrix = list(itertools.chain(matrix1, matrix2, matrix3, ...) 
```

或者：

```
new_matrix = sum(matrix1, matrix2, matrix3, ..., default=[]) 
```

或使用列表列表：

```
new_matrix = list(itertools.chain(*matrices) 
```

或者：

```
new_matrix = sum(*matrices, default=[]) 
```

# ios - SDWebImage NSURLRequests 间歇性失败

> ID：16201858
> 
> 赞同：2
> 
> 时间：2013-04-24T20:47:27.703
> 
> 标签：ios, xcode, uicollectionview, nsurlrequest, sdwebimage

我正在使用 SDWebImage 将图像从远程服务器加载到 UICollectionView 中，使用以下代码：

```
[myCell.imageView setImageWithURL:imgURL placeholderImage:nil options:SDWebImageRetryFailed success:^(UIImage *image)
 {
     [_imageCache storeImage:image forKey:[imgURL absoluteString] toDisk:YES];
 } failure:^(NSError *error){
     NSLog(@"ERROR: %@", error);
 }]; 
```

对于大多数单元格，此代码工作正常 - 它加载图像并将它们保存到我的本地磁盘。但是，在几张（似乎是随机的？）图像之后，它们会停止加载。然后我收到以下错误：

```
ERROR: Error Domain=NSURLErrorDomain Code=-1001 "The request timed out." UserInfo=0x1d33fdc0 {NSErrorFailingURLStringKey=http://path/to/image.jpg, NSErrorFailingURLKey=http://path/to/image.jpg, NSLocalizedDescription=The request timed out., NSUnderlyingError=0x1d34c0f0 "The request timed out."} 
```

发生这种情况时，我的应用程序似乎完全停止发送 NSURLRequests。一段时间后，大约 20-30 秒，我可以刷新表格，失败的图像将正确加载，应用程序将恢复对所有 NSURLRequests 的响应。

我发现如果我快速向下滚动我的收藏视图，这种情况往往会更频繁地发生。会不会尝试一次下载太多？有没有办法限制并发下载的数量？此方法似乎在最新的 SDWebImage 代码中已被弃用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T18:39:41.253

弄清楚了。我在我的应用程序的另一部分使用 MWPhotoBrowser。MWPhotoBrowser 带有旧版/修改版的 SDWebImage。我从 Github 下载了最新版本的 SDWebImage，重命名/重构了所有文件，并将我新更新和修改的 SDWebImage 与 MWPhotoBrowser 所依赖的文件一起导入。

新版SDWebImage彻底解决了我的问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:07:50.087

最好使用共享管理器的异步下载，并在使用 SDWebImage 完成下载时显示。现在，您可以快速滚动进行测试。

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)cv cellForItemAtIndexPath:(NSIndexPath *)indexPath
{

    MyCell *myCell = (MyCell *)[cv dequeueReusableCellWithReuseIdentifier:@"MyCell" forIndexPath:indexPath];
    //Set placeholder
    myCell.imageView.image = [UIImage imageNamed:@"placeholder.png"];

    NSURL *cellImageURL = [NSURL URLWithString:[NSString stringWithFormat:@"%@",[self.collectionData objectAtIndex:indexPath.row]]];
    [myCell.cellIndicator startAnimating];

    SDWebImageManager *manager = [SDWebImageManager sharedManager];
    [manager downloadWithURL:cellImageURL
                    delegate:self
                     options:0
    success:^(UIImage *image, BOOL cached)
    { 
        //Display when finish download
        myCell.imageView.image = image;
        [myCell.cellIndicator stopAnimating];
    } failure:nil];

    return cell;

} 
```

*编辑：如果设备上的问题仍未解决：尝试分开下载和显示

```
@interface ViewController ()
@property (retain , nonatomic) NSMutableArray *linksArray;
@property (retain , nonatomic) NSMutableArray *imagesArray;
@end

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self initLinksArray];
//Add placehoder.png to your imagesArray
    [self initImagesArray];
//Download to NSMultableArray
    [self performSelectorInBackground:@selector(downloadImages) withObject:nil];

}

- (void)initImagesArray{
    self.imagesArray = [[[NSMutableArray alloc] init] autorelease];
    for (NSInteger i = 0; i < self.linksArray.count; i++) {
        [self.imagesArray addObject:[UIImage imageNamed:@"placeholder.png"]];
    }
}

- (void)downloadImages{
    for (NSInteger i = 0; i < self.linksArray.count; i++) {
        NSURL *cellImageURL = [NSURL URLWithString:[self.linksArray objectAtIndex:i]];

        SDWebImageManager *manager = [SDWebImageManager sharedManager];
        [manager downloadWithURL:cellImageURL
                        delegate:self
                         options:0
                         success:^(UIImage *image, BOOL cached)
         {
             [self.imagesArray replaceObjectAtIndex:i withObject:image];
         } failure:nil];
    }
}
- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
{
    return [self.imagesArray count];;
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)cv cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    SDCell *cell = (SDCell *)[cv dequeueReusableCellWithReuseIdentifier:@"SDCell" forIndexPath:indexPath];
    cell.cellImageView.image = [self.imagesArray objectAtIndex:indexPath.row];
    return cell;
} 
```

# ssrs-2008 - 数学运算符参数

> ID：16201860
> 
> 赞同：2
> 
> 时间：2013-04-24T20:47:34.463
> 
> 标签：ssrs-2008, reporting-services, ssrs-grouping

我想知道我们是否可以在报告的参数中使用数学运算符。

我有一个名为“EMP_Attendance”的参数。

我想让参数显示和运行带有值的报告

范围：

EMP_出勤

```
 = 100.00%
           <100.00% and >=90.00%
           <90.00% and >=80.00%
           <80.00% 
```

报告应根据此值运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:19:57.673

这本来是不可能的，但有一些解决方法。

1.  使用上面的四个选项创建一个可见参数。
2.  创建两个由两个虚拟 sql 填充的内部参数，一个`lower`和一个`upper`。
3.  使查询根据用户选择产生适当的上限和下限，例如如果选择 100% `lower`= 100 和`upper`= 101。
4.  按这两个限制过滤数据集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T16:12:38.273

首先，您将向参数添加 4 个可用值，标签为“100%”等，值为 1、2、3、4。

然后你有 2 个过滤选项。

1.  您可以在查询中添加类似这样的内容：

    ```
    SELECT case when EMP_Attendance = 100 then 1 
    when EMP_Attendance <100 and EMP_Attendance >=90.00% then 2
    when EMP_Attendance <90 and EMP_Attendance >=80 then 3
    else 4 end as AttendanceGroup
    WHERE AttendanceGroup = @AttendanceParameter 
    ```

2.  另一种选择是保持查询不变，以便将所有数据返回到报告中。右键单击表并转到其属性。转到过滤器。在此处添加过滤器以将您的参数与 EMP_Attendance 值进行比较。

# java - 系统在线或离线解决方案

> ID：16201865
> 
> 赞同：3
> 
> 时间：2013-04-24T20:47:48.330
> 
> 标签：java, primefaces, distributed-transactions, distributed-system

我工作的公司有一个网络系统，一些模块将在工作中使用，这些模块并不总是连接到互联网。在施工中部署系统的 Web 模块的最佳解决方案是什么？系统无法读取/写入数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T07:01:01.547

[由于CAP 定理](http://en.wikipedia.org/wiki/CAP_theorem)，这个问题没有完美的解决方案。不过，如果有的话，分布式系统会容易得多:)

在我看来，你有几个选择。所有选项都需要数据客户端的副本，以便客户端至少可以在断开连接时读取数据。

1.  不允许不一致的写入，只允许不一致的读取。

    *   每当客户端断开网络时，客户端或服务器都会获得数据的写所有权。拥有数据的任何一方都被允许写入，而另一方必须读取数据的潜在陈旧本地副本（或者如果这样做可能会产生错误，或者至少告诉用户数据是陈旧的）。如果您有多个客户端同时运行，这将更加困难。

    *   一种类似的方法是在您知道没有客户端在工作时运行所有服务器端写入操作（即在午夜运行您的所有作业）。这很简单，但它适用于许多应用程序。

2.  允许不一致，然后再处理它们。当您必须能够同时写入断开连接的网络的两端时，这是唯一的方法。但是，根据您的设计，有几种方法可以缓解不一致问题：

    *   如果您可以使所有转换可交换（您可以更改转换的顺序并且结果将相同），您可以存储在客户端和服务器上执行的转换，然后在客户端重新连接时应用来自客户端的任何缓存到服务器。这使得处理不一致变得非常简单。这就是 ATM 与银行网络断开连接时所做的事情——它们的交换转换类似于“从账户 #12345 中扣除 50 美元”。请注意，这仍然可能导致无效状态 - 用户可以通过访问多个与银行网络断开连接的 ATM 来扣除比他们帐户中的更多的金额。但是，银行通过在 ATM 重新连接到网络时收取透支费用来弥补这一点，因此它们通常不会因此而损失任何资金。

    *   如果冲突很少，你可以告诉客户端的用户，“嘿，你是在离线时写的，但是服务器上的值发生了变化——我应该保留哪个副本？” 这存在您可能需要多次询问的问题，因为用户必须对正在更改的值执行原子[CAS 操作](http://en.wikipedia.org/wiki/Compare-and-swap)，并且多个客户端可能同时重新连接。如果您不小心，这种方法也可能会遇到[ABA 问题](http://en.wikipedia.org/wiki/ABA_problem)（但这取决于您在做什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:53:52.450

您可以拥有在您的网络服务器上运行的本地数据库。每 15 分钟检查一次是否存在连接，并将更改从本地数据库传输到“真实”数据库。

# vb.net - VB.Net 将新表单实例作为单独的进程打开

> ID：16201868
> 
> 赞同：1
> 
> 时间：2013-04-24T20:48:02.647
> 
> 标签：vb.net, pid, toolstripmenu

我正在尝试使用新的进程 ID 启动我的应用程序的单独实例。有没有办法做到这一点？以下代码将显示一个单独的表单，但它共享原始表单的进程 ID：

```
Private Sub NewToolStripMenuItem_Click(sender As System.Object, e As System.EventArgs) Handles NewToolStripMenuItem.Click
    Dim SecondForm As New MyForm()
    SecondForm.Show()
End Sub 
```

当用户从工具条菜单中选择“新建”选项时，我基本上想复制与打开应用程序相同的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:55:32.647

我找到了我想要做的事情的解决方案。

```
Private Sub NewToolStripMenuItem_Click(sender As System.Object, e As System.EventArgs) Handles NewToolStripMenuItem.Click        
    Dim ExePath As String = Application.ExecutablePath
    Process.Start(ExePath)
End Sub 
```

# xml - 为什么 XML 在 notepad++ 和 notepad 中看起来不同？

> ID：16201869
> 
> 赞同：-2
> 
> 时间：2013-04-24T20:48:03.823
> 
> 标签：xml, tags, formatting, notepad++, notepad

**更新**

好的，所以文件看起来不同的原因是 EOL（行尾）在 UNIX 和 Windows 格式中不同。记事本无法处理 UNIX EOL，因此它将 XML 全部放在一行上。Notepad++ 处理这两者，因此它知道在显示文件时如何正确格式化文件。将 Edit->EOL Conversion 中的 EOL（注意这一点 +1 到 Uberfuzzy）更改为 windows 将使记事本可以正确查看文件。

**原帖**

好的，所以这个问题源于我创建的另一个问题，我将在下面链接，我想知道为什么 XML 以它的方式工作。因此，我在 notepad++ 中打开了一个 XML 文件，如下所示：

```
<?xml version="1.0"?>
<settings>
    <tag_1>some tag content</tag_1>
    <tag_2/>
</settings> 
```

在旧的简单记事本中打开的相同文件看起来像这样

```
<?xml version="1.0"?><settings> <tag_1>some tag content</tag_1> <tag_2/></settings> 
```

现在，回到记事本++，我使用“插件-> XML 工具-> 线性化 XML”，然后使用“插件-> XML 工具-> 漂亮打印（仅限 XML - 带换行符）”（感谢如何[在记事本++中格式化 XML？](https://stackoverflow.com/questions/3961217/how-to-format-xml-in-notepad)帮我弄清楚）现在，该文件看起来与以前在记事本++中所做的相同，但在记事本中现在看起来像

```
<?xml version="1.0"?>
<settings>
    <tag_1>some tag content</tag_1>
    <tag_2/>
</settings> 
```

我的另一个问题，可以在这里找到[如何在 ACE 中加载 XML？](https://stackoverflow.com/questions/16146059/how-to-load-xml-in-ace)如果它在记事本中看起来正确，则仅正确加载 XML。**那么为什么 XML 在 notepad++ 和 notepad 中看起来不一样呢？**有没有我不知道被使用的角色？还是notepad++自动格式化XML，因为它知道如何读取标签？我不知道...任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T20:50:23.787

这是因为在你的 XML 中换行的换行符，普通的旧记事本需要 Windows 换行符。

对于 Windows，它是：\r\n

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:15:30.453

记事本使用标准的 Windows 样式换行符 (CRLF)，而 Unix 使用 (LF)。我认为您的 XML 文件是 Unix 格式的文本文件，这就是记事本无法正确显示它的原因。在您使用 Notepad++ 中的插件之后，它必须在您的文件中添加了系统特定的新行，但这是我所做的假设。

# android - Android 搜索和 Listview 键盘

> ID：16201871
> 
> 赞同：0
> 
> 时间：2013-04-24T20:48:07.530
> 
> 标签：android, keyboard, editview

我有一个带有 Search EditView 和 ListView 的简单视图。

当 Activity 出现时，键盘会自动出现，光标在 Search 中。

我该如何阻止它这样做。我希望只有在用户点击搜索框后才会出现键盘。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<EditText
    android:id="@+id/search"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Search"
    android:inputType="text" />
<ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:listSelector="@drawable/list_selector" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:57:38.450

添加

```
android:focusable="true" 
```

和

```
android:focusableInTouchMode="true" 
```

父级中的元素`EditText`

一定是

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:focusable="true" 
    android:focusableInTouchMode="true">
<EditText
    android:id="@+id/search"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Search"
    android:inputType="text" />
<ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:listSelector="@drawable/list_selector" />
</LinearLayout> 
```

希望有帮助

# python - Matplotlib 生成这样的圆形图？

> ID：16201884
> 
> 赞同：1
> 
> 时间：2013-04-24T20:48:43.580
> 
> 标签：python, matplotlib, plot

有谁知道是否可以在 matplotlib 中生成这样的图？图片取自以下[页面](http://blog.stephenwolfram.com/2013/04/data-science-of-the-facebook-world/)。如果没有，还有另一种“python”解决方案来生成这样的图吗？

![](https://i.stack.imgur.com/g0eWK.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T20:55:42.500

您想使用负责[`networkx`](http://networkx.github.io/)布局和绘图的包（如果需要，可以通过 matplotlib）。

# c# - Log4net 自定义 ADO Appender（无配置）：数据未进入数据库

> ID：16201888
> 
> 赞同：0
> 
> 时间：2013-04-24T20:48:56.000
> 
> 标签：c#, oracle, log4net, log4net-appender

使用 log4net (C#) 和 Oracle，我正在尝试创建一个自定义 ADO Appender，这样我就不需要使用配置文件。到目前为止我的代码

```
public static void CreateAppender()
{
    var hierarchy = (Hierarchy)LogManager.GetRepository();
    hierarchy.Root.RemoveAllAppenders();

    var ADOAppender = new AdoNetAppender();
   AddDateTimeParameterToAppender(ADOAppender, ":log_date", "log4net.Layout.RawTimeStampLayout");
   AddStringParameterToAppender(ADOAppender, ":thread", 255, "%thread");
   AddStringParameterToAppender(ADOAppender, ":log_level", 50, "%level");
   AddStringParameterToAppender(ADOAppender, ":logger", 255, "%logger");
   AddStringParameterToAppender(ADOAppender, ":message", 30000, "%message");

   ADOAppender.ConnectionType =
            "System.Data.OracleClient.OracleConnection, System.Data.OracleClient, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089";

   ADOAppender.CommandText =
            "INSERT INTO Log (Datetime,Thread,Log_Level,Logger,Message) VALUES (:log_date, :thread, :log_level, :logger, :message)";

   ADOAppender.ConnectionString = "data source=[db];User ID=[id];Password=[pass]";

   ADOAppender.BufferSize = 1;

  ADOAppender.ActivateOptions();

  log4net.Config.BasicConfigurator.Configure(ADOAppender);
}

public static void AddDateTimeParameterToAppender(AdoNetAppender appender, string paramName, string conversionPattern)
{
       var param = new AdoNetAppenderParameter { ParameterName = paramName, DbType = System.Data.DbType.DateTime, Layout = new Layout2RawLayoutAdapter(new PatternLayout(conversionPattern)) };
   appender.AddParameter(param);
}

public static void AddStringParameterToAppender(AdoNetAppender appender, string paramName, int size, string conversionPattern)
{
   var param = new AdoNetAppenderParameter
   {
      ParameterName = paramName,
      DbType = System.Data.DbType.String,
      Size = size,          
      Layout = new Layout2RawLayoutAdapter(new PatternLayout(conversionPattern))
   };
appender.AddParameter(param);

} 
```

我没有收到任何异常，但没有数据被插入到数据库中。我几乎肯定它与参数有关，因为当我将所有值设置为 null 时，它会起作用。

有谁看到我做错了什么？我用谷歌搜索了很多，但我发现的例子都没有使用 ADO Appender。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:33:58.810

我对 ADONetAppender 也有过类似的经历。你打开内部log4net调试了吗？我不记得我的问题的具体细节，但在打开调试后我能够弄清楚。

[http://logging.apache.org/log4net/release/faq.html#internalDebug](http://logging.apache.org/log4net/release/faq.html#internalDebug)

另外，我确定您有，但请确保您的项目中有“XmlConfigurator”行。

此处的详细信息： [Log4Net 未写入数据库](https://stackoverflow.com/questions/11015192/log4net-not-writing-to-the-database?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T15:57:38.667

托比，感谢您的回复，我知道我做错了什么。添加 DateTime 参数时，当需要 RawTimeStampLayout() 时，我将布局设置为 Layout2RawLayoutAdapter。我需要替换`Layout = new Layout2RawLayoutAdapter(new PatternLayout(conversionPattern))`为`Layout = new RawTimeStampLayout()`. 我更新的 AddDateTimeParameterToAppender 方法看起来像这样..

```
public static void AddDateTimeParameterToAppender(AdoNetAppender appender, string paramName)
{
    var param = new AdoNetAppenderParameter
    {
        ParameterName = paramName, 
        DbType = System.Data.DbType.DateTime,
        Layout = new RawTimeStampLayout()
    };

    appender.AddParameter(param);
} 
```

# python - 在 Python 中区分标量、列表和字典参数的最佳方法是什么？

> ID：16201890
> 
> 赞同：5
> 
> 时间：2013-04-24T20:49:01.763
> 
> 标签：python, types, python-2.7, polymorphism

我想要一个函数，它通常接受 X 类型的参数，其中 X 是标量、列表或字典，并根据其他信息返回具有相同键值的 X 列表。

```
def foo(info, k):
   return [bar(item,k) for item in processInfo(info)]

def bar(item, keydata):
   # pseudocode follows.
   # What we want to do is return an output of parallel type to the input key k,
   # using the key data to lookup information from the input item.
   if keydata is a scalar:
      return item[keydata]
   elif keydata is a list:
      return [item[k] for k in keydata]
   elif keydata is a dict:
      return dict((k,item[v]) for (k,v) in keydata.iteritems())
   else:
      raise ValueError('bar expects a scalar, list, or dict') 
```

我的问题是，如何在这三种类型之间进行调度？

* * *

编辑：字符串将被解释为标量，而不是列表/可迭代。元组将被解释为可迭代的。

编辑 2：我想要鸭式打字，而不是严格打字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T21:29:59.447

你需要以正确的顺序做事，因为`str`类型`dict`是可迭代的。

```
from collections import Iterable, Mapping  # in Python 3 use from collections.abc

def bar(item, keydata):
    if isinstance(keydata, Mapping):
        return {k: item[v] for (k,v) in keydata.iteritems()}
    elif isinstance(keydata, Iterable) and not isinstance(keydata, str):
        return [item[k] for k in keydata]
    return item[keydata] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:03:45.677

这取决于您对输入的要求有多严格。该`isinstance`方法强制您指定要接受的类型（即，没有鸭子类型）。只要您的用户只传入这些类或这些类的子类型，它就可以工作。您也可以尝试通过参数支持的方法来区分参数。这方面的一个例子是

**编辑**：添加了字符串的特殊情况

```
if isinstance(keydata, basestring):
    # special case to avoid considering strings as containers
    # for python 3.x use str instead of basestring
    return item[keydata]
try:
    return dict((k,item[v]) for (k,v) in keydata.iteritems())
except AttributeError:
    # it's not a dict-like
    pass
try:
    return [item[k] for k in keydata]
except TypeError:
    # it's not iterable
return item[keydata] 
```

控制流的选择取决于您想要的灵活性，以及​​您希望如何处理模棱两可的情况。例如，字符串被认为是字符序列还是标量？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T20:57:58.243

通过导入集合使用新的花哨的东西:)

```
>>> isinstance([], collections.Sequence)
True
>>> isinstance({}, collections.Mapping)
True 
```

您还应该考虑查看[类型](http://docs.python.org/2/library/types.html)模块

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:53:42.943

```
if isinstance(keydata,(int,float,str)): #scalar

elif isinstance(keydata,(list,tuple)):#iterable

elif isinstance(keydata,dict):#dictionary 
```

也许？？（我可能遗漏了几种类型）...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T21:05:35.230

或者你可以使用type，但是根据[http://docs.python.org/2/library/functions.html#type推荐使用isinstance](http://docs.python.org/2/library/functions.html#type)

```
if type(asd) in (int, str):
    print 'asd is int or str' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T21:59:25.210

感谢您所提供的所有信息！

我最终这样做了，因为我必须`keydata`在迭代信息之前对 进行一些预处理：

```
def asKVlists(keydata):
    # return a tuple (keys, values, isScalar)
    # where keys and values are iterable
    if not isinstance(keydata, basestring):
        # check for dict behavior:
        try:
            return zip(*keydata.iteritems()) + [False]
        except AttributeError:
            pass

        # otherwise check for list behavior
        # make sure we can iterate over it
        try:
            iter(keydata)
            return (None, keydata, False)
        except TypeError:
            pass
    return (None, (keydata,), True) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-09T21:48:23.213

```
def is_scalar(x):
    return hasattr(x, 'lower') or not hasattr(x, '__iter__') 
```

然后，您永远不必担心失败，`isinstance`因为有人实现了从意外事件中继承的可迭代子类。

# vim - 混合两个语法高亮脚本

> ID：16201896
> 
> 赞同：26
> 
> 时间：2013-04-24T20:49:29.823
> 
> 标签：vim

我用 Jekyll 写博客文章，为此我最终在同一个文件中使用了三种不同的语言：YAML 用于发布元数据，Markdown 用于正文，C++ 用于代码片段。

我尝试设置一个脚本，以便我可以让 vim 为我正确突出显示所有三个，最后在 syntax/jekyll.vim 中得到类似这样的内容：

```
" Build upon Markdown syntax
runtime! syntax/markdown.vim

" pretend there's no syntax loaded
unlet b:current_syntax
" Bring in YAML syntax for front matter
syntax include @Yaml syntax/yaml.vim
syntax region yamlFrontmatter start=/\%^---$/ end=/^---$/ keepend contains=@Yaml

" pretend there's no syntax loaded
unlet b:current_syntax
" Bring in C++11 syntax for code snippets
syntax include @Cpp syntax/cpp.vim
syntax region cppCodeSnippet matchgroup=Comment start=/^{% highlight cpp %}$/ end=/^{% endhighlight %}$/ keepend contains=@Cpp

let b:current_syntax='jekyll' 
```

我还设置了一个文件检测脚本来设置`ft`这个语法。

它*几乎*可以工作。当我打开一个被检测为这种类型的文件时，我得到的一切都是正确的，*除了*C++ 亮点。但是，如果我`:syn on`在那之后输入，一切正常。我可以删除缓冲区并再次打开文件，所有亮点都可以。如果我关闭 vim 并重新启动它，我需要`:syn on`再次运行。

我错过了什么？我该如何调试这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-09T23:00:00.120

**快速修复：**附加`syntax on`到您的最后一行，这与实时会话中的 `.vimrc`设置相同。`:syn on`

**没那么快：**

看起来您可能已经将自定义的 'jekyll' 语法与`$VIMRUNTIME`.

根据[自定义语法的 Vim wiki 部分](http://vim.wikia.com/wiki/Creating_your_own_syntax_files#Install_the_syntax_file)，最好将所有个人自定义保留在`~/.vim`. 例如，将您的`jekyll.vim`语法放在`~/.vim/syntax/`.

> 不要使用包含随 Vim 分发的文件的目录，因为它会在升级期间被覆盖（特别是不要使用 $VIMRUNTIME 目录）。

在[Vim 语法文档](http://vimdoc.sourceforge.net/htmldoc/syntax.html)中：
`:syntax enable`运行 ':source $VIMRUNTIME/syntax/DEFAULT_SYNTAX.vim'。
`:syn on`（或者`:syntax on`）将“用默认值推翻您的设置”。

所以如果设置`:syntax on`使您的自定义语法工作，它必须包含在默认语法集中。

尝试保留所有自定义内容`~/.vim`，看看是否可以解决问题。

# php - 我如何使用 php 在 mtgox 股票代码 API 中读出一个特定值

> ID：16201900
> 
> 赞同：0
> 
> 时间：2013-04-24T20:49:38.940
> 
> 标签：php, arrays, api

与： [https ://github.com/1360/mtgox-api-v1-php-class/blob/master/mtGox.class.php](https://github.com/1360/mtgox-api-v1-php-class/blob/master/mtGox.class.php)

+

```
echo '<pre>' . print_r($gox->getTicker(),true) . '</pre>'; 
```

我得到了 mtgox-api 的所有股票信息。

-> 我怎样才能只读出一个值，例如最后购买的价格：

```
[buy][value_int] 
```

= 11350000

? 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:13:36.683

假设`$gox->getTicker()`返回一个数组，您可以像这样引用数组的元素：

```
$response = $gox->getTicker();
echo $response['buy']['value_int']; 
```

# makefile - 将文件放入不同文件夹时的通用制定规则帮助

> ID：16201901
> 
> 赞同：0
> 
> 时间：2013-04-24T20:49:40.810
> 
> 标签：makefile

我有一个这样的规则。我希望它定义一个通用规则，描述将任何 C 文件转换为已编译的 Object 文件。它工作正常，但我想将我的 C 文件保存在一个文件夹中，并将输出文件保存在另一个文件夹中。

这是 Makefile 本身的相关片段：

```
 .SUFFIXES .c .o

.c.o :
    $(GCC) -c $(CFLAGS) $< -o $@ 
```

我想修改这个makefile规则，告诉make在一个文件夹中找到源（C）文件，比如说`$(C_DIR)`，运行GCC，然后把OBJ文件放进去`$(O_DIR)`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:53:06.760

您不能使用后缀规则来做到这一点。为此，您必须使用非 POSIX 标准的 make 功能。GNU make（例如 GNU/Linux 系统上的标准 make，几乎可用于任何其他平台）提供了可以做到这一点的模式规则：

```
SRCS = foo.c bar.c baz.c

OBJS = $(addprefix $(O_DIR)/,$(SRCS))

all: $(OBJS)

$(O_DIR)/%.o : $(C_DIR)/%.c
        $(CC) -c $(CPPFLAGS) $(CFLAGS) -o $@ $< 
```

# rest - WebAPI 中实体的 RESTful 归档

> ID：16201905
> 
> 赞同：17
> 
> 时间：2013-04-24T20:49:51.397
> 
> 标签：rest, web-applications, asp.net-web-api, single-page-application

我已经在我的 WebAPI 项目中非常轻松地实现了 CRUD 功能。我现在正在尝试实现对象的存档（不是完全删除） - 如果只有`ARCHIVE`HTTP 方法。

我看到两个选项：

1)`isArchived`作为每个可归档实体的属性，即使归档与请求无关，它也必须包含在 PUT 和 POST 请求中。归档一个实体将是一个调用`PUT /api/object/id`isArchived 设置为 true 的问题。电线上看起来很笨重，但很安静。

2）有一个`PUT /api/object/id/archive`不需要正文的RPC-ish url。似乎是最有效率的，但并不安宁。

“通过 api 调用归档我的东西”空间中的每个人都在做什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2019-07-12T01:37:02.787

这是一个很好的问题，但我怀疑它最终可能会被标记为固执己见，因为我没有看到正确的答案……正如 OP 所说。

如果这对您的系统有意义，我建议将存档视为单独的对象存储（或者甚至是不同的对象类型）。对象设计不应依赖于数据库如何持久化您的数据。

因此，这是我现在能想到的*最 RESTful*设计（假设归档和更新始终是独立的操作——它们应该是）：

典型（每个人都知道）：

```
GET     /api/object     get all current objects
POST    /api/object     new current object
PUT     /api/object/id  update current object
DELETE  /api/object/id  delete current object
GET     /api/object/id  get current object 
```

诡异之处：

```
POST    /api/object/id/archive  move object to archive (makes some REST sense)
POST    /api/object/id          move object from archive (muddy) 
```

档案：

```
GET     /api/object/archive     get all archive objects
PUT     /api/object/id/archive  update archive object (if possible)
DELETE  /api/object/id/archive  delete archive object (tempting for unarchive)
GET     /api/object/id/archive  get archive object 
```

或者，也许是存档 URL 的这些 mod 之一：

```
GET     /api/object/archive/id  get archive object
GET     /api/objectarchive/id   get archive object 
```

# 但......

对于将对象移入和移出存档，上述内容感觉非常混乱（不是非常自我记录）。它还导致一些 REST API 设计痛苦，其中更新/删除/获取存档对象可能不需要特定于存档的功能。因此，我最终确定了这一点：

```
GET     /api/object                     get all objects
GET     /api/object?archived=false      get all current objects
GET     /api/object?archived=true       get all archive objects

POST    /api/object         new current object, returns all current objects*
PUT     /api/object/id      update object (current or archived; cannot change archive state)
DELETE  /api/object/id      delete object (current or archived), returns objects of same archive state as deleted*
GET     /api/object/id      get object    (current or archived)*

PUT /api/object/id/archive body:{archived:true}     move object to archive, returns all current objects*
PUT /api/object/id/archive body:{archived:false}    move object from archive, returns all archive objects*

* Return could be expanded/overridden with a query string if design calls for it. 
```

诚然，这与我之前将存档视为单独的对象存储的说法大相径庭。然而，这种思考过程最终导致了这种设计妥协。在大多数方面，这对我来说感觉很好。

我个人不同意将查询字符串用于……呃……查询。所以，我没有。数据更改的有效负载——无论多么小——都应该进入正文（即当它不适合 REST 动词和 URL 时）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T11:30:54.620

如果您总是存档特定资源并且从不删除它，我会重新使用 DELETE 来实际存档。如果您真的需要区分删除和存档，我会这样做

```
GET /foo/33

200 OK
<foo id="33">blah</foo>

POST /archive
<foo id="33">blah</foo>

201 Created
Location: http://example.org/archive/foo/33 
```

要不就

```
POST /archive?target=http://example.org/foo/33

201 Created
Location: http://example.org/archive/foo/33 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:07:32.653

我会使用这种`/api/object/id?archive=true`方法。

但是，至于你应该使用 PUT 还是 POST 取决于。如果您使用 PUT，则对同一 URL 的任何后续调用都不会更改有关资源的任何内容。如果您使用 POST，则实施者期望对该 URL 的任何后续调用确实会更改状态。（不要问我怎么做，我假设你会在这个上使用 PUT 动词。）

这是因为 PUT 操作应该是幂等的。请参阅此处的第 9.1.2 节：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec9.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T20:58:28.063

我可能会使用`/api/object/id`带有查询参数的端点，所以它看起来像`/api/object/id?isArchived=true`. 您仍然可以使用您正在使用的任何 HTTP 动词。

# r - 如何获得特定点的核密度估计值？

> ID：16201906
> 
> 赞同：16
> 
> 时间：2013-04-24T20:49:57.800
> 
> 标签：r, kernel-density

我正在尝试处理 R 中的过度绘图的方法，我想尝试的一件事是绘制单个点，但根据其邻域的密度对它们进行着色。为了做到这一点，我需要计算每个点的 2D 内核密度估计。然而，标准的核密度估计函数似乎都是基于网格的。是否有用于计算我指定的特定点的 2D 内核密度估计的函数？我会想象一个将 x 和 y 向量作为参数并返回密度估计向量的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T04:26:04.140

如果我了解您想要做什么，可以通过将平滑模型拟合到网格密度估计值，然后使用它来预测您感兴趣的每个点的密度来实现。例如：

```
# Simulate some data and put in data frame DF
n <- 100
x <- rnorm(n)
y <- 3 + 2* x * rexp(n) + rnorm(n)
# add some outliers
y[sample(1:n,20)] <- rnorm(20,20,20)
DF <- data.frame(x,y)

# Calculate 2d density over a grid
library(MASS)
dens <- kde2d(x,y)

# create a new data frame of that 2d density grid
# (needs checking that I haven't stuffed up the order here of z?)
gr <- data.frame(with(dens, expand.grid(x,y)), as.vector(dens$z))
names(gr) <- c("xgr", "ygr", "zgr")

# Fit a model
mod <- loess(zgr~xgr*ygr, data=gr)

# Apply the model to the original data to estimate density at that point
DF$pointdens <- predict(mod, newdata=data.frame(xgr=x, ygr=y))

# Draw plot
library(ggplot2)
ggplot(DF, aes(x=x,y=y, color=pointdens)) + geom_point() 
```

![在此处输入图像描述](https://i.stack.imgur.com/O6Ggr.png)

或者，如果我只是改变 n 10^6 我们得到

![在此处输入图像描述](https://i.stack.imgur.com/pa4at.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-02T20:00:39.877

我最终找到了我正在寻找的精确功能：`interp.surface`从[`fields`](https://cran.r-project.org/web/packages/fields/index.html)包中。从帮助文本中：

> 使用双线性权重将矩形网格上的值插入到任意位置或另一个网格。

# android - 优化 Android ListView 加载数据

> ID：16201912
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:50:16.753
> 
> 标签：android, listview, android-arrayadapter

我有一个`ListView`用于`ArrayAdapter`加载数据的。中记录的加载方法`ListView`是从我的应用程序启动并读取目录中的文件。

我正在考虑将这些记录保存在数据库中，以便当它再次启动时，如果不是数据库，则不要读取目录，但我希望得到您的建议，以便在第一次加载后加载更快的记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:56:07.617

您需要阅读什么样的信息以及您的应用程序将用于什么用途？如果这是用户知道他/她必须等待的任务，您可以部署任何描述的加载方法，将所有内容加载到内存中并稍后构建 ListView。

你能描述一下这份清单会有哪些“变化”吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:57:27.337

这取决于文件解析的大小和处理密集程度。您需要测试以查看查询数据库是否比仅解析/缓存文件数据实际上更快。除非您的数据集相对较小且处理过程不是很密集，否则您很可能会发现查询数据库更快。只需确保您没有处理您的数据 - 通过读取文件或在 UI 线程上查询数据库！

这是有关如何确保不会发生这种情况的[文档。](http://developer.android.com/guide/components/loaders.html)

此外，CommonsWare (sp?) 有一个很棒的加载程序库，可以与您的 sqlite 数据库一起使用，如果这是您选择的方式。也可以查看那里的[其他库](https://github.com/commonsguy/cwac-loaderex)。

# loops - 带有模数运算符更改方法的“if”语句在按钮按下时调用

> ID：16201917
> 
> 赞同：1
> 
> 时间：2013-04-24T20:50:39.660
> 
> 标签：loops, if-statement, jtextfield

基本上它应该是一个按钮，用于切换 JTextfield 是否可编辑

我几乎 100% 确定有更好的方法来做到这一点（这不起作用）我猜是一个 for 循环？

```
while (e.getSource() == button2)
    {
        int count=0;//odd
        if (count % 2 == 0) // if count is even
        {
            textField1.setEditable(false);
            button2.setEnabled(true);
            count++;
        }        
        else//odd
        {
            textField1.setEditable(true);
            count++;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:50:37.527

将 if/else 语句放在按钮`onClick()`方法中，这样每次单击按钮时都会调用它。完全删除 while 循环。将您的计数变量声明并初始化为全局变量（在活动顶部，类名下方），而不是局部变量。在方法中增加计数变量`onClick()`，但在 if/else 语句之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:57:48.937

你应该移动 int count = 0; 前一阵子。

这将防止在每次迭代时重置计数，并有助于跟踪印刷机。现在，当检查条件时，count 总是等于 0

# python - Bulbflow 无法创建 Dictionary 属性类型

> ID：16201919
> 
> 赞同：1
> 
> 时间：2013-04-24T20:50:42.923
> 
> 标签：python, neo4j, bulbs

我使用[灯泡](https://github.com/espeed/bulbs)来处理 python 中的 neo4j 操作。问题是当我尝试使用包含字典的属性创建节点时：

```
g.mynode.create(title='Mi Node', fields={'name': 'testNode'}) 
```

我最终收到以下错误：

```
*** SystemError: ({'status': '200', 'content-length': '109', 'content-encoding':
 'UTF-8', 'server': 'Jetty(6.1.25)', 'access-control-allow-origin': '*', 'content-
 type': 'application/json'}, '"java.lang.IllegalArgumentException:
 Unknown property type on: {name=testNode}, class java.util.LinkedHashMap"') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T03:44:01.787

Neo4j 不支持字典，它只支持包含原始类型的列表，例如 string、int、bool 等（不允许在列表中混合类型）。

以下是 Neo4j 支持的属性类型：

[http://docs.neo4j.org/chunked/preview/graphdb-neo4j-properties.html](http://docs.neo4j.org/chunked/preview/graphdb-neo4j-properties.html)

要在 Neo4j 中存储字典，可以将其保存为 JSON 字符串。

Bulbs 有一种`Document` `Property`类型可以为您进行`dict`<->`json`转换。

看...

*   [https://github.com/espeed/bulbs/blob/master/bulbs/property.py#L453](https://github.com/espeed/bulbs/blob/master/bulbs/property.py#L453)
*   [https://github.com/espeed/bulbs/blob/master/bulbs/json.py#L154](https://github.com/espeed/bulbs/blob/master/bulbs/json.py#L154)
*   [https://github.com/espeed/bulbs/blob/master/bulbs/json.py#L264](https://github.com/espeed/bulbs/blob/master/bulbs/json.py#L264)

如果您使用泛型`Vertex`or `Edge`，则需要在保存之前手动进行此转换：

```
type_system = g.client.type_system
fields = type_system.database.to_document({'name': 'testNode'})
g.mynode.create(title='Mi Node', fields=fields) 
```

但是，如果您使用`Model`, Bulbs 将为您进行转换。只需使用`Document`属性而不是定义您的模型`Dictionary`：

```
# people.py

from bulbs.model import Node, Relationship
from bulbs.property import String, DateTime, Document
from bulbs.utils import current_datetime

    class Person(Node):

        element_type = "person"

        name = String(nullable=False)
        fields = Document()

    class Knows(Relationship):

        label = "knows"

        timestamp = DateTime(default=current_datetime, nullable=False) 
```

...然后您可以像这样使用您的模型...

```
>>> from people import Person, Knows
>>> from bulbs.neo4jserver import Graph

>>> g = Graph()
>>> g.add_proxy("people", Person)
>>> g.add_proxy("knows", Knows)

>>> james = g.people.create(name="James", fields={'name': 'testNode1'})
>>> julie = g.people.create(name="Julie", fields={'name': 'testNode2'})
>>> knows = g.knows.create(james, julie) 
```

请参阅[http://bulbflow.com/docs/api/bulbs/model/](http://bulbflow.com/docs/api/bulbs/model/)

# angularjs - 使用资源时未正确生成 Angular 内容类型

> ID：16201929
> 
> 赞同：6
> 
> 时间：2013-04-24T20:51:04.750
> 
> 标签：angularjs

我尝试了以下命令，使用 Angular 上的资源：

```
angular.module('appServices', ['ngResource']).factory('Example', 
        function($resource){

            return $resource('http://api.example.com.br/teste', {}, {
                query: {method:'GET', headers: {'Content-Type': 'application/json'}}
        });
}); 
```

但未正确生成 http 内容类型，在本例中为“application/json”。

我见过类似的问题，比如[AngularJS 资源没有设置 Content-Type](https://stackoverflow.com/questions/12785386/angularjs-resource-not-setting-content-type)，但我有最新的 Angular 版本（1.0.6/1.1.4）。

上面的代码有什么问题？

**结论**

*   如下所述，HTTP Get 方法不应该有主体。
*   属性标头在上述版本中不起作用。我使用以下命令失败：查询：{method：'POST'，标题：{'Content-Type'：'application/json'}}
*   这种方式对我有用： $http.defaults.headers.put['Content-Type'] = 'application/json';

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-24T22:53:45.077

查看版本 1.1.4 中的[angular source ，第 8742 行：](http://code.angularjs.org/1.1.4/angular.js)

```
 // strip content-type if data is undefined
  if (isUndefined(config.data)) {
    delete reqHeaders['Content-Type'];
  } 
```

`Content-Type`如果请求不包含任何数据（请求正文），则标头将被删除。

我认为这是预期的行为，因为**`GET`requests 没有 body**。

另一方面，POST 方法将按照您的预期设置内容类型，只要它在请求正文中有数据。尝试以下操作：

将方法更改为`POST`

```
query: {method:'POST', headers: {'Content-Type': 'application/json'}} 
```

并使用一些参数调用您的资源操作：

```
Example.query(yourData) 
```

在这种情况下，内容类型设置正确。

**编辑**：

它似乎也适用于 get，在这种情况下，数据在第二个参数中：

```
Example.query(yourParams, yourData) 
```

一个例子：http: [//jsfiddle.net/WkFHH/](http://jsfiddle.net/WkFHH/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:20:00.327

看起来它仍然不受支持 - 如果您必须设置标头，您可以使用[$http 服务](http://docs.angularjs.org/api/ng.%24http)

# php - curl 脚本未正确使用 cookie

> ID：16201930
> 
> 赞同：0
> 
> 时间：2013-04-24T20:51:09.867
> 
> 标签：php, cookies, curl

嗨，我正在尝试创建一个 php 脚本来登录我的 tesco 帐户，但由于某种原因，cookie 无法正常工作，请帮助这里是我的脚本以及下面的脚本示例，以便您查看。

[检查它不起作用](http://cyber-hosted.com/CH/n.php)

```
<?php
$url = "https://secure.tesco.com/register/default.aspx?vstore=0";
//
$h = curl_init();
curl_setopt($h, CURLOPT_URL, $url); 
curl_setopt($h, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($h, CURLOPT_POST, true);
curl_setopt($h, CURLOPT_POSTFIELDS, "form=fSignin&from=https%3A%2F%2Fsecure.tesco.com%2Fclubcard%2Fmyaccount%2Fhome.aspx&formData=bmV3UmVnPWZhbHNlJg%3D%3D&loginID=test%40hotmail.com&password=test&seamlesswebtag=&confirm-signin.x=47&confirm-signin.y=18");
curl_setopt($h, CURLOPT_HEADER, true);
curl_setopt($h, CURLOPT_RETURNTRANSFER, true);
curl_setopt($h, CURLOPT_COOKIE, 'tmpfile.tmp');
curl_setopt($h, CURLOPT_COOKIEJAR, 'tmpfile.tmp');
curl_setopt($h, CURLOPT_COOKIEFILE, 'tmpfile.tmp');
//
$result = curl_exec($h);
echo $result;
?> 
```

有人可以帮我解决这个问题，以便它正确获取和使用 cookie

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:57:25.483

你不需要这条线

```
curl_setopt($h, CURLOPT_COOKIE, 'tmpfile.tmp'); 
```

尝试删除它，如果仍然有问题，请尝试创建 tmpfile.tmp 并将 chmod 设置为 777。

# wordpress - 如何使用 301 重定向和 htaccess 计算图像的文件路径重定向？

> ID：16201939
> 
> 赞同：1
> 
> 时间：2013-04-24T20:51:54.213
> 
> 标签：wordpress, .htaccess, redirect

我遇到了一个奇怪的重定向问题，不知道如何解决它。我将我的 Wordpress 安装在 KatsCafe.org 网站的目录（称为 /Cafe/ ）中，并且所有帖子都被重定向得很好。但是我的大量图像都搞砸了。如果 URL 中没有 /Cafe/，它们将不会重定向，而我的旧图像 URL 都没有包含目录。我的网站图形/图像很重，其中许多出现在 Google 图片搜索中，所以我因此失去了很多流量。

我不知道如何从两个单独的文件路径重定向到当前路径。我最早的文件路径是从我在以前的主机的根目录中安装 Wordpress 时开始的，因此该安装中的图像将具有文件路径：

```
Http://katscafe.org/wp-content/uploads/year/month/name-of-file 
```

到当前图像文件路径，即：

```
Http://katscafe.org/Cafe/wp-content/uploads/year/month/name-of-file 
```

我还有另一个不太重要的重定向我也有一些错误，这是由于我尝试了一个多站点选项的短暂时间（愚蠢的我，我以为我会喜欢不必处理更新等......但我完全太强迫症了，无法享受，哈哈）。由于这意味着我的文件位于多站点目录列表中，因此文件路径将是：

```
Http://katscafe.org/files/year/month/name-of-file 
```

并且仍然需要转发到当前的图像文件路径，这又是：

```
Http://katscafe.org/Cafe/wp-content/uploads/year/month/name-of-file 
```

我不确定我是否忽略了一个可以帮助我解决这个问题的明显工具，但我发现的每个工具都涉及后重定向，而不是文件路径类型的重定向。即便如此，我也不完全确定我有能力完全弄清楚。

对于这方面的任何帮助，我将永远感激不尽！非常感谢！

# html - 如何在 CSS 选择器中排除特定的类名？

> ID：16201948
> 
> 赞同：147
> 
> 时间：2013-04-24T20:52:23.397
> 
> 标签：html, css, css-selectors

当用户将鼠标悬停在类名为`"reMode_hover"`.

**但是如果元素也**有，我不想改变颜色`"reMode_selected"`

注意：我只能使用 CSS 而不是 javascript，因为我在某种有限的环境中工作。

澄清一下，我的目标是在悬停时为第一个元素着色，而不是第二个元素。

**HTML**

```
<a href="" title="Design" class="reMode_design  reMode_hover">
    <span>Design</span>
</a>

<a href="" title="Design" 
 class="reMode_design  reMode_hover reMode_selected">
    <span>Design</span>
</a> 
```

我在下面尝试过，希望第一个定义能起作用，但事实并非如此。我究竟做错了什么？

**CSS**

```
/* do not apply background-color so leave this empty */
.reMode_selected .reMode_hover:hover 
{
}

.reMode_hover:hover 
{
   background-color: #f0ac00;
} 
```

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2013-04-24T20:56:06.517

一种方法是使用多类选择器（没有空格，因为它是后代选择器）：

```
.reMode_hover:not(.reMode_selected):hover 
{
   background-color: #f0ac00;
}
```

```
<a href="" title="Design" class="reMode_design  reMode_hover">
    <span>Design</span>
</a>

<a href="" title="Design" 
 class="reMode_design  reMode_hover reMode_selected">
    <span>Design</span>
</a>
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-04-24T20:56:18.490

在现代浏览器中，您可以：

```
.reMode_hover:not(.reMode_selected):hover{} 
```

有关兼容性信息，请参阅[http://caniuse.com/css-sel3](http://caniuse.com/css-sel3)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-04-24T20:58:58.237

# 方法一

您的代码的问题是您**选择**的`.remode_hover`是. 所以让你的代码正常工作的第一部分是删除那个空间**`.remode_selected`**

 **```
.reMode_selected.reMode_hover:hover 
```

然后，为了使样式不起作用，您必须覆盖由`:hover`. 换句话说，你需要反击`background-color`财产。所以最终的代码将是

```
.reMode_selected.reMode_hover:hover {
  background-color:inherit;
}
.reMode_hover:hover {
  background-color: #f0ac00;
} 
```

[小提琴](http://jsfiddle.net/xgaG8/)

# 方法二

`:not()`如其他人所述，另一种方法是使用。这将返回括号内没有声明的类或属性的任何元素。在这种情况下，你会放在`.remode_selected`那里。这将针对所有没有类的元素`.remode_selected`

[小提琴](http://jsfiddle.net/xgaG8/1/)

但是，我不推荐这种方法，因为它是在 CSS3 中引入的，所以浏览器支持并不理想。

# 方法三

第三种方法是使用 jQuery。您可以定位`.not()`选择器，这类似于`:not()`在 CSS 中使用，但具有更好的浏览器支持

[小提琴](http://jsfiddle.net/xgaG8/3/)**

# java - 数独块检查器 Java

> ID：16201955
> 
> 赞同：0
> 
> 时间：2013-04-24T20:52:59.210
> 
> 标签：java, runtime-error, sudoku

我正在构建一个数独检查器，并且我已经制作了一个行检查器和一个列检查器。我目前正在尝试制作一个块检查器（3x3 块）。对此的任何见解都会很棒。

```
public boolean checkBlock (int col0to2, int row0to2)
 {
   int [] tempArray = new int [3];
   for (int x=0; x<3; x++)
   {
     for (int y=0; y<3;y++)
      {
        if ((board [col0to2+x][row0to2+y]) > 0 && (board [col0to2+x][row0to2+y]) < 10)
        {
          int tempVal = board [col0to2+x][row0to2+y];
          tempArray [tempVal - 1] = tempVal; // i think this line is giving me the run 
                                            // error   
    }
  } 
}
 return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:58:45.540

```
if ((board [col0to2+x][row0to2+y]) > 0 && (board [col0to2+x][row0to2+y]) < 10) {
      int tempVal = board [col0to2+x][row0to2+y];
      tempArray [tempVal - 1] = tempVal; // i think this line is giving me the run error

} 
```

您对 tempval 的边界检查是它应该是 1 到 9（含）。假设它是 9。那么你分配 tempArray[8] = 9。你遇到了一个问题，因为 tempArray 被初始化为一个包含 3 个元素的数组。

我想你想要这样的东西：

`tempArray = new int[9]`

和任务是

`tempArray[x*3 + y] = tempVal`;

虽然我没有对此进行测试，但基本上它会用它找到的每个数字填充数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:59:53.833

由于您需要处理数字 1-9，因此您需要 9 个整数的空间`tempArray`，但您声明它只有 3 个长。此外，您并没有真正检查是否使用了所有数字（并且没有重复）。

```
public boolean checkBlock (int col0to2, int row0to2) {
   int [] tempArray = new int [9];
   for (int x=0; x<3; x++) {
      for (int y=0; y<3;y++) {
         int tempVal = board [col0to2+x][row0to2+y];
         if (tempVal > 0 && tempVal < 10) {
            if (tempArray[tempVal - 1] != 0) {
               return false;
            }
            tempArray [tempVal - 1] = tempVal;
         }
      } 
   }
   return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:00:25.820

有 9 个可能的值，所以你的数组应该是 size `9`，而不是`3`

您只需要计算单元格是否已被填满。如果有，则返回 false。如果你在没有返回 false 的情况下完成它，则返回 true。

`++`使返回的值递增，以便您可以比较它。如果它是 2，那么单元格已经增加了。

## 代码：

```
public class BlockTest {
  public static boolean checkBlock (int col0to2, int row0to2)
  {
    int [] tempArray = new int[9];
    for (int x=0; x<3; x++)
    {
      for (int y=0; y<3;y++)
      {
        int tempVal = board [col0to2+x][row0to2+y];
        if (tempVal < 1 || tempVal > 9) return false;
        if (++tempArray[tempVal - 1] == 2) return false;
      } 
    }
    return true;
  }

  public static int[][] board = new int[9][9];
  public static void main(String[] args) {
    for(int i = 0; i < 3; i++) {
      for(int j = 0; j < 3; j++) {
        board[i][j] = i*3 + j + 1;
      }
    }
    System.out.println(checkBlock(0,0));
    board[0][0] = 7;
    System.out.println(checkBlock(0,0));
  }
} 
```

## 输出：

```
true
false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:17:02.667

我可以看到你来自哪里，但正如其他人所说，你的 tempArray 需要能够包含 9 个值。我之前写过一个数独检查器（uni assignment，解决方案检查是正确的，整个数独应用程序的分数超过了 90%），我的偏好是有一个包含 9 个值的数组，每个值代表 1-9 个数字，但我没有将值设置为 tempVal，而是增加了它。使检查您只得到每个数字中的一个变得更容易。

```
int [] boxCounts = {0, 0, 0, 0, 0, 0, 0, 0, 0};

// X loop
    // y loop
        // get value
        boxCounts[value - 1]++;
    // end y loop
// end x loop

// check we found one of each
for(int j = 0; j < 9; j++) {
    if(boxCounts[j] != 1 )
        return false;
    }
} 
```

# ruby-on-rails - papperclip, Cocaine::ExitStatusError 生产中的奇怪错误

> ID：16201960
> 
> 赞同：1
> 
> 时间：2013-04-24T20:53:16.173
> 
> 标签：ruby-on-rails, paperclip

我在生产中遇到了这个错误：（我刚刚上传了一个升级了 rails 和 ruby​​ 的版本到 1.9.3 和 3.2）

```
Cocaine::ExitStatusError: Command 'convert /tmp/photo (1)20130424-3742-dohg6e.JPG -auto-orient /tmp/20130424-3742-eiksvr' returned 2\. Expected 0 Here is the command output: 
```

我的回形针代码：

```
has_attached_file :photo,
                :styles => {:original => "1024x1024>", :large => '800x600>', :thumb => '120x72#'},
                :convert_options => {:original => '-strip -quality 90', :large => '-strip -quality 90', :thumb => '-strip'},
                :processors => [:auto_orient, :thumbnail],
                :url => "/system/statuses/:id_partition/:style.:extension",
                :path => ":rails_root/public/system/:id_partition/:style.:extension" 
```

这个错误是什么意思？我该如何处理？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:03:31.883

我不完全确定。但是您的生产服务器似乎没有正确安装 ImageMagick 库。

cocaine 是一个用于执行 commnad 工具的库。我相信它正在尝试调用一些 imagemagick 命令并返回某种错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-29T22:56:15.310

回形针救援的任何可卡因错误，包括 ImageMagick 中的分段错误。它返回一个`''`空字符串。几何体工厂[27号线。](https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/geometry_detector_factory.rb#L27)

# google-drive-api - 为 Google Drive 中的自定义文件提供预览

> ID：16201961
> 
> 赞同：3
> 
> 时间：2013-04-24T20:53:16.637
> 
> 标签：google-drive-api

我开发了一个名为 VideoNot.es ( [http://videonot.es](http://videonot.es) ) 的 Google Drive 应用程序。

当用户尝试直接从云端硬盘打开文件而不安装 Chrome 应用程序时，它会显示一个叠加层，上面写着“无预览”。因此，他们并不真正了解如何使用我的应用程序打开它，我必须解释他们需要转到管理应用程序并使 VideoNot.es 成为此类文件的默认应用程序。![在此处输入图像描述](https://i.stack.imgur.com/VcnlT.png)

我怎样才能改善这个流程？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T12:35:18.293

提供文件缩略图，如果 Google Drive 本身无法呈现缩略图，它应该出现在文件预览中。详细信息在“上传缩略图”部分的[https://developers.google.com/drive/file上。](https://developers.google.com/drive/file)

# php - 注意：未定义的索引：错误

> ID：16201963
> 
> 赞同：0
> 
> 时间：2013-04-24T20:53:18.297
> 
> 标签：php, session

在我来到这里之前，我已经阅读了许多试图解决此问题的不同内容。无论如何我得到

```
"Notice: Undefined index: Username in C:\xampp\htdocs\home\header.php on line 18" 
```

我无法弄清楚我做错了什么。我习惯于使用 cookie 而不是会话，所以这有点不同。

这是代码。

**索引.php**

```
<table class='siteTable'>
<tr>
<td class='account'>

<?php 
if(!$ULN){
echo"
<div class='settings1'>
<center>Login</center>
<br />

</div>
<div class='settings2'>
<center>Register</center>
<br />

</div>
";
} else {
echo"
Logged In!
";
}
?>
</td>
<td>

</td>
</tr>
</table>

<?php include("footer.php"); ?> 
```

**头文件.php**

```
<?php
ob_start();
?>
<html>
<head>
<link href='css/style.css' type='css/text' rel='stylesheet'>
</head>
<body style='background-image:url("darkbg.png");'>
<?php 
include("database.php");
?>
<div class='mainDiv' style='background-image:url("mdbg.png");'>
<div class='siteBanner' style='background-image:url("siteBanner.png");'></div>
<?php
session_start();

$LoggedIn = mysql_query("SELECT * FROM Users WHERE Username='".$_SESSION['Username']."'"); 
$ULN = mysql_fetch_object($LoggedIn);

$banner = true;
if($banner == true){
echo"<div class='Banner'>In the works.</div>";
}
?>
<div class='siteLinks'>
<ul>
<a href='index.php'>
<li>
Home
</li>
</a>
<a href='#catalog.php'>
<li>
Catalog
</li>
</a>
<a href='#users.php'>
<li>
Users
</li>
</a>
<a href='#forum.php'>
<li>
Forum
</li>
</a>
</ul>
</div>
<div class='siteContent'> 
```

我在用

```
"$LoggedIn = mysql_query("SELECT * FROM Users WHERE Username='".$_SESSION['Username']."'"); 
$ULN = mysql_fetch_object($LoggedIn);" 
```

检查用户是否登录，这就是问题所在。对不起，如果这已经被回答了，如果是这样，我找不到它。我发现的只是用户 $_POST 或 $_GET 的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:08:40.450

与其告诉你在这种情况下出了什么问题，不如让我告诉你如何调试自己的代码。这些是根据错误消息找出问题的步骤。

1.  **查找行号。** “... on line 18”告诉您问题出在代码的第 18 行。数数行，直到你到达那一行。就是这个：

> $LoggedIn = mysql_query("SELECT * FROM Users WHERE Username='".$_SESSION['Username']."'");

1.  **在 Google 上搜索错误消息短语以了解其含义。**在这种情况下，这就是“未定义的索引”。“索引”一词是数组键的另一个词。顺便说一下，$_GET、$_POST 和 $_SESSION 都是数组。“未定义”表示索引不存在。用简单的英语来说，这意味着 $_SESSION['Username'] 还不存在。在尝试查找它之前，您应该检查它是否存在。

> ```
>  if(isset($_SESSION['Username'])) {
>       $LoggedIn = mysql_query("SELECT * FROM Users WHERE Username='".$_SESSION['Username']."'");
>       $ULN = mysql_fetch_object($LoggedIn);
>  } else {
>       $ULN = false;
>  } 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:00:18.993

`$_SESSION['Username']`在进行查询之前检查。新访问者不会设置该会话变量。

```
if (isset($_SESSION['Username'])) {
    $LoggedIn = mysql_query("SELECT * FROM Users WHERE Username='".$_SESSION['Username']."'"); 
    $ULN = mysql_fetch_object($LoggedIn);
} 
```

# ruby - Ruby编辑不打印

> ID：16201964
> 
> 赞同：0
> 
> 时间：2013-04-24T20:53:20.967
> 
> 标签：ruby, each

我正在学习 Codecademy 课程以快速了解 Ruby 的基础知识，但我在他们的编辑中遇到了障碍！锻炼。我发布了我认为应该做的伎俩，但它拒绝打印。

练习说明如下：

让我们从简单的开始：编写一个遍历单词并打印出它找到的每个单词的 .each 循环。

如果可以的话请帮忙。谢谢！这是我的代码：

```
puts "What is your text, bra?"
text = gets.chomp
text.downcase!

puts "What is being hidden?"
redact= gets.chomp
redact.downcase!

words = text.split(" ")
eachredact = redact.split(" ")

#loop through the words in the string
words.each do |x|
    print "#{x}" + " "
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:02:06.093

我运行如下：

```
puts "What is your text, bra?"
text = gets.chomp
text.downcase!

puts "What is being hidden?"
redact= gets.chomp
redact.downcase!

words = text.split(" ")
eachredact = redact.split(" ")

#loop through the words in the string
words.each do |x|
    print "#{x}" + " "
end 
```

***输出：***

```
What is your text, bra?
i anm
What is being hidden?
Good
i anm 
```

看这里：

![代码学院](https://i.stack.imgur.com/hFa3y.png)

# html - 当我插入另一个 div 时，为什么我的 div 彼此相邻？

> ID：16201980
> 
> 赞同：0
> 
> 时间：2013-04-24T20:54:28.673
> 
> 标签：html, css, nested

抱歉，如果这很愚蠢，但这是我学习 CSS 的第一天，我正在学习一门课程并创建一个示例布局，我似乎犯了某种错误，或者因为添加我自己的小模块而忘乎所以。我非常想解决这个问题，因为我喜欢学习，并且担心如果我被困在这个问题上，我就不想继续了。

我的页面底部有 3 个 div 类 .Featurebox 在其中嵌套了 3 个其他 div 类 .Boximage

对于我的生活，尽管它们漂浮，但我无法让它们水平排列。我怀疑这是因为我在父导航中使用了 margin-left:auto 和 margin-right:auto 。我已经用这个解决方案玩了整整一个小时 LOL，所以我第一次在这里寻求帮助。

这是我的CSS：

```
#maincontent {
    width: 960px; 
    margin-left: auto; margin-right:auto;
}

body {

    background-color: lightgrey;

}
h1 {
    color: orange; font-family: ubuntu; padding-top: 10px;
}

header {
margin-top: 2;
width:100%;
height: 100px;
background: url(grey.png) repeat;

}

#headercontainer {
width:  960px; height:  100px;
margin-left:  auto; margin-right: auto;
background-color: olive;
}

#navbar {
    width:  960px; height:  20px; margin-left: auto; margin-right: auto; background-color: red; 
}

#logo {
    background-color: lightgrey; height: 100px; width: 100px;  
}

nav {
    width: 100%; height:  20px; background-color: #f0f0f0; float:left; 
}

article {
    width: 960px; height: 500px; background-color: orange; 
}

.Featurebox {
    background-color: darkgrey;  
    width: 310px;
    height: 200px;
    float: left;
}

.Boximage {
    background-color:blue; width:285px; height: 130px;
    float:left;
}

footer {
    width:  100%; height:  80; background-color: 000000; clear: left;
}

.center {
  margin-left: auto;
  margin-right: auto;
} 
```

这是我的 HTML：

```
<html>

<head>
<link rel="stylesheet" href="styles.css" />
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>

<body>

<header>
    <div id="headercontainer">
        <div id="logo">logo</div>       
    </div>
    <nav>
        <div id="navbar">navigation bar</div>
    </nav>
</header>

<div id="maincontent">

<article>article here
</article>

    <div class="Featurebox">
    <div class="Boximage"</div>

    </div>

    <div class="Featurebox">
    <div class="Boximage"</div>

    </div>

    <div class="Featurebox">
    <div class="Boximage"</div>

    </div>
    </div>

    <footer>

    </footer>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T20:58:15.727

```
<div class="Featurebox">
    <div class="Boximage"</div> 
```

我怀疑你的问题是上述。仔细看，你会看到一个语法错误。它应该是：

```
<div class="Featurebox">
    <div class="Boximage"></div> 
```

出于进一步测试的目的，我建议在框中放入一些内联内容以确保其呈现。（如果没有特定的高度或宽度，它将为空，如果指定了宽度和高度，这不是问题，但我喜欢覆盖我的基础。）我的建议是简单地添加一个带有文本的段落。

```
<div class="Featurebox">
    <div class="Boximage"><p>Box 1</p></div> 
```

还应该注意的是，如果您将 Featurebox 浮动到左侧，那么它的孩子也不需要浮动。`float: left;`所以你可以删除`.Boximage`

此外，我建议您找到一个好的编辑器来编写您的代码，当您在一个元素中单击时，它会为您的元素着色并突出显示标签的末端。我个人使用notepad++和dreamweaver，虽然很多人对dreamweaver的印象很差，但只要你严格保持在代码视图中，那么它是一个很好的编写代码的应用程序，它具有内置的FTP管理器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:58:36.463

你错过了标签`>`的开头部分之后：`.Boximage`

```
<div class="Boximage"</div> 
```

如果你纠正它，它似乎工作。

[http://jsfiddle.net/CLUTP/1/](http://jsfiddle.net/CLUTP/1/)

# vagrant - Vagrant 最佳实践 - 持久性

> ID：16201981
> 
> 赞同：0
> 
> 时间：2013-04-24T20:54:30.947
> 
> 标签：vagrant

我喜欢通过 vagrant 我可以启动我的机器、配置它并开始编码。但是，当我执行 vagrant halt ，然后再次执行 vagrant up 时，它会从基本框重建我的机器。我安装的所有新东西，我的项目存储库都不见了。

我可以看到虚拟机仍然存在于虚拟盒中，我可以从那里使用它，但是我想使用 vagrant 来管理和访问它，同时保持磁盘的持久性，就像我直接从虚拟盒访问它一样。我的主机是windows，我的客人是precision64。

想法？

斯蒂芬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:26:29.247

也许你想用`vagrant suspend`？（[通过](http://docs-v1.vagrantup.com/v1/docs/getting-started/teardown.html)）

# list - 将我的列表保存到独立存储

> ID：16201984
> 
> 赞同：0
> 
> 时间：2013-04-24T20:54:41.657
> 
> 标签：list, windows-phone-7, isolatedstorage

我在将列表项保存到独立存储时遇到问题。（Windows Phone 7）

**这是我定义列表类的方式；我正在使用数据绑定**

```
public class CTransaction
    {
        public String Date1 { get; set; }
        public String Amount1 { get; set; }
        public String Type1 { get; set; }
        public String Time1 { get; set; }
        public String Dis1 { get; set; }
        public String Def1 { get; set; }
        public CTransaction(String date1, String amount1, String type1, String time1, String dis1, String def1)
        {
            this.Date1 = date1;
            this.Amount1 = amount1;
            this.Time1 = time1;
            this.Dis1 = dis1;
            this.Def1 = def1;
            switch (type1)
            {
                case "FR":
                    this.Type1 = "Images/a.png";
                    break;

                case "TA":
                    this.Type1 = "Images/b.png";
                    break;

                case "DA":
                    this.Type1 = "Images/c.png";
                    break;

                case "CC":
                    this.Type1 = "Images/mount.png";
                    break;
            }
        }
    } 
```

**这是我将项目插入列表的方法；我正在为字段分配一些内容，然后将其插入到我的列表中，例如；**

```
List<CTransaction> ctransactionList = new List<CTransaction>();
//some list item filling operations here***

ctransactionList.Insert(0, new CTransaction(DefaultDate, DefaultAmount, RandomType, Times, Dist, Defin));//This one inserts at the top of my list

        CTransactionList.ItemsSource = null;
        CTransactionList.ItemsSource = ctransactionList; //These two operations refreshes my list 
```

!!是的，你看到我如何插入和创建我的列表。一切都好。现在我想保存*ctransactionList*

**这是我如何保存它；（通过单击按钮）**

```
 var store = IsolatedStorageFile.GetUserStoreForApplication();
        if (store.FileExists("saver"))
        {
            store.DeleteFile("saver");
        }
        using (var stream = new IsolatedStorageFileStream("saver", FileMode.OpenOrCreate, FileAccess.Write, store))
        {
            var serializer = new XmlSerializer(typeof(List<CTransaction>));
            serializer.Serialize(stream, ctransactionList);
        } 
```

**这是我如何加载它（通过单击另一个按钮）**

```
var store = IsolatedStorageFile.GetUserStoreForApplication();

        if (store.FileExists("saver"))
        {
            using (var stream = new IsolatedStorageFileStream("saver", FileMode.OpenOrCreate, FileAccess.Read, store))
            {
                var reader = new StreamReader(stream);

                if (!reader.EndOfStream)
                {
                    var serializer = new XmlSerializer(typeof(List<CTransaction>));
                    ctransactionList = (List<CTransaction>)serializer.Deserialize(reader);
                }
            }
        } 
```

在调试时，保存操作似乎是一致的并且没有引发任何错误，但是在加载时；这是这一行出现的错误；

```
ctransactionList = (List<CTransaction>)serializer.Deserialize(reader); 
```

*错误：XML 文档 (3, 4) 中存在错误。*

如果您能帮助我，我将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:38:43.050

试试这个让你的类可序列化：

```
[DataContract]
    public class CTransaction
    {
        [DataMember]
        public String Date1 { get; set; }
        [DataMember]
        public String Amount1 { get; set; }
        [DataMember]
        public String Type1 { get; set; }
        [DataMember]
        public String Time1 { get; set; }
        [DataMember]
        public String Dis1 { get; set; }
        [DataMember]
        public String Def1 { get; set; }
        public CTransaction(String date1, String amount1, String type1, String time1, String dis1, String def1)
        {
          //your code
        }
    } 
```

然后将加载和保存方法更改为：

```
public List<CTransaction> LoadFromIsolatedStorage()
{
  List<CTransaction> ret = new List<CTransaction>();
  try
  {
    var store = IsolatedStorageFile.GetUserStoreForApplication();
    if (store.FileExists("saver"))
    {
      using (var stream = new IsolatedStorageFileStream("saver", FileMode.OpenOrCreate, FileAccess.Read, store))
      {
        if (stream.Length > 0)
        {
           DataContractSerializer dcs = new DataContractSerializer(typeof(List<CTransaction>));
           ret = dcs.ReadObject(stream) as List<CTransaction>;
        }
      }
    }
  }
  catch (Exception ex)
  {
    // handle exception
  }
}

public void SaveToIsolatedStorage(List<CTransaction> listToSave)
{
  var store = IsolatedStorageFile.GetUserStoreForApplication();
  if (store.FileExists("saver"))
  {
     store.DeleteFile("saver");
  }
  using (var stream = new IsolatedStorageFileStream("saver", FileMode.OpenOrCreate, FileAccess.Write, store))
  {
    DataContractSerializer dcs = new DataContractSerializer(typeof(List<CTransaction>));
   dcs.WriteObject(stream, ctransactionList);
  }
} 
```

# c++ - 反转文件中的输入 (C++)

> ID：16201986
> 
> 赞同：1
> 
> 时间：2013-04-24T20:54:54.147
> 
> 标签：c++, list

我正在创建一个非常基本的程序，该程序从文本文件中读取数字列表，以相反的顺序打印它们，然后说明该顺序是否与原始顺序相同（如palendrome）。

到目前为止，我的程序能够以相反的顺序打印，但我不确定如何检测它是否与原始文件相同。任何帮助将不胜感激 ：）

编辑：对不起，不得不离开。这是我到目前为止所拥有的。让它反转，只需要检查回文。将阅读回复。

```
#include <iostream>
#include <fstream>
using namespace std;

int main()
{
const int ARRYLENGTH=20;

int contnums[ARRYLENGTH];
int contents;

ifstream myFile("problem3.txt");
if(! myFile )
{
cout << "File cannot be found";
exit(EXIT_FAILURE);
}

while(!myFile.eof())
{
myFile>>contents;
    for(int i=0;i<ARRYLENGTH;i++)
    {
    myFile >> contnums[i];
    }
}
cout<<contents<<" ";

for (int i = 1; i < ARRYLENGTH; i++)
{
bool same = false;
for (int j = 0; j < i && (same == false); j++){
if (contnums[i] == contnums[j]) 
same = true;
}
if (!same) {

cout<< contnums[i] << " ";
}
}

cout << "\n";

system("pause");
myFile.close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:21:29.683

我只是想知道比较 2 个列表是否可以在 std 库中工作。有用 ：-）

```
#include <list>
#include <fstream>

using std::list;
using std::ifstream;

bool foo(const char * fn)
{
    list<int> orig;
    list<int> rev;
    ifstream ifs(fn,std::ifstream::in);

    while( ifs.good() && !ifs.eof() )
    {
        int num =0;
        ifs >> num;
        orig.push_back(num);
        rev.push_front(num);
    }
    bool equal = (orig == rev);
    return equal;
}

static bool test1 = foo("file1.txt");
static bool test2 = foo("file2.txt"); 
```

**在哪里**

file1.txt 包含

```
1 2 3 4 5 6 7 8 9 0 9 8 7 6 5 4 3 2 1 8 
```

和 file2.txt 包含

```
1 2 3 4 5 6 7 8 9 0 9 8 7 6 5 4 3 2 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:18:18.653

如果你知道你有多少物品，可以简单地通过以下方式完成：

```
for(int i = 0; i < count/2; ++i) { //count/2 becouse you only have to check half
   if(array[i] != array[count-i-1]) { /*not palindrome */ }
}
//palindrome 
```

最简单的方法，但我更喜欢评论一中的@Dave，因为它以很好的方式使用了 STL 和迭代器。（只要您在 STL 容器上工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T20:58:04.650

尝试从头到尾迭代并将值与从头到尾的迭代器的值进行比较。

# c# - ASP.Net/C# 将 NameValueCollection 转换为 IDictionary？

> ID：16201988
> 
> 赞同：8
> 
> 时间：2013-04-24T20:54:57.183
> 
> 标签：c#, asp.net, namevaluecollection

我正在尝试帮助我的儿子升级我去年为他建立的网站。他想实施 Amazon Simple Pay。我非常接近它，但是有一个我不知道如何解决的错误。这是一个用 C# 编写的 ASP.Net 站点。我是一个未经培训（自学）的开发人员，所以请简单地说。;-)

在 ASP.Net 中，Form 中有一个 Form 是不合法的，我需要做一个 Form POST。网上有一个非常漂亮的教程，展示了如何做到这一点。该 URL 是[http://weblogs.asp.net/hajan/archive/2011/04/20/amazon-simple-pay-in-asp-net.aspx](http://weblogs.asp.net/hajan/archive/2011/04/20/amazon-simple-pay-in-asp-net.aspx)，如果您有兴趣查看它。

交易必须“签名”，亚马逊提供了一个 SignatureUtils 类来完成此操作。在那堂课上，我这样称呼：

```
public static string signParameters(IDictionary<String, String> parameters, String key, String HttpMethod, String Host, String RequestURI, String algorithm) 
```

让我感到沮丧的是 IDictionary 参数。我必须传递的是我构建的这个 ListParams NameValueCollection：

```
public System.Collections.Specialized.NameValueCollection ListParams = new System.Collections.Specialized.NameValueCollection(); 
```

它给了我下面的错误，因为它无法将 NameValueCollection 转换为 IDictionary。我尝试明确转换它，但没有喜悦。我该如何解决这个问题？

```
Error: Argument 1: cannot convert from 'System.Collections.Specialized.NameValueCollection' to 'System.Collections.Generic.IDictionary<string,string>' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T21:06:25.280

您可以通过使用来做到这一点`Cast`：

```
IDictionary<string, string> dict = ListParams.Cast<string>()
    .ToDictionary(p => p, p => ListParams[p]); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-12-01T23:42:06.047

您还可以通过其属性“转换`NameValueCollection`” `Dictionary<string, string>`a `AllKeys`：

```
var dictionary = nameValueCollection.AllKeys
    .ToDictionary(k => k, k => nameValueCollection[k]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T14:00:05.007

沙赞！！知道了！解决方案是更改 Hajan 提供的示例代码以实现 Dictionary 而不是 NameValueCollection。然后我需要将 PaymentGatewayPost 中的 while 循环更改为 foreach 循环，如下所示：

```
foreach (KeyValuePair<string, string> pair in ListParams)
{
    System.Web.HttpContext.Current.Response.Write(string.Format("<input name=\"{0}\" type=\"hidden\" value=\"{1}\">",
    pair.Key,
    pair.Value));
} 
```

瞧！！它构建没有错误。

感谢大家的帮助。希望这将帮助其他正在努力使用 Amazon Simple Pay 的人。

# arrays - 使用 VB .net 从进程数组中删除重复项

> ID：16201989
> 
> 赞同：2
> 
> 时间：2013-04-24T20:54:57.007
> 
> 标签：arrays, vb.net

我必须编写代码以获取所有可访问的进程，但我需要删除此数组上的重复项，并且每个进程只显示一次。

最好的方法是如何做到这一点，因为我认为进程数组不像普通数组。

我的代码：

```
For Each p As Process In Process.GetProcesses
    Try
        'MsgBox(p.ProcessName + " " + p.StartTime.ToString)
    Catch ex As Exception
        'Do nothing
    End Try
Next 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:36:34.203

该[`Process.GetProcesses()`](http://msdn.microsoft.com/en-us/library/1f3ys1f9.aspx)方法返回一个数组。您可以使用该[`Distinct`](http://msdn.microsoft.com/en-us/library/bb338049.aspx)方法，为其提供一个[`IEqualityComparer`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)。

一个例子是作为比较器：

```
Public Class ProcessComparer
    Implements IEqualityComparer(Of Process)

    Public Function Equals1(p1 As Process, p2 As Process) As Boolean Implements IEqualityComparer(Of Process).Equals
        ' Check whether the compared objects reference the same data. 
        If p1 Is p2 Then Return True
        'Check whether any of the compared objects is null. 
        If p1 Is Nothing OrElse p2 Is Nothing Then Return False
        ' Check whether the Process' names are equal. 
        Return (p1.ProcessName = p2.ProcessName)
    End Function

    Public Function GetHashCode1(process As Process) As Integer Implements IEqualityComparer(Of Process).GetHashCode
        ' Check whether the object is null. 
        If process Is Nothing Then Return 0
        ' Get hash code for the Name field if it is not null. 
        Return process.ProcessName.GetHashCode()
    End Function
End Class 
```

你可以像这样使用它：

```
Sub Main()
    Dim processes As Process() = Process.GetProcesses()
    Console.WriteLine(String.Format("Count before Distinct = {0}", processes.Length))

    ' Should contain less items
    Dim disProcesses As Process() = processes.Distinct(New ProcessComparer()).ToArray()
    Console.WriteLine(String.Format("Count after Distinct = {0}", disProcesses.Length))

    Console.ReadLine()
End Sub 
```

您可能必须根据您的规格和您将要使用它的情况来改进比较器。

# jquery - 如何在 jquery ajax 中处理 Play 框架控制器发送的重定向？

> ID：16201994
> 
> 赞同：1
> 
> 时间：2013-04-24T20:55:16.240
> 
> 标签：jquery, ajax, playframework

在我的控制器中，我有一个使用 jquery AJAX 调用的方法。控制器方法在成功时发送一个 redict(some.view.in.my.app)。如何在客户端浏览器中加载此页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:19:19.273

您不应该发送重定向作为对 AJAX 请求的响应，而是可以发送`ok(jsonObj)`包含示例 JSON 对象的状态，甚至是带有 URL 的简单字符串到新目标页面（或`badRequest()`在失败的情况下）。

`window.location.href`接下来，您可以在重定向的情况下使用 common 执行普通的 JavaScript 重定向`GET`，或者如果需要重定向，则填写并提交一些隐藏的表单`POST`。