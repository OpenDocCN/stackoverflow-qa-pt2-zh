# StackOverflow 问答 13534000-13534999

# c# - 设置图像控件相对于屏幕的位置

> ID：13534001
> 
> 赞同：0
> 
> 时间：2012-11-23T18:09:26.587
> 
> 标签：c#, wpf

我目前正在业余时间学习 C#，但已经陷入困境。我正在尝试将图像控件移动到屏幕上的随机位置（水平），这是根据屏幕大小和图像控件本身的大小来完成的。是否可以在 C# 和 WPF 中设置 Image.X 和 Image.Y 位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:15:02.490

您可能需要为此使用`Canvas`面板，因为它允许您将子项定位在 X、Y 坐标处。

```
<Canvas>
    <Image x:Name="myImage" Canvas.Top="100" Canvas.Left="200" />
</Canvas> 
```

和是`Canvas.X`附加`Canvas.Y`属性。您可以像这样从代码隐藏设置它们：

```
myImage.SetValue(Canvas.Left, 200);
myImage.SetValue(Canvas.Top, 400); 
```

# garbage-collection - d 垃圾收集器和实时应用程序

> ID：13534005
> 
> 赞同：2
> 
> 时间：2012-11-23T18:09:41.563
> 
> 标签：garbage-collection, real-time, d

我正在考虑学习 D（基本上“C++ 做得正确，垃圾收集和线程之间的消息传递”）并与一位长期从事 C++ 程序员的同事交谈，基本上他抱怨垃圾收集器本身存在严重的时间问题即使在软实时类型的应用程序中。

这并不是说我需要编写实时应用程序——远非如此——但我很好奇 GC 在开发数据库时会有多大问题？（从统计上GC似乎强加的额外内存使用开销中抽象出来）

（现在我知道可以在 D 中关闭 GC，但这就像说您可以通过摆脱汽车来摆脱与汽车相关的问题 - 是的，但这不是我想选择的解决方案）

这是真的？这些问题在实践中有多严重？例如，在 D 中开发设备驱动程序并使用 GC 是实用/明智/良好的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T21:26:35.617

虽然 D 有一个 GC，但它不会强迫您将它用于*所有事情*。D 也有结构，其行为类似于 C++ 类和结构（减去多态性）。

在现代托管语言中，只要您有足够的内存，GC 就不是问题。对于像 C++ 这样的非托管语言也是如此 - 但在 C++ 中，内存不足意味着您无法分配更多内存，而在 Java 中，内存不足意味着 GC 启动时的延迟。

因此，如果您打算分配大量对象，那么可以 - GC 可能是个问题。但是你可能并不真的需要分配这么多的对象。在 Java 中，您必须使用对象来存储诸如字符串、日期和坐标之类的东西——这确实会填满您的堆并调用 GC（幸运的是，现代 JVM 使用分代 GC 来优化这些类型的对象）。在 D 中，您只需将结构用于这些事情，而仅将类用于实际需要 GC 的情况。

根据经验，您通常希望尽可能使用结构，但是如果您发现自己做了一些特殊的事情来处理解除分配或防止复制和破坏（尽管它在 D 中非常快） - 使该类型成为一个没有的类再想一想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T09:08:23.380

我个人并不真正赞同“只要你有足够的内存，GC 不是问题”的说法。我的意思是，这基本上意味着，你继续浪费你的内存，而不是妥善处理它，当它用完时，你突然不得不等待 1> 秒让 GC 收集所有东西。

一方面，只有当它是一个非常糟糕的 GC 时才会发生这种情况。例如，c# 中的 GC 非常快速且频繁地收集对象。你不会遇到问题，即使你在一个经常使用的函数中进行分配，它也不会等到你的内存用完才进行收集。

我没有完全了解 D2 GC（我们使用 D1）的当前特性，但当时的行为是它会分配一个内存池，并且对于你的每个分配，它都会给你一些。当它发出 90% 并且您需要更多时，它将开始收集和/或从系统分配更多。（或类似的东西）。（对于 D1）还有并发 GC，它会更早地开始收集，但让它们在后台运行，但它仅适用于 linux，因为它使用 fork 系统调用。

所以，我认为如果不小心使用，当前的 D GC 可能会导致小但明显的冻结。但是您可以禁用/启用它，例如，当您执行实时关键操作时，禁用它，当代码的关键部分结束时，再次启用它。

For a database, I don't think the D GC is ready yet. I would heavily re-use memory and not rely on the GC at all for that kind of application.

# javascript - 自定义 html5 音频播放器

> ID：13534007
> 
> 赞同：0
> 
> 时间：2012-11-23T18:09:55.337
> 
> 标签：javascript, html

我发现有一个新的 HTML5 标签。我想要一个 HTML/Javascript 代码，但我不想要任何 jQuery。它是一个 html 文档，它将在后台自动播放音乐，我希望代码在屏幕的左上角制作一个小的静音按钮。这是要处理的标准代码。

```
<audio controls="?"* loop="loop">
  <source src="horse.wav" type="audio/wave">
</audio> 
```

*：不确定是否包含

该按钮可以是文本或图片，并且可能会发生变化（例如：静音/取消静音或静音，然后单击时变为取消静音并返回）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:13:31.257

这[应该工作](http://dev.w3.org/html5/spec/Overview.html#attr-media-muted)：

```
document.getElementById('background_audio').muted = true; 
```

演示： http: [//jsfiddle.net/mattball/sVwXH/](http://jsfiddle.net/mattball/sVwXH/)（无 jQuery）

[参考](https://stackoverflow.com/questions/6442427/muting-a-html5-audio-element-using-a-custom-button)

# sql - SQLite：如何更新表中的订单数据？

> ID：13534011
> 
> 赞同：0
> 
> 时间：2012-11-23T18:10:18.453
> 
> 标签：sql, sql-update

我想更新一个表来改变数据的顺序，所以它是由 some_column DESC 排序的。

我可以通过选择 * 并按 some_column DESC 排序，然后将数据输入到新表中来做到这一点，但这很麻烦，所以我想知道是否还有其他解决方案？

所以我想要改变这个：

```
name|cost
John|50
Pete|75
Dojo|60
Neal|100 
```

到

```
name|cost
Neal|100
Pete|75
Dojo|60
John|50 
```

使用更新语句。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:16:21.027

您不能依赖数据在 SQL 表中的物理存储方式。您可以做的最好的事情是`VIEW`在该表上创建一个按照您希望的方式排序的表，并在后续查询中使用它：

```
CREATE VIEW ordered_view AS
SELECT name, cost
FROM mytable
ORDER BY cost DESC;

SELECT name, cost FROM ordered_view; 
```

# java - 使用 Java 下载并保存文件

> ID：13534015
> 
> 赞同：-4
> 
> 时间：2012-11-23T18:10:37.103
> 
> 标签：java

假设我有一个 URL，比如 something.domain/myfile.txt，然后我想用那个“保存文件”对话框保存这个文件。

我尽力做到这一点，但每次我使用对话框保存文件时，文件都不存在。

一个例子或我能找到这方面信息的地方会有很大帮助！

```
 URL website = null;
                try {
                    website = new URL(<insert url here>);
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                }
                ReadableByteChannel rbc = null;
                try {
                    rbc = Channels.newChannel(website.openStream());
                } catch (IOException e2) {
                    e2.printStackTrace();
                }
                FileOutputStream fos = null;
                try {
                    fos = new FileOutputStream(new File("minecraft.jar"));
                } catch (FileNotFoundException e1) {
                    e1.printStackTrace();
                }
                try {
                    fos.getChannel().transferFrom(rbc, 0, 1 << 24);
                } catch (IOException e) {
                    e.printStackTrace();
                }

                    JFileChooser fileChooser = new JFileChooser();
                    if (fileChooser.showSaveDialog(fileChooser) == JFileChooser.APPROVE_OPTION) {
                      File dir = fileChooser.getCurrentDirectory(); 
                      dir.mkdir();
                      //After this point is where I need help. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T12:02:11.610

我相信这就是您正在寻找的：

```
if (fileChooser.showSaveDialog(fileChooser) == JFileChooser.APPROVE_OPTION)
{
  File file = fileChooser.getSelectedFile();
  // whatever you want to do with the file
  System.out.println("The file is "+file.getAbsolutePath());
  // fos = new FileOutputStream(file) ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T12:22:50.360

您是否注意到在您的代码中您尝试保存/下载文件，然后再让用户选择目的地？

我会将代码分成三个不同的操作：

1.  一种负责将字节从`InputStream`（网络）传输到`OutputStream`（文件）的方法。
2.  一种向用户显示对话框的方法，以便他可以选择存储文件的位置。
3.  完成整个任务的方法：选择一个文件并将字节从网络传输到它。

1）会是这样的（你不需要使用 NIO API 来实现它）：

```
public void transfer(InputStream in, OutputStream out) throws IOException {
   byte[] buffer = new byte[2048];
   int bytesRead;
   while ((bytesRead = in.read(buffer)) > 0) {
      out.write(buffer, 0, bytesRead);
   }
} 
```

2）将与杜克林已经说过的非常相似：

```
public File chooseFile() {
  File result = null;
  JFileChooser fileChooser = new JFileChooser();
  if (fileChooser.showSaveDialog(fileChooser) == JFileChooser.APPROVE_OPTION) {
    result = fileChooser.getSelectedFile();
  }
  return result;
} 
```

3）那么，将这两个操作组合在一起非常简单：

```
public void saveFileFromWeb(URL url) {
  File file = chooseFile();   // 1\. Choose the destination file
  if (file != null) {
    // 2\. Create parent folder structure
    File folder = file.getParentFile();
    if (!folder.exist()) {
       folder.mkdirs();
    }

    InputStream in = null;
    OutputStream out = null;
    try {
      // 3\. Initialise streams
      in = url.openStream();
      out = new FileOuputStream(file);
      // 4\. Transfer data
      transfer(in, out);
    } catch (IOException e) {
       e.printStackTrace();
    } finally {
      // 5\. close streams
      if (in != null) {
        try {
          in.close();
        } catch (IOException e) { /* ignore */ }
      }
      if (out != null) {
        try {
          out.close();
        } catch (IOException e) { /* ignore */ }
    }
  }
} 
```

**注意**：1) 和 2) 可以是私有方法。当然，您可以只执行一个操作，但拆分它可以让您大致了解要执行的不同步骤。

**注 2**：我简化了异常处理部分

# jquery - JQUERYUI-单击图像时关闭模式对话框

> ID：13534017
> 
> 赞同：2
> 
> 时间：2012-11-23T18:10:40.160
> 
> 标签：jquery, jquery-ui

我目前正在使用 jQuery UI 中的模态对话框作为菜单。菜单由一些图像组成，当单击这些图像时，这些图像用作菜单项。该站点使用动态 ajax 内容来加载所请求的页面。所以这是我的问题：单击图像后如何关闭模式对话框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:13:47.357

您可以执行以下操作：

```
$('<your image>').click(function(){
    $('<your dialog>').dialog('close');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:20:46.430

```
$( "#dialog" ).dialog();

<img src='..' class='image_menu'>
<img src='...' class='image_menu'>

$('.image_menu').click(function(){
   $('#dialog').dialog('close');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:14:18.710

加载图像后（在 AJAX 回调中或正在加载的文档中）：

```
$('yourImage').click(function(){
   $('yourDialog').dialog('close');
}); 
```

对于多个图像，使用`class`选择器 (http://api.jquery.com/class-selector)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T18:14:48.907

假设您的图像有一个 id `myImage`，那么下面将关闭对话框：

```
$("#myImage").on('click', function() {
  $('#divForDialog')dialog("close") 
}); 
```

*解释*：使用 of`on`将确保选择器`#myImage`被强制执行，即使图像稍后在页面加载后被 ajaxed 插入。

正如其他人指出的那样，如果您有多个图像，则使用 css 类来识别它们和`.class`jQuery 选择器。

# php - JavaScript web 文件夹访问密码保护

> ID：13534022
> 
> 赞同：0
> 
> 时间：2012-11-23T18:10:54.140
> 
> 标签：php, javascript, node.js, password-protection, shared-hosting

我的概念是，我将通过 FTP 在我的网站上上传文件，例如 www.mywebsite.com/dropbox/

然后我会将那个 URL 分享给其他人，他们只有输入正确的密码才能查看文件夹内容。

这可以单独使用 JavaScript 完成还是需要另一个框架！

我知道 JS 和 NODEjs 的基础知识。

我正在寻找这样的东西，但没有其他花哨的东西[http://www.filefactory.com/f/6ba85c1e889f59d4](http://www.filefactory.com/f/6ba85c1e889f59d4)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:21:54.917

您将必须保护密码，这是您无法通过 javascript 完成的。JS 被下载到客户端，任何人都可以看到。您确实需要某种基于服务器的逻辑来接受用户输入，然后根据您的密码验证他们的密码。在 ASP.Net 中，您可以将其发布到 webmethod 并将其与代码中的硬编码值或通过值进行比较一个数据库表（存储在服务器上）。如果用户的密码和硬编码值匹配，则返回 True 以启用内容。

# java - 预定的未来会导致内存泄漏吗？

> ID：13534030
> 
> 赞同：15
> 
> 时间：2012-11-23T18:11:42.987
> 
> 标签：java, android, multithreading, memory-leaks, future

我认为我的 Android 动态壁纸存在内存泄漏。每当我旋转屏幕时，收集的内存垃圾量就会增加 50kb 并且不会减少。我认为这可能是由预定的未来引起的，所以我将提出一个场景来看看是否是这种情况。

假设您有一个具有以下成员的类（我们称之为 Foo）。

```
private ScheduledFuture<?> future;
private final ScheduledExecutorService scheduler = Executors
        .newSingleThreadScheduledExecutor();

private final Runnable runnable = new Runnable() {
    public void run() {
        // Do stuff
    }
}; 
```

现在你设定了一个预定的未来

```
future = scheduler.scheduleAtFixedRate(runnable, delay, speed,
                TimeUnit.MILLISECONDS); 
```

future 持有对 runnable 的引用，runnable 持有对父 Foo 对象的引用。我不确定是否是这种情况，但这个事实是否意味着如果程序中没有任何内容包含对 Foo 的引用，那么垃圾收集器仍然无法收集它，因为有一个预定的未来？我不太擅长多线程，所以我不知道我显示的代码是否意味着计划任务的寿命会比对象长，这意味着它最终不会被垃圾收集。

如果这种情况不会导致阻止 Foo 被垃圾收集，我只需要通过一个简单的解释来告诉我。如果它确实阻止了 Foo 被垃圾收集，那么我该如何解决呢？一定要做`future.cancel(true); future = null;`吗？该`future = null`部分是不必要的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T18:19:15.557

*   您的`run`方法依赖于封闭`Foo`类，因此不能独立存在。在那种情况下，我看不出你如何让你的`Foo`gc'ed 并让你的可运行“活着”由执行者运行
*   或者您的`run`方法是静态的，因为它不依赖于您的`Foo`类的状态，在这种情况下，您可以将其设为静态，它将防止您遇到的问题。

您似乎没有处理 Runnable 中的中断。这意味着即使您调用`future.cancel(true)`Runnable 将继续运行，正如您确定的那样，这可能是导致泄漏的原因。

有几种方法可以使 Runnable “中断友好”。要么你调用一个抛出 InterruptedException 的方法（比如`Thread.sleep()`阻塞 IO 方法），它会`InterruptedException`在未来被取消时抛出一个。在清理完需要清理的内容并恢复中断状态后，您可以捕获该异常并立即退出 run 方法：

```
public void run() {
    while(true) {
        try {
            someOperationThatCanBeInterrupted();
        } catch (InterruptedException e) {
            cleanup(); //close files, network connections etc.
            Thread.currentThread().interrupt(); //restore interrupted status
        }
    }
} 
```

如果您不调用任何此类方法，则标准习语是：

```
public void run() {
    while(!Thread.currentThread().isInterrupted()) {
        doYourStuff();
    }
    cleanup();
} 
```

在这种情况下，您应该尝试确保定期检查 while 中的条件。

通过这些更改，当您调用 时`future.cancel(true)`，将向执行 Runnable 的线程发送一个中断信号，该线程将退出正在执行的操作，从而使您的 Runnable 和您的 Foo 实例有资格进行 GC。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-16T18:07:43.790

虽然这个问题很久以前就得到了回答，但在阅读[了这篇](http://blog.kapsi.de/blog/canceling-scheduledfutures-memory-leak)文章之后，我想到了发布新的答案和解释。

**预定的未来会导致内存泄漏吗？ - - 是的**

`ScheduledFuture.cancel()`或者`Future.cancel()`通常不会通知它`Executor`它已被取消并留在队列中，直到它的执行时间到来。对于简单的 Futures 来说这不是什么大问题，但对于`ScheduledFutures`. 它可以在那里停留几秒钟、几分钟、几小时、几天、几周、几年或几乎无限期，具体取决于它所安排的延迟。

这是最坏情况的示例。可运行对象及其引用的所有内容都将在队列中保留 Long.MAX_VALUE 毫秒，即使其 Future 已被取消！

```
public static void main(String[] args) {
    ScheduledThreadPoolExecutor executor 
        = new ScheduledThreadPoolExecutor(1);

    Runnable task = new Runnable() {
        @Override
        public void run() {
            System.out.println("Hello World!");
        }
    };

    ScheduledFuture future 
        = executor.schedule(task, 
            Long.MAX_VALUE, TimeUnit.MILLISECONDS);

    future.cancel(true);
} 
```

您可以通过使用 a`Profiler`或调用该`ScheduledThreadPoolExecutor.shutdownNow()`方法来查看这一点，该方法将返回一个包含一个元素的 List（它是被取消的 Runnable）。

这个问题的解决方案是要么编写你自己的 Future 实现，要么不时调用该`purge()`方法。如果自定义 Executor 工厂解决方案是：

```
public static ScheduledThreadPoolExecutor createSingleScheduledExecutor() {
    final ScheduledThreadPoolExecutor executor 
        = new ScheduledThreadPoolExecutor(1);

    Runnable task = new Runnable() {
        @Override
        public void run() {
            executor.purge();
        }
    };

    executor.scheduleWithFixedDelay(task, 30L, 30L, TimeUnit.SECONDS);

    return executor;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:36:33.633

> future 持有对 runnable 的引用，runnable 持有对父 Foo 对象的引用。我不确定是否是这种情况，但这个事实是否意味着如果程序中没有任何内容包含对 Foo 的引用，那么垃圾收集器仍然无法收集它，因为有一个预定的未来？

`Foo`制作您经常创建的某种瞬态对象是一个坏主意，因为您应该`ScheduledExecutorService scheduler`在应用关闭时关闭。因此，您应该使 Foo 成为伪单例。

垃圾收集器了解循环，因此一旦您关闭`Foo`的执行程序服务，您很可能不会遇到内存问题。

# c - 如何使用 ifdef 检测 Intel 的编译器 (ICC)？

> ID：13534032
> 
> 赞同：8
> 
> 时间：2012-11-23T18:11:47.907
> 
> 标签：c, macros, c-preprocessor, intel, icc

我想在 Linux 上使用英特尔当前的编译器。我有一个应该检测编译器的内联宏。

它曾经与过去版本的 GCC 和 ICC 一起工作。但现在我得到`extern inline`了ICC。ICC现在定义了`__GNUC__`吗？您将如何检测 ICC 或英特尔的 C++ 编译器 ICPC？

```
#ifndef INLINE
# if defined(__GNUC__) || defined(__GNUG__)
#  define INLINE extern inline
# else
#  define INLINE inline
# endif
#endif 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-23T18:19:24.690

`__INTEL_COMPILER`就是你要找的。（来源：[ICC 手册页](http://scv.bu.edu/computation/bladecenter/manpages/icc.html)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-25T13:55:44.010

以下网页显示了有关如何检测最新英特尔编译器的信息：

[https://software.intel.com/content/www/us/en/develop/articles/use-predefined-macros-for-specific-code-for-intel-dpcpp-compiler-intel-cpp-compiler-intel- cpp-编译器-classic.html](https://software.intel.com/content/www/us/en/develop/articles/use-predefined-macros-for-specific-code-for-intel-dpcpp-compiler-intel-cpp-compiler-intel-cpp-compiler-classic.html)

编辑（这是来自网站的代码，用于区分不同版本）：

```
// Predefined macros Intel® DPC++ Compiler
// dpcpp only
#if defined(SYCL_LANGUAGE_VERSION) && defined (__INTEL_LLVM_COMPILER)
   // code specific for DPC++ compiler below
   // ... ...

  // example only
   std::cout << "SYCL_LANGUAGE_VERSION: " << SYCL_LANGUAGE_VERSION <<  std::endl;
   std::cout << "__INTEL_LLVM_COMPILER: " << __INTEL_LLVM_COMPILER << std::endl;
   std::cout << "__VERSION__: " << __VERSION__ << std::endl;
#endif

 //Predefined Macros for Intel® C++ Compiler
#if !defined(SYCL_LANGUAGE_VERSION) && defined (__INTEL_LLVM_COMPILER)
   // code specific for Intel C++ Compiler below
   // ... ...

   // example only
   std::cout << "__INTEL_LLVM_COMPILER: " << __INTEL_LLVM_COMPILER << std::endl;
   std::cout << "__VERSION__: " << __VERSION__ << std::endl;
#endif

// Predefined Macros for Intel® C++ Compiler Classic
// icc/icpc classic only
#if defined(__INTEL_COMPILER)
   // code specific for Intel C++ Compiler Classic below
   // ... ...

   // example only
   std::cout << "__INTEL_COMPILER_BUILD_DATE: " <<   _INTEL_COMPILER_BUILD_DATE << std::endl;
   std::cout << "__INTEL_COMPILER: " << __INTEL_COMPILER << std::endl;
  std::cout << "__VERSION__: " << __VERSION__ << std::endl;
#endif 
```

# android - 在包含的 XML 中引用子视图

> ID：13534038
> 
> 赞同：1
> 
> 时间：2012-11-23T18:12:31.007
> 
> 标签：android, layout, include

我知道我可以使用包含/合并将 XML 文件包含在另一个 XML 文件中。如果包含的布局包含子布局，并且您在根视图中包含了几个 this 的实例，您如何找到每个子实例的 ID？

例如，如果包含的布局包含一个列表视图，并且您在根布局中包含此布局的 3 个实例，您如何找到并引用 3 个列表视图子项？

更新：对于阅读此线程的人：实际上我发现了一个更好的解决方案，回想起来它非常明显。getChildAt() 的问题在于，如果您添加新视图或重新安排内容，此代码将崩溃或无法工作，因为子项的索引已更改，并且类类型甚至可能不再匹配。所以不是很可维护。事实证明，如果您只是深入到布局中并且为每个包含项提供一个 ID，则 findViewById() 可以正常工作。例如，假设您在布局中有 3 个包含，ID 名称分别为“list_container1”、“list_container2”和“list_container3”。其中每一个都包含具有相同 ID 名称的相同列表视图 XML。现在不要试图从根布局中找到你的列表，这不起作用，

```
myRootLayout = (LinearLayout) findViewById(R.id.root_layout);
container1 = (LinearLayout) myRootLayout.findViewById(R.id.list_container1);
list1 = (ListView) container1.findViewById(R.id.my_list_view);
container2 = (LinearLayout) myRootLayout.findViewById(R.id.list_container2);
list2 = (ListView) container2.findViewById(R.id.my_list_view);
container3 = (LinearLayout) myRootLayout.findViewById(R.id.list_container3);
list3 = (ListView) container3.findViewById(R.id.my_list_view); 
```

在上面的示例中，布局层次结构是这样的（并且可以进一步简化）：

```
LinearLayout
    <include>
        LinearLayout
            ListView
    <include>
        LinearLayout
            ListView
    <include>
        LinearLayout
            ListView 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:15:27.717

您可以使用根布局的[`getChildAt(int index)`](http://developer.android.com/reference/android/view/ViewGroup.html#getChildAt%28int%29)方法转到任何子级。实际上`findViewById()`，只需使用它并`getChildCount()`循环遍历布局的所有子视图，直到其中一个与给定的 id 匹配。

* * *

例子：

```
LinearLayout layout = (LinearLayout) findViewById(R.id.rootLayout);
ListView list1 = (ListView) layout.getChildAt(0);
ListView list2 = (ListView) layout.getChildAt(1);
ListView list3 = (ListView) layout.getChildAt(2); 
```

确切的索引取决于您如何安排布局。

# java - 在java中读取XML父子属性？

> ID：13534039
> 
> 赞同：0
> 
> 时间：2012-11-23T18:12:37.090
> 
> 标签：java, xml, xml-parsing, xsd

我的 XML 文件中有以下数据。

```
<main>
    <Team Name="Development"  ID="10">
        <Emp Source="Business" Total="130" Active="123" New="12"  />
        <Emp Source="Business" Total="131" Active="124" New="13" />
    </Team>
    <Team Name="Testing"  ID="10">
        <Emp Source="Business" Total="133" Active="125" New="14" />
    </Team>
</main> 
```

我想读取上述数据并将值存储到数组中，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:22:34.687

不知道为什么需要将这些 xml 转换为数组，无论如何您可以读取 xml 并通过多种方式对其进行解析。通常我们使用 DOM 或 Stax Parser，这里有一个[教程链接](http://tutorials.jenkov.com/java-xml/dom.html)，还有一个[Java SAX Parsing Example](http://tutorials.jenkov.com/java-xml/sax-example.html)教程。

希望这可以帮助您实现目标。如果您卡在任何地方，请再次更新您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:22:58.273

您可以使用 JAVA 中的解析器来解析 XML 文档。用于此目的的 java 包是`javax.xml.parsers`. `DocumentBuilder`将 XML 解析为一个树结构的数据结构`Document`，`Document`是 DOM（文档对象模型）可读文件。它的节点可以被 DOM 方法遍历/更改/访问。

这是一个非常好的 XML DOM 教程：[http ://www.roseindia.net/xml/dom/](http://www.roseindia.net/xml/dom/)

更具体地说：[http ://www.roseindia.net/xml/dom/accessing-xml-file-java.shtml](http://www.roseindia.net/xml/dom/accessing-xml-file-java.shtml)

您也可以随时参考 w3school 了解更多关于 DOM 的理论！

# php - PDO 上的 sqlite3 外键

> ID：13534040
> 
> 赞同：0
> 
> 时间：2012-11-23T18:12:38.763
> 
> 标签：php, sqlite, pdo

我使用 PDO 连接到 sqlite3，但由于某种原因我无法使外键工作。根据文档，这个“PRAGMA short_column_names=1”应该启用它。我这样做：

```
$con = new PDO('sqlite:z:/testing.db');
$res = $con->exec('PRAGMA foreign_keys=ON');
var_dump($res);die(); 
```

返回 0。我尝试使用外键创建实际表，但它不起作用。对 SQLite3 类的直接请求虽然有效：

```
$con = new SQLite3('z:/testing.db');
$con->exec('PRAGMA foreign_keys = ON;');
var_dump($con->query('PRAGMA foreign_keys;')->fetchArray()); 
```

这将返回数组（2）{ [0]=> int(1) ["foreign_keys"]=> int(1) }

根据 SQLite3::version()，我有 sqlite 版本 3.7.7.1。我的 PHP 版本是 5.3.18，在 Windows 上运行。

请帮助我让它与 PDO 一起运行。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T18:22:22.423

我不知道`PRAGMA short_column_names=1;`应该与 PDO 一起发布以便外键约束与 SQLite 一起使用的想法。但是，您*也应该*`PRAGMA foreign_keys = ON;`使用 PDO 发出问题。

试试这个：

```
<?php

// SQL for creating database structure
$databaseSql = <<<SQL
    CREATE TABLE `user` (
        `id` INTEGER PRIMARY KEY AUTOINCREMENT,
        `name` TEXT NOT NULL,
        UNIQUE( `name` )
    );

    CREATE TABLE `userProfile` (
        `userId` INTEGER NOT NULL CONSTRAINT `userProfile_userId` REFERENCES `user`( `id` ) ON UPDATE CASCADE ON DELETE CASCADE,
        `image` TEXT NOT NULL
    );
SQL;

// SQL for inserting dummy data
$dataSql = <<<SQL
    INSERT INTO `user` VALUES( 1, "John" );
    INSERT INTO `user` VALUES( 2, "Mary" );
    INSERT INTO `user` VALUES( 3, "Joe" );
    INSERT INTO `userProfile` VALUES( 1, "/images/john.jpg" );
    INSERT INTO `userProfile` VALUES( 2, "/images/mary.jpg" );
    INSERT INTO `userProfile` VALUES( 3, "/images/joe.jpg" );
SQL;

// create a temporary SQLite instance in memory
$db = new PDO( 'sqlite::memory:', null, null, array(
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    PDO::ATTR_EMULATE_PREPARES => false
) );

// activate use of foreign key constraints
$db->exec( 'PRAGMA foreign_keys = ON;' );

// create database
$db->exec( $databaseSql );
// insert dummy data
$db->exec( $dataSql );

// should dump 3 records
var_dump( $db->query( 'SELECT * FROM `userProfile`;' )->fetchAll() );

// delete 1 user, cascade deleting 1 userProfile as well
$db->exec( 'DELETE FROM `user` WHERE `id` = 1;' );

// should dump 2 records
var_dump( $db->query( 'SELECT * FROM `userProfile`;' )->fetchAll() ); 
```

它应该导致以下结果：

```
array(3) {
  [0]=>
  array(2) {
    ["userId"]=>
    string(1) "1"
    ["image"]=>
    string(16) "/images/john.jpg"
  }
  [1]=>
  array(2) {
    ["userId"]=>
    string(1) "2"
    ["image"]=>
    string(16) "/images/mary.jpg"
  }
  [2]=>
  array(2) {
    ["userId"]=>
    string(1) "3"
    ["image"]=>
    string(15) "/images/joe.jpg"
  }
}
array(2) {
  [0]=>
  array(2) {
    ["userId"]=>
    string(1) "2"
    ["image"]=>
    string(16) "/images/mary.jpg"
  }
  [1]=>
  array(2) {
    ["userId"]=>
    string(1) "3"
    ["image"]=>
    string(15) "/images/joe.jpg"
  }
} 
```

# php - 使用javascript SDK登录后如何使用facebook getuser（）

> ID：13534044
> 
> 赞同：2
> 
> 时间：2012-11-23T18:13:02.147
> 
> 标签：php, javascript, facebook, login, permissions

所以我必须通过单击进入按钮来请求扩展权限，但是登录后需要刷新页面才能显示应用程序。这是我的代码：

```
<?php
require 'facebook.php';
$facebook = new Facebook(array(
  'appId'  => '< THE APPID >',
  'secret' => '< THE SECRET >',
  'cookie' => true,
));
$user = $facebook->getUser();

if ($user) {
  try {
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}
?>
<body>
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {

    FB.init({
      appId      : '< THE APPID >',
      status     : true,
      cookie     : true,
      xfbml      : true
    });

    // Additional initialization code such as adding Event Listeners goes here
    $('#btn-enter').click(function(){
        login();
    });

  };
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));

    function login() {
        FB.login(function(response) {
            if (response.authResponse) {        
                // connected
            } else {
                // cancelled
            }
        //});
        }, {scope: 'read_friendlists,friends_photos,publish_stream'});
    }
</script>
<?php if ($user): ?>
    <!--Here is my APP-->
<?php else: ?>
<a id="btn-enter">Enter</a>
<?php endif ?> 
```

有一个更好的方法吗 ？对我有用的是：

```
function login() {
    FB.login(function(response) {
        if (response.authResponse) {
            top.location.href='https://the_app_url';            
        } else {
        }
    //});
    }, {scope: 'read_friendlists,friends_photos,publish_stream'});
} 
```

但这会导致整个页面刷新并且本身并不“优雅”......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:32:06.940

用户认证后，您可以通过 Javascript SDK 调用图形 API 并向`/me`.

响应将包含一个带有用户信息的对象。

就是这样：

```
if (response.authResponse) {
      FB.api('/me', function(response) {
        alert(response.name);
   });  
} 
```

[在Facebook 开发者网站上](http://developers.facebook.com/docs/reference/javascript/FB.api/)阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T11:02:25.647

```
 require_once("facebook.php");
 $fbconfig['appid' ]     = "APPID";
 $fbconfig['secret']     = "SECRET";
 $fbconfig['baseurl']    = "BASEURL"; 
 $user            =   null; //facebook user uid
 $facebook = new Facebook(array(
  'appId'  => $fbconfig['appid'],
  'secret' => $fbconfig['secret'],
  'cookie' => true,
 )); 
 //Facebook Authentication part
    $user       = $facebook->getUser();
    //Login URL
    $loginUrl   = $facebook->getLoginUrl(
            array(
                'scope'         => 'email,offline_access,publish_stream,user_birthday,user_location,user_work_history,user_about_me,user_hometown',
                'redirect_uri'  => $fbconfig['baseurl']
            )
    );
    //Logout URL
    $logoutUrl  = $facebook->getLogoutUrl();
    if ($user){
        //get user basic description
        try {
          // Proceed knowing you have a logged in user who's authenticated.
          $user_profile = $facebook->api('/me');
          $_SESSION['fbid'] = $user_profile['id'];
          $_SESSION['logout'] = $logoutUrl;
        } catch (FacebookApiException $e) {
          //you should use error_log($e); instead of printing the info on browser
          d($e);  // d is a debug function defined at the end of this file
          $user = null;
        }
    }
$me = $user_profile;
//print_r($me);
//////////////////////////INSERTING DATA ON USER-RECORD FOR FACEBOOK USER/////////////////
if($_SESSION['fbid']){ 
$find_dup=$jeob->SqlQuery("select * from je_user_record where personal_id='".$me['id']."' AND first_name='".$me['first_name']."' AND last_name='".$me['last_name']."' AND email='".$me['email']."' AND oauth_provider='face' ");
//If no record in database
if($jeob->SqlRows($find_dup)=="0")
{
$insquery=mysql_query("insert into je_user_record (personal_id,first_name,last_name,email,oauth_provider) values('".$me['id']."','".$me['first_name']."','".$me['last_name']."','".$me['email']."','face')");
$faceuserid=mysql_insert_id();
    $_SESSION['userid'] =$faceuserid;
    $_SESSION['oauth_provider']= 'face';
//    header("location:index.php");
}
//if record found in database
//////////IF  RECORD FOUND IN DB//////////////////
else
{
    while($ff=mysql_fetch_array($find_dup))
    {
        $_SESSION['userid']=$ff['user_id'];
        $_SESSION['oauth_provider']= 'face';
    }
}

//Insert friend's ID on DB

        $fql    =   "SELECT uid,name,username,email,pic_square FROM user WHERE uid = me() OR uid IN (SELECT uid2 FROM friend WHERE uid1 = me())";
            $param  =   array(
            'method'    => 'fql.query',
            'query'     => $fql,
            'callback'  => ''
            );
            $friend_list   =   $facebook->api($param);
            /*$i=1;*/
            foreach($friend_list as $rec)
            {
            $frnname = $rec['name'];
            $frnid = $rec['uid'];
            $referid = $me['id'];
        $insert_table="fb_friends";
            $query=$jeob->SqlQuery("select * from ".$jeob->dbprefix.$insert_table." where refer_id='$referid' AND friends_id='$frnid' "); 
            if($jeob->SqlRows($query)=="0")
            {
                $insert_qry=array(
                "friends_id"=>"$frnid",
                "friend_name"=>"$frnname",
                "refer_id"=>"$referid");
                $jeob->SqlInsert($insert_table,$insert_qry);
            }
            else                    
            {                       //  if no record
            }                     
        }

} // end facebook session 
?> 
```

在上面的代码中，在 facebook 用户身份验证后，他们的朋友信息被访问并插入到数据库中。我认为这可能对您有所帮助。这段代码也清除了用facebook登录后刷新页面的问题

# asp.net - 使用 System.Net.Mail.MailAddress 验证电子邮件失败

> ID：13534057
> 
> 赞同：0
> 
> 时间：2012-11-23T18:13:53.707
> 
> 标签：asp.net, vb.net

我正在尝试使用以下代码验证电子邮件地址列表：

```
Public Function ValidateEmailAddressField() As Boolean
    Dim isValid As Boolean = True
    Try
        txtServiceEmails.Text = txtServiceEmails.Text.Trim.Replace(",", ";")
        Dim validateMailAddress = New MailAddress(txtServiceEmails.Text.Trim)
        Return isValid
    Catch ex As Exception
        isValid = False
        Return isValid
    End Try

End Function 
```

当我输入“johndoe@amce”或“johndoe@acme, janedoe@acme.org”时，代码验证为真。输入不带扩展名的电子邮件地址（例如“.com”）是否实际上被视为有效的电子邮件地址？

谢谢，

垃圾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:20:44.713

在合作环境中，域不必具有 .com/net/org... 'acme' 可以是有效域，因此，电子邮件 me@acme 可以是内部有效的电子邮件地址。

通常，人们使用正则表达式来验证电子邮件地址。有很多例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:22:55.587

是的，它是有效的。电子邮件地址的域部分必须符合主机名的要求，并且根据本地配置，“扩展名”可能是可选的。

> 如果指定了包括顶级域名 (TLD) 在内的所有标签，则主机名被视为完全限定域名 (FQDN)。主机名 en.wikipedia.org 以顶级域 org 结尾，因此是完全限定的。根据操作系统的 DNS 软件实现，不合格的主机名（例如 csail 或 wikipedia）可能会自动与系统中配置的默认域名组合，以确定完全合格的域名。**例如，麻省理工学院的学生可以发送邮件到“joe@csail”，并让邮件系统自动将其发送到 joe@csail.mit.edu**。

资料来源：[维基百科](http://en.wikipedia.org/wiki/Hostname)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:59:28.880

选择正则表达式验证器解决方案。

```
Public Function ValidateEmailAddressField() As Boolean

    Dim isValid As Boolean = True
    Dim emailExpression As New Regex("^((\s*[a-zA-Z0-9\._%-]+@[a-zA-Z0-9\.-]+\.[a-zA-Z]{2,4}\s*[,;:]){1,100}?)?(\s*[a-zA-Z0-9\._%-]+@[a-zA-Z0-9\.-]+\.[a-zA-Z]{2,4})*$")
    Try
        txtServiceEmails.Text = txtServiceEmails.Text.Trim.Replace(",", ";")
        txtServiceEmails.Text = txtServiceEmails.Text.Trim.Replace(" ", "")
        isValid = emailExpression.IsMatch(txtServiceEmails.Text.Trim)

        Return isValid

    Catch ex As Exception
        isValid = False
        Return isValid
    End Try

End Function 
```

# java - Android 中的 Java 日历可能是错误

> ID：13534058
> 
> 赞同：0
> 
> 时间：2012-11-23T18:13:56.133
> 
> 标签：java, android, calendar

以下代码在Android模拟器下无法通过断言：

```
TimeZone timezone = TimeZone.getTimeZone("Hongkong");
Locale locale = new Locale("zh", "HK"); 
Calendar calendar = Calendar.getInstance(timezone, locale);

calendar.set(Calendar.YEAR, 1979);
calendar.set(Calendar.MONTH, 4);        
calendar.set(Calendar.DAY_OF_MONTH, 13);            
calendar.set(Calendar.HOUR_OF_DAY, 4);  
calendar.set(Calendar.MINUTE, 30);      
calendar.set(Calendar.SECOND, 0);        

DateFormat df = DateFormat.getDateTimeInstance(DateFormat.LONG, DateFormat.LONG, locale);
df.setTimeZone(timezone);
String sDate = df.format(calendar.getTime());

int debug = calendar.get(Calendar.HOUR_OF_DAY);
Assert.assertEquals("Error datetime: " + sDate, 4, debug); 
```

我发现，如果将 DAY_OF_MONTH 更改为 12，错误就消失了：calendar.set(Calendar.DAY_OF_MONTH, 12);

请注意，此问题在 JUnit 测试中不存在。（没有安卓）

最后，这个问题似乎在Android真机上可能不存在。

任何意见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:23:39.860

我相信，这是因为这种转变：

> 香港在 1941 年采取了夏令时措施。然而，在 1970 年代，由于香港的纬度较低，政府认为这些措施没有必要。**这种做法在 1979 年被淘汰**。

这是 1979 年 5 月 13 日发生的 DST 更改。

> **1979 年 5 月 13 日星期日** 凌晨 3:29:59 无 UTC+8h HKT
> 
> **凌晨 3:30:00 → 凌晨 4:30:00 +1h** UTC+9h HKST DST 开始
> 
> 1979 年 10 月 21 日，星期日 3:29:59 AM +1h UTC+9h HKST

由于香港的 DST 开启和关闭，最后关闭，这可能是问题的根本原因。

# c# - EntityFramework 在不同的 DLL 中扩展基本模型

> ID：13534059
> 
> 赞同：1
> 
> 时间：2012-11-23T18:14:04.110
> 
> 标签：c#, .net, ef-code-first, entity-framework-4.3

我有一个使用代码优先 EF 4.3 的基本模型的 DLL。我想要的是使用附加字段扩展该 dll 中的某些模型。

例如在 BaseModel.DLL

```
namespace BaseModel
{
   public class Account
   {
       public Id { get;set;}
       public string Name {get;set;}
   }
} 
```

在一个引用项目中，我想扩展 Account 模型（和 DB 表）：

```
public class Account : BaseModel.Account
{
    public string SomeAdditionalInfo { get;set;}
} 
```

我想最终得到一个带有字段的表帐户

```
Id
Name
SomeAdditionalInfo 
```

这样我就可以在几个类似的项目中继续重用 BaseModel（和逻辑）。我想我不能使用部分类，因为我们说的是不同的 DLL。也许是继承？我尝试了几种方法，但我不断遇到关于拥有 2 个具有相同名称的模型的冲突。

有什么提示吗？提示？解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:02:27.677

您可以通过 Table per Hierarchy 使用继承。您可以创建基类 AccountBase 和子类 Account:AccountBase：

```
public class AccountBase
{
   public Id { get;set;}
   public string Name {get;set;}
}
public class Account : AccountBase
{
    public string SomeAdditionalInfo { get;set;}
} 
```

它生成表 AccountBase 将包含列 Id、Name、SomeAdditionalInfo 还有列鉴别器将包含该行中包含的类的实例。

# android - ADT 插件文件夹在哪里？

> ID：13534064
> 
> 赞同：2
> 
> 时间：2012-11-23T18:14:18.717
> 
> 标签：android, eclipse, macos

我有一个新的 MacBook Pro，我刚刚安装了 Eclipse，我按照安装说明安装了 ADT 插件，但是在我重新启动 Eclipse 后，我不知道它在哪里下载了 ADT 插件文件夹并且找不到它，有谁知道这个在哪里文件夹位于？

（它不在我的用户目录/android-sdk 中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:18:21.537

它在您的 Eclipse`plugins`目录中，就像任何其他 Eclipse 插件一样。

这是一个名为的jar文件`com.android.ide.eclipse.adt_xxxx.jar`

请注意，ADT 插件的配置需要您在 Eclipse 的首选项中输入 android SDK 的位置：在 Preferences > Android > SDK Location 中输入您的 android SDK 被提取的目录

# jquery - How to pass form values of jQuery Credit card validation pawel decowski

> ID：13534070
> 
> 赞同：2
> 
> 时间：2012-11-23T18:14:50.933
> 
> 标签：jquery, validation, credit-card

Im using [jQuery Credit Card Validator by Pawel Decowski](http://paweldecowski.github.com/jQuery-CreditCardValidator/) and want to pass the credit card type along with the other credit card detail. His template works fine and I adapted to my website designed. All the values of the form passed but one. **Card Type** - I cannot pass this value to the action because it just only `<li>`, not an input element.

**Javascript**

```
(function() {

  $(function() {
    $('.demo .numbers li').wrapInner('<a href="#"></a>').click(function(e) {
      e.preventDefault();
      return $('#card_number').val($(this).text()).trigger('input');
    });
    $('.vertical.maestro').hide().css({
      opacity: 0
    });
    return $('#card_number').validateCreditCard(function(result) {
      if (!(result.card_type != null)) {
        $('.cards li').removeClass('off');
        $('#card_number').removeClass('valid');
        $('.vertical.maestro').slideUp({
          duration: 200
        }).animate({
          opacity: 0
        }, {
          queue: false,
          duration: 200
        });
        return;
      }
      $('.cards li').addClass('off');
      $('.cards .' + result.card_type.name).removeClass('off');
      if (result.card_type.name === 'maestro') {
        $('.vertical.maestro').slideDown({
          duration: 200
        }).animate({
          opacity: 1
        }, {
          queue: false
        });
      } else {
        $('.vertical.maestro').slideUp({
          duration: 200
        }).animate({
          opacity: 0
        }, {
          queue: false,
          duration: 200
        });
      }
      if (result.length_valid && result.luhn_valid) {
        return $('#card_number').addClass('valid');
      } else {
        return $('#card_number').removeClass('valid');
      }
    });
  });

}).call(this); 
```

I have my own live version of fiddle if you guys wanna play with. [http://jsfiddle.net/cpR6b/](http://jsfiddle.net/cpR6b/)

Please suggest

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:23:55.857

I would create a hidden form field. Something like `<input type="hidden" id="cardType" value="" />`.

You could then simply add some jQuery logic in and have it set the value to whatever you wanted. Something like `$('#cardType').val(result.card_type.name)` would probably work well for you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:03:06.537

See [http://jsfiddle.net/jGESR/](http://jsfiddle.net/jGESR/)

Pseudocode

Add to form tag

```
 <input type='hidden' id='ccType' name='ccType' /> 
```

Add to JS (assuming that the li classname [.card] will contain one classname which is the card type)

```
 .....
 // check to make sure only one of the card is highlighted)
 if($(".cards li:not('.off')").length == 1){
     $('#ccType').val($(".cards li:not('.off')").attr('class'))
 }

 ...
 if (result.length_valid && result.luhn_valid) {
    return $('#card_number').addClass('valid');
 } else {
    return $('#card_number').removeClass('valid');
 } 
```

# html - HTML5 视频播放按钮在 Firefox 中不起作用

> ID：13534078
> 
> 赞同：1
> 
> 时间：2012-11-23T18:15:15.747
> 
> 标签：html, firefox, video, playback

当我单击播放按钮时，它只是转到时间线的末尾。但是，如果您将自动收报机拖动到中间的某处（或真正的任何地方），它就会播放视频。那么为什么一开始就不能播放呢？

它适用于除 Firefox 之外的所有其他浏览器。我正在使用 Firefox 17，感谢您的帮助。谢谢。

这是链接 [http://www.lonestarveincenter.com/](http://www.lonestarveincenter.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-27T09:54:04.363

很抱歉死灵，但我找到了这个问题的答案。

您的 onClick() 事件不起作用的原因是，Firefox 将其自己的 onCLick 事件添加到每个视频元素中，因此每当您单击视频时，视频开始播放然后立即停止。

```
function playPause() {
  'Before this event is fired the FF onClick event is fired'
  player = document.getElementById("PlayerID")
    var playBtn = document.getElementById('<%= img.ClientID %>');
    if (!player.paused) { 'Player is playing and will go through this code block'
      playBtn.setAttribute('Style', 'display: block;');
      player.pause();
    }

    else { 'Player is playing and will skip this code block'
      playBtn.setAttribute('Style', 'display: none;');
      player.play();
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:41:55.673

[W3 School 的http://www.w3schools.com/html/html5_video.asp](http://www.w3schools.com/html/html5_video.asp)`<source>`将您的视频更改为 HTML5 视频网站上的视频的一项非常快速的测试显示了所需的行为：单击播放，视频从开始。

我建议您尝试重新编码您的视频，并在本地进行测试。你现在是如何编码的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T15:29:06.070

我遇到了完全相同的问题。我使用的是 WebM 视频，它可以正常播放 - 在您在时间轴上选择一个位置之后。我转换为 .ogv，将其作为 WebM 和 mp4 上面的 HTML 中的第一个选项，它在 Firefox 和所有其他主要浏览器中运行良好。

# javascript - 传递 cookie 并从另一帧重新加载一帧

> ID：13534079
> 
> 赞同：0
> 
> 时间：2012-11-23T18:15:21.430
> 
> 标签：javascript, html, css

我有两个框架frame1 和frame2 的主html 页面。在 frame1 中，一个文本框和一个按钮，单击按钮将文本框中的值传递给 cookie。在 frame2 中，使用了通过 cookie 传递的这个值。当cookie值从frame1上的按钮单击事件更改时，我需要刷新或重新加载frame2页面。有什么建议可以实现这个吗？？？

# sql-server - ERWIN 创建和使用数据库

> ID：13534089
> 
> 赞同：2
> 
> 时间：2012-11-23T18:16:18.700
> 
> 标签：sql-server, database-design, data-modeling

我正在尝试使用 ERWIN 7 从我的逻辑模型生成物理数据库。

在自动生成的脚本中一切都很好，只有模型是在默认 SQL Server 数据库“master”中创建的，而不是在我与模型一起插入的数据库中创建的。

我找不到将我的模型与我与模型一起创建的数据库相关联的方法。

这是 ERWIN 自动生成的脚本：

```
> CREATE DATABASE Movies go
>
> 
> 
> 
> ALTER DATABASE Movies SET  RECOVERY FULL go
> 
> 
> 
> CREATE SCHEMA fbd AUTHORIZATION dbo go
> 
> 
> 
> CREATE DEFAULT Default_Value_movies_gen   AS 1 go
> 
> 
> 
> CREATE DEFAULT Default_Value_titulo_movies    AS 'No title' go 
```

但它应该自动生成：

> 创建数据库电影去
> 
> // 这里应该是“USE Movies”，使用ERWIN刚刚创建的数据库
> 
> ALTER DATABASE Movies SET RECOVERY FULL go
> 
> 创建模式 fbd 授权 dbo go
> 
> 创建默认 Default_Value_movies_gen AS 1 go
> 
> CREATE DEFAULT Default_Value_titulo_movies AS 'No title' go

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-02T07:33:50.467

您需要在 ERwin 中制作物理模型，然后转到 Tools->Forward Engineering-> Schema Generation，您可以在那里选择生成数据库。

# objective-c - 如何为 SSL 握手配置 CFStream（或 NSStream）？

> ID：13534091
> 
> 赞同：6
> 
> 时间：2012-11-23T18:16:24.643
> 
> 标签：objective-c, ssl, nsstream, cfnetwork, cfstream

我正在使用 CFStream/NSStream 进行 http 连接。我希望能够检测到 SSL 握手在三种情况下失败：

*   案例A：服务器不受信任
*   案例 B：服务器受信任但要求客户端证书
*   案例 C：服务器不受信任，它要求客户端证书

今天没有对我的 CFStream 的 SSL 属性做任何事情，我得到：

*   案例A：错误-9807
*   案例B：没有错误但服务器拒绝连接（错误500）
*   案例 C：错误 9807

有没有办法配置 CFStream 以正确区分这三种情况？或者在 SSL 握手期间有一些回调？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T19:58:08.840

前段时间，我使用 SSL 与 CFSockets 进行了相同的操作。CFStream 处理所有握手的东西。我为 NSStream 写了一个小类添加（基本代码来自 Apple，不再有链接，如果找到我会添加它）。这对我有用。

界面

```
@interface NSStream (FSNetworkAdditions)

+ (void)qNetworkAdditions_getStreamsToHostNamed:(NSString *)hostName
                                           port:(NSInteger)port
                                    inputStream:(out NSInputStream **)inputStreamPtr
                                   outputStream:(out NSOutputStream **)outputStreamPtr;

@end 
```

和实施

```
#import "FSNetworkAdditions.h"

@implementation NSStream (FSNetworkAdditions)

+ (void)qNetworkAdditions_getStreamsToHostNamed:(NSString *)hostName
                                           port:(NSInteger)port
                                    inputStream:(out NSInputStream **)inputStreamPtr
                                   outputStream:(out NSOutputStream **)outputStreamPtr
{
    CFReadStreamRef     readStream;
    CFWriteStreamRef    writeStream;

    assert(hostName != nil);
    assert( (port > 0) && (port < 65536) );
    assert( (inputStreamPtr != NULL) || (outputStreamPtr != NULL) );

    readStream = NULL;
    writeStream = NULL;

    CFStreamCreatePairWithSocketToHost(
                                       NULL,
                                       (CFStringRef) hostName,
                                       port,
                                       ((inputStreamPtr  != NULL) ? &readStream : NULL),
                                       ((outputStreamPtr != NULL) ? &writeStream : NULL)
                                       );

    NSDictionary *settings = [[NSDictionary alloc] initWithObjectsAndKeys:
                              [NSNumber numberWithBool:YES], kCFStreamSSLAllowsExpiredCertificates,
                              [NSNumber numberWithBool:YES], kCFStreamSSLAllowsAnyRoot,
                              [NSNumber numberWithBool:YES], kCFStreamSSLAllowsExpiredRoots,
                              [NSNumber numberWithBool:NO], kCFStreamSSLValidatesCertificateChain,
                              //kCFNull,kCFStreamSSLPeerName,
                              kCFStreamSocketSecurityLevelSSLv3, kCFStreamSSLLevel,
                              [NSNumber numberWithBool:YES], kCFStreamPropertyShouldCloseNativeSocket,
                              nil];

    if (readStream) {
        CFReadStreamSetProperty(readStream, kCFStreamPropertySSLSettings, (CFTypeRef)settings);
    }

    if (writeStream) {
        CFWriteStreamSetProperty(writeStream, kCFStreamPropertySSLSettings, (CFTypeRef)settings);
    }

    if (inputStreamPtr != NULL) {
        *inputStreamPtr  = CFBridgingRelease(readStream);
    }
    if (outputStreamPtr != NULL) {
        *outputStreamPtr = CFBridgingRelease(writeStream);
    }

}

@end 
```

就是这样，您现在可以像这样连接到服务器：

```
NSInputStream   *inputStream;
NSOutputStream  *outputStream;
[NSStream qNetworkAdditions_getStreamsToHostNamed:host 
                                             port:port 
                                      inputStream:&inputStream 
                                     outputStream:&outputStream];

        inputStream.delegate  = self;
        outputStream.delegate = self; 
```

其中“self”符合 NSStreamDelegate 协议。

我希望这些片段有帮助。

# php - PHP Mysql 搜索查询

> ID：13534095
> 
> 赞同：3
> 
> 时间：2012-11-23T18:16:45.457
> 
> 标签：php, mysql, search, pdo

您好，我有一个简单的搜索查询，我面临的是当有人写下他想要搜索的用户的唯一名字时，我的查询会找到它，当有人只在输入中写下姓氏并发布它时，它也显示了这一点，但是当用户在输入中一起写名字和姓氏时，即使他/她存在也找不到用户。$q 查询的最后一部分我写了名字和姓氏之类的部分不起作用我知道我的逻辑很糟糕，但是我该如何解决

```
 try {
        $q = "SELECT * FROM `members` WHERE `first_name` LIKE :search_string OR `last_name` LIKE :search_string OR `first_name` AND `last_name` LIKE :search_string";
        $q_do = $db->prepare($q);
        $q_do->execute( array("search_string"=>'%'.$query.'%') );
        $number = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
    } catch(PDOException $e) {
        $log->logError($e." - ".basename(__FILE__));
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-23T18:23:40.283

尝试使用连接：

```
$q = "SELECT * FROM `members` WHERE `first_name` LIKE :search_string 
OR `last_name` LIKE     :search_string 
OR concat(`first_name` , ' ', `last_name`) LIKE :search_string"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T18:22:30.800

```
SELECT * 
FROM `members` 
WHERE `first_name` LIKE :search_string 
   OR `last_name` LIKE :search_string 
   OR `first_name` AND `last_name` LIKE :search_string; 
```

`AND`是运算符而不是连接器。

```
SELECT * 
FROM `members` 
WHERE `first_name` LIKE :search_string 
   OR `last_name` LIKE :search_string 
   OR CONCAT(`first_name`,' ', `last_name`) LIKE :search_string; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:23:07.890

所以你不做的是：

用户输入“First Last”

你搜索 ：

```
First like '%First Last%' or Last  like '%First Last%' ... 
```

您需要使用全文搜索索引。

[http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html)

或类似的东西

[http://sphinxsearch.com/](http://sphinxsearch.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:27:59.060

试试这个：

```
$query = explode(" ", $query);
if(count($query)>1){
    $fname = $query[0];
    $lname = end($query);
}else{
    $fname = $query[0];
    $lname = $query[0];
}
$q = "SELECT * FROM `members` WHERE `first_name` LIKE :fname OR `last_name` LIKE :lname";
$q_do = $db->prepare($q);
$q_do->execute( array('fname' => "%$fname%", 'lname' => "%$lname%") ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-21T17:57:16.983

**最简单的搜索查询给你..试试这个它的工作人员。**

SELECT * FROM `TableName`WHERE `title`like '%Your Search Text%'

# javascript - window.open() 在 mozzilla 和 IE 中存在问题，但在 chrome 中有效

> ID：13534097
> 
> 赞同：0
> 
> 时间：2012-11-23T18:17:19.193
> 
> 标签：javascript, jquery, window.open

好的，就这么简单。我正在尝试在另一个窗口中以平面形式打开包含页面上信息的打印机友好格式。以下在 chrome 中效果很好，但在 IE 和 FireFox 中效果不佳。这意味着它将打开一个新标签，但它永远不会加载任何内容。关于为什么它会在 chrome 而不是 firefox 中工作的任何想法？

```
function generate_printer_friendly(){
    var form = jQ('<form/>').appendTo(document);

    window.open('','printer_friendly');
    form.attr('action','plugins/BuildAndInstall/pages/printer_friendly.php')
        .attr('target','printer_friendly')
        .attr('method','post')
        ;

    jQ('<input/>')
        .attr('type','hidden')
        .attr('name','bid')
        .val(JSON.stringify(bid))
        .appendTo(form)
        ;

    form[0].submit();
    form.remove();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:38:39.917

您需要将表单附加到`$("body")`而不是附加到`document`. 否则，您的表格将无法正确发布。

# php - PHP 邮件。预填充回复字段

> ID：13534102
> 
> 赞同：0
> 
> 时间：2012-11-23T18:18:20.273
> 
> 标签：php, email, imap

我正在使用 IMAP 创建一个标准的“直接回复电子邮件”PHP 脚本。它仅供管理员用户使用，因此不必过于复杂。我已经要求他们用“END”完成那里的消息，这样我就可以提取之前的所有内容。只是想知道 php mail() 中是否有一个标题或其他一些我可以做的聪明的事情来预先填充回复字段，比如 'END ------ 在这一行上方回复 ----- ---'？它不必支持每个电子邮件客户端，但每一点都有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:28:07.753

您可以以 html 格式发送电子邮件并放置一个链接，管理员可以单击该链接来回复电子邮件，使用[mailto](http://en.wikipedia.org/wiki/Mailto)功能您可以在主题、正文和字段中预先准备好内容。一个例子：

```
<a href="mailto:someone@example.com?cc=someone_else@example.com&amp;subject=This%20is%20the%20subject&amp;body=This%20is%20the%20body">Send email</a> 
```

# angularjs - angular js force.com Javascript 远程处理

> ID：13534104
> 
> 赞同：3
> 
> 时间：2012-11-23T18:18:22.843
> 
> 标签：angularjs, force.com

我是 Angular JS 的新手，并且真的很难从 javascript 远程处理将数据输入我的控制器。有没有人这样做过？

```
Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.Forecasting.Users}',
  new Object(),function(result, event){
    return result
  }
); 
```

我到底如何将数据输入控制器：

```
var forecastingCtrl = function($scope, $q){
    $scope.lengths = function(){return '5'};
    $scope.users = [];
} 
```

* * *

编辑：以下工作正常：

```
fc.service('Users', function($rootScope, $q) {
    this.get = function(){
        var deferred = $q.defer();

            Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.Forecasting.Users}',new Object(),function(result, event){
                if(event) {
                     $rootScope.$apply(function() {
                        deferred.resolve(result);
                    });

                } else { 
                    deferred.reject(result);
                }            
            });
            return deferred.promise;

    }

});

function forecastingCtrl($scope, $q, Users){
    $scope.lengths = function(){return '5'};

    var promise = Users.get();
    promise.then(
        function(users){
            $scope.users = users;
        },
        function(reason){
            alert('Failed: ' + reason);
        }
    );    

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:57:03.417

我没有使用 javascript 远程处理（听起来很有趣），但您可能想要做的是将您的 visualforce 代码封装在服务中，有一个方法（很可能是一个承诺）来返回您的数据并将服务注入您的控制器。这样做的好处是您可以通过注入数据服务的模拟或间谍来对控制器进行单元测试。该模式与您使用 Angular 的 $http 和 $resource 服务的方式非常相似。希望这能让你走上正确的轨道。

# drupal - 首页中的Drupal 7节点对象丢失

> ID：13534105
> 
> 赞同：0
> 
> 时间：2012-11-23T18:18:30.303
> 
> 标签：drupal

我刚开始使用drupal，这是我根本不明白的事情。所以我写了我自己的从默认主题派生的主题。我启用了图像模块，使其还具有基本页面的特色图像 - 到目前为止一切都很好。现在在 template.php 中，我使用 preprocess_page 挂钩将图像放入页面内容上方的一种横幅中，但是..节点对象不在第一个参数中（函数=但仅用于首页？！在所有其他页面上，我看到了节点对象。有人可以向我解释一下吗？或者这听起来像是一些自制的东西。我测试了 bartik 主题，我可以重现这种行为，所以我想知道为什么

谢谢

# javascript - 缩放事件覆盖 d3js 中的拖动行为

> ID：13534115
> 
> 赞同：3
> 
> 时间：2012-11-23T18:19:25.883
> 
> 标签：javascript, svg, zooming, d3.js, drag

我正在尝试使用 d3js 为圆形项目实现拖动和缩放事件处理程序。我已经为这两个事件添加了行为，如下所示

```
var circle = svg.append("circle")
    .attr("fill", "green")
    .attr("opacity", 0.6)
    .attr("cx", 100)
    .attr("cy", 100)
    .attr("r", 13)
    .call(d3.behavior.drag().on("drag", drag))
    .call(d3.behavior.zoom().on("zoom", zoom)); 
```

不缩放对象，拖动工作正常。放大/缩小对象后，拖动不起作用，但所有包含 mousedown 的事件都被捕获为“缩放”事件。

有关完整源代码，请参阅[http://jsfiddle.net/xTaDC/](http://jsfiddle.net/xTaDC/)

似乎我不明白“d3.behavior”。[https://github.com/mbostock/d3/blob/master/examples/mercator/mercator-zoom-constrained.html](https://github.com/mbostock/d3/blob/master/examples/mercator/mercator-zoom-constrained.html)仅提供缩放处理程序并处理拖动和缩放。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T17:21:29.923

据我所知，d3 的缩放行为已经处理了拖动，所以拖动是多余的。尝试使用缩放的 d3.event.translate（这是一个 2 元素数组，因此如果您只想获取 x 值，您可以使用 d3.event.translate[0]）来复制拖入中的功能你的变焦。

附加提示：为了让您自己更轻松，请确保将呼叫（缩放）应用于您要拖动的任何内容的父级。这将防止紧张和摇晃的行为。

来源当然是 d3 wiki。“这种行为会自动创建事件侦听器来处理容器元素上的**缩放和平移**手势。鼠标和触摸事件都受支持。” [https://github.com/mbostock/d3/wiki/Zoom-Behavior](https://github.com/mbostock/d3/wiki/Zoom-Behavior)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-14T07:09:43.040

我遇到了类似的问题，并通过覆盖其他缩放子事件来解决它。

在缩放和拖动事件监听器之后添加以下代码

```
.on("mousedown.zoom", null)
.on("touchstart.zoom", null)
.on("touchmove.zoom", null)
.on("touchend.zoom", null); 
```

所以完整的代码看起来像

```
var circle = svg.append("circle")
    .attr("fill", "green")
    .attr("opacity", 0.6)
    .attr("cx", 100)
    .attr("cy", 100)
    .attr("r", 13)
    .call(d3.behavior.drag().on("drag", drag))
    .call(d3.behavior.zoom().on("zoom", zoom))
    .on("mousedown.zoom", null)
    .on("touchstart.zoom", null)
    .on("touchmove.zoom", null)
    .on("touchend.zoom", null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T22:45:41.400

将您的图表附加到敏感事件区域（必须是最后一个附加）：

```
var rect = svg.append("svg:rect")
    .attr("class", "pane")
    .attr("width", w)
    .attr("height", h); 
```

之后（不包括）在此区域添加事件管理

```
rect.call(d3.behavior.zoom().x(x).scaleExtent([0.5, 4]).on("zoom", draw)); 
```

并且绘制函数是

```
function draw() {
    svg.select("g.x.axis").call(xAxis);
    svg.select("g.y.axis").call(yAxis);
    svg.select("path.area").attr("d", area);
    svg.select("path.line").attr("d", line);
} 
```

看到这个例子：[https ://groups.google.com/forum/?fromgroups=#!topic/d3-js/6p7Lbnz-jRQ%5B1-25-false%5D](https://groups.google.com/forum/?fromgroups=#!topic/d3-js/6p7Lbnz-jRQ%5B1-25-false%5D)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-04T17:12:14.147

2020年使用d3.zoom开启缩放平移：[https ://observablehq.com/@d3/zoom](https://observablehq.com/@d3/zoom)

如果要启用背景平移，同时允许拖动圆圈，请参阅官方示例，其中 d3.drag 和 d3.zoom 用于不同的元素：[https ://observablehq.com/@d3/drag-zoom](https://observablehq.com/@d3/drag-zoom)

# javascript - 在Javascript中获取对象的任何级别的元素

> ID：13534116
> 
> 赞同：1
> 
> 时间：2012-11-23T18:19:26.907
> 
> 标签：javascript, json, object

鉴于以下情况：

```
var a = JSON.parse('{"fst":"data1","snd":{"ind2":"data2"}}');
var index = "fst";
var res = a[index]; //res = data1
var index2 = "????";
var res2 = a[index2]; //res = data2 
```

我应该穿什么`index2`这样`res2`等于`data2`？

我正在寻找一种通用语法，它可以让我在解析的 json 的任何级别上抓取一个元素，只需修改索引字符串。

（我正在循环遍历来自 json 派生对象的不同位置/级别的元素列表以构建表）

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:21:51.673

您正在访问属性的属性，语法反映了这一点：

```
var res = a['snd']['ind2']; 
```

没有办法直接直接抓取“嵌套”的属性。如果您被允许更改原始对象，您可以为每个对象添加快捷方式访问器：

```
//Credit goes to Esailja for the original
function deepAccess(obj) {
    function nestedAccess(o, level) {
        if (typeof o == "object") {
            var level = level || "";
            for (p in o) {
                if (o.hasOwnProperty(p)) {
                    if (level && typeof(o[p]) != "object") {
                        obj[level + "." + p] = o[p];
                    }
                    nestedAccess(o[p], (level ? level + "." : "") + p);
                }
            }
        }
    }
    nestedAccess(obj);
}

deepAccess(a);

a["snd.ind2"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:25:27.260

你需要一个功能

```
function deepAccess( obj, str ) {
    var parts = str.split("."),
        cur = obj;
    for( var i = 0; i < parts.length; ++i ) {
        cur = cur[parts[i]];    
    }

    return cur;
}

var index = "fst";
deepAccess( a, index ); //"data1"
index = "snd.ind2";
deepAccess( a, index ); //"data2" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T15:39:59.660

```
var someObject1 = {};
var someObject2 = {e01: '*', e02: {e03: '*', e04: '*'}, e05: '*'};
var someObject3 = {e01: {e02: {e03: '*'}}};

function setValueByPath(obj, path, value) {
    var pathArray = path.split('.');

    function goDownstears(o, chunk, val) {
        var prop = chunk.shift();

        if(!o.hasOwnProperty(prop)) o[prop] = {};

        o[prop] = (chunk.length > 0) ? goDownstears(o[prop], chunk, val) : val;

        return o;
    }

    obj = goDownstears(obj, pathArray, value);
}

setValueByPath(someObject1, 'e01.e02.e03', 'changed');

setValueByPath(someObject2, 'e02.e04', 'changed');

setValueByPath(someObject3, 'e01.e02.e03', 'changed');
setValueByPath(someObject3, 'e01.e02.e04', 'changed');
setValueByPath(someObject3, 'e02.e01.e01', 'changed');

console.log(someObject1);
console.log(someObject2);
console.log(someObject3); 
```

我的问题在这里关闭了[设置一个对象属性，如 obj['level1.level2.leve3'] = value](https://stackoverflow.com/questions/13563093/set-an-object-property-with-sugar-like-objlevel1-level2-leve3-value)

见这里[http://jsfiddle.net/zafod/RDGwY](http://jsfiddle.net/zafod/RDGwY)

此问题用于设置值，但您可以通过迭代返回询问的属性

# java - JPA 将属性存储为行

> ID：13534123
> 
> 赞同：1
> 
> 时间：2012-11-23T18:19:52.993
> 
> 标签：java, database, design-patterns, jpa

我有配置对象。

```
Config {
  String a;
  int b;
....
}

Config2 {
  Double c;
....
} 
```

由于系统中只有一个配置对象，我想存储为行。

所有属性名称作为键

```
key  value   type
a    test    config
b    123     config
aa   11.11   config2 
```

有没有办法在 JPA 中做到这一点？存储此类对象的最佳模式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:45:06.700

您可以通过多种方式实现此目的，这是一个示例

```
@Entity
@Table(name = "YOURTABLE")
@DiscriminatorColumn(name = "type")
@DiscriminatorValue("config")
Config {
  @Id
  String key;
  @Column(name = "type")
  String type;
  @Transient 
  String a;
  @Transient 
  int b;
  ....
  @Column(name ="value")
  String value ;

  initType ()
  {
    // assume either a or b contain value
    value = a == null || a.isEmpty() ? String.valueOf(a) : a;
  }
}

@Entity
@Table(name = "YOURTABLE")
@DiscriminatorColumn(name = "type")
@DiscriminatorValue("config2")
Config2 {

  @Id
  String key;
  @Column(name = "type")
  String type;
  @Transient
  Double c;
  @Column(name ="value")
  String value ;
  ....
  initType ()
  {
    value = String.valueOf(c);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T23:15:32.483

您可以尝试创建一个属性实体，然后让 Config 和 Config2 包含可以从属性列表或工厂构建自己的方法。

```
List<Property> configPropeties = entityManager.createQuery("select p from Property p where p.type='config'").getResultList();
Config config = new Config();
for(Property p: configProperty) {
  if (p.key == "a")
    config.a = P.value;
.. 
```

您可能可以使用反射使其更加通用，因为键将是对象中的一个属性，并且查询中使用的类型可以从类名中确定。持久化更改需要反转过程并将属性合并到 entityManager 中。属性将需要使用键和类型的复合 pk。

# jsp - struts2忘记密码

> ID：13534124
> 
> 赞同：-2
> 
> 时间：2012-11-23T18:19:56.657
> 
> 标签：jsp, struts2

我需要struts2中的代码来忘记密码。我有一个jsp，用户可以在其中输入用户名。然后我将在动作类中获取dat用户名。使用该用户名，我将从数据库中选择密码和电子邮件，我不知道如何发送电子邮件的代码。

我的jsp是：

我的行动课是：

```
public class UserFormControlAction extends ActionSupport
{

    private String fusername;

    public String getFusername() {
        return fusername;
    }

    public void setFusername(String fusername) {
        this.fusername =fusername;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:02:08.227

这是一个非常广泛的问题。可以给你提示和一些参考

提示：您可以使用[javaMail API](http://www.tutorialspoint.com/java/java_sending_email.htm)

参考：[如何通过 java 发送电子邮件](http://www.zetcode.com/tutorials/jeetutorials/sendingemail/)，这是一些教程，你应该能够解决你的问题。

# asp.net-membership - 根据选择加载不同的角色

> ID：13534126
> 
> 赞同：1
> 
> 时间：2012-11-23T18:20:07.670
> 
> 标签：asp.net-membership, asp.net-authorization

我正在开发一个 ASP.NET MVC 3 应用程序，用户可以在其中为不同的资产类型分配不同的角色。他们能够一次查看属于不同组（资产类型）的资产。

根据正在查看的资产的资产类型，我想更新委托人的角色数组，使其仅具有用户已分配给该资产类型的角色。

我想我会做一个授权过滤器，负责根据正在查看的资产查找用户分配给的角色并将它们加载到角色数组中。这样，角色数组将始终反映他们对正在查看的资产拥有的权限。

然后从视图中，我可以隐藏/显示页面的不同部分，具体取决于它们是否在特定组中（User.isInRole）

这是否是根据资产类型为用户切换角色的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T11:01:40.140

如果需要在请求中应用这些角色，并且您可以从标头、查询字符串、cookie 或会话中获取项目标识符，我建议可能添加一个绑定到`AuthorizeRequest`事件的 httpmodule。在这一点上，您将希望为您的`IPrinciple`对象提供其自定义实现

IsInRoles 基于您的规则。

这行得通吗，我主要是在猜测您的设置和 ipad 上的情况。

# javascript - Javascript获取数组字段名称

> ID：13534132
> 
> 赞同：2
> 
> 时间：2012-11-23T18:20:53.183
> 
> 标签：javascript, arrays, json

如何从下面的数组中访问字段名称“DateAndTime”，我需要正确格式化 json Date 输出。任何建议/帮助将不胜感激。

```
var chartData = [{"Value1":17.800,"DateAndTime":"\/Date(1338501601000)\/"}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:22:41.480

像这样：

```
alert( chartData[0].DateAndTime ); 
```

但请注意，您发布的代码中缺少结尾`]`。

请参阅工作[**演示**](https://tinker.io/81e90)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:24:04.620

你会这样做：

```
chartData[0].DateAndTime; 
```

# python - 公历日期-numDays 函数

> ID：13534139
> 
> 赞同：1
> 
> 时间：2012-11-23T18:22:00.457
> 
> 标签：python, algorithm, data-structures

我必须编写`numDays(otherdate)`函数，将天数作为此日期和OtherDate 之间的正整数返回。

此函数属于已初始化为给定公历日期的 Date ADT 类。我们有一个公历日期`self._date(month,day,year)`格式。它必须返回两个日期之间的差异。比如 9 月 25 日和 10 月 6 日 = 它有 12 天的差异

```
 def numDays(self,otherDate):
        print("Enter a date:")
        y=int(input("Year:"))
        m=int(input("Month:"))
        d=int(input("Day:"))
        today=self._date(y,m,d)
        diff=today-otherDate
        NoOfDays=diff.days
        print("The Number of day between today and Julian date is %s"%NoOfDays) 
```

那样写，但我知道有一些错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:10:58.310

问题是，您还必须提供国家和欧洲部分地区，甚至是您计算差额的州。[有关详细信息，请参阅位于http://en.wikipedia.org/wiki/Gregorian_calendar](http://en.wikipedia.org/wiki/Gregorian_calendar)的wiki 。

虽然有一个通用公式（应该很容易找到），但我认为这并不准确。

另一方面：谁在乎。那些本可以在很久以前就去世的人 ;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T00:00:35.413

如果两个日期都是`datetime.date`对象，则计算今天和另一个日期之间的天数：

```
from datetime import date

number_of_days = date.today().toordinal() - other_date.toordinal() 
```

它没有考虑与时区相关的问题，并且假定您错误地写了“朱利安日期”。

顺便说一句，从 9 月 25 日到 10 月 6 日有 11 天：

```
>>> date(2012, 10, 6).toordinal() - date(2012, 9, 25).toordinal()
11
>>> date(2012, 9, 26).toordinal() - date(2012, 9, 25).toordinal()
1
>>> date(2012, 9, 25).toordinal() - date(2012, 9, 25).toordinal()
0 
```

要在没有 datetime 模块的情况下执行此操作，您需要执行一些简单的算术运算。日历每 400 年重复一次，请参阅[算法](http://en.wikipedia.org/wiki/Leap_year#Gregorian_calendar)。

# javascript - jQuery：ajax 内容未在某些计算机上加载

> ID：13534145
> 
> 赞同：0
> 
> 时间：2012-11-23T18:22:42.977
> 
> 标签：javascript, jquery, ajax, load

我对 Javascript 函数有一个非常奇怪的问题：

```
function changeContent(url, id) {
  jQuery('#'+id).load(url);
} 
```

如您所见，该功能并不是很复杂。它只是将 url 的内容加载到元素中。

但无论他使用哪种浏览器，它都无法在朋友的计算机上运行。
在 Fiddler 中，我可以看到请求工作正常，但 div 的内容并没有改变。

知道我/他能做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:43:39.963

一切正常，您的功能是正确的：

```
$('#test').load('http://fiddle.jshell.net/js/Resources.js'); // correct

$('#test').load('http://doc.jsfiddle.net/'); // Error: XMLHttpRequest cannot load 
// http://doc.jsfiddle.net/. Origin http://fiddle.jshell.net is not allowed by 
// Access-Control-Allow-Origin. 
```

这是示例： http: [//fiddle.jshell.net/AG9nf/](http://fiddle.jshell.net/AG9nf/)

您是否将相同的域放入 url 属性？​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:49:58.213

实际上，您的代码看起来太简单了，因为通常您不想将整个页面（包括头部和正文）加载到另一个页面中。相反，使用选择器来定位页面的片段。

请参阅有关加载页面片段[的文档。](http://api.jquery.com/load/)

# php - magento 通讯状态已发送，收件人 0？

> ID：13534147
> 
> 赞同：1
> 
> 时间：2012-11-23T18:22:53.720
> 
> 标签：php, magento, newsletter

好的，所以我已经阅读了有关 Magento cron 作业的所有内容，并且它看起来好像设置正确。问题出在这里：

我已安排（qued）时事通讯，它说在状态下发送，但它说收件人 0？所以什么都没有发出来？为什么？我有将近 5000 个订阅者？

有任何想法吗？

梅根

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:46:52.687

所以看起来 cron.php 文件没有设置正确的权限。重置权限后，我正在成功处理我们所说的magento时事通讯。

如果它不起作用，我会及时通知大家，但现在它似乎按计划工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-18T13:44:57.337

具有已发送状态的收件人 0 表示您没有从 Newsletter Queue 表单中选择商店。它不取决于 cron.php 权限

# android - OPENGLES 游戏每 3 秒冻结一次

> ID：13534150
> 
> 赞同：0
> 
> 时间：2012-11-23T18:23:13.047
> 
> 标签：android, opengl-es, lag

我正在使用 OpenglES 在 Android 中开发视频游戏。但是我的主游戏循环或渲染器有问题，因为游戏每 3 秒（或多或少）滞后一次，我不知道为什么。我唯一知道的是它一直在发生，无论游戏中发生了什么。

我有一个主循环，我在其中调用 gameInput、gameLogic 和 gameRenderer。当我调用 gameRenderer 时，我会等到它完成继续......每秒有 20 fps。

这发生在任何人身上吗？或者有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T23:26:11.823

从理论上讲，如果它是垃圾收集器，您可以将类似 -Xms2G -Xmx2G（堆大小）的东西作为 VM 参数传递，那么在 VM 吃完所有 2G 之前垃圾收集器将不会运行，因此延迟应该会消失，您就会知道这是垃圾收集器问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:51:55.750

你用java，对吧？它看起来像垃圾收集。尝试禁用部分代码并检查延迟是否消失。您可以定位问题发生的地方。

另外如果你使用Eclipse 插件有DDMS 的东西。您可以从那里使用分配跟踪器来查看创建了哪些对象以及创建了多少个对象。

# python - 如何在 appengine 的 db.Model 中获取属性的数据类型？

> ID：13534151
> 
> 赞同：1
> 
> 时间：2012-11-23T18:23:13.530
> 
> 标签：python, google-app-engine

我在数据存储中动态存储数据，所以在存储值之前我必须知道属性的类型。我已经阅读了类模型的文档，但没有找到答案。我会感谢所有的帮助

假设我有两种类型的实体。

```
 class Custom_Suppl(db.Model):
        code=db.StringProperty(required=True)

    class Inventory(db.Model):
        code=db.FloatProperty(required=True) 
```

我有一个在这些实体中存储值的函数

```
 def storeValues(databaseName,values)
        ....some code... 
```

您会看到这两个实体具有相同的属性名称，但值类型不同。所以我必须将值转换为相应的类型。我如何获得属性的类型？我希望这能澄清它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:29:50.443

我意识到类模型中有一个类方法 .properties() 。它返回特定实体中所有属性的字典。每个属性都是一个属性类。[见这里](https://developers.google.com/appengine/docs/python/datastore/propertyclass#Property_data_type)。它有一个类属性 data_type。

# javascript - javascript获取父嵌套对象？

> ID：13534153
> 
> 赞同：7
> 
> 时间：2012-11-23T18:23:23.577
> 
> 标签：javascript, oop, object

例如，我有一个这样的对象：

```
obj = {
    subobj1: {

    },
    subobj2: {
        func1: function(){

        },
        func2: function(){

        }
    },
    subobj3: {
        func3: function(){

        },
        func4: function(){

        }        
    },
} 
```

如何从 func4 中调用 func1 而不必调用 obj.subobj2.func1() ？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-23T18:24:13.520

你不能完全。您无法知道您的函数存在于哪些对象中。

请注意，它可能不止一个：您可以在现有代码之后编写此代码：

```
var obj2 = {some:obj.subobj3}; 
```

因此，从属性值到持有它的对象之间不可能有唯一的链接（也没有可访问的链接）。

现在，假设您对创建对象时的链接感到满意，您可以使用工厂来构建您的对象：

```
obj = (function(){
    var parent = {
        subobj1: {

        },
        subobj2: {
            func1: function(){

            },
            func2: function(){

            }
        },
        subobj3: {
            func3: function(){

            },
            func4: function(){
                parent.subobj2.func1();
            }        
        }
    };
    return parent;
})(); 
```

然后你可以打电话

```
obj.subobj3.func4(); 
```

[示范](http://jsfiddle.net/DFFWy/)

* * *

**编辑**

我看到你给你的问题加上了 OOP 标签。你应该知道我给出的模式更常用于定义模块。javascript 中的 OOP 更经常使用`new`and来完成`prototype`，以便启用实例共享方法和继承。由于您可能想要模块而不是 OOP，但您似乎还不错。

请参阅[此介绍](https://developer.mozilla.org/en-US/docs/JavaScript/Introduction_to_Object-Oriented_JavaScript)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-10-14T21:18:25.750

以下是使用递归初始化添加`.parent`到任何子对象的方法：

```
var obj = {
    init: function() {
        for (var i in this) {
            if (typeof this[i] == 'object') {
                    this[i].init = this.init;
                    this[i].init();
                    this[i].parent = this;
            }
        }
        return this;
    },
    subobj1: {
    },
    subobj2: {
        func1: function(){
            console.log('hey');
        },
        func2: function(){
        }
    },
    subobj3: {
        func3: function(){
        },
        func4: function(){
            this.parent.subobj2.func1();
        }        
    }
}.init();

obj.subobj3.func4(); 
```

使用此解决方案，您还可以`.parent`根据嵌套需要多次使用，例如，如果您有两层嵌套：

```
this.parent.parent.subobjX.funcY(); 
```

[http://jsbin.com/yuwiducadoma/1/watch?js,console](http://jsbin.com/yuwiducadoma/1/watch?js,console)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:36:46.407

您不能直接这样做，因为没有办法像在文件系统中使用“..”那样“向上”对象层次结构。

您可以做的是让变量直接指向子对象或子函数，这样您就不需要通过层次结构来调用它们。以下是创建 Javascript 模块的常见模式：

```
obj = (function(){

    var obj1 = {...}
    var obj2 = {...}

    var func3 = function(){...};
    var func4 = function(){...};

    return {
        subobj1: obj1,
        subobj2: obj2,
        subobj3: {
            func3: func3,
            func4: func4
        }
    }
}()); 
```

在此示例中，内部函数可以直接从其变量中访问`obj1`、`obj2`和。自调用函数使这些内部变量是私有的并且对外部隐藏，并且 return 语句允许您仅导出要公开的函数。`func3``func4`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-25T08:18:28.063

正如其他人所说，使用普通对象是不可能从嵌套的孩子中查找父母的。

但是，如果您使用递归[ES6 代理](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)作为助手，这是可能的。

我编写了一个名为[ObservableSlim](https://github.com/ElliotNB/observable-slim)的库，除其他外，它允许您从子对象向上遍历到父对象。

这是一个简单的示例（[jsFiddle 演示](https://jsfiddle.net/hp0h5g8v/)）：

```
var test = {"hello":{"foo":{"bar":"world"}}};
var proxy = ObservableSlim.create(test, true, function(changes) {
    console.log(JSON.stringify(changes));
});

function traverseUp(childObj) {
    console.log(JSON.stringify(childObj.__getParent())); // returns test.hello: {"foo":{"bar":"world"}}
    console.log(childObj.__getParent(2)); // attempts to traverse up two levels, returns undefined because test.hello does not have a parent object
};

traverseUp(proxy.hello.foo); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T18:36:19.063

那是不可能的。对象属性由设置它们的对象获得。JavaScript 不会将根对象隐式设置为全局对象，因此您不能将其别名`obj.subobj2.func1`为`func1`或以任何方式更短。如果您发现自己过度调用该函数，请尝试设置一个变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-03T16:06:04.833

这是一个`ActionScript`更像且易于理解的答案：

```
function MainObject() {
   this.x = 100;
   this.y = 50;
   this.second = new SecondObject(this);
}

function SecondObject(p) {
    this.parent = p;
}

var firstobject = new MainObject();

// Saving a reference to SecondObject.
var secondObject = firstobject.second;

// Because of parent variable, you can access second object parent without needing to have the parent object in a variable.
console.log(secondObject.parent.x);
console.log(secondObject.parent.y); 
```

请记住，一个对象不能有多个父对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-23T12:42:54.330

您对对象的实现是不可能的。取决于您的需求 - 以下实现可能有用：

```
obj = function(){
  var obj = {
    subobj1: {

    },
    subobj2: {
        func1: function(){
          console.log('func1');
        },
        func2: function(){

        }
    },
    subobj3: {
        func3: function(){

        },
        func4: function(){
          this.parentObject.subobj2.func1();
        }        
    }
  }
  obj.subobj3.parentObject = obj;
/*  
  //You can also init parentObject reference of the rest of the nested objects if you need
  obj.subobj1.parentObject = obj;
  obj.subobj2.parentObject = obj;
*/  
  return obj;
}();

obj.subobj3.func4(); 
```

这个想法是嵌套对象不能知道谁是他们的父母，但父母可以告诉它的孩子他是谁（但是然后需要init.code，正如你在我的实现中看到的那样）。

你可以在这里测试它：http: [//jsbin.com/eVOpITom/1/edit](http://jsbin.com/eVOpITom/1/edit)

# sql - 将结果集用作表 (TSQL)

> ID：13534156
> 
> 赞同：0
> 
> 时间：2012-11-23T18:23:53.267
> 
> 标签：sql, sql-server, tsql

说，我有以下内容：

```
WITH    T1 as (select xxx as MYALIAS FROM T)
        T2 as (select yyy from T1)

SELECT  T2.ID,
        MAX(MYALIAS) AS MAX_ALIAS,      
        T.AN_ALIAS

FROM   T2

WHERE  MAX_ALIAS <> T.AN_ALIAS 
GROUP  BY T2.ID, T.AN_ALIAS 
```

让我们将结果想象为一个名为 的表`MY_RESULT_TABLE`。

我需要将 MY_RESULT_TABLE 加入其他一些列。
我需要获得 `TEMP_TABLE = MY_RESULT_TABLE + SOME JOINS`.

问题是如何使用这个 MY_RESULT_TABLE？

我试图做 `WITH MY_RESULT_TABLE AS (the code above)`......没有工作......

**编辑**
我的另一个问题是我需要从 MY_RESULT_TABLE 的选择中插入一些值到 MY_TABLE...

```
INSERT INTO MY_TABLE_TO_INSERT ...
SELECT a b c FROM MY_RESULT_TABLE 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T18:46:28.510

它应该像您详细说明的那样工作，只需记住用逗号分隔每个 CTE。

**编辑**您也可以将 CTE 用于 INSERT 和 UPDATE。已更新插入。

```
;
WITH T1 AS 
(
    SELECT xxx 
    AS MYALIAS FROM T
),
T2 AS 
(
    SELECT yyy 
    FROM T1
),
MY_RESULT_TABLE AS 
(
    SELECT  T2.ID,
            MAX(MYALIAS) AS MAX_ALIAS,      
            T.AN_ALIAS
    FROM   T2
    WHERE  MAX_ALIAS <> T.AN_ALIAS 
    GROUP  BY T2.ID, T.AN_ALIAS

)
INSERT INTO MY_TABLE_TO_INSERT(col1, col2, col3, ...)
    SELECT ID, MAX_ALIAS, xyz.OtherColumnsHere
        FROM MY_RESULT_TABLE
        INNER JOIN xyz on ... 
```

# c - 在 Mac 进入睡眠状态之前执行命令

> ID：13534167
> 
> 赞同：14
> 
> 时间：2012-11-23T18:25:01.350
> 
> 标签：c, macos, sleep

我编写了一个 C 程序/LaunchDaemon 来检查我的 MacBook 是否在家（连接到我的 WLAN）。如果是这样，它会禁用我的密码保护；如果没有，它会启用它。

简单的。但问题是，当我将 MacBook 带到其他任何地方并且密码保护被禁用时，它会在没有密码保护的情况下唤醒。

我对此的解决方法是：每次在它进入睡眠之前启用密码*保护*。

问题：有什么方法可以知道我的 Mac 何时准备睡觉？我可以让我的程序听一些中断吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T18:43:25.333

您可以使用 I/O Kit 来完成，查看 Apple 的 [QA1340：Registering and unregistering for sleep and wake notifications](http://developer.apple.com/library/mac/#qa/qa1340/_index.html)。您可能还想分析[SleepWatcher](http://www.bernhard-baehr.de)实用程序源或根据您的需要使用/集成。从主页：

> *SleepWatcher 2.2（与 Mac OS X 10.5 到 10.8 一起运行，包括源代码）是用于 Mac OS X 的命令行工具（守护程序），用于监控 Mac 的睡眠、唤醒和空闲状态。它可用于在 Mac 或 Mac 的显示器进入睡眠模式或唤醒时、在没有用户交互的给定时间后或当用户在休息后恢复活动或 Mac 的电源时执行 Unix 命令笔记本连接或分离。它还可以使 Mac 进入睡眠模式或检索自上次用户活动以来的时间。要从该软件中受益，需要对 Unix 命令行有一点了解。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-18T07:48:37.267

我附在我的 C 文件的内容下面，`beforesleep.c`当收到“将睡眠”通知时，它执行一些命令行命令（在我的情况下是 shell 命令和 AppleScript 脚本）。

## 你可以把你的代码放在哪里：

为了在 mac 进入休眠状态时运行您的代码，只需将`system(...)`调用替换为您希望运行的代码即可。

就我而言，我使用`system()`as 它允许我运行以字符串形式传递的 shell 命令，但如果您更喜欢只运行 C 代码，则可以将 C 代码放在那里。

## 如何构建它

为了构建这个文件，我运行：

```
gcc -framework IOKit -framework Cocoa beforesleep.c 
```

## 评论

如果您要使用此代码，请确保它始终在后台运行。例如，我有一个 Cron 作业，它确保此代码始终运行，并再次启动它，以防它因任何原因意外被杀死（尽管到目前为止它从未发生在我身上）。如果你有足够的经验，你可以找到更聪明的方法来确保这一点。

## 更多信息

有关其工作原理的更多详细信息，请参阅[此链接](https://developer.apple.com/library/archive/qa/qa1340/_index.html)（已由 sidyll 建议）。

## 代码模板

```
#include <ctype.h>
#include <stdlib.h>
#include <stdio.h>

#include <mach/mach_port.h>
#include <mach/mach_interface.h>
#include <mach/mach_init.h>

#include <IOKit/pwr_mgt/IOPMLib.h>
#include <IOKit/IOMessage.h>

io_connect_t  root_port; // a reference to the Root Power Domain IOService

void
MySleepCallBack( void * refCon, io_service_t service, natural_t messageType, void * messageArgument )
{
    switch ( messageType )
    {

        case kIOMessageCanSystemSleep:
            IOAllowPowerChange( root_port, (long)messageArgument );
            break;

        case kIOMessageSystemWillSleep:
            system("/Users/andrea/bin/mylogger.sh");
            system("osascript /Users/andrea/bin/pause_clockwork.scpt");

            IOAllowPowerChange( root_port, (long)messageArgument );
            break;

        case kIOMessageSystemWillPowerOn:
            //System has started the wake up process...
            break;

        case kIOMessageSystemHasPoweredOn:
            //System has finished waking up...
        break;

        default:
            break;

    }
}

int main( int argc, char **argv )
{

    // notification port allocated by IORegisterForSystemPower
    IONotificationPortRef  notifyPortRef;

    // notifier object, used to deregister later
    io_object_t            notifierObject;
   // this parameter is passed to the callback
    void*                  refCon;

    // register to receive system sleep notifications

    root_port = IORegisterForSystemPower( refCon, &notifyPortRef, MySleepCallBack, &notifierObject );
    if ( root_port == 0 )
    {
        printf("IORegisterForSystemPower failed\n");
        return 1;
    }

    // add the notification port to the application runloop
    CFRunLoopAddSource( CFRunLoopGetCurrent(),
            IONotificationPortGetRunLoopSource(notifyPortRef), kCFRunLoopCommonModes );

    /* Start the run loop to receive sleep notifications. Don't call CFRunLoopRun if this code
        is running on the main thread of a Cocoa or Carbon application. Cocoa and Carbon
        manage the main thread's run loop for you as part of their event handling
        mechanisms.
    */
    CFRunLoopRun();

    //Not reached, CFRunLoopRun doesn't return in this case.
    return (0);
} 
```

# regex - Perl从文件中读取时的多行匹配，逐行

> ID：13534171
> 
> 赞同：4
> 
> 时间：2012-11-23T18:25:29.880
> 
> 标签：regex, perl, lines

假设我打开一个这样的文件：

```
#!/usr/bin/perl

open FILE, "8882099";
while ($line = <FILE>) {
  if ($line =~ /accepted by(.*?)\./s) {
    print "accepted by: $1";
  }
} 
```

问题是正则表达式正在工作，但是由于文件是逐行读取的，我应该如何匹配这个继续到新行的字符串？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:04:32.593

一次读取整个文件通常是最简单的。

```
my $file;
{
   local $/;
   $file = <$fh>;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T21:41:28.513

首先，您必须*始终* 处于每个程序的顶部`use strict`。`use warnings`这样，您可能会忽略的简单错误将被指出给您。

其次，您应该使用词法文件名，即 的*三参数形式*，`open`并始终检查每个`open`调用的状态。

要解决您的问题，您应该简单地查找包含前缀的行`accepted by`，然后将行附加到您找到的字符串，直到您看到完整的字符串匹配。使用显式也`[^.]+`比非贪婪更好，`.*?`以避免回溯。

请注意，您应该恢复我已注释掉的打开文件，并删除对 的分配`$file`，因为我以这种方式编写程序是为了测试目的。

`accepted by`如果拆分为多行，此解决方案将出现问题。如果您期望这一点，那么必须编码一些稍微不同的东西。

```
use strict;
use warnings;

# open my $file, '<', '8882099' or die $!;
my $file = \*DATA;

my $line;
while ($line = <$file>) {

  if ($line =~ /accepted by/) {
    $line .= <$file> until $line =~ /accepted by\s*([^.]*)\./;
    print "accepted by: $1\n";
  }

}

__DATA__

    accepted by Tim.

    accepted by The
Financial
Director.
Today 
```

**输出**

```
accepted by: Tim
accepted by: The
Financial
Director 
```

# sql - 按 () 划分的 MAX 值

> ID：13534173
> 
> 赞同：0
> 
> 时间：2012-11-23T18:25:58.977
> 
> 标签：sql, oracle, plsql

我每月都有特定汽车品牌的销售额，并且每个月我都想要与销售额相关的最多 5 个汽车品牌。然后，在这些最大品牌旁边，我想要一个数字（如果有），表明这个特定品牌在前 4 个月中进入前五名的次数。

例如，如果表数据是：

```
Timestamp | Brand | Sales
1/1/2012  | A     | 23
1/1/2012  | B     | 45
1/1/2012  | C     | 11
1/1/2012  | D     | 3
1/1/2012  | E     | 55
1/1/2012  | F     | 1
1/1/2012  | G     | 22
---------------------------
1/2/2012  | A     | 93
1/2/2012  | B     | 35
1/2/2012  | C     | 01
1/2/2012  | D     | 100
1/2/2012  | E     | 45
1/2/2012  | F     | 77
1/2/2012  | G     | 12 
```

对于两个月的数据，2 月的查询输出（仅检查 2 月和 1 月）将是：

```
Max_ Brand_Sales| Reappearance_Factor
--------------------------------------
E               | 1
B               | 1
D               | 0
F               | 0
A               | 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T20:24:51.723

```
Select
  c.Brand,
  nvl(Count(p.Brand), 0) As Reappearance_Factor
From (
  Select
    Brand,
    Rank () Over (Order By Sales Desc) as r
  From
    Sales
  Where
    Timestamp = Date '2012-02-01'
  ) c
    left outer join (
  Select
    Brand,
    Rank () Over (Partition By Timestamp Order By Sales Desc) as r
  From
    Sales
  Where
    Timestamp >= Date '2011-10-01' And
    Timestamp < Date '2012-02-01'
  ) p
  on c.Brand = p.Brand And p.r <= 5
Where
  c.r <= 5
Group By
  c.Brand 
```

[http://sqlfiddle.com/#!4/46770/21](http://sqlfiddle.com/#!4/46770/21)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T23:38:29.943

试试这个：

1) 计算每个品牌每月排名的查询：

```
SELECT
  s.Brand,
  trunc(s.Timestamp,'MONTH') month_start,
  rank() OVER (PARTITION BY trunc(s.Timestamp,'MONTH') 
               ORDER BY s.Sales DESC) as monthly_rank
FROM Sales s; 
```

2）查询输出当月排名前5的品牌：

```
SELECT
 t.Brand
FROM
(
  SELECT
    s.Brand,
    trunc(s.Timestamp,'MONTH') month_start,
    rank() OVER (PARTITION BY trunc(s.Timestamp,'MONTH') 
                 ORDER BY s.Sales DESC) as monthly_rank
  FROM Sales s
) t
WHERE monthly_rank <= 5
  AND month_start = trunc(sysdate,'MONTH'); 
```

3）查询计算过去4个月的“再现”

```
SELECT
 t.Brand,
 count(*) as top
FROM
(
  SELECT
    s.Brand,
    trunc(s.Timestamp,'MONTH') month_start,
    rank() OVER (PARTITION BY trunc(s.Timestamp,'MONTH') 
                 ORDER BY s.Sales DESC) as monthly_rank
  FROM Sales s
) t
WHERE monthly_rank <= 5
  AND t.month_start BETWEEN add_months(sysdate, -1)
                        AND add_months(sysdate, -5)
GROUP BY t.Brand; 
```

4) 最后一件事 -`LEFT JOIN`查询 2 和 3

SQLFiddle在这里[http://sqlfiddle.com/#!4/46770/65](http://sqlfiddle.com/#!4/46770/65)

# c# - GeckoFX - 获取 GetHtmlElementById

> ID：13534174
> 
> 赞同：0
> 
> 时间：2012-11-23T18:25:59.050
> 
> 标签：c#, dom, geckofx

我已经为此苦苦挣扎了 5 个多小时了

例子：

```
 <div id='xx'>content</div> 
```

如何通过 GetHtmlElementById 或任何其他基于“Id”的解决方案访问该 div 的内容

我试过了

```
GeckoElement el = browser.Document.GetElementById("xx");
MessageBox.Show(el.TextContent); 
```

我得到 NullRefferenceException （对象引用未设置为对象的实例。）

其他示例：导航到 google.co.uk

```
browser.DocumentCompleted += delegate { 
                MessageBox.Show(browser.DomDocument.GetElementById("gbqfsa").TextContent);

            }; 
```

MessageBox 应该显示“Google 搜索”但没有运气

> System.NullReferenceException 未被用户代码处理
> Message=Object 引用未设置为对象的实例。
> Source=gecko fx StackTrace: at gecko_fx.Form1.b__2(Object , EventArgs) in C:\Users\drs\AppData\Local\Temporary Projects\gecko fx\Form1.cs:line 44 at Gecko.GeckoWebBrowser.OnDocumentCompleted(EventArgs e ) 在 C:\Users\hindlet\Documents\Visual Studio 2010\Projects\geckofx-15.0\Geckofx-Winforms\GeckoWebBrowser.Events.cs:Gecko.GeckoWebBrowser.Gecko.nsIWebProgressListener.OnStateChange(nsIWebProgress aWebProgress, nsIRequest aRequest, UInt32 aStateFlags, Int32 aStatus) 在 C:\Users\hindlet\Documents\Visual Studio 2010\Projects\geckofx-15.0\Geckofx-Winforms\GeckoWebBrowser.cs:line 1700 InnerException:

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-12T07:21:25.193

```
 GeckoHtmlElement ele;
            ele = geckoWebBrowser1.Document.GetHtmlElementById("myData");
            MessageBox.Show(ele.GetAttribute("Value")); 
```

这对我有用。

# html - HTML 文本页脚

> ID：13534180
> 
> 赞同：0
> 
> 时间：2012-11-23T18:26:34.797
> 
> 标签：html, css

> **可能重复：**
> [HTML 打印页眉和页脚](https://stackoverflow.com/questions/1360869/html-print-header-footer)

我怎样才能像 Microsoft Word 一样，在所有 html 页面的底部插入一个文本页脚。我有一个很长的 html 页面，因为它是一个表单，所以它是故意的。但是我怎么能像 Microsoft Word 那样在每一页的末尾插入一个文本页脚，这样如果我在 IE 中进入打印预览，我会在所有页面上看到文本页脚。甚至可能吗？

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:29:03.280

对和使用具有不同样式的 css`@media` [规则](http://www.w3.org/TR/CSS21/media.html#at-media-rule)。`print``screen`

一个例子是[here](https://stackoverflow.com/questions/1360869/html-print-header-footer)

# java - 以恒定成本将 kd-tree 中的数据保存在 Pre-order 中

> ID：13534181
> 
> 赞同：1
> 
> 时间：2012-11-23T18:26:51.987
> 
> 标签：java, kdtree

我在实现一个给定 kdtree 的方法时遇到了一点问题，该方法将所有预先订购的项目存储在堆栈中。

我迭代地实现了这个方法，我有这个代码：

```
public void preorder (Node <Pair <K,V>> node) throws SiguienteException {
     Stack <Pair <K,V>> stack = new Stack <Pair <K,V>> ();
     stack.stack (node.data ());
     while (! stack.isEmpty ()) {
     Pair <K,V> stack.getTop pair = ();
     stack.unstack ();
     if (pair! = null) {
     System.out.printf ("% s \ n", pair.getKey ());
     pila.apilar (node.getRigth (). data ());
     pila.apilar (node.getLeft (). data ());
     node.setDato (pair);

     }
     }

     } 
```

问题是，这种方法通过树的元素，不再具有恒定顺序，线性顺序，而是在最坏的情况下。

您能想出任何方法以恒定顺序将项目保存在堆栈中吗？

对不起，如果我解释得不好，我是西班牙人，我正在使用谷歌翻译 xD

# c# - How to change MasterPage's label from Content page without refreshing page

> ID：13534182
> 
> 赞同：1
> 
> 时间：2012-11-23T18:26:57.437
> 
> 标签：c#, asp.net, .net, updatepanel

I've got MasterPage and Content Page. On the ContentPage there is some label and i want to change it's text when clicked on button on the content page without refreshing the page.

**Default.aspx**

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" %>

<script runat="server">

    protected void ImageButton1_Click(object sender, ImageClickEventArgs e)
    {
        Label SensorTemperatureLabel = (Label)this.Master.FindControl("SensorTemperatureLabel");

        if (SensorTemperatureLabel != null)
        {
            SensorTemperatureLabel.Text = "TEST";
        }
    }
</script>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
           <asp:ImageButton ID="ImageButton1" runat="server" OnClick="ImageButton1_Click" />

</asp:Content> 
```

**MasterPage.master** Part of the code with label

```
<div class="sidebar">
        <!-- insert your sidebar items here -->
          <asp:UpdatePanel ID="UpdatePanel1" runat="server">
              <ContentTemplate>
                  <asp:Label ID="SensorTemperatureLabel" runat="server" Text="Label"></asp:Label>
              </ContentTemplate>
          </asp:UpdatePanel>
      </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:44:54.433

If the label is not in `<ContentTemplate />`, you can access with javascript

```
 var SensorTemperatureLabel = document.getElementById("<%=SensorTemperatureLabel%>");
 SensorTemperatureLabel.innerHTML = "newValue"; 
```

Otherwise, the ID is generated and you'll need

```
var SensorTemperatureLabel = document.getElementById("<%= this.Master.FindControl("SensorTemperatureLabel").ClientID %>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:52:30.857

I have prepared you complete solution to show you how you can do this.

First sample master. Take notice I have added ScriptManager to page and target label is inside content template:

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site1.master.cs" Inherits="WebTester.Site1" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <div>
        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
            <ContentTemplate>
                <asp:Label ID="SensorTemperatureLabel" runat="server" Text="TEMP"></asp:Label>
            </ContentTemplate>
        </asp:UpdatePanel>
        <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">
        </asp:ContentPlaceHolder>
    </div>
    </form>
</body>
</html> 
```

Now here is content page, button is also placed inside content template:

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site1.Master" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="WebTester.WebForm1" %>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Test" />
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Content> 
```

And finally here is the code, I get refrence to label by using FindControl:

```
protected void Button1_Click(object sender, EventArgs e)
{
    Site1 site = this.Master as Site1;
    if (site != null)
    {
        Label SensorTemperatureLabel = site.FindControl("SensorTemperatureLabel") as Label;
        SensorTemperatureLabel.Text = DateTime.Now.ToString();
    }
} 
```

This code will update label on master page without complete page postback.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-11T00:37:34.250

I hope my answer help in this case if you have Label in master page named " Label1" then you can change value there like this VB

```
Dim lb as label= me.master.findcontrol("Label1"):lb.text="Hello worold" 
```

Peace upon you all.

# database - CakePHP 插件和数据库设置

> ID：13534185
> 
> 赞同：0
> 
> 时间：2012-11-23T18:27:28.803
> 
> 标签：database, cakephp, plugins

使用 CakePHP，您可以创建看起来“半独立”工作的插件。

我想知道是否有任何方法可以为将映射插件模型的数据库模式创建设置文件/类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:36:42.860

为此，您需要使用 Cake shell 模式，或使用 CakeDC/Migrations 插件。

两者都将允许您生成一个模式文件，然后可以使用“cake schema run”运行该文件来为您的插件创建表。

参考，`cake schema generate`
[http://book.cakephp.org/2.0/en/console-and-shells/schema-management-and-migrations.html](http://book.cakephp.org/2.0/en/console-and-shells/schema-management-and-migrations.html)

参考，`cake migrations.migration generate`
[https://github.com/cakedc/migrations](https://github.com/cakedc/migrations)

# html - 为什么 Chrome 将这个 HTML 呈现为一个完全空白的页面？来自 Node.js，遵循 The Node Beginner Book

> ID：13534186
> 
> 赞同：0
> 
> 时间：2012-11-23T18:27:40.577
> 
> 标签：html, node.js, google-chrome

因此，我使用 Node.js 将以下 HTML 发送到了我的浏览器：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
    <form action="/upload" method="post">
        <textarea name="text" rows="20" cols="60"></textarea>
        <input type="submit" value="Submit text" />
    </form>
</body>
</html> 
```

但是浏览器显示的是一个完全白色的空白页面。然而，当我查看源代码时，我看到的正是您在上面看到的内容，我只是从 Chrome 的“查看源代码”实用程序中复制并粘贴了这些内容。为什么 Chrome 将该 HTML 呈现为空白页面？我在下面有一个截图。

这是我用来将 HTML 发送到浏览器的 Node.js 代码：

```
function start(response) {
    console.log("Request handler 'start' was called.");
    var body = '<!DOCTYPE html>\n'+
               '<html>\n'+
               '<head>\n'+
               '    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n'+
               '</head>\n'+
               '<body>\n'+
               '    <form action="/upload" method="post">\n'+
               '        <textarea name="text" rows="20" cols="60"></textarea>\n'+
               '        <input type="submit" value="Submit text" />\n'+
               '    </form>\n'+
               '</body>\n'+
               '</html>\n';

    response.writeHead(200, {"Content-Type": "text/html"});
    response.write(body);
    response.end();
} 
```

![空白页——尽管 Chrome 可以向我展示很好的 HTML...](../Images/3487adcf386ea3c10a9d4ebaf2dcc5ad.png)

====================================

这是作为对原始帖子的编辑所包含的答案，因为该主题已关闭（不幸的是，未回答的主题可以被海报以外的其他人关闭）。无论如何，以防万一原始发布者遵循此问题，我研究了这个问题，因为我遇到了完全相同的问题，没有人回答他的问题，我发现了解决方案：

我刚刚解决了将代码片段从 Kindle 书复制到您选择的文本/源代码编辑器的问题。在 stackoverflow.com 上的一篇题为“为什么 Chrome 将这个 HTML 呈现为一个完全空白的页面？来自 Node.js，遵循 Node Beginner Book [关闭]”的帖子中讨论了相同的主题。该特定帖子描述了我遇到的完全相同的问题（相同的 Kindle 书，相同的代码片段，相同的代码症状！）。不幸的是，在任何受访者能够提供确切答案之前，该帖子已过早关闭，否则我会回复该帖子。

然而，我更深入地研究了这个问题，并在从 Kindle 书籍复制代码片段时发现了问题的根本原因：当您从 Kindle 应用程序复制文本时，它使用十六进制代码 0xA0 来表示空格字符，而不是 0x20。十六进制代码 0xA0 是不间断空格的扩展 ASCII。好吧，当您期望复制和粘贴 HTML 文字字符串时，这不起作用，就像上述帖子中的情况一样。

因此，这解释了上述帖子中的行为：原始发布者表示他可以通过手动重新输入所有文本来解决问题。这是因为手动重新输入使用了正确的 0x20。

这还有其他一些我起初不理解但现在解释的症状：我的文本编辑器（Notepad++）没有正确识别我的源代码中的保留关键字。同样，这是因为关键字由 0xA0 分隔，而不是 0x20。Notepad++ 中的关键字解析器必须对 0x20 进行标记。

解决方案：从 Kindle 粘贴文本后，在源代码编辑器中使用正则表达式搜索功能执行搜索和替换。搜索正则表达式 \xA0 并将其替换为 \x20 （或者，根据您的编辑器，只需在“替换”字段中输入一个空格键字符 [这就是 Notepad++ 的工作方式]）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:15:08.343

[使用来自nodejs.org](http://nodejs.org/)的服务器示例代码，您的 html 在 Chrome 版本 23.0.1271.64 中运行良好：

```
var http = require('http');
http.createServer(function (req, res) {
  var body = '<!DOCTYPE html>\n'+
         '<html>\n'+
         '<head>\n'+
         '    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n'+
         '</head>\n'+
         '<body>\n'+
         '    <form action="/upload" method="post">\n'+
         '        <textarea name="text" rows="20" cols="60"></textarea>\n'+
         '        <input type="submit" value="Submit text" />\n'+
         '    </form>\n'+
         '</body>\n'+
         '</html>\n';
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write(body);
  res.end();
}).listen(3000, '127.0.0.1');
console.log('Server running at http://127.0.0.1:3000/'); 
```

正如遗产所说，它必须是别的东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T19:03:05.163

我敢打赌这是因为您没有设置内容长度标题 ( `Content-Length`)。我认为 Node.js 会自动执行此操作，但可能不会。

这是[过去的一个问题，](http://code.stephenmorley.org/php/google-chrome-blank-white-page-bug/)但我认为它已在 chrome 中修复。也许你有一个旧版本。

尝试：

```
response.writeHead(200, {"Content-Type": "text/html", "Content-Length" : body.length }); 
```

然后查看 Chrome 开发者工具网络选项卡，看看是否设置了标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:52:30.233

我使用自己的 node.js 服务器进行了测试，我认为扩展正在更改 html。尝试在其他浏览器中访问，并在 chrome 中以隐身模式访问。

# ruby - 来自 Ruby 中 Highrise API 的自定义字段/主题字段

> ID：13534197
> 
> 赞同：3
> 
> 时间：2012-11-23T18:29:08.240
> 
> 标签：ruby, highrise, 37-signals

我正在寻找一种方法来修改[自定义字段](https://github.com/37signals/highrise-api/blob/master/sections/data_reference.md#custom-fields)的值（`subject_fields`在 Highrise API 中调用有些令人困惑）。

[Ruby 包装器](https://github.com/37signals/highrise-api/blob/master/sections/data_reference.md#custom-fields)37signals建议[不支持](https://github.com/tapajos/highrise/issues/18)这些自定义字段。

我发现了一个最近更新的[叉子](https://github.com/numbata/highrise)，我已经能够开始工作了：

```
p = Highrise::Person.find_all_across_pages(:params => {:name => "John"}).last
print p.name # outputs, John Smith, which is what I want. 
```

我有一个名为“测量”的自定义字段。

这有效：

```
p.subject_data_hash # outputs {"measurements"=>"5 feet"} 
```

但是，当我尝试使用`p.field("Measurements")`（我也尝试过“测量”）仅访问此值时，我得到`<Highrise::SubjectData:0x007fb059b6be10>`了，其中没有一个[`@attributes`](https://github.com/numbata/highrise#highrise-custom-fields---read-and-write-called-subject_datas-in-the-highrise-api)包含我正在寻找的数据。

不用说，如果我无法访问这些值，我就无法修改它们。

如何使用 Highrise API 访问和修改 Ruby 中自定义字段的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:56:38.437

要获取值：

```
 p.field("measurements").value 
```

要设置值：

```
 p.set_field_value("measurements", "5 feet")
 p.save 
```

# android - 将 Android SDK 更新到 rev 21 和 Android Platform tools 更新到 rev 16 后的模拟器轮换问题

> ID：13534198
> 
> 赞同：1
> 
> 时间：2012-11-23T18:29:11.983
> 
> 标签：android, android-emulator, android-version

我已将我的 Android SDk 更新到 rev 21 和 SDK tools rev 到 16。我创建了一个新的 AVD 并启动了它。现在，当我旋转屏幕时，它会旋转，但实际活动不会相应旋转。它始终以纵向模式显示。

人像模式图像 ![在此处输入图像描述](../Images/21ca6df0daf9b838c47550e8c162b4a3.png)

横向模式图像： ![在此处输入图像描述](../Images/526eb7e671d399f4d16c9ac9b0840244.png)

AVD 图像： ![在此处输入图像描述](../Images/247d720518eb9269c88d0060fcaa9371.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:51:51.647

这不是一个普遍的问题，尽管对于特定的组合似乎肯定会发生。由于没有适用于所有意图和目的的 API 级别 11 设备，我建议尝试不同的 API 级别。我尝试了 4.0.3，它似乎表现得更好。

# android - 如何知道活动是否已经开始

> ID：13534203
> 
> 赞同：4
> 
> 时间：2012-11-23T18:29:29.130
> 
> 标签：android

我在一个应用程序中工作，我过滤屏幕是打开还是关闭，并在屏幕打开时启动一个活动，但有时它会启动活动但活动已经开始，我想问你是否有任何了解我的应用程序是否已启动活动的方法。

当我开始活动时，我添加了此代码

```
intent11.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:34:27.657

我认为您可以使用活动生命周期设置变量

```
class IAMActivity extends Activity {
    static boolean isStart = false;

  public void onStart() {
     super.onStart();
     isStart = true;
  } 
  public void onStop() {
     super.onStop();
     isStart = false;
   }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:34:33.460

这是您要查找的内容：

```
 class MyActivity extends Activity {
 static boolean alreadyLaunched = false;

  @Override
  public void onStart() {
     super.onStart();
     alreadyLaunched = true;
  } 

  @Override
  public void onStop() {
     super.onStop();
     alreadyLaunched = false;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T20:41:47.807

如果您想将活动限制在一个实例中，您可以将`launchMode`清单文件中的设置为`singleTask`或`singleInstance`，具体取决于您的要求。

```
<activity
     android:launchMode="singleTask"
     ...>
...
</activity> 
```

通过而不是`singleTask`传递新的意图。`onNewIntent()``onCreate()`

有关详细信息，请参阅[<activity> 。](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)

# hibernate - Hibernate - 如何通过编码动态设置惰性属性

> ID：13534205
> 
> 赞同：0
> 
> 时间：2012-11-23T18:29:44.447
> 
> 标签：hibernate

我在我的 hbm 映射文件中将惰性属性设置为“true”。但是我想通过代码动态更改“lazy=false”。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:33:02.723

您可以通过 HQL 或`FetchMode.JOIN`通过 Criteria API 使用连接，在这种情况下，您将一次性获得关联。请注意，如果您使用关联对象，则不会从二级缓存中获取相关对象。

另一种选择是`Hibernate.initialize()`或者只是调用`object.getAssociation()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T22:48:52.073

看`sessionFactory.getClassMetadata(YourClass.class)`。它具有访问每个字段的方法。

然而，更文明的方法是使用 HQL 或 Criteria 查询覆盖获取策略。另一种选择是修改您的元数据（具有`lazy="false"`）并重建会话工厂。它并不像看起来那么可怕。

# search - Twitterizer Hashtags 和 metions 搜索

> ID：13534206
> 
> 赞同：2
> 
> 时间：2012-11-23T18:29:45.847
> 
> 标签：search, twitter, twitterizer

我想在 twitterzer 中进行搜索，以获取所有带有特定主题标签的推文，其中提到了 twitter 上的特定用户。我使用了 .Search 方法，但它仅适用于一个查询词（提及或 Hashtag，但不能同时使用两者）。那可能吗？

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:35:03.353

Search 方法允许字符串作为输入，因此您不限于一个单词。

```
 TwitterResponse<TwitterSearchResultCollection> searchResults = TwitterSearch.Search("#thisis40 to:conanobrien"); 
```

如果您不确定查询的语法，可以使用Twitter 网站上的[高级搜索。](https://twitter.com/search-advanced)只需填写您的参数并复制查询。

![在此处输入图像描述](../Images/5f0c3f244411b1580aee4f199be7c6ba.png)

# recursion - python3递归动画

> ID：13534212
> 
> 赞同：1
> 
> 时间：2012-11-23T18:30:30.213
> 
> 标签：recursion, dictionary, python-3.x, quickdraw

![在此处输入图像描述](../Images/ccfa15dfa72130ecf2bf082c5ba42996.png)

我需要在 quickdraw 中为类似的动画制作动画，并被告知使用递归。我在轨道上遇到了困难，这是我用于轨道圆的代码，但我不知道如何使用递归来创建上面的图像。

```
import math

print("circle",400,300,50)

print("flush false")

centreX=400
centreY=300
radius=100
angle=math.pi/2

while True:
    print("color 0 0 0")
    print("clear")
    print("color 255 0 255")
    print("circle",centreX,centreY,radius)
    childX=math.sin(angle)*radius*1.5+centreX
    childY=math.cos(angle)*radius*1.5+centreY
    print("circle",childX,childY,radius/2)
    print("refresh")
    angle+=0.01 
```

数据文件如下所示：

```
RootObject: Sun

Object: Sun
Satellites: Mercury,Venus,Earth,Mars,Jupiter,Saturn,Uranus,Neptune,Ceres,Pluto,Haumea,Makemake,Eris
Radius: 20890260
Orbital Radius: 0

Object: Miranda
Orbital Radius: 5822550
Radius: 23500
Period: 1.413

Object: Ariel
Orbital Radius: 8595000
Radius: 60000
Period: 2.520379

Object: Umbriel
Orbital Radius: 11983500
Radius: 60000
Period: 4.144177

Object: Titania
Orbital Radius: 19575000
Radius: 75000
Period: 8.7058

Object: Oberon
Orbital Radius: 26235000
Radius: 75000
Period: 13.463

Object: Uranus
Orbital Radius: 453572956
Radius: 2555900
Period: 30799
Satellites: Puck,Miranda,Ariel,Umbriel,Titania,Oberon

Object: Neptune
Orbital Radius: 550000000
Radius: 2476400
Period: 60190
Satellites: Triton

Object: Triton
Orbital Radius: 40000000
Radius: 135300
Period: -5.8

Object: Mercury
Orbital Radius: 38001200
Period: 87.9691
Radius: 243900.7

Object: Venus
Orbital Radius: 57477000
Period: 224.698
Radius: 605100.8

Object: Earth
Orbital Radius: 77098290
Period: 365.256363004
Radius: 637100.0
Satellites: Moon

Object: Moon
Orbital Radius: 18128500
Radius: 173700.10
Period: 27.321582

Object: Mars
Orbital Radius: 106669000
Period: 686.971
Radius: 339600.2
Satellites: Phobos,Deimos

Object: Phobos
Orbital Radius: 3623500.6
Radius: 200000
Period: 0.31891023

Object: Deimos
Orbital Radius: 8346000
Period: 1.26244
Radius: 200000.2

Object: Jupiter
Orbital Radius: 210573600
Period: 4332.59
Radius: 7149200
Satellites: Io,Europa,Ganymede,Callisto

Object: Ceres
Orbital Radius: 130995855
Period: 1679.67
Radius: 48700

Object: Io
Orbital Radius: 22000000
Period: 1.7691377186
Radius: 182100.3

Object: Europa
Orbital Radius: 36486200
Period: 3.551181
Radius: 156000.8

Object: Ganymede
Orbital Radius: 47160000
Period: 7.15455296
Radius: 263400

Object: Callisto
Orbital Radius: 69700000
Period: 16.6890184
Radius: 241000

Object: Saturn
Orbital Radius: 353572956
Period: 10759.22
Radius: 6026800
Satellites: Mimas,Enceladus,Tethys,Dione,Rhea,Titan,Iapetus

Object: Mimas
Orbital Radius: 8433396
Radius: 20600
Period: 0.9

Object: Enceladus
Orbital Radius: 10706000
Radius: 25000
Period: 1.4

Object: Tethys
Orbital Radius: 13706000
Radius: 50000
Period: 1.9

Object: Dione
Orbital Radius: 17106000
Radius: 56000
Period: 2.7

Object: Rhea
Orbital Radius: 24000000
Radius: 75000
Period: 4.5

Object: Titan
Orbital Radius: 50706000
Radius: 257600
Period: 15.945

Object: Iapetus
Radius: 75000
Orbital Radius: 72285891
Period: 79 
```

我应该将数据导入递归函数以创建轨道和动画，但我不知道如何。我几乎尝试了所有方法，这非常令人沮丧。

这段代码会起作用吗？

```
print("flush false")
scale=250/max([dict[x]["Orbital Radius"] for x in dict if "Orbital Radius" in dict[x]])
t=0
x=400
y=300
while True:
    print("refresh")
    print("colour 0 0 0")
    print("clear")
    print("colour 255 255 255")
    print("fillcircle",x,y,dict['Sun']['Radius']*scale)
    print("text ", "\"Sun\"",x+dict['Sun']['Radius']*scale,y)
    r_earth=dict['Earth']['Orbital Radius']*scale;
    print("circle",x,y,r_earth)
    r_X=x+math.sin(t*2*math.pi/dict['Earth']['Period'])*r_earth
    r_Y=y+math.cos(t*2*math.pi/dict['Earth']['Period'])*r_earth
    print("fillcircle",r_X,r_Y,dict['Earth']['Radius']*scale)
    print("text ", "\"Earth\"",r_X+dict['Earth']['Radius']*scale,r_Y)
    t+=0.02 
```

# parsing - ANTLR 在词法分析/解析中包含元数据的最佳方式（自定义对象、注释类型）

> ID：13534218
> 
> 赞同：3
> 
> 时间：2012-11-23T18:31:06.093
> 
> 标签：parsing, metadata, antlr3, lexical-analysis

我计划在解析过程中包含文本元数据（如*粗体*、*字体大小*等）以实现更好的识别。

例如，我有一个给定的结构，其中单独一行的单词`word/r/n`是*粗体*且大小为*24px*，是某篇文章的标题。为了获得更好的识别结果，我想考虑字符以及元数据。就 ANTRL 而言，我不确定如何才能做到最好。我想做类似的事情：

1.  将原始文本的每个字符包装到带有元数据字段的自定义对象中，并将其传递给 ANTLR。
2.  预处理文本并在特定位置插入语法专家考虑的元数据注释。

我真的很喜欢选择选项**1。**但我不确定我需要从 ANTLR 中的哪个部分进行子类化等。*我*`ANTLRInputStream-Object`是否*必须*从*解析器*等。有没有更优雅的方式，尤其是在使用块中的动作解析时查询令牌？***`{}`***

 ***如果有人有一些提示和/或经验，那就太好了！

编辑：

这是一个更具体的简单示例：我有一个文件，其中包含我正手解析的元数据的编码。*包含换行符*的实际文本如下所示：

```
entryOne
Here is some content one.
entryTwo
Here is some content two. 
```

其中标题`entryOne`和`entryTwo`最初*的字体大小*为 24 像素，内容的*字体大小*为 12 像素（作为示例性给定值）。Char by char 我创建了一个自定义对象的新实例，将字符封装为*String*和*font-size*。

我用字体大小的字段为每个字符初始化各自的对象，例如，对于内容的第一个字母，`entryOne`就像 `MyChar aTitelChar = new MyChar("e", 24);` 第二行一样，`Here is some content one.`我创建 MyChar 的实例，例如：

`MyChar aContentChar= new MyChar("H", 12);`

文本的所有字符都包含在下面的实例中`MyChar`-*类*并添加到 a`List<MyChar>`以便为 ANTLR 生成新输入。

下面是字符的 Java 类：

```
public class MyChar {
    private int fontSizePx;
    private String text;

    public MyChar(String text, int fontSizePx) {
        this.text = text;
        this.fontSizePx = fontSizePx;
    }

    public int getFontSizePx() {
        return fontSizePx;
    }

    public String getText() {
        return text;
    }
} 
```

我希望我的语法与上述两个条目相匹配（或以这种方式进行更多格式化），这两个条目又由一个标题和一个以句号结尾的内容组成。该语法可能如下所示：

```
rule: entry+ NEWLINE
;
entry:
title
content
;   
title: 
letters NEWLINE
;
content:
(letters)+ '.' NEWLINE
;
letters:
LETTERS 
;
LETTERS:
('a'..'z' | 'A'..'Z')+
;
WS:
(' ' | '\t' | 'f' ) + {$channel = HIDDEN;};
NEWLINE:'\r'? '\n'; 
```

现在，例如，我想做的是通过在-rule 返回之前检查包含*标题标记*的所有字母的*字体大小*来确定它是否真的是条目的*标题。*如果输入符合语法但实际上是某种错误（原始元数据编码的文件以符合-rule 但实际上是内容的内容开头），语法的作者可以在他知道的情况下对其进行排序标题的原始*字体大小*为 24 并检查。如果其中一个字母*标记*不等于*font-size* 24，则抛出异常/不返回/执行 smthg。合适的。**`titel``title`**

 ***我正在考虑的事情是在哪里插入`List<MyChar>`以提供此功能（在 ANTLR 的上下文中解析时查询各种元数据）。我正在尝试使用 ANTLR 的类，但由于我是 ANTLR 的新手，我想可能一些有经验的用户可以为我指出正确的方向，比如哪里是自定义对象的好插入点？我应该从实施`CharStream`和覆盖一些方法开始吗？可能有一些我还没有找到的 ANTLR 提供的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T00:53:13.657

这是完成我认为您要实现的目标的一种方法，它使用解析器来管理与元数据的匹配输入。请注意，我使空格很重要，因为它是内容的一部分并且不能被跳过。我还将句点作为内容的一部分来简化示例，而不是将它们用作标记。

**系统Ex.g**

```
grammar SysEx;

@header {
    import java.util.List;
}

@parser::members {
        private List<MyChar> metadata;
        private int curpos;

        private boolean isTitleInput(String input) {
            return isFontSizeInput(input, 24);
        }

        private boolean isContentInput(String input){
            return isFontSizeInput(input, 12);
        }

        private boolean isFontSizeInput(String input, int fontSize){
            List<MyChar> sublist = metadata.subList(curpos, curpos + input.length());

            System.out.println(String.format("Testing metadata for input=\%s, font-size=\%d", input, fontSize));

            int start = curpos;            
            //move our metadata pointer forward.
            skipInput(input);

            for (int i = 0, count = input.length(); i < count; ++i){
                MyChar chardata = sublist.get(i);
                char c = input.charAt(i);
                if (chardata.getText().charAt(0) != c){
                    //This character doesn't match the metadata (ERROR!)
                    System.out.println(String.format("Content mismatch at metadata position \%d: metadata=(\%s,\%d); input=\%c", start + i, chardata.getText(), chardata.getFontSizePx(), c));
                    return false;
                } else if (chardata.getFontSizePx() != fontSize){
                    //The font is wrong.
                    System.out.println(String.format("Format mismatch at metadata position \%d: metadata=(\%s,\%d); input=\%c", start + i, chardata.getText(), chardata.getFontSizePx(), c));
                    return false;
                }
            }

            //All characters check out.
            return true;
        }

        private void skipInput(String str){
            curpos += str.length();
            System.out.println("\t\tMoving metadata pointer ahead by " + str.length() + " to " + curpos);
        }
}

rule[List<MyChar> metadata]
    @init {
        this.metadata = metadata;
    }
    : entry+ EOF
    ;
entry
    : title content
    {System.out.println("Finished reading entry.");}
    ;   
title
    : line {isTitleInput($line.text)}? newline {System.out.println("Finished reading title " + $line.text);}
    ;
content
    : line {isContentInput($line.text)}? newline {System.out.println("Finished reading content " + $line.text);}
    ;
newline
    : (NEWLINE{skipInput($NEWLINE.text);})+
    ;
line returns [String text]
    @init { 
        StringBuilder builder = new StringBuilder();
    }
    @after {
        $text = builder.toString();
    }
    : (ANY{builder.append($ANY.text);})+ 
    ;

NEWLINE:'\r'? '\n';
ANY: .; //whitespace can't be skipped because it's content. 
```

A`title`是`line`与标题元数据（24 号字体）后跟一个或多个换行符的匹配项。

A`content`是`line`匹配内容元数据（12 号字体）后跟一个或多个换行符的 a。如上所述，为了简化，我删除了一段时间的检查。

A`line`是不包括换行符的字符序列。

[验证语义谓词](https://stackoverflow.com/a/3056517/1201210)（`{...}?`after ）用于`line`验证该行是否与元数据匹配。

这是我用来测试语法的代码（为简洁起见，减去导入）：

**SysExGrammar.java**

```
public class SysExGrammar {
    public static void main(String[] args) throws Exception {
        //Create some metadata that matches our input.
        List<MyChar> matchingMetadata = new ArrayList<MyChar>();
        appendMetadata(matchingMetadata, "entryOne\r\n", 24);
        appendMetadata(matchingMetadata, "Here is some content one.\r\n", 12);
        appendMetadata(matchingMetadata, "entryTwo\r\n", 24);
        appendMetadata(matchingMetadata, "Here is some content two.\r\n", 12);

        parseInput(matchingMetadata);

        System.out.println("Finished example #1");

        //Create some metadata that doesn't match our input (negative test).
        List<MyChar> mismatchingMetadata = new ArrayList<MyChar>();
        appendMetadata(mismatchingMetadata, "entryOne\r\n", 24);
        appendMetadata(mismatchingMetadata, "Here is some content one.\r\n", 12);
        appendMetadata(mismatchingMetadata, "entryTwo\r\n", 12); //content font size!
        appendMetadata(mismatchingMetadata, "Here is some content two.\r\n", 12);

        parseInput(mismatchingMetadata);

        System.out.println("Finished example #2");
    }

    private static void parseInput(List<MyChar> metadata) throws Exception {
        //Test setup
        InputStream resource = SysExGrammar.class.getResourceAsStream("SysExTest.txt");

        CharStream input = new ANTLRInputStream(resource);

        resource.close();

        SysExLexer lexer = new SysExLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);

        SysExParser parser = new SysExParser(tokens);
        parser.rule(metadata);

        System.out.println("Parsing encountered " + parser.getNumberOfSyntaxErrors() + " syntax errors");
    }

    private static void appendMetadata(List<MyChar> metadata, String string,
            int fontSize) {

        for (int i = 0, count = string.length(); i < count; ++i){
            metadata.add(new MyChar(string.charAt(i) + "", fontSize));
        }
    }
} 
```

**SysExTest.txt**（注意这使用 Windows 换行符 ( `\r\n`)

```
entryOne
Here is some content one.
entryTwo
Here is some content two. 
```

**测试输出**（修剪；第二个示例有故意不匹配的元数据）：

```
Parsing encountered 0 syntax errors
Finished example #1
Parsing encountered 2 syntax errors
Finished example #2 
```

此解决方案要求每个`MyChar`对应于输入中的一个字符（包括换行符，尽管您可以根据需要删除该限制——如果我还没有写下这个答案，我会删除它；））。

如您所见，可以将元数据绑定到解析器，并且一切都按预期工作。我希望这有帮助。******

# html - 使用 CSS 在图像上显示图像：位置标签查询

> ID：13534233
> 
> 赞同：8
> 
> 时间：2012-11-23T18:32:35.020
> 
> 标签：html, css

我创建了一个代码来在图像上显示图像。继承人的代码：

```
<style type="text/css"> 
.imgA1 { position:absolute; top: 0px; left: 0px; z-index: 1; } 
.imgB1 { position:absolute; top: 70px; left: 100px; z-index: 3; } 
</style>

<img class="imgA1" src="image1.png">
<img class="imgB1" src="image2.png"> 
```

现在我在一篇文章中将此添加到我的博客网站。图像似乎与屏幕一起定位。这些图像一个接一个地出现，但即使在我想让它们出现的位置添加了代码之后，它们也位于屏幕的最左角。我想让它们出现在我帖子中的一些文本下方。我认为位置标签的“绝对”值存在一些问题。但我不知道如何克服这一点。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-23T18:34:43.690

将它们嵌套在一个`relative`元素中：

```
<style type="text/css"> 
.container { position:relative; }
.imgA1 { position:absolute; top: 0px; left: 0px; z-index: 1; } 
.imgB1 { position:absolute; top: 70px; left: 100px; z-index: 3; } 
</style>

<div class="container">
<img class="imgA1" src="image1.png">
<img class="imgB1" src="image2.png">
</div> 
```

[http://jsfiddle.net/nUPsh/1/](http://jsfiddle.net/nUPsh/1/)

* * *

这篇文章`position`很好地解释了 CSS 属性：

[http://css-tricks.com/absolute-positioning-inside-relative-positioning/](http://css-tricks.com/absolute-positioning-inside-relative-positioning/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-31T14:07:51.910

使用一个图像作为 span 的背景可以使其具有响应性。因为它不依赖于首先对容器盒进行成像。

```
<style type="text/css"> 
.container { position:relative; }
.imgB1{
position: absolute;
top: 0;
left: 0;
width: 78px;
height: 78px;
overflow: hidden;
text-indent: -999px;
 background: url(../images/imgB1.png) no-repeat;
}
</style>

<div class="container">
<img src="image1.png">
<span class="imgB1">Sale</span>
</div> 
```

# javascript - 将文本和图像组合成一个“实体”

> ID：13534236
> 
> 赞同：3
> 
> 时间：2012-11-23T18:32:40.727
> 
> 标签：javascript, html, dojo, rich-text-editor

在使用富文本编辑器（特别是 Dojo Editor dijit）时，我需要一些帮助，但这个问题应该适用于所有 RTE。

我正在寻找一种方法（通过 HTML/JS/等，无论在文本编辑器中如何工作）来组合一些文本和图像，以便它们可以作为一个实体进行操作。因此，我应该能够，例如，选择整个实体，并将其剪切/粘贴到文本框中的其他位置，或者通过单次按键将其删除等。

我不确定文本编辑器支持和不支持哪些功能，但是否有一个相当于容器/包装器/文本框的功能，它将文本和图像组合成一个单一的实体？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-24T19:35:04.843

首先保存图像，然后使用照片编辑软件或艺术字或 Microsoft PowerPoint 在图像上添加文本。（您可以尝试任何方法。）然后将图像与文本再次保存。然后，您可以将图像和文本整体用作一个实体。但问题是您无法在网页上动态更改文本。它会变成静态的。

# java - 带有 JDBC 的小程序 - java.security.AccessControlException：访问被拒绝

> ID：13534237
> 
> 赞同：1
> 
> 时间：2012-11-23T18:32:44.290
> 
> 标签：java, security, jdbc, applet

```
//JDBC using Applet
/*
<applet code = JDBC1 height = 170 width = 350 >
</applet>
*/

import javax.swing.*; //JApplet,JLabel,JButton

import java.applet.*; //Applet
import java.awt.*; //Layout

import java.awt.event.*; //Events

import java.sql.*; //JDBC

public class JDBC1 extends Applet implements Runnable,ActionListener
{
JFrame frame ;
JPanel panel1;
JLabel lblNo,lblName,lblBdate ;
JTextField txtNo,txtName,txtBdate;
JButton btn;

Statement st1;
Connection cn;
ResultSet rs;

    public JDBC1()
    {
        try
        {
            panel1 = new JPanel ();
            panel1.setLayout(new GridLayout(0,2));

            lblNo = new JLabel ("Roll No : ");
            panel1.add(lblNo);

            txtNo = new JTextField(15);
            panel1.add(txtNo);

            lblName = new JLabel ("Name : ");
            panel1.add(lblName);

            txtName = new JTextField(15);
            panel1.add(txtName);

            lblBdate = new JLabel ("Birth Date : ");
            panel1.add(lblBdate);

            txtBdate = new JTextField(15);
            panel1.add(txtBdate); //Add textarea to the panel.

            add(panel1); //Add panel to the aaplet.

            btn = new JButton ("First");
            add(btn); //Add button to the applet.
            btn.addActionListener(this);

            btn = new JButton ("Next");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Last");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Prev");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Save");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Reset");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Delete");
            add(btn);
            btn.addActionListener(this);

            btn = new JButton ("Update");
            add(btn);
            btn.addActionListener(this);

            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver"); //Load the JDBC-ODBC bridge driver
            cn = DriverManager.getConnection("jdbc:odbc:STUDENT_MYDSN"); // conection to databse

            st1 = cn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);

            String query = "select * from Student";
            rs = st1.executeQuery(query);

        }

        catch (Exception e)
        {
            e.printStackTrace();
        }
    }

    public void init()
    {
        try
        {
            Thread th = new Thread (this);
            th.start(); 
        }
        catch(Exception ex)
        {
            System.out.println(ex.toString());
        }
    }

    public void run ()
    {
        try
        {

            while(true)
            {
                JDBC1 my = new JDBC1();
                repaint();
                Thread.sleep(1000);
            }
        }
        catch(Exception ex)
        {
            System.out.println(ex.toString());
        }
    }

    public void paint (Graphics g)
    {
        super.paint(g);
        java.util.Date dt = new java.util.Date();
        String myDate = dt+"";
        g.drawString(myDate,100,150);
    }

    void getRecord()
    {
        try
        {
            txtNo.setText((String) rs.getObject(1));
        }

        catch (Exception e)
        {
            System.out.println(e.toString());
        }
    }

    public void actionPerformed(ActionEvent e)
    {
        try
        {
            String name = ((JButton) e.getSource()).getText();

            if (name == "First")
            {

                System.out.println("First");
            }

            if (name == "Prev")
            {
                System.out.println("Prev");
            }

            if (name == "Next")
            {
                System.out.println("Next");
            }

            if (name == "Last")
            {
                System.out.println("First");
            }

            if (name == "Save")
            {
                System.out.println("First");
            }

            if (name == "Delete")
            {
                System.out.println("First");
            }

            if (name == "Update")
            {
                System.out.println("First");
            }

            if (name == "Reset")
            {
                System.out.println("First");
            }
        }

        catch (Exception ex)
        {
            System.out.println(ex.toString());
            ex.printStackTrace();
        }
    }

} 
```

通过将此 Applet 与 JDBC 一起使用，我将遇到以下错误

```
java.security.AccessControlException: access denied ("java.util.PropertyPermission" "file.encoding"
            at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
            at java.security.AccessController.checkPermission(AccessController.java:560)
            at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
            at java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1302)
            at java.lang.System.getProperty(System.java:706)
            at sun.jdbc.odbc.JdbcOdbcConnection.initialize(JdbcOdbcConnection.java:142)
            at sun.jdbc.odbc.JdbcOdbcDriver.connect(JdbcOdbcDriver.java:174)
            at java.sql.DriverManager.getConnection(DriverManager.java:579)
            at java.sql.DriverManager.getConnection(DriverManager.java:243)
            at JDBC1.<init>(JDBC1.java:87)
            at JDBC1.run(JDBC1.java:123)
            at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:54:17.827

如果不采取措施为小程序授予适当的权限，您将无法在小程序中运行 JDBC。Oracle的[本教程](http://www.oracle.com/technetwork/java/dba-140353.html#applet)详细介绍了该主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T14:42:28.227

您将无法从（不受信任的）小程序访问 ODBC 驱动程序，就像您无法读取本地文件系统一样。

有只需要套接字权限的“纯 Java”JDBC 驱动程序。如果数据库服务器可通过与交付小程序的 Web 服务器相同的来源（“相同来源策略”）获得（并且网络上没有任何干扰），则这将起作用。

但是，通过网络向最终用户公开数据库可能是个坏主意。通常，您会通过 Web 服务器公开安全接口。此外，如果小程序是通过网络加载的，您不太可能想要选择本地配置的数据库。

（与表达问题的最小完整程序相比，问题中的代码似乎非常长，但我可以继续批评代码。）

# c# - 定期打印形状

> ID：13534238
> 
> 赞同：1
> 
> 时间：2012-11-23T18:32:58.687
> 
> 标签：c#, wpf

我正在使用 WPF 和 C# 制作应用程序。我想做的是在我按下按钮时在画布上打印很多形状，中间有一段时间。在我按下按钮的那一刻，一切都立即弹出。我试图在每次“打印”之间让线程休眠一段时间，但这无济于事，只是需要更长的时间才能让所有东西立即飞溅。我想要实现的是形状一次弹出一个，让我们说之间有 0.5 秒。代码如下：

```
 private void Create_Click(object sender, RoutedEventArgs e)
   {
        Random random = new Random();
        for (int i = 0; i < 50; i++)
        {
            Thread.Sleep(500);
            Path f = FlowerFactory.createFlower(FlowerBP, true);
            Canvas.SetLeft(f, random.Next(0, 1650));
            Canvas.SetTop(f, random.Next(0,1000));
            DrawBoard.Children.Add(f);
        }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T18:44:14.540

首先，您需要在后台线程中运行循环，这样它就不会阻止 UI 更新；其次，将 UI 渲染任务发送回 UI 线程。第一个，你可以使用`Task.Factory.StartNew`，第二个，使用`Dispatcher.Invoke`：

```
Random random = new Random();
Task.Factory.StartNew(() =>
{
    for (int i = 0; i < 50; i++)
    {
        Thread.Sleep(500);
        Dispatcher.Invoke(DispatcherPriority.Render, new Action(() =>
        {
            Path f = FlowerFactory.createFlower(FlowerBP, true);
            Canvas.SetLeft(f, random.Next(0, 1650));
            Canvas.SetTop(f, random.Next(0,1000));
            DrawBoard.Children.Add(f);
        }));
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:48:23.513

让负责 GUI 的主线程休眠是一个糟糕的决定。

尝试使用[DispatchTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)。例如：

```
DispatcherTimer m_dispatcherTimer = new DispatcherTimer();
int m_count = 50;

private void Init()
{
    m_dispatcherTimer.Tick += new EventHandler(OnTick);
    m_dispatcherTimer.Interval = new TimeSpan(0, 0, 1);
}

private void Create_Click(object sender, RoutedEventArgs e)
{
    m_count = 50;
    m_dispatcherTimer.Start();
}

private void OnTick(object sender, EventArgs e)
{
    // Draw your shapes here

    if(0>=--m_count)
    {
        m_dispatcherTimer.Stop();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:51:05.393

```
using System.Reactive.Concurrency;
using System.Reactive.Linq;
...
var subscription = Observable.Interval(TimeSpan.FromSeconds(0.5)).Take(50).Subscribe(x=>CreateRandomFlower); 
```

# c# - 使用 interop 和 c# 计算 Excel 电子表格工作表中包含数据的行数

> ID：13534241
> 
> 赞同：2
> 
> 时间：2012-11-23T18:33:08.597
> 
> 标签：c#, excel, com-interop

我刚刚编写了必须被视为完全可怕的代码来计算包含给定目录中所有电子表格中称为“数据”的工作表中的数据的行。这是代码

```
 private const string _ExcelLogDirectoryPath = @"..\..\..\..\Model\ExcelLogs\";
    static void Main()
    {
        var excelLogPaths = Directory.GetFiles(_ExcelLogDirectoryPath, "*.xl*");
        var excel = new Microsoft.Office.Interop.Excel.Application();
        var excelRowCounts = new Dictionary<string, int>();
        foreach (var filePath in excelLogPaths)
        {
            var spreadsheet = excel.Workbooks.Open(Path.GetDirectoryName(System.Windows.Forms.Application.ExecutablePath) + "/" + filePath);
            var worksheet = spreadsheet.Sheets["Data"] as Worksheet;
            if (worksheet != null)
            {
                // var rowCount = UsedRange.Rows.Count - 1; DOES NOT WORK, THE number is bigger than the 'real' answer
                var rowCount = 0;
                for (var i = 1 ; i < 1000000000; i++)
                {
                    var cell = worksheet.Cells[i, 1].Value2; // "Value2", great name for a property, thanks guys
                    if (cell != null && cell.ToString() != "") // Very fragile (e.g. skipped rows will break this)
                    {
                        rowCount++;
                    }
                    else
                    {
                        break;
                    }
                }
                var name = spreadsheet.Name.Substring(spreadsheet.Name.IndexOf('p'), spreadsheet.Name.IndexOf('.') - spreadsheet.Name.IndexOf('p'));
                excelRowCounts.Add(name, rowCount - 1);
            }
        } 
```

我不敢相信这是做到这一点的正确方法。它非常慢，并且包括对具有类似名称的属性的调用，`Value2`感觉不像是公共 API 的预期部分。但是在[其他地方建议](https://stackoverflow.com/a/356478/575530)的方法大大超过了报告行数（其中包含数据）。

正确的是从 Excel 工作表中计算包含数据的行？

========== 编辑 1 ==========

两者`UsedRange.Rows.Count`和[Sid 的 ACE.OLEDB 解决方案](https://stackoverflow.com/a/13534642/575530)都过度报告行数的原因似乎是粉红色背景颜色应用于某些列（但仅扩展到第 7091 行）。无论显示颜色如何，是否有一种简单/优雅的方法来计算其中包含数据的行（即具有非空单元格值）？

========== 编辑 2 ===========

[Sid 的 ACE.OLEDB 解决方案](https://stackoverflow.com/a/13534642/575530)以及[他建议的附加](https://stackoverflow.com/questions/13534241/use-interop-and-c-sharp-to-count-the-rows-in-an-excel-spreadsheets-worksheet-wi/13534642#comment18592298_13534642)内容，以便 tSQL 行读取

```
var sql = "SELECT COUNT (*) FROM [" + sheetName + "$] WHERE NOT F1 IS NULL"; 
```

作品。我会将其标记为答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:10:06.970

这应该可以解决问题。您可以使用每个文件名调用它来检索行数。

```
private string GetNumberOfRows(string filename, string sheetName)
{
    string connectionString;
    string count = "";

    if (filename.EndsWith(".xlsx"))
    {
        connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filename + ";Mode=ReadWrite;Extended Properties=\"Excel 12.0;HDR=NO\"";
    }
    else if (filename.EndsWith(".xls"))
    {
        connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + filename + ";Mode=ReadWrite;Extended Properties=\"Excel 8.0;HDR=NO;\"";
    }

    string SQL = "SELECT COUNT (*) FROM [" + sheetName + "$]";

    using (OleDbConnection conn = new OleDbConnection(connectionString))
    {
        conn.Open();

        using (OleDbCommand cmd = new OleDbCommand(SQL, conn))
        {
            using (OleDbDataReader reader = cmd.ExecuteReader())
            {
                reader.Read();
                count = reader[0].ToString();
            }
        }

        conn.Close();
    }

    return count;
} 
```

可能有一种更快的方法来检索行数，但我知道这是可行的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-23T19:29:44.263

如果您使用互操作，为什么不使用 UsedRange？

```
_Worksheet.UsedRange.Rows.Count 
```

# iphone - 主队列崩溃时的 UIAlertView。

> ID：13534243
> 
> 赞同：2
> 
> 时间：2012-11-23T18:33:35.050
> 
> 标签：iphone, objective-c, ios6, uialertview, exc-bad-access

我`UIAlertView`在主线程上显示 a 时遇到问题。我不知道为什么，但它一直在崩溃，尽管我在主线程上运行。以下块在后台线程上，但我在主线程上有如下警报：

```
void (^removeFromCalendar)(NSString *, NSString *, EKEventStore *) = ^(NSString *error, NSString *eventKey, EKEventStore *eventDB) {
    EKEvent *myEvent = [eventDB eventWithIdentifier:eventKey];
    NSError *err = noErr;

    if(myEvent != NULL && myEvent != (id)[NSNull null]) {
        [eventDB removeEvent:myEvent span:EKSpanThisEvent error:&err];
    } else {

        // Event was not found, nothing to do
        return;
    }

    [eventDB release];

    if (!err || err == noErr) {
        NSLog(@"Deleted event %@", myEvent.title);

        // Show alert on the main thread
        dispatch_async(dispatch_get_main_queue(), ^{
            // Showing the alert for unattending
            NSString *resultString = @"This event was removed from your calendar.";
            UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"Info" message:resultString delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil] autorelease];
            [alert show];
        });

        return;
    }

    error = err.description;
}; 
```

如果我注释掉显示警报的底部，一切都很好。但是对于警报，我不断收到`EXC_BAD_ACCESS`错误消息。有人可以解释为什么吗？它在正确的线程上，我一生都无法理解内存问题可能来自哪里！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:50:05.117

完成后，您的视图可能会被释放，直到您完成后台队列。所以，为了安全，你为什么不这样使用它；

```
...........
  UIViewController __weak *myController = self;
 dispathch_async(backgroundQueue, ^{ 
   UIViewController __strong *myStrongController = myController;
 ...............
 dispatch_async(dispatch_get_main_queue(), ^{
            if(myStrongController){
            // Showing the alert for unattending
            NSString *resultString = @"This event was removed from your calendar.";
            UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"Info" message:resultString delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil] autorelease];
            [alert show];
            }
        });
}). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:21:04.167

这是您呈现警报视图的方式：

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"<#(NSString *)#>" message:@"<#(NSString *)#>" delegate:self cancelButtonTitle:@"<#(NSString *)#>" otherButtonTitles:nil];
    [alert show];
    [alert release]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T04:21:10.610

为什么不使用目标 C 调用，而不是使用 dispatch_async：

```
[self performSelectorOnMainThread 
```

您可能必须将其打包到自己的方法中。或者，使用以下方法调用它：

```
[self performSelector:@selector(myAlertMethod) withObject:nil afterDelay:0.25] 
```

从第一天开始，这些方法就已经被尝试过并且是正确的。

# java - 将空列表添加到地图

> ID：13534244
> 
> 赞同：2
> 
> 时间：2012-11-23T18:33:39.950
> 
> 标签：java

我在以下代码中得到 NullPointerException ：

```
private Map<String,List<Entry>> Days;
private void intializeDays() {
    //Iterate over the DayOfWeek enum and put the keys in Map
    for(DayOfWeek dw : EnumSet.range(DayOfWeek.MONDAY,DayOfWeek.SUNDAY)){
    List<Entry> entries = null;
    Days.put(dw.toString().toLowerCase(),entries);
    }
} 
```

我认为是因为

```
List<Entry> entries = null; 
```

但是如何创建一个空列表并将其添加到地图中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T18:35:44.850

您必须初始化地图：

```
private Map<String,List<Entry>> Days = new HashMap<>(); 
```

请注意，您可以使用

```
List<Entry> entries = new ArrayList <Entry> (); 
```

并添加到地图中，而不是添加空值。

关于**[NullPointerException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/NullPointerException.html)**

当应用程序在需要对象的情况下尝试使用 null 时引发。这些包括：

```
Calling the instance method of a null object.
Accessing or modifying the field of a null object.
Taking the length of null as if it were an array.
Accessing or modifying the slots of null as if it were an array.
Throwing null as if it were a Throwable value.
Applications should throw instances of this class to indicate other illegal uses of the null object. 
```

由于您在执行此操作时没有初始化 Map 对象：

```
Days.put(dw.toString().toLowerCase(),entries); 
```

你得到 NullPointerException 因为你正在“访问或修改空对象的字段。”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T18:37:11.717

```
private Map<String,List<Entry>> Days; 
```

`Days`未初始化。将其更改为

```
private Map<String,List<Entry>> Days = new HashMap<>(); 
```

或以另一种方式初始化它。

正如[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)所述，`null`键和值允许在`HashMap`

另请注意，在您的代码中没有空列表，根本没有列表。

# javascript - js字符串替换不起作用

> ID：13534246
> 
> 赞同：2
> 
> 时间：2012-11-23T18:34:13.223
> 
> 标签：javascript, regex, replace

我正在尝试用空白替换 ',",\ 字符。

我使用以下代码

```
jQuery.get('/path to file/file.txt',function(data){
  data = data.replace(/\'\"\\/g," ");
  alert(data);
}) 
```

但没有任何取代。

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:35:57.417

您的表达式将用空格替换 3 个字符序列，而`'"\`不是单个 chars`\`和 . 将它们包含在一个字符类中 （除了 之外，不需要转义）。`'``"``[]``\``\`

```
data = data.replace(/['"\\]/g," ");

// Example:
var str = "This string has internal \" double \\ quotes \\ and 'some single ones' and a couple of backslashes";
str = str.replace(/['"\\]/g," ");
// Output: all quotes replaced with spaces:
// "This string has internal   double   quotes   and  some single ones  and a couple of backslashes" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:36:41.463

您错了。没有什么可以替代的。正则表达式不打开任何文件。它所做的只是用`'"`空格替换字符组合。

你搜索的是`['"]`而不是 `\'\"`

# python - python：嵌套线程SimpleXMLRPCServers时的httplib.CannotSendRequest

> ID：13534251
> 
> 赞同：9
> 
> 时间：2012-11-23T18:34:33.723
> 
> 标签：python, python-2.7, httplib, xmlrpclib, simplexmlrpcserver

在使用使用 SocketServer.ThreadingMixin 的 SimpleXMLRPCServer 链时，我间歇性地收到 httplib.CannotSendRequest 异常。

我所说的“链”是指：

我有一个客户端脚本，它使用 xmlrpclib 调用 SimpleXMLRPCServer 上的函数。该服务器又调用另一个 SimpleXMLRPCServer。我意识到这听起来多么令人费解，但是选择这种架构是有充分理由的，我看不出有什么理由不应该这样做。

```
(testclient)client_script ---calls--> 
    (middleserver)SimpleXMLRPCServer ---calls---> 
        (finalserver)SimpleXMLRPCServer --- does something 
```

*   如果我不使用 SocketServer.ThreadingMixin 则不会发生此问题（但我需要请求是多线程的，所以这无济于事。）
*   如果我只有一个级别的服务（即直接调用最终服务器的客户端脚本），这不会发生。

我已经能够在下面的简单测试代码中重现该问题。有以下三个片段：

最终服务器：

```
import SocketServer
import time
from SimpleXMLRPCServer import SimpleXMLRPCServer
from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler

class AsyncXMLRPCServer(SocketServer.ThreadingMixIn,SimpleXMLRPCServer): pass

# Create server
server = AsyncXMLRPCServer(('', 9999), SimpleXMLRPCRequestHandler)
server.register_introspection_functions()

def waste_time():
    time.sleep(10)
    return True

server.register_function(waste_time, 'waste_time')
server.serve_forever() 
```

中间服务器：

```
import SocketServer
from SimpleXMLRPCServer import SimpleXMLRPCServer
from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler
import xmlrpclib

class AsyncXMLRPCServer(SocketServer.ThreadingMixIn,SimpleXMLRPCServer): pass

# Create server
server = AsyncXMLRPCServer(('', 8888), SimpleXMLRPCRequestHandler)
server.register_introspection_functions()

s = xmlrpclib.ServerProxy('http://localhost:9999')
def call_waste():
    s.waste_time()
    return True

server.register_function(call_waste, 'call_waste')
server.serve_forever() 
```

测试客户端：

```
import xmlrpclib
s = xmlrpclib.ServerProxy('http://localhost:8888')
print s.call_waste() 
```

要重现，应使用以下步骤：

1.  运行 python finalserver.py
2.  运行 python middleserver.py
3.  运行 python testclient.py
4.  当 (3) 仍在运行时，运行另一个 python testclient.py 实例

很多时候（几乎每次）您第一次尝试运行第 4 步时都会收到以下错误。有趣的是，如果您立即尝试再次运行第 (4) 步，则不会发生错误。

```
Traceback (most recent call last):
  File "testclient.py", line 6, in <module>
    print s.call_waste()
  File "/usr/lib64/python2.7/xmlrpclib.py", line 1224, in __call__
    return self.__send(self.__name, args)
  File "/usr/lib64/python2.7/xmlrpclib.py", line 1578, in __request
    verbose=self.__verbose
  File "/usr/lib64/python2.7/xmlrpclib.py", line 1264, in request
    return self.single_request(host, handler, request_body, verbose)
  File "/usr/lib64/python2.7/xmlrpclib.py", line 1297, in single_request
    return self.parse_response(response)
  File "/usr/lib64/python2.7/xmlrpclib.py", line 1473, in parse_response
    return u.close()
  File "/usr/lib64/python2.7/xmlrpclib.py", line 793, in close
    raise Fault(**self._stack[0])
xmlrpclib.Fault: <Fault 1: "<class 'httplib.CannotSendRequest'>:"> 
```

互联网似乎说这个异常可能是由于多次调用 httplib.HTTPConnection.request 而没有干预 getresponse 调用。但是，Internet 并没有在 SimpleXMLRPCServer 的上下文中讨论这个问题。任何有关解决 httplib.CannotSendRequest 问题的指示将不胜感激。

==================================================== =========================================== 答案：

好吧，我有点傻。我想我盯着代码看的时间太长了，以至于我错过了直面我的明显解决方案（从字面上看，因为答案实际上是在实际问题中。）

基本上，CannotSendRequest 发生在 httplib.HTTPConnection 被介入的“请求”操作中断时。每个 httplib.HTTPConnection.request 必须与 .getresponse() 调用配对。如果该配对被另一个请求操作中断，则第二个请求将产生 CannotSendRequest 错误。所以：

```
connection = httplib.HTTPConnection(...)
connection.request(...)
connection.request(...) 
```

将失败，因为在调用任何 getresponse 之前，您在同一连接上有两个请求。

将其与我的问题联系起来：

1.  三个程序中唯一建立此类连接的地方是 serverproxy 调用。
2.  该问题仅在线程期间发生，因此很可能是竞争条件。
3.  共享 serverproxy 调用的唯一位置是 middleserver.py

那么解决方案显然是让每个线程创建它自己的服务器代理。中间服务器的固定版本如下，它可以工作：

```
import SocketServer
from SimpleXMLRPCServer import SimpleXMLRPCServer
from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler
import xmlrpclib

class AsyncXMLRPCServer(SocketServer.ThreadingMixIn,SimpleXMLRPCServer): pass

# Create server
server = AsyncXMLRPCServer(('', 8888), SimpleXMLRPCRequestHandler)
server.register_introspection_functions()

def call_waste():
    # Each call to this function creates its own serverproxy.
    # If this function is called by concurrent threads, each thread
    # will safely have its own serverproxy.
    s = xmlrpclib.ServerProxy('http://localhost:9999')
    s.waste_time()
    return True

server.register_function(call_waste, 'call_waste')
server.serve_forever() 
```

由于此版本导致每个线程都有自己的 xmlrpclib.serverproxy，因此不存在*同一*serverproxy 实例连续多次调用 HTTPConnection.request 的风险。这些程序按预期工作。

抱歉打扰了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-24T18:52:25.907

好吧，我有点傻。我想我盯着代码看了很长时间，以至于我错过了盯着我的明显解决方案（从字面上看，因为答案实际上是在实际问题中。）

基本上，CannotSendRequest 发生在 httplib.HTTPConnection 被介入的“请求”操作中断时。基本上，每个 httplib.HTTPConnection.request 都必须与 .getresponse() 调用配对。如果该配对被另一个请求操作中断，则第二个请求将产生 CannotSendRequest 错误。所以：

```
connection = httplib.HTTPConnection(...)
connection.request(...)
connection.request(...) 
```

将失败，因为在调用任何 getresponse 之前，您在同一连接上有两个请求。

将其与我的问题联系起来：

1.  三个程序中唯一建立此类连接的地方是 serverproxy 调用。
2.  该问题仅在线程期间发生，因此很可能是竞争条件。
3.  共享 serverproxy 调用的唯一位置是 middleserver.py

那么解决方案显然是让每个线程创建它自己的服务器代理。中间服务器的固定版本如下，它可以工作：

```
import SocketServer
from SimpleXMLRPCServer import SimpleXMLRPCServer
from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler
import xmlrpclib

class AsyncXMLRPCServer(SocketServer.ThreadingMixIn,SimpleXMLRPCServer): pass

# Create server
server = AsyncXMLRPCServer(('', 8888), SimpleXMLRPCRequestHandler)
server.register_introspection_functions()

def call_waste():
    # Each call to this function creates its own serverproxy.
    # If this function is called by concurrent threads, each thread
    # will safely have its own serverproxy.
    s = xmlrpclib.ServerProxy('http://localhost:9999')
    s.waste_time()
    return True

server.register_function(call_waste, 'call_waste')
server.serve_forever() 
```

由于此版本导致每个线程都有自己的 xmlrpclib.serverproxy，因此 serverproxy 不存在连续多次调用 HTTPConnection.request 的风险。这些程序按预期工作。

抱歉打扰了。

# c# - 在 Windows 8 Metro 应用程序中获取系统区域设置

> ID：13534252
> 
> 赞同：0
> 
> 时间：2012-11-23T18:34:34.393
> 
> 标签：c#, windows-8, .net-4.5

如果我打电话，在 Windows 8 C# WindowsStore 应用程序中

```
System.Globalization.RegionInfo.CurrentRegion 
```

我得到美国，虽然在控制面板 - 地区我有位置和语言 = 英国......

**如何获取不使用地理位置的设备所在国家/地区？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:44:11.617

```
var region = new Windows.Globalization.GeographicRegion(); 
```

[GeographicRegion 的无参数构造函数](http://msdn.microsoft.com/en-us/library/windows/apps/br206796.aspx)创建一个默认为用户家乡区域的 GeographicRegion 对象。

# javascript - 学习编程 JavaScript，但我被困住了

> ID：13534255
> 
> 赞同：5
> 
> 时间：2012-11-23T18:34:47.107
> 
> 标签：javascript, arrays, object

昨天我开始学习 JavaScript。我正在使用系统[Codecademy](http://codecademy.com)，但我被卡住了。当我说“卡住”时，我的意思是我的任务是我看不到哪里出了问题。

**任务是：**

创建一个数组，`myArray`. 它的第一个元素应该是一个数字，它的第二个应该是一个布尔值，它的第三个应该是一个字符串，它的第四个应该是......一个对象！在前四个之后，您可以添加任意数量的任何类型的元素。

**这是我制作的代码：**

```
var myObj = {
    name: 'Hansen'
};

var myArray = [12,true, "Steen" ,myObj.name]; 
```

**错误：**

> 糟糕，再试一次。myArray 的第四个元素是对象吗？

希望您能够帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:37:18.193

您的第四个元素的问题是您正在传递一个字符串，因为`myObj.name`它被定义为`Hansen`. 而是传递对象：

```
var myArray = [12,true, "Steen" ,myObj]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:38:32.920

我不知道那个网站，但你可以这样做：

```
var myArray = [
    12,
    true,
    "Steen",
    {name: 'Hansen'}
]; 
```

您传递给数组的是`name`对象属性的值，而不是对象本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:40:12.960

您可能已经从其他答案中知道，您传入的是 name 属性而不是第四个数组参数的对象。

正如您在这里学习的那样，有几种方法可以与您在这里完成的事情完全相同。

**你的方式更正了：**

```
var myObj = {
    name: 'Hansen'
};

var myArray = [12, true, "Steen", myObj]; 
```

**其他方法：**

```
// Method 1
var myArray = [12, true, "Steen", {name: 'Hansen'}];

// Method 2
var myObj = new Object();
myObj.name = "Hansen";
var myArray = new Array(12, true, "Steen", myObj);

// Method 3
var myObj = {};
myObj['name'] = 'Hansen'
var myArray = [
    12, true, 'Steen', myObj
] 
```

每种方法都展示了几种不同的方法来做同样的事情，您可以混合和匹配代码的等效部分来完成相同的工作。它基本上是在普通 JavaScript 语法和**对象字面量语法**之间相互转换。

# web-services - 如何对使用 Web 服务的类进行单元测试？

> ID：13534260
> 
> 赞同：5
> 
> 时间：2012-11-23T18:35:39.977
> 
> 标签：web-services, unit-testing, mocking

我有一个类（我们称之为 A）：

*   在构造函数中，接受一个配置并基于它，创建一个 Web 服务的存根，并将对它的引用存储在一个私有字段中。
*   有一些调用 web 方法的方法和一些介于两者之间的东西。

我开始创建一个单元测试：

*   使用虚拟配置创建类 A 的实例。
*   通过反射，它注入模拟的 Web 服务存根。

尽管该 Web 服务有很多方法。

*   我应该全部模拟它们吗（在每次测试中，使用不同的数据）？
*   或者也许我应该创建另一个仅封装正在使用的 Web 方法的层？
*   还是有另一种方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:58:53.040

您应该围绕您的 web 服务创建一个包装器接口，并使您的测试类依赖于该接口，而不是直接依赖于 web 服务；然后你可以模拟界面。仅使该接口公开您感兴趣的 Web 服务的方法。这被称为外观模式，并[在此处](http://www.dofactory.com/Patterns/PatternFacade.aspx)详细介绍。

在不知道你正在测试什么的情况下，瞄准这样的目标：

```
public interface IWebserviceWrapper
{
    Whatever DoStuff(int something);
}

public class WebserviceWrapper : IWebserviceWrapper
{
    private WebService _theActualWebservice;

    public WebserviceWrapper(Webservice theService)
    {
        _theActualWebService = theService;
    }

    public Whatever DoStuff(int something)
    {
         return _theActualWebservice.DoSomething(something);
    }

} 
```

然后您的测试将如下所示（在这种情况下，使用 MOQ）

```
public void Test_doing_something()
{
    Mock<IWebserviceWrapper> _serviceWrapperMock = new Mock<IWebserviceWrapper>();

    _serviceWrapperMock.SetUp(m => m.DoStuff(12345)).Returns(new Whatever());

    var classUnderTest = new ClassUnderTest(_serviceWrapperMock.Object);

    var result = classUnderTest.Dothings(12345);

    Assert.Whatever....

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:52:42.927

当你对一个类进行单元测试时，你总是希望确保只测试那个类而不包括它的依赖项。为此，您必须模拟您的 WS 以使其在调用方法时返回虚拟数据。根据您的场景，您不必模拟每个测试的所有方法，我只会说那些使用的方法。

有关模拟的示例，您可以阅读这篇文章：[http ://written-in-codes.blogspot.ca/2011/11/unit-tests-part-deux.html](http://written-in-codes.blogspot.ca/2011/11/unit-tests-part-deux.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:40:11.050

简短的回答是的:)。长答案，您应该使用某种模拟库，例如：[http](http://code.google.com/p/mockito/) ://code.google.com/p/mockito/并在您的单元测试中模拟 WS 存根并将其传递给测试类。这就是力量的方式:)

# oracle - 奇怪的 Oracle XMLType.getClobVal() 结果

> ID：13534264
> 
> 赞同：9
> 
> 时间：2012-11-23T18:35:51.980
> 
> 标签：oracle, xmltype

我使用 Oracle 11g（在 Red Hat 上）。我有一个带有 XMLType 列的简单常规表：

```
CREATE TABLE PROJECTS
(
  PROJECT_ID NUMBER(*, 0) NOT NULL,
  PROJECT SYS.XMLTYPE,
); 
```

使用 Oracle SQL Developer（在 Windows 上）我这样做：

```
select T1.PROJECT P1 from PROJECTS T1 where PROJECT_ID = '161'; 
```

有用。我得到一个细胞。我可以双击并下载整个 XML 文件。

然后我尝试将结果作为 CLOB：

```
select T1.PROJECT.getClobVal() P1 from PROJECTS T1 where PROJECT_ID = '161'; 
```

有用。我得到一个细胞。我可以双击并查看整个文本并复制它。但有一个问题。当我将它复制到剪贴板时，我只得到前 4000 个字符。位置 4000 似乎有 0x00 字符，而 CLOB 的其余部分没有被复制。

为了确认这一点，我在 java 中编写了 check：

```
// ... create projectsStatement
Reader reader = projectsStatement.getResultSet().getCharacterStream( "P1" );
BufferedReader bf = new BufferedReader( reader );
char buffer[] = new char[ 1024 ];
int count = 0;
int globalPos = 0;
while ( ( count = bf.read( buffer, 0, buffer.length ) ) > 0 )
    for ( int i = 0; i < count; i++, globalPos++ )
        if ( buffer[ i ] == 0 )
            throw new Exception( "ZERO at " + Integer.toString(globalPos) ); 
```

阅读器返回完整的 XML，但我的异常被抛出，因为位置 4000 有空字符。我可以删除这个单字节，但这将是一个相当奇怪的解决方法。

我在那里不使用 VARCHAR2 但也许这个问题与 VARCHAR2 限制（4000 字节）有关？还有其他想法吗？这是 Oracle 错误还是我遗漏了什么？

- - - - - - - - - - 编辑 - - - - - - - - - -

使用以下存储过程插入值：

```
create or replace
procedure addProject( projectId number, projectXml clob ) is
  sqlstr varchar2(2000);
begin

  sqlstr := 'insert into projects ( PROJECT_ID, PROJECT ) VALUES ( :projectId, :projectData )';
  execute immediate sqlstr using projectId, XMLTYPE(projectXml);

end; 
```

用于调用它的 Java 代码：

```
try ( CallableStatement cs = connection.prepareCall("{call addProject(?,?)}") )
{
    cs.setInt( "projectId", projectId );
    cs.setCharacterStream( "projectXml", new StringReader(xmlStr) , xmlStr.length() );
    cs.execute();
} 
```

- - - - - - - - - - 编辑。简单测试--------

我将使用我从你的答案中学到的一切。创建最简单的表：

```
create table T1 ( P XMLTYPE ); 
```

准备两个带有 XML 的 CLOB。第一个带有空字符，第二个没有。

```
declare
  P1 clob;
  P2 clob;
  P3 clob;
begin

  P1 := '<a>';
  P2 := '<a>';
  FOR i IN 1..1000 LOOP
    P1 := P1 || '0123456789' || chr(0);
    P2 := P2 || '0123456789';
  END LOOP;
  P1 := P1 || '</a>';
  P2 := P2 || '</a>'; 
```

检查 null 是否在第一个 CLOB 中，而不是在第二个中：

```
DBMS_OUTPUT.put_line( DBMS_LOB.INSTR( P1, chr(0) ) );
DBMS_OUTPUT.put_line( DBMS_LOB.INSTR( P2, chr(0) ) ); 
```

我们会得到预期的：

```
14
0 
```

尝试将第一个 CLOB 插入 XMLTYPE。不起作用。不能插入这样的值：

```
insert into T1 ( P ) values ( XMLTYPE( P1 ) ); 
```

尝试将第二个 CLOB 插入 XMLTYPE。它将起作用：

```
insert into T1 ( P ) values ( XMLTYPE( P2 ) ); 
```

尝试将插入的 XML 读入第三个 CLOB。它将起作用：

```
select T.P.getClobVal() into P3 from T1 T where rownum = 1; 
```

检查是否有空。没有空值：

```
DBMS_OUTPUT.put_line( DBMS_LOB.INSTR( P3, chr(0) ) ); 
```

似乎数据库内部没有空值，只要我们在 PL/SQL 上下文中，就没有空值。但是，当我尝试在 SQL Developer（在 Windows 上）或 Java（在 Red Hat EE 和 Tomcat7 上）中使用以下 SQL 时，我在所有返回的 CLOB 中的位置 4000 处得到空字符：

```
select T.P.getClobVal() from T1 T; 
```

BR，JM

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T23:52:19.600

这不是 Oracle 错误（它可以很好地存储和检索 \0。这是一个客户端/Windows 错误（不同的客户端在“NUL”方面的行为与 Windows 一样）

chr(0) 真的不是非 blob 中的有效字符（我很好奇你是如何让 XMLType 首先接受它的，因为它通常不会解析）。

\0 在 C 中用于表示字符串的结尾（NUL 终止符），并且某些 GUI 会在该点停止处理字符串。例如：

```
![SQL> select 'IM VISIBLE'||chr(0)||'BUT IM INVISIBLE'
  2  from dual
  3  /

'IMVISIBLE'||CHR(0)||'BUTIM
---------------------------
IM VISIBLE BUT IM INVISIBLE

SQL> 
```

然而蟾蜍在这方面惨败： ![蟾蜍](../Images/30f6a295697c35b9562b06ef0817fc27.png)

如您所见，sql developer 的表现更好：

![SQL 开发人员](../Images/2178f766308906298b2ae570a05e6cf9.png)

但是如果你复制它，剪贴板只会将它复制到 nul 字符。这个复制粘贴错误不是 SQL 开发人员的错误，而是 Windows 剪贴板不允许 NUL 正确粘贴的问题。

`replace(T1.PROJECT.getClobVal(), chr(0), null)`在使用 sql developer/windows 剪贴板时，您应该解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-18T15:32:47.190

错误：14781609 XDB：当 XML 存储在 CLOB 中时，XMLType.getclobval() 返回一个临时 LOB。在补丁集 11.2.0.4 中修复

如果读取为 blob，则另一种解决方案，则不会出现错误

```
T1.PROJECT.getBlobVal(nls_charset_id('UTF8')) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T17:31:07.307

I also was experiencing this same issue exactly as described by Mikosz (seeing an extra 'NUL' character around the 4000th character when outputting my XMLType value as a Clob). While playing around in SQLDeveloper I noticed an interesting workaround. I was trying to see the output of my XMLType, but was tired of scrolling to the 4000th character, so I started wrapping the Clob output in a substr(...). Much to my surprise, the issue actually disappeared. I incorporated this into my Java app and confirmed that the issue was no longer present and my Clob could be retrieved without the extra character. I know that this isn't an ideal workaround, and I'm still not sure why it works (would love if someone could explain it to me), but here's an abbreviated example of what I've currently got working:

```
// Gets the xml contents
String sql = "select substr(x.xml_content.getClobVal(), 0) as xml_content from my_table x";
ps = con.prepareStatement(sql);
if(rs.next()) {
  Reader reader = new BufferedReader(rs.getCharacterStream("xml_content"));
  ...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T00:59:18.177

很容易验证它是否是`.getClobVal()`调用 - 在生成的 CLOB 上使用 PL/SQL（不是 Java）执行`INSTR`测试，以查看是否`CHR(0)`存在。

如果没有，那么我会指责您的 Oracle 客户端安装。

# asp.net - 更新角色描述（实体框架/LINQ）？

> ID：13534266
> 
> 赞同：1
> 
> 时间：2012-11-23T18:35:53.633
> 
> 标签：asp.net, asp.net-mvc, entity-framework, asp.net-mvc-4, entity

伙计们，我想使用我的应用程序更新角色描述我不知道连接到数据库并运行 UPDATE 语句的更好方法是什么。

会是实体框架吗？林克？这2个选项都没有..

请，建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:59:58.290

我会说实体框架是目前最适合您的解决方案。它不仅得到 Microsoft 的大力支持（Silverlight 也是如此），而且：

如果你从它开始，你可以使用设计器。它的图形用户界面将指导您生成模型（基于数据库）或从模型开始时生成数据库模式。阅读一些与之相关的教程：

[http://msdn.microsoft.com/en-us/data/ee712907](http://msdn.microsoft.com/en-us/data/ee712907)

稍后看看如何使用更多的专业技术作为存储库模式或工作单元

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:50:52.733

不是 Linq ..好吧是 linq，但 linq 是查询框架，而实体框架是对象关系映射器。所以实际上两者都是。您可以通过其他各种方式做到这一点，但是根据我的经验，这两种技术可以很好地协同工作。

在 Visual Studio 中，您将创建一个新的 ADO.NET 项目模板，然后将其连接到您的数据库。然后你可以更新表格并做很多事情。Linq 内置于 .NET 中，因此从技术上讲，您可以使用 linq 查询任何对象（这使得它非常有趣），并且因为您的实体是一个对象，您只需引用它（首先声明它）然后使用它

```
FooModel foo = new FooModel(); // Entity
var fooQuery = from _ in foo.DescriptionTable // Linq query
               where _.Description == SelectedDesc // table selection query
               select _;

foo.Add(fooQuery); // add to database
foo.SaveChanges(); // save changes 
```

类似的东西。它还有一些具体的项目，但您必须提供更多细节。

绝对值得学习这两种技术，并且怀疑您会发现它们非常有用。两者都可能变得非常复杂，但是对于您需要的东西，您只需要了解基础知识，然后您就可以从那里进行探索。

# php - PHP - 一直__call

> ID：13534269
> 
> 赞同：10
> 
> 时间：2012-11-23T18:36:07.713
> 
> 标签：php, methods, call, magic-methods

假设我们有一个包含多个受保护和/或公共方法的类。每次调用方法时我都需要进行检查。每次调用方法时，我都可以进行检查：

```
class Object
{
    // Methods
}

$o = new Object();

if($mayAccess) $o->someMethod(); 
```

或者

```
if($mayAccess) $this->someMethod(); 
```

但我希望开发人员既不必考虑也不必编写它。我考虑过使用 __call 来做：

```
class Object
{
    public function __call($methodName, $args)
    {
        if($mayAccess) call_user_func_array($this->$methodName, $args);
    }
} 
```

不幸的是，如果我从类内部调用该方法，则不会调用 __call，因为它仅在调用不可见方法时才有效。

有没有一种干净的方法来隐藏对内部和外部调用的检查？同样，目标是确保开发人员在调用方法时不会忘记这样做。

提前致谢 ：）

```
EDIT : 
```

我有另一种方法：

```
class Object
{
    public function __call($methodName, $args)
    {
        if($mayAccess) call_user_func_array($methodName, $args);
    }
}

function someMethod() { } 
```

但是我将无法再使用 $this，这意味着没有我需要的受保护方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-23T18:41:18.997

不，我不这么认为。你可以做的是写一个[代理](http://en.wikipedia.org/wiki/Proxy_pattern)：

```
class MayAccessProxy {

    private $_obj;

    public function __construct($obj) {
        $this->_obj = $obj;
    }

    public function __call($methodName, $args) {
        if($mayAccess) call_user_func_array(array($this->_obj, $methodName), $args);
    }
} 
```

这意味着您必须为要检查的每个对象实例化一个代理：

```
$obj = new MayAccessProxy(new Object());
$obj->someMethod(); 
```

当然，您还希望代理的行为与对象本身完全相同。所以你还必须定义其他魔术方法。

为了使开发人员更容易，您可以执行以下操作：

```
class Object {

    /**
     * Not directly instanciable.
     */
    private __construct() {}  

    /**
     * @return self
     */
    public static function createInstance() {
        $obj = new MayAccessProxy(new self());
        return $obj;
    }
}

$obj = Object::createInstance(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-26T14:33:51.150

那么，如果您将所有方法设为受保护或私有呢？（我知道这是一个古老且“已回答”的问题）

__call 魔术方法拦截所有不存在和非公共的方法，因此让所有方法不公开将允许您拦截所有方法。

```
public function __call( $func, $args )
{
  if ( !method_exists( $this, $func ) ) throw new Error("This method does not exist in this class.");

  Handle::eachMethodAction(); // action which will be fired each time a method will be called

  return $this->$func( ...$args );
} 
```

多亏了这一点，你不需要对你的代码做任何事情（期望添加 __call 和做 quick `replace all`），如果你的类有共同的父类，那么你可以将它添加到父类而不关心了。

# 但

该解决方案产生了两个主要问题：

*   受保护/私有方法将自动对公众可用
*   错误将指向 __call 不是正确的文件

## 我们能做些什么？

### 自定义私有/受保护

您可以添加所有受保护/私有方法的列表，并在调用之前检查该方法是否可以返回公共：

```
public function __call( $func, $args )
{
  $private = [
    "PrivateMethod" => null
  ];

  if ( !method_exists( $this, $func ) ) throw new Error("This method does not exist in this class.");
  if ( isset( $private[$func] )       ) throw new Error("This method is private and cannot be called");

  Handle::eachMethodAction(); // action which will be fired each time a method will be called

  return $this->$func( ...$args );
} 
```

对于许多人来说，这可能会破坏交易，但我个人只在只有公共方法（我设置为受保护）的类中使用这种方法。因此，如果可以，您可以将方法分离`publicClass`并`privateClass`消除此问题。

### 自定义错误和堆栈

为了更好的错误，我创建了这个方法：

```
/**
  *    Get parent function/method details
  *
  *    @param int counter [OPT] The counter allows to move further back or forth in search of methods detalis
  *
  *    @return array trace It contains those elements :
  *       - function - name of the function
  *       - file     - in which file exception happend
  *       - line     - on which line
  *       - class    - in which class
  *       - type     - how it was called
  *       - args     - arguments passed to function/method
  */

protected function getParentMethod( int $counter = 0 ) {
  $excep = new \Exception();
  $trace = $excep->getTrace();
  $offset = 1;
  if ( sizeof( $trace ) < 2 ) $offset = sizeof( $trace ) - 1;
  return $trace[$offset - $counter];
} 
```

它将返回有关称为受保护方法的先前方法/函数的详细信息。

```
public function __call( $func, $args )
{
  $private = [
    "PrivateMethod" => null
  ];

  if ( !method_exists( $this, $func ) ) {
    $details = (object) $this->getParentMethod();
    throw new Error("Method $func does not exist on line " . $details->line . ", file: " . $details->file . " invoked by " . get_class($this) . $details->type . $func . " () ");
  }

  if ( isset($private[$func]) ) {
    $details = (object) $this->getParentMethod();
    throw new Error("Method $func is private and cannot be called on line " . $details->line . ", file: " . $details->file . " invoked by " . get_class($this) . $details->type . $func . " () ");
  }

  return $this->$func( ...$args );
} 
```

这不是什么大问题，但可能会在调试时导致一些混乱。

## 结论

此解决方案允许您从 CLASS 外部控制对私有/受保护方法的任何调用。Any`this->Method`将省略`__call`并且通常会调用私有/受保护的方法。

```
class Test {

  public function __call( $func, $args )
  {
    echo "__call! ";
    if ( !method_exists( $this, $func ) ) throw new Error("This method does not exist in this class.");

    return $this->$func( ...$args );
  }

  protected function Public()
  {
    return "Public";
  }

  protected function CallPublic()
  {
    return "Call->" . $this->Public();
  }

}

$_Test = new Test();
echo $_Test->CallPublic(); // result: __call! Call->Public - it uses two methods but __call is fired only once 
```

如果您想在静态方法中添加类似的东西，请使用`__callStatic`魔术方法。

# css - 通过 CSS 从未声明的 div 中删除文本

> ID：13534270
> 
> 赞同：2
> 
> 时间：2012-11-23T18:36:14.507
> 
> 标签：css, html, text, joomla

主题。我有一个用于广告的 Joomla 模块（不要怪我使用 joomla，不是我，我只是在帮助我的朋友）。问题是我无法获得任何模块的源代码，所以我必须通过 CSS 解决大部分问题（主要是 display:none 方法）。

```
<div style="text-align: right;">
        <a style="text-decoration:none; color: #c0c0c0; font-family: arial,helvetica,sans-serif; font-size: 5pt; " target="_blank" href="http://joomline.ru/">ADVERTISMENT HERE</a>
</div> 
```

如果只声明了 div，我会简单地使用 display:none 方法使其不可见...

期待帮助！

编辑：

```
<div class="content">
    <div id="jlvkgroup41016340" style="background: none repeat scroll 0% 0% transparent; height: 301px; width: 270px;">
         ...
    </div>
    <script type="text/javascript"> ... </script>
    <div style="text-align: right;">
        <a style="text-decoration:none; color: #c0c0c0; font-family: arial,helvetica,sans-serif; font-size: 5pt; " target="_blank" href="ADVERT LINK">TEXT ADVERT</a>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:41:43.420

假设您试图隐藏链接（使用*特定* `href`的）：

```
a[href^="http://joomline.ru"] {
    display: none;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/DynAX/)。

基于新添加的 HTML，您可以`a`使用兄弟组合器定位特定元素：

```
#jlvkgroup41016340 + script + div a {
    display: none;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/DynAX/4/)。

这针对作为`a`元素的后代的`div`元素，该元素是元素的直接相邻兄弟`script`元素，该元素本身是具有 of 的元素的相邻兄弟`id`元素`jlvkgroup41016340`。

或者：

```
#jlvkgroup41016340 ~ div a {
    display: none;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/DynAX/3/)。

这以 a 的`a`后代为目标，`div`后者是 的元素的后兄弟`id="jlvkgroup41016340"`。参考：

*   [通用兄弟 ( `~`) 组合](http://www.w3.org/TR/selectors/#general-sibling-combinators)子。
*   [相邻兄弟 ( `+`) 组合](http://www.w3.org/TR/selectors/#adjacent-sibling-combinators)子。

# javascript - 在 Ruby on Rails 中集成 Javascript

> ID：13534277
> 
> 赞同：0
> 
> 时间：2012-11-23T18:36:55.820
> 
> 标签：javascript, ruby-on-rails

我有一个 html 文件，我需要用 Rails 样式重写它。我试图阅读 Rails 指南，但找不到太多有用的信息。这是我拥有的 HTML 的一部分。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<% content_for :head do -%>
  <%= stylesheet_link_tag 'css.css' %>

<% end %>

<head>
<title>index</title>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" media="all" type="text/css" href="css/css.css" />
<script language="JavaScript" type="text/javascript" src="images/jquery-1.7.1.min.js"></script>
<script language="JavaScript" type="text/javascript" src="images/jQuery.infiniteCarousel.js">        
</script>
<script language="JavaScript" type="text/javascript" src="images/jQuery.tbSwitching.js"></script>
<script language="JavaScript" type="text/javascript" src="images/myfocus-1.2.4.full.js"></script>
<script language="JavaScript" type="text/javascript" src="images/mF_expo2010.js"></script>
<link href="images/mF_expo2010.css" rel="stylesheet" type="text/css" />
</head>
<body>
<center>
<div id="top">
 <div class="one">
     <div class="one1">
         <img src="images/ico1.png"  width="225" height="58"/>
     </div>
     <div class="one2">
         <div class="one3">
              <div class="one4">Login/Sign up</div> 
              <div class="one4">Create an Account </div>    
              <div class="one5">shopping bag</div>   
         </div>
     </div>
  </div>
</div>
<div class="two">
<% content_for :below_body do -%>
  <%= javascript_include_tag 'images/jquery-1.7.1.min.js' %>
  <%= javascript_include_tag 'images/jQuery.infiniteCarousel.js' %>
 <%= javascript_include_tag 'images/jQuery.tbSwitching.js' %>
 <%= javascript_include_tag 'images/myfocus-1.2.4.full.js' %>
     <%= javascript_include_tag 'images/mF_expo2010.js' %>
<% end %>   

<script>
$(function(){
    $("#top .two3").hover(function(){   
    $("#top .two3").removeClass("on").next(".two4").removeClass("ac");
    $(this).addClass("on").next(".two4").addClass("ac");        
},function(){   

});
})
</script>
<script>
$(function(){
    $("#top .two5 a").hover(function(){     
    $(this).addClass("on");     
},function(){   
    $(this).removeClass("on");
    });
})
</script>
......
</body>
</html> 
```

我试图通过在 body 标签内使用下面的代码来修改它，但似乎没有用。

```
<% content_for :below_body do -%>
    <%= javascript_include_tag 'images/jquery-1.7.1.min.js' %>
    <%= javascript_include_tag 'images/jQuery.infiniteCarousel.js' %>
    <%= javascript_include_tag 'images/jQuery.tbSwitching.js' %>
    <%= javascript_include_tag 'images/myfocus-1.2.4.full.js' %>
    <%= javascript_include_tag 'images/mF_expo2010.js' %>
<% end %> 
```

我应该把它放在头里吗？我也应该对标签做任何事情吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:39:55.067

一般的经验法则是库应该放在头部（如 jQuery），所有其他使用 jQuery 的代码都应该放在代码下面。这样做的原因是，您想要作为 jQuery 的 DOM 元素与之交谈的所有内容都必须在文档中呈现（即在您的 js 代码上方）。

我通常做的是在页面末尾附加所有内容，即所有脚本。这样页面本身的加载时间就会减少，因为来自 HTTP 的请求不会先加载 JS，然后再加载 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:42:17.237

你遇到了什么错误？如果没有看到错误，我们必然无法知道问题来自哪里。

您是否将 JS 文件保存在 JS 文件中`rails_root/app/assets/javascripts/images`？这就是你上面所说的。

例如`<%= javascript_include_tag 'images/jquery-1.7.1.min.js' %>`，将创建此标签：`<script type="text/javascript" src="/javascripts/images/jquery-1.7.1.min.js?1284139606"></script>`，并带有与文件构建时间相关的时间戳。

如果您在生产模式而不是开发模式下运行服务器，这也可能是一个问题。在生产模式下，您需要预编译您的资产：`rake assets:precompile`.

# bash - 仅当目标目录中存在文件夹时，才从源目录同步/复制文件夹

> ID：13534283
> 
> 赞同：1
> 
> 时间：2012-11-23T18:37:46.803
> 
> 标签：bash, if-statement, copy

我正在尝试在 ubuntu 中编写一个 bash 脚本来复制一些文件。我正在开发一个小型 Android 项目，我每周都在翻译应用程序。我对 bash 脚本非常陌生，所以请多多包涵；）

我希望我的脚本检查目标目录并查看我的源目录是否包含相同的文件夹。如果是这样，它应该将我的源文件夹复制（并在需要时覆盖）到目标目录，并保留结构。但还要添加我在这些源文件夹中可能拥有的任何额外文件和文件夹。

假设我的源目录中有文件夹 1、文件夹 2、文件夹 3，但目标目录中只有文件夹 1 和文件夹 2。然后我只需要从源目录复制到目标目录的文件夹 1 和文件夹 2。

目标目录的内容经常变化，这就是为什么我需要在复制文件夹/文件之前进行检查。

顺便说一句，源目录和目标目录中的文件夹都被命名为：folder1.apk - 它有一个扩展名，所以它看起来像一个文件..

希望我提供了足够的信息；）

编辑：

我最终这样做了：

```
 for dir in `find * -maxdepth 0 -type d`; do
    cp -r -f /source/$dir /destination
    done 
```

不知道这是否是最好的方法，但似乎可以完成这项工作；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:10:25.047

您可能会看一下[rsync](http://linux.die.net/man/1/rsync)工具，它有很多选项且易于使用（无需使用自己的脚本）。例如，对您的情况有用的选项之一：

```
--existing              skip creating new files on receiver 
```

所以，以下应该做的工作：

```
rsync -vur --existing ~/project/source /mnt/target/ 
```

如果您需要甚至将其用作守护程序来自动同步文件，则可以通过网络以相同的方式同步文件的可能好处之一。

# matlab - 在随机位置生成具有给定数量 1 的矩阵

> ID：13534289
> 
> 赞同：1
> 
> 时间：2012-11-23T18:38:34.007
> 
> 标签：matlab, matrix, graph-theory

我正在尝试为具有 N 个节点的图创建连接矩阵。连接规则规定它应该有 1000 个随机分配的单向连接（节点不能连接到自己）。

我想要做的是在随机位置生成一个矩阵 NxN，其中大部分是零和 1000 个，但不在主对角线上。

我真的对如何实现这一目标没有任何想法。我考虑过生成一个介于 0 和 N/1000 之间的随机数矩阵，然后使 (N-1)/1000 以上的那些为 1，其余为 0，但这不是很精确（我可能会得到更多或更少1000），我不知道如何处理对角线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:00:55.557

那这个呢。查找非对角元素的索引。随机选择其中一些，然后用一个填充这些索引：

```
nn = 10; % Size of matrix
nr = 20; % number of random connections
ident = eye(nn);       
nd_idx = find(~ident); % Indices of non-diag elements
con = randperm(numel(nd_idx), nr); % Pick random elements
m = zeros(nn);
m( nd_idx(con) ) = 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:00:37.100

如果你想得到一个恰好有 1000 个随机定位真值的矩阵，我的建议是创建一个随机矩阵，并使用最低或最高的 1000 个元素。要删除对角线，请使用`eye()`. 所以，像这样

```
N = 5000;
nNodes = 1000;
a = rand (N);
a(eye (N)) = 2;
threshold = sort (a(:))(nNodes);
b = false (N);
b(a >= threshold) = true; 
```

我认为 Matlab 还没有实现变量输出的索引，这仍然只在 Octave 中可用。如果是这种情况，您将需要使用一个临时变量来保存排序后的数组，这可能会为大型矩阵占用一些内存。

```
threshold = sort (a(:));
threshold = threshold(nNodes); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:52:52.120

1.  生成随机矩阵**A**
2.  圆形物品
3.  **在主对角线B**上生成 1 和 0 的矩阵（您可以创建一个矩阵，而不是从它的主对角线上减去 1 的矩阵）
4.  将 A 乘以 B

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:57:56.217

```
#!/usr/bin/python

import sys
from random import randint

if len(sys.argv)!=3:
     sys.exit("usage is :"+sys.argv[0]+" matrix-size num-of-connections")

matrixSize       = int(sys.argv[1])
numOfConnections = int(sys.argv[2])
i = 0 

while (i < numOfConnections):
     a = randint(1, matrixSize)
     b = randint(1, matrixSize)
     if (a==b):
         continue
     i+=1
     print "connection from %d to %d"%(a,b) 
```

# c++ - c++_中不同目录下的文件如何使用变量

> ID：13534290
> 
> 赞同：0
> 
> 时间：2012-11-23T18:38:37.443
> 
> 标签：c++, variables

我对 c++ 中不同目录中的文件的使用变量有疑问。

我有档案啊

```
class A
{
    private:
    B *b_;
} 
```

在文件 a.cpp 中，我像这样 #include "ah" 包含了 ah

我在与 ah 和 a.cpp 相同的文件夹中有另一个文件 bh 和 b.cpp

这是另一个名为c.cpp的文件，与ah和bh同级，

```
class C
{
   A *a_;
} 
```

但是文件 dh 和 d.cpp 在 ah,bh,ch 的子目录中，像这样：/(ah)/(d.cpp, dh)，并且在 d.cpp 中，我已经包含了 ah 和 bh，但是我在 d.cpp 中像这样使用它：

```
a_->b_; 
```

它显示以下消息：

```
warning: statement has no effect 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:41:43.010

删除无效果语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:42:10.660

表达式`a_->b_`只是检索一个值，而不是对它做任何事情，因此作为一个语句`a_->b_;`，它并不比例如有用`2;`- 你需要对它做一些事情，例如将它分配到某个地方或将它作为某个函数的参数.

如果您不需要表达式来表达其副作用或结果，只需将其删除。

# php - 使用相同的代码库管理多个 Web 应用程序

> ID：13534297
> 
> 赞同：7
> 
> 时间：2012-11-23T18:39:38.943
> 
> 标签：php, git, web-applications, version-control

我正在寻找管理多个共享相同代码库的 PHP Web 应用程序实例的最佳方式（或最简单的方式）。

让我为你分解一下：

我们的域托管应用程序的多个实例，每个实例都有自己的设置文件和数据库。

[http://mydomain.com](http://mydomain.com)
|
|--------/客户1/
|
|--------/客户2/
|
|--------/customer3/ + 自定义功能

假设客户 1 和 2 购买了应用程序（我们为他们托管），并且他们拥有该应用程序的基本模型。（即未定制）

但是，客户 3 想要功能 X 或 Y，因此我们为他编写了该功能并将其添加到应用程序中。

但是，只要代码库有更新（即框架核心类中的安全修复），所有三个客户都应该获得基本代码的更新！

管理这种设置的最佳方式是什么？使用 FTP 手动上传所有文件很痛苦，而且无法合并代码。

使用 Git 或许是一种解决方案，但我该如何去做呢？为每个客户创建单独的存储库？如果我们发展到超过一百个客户怎么办？

欢迎任何见解，包括为什么我们应该或不应该使用这样的设置。（但请记住，我们将为客户托管应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:12:06.780

我记得几年前这样做了，所以你必须考虑到我现在对此有点生疏了。

我构建了一个独立的框架，它将所有包含合并到一个 .php 文件中。任何使用它的框架都会执行 PULL 请求，如果其框架的 md5 与中央服务器上的框架匹配，则不需要更新。否则它将通过 https 下载新框架并替换它自己的副本。这创建了一个自动更新系统，该系统被拉到使用它的所有其他应用程序中。

对此的一个主要问题是，如果您导致说语法错误并将其上传到中央服务器，它将被拉到所有其他服务器并破坏它们！您最好使用 cron 作业来发出不使用框架的拉取请求，因此损坏的框架不会破坏它执行拉取请求以修复框架中的语法错误。一旦您在中央服务器上修复了语法错误，这至少增加了自动修复自身的能力。但是，在这种情况下，拥有一个用于测试每个更新的登台服务器确实非常重要。

当然，这只是基础知识，就好像你说框架使用的图像也需要被拉过来，以及任何 SQL 更新等等。

在上传到中央服务器之前，您必须对此进行严格测试，以防止出现大量错误！不理想！单元测试、登台服务器、小而简单的更新但更频繁（大更新更有可能出错，如果出错则需要撤消更多）都有助于降低风险。

您还必须从一开始就构建非常非常非常非常非常好的框架，以便在计划让许多不同的站点使用它时尽可能灵活。如果你一开始就设计错了，那么以后再重新设计几乎是不可能的。例如，使用 PDO 进行数据库访问可能是明智的，允许所有应用程序能够使用不同的数据库，而您的类等仍然不知道如何与数据库交互（不管它是 mysql 还是 oracle），但是，我如果可以的话，建议至少坚持一个。

明智的设计，你最好看看其他语言框架，看看它们是如何做的。您必须坚持良好的设计原则，仅在适用的情况下使用设计模式，并注意 MVC！

进一步阅读...

*   [http://en.wikipedia.org/wiki/Software_design_pattern](http://en.wikipedia.org/wiki/Software_design_pattern)
*   [http://www.ipipan.gda.pl/~marek/objects/TOA/oobasics/oobasics.html](http://www.ipipan.gda.pl/~marek/objects/TOA/oobasics/oobasics.html)
*   [http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)
*   [http://www.phpframeworks.com/](http://www.phpframeworks.com/)

这不是一件容易的事，所以要小心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:47:57.820

您在一个问题中混合了两个不同的任务

*   发散代码的开发和支持
*   将代码从（任何）SCM 部署到实时系统

回答第一个问题（对于*任何*现代） SCM 正在分支和合并分支（每个客户都有自己的分支，您将需要的部分从您的单个开发分支合并到其中，或者 /better/ 与您的“每个任务的分支”合并在所有需要的目标中合并任务分支，避免挑选）

第二个问题的答案是“Build-tools”，它可以与您的 SCM 交互（您必须稍后编写更多详细信息以获得更详细的答案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:45:34.360

使您的自定义功能模块化。使用与具有插件或扩展的 WordPress/Joomla 类似的架构。这使您的客户可以轻松拥有单独的功能集，但都共享相同的基本代码。

# javascript - 用 Javascript 动画算法

> ID：13534300
> 
> 赞同：0
> 
> 时间：2012-11-23T18:39:55.197
> 
> 标签：javascript, animation, raphael, sleep

我正在使用 Raphael.js 来可视化凸包算法。但是我希望能够单步执行代码的不同部分（或使用类似 sleep()/delay() 的东西）。但是，我看不到使用 setTimeOut() 完成此操作的方法。有任何想法吗？

例如：

```
sort(points);
//sleep(...)/delay(...)/pause until click?
for(...) {
   message('Foo thing');
   //sleep(...)/delay(...)/pause until click?
   while() {
      message('Comparing points');
      //sleep(...)/delay(...)/pause until click?
   }
} 
```

![算法结果的屏幕截图。 红色点表示凸包的一个元素。](../Images/8f62fb091397ae2cdc5c6fb9dbccbb16.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:42:12.227

在 JavaScript 中，无法使用`sleep`函数暂停代码执行。执行 JavaScript 代码被设计为非阻塞的。

使用`debugger`关键字的解决方案也适用于 Chrome。你只需要打开开发者工具。

我准备了以不同方式工作的演示。它使用模拟`sleep`功能`setInterval`并且不阻止脚本执行。但是，它涉及一些额外的代码。

假设我们有初始代码：

```
var arr = [0, 1, 2, 3, 4];

function step(val) {
    console.log(val);
}

for (var i = 0, len = arr.length; i < len; i++) {
    step(arr[i]);
} 
```

现在，我们想重写它，以便每个日志在一秒钟后显示：

```
var arr = [0, 1, 2, 3, 4],
steps = [];

function step(val) {
  console.log(val);
}

for (var i = 0, len = arr.length; i < len; i++) {
  steps[i] = step.bind(null, arr[i]);
}

var int = setInterval(function() {
    var fun = steps.shift();
    if(!fun) {
        clearInterval(int); 
        return;
    }
    fun();
}, 1000); 
```

让我稍微解释一下。首先，我定义`steps`数组，在其中放置带有绑定参数的新函数。`bind`function 基本上使用绑定到提供的值的参数创建新函数。[MDN 页面](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)上的更多详细信息。

例子：

```
function step(a) { console.log(a); }
var step1 = step.bind(null, 1);
// now step1 is like `var step1 = function() { console.log(1); }` 
```

在`for`循环中，我使用`bind`. 最后一步是从`steps`数组中提取这些函数，从头开始（使用`Array.prototype.shift`方法），并以等于 1 秒的间隔执行它们。

我知道这不是您问题的直接解决方案，但我希望它可以帮助您正确转换代码。如果您决定这样做，我建议将内部的代码块`for`和`while`循环转换为函数。它稍微简化了转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:49:35.703

也许您可以等待按钮单击，然后当单击发生时您可以插入一行代码？

为按钮设置一个 onclick 监听器并设置变量 continue = true; 在一段代码执行之后，您想等待下一段代码运行您可以使用。

```
//code just executed
while(continue == false) sleep(10);
continue = false;
//next code to be executed
while(continue == false) sleep(10);
continue = false;
//more code.... 
```

可能有比这更好的解决方案，所以不要将此代码视为最好的，除非它是您唯一的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:56:57.513

您可以尝试使用浏览器上提供的调试工具。如果您使用的是 chrome，请按 Shift + Ctrl + I 启用开发人员工具。如果您使用的是 firefox，则可以下载安装 firebug 扩展。完成此操作后，您可以通过放置断点来单步执行代码。这是通过放置“调试器”来完成的；在要开始单步执行的 javascript 点处的关键字。例如

```
sort(points);
debugger
for(...) {
  message('Foo thing');
  debugger;
  while() {
    message('Comparing points');
    debugger;
  }
} 
```

# linux - 如何将上下文后的 grep 设置为“直到下一个空白行”？

> ID：13534306
> 
> 赞同：48
> 
> 时间：2012-11-23T18:40:18.623
> 
> 标签：linux, unix, awk, grep

使用 grep 我知道如何将上下文设置为固定数量的行。是否可以根据任意字符串条件显示上下文，例如将上下文设置为“直到下一个空白行”？

或者可能是其他一些工具组合？

基本上我有一个连续行的日志文件，用空白行分隔“事件”我想在日志文件中搜索一个字符串，但显示整个事件......

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-23T18:44:25.627

听起来你需要`sed`：

```
sed -n '/pattern/,/^$/p' file 
```

默认情况下不打印 ( `-n`)。`/pattern/`对于与空行匹配的行`/^$/`，打印。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-11-23T23:06:51.387

一个简单的解决方案是：

```
awk '/pattern/' RS= input-file 
```

将 RS 设置为空字符串使 awk 将空行视为记录分隔符，而简单的规则`/pattern/`使 awk 打印任何与模式匹配的记录，可以是任何扩展的正则表达式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-23T18:53:44.930

这是一个（经过测试的）`awk`解决方案，为了便于阅读，分成多行：

```
awk '/pattern/ {do_print=1}
     do_print==1 {print}  
     NF==0 {do_print=0}' input_file 
```

该脚本还将打印空白行，以便更容易在视觉上分离不同的匹配块。如果您不想要空行，请交换 2 行`do_print==1 {print}`并`NF==0 {do_print=0}`

**解释：**

*   `awk`：调用该`awk`工具 - 它按顺序一次一行地评估输入。
*   `'...'.`: 用单引号括起来的所有内容都`awk`作为说明给出。在这种情况下，我们在每一行上执行引用的指令。
*   `/pattern/ {do_print=1}`：只要一行包含“ `pattern`”，打开`do_print`标志
*   `do_print==1 {print}`: 如果`do_print`标志设置为 on，则打印当前行。
*   `NF==0 {do_print=0}`: NF 代表字段数。`awk`默认情况下，用空格和制表符分隔每一行，以将一行分成多个字段。在这种情况下，一个空白行通常没有字段 - 所以我们在看到一行时关闭`do_print`标志以停止打印`NF == 0`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-12T23:54:03.857

就我个人而言，我喜欢@William Pursell 的答案，因为之前的上下文通常很有用（例如，在查找`ini`文件中的内容时）。如果您实际上只想要 after 上下文，`awk`您可以这样做：

```
$ cat demo.ini 
[foo]
aaa = 1
bbb = 2
ccc = 3

[bar]
eee = 8
fff = 0
ggg = 1

[baz]
xxx = 1
yyy = 0
zzz = 2
$ awk '/bar/,/^$/' demo.ini 
[bar]
eee = 8
fff = 0
ggg = 1

$ awk '/fff/,/^$/' demo.ini 
fff = 0
ggg = 1

$ 
```

与`RS=`版本比较：

```
$ awk '/bar/' RS= demo.ini 
[bar]
eee = 8
fff = 0
ggg = 1
$ awk '/fff/' RS= demo.ini 
[bar]
eee = 8
fff = 0
ggg = 1 
```

# javascript - Conditional element value in a templating language for loop

> ID：13534310
> 
> 赞同：0
> 
> 时间：2012-11-23T18:40:32.613
> 
> 标签：javascript, node.js, pug

I'm trying to do something like the following (stripped of optimization for demonstration purposes):

```
table
    - for(j = 0; j < 10; j++)
    tr
        td Name
        td -for(i = 0; i < 10; i++) // Output a a letter from an array
            #{data[i] + list[i][j]}
            - if(j < list[i].length) // Add a comma if it isn't the last element
            , 
```

The idea is that the second td will contain a list of comma-separated values, and the if statement will check if it's the last one - if not, add the comma. I'm sure it's more so just my amateur understanding of Jade that's making this feel impossible. Seems like I can't quite get the value in the right place for the td - because of my indentation, it makes a new tag with a name of `data[i] + list[i][j]` which actually seems like the *right* thing for Jade to do, but I just can't see how else to accomplish this and Jade documentation is scarce.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T21:57:18.660

Try:

```
table
    - for(var j = 0; j < 10; j++)
      tr
          td Name
          - for(var i = 0; i < 10; i++)
            td #{data[i] + list[i][j]}
            - if(j < list[i].length)
              , 
```

I have not tested directly your code, but simpler version which worked as expected. Hope it's what you need.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T23:51:41.120

I was able to forge a solution with some experimentation after an answer by dreame4 - basically I realized that I didn't need a tag, and that Jade was interpeting my #{ data[i]} segment as a tag. Using a pipe (|) I just told Jade not to interpet it as a tag:

```
table
    - for(j = 0; j < 10; j++)
    tr
        td Name
        td 
            -for(i = 0; i < 10; i++) // Output a a letter from an array
            | #{data[i] + list[i][j]}
            - if(j < list[i].length) // Add a comma if it isn't the last element
            , 
```

# git - Github post-receive hook 自动拉取回滚

> ID：13534311
> 
> 赞同：3
> 
> 时间：2012-11-23T18:40:37.797
> 
> 标签：git, github, git-post-receive

我在我的生产服务器上使用这样的东西[，](https://github.com/kwangchin/GitHubHook)在 github 上设置为 post-receive 钩子，并且它基本上设置为每当它从 github 收到格式正确的请求时拉取特定分支上的更改。

现在，假设有人将糟糕的代码推送给 master，这会自动拉动生产并破坏一切。还原更改的最佳方法是什么，而不必通过 ssh 连接到生产服务器并手动签出旧代码？理想情况下，它就像再次推动一样简单。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:29:04.510

如果该错误代码是一次或多次提交的结果，请使用[`git revert`](http://git-scm.com/docs/git-revert)在本地取消它们。
这将创建一个取消错误代码的*新*提交，您可以推送该提交。

> 给定一个或多个现有提交，还原相关补丁引入的更改，并记录一些记录它们的新提交

将该回复提交推送到 GitHub 将触发 post-receive 钩子并将新的更改拉入生产环境。

# c# - 在代码运行时更新 Windows 窗体 GUI

> ID：13534312
> 
> 赞同：0
> 
> 时间：2012-11-23T18:40:43.600
> 
> 标签：c#, .net, progress-bar

我在 Windows 窗体中使用进度条时遇到了一些问题。假设我有一个包含十个部分的算法，只需单击一下按钮即可运行。在每个部分之后，我想将表单上的进度条更新为 10%。但是，当代码运行时，Windows 窗体将不会响应或更新。

代码运行时在表单上显示进度的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:44:06.750

您需要使用`BackgroundWorker`.
一个很好的例子可以在这里找到：http: [//www.dotnetperls.com/progressbar](http://www.dotnetperls.com/progressbar)

```
using System.ComponentModel;
using System.Threading;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
  public partial class Form1 : Form
  {
    public Form1()
    {
    InitializeComponent();
    }

    private void Form1_Load(object sender, System.EventArgs e)
    {
      // Start the BackgroundWorker.
      backgroundWorker1.RunWorkerAsync();
    }

    private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
    {
      for (int i = 1; i <= 100; i++)
      {
        // Wait 100 milliseconds.
        Thread.Sleep(100);
        // Report progress.
        backgroundWorker1.ReportProgress(i);
      }
    }

    private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
      // Change the value of the ProgressBar to the BackgroundWorker progress.
      progressBar1.Value = e.ProgressPercentage;
      // Set the text.
      this.Text = e.ProgressPercentage.ToString();
    }
  }
} 
```

或者你可以使用类似的东西：

```
private void StartButtonClick(object sender, EventArgs e)
{
    var t1 = new Thread(() => ProgressBar(value));
    t1.Start();
}

private void ProgressBar(value1)
{
  ProgressBar.BeginInvoke(new MethodInvoker(delegate
  {
      ProgresBar.Value++
  }));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:25:05.687

我建议将 TPL 用于更标准化、轻量级、健壮和可扩展的操作，例如参见：http: [//blogs.msdn.com/b/pfxteam/archive/2010/10/15/10076552.aspx](http://blogs.msdn.com/b/pfxteam/archive/2010/10/15/10076552.aspx)

# java - 构建谓词时如何加入，但没有 JPAQuery 实例

> ID：13534313
> 
> 赞同：8
> 
> 时间：2012-11-23T18:40:45.000
> 
> 标签：java, querydsl

在为实体书构建谓词时，我希望能够在类别 (ManyToMany) 上左连接以在类别上添加 AND 谓词。如果我有 JPAQuery 实例，我可以简单地实现这一点：

```
if (catId != null) {
    jpaQuery.leftJoin(book.categories, category);
    jpaQuery.where(category.id.eq(catId).or(category.parentCategory.id.eq(catId)));
} 
```

但是在构建谓词时，我还没有 JPAQuery。所以对于谓词本身，我可以这样做：

```
booleanBuilder.and(category.id.eq(this.categoryId).or(category.parentCategory.id.eq(this.categoryId))); 
```

但是对于 leftjoin 如何在没有 jpaQuery 实例的情况下进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T08:35:09.863

您需要 Query 在 Querydsl 中声明左连接。如果这与 Spring Data 相关，他们可能会提出 API 级别的解决方案。

book.categories.any() 可以用来代替类别，但它的序列化方式与 JPQL 不同，使用子查询而不是连接。

# jquery - Fancybox 选项不适用

> ID：13534317
> 
> 赞同：0
> 
> 时间：2012-11-23T18:41:10.880
> 
> 标签：jquery, fancybox-2

我得到了这个带有 Fancybox 选项的非常基本的代码：

```
$(document).ready(function() {

    $(".publications a").fancybox({ 

        'autoDimensions' : false,
        'width' : 350,
        'autoScale' : false,
        'titlePosition' : 'over'
    });
}); 
```

我得到的 html 内容主要来自 php（使用 while 循环）。

```
<div class="publications">
    <a title="My title" href="#data2">  Few text goes here </a> 

    <div style="display:none">
        <div id="data2">
            <h3>Abstract</h3>
            Some text goes here
        </div>
    </div>
</div> <br/> 
```

内联默认花式框运行良好，但我无法对其应用任何选项。我希望我可以调整它的大小并移动标题，但它根本没有发生。

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:57:14.720

在 jqueryUI 对话框小部件上使用 fancybox 的任何特殊原因？你看过吗？[查看这些示例](http://jqueryui.com/dialog/#modal)，尝试一下，看看您是否喜欢它们。

请记得点赞或接受任何对您有帮助的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:06:10.480

你是从[这里](http://fancyapps.com/fancybox/)使用 Fancybox2 吗？如果您是，您应该查看他们的[文档](http://fancyapps.com/fancybox/#docs)，了解如何正确使用他们的插件。我看到您的代码与他们的 API 不同。
此外，您应该使用 Firebug for Mozilla Firefox（他们的控制台）或 Chorme 开发人员工具来查看您是否犯了任何 JavaScript 拼写错误或错误。

# c# - 显示列表中的 X 个项目

> ID：13534321
> 
> 赞同：0
> 
> 时间：2012-11-23T18:41:25.203
> 
> 标签：c#, list, loops

我有一个项目列表，我想打印到控制台进行调试，但我只想一次显示 3 个项目，但这是在一个函数中，所以它需要知道它在哪里停止，以便它可以从下一个 3以前的项目我怎么能做到这一点？

```
static void list(Boolean nextPage)
{
    static List<Item> _items = new List<Item>();
    //if(nextPage) display next page            
    Console.WriteLine("Press numbers 1 - 3 to display more info on an item or press 4 for next page...\r\n");
    int count = 0;
    foreach (Item item in _items)
    {
        Console.WriteLine((count + 1) + ": Name: " + item.itemName + ", ");

        count++;
    }
    Console.WriteLine(("4: Next Page");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:46:16.537

使您的函数成为非静态函数，添加一个变量来存储您到目前为止显示的最后一项，使用该变量来决定从哪里开始下一个列表，并在每次执行该函数时将该值提高三倍。

这是您如何做到这一点的粗略近似 - 这可能无法作为您的功能的复制粘贴替换，但它应该让您知道该怎么做：

```
int lastPosition;

void list(Boolean nextPage) {
    if(!nextPage) {
        lastPosition = 0;
    }
    Console.WriteLine("Press numbers 1 - 3 to display more info on an item or press 4 for next page...\r\n");
    foreach (Item item in _items.Skip(lastPosition).Take(3))
    {
        Console.WriteLine((count + 1) + ": Name: " + item.itemName + ", ");
    }
    lastPosition += 3;
    Console.WriteLine(("4: Next Page");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:46:19.617

当您退出方法时，在方法范围内创建的所有内容都会被丢弃，除非您向调用该方法的人返回一个值。

所以，你有两个选择（或更多，但这里有两个）：

```
private static Item lastItem; 
```

有了这个，你可以在你的类中存储最后一个显示的项目并在下次检索它。或者

```
public static Item itemlist(Boolean nextPage, Item nextItem)
{
    // Some logic
    return lastItem;
} 
```

并让调用您的方法的人处理该变量。

# jquery - 在动画之前等待预先加载图像

> ID：13534326
> 
> 赞同：1
> 
> 时间：2012-11-23T18:41:43.733
> 
> 标签：jquery, prepend

我有一个要添加到 div 的图像，然后 div 被动画到一个新的高度，问题是，或者至少我认为是，页面没有等到图像加载之前抓取高度和动画，我不知道如何让它做到这一点。

我现在已经设置好了，所以页面会等到文本加载完成，但我不确定如何还包括图像部分。就是这个
$('#images').empty();

```
$("<img>", { src: 'http://www.klossal.com/' + id + ".png" }).prependTo("#images"); 
```

这是整个事情：

```
$(".thumb_container_img").click(function() {

a1=0; //Reset the Loading Variables
a2=0;
a3=0;
a4=0;
IMG=1;

var id = $(this).attr('id');

$('#images').empty();

$("<img>", { src: 'http://www.klossal.com/' + id + ".png" }).prependTo("#images");

$("#info_header").load(id +"_header.txt", function() {

console.log('Loaded'); //Testing Purposes Only
a1=1; // Loaded
animate_section(); // Attempt Animation         

});

$("#content_1").load(id +"_1.txt", function() {

console.log('Loaded'); //Testing Purposes Only
a2=1; // Loaded
animate_section(); // Attempt Animation         

});

$("#content_2").load(id +"_2.txt", function() {

console.log('Loaded'); //Testing Purposes Only
a3=1; // Loaded
animate_section(); // Attempt Animation         

});

$("#content_3").load(id +"_3.txt", function() {

console.log('Loaded'); //Testing Purposes Only
a4=1; // Loaded
animate_section(); // Attempt Animation         

});

});

function animate_section() {

if((a1===1) && (a2===1) && (a3===1) && (a4===1) && (IMG===1)){ //Animate if all thre divs are loaded

$("#top_section").animate({
    height: $("#load_container").outerHeight(true) + 30
}, 300);
$("#grid").animate({
    marginTop: $("#load_container").outerHeight(true) + 300,
    paddingBottom: 300
}, 300);   
}                
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:45:53.410

您将需要使用 jQuery 中的 load() 函数来检查图像是否已加载。之后，您可以预先添加您想要添加的所有内容

```
$('img').attr('src', 'image.jpg').load(function() { $(this).prependTo(...) }) 
```

# c# - 将图片框数组分配给事件

> ID：13534327
> 
> 赞同：0
> 
> 时间：2012-11-23T18:41:53.460
> 
> 标签：c#, arrays, events, event-handling, picturebox

我有一系列这样的图片框：

```
PictureBox[] pb = new PictureBox[71]
{
pictureBox1,pictureBox2,pictureBox3,...etc
}; 
```

我知道如何将事件分配给单个对象，

```
private void pictureBox1_MouseHover(object sender, EventArgs e)
{
    pictureBox1.BackColor = Color.Red;
} 
```

但是如何将此数组分配给 1 个事件处理程序，最终结果应该是当我将 71 个框中的 1 个悬停在 .backColor 属性时，而不是为每个图片框制作 71 个处理程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:39:54.320

像这样订阅事件处理程序：

```
foreach (var p in pb)
{
    p.MouseHover += new EventHandler(pictureBox1_MouseHover);
} 
```

并设置`BackColor`如下：

```
private void pictureBox1_MouseHover(object sender, EventArgs e)
{
    ((PictureBox)sender).BackColor = Color.Red;
} 
```

`sender`是触发事件的实际 PictureBox。

# sql-server - 两个不同列的 SUM 和 DISTINCT

> ID：13534332
> 
> 赞同：2
> 
> 时间：2012-11-23T18:42:10.617
> 
> 标签：sql-server, linq, entity-framework, entity-framework-4

我有一张员工表，上面有以下记录

```
 EmpID    Salary   Date

    10      2000     1/1/2011
    10      2000     2/1/2011
    20      2000     1/1/2011 
```

我想计算员工总数和总工资（基于其他一些参数）

有没有一种简单的方法可以在实体框架中编写以下 SQL 查询。

```
 select Sum(Salary), count(distinct(EmployeeID)) from empdb.employeesalary (where clause) 
```

有一个我需要选择这些值的类

```
 class EmployeeEntity
  {
       decimal TotalAmount;
       int EmployeeCount 
  } 
```

我目前在 EF 中执行两个查询，如下所示

```
 objectcontext.employeesalary.Sum(c => c.Salary);
  objectcontext.employeesalary.Select(c => c.EmployeeID).Distinct().Count(); 
```

如何使用 Entity Framework 将这些合并到单个语句中。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:01:25.317

尝试这样的事情：

```
objectcontext.employeesalary
   .Where(c => ...)
   .GroupBy(_ => default(string))
   .Select(g => new
   {
      Sum = g.Sum(c => c.Salary),
      Count = g.Select(c => c.EmployeeID).Distinct().Count()
   }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T21:08:25.433

这个怎么样 ？您可以将 EF 的结果合并到您的员工实体类中

```
 var q =  from f in objectcontext.employeesalary
             where [clause]
             group f by f.EmpID into g
             select new EmployeeEntity
             {
                 TotalAmount = g.Sum(c => c.Salary),
                 EmpmloyeeCount = g.Select(c => c.EmployeeID).Discinct().Count()
             }

    var EmployeeSummary = new List<EmployeeEntity>(q.ToList()); 
```

# c# - 如何在 Windows Store App 中使用 C# 计算大文件的哈希（MD5 或 SHA）

> ID：13534334
> 
> 赞同：10
> 
> 时间：2012-11-23T18:42:17.200
> 
> 标签：c#, windows, microsoft-metro

**问题：**

“如果您尝试在 Windows 8 Metro 应用程序中使用带有包含大文件的缓冲区的metod HashData(IBuffer) 计算 md5 或 sha，您会收到 OutOfMemoryException，因为缓冲区非常大（包含原始字节的副本文件）。”

**解决方案：**

```
//NB: "file" is a "StorageFile" previously openedHashAlgorithmProvider md5 = Windows.Security.Cryptography.Core.HashAlgorithmProvider.OpenAlgorithm(HashAlgorithmNames.Md5);
//in this example I use HashAlgorithmNames.Md5, you can replace it with HashAlgorithmName.Sha1, etc...

HashAlgorithmProvider alg = Windows.Security.Cryptography.Core.HashAlgorithmProvider.OpenAlgorithm(HashAlgorithmNames.Md5);
var stream = await file.OpenStreamForReadAsync();
var inputStream = stream.AsInputStream();
uint capacity = 100000000;
Windows.Storage.Streams.Buffer buffer = new Windows.Storage.Streams.Buffer(capacity);
var hash = alg.CreateHash();

while (true)
{
    await inputStream.ReadAsync(buffer, capacity, InputStreamOptions.None);
    if (buffer.Length > 0)
        hash.Append(buffer);
    else
        break;
}

string hashText = CryptographicBuffer.EncodeToHexString(hash.GetValueAndReset()).ToUpper();

inputStream.Dispose();
stream.Dispose(); 
```

我希望这会有所帮助:)

# eclipse - 如何使用 egit 删除提交？

> ID：13534336
> 
> 赞同：27
> 
> 时间：2012-11-23T18:42:36.530
> 
> 标签：eclipse, git, egit

我刚刚用 egit 做了一些我想删除的错误提交。

![我想删除一些错误的提交](../Images/430392e543e404058b53a19cf3535c8a.png)

如何从 egit 中删除提交？

谢谢！

编辑：我尝试了几次硬重置，但它没有做任何事情。 ![硬重置屏幕](../Images/fa61ced5fcc2cdd794f55f84dda506f5.png)

编辑 2：硬重置确实回滚更改，但我希望它们从历史记录中完全消失，就好像我从未进行过这些提交一样。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-10T08:37:00.083

右键单击您的存储库，然后单击“显示在 -> 历史中”。您应该在最后一次“获取”之前选择最后一次提交......大多数情况下它是您当前 HEAD 下的第二次提交。RightMouse 在那个提交和“reset -> Hard”（将你的所有提交和本地工作区更改重置为选定的提交）。

您应该看到向上箭头变为向下箭头，这意味着您的提交已被删除并且您的存储库已过时。使用“fetch”和“rebase”来更新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-14T08:23:40.863

请注意，[Kepler 中的 Egit3.0](http://eclipsesource.com/blogs/2013/06/11/egit-3-0-top-eclipse-kepler-feature-9/)允许您硬重置为您想要的任何树状表达式：

![在此处输入图像描述](../Images/5298ddc3498798ca42de9304e07e1e8c.png)

但是一旦硬重置，你仍然需要`git push --force`在那之后：如果你不这样做，你的上游仓库的历史仍然会列出那个提交。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-23T18:45:59.563

您可以进行硬重置，但要小心！这里有更多信息：[从 Git 的分支中删除提交](https://stackoverflow.com/questions/1338728/how-to-delete-a-git-commit)

# asp.net-mvc - 具有动态表单控件的模型绑定

> ID：13534341
> 
> 赞同：0
> 
> 时间：2012-11-23T18:43:34.060
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller

我正在寻找将算术表达式存储到数据库中。我有这个数据库结构：

```
Expression
=======
id
name

Operand
=======
id
expressionId
value
side (indicates if the operand is on the left or right side of the expression)
idx (the index to identify the order of operands on each side)

Operator
========
id
expressionId
type
side
idx 
```

在我的视图中，我希望通过根据请求向页面动态添加控件，为用户提供创建具有可变数量的操作数和运算符的表达式的能力。如果用户单击“添加操作数”按钮，将通过 javascript 为运算符生成一个下拉列表，并为操作数生成一个文本框。

我的想法是在我的表达式的创建操作中使用自定义模型绑定并使用视图模型：

```
public class ExpressionCreateViewModel
{
IEnumerable<ExpressionOperator> Operators { get; set; }
IEnumerable<ExpressionOperand> Operands { get; set; }
Expression Expression { get; set; }
} 
```

模型绑定器可以使用它：

```
public class ExpressionCreateViewModelBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var vm = new ExpressionCreateViewModel();
        //Build it!
    } 
```

我担心的是我必须如何将动态生成的控件的值传递到这个视图模型中。我能想到的唯一方法是创建提供所有详细信息的控件 ID（例如 <input type="text" id="operand:1$side:left">）

然后我可以解析表单集合中的项目，并按照惯例构建操作数和运算符对象。

有没有人有更清洁的方法来做到这一点？

谢谢！

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T06:59:50.677

在视图模型中绑定到集合属性的常规方法是在 Html 元素的命名中使用数组表示法。例如：

```
<input type="text" id="someId1" name="Operators[0].Type" />
<input type="text" id="someId2" name="Operators[1].Type" /> 
```

根据您的需要，默认活页夹甚至可以为您完成这项工作。

# php - TPLockBox3 和 PHP - Delphi 中的 AES 加密，PHP 中的解密

> ID：13534360
> 
> 赞同：3
> 
> 时间：2012-11-23T18:44:56.477
> 
> 标签：php, delphi, cryptography, aes, lockbox-3

我在使用 lockbox3 和 PHP mcrypt 时遇到了问题。我无法将 IV 传递给 PHP。[德尔福代码](http://pastebin.com/pyCCmqcm)：

```
var
  Codec: TCodec;
  CL: TCryptographicLibrary;
  PlainStream: TStringStream;
  CipherStream: TMemoryStream;
begin
  PlainStream := TStringStream.Create(Edit1.Text);
  CipherStream := TMemoryStream.Create;

  CL := TCryptographicLibrary.Create(nil);
  Codec := TCodec.Create(nil);
  Codec.CryptoLibrary := CL;
  Codec.ChainModeId := uTPLb_Constants.CBC_ProgId;
  Codec.StreamCipherId := uTPLb_Constants.BlockCipher_ProgId;
  Codec.BlockCipherId := Format(uTPLb_Constants.AES_ProgId, [256]);
  Codec.Password := Edit3.Text;

  Codec.EncryptStream(PlainStream, CipherStream);
  Codec.Burn;

  Memo1.Text := Stream_to_Base64(CipherStream);
  Memo2.Clear;
  Memo2.Lines.Add(Format('Size: %d bytes', [CipherStream.Size]));
  Memo2.Lines.Add(Format('Original size: %d bytes', [PlainStream.Size]));

  Codec.Free;
  CL.Free;
  CipherStream.Free;
  PlainStream.Free; 
```

和[PHP 代码](http://pastebin.com/SSV4T36c)：

```
 $ciphertext = base64_decode("zA/eeF+WFVMDsZ7+iA==");
  $iv = substr($ciphertext, 0, 8);
  $text = substr($ciphertext, 8, strlen($ciphertext) - 8);

  $td = mcrypt_module_open("rijndael-256", "", "cbc", $iv);
  mcrypt_generic_init($td, "PasswordPassword", $iv);
  $plaintext = mdecrypt_generic($td, $text);
  echo $plaintext;
  mcrypt_generic_deinit($td);
  mcrypt_module_close($td); 
```

我收到一个错误：

> 警告：mcrypt_generic_init() [function.mcrypt-generic-init]：IV 大小不正确；提供的长度：8，需要：32 在 C:...\aestest.php 第 7 行

相关主题：[AES 加密/解密 Delphi & PHP](https://stackoverflow.com/questions/12138244/aes-encrypt-decrypt-delphi-php)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T11:18:57.383

你还没有说你使用的是什么版本的Delphi。这是一个重要的细节。目前，我假设它是 Delphi 2010。您的代码存在许多问题。我会解决他们...

(1) 在 Delphi 2010 及更高版本中，字符串以 UTF-16LE 编码，而在 PHP 中，字符串是 UTF-8。考虑一下你的这条线......

```
PlainStream := TStringStream.Create(Edit1.Text); 
```

您正在做的是创建有效负载字符串的 UTF-16LE 编码。您对此进行加密并将其传递给 PHP 端并对其进行解密。但是你不会得到预期的结果，因为解密的字节是 UTF-16LE，但是 PHP 期望它们是 UTF-8。

(2) TP Lockbox 3 已经有了加密字符串的本地方法。为什么不使用它们？

(3) 所有 3 种 AES 变体的块大小都是 128 位，即 16 字节。IV的大小**始终**是块的大小。在 PHP 方面，作为通用编码问题，您应该始终调用 [mcrypt_enc_get_iv_size()](http://www.php.net/manual/en/function.mcrypt-enc-get-iv-size.php)（您没有）。请在[此处阅读参考页面](http://php.net/manual/en/function.mcrypt-generic-init.php)。无论如何，对于 AES-256 必须返回 16 个字节。如果不是，那就是严重错误。

(4) 你的密码不一样，所以你永远不能合理地期待一个快乐的结果。在 Delphi 方面，您的密码以 UTF-16LE 编码。在 PHP 方面，您的密码是 'PasswordPassword' 的 UTF-8 编码，它永远不能逐字节地等于 UTF-16 中的有效值。

(5) 在 PHP 方面，你写了..

```
 $iv = substr($ciphertext, 0, 8); 
```

您需要将其零扩展为 16 个字节。参考这个[问题](https://stackoverflow.com/questions/12328320)。

* * *

# 更新

正如所承诺的，这里是一些用于解密 TurboPower LockBox 3 生成的密文消息的 PHP 代码。您需要制作一个 css 文件，否则演示会很丑陋。

```
<!DOCTYPE html>
<html lang="en">
 <head>
    <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=UTF-8">
    <META NAME="ROBOTS" CONTENT="NOINDEX,NOFOLLOW,NOARCHIVE" />
    <META NAME="DESCRIPTION" CONTENT="Tutorial and demostration page for Delphi (TurboPower LockBox3) to PHP symetric cryptography." />
    <META NAME="AUTHOR" CONTENT="Sean B. Durkin">
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
    <META NAME="KEYWORDS" CONTENT="cryptography,delphi,php,turbopower,lockbox,lockbox3">
    <title>Delphi-to-PHP Cryptography Tutorial</title>
    <link rel="stylesheet" media="screen and (min-device-width:  721px)" href="tut.css" /><!-- <== Desktop. -->     
    <link rel="stylesheet" media="screen and (max-device-width:  720px)" href="tut-phone.css" / --><!-- <== Phone and tablet. -->  
 <head>

<body>
<?php
error_reporting(E_ALL | E_COMPILE_ERROR);
$password = $_GET["password"];
$ciphertext_trans = $_GET["ciphertext-trans"];
$rawInputCiphertext = $_GET["ciphertext"];
$chain = $_GET["chain"];
$cipherIn = $_GET["cipherIn"];

function radioChecked($param,$value,$isDefault)
{
  $echo = (($param == $value) or ($isDefault and ($param == ''))) ? ' checked="checked" ' : '';
  echo $echo;
  return $echo != '';  
}
?>

<nav>
  <div class="nav-bg"></div>
  <div class="nav-content">
    <h1><a href="http://lockbox.seanbdurkin.id.au/tiki-index.php?page=Delphi-to-PHP+Tutorial+project+home" title="Go to The Delphi-to-PHP project home"><span class="hidden">Project home</span></a></h1>
    <dl>
      <dt>Date created</dt>
      <dd><time datetime="2012-11-29">29-Nov-2012</time></dd>
    </dl>
    <dl>
      <dt>Date last modified</dt>
      <dd><time datetime="2012-12-02">2-Dec-2012</time></dd>
    </dl>
  </div>    
</nav>

<h1>Decrypt with PHP from Delphi (TurboPower LockBox3)</h1>
<form id="plainForm" class="floatbox" action="">
  <fieldset>
    <legend>Crypto data</legend>
    <label class="first" for="password">Password (UTF-8)
      <input id="password" name="password" type="text" placeholder="Enter TCodec password" value="<?php echo htmlspecialchars($password) ?>" />
    </label>            
    <fieldset class="radio">
      <legend>Transport encoding</legend>
        <label for="ciphertext-trans-base64">
          <input id="ciphertext-trans-base64" name="ciphertext-trans" type="radio" value="base64" 
          <?php radioChecked($ciphertext_trans,'base64',True); ?> />base64
        </label>
        <label for="ciphertext-trans-hex">
          <input id="ciphertext-trans-hex" name="ciphertext-trans" type="radio" value="hex" 
          <?php radioChecked($ciphertext_trans,'hex',False); ?> />hex
        </label>
    </fieldset>             
    <label for="ciphertext">Ciphertext (transport encoded)
      <input id="ciphertext" name="ciphertext" type="text" placeholder="Paste ciphertext here" value="<?php echo htmlspecialchars($rawInputCiphertext) ?>" />
    </label>            
  </fieldset>
  <fieldset>
    <legend>Options</legend>
    <fieldset class="radio">
      <legend>Chaining mode</legend>
        <label for="chain-cfb">
          <input id="chain-cfb" name="chain" type="radio" 
            value="CFB" <?php radioChecked($chain,'CFB',True); ?> />CFB
        </label>
        <label for="chain-cbc">
          <input id="chain-cbc" name="chain" type="radio"
            value="CBC" <?php radioChecked($chain,'CBC',False); ?> />CBC
        </label>
        <label for="chain-ecb">
          <input id="chain-ecb" name="chain" type="radio"
            value="ECB" <?php radioChecked($chain,'ECB',False); ?> />ECB
        </label>
    </fieldset>             

    <fieldset class="radio">
      <legend>Cipher</legend>
        <label for="aes-128">
          <input id="aes-128" name="cipherIn" type="radio" 
            value="AES-128" <?php radioChecked($cipherIn,'AES-128',True); ?> />AES-128
        </label>
        <!-- Extend here with more ciphers as required. Note: PHP does not support AES-256\. -->
    </fieldset>             

    </fieldset>             
  <input class="submit" type="submit" value="Decrypt" />
</form>
<?php if ($chain) { ?>
<?php
function purgeWhiteSpace($sparseHex)
{
    return preg_replace('/\s+/', '', $sparseHex);
}
function expandWithWhiteSpace($compactHex)
{
// TODO: Insert white space for visual benefit. Bunch the brown spaces
//  into words of 6 characters, and then separate words with a single space.
//  Between every 10th word and 11th word, use a new-line ($0D) instead of space.
//  Assume that $compactHex ONLY consists of characters 0..9 and A..F .
    return $compactHex;
}
function displayableMultiline($str)
{
// TODO: Assume $str ONLY consists of characters whose code-points are below
//  137\. Insert '<br />' before each $0D character.
    return $str;
}
function hexToStr($hex)
{
    $hex2 = purgeWhiteSpace( $hex);
    $str='';
    for ($i=0; $i < strlen($hex2)-1; $i+=2)
    {
        $str .= chr(hexdec($hex2[$i].$hex2[$i+1]));
    }
    return $str;
}   
function strToHex($str)
{
    $hex='';
    for ($i=0; $i < strlen($str); $i++)
    {       
        $addend = dechex(ord($str[$i]));
        if (strlen($addend) < 2)
          $addend = '0' . $addend;
        $hex .= $addend;
    }
    return $hex;
}

$normalisedRawCiphertext = purgeWhiteSpace( $rawInputCiphertext);
if ($ciphertext_trans == 'base64')
{ 
  $ciphertext = base64_decode( $normalisedRawCiphertext);
}
else
{
  $ciphertext = hexToStr( $normalisedRawCiphertext);
}

if ($cipherIn == 'AES-128')
{
  $cipher = MCRYPT_RIJNDAEL_128;
  $cipherName = 'AES-128';
}
else
{
  // Extend here with more ciphers as required. Note: PHP does not support AES-256.
  $cipher = MCRYPT_RIJNDAEL_128; // Example only.
  $cipherName = '???';           // Example only.
}

if ($chain == 'CFB')
    $mode = 'ncfb';  // Proper block-mode CFB. There is no constant for this.
  else if ($chain == 'CBC') 
    $mode = MCRYPT_MODE_CBC;
  else  
    $mode = MCRYPT_MODE_ECB;

$blockSize = mcrypt_get_block_size( $cipher, $mode);
$keySize = mcrypt_get_key_size( $cipher, $mode);

// Work-around PHP bugs.
if (($cipher == MCRYPT_RIJNDAEL_128) and ($keySize == 32))
  { $keySize = 16; }   // AES-128 key size is 16 bytes.
if (($cipher == MCRYPT_RIJNDAEL_256) and ($blockSize == 32))
  { $blockSize = 16; } // AES-256 block size is 16 bytes.

$ivSize = $blockSize; // Always. mcrypt_get_iv_size() is pointless.

if ($chain == 'ECB')
{
    $iv = str_pad( 'NOT USED', 16, chr(0));
    // $ciphertext unchanged.
}
else
{
    $iv = substr( $ciphertext, 0, 8);
    $iv = str_pad( $iv, $ivSize, chr(0));
    $ciphertext = substr( $ciphertext, 8);
}

$ciphertextLen = strlen( $ciphertext);
if  (($ciphertextLen > 0) && ($ciphertextLen < $blockSize) && ($chain == 'CBC'))
 { $mode = MCRYPT_MODE_CFB; } // CFB 8-bit. This is NOT the same as CFB.

if (strlen($password)==$keySize)
  {
    $key = $password;
  }
else
  {
    $shaPassword = sha1( $password, True);
    for ($key = ''; strlen( $key) < $keySize; $key .= $shaPassword) {}
    $key = substr( $key, 0, $keySize);
  }  

$countBlocks = $ciphertextLen / $blockSize;
$countWholeBlocks = floor( $countBlocks); 
$isRound = $countBlocks == $countWholeBlocks; 
if ($isRound)
    {
    $lastBlockSize = 0;
    }
  else
    {
    $countBlocks = $countWholeBlocks + 1;
    $lastBlockSize = $ciphertextLen - ($countWholeBlocks * $blockSize);
    }     
$isCipherStealing = ($mode == MCRYPT_MODE_CBC) && ($countWholeBlocks >= 1) && !$isRound;
if ($isCipherStealing)
    { // Reverse ciphertext stealing.
/* 
Ciphertext stealing algorithm - Encryption:
  Mix     := Enc( CV[N-2], X[N-2]);
  Steal   := Last( B-b, Mix);
  Recycle := X[N-1] + Steal;
  Y[N-2]  := Enc( CV[N-2], Recycle);
  Y[N-1]  := Head( b, Mix);

Ciphertext stealing algorithm - Decryption:
  Recycle := Dec( CV[N-2], Y[N-2]);
  Steal   := Last( B-b, Recycle);
  Mix     := Y[N-1] + Steal;
  X[N-2]  := Dec( CV[N-2], Mix);
  X[N-1]  := Head( b, Recycle);  
*/  
    // 1\. Recycle := Dec( CV[N-2], Y[N-2]);
    $Recycle = mcrypt_decrypt ( $cipher, $key, substr( $ciphertext, 0, $countWholeBlocks * $blockSize), $mode, $iv);
    $reconUpToX_N_3 = substr( $Recycle, 0, ($countWholeBlocks - 1) * $blockSize); // X[0]..X{N-3]
    $Recycle = substr( $Recycle, ($countWholeBlocks - 1) * $blockSize, $blockSize);

    // 2\. Steal := Last( B-b, Recycle);
    $Steal = substr( $Recycle, $lastBlockSize, $blockSize - $lastBlockSize);

    // 3\. Mix := Y[N-1] + Steal;
    $Y_N1 = substr( $ciphertext, $countWholeBlocks * $blockSize, $lastBlockSize);
    $Mix = $Y_N1 . $Steal;

    // 4\. X[N-2]  := Dec( CV[N-2], Mix);
    $reconUpToX_N_2 = mcrypt_decrypt ( $cipher, $key, substr( $ciphertext, 0, ($countWholeBlocks - 1) * $blockSize) . $Mix, $mode, $iv);

    // 5\. X[N-1] := Head( b, Recycle);
    $reconX_N_1 = substr( $Recycle, 0, $lastBlockSize);

    // Putting it alltogether.
    $recon = $reconUpToX_N_2 . $reconX_N_1;
    }
  else
    { // Normal decyrption.
    $recon = mcrypt_decrypt ( $cipher, $key, $ciphertext, $mode, $iv);
    }
if (($chain == 'ECB') and ($recon != ''))
  { // Trim ECB padding.
  $last = strlen($recon);
  for ($l = strlen($recon); ($l >= 0) and (ord($recon[$l])==0); $l--)
    {$last = $l;}
  $recon = substr( $recon, 0, $last-1);
  }
?>
<hr />
<h2>Output</h2>
<h3>Summary2</h3>
<p>Cipher is <em><?php echo $cipherName; ?></em></p>
<p>Block size is <?php echo $blockSize; ?> bytes</p>
<?php if ($isRound) { ?>
  <p>Given ciphertext was a round <?php echo $countBlocks; ?> blocks long.</p>
<?php } else { ?>
  <p>Given ciphertext was a <?php echo $countWholeBlocks; ?> whole blocks long and <?php echo $lastBlockSize; ?> bytes in an odd block.</p>
<?php } ?>
<p>Key size is <?php echo $keySize; ?> bytes</p>
<p>Given chain mode was <em><?php echo $chain; ?></em></p>
<p>Given password was <em>&apos;<?php echo htmlspecialchars($password); ?>&apos;</em></p>
<p>Ciphertext as hex is...</p>
<code><?php echo '[' . $ciphertextLen . '] ' . displayableMultiline( expandWithWhiteSpace( strToHex( $ciphertext))); ?></code>
<p></p>
<p>Reconstructed plaintext message is <em>&apos;<?php echo htmlspecialchars( $recon); ?>&apos;</em></p>
<p></p>
<h2>Debug</h2>
<p>Key as hex is...</p>
<code><?php echo '[' . strlen($key) . '] ' . expandWithWhiteSpace( strToHex( $key)); ?></code>
<p>IV as hex is...</p>
<code><?php echo '[' . strlen($iv) . '] ' . expandWithWhiteSpace( strToHex( $iv)); ?></code>
<p>$countBlocks = <code><?php echo $countBlocks; ?></code></p>
<p>$countWholeBlocks = <code><?php echo $countWholeBlocks; ?></code></p>
<p>$isRound = <code><?php echo $isRound ? 'True' : 'False'; ?></code></p>
<p>$isCipherStealing = <code><?php echo $isCipherStealing ? 'True' : 'False'; ?></code></p>
<p>$lastBlockSize = <code><?php echo $lastBlockSize; ?></code></p>
<p>$Recycle = <code><?php echo '[' . strlen($Recycle) . '] ' . strToHex( $Recycle); ?></code></p>
<p>$recon X[0..N-3] = <code><?php echo '[' . strlen($reconUpToX_N_3) . '] ' . strToHex( $reconUpToX_N_3); ?></code></p>
<p>$Steal = <code><?php echo '[' . strlen($Steal) . '] ' . strToHex( $Steal); ?></code></p>
<p>$Mix = <code><?php echo '[' . strlen($Mix) . '] ' . strToHex( $Mix); ?></code></p>
<p>$recon X[0..N-2] = <code><?php echo '[' . strlen($reconUpToX_N_2) . '] ' . strToHex( $reconUpToX_N_2); ?></code></p>
<p>$recon X[N-1] = <code><?php echo '[' . strlen($reconX_N_1) . '] ' . strToHex( $reconX_N_1); ?></code></p>
<p>Reconstructed plaintext as hex is...</p>
<code><?php echo '[' . strlen($recon) . '] ' . expandWithWhiteSpace( strToHex( $recon)); ?></code>
<?php } ?>
</body> 
</html> 
```

**... 这是一个匹配的 Delphi 程序，用于为前面的 PHP 网页生成密文消息，用于测试和演示目的。（不包括 DFM 文件）...**

```
unit umfmDelphi_to_PHP_Symetric;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ActnList, StdCtrls, uTPLb_Codec, uTPLb_BaseNonVisualComponent,
  uTPLb_CryptographicLibrary, ExtCtrls;

type
  TmfmDelphi_to_PHP_Symetric = class(TForm)
    rgTestVectors: TRadioGroup;
    rgChainMode: TRadioGroup;
    edtPassword: TEdit;
    memoPlaintext: TMemo;
    lblPassword: TLabel;
    lblPlaintext: TLabel;
    cryptoMain: TCryptographicLibrary;
    codecAES: TCodec;
    memoOutput: TMemo;
    btnEncrypt: TButton;
    actlstMain: TActionList;
    actEncrypt: TAction;
    edtSeed: TEdit;
    lblSeed: TLabel;
    btnRandomize: TButton;
    actRandomize: TAction;
    rgCipher: TRadioGroup;
    procedure actEncryptUpdate(Sender: TObject);
    procedure actEncryptExecute(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure rgTestVectorsClick(Sender: TObject);
    procedure rgChainModeClick(Sender: TObject);
    procedure actRandomizeUpdate(Sender: TObject);
    procedure actRandomizeExecute(Sender: TObject);

  private
    procedure LogFmt( const sLine: string; const Args: array of const);
    function  SpaceOut( const sCompacted: string): string;

  public
    { Public declarations }
  end;

var
  mfmDelphi_to_PHP_Symetric: TmfmDelphi_to_PHP_Symetric;

implementation

uses uTPLb_Random, uTPLb_StreamUtils, uTPLb_Constants;

{$R *.dfm}

function StreamToHex( Data: TStream): string;
var
  b: byte;
  sByte: string;
begin
Data.Position := 0;
result := '';
while Data.Read( b, 1) = 1 do
  begin
  sByte := Format( '%x', [b]);
  if Odd( Length( sByte)) then
    sByte := '0' + sByte;
  result := result + sByte
  end
end;

procedure TmfmDelphi_to_PHP_Symetric.actEncryptExecute( Sender: TObject);
const
  TestCaseNames: array[0..2] of string = ('Test Vector 1', 'Test Vector 2', 'Custom');
var
  usPlaintext: UTF8String;
  aCiphertext: ansistring;
  OriginalSeed: int64;
  stmCipher: TStream;
  sHex: string;
begin
memoOutput.Clear;
case rgCipher.ItemIndex of
  0:   codecAES.BlockCipherId := Format( AES_ProgId, [128]);
end;
case rgChainMode.ItemIndex of
  0:   codecAES.ChainModeId := CFB_ProgId;
  1:   codecAES.ChainModeId := CBC_ProgId;
  2:   codecAES.ChainModeId := ECB_ProgId;
  end;
codecAES.UTF8Password := edtPassword.Text;
usPlaintext := memoPlaintext.Lines.Text;
OriginalSeed := StrToInt64( edtSeed.Text);
TRandomStream.Instance.Seed := OriginalSeed;
codecAES.EncryptAnsiString( usPlaintext, aCiphertext);
// NextSeed := TRandomStream.Instance.Seed;
LogFmt( 'Test case = %s', [TestCaseNames[rgTestVectors.ItemIndex]]);
LogFmt( 'Cipher = %s', [codecAES.Cipher]);
LogFmt( 'Chain mode = %s', [codecAES.ChainMode]);
LogFmt( 'PRNG seed = %d', [OriginalSeed]);
LogFmt( 'Passord (UTF-8) = ''%s''', [codecAES.UTF8Password]);

LogFmt( '------------', []);
stmCipher := TMemoryStream.Create;
codecAES.Key.SaveToStream( stmCipher);
sHex := StreamToHex( stmCipher);
stmCipher.Free;
LogFmt( 'key as hex = %s', [sHex]);
LogFmt( 'Plaintext (UTF-8)', []);
LogFmt( '''%s''', [usPlaintext]);
LogFmt( '------------', []);
LogFmt( 'ciphertext (base64) [Includes prepended IV and block quantisation] =', []);
LogFmt( ' ''%s''', [ SpaceOut( aCiphertext)]);
LogFmt( '------------', []);
stmCipher := TMemoryStream.Create;
Base64_to_stream( aCiphertext, stmCipher);
sHex := StreamToHex( stmCipher);
stmCipher.Free;
LogFmt( 'ciphertext (hex) [Includes prepended IV and block quantisation] =', []);
LogFmt( ' ''%s''', [ SpaceOut( sHex)]);
LogFmt( '------------', []);
end;

procedure TmfmDelphi_to_PHP_Symetric.actEncryptUpdate( Sender: TObject);
begin
//
end;

procedure TmfmDelphi_to_PHP_Symetric.actRandomizeExecute(Sender: TObject);
begin
TRandomStream.Instance.Randomize;
edtSeed.Text := IntToStr( TRandomStream.Instance.Seed)
end;

procedure TmfmDelphi_to_PHP_Symetric.actRandomizeUpdate(Sender: TObject);
begin
(Sender as TAction).Enabled := rgTestVectors.ItemIndex = 2
end;

procedure TmfmDelphi_to_PHP_Symetric.FormCreate( Sender: TObject);
begin
memoOutput.Clear;
LogFmt( 'Select test case and chain mode.', []);
LogFmt( 'Enter password and plaintext message and then press the ''Encrypt'' button.', []);
end;

procedure TmfmDelphi_to_PHP_Symetric.LogFmt(
  const sLine: string; const Args: array of const);
begin
memoOutput.Lines.Add( Format( sLine, Args))
end;

procedure TmfmDelphi_to_PHP_Symetric.rgChainModeClick( Sender: TObject);
begin
//
end;

procedure TmfmDelphi_to_PHP_Symetric.rgTestVectorsClick( Sender: TObject);
var
  isCustom: boolean;
begin
case rgTestVectors.ItemIndex of
  0:   begin
       edtPassword.Text := 'Your lips are smoother than vasoline.';
       memoPlaintext.Lines.Text := 'Leeeeeeeeeroy Jenkins!';
         // Above is constrained to:
         //  More than 16 and not a whole multiple of 16 bytes as UTF-8.
       edtSeed.Text := '1';
       rgChainMode.ItemIndex := 0;
       rgCipher.ItemIndex := 0;
       end;
  1:   begin
       edtPassword.Text := 'ORATIO IN L. CATILINAM PRIMA';
       memoPlaintext.Lines.Text := 'Quo usque tandem abutere, Catili';
         // Above is constrained to:
         //  A whole multiple of 16 bytes as UTF-8, excluding the empty case.
       edtSeed.Text := '333';
       rgChainMode.ItemIndex := 0;
       rgCipher.ItemIndex := 0
       end;
  2:   ;
  end;
isCustom := rgTestVectors.ItemIndex = 2;
edtPassword.ReadOnly := not isCustom;
memoPlaintext.ReadOnly := not isCustom;
edtSeed.ReadOnly := not isCustom;
rgChainMode.Enabled := isCustom;
rgCipher.Enabled := isCustom
end;

function TmfmDelphi_to_PHP_Symetric.SpaceOut( const sCompacted: string): string;
const
  NewLineSpacing = 70;
  BunchSpacing = 6;
var
  i, j: integer;
begin
SetLength( result, 2 * Length( sCompacted));
i := 1;
for j := 1 to Length( sCompacted) do
  begin
  if ((j mod NewLineSpacing) = 1) and (j <> 1) then
      begin
      result[i] := #13;
      Inc( i);
      result[i] := #10;
      Inc( i)
      end
    else if ((j mod BunchSpacing) = 1) and (j <> 1) then
      begin
      result[i] := ' ';
      Inc( i)
      end;
  result[i] := sCompacted[j];
  Inc( i)
  end;
SetLength( result, i - 1)
end;

end. 
```

# c# - 使用 minolta bizhub 以编程方式发送传真

> ID：13534362
> 
> 赞同：0
> 
> 时间：2012-11-23T18:45:06.873
> 
> 标签：c#, .net, driver, fax

办公室最近买了一台能传真的美能达打印机。我需要从 sharepoint 的输入发送传真。问题不在于传真发送软件和共享点之间的连接，而在于尝试将正确的数据发送到传真。

Minolta 为发送传真创建了驱动程序，这是一个截图。

通过尝试打印然后选择 minolta bizhub 作为传真来访问它。

![在此处输入图像描述](../Images/7e61ffdd670bbeef4f9370f6d6e83f08.png)

如果它是传真服务器，我尝试使用 FAXCOMLib 作为连接它，但尝试连接时出现错误。我打电话给美能达的支持服务，他们不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:18:29.633

FAXCOMLib 可在没有外部设备的 Windows 计算机上用作传真驱动程序。传真逻辑内置于软件中。计算机中只需要一个 RJ11 端口，一个电话端口。

我会说，如果您想以编程方式发送传真，只需使用 FaxComLib 而不必担心外部支持传真的打印机。使用 .NET/C# 中的 FaxComLib 非常简单。

也可能有一种以编程方式调用打印机驱动程序的方法。事实上，我知道你可以在 WCF 中做到这一点。另一方面，这不会通过 FaxComLib；它可能会通过其他接口，或者在最后的手段，它会通过 Windows 中的 UI 自动化类。

# android - 获取软键盘的尺寸

> ID：13534365
> 
> 赞同：32
> 
> 时间：2012-11-23T18:45:19.110
> 
> 标签：android, keyboard, cocos2d-x

有没有办法知道屏幕上显示的键盘的大小？

我正在使用Cocos2dx进行编程，但是我想知道Android部分或Cocos部分的屏幕显示的键盘高度，没关系。

我知道 Keyboard 有一个 getHeight() 方法，但我不想创建新键盘，我想使用默认键盘。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-04T00:45:35.513

我们这样做了

```
myLayout.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {

                @Override
                public void onGlobalLayout() {

                    Rect r = new Rect();
                    parent.getWindowVisibleDisplayFrame(r);

                    int screenHeight = parent.getRootView().getHeight();
                    int heightDifference = screenHeight - (r.bottom - r.top);
                    Log.d("Keyboard Size", "Size: " + heightDifference);

                }
            }); 
```

我们只用键盘调整视图大小，所以我们可以使用它。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-02-01T12:24:03.563

```
Rect r = new Rect();
View rootview = this.getWindow().getDecorView(); // this = activity
rootview.getWindowVisibleDisplayFrame(r); 
```

其结果是您的应用程序在屏幕上使用的空间量（即使**未**调整活动大小也可以工作）。显然剩余的屏幕空间将被键盘使用（如果它可见）

在这里找到 id：[https ://github.com/freshplanet/ANE-KeyboardSize/blob/master/android/src/com/freshplanet/ane/KeyboardSize/getKeyboardY.java](https://github.com/freshplanet/ANE-KeyboardSize/blob/master/android/src/com/freshplanet/ane/KeyboardSize/getKeyboardY.java)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-10T03:43:11.397

如果您的活动不是全屏，请使用以下代码：

```
content.getViewTreeObserver().addOnGlobalLayoutListener(
            new ViewTreeObserver.OnGlobalLayoutListener() {

                @Override
                public void onGlobalLayout() {
                    // TODO Auto-generated method stub
                    if (keyBoardHeight <= 100) {
                        Rect r = new Rect();
                        content.getWindowVisibleDisplayFrame(r);

                        int screenHeight = content.getRootView()
                                .getHeight();
                        int heightDifference = screenHeight
                                - (r.bottom - r.top);
                        int resourceId = getResources()
                                .getIdentifier("status_bar_height",
                                        "dimen", "android");
                        if (resourceId > 0) {
                            heightDifference -= getResources()
                                    .getDimensionPixelSize(resourceId);
                        }
                        if (heightDifference > 100) {
                            keyBoardHeight = heightDifference;
                        }

                        Log.d("Keyboard Size", "Size: " + heightDifference);
                    }
                    // boolean visible = heightDiff > screenHeight / 3;
                }
            }); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-22T07:10:56.007

如果您想在活动大小不变的情况下计算虚拟键盘高度（adjustPan），那么您可以使用以下示例：

[https://github.com/siebeprojects/samples-keyboardheight](https://github.com/siebeprojects/samples-keyboardheight)

它使用隐藏窗口来计算窗口和活动的根视图之间的高度差。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-06-10T19:37:28.577

你说不出来。不，真的：你根本无法分辨。

键盘不需要是任何特定的形状。它不必放在屏幕底部（[许多](http://www.fixedbyvonnie.com/wp-content/uploads/2013/09/fixedbyvonnie-galaxy-s4-floating-keyboard.png)最[流行](http://www.mobilevillage.com/wp-content/uploads/2013/11/SwiftKey-floating-keyboard.jpg)的选项[不是](http://octoba.jp/wp-content/uploads/2013/09/com.justsystems.atokmobile.service.png)），当您更改文本字段时，它不必保持其当前大小（根据标志几乎没有）。它甚至不必是[矩形](https://lh5.ggpht.com/LrJXz8w0yS7xfWocU2dgpeRm63tB-2Y3-JdBZ7tkRPxSoziLqEckAPnfYa5kiZwL44o=h900)的。它也可能只是接管[整个屏幕](http://developer.android.com/reference/android/inputmethodservice/InputMethodService.html#FullscreenMode)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-01-12T00:25:01.253

我知道这是一篇旧帖子，但我注意到为我选择的解决方案不适用于所有设备。似乎存在差异，所以我实现了这个，它似乎是一个包罗万象的：

```
 final int[] discrepancy = new int[1];
        discrepancy[0] = 0;

        // this gets the height of the keyboard
        content.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {

            @Override
            public void onGlobalLayout() {
                Rect r = new Rect();
                View rootview = activity.getWindow().getDecorView(); // this = activity
                rootview.getWindowVisibleDisplayFrame(r);

                int screen_height = rootview.getRootView().getHeight();
                int keyboard_height = screen_height - (r.bottom + r.top) - discrepancy[0];

                if (discrepancy[0] == 0) {
                    discrepancy[0] = keyboard_height;
                    if (keyboard_height == 0) discrepancy[0] = 1;
                }

                int margin_bottom = keyboard_height + Helper.getDp(10, activity);

                RelativeLayout.LayoutParams params = (RelativeLayout.LayoutParams) carousel_container.getLayoutParams();
                params.setMargins(0, 0, 0, margin_bottom);

                //boolean visible = heightDiff > screenHeight / 3;
            }
        }); 
```

当第一次调用监听器时，它会在没有键盘的情况下测量屏幕，如果存在差异，我会在下一次考虑它。如果没有差异，我将差异设置为 1，这样它就不再是 0。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-05T06:14:15.873

在 cocos2d-x 中我们有 CCEditBox。

在 Extensions->GUI->CCEditBox 中，您可以找到 CCEditBox 类。

美妙之处在于它隐藏了在现场其他地方敲击的键盘。并自动向上移动键盘，以防您的编辑框在场景中放置得太低。

如果您使用的是 cocos2d-x v2.1.3，那么您可以导航到示例项目，方法是转到

samples->cpp->TestCpp->Classes->ExtensionTest->EditBoxTest。

从现在开始，我将使用它而不是 CCTextField。昨天刚遇到：）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-07-14T15:22:50.680

2020年后，如果你的min SDK大于等于**21**，你可以通过以下函数查看IME的可见性和高度：

```
fun isKeyboardVisible(attachedView: View): Boolean {
    val insets = ViewCompat.getRootWindowInsets(attachedView)
    return insets?.isVisible(WindowInsetsCompat.Type.ime()) ?: false
}

fun getKeyboardHeight(attachedView: View): Int {
    val insets = ViewCompat.getRootWindowInsets(attachedView)
    return insets?.getInsets(WindowInsetsCompat.Type.ime())?.bottom ?: 0
} 
```

参考：[动画键盘（第 1 部分）。用于检查…的新 WindowInsets API 通过克里斯班斯 | 安卓开发者 | 中等的](https://medium.com/androiddevelopers/animating-your-keyboard-fb776a8fb66d)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-21T07:11:43.877

**经过数小时的搜索，如果您想设置**，我找到了解决方案**`windowSoftInput="adjustPan"`**

这是代码片段：

```
 final View root  = findViewById(android.R.id.content);
    root.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
    Rect r = new Rect();
    {
        root.getWindowVisibleDisplayFrame(r);
    }
    @Override
    public void onGlobalLayout() {
        Rect r2 = new Rect();
        root.getWindowVisibleDisplayFrame(r2);
        int keyboardHeight = r.height() - r2.height();
        if (keyboardHeight > 100) {
            root.scrollTo(0, keyboardHeight);
        }
        else {
            root.scrollTo(0, 0);
        }
    }
}); 
```

在此代码中，在找到键盘高度后，我将视图向上滚动到键盘未覆盖，这是查找键盘高度的主要原因。

根据[文档](https://developer.android.com/reference/android/view/View.html)：

`void getWindowVisibleDisplayFrame(Rect outRect)`：*检索此视图附加到的窗口所在的整体可见显示大小。*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-04T11:21:41.863

android 显示屏幕的 ROOT_VIEW 可以被可视化为单个屏幕视图，其中包含显示活动视图的 VISIBLE DISPLAY FRAME。

当软键盘在屏幕上显示或隐藏时，会调整此可见显示框架。

**注意：**请通过单击下面给出的链接查看这两个图像以更好地理解

因此，显示屏的 ROOT VIEW 可以可视化为： [显示屏的 RootView](http://i.stack.imgur.com/j2zpN.png)

VISIBLE DISPLAY FRAME 随着 SOFT KEYBOARD 的打开和关闭的调整可视化为： [VISIBLE_DISPLAY_SCREEN 调整](http://i.stack.imgur.com/OGDJ9.png)

VISUAL DISPLAY FRAME 的这种调整可以很好地用于找出键盘的高度：

*（软键盘打开时）*

SOFT_KEYBOARD_HEIGHT = ROOT_VIEW_HEIGHT - (VISUAL_DISPLAY_FRAME_HEIGHT + EXTRA_SCREEN_HEIGHT)

实现上述的代码是：

```
int mExtraScreenHeight=-1, mKeyboardHeight=-1;
boolean mKeyboardOpen;

    rootView.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {

            int rootViewHeight, visibleDisplayFrameHeight, fakeHeight;

            /* (rootViewHeight - visibleDisplayFrameHeight) is not the real height of the keyboard
                it is the fake height as it also consist of extra screen height
                so FAKE_HEIGHT = KEYBOARD_HEIGHT + EXTRA_SCREEN_HEIGHT

                To get keyboard height extra screen height must be removed from fake height
             */

            Rect rect = new Rect();
            rootView.getWindowVisibleDisplayFrame(rect);

            rootViewHeight = rootView.getRootView().getHeight();
            visibleDisplayFrameHeight = rect.height();

            fakeHeight = rootViewHeight-visibleDisplayFrameHeight;

            if (mExtraScreenHeight == -1){
                mExtraScreenHeight=fakeHeight;
            }
            /* Suppose the soft keyboard is open then the VISIBLE_DISPLAY_FRAME is in reduced size
                due to the space taken up by extra screen and the keyboard but when the soft keyboard closes
                then KEYBOARD_HEIGHT=0 and thus FAKE_HEIGHT = EXTRA_SCREEN_HEIGHT
             */
            else if (fakeHeight <= mExtraScreenHeight){
                mExtraScreenHeight=fakeHeight;
                mKeypadOpen=false;
            }
            else if (fakeHeight > mExtraScreenHeight){
                mKeypadHeight=fakeHeight-mExtraScreenHeight;
                mKeypadOpen=true;
            }
        }
    }); 
```

**注意**： onGlobalLayout() 函数只会在全局布局发生变化时调用，比如软键盘打开时。所以软键盘必须至少打开一次才能获得软键盘高度。

它对我有用；）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-12-21T20:03:35.910

抱歉无法发表评论，其中两个或三个答案帮助我解决了我的问题，它们与使用 AddOnGlobalLayoutListener 然后确定键盘出现前后的剩余高度有关。

我使用的解决方案基于 Rudy_TM 的回答。

但是，我必须找到的一件事是，为了使该方法起作用，您必须在某处具有以下行

```
Window.SetSoftInputMode(SoftInput.AdjustResize); 
```

在我有 SoftInput.AdjustNothing （或类似的东西）之前，它不起作用。现在它完美无缺。感谢您的回答！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-24T04:59:21.620

完整的答案并为我完美工作：

```
 Rect r = new Rect();
  View rootview = this.getWindow().getDecorView(); // this = activity
  rootview.getWindowVisibleDisplayFrame(r);
  int keyboardHeight = rootview.getHeight() - r.bottom; 
```

# jquery - 基于元素可见性的功能不起作用？

> ID：13534366
> 
> 赞同：1
> 
> 时间：2012-11-23T18:45:18.933
> 
> 标签：jquery, css, if-statement

我正在尝试根据单击另一个元素时元素是否可见来运行两组不同的函数。这是整个功能：

```
$('#grid').click(function() {
  if('#photo_grid:hidden') {
    $('#grid').addClass('active').removeClass('fadein');
    $('.cycle-slideshow').fadeTo('fast',0.3);
    $('#photo_grid').fadeIn('slow');
  } else {
    $('#grid').addClass('fadein').removeClass('active');
    $('#photo_grid').fadeOut('fast');
    $('.cycle-slideshow').fadeTo('slow',1.0);
  }
}); 
```

这会导致根据需要在第一次单击时 添加/删除类`#grid`并淡化到 30%。但是，不会淡入，因此后续的点击会失败。谁能建议这可能是为什么？`.cycle-slideshow``#photo_grid`

Page is live [here](http://new.element17.com)，`#grid`按钮位于最右下方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:04:43.213

您的问题`if`是您正在有效地测试字符串的存在，而您*要做*的是响应元素的可见性。因此，我建议：

```
if ($('#photo_grid:hidden').length) 
```

或者：

```
if ($('#photo_grid').is(':hidden')) 
```

`.length`检查确保选择器返回一个或多个项目（因为 jQuery总是*返回*一个数组（即使它是一个*空*数组），而该`is()`方法返回一个布尔值以反映元素匹配或不匹配，由选择器传递给方法。

参考：

*   [`is()`](http://api.jquery.com/is/).

# android - 如何让Android富文本编辑器正确编译？

> ID：13534367
> 
> 赞同：1
> 
> 时间：2012-11-23T18:45:21.983
> 
> 标签：android

我从以下位置下载了富文本编辑器的源代码：

[http://code.google.com/p/android-richtexteditor/](http://code.google.com/p/android-richtexteditor/)

并且代码将无法正确编译。我得到的错误是：

```
"Unable to resolve target 'android-4'", 

"AndroidManifest.xml file missing!", and in the Html.java file there are 2 errors involving; 

"The import org.ccil cannot be resolved" 
```

当您下载文件时，您需要下载源代码的第 4 版，因为最新版本的源代码已被删除。我正在使用 Eclipse 版本 4.2.0、Android SDK Manager Revision 20。我已经安装了 API 版本 4.0、4.1 和许多附加功能。我很确定我下载了 eclipse 的“经典”版本。我怀疑这些错误有两个原因，并希望输入。关于这个项目和一般错误的其他线程没有帮助，因为至少有一个线程排名最高的答案实际上是不正确的。此外，提出的说明不适用于我的 eclipse 版本，或者不完整。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:00:19.457

> “无法解析目标‘android-4’”

该项目被设置为针对 API 级别 4 (Android 1.6) 构建，并且您的开发机器上没有该 SDK。

> “AndroidManifest.xml 文件丢失！”

这应该是不言自明的。

> “无法解析导入 org.ccil”

这表明缺少类，或者可能对代码进行了不完整的重构。

考虑到这段代码在两年多的时间里没有得到很好的维护，我建议你考虑一些更现代的东西。例如，我正在开发[一个`RichEditText`小部件](https://github.com/commonsguy/cwac-richedit)来填补相同的角色。

# jquery - 我的隐藏页面内容是否对搜索引擎不可见？

> ID：13534368
> 
> 赞同：1
> 
> 时间：2012-11-23T18:45:31.937
> 
> 标签：jquery, seo

如果我使用 CSS 隐藏多页文章的第 x 页，使用“显示：无；” 然后 jQuery/javascript 在点击时显示它，搜索机器人会忽略以前隐藏在其他页面中的内容还是包含它？

**缩短示例：**

```
<div id="displayed_page">
        [page 1 is here first],  [page 2 onclick], [etc...]
</div>

<div id="page1" style="display: none;">
        first part of content that needs to be indexed
        <button id="clicker" onclick="nextpage();">click me</button>
</div>
<div id="page2" style="display: none;">
        second part of content that also needs to be indexed
        <button id="clicker" onclick="nextpage();">click me</button>
</div>
<div id="page3" style="display: none;">
        third part, et cetera... 
        <button id="clicker" onclick="nextpage();">click me</button>
</div> 
```

请不要将我指向谷歌网站管理员工具，我去过那里。我也不想以任何方式欺骗。基本上，我为 Wordpress 制作了一个分页插件，我希望对隐藏的内容进行索引。会吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:47:14.657

**是**的，机器人不*看*网页，他们阅读源代码。

您已将 CSS 属性应用于特定元素的事实对机器人没有任何影响。

* * *

例如，谷歌会惩罚隐藏内容的唯一情况是，添加内容纯粹是为了帮助提高排名：

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=66353](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=66353)

在搜索引擎意识到这一点之前，一些网页设计师会在页面底部添加大量逗号分隔的关键字，以便机器人阅读它，并假设它是相关内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T12:03:17.957

有各种各样的搜索机器人，它们的行为都不同。

那么让我们问一个问题：搜索引擎用户登陆您的页面以获取不可见的关键字是否有用？我不这么认为。当良好的搜索引擎无法链接到包含相关内容的页面（或在您的情况下为部分）时，它们不会将您的页面作为结果提供。

所以有两种变体：

*   使用单独的 URL，以便搜索引擎可以链接准确的结果
*   不要为没有 JavaScript 的用户/机器人隐藏内容

我不知道你为什么要实现这样的分页功能，但我会假设你有你的理由。所以关于第二个变体：

您`display:none;`最初设置，并提供一个 JavaScript 导航来取消隐藏它。如果（CSS 解析）搜索引擎机器人或未激活 JS 的用户访问您的页面，他们看不到全部内容，也没有机会进入其他部分。

因此，您最初应该让所有部分都可见，并且只有在访问者激活了 JS 时，才隐藏其他部分并提供 JS 导航来显示它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:13:24.423

搜索引擎机器人将*读取*您的 HTML 网页的所有内容，但该内容不会用于您的页面排名。

但是，如果您试图向用户隐藏您的内容，例如使用与页面背景相同的字体颜色，那么他们可能会从索引中删除您的网站，因为用户没有获得正确的内容。

# graph - 我可以在无向图中遍历每个节点恰好一次的最大节点数是多少？

> ID：13534372
> 
> 赞同：0
> 
> 时间：2012-11-23T18:45:50.830
> 
> 标签：graph, tree, nodes, traversal, graph-traversal

所以我有一个无向无权图。它*包含*循环。我想*找到访问最多节点而不重复访问任何节点的路径*。由于这是一个图遍历，你可以在任何你喜欢的节点开始和结束。

**背景研究：** 我看过旅行商问题（TSP）；这个问题是不同的，不允许你从你开始的地方完成并且没有重量。我查看了其他几种算法，但没有发现适合这个问题的算法。

**Graph Size：图**中有100个节点；有 10 个断开连接的节点。

**更新：**我已将此移至：[https ://math.stackexchange.com/questions/243375/what-is-the-maximum-number-of-nodes-i-can-traverse-in-an-undirected-graph-访问i](https://math.stackexchange.com/questions/243375/what-is-the-maximum-number-of-nodes-i-can-traverse-in-an-undirected-graph-visiti)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:07:50.383

Look for the Hamiltonian Cycle problem

[http://en.wikipedia.org/wiki/Hamiltonian_cycle](http://en.wikipedia.org/wiki/Hamiltonian_cycle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T10:28:19.997

您应该查看具有非循环图算法的[维基百科条目。](http://en.wikipedia.org/wiki/Longest_path_problem)您的图表有循环，这使您的问题 NP-hard。

我会尝试创建一个 DAG，其中的节点代表强连接的组件。然后你至少可以找到访问最强连接组件的路径。然后，您可以通过用每个子图中最长的路径替换单个（强连接组件）节点来扩展该路径。

在子图中找到最长的路径现在与您的原始问题相同，但至少您的图更小。如果你幸运的话，子问题很容易并且你完成了。在一般情况下，它们可能不会那么小，您可以使用一些高级启发式方法。也许看看[这篇论文](http://www.combinatorialmath.ca/G&G/articles/longpath.pdf)或[这个问题](https://stackoverflow.com/questions/2679081/how-do-find-the-longest-path-in-a-cyclic-graph-between-two-nodes)（你可以使用那里的答案来完全解决你的问题，但我不确定）

# java - 设计模式 - 事件或直接引用

> ID：13534382
> 
> 赞同：0
> 
> 时间：2012-11-23T18:46:49.040
> 
> 标签：java, oop, events, design-patterns, loose-coupling

假设我们有一个使用 MVP 设计的 Java 应用程序，其页面显示一些独立的模块。除其他外，我们将考虑应用程序中的两个独立 MVP 模块。应用程序中有一项功能需要上述模块进行通信。这些模块提供专门用于该功能的接口 (API) A 和 B。还有管理器 (M) 来处理此功能的逻辑。管理器可以遍历（或使用某些上下文）页面来获取对应该参与所考虑功能的模块的引用。

下面的 Manager 代码片段展示了我正在考虑的方法：

1.  通过 EventBus 使用异步事件

    ```
    eventBus.addHandler(Event.CHECK_A_IS_OK, new CheckAIsOkHandler(Event e){
        eventBus.fireEvent(Event.DO_SOMETHING_ON_B, e.getValue();
    });
    eventBus.fireEvent(Event.CHECK_A_IS_OK); 
    ```

2.  使用直接引用

    ```
    A a;
    B b;

    void findModules(){
        a = context.findA();
        b = context.findB();
    }

    ...

    if (a.check()){
        b.doSomething(B.getValue());
    } 
    ```

问题是：

可以使用 EventBus 进行对象之间的常规通信（检查条件、返回值等）吗？或者最好只将事件模式用于真实事件（我的意思是通知订阅者发生了某些事情）？遵循第二种方法是否反对松耦合？也许其他一些模式会更合适？

直觉上，第二种方法对我来说更干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:01:52.200

我认为这一切都归结为您试图在代码方面实现的目标:) 而不是功能，因为两种方式都有效:)。对我来说，第二个方法是干净和精益，它说明了需要什么。它可能不是松散耦合的代码，而是干净而明显的，我认为这是第二种方法的附加值:)。

# django - Django忽略url参数中的字符

> ID：13534383
> 
> 赞同：0
> 
> 时间：2012-11-23T18:46:52.673
> 
> 标签：django, django-urls

嗨，我有一个这样的 url 模式：

```
url(
    r'^project_info/(?P<product>\w+)/$',
    'tool.views.ProjectInfo',
    name='project_info'
), 
```

这适用于普通字符串，但如果我想捕获像“我的产品”这样的东西，它会失败。

我试过像这样逃避破折号：

```
url(
    r'^project_info/(?P<product>\-\w+)/$',
    'tool.views.ProjectInfo',
    name='project_info'
), 
```

但没有快乐。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T18:54:22.523

这应该适合你

```
url(
    r'^project_info/(?P<product>[-\w]+)/$',
    'tool.views.ProjectInfo',
    name='project_info'
), 
```

# php - Zend 框架 - sendResponse 优于普通回声的好处

> ID：13534384
> 
> 赞同：-3
> 
> 时间：2012-11-23T18:46:53.080
> 
> 标签：php, zend-framework, zend-framework2

在 zend 框架中发送 ajax 响应时，使用 Zend_Controller_Request_Http 对象并设置正文然后发送响应而不是简单的 echo 语句有什么好处。

例如：

```
$response->setBody('content');

//somewhere later in the application
$response->sendResponse(); 
```

相对

```
echo 'content'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:05:24.903

使用响应对象而不是直接输出对于良好的应用程序设计至关重要。
例如，考虑您想要在输出中引入某种后处理的情况，可能会使用证书对其进行签名：
您只需在应用程序中的某个点附加侦听器，您所关心的只是响应对象，不需要思考如何捕捉应用程序中某处回显的输出

实际上有很多理由使用它，几乎没有理由不使用它。
最明显的是，您可以在应用程序的任何位置附加或更改标题。
最重要的是，它使您可以灵活地处理输出。

注意：我想为后面的观众澄清一下：没有必要设置并立即发送 Response 对象内容，它通常会在整个应用程序中携带，并且调用 sendResponse() 是请求生命周期中的最新动作之一。

# javascript - 我如何在此语句中添加另一个不等于（！=）？

> ID：13534389
> 
> 赞同：-1
> 
> 时间：2012-11-23T18:47:09.383
> 
> 标签：javascript, if-statement, equals, key-value

如何在此语句中添加另一个不等于 (!=) 值？

```
if ($(this).data("increase_priority1") && $(this).val() != 1) 
```

我尝试在确定它是否相等的函数开头反转语法，但这阻止了它完全删除项目（包括那些不等于 1 的项目）

```
if ($(this).data("increase_priority1") && $(this).val() != 1 && $(".complaint select").val() != "Too_small") 
```

当用户同时选择投诉并对问题的重要性级别进行排序时，此函数会从“increase_priority1”中添加和/或删除值，我需要它来更改值（在这种情况下是投诉）和重要性级别（即 increase_priority1) 如果这两个字段中的任何一个发生变化。目前，它仅在重要性级别发生变化时才会发生变化。

完整的功能是：

```
var $increase_priority1 = $(".increase_priority1");
$('.ranking, .complaint select').dropkick({
change: function () {
    var name = $(this)
        .data("name"); //get priority name
    if ($(".complaint select")
        .val() === "Too_small" && $(this)
        .val() == 1 && !$(this)
        .data("increase_priority1")) {
        //rank is 1, and not yet added to priority list
        $("<option>", {
            text: name,
            val: name
        })
            .appendTo($increase_priority1);
        $(this)
            .data("increase_priority1", true); //flag as a priority item
    }
    if ($(this)
        .data("increase_priority1") && $(this)
        .val() != 1) {
        //is in priority list, but now demoted
        $("option[value=" + name + "]", $increase_priority1)
            .remove();
        $(this)
            .removeData("increase_priority1"); //no longer a priority item
    }
}
}); 
```

小提琴在上下文中显示了这一点：http: [//jsfiddle.net/chayacooper/vWLEn/132/](http://jsfiddle.net/chayacooper/vWLEn/132/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:57:43.903

当至少一个操作数为真（可能两者都为真！）时，或运算为真。你的陈述应该是：

```
if ($(this).data("increase_priority1") && 
    ($(this).val() != 1 || $(".complaint select").val() != "Too_small")). 
```

`||`是 OR 的 Javascript 语法。

这将运行`if`if `.data("increase_priority1")`is true **and** `$(this).val() != 1` **or** `$(".complaint select").val() != "Too_small")` is true。

请注意，如果第一部分`&&`为假，解释器将停止，也就是说：它甚至不会看第二部分。的情况相同`||`，但反过来，所以如果 的第一部分`||`为真，则不会查看第二部分。

# linux - 多线程程序中的内核模式

> ID：13534391
> 
> 赞同：1
> 
> 时间：2012-11-23T18:47:33.793
> 
> 标签：linux, unix

如果进程中的线程进行系统调用，那么在单线程进程中，进程将切换到内核模式。但是在多线程进程的情况下会怎样？换句话说，如果进程中的线程进行系统调用，那么包含该线程的进程的模式是什么——内核模式/用户模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T23:14:02.130

在 Linux 中，线程只是碰巧与其他几个进程（同一进程中的其他线程）共享内存的进程。

因此，在系统调用期间，CPU 将处于系统模式，但是当其时间片到期时，执行仍会切换到其他线程或进程，就像即使当前正在运行的进程正在执行系统调用，它通常也会从进程切换到进程一样。

# java - Java RCP 插件和产品项目

> ID：13534392
> 
> 赞同：0
> 
> 时间：2012-11-23T18:47:35.603
> 
> 标签：java, eclipse

一家公司（在我的镇上）为学生开设了“免费 Java 培训”。我们正在和eclipse一起工作，今天项目经理给了我一个新项目（表格，数据和操作），因为我已经完成了他给的教程。我正在学习 Java 两个星期，现在我迷路了。我不知道从哪里开始或做什么。我已经学习并制作了 SWT 对象，我知道并学习了 OOP 的概念，但我不知道我们所学的与我们应该做什么之间的关系。我知道什么是 Display、Shell、Dialog，但现在我不知道从哪里开始。

项目经理说我必须创建一个新的插件项目，而不是一个带视图的新产品项目。有没有搞错？！一个产品？我该怎么办？我应该在哪里启动主要课程。显示和外壳类？

任何人都可以发布教程（只有 SWT 没有 JFace）和示例的链接吗？我已经进行了搜索，但这些示例是使用 IBM 和其他包含的软件包。我不能使用它们。我需要使用标准小部件。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:08:09.207

我建议你阅读下面的书。它可以帮助您入门

[http://www.amazon.com/gp/product/0321603788?ie=UTF8&tag=eclipsercp-20&linkCode=as2&camp=1789&creative=390957&creativeASIN=0321603788](https://rads.stackoverflow.com/amzn/click/com/0321603788)

# mysql - MySQL 与 NULL 值相关的唯一键与主键

> ID：13534393
> 
> 赞同：0
> 
> 时间：2012-11-23T18:47:39.430
> 
> 标签：mysql

我在设置数据库时注意到了一些事情，并想与所有聪明人确认！

我有一列需要接受`NULL`值，所以我`NULL`在易于使用的 PHPMyAdmin 界面中选中了复选框。简单的。

当我添加唯一索引时，一切都很好。但是，当我将该唯一索引更改为主键（也是唯一的）时，它会删除 NULL 选项。

为什么会这样，这是预期的行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:49:34.747

这是意料之中的。如[手册](http://dev.mysql.com/doc/refman/5.5/en/create-table.html#id1011362)中所述，PRIMARY KEY 不能接受 NULL：

> PRIMARY KEY 是一个唯一索引，其中所有键列都必须定义为 NOT NULL。

# node.js - 查看 node.js 聊天应用中的用户是否有匹配的消息

> ID：13534400
> 
> 赞同：0
> 
> 时间：2012-11-23T18:48:26.107
> 
> 标签：node.js

我有一个使用 socket.io 和其他依赖项的 node.js 聊天应用程序，但我目前没有数据库。

我想要一些关于如何解决这个问题以及如何实现它的建议，因为我正在开发一个应用程序，当 2 个用户在某个时候有匹配的消息时，他们不必同时拥有匹配的消息.

用户 1 可能会在聊天开始时说出“苹果”这个词，用户 2 可能会在聊天过程中说苹果。当这场比赛发生时，他们都得到积分。我一直在寻找一个好的基础聊天应用程序，它可能会促进这一点，但我发现没有任何东西能满足这一点。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:38:17.003

这就是我可以实现整个游戏的方式。很明显，您将从两位玩家那里得到答案。我想在你的聊天程序中你会有一些标识符来检查用户 ID 和他们的聊天会话，所以我不会为此烦恼。我认为为他们的匹配任务发送一个新的“问题”的实现不应该是一个简单的问题

```
setTimeout(function(){ io.emit('newQuestion', {picture: randomPicture})}, 120000); 
```

字符串匹配应该是另一个任务。这可以在 javascript 中轻松完成。由于您只是想匹配完整的字符串，我将按如下方式进行。假设你有一个聊天`string1`，聊天`string2`对应user1和user2。从那里您将需要交叉引用`string1`with中的所有单词`string2`。因为这`string1`必须分开。

```
var string1 = "apple half";
var string2 = "an apple";
var string1Split = string1.split(" ");

var match = false;

for(i=string1Split.length; i--;) {
 result = str.match(/string1Split[i]/g);
 if(result.length > 0 && match == false) {
  match = true;
 }
}

if(match) {
 //add points to it
} 
```

我不确定您是否必须替换引号中的“”，`string1Split[i]`但这只是做另一个正则表达式的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T22:22:10.730

听起来您可以使用数组来存储标签，因为它们被发送到服务器。同时，您可以对照其他用户存储的标签检查这些传入标签。

我会推荐 redis 来做这样的事情。它超级快，而且您似乎不需要长时间存储数据或保存在任何类型的复杂数据结构中。

# django - 使用 ORM 的“extra”方法时对“where”子句值进行 ORing

> ID：13534403
> 
> 赞同：2
> 
> 时间：2012-11-23T18:48:49.443
> 
> 标签：django, django-orm

**TLDR**使用[django 的 queryset api 方法的](https://docs.djangoproject.com/en/dev/ref/models/querysets/#extra)[`where`参数时，`extra`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#extra)您可以插入自定义 SQL，该 SQL 将被`AND`编辑到您的查询中。我有一种情况，我需要这些值`OR`与查询的重置一起编辑。对此有支持吗？

* * *

我有一张与另一张桌子有 M2M 关系的*大*桌子

```
class BookName:
    name = models.CharField(db_index=True)
    other_names = models.ManyToManyField(OtherName)

class OtherBookName:
    name = models.CharField(db_index=True) 
```

我想从列表中查询具有全名或替代名称的书籍。

使用`Q()`自然会大大减慢速度。

我的解决方案是首先查询`OtherBookName`在我的列表中有名称的行并返回这些 pks（因为它被索引所以很快）。然后，我在两个模型之间手动包含 M2M 表，并添加一个`where`子句，该子句还应该拉出`BookName`与表匹配的实例。

```
test_names = ["Foo", "Bar",]
other_ids = OtherBookName.objects.filter(name__in=test_names).values_list("id", flat=True)
queryset = self\
            .filter(Q(name__in=test_names)) \
            .extra(
                where=[
                    "bookname_id = app_bookname.id",
                    "booknameotherbookname_id IN (%s)" 
                        % ",".join([str(id) for id in other_ids]),
                ],
                tables=["app_bookname_otherbookname",]) \
            .distinct() 
```

这非常接近工作，除了`AND`当我愿意时我的 where 子句被编入查询`OR`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:09:43.513

尝试这个：

```
names = ["Foo", "Bar",]
other_ids = OtherBookName.objects.filter(name__in=names).values_list("id", flat=True)
where_clause = "bookname_id = app_bookname.id AND (name IN (%s)" \
                % ",".join(names) + " OR booknameotherbookname_id IN (%s))" \
                % ",".join([str(id) for id in other_ids])
queryset = self\
            .extra(
                where=[where_clause],
                tables=["app_booknames_otherbookname",]) \
            .distinct() 
```

# node.js - .npmrc - 未扩展环境变量？

> ID：13534412
> 
> 赞同：0
> 
> 时间：2012-11-23T18:50:12.020
> 
> 标签：node.js

我需要根据一些预定义的变量轻松安装软件包。

所以我设置

```
export NPMDIR=dev 
```

或者

```
export NPMDIR=prod 
```

然后在`.npmrc`

```
prefix=/usr/local/npm/$NPMDIR 
```

并且所有软件包都安装在`/usr/local/npm/$NPMDIR`字面上而不是`/usr/local/npm/dev`,`/usr/local/npm/prod`等等。

有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:51:32.190

很可能您需要在变量周围加上括号：

```
prefix=/usr/local/npm/${NPMDIR} 
```

# kendo-ui - Kendo UI：将网格摘要值放在页脚中

> ID：13534414
> 
> 赞同：9
> 
> 时间：2012-11-23T18:50:43.530
> 
> 标签：kendo-ui, kendo-grid

使用 Kendo UI Grid 和 MVC 4，我无法找到一种方法将汇总总计（财务）放在选定列的网格底部。

这可能吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-23T21:38:31.433

确实是的！检查[数据源聚合](http://docs.kendoui.com/api/framework/datasource#aggregate%20array%20%20objectdefault%29)。

例子：

```
var stocksDataSource = new kendo.data.DataSource({
    transport:{
        read:function (options) {
        }
    },
    schema   :{
        model:{
            fields:{
                name :{ type:"string" },
                price:{ type:"number" }
            }
        }
    },
    aggregate:[
        { field:"price", aggregate:"sum" }
    ],
    pageSize :10
}); 
```

我`DataSource`用两个字段定义了 a：items`name`和`price`. 我想总结一下，`price`所以我定义了一个`aggregate`for ，`price`我要做的是`sum`（你也可以`min`，，`max`和）。`average``count`

然后在`Grid`我定义我写的列时：

```
columns    :[
    { field:"name", title:"Product" },
    { field:"price", title:"Price", footerTemplate:"Sum: #= sum # " }
], 
```

就是这样！

# android - 以编程方式创建多个 LinearLayout

> ID：13534415
> 
> 赞同：0
> 
> 时间：2012-11-23T18:50:43.637
> 
> 标签：android, android-layout, textview, android-linearlayout

我正在尝试创建一个线性布局的多个实例。我创建了我的布局文件（下）。我把它放在它自己的布局文件中，从另一个文件（main_activity.xml）我想在滚动视图中添加动态数量的线性布局实例。我知道我可以在我的 java 代码中以编程方式创建相同的线性布局并循环遍历它，但我宁愿不这样做（主要有两个原因）

1.  在我的 java 类中创建大量布局开始让我的代码看起来很混乱 :)。
2.  我喜欢 XML 中的布局和 Java 中的逻辑的范例。

我是否可以将我的逻辑保留在 java 中，然后动态创建/实例化我的线性布局的多个“实例”。我的猜测是有一个简单的解决方案，但我的新手状态正在影响我解决它的能力。出于某种原因，我的 java 代码可以找到 LinearLayout 但无法找到第一个 TextView(@+id/submittedBy)。

非常感谢，克雷格

Java 逻辑

```
 ScrollView sv = (ScrollView) findViewById(R.id.existingCommentsScrollView);
    //DEBUGGING LOOP- REMOVE ME
    for(int i=0;i<30;i++){
        LinearLayout ll = (LinearLayout)findViewById(R.id.existingCommentLinearLayout);

        TextView submittedByTextView = (TextView) findViewById(R.id.submittedBy);
        submittedByTextView.setText("Craig " +i);

        TextView submittedDate = (TextView) findViewById(R.id.dateField);
        submittedDate.setText("SubmittedDate " +i);

        RatingBar showRating = (RatingBar) findViewById(R.id.userShowRating);
        showRating.setRating(3);

        RatingBar soundRating = (RatingBar) findViewById(R.id.userSoundRating);
        soundRating.setRating(1);

        EditText commentText = (EditText) findViewById(R.id.userCommentEditText);
        commentText.setText("THIS IS WHERE MY TEXT GOES FOR "+i+" I could add more too");

        sv.addView(ll);
    }
    sv.refreshDrawableState(); 
```

布局：

```
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/linear_layout_border"
android:orientation="vertical"
android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="#000000"
    android:paddingBottom="4dp"
    android:paddingLeft="4dp"
    android:paddingRight="4dp"
    android:paddingTop="4dp"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

    <TextView
        android:id="@+id/submittedBy"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:gravity="center_horizontal"
        android:inputType="none"
        android:paddingBottom="1dp"
        android:paddingLeft="4dp"
        android:paddingRight="10dp"
        android:paddingTop="1dp"
        android:text="NameGoesHere"
        android:textColor="#E6E6E6"
        android:textSize="8sp" />

    <TextView
        android:id="@+id/dateField"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/submittedBy"
        android:ems="10"
        android:paddingBottom="1dp"
        android:paddingLeft="4dp"
        android:paddingRight="10dp"
        android:paddingTop="1dp"
        android:text="DateGoesHere"
        android:textColor="#E6E6E6"
        android:textSize="8sp" />
</RelativeLayout>

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="#000000"
    android:paddingBottom="4dp"
    android:paddingLeft="4dp"
    android:paddingRight="4dp"
    android:paddingTop="4dp"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

    <TextView
        android:id="@+id/userShowRatingTextView"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:gravity="center_horizontal"
        android:inputType="none"
        android:paddingBottom="1dp"
        android:paddingLeft="4dp"
        android:paddingRight="10dp"
        android:paddingTop="1dp"
        android:text="Show Rating"
        android:textColor="#E6E6E6"
        android:textSize="8sp" />

    <RatingBar
        android:id="@+id/userShowRating"
        style="?android:attr/ratingBarStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/userShowRatingTextView" />
</RelativeLayout>

<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="#000000"
    android:paddingBottom="4dp"
    android:paddingLeft="4dp"
    android:paddingRight="4dp"
    android:paddingTop="4dp"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

    <TextView
        android:id="@+id/userSoundRatingTextView"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_toRightOf="@id/userShowRating"
        android:gravity="center_horizontal"
        android:inputType="none"
        android:paddingBottom="1dp"
        android:paddingLeft="4dp"
        android:paddingRight="10dp"
        android:paddingTop="1dp"
        android:text="Sound Rating"
        android:textColor="#E6E6E6"
        android:textSize="8sp" />

    <RatingBar
        android:id="@+id/userSoundRating"
        style="?android:attr/ratingBarStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/userSoundRatingTextView" />
</RelativeLayout>

<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <EditText
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/editText2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#000000"
        android:inputType="none"
        android:paddingBottom="4dp"
        android:paddingLeft="4dp"
        android:paddingRight="4dp"
        android:paddingTop="4dp"
        android:text="Comment Goes Here"
        android:textColor="#E6E6E6"
        android:textSize="12sp"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

        <requestFocus />
    </EditText>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:01:13.657

你没有遇到任何异常？我指的是循环中的最后一行，您`LinearLayout`在`ScrollView`每次迭代中添加 。您可能正在尝试扩充您的布局文件，然后将其添加到`ScrollView`以下内容：

```
ScrollView sv = (ScrollView) findViewById(R.id.existingCommentsScrollView);
// I assume this LinearLayout is the only child of the ScrollView above
LinearLayout ll = (LinearLayout)findViewById(R.id.existingCommentLinearLayout);
for(int i=0;i<30;i++){        
    // R.layout.the_layout_file is your layout from the question
    View inflatedView = getLayoutInflater().inflate(R.layout.the_layout_file, ll, false);
    TextView submittedByTextView = (TextView) inflatedView.findViewById(R.id.submittedBy);
    submittedByTextView.setText("Craig " +i);

    TextView submittedDate = (TextView) inflatedView.findViewById(R.id.dateField);
    submittedDate.setText("SubmittedDate " +i);

    RatingBar showRating = (RatingBar) inflatedView.findViewById(R.id.userShowRating);
    showRating.setRating(3);

    RatingBar soundRating = (RatingBar) inflatedView.findViewById(R.id.userSoundRating);
    soundRating.setRating(1);

    EditText commentText = (EditText) inflatedView.findViewById(R.id.userCommentEditText);
    commentText.setText("THIS IS WHERE MY TEXT GOES FOR "+i+" I could add more too");

    ll.addView(inflatedView);
} 
```

另外，请记住，您正在添加大量视图，这是为了获得流畅的界面而需要避免的。

# wordpress - 带有类别和 Meta_key 的 Wordpress WP_QUERY

> ID：13534418
> 
> 赞同：0
> 
> 时间：2012-11-23T18:51:00.130
> 
> 标签：wordpress

目前我有 2 个类别和 1 个自定义字段

类别 = CAT01 和 CAT02 / ID 的 1 和 2 自定义字段 = Test01

我想要的是在我的自定义字段（Test01）中输入的所有值的平均值，但来自 1 个类别。

我是 Wordpress 的新手，但我得到了以下信息：

```
 $wp_query = new WP_Query( array (
                    'category_id' => '1',
                    'meta_key' => 'Test01',
                    )
                 ); 
```

如果没有类别 ID，它似乎可以做一些事情，但不是我想要的。

任何人都可以帮我解决这个问题，非常感谢您的努力:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:22:38.503

我认为使用 WP_Query 会为此增加不必要的开销。我会做一个自定义 SQL 查询（尽管如果 WP 将来改变他们的分类数据库结构，你必须密切关注）。

它看起来像这样：

```
global $wpdb;
$term = get_term(1, 'category');        //need the term_taxonomy_id, not always the same as term_id
$sqlQuery = "SELECT AVG(meta_value) FROM $wpdb->postmeta WHERE meta_key = 'Test01' AND post_id IN(SELECT object_id FROM $wpdb->term_relationships WHERE term_taxonomy_id = '" . $term->term_taxonomy_id . "') ";
$avg = $wpdb->get_var($sqlQuery); 
```

# android - 检查是否授予root权限？

> ID：13534419
> 
> 赞同：2
> 
> 时间：2012-11-23T18:51:02.440
> 
> 标签：android

我已将我的应用程序设置为`su`使用以下代码执行命令：

```
try {
            Runtime.getRuntime().exec("su");
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            altDialog.setTitle("No Root");
            altDialog
                    .setMessage("I am afraid I have been unable to execute the su binary. Please check your root status.");
            altDialog.setCancelable(false);
            altDialog.setButton("Exit App",
                    new DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface arg0, int arg1) {
                            // TODO Auto-generated method stub
                            Log.e("Android .img Flasher",
                                    "Exiting due to root error");
                            finish();
                        }
                    });
        } 
```

如果`su`命令不存在（我相信），这会捕获，但如果 root 确实被授予，则不会。

我将如何检查是否确实授予了 root 权限？

附带说明一下，我如何能够使用`Runtime.getRuntime.exec()`命令存储命令的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T20:24:49.663

您可以使用下面的代码。我为通用命令编写了它，但它也适用于`su`命令。如果命令成功以及命令输出（或错误），它将返回。

```
public static boolean execCmd(String command, ArrayList<String> results){
    Process process;
    try {
        process = Runtime.getRuntime().exec(new String [] {"sh", "-c", command});
    } catch (IOException e) {
        e.printStackTrace();
        return false;
    } 

    int result;
    try {
        result = process.waitFor();
    } catch (InterruptedException e1) {
        e1.printStackTrace();
        return false;
    }

    if(result != 0){ //error executing command
        Log.d("execCmd", "result code : " + result);
        String line; 
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getErrorStream())); 
        try {
            while ((line = bufferedReader.readLine()) != null){
                if(results != null) results.add(line);
                Log.d("execCmd", "Error: " + line);
            }
        } catch (IOException e) {
            e.printStackTrace();
            return false;
        }
        return false;
    }

    //Command execution is OK
    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream())); 

    String line; 
    try {
        while ((line = bufferedReader.readLine()) != null){
            if(results != null) results.add(line);
            Log.d("execCmd", line);
        }
    } catch (IOException e) {
        e.printStackTrace();
        return false;
    }
    return true;
} 
```

你用两个参数调用它：

*   `command`- 带有要执行的命令的字符串
*   `results`- 清空 ArrayList 以返回命令输出。如果为 null，则不返回输出。

要检查`su`命令，您可以执行以下操作：

```
//Array list where the output will be returned
ArrayList<String> results = new ArrayList<String>();
//Command to be executed
String command = "su -c ls";
boolean result = execCmd(command,results);
//result returns command success
//results returns command output 
```

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-25T02:26:43.610

```
 public static boolean isRootAvailable(){
            Process p = null;
            try{
               p = Runtime.getRuntime().exec(new String[] {"su"});
               writeCommandToConsole(p,"exit 0");
               int result = p.waitFor();
               if(result != 0)
                   throw new Exception("Root check result with exit command " + result);
               return true;
            } catch (IOException e) {
                Log.e(LOG_TAG, "Su executable is not available ", e);
            } catch (Exception e) {
                Log.e(LOG_TAG, "Root is unavailable ", e);
            }finally {
                if(p != null)
                    p.destroy();
            }
            return false;
        }
 private static String writeCommandToConsole(Process proc, String command, boolean ignoreError) throws Exception{
            byte[] tmpArray = new byte[1024];
            proc.getOutputStream().write((command + "\n").getBytes());
            proc.getOutputStream().flush();
            int bytesRead = 0;
            if(proc.getErrorStream().available() > 0){
                if((bytesRead = proc.getErrorStream().read(tmpArray)) > 1){
                    Log.e(LOG_TAG,new String(tmpArray,0,bytesRead));
                    if(!ignoreError)
                        throw new Exception(new String(tmpArray,0,bytesRead));
                }
            }
            if(proc.getInputStream().available() > 0){
                bytesRead = proc.getInputStream().read(tmpArray);
                Log.i(LOG_TAG, new String(tmpArray,0,bytesRead));
            }
            return new String(tmpArray);
        } 
```

# android - android 小部件 id 仅适用于当前小部件

> ID：13534421
> 
> 赞同：2
> 
> 时间：2012-11-23T18:51:09.520
> 
> 标签：android, widget, appwidgetprovider

我可以在`onUpdate()`的方法中获取当前的 widgetId`AppWidgetProvider`吗？

我在 Intent 领域发现了很多关于发送的帖子`appWidgetId`，但我不明白在发送之前我必须在哪里得到它。

我没有找到在没有配置活动的情况下仅获取当前小部件 ID 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:04:11.707

试试 onUpdate

```
 int a = appWidgetIds.length; 
```

如果返回 1，则：

```
 int yourAppWidgetId = appWidgetIds[0]; 
```

应该返回您的 appWidgetId。

## 编辑

没有看到任何代码很难给你正确的答案，但我会给你一个例子。如果您为小部件创建了 RemoteView，则必须为每个 RemoteView 创建一个意图。为此，您可以设置一个 ID，例如：

```
 RemoteViews remoteViews = new RemoteViews(getApplicationContext()
                .getPackageName(), 
                    layout.your_widget_layout);

        Intent intent1 = new Intent(getApplicationContext(),
                YourAppWidgetProvider.class);

    intent1.setAction(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
        intent1.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        intent1.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS,widgetIds);
        intent1.putExtra("ID", "one"); 
```

然后创建一个 PendingIntent，您可以将其设置为 remoteViews：

```
 PendingIntent pendingIntent = PendingIntent.getBroadcast(
                getApplicationContext(), 1, intent1,
                PendingIntent.FLAG_ONE_SHOT);

    remoteViews.setOnClickPendingIntent(R.id.your_widget_button_id_in_xml,
                pendingIntent); 
```

如果用户按下小部件，您可以在 onReceive() 中获取 id

```
 String a = intent.getStringExtra("ID"); 
```

但这只是一个不完整的例子，还有很多事情要做。如果您阅读本教程，我认为这是一个好方法：

[http://www.android10.org/index.php/articlesgeneralprogramming/315-app-widgets-tutorial](http://www.android10.org/index.php/articlesgeneralprogramming/315-app-widgets-tutorial)

updateService 有一个很好的例子。

# mysql - 传销数据库查询

> ID：13534425
> 
> 赞同：0
> 
> 时间：2012-11-23T18:51:28.377
> 
> 标签：mysql, sql, recursive-query

如果您知道在 mysql 查询中执行此操作的好方法，我有一个问题。

表格是这样的：

```
-----------------------------------------------
CUSTOMER_ID    | REF_CUSTOMER_ID | NAME       
-----------------------------------------------
1              | NULL            | MARIUS
2              | 1               | PERNILLE
3              | 2               | OLIVIA
4              | 2               | WILLIAM
----------------------------------------------- 
```

如您所见，这是一张客户表。如果客户被其他客户推荐，他们的 id 存储在 REF_CUSTOMER_ID 中。

你们中有人知道计算通过客户推荐的所有客户和再次通过他们推荐的所有客户的好方法吗？

前任。客户 1 推荐了 1 位客户，而该客户推荐了 2 位客户。这意味着在客户 1 的计数/下线中，它应计为 3。

# sql-server - 预览具有 ON CASCADE 约束的记录的 SQL DELETE

> ID：13534428
> 
> 赞同：10
> 
> 时间：2012-11-23T18:51:46.597
> 
> 标签：sql-server

我们有一个主“用户”表和*许多*引用 UserId 的表

*   直接：UserId 是子表中的 FK 或
*   间接地：“孙子”表中的另一个 FK，它引用子表中的记录，而子表中的记录又通过 FK 约束引用 UserID。

现在，如果一切都完美，删除用户*应该*像在主表中删除它们一样简单，并且 ON CASCADE 约束将其波及其余表。问题是我们不能 100% 确定每个引用的表中的每个 FK 关系（直接或间接）是否具有 ON CASCADE 约束。我们需要一些方法来发出删除并观察 SQL Server 实际触及的要删除的表。我阅读[并](https://stackoverflow.com/questions/465083/how-do-i-preview-a-destructive-sql-query)尝试了它，但它没有显示级联的任何表 - 仅显示主表中的条目

这是我尝试过的：

```
DELETE umt
OUTPUT DELETED.*
FROM [OurAppDb].[dbo].[UserMasterTable] umt
WHERE umt.UserId LIKE 'ABCDABCD-ABCD-ABCD-ABCD-ABCDABCDABCD' 
```

如何查看上述查询将涉及的所有表？

注意： ON CASCADE 约束是数据库中的一个约束，我们认为我们在构建*每个*表时为每个表添加了该约束。它被添加到一张桌子上的例子

```
ALTER TABLE [dbo].[UserEmailPrefs]  
WITH CHECK ADD  CONSTRAINT [FK_UserEmailPrefs_UserMasterTable_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[UserMasterTable] ([UserId])
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[UserEmailPrefs] CHECK CONSTRAINT [FK_UserEmailPrefs_UserMasterTable_UserId]
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T05:11:03.987

要检查整个数据库中引用 UserMasterTable 的引用约束，请使用 INFORMATION_SCHEMA 视图。

```
SELECT RC.CONSTRAINT_NAME, TU.TABLE_NAME, RC.DELETE_RULE, RC.UPDATE_RULE 
  FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC
  INNER JOIN INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE TU
          ON RC.CONSTRAINT_CATALOG = TU.CONSTRAINT_CATALOG 
         AND RC.CONSTRAINT_NAME = TU.CONSTRAINT_NAME
  INNER JOIN INFORMATION_SCHEMA.table_constraints TC 
          ON RC.unique_constraint_name = TC.CONSTRAINT_NAME
  WHERE TC.TABLE_NAME='Users' 
```

这将返回针对 UserMasterTable 的引用约束的列表，并且对于每个约束，哪个表正在引用 UserMasterTable，以及 ON DELETE 和 ON UPDATE 规则是什么。从中您可以快速查看哪些引用约束缺少所需的 CASCADE 规则。无需获得触发快乐。

要将其扩展到“孙子”引用，请再添加两个连接子句。要将其扩展到任意数量的级别，请使用递归 CTE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T08:28:59.263

我认为您可以在触发器中执行此操作（分析 [插入] 表并搜索从属表）。例如：您可以创建表来存储用于检测外键链接的查询：

```
IF NOT EXISTS (
        SELECT *
        FROM [sys].tables T
        WHERE T.NAME = 'FKCheck'
        )
    CREATE TABLE FKCheck (
        TableName SYSNAME
        ,ChildTable SYSNAME
        ,QueryText NVARCHAR(MAX)
        )
ELSE
    EXEC('DROP TABLE FKCheck') 
```

然后用从元数据中提取的动态查询填充它

```
;WITH CTE_FKs
AS (
    SELECT FK.NAME
        ,OBJECT_name(fk.parent_object_id) AS ChildTable
        ,OBJECT_name(fk.referenced_object_id) AS ParentTable
        ,delete_referential_action_desc AS DeleteAction
        ,MainTable.NAME AS MainTableColumn
        ,ChildObject.NAME AS ChildColumnName
    FROM sys.foreign_keys FK
    INNER JOIN sys.foreign_key_columns FKC ON FKC.constraint_object_id = FK.object_id
    INNER JOIN sys.columns AS ChildObject ON ChildObject.object_id = FKc.parent_object_id
        AND FKC.parent_column_id = ChildObject.column_id
    INNER JOIN sys.columns AS MainTable ON MainTable.object_id = FK.referenced_object_id
        AND MainTable.column_id = FKC.referenced_column_id
    )
    ,CTE_Tables
AS (
    SELECT DISTINCT C.NAME
        ,C.ParentTable
        ,C.DeleteAction
        ,C.ChildTable
    FROM [CTE_FKs] C
    )
INSERT INTO [dbo].[FKCheck] (
    TableName
    ,ChildTable
    ,QueryText

    )
SELECT C.ParentTable,C.ChildTable
    ,'IF EXISTS (select 1 from inserted INNER JOIN  ' + QUOTENAME(C.ChildTable) + ' ON ' + STUFF((
            SELECT ' AND inserted.' + QUOTENAME(C2.MainTableColumn) + ' = ' + + QUOTENAME(C2.ChildTable) + '.' + QUOTENAME(C2.ChildColumnName)
            FROM CTE_FKs C2
            WHERE C2.ParentTable = C.ParentTable
                AND C2.NAME = C.NAME
            FOR XML PATH('')
                ,TYPE
            ).value('.', 'nvarchar(MAX)'), 1, 4, '') + ')
 RAISERROR(''Relation with ' + QUOTENAME(C.ChildTable) +':'+ CASE C.DeleteAction
        WHEN 'CASCADE'
            THEN ' data will be deleted'
        WHEN 'SET_NULL'
            THEN ' set as NULL'
        WHEN 'NO_ACTION'
            THEN ' no default action'
        ELSE 'Unknown'
        END + ''')'
FROM [CTE_Tables] C 
```

您在表中的查询将如下所示：

```
 IF EXISTS (select 1 from inserted INNER JOIN  [UserEmailPrefs] ON  inserted.[UserId] = [UserEmailPrefs].[UserId])
 RAISERROR('Relation with [UserEmailPrefs]: no default action')
IF EXISTS (select 1 from inserted INNER JOIN  [UserEmail] ON  inserted.[UserId] = [UserEmail].[UserId])
 RAISERROR('Relation with [UserEmail]: set as NULL') 
```

然后在触发器中，您可以执行查询以打印消息：

```
 DECLARE @TableName SYSNAME = 'UserMasterTable';
    DECLARE @sSQL NVARCHAR(MAX) = '';

    SELECT @sSQL += F.QueryText + CHAR(10)
    FROM FKCheck F
    WHERE F.TableName = @TableName;
EXEC(@sSQL)
ROLLBACK 
```

如果需要分析更“远”的表，则需要遍历 FKCheck 表中的层次结构。

# linux - 完整的 Apache 配置迁移

> ID：13534431
> 
> 赞同：2
> 
> 时间：2012-11-23T18:52:25.853
> 
> 标签：linux, apache, migration

我搜索了很多，没有找到适用的答案。

我在 Ubuntu 机器上有一个可用的 LAMP 设置，我必须迁移到另一个国家的新服务器。旧服务器是 11.10，新服务器是 12.04LTS。

我的问题是，当我配置不是基本 LAMP 安装的当前服务器时，我根本不记得我遵循的步骤。它是带有 FastCGI、SuEXEC、GD 库、worker MPM 的 Apache，所有这些都位于 mhddfs 系统之上。我还更改了其他配置，我不记得它们是什么。由于设置的复杂性，我尝试迁移到新服务器失败了。我收到权限错误、cgi 问题等。

因此，我的问题是：有没有一种理智的方法可以简单地对当前的 Web 服务器安装进行 tar 完整备份，包括 MySQL、Php 和具有所有配置的 apache 服务器，然后将其移动到新机器上？

我将永远感谢任何建议。到目前为止，我在这里找到的这些都没有给我答案。

谢谢！

# powershell - Get-WmiObject 凭据在计划时不起作用

> ID：13534441
> 
> 赞同：0
> 
> 时间：2012-11-23T18:53:00.133
> 
> 标签：powershell, windows-xp

我有一个 Powershell 脚本来检测需要用户/密码才能访问它的网络服务器上的磁盘空间。

我跟着这个：[http ://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/440ab7ed-7727-4ff7-a34a-6e69e2dff251/](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/440ab7ed-7727-4ff7-a34a-6e69e2dff251/)

要获取此代码：

```
$password = get-content C:\creds.txt | convertto-securestring
$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist "username",$password
Get-WmiObject -ErrorAction Stop Win32_LogicalDisk -ComputerName $deviceName -credential $cred -Filter "DeviceID='$darg'" 
```

`$deviceName`并且`$darg`已经正确定义。

这在手动运行 Powershell 脚本时工作得很好。但是当我将它设置为 Windows 计划任务时，它会认为用户/密码不正确：

> Get-WmiObject：访问被拒绝。（来自 HRESULT 的异常：0x80070005（E_ACCESS DENIED））
> 
> $disks = Get-WmiObject <<<< -ErrorAction Stop Win32_LogicalDisk -ComputerName $deviceName -credential $cred -Filter "DeviceID='$darg'" + CategoryInfo : NotSpecified: (:) [Get-WmiObject], Unauthorized AccessException + FullyQualifiedErrorId ： System.UnauthorizedAccessException，Microsoft.PowerShell.Commands.GetWmiObjectCommand

为什么是这样？（该帐户是远程服务器上的本地用户。我尝试在 Schedule 界面上输入凭据，但它不允许我保存它，说登录无效；可能是由于是本地帐户）`ServerName\LocalUser`在Windows Schedule UI，仍然给出不正确的登录错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:28:59.947

为什么不将任务设置为在用户帐户下运行并在没有凭据的情况下运行 wmi 请求？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T19:36:06.103

这是我的评论，重新措辞作为答案。

convertto/from-securestring 函数在每个用户的基础上工作（如果您不提供特定的键值）。IOW，一个用户无法读取另一个用户的数据。

[这个预先存在的 SO 问题](https://stackoverflow.com/questions/7109958/saving-credentials-for-reuse-by-powershell-and-error-convertto-securestring-ke)似乎是相关的。[Powershellcommunity.org上也有相关讨论](http://powershellcommunity.org/Forums/tabid/54/aft/8122/Default.aspx)。

# python - Python line.split 包含一个空格

> ID：13534442
> 
> 赞同：0
> 
> 时间：2012-11-23T18:53:02.440
> 
> 标签：python, regex, python-2.7

如果我有一个字符串并想返回一个包含空格的单词，该怎么做？

例如，我有：

```
line = 'This is a group of words that include #this and @that but not ME ME'

response = [ word for word in line.split() if word.startswith("#") or  word.startswith('@')  or word.startswith('ME ')]

print response ['#this', '@that', 'ME'] 
```

所以 ME ME 因为空白而没有被打印出来。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:26:35.027

来自 python 文档：

> **string.split(s[, sep[, maxsplit]])**：返回字符串 s 的单词列表。如果可选的第二个参数 sep 不存在或为 None，则单词由任意字符串（空格、制表符、换行符、回车符、换页符）分隔。

所以你的错误首先是呼吁拆分。

> > > > print line.split() ['This', 'is', 'a', 'group', 'of', 'words', 'that', 'include', '#this', 'and', '@那'，'但是'，'不是'，'我'，'我']

我建议使用[re](http://docs.python.org/2/library/re.html)来拆分字符串。使用**re.split(pattern, string, maxsplit=0, flags=0)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:24:14.733

你可以保持简单：

```
line = 'This is a group of words that include #this and @that but not ME ME'

words = line.split()

result = []

pos = 0
try:
    while True:
        if words[pos].startswith(('#', '@')):
            result.append(words[pos])
            pos += 1
        elif words[pos] == 'ME':
            result.append('ME ' + words[pos + 1])
            pos += 2
        else:
            pos += 1
except IndexError:
    pass

print result 
```

只有在实践中证明速度太慢时才考虑速度。

# netbeans - 将现有 CMake 项目导入 Netbeans 7.2，但没有可用的构建选项

> ID：13534446
> 
> 赞同：0
> 
> 时间：2012-11-23T18:53:31.167
> 
> 标签：netbeans, cmake, netbeans-7, netbeans-7.2

我已将使用 CMake 构建的项目导入 Netbeans 7.2。我可以从 netbeans 成功构建项目，但是：

1.  我不知道正在使用什么构建配置（即调试或发布）。由于构建库的大小，我怀疑这是一个调试版本。

2.  如何创建用于 Netbeans 的调试和发布版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:46:44.420

我相信默认构建确实是调试。

要将配置更改为发布，您需要使用命令行参数调用 CMake `-DCMAKE_BUILD_TYPE=Release`。

据我回忆，不可能在 IDE 中轻松更改配置类型，而[这个错误报告](http://netbeans.org/bugzilla/show_bug.cgi?id=187623)似乎表明情况仍然如此。

# python - 我在哪里可以获得 ActivePython 构建的 Visual Studio PDB 文件？

> ID：13534447
> 
> 赞同：1
> 
> 时间：2012-11-23T18:53:34.467
> 
> 标签：python, visual-studio, pdb-files, activepython

我目前已经`ActivePython-2.7.2.5-win32-x86.msi`在我的电脑上安装了 python.exe 并且挂起。我不会详细介绍这个挂起的所有细节，但为了继续调试，我决定有必要调试构成 Python 解释器的 C 代码。我已成功将 Visual Studio 附加到 python.exe 进程。问题是 Visual Studio 正在寻找 python.exe 的调试符号，而我没有它们，也不知道在哪里可以找到它们。

我的问题是：**我在哪里可以获得 ActivePython 构建的 pdb 调试符号文件，最好是 ActivePython-2.7.2.5？**

我在所有我能想到的地方都进行了搜索，但没有成功找到这些文件。我无法使用 Python 的自编译版本重现此问题，这就是为什么我现在尝试调试我们在环境中使用的 Python 的实际分布。

# java - 使用 InputStreamReader 和 BufferedReader 读取 HTTP 响应慢？

> ID：13534452
> 
> 赞同：2
> 
> 时间：2012-11-23T18:54:14.467
> 
> 标签：java, http, httpurlconnection, stringbuilder, inputstreamreader

我在 Java 中有以下代码，它向 Web 服务器发送 HTTP 请求并读取响应：

```
StringBuilder response = new StringBuilder(50000);
URL url2 = new URL(ServiceURL); 
connection = (HttpURLConnection)url2.openConnection();
connection.setRequestMethod("POST");

//... (some more connection settings) ...

BufferedWriter  wr = new BufferedWriter(new OutputStreamWriter(connection.getOutputStream(), "UTF-8"));

wr.write(Request);
wr.flush ();
wr.close ();

InputStream is = connection.getInputStream();       
BufferedReader rd = new BufferedReader(new InputStreamReader(is));

int i = 0;
while ((i = rd.read()) > 0) {
    response.append((char)i);
} 
```

它适用于大多数情况，但我有一个服务器返回相当大的 XML（大约 500 KB；我想这对于一堆文本来说相当大..），我不断收到读取超时异常。

我相信这不是网络问题，因为我尝试使用 curl 发出相同的请求，并且响应很快就到达了，大约两秒钟。

当我查看网络中发生的情况（使用wireshark 捕获数据包）时，我注意到我计算机中的TCP 接收窗口有时会满。TCP 堆栈有时会幸免于难；我可以看到服务器发送 TCP keep-alive 以保持连接，但最后 TCP 连接只是中断了。

可能是代码的阅读部分（逐个字符附加收到的响应）正在减慢我的代码速度吗？有没有更有效的方法来读取 HTTP 响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:02:14.913

一个字一个字的读起来很慢，是的。尝试一次将块读入缓冲区：

```
char[] buf = new char[2048];
int charsRead;
while((charsRead = rd.read(buf, 0, 2048)) > 0) {
    response.append(buf, 0, charsRead);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:34:12.813

正如菲尔已经说过的那样逐字节读取流有点慢。我更喜欢使用 BufferedReader 的 readLine() 方法：

```
StringBuilder response = new StringBuilder();
String line = "";
while((line = rd.readLine()) != null) {
    response.append(line + System.getProperty("line.separator");
} 
```

如果可能，我会考虑使用 Apache HTTP 客户端库。它易于使用并且在处理 HTTP 内容方面非常强大。 [http://hc.apache.org/httpcomponents-client-ga/](http://hc.apache.org/httpcomponents-client-ga/)

您还应该记住设置套接字和连接超时。通过这种方式，您可以控制连接保持打开状态的时间（至少在连接的一方）。

最后但并非最不重要的一点是，在您收到响应后始终在 finally 块中关闭您的 HTTP 连接，否则您可能会遇到打开文件过多的问题。

希望这个问题 ;)

# expression-blend-5 - 表情混合 5 中没有弧线？

> ID：13534456
> 
> 赞同：1
> 
> 时间：2012-11-23T18:54:39.933
> 
> 标签：expression-blend-5

是只有我还是表情混合 5 中没有弧形？他们为什么要移除这个形状，我发现它在很多项目中都非常有用。我可能需要下载一个库吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:49:30.093

如果其他人正在寻找，似乎在 nuget 上有一个图书馆有这个

[http://winrtxamltoolkit.codeplex.com/](http://winrtxamltoolkit.codeplex.com/)

# objective-c - 在服务器上编辑 Plist

> ID：13534458
> 
> 赞同：0
> 
> 时间：2012-11-23T18:54:43.660
> 
> 标签：objective-c, ios, c, webserver, plist

我正在为我的雇主创建一个演示，您可以在其中访问和编辑服务器上的数据（在 .plist 上）。目前，我使用 Google 协作平台作为我的临时“服务器”，这就是我的 plist 所在的位置。

我可以使用以下代码读取 plist 文件：

```
NSString *url = @"http://sites.google.com/site/.../myplist.plist";
NSDictionary *dic = [[NSDictionary alloc] initWithContentsOfURL:[NSURL URLWithString:url]];
NSLog(@"Info: %@", [dic objectForKey:@"myKey"]); 
```

所以我的问题是，如何在“服务器”上编辑 plist 的数据？这甚至可能吗？

提前感谢您的帮助。

RMK-雅各布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:07:31.923

可能，但比需要的工作量要多得多。您需要使用[Google Sites API](https://developers.google.com/google-apps/sites/)登录到您网站的管理帐户并上传新版本的 plist 文件。

您可能想要调查使用 iCloud 或[Parse](https://parse.com/)之类的数据存储而不是 Google 协作平台。

# regex - 如何在 linux 中使用正则表达式和定位命令

> ID：13534459
> 
> 赞同：3
> 
> 时间：2012-11-23T18:54:45.877
> 
> 标签：regex, linux

我想将 locate 命令与正则表达式一起使用，但我无法使用它。

我想找到`pip`/usr 文件夹中的文件。我正在尝试这个

`locate -r "/usr/*pip"`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T18:59:48.990

要在查询中使用通配符，您不应该指定正则表达式（就像您使用`-r`选项一样），所以只需执行以下操作：

```
locate "/usr/*pip" 
```

从手册页：

> 如果未指定 --regex，则 PATTERN 可以包含通配符。如果任何 PATTERN 不包含 globbing 字符，则 locate 的行为就像模式是*PATTERN*一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:00:00.880

我会这样做： `locate -r '/usr/.*pip'`

# php - 类或 oops 中的代码执行

> ID：13534460
> 
> 赞同：1
> 
> 时间：2012-11-23T18:54:58.473
> 
> 标签：php, profiling

假设我有多个课程。我必须找出哪个类代码需要更多时间来执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:00:25.113

这称为剖析。有很多工具，开源的和商业的。

像 Eclipse 这样的 IDE 也内置了一些工具。我遇到的最好的商业工具是 Wily——现在是 CA Wily

# python - Python：当 cls 不浮动时，为什么 float.__new__(cls) 会起作用？

> ID：13534461
> 
> 赞同：2
> 
> 时间：2012-11-23T18:54:58.437
> 
> 标签：python

我对[此处](http://www.python.org/download/releases/2.2/descrintro/#__new__)python 文档中的以下示例感到有些困惑。

```
>>> class inch(float):
...     "Convert from inch to meter"
...     def __new__(cls, arg=0.0):
...         return float.__new__(cls, arg*0.0254)
...
>>> print inch(12)
0.3048
>>> 
```

据推测，float is here 是在 Python 深处定义的实际 float 类。当我们调用 时`float.__new__(cls, argument)`，我们偷偷地调用了返回给定参数的 float 实例的函数，但是我们传递给它的是 inch 类而不是 float 类。既然英寸类并没有真正做任何事情，为什么这会起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T19:16:54.470

因为`inch`是float的*子类*，所以满足了`float.__new__()`实例工厂的所有要求。[`__new__(cls)`创建第一个参数的实例是静态方法](http://docs.python.org/2/reference/datamodel.html#object.__new__)的工作，而不是它的“自己的”类。

请注意那里的“静态方法”一词。`__new__`工厂实际上只是出于继承原因与类绑定的特殊功能。换句话说，它是一个在面向对象层次结构中运行良好的函数。您应该通过`super()`或直接调用它来找到它（如此处所做）。以下实际上会更pythonic：

```
def __new__(cls, arg=0.0):
    return super(inch, cls).__new__(cls, arg*0.0254) 
```

因为如果要在多重继承层次结构中使用，那将调用“正确”`__new__`函数；`inch`在这个简单的例子中，它最终会调用`float.__new__`同样的方法。

因此，`__new__(cls, ...)`预计会创建一个类型为 的实例`cls`。为什么然后将它绑定到一个类而不是让它成为一个更通用的函数呢？因为在这种情况下，`float.__new__(cls, value)`它不仅创建了一个新的 type 实例`cls`，还将它的初始值设置为`value`。为了让它发挥作用，需要对类的外观`float.__new__(...)`有深入的了解。`float`因为`inch()`是 的子类`float()`，所以它也具有与 a 完全相同的必要位`float()`，因此当`float.__new__()`工厂创建一个新`inch`实例时，所有这些位都在那里使其成为一个`inch()`实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:53:44.140

回答这个问题需要一点背景知识：

1.  只能`object.__new__()`创建一种新`instances`类型的对象，这种对象不能被子类化。
2.  实例具有`type`，可以在将类型名称 作为第一个参数传递`cls`给时分配。关键字创建了另一种对象：类（又名类型），这些对象 *可以*被子类化。`__new__(cls)``class`

 *现在，回到你的例子，什么

```
float.__new__(cls, argument) 
```

本质上是使用`object.__new__(cls)`创建一个新实例（`float.__base__`is `object`），为它分配类型`cls`（`inch`在这种情况下），并且还使用`argument`定义的 in做一些事情`float.__new__`。

因此，当`cls`is not `float`but时它会起作用也就不足为奇了`inch`：类/类型已经由 创建`class inch(float)`，您只是将此类型分配给一个新实例。*

# android - 如何让我的应用程序在后台运行？

> ID：13534463
> 
> 赞同：4
> 
> 时间：2012-11-23T18:55:23.937
> 
> 标签：android, sockets, tcp, background-process

我正在创建一个需要始终通过 TCP 套接字连接的应用程序。我的应用程序在连接方面已经运行良好，但是当它被发送到后台时，android 系统最终会终止该进程。这会导致它与服务器断开连接。

我一直在寻找一种方法来始终保持应用程序处于活动状态，但没有找到任何东西。有人能告诉我最好的方法是什么，这样我的应用程序在后台时不会关闭，或者，除非它关闭，否则让它自行重启？我从这个开始，让我头疼：S

编辑这是我的代码的一部分：

```
 public int onStartCommand(Intent intent, int flags, int startId) {

      Toast.makeText(this, "service starting", Toast.LENGTH_SHORT).show();

      new Thread(new Runnable() { 
            public void run() {
                Playit();               }
        }).start();

     return START_STICKY;
  } 
```

不过，该应用程序似乎在启动时被冻结。我没有很多经验，所以也许我的错误很简单，我没有注意到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T18:59:08.467

使用服务并通过`startService()`. 它将一直运行，直到 Android 停止它以获取资源

一些关于服务的文档：

1.  [http://developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)
2.  [http://developer.android.com/guide/components/services.html](http://developer.android.com/guide/components/services.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:00:07.873

用户[服务](http://developer.android.com/reference/android/app/Service.html)。服务用于在后台执行长时间运行的操作，例如在与服务器的连接中发送/接收数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:00:25.117

查看Android的[`Service`](http://developer.android.com/reference/android/app/Service.html)类。但请注意，a`Service`不是单独的线程，它只是应用程序线程的一部分，操作系统在创建和销毁方面的处理方式不同。

If you need an extra thread, you can of course create one in a `Service`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:07:46.030

The nature of OS is as such, that is it is supposed to kill background processes because of limited memory resources i guess . Maybe you should check out ***Watchdog*** its some kind of background process manager . I am not that used to the android system but this is what i could find from my research . Hope that helps :)

Maybe this will help you :

[http://lifehacker.com/5608163/watchdog-monitors-your-android-for-run+away-processes](http://lifehacker.com/5608163/watchdog-monitors-your-android-for-run+away-processes)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T00:02:53.130

As the others said, the straight answer to you question is to host a thread that keeps the connection alive into a service.

However I want to remember you that you are in a resource limited environment, where having a persistent connection in background (with the overhead of the tcp protocol) may result into battery drain and angry users.

You should ask yourself if you really want to keep the connection persistent forever, or for a limited amount of time, or just after some events that might be triggered by a gcm message or if you could just go for polling, maybe using an [inexact alarm](http://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29) .

Another option would be to establish the connection only when you application is in foreground. Anyway, it certainly depends on what you want to do with your application.

# android - 如何使用 LoaderManager 定期更新列表片段

> ID：13534465
> 
> 赞同：0
> 
> 时间：2012-11-23T18:55:29.300
> 
> 标签：android, android-fragments

如何定期更新列表片段？我需要从 SQLite 数据库中查询数据并更新 ListFragment。为此，我可以使用 Loader Manager 吗？

我是否正确，如果我在我的列表片段中使用**加载器管理器**，每当 sqlite 数据库中有新数据可用时，它会将该数据异步加载到我的列表片段中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:15:43.757

让您的 ListFragment 实现[Loader.Callbacks](http://developer.android.com/reference/android/app/LoaderManager.LoaderCallbacks.html)。

在 onLoadFinished 回调上，做这样的事情；

```
onLoadFinished (Loader<List<D>> loader, List<D> result){  
    setListAdapter(new YourListAdapter(esult));  
} 
```

显然，这取决于您使用的适配器等等。

称它为trough `getLoaderManagger.initLoader(int id, Bundle params, , LoaderCallbacks<D> callback);`，每次调用它时都传递一个唯一的 id（例如，具有基于当前时间的值）。

除此之外，您还需要一个 Timer，TimerTask run() 方法将简单地初始化加载程序。

# wpf - 用户控件中的 NotifyPropertyChanged

> ID：13534466
> 
> 赞同：0
> 
> 时间：2012-11-23T18:55:38.493
> 
> 标签：wpf, user-controls, inotifypropertychanged

我是 WPF 的新手，我的应用程序中有一个用户控件，它具有列表类型的依赖属性。

在我的窗口中，我放置了那个用户控件并将这个 DP 绑定到我的视图列表的属性。

最终属性会发生变化，因此作为集合但它不会反映在用户控件上。

我的视图实现了 INotifyPropertyChanged 接口。

我的用户控件的 DP 不会引发属性更改的事件。

可能的原因是什么？

我的用户控件中我的依赖属性的代码

```
 public List<ItemsResult> ItemsCollection
    {
        get { return (List<ItemsResult>)GetValue(ItemsCollectionProperty); }
        set { SetValue(ItemsCollectionProperty, value); }
    }

    public static readonly DependencyProperty ItemsCollectionProperty =
        DependencyProperty.Register("ItemsCollection", typeof(List<ItemsResult>), typeof(ListingUserControl)
                                    , new FrameworkPropertyMetadata(null, ItemsCollectionChanged));

    private static void ItemsCollectionChanged(DependencyObject obj, DependencyPropertyChangedEventArgs eventArgs)
    {
        var listingUserControl = (obj as ListingUserControl);
        var itemsResult = (eventArgs.NewValue as List<ItemsResult>);
        if (listingUserControl != null && itemsResult != null)
            listingUserControl.CountLabelVisible = itemsResult.Count > 0;
    } 
```

在我看来绑定

```
 <my:ListingUserControl ItemsCollection="{Binding Clients}" Title="Client" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T10:14:20.990

在这种情况下，就像 HighCore 所写的那样，它不会在 collectionchange 的情况下触发任何事件，而只会在绑定更改时触发一次。您可以做的是，检查有界集合是否实现了 INotifyCollectionChanged。喜欢：

```
var itemsResult = (eventArgs.NewValue as INotifyCollectionChanged);
if (itemsResult != null)
{ 
   itemsResult.CollectionChanged += OnItemsSourceCollectionChanged;
} 
```

然后您可以监视集合更改。

# objective-c - 使用后退按钮将数据传递到 ViewController

> ID：13534470
> 
> 赞同：3
> 
> 时间：2012-11-23T18:56:11.657
> 
> 标签：objective-c, ios, xcode

我在 ViewA 中有多个按钮。当一个按钮被点击时，它被重定向到 ViewB。在 ViewB 中，用户进行一些交互，然后在完成后单击返回按钮。如何运行方法并将参数从 ViewB 传递到 ViewA，然后继续在 ViewA 中工作？

强烈需要使用后退按钮，但我很想知道是否有其他方法。

我的想法是从堆栈中获取 ViewA，当我完成 ViewB 时，只需调用它并重定向，但我不知道该怎么做。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:04:29.810

您想在 ViewB 中定义一个委托并在 ViewA 中实现它。在适当的时候（例如，当点击后退按钮时）ViewB 调用委托方法，将值作为参数传递。

像这样的东西：

视图B.h

```
// Define a delegate protocol allowing 
@protocol ViewBDelegate

// Method of delegate called when user taps the 'back' button
-(void) backButtonSelected:(id) object;

@end

@interface ViewB : UIViewController

// property to hold a reference to the delegate
@property (weak)id<ViewBDelegate> delegate;

-(IBAction)backButtonSelected:(id)sender;

@end 
```

视图B.m：

```
@implementation ViewB

...

-(IBAction)backButtonSelected:(id)sender{
    NSObject *someObjectOrValue = nil;

    // Invoke the delegates backButtonSelected method, 
    // passing the value/object of interest
    [self.delegate backButtonSelected:someObjectOrValue];
}

@end 
```

视图A.h：

```
#import "ViewB.h"

//  The identifier in pointy brackets (e.g., <>) defines the protocol(s)
// ViewA implements
@interface ViewA : UIViewController <ViewBDelegate>

...

-(IBAction)someButtonSelected:(id)sender;

@end 
```

ViewA.m:

-(IBAction) someButtonSelected:id @implementation ViewA

```
...

// Called when user taps some button on ViewA (assumes it is "hooked up" 
// in the storyboard or IB
-(IBAction)someButtonSelected:(id)sender{

    // Create/get reference to ViewB.  May be an alloc/init, getting from storyboard, etc.
    ViewB *viewB = // ViewB initialization code

    // Set `ViewB`'s delegate property to this instance of `ViewA`
    viewB.delegate = self;
    ...
}

// The delegate method (defined in ViewB.h) this class implements
-(void)backButtonSelected:(id)object{
    // Use the object pass as appropriate
}

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T19:31:07.133

在 iOS6 中，您现在可以使用 Unwind Segues。在 Storyboard 中，您可能已经注意到可用于此目的的新退出按钮。

Unwind Segues 将允许您从 viewControllerB 转换回 viewControllerA 并通过 prepareForSegue 方法返回信息。

目前的文档相当有限，但是有一个有用的 WWDC2012 视频关于如何做到这一点（会议 236）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:10:08.677

如果您不想实现协议，那么另一种方法是，您可以在 ViewB 中创建 id 类型的属性，如下所示

> @property (nonatomic, unsafe_unretained) id* parentView;

并在像这样推送 ViewB 时将其设置为 ViewA

> ViewB.parentView = ViewA; //推视图B

然后你可以直接使用这个属性调用 ViewA 的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:05:46.520

您可以在 ViewControllerA 中定义一个协议，例如名称 ViewControllerADelegate，在 ViewControllerB 中创建一个属性委托，并在 ViewControllerB 中实现 ViewControllerA 中定义的协议。

当您在 viewControllerB 中工作时，您可以将所有更改通知给 ViewControllerADelegate 中定义的 viewControllerA 调用方法，当您离开 viewControllerB 时，您将更新 viewControllerA。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T19:06:22.707

如果您的 ViewA 正在创建 ViewB，您可以在 ViewB.h 上创建一个协议并将 ViewA 设置为 ViewB 的委托。所以每当你在 ViewB 中改变某些东西时，你可以直接通知 ViewA。

根据您的模型，您可以拥有一个包含您在 ViewB 中修改的任何设置的类。当你创建 ViewB 时，你通常会传递引用，因为它是一个对象，所以实例将被共享，所以当你回到 ViewA 时，所有的更改都已经应用了。

```
viewB.settings = self.settings; // or whatever model object you have 
```

另一种选择是创建一个自定义后退按钮（您将失去尖利的外观），让它调用您的自定义方法来通知您的 ViewA，然后执行 [self.navigationController popViewControllerAnimated:YES];

# javascript - 启动、停止和刷新计时器 javascript

> ID：13534472
> 
> 赞同：1
> 
> 时间：2012-11-23T18:56:21.617
> 
> 标签：javascript

我在这里开始/停止/重置javascript计时器[的地方有点小。](http://jsfiddle.net/xGASp/1/)

该功能需要是在页面上运行的计时器。当计时器到时，它会发送一条消息，然后重新启动。停止按钮将完全停止计时器。

上面的小提琴具有我刚刚描述的功能，但是我觉得我没有正确执行此操作。`setTimeout`创建这个计时器的正确方法是什么？我应该`setInterval`改用吗？

其次，我的重置代码如下所示：

```
var onReset = function() {
        clearTimeout(timerHandle);
        onStart();    
}; 
```

有没有更优雅的方法来重置 javascript 中的计时器？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:14:29.730

我能提供的唯一改进是让你把它全部放在一个封装的对象中，询问你是否想要一个例子。或者，如果您想保留已有的结构，则将 onStart 函数更改为此以删除一些不需要的代码。

```
var onStart = function() {

    timerHandle = setInterval(function() {
        $("#console").append("timer fired.. <br />");
    }, 2000);

}; 
```

在这里[摆弄 http://jsfiddle.net/qx6CM/](http://jsfiddle.net/qx6CM/)

# python - 当我使用“if string in list:”时，是否可以获得列表中的索引？

> ID：13534476
> 
> 赞同：1
> 
> 时间：2012-11-23T18:56:43.047
> 
> 标签：python, list, indexing

```
x = ['some', 'fairly', 'long', 'string']
if "fairly" in x:
    return index? 
```

有没有一种简单的方法来获得“相当”的索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:59:20.877

为什么不在块中使用内置`index`方法`try-except`？

```
lst = ["fairly","blue","car"]
x = "fairly"
try:
   print lst.index(x)
except ValueError:
   print "{0} not in list".format(x) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:01:48.220

像这样的东西会起作用吗？这在单词多次出现的情况下可能会有所帮助：

```
In [1]: x = ['some', 'fairly', 'long', 'string', 'another', 'fairly']

In [2]: f_places = [index for index, i in enumerate(x) if i == 'fairly']

In [3]: f_places
Out[3]: [1, 5] 
```

然后，您可以检查 using`if f_places:`并相应地返回值。

# wpf - 不同触发器的相同设置器

> ID：13534485
> 
> 赞同：3
> 
> 时间：2012-11-23T18:57:17.230
> 
> 标签：wpf, xaml, triggers

我有几个元素，如果“X”，它们应该看起来都一样。问题是，每个元素的“X”都不同，所以我不能轻易地为它们使用共享样式。但在所有情况下，setter 都是相同的，所以我希望将它们全部放在一个地方。我怎样才能做到这一点？

更具体地说，我有这个代码：

```
<TextBlock Name="text1">
    <TextBlock.Style>
        <Style TargetType="TextBlock">
            <Style.Triggers>
                <DataTrigger Binding="{Binding SelectedMonth, Converter={conv:IsNullConverter}}"
                             Value="False">
                    <Setter Property="Background" Value="RoyalBlue" />
                    <!-- possibly other setters -->
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock>
<TextBlock Name="text2">
    <TextBlock.Style>
        <Style TargetType="TextBlock">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                    <Setter Property="Background" Value="RoyalBlue" />
                    <!-- possibly other setters, same ones as above -->
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

在这里，我想把这两个`Setter`s放在一个共同的地方，这样我就不必总是一个一个地改变它们。有没有办法做到这一点？

我尝试将一个集合`Setter`放在一起，然后使用类似`DataTrigger.Setters="{StaticResource SharedSetters}"`. 这不起作用，但如果它起作用，那将正是我想要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:17:05.470

首先，您可以有一个通用样式，它是所有其他样式的基础（BasedOn 属性）。此样式将包含一个由自定义布尔附加属性控制的普通触发器，以及您要重用的设置器。然后，在基于基本样式的其他样式中，您的 DataTriggers 将只设置附加属性，而让基本样式设置所有其他属性。

假设您已经在`IsSelected`type 上创建了附加属性`Foo`，则基本样式将类似于：

```
<Style x:Key="IsSelectedStyle" TargetType="TextBlock">
    <Style.Triggers>
        <Trigger Property="local:Foo.IsSelected" Value="True">
            <Setter Property="Background" Value="RoyalBlue" />
            <!-- possibly other setters -->
        </Trigger>
    </Style.Triggers>
</Style> 
```

然后你会像这样使用它：

```
<TextBlock>
    <TextBlock.Style>
        <Style TargetType="TextBlock" BasedOn="{StaticResource IsSelectedStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                    <Setter Property="local:Foo.IsSelected" Value="True" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:07:14.060

将设置器的值移动到静态资源并在设置器中设置键。

```
<SolidColorBrush x:Key="keyName" Color="RoyalBlue" /> 
```

和

```
<Setter Property="Background" Value="{StaticResource keyName}" /> 
```

在你的代码中。

现在您可以更改“keyName”的画笔，它会影响所有设置器。

# xcode4 - Xcode静态库出现两次

> ID：13534486
> 
> 赞同：0
> 
> 时间：2012-11-23T18:57:18.847
> 
> 标签：xcode4

我在 Xcode 中添加了 OCMock 静态库和一些头文件。

我不确定自从我添加它后发生了什么变化，但该文件现在在项目导航器中出现了两次——一次在顶层，一次在 usr/lib 文件夹下。

![复制](../Images/5e1f32b3509d0740a48702631df0595d.png)

如何摆脱第二个（突出显示的）列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T06:53:13.183

看起来您`usr`通过文件夹引用添加了 OCMock 的整个“”文件夹，这很可能是偶然的。

对于解决方案，您有三种选择：

1)

`usr`从项目中的文件和文件夹列表中删除“ ”文件夹，并`include`通过文件夹引用重新添加“”文件夹（我假设您想使用文件夹引用，以便您可以获取最新的头文件在那里？）。

2)

将所需的头文件直接添加到您的项目中（即不使用文件夹引用）。

3)

或者去掉第一个“ `libOCMock.a`”库，只依靠文件夹引用来获取“ `usr`”层次结构下的静态库。

# c# - 模拟一个完整的 post 请求

> ID：13534490
> 
> 赞同：2
> 
> 时间：2012-11-23T18:57:29.437
> 
> 标签：c#, post, webclient

我正在尝试使用 WebClient 模拟发布请求；但是，当使用 Firefox 登录并使用 firebug 调试请求时，我发现在 POST 请求之后它会自动执行一些 GET 请求，而使用我的代码只执行 POST 请求

我的代码

```
//Handler is an overridden WebClient Class
        private async Task<byte[]> Post(string uri, string[] data)
        {
            var postData = new NameValueCollection();

            foreach (var info in data.Select(var => var.Split('=')))
            {
                postData.Add(info[0], info[1]);
            }

            return await Handler.UploadValuesTaskAsync(new Uri(uri), postData);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T23:29:23.567

我知道这不是您所要求的，并且它在 VB 中，但希望它可以帮助您指出正确的方向。这是我用来在我们的一个网站上发出帖子请求的工具。它适用于模拟 POST 数据，希望您可以将其中的一些融入到您正在做的事情中。

```
 Dim postData As String = String.Format("RedirectLocation=RequestMethod=&username={0}&password={1}", _username, _password)

   Dim _loginRequest As HttpWebRequest = WebRequest.Create(loginurl)

           With _loginRequest
                .Method = "POST"
                .ContentLength = postData.Length
                .ContentType = "application/x-www-form-urlencoded"                        
                .KeepAlive = True
                .AllowAutoRedirect = False

                .CookieContainer =  New CookieContainer

                Using writer As New StreamWriter(.GetRequestStream)
                    writer.Write(postData)
                End Using
                .Timeout = tsTimeOut.TotalMilliseconds
                _loginResponse = .GetResponse()
            End With 
```

# javascript - jQuery .before 的问题

> ID：13534491
> 
> 赞同：4
> 
> 时间：2012-11-23T18:57:29.710
> 
> 标签：javascript, jquery, html

所以我正在构建一个非常简单的带有 4 个 div 的轮播。它使用 2 个 jQuery 函数将 div 设置为第一个或最后一个位置。只有 alpha 转换，因为我不需要移动。

出于某种原因，虽然我可以使用 .eg(n) 等访问我的 div，但第一个、最后一个和其他各种数字在此函数中不起作用。

代码：

```
$('#prev').click(function() {

    $('.container .divname').animate({opacity: 0}, 1000,function(){ 

     $('.container .divname:first').before($('.container .divname:last')); 

     $('.container .divname').animate({opacity: 1}, 1000); 

    });

    return false;

}); 
```

所以这个功能不起作用。

```
$('#prev').click(function() {

        $('.container .divname').animate({opacity: 0}, 1000,function(){ 

         $('.container .divname:eq(0)').before($('.container .divname:eq(3)')); 

         $('.container .divname').animate({opacity: 1}, 1000); 

        });

        return false;

    }); 
```

这也不起作用，但是如果我将**eq(3)**更改为**eq(2)**它可以，但显然错过了我的一个 div。我仍然可以访问 eq(3)，因为我对其进行了测试，并将其设置为红色背景。

```
$('.container .divname:eq(3)').css({'background-color' : '#ff0000'}); 
```

这有效...

谁能告诉我为什么会发生这种情况？

html示例如下

```
<html>
     <div class="container">
          <div class="divname">
               <p>some content</p>
          </div>
          <div class="divname">
               <p>some content</p>
          </div>
          <div class="divname">
               <p>some content</p>
          </div>
          <div class="divname">
               <p>some content</p>
          </div>
     </div>
</html> 
```

**编辑：**

我已经为观众中的 w3c 孩子们将所有 id 更改为 class。问题仍然存在。

[http://jsfiddle.net/3P8t5/1/](http://jsfiddle.net/3P8t5/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T20:49:33.840

您的问题的根源是您已将 .before() 函数用于在附加到四个 div 的回调函数中移动 div - 因此它被称为四次，这意味着所有内容都被移动了四次，使您回到第一方.. .并且因为它是一个如此简单的小循环，它很快而且似乎什么也没发生。

解决方案 - 仅将动画功能附加到容器；

```
$('#prev').click(function() {

// Fade just the container - not each placeholder meaning the callback function is only called once, not four times
$('.container').animate({
    opacity: 0
}, 1000, function() {

    $('.container .divname:eq(0)').before($('.container .divname:eq(3)'));

    // Fade back in just the container - not each placeholder
    $('.container').animate({
        opacity: 1
    }, 1000);
});
return false;
});​ 
```

[http://jsfiddle.net/cywjs/1/](http://jsfiddle.net/cywjs/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:04:09.083

除了朋友建议（ID 应该是唯一的）之外，我在您的代码中看到拼写错误。在 div 标签中更改`"divnaname"`为。例如：`"divname"``<div id="divnaname"> ... <div>`

**编辑：**

检查这个演示[演示](http://jsfiddle.net/3P8t5/)

这是你想要做的吗？

# knockout.js - 使用 Knockout.js 在 HTML 元素中嵌入 JSON 元素

> ID：13534495
> 
> 赞同：3
> 
> 时间：2012-11-23T18:57:51.857
> 
> 标签：knockout.js

我正在尝试检索用于构造模板的原始 JSON 并将其填充到 textarea 元素中。

JSON 的结构是一个 JSON 对象数组，其中包含三个属性，可以很好地填写我的模板。我想不通的是如何在每次迭代中获取原始 JSON 元素并将其显示在文本区域中。

我对这个问题的描述可能有点迟钝，所以希望 JSFiddle 示例能更好地描述这一点。

**Javascript**

```
function MyViewModel() {
    this.model = [{
        "Key": "c1243328-4796-46c0-bb32-017d5a1ebdd4",
        "UserId": "02ad61b1-d416-46d4-98ac-d5f6c2b7d104",
        "Name": "\"old.txt\""},
    {
        "Key": "265c23ea-2d2a-459e-9f51-32837e058d01",
        "UserId": "02ad61b1-d416-46d4-98ac-d5f6c2b7d104",
        "Name": "\"sample.dwg\""}];
};

ko.applyBindings(new MyViewModel()); 
```

**HTML 模板**

```
<div data-bind="template: { name: 'template', foreach: model}"></div>

<script type="text/html" id="template">
    <p>
        <span data-bind="text: Key"></span>
        <span data-bind="text: UserId"></span>
        <span data-bind="text: Name"></span>
    </p>
    <p><textarea data-bind="text: ???"/></p>
</script>​ 
```

我想在 textarea 中查看实际的 JSON 元素，但我不确定完成此操作需要什么。

以上运行在[jsFiddle](http://jsfiddle.net/thewiseguy99/E9zX9/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:18:21.010

You can use the `$data` [contextual binding](http://knockoutjs.com/documentation/binding-context.html) property which represents the current viewmodel and the `ko.toJSON` helper method to output it as a string:

```
<textarea data-bind="text: ko.toJSON($data)"/> 
```

See in action in [this fiddle.](http://jsfiddle.net/nemesv/E9zX9/3/)

# gtk - 使用 AdaGtk 读取键盘输入

> ID：13534497
> 
> 赞同：0
> 
> 时间：2012-11-23T18:57:54.750
> 
> 标签：gtk, ada

我将 Ada 与 Gtk 库一起使用。我想阅读用户的键盘输入并单独对其做出反应，具体取决于他/她按下的键。如何访问用户的键盘输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:11:37.200

我不确定您在寻找什么：1) 击键或 2) 可编辑文本。

1.  游戏在程序中[`LinXtris`](https://sourceforge.net/projects/linxtris/?source=directory)处理主窗口[`key_press_event`](http://linxtris.cvs.sourceforge.net/viewvc/linxtris/linxtris/src/main_window_pkg.adb?revision=1.15&view=markup)信号[`On_Main_Window_Key_Pressed`](http://linxtris.cvs.sourceforge.net/viewvc/linxtris/linxtris/src/main_window_pkg-callbacks.adb?revision=1.5&view=markup)，将每个信号传递`Gdk.Event.Gdk_Event_Key`给`Game_Engine`.

2.  [此处](https://stackoverflow.com/a/13514358/230513)[`Interaction`](http://rosettacode.org/wiki/GUI_component_interaction#Ada)引用的演示在过程中有一个处理。优点是处理程序被调用为单个击键，以及粘贴的文本。`Gtk.Editable``Signal_Insert_Text``On_Insert_Text`

# jquery - 通过在容器内拖动内容来滚动 Jscrollpane？

> ID：13534501
> 
> 赞同：4
> 
> 时间：2012-11-23T18:57:57.713
> 
> 标签：jquery, jscrollpane

我想知道，是否可以像用手指在 iPhone 上一样通过单击和拖动来滚动内容？

[这是 jsfiddle 上的 Jscrollpane 示例](http://jsfiddle.net/kHvHb/2/)

我考虑过将滚动条扩展到整个区域并使其不可见，但是我想在内部保持图层单击功能。

```
<div id="maincontainer">
    <div id="MenuList" class="scroll-pane">
        <div id="somelayer-one" onclick="alert('Jquery Function');">text</div>
</div></div> 
```

这可能吗？谢谢！

**附加信息**

我尝试查看原始插件并尝试修改它：

```
function initialiseVerticalScroll()
            {
                if (isScrollableV) {

                    container.append(
                        $('<div class="jspVerticalBar" />').append(
                            $('<div class="jspCap jspCapTop" />'),
                            $('<div class="jspTrack" />').append(
                                $('<div class="jspDrag" />').append(
                                    $('<div class="jspDragTop" />'),
                                    $('<div class="jspDragBottom" />')
                                )
                            ),
                            $('<div class="jspCap jspCapBottom" />')
                        )
                    );

                    verticalBar = container.find('>.jspVerticalBar');
                    verticalTrack = verticalBar.find('>.jspTrack');
                    verticalDrag = verticalTrack.find('>.jspDrag');

                    if (settings.showArrows) {
                        arrowUp = $('<a class="jspArrow jspArrowUp" />').bind(
                            'mousedown.jsp', getArrowScroll(0, -1)
                        ).bind('click.jsp', nil);
                        arrowDown = $('<a class="jspArrow jspArrowDown" />').bind(
                            'mousedown.jsp', getArrowScroll(0, 1)
                        ).bind('click.jsp', nil);
                        if (settings.arrowScrollOnHover) {
                            arrowUp.bind('mouseover.jsp', getArrowScroll(0, -1, arrowUp));
                            arrowDown.bind('mouseover.jsp', getArrowScroll(0, 1, arrowDown));
                        }

                        appendArrows(verticalTrack, settings.verticalArrowPositions, arrowUp, arrowDown);
                    }

                    verticalTrackHeight = paneHeight;
                    container.find('>.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow').each(
                        function()
                        {
                            verticalTrackHeight -= $(this).outerHeight();
                        }
                    );

                    verticalDrag.hover(
                        function()
                        {
                            verticalDrag.addClass('jspHover');
                        },
                        function()
                        {
                            verticalDrag.removeClass('jspHover');
                        }
                    ).bind(
                        'mousedown.jsp',
                        function(e)
                        {
                            // Stop IE from allowing text selection
                            $('html').bind('dragstart.jsp selectstart.jsp', nil);

                            verticalDrag.addClass('jspActive');

                            var startY = e.pageY - verticalDrag.position().top;

                            $('html').bind(
                                'mousemove.jsp',
                                function(e)
                                {
                                    positionDragY(e.pageY - startY, false);
                                }
                            ).bind('mouseup.jsp mouseleave.jsp', cancelDrag);
                            return false;
                        }
                    );
                    sizeVerticalScrollbar();
                }
            } 
```

我改为`verticalDrag = verticalTrack.find('>.jspDrag');`，`verticalDrag = verticalTrack.find('>#somelayer-one');`但是由于某种原因这不起作用。但是，我认为如果更改得当 - 这可能会奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T17:31:29.243

尝试这个。是你要找的吗？

```
function initialiseVerticalScroll()
            {
                if (isScrollableV) {

                    container.append(
                        $('<div class="jspVerticalBar" />').append(
                            $('<div class="jspCap jspCapTop" />'),
                            $('<div class="jspTrack" />').append(
                                $('<div class="jspDrag" />').append(
                                    $('<div class="jspDragTop" />'),
                                    $('<div class="jspDragBottom" />')
                                )
                            ),
                            $('<div class="jspCap jspCapBottom" />')
                        )
                    );

                    verticalBar = container.find('>.jspVerticalBar');
                    /* ADDED CODE */
                    verticalBar.width(0);
                    /* ADDED CODE */
                    verticalTrack = verticalBar.find('>.jspTrack');
                    verticalDrag = verticalTrack.find('>.jspDrag');

                    if (settings.showArrows) {
                        arrowUp = $('<a class="jspArrow jspArrowUp" />').bind(
                            'mousedown.jsp', getArrowScroll(0, -1)
                        ).bind('click.jsp', nil);
                        arrowDown = $('<a class="jspArrow jspArrowDown" />').bind(
                            'mousedown.jsp', getArrowScroll(0, 1)
                        ).bind('click.jsp', nil);
                        if (settings.arrowScrollOnHover) {
                            arrowUp.bind('mouseover.jsp', getArrowScroll(0, -1, arrowUp));
                            arrowDown.bind('mouseover.jsp', getArrowScroll(0, 1, arrowDown));
                        }

                        appendArrows(verticalTrack, settings.verticalArrowPositions, arrowUp, arrowDown);
                    }

                    verticalTrackHeight = paneHeight;
                    container.find('>.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow').each(
                        function()
                        {
                            verticalTrackHeight -= $(this).outerHeight();
                        }
                    );

                    verticalDrag.hover(
                        function()
                        {
                            verticalDrag.addClass('jspHover');
                        },
                        function()
                        {
                            verticalDrag.removeClass('jspHover');
                        }
                    ).bind(
                        'mousedown.jsp',
                        function(e)
                        {
                            // Stop IE from allowing text selection
                            $('html').bind('dragstart.jsp selectstart.jsp', nil);

                            verticalDrag.addClass('jspActive');

                            var startY = e.pageY - verticalDrag.position().top;

                            $('html').bind(
                                'mousemove.jsp',
                                function(e)
                                {
                                    positionDragY(e.pageY - startY, false);
                                }
                            ).bind('mouseup.jsp mouseleave.jsp', cancelDrag);
                            return false;
                        }
                    );
                    /* ADDED CODE */
                    container.bind("mousedown.jsp", function (e) 
                { 
                    // Stop IE from allowing text selection
                    $('html').bind('dragstart.jsp selectstart.jsp', nil);

                    var startY = verticalDrag.position().top;
                    var initialY = e.pageY;
                    $('html').bind(
                        'mousemove.jsp',
                        function(e)
                        {
                            positionDragY(startY - (e.pageY - initialY), false);
                        }
                    ).bind('mouseup.jsp mouseleave.jsp', cancelDrag);
                    return false;
                });
                    /* ADDED CODE */
                    sizeVerticalScrollbar();
                }
            } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T20:03:44.797

扩展滚动条并使其不可见。我很确定这将比您所要求的要困难得多。它可能已经完成了一百万次，并且可能 draggable() 可以工作......但没有任何插件：

CSS

```
#maincontainer
{
    position:absolute;
}​ 
```

jQuery

```
$('#maincontainer').on('mousedown', function(e){
    $(this).data('held', e.screenY - $(this).offset().top);
}).on('mouseup', function(){
    $(this).data('held', false);
}).on('mousemove', function(e){
    if ($(this).data('held')!=false) $(this).css({top:e.screenY - $(this).data('held')});
});​ 
```

编辑：使用你的 html，这个[http://jsfiddle.net/apDrX/1/](http://jsfiddle.net/apDrX/1/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T14:02:31.307

不是一个真正的答案，因为它没有描述调整 jScrollPane，**但**我建议使用名为[iScroll](http://cubiq.org/iscroll-4)的（令人难以置信的强大）插件，**如果**它是切换插件的选项。

它的工作几乎相同，让您自定义滚动条（与 jScrollPane 一样），与移动浏览器兼容，在可用的情况下使用硬件加速 CSS 转换，在其容器中保留点击功能等。

[http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-23T20:00:42.730

尝试这个：

[http://jsfiddle.net/khvHb/5/](http://jsfiddle.net/kHvHb/5/)

```
​var scroll = $('.scroll-pane').jScrollPane();
var api = scroll.data('jsp');

$('.jspPane div').mouseup(function(){
    var miY = $(this).position().top + $('.jspPane').position().top
    console.log( $('.jspPane').position().top);
    api.scrollTo(0,miY);
    return false
})

​ 
```

# ios - iOS loadNibNamed 混乱，什么是最佳实践？

> ID：13534502
> 
> 赞同：23
> 
> 时间：2012-11-23T18:58:02.567
> 
> 标签：ios, uiview, init, iboutlet, loadnibnamed

我熟悉为我自己的 UIView 子类创建 XIB 的大部分过程，但并非一切对我来说都正常工作 - 这主要与 IBOutlets 链接有关。我可以让他们以一种迂回的方式工作。

我的设置是这样的：

*   我有 MyClass.h 和 MyClass.m。他们有用于 UIView（称为视图）和 UILabel（称为 myLabel）的 IBOutlets。我添加了“视图”属性，因为网上的一些示例似乎表明您需要这个，它实际上解决了我因为找不到视图属性而崩溃的问题，我想即使在 UIView 父类中也没有.
*   我有一个名为 MyClass.xib 的 XIB 文件，它的 File's Owner 自定义类是 MyClass，在该类的 .h 和 .m 存在之后正确预填充。

我的 init 方法是我遇到问题的地方。

我尝试使用 NSBundle mainBundle 的“loadNibNamed”方法并将所有者设置为“self”，希望我会创建一个视图实例，并且它会自动使其插座与我班级中的插座相匹配（我知道如何做到这一点，我很小心）。然后我想我想让'self'等于那个笔尖中索引0处的子视图，而不是做

```
self = [super init]; 
```

或类似的东西。

我觉得我在这里做错了，但是在线示例在 init 方法中发生了类似的事情，但是他们将该子视图 0 分配给 view 属性并将其添加为子视图-但这不是总共两个 MyClass 实例？一个基本上与 IBOutlets 无关，包含通过 loadNibNamed 实例化的子 MyClass？或者充其量，它不是一个带有额外中间 UIView 的 MyClass 实例，其中包含我最初想要作为 MyClass 的直接子级的所有 IBOutlets？当涉及到像 instanceOfMyClass.frame.size.width 这样的事情时，这会带来一点烦恼，因为它返回 0，而当引入的子 UIView 返回我正在寻找的真实帧大小时。

我做错的事情是我在 init 方法中弄乱了 loadNibNamed 吗？我应该做更多这样的事情吗？

```
MyClass *instance = [[MyClass alloc] init];
[[NSBundle mainBundle] loadNibNamed:@"MyClass" owner:instance options:nil]; 
```

还是像这样？

```
MyClass *instance = [[[NSBundle mainBundle] loadNibNamed:@"MyClass" owner:nil options:nil] objectAtIndex:0]; 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-23T19:13:35.497

第二个选项是正确的。你可以做的最具防御性的代码是这样的：

```
+ (id)loadNibNamed:(NSString *)nibName ofClass:(Class)objClass {
    if (nibName && objClass) {
        NSArray *objects = [[NSBundle mainBundle] loadNibNamed:nibName 
                                                         owner:nil 
                                                       options:nil];            
        for (id currentObject in objects ){
            if ([currentObject isKindOfClass:objClass])
                return currentObject;
        }
    }

    return nil;
} 
```

并像这样调用：

```
MyClass *myClassInstance = [Utility loadNibNamed:@"the_nib_name" 
                                         ofClass:[MyClass class]]; 
// In my case, the code is in a Utility class, you should 
// put it wherever it fits best 
```

我假设您的 MyClass 是`UIView`? 如果是这种情况，那么您需要确保`UIView`.xib 实际上是 MyClass 类。选择视图后，在界面构建器右侧的第三个选项卡上定义

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-23T19:14:00.103

您需要做的就是通过创建子视图`loadNibNamed`，设置框架并将其添加到子视图中。例如，我正在使用我`MyView`的类添加三个子视图，这是一个`UIView`子类，其接口在 NIB 中定义，`MyView.xib`：

所以，我`initWithFrame`为我的`UIView`子类定义：

```
- (id)initWithFrame:(CGRect)frame
{
    NSLog(@"%s", __FUNCTION__);

    self = [super initWithFrame:frame];
    if (self)
    {
        NSArray *nibContents = 
          [[NSBundle mainBundle] loadNibNamed:@"MyView" 
                                        owner:self 
                                      options:nil];
        [self addSubview:nibContents[0]];
    }
    return self;
} 
```

因此，例如，在 my 中`UIViewController`，我可以像这样加载几个这样的子类`UIView`对象：

```
for (NSInteger i = 0; i < 3; i++)
{
    CGRect frame = CGRectMake(0.0, i * 100.0 + 75.0, 320.0, 100.0);
    MyView *myView = [[MyView alloc] initWithFrame:frame];
    [self.view addSubview:myView];

    // if you want, do something with it: 
    // Here I'm initializing a text field and label

    myView.textField.text = [NSString stringWithFormat:@"MyView textfield #%d",
                              i + 1];
    myView.label.text = [NSString stringWithFormat:@"MyView label #%d", 
                          i + 1];
} 
```

我最初建议使用控制器，我将在下面保留该答案以供历史参考。

* * *

**原答案：**

我在这里看不到任何对视图控制器的引用。通常你会有一个 的子类 `UIViewController`，然后你会用它来实例化

```
MyClassViewController *controller = 
  [[MyClassViewController alloc] initWithNibName:@"MyClass" 
                                          bundle:nil];

// then you can do stuff like
//
// [self presentViewController:controller animated:YES completion:nil]; 
```

如果需要，NIB 文件`MyClass.xib`可以指定 的基类`UIView`，您可以在其中拥有所有与视图相关的代码（例如，假设 MyClass 是 的子类`UIView`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T20:36:02.260

这是我使用的一种方法：

1.  为 创建一个子类`UIView`，这将被调用`MyClass`
2.  创建一个视图 xib 文件。在界面生成器中打开，单击文件的所有者，然后在身份检查器中，将类更改为父视图控制器的类，例如 `ParentViewController`.
3.  单击对象列表中已有的视图并将其在 Identity Inspector 中的类更改为`MyClass`。
4.  您声明的任何出口/操作`MyClass`都将通过从视图（不是文件的所有者）单击拖动来连接。如果要将它们连接到变量，`ParentViewController`请从文件所有者单击拖动。
5.  现在，您`ParentViewController`需要为`MyClass`.

`ParentViewController.h`添加以下内容：

```
@class MyClass

@interface ParentViewController : UIViewController {
    MyClass *myClass;
}

@property (strong, nonatomic) MyClass *myClass; 
```

在您的实现中综合它并在您的 `viewDidLoad`方法中添加以下内容：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    [[NSBundle mainBundle] loadNibNamed:@"MyClass" owner:self options:nil];
    self.myClass.frame = CGRectMake(X,Y,W,H); //put your values in.
    [self.view addSubview:self.myClass];
} 
```

# ubuntu - 如何构建 avr-g++ 4.6.3

> ID：13534510
> 
> 赞同：0
> 
> 时间：2012-11-23T18:58:58.643
> 
> 标签：ubuntu, g++, avr

我一直在尝试构建 avr-g++ 4.6.3，但只能找到有关如何获取 avr-g++ 4.5.3（通过 apt-get）的说明。有人知道在 Ubuntu 11.10 上成功构建 avr-g++ 4.6.3 的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T21:16:52.803

# magento - Magento 正确调用翻译

> ID：13534517
> 
> 赞同：1
> 
> 时间：2012-11-23T18:59:32.467
> 
> 标签：magento

以下哪一项在功能上是在 Magento 中调用帮助程序的正确方法：

```
Mage::helper('helper_class)->__('String to be translated); 
```

v

```
$this->__('String to be translated); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:03:06.880

两个都！

这真的取决于你在哪里调用它以及你的翻译在哪里。

让我们来看看它们。首先这个：

```
$this->__('String to be translated); 
```

如果在助手类本身内部调用它，它将返回该助手所属模块的翻译。否则它将返回核心 Magento 翻译。

```
Mage::helper('helper_class)->__('String to be translated); 
```

在所有其他情况下，必须使用此代码来获取特定模块的翻译。

# javascript - 这个 JavaScript 数组 + 对象有什么问题？

> ID：13534518
> 
> 赞同：-1
> 
> 时间：2012-11-23T18:59:38.787
> 
> 标签：javascript, arrays, object

这是代码学院的任务：

> 制作一个名为`newArray`. 它应该是二维的（也就是说，它应该包含两个元素，而这两个元素又是数组）和锯齿状的（这两个数组应该有不同的长度）。
> 
> 终极杀手？使您的内部数组之一包含一个对象！

那我在这里做错了什么？

```
var myObj = {
    name: 2
};

var newArray = [[1,1,1],[2,2],myObj; 
```

错误：

糟糕，再试一次。确保其中一行中的至少一个元素是对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:00:47.750

您从未关闭数组的括号。用这个：

```
var newArray = [ [1, 1, 1], [2, 2], myObj ]; 
```

更新：

根据您更新的帖子，这是修改后的代码：

```
var newArray = [ [1, 1, 1], [2, myObj] ]; 
```

这个新数组有两个元素，每个元素都有不同的长度，其中一个元素拥有一个对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:04:11.323

代码中的语法错误。

```
var newArray = [[1,1,1],[2,2],myObj; 
```

你错过了关闭打开的数组`]`。

# c - 如何计算子弹击中的位置

> ID：13534519
> 
> 赞同：3
> 
> 时间：2012-11-23T18:59:38.933
> 
> 标签：c, opengl, frame-rate, projectile

我一直在尝试在 C/X11/OpenGL 中编写 FPS，但我遇到的问题是计算子弹击中的位置。我使用了一种*可怕*的技术，它只在某些时候有效：

```
pos size, p;
size.x = 0.1;
size.z = 0.1; // Since the game is technically top-down (but in a 3D perspective)
              // Positions are in X/Z, no Y
float f; // Counter
float d = FIRE_MAX + 1 /* Shortest Distance */, d1 /* Distance being calculated */;
x = 0; // Index of object to hit
for (f = 0.0; f < FIRE_MAX; f += .01) {
    // Go forwards
    p.x = player->pos.x + f * sin(toRadians(player->rot.x));
    p.z = player->pos.z - f * cos(toRadians(player->rot.x));
    // Get all objects that collide with the current position of the bullet
    short* objs = _colDetectGetObjects(p, size, objects);
    for (i = 0; i < MAX_OBJECTS; i++) {
        if (objs[i] == -1) {
            continue;
        }
        // Check the distance between the object and the player
        d1 = sqrt(
                pow((objects[i].pos.x - player->pos.x), 2)
                        + pow((objects[i].pos.z - player->pos.z),
                                2));
        // If it's closer, set it as the object to hit
        if (d1 < d) {
            x = i;
            d = d1;
        }
    }
    // If there was an object, hit it
    if (x > 0) {
        hit(&objects[x], FIRE_DAMAGE, explosions, currtime);
        break;
    }
} 
```

它只是通过创建一个 for 循环并计算可能与子弹当前所在位置发生碰撞的任何对象来工作。当然，这*非常*慢，有时甚至不起作用。

计算子弹击中位置的首选方法是什么？我曾想过制作一条线并查看是否有任何物体与该线发生碰撞，但我不知道如何进行这种碰撞检测。

* * *

**编辑：**我想我的问题是：如何计算最近的物体在一条线上碰撞（可能不是直的 45/90 度角）？或者有没有更简单的方法来计算子弹击中的位置？子弹有点像激光，因为重力不会影响它（写一个老式游戏，所以我不希望它太现实）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T23:03:05.340

对于您希望被击中的每个对象，定义一个边界对象。简单的例子是一个球体或一个盒子。然后你必须实现一个射线球或射线盒相交。

例如，看看[line-sphere intersection](http://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection)。对于框，您可以同时测试四个边界线，但有一些算法针对[轴对齐框](http://www.siggraph.org/education/materials/HyperGraph/raytrace/rtinter3.htm)进行了优化。

有了这个，像你已经做的那样继续。对于场景中的每个对象，检查是否相交，如果相交，则将距离与之前相交的对象进行比较，取最先被击中的对象。相交算法为您提供光线参数作为结果（值 t `hit_position = ray_origin + t * ray_direction`），您可以使用它来比较距离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T23:08:28.200

[您可以在BSP 树](http://en.wikipedia.org/wiki/Binary_space_partitioning)中组织所有场景对象，然后命中\碰撞检测将很容易实现。您还可以使用 BSP 检测不可见对象并在渲染前丢弃它们。

# android - 绑定 Jar 库

> ID：13534521
> 
> 赞同：2
> 
> 时间：2012-11-23T18:59:47.630
> 
> 标签：android, xamarin.android, java-binding

我正在尝试在 MFA 上绑定一个 jar 库（jCIFS），但我遇到了一些错误，比如这个：

'Jcifs.Util.MD4' 没有实现继承的抽象成员 'Java.Security.MessageDigestSpi.EngineDigest()

经过一番研究，我发现了一些关于此的主题，告诉编辑元数据以更改类的权限，如下所示：

```
<attr path="/api/package[@name='java.security']/class[@name='MessageDigestSpi']/method[@name='engineDigest']" name="visibility">public</attr> 
```

但是错误并没有改变，并且仍然无法理解这个错误的含义。

任何人 ？

**编辑**：这是返回错误的虚拟类的代码：

```
 public virtual byte[] EngineDigest ()
    {
        if (id_engineDigest == IntPtr.Zero)
            id_engineDigest = JNIEnv.GetMethodID (class_ref, "engineDigest", "()[B");

        if (GetType () == ThresholdType)
            return (byte[]) JNIEnv.GetArray (JNIEnv.CallObjectMethod  (Handle, id_engineDigest), JniHandleOwnership.TransferLocalRef, typeof (byte));
        else
            return (byte[]) JNIEnv.GetArray (JNIEnv.CallNonvirtualObjectMethod  (Handle, ThresholdClass, id_engineDigest), JniHandleOwnership.TransferLocalRef, typeof (byte));
    } 
```

我在一个新文件中添加了这个：

```
partial class MD4
{
    public override byte[] EngineDigest()
    {
        return null;
    }
} 
```

如果我这样做，则会返回此错误：

*错误 1 ​​类型“Jcifs.Util.MD4”已经定义了一个名为“EngineDigest”的成员，具有相同的参数类型*

据我了解，EngineDigest 方法已经存在，但是该类需要实现它。我该怎么做？

完整错误：*错误 195 'Jcifs.Util.MD4' 没有实现继承的抽象成员 'Java.Security.MessageDigestSpi.EngineDigest()* '

**编辑 2：**我尝试使用 xamarin 站点中的 OsmDroidBinding 示例来回答问题。我编辑了元文件，直到出现类似的错误。我发现的其中一条是：

```
<attr path="/api/package[@name='org.osmdroid.tileprovider']/class[@name='MapTileProviderBase.ScaleTileLooper']/method[@name='handleTile']" name="visibility">public</attr> 
```

我得到这个错误： ![错误](../Images/7dce453b21c21680215e0b17c5080613.png)

然后我尝试将它添加到我的项目元文件（如上），但错误仍然存​​在：

```
<attr path="/api/package[@name='java.security']/class[@name='MessageDigestSpi']/method[@name='engineDigest']" name="visibility">public</attr> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T23:01:08.880

它告诉您生成的类 Jcifs.Util.MD4 没有实现继承的抽象方法。抽象方法是必须被任何派生类覆盖的方法。

下面的代码将基类方法的可见性更改为公共，这显然无法解决问题。

```
<attr path="/api/package[@name='java.security']/class[@name='MessageDigestSpi']/method[@name='engineDigest']" name="visibility">public</attr> 
```

有几种方法可以修复此错误。也许最简单的方法是将一个类文件添加到您的 Java 绑定库并添加以下代码。

```
namespace Jcifs.Util
{
    public partial class MD4
    {
        public override void EngineDigest()
        {

        }
    }
} 
```

**注意**您需要将返回类型更改`EngineDigest()`为为基类中的抽象方法定义的返回类型。你没有在你的问题中提到返回类型，所以我做到了`void`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T16:22:20.220

改变

公共覆盖字节[] EngineDigest()

至

受保护的覆盖字节[] EngineDigest ()

# asp.net-mvc - 使模型绑定适用于没有默认构造函数的模型

> ID：13534524
> 
> 赞同：4
> 
> 时间：2012-11-23T19:00:04.020
> 
> 标签：asp.net-mvc, model

我一直在想办法让模型绑定继续使用带有参数的构造函数的模型。

那个行动：

```
 [HttpPost]
        public ActionResult Create(Company company, HttpPostedFileBase logo)
        {
            company.LogoFileName = SaveCompanyLogoImage(logo);
            var newCompany = _companyProvider.Create(company);
            return View("Index",newCompany);
        } 
```

和模型

```
public  Company(CustomProfile customProfile)
        {
            DateCreated = DateTime.Now;
            CustomProfile = customProfile;
        } 
```

我已经完成了我的研究，似乎我需要弄乱我的 ninjectControllerfactory：

```
 public class NinjectControllerFactory : DefaultControllerFactory
    {
        private readonly IKernel ninjectKernel;

        public NinjectControllerFactory()
        {
            ninjectKernel = new StandardKernel();
            AddBindings();
        }

        protected override IController GetControllerInstance(RequestContext requestContext,
                                                             Type controllerType)
        {
            return controllerType == null
                       ? null
                       : (IController) ninjectKernel.Get(controllerType);
        }

        private void AddBindings()
        {
            ninjectKernel.Bind<IAuthProvider>().To<FormsAuthProvider>();
            ninjectKernel.Bind<IMembershipProvider>().To<MembershipProvider>();
            ninjectKernel.Bind<ICustomProfileProvider>().To<CustomProfileProvider>();
            ninjectKernel.Bind<ICompanyProvider>().To<CompanyProvider>();
        }
    } 
```

我也觉得我需要修改我的模型活页夹，但我不清楚前进的方向：

```
 public class CustomProfileModelBinder : IModelBinder
{
    private const string sessionKey = "CustomProfile";

    #region IModelBinder Members

    public object BindModel(ControllerContext controllerContext,
                            ModelBindingContext bindingContext)
    {
        // get the Cart from the session 
        var customProfile = (CustomProfile) controllerContext.HttpContext.Session[sessionKey];
        // create the Cart if there wasn't one in the session data
        if (customProfile == null)
        {
            customProfile = new CustomProfile("default name");
            controllerContext.HttpContext.Session[sessionKey] = customProfile;
        }
        // return the cart
        return customProfile;
    }

    #endregion
} 
```

希望这能解释我的问题，如果这是一个相当冗长的问题，我很抱歉！

感谢您的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-23T20:48:28.763

在这种情况下，您需要创建的参数（CustomProfile）似乎必须从会话中获取。然后，您可以使用派生自默认模型绑定器的 Company 模型的特定模型绑定器，只更改它创建 Company 类实例的方式（然后它将以与默认方式相同的方式填充属性）：

```
public class CompanyModelBinder: DefaultModelBinder
{
    private const string sessionKey = "CustomProfile";

    protected override object CreateModel(ControllerContext controllerContext,
                                         ModelBindingContext bindingContext,
                                         Type modelType)
    {
        if(modelType == typeOf(Company))
        {
            var customProfile = (CustomProfile) controllerContext.HttpContext.Session[sessionKey];
            // create the Cart if there wasn't one in the session data
            if (customProfile == null)
            {
                customProfile = new CustomProfile("default name");
                controllerContext.HttpContext.Session[sessionKey] = customProfile;
            }

            return new Company(customProfile);
        }
        else
        {
            //just in case this gets registered for any other type
            return base.CreateModel(controllerContext, bindingContext, modelType)
        }
    }
} 
```

通过将其添加到 global.asax Application_Start 方法，您将仅为 Company 类型注册此活页夹：

```
ModelBinders.Binders.Add(typeOf(Company), CompanyModelBinder); 
```

另一种选择可能是通过从 DefaultModelBinder 继承来使用 Ninject 依赖项创建依赖关系感知模型绑定器（当您使用 Ninject 时，它知道如何构建具体类型的实例而无需注册它们）。但是，您需要配置一个在 Ninject 中构建 CustomProfile 的自定义方法，我相信您可以使用 ToMethod() 来完成。为此，您将提取您将在控制器工厂之外提取您的 Ninject 内核的配置：

```
public static class NinjectBootStrapper{
    public static IKernel GetKernel()
    {
        IKernel  ninjectKernel = new StandardKernel();
        AddBindings(ninjectKernel);
    }

    private void AddBindings(IKernel ninjectKernel)
    {
        ninjectKernel.Bind<IAuthProvider>().To<FormsAuthProvider>();
        ninjectKernel.Bind<IMembershipProvider>().To<MembershipProvider>();
        ninjectKernel.Bind<ICustomProfileProvider>().To<CustomProfileProvider>();
        ninjectKernel.Bind<ICompanyProvider>().To<CompanyProvider>();
        ninjectKernel.Bind<CustomProfile>().ToMethod(context => /*try to get here the current session and the custom profile, or build a new instance */ );
    }
}

public class NinjectControllerFactory : DefaultControllerFactory
{
    private readonly IKernel ninjectKernel;

    public NinjectControllerFactory(IKernel kernel)
    {
        ninjectKernel = kernel;
    }

    protected override IController GetControllerInstance(RequestContext requestContext,
                                                         Type controllerType)
    {
        return controllerType == null
                   ? null
                   : (IController) ninjectKernel.Get(controllerType);
    }
} 
```

在这种情况下，您将创建此模型绑定器：

```
public class NinjectModelBinder: DefaultModelBinder
{
    private readonly IKernel ninjectKernel;

    public NinjectModelBinder(IKernel kernel)
    {
        ninjectKernel = kernel;
    }

    protected override object CreateModel(ControllerContext controllerContext,
                                         ModelBindingContext bindingContext,
                                         Type modelType)
    {
        return ninjectKernel.Get(modelType) ?? base.CreateModel(controllerContext, bindingContext, modelType)
    }
} 
```

您将 global.asax 更新为：

```
IKernel kernel = NinjectBootStrapper.GetKernel();
ControllerBuilder.Current.SetControllerFactory(new NinjectControllerFactory(kernel));
ModelBinders.Binders.DefaultBinder = new NinjectModelBinder(kernel); 
```

# c++ - 相互指向的对象的priority_queue

> ID：13534526
> 
> 赞同：1
> 
> 时间：2012-11-23T19:00:16.133
> 
> 标签：c++, pointers, std, priority-queue

我有一个类`Node`，除了存储数据外，还有一个指向其 parent 的指针`Node`。我将一些节点存储在 a 中`priority_queue`并覆盖`<`运算符以进行比较。

```
class Node {
public:
    string name;
    Node *parent;
    int cost;
};

static bool operator<(const Node& lhs, const Node& rhs) {
    return lhs.cost < rhs.cost;
} 
```

```
priority_queue<Node> queue; 
```

问题是，父指针似乎搞砸了。我的猜测是，当我`Node`从队列中弹出 a 时，`Nodes`它们实际上在内存中向上移动并且指针指向 wrong `Nodes`。这可能吗？

我尝试使用 a `priority_queue`of`Node*`指针来代替（并使用创建它们`new`），这样只有指针被重新排序，而不是对象本身。这似乎解决了指针问题，但是现在队列是按内存地址排序的，而不是`Nodes`.

如何实现一个`priority_queue`对象相互指向的对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:05:53.957

`Node*`为您的队列使用和自定义比较器。使用您目前拥有的东西，您可以执行以下操作，但如果智能指针在您当前的工具链中可用，我建议您使用它们。

```
class Node {
public:
    string name;
    Node *parent;
    int cost;
};

class CompareNodePtr
{
public:
    bool operator ()(const Node*& left, const Node*& right) const
    {
        return left->cost < right->cost;
    }
};

// your priority queue with custom comparator.
std::priority_queue<Node*, std::vector<Node*>, CompareNodePtr> myqueue; 
```

或者，对于比较器的更多本地定义，您可以在其中填充 compare-my-pointer 类，`Node`以免污染全局命名空间：

```
class Node {
public:
    string name;
    Node *parent;
    int cost;

    struct ComparePtr
    {
        bool operator ()(const Node*& left, const Node*& right) const
        {
            return left->cost < right->cost;
        }
    };
};

// your priority queue with custom comparator.
std::priority_queue<Node*, std::vector<Node*>, Node::ComparePtr> myqueue; 
```

关于指针被“搞砸”，使用对象级存储（与上面的指针存储相反），您的优先级队列可以/将在每次弹出后重新堆积内容时移动元素（以防万一你不是注意，标准库默认使用堆结构作为优先级队列）。

最后，我留下了如何处理某个节点的父指针的概念，该指针在其任何/某些子节点之前被弹出，被删除，从而为您创建一个指向队列中剩余的任何子节点的无效指针，但是它听起来你知道这可能会发生。

# php - 如何在上一版本中将 Jquery-File-Upload PHP 与数据库一起使用？

> ID：13534530
> 
> 赞同：1
> 
> 时间：2012-11-23T19:00:27.800
> 
> 标签：php, jquery, file-upload, multifile-uploader, blueimp

如何将[jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)与 PHP 和数据库一起使用？当我上传或删除图像时，我想插入或删除有关图像的行，并且每个图像的名称在它们上传到目录时将是 time()。

我通过谷歌找到的所有结果都告诉我我需要编辑 upload.class.php 但最后一个版本[只有 index.php 和 UploadHandler.php](https://github.com/blueimp/jQuery-File-Upload/tree/master/server/php) ...

文件 UploadHandler.php 具有带有代码的类 UploadHandler

```
public function post($print_response = true) {
        if (isset($_REQUEST['_method']) && $_REQUEST['_method'] === 'DELETE') {
            return $this->delete($print_response);
        }
        $upload = isset($_FILES[$this->options['param_name']]) ?
            $_FILES[$this->options['param_name']] : null;
        // Parse the Content-Disposition header, if available:
        $file_name = isset($_SERVER['HTTP_CONTENT_DISPOSITION']) ?
            rawurldecode(preg_replace(
                '/(^[^"]+")|("$)/',
                '',
                $_SERVER['HTTP_CONTENT_DISPOSITION']
            )) : null;
        $file_type = isset($_SERVER['HTTP_CONTENT_DESCRIPTION']) ?
            $_SERVER['HTTP_CONTENT_DESCRIPTION'] : null;
        // Parse the Content-Range header, which has the following form:
        // Content-Range: bytes 0-524287/2000000
        $content_range = isset($_SERVER['HTTP_CONTENT_RANGE']) ?
            preg_split('/[^0-9]+/', $_SERVER['HTTP_CONTENT_RANGE']) : null;
        $size =  $content_range ? $content_range[3] : null;
        $info = array();
        if ($upload && is_array($upload['tmp_name'])) {
            // param_name is an array identifier like "files[]",
            // $_FILES is a multi-dimensional array:
            foreach ($upload['tmp_name'] as $index => $value) {
                $info[] = $this->handle_file_upload(
                    $upload['tmp_name'][$index],
                    $file_name ? $file_name : $upload['name'][$index],
                    $size ? $size : $upload['size'][$index],
                    $file_type ? $file_type : $upload['type'][$index],
                    $upload['error'][$index],
                    $index,
                    $content_range
                );

            }
        } else {
            // param_name is a single object identifier like "file",
            // $_FILES is a one-dimensional array:
            $info[] = $this->handle_file_upload(
                isset($upload['tmp_name']) ? $upload['tmp_name'] : null,
                $file_name ? $file_name : (isset($upload['name']) ?
                        $upload['name'] : null),
                $size ? $size : (isset($upload['size']) ?
                        $upload['size'] : $_SERVER['CONTENT_LENGTH']),
                $file_type ? $file_type : (isset($upload['type']) ?
                        $upload['type'] : $_SERVER['CONTENT_TYPE']),
                isset($upload['error']) ? $upload['error'] : null,
                null,
                $content_range
            );
        }
        return $this->generate_response($info, $print_response);
    }

public function delete($print_response = true) {
            $file_name = $this->get_file_name_param();
            $file_path = $this->get_upload_path($file_name);
            $success = is_file($file_path) && $file_name[0] !== '.' && unlink($file_path);
            if ($success) {
                foreach($this->options['image_versions'] as $version => $options) {
                    if (!empty($version)) {
                        $file = $this->get_upload_path($file_name, $version);
                        if (is_file($file)) {
                            unlink($file);
                        }
                    }
                }
            }
            return $this->generate_response($success, $print_response);
        } 
```

我需要添加哪些行才能在 mysql 中插入或删除文件名？

PS：我用PHP

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T08:48:12.027

我使用 docementation，现在可以说文件 upload.class.php 需要编辑文件 UploadHandler.php 而不是使用下一个：

**搜索这一行**- > $this->options = array(

在下一行添加以下代码：

```
// mysql connection settings
'database' => '**YOUR DATABASE**',
'host' => '**localhost**',
'username' => '**YOUR USERNAME**',
'password' => '**YOUR PASSWORD**',
// end 
```

因此，现在您必须为 SQL Query 编写一个函数，例如在 handle_file_upload 函数之后复制并粘贴以下代码：

```
function query($query) {
$database = $this->options['database'];
$host = $this->options['host'];
$username = $this->options['username'];
$password = $this->options['password'];
$link = mysql_connect($host,$username,$password);
if (!$link) {
die(mysql_error());
}
$db_selected = mysql_select_db($database);
if (!$db_selected) {
die(mysql_error());
}
$result = mysql_query($query);
mysql_close($link);
return $result;
} 
```

添加文件详细信息到数据库我用图片上传来解释这个功能，所以这里我们将图片名称保存到数据库中添加这个功能也是upload.class.php

```
function add_img($whichimg)
{
$add_to_db = $this->query("INSERT INTO yourtable (**yourcolumnone**) VALUES ('".$whichimg."')") or die(mysql_error());
return $add_to_db;
} 
```

所以在这个函数中，我们用夹子之间的字符串调用函数查询。

您还可以插入其他详细信息，例如文件大小。

至少我们必须调用这个函数，在函数handle_file_upload的最后加上下面的代码。在此行下方或上方粘贴以下代码：**$file->size = $file_size;**

```
$file->upload_to_db = $this->add_img($file->name); 
```

删除我们创建的条目 删除我们之前创建的条目非常简单，我们创建一个新函数，该函数还创建一个 sql 查询来删除它。

```
function delete_img($delimg)
{
$delete_from_db = $this->query("DELETE FROM yourtable WHERE yourcolumnone = '$delimg'") or die(mysql_error());
return $delete_from_db;
} 
```

现在我们必须调用该函数，这次是删除函数。转到删除功能并搜索此行： if ($success) { 在此粘贴以下代码。

```
$this->delete_img($file_name); 
```

享受=）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T16:14:48.107

您应该重载默认方法（如文档中所述）以添加您的自定义功能。如果您修改原始文件，当插件的新版本（或修复）发布时，您将有更多的工作。

出于我自己的目的，我基本上定义了一个自定义类，它扩展了原始类并仅修改了 /server/php/index.php 文件：

```
class myUploadHandler extends UploadHandler {
    //do your stuff
    //for exemple if you are using a DB:
    //overload methods like handle_file_upload() for insertion in a DB,
    //set_additional_file_properties() if you need more fields linked to each uploaded file
    // or delete() also if you want to remove from DB
}
$upload_handler = new myUploadHandler(array(
    'user_dirs' => true,
    'download_via_php' => true,
)); 
```

# c++ - Invalid conversion from 'char' to 'const Char*' in C++

> ID：13534532
> 
> 赞同：1
> 
> 时间：2012-11-23T19:00:36.470
> 
> 标签：c++, project

I have declared a function (C++)

```
int products(char num1, char num2, char num3, char num4, char num5); 
```

but my compiler is giving me this error:

```
Invalid conversion from 'char' to 'const Char*'
error initializing argument 1 of 'int atoi (const char*)'  on line 22 
```

when I attempt to pass `num1`, `num2` etc. as a parameter to `atoi`.

```
#include<iostream>
#include<string>

using namespace std;

int Product(char num1, char num2, char num3, char num4, char num5);

const string LargeNum = "7316717653133062491922511967442657474235534919493496983520312774506326239578318016984801869478851843858615607891129494954595017379583319528532088055111254069874715852386305071569329096329522744304355766896648950445244523161731856403098711121722383113622298934233803081353362766142828064444866452387493035890729629049156044077239071381051585930796086670172427121883998797908792274921901699720888093776657273330010533678812202354218097512545405947522435258490771167055601360483958644670632441572215539753697817977846174064955149290862569321978468622482839722413756570560574902614079729686524145351004748216637048440319989000889524345065854122758866688116427171479924442928230863465674813919123162824586178664583591245665294765456828489128831426076900422421902267105562632111110937054421750694165896040807198403850962455444362981230987879927244284909188845801561660979191338754992005240636899125607176060588611646710940507754100225698315520005593572972571636269561882670428252483600823257530420752963450";

int main(){
int greatestVal = 0;
for(int i = 0; i + 4 <= LargeNum.length(); i++ ){
    if(greatestVal < Product(LargeNum[i], LargeNum[i+1], LargeNum[i+2], LargeNum[i+3], LargeNum[i+4])){
        greatestVal = Product(LargeNum[i], LargeNum[i+1], LargeNum[i+2], LargeNum[i+3], LargeNum[i+4]);
    }
}
cout << greatestVal << endl;
system("PAUSE");
}

int Product(char num1, char num2, char num3, char num4, char num5){
    return (atoi(num1)*atoi(num2)*atoi(num3)*atoi(num4)*atoi(num5));
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T19:05:00.793

`atoi` takes a `const char*` (i.e. a null terminated sequence of characters). You are supplying it with a single `char`, so the compiler complains. How you fix it depends on exactly what you are trying to do.

I would guess that you want to convert a char representing a digit to an integer, '0' to 0, '1' to 1 etc. If so then the correct code would be

```
return (num1 - '0')*(num2 - '0')*(num3 - '0')*(num4 - '0')*(num5 - '0'); 
```

This works because chars convert to ints automatically when you do arithmetic on them, and also because the chars '0' to '9' are guaranteed to be in sequence, so all you need to do to convert a digit to an int is subtract '0' from it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T19:04:27.860

Please see the documentation of `atoi` first. It takes `const char*` as argument, while you're passing `char` to it. That is definitely an error.

Also, you don't need `atoi`. If you want to convert into `'7'` into `7`, then just substract `'0'` from it. So what you probably want is this:

```
int Product(char num1, char num2, char num3, char num4, char num5)
{
    return (num1-'0')*(num2-'0')*(num3-'0')*(num4-'0')*(num5-'0');
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T19:04:14.740

Function [atoi](http://www.cplusplus.com/reference/clibrary/cstdlib/atoi/) expects parameter of type `const char*` (string), you're passing single character to it.

If you want to retrieve integer value from a character containing single digit, you can use `'0'` character.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T19:04:05.520

`atoi` expects a `const char*` as parameter, and you're giving it a `char`. The error message is pretty clear.

To convert a `char` to an `int`, you can do `num1 - '0'`:

```
int Product(char num1, char num2, char num3, char num4, char num5){
   return (num1-'0')*(num2-'0')*(num3-'0')*(num4-'0')*(num5-'0');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T19:04:31.403

The reason why you are getting a compilation error is because there is no matching overload for the set of arguments you are passing to the method. The compiler tries to find the closest match, which in your case char and const char*, and then reports that error.

Note that **atoi doesn't work because atoi takes in a string and not a single char** -- for the very good reason that most numbers have more than one digit!

You can do this:

```
int Product(char num1, char num2, char num3, char num4, char num5){
    return (num1 - '0')*(num2 - '0')*(num3 - '0')*(num4 - '0')*(num5 - '0');
} 
```

instead.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-23T19:32:31.833

As many people are saying you can just use char - '0' to convert a char to an integer. This is because in ASCII 0-9 are represented by the numbers 48-57 so if you take away '0' which is equivalent to 48 it will leave you with the result between 0-9 as long as you pass in a number 0 to 9.

Just be careful you don't loop past the end of LargeNum as you are currently looping to the end of the string and accessing 3 past it. You may want to loop to LargeNum.length - 3;

# ruby-on-rails - Rails：如何正确避免 CSS 的循环依赖错误，但仍包含所有文件？

> ID：13534534
> 
> 赞同：1
> 
> 时间：2012-11-23T19:00:41.050
> 
> 标签：ruby-on-rails, circular-dependency, sprockets

我是 Rails 的新手，我希望这是一个简单的问题，但我无法在这里或通过谷歌搜索找到它。我经历过[几个](https://stackoverflow.com/questions/7462661/sprocketscirculardependencyerror-in-storeindex) [不同的](https://stackoverflow.com/questions/8803226/asset-pipeline-not-precompiling-sass) [类似](https://stackoverflow.com/questions/12327610/require-bootstrap-gets-sprocketscirculardependencyerror?lq=1) [帖子](https://stackoverflow.com/questions/8702687/circular-dependency-error-in-scss-file-in-rails-3-1-asset-pipeline)，但从未完全解决我的问题。（“帖子”上的第四个链接是完全相同的问题，但从未解决或回答。）

我正在尝试设置一个*非常*简单的博客应用程序来玩。我想做的（现在）就是建立一个全局 application.css[.scss is optional] 和一个特定于页面的 post.css[.scss]。

我的 application.css 看起来像这样：

```
//= require_self
//= require_tree .

body {
    background-color: #CCF;
}
#main_content_div {
    width:90%; 
    padding:10px; 
    margin: 15px auto; 
    background-color:#FFF;
} 
```

如果你问我，这很简单。

我的 post.css.scss 看起来像这样：

```
.postlist_row {
    border: 1px solid red;
} 
```

没有什么花哨。

但是当我尝试访问 /posts 时，我最终得到：

```
Sprockets::CircularDependencyError in Posts#index 
```

对此的标准 SO 答案似乎是“好吧，只需删除该 require_tree 语句。您正在使用 Rails 3 和 Sprockets，因此这已经发生了，并且您将双重包含相同的文件。”

这可能是真的。如果我删除了 require_tree，application.css 就可以正常工作。但是，这就是我的问题似乎与其他问题不同的地方，**它从不包括 post.css.scss**。其中没有任何规则应用于页面，也没有显示在源代码中。

我对管道的了解还不够，无法确定问题出在哪里，无论是因为我的陈述顺序还是因为一个是 css 而另一个是 scss 或我的配置......我只是没有主意。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:27:06.390

如果您删除了，`//= require_tree .`那么您将需要自己包含控制器特定的资产。

请参阅[http://guides.rubyonrails.org/asset_pipeline.html#how-to-use-the-asset-pipeline](http://guides.rubyonrails.org/asset_pipeline.html#how-to-use-the-asset-pipeline)

> 例如，如果你生成一个 ProjectsController，Rails 也会在`app/assets/javascripts/projects.js.coffee`和 中 添加一个新文件`app/assets/stylesheets/projects.css.scss`。您应该将控制器特有的任何 JavaScript 或 CSS 放在它们各自的资产文件中，因为这些文件可以仅针对这些控制器加载，例如`<%= javascript_include_tag params[:controller] %>` 或`<%= stylesheet_link_tag params[:controller] %>`.

你这样做了吗？

或者，您可能想要离开，`//= require_tree .`以便您的应用程序可以为所有请求提供单个样式表（浏览器可以在第一页之后缓存）并使用选择器将某些样式限制为特定页面。例如，您可以`params[:controller]`在应用程序的布局模板中将类添加为页面主体，以便您可以将样式范围限定为仅应用于该控制器的视图：

```
body.posts {
  .postlist_row {
    border: 1px solid red;
  }
} 
```

# cakephp - 脚手架的其他布局

> ID：13534538
> 
> 赞同：0
> 
> 时间：2012-11-23T19:00:54.087
> 
> 标签：cakephp, layout, scaffolding

我的默认布局是 default.ctp，但是当我在控制器中使用时，我只想将另一个布局 default-scaffolds.ctp 用于脚手架视图：

```
public $scaffold; 
```

我在 AppController 中尝试过

```
 public function beforeScaffold() {
        $this->layout = 'default-scaffolds';
} 
```

但这没有用。

我很感激这方面的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T21:55:14.270

我刚刚遇到同样的问题并通过指定路由器前缀'admin'来解决它，设置

```
public $scaffold = 'admin'; 
```

在控制器和 AppController 中我添加到 beforeFilter() 方法

```
public function beforeFilter() {
  if ($this->request->prefix == 'admin') {
    $this->layout = 'scaffold';
  } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:04:24.010

添加这个`beforeRender()`

```
public function beforeRender() {
    if (in_array($this->request->action, array('index', 'add', 'view', 'edit'))) {
        $this->layout = 'default-scaffolds';
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T20:45:05.943

或者，在 lib/Cake/Controller/Scaffold.php 的第 377 行（`_scaffold(CakeRequest $request)`-function，在 this if:`if (in_array($request->params['action'], $this->scaffoldActions))`中，只需添加以下行：

```
$this->layout = 'default_scaffold'; // this is a custom-added line in order to activate the default CSS file when scaffolding 
```

并将 default_scaffold.ctp 添加到您的 Layout 文件夹中。

# python - 关闭 Ubuntu 的脚本

> ID：13534541
> 
> 赞同：2
> 
> 时间：2012-11-23T19:01:00.360
> 
> 标签：python, linux, bash, ubuntu, sh

我想写一个可以关闭远程 Ubuntu 系统的脚本。实际上，当我关闭安装了我的虚拟机的主机时，我希望我的虚拟机安全关闭。

是否可以借助 Sh 脚本或以 Python 等任何语言编写的脚本来执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T10:17:33.077

您可以从远程 Linux 机器（VM 主机）运行以下命令：

```
ssh root@<vm-client-ip> "shutdown -h now" 
```

您必须输入远程计算机的 root 密码。您可以通过添加 ssh 证书来防止这种情况（如果您正在编写脚本则很好）：

[SSH无密码登录](http://www.linuxproblem.org/art_9.html)

如果您以此为基础编写脚本，请不要忘记在关闭后添加延迟（例如`sleep 10`），以便 VM 有时间安详地死去。

一个完整的 bash 脚本（未经测试）：

```
#!/bin/bash

ssh root@<vm-client-ip> "shutdown -h now"
sleep 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T19:17:18.137

您可以使用管理程序，即在 qemu/KVM 的情况下使用 qm 脚本

```
qm shutdown 300 && qm wait 300 
```

它关闭 ID 为 300 的 VM，并等待 VM 停止。有关更多选项，请参阅 qm 手册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T19:49:00.880

有很多方法可以关闭 Linux 系统。首选方法是调用窗口管理器的关闭序列。如果你正在使用`gdm`（如果你正在使用你想使用的 Ubuntu，你可能就是这样：

```
gnome-session-quit --power-off 
```

如果您使用`kdm`的命令是：

```
kdmctl shutdown 
```

其他关闭计算机的方法（可能大部分或完全等效，但都需要超级用户权限）包括：

```
/sbin/init 0
/sbin/halt
/sbin/shutdown -h now
/sbin/poweroff 
```

等等等等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T19:10:04.053

关闭系统的实际命令是关闭，特别是

```
$ shutdown -h now 
```

现在关闭它。这需要在您要停止的机器上以超级用户权限运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T19:10:37.253

您可以`poweroff`从脚本调用，只要它以超级用户权限运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-23T20:11:32.510

根据您使用的虚拟化产品（例如 KVM、VirtualBox、VMWare 等），应该有一个合适的界面可供您使用。

我建议您在 Google 上搜索您选择的虚拟化软件的名称 +“API”。上述所有示例都有相关的结果，可以从例如 Python 中调用。

对于 VirtualBox，请查看此链接：[https ://blogs.oracle.com/nike/entry/python_api_to_the_virtualbox](https://blogs.oracle.com/nike/entry/python_api_to_the_virtualbox)

这应该给你一个 SOAP 接口，它应该允许你通过例如 cURL 进行远程控制。

或者，对于远程方面，您可以在服务器上设置私钥身份验证并在本地保存您的密钥密码（例如 Seahorse），这样您就可以安全地访问 ssh，而无需每次都输入密码。

# c# - 动态生成数据的面包屑导航

> ID：13534545
> 
> 赞同：0
> 
> 时间：2012-11-23T19:01:15.290
> 
> 标签：c#, asp.net, sql-server, vb.net

我有一个名为的表`Nodes > (NodeID || ParentID || NodeName)`，它具有类别子类别层次结构。

以下是一些示例表数据：

```
NodeID   || ParentID  ||  NodeName

1 ||  null || All Categories

2 || 1 || Category 1

3 || 1 || Category 2

4 || 2 || Sub- Category 1

5 || 4 || Sub-sub-category 1

5 || 3 || Sub-Category 2

6 || 5 || product 1 
```

我想将面包屑作为锚点或其他东西，以便我可以直接获取单击的节点ID。

现在从这个表节点，我想根据我在桌子上的位置制作面包屑。

这是我正在尝试的：

```
 Dim strCmd As String = "WITH abcd AS ( SELECT  nodeid, nodeName, ParentID, CAST(([nodeName]) AS VARCHAR(1000)) AS Path FROM Nodes WHERE parentid = 1 UNION ALL SELECT  t.nodeid, t.[nodeName], t.ParentID, CAST(( a.path + ' > ' + '<a href=""products.aspx?id=' + CAST((t.nodeid) as Varchar) + '"">' + t.nodeName + '</a>') AS VARCHAR(1000)) AS Path FROM nodes AS t JOIN abcd AS a ON t.ParentId = a.nodeid )SELECT nodeid,nodename,path FROM abcd"
        Using _cmd As SqlCommand = db.GetSqlStringCommand("SELECT * FROM Nodes") 
            Using _dt As DataTable = db.ExecuteDataSet(_cmd).Tables(0)
                _dt.Columns.Add("BreadCrumb")
                Using ds1 As DataSet = db.ExecuteDataSet(CommandType.Text, strCmd)
                    For i As Integer = 0 To _dt.Rows.Count - 1
                        Dim results = (From myRow As DataRow In ds1.Tables(0).AsEnumerable() Where (myRow.Field(Of Integer)("nodeId") = _dt.Rows(i).Item(0)) Select myRow.Field(Of String)("path")).SingleOrDefault()
                        _dt.Rows(i).Item(13) = results
                        Label1.Text += results & " <br/>"    'Just debug code, printing all the breadcrumbs on the page.
                    Next
                End Using

            End Using
        End Using 
```

从上面的代码中，我得到了我的面包屑，但我无法将面包屑的第一个元素放入锚中。

> 第一类
> 
> 第 2 类
> 
> 类别 1 > [子类别 1]
> 
> 类别 1 > [子类别 1] > [子子类别 1]
> 
> 类别 1 > [子类别 2]
> 
> 类别 1 > [子类别 1] > [子子类别 1] > [产品 1]

我一直在寻找一种以某种方式让面包屑的第一个元素成为锚点或其他东西的方法，以便我可以获得单击元素的 nodeid。我不确定是否有办法做到这一点，我花了很多时间但无法找到合适的方法。如果有什么可以做的，请建议我，或者我应该使用不同的方法来解决这个问题。

我希望这些数据很清楚，如果您需要任何其他说明，请告诉我。

# ruby-on-rails - Rails 安装中缺少 Gemfile

> ID：13534547
> 
> 赞同：1
> 
> 时间：2012-11-23T19:01:24.093
> 
> 标签：ruby-on-rails, git, gem, gemfile

有点奇怪的问题，但这里有。

我是 Rails 的相对初学者，我刚刚开始在本地开发我的第二个应用程序。但是，每次安装后，我都会遇到以下问题 - 缺少几个 gemfile（railties 是最明显的）。

所以，我删除了安装，重新运行它并列出了 gemfiles - 它们都在那里。但是，在初始化 git repo 并将项目推送到我的 GitHub 后，一个`gem list`命令显示现在缺少许多 gem - 此时我无法运行任何`rake`命令，例如`rails server`.

所以我清除了回购并重新安装。`gem list`说宝石都存在，`server`并且`rake`命令有效；但是推送回购并随后打包 -`gem list`显示只剩下少数宝石。

考虑到我的经验，我准备相信我遗漏了一些非常明显的东西，但任何建议都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:32:31.787

欢迎 ;-）

我想您想创建一个 Rails 3 应用程序。所以首先确保你已经安装了 bundler。

```
gem install bundler 
```

创建应用程序的步骤是：

```
rails new your_app 
```

然后在应用程序文件夹中运行 bundler：

```
cd your_app
bundler install 
```

现在您应该可以运行应用程序了：

```
rails s 
```

去访问 localhost:3000。如果这不起作用，您还有其他问题。然后粘贴堆栈跟踪...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T12:43:25.637

问题是我忘记了我安装了两个版本的 Ruby，并且由于某种原因我没有正确设置 rvm 的默认值。指定默认值然后检查该版本的 Ruby 是否存在 gem 修复了它。

# wpf - WPF：资源字典 x:Name 和 x:Key

> ID：13534554
> 
> 赞同：3
> 
> 时间：2012-11-23T19:02:03.510
> 
> 标签：wpf

在**资源字典**中，我们可以同时拥有`x:Name`和`x:Key`吗？

`x:Name`我们可以通过而不是检索自定义元素`x:key`吗？

如果我想在一个元素中存储更多自定义属性，我应该把这些属性放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:06:39.433

No 不能在资源字典中同时使用**x:key**和**x:name 。**

**FindResource**仅适用于 x:key。

使用可以使用**Datacontext**获取更多属性。

# python - 使用 assert 来验证关于 python 中参数的假设是不好的做法吗？

> ID：13534563
> 
> 赞同：4
> 
> 时间：2012-11-23T19:02:59.563
> 
> 标签：python

我正在编写一个`__init__`使用 id 或 slug 参数但不能同时使用两者的类。我想验证参数是否符合预期。将 an 用于验证有关参数的假设的特定目的是否正确和良好的做法`assert`，或者如果参数不符合预期，我应该提出异常？

例如，

```
def __init__(self, id=None, slug=None):
    assert((id or slug) and not (id and slug)) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-23T19:09:08.797

原始问题的答案（“在 python 中使用 assert 来验证内部假设是不好的做法吗？”）绝对不是。这是每个人都同意断言有好处的一件事。但是您在问题中描述的不是对内部假设的验证：它是对外部输入的验证。A `TypeError`, a `ValueError`, 另一个内置异常（或者可能是自定义异常，尽管对这些异常应该保守一点）为 API 的用户提供了更多有用的反馈。更糟糕的是，断言可能（并且在某些环境中通常是）*完全删除*，这意味着您的代码会默默地做错事。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-23T19:07:52.020

正如您所描述的，如果这是关于代码健全性，那么断言是正确使用的东西。如果这是关于输入验证的，则不应使用断言。特别是，用户不应该能够通过向断言提供垃圾来触发断言。断言只能因程序中的错误而触发。

**编辑**：正如我刚刚从评论中了解到的，Python 还允许您完全关闭断言（这意味着它们不会被评估，因此不会失败）。如果有任何性能问题，这将是性能问题的正确答案（除了使用汇编或 C 等不同的语言）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-23T19:07:45.110

断言`AssertionError`失败时引发。`ValueError`当参数不完全正确时，python 标准库经常引发- 或者`TypeError`当您使用错误数量的参数调用函数时：

考虑：

```
int("15f")     #ValueError
int("15",2,3)  #TypeError 
```

您需要问自己的问题（从 API 的角度来看）是，对于您的函数来说，在错误输入时提出哪个最合乎逻辑？无论您选择什么，请确保将其记录在案，以便您的用户知道如何处理出现的错误。

# facebook - 使用 FQL 从 facebook 获取用户参加活动数据

> ID：13534566
> 
> 赞同：0
> 
> 时间：2012-11-23T19:03:05.513
> 
> 标签：facebook, events, facebook-fql

我无法通过 fql 获取我想要的信息。我想获取所有被“参加”到按名称排序的特定事件的人的姓名和 uid。我知道如何使用以下查询获取参加活动的用户的所有 uid：

```
SELECT uid FROM event_member WHERE eid = ... AND rsvp_status = 'attending' 
```

不幸的是，event_member 表没有 uid 的名称，我知道如何使用图形 api 从活动参加者那里获取名称和 uid，但据我所知，没有办法按名称对其进行排序。

你的意见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:19:37.613

找到了答案，我忘了有一个名为“用户”的表。解决方案是

```
SELECT uid, name FROM user WHERE uid IN
 (
  SELECT uid FROM event_member WHERE eid = "EXISTING_EVENT_ID" and rsvp_status= "attending"
 ) 
SORT BY name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:06:31.507

尝试 FQL 查询，例如

```
SELECT name, venue, location, start_time FROM event WHERE eid IN (
     SELECT eid FROM event_member WHERE uid = "USER_ID_HERE" and rsvp_status="attending"
 ); 
```

# .htaccess - 将子目录的所有网站重定向到一个网站（实际上是两个，每种语言一个）

> ID：13534568
> 
> 赞同：1
> 
> 时间：2012-11-23T19:03:33.043
> 
> 标签：.htaccess, redirect, web

我试图做以下事情：我有一个英文版和德文版的网站。现在我正在尝试将英语访问者重定向到英语页面，将德语访问者重定向到德语页面。

英文版的 URL 如下所示：example.com/en/some-page 德文版的 URL 如下所示：example.com/some-page

我正在尝试为我的所有页面获取临时重定向（302？），因此每个英文页面（以 example.com/en/ 开头的 URL）都应重定向到 example.com/en/english-announcement 和所有德语页面（以 example.com 开头的 URL）应重定向到 example.com/german-announcement。除了 example.com/german-announcement 或 example.com/en/english-announcement 之外，访问者应该无法访问任何其他页面。

也许值得一提的是，它是一个 wordpress 页面，所以有一个默认的 .htaccess 文件，看起来像这样：

```
RewriteOptions inherit
<IfModule mod_rewrite.c>
RewriteEngine On 
RewriteBase / 
RewriteRule ^index\.php$ - [L] 
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteRule . /index.php [L] 
</IfModule> 
```

如果你能告诉我如何做到这一点，我将永远感激不尽。

# html - 使用 Internet Explorer 修复基于 Blogger 的网站的 HTML / CSS 高度

> ID：13534569
> 
> 赞同：0
> 
> 时间：2012-11-23T19:03:50.810
> 
> 标签：html, css, blogger, blogspot

我的网站有问题，而且我不是一个经验丰富的 HTML / CSS 编码器，我希望对我在 Internet Explorer 上的身高问题有任何帮助。Chrome、Opera 和 Firefox 永远不会发生。

这是我的网站：

[http://www.joshcellsoftwares.com/](http://www.joshcellsoftwares.com/)

我检测到加载 CSS 时 Internet Explorer 上出现的一个独特问题是高度错误。

有时网站高度异常向下滚动，并且尺寸没有正确呈现为这张图：

![](../Images/f3bf0ccbc4e199e798f103c0abc76dac.png)

我希望使用任何可以修复此浏览器高度的 JavaScript 或 HTML 来解决它。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:35:58.373

当您遇到阻止页面完全加载的 JS 错误时，您将获得所有额外的空间。如果您在 IE (F12) 中使用开发人员工具，您会看到当页面正确加载时您`body`仍然拥有该类（没有额外的空间），JS 的最后一点被触发并且不再具有该类。所以它在那之前就死了。`loading``body`

在控制台上显示并在 IE 开发人员工具 (F12) 中使用断点的唯一错误是：`FB.getLoginStatus() called before calling FB.init()`. 这来自您的`2000000996-widgets.js`.

正确初始化 FB 的解决方案在另一篇文章中讨论，[这里](https://stackoverflow.com/questions/8048564/fb-getloginstatus-called-before-calling-fb-init-error-in-console)。

# nfc - 如何在 Windows Phone 8 上使用 NFC 标签启动应用程序？

> ID：13534571
> 
> 赞同：3
> 
> 时间：2012-11-23T19:04:02.417
> 
> 标签：nfc, windows-phone-8

我有 Windows Phone 8 设备，很少有 NDEF 格式的 NFC 标签，我想知道，是否可以使用这些标签在我的 WP8 上实现应用程序启动？我已经彻底阅读了这篇关于[启动 Windows Phone 8 内置应用程序的 URI 方案的](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj662937%28v=vs.105%29.aspx)文章，但我没有找到任何与实际启动 3rd 方应用程序相关的链接。我可以启动各种设置屏幕，或浏览器、电子邮件、短信...

更有趣的是，WP Store 上至少有两个 NFC 标签可以“为启动应用程序编写标签”，我已经尝试过了，但是启动不起作用。

所以问题是：是否可以存储 NFC 标签信息以在 WP8 上启动任何 3rd 方应用程序？如果是，这种 URI 方案的格式是什么以及如何使用 WP8 将其写入标签？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T21:16:10.350

是的，您可以使用 NFC 标签启动任何 Windows Phone 8 应用程序。[`LaunchApp`您需要在将记录](http://social.technet.microsoft.com/wiki/contents/articles/13539.how-to-launch-apps-via-proximity-apis-nfc.aspx#LaunchApp_Tags)作为第一条记录的标签上放置一条 NDEF 消息。将 NDEF 记录的负载中的平台 ID 设置为“WindowsPhone”，并将应用 ID 设置为 Windows Phone 商店 URL 末尾“{”和“}”之间的十六进制字符串。例如，对于[http://www。 windowsphone.com/en-us/store/app/stackoverflow-feeds/226fcc72-69ff-4a85-b945-cbb7f5ea00af](http://www.windowsphone.com/en-us/store/app/stackoverflow-feeds/226fcc72-69ff-4a85-b945-cbb7f5ea00af)到“{226fcc72-69ff-4a85-b945-cbb7f5ea00af}”。

[这个库](https://ndef.codeplex.com/)可以帮助创建这样的 NDEF 记录。[此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh701129.aspx)提供了来自 MS 的有限文档。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-23T20:35:01.890

要通过 NFC 标签启动您的应用程序，您需要通过在文件中添加扩展名来注册 URI 关联`WMAppManifest.xml`，如下所示：

```
<Extensions>
  <Protocol Name="mynfcapp" NavUriFragment="encodedLaunchUri=%s" TaskID="_default" />
</Extensions> 
```

然后您将需要创建一个可以处理 URI 关联的 URI 映射器，如下所示：

```
public class AssociationUriMapper : UriMapperBase
{
    public override Uri MapUri(Uri uri)
    {
        string url = HttpUtility.UrlDecode(uri.ToString());

        if (url.Contains("mynfcapp:MainPage"))
        {
            int paramIndex = url.IndexOf("source=") + 7;
            string paramValue = url.Substring(paramIndex);

            return new Uri("/MainPage.xaml?source=" + paramValue, UriKind.Relative);
        }

        return uri;
    }
} 
```

下面是编写将启动应用程序的 NFC 标签的代码：

```
public partial class MainPage : PhoneApplicationPage
{
    private readonly ProximityDevice _proximityDevice;
    private long subId = 0;
    private long pubId = 0;

    public MainPage()
    {
        InitializeComponent();
        _proximityDevice = ProximityDevice.GetDefault();
    }

    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        if (_proximityDevice != null)
            subId = _proximityDevice.SubscribeForMessage("WriteableTag", OnWriteableTagArrived);

        base.OnNavigatedTo(e);
    }
    private void OnWriteableTagArrived(ProximityDevice sender, ProximityMessage message)
    {
        var dataWriter = new DataWriter();
        dataWriter.UnicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf16LE;
        string appLauncher = string.Format(@"mynfcapp:MainPage?source=mynfctest");
        dataWriter.WriteString(appLauncher);
        pubId = sender.PublishBinaryMessage("WindowsUri:WriteTag", dataWriter.DetachBuffer());
    }
} 
```

# c# - 窗口关闭后仍然调用方法

> ID：13534583
> 
> 赞同：2
> 
> 时间：2012-11-23T19:04:42.980
> 
> 标签：c#, wpf

首先我不知道这是不是一个愚蠢的问题。我有这种情况，首先我有一个主窗口

```
public MainWindow()
{

    InitializeComponent();
    //dt is a System.Windows.Threading.DispatcherTimer variable
    dt = new System.Windows.Threading.DispatcherTimer();
    dt.Interval = new TimeSpan(0, 0, 0, 0, 30000);
    dt.Tick += new EventHandler(refreshData);

    dt.Start();

} 
```

refreshData 方法执行此操作：

```
public void refreshData(object sender, EventArgs e)
{
    Conection c = new Conection();
            //this method just returns 'hello' doesn't affect my problem
    c.sayHello();
} 
```

这个主窗口也有一个按钮，当我点击按钮时，我会调用另一个类

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    ShowData d = new ShowData();
    d.Show();
} 
```

这个类与主窗口非常相似，它也有一个自己的 DispatcherTimer

```
public ShowData()
{
    InitializeComponent();

    dt = new System.Windows.Threading.DispatcherTimer();
    dt.Interval = new TimeSpan(0, 0, 0, 0, 30000);
    dt.Tick += new EventHandler(refreshData);

    dt.Start();
}

public void refreshData(object sender, EventArgs e)
{
    Conection c = new Conection();
    c.sayHello();
} 
```

我使用 Visual Studio 调试器跟踪对 sayHello 的调用，问题是当我关闭“ShowData”窗口时，仍然出现从 ShowData 类对 sayHello 的调用

我没有正确关闭窗户吗？关闭窗口后如何停止通话？

PS：我尝试在 on_closing 事件中将 DispatcherTimer 设置为 null

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:11:50.740

您需要使用`Stop()`窗口`OnWindowClosing`事件上的方法停止 DispatcherTimer。

```
public class MainWindow : Window
{
   DispatcherTimer MyTimer;

   public MainWindow()
   {
      InitializeComponent();

      MyTimer = new System.Windows.Threading.DispatcherTimer();
      MyTimer.Interval = new TimeSpan(0, 0, 0, 0, 30000);
      MyTimer.Tick += new EventHandler(refreshData);
      // Start the timer
      MyTimer.Start();
   }

   public void OnWindowClosing(object sender, CancelEventArgs e) 
   {
       // stop the timer
       MyTimer.Stop();
   }

   public void refreshData(object sender, EventArgs e)
   {
      Conection c = new Conection();
      c.sayHello();
   }
} 
```

# php - 为 wordpress 电子商务使用不同的页面模板

> ID：13534584
> 
> 赞同：0
> 
> 时间：2012-11-23T19:04:58.227
> 
> 标签：php, wordpress, wordpress-theming

我希望能够在与普通 index.php 页面不同的页面模板中显示 wordpress 插件的页面：'wp e-commerce'。

购物车的示例 URL 是：products-page/checkout/

但是，它只是将该内容放入 index.php 模板中。有没有办法创建不同的页面模板或 if/else 语句，根据用户所在的电子商务页面进行更改，例如原生 wordpress 层次结构的工作方式？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:28:03.853

我发现您可以使用条件语句定位页面标题，然后将页面标题用于结帐页面并创建以下内容：

```
<?php
if (is_page( 'Checkout' ) ) {
    if ( have_posts() ) : while ( have_posts() ) : the_post();
        the_content();
        endwhile; else: ?>
    <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
<?php endif; ?>
<?php }   
else{ ?>
    <!--Normal Page Content-->
<?php  } ?> 
```

# html - UL 标签未关闭

> ID：13534588
> 
> 赞同：0
> 
> 时间：2012-11-23T19:05:18.103
> 
> 标签：html, html-lists

`<UL>`在验证检查期间，我正在努力找出此错误的来源。这是说我有一个未打开的`<UL>`标签......请有人可以帮助我，因为我不知道这个标签在哪里：S。

[http://www.mammacoil.com/](http://www.mammacoil.com/)

谢谢科斯蒂

这是错误：

> 第 67 行，第 5 列：未完成的“ul”结束标记
> 
> `</ul>`
> 
> 最有可能的是，您嵌套了标签并以错误的顺序关闭了它们。例如`<p><em>...</p>`是不可接受的，因为`<em>`必须在之前关闭`<p>`。可接受的嵌套是：`<p><em>...</em></p>`
> 
> 另一种可能性是您使用的元素需要您未包含的子元素。因此父元素“未完成”，不完整。例如，在 HTML 中，`<head>`元素必须包含`<title>`子元素，列表需要适当的列表项（`<ul>`并且`<ol>`需要`<li>`；`<dl>`需要`<dt>`和`<dd>`），等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:19:28.383

答案就在那里：

`For instance, in HTML the element must contain a child element, ... <ul> and <ol> require <li>...`

您的代码中有一个空白`<ul></ul>`（实际上，**正是**验证器告诉您它在哪里），这是非法的。

# .htaccess - htacess 301 使用来自不存在的页面的查询字符串重定向

> ID：13534591
> 
> 赞同：0
> 
> 时间：2012-11-23T19:05:32.240
> 
> 标签：.htaccess, redirect

我的旧搜索文件曾经被命名为 namesearch.php。它现在被命名为 search.php。查询字符串参数保持不变。我想将任何名称搜索请求重定向到 search.php。这是我下面的内容，这是行不通的。

```
RewriteRule ^/namesearch.php%1 search.php$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T07:28:35.297

当目标 URI 不尝试构建自己的（即其中没有 a `?`）时，会自动附加查询字符串。您可以使用 mod_rewrite 或 mod_alias：

mod_alias:

```
Redirect 301 /namesearch.php /search.php 
```

mod_rewrite：

```
RewriteEngine On
RewriteRule ^/?namesearch.php /search.php [L,R=301] 
```

# html - 我怎样才能使一个元素具有绝对定位的兄弟姐妹，正常定位？

> ID：13534596
> 
> 赞同：1
> 
> 时间：2012-11-23T19:06:19.523
> 
> 标签：html, css

我希望我的具有“非绝对”类的元素能够正常定位，因为它的兄弟姐妹元素将被定位为静态。现在，由于它的兄弟姐妹是绝对定位的，因此非绝对元素与绝对定位的元素重叠。

我该如何解决这个问题，以使元素占据其正常位置，所有它的兄弟姐妹都将被定位为静态？

```
<html>

<head>
    <style type="text/css">
        .world{width:1000px;position:relative;border:1px solid black;height:200px;}
        .world .child{position:absolute}
        .animal{left:0px;}
        .tree{left:200px;}
        .water{left:500px;}

        .not-absolute{position:relative;float:left}
    </style>
</head>
<body>
    <div class='world'>
            <div class='child animal'> Absolute</div>
            <div class='child tree'> Absolute</div>
            <div class='child water'>Absolute</div>
            <div class='not-absolute'>Not Absolute</div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:11:33.520

如果我猜对了，恐怕你是在要求不可能。当绝对定位时，元素会从流中移除，因此非绝对元素的正常位置也会发生变化。

是否可以设置 position:relative 当前绝对定位的元素？这将允许在流中保持非绝对元素位置。

您还可以尝试定位您的非绝对元素，或者将当前的 .child 绝对值保留为 position:static 并使用它们的 :before/:after 伪元素来完成这项工作。

# .htaccess - htaccess 重定向假文件夹结构

> ID：13534599
> 
> 赞同：1
> 
> 时间：2012-11-23T19:06:25.640
> 
> 标签：.htaccess

试图创建假文件夹结构。

基本上我想要的是对[http://www.example.com/](http://www.example.com/) **（其中 ** 等于任意两个字母）的任何请求以重定向到[http://www.example.com/folder/index.php?var=](http://www.example.com/folder/index.php?var=) **（其中 ** 等于第一个链接中的两个字母）

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^/(.*)$ http://www.example.com/folder/index.php?var=$1 
```

这是我现在所拥有的，但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:11:10.690

从. `/`_ `RewriteRule`左侧匹配的表达式不应`/`以 a will 开头`REQUEST_URI`。`http://example.com`你也可以从右边省略整个，因为你在同一个域上重写。

```
RewriteEngine On
# Rewrite 2 characters into var
RewriteRule ^(.{2})$ folder/index.php?var=$1 [L,R] 
```

如果它应该只匹配 alpha 字符，建议进一步限制表达式（超出`.{2}`，匹配*任何*字符的 2）

```
# Only rewrite on exactly 2 alpha chars...
RewriteRule ^([A-Za-z]{2})$ folder/index.php?var=$1 [L,R] 
```

# jquery - 重新附加 jQuery detach();

> ID：13534601
> 
> 赞同：33
> 
> 时间：2012-11-23T19:06:37.840
> 
> 标签：jquery

我已经分离了一个 div 并希望在单击按钮时重新附加它。

这是代码：

```
$('#wrapper').detach();

$("#open_menu").click(function(){
    ATTACH HERE !!!
}); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-23T19:08:09.410

```
var el = $('#wrapper').detach();

$("#open_menu").click(function(){
    $(this).append(el);
}); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-04-03T12:21:03.127

我需要一个解决方案，即使目标元素之后还有其他元素要分离然后重新附加，它也能正常工作。这意味着这`append`可能不可靠，因为它将将该元素移回其父元素的末尾。我不得不使用一个可能不是最优雅的解决方案的占位符，但我还没有找到另一种方法..

```
var $wrapper = $('#wrapper')
    , $placeholder = $('<span style="display: none;" />')
        .insertAfter( $wrapper )
    ;
$wrapper.detach();

$("#open_menu").on('click',function(){
    $wrapper.insertBefore( $placeholder );
    $placeholder.remove();
}); 
```

为了使其更可重用，最好将其包装在 jQuery 插件中：

```
(function($){

    $.fn.detachTemp = function() {
        this.data('dt_placeholder',$('<span style="display: none;" />')
            .insertAfter( this ));
        return this.detach();
    }

    $.fn.reattach = function() {
        if(this.data('dt_placeholder')){
            this.insertBefore( this.data('dt_placeholder') );
            this.data('dt_placeholder').remove();
            this.removeData('dt_placeholder');
        }
        else if(window.console && console.error)
        console.error("Unable to reattach this element because its placeholder is not available.");
        return this;
    }

})(jQuery); 
```

用法：

```
var $wrapper = $('#wrapper').detachTemp();
$("#open_menu").on('click',function(){
    $wrapper.reattach();
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-22T18:06:05.870

如果您希望您的项目附加在元素的开头，您可以使用 .prepend()

否则你可以使用 append() 附加它。

在您的情况下，它将是：

```
var $wrapper = $('#wrapper').detach();

$("#open_menu").click(function(){
    //ATTACH HERE !!!
    $(this).prepend($wrapper); // or $(this).append($wrapper);
}); 
```

我希望它有帮助:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-11-26T07:12:45.360

我认为这主要是记录将要分离的元素的索引，然后再分离它，然后使用该索引来确定重新附加元素的位置。考虑以下“repl” [https://repl.it/@dexygen/re-attach](https://repl.it/@dexygen/re-attach)和下面的代码。这`setTimeout`只是为了让您可以在页面中的元素被分离之前看到它，并且一些元素已被重命名。我想知道是否`siblings`可以使用，`parent().children()`但我担心如果分离的兄弟姐妹是兄弟姐妹中*唯一*`parent`的元素会发生什么，无论如何我们都需要一个引用来*添加*if `index === 0`。

```
setTimeout(function() {
    var bar = $('#bar');
    var parent = bar.parent();
    var index = parent.children().index(bar);

    bar.detach();

    $("#re-attach").one('click', function() {
        if (index === 0) {
            parent.prepend(bar);  
        }
        else {
            parent.children().eq(index-1).after(bar);
        }
    });
}, 5000); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-18T10:54:57.460

```
$(function(){
 var detached = $('#element_to_detach').detach();
 // Here We store the detach element to the new variable named detached
 $('.element_after_which_you_need_to_attach').after(detached);
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-14T15:42:30.887

```
var $wrapper = $('#wrapper').detach();

$("#open_menu").click(function(){
    $(this).append($wrapper[0])
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-31T19:03:41.320

`prepend()`将其分配给变量后分离的元素怎么样，即。

```
var det_elem = $('#wrapper').detach();
$("#open_menu").click(function(){
    $(this).prepend(det_elem);
}); 
```

**prepend()**将附加在元素的开头。

* * *

## 回答 #8

> 赞同：-10
> 
> 时间：2016-02-15T23:01:16.857

jQuery 不提供附加方法。考虑分离相当于从 Dom 中永久删除一个项目。如果您认为您可能想要删除并稍后恢复某个元素，请考虑以下选项：

1.  使用切换方法。隐藏和取消隐藏页面中的元素。
2.  如果您必须从 Dom 中绝对删除该项目，请考虑使用 jQuery clone 方法，首先制作指定元素的副本，然后您可以稍后将元素副本重新引入 Dom。

以上并不是实现此目的的唯一两种方法，但是，它们很简单，并且可能不需要您对代码进行太多更改。

# go - 为什么指定方法接收器有时会触发“未定义”错误？

> ID：13534603
> 
> 赞同：0
> 
> 时间：2012-11-23T19:06:39.810
> 
> 标签：go

我以为我了解 Go 的类和方法接收器，但显然不是。它们通常可以直观地工作，但这里有一个示例，其中使用一个似乎会导致“未定义：Wtf”错误：

```
package main

type Writeable struct {
    seq int
}

func (w Writeable) Wtf() { // causes a compile error
//func Wtf() { // if you use this instead, it works
}

func Write() {
    Wtf() // this is the line that the compiler complains about
}

func main() {
} 
```

我正在使用上个月左右从 golang 下载的编译器和 LiteIDE。请解释！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:13:02.543

您将 Wtf() 定义为 Writeable 的方法。然后你试图在没有结构实例的情况下使用它。我在下面更改了您的代码以创建一个结构，然后使用 Wtf() 作为该结构的方法。现在它编译了。 [http://play.golang.org/p/cDIDANewar](http://play.golang.org/p/cDIDANewar)

```
package main

type Writeable struct {
    seq int
}

func (w Writeable) Wtf() { // causes a compile error
//func Wtf() { // if you use this instead, it works
}

func Write() {
    w := Writeable{}
    w.Wtf() // this is the line that the compiler complains about
}

func main() {
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:08:22.940

关于接收器的要点是您必须使用`receiver.function()`

如果您想`Wtf`在没有接收者的情况下被调用，请将其声明更改为

```
func Wtf() { 
```

如果你想调用它而不改变它，你可以写

```
 Writeable{}.Wtf() 
```

# c# - Richtextbox 删除选中的文本

> ID：13534606
> 
> 赞同：0
> 
> 时间：2012-11-23T19:06:58.530
> 
> 标签：c#, winforms, richtextbox, keyevent

我有以下代码：

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.N)
        {
            richTextBox1.Select(1, 3);
        }
    } 
```

当我按 N 键时，所选文本将替换为“n”。我[在 C# 中阅读了在 RichTexbox 中选择文本会删除文本](https://stackoverflow.com/questions/892370/selecting-text-in-richtexbox-in-c-sharp-deletes-the-text)，但它没有任何效果。

我正在使用 Windows 窗体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:09:32.080

您可能需要 e.Handled = true; 在此停止事件。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.handled.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.handled.aspx)

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e)
{
        if (e.KeyCode == Keys.N)
        {
            richTextBox1.Select(1, 3);
            e.Handled = true;
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:14:35.700

自己尝试一下：
打开编辑器，输入一些文本，标记其中的一些文本，然后按`N`。怎么了？标记的文本被替换为`n`。
同样的事情发生在你的`RichTextBox`. 这里要理解的重要一点是，通过您设置的事件，您只需添加一些功能并保持默认事件处理（由操作系统处理）不变。

因此，使用您的代码，只需按一下键即可

```
richTextBox1.Select(1, 3); 
```

它选择一些字符，然后默认事件处理开始。因此有一些标记的文本被替换为`N`.
因此，您只需将事件标记为由您自己处理。不使用`Handled`-property，而是使用`SuppressKeyPress`-property。

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.N)
    {
        richTextBox1.Select(1, 3);
        e.SuppressKeyPress = true;
    }
} 
```

[文件`Handled`](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.handled.aspx)明确指出：

```
If you set Handled to true on a TextBox, that control will
not pass the key press events to the underlying Win32 text
box control, but it will still display the characters that the user typed. 
```

这里是[官方文档`SuppressKeyPress`](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.suppresskeypress.aspx)。

# php - 使用 php curl 代理浏览网站

> ID：13534612
> 
> 赞同：-1
> 
> 时间：2012-11-23T19:07:16.250
> 
> 标签：php, curl, proxy

我想设置一个网页来自动使用代理。这是我的脚本：

```
<?

$url = 'http://www.sciencedirect.com/science/jrnlallbooks/a/fulltext';
$proxy = '200.93.148.72:3128';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_PROXY, $proxy);
curl_setopt($ch, CURLOPT_TIMEOUT, 0);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_COOKIEJAR, "my_cookies.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "my_cookies.txt");
$curl_scraped_page = curl_exec($ch);

echo $curl_scraped_page;

?> 
```

我可以打开网页，标题显示：

HTTP/1.0 200 OK 日期：2012 年 11 月 23 日星期五 18:46:41 GMT 最后修改时间：2012 年 11 月 23 日星期五 18:46:41 GMT 设置 Cookie：MIAMISESSION=86e5ecb0-359b-11e2-b116-00000aab0f6c:3531149201 ; 路径=/; 域=.sciencedirect.com；设置 Cookie：USER_STATE_COOKIE=; 过期=格林威治标准时间 1970 年 1 月 1 日星期四 23:59:59；路径=/; 域=.sciencedirect.com；设置 Cookie：SD_REMOTEACCESS=; 过期=格林威治标准时间 1970 年 1 月 1 日星期四 23:59:59；路径=/; 域=.sciencedirect.com；设置 Cookie：路径=/; 域=.sciencedirect.com；设置 Cookie：TARGET_URL=fcf74dd786744d87fbaaaf8652a764ab4a79b0d3ed681139e9106923760631052596d348948479933da48b3723069bbf09065290c950dc02c1f0d1436659ad 路径=/; 域=.sciencedirect.com；设置 Cookie：路径=/; 域=.sciencedirect.com；内容类型：文本/html 到期时间：星期二，1980 年 1 月 1 日 05:00:00 GMT X-RE-Ref：0 19194695 服务器：www.sciencedirect.com P3P：CP="IDC DSP LAW ADM DEV TAI PSA PSD IVA IVD CON HIS TEL OUR DEL SAM OTR IND OTC" 变化：接受编码，用户代理 X-缓存：来自 alejandria.ufps.edu.co 的 MISS X-缓存查找：来自 alejandria.ufps.edu.co:3128 的命中：1.0 alejandria.ufps.edu.co (squid/3.0.STABLE15) 代理连接：关闭

但是，代理仅适用于此页面。当我单击此页面上的其他链接时，没有加载任何代理。请帮我解决这个问题。如何改进我的脚本？我想要一个整个网站（所有链接）来使用代理。如何设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:07:41.050

您似乎需要使用正则表达式来修改 HTML 代码中的任何链接（例如`<a href="...">`）以指向您的脚本。然后你必须为 cURL 设置一个参数，所以你会得到正确的页面，所以它看起来像`http://YourSite.com/proxy.php?site=http://example.com/smth/foo.php`

# ruby-on-rails - Ruby on Rails 中的公共/私有

> ID：13534613
> 
> 赞同：0
> 
> 时间：2012-11-23T19:07:29.523
> 
> 标签：ruby-on-rails, ruby

我为标题（字符串）和正文（内容）生成了一些名为“文档”的脚手架，以允许用户发布内容。

问题是任何人都可以查看该文档。有没有办法让它“私有”，只有用户才能查看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:11:32.373

是的，您需要在您的应用程序中设置身份验证。然后，您将只允许登录用户查看文档并拒绝其他用户。

观看这个出色的 railscast：[从头开始的身份验证](http://railscasts.com/episodes/250-authentication-from-scratch)。

# assembly - 带偏移量的 MIPS 加载字节 (lb)

> ID：13534616
> 
> 赞同：6
> 
> 时间：2012-11-23T19:07:31.853
> 
> 标签：assembly, mips

我正在尝试从数据中保存的单词中加载一个字节：

```
.data
    number:
    .word w1 
```

.text 的一部分：

```
stringlength:

    li $t2, 10
    li $t1, -1

    la $a0, number

loop:

    addiu $t1, $t1, 1

    lb $t0, $t1($a0)
    bne $t0, $t2, loop

    move $v0, $t1

jr $ra 
```

*代码未完成

我的问题是，

```
lb $t0, $t1($a0) 
```

我正在尝试实现一个以 1 为增量的动态偏移量，以检查字符串中的每个字节，以检查它是否等于 10（十进制）。

QtSPIM 引发关于这一行的异常语法错误，

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T19:16:22.663

没有这样的寻址模式，你只需要通过添加偏移量自己计算地址，例如：

```
add $t0, $t1, $a0
lb $t0, ($t0) 
```

# javascript - 无法从 jQuery 对象获取 innerHTML

> ID：13534617
> 
> 赞同：6
> 
> 时间：2012-11-23T19:07:34.817
> 
> 标签：javascript, jquery, innerhtml

我正在使用谷歌地图 api。我写了下面的代码。

```
<div id="map"></div> 
```

我使用 google chrome 控制台查看`$("div#map")`.

```
console.log($("div#map")); 
```

结果是：

```
[
<div id=​"map" style=​"width:​ 1218.222222328186px;​ position:​ relative;​ background-color:​ rgb(229, 227, 223)​;​ overflow:​ hidden;​ -webkit-transform:​ translateZ(0)​;​ ">​
<div style=​"position:​ absolute;​ left:​ 0px;​ top:​ 0px;​ overflow:​ hidden;​ width:​ 100%;​ height:​ 100%;​ z-index:​ 0;​ ">​…​&lt;/div>​
</div>​
] 
```

我怎样才能得到 innerHTML ：

```
<div style=​"position:​ absolute;​ left:​ 0px;​ top:​ 0px;​ overflow:​ hidden;​ width:​ 100%;​ height:​ 100%;​ z-index:​ 0;​ ">​…​&lt;/div>​ 
```

我试过`$("div#map > div")`了，但没有任何返回。为什么？是不是因为Javascript生成的innerHTML？我怎样才能得到它并将另一个 div 插入到上面的 div 中？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T19:16:42.150

要从有效的 jquery 选择器中获取普通的 javascript dom 对象，请使用`get(0)`or `[0]`。

```
$("#map")[0]//note that as id's are unique, you do not need to have anything else
            //in here to target them 
```

一旦你有了普通的 DOM 对象，你就可以使用`innerHTML`

```
$("#map")[0].innerHTML 
```

虽然更简单的方法是，因为您已经在使用 jQuery，所以使用 jQuery 的 innerHTML 版本`html`。

```
$("#map").html() 
```

至于你的第二个问题，你可以像这样在 div 中插入一个 div：

```
var newDiv = document.createElement("div");
newDiv.innerHTML = "simple text, probably want to make more elements and set attributes and build them using .appendChild().";
$("#map")[0].appendChild(newDiv); 
```

或者对于地图的父级是这样的：

```
$("#map")[0].parentNode.appendChild(newDiv); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:10:22.707

使用该`html()`方法从 jQuery 对象中获取 html。

```
console.log($("div#map").html()); 
```

[http://api.jquery.com/html/](http://api.jquery.com/html/)

# jquery - 带有 innerHtml 或 innerText 或 textContent 的 jquery id 选择器

> ID：13534618
> 
> 赞同：1
> 
> 时间：2012-11-23T19:07:38.397
> 
> 标签：jquery

我写了一个简单的页面来检查是否有人两次输入了正确的电子邮件。我想在页面天气的另一个元素中显示第二个表单块中的电子邮件是否与第一个相同。我正在使用 jquery id 选择器。

```
<head>
<script type="text/javascript" src="jquery1.8.3-min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">

    function emailCheck(){
        if($("#email").val() != $("#email2").val())
        {
            $("#err").innerText = "emails don't match, sucka";
            $("#test").textContent = "emails don't match, sucka";
            $("#test2").innerHtml = "emails don't match, sucka";
            document.getElementById("getEleTest").innerText = "emails don't match, sucka";
            alert("dont match");
        }
    }
</script>
</head>

<body>
<form action="SignUp" method="POST">
    <table>
        <label for="email">Email</label></br>   
        <input id="email" type ="email" name="email1111"/> </br>
        <label for="email2" > Enter Email Again </label></br> 
        <input id="email2" type="email" name="email21111" onkeyup="emailCheck();"></br>
        <input type="submit" value="Sign Up">
    </table>
</form>

<div id="err"></div>
<div id="test"></div>
<div id="test2"></div>
<div id="getEleTest"></div>
</body> 
```

在所有情况下，我都没有在我是 err、test 和 test2 元素的元素中收到任何文本，但我确实收到了一个警报窗口，并且 getEleTest 元素中有文本。这里可能发生了什么。我在 firebug 控制台中没有收到任何错误，jquery 正在获取 'email' 和 'email2' 元素。我检查了我是否正确链接了 jquery 脚本，以防万一我没有添加 google jquery 源。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:12:34.723

把所有 jQuery 的东西放进去`$(document).ready(function(){ //your code here });`

编辑 2：我的 JS 代码中有错字。您将常规 JS 与 jQuery 混合在一起。

为什么不写这样的东西？

```
$(document).ready(function(){
    $("#signUpForm").submit(function(evt){
        if($("#email").val() != $("#email2").val()){
            $("#err").html("emails don't match, sucka");
            $("#test").html("emails don't match, sucka");
            $("#test2").html("emails don't match, sucka");
            $("#getEleTest").html("emails don't match, sucka");
            alert("dont match");
            evt.preventDefault();
        };
    });
});​ 
```

并在表单中添加 id = "signUpForm" 属性？您还需要从 HTML 中删除内联 JS，这样您的输入就没有 onKeyUp 事件。[你可以在这里](http://jsfiddle.net/yp2pL/4/)
看到我的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:14:41.853

它应该是：

```
document.getElementById("id").textContent = "string"; 
```

或者

```
$("#id").text("string"); 
```

确保不要将两者结合起来，否则不会得到预期的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:21:49.563

像这样写你的代码我已经在我的机器上**测试过了**

```
<script type="text/javascript">
    function emailCheck(){
        if($("#email").val() != $("#email2").val())
        {
            $("#err").html("emails don't match, sucka");
            $("#test").html("emails don't match, sucka");
            $("#test2").html("emails don't match, sucka");

            document.getElementById("getEleTest").innerText = "emails don't match, sucka";
            //alert("dont match");
        }
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:43:46.957

所有答案都部分正确。您必须将代码包装在 $(document).ready 函数中，然后使用 jQuery 事件，而不是内联事件。问题是 onkeyup 在 jQuery 调用中不能正常工作，因为它们是在函数范围内调用的。我认为根本没有调用 emailCheck 函数。删除**onkeyup**并尝试此操作，然后从那里开始工作：

```
$(document).ready(function(){
  $('#email2').keyup( function() {
    alert("test");   
  });
}); 
```

# php - PHP 的 Aptana Studio 语法着色

> ID：13534619
> 
> 赞同：1
> 
> 时间：2012-11-23T19:07:40.850
> 
> 标签：php, aptana, syntax-highlighting, aptana3

我有一个配置为将 .pg 文件解析为 php 的 Web 服务器（不要问 :)）。我正在使用为 FTP 配置的 Aptana 来编辑上面的文件，当它们是 PHP 文件时，语法突出显示效果很好。现在它们是 .pg 文件，语法突出显示被破坏了。我可以将 Aptana 配置为对 .pg 文件使用 PHP 语法处理吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:21:40.417

转到“首选项”，然后您必须在左侧站点选择“常规”->“编辑器”->“文件关联”。在那里，您可以在正确的站点上添加文件格式。在您的情况下，您添加“* .pg”并在“PHP 源代码编辑器”下方选择（带有“添加”按钮”）

# android - 保存对话框状态信息

> ID：13534625
> 
> 赞同：0
> 
> 时间：2012-11-23T19:08:20.790
> 
> 标签：android, dialog

在我的应用程序中，我有一个显示对话框的“信息”，当我更改模拟器的方向时，我会丢失该对话框。所以我学会了如何保存实例：

```
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putInt("dialog", ChangeLogs);
}

protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    if(savedInstanceState.containsKey("dialog")){
        ChangeLogs(); // this is methos that show dialog
    }
} 
```

现在，每次我改变方向时，我都会看到对话框（显然这是因为没有任何检查对话框是否显示）。

我无法继续。我将要做的？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:28:39.083

使用`DialogFragment`这样你就再也不会想到那个保存状态了

# android - 如何从我的应用程序的单个 APK 安装多个 APK？

> ID：13534628
> 
> 赞同：2
> 
> 时间：2012-11-23T19:08:34.733
> 
> 标签：android, apk

我正在制作一个应用程序，我想在其中调用其他一些 apk（未预装）并且它们存在于我手机的 sd 卡中，我希望它们在安装主应用程序时安装。这可能吗？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:15:21.727

您可以使用以下 Intent 请求 Android 安装您的 APK：

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(new File(<path_to_your_file)), "application/vnd.android.package-archive");
startActivity(intent); 
```

请记住，用户可以取消此安装过程。此外，如果 APKs 在外部存储上，您将需要从外部存储读取的权限。此外，必须启用设备以允许侧载。

出于安全原因，您不能像 Google Play 在无根设备上那样静默安装 APK。

尽管您说您的 APK 位于 SD 卡上，但对于未来的读者来说，值得一提的`/assets`是，不支持从目录安装 APK。相反，您必须将 APK 复制到内部或外部存储，然后使用所需路径的 Intent。

# c# - 如何创建像 Butt 这样的 Icecast 客户端

> ID：13534629
> 
> 赞同：0
> 
> 时间：2012-11-23T19:08:35.860
> 
> 标签：c#, client, microphone, naudio, icecast

我需要在 C# 中创建一个 Icecast 客户端。这样做的主要目的是发送来自两个音频设备的传入音频，以便通过 Icecast 进行广播。

当我在寻找已经制定的解决方案时，我发现 Butt 正是我需要的，但我还需要分别向 Icecast 发送两个音频设备。

我已经从两个麦克风获取音频输入并将它们保存在一个文件夹中（每个麦克风一个音频文件）。现在我需要将两个麦克风分别广播到 Icecast。

这一切都是因为我需要像广播电台一样广播两个麦克风（每个麦克风一个电台）。

主要解决方案是这样的：

*   麦克风 1 => 像 Source Micro1 一样广播到 Icecast => 像 micro1.mp3 格式一样保存音频（工作）。
*   麦克风 2 => 像 Source Micro2 一样广播到 Icecast => 像 micro2.mp3 格式一样保存音频（工作）。

我需要知道如何广播到 icecast，我正在使用 NAudio 库来获取音频输入并保存它。

编辑：我正在从 C# 与 Icecast 通信，这是我的代码：

```
public static void commIcecast(string url)
    {
        WebClient client = new WebClient();

        client.Headers.Add("content-type", "audio/mpeg");
        client.Headers.Add("Authorization", "Basic c291cmNlOmhhY2ttZQ==");
        client.Headers.Add("ice-name", "This is my server name");
        client.Headers.Add("ice-url", "http://www.google.com");
        client.Headers.Add("ice-genre", "Rock");
        client.Headers.Add("ice-description", "This is my server description");
        client.Headers.Add("ice-audio-info", "ice-samplerate=44100;ice-bitrate=128;ice-channels=2");

        Stream data = client.OpenRead(url);
        StreamReader reader = new StreamReader(data);
        string s = reader.ReadToEnd();
        Console.WriteLine(s);
        data.Close();
        reader.Close();
    } 
```

但我只是从 Icecast 服务器收到这个答案：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Icecast Streaming Media Server</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0">
<h2>Icecast2 Status</h2>
<br><div class="roundcont">
<div class="roundtop"><img src="/corner_topleft.jpg" class="corner" style="display: none"></div>
<table border="0" width="100%" id="table1" cellspacing="0" cellpadding="4"><tr><td bgcolor="#656565">
<a class="nav" href="admin/">Administration</a><a class="nav" href="status.xsl">Server Status</a><a class="nav" href="server_version.xsl">Version</a>
</td></tr></table>
<div class="roundbottom"><img src="/corner_bottomleft.jpg" class="corner" style="display: none"></div>
</div>
<br><br>&nbsp;

<div class="poster">Support icecast development at <a class="nav" target="_blank" href="http://www.icecast.org">www.icecast.org</a>
</div>
</body>
</html> 
```

我尝试发送“SOURCE /mp3test ICE/1.0”，但 Headers.Add 方法不允许我这样做。

编辑：我通过 tcp 将其发送到 Icecast，但我无法回复，我只需要知道是否以这种方式发送它，如果是现在，我将不得不将帖子移至 tcp 问题。我没有收到使用这种发送方法的 Icecast 服务器的任何响应。

```
 System.Net.IPAddress address = System.Net.IPAddress.Parse(url);

            socketServer = new TcpClient(url, port);
            NetworkStream networkStream = socketServer.GetStream();

            data = Encoding.ASCII.GetBytes("SOURCE /csharp ICE/1.0");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("content-type: audio/mpeg");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("Authorization: Basic c291cmNlOmhhY2ttZQ==");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-name: lala");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-url: localhost");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-genre: Rock");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-bitrate: 128");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-private: 0");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-public: 1");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-description: This is my server description");
            networkStream.Write(data, 0, data.Length);

            data = Encoding.ASCII.GetBytes("ice-audio-info: ice-samplerate=44100;ice-bitrate=128;ice-channels=2");
            networkStream.Write(data, 0, data.Length);

            StreamReader reader = new StreamReader(networkStream);
            Console.WriteLine(reader.ReadToEnd()); 
```

有了这个我可以连接到 Icecast 服务器，至少连接的客户端数量在 Icecast 的全局统计中增加了，但是连接它丢失了，我无法得到任何响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T08:35:04.700

首先，您需要使用编解码器对捕获的音频进行编码。MP3 很受欢迎并且得到很好的支持。aacPlus 得到很好的支持（但不如 MP3 那么多），并且在大多数情况下提供更好的压缩比。

我不相信 NAudio 支持编码（如果我错了，请纠正我）。您将需要查看诸如 FFMPEG（各种可用的编解码器）或 LAME（优质 MP3 编解码器）之类的东西。作为奖励，如果您使用 FFMPEG，它能够为您从 DirectShow 源捕获，因此您只需编写代码即可从 STDOUT 获取数据。（请注意，这里存在潜在的许可问题，包括库的源代码和编解码器的专利。）

现在您已经编码了音频数据，您需要实现 Icecast 源协议。为此，请在此处查看我的答案： [https ://stackoverflow.com/a/9985297/362536](https://stackoverflow.com/a/9985297/362536)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-15T15:04:09.763

To solve my problem I used Edcast. This is the url [https://code.google.com/p/edcast-reborn/](https://code.google.com/p/edcast-reborn/)

Basically I used two instances of edcast, each one pointing a different audio input and they were connecting to the Icecast server.

With this configuration you can see the two edcast instances and listen the different audio inputs by accessing the Icecast server.

Thank you all for your help.

# linux - readelf 不显示共享库的版本号

> ID：13534630
> 
> 赞同：4
> 
> 时间：2012-11-23T19:08:39.990
> 
> 标签：linux, dynamic-linking, shared-libraries

对于为 编译的共享对象，使用选项`ARM`调用，显示没有版本号的库，即`readelf``-a``libc.so`

```
me@home:~ $ readelf -a shared_object_for_arm | grep "Shared library"
Type:                              DYN (Shared object file)
0x00000001 (NEEDED)                     Shared library: [libc.so]
0x00000001 (NEEDED)                     Shared library: [libm.so]
0x00000001 (NEEDED)                     Shared library: [libGLESv1_CM.so]
0x00000001 (NEEDED)                     Shared library: [libz.so]
0x00000001 (NEEDED)                     Shared library: [liblog.so] 
```

但是，当我对系统中的共享对象重复相同的操作时，会显示版本号。我也用于`arm-linux-gnueabi-readlef`上述情况，但没有任何改变。我正在一个`x86`系统中尝试这个。

```
me@home:~ $ readelf -a /usr/lib/libsnmp.so.15 | grep "Shared library"
Type:                              DYN (Shared object file)
0x00000001 (NEEDED)                     Shared library: [libcrypto.so.1.0.0]
0x00000001 (NEEDED)                     Shared library: [libc.so.6] 
```

`readelf`除了显示版本号还有其他方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T01:53:12.403

您可以尝试来自 elfutils 的 eu-readelf，但恕我直言，两者都只是转储那里的任何内容。如果 DT_NEEDED 条目不包含带版本的字符串，则它没有版本。共享对象的动态部分包含类似的 DT_SONAME 条目。SONAME 或共享对象名称是共享库（动态共享对象）的某种规范名称。

```
$ readelf -d /lib64/libc.so.6 | grep SONAME
0x000000000000000e (SONAME)             Library soname: [libc.so.6]

$ readelf -d /bin/ls | grep NEEDED
...
0x0000000000000001 (NEEDED)             Shared library: [libc.so.6] 
```

如果您针对某个库进行编译，则其 DT_SONAME 条目将被复制到您正在创建的二进制或共享对象的 DT_NEEDED 条目中。执行时，动态链接器将使用 DT_NEEDED 条目来查找具有该名称的文件。AFAIK 动态链接器不检查该文件的 DT_SONAME 条目，因此理论上它根本不需要 DT_SONAME 或者它可能不同。您只需确保目标系统上的 libc.so 指向正确的库。它可能是 libc.so.6 的符号，没关系。

总而言之，如果一个二进制文件与 libc.so.6 链接，另一个与 libc.so 链接，只要具有这些名称的实际文件相同或一个是另一个的符号链接，它仍然可以工作。如果您想检查运行时实际加载的内容，ldd 是您的朋友。

# php - php imagecolorat 返回 0。为什么？

> ID：13534632
> 
> 赞同：2
> 
> 时间：2012-11-23T19:09:04.397
> 
> 标签：php, image-processing, gd

有时 imagecolorat() 在我正在分析的 PNG 中返回 0 和一些像素。这是为什么？

我看了像素，颜色真的是#111111。所以它应该返回 1118481。对吧？

我尝试使用 imagealphablending($img,true) 但我仍然得到 0。

谢谢！

```
$img = @imagecreatefrompng($png);

if(!$img){
throw new Exception("Error loading PNG.");
}
var_dump(imagecolorat($img, 37, 625)); 
```

结果：

```
int 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:53:23.867

如果图像加载正确并且您得到 0，则表示颜色为纯黑色 (RGB => 0x000000 => 0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:55:09.223

因为那是那个像素的颜色：黑色（红色 = 0，绿色 = 0，蓝色 = 0）

如果您对大多数其他像素进行尝试，您将得到 16777215 (0xFFFFFF)，即白色（红色 = 255，绿色 = 255，蓝色 = 255）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:56:55.980

或者颜色是黑色，或者我认为图像没有正确加载。至少不是您作为示例的 .png 。也许@隐藏了图像未加载的错误。它的 url 正在重定向到另一个，在这种情况下，您应该使用 CURL 之类的东西来查找真实图像。

# oracle - flyway自定义清洁脚本的可能性

> ID：13534635
> 
> 赞同：3
> 
> 时间：2012-11-23T19:09:16.813
> 
> 标签：oracle, flyway

我们的 Oracle 数据库使用“文本数据字典”模块。设置的一部分创建了一个偏好。

```
 -- create preference...
    begin
          ctx_ddl.create_preference(....);
      ctx_ddl.set_attribute(...);
    end; 
```

问题是 flyway clean 目标并没有放弃这种偏好。

所以，我的问题是：是否可以添加/配置一个额外的清理脚本来删除非表/索引/视图对象？或者有没有其他方法可以实现这一目标？

编辑：我刚刚意识到调度程序中的作业也是如此。它们也不会被 flyway clean 删除。例如：

```
 sys.dbms_scheduler.create_job(
      job_name => 'MY_JOB',
      job_type => 'plsql_block',
      job_action => 'begin ctx_ddl.sync_index('...'); end;',
      repeat_interval => 'freq=secondly;interval=60',
      comments => 'run every minute',
      enabled => true);
    end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T08:28:34.163

开箱即用不支持自定义清理脚本。

您必须使用自己的清理代码包装 Flyway.clean() 执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-03T12:45:08.160

现在你可以使用[Flyway 回调](https://flywaydb.org/documentation/callbacks)。`afterClean`回调是您正在寻找的。

# jquery - jquery.animate()，奇怪的行为

> ID：13534638
> 
> 赞同：1
> 
> 时间：2012-11-23T19:09:55.157
> 
> 标签：jquery, html, css, animation

这是一个小样本。两个`div`s 应该在单击后浮动到中心，而另一个应该消失。点击“x”后，应该会回到原状。这对两者都很好，除了 right `div`，动画有一个奇怪的行为。

这是我第一次尝试对 做某事`animate()`，所以也许我监督了一些显而易见的事情。正如您在单击右侧的“x”后看到的那样`div`，它首先移动到页面底部，然后移动到正确的位置（这很丑陋）。我所做的`animate()`就是将更改的值重置为默认值，就像在第一个`div`. 和第一个一样，`div`我只改变了边距，它肯定与高度的改变有关。我怎样才能抑制这种行为并让它直接移动到那个位置？

浏览器：Firefox 16.0.2 [小提琴链接](http://jsfiddle.net/tF4RU/)

**测试.html**

```
<!DOCTYPE html>
<html>
    <head>

        <title>Welcome to BetManager</title>
        <meta charset="UTF-8"/>
        <link href="css/mainContent.css"    type="text/css" rel="stylesheet" />
        <link href="css/headContent.css"    type="text/css" rel="stylesheet" />
        <link href="css/welcome.css"        type="text/css" rel="stylesheet" />

        <script src="js/jquery-1.8.2.min.js"></script>
        <script src="js/welcome.js"></script>

    </head>
    <body>

        <div class="mainContainer">
            <div class="headContentContainer">

            </div>
            <div class="mainContentContainer">

                <div id="welcomeLogin" class="welcomeInnerContainer">
                    <div class="firstView" id="firstViewLogin">
                        default Image Login
                    </div>
                    <div class="afterView" id="afterViewLogin">
                        <div id="cancelLogin">
                            x
                        </div>
                    </div>
                </div>

                <div id="welcomeRegister" class="welcomeInnerContainer">
                    <div class="firstView" id="firstViewRegister">
                        default Image Register
                    </div>
                    <div class="afterView" id="afterViewRegister">
                        <div id="cancelRegister">
                            x
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </body>
</html> 
```

**欢迎.js**

```
$(document).ready(function(){

    // login panel
    $("#firstViewLogin").click(function(){
        $("#welcomeRegister").hide();
        $("#welcomeLogin").animate({
            marginLeft:'35%'
        });
        $("#firstViewLogin").fadeOut(500);
        $("#afterViewLogin").delay(500).fadeIn(500);
    });

    $("#welcomeLogin").hover(function(){
            $("#welcomeLogin").addClass("welcomeInnerContainerHovered");
        },
        function(){
            $("#welcomeLogin").removeClass("welcomeInnerContainerHovered");
    });

    $("#cancelLogin").click(function(){
        $("#welcomeLogin").animate({
            marginLeft:'15%'
        });
        $("#afterViewLogin").fadeOut(500);
        $("#firstViewLogin").delay(500).fadeIn(500);
        $("#welcomeRegister").show();
    });

    // register panel
    $("#firstViewRegister").click(function(){
        $("#welcomeLogin").hide();
        $("#welcomeRegister").animate({
            marginRight:'35%',
            height:'80%',
            marginTop:'5%'
        });
        $("#firstViewRegister").fadeOut(500);
        $("#afterViewRegister").delay(500).fadeIn(500);
    });

    $("#welcomeRegister").hover(function(){
            $("#welcomeRegister").addClass("welcomeInnerContainerHovered");
        },
        function(){
            $("#welcomeRegister").removeClass("welcomeInnerContainerHovered");
    });

    $("#cancelRegister").click(function(){
        $("#welcomeRegister").animate({
            marginRight:'15%',
            height:'60%',
            marginTop:'10%'
        });
        $("#afterViewRegister").fadeOut(500);
        $("#firstViewRegister").delay(500).fadeIn(500);
        $("#welcomeLogin").show();
    });

}); 
```

**欢迎.css**

```
body{
    background: #EEEEEE;
    width: 1920px;
    height: 900px;
    min-height:900px;
    margin:auto;
    font-family: Calibri;
}

.mainContainer{
    width: 80%;
    height:96%;
    min-height:96%;
    margin: auto;
    margin-top:2%;
}

.mainContentContainer{
    background: #CCCCCC;
    width: 100%;
    height:90%;
    min-height:80%;
    margin:auto;
}

.welcomeInnerContainer{
    width: 30%;
    height: 60%;
    border-radius: 5px;
    background: white;
    margin-top: 10%;
    cursor: pointer;
}

.headContentContainer{
    background: #999999;
    width:100%;
    height: 10%;
}

.welcomeInnerContainerHovered{
    width: 30%;
    height: 60%;
    background: white;
    margin-top: 10%;
    cursor: pointer;
    box-shadow: 6px 6px 6px #777777;
}

#welcomeLogin{
    float:left;
    margin-left: 15%;
}

#welcomeRegister{
    float:right;
    margin-right: 15%;
}

.afterView{
    display: none;
    cursor: default;
}

#cancelLogin{
    margin-left: 2%;
    cursor: pointer;
}

#cancelRegister{
    margin-left: 2%;
    cursor: pointer;  
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T19:27:45.993

看看[http://jsfiddle.net/TFtMq](http://jsfiddle.net/TFtMq) – dbaseman

您可能首先想要更改这样的内容以使用回调函数（动画完成后调用的函数）。[http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

```
$("#firstViewLogin").fadeOut(500);
$("#afterViewLogin").delay(500).fadeIn(500); 
```

到

```
$('#firstViewLogin').fadeOut(500, function() {
    $("#afterViewLogin").fadeIn(500);
}); 
```

# c++ - 实现自定义（字符串）流时的 Xcode 4.5.2 libc++ std::bad_cast

> ID：13534639
> 
> 赞同：5
> 
> 时间：2012-11-23T19:10:01.350
> 
> 标签：c++, iostream

我在使用 char16_t 作为 char 类型来实现我自己的自定义 stringbuf 和 stringstream 时遇到问题。作为测试，我使用了在旧的、可能已经过时的 C++ 手册中找到的 nullstringbuf 和 nullstringstream。这个 nullstringstream 充当“/dev/null”并且是一个简单的实现。
这个简单的 nullstream 在我使用时有效，`<char>`但在我使用时失败并出现 std::bad_cast 异常`<char16_t>`。我知道必须有一个`char_traits<char16_t>`可用的但 libc++ 似乎存在它。

```
 class nullstringbuf : public std::basic_stringbuf<char16_t>
     {
     public:
        nullstringbuf( )
        {
           setp(0,0);
           setg(0,0,0);
        }

        virtual ~nullstringbuf()
        {

        }

        virtual int_type underflow()
        {
           setg(0,0,0);
           return traits_type::eof();
        }

        virtual int overflow(int c)
        {
           setp(0,0);
           if ( c==traits_type::eof() )
              return 0;

           return c;
        }

     };

     class nullstringstream : virtual public std::basic_stringstream<char16_t>
     {
     public:
        // Constructor(s)
        nullstringstream(std::ios_base::openmode om = std::ios_base::out | std::ios_base::in)
        : std::basic_stringstream<char16_t>(om)
        {
           init(&m_StreamBuf);
        }

        nullstringstream(base::xstring const& val, std::ios_base::openmode om = std::ios_base::out | std::ios_base::in)
        : std::basic_stringstream<char16_t>(val, om)
        {
           init(&m_StreamBuf);
        }

        // Destructor
        virtual ~nullstringstream()
        {

        }

        nullstringbuf* rdbuf()
        {
           return &m_StreamBuf;
        }

        std::basic_string<char16_t> str() const
        {
           return m_StreamBuf.str();
        }

     private:
        nullstringbuf           m_StreamBuf;

        nullstringstream(nullstringstream const &); // do NOT implement!
        nullstringstream& operator=(nullstringstream const &); // do NOT implement!
     }; 
```

为了编译它，我还需要专门化`std::ctype<char16_t>`.

**我的问题？：**

*   除了 std::ctype/std::basic_stringbuf/std::basic_stringstream 之外，我还需要实现或专门化任何类或模板吗？
*   其他人使用 libc++、char16_t 和 iostreams 有同样的问题吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T20:08:40.350

使用不易支持的流类型实例化 IOStream 需要的不仅仅是实例化它并提供`std::char_traits<cT>`. 至少你还需要实例化一些方面：

*   `std::ctype<cT>`被访问，尽管不一定在许多情况下使用。
*   `std::numpunct<cT>`在格式化或解析任何数字类型时使用。
*   `std::num_get<cT>`解析 sny 数值类型时需要。
*   `std::num_put<cT>`格式化任何数字类型时会被添加。
*   如果您要使用文件流，您还需要提供`std::codecvt<cT, char>`.

副手我认为这些是你需要的方面。但是，我记得我需要做的事情比我想象的要多。

# css - 无框网格定位/浮动样式

> ID：13534646
> 
> 赞同：6
> 
> 时间：2012-11-23T19:10:22.813
> 
> 标签：css, grid, sass, responsive-design

我很难完全理解如何使用无框网格。我的意思是，我完全理解这个概念。听起来不错。

我想我的牛肉只是它没有提供任何定位元素的方式。它只是设置它们的宽度，就是这样。因此，即使您将列宽应用于元素，除非您开始绝对浮动或定位，否则所有内容都会堆叠。

在这方面，我想我正在寻找一些关于是否有一些通用定位样式可以用来防止这些元素堆叠的建议。

还是这太宽泛了？我应该根据具体情况定位我的元素吗？

（也只是仅供参考，我正在使用 SASS，以防万一有帮助）

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T23:06:57.027

**UPD：Frameless Grid 已经提出了实际代码（SASS、LESS 和 JS），所以下面的答案已经过时了。**

无框架更像是一种方法，而不是网格框架。

它本身不做任何事情，除了用于网格计算的单个函数（即使没有关于如何实际使用此函数的适当文档）。

我们来看一下：

* * *

> *1\. 制作一个规则的固定宽度网格。*
> 
> *选择一个列宽，一个装订线宽度……你知道的，通常的东西。暂时不要担心列的数量，否则请使用您通常用于创建固定宽度网格的任何标准。我建议使用相对较小的列宽以增加灵活性。*

我们必须自己组装一个网格。使用任何东西来实现这一点，Frameless 不提供任何东西。列宽应为固定宽度。

* * *

> *2.让它无限重复。*
> 
> *现在，给您的网格提供无限数量的列，这样无论您的视口有多宽，都会有越来越多的列进入视野。想象一下，你正在看一个无限宽的蜂窝，里面装满了柱子而不是六边形。*

通过“无限数”，他们似乎意味着“任何必要的数字”。无框主页适用于迷人的 26 列（您需要 1920 像素的显示宽度才能查看），但 frameless.scss 仅提供 16 列的变量。

通过“为您的网格提供一些列”意味着“提出一种最大利用一定数量列的设计”。

* * *

> *3\. 在视口中居中。*
> 
> *将网格水平对齐到视口的中间。对于具有偶数列的网格（如图），将视口的中心点对齐在两个最中心列之间的排水沟中间。对于奇数网格，将其对齐在最中心列的中间。*

这是非常基本的，但它需要我们手动编写另一行 CSS 代码。

* * *

> *4\. 就是这样，真的。*
> 
> *开始使用网格。随着更多列的可用，使用媒体查询来调整您的设计。由于您将逐列而不是逐像素调整，因此您可以准确选择布局应该和不应该适应的时间。例如，该站点仅适应大约 320、480、600、900 和 1900 像素。要查看它的实际效果，请尝试调整浏览器窗口的大小。*

不，那不是“它”。这就是工作真正开始的地方。

您必须手动对网格进行编码以适应各种视口，而 Frameless 没有为此提供任何工具。

* * *

因此，如果您正在寻找可用于组装网格的工具，我推荐[Susy](http://susy.oddbird.net/)。这是一个伟大而优雅的 SASS。

苏西非常多才多艺。它有不同的网格类型（[演示](http://susy.oddbird.net/demos/grid-types/)）。它也有不同的方法：您可以通过声明单个列宽并让 Susy 调整列数以匹配窗口宽度来获取[内容。](http://adactio.com/journal/4523/)或者您可以声明哪些列数对应于哪些窗口宽度，并让 Susy 相应地调整列宽。

Susy 让您实现 Frameless 的建议，但它也提供了所有必要的工具。在技​​术上有所不同，Susy 有着相同的想法：从手机的小网格开始，随着屏幕变大而变大。这个[演示](http://susy.oddbird.net/demos/magic/)说明了两个这样的步骤：它从 7 列开始，但如果屏幕宽度建议，它会变成 12 列。

在这里，我创建了一个使用 Susy 以五个步骤进行拉伸的网站：[http://am-teh.ru您可以在](http://am-teh.ru)[StackOverflow 帖子](https://stackoverflow.com/questions/13461313/susy-creating-a-grid-for-given-screen-widths-breakpoint-px-values-and-not-kno)中看到该网站布局背后的代码（以及它的概念演变）。Susy 的开发者对此给予了正面评价。

# xml - 将子节点附加到父节点

> ID：13534647
> 
> 赞同：1
> 
> 时间：2012-11-23T19:10:29.320
> 
> 标签：xml, xslt

我需要将子节点附加到父节点中。order_h 下的 order_no 等于下一个兄弟 order_d 应该合并到父节点 order_h

这是xml

```
 <document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <order>
        <order_h owner="GD" order_no="421424" profoma_po="421425">
          <order_d owner="GD" item_no="100000014" line_no="1" order_no="421424" color_code="730" manufacturer="100783">
            <size assoc_id="69398" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
              <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602001" size_code="S" alloc_qty="26" plan_pct_ratio="34" row_no="0" sort_value="6"/>
              </Size_b>
              <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602182" size_code="L" alloc_qty="11" plan_pct_ratio="15" row_no="0" sort_value="8"/>
              </Size_b>
              <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602078" size_code="M" alloc_qty="21" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
              </Size_b>
              <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602060" size_code="XS" alloc_qty="18" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
              </Size_b>
            </size>
          </order_d>
    </order_h>
        <order_h owner="GD" order_no="421424" profoma_po="421425">
          <order_d owner="GD" item_no="100000014" line_no="3" order_no="421424" color_code="002" manufacturer="100783">
            <size assoc_id="69400" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
              <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602019" size_code="S" alloc_qty="17" plan_pct_ratio="34" row_no="0" sort_value="6"/>
              </Size_b>
              <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602238" size_code="M" alloc_qty="14" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
              </Size_b>
              <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602131" size_code="XS" alloc_qty="12" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
              </Size_b>
              <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602027" size_code="L" alloc_qty="8" plan_pct_ratio="15" row_no="0" sort_value="8"/>
              </Size_b>
            </size>
          </order_d>
        </order_h>
    </order>
    </document> 
```

并且预期的xml输出如下

```
<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<order>
<order_h owner="GD" order_no="421424" profoma_po="421425">
  <order_d owner="GD" item_no="100000014" line_no="1" order_no="421424" color_code="730" manufacturer="100783">
    <size assoc_id="69398" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
      <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602001" size_code="S" alloc_qty="26" plan_pct_ratio="34" row_no="0" sort_value="6"/>
      </Size_b>
      <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602182" size_code="L" alloc_qty="11" plan_pct_ratio="15" row_no="0" sort_value="8"/>
      </Size_b>
      <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602078" size_code="M" alloc_qty="21" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
      </Size_b>
      <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602060" size_code="XS" alloc_qty="18" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
      </Size_b>
    </size>
  </order_d>
  <order_d owner="GD" item_no="100000014" line_no="3" order_no="421424" color_code="002" manufacturer="100783">
    <size assoc_id="69400" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
      <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602019" size_code="S" alloc_qty="17" plan_pct_ratio="34" row_no="0" sort_value="6"/>
      </Size_b>
      <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602238" size_code="M" alloc_qty="14" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
      </Size_b>
      <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602131" size_code="XS" alloc_qty="12" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
      </Size_b>
      <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602027" size_code="L" alloc_qty="8" plan_pct_ratio="15" row_no="0" sort_value="8"/>
      </Size_b>
    </size>
  </order_d>
</order_h>
</document> 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:30:12.127

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="order_h"/>

 <xsl:template match="order_h[1]">
  <xsl:copy>
   <xsl:apply-templates select=
    "@*|node()|following-sibling::*/node()"/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时**：

```
<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <order>
        <order_h owner="GD" order_no="421424" profoma_po="421425">
            <order_d owner="GD" item_no="100000014" line_no="1" order_no="421424" color_code="730" manufacturer="100783">
                <size assoc_id="69398" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
                    <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602001" size_code="S" alloc_qty="26" plan_pct_ratio="34" row_no="0" sort_value="6"/>
                    </Size_b>
                    <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602182" size_code="L" alloc_qty="11" plan_pct_ratio="15" row_no="0" sort_value="8"/>
                    </Size_b>
                    <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602078" size_code="M" alloc_qty="21" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
                    </Size_b>
                    <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602060" size_code="XS" alloc_qty="18" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
                    </Size_b>
                </size>
            </order_d>
        </order_h>
        <order_h owner="GD" order_no="421424" profoma_po="421425">
            <order_d owner="GD" item_no="100000014" line_no="3" order_no="421424" color_code="002" manufacturer="100783">
                <size assoc_id="69400" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
                    <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602019" size_code="S" alloc_qty="17" plan_pct_ratio="34" row_no="0" sort_value="6"/>
                    </Size_b>
                    <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602238" size_code="M" alloc_qty="14" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
                    </Size_b>
                    <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602131" size_code="XS" alloc_qty="12" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
                    </Size_b>
                    <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                        <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602027" size_code="L" alloc_qty="8" plan_pct_ratio="15" row_no="0" sort_value="8"/>
                    </Size_b>
                </size>
            </order_d>
        </order_h>
    </order>
</document> 
```

**产生想要的正确结果**：

```
<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <order>
      <order_h owner="GD" order_no="421424" profoma_po="421425">
         <order_d owner="GD" item_no="100000014" line_no="1" order_no="421424" color_code="730" manufacturer="100783">
            <size assoc_id="69398" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
               <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602001" size_code="S" alloc_qty="26" plan_pct_ratio="34" row_no="0" sort_value="6"/>
               </Size_b>
               <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602182" size_code="L" alloc_qty="11" plan_pct_ratio="15" row_no="0" sort_value="8"/>
               </Size_b>
               <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602078" size_code="M" alloc_qty="21" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
               </Size_b>
               <Size_b assoc_id="69398" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69398" ship_pack="BULK" ctn_sku="5602060" size_code="XS" alloc_qty="18" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
               </Size_b>
            </size>
         </order_d>
         <order_d owner="GD" item_no="100000014" line_no="3" order_no="421424" color_code="002" manufacturer="100783">
            <size assoc_id="69400" match_id="14" pack_code="BULK" size_range="2" model_name="SIZE SCALE 2" size_id="SIZE SCALE 2">
               <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602019" size_code="S" alloc_qty="17" plan_pct_ratio="34" row_no="0" sort_value="6"/>
               </Size_b>
               <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602238" size_code="M" alloc_qty="14" plan_pct_ratio="27.5" row_no="0" sort_value="7"/>
               </Size_b>
               <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602131" size_code="XS" alloc_qty="12" plan_pct_ratio="23.5" row_no="0" sort_value="5"/>
               </Size_b>
               <Size_b assoc_id="69400" row_no="0" pct_ratio="PCT" total_pct="100" priority="0" ship_pack="BULK">
                  <size_d assoc_id="69400" ship_pack="BULK" ctn_sku="5602027" size_code="L" alloc_qty="8" plan_pct_ratio="15" row_no="0" sort_value="8"/>
               </Size_b>
            </size>
         </order_d>
      </order_h>
   </order>
</document> 
```

# jquery-ui - 加载后jquery ui对话框未垂直居中

> ID：13534650
> 
> 赞同：2
> 
> 时间：2012-11-23T19:10:47.203
> 
> 标签：jquery-ui, dialog, center, vertical-alignment

我使用具有动态高度的 jquery ui 对话框。当它打开时它是居中的，但是当它加载内容时它会向页面底部扩展。

这是我的功能：

```
$(this.document).ready(function () {
    $(".openDialog").live("click", function (e) {
        e.preventDefault();

        $("<div></div>")
                    .addClass("dialog")
                    .attr("id", $(this)
                    .attr("dialog-id"))
                    .dialog({
                        autoOpen: false,
                        title: $(this).attr("dialog-title"),
                        close: function () { $(this).remove() },
                        modal: true,
                        width: $(this).attr("dialog-width"),
                        heith: 'auto',
                        resizable: false,
                        draggable: false,
                        show: 'scale',
                        hide: 'puff',
                        position: ['center', 'middle']
                    })
                    .load(this.href).dialog("open");
    });

    $(".close").live("click", function (e) {
        e.preventDefault();
        $(this).closest(".dialog").dialog("close");
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:20:55.527

我可以通过设置 autoOpen:false 并在 create 方法中使用我的 ajax 调用创建对话框内容来解决此问题。一旦返回并创建了内容，我就在对话框中调用 open。效果很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T03:38:25.133

以上对我不起作用。

```
$(document).live("ajaxStop", function (e) {
      $("#myDiagDiv").dialog("option", "position", "center");
}); 
```

# objective-c - 在 Xcode (iOS) 中制作另一个屏幕

> ID：13534651
> 
> 赞同：0
> 
> 时间：2012-11-23T19:10:48.640
> 
> 标签：objective-c, ios, xcode, ios6

我正在使用最新版本的 Xcode 和 iOS SDK 开发我的第一个应用程序。我看到了很多选择，到目前为止，快速谷歌搜索让我失望了。到目前为止，我为我的应用程序设置了一个主屏幕（它具有一个搜索文本字段，可在另一个文本字段中显示内容），我现在想制作第二个屏幕。我可以通过多种方式做到这一点，比如有一个开关，其中文本字段更改为选择器控件，这样的操作会改变行为，或者我可以完全切换到另一个视图。我认为学习第二种方法将来对我更有益，所以我想知道我应该做些什么来做到这一点。一个看法？另一个故事板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:15:33.583

您必须添加另一个 UIViewController 子类和 XIB，然后 #import 它然后打开它。

```
[self presentViewController:viewController animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:20:33.497

添加视图；一个视图相当于一个页面。故事板是视图/页面的集合；它有助于将视图保持在一起，然后您还可以轻松地在故事板中组织视图/页面之间的流程。Storyboard 就像一个 Java/C++ 包，而 View 就像一个类。

# url - 是否有任何需要 ; 的当前浏览器（包括 IE 6）而不是一个？将路径与 URL 中的查询分开？

> ID：13534653
> 
> 赞同：0
> 
> 时间：2012-11-23T19:10:55.290
> 
> 标签：url, browser, path, cross-browser

我正在向旧版 Web 应用程序添加一些功能，该应用程序具有与以下内容等效的 JavaScript 片段，用于构建相对 URL 的路径。原始代码中的注释暗示该`document.all`调用可能用于 Internet Explorer 6 检测：

```
var url = document.all ? 'path;' : 'path?';
// followed by code adding query parameters separated by & 
```

我已经在网上搜索和阅读，并了解使用`document.all`浏览器检测是过时的。我无法访问 IE 6，并且认为任何使用它的人都应该停止。同时，我不想给可能仍在使用它的任何用户带来问题。

我的问题是：是否有任何*当前的*浏览器（我在这个组中自由地包括 IE 6），出于任何原因，需要分号而不是问号来将路径与查询分开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:25:22.537

见鬼，没有人。问号是自从[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)至少在 90 年代初，也许更早出现以来，情况如何。它是[RFC 1738](https://www.rfc-editor.org/rfc/rfc1738)的一部分。我认为没有任何浏览器曾经使用过分号而不是问号。

编辑：看起来 HTTP/1.0 中有一个 ;params 功能，但这是对 ?query 部分的补充。似乎已经在 HTTP/1.1 中消失了，尽管它长期以来一直是标准。我很想知道是否有人曾经使用过它？我从事 Web 开发已有 10 年，从未听说有人使用它。

# ios - NSTimer 内存管理

> ID：13534654
> 
> 赞同：14
> 
> 时间：2012-11-23T19:10:57.317
> 
> 标签：ios, nstimer, strong-references

当我执行此代码时：

```
[NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(showButtons) userInfo:nil repeats:NO]; 
```

我是否需要将它归零或释放它，或者用于内存管理？

我正在使用 ARC

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-23T19:25:25.730

是的，`NSTimer`将保持对 的强引用`target`，这可能会导致（尤其是在重复计时器中）强引用周期（又名保留周期）。但是，在您的示例中，计时器不会重复，并且仅延迟 0.5，因此在最坏的情况下，您将拥有一个强大的参考周期，它将在 0.5 秒内自动解决。

但是一个未解决的强引用循环的常见示例是具有重复`UIViewController`的`NSTimer`属性，但由于`NSTimer`具有对 的强引用`UIViewController`，控制器最终将被保留。

因此，如果您将 保留`NSTimer`为实例变量，那么，是的，您应该`invalidate`使用它来解决强引用循环。如果您只是调用`scheduledTimerWithTimeInterval`，但没有将其保存到实例变量中（可能从您的示例中推断出），那么当`NSTimer`完成时，您的强引用循环将得到解决。

而且，顺便说一句，如果您正在处理重复`NSTimers`，请不要尝试将`invalidate`它们归入`dealloc`的所有者，`NSTimer`因为在`dealloc`解决强引用循环之前显然不会调用它们。例如，在 a 的情况下`UIViewController`，您可以在`viewDidDisappear`.

顺便说一句，[高级内存管理编程指南](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-1000810)解释了强引用周期是什么。显然，这是在他们描述正确使用弱引用的部分中，这在此处不适用（因为您无法控制对`NSTimer`目标使用强引用的事实），但它确实解释了强参考循环很好。

* * *

如果您不想在 macOS 10.12 和 iOS 10 或更高版本`NSTimer`中保留对 的强引用`self`，您可以使用块再现，然后使用`weakSelf`模式：

```
typeof(self) __weak weakSelf = self;
[NSTimer scheduledTimerWithTimeInterval:0.5 repeats:false block:^(NSTimer * _Nonnull timer) {
    [weakSelf showButtons];
}]; 
```

* * *

顺便说一句，我注意到你在打电话`showButtons`。如果您只想在视图上显示一些控件，则可以完全取消使用`NSTimer`并执行以下操作：

```
self.button1.alpha = 0.0;
self.button2.alpha = 0.0;

[UIView animateWithDuration:0.25
                      delay:0.5
                    options:UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionAllowUserInteraction
                 animations:^{
                     self.button1.alpha = 1.0;
                     self.button2.alpha = 1.0;
                 }
                 completion:nil]; 
```

这不会遇到`NSTimer`对象的保留问题，并且在一个语句中执行延迟以及按钮的优雅显示。如果你在你的`showButtons`方法中做额外的处理，你可以把它放在`completion`块中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T19:16:45.970

如果您将它保存在属性中，那么是的，您确实需要在触发选择器后将其设置为 nil。

保存它也是安全的，以防您的班级因任何原因被释放，以便您可以`[timer invalidate]`在需要时进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:36:10.133

是的，你可以使用：`myTimer=[NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(showButtons) userInfo:nil repeats:NO];` 然后在你的 viewDidDisappear`[myTimer invalidate]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-24T10:25:01.260

使用使用闭包的 Timer 的新方法

```
timer = Timer.scheduledTimer(withTimeInterval: 0.5, repeats: true, block: {[weak self] (timer) in
   print("Tick tock")
   guard let ws = self else { return }
   //some action that repeats
   ws.myViewControllerMethod()
}) 
```

# jquery - 由于跨域功能，无法从我的网站的 yahoo Finance api 获得结果

> ID：13534656
> 
> 赞同：0
> 
> 时间：2012-11-23T19:11:00.693
> 
> 标签：jquery, ajax

if (window.XMLHttpRequest) { xmlhttp=new XMLHttpRequest(); } else {// IE6、IE5 的代码 xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); } xmlhttp.open("GET","http://finance.yahoo.com/d/quote.csve=.csv&s=^BSESN&f=nl1c2vgh&random=10",true); xmlhttp.send(null); xmlhttp.onreadystatechange=function() { if (xmlhttp.readyState==4) { window.alert(xmlhttp.status); } }

**上面的代码在 IE 中显示状态 200 但在 Firefox 和 Chrome 中，由于跨域功能，状态为 0。任何人都可以帮助如何使用 java 脚本克服这种跨域功能。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:27:02.567

由于跨域问题，无法从 JavaScript ajax 直接调用其他域 进行此类调用的最佳方法是使用 Ajax 调用您自己的网页，并从您的服务器端脚本调用这些 api 并获得答案并返回您的 ajax 调用。

如果您使用的是 php，则可以使用**cURL**或**file_get_contents**从 url 获取内容

# ruby - 从 Ruby 调用共享库

> ID：13534660
> 
> 赞同：1
> 
> 时间：2012-11-23T19:11:18.527
> 
> 标签：ruby

我对带有共享库的 ruby​​ Interop 有疑问。

当我使用此代码时：

```
module mymodule
  extend DL::Importer
  dlload './lib.so'
  extern 'int Open(int my_id, int size, int creat)'
end 
```

在 ruby​​ 上下文中无法识别 int 类型。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:34:32.457

不要在`extern`调用中指定参数名称，只需指定类型：

```
extern 'int Open(int, int, int)' 
```

# php - PHP mail() 不能使用特定的后缀

> ID：13534661
> 
> 赞同：0
> 
> 时间：2012-11-23T19:11:28.537
> 
> 标签：php, email

> **可能重复：**
> [PHP 邮件停止工作](https://stackoverflow.com/questions/1892409/php-mail-stopped-working)

我正在使用 PHP`mail()`函数发送联系我们表单。这适用于我尝试过的所有电子邮件，但那些带有客户公司后缀的电子邮件：`[something]@3gdirectpay.com`. 该函数返回`true`，但他什么也没得到，即使在检查了垃圾邮件之后。

编码：

```
<?php

$email="You have recieved a new message from a customer: \r\n \r\n";
if (isset($_POST)) {
    foreach ($_POST as $key=>$value) {
        if (isset($value) && $value!='' && $key[0]!='x' && $key!='mf_mail' && $key!=='mf_text') {
            $email.=$_POST['x' . $key] . $value . "<br>";
        }
        else if ($key=='mf_text') {
            $text = "Message: " . $value;
        }
}
$headers = 'MIME-Version: 1.0' . "\r\n"; 
$headers .= 'Content-type: text/html; charset=utf-8' . "\r\n";   
$email.= $text;
$to = "info@3gdirectpay.com, eran@3gdirectpay.com";
$from = $_POST['mf_mail'];
$subject = "New message from a customer";
mail($to,$subject,$email,$headers);

    }

header("Location:http://www.3gdirectpay.com/?m=sent");

?> 
```

客户说他们使用 Gmail 托管他们的邮件服务。我很肯定它与后缀有关，但是什么会导致这种奇怪的行为呢？

# c# - 从 Sql 中读取列并填充到列表框

> ID：13534666
> 
> 赞同：0
> 
> 时间：2012-11-23T19:11:44.953
> 
> 标签：c#, sql, sql-server-express

我的 sql 查询有问题。

```
SqlConnection conn = new SqlConnection();
        conn.ConnectionString = "Data Source=.\\SQLExpress;" + "Trusted_Connection=True;" + "User Instance=True;" + "AttachDbFilename=|DataDirectory|\\fbi.mdf;";
        string sqlQuery4 = "SELECT Car FROM tbl1 JOIN tbl2 ON (tbl1.userID = tbl2.userID) WHERE tbl2.username='Bob'";
        SqlCommand cmd4 = new SqlCommand(sqlQuery4, conn);
        conn.Open();
        SqlDataReader rd = cmd4.ExecuteReader();
        rd.Read();
        ddl1.Items.Add(rd.GetValue(0).ToString());
        conn.Close(); 
```

所以它应该从 tbl1 返回属于 Bob 的所有汽车。查询只返回一个字符串并将其放入列表框“ddl1”，而它应该至少返回其中的 3 个。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:16:16.940

您需要遍历阅读器：

```
while (rd.Read()){
   ddl1.Items.Add(rd.GetValue(0).ToString());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:02:53.953

Novak，不确定 Curt 的解决方案是什么问题，因为它是正确的。您的完整声明应如下所示：

```
string connectionString= "Data Source=.\\SQLExpress;Trusted_Connection=True;User Instance=True;AttachDbFilename=|DataDirectory|\\fbi.mdf;";
string query = "SELECT Car FROM tbl1 JOIN tbl2 ON (tbl1.userID = tbl2.userID) WHERE tbl2.username='Bob'";

using (SqlConnection connection = new SqlConnection(connectionString))
{
    using (SqlCommand command = new SqlCommand(query, connection))
    {
        connection.Open();
        using (SqlDataReader reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                ddl1.Items.Add(reader.GetValue(0).ToString());
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T20:15:35.070

试试下面的代码：

```
SqlConnection conn = new SqlConnection();
        conn.ConnectionString = "Data Source=.\\SQLExpress;" + "Trusted_Connection=True;" + "User Instance=True;" + "AttachDbFilename=|DataDirectory|\\fbi.mdf;";
        string sqlQuery4 = "SELECT Car FROM tbl1 JOIN tbl2 ON (tbl1.userID = tbl2.userID) WHERE tbl2.username='Bob'";
        SqlCommand cmd4 = new SqlCommand(sqlQuery4, conn);
        conn.Open();
        SqlDataReader rd = cmd4.ExecuteReader();

                ddl1.DataSource = rd;
                ddl1..DataTextField = "columnname"; //your column name
                ddl1.DataValueField = "columnname";
                ddl1.DataBind();

                rd.Close();
                conn.Close(); 
```

# vb.net - 获取unix时间戳

> ID：13534670
> 
> 赞同：0
> 
> 时间：2012-11-23T19:12:08.597
> 
> 标签：vb.net

这是一个非常简单的问题，但我什么也没找到。

我想以秒为单位获得当前的 unix 时间戳，我想获得与 PHP`time()`函数相同的结果。

`System.Now`返回当前时间的完整日期。

如何在 vb.net 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T22:24:53.607

我相信这会做到：

```
Public Shared Function GetUnixTimestamp () As Double
    Return (DateTime.Now - new DateTime (1970, 1, 1, 0, 0, 0, 0)).TotalSeconds
End Function 
```

# macos - 为什么我的 Apache 重定向所有内容？

> ID：13534671
> 
> 赞同：-1
> 
> 时间：2012-11-23T19:12:09.563
> 
> 标签：macos, apache, redirect

这涉及一个很久以前别人建立的旧网站，在 mac 系统上的 apache 1 上运行。

现在，这应该被替换，我已经通过 .htaccess 文件（RedirectMatch 永久 ^/(.*)$）将所有请求重定向到一个新网站，但忘记了，子文件夹中还有一个项目，必须保持可访问性。但是，这个错误我似乎无法撤消。我删除了 .htaccess 文件 - 仍然重定向 - 重新创建了一个空文件 - 仍然重定向 - 并重新启动了 apache。尽管如此，我还是被重定向到了新网页。发生了什么？我怎样才能知道？

非常感谢，黛娜

* * *

编辑：

我现在经常检查。它总是告诉我，.htaccess 文件不再存在。我试过了

```
sudo find . -name .htaccess 
```

它。在某些子文件夹中，有一些我从未接触过的 .htaccess 文件。我已经编辑 /etc/httpd/httpd.conf 说

```
AccessFileName .htaccessory 
```

重新启动

```
sudo apachectl restart 
```

并且仍然被重定向。（怀疑一切并考虑更好地睡觉......）

我的 httpd.conf 太长了，怎么发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:33:19.220

我的浏览器必须已缓存该站点。我改变了我正在测试的机器，一切都显示出来了，根本没有重定向。首先令人惊讶，因为我记得当事情开始变得混乱时重新启动了 Firefox。*令人惊讶的是，我现在根本*无法进行任何重定向。我想说，问题解决得太好了。我的 .htaccess 文件看起来像：

```
RedirectMatch permanent ^/subsite(.*)$ http://newpage.de/subsite 
```

没关系，对吧？但它不起作用。天啊。好吧，我想已经很晚了。非常感谢大家，抱歉问。

最好的问候，黛娜

# mysql - 有效关联日志条目，例如失败的登录尝试

> ID：13534675
> 
> 赞同：1
> 
> 时间：2012-11-23T19:12:31.967
> 
> 标签：mysql, sql, sql-server, mongodb, nosql

我正在寻找一种有效的方法来识别帐户暴力破解。我的日志数据库包含身份验证日志条目。每个条目都有：

*   时间戳
*   用户名
*   IP地址
*   登录尝试结果（成功/失败）

我想生成一份报告，指出哪些登录受到了攻击。被攻击定义为：在 N 分钟（例如 10 分钟）内从同一 IP 地址未成功登录尝试后未成功登录尝试。测试用例是：

*   用户/IP 组合尝试两次登录失败，第三次成功登录（无攻击）
*   用户/IP 组合尝试登录失败两次，第三次成功，而同一用户，但不同的 ip 尝试登录失败（攻击第二个用户/IP 组合）

我可以想象一个使用 O(n*log(N)) 解决方案的解决方案：一个游标遍历每条记录，然后使用另一个游标查找以后的记录以确定活动。相当低效。

DB 无所谓：SQL、MySQL、nosql 等，因为数据可以轻松转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:29:11.547

按 5 分钟的时间间隔对日志项进行分组。对于超过一半警报阈值的所有组，请执行更昂贵但完全正确的检查。

这可能会过滤掉几乎所有不是真正攻击的日志项。并且分组操作易于编程和快速执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T14:18:41.130

根据您愿意在此复杂事件处理上花费多少工作，可能是一种选择。如果您使用 Java，则有诸如[Esper之类的框架。](http://esper.codehaus.org/)

这个想法是根据您的服务器日志（或 SQL 结果）创建一个事件流，并让 Esper 检查相关性。[请参阅示例查询](http://esper.codehaus.org/tutorials/solution_patterns/solution_patterns.html#aggregate-0)。

# haskell - 是否可以使用 foldl 而不是 foldr 来实现过滤器？

> ID：13534676
> 
> 赞同：3
> 
> 时间：2012-11-23T19:12:32.497
> 
> 标签：haskell, functional-programming

是否可以使用 foldl 而不是 foldr 来实现过滤器？如果是这样，请温和地解释你的实现。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T19:34:37.643

使用[差异列表](http://www.haskell.org/haskellwiki/Difference_list)：

```
filter' :: (a -> Bool) -> [a] -> [a]
filter' p xs = foldl (\k x -> if p x then k . (x:) else k) id xs [] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T19:18:30.217

如果您想保持列表的顺序，则效率不高。天真的方法是将其更改为 foldl 然后反转结果列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T19:30:08.477

想出了这个：

```
myFilter p coll =
  foldl step [] coll where 
    step acc e  
      | p e = acc ++ [e] 
      | otherwise = acc 
```

这不是很有效，因为它必须在列表末尾插入一个元素。

# python - Python线程通信不起作用

> ID：13534678
> 
> 赞同：1
> 
> 时间：2012-11-23T19:12:37.467
> 
> 标签：python, multithreading, events, thread-safety

我有两个线程，Reader 和 Writer。

Writer 从网络获取数据，然后通过套接字将其发送到某个可执行文件。完成此操作后，作者应阻止最多 70 秒，我使用 Event.wait(askrate) 指定。

这应该给可执行文件足够的时间来计算结果，然后提交输出。如果计算完成，我使用 Event.set() 来释放 Writer 线程上的锁，以便它可以读取下一个被转发到可执行文件的数据，依此类推。

我遇到的问题是，Writer 线程仍在继续读取数据，而 Reader 线程正在等待来自串行接口的结果。

有人知道为什么这种阻塞机制在这两个线程之间不能正常工作吗？

```
askrate = 70

s = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
s.connect("/tmp/demo_socket")

class Reader(Thread):
    def __init__(self):
        Thread.__init__(self)
        self.daemon = True

    def run(self):
        while True:            
            nonce = s.recv(4)            
            if len(nonce) == 4:
                submitter = Submitter(writer.block, nonce)
                #submit result and release thread lock in Writer class 
                golden.set()

class Writer(Thread):
    def __init__(self):
        Thread.__init__(self)
        self.daemon = True

    def run(self):
        while True:
          work = bc.getwork()                
          self.block = work['data']
          self.midstate = work['midstate']

          payload = self.midstate.decode('hex') + self.block.decode('hex')
          s.send(payload)
          result = golden.wait(askrate)

          if result:
             golden.clear()

golden = Event()

reader = Reader()
writer = Writer()

reader.start()
writer.start() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T10:13:30.417

我很确定这不是您应该使用 AF_UNIX 套接字的方式。您应该打开伪文件两次（来自不同进程的相同）；然后写入一侧显示为另一侧的读取，反之亦然。在您的代码中，您只打开一次伪文件。任何写入都可能被阻塞，等待另一个进程第二次打开伪文件。

在您的情况下，您应该使用 socket.socketpair()，它一次返回两个套接字，扮演两端的角色。在每个线程中使用一个末端。

# jsf-2 - PrimeFaces 自动完成错误

> ID：13534679
> 
> 赞同：1
> 
> 时间：2012-11-23T19:12:38.730
> 
> 标签：jsf-2, primefaces

我在使用 p:autoComplete 时遇到了一个奇怪的问题，出现以下错误

> java.lang.NumberFormatException：对于输入字符串：“玩家”

我的代码如下

xhtml

```
<p:autoComplete id="schedChemAC" value="#{testMB.selectedPlayer}" completeMethod="#{testMB.completePlay}" process="@this" var="m" itemLabel="#{m.player}" itemValue="#{m}" converter="#{testConverter}">
     <p:ajax event="itemSelect" listener="#{testMB.onSelectFrstL}" process="@this"/>
</p:autoComplete> 
```

MBean

```
public List<Player> getSelectedPlayer() {
    return selectedPlayer;
}

public void setSelectedPlayer(List<Player> selectedPlayer) {
    this.selectedPlayer = selectedPlayer;
}

public void getName() {
    playerName = playerSession.getAll();
}

public List<Player> completePlay(String query) {
    List<Player> suggestion = new ArrayList<Player>();
    if (playerName == null) {
        getName();
    }
    for (Player c : playerName) {
        if (c.getPlayer().toUpperCase().contains(query.toUpperCase())) {
            suggestion.add(c);
        }
    }
    return suggestion;
}

public void onSelectFrstL(SelectEvent event) {

} 
```

转换器

```
@Named(value = "testConverter")
public class TestConverter implements Converter {

@EJB
PlayerSession playSession;
public static List<Player> playLst;

@Override
public Object getAsObject(FacesContext context, UIComponent component, String value) {

    if (playLst == null) {
        playLst = playSession.getAll();
    }
    if (value.trim().equals("")) {
        return null;
    } else {
        try {
            int number = Integer.parseInt(value);

            for (Player c : playLst) {
                if (c.getPk() == number) {
                    return c;
                }
            }

        } catch (Exception ex) {
            System.out.println("error");
        }

    }
    return null;
}

@Override
public String getAsString(FacesContext context, UIComponent component, Object value) {

    if (value == null || value.equals("")) {
        return "";
    } else {
        return String.valueOf(((Player) value).getPk());
    }
} 
```

}

我无法在上面的代码中找到问题所在，如果我删除了 var、itemValue、itemLabel、converter 部分，那么它工作正常但是一旦我输入 var、itemValue、itemLabel、converter 代码（如主要展示中给出的）我收到上述错误。请指导我我做错了什么或我应该检查什么。

注意：我的示例表只有两列，pk(int) & player(string)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:44:02.803

我发现了问题，基本上如果我将列表传递给值（自动完成），那么 Multiple="true" 已被使用。而只做一个选择，我只需要将 Player 对象传递给值（自动完成）。希望这可以帮助那些在不了解它是如何工作的情况下发帖的人（比如我）。

# reporting-services - 如何在 SSRS 2008 中以 HH:MM:SS 格式显示超过 24 小时

> ID：13534686
> 
> 赞同：1
> 
> 时间：2012-11-23T19:13:30.790
> 
> 标签：reporting-services, ssrs-2008

我在 SSRS 2008 中有一份报告，它从一个表中提取数据，其中有一列 TotalTime 是以秒为单位的整数值。

显示是我在表达式中使用它的时间：

```
=Format(DateAdd("s", Fields!TotalTime.Value, "00:00:00"), "HH:mm:ss") 
```

（从这里得到：[在 SSRS 2008 中以 HH:MM:SS 格式显示秒数](https://stackoverflow.com/questions/13481890/display-seconds-count-in-hhmmss-format-in-ssrs-2008)）

现在，当该值超过 24 小时时，它确实是一种“模块”值。我的意思是：如果该值为 29 小时，而不是显示 29:00:00，它将显示 05:00:00。如果该值是 51 小时，它将显示 03:00:00（取出 48 小时）。

我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T09:38:17.577

一天有 86,400 秒。因此，如果秒数大于此值，只需使用天数：

```
=IIF(Fields!TotalTime.Value < 86400, 
    Format(DateAdd("s", Fields!TotalTime.Value, "00:00:00"), "HH:mm:ss"), 
    Floor(Fields!TotalTime.Value / 86400) & " days, " & Format(DateAdd("s", Fields!TotalTime.Value, "00:00:00"), "HH:mm:ss") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T16:59:39.157

对于 HH:mm:ss 格式，您可以使用：

```
=Floor(Fields!TotalTime.Value / 3600) &":"& Format(DateAdd("s", Fields!TotalTime.Value, "00:00"), "mm:ss") 
```

**在这种情况下，例如90000sec**将显示为： 25:00:00

 **对于 DD:HH:mm:ss 格式，请使用：

```
Floor(Fields!TotalTime.Value / 86400) &":"& Format(DateAdd("s", Fields!TotalTime.Value, "00:00:00"), "HH:mm:ss") 
```

90000sec 将显示为：**1:01:00:00**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-18T17:32:51.833

您确实需要使用基于小时的解决方案，基于天的解决方案可能会给您带来夏令时转换的麻烦。

```
=Floor(Fields!TotalTime.Value / 3600) &":"& Format(DateAdd("s", Fields!TotalTime.Value, "00:00"), "mm:ss") 
```**

# c# - WPF相当于SendInput？

> ID：13534693
> 
> 赞同：1
> 
> 时间：2012-11-23T19:14:17.010
> 
> 标签：c#, .net, wpf, keyboard, automation

WPF 是否有与 SendInput 等效的方法？我研究过`AutomationPeer`课程，但没有成功。

我只是想发送一个 Keydown（回车键）。在我的场景中，简单地引发事件 ( `RaiseEvent`) 是行不通的。

这是我所拥有的，它正在工作。我希望有一个托管代码替代方案。

```
 private void comboSelectionChanged(object sender, SelectionChangedEventArgs args)
    {
        ((ComboBox)sender).Focus();
        // send keydown
        INPUT input = new INPUT();
        input.type = INPUT_KEYBOARD;
        input.union.keyboardInput.wVk = 0x0D;
        input.union.keyboardInput.time = 0;
        SendInput(1, ref input, Marshal.SizeOf(input));
    }

    [DllImport("user32.dll", SetLastError = true)]
    private static extern int SendInput(int nInputs, ref INPUT mi, int cbSize);

    [StructLayout(LayoutKind.Sequential)]
    private struct INPUT
    {
        public int type;
        public INPUTUNION union;
    };

    [StructLayout(LayoutKind.Explicit)]
    private struct INPUTUNION
    {
        [FieldOffset(0)]
        public MOUSEINPUT mouseInput;
        [FieldOffset(0)]
        public KEYBDINPUT keyboardInput;
    };

    [StructLayout(LayoutKind.Sequential)]
    private struct MOUSEINPUT
    {
        public int dx;
        public int dy;
        public int mouseData;
        public int dwFlags;
        public int time;
        public IntPtr dwExtraInfo;
    };

    [StructLayout(LayoutKind.Sequential)]
    private struct KEYBDINPUT
    {
        public short wVk;
        public short wScan;
        public int dwFlags;
        public int time;
        public IntPtr dwExtraInfo;
    };

    private const int INPUT_MOUSE = 0;
    private const int INPUT_KEYBOARD = 1; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T21:36:53.400

您可以模拟这样的击键：

```
public void SendKey(UIElement sourceElement, Key keyToSend)
    {

        KeyEventArgs args = new KeyEventArgs(InputManager.Current.PrimaryKeyboardDevice, PresentationSource.FromVisual(sourceElement), 0, keyToSend);

        args.RoutedEvent = Keyboard.KeyDownEvent;
        InputManager.Current.ProcessInput(args);

    } 
```

然后你可以这样称呼它：

```
SendKey(myComboBox, Key.Enter); 
```

我想你可以把它放在`static class`某个地方，甚至可以利用`extension method`它。但是，我认为在大多数情况下，有一种更优雅的方式来实现这一点。

我希望这有帮助。

# cuda - 关于字长的银行冲突

> ID：13534695
> 
> 赞同：2
> 
> 时间：2012-11-23T19:14:25.377
> 
> 标签：cuda

我读了几篇关于共享内存的好文章；但我有关于银行冲突的初步问题据说如果线程 1 和线程 2 从银行 0 访问字 0，则没有银行冲突，但如果他们访问不同的字，则会出现银行冲突；但我的问题是，不同的词如何可以存在于一个银行中？由于 bank 0 大小为 32 位，字大小为 32 位；最多可以有 1 个字/库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-23T19:27:21.023

使用计算能力为 2.* 或 3.* 的 GPU，有 32 个共享内存库；但是您在共享内存中可能有超过 32 个字 (= 128B) 的数据。每个银行`b`负责地址中的所有数据（例如）`A % nbanks == b`：

```
 +--------+---------+---------+-
Bank 0  | word 0 | word 32 | word 64 |...
        +--------+---------+---------+-
Bank 1  | word 1 | word 33 | word 65 |...
        +--------+---------+---------+-
Bank 2  | word 2 | word 34 | word 66 |...
        +--------+---------+---------+-
 ...    |  ..... |         |         |
        +--------+---------+---------+-
Bank 30 | word 30| word 62 | word 94 |...
        +--------+---------+---------+-
Bank 31 | word 31| word 63 | word 95 |...
        +--------+---------+---------+- 
```

如果每个人都在访问单词 0，那么就有“广播”功能；但是如果线程 0 正在访问字 0，线程 1 正在访问字 32，等等，那么这些访问将被序列化。

# path - Iexpress - 提取路径

> ID：13534699
> 
> 赞同：1
> 
> 时间：2012-11-23T19:14:52.133
> 
> 标签：path, archive, extraction, iexpress

我将创建一个自解压存档，但在连接默认解压路径时遇到问题。我想将我的文件提取到与自解压存档程序相同的路径中。不幸的是，这些文件正在另一个路径中提取（C:\Users\computer\AppData\Temp\IXP000.TMP）。可以设置路径吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T10:01:39.747

我找不到使用 IExpress 的任何*直接*方法，但我们可以应用一个技巧。

但首先我要指出的是，使用[7-Zip](http://www.7-zip.org)模块之类的东西真的很容易`7zCon.sfx`（如果您需要做的只是将存档解压缩到当前目录，则无需询问）。因此，您可能只想尝试 IExpress 以外的其他方法。

无论如何，IExpress 的问题在于，在我们的*安装程序*运行时，我们不再位于原始存档的目录中；当前目录现在类似于`%temp%\IXP000.TMP`. 所以我们需要找到父进程的目录——有点痛苦。一旦知道了，我们就可以`xcopy`将存档的内容转移到目标文件夹。

在 VBScript 中，它看起来像这样：

```
Option Explicit

Dim objShell, objWMI
Dim objCmd, intMyPid, intMyParentPid, objMyParent

Set objShell = CreateObject("WScript.Shell")
Set objWMI = GetObject("winmgmts:root\cimv2")

Set objCmd = objShell.Exec("cmd.exe")
intMyPid = objWMI.Get("Win32_Process.Handle='" & objCmd.ProcessID & "'").ParentProcessId
objCmd.Terminate

intMyParentPid = objWMI.Get("Win32_Process.Handle='" & intMyPid & "'").ParentProcessId
Set objMyParent = objWMI.Get("Win32_Process.Handle='" & intMyParentPid & "'")

objShell.Run "xcopy /y * " & """" & Left(objMyParent.ExecutablePath, _
    InStrRev(objMyParent.ExecutablePath, ".exe", -1, vbTextCompare) -1) &_
    "\""", 0, True 
```

您的*安装程序*将是，例如：`wscript extractToOriginalLocation.vbs //B`.

（受到[这个问题](https://stackoverflow.com/questions/8296037/find-my-own-process-id-in-vbscript)的答案的启发。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-18T23:38:14.120

您始终可以使用 cmd 脚本并将代码行回显到特定目录中的文件中

# jquery-ui - 在哪里可以找到 plone 中 jqueryui 的工作示例

> ID：13534707
> 
> 赞同：1
> 
> 时间：2012-11-23T19:15:43.770
> 
> 标签：jquery-ui, plone

我在哪里可以找到 plone 中 jqueryui 的工作示例。以一个作为起点会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:16:39.497

好吧，它已经存在了，至少在collective.js.jqueryui 的1.8.16.9 版本（并且可能更大）中。

如果您的站点包含collective.js.jqueryui，您可以执行以下操作：

转到：Zope 管理界面 >> portal_properties >> jqueryui_properties

单击example_activated 复选框将其设置为True，单击保存，确认复选框仍处于选中状态。

转到您站点上的任何 URL 并附加“/example.jqueryui”。这将向您展示 jqueryui 手风琴、按钮、阴影、对话框等...（您的实际 URL 可能类似于：“http://localhost:8080/My_Plone_Site/example.jqueryui”）

如果您有collective.js.jquery-1.8.16.9-py2.7.egg，您将看到工作示例代码。你会在 egg 的collective/js/jqueryui/example.py 和example.pt 文件中找到它。

如果您有煎蛋卷，请转到 parts/omelette/collective/js/jqueryui/example.pt 以获取页面模板。注意这一行：

这一行包括从文件parts/omelette/collective/js/jqueryui/example.py 中的函数javacript 返回的字符串，它开始于：

```
def javascript(self):
    return """jQuery(function(){
// Accordion
jq("#accordion").accordion({ header: "h3" });
// Autocomplete
jq("#autocomplete").autocomplete({
    source: ["c++", "java", "php", "coldfusion", "javascript", "asp", "ruby", "python", "c", "scala", "groovy", "haskell", "perl"]
});
// Button
jq("#button").button();
jq("#radioset").buttonset();
// Tabs
jq('#tabs').tabs();
etc...""" 
```

# php - Magento 链接不起作用

> ID：13534712
> 
> 赞同：0
> 
> 时间：2012-11-23T19:16:18.437
> 
> 标签：php, .htaccess, zend-framework, magento

我在一个文件夹上安装了一个 magento 主题：http: [//mysite.com/mag/](http://mysite.com/mag/)

在主文件夹 mysite.com 上，它在 Zen Cart 上运行一个网站，所以我创建了一个名为“mag”的文件夹，我在其中安装了 magento。它一直工作到现在.. 当我访问 mysite.com/mag/ 时，只有第一页正在加载，但是当我点击一个不同的页面时，我从：mysite.com 发送到索引页面（并且显示的 url 是：[http： //mysite.com/mag/page-like-this.html](http://mysite.com/mag/page-like-this.html) )

那么问题出在哪里？以前可以用，现在不能用了。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:27:29.393

因此，正如我们通过评论发现的那样，您很可能以某种方式被黑客入侵。清理网站需要执行很多步骤，而且我们不可能在不知道您遭受哪种攻击的情况下告诉您要查找的内容。

但是，您可以安全地删除所有这些 .html 文件，因为它们不应该是 magento/zend 框架的一部分。还要寻找会被加密的奇怪 javascript。一个很长的最小化 javascript 字符串可能位于所有 html 文件的末尾，也可能是您的主 index.php 文件。

网上有很多资源可以帮助你，我建议谷歌搜索“magento hacked”或类似的东西。

祝你好运！

这是关于 magento 上的一些此类 hack的 stackoverflow[问题。](https://stackoverflow.com/questions/6334303/php-web-application-magento-hacked-what-does-this-hacker-code-do)

# eclipse - 在maven上添加jsr80

> ID：13534720
> 
> 赞同：1
> 
> 时间：2012-11-23T19:17:13.693
> 
> 标签：eclipse, maven

我正在尝试在 linux（Lubuntu）上的 eclipse 上添加 jsr80 和 maven。

我的 pom.xml 是

```
<project xmlns="http://maven.apache.org/POM/4.0.0"     
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-
4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
  <groupId>Source.Web.java</groupId>
  <artifactId>EjemploMaven</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>jar</packaging>
  <name>EjemploMaven</name>
 <dependencies>
<dependency>
       <groupId>jsr80</groupId>
        <artifactId>jsr80</artifactId>
        <version>1.0</version>
        <scope>system</scope>
        <systemPath>${basedir}/lib/jsr80.jar</systemPath>
    </dependency>
   <dependency>
     <groupId>jsr80_ri</groupId>
     <artifactId>jsr80_ri</artifactId>
     <version>1.0</version>
     <scope>system</scope>
     <systemPath>${basedir}/lib/jsr80_ri.jar</systemPath>
   </dependency>
   <dependency>
      <groupId>jsr80_environment</groupId>
      <artifactId>jsr80_environment</artifactId>
      <version>1.0.1</version>
      <scope>system</scope>
      <systemPath>${basedir}/lib/${jsr80.env}</systemPath>
      </dependency>  
   <dependency>
      <groupId>log4j</groupId>
      <artifactId>log4j</artifactId>
      <version>1.2.16</version>
      <scope>compile</scope>
      </dependency>
   </dependencies> 
```

我试过 mvn clean, mvn update dependeces ... Log4j 很好

错误信息是

```
Missing artifact jsr80:jsr80:jar:1.0:system
Missing artifact jsr80_ri:jsr80_ri:jar:1.0:system
Missing artifact jsr80_environment:jsr80_environment:jar:1.0.1:system 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:22:46.663

该问题可能是由`systemPath`标签内的不同插值规则引起的。

无论如何，最好先将您的工件作为正常依赖项安装到存储库：

*   本地：使用[`mvn install:install-file`](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)
*   远程：使用[`mvn deploy:deploy-file`](http://maven.apache.org/plugins/maven-deploy-plugin/examples/disabling-timestamps-suffix.html)（这需要在 settings.xml 中进行更多配置）

然后将您的依赖项更改为默认（编译）范围：

```
<dependencies>
  <dependency>
    <groupId>jsr80</groupId>
    <artifactId>jsr80</artifactId>
    <version>1.0</version>
  </dependency>
  <dependency>
    <groupId>jsr80_ri</groupId>
    <artifactId>jsr80_ri</artifactId>
    <version>1.0</version>
  </dependency>
  <dependency>
    <groupId>jsr80_environment</groupId>
    <artifactId>jsr80_environment</artifactId>
    <version>1.0.1</version>
  </dependency>
  ...
</dependencies> 
```

这种方法的效果是您需要使用存储库与他人共享它。另一方面，它允许您避免使用由于多种原因而有害的代码提交二进制文件。

# c++ - 如何使用 SimpleBlobDetector 获取 blob 的额外信息？

> ID：13534723
> 
> 赞同：2
> 
> 时间：2012-11-23T19:17:19.340
> 
> 标签：c++, opencv, blobs

@robot_sherrick 回答了我[这个问题](https://stackoverflow.com/a/13534094/1705967)，这是他回答的后续问题。

`cv::SimpleBlobDetector`在 Opencv 2.4 中看起来非常令人兴奋，但我不确定我是否可以让它用于更详细的数据提取。

我有以下顾虑：

*   如果这只返回 blob 的中心，我不能有一个完整的标记 Mat，可以吗？
*   如何访问检测到的斑点的特征，如面积、凸度、颜色等？
*   我可以用这个显示精确的分割吗？（比如说，瀑布）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-23T19:42:03.797

所以代码应该是这样的：

```
cv::Mat inputImg = imread(image_file_name, CV_LOAD_IMAGE_COLOR);   // Read a file
cv::SimpleBlobDetector::Params params; 
params.minDistBetweenBlobs = 10.0;  // minimum 10 pixels between blobs
params.filterByArea = true;         // filter my blobs by area of blob
params.minArea = 20.0;              // min 20 pixels squared
params.maxArea = 500.0;             // max 500 pixels squared
SimpleBlobDetector myBlobDetector(params);
std::vector<cv::KeyPoint> myBlobs;
myBlobDetector.detect(inputImg, myBlobs); 
```

然后，如果您想在图像上突出显示这些关键点：

```
cv::Mat blobImg;    
cv::drawKeypoints(inputImg, myBlobs, blobImg);
cv::imshow("Blobs", blobImg); 
```

要访问关键点中的信息，您只需像这样访问每个元素：

```
for(std::vector<cv::KeyPoint>::iterator blobIterator = myBlobs.begin(); blobIterator != myBlobs.end(); blobIterator++){
   std::cout << "size of blob is: " << blobIterator->size << std::endl;
   std::cout << "point is at: " << blobIterator->pt.x << " " << blobIterator->pt.y << std::endl;
} 
```

注意：本文未编译，可能有错别字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-06T05:22:04.837

这是一个版本，可让您通过 getContours() 方法取回最后的轮廓。它们将通过索引与关键点匹配。

```
class BetterBlobDetector : public cv::SimpleBlobDetector
{
public:

    BetterBlobDetector(const cv::SimpleBlobDetector::Params &parameters = cv::SimpleBlobDetector::Params());

    const std::vector < std::vector<cv::Point> > getContours();

protected:
    virtual void detectImpl( const cv::Mat& image, std::vector<cv::KeyPoint>& keypoints, const cv::Mat& mask=cv::Mat()) const;
    virtual void findBlobs(const cv::Mat &image, const cv::Mat &binaryImage,
                           std::vector<Center> &centers, std::vector < std::vector<cv::Point> >&contours) const;

}; 
```

然后cpp

```
using namespace cv;

BetterBlobDetector::BetterBlobDetector(const SimpleBlobDetector::Params &parameters)
{

}

void BetterBlobDetector::findBlobs(const cv::Mat &image, const cv::Mat &binaryImage,
                                   vector<Center> &centers, std::vector < std::vector<cv::Point> >&curContours) const
{
    (void)image;
    centers.clear();

    curContours.clear();

    std::vector < std::vector<cv::Point> >contours;
    Mat tmpBinaryImage = binaryImage.clone();
    findContours(tmpBinaryImage, contours, CV_RETR_LIST, CV_CHAIN_APPROX_NONE);

    for (size_t contourIdx = 0; contourIdx < contours.size(); contourIdx++)
    {
        Center center;
        center.confidence = 1;
        Moments moms = moments(Mat(contours[contourIdx]));
        if (params.filterByArea)
        {
            double area = moms.m00;
            if (area < params.minArea || area >= params.maxArea)
                continue;
        }

        if (params.filterByCircularity)
        {
            double area = moms.m00;
            double perimeter = arcLength(Mat(contours[contourIdx]), true);
            double ratio = 4 * CV_PI * area / (perimeter * perimeter);
            if (ratio < params.minCircularity || ratio >= params.maxCircularity)
                continue;
        }

        if (params.filterByInertia)
        {
            double denominator = sqrt(pow(2 * moms.mu11, 2) + pow(moms.mu20 - moms.mu02, 2));
            const double eps = 1e-2;
            double ratio;
            if (denominator > eps)
            {
                double cosmin = (moms.mu20 - moms.mu02) / denominator;
                double sinmin = 2 * moms.mu11 / denominator;
                double cosmax = -cosmin;
                double sinmax = -sinmin;

                double imin = 0.5 * (moms.mu20 + moms.mu02) - 0.5 * (moms.mu20 - moms.mu02) * cosmin - moms.mu11 * sinmin;
                double imax = 0.5 * (moms.mu20 + moms.mu02) - 0.5 * (moms.mu20 - moms.mu02) * cosmax - moms.mu11 * sinmax;
                ratio = imin / imax;
            }
            else
            {
                ratio = 1;
            }

            if (ratio < params.minInertiaRatio || ratio >= params.maxInertiaRatio)
                continue;

            center.confidence = ratio * ratio;
        }

        if (params.filterByConvexity)
        {
            vector < Point > hull;
            convexHull(Mat(contours[contourIdx]), hull);
            double area = contourArea(Mat(contours[contourIdx]));
            double hullArea = contourArea(Mat(hull));
            double ratio = area / hullArea;
            if (ratio < params.minConvexity || ratio >= params.maxConvexity)
                continue;
        }

        center.location = Point2d(moms.m10 / moms.m00, moms.m01 / moms.m00);

        if (params.filterByColor)
        {
            if (binaryImage.at<uchar> (cvRound(center.location.y), cvRound(center.location.x)) != params.blobColor)
                continue;
        }

        //compute blob radius
        {
            vector<double> dists;
            for (size_t pointIdx = 0; pointIdx < contours[contourIdx].size(); pointIdx++)
            {
                Point2d pt = contours[contourIdx][pointIdx];
                dists.push_back(norm(center.location - pt));
            }
            std::sort(dists.begin(), dists.end());
            center.radius = (dists[(dists.size() - 1) / 2] + dists[dists.size() / 2]) / 2.;
        }

        centers.push_back(center);
        curContours.push_back(contours[contourIdx]);    
}

static std::vector < std::vector<cv::Point> > _contours;

const std::vector < std::vector<cv::Point> > BetterBlobDetector::getContours() {
    return _contours;
}

void BetterBlobDetector::detectImpl(const cv::Mat& image, std::vector<cv::KeyPoint>& keypoints, const cv::Mat&) const
{
    //TODO: support mask
     _contours.clear();

    keypoints.clear();
    Mat grayscaleImage;
    if (image.channels() == 3)
        cvtColor(image, grayscaleImage, CV_BGR2GRAY);
    else
        grayscaleImage = image;

    vector < vector<Center> > centers;
    vector < vector<cv::Point> >contours;
    for (double thresh = params.minThreshold; thresh < params.maxThreshold; thresh += params.thresholdStep)
    {
        Mat binarizedImage;
        threshold(grayscaleImage, binarizedImage, thresh, 255, THRESH_BINARY);

        vector < Center > curCenters;
        vector < vector<cv::Point> >curContours, newContours;
        findBlobs(grayscaleImage, binarizedImage, curCenters, curContours);
        vector < vector<Center> > newCenters;
        for (size_t i = 0; i < curCenters.size(); i++)
        {

            bool isNew = true;
            for (size_t j = 0; j < centers.size(); j++)
            {
                double dist = norm(centers[j][ centers[j].size() / 2 ].location - curCenters[i].location);
                isNew = dist >= params.minDistBetweenBlobs && dist >= centers[j][ centers[j].size() / 2 ].radius && dist >= curCenters[i].radius;
                if (!isNew)
                {
                    centers[j].push_back(curCenters[i]);

                    size_t k = centers[j].size() - 1;
                    while( k > 0 && centers[j][k].radius < centers[j][k-1].radius )
                    {
                        centers[j][k] = centers[j][k-1];
                        k--;
                    }
                    centers[j][k] = curCenters[i];

                    break;
                }
            }
            if (isNew)
            {
                newCenters.push_back(vector<Center> (1, curCenters[i]));
                newContours.push_back(curContours[i]);
                //centers.push_back(vector<Center> (1, curCenters[i]));
            }
        }
        std::copy(newCenters.begin(), newCenters.end(), std::back_inserter(centers));
        std::copy(newContours.begin(), newContours.end(), std::back_inserter(contours));
    }

    for (size_t i = 0; i < centers.size(); i++)
    {
        if (centers[i].size() < params.minRepeatability)
            continue;
        Point2d sumPoint(0, 0);
        double normalizer = 0;
        for (size_t j = 0; j < centers[i].size(); j++)
        {
            sumPoint += centers[i][j].confidence * centers[i][j].location;
            normalizer += centers[i][j].confidence;
        }
        sumPoint *= (1\. / normalizer);
        KeyPoint kpt(sumPoint, (float)(centers[i][centers[i].size() / 2].radius));
        keypoints.push_back(kpt);
        _contours.push_back(contours[i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T15:38:04.480

```
//Access SimpleBlobDetector datas for video

#include "opencv2/imgproc/imgproc.hpp" // 
#include "opencv2/highgui/highgui.hpp"

    #include <iostream>
    #include <math.h>
    #include <vector>
    #include <fstream>
    #include <string>
    #include <sstream>
    #include <algorithm>

#include "opencv2/objdetect/objdetect.hpp"
#include "opencv2/features2d/features2d.hpp"

using namespace cv;
using namespace std;

int main(int argc, char *argv[])
{

    const char* fileName ="C:/Users/DAGLI/Desktop/videos/new/m3.avi";  
    VideoCapture cap(fileName); //
    if(!cap.isOpened()) //
    {
        cout << "Couldn't open Video  " << fileName << "\n"; 
        return -1; 
    }
    for(;;)  // videonun frameleri icin sonsuz dongu
    {
        Mat frame,labelImg; 
        cap >> frame; 
        if(frame.empty()) break;  
        //imshow("main",frame);  

        Mat frame_gray;
        cvtColor(frame,frame_gray,CV_RGB2GRAY);

        //////////////////////////////////////////////////////////////////////////
        // convert binary_image
        Mat binaryx;
        threshold(frame_gray,binaryx,120,255,CV_THRESH_BINARY);

        Mat src, gray, thresh, binary;
        Mat out;
        vector<KeyPoint> keyPoints;

        SimpleBlobDetector::Params params;
        params.minThreshold = 120;
        params.maxThreshold = 255;
        params.thresholdStep = 100;

        params.minArea = 20; 
        params.minConvexity = 0.3;
        params.minInertiaRatio = 0.01;

        params.maxArea = 1000;
        params.maxConvexity = 10;

        params.filterByColor = false;
        params.filterByCircularity = false;

        src = binaryx.clone();

        SimpleBlobDetector blobDetector( params );
        blobDetector.create("SimpleBlob");

        blobDetector.detect( src, keyPoints );
        drawKeypoints( src, keyPoints, out, CV_RGB(255,0,0), DrawMatchesFlags::DEFAULT);

        cv::Mat blobImg;    
        cv::drawKeypoints(frame, keyPoints, blobImg);
        cv::imshow("Blobs", blobImg);

        for(int i=0; i<keyPoints.size(); i++){
            //circle(out, keyPoints[i].pt, 20, cvScalar(255,0,0), 10);
            //cout<<keyPoints[i].response<<endl;
            //cout<<keyPoints[i].angle<<endl;
            //cout<<keyPoints[i].size()<<endl;
            cout<<keyPoints[i].pt.x<<endl;
            cout<<keyPoints[i].pt.y<<endl;

        }
        imshow( "out", out );

        if ((cvWaitKey(40)&0xff)==27) break;  // esc 'ye basilinca break
    }
    system("pause");

} 
```

# php - 需要知道如何获取返回变量的值

> ID：13534724
> 
> 赞同：1
> 
> 时间：2012-11-23T19:17:21.507
> 
> 标签：php

这是我的功能

```
 public function isValidPostCode(&$toCheck)
    {
      // Permitted letters depend upon their position in the postcode.
      $alpha1 = "[abcdefghijklmnoprstuwyz]";                          // Character 1
      $alpha2 = "[abcdefghklmnopqrstuvwxy]";                          // Character 2
      $alpha3 = "[abcdefghjkpmnrstuvwxy]";                            // Character 3
      $alpha4 = "[abehmnprvwxy]";                                     // Character 4
      $alpha5 = "[abdefghjlnpqrstuwxyz]";                             // Character 5
      $BFPOa5 = "[abdefghjlnpqrst]{1}";                               // BFPO character 5
      $BFPOa6 = "[abdefghjlnpqrstuwzyz]{1}";                          // BFPO character 6

      // Expression for BF1 type postcodes
      $pcexp[0] =  '/^(bf1)([[:space:]]{0,})([0-9]{1}' . $BFPOa5 . $BFPOa6 .')$/';

      // Expression for postcodes: AN NAA, ANN NAA, AAN NAA, and AANN NAA with a space
      $pcexp[1] = '/^('.$alpha1.'{1}'.$alpha2.'{0,1}[0-9]{1,2})([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$/';

      // Expression for postcodes: ANA NAA
      $pcexp[2] =  '/^('.$alpha1.'{1}[0-9]{1}'.$alpha3.'{1})([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$/';

      // Expression for postcodes: AANA NAA
      $pcexp[3] =  '/^('.$alpha1.'{1}'.$alpha2.'{1}[0-9]{1}'.$alpha4.')([[:space:]]{0,})([0-9]{1}'.$alpha5.'{2})$/';

      // Exception for the special postcode GIR 0AA
      $pcexp[4] =  '/^(gir)([[:space:]]{0,})(0aa)$/';

      // Standard BFPO numbers
      $pcexp[5] = '/^(bfpo)([[:space:]]{0,})([0-9]{1,4})$/';

      // c/o BFPO numbers
      $pcexp[6] = '/^(bfpo)([[:space:]]{0,})(c\/o([[:space:]]{0,})[0-9]{1,3})$/';

      // Overseas Territories
      $pcexp[7] = '/^([a-z]{4})([[:space:]]{0,})(1zz)$/';

      // Anquilla
      $pcexp[8] = '/^ai-2640$/';

      // Load up the string to check, converting into lowercase
      $postcode = strtolower($toCheck);

      // Assume we are not going to find a valid postcode
      $valid = false;

      // Check the string against the six types of postcodes
      foreach ($pcexp as $regexp) {

        if (preg_match($regexp,$postcode, $matches)) {

          // Load new postcode back into the form element
              $postcode = strtoupper ($matches[1] . ' ' . $matches [3]);

          // Take account of the special BFPO c/o format
          $postcode = preg_replace ('/C\/O([[:space:]]{0,})/', 'c/o ', $postcode);

          // Take acount of special Anquilla postcode format (a pain, but that's the way it is)
          if (preg_match($pcexp[7],strtolower($toCheck), $matches)) $postcode = 'AI-2640';

          // Remember that we have found that the code is valid and break from loop
          $valid = true;
          break;
        }
      }

      // Return with the reformatted valid postcode in uppercase if the postcode was
      // valid
      if ($valid)
      {
          $toCheck = $postcode;
            return true;
      }
        else return false;
    } 
```

注意函数参数中的 &$toCheck。现在在这一行的函数代码的末尾（见下面的代码）函数返回更新的邮政编码和真实值，以防所有条件都得到满足。

```
if ($valid)
      {
          $toCheck = $postcode;
            return true;
      } 
```

我的问题是如何在函数之外获取返回的 $toCheck 变量的值。简单来说，我需要获取函数 isValidPostCode() 返回的 $toCheck 的值。我怎么能得到那个。请让我知道，因为我是 OOP 概念的新手。

到目前为止，我将此功能用作

```
if (!isValidPostCode($postcode))
{
    header("location:mechanics_edit.php?id=$id&case=edit&type=warning&msg=" .urlencode("Invalid Post Code"));
    exit();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:21:42.970

您的函数`$toCheck` [通过引用](http://us1.php.net/manual/en/language.references.pass.php)( `&`) 接收变量。因此，您传递给它的变量的值在它被调用后已经被修改。您正在传递变量`$postcode`，因此`$postcode`在函数之后访问将包含修改后的值。

```
// $postcode is some value, passed by reference to isValidPostCode()
if (isValidPostCode($postcode))
{
    // It was valid on input, and now it contains a new value
    // since it was passed by reference and modified in the function
    // just before the function returned TRUE
    echo $postcode
    // outputs some new value...
} 
```

请注意，此变量`$postcode`与您在函数内部构造的变量不同*。*`$postcode`那个是局部作用域的函数，尽管您将函数`$postcode`的值分配给引用变量`$toCheck`（即上面的外部作用域`$postcode`），但它们仍然是不同作用域中的 2 个不同变量。

# java - 错误的服务器类路径的 Google Eclipse 插件警告

> ID：13534726
> 
> 赞同：3
> 
> 时间：2012-11-23T19:17:47.607
> 
> 标签：java, gwt, eclipse-indigo, google-eclipse-plugin

我已经安装了 Google-Eclipse 插件来创建 GWT/GAE 应用程序。我`joda-time-2.1.jar`在服务器端添加了处理日期和时间。为此，我将 JAR 添加到`lib/`项目中的目录中，然后将 JAR 添加到项目构建路径中。

一旦我这样做了，我就会在 Eclipse视图中看到一个*警告：*`Problems`

> 以下类路径条目“/home/myuser/workbench/eclipse/workspace/myapp/lib/joda-time-2.1.jar”在服务器的类路径中不可用。

我还没有走到这一步，但正计划将此 JAR 打包`WEB-INF/lib`到应用程序 WAR 内的目录下，这*应该*使其可用于服务器类路径。

我在这里配置错误了吗？如果是这样，是什么？如果没有，我该如何静音/摆脱这个警告？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:21:20.207

> 我在这里配置错误了吗？

不。

> 如果是这样，是什么？如果没有，我该如何静音/摆脱这个警告？

将 JAR 移至`WEB-INF/lib`.

# ruby - 如何重构此 Ruby 代码以检查有效参数？

> ID：13534727
> 
> 赞同：0
> 
> 时间：2012-11-23T19:18:17.157
> 
> 标签：ruby, exception, error-handling, refactoring

有没有更好（更有说服力）的方法来检查有效参数？

```
def load_data filename, start_percent, end_percent
  raise 'Values must be [0,1]' if start_percent < 0
  raise 'Values must be [0,1]' if end_percent   < 0
  raise 'Values must be [0,1]' if start_percent > 1
  raise 'Values must be [0,1]' if end_percent   > 1
  ... 
```

红宝石 1.9.3

编辑：应该是花车`start_percent`。`end_percent`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:26:02.497

是的！取决于你是只想要整数还是小数

```
# decimals
def load_data(filename, start_percent, end_percent)
  accepted = (0..1)
  unless accepted.cover? start_percent && accepted.cover? end_precent
    raise 'Values must be [0,1]'
  end
end 
```

整数：更改为`accepted = [0,1]`and`accepted.include? start_percent`和 for `end_percent`too

参考：

Range#cover：[http ://ruby-doc.org/core-1.9.3/Range.html#method-i-cover-3F](http://ruby-doc.org/core-1.9.3/Range.html#method-i-cover-3F)

Range#include?：[http ://ruby-doc.org/core-1.9.3/Range.html#method-i-include-3F](http://ruby-doc.org/core-1.9.3/Range.html#method-i-include-3F)

数组#include？：[http ://www.ruby-doc.org/core-1.9.3/Array.html#method-i-include-3F](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-include-3F)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:34:23.780

紧凑版：

```
[start_percent, end_percent].each{|p| raise 'Values must be [0,1]' unless (0..1).cover?(p) } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:41:10.497

```
def load_data filename, start_percent, end_percent
  unless (0..1).include?(start_percent) and (0..1).include?(end_percent)
    raise 'Values must be [0,1]' 
  end
  ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T22:28:48.197

当这个错误发生时，你会想知道细节（什么样的错误，什么参数，什么无效值）：

```
def load_data filename, start_percent, end_percent
  raise ArgumentError, "start_percent must be [0,1]; received #{start_percent}." unless start_percent.between?(0, 1)
  raise ArgumentError, "end_percent must be [0,1]; received #{end_percent}." unless end_percent.between?(0, 1)
end 
```

# vb.net - 计算百分比方程中两个变量的值

> ID：13534729
> 
> 赞同：0
> 
> 时间：2012-11-23T19:18:21.943
> 
> 标签：vb.net

我正在尝试以编程方式在方程式**146 + x + y 除以 7 = 28.13%** x 中找到 x 和 y 的值，并且 y 包含 19 到 43 之间的任何值。这是我得到的 x 和 y 均为 25 的代码，什么我做错了吗？

```
Public Class Form1
    Dim percentage, x, y, f As Integer
    Public Function GetRandom(ByVal Min As Integer, ByVal Max As Integer) As Integer
        Dim Generator As System.Random = New System.Random()
        Return Generator.Next(Min, Max)
    End Function
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        percentage = 28.13

        Do Until f = 4
            If (146 + x + y) / 7 = percentage Then
                MessageBox.Show(x)
                MessageBox.Show(y)
                f = 4
            End If
            x = GetRandom(19, 43)
            y = GetRandom(19, 43)

        Loop

    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        x = 19
        y = 19
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T22:32:32.797

您正在寻找 (x+y)=50.91，其中 x 在 [19, 43] 中，y 在 [19, 43] 中。

因此，选择一个x，然后y=50.91-x

您显示的方程式没有单一的解决方案。

或者你实际上是在要求别的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T20:17:21.873

1) 您声明`percentage`为整数，但试图将其设置为 28.13，这不是整数。

2）不要一直重新创建一个新的随机对象：

```
Public Class Form1
  Private Generator As New Random()

  Public Function GetRandom(ByVal Min As Integer, ByVal Max As Integer) As Integer
    Return Generator.Next(Min, Max)
  End Function 
```

3）如果你*必须*等于 28.13，那么如果不将百分比声明为小数，然后在你的等式上使用 Math.Round(...)，那可能是行不通的，但即便如此，我认为你不会有任何x 和 y 整数将满足*精确*相等的方程。

# android - 如何让 Android 设备在没有唤醒锁定的情况下保持与 Internet 的 TCP 连接？

> ID：13534732
> 
> 赞同：17
> 
> 时间：2012-11-23T19:18:28.870
> 
> 标签：android, networking, wakelock, standby

我希望我的应用程序通过移动连接连接到服务器，但允许设备进入睡眠模式。我希望它会在 IP 包到达时唤醒。

如何才能做到这一点？如何在不耗尽电池的情况下接收来自 Internet 的“中断”？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-05-17T06:39:07.090

当您在从 tcp 流中读取时被阻止，设备可以进入深度睡眠，并且当 tcp 流量进入时，它会短暂唤醒设备，一旦读入一个位，您就会启动唤醒锁，直到您收到整个传输然后释放它。

这是一个使用网络套接字的示例，我已经在后台运行了这个应用程序超过 12 个小时，没有对电池造成影响。 [https://github.com/schwiz/android-websocket-example](https://github.com/schwiz/android-websocket-example)

客户端在这里，阻塞读取在start方法中。 [https://github.com/schwiz/android-websockets/blob/master/src/com/codebutler/android_websockets/HybiParser.java](https://github.com/schwiz/android-websockets/blob/master/src/com/codebutler/android_websockets/HybiParser.java)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-26T12:43:28.857

几年来，我一直在没有唤醒锁的情况下在 Android 上使用长期有效的 TCP 连接。

我的经验是，当数据通过 TCP 连接到达并且设备处于深度睡眠时，它至少会被唤醒一小段时间。唤醒设备有时可能需要大约 2 分钟，但通常会在几秒钟内完成。

现在设备已唤醒，接收进程也有一些时间来处理数据。现在，要么进程能够在设备重新进入深度睡眠之前这样做，要么设备将进入深度睡眠，同时暂停进程。这里重要的是数据不会丢失，它保留在内存中，并且该进程能够在设备下次离开深度睡眠时恢复处理数据的工作。当然，这意味着如果发送者等待对他的数据的答复，可能需要一些时间，直到他得到它。

一旦您的网络库通知您收到了新消息，您*就可以使用唤醒锁定。*但是如果你完成了，**那么请确保正确处理锁，即确保它在某个时间点和每个代码路径中被释放**。我个人从来没有经历过唤醒锁的需要，Android 设备总是足够长的时间来处理请求。但你的米数可能会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-06T14:30:24.407

所以这已经很老了，但我最终测试了@Flow 描述的行为，只是想确认在数据到达和设备唤醒之间有时会出现任意延迟。
我使用 tcpClient 实现和 mqtimplementation 进行了测试。这个想法是看看是否需要立即获得唤醒锁，因为这个延迟出现在我的 mqtt 实现中。
测试步骤：

*   我们有 2 个服务，一个运行 tcpclient，一个在不同的应用程序中运行 mqttclient
*   两种服务在同一部手机上运行，​​后台具有相同的权限。
*   服务器在这两种情况下都发送一个“ping”消息。
*   我们的客户端实现尽快获取唤醒锁并读取当前日期。
    *   对于 tcpclient，这是即时的
    *   对于 mqttclient，wakelock 只能在到达的数据通过网络库传播后才能获取
*   我们发回回复 pong 消息，包括阅读日期
    *   此发送发生在唤醒锁释放之后，以查看这是否进一步延迟了响应时间
*   服务器使用到达和读取日期记录传入消息

似乎在这两种实现中，有时对我们的代码的调用都会出现任意延迟。这使得最有可能的是设备的唤醒有延迟，而不是唤醒锁的获取。

*   这种延迟有时可以在所有设备上看到（在 huaweip20light、HMD Global#Nokia 7.2、samsung#SM-N960F 上测试）
*   这种延迟更可能发生在 HMD 设备更高的 api 上，并且是 android 建立的更严格的电池优化的受害者

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-23T19:37:28.800

Google Cloud Messaging 可能是您正在寻找的：

[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

# php - 如何在我的 php 上启用 XDebug 扩展？

> ID：13534733
> 
> 赞同：14
> 
> 时间：2012-11-23T19:18:42.240
> 
> 标签：php

我在运行山狮的 macbook pro 上运行 php。Mountain lion 预装了 XDebug，所以根据我找到的教程，我做了三个步骤。首先，我在 php.ini 中取消了对这一行的注释：

```
zend_extension="/usr/lib/php/extensions/no-debug-non-zts-20090626/xdebug.so" 
```

其次，我在 php.ini 中取消了对这一行的注释：

```
xdebug.remote_enable=1 
```

最后我重新启动了 apache 服务器：

```
sudo apachectl restart 
```

问题是当我运行 phpinfo() 时，我的 php 详细信息中没有出现 xdebug。谢谢你。

PS：上述xdebug.so文件的路径是正确的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-24T17:16:37.527

我正在回答我自己的问题，因为 Mountain Lion 在运行 XDebug 时是一个特例。

[正如您在这里看到的，](https://github.com/liip/php-osx/issues/41) 山狮带有一个较旧的`xdebug.so`图书馆。所以用户必须自己重新编译库。

这是如何做到的。

1.  [点击这里下载最新版本。](http://www.xdebug.org/download.php)（我们在链接下获得文件 `source`。）
2.  解压下载的文件`tar -xvzf xdebug-2.2.1.tgz`
3.  跑`cd xdebug-2.2.1`
4.  跑`phpize`
5.  跑`./configure`
6.  跑`make`
7.  跑`sudo cp modules/xdebug.so /usr/lib/php/extensions/no-debug-non-zts-20090626`
8.  重启网络服务器`sudo apachectl restart`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T19:59:52.527

检查您正在编辑显示在浏览器中的 phpinfo() 中的相同 php.ini。

这是我的设置（顺便说一句，我也在 Mountain Lion 上的 Macbook Pro 上）：

```
xdebug.var_display_max_children = 999
xdebug.var_display_max_data = 99999
xdebug.var_display_max_depth = 100

;zend_extension_ts=php_xdebug.dll
xdebug.remote_enable=On
xdebug.remote_host=localhost
xdebug.remote_port=9000
xdebug.remote_handler=dbgp 
```

为我工作。这些有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T04:11:36.517

[这套说明对我有用。](http://dokimay.com/index.php/mac-osx/56-configuring-xdebug-on-osx-mountain-lion)

它成功地使用了`OSX Mountain Lion's`原生`Apache2`并`XDebug`与`MacGDBp`Safari 扩展名为`XDebug Helper`.

# asp.net-mvc - ASP.NET MVC 4 Facebook 模板应用程序没有通过权限阶段

> ID：13534740
> 
> 赞同：0
> 
> 时间：2012-11-23T19:19:40.663
> 
> 标签：asp.net-mvc, facebook, templates, visual-studio-2012

我已经下载并安装了 VS2012 秋季更新，它为 ASP.NET MVC4 应用程序引入了新的 Facebook 应用程序模板。

我创建了一个 facebook 应用程序，并在 MVC 应用程序的 web.config 中复制了 App ID、App Secret 和 App Namespace。然后我在调试模式下运行应用程序，将生成的 URL ( `http://localhost:41999`) 复制到 facebook 应用程序的画布 URL 中，打开沙盒模式并点击保存。

问题是在运行 MVC 应用程序时，我无法通过 Facebook 权限授权请求。

有没有人遇到过这个问题？请帮忙。

谢谢你，拉杜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T00:29:44.227

好的，所以在对各种设置坐立不安之后，我想通了。问题是我已将 facebook 中的安全画布 url 填写到一个不存在的 url。所以我把它留空，然后允许 IE 在出现提示时显示非安全内容并且它工作。

# asp.net - 会话变量可访问性

> ID：13534741
> 
> 赞同：2
> 
> 时间：2012-11-23T19:20:04.500
> 
> 标签：asp.net, session

我有一个类，它通过以下方式创建一个会话：

```
Session["UserId"] = UserId; // UserId = 1 
```

在 Page_Load 的其中一个页面中，我以这种方式检索会话变量值，效果很好：

```
if (Session["UserId"] != null){

    var userid = Session["UserId"];
    Welcome.Text = "Hello, " + userid;

} 
```

现在我还需要在我的类中使用会话变量的值。我使用以下方法获取会话值，但它始终返回 null 而会话在我的代码隐藏文件中`int useridsession = Convert.ToInt32(HttpContext.Current.Session["UserId"]);`正确读取。`Session["UserId"];`

提到的类：

```
public static DataTable ManageBookingsDataTable()
{

    int useridsession = Convert.ToInt32(HttpContext.Current.Session["UserId"]);
    SqlConnection con = new SqlConnection(Database.ConnectionString);
    con.Open();
    SqlCommand cmd = new SqlCommand("select bookings.id,user_id, start_date, end_date, pets.name AS 'Pet name' from bookings AS bookings left join users AS usr ON bookings.user_id=usr.id AND bookings.user_id=1 left join pets AS pets ON pets.id=bookings.pet_id WHERE bookings.user_id=@userid_session", con);
    cmd.Parameters.AddWithValue("@userid_session", useridsession);

    SqlDataAdapter sqlDa = new SqlDataAdapter(cmd);
    DataTable dt = new DataTable();
    string id = string.Empty;
    string name = string.Empty;
    string startdate = string.Empty;
    string enddate = string.Empty;
    string full_string = string.Empty;

    sqlDa.Fill(dt);
    if (dt.Rows.Count > 0)
    {
        for (int i = 0; i < dt.Rows.Count; i++)
        {
            id = dt.Rows[i]["id"].ToString();
            var sdate = dt.Rows[i]["start_date"];
            name = dt.Rows[i]["Pet name"].ToString();
            startdate = dt.Rows[i]["start_date"].ToString();
            enddate = dt.Rows[i]["end_date"].ToString();
            full_string = startdate + " to " + enddate + " (" + name + ")";
            //CurrentBookings.Items.Add(new ListItem(full_string, id));
        }
    }
    return dt;
} 
```

我通过添加来诊断问题`HttpContext.Current.Session["UserId"] = 1;`，证明当我在同一个类中设置会话时，该方法有效。

我的问题是如何从任何类访问先前创建的会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:39:58.300

无论课程如何，会话都应该可用于会话。为什么不使用同一个类设置和获取会话值？您所有的会议内容都集中在一个地方，因此也更加整洁。

```
Local.MySession.UserId = UserId;  //Set here
int myUserId = Local.MySession.UserId; //Get here

//Something like this??
namespace Local
{
   //You can add all session variables to this class
   public class MySession
   {
      public static int UserId
      {
         get
         {
            return Convert.ToInt32(HttpContext.Current.Session["userId"] ?? "0");
         }
         set { HttpContext.Current.Session["userId"] = value.ToString(); }
      }

      public static string UserEmail //For Example another session variable
      {
         get { return HttpContext.Current.Session["email"] ?? ""; }
         set { HttpContext.Current.Session["email"] = value; }
      }
   }
} 
```

# cocos2d-iphone - cocos2d-html5 无法使基本的 ccmenu 工作

> ID：13534746
> 
> 赞同：2
> 
> 时间：2012-11-23T19:21:06.267
> 
> 标签：cocos2d-iphone, cocos2d-x

抱歉，如果这是一个新手问题，但我刚刚开始使用 cocos2d-html，并且在创建带有图像的 ccmenu 时遇到了一些问题。这是我的代码：

```
var ActionLayer = cc.Layer.extend({
getTexture: function (name) {
return cc.TextureCache.getInstance()
.addImage('./images/' + name + '.png');
},
addObject: function (desc) {
var sprite = cc.Sprite.createWithTexture(this.getTexture(desc.name));

sprite.setAnchorPoint(desc.anchor || cc.p(0.5, 0.5));
        sprite.setScaleX(desc.scaleX || desc.scale || 1);
        sprite.setScaleY(desc.scaleY || desc.scale || 1);
        sprite.setRotation(desc.rotation || 0);
        sprite.setPosition(cc.p(desc.x || 0, desc.y || 0));
this.addChild(sprite, desc.z || 0);
        return sprite;
    },
    checkAnswer:function(){
        alert('yay');
    },
    init: function () {
        this._super();
        this.removeAllChildrenWithCleanup(true);
        this.setTouchEnabled(true);
var layer1 = cc.LayerColor.create(
            new cc.Color4B(00, 185, 214, 255), 1024, 768);
layer1.setPosition(new cc.Point(0.0,0.0));
        this.addChild(layer1,-2);
var director = cc.Director.getInstance(),
            self = this,
            winSize = director.getWinSize();
var bgSprite = this.addObject({
            name: "GenericBG",
            scaleY: 1,
            anchor: cc.p(0, 0),
            z: 0
});
var closeItem = cc.MenuItemImage.create('./images/sign.png','./images/sign.png',this,'checkAnswer');
closeItem.setAnchorPoint(cc.p(0.5, 0.5));
        var menu = cc.Menu.create(closeItem);
menu.setPosition(500,300);
        this.addChild(menu, 5);
    }
}); //end ActionLayer

//--------------------- Scene ---------------------

var ActionLayerScene = cc.Scene.extend({
onEnter: function () {
this._super();

var layer = new ActionLayer();
        layer.init();
this.addChild(layer);
    }
}); 
```

菜单显示在屏幕上，但是当我单击 menuitem 时，什么也没有发生 控制台上没有 javascript 错误，所以我真的不知道如何调试它。谢谢西里尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T17:58:04.133

您的 cc.MenuItemImage.create() 参数错误。代替：

```
var closeItem = cc.MenuItemImage.create('./images/sign.png','./images/sign.png',this,'checkAnswer'); 
```

它应该是：

```
var closeItem = cc.MenuItemImage.create('./images/sign.png','./images/sign.png','checkAnswer', this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T11:45:55.423

```
for(var i=0; i<5; i++){
    var colorImg = cc.MenuItemImage.create(color_list[i], color_list[i], "colorAction", this);
    colorImg.setPosition(new cc.Point(40+i*70, 38));
    colorImg.tag = i+100; 
    this.colorImageArray.push(colorImg);
    colorMenu.addChild(colorImg);
}

colorAction:function(event)
{
    var colorTag = event.tag;
    switch(colorTag)
    {
        case 1:

                break;
        case 2:

                break;
        case 3:
                break;
    }
} 
```

# c# - Windows Phone 8 是否支持第 3 方 C# 库？

> ID：13534748
> 
> 赞同：0
> 
> 时间：2012-11-23T19:21:12.773
> 
> 标签：c#, windows-phone-8

我正在台式电脑上编写一个信号处理程序（涉及 FFT 和一些过滤），我正在使用 Math.NET Neodym 库，我希望这个代码可以移植到 windows phone 8，所以我想确定一下是否可以在 Windows Phone 8 中使用 3rd 方库。我已经看到有关 windows phone 7.1 的类似问题，但我找不到任何关于 WP8 的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:28:27.523

WP8 可以支持为平台编写的第三方库。这确实是您必须在每个库的基础上查看的内容。由于 Math.NET Neodym 库是开源的，即使它不能编译为在 WP8 上工作，您也可以将其修改为

# c++ - 如果要切换，我该如何转换？

> ID：13534750
> 
> 赞同：2
> 
> 时间：2012-11-23T19:21:20.927
> 
> 标签：c++, refactoring

有没有办法将 C++ 转换`if`为`switch`es？嵌套或非嵌套`if`s：

```
 if ( a == 1 ) { b = 1; } /*else*/
 if ( a == 2 ) { b = 7; } /*else*/
 if ( a == 3 ) { b = 3; } 
```

当然，它应该检测转换是否有效。

这不是微优化，而是为了清楚起见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:52:53.867

通常，您应该能够使用可以处理 C++的[程序转换工具来做到这一点。](http://en.wikipedia.org/wiki/Program_transformation)

具体来说，我们的 DMS Software Reengineering Toolkit 可以使用源到源重写来做到这一点。我认为这些接近完成这项工作：

```
 default domain Cpp;
  rule fold_if_to_switch_initial(s: stmt_sequence, e: expression,
                                 k1: integer_literal, k2: integer_literal,
                                 a1: block, a2: block):
                       stmt_sequence->stmt_sequence
        = "\s
           if (\e==\k1) \a1 
           if (\e==\k2) \a2 "
        -> "\s
            switch (\e) {
                case \k1: \a1
                     break;
                case \k2: \a2
                     break;
            }" if no_side_effects(e) /\ no_impact_on(a1,e);

   rule fold_if_to_switch_expand(s: stmt_sequence, e: expression, c: casebody,
                                 k: integer_literal, a:action)
                       stmt_sequence->stmt_sequence
        = "\s
           switch (\e) { \c } 
           if (\e==\k) \a "
        -> "\s
            switch (\e) {
                \c
                case \k: \a
                     break;
            }" if no_side_effects(e) /\ no_impact_on(c,e); 
```

必须处理 if 控制语句而不是块的情况，通过以下方式轻松完成：

```
 rule blockize_if_statements:(e: expression, s: statement):
            statement->statement
      =  "if (\e) \s" ->  "if (\e) { \s } "; 
```

DMS 通过使用完整的语言解析器（是的，它确实具有带有预处理器的完整 C++ 解析器选项）来处理源代码和重写规则。它不会被空格或注释所迷惑，因为它是在解析树上运行的。"..." 中的文本是 C++ 文本（这就是“默认域 Cpp”声明所说的），带有模式变量 \x; “...”之外的文本是 DMS 的规则元语法，而不是 C++。模式匹配树并将模式变量绑定到子树；规则右侧是实例化的使用模式变量绑定。应用转换后，它会从修改后的树中重新生成（修改后的）源代码。

OP 坚持说，“它当然应该检测转换是否有效。”。这是规则末尾的条件点，例如，'if no_side_effect ... no_impact'，旨在检查评估表达式不会改变某些东西，并且动作不会影响值的表达。

实现这些语义检查很困难，因为必须考虑到 C++ 极其复杂的语义。执行此操作的工具必须至少与编译器一样了解（例如，名称、类型、声明的属性、读取和写入），然后必须能够推断后果。DMS 目前只能实现其中的一些（我们现在正在为 C++11 进行完全控制和数据流分析）。由于语义复杂，我也不期望其他重构工具能很好地完成这部分工作。我认为这种情况不太可能会改善，因为需要努力推理 C++。

在 OP 的情况下（这在使用 DMS 之类的工具时经常发生），可以断言实际上这些语义谓词不会被违反（然后你可以用“true”替换它们，从而避免实现它们）或者你只关心特殊情况（例如，操作是对表达式中除 on 以外的变量的赋值），此时检查变得更加简单，或者您可以通过缩小可接受的语法来模拟检查：

```
rule fold_if_to_switch_expand(s: stmt_sequence, v: identifier, c: casebody,
                                 k: integer_literal, v2: identifier, k2: integer_literal)
                       stmt_sequence->stmt_sequence
        = "\s
           switch (\v) { \c } 
           if (\v==\k) \v2=\k2; "
        -> "\s
            switch (\v) {
                \c
                case \k: \v2=\k2;
                     break;
            }" if no_side_effects(c); 
```

说了这么多，如果 OP 只有几百个需要改进的已知地方，他可能会硬着头皮使用他的编辑器来更快地完成它。如果他不知道位置，和/或有更多实例，DMS 会更快地完成工作，并且可能会出现更少的错误。

（我们使用 DMS 对 IBM Enterprise COBOL 进行了基本相同的重构，但没有进行深度语义检查）。

理论上，还有其他具有正确机制（模式匹配、重写）的程序转换工具可以做到这一点。据我所知，他们都没有做出任何有效的尝试来处理 C++。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:18:43.980

我会使用文本编辑器。

第 1 步：将 MARK 放在代码块之前，可能带有制表符 第 2 步：将 END 放在代码块的末尾，并带有可能的前导制表符 第 3 步：将文件加载到某种类型的 vi 中。运行这样的东西：

```
/^^T*MARK/
:.,/^^T*ENDMARK/ s/^\(^T*\)if/\1IIFF/g
:%s/IIFF *([^)]*) *{ *\([^}]*\)};? *$/TEST{\1}TSET {\2} break;/
:%s/TEST{\([^=}]*\)==\([^}]*\)}TSET/COND{\1}case \2:/g
?^^T*MARK?
/COND{/
:. s/COND{\([^}]*\)}/switch(\1) {^M^T/
:%s/COND{\([^}]*\)}/^T/g
:%s/^\(^T*\)ENDMARK/\1} \/\/switch/g
:%s/^^TMARK//g 
```

其中 ^T 是制表符，^M 是返回字符（您可能无法直接输入，具体取决于您使用的 vi/vim 版本）

代码是在我脑海中写下的，没有经过测试。但我以前做过这样的事情。此外，包含`TEST{whatever}TSET`and`COND{whatever}`和`MARK`and `ENDMARK`and`IIFF`类型结构的文件将被严重破坏。

这不会检查有效性，它只是将您格式中的内容转换为 switch 语句。

有限的有效性检查可以用一些花哨的东西（对于 vi）来确保等式表达式的左侧对于所有行都是相同的。它也不处理其他问题，但这很容易纠正。

然后，在签入之前，您可以使用一个好的比较工具对修改后的代码进行可视化扫描。

# c# - 多个域上的 Asp URL 重写

> ID：13534757
> 
> 赞同：1
> 
> 时间：2012-11-23T19:21:47.697
> 
> 标签：c#, asp.net, url, url-rewriting, http-status-code-404

我目前正在我的托管包上提供链接缩短服务。我正在使用 URL 重写来做到这一点。这种工作的一个例子在这里[-dysign.co.uk/xBbYPL](http://www.dysign.co.uk/xBbYPL)。这会将您重定向到 Google.de。我正在使用另一个域映射到我的托管包上的一个文件夹，所以我在 1 个托管计划上有 2 个站点。

**freeyoutubedownloaders.co.uk**映射到**dysign.co.uk/freeyoutubedownloaders**。链接缩短器位于**freeyoutubedownloaders 文件夹**中，因此[dysign.co.uk/freeyoutubedownloaders/xBbYPL](http://dysign.co.uk/freeyoutubedownloaders/xBbYPL)可以正常工作，但如果您访问[freeyoutubedownloaders.co.uk/xBbYPL](http://freeyoutubedownloaders.co.uk/xBbYPL)，则会收到 404 file not found 错误。

这是我的 web.config 文件中的重写规则：

```
<rewrite>
    <rules>
        <rule name="Links">
            <match url="^X.{5,5}$" />
            <action type="Rewrite" url="Link.aspx?id={R:0}" />
         </rule>
    </rules>
</rewrite> 
```

如果有人想找我，我还打开了详细的 httpErrors。

最后我在错误屏幕上注意到它说：

```
Requested URL   http://freeyoutubedownloaders.co.uk:80/freeyoutubedownloaders/xBbYPL 
```

为什么它指的是域然后是文件夹？Link.aspx页面加载良好...（要[对其](http://freeyoutubedownloaders.co.uk/Link.aspx)进行测试，请将 ?id=xBbYPL 添加到末尾，以便它重定向您。）

附言。我根本无法访问 IIS，因为它托管在 123-reg.co.uk

再次感谢！:)

错误： ![在此处输入图像描述](../Images/2554bd2b717fa0ef8ee03f5d218b580c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T12:41:50.517

我感觉域名`freeyoutubedownloaders.co.uk`已作为附加绑定添加到与`dysign.co.uk`. 并且不知何故（我不知道 123reg 通常是如何设置的）请求`freeyoutubedownloaders.co.uk/<something>`被重写为`/freeyoutubedownloaders/<something>`. 或者他们在你不知情的情况下为它设置了某种反向代理。

当我在 IIS 7.5 上通过设置一个网站`dysign.co.uk`和一个单独的网站来`freeyoutubedownloaders.co.uk`指向指向`/freeyoutubedownloaders`where 的根目录中的目录来测试`dysign.co.uk`它时，一切都按预期工作。因此，我认为您对如何使其工作的想法没有任何问题，但我认为 123reg 在将域名绑定到您的网站的方式上做了一些不寻常的事情。

# actionscript-3 - AS3 如何获取自定义类实例以访问时间轴上的变量？

> ID：13534760
> 
> 赞同：1
> 
> 时间：2012-11-23T19:21:57.007
> 
> 标签：actionscript-3, flash, class

请帮助我了解如何获取自定义类实例以访问时间轴上定义的变量。

我没有使用文档类，因为这个程序将是一个多阶段的记忆实验，所以使用时间线最适合我。（FWIW，我也没有使用 xml；只是尽量保持简单。）现在我刚刚制作了一个简单的单帧 fla，我正在尝试在其上进行词汇测试。我制作了一个名为 VocabQ 的自定义类，它又包含一个名为 VocabButton 的自定义类的 4 个实例。现在，单击其中一个按钮只会跟踪按钮标签。但我希望它也更新在时间线上声明的字符串变量 CurrentResponse 的值。如果我只是尝试从 VocabButton 类中引用 CurrentResponse，则会收到错误“1120：未定义属性的访问...”。

根据我在互联网上找到的讨论，我尝试了各种方法，但还没有成功，只会变得更加困惑。请帮忙！（如果存在简单的解决方案，将不胜感激！）请参见下面的代码。谢谢你，~杰森

时间线中的代码：

```
import VocabQ;
import flash.display.*;
stop();

var CurrentResponse:String="NA";

var VocabQuestion = new VocabQ("VocabWord",["answerA","answerB","answerC","answerD"]);
addChild(VocabQuestion); 
```

VocabQ.as 代码：

```
package
{
    import flash.display.*;
    import flash.events.*;
    import flash.net.*;
    import flash.text.*;
    import VocabButton;

    public class VocabQ extends MovieClip{
        private var _VocabWordText:String;
        private var _VocabWord:TextField;
        private var _ResponseOptions:Array;

        public function VocabQ(VocabWordText:String,ResponseOptions:Array){         
        _VocabWordText=VocabWordText;
        _ResponseOptions=ResponseOptions;
        build();
        }

        private function build():void{          
            _VocabWord = new TextField();
            _VocabWord.text=_VocabWordText;
            _VocabWord.x=25;
            _VocabWord.y=25;
            _VocabWord.textColor = 0x000000;
            addChild(_VocabWord);

            for (var i:int; i < _ResponseOptions.length; i++){
                var _VocabButton:VocabButton = new VocabButton(_ResponseOptions[i]);
                _VocabButton.x = 25 + (_VocabWord.width) + 10 + ((_VocabButton.width + 2) * i);
                _VocabButton.y = 25;
                addChild(_VocabButton);
                }
            }       
    }
} 
```

VocabButton.as 代码：

```
package 
{
    import flash.display.*;
    import flash.text.*;
    import flash.events.*;

    public class VocabButton extends MovieClip{
        private var _btnLabel:TextField;

        public function VocabButton(labl:String){

            _btnLabel = new TextField();       
            _btnLabel.textColor = 0x000000;
            _btnLabel.text = labl;
            _btnLabel.border=true;
            _btnLabel.borderColor=0x000000;
            _btnLabel.background=true;
            _btnLabel.backgroundColor= 0xDAF4F0;
            _btnLabel.mouseEnabled = false;
            _btnLabel.selectable=false;
            _btnLabel.width=100;
            _btnLabel.height=18;        
            buttonMode=true;
            useHandCursor=true;
            addEventListener(MouseEvent.CLICK,onClick,false,0,true);

            addChild(_btnLabel);
        }

        private function onClick(evt:MouseEvent):void{
        trace(_btnLabel.text);  
        //CurrentResponse=_btnLabel.text;  //causes error 1120: Access of undefined property...
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:29:20.070

这应该有效：

```
private function onClick(evt:MouseEvent):void {
    trace(_btnLabel.text);  
    evt.currentTarget.root.CurrentResponse=_btnLabel.text;
} 
```

请参阅此处的讨论：[http ://www.actionscript.org/forums/showthread.php3?t=161188](http://www.actionscript.org/forums/showthread.php3?t=161188)

就个人而言，与其尝试像这样访问时间线，我更愿意`VocabQuestion`在时间线上为您添加一个点击侦听器并允许[事件冒泡](http://blog.152.org/2009/11/flash-actionscript-3-event-bubbling.html)，或者，如果您的班级中有许多按钮，则扩展[EventDispatcher](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/EventDispatcher.html)并创建一些自定义事件，这些事件同样可以在您的时间轴上处理，但对于一个简单的测试，访问该`root`属性就足够了。

# c - 没有回声的 getchar 的汇编内联 C

> ID：13534761
> 
> 赞同：0
> 
> 时间：2012-11-23T19:22:19.997
> 
> 标签：c, assembly, inline-assembly

我正在尝试将C中的汇编内联代码与gcc一起使用，以使用带有ah = 07h的中断21来制作没有回声的getchar。这是我的代码（主要）：

```
...
int main(int argc, char *argv[])
{
    int t, x, y;
    char input;                
    asm(
        "movb $0x01, %%ah\n\t"
        "int $0x21\n\t"
        "movb %%al, %0"
        : "=r" (input) 
    );
    printf("Character: %c\n", input);
    return 0;
}
... 
```

但它不起作用，它编译成功但它没有做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:35:27.377

首先，您将 AT&T 语法与 DOS int 混合在一起。所以这里是每个平台的答案：

1\. `DOS:` [http://msdn.microsoft.com/en-us/library/5f7adz6y(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/5f7adz6y(v=vs.71).aspx)

```
__asm mov ah,01
__asm int 21 
```

现在`al`包含读取字节。[如此处](http://spike.scu.edu.au/~barry/interrupts.html)所述。

如果要传递`al`给`char input`使用正确的偏移量堆栈指针`esp - <the offset>`到达地址`input`并通过调用将读取值设置为它`mov byte [esp-offset], al`。

2 `LINUX`.：

你编写程序集的方式是`AT&T`风格，所以请检查[一下](http://wiki.osdev.org/Inline_Assembly/Examples)。

```
static inline
unsigned read_cr0( void )
{
    unsigned val;
    asm volatile( "mov %%cr0, %0"
                  : "=r"(val) );
    return val;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:31:01.200

从您提供的信息来看，您似乎是在与 DOS 不同的平台上编程。中断 21 仅适用于 DOS。对于 linux，请查看库 ncurses 和 readline 以了解高级终端技巧。如果您想做一些更底层的事情，您可能还对 ANSI 转义序列感兴趣。它们为您提供了一种与终端交互的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:31:10.010

而不是使用内联汇编器，正如其他人指出的那样，它是特定于 DOS 的，你为什么不把你的终端设置为禁用回显呢？有关如何执行此操作的详细信息，请参阅另一个问题的答案[。](https://stackoverflow.com/a/1798833/69755)

# jquery-ui - jquery datetimepicker 在设置 minDate 时失败

> ID：13534764
> 
> 赞同：2
> 
> 时间：2012-11-23T19:22:49.350
> 
> 标签：jquery-ui, datetimepicker

```
$('#altdate').datetimepicker({
        timeFormat: 'hh:mm:ss',
        dateFormat: 'yy-mm-dd',
        altField: "#Event_datetime",
        altFormat: "yy-mm-dd",
        altTimeFormat: 'hh:mm:ss',
        altFieldTimeOnly: false,
        onClose: function( selectedDate ) {
            //alert(selectedDate);
            $( "#altenddate" ).datetimepicker( "option", "minDate", selectedDate );
            if (selectedDate < ($.datepicker.formatDate('yy-mm-dd', new Date())) ) {
                start_in_past = true;
            }
        }
    });

$('#altenddate').datetimepicker({
        timeFormat: 'hh:mm:ss',
        dateFormat: 'yy-mm-dd',
        altField: "#Event_enddatetime",
        altFormat: "yy-mm-dd",
        altTimeFormat: 'hh:mm:ss',
        altFieldTimeOnly: false,
        onClose: function( selectedDate ) {
            //alert(selectedDate);
            $( "#altdate" ).datetimepicker( "option", "maxDate", selectedDate );
        }
    }); 
```

当我离开 datetimepicker 字段时，#Event_datetime 字段正确地填充了值“2012-12-23 13:00:00”；但是，当我关闭 enddate 之一时，该行

```
$( "#altdate" ).datetimepicker( "option", "maxDate", selectedDate ); 
```

场上只设“2012-12-23”！使用“maxDateTime”作为选项也不起作用，得到`maxDateTime.getFullYear is not a function`.

如何根据客户的要求使用完整的字符串设置 maxDate(Time)：yy-mm-dd hh:mm:ss

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T20:04:38.547

所以问题真的是设置“maxDate”选项，实际隐藏字段#Event_datetime被重置为没有时间 - 不知道为什么。

所以我通过在调用设置 maxDate 并再次重置之前临时保存 #Event_datetime 变量来解决它......

```
var current = $('#Event_datetime').val();
$( "#altdate" ).datetimepicker( "option", "maxDate", selectedDate );
$('#Event_datetime').val(current); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T12:33:16.867

我和你有同样的问题，只是没有使用 alt 字段。您的解决方案也对我有用，尽管我必须对其进行稍微不同的编码。

```
var current = $("#startDate").datetimepicker("getDate");
$("#startDate").datetimepicker( "option", "maxDate", selectedDate );
$("#startDate").datetimepicker( "setDate", current); 
```

（我意识到我可以将此作为评论发布，但我需要格式化代码示例。）

# debugging - 从 iframe 内部调试 gwt (X-Frame-Options)

> ID：13534768
> 
> 赞同：2
> 
> 时间：2012-11-23T19:23:34.327
> 
> 标签：debugging, google-chrome, gwt, iframe

当我尝试调试 iframe 中的 gwt 应用程序时（请注意，gwt codserv 和 webserv 都是本地的）我遇到了权限问题。抛出以下错误：

*   在 Chrome 控制台上：“拒绝显示文档，因为 X-Frame-Options 禁止显示。”；
*   在 Chrome 网页窗口上：“插件无法连接到 127.0.0.1:9997 的开发模式服务器，请遵循底层故障排除说明”

这只发生在谷歌浏览器、firefox 和 IE 中。

我已经搜索过类似的问题，但它们都在跨域上下文中，而我的是本地的。此外，尝试了建议的解决方案，但都没有成功。

这是我的网页示例，其中包含我的 iFrame。我无法调试 MyGWT 应用程序。

```
<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  </head>
  <body>
    <iframe src="MyGWT.html?gwt.codesvr=127.0.0.1:9997"></iframe>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:35:20.573

被阻止的页面可能是[TroubleshootingOOPHM](https://code.google.com/p/google-web-toolkit/wiki/TroubleshootingOOPHM)

仅供参考，这已[在 GWT 2.5 中修复](https://code.google.com/p/google-web-toolkit/source/detail?r=11349)，它现在链接到此页面，而不是尝试在 iframe 中显示它（此外，在错误玻璃窗格下方，这使得它在 Google 更改其服务器设置之前几乎不可读）

# sql-server - 从 SQL Server 上的 SELECT 获取 XML

> ID：13534769
> 
> 赞同：1
> 
> 时间：2012-11-23T19:23:36.160
> 
> 标签：sql-server, xml

我有以下xml

```
declare @Obligaciones xml 
set @Obligaciones = '<obligaciones>
  <Obligacion id = "51" TipoCancelacionObligacionId = "1" > </Obligacion>
  <Obligacion id = "52" TipoCancelacionObligacionId = "2"> </Obligacion>
  <Obligacion id = "53" TipoCancelacionObligacionId = "2"> </Obligacion>
  </obligaciones>' 
```

我想得到以下作为我的查询的结果

```
<obligaciones>
  <Obligacion id = "51" TipoCancelacionObligacionId = "1" > </Obligacion>
</obligaciones> 
```

有人可以帮忙查询吗？我尝试了一段时间没有成功。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:28:18.433

这个怎么样：

```
SELECT  
    @Obligaciones.query('/obligaciones/Obligacion[@id="51"]')
FOR XML PATH (''),ROOT('obligaciones') 
```

给了我想要的输出：

```
<obligaciones>
  <Obligacion id="51" TipoCancelacionObligacionId="1" />
</obligaciones> 
```

`@Obligaciones.query()`获取带有属性的 XML 元素，`id=51`然后我将生成的 XML 行包装到一个名为 .xml 的 XML 根元素`<obligaciones>`中。

**更新：**如果您希望获取第**一个**元素而不管其`id`属性如何 - 请改用此查询：

```
SELECT  
    @Obligaciones.query('/obligaciones/Obligacion[1]')
FOR XML PATH (''),ROOT('obligaciones') 
```

# ember.js - Ember 复杂的属性绑定

> ID：13534777
> 
> 赞同：1
> 
> 时间：2012-11-23T19:24:55.257
> 
> 标签：ember.js, momentjs

我正在使用相当复杂的属性绑定来更改用户生日的日期、月份或年份。拥有一个用户`birthDate`类型`date`的属性和每个日期的三个属性。我正在使用[moment.js](http://momentjs.com/)来简化日期操作。

通过[在 jsfiddle 上尝试减少展示，](http://jsfiddle.net/YBm36/5/)您会发现如果您更改年份或日期，月份总是增加 1。我不能说发生了什么。就是这样：设置新日期时，该值是正确的，稍后会更改。`date`ember-data属性和某些格式是否存在问题？

再说一遍：这是用[CoffeeScript](http://coffeescript.org/)编写[的 jsfiddle](http://jsfiddle.net/YBm36/5/)。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T03:48:02.260

我查看了您的代码，它看起来应该可以正常工作，我越是通过它越是恼火我无法发现问题......原来它是 Moment.js 的 .month() 方法...[来自文档](http://momentjs.com/docs/#/manipulating/month/)：

“通过更改月份来改变原始时刻。接受从 0 到 11 的数字”

很蠢吧？在任何情况下，当您使用 .month() 时，将您的 setMonth 更改为从值中减去 1

```
setMonth: (property, value) ->
  @set property, moment(@get(property)).month(value-1).format()
  return value 
```

# android - 按下后退按钮后的Android ViewPager异常

> ID：13534787
> 
> 赞同：4
> 
> 时间：2012-11-23T19:26:09.680
> 
> 标签：android, android-viewpager, fragment

我有一个 ViewPager，其中包含 3 个工作正常的片段。我从 viewpager 中的任何片段开始一个活动，并显示该活动。之后，当我按下后退按钮时，我的应用程序崩溃并出现以下异常：

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to resume activity {AppName.Activities/AppName.Activities.ViewPagerActivity}: java.lang.IndexOutOfBoundsException: Invalid index 2, size is 0
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2120)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2135)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:957)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:3683)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.IndexOutOfBoundsException: Invalid index 2, size is 0
    at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:257)
    at java.util.ArrayList.set(ArrayList.java:484)
    at android.support.v4.app.FragmentStatePagerAdapter.destroyItem(FragmentStatePagerAdapter.java:97)
    at android.support.v4.view.ViewPager.populate(ViewPager.java:415)
    at android.support.v4.view.ViewPager.setCurrentItemInternal(ViewPager.java:271)
    at android.support.v4.view.ViewPager.setCurrentItem(ViewPager.java:244)
    at AppName.Activities.ViewPagerActivity.setUpView(ViewPagerActivity.java:36)
    at AppName.Activities.ViewPagerActivity.onStart(ViewPagerActivity.java:28)
    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1129)
    at android.app.Activity.performStart(Activity.java:3791)
    at android.app.Activity.performRestart(Activity.java:3821)
    at android.app.Activity.performResume(Activity.java:3826)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2110) 
```

以下是我的 ViewPagerActivity 代码，它扩展了 FragmentActivity::

```
public class ViewPagerActivity extends FragmentActivity
{
    private ViewPager mViewPager;
    private ViewPagerAdapter adapter;
    boolean flag = false;

    @Override
    protected void onCreate(Bundle arg0)
    {
        super.onCreate(arg0);
        setContentView(R.layout.view_pager);
    }

    @Override
    protected void onStart()
    {
        super.onStart();
        setUpView();
    }

    private void setUpView()
    {
        mViewPager = (ViewPager) findViewById(R.id.viewPager);
        adapter = new ViewPagerAdapter(getApplicationContext(),getSupportFragmentManager());
        mViewPager.setAdapter(adapter);
        mViewPager.setCurrentItem(0);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch (item.getItemId())
        {
            case R.id.settings:
                startActivity(new Intent(this, AppSettingsActivity.class));
                return true;
            case R.id.addSituationMenu:
                Intent i = new Intent(this, MainLayout.class);
                i.putExtra("parentActivity", "SplashScreenLayout");
                startActivity(i);
                return true;
            case R.id.historyActivity:
                startActivity(new Intent(this, HistoryActivity.class));
                return true;
            case R.id.chartActivity:
                startActivity(new Intent(this, ViewPagerActivity.class));
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }

} 
```

行 mViewPager.setCurrentItem(0); 导致崩溃。

这是 ViewPagerAdapter 代码：

```
public class ViewPagerAdapter extends FragmentStatePagerAdapter
{
    private final Context context;
    ArrayList<ArrayList<Object>> data;
    int totalMoodEntries = 0;
    static Fragment f = null;

    public ViewPagerAdapter(Context mcontext, FragmentManager fm)
    {
        super(fm);
        context = mcontext;
    }

    @Override
    public Fragment getItem(int position)
    {
        switch (position)
        {
            case 0:
            {
                f = new ChartFragment(context, totalMoodEntries, data);
                break;
            }
            case 1:
            {
                f = new ViewRecordsFragment(context, data);
                break;
            }
            case 2:
            {
                f = new LearnMoreFragment(context);
                break;
            }
        }
        return f;
    }

    @Override
    public int getCount()
    {
        return 3;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T20:15:41.310

您可以通过在方法中移动以下行来尝试`onCreate()`：

```
mViewPager = (ViewPager) findViewById(R.id.viewPager);
adapter = new ViewPagerAdapter(getApplicationContext(),getSupportFragmentManager());
mViewPager.setAdapter(adapter); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:21:26.487

应用程序崩溃是因为当您调用它的`setCurrentItem(0)`方法时，`ViewPager`它会尝试破坏不可见的片段以释放内存。但是在活动生命周期的那个时刻，它们并不在那里（因此是`Invalid index 2, size is 0`）。

它将保持活动的片段数通过方法指定`setOffscreenPageLimit()`，默认为1，这意味着最多3个片段将保留在内存中（显示的片段，前一个和下一个）。

片段的创建和销毁过程由 自动管理`ViewPager`，您应该让它完成它的工作。此外，您正在使用 a `FragmentStatePagerAdapter`，它已经保存了不同片段被销毁时的状态，但它也使得片段之间的信息传递变得更加复杂，因为它们不一定存在。

如果您确实需要以编程方式将第一个片段设置为可见片段，只需尝试调用`setCurrentItem()`in`onResume()`而不是`onStart()`，然后查看片段是否已经存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:39:29.990

问题是在创建新的 ViewPageAdapter 并将其设置为 ViewPager 之后，您正在设置当前项目 0。您的片段仍未创建，因此它返回超出范围的异常。

在 getItem 方法上写一个日志，在 setCurrentItem 之前写一个日志，并检查您的 getItem 在 setCurrent 之前是否被调用（您的 getItem 正在创建片段）。

我不确定，但我认为没有必要强制 setCurrentItem，另一件事是您在每个 getItem 调用中创建一个新片段。将它们保存在集合中以避免内存泄漏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-11T15:05:04.907

就我而言，我认为问题有点不同。每当我替换当前的I 时`instantiateItem()`，我的方法都会抛出相同类型的异常，然后按下 Back 按钮返回到带有. 引发异常的确切行是：`PagerAdapter``Fragment``ViewPager`

```
((ViewPager) viewPagerContainer).addView(page, position); 
```

在：

```
private class SmartViewPagerAdapter extends PagerAdapter {

    // [...]

    @Override
    public int getCount() {

        return ABOUT_VIEW_PAGER_IMAGES.length;
    }

    @Override
    public boolean isViewFromObject(View arg0, Object arg1) {

        return arg0 == (View) arg1;
    }

    @Override
    public Object instantiateItem(ViewGroup viewPagerContainer, int position) {

        Drawable pageImage = getResources().getDrawable(ABOUT_VIEW_PAGER_IMAGES[position]);
        Drawable pageTitle = getResources().getDrawable(ABOUT_VIEW_PAGER_TITLES[position]);
        String pageDescription = getString(ABOUT_VIEW_PAGER_DESCRIPTIONS[position]);

        SmartViewPagerPage page =
                new SmartViewPagerPage(getActivity(), pageImage, pageTitle, pageDescription);
        ((ViewPager) viewPagerContainer).addView(page, position);

        return page;
    }
} 
```

事实证明，当你在`View`你`ViewPager`的`instantiateItem()`.

```
((ViewPager) viewPagerContainer).addView(page, 0); 
```

我希望这可以帮助别人 ：）

# python - scipy.optimize 有令人困惑的行为

> ID：13534788
> 
> 赞同：2
> 
> 时间：2012-11-23T19:26:31.317
> 
> 标签：python, optimization, scipy

我`scipy.optimize`用来解决最小化问题。但它在做什么没有任何意义。如果我没有设置最大迭代次数，它将永远运行（嗯，至少 12 小时）。因此，我将最大迭代次数设置为要测试的小值，例如 20。

我的函数的初始值为 880.770191886。当我使用所有诊断输出（`full_output=True`，`retall=True`）运行时`scipy.optimize.fmin`，我得到：

```
>>dataOut = so.fmin(optimize_grid, coordsOuter, args=(0.5,(65,86,2)), maxiter=20, disp=True, full_output=True, retall=True)                                                         
>>print dataOut[1:] 
```

给出：

```
Warning: Maximum number of iterations has been exceeded
(197.24011337756517, 20, 11207, 2, [array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373]), array([ 0.5       ,  0.5       ,  0.55702654, ...,  2.45997569,
    2.47487373,  2.47487373])]) 
```

所以所有这一切都是说我的函数的最小值取值 197.24 等。然而，它在每次迭代中尝试使用的向量与初始向量相同！所以它实际上并没有做任何事情，即使它确定了一个最小值。我只是在每一步都将初始向量作为答案，这显然是不正确的。

任何想法是什么问题？我看不出它的工作方式有任何理由，因为它在某些时候清楚地确定了小于初始值的函数值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T22:27:12.003

我猜你正在解决的问题并不是真的不适定，scipy.fmin 可以通过很少的迭代收敛到非常好的结果，但是因为你只定义了`maxiter`它试图满足你的请求的参数。你有没有尝试使用`xtol`或`ftol`参数。您没有提到您使用的 SciPy 版本，但它们从 0.11 开始提供。

从 0.11 开始，您还可以使用`scipy.minimize`它来更好地控制方法及其参数。

# c# - 在 C# 中创建一个类型的多个对象

> ID：13534800
> 
> 赞同：-1
> 
> 时间：2012-11-23T19:27:22.857
> 
> 标签：c#, arrays, object

我写了一些代码，它有一个名为`Cars`如下的类：

```
public class Cars
{
    public Cars()
    {
        string ma;
        int pe;
        Console.WriteLine("PLz put the car  name:");
        ma = Console.ReadLine();
        Console.WriteLine("PLz put  car no  :");
        pe = Convert.ToInt16( Console.ReadLine());
    }

} 
```

现在我想创建它的多个对象，例如列表或数组。
我知道这段代码，但我不知道如何为此使用 for 循环，以防它可以自动创建多辆汽车

```
Cars[] car = new Cars[10]; 
```

或者

```
List <Cars> 
```

问题是我不知道如何使用它们，如果可以，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:30:56.447

我认为您正在寻找的是：

```
Cars[] car = new Cars[10];

for (int i = 0; i < 10; i++)
{
    car[i] = new Cars();
} 
```

或使用`List<T>`：

```
List<Cars> car = new List<Cars>();

for (int i = 0; i < 10; i++)
{
    car.Add(new Car());
} 
```

但是，我建议您将`Console`函数移到类之外，而是使用如下构造函数：

```
public Cars(string ma, int pe)
{
    // assign to properties, etc.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:46:40.670

有点像下面的东西，会帮助你。但就像那些人所说的，你需要从基础开始，从书本上阅读总是最好的。

```
namespace Cars
{
    class Program
    {
        static void Main(string[] args)
        {
            List<Cars> carList = new List<Cars>();

            Console.WriteLine("PLz put the car  name:");
            string ma = Console.ReadLine();
            Console.WriteLine("PLz put  car no  :");
             int pe = Convert.ToInt16(Console.ReadLine());

            carList.Add(new Cars(ma,pe));
        }

        public class Cars
        {

            string ma;
            int pe;

            public Cars(string carName, int reg)
            {
                ma = carName;
                pe = reg;

            }

        }
    }
} 
```

# javascript - Jquery datepicker 不显示当前日期

> ID：13534801
> 
> 赞同：1
> 
> 时间：2012-11-23T19:27:24.450
> 
> 标签：javascript, jquery, asp.net, jquery-ui

我的页面中有日期选择器。它工作正常。但我的问题是它显示“01/01/2001”作为默认日期。它现在应该显示“11/23/2012”！我的jQuery代码是：

```
 $(":input[data-datepicker]").datepicker(); 
```

我的代码有什么问题？

这是文件的完整代码：

```
$(document).ready(
function () {
    $(":input[data-autocomplete]").each(
        function () {
            $(this).autocomplete({ source: $(this).attr("data-autocomplete") });
        }
    );
    //$.datepicker.setDefaults($.datepicker.regional["en-GB"]);
    $(":input[data-datepicker]").datepicker({defaultDate: 0});

}
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:11:02.877

[这](http://jsfiddle.net/LbyJt/)是一个示例代码......
它本身就可以正常工作。默认日期是 2012 年 11 月 23 日，如果您愿意，也可以将默认日期移动到任何日期或像这样明确定义它：`$(":input[data-datepicker]").datepicker({ defaultDate: 0 });`.
也许你在使用 jQuery UI API 时犯了一些错误，所以你的代码坏了？

编辑：你也许可以试试这个：`$("#datepick").datepicker({setDate: new Date()});`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-23T19:33:09.377

您必须在构造函数上设置本地化。

请参阅[此](http://jqueryui.com/datepicker/#localization)页面了解更多信息。

# objective-c - JSON Payload 似乎没有发送

> ID：13534804
> 
> 赞同：0
> 
> 时间：2012-11-23T19:27:37.600
> 
> 标签：objective-c, ios, xcode

我很肯定的问题很简单，我一定是遗漏了一些东西..只是不确定是什么。

我可以发送 GET 和 POST 以获取粒度元素（this=that kind of stuff），但是我也需要发送数据的 Web 服务调用需要一个原始 JSON 块，没有“密钥”

这是我写的方法：

```
-(NSData *)execute {

    // Smart Chooser ?
    if(PostData.count >0 || Payload != nil)
        [self setMethod:UPLINK_METHOD_POST];
    else
        [self setMethod:UPLINK_METHOD_GET];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:self.connectionUrl
                                                           cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData
                                                       timeoutInterval:10];

    if([UPLINK_METHOD_GET isEqualToString:self.connectionMethod])
        [request setHTTPMethod:@"GET"];
    else
        [request setHTTPMethod:@"POST"];

    NSString *gData = [self compileGetData];
    NSString *pData = [self compilePostData];

    // if we have get data, set it into the URL string
    if(GetData.count > 0) {

        [self setURLWithString:[[self.connectionUrl absoluteString] stringByAppendingString:[@"?" stringByAppendingString:gData]]];
        [request setURL:self.connectionUrl];

    }

    // if we have post data, set it in the body
    if(PostData.count > 0) {
        const char *bytes = [[NSString stringWithString:pData] UTF8String];
        [request setHTTPBody:[NSData dataWithBytes:bytes length:strlen(bytes)]];

    }

    // Override any post data if a payload is already defined.
    if(Payload != nil) {

        [request setHTTPBody:[Payload dataUsingEncoding:NSUTF8StringEncoding]];

    }

    NSLog(@"URL : %@", request.URL);

    NSURLResponse *response;
    NSError *err;
    NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&err];

    if(err != nil)
        NSLog(@"here was an error: %@", err);

    return responseData;
}

-(NSDictionary *)executeAsJSON
{
    NSData *responseData = [self execute];
    NSError *e;
    return [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableContainers error:&e];
} 
```

好的，这件事的工作方式是，它会根据 GetData、PostData 和 Payload vars 中提供的数据自动设置请求是 POST 还是 GET。

默认情况下，请求是 GET，但如果 PostData 或 Payload 中有任何内容，则会变成 POST。
并且大部分只是带回带有信息数组的格式化字符串，没有什么特别的`compileGetData`。`compilePostData`

但这不是问题所在。

看，“有效负载”覆盖了其中的任何“PostData”。如果您在类中提供了 PostData 元素，那么它只会被提供的有效负载（如果确实存在）覆盖。

我需要提供这个来展示它现在存在的“工作区”，它不是线性提供的信息。

这是感兴趣的领域：

```
// Override any post data if a payload is already defined.
if(Payload != nil) {

    //const char *plbytes = [[NSString stringWithString:Payload] UTF8String]; // this didn't work
    [request setHTTPBody:[Payload dataUsingEncoding:NSUTF8StringEncoding]]; // inline, doesn't work either

} 
```

当我说“不起作用”时，我的意思是，我从 web 服务返回一个错误的 JSON 数组，这基本上意味着“嘿，有效负载在哪里？”。如果请求不是 POST，它会作为一般错误返回，所以一切正常，那么 URL 显然是正确的。

我已经使用 RESTConsole for Chrome 来测试 web 服务以确保其正常工作，并且确实如此。

我还通过调试器检查了我发送的确切有效负载，我将其复制并粘贴到 RESTConsole 中，它在那里工作。

我……老实说在这里不知所措……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:37:19.387

尝试使用像[Charles](http://www.charlesproxy.com/)或[Wireshark](http://www.wireshark.org/download.html)这样的 Web 代理（我个人更喜欢 Charles，因为它易于使用，不过它是一个 30 天的试用版）并监控您从 RESTConsole 发出的请求以及您从应用程序发出的请求，看看它们是否看起来相同。

检查任何标题、换行符和其他任何看起来不同的东西。

这是我能想到的最好的开始

# javascript - 如何使用 Angular js 做日常的 Javascript 工作？

> ID：13534806
> 
> 赞同：2
> 
> 时间：2012-11-23T19:27:37.433
> 
> 标签：javascript, angularjs, javascript-framework

在过去的 3-4 天里，我研究了 Angular js。从外观上看（带有教程和视频），它使用起来非常直观。但是当我真正开始用 Angular js 替换我当前的 Web 应用程序代码时，我在启动时遇到了很多问题。

例如，如果在某个事件中，我希望将一些 HTML 添加到 DOM 中某个已经存在的元素中，那么通过传统的 jQuery 路由，我将简单地获取元素并添加 HTML。我无法理解如何用 Angular 做完全相同的事情，因为 Angular 控制器中不建议进行 DOM 操作。那么我如何访问我应该扩展的元素。

另一个例子可能是我必须在某个时候重置表单元素。我再次面临在 Angular 控制器中使用 jQuery 样式元素选择器的困境。

有人可以向我解释一下如何用 Angular 做所有这些事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T21:33:47.343

让我先回答你的标题问题：不要。

AngularJS 是一个强大的工具（我只是触及了它的表面，现在已经专门在 Angular 上工作了 2 个月 @ 工作），但它过于固执己见，无法成为脚本编写的好选择。它有一点学习曲线（不是太陡峭，但肯定比“嘿，{{model}} 是魔法！”介绍你在他们的页面上找到。不要误会我 - 我非常喜欢它，它非常结构化，这迫使我有条理，并使代码具有极强的可扩展性。所以，如果你愿意学习它的“MO”，你就会爱上它。

现在，关于 DOM 操作：您可以通过多种方式进行操作，但基本上，如果您想要 DOM 操作，您需要一个指令。教程可以很好地帮助您，但是如果您对 JS 有一定的了解，我建议您探索源代码（您可能已经知道，ngRepeat 是一个直接的常规指令，就像您可以创建的指令一样） . 角度范围与 DOM 元素相关联，反之亦然。在指令中，您可以处理它所绑定的元素，并使用 jQuery（或任何其他框架，或只是普通的 JS）来更改它。更改可以与元素出现的时刻、模型的更改（通过 $watch 函数）或您自己指定（并触发）的事件相关联（参见 $broadcast ad $emit）。

我更改了一个示例脚本来解决不同类型的问题（即在 ngRepeat 结束时触发事件）以包含一些不同的处理 DOM 的方式：http: [//plnkr.co/edit/or5mys](http://plnkr.co/edit/or5mys)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T21:21:20.457

在 Angular 中，所有 DOM 操作代码都驻留在指令中。因此，如果您需要将 HTML 添加到已经存在的元素，例如从远程 url 加载模式对话框的内容，您将需要为此编写指令。请参阅此处的文档：[AngularJS 中的指令](http://docs.angularjs.org/guide/directive)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T03:08:57.593

这取决于您想要执行哪种类型的 DOM 操作；正如其他人所说，指令可以工作，但这更适用于复杂的 DOM 内容或可重复的小部件。对于常规表单，如果只是在某处填写文本，则可以使用控制器的范围来完成。

例如，如果您想更新状态消息，而不是直接更新 DOM，您可以将其绑定到范围内的字段：

```
<div>{{statusMsg}}</div> 
```

并在您的控制器中，在适当的时候：

```
scope.statusMsg = 'Done loading'; 
```

由于 Angular 有双向数据绑定，DOM 会自动更新消息。

对于表单重置的示例，您的表单将绑定到模型，因此要重置表单，您只需重置模型。这是一个非常简单的例子：http: [//jsfiddle.net/Kbsqx/](http://jsfiddle.net/Kbsqx/)

# python - Python ftplib 连接错误（gaierror）

> ID：13534807
> 
> 赞同：11
> 
> 时间：2012-11-23T19:27:44.567
> 
> 标签：python, ftp

我正在尝试在 python 中创建一个非常基本的 FTP 客户端，并且在前几行代码中我已经遇到了问题

我的代码：

```
from ftplib import FTP
ftp = FTP('ftp.mysite.com') 
```

使用这段代码，并且使用了无数不同的 url，我总是会得到同样的错误：

```
gaierror: [Errno 11004] getaddrinfo failed 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-12-15T05:58:25.203

我发现自己在这里尝试使用完整路径而不是主机名进行连接时出现此错误。确保将其拆分并`cwd(path)`在`login()`.

例如：

```
ftp = FTP('ftp.ncdc.noaa.gov')
ftp.login()
ftp.cwd('pub/data/noaa/2013') 
```

**而不是**：

```
# Doesn't work!!
ftp = FTP('ftp.ncdc.noaa.gov/pub/data/noaa')
ftp.login()
ftp.cwd('2013') 
```

事后看来有点明显，但希望我能帮助你注意到你的简单错误！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-23T21:05:19.790

实际上，这意味着您的计算机无法解析您提供的域名。[此处](http://docs.python.org/2/library/socket.html#socket.gaierror)提供了详细的错误描述。尝试使用众所周知的工作 FTP 进行测试（例如`ftp.microsoft.com`）。然后尝试使用某些 FTP 客户端打开您尝试访问的 FTP。

# opencv - 聚类和 kmeans 的文档不明确

> ID：13534816
> 
> 赞同：1
> 
> 时间：2012-11-23T19:28:22.093
> 
> 标签：opencv, cluster-analysis, k-means, feature-detection

我必须在我未来的工作中使用 kmeans，我知道它在 OpenCV 中可用，因为他们有一个[文档页面](http://docs.opencv.org/modules/core/doc/clustering.html#double%20kmeans%28InputArray%20data,%20int%20K,%20InputOutputArray%20bestLabels,%20TermCriteria%20criteria,%20int%20attempts,%20int%20flags,%20OutputArray%20centers%29)。

我无法理解显示的格式，下面给出的详细信息也没有解释（它似乎是与 OpenCV 1.1 相关的详细信息）。我的意思是，使用 C++ 行：

```
double kmeans(InputArray data, int K, InputOutputArray bestLabels, TermCriteria criteria, int attempts, int flags, OutputArray centers=noArray() ) 
```

什么数据类型是数据、向量或矩阵？哪个是输入矩阵，哪个是输出？

我习惯于阅读[这样](http://docs.opencv.org/modules/features2d/doc/common_interfaces_of_feature_detectors.html?highlight=featuredetector#featuredetector-detect)的文档，其中清楚地说明了输入/输出/标志等以及它们是什么数据类型。

```
C++: void FeatureDetector::detect(const Mat& image, vector<KeyPoint>& keypoints, const Mat& mask=Mat() ) const 
```

如果有人能给出一个使用 kmeans 的简短示例，我将不胜感激。

PS我已经准备好用于kmeans的输入矩阵是由`DescriptorExtractor::compute`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:57:19.453

`OpenCV`您可以在文件夹中找到使用大部分功能的示例`samples`。在你的情况下，看看这两个：

1.  `kmeans.cpp`
2.  `matcher_simple.cpp`

# ruby - 在位置查询上调用 .first 或 .last 时获得相同的结果（即文档）

> ID：13534819
> 
> 赞同：1
> 
> 时间：2012-11-23T19:28:36.623
> 
> 标签：ruby, ruby-on-rails-3, mongodb, activerecord, mongoid

我正在使用`Ruby on Rails`创建`RESTful`Web 服务。我`MongoDB`用于模型和`Mongoid`ODM。我使用脚手架创建了应用程序，并且在浏览器和 ruby​​ 控制台上一切正常。但是我正在做一些测试并注意到如果我打电话`first`或`last`作为位置查询的一部分，它们会返回相同的文档。

# 这是问题的复制：

1.  创建了 10 个事件记录。 ![在此处输入图像描述](../Images/d1717226303dac80b98e871af0b5b4f4.png)

2.  经过验证的通话`Model.last`，`Model.first`一切正常。 ![在此处输入图像描述](../Images/44f7ac4f81dda916244d9f588e905a6d.png)

3.  通过调用特定索引 0 和 9 验证数组匹配的记录。 ![在此处输入图像描述](../Images/eec728c5de6b88a69f97eced45dfae4b.png)

4.  `last`执行位置查询并包含对和`first`记录的请求。结果是同一份文件。有特定索引的验证记录，结果是正确的。 ![在此处输入图像描述](../Images/4885611a7e0f52d91526ee382a6a99f3.png)

我（是 ROR 的新手并且）不知道为什么会这样。难道我做错了什么？会不会是 Mongoid 而不是 Rails 的问题？

谢谢你的帮助。干杯。

# vb.net - 如何确保 VB.NET 中的父 mdi 表单仅创建子表单的一个实例

> ID：13534821
> 
> 赞同：0
> 
> 时间：2012-11-23T19:28:40.227
> 
> 标签：vb.net, singleton, global-variables, mdichild, mdiparent

我在父表单上有一个按钮，可以创建新的子表单。

但是，我不希望为每个表单创建多个实例。我尝试在父 MDI 表单上放置一个公共布尔值： `Dim ChildForm As Boolean = False`

在创建子表单的地方： `ChildFormThere = True`

在子窗体的“离开”事件中，我想我可以这样做：

`Me.MdiParent.ChildFormThere = False`

但它不识别 ChildFormThere 变量......那怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:32:00.963

这样的事情怎么样。这个想法是，如果表单已经创建，则切换到它，否则创建一个。这假设您在创建子表单时正确设置了 mdiParent。此代码需要在 mdiParent 上运行，或者需要对其进行引用才能访问 MdiChildren 属性。

```
For Each f In Me.MdiChildren
    If TypeOf (f) Is Form1 Then
        f.Show()
        Exit Sub
    End If
Next

Dim frm As New Form1
frm.Show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T21:30:31.923

也许代替：

```
dim ChildFormThere as Boolean = False ' Or True 
```

你可以这样做：

```
dim ChildForm as New ChildFormClass

' On Create Button Click:
ChildForm.Visible = True 
```

这样它总是相同的实例，所以你必须简单地管理它是否可见。

# visual-studio - SimpleMembership => 拥有 UserId 的 GUID

> ID：13534823
> 
> 赞同：1
> 
> 时间：2012-11-23T19:29:01.383
> 
> 标签：visual-studio, ef-code-first, asp.net-membership, membership-provider

与我在网上看到的许多帖子不同，这不是我更喜欢 Guid 还是 Int。

**问题：**我想知道如何为 SimpleMembership 的 UserId 制作 Guid。如果我不能，如何首先执行我自己的提供程序代码，以便最终将 UserId 放在另一个表中（将记录链接到执行此操作的用户 + 我不想要用户名（会发生什么如果它改变了？））。

我的研究：我看到你必须继承和重新实现每个方法，但是没有一个帖子解释如何做到这一点。我见过的最接近的帖子是：[http](http://www.brianlegg.com/post/2011/05/09/Implementing-your-own-RoleProvider-and-MembershipProvider-in-MVC-3.aspx) ://www.brianlegg.com/post/2011/05/09/Implementing-your-own-RoleProvider-and-MembershipProvider-in-MVC-3.aspx但它仍然与Int 作为身份 Pk。

我知道这可能是 VS2012 的一项功能，但 VS2010 会处理所有表（具有 Guid 的用户具有 Id，所有其他表具有 Guid 列）。我仍然希望我的 UserId 带有 Guid 而不是 int。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-19T19:07:23.247

我相信您正在寻找[SimpleGuidMembershipProvider](https://github.com/nonintanon/SimpleGuidMembershipProvider)

# sql - amazon simpledb 属性命名限制？

> ID：13534825
> 
> 赞同：1
> 
> 时间：2012-11-23T19:29:06.417
> 
> 标签：sql, attributes, amazon-web-services, amazon, amazon-simpledb

我想知道amazons simpledb中的属性名称是否有任何限制。我尝试了以下属性名称

```
my.attribute.name 
```

运行以下查询

```
select * from mydomain where my.attribute.name is not null 
```

导致错误：“*指定的查询表达式语法无效。* ”。围绕“my.attribute.name”也会导致错误，因为选择语法无效。

将点更改为下划线，一切正常：

```
my_attribute_name 
```

并且查询运行良好

```
select * from mydomain where my_attribute_name is not null 
```

现在我的问题是：属性允许使用哪些字符？在[亚马逊开发人员手册](http://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/SDBLimits.html)中，名称仅限于在 xml 文档中有效的字符。这到底是什么意思？链接的 W3C 文档似乎没有回答这个问题。在域名中，点“.” 被允许。

目前我使用[sdbTool](http://code.google.com/p/sdbtool/)。我希望这不会影响行为。

在属性名称中插入一些其他字符正在起作用，例如：'my:attribute-name.with other%20chars'。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:16:00.153

您能否将您的属性名称用反引号括起来，然后再试一次？

域名和属性名称如果包含任何特殊字符，则需要用反引号引起来。如果属性和域名仅包含字母、数字、下划线 (_) 或美元符号 ($)，则它们可能会出现不带引号的情况。如果所有其他属性和域名包含任何特殊字符，则必须用反引号 (`) 引用它们。

# c# - 列表、反射、IEnumerable 和配置问题

> ID：13534829
> 
> 赞同：2
> 
> 时间：2012-11-23T19:29:29.060
> 
> 标签：c#, collections, reflection

我正在尝试使用反射来检测集合，例如`List<T>`. 最终，我需要在没有可用实例的情况下进行操作（即仅通过 typeof），并且希望检测超出 just 的集合`List<T>`，但为了简单起见，这里有一个失败的基本测试用例：

```
Type type = (new List<string>()).GetType();
if (type.IsAssignableFrom(typeof(System.Collections.IEnumerable)))
{
    Console.WriteLine("True.");
}
else Console.WriteLine("False."); 
```

我也尝试过`IList`，`ICollection`但无济于事。

在进行故障排除时，我遇到了以下讨论： [为什么 List<int> 不是 IEnumerable<ValueType>？](https://stackoverflow.com/questions/8144473/why-is-listint-not-ienumerablevaluetype)

该讨论的 OP 找到了他的答案，因为协方差对它们不起作用，所以不会被上面的东西检测到值类型。但是我使用的是字符串，一种引用类型，但仍然没有看到协方差。更奇怪的是（无论如何对我来说），当我运行上述讨论中的示例代码时，我看到了一个非常不同的结果：

```
System.Collections.Generic.List`1[AssignableListTest.Program+X] is most likely a list of ValueTypes or a string
System.Collections.Generic.List`1[System.String] is most likely a list of ValueTypes or a string
System.Collections.Generic.List`1[AssignableListTest.Program+Z] is most likely a list of ValueTypes or a string
System.Collections.Generic.List`1[System.Int32] is most likely a list of ValueTypes or a string
blah is most likely a list of ValueTypes or a string
1 is not a list 
```

让我相信我必须与那张海报有配置差异。我使用的是 Visual Studio 2005，在本例中是 .NET 3.5，但如果可能的话，我需要将兼容性恢复到 2.0。实际上，如果我能得到海报的结果，就足够了（确定`IEnumerable`已实现），但是当我使用`Type.IsAssignableFrom()`“is”代替时，它们都给出“不是列表”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T19:30:55.637

您需要翻转支票：

```
type.IsAssignableFrom(typeof(System.Collections.IEnumerable)) 
```

变成

```
typeof(System.Collections.IEnumerable).IsAssignableFrom(type) 
```

每个人都至少犯过一次这个错误。这是一个误导性的 API。

# awk - 如何改进这个例子？

> ID：13534841
> 
> 赞同：0
> 
> 时间：2012-11-23T19:31:07.383
> 
> 标签：awk

```
$ seq 12 | awk '{ if(NR%2) { print $0, (NR+1)/2 } else { print $0, NR/2} }'
1 1
2 1
3 2
4 2
5 3
6 3
7 4
8 4
9 5
10 5
11 6
12 6 
```

如何更改上述命令？我想打印：

```
1 1
2 1
3 1
4 2
5 2
6 2
7 3
8 3
9 3
10 4
11 4
12 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:36:12.927

唔。只需将您的算法应用于3：

```
seq 12|awk '{if((NR%3)==1) { print $0, (NR+2)/3 } else if ((NR%3)==2) { print $0, (NR+1)/3 } else { print $0, NR/3} }' 
```

但我敢肯定还有一个更短的算法......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T20:09:04.407

```
awk '{print $0, int((NR+2)/3)}' 
```

# android - 开发工具权限我没有设置

> ID：13534843
> 
> 赞同：10
> 
> 时间：2012-11-23T19:31:17.860
> 
> 标签：android, android-manifest, android-permissions

我一直在创建一个 android 应用程序，当我导出（并签名）它时，它总是添加一个我从未设置过的“开发工具（测试对受保护存储的访问”权限。这是我的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.tdr"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="Escriure"
            android:enabled="true" >
        </activity>
        <activity android:enabled="true" android:name="Llegir"></activity>
    </application>

</manifest> 
```

我确实需要从外部存储中写入和读取文件，但不需要使用 (¿?) 开发工具。哪里有问题？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-23T19:51:53.693

Android 新增了 Jelly Bean 需要添加的权限。请阅读这篇[文章](http://www.androidguys.com/2012/06/29/jelly-bean-has-new-permission-option-to-read-external-storage/)，复制如下以供快速参考：

> 现在，在 Jelly Bean 中，我们获得了“读取外部存储”权限。根据谷歌：
> 
> **READ_EXTERNAL_STORAGE**
> 
> 提供对外部存储的受保护读取访问。默认情况下，在 Android 4.1 中，所有应用程序仍然具有读取权限。这将在未来的版本中进行更改，以要求应用程序使用此权限明确请求读取访问权限。如果您的应用程序已经请求写入权限，它也会自动获得读取权限。有一个新的开发人员选项可以打开读取访问限制，以便开发人员根据 Android 未来的行为来测试他们的应用程序。因此，当您进入 Jelly Bean 设备上的开发选项时，看到这个新选项不要感到惊讶。我们不会在 Android 4.1.0 中看到该权限，但最有可能在 4.1.1 中看到，其目的是让您的设备更加安全。

# c++ - 如何在 C++ 中为非常量和本地数据伪造依赖类型？

> ID：13534847
> 
> 赞同：3
> 
> 时间：2012-11-23T19:32:18.533
> 
> 标签：c++, templates, types

下面是一些几乎可以工作的代码。我想要做的是创建内存池，在销毁时自动删除它们的内容（如果它只适用于普通的旧数据就可以了），并且有一个编译时间保证池必须始终比指向它的内容的指针存活更长的时间。为了实现这一点，我使指针具有指向它们类型的一部分的池。我的策略似乎应该有效，但 C++ 只允许常量或全局数据作为模板参数，这阻止了我按照我的意愿进行编程。例如，在下面的代码中，内存池必须是一个全局值。如何在 C++ 中为非常量和本地数据伪造依赖类型？

这是代码，以及一个显示如何使用它的简单示例。我很抱歉没有处理对齐问题，但这只是一个简单的概念证明。

```
#include <iostream>
#include <cstdlib>

class pool;

template<typename T, pool& H>
class reference;

class pool {
private:
 pool(const pool&);
 pool& operator=(const pool&);

 const pool* operator&() const;
 pool* operator&();

 size_t size; 
 void *storage;

 size_t tag;

public:
 pool() : size(0), storage(0) { }
 ~pool() { free(storage); }

template<typename, pool&> friend class reference;
template<typename T, pool& H> friend reference<T, H> allocate();
};

template<typename T, pool &H>
class reference {
private:
 reference();

 size_t index;

 reference(size_t _index) : index(_index) { }

public:
 friend class pool;

 void set(const T& rvalue) const {
  *((T*)&((char*)H.storage)[index]) = rvalue;
 }

 T operator*() const {
  return *((T*)&((char*)H.storage)[index]);
 }

 reference<T, H>& operator++() {
  index += sizeof(T);
  return *this;
 }

template<typename U, pool& I> friend reference<U, I> allocate();
};

// TODO: Add in alignment stuff
template<typename T, pool& H>
reference<T, H> allocate() {
 const size_t old_size = H.size;

 H.size += sizeof(T);
 H.storage = realloc(H.storage, H.size);

 return reference<T, H>(old_size);
}

template<pool& H>
reference<char, H> get_line() {
 const reference<char, H> start = allocate<char, H>();
 reference<char, H> end = start;

 char input;

 for (;;) {
  input = std::cin.get();

  if ('\n' == input) {
   break;
  }

  end.set(input);
  end = allocate<char, H>();
 }

 end.set('\0');

 return start; 
}

template<pool &H>
std::ostream& operator <<(std::ostream& out, reference<char, H> start) {
 for (; *start != '\0'; ++start)
  std::cout.put(*start);

 return out;
}

pool input_pool;

int main(int argc, char **argv) {

 std::cout << "What is your name?" << std::endl;

 const reference<char, input_pool> input_string = get_line<input_pool>();

 std::cout << "Hello " << input_string << "!" << std::endl;

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T04:21:06.213

我不确定这是否对您有帮助，但以下编译：

```
class pool {};

template<pool& H>
class reference {
};

struct pools {
  static pool hopefullyStaysInCache;
  static pool hopefullyStaysInMemory;
  static pool canSwapOutToDisk;
};

main(){
  reference<pools::hopefullyStaysInMemory> y;
} 
```

您可以确保不会过早删除池，因为它们永远不会被删除。可以删除池的存储，使其足够小以至于您可能不介意保留它，并且您可以在池中的最后一个引用被销毁时自动进行删除。

# jsf-2 - 自定义 ViewHandler 以覆盖 javax.faces.viewstate 隐藏字段值

> ID：13534853
> 
> 赞同：1
> 
> 时间：2012-11-23T19:32:47.640
> 
> 标签：jsf-2

我们可以在页面渲染之前更改 inputHidden 字段“javax.faces.viewState”的值吗？

对于领域

该值应更改为不同的长度值。这可以通过使用自定义 viewHandler 来完成吗？

我们可以通过将类扩展为 ResponseWriter 来实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T18:45:38.333

该字段由您从当前渲染工具包中获得的 ResponseStateManager 渲染。

如果您查看它的 API，您会发现您不能只覆盖该字段的值。你必须更换整个东西！由于状态保存非常复杂（考虑服务器和客户端算法），我会三思而后行。

另一种方法是使用 Servlet 过滤器来捕获整个响应。隐藏字段的名称是标准化的，您可以对其进行搜索和替换。对于回发，您可以使用相同的过滤器来恢复参数。

# iphone - XCode 4.5 iOS6 无法实例化视图控制器

> ID：13534860
> 
> 赞同：0
> 
> 时间：2012-11-23T19:33:49.363
> 
> 标签：iphone, ios, xcode, ios6, xcode4.5

我将我的设备升级到 iOS 6，所以我不得不将 XCode 从 4.3.3 升级到 4.5.2，现在我的应用程序无法运行，而之前它运行良好（即升级之前）。问题是视图没有被实例化。此行没有被执行：

```
in Home.h
#import "ViewController_Album.h"
...
@class ViewController_Album;
...
@interface Home
...
@property (nonatomic, retain) ViewController_Album *viewAlbum;
...

in Home.m

@synthesize viewAlbum;
...
...
    - (void)viewDidLoad {
        self.viewAlbum = (ViewController_Album *) [((com_AppDelegate *) [[UIApplication sharedApplication] delegate]).storyboard instantiateViewControllerWithIdentifier:@"ViewController_Album"];
        NSLog(@"call album.initview");
        [self.viewAlbum initializeView];

    } 
```

在故事板中

![在此处输入图像描述](../Images/b9102dcba0a92cda01198ca06ef9327d.png) ![在此处输入图像描述](../Images/eb5b9e11e2e2b78f78c7bf2c4cbc83bc.png)

我已将“故事板 ID”（这是新的）和“标题”都设置为 ViewController_Album。所以它应该工作！但是，我看到 [self.viewAlbum initializeView] 没有被调用（因为我尝试在此方法中使用 print 语句并且它们都没有被打印）。所以应该是因为 viewAlbum 没有被实例化！为什么？然而，这适用于应用程序中的其他几个页面（我使用相同的代码来实例化它们，即使升级后它们也能正常工作！）

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:05:29.327

我发现了问题；看起来主页的 viewDidLoad 甚至在 AppDelegate 的“didfinishLaunchingWithOptions”完成之前就被调用了！所以，我在 didfinishLaunchingWithOptions 中进行了情节提要初始化，所以它不起作用！现在，我将代码移至 viewWillAppear()。现在，它工作正常！

# c# - 多选和不同的动作

> ID：13534861
> 
> 赞同：0
> 
> 时间：2012-11-23T19:33:59.967
> 
> 标签：c#, asp.net-mvc

我正在一个具有 Person 模型的项目中工作。我用表格显示索引操作中的人员，显示允许选择多个人员的复选框。

用户应该能够对选定的人做不同的事情，比如：

1.  批准他们访问。
2.  发送电子邮件。

批准他们访问的行为只是进行数据库更改。“发送电子邮件”的操作应重定向到另一个页面，该页面将请求电子邮件的详细信息，以便可以发送。

到目前为止，我们在表单中有一个包含人员的表格。该表单发布到一个操作，我能够检索选定的 ID。到现在为止还挺好。

我的问题是我希望表单动态发布到不同的路线（如果用户单击操作以“批准”用户去一个地方，如果用户单击操作以“发送电子邮件”去另一个地方）。

我一直无法找到如何动态修改表单操作以在运行时发布到不同的 Url。有没有办法做到这一点？（或者也许我做错了，我应该以某种方式用 jQuery 收集 ID 并发布到我想要的 Urls）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:49:13.643

您需要做的是更改（在客户端，使用 javascript）表单元素的“action”属性：

```
var url = ...
$("form").attr("action", url); 
```

# android - 找不到源调试android eclipse

> ID：13534864
> 
> 赞同：0
> 
> 时间：2012-11-23T19:34:18.903
> 
> 标签：android, eclipse

我正在调试这个功能：

```
public int colorIntWithAlpha(int color){
  String colorStr;
  colorStr=Integer.toHexString(color);
  char[] strChar=colorStr.toCharArray();
  colorStr=String.valueOf(strChar,0,6);
  colorStr+="FF";
  return Integer.decode(colorStr);
} 
```

当它到达时，`colorStr=Integer.toHexString(color);`我收到一条消息：

```
Class File Editor
Source not found 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:30:46.333

问题是您试图显示 Java JDK 函数的源代码，而 Eclipse 没有找到它。如果您想在调试时进入 Android SDK 功能，请查看[这篇文章](https://stackoverflow.com/questions/426084/how-do-i-view-jres-source-code-in-eclipse)和[这篇文章（现在您可以使用 Android SDK Manager 下载 Android 源代码。](http://android.opensourceror.org/2010/01/18/android-source/)

# data-mining - 集群二进制数据

> ID：13534866
> 
> 赞同：0
> 
> 时间：2012-11-23T19:34:24.500
> 
> 标签：data-mining, binary-data, mahout

我有一个带有 BINARY 用户/项目特征矩阵的大型数据集：

1.  我需要对用户和项目进行聚类。无论如何在 Mahout 中同时执行它们吗？
2.  更重要的是，如果我使用对数似然作为相似性度量，哪些聚类算法实际上会支持这种距离度量来聚类数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:20:03.730

不，用户和项目的聚类是单独的过程。虽然在精神上它是完全相同的过程，只是应用了两种不同的方式。

如果您想在 Mahout 中获得更具体的答案，则必须详细说明您正在使用的代码的哪些部分，因为有几个不同的部分涉及集群。

项目中有一些凝聚聚类部分，适用于任何相似性度量。我知道的其他实现肯定是“k-means”种类，假设一个连续的向量空间而不是超过 {0,1} 的向量。我认为你需要一种 k-medoids 算法，而这不在我所知道的项目中。

# javascript - Nodejs Mongoose - TypeError：无效的排序（）参数

> ID：13534867
> 
> 赞同：2
> 
> 时间：2012-11-23T19:34:27.330
> 
> 标签：javascript, node.js, mongodb, express, mongoose

嗨，我正在尝试运行我的程序，但是当我尝试在浏览器中连接到 localhost 时，每次都会出现以下错误。我认为我的排序或查询有问题，但我不确定它到底哪里出错了。任何人都可以帮助修复我的代码吗？app.js 代码是否也正确，我觉得那里也可能有错误..？欢迎任何帮助！:)

```
Express
500 TypeError: Invalid sort() argument. Must be a string or object.
at Query.sort (C:\nodeapps\nodeblox\node_modules\mongoose\lib\query.js:1167:11)
at Function.Post.statics.getAll (C:\nodeapps\nodeblox\schemas\Post.js:44:9)
at module.exports.app.post.username (C:\nodeapps\nodeblox\routes\index.js:45:10)
at callbacks (C:\nodeapps\nodeblox\node_modules\express\lib\router\index.js:160:37)
at param (C:\nodeapps\nodeblox\node_modules\express\lib\router\index.js:134:11)
at pass (C:\nodeapps\nodeblox\node_modules\express\lib\router\index.js:141:5)
at Router._dispatch (C:\nodeapps\nodeblox\node_modules\express\lib\router\index.js:169:5)
at Object.router (C:\nodeapps\nodeblox\node_modules\express\lib\router\index.js:32:10)
at next (C:\nodeapps\nodeblox\node_modules\express\node_modules\connect\lib\proto.js:190:15)
at Object.methodOverride [as handle] (C:\nodeapps\nodeblox\node_modules\express\node_modules\connect\lib\middleware\methodOverride.js:37:5) 
```

这是我认为导致问题的 2 个架构

Post.js

```
'use strict';

var util = require('util');
var mongoose = require('mongoose');
var Schema = mongoose.Schema;

var validatePresenceOf = function(value){
  return value && value.length; 
};

var toLower = function(string){
  return string.toLowerCase();
};

var getId = function(){
  return new Date().getTime();
};

/**
  * The Post schema. we will use timestamp as the unique key for each post
  */
var Post = new Schema({
  'key' : {
    unique : true,
    type : Number,
    default: getId
  },
  'subject' : { type : String,
                validate : [validatePresenceOf, 'Subject is Required']
              },
  'content' : {type : String},
  'author': String,
  'tags' : {
            type : String,
            set : toLower
           }
});

/**
  * Get complete post details for all the posts
  */
Post.statics.getAll = function(cb){
  var query = this.find({});
  query.sort('key', -1);
  return query.exec(cb);
};

/**
  * Get only the meta information of all the posts.
  */
Post.statics.getAllMeta = function(cb){
  return this.find({}, ['key','subject', 'author', 'tags'], cb);
};

Post.statics.findByKey = function(key, cb){
  return this.find({'key' : key}, cb);
};

module.exports = mongoose.model('Post', Post); 
```

用户.js

```
'use strict';

var util    = require('util');
var bcrypt  = require('bcrypt');
var mongoose = require('mongoose');
var Schema   = mongoose.Schema;

var validatePresenceOf = function(value){
  return value && value.length; 
};

var toLower = function(string){
  return string.toLowerCase();
};

var getId = function(){
  return new Date().getTime();
};

var User = new Schema({
  'key' : {
    unique : true,
    type : Number,
    default: getId
  },
  'username' : { type : String, 
              validate : [validatePresenceOf, 'a Username is required'],
              set : toLower,
              index : { unique : true }
              },
  'password' : String,
});

User.statics.findUser = function(username, cb){
  return  this.find({'username' : username}, cb);
};

User.statics.validateUser = function(username, password, cb){
  this.find({'username' : username}, function(err, response){
    var user = response[0];
    if(!user || response.length === 0){
      cb(new Error('AuthFailed : Username does not exist'));
    }else{
      if(password == user.password){
        util.log('Authenticated User ' + username);
        cb(null, user);
      }else{
        cb(new Error('AuthFailed : Invalid Password'));
      }
    }
  });
};

module.exports = mongoose.model('User' , User); 
```

最后是我的 app.js

```
'use strict'

/**
 * Module dependencies.
 */
var express = require('express');
var util    = require('util');
var Logger = require('devnull');
var logger = new Logger({namespacing : 0});
var mongoose = require('mongoose');
var http = require('http');
var app  = express();

mongoose.connect('mongodb://localhost/testdb');

/**
  * Application Configuration
  */
app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.enable('jsonp callback');
  app.set('view engine', 'jade');
  app.set('view options', {layout : false});
  app.use(express.bodyParser());
  app.use(express.cookieParser());
  app.use(express.session({
    secret : 'devadotD'      
  }));
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
  app.use(function(req, res, next){
    res.locals.session = req.session;
    next();
  });
});

/**
  * Application environment(s) Configuration
  */
app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); 
});

app.configure('stage', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); 
});

app.configure('production', function(){
  app.use(express.errorHandler()); 
});

// Routes
require('./routes')(app);

http.createServer(app).listen(app.get('port'), function(){
  util.log("Express server listening on port " + app.get('port'), app.settings.env);
  logger.log("Express server listening on port " + app.get('port'), app.settings.env);
});

module.exports = app; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T20:51:32.993

您很可能使用的 mongoose 版本比您编写的代码要新。该`.sort()`方法已更新，现在它接受如下参数，用于降序：

`query.sort('-key');`

或者你可以使用这个版本：

`query.sort({key: -1});`

无论您使用哪个，您的都是过时的。请参阅[最新文档](http://mongoosejs.com/docs/api.html#query_Query-sort)。

# magento - 特定类别布局更新，自定义产品集合 - 缺少工具栏？

> ID：13534876
> 
> 赞同：0
> 
> 时间：2012-11-23T19:35:37.933
> 
> 标签：magento, layout, toolbar, categories

在 local.xml 中，我创建了一个布局更新，以便我可以显示自定义过滤的产品集合。

这是在 local.xml 中：

```
<CATEGORY_7>
        <block type="catalog/category_view" name="category.products" template="catalog/category/view.phtml">
            <block type="catalog/product_list" name="product_list" template="catalog/product/cashcrop.phtml">
                <block type="catalog/product_list_toolbar" name="product_list_toolbar" template="catalog/product/list/toolbar.phtml">
                    <block type="page/html_pager" name="product_list_toolbar_pager"/>
                </block>
                <action method="addColumnCountLayoutDepend"><layout>empty</layout><count>6</count></action>
                <action method="addColumnCountLayoutDepend"><layout>one_column</layout><count>5</count></action>
                <action method="addColumnCountLayoutDepend"><layout>two_columns_left</layout><count>4</count></action>
                <action method="addColumnCountLayoutDepend"><layout>two_columns_right</layout><count>4</count></action>
                <action method="addColumnCountLayoutDepend"><layout>three_columns</layout><count>3</count></action>
                <action method="setToolbarBlockName"><name>product_list_toolbar</name></action>
                <action method="setColumnCount"><columns>4</columns></action>

            </block>
        </block>
</CATEGORY_7> 
```

模板文件是 list.phtml 的副本，但经过修改以过滤集合：

```
<?php
    $_productCollection = Mage::getModel('catalog/product')->getCollection();
    //$_productCollection=$this->getLoadedProductCollection();
    $_productCollection
    ->addAttributeToSelect('*')
    //->addAttributeToFilter('status', 1)
    //->addAttributeToFilter('visibility', 4)
    ->addAttributeToFilter('randament', array('in' => array(101, 102)))
    ->load()
    ;
    $this->setCollection($_productCollection);
    $_helper = $this->helper('catalog/output');
?> 
```

这行得通，我在集合中获得了 105 种产品。**问题是工具栏 - 它没有被显示**。有谁知道为什么工具栏没有显示？（我知道这`<?php echo $this->getToolbarHtml(); ?>`会返回一个空字符串，但我不明白为什么。

任何帮助表示赞赏。

干杯，迈克尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T11:40:56.990

其实，我自己想通了。覆盖模板没问题，放在类别的自定义布局更新部分就足够了；无需将其放在 local.xml 中。

问题在于 Mage/Catalog/Block/Product/List.php 中的 _beforeHtml() 函数，其中工具栏由块的 _getProductCollection() 函数初始化，该函数总是返回一个空集合，因为它试图获取当前类别的产品集合。

因此，作为一个快速而肮脏的修复，我只是从 _beforeHtml() 函数中复制了代码，并将其直接插入到我的 cashcrop.phtml 模板中。模板的顶部现在看起来像这样：

```
<?php
    $_productCollection = Mage::getModel('catalog/product')->getCollection();
    $_productCollection->addAttributeToSelect('*')
                        ->addAttributeToFilter('randament', array('in' => array(101, 102)))
                        ->addAttributeToFilter('inflorire', array('in' => array(97)))
                        ->addMinimalPrice()
                        ->addFinalPrice()
                        ->addTaxPercents();

    Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($_productCollection);
    Mage::getSingleton('catalog/product_visibility')->addVisibleInCatalogFilterToCollection($_productCollection);

    $_helper = $this->helper('catalog/output');

    $toolbar = $this->getToolbarBlock();
    $collection = $_productCollection;

    // use sortable parameters
    if ($orders = $this->getAvailableOrders()) {
        $toolbar->setAvailableOrders($orders);
    }
    if ($sort = $this->getSortBy()) {
        $toolbar->setDefaultOrder($sort);
    }
    if ($dir = $this->getDefaultDirection()) {
        $toolbar->setDefaultDirection($dir);
    }
    if ($modes = $this->getModes()) {
        $toolbar->setModes($modes);
    }

    // set collection to toolbar and apply sort
    $toolbar->setCollection($_productCollection);

    $this->setChild('toolbar', $toolbar);
    Mage::dispatchEvent('catalog_block_product_list_collection', array(
        'collection' => $_productCollection
    ));

    $_productCollection->load();
?> 
```

我知道这可能不是理想的解决方案，但它正在工作。如果其他人有更好的解决方案，我很想听听。

干杯，迈克尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:05:56.637

您不需要重新初始化所有内容。试试这个，看看它是否有效：

```
<CATEGORY_7>
    <reference name="product_list">
        <action method="setTemplate">
            <tpl>catalog/product/cashcrop.phtml</tpl>
        </action>
    </reference>
</CATEGORY_7> 
```

另外，我会警惕在脚本或布局文件中使用自动增量数据。我倾向于将它放在数据库中类别的布局更新中。可能与您的环境无关，但 7 是存储后端的任意功能，而不是更有意义的东西，例如类别名称。

# android - 在 Android 应用程序中连接到网站并检索 html

> ID：13534878
> 
> 赞同：-3
> 
> 时间：2012-11-23T19:35:46.253
> 
> 标签：android, http, url, connect

我正在尝试连接到 Android 中的 URL 地址以获取 HTML 代码。我正在关注本[教程](http://www.vogella.com/articles/AndroidNetworking/article.html#http_urlconnection)。调用 readStream 函数时出现错误。这是日志中的错误输出：

```
11-23 20:24:22.572: W/WindowManager(151): Failure taking screenshot for (246x437) to layer 21010
11-23 20:24:23.122: W/System.err(698): android.os.NetworkOnMainThreadException
11-23 20:24:23.133: W/System.err(698):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
11-23 20:24:23.133: W/System.err(698):  at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
11-23 20:24:23.133: W/System.err(698):  at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
11-23 20:24:23.133: W/System.err(698):  at java.net.InetAddress.getAllByName(InetAddress.java:214)
11-23 20:24:23.133: W/System.err(698):  at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
11-23 20:24:23.142: W/System.err(698):  at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
11-23 20:24:23.142: W/System.err(698):  at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:341)
11-23 20:24:23.142: W/System.err(698):  at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
11-23 20:24:23.153: W/System.err(698):  at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
11-23 20:24:23.153: W/System.err(698):  at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
11-23 20:24:23.153: W/System.err(698):  at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnection(HttpsURLConnectionImpl.java:461)
11-23 20:24:23.153: W/System.err(698):  at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:433)
11-23 20:24:23.162: W/System.err(698):  at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
11-23 20:24:23.162: W/System.err(698):  at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
11-23 20:24:23.162: W/System.err(698):  at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:273)
11-23 20:24:23.162: W/System.err(698):  at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:168)
11-23 20:24:23.162: W/System.err(698):  at libcore.net.http.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:271)
11-23 20:24:23.172: W/System.err(698):  at com.example.seminarska.Prevozi.onCreate(Prevozi.java:53)
11-23 20:24:23.172: W/System.err(698):  at android.app.Activity.performCreate(Activity.java:5008)
11-23 20:24:23.172: W/System.err(698):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
11-23 20:24:23.172: W/System.err(698):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
11-23 20:24:23.172: W/System.err(698):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
11-23 20:24:23.182: W/System.err(698):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
11-23 20:24:23.182: W/System.err(698):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
11-23 20:24:23.182: W/System.err(698):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-23 20:24:23.194: W/System.err(698):  at android.os.Looper.loop(Looper.java:137)
11-23 20:24:23.194: W/System.err(698):  at android.app.ActivityThread.main(ActivityThread.java:4745)
11-23 20:24:23.203: W/System.err(698):  at java.lang.reflect.Method.invokeNative(Native Method)
11-23 20:24:23.212: W/System.err(698):  at java.lang.reflect.Method.invoke(Method.java:511)
11-23 20:24:23.212: W/System.err(698):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-23 20:24:23.212: W/System.err(698):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-23 20:24:23.223: W/System.err(698):  at dalvik.system.NativeStart.main(Native Method) 
```

下面的代码是我正在使用的代码。

```
try {
  URL url = new URL("http://www.vogella.com");
  HttpURLConnection con = (HttpURLConnection) url
    .openConnection();
  readStream(con.getInputStream());
  } catch (Exception e) {
  e.printStackTrace();
}

private void readStream(InputStream in) {
  BufferedReader reader = null;
  try {
    reader = new BufferedReader(new InputStreamReader(in));
    String line = "";
    while ((line = reader.readLine()) != null) {
      System.out.println(line);
    }
  } catch (IOException e) {
    e.printStackTrace();
  } finally {
    if (reader != null) {
      try {
        reader.close();
      } catch (IOException e) {
        e.printStackTrace();
        }
    }
  }
} 
```

有什么想法有什么问题吗？是否有不同的方式连接到网络。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:41:14.250

您收到此错误是因为您正在执行网络操作，例如在主 UI 线程上检索 HTML。

要以最佳方式修复它，请将所有与网络相关的代码移动到单独的[Thread](http://developer.android.com/reference/java/lang/Thread.html)或[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)

# scala - sbteclipse 附加源文件夹

> ID：13534879
> 
> 赞同：4
> 
> 时间：2012-11-23T19:35:52.933
> 
> 标签：scala, sbt, sbteclipse

如何为 sbteclipse 配置一个额外的文件夹以包含？我有一个默认的 sbt 目录布局和一个额外的 it/scala 文件夹。我希望该文件夹包含在生成的 .project 和 .classpath 文件中，但我不知道该怎么做......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T05:47:05.127

例如，您可以通过在您的 中添加以下内容来实现此目的`build.sbt`：

```
unmanagedSourceDirectories in Compile <++= baseDirectory { base =>
  Seq(
    base / "some/subdir/src"
  )
} 
```

有关两者之间关系的详细信息，`unmanaged-sources`您可能需要查看[文档](http://www.scala-sbt.org/release/docs/Detailed-Topics/Classpaths.html)。从 sbt 导出 eclipse 项目后，您应该在文件中找到相应的条目，例如：`unmanaged-source-directories``scala-source``.classpath`

```
 <classpathentry output="target/scala-2.9.1/classes" path="some/subdir/src" kind="src"></classpathentry> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T18:17:57.483

在某些情况下，您可能只想将文件夹说**conf**添加到包含运行时所需配置的 eclipse 类路径中。下面是诀窍——

```
unmanagedJars in Compile ++= {
    val confBase = (baseDirectory.value ** "conf")
    confBase.classpath
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-11T18:56:56.877

如果你想添加，例如，文件夹`src/folderXYZ`，然后添加到`build.sbt`：

```
Compile / unmanagedSourceDirectories += baseDirectory.value / "src/folderXYZ" 
```

# variables - DOS 批处理文件 - 根据文件名元素复制文件

> ID：13534883
> 
> 赞同：1
> 
> 时间：2012-11-23T19:36:22.153
> 
> 标签：variables, batch-file, dos, filenames

我需要根据文件名对很多文件进行排序。我想用一个批处理文件来做。我确实知道我想要什么，但我不确定正确的语法。

我使用的文件名示例：（它们最初都在同一个目录中）

```
2012_W34_Sales_Store001.pdf  
2012_W34_Sales_Store002.pdf  
2012_W34_Sales_Store003.pdf  

2012_November_Sales_Store001.pdf  
2012_November_Sales_Store002.pdf  
2012_November_Sales_Store003.pdf 
```

我想提取位于“_”符号之间的信息，并每次将它们放入不同的变量中。_ 符号之间包含的信息的长度每次都会不同。

```
Example:
var1="2012"
var2="W34" (or November)
var3="Sales"
var4="001" 
```

如果我能够做到这一点，然后我可以使用将文件复制到适当的目录

```
move %var1%_%var2%_%var3%_%var4%.pdf z:\%var3%\%var4%\%var1%\%var2% 
```

它需要循环，因为我有 Store001 到 Store050。此外，不仅有销售报告，还有许多其他报告。

我希望我很清楚。

请帮我实现这个批处理文件！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:53:43.027

该脚本将根据下划线之间的值将您的文件移动到类似的构造路径。

```
for %%f in (*.pdf) do call :handlefile %%f

:handlefile
set pad=z:
for /f  "delims= tokens=1,* " %%a in ("%1") do call :step %%a %%b
rem this MOVES the file, maybe use echo first for testing
move "%fn%" "%pad%"
exit /B

:step
if !%2!==!! EXIT /B
set pad=%pad%\%1
for /f  "delims=_ tokens=1,* " %%a in ("%2") do call :step %%a %%b
EXIT /B 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:15:54.417

此脚本将确保它仅尝试移动符合模式 part1_part2_part3_part4.pdf 的文件

```
@echo off
for /f "eol=_ delims=" %%F in (
  'dir /b *^|findstr /ix "[^_]*_[^_]*_[^_]*_[^_]*[.]pdf'
) do for /f "eol=_ tokens=1-4 delims=_." %%A in ("%%F") do (
  move "%%F" "z:\%%C\%%D\%%A\%%B"
) 
```

如果需要，您可以`md "z:\%%C\%%D\%%A\%%B" 2>nul`在 MOVE 之前添加，以防文件夹可能尚不存在。

# html - 背景图像拉伸 100% 高度的 Div

> ID：13534884
> 
> 赞同：19
> 
> 时间：2012-11-23T19:36:23.300
> 
> 标签：html, css

我有一个容器，它会根据在其中动态放置多少文本而增加/缩小高度。容器将有一个背景图像，当容器改变高度时需要拉伸/收缩，并且该图像不能以任何方式裁剪。我想知道如何`.container`设置背景图像以保持 100% 的 div。

我尝试了以下方法，但似乎没有用：

```
.container { background: url('backgroundImage.jpg') 0 100% no-repeat; } 
```

HTML结构示例：

```
<div class="container">
  <p class="text">This is a short container</p>
</div>

<div class="container">
  <p class="text">This<br> is<br> a<br> tall<br> container</p>
</div> 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-23T19:40:36.753

您需要设置`background-size`属性。 `background-size: 100% 100%;`将缩放它以水平和垂直填充容器。

我通常更喜欢`background-size: cover;`它，因为它可以根据需要优雅地放大图像，保持纵横比。确保检查对背景大小的[支持](http://caniuse.com/background-img-opts)，因为它是一个相当新的属性。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-08-02T13:02:20.680

如果`background-size: contain;`没有帮助，并且如果您正在寻找完整的 HEIGHT 背景图像而不丢失宽高比，请使用下面的 CSS

```
background-size: auto 100%; 
```

将第一个参数设置为“ **auto** ”将确保图像保持宽度与当前高度的比率。第二个参数“ **100%** ”将帮助背景图像适应与 DIV 相同的高度。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-23T19:40:05.873

你试过了`background-size: cover;`吗？

在您的示例中，您正在调整`background-position`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-23T19:46:21.330

css3 中有一个属性叫做 background-size:cover; 和背景大小：包含；。您可能想使用`background-size:cover;`来满足您的需要。

**`contain`

> 指定背景图像应尽可能缩放，同时确保其尺寸小于或等于背景定位区域的相应尺寸。

```
cover 
```

> 指定背景图片在保证两个尺寸都大于或等于背景定位区域对应尺寸的情况下，应尽可能缩小。

**

# visual-studio-2012 - 构建签入策略与私人门控签入

> ID：13534896
> 
> 赞同：3
> 
> 时间：2012-11-23T19:37:33.787
> 
> 标签：visual-studio-2012, continuous-integration, tfsbuild, gated-checkin

使用视觉工作室 2012 和 tfs 2012。

“构建”签入政策和门控签入之间有什么区别？他们似乎都需要成功构建才能签入。

它们两者的优点和缺点是什么？

应该优先使用一个还是可以/应该一起使用它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T07:10:46.200

**注意：以下答案实际上应该指的是不同的策略（请参阅评论），如果构建被破坏，构建策略会阻止您签入，如果您还使用门控签入，则永远不会发生这种情况。这意味着两者兼而有之几乎没有什么好处。**

构建签入策略要求您在签入之前在您的机器上构建代码。

门控签入搁置您的更改并运行 tfs 构建服务器构建（以及其他任何东西，如单元测试等），然后如果构建通过搁置集并合并到源代码控制中。如果构建失败，您会收到一个弹出窗口，需要在提交任何代码之前修复问题。

使用签入策略仍然可能会错过签入中的文件，这意味着它不会为其他开发人员构建。门控签入保证了源代码控制构建中的内容。

因为签入策略使用您的框进行构建，所以它不会对构建服务器造成太大压力，如果您没有资源来运行足够的构建服务器来进行短队列，这可能是一个好处。在门控签入之前有一个签入策略应该有助于减少浪费您的服务器时间的失败构建的数量。因此，启用两者都有好处。

如果您的构建服务器过载，则门控签入可能会延迟其他开发人员在等待构建发生时访问代码。

# matlab - 如何使用代码（MATLAB）在矩阵/excel电子表格中添加零行？

> ID：13534897
> 
> 赞同：-1
> 
> 时间：2012-11-23T19:37:33.263
> 
> 标签：matlab, add, rows, spreadsheet

我制作了这个程序，用户可以输入 2009 年到 2011 年之间的一年，并在图表上显示所选年份的雪深和气温数据。

我有一个 xls 文件记录从第 1 天到第 365 天的每一天的温度。我还有另一个 xls 文件记录从第 1 天到第 212 天的雪深。所以有些日子他们懒得测量雪深，因为那是夏天无论如何。在 4 月 30 日至 10 月 1 日期间，他们没有测量雪深。我想添加 153 个零，代码介于 4 月 30 日和 1 月 1 日之间，所以它加起来是 365 天。

第 121 天 = 30\. 四月

下载空气温度 xls：[https ://dl.dropbox.com/u/11241083/airtemp2009_2011.xls](https://dl.dropbox.com/u/11241083/airtemp2009_2011.xls)

下载雪深xls：[https ://dl.dropbox.com/u/11241083/snow2009_2011.xls](https://dl.dropbox.com/u/11241083/snow2009_2011.xls)

这是到目前为止的代码：

```
chosenyear = input('Type in year: ');
snowdepth = xlsread('snow2009_2011.xls');
snowdepth2009 = snowdepth(:,1);
snowdepth2010 = snowdepth(:,2);
snowdepth2011 = snowdepth(:,3);
airtemp = xlsread('airtemp2009_2011.xls');
airtemp2009 = airtemp(:,1);
airtemp2010 = airtemp(:,2);
airtemp2011 = airtemp(:,3);
if chosenyear == 2009
    figure(1);
    plot(snowdepth2009, 'b');
      title(['Snowdepth/airtemp ' num2str(chosenyear)]);
      xlabel('Days/months');
      ylabel('data');
      grid on
      datetick('x','m');
      hold on
      plot(airtemp2009, 'r');
      legend('snow depth in cm','air temp in Celsius');
elseif chosenyear == 2010
    figure(2);
    plot(snowdepth2010, 'b');
      title(['Snowdepth/airtemp ' num2str(chosenyear)]);
      xlabel('Days/months');
      ylabel('data');
      grid on
      datetick('x','m');
      hold on
      plot(airtemp2010, 'r');
      legend('snow depth in cm','air temp in Celsius');
elseif chosenyear == 2011
    figure(3);
    plot(snowdepth2011, 'b');
      title(['Snowdepth/airtemp ' num2str(chosenyear)]);
      xlabel('Days/months');
      ylabel('data');
      grid on
      datetick('x','m');
      hold on
      plot(airtemp2011, 'r');
      legend('snow depth in cm','air temp in Celsius');
else
    disp('NB! Type in 2009, 2010 or 2011');
    filename.m
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:51:21.030

尝试这个，

```
snowDepth_full = zeros(365,3); % make a temporary variable to hold everything
snowDepth_full(1:121,:)  = snowDepth(1:121,:);   % First 121 days up to april 30
snowDepth_full(end-90,:) = snowDepth(122:end,:); % Last 91 days from oct 1 on
snowDepth = snowDepth_full;  % Copy it back 
```

然后和以前一样...

```
snowdepth2009 = snowdepth(:,1);
snowdepth2010 = snowdepth(:,2);
snowdepth2011 = snowdepth(:,3);
... 
```

# flash - 对 Xbox 360 操纵杆的 Flash 支持

> ID：13534903
> 
> 赞同：1
> 
> 时间：2012-11-23T19:38:06.520
> 
> 标签：flash, adobe, xbox360, xbox

是否可以将 Xbox 360 控制器与最新的 Flash 播放器一起使用？如果是这样，我在哪里可以找到示例源代码？

如果需要第三方实用程序，我宁愿使用免费的东西。

我也有兴趣在浏览器中使用控制器 - 这可能吗？

# wordpress - 将 Wordpress 页面的标题设为只读

> ID：13534906
> 
> 赞同：3
> 
> 时间：2012-11-23T19:38:28.033
> 
> 标签：wordpress

我正在寻找一个 WP 函数，它将只读参数添加到所有页面的标题的输入中，这将使页面的标题不可更改。

提前非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T19:47:36.750

这可以通过一些简单的 JavaScript/jQuery 来完成。创建一个名为 admin_title_disable.js 的文件，并将其放入 functions.php 中。例如：

函数.php：

```
wp_register_script('admin_title_disable', '/path/to/admin_title_disable.js');
function disableAdminTitle () {
  wp_enqueue_script('admin_title_disable');
}
add_action('admin_enqueue_scripts', 'disableAdminTitle'); 
```

现在，在你的 js 文件中：

```
jQuery(document).ready(function ($) {
  $('#title').attr('disabled','disabled');
}); 
```

这将使用属性设置帖子和页面标题输入字段`disabled`。希望这可以帮助！

如果您想将此脚本限制为特定的管理页面，请将`add_action`挂钩包装在比较的条件中`$_GET['page']`。您还可以利用用于检查页面`$hook`时可用的参数。[见这里](http://codex.wordpress.org/Plugin_API/Action_Reference/admin_enqueue_scripts)。`admin_enqueue_scripts`

**更新：：**

WordPress 在帖子和页面编辑屏幕之间进行区分有点棘手，但是您可以利用隐藏的输入。:) 这是 jQuery 的更新版本，只能在页面编辑屏幕上运行：

```
jQuery(document).ready(function ($) {
  //find the hidden post type input, and grab the value
  if($('#post_type').val() === 'page'){
    $('#title').attr('disabled','disabled');
  }
 }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-04T15:48:20.560

无需制作单独的 js 文件。将此添加到您的 function.php 将执行与 Matthew 显示的相同的操作。

```
function admin_footer_hook(){
        ?>
    <script type="text/javascript">
        if(jQuery('#post_type').val() === 'post'){
    jQuery('#title').prop('disabled', true);
    }
    </script>
<?php
}
add_action( 'admin_footer-post.php', 'admin_footer_hook' ); 
```

# opengl - 在 OpenGL 中分离帧缓冲区和深度缓冲区

> ID：13534907
> 
> 赞同：1
> 
> 时间：2012-11-23T19:38:51.060
> 
> 标签：opengl, framebuffer, depth-buffer

在 DirectX 中，您可以拥有单独的渲染目标和深度缓冲区，因此您可以绑定渲染目标和深度缓冲区，进行一些渲染，移除深度缓冲区，然后使用旧的深度缓冲区作为纹理进行更多渲染。

你会如何在opengl中解决这个问题？据我了解，您有一个包含颜色缓冲区和可选深度缓冲区的帧缓冲区对象。我不认为我可以同时绑定多个帧缓冲区对象，我是否必须在每次帧缓冲区对象更改时重新创建它（可能是一帧几次）？普通的opengl程序如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T20:30:13.990

[帧缓冲区对象](http://www.opengl.org/wiki/Framebuffer_Object)只不过是对图像的一系列引用。这些可以是[纹理](http://www.opengl.org/wiki/Texture)中的图像（例如 2D 纹理的 mipmap 层）或[渲染缓冲区](http://www.opengl.org/wiki/Renderbuffer_Object)（不能用作纹理）。

没有什么能阻止你组装一个 FBO，它使用纹理图像作为颜色缓冲区，使用纹理图像作为[深度缓冲区](http://www.opengl.org/wiki/Image_Format#Depth_formats)。以后也没有什么可以阻止您（只要您在执行此操作时没有渲染到该 FBO）从纹理中采样作为深度纹理。FBO 不会突然独占这些图像或其他东西。

很可能，发生的事情是您误解了 FBO 和 OpenGL 的[Default Framebuffer](http://www.opengl.org/wiki/Default_Framebuffer)之间的区别。默认帧缓冲区（即：窗口）是不可更改的。您不能将*它的*深度缓冲区用作纹理或其他东西。你用 FBO 做什么是你自己的事，但是 OpenGL 不会让你以同样的方式使用它的默认帧缓冲区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:22:36.493

您可以将多个渲染目标绑定到单个 FBO，这应该是诀窍。此外，由于 OpenGL 是一个状态机，您可以随时更改绑定和目标数量。

# ruby-on-rails - 在 Ruby on Rails 中更改 Params[:id]

> ID：13534909
> 
> 赞同：1
> 
> 时间：2012-11-23T19:38:59.070
> 
> 标签：ruby-on-rails, ruby

我有一个 Ruby on Rails 应用程序，您可以在其中创建“帖子”。我首先使用脚手架生成器来生成作为字符串的标题和作为内容的正文。

每个'post'都有一个id的url，例如/1、/2、/3等。

有没有办法将其更改为生成一串随机字符和数字，例如 /49slc8sd、/l9scs8dl 等？

这是我所拥有的`posts_controller.rb`

```
class PostsController < ApplicationController
  # GET /posts
  # GET /posts.json
  def index
    @posts = Post.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @posts }
    end
  end

  # GET /posts/1
  # GET /posts/1.json
  def show
    @post = Post.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @post }
    end
  end

  # GET /posts/new
  # GET /posts/new.json
  def new
    @post = Post.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @post }
    end
  end

  # GET /posts/1/edit
  def edit
    @post = Post.find(params[:id])
  end

  # POST /posts
  # POST /posts.json
  def create
   @post = Post.new(params[:post])

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /posts/1
  # PUT /posts/1.json
  def update
    @post = Post.find(params[:id])

    respond_to do |format|
      if @post.update_attributes(params[:post])
        format.html { redirect_to @post, notice: 'Post was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /posts/1
  # DELETE /posts/1.json
  def destroy
    @post = Post.find(params[:id])
    @post.destroy

    respond_to do |format|
      format.html { redirect_to posts_url }
      format.json { head :no_content }
    end
  end
end 
```

这就是我在`post.rb`模型中所拥有的

```
class Document < ActiveRecord::Base
  attr_accessible :content, :name
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:20:44.057

如果您希望您的模型的主键 id 不以可预测的顺序排列，您可以借助[http://codesnipers.com/?q=using-uuid-guid-之类的工具根据 uuid 或 guid 生成 id作为轨道中的主键](http://codesnipers.com/?q=using-uuid-guid-as-primary-key-in-rails)

但是，如果您不想在路由中公开数据库标识符，您也可以基于唯一标识资源的任何其他属性进行路由，这是推荐的方法

```
person/:person_random_token, :controller => :persons, :action => :show #adding this in your route file directing to the controller where you can use params[:person_random_token] to uniquely identify your person object in Persons model 
```

在控制器的操作中，您可以说

```
Person.find_by_random_token(params[:person_random_token]) #assuming random_token is your column name 
```

获取 Person 对象

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:24:27.120

如果您想混淆数字 ID，可以查看[这个有趣的讨论](https://stackoverflow.com/questions/6622594/what-is-the-best-way-to-obfuscate-numerical-ids-in-an-application)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T08:46:45.403

您还应该了解 ActiveRecord::Base 对象的[to_param](http://apidock.com/rails/ActiveRecord/Base/to_param)方法。

基本上，Rails 在你的对象上调用这个方法来知道在 URL 和 params[:id] 中放入什么。默认情况下，它只是数据库中记录的主键。假设您这样覆盖它：

```
class Post < ActiveRecord::Base

  def to_param
    return id*100
  end

  def self.find_by_new_id(n)
    return self.find(n/100) # really you'd want to handle strings and integers
  end
end 
```

数据库中的第一条记录将具有 url `/posts/100`。

在您的控制器中，检索您刚刚执行的对象

```
@post = Post.find_by_new_id(params[:id]) 
```

（当然，您也可以覆盖默认`find`方法，但这可能会令人不悦。）基本上，该`to_param`方法会转换您的 id，而新的 finder 会撤消它。通常，您只需指向另一个在创建记录时已通过挂钩自动填充的数据库列。这就是 Qumara otBurgas 发布的链接中描述的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:59:44.933

不清楚你在这里问什么。路由中指定的操作的路径不需要传递的 id 为某种格式。如果您愿意，您可以传递非数字 id，并在您的操作中使用您喜欢的 id。也许如果您提供有关路线和操作的更多信息，我们可以理解您的要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T02:17:31.697

有[多种方法](https://stackoverflow.com/questions/88311/how-best-to-generate-a-random-string-in-ruby)可以在 Ruby 中生成随机字符串。

现在，到你问题的第二部分。如果你想使用类似的路由来访问你的帖子`/post/rndm5tr`，你可以简单地在你的控制器中更改这行代码：

```
@post = Post.find(params[:id]) 
```

至

```
@post = Post.find_by_randomness(params[:id]) 
```

现在，只需创建一个迁移：`rails g migration AddRandomnessToPost randomness:string`并运行`rake db:migrate`（或`bundle exec rake db:migrate`，取决于它的设置方式）。

当然，您可以随意命名该字段，`randomness`这只是我使用的随机名称。我认为常见的约定是称它们为蛞蝓或令牌，但我可能错了。

现在，在您的模型中添加一个方法以`before_create`生成随机字符串并将其添加到即将保存的`Post`对象中（使用上述链接中的示例之一）。检查您正在生成的字符串是否已经被使用是明智的（如果帖子已经具有随机标记，您可以编写一个递归方法再次调用自身）。

# delphi - TIdNotify 和 TIdSync 有什么区别？

> ID：13534911
> 
> 赞同：3
> 
> 时间：2012-11-23T19:39:00.787
> 
> 标签：delphi, indy10

我很难理解 IDSYNC 和 IDNOTIFY 之间的真正区别，就我编写的代码行而言，同步/异步意味着什么？

```
procedure TForm1.IdTCPServerExecute(AContext: TIdContext);
begin
    ....
    DoSomeThing (TIDNotify)    ....

    DoSomethingOther(TIDsync) ......

 end; 
```

为什么我不能确定这两行代码都在 TCPServer Execute 函数中执行？是否只有几行代码没有在我的 TIDSynfunction 中执行的风险，或者如何解释死锁？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-23T23:34:01.823

TIdSync 和 TIdNotify 实现了相同的目标——在主线程的上下文中执行一段代码——但它们以不同的方式完成。

`TIdSync`是同步的。该`TIdSync.Synchronize()`方法阻塞调用线程，直到主线程调用该`TIdSync.DoSynchronize()`方法并退出。`TIdSync.Synchronize()`如果在主线程关闭服务器时在服务器事件处理程序中调用，可能会发生死锁。这是因为主线程被阻塞等待服务器终止其线程。但是线程被阻塞等待主线程处理同步请求。

`TIdNotify`是异步的。该方法将该`TIdNotify.Notify()`方法添加`TIdNotify.DoNotify()`到后台队列中并立即退出，因此调用线程不会被阻塞。主线程`TIdNotify.DoNotify()`在空闲时调用该方法。在这种情况下没有僵局。

# android - AVD Manager 启动问题

> ID：13534918
> 
> 赞同：1
> 
> 时间：2012-11-23T19:39:58.670
> 
> 标签：android, avd, virtual-device-manager

我的 Android 虚拟设备管理器出现启动问题。Eclipse Juno 中的 AVD 管理器按钮在单击时不执行任何操作。我`AVD Manager.exe`在sdk文件夹中找到文件，发现点击的时候，弹出一个cmd窗口1秒，关闭，然后什么都没有。有人知道我的 AVD 管理器出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T15:02:23.217

我自己也遇到过同样的问题。似乎版本之间的 AVD 中一定发生了一些变化。

为了解决它，我进入`C:\Users\(username)\.android`文件夹并删除了`avd`和`cache`文件夹。（可能不需要删除两者，我没有进一步检查）

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T05:48:55.867

尝试安装更新版本的 JDK。我也有同样的问题。我将我的 JDK 从 5 升级到 7 并打开了 AVD 管理器:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:54:39.187

如果您尝试启动 SDK-Manager 会发生什么？是否有一个显示更新的打开窗口，或者这个窗口也会在一秒钟后关闭？

## 编辑

尝试在 sdk 管理器顶部打开“工具”。在那里您可以选择“管理 AVD”。它应该从这里开始，如果没有，那么安装 sdk 有问题。另一种可能性是，您的 CPU 速度非常慢。我有一个老宏基旅伴，它会持续两三分钟才能开始。还有一件事：java系统变量设置错误。这是关于这个问题的另一个线程：

[Android SDK 管理器无法打开](https://stackoverflow.com/questions/5199811/android-sdk-manager-wont-open)

# python - 如何从列表中删除特定对象，如果我不能使用它附加到的变量来查找它的索引？

> ID：13534920
> 
> 赞同：1
> 
> 时间：2012-11-23T19:39:59.270
> 
> 标签：python, list, object

我有这个函数可以创建一个 Ball 对象并将其附加到一个列表中：

```
list_of_balls = []

def create_new_ball():
    newball = Ball()
    list_of_balls.append(newball) 
```

我需要能够从该列表中删除 Ball 的特定实例。我不知道该怎么做。我不能使用 list_of_balls.index() 因为所有实例都附加到私有变量 newball。当我得到这样的列表时，会返回：

[< **main** .Foo 实例在 0x22149c>，< **main** .Foo 实例在 0x22111c>，< **main** .Foo 实例在 0x2209b4>，< **main** .Foo 实例在 0x22129c>]

所以我不知道如何瞄准特定的实例。

有没有办法从该列表中删除 Ball 的特定实例？每个 Ball 实例都需要能够将自己从列表中删除，但是该实例如何知道它在列表中的是谁和/或它的索引是什么？

编辑：我需要做的是在该列表（或字典或其他替代方法）中识别它们。我知道如何从列表中删除项目，但我不知道如何具体做到这一点。

我想做的正是 aList.remove() 所做的，但我没有一个变量可以用作参数，所以我需要一个替代方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:45:01.263

`list.remove`似乎工作正常：

```
>>> class Ball(object): pass
... 
>>> balls = [ Ball() for _ in range(10) ]
>>> balls
[<__main__.Ball object at 0xe5350>, <__main__.Ball object at 0xe52b0>, <__main__.Ball object at 0xe5250>, <__main__.Ball object at 0xe5370>, <__main__.Ball object at 0xe5390>, <__main__.Ball object at 0xe53b0>, <__main__.Ball object at 0xe53d0>, <__main__.Ball object at 0xe5410>, <__main__.Ball object at 0xe5430>, <__main__.Ball object at 0xe5450>]
>>> balls.remove(balls[4])
>>> balls
[<__main__.Ball object at 0xe5350>, <__main__.Ball object at 0xe52b0>, <__main__.Ball object at 0xe5250>, <__main__.Ball object at 0xe5370>, <__main__.Ball object at 0xe53b0>, <__main__.Ball object at 0xe53d0>, <__main__.Ball object at 0xe5410>, <__main__.Ball object at 0xe5430>, <__main__.Ball object at 0xe5450>]
>>> len(balls)
9 
```

真正的问题是您如何知道`Ball`要删除哪个？

根据评论，您似乎希望移除所有反弹 N 次的球：

```
to_remove = [x for x in balls if x.times_bounced > N]
for x in to_remove:
    balls.remove(x) 
```

或者，如果您不需要就地执行此操作，您可以创建一个包含未反弹 N 次的球的新列表：

```
balls = [ x for x in balls if x.times_bounced <= N ] 
```

最后，如果需要，您可以使用此惯用语和切片分配来完成整个工作：

```
balls[:] = [ x for x in balls if x.times_bounced <= N ] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T19:47:48.203

> 所以我不知道如何瞄准特定的实例。

您*需要*对如何识别实例有所了解；在这种情况下，您可以简单地将其转移到实际的工作方式中。例如，给他们一个名字或一个 ID。然后，您可以使用字典或其他东西。默认情况下，实例只能通过它们的确切身份来识别。

> 每个 Ball 实例都需要能够从列表中删除自己

```
>>> class Ball ():
        pass
>>> list_of_balls = []
>>> def create_new_ball():
        list_of_balls.append(Ball())
>>> def remove_yourself(ball):
        list_of_balls.remove(ball)
>>> for i in range(10): create_new_ball()
>>> list_of_balls
[<__main__.Ball object at 0x0000000002EB5E48>, <__main__.Ball object at 0x0000000002EBD908>, <__main__.Ball object at 0x0000000002EBDEB8>, <__main__.Ball object at 0x0000000002EBDE80>, <__main__.Ball object at 0x0000000002EBD978>, <__main__.Ball object at 0x0000000002ED41D0>, <__main__.Ball object at 0x0000000002ED4208>, <__main__.Ball object at 0x0000000002ED4240>, <__main__.Ball object at 0x0000000002ED4278>, <__main__.Ball object at 0x0000000002ED42B0>]
>>> one_ball = list_of_balls[4] # random ball, chosen by fair dice roll
>>> one_ball in list_of_balls
True
>>> remove_yourself(one_ball)
>>> one_ball in list_of_balls
False 
```

# sql-server - 列出引用特定表中特定列的所有外键约束

> ID：13534923
> 
> 赞同：1
> 
> 时间：2012-11-23T19:40:27.770
> 
> 标签：sql-server, foreign-keys

我想查看通过缺少 ON DELETE=CASCADE 设置的外键约束引用（直接或间接）“主”表中特定列的所有表和列的列表。

棘手的部分是，将有一个间接关系隐藏在多达 5 个级别的深度。（例如：...曾孙-> FK3 => 孙 => FK2 => 子 => FK1 => 主表）。我们需要挖掘叶表列，而不仅仅是第一层。关于这一点的“好”部分是执行速度不是问题，它将在生产数据库的备份副本上运行，以解决未来的任何关系问题。

我做到了`SELECT * FROM sys.foreign_keys`，但这给了我约束的*名称*- 而不是子父**表**的名称和关系中的**列**（多汁位）。另外，与我们下面的做法不同，之前的设计者对 FK 约束使用了简短的、非描述性/随机名称

我们在 SQL Server 中添加约束的方式：

```
ALTER TABLE [dbo].[UserEmailPrefs]  
WITH CHECK ADD  CONSTRAINT [FK_UserEmailPrefs_UserMasterTable_UserId] FOREIGN KEY([UserId])
REFERENCES [dbo].[UserMasterTable] ([UserId])
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[UserEmailPrefs] CHECK CONSTRAINT [FK_UserEmailPrefs_UserMasterTable_UserId]
GO 
```

[这个 SO question](https://stackoverflow.com/questions/13534428/preview-sql-delete-for-records-which-have-on-cascade-constraints#comment18532971_13534428)中的评论激发了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-08T17:56:47.323

A wiser version of myself stumbles upon a question from the curious, younger version of myself. The answer is

`EXEC sp_fkeys 'Users'`

Hoping me from +40 years drop by this week for some additional words of wisdom for the years ahead :)

# c# - 在 C# 中读取注册表项

> ID：13534931
> 
> 赞同：0
> 
> 时间：2012-11-23T19:42:06.057
> 
> 标签：c#, registry

我正在读取注册表项的值：

```
Microsoft.Win32.RegistryKey key;
key = *someLongPathHere*; 
```

并将值显示到标签：

```
string a = (string)key.GetValue("");//a default value
label1.Text = a; 
```

它显示：

```
{F241C880-6982-4CE5-8CF7-7085BA96DA5A} 
```

这大部分是正确的，除了第一个下划线，它存在于原始值中：

```
{_F241C880-6982-4CE5-8CF7-7085BA96DA5A} 
```

为什么会这样？即缺少下划线？

另外，读取密钥后，我是否必须关闭密钥或其他任何东西？我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T19:55:01.700

测试包含下划线的字符串值是否存在系统问题很容易。您可以简单地在注册表编辑器中创建这样一个值，然后使用`GetValue()`. 当您这样做时，您会发现 C# 注册表代码不会丢失下划线。因此，您的问题必须有其他解释。

我最好的猜测是您的标签组件不显示下划线。我对 C# UI 框架不是很熟悉，但这似乎是合理的。尝试查看`a`调试器下的值，而不是 UI 上的标签标题。

想到的另一件事是您有注册表重定向，因为您有一个在 x64 上运行的 x86 进程，并且您的密钥位于重定向密钥下，例如 HKLM\Software。也许如果您查看 Wow6432Node 下方，您会看到下划线的差异。

至于管理密钥的生命周期，密钥由未管理的资源支持。即一个 Windows `HKEY`。该类`RegistryKey`实现`IDisposable`，因此您应该将密钥包装在一个`using`语句中。

# c++ - r 值参考参数的正确默认值是多少？

> ID：13534932
> 
> 赞同：4
> 
> 时间：2012-11-23T19:42:21.443
> 
> 标签：c++, c++11, default-value, move-semantics, icc

假设我有一个接受 r 值参数的函数，并且我想提供一个默认值，我该如何正确指定它？以下内容适用于 gcc 4.7.0，但适用于 icpc 13.0.1。

```
struct data {
  int _data[10];
  data() = default;
  data(data&&) = default;
  data(const data&) = default;
};
void func(data&& = data{}); 
```

icpc抱怨说

```
error: type name is not allowed
void func(data&& = data{});
                   ^ 
```

这个对吗？什么是正确的语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T20:10:17.867

icpc 13.0.1 似乎不支持默认参数中的通用初始化语法。这有效：

```
void func(data&& = data());
                       ^^ value-initialization 
```

# linux - access.log 和服务器负载的大小？

> ID：13534934
> 
> 赞同：0
> 
> 时间：2012-11-23T19:43:06.907
> 
> 标签：linux, apache

将新行添加到大的和小的 access.log 文件时，服务器负载有什么不同吗？

我的意思是，如果我的 access.log 文件变得太大，我应该删除它们还是保留它。现在是6GB。我不旋转。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:49:26.503

我不确定大文件或小文件的性能差异，但也许您想每月拆分它们并压缩旧的访问日志文件。为此，您可以使用 logrotate。[手册页](http://linuxcommand.org/man_pages/logrotate8.html)中的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:38:38.803

日志轮换是维护服务器的重要组成部分。没有它，你可能会填满你的磁盘，然后你的服务器会表现得非常奇怪，具体取决于应用程序。

无论性能如何，您都应该使用`logrotate`或类似的东西。

# android - adb 卸载失败

> ID：13534935
> 
> 赞同：77
> 
> 时间：2012-11-23T19:43:12.223
> 
> 标签：android, adb

我正在编写一些示例应用程序。
调试这些应用程序后，我在设备的应用程序管理中看不到卸载按钮。
当我执行 adb 卸载时，它总是说`Failure without any reason.`
In DDMS I saw that my apk is stored in `/data/app/com.k2g.leaveDemo-1.apk`.
我不确定我错过了什么。
我总是必须重置我的设备才能摆脱这些应用程序:(

我需要签什么吗？
我需要在调试模式下做些什么吗？
还是取决于版本？

我正在使用三星 S2。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2018-01-03T19:22:27.420

我假设您`developer mode`在您的 android 设备上启用并且您已连接到您的设备并且您具有 shell 访问权限 ( `adb shell`)。

完成此操作后，您可以使用此命令卸载应用程序`pm uninstall --user 0 <package.name>`。其中**0**为Android系统主用户ID。这样你就不需要root你的设备了。

这是我在华为 p10 lite 设备上的操作示例。

```
# gain shell access
$ adb shell

# check who you are
$ whoami
shell

# obtain user id
$ id
uid=2000(shell) gid=2000(shell)

# list packages
$ pm list packages | grep google                                                                                                                                                         
package:com.google.android.youtube
package:com.google.android.ext.services
package:com.google.android.googlequicksearchbox
package:com.google.android.onetimeinitializer
package:com.google.android.ext.shared
package:com.google.android.apps.docs.editors.sheets
package:com.google.android.configupdater
package:com.google.android.marvin.talkback
package:com.google.android.apps.tachyon
package:com.google.android.instantapps.supervisor
package:com.google.android.setupwizard
package:com.google.android.music
package:com.google.android.apps.docs
package:com.google.android.apps.maps
package:com.google.android.webview
package:com.google.android.syncadapters.contacts
package:com.google.android.packageinstaller
package:com.google.android.gm
package:com.google.android.gms
package:com.google.android.gsf
package:com.google.android.tts
package:com.google.android.partnersetup
package:com.google.android.videos
package:com.google.android.feedback
package:com.google.android.printservice.recommendation
package:com.google.android.apps.photos
package:com.google.android.syncadapters.calendar
package:com.google.android.gsf.login
package:com.google.android.backuptransport
package:com.google.android.inputmethod.latin

# uninstall google play services (warning: take backup first!)
pm uninstall --user 0 com.google.android.gms 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-03-11T04:53:34.653

是的，移动设备管理会带来自己的问题，但我敢打赌“失败”是 dos2unix 问题。在我的 Linux 机器上，adb 正在附加一个导致“失败”的 DOS 换行符，因为卸载认为 CR 字符是包名称的一部分。还要从 package-1.apk 文件名的末尾删除“-1.apk”。

```
adb root
adb shell
pm list packages
pm uninstall com.android.chrome 
```

就我而言，我有一部处于永久“安全模式”的手机，因此只有 /system/app/ 下的应用程序才有机会运行。所以我安装它们以复制 .apk 文件，然后批量卸载并复制到 /system/app/，擦除 /cache 并重新启动。现在，即使在安全的 mdoe 中，我也有更多的应用程序在运行。

```
# adb root
# pm list packages -3 > /root/bulkuninstall.txt
# vi /root/bulkuninstall.txt  and check ^M characters at end of each line.   
   If ^M, then must run dos2unix /root/bulkuninstall.txt.  
   Remove '-1.apk' using vi search and replace:  
        :%s/-1\.apk//g 
   Or sed...

# cp /data/app/* /storage/sdcard1/APKs/
# for f in `cat /root/bulkuninstall.txt`; do echo $f; pm uninstall $f; done;
# 
# echo Now remount system and copy the APK files to /system/app/
# mount | grep system
# mount -o remount,rw /dev/block/(use block device from previous step)  /system 
# cp /storage/sdcard1/APKs/* /system/app/
# reboot 
```

擦除缓存电源。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2014-02-07T17:37:06.593

这不是一个确切的答案，但如果您因为要安装更新的 .apk 而想要卸载该应用程序，您可以试试这个：

```
adb install -r yourapp.apk 
```

该`-r`选项告诉 adb 重新安装应用程序

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-06-21T16:56:41.473

如果它是 Android 内部应用程序，您可能需要：

*   亚行外壳
*   mount -o rw,remount -t yaffs2 /dev/block/mtdblock3 /system
*   rm /system/app/your_app
*   rm /data/data/your_app
*   删除 /data/system/packages.xml 中的所有条目
*   删除 /data/system/packages.list 中的所有条目
*   编辑 AndroidManifest.xml 并去掉 android:sharedUserId="android.uid.shared"

这需要您自担风险；-|，请先在模拟器中尝试...

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2019-08-11T22:33:54.107

只需运行 ADB 并使用以下命令：

```
adb shell pm uninstall -k --user 0 <package name> 
```

你应该得到这个回报：

```
successful 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-07-14T15:45:15.003

好的，我处于同样的情况，我尝试了所有这些都没有结果..最后一个答案很接近..我做了以下事情：

为了获得正确的包裹名称，请执行以下操作：

`adb shell pm list packages | grep "name of your app here"`

你应该看到你的应用程序的正确名称.. 所以现在这个可以工作了：

```
adb uninstall com.your-real-app-name 
```

最后命令运行再次起作用：

```
ionic run android 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-02-26T19:30:42.337

我发现它`adb shell pm uninstall <package>`始终如一地工作，哪里`adb uninstall <package>`没有。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-06-24T09:53:09.160

好像您有一个应用程序，其中包含像这样的隐藏设备管理员：[http ://www.symantec.com/security_response/writeup.jsp?docid=2013-060411-4146-99](http://www.symantec.com/security_response/writeup.jsp?docid=2013-060411-4146-99)

当您首先禁用设备管理员时，您只能卸载此类应用程序。您可以使用[https://play.google.com/store/apps/details?id=com.trendmicro.mtrt.hiddenDAcleaner](https://play.google.com/store/apps/details?id=com.trendmicro.mtrt.hiddenDAcleaner)禁用它，或者通过将意图发送到调用接收器的应用程序来自行执行禁用设备管理员。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-08-19T13:22:59.043

尝试从设置窗口禁用“即时运行”

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-11-23T19:52:30.600

打开您的应用程序清单并首先检查应用程序的包。

之后，请确保您的设备设置为调试器模式。

检查 ADB 是否可以与您的设备交互：

亚行设备

如果列出了您的设备，则运行：

adb 卸载 PACKAGE_WRITTEN_IN_MANIFEST

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-05-05T13:14:27.240

也许您正在尝试卸载一个电话管理员应用程序。

要能够将其卸载，请转至“设置”>“安全”>“电话管理员”。如果列出了该应用程序，请取消选中它并确认操作。

之后，您应该可以使用应用程序设置区域或 adb 将其卸载。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-11-23T19:46:22.770

您应该必须手动删除应用程序。进入设置->应用程序管理->运行应用程序，点击它，您可以从那里删除、停止应用程序。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-03-11T14:25:10.643

这对我有用：

这是存储所有 APK 的目录：

```
cd /system/app 
```

列出它们：

```
ls 
```

选择一个来删除。

```
pm install -r <app_to_remove>.apk 
```

例子：

```
$ pm install -r Google-Play-services.apk
        pkg: Google-Play-services.apk
Success 
```

* * *

我注意到如果我要删除的应用程序正在运行，我会失败，所以先杀了它。

另外，我注意到您可能必须运行（在有根设备上）：

```
$ su
# mount -o remount +rw / 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-09-22T07:34:05.243

如果您通过 adb 卸载有问题，我可以推荐以下工具：

[https://github.com/patrickfav/uber-adb-tools](https://github.com/patrickfav/uber-adb-tools)

您可以使用通配符并支持多种设备，还具有比普通 ADB 更好的错误处理能力（但当然在后台使用它）。将在您的平台上运行。

[![控制台展示](../Images/8dfcf0439e23a06df8cdf3766c516e93.png)](https://asciinema.org/a/91091)

^(完全免责声明：我是开发者)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-10-02T20:45:26.890

就我而言，当我第一次在调试模式下编译应用程序然后尝试安装谷歌签名的应用程序时，我经常遇到这个问题。

那是因为这两个应用程序具有相同的包名称但不同的签名。自从我升级到 Android 棒棒糖后，如果我通过设置\应用程序卸载应用程序，有时我什至会收到此错误。如果您遇到此问题，请检查该应用程序是否安装在其他用户配置文件中并在所有用户帐户中卸载它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-06-06T13:43:49.593

确保输入带有应用程序名称的完整包名称：

```
com.domain.app 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-09-29T22:30:13.600

我有一个正在运行的模拟器实例并连接了一个设备。

当我运行命令“adb -d uninstall PACKAGE_NAME”时，我收到错误“DELETE_FAILED_INTERNAL_ERROR”，但是当我杀死模拟器实例时，我在卸载过程中获得了“成功”。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-04-21T05:35:21.960

您可以按照以下步骤通过命令提示符从设备中卸载应用程序。

1.  执行命令：adb -s [设备名] 卸载 -k [包名]。此命令将保留设备中的数据和缓存，但将从设备中删除应用程序。
2.  要与应用程序一起从设备中删除数据和缓存，请执行以下命令。adb shell pm uninstall -k [包名]。

如果它显示成功，您的应用程序已成功卸载'

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-07-23T08:43:44.930

它可以像在错误的情况下输入包名称一样简单......

我遇到了同样的问题 - 当实际的包名称包含大写字符时，我输入的包名称全部小写。

```
adb uninstall -k <packageName - eg. com.test.app> 
```

（如果您明确卸载，您可能不想要保留应用程序数据和缓存目录的 -k 。）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-07-08T15:24:49.387

您有 apk 的名称而不是包名称：您应该首先知道包名称。给这个磁带：

**adb shell pm list packages**

一旦你有了包名（*小心，包名就像 com.intel.... 而不是 package:com.intel...*），磁带：

**adb shell pm 卸载 -k "package_name"**

和宾果游戏！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-08-08T11:18:02.240

如果您使用小米设备，则需要登录小米帐号。

成功注册后，您可以通过 ADB 安装和卸载。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-01-02T15:15:45.000

尝试从首选项中禁用“即时运行”！它对我有用。

[![在此处输入图像描述](../Images/2c698318863a2c6875fdfc998e36c9e6.png)](https://i.stack.imgur.com/aMqcd.png)

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2015-07-02T21:52:25.857

使用 adb shell uninstall com.package.app/ 时出现故障

删除 / （所以 adb shell 卸载 com.package.app）并且它可以工作

# ioc-container - 为 asp.net webapi 选择 IoC 容器

> ID：13534936
> 
> 赞同：3
> 
> 时间：2012-11-23T19:43:28.500
> 
> 标签：ioc-container

我正在寻找一个用于 asp.net webapi 的 ioc 容器。我们正在寻找的几个关键功能如下

*   自定义生命周期
*   对 Web 请求生命周期的内置支持
*   在管理依赖注册方面与 web api 的良好集成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T13:13:50.000

Mark Seemann 了解他的 DI/Ioc，并且有一篇关于在 Castle Windsor 中为 Wep Api 实现它的[文章](http://blog.ploeh.dk/2012/10/03/DependencyInjectioninASP.NETWebAPIwithCastleWindsor/)。我不知道自定义生命周期，但它肯定解决了第二个和第三个要求。

Castle 不像[Autofac](http://code.google.com/p/autofac/wiki/WebApiIntegration)说的那么轻巧，但它已经存在多年并且经过了试验和测试：到目前为止，我将 Castle 用于我的 Web Api 和 Mvc 项目，没有问题。

两者都应该完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T13:25:43.187

我个人喜欢[Unity](http://unity.codeplex.com/)。我使用 Unity 的原因是它是由 Microsoft 构建的，因此您可以期望它几乎是最新的。我也有过使用它的经验，它对 ASP.NET Web API 有很好的支持，但最终选择还是反对容器取决于你。这真的取决于个人口味。

ASP.NET 教程中有一小部分讨论了[将 Unity 与 Web API 结合使用](http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver)。

# sql-server - 执行 INNER JOIN 时重复的结果

> ID：13534939
> 
> 赞同：4
> 
> 时间：2012-11-23T19:44:46.757
> 
> 标签：sql-server, sql-server-2008, inner-join, cartesian-product

我有 2 个简单的表，我想用它们执行 INNER JOIN，但问题是我得到了重复的（对于列 str1 和 str2）结果：

```
CREATE TABLE #A (Id INT, str1 nvarchar(50), str2 nvarchar(50))
insert into #A  values (1, 'a', 'b')
insert into #A  values (2, 'a', 'b')

CREATE TABLE #B (Id INT, str1 nvarchar(50), str2 nvarchar(50))
insert into #B values (7, 'a', 'b')
insert into #B  values (8, 'a', 'b')

select * from #A a
INNER JOIN #B b ON a.str1 = b.str1 AND a.str2 = b.str2 
```

当我真的想要 2 条记录时，它给了我 4 条记录。

我得到了什么：
id | str1 | str2| 编号 | str1 | str2
1 | 一个 | 乙 | 7 | 一个 | 2
| 一个 | 乙 | 7 | 一个 | 1
| 一个 | 乙 | 8 | 一个 | 2
| 一个 | 乙 | 8 | 一个 | b

我真正想要的：
1个| 乙 | 7 | 一个 | b
2 一个 | 乙 | 8 | 一个 | b

任何人都可以帮忙吗？我知道这可以使用游标和循环来实现，但我想避免它，并且尽可能只使用某种类型的 JOIN。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T20:00:26.520

```
SELECT 
    a.id AS a_id, a.str1 AS a_str1, a.str2 AS a_str2, 
    b.id AS b_id, b.str1 AS b_str1, b.str2 AS b_str2
FROM 
    ( SELECT *
           , ROW_NUMBER() OVER (PARTITION BY str1, str2 ORDER BY id) AS rn
      FROM #A 
    ) a
  INNER JOIN 
    ( SELECT *
           , ROW_NUMBER() OVER (PARTITION BY str1, str2 ORDER BY id) AS rn
      FROM #B 
    ) b 
    ON  a.str1 = b.str1 
    AND a.str2 = b.str2 
    AND a.rn = b.rn ; 
```

如果您在同一组合的一个或其他表中有更多行，您可以通过将join更改为或join`(str1, str2)`来选择将返回哪些行。`INNER``LEFT``RIGHT``FULL`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T19:55:15.110

您*可以*使用如下查询（SQL 2005 及更高版本）完成某种匹配：

```
WITH A AS (
   SELECT
      Seq = Row_Number() OVER (PARTITION BY Str1, Str2 ORDER BY Id),
      *
   FROM #A
), B AS (
   SELECT
      Seq = Row_Number() OVER (PARTITION BY Str1, Str2 ORDER BY Id),
      *
   FROM #B
)
SELECT
   A.Id, A.Str1, A.Str2, B.Id, B.Str1, B.Str2
FROM
   A
   FULL JOIN B
      ON A.Seq = B.Seq AND A.Str1 = B.Str1 AND A.Str2 = B.Str2; 
```

这将 A 和 B 之间的项目连接到其 Id-ordered 位置。但请注意：如果每组 Str1 和 Str2 的项目数不相等，则可能会得到意想不到的结果，因为 #A 或 #B 会出现 NULL。

我在这里假设您希望表#A 的“Str1 Str2”的第一行，按照#A.Id 的顺序（1 是第一个），与表#B 的“Str1 Str2”的第一行相关，按照顺序通过#B.Id （7 是第一个），依此类推，依次为每个连续编号的行。那正确吗？

但是如果行数不匹配，例如，#A 中有 3 行与 #B 中的 2 行具有相同的值，你会怎么做？还是反过来？你要看什么？

仅仅 DISTINCT 将无法完成这项工作，因为数据不会重复。您得到的实际上是部分交叉连接（导致部分笛卡尔积）。也就是说，您的联接条件不能确保#A 行与#B 行一一对应。发生这种情况时，对于#A 中的**每一行，您将获得 B 中****每个**匹配行的输出行。2 x 2 = 4，而不是 2。

我认为如果你在你的例子中更具体一点会有所帮助。你实际上在查询什么？当然，你已经为我们简化了，但这也删除了所有上下文，让我们知道你在现实世界中想要完成什么。如果您尝试排列运动队，我们可能会给出不同的答案，而不是您尝试排列发票行项目或迟到事件或谁知道什么！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:52:00.143

有了这些数据，只有这些数据，您无法获得您想要的结果，除非您可以为每个#A 的 ID 值提供某种方式来映射到每个 #B 的 ID 值。

因此，如果每个表中真的只有 2 条记录，它会是这样的：

```
SELECT *
FROM   #A a
   JOIN #B b
      ON a.str1 = b.str1  -- actually, if you join by IDs this isn't necessary
      AND a.str2 = b.str2 -- nor is this
      AND 
      (
          ( a.ID = 1 and b.ID = 7 )
       OR ( a.ID = 2 and b.ID = 8 )
      ) 
```

你得到的是一个笛卡尔积，其中#A 中的每条记录都与#B 中的每条匹配记录配对。由于每个表中有多个匹配记录，因此您可以从 A 和 B 中获得匹配记录的所有可能组合。

由于您必须使用的唯一其他字段是 ID 字段，因此您需要使用这些字段将一条 A 记录与一条 B 记录组合在一起。

# android - Android通话记录最新条目

> ID：13534940
> 
> 赞同：1
> 
> 时间：2012-11-23T19:44:57.340
> 
> 标签：android, logging, call

我想在接到未接电话后开始一项活动。但是我无法从通话记录中读取最新的未接来电条目，而是读取当前条目之前的条目。当电话状态空闲时，我正在阅读它。

示例：假设有两个未接电话条目，一个在 11:10，另一个在 11:11。我在 12:12 接到一个未接电话，我的活动需要显示在 12:12,11:11,11:10 获得的未接电话。而是阅读 11:11,11:10。最新条目丢失。我应该怎么办？我正在使用服务并阅读通话记录、电话状态。

```
Cursor c = getContentResolver().query(allCalls, null, null, null, order); 
  if (c.moveToFirst()) { 
    do{ 
      // getting number,type,ack etc} 
    while (c.moveToNext()); } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T13:01:19.363

你可以这样使用。

```
 c=mContext.getContentResolver().query(CallLog.Calls.CONTENT_URI, projection, null, null, CallLog.Calls._ID + " DESC");
      if(c.getCount()!=0){
                c.moveToFirst();
                 lastCallnumber = c.getString(0);
                 lastCallnumber=FormatNumber(lastCallnumber);                     
                 String type=c.getString(1);
                 String duration=c.getString(2);
                 String name=c.getString(3);
                 String id=c.getString(4);
                 System.out.println("CALLLLing:"+lastCallnumber+"Type:"+type+"\t id:"+id);
 if(type.equals("3")){
    //you can get last missedcall here
 } 
```

你可以试试，可能对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:22:46.657

您需要使用[TelephonyManager](http://developer.android.com/reference/android/telephony/TelephonyManager.html)和[PhoneStateListener](http://developer.android.com/reference/android/telephony/PhoneStateListener.html)来监听它。

此代码将向您展示如何执行此操作：

```
if(lastStart == TelephonyManager.CALL_STATE_RINGING)
{
    long now = System.currentTimeMillis();
    long duration = (now-ringStartTime)/1000;
    bindService.AddMissCallInfo(ringPhoneNumber, ringStartTime, duration);
    Log.i(Constants.Tag,"service add miss call!");
} 
```

> 代码取自：[http ://code.google.com/p/android-miss-call/source/browse/trunk/src/com/call/DialPhoneStateListener.java?r=3](http://code.google.com/p/android-miss-call/source/browse/trunk/src/com/call/DialPhoneStateListener.java?r=3)

# symfony - 子域中的 symfony2 yui_compressor 输出

> ID：13534942
> 
> 赞同：0
> 
> 时间：2012-11-23T19:45:13.410
> 
> 标签：symfony, yui-compressor, output

我正在使用 yui_compressor：

`

```
{% javascripts filter='?yui_js'
   '@MyProjectBundle/Resources/public/js/libs/jquery/jquery-min.js'
   '@MyProjectBundle/Resources/public/js/libs/bootstrap/bootstrap-modal.js'
   '@MyProjectBundle/Resources/public/js/libs/bootstrap/bootstrap-tooltip-2.0.js'
   '@MyProjectBundle/Resources/public/js/libs/bootstrap/bootstrap-popover.js'
   '@MyProjectBundle/Resources/public/js/libs/bootstrap/bootstrap-dropdown.js'
   '@MyProjectBundle/Resources/public/js/main.js' %}
   <script src="{{ asset_url }}"></script>
   <script>
      window.basePath = "{{ url('index') }}";
   </script>
{% endjavascripts %} 
```

`

我想在子域中输出，而不是在 /js/xxx.js 中，可能是 kernel_root 上方的一个文件夹（我的子域指向的位置）。

关于如何解决这个问题的任何想法？

太感谢了，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:55:20.030

我为我的资产使用 CDN。

您可以在 config_prog.yml 中轻松更改它

```
framework:
templating:
    assets_base_urls:
        http: [ http://cdn.domain.com ] 
```

但您必须记住，图像等资产也是从那里加载的......

此外，破坏缓存可能很有用（例如，您的 CDN 有很长的过期时间）。你可以通过添加来做到这一点

```
framework:
    templating:      { engines: ['twig'], assets_version: v1 } 
```

到您的 config.yml。

# php - 使用jquery加载xml文件，编辑它，然后用php再次保存到服务器

> ID：13534945
> 
> 赞同：1
> 
> 时间：2012-11-23T19:45:25.820
> 
> 标签：php, jquery, xml

我希望能够从我的服务器加载一个 xml 文件。使用 jQuery 编辑 xml 中的节点，然后使用 php.ini 将此更改与 xml 文件的其余部分一起保存回服务器。有人知道怎么做吗？我有更改 xml 节点的代码，并且可以在我的控制台中看到它。但无法将代码返回到我的服务器。

谢谢！

```
<?php
$xml = $_POST['xml'];
$file = fopen("data.xml","w");
fwrite($file, $xml);
fclose($file);
?> 

$.post('saveXml.php', { xml: $(data)}, function(data){alert('data loaded');}); 
```

如果我 console.log(data) 我得到 #document 和所有 xml 节点。我还在我的服务器上获得了 data.xml 文件，但它是空白的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T20:44:42.893

以前从未这样做过，但在这里找到了一些信息： [Convert xml to string with jQuery](https://stackoverflow.com/questions/6507293/convert-xml-to-string-with-jquery) 我已经测试了以下内容，它将修改原始 xml 并作为接收到的字符串发送回服务器`$_POST['xml']`

```
$(function() {
    $.get('test.xml', function(xml) {
        var $xml = $(xml)
         /* change all the author names in original xml*/
        $xml.find('author').each(function() {
            $(this).text('New Author Name');

        })

        var xmlString=jQ_xmlDocToString($xml)

            /* send modified  xml string to server*/    
        $.post('updatexml.php', {xml:xmlString },function (response){             
             console.log(response)
             /* using text dataType to avoid serializing xml returned from `echo $_post['xml'];` in php*/
        }'text')
    }, 'xml')
});

function jQ_xmlDocToString($xml) {
    /* unwrap xml document from jQuery*/
    var doc = $xml[0];
    var string;
    /* for IE*/
    if(window.ActiveXObject) {
        string = doc.xml;
    }
    // code for Mozilla, Firefox, Opera, etc.
    else {
        string = (new XMLSerializer()).serializeToString(doc);
    }
    return string;
} 
```

演示：http: [//jsfiddle.net/54L5g/](http://jsfiddle.net/54L5g/)

# java - 带有通配符的 Java 泛型在 Eclipse 中编译，但在 javac 中不编译

> ID：13534946
> 
> 赞同：10
> 
> 时间：2012-11-23T19:45:26.793
> 
> 标签：java, eclipse, generics, wildcard, javac

[作为Java 泛型在 Eclipse 中编译但不在 javac 中编译](https://stackoverflow.com/questions/13533880)的后续措施，我发布了另一个片段，该片段在 Eclipse 中编译和运行良好，但在 javac 中引发了编译错误。（这可以防止提取片段的项目使用 Maven 构建。）

自包含片段：

```
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class Main {
  public static void main(String[] args) {
    Set<Foo<?>> setOfFoos = new HashSet<Foo<?>>();
    List<Foo<?>> sortedListOfFoos = asSortedList(setOfFoos);
  }

  public static <T extends Comparable<T>> List<T> asSortedList(Collection<T> c) {
    List<T> list = new ArrayList<T>(c);
    java.util.Collections.sort(list);
    return list;
  }

  public static class Foo<T> implements Comparable<Foo<T>> {
    @Override
    public int compareTo(Foo<T> o) {
      return 0;
    }
  }
} 
```

javac 中的编译返回：

```
Main.java:11: <T>asSortedList(java.util.Collection<T>) in Main cannot be applied to (java.util.Set<Main.Foo<?>>)
    List<Foo<?>> sortedListOfFoos = asSortedList(setOfFoos);
                                    ^ 
```

`Foo<?>`使用上述代码段替换时`Foo<String>`将在 javac 中编译，这意味着问题与使用的通配符有关。由于 Eclipse 编译器应该更宽容，片段是否可能不是有效的 Java？

（我使用 javac 1.6.0_37 和 Eclipse Indigo，编译器合规级别为 1.6）

（**EDIT1：**包括另一个在 EDIT2 中删除的示例。）

**EDIT2：**由[irreputable 暗示](https://stackoverflow.com/a/13535825/691083)，比较`Foo<A>`并且`Foo<B>`可能在概念上是错误的，并且受到[seh](https://stackoverflow.com/a/13535813/691083)答案的启发，工作`asSortedFooList`可以写成如下：

```
public static <T extends Foo<?>> List<T> asSortedFooList(Collection<T> c) {
    List<T> list = new ArrayList<T>(c);
    java.util.Collections.sort(list);
    return list;
} 
```

（在上面的方法定义中简单替换`Comparable<T>`with 。）因此 javac 和 imho 在概念上比较任何and`Foo<?>`似乎是安全的。但是，如果它的类型参数是用通配符参数化的，那么仍然不可能编写一个返回泛型集合的排序列表表示的泛型方法。我试图通过替换 in 来“欺骗”javac ，但这没有用。`Foo<A>``Foo<B>``asSortedList``Foo<?>``S extends Comparable<S>``asSortedFooList`

**EDIT3：**后来[Rafaelle](https://stackoverflow.com/a/13543272/691083)指出，设计存在缺陷，因为`Comparable<Foo<T>>`不需要实现，并且实现`Comparable<Foo<?>>`提供相同的功能，通过细化设计解决了最初的问题。

（最初的原因和好处是，a`Foo<T>`可能*在某些目的*上不关心它的具体类型，但仍然使用具体类型的实例`T`，它被实例化，用于其他目的。该实例不必用于确定order 等等`Foo`，因为它可能在 API 的其他部分中使用。

具体示例：假设每个 Foo 都使用不同类型的参数实例化`T`. 的每个实例`Foo<T>`都有一个递增的类型 id，`int`用于 - 方法的实现`compareTo`。我们现在可以对这些不同类型的列表进行排序`Foo`，而不关心具体类型`T`（用 表示`Foo<?>`），并且*仍然*有一个具体类型的实例`T`可供以后处理。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T16:48:52.960

对我来说，这是另一个`javac`错误。当您尝试将 a 发送`Collection<Foo<?>>`到带有签名的方法时：

```
public static <T extends Comparable<T>> List<T> asSortedList(Collection<T> c) 
```

编译器注意到*形式参数* `T`有一个上限，因此检查调用者是否遵守约束。*type 参数*是参数化 type 的（通配符）实例化，因此如果*is-a*`Foo<T>`测试将通过。基于通用定义：`Foo<?>` *`Comparable<Foo<?>>`*

 *```
class Foo<T> implements Comparable<Foo<T>> 
```

我会说这是真的，所以 Eclipse 再次是正确的并且`javac`有一个错误。这个[Angelika Langer 的条目](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ201)永远没有足够的联系。另请参阅[相关的 JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.10.2)。

你问它是否是类型安全的。我的回答是它**是类型安全**的，它表明你的设计存在缺陷。考虑您虚构的`Comparable<T>`接口实现，我在其中添加了另外两个字段：

```
public static class Foo<T> implements Comparable<Foo<T>> {

  private T pState;
  private String state;

  @Override
  public int compareTo(Foo<T> other) {
    return 0;
  }
} 
```

你总是返回`0`，所以问题没有被发现。但是，当您尝试使其有用时，您有两个选择：

1.  比较字符串字段
2.  比较`T`会员

该`String`字段始终是 a `String`，因此您并没有真正从类型变量中受益`T`。另一方面，`T`没有其他可用的类型信息，因此`compareTo()`您只能处理普通对象，并且类型参数再次无用。您可以通过实现相同的功能`Comparable<Foo<?>>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T21:17:13.393

在这种情况下，javac 是正确的。从概念上讲，您的代码无法工作，因为该集合可能包含`Foo<A>`and `Foo<B>`，它们无法相互比较。

您可能希望该集合是`Set<Foo<X>>`某个类型变量 X 的 a；不幸的是，我们不能在方法体内引入类型变量；仅在方法签名中

```
<X> void test(){
    Set<Foo<X>> setOfFoos = new HashSet<Foo<X>>();
    List<Foo<X>> sortedListOfFoos = asSortedList(setOfFoos);
} 
```

您可以通过类似的方式使其工作

```
<T extends Comparable<? super T>> List<T> asSortedList(Collection<T> c) 

class Foo<T> implements Comparable<Foo<?>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T21:16:12.363

我找到了一个使用*javac*编译的解决方案，尽管我不高兴我无法准确解释它为什么起作用。它需要引入一个中介功能：

```
public final class Main {
  public static class Foo<T> implements Comparable<Foo<T>> {
    @Override
    public int compareTo(Foo<T> o) {
      return 0;
    }
  }

  public static <T extends Comparable<? super T>>
  List<T> asSortedList(Collection<T> c) {
    final List<T> list = new ArrayList<T>(c);
    java.util.Collections.sort(list);
    return list;
  }

  private static <T extends Foo<?>> List<T> asSortedFooList(Collection<T> c) {
    return asSortedList(c);
  }

  public static void main(String[] args) {
    final Set<Foo<?>> setOfFoos = new HashSet<Foo<?>>();
    final List<Foo<?>> listOfFoos = asSortedFooList(setOfFoos);
  }
} 
```

我*认为*这是通过逐步采用通配符解析来实现的；`asSortedFooList()`捕获一种已知为 a的类型`Foo`，与`Foo`的类型参数无关。将该类型参数绑定在 中`asSortedFooList()`，然后我们可以调用您的原始类型`asSortedList()`（嗯，进行一次修改——注意类型参数的下限 for `Comparable`），要求绑定`Foo`为继承自 的类型`Comparable`。

同样，这是一个弱的、随意的解释。我在这里回答的主要目的只是提供另一种到达目的地的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T20:39:48.363

我不知道这是否是一个问题，但这是一个（不是很好的）答案：如果你牺牲了一些类型安全，你可以写

```
@SuppressWarnings({ "unchecked", "rawtypes" })
public static <T extends Comparable> List<T> asSortedList(Collection<T> c) {
    List<T> list = new ArrayList<T>(c);
    java.util.Collections.sort(list);
    return list;
} 
```

它适用于eclipse和javac。我知道的唯一风险是，如果有人创建 a`class Foo extends Comparable<Bazz>`你不会在编译时检测到它。但如果有人创造`Foo extends Comparable<Bazz>`，就杀了他/她。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T20:33:01.680

如果您可以用确切的类型（可能是超类型）替换您的通配符使用，您的代码将起作用。代替

```
List<Foo<?>> sortedListOfFoos = asSortedList(setOfFoos); 
```

和

```
List<Foo<String>> sortedListOfFoos = Main.<Foo<String>>asSortedList(setOfFoos); 
```*

# symfony - Symfony2.1 SonataUserBundle ResourceBundle 错误

> ID：13534948
> 
> 赞同：4
> 
> 时间：2012-11-23T19:45:48.243
> 
> 标签：symfony, symfony-sonata

Symfony 有这个问题。

我现在使用 SonataUserBundle 并且出现此错误：

> 无法在 [...]/vendor/symfony/symfony/src/Symfony/Component/Locale/Locale.php 第 16 行为区域设置“en”（未捕获的异常）加载区域设置资源包

我已经`intl`安装了。

我在互联网上做了一些研究，发现我必须做

```
php data-build.php 49 
```

这给了我这个错误：

> PHP 致命错误：在第 97 行 [...]Symfony/vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/data/build-data.php 中找不到类“ResourceBundle”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T14:33:27.210

您是否尝试过重新安装或更新作曲家？我知道每当我遇到任何第三方供应商的问题时，我都会删除我的 composer.lock 文件并更新 composer 以生成一个新的。

# javascript - tinymce 编辑器的占位符插件

> ID：13534952
> 
> 赞同：3
> 
> 时间：2012-11-23T19:46:31.987
> 
> 标签：javascript, jquery, html, tinymce

我正在寻找一个插件或实现，以`placeholder`在 tinymce 编辑器中包含类似 HTML5 的文本，但没有成功。如果它存在，你会怎么做？或者我该如何实现这个功能？

究竟我可以如何使用 Ckeditor：

[http://alfonsoml.blogspot.it/2012/04/placeholder-text-in-ckeditor.html](http://alfonsoml.blogspot.it/2012/04/placeholder-text-in-ckeditor.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T09:05:04.337

您正在寻找的内容已在[此 SO question](https://stackoverflow.com/questions/12693989/tinymce-html5-placeholder-by-reading-attribute-from-textarea)中得到解答，并且也应该对您有用。

# jquery - 如何在页面之间传递 jQuery 更改

> ID：13534956
> 
> 赞同：0
> 
> 时间：2012-11-23T19:47:16.837
> 
> 标签：jquery

我创建了一些影响单个页面的 jQuery。当您单击按钮时，这恰好更改了 body 类标记。问题是当我转到不同的页面时，这个 body 标签恢复正常。我想知道是否有一种方法可以在页面之间使用 jQuery 来保留 body 标记的更改。

我对 jQuery 有点陌生，所以我不知道到底要搜索什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:50:12.023

Javascript 在浏览器中运行，而不是在服务器上。因为服务器独立呈现每个页面（HTTP 是一种无状态协议），所以 Javascript 对 DOM 所做的更改无法在 HTTP 请求中持续存在。

如果要进行持久更改，则需要与服务器进行通信。例如，使用 jQuery，您可以使用[`$.ajax()`](http://api.jquery.com/jQuery.ajax)将消息发送回服务器，说明正文类已更改，并让服务器在后续页面加载时发送回包括该类的新标记。或者，您可以使用 Javascript 设置 cookie，并让服务器在查看它是否应该呈现更改的类时检查 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:50:10.317

这不是真正的 jQuery 东西。通常，您会将页面状态存储在 cookie 中，然后在读取 cookie 并重新应用更改的每个页面上执行代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:52:30.247

您可以使用 ajax`load();`函数将此页面加载到另一个页面中，并继续使用效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:52:36.273

这是您在会话中使用 cookie 来存储值的东西，以将您的 jquery 按钮事件的布尔值表示为触发或未触发。

# assembly - 在 Win7 x64 上运行代码视图（程序集调试器）

> ID：13534957
> 
> 赞同：0
> 
> 时间：2012-11-23T19:47:18.423
> 
> 标签：assembly, windows-7

我正在使用 Win7 x64。

在我的课堂上，我们使用 Win XP x32 并在标准的 MS-DOS 编辑器中编写程序，并使用 Code View 调试我们的程序。

但我的问题是我无法将其设置回家，因为我无法在 x64 上运行 Code View。

我有两个解决方案。一种是将我的操作系统更改为 winXP x32 或安装虚拟机并在其上使用 winXP x32。

是否有其他模拟器/程序可以与 Code View 做同样的事情？有什么好的教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-31T23:25:52.387

迟到的答案，但希望有人会发现它有用。运行它的一种方法是下载[DOSBox](http://sourceforge.net/projects/dosbox/files/dosbox/0.74/DOSBox0.74-win32-installer.exe/download)，它是老式 DOS 的模拟器。既然你提到了代码视图，我猜你也在使用 MASM，所以如何运行它的简短说明如下：

*   运行 DOSBox
*   在控制台中，编写类似“mount DC:/masm”的内容，其中“masm”是您存储编译器和代码视图 (cv.exe) 的文件夹
*   接下来是命令“D：”，它将使您进入您的“masm”文件夹
*   编译它 - 'masm myfile.asm'
*   链接它 - '链接我的文件'
*   最后，在代码视图'cv myfile.exe'中调试

# url - ExpressionEngine，Safecracker 表单在 safecracker 表单中的 URL 中嵌入选择框值

> ID：13534958
> 
> 赞同：0
> 
> 时间：2012-11-23T19:47:22.337
> 
> 标签：url, embed, expressionengine, safecracker

我有一个嵌入到我的保险箱破解器表单中。Embed 有一个选择框，可以选择茶的名称。

我想将带有安全破解器 URL 的茶的名称发送到下一页。

这是代码：

```
{exp:safecracker channel="blending_log"  return="sthome/blending/ENTRY_ID" dynamic_title="     [selected_tea]_[organic_or_conventional][date_time][agent_number]"}
<h3>Select and enter data</h3>
{embed="stembeds/.blending_select_tea"}

{!--------Receive data to create value--------}
<input type="hidden" name="title" value="" />
<br /><br />
Organic Or Conventional:
 {field:org_con}

 Agent Number:
 {field:agent_number}

{!-----END Receive data to create lot number-------} 
```

嵌入是：{embed="stembeds/.blending_select_tea"}

这是嵌入的代码：

```
<select name="selected_tea">
<option selected="selected" >Select a Tea</option>
{exp:channel:entries channel="tea_herbs" order_by="title" sort="asc"}

<option name={title} id={entry_id} value={url_title}>{title}</option>

{/exp:channel:entries} 

</select> 
```

我想从嵌入中选择茶，我想用安全破解器 URL 发送茶名称：

```
{exp:safecracker channel="blending_log" dynamic_title="[selected_tea]_[organic_or_conventional][date_time][agent_number]"   return="sthome/blending2_nimmi/ENTRY_ID"} 
```

请帮我解决这个问题。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T21:11:34.047

确保您的“blending_log”频道中有一个名为“selected_tea”的文本字段 - 否则 SafeCracker 不会保存该值。

您的嵌入应如下所示：

```
<select name="selected_tea">
    <option value="" selected="selected">Select a Tea</option>
    {exp:channel:entries channel="tea_herbs" order_by="title" sort="asc" dynamic="no" disable="member_data|pagination|categories"}
    <option value="{url_title}">{title}</option>
    {/exp:channel:entries} 
</select> 
```

# c# - .NET MVC 4 - foreach 循环中的按钮操作

> ID：13534963
> 
> 赞同：1
> 
> 时间：2012-11-23T19:48:03.473
> 
> 标签：c#, .net, asp.net-mvc

我目前有这样的视图：

```
@using (Html.BeginForm("Compare", "Carousel", FormMethod.Post)) 
{
@foreach (var product in Model.Products)
{
        <tr>
             <td>@product.Provider.Name</td>
             <td>&pound;@Math.Round(product.MonthlyPremium, 2, MidpointRounding.AwayFromZero)</td>
             <td>@Html.ActionLink("More Details", "MoreDetails", new { id = product.ProductId })</td>
             <td><button name="compare" value="@product.ProductId">Compare</button</td>
        </tr>
}
} 
```

控制器：

```
[HttpPost]
public ActionResult Compare(ProductsWithDetailModel model) // This is a guess, Model may not persist? 
 {
       // Code here

       return View("Index", model);
 } 
```

我真正想要的是，当单击按钮时，将调用控制器并将已选择的产品（单击的按钮）添加到项目列表中。

我如何真正找出在控制器中单击了哪个按钮？为什么我在网上找不到*任何*以前做过的教程，肯定是它的基本功能？还是我接近它错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:59:08.457

ASP.NET MVC 接受所有输入并通过动词将其发送到操作。这些控件的绑定是由`name`您的视图上的属性进行的，其值取决于我们所讨论的控件（文本、复选框、单选、选择、按钮等）。您可以在`ProductsWithDetailModel`调用的*比较*上拥有一个属性，它会接收您单击的按钮的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T20:04:41.913

每个项目有 1 个表格怎么样？

例如

```
@foreach (var product in Model.Products)
{
    <tr>
         <td>@product.Provider.Name</td>
         <td>&pound;@Math.Round(product.MonthlyPremium, 2, MidpointRounding.AwayFromZero)</td>
         <td>@Html.ActionLink("More Details", "MoreDetails", new { id = product.ProductId })</td>
         <td>
             @using (Html.BeginForm("Compare", "Carousel", FormMethod.Post)) 
             {
                 <input type="hidden" name="productId" value="@product.ProductId"  />
                 <button name="compare">Compare</button>
             }
         </td>
    </tr>
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T20:01:58.113

使用点击。在循环中设置 js 隐藏值。在控制器检查中。

# c - 如何为二维数组动态分配连续的内存块

> ID：13534966
> 
> 赞同：20
> 
> 时间：2012-11-23T19:48:35.740
> 
> 标签：c, arrays, multidimensional-array

如果我像这样分配一个二维数组**int a[N][N]** ; 它将分配一个连续的内存块。

但是，如果我尝试像这样动态地进行操作：

```
int **a = malloc(rows * sizeof(int*));
for(int i = 0; i < rows; i++) 
   a[i] = malloc(cols * sizeof(int)); 
```

这会在行中的元素之间保持一个单位步幅，但在行之间可能并非如此。

一种解决方案是从 2D 转换为 1D，除此之外，还有另一种方法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-23T20:50:36.860

如果您的数组维度在编译时已知：

```
#define ROWS ...
#define COLS ...

int (*arr)[COLS] = malloc(sizeof *arr * ROWS);
if (arr) 
{
  // do stuff with arr[i][j]
  free(arr);
} 
```

如果您的数组维度在编译时未知，并且您使用的是支持可变长度数组的 C99 编译器或 C2011 编译器：

```
size_t rows, cols;
// assign rows and cols
int (*arr)[cols] = malloc(sizeof *arr * rows);
if (arr)
{
  // do stuff with arr[i][j]
  free(arr);
} 
```

如果您的数组维度在编译时未知，并且您*没有*使用支持可变长度数组的 C99 编译器或 C2011 编译器：

```
size_t rows, cols;
// assign rows and cols
int *arr = malloc(sizeof *arr * rows * cols);
{
  // do stuff with arr[i * rows + j]
  free(arr);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-23T19:53:01.730

事实上，n 维数组（分配在堆栈上）实际上只是一维向量。多重索引只是语法糖。但是你可以编写一个访问器函数来模拟你想要的东西：

```
int index_array(int *arr, size_t width, int x, int y)
{
    return arr[x * width + y];
}

const size_t width = 3;
const size_t height = 2;
int *arr = malloc(width * height * sizeof(*arr));

// ... fill it with values, then access it:

int arr_1_1 = index_array(arr, width, 1, 1); 
```

但是，如果您支持 C99，则可以声明指向数组的指针，您甚至可以使用语法糖：

```
int (*arr)[width] = malloc(sizeof((*arr) * height);
arr[x][y] = 42; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-01-16T19:55:23.750

假设您要动态分配 ROWS 行和 COLS 列的二维整数数组。然后你可以先分配一个连续的 ROWS * COLS 整数块，然后手动将其拆分为 ROWS 行。没有语法糖，这读

```
int *mem = malloc(ROWS * COLS * sizeof(int));
int **A = malloc(ROWS * sizeof(int*));
for(int i = 0; i < ROWS; i++) 
   A[i] = mem + COLS*i;
// use A[i][j] 
```

并且可以通过避免乘法来更有效地完成，

```
int *mem = malloc(ROWS * COLS * sizeof(int));
int **A = malloc(ROWS * sizeof(int*));
A[0] = mem;
for(int i = 1; i < ROWS; i++) 
   A[i] = A[i-1] + COLS;
// use A[i][j] 
```

最后，可以完全放弃额外的指针，

```
int **A = malloc(ROWS * sizeof(int*));
A[0] = malloc(ROWS * COLS * sizeof(int));
for(int i = 1; i < ROWS; i++) 
   A[i] = A[i-1] + COLS;
// use A[i][j] 
```

但有一个重要的问题！您必须小心首先释放 A[0]，然后释放 A，

```
free(A[0]);
free(A);              // if this were done first, then A[0] would be invalidated 
```

相同的想法可以扩展到 3 维或更高维的数组，尽管代码会变得混乱。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-23T20:04:22.367

您可以通过大步访问动态分配的内存作为*任意*维度的数组：

```
int * a = malloc(sizeof(int) * N1 * N2 * N3);  // think "int[N1][N2][N3]"

a[i * N2 * N3 + j * N3 + k] = 10;              // like "a[i, j, k]" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-09T00:45:01.513

请原谅我缺乏格式或任何错误，但这是来自手机。

在尝试使用 fwrite() 将 int** 变量作为 src 地址进行输出时，我也遇到了一些进步。

一种解决方案是使用两个 malloc() 调用：

```
#define HEIGHT 16
#define WIDTH 16

.
.
.
//allocate
int **data = malloc(HEIGHT * sizeof(int **));
int *realdata = malloc(HEIGHT * WIDTH * sizeof(int));

//manually index
for (int i = 0; i < HEIGHT; i++)
    data[i] = &realdata[i * WIDTH];

//populate
int idx = 0;
for (int i = 0; i < HEIGHT; i++)
    for (int j = 0; j < WIDTH; j++)
        data[i][j] = idx++;

//select
int idx = 0;
for (int i = 0; i < HEIGHT; i++)
{
    for (int j = 0; j < WIDTH; j++)
        printf("%i, ", data[i][j]);
    printf("/n");
}

//deallocate
.
.
. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-23T20:02:02.223

您可以 typedef 您的数组（以减少头疼），然后执行以下操作：

```
#include <stdlib.h>
#define N 10
typedef int A[N][N];
int main () {
  A a; // on the stack
  a[0][0]=1;
  A *b=(A*)malloc (sizeof(A)); // on the heap
  (*b)[0][0]=1;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-23T20:14:06.987

最好的方法是分配一个指向数组的指针，

```
int (*a)[cols] = malloc(rows * sizeof *a);
if (a == NULL) {
    // alloc failure, handle or exit
}

for(int i = 0; i < rows; ++i) {
    for(int j = 0; j < cols; ++j) {
        a[i][j] = i+j;
    }
} 
```

如果编译器不支持可变长度数组，那么只有当`cols`它是一个常量表达式时才有效（但无论如何你都应该升级你的编译器）。

# opencv - 在 openCV 中释放内存分配

> ID：13534969
> 
> 赞同：1
> 
> 时间：2012-11-23T19:48:50.630
> 
> 标签：opencv, cuda, gpgpu

我正在尝试使用 openCV 在我的 NVidia GPU 上实现计算机视觉算法。我正在使用 openCV 2.4，我目前正在编写非常简单的程序来习惯 openCV。我编写了一个简单的转置矩阵代码，并在 GPU 上实现了精明的边缘检测。该程序运行良好，但我需要释放 CPU 和 GPU 中的内存。所以我在下面发布我的代码：

```
int main(int argc,char *argv[])
{
  int k;
  cv::Mat src;
  cv::Mat dest;
  cv::Mat dest_1;
  cv::gpu::GpuMat im_source;
  cv::gpu::GpuMat im_dest;
  cv::gpu::GpuMat im_dest_1;
  cv::gpu::Stream::Null;

  k = cv::gpu :: getCudaEnabledDeviceCount();
  printf("%d\n",k);

  src = cv::imread("lena.jpg",0);
  cv::imshow("lena_org",src);
  im_source.upload(src);

  cv::gpu::transpose(im_source,im_dest);

   im_dest.download(dest);

   cv::imshow("lena_trans",dest);

   cv::gpu::Canny(im_source,im_dest_1,100,100,3,false);

   im_dest_1.download(dest_1);
   cv::imshow("lena_edge",dest_1);
   cv::waitKey();

} 
```

因此，从上面的代码中，我相信 CPU 和 GPU 中的内存都没有被释放。我在网上搜索了一下，发现 cv::Mat::Release 用于 cpu 和 cv::gpu::GpuMat::Release 用于 GPU 端。但我不知道如何使用它们或我应该如何在我的代码中使用这些函数，以便我可以释放我的 CPU 和 GPU 内存。如果有人可以指导我正确使用 Release api 以便我可以成功释放内存，那将非常有帮助。感谢您的支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T04:35:45.557

对象的析构函数`cv::Mat`会自动释放内存，调用您描述的释放函数。在您的代码级别，您不必担心这一点。一旦矩阵离开作用域，它就会被销毁。

如果您想手动销毁对数据的引用，您可以调用，例如，`src.release()`. OpenCV 文档中有一个很好的内存管理教程，可以[在这里找到](http://opencv.willowgarage.com/documentation/cpp/memory_management.html)

# objective-c - 内嵌块定义 - 如何？

> ID：13534973
> 
> 赞同：0
> 
> 时间：2012-11-23T19:49:16.057
> 
> 标签：objective-c, xcode, io, block, grand-central-dispatch

现在，我正在一个方法中分派一段代码，以使用以下格式为我下载东西：

```
dispatch_queue_t downloader("downloader", NULL);
dispatch_async (downloader, ^{

//do stuff

}); 
```

我现在要做的是让该块为我返回一个 UIImage，然后我可以将其用作该方法的返回：

```
-(UIImage *) myMethod:

dispatch_queue_t downloader("downloader", NULL);
dispatch_async (downloader, ^{

//do stuff to get UIImage

     dispatch_async (dispatch_get_main_queue, ^{

     return UIImage;  //this is the image that image I want myMethod to return

     });    
}); 
```

我如何将参数传递给不兼容的类型错误。我意识到这是因为我没有声明该块具有返回值。

如何声明该块在 dispatch_async 内返回 UIImage？这甚至是可能的，还是在块完成执行时该方法已经完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:55:15.930

好吧，使用 return 将要求您的方法是同步的，因此没有解决方案。您将需要使用块作为函数的一部分，如下所示：

```
- (void)myMethodOnFinish:(void(^)(UIImage *))finishBlock {

    dispatch_queue_t downloader("downloader", NULL);
    dispatch_async (downloader, ^{

        //do stuff to get UIImage
        UIImage *result = ...;

         dispatch_async (dispatch_get_main_queue, ^{
         //this is the image that image I want myMethod to return
             finishBlock(result);
        });    
    });
} 
```

并像这样调用：

```
[self myMethodOnFinish:^(UIImage *image) {

    self.imageView.image = image; // or whatever you need to do            

}]; 
```

# javascript - 根据变量显示选定的选项

> ID：13534980
> 
> 赞同：0
> 
> 时间：2012-11-23T19:49:44.647
> 
> 标签：javascript, jquery, html

我是一个非常新手的程序员，他正在尝试实现一些我认为很简单的东西，但是在搜索之后还没有找到解决方案。

所以现在我有一个名为**msg**的变量。**msg**是动态生成的，可以是 2-999 之间的任何值。

我有一个非常简单的选择：

```
<form method='post' class='myForm' action=''>
   <select name='locationSelect' class='locationSelect' data-param='location_IDNUMBER'>
        <option value='1'>Exam Room</option>
        <option value='2'>Exam Room 2</option>
        <option value='3'>X-Ray Room</option>
        <option value='1000'>Check Out</option>
   </select>
</form> 
```

我的问题是：假设**msg**的值为**3**。如何显示值为 3 的选择，所以选择的选项（在单击箭头之前首先可见的选项）是 X-Ray Room？

我的代码（从更大的代码块中取出是：

```
$e.find('.locationSelect').show(); 
```

我该如何修改它以说出类似的内容：

```
$e.find('.locationSelect':value=msg).show(); //this would show the .locationSelect with the selected value being the one with the id of 3, or whatever msg is 
```

感谢您的任何帮助！如果您需要更多详细信息，请询问！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:51:50.310

尝试

```
$e.find('.locationSelect').val(msg); 
```

[http://jsfiddle.net/mowglisanu/ktcgy/](http://jsfiddle.net/mowglisanu/ktcgy/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:52:17.757

您可以使用[$.fn.val(value)](http://api.jquery.com/val/#val2)设置下拉列表的选定值。

请注意，如果您传递给`$.fn.val`下拉列表中不存在的值，则会选择第一个选项。

# android - 在android中创建数据库表错误

> ID：13534981
> 
> 赞同：-1
> 
> 时间：2012-11-23T19:50:00.613
> 
> 标签：android, sqlite

我在 m 注册活动中编写的这段代码，但它给了我错误 ANR 并且没有生成数据库

注册按钮上的此代码

```
SQLiteDatabase db = openOrCreateDatabase("RoseDetails",MODE_APPEND, null);
    //          db.execSQL("create table if not exists table_register(firstname VARCHAR(20),lastname VARCHAR(20),emailaddress VARCHAR(20),gender VARCHAR(20),password VARCHAR(20),confirmpassword VARCHAR(20)");
    //          db.execSQL("INSERT into table_student values('"+firstname.getText()+"','"+lastname.getText()+"','"+emailid.getText()+"','"+gendervaule+"','"+Pwd.getText()+"','"+"','"+cpwd.getText()+"')");
    //          Cursor c=db.rawQuery("SELECT * FROM table_register" , null);
    //          while(c.moveToNext())
    //          {   
    //          if(c.moveToFirst())
    //          {
    //              String fn=c.getString(c.getColumnIndex("firstname"));
    //              String ln=c.getString(c.getColumnIndex("lastname"));
    //              String add=c.getString(c.getColumnIndex("emailaddress"));
    //              String g=c.getString(c.getColumnIndex("gender"));
    //              String p1=c.getString(c.getColumnIndex("password"));
    //              String p2=c.getString(c.getColumnIndex("confirmpassword"));
    //              Toast.makeText(this,"firstname"+fn+"\t"+"lastname"+ln+"\t"+"emailid"+add+"\t"+"gender"+g+"\t"+"pass"+p1+"\t"+"cpwd"+p2,Toast.LENGTH_LONG).show();
    //          }
    //          } 
    //          c.close();
    //          db.close(); 
```

**日志错误**

```
11-24 08:01:00.163: W/dalvikvm(278): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
11-24 08:01:00.193: E/AndroidRuntime(278): FATAL EXCEPTION: main
11-24 08:01:00.193: E/AndroidRuntime(278): android.database.sqlite.SQLiteException: near ")": syntax error: create table if not exists table_register(firstname VARCHAR(20),lastname VARCHAR(20),emailaddress VARCHAR(20),gender VARCHAR(20),password VARCHAR(20),confirmpassword VARCHAR(20)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.database.sqlite.SQLiteDatabase.native_execSQL(Native Method)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1727)
11-24 08:01:00.193: E/AndroidRuntime(278):  at com.example.orderplacemnet.Registration_Page.onClick(Registration_Page.java:158)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.view.View.performClick(View.java:2408)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.view.View$PerformClick.run(View.java:8816)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.os.Handler.handleCallback(Handler.java:587)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.os.Handler.dispatchMessage(Handler.java:92)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.os.Looper.loop(Looper.java:123)
11-24 08:01:00.193: E/AndroidRuntime(278):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-24 08:01:00.193: E/AndroidRuntime(278):  at java.lang.reflect.Method.invokeNative(Native Method)
11-24 08:01:00.193: E/AndroidRuntime(278):  at java.lang.reflect.Method.invoke(Method.java:521)
11-24 08:01:00.193: E/AndroidRuntime(278):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-24 08:01:00.193: E/AndroidRuntime(278):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-24 08:01:00.193: E/AndroidRuntime(278):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T09:09:16.247

最佳做法是先在 SQLITE 工具上执行查询，然后再放入代码。它将防止任何类型的语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T02:44:33.920

你忘了在这行末尾添加右括号

```
 db.execSQL("create table if not exists table_register(firstname VARCHAR(20),lastname VARCHAR(20),emailaddress VARCHAR(20),gender VARCHAR(20),password VARCHAR(20),confirmpassword VARCHAR(20)"); 
```

它应该是

```
 db.execSQL("create table if not exists table_register(firstname VARCHAR(20),lastname VARCHAR(20),emailaddress VARCHAR(20),gender VARCHAR(20),password VARCHAR(20),confirmpassword VARCHAR(20))"); 
```

# java - 可索引集合的抽象迭代器

> ID：13534985
> 
> 赞同：-4
> 
> 时间：2012-11-23T19:50:16.373
> 
> 标签：java, indexing, iterator, abstract-class

我的框架充满了迭代器，比如

```
int n = col.getSize();
for (int i = 0 ; i != n; i++) {
  Type obj = col.get(i); 
```

而且，我觉得每个在索引上迭代项目的程序都有一段这样的代码。与整洁的 foreach 相比，感觉很难看

```
for (Type obj : col) { 
```

转换到 foreach 需要使所有集合都可迭代，这意味着在每个 iterator() 方法中创建一个新的迭代器。现在，我在每个集合声明中都有丑陋的代码，而不是它的使用位置。所以，我做得很好，我把丑陋的代码移到了 common.utils 中。

```
public abstract class ImmutableIterator<T> implements Iterator<T> {
    private int i = 0; 
    private final int size = getSize();

    public abstract int getSize();  // to be implemented by user
    public abstract T getValue(int i); // to be implemented by user

    public T next() { 
        if (!hasNext()) throw new NoSuchElementException(); 
        return getValue(i++);
    }

    public boolean hasNext() { return i != size;}

    public void remove() {
        throw new UnsupportedOperationException("Remove is not implemented");
    }
} 
```

现在，我在唯一的地方隔离了这个丑陋的模式。这是我能做的最好的。集合将提供大小和值（i）。唯一的问题是性能损失：我必须在循环中进行两次大小检查，第一次是 hasNext，另一个是 next()。我想知道为什么 Sun 不提供这样的类？每个人都需要它。我只是忽略了它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:57:33.683

在抽象类中共享的代码非常少，因此抽象几乎没有带来什么好处。我认为在每个集合中从头开始实现这样的迭代器同样容易。在许多情况下，`hasNext`可能可以更直接地实施，例如。

看，你的抽象类的抽象行与非抽象代码行一样多。现在，许多类可能想要实现可变迭代器，那么您的抽象类中几乎没有任何东西。

另外，**它永远不需要改变**。如果抽象类允许您进行一次更改（例如错误修复）并同时修复多个类，则它特别棒。但是，这段代码如此简单，这会是什么错误呢？例如，“删除”中的“抛出”几乎没有错误 - 它永远不应该被执行。在多个迭代器之间共享它根本没有任何好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T12:30:52.967

Tomasz Nurkiewicz 将我们带到 Guava's `UnmodifiableIterator`。但是，这里只定义了 remove 方法，而我们也想要索引迭代。这个提示让 LouisWasserman 找到了一个更好的解决方案：`AbstractIndexedListIterator`做我们想要的。唯一的缺点是这个类没有实现remove方法，并且封闭在Guava包中。所有这些都告诉我们，这些类确实很有用，但必须由用户在他的框架中实现。

JB Nizet 提出了另一种解决方案。除了在 getSize/GetItem(idx) 方法之上实现迭代器接口，我们可以返回从底层集合中检索到的一个。

# ruby-on-rails - 如何将 jauggernaut 与 rails3 集成

> ID：13534986
> 
> 赞同：0
> 
> 时间：2012-11-23T19:50:26.967
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, plugins

如何将 juggernaut 插件与 rails 3 和 ruby​​ 1.9.3 集成

要遵循的步骤是什么。

我知道 github 上的 maccman / juggernaut_plugin，但我需要详细信息。

请给我建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-01T05:39:05.300

请查看 [http://www.golygon.com/2010/12/private-chat-room-in-ruby-on-rails-3-0](http://www.golygon.com/2010/12/private-chat-room-in-ruby-on-rails-3-0) 或 [http://dev.mensfeld.pl/2010/05 /juggernaut-rails-chat-part-i-what-is-and-how-to-install](http://dev.mensfeld.pl/2010/05/juggernaut-rails-chat-part-i-what-is-and-how-to-install)。它带有rails-3和ruby-1.9。

# ms-access-2003 - 条件格式问题

> ID：13534996
> 
> 赞同：1
> 
> 时间：2012-11-23T19:51:46.477
> 
> 标签：ms-access-2003

我在使用表格的条件格式时遇到了困难。我有三个条件和两个工作。

![在此处输入图像描述](../Images/e67a7f6b33c76a1992862b90f399a7ac.png)

条件 2 和 3 工作正常。条件 1 是另一回事。在我知道 2 和 3 工作后，我添加了条件 1。我基本上添加了第 3 个条件，然后将 1 换成 3，因为担心在满足条件 1 后条件停止。现在条件 1 是主要的。条件 1 不显示我做错了什么？