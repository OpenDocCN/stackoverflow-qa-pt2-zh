# StackOverflow 问答 13770000-13770999

# javascript - 如何将多个 JSON 从 servlet 传递到 Javascript

> ID：13770003
> 
> 赞同：0
> 
> 时间：2012-12-07T19:46:11.073
> 
> 标签：javascript, ajax, json, servlets

我想将 3 个 JSON 传递给前端。我可以单独通过所有 3 个。我这样做是为了检查它是否有效。

我这样做：

```
response.getWriter().write(json.toString()); 
```

我在这里的一篇文章中读到，您可以创建一个 json 数组并将该数组发送到 Ajax 调用。

所以我试着这样做：

```
String json = "["+ json1.toString() + "," + json2.toString() + "," + json3.toString() + "]"; 
response.getWriter().write(json.toString()); 
```

在房子的客户端：

```
$.ajax({
        data: {param1: 'p1', param2: 'p2', param3: 'p3', param4: 'p'},
        dataType: 'json',
        url: './GetDataServlet',
        type: 'POST',
        success: function(data) {
            var   data1 = data[0];
            var   data2 = data[1]; 
            var   data3 = data[2];
$.each(data1 , function(i, val) {
 $("#personal_data").append("<p> val.firstname </p>")
 $("#personal_data").append("<p> val.lastname </p>")
)};
$.each(data2 , function(i, val) {
 $("#department_data").append("<p> val.departmentid </p>")
 $("#demartment_data").append("<p> val.departmentname </p>")
)};

//Not attaching the entire code, because it's quite long. :) 
        },
        error: function() {
            alert("An error occured while attempting fetch data.");
        }
    }); 
```

进行 $.ajax 调用时，如何将多个 JSON 传递给客户端。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T19:52:23.850

您可以尝试发送三个对象的单个数组。`[Obj1 , Obj2 , Obj3]`

如果返回的三个对象取决于先前发送的对象（例如`Obj2`取决于`Obj1.X`属性是 true 还是 false，您可以进行三个单独的调用

```
var firstResult = $.ajax({  
    url : firstUrl  
    ... other details
});

var firstResult.done(function(Obj1){

  if(Obj1.X){
    $.ajax({  
      url : secondUrl  
      ... other details
    });

   ... other calls
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:53:27.537

在格式正确的 JSON 和 AJAX 请求/响应中，1 个调用提供 1 个 JSON 字符串。

当然，您可以在允许的 JSON 结构中随意组合这些 JSON 字符串。在您的情况下，在 JSON 数组包装器中组合三个 JSON 对象绝对没有错。

我想也许你唯一的问题在这里：

```
String json = "["+ json1.toString() + "," + json2.toString() + "," + json3.toString() + "]"; 
response.getWriter().write(json.toString()); 
```

您构建的 String`json`已经是一个字符串，因此您无需`toString()`再次调用它。做就是了：

```
String json = "["+ json1.toString() + "," + json2.toString() + "," + json3.toString() + "]"; 
response.getWriter().write(json); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-21T10:58:20.877

```
 var c1= new Object();
c1.property1="test";
c1.property2="test";

var c2= new Object();
c2.property1="test";
c2.property2="test";

var data = { 'c1': c1, 'c2': c2 };
var parameters1 = JSON.stringify(data);

In ajax call pass parameters1 as data.
  [WebMethod]
  public static bool TestMethod(Object c1, Object c2)
  {
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-06T20:45:41.417

我试图做同样的事情。我想将三个 json 对象传递给我的 javascript。我尝试将三个 json 对象制作成一个 json 数组并传递它，但这使情况变得非常复杂。

我发现传递一个由我选择“%”的字符分隔的字符串要容易得多。

```
 String json1 = "....";
    String json2 = "....";
    String json3 = "...";
    String toApp = json1 + "%" + json2 + "%" + json3; 
```

然后在javascript中你可以用

```
var split = line.split("%"); 
```

最后，一个 json 对象可以由 split[0]、split[1] 和 split[2] 组成。

# ios - UICollectionView：-[UICollectionView _endItemAnimations] 中的断言失败

> ID：13770008
> 
> 赞同：11
> 
> 时间：2012-12-07T19:46:46.407
> 
> 标签：ios, ipad, ios6, uicollectionview, assertions

我在我的应用程序中收到此错误：

*** 中的断言失败`-[UICollectionView _endItemAnimations]`，/SourceCache/UIKit/UIKit-2372/UICollectionView.m:2801

它发生在我的`-controllerDidChangeContent:`方法中：

```
[self.collectionView performBatchUpdates:^{...}]; 
```

有谁知道这是什么原因？我的代码与[https://gist.github.com/4440c1cba83318e276bb](https://gist.github.com/4440c1cba83318e276bb)密切相关，我不知所措。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-09T15:16:46.467

这些类型的断言作为异常抛出。将批量更新包装在 try/catch 中并转储异常描述。它会准确地告诉你它不喜欢你的电话的地方。

换句话说：

```
 @try
    {
        [self.collectionView performBatchUpdates:^{...}];
    }
    @catch (NSException *except)
    {
        NSLog(@"DEBUG: failure to batch update.  %@", except.description);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:08:19.073

我敢打赌是因为你的

```
-controllerDidChangeContent 
```

在后台线程中被多次调用，并且 performBatchUpdates 在另一个线程调用它时仍在工作，因此会导致不正确的行为。

解决方案 - 尝试将其包装在 @synchronized 或使用 NSLocks

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T00:32:20.053

问题不是在视图 didDisappear 上将 FRC 代表设置为 nil。

# c# - 已经包含一个定义

> ID：13770014
> 
> 赞同：6
> 
> 时间：2012-12-07T19:47:18.093
> 
> 标签：c#, visual-studio-2010

我有一堂课叫`Assign`和

```
 private int SeatNumber;

    public Assign(int SeatNum)
    {
        SeatNumber = SeatNum;
    }

    public int SeatNumber
    {
        get { return SeatNumber; }
        set { SeatNumber = value; }

    } 
```

我不知道为什么会出现以下错误

> E“WindowsFormsApplication1.Assign”类型已经包含“SeatNumber”的定义

怎么了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T19:49:56.840

您在这里声明了两次相同的变量。

```
private int SeatNumber;
public int SeatNumber
{
    get { return SeatNumber; }
    set { SeatNumber = value; }

} 
```

该代码两次定义了相同的变量。如果您使用的是 .net 3.0+，则可以使用 no 执行这样的自动实现属性`private int SeatNumber`：

```
public int SeatNumber
{
    get;
    set;
} 
```

否则，您应该这样做：

```
private int SeatNumber_;
public int SeatNumber
{
    get { return SeatNumber_; }
    set { SeatNumber_ = value; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T19:49:30.150

您应该确保支持该属性的变量具有不同的名称。通常使用 camelCase：

```
private int seatNumber;

public Assign(int SeatNum)
{
    SeatNumber = SeatNum;
}

public int SeatNumber
{
    get { return seatNumber; }
    set { seatNumber = value; }
} 
```

此外，在 getter 和 setter 很简单的情况下，从 C# 3.0 开始，您可以使用*自动属性*，如下所示：

```
public int SeatNumber {get; set;} 
```

这使您可以删除支持变量：编译器将为您处理它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T19:49:15.423

私有变量和公共变量不能具有相同的名称，这就是冲突的来源。做这个：

```
private int _seatNumber;

public Assign(int SeatNum)
{
    SeatNumber = SeatNum;
}

public int SeatNumber
{
    get { return _seatNumber; }
    set { _seatNumber = value; }

} 
```

下划线符号对于私有变量很常见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T20:06:22.977

引发错误是因为您基本上是在构造函数中为 SeatNumber 分配了一些东西，然后在属性中再次执行此操作。在 Visual Studio 中创建类字段时，键入“propfull”并按两次 Tab 键。这将自动为您创建字段和属性。

对于它的价值，这是构建类的普遍接受的方式。

```
class Assign
   {
      //Fields
      private int _seatNumber;

      //Properties
      public int SeatNumber
      {
         get { return _seatNumber; }
         set { _seatNumber = value; }
      }

      //Overloaded Constructors
      public Assign(int sn)
      {
         SeatNumber = sn;
      }
      public Assign()
      {

      }

      //Methods 
      public void SomeMethod()
      {
         //insert code
      }
      public void SomeOtherMethod()
      {
         //insert code
      }

   }//END ASSIGN CLASS 
```

# sql - postgresql 将变量发送到函数，强制转换？

> ID：13770016
> 
> 赞同：2
> 
> 时间：2012-12-07T19:47:26.517
> 
> 标签：sql, postgresql, plpgsql, postgresql-8.4

在一个地方我有

```
CREATE FUNCTION updateGeo2(text, float4, float4) RETURNS float AS $$ 
```

随后是

```
SELECT updateGeo2('area', 40.88, -90.56); 
```

我得到

```
error : ERROR:  function updategeo2(unknown, numeric, numeric) does not exist 
```

所以它不知道我试图传入一个文本变量，然后是一个浮点变量和另一个浮点变量，它认为这些是“未知的，数字和数字”，la脚。我如何让它知道我传入的类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:05:18.717

试试这种方式：

```
SELECT updateGeo2('area', (40.88)::float4, (-90.56)::float4); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:37:42.890

### 澄清误解

首先，这应该**按原样工作**，没有类型转换。我使用 PostgreSQL 9.1、9.2 和**8.4.15**进行了测试。您必须运行较早的版本，否则存在其他误解（例如 wrong `search_path`）。您的信息具有*误导性*。

除了临时调用之外，您应该始终添加显式类型转换以消除歧义。PostgreSQL 允许[*函数重载*](http://www.postgresql.org/docs/current/interactive/xfunc-overload.html)。如果应该使用签名创建另一个函数：

```
CREATE FUNCTION updateGeo2(text, numeric, numeric) RETURNS text AS $$ .. 
```

`numeric`...然后由于数字文字的默认类型，它将优先于另一个。现有代码可能会中断。

另一方面，如果您添加一个函数：

```
CREATE FUNCTION updateGeo2(char(5), numeric, numeric) RETURNS text AS $$ .. 
```

然后 Postgres 不知道该做什么了，抛出异常：

> 错误：函数 updategeo2(unknown, numeric, numeric) 不是唯一的

### 正确的语法

```
SELECT updateGeo2('area', '40.88'::float4, '-90.56'::float4); 
```

或者，在标准 SQL 中更详细：

```
SELECT updateGeo2('area', cast('40.88' AS float4), cast('-90.56' AS float4)); 
```

或者，如果您真的想避免使用单引号（和冒号）：

```
SELECT updateGeo2('area', float4 '40.88', float4 '-90.56'); 
```

这样，您可以直接将*数字文字*转换为数据类型[`float4`](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html)(= [`real`](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html))。[有关手册中类型转换](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS-GENERIC)
的 更多信息。

`(40.88)::float4`也有效，但效果稍差。首先，`40.88`被认为是类型`numeric`（这个包含点的数字文字的默认类型）。然后将该值强制转换为`float4`. 进行两种类型转换。

[有关手册中数字常量](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS-NUMERIC)的更多信息。

# linq - Linq to Entities where 导航属性子句

> ID：13770019
> 
> 赞同：1
> 
> 时间：2012-12-07T19:47:49.193
> 
> 标签：linq, entity-framework, linq-to-entities

我有这个相当简单的 SQL 查询：

```
SELECT i.IdItem
FROM Item i
INNER JOIN Size s ON i.IdItem = s.IdItem
WHERE s.Width > 0 AND s.Width < 100 
```

...我一直试图将其转换为 LINQ 到实体，但无济于事。

到目前为止，这就是我想出的：

```
context.Items.Where(i => i.Sizes.Where(s => s.Width > 0 && s.Width < 100)) 
```

我的（上下文）中有一个`DbSet`项目`DatabaseContext`和大小，我的`Item`实体有一个`Sizes`导航属性。

这不编译，给我一个`Cannot implicitly convert type 'System.Collections.Generic.IEnumerable' to 'bool'`错误。我有一种感觉，我在这里遗漏了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T19:50:39.110

```
context.Items.Where(i => i.Sizes.Any(s => s.Width > 0 && s.Width < 100)) 
```

`Where`给你一个`IEnumerable`不能用作条件的

# sql - T-SQL：在循环内使用打印语句查询返回的结果不一致

> ID：13770025
> 
> 赞同：1
> 
> 时间：2012-12-07T19:48:27.987
> 
> 标签：sql, sql-server, tsql

尝试在循环中使用 print 语句时出现意外结果。

这是循环。现在，我碰巧知道此表中没有 createDtTm 早于 2012 年 6 月的数据。

我试图返回格式良好的结果，并在单个窗格中剔除空值，因此所有转换并将返回的数据放入 @text 变量中进行打印。

```
Declare @month int, @day int, @text VARCHAR(max)
Select @month=1
Select @day=1

While @month < 13  Begin
    While @day < 32 Begin
        select @month, @day
        set @text = (SELECT cast(min([createDtTm]) as varchar(50)) + ' | ' +  cast(max([createDtTm]) as varchar(50)) + ' | ' +  cast(DATEDIFF (ss, min([createDtTm]), max([createDtTm])) as varchar(50))
            FROM [database].[dbo].[table]
                where datepart(yy, createDtTm) = 2012
                and datepart(mm, createDtTm) = @month
                and datepart(dd, createDtTm) = @day
                and datepart(hh, createDtTm) > 17
                and cast(Request as varchar(max)) like '%sometext%');
        print @text
        Set @day = @day + 1
        End
    Set @month = @month + 1
    Set @day = 1
End 
```

此查询返回我期望的结果。

当我注释掉调试语句时

```
select @month, @day 
```

我没有得到任何结果。仅在内循环中执行 SELECT 会返回一个长长的窗格，其中包含“NULL”和“（受影响的 1 行）”之类的文本，我宁愿避免这种情况。

想法？今天早上我刚刚学习了变量设置、PRINT、WHILE 和 BEGIN/END 语句的机制，所以我很高兴我得到了一些回报，但我想了解明显的不一致之处。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:11:13.913

你需要使用

```
declare @a VARCHAR(max);
declare @b VARCHAR(max);

SELECT @a = '1',@b = '2'

print @a + @b 
```

您不能将选择查询打印为打印

# python - python中打印语句的语法错误

> ID：13770028
> 
> 赞同：1
> 
> 时间：2012-12-07T19:48:37.247
> 
> 标签：python

> **可能重复：**
> [“打印”附近的语法错误？](https://stackoverflow.com/questions/12593502/syntaxerror-near-print)

我现在在 python 中有一个非常奇怪的语法错误。这是代码的一部分：

```
tradeID = contract.get('tradeId')
itemID = contract.get('itemData').get('id')
if client.buyItem(tradeID, 200):
    print 'Bought Contract for 200 coins'
    if client.moveCard(str(itemID), 'trade'):
        client.postTrade(str(itemID), str(250), str(0), str(3600))
        print 'Contract posted For 250 Coins' 
```

它说该行的语法错误`print 'Bought Contract for 200 coins'`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:18:01.153

如果您使用的是 Python3，则需要将 print 视为函数：

```
print('Contract posted For 250 Coins') 
```

您可以使用自动[2to3](http://docs.python.org/2/library/2to3.html)转换脚本来生成一个差异，以纠正像这样的大多数问题。

# gem - 不带导轨的 RSpec、FactoryGirl 和 ActiveRecord 测试

> ID：13770029
> 
> 赞同：1
> 
> 时间：2012-12-07T19:48:44.207
> 
> 标签：gem, rspec2, factory-bot

我正在构建一个独立的 gem，你可以在这里查看源代码： [https ://github.com/mabounassif/facebook_event_fetcher.git](https://github.com/mabounassif/facebook_event_fetcher.git)

使用我当前的设置，如果不先设置测试数据库，我将无法使用 FactoryGirl 进行测试。“准备”我的测试数据库的正确方法是什么？

我想到的解决方案是创建一个 db:test:prepare rake 任务。基本上，它会删除 test.sqlite3 文件（如果存在），然后创建一个新文件并使用正确的表设置迁移数据库。起初这似乎是一个干净的解决方案，但是当我运行 rake 任务时，我得到了 ActiveRecord NotConnected，而且我不得不在 Rakefile 中设置连接似乎很麻烦，尤其是我已经在 spec_helper 中完成了。 rb。它似乎重复和不干净。

谁能暗示我应该如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:43:12.540

我终于选择在 Rakefile 中再次设置 ActiveRecord 连接。这是我的最终设置，可能对那里的人有用：

[https://github.com/mabounassif/facebook_event_fetcher](https://github.com/mabounassif/facebook_event_fetcher)

最有趣的部分是 rake 文件：

```
namespace :db do
  desc "Migrate the database through scripts in lib/generators/facebook_event_fetcher/install/templates. Target specific version with VERSION=x"
  task :prepare => :environment do
    ActiveRecord::Migration.verbose = true
    ActiveRecord::Migrator.migrate('lib/generators/facebook_event_fetcher/install/templates', nil)
  end

  task :environment do
    File.delete('db/test.sqlite3') if File.exist?('db/test.sqlite3')
    ActiveRecord::Base.establish_connection(YAML.load_file("config/database.yml"))
    ActiveRecord::Base.logger = Logger.new(File.open('db/database.log', 'a')) 
  end
end 
```

# math - Mathematica 指数方程（基本代数）

> ID：13770031
> 
> 赞同：0
> 
> 时间：2012-12-07T19:49:01.633
> 
> 标签：math, wolfram-mathematica, calculus

我目前正在做一个 Mathematica 项目来计算黎曼和并将它们放在一个表中。我无法打印行号（间隔）。（行号也是辅助功能的参数）。我不知道有什么方法可以访问 Mathematica 表中迭代器的索引，所以我试图使用函数参数来计算它们。

这是我要打印的示例，用于 x^2 在 {0, 1} 范围内的积分，具有 10 个细分。

```
tableRiemannSums[#^2 &, {0, 1}, 10] 
```

![在此处输入图像描述](../Images/27c139924d148296464dd65473b34f5f.png)

我需要根据当前细分k的值，积分{a，b}的范围以及细分的数量n来计算每次迭代的索引是多少。下面是主要的代码。

```
tableRiemannSums[fct_, {a_, b_}, n_] := Table[{'insert index here', 
leftRiemannSum[fct, {a, b}, 'insert index here'], 
rightRiemannSum[fct, {a, b}, 'insert index here']}, 
{k, a, b - (N[b - a]/n), N[b - a]/n}] 
```

在上面的等式中，线

```
{k, a, b - (N[b - a]/n), N[b - a]/n}] 
```

表示表格的范围是 k，因为 k 从 'a' 到 'b - ((b - a)/n)'，步长为 '(b - a)/n'。

在我的代码显示“在此处插入索引”的每个地方，我都需要输入相同的等式。现在，我正在使用 'n * k + 1' 来计算索引，它适用于正范围，但是当我有像 {a,b} = {-1, 1} 这样的范围时会中断。

我认为这是一个相当简单的代数问题，但我已经绞尽脑汁好几个小时了，找不到一个通用方程。

（如果这是一个重复的问题，我深表歉意 - 我尝试搜索堆栈溢出档案，但很难将我的问题总结为几个关键词。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T21:05:15.707

我终于想出了如何解决这个问题。我在考虑范围，而不是依靠内部函数来控制它。我将函数重写为：

```
tableRiemannSums[fct_, {a_, b_}, n_] := Table[{k,
   leftRiemannSum[fct, {a, b}, k], 
   rightRiemannSum[fct, {a, b}, k]},
   {k, 1, n}}] 
```

作为参考，这里是左右总和（任何有兴趣的人！）：

```
leftRiemannSum[fct_, {a_, b_}, n_] :=
 N[b - a]/n* Apply[Plus, Map[fct, Range[a, b - N[b - a] / n, N[b - a]/n]]]
rightRiemannSum[fct_, {a_, b_}, n_] := 
 N[b - a]/n* Apply[Plus, Map[fct, Range[a + (N[b - a]/n), b, N[b - a]/n]]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T02:56:43.740

您可能要考虑的是创建一个函数来制作表格的每一行。这个函数的一个参数是行号。

使用 MapIndexed 执行此函数，这将为您提供一种根据需要遍历范围的方法，同时提供递增的行号。

（创建一个包含值范围的列表，然后将 MapIndexed 函数应用于此列表。）

# reporting-services - 如何使用 BIDS 中的共享数据集创建新报告

> ID：13770034
> 
> 赞同：1
> 
> 时间：2012-12-07T19:49:10.900
> 
> 标签：reporting-services, ssrs-2008, bids

有没有办法配置 BIDS，以便在创建新报表时可以选择以前创建的共享数据集，而不必构建查询，然后在向导完成后替换共享数据集？

目前我正在 BIDS 中创建共享数据集，发布到服务器，并在报表生成器中启动新报表，下载报表，然后将报表添加到我的解决方案中并修复共享数据集后记。至少可以说这很笨拙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:01:57.463

我所做的是创建一个“模板”报告，其中存储了所有数据集。然后，我只需将该“模板”报告添加到任何需要它的项目中。使用此模板，我还可以包含常用字段，例如报告的运行时间、页码、创建的报告，以及公司徽标和报告标题的文本框（我喜欢的格式）。

这能完成你所需要的吗？

# ios - 如何将 NSURL 对象复制到 CFURL 结构数组

> ID：13770040
> 
> 赞同：0
> 
> 时间：2012-12-07T19:49:29.587
> 
> 标签：ios, cocoa

我有`ivar`一个“普通”C 结构数组`CFURLRef`。我称之为`sourceURLArray`。我初始化它以容纳六个元素。

稍后，在一个函数中，我创建（alloc/init）一个`NSURL*`对象。我调用它`fileURL`，我想将该对象的副本保存到上述数组的第一个元素中。我以为我需要做的就是：

```
 sourceURLArray[0] = (__bridge CFURLRef)([fileURL copy]); 
```

但是，当我执行代码时，我第二次通过该函数将**消息发送到已释放的实例消息。**在检查变量后，在上面的行执行后，`sourceURLArray[0]`它的地址与`fileURL`. 由于`fileURL`函数完成时超出范围，因此将`sourceURLArray[0]`释放地址。

似乎我误解了关于复制、免费桥接的细微差别或两者兼而有之的基本知识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:55:51.130

尝试：

```
sourceURLArray[0] = (__bridge_retained CFURLRef)([fileURL copy]); 
```

或者：

```
sourceURLArray[0] = (CFURLRef)CFBridgingRetain([fileURL copy]); 
```

这告诉 ARC 您正在将所有权转移到另一个阵列。`CFURLRef`您现在必须在某个时候正确调用 CFRelease 。

# php - PHP：返回最后一个 json 对象

> ID：13770049
> 
> 赞同：0
> 
> 时间：2012-12-07T19:50:02.630
> 
> 标签：php, json

**编辑**

感谢您对此的所有输入，我确实在我的问题中发现了错误，因此现在进行修改。对此感到抱歉。

我试图弄清楚如何返回我渲染的 JSON 字符串中的最后一个对象。我正在使用的两个功能：

```
public function revision($return = false)
    {
        $id = $this->input->post('galleryID');
        $data = array('revision_count' => $this->revision->count_revision($id) );

        if($return){
            return json_encode($data);
        }
        else {
            echo json_encode($data);
        }
    }

public function last_revision()
        {
            $allRevisions = json_decode($this->revision(),true);
            return end($allRevisions);
        } 
```

问题是 end() 返回错误，指出第一个参数应该是数组。

感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:54:49.317

您可以将 edit_function() 更改为：

```
public function edit_revision($return = false)
{
  $galleryID  = $this->input->post('galleryID');
  $revisionID = $this->input->post('revisionID');

  $data = array('revision_images' => $this->revision->get($galleryID, $revisionID) );

  if($return)
    return json_encode($data);
  else
    echo json_encode($data);
} 
```

进而：

```
public function last_revision(true)
{
  $allRevisions = json_decode($this->revision());

   return end($allRevisions);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:48:30.150

这里需要注意`json_decode`的是，默认情况下返回 stdClass 的一个实例。尝试使用`json_decode($jsonstring, true)`将 JSON 作为 PHP 关联数组返回。

但是，您没有包括该`$this->revision()`方法的作用。您能否显示该部分代码，因为这是您从中获取返回值的函数？

编辑：

好的，在我们在您的代码中看到正确的函数之后，我想说几件事：

*   您已在`revision`方法中添加了 $return 参数，但在需要时并未使用它。你应该改变`$this->revision()`你`$this->revision(true)`的`last_revision`方法。
*   如果您要从该`revision()`方法返回数据，那么它并没有多大意义`json_encode`，只针对`json_decode`结果。只需传回原始数据数组。
*   一旦你改变了这两个东西，这应该工作：

    `$allRevisions = $this->revision(true); return end($allRevisions['revision_count']);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T19:56:41.700

也许您需要将该 json 输出转换为 php 数组（json_decode() 函数），然后您可以使用 array_pop() 函数获取最后一项： [https ://php.net/array_pop](https://php.net/array_pop)

# eclipse - Eclipse JSF 自动完成

> ID：13770050
> 
> 赞同：1
> 
> 时间：2012-12-07T19:50:12.507
> 
> 标签：eclipse, jsf, jsf-2, mojarra

我在 Linux (Ubuntu 12.04 LTS) 上有 Eclipse Juno 这是我的版本：

版本：Juno Service Release 1 内部版本 ID：20121004-1855

在 OSX 10.8.2 我有：

版本：Juno 发布版本 ID：20120614-1722

当我为 JSF 编辑一个 xhtml 文件时，我会在两者上自动完成我的 JSF bean，这很棒，但在 OSX 上的自动完成要好得多。以下是一些不同之处：

Mac：在任何地方开始自动完成，它会为您填写#{}。

Linux：仅在 #{} 内启动自动完成。

Mac：bean 返回的对象的自动完成，例如在 ui:repeat my var="object" 上可用于自动完成。

Linux：不可用。

这种行为有什么原因吗？这可能与我的项目设置有关吗？由于工作环境不同，它们是不同的项目。这两个项目都使用 JSF 2.1 作为项目方面，都使用 mojarra，不确定这是否会有所不同。

谢谢。

# c# - 自定义组合框、组合项

> ID：13770052
> 
> 赞同：1
> 
> 时间：2012-12-07T19:50:14.020
> 
> 标签：c#, wpf, combobox

我需要创建一个显示形状的自定义组合框。我通过扩展 Shape 类来创建形状，并像这样实现 DefiningGeometry 函数：

```
public abstract class MyShape : Shape
{

    public static readonly DependencyProperty SizeProperty = DependencyProperty.Register("Size", typeof(Double), typeof(MapShape));
    public static readonly DependencyProperty RotationAngleProperty = DependencyProperty.Register("RotationAngle", typeof(Double), typeof(MapShape), new PropertyMetadata(0.0d));

    public double Size
    {
        get { return (double)this.GetValue(SizeProperty); }
        set { this.SetValue(SizeProperty, value); }
    }

    public double RotationAngle
    {
        get { return (double)this.GetValue(RotationAngleProperty); }
        set { this.SetValue(RotationAngleProperty, value); }
    }

    protected override Geometry DefiningGeometry
    {
        get
        { return null; }
    }
} 
```

我可以扩展该类并创建我想要的任何其他形状。例如，我有一个看起来像箭头的：

```
public class Arrow : MyShape
{
    public Arrow() { 
    }

    protected override Geometry DefiningGeometry
    {
        get
        {
            double oneThird = this.Size / 3;
            double twoThirds = (this.Size * 2) / 3;
            double oneHalf = this.Size / 2;

            Point p1 = new Point(0.0d, oneThird);
            Point p2 = new Point(0.0d, twoThirds);
            Point p3 = new Point(oneHalf, twoThirds);
            Point p4 = new Point(oneHalf, this.Size);

            Point p5 = new Point(this.Size, oneHalf);
            Point p6 = new Point(oneHalf, 0);
            Point p7 = new Point(oneHalf, oneThird);

            List<PathSegment> segments = new List<PathSegment>(3);
            segments.Add(new LineSegment(p1, true));
            segments.Add(new LineSegment(p2, true));
            segments.Add(new LineSegment(p3, true));
            segments.Add(new LineSegment(p4, true));

            segments.Add(new LineSegment(p5, true));
            segments.Add(new LineSegment(p6, true));
            segments.Add(new LineSegment(p7, true));

            List<PathFigure> figures = new List<PathFigure>(1);
            PathFigure pf = new PathFigure(p1, segments, true);
            figures.Add(pf);
            RotateTransform rt = new RotateTransform(this.RotationAngle);

            Geometry g = new PathGeometry(figures, FillRule.EvenOdd, rt);

            return g;
        }
    }
} 
```

我可以在 XAML 或代码上添加这些形状，它们工作得很好。

现在，这些形状显示在我表单中某个不相关的图形对象上。我的要求是客户端从 ComboBox 更改表单中图形对象上的形状。所以，基本上我还需要在组合框中显示形状。我真的不需要使用我在这里展示的这些类，只是为了澄清我将它们添加到这个注释中。但我确实需要自定义组合框以显示项目中的形状。我认为的一种方法是使用 ControlTemplate，还有其他想法、代码、读数吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:57:13.403

如果我理解的话，你想要的可以通过自定义`ItemTemplate`.`ComboBox`

```
 <ComboBox ...>
      <ComboBox.ItemTemplate>
          <DataTemplate>
             <!-- Whatever UI -->
          </DataTemplate>
      </ComboBox.ItemTemplate>
 </ComboBox> 
```

# mysql - SQL多次显示同一列

> ID：13770058
> 
> 赞同：2
> 
> 时间：2012-12-07T19:50:25.193
> 
> 标签：mysql, pivot

表 1 有，NameId、年龄、性别...
表 2 有版本号、时间戳...

现在我想从表1中选择NameId，从表2中多次选择版本号和时间戳，我需要从表2中查询所有版本和时间记录，谁能给我一些关于如何查询的想法？

```
NameId  |   Version/Time        |   Version/Time    |   Version/Time …

Angela  |    1  /  01.01.2010   |   2 / 01.02.2010  |   3 / 01.03.2010
Betty   |    1  /  01.01.2010   |   2 / 01.02.2010  |   3 / 01.03.2010
Cathy   |    1  /  01.01.2010   |   2 / 01.02.2010  |   3 / 01.03.2010
...     |   ....                |                   | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:01:46.847

如果如您所说，任何固定值集都不起作用，那么您将需要动态 sql 来执行您的数据透视。

这些方面的东西：

```
CREATE PROCEDURE [dbo].[usp_pivot_]
AS

DECLARE @columns VARCHAR(1000)

SELECT @columns = COALESCE(@columns + ',[' + cast(versionTime as varchar) + ']',
'[' + cast(versionTime as varchar)+ ']')
FROM table1 inner join table2 on table1.NameId = table2.NameId
GROUP BY versionTime 

DECLARE @query VARCHAR(8000)

SET @query = '
SELECT *
FROM table1 inner join table2 on table1.NameId = table2.NameId
PIVOT
(
first(versionTime)
FOR [versionTime]
IN (' + @columns + ')
)
AS p'

EXECUTE(@query) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:39:17.137

通常的方法是在两个表之间执行 JOIN，例如

```
SELECT t1.NameId
     , t2.VersionNo
     , t2.Timestamp
  FROM table_one t1
  LEFT
  JOIN table_two t2
    ON t2.NameId = t1.NameId
 ORDER
    BY t1.NameId
     , t2.VersionNo 
```

这将为您提供如下结果集：

```
NameId   VersionNo TimeStamp
-------- --------- ----------
Angela   1         01.01.2010   
Angela   2         01.02.2010  
Angela   3         01.03.2010
Betty    1         01.01.2010   
Betty    2         01.02.2010  
Betty    3         01.03.2010
Cathy    1         01.01.2010   
Cathy    2         01.02.2010  
Cathy    3         01.03.2010 
```

（这假设`table_two`与`table_one`NameId 值相关。原始问题中提供的示例数据留下了与（即笛卡尔积）`table_two`中的每一行匹配的三行的可能性`table_one`。在这种情况下，它将是CROSS JOIN 语句中：

```
SELECT t1.NameId
     , t2.VersionNo
     , t2.Timestamp
  FROM table_one t1
 CROSS
  JOIN table_two t2
 ORDER
    BY t1.NameId
     , t2.VersionNo 
```

* * *

要将来自该查询的结果集转换为“交叉表”（或数据透视表），每个单独的行都`table_two`显示在同一行输出中，这通常在客户端而不是 SQL 语句中更好地处理。

但是，MySQL 可以返回一个类似的结果集，每个 VersionNo 和 Timestamp 值在一个单独的列中；但要做到这一点的查询并非易事。

（一个简单的替代方法是使用 GROUP_CONCAT 聚合函数，但它返回单个列，而不是单独的列，并且受`max_allowd_packet_size`.）

```
SELECT t1.NameID
     , GROUP_CONCAT(CONCAT(t2.VersionNo,'/',t2.Timestamp) ORDER BY t2.VersionNo)
  FROM table_one t1
  LEFT
  JOIN table_two t2
    ON t2.NameId = t1.NameId
 GROUP
    BY t1.NameId
 ORDER
    BY t1.NameId 
```

* * *

再次假设`table_two`与 相关`table_one`，一种相当笨拙但易于理解的方法是在查询的 SELECT 列表中使用相关子查询，例如

```
SELECT t1.NameId
     , ( SELECT CONCAT(t2a.VersionNo,' / ',t2a.Timestamp)
           FROM table_two t2a WHERE t2a.NameId = t1.NameID
          ORDER BY t2a.VersionNo LIMIT 0,1 
       ) AS `Version/Time`
     , ( SELECT CONCAT(t2b.VersionNo,' / ',t2b.Timestamp)
           FROM table_two t2b WHERE t2b.NameId = t1.NameID
          ORDER BY t2b.VersionNo LIMIT 1,1 
       ) AS `Version/Time`
     , ( SELECT CONCAT(t2c.VersionNo,' / ',t2c.Timestamp)
           FROM table_two t2c WHERE t2c.NameId = t1.NameID
          ORDER BY t2c.VersionNo LIMIT 2,1
       ) AS `Version/Time`
  FROM table_one t1
 ORDER BY t1.NameId 
```

该查询将返回一个类似于原始问题中显示的结果集，尽管返回的列数是在 SELECT 语句中静态定义的。

# sql - 搜索 Invoice Tablle 以查找数量 >0 和 <0 的发票

> ID：13770059
> 
> 赞同：0
> 
> 时间：2012-12-07T19:50:35.063
> 
> 标签：sql

我正在为数量 >0 和 <0 的发票搜索发票明细表。发票明细表包含发票中所有项目的详细信息。如何编写一个查询来提供所有项目数量 > 0 和 <0 的发票。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:51:06.163

这样的事情怎么样？这使用两个查询。第一个查找所有带有负数的发票。然后它应用第二个查询从该发票列表中仅查找那些也具有正数量的发票。

```
SELECT DISTINCT
  PosNegInvoices.InvoiceID 
FROM ItemizedInvoice AS NegInvoices
CROSS APPLY
(
  SELECT
    InvoiceID
  FROM ItemizedInvoice 
  WHERE InvoiceID = NegInvoices.InvoiceID
  AND Quantity > 0
) AS PosNegInvoices
WHERE NegInvoices.Quantity < 0 
```

这是另一个使用 CTE 的版本：

```
WITH NegInvoices AS
(
  SELECT
    InvoiceID
  FROM ItemizedInvoice
  WHERE Quantity < 0
),
PosInvoices AS 
(
  SELECT
    InvoiceID
  FROM ItemizedInvoice
  WHERE Quantity > 0
)
SELECT DISTINCT
  PosInvoices.InvoiceID
FROM NegInvoices 
JOIN PosInvoices
ON NegInvoices.InvoiceID = PosInvoices.InvoiceID 
```

# c# - 列表 .Add() 不按顺序添加元素？

> ID：13770071
> 
> 赞同：1
> 
> 时间：2012-12-07T19:51:10.850
> 
> 标签：c#, list, insert, add

我有一个`List<OrderItem> orderItems`包含数据库中我正在处理的一批订单的所有项目。我还有一个`Dictionary<int, Order> order_list`包含项目需要进入的订单。Order 对象有一个`List<OrderItem>`名为 OrderItems 的成员。

我在 order_list 中有一个 ID 为 1 的订单。我在 OrderItems 中有三个项目，它们带有 1 的 order_id 和三个不同的产品变体 id。

从数据库中获取按产品变体 ID 的顺序检索项目。这意味着 orderItems 看起来像这样：

> [0] => orderId = 1，productVariantId = 4
> [1] => orderId = 1，productVariantId = 5
> [2] => orderId = 1，productVariantId = 6

在我的代码中，我有一个循环遍历 orderItems 并将它们分配给各自的订单：

```
foreach (OrderItem orderItem in orderItems)
{
    if (order_list.ContainsKey(orderItem.OrderId))
    {
        order_list[orderItem.OrderId].OrderItems.Add(orderItem);
    }
} 
```

循环执行后，我发现订单 1 的 OrderItems 成员如下所示：

> [0] => orderId = 1，productVariantId = 5
> [1] => orderId = 1，productVariantId = 6
> [2] => orderId = 1，productVariantId = 4

我仔细浏览了代码，看着它插入了元素。这是我看到的：

产品变体 4 的迭代 1，最终的 OrderItems 如下所示：

> [0] => orderId = 1，productVariantId = 4

产品变体 5 的迭代 2，最终的 OrderItems 如下所示：

> [0] => orderId = 1，productVariantId = 5
> [1] => orderId = 1，productVariantId = 4

产品变体 6 的迭代 3，最终的 OrderItems 如下所示：

> [0] => orderId = 1，productVariantId = 5
> [1] => orderId = 1，productVariantId = 6
> [2] => orderId = 1，productVariantId = 4

我的研究使我得出结论，这不应该表现得如此，因为该`List<T>.Add()`方法应始终将新元素添加到列表的 END 中。谁能告诉我为什么`List<T>.Add()`没有在我的应用程序中按顺序添加元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T16:17:39.600

[MSDN](http://msdn.microsoft.com/en-us/library/3wcytfd1.aspx)文档中的第一行说“将对象添加到 List<T> 的末尾”，所以是的，顺序保持不变。除了简单的列表操作之外，您的代码还有很多事情要做，但是您的示例还不够完整，无法告诉您错误是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:36:32.273

我发现这个问题没有提供足够的代码。由于我无法发表评论，这是我通过 LinqPad 的解释：

```
void Main()
{
    //populate
    var dbOrderItems = new List<OrderItem>();
    dbOrderItems.Add(new OrderItem { OrderId = 1, ProductVariantId = 4 });
    dbOrderItems.Add(new OrderItem { OrderId = 1, ProductVariantId = 5 });
    dbOrderItems.Add(new OrderItem { OrderId = 1, ProductVariantId = 6 });
    dbOrderItems.Add(new OrderItem { OrderId = 2, ProductVariantId = 10 });
    dbOrderItems.Add(new OrderItem { OrderId = 2, ProductVariantId = 11 });
    dbOrderItems.Dump();

    Dictionary<int, Order> order_list = new Dictionary<int, Order>();
    foreach(OrderItem orderItem in dbOrderItems)
    {
        if (order_list.ContainsKey(orderItem.OrderId))
        {
            var currOrderItems = order_list[orderItem.OrderId].OrderItems;
            if (currOrderItems.Contains(orderItem) == false)
            {
                // order exists, add new order item
                currOrderItems.Add(orderItem);
                order_list[orderItem.OrderId].OrderItems = currOrderItems; 
            }
        }
        else
        {
            // new order
            order_list.Add(orderItem.OrderId, new Order { OrderId = orderItem.OrderId, OrderItems = new List<OrderItem> { orderItem } });
        }
    }

    order_list.Dump();

}

// Define other methods and classes here
public class OrderItem
{
    public int OrderId {get;set;}
    public int ProductVariantId {get;set;}
}

public class Order
{
    public int OrderId {get;set;}
    public List<OrderItem> OrderItems {get;set;}
} 
```

订单 1 的输出：

```
OrderId ProductVariantId 
1 4 
1 5 
1 6 
```

订单 2 的输出：

```
OrderId ProductVariantId 
2 10 
2 11 
```

现在，问题是什么？

# mongodb - 使用 MondoDB 跟踪正在进行的更新的正确方法是什么？

> ID：13770079
> 
> 赞同：0
> 
> 时间：2012-12-07T19:52:20.810
> 
> 标签：mongodb

我有一个包含一堆代表各种项目的文档的集合。偶尔，我需要更新项目属性，但更新需要一些时间。更新属性时，该项目会获得一个新的时间戳，说明它何时被修改。如果我一次运行一个更新，那么就没有问题。但是，如果我想同时运行多个更新进程，有可能一个进程开始更新项目，但下一个进程仍然认为项目需要更新并开始更新它。

一种解决方案是在检索到更新后立即标记该项目（findAndModify），但是为每个文档添加一个完整的额外字段只是为了跟踪当前正在更新的项目似乎很浪费。

这应该是一个非常普遍的问题。也许有一些内置函数可以解决这个问题？如果没有，是否有标准的既定方法来处理它？

如果之前已解决此问题，我深表歉意，但我很难找到此信息。我可能只是使用了错误的术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:13:22.357

您可以使用[db.currentOp()](http://docs.mongodb.org/manual/reference/method/db.currentOp/#db.currentOp)检查更新是否已经在进行中。

# php - 动态缩小 CSS：利用浏览器缓存

> ID：13770083
> 
> 赞同：0
> 
> 时间：2012-12-07T19:52:50.700
> 
> 标签：php, css, caching, browser-cache

我正在编写一个脚本，它将合并和缩小请求的 CSS 文件，然后将它们回显出来。我已经完成了大部分工作，但是我被困在一件小而非常重要的事情上：利用浏览器缓存。

我们网站的大多数访问者都是新来的，而且很少回来。所以我们真正担心的是同一会话中页面请求之间的缓存。就像，他们点击了我们的主页，然后导航到其他几个页面并离开。

我遇到的问题是我在会话中存储了每个特定文件集的最后请求时间的时间戳。因此，如果我想要 main.css 和 internet.css 这个请求，然后是 main.css 和 phone.css 下一页视图，那么最后一个请求的时间戳将被更新，但如果我再次请求同一组文件，时间戳将与上次保持不变。

希望我说得通。问题是，当一个文件从上次请求到这个请求没有改变时，我返回 304 not modified。但是，浏览器并没有像应有的那样缓存 css。关于为什么不的任何想法？

你可以在这里看看我的代码：[https](https://gist.github.com/4235836) ://gist.github.com/4235836 （我通常会把它放在这里，但它有点长）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:04:11.247

我认为您应该在发送 304 之前检查请求标头 If-modified-since：

```
if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) && 
    strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) >= $minifier->lastModified)
{
    header('HTTP/1.0 304 Not Modified');
    exit;
} 
```

还要注意出口。如果您发送 304，则意味着客户端已经拥有最新版本，因此您应该在那里退出脚本。

**编辑：**

使用过期标头时，浏览器将假定它已经具有最新版本。所以它甚至不会向服务器发出请求，这与使用 HTTP_IF_MODIFIED_SINCE 标头不同。

因此，您可能还想添加：

```
header('Expires: '.gmdate('D, d M Y H:i:s \G\M\T', time() + (60 * 60 * 24))); 
```

然后，为了确保文件更改后它会请求新版本，您可以执行以下操作：

```
<link rel="stylesheet" type="text/css" 
    href="minify.php?v=<?php echo filemtime($theFileToMinify) ?>"> 
```

# ipod-touch - iOS 6.0 Core 蓝牙外设重新连接问题

> ID：13770084
> 
> 赞同：5
> 
> 时间：2012-12-07T19:52:51.307
> 
> 标签：ipod-touch, core-bluetooth, reconnect

我在 iPhone 4S 上运行的 iOS 5.0 中有一个稳定的工作应用程序。我们迁移到 iOS 6.0 以在具有蓝牙低功耗的 iPod（第 5 代）上运行。在 iPhone 4S 上，我们可以随意配对/绑定、连接、断开和重新连接。我们在 iPod 上做同样的事情时遇到了问题。应用程序成功断开连接并重新连接，该过程可以重复 2-3 次，之后我们开始收到 Core Bluetooth Error : 14。这是日志的样子

```
012-12-04 11:30:24.293 Milan[524:907] DISCONNECTED WITH READER: SriRdr11
2012-12-04 11:30:24.295 Milan[524:907] Start Time 376331424.295754 =
2012-12-04 11:30:28.241 Milan[524:907] NSConcreteNotification 0x1dd607d0 
2012-12-04 11:30:28.243 Milan[524:907] MAIN PERIPHERAL: 5F953B12-D99F-D770-4F3F-B741BA026858
2012-12-04 11:30:28.617 Milan[524:907] CONNECTED WITH PERIPHERAL: DEVICE1
2012-12-04 11:30:29.173 Milan[524:907] DISCONNECTED WITH PERIPHERAL: DEVICE1
2012-12-04 11:30:29.176 Milan[524:907] Error: The specified device has disconnected from us. -   
(null) 
```

应用认为BLE外设与它断开连接，外设认为应用与阅读器断开连接。很明显，这是应用程序在这里做一些奇怪的事情。有人可以解释这里发生了什么吗？

这是 didDiscoverPeripheral 中为重新连接而调用的代码。

```
NSString* uuid = [peripheral uuidString]; NSString* readerName = [advertisementData    
objectForKey:@"kCBAdvDataLocalName"]; 
int meterID= 0; 
NSData *deviceIdData = [NSData dataWithBytes:&meterID length:sizeof(meterID)]; 
NSLog(@"DEVICE DISCOVERED: %@ (%@)", deviceName, uuid); 
[[[DeviceBluetoothManager sharedInstance]allPeripherals] setObject:deviceIdData forKey:peripheral
uuidString]]; 
[[DeviceDefaultsManager sharedInstance] adddeviceIdToFavorites:deviceIdData 
readerName:readerName withPeripheralId:[peripheral UUID]]; 
NSDictionary* deviceInfo = [NSDictionary dictionaryWithObject:peripheral forKey:kDeviceKey];  
[[NSNotificationCenter defaultCenter] postNotificationName:kBluetoothDeviceDiscovered 
object:self userInfo:deviceInfo]; 
```

* * *

另一个问题是是否有任何配对或粘合

# javascript - 'rallyiterationcombobox' - 如何选择第一次或最后一次迭代而不是当前迭代作为默认值

> ID：13770086
> 
> 赞同：2
> 
> 时间：2012-12-07T19:53:18.280
> 
> 标签：javascript, extjs, rally

我正在实现一个 Rally 应用程序，该应用程序允许用户选择一系列迭代以包括数据采样。我有一个“rallyiterationcombobox”实例来选择迭代范围的最小值和最大值。默认情况下，当前迭代是从列表中选择的。由于我想默认包含最大范围，然后让用户根据需要缩小搜索结果，我希望最小迭代默认为列表中的最后一个（按时间顺序排列）并且最大迭代默认为到列表中的第一个（按时间顺序排列）。

似乎我应该能够为框的“值”属性选择一个索引以及列表的长度来选择最后一个索引，但情况似乎并非如此。组合框的代码是：

```
this.add({
    xtype: 'rallyiterationcombobox',
    value: //should be able to set an index here
}); 
```

# php - 自定义组件中的 Joomla 分页

> ID：13770089
> 
> 赞同：1
> 
> 时间：2012-12-07T19:53:21.837
> 
> 标签：php, mysql, joomla

我正在使用 Joomla 网站上的文档之一。我坚持告诉你修改`getData()`功能的部分。

**“修改 getData() 函数，将 $limitstart 和 $limit 值添加到 _getList() 查询中。这会导致只返回所需的行，而不是所有行。”**

```
function getData() 
{
    // if data hasn't already been obtained, load it
    if (empty($this->_data)) {
        $query = $this->_buildQuery();
        $this->_data = $this->_getList($query, $this->getState('limitstart'), $this->getState('limit'));    
    }
    return $this->_data;
} 
```

我有一个已经构建了 mySQL 查询的函数。这是它想要改变的功能吗？此代码是否替换了我的`getData()`函数中当前的行：

```
 $db->setQuery($query);
    $table = $db->loadRowList();
    return $table; 
```

我只需要将此行添加到构建 mySQL 查询的函数中还是需要替换某些内容？

**编辑：**我正在使用的 Joomla 文档可以在[这里](http://docs.joomla.org/Using_JPagination_in_your_component)找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:05:22.973

这将返回所有行：

> $table = $db->loadRowList();

这将只返回需要的数据，受分页器的限制：

```
if (empty($this->_data)) {
        $query = $this->_buildQuery();
        $this->_data = $this->_getList($query, $this->getState('limitstart'), $this->getState('limit'));    
    }
    return $this->_data; 
```

`function getData()`所以你应该在你的模型中替换。

# c++ - 可以使 Windows 可执行文件的映射文件可写吗？

> ID：13770091
> 
> 赞同：1
> 
> 时间：2012-12-07T19:53:27.803
> 
> 标签：c++, windows, file, memory

当一个 Windows EXE 被加载时，它被映射到内存中。此映射锁定文件并防止对文件进行任何正常修改或替换。但是，由于它被映射为 Copy-on-Write，您是否可以将其更改为 Write，然后修改内存以更改文件的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:56:21.927

不会。将保护更改为写入并更新内存只会更新您进程的文件字节的私有副本。（您已经有效地创建了进程本地内存，可以方便地初始化为文件的当前内容。）实际文件保持不变。

# objective-c - 等待调用数据库

> ID：13770093
> 
> 赞同：0
> 
> 时间：2012-12-07T19:53:34.697
> 
> 标签：objective-c, xcode

有什么方法可以等到通话完成吗？这是代码：

```
NSString *strImmagineURL = [NSString stringWithFormat:@"http://www.xxxgo.net/Scxxs/Evento/WIG2ricexxx.php?evento=%@",idLocale];
NSData *dataImmagineURL = [NSData dataWithContentsOfURL:[NSURL URLWithString:strImmagineURL]];
immagine = [UIImage imageWithData:dataImmagineURL];

 [`arrayFoto` addObject:immagine]; 
```

我注意到，当连接速度很慢时，addObject 会使我的应用程序崩溃，因为`immagine`它仍然为零。

我想等待`immagine`，然后填写`arrayFoto`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:02:12.463

这 nil 不是因为它很慢，而是因为请求*失败*。`dataWithContentsOfURL:`是一种同步方法，这意味着在请求完成或失败之前，您的程序将不会继续执行。

正确处理 HTTP 请求中的错误情况需要更多的设置。您应该使用[ASI HTTP Request 之](http://allseeing-i.com/ASIHTTPRequest/)类的东西来更优雅地处理您的请求和成功/错误处理程序。

# java - maven - 自动构建本地依赖项

> ID：13770094
> 
> 赞同：1
> 
> 时间：2012-12-07T19:53:46.387
> 
> 标签：java, maven

目前我的部署工作流程涉及手动（即在脚本中）进入每个 maven 项目目录并运行`mvn install`. 问题在于本地资源，即我编写并正在积极开发/维护的其他内部代码，我不知道如何告诉 maven 在这些资源丢失时自行构建这些资源。理想情况下，每次我需要重新打包顶级应用程序时，它都会重建它所依赖的任何库，这些库至少修改了一个文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:18:16.260

如果您的（多模块）项目使用其他内部资源，那么您实际需要的可能不是一直重建所有这些资源，而是使用本地 maven 存储库。它可以是使用 ssh 或 HTTP 传输（请参阅[部署插件](http://maven.apache.org/plugins/maven-deploy-plugin/)）部署资源的简单存储库，也可以是真正的工件管理器，例如[Archiva](http://archiva.apache.org/)、[Artifactory](http://www.jfrog.com/)或[Nexus](http://www.sonatype.org/nexus/)。

存储库管理器不仅仅保存您部署的工件，它还可以在相应版本发布后清理过时的快照，并充当其他存储库（包括中央存储库）的本地缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:01:59.480

有一个包含所有模块的父 POM。当您构建父级时，作为父 POM 文件一部分的所有模块也将被构建。

只要您的孩子有父母，您就可以从父母那里继承很多东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T09:08:33.870

考虑设置[Jenkins](http://jenkins-ci.org/)以自动构建您的代码。Jenkins 有一个有用的功能，可以重建依赖于新建工件的项目。只需提交代码即可自动触发构建。

如果您使用多台开发机器（或在团队中工作），请将 Jenkins 与[Nexus](http://www.sonatype.org/nexus/)（其他选项：[Artifactory](http://www.jfrog.com/home/v_artifactory_opensource_overview)、[Archiva](http://archiva.apache.org/)）结合起来，为共享工件提供公共存储。这些工具旨在支持 Maven 构建。

# php - 下载脚本中的刷新不起作用

> ID：13770095
> 
> 赞同：0
> 
> 时间：2012-12-07T19:53:49.700
> 
> 标签：php, download, refresh

我有这个完美运行的下载脚本，但是下载了一个文件，我希望重新加载页面。但是一旦文件被下载，页面就消失了？它应该是一个安全的下载脚本，因此用户看不到文件的路径。它是通过使用 POST 提交来调用的

```
<?php
session_start();

//Assign variables from session
$userid = $_SESSION["id"];
$email = $_SESSION['email'];
$password = $_SESSION['password'];

//Require database connection and functions
require('includes/config.php');
include('includes/functions.php');

//Check if user is logged in
if (!$userid || !$email || !$password)
{
    header("Location: index.php");
}       

// Usage: <a href="download.php?file=test.txt&category=test">Download</a> 
// Path to downloadable files (will not be revealed to users so they will never know your file's real address) 
$hiddenPath = "uploaded_notes/";

// VARIABLES 
if (!empty($_POST['file'])){
$file_id = $_POST['file'];
    $result = mysql_query("SELECT * FROM files WHERE id='$file_id'");
    $row = mysql_fetch_array($result);
$file = $row['location'];
$price = $row['price'];

    $result2 = mysql_query("SELECT coins FROM users WHERE id='$userid'");
    $row2 = mysql_fetch_array($result2);
$coins = $row2['coins'];

$new_coins = $coins-$price;
if ($new_coins >= 0)
{
    mysql_query("UPDATE users SET coins = $new_coins WHERE id='$id'");
}
else {
header("Location: dashboard.php");
die();
}

//Insert into purchases
$datetime = date("Y-m-d H:i:s");@
mysql_query("INSERT INTO purchases (userid, fileid, datetime) VALUES ('$userid', '$file_id', '$datetime')");

$file = str_replace('%20', ' ', $file); 
$category = (!empty($_GET['category'])) ? $_GET['category'] . '/' : ''; 
} else {
    header('Location: dashboard.php');
    die('Hacking attempt reported.');
}

$file_real = $hiddenPath . $category . $file; 
$ip = $_SERVER['REMOTE_ADDR'];

// If requested file exists 
if (file_exists($file_real)){ 
// Get extension of requested file 
$extension = strtolower(substr(strrchr($file, "."), 1)); 
// Determine correct MIME type 
switch($extension){ 
case "asf": $type = "video/x-ms-asf"; break; 
case "avi": $type = "video/x-msvideo"; break; 
case "exe": $type = "application/octet-stream"; break; 
case "mov": $type = "video/quicktime"; break; 
case "mp3": $type = "audio/mpeg"; break; 
case "mpg": $type = "video/mpeg"; break; 
case "mpeg": $type = "video/mpeg"; break; 
case "rar": $type = "encoding/x-compress"; break; 
case "txt": $type = "text/plain"; break; 
case "wav": $type = "audio/wav"; break; 
case "wma": $type = "audio/x-ms-wma"; break; 
case "wmv": $type = "video/x-ms-wmv"; break; 
case "zip": $type = "application/x-zip-compressed"; break; 
case "jpg": $type = "image/jpeg"; break; 
default: $type = "application/force-download"; break; 
} 
// Fix IE bug [0] 
$header_file = (strstr($_SERVER['HTTP_USER_AGENT'], 'MSIE')) ? preg_replace('/\./', '%2e', $file, substr_count($file, '.') - 1) : $file; 
// Prepare headers 
header("Pragma: public"); 
header("Expires: 0"); 
header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
header("Cache-Control: public", false); 
header("Content-Description: File Transfer"); 
header("Content-Type: " . $type); 
header("Accept-Ranges: bytes"); 
header("Content-Disposition: attachment; filename=\"" . $header_file . "\";"); 
header("Content-Transfer-Encoding: binary"); 
header("Content-Length: " . filesize($file_real));

// Send file for download 
if ($stream = fopen($file_real, 'rb')){
while(!feof($stream) && connection_status() == 0){

//reset time limit for big files 
print(fread($stream,1024*8)); 
flush(); 

} 
fclose($stream); 
} 
}else{ 
// Requested file does not exist (File not found) 
echo("Requested file does not exist"); 
die(); 

} 
?> 
```

如果我把它放在前面，刷新代码就可以了

```
print(fread($stream,1024*8)); 
```

但在那之后它不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:00:42.247

下载文件是一次性的。下载文件后，您将无法重定向。您可以尝试在输出内容之前添加刷新标题，但某些浏览器会将其视为取消。

有关更多信息，请参阅此帖子：[https ://stackoverflow.com/questions/5960895/redirect-after-download-not-working-php](https://stackoverflow.com/questions/5960895/redirect-after-download-not-working-php)

您可以阅读[这篇文章](https://stackoverflow.com/questions/5960895/redirect-after-download-not-working-php)、[这篇文章](https://stackoverflow.com/questions/822707/php-generate-file-for-download-then-redirect)和[这篇文章](https://stackoverflow.com/questions/5962771/header-redirect-after-download)以获取更多信息。

基本上，它们都归结为 HTTP 标头。`echoed`拥有内容后无法发送重定向标头。另一方面，`echoing`内容之前的重定向标头只会取消下载。

您可以执行此操作的另一种方法是隐藏`iframe`，并在那里提交您的请求，但我猜这不是您想要的。

# c# - 将字符串数组转换为int

> ID：13770105
> 
> 赞同：1
> 
> 时间：2012-12-07T19:55:17.577
> 
> 标签：c#, .net-4.0

我遇到了一个奇怪的问题，试图从字符串数组中获取一个字符串并将其转换为整数。看看这个代码片段：

```
string date = "‎21/‎07/‎2010 ‏‎13:50";
var date1 = date.Split(' ')[0];
string[] dateArray = date1.Split('/');

string s = "21";
string t1 = dateArray[0];

bool e = string.Compare(s, t1) == 0;        //TRUE

int good = Convert.ToInt32(s);            //WORKING!
int bad = Convert.ToInt32(t1);  //Format exception - Input string was not in a correct format. 
```

有人可以解释为什么使用 s 进行转换，而使用 t1 失败？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:05:04.440

您的字符串中充满了隐藏字符，导致其中断。有四[`U+200E`](http://www.fileformat.info/info/unicode/char/200e/index.htm)加一[`U+200F`](http://www.fileformat.info/info/unicode/char/200f/index.htm)

这是一个可以尝试的干净字符串：

```
string date = "21/07/2010 13:50"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:57:19.457

为什么`string.Compare(s, t1) == 0`要测试字符串是否相等？这种过载`Compare`会进行*文化敏感*的比较。但这并不意味着字符串是相同的。要检查字符串是否由相同的`char`值“序列”组成，请使用*序数*比较。可以进行序数比较，例如，使用

```
bool e = s == t1; 
```

在您的情况下，字符串具有不同`Length`的 s，并且它们在第一个索引上也不同`s[0] != t1[0]`。

您的字符串`date`包含[从右到左的标记](http://en.wikipedia.org/wiki/Right-to-left_mark)和[从左到右的标记](http://en.wikipedia.org/wiki/Left-to-right_mark)。这可能是因为您从阿拉伯语文本（或以“错误”方向书写的另一种语言）复制粘贴。

要删除字符串*末尾*的这些字符（而不是中间），您可以使用类似

```
t1 = t1.Trim('\u200E', '\u200F'); 
```

# grammar - 不受限制的语法

> ID：13770112
> 
> 赞同：2
> 
> 时间：2012-12-07T19:55:55.797
> 
> 标签：grammar

这个通用语法有什么作用？

```
S -> LR 
L -> L0Y 
L -> LX 
X1 -> 1X 
X0 -> 0X 
X0 -> 1Y 
Y1 -> 0Y 
YR -> R     
L  -> epsilon 
R  -> epsilon 
```

开始符号是 S。我试图从这个语法生成字符串，我得到了每个二进制数。但我认为它做了一些具体的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:32:00.243

```
S -> LR 
L -> L0Y 
L -> LX 
X1 -> 1X 
X0 -> 0X 
X0 -> 1Y 
Y1 -> 0Y 
YR -> R     
L  -> epsilon 
R  -> epsilon 
```

终端：0,1 开始：S

让我们拆分语法：

```
S -> LR 
L -> L0Y 
L -> LX 
```

这将生成一个形式为 ,和,的`L`字符串。`X``0Y``R`

```
X1 -> 1X 
X0 -> 0X 
X0 -> 1Y 
Y1 -> 0Y 
YR -> R 
```

`X`将and视为`Y`作用于二进制字符串：`X`将向右传播，然后将 a 更改`0`为`1`和所有后续`1`的 s 到`0`s。实际上，单次`X`递增二进制数而不改变其字符串长度（或卡住）。

前导`Y`会将所有 s 的字符串重写`1`为所有`0`s（或卡住）。

将规则`L`视为字符串右侧部分的可能操作。`L => L0Y`会将字符串从全1重置为全零，并将其长度增加一。`L => LX`将增加任何其他数字，但如果该值处于最大值则失败。

这两个动作一起足以（低效地）生成所有 0 和 1 的字符串（包括空字符串）。

```
L  -> epsilon 
R  -> epsilon 
```

只会清理哨兵。

用四个词对语言进行一种可能的描述：

所有字符串的集合

# java - 在 JSF 项目中包括 JPA 项目

> ID：13770115
> 
> 赞同：1
> 
> 时间：2012-12-07T19:56:05.120
> 
> 标签：java, eclipse, jpa, jsf-2, ant

我在 Eclipse 中创建了两个独立的项目。第一个项目是 JPA，第二个是 JSF。我面临的问题是如何从 JSF Bean 访问 JPA 的 DAO 类，同时仍然保持这些项目分开。

我正在阅读有关使用 Ant 的信息，但找不到反映我的问题的示例。

我将 JPA EclipseLink 2.1 与 GlassFish Server 3.1 和 JSF 2.0 一起使用

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:13:20.050

右键单击 JSF 项目，转到*Deployment Assembly*属性并在其中添加 JPA 项目。这样，它就透明地以 JAR`/WEB-INF/lib`形式出现在构建的 WAR 中。

请注意，您不应像其他人建议的**那样**摆弄*Build Path*属性。这样，它根本不会`/WEB-INF/lib`在构建的 WAR 中以 JAR 的形式出现。它只会使 JPA 项目成为编译时依赖项。

# javascript - HTML5 画布图像缩放到更小的尺寸并恢复为原始尺寸

> ID：13770118
> 
> 赞同：0
> 
> 时间：2012-12-07T19:56:08.847
> 
> 标签：javascript, html, canvas, image-resizing

我正在尝试解决的情况。我正在将图像加载到画布上，然后对其进行一些编辑（调整大小、裁剪等）并将生成的图像保存到文件夹中。现在，如果原始图像大于画布尺寸，则会裁剪结果图像。因此，我尝试将图像缩放到适合画布的较小尺寸，应用效果，然后将其缩放回原始尺寸并保存。有没有办法做到这一点？

我的 JS 伪代码有点像这样：

```
//load the image using drawimage
//compare image dimensions with canvas dimensions, scale down the image if large
//apply the effects
(I have done till here)

//scale it back to original size
//save 
```

如何使用画布`scale`方法来回缩放它？我假设我必须像这样计算缩小和放大的宽度比：

```
scale_down_width = image_orig_width / canvas_width
scale_down_height = image_orig_height / canvas_height

//For scaling down
scale(1*scale_down_width, 1*scale_down_height)

//For scaling up
scale(1/scale_down_width, 1/scale_down_height) 
```

我这样做对吗？按比例缩小可以正常工作，但按比例放大则不行，我该怎么做呢？

# php - 动态 AJAX 提交按钮的代码在哪里？您如何构建动态 AJAX php/javascript 网页？

> ID：13770125
> 
> 赞同：0
> 
> 时间：2012-12-07T19:56:59.510
> 
> 标签：php, javascript, mysql, ajax, architecture

**这是我的问题：**

我有一个显示 X 类的动态列表。选择类时，将显示所有类的所有学生。当用户单击“提交”时，我想向数据库发送插入语句。提交按钮的代码在哪里？

**我的尝试：**伪代码/结构

放置在网络服务器上 1 个文件夹中的文件：Index.php 和 getStudentList.php

索引.php

```
<script>
function showStudents(str)
blabla
xmlhttp.open("GET","getStudentList.php?q="+str, true);
xmlhttp.send();
</script>
...
<div>
html display goes here, as well as the form itself
</div> 
```

getStudentList.php

```
<script>
logic for javascript goes here which connects to a db and inserts attendance info
</script>
<?php
connect to db
query students in class
echo attendance form
?> 
```

* * *

**详细代码：** Index.php

```
<!--start script for AJAX attendance display-->
<script>
function showStudents(str)
{
if (str=="") {
  document.getElementById("attendanceForm").innerHTML="";
  return;
}
if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
}
else {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}

xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("attendanceForm").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getStudentList.php?q="+str,true);
xmlhttp.send();
}
<script>
<div>
    <?php
        //identify teacher's classes
        $school_connection = New school();
        $arrayTeachersClasses = $school_connection->queryTeachersClasses($_SESSION['teacherID']);
        //returns array of all classes taught
        //echoes today's date
        echo Date("l F d, Y");
        //create list so teacher can pick class
        echo "<form>";
        echo "<select name = \"courses\" onchange = \"showStudents(this.value)\">";
        echo "<option value=\"\">Select a class:</option>";
        $i = 0;//counter        
        while ($row = $arrayTeachersClasses[$i]) {
            echo "<option value=\"". $row[0] . "\">";
            echo $row[1] . "  ". $row[2] . "-L". $row[3] . " Room " . $row[4];
            echo "</option>";
            $i++;
        }
        echo "</select>";
        echo "</form>";

    /***
    //Sample "Select a Class" list
    <form>
    <select name="users" onchange="function(this.value)">
        <option value="">Select a class:</option>
        <option value="0">09:00:00  BEG-L1 Room303</option>
        <option value="1">TIME SUBJ-LEVEL ROOM</option>
        <option value="2">ditto</option>
        <option value="3">ditto</option>
    </select>
    </form>
    */

        $teacherID = $_SESSION['teacherID'];
        //echo $teacherID;

    ?>
</div>
<br />
<div id="attendanceForm">
    <p><b>Attendance List:</b></p>
    Please Select a Class
</div> 
```

getStudentList.php

```
<script>
//Other JS stuff
$(document).ready(function() {

    //if submit button is clicked
    $('#submit').click(function () {        

    $i = 0;//counter
    var attendanceData = new Array();
    //Get the data for each student
    while ($row = $arrayStudentList[$i]) {
    var studentID = $('input[name=' . $row[0] . ']');
        if (studentID.val()=='') {
            studentID.addClass('highlight');
            return false;
        } else studentID.removeClass('highlight');

    $row[2] = studentID.val;
    $attendanceData[$i] = $row;
    $i++;
    }

    $row = $attendanceData[0];
    $record = $row[2];
    alert("My First JavaScript");

        //cancel the submit button default behaviours
        return false;
    }); 
}); 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:14:35.273

有很多方法可以做到这一点......下面是 2 个简单的解决方案：使用回发或通过 ajax。

**选项 1 - 回发**

1.  单击提交时，将表单提交到索引页面本身：将表单操作留空或使用`$_SERVER['PHP_SELF']`
2.  在 index.php 中显示任何内容之前检查请求类型和参数并保存数据
3.  生成成功/失败消息并显示

**选项 2 - Ajax**

1.  创建新页面`insertStudent.php`
2.  添加 ajax 功能以提交表单并将表单发送到`insertStudent.php`. 请参阅[jquery 提交](http://api.jquery.com/submit/)或为您的项目重新发明轮子
3.  在`insertStudent.php`保存学生并返回 json 状态或 (1/0)
4.  处理 ajax 处理程序中的响应（步骤 2）以显示成功/失败消息

锄头这可以帮助您完成作业;-)

# windows - 如何永久终止 Windows 资源管理器（“explorer.exe”进程）？

> ID：13770128
> 
> 赞同：3
> 
> 时间：2012-12-07T19:57:13.797
> 
> 标签：windows, delphi, winapi

我正在使用以下代码终止进程：

```
function KillTask(ExeFileName: string): Integer;
const
  PROCESS_TERMINATE = $0001;
var
  ContinueLoop: BOOL;
  FSnapshotHandle: THandle;
  FProcessEntry32: TProcessEntry32;
begin
  Result := 0;
  FSnapshotHandle := CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
  FProcessEntry32.dwSize := SizeOf(FProcessEntry32);
  ContinueLoop := Process32First(FSnapshotHandle, FProcessEntry32);

  while Integer(ContinueLoop) <> 0 do
  begin
    if ((UpperCase(ExtractFileName(FProcessEntry32.szExeFile)) =
      UpperCase(ExeFileName)) or (UpperCase(FProcessEntry32.szExeFile) =
      UpperCase(ExeFileName))) then
      Result := Integer(TerminateProcess(
                    OpenProcess(PROCESS_TERMINATE,
                                BOOL(0),
                                FProcessEntry32.th32ProcessID),
                                0));
    ContinueLoop := Process32Next(FSnapshotHandle, FProcessEntry32);
  end;
  CloseHandle(FSnapshotHandle);
end; 
```

问题是，当我调用上述函数以永久终止 时`explorer.exe`，Windows 资源管理器会终止，但之后会重新启动：

```
KillTask('explorer.exe'); 
```

我正在使用 Delphi XE3、Delphi 7 和 Windows 8。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-07T20:19:56.283

基于此[`Exit Explorer`](https://stackoverflow.com/q/5689904/960757)功能和 Luke in 调试的代码，[`this post`](https://stackoverflow.com/a/5705965/960757)您可以尝试使用以下代码：

***警告：***

这种方式绝对是无证的！所以这篇文章中出现的所有常量和变量都是虚构的。与真实的、记录在案的代码的任何相似之处纯属巧合:-)

```
function ExitExplorer: Boolean;
var
  TrayHandle: HWND;
const
  WM_EXITEXPLORER = $5B4;
begin
  Result := False;
  TrayHandle := FindWindow('Shell_TrayWnd', nil);
  if TrayHandle <> 0 then
    Result := PostMessage(TrayHandle, WM_EXITEXPLORER, 0, 0);
end; 
```

I've tested it in Windows 7, where it works and doesn't even need the administrator elevation. Don't know how about the other systems (I'd say this won't work at least on Windows XP, but it's just a guess).

# java - 为什么不强制转换为 NavigableSet 抛出 ClassCastException？

> ID：13770129
> 
> 赞同：1
> 
> 时间：2012-12-07T19:57:17.180
> 
> 标签：java, casting, classcastexception, treeset, sortedset

keySet() 返回 java.util.Set。为什么不强制转换为 NavigableSet 抛出 ClassCastException？如果真正的 Object 是带有 java.util.Set 引用的 TreeSet，则可能是这样。我无法理解。

```
import java.util.*;
class A1{}
public class Main{
     public static void main(String args[]){
         SortedMap nvs=new TreeMap();
         nvs.put(1,"one");
         nvs.put(2,"two");
         nvs.put(3,"three");
         nvs.put(4,"four");
         NavigableSet nss=(NavigableSet)nvs.keySet();
         for(Object ob: nss){
              System.out.print(nvs.get(ob)+", ");
         }
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:04:42.453

最好的办法是查看实际代码`TreeMap`（来自 java 1.7）：

```
public Set<K> keySet() {
    return navigableKeySet();
}

public NavigableSet<K> navigableKeySet() {
    KeySet<K> nks = navigableKeySet;
    return (nks != null) ? nks : (navigableKeySet = new KeySet(this));
} 
```

这是`KeySet`类声明：

```
static final class KeySet<E> extends AbstractSet<E> implements NavigableSet<E> {...} 
```

如您所见，`TreeMap#keySet`方法返回一个类型`Set`，它是`NavigableSet`. 并且`Set`从它返回的引用指向一个`KeySet`实例，就像在`navigableKeySet()`方法中一样。

而且由于`KeySet`类 implements `NavigableSet`，您始终可以将指向它的实例的引用转换为`NavigableSet`引用。

只是为了确保您独立于`keySet()`方法实现，您可以简单地调用`navigableKeySet()`方法来获取`NavigableSet`并避免强制转换

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:11:24.740

Your question shows that you don't understand polymorphism. Let's use an analogy. You go to a bar, and ask for a beer. And you get a Stella. You didn't ask specifically for a Stella, and the bar didn't make it public that their beers were actually Stella beers, but the fact is that the actual, concrete type of beer you got was a Stella. Since the bar doesn't guarantee that you'll get a Stella when you ask for a beer, you shouldn't rely on it, because a future version of the bar could give you a Jupiler instead., since both Jupiler and Stella are beers.

It's the same with your question. The return type is Set, so it could return any kind of Set. And unless the javadoc guarantees that the method in fact returns a NavigableSet, you shouldn't rely on it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T19:59:19.297

它没有通过 a `ClassCastException`，因为返回的对象是 a `NavigableSet`。例如，您可以在返回的对象上使用 getClass() 方法并打印它。这个类要么是它，要么`NavigableSet`是它的子类。

您还可以使用调试器（例如 Eclipse）来获取对象的类。

因为[SortedMap.keySet()](http://docs.oracle.com/javase/6/docs/api/java/util/SortedMap.html#keySet%28%29)规范告诉它返回一个`Set`对象，所以将它强制转换为`NavigableSet`. 另一个或更改的实现可能会导致您的代码通过`ClassCastException`.

编译器无法检查这一点，因此检查是在运行时执行的。

# php - 如何在使用 ZipArchive() 添加到 zip 之前重命名 .txt 文件？

> ID：13770131
> 
> 赞同：0
> 
> 时间：2012-12-07T19:57:19.693
> 
> 标签：php, zip, ziparchive

我正在使用 ZipArchive() 将一堆 .txt 文件压缩在一起。有人可以给我一个示例，如何在将所有 .txt 文件放入 zip 之前从开头删除 ID？

例如：

*   144-苹果.txt
*   2-橙子.txt
*   25555-香蕉.txt

将会：

*   苹果.txt
*   橘子.txt
*   香蕉.txt

在拉链中。

```
$name = str_replace(TXT_FILE_DIRECTORY . $group . '/', '', $file);
$zip->addFile($file, $name); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:04:10.477

像这样的东西应该工作：

```
<?php
    //Your $files array creation logic here
    foreach ($files as $file) {
        $fileName = preg_replace("/^\d+\-/", "", str_replace(TXT_FILE_DIRECTORY . $group . '/', '', $file));
        $zip->addFile($file, $fileName);
    }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:04:02.180

也许您可以提供以下代码：

```
 $this->zipfile->add_dir(FCPATH."files/");
    for($u=$ini;$u<=$do;$u++){
        $this->zipfile->add_file(implode("",file(FCPATH."files/batchsql_".$u.".txt")), FCPATH."files/batchsql_".$u.".txt");
    }

    header("Content-type: application/octet-stream");
    header("Content-disposition: attachment; filename=zipfile.zip");
    echo $this->zipfile->file(); 
```

# c# - 如何使此代码更易于管理碰撞音频？

> ID：13770134
> 
> 赞同：0
> 
> 时间：2012-12-07T19:57:25.227
> 
> 标签：c#, optimization, audio, refactoring, unity3d

我只是在寻找可以使此代码更好的任何建议。如果我以这种方式继续下去，我认为这是可以避免的大量代码，但现在我无法做到这一点。这将很快失去控制。

```
public enum PhysicMaterialType
{
    SoundFailure = 0,

    AsteroidBall,

    BalloonRubber
}

public void PlaySoundBasedOnCollision ( PhysicMaterialType phyMatA, PhysicMaterialType phyMatB )
{
    switch ( phyMatA )
    {
        case PhysicMaterialType.AsteroidBall:
            {
                CheckAsteroidBallCollision ( phyMatB );

                break;
            }
        case PhysicMaterialType.BalloonRubber:
            {
                CheckBalloonRubberCollision ( phyMatB );

                break;
            }
   }

}

void CheckAsteroidBallCollision ( PhysicMaterial phyMatB )
{
    switch ( phyMatB )

    {
        case PhysicMaterialType.AsteroidBall:
            {
                //Play AsteroidAsteroidBallSound

                break;
            }
        case PhysicMaterialType.BalloonRubber:

            {
                break;
            }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:31:59.783

如果您将有很多类型，并且不同类型之间的预期碰撞声音必须以多种方式处理，请考虑为您要实现的每种类型从 PhysicMaterial 派生一个类。在派生类中定义一个公共方法来处理确定要播放的声音 - 将第二个对象的类型传递给此方法。像这样：

```
class PhysicMaterial
{
   public virtual string GetCollisionSound (PhysicMaterialType targetType)
   {
       // define default behavior here, if derived class doesn't need to do anything special
   }
}

class AsteroidBall : PhysicMaterial
{
   public override string GetCollisionSound (PhysicMaterialType targetType)
   {
       ...
   }
}

class BalloonRubber: PhysicMaterial
{
   public override string GetCollisionSound (PhysicMaterialType targetType)
   {
       ...
   }
} 
```

返回最适合您的场景的任何数据类型。

# c++ - C++ 字符串转换

> ID：13770136
> 
> 赞同：2
> 
> 时间：2012-12-07T19:57:42.860
> 
> 标签：c++, string

我遇到字符串连接问题。

```
std::deque<std::string> fileNamesVector;
double * res_array;
string *strarr;

size = fileNamesVector.size();
res_array = new double[size];
strarr = new string [size]; 
```

我需要在 res_array 后面加上 4 个空格，然后是文件名向量。我怎样才能做到这一点。

```
strarr[i] = res_array[i] + "     " + fileNamesVector[i]; 
```

但它给出了错误。说“exp 必须有算术或枚举类型”请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T19:59:48.590

在 C++ 中，在 double、a`char *`​​ 或`std::string`.

`res_array[i] + " "`正在尝试将 double 添加到`char *`，因此编译器尝试进行隐式转换，但不存在，因此它会给您一个错误，说`operator+`需要数字类型。

相反，您需要显式转换`res_array[i]`为字符串。

```
// File: convert.h
#include <iostream>
#include <sstream>
#include <string>
#include <stdexcept>

class BadConversion : public std::runtime_error {
public:
  BadConversion(std::string const& s)
    : std::runtime_error(s)
    { }
};

inline std::string stringify(double x)
{
  std::ostringstream o;
  if (!(o << x))
    throw BadConversion("stringify(double)");
  return o.str();
} 
```

[上面的例子来自 The C++ FAQ](http://www.parashift.com/c++-faq/convert-num-to-string.html)，尽管有很多 stackoverflow 问题专门针对这个主题，但 TC++FAQ 值得真正为 OG 呐喊 :)

或者使用 C++11，使用[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)

```
strarr[i] = std::to_string(res_array[i]) + "     " + fileNamesVector[i]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:16:59.810

如果您还没有使用 C++11，则应该将您的`double`转换为`std::string`using `boost::lexical_cast`：

```
#include <boost/lexical_cast.hpp>
...
strarr[i] = boost::lexical_cast<std::string>(res_array[i]) + "     " + fileNamesVector[i]; 
```

[http://www.boost.org/libs/conversion/lexical_cast.htm](http://www.boost.org/libs/conversion/lexical_cast.htm)

附带说明一下，我强烈建议不要使用原始指针进行内存管理。如果你想要一个可变大小的数组`std::vector`应该是你的首选，而不是`new`and `delete`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:35:16.243

不要使用原始数组和原始指针数组，例如`std::vector`。

它存在于标准库中是有原因的。

也就是说，让你的生活更轻松。:-)

```
#include <assert.h>     // assert
#include <iostream>     // wcout, endl
#include <queue>        // std::dequeue
#include <stddef.h>     // ptrdiff_t
#include <string>       // std::string, std::to_string
#include <utility>      // std::begin, std::end
#include <vector>       // std::vector
using namespace std;

typedef ptrdiff_t       Size;
typedef Size            Index;

template< class Type >
Size size( Type const& c ) { return end( c ) - begin( c ); }

string spaces( Size const n ) { return string( n, ' ' ); }

wostream& operator<<( wostream& stream, string const& s )
{
    return (stream << s.c_str());
}

#ifdef __GNUC__
// Possibly add a workaround implementation of std::to_string
#endif

int main()
{
    deque<string>   file_names_vector;
    vector<double>  res_arr;

    file_names_vector.push_back( "blah.foo" );
    res_arr.push_back( 3.14 );

    assert( file_names_vector.size() == res_arr.size() );
    Size const size = file_names_vector.size();
    vector<string>  str_arr;

    for( Index i = 0; i < size; ++i )
    {
        str_arr.push_back( to_string( res_arr[i] ) + spaces( 5 ) + file_names_vector[i] );
    }

    for( auto const& s : str_arr )
    {
        wcout << s << endl;
    }
} 
```

# apache - mod重写长度

> ID：13770137
> 
> 赞同：0
> 
> 时间：2012-12-07T19:57:44.323
> 
> 标签：apache, mod-rewrite

我在 VirtualHost 中有这样的配置：

```
RewriteEngine On
RewriteMap mapfile txt:mapfile.txt
RewriteCond ${mapfile:$1?%{QUERY_STRING}} >""
RewriteRule ^/(.+)$ ${mapfile:$1?%{QUERY_STRING}}? [R=301] 
```

这适用于这个 mapfile.txt

```
prueba/code.asp?id=489 /newurl 
```

但与此 mapfile.txt 不匹配：

```
prueba/code.asp?id=489 / 
```

在重写日志中：

```
[07/Dec/2012:20:52:08 +0100] [rid#7f1ac2d4280/initial] (5) map lookup OK: map=mapfile[txt] key=prueba/code.asp?id=489 -> val=/

[07/Dec/2012:20:52:08 +0100] [rid#7f1ac2d4280/initial] (4) RewriteCond: input='/' pattern='>""' => not-matched 
```

为什么不匹配？是否有另一种方法来测试查询长度是否大于“”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T02:15:30.083

它不匹配，因为它正在做你要求它做的事情，而不是你期望它做的事情。地图查找按您预期的方式工作，从而有效地：

```
RewriteCond / >"" 
```

但是，cond 匹配字符串运算符意味着“按字母数字排序顺序比较”和 >“”可能会出现问题。为什么不使用正则表达式。如果它包含（至少）一个字符，它将匹配：

```
RewriteCond ${mapfile:$1?%{QUERY_STRING}} . 
```

# emacs - 没有 ecb-compile-*

> ID：13770139
> 
> 赞同：0
> 
> 时间：2012-12-07T19:57:49.830
> 
> 标签：emacs, elisp, text-editor, emacs-ecb

我已经在我的 emacs 上安装了 cedet 和 ecb 并且 ecb 似乎是正确的，但是这里是错误的。像 ecb-compile- ***这样的命令不存在！我需要他们显示编译部分（未显示）

我对编译的唯一想法是 ecb-toggle-compile-window ，它询问我们窗口的高度，输入它后，它说它太小，然后 ecb 完全关闭。

有什么想法吗？

（CEDET 1.1 和 ecb 2.32BETA3）

# android - Android ListView 字体大小和字体

> ID：13770140
> 
> 赞同：3
> 
> 时间：2012-12-07T19:57:50.860
> 
> 标签：android, listview, text-size

我的活动中有一个`ListView`和几个`TextViews`。我注意到`ListView`默认情况下它具有非常整洁的字体大小和文本。如何获取 的文本大小和字体`ListView`并应用于`TextView`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:34:56.217

TextView 的默认大小为 14sp。你可以在 [这里查一下。](https://stackoverflow.com/a/4285644/1661054)

您可以在 XML 布局中更改 textview 的字体大小。在您的 ListView 中，您是否使用了自定义适配器？什么类型的适配器？

您可以查看本教程以了解有关自定义适配器的更多信息：[Customizing Android ListView Items with Custom ArrayAdapter](http://www.ezzylearning.com/tutorial.aspx?tid=1763429&q=customizing-android-listview-items-with-custom-arrayadapter)

如果您可以添加代码，那将很有帮助。

# c# - Fluent Nhibernate：在两个键上映射子属性

> ID：13770147
> 
> 赞同：1
> 
> 时间：2012-12-07T19:58:28.770
> 
> 标签：c#, nhibernate, fluent-nhibernate

```
public class Parent
{
public virtual field1 { get; set;}
public virtual field2 { get; set;}
public virtual Child { get; set;
}

public class Child
{
public virtual childfield1 { get; set;} //composite primary key
public virtual childfield2 { get; set;} //composite primary key
public string somedescription { get; set;}
} 
```

如果我必须只在一个字段上进行映射，我可以在父映射类中完成以下操作：

```
References(x => x.Child).ForeignKey("field1"); 
```

如果连接必须在两个键 field1 和 field2 上，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T12:41:12.493

```
public class Parent
{
    public virtual Child Child { get; set; }
}

public class Child
{
    public virtual int Key1 { get; set; } //composite primary key
    public virtual int Key2 { get; set; } //composite primary key
    public virtual string SomeDescription { get; set;}
}

// in ParentMap
References(p => p.Child).Columns.Add("child_key1", "child_key2");

// in Child
CompositeId()
    .KeyProperty(x => x.Key1)
    .KeyProperty(x => x.Key2); 
```

**并在不**加载孩子的情况下访问 ChildKey1 （列）

```
var key1 = parent.Child.Key1; 
```

# ios6 - 如何在 iOS6 中获取蓝牙隐私设置的状态

> ID：13770148
> 
> 赞同：1
> 
> 时间：2012-12-07T19:58:28.340
> 
> 标签：ios6, core-bluetooth

关于iOS6外设蓝牙连接的问题。

在 info.plist 中，如果我添加 UIBackgroundModes bluetooth-peripheral，在应用程序启动时它会首次请求许可。

![](../Images/eb5e53d1958a71e6879616abd447bd50.png) "appname" 想让附近的蓝牙设备可以使用数据，即使您没有使用该应用程序

如果我拒绝（不允许）请求，设置 - 隐私 - 蓝牙共享 - “Appname”变成“OFF”；

我设置听 CBPeripheralManagerDelegate 看看我是否可以，但即使我拒绝请求，它也总是返回“ON”。（这也是有道理的，因为它在进入后台之前是“开启”的）

```
- (void)peripheralManagerDidUpdateState:(CBPeripheralManager *)peripheral{
NSLog(@"%s",__func__);
NSLog(@"%@",[peripheral description]);
NSString *state = nil;
switch (peripheral.state) {
    case CBPeripheralManagerStateResetting:
        state = @"resetting"; break;
    case CBPeripheralManagerStateUnsupported:
        state = @"unsupported"; break;
    case CBPeripheralManagerStateUnauthorized:
        state = @"unauthorized"; break;
    case CBPeripheralManagerStatePoweredOff:
        state = @"off"; break;
    case CBPeripheralManagerStatePoweredOn:
        state = @"on"; break;
    default:
        state = @"unknown"; break;
}
NSLog(@"peripheralManagerDidUpdateState:%@ to %@ (%d)", peripheral, state, peripheral.state);

} 
```

我看到 CBPeripheralManagerStateUnauthorized 看起来像是显示拒绝状态，但即使我拒绝请求，我也无法获得此状态。

问题是：“有什么办法可以找出用户拒绝后台访问请求？”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-24T02:51:50.147

`CBPeripheralManager`具有`authorizationStatus`报告此信息的属性。（[Apple 文档链接](https://developer.apple.com/library/ios/documentation/CoreBluetooth/Reference/CBPeripheralManager_Class/Reference/CBPeripheralManager.html#//apple_ref/occ/clm/CBPeripheralManager/authorizationStatus)）。

`+ (CBPeripheralAuthorizationStatus)authorizationStatus`

"返回应用程序在后台状态下共享数据的授权状态。该值指示应用程序是否有权在后台使用蓝牙服务共享数据。有关可能值的列表，请参阅“外设管理器授权状态”。 "

# objective-c - 带有许多文本字段的选择器

> ID：13770149
> 
> 赞同：0
> 
> 时间：2012-12-07T19:58:29.393
> 
> 标签：objective-c, xcode, xcode4, uipickerview, uipicker

我正在使用带有许多文本字段的选择器，并且我想在选择器中自动显示“文本字段中的选定项目”。我尝试使用 selectRow，但它不起作用。我应该怎么办？或者在哪里放置这段代码的正确位置？

请注意，它适用于一个字段，但是当我将它与另一个字段一起使用时，它不起作用。

```
if(genderTxt.isEditing == YES){
    [picker selectRow:[genderTxt.text intValue]-1 inComponent:0 animated:YES];

}
if( relationshipTxt.isEditing == YES){
    [picker selectRow:[relationshipTxt.text intValue]-1 inComponent:0 animated:YES];
} 
```

# javascript - 响应 jQuery 发布请求而设置的变量

> ID：13770150
> 
> 赞同：2
> 
> 时间：2012-12-07T19:58:29.907
> 
> 标签：javascript, jquery

我经常使用 jQuery 发布请求。我知道当您在响应中工作时，变量有自己的范围。有没有一种在响应中设置变量的好方法，但这些变量在帖子之外可用？就像 JS 中的其他函数一样。

这是我正在做的一个示例：

```
 $.post('URL', { }, function(data) {

    var cData = $.parseJSON(data);

    $.each(cData, function(k, v) {

      var cID = v.id;  

  }); 
```

所以我所做的是我无法在发布请求之外访问 cID。有没有办法使这项工作？

任何帮助都会很棒。谢谢

更新：

这是我刚刚测试的示例：

```
var savedCount;

$.post('/app/actions/countsAction.php', { call: "getCountFullByID", countID: countID}, function(data) {

    savedCount = 1;
    alert(savedCount);

});

alert(savedCount); 
```

运行此程序时，我收到 2 个警报。当警报在 $.post 中触发时，第一个是 1，而第二个是未定义的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T19:59:48.740

只需在`$.post`调用之外声明您的变量：

```
var cID;
$.post('URL', function(data) {
    var cData = $.parseJSON(data);
    $.each(cData, function(k, v) {
        cID = v.id;  
    });
}); 
```

...不确定您要尝试做什么，因为您正在循环一个集合并不断（重新）设置单个变量的值。如果您需要跟踪所有变量，请考虑将值保存在（也许）一个数组中。

**编辑** 如果您需要进行*同步*（“阻塞”）`$.post`调用，您可以。从函数参数[的文档](http://api.jquery.com/jQuery.ajax/)中：`asynch`

> 默认情况下，所有请求都是异步发送的（即默认设置为true）。如果您需要同步请求，请将此选项设置为 false。跨域请求和 dataType: "jsonp" 请求不支持同步操作。请注意，同步请求可能会暂时锁定浏览器，从而在请求处于活动状态时禁用任何操作。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:03:40.397

You can store your whole data object instead of looping through and resetting the variable to a different value. Then you can access all your data outside. You should also define your variable outside of `$.post` so you have access to it

```
var cID;
$.post('URL', { }, function(data) {    
    cID = $.parseJSON(data);             
}); 
```

# javascript - jquery 或 JS 创建子元素并分配 ID

> ID：13770153
> 
> 赞同：12
> 
> 时间：2012-12-07T19:58:56.963
> 
> 标签：javascript, html, json

我一直在努力解决这个问题，我有点卡住了。我似乎找不到直接的答案，所以我会问。

我正在从 JSON 调用创建一个选项列表。我已经创建了子元素，但似乎无法将唯一 ID（存储在 JSON 中）添加到每个元素。当我在 JSON 的 $.each 中创建 ID 时，我会从分配给所有选项的调用中获取最后一个 ID。

谢谢

```
$("#fDistList").append('<option>' + item.GROUP_NAME + '</option>');
$("option").attr('id', item.ID); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:05:31.353

你可以这样做，一次通过

```
$('<option/>',{
        text: item.GROUP_NAME, 
        id:item.ID
    }).appendTo('#fDistList'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T20:01:18.027

试试这个

```
$("#fDistList").append('<option id="'+ item.ID + '">' + item.GROUP_NAME + '</option>'); 
```

当你这样做

```
$("option").attr('id', item.ID); 
```

您正在重新选择所有`option`元素并设置它们的 ID 属性。

# java - Solr查询计算两点之间的地理距离

> ID：13770154
> 
> 赞同：3
> 
> 时间：2012-12-07T19:58:58.290
> 
> 标签：java, apache, solr, solrj

我有两个营业地点的纬度和经度，并想计算它们之间的距离。我如何使用 solr 查询来做到这一点。

我得到了从一个点（纬度，经度）获取所有最近位置的查询。

但是想要一个查询来获取两点之间的距离。

下面是从一个点获取位置的示例代码片段

// 样本位置

```
location = new double[]{lat, long}; 

SolrQuery query = new SolrQuery("{!func}geodist()");  
query.set("fq","query");  
query.set("sfield", "location");  
query.set("pt", location );  
query.setSortField("score", ORDER.asc);  
query.setFields("score", "id");  
SolrDocumentList list = solrServer.query(query).getResults(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-19T14:45:46.083

要返回距离，您应该`geodist()`向字段列表查询字段添加函数，`fl`如下所示：

```
query.set("fl","*,distance:geodist()") 
```

“距离”是返回`geodist()`结果的字段名称。

# java - StringTokenizer 使用 char 分隔标记

> ID：13770159
> 
> 赞同：1
> 
> 时间：2012-12-07T19:59:14.070
> 
> 标签：java, string, stringtokenizer

如何以字符串 s 作为参数分隔 StringToekenizer 对象中的标记？

所以：

```
String s = input.readLine();
char tokenSeparator = ' '; //can be any value other than white space.
StringTokenizer str = new StringTokenizer(s);
//separate tokens by the variable char tokenSeparator;
while (str.hasMoreTokens) ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:01:37.143

从[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html)：

> `StringTokenizer`是一个遗留类，出于兼容性原因保留，但不鼓励在新代码中使用它。建议任何寻求此功能的人使用`split`方法`String`或`java.util.regex`包来代替。

使用`String.split()`，即：

```
String s = input.readLine();
String[] tokens = s.split(" "); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:02:00.150

检查[javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html#StringTokenizer)。您可以将参数化构造函数视为

```
public StringTokenizer(String str, String delim) 
```

这就是您在这里所需要的。

### 例子

```
String msg = "http://100.15.111.60:80/";
char tokenSeparatpor = ':';
StringTokenizer st = new StringTokenizer(msg,tokenSeparatpor+"");
while(st.hasMoreTokens()){
    System.out.println(st.nextToken());
} 
```

### 输出

```
http
//100.15.111.60
80/ 
```

# javascript - 防止垂直滚动超出 div

> ID：13770166
> 
> 赞同：1
> 
> 时间：2012-12-07T19:59:39.250
> 
> 标签：javascript, html, css, android-webview

我正在开发一个在`WebView`.

我的 HTML 中有一系列`<div>`s 。像这样的东西：

> `<body>`
> 
> > > `<div id='topdiv'></div>`
> > > 
> > > `<div id='contentdiv'>`
> > > 
> > > > > `<p>A bunch of content in here!<p>`
> > > > > 
> > > > > `<p>There is more content here than can fit on 1 screen.<p>`
> > > 
> > > `</div>`
> > > 
> > > `<div id='bottomdiv'></div>`
> 
> `</body>`

**有没有办法让它`bottomdiv`或被`topdiv`渲染，但不能滚动？**换句话说，有没有办法阻止用户向下滚动过去`contentdiv`，即使它`bottomdiv`存在于它下方并且不是不可见的，但`contentdiv`始终是完全可滚动的？

我对任何纯 JavaScript、CSS 或 HTML 实现持开放态度。如果这是您可以打开和关闭但不是必需的功能，那就太好了。

由于我只在移动设备上工作，因此禁用滚动条或捕获`mousescroll`事件等对我没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:33:05.693

如果我理解你想要什么，以下可以解决你的问题。在 body 标记上使用溢出属性，如下所示：

```
body
{
overflow:hidden;
} 
```

解决它的另一种方法是将您设置`bottomdiv`为`hidden`， 如果您希望它不占用空间，则`visibility:hidden;` 使用 或 `display:hidden;` 如果您希望它不占用任何空间，请使用。比，只需根据您想要做的事情用javascript更改它。

# c - Open 在不同的进程中返回相同的文件描述符

> ID：13770174
> 
> 赞同：2
> 
> 时间：2012-12-07T20:00:30.310
> 
> 标签：c, linux, file-descriptor, tty

系统：Ubuntu 12.04
编译器：gcc（版本：4.6.3）

我的想法是编写一个客户端-服务器应用程序来通过串口交换数据。

但我的问题是，当我执行下面的代码片段时，如果我启动两个独立的进程， open 返回相同的文件描述符：

第一个进程打开“/dev/ttyS0”。
第二个进程打开“dev/ttyS1”。

```
 ....
    serialPortDescriptor = open(portName,
                                O_RDWR | O_NOCTTY | O_NDELAY | O_EXCL);
if (serialPortDescriptor == INVALID_SERIALPORT_DESCRIPTOR) {
    return SERIALPORT_UNKNOWN_ERROR;
}
    ..... 
```

open 在两个不同的进程/程序中为不同的设备/路径名（分别为“dev/ttyS1”和“dev/ttyS0”）返回相同的文件描述符值是否正常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:02:47.870

这是完全正常的。[文件描述符](http://en.wikipedia.org/wiki/File_descriptor)只是内核中每个进程打开文件表的偏移量。

# clojure - 延迟的嵌套取消引用

> ID：13770177
> 
> 赞同：3
> 
> 时间：2012-12-07T20:00:42.947
> 
> 标签：clojure, delay

```
@(delay (delay 1)) ; equals to unrealized delay object, containing 1. 
```

是否有一种简单的*（没有使用 测试每个块的先行宏`realized?`）*方法来递归地取消所有内部延迟？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T23:09:10.867

Arthur 的代码当然适用于您发布的示例，但这里有一个如何处理混合序列的示例：

```
(defn deref-delays [x]
  (cond
    (sequential? x) (map deref-delays x)
    (= clojure.lang.Delay (class x)) (recur @x)
    :else x))

(deref-delays [1 2 (delay 3) (delay [4 (delay (delay 5)) 6]) 7])
;(1 2 3 (4 5 6) 7) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T03:24:38.113

您可以使用 clojure.walk 来执行此操作并保留结构。

```
(defn deref-walk [x] 
  (clojure.walk/prewalk 
    (fn [e] 
      (if (delay? e) 
        (deref-walk (deref e)) 
        e)) 
    x)) 
```

然后

```
(deref-walk (delay {:a 1 :b (delay [1 2 (delay 3) (delay {:c 4})])})) 
```

结果是

```
{:a 1 :b [1 2 3 {:c 4}]} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:46:33.000

我假设如果有很多嵌套延迟，你想要一个函数从最里面的延迟中检索值？

```
(defn recursive-deref [delays] 
  (if (= clojure.lang.Delay (type delays)) 
    (recur @delays) 
    delays))
#'user/recursive-deref
user> (recursive-deref delays)
1 
```

# javascript - Phonegap/Jquery mobile 将 XML 读入数据库，然后将数据显示在 div 中

> ID：13770178
> 
> 赞同：0
> 
> 时间：2012-12-07T20:00:42.583
> 
> 标签：javascript, jquery, sqlite, cordova, xml-parsing

我正在寻找访问存储在我从 XML 中解析出来的数据库中的信息。我正在使用 phonegap (cordova 2.2.0)。我在单击导航栏时调用 queryDB() 以调用该函数以使用从 XML 解析的信息填充 div。我的问题是没有显示信息。

有人知道为什么吗？下面是我的代码：

点击时

```
<a href="#acceptedOrders" onclick("queryDB();")> <img src="Images/acceptedOrders.gif" width="25%"> </a> 
```

这是一个将 XML 读入数据库的 javascript 函数：

```
var db = openDatabase('PhoneGap_db', '1.0', '', 2 * 1024 * 1024);
db.transaction(function (tx) {
  tx.executeSql('CREATE TABLE IF NOT EXISTS orders (id unique, city, state, zip)');
});

db.transaction(function (tx) {
   tx.executeSql('INSERT INTO orders (id, city, state, zip) VALUES (orderId,city,state,zip)');
});

$.ajax({
    type: "GET",
    url: "testOrders.xml",
    dataType: "xml",
    success: function(xml) {
      $(xml).find('order').each(function(){
        orderId = $(this).find("orderId").text();
        city = $(this).find("city").text();
        state = $(this).find("state").text();
        zip = $(this).find("zip").text();
        db.transaction(function (tx) {
           tx.executeSql('INSERT INTO orders (id, city, state, zip) VALUES ('+ orderId +', '+ city + ', ' + state + ', ' + zip + ')');
        });
            });
        }
     }); 
```

这是我的阅读脚本（不工作）

```
function queryDB(tx) {
  tx.executeSql('SELECT orderId FROM orders', [], querySuccess, errorCB);
}
function querySuccess(tx, results) {
  var len = results.rows.length;
  for (var i=0; i<len; i++){
      $('#acceptedOrdersContent').append('<li><a href="#CompleteOrderInfo">'+results.rows.item(i).orderId+'</a></li>').listview("refresh");
  }
};
function errorCB(err) {
  console.log("Error processing SQL: "+err.code);
} 
```

这是一个示例 XML 文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
     <orders>
        <order>
         <orderId>123456789</orderId>
         <city>Cincinnati</city>
         <state>Ohio</state>
        <zip>45451</zip>
    </order>
 </orders> 
```

感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:21:35.980

首先，你的 html 是错误的，你应该使用 onclick="" 而不是 onclick("")，像这样：

```
<a href="#acceptedOrders" onclick="queryDB();">
  <img src="Images/acceptedOrders.gif" width="25%">
</a> 
```

此外，您的 queryDB 函数需要一个未传递的参数。您应该将其更新为如下内容：

```
function queryDB() {
  db.transaction(function (tx) {
    tx.executeSql('SELECT orderId FROM orders', [], querySuccess, errorCB);
  });
} 
```

请记住，这应该与创建 db 对象的上下文相同

# android - 负灰度值 - 位图

> ID：13770181
> 
> 赞同：1
> 
> 时间：2012-12-07T20:00:49.437
> 
> 标签：android, bitmap, grayscale

我正在使用以下代码来获取灰度图像的 R、G、B 值（它们都将是相同的）但是输出给了我负值。

为什么会这样？我完全糊涂了。

```
for (int i=0;i<bb.getWidth();i++){
                            for (int j=0;j<bb.getHeight();j++){
                                    long temp=bb.getPixel(i, j);
                                    int a=(int)temp;
                                    ByteBuffer b = ByteBuffer.allocate(4);
                                    b.putInt(a  );
                                    byte[] result = b.array();                                      
                                    Log.d("gray value is=", String.valueOf((int)result[1]));
                                //  Log.d("gray value is=", String.valueOf(getLastBytes(a)));
                            }
                        } 
```

这里的结果 [1] 应该对应于 'R' 值。那么它是如何消极的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:22:10.050

尝试这个

```
 long temp=bb.getPixel(i, j);
        R = Color.red(temp);
        G = Color.green(temp);
        B = Color.blue(temp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:24:43.263

这是因为所有类型更改、与之相关的强制转换以及这些类型已签名的事实。

首先，初始返回值`getPixel()`是一个`int`（32位或4字节，ARGB为一个字节）。在这里将其放入 long 似乎没有必要，因为您只需将其转换回`int`. 但到目前为止一切都很好。

当你得到字节数组时，你是正确的，ARGB 的四个字节是按顺序排列的，所以`result[1]`应该是红色值。但是，当您在日志语句中将该字节隐式转换为 int 时，就会出现问题。

因为`int`是 4 个字节长，并且`int`和`byte`都是有符号类型，所以符号扩展适用于结果，即

*   字节 0x48 将扩展为 int 为 0x00000048
*   字节 0x88 将扩展为 int 为 0xFFFFFF88

因此，当您将结果打印到日志时，它会将数据的十进制值解释为负数。诚然，即使您没有强制转换并仅打印 的值`byte`，该类型仍然是有符号的（即从 -128 到 127 而不是 0 到 255，并且 0x88 表示 -120），所以日志输出将是相同的。

如果您想注销实际的 0-255 值，请修改您的代码以对像素数据进行位掩码，以消除 中的符号扩展`int`：

```
int red = (int)(result[1] & 0xFF);
Log.d("gray value is=", String.valueOf(red)); 
```

# delphi - 在 Delphi xe3 中编译 Delphi 2007 包

> ID：13770184
> 
> 赞同：1
> 
> 时间：2012-12-07T20:01:11.477
> 
> 标签：delphi, delphi-xe2, delphi-2007

我正在尝试使用 Delphi XE3 重新编译一个包（delphi2007），我收到错误消息：“E2199 包 'vcl' 和 'rtl' 都包含单元 ''” 知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T12:56:04.667

问题是环境变量“PATH”。安装 XE3 删除了 Delphi 2007 的路径（'C:\Program Files (x86)\Codegear\RAD Studio\5.0\bin'），它解决了在 XE3 路径之前手动添加到“PATH”变量的问题

# java - 为什么 keyListener 不工作？

> ID：13770185
> 
> 赞同：1
> 
> 时间：2012-12-07T20:01:11.147
> 
> 标签：java, swing, keyboard-events, keylistener, key-bindings

这是我制作的乒乓球游戏，但唯一不起作用的是球拍移动。我不确定如何使键盘与程序一起使用。这是主游戏的代码：

```
//Project: A program where you play the game pong

//This module defines the properties of the user interface

import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class pongframe extends JFrame
{
    private JLabel playerlefttitle;
    private JLabel playerrighttitle;
    private JLabel speedtitle;
    private JTextField speedfield;
    private JTextField playerleftscorefield;
    private JTextField playerrightscorefield;
    private JButton newgame;
    private JButton gobutton;
    private JButton pausebutton;
    private JButton quitgame;
    private Timer systemclock;
    private Timer paddleclock;
    private String speedstring;
    private int speed;
    private int leng = 10;
    private int delayinterval;
    private float millisecondpersecond = 1000.0f;
    private boolean win = false;
    private int playerleftscore=0;
    private int playerrightscore=0;
    private boolean rightup = false;
    private boolean rightdown = false;
    private boolean leftup = false;
    private boolean leftdown = false;
    private boolean barhit = true;
    private double direction=0;
    private pongoperations graphicalpanel;
    private Clockhandlerclass clockhandler;
    private PaddleClockHandlerClass paddleclockhandler;
    private PaddleHandlerClass paddlehandler;

    public pongframe()
    {
        super("Pong");
        JPanel panel1 = new JPanel(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();

        graphicalpanel = new pongoperations();
        graphicalpanel.setBackground(Color.GREEN);
        add(graphicalpanel, BorderLayout.CENTER);

        add(panel1, BorderLayout.SOUTH);
        c.insets = new Insets(0,0,10,10);
        newgame = new JButton("New");
        c.gridx = 0;
        c.gridy = 1;
        panel1.add(newgame, c);
        speedtitle = new JLabel("Speed");
        c.gridx = 1;
        c.gridy = 0;
        panel1.add(speedtitle, c);
        speedfield = new JTextField(3);
        c.gridx = 1;
        c.gridy = 1;
        panel1.add(speedfield, c);
        quitgame = new JButton("Quit");
        c.gridx = 2;
        c.gridy = 1;
        panel1.add(quitgame, c);
        playerlefttitle = new JLabel("Player Left");
        c.gridx = 0;
        c.gridy = 3;
        panel1.add(playerlefttitle, c);
        playerrighttitle = new JLabel("Player Right");
        c.gridx = 3;
        c.gridy = 3;
        panel1.add(playerrighttitle, c);
        playerleftscorefield = new JTextField(2);
        playerleftscorefield.setEditable(false);
        c.gridx = 0;
        c.gridy = 4;
        panel1.add(playerleftscorefield, c);
        gobutton = new JButton("Go");
        c.gridx = 1;
        c.gridy = 4;
        panel1.add(gobutton, c);
        pausebutton = new JButton("Pause");
        c.gridx = 2;
        c.gridy = 4;
        panel1.add(pausebutton, c);
        playerrightscorefield = new JTextField(2);
        playerrightscorefield.setEditable(false);
        c.gridx = 3;
        c.gridy = 4;
        panel1.add(playerrightscorefield, c);
        buttonhandler myhandler = new buttonhandler();
        newgame.addActionListener(myhandler);
        gobutton.addActionListener(myhandler);
        pausebutton.addActionListener(myhandler);
        quitgame.addActionListener(myhandler);
        clockhandler = new Clockhandlerclass();
        paddleclockhandler = new PaddleClockHandlerClass();
        paddlehandler = new PaddleHandlerClass();
    }
    private class buttonhandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            graphicalpanel.reset();
            if(event.getSource() == newgame)
            {
                speedfield.setText("");
                playerleftscore = 0;
                playerrightscore = 0;
                playerleftscorefield.setText("0");
                playerrightscorefield.setText("0");
                graphicalpanel.reset();
                graphicalpanel.repaint();
                gobutton.setEnabled(true);
                speedfield.setEditable(true);
                newgame.setEnabled(false);
            }
            else if(event.getSource() == gobutton)
            {
                speedstring = speedfield.getText();
                leng = speedstring.length();
                if(leng == 0)
                    speed = 0;
                else 
                {
                    speed = Integer.parseInt(speedstring);
                    gobutton.setEnabled(false);
                    speedfield.setEditable(false);
                }
                newgame.setEnabled(false);
                delayinterval = (int)Math.floor(millisecondpersecond/speed + 0.5f);
                systemclock = new Timer(delayinterval, clockhandler);
                systemclock.start();
                paddleclock = new Timer(delayinterval, paddleclockhandler);
                paddleclock.start();
            }
            else if(event.getSource() == pausebutton)
            {
                gobutton.setEnabled(true);
                newgame.setEnabled(true);
                systemclock.stop();
            }
            else if(event.getSource() == quitgame)
            {
                System.exit(0);
            }
            else
                System.out.println("Unkown error");
        }
    }
    private class Clockhandlerclass implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            if(event.getSource() == systemclock)
            {
                graphicalpanel.grabFocus();
                graphicalpanel.moveball(speed,delayinterval, direction, barhit);
                direction = graphicalpanel.changedirection(direction);

                if(win == false)
                {
                    barhit = graphicalpanel.barhits(barhit);
                    graphicalpanel.repaint();
                    win = graphicalpanel.winner();
                    playerleftscore = graphicalpanel.playerleftwin(playerleftscore);
                    playerrightscore = graphicalpanel.playerrightwin(playerrightscore);
                    playerleftscorefield.setText(Integer.toString(playerleftscore));
                    playerrightscorefield.setText(Integer.toString(playerrightscore));
                }
                else if(win == true)
                {
                    graphicalpanel.reset();
                    win = false;
                    systemclock.restart();
                    if(playerleftscore == 10)
                    {
                        newgame.setEnabled(true);
                        systemclock.stop();
                    }
                    else if(playerrightscore == 10)
                    {
                        newgame.setEnabled(true);
                        systemclock.stop();
                    }
                    graphicalpanel.repaint();
                }   
            }
            else
                System.out.printf("%s\n", "There is a bug in the clock.");
        }
    }
    private class PaddleClockHandlerClass implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            if(event.getSource() == paddleclock)
            {
                graphicalpanel.moveplayer1(rightup, rightdown);
                graphicalpanel.moveplayer2(leftup, leftdown);
                graphicalpanel.repaint();
            }
        }
    }
    private class PaddleHandlerClass implements KeyListener
    {
        public void keyTyped(KeyEvent event)
        {
        }
        public void keyPressed(KeyEvent event)
        {
            if(event.getKeyCode() == KeyEvent.VK_UP)
            {
                rightup = true;
                System.out.println("Up");
            }
            else if(event.getKeyCode() == KeyEvent.VK_DOWN)
                rightdown = true;
            if(event.getKeyCode() == KeyEvent.VK_W)
                leftup = true;
            else if(event.getKeyCode() == KeyEvent.VK_S)
                leftdown = true;
        }
        public void keyReleased(KeyEvent event)
        {
            if(event.getKeyCode() == KeyEvent.VK_UP)
                rightup = false;
            else if(event.getKeyCode() == KeyEvent.VK_DOWN)
                rightdown = false;
            if(event.getKeyCode() == KeyEvent.VK_W)
                leftup = false;
            else if(event.getKeyCode() == KeyEvent.VK_S)
                leftdown = false;
        }
    }
} 
```

下一段代码是我在游戏中使用的函数：

```
//Project: A program where you play the game pong

//This module contains the graphics and algorithms used by this project.

import java.awt.Graphics;
import javax.swing.JPanel;
import java.awt.Color;

public class pongoperations extends JPanel
{
    int widthofgraphicalarea;
    int heightofgraphicalarea;
    final int ballradius = 8;
    int ballxcoordinate;
    double ballycoordinate;
    int paddle1xcoordinate;
    int paddle1ycoordinate;
    int paddle2xcoordinate;
    int paddle2ycoordinate;

    public void paintComponent(Graphics graphicarea)
    {//function to paint the area
        super.paintComponent(graphicarea);
        this.setBackground(Color.GREEN);
        widthofgraphicalarea = getWidth();
        heightofgraphicalarea = getHeight();
        //create paddle 1
        graphicarea.setColor(Color.BLUE);
        graphicarea.fillRect(paddle1xcoordinate, paddle1ycoordinate, 10, 50);
        //create paddle 2
        graphicarea.setColor(Color.RED);
        graphicarea.fillRect(paddle2xcoordinate, paddle2ycoordinate, 10, 50);
        //Give the ball a white color
        graphicarea.setColor(Color.WHITE);
        //The 3rd and 4th parameters below represent the diameter of the ball.
        graphicarea.fillOval(ballxcoordinate,(int)ballycoordinate,2*ballradius,2*ballradius);
    }//End of method paintComponent
    public void moveplayer1(boolean rightup, boolean rightdown)
    {
        if(rightup == true)
        paddle1ycoordinate -= 5;
        else if(rightdown == true)
        paddle1ycoordinate += 5;
        positionPlayer1(paddle1xcoordinate, paddle1ycoordinate);
    }
    public void moveplayer2(boolean leftup, boolean leftdown)
    {
        if(leftup == true)
        paddle2ycoordinate -= 5;
        else if(leftdown == true)
        paddle2ycoordinate += 5;
        positionPlayer2(paddle2xcoordinate, paddle2ycoordinate);
    }
    public void positionPlayer1(int x, int y)
    {
        this.paddle1xcoordinate = x;
        this.paddle1ycoordinate = y;
        repaint();
    }
    public void positionPlayer2(int x, int y)
    {
        this.paddle2xcoordinate = x;
        this.paddle2ycoordinate = y;
        repaint();
    }
    public void moveball(int speed, int delayinterval, double direction, boolean barhit)
    {
        if(barhit == true)
            ballxcoordinate+=1;
        else if(barhit == false)
            ballxcoordinate-=1;
        if(direction > 0)
            ballycoordinate = ballycoordinate + (double)Math.sin(Math.toRadians(direction));
        else if(direction < 0)
            ballycoordinate = ballycoordinate + (double)Math.sin(Math.toRadians(direction));
    }
    public boolean barhits(boolean barhit)
    {
        if(ballxcoordinate == paddle1xcoordinate+10 && (ballycoordinate >= paddle1ycoordinate && ballycoordinate <= paddle1ycoordinate+50))
            barhit = true;
        else if(ballxcoordinate+2*ballradius == paddle2xcoordinate && (ballycoordinate+2*ballradius >= paddle2ycoordinate && ballycoordinate+2*ballradius <= paddle2ycoordinate+50))
            barhit = false;
        return barhit;
    }
    public boolean winner()
    {
        if(ballxcoordinate+2*ballradius >= widthofgraphicalarea)
            return true;
        else if(ballxcoordinate+2*ballradius <= 16)
            return true;

        return false;
    }
    public int playerleftwin(int playerleftscore)
    {
        if(ballxcoordinate+2*ballradius >= widthofgraphicalarea)
            playerleftscore+=1;

        return playerleftscore;
    }
    public int playerrightwin(int playerrightscore)
    {
        if(ballxcoordinate+2*ballradius <= 16)
            playerrightscore+=1;

        return playerrightscore;
    }
    public double changedirection(double direction)
    {//function to change the direction of the ball to bounce of walls
        if((int)ballycoordinate+2*ballradius >= heightofgraphicalarea || (int)ballycoordinate+2*ballradius < 16)
            direction = -direction;
        return direction;
    }
    public void reset()
    {//reset the ball at middle of left side
        ballxcoordinate = widthofgraphicalarea/2 - ballradius;
        ballycoordinate = heightofgraphicalarea/2 - ballradius;
        paddle1xcoordinate = 10;
        paddle1ycoordinate = heightofgraphicalarea/2-25;
        paddle2xcoordinate = widthofgraphicalarea-20;
        paddle2ycoordinate = heightofgraphicalarea/2-25;
    }
} 
```

请有人帮忙。提前致谢。

如果您可以提供帮助，另一个问题是一旦完成，我如何将其切换为小程序形式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:27:41.030

*   不要使用`KeyListener`Swing 组件使用[`KeyBindings`](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。

*   `JFrame`不要不必要地扩展课程

*   Swing 组件应该创建在[`Event Dispatch Thread`](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

*   要设置应用程序的大小（不`setSize(..)`调用`JFrame`），请在添加组件按钮等（您这样做）时使用适当的 LayoutManager，并在`paintComponent`覆盖`JPanel` `getPreferredSize()`并返回适合所有绘图的适当大小时，而不是`pack()`在`JFrame`设置为可见之前调用

*   不要忘记调用`setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);`，`JFrame`所以当按下*X时，**事件调度线程*和*初始线程*将退出，否则应用程序将继续在后台运行。

但是要在添加后解决您的问题`paddlehandler = new PaddleHandlerClass();`：

```
 graphicalpanel.addKeyListener(paddlehandler); 
```

问题是你从来没有添加`KeyListener`到任何组件来*监听*事件。

正确的解决方案是`KeyBindings`这样改变你 `PaddleHandlerClass`：

```
private class PaddleHandlerClass {

    public PaddleHandlerClass(JComponent jc) {

        jc.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke("UP"), "up");
        jc.getActionMap().put("up", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                rightup = true;
                System.out.println("Up");
            }
        });
        jc.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke("released UP"), "rel up");
        jc.getActionMap().put("rel up", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                rightup = false;
            }
        });
    }

} 
```

而不是简单地创建并传递我们想要获取`paddleHandler`的键的实例：`JPanel`

```
paddlehandler = new PaddleHandlerClass(graphicalpanel); 
```

# java - 拆分字符串并在 Android 中列出

> ID：13770186
> 
> 赞同：1
> 
> 时间：2012-12-07T20:01:12.493
> 
> 标签：java, android, arrays, string, arraylist

我阅读了一个 html 页面并将其放在 StringBuilder 中，如何将其拆分为多个字符 ">","<","/" ...

```
String[] objData = str.toString().split("<"); 
```

之后如何获得 objData 的长度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T06:27:20.913

用新字符替换您要拆分的所有字符，然后将其拆分

String[] objData = str.replace("<", ">").replace("/", ">").split(">");

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T20:21:11.710

您可以使用 SAX-Parser 解析 XML 或查看Android 附带的[XMLPullParser ：http:](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html) [//developer.android.com/training/basics/network-ops/xml.html](http://developer.android.com/training/basics/network-ops/xml.html)

# java - 尝试使用强制转换时出错，java

> ID：13770192
> 
> 赞同：1
> 
> 时间：2012-12-07T20:01:36.823
> 
> 标签：java, casting, instanceof

我有这种方法，我希望能够确定两个单元格是否相等，其中“相等”表示它们具有相同的位置。我已经编写了这段代码，我同时使用`instanceof`和强制转换以确保我的对象属于 type `Position`，然后将其强制转换为 type `Position`，但由于某种原因它似乎不起作用。

这是我的代码：

```
public class Postion {

    private int column;
    private int row;

    public Position (final int column, final int row)  {
        this.column = column;
        this.row = row;
    }

    public int getColumn() {
        return column;
    }

    public int getRow() {
        return row;
    }

    public boolean equals(final Object other) {
        if (other instanceof Position) {
            Position position = (Position) other;
            return ((column == other.getColumn()) && (row == other.getRow()));
        } else {
            return false;
        }
    }
} 
```

我得到了这个错误代码，实际上我得到了这两种`get`方法的错误代码：

```
error:
cannot find symbol
return ((column == other.getColumn()) && (row == other.getRow()));
^
symbol: method getRow()
location: variable other of type Object 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:02:55.330

```
return ((column == other.getColumn()) && (row == other.getRow())); 
```

应该

```
return ((column == position.getColumn()) && (row == position.getRow())); 
```

对象不包含`getColumn()`和`getRow()`方法，它是位置，所以你需要在那里使用位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:06:37.387

您使用了 Object other 而不是键入的 Position 对象位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:09:14.710

你应该重命名

```
Position position = (Position) other; 
```

至

```
Position otherPos = (Position) other; 
```

然后使用

```
otherPos.getColumn() 
```

# ruby-on-rails - 由于 RMagic gem 中的一些错误，我之前的 Rails 项目现在无法运行

> ID：13770202
> 
> 赞同：0
> 
> 时间：2012-12-07T20:02:20.337
> 
> 标签：ruby-on-rails, ubuntu, rmagick

我在 Ubuntu 12.10 上的 Rails 中编写了一个网站。

过了一段时间，当我回来检查它时，当查看 localhost:3000 时，一切正常，直到我们点击任何东西，我看到一个页面说

libMagickCore.so.4：无法打开共享对象文件：没有这样的文件或目录 - /home/dare/.rvm/gems/ruby-1.9.3-p194/gems/rmagick-2.13.1/lib/RMagick2.so

[我在rails应用程序中使用rmagick](https://stackoverflow.com/questions/4408343/error-using-rmagick-in-rails-application)发现了这个错误

但这对我没有用。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T08:34:26.630

当我从 Ubuntu 12.04 升级到 12.10 时，这也发生在我身上。

重新安装 gem 会让事情为你工作

```
gem install rmagick 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T18:48:30.613

我认为 libMagickCore 属于 imagemagick。尝试重新安装它：

```
sudo apt-get remove imagemagick 
```

然后

```
sudo apt-get install imagemagick 
```

# java - 实现二叉搜索树插入

> ID：13770203
> 
> 赞同：1
> 
> 时间：2012-12-07T20:02:23.930
> 
> 标签：java, binary-search-tree

我正在尝试为二叉搜索树编写代码，我正在使用的第一个方法是添加（插入）方法。根似乎正确插入，但添加第二个节点时出现空指针异常。我将在我的代码中用注释指出确切的问题点。

如果您可以看到如何修复错误，或者让我知道我的整体逻辑是否有缺陷，那将非常有帮助。--我会提到这是为学校准备的，所以我不想制作一个真正令人印象深刻的模型。 ..我的大部分布局选择只是反映了我们在课堂上的工作方式。此外，方法名称是由老师选择的，应该保持不变。随意编辑格式，有点麻烦。

# 二叉树类

```
public class BinarySearchTree 
{   
private static Node root;

    public BinarySearchTree()
    {
        root = null;
    }

    public static void Add (Node newNode)
    {
        Node k = root;
        if (root == null)//-----------------IF TREE IS EMPTY -----------------
        {
            root = newNode;
        }

        else // -------TREE IS NOT EMPTY --------

        {
        if (newNode.value > k.value) //-------NEW NODE IS LARGER THAN ROOT---------
        {   
            boolean searching = true;

            while(searching) // SEARCH UNTIL K HAS A LARGER VALUE
            {   //***CODE FAILS HERE****
                if(k.value > newNode.value || k == null) 
                {
                    searching = false;
                }
                else {k = k.rightChild; }
            }

            if ( k == null) { k = newNode;} 
            else if (k.leftChild == null){ k.leftChild = newNode;} 
            else 
            {
                Node temp = k.leftChild;
                k.leftChild = newNode;
                newNode = k.leftChild;

                if(temp.value > newNode.value )
                {
                    newNode.rightChild = temp;
                }
                else
                {
                    newNode.leftChild = temp;
                }
            }

        }

        if (newNode.value < k.value) //-----IF NEW NODE IS SMALLER THAN ROOT---
        {   
            boolean searching = true;

            while(searching) // ----SEARCH UNTIL K HAS SMALLER VALUE
            {// **** CODE WILL PROBABLY FAIL HERE TOO ***
                if(k.value < newNode.value || k == null) {searching = false;}
                else {k = k.leftChild;} 
            }

            if ( k == null) { k = newNode;} 
            else if (k.rightChild == null){ k.rightChild = newNode;} 
            else 
            {
                Node temp = k.rightChild;
                k.rightChild = newNode;
                newNode = k.rightChild;

                if(temp.value > newNode.value )
                {
                    newNode.rightChild = temp;
                }
                else
                {
                    newNode.leftChild = temp;
                }
            }
        }       
           }} // sorry having formatting issues
} 
```

# 节点类

```
public class Node 
{
    int value;
    Node leftChild;
    Node rightChild;

    public Node (int VALUE)
    {
                value = VALUE;
    }
} 
```

# 测试应用

```
public class TestIT
{

    public static void main(String[] args) 
    {

        BinarySearchTree tree1 = new BinarySearchTree();
        Node five = new Node(5);
        Node six = new Node(6);

        tree1.Add(five);
        tree1.Add(six);

        System.out.println("five value: " + five.value);
        System.out.println("five right: " + five.rightChild.value);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:06:50.603

条件语句是从左到右检查的，所以在检查是否 k.value > newNode.value 之前需要检查 k 是否为 null，因为如果 k 为 null，则它没有值。

# asp.net - 必修课的目的是什么？

> ID：13770204
> 
> 赞同：0
> 
> 时间：2012-12-07T20:02:24.050
> 
> 标签：asp.net, asp.net-mvc-4, sections

我了解`required: false`MVC4 中部分的好处。它们只是布局的可选部分，如果视图不包含它们，则不会显示。但是`required: true`部分的好处是什么？部分中的某些内容不应该`required: true`直接放入布局本身吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:03:46.833

举个例子，你可以有一个菜单，每个页面都需要，但在控制器和/或区域之间也会有所不同。

# node.js - 在各种目录中加载 Jade 模板？

> ID：13770206
> 
> 赞同：1
> 
> 时间：2012-12-07T20:02:29.277
> 
> 标签：node.js, pug, express

我无法[从这张票](https://stackoverflow.com/questions/11675453/jade-loading-templates-from-different-directories)中获得结果来工作。我只是想创建更多模块化的代码块，并希望将路线和视图放在一起。我需要对这个进行健全性检查。

我无法使用相对路径获取获取 Jade 文件的路径（而且我不喜欢相对路径）`Error: Failed to lookup view "../test/app"`：. 请帮忙 ：）

Github：[https ://github.com/franklovecchio/stackoverflow-13770206](https://github.com/franklovecchio/stackoverflow-13770206)

文件夹结构：

```
 .
    │
    ├── package.json
    ├── public
    │   └── lib
    │       └── login
    │           ├── 0.0.1
    │           │   └── routes.coffee
    │           └── test
    │               └── app.jade 
    ├── server.coffee
    └── views
        └── layout.jade 
```

**服务器.coffee**

```
express = require('express')
http = require('http')
path = require('path')

app = express()

app.configure () ->
  app.set 'port', process.env.PORT or 3000 # Give us the ability to specify port through command-line or external process.

  app.set 'view options', 
    layout: false

  app.set 'view engine', 'jade'

  app.use express.favicon() # auto-gen
  app.use express.logger('dev') # auto-gen
  app.use express.bodyParser() # auto-gen
  app.use express.methodOverride() # auto-gen

  # Required by session() middleware
  # Pass the secret for signed cookies
  app.use express.cookieParser('The Stay Puft Marshmallow Man')

  app.use app.router

  app.use express.static(path.join(__dirname, '/public')) # Serve static assets.

app.configure 'development', ->
  app.use express.errorHandler()
  app.use require('readymade').middleware(root: '/public') # Make .coffee/.less serve as compiled .js/.css files.

# Routes

# ======================  Login ======================  # 
login = require './public/lib/login/0.0.1/routes'
app.get '/', login.view
# ====================== /Login ======================  # 

http.createServer(app).listen app.get('port'), ->
  console.log 'Express server listening on port: ' + app.get('port') 
```

**路线.咖啡**

```
exports.view = (req, res) ->

  res.render '../test/app' 
```

**应用程序.jade**

```
extends ../../../../views/layout

p login 
```

**布局.jade**

```
doctype 5
html
  head
    title My title
    block head
  body
    #content
      block content 
```

**包.json**

```
{
  "name": "myapp",
  "description": "modular",
  "version": "0.0.1",
  "private": true,
  "dependencies": {
    "express":"3.0.4",
    "less":"",
    "jade":"",
    "markitup":"",
    "readymade": ""
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T19:08:36.510

它与`public`目录是您的静态文件服务目录有关。从您的中删除以下行，`server.coffee`它将正常工作。

```
app.use express.static(path.join(__dirname, '/public')) # Serve static assets. 
```

或者，将您的代码和视图放在`public`目录之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T13:13:10.510

路线.咖啡

```
exports.view = (req, res) ->
  res.render __dirname + '../test/app' 
```

# javascript - 如何在客户端获取 Html 数据 ckEditor？通过在客户端更改字符预览结果？

> ID：13770208
> 
> 赞同：0
> 
> 时间：2012-12-07T20:02:36.317
> 
> 标签：javascript, jquery, asp.net, ajax, ckeditor

我在获取用 Jquery 中的 ckeditor 编写的数据 html 时遇到问题。
我无法通过 jQuery 选择数据，因为此编辑器在 $(document).ready() 之后加载文件
我获取数据并通过 $.ajax{} 发布到 db ，并显示在预览部分。
(c#/asp.net)

我的问题：
我无法获取 elementID。
我通过将 dll 添加到工具箱来使用 ckeditor。

html代码中的ckeditor

```
<CKEditor:CKEditorControl ID="CKEditorControl" runat="server"  
            BasePath="ckeditor" ContentsCss="ckeditor/contents.css" 
            Height="250px" 
            TemplatesFiles="ckeditor/themes/default/theme.js" FilebrowserBrowseUrl="ckeditor/plugins/FileManager/index.html" 
            FilebrowserFlashBrowseUrl="ckeditor/plugins/FileManager/index.html" FilebrowserFlashUploadUrl="ckeditor/plugins/FileManager/index.html" 
            FilebrowserImageBrowseLinkUrl="ckeditor/plugins/FileManager/index.html" FilebrowserImageBrowseUrl="ckeditor/plugins/FileManager/index.html" 
            FilebrowserImageUploadUrl="ckeditor/plugins/FileManager/index.html" 
            FilebrowserUploadUrl="ckeditor/plugins/FileManager/index.html" BackColor="#FF0066" 
                    DialogButtonsOrder="Rtl" 
                    FontNames="B Yekan; B Yekan,tahoma;Arial/Arial, Helvetica, sans-serif; Comic Sans MS/Comic Sans MS, cursive; Courier New/Courier New, Courier, monospace; Georgia/Georgia, serif; Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif; Tahoma/Tahoma, Geneva, sans-serif; Times New Roman/Times New Roman, Times, serif; Trebuchet MS/Trebuchet MS, Helvetica, sans-serif; Verdana/Verdana, Geneva, sans-serif" 
                    ResizeDir="Vertical" ResizeMinHeight="350" UIColor="#CACACA">dhd fdh</CKEditor:CKEditorControl> 
```

谁能帮我吗？

============================
core.ckeditor.js 中的方法

```
getData : function()
        {
            this.fire( 'beforeGetData' );

            var eventData = this._.data;

            if ( typeof eventData != 'string' )
            {
                var element = this.element;
                if ( element && this.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE )
                    eventData = element.is( 'textarea' ) ? element.getValue() : element.getHtml();
                else
                    eventData = '';
            }

            eventData = { dataValue : eventData };

            // Fire "getData" so data manipulation may happen.
            this.fire( 'getData', eventData );

            return eventData.dataValue;
        } 
```

描述：

```
{String} getData() Since: 3.0
Gets the editor data. The data will be in raw format. It is the same data that is posted by the editor. 
Defined in: core/editor.js.
if ( CKEDITOR.instances.editor1.getData() == '' )
    alert( 'There is no data available' );
Returns:
{Undefined} (String) The editor data. 
```

我写了代码：
html：

```
<textarea id="editor"></textarea> 
```

js：

```
var edit = CKEDITOR.replace('editor');
        alert(CKEDITOR.instances.edit.getData()); 
```

但没有发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T11:44:18.807

利用

```
alert(CKEDITOR.instances.<%=CKEditorControl.ClientID %>.getData()); 
```

有用。

# ruby-on-rails - 使用 datagrid gem 接受过滤器的多个值

> ID：13770209
> 
> 赞同：1
> 
> 时间：2012-12-07T20:02:40.697
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, datagrid, gem

有人可以发布正确的语法来设置`filter()`数据网格以处理多个值，包括`column()`设置？

我的用例是我想按与某个原点的距离进行过滤。我可以按原点进行过滤，但我必须在远处进行硬编码。我希望能够将“New York, NY”和“25”传递给过滤器，以便为我提供纽约州纽约市 25 英里范围内的所有结果。

您不必展示如何成功地将两个变量传递到代码块中的实际逻辑。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:30:34.687

这有效

```
filter(:user_location, :string, :header => "Location", :multiple=>true) do |value|

origin = value[0]
distance = value[1]

end 
```

当您以这种方式设置过滤器时，会生成表单字段并`[]`自动填充它。为了传递多个值，您似乎需要在括号内输入它们，用逗号分隔。即`["New York, NY", "25"]`。这确实需要更好地解决。当您提交表单时，将执行过滤，但随后该字段将填充`["[\"New York, NY\", \"25\"]"]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T19:18:53.003

我会建议稍微不同的东西。无需将两件事合并为一：

```
filter(:user_location, :string, header: 'Location') do |value, model, grid|
  origin = value
  distance = grid.radius
  ...
end

filter(:radium, :enum, select: [5,10,15,20,25], dummy: true) 
  # can be integer instead of enum 
```

# python - Python 程序获取文件名并打开它，创建一个带有数据标记的新文件？

> ID：13770211
> 
> 赞同：-4
> 
> 时间：2012-12-07T20:02:45.647
> 
> 标签：python, xml, file, input, output

例如一个文件，例如：

```
def player():

Player    
9    
Mike    
M    
180    
90    
6    
2    
3.81    
.283 
```

将返回数据，例如：

```
<player>
<number> 9 </number>
<playername> Mike </playername>
<gender> M </gender>
<height> 175 </height>
<weight> 95 </weight>
<wins> 6 </wins>
<losses> 2 </losses>
<era> 3.81 </era>
<batting> .283 </batting>
</player> 
```

如果您能给我有关文件到数据的任何信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:24:22.470

我的想法是阅读每一行，用空格分隔行。之后，我将打印带有特定标签的数组中的元素。您可以将标签存储在列表中，结束标签可以是转换为列表的对，并在 1 位置插入“/”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:08:11.310

您可以使用 readlines() 读取文件的数据。除此之外，您的问题确实不精确。

# android - 初级 android 开发人员 - 布局有困难

> ID：13770215
> 
> 赞同：1
> 
> 时间：2012-12-07T20:02:53.440
> 
> 标签：android, layout, button, scrollview

我有一个位于 a 下方的`ScrollView`按钮，该按钮设置为与父级底部对齐。滚动视图设置`wrap_content`为它的高度。一旦`ScrollView`填充了内容，它就会出现在按钮下方。如何将其设置为不在按钮后面，以便`ScrollView`在按钮开始时结束？

我试过放在`android:layout_below`底部按钮，当它不起作用时，我尝试`layout_above`在`ScrollView`按钮上方的 for 中。最后一个导致我的应用程序在启动时崩溃，不知道为什么。第一个一旦`ScrollView`比屏幕长，它会导致按钮被放置在下面而无法访问它。

这是我的 XML 文件。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/light_blue"
    android:padding="5dp"
    tools:context=".MainActivity" >

    <EditText
        android:id="@+id/editText_query"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="@string/queryPromt"
        android:imeOptions="actionNext"
        android:inputType="text"
        android:textColor="#000" />

    <EditText
        android:id="@+id/editText_tag"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/editText_query"
        android:layout_marginTop="10dp"
        android:layout_toLeftOf="@+id/saveButton"
        android:hint="@string/tagPrompt"
        android:imeOptions="actionDone"
        android:inputType="text" />

    <Button
        android:id="@id/saveButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@id/editText_query"
        android:text="@string/save" />

    <TextView
        android:id="@+id/textView_taggedSearches"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignRight="@id/saveButton"
        android:layout_below="@id/saveButton"
        android:layout_marginTop="10dp"
        android:background="#666"
        android:gravity="center_horizontal"
        android:text="@string/taggedSearches"
        android:textColor="#FFF"
        android:textSize="18sp" />

    <ScrollView
        android:id="@+id/scrollView_query"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/textView_taggedSearches"
        android:padding="5dp" >

        <TableLayout
            android:id="@+id/tableLayout_query"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:padding="5dp"
            android:stretchColumns="*" >
        </TableLayout>
    </ScrollView>

    <Button
        android:id="@+id/button_clearTags"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:text="@string/clearTags" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:08:13.130

尝试添加

```
android:layout_below="@id/scrollView_query" 
```

到最后一个按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:49:42.180

我以前在我的项目中这样做过。这是我的 xml 代码。您可以根据您的使用情况对其进行修改。

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_height="wrap_content" android:layout_width="fill_parent">
     <TextView android:id="@+id/TextView01" android:layout_height="wrap_content" android:layout_width="wrap_content" android:text="This text view should act as header  " />
     <ScrollView android:layout_marginBottom="50dip" android:id="@+id/ScrollView01" android:layout_height="wrap_content" android:layout_width="fill_parent">
          <RadioGroup android:id="@+id/RadioGroup01" android:layout_width="wrap_content" android:layout_height="wrap_content">
               <RadioButton android:id="@+id/RadioButton01" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton02" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />
               <RadioButton android:id="@+id/RadioButton11" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Radio Button....." />       
          </RadioGroup>
     </ScrollView>
     <RelativeLayout android:layout_marginTop="-50dip" android:gravity="bottom" android:layout_height="wrap_content" android:layout_width="fill_parent">
        <TableLayout android:layout_width="fill_parent" android:layout_height="fill_parent" android:stretchColumns="1">
         <TableRow>
        <Button android:id="@+id/Button01" android:layout_height="wrap_content" android:layout_width="wrap_content" android:text="One"/>
        <Button android:id="@+id/Button01" android:layout_height="wrap_content" android:layout_width="wrap_content" android:text="Two" android:layout_gravity="center_vertical"/>
        <Button android:id="@+id/Button01" android:layout_height="wrap_content" android:layout_width="wrap_content" android:text="Three" android:layout_gravity="right"/>
        </TableRow>
        </TableLayout>
     </RelativeLayout>
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:06:51.753

您可以为此使用 layout_weight 。如果将 layout_height 设置为“0px”，则可以使用 layout_weight 在兄弟项目之间分配剩余的父空间。

在这种情况下，您希望按钮具有正常大小，并且滚动视图占据剩余的任何空间。这应该给你一个大致的想法：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:orientation="vertical"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent" >

    <ScrollView
     android:layout_width="fill_parent"
     android:layout_height="0px"
     android:layout_weight="1" >

        <TableLayout
         android:layout_width="fill_parent"
         android:layout_height="wrap_content" />

    </ScrollView>

    <Button
     android:layout_width="wrap_content"
     android:layout_height="wrap_content" />

</LinearLayout> 
```

# c# - NHibernate - LINQ 查询多对多问题

> ID：13770217
> 
> 赞同：2
> 
> 时间：2012-12-07T20:03:01.350
> 
> 标签：c#, linq, nhibernate, nhibernate-mapping

我正在尝试升级现有应用程序以使用 NHibernate。我的数据库有以下表格：

```
Sites:
- Id (PK)
- Name

Categories:
- Id (PK)
- Name

CategoriesSite
- CategoryId (PK)
- SiteId (PK)
- Active 
```

对于每个类别和站点，CategoriesSite 表中可能存在也可能不存在记录。如果某个项目存在于 CategoriesSite 表中，那么它可以通过将 Active 设置为 false 来关闭 Category。**如果不是，则假定 Active 为 true**。

我想在 NHibernate 中创建一个 LINQ 查询来过滤特定站点的类别（处于活动状态）。例如说我有以下数据：

```
Sites:
Id | Name
1  | Site 1
2  | Site 2

Categories:
Id | Name
1  | Category 1
2  | Category 2

CategoriesSite:
CategoryId | SiteId | Active
1          | 1      | True
1          | 2      | True
2          | 1      | False 
```

我可以说：

```
var categories = session.Query<CategorySite>()
                        .Where(s => s.Site.Id == 2 && s.Active)
                        .Select(s => s.Category)
                        .ToList(); 
```

但是，这只会获得类别 1 而不是类别 2，我希望它这样做。我想知道是否有人做过类似的事情，并且可以提出一种查询方法或提供有关如何更好地映射此场景的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T22:46:35.753

没有看到生成的查询，我只能猜测，但是，试试这个：

```
var categories = session.Query<CategorySite>()
                    .Where(s => s.SiteId == 2 && s.Active) // not s.Site.Id
                    .Select(s => s.Category)
                    .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T16:31:36.867

我想我已经解决了这个问题。我针对类别站点列表的类别添加了一对多集合。这让我可以说：

```
var categories = session.Query<Category>()
                        .Where(c => !c.Sites.Any(s => s.Site.Id == 2 && !s.Active))
                        .ToList(); 
```

这意味着它仅在设置为非活动时不会返回类别，并且在 CategoriesSite 表中不存在任何记录时仍将返回类别。

# scala - 调用 distinct 和 map 一起在 spark 库中抛出 NPE

> ID：13770218
> 
> 赞同：7
> 
> 时间：2012-12-07T20:03:11.193
> 
> 标签：scala, nullpointerexception, apache-spark

我不确定这是否是一个错误，所以如果你做这样的事情

```
// d:spark.RDD[String]
d.distinct().map(x => d.filter(_.equals(x))) 
```

您将获得一个 Java NPE。但是，如果您`collect`立即执行`distinct`，一切都会好起来的。

我正在使用[火花](http://www.spark-project.org)0.6.1。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-02T22:52:12.307

Spark 不支持嵌套 RDD 或引用其他 RDD 的用户定义函数，因此会出现 NullPointerException；[在邮件列表](https://groups.google.com/d/topic/spark-users/KC1UJEmUeg8/discussion)上看到[这个线程`spark-users`](https://groups.google.com/d/topic/spark-users/KC1UJEmUeg8/discussion)。

看起来您当前的代码正在尝试`d`按值对元素进行分组；您可以使用`groupBy()` [RDD](http://spark-project.org/docs/latest/api/core/index.html#spark.RDD)方法有效地做到这一点：

```
scala> val d = sc.parallelize(Seq("Hello", "World", "Hello"))
d: spark.RDD[java.lang.String] = spark.ParallelCollection@55c0c66a

scala> d.groupBy(x => x).collect()
res6: Array[(java.lang.String, Seq[java.lang.String])] = Array((World,ArrayBuffer(World)), (Hello,ArrayBuffer(Hello, Hello))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-10T22:06:23.660

Spark 1.3.0 流编程指南中提供的窗口示例怎么样

```
val dataset: RDD[String, String] = ...
val windowedStream = stream.window(Seconds(20))...
val joinedStream = windowedStream.transform { rdd => rdd.join(dataset) } 
```

SPARK-5063 导致示例失败，因为连接是从 RDD 上的转换方法中调用的

# c# - 必应付费 Web 结果仅 API 返回 403 错误

> ID：13770224
> 
> 赞同：1
> 
> 时间：2012-12-07T20:03:59.523
> 
> 标签：c#, bing, http-status-code-403, bing-api

这是我使用 Bing API 进行搜索的代码。我们有 Web Only API 的付费版本。我在其他地方读到其他人对仅使用 Web 结果的 API 有问题，但肯定有人在那里完成了这项工作。

这是我使用的代码。您将从代码下方的错误中看到，它在此处代码的最后一行失败并给出 403 错误。对此的任何帮助将不胜感激。

```
string keyterms = "";
if (Request.QueryString["keywords"] != null) { keyterms = Request.QueryString["keywords"].Trim(); }

var bingContainer = new Bing.BingSearchContainer(new Uri("https://api.datamarket.azure.com/Bing/Search"));
var accountKey = "our api";
bingContainer.Credentials = new NetworkCredential(accountKey, accountKey);
var query = bingContainer.Web(keyterms, null, null, null, null, null, null, null);
var results = query.Execute(); 
```

这是屏幕上显示的实际错误。

```
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Data.Services.Client.DataServiceClientException: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<title>403 - Forbidden: Access is denied.</title>
<style type="text/css">
<!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
-->
</style>
</head>
<body>
<div id="header"><h1>Server Error</h1></div>
<div id="content">
<div class="content-container"><fieldset>
 <h2>403 - Forbidden: Access is denied.</h2>
 <h3>You do not have permission to view this directory or page using the credentials that you supplied.</h3>
</fieldset></div>
</div>
</body>
</html>

Source Error:
Line 39:             bingContainer.Credentials = new NetworkCredential(accountKey, accountKey);
Line 40:             var query = bingContainer.Web(keyterms, null, null, null, null, null, null, null);
Line 41:             var results = query.Execute(); 
```

# java - Spring 3 bean 实例化序列

> ID：13770225
> 
> 赞同：27
> 
> 时间：2012-12-07T20:04:00.540
> 
> 标签：java, spring

无论如何指定要实例化bean的顺序吗？即，我希望在其他 bean 之前实例化特定的 bean，就像启动序列一样。

我正在使用 Spring 3.2 和基于注释的声明方法。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-07T20:29:06.543

如果 bean *A*通过定义bean B依赖于 bean *B*`<property/>`，`@Autowired`则`<constructor-arg/>`顺序由 Sp​​ring 容器强制和固定。这里没问题。

但是，如果您想强制执行未通过显式依赖项表达的特定 bean 创建顺序，请随意使用：

```
<bean id="A" depends-on="B"/>
<bean id="B"/> 
```

或更好（带有注释，也适用于`@Bean`Java 配置）：

```
@Service
@DependsOn("B")
public class A {} 
```

甚至更好......不要使用它。这些构造是一种代码味道，通常表明您的组件之间存在一些令人讨厌的无形依赖关系。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-23T14:00:53.473

同意 Tomasz 提供的答案。如果您知道 bean A 依赖于 bean B，那么这是正确的方法。

有时，您有应该在所有 bean 实例化之前执行的逻辑。在这种情况下，您可以使用[BeanFactoryPostProcessor](http://docs.spring.io/spring/docs/3.1.4.RELEASE/javadoc-api/org/springframework/beans/factory/config/BeanFactoryPostProcessor.html)。Spring 首先创建并执行 BeanFactoryPostProcessors，然后只创建和执行所有其他 bean。同时，如果您的 BeanFactoryPostProcessor 依赖于某个 bean A，您可以使用属性或构造函数注入。在这种情况下，Spring 将首先创建 bean A，然后是您的 BeanFactoryPostProcessor，调用 BeanFactoryPostProcessor，然后仅实例化上下文中的所有其他 bean。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:16:09.770

您可以使用 bean 上的 Ordered 接口来定义相对于其他 bean 的排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-19T03:11:28.693

此外，如果你`BeanFactoryPostProcessor`像 emamedov 所说的那样使用，`Ordered`可以实现接口来控制`BeanFactoryPostProcessor`实例顺序。

# infopath2010 - 默认当前时间为东部标准时间

> ID：13770229
> 
> 赞同：1
> 
> 时间：2012-12-07T20:04:29.650
> 
> 标签：infopath2010

我有一个 Infopath 表单（链接到 sharepoint 2010 列表），其中包含一个显示当前时间的文本框字段。我的问题是我的一些目标用户在不同的时区工作，我希望该字段以东部标准时间计算当前时间。

我目前使用这个公式作为文本框的默认值：

子字符串后（现在（），“T”）

有没有办法操纵这个函数来显示 EST 中的当前时间。如果没有，那么我愿意接受任何建议。

谢谢，

# php - 如何在尊重本地或远程 TZ 中可能发生的 DST 更改的同时将时区转换为用户的本地 TZ？

> ID：13770231
> 
> 赞同：1
> 
> 时间：2012-12-07T20:04:35.743
> 
> 标签：php, timezone

我的任务是在本地 TZ 中显示事件的日期。代表的日期是将来的日期，它可能会在本地或事件 TZ 的 DST 更改中运行。

我的老板说，如果涉及的其中一个 TZ 的 DST 发生变化，将活动时间简单地转换为本地时间是不够的，因为星期五@晚上 8 点是不准确的。

我几乎确信这对于我们需要输出信息的目的来说是行不通的，但他坚持认为他希望它完成。

有没有人有一个很好的来源和简单的方法来做这些计算？请记住，这是针对网站上的日期，并且可能需要在大量页面上完成...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T07:19:33.510

1.  从用户那里收集本地时区。您可能希望他们明确选择一个区域，而不是为他们猜测。有些地区的夏令时使用*非常不标准。*
2.  以 UTC存储*每个*日期时间。他们中的每一个。
3.  确保您的数据库不了解时区，因此不操作日期时间字段，或者它*确实*了解时区，并且您明确将日期时间的存储设置为 UTC。例如， MySQL 具有*可怕*的时区支持，而 PostgreSQL 允许您使用日期时间本身定义时区。它很时髦。
4.  使用 PHP 的[DateTime](http://php.net/class.datetime)类来表示日期时间，因为这样你就可以...
5.  使用传递给 DateTime[方法](http://php.net/class.datetimezone)[`setTimezone`](http://php.net/datetime.settimezone)的 DateTimeZone可以根据需要将 UTC 时间简单地更改为本地时间。
6.  向用户显示本地正确的日期时间。
7.  ？？？
8.  利润！

# .htaccess - .htaccess 规则重写从子域到亚马逊的调用

> ID：13770236
> 
> 赞同：1
> 
> 时间：2012-12-07T20:05:17.843
> 
> 标签：.htaccess

我希望重写所有调用

```
subdomain.domain.com/video.mp4 
```

重写为

```
https://s3.amazonaws.com/whatever/video.mp4 
```

我该怎么做？

这适用于视频播放器/脚本中的嵌入式调用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:14:51.763

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^subdomain\.domain\.com$ [NC]
RewriteRule ^(.+)$ https://s3.amazonaws.com/whatever/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:09:31.543

假设您有一个用于子域的专用文件夹，您只需要以下规则：

```
RedirectMatch 301 /(.*) https://s3.amazonaws.com/whatever/$1 
```

# header-files - 无法在开发 C++ 中包含少量头文件

> ID：13770241
> 
> 赞同：0
> 
> 时间：2012-12-07T20:05:46.987
> 
> 标签：header-files, dev-c++

当我在 Dev C++ 中包含几个像**#include "afxwin.h" 和 #include "afxext.h"**的头文件时，它显示我找不到文件。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:26:44.617

我遇到了同样的问题，这对我有用

在 filename.cpp 中，我输入：#include “ filename.h 的*完整路径*”

使用该文件时，我输入了：#include“ filename.h*的完整路径*”和#include“ filename.cpp*的完整路径*”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:48:36.343

这些是 MS Visual C++ 预编译头文件（与 MFC 相关）：

[http://en.wikipedia.org/wiki/Precompiled_header](http://en.wikipedia.org/wiki/Precompiled_header)

你可能会很幸运，能够编译并结合 GCC/Dev-C++ 使用它们，但我不会打赌（见开篇的第三条评论）：

[如何在 Windows 上从 MSVC 编译器迁移到 GCC？](https://stackoverflow.com/questions/9025617/how-do-i-move-from-the-msvc-compiler-to-gcc-on-windows)

假设该注释是正确的，您将无法在 GCC 编译器上使用 MFC。而且因为 Dev-C++ 使用这些，你也不能将 MFC 与 Dev-C++ 结合使用。作为替代方案，您可以试用免费版本的 MS Visual Studio 以使用标头。

# perl - Perl封装类变量？

> ID：13770243
> 
> 赞同：4
> 
> 时间：2012-12-07T20:05:54.287
> 
> 标签：perl, oop, inheritance, closures, encapsulation

我对 perl 很陌生，而且我被困在一个家庭作业问题上。我有一个带有类变量的对象，它计算创建的实例数。然后我有一个带有实例变量的子类。

我的第一个问题是，如何使类变量对用户隐藏？我尝试使用闭包，但无法弄清楚如何使用它进行继承。它是一个类变量这一事实使情况变得更糟，因为递增它的代码执行了两次，它说我有两个实例，而我有一个。不完全确定它为什么会发生，但它是有道理的。我尝试使用标量，但变量再次没有正确递增。还没有尝试过“由内而外的对象”，我不确定我是否愿意，这似乎超出了我的想象。我感觉封装类变量与封装实例变量不同，但我找不到任何解释如何做到这一点的东西。

我的第二个问题是，正如我所提到的，我无法通过封装来处理继承。当您从子类调用超级构造函数时使用闭包，您将获得对子例程的引用，因此（据我所知）无法向其中添加实例变量。

这是我的基类：

```
#!/usr/bin/perl -w
use strict;
package Base;

my $count = 1;

sub new {
    my $class = shift;
    my $self = {
        _Count => $count # not hidden
    };
    $count++; # increment count
    bless $self, $class;
    return $self;
}

sub Count { # getter
    my $self = shift;
    return $self->{_Count};
}
1; 
```

这是我的子类：

```
#!/usr/bin/perl -w
use strict;
package Sub;
use Base;
our @ISA = qw(Base);

sub new {
    my $class = shift;
    my $self = $class->SUPER::New();
    $self->{_Name} = undef; # not hidden
    return $self;
}

sub Name { #getter/setter
    my($self, $name) = @_;
    $self->{_Name} = $name if defined($name);
    return $self->{_Name};
}
1; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T21:08:43.690

如果您使用的是裸 Perl 5（而不是使用 OO 框架），则执行类变量的常用方法是作为仅对访问者可见的词法：

```
{
    my $count = 0;

    sub Count {
        my ($self, $new_count) = @_;

        if (defined $new_count) { # NB only works if undef is not a legit value
            $count = $new_count;
        }

        return $count;
     }
} 
```

`$count`仅在封闭块中可见；甚至同一类的其他方法也看不到它。但是任何人都可以使用`$base_obj->Count`或对其进行操作`Base->Count`，并且任何此类操作都会影响共享变量。

您还可以使用闭包来提供真正隐藏的实例变量。除非您正在履行家庭作业的任意规则，否则这是不值得做的。

```
package Base;

sub new {
    my ($class, $name) = @_;
    die "Need name!" unless defined $name;

    my $age;

    return bless sub {
        my ($attribute, @args) = @_;

        if ($attribute eq 'name') {
            if (@args) {
                die "Attempt to set read-only attribute!";
            }
            return $name;
        }

        if ($attribute eq 'age') {
            if (@args) {
                 ($age) = @args;
            }
            return $age;
        }

        die "Unknown attribute $attribute";
    } => $class;
}

sub name {
    my ($self, @args) = @_;

    return $self->(name => @args);
}

sub age {
    my ($self, @args) = @_;

    return $self->(age => @args);
} 
```

这里发生的情况是，由返回的祝福 sub`new`关闭了两个词汇，`$name`并且`$age`. 返回时`new`，这些词法超出范围，从那时起访问它们的唯一方法是通过闭包。闭包可以检查它的参数以允许或拒绝访问它持有的值。只要它从不返回引用，就可以确定它只有直接访问这些变量的权限。

这也适用于继承，没有太多额外的微妙之处：

```
package Derived;
use base 'Base';
sub new {
    my ($class, $name, $color) = @_;

    my $base_instance = $class->SUPER::new($name);

    return bless sub {
        my ($attribute, @args) = @_;

        if ($attribute eq 'color') {
            if (@args) {
                 ($color) = @args;
            }
            return $color;
        }

        # base class handles anything we don't, possibly by dying
        return $base_instance->($attribute, @args);
    } => $class;
} 
```

这模拟了对基类和派生类实例数据具有不同存储的语言所做的事情，要么在本地处理请求，要么将其传递给已添加到闭包中的基类实例。更深的继承树将导致闭包关闭闭包，每个闭包也可以选择关闭该特定类所需的实例变量。

这是一个相当大的混乱，很难检查和调试，这就是为什么我要再强调一次，你不应该这样做。但了解这一点非常有用，我将您推荐给[SICP](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-20.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T21:21:01.867

作为模块局部`my`变量，`$count`已经对模块/类的用户隐藏。看起来好像您将实例变量`_Count`用作“当前 ID”类型变量，以便创建的每个对象（实例）都从 1 开始获得一个新 ID。（如果相反，它是为了跟踪活动实例的数量，那么您需要将其递减，`DESTROY`并且无需在对象中存储副本。）如果您的测试代码仅创建一个实例，则其`Count()`方法应返回 1 但`$count`将是 2，因为它从 1 开始并在存储后递增对象中的旧值。

在 perl 中，典型的做法是将实例变量存储在`$self`哈希中，而不隐藏它们，尽管有时会使用前缀来避免冲突。与语言特性相比，它们更受惯例的保护（依赖实现细节是不安全的，因为它们可能会改变）。

如果您想对 perl 类进行更高级别的控制，请查看[Moose](http://search.cpan.org/dist/Moose/)模块套件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T21:36:50.970

在 Perl 中，通常不会通过语言的语义来隐藏字段，而是通过文档形式的合同来隐藏字段。但是，可以通过使用闭包来隐藏字段。还值得注意的是，Perl 并没有在语义上区分类方法和实例方法。

实现对象的标准方法之一是祝福哈希，就像你一样。此哈希包含所有实例变量/字段。习惯上用下划线开始“私有”字段。通常，合约（文档）不会说明这些字段是如何存储的，但会要求类的用户通过各种方法调用。

类变量不应与实例一起存储。最好使用全局变量或词法变量。在您提供的代码中，`$count`它只是一个计数器，但您永远不会将它作为类变量访问。相反，您为每个实例分配一个唯一 ID。要将它用作类变量，请提供适当的访问器（我去掉了像`return`s 这样的不必要的东西）：

```
{
  package Base;

  my $count = 0;

  sub new {
    my ($class) = @_;
    my $self = {
      ID => $count++,
    };
    bless $self, $class;
  }

  sub Count  { $count }
  sub ID     { my ($self) = @_; $self->{ID} }
  sub report { my ($self) = @_; "I am the Base object ".($self->ID)."." }
}

=head1 Base

A generic base class

=head2 Base->Count

Return the object count.

=head2 $base->ID

Give the unique ID of this object.

=head2 $base->report

Returns a string containing a short description.

=cut 
```

子类与计数无关。这是由上述变量的范围强制执行的`$count`，通过外部花括号表示。subs 是这个变量的闭包。

```
{
  package Sub;
  use parent -norequire, qw(Base); # remove `-norequire` if Base in different file

  sub new {
    my ($class) = @_;
    my $self = $class->SUPER::new;
    $self->{Name} = undef;
    $self;
  }

  sub Name :lvalue {
    my ($self) = @_;
    $self->{Name};
  }
  sub report {
    my ($self) = @_;
    "I am the Sub object ".($self->ID)." called ".($self->Name).".";
  }
}

=head1 Sub

A generic subclass. It subclasses Base.

=head2 $sub->Name [= SCALAR]

Gets or sets the name of $sub.

    my $oldname = $sub->Name;
    $sub->name = "new name";

=cut 
```

如您所见，`Sub`构造函数调用`Base`初始化程序，然后添加一个新字段。它没有类方法或类变量。该类无法访问该`$count`变量，除非通过访问器类方法。合同通过 POD 文档说明。

（在该`Name`方法中，我使用了`:lvalue`注解。这使我可以简单地分配给对象中的适当字段。但是，这不允许检查参数。）

测试用例

```
my $base1 = Base->new; my $base2 = Base->new;
print "There are now " . Base->Count . " Base objects\n";
my $sub1 = Sub->new;   my $sub2 = Sub->new;
print "There are now " . Base->Count . " Base objects\n";

$sub2->Name = "Fred";

print $_->report . "\n" for ($base1, $sub1, $base2, $sub2); 
```

印刷

```
There are now 2 Base objects
There are now 4 Base objects
I am the Base object 0.
I am the Sub object 2 called .
I am the Base object 1.
I am the Sub object 3 called Fred. 
```

漂亮，不是吗？（除了`$sub1`，那个对象没有它的名字。）

可以使用 来查看文档`perldoc -F FILENAME`，并会输出类似

```
Base
       A generic base class

   Base->Count
       Return the object count.

   $base->ID
       Give the unique ID of this object.

   $base->report
       Returns a string containing a short description.

Sub
       A generic subclass. It subclasses Base.

   $sub->Name [= SCALAR]
       Gets or sets the name of $sub.

           my $oldname = $sub->Name;
           $sub->name = "new name"; 
```

只有在 *nix 系统上才能更好地排版。

在 v5.12.4 下测试。

## 编辑：由内而外的对象

虽然由内而外的对象提供了更好的封装，但它们并不是一个好主意：难以理解、难以调试和难以继承，它们提供的问题多于解决方案。

```
{
   package Base;
   my $count = 0;
   sub new    { bless \do{my $o = $count++}, shift }
   sub Count  { $count }
   sub ID     { ${+shift} }
   sub report { my ($self) = @_; "I am the Base object ".($self->ID)."." }
}
{
   package Sub;
   my @_obj = ();
   my $count = 0;
   sub new    {
     my ($class) = @_;
     $count++;
     $_obj[$count - 1] = +{
       parent => Base->new(),
       Name   => undef,
     };
     bless \do{my $o = $count - 1}, shift;
   }
   sub Name :lvalue { $_obj[${+shift}]{Name} }
   sub AUTOLOAD {
     my $self = shift;
     my $package = __PACKAGE__ . "::";
     (my $meth = $AUTOLOAD) =~ s/^$package//;
     $_obj[$$self]{parent}->$meth(@_)
   }
   sub report {
     my ($self) = @_;
     "I am the Sub object ".($self->ID)." called ".($self->Name).".";
   }
} 
```

此实现具有完全相同的接口，并以相同的输出完成测试用例。这个解决方案远非最佳，只支持单继承，做一些中间的事情（自动加载，动态方法调用），但它确实工作得令人惊讶。每个对象实际上只是对 ID 的引用，可用于查找包含字段的实际散列。无法从外部访问保存散列的数组。该类`Base`没有字段，因此不必创建对象数组。

## Edit2：对象作为代码引用

另一个坏主意，但编写代码很有趣：

```
{
    package Base;
    my $count = 0;
    sub new {
        my ($class) = @_;
        my $id = $count++;
        bless sub {
            my ($field) = @_;
            die "Undefined field name" unless defined $field;
            if ($field eq "ID") { return $id }
            else                { die "Unrecognised name $field" }
        }, $class;
    }
    sub Count  { $count }
    sub ID     { my ($self) = @_; $self->("ID") }
    sub report { my ($self) = @_; "I am the Base object " . $self->ID . "." }
}
{
    package Sub;
    use parent -norequire, qw(Base);
    sub new {
        my ($class) = @_;
        my $name = undef;
        my $super = $class->SUPER::new;
        bless sub {
            my ($field, $val ) = @_;
            die "Undefined field name" unless defined $field;
            if ($field eq "Name") { defined $val ? $name = $val : $name }
            else                  { $super->(@_) }
        }, $class;
    }
    sub Name { my $self = shift; $self->("Name", @_) }
    sub report {
        my ($self) = @_;
        "I am the Sub object ".($self->ID)." called ".($self->Name).".";
    }
} 
```

测试用例必须适应`$sub2->Name("Fred")`，并相应更新文档，因为我们不能在这里安全地使用左值注释。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-07T22:38:38.030

引用[`perldoc perlmodlib`](http://perldoc.perl.org/5.8.8/perlmodlib.html)，“Perl 不会像您在 C++、Ada 或 Modula-17 等其他语言中习惯的那样强制执行其模块的私有和公共部分。Perl 并不迷恋强制隐私。它更喜欢这样你离开它的客厅是因为你没有被邀请，而不是因为它有猎枪。”

Perl 中的标准约定是将所有内容放`$self`入哈希中并使用下划线前缀来指示哪些项目应被视为私有项目......然后信任该类的用户尊重该指示。同样的约定也适用于方法。如果您使用我的一个模块并且您选择偷看并`$self`直接修改或调用的内容`$obj->_some_private_method`，那么您将陷入困境并且可能会破坏某些东西，或者在此版本中正常工作的内容可能会在您升级时破坏到下一个版本；如果发生这种情况，您可以保留这两部分。

如果你要坚持让课堂之外的任何人都无法访问数据，有办法做到这一点，但是 a) 它们增加了复杂性，这在几乎所有情况下都是不必要的，并且 b) 正如你已经看到的，他们倾向于使继承变得更加麻烦。

那么，我的问题是，您实际上想要完成什么，为什么您觉得有必要让您的对象数据 Sooper-Sekret 并且完全无法访问？这样做你会获得什么好处，而不是简单地标记你认为应该被视为私人的事情，然后信任其他人不要管他们（除非他们有充分的理由不这样做）？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-07T21:23:13.137

首先，我不确定您所说的“对用户隐藏”到底是什么意思，但看起来您可能正在寻找包作用域变量（[our](http://perldoc.perl.org/functions/our.html)）与实例作用域。

```
package MyBaseClass;
use warnings;
use strict;

our $counter = 0;
sub new { 
    my $class = shift;
    $counter++;
    return bless {}, $class;
}
sub howManyInstances {
    return $counter;
}
1; 
```

关于你的第二个问题，我不确定闭包与继承有什么关系。这是一个简单的子类：

```
package MySubClass;
use warnings;
use strict;
use parent 'MyBaseClass';  # use parent schema, don't mess with @ISA
sub new {
    my $class = shift;
    my $self = $class->SUPER::new(@_);
    $self->{_name} = undef;  
    return $self;
}
# Your setter/getter looks ok as is, though lowercase is tradional for methods/subs
1; 
```

现在，如果这是真正的代码，你不会这样做——你会使用[Moo](https://metacpan.org/module/Moo)或[Moose](https://metacpan.org/module/Moose)。

# .net - 将 2 个不同类型的 IEnumerable 与通用接口相结合

> ID：13770249
> 
> 赞同：3
> 
> 时间：2012-12-07T20:06:31.443
> 
> 标签：.net, vb.net

我已经创建了这个接口来用作其他 2 个集合的组合集合。

我的两个对象（`ourCars`和`ourTrucks`）都包含有关我的汽车收藏和卡车收藏的信息。

但是字段不一样，所以我想创建一个新集合来将两者结合起来。

```
Private Interface carTruckCombo
    Property ID As String  
    Property make As String 
    Property model As String 
End Interface

Dim cars As IEnumerable(Of ourCars) = Enumerable.Empty(Of ourCars)()
Dim trucks As IEnumerable(Of ourTrucks) = Enumerable.Empty(Of ourTrucks)() 
```

现在这是我卡住的地方......我现在该怎么办？

```
Dim combinedResults As IEnumerable(Of carTruckCombo) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:13:28.787

首先，您需要确保您的`ourCars`和`ourTrucks`类型都**实现**了新`carTruckCombo`类型。完成后，您可以使用如下代码：

```
Dim combinedResults = cars.Cast(Of carTruckCombo).Concat(trucks.Cast(Of carTruckCombo)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T20:11:59.627

```
var combinedResults  = 
    cars.Select(c=>new carTruckCombo{ID=c.ID,make=c.make,model=c.model})
    .Union(tracks.Select(t=>new carTruckCombo{ID=t.ID,make=t.make,model=t.model})); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:10:27.937

您可以使用该`Concat`方法，**但是（请在否决之前阅读:)）**您正在尝试将 2 个单独的类型组合到一个集合中，除非它们都继承自同一个基类，否则您不能执行 Concat。

您可能会考虑创建一个名为的基类`Vehicle`，然后从该类派生`ourCars`和派生。`ourTrucks`

否则，您必须使用一种`Select`方法将两个集合转换为相同的类型。

C＃：

```
combinedResults =  cars.Concat(trucks); 
```

# powershell - get-childItem 的新-file 参数是像-filter 一样快还是像-include 一样慢？

> ID：13770262
> 
> 赞同：0
> 
> 时间：2012-12-07T20:07:41.197
> 
> 标签：powershell, filter, powershell-3.0, get-childitem

***编辑**希望在这里澄清我令人费解和误导性的问题......基于我错误的假设 -file 接受输入。感谢您直截了当地指出这只是一个开关参数；我的示例中的输入实际上被传递给 -path。听起来这可能是搜索多种文件类型的最快的纯 powershell 方法，因为 -filter 只接受单个输入，而 -include 速度较慢。*

get-childItem[文档](http://technet.microsoft.com/en-us/library/hh849800.aspx)说“过滤器比其他参数更有效，因为提供程序在检索对象时应用它们，而不是让 Windows PowerShell 在检索对象后对其进行过滤。”

v3 有一个带有 -file 参数的[新参数集](http://technet.microsoft.com/en-us/library/hh847897.aspx)，可能是为了排除目录，以匹配 cmd.exe 的`dir /a:-d`

与 -include 一样，与 -filter 不同，-file 接受多个，如`gci -file "*.ldf","*.bak"`

所以我想知道，并且迄今为止未能可靠地测试，如果 -file 从性能角度来看就像 -filter，即“更有效”，或者更像是像 -include 这样的“其他参数”。如果 -file 是一个过滤器，那很好，因为 afaict -filter 一次只处理一个过滤器，所以如果您想要多个过滤器（如 *.ldf 和 *.bak），那么您需要运行`gci -filter`两次或使用 -include 代替。所以我想知道 -file 是否可以让我们为多个过滤器获得过滤器的效率优势。

我偶然发现了一些让我乐观的错误文本。-file 参数希望 -path 成为当前目录，因此`gci -path $path -file "*.bak","*.ldf"`会出错。Push-location 似乎是一种可行的解决方法，但在这里我对错误文本的内容更感兴趣：

*Get-ChildItem：无法将“System.Object[]”转换为参数“Filter”所需的类型“System.String”。不支持指定的方法。*

我调用了-file，但错误抱怨“参数'过滤器'”。所以也许 -file 像过滤器一样有效？OTOH，-filter 不需要 -path 是当前目录，因此在这方面 -file 更像 -include。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:38:37.780

只有一种精度：

```
gci -path $path -file "*.bak","*.ldf" 
```

`-file` is a `switch parameter` (as `-directory` is) and doesn't accept values (To get only files, use the File parameter and omit the Directory parameter. To exclude files, use the Directory parameter and omit the File parameter); then the `"*.bak","*.ldf"` are implicitly passed to `-filter` as value, and `filter` accept only `string` and not `string[]`. That's where your error came from.

Regarding performance: using `-file` or `-directory` is faster than using a `where-object psiscontainer` or `? { !$_.psiscontainer}` because it's done at provider (filesystem in this case) level.

# c++ - OpenGL Renderer 类设计：灵活简单？

> ID：13770263
> 
> 赞同：1
> 
> 时间：2012-12-07T20:08:07.967
> 
> 标签：c++, renderer, opengl-3

我正在为 OpenGL 3.1 设计一个渲染系统（目前仅限于 2D）。我想做的是真正考虑优雅的设计模式，这样我就不必担心一些维护和调试很痛苦的乱七八糟的东西。

起初，我的想法类似于有一个模板化的基类，它带有接受不同类型名作为参数的函数。然后子类将从基类继承，在派生时发送它们将使用的类型作为模板参数。

[然后我发现这基本上是不可能](https://stackoverflow.com/a/3255804/763053)的。

所以，我有点卡住了，我应该如何正确地设计这个而不只是把东西弄掉。问题是我正在使用我自己的顶点结构，它围绕`glm`向量类，所以我可以在一个结构中拥有顶点对，并在调用`glVertexAttribPointer()`.

换句话说，

```
typedef struct colorVertex_d
{
    glm::vec3 Position;
    glm::vec4 Color;
}
colorVertex_t;

typedef struct textureVertex_d
{
    glm::vec3 Position;
    glm::vec2 UV;
}
textureVertex_t; 
```

理想情况下，我想做的是将可用于此渲染器的实际类型限制为已定义的顶点类型。

我认为这样做的一种方法是按照 this 的方式做一些事情[，](http://www.parashift.com/c++-faq/template-specialization.html)然后如果发送给类的类型无效，则调用 Shutdown 方法（有点像异常，只是不是异常......）。

尽管如此，我什至不确定在这种情况下这是否可以被认为是一个好的实现。

我真正在寻找的是一种方法，它可以支持多种缓冲区类型（例如顶点、索引、法线、颜色等），这些缓冲区类型符合上面显示的顶点结构等类型。

**原始来源**

```
/**
  * Is an abstract class to inherit from for defining custom buffer handler classes,
  * the type name specified is the type of data stored in the buffer specifically, e.g. textureVertex_t or colorVertex_t
  */

template < typename DataT, typename ContainerT >
class RenderBuffer
{
public:
    enum RenderMethod
    {
        Stream,             // used for writing data into the buffer once per render
        Dynamic,            // values in the buffer are changed from time to time
        Static              // data is set only once, then rendered as many times as it needs to be
    };

    enum DrawMode
    {
        Triangle,
        TriangleStrip,
        Line,
        LineStrip
    };

    enum BufSetType
    {
        Alloc,
        Update
    };

    RenderBuffer( RenderMethod rm, DrawMode dm )
    {
        switch( rm )
        {
        case Stream:    mRenderMethod = GL_STREAM_DRAW;     break;
        case Dynamic:   mRenderMethod = GL_DYNAMIC_DRAW;    break;
        case Static:    mRenderMethod = GL_STATIC_DRAW;     break;
        }

        switch( dm )
        {
        case Triangle:      mDrawMode = GL_TRIANGLES;       break;
        case TriangleStrip: mDrawMode = GL_TRIANGLE_STRIP;  break;
        case Line:          mDrawMode = GL_LINES;           break;
        case LineStrip:     mDrawMode = GL_LINE_STRIP;      break;
        }
    }

    virtual ~RenderBuffer( void )
    {
    }

    virtual void Reserve( size_t sz ) = 0; // Reserve space for whatever container used to store the buffer data.

    virtual void Bind( void ) const = 0;

    virtual void UnBind( void ) const = 0;

    template < typename DataT, ContainerT >
    virtual void SetBufferData( const ShaderProgram& program, const ContainerT& data, BufSetType m )
    {
    }

    template < typename DataT, ContainerT >
    virtual void SetBufferData( const ShaderProgram& program, const DataT* data, const size_t len, BufSetType m )
    {
    }

    virtual void Render( void ) const = 0;

    size_t VertexCount;

protected:
    GLenum mDrawMode, mRenderMethod;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T20:25:18.700

我打了一堆东西，但我仍然不确定你的目标或问题是什么。您似乎正在尝试创建*一个*对象来封装 OpenGL 可以做的所有事情。我的第一个建议是不要这样做。

我建议一个 Mesh 类，它包含一个 VAO 和一个程序并且知道如何渲染自己：

```
glUseProgram(mProgramID);
glBindVertexArray(mVAO);
glDrawArrays(mDrawMode, 0, mNumPrimitives); 
```

我认为这就是你想要达到的目标。

我建议使用子类，而不是所有东西的模板。设置一个有很多工作（以及可能的不同子类、参数化函数或重载），但是一旦设置好，渲​​染就很简单了。

如果您对使用模板一无所知，那么模板专业化可能会帮助您弥合差距。但是我在这里并没有真正看到模板的好用处。感觉就像你正试图把它们硬塞进去。

# .htaccess - 使用 Mod_Rewrite 重建目录

> ID：13770267
> 
> 赞同：-1
> 
> 时间：2012-12-07T20:08:17.047
> 
> 标签：.htaccess, mod-rewrite

我确信这很简单，但无论我做什么，我似乎都破坏了我的文件。话虽如此，我想做的是使用 mod_rewrite 来建立一个双语网站。我将使用 $_Get 来定义语言。然后，我计划使用 mod_rewrite 来使 SEO 更加友好。因此，不是每个页面都像这样：[http](http://www.shiningashes.net/index.php?lg=en) ://www.shiningashes.net/index.php?lg=en或[http://www.shiningashes.net/support.php?lg=en](http://www.shiningashes.net/support.php?lg=en)我希望网站成为像[http://www.shiningashes.net/en/support](http://www.shiningashes.net/en/support)。那么我怎样才能让 mod rewrite 将 url 分解成块并重建它呢？（http://www.*根域*/*语言*/*文件目录名*）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:20:52.817

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^([A-Z]{2})/(.+)$ $2.php?lg=$1 [QSA,L,NC]

#EXternal redirect /support.php?lg=en from to /en/support
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+([^.]+)\.php\?lg=([^\s&]+) [NC]
RewriteRule ^ /%2/%1? [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:25:34.560

```
RewriteRule  ^/([a-z]+)/(.*)$ /$2.php?lg=$1 
```

这应该重写`http://www.shiningashes.net/en/support`为`http://shiningashes.net/support.php?lg=en`

优秀的文档在这里： [http ://httpd.apache.org/docs/current/rewrite/intro.html](http://httpd.apache.org/docs/current/rewrite/intro.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:15:23.497

假设您只有在指定语言时才会有两个字母的一级目录，那么以下应该可以工作：

```
RewriteEngine on
RewriteBase /
RewriteRule ([A-Za-z]{2})/(.*) $2?lg=$1 [QSA, L] 
```

# spring - 休眠。在jsp上获取惰性集合大小

> ID：13770271
> 
> 赞同：0
> 
> 时间：2012-12-07T20:08:24.520
> 
> 标签：spring, hibernate, spring-mvc, lazy-loading, open-session-in-view

我正在使用`Spring MVC`with`OpenSessionInViewFilter`并试图找到在 jsp 上获取惰性集合大小的最佳实践（不加载集合和`LazyInitializationException`）。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:26:12.127

要么使用专门的 HQL 查询来计算集合中的元素，要么使用[额外的延迟获取](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#performance-fetching)，这可以使用`@LazyCollection`注释来启用。

# sphinx - 用 Sphinx 搜索

> ID：13770274
> 
> 赞同：1
> 
> 时间：2012-12-07T20:08:45.677
> 
> 标签：sphinx

我陷入了僵局，可能有一个简单的解决方案，但我看不到它。我已经完成了 Sphinx 文档中的所有内容，直到[Quick Tour](http://sphinxsearch.com/docs/2.0.6/quick-tour.html)为止，但是当我在 PuTTy 中使用 test.php 测试搜索时，它返回零结果。

我已经在 sphinx.conf 中输入了所有正确的数据库信息，并且我已经组装了 SQL 查询。我根本没有收到任何错误，只是说每次搜索时它都会返回 0 个结果。

它在查看我的数据库吗？如果您需要查看任何代码，请告诉我。searchd 正在运行（据我所知）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T08:17:35.040

确保 indexer --all 显示它找到并索引了实际文档。

除了 API 之外，还有另一种使用 SphinxQL 测试 sphinx 的便捷方法

[如http://astellar.com/2011/12/replacing-mysql-full-text-search-with-sphinx/](http://astellar.com/2011/12/replacing-mysql-full-text-search-with-sphinx/)中所述，在 sphinx.conf 的 searchd 部分中添加行“listen = 9306:mysql41”行并启动守护程序.

然后运行

```
mysql -h0 -P 9306 
```

然后对 sphinx 发起查询

```
SELECT * FROM <your_sphinx_index>; 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T19:05:38.693

狮身人面像有 2 个不同的阶段：

1) 索引

2) 搜索

我相信您的问题是您错误地跳过了需要索引数据（运行索引器）的部分，因此搜索将有数据要搜索。在索引部分 sphinx 将从您的数据库中获取所有数据，并且搜索实际上将搜索该数据而不是您的数据库。

# objective-c - 有没有办法在 Objective-C 中获取属性的类型？

> ID：13770280
> 
> 赞同：1
> 
> 时间：2012-12-07T20:10:14.910
> 
> 标签：objective-c, ios, xcode

> **可能重复：**
> [如何在 Objective-C 中检测属性返回类型](https://stackoverflow.com/questions/769319/how-to-detect-a-property-return-type-in-objective-c)

有没有办法在 Objective-C 中获取属性的类型？我可以像这样访问该属性：

```
objc_property_t* properties = class_copyPropertyList(cl, &count); 
```

并得到这样的名字：

```
property_getName(properties[i]); 
```

我需要做的是获取类型。此外，在大多数情况下，价值将是`nil`，所以我不能只得到价值调用`object_getClass()`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T23:02:29.567

不是你想问的——在 Objective-C 中，类是无类型的；当处理“它是一个类”之外的非 C 类型时，属性的类型在运行时是未知的。这就是为什么如果你在视图控制器中做如下愚蠢的事情：

```
[self setValue:@3 forKey:@"view"]; 
```

当控制器尝试向`NSNumber`而不是通过键值编码机制发送视图消息时，您将看到引发异常，因为您试图将不是视图的内容放入不适当的属性中。

解析`property_getAttributes`只允许您将各种 C 文字类型与 Objective-C 对象类型区分开来。

# webobjects - 如何编译 webobject apache 适配器？

> ID：13770281
> 
> 赞同：1
> 
> 时间：2012-12-07T20:10:20.480
> 
> 标签：webobjects, adaptor

我按照以下链接的说明进行操作。

[http://www.rdbprime.com/Documentation/WebObjects/Deployment/Deploying_Applications/Installation/Building_the_Adaptors.html](http://www.rdbprime.com/Documentation/WebObjects/Deployment/Deploying_Applications/Installation/Building_the_Adaptors.html)

但是在编译 Apache Adaptor 时出现以下错误。

```
c: not found  
make[1]: [mod_WebObjects.so] Error 2 (ignored)  
strip  mod_WebObjects.so  
strip: not found  
make[1]: *** [mod_WebObjects.so] Error 2  
make: *** [Apache] Error 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T07:43:08.087

您提供的文档很旧，您确定不要构建这么旧的适配器吗？WebObjects 很久以前就转移到了 Java，从那时起 Adapter 发生了很大变化。

例如，您可以在此处找到有关为 Linux 编译它的当前信息：

[http://wiki.wocommunity.org/display/documentation/Compiling+the+HTTP+adaptor+on+Linux](http://wiki.wocommunity.org/display/documentation/Compiling+the+HTTP+adaptor+on+Linux)

# html - HTML5 Canvas 移动 TiledMap 背景

> ID：13770283
> 
> 赞同：0
> 
> 时间：2012-12-07T20:10:32.433
> 
> 标签：html, canvas, path-finding

一开始，对不起我的英语:(

我对画布元素很感兴趣，我正在尝试制作一个游戏浏览器，但我无法解决这个问题。

1.  我得到二维数组中的地图图块。

2.  我得到了位置播放器，我翻译了上下文（将其绘制在画布的中心），然后考虑到地图中的绝对位置，我重新绘制了地图。但是当我移动播放器时，地图会在大约 1 秒后消失（我认为是 clearRect 画布）并且在地图出现之后。

所以，我的问题是这个令人讨厌的第二个画布是黑色的。

编码。

```
function pinta(){
    var mirror = renderToCanvas(canvas.width, canvas.height, function (ctx) {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    //antes de pintar debemos calcular la traslacion
    ////////////////////////////////////////////////
        var moverX=canvas.width/2-players[yo].x;
        var moverY=canvas.height/2-players[yo].y;
        ctx.translate(moverX,moverY);
        pinta_terreno();
        pinta_players();

    function pinta_players()
    {
        for( var player in players ) {
            var i=player,
            x=players[i].x;
            y=players[i].y;
            var img=new Image(25,25);
            if(i==2)img.src="/img/player2.png";
            else img.src="/img/player1.png";
            ctx.drawImage(img,x,y);
        }
    }   

    function pinta_terreno()
    {
        // donde estoy en tiles
        var min_x=(-canvas.width+players[yo].x)/TAM_TILE;
        var max_x=(canvas.width+players[yo].x)/TAM_TILE;
        var min_y=(-canvas.width+players[yo].y)/TAM_TILE;
        var max_y=(canvas.width+players[yo].y)/TAM_TILE;
        ///////////////////////
            for(var i=min_x;i<=max_x;i++)
                    for(var j=min_y;j<=max_x;j++)
                    {
                            var x=i*TAM_TILE;
                            var y=j*TAM_TILE;

                            try
                            {
                                if(mapa[i][j]!=null && mapa[i][j]!="undefined")
                                {
                                    var terreno=new Image(25,25);
                                    terreno.src="/img/terrain/"+mapa[i][j]+".png";
                                    ctx.drawImage(terreno,x,y);
                                }
                            }catch(e)
                            {

                            }
                    } // del for(var j=0;j<(canvas.height/TAM_TILE);j++)

    } // del pintaterreno
}); 

context.clearRect(0,0,canvas.width,canvas.height);
context.drawImage(mirror, 0, 0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T17:15:57.773

我从来没有用画布做过动画（只有静态图），但我认为你应该回顾一些技巧（别担心，mi inglés tampoco es perfecto）。

*   首先是在代码中找出导致 1seg 滞后的确切函数：`console.log()`在调用`ctx.clearRect()`. 还有之前和之后`ctx.translate()`，`pinta_players()`和`pinta_terreno()`。最后一个是我的主要嫌疑人。
*   如果您在内部绘制整个可见区域，`pinta_terreno()`则不需要`ctx.clearRect()`在开头。`mirror()`
*   您可能希望为两个播放器和标题预加载和存储图像（当然，这取决于标题的数量），因此此步骤不在您的绘制函数中完成。这样你应该有`ctx.drawImage(player1,x,y);`而不是`ctx.drawImage(img,x,y);`和`ctx.drawImage(terreno[i,j],x,y);`而不是`ctx.drawImage(terreno,x,y);`。
*   另请注意，如果您`paint`在循环/计时器中调用该函数，那么您将清除画布两次！
*   这是我不明白的部分：您是否将函数传递给`context.drawImage()`函数？的第一个参数[`drawImage`](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#image-sources-for-2d-rendering-contexts)应该是图像、视频、画布或其他上下文。

# c# - 错误 - 字段初始值设定项无法引用非静态字段、方法或属性

> ID：13770287
> 
> 赞同：2
> 
> 时间：2012-12-07T20:11:03.773
> 
> 标签：c#, sql, sql-server-2008

今天开始学习C#编程中的SQL连接。我尝试了一些基本的东西，比如插入、删除等。

我想在另一个项目中尝试同样的事情，但我遇到了问题。因为它向我显示了一个我无法解决的错误:(

错误：

> 字段初始值设定项不能引用非静态字段、方法或属性“Artikujt.Form1.con”。

这是我的代码（我刚刚开始将它与 SQL 中的数据库连接起来）

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace Artikujt
{
    public partial class Form1 : Form
    {
        SqlConnection con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
        SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
        DataSet dsl = new DataSet();    

        public Form1()
        {
            InitializeComponent();
        }    
    }
} 
```

错误在此代码中的变量`con`

```
SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con); 
```

我在 SQL 中创建了数据库（在 Visual Studio 中）......我还添加了数据源。我做了我以前做过的事情......但它不起作用:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:15:34.853

错误正是它所说的。您不能`con`在初始化中使用它，`da`因为它只会在实例创建期间创建。您需要在构造函数中创建`con`或`static`放入初始化行。

**但是**，您可能不应该在实践中这样做，因为您只是要求某人打开 a`SqlConnection`并使其保持打开状态。您可能应该更多地使用`using`块创建连接以利用处置模式

静止的：

```
public partial class Form1 : Form
{
    static SqlConnection con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
    SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
    DataSet dsl = new DataSet();    

    public Form1()
    {
        InitializeComponent();
    } 
```

或在构造函数中实例化：

```
public partial class Form1 : Form
{
    SqlConnection con;
    SqlDataAdapter da;
    DataSet dsl;  

    public Form1()
    {
        InitializeComponent();
        con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
        da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
        dsl = new DataSet();  
    }
} 
```

我会让你[自己研究 using 块](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:14:34.400

您必须将初始化代码放入构造函数中：

```
public partial class Form1 : Form
{
            SqlConnection con = null; 
            SqlDataAdapter da = null; 
            DataSet dsl =  null;     

            public Form1()
            {
                InitializeComponent();
                con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
                 da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
                dsl = new DataSet();    
            }
} 
```

您不能在字段初始化程序中访问 c​​on ，`SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);`因为它不是静态的。该错误是不言自明的。这个问题与 SQL 无关，它与 C# 相关，我建议重新访问 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:18:26.210

您需要将此初始化移动到构造函数中。

```
SqlConnection con;
SqlDataAdapter da;
DataSet dsl;

public Form1()
{
    InitializeComponent();

    con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
    da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con)
    dsl = new DataSet();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-28T07:22:43.083

SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con); 在任何方法或事件中使用，例如下面的示例按钮事件

```
 using System;
       using System.Collections.Generic;
       using System.ComponentModel;
       using System.Data;
       using System.Drawing;
       using System.Linq;
       using System.Text;
       using System.Windows.Forms;
       using System.Data.SqlClient;

    namespace Artikujt
    {
 public partial class Form1 : Form
  {
     SqlConnection con = new SqlConnection(@"Data Source=TALY-PC;Initial              Catalog=Katalogi;Integrated Security=True;Pooling=False");

    DataSet dsl = new DataSet();    

    public Form1()
    {
SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
        InitializeComponent();
    }  

   private void button1_Click(object sender, EventArgs e)
     { SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM    tblArtikujt",           con);
     }  
} 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-05T11:05:56.203

```
static SqlConnection con = new SqlConnection(@"Data Source=TALY-PC;Initial Catalog=Katalogi;Integrated Security=True;Pooling=False");
SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM tblArtikujt", con);
DataSet dsl = new DataSet();

public Form1()
{
    InitializeComponent();
} 
```

# ios - 通过短信发送 iOS 应用程序的表单

> ID：13770290
> 
> 赞同：1
> 
> 时间：2012-12-07T20:11:17.310
> 
> 标签：ios, sms, saas

**是否有一项服务允许我在我的网站上放置一个表单，该表单会将指向我的 iOS 应用程序的链接发送给用户？**

1.  用户访问我的网站
2.  用户在字段中插入他们的手机号码
3.  用户收到一条带有下载我的应用程序链接的短信

这有意义吗？有没有更好的办法？我以前看过这个，但不记得在哪里...

目前人们真的只需要拿出自己的 iPhone，打开应用商店，搜索应用名称即可下载吗？

PS：在发布之前我搜索了谷歌和这个网站，但没有找到任何答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:29:40.867

不是您要查找的内容，但可能对您来说更容易做到：您可以创建一个二维码，其中包含指向您在 App Store 中的应用程序的链接。然后人们可以用他们的手机扫描它（有很多流行的应用程序可以做到这一点），当它打开 URL 时，用户将被重定向到应用商店。

只需将`https://itunes.apple.com/us/app/[...]`iTunesConnect 中的链接用于您的应用程序。

# c# - 创建包含相同名称的文档列表

> ID：13770293
> 
> 赞同：-1
> 
> 时间：2012-12-07T20:11:25.180
> 
> 标签：c#, .net

我正在创建一个应该连接包含相同名称的文档的工具。

示例：C_BA_20000_1.pdf 和 C_BA_20000_2.pdf 这些文件应归为一个列表。该工具在目录上运行可以说

```
//directory of pdf files
  DirectoryInfo dirInfo = new DirectoryInfo(@"C:\Users\derp\Desktop");

  FileInfo[] fileInfos = dirInfo.GetFiles("*.pdf"); 
```

foreach（fileInfos 中的 FileInfo 信息）

我想创建一个包含同名文件名的 ArrayList

```
ArrayList list = new ArrayList();
 list.Add(info.FullName); 
```

然后有一个包含类似文档的所有 ArrayLists 的列表。

```
 List<ArrayList> bigList = new List<ArrayList>(); 
```

所以我的问题是，如何对包含相同名称的文件进行分组并将它们放在同一个列表中。

**编辑：** 文件在其名称 AB_CDEFG_i 中具有相同的模式，其中 i 是一个数字，可以从 1 到 n。同名文件最后只能有不同的编号。

> AB_CDEFG_1
> 
> AB_CDEFG_2
> 
> HI_JKLM_1

输出应该是：

清单 1：AB_CDEFG_1 和 AB_CDEFG_2

清单 2：HI_JKLM_1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:15:43.763

创建提取文件名“相同”部分的方法。例如

```
public string GetRawName(string fileName)
{
    int index = fileName.LastIndexOf("_");
    return fileName.Substring(0, index);
} 
```

并使用此方法进行分组：

```
var bigList = Directory.EnumerateFiles(@"C:\Users\derp\Desktop", "*.pdf")
                       .GroupBy(file => GetRawName(file))
                       .Select(g => g.ToList())
                       .ToList(); 
```

这将返回`List<List<string>>`（不带`ArrayList`）。

**UPDATE**这是正则表达式，它适用于所有类型的文件，无论它们是否在末尾有数字

```
public string GetRawName(string file)
{
    string name = Path.GetFileNameWithoutExtension(file);
    return Regex.Replace(name, @"(_\d+)?$", "")
} 
```

分组：

```
var bigList = Directory.EnumerateFiles(@"C:\Users\derp\Desktop", "*.pdf")
                       .GroupBy(GetRawName)
                       .Select(g => g.ToList())
                       .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:14:21.113

除了您的问题没有确定“同名”的含义这一事实之外。这是一个典型的解决方案。

```
fileInfos.GroupBy ( f => f.FullName )
         .Select( grp =>  grp.ToList()  ).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T20:26:26.537

听起来困难在于确定哪些文件是相同的。

```
static string KeyFromFileName(string file)
{
   // Convert from "C_BA_20000_2" to "C_BA_20000"
   return file.Substring(0, file.LastIndexOf("_"));

   // Note: This assumes there is an _ in the filename.
} 
```

然后，您可以使用此 LINQ 构建文件集列表。

```
using System.Linq; // Near top of file

var files = Directory.GetFiles(@"C:\Users\derp\Desktop", "*.pdf")

var fileSets = files
   .Select(file => file.FullName)
   .GroupBy(KeyFromFileName)
   .Select(g => new {g.Key, Files = g.ToList()}
   .ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T20:47:14.713

这将为您提供列表列表...如果文件不包含下划线等，也不会引发异常。

```
private string GetKey(FileInfo fi)
{
    var index = fi.Name.LastIndexOf('_');
    return index == -1 ? Path.GetFileNameWithoutExtension(fi.Name) 
                       : fi.Name.Substring(0, index);
}

var bigList = fileInfos.GroupBy(GetKey)
             .Select(x => x.ToList())
             .ToList(); 
```

# java - 如何对单个指定的成员变量使用 compareTo()

> ID：13770295
> 
> 赞同：0
> 
> 时间：2012-12-07T20:11:36.810
> 
> 标签：java, compareto

请有人建议以下问题的最佳解决方案（这是我正在尝试编码的程序的一部分）：

我有一个带有成员变量的类 Foo 和另一个扩展 Foo 的类 Bar。Bar 添加了额外的成员变量。Bar 对象存储在一个集合中，因此我想通过它们的任何成员变量对这些对象进行排序。

我考虑使用枚举类型，其中包含可以作为参数传递给 compareTo() 方法的类的成员变量，但由于枚举类型是隐式静态的，我无法为 Bar 或任何其他可能扩展的类的成员变量添加参数我想比较的 Foo。例如，我想通过成员变量 'myVar' 比较两个 Bar 类，我会调用类似 bar1.compareTo(bar2, MyEnum.MYVAR) 的类，然后将这些类与它们的 myVar 值进行比较。我在想我可能只需要创建单独的方法来按每个成员变量排序，但想使用 compareTo()，因为 Java 集合使用它来自动对其项目进行排序（我相信）。

我可以清楚地描述这个问题，但我可能会以完全错误的方式实现这一目标。任何指针将不胜感激。

编辑 - 这与在 Windows 资源管理器窗口中按不同属性（即修改日期、文件名、大小等）对列进行排序的行为类似。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:17:03.713

你最好使用[Comparator](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)来封装这个特定的比较逻辑。您可以进行尽可能多的`Comparator`对象比较，或者按照建议，`Comparator`根据确定的字段进行比较。

如果您想拥有多个比较器或只有一个，这取决于您，但如果您想基于多个字段进行复杂的比较，我建议您为此创建一个特定的比较器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:13:13.060

使用继承实现 compareTo 是非常棘手的。你最好不要那样做。使用聚合，你就没有问题了：

```
class Bar {
  Foo foo;
  String barName;
  public getName() { return barName; }
} 
```

此外，如果您需要不同的比较器方法（例如升序降序，按属性），然后定义一个 Comparator ：（不幸。我没有打开 Eclipse，如果语法失败，请更正）

```
public class BarComparator implements Comparator<Bar> {

      @Override
      public int compare(Bar b1, Bar b2) {
        if (b1.getName() == null && b2.getName() == null) {
          return 0;
        }
        if (b1.getName() == null) {
          return 1;
        }
        if (b2.getName() == null) {
          return -1;
        }
        return b1.getName().compareTo(b2.getName());
      }
    } 
```

# c - 如何正确初始化 Raspberry？

> ID：13770296
> 
> 赞同：2
> 
> 时间：2012-12-07T20:11:45.273
> 
> 标签：c, assembly, arm, hardware, cross-compiling

我编写了一个电机控制器，并使用 Arch Arm Linux 发行版在一个 respberry pi 上进行了测试，计算出控制信号大约需要 0.4 毫秒，所以我认为如果我使用实时操作系统可以做得更好，所以我从 ChibiOS 开始，但是运行时间约为 2.5 毫秒，首先我使用 Crossfire 交叉编译器而不是切换到 linaro，而使用 linaro 的运行时间要差一些 ~ 2.7 毫秒。可能是什么问题？是否有可能我没有以最佳方式初始化硬件？

```
 /*
     * Stack pointers initialization.
     */
    ldr     r0, =__ram_end__
    /* Undefined */
    msr     CPSR_c, #MODE_UND | I_BIT | F_BIT
    mov     sp, r0
    ldr     r1, =__und_stack_size__
    sub     r0, r0, r1
    /* Abort */
    msr     CPSR_c, #MODE_ABT | I_BIT | F_BIT
    mov     sp, r0
    ldr     r1, =__abt_stack_size__
    sub     r0, r0, r1
    /* FIQ */
    msr     CPSR_c, #MODE_FIQ | I_BIT | F_BIT
    mov     sp, r0
    ldr     r1, =__fiq_stack_size__
    sub     r0, r0, r1
    /* IRQ */
    msr     CPSR_c, #MODE_IRQ | I_BIT | F_BIT
    mov     sp, r0
    ldr     r1, =__irq_stack_size__
    sub     r0, r0, r1
    /* Supervisor */
    msr     CPSR_c, #MODE_SVC | I_BIT | F_BIT
    mov     sp, r0
    ldr     r1, =__svc_stack_size__
    sub     r0, r0, r1
    /* System */
    msr     CPSR_c, #MODE_SYS | I_BIT | F_BIT
    mov     sp, r0

    mov r0,#0x8000
    mov r1,#0x0000
    ldmia r0!,{r2,r3,r4,r5,r6,r7,r8,r9}
    stmia r1!,{r2,r3,r4,r5,r6,r7,r8,r9}
    ldmia r0!,{r2,r3,r4,r5,r6,r7,r8,r9}
    stmia r1!,{r2,r3,r4,r5,r6,r7,r8,r9}

    ;@ enable fpu
    mrc p15, 0, r0, c1, c0, 2
    orr r0,r0,#0x300000 ;@ single precision
    orr r0,r0,#0xC00000 ;@ double precision
    mcr p15, 0, r0, c1, c0, 2
    mov r0,#0x40000000
    fmxr fpexc,r0
    mov     r0, #0
    ldr     r1, =_bss_start
    ldr     r2, =_bss_end 
```

和内存设置：

```
__und_stack_size__  = 0x0004;
__abt_stack_size__  = 0x0004;
__fiq_stack_size__  = 0x0010;
__irq_stack_size__  = 0x0080;
__svc_stack_size__  = 0x0004;
__sys_stack_size__  = 0x0400;
__stacks_total_size__   = __und_stack_size__ + __abt_stack_size__ + __fiq_stack_size__ + __irq_stack_size__ + __svc_stack_size__ + __sys_stack_size__;

MEMORY
{
    ram : org = 0x8000, len = 0x06000000 - 0x20
}

__ram_start__       = ORIGIN(ram);
__ram_size__        = LENGTH(ram);
__ram_end__     = __ram_start__ + __ram_size__;

SECTIONS
{
    . = 0;

    .text : ALIGN(16) SUBALIGN(16)
    {
        _text = .;
        KEEP(*(vectors))
        *(.text)
        *(.text.*)
        *(.rodata)
        *(.rodata.*)
        *(.glue_7t)
        *(.glue_7)
        *(.gcc*)
        *(.ctors)
        *(.dtors)
    } > ram

    .ARM.extab : {*(.ARM.extab* .gnu.linkonce.armextab.*)} > ram

    __exidx_start = .;
    .ARM.exidx : {*(.ARM.exidx* .gnu.linkonce.armexidx.*)} > ram
    __exidx_end = .;

    .eh_frame_hdr : {*(.eh_frame_hdr)}

    .eh_frame : ONLY_IF_RO {*(.eh_frame)}

    . = ALIGN(4);
    _etext = .;
    _textdata = _etext;

    .data :
    {
        _data = .;
        *(.data)
        . = ALIGN(4);
        *(.data.*)
        . = ALIGN(4);
        *(.ramtext)
        . = ALIGN(4);
        _edata = .;
    } > ram 

    .bss :
    {
        _bss_start = .;
        *(.bss)
        . = ALIGN(4);
        *(.bss.*)
        . = ALIGN(4);
        *(COMMON)
        . = ALIGN(4);
        _bss_end = .;
    } > ram    
}

PROVIDE(end = .);
_end = .;

__heap_base__              = _end;
__heap_end__               = __ram_end__ - __stacks_total_size__;
__main_thread_stack_base__ = __ram_end__ - __stacks_total_size__; 
```

我在哪里犯错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T14:34:39.190

很久以前（是的，这意味着在上个千年的某个时候），我使用旧的[PC 扬声器`pcsp`设备驱动程序（](http://linuxgazette.net/109/john.html)[这里](http://linux.1wt.eu/kernel/patches-2.4.18-wt6/patch-pcsp-soundcore-2.4.19pre2.diff)有一点当前的补丁）通过连接到并行端口数据线的继电器来控制步进电机。
请注意，这*与*当前`pcspkr`驱动程序不同（仅写入*实际*扬声器，而不写入并行端口）；具有并行输出功能的部分`pcsp`从未移植到 2.6 音频架构。

诀窍是驱动程序可以注册一个（高优先级，如果需要）中断例程，该例程执行实际的设备寄存器/IO端口写入以更改线路状态。因此，您只需`ioctl()`将采样率发送到驱动程序，然后异步写入在内存中创建的“斜坡”（数据信号以升/降到/从某个速度或执行多个步骤）-然后驱动程序将为您假脱机，无需额外的时间/调度敏感代码。

最后，您在并行端口数据引脚上获得了一个 8 位数字信号，其时序精度与您的定时器中断允许的一样高。
有足够的线来驱动步进器；如果你想让它变成给定的步数，你必须：

*   创建一个“加速”以将其从静止加速到最快
*   创建一个“矩形波”以使其保持转动
*   创建一个“减速”以使其再次减速

如果步数很少，一口气写完整个东西，否则，写斜坡，然后根据需要写尽可能多的矩形波块，然后斜坡下降。尽管您可能一次编写了数千个步骤，但您只需要编写三个内存块，每个块只有几 kB，其余的由驱动程序的中断处理程序完成。

如果你连接了一个电阻阵列 DAC 转换器，这听起来很有趣；-)

该方法可以推广到 RaspPI；从中断例程中，只需编写一个 GPIO 控制寄存器（在 ARM 上，设备寄存器始终是内存映射的，所以它只是一个内存访问）。

将“斜坡”/“控制信号”的生成与时序敏感的状态变化（实际上是“控制信号应用”）分离，并将后者委托给设备驱动程序的中断部分，可以“正常”执行此类任务Linux。

同样，您的计时精度受到计时器中断的速率和抖动的限制。RaspPI 能够运行比 i386 更高的定时器中断率。我很确定 1ms 对这种方法来说不是挑战（它不是在 1995 年）。如上所述，该方法取决于*预先创建*信号的能力。

# javascript - 如何将客户端 .STL 文件加载到 three.js 场景中，而不是从服务器加载？

> ID：13770297
> 
> 赞同：1
> 
> 时间：2012-12-07T20:11:51.633
> 
> 标签：javascript, html, 3d, webgl, three.js

我有一个“选择文件”按钮，我想用它来加载客户端文件，而不是从第 86 行的 loader.load() 中的服务器路径加载。我猜我需要使用 File API，但还没有想到看看这个[解决方案](https://stackoverflow.com/questions/9753015/)后如何。

**在第 86 行从服务器路径加载文件的现有网页：**

```
<!DOCTYPE html>
<html>
<head>
    <style>
    body        {
            background-color:#fea47c;
                }

    div         { 
            position:relative;
            left:200px;           
            top:0px;
            background-color: #eeeeee;
            border:1px solid black;             
            width:550px;
            height:550px;
                }

    canvas      {
            width:550px;
            height:550px;
                }

    input#file      
                {
            position:relative;left:425px;
                }

    </style>
</head>

<body>

<input type="file" name="file" id="file"></input><br><br>   

    <script src="https://raw.github.com/mrdoob/three.js/master/build/three.min.js"></script>

    <script src="https://raw.github.com/mrdoob/three.js/master/examples/js/loaders/STLLoader.js"></script>

    <script src="https://raw.github.com/mrdoob/three.js/master/examples/js/controls/TrackballControls.js"></script>

    <script>            
        var container, camera, scene, renderer, controls;

        init();
        animate();

        function init() {

            container = document.createElement( 'div' );
            document.body.appendChild( container );

            var width = container.clientWidth;
            var height = container.clientHeight;

            camera = new THREE.PerspectiveCamera(

            35,                                     // field of view in degrees?
            width / height,                         // canvas based aspect ratio; use when canvas is smaller than page
            .1  ,                                   // distance to nearest side of rendered space
            10000                                   // distance to farthest side of rendered space
                                                );

            camera.position.set( 0, 0, 10);

            scene = new THREE.Scene();

            controls = new THREE.TrackballControls( camera , container); 
            controls.addEventListener( 'change', render );

            // object

            var loader = new THREE.STLLoader();
            loader.addEventListener( 'load', function ( event ) {

                var geometry = event.content;

                var material = new THREE.MeshLambertMaterial( { ambient: 0xff5533, color: 0xff5533 } );

                var mesh = new THREE.Mesh( geometry, material );

                scene.add( mesh );

            } );

            loader.load( 'path to .stl file on server usually goes here' );

            // lights

            scene.add( new THREE.AmbientLight( 0x222222 ) );

            var directionalLight = new THREE.DirectionalLight( 0xffffff, 1 );
            directionalLight.position = camera.position;
            scene.add( directionalLight );

            // renderer

            renderer = new THREE.WebGLRenderer( { antialias: true } );
            renderer.setSize( width , height );
            container.appendChild( renderer.domElement );

            window.addEventListener( 'resize', onWindowResize, false );

        }

        function addLight( x, y, z, color, intensity ) {

            var directionalLight = new THREE.DirectionalLight( color, intensity );
            directionalLight.position.set( x, y, z )
            scene.add( directionalLight );

        }

       function onWindowResize() {   

            camera.aspect = width / height;
            camera.updateProjectionMatrix();

            renderer.setSize( width, height );
        }

        function animate() {

            requestAnimationFrame( animate );
            controls.update();
            render();

        }

       function render() {

           camera.lookAt( scene.position );
           renderer.render( scene, camera );

       }
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T03:47:26.083

脚本在服务器上吗？通常，Web 浏览器不允许 file:// 引用，除非页面本身是 file:// 引用（即使这样，您可能需要设置一些安全/调试标志，根据浏览器而有所不同）。因此，如果您在通过 http:// 访问的页面中运行 webgl 脚本，除非您通过诸如 dropbox 之类的文件服务捎带，否则您可能会很不走运。

# objective-c - UITextView 没有正确调整大小

> ID：13770300
> 
> 赞同：0
> 
> 时间：2012-12-07T20:11:59.173
> 
> 标签：objective-c, ios, xcode, uitextview

我有一个视图，顶部有一个表格视图，表格视图下方有一个滚动视图。当我按下调整大小栏按钮项时，我想隐藏表格视图并最大化滚动视图。我让滚动视图和表格视图正确设置动画，但我正在尝试调整`UITextView`滚动视图内部的大小以利用额外的屏幕空间。

每当我计算调整大小时，`UITextView`都会转到屏幕的左上角，我不知道为什么。我什至没有修改 X 和 Y，只是高度。

```
CGRect newDesFrame = descriptionTextView.bounds;
newDesFrame.size.height = newDesFrame.size.height + tableViewFrame.size.height;
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:.5];

self.scrollView.frame = scrollFrame;
self.descriptionTextView.frame = newDesFrame;

[UIView commitAnimations]; 
```

我不确定为什么会这样。因为它在里面，所以`descriptionTextView.bounds`会搞砸吗？似乎，当我对滚动视图的 X 和 Y 进行 NSLog 时，它是 0,0。这很奇怪，因为它不在超级视图或视图中的 0,0 处。我该如何解决？`UIView``UIScrollView`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:18:48.050

发生这种情况是因为您正在执行 self.descriptionTextView.frame=newDesFrame （这是 Bounds 属性，而不是框架！要了解差异[链接](https://stackoverflow.com/questions/5361369/ios-programming-frame-bounds-and-center)）

解决方案：

self.descriptionTextView.bounds=newDesFrame

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:20:10.143

descriptionTextView 最有可能跳到左上角，因为实际上您正在更改原点（x 和 y）。你开始：

```
CGRect newDesFrame = descriptionTextView.bounds; 
```

获取该文本视图的边界将为您提供一个原点为 0,0 的 CGRect，因为“边界”为您提供了视图在其自己的局部坐标空间中的矩形。

试试这个：

```
CGRect newDesFrame = descriptionTextView.frame; 
```

这将在其父视图的坐标空间中为您提供视图的矩形，包括实际原点。

# java - 使用文件浏览器获取文本文件并通过 JAVA 读取

> ID：13770302
> 
> 赞同：-5
> 
> 时间：2012-12-07T20:12:01.980
> 
> 标签：java, file, browser, text

我是 Java 新手。我需要使用文件浏览器确定文本文件的位置，然后使用 Java 读取其内容。那么，我怎么能这样做呢？非常感谢，问候，阿雅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:18:55.047

我建议你从这样的教程开始：

[http://docs.oracle.com/javase/tutorial/uiswing/components/filechooser.html](http://docs.oracle.com/javase/tutorial/uiswing/components/filechooser.html)

选择要阅读的文件后，您需要阅读它。在 Java 中有很多方法可以做到这一点。我最喜欢的方法是使用库。我建议谷歌番石榴。使用该库，您可以编写以下代码：

```
List<String> fileContents = Files.readLines(File file, Charsets.UTF8); 
```

我希望这有帮助。

# f# - F# NLog 配置文件

> ID：13770303
> 
> 赞同：6
> 
> 时间：2012-12-07T20:12:05.087
> 
> 标签：f#, xsd, config, nlog

我正在尝试在 F# 控制台应用程序中使用 NLog，我已经设法使用 App.config 中的配置部分使其工作，但是我无法使用独立的 NLog.config 文件使其工作。我的 NLog.config 文件位于应用程序路由中，就在 App.config 下，内容为：

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" throwExceptions="true">
    <targets>
        <target name="stdFile" xsi:type="File" fileName="c:/temp/compliant.log"/>
        <target name="display" xsi:type="OutputDebugString"/>
    </targets>
    <rules>
        <logger name="compliant.mail.*" minlevel="Debug" writeTo="stdFile,display" />
    </rules>
</nlog> 
```

我究竟做错了什么？

此外，即使我包含了 xsd，智能感知也不适用于 xml。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:29:22.777

在您的项目中，在 NLog.config 的属性中，您是否将 NLog.config 标记为“始终复制”？

# r - 在脚本中使用 setwd() 的风险？

> ID：13770304
> 
> 赞同：26
> 
> 时间：2012-12-07T20:12:08.363
> 
> 标签：r, setwd

我听说它说`setwd()`在脚本中使用是不好的做法。

*   与之相关的风险/危险是什么？
*   有什么更好的选择？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-07T20:59:32.213

这是可重现代码的问题。如果您指定的目录在其他人的计算机上不存在，那么他们就无法使用您的代码。这对于绝对文件路径尤其糟糕，对于 Windows 文件路径尤其糟糕（在 Unix 系统上绝对不可能复制）。

我首选的解决方案是在开始运行代码之前指定用户应该位于他们自己系统上的*相关目录中。*如果为了您自己的方便，您想`setwd(...)`在代码的顶部放置一个权利，其他人可以注意到它并酌情将其注释掉，但您的其余代码仅假定来自该起始目录的相对路径，这对我来说没问题.

谢一辉（作者`knitr`）对此感觉特别强烈：

[https://groups.google.com/forum/?fromgroups=#!topic/knitr/knM0VWoexT0](https://groups.google.com/forum/?fromgroups=#!topic/knitr/knM0VWoexT0)

> 每当您要操作文件时，都假定它们位于源文件的同一目录下（例如 Rnw 文档）。然后你总是可以使用相对路径，你永远不需要 setwd()。使用 setwd() 与可再现性原则相矛盾，例如您使用 setwd('f​​oo/bar/') 并且该目录可能不存在于其他人的计算机中。见FAQ 7： [https ://github.com/yihui/knitr/blob/master/FAQ.md](https://github.com/yihui/knitr/blob/master/FAQ.md)

从上述常见问题解答 7 中：

> 你最好不要这样做[更改 knitr 代码块中的工作目录]。您的工作目录始终是 getwd() （所有输出文件都将写入此处），但代码块在输入文档所在的目录下进行评估。在运行 R 代码时更改工作目录通常是一种不好的做法。参见#38 进行讨论。您还应该尽可能避免使用绝对目录（改用相对目录），因为它会使事情的可重复性降低。

另见：[https ://github.com/yihui/knitr/issues/38](https://github.com/yihui/knitr/issues/38)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-07T20:35:05.760

我想不出`setwd()`在我管理的服务器上运行的脚本中使用的任何特殊问题，因为它确实返回了一个可以被 try() 捕获的错误，并且您可以管理它。我`setwd()`在对路径懒惰时使用过 - 见下文！

我`file.path()`在脚本制作或其他方面广泛使用。处理输入目录中的文件并将输出图形和报告放在其他位置。所以类似于......（未经测试）这将是有点乏味使用`setwd()`.

```
kInDir <- '~/Indir'
kOutDir <- '~/Outdir'
flist <- dir(path=kInDir, pattern='^[a-z]{2,5}\\.csv$')
# note I could have used full.names=T - but it's easier not to...
for (fnam in flist) {
  # full path to the report file created
  sfnam <- file.path(kOutDir, gsub('.csv', '_report.txt', fnam))
  # full path to the csv file that will be created
  ofnam <- file.path(kOutDir, gsub('.csv', '_b.csv', fnam))
  #
  # ok... we're going to process this CSV file...
  r1 <- read.csv(file.path(kInDir, fnam))
  #
  # we''ll put the output from the analysis into this report file
  sink(sfnam, split=TRUE)
  # processs it... into a new data.frame k1
  # blah blah blah...
  #
  write.csv(k1, file=ofnam, row.names=FALSE)
  sink() # turn off this particular report file
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-06-17T05:43:31.410

走向更好的选择问题：

我主要将 R 用于单个项目（这意味着我是主要分析师）。但是，我们确实在有时需要与他人共享的项目中使用这些。

## RStudio - 项目

我发现**[RStudio](http://www.rstudio.com)的**Projects 功能在保持文件井井有条**[方面大有帮助。](http://www.rstudio.com/ide/docs/using/projects)**如果其他用户也采用 RStudio，他们会很高兴能够打开单个文件 ("*.Rproj") 并以您上次保存的相同状态加载项目。

## 项目模板

最重要的是，我发现了一个新工具，**[ProjectTemplate](http://projecttemplate.net/index.html)**，它更进一步！作者开发的技术用于为您正在做的事情提供结构。请访问网站了解更多详情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-03T06:34:22.923

尽管 setwd() 的问题已成为目标，但我想在问题*的替代*部分中再添加一个。我们经常在相对路径很方便的地方使用 git

```
setrelwd <- function(rel_path){
  curr_dir <- getwd()
  abs_path <- file.path(curr_dir,rel_path)
  if(dir.exists(abs_path)){
    setwd(abs_path)
  }
  else
  {
    warning('Directory does not exist. Please create it first.')
  }

}

> setrelwd("Summer2016")
Warning message:
In setrelwd("Summer2016") : Directory does not exist. Please create it first. 
```

此外，如果您不想看到警告消息但立即创建文件夹，请参阅[检查目录是否存在并在不存在时创建](https://stackoverflow.com/questions/4216753/check-existence-of-directory-and-create-if-doesnt-exist)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-07T21:25:15.347

为了让我工作的地方更便携，我们都把它放在一个 Rprofile 中

```
hdrive=
switch(Sys.info()[[1]],
'Linux'="/mnt/hdrive",
'Windows'="H:/",
"Darwin"="/Volumes/hdrive/mnt/hdrive"
) 
```

所以我总是有这个变量来让我进入我们的共享驱动器。然后在我的脚本中我们可以写

```
setwd(paste(hdrive,"/relative/path/",sep="/")) 
```

这样我们就可以解决其他人正在谈论的一些问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-11-20T16:23:00.827

我个人添加了以下代码。我使用具有唯一信息的 Sys.info() 和 any()。

第一步是使用 Sys.info() 并找到您计算机的唯一标识符。

```
if(any(Sys.info() == "COMPUTER1")) {
  setwd("c:/Users/user1/repos/project/")
}

if(any(Sys.info() == "COMPUTER2")) {
  setwd("home/user1/repos/project/")
} 
```

只需将计算机的名称添加到 if 语句并添加正确的路径即可。只需为每台机器添加一个新的 if。

对于复制，它不会更改任何人的工作目录，除非他们是该特定用户。

# php - 如何声明网站 URL 以进行电子邮件确认？

> ID：13770308
> 
> 赞同：0
> 
> 时间：2012-12-07T20:12:54.070
> 
> 标签：php, mail-server

我的站点 URL`http://www.qadenza.site90.com`
在 php 配置文件中，我有一行用于声明站点的 URL。所以我写了

```
DEFINE('WEBSITE_URL', 'http://www.qadenza.site90.com'); 
```

但是 smtp（即邮件）服务器在注册新用户后不会给我发送确认邮件。
新用户已正确添加到数据库。
因为我的会员区脚本位于`Members`我尝试过的文件夹中：

```
DEFINE('WEBSITE_URL', 'http://www.qadenza.site90.com/Members'); 
```

没有结果。

然后我写道：

```
DEFINE('WEBSITE_URL', 'http://localhost'); 
```

确认邮件到达，但激活链接错误（本地主机...）
我应该写什么作为网站 URL？

# javascript - 为什么我的 SVG 功能的坐标在我更改时不是我想要的？

> ID：13770309
> 
> 赞同：1
> 
> 时间：2012-12-07T20:13:00.313
> 
> 标签：javascript, html, svg, coordinates

以下代码包含 HTML、JavaScript 和 SVG。在 SVG 中，我创建了几个功能并将其嵌入到我的 HTML 正文中。JavaScript 用于交互性，它使用户能够操作一些变量并在地图上查看结果。例如，通过插入人口，目标城市的符号大小将发生变化。我对圆形没有问题，因为它的中心将被修复。当我用矩形符号改变城市人口时，我的问题就出现了。通过改变它的大小，它不再在线（矩形的中心应该在线的交点上）。当我更改其尺寸时，我尝试使用 JS 更改 SVG 中矩形（X，Y）的坐标。但是有问题。

```
<HTML>
<head>

<title>Population</title>

<script language="javascript" type="text/javascript">

var bakaInitPop=100;

var SunnInitPop=5000;

function changeSymbol(){

var initFontSize;
var radius;
var dimention;
var popsize=document.getElementById("population").value;
var svg=document.getElementById("object1");
var cities=document.getElementById("citylist");
var selectedCity=cities.options[cities.options.selectedIndex].value;
var initx1;
var inity1;

if(selectedCity=="Bakalund"){
    var T = svg.getElementById("c");
    radius=T.getAttribute("r");
    T.setAttribute("r",(popsize/bakaInitPop)*radius);
    return bakaInitPop=popsize;
}
else{
    var T = svg.getElementById("rs");
    dimention=T.getAttribute("width");
    initx1 =T.getAttribute("x");
    alert(initx1);
    inity1=T.getAttribute("y");
    var cal =(popsize/SunnInitPop)*dimention;
    alert(cal);
    T.setAttribute("width",cal);
    T.setAttribute("height",cal);
    var newx1 = initx1 +((dimention-cal)/2);
    alert(newx1);
    var newy1 = inity1 +((dimention-cal)/2);
    T.setAttribute("x",newX);
    T.setAttribute("y",newY);
    return SunnInitPop=popsize;
}

}

</script>
</head>
<body>
<form id="form1">
<table width="500" height="400">
<tr>

<td>
<svg id="object1" width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <rect x="10" y="10" width="300" height="300" stroke="black" stroke-width="4" fill="white"/>
        <polygon points="10,10 160,160 10,310" stroke="yellow" stroke-width="2" fill="yellow"/>
        <polygon points="10,10 310,310 310,10" stroke="green" stroke-width="2" fill="green"/>
        <polygon points="10,310 310,310 160,160" stroke="green" stroke-width="2" fill="green"/>
        <path d="M160 10 L120 80 L180 160 L170 210" fill="green" stroke="black" stroke-width="2"/>
        <line x1="10" y1="10" x2="310" y2="310" stroke="blue" stroke-width="4"/>
        <g id="bakalund">
        <circle id="c" cx="170" cy="210" r="5" stroke="black" stroke-width="2" fill="red" />
        <text id="c1" x="170" y="230" font-family="Verdana" font-size="10" fill="black" > Bakalund </text>
        </g>
        <g id="sunne">
        <rect id="rs" x="114" y="74" width="12" height="12" stroke="black" stroke-width="2" fill="red"/>
        <text id="rs1" x="130" y="80" font-family="Verdana" font-size="15" fill="black" font-weight="bold"> Sunne </text>
        </g>
    </svg>

</td>
</tr>
<tr>
<td>
<label>City</label>
<select id="citylist">
<option id="0"></option>
<option id="baka">Bakalund</option>
<option id="sunn">Sunne</option>
</select>
</td>
</tr>
<tr>
<td>
<label><b>Population</b></label>
<input type="text" id="population" size="10" maxlength="30"/>
<input type="button" id="set" name="set" value="set" onclick='changeSymbol();'>
</td>
</tr>
</table>
</form>
</body>
</HTML> 
```

为了使调试更容易，我放了三个警报来显示运行的不同阶段……第三个应该是 117，但它将是 1143，这意味着第一个 x 114 乘以 10，然后加到 3……

**问题：** *这段代码有什么问题？！！！是因为桌子的问题吗？！由于主坐标是在 SVG 中定义的，如何根据表格调整坐标？！！！！！！*

**解决方案：**

我终于知道为什么会这样了。这是因为 X 和 Y 的值被视为字符串，应该解析为**整数**，然后添加到新值中，如下所示：

```
 init1 = parseInt(T.getAttribute("x")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T22:04:22.773

getAttribute 返回一个字符串而不是一个数字。当您在字符串上使用 + 运算符时，它们会连接而不是转换为数字并添加数值。（其他运算符转换为字符串，因为除了具有数字参数之外，您无法以任何其他方式真正解释 - 或 / 或 *）。

解决方案是将字符串属性转换为这样的数字......

```
if(selectedCity=="Bakalund"){
    var T = svg.getElementById("c");
    radius=Number(T.getAttribute("r"));
    T.setAttribute("r",(popsize/bakaInitPop)*radius);
    return bakaInitPop=popsize;
}
else{
    var T = svg.getElementById("rs");
    dimention=Number(T.getAttribute("width"));
    initx1 =Number(T.getAttribute("x"));
    alert(initx1);
    inity1=Number(T.getAttribute("y"));
    var cal =(popsize/SunnInitPop)*dimention;
    alert(cal);
    T.setAttribute("width",cal);
    T.setAttribute("height",cal);
    var newx1 = initx1 +((dimention-cal)/2);
    alert(newx1);
    var newy1 = inity1 +((dimention-cal)/2);
    T.setAttribute("x",newX);
    T.setAttribute("y",newY);
    return SunnInitPop=popsize;
} 
```

# linux - linux域套接字凭据：如何检查两个计划进程是否具有相同的cron祖先

> ID：13770310
> 
> 赞同：1
> 
> 时间：2012-12-07T20:13:02.760
> 
> 标签：linux, process, cron, communication, credentials

假设我有一些`scott`用户。

在`scott`crontab 中，我安排了两个任务：

*   **task1**是一种“服务器”任务，它包装一些*信息*并通过 unix 域套接字提供服务（任务进程将一直保持到 SIG_xxx 结束它，无论如何......）
*   **task2**每天执行一次；每次执行都需要**task1**内存中包装的*信息。*为此，它将以客户端方式使用 unix 域套接字。

 **我想确保cron “范围”`scott`之外的额外进程（即使由 拥有）`scott`（不知道如何真正表达）将无法从**task1**服务器获取*信息。*显然，我希望**task1**的*信息*仅提供给crontab中安排的任务。*****`scott`*****

 *****unix 套接字域凭据机制是否有助于实现这样的事情？*******

# forms - 更新 symfony2 表单：选择要显示的字段

> ID：13770312
> 
> 赞同：1
> 
> 时间：2012-12-07T20:13:13.073
> 
> 标签：forms, symfony

我想允许之前注册的候选人返回他的注册并添加（并且仅）丢失的文件。

这是我的看法

```
<form action="{{ path('candidat_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>

    {% if ((entity.file2)==0)%}                       
        {{ form_row(edit_form.file2, { 'label': 'file2' }) }}
    {% endif %}

    <p>
        <button class="btn-small" type="submit">update</button>
    </p>
</form> 
```

单击按钮更新时，什么也没有发生（没有重定向到显示视图，没有上传）

我的控制器的 updateAction ：

```
public function updateAction(Request $request, $id)
{
    $em = $this->getDoctrine()->getManager();

    $entity = $em->getRepository('EtienneInscriptionBundle:Candidat')->find($id);

    if (!$entity) {
        throw $this->createNotFoundException('Unable to find Candidat entity.');
    }

    $deleteForm = $this->createDeleteForm($id);   
    $editForm = $this->createForm(new CandidatType(), $entity);  

    $editForm->bind($request);

    if ($editForm->isValid()) {
        $em->persist($entity);
        $em->flush();

        return $this->redirect($this->generateUrl('candidat_show', array('id' => $entity->getId())));
        #return $this->redirect($this->generateUrl('candidat_edit', array('id' => $id)));
    }

    return array(
        'entity'      => $entity,
        'edit_form'   => $editForm->createView(),
        'delete_form' => $deleteForm->createView(),
    );
} 
```

CandidateType 包含在创建操作（基于 CRUD 的控制器）中最初生成每个字段的构建器

```
public function buildForm(FormBuilderInterface $builder, array $options)
{        

    $builder     
        ->add('name') ....etc... 
```

关于有什么问题的任何想法？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:09:08.967

在模板中过滤表单字段不是一个好主意。更好的是在构建表单时使用选项。这是一个关于如何做到这一点的例子，

1）设置条件以将字段添加到表单中，

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder->add('field_a', 'type');
    // ...
    if ($options['allow_edit_field_b']) {
        $builder->add('field_b', 'text', array(
            'property_path' => false,
        ));
    }
    // ... 
```

2）定义你的选择，

```
 public function setDefaultOptions(OptionsResolverInterface $resolver) {
    $resolver->setDefaults(array(
        'allow_edit_field_b' => false,
        ));
 } 
```

3）建立你的表格，

```
 $form = $this->createForm(new YourType(), $yourObject, array(
        'allow_edit_field_b' => true,
    )); 
```

# c - 枚举成员可以是 ANSI-C 中数组的大小吗？

> ID：13770314
> 
> 赞同：7
> 
> 时间：2012-12-07T20:13:19.320
> 
> 标签：c, gcc, standards, clang, c89

我需要根据有多少元素来分配一个数组`enum`。我做了以下事情：

```
enum { A, B, C, LAST };
char buf[LAST]; 
```

这很好用，即使有`-ansi -pedantic`标志。但我不确定它是 GCC 还是 clang（它支持大多数，如果不是所有的 GCC 扩展）扩展，还是 ANSI C 标准真的允许，并且在任何带有 ANSI-C std 的 C 编译器中都能正常工作。有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:21:31.627

C89（第 3.5.2.2 节）和 C99（第 6.7.2.2 节）标准都以相同的方式定义枚举：

> **6.7.2.2 枚举说明符**（第 3 段），[http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)
> 
> **3.5.2.2 枚举说明符**（第 3 段）， http: [//flash-gordon.me.uk/ansi.c.txt](http://flash-gordon.me.uk/ansi.c.txt)

两者都读：

> [...] 带有 = 的枚举数将其枚举常量定义为常量表达式的值。如果第一个枚举数没有 =，则其枚举常数的值为 0。每个没有 = 的后续枚举数将其枚举常数定义为通过将前一个枚举常数的值加 1 获得的常数表达式的值。[...]

因此，在您的语法中，任何符合标准的编译器都将正确运行您的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-18T20:36:36.400

正如其他人所说，这是有效的。但我认为到目前为止没有人引用正确的部分。[N1256 C99 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)中的相关内容是：6.6“常量表达式”第 6 段：

> 整数常量表达式 99) 应具有整数类型，并且只能具有整数常量、枚举常量 [...]

然后是 6.7.5.2“数组声明符”第 4 段：

> 如果大小是整数常量表达式并且元素类型具有已知的常量大小，则数组类型不是可变长度数组类型 [...]

所以基本上：

*   枚举常量是常量表达式
*   对于数组不是可变长度的，我们需要一个常量表达式

我相信其他人引用的 6.7.2.2 “枚举说明符”谈到了声明`enum`，而不是使用枚举数。当然，由于在声明它们时需要编译时常量，我们希望它们在表达式中使用时也应该是编译时常量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:17:25.663

> 这很好用，即使使用 -ansi -pedantic 标志

所以它不是 GNU 扩展。是的，这在 ANSI C 中很好，因为 an 的成员`enum`是常量表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T20:20:47.217

> 有人可以澄清一下吗？

我相信你知道，枚举只是将标签应用于数字：

```
enum
{ A,  // 0 
  B,  // 1
  C,  // 2
  LAST  // 3
}; 
```

所以真的：

```
char buf[LAST]; 
```

无异于：

```
char buf[3]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T20:20:38.637

来自 C 标准，第 6.2.5 段（类型）：

> 16 枚举由一组命名的整数常量值组成。每个不同的枚举构成不同的枚举类型。
> 
> 17 char 类型、有符号和无符号整数类型以及枚举类型统称为整数类型。

此外，第 6.7.2.2 段（枚举说明符）：

> 定义枚举常量值的表达式应为整数常量表达式，其值可表示为 int。

# javascript - JavaScript 的 html 设置器“吃掉”文本区域内的前导换行符 - 如何克服？

> ID：13770317
> 
> 赞同：0
> 
> 时间：2012-12-07T20:13:25.413
> 
> 标签：javascript, jquery, google-chrome, line-breaks

**解决了**

*问题以一种棘手的方式解决。答案贴[在下面](https://stackoverflow.com/a/13771283/1102014)。*

* * *

我有一个带有样式的 textarea 控件，它在编辑新内容、将其存储到数据库中（完整、带有）以及显示为 html 页面的内联部分（在具有相同样式的 div 内）`white-space: pre;`时效果很好。`\r\n`

当我尝试在弹出对话框中使用从 AJAX 响应提供的相同文本区域编辑此类文本时，就会出现问题。我正在尝试通过 jQuery 将接收到的文本分配到 textarea 中：

```
$('#textfield').html(text); 
```

实际上，在响应中收到了填充了 textarea 的整个对话框。

不幸的是，这个 html-setter 删除了前导换行符。有没有办法消除这种不一致的行为？内容中进一步出现的换行符通常会被预先保存。

从服务器接收到的 html 代码示例：

```
<textarea id="newtext" cols="60" rows="3" style="white-space:pre;">
Text with line break at its start.
More line break</textarea> 
```

通过将代码`html`放入容器后，我得到了这个：

```
<textarea id="newtext" cols="60" rows="3" style="white-space:pre;">Text with line break at its start.
More line break</textarea> 
```

PS 从上下文中添加了更多代码，尽管我认为这可能不会有所帮助：

**JavaScript：**

```
var d = $('#dialog');

console.log(msg); // correct data
console.log('==============');

d.html(msg).css({position: "absolute", top: (pos.top + height) + "px", left: (pos.left + width) + "px"});

console.log(d.html()); // corrupted data

d.show();
$('#newtext').focus(); 
```

**带有容器的 HTML**：

```
<div id="dialog" class="popup">
</div> 
```

**更新：**

正如@Pointy 建议的那样，这确实不是 jQuery 的问题。我将 html-setter 替换为普通的旧的：

```
document.getElementById("dialog").innerHTML = msg; 
```

并遇到了同样的问题。浏览器是 Chrome。目前无法测试其他浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:16:57.150

如果您实际使用的是`<textarea>`.val，请使用 .val 而不是 .html。

编辑 - 如果你在这里和那里插入东西，也许这更接近你需要的东西......

```
var textarea = $("<textarea>").val(query);
$(".div-container").append(textarea);
//or, if you're going to replace the one in there
$(".div-container textarea").replaceWith(textarea) 
```

基本上，关键是您可以将带有 jquery 引用的变量分配给 textarea，然后您可以将其放在您需要的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:02:49.060

你能`text = text.match(/[^\n]+/g).join('<br>');`在用s`.html(text)`替换新行之前做吗？`<br>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:30:39.403

我有一个解决方法，非常简单。进入textarea的原始HTML代码：

```
<textarea id="newtext" cols="60" rows="3" style="white-space:pre;"><?php echo $templateVariablePlaceholder; ?></textarea> 
```

我在打开标签后添加了一个换行符：

```
<textarea id="newtext" cols="60" rows="3" style="white-space:pre;">
<?php echo $templateVariablePlaceholder; ?></textarea> 
```

现在它按预期工作。

# css - 如何让这个渐变在 chrome 中工作？

> ID：13770319
> 
> 赞同：0
> 
> 时间：2012-12-07T20:13:32.347
> 
> 标签：css, gradient

对，我不知道如何让这个渐变在 chrome 中工作：

```
background: linear-gradient(to bottom, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent; 
```

我了解 chrome 我需要使用一些 webkit 特定规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:22:27.867

我认为 webkit 前缀版本只是-webkit-linear-gradient。您的问题可能是您的第一个参数是“底部”而不是“底部”吗？

```
background: linear-gradient(to bottom, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent;
background: -webkit-linear-gradient(top, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent; 
```

在此处查看此操作：http: [//jsfiddle.net/KAD2E/](http://jsfiddle.net/KAD2E/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:39:19.100

除了基于 Webkit 的浏览器之外，所有最近的浏览器都删除了前缀并实现了最新的语法：Fx（常规和 ESR）、IE 10、Opera 12.10。

对于 Chrome 和 Safari，您仍然需要旧语法，前缀。

不再需要原始语法（-webkit-gradient(linear, ...) ），因为需要它的浏览器几乎不再使用。

最后一点：执行此操作的标准方式必须始终是最后声明的属性。这样，对于实现它的浏览器，它总是优先于可能有问题的旧行为。

所以正确的写法是：

```
background: -webkit-linear-gradient(top, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent;
background: linear-gradient(to bottom, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent; 
```

资料来源：[MDN 上的线性梯度](https://developer.mozilla.org/en-US/docs/CSS/linear-gradient)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:16:03.670

您需要使用`-webkit-`供应商前缀（*应该适用**于所有浏览器`to bottom``top`*）

```
background: -webkit-linear-gradient(top, rgb(25, 130, 185) 0%, rgb(3, 100, 150) 50%, rgb(1, 77, 117) 100%) repeat scroll 0% 0% transparent; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T20:18:48.223

用于镀铬

```
-webkit-linear-gradient 
```

另外，使用顶部而不是底部

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T20:19:35.433

我相信您仍然需要针对 Chrome 的 webkit 特定规则。试试这个语法：

```
background: -webkit-gradient(linear, left top, left bottom, from(#000), to(#000)); 
```

那应该对你有用。

[http://robertnyman.com/2010/02/15/css-gradients-for-all-web-browsers-without-using-images/](http://robertnyman.com/2010/02/15/css-gradients-for-all-web-browsers-without-using-images/)

# apache-flex - 如何从外部源向 Spark Image 添加平滑

> ID：13770320
> 
> 赞同：0
> 
> 时间：2012-12-07T20:13:33.603
> 
> 标签：apache-flex, flex4, flex4.5, flex-spark

默认情况下，如果远程服务器未添加策略文件，则无法访问或平滑来自远程域的图像。我记得在另一个项目中，我们能够在这些情况下启用平滑。我们必须将远程域设置或添加到受信任的域阵列。我没有这个代码了，我不记得我们是怎么做到的。有人知道我在说什么以及如何启用它吗？

**更多上下文**
将此代码添加到您的 Flex 应用程序：

```
<s:Image id="myImage" source="https://www.google.com/images/srpr/logo3w.png" smooth="true" height="200" width="400" /> 
```

并在浏览器中运行。如果你从 file:// 运行它，它应该会显示平滑的图像。![在此处输入图像描述](../Images/91bbfbbe2e0755dec9e79cf3afe9a5a6.png)

这是因为 Flash Builder 在开发过程中为其提供了特殊权限。如果你把它放在服务器上，例如，`http://localhost:8888/Project-debug/Project.html`你会看到它没有被平滑并且错误显示在控制台中：

![在此处输入图像描述](../Images/fd1c97ad421eb6b8a44a3db66f7beaf1.png)

```
Error: Request for resource at https://www.google.com/images/srpr/logo3w.png by requestor from http://localhost:8888/Project-debug/Project.swf/[[DYNAMIC]]/3 is denied due to lack of policy file permissions.

*** Security Sandbox Violation ***
Connection to https://www.google.com/images/srpr/logo3w.png halted - not permitted from http://localhost:8888/Project-debug/Project.swf
Error: Request for resource at https://www.google.com/images/srpr/logo3w.png by requestor from http://localhost:8888/Project-debug/Project.swf/[[DYNAMIC]]/3 is denied due to lack of policy file permissions. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:17:35.847

如果您将图像加载为

```
[Bindable]
var bmp : Bitmap = Bitmap( imgLoader.content ); 
```

然后申请

```
bmp.smooth = true; 
```

，然后使用 bmp 作为图像的绑定源。

# ruby-on-rails - 有没有更好的方法来制作一个改变rails属性的按钮？

> ID：13770321
> 
> 赞同：0
> 
> 时间：2012-12-07T20:13:34.827
> 
> 标签：ruby-on-rails, ajax, forms, button

我想在视图页面上创建一个按钮来更改我的数据库中的属性。我知道如何通过表单来做到这一点（但我们不想这样做）并且我使用了一种复杂的 ajax 方法来做到这一点（这太复杂了），但似乎必须有一个更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:20:10.697

不（以更好的方式）。

问：如何更改数据库中的值？

答：您必须向您的服务器发送一个[n] HTTP 请求。

向服务器发送 HTTP 请求有哪些选择？

1.  提交表单并让服务器以新视图响应。
2.  使用 XML 或 JSON（AJAX 或 AJAS）的异步 Javascript 调用

您可以编写自己的 Javascript 来执行“AJAX”，或者您只需使用已经存在的内容。

# rabbitmq - 使用 Autofac 进行总线配置：RabbitMQ 与 Loopback 的问题？

> ID：13770323
> 
> 赞同：4
> 
> 时间：2012-12-07T20:13:45.463
> 
> 标签：rabbitmq, autofac, masstransit

由于某种原因，我无法在[masstransit google 群组](https://groups.google.com/forum/?fromgroups#!forum/masstransit-discuss)中发帖，即使我加入了，但我被告知我无权在此群组中发帖。所以我要在这里发帖...

现在解决我的问题：

我正在使用 MassTransit v2.7.2 和 AutoFac v2.6.3。我正在尝试配置 Autofac 以扫描程序集并注册我的消费者；所有实现 IConsumer 接口的类型。这似乎有效。

当我配置总线时，我正在使用 MassTransit.AutofacIntegration 程序集和`LoadFrom(...)`扩展方法将容器中的消费者注册到 MassTransit。这是代码：

```
var builder = new ContainerBuilder();
builder
      .RegisterAssemblyTypes(typeof (CreateElectionCommandHandler).Assembly)
      .Where(type => type.Implements<IConsumer>())
      .AsSelf();
var container = builder.Build();

var localBus = ServiceBusFactory.New(configurator =>
                                         {
                                             //configurator.ReceiveFrom("loopback://localhost/testqueue");
                                             configurator.ReceiveFrom("rabbitmq://localhost/commandqueue");
                                             configurator.UseRabbitMq();
                                             configurator.Subscribe(sbc => sbc.LoadFrom(container));
                                         });

Assert.IsTrue(container.IsRegistered<CreateElectionCommandHandler>());
Assert.IsTrue(container.IsRegistered<TerminateElectionCommandHandler>());
Assert.AreEqual(1, localBus.HasSubscription<CreateElection>().Count());
Assert.AreEqual(1, localBus.HasSubscription<TerminateElection>().Count()); 
```

如果我使用环回运行上述代码

```
configurator.ReceiveFrom("loopback://localhost/testqueue"); 
```

配置（注释掉rabbitmq配置），测试将通过。

如果我注释掉“环回”配置并在

```
 configurator.ReceiveFrom("rabbitmq://localhost/commandqueue");
 configurator.UseRabbitMq(); 
```

配置，测试将失败。（注意：rabbitmq 队列已经启动并运行——我一直在使用它作为我的 POC 的一部分）。具体来说，它将在断言上失败：

```
Assert.AreEqual(1, localBus.HasSubscription<CreateElection>().Count());
Assert.AreEqual(1, localBus.HasSubscription<TerminateElection>().Count()); 
```

谁能帮我理解这里发生了什么？我是 MT 的新手，我完全预料到我会遗漏一些东西，或者没有正确配置一些东西。

我是否正确假设如果没有注册消息订阅，那么总线将无法交付给我的任何消费者（即使消费者已注册）？

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T01:04:34.260

使用 RabbitMQ，在发布消息之前不会将订阅添加到出站总线。这是由于如何检查类以及如何创建到适当交换的出站端点并将其添加到管道中。

所以是的，这个测试会在 RabbitMQ 上失败，但实际上当消息发布时它会正常工作。

HasSubscription() 调用实际上是为了验证消费者等是否使用环回传输正确配置，并且实际上只是为了审查不是真正的集成问题而只是确保内部 MassTransit 代码正常工作。

因此，如果您要添加其中一种类型的 Publish() 调用，*然后*调用 HasSubscription() 扩展方法，它将通过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T13:51:58.207

我会检查 MassTransit 是否创建了相关消息类型的交换。消息被发送到交换器，所有消费者队列都绑定到交换器。您可以查看 Rabbit 配置以查看是否也发生了这种情况。如果没有注册消费者，则不会传递任何消息。Chris 一直致力于为错误添加选项，以便您可以在代码中处理它。

我会加入邮件列表[https://groups.google.com/forum/?fromgroups=#!forum/masstransit-discuss](https://groups.google.com/forum/?fromgroups=#!forum/masstransit-discuss)以获得帮助。有更多的人可以提出正确的问题，以帮助您到达需要的地方。

# wchar - Wsutil.exe（本机 Web 服务编译器）：用于 xsd:string 类型的 WCHAR* 与 LPCWSTR

> ID：13770329
> 
> 赞同：1
> 
> 时间：2012-12-07T20:14:22.793
> 
> 标签：wchar, lpcwstr

本机 Web 服务编译器是否有充分的理由为`WCHAR *`vs `xsd:string`a `const wchar_t*`（或简称为 LPCWSTR）生成 a？

我提出这个问题的原因是我们的应用程序是一个本地 c++ 应用程序，它`std::wstring`在需要传递到 WCF 服务的代码中浮动。为了使用本地 Web 服务编译器生成的 C 函数，它迫使我做一些事情，例如

```
MyCppFunc(const std::wstring& inputString ,…)
{
… 
    HRESULT hr = BasicHttpBinding_BlahService(const_cast<<WCHAR*>WCHAR*>(inputString.c_str()), ….); 
} 
```

从上面可以看出，我被迫取消`const`on 指针，我在这里关注的一点是，明确地有一个`WCHAR*`类型是指针数据预计会被 webservices.lib 本身操纵吗？

或者，我最终可以将字符串的内容复制到 a`WCHAR*`但是因为我们的 c++ 应用程序作为服务运行，并且我们对频繁的分配/取消分配存在堆碎片问题。

谢谢，拉古

# python - 在 Biopython 中捕获 Genbank 文件解析错误

> ID：13770335
> 
> 赞同：1
> 
> 时间：2012-12-07T20:15:16.287
> 
> 标签：python, biopython

我已经使用 BioPython Entrez 模块按照[这篇文章](http://www.biostars.org/p/19206/)的内容下载了 genbank 文件列表。在随后解析这些文件时，我遇到了一个错误，因为我从 Entrez 下载的 genbank 文件是临时 RefSeq 的一部分，该临时 RefSeq 提供给基因组不完整的生物体 ( [NZ_CM000913.1](http://www.ncbi.nlm.nih.gov/nuccore/NZ_CM000913.1) )。当我尝试读取此文件时，出现记录错误并且我的脚本停止。我正在尝试编写一个可以避免这些记录的函数。最简单的方法是按大小过滤记录，但我想知道如何更“生物蟒蛇”地执行此操作 - 测试文件是否包含记录，如果不包含则排除。当前的 ValueError 消息被引发，但将停止脚本。

```
#the error message is something like this    
from Bio import SeqIO
gbkfile = 'NZ_CM000913.1'
SeqIO.read(open(gbkfile), 'gb')

      File "/usr/lib64/python2.6/site-packages/Bio/SeqIO/__init__.py", line 605, in read
        raise ValueError("No records found in handle") 
```

对于我的循环，我可以使用这样的东西：

```
#filter by length
for gbk in gbklist:
    if len(open(gbk).readlines()) < 50:
        print 'short file: exclude'
    else:
        process_gbk(gbk) 
```

但我想知道是否可以从 BioPython 中捕获错误消息：

```
#generate GBK-file exception    
for gbk in gbklist:
    try: 
        SeqIO.read(open(gbk),'gb')
        process_gbk(gbk)
    except BiopythonIO: 
        'this file is not a genbank file'
        pass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-23T12:41:22.613

你的建议差不多了！这是完成它+一些方便的津贴（阅读评论）

```
errorList = []                               # to store your erroneous files for later handling ;)

#generate GBK-file exception 
for gbk in gbklist:
    try: 
        SeqIO.read(open(gbk),'gb')
        process_gbk(gbk)
    except ValueError:                       # handles your ValueError
        print(gbk+' is not a genbank file')  # lets you know the file causing the error "live"
        errorList.append(gbk)                # logs the name of erroneous files in "errorList"
        continue                             # skips straight to the next loop 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T01:35:58.940

我可以使用 Biopython 打开[NZ_CM000913.1](http://www.ncbi.nlm.nih.gov/nuccore/NZ_CM000913.1)，实际上：

```
>>> from Bio import SeqIO
>>> fname = 'NZ_CM000913.1.gbk'
>>> recs = SeqIO.read(fname, 'genbank')
>>> recs
SeqRecord(seq=UnknownSeq(6760392, alphabet = IUPACAmbiguousDNA(), character = 'N'), id='NZ_CM000913.1', name='NZ_CM000913', description='Streptomyces clavuligerus ATCC 27064 chromosome, whole genome shotgun sequence.', dbxrefs=['Project:47867 BioProject:PRJNA47867']) 
```

您确定您已正确下载文件而不是空文件吗？

另外，我注意到你正在喂食`open('NZ_CM000913.1.gbk')`。`SeqIO.read`最好（并且更容易阅读）简单地提供文件名（`SeqIO.read('NZ_CM000913.1.gbk', 'genbank')`）以防止文件句柄未关闭。

# castle-windsor - 是否有可能在满足属性依赖之前获得正在解析的组件实例？

> ID：13770336
> 
> 赞同：0
> 
> 时间：2012-12-07T20:15:16.820
> 
> 标签：castle-windsor, windsor-3.0

```
public class A
{
    public X x { get; set; }
}

public class B
{
    public X x { get; set; }
}

public class X
{
    public X(object owner) { /* ... */ }
} 
```

基本上，如果类`A`和`B`在 Windsor 中注册，我希望能够以`X`这样的方式解决依赖关系，即它获取所需的类的实例。

在纯代码中，它看起来像这样：

```
var a = new A();
var x = new X(a);
a.X = x; 
```

温莎有没有办法做到这一点，也许是通过一些可扩展性机制？

* * *

即使对我来说，这看起来也是一个疯狂的问题，所以这背后有一些动机：

上面的`X`示例`ITracer`中的代理`TraceSource`是为每个跟踪的消息添加一些信息，即所有者的唯一 ID 及其类型（现在它只是 ID - 这就是问题的原因 - 我无法得到到实例并调用`GetType()`它）。

一个简单的例子使它更清楚。假设您有一些服务`IService`，并希望以最非侵入性的方式向它添加跟踪。但是在应用程序中可能有十几个此服务的实例，因此在跟踪中您希望通过 ID/类型来区分它们。如果类从容器接收它的跟踪器并在需要时在那里写消息，而不考虑 ID、具体`TraceSource`等，那就太好了。

我已经有一些基础设施可以让我这样写：

```
[TracedTo("NameOfTheTraceSource")]
public class Service : IService
{
    public ITracer Tracer { get; set; }
} 
```

并且 Windsor 正确地解析`Tracer`为它自己的（不与其他对象共享）`ITracer`指向`TraceSource`name的实例`NameOfTheTraceSource`。此外，如果我添加`traceAllMethods = true`到属性 - Windsor 将自动添加拦截器，它将通过相同的方式记下此实例上的每个方法调用`Tracer`（并且仅在相应`TraceSource`配置了一些侦听器时才会这样做 - 我们不必支持将它们添加到飞）。这真是太棒了，因为它不需要开发人员提供*任何东西*`Service`，并且在不需要时不会降低性能，一点也不。所以我正在努力让这更方便:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T05:26:19.660

好的，我想你想要的是一个设施。这是一个简单的（没有错误检查），可能是您正在寻找的（或至少为您指明正确的方向）：

```
public class XFacility : AbstractFacility
{
    protected override void Init()
    {
        this.Kernel.ComponentCreated += KernelOnComponentCreated;
    }

    private void KernelOnComponentCreated(ComponentModel model, object instance)
    {
        var props =
            instance.GetType().GetProperties().Where(p => p.CanWrite && p.PropertyType == typeof (X));
        if (props.Any())
        {
            var pi = props.First();
            pi.SetValue(instance, new X(instance), null);
        }
    }
} 
```

现在确保在进行任何解析之前将设施添加到容器中：

```
var container = new WindsorContainer();
container.AddFacility<XFacility>();
container.Register(Component.For<A>(),
                    Component.For<B>()
    );

var a = container.Resolve<A>(); 
```

# java - Java Thrift 客户端和二进制数据

> ID：13770339
> 
> 赞同：3
> 
> 时间：2012-12-07T20:15:38.863
> 
> 标签：java, c++, thrift

因此，根据我对 thrift 的理解，Java 是唯一一种没有二进制安全字符串的受支持语言，因此是 thrift 二进制类型。我的问题是它似乎不起作用。

我的定义文件是：

```
service myService {
     int myMethod(1:binary input)
} 
```

我的 Java 客户端在调用 myMethod 之前从观察到具有正长度和可打印字节的二进制数据构建 ByteBuffer。

在 myMethod 的 C++ 实现中（来自 thrift 生成的服务器骨架），尝试打印输入显示它始终为空大小为 0。

有什么想法我在这里想念的吗？将二进制文件更改为字符串使一切都像魅力一样工作，减去我不希望以后处理不安全的 java 转换字符串的事实......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T09:53:11.453

很可能您遇到了问题，因为 Java 中的 ByteBuffer 具有可变状态。因此，任何读取操作实际上都会修改 ByteBuffer，因为它会修改读取位置。

在 java 中使用 thrift 二进制文件的最简单（虽然不是最有效）的方法是将二进制文件创建为字节数组，并在调用之前立即将它们包装在信息缓冲区中，即：

```
byte[] input = ....;
myService.myMethod(ByteBuffer.wrap(input)); 
```

另一种可能的解决方案是使用 ByteBuffer.duplicate 来保持原始缓冲区的安全，即：

```
ByteBuffer input = ....;
dump(input.duplicate());// dump function may change buffer position
myService.myMethod(input); 
```

# javascript - 在 IE8 中将 cssPIE 用于 js 选项卡内容不呈现

> ID：13770341
> 
> 赞同：2
> 
> 时间：2012-12-07T20:15:45.850
> 
> 标签：javascript, jquery, css, internet-explorer, css3pie

我创建了一个选项卡和选项卡内容动画。单击选项卡时，相应的选项卡内容会显示在下方，而其他选项卡则隐藏，非常简单且工作正常。我遇到的问题是在**IE7**和**8中渲染****边界半径**。我将 cssPIE.htc 用于可能受这些 css3 属性影响的任何 css。这适用于页面上未使用 jQuery 操作的静态内容，但对于诸如选项卡之类的动态内容，我相信内容的 css 需要**-pie-watch-ancestors: n**属性。这样做之后，仍然没有结果。下面是我的代码（CSS、HTML 和 jQuery）以及 chrome 和 IE8 之间区别的屏幕截图。任何帮助都会很棒。

 ********更新：我可以通过让标签内容离开页面来解决这个问题，然后将活动的内容放回左侧：0，以便它始终显示并且永远不会重新呈现。**与此同时**，这里是小提琴，发疯：[tab fiddle](http://jsfiddle.net/9HMKK/3/)

**铬截图** ![铬作品](../Images/d1a76e14c63bf5e2e74706ed7a7edb20.png)

**IE8 损坏的屏幕截图** ![即打击](../Images/d1ac3ee1405eb6fa301bfd3b806013d8.png) 您可能会注意到：没有边框、没有背景和没有背景图像（小彩色框）。

**附属于标签内容的 CSS**

```
 .tabContent {
    position:absolute;
    display:none;
    background-color:White;
    background-image: url(/includes/images/home_phase2/colored_boxes_small.png);
    background-repeat: no-repeat;
    background-position: 98% 90%;
    border-left:1px solid #772981;
    border-right:1px solid #772981;
    border-bottom:1px solid #772981;
    width:945px;
    margin-top:1px;
    margin-left:-1px;
    z-index:9999;

    -webkit-border-top-left-radius: 0;
    -moz-border-radius-topleft: 0;
    border-top-left-radius: 0;
    behavior: url("/includes/css/PIE.htc");
    -pie-watch-ancestors: true;
}

    .roundedCorners {
    border-radius:7px;
    -webkit-border-radius: 7px;
    -moz-border-radius: 7px;
    behavior: url("/includes/css/PIE.htc");
} 
```

**jQuery（文档加载预期）**

```
$('.tabContent').click(function (event) {
    event.stopPropagation();
});

tabLnk.each(function () {
    $(this).attr("href", "javascript: void(0)")
});

tabLnk.click(function (event) {

    event.stopPropagation();
    var $this = $(this);
    var hideActive = $('.active').parent().index();

    if ($this.hasClass('active')) {
        $this.removeClass('active');
        $('.tabContent_wrapper .tabContent:eq(' + hideActive + ')').hide();
    } else {
        $('.tabLnk').removeClass('active');
        $this.addClass('active');
        var showActive = $('.active').parent().index();
        $('.tabContent_wrapper').show();
        var activeContent = $('.tabContent_wrapper .tabContent:eq(' + showActive + ')');
        activeContent.show();
        activeContent.siblings().hide();
    }

    if ($('.tab_wrapper li a').slice(1, 3).hasClass('active')) {
        $('.tabContent').slice(1, 3).addClass('borderTopLeftTabContent');
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:22:25.653

尝试添加

`position: relative`

至

```
.roundCorners {} 
```

听起来很有趣，但有同样的问题，可能会有所帮助。

编辑：

同样可能适用于：

```
.tabContent {} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T00:53:19.783

好的，经过长时间的尝试，我设法做到了。最后我用圆角解决了它`tabContent_wrapper`。

以下是我所做的简短总结：

1.  从每个 tabContent div 中删除 roundedCorners，添加到`tabContent_wrapper`
2.  将`clearfix`类添加到所有`tabContent`div，`clearfix`在 CSS 代码中定义类
3.  添加`PIE.htc`到`roundedCorners`
4.  `roundedCorners`由于 CSS3PIE 角，添加了一些填充...
5.  添加位置：相对；`z-index:10;`至`roundedCorners`
6.  注释掉`tabContent`的`position:absolute;`
7.  hid `tabContent_wrapper`，因为有一个`2px`填充，在其中不显示任何内容时看起来很难看
8.  删除前面的评论标志`$('.tabContent_wrapper').show();`，现在需要；`$('.tabContent_wrapper').hide();`当我们再次单击活动选项卡时放入（不要让丑陋的空内容显示有边框）

这是完整的代码（使用[http://jsbeautifier.org/](http://jsbeautifier.org/)格式化后）：

```
<!DOCTYPE html>
<html>  
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <meta charset=utf-8 />
    <title>Tabs...</title>
    <style>
      .roundedCorners {
        padding:2px;
        border-radius:7px;
        -webkit-border-radius: 7px;
        -moz-border-radius: 7px;
        /* New stuffs */
        behavior: url(PIE.htc);
        position:relative;
        z-index:10;
      }
      .tabHome_wrapper {
        margin-bottom:-1px;
      }
      .tab_wrapper {
        position:relative;
        height:25px;
        margin-left:-1px;
      }
      .tab_wrapper ul li {
        display:inline-block;
        padding-right:20px;
        overflow:hidden;
        width:132px;
        height:25px;
      }
      .tab_wrapper ul > li:first-child a {
        -webkit-border-bottom-left-radius: 7px;
        -moz-border-radius-bottomleft: 7px;
        border-radius: 0 0 0 7px;
      }
      .tabLnk {
        position:absolute;
        background-image:url('http://i.imgur.com/PkR4W.png');
        background-position: -132px 1px;
        background-repeat:no-repeat;
        width:132px;
        height:25px;
        margin-top:1px;
        z-index:9999;
        font-size: 15px;
        text-align: center;
        line-height: 25px;
        color: White !important;
        text-decoration: none;
      }
      .borderTopLeftTabContent {
        border-radius: 7px 7px 7px 7px !important;
      }
      .tabLnk.active {
        width:130px;
        background-position:-1px 1px;
        -webkit-border-bottom-left-radius: 0px !important;
        -moz-border-radius-bottomleft: 0px !important;
        border-bottom-left-radius: 0px !important;
        color: #833889 !important;
      }
      .tabLnk:hover, .tabLnk:focus {
        text-decoration: none;
      }
      .tabLnk:visited {
        color: White;
      }
      .hideContent {
        left:-99999px;
      }
      .tabContent_wrapper {
        /* new stuffs */
        width:945px;
        margin-top:1px;
        margin-left:-1px;
        border:1px solid #772981;
        /*
        border-top:0px;
        */

        /* hide it first because of the 2 pixel roundedCorner padding */
        display:none;
      }

      .tabContent {
        /*
        position:absolute;
        */

        display:none;
        background-color:White;
        background-image: url('http://i.imgur.com/yyhGR.png');
        background-repeat: no-repeat;
        background-position: 98% 90%;

        /* moved to tabContent_wrapper, this z-index is not needed now */
        /* 
          border-left:1px solid #772981;
          border-right:1px solid #772981;
          border-bottom:1px solid #772981;
          width:945px;
          margin-top:1px;
          margin-left:-1px;
          z-index:9999;
        */

        -webkit-border-top-left-radius: 0;
        -moz-border-radius-topleft: 0;
        border-top-left-radius: 0;
      }

      .tabContent_img {
        float: left;
        width:290px;
        height:155px;
        padding: 20px 20px 10px 15px;
      }

      .tabContent_description {
        padding: 32px 140px 20px 0px;
        width:450px;
        float:right;
        font-size: 14px;
        color: gray;
      }

      .tabContent_description p:first-child {
        padding-bottom: 10px;
      }

      .lblTabTxt {
        color: white;
        padding-left: 3px;
        top: 5px;
        position: relative;
      }

      .lblTabTxt:hover {
        text-decoration: none;
      }

      /* Pete... clearfix from Drupal */
      /**
       * Markup free clearing.
       *
       * @see http://perishablepress.com/press/2009/12/06/new-clearfix-hack
       */
      .clearfix:after {
        content:".";
        display: block;
        height: 0;
        clear: both;
        visibility: hidden;
      }
      /* IE6 */
      * html .clearfix {
        height: 1%;
      }
      /* IE7 */
      *:first-child + html .clearfix {
        min-height: 1%;
      }
    </style>

    <script type="text/javascript">
      $(document).ready(function () {

        var tabLnk = $('.tabLnk');

        $('.tabContent').click(function (event) {
          event.stopPropagation();
        });

        tabLnk.each(function () {
          $(this).attr("href", "javascript: void(0)")
        });

        tabLnk.click(function (event) {

          event.stopPropagation();
          var $this = $(this);
          var hideActive = $('.active').parent().index();

          if ($this.hasClass('active')) {
            $this.removeClass('active');
            $('.tabContent_wrapper .tabContent:eq(' + hideActive + ')').hide();
            // hide tabContent_wrapper too (when empty, it would look ugly because of the 2px padding)
            $('.tabContent_wrapper').hide();
          } else {
            $('.tabLnk').removeClass('active');
            $this.addClass('active');
            var showActive = $('.active').parent().index();
            $('.tabContent_wrapper').show();
            var activeContent = $('.tabContent_wrapper .tabContent:eq(' + showActive + ')');
            activeContent.show();
            activeContent.siblings().hide();
          }

          if ($('.tab_wrapper li a').slice(1, 3).hasClass('active')) {
            $('.tabContent').slice(1, 3).addClass('borderTopLeftTabContent');
          }
        });

      });
    </script>
  </head>

  <body>
    <div id="ctl00_cphBody_pnltabWrapper" class="tabHome_wrapper">
      <div id="tabArea" class="tab_wrapper">
        <ul>
          <li> <a class="tabLnk" href="javascript: void(0)">
                Administrators
                </a>

          </li>
          <li> <a class="tabLnk" href="javascript: void(0)">
                Teachers
                </a>
          </li>
          <li> <a class="tabLnk" href="javascript: void(0)">
                Technologists
                </a>
          </li>
        </ul>
      </div>
      <div id="tabContentArea" class="tabContent_wrapper roundedCorners">
        <div class="tabContent clearfix" style="display: none;">
          <div class="tabContent_img">
            <img src="http://i.imgur.com/zJJmn.png" alt="tabContent_img example" width="283"
            height="152">
          </div>
          <div class="tabContent_description">
            <p> <strong><span style="COLOR: #4b0082">Administrators</span> </strong></p>
            <p>a aliquet dolor gravida. Sed auctor imperdiet lacus vel vulputate.venenatis
              mauris, a dignissim elit fringilla ac. Quisque malesuada dapibus venenatis.
              Aliquam volutpat ante id diam auctor eu volutpat massa sem et augue. Vestibulum
              tortor lacus, venenatis sed ultricies ac, porta et ligula. Duis consectetur
              Mauris fringilla massa ac sem tristique consectetur. Aliquam varius, lacus
              vel sollicitudin congue, elit erat luctus mauris, Lorem ipsum dolor sit
              amet, consectetur adipiscing elit. Quisque posuere nunc lacinia diam ornare
              a ullamcorper nulla egestas.</p>
          </div>
        </div>
        <div class="tabContent borderTopLeftTabContent clearfix" style="display: none;">
          <div class="tabContent_img">
            <img src="http://i.imgur.com/zJJmn.png" alt="tabContent_img example" width="283"
            height="152">
          </div>
          <div class="tabContent_description">
            <p><strong><span style="COLOR: #4b0082">Teachers</span></strong></p>
            <p>CONTENT&nbsp;CONTENT CONTENT CONTENT CONTENT CONTENT CONTENT CONTENT CONTENT
              CONTENT CONTENT CONTENT CONTENT</p>
          </div>
        </div>
        <div class="tabContent borderTopLeftTabContent clearfix" style="display: none;">
          <div class="tabContent_img">
            <img src="http://i.imgur.com/zJJmn.png" alt="tabContent_img example" width="283"
            height="152">
          </div>
          <div class="tabContent_description">
            <p> <strong><span style="COLOR: #4b0082">Technologists </span></strong></p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut malesuada,
              nulla eu viverra iaculis, nibh ipsum rhoncus risus, sit amet porta sapien
              elit id turpis. Donec eu nibh diam. Ut placerat vulputate ligula, ut mattis
              odio adipiscing id. Nullam vel arcu est. Praesent vitae porta metus. Cras
              auctor sem non nisi aliquet ultricies. Suspendisse potenti. Curabitur gravida
              eleifend aliquam. Fusce consequat cursus eros sit amet hendrerit. Curabitur
              quam nibh, auctor id dictum non, dapibus sit amet libero.</p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html> 
```

## 一些截图：

1.  默认情况下，不打开任何选项卡： ![没有打开标签](../Images/1277db508a02e581ceab5b50679911b1.png)
2.  第一个标签打开： ![第一个标签打开](../Images/51d1d244273661a9b2a241899a68f5df.png)
3.  打开第二个标签： ![打开第二个标签](../Images/71571d53d2c6abf95cc08e93788a22b7.png)
4.  第三个标签打开： ![第三个标签打开](../Images/f85bdc5e2150ad33fb8002427d484de9.png)

**当然，您必须操纵上边框，以免在活动选项卡下显示边框。**
让我知道这是否有帮助。******

# seo - 网络蜘蛛是否会读取未显示且不显示的内容？

> ID：13770356
> 
> 赞同：0
> 
> 时间：2012-12-07T20:17:14.320
> 
> 标签：seo, web-crawler, bots

正如标题所说：网络蜘蛛会读取未使用`display: none;`CSS 代码显示的内容吗？

我用 Lynx 访问了我的网站，我仍然可以看到内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:19:31.027

是的。一些搜索引擎蜘蛛据说不会索引它或仅使用它来检查垃圾邮件，但它是可见的。大多数蜘蛛不处理 CSS 或客户端脚本。

# r - R基于带有环境向量的cmd函数绘制PCoA

> ID：13770358
> 
> 赞同：-4
> 
> 时间：2012-12-07T20:17:21.200
> 
> 标签：r, vector, cmd, pca

我需要基于具有环境向量的相异矩阵（vegdist，方法 Bray）制作 PCoA 图（cmd 比例）。

我得到了 cmd PCoA 图，但是，我不知道如何绘制环境变量的向量。

是否应该将它们放在单独的文件中。是否使用了 envfit 功能以及我是初学者如何？

如果有人可以一步一步地告诉我如何做到这一点，那就太好了。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:34:26.017

那里有很多免费的可用资源，并附有分步手册。例如[vegan-vignettes](http://hosho.ees.hokudai.ac.jp/~kubo/Rdoc/library/vegan/doc/)、Roeland Kindt 的[“树多样性分析”](http://www.worldagroforestry.org/downloads/publications/PDFs/MN08242.PDF)等等……

Borchard 的书（[R 的数值生态学](http://www.bio.umontreal.ca/numecolR/)）也很不错。

这是一个启动器：

```
require(vegan)
data(dune)
data(dune.env)

str(dune)
str(dune.env)

# CMD
cmd <- cmdscale(vegdist(dune, method="bray"))
# Plot CMD
ordiplot(cmd)
# Fit environmental variables
fit_env <- envfit(ord=cmd, env=dune.env)

# plot environmental variables with p < 0.05
plot(fit_env, p.max = 0.05)

# add smooth surface for A1
ordisurf(cmd, dune.env$A1, add = TRUE) 
```

# ruby-on-rails - Rails 外键验证

> ID：13770365
> 
> 赞同：3
> 
> 时间：2012-12-07T20:17:48.093
> 
> 标签：ruby-on-rails, validation, foreign-keys

我有一个用户和一个文档模型；一个用户有很多文档，一个文档属于一个用户。您可以将其概括为仅具有父模型和子模型。

现在我正在为子模型编写单元测试，我想知道是否也必须验证 parent_id 字段（例如 only_integer，大于零，id 存在于父表中等） - 还是 Rails 自动为我这样做，因为这些是固有的外键属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:42:58.523

Rails 3方式将是

```
# child.rb
validates :parent, presence: true 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T20:25:03.937

您可以添加外键约束，甚至通过 Rails（即不必手动连接到您的数据库并执行原始 SQL），但您也可以在模型本身上执行此操作：

```
# child.rb
validates_presence_of :parent 
```

这将确保它有一个 parent_id 并且该 ID 可以在 Parent 表中找到。

否则，不，Rails 不会自动为您检查约束。

# php - 在我自己的班级中使用 PDO 连接

> ID：13770367
> 
> 赞同：2
> 
> 时间：2012-12-07T20:17:57.207
> 
> 标签：php, pdo

我不能使用我自己的`pdo_connection`类中的 PDO 类方法，不管有没有`extends PDO`，它都不能正常工作。

```
Class pdo_connection { 
//connection create 
    private $dbhost = "127.0.0.1"; 
    private $dbname = "db"; 
    private $dbuser = "user"; 
    private $dbpass = "pass"; 
    public function __construct() { 
        return $db = new PDO('mysql:host=' . $this->dbhost . ';dbname=' . $this->dbname, $this->dbuser, $this->dbpass); 
    } 
} 
```

然后当我创建对象时：

```
require("api/pdo.connection.class.php"); 
$db = new pdo_connection(); 
$db->exec("SET NAMES utf8"); 
```

我不能使用 exec，因为它不是 pdo_connection 类的方法，但我想使用在`pdo_connection`类中创建的 PDO 的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:25:47.870

如果您希望能够这样使用`pdo_connection`，则必须扩展 PDO。

例子：

```
class db extends PDO { 
```

然后，在该类中，在 中`__construct`，使用`parent::__construct`：

```
parent::__construct('mysql:host=' . $this->dbhost . ';dbname=' . $this->dbname, $this->dbuser, $this->dbpass); 
```

* * *

这是我使用该方法制作的类：**[[链接]](http://pastie.org/5495623)**

用法：

```
include_once 'db.php';
$db = new db('user');
// Do stuff with $db 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T20:29:35.830

任何构造函数的返回类型都应该是`void`. 您使用构造函数来初始化对象属性。调用时的返回值`new ClassName()`将是 type `ClassName`。

话虽这么说，如果你想扩展类`PDO`，你可以这样做：

`class pdo_connection extends PDO { ... }`

但是，就我个人而言，我不会这样做。事实上，快速搜索让我找到了这篇文章：

*   [扩展 PDO 是一种浪费……（2005 年 9 月 22 日；作者：Davey Shafik）](http://daveyshafik.com/archives/96-extending-pdo-a-waste.html)

请记住，我从未亲自*尝试过*扩展 PDO，因此请考虑到这一点。

相反，为什么不将 PDO 对象存储为类属性，然后定义您自己的与该 PDO 对象交互的函数呢？

```
Class pdo_connection { 
//connection create 
    private $dbhost = "127.0.0.1"; 
    private $dbname = "db"; 
    private $dbuser = "user"; 
    private $dbpass = "pass"; 
    public function __construct() { 
        try { // Don't forget this....
            $this->db = new PDO('mysql:host=' . $this->dbhost . ';dbname=' . $this->dbname, $this->dbuser, $this->dbpass); 
        } catch(PDOException $e) { }
    } 

    public function exec() {
     /// do your exec stuff here
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:36:20.533

1.  遵循命名/自动加载约定，例如[PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)。
2.  使用 Autoloader，如果你对你的类使用 require/include，那么你做错了，很可能。
3.  `class`将代码包装起来并称之为 OOP是不够的。
4.  我看不出你为什么不能扩展 PDO，但无论如何......

```
class MyPdo
{

  protected $db;
  protected $dbhost = '127.0.0.1';
  protected $dbname = 'db';
  protected $dbuser = 'user';
  protected $dbpass = 'pass';

  protected function __construct()
  {
    $this->db = PDO('mysql:host=' . $this->dbhost . ';dbname=' . $this->dbname, $this->dbuser, $this->dbpass);
  }

  public function __call($method, $args)
  {
    return call_user_func_array(array($this->db, $method), $args);
  }

} 
```

# c# - TAPI 与 Cisco 电话；使用“sidecar”800 模块

> ID：13770368
> 
> 赞同：2
> 
> 时间：2012-12-07T20:17:59.000
> 
> 标签：c#, cisco, tapi

我目前正在开发一个基于 TAPI 的应用程序，以便使用我们的 Cisco IP 电话系统向我们呼叫中心的座席提供“智能呼叫者 ID”。当有电话打进来并且代理在其工作站的“真实”电话上接听电话时，位于工作站系统托盘中的应用程序会获取呼叫远程端的号码，并通过中央数据库运行它查看该号码是否属于我们的客户公司之一或其代表。如果是这样，我们会显示代理现在正在与谁交谈的信息（个人或客户位置名称、公司、职位等）。

[我使用 Julmar 优秀的ATAPI](http://atapi.codeplex.com/)库开发了一个概念证明来监控我隔间的电话，并且让它运行良好。但是，代理商的电话有很大的不同；它们插入一个边车模块，另外还有 14 个分机连接到我们的 1-800 寻线。

我现在遇到的问题是，我不仅需要知道何时连接了呼叫，还需要知道它何时连接到我正在监控的单个电话，该电话位于运行应用程序的工作站下方。目前，我可以看到所有 800 条线路上的线路状态变化，但我无法判断哪些线路状态变化是我正在监控的电话设备操作的直接结果；显然我可以监控电话状态和线路状态的变化，但是如果两个座席几乎同时接听两个在 800 块上响铃的电话，我就无法分辨哪个电话接听了哪个电话。

该信息必须在 TAPI 接口中的某处可用，如果可能没有被 ATAPI 包装的话。任何关于我应该看什么的提示，希望来自以前做过这件事的人，都会受到赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:18:49.980

我找到了解决办法。

ATAPI 库对于那些只想插入并使用的人来说有点虚伪。TapiLine 的 CallStateChanged 事件，当您挂接到连接的呼叫时，它使用一个接受 CallStateEventArgs 作为 EventArgs 参数的委托。然而，事实证明 CallStateEventArgs 是一个基类。功能齐全，但并非适用于所有情况。

连接呼叫时实际传递给事件的是 ConnectedCallStateEventArgs 实例。这个派生类不仅公开了基类的新旧 CallStates，还公开了 Cisco 文档中引用的“呼叫状态模式”，使用 ConnectModes 枚举类型的 Mode 只读字段。

从 Cisco 文档中，如果您正在监控共享线路（例如来自 800 块），并且该线路上的呼叫被与您正在监控的线路实例关联的电话接听或加入，则呼叫状态模式将为“LINECONNECTEDMODE_ACTIVE”。如果您的电话不是通话方，则为“LINECONNECTEDMODE_INACTIVE”。如果线路未共享，则线路上任何已连接呼叫的连接模式将为零（ATAPI 库中的“无”；如果您获得此值，则假设您的电话是呼叫的一方）。

使用这条附加信息，可以知道与线路关联的电话实际上正在通话中。对于您使用可以访问该线路的 TAPI 实例监控的每部电话，您将获得该特定 800 块线路的一个线路实例，因此您可以知道您正在监视的两部、三部或十部电话中的哪一部接到了电话。如果您没有在一台计算机/TAPI 实例上监控多部手机，和/或您正在监控的任何手机上的呼叫均未激活，则您无法判断哪部手机*有*呼叫；只是你的手机*没有*。

对我而言足够了; 代理只需要知道他们在与谁交谈，而不是其他任何人。如果我们需要一个用于监控所有 20 部具有 800 块的电话的楼层经理办公桌的帐户，我们可以稍后处理。

# c - sem_wait() 上的总线错误

> ID：13770370
> 
> 赞同：1
> 
> 时间：2012-12-07T20:18:09.890
> 
> 标签：c, linux, semaphore

我正在使用命名信号量编写一个多进程程序，在主进程中我使用以下代码打开信号量

```
semaphore = sem_open("/msema",O_RDWR|O_CREAT|O_TRUNC,00777,1);      
if (semaphore == SEM_FAILED)
    perror("SEMAPHORE"); 
```

在子程序中

```
count_sem=sem_open("/msema",O_RDWR);
if(count_sem==SEM_FAILED) 
 {
 perror("sem_open");
 return 1;
 } 
```

在 sem_wait()

```
 do {
   errno=0;  
printf("BeforeSemWait\n");  
    rtn=sem_wait(count_sem);
printf("afterSemWait\n");
  } while(errno==EINTR);
  if(rtn < 0) {
  printf("Error\n");
  perror("sem_wait()");
  sem_close(count_sem);
  return 1;
 } 
```

我收到来自 sem_wait() 的总线错误

```
 BeforeSemWait

 Program received signal SIGBUS, Bus error.
 0x00a206c9 in sem_wait@@GLIBC_2.1 () from /lib/libpthread.so.0` 
```

我究竟做错了什么？

编辑：整个代码：master.c：[http](http://pastebin.com/3MnMjUUM) : //pastebin.com/3MnMjUUM worker.c [http://pastebin.com/rW5qYFqg](http://pastebin.com/rW5qYFqg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:29:00.347

您的程序中一定有其他地方存在错误。以下工作在这里（不需要O_TRUNC）：
semproducer.c：

```
#include <fcntl.h>
#include <stdio.h>
#include <semaphore.h>
int main () {
  sem_t *sem=sem_open("/msema",O_RDWR|O_CREAT /* |O_TRUNC*/ ,00777,1);
  if (sem==SEM_FAILED) {
    perror("sem_open");
  }
  else {
    while (1) {
      sem_post (sem);
      printf ("sem_post done\n");
      sleep (5);
    }
  }
} 
```

semconsumer.c:

```
#include <fcntl.h>
#include <stdio.h>
#include <semaphore.h>
#include <errno.h>
int main () {
  sem_t *count_sem=sem_open("/msema",O_RDWR);
  if(count_sem==SEM_FAILED) {
    perror("sem_open");
    return 1;
  }
  do {
    int rtn;
    do {
      errno=0;
      rtn=sem_wait(count_sem);
    } while(errno==EINTR);
    if(rtn < 0) {
      perror("sem_wait()");
      sem_close(count_sem);
      return 1;
    }
    printf ("sema signalled\n");
  } while (1);
} 
```

编译`gcc semproducer.c -o semproducer -lrt`和 `gcc semconsumer.c -o semconsumer -lrt`

# php - PHP MYSQL 查询中的语法错误

> ID：13770373
> 
> 赞同：-3
> 
> 时间：2012-12-07T20:18:18.250
> 
> 标签：php, mysql, sql

我有以下 mysql 查询，但出现语法错误：

> “字段列表”中的未知列“k.Fund_Name”

Dreamweaver 没有反映语法错误。仅在浏览器中。

```
$result2 = mysql_query("
select 
      k.Fund_Name Title,
      k.Fund_Yield_9 Year_9,
      k.Fund_Yield_8 Year_8,
      k.Fund_Yield_7 Year_7,
      k.Fund_Yield_6 Year_6,
      k.Fund_Yield_5 Year_5,
      k.Fund_Yield_4 Year_4,
      k.Fund_Yield_3 Year_3,
      k.Fund_Yield_2 Year_2,
      k.Fund_Yield_1 Year_1,
      k.Fund_Yield_0 Year_0

from
( select    
      a.Fund_Name Fund_Name,
      j.Fund_Yield Fund_Yield_9,
      i.Fund_Yield Fund_Yield_8,
      h.Fund_Yield Fund_Yield_7,
      g.Fund_Yield Fund_Yield_6,
      f.Fund_Yield Fund_Yield_5,
      e.Fund_Yield Fund_Yield_4,
      d.Fund_Yield Fund_Yield_3,
      c.Fund_Yield Fund_Yield_2,
      b.Fund_Yield Fund_Yield_1,
      a.Fund_Yield Fund_Yield_0

from
            ( select  A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_Minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 0 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) a

Left Outer Join ( select
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 1 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) b on ( a.ID_CARTERA = b.ID_CARTERA )

Left Outer Join ( select
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 2 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) c on ( a.ID_CARTERA = c.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1                            
    And       A.F_ANO = ( select  MAX(F_ANO ) - 3 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) d on ( a.ID_CARTERA = d.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 4 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) e on ( a.ID_CARTERA = e.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1                            
    And       A.F_ANO = ( select  MAX(F_ANO ) - 5 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) f on ( a.ID_CARTERA = f.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 6 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) g on ( a.ID_CARTERA = g.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 7 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) h on ( a.ID_CARTERA = h.ID_CARTERA )

Left Outer Join ( select    
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 8 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) i on ( a.ID_CARTERA = i.ID_CARTERA )

Left Outer Join ( select
              A.ID_Cartera,
              A.F_ANO Year,
              H.DES_CARTERA_CC Fund_Name,
              ROUND(A.POR_RENTABILIDAD, 2) Fund_Yield,
              C.DES_CARTERA_CC Fund_Benchmark_Name,
              ROUND(A.POR_RENTBENCH, 2) Fund_Benchmark_Yield,
              D.DES_CARTERACLASE Class_Name,
              ROUND(G.POR_RENTABILIDAD, 2) Class_Yield,
              E.DES_CARTERACLASE_ESP Special_Class_Name,
              ROUND(F.POR_RENTABILIDAD, 2) Special_Class_Yield,
              ROUND(A.POR_RENTMENOSBENCH, 2) Plus_minus_Benchmark,
              ROUND(A.POR_RENTMENOSCLASE, 2) Plus_Minus_Class,
              ROUND(A.POR_RENTMENOSCLASEESP, 2) Plus_Minus_Special_Class,
              ROUND(A.POR_PERCENTILCLASE, 2) Percentile_Class,
              ROUND(A.POR_PERCENTILCLASEESP, 2) Percentile_Special_Class
    from      dr_rent_carteras_anos A
              Join det_refcru_carterasbench B on ( A.ID_CARTERA = B.ID_CARTERA )
              Join mcarteras C on ( B.ID_CARTERABENCH = C.ID_CARTERA )
              Join mcarteras_clases D on ( A.ID_CARTERACLASE = D.ID_CARTERACLASE )
              Join mcarteras_clasesesp E on ( A.ID_CARTERACLASE_ESP = E.ID_CARTERACLASE_ESP )
              Join dr_rent_clasesesp_anos F on ( A.F_ANO = F.F_ANO and E.ID_CARTERACLASE_ESP = F.ID_CARTERACLASE_ESP )
              Join dr_rent_clases_anos G on ( A.F_ANO = G.F_ANO and D.ID_CARTERACLASE = G.ID_CARTERACLASE )
              Join mcarteras H on ( A.ID_CARTERA = H.ID_CARTERA )
    where     A.ID_CARTERA = $ID_CARTERA
    And       A.IND_RENTABILIDAD = 1
    And       A.F_ANO = ( select  MAX(F_ANO ) - 9 from  dr_rent_carteras_anos  where ID_CARTERA = $ID_CARTERA ) ) j on ( a.ID_CARTERA = j.ID_CARTERA ) ) K

")
or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:25:40.163

您已使用大写 K 为最后一个子选择起别名，但在您选择的字段中，您有小 k

# asp.net-mvc - 在模型中构建网格列时的 Webgrid 和格式化 DateTime 值

> ID：13770374
> 
> 赞同：1
> 
> 时间：2012-12-07T20:18:23.793
> 
> 标签：asp.net-mvc, webgrid

我正在创建 WebGridColumns 的集合，将它们添加到我的模型中并将其传递给我的剃须刀页面。我这样做是因为动态确定了可变数量的列。这很好用，但现在我需要将日期时间值格式化为短日期，并且不确定在创建 webgridcolumns 集合时如何实现这一点。

```
 foreach (var datetimeitem in cols)
            {                    
                columns.Add(new WebGridColumn
                {   
                    ColumnName = datetimeitem,
                    Header = "MyHeader",
                    Format = **format item here**;

                });
            } 
```

有任何想法吗？

Ĵ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:13:20.177

你的设置看起来像这样吗？

```
@{
    var cols = new[] { "FirstDate", "SecondDate" };
    var columns = new List<WebGridColumn>();

    var grid = new WebGrid(new[]
    {
        new Entity { FirstDate = DateTime.Now, SecondDate = DateTime.Now },
        new Entity { FirstDate = DateTime.MinValue, SecondDate = DateTime.MinValue }
    });
} 
```

如果是这样，你可以试试

```
@foreach (var datetimeitem in cols)
{                    
    columns.Add(new WebGridColumn
    {   
        ColumnName = datetimeitem,
        Header = "MyHeader",
        // If item is already a date time
        Format = m => m[datetimeitem].ToShortDateString()
        // If you need to parse item as date time first
        // Format = m => DateTime.Parse(m[datetimeitem]).ToShortDateString()
    });
}

@grid.GetHtml(columns: columns) 
```

# android - 使用 JavaCV 和 FFmpeg 播放视频

> ID：13770376
> 
> 赞同：8
> 
> 时间：2012-12-07T20:18:26.587
> 
> 标签：android, video, ffmpeg, android-videoview, javacv

所以，我正在为 Android 开发一个自定义视频播放器，但我需要播放的不仅仅是 android 支持的视频文件`(mp4, 3gp...), like wmv, avi, flv.`

此时我已经将任何视频类型转换为 .mp4 并且我能够在重新编码后播放它们，但我不知道如何播放这些`wmv`文件`avi`而不将它们重新编码为`mp4`视频格式。

有什么方法可以在不重新编码的情况下在 Android 上播放任何视频？ `JavaCV`+`FFmpeg`库已经在工作，只是不知道该怎么做。

顺便说一句，这是我用来重新编码视频的代码：

```
public static void convert(File file) {

    FFmpegFrameGrabber frameGrabber =
            new FFmpegFrameGrabber(file.getAbsolutePath());

    IplImage captured_frame = null;

    FrameRecorder recorder = null;
    recorder = new FFmpegFrameRecorder("/mnt/sdcard/external_sd/videosteste/primeiroteste.mp4", 300, 300);
    recorder.setVideoCodec(13);
    recorder.setFrameRate(30);
    recorder.setFormat("mp4");
    try {
        recorder.start();
        frameGrabber.start();
        while (true) {
            try {
                captured_frame = frameGrabber.grab();

                if (captured_frame == null) {
                    System.out.println("!!! Failed cvQueryFrame");
                    break;
                }
                recorder.record(captured_frame);
            } catch (Exception e) {
            }
        }
        recorder.stop();
        recorder.release();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-14T04:07:56.160

首先创建 CanvasFrame，然后使用“canvas.showImage(captured_frame);” 而不是“recorder.record(captured_frame);”

这是代码：

```
public class GrabberShow implements Runnable 
{
    final static int INTERVAL=40;///you may use interval
    IplImage image;
    static CanvasFrame canvas = new CanvasFrame("JavaCV player");

    public GrabberShow() 
   {
        canvas.setDefaultCloseOperation(javax.swing.JFrame.EXIT_ON_CLOSE);
   }

    public static void convert(File file) 
    {

    FFmpegFrameGrabber frameGrabber = new FFmpegFrameGrabber(file.getAbsolutePath());

    IplImage captured_frame = null;

    FrameRecorder recorder = null;
    //recorder = new FFmpegFrameRecorder("/mnt/sdcard/external_sd/videosteste/primeiroteste.mp4", 300, 300);
    recorder = new FFmpegFrameRecorder("D://temp.mp4", 300, 300);
    recorder.setVideoCodec(13);
    recorder.setFrameRate(30);
    recorder.setFormat("mp4");
    try {
        recorder.start();
        frameGrabber.start();
        while (true) {
            try {
                captured_frame = frameGrabber.grab();

                if (captured_frame == null) {
                    System.out.println("!!! Failed cvQueryFrame");
                    break;
                }
                //recorder.record(captured_frame);
                canvas.showImage(captured_frame);
                Thread.sleep(INTERVAL);
            } catch (Exception e) {
            }
        }
        recorder.stop();
        recorder.release();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
@Override
public void run() 
{
    convert(new File("D://aes.mp4")); 
}

public static void main(String[] args) {
    GrabberShow gs = new GrabberShow();
    Thread th = new Thread(gs);
    th.start();
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-23T21:11:15.910

> 有什么方法可以在不重新编码的情况下在 Android 上播放任何视频？

为什么要录视频？？无需录制视频。JavaCv。

这是为您提供想法的示例代码，您可以如何实现它。

```
FrameGrabber grabber = new FrameGrabber(videoFile);
grabber.start();
BufferedImage image= null;
while((image=grabber.grab())!=null){
   // TODO set the image on the canvas or panel where ever you want. 
}
grabber.stop(); 
```

# .net - wpf 消息框与 winforms 消息框

> ID：13770378
> 
> 赞同：0
> 
> 时间：2012-12-07T20:18:37.940
> 
> 标签：.net, wpf, winforms

使用有什么好处吗

```
System.Windows.MessageBox.Show(); 
```

超过

```
System.Windows.Forms.MessageBox.Show(); 
```

除了您不必引用 WinForms 程序集（我必须这样做）并且您可以更轻松地设置父窗口（这没什么大不了的）之外？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:35:33.200

`System.Windows.MessageBox`来自 WPF，并且是[wpf](/questions/tagged/wpf "显示标记为“wpf”的问题")程序集 ( `PresentationFramework.dll`) 的一部分。

`System.Windows.Forms.MessageBox`来自[winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")，并且是[winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")程序集的一部分。

如果您的程序是[winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")，请使用`System.Windows.Forms.MessageBox`，否则请使用`System.Windows.Messagebox`(WPF)。

我很确定他们最终会使用相同的 API 调用。

# intellij-idea - IntelliJ Enterprise Plugin Repository - 插件的元数据不会显示

> ID：13770379
> 
> 赞同：1
> 
> 时间：2012-12-07T20:18:44.330
> 
> 标签：intellij-idea, intellij-plugin

我有几个专有的 IntelliJ 插件托管在企业存储库上。当我在 IntelliJ 的存储库浏览器中查看它们时，除了版本之外，元数据不显示。

（注意：其他插件都没有元数据） ![浏览存储库视图](../Images/e97c0f3e2b10d43d3cc2d61f124c2f12.png)

我在 my.enterprise.repository.com/updatePlugins.xml 托管这些插件，文件

```
<plugins>
  <plugin 
    id="Plugin 1" 
    url="http://my.enterprise.repository.com/Plugin1.jar" 
    version="12.001" />
  <plugin 
    id="Plugin 2" 
    url="http://my.enterprise.repository.com/Plugin2.jar" 
    version="12.001"/>
  <plugin 
    id="Plugin 3" 
    url="http://my.enterprise.repository.com/Plugin3.jar" 
    version="12.001"/>
  <plugin 
    id="Plugin 4" 
    url="http://my.enterprise.repository.com/Plugin4.jar" 
    version="12.001"/>
  <plugin 
    id="Plugin 5" 
    url="http://my.enterprise.repository.com/Plugin5.jar" 
    version="12.001"/>
</plugins> 
```

插件 5 的 plugin.xml 是

```
<idea-plugin version="2">
  <name>Plugin 5</name>
  <description>Is a cool plugin.</description>
  <version>12.001</version>
  <vendor>My Company</vendor>
  <idea-version since-build="8000"/>

  <application-components>
    <!-- Add your application components here -->
  </application-components>

  <project-components>
    <!-- Add your project components here -->
  </project-components>

  <extensions defaultExtensionNs="com.intellij">

    ...

  </extensions>
</idea-plugin> 
```

元数据是否在不同的文件中指定？还是我的 plugin.xml 文件有误？

注意：这些插件成功下载、安装和运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:37:27.997

这是一个已知问题，工作正在进行中。您可以在此处跟踪状态：

*   [IDEA-88075](http://youtrack.jetbrains.com/issue/IDEA-88075)企业/自定义插件存储库中的插件不显示插件详细信息

# javascript - Chrome 扩展程序，打开一个“隐藏”链接

> ID：13770380
> 
> 赞同：0
> 
> 时间：2012-12-07T20:18:47.180
> 
> 标签：javascript, html, json, google-chrome

这是我的试点代码：

```
function Addme(Test) {
  chrome.tabs.create({url: "http://www.mysite.com/sendinfo?i="+test});
} 
```

ETC...

我正在组建一个网站，该网站将*获取*用户的输入并通过**url query**将其发送到数据库。

在上面的**示例**代码中，它将通过查询将变量**test的内容发送到数据库中。**

我知道如何处理 html 部分（用户输入等），我不知道如何在不打开新标签或任何地方的情况下做到这一点。**最好的办法是让它静默进行**，这样就不会在用户每次想要注册某些东西时打扰他们。

有人知道摆脱这种情况的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:30:53.347

如果您使用带有`REST`API 的数据库，则可以使用`XMLHttpRequest()`发送 URL 查询而不会打扰/提醒用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T02:47:46.340

我这样做的方式：

```
var request = new XMLHttpRequest();
request.open('GET', 'http://localhost/test/index.php?sql='+Value, false);
request.send(); 
```

# objective-c - iOS 自定义单元格可扩展 - 索引 0 问题

> ID：13770384
> 
> 赞同：1
> 
> 时间：2012-12-07T20:19:16.690
> 
> 标签：objective-c, ios, uitableview, custom-cell

谢谢您的帮助。我有一个使用以下代码扩展的自定义单元格。但是，第一个单元格（索引 0）总是在 ViewControllers 启动时展开？

我错过了什么？您如何让它们在启动时全部未扩展，仅在选择时扩展。

非常感谢。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        CustomCellCell *cell;
        static NSString *cellID=@"myCustomCell";
        cell = [tableView dequeueReusableCellWithIdentifier:cellID];

        if (cell == nil) 
        {
            NSArray *test = [[NSBundle mainBundle]loadNibNamed:@"myCustomCell" owner:nil options:nil];
            if([test count]>0)
            {
                for(id someObject in test)
                { 
                    if ([someObject isKindOfClass:[CustomCellCell class]]) {
                        cell=someObject;
                        break;
                    }
                }
            }
        }

        cell.LableCell.text = [testArray objectAtIndex:[indexPath row]];
        NSLog( @"data testarray table %@", [testArray objectAtIndex:[indexPath row]]);
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
        return cell;
    }

    -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
        self.selectedRow = indexPath.row;
        CustomCellCell *cell = (CustomCellCell *)[tableView cellForRowAtIndexPath:indexPath];

        [tableView beginUpdates];
        [tableView endUpdates];

        cell.buttonCell.hidden = NO;
        cell.textLabel.hidden = NO;
        cell.textfiledCell.hidden = NO;
        cell.autoresizingMask = UIViewAutoresizingFlexibleHeight;
        cell.clipsToBounds = YES;
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

    - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
        if(selectedRow == indexPath.row) {
            return 175;
        }

        return 44;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:22:55.170

那是因为默认值为`selectedRow`0。您需要将其初始化为，

```
selectedRow = NSIntegerMax; //or selectedRow = -1; 
```

或其他一些默认值。您可以在`viewDidLoad`方法中添加它。每当您声明一个 int 类型变量时，它的默认值为零。因此，如果您有需要检查零的情况，例如在上述情况下，您应该将其默认为一个根本不会使用的值。要么是负值，要么`NSIntegerMax`可以用于此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:25:13.877

我猜 selectedRow 是一个整数实例变量。该整数以 0 值开始生命。由于第一个表格单元格是第 0 行，因此即使您没有有意设置它，它也会匹配 selectedRow。

解决此问题的一种方法是将 selectedRow 存储为 NSIndexPath 而不是整数。

然后你可以这样做：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if([selectedRow isEqual:indexPath]) {
        return 175;
    }
    return 44;
} 
```

而且因为 selectedRow 将默认为 nil，所以您不会得到错误的匹配。如果您决定稍后使用部分，它也会更加灵活。

# linq - 获取数据 自引用

> ID：13770385
> 
> 赞同：0
> 
> 时间：2012-12-07T20:19:17.003
> 
> 标签：linq, entity-framework

我有一个自我参考模型。我想用 linq 获取数据。我想在状态正常时返回数据。但如果父状态正常，则所有子状态都返回正常或待处理或已删除。我怎样才能做到这一点。

```
var model = _efComment.List(p => p.PostId == postId);
        var list = model.ToList()
            .Where(p => p.ComentStatus == ComentStatus.Ok)
            .Where(x => x.Reply == null)
            .ToList();using System.Collections.Generic; 
```

* * *

```
using System.ComponentModel.DataAnnotations.Schema;
using DomainModel.Classes;

namespace DomainModel
{
    public class Comment : BaseFieldsTables
    {
        public string Content { get; set; }
        public string WriterName { get; set; }
        public string WriterEmail { get; set; }
        public string WriterWebsite { get; set; }

        public int PostId { get; set; }

        [ForeignKey("PostId")]
        public Post Post { get; set; }

        public Comment Reply { set; get; }

        public int? ReplyId { get; set; }
        public ICollection<Comment> Children { get; set; }
        public ComentStatus ComentStatus { get; set; }
    }
}
namespace DomainModel
{
    public enum ComentStatus
    {
        Ok = 1,
        Pending = 2,
        Deleted = 3
    }
} 
```

# php - 如何处理 wordpress 插件设置页面中的表单？

> ID：13770387
> 
> 赞同：0
> 
> 时间：2012-12-07T20:19:19.153
> 
> 标签：php, javascript, html, wordpress, content-management-system

我想创建自己的插件，但我不知道如何处理表单。

例如，我有来自 twitter-stream 插件设置页面的代码：

```
<form action="<?php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI']); ?>" method="post">
    <label for="consumerkey" style="font-weight:bold;display:block;width:150px;">Consumer Key:</label> <input type="text" value="" id="consumerkey" name="consumerkey" />
    <label for="consumersecret" style="font-weight:bold;display:block;width:150px;margin-top:5px;">Consumer Secret:</label> <input type="text" value="" id="consumersecret" name="consumersecret" />
    <input type="submit" value="Save" style="display:block;margin-top:10px;" />
</form> 
```

我无法理解这一点：

```
action="php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI'])" 
```

我读过很多关于 PHP 的书，但只看到了这个：

```
action="somescript.php" for the URL. 
```

我只是不知道将处理我的表单的代码放在哪里。

我可以将我的代码放在插件的 php 文件中（称为`scheduler.php`，位于`wordpress/wp-content/plugins/scheduler/scheduler.php`）吗？

另外，请向我展示一些如何在 wordpress 中处理表单的示例。

顺便说一句，我的设置页面上只需要两个字段：用户名和密码，当管理员按下提交按钮时，我希望字段的内容存储在数据库中。

我仍然无法理解如何

```
action="php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI'])" 
```

被转换为

```
action="/sheduled/wp-admin/options-general.php?page=twitterstreamauth" 
```

对不起，我的英语不是很好。非常感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T21:28:22.453

通过谷歌搜索`%7E`，我发现它是 Unix 中的保留代码，代表一个波浪号 (~)。因为很多服务器运行 Unix 操作系统，所以不能使用符号`%7E`。`~`但是，您可以使用可用于网址或页面某处的符号。

`php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI'])``$_SERVER`从名为`REQUEST_URI`. 然后它用 替换每一次`%7E`出现`~`。在大约 99% 的情况下，不会替换任何符号，但网址中仍有可能出现波浪号。这很简单，但`echo`与编辑后的字符串相呼应。

在这种情况下，字符串`/sheduled/wp-admin/options-general.php?page=twitterstreamauth`由 . 返回`$_SERVER['REQUEST_URI']`，未找到该符号，`%7E`因此该字符串只是回显到 html 代码中。

这`action="..."`是提交表单时浏览器需要执行的操作，在这种情况下打开文件`options-general.php?page=twitterstreamauth`

此外，如果您不知道如何将表单的内容存储到数据库中，那么您就没有阅读足够多的 PHP 书籍。您需要学习 PHP + MySQL 才能将某些内容存储在数据库中。

我希望这可以帮助您更好地理解代码。

# c# - 分配公式

> ID：13770390
> 
> 赞同：0
> 
> 时间：2012-12-07T20:19:36.333
> 
> 标签：c#, algorithm, math, mathematical-optimization

我有汽车维修服务店，有很多服务（诊断，发动机维修。电气维修......）序列守恒无关紧要

然后我知道一辆当前的汽车需要多少时间进行单一服务，例如：

1.  福特 - 诊断 120 分钟，发动机 360 分钟，电动维修 80 分钟
2.  BMW - 诊断时间 90 分钟，发动机 480 分钟，电动维修 140 分钟
3.  梅赛德斯 - 诊断 90 分钟，发动机 42 分钟，电动维修 160 分钟

等等，还有很多汽车。

那么是否有任何好的算法或数学公式可以将汽车最佳地分配到服务箱中，这样就不会浪费箱子的时间并以最少的汽车等待获得最佳结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:42:13.280

这是所谓的“开放式商店”问题的一个例子。与 Job Shop Scheduling 的区别在于，在后者中，在机器上执行作业的顺序是相关的，而在您的示例中并非如此。

不幸的是，对于您的情况，问题是 NP 困难。（对于两台机器可以在多项式时间内解决。）不必绝望，因为有许多算法可能对您的问题大小适用。

Wikipedia 在“Open-Shop Scheduling”下有几个很好的起点，参考了该领域的一篇经典论文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:27:40.257

您的问题称为“作业车间调度”问题，有时也称为“车间调度”。它被广泛讨论，因为随着变量数量的增加它变得非常困难（这就是所谓的“NP-Hard”问题）。

没有简单的答案，但是有几种很好的算法可以在计算时间上追求交易准确性。我建议将Dorit Hochbaum 编辑的“ [NP-Hard Problems 的近似算法](https://rads.stackoverflow.com/amzn/click/com/0534949681)”一书作为资源。

# ipython-notebook - 制作像 Markdown 这样的输出单元格

> ID：13770394
> 
> 赞同：18
> 
> 时间：2012-12-07T20:19:52.313
> 
> 标签：ipython-notebook

我喜欢 IPython 的 Markdown 单元格，用于在笔记本中合并 HTML 和其他丰富的内容。我想知道命令输出是否可以在输出单元格中进行类似的格式化。

这是我输出 HTML 的函数之一：

```
 print_html():
      print """
      <h2>Matplotlib's chart gallery (Click a chart to see the code to create it)</h2><br>
      <div align="center"> <iframe title="Matplotlib Gallery" width="950"
      height="250" src="http://matplotlib.org/gallery.html#api" frameborder="0"
      allowfullscreen></iframe></div>
    """ 
```

上面的 HTML 代码，如果放在 markdown（输入）单元格中，会生成到 Matplotlib 库的很好的链接。但在输出单元格中，它只是纯文本。有什么办法让它丰富的内容？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-07T20:43:59.007

在这里找到了解决方案：http: [//mail.scipy.org/pipermail/ipython-user/2012-April/009838.html](http://mail.scipy.org/pipermail/ipython-user/2012-April/009838.html)

在此处引用解决方案以供参考：

布赖恩格兰杰：

" 让函数返回包装在 HTML 对象中的原始 HTML：

```
from IPython.core.display import HTML
...
...
def foo():
    raw_html = "<h1>Yah, rendered HTML</h1>"
    return HTML(raw_html) 
```

"

现在调用 foo() 确实可以提供我想要的丰富格式的 html。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-24T02:07:46.317

最近在此处的博客文章中发布了一种更高级的解决方案：

[http://guido.vonrudorff.de/ipython-notebook-code-output-as-markdown/](http://guido.vonrudorff.de/ipython-notebook-code-output-as-markdown/)

它创建并注册了一个新的 IPython 魔法`%%asmarkdown`。您使用此命令添加的每个代码单元的输出将像纯降价单元一样呈现。使用原始问题的内容，以下行为将按预期进行：

```
%%asmarkdown
print """
<h2>Matplotlib's chart gallery (Click a chart to see the code to create it)</h2><br>
<div align="center"> <iframe title="Matplotlib Gallery" width="950"
height="250" src="http://matplotlib.org/gallery.html#api" frameborder="0"
allowfullscreen></iframe></div>
""" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-26T06:56:34.653

只需在您的代码示例中添加一些额外的功能

```
htmlContent = ''

def header(text):
    raw_html = '<h1>' + str(text) + '</h1>'
    return raw_html

def box(text):
    raw_html = '<div style="border:1px dotted black;padding:2em;">'+str(text)+'</div>'
    return raw_html

def addContent(raw_html):
    global htmlContent
    htmlContent += raw_html

# Example
addContent( header("This is a header") )
addContent( box("This is some text in a box") )

from IPython.core.display import HTML
HTML(htmlContent) 
```

给你这个：

![输出](../Images/556e049de5df34808ef63f9464c1767a.png)

# jquery - 将 this.id 作为输入并输出更改后的 id 以输入新函数

> ID：13770400
> 
> 赞同：0
> 
> 时间：2012-12-07T20:20:18.527
> 
> 标签：jquery

我有一个管理子菜单的 jQuery 脚本。当用户单击一个 div 时，该 div 变为活动状态，然后内容相应地改变颜色。这些按钮有一个与相应的 div 标签相同的 id 标签，并添加了“_button”。例如，要更改颜色的 div 具有 id 标签 'first'，然后按钮 id 标签是 'first_button'。

我现在的代码适用于按钮，但我不确定如何正确插入编辑后的 ​​id 标记以选择适当的 div 以使用第二个 jQuery 调用变为红色。现在代码对 div 没有任何作用，但我也没有在控制台中收到任何错误。我可以用一系列 if/then 语句来做到这一点，但这很不优雅。

```
$('.port_menu_button').click(function() {
    $('.port_menu_button').removeClass('active');
    $(this).addClass('active');;
    $('.port_type').css('color', '#000');
    $($(this).attr('id').replace('_button', '')).css('color', 'red'); //this is the problem line. how do I take the id and put it in here?
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:30:38.217

这应该适合你：

```
var current_id = $(this).attr('id');
var other_id = current_id + '_button';

$('#' + other_id).css('color', 'red'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:24:15.700

您只需要添加 id 选择器即可`$('#' + yourid)`

```
$('#' + this.id.replace('_button', '')).css('color', 'red'); 
```

# c# - 在 EnvDTE 中重新加载卸载的项目

> ID：13770409
> 
> 赞同：7
> 
> 时间：2012-12-07T20:21:08.697
> 
> 标签：c#, projects-and-solutions, envdte

我已经使用 EnvDTE 列出了我的解决方案中的所有项目，但我在代码中发现了一个错误：我无法获取已卸载的项目。

我找到了一种跳过卸载项目的方法：

```
if (string.Compare(EnvDTE.Constants.vsProjectKindUnmodeled, project.Kind, System.StringComparison.OrdinalIgnoreCase) == 0)
  continue; 
```

这样，我的代码不会崩溃——但我无法通过代码加载缺失的项目，因为它们已经存在。

如何将卸载的项目加载到解决方案中？

我努力了：

```
project.DTE.ExecuteCommand("Project.ReloadProject"); 
```

并得到错误：

System.Runtime.InteropServices.COMException (...)：命令“Project.ReloadProject”不可用。

所以我试图以某种方式得到

```
application.DTE.ExecuteCommand("Project.ReloadProject"); 
```

但在此之前，从我在 NET 上搜索的每个地方，我必须预先选择解决方案中的项目——为此，我需要`project.Name`（我有）和我不需要的路径（我有的每个示例found 假设解决方案路径与项目路径相同，这在一般情况下是极不可能的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T21:08:57.820

Visual Studio SDK 显然是做到这一点的方法。

```
var dte = (EnvDTE.DTE)System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE");
Microsoft.VisualStudio.Shell.Interop.IVsUIHierarchyWindow hierarchy;
ServiceProvider sp = new ServiceProvider((Microsoft.VisualStudio.OLE.Interop.IServiceProvider)dte);
IVsSolution sol = (IVsSolution)sp.GetService(typeof(SVsSolution));

foreach (ProjInfo info in GetProjectInfo(sol))
{
    info.Dump();

}
//from http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/60fdd7b4-2247-4c18-b1da-301390edabf3/
static IEnumerable<ProjInfo> GetProjectInfo(IVsSolution sol)
{
  Guid ignored = Guid.Empty;
  IEnumHierarchies hierEnum;
  if (ErrorHandler.Failed(sol.GetProjectEnum((int)__VSENUMPROJFLAGS.EPF_ALLPROJECTS, ref ignored, out hierEnum)))
  {
    yield break;
  }

  IVsHierarchy[] hier = new IVsHierarchy[1];
  uint fetched;
  while ((hierEnum.Next((uint)hier.Length, hier, out fetched) == VSConstants.S_OK) && (fetched == hier.Length))
  {
    int res = (int)VSConstants.S_OK;

    Guid projGuid;
    if (ErrorHandler.Failed(res = sol.GetGuidOfProject(hier[0], out projGuid)))
    {
        Debug.Fail(String.Format("IVsolution::GetGuidOfProject returned 0x{0:X}.", res));
        continue;
    }

    string uniqueName;
    if (ErrorHandler.Failed(res = sol.GetUniqueNameOfProject(hier[0], out uniqueName)))
    {
        Debug.Fail(String.Format("IVsolution::GetUniqueNameOfProject returned 0x{0:X}.", res));
        continue;
    }
    if( System.IO.Path.GetInvalidPathChars().Any (p =>uniqueName.Contains(p) ))
    {
        uniqueName.Dump("invalid filename found");
        yield return new ProjInfo(projGuid,uniqueName);
    } 
    else {
        yield return new ProjInfo(projGuid, Path.GetFileName(uniqueName).BeforeOrSelf("{"));
    }
  }
} 
```

大部分来自[http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/60fdd7b4-2247-4c18-b1da-301390edabf3/](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/60fdd7b4-2247-4c18-b1da-301390edabf3/)

# android - 不同设备的相同ROM有什么区别？

> ID：13770417
> 
> 赞同：0
> 
> 时间：2012-12-07T20:21:53.827
> 
> 标签：android, operating-system, porting, cyanogenmod, hal

## **例如，谁能给出一些具体的例子来说明三星 i9100g 的 Cyanogen Mod 10 和 i9100 的 CM 10 之间的区别？**

据我所知，他们有不同的硬件，这就是他们的驱动程序不同的原因，因此他们的 HAL 与其他的非常不同。但是，我希望有一个示例包含 - 可能 - 几行代码。

我知道有很多人想要进入 Android 移植/开发并且不知道如何开始修改/更改什么，我就是其中之一。我认为这个问题的答案将对这些人有益。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:57:26.757

最大的将是内核和 RIL（无线电接口层）。

不同的设备有不同的硬件。不同的硬件需要不同的驱动程序。如果您有两台类似的设备，通常只需稍作修改即可在同级设备上运行一个操作系统。然而，即使是*外观*相同的硬件也可能具有截然不同的内部结构。

如果您想进入平台开发，请关注一些这样做的人并查看他们正在做的事情。 [jt1134](https://github.com/jt1134)为三星设备做了很多内核和平台开发。[CyanogenMod 组织](https://github.com/CyanogenMod)也有很多值得一看的代码，该团队甚至有一个[wiki](http://wiki.cyanogenmod.org/wiki/Building_from_source)，其中介绍了有关从源代码构建的一些更详细的细节。

您还应该坐在 Freenode 和 Mod-a-droid 服务器上的 Android 开发 IRC 房间里。您可以提出问题，但并不总是期望得到答案。您甚至可以在 freenode 上尝试 PMing jt1134（如果他仍然在那里闲逛），如果您可以说服他您知道自己在做什么 << 就像首先阅读所有公开可用的文档一样，他会非常敏感。

这是您需要遵循的过程的概述。

里程碑：

0.5。设置开发环境[http://source.android.com/source/initializing.html](http://source.android.com/source/initializing.html)

1.  [从 Samsung](http://opensource.samsung.com/)下载内核源代码。
2.  编译 Linux 内核。
3.  [浏览source.android.com](http://source.android.com/index.html)上的所有开发人员文档
4.  [从googlesource](https://android.googlesource.com/)下载 Android 平台源代码。
5.  进行设备所需的任何修改（例如：您可能需要设备的特定供应商文件（驱动程序），您可能需要一些自定义初始化脚本等）。
6.  编译android平台<--这需要很长时间

在此之后，您应该拥有可以在您的设备上测试的 Android 开源项目的 OTA 可闪存副本。这个过程花了我大约一个月的时间研究下来，这不是一件容易的事，祝你好运。

# perl - CGI.pm 标头函数调出下载对话框

> ID：13770421
> 
> 赞同：1
> 
> 时间：2012-12-07T20:22:02.410
> 
> 标签：perl, cgi

我需要从我的 cgi perl 脚本中调出一个下载对话框。

这就是我所拥有的

```
use CGI qw/:standard/;

print header(-type=>'text/xml',-charset=>'UTF-8');
print header(-'Content-Disposition'=>'attachment; filename="FileName"');
print "<root></root>"; 
```

内容处置有问题。我无法让它工作。

# asp.net - 我无法使用 ASP.Net 3.5 中的 NHibernate sessionfactory 对象从我的数据库中获取任何数据

> ID：13770422
> 
> 赞同：0
> 
> 时间：2012-12-07T20:22:07.543
> 
> 标签：asp.net, nhibernate, configuration, sessionfactory

我已经检查了我可以使用常规 C# 连接并从数据库获取数据，我可以。但是，当我尝试通过 session/sessionfactory 从我的数据库中提取数据时，我什么也得不到。我是新手，我怀疑这对于经验丰富的专业人士来说很容易解决，但我一直在研究并且不知所措。这是我的代码：（在 hibernate.cfg.xml 中，出于隐私原因更改了服务器名称、用户名和密码）：

## 休眠.cfg.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2" >
  <session-factory >
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="connection.driver_class">NHibernate.Driver.OracleClientDriver</property>
    <property name="connection.connection_string">Data Source=NAME;User Id=USERID;Password=USERID;Integrated Security=no;</property>
    <property name="show_sql">true</property>
    <property name="dialect">NHibernate.Dialect.Oracle10gDialect</property>
  </session-factory>
</hibernate-configuration> 
```

## 枚举表.hbc.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="DataTransfers" namespace="DataTransfers">
<class name="DataTransfers.EnumsTable, DataTransfers"  table="TIME_LOG_ENUMS" >
<id column="ENUM_ID_PK" name="ENUM_ID_PK" type="Byte[]" unsaved-value="0">
<generator class="native"></generator>
</id>
<property name="ENUM_NAME" column="ENUM_NAME" type="string" length="100" not-null="false"/>
</class>
</hibernate-mapping> 
```

## 枚举表.cs

```
namespace DataTransfers
{
public class EnumsTable
{
private Byte[] enum_id_pk {get; set;}
private string enum_name { get; set;}
}
} 
```

## 网页配置

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                    <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
                    <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="hibernate-configuration" type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate"/>
                </sectionGroup>
            </sectionGroup>
        </sectionGroup>
    </configSections>
    <appSettings>
        <add key="DATA_SOURCE" value="serverName"/>
        <add key="PROVIDER" value="NONE"/>
        <add key="DBTYPE" value="Oracle"/>
        <add key="PERFORMANCE" value="High"/>
        <add key="PASSWORD" value="password"/>
        <add key="USERID" value="username"/>
        <add key="CrystalImageCleaner-AutoStart" value="true"/>
        <add key="CrystalImageCleaner-Sleep" value="60000"/>
        <add key="CrystalImageCleaner-Age" value="120000"/>
    </appSettings>
    <connectionStrings/>
    <system.web>
        <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.
        -->
        <compilation debug="true">
            <assemblies>
                <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            </assemblies>
        </compilation>
        <!--
            The <authentication> section enables configuration 
            of the security authentication mode used by 
            ASP.NET to identify an incoming user. 
        -->
        <authentication mode="Windows"/>
        <!--
            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
        -->
        <pages>
            <controls>
                <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </controls>
        </pages>
        <httpHandlers>
            <remove verb="*" path="*.asmx"/>
            <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
        </httpHandlers>
        <httpModules>
            <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </httpModules>
    </system.web>
    <system.codedom>
        <compilers>
            <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="WarnAsError" value="false"/>
            </compiler>
        </compilers>
    </system.codedom>
    <!-- 
        The system.webServer section is required for running ASP.NET AJAX under Internet
        Information Services 7.0\.  It is not necessary for previous version of IIS.
    -->
    <system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
        <modules>
            <remove name="ScriptModule"/>
            <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </modules>
        <handlers>
            <remove name="WebServiceHandlerFactory-Integrated"/>
            <remove name="ScriptHandlerFactory"/>
            <remove name="ScriptHandlerFactoryAppServices"/>
            <remove name="ScriptResource"/>
            <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </handlers>
    </system.webServer>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime>
</configuration> 
```

## 默认.aspx.cs

```
namespace PresentationLayer
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {
                //open a session
                NHibernate.Cfg.Configuration config = new NHibernate.Cfg.Configuration();
                config.Configure();
                //config.AddAssembly("DataTransfers");
                ISessionFactory sessionFactory = config.BuildSessionFactory();
                ISession session = sessionFactory.OpenSession();
                IList enumIds = session.CreateCriteria(typeof(EnumsTable)).List();
                ddlEnumsIds.DataSource = enumIds;
                ddlEnumsIds.DataTextField = "enum_name";
                ddlEnumsIds.DataValueField = "enum_id_pk";
                ddlEnumsIds.DataBind();
                session.Close();

            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T15:47:28.363

您的 xml 似乎不包含任何休眠配置信息。我看不到提供者信息或连接信息。配置部分应如下所示

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
      <property name="connection.provider">
        NHibernate.Connection.DriverConnectionProvider
      </property>
      <property name="dialect">
        NHibernate.Dialect.Oracle10gDialect
      </property>
      <property name="connection.driver_class">
        NHibernate.Driver.OracleDataClientDriver
      </property>
      <property name="connection.connection_string">
        User Id=oe;
        Password=oe;
        Data Source=YOUR_TNS;
        Pooling=true;
        Enlist=false;
        Statement Cache Size=50;
        Min Pool Size=10;
        Incr Pool Size=5;
        Decr Pool Size=2;
      </property>
      <property name="show_sql">
        true
      </property>
      <mapping assembly="NhbHelper"/>
    </session-factory>
  </hibernate-configuration> 
```

新版本的 NHibernate 的优点之一是 loqacious 映射和流畅的配置。它使 NHibernate 变得轻而易举。该代码看起来像这样

```
 Configure = new Configuration();
    Configure.SessionFactoryName(System.Configuration.ConfigurationManager.AppSettings["SessionFactoryName"]);
        Configure.DataBaseIntegration(db =>
                                      {
                                        db.Dialect<Oracle10gDialect>();
                                        db.Driver<OracleDataClientDriver>();
                                        db.KeywordsAutoImport = Hbm2DDLKeyWords.AutoQuote;
                                        db.IsolationLevel = IsolationLevel.ReadCommitted;
                                        db.ConnectionStringName = System.Environment.MachineName;
                                        db.BatchSize = 20;
                                        db.Timeout = 10;
                                        db.HqlToSqlSubstitutions = "true 1, false 0, yes 'Y', no 'N'";
                                      });
    Configure.SessionFactory().GenerateStatistics();

        Map(); 
```

还要看看 Oracle 方言。在 Oracle 中以 RAW(16) 形式支持 Guid。因此，您似乎需要更改该字段的映射。

# javascript - 当用户试图离开页面时，有没有办法编写一些 javascript 功能？

> ID：13770425
> 
> 赞同：0
> 
> 时间：2012-12-07T20:22:22.127
> 
> 标签：javascript, jquery, web-applications

我试图弄清楚如果用户试图离开您的网站，是否有办法执行脚本。

当您被问一百万次是否要离开站点时，我并没有想到恶意，但更多的是执行 ajax 请求以保存数据。

如果在他们试图离开时可以做到这一点，也许他们也可以在点击后退按钮时做到这一点？

如果当前有一些有用的东西。当他们在其他地方导航时，最后一次尝试在页面上保存数据会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T20:24:16.153

卸载事件是针对那个 [http://api.jquery.com/unload/](http://api.jquery.com/unload/)

```
$(window).unload(function() {
  alert('Handler for .unload() called.');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T20:24:01.533

你想要`window.onbeforeunload`：[https](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload) ://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload或`window.onunload`：[https ://developer.mozilla.org/en-US/docs/DOM/window.onunload](https://developer.mozilla.org/en-US/docs/DOM/window.onunload)

使用这些可能有点棘手，但它们是您唯一（合理）的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:24:41.023

```
jQuery(window).on(
    "beforeunload", 
    function() { 
        return confirm("Do you really want to close?") 
    }
) 
```

# php - PHP SSH按模式分块读取文件

> ID：13770428
> 
> 赞同：2
> 
> 时间：2012-12-07T20:22:26.947
> 
> 标签：php, file, ssh

我有一个 PHP 脚本，它接受用户提供的字符串，然后通过 SSH 连接到远程服务器，将文件读入数组，然后解析出包含字符串的请求/响应块以返回给用户。

此实现不适用于大型日志文件，因为 PHP 在尝试将整个文件存储在数组中时会耗尽内存。

示例数据：

```
*** REQUEST

request line 1
request line 2
request line 3
[...]

*** RESPONSE

response line 2
response line 2
response line 3
[...]
[blank line] 
```

请求和响应的长度各不相同，所以我永远无法确定会有多少行。

如何在不将整个文件存储在内存中的情况下分块读取文件，同时仍确保始终能够处理来自日志的完整请求/响应数据块而不截断它？

我觉得我对此非常敏感，因为我的经验通常是处理整个文件或数组。

这是我当前的代码（$search 代表我们在日志中查找的用户提供的字符串），它首先将整个文件放入一个数组中：

```
$stream = ssh2_exec($ssh, $command);
stream_set_blocking($stream, true);
$data = '';
while($buffer = fread($stream, 4096)) {
    $data .= $buffer;
}
fclose($stream);
$rawlog = $data;

$logline = explode("\n",$rawlog);
reset($logline);
$block='';

foreach ( $logline as $k => $v ) {
    if ( preg_match("/\*\*\* REQUEST",$v) && $block != '') {
        if ( preg_match("/$search/i",$block) ) {
            $results[] = $block;
        }
        $block=$v . "\n";
    } else {
        $block .= $v . "\n";
    }
}
if ( preg_match("/$search/i",$block) ) {
    $results[] = $block;
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T02:05:33.257

很难说这是否适合您，但如果日志在文件中，您可以使用[phpseclib 的 SFTP 实现](http://phpseclib.sourceforge.net)（最新的 Git 版本）。

例如。

如果您这样做`$sftp->get('filename.ext', false, 0, 1000)`，它将从 filename.ext 下载字节 0-1000 并返回包含这些字节的字符串。如果你这样做`$sftp->get('filename.ext', false, 1000, 1000)`，它将下载字节 1000-2000。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T12:19:10.080

您可以使用 tail 之类的命令来获取从 0 到 99、从 100 到 199 等的行。这将需要更多 ssh 命令，但不需要您将所有结果存储在内存中。

或者，您可以先将所有输出存储到本地文件中，然后对其进行解析。

# c# - EntityTypeConfiguration 和 EntityConfiguration 之间的区别

> ID：13770432
> 
> 赞同：0
> 
> 时间：2012-12-07T20:22:55.950
> 
> 标签：c#, entity-framework

`EntityTypeConfiguration`和有什么区别`EntityConfiguration`。两者都用于实体配置和映射。那么差异在哪里呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:24:30.020

这些类之间没有概念上的区别。EntityConfiguration 类在 EF4.1 中被重新设计并重命名为 EntityTypeConfiguration。

# linux - 有没有办法从 Linux shell 写入 Google 文档电子表格？

> ID：13770436
> 
> 赞同：7
> 
> 时间：2012-12-07T20:23:26.793
> 
> 标签：linux, shell, google-drive-api, google-docs, google-docs-api

我有一个每天将一些数据导出到 CSV 的 cron 作业。是否可以从 Linux shell（Ubuntu）直接将此数据写入 Google 文档（电子表格）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T20:37:17.420

为此，您拥有[Google Documents List API](https://developers.google.com/google-apps/documents-list/)

[从 Python 脚本写入 Google 电子表格中的](http://www.mattcutts.com/blog/write-google-spreadsheet-from-python/)示例代码

# php - 我没有在数组中找到任何东西......为什么？

> ID：13770437
> 
> 赞同：1
> 
> 时间：2012-12-07T20:23:30.443
> 
> 标签：php, sql

我正在查询数据库以返回员工编号，以便我可以使用它来验证表单中的条目。我将结果转储到一个数组中，然后当有人在表单上输入一个数字时，我验证它是否存在......但它不起作用并且永远找不到数字。我认为这是我创建数组的方式。

```
$sql1 = "SELECT num FROM staff";
$data = array();
     $result1 = mysql_query($sql1, $conn) or die("db select error: " . $sql1);
      while($row1 = mysql_fetch_assoc($result1)){
          $data[]= $row1;
      }
var_dump($data);

$needle = 7034252;
if(in_array($needle,$data) )
   echo $needle . " found";
else
   echo $needle . " not found"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:29:49.020

$data 是一个多维数组，尽管 in_array 需要一个一维数组。你的意思：

```
$sql1 = "SELECT num FROM staff";
$data = array();
     $result1 = mysql_query($sql1, $conn) or die("db select error: " . $sql1);
      while($row1 = mysql_fetch_assoc($result1)){
          $data[]= $row1['num'];
      }
var_dump($data);

$needle = 7034252;
if(in_array($needle,$data) )
   echo $needle . " found";
else
   echo $needle . " not found"; 
```

不过，这段代码可能更短（更高效）：

```
$needle = 7034252;
$sql = "SELECT COUNT(*) FROM staff WHERE num = " . mysql_real_escape_string($needle);
if (mysql_result(sql, 0) > 0)
   echo $needle . " found";
else
   echo $needle . " not found"; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T20:30:10.957

没有测试，但你为什么不尝试这样的事情呢？

```
$sql1 = "SELECT num FROM staff";
$result1 = mysql_query($sql1, $conn) or die("db select error: " . $sql1);
$needle = 7034252;
while($row1 = mysql_fetch_assoc($result1))
{
   if ($needle == $row1['num'])
   {
      echo $needle . " found";
   }
} 
```

# tomcat - 将 gradle 项目部署到 tomcat 服务器

> ID：13770438
> 
> 赞同：1
> 
> 时间：2012-12-07T20:23:44.890
> 
> 标签：tomcat, deployment, gradle

我有一个 gradle 项目，并且在我正在处理该项目时，我想部署到我拥有的现有 tomcat 实例。该 tomcat 服务器上还有其他我需要集成的东西。看起来 gradle tomcat 插件部署到嵌入式版本，但是有没有办法部署到独立的 tomcat 实例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:38:25.063

您可以尝试使用[Cargo 插件](https://github.com/bmuschko/gradle-cargo-plugin)，它允许您部署到本地和远程 Tomcat 容器。该文档有一个完整的 Tomcat 示例，因此您应该能够轻松进行此设置。

# javascript - JS 中的语法错误

> ID：13770450
> 
> 赞同：0
> 
> 时间：2012-12-07T20:24:36.437
> 
> 标签：javascript, jquery, wordpress

我使用了一个自定义 js，它在小提琴中编码，我想将它集成到我的 wordpress 主题中：我使用了如下的注册和入队脚本，它们似乎正在正确加载，但它是 custom.js似乎出错了。

如果我错过了标签或我被卡住的东西，请有人告诉我。以下是我的代码： -

/***我的函数文件***/

```
<?php
if (!is_admin()) add_action("wp_enqueue_scripts", "my_jquery_enqueue", 11);
function my_jquery_enqueue() {
wp_deregister_script('jquery');
wp_register_script('jquery', "http" . ($_SERVER['SERVER_PORT'] == 443 ? "s" : "") ."://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js", false, null);
wp_enqueue_script('jquery');

wp_register_script( 'jquery-ui', get_template_directory_uri().'/js/jquery-ui.min.js', array('jquery'), true );
wp_enqueue_script( 'jquery-ui' );

wp_register_script( 'custom', get_template_directory_uri().'/js/custom.js', array('jquery-ui'), true );
wp_enqueue_script( 'custom' );
}
?> 
```

/***我的自定义JS文件**** /

```
$(document).ready(function() {  
$("h1, h2").on('click', function (e) {
e.preventDefault();
$(this).effect( "bounce", { times : 2, direction : "down", distance : "3" }, 200)
}); 
```

谢谢你，科斯蒂

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:26:06.520

您忘记关闭您的文档。准备好

```
$(document).ready(function() {
    $("h1, h2").on('click', function(e) {
        e.preventDefault();
        $(this).effect("bounce", {
            times: 2,
            direction: "down",
            distance: "3"
        }, 200);
    });
});​ 
```

# tomcat - 了解运行 solr 的最大线程数

> ID：13770452
> 
> 赞同：0
> 
> 时间：2012-12-07T20:24:40.847
> 
> 标签：tomcat, solr, lucene

我在 16 核的 Ubuntu 机器上通过 tomcat 运行 solr。我观察到有 30 个线程活着。我怎么知道我是否真的需要这么多线程？以及在哪里将其修改为少量？我需要进行修改吗？我在网上没有找到任何关于此的信息。谢谢！

# c# - ASP.net 从 Site.Master.cs 类调用 Default.aspx.cs 中的函数

> ID：13770463
> 
> 赞同：2
> 
> 时间：2012-12-07T20:25:49.717
> 
> 标签：c#, asp.net, visual-studio, web-applications

因此，在我的 Default.aspx 页面上，我在 page_load 上填充了几个列表框。

但是，如果用户更改了这些列表框并想要恢复原始设置，我希望在顶部有一个按钮（在 Site.Master 中定义）来调用相同的函数 gain 以恢复原始值。

如何从 Site.Master 文件中获取对 _Default 对象实例的引用？有没有办法全局访问第一次加载页面时调用的 _Default 实例？还是我需要手动将其存储在某个地方？

例如：

默认.aspx.cs：

```
namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            setConfigurationData();
        }

        public void setConfigurationData()
        {
            //Do stuff to elements on Default.aspx 
```

站点.Master.cs

```
namespace WebApplication1
{
    public partial class SiteMaster : System.Web.UI.MasterPage
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void RefreshMenu1_MenuItemClick(object sender, MenuEventArgs e)
        {
            //Need to call this function from an instance of _Default, but I don't know
            //how to retrive this or save it from when it is first created

            //_Default.setConfigurationData(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:37:57.373

将此类作用域变量添加到您的母版页

```
private System.Web.UI.Page currentContentPage = new System.Web.UI.Page(); 
```

然后将此方法添加到您的母版页

```
public void childIdentity(System.Web.UI.Page childPage)
{
    currentContentPage = childPage;
} 
```

现在在默认页面的 Page_Load 中添加

```
SiteMaster masterPage = Page.Master as SiteMaster;
masterPage.childIdentity(this); 
```

现在，您的母版页应该能够通过其 currentContentPage 变量中的引用访问 Default 页面上的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:30:11.147

使用名为`setConfigurationData`. 然后在您的母版页中，将该`Page`对象转换为您的基类并调用您的方法。

```
public class MyBasePage : Page
{
    public virtual void setConfigurationData()
    {
        //Default code if you want it
    }
} 
```

在您的页面中：

```
public partial class MyPage : MyBasePage
{
    public override void setConfigurationData()
    {
        //You code to do whatever
    }
} 
```

母版页：

```
protected void RefreshMenu1_MenuItemClick(object sender, MenuEventArgs e)
{
    MyBasePage basePage = (MyBasePage)Page;
    basePage.setConfigurationData();
} 
```

# ruby - 文件名中的rails 3回形针处理器水印错误

> ID：13770475
> 
> 赞同：0
> 
> 时间：2012-12-07T20:27:08.113
> 
> 标签：ruby, ruby-on-rails-3, paperclip

我在rails 3中遇到回形针问题。当我上传文件时，我的处理器抛出错误，因为imagemagick get命令：

“复合-gravity South /home/xxx/xxx/public/images/watermark.png /tmp/a s20121207-5819-1dq7y81.jpg /tmp/a s20121207-5819-1dq7y8120121207-5819-1juqw7a”

复合：无法打开图像`/tmp/a'：

处理器：

```
def make
  dst = Tempfile.new([@basename, @format].compact.join("."))
  dst.binmode

  if @watermark_path
    command = "composite"
    params = "-gravity #{@position} #{@watermark_path} #{fromfile} "
    params += tofile(dst)
    begin
      p " >>>>>>>>>>>>>>>>> #{command} #{params}"
      success = Paperclip.run(command, params)
    rescue PaperclipCommandLineError
      success = false
    end
    unless success
      raise PaperclipError, "There was an error processing the watermark for #{@basename}" if @whiny
    end
    return dst
  else
    return @file
  end
end

def fromfile
  File.expand_path(@file.path)
end

def tofile(destination)
  File.expand_path(destination.path)
end 
```

它仅在文件名包含空格或其他非 alfanum 字符时发生。/tmp/a 应该是 /tmp/a b.jpg。

我试过[http://www.davesouth.org/stories/make-url-friendly-filenames-in-paperclip-attachments](http://www.davesouth.org/stories/make-url-friendly-filenames-in-paperclip-attachments)等等，但处理器中的文件名仍然是错误的

有任何想法吗？或适用于这个问题的处理器？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T14:53:21.827

我今天回到了这个问题，发现你只需要像 ImageMagic 文档（[http://www.imagemagick.org/script/command-line-processing.php](http://www.imagemagick.org/script/command-line-processing.php)）中那样用引号括起来路径：

```
If the image path includes one or more spaces, enclose the path in quotes:

'my title.jpg' 
```

例如，在我的处理器中，我有：

```
command = "convert \"#{File.expand_path(@file.path)}\" -crop #{crop_area} -resize 150x150 \"#{File.expand_path(destination.path)}\""

Paperclip.run(command) 
```

.

我现在在 Windows 上，单引号似乎不起作用。像您一样，我尝试更改 @file 的属性但没有成功。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:46:17.537

尝试一下：

```
dst = Tempfile.new([@basename, @format].compact.join(".").gsub(" ","") 
```

# android - 如何知道用户何时关闭了 Android 应用程序？

> ID：13770479
> 
> 赞同：1
> 
> 时间：2012-12-07T20:27:23.900
> 
> 标签：android

是否有任何方法可以找到应用程序何时关闭（由用户或系统关闭），即应用程序只能由用户通过按下应用程序启动器图标重新启动。

我认为只有在从[getRunningAppProcesses()](http://pages.citebite.com/q8d0d8f8ouey)中删除进程名称时，Android 系统才会广播任何 Intent 是可能的。

我已经阅读了关于 SO 的所有可能的问答，并且该问题与 ActivityLifecycle 无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T21:00:31.910

通常，等待用户“退出”应用程序是一个坏主意，因为：

*   用户实际上并不存在该应用程序，他们只是将其留在活动堆栈中，稍后再返回。
*   用户可能会在您的数据库更新期间执行任何操作，例如重新进入应用程序。
*   如果没有非常老套的解决方案，您将无法真正检测到这一点；这是 API 的*设计*，因为您*不需要*做这些事情。

因此，我认为任何基于等待应用程序“死亡”的解决方案都是一个糟糕的解决方案。相反，您应该提出一个尊重应用程序语义的解决方案。例如，如果您在其内容提供者之一中输入数据，那么它应该处理一致性（例如，跨应用程序中的片段）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:39:45.850

嗯..您可以手动监视文件系统上的 /proc 以查看您关心的应用程序是否存在进程 ID。

从您的终端窗口尝试以下操作。例如 ：

```
> MYPID=(`adb shell ps | grep com.mydomain.myapp | awk '{print $2}'`)
> adb shell [ -d /proc/$MYPID ] && echo "PID $MYPID Exists" 
```

将*com.mydomain.myapp*替换为您的应用程序包名称

有几个应用程序可用于监控 android 上的进程。看看[http://code.google.com/p/android-os-monitor/](http://code.google.com/p/android-os-monitor/)

android-os-monitor 项目使用 JNI 层来实现与 /proc 的交互 [http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/jni/process.c?repo=渗透压监测器](http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/jni/process.c?repo=osmonitor)

[http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/src/com/eolwral/osmonitor/JNIInterface.java?repo=osmonitor](http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/src/com/eolwral/osmonitor/JNIInterface.java?repo=osmonitor)

[http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/src/com/eolwral/osmonitor/processes/ProcessList.java?repo=osmonitor](http://code.google.com/p/android-os-monitor/source/browse/OSMonitor/src/com/eolwral/osmonitor/processes/ProcessList.java?repo=osmonitor)

# java - 在 java 中的关闭挂钩内引发异常时会发生什么

> ID：13770480
> 
> 赞同：5
> 
> 时间：2012-12-07T20:27:26.933
> 
> 标签：java, exception-handling, jvm, shutdown-hook

如果在 java 中执行关闭挂钩期间抛出未捕获的异常，jvm 是否会立即退出而不运行其余已注册的关闭挂钩（如果有）？从javadocs：

> 与在任何其他线程中一样，通过调用线程的 ThreadGroup 对象的 uncaughtException 方法，在关闭挂钩中处理未捕获的异常。此方法的默认实现将异常的堆栈跟踪打印到 System.err 并终止线程；它不会导致虚拟机退出或停止。

似乎其他关闭挂钩应该运行......

作为一个后续问题，拥有一段可能在关闭挂钩中引发异常的代码可能不是一个好主意？如果无法避免，尝试在关闭挂钩内捕获异常是一种好习惯吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:42:44.733

由于[addShutdownHook](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29)方法需要一个线程，因此每个单独的关闭挂钩都是它自己的线程。未捕获异常的默认行为是打印错误消息并终止线程。由于钩子具有相同的行为，因此以错误结尾的单个关闭钩子不应阻止其他钩子运行。

请注意，我还没有实际测试过这个......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:35:22.950

在关闭钩子中运行的代码与在主线程中运行的代码遵循相同的最佳实践：如果需要，捕获异常，如果需要记录，或者让异常打印到标准输出。

# iphone - 大型 UICollectionViewCell 随自定义布局消失

> ID：13770484
> 
> 赞同：6
> 
> 时间：2012-12-07T20:27:49.470
> 
> 标签：iphone, ios, uicollectionview

我将`UICollectionViewLayout`. 到现在为止还挺好。
但是，我有一些比屏幕更宽的单元格，有时这些单元格会在滚动时消失。当您再滚动一些时，它们会神奇地重新出现在它们应该出现的位置。我可以向您展示我的代码，但我认为它没有任何问题，因为它在 90% 的情况下都有效。但是，真正大的单元格（超过屏幕尺寸的两倍）有时会消失。

```
NSMutableArray* attributes = [NSMutableArray array];
for (int section=0; section < [[self collectionView] numberOfSections]; section++) {
    [attributes addObject:[self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:[NSIndexPath indexPathForItem:0 inSection:section]]];
        for (int row=0; row < [[self collectionView] numberOfItemsInSection:section]; row++) {
            NSIndexPath* indexPath = [NSIndexPath indexPathForItem:row inSection:section];
            [attributes addObject:[self layoutAttributesForItemAtIndexPath:indexPath]];
        }
 }
 return attributes; 
```

我也有这些帖子：[UICollectionView 的单元格消失](https://stackoverflow.com/questions/13360975/uicollectionviews-cell-disappearing-ios)和UICollectionView 中的[大单元格在单元格仍然显示时被删除](https://stackoverflow.com/questions/13016302/large-cells-in-a-uicollectionview-getting-removed-while-the-cell-is-still-displa) 但是，没有提到解决方案。有人可以帮我吗？会不会是苹果那边的问题？如果是，有什么我可以自己解决的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T18:36:10.210

很抱歉告诉你：我很确定这是 UICollectionView 中的一个真正的错误；几周前我遇到了同样的事情。我编写了一个小程序来演示该错误并向 Apple 提交了 RADAR，但尚未收到有关他们是否或是否计划修复它的回复。我能想到的最好的解决方法（警告：我还没有实现这个解决方法）是注意到布局属性离屏幕边缘很远，故意改变单元格属性的边界，所以它只会稍微偏离屏幕，并可能将该偏移量（您从实际边界修剪掉的量）存储为 layoutAttributes 中的附加自定义字段，以便您的单元格知道正确绘制它的内容。这感觉像是一个严重的黑客攻击，但它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:35:09.547

您确定在`-(NSArray*)layoutAttributesForElementsInRect:(CGRect)rect`调用方法并且 rect 只是您的单元格的一部分时为此单元格返回正确的属性对象吗？

# c# - 带有 xpath 的 XPathNavigator 会返回错误的节点

> ID：13770487
> 
> 赞同：1
> 
> 时间：2012-12-07T20:27:57.387
> 
> 标签：c#, xml, xpath, xpathnavigator

我尝试从 xml 配置中获取一些特定的值。请参见下面的示例。

```
<?xml version="1.0" encoding="utf-8"?>
<ExcelConfig>
    <ExcelDocument name="Customer" type="flat">
        <IdentityColumn>
            <Column name="Id" />
        </IdentityColumn>
        <Validate>
            <Column name="Name" mandatory="true" />
            <Column name="FirstName" mandatory="true" />
            <OrColumns mandatory="true">
                <Column name="PostalCode" mandatory="false" />
                <Column name="PostalCode2" mandatory="false" />
            </OrColumns>
        </Validate>
    </ExcelDocument>
    <ExcelDocument name="Company" type="flat">
        <IdentityColumn>
            <Column name="Id" />
        </IdentityColumn>
        <Validate>
            <Column name="Name" mandatory="true" />
            <Column name="FirstName" mandatory="true" />
            <OrColumns mandatory="true">
                <Column name="PostalCode" mandatory="false" />
                <Column name="PostalCode2" mandatory="false" />
            </OrColumns>
        </Validate>
    </ExcelDocument>
    <ExcelDocument name="SomeOtherType" type="block">
        <IdentityBlock>
            <Column name="Period" col="A" />
            <Column name="Period2" col="B" />
        </IdentityBlock>
        <Validate>
            <Column name="Name" mandatory="true" />
            <Column name="FirstName" mandatory="true" />
        </Validate>
    </ExcelDocument>
</ExcelConfig> 
```

我使用以下代码从 excel 文件中获取一些信息。“ValidationConfiguration”是具有先前配置的字符串。

```
 //Get Different NodeTypes of Excel documents
            List<XPathNavigator> types = XmlHelper.GetNodeTypes(validationConfiguration, "/ExcelConfig/ExcelDocument");
            List<XPathNavigator> flatTypes = XmlHelper.GetNodeTypes(validationConfiguration,
                                                                     "//ExcelConfig/ExcelDocument[@type='flat']");
            List<XPathNavigator> blockTypes = XmlHelper.GetNodeTypes(validationConfiguration,
                                                                     "//ExcelConfig/ExcelDocument[@type='block']");

            //First we check if the file is from the flat type and get the IdentityColumns
            List<XPathNavigator> identityColumnsNode = XmlHelper.GetNodeTypes(validationConfiguration, "//ExcelConfig/ExcelDocument[@type='flat']/IdentityColumn"); 
```

您可以在下面找到 XmlHelper 类。

```
 public static class XmlHelper
    {
        public static List<XPathNavigator> GetNodeTypes(string xmlConfiguration,string xPath)
        {
            XPathDocument doc = new XPathDocument(new StringReader(xmlConfiguration));
            XPathNavigator nav = doc.CreateNavigator();

            XPathExpression expr = nav.Compile(xPath);
            List<XPathNavigator> elements = new List<XPathNavigator>();

            foreach (XPathNavigator node in nav.Select(expr))
            {
                elements.Add(node);   
            }

            return elements;
        }

        public static List<string> GetIdentityColumnNames(List<XPathNavigator> xPathNavigators)
        {
            List<string> identityColumns = new List<string>();

            foreach (XPathNavigator xPathNavigator in xPathNavigators)
            {
                foreach (XPathNavigator test in xPathNavigator.Select("//Column"))
                {
                    identityColumns.Add(test.GetAttribute("name", ""));
                }
            }

            return identityColumns;
        }
    } 
```

现在我想做以下事情。我选择了identityColumnsNodes（它们包含来自具有平面类型的exceldocuments的IdentityColumn）。我得到的所有类型的列。但是当我尝试这样做时，我会从整个文件中取回所有列。他不只是我使用的节点中的项目。

```
 foreach (XPathNavigator identityColumNode in identityColumnsNode)
                        {
                            List<string> identityColumns = XmlHelper.GetIdentityColumnNames(identityColumnsNode);          
                        } 
```

第二个问题/我想做的事情->从特定文件中选择正确的验证节点的最佳方法。有了identityColumns（我回来了，我的HeaderRow Cells列表我知道它是什么文件。但是我怎样才能选择那个验证节点呢？

还是他们有更好的方法来做这些事情？

# python - 如何通过boto修改cloudsearch中的访问策略

> ID：13770488
> 
> 赞同：1
> 
> 时间：2012-12-07T20:28:09.457
> 
> 标签：python, amazon-web-services, boto, policies

如何通过 boto 更改 cloudsearch 域的访问策略？有可能吗？

使用 boto 2.6.0 我`get_access_policies()`在域实例中看到了一个方法，但没有修改策略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:21:33.817

该方法返回一个[`OptionStatus`](http://docs.pythonboto.org/en/latest/ref/cloudsearch.html#module-boto.cloudsearch.optionstatus)对象。看起来您可以更改对象的属性，然后调用其`save()`方法来修改策略。

# asp.net - 旧的 VS2008 ASP.NET 网站项目在构建后不更新 bin 中的 DLL

> ID：13770489
> 
> 赞同：2
> 
> 时间：2012-12-07T20:28:18.100
> 
> 标签：asp.net, visual-studio-2008

我继承了一个旧的 ASP.NET 网站项目（不是 Web 项目），因此它使用了我收集的网站模型。App_Code 文件夹中没有代码。在不同的文件夹中有几十个 aspx 和 aspx.cs 文件。

到目前为止我做了什么：

1.  我已经从前一个人的文件共享中将整个项目复制到本地（他已经离开并且没有使用 TFS）。
2.  我在 VS2008 中加载了网站，对代码中的电子邮件地址进行了小幅更改并重新构建了它。
    此时，它编译正常，没有错误。但 bin 文件夹中的 dll 不反映正确的日期/时间戳。我将站点发布到测试服务器，它仍在使用我更新之前的以前的电子邮件地址。

我的问题：为什么 dll 不会更新？我已阅读网站模型和 Web 应用程序模型之间存在差异。当我从菜单中选择 Build 时，它实际上显示的是“Build Web Site”，而不是项目名称。这是我第一次使用这种类型的项目。

我的问题：有什么想法可以解决吗？我已经在这个网站上梳理了类似的问题，但最接近我的问题的问题没有解决/已回答状态。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:48:51.513

您应该有一个至少包含两个项目的解决方案：

```
Sln
- Website
- DLL 
```

在`Website`添加对`DLL`和构建的引用。应该照顾它。

或者，您也可以转换为 Web 应用程序，但如果您的项目结构不正确，您也会遇到同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:44:02.423

据我回忆，网站不是执行运行时编译，因此不生成 dll 吗？不过不要引用我的话，已经有一段时间了。您可以将它从 VS 转换为 Web 应用程序吗？

# java - 使用 charAt 方法，不会将它们添加为 Int，也不会打印为字符串。会更好地解释

> ID：13770492
> 
> 赞同：0
> 
> 时间：2012-12-07T20:28:39.810
> 
> 标签：java, string, char, int, ascii

好的，这是我的代码：

```
import java.util.Scanner;

public class CarRental {

    public static String model;
    public static int letternum;
    public static String plate;
    public static String letter;
    public static int total;              
    public static String alphabet = "abcdefghijklmnopqrstuvwxyz";

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);

        //System.out.println("Car Model:");
        //model = input.nextLine();
        System.out.println("License Plate: ");
        plate = input.nextLine();

        char one = plate.charAt(0);
        char two = plate.charAt(1);
        char three = plate.charAt(2);
        total = one + two + three;
        letternum = total % 24;

        char letter = alphabet.charAt(letternum);

        System.out.println("" + letter + total);

    }
} 
```

这是怎么回事，我试图让它接受我的车牌输入，并在 0、1 和 2 的位置获取字符。车牌中的三个字母。然后，我尝试获取它们的 ASCII 值，将它们加在一起并将它们设置为 int“总计”。然后要找到一个应该在总值前面的字母，我使用 % 6 找到总值的其余部分。然后它将取那个值，无论它是什么数字，比如 4，它都会取字符串“alphabet”中的第 4 个字母并将其设置为字符“字母”。然后它应该做的是打印出字母，然后是 ASCII 值的总数。

这是一个示例，说明我对预期结果的输入，然后是实际结果。

> 车牌：CPR 607
> 
> 输出：E836

我使用完全相同的车牌的输出是：

> 车牌：CPR 607
> 
> n229

我不确定我做错了什么，但我最好的线索是它是一个字符这一事实，它把它当作它的 ASCII 值，而不是它的字符串值（我实际上试图得到）

如果有人可以提出一些建议，那将是一个很大的帮助。不一定是我可以偷偷摸摸的代码，而是我应该如何以正确的方式去做这件事！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:46:30.637

您想要获取字符串的第二部分（带有三个数字）并将其添加到您的总数中。您可以通过以下方式获取该值：

Integer.parseInt(plate.split("")[1])

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:36:02.200

更改这些行：

```
int one = (int) plate.charAt(0);
int two = (int) plate.charAt(1);
int three = (int) plate.charAt(2); 
```

这将为您提供字符的实际 ASCII 值。

如果你想要别的东西，你必须从每个值中减去一个常数，正如 jonhopkins 在他的评论中所说明的那样。

减去 64 得到 A = 1、B = 2 等。

我看到了你的问题。

该算法是取前 3 个字符的 ASCII 值**并将它们添加到数字**（最后 3 个字符）中。

此外，您必须除以 6 才能得到字母 A - E。您要除以 24。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:45:49.000

如果您将 229 值添加到车牌中的 607 中，您会得到您说应该得到的 836 数字，所以看起来您的总变量是正确的，但您只需要将它添加到数字从输入。

其他人所说的关于转换 ASCII 值的内容是在您确定输出中的第一个字符时。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-07T20:36:33.300

```
public static String model;
public static int letternum;
public static String plate;
public static String letter;
public static int total;              
public static String alphabet = "abcdefghijklmnopqrstuvwxyz";

public static void main(String[] args) {
    Scanner input = new Scanner(System.in);

    //System.out.println("Car Model:");
    //model = input.nextLine();
    System.out.println("License Plate: ");
    plate = input.nextLine();

    char one = plate.charAt(0);
    char two = plate.charAt(1);
    char three = plate.charAt(2);
    total = Integer.parseInt(one) + Integer.parseInt(two) + Integer.parseInt(three);
    letternum = total % 24;

    char letter = alphabet.charAt(letternum);

    System.out.println("" + letter + total);

} 
```

你忘了把它转换成整数

# opengl - GLSL 矩阵的意外行为

> ID：13770497
> 
> 赞同：2
> 
> 时间：2012-12-07T20:29:12.350
> 
> 标签：opengl, glsl

以下简单的片段着色器表现出非常奇怪的行为。没有循环，输出都是红色的，正如预期的那样。但随着循环它变成黄色，即 rgb(1,1,0)。有人可以告诉我这里发生了什么吗？

```
void main(void)
{
    mat4 redUnit = mat4(
        1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0
    );
    mat4 greenUnit = mat4(
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0
    );
    mat4 blueUnit = mat4(
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0
    );

    for (int x = -1; x < 3; x++) {
        for (int y = -1; y < 3; y++) {
            redUnit[x+1][y+1] = 1.0;
            greenUnit[x+1][y+1] = 0.0;
            blueUnit[x+1][y+1] = 0.0;
        }
    }

    gl_FragColor = vec4(redUnit[0][0], greenUnit[0][0], blueUnit[0][0], 1.0);
} 
```

编辑：输出颜色取决于声明变量的顺序。所以不知何故，内存边界被违反了。尽管如此，仍然没有解释这种行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:05:18.450

万一其他人遇到这种情况：这是英特尔 GMA 显卡驱动程序中的一个错误。在另一台具有不同显卡的机器上，一切正常。

# c++ - RegSetValueEx() 不改变键值

> ID：13770498
> 
> 赞同：1
> 
> 时间：2012-12-07T20:29:30.227
> 
> 标签：c++, winapi

在我的应用程序中，当我第一次使用 RegSetValueEx() 设置键值时它可以工作，但是当我尝试使用相同的函数更改值时它不起作用，值保持不变。我究竟做错了什么 ？

这是代码：

```
SetSZValue( "MyAppData", "versionInfo", "1.0.0" );

    HKEY CreateKey( string regkey )
    {
         HKEY hKey ;
         DWORD disValue ;

         char msg[512] ;

         string _key = "HKEY_LOCAL_MACHINE\\" ;
                _key += regkey ;

         LONG retValue = RegCreateKeyEx( HKEY_LOCAL_MACHINE, regkey.c_str(), 0, 0, REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0, &hKey, &disValue ) ;
         if (retValue != ERROR_SUCCESS)
         {
             FormatMessage( FORMAT_MESSAGE_FROM_SYSTEM, 0, GetLastError(), 0, &msg[0], 512, 0 ) ;
             MessageBox( 0, &msg[0], "CreateKey", MB_OK | MB_ICONEXCLAMATION );
         }

         return hKey ;
    }

    void SetSZValue( string regkey, string keyName, string keyValue )
    {
         HKEY hKey;
         DWORD disValue;

         char msg[512];

         hKey = CreateKey(regkey);
         if (hKey)
         {
            LONG retValue = RegSetValueEx( hKey, keyName.c_str(), 0, REG_SZ, ( const BYTE* )( keyValue.c_str() ), keyValue.size()+1 );
            if ( retValue != ERROR_SUCCESS )
            {
                FormatMessage( FORMAT_MESSAGE_FROM_SYSTEM, 0, GetLastError(), 0, &msg[0], 512, 0 );
                  MessageBox( 0, &msg[0], "SetSZValue", MB_OK | MB_ICONEXCLAMATION );
            }

                RegCloseKey ( hKey );
         }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:58:30.760

您的应用程序是在 64 位 Windows 版本上运行的 32 位进程吗？如果是这样，您的应用是否有一个带有“requestedExecutionLevel”值的 UAC 清单？如果没有，您的密钥可能会被虚拟化到注册表的另一个部分，而您根本没有找到正确的位置。 [注册表虚拟化](http://msdn.microsoft.com/en-us/library/windows/desktop/aa965884.aspx)是 WOW64 的一项功能，因此旧的 32 位和 64 位进程在注册表中不会相互交叉。您应该安装 SysInternals [Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645)，它将显示您的应用程序实际访问的键和值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:44:12.640

`RegSetValueEx`接受要更改的键内的值的名称；不是密钥的名称。改为提供值名称；键名来自`HKEY`自身。

# google-code - GoogleCode：如何启用 gzip 压缩？

> ID：13770499
> 
> 赞同：0
> 
> 时间：2012-12-07T20:29:33.523
> 
> 标签：google-code

我在 googlecode.com/svn/trunk/Js/my.js 中有 js 文件。

但是页面速度验证器显示“启用 gzip 压缩”、“指定一个 Vary：Accept-Encoding 标头”

我应该使用什么属性来为 my.js 启用 gzip 压缩和“指定 Vary：Accept-Encoding 标头”？

# c# - 具有不断变化的数据类型的管道在架构上是否合理？

> ID：13770501
> 
> 赞同：2
> 
> 时间：2012-12-07T20:29:37.483
> 
> 标签：c#, oop, architecture, pipeline

我正在研究本质上是一个文档解析和分析框架的架构。给定文档的行，框架最终将生成一个`Document`表示文档的大对象（称为它）。

管道中的早期过滤器将需要逐行运行。但是，进一步向下的过滤器将需要转换（并最终生成）`Document`对象。

为了实现这一点，我正在考虑使用这样的过滤器定义：

```
public interface IFilter<in TIn, out TOut> {
    TOut Execute(TIn data);
} 
```

所有过滤器都将注册到一个`PipelineManager`类（与使用“链表”样式方法相反）。在执行之前，`PipelineManager`将验证管道的完整性，以确保没有过滤器被赋予错误的输入类型。

**我的问题：**拥有一个数据类型不断变化的管道在架构上是否合理（即一个好主意）？

PS 我将我的应用程序实现为管道的原因是因为我觉得插件作者很容易替换/扩展现有的过滤器。只需将要更改的过滤器换成不同的实现，就可以了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T22:09:18.993

编辑：注意，已删除其他答案以替换此 wall'o'text *grin*

NINJAEDIT：有趣的事实：Powershell（在@Loudenvier 的回答中提到）曾经被命名为“Monad”——此外，发现 Wes Dyer 的博客文章主题为：[Monads 的奇迹](http://blogs.msdn.com/b/wesdyer/archive/2008/01/11/the-marvels-of-monads.aspx)

查看整个“Monad”事物的一种非常非常简单的方式是将其视为具有非常基本界面的盒子：

*   返回
*   绑定
*   零（可选）

使用在概念上同样简单——假设你有一个“东西”：

*   您可以将您的“东西”包装在盒子中（这将是“返回”）并拥有一个“BoxOfThing”
*   您可以指导如何将物品从这个盒子中取出并放入另一个盒子（装订）
*   您可以获得一个空框（“零”：将其视为一种“无操作”，例如乘以一或加零）
*   （还有其他规则，但这三个是最有趣的）

绑定位是**真正**有趣的部分，也是让大多数人脑袋爆炸的部分；基本上，您给出了如何将盒子链接在一起的各种规范：让我们采用一个相当简单的 Monad，“Option”或“Maybe” - 有点像`Nullable<T>`，但更酷。

所以每个人都讨厌到处检查 null，但由于引用类型的工作方式，我们不得不这样做；我们希望*能够* 编写这样的代码：

`var zipcodesNearby = order.Customer.Address.City.ZipCodes;`

如果（客户有效 + 地址有效 + ...），则要么返回有效答案，要么如果该逻辑的任何部分失败，则返回“无”......但不，我们需要：

```
List<string> zipcodesNearBy = new List<string>();
if(goodOrder.Customer != null)
{
    if(goodOrder.Customer.Address != null)
    {
        if(goodOrder.Customer.Address.City != null)
        {
            if(goodOrder.Customer.Address.City.ZipCodes != null)
            {
                zipcodesNearBy = goodOrder.Customer.Address.City.ZipCodes;
            }
            else { /* do something else? throw? */ }
        }
        else { /* do something else? throw? */ }
    }
    else { /* do something else? throw? */ }
}
else { /* do something else? throw? */ } 
```

（注意：你也可以依赖空合并，如果适用的话——虽然它看起来很讨厌）

```
List<string> nullCoalescingZips = 
    ((((goodOrder ?? new Order())
        .Customer ?? new Person())
            .Address ?? new Address())
                .City ?? new City())
                    .ZipCodes ?? new List<string>(); 
```

Maybe monad “规则”可能看起来有点像：

（注意：C# 不适合这种类型的类型修改，所以它有点不稳定）

```
public static Maybe<T> Return(T value)
{
    return ReferenceEquals(value, null) ? Maybe<T>.Nothing : new Maybe<T>() { Value = value };
}
public static Maybe<U> Bind<U>(Maybe<T> me, Func<T, Maybe<U>> map)
{
    return me != Maybe<T>.Nothing ?
        // extract, map, and rebox
        map(me.Value) :
        // We have nothing, so we pass along nothing...
        Maybe<U>.Nothing;
} 
```

但这会导致一些**讨厌的**代码：

```
var result1 = 
    Maybe<string>.Bind(Maybe<string>.Return("hello"), hello =>
        Maybe<string>.Bind(Maybe<string>.Return((string)null), doh =>
            Maybe<string>.Bind(Maybe<string>.Return("world"), world =>
                hello + doh + world).Value
            ).Value
        ); 
```

幸运的是，有一个简洁的快捷方式：`SelectMany`大致相当于“绑定”：

如果我们实施`SelectMany`我们的`Maybe<T>`...

```
public class Maybe<T>
{
    public static readonly Maybe<T> Nothing = new Maybe<T>();
    private Maybe() {}
    public T Value { get; private set;}
    public Maybe(T value) { Value = value; }
}
public static class MaybeExt
{
    public static bool IsNothing<T>(this Maybe<T> me)
    {
        return me == Maybe<T>.Nothing;
    }
    public static Maybe<T> May<T>(this T value)
    {
        return ReferenceEquals(value, null) ? Maybe<T>.Nothing : new Maybe<T>(value);
    }
    // Note: this is basically just "Bind"
    public static Maybe<U> SelectMany<T,U>(this Maybe<T> me, Func<T, Maybe<U>> map)
    {
        return me != Maybe<T>.Nothing ?
            // extract, map, and rebox
            map(me.Value) :
            // We have nothing, so we pass along nothing...
            Maybe<U>.Nothing;
    }
    // This overload is the one that "turns on" query comprehension syntax...
    public static Maybe<V> SelectMany<T,U,V>(this Maybe<T> me, Func<T, Maybe<U>> map, Func<T,U,V> selector)
    {
        return me.SelectMany(x => map(x).SelectMany(y => selector(x,y).May()));
    }
} 
```

现在我们可以搭载 LINQ 理解语法！

```
var result1 = 
    from hello in "Hello".May()
    from oops in ((string)null).May()
    from world in "world".May()
    select hello + oops + world;
// prints "Was Nothing!"
Console.WriteLine(result1.IsNothing() ? "Was Nothing!" : result1.Value);

var result2 = 
    from hello in "Hello".May()
    from space in " ".May()
    from world in "world".May()
    select hello + space + world;
// prints "Hello world"
Console.WriteLine(result2.IsNothing() ? "Was Nothing!" : result2.Value);

var goodOrder = new Order { Customer = new Person { Address = new Address { City = new City { ZipCodes = new List<string>{"90210"}}}}};
var badOrder = new Order { Customer = new Person { Address = null }};

var zipcodesNearby = 
    from ord in goodOrder.May()
    from cust in ord.Customer.May()     
    from add in cust.Address.May()
    from city in add.City.May()
    from zip in city.ZipCodes.May()
    select zip;
// prints "90210"
Console.WriteLine(zipcodesNearby.IsNothing() ? "Nothing!" : zipcodesNearby.Value.FirstOrDefault());

var badZipcodesNearby = 
    from ord in badOrder.May()
    from cust in ord.Customer.May()     
    from add in cust.Address.May()
    from city in add.City.May()
    from zip in city.ZipCodes.May()
    select zip;
// prints "Nothing!"
Console.WriteLine(badZipcodesNearby.IsNothing() ? "Nothing!" : badZipcodesNearby.Value.FirstOrDefault()); 
```

哈，刚刚意识到我忘了提到这一点......所以基本上，一旦你弄清楚管道的每个阶段的“绑定”等价物是什么，你就可以使用相同类型的伪单子代码来处理每个类型转换的包装、展开和处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:35:12.937

这不会回答您的问题，但是在 .NET 世界中寻找管道灵感的好地方是 PowerShell。他们以一种非常巧妙的方式实现了管道模型，并且流经管道的对象会一直在变化。

过去，我必须生成一个数据库到 PDF 文档创建管道，并将其作为 PowerShell 命令行开关来完成。它是如此可扩展，以至于多年后它仍然被积极使用和开发，它只是从 PowerShell 1 迁移到 2，现在可能迁移到 3。

您可以在这里获得好主意：http: [//blogs.technet.com/b/heyscriptingguy/](http://blogs.technet.com/b/heyscriptingguy/)

# c# - 如何在没有睡觉的父母或其他子表单的情况下睡觉子表单

> ID：13770506
> 
> 赞同：0
> 
> 时间：2012-12-07T20:29:52.520
> 
> 标签：c#, sleep, mdiparent

我正在构建一个总共有 5 个表单的程序。1 个 MDIContainer 和 4 个 MDIChildren。

我目前`thread.sleep(1000)`每个 MDIChild 都有一个。执行操作时，我仍然需要其他 3 个 MDIChilds 才能工作和交互。但是，现在当`thread.sleep(1000)`调用 时，整个程序会休眠 1 秒，我必须等待休眠完成，然后才能与任何其他形式进行交互。

有没有办法让单一表格睡眠？如果是这样，请如何和示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:39:55.610

你基本上不应该在 UI 线程中睡觉......永远......因为你的问题所表明的原因。

您只想在 1 秒内执行一些代码。有两种有效的方法可以做到这一点：

1）您可以使用`Timer`. 通过在`Forms`命名空间中使用计时器，您可以确保它`Tick`在 UI 线程中触发事件，并且您无需执行任何特殊操作来与 UI 元素交互。

```
private void Form1_Load(object sender, EventArgs e)
{
    label1.Text = "Loading . . .";

    var timer = new System.Windows.Forms.Timer();
    timer.Interval = 1000;

    timer.Tick += (s, args) =>
    {
        label1.Text = "Done!";
    };

    timer.Start();
} 
```

如您所见，这确实需要*比*理想更多的代码，但它仍然有效。

2) 如果你有 .NET 4.5 和 C# 5.0，你可以使用任务`await`来使这变得*非常*简单：

```
private async void Form1_Load(object sender, EventArgs e)
{
    label1.Text = "Loading . . .";
    await Task.Delay(1000); //wait 1 second, but don't block the UI thread.
    label1.Text = "Done!";
} 
```

# jquery - .mouseleave .mouseenter jquery 动画冲突

> ID：13770507
> 
> 赞同：0
> 
> 时间：2012-12-07T20:29:55.363
> 
> 标签：jquery, jquery-animate, mouseevent

**http://apw-design.com/**看看这个网页，我有一个 div id，它从页面上的一条细线开始。当鼠标进入菜单时，框会在它和徽标的一部分上移动，当鼠标直接从菜单进入徽标时，它会正确更改颜色，但会使用菜单中的鼠标离开动画。如果您从页面滚动到徽标，它会显示框应转换为的内容。

动画的脚本如下： http: [//pastebin.com/wU4c10NJ](http://pastebin.com/wU4c10NJ) 我也上传了 css 文件以供参考： http: [//pastebin.com/RgWZQTD9](http://pastebin.com/RgWZQTD9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T09:51:33.453

看起来问题出`eachDelay`在菜单“mouseleave”功能中的功能。延迟将导致您的`#whiteline`动画在您的徽标“mouseenter”功能**后触发。**以下是事件链：

1.  菜单`mouseleave`触发
2.  菜单`eachDelay`循环通过菜单项
3.  标志`mouseenter`火灾
4.  菜单`eachDelay`到达最后一项并覆盖徽标`mouseenter`

您可以做的是引入一个变量来检查菜单是否不再具有焦点，并且仅`#whiteline`在光标不在徽标上时触发动画。这是一个简化的示例：

```
// Create a variable to check cursor focus
var lastFocus = "";

$('#menu').mouseenter(function(element) {
    lastFocus = "menu";
    // PLUS YOUR CODE
});

$('#logo').mouseenter(function(element) {
    lastFocus = "logo";
    // PLUS YOUR CODE
}); 

$('#menu').mouseleave(function(element) {
    $("#menu ul li").eachDelay(function(index){
        if(index == $("#menu ul li").size() -1){
            // Check if we haven't hovered over the logo whilst the delay was running
            if(lastFocus == "menu"){
                // Do the animation
            }
        }
    }, 30);
}); 
```

一个有用的调试技巧是`console.log("Event foo fired");`在您的脚本中执行动画的点上使用，这样您就可以打开浏览器控制台并判断事情的顺序是否有点偏离。

# oracle - 创建 Oracle 包体

> ID：13770508
> 
> 赞同：4
> 
> 时间：2012-12-07T20:30:06.580
> 
> 标签：oracle, plsql

我正在尝试为包装奠定基础，但即使开始也遇到了麻烦。我已经成功创建了一个基本的包规范，并且只想测试包体，但我无法编译它。规范代码是：

```
CREATE OR REPLACE PACKAGE synchronize_my_data 
AS
  PROCEDURE synchronize_data(p_run_date IN date);
END synchronize_my_data; 
```

这是包体代码：

```
CREATE OR REPLACE PACKAGE BODY synchronize_my_data 
IS
  PROCEDURE synchronize_data(p_run_date IN date) IS
      PROCEDURE process_deletes(p_run_date IN date) IS
      BEGIN
          dbms_output.put_line('Run Date: ' || to_char(p_run_date, 'MM/DD/YYYY'));      
      END process_deletes;
  BEGIN
    process_deletes(p_run_date);
  END synchronize_data;

END synchronize_my_data; 
```

我不断收到编译错误，但无法弄清楚代码有什么问题。这似乎是基本代码，我只是错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:37:59.793

该代码似乎为我编译。你遇到了什么错误？

```
SQL> CREATE OR REPLACE PACKAGE synchronize_my_data
  2  AS
  3    PROCEDURE synchronize_data(p_run_date IN date);
  4  END synchronize_my_data;
  5  /

Package created.

SQL> CREATE OR REPLACE PACKAGE BODY synchronize_my_data
  2  IS
  3    PROCEDURE synchronize_data(p_run_date IN date) IS
  4        PROCEDURE process_deletes(p_run_date IN date) IS
  5        BEGIN
  6            dbms_output.put_line('Run Date: ' || to_char(p_run_date, 'MM/DD/YYYY'));
  7        END process_deletes;
  8    BEGIN
  9      process_deletes(p_run_date);
 10    END synchronize_data;
 11
 12  END synchronize_my_data;
 13  /

Package body created. 
```

从一般风格的角度来看，在包体内的另一个过程中定义一个过程通常没有什么意义。使用包的好处之一是您可以同时拥有公共和私有过程。您可以`process_deletes`通过在主体中定义它而不在规范中定义它来将过程创建为私有过程。

```
CREATE OR REPLACE PACKAGE BODY synchronize_my_data 
IS
  PROCEDURE process_deletes(p_run_date IN date) 
  IS
  BEGIN
      dbms_output.put_line('Run Date: ' || to_char(p_run_date, 'MM/DD/YYYY'));      
  END process_deletes;

  PROCEDURE synchronize_data(p_run_date IN date) 
  IS
  BEGIN
    process_deletes(p_run_date);
  END synchronize_data;

END synchronize_my_data; 
```

这不应该与您遇到的任何错误有关。但它应该使您的代码更容易处理。

# artificial-intelligence - 神经网络输入

> ID：13770515
> 
> 赞同：0
> 
> 时间：2012-12-07T20:30:44.173
> 
> 标签：artificial-intelligence, neural-network

这是否可以以非数字形式向 ANN 提供输入，例如*英文文本句子* **“每天吃一个苹果”** ，特别是*Unicode 文本*，而 ANN 仅以文本形式返回输出。回答如**“是”“否”**。我对 ANN 了解不多，但我研究的所有示例代码，如 XOR 、图像输入 ，都处理 ANN 中的数字输入。

您能否建议一些代码或指向具有与此相关示例的网页的链接。

我需要为一些 Unicode 文本中的文本句子训练 ANN，但不知道如何处理对 NN 的文本输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:49:44.057

我们为 ANN 处理文本输入的方法是生成一个单词向量。就像你有一本字典：

*   一个
*   苹果
*   吃
*   牛扒
*   斑马

你给 ANN 输入的是： [1, 1, 1, 0, 0] 吃苹果 [0, 0, 1, 0, 1] 吃斑马

你像这样训练你的网络，对于你的输出，你可以说 0 输出是“否”，1 是“是”。

请注意，使用此解决方案，您将拥有一个非常大的输入层。

# probability - 平行正态分布

> ID：13770519
> 
> 赞同：0
> 
> 时间：2012-12-07T20:31:04.503
> 
> 标签：probability, normal-distribution, probability-theory

我正在做一个模拟，其中一个大任务由一系列独立的小任务并行或串行完成。较小任务的完成时间遵循正态分布，平均时间为“t”，方差为“v”。我知道如果这个任务连续重复说“n”次，那么新的总时间分布是正常的，均值 t*n 和方差 v*n，这很好，但我不知道均值和方差会发生什么如果一组相同的任务同时/并行完成，那么距离 prob stat 类已经有一段时间了。有没有一种很好/快速的方法来为这些并行完成的独立正态分布任务中的“n”个新的时间分布找到新的时间分布？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T18:23:22.197

问题是，随机完成时间的最大值（最大值）的分布是什么。一组独立随机变量的最大值的分布函数（即概率密度的不定积分）就是各个变量分布函数的乘积。（最小值的分布函数只是 1 - （（1 - 分布函数）的乘积）。）

如果您想找到一个概率（最大值 > 时间）=（某个给定值）的时间，您可能能够准确地解决这个问题，或者采用数值方法。尽管如此，数值求解方程（例如二分法）比蒙特卡洛方法更快、更准确，正如您所提到的，您已经尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:10:17.667

这不完全是一个编程问题，但您正在寻找的是正态随机变量的**[顺序统计](http://en.wikipedia.org/wiki/Order_statistics)**分布，即耗时最长、最短等的作业的期望值/方差/等。这是均值和方差相同的已解决问题，因为您可以将所有随机变量缩放到已分析的标准正态分布。

这是给你答案的论文，尽管你需要一些数学知识来理解它：

[算法 AS 177：预期正常订单统计（精确和近似）](http://www.jstor.org/stable/2347982) JP Royston。皇家统计学会杂志。系列 C（应用统计）卷。31, No. 2 (1982), pp. 161-165

有关更多信息，请参阅stats.stackexchange 上的[这篇文章。](https://stats.stackexchange.com/questions/9001/approximate-order-statistics-for-normal-random-variables)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T11:46:44.937

如果任务是独立并行执行的，那么直到完成的时间分配取决于最长过程的时间。

不幸的是，max 函数没有特别好的理论分析属性，但如果您已经在模拟，那么有一种简单的方法可以做到这一点。对于每个具有均值 t_i 和方差 v_i 的子过程 i，绘制时间直到每个 i 独立完成，然后查看最大的。重复此多次将为您提供您感兴趣的最大分布中的一堆样本：您可以计算期望（平均值）、方差或任何您想要的。

# java - 检测何时发生解锁失败

> ID：13770522
> 
> 赞同：1
> 
> 时间：2012-12-07T20:31:24.880
> 
> 标签：java, android, unlock

我一直在四处寻找当用户未能解锁手机时会发生什么。

基本上，如果用户无法通过身份验证，我会尝试拍照。但我能找到的是`ACTION_USER_PRESENT`- 有谁知道这是否可能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:56:28.100

您无法访问 android 锁屏的登录尝试。

如果你想构建一个应用程序，你必须创建自己的锁屏。但是，这不是您无法在 android 设置中编辑的“真实”锁屏。这将是一个类似于锁屏并具有相同权限的应用程序。因为您可以检查手机是否被锁定，这样应用程序就会在手机被锁定时激活它自己的“锁屏”（这基本上是一种具有许多权限的正常形式）（您可能必须停用原始锁屏）。

查看[此](http://developer.android.com/reference/android/app/KeyguardManager.html#)链接，您可以获得有关原始锁屏的所有选项。

# python - python对值列表进行排名，使用非唯一值的平均排名

> ID：13770523
> 
> 赞同：3
> 
> 时间：2012-12-07T20:31:28.183
> 
> 标签：python

是否有更pythonic，更快的希望按值对字典进行排名并对非唯一值的排名进行平均。我的做法：

```
d = {'a':5,'b':5,'c':5,'d':1,'e':6}
ordered_keys = sorted(d, key=d.get)
ordered_v = [d[k] for k in ordered_keys]
value_rank = [(ordered_v.index(v)+1)+(ordered_v.count(v)-1)/2 for v in ordered_v]
ranked_key_list = zip(ordered_keys,value_rank)
[('d', 1), ('a', 3), ('c', 3), ('b', 3), ('e', 5)] 
```

这个关于排序字典的广泛讨论非常有帮助：[python 字典值排序](https://stackoverflow.com/questions/6046049/python-dictionary-values-sorting)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T21:14:22.847

你所拥有的非常好，我怀疑有一个更短的解决方案。

至于效率，重复使用`list.index()`and`list.count()`可能会减慢大型数据集的速度。

如果您对大量数据执行此操作，则这是一种更有效的替代实现：

```
from itertools import groupby

d = {'a':5,'b':5,'c':5,'d':1,'e':6}
ranked_key_list = []
i = 1
for k, g in groupby(sorted(d.keys(), key=d.get), key=d.get):
    g = list(g)
    rank = i + (len(g)-1) / 2
    ranked_key_list.extend((k, rank) for k in g)
    i += len(g) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T21:40:49.193

你的算法的瓶颈是 .index 和 .count 是 O(n)，因此你的瓶颈是这条线：

```
value_rank = [(ordered_v.index(v)+1)+(ordered_v.count(v)-1)/2 for v in ordered_v] 
```

导致您的整体表现为 O(n^2)

我为你做了一个 O(n*log(n)) 算法（瓶颈现在是排序）：

```
import collections

d = {'a':5,'b':5,'c':5,'d':1,'e':6}
my_d = collections.defaultdict(list)
for key, val in d.items():
    my_d[val].append(key)

ranked_key_list = [] 
n = v = 1
for _, my_list in sorted(my_d.items()):
    v = n + (len(my_list)-1)/2 
    for e in my_list:
        n += 1
        ranked_key_list.append((e, v)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:35:04.590

```
key_list = zip(dict.keys(), dict.values())
ranked_key_list = sorted(key_list, key=lambda x: x[1]) 
```

编辑：刚刚意识到我没有做平均值的事情......你能再澄清一点吗？3 5s = 3的平均值是多少？

# sql - SQL：获取所有评论的帖子（包括0）

> ID：13770524
> 
> 赞同：0
> 
> 时间：2012-12-07T20:31:39.187
> 
> 标签：sql

此刻我有这个查询：

```
select p.idpost, count(c.idpost)
from posts p join comments c on p.idpost = c.idpost
group by p.idpost 
```

结果仅显示带有评论的帖子。我怎样才能获得**所有**帖子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:32:45.850

使用 a`left join`而不是 a`join`

```
select p.idpost, count(c.idpost)
from posts p 
    left join comments c on p.idpost = c.idpost
group by p.idpost 
```

[这是使用代码的 SQL 连接的一个很好的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)它显示了每个连接会发生什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:32:54.447

使用左连接：

```
select
    p.idpost,
    count(c.idpost)
from posts p
LEFT join comments c on p.idpost = c.idpost
group by p.idpost 
```

干杯

# javascript - Backbone.js - 使用 beforeRoute 过滤器扩展路由器

> ID：13770526
> 
> 赞同：3
> 
> 时间：2012-12-07T20:31:48.573
> 
> 标签：javascript, backbone.js

我正在尝试在 Backbone.js 中为我的路由实现一个前置过滤器。[我在这里](https://github.com/documentcloud/backbone/pull/494)找到了以下代码-

```
var MyRouter = Backbone.Router.extend({
    route: function(route, name, callback) {
        return Backbone.Router.prototype.route.call(this, route, name, function() {
            this.trigger.apply(this, ['beforeroute:' + name].concat(_.toArray(arguments)));
            callback.apply(this, arguments);
        });
    }
}); 
```

但是，我不确定下一步我需要做什么。我需要用我想要的“路由前”逻辑定义一个函数，但我不明白它将如何被调用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T02:31:13.997

被覆盖的`route`函数触发一个名为 的事件`beforeroute:routename`，然后调用原始`route`函数。因此，如果您有这样的路线：

```
var MyRouter = Backbone.Router.extend({
    routes: { 
        "": "home"
    },
    // ...
}); 
```

然后，您将使用以下命令订阅*beforeroute*事件：

```
var router = new MyRouter()

router.on("beforeroute:home", function() {

    // before route logic here...
    alert("Home route is about to get hit ...");
}); 
```

[小提琴演示。](http://jsfiddle.net/2QYrk/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T09:55:05.387

只是对于像我这样的其他人感到困惑，为什么这不起作用。（不再）自 Backbone 版本 0.9.10 以来，它似乎被破坏了。（不知道为什么）

但在 1.0.0 版中，您现在可以使用函数文字而不是对方法的引用。[http://backbonejs.org/#changelog](http://backbonejs.org/#changelog)

所以你可以在调用路线之前做一些事情......

```
routes: {
   'your-route' : function(){ if(yourCondition){ yourAction(); }}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T12:23:48.933

另一种方法是扩展 Router.route 函数。下面是我需要做的一个示例（检查用户是否经过身份验证）。它基本上是原始的主干代码（1.0.0）加上我的自定义代码（标有注释）：

```
 Backbone.Router.prototype.route = function(route, name, callback) {
    if (!_.isRegExp(route)) route = this._routeToRegExp(route);
    if (_.isFunction(name)) {
      callback = name;
      name = '';
    }
    if (!callback) callback = this[name];
    // here my custom code
    callback = _.wrap(callback, _.bind(function(cb) {
      if (name == 'login' || sessionModel.authenticated()) {
        _.bind(cb, this)();
      } else {
        this.navigate('login', {trigger: true});
      }
    }, this));
    // finish my custom code
    var router = this;
    Backbone.history.route(route, function(fragment) {
      var args = router._extractParameters(route, fragment);
      callback && callback.apply(router, args);
      router.trigger.apply(router, ['route:' + name].concat(args));
      router.trigger('route', name, args);
      Backbone.history.trigger('route', router, name, args);
    });
    return this;
  }; 
```

请注意`_.wrap`，`_.bind`这`this`也是您在使用路由器时所期望的。否则我得到一个“这是未定义的”错误。

# angularjs - AngularJS 指令 - 等待指令模板完成渲染？

> ID：13770531
> 
> 赞同：3
> 
> 时间：2012-12-07T20:32:17.113
> 
> 标签：angularjs

我正在尝试编写一个具有模板的指令。该模板正在呈现一些我想要检索的 DOM 元素。但是，当我尝试在链接函数中检索我的 DOM 元素时，找不到 DOM 元素。如果我在选择找到的元素之前添加一个 window.setTimeout 方法。在尝试操作链接函数中的 DOM 之前，如何等待模板完成渲染？

这是我正在尝试做的指令代码：

```
module.directive('testLocationPicker', function() {

    var linkFn = function(scope, element, attrs) {
        console.log('in linking function');
        window.setTimeout(function() {
            var positions = $('.position');
            console.log('number positions found: ' + positions.length);
            positions.click(function(e) {
                console.log('position clicked');
                scope.$apply(function() {
                     scope.selectedPosition = $(e.currentTarget).html();
                });
            });
        }, 500);
    };

    return {
        link: linkFn,
        restrict: 'E',        
        template: 'Choose a position: <div class="position" ng-repeat="position in positions">{{position}}</div>',        
    }        

}); 
```

我有一个我想要做的事情的 JS Fiddle：http: [//jsfiddle.net/bdicasa/XSFpu/42/](http://jsfiddle.net/bdicasa/XSFpu/42/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:19:08.960

我建议改为这样做：

```
var module = angular.module('test', []);

module.controller('TestController', function($scope) {
    $scope.positions = [
        'Test Position 1',
        'Test Position 2',
        'Test Position 3'    
    ];

    $scope.selectedPosition = '';

    $scope.handleClick = function (index) {
        $scope.selectedPosition = $scope.positions[index];
    }
});        

module.directive('testLocationPicker', function() {    
    return {
        restrict: 'E',        
        template: 'Choose a position: <div class="position" ng-repeat="position in positions" ng-click="handleClick($index)">{{position}}</div>',        
    }        
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:05:07.487

无需尝试搜索 dom 并添加点击事件，只需像这样修改您的模板：

```
 template: 'Choose a position: <div class="position" ng-repeat="position in positions" data-ng-click="positionClick($index)">{{position}}</div>', 
```

然后在链接函数中创建一个 positionClick 函数：

```
var linkFn = function(scope, element, attrs) {
    scope.positionClick = function(index){
     scope.selectedPosition = index;   
    }
}; 
```

工作jsFiddle：http: [//jsfiddle.net/XSFpu/77/](http://jsfiddle.net/XSFpu/77/)

您的方法不起作用的原因是模板加载后没有触发 ng-repeat。所以它加载了指令，并且链接功能已经被击中，但 ng-repeat 实际上还没有开始重复。这就是为什么我建议移动你的一些代码来适应它。

# c++ - Winsock recv 循环无法正常工作

> ID：13770533
> 
> 赞同：1
> 
> 时间：2012-12-07T20:32:19.037
> 
> 标签：c++, sockets, networking, winsock

出于某种原因，当我使用 Putty 连接到我的 C++ 服务器时，我得到了这个

```
Recv: (string I typed)
Recv: 
```

每次我使用 Putty 将字符发送到我的服务器时都会发生这种情况

来源如下。如果必要的话，我会发布我的其他来源。TYIA-罗兰

```
 void recvthread( void *pParams )    {

        char buffer[128]

        int err;
        bool gonow = true;

        while( true )   {

           memset( buffer, '\0', 128 );

           err = -1;
           err = recv( datasock, buffer, 128, 0 );

            if( err != -1 ) {

              std::cout << "Recv: " << buffer << '\n';
              std::cout << "Err = " << err << '\n';
           }

        Sleep(10);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T22:05:26.907

> 我明白了：

```
Recv: (string I typed)
Recv: 
```

您将获得您键入的字符串以及上次在缓冲区中剩余的任何其他内容。如果`err`为正，则为实际接收的字节数。如果为零，则表示对等方已断开连接，您应该停止阅读。不要忽视这些价值观。

# asp.net-mvc - ASP.NET Web API，从 Flex FileReference 上传时 MIME 多部分流意外结束

> ID：13770536
> 
> 赞同：28
> 
> 时间：2012-12-07T20:32:29.913
> 
> 标签：asp.net-mvc, apache-flex, asp.net-web-api

按照 ASP.NET 上的教程，实现了一个 Web API 控制器方法来进行异步文件上传，如下所示：

```
public Task<HttpResponseMessage> PostFormData()
{
    // Check if the request contains multipart/form-data.
    if (!Request.Content.IsMimeMultipartContent())
    {
        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
    }

    string root = HttpContext.Current.Server.MapPath("~/App_Data");
    var provider = new MultipartFormDataStreamProvider(root);

    // Read the form data and return an async task.
    var task = Request.Content.ReadAsMultipartAsync(provider).
        ContinueWith<HttpResponseMessage>(t =>
        {
            if (t.IsFaulted || t.IsCanceled)
            {
                Request.CreateErrorResponse(HttpStatusCode.InternalServerError, t.Exception);
            }

            return Request.CreateResponse(HttpStatusCode.OK);
        });

    return task;
} 
```

通过标准的多部分 HTML 表单上传文件非常有效。但是，当另一个开发人员尝试通过 Flex 的 FileReference 类构造的多部分表单上传文件时，会引发错误：

> MIME 多部分流的意外结束。MIME 多部分消息不完整。

我不知道问题出在 Web API 还是 Flex 上。我发现了一些没有影响的相关修复（[使用 ASP.Net Web API 的 Multipart form POST](https://stackoverflow.com/questions/12384544/multipart-form-post-using-asp-net-web-api)），以及最近的这个（[“MIME multipart stream.MIME multipart message is not complete”error on webapi upload](https://stackoverflow.com/questions/10139052/mime-multipart-stream-mime-multipart-message-is-not-complete-error-on-webapi)）。如果第二个链接成立，有谁知道它是否出现在通过 Nuget 提供的当前 Web API 版本中？讨论是在 5 月，Nuget 的最新版本是 8 月，所以我假设这个修复程序已经部署，并且不是我问题的根本原因。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-08-13T14:43:28.677

我对 MVC4 有同样的问题，但是 Will 是正确的，在你的输入中添加一个名称.....

```
<input type="file" id="fileInput" name="fileInput"/> 
```

所有的魔法都恢复了并开始工作了！

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-06-25T06:55:53.187

我对 flex 也有同样的问题。下面是解决它的代码。基本上，我使用自定义流来附加 asp.net web api 所期望的换行符。

```
 Stream reqStream = Request.Content.ReadAsStreamAsync().Result;
        MemoryStream tempStream = new MemoryStream();
        reqStream.CopyTo(tempStream);

        tempStream.Seek(0, SeekOrigin.End);
        StreamWriter writer = new StreamWriter(tempStream);
        writer.WriteLine();
        writer.Flush();
        tempStream.Position = 0;

         StreamContent streamContent = new StreamContent(tempStream);
         foreach(var header in Request.Content.Headers)
         {
             streamContent.Headers.Add(header.Key, header.Value);
         }

        // Read the form data and return an async task.
         await streamContent.ReadAsMultipartAsync(provider); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-08T14:42:54.227

阅读您现有的研究并跟踪报告的 codeplex 问题，看起来其他人确认此问题在 9 月仍然存在。

他们认为 MVC 4 无法在没有终止“\r\n”的情况下解析上传。

> 这个问题真的很简单，但很难解决。问题是 Uploadify 没有在 MultiPartForm 消息的末尾添加“\r\n”

[http://aspnetwebstack.codeplex.com/discussions/354215](http://aspnetwebstack.codeplex.com/discussions/354215)

值得检查一下 Flex 上传是否添加了“\r\n”

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-02-15T17:27:11.157

对于那些登陆这里谷歌搜索的人：

> MIME 多部分流的意外结束。MIME 多部分消息不完整。

多次读取请求流也会导致此异常。我挣扎了好几个小时，直到找到一个解释请求流只能读取一次的来源。

就我而言，我结合尝试使用 a 读取请求流`MultipartMemoryStreamProvider`，同时让 ASP.NET 通过为我的 api 方法指定参数（来自请求正文）为我做一些魔术。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-05-02T14:44:08.460

确保首先上传图像文件的虚拟目录（“~/App_Data”目录，如下例）是物理存在的。发布项目时，它可能不在输出文件中。

```
string root = HttpContext.Current.Server.MapPath("~/App_Data");
var provider = new MultipartFormDataStreamProvider(root); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-21T07:39:46.190

我刚刚删除了我在 post 方法上设置的标题，最终解决了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-16T14:42:06.103

问题是这一行：

```
string root = HttpContext.Current.Server.MapPath("~/App_Data"); 
```

它只能在 localhost 中工作，您可以在 System.Web 对象（如 HttpContext.Current）不可用的任何上下文中使用 HostingEnvironment.MapPath 代替（例如，也来自静态方法）。

```
var mappedPath = System.Web.Hosting.HostingEnvironment.MapPath("~/SomePath"); 
```

另请参阅[Server.MapPath 和 HostingEnvironment.MapPath 有什么区别？](https://stackoverflow.com/questions/944219/what-is-the-difference-between-server-mappath-and-hostingenvironment-mappath)

参考这个答案[How to do a Server Map Path。](https://stackoverflow.com/questions/16557122/microsoft-web-api-how-do-you-do-a-server-mappath)

# eclipse - 关于 Ubuntu 权限和快捷方式的一些问题

> ID：13770538
> 
> 赞同：0
> 
> 时间：2012-12-07T20:32:36.933
> 
> 标签：eclipse, ubuntu, netbeans, sudo

我刚刚从网站上直接下载了 Eclipse IDE 和 Netbeans，然后安装在我的 Ubuntu 12.04 中。我有一些问题：

1 - 如何在 Ubuntu 的侧边栏中添加他们的快捷方式？
2 - 当我使用 gnome-desktop-item-edit 应用程序在桌面中添加快捷方式时，我不能拥有超级用户权限来操作，Netbeans IDE（使用脚本文件启动）显示很多错误告诉一些文件是只读的。如何在使用 gnome-desktop-item-edit 创建的启动器中添加 sudo 权限？

对不起，我的英语很差。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:56:09.717

至于问题#1，首先，打开程序。在侧边栏找到它的图标，然后右键单击它，然后选择“保留在启动器中”。</p>

至于＃2，在Ubuntu中，您可以编辑要运行的项目`gksudo COMMAND`，但这是非常不明智的（在桌面上以提升的权限运行任何东西。您可能应该修复相关文件的权限（右键单击文件，并允许自己）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T11:12:28.050

好吧，经过几天尝试为我的问题找到更好的解决方案，我认为更好的解决方案是首先从 Ubuntu 软件中心下载 Eclipse 和/或 NetBeans IDE，然后：

*   对于 NetBeans：使用 IDE 的插件管理器下载所需的插件，并制作（如果需要）IDE 更新过程。
*   对于 Eclipse：下载后，按照[此链接](https://askubuntu.com/questions/81341/install-eclipse-ide-for-java-ee-dev-via-apt-get-is-it-possible/81347#81347)的步骤操作。

遵循此操作后，如果您像我一样使用 Gnome 3，则可以轻松创建指向“侧边栏”的收藏链接，或者无需 sudo 权限即可制作桌面快捷方式，只需使用 gnome-desktop-item-edit 工具或任何您喜欢的工具。

# fonts - 如何将 4 种字体样式合并到一个文件中？

> ID：13770542
> 
> 赞同：5
> 
> 时间：2012-12-07T20:32:52.650
> 
> 标签：fonts, font-face

我想使用自定义字体作为@font-face，但每种样式都有 4 个不同的文件：常规、粗体、斜体、粗斜体。

是否有一种工具可以将它们组合到一个文件中，这样我们就不会收到 4 个 HTTP 请求？

# ios - 字典中的单元格标题

> ID：13770545
> 
> 赞同：0
> 
> 时间：2012-12-07T20:32:55.537
> 
> 标签：ios, uitableview

我有一张有 3 个部分的桌子。我还有一系列字典，用于命名我的单元格等。我想根据最喜欢的键用我的字典中的项目填充我的第二部分。

这是我的字典的样子：

```
<array>
    <dict>
        <key>favorite</key>
        <string>NO</string>
        <key>title</key>
        <string>accessories.sku</string>
        <key>checkedState</key>
        <string>NO</string>
    </dict>
    <dict>
        <key>favorite</key>
        <string>YES</string>
        <key>title</key>
        <string>accessoriesImage</string>
        <key>checkedState</key>
        <string>NO</string>
    </dict> 
```

对于其他事情，我之前已经遍历过这本字典，我知道我需要再次这样做，但对于这种情况，我无法完全掌握。

```
static NSString *kTitleKey = @"title";
static NSString *kCheckedState  = @"checkedState";
static NSString *kFavorite = @"favorite";

for (id dict in myArray]) {
    if ([dict[kFavorite] isEqualToString:@"YES"]) {
       cell.textLabel.text = [myArray objectAtIndex:[indexPath row] valueForKey:kTitleKey];
    }
} 
```

但是当然**cell.textLabel.text = [myArray objectAtIndex:[indexPath row] valueForKey:kTitleKey]**是不正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T12:43:57.817

你已经匹配了你`dictionary[kFavorite]`为什么要从`myArray`. 你可以像这样编写你的循环，

```
for (id dict in myArray]) {
   if ([dict[kFavorite] isEqualToString:@"YES"]) {
      cell.textLabel.text = dict[kTitleKey];
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:40:40.397

您可以使用 NSPredicate 过滤数组，然后使用过滤后的数组驱动第二部分：

```
static NSString *kTitleKey = @"title";
static NSString *kCheckedState  = @"checkedState";
static NSString *kFavorite = @"favorite";

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%@ CONTAINS[c] %@", kFavorite, @"YES"];

NSArray *filteredArray = [myArray filteredArrayUsingPredicate:predicate]; 
```

# objective-c - 最近的文件

> ID：13770546
> 
> 赞同：0
> 
> 时间：2012-12-07T20:32:58.690
> 
> 标签：objective-c, xcode, macos, cocoa

到处搜索，但没有在沙箱中找到这样做的方法：

如何获取 osx 中所有最近文件（系统范围）的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T23:35:51.670

它们存储在`~/Library/Preferences/com.apple.recentitems.plist`文件中。

您需要临时权利`com.apple.security.temporary-exception.files.home-relative-path.read-only = Library/Preferences`

您需要使用 NSDictionary 手动读取 plist，因为 CFPrefs API 失败 -> 它总是尝试打开沙箱文件夹中的首选项，并且您无法为文件指定 PATH

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T01:04:38.827

*不*涉及硬编码路径名的方法是使用 LSSharedFileList。有问题的列表是`kLSSharedFileListRecentDocumentItems`。

如果列表不完整或沙箱阻止访问它，我建议[提交一个错误](https://bugreport.apple.com/)。

# assembly - 输入字符串，显示输入的字符串并将字符串大写转换为小写？

> ID：13770548
> 
> 赞同：0
> 
> 时间：2012-12-07T20:33:14.283
> 
> 标签：assembly, x86, x86-16, assembly-resolution

我坚持输入字符串，显示输入的字符串并将字符串大写转换为小写。

我必须使用emu8086.inc，但我不知道如何将下面的代码转换为接受字符串而不是数字/整数。有人愿意就此事进一步指导吗？

8086 asm 代码：

```
include 'emu8086.inc'

ORG    100h 

LEA    SI, msg1      
CALL   print_string   
CALL   scan_num       

MOV    AX, CX       

; print the following string:
CALL   pthis
DB  13, 10, 'You have entered: ', 0

CALL   print_num      

RET          

msg1   DB  'Enter the number: ', 0

DEFINE_SCAN_NUM
DEFINE_PRINT_STRING
DEFINE_PRINT_NUM
DEFINE_PRINT_NUM_UNS 
DEFINE_PTHIS
END 
```

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:56:56.930

我不确定 emu8086.inc 包含哪些功能。

在 Linux 系统上，您也许可以使用系统调用，但我不确定是否从未使用过 Linux。在 Windows 上，最好通过与 MSVCRT.dll 链接来包含像 scanf 这样的 C 函数，或者与 Kernell32.dll 链接的 Windows 提供的控制台函数（请参阅[控制台函数）。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682073%28v=vs.85%29.aspx)我会查看您的汇编程序文档，了解如何链接到 dll 并调用各个函数。C 运行时 MSVCRT.dll 还包括将字符串转换为大写的函数“toupper”。Windows 可能有类似的功能，但我不确定。

# php - 使用 PDO 返回整个表的值

> ID：13770550
> 
> 赞同：0
> 
> 时间：2012-12-07T20:33:35.727
> 
> 标签：php, pdo

我想运行我认为将是一个简单的查询。我想以写入 $data[i][k] 的相同 2D 样式返回一个数据库表（仅返回值）

我正在使用 PHP 的 PDO，我能得到的最接近的是：

```
$result=$database->query("SELECT * FROM `garage_statistics`",$bind = null,$fetch = 'FETCH_COLUMN');
$this->statement = $this->pdo->prepare($query);
$result = $this->statement->fetchAll(PDO::FETCH_COLUMN,1); 
```

哪个返回

```
0 => string 'Garage2' (length=1)
1 => string 'Garage3' (length=7)
2 => string 'Garage4' (length=7)
3 => string 'Garage6' (length=7)
4 => string 'Garage7' (length=7) 
```

但是我不能让它循环所有的列。我尝试了 fetchall 并返回：

```
array (size=10)
0 => 
array (size=14)
  'name' => string 't' (length=1)
  0 => string 't' (length=1)
  'tablename' => string 't' (length=1)
  1 => string 't' (length=1)
  'numfloors' => string '3' (length=1)
  2 => string '3' (length=1)
  'status' => string '4' (length=1)
  3 => string '4' (length=1)
  'numspots' => string '0' (length=1)
  4 => string '0' (length=1)
  'spotsinuse' => string '0' (length=1)
  5 => string '0' (length=1)
  'time' => string '2012-12-07 13:47:13' (length=19)
  6 => string '2012-12-07 13:47:13' (length=19)
1 => 
array (size=14)
  'name' => string 'Garage 3' (length=8)
  0 => string 'Garage 3' (length=8)
  'tablename' => string 'Garage3' (length=7)
  1 => string 'Garage3' (length=7)
  'numfloors' => string '2' (length=1)
  2 => string '2' (length=1)
  'status' => string '3' (length=1)
  3 => string '3' (length=1)
  'numspots' => string '0' (length=1)
  4 => string '0' (length=1)
  'spotsinuse' => string '0' (length=1)
  5 => string '0' (length=1)
  'time' => string '2012-12-07 13:49:46' (length=19)
   6 => string '2012-12-07 13:49:46' (length=19) 
```

虽然这确实包含所有数据，但它有很多我不想要的东西。

有没有一种简单的方法可以使用 PDO 获取表的基本二维数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:39:32.143

$result = $this->statement->fetchAll(PDO::FETCH_NUM);

返回正确的类型

# sql - 当重复项不在同一列时删除重复项

> ID：13770551
> 
> 赞同：0
> 
> 时间：2012-12-07T20:33:36.527
> 
> 标签：sql, excel, duplicates, sas

这是我的数据样本 (n>3000)，它将两个数字联系在一起：

```
id  a       b
1   7028344 7181310
2   7030342 7030344
3   7030354 7030353
4   7030343 7030345
5   7030344 7030342
6   7030364 7008059
7   7030659 7066051
8   7030345 7030343
9   7031815 7045692
10  7032644 7102337 
```

现在，问题是 id=2 是 id=5 的副本，而 id=4 是 id=8 的副本。因此，当我尝试编写 if-then 语句将 column 映射`a`到 column`b`时，基本上数字只是被交换了。在我的完整数据中有很多这样的案例。

所以，我的问题是识别重复项并以某种方式删除其中一个重复项（id=2 或 id=5）。我最好在 Excel 中执行此操作，但我也可以使用 SQL Server 或 SAS。

先感谢您。如果我的问题不清楚，请发表评论。

我想要的是：

```
id  a       b
1   7028344 7181310
2   7030342 7030344
3   7030354 7030353
4   7030343 7030345
6   7030364 7008059
7   7030659 7066051
9   7031815 7045692
10  7032644 7102337 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:49:23.790

各种各样的方法来做到这一点。

在 SAS 或 SQL 中，这很简单（对于 SQL Server，SQL 部分应该相同或几乎相同）：

```
data have;
input id a b;
datalines;
1   7028344 7181310
2   7030342 7030344
3   7030354 7030353
4   7030343 7030345
5   7030344 7030342
6   7030364 7008059
7   7030659 7066051
8   7030345 7030343
9   7031815 7045692
10  7032644 7102337
;;;;
run;

proc sql undopolicy=none;
delete from have H where exists (
  select 1 from have V where V.id < H.id
    and (V.a=H.a and V.b=H.b) or (V.a=H.b and V.b=H.a)
);
quit; 
```

excel解决方案将需要创建一个附加列，我相信这两个字符串的连接按顺序排列（任何顺序都可以），然后查找是否是具有该值的第一行。我认为如果不创建额外的列（或使用 VBA，如果你可以使用它也将有一个相当简单的解决方案），你就无法做到这一点。

编辑：实际上，无需创建新列即可使用 excel 解决方案（好吧，您需要将此公式放在某处，但没有其他附加列）。

```
=IF(OR(AND(COUNTIF(B$1:B1,B2),COUNTIF(C$1:C1,C2)),AND(COUNTIF(B$1:B1,C2),COUNTIF(C$1:C1,B2))),"DUPLICATE","") 
```

假设 ID 在 A、B 和 C 中包含值（并且没有标题行）。该公式进入第二行（即 B2/C2 值），然后扩展到其他行（因此第 36 行的数组为 B1:B35 和 C1:C35 等）。这会将 DUPLICATE 放在与上述内容重复的行中，而在唯一的行中放置空白。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:51:27.260

我还没有对此进行测试，但这里有一些值得深思的地方，您可以将表加入到自身中并获取具有重复项的 ID

```
 SELECT
     id, a, b
 FROM
    [myTable]
    INNER JOIN ( SELECT id, a, b FROM [myTable] ) tbl2
        ON [myTable].a = [tbl2].b
           OR [myTable].b = tbl2.a 
```

# jquery - 如何获取动态创建的textarea jquery的单独值

> ID：13770552
> 
> 赞同：0
> 
> 时间：2012-12-07T20:33:36.760
> 
> 标签：jquery, html

```
 <table class="cssTable">
        <tr>
            <td>
                <textarea id="txtOption1" cols="30" rows="2">Text1</textarea>
            </td>
        </tr>
    </table>
    <table  class="cssTable">
        <tr>
            <td>
                <textarea id="txtOption2" cols="30" rows="2">Text2</textarea>
            </td>
        </tr>
    </table>
    <asp:Button ID="btnClick" runat="server" OnClientClick="ClickMe();" Text="Submit" /> 
```

我尝试这样做以单独获取 textarea 的值：

```
function ClickMe() {
        $(".cssTable").each(function () {                
            alert($("[Id*=txtOption]").text());
        });
    } 
```

但是两次都将两个文本都设为**text1text2** 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:35:39.550

您需要指定上下文

```
function ClickMe() {
    $(".cssTable").each(function () {                
        alert($("[Id*=txtOption]",this).text());
       // eventually the same as $(this).find('[Id*=txtOption]')
    });
} 
```

虽然您应该使用 .val() 来获取 textarea 的值

```
alert($("[Id*=txtOption]",this).val()); 
```

# java - Java高速udp流量包接收带宽测试

> ID：13770553
> 
> 赞同：3
> 
> 时间：2012-12-07T20:33:39.440
> 
> 标签：java, nio, bandwidth

我正在尝试构建一个带宽测试工具，有点像 IPerf，但在 java 中，我似乎比预期的丢包更多，但是带宽稍高（开始于大约 30-40Mb/s），我希望有人可能指出一些优化或我做错的事情，这会导致我丢失数据包。

这是接收代码，它将大小为 2000 的队列移交给另一个收集指标的类，它只传递数据包中的相关信息。使用蔚来

```
while (data.isRunning()) 
{
    if(channel.receive(buf) != null)
    {

    int j = buf.array().length;
    //add the packets important information to the queue
    packet_info.add(new PacketInfoContainer(buf.getLong(j-12), System.nanoTime(), buf.getInt(j-4)));

    // if we have 2000 packets worth of information, time to handle it!
    if((packet_info.size() == 2000))
    {
        Runnable r1;
        //if this is running on the client side, do it this way so that we can calculate progress
        if(client_side)
        {
            if(data_con.isUserRequestStop())
            {
                System.out.println("suposed to quit");
                data.stopTest();
                break;
            }
            if(packets_expected > 0)
            {
                total_packets_received+=1000;
                setChanged();
                notifyObservers("update_progress" + Integer.toString( (int) (((double)total_packets_received/(double)packets_expected) * 1000) ) );
            }
            r1 = new PacketHandler(packet_info, results, buffer_size, client);
        }
        //server side, no nonsense
        else
        {
            r1 = new PacketHandler(packet_info, results, buffer_size);
        }
        pool.submit(r1);
        packet_info = new LinkedList<PacketInfoContainer>();
    }

}
buf.clear(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:06:54.713

UDP 不是很好...也许您可以使用 TCP 并检查 SO 的 tcp 统计信息以查看重传...

> 网络统计 -s

您可以使用[CharacterGenerator](https://github.com/ggrandes/sandbox/blob/master/src/RandomTextGenerator.java)，将 BufferedOutputStream 更改为 64KB 并删除 os.flush(); 加速和测试...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-07T11:36:09.753

它不允许我发表评论，我走了。

在达到线路限制之前，您不应该看到丢弃的数据包。我建议在花大量时间查看代码之前隔离丢包的问题并使用工具来确定您是否有硬件/环境问题。

*   [https://serverfault.com/questions/561107/how-to-find-out-the-reasons-why-the-network-interface-is-dropping-packets](https://serverfault.com/questions/561107/how-to-find-out-the-reasons-why-the-network-interface-is-dropping-packets)
*   您是否尝试过`iperf`在 UDP 模式下运行？然后检查丢弃的数据包统计信息？ [https://iperf.fr/iperf-doc.php](https://iperf.fr/iperf-doc.php)
*   `bmon`是一个简洁的工具，可以显示`carrier error`, `dropped`,`fifo error`统计数据。

# c++ - 如何在 C++ 中循环创建形状并将其附加到窗口？

> ID：13770554
> 
> 赞同：3
> 
> 时间：2012-12-07T20:33:55.277
> 
> 标签：c++, user-interface, graphics, graph, fltk

我制作了一个程序，它接受一系列命令，例如 `square 150 160` 在窗口中绘制一些形状。我想为任意数量的命令执行此操作。所以，我使用一个循环来做到这一点。问题是当创建形状并将它们附加到窗口的命令处于循环中时，最后窗口没有内容，例如没有附加任何内容。我认为这可能会发生，因为在循环内创建形状的调用会在其块（范围）结束后被销毁。

我该如何克服这个问题？

这是我的代码：

```
#include "Simple_window.h"
#include "Graph.h"
#include <string.h>
#include "Point.h"
#include "Window.h"
#include "GUI.h"

string shape[100],color[100],name;
int x[100],y[100],side[100],width[100],height[100],radius[100],i=0;

int main()
{

  using namespace std;
  using namespace Graph_lib;

  //---------------Reading Input------------------------------------------------//
  while (( cin >> name)&&(i<=3))
  {

  if (name.compare("square") == 0 ){
    i++;

    shape[i]="square";
    cin >> x[i] >> y[i] >> side[i] >> color[i];
  }else if (name.compare("circle") == 0){
    i++;

    shape[i]="circle";
    cin >> x[i] >> y[i] >> radius[i] >> color[i];
  }else if (name.compare("rectangle") == 0){
    i++;

    shape[i]="rectangle";
    cin >> x[i] >> y[i] >> width[i] >> height[i] >> color[i] ;
  }

}

Simple_window win(Point(100,100), 900, 600, "test");

for( i=1;i<=3;i++){

if (shape[i].compare("circle") == 0){
    Circle r(Point(x[i],y[i]),radius[i]);
    win.attach(r);
    cout << "circle";

}else if(shape[i].compare("rectangle")==0){
    Rectangle l(Point(x[i],y[i]),width[i],height[i]);
    win.attach(l);
    cout << "rect";

}else if(shape[i].compare("square")==0){
    Rectangle k(Point(x[i],y[i]),side[i],side[i]);
    win.attach(k);
    cout << "square";
 }

}

win.wait_for_button();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:46:52.813

您的变量需要动态创建以避免在超出范围时被销毁。

```
Circle *r = new Circle(Point(x[i],y[i]),radius[i]);
win.attach(*r); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:56:19.553

这取决于您的附加函数的编写方式，当它通过引用传递参数时，调用函数时不会复制对象，并且实际上添加的对象将在其范围用完时被销毁，即。for 循环块。
在这种情况下，您可以重写 window.attach() 函数，或者您需要使用指针和“new”语句来创建对象。当你使用 new 时，你也应该使用 delete 来销毁不再需要的对象！可能最好在窗口类的析构函数中添加附加对象的销毁...

```
Circle r = new Circle(Point(x[i],y[i]),radius[i]);
win.attach(*r) 
```

如果你不知道这一点，你真的应该学习更多关于 C++ 中的指针

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T13:51:47.990

在 FLTK 演示目录中有一个如何制作自定义形状小部件的示例。恕我直言，这是做你想做的事情的方式。一旦您制作了所有形状（Widget 类的子类），就很容易将它们放入 a `fltk::Group`（`fltk::Window`例如 a）中。

我正在谈论的演示是关于星形小部件。我不记得确切的文件名。

更新：一种更简单的方法是简单地覆盖窗口的 draw() 方法，并简单地绘制所有形状......这非常容易 - 阅读以下内容： http: [//www.fltk.org/doc-1.3 /绘图.html](http://www.fltk.org/doc-1.3/drawing.html)。

# css - 在 CSS 中，如何在多个 id 下选择特定标签？

> ID：13770556
> 
> 赞同：0
> 
> 时间：2012-12-07T20:34:01.263
> 
> 标签：css

我有 5 个具有唯一 ID 的字段集。我想为其中的所有输入标签赋予特定的样式。例如：#fieldset-long1,#fieldset-long2,#fieldset-long3,#fieldset-long4,#fieldset-long5{字段集的样式}

现在要为这 5 个字段集中的输入赋予样式，我将不得不写`#fieldset-long1 input,#fieldset-long2 input,#fieldset-long3 input{style for input}`.

只是想知道是否有更简单的 CSS 选择器来指定我想要应用样式的标签的父级。

字段集的 HTML：

```
<fieldset id="fieldset-long1">
<dt><label for="email">Email:</label></dt>
<dd><input type="text" name="email" id="email" value="" tabindex="3" /></dd>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:39:15.923

使用低于 3 的 css 是不可能的，但使用 css3 您可以执行以下操作：

```
fieldsets [id^="fieldset"] input{/* style for input*/ } 
```

# python - Python 具有挑战性的字符串编码

> ID：13770560
> 
> 赞同：2
> 
> 时间：2012-12-07T20:34:08.723
> 
> 标签：python, mysql, sql

我有以下提供商列表（俄语）：

```
providers = [u'\u041e\u041e\u041e "\u041a\u0432\u0430\u0440\u0442\u0430\u043b 
            \u041b\u0435\u043e\u043f\u043e\u043b\u0438\u0441"', 
            u'\u0426\u0435\u043d\u0442\u0440\u0430\u043b'] 
```

这些显然是unicode。以前，为了做一个 SQL SELECT，我在做：

```
providers = tuple([str(item) for item in providers])
sql += " WHERE provider IN {} GROUP BY date ORDER BY date ASC".format(repr(providers))
cursor.execute(sql,) 
```

现在，由于列表项是 unicode，我遇到了`UnicodeEncodeError`.

我将如何正确执行此 sql 语句？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:36:40.567

您不应该使用`.format()`在 sql 查询中包含值。改用 sql 参数：

```
sql += " WHERE provider IN ({}) GROUP BY date ORDER BY date ASC".format(', '.join(['%s'] * len(providers)))

cursor.execute(sql, providers) 
```

`providers`原始列表在哪里。

`in`这个想法是使用与列表中提供者数量相匹配的 SQL 参数语法生成带有测试的 SQL 查询：`WHERE provider in (%s, %s) ...`对于两个提供者列表。是的，MySQLdb sql 参数语法与旧式 python 格式化语法相呼应，但不是一回事。

# javascript - 将时间转换为有效格式

> ID：13770561
> 
> 赞同：0
> 
> 时间：2012-12-07T20:34:09.847
> 
> 标签：javascript, regex, selenium-ide

我正在尝试提出一个正则表达式来获取以下字符串：1:38P 并将其转换为有效格式以解析日期。我需要

1.  检查最后一个字符是 A 还是 P，如果不是，则对字符串不执行任何操作。
2.  如果最后一个字母是 A 或 P，则从字符串中删除该字母，并在字符串前面加上零 (0)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:53:25.047

```
var d = "1:38P";
var pat = /^(\d+:\d+)(A|P)$/;
var m = pat.exec(d);
if (m) { console.log('We have our winner' + 0 + m[1]} 
```

# javascript - 使用 jQuery 更新 HTML H4 标签

> ID：13770562
> 
> 赞同：12
> 
> 时间：2012-12-07T20:34:11.920
> 
> 标签：javascript, jquery

我在使用 jQuery 更改 HTML 标记之间的“文本”时遇到问题。当有人点击“单选按钮”时，文本应该在某个 HTML 元素中更新。这是我的 HTML：

```
<div class="radio-line" id="radio-manager">
    <input type="radio" id="rad-400" name="radio-manager" value="No"  />
</div> 
```

无线电检查时要更新的 HTML：

```
<h4 class="manager">Manager</h4> 
```

当有人点击上面的收音机时，“经理”文本应该变成“员工”。我尝试了一些 jQuery 代码，但无法弄清楚。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-07T20:38:50.277

看看下面的小提琴。

[http://jsfiddle.net/JBjXN/](http://jsfiddle.net/JBjXN/)

```
<div class="radio-line" id="radio-manager">
    <input type="radio" id="rad-400" name="radio-manager" value="No" data-text="Employees" />
</div>

<h4 class="manager">Manager</h4>

$('.radio-line').on('click', 'input[type="radio"]', changeText);

function changeText(e) {
    $('.manager').text($(e.currentTarget).data('text'));
}​ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-07T20:44:36.223

你需要做的就是这个——

```
$('input[name="radio-manager"]').change(function() {
    if($('#rad-400').is(':checked')){
        $('h4.manager').text('Employees');
    } else {
        $('h4.manager').text('Manager');
    }
}); 
```

见[http://jsfiddle.net/Eub9Y/](http://jsfiddle.net/Eub9Y/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T20:41:25.193

从我上面的评论：

```
$("h4.manager").text("Employees"); 
```

应该管用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T20:41:04.073

这行得通吗？

```
$("#rad-400").on("click", function () {
    $(".manager").text("Employees");
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T20:40:27.947

这应该适合你：

```
$("#rad-r00").click(function() {
    if ($('input:radio[name=radio-manager]:checked').val() == "Yes") {
        $(".manager").html('Manager')
    }
    else {
        $(".manager").html('Not - Manager');
    }
 }); 
```

# mysql - 根据另一行的内容从其他行获取数据

> ID：13770566
> 
> 赞同：0
> 
> 时间：2012-12-07T20:34:40.600
> 
> 标签：mysql

我有一个数据表，可能如下所示。用户总是以 6 个块的形式提交答案。如果有人对问题 ID 1 回答了“1”，那么我需要知道他们对问题 4 的回答是什么，或者如果他们对问题 2 回答了 1，那么我需要他们对问题 5 的回答，如果他们对问题 3 回答了 1，我需要他们的回答问题 6。

```
user   questionID    response
1      1             2
1      2             3
1      3             1
1      4             5
1      5             5
1      6             2
2      1             1
2      2             6
2      3             3
2      4             3
2      5             2
2      6             5 
```

我真的可以在这方面提供一些帮助。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:52:54.593

这是你需要的吗？尝试运行此查询。

```
select u1.*, u2.response from users u1
left join users u2
on u1.user = u2.user and u1.questionID = u2.questionID - 3
where u1.response = 1 
```

* * *

**substring('inp1' FROM 4) 给出 1：**

```
select u1.*, u2.response from users u1
left join users u2
on u1.user = u2.user and
  substring(u1.questionID FROM 4) = substring(u2.questionID FROM 4) - 3
where u1.response = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:58:01.583

我认为您想要一个“枢轴”，您可以在其中获得所有答案：

```
select
  t1.response as response1,
  t2.response as response2,
  t3.response as response3,
  t4.response as response4,
  t5.response as response5,
  t6.response as response6
from mytable t1
left join mytable t2 on t1.user = t2.user and t2.questionId = 2
left join mytable t3 on t1.user = t3.user and t3.questionId = 3
left join mytable t4 on t1.user = t4.user and t4.questionId = 4
left join mytable t5 on t1.user = t5.user and t5.questionId = 5
left join mytable t6 on t1.user = t6.user and t6.questionId = 6
where t1.user = ? 
```

我会将其设为视图并添加`t1.user`为列，然后您可以从 user = ? 的视图中选择。

# c# - Windows Phone 7 将资源字符串值设置为 .xml

> ID：13770567
> 
> 赞同：0
> 
> 时间：2012-12-07T20:34:48.990
> 
> 标签：c#, windows-phone-7

是否可以将 .resx 中的字符串设置为位于我的项目中的 .xml？

例如，

名称 = 文件名值 = Project.Objects.File.xml 注释 = 我的 xml 文件

然后解析资源名称而不是“file.xml”，输入类似 Resource.Filename?

```
var streamInfo = Application.GetResourceStream(new Uri(Resource.FileName, UriKind.Relative));
        XDocument xdoc;
        using (var s = streamInfo.Stream)
            xdoc = XDocument.Load(s); 
```

我想做这样的事情，但显然这不起作用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:04:05.250

回答我自己的问题，但在这里没有得到回应......

原来我不需要为 FileName 字符串上的值设置 FilePath。只需将值设置为 examplefile.xml，即可让 ResourceStream 正常工作。

# c# - 如何检测 MenuStrip 的打开和关闭状态？

> ID：13770570
> 
> 赞同：2
> 
> 时间：2012-12-07T20:34:58.893
> 
> 标签：c#, menustrip

我需要检测 MenuStrip（不是上下文菜单）何时打开和关闭。Enter 和 Leave 事件似乎不起作用。

为什么需要它：我使用带有“文件”、“编辑”、“关于”等选项的 MenuStrip。但是当菜单条处于活动状态时，用户使用鼠标或键盘浏览它时，其他控件Windows 窗体也响应它。

例如：我使用鼠标在我的应用程序中单击“编辑 > 选择性粘贴.. > 无格式文本”。但在展开的菜单项下方是一个 XNA 2d 渲染控件，它还可以检测鼠标输入并执行我不希望它执行的操作。现在，如果我可以检测菜单何时打开，我可以禁用/启用适当的控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:43:07.920

在不了解您在做什么的情况下，您可以尝试以下代码：

```
 private void Form1_Load(object sender, EventArgs e)
  {
     menuStrip1.GotFocus += new EventHandler(MenuStrip1_GotFocus);
     menuStrip1.LostFocus += new EventHandler(MenuStrip1_LostFocus);
  }

  private void MenuStrip1_GotFocus(object sender, EventArgs e)
  {
     textBox1.Text = "Has Focus";
  }

  private void MenuStrip1_LostFocus(object sender, EventArgs e)
  {
     textBox1.Text = "Lost Focus";
  }

  private void menuStrip1_MenuActivate(object sender, EventArgs e)
  {
     textBox1.Text = "Has Focus";
  }

  private void menuStrip1_MenuDeactivate(object sender, EventArgs e)
  {
     textBox1.Text = "Lost Focus";
  } 
```

这似乎适用于您上面描述的内容。如果您的菜单条在 (true) 上有制表位，那么得到的焦点事件将处理这种情况。如果您只需要在使用鼠标时进行更改，那么 Menu Active 事件应该可以工作。

# json - 在来自 JSON 的 HTML 中正确显示 \n \r

> ID：13770581
> 
> 赞同：0
> 
> 时间：2012-12-07T20:35:42.107
> 
> 标签：json, gwt, html-encode

我有一个从数据库中获取的字符串并使用 Servlet 从后端发送。servlet 构造 JSON 并将其发送给客户端

我使用这个函数来转义 JSON

```
public static String toHTML(String string){
        StringBuffer sb =  new StringBuffer();
                    for(int i=0;i<string.length();i++){
                            char ch=string.charAt(i);
                            switch(ch){
                            case '"':
                                    sb.append("\\\"");
                                    break;
                            case '\\':
                                    sb.append("\\\\");
                                    break;
                            case '\b':
                                    sb.append("\\b");
                                    break;
                            case '\f':
                                    sb.append("\\f");
                                    break;
                            case '\n':
                                    sb.append("\\n");
                                    break;
                            case '\r':
                                    sb.append("\\r");
                                    break;
                            case '\t':
                                    sb.append("\\t");
                                    break;
                            case '/':
                                    sb.append("\\/");
                                    break;
                            default:
                    //Reference: http://www.unicode.org/versions/Unicode5.1.0/
                                    if((ch>='\u0000' && ch<='\u001F') || (ch>='\u007F' && ch<='\u009F') || (ch>='\u2000' && ch<='\u20FF')){
                                            String ss=Integer.toHexString(ch);
                                            sb.append("\\u");
                                            for(int k=0;k<4-ss.length();k++){
                                                    sb.append('0');
                                            }
                                            sb.append(ss.toUpperCase());
                                    }
                                    else{
                                            sb.append(ch);
                                    }
                            }
                    }//for
                    return sb.toString();

    } 
```

但是，一旦显示，我就会看到转义字符。例如“某事\r\n”。有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:33:36.160

`\r\n`显然浏览器无法解释。替换`\r\n`为`<br>`，你得到了 HTML 中的换行符。相应地替换其他标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:36:51.630

用于替换换行符的 JavaScript 函数

```
var nl2br = function(str, is_xhtml) {
    var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br />' : '<br>';
    return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
}

console.log(nl2br('asdf', false));     // asdf

console.log(nl2br('as\r\ndf', false)); // as<br>
                                       //
                                       // df

console.log(nl2br('as\n\rdf', true));​  // as<br />
                                       //
                                       // df 
```

# python - 更改列表字典中的一个 python 列表会更改所有列表

> ID：13770585
> 
> 赞同：1
> 
> 时间：2012-12-07T20:36:17.677
> 
> 标签：python, list, dictionary

> **可能重复：**
> [两个单独的 python 列表充当一个](https://stackoverflow.com/questions/9969609/two-separate-python-lists-acting-as-one)

此代码创建一个列表字典，键位于`usens`. 列表中满是`0`s

```
usens = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 110, 111, 112, 113, 114,
         115, 116, 117, 118, 119, 302, 303, 306, 307, 308, 370, 371, 500,
         501, 1000, 1010, 1020, 1100, 1200, 1201, 1202, 2000, 2001, 2002
         ]
empty = [[0]*length]*len(usens)
data = dict(zip(usens, empty))
pprint.pprint(data, indent=5)

data[0][0] += 1
pprint.pprint(data, indent=5) 
```

第一个漂亮的打印返回预期的（去除模糊）：

```
{0: [0, 0, 0, 0, 0],
 1: [0, 0, 0, 0, 0],
 2: [0, 0, 0, 0, 0],
 3: [0, 0, 0, 0, 0],
 4: [0, 0, 0, 0, 0],
 5: [0, 0, 0, 0, 0],
 .....
 2001: [0, 0, 0, 0, 0],
 2002: [0, 0, 0, 0, 0]} 
```

然后我这样做：`data[0][0] += 1`，期望第一个列表（索引`0`）以 开头`1`，但没有其他改变。

但是，所有列表都已修改：

```
{0: [1, 0, 0, 0, 0],
 1: [1, 0, 0, 0, 0],
 2: [1, 0, 0, 0, 0],
 3: [1, 0, 0, 0, 0],
 4: [1, 0, 0, 0, 0],
 .....
 2001: [1, 0, 0, 0, 0],
 2002: [1, 0, 0, 0, 0]} 
```

**为什么，我怎样才能使它只修改一个列表？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:40:52.357

`empty = [[0]*length]*len(usens)`将创建`len(usens)`相同列表的副本，这`len(usens)`与具有相同内容的列表不同。

试试`empty = [[0]*length for i in range(len(usens))]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:48:13.580

使用`*`创建副本；因为`[0]`它很好，因为它正在复制一个不可变的标量；但外部`*`创建相同列表的副本（即，复制引用）。你可以使用类似的东西：

```
empty = [0]*5
data = {n:list(empty) for n in usens} 
```

（一个字典理解）来创建你的列表（如果使用 Python 2.7+）。使用`list`制作副本。

# c# - 在 JPG 文件上叠加水印 PNG 居中

> ID：13770587
> 
> 赞同：0
> 
> 时间：2012-12-07T20:36:21.927
> 
> 标签：c#, system.drawing

我有一种方法可以获取图像并调整其大小并保存它以保留 exif 信息。我现在要做的是在图像顶部覆盖一个透明的PNG图像作为水印。png 的大小将始终大于我要放置的任何图像。我想把它放在图像的顶部，保留水印的纵横比。这是我到目前为止的代码：

```
private static void ResizeImage(Image theImage, int newSize, string savePath, IEnumerable<PropertyItem> propertyItems)
{
    int width;
    int height;
    CalculateNewRatio(theImage.Width, theImage.Height, newSize, out width, out height);
    using (var b = new Bitmap(width, height))
    {
        using (var g = Graphics.FromImage(b))
        {
            g.SmoothingMode = SmoothingMode.AntiAlias;
            g.InterpolationMode = InterpolationMode.HighQualityBicubic;
            g.PixelOffsetMode = PixelOffsetMode.HighQuality;
            using(var a = Image.FromFile("Watermark.png"))
            {
                g.DrawImage();  //What to do here?
            }
            g.DrawImage(theImage, new Rectangle(0, 0, width, height));

            var qualityParam = new EncoderParameter(Encoder.Quality, 80L);
            var codecs = ImageCodecInfo.GetImageEncoders();
            var jpegCodec = codecs.FirstOrDefault(t => t.MimeType == "image/jpeg");
            var encoderParams = new EncoderParameters(1);
            encoderParams.Param[0] = qualityParam;
            foreach(var item in propertyItems)
            {
                b.SetPropertyItem(item);
            }
            b.Save(savePath, jpegCodec, encoderParams);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T16:36:23.923

我想出了解决方案，代码如下。可能不是最佳代码，但它速度很快，并且可以完成我需要做的事情，即获取目录中的所有 JPG 图像并将它们重新调整为完整图像和拇指图像以用于照片库，同时在图像上覆盖水印。

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Threading.Tasks;

namespace ImageResize
{
    internal class Program
    {
        private static readonly string directory = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);

        private static void Main()
        {
            var strFiles = Directory.GetFiles(directory, "*.jpg");

            //Using parallel processing for performance
            Parallel.ForEach(strFiles, strFile =>
                                           {
                                               using (var image = Image.FromFile(strFile, true))
                                               {
                                                   var exif = image.PropertyItems;
                                                   var b = directory + "\\" + Path.GetFileNameWithoutExtension(strFile);
                                                   ResizeImage(image, 800, b + "_FULL.jpg", exif);
                                                   ResizeImage(image, 200, b + "_THUMB.jpg", exif);
                                               }
                                               File.Delete(strFile);
                                           });
        }

        private static void ResizeImage(Image theImage, int newSize, string savePath, IEnumerable<PropertyItem> propertyItems)
        {
            try
            {
                int width;
                int height;
                CalculateNewRatio(theImage.Width, theImage.Height, newSize, out width, out height);
                using (var b = new Bitmap(width, height))
                {
                    using (var g = Graphics.FromImage(b))
                    {
                        g.SmoothingMode = SmoothingMode.AntiAlias;
                        g.InterpolationMode = InterpolationMode.HighQualityBicubic;
                        g.PixelOffsetMode = PixelOffsetMode.HighQuality;
                        g.DrawImage(theImage, new Rectangle(0, 0, width, height));

                        //Using FileStream to avoid lock issues because of the parallel processing
                        using (var stream = new FileStream(directory + "\\Watermark.png", FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                        {
                            using (var overLay = Image.FromStream(stream))
                            {
                                stream.Close();
                                int newWidth;
                                int newHeight;
                                CalculateNewRatio(overLay.Width, overLay.Height, height > width ? width : newSize, out newWidth, out newHeight);
                                var x = (b.Width - newWidth) / 2;
                                var y = (b.Height - newHeight) / 2;
                                g.DrawImage(overLay, new Rectangle(x, y, newWidth, newHeight));
                            }
                        }

                        var qualityParam = new EncoderParameter(Encoder.Quality, 80L);
                        var codecs = ImageCodecInfo.GetImageEncoders();
                        var jpegCodec = codecs.FirstOrDefault(t => t.MimeType == "image/jpeg");
                        var encoderParams = new EncoderParameters(1);
                        encoderParams.Param[0] = qualityParam;
                        foreach (var item in propertyItems)
                        {
                            b.SetPropertyItem(item);
                        }
                        b.Save(savePath, jpegCodec, encoderParams);
                    }
                }
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
            }
        }

        private static void CalculateNewRatio(int width, int height, int desiredSize, out int newWidth, out int newHeight)
        {
            if ((width >= height && width > desiredSize) || (width <= height && height > desiredSize))
            {
                if (width > height)
                {
                    newWidth = desiredSize;
                    newHeight = height*newWidth/width;
                }
                else if (width < height)
                {
                    newHeight = desiredSize;
                    newWidth = width*newHeight/height;
                }
                else
                {
                    newWidth = desiredSize;
                    newHeight = desiredSize;
                }
            }
            else
            {
                newWidth = width;
                newHeight = height;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:36:18.773

要在保持纵横比的同时将图像缩放到画布上以获得最佳拟合效果，过程相当简单：

```
double widthFactor = b.Width / a.Width;
double heightFactor = b.Height / a.Height;
double scaleFactor = Math.Min(widthFactor, heightFactor);
int newWidth = a.Width * scaleFactor;
int newHeight = a.Width * scaleFactor; 
```

要计算使图像居中的位置，只需要更多的数学运算：

```
int left = (b.Width - newWidth) / 2;
int top = (b.Height - newHeight) / 2; 
```

然后使用适当形式的 Graphics.DrawImage 方法。

# oauth-2.0 - 为多组用户在网站中嵌入交互式谷歌日历

> ID：13770590
> 
> 赞同：0
> 
> 时间：2012-12-07T20:36:34.873
> 
> 标签：oauth-2.0, google-calendar-api

我正在考虑在我的网站中嵌入谷歌日历以实现以下目标，并且想知道这在谷歌日历中是否可行。否则我必须去寻找另一个解决方案。

我有一组用户和一个超级用户，其余的是普通用户，如下所示：

*   A组
    *   超级用户 1
    *   普通用户 1
    *   普通用户 2
    *   ETC
*   B组
    *   超级用户 2
    *   普通用户 3
    *   普通用户 4
    *   ETC

每个组都有自己的日历。每个组中的用户都看不到其他组的日历。只能看到自己组的日历。

每个组的超级用户都可以访问日历（添加、修改、删除），并且能够控制普通用户在他们的组中拥有多少访问权限。（只读？读/写等）

所有用户都注册到我的网站，因此我想只使用一个谷歌日历帐户（我自己的帐户）为每个组创建一个日历。这导致了将我的网站验证为谷歌 API 的问题。我需要自动的身份验证过程，远离用户并在服务器端完成。

我的网站是使用 PHP/Mysql 构建的

Q1：
我尝试过google提供的Javascript客户端库，但是它要求用户输入用户名/密码才能登录google，以便身份验证（OAuth2）过程可以工作。如上一段所述，我只希望用户登录我的网站，他们不需要再次登录谷歌帐户。这应该在服务器端完成。

我什至创建了一个预先填充了信息的登录表单（对用户隐藏，用户名/密码将在“查看页面源”中可见）并将请求发送到[https://accounts.google.com/ServiceLoginAuth](https://accounts.google.com/ServiceLoginAuth)，并在用户成功登录我的网站后自动提交表单。但是，这会导致跨域问题。

Q2：我可能在我的网站上注册了成千上万个组。每个组可能有几百个用户。一个谷歌账户可以创建那么多日历吗？

Q3：一旦日历嵌入到我的网站，它似乎是只读的。是否可以使其具有交互性，以便每个组中的超级用户可以添加/删除/修改事件？

非常感谢任何想法/建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T19:55:45.373

没有答案？看起来你的问题很简单。如果我理解正确，您想从多个 Google 帐户/用户访问日历。每个用户都需要授权此访问，但他们只需要这样做一次。例如，您可以生成这些请求并通过电子邮件将它们发送出去。当用户授予权限时，Google 会将*授予代码*转发到您指定的 callback_uri。*授权代码*非常不稳定。它用于向 Google 请求一个显然可以无限期使用的令牌。所以没有要求用户不断登录谷歌。

在 Google 的 calendar/simple.php 示例中。令牌存储为 SESSION 变量。即使令牌是持久的，SESSION 变量也不是。每次 SESSION 变量到期时，用户都必须授予授权。将持久数据存储在 volatile 变量中是荒谬的，并且可能会给 OAuth2 令牌机制带来错误的印象。

我花了很多时间编写在其他任何地方都找不到的文档。如果您认为它可能有帮助，请查看： [http ://www.tqis.com/eloquency/googlecalendar.htm](http://www.tqis.com/eloquency/googlecalendar.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T21:41:33.140

Google 日历无法满足您的要求。

如果您希望支持数千个组并且每个组都需要它自己的日历，那么您就是说您需要数千个具有访问控制功能的日历，并且您需要对日历进行身份验证以使其透明。

# php - 在 PHP 中，什么会导致 $_SESSION 变为空？

> ID：13770593
> 
> 赞同：3
> 
> 时间：2012-12-07T20:36:42.130
> 
> 标签：php, session, null, session-state

我很想知道在程序执行期间可能导致 $_SESSION 超全局变量为空的各种事情。我遇到了一个奇怪的情况，即现有会话变为空，尽管没有`session_destroy`or `unset`....

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T20:47:46.883

没有`session_start()`， $_SESSION 为空。要销毁它，您必须使用`session_destroy()`使 $_SESSION 为空

# sql - 在还原到数据库之前显式创建数据库？

> ID：13770596
> 
> 赞同：1
> 
> 时间：2012-12-07T20:36:44.773
> 
> 标签：sql, database, postgresql, database-backups, database-restore

当我设置我的 PostgreSQL 服务器时，我要做的第一件事就是为外部源导入数据库。以下哪项是正确的做法？

*   在 PostgreSQL 服务器上创建一个名为“NEWDB”的数据库，然后将我的外部“BACKUPDB”数据库从我的 pg_dump 导入“NEWDB”。

*   不要在PostgreSQL服务器上创建数据库，导入“NEWDB”数据库，从而在postgresql服务器上自动创建“NEWDB”。

我想我的问题是，如果我想将现有数据库导入 PostgreSQL 服务器，我是否首先需要创建一个数据库才能进入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T22:58:26.510

*你*不必。这取决于您想要达到的目标。如果您使用 , 转储单个**数据库**，则不包括命令。您应该连接到现有数据库。所以你必须先创建它。 我引用[手册中的建议](http://www.postgresql.org/docs/current/interactive/app-pgdump.html)：[`pg_dump`](http://www.postgresql.org/docs/current/interactive/app-pgdump.html)`CREATE DATABASE``ALTER DATABASE`

> 如果您的数据库集群对 template1 数据库有任何本地添加，请小心将 pg_dump 的输出恢复到真正空的数据库中；否则，由于添加的对象的重复定义，您可能会遇到错误。要创建一个没有任何本地添加的空数据库，请从模板 0 而不是模板 1 复制，例如：
> 
> `CREATE DATABASE foo WITH TEMPLATE template0;`

并且：

> 转储文件也不包含任何 ALTER DATABASE ... SET 命令；这些设置与数据库用户和其他安装范围的设置一起由 pg_dumpall 转储。

[`pg_dumpall`](http://www.postgresql.org/docs/current/interactive/app-pg-dumpall.html)另一方面，转储整个**数据库集群**，包括像用户这样的元对象。它包括`CREATE DATABASE`语句并在还原时连接到每个数据库。您甚至可以包含带有( ) 选项`DROP DATABASE`的语句。小心点。`-c``--clean`

每个 PostgreSQL 实例都有一个名为“postgres”的默认维护数据库，您可以连接到该数据库 - 为实例创建数据库或启动完全恢复（来自 pg_dumpall）。但是必须针对其目标数据库运行单数据库转储（来自 pg_dump）。

最后：

> 恢复后，明智的做法是在每个数据库上运行 ANALYZE，以便优化器获得有用的统计信息。您还可以运行 Vacuumdb -a -z 来分析所有数据库。

# types - ada 保留字作为标识符

> ID：13770597
> 
> 赞同：-1
> 
> 时间：2012-12-07T20:36:58.923
> 
> 标签：types, ada

所以我有一个我声明的类型，它指的是人民的名字，其中一个名字是“Do”，例如

```
type name is (BOB, SKIPPY, DO) 
```

> 编译器错误：保留字“Do”不能用作标识符。

周围有没有不必使用字符串的地方？似乎老师这样做是为了给我们施加压力。

我制作了一个通用包，所以制作一个变量字符串类型并实例化它会更容易吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T21:44:53.407

保留字是*保留*字，故事结束。

当保留字在给定情况下是最好的字时，有一些常用的技术：

*   为其添加前缀，例如 (Name_Bob, Name_Skippy, Name_Do);
*   后缀，例如 (Bob_Name, Skippy_Name, Do_Name);
*   “拼错”它，例如（Bob、Skippy、Do_Do）；

如果您担心输出它会是什么样子，那么通常不鼓励使用简单的枚举到字符串属性 'Image，因为它是枚举值的文字描述，因此输出的内容变为与您选择的编码标识符紧密耦合。调试很好，但对于人类可读的输出，您应该使用其他东西，例如枚举值的大小写或使用枚举到字符串的映射。

除非有一些令人信服的理由，否则使用字符串来表示枚举的值不会有任何好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T18:41:46.083

使用前缀 [或后缀] 选项，然后您可以执行以下操作：

```
type Names is ( Name_Bobby, Name_Dave, Name_Calvin, Name_Do );

Function Put( Item : In names ) Return String is
  Prolog : Constant String:= "Name_";
  Image  : Constant String:= Item'Image;
begin
  Return Image( Image'First+Prolog'Length..Image'Last );
end Put; 
```

# ssis - SSIS 包在状态码 4 上失败

> ID：13770598
> 
> 赞同：1
> 
> 时间：2012-12-07T20:37:03.230
> 
> 标签：ssis

我创建了一个 SSIS 包，它从我们的数据库执行内联 SQL 查询，并且应该将内容输出到文本文件。我最初将文本文件用逗号分隔，但在进一步研究错误后改为管道分隔。我还做了一个 FirstName 字段的子字符串，并确保 SSIS 占位符字段的长度匹配。错误信息如下：

```
[Customers Flat File [196]] Error: Data conversion failed. The data conversion for   
column "FirstName" returned status value 4 and status text "Text was truncated or one or more 
characters had no match in the target code page.". 
```

我在 OLE DB 源中使用的 SQL 语句如下：

```
SELECT     
dbo.Customer.Email, SUBSTRING(dbo.Customer.FirstName, 1, 100) AS FirstName, 
dbo.Customer.LastName, dbo.Customer.Gender, 
dbo.Customer.DateOfBirth, dbo.Address.Zip, dbo.Customer.CustomerID, dbo.Customer.IsRegistered
FROM         
dbo.Customer INNER JOIN
dbo.Address ON dbo.Customer.CustomerID = dbo.Address.CustomerID 
```

我应该进行哪些其他修复以确保程序包正常运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:53:22.757

您是否尝试在 SSMS 中运行此查询？如果是这样，您是否获得了成功的结果？如果您还没有尝试过，请将此查询粘贴到新的 SSMS 窗口中并等待它完成。如果查询完成，那么我们的查询就没有问题。包裹内可能有东西掉了。

但是如果查询没有完成并且失败，你就知道去哪里找了。

**编辑**

再三考虑，您的客户来源是平面文件还是什么？看起来客户表/文件中有一个值与源的输出元数据不匹配。再次检查您的来源。

# php - 模板中 if 语句的呈现格式

> ID：13770602
> 
> 赞同：0
> 
> 时间：2012-12-07T20:37:10.220
> 
> 标签：php, if-statement

这是我的问题。我的代码如下所示：

```
<ul class="nav pull-right">
<?php if (!logged_in()) : ?>
    <li><a href="<?php echo base_url(); ?>login"><i class="icon-off"></i> Login</a></li>
    <li><a href="<?php echo base_url(); ?>register"><i class="icon-user"></i> Register</a></li>
<?php else : ?>
    <li><a href="<?php echo base_url(); ?>logout"><i class="icon-user"></i> Logout</a></li>
<?php endif; ?>
</ul> 
```

但是，当我在 Chrome 中查看源代码时，代码到处都是：

```
<ul class="nav pull-right">
                                                    <li><a href="http://localhost/logout"><i class="icon-user"></i> Logout</a></li>
                                            </ul> 
```

如何重新组织我的语法，使源代码看起来像这样？

```
<ul class="nav pull-right">
    <li><a href="http://localhost/logout"><i class="icon-user"></i> Logout</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:39:46.017

关闭 PHP 标记后的每个回车都不会返回到输出缓冲区。您必须在代码中添加一些额外的行，如下所示：

```
<ul class="nav pull-right">
<?php if (!logged_in()) : echo "\n";  ?>

    <li><a href="<?php echo base_url(); ?>login"><i class="icon-off"></i> Login</a></li>
    <li><a href="<?php echo base_url(); ?>register"><i class="icon-user"></i> Register</a>      
</li>
<?php else : ?>

    <li><a href="<?php echo base_url(); ?>logout"><i class="icon-user"></i> Logout</a></li>
<?php endif; ?>
</ul> 
```

你可能想看看[Twig](http://twig.sensiolabs.org/)这是一个模板系统。它还具有删除所有空格的功能，有时非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:43:16.917

源代码格式（除了少数例外）与浏览器、CSS、Javascript 等无关。它主要是虚荣心，担心它总是会让你头疼。

我建议使用[`Tidy`](http://php.net/manual/en/book.tidy.php)类。例子：

```
$output = "{YOUR FINAL OUTPUT STRING}";
$tidy = new Tidy;
$config = array(
    'indent'              => true,
    'literal-attributes'  => true,
    'wrap'                => 120
);
$tidy->parseString($output, $config, 'utf8');
$tidy->cleanRepair();
echo $tidy; 
```

# regex - sublime text 语法定义

> ID：13770603
> 
> 赞同：1
> 
> 时间：2012-12-07T20:37:12.280
> 
> 标签：regex, text, sublimetext2, definition

我正在尝试为崇高文本制作新语法。在基于规则的文档中突出显示，这里是引用：

> 每个规则都使用匹配的文本区域，因此将从下一个规则的匹配尝试中排除（除了少数例外）。

我有下一个要强调的文件：

```
div
  div
    div 
```

我有下一个要匹配的规则（例如）：

```
{
  "name": "entity.name.tag.z",
  "match": "[A-z]+"
},
{
  "name": "entity.language.z",
  "match": "\\s*[A-z]+"
}, 
```

假设第一条规则必须匹配所有 3 个 div，因此第二条规则不匹配任何内容。

但只有第一个“div”匹配，第二个和第三个不匹配。如果我删除第二条规则，那么所有 3 条都正确匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T15:44:21.620

我不是专家，但这是我的假设：

当您只有第一条规则时，它不匹配单个匹配中的三行，它是三个单独的匹配，因为您的第一条规则不包含空格。需要明确的是，比赛不是

```
[match1]div
          div
             div[/match1] 
```

但

```
[match1]div[/match1]
       [match1]div[/match1]
              [match1]div[/match1] 
```

添加第二条规则后，它会在第二行的开头触发，**因此在第一条规则之前**，我期望的结果是

```
[match1]div[/match1]
[match2]    div[/match2]
[match2]         div[/match2] 
```

# c# - 插入 rtf 字符串时的 RichTextBox 插入符号位置

> ID：13770604
> 
> 赞同：0
> 
> 时间：2012-12-07T20:37:12.513
> 
> 标签：rtf, c#, winforms, richtextbox, rtf, caret

我正在尝试将[rtf](/questions/tagged/rtf "显示标记为“rtf”的问题")字符串插入到`RichTextBox`. 这是`KeyUp`活动形式`RichTextBox`：

```
private void richTextBox1_KeyUp(object sender, KeyEventArgs e)
{
    string st = richTextBox1.Rtf;
    st=st.Insert(750, "void");
    richTextBox1.Rtf = st;
} 
```

问题是，每次更新后，插入符号都在插入的文本之前，我想将它保留在最后。我注意到只有当我修改`st`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:59:24.850

我无法理解您的代码应该如何为最终用户工作。你怎么知道在索引 750 处你有文本而不是[rtf](/questions/tagged/rtf "显示标记为“rtf”的问题")控制字符？

快速的解决方案是自己将插入符号位置设置到末尾：

```
private void richTextBox1_KeyUp(object sender, KeyEventArgs e)
{
    string st = richTextBox1.Rtf;
    st=st.Insert(750, "void");
    richTextBox1.Rtf = st;
    richTextBox1.SelectionStart = richTextBox1.TextLength;
} 
```

当然，如果您试图将插入符号放在插入 void 的位置，那将不适用于您的[rtf](/questions/tagged/rtf "显示标记为“rtf”的问题")属性，因为[rtf](/questions/tagged/rtf "显示标记为“rtf”的问题")和 text 属性是不同的东西。

如果尝试在 text 属性中插入文本，那么它看起来像这样：

```
private void richTextBox1_KeyUp(object sender, KeyEventArgs e)
{
    string st = richTextBox1.Text;
    st=st.Insert(750, "void");
    richTextBox1.Text = st;
    richTextBox1.SelectionStart = 750 + 4;
} 
```

# c++ - 用于创建支持多种语言的 pdf 的 C++ 库？

> ID：13770610
> 
> 赞同：1
> 
> 时间：2012-12-07T20:37:44.773
> 
> 标签：c++, pdf-generation, hindi

我的困境是：我们一直在使用 libharu 来创建我们的 pdf，但我们最近在我们的软件中添加了印地语，据我所知，libharu 不支持它。

我环顾四周，一直找不到支持我们使用的所有语言的类似于 libharu 的库（不需要是开源的），但我失败了。

我检查了这篇文章中提到的所有库，但没有一个能满足我的需求：

[用于 C/C++ 应用程序的开源 PDF 库？](https://stackoverflow.com/questions/58730/open-source-pdf-library-for-c-c-application)

另外，那个帖子已经有几年了。>_<

所以我问你，善良的 stackoverflow 人，你知道一个用于创建和编辑 pdf（在 c++ 中）的库，它至少支持以下语言吗？（英语、西班牙语、法语、土耳其语、德语、俄语、日语、中文、阿拉伯语和印地语）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:47:46.853

你试过去源头吗？
[Adobe PDF 开发人员 SDK](http://www.adobe.com/devnet/pdf/library.html)

Adobe Systems~~拥有~~发明 PDF 语言。我建议在开源之前先与他们交谈。他们可能有一些库或 SDK 可用于 PDF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:26:57.663

我使用过[JagPDF](http://www.jagpdf.org/)几次，根据我上次的经验，我认为在 pdf 中嵌入字体可能会解决您的问题。

# asp.net-mvc-3 - MVC3 设置下拉列表选择值

> ID：13770611
> 
> 赞同：1
> 
> 时间：2012-12-07T20:37:46.347
> 
> 标签：asp.net-mvc-3, drop-down-menu, selectedvalue

```
@Html.DropDownListFor(m => m.field, Model.fieldList, "Select") 
```

我有上面的代码来从数据库中获取下拉列表的值。因为数据库没有选择值，所以我将它添加到列表中。但是，我想将所选值设置为某个值（变量）。我怎样才能做到这一点？

假设我希望选择的值为“WI”，而“WI”在列表中。我该怎么做呢？或者我如何指定@value 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:44:33.507

该`DropDownListFor`函数将首先查看提供的选择列表中是否存在选定值。如果选定列表项中没有选定值，它将查看下拉列表所针对的字段的值，并尝试将其与每个选择列表项的值匹配，直到找到正确的值。如果任何选择列表项没有值，它会将其与文本进行比较。

生成完整列表后，循环遍历它并找到要选择的值，然后将 selected 属性设置为 true，它应该选择那个。

# ios - 自动滚动到滚动视图中的子视图

> ID：13770612
> 
> 赞同：0
> 
> 时间：2012-12-07T20:37:48.200
> 
> 标签：ios, uiscrollview

我已经实现了一个具有动态内容的滚动视图：多个子视图显示下面有玩家姓名的玩家照片。流程是： 1\. 在主窗口中，选择了一个玩家。2\. 用户启动另一个视图以添加新玩家。3\. 当用户返回主菜单时，滚动视图完全刷新，新的球员照片和名字也会显示出来。

此时，滚动视图应该仍然聚焦先前选择的播放器，而是从头开始显示它。所以问题是：是否有一种方法可以自动滚动到滚动视图中的特定位置，以便屏幕仍然具有选定的播放器焦点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:41:37.543

很简单，创建 a`CGPoint`和 a `BOOL`，您可以在视图更改后保留它们，并在您最初离开该页面时设置它们。然后`viewDidAppear`你可以检查是否`BOOL`是`YES`并使用：

```
[myScrollView setContentOffset:myCGPoint animated:YES]; 
```

或者，如果您希望滚动视图看起来已经滚动到正确的位置，请执行相同的操作，但`viewWillAppear`将动画标志设置为`NO`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:43:56.013

是的，有两个：

```
(1) scrollRectToVisible:animated:
(2) setContentOffset:animated: 
```

[您可以在UIScrollView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html "测试")中了解这两种方法。无论哪种方式，您都可以使用实例变量来存储用户滚动时的内容偏移量或可见矩形，然后使用我上面列出的方法之一在播放器数据更新时恢复滚动视图位置。

根据您所做的工作，您可能会发现 UITableView 更易于实现，因为它是非常可定制的“开箱即用”，并且它有很多方法可以帮助管理列表（包括我上面提到的那些，等等） . 如果您有兴趣，请查看[UITableView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)。

# frameworks - 实体框架 5 复杂类型无法解析，因为类型是一个接口

> ID：13770613
> 
> 赞同：1
> 
> 时间：2012-12-07T20:37:56.483
> 
> 标签：frameworks, interface, entity, complextype

我有以下内容：

```
public interface IPerson
{
  string Name {get; set;}
   ... more attributes ...
  IAddress Address {get; set;}
}

public interface IAddress
{
  string Street {get; set;}
   ... more ...
}

public class Person: IPerson
{
  public string Name {get; set;}
   ... more attributes ...
  IAddress Address {get; set;}
}

public class Address: IAddress
{
  public string Street {get; set;}
   ... more ...
} 
```

在我的上下文类中，我定义了以下内容：

```
public DbSet<Property> Properties { get; set; } 
```

在`OnModelCreating`我拥有的同一个上下文文件中

```
modelBuilder.Configurations.Add(new PropertyMap());
modelBuilder.ComplexType<Address>(); 
```

当我去数据库地址不是属性的一部分。有人有想法么？

# c# - 系统 IO 异常未处理

> ID：13770617
> 
> 赞同：-2
> 
> 时间：2012-12-07T20:38:25.247
> 
> 标签：c#, csv, io, streamwriter

我正在尝试用 C# 开发我的第一个应用程序，而我只是想从文件中读取和写入。我已经进行了数小时的研究，有导师试图教我，但这对我来说毫无意义。

我已经布置了表单的开头，并且我认为这是我正在使用的 StreamWriter 的正确语法，但是文件名似乎在另一个进程中使用，我不知道是哪个。这是我正在使用的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace CustomerApplication
{
    public partial class AddCustomerForm : Form
    {
        public AddCustomerForm()
        {
            InitializeComponent();
        }
    private void saveAndExitBtn_Click(object sender, EventArgs e)

    {
        StreamWriter sw = File.AppendText("test.csv");

           sw.WriteLine("Test for Hope");

        // next, retrieve hidden form's memory address
        Form myParentForm = CustomerAppStart.getParentForm();
        // now that we have the address use it to display the parent Form
        myParentForm.Show();
        // Finally close this form
        this.Close();
    }// end saveAndExitBtn_Click method 
```

这是 Visual Studio 不喜欢的行：

```
StreamWriter sw = File.AppendText("test.csv"); 
```

提前感谢您的时间。

~TT

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:53:57.840

有根据的猜测（基于*但文件名似乎在另一个进程中使用*） - 您打开文件进行写入，但您从不关闭它。因此，当您稍后尝试再次写入时，它会失败。

请注意，如果您在其他应用程序（例如记事本）中打开文件，也会发生这种情况。

您应该将流的创建放在一个[`using`语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)中，以确保在您完成使用它时它会关闭：

```
using(StreamWriter sw = File.AppendText("test.csv")
{
    sw.WriteLine("Test for Hope");

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:56:03.987

你确定你没有在其他地方打开文件吗？例如，在您进入该行代码之前，您可以尝试手动删除该文件，以查看是否有某个进程正在保留它。我输入它并且它工作。我建议将 Streamwriter 包装在 using 语句中并使用 FileInfo 对象。FileInfo 对象上有一些不错的属性，就像您可以测试文件是否存在一样。你也可以做这样的事情。

```
FileInfo fi = new FileInfo("C:\\test.csv");

if (fi.Exists)
  using (Streamwriter sw = fi.AppendText())
  {
     sw.WriteLine("tst");

     sw.Close();
  } 
```

# sql - Oracle 获取视图的交集

> ID：13770619
> 
> 赞同：-3
> 
> 时间：2012-12-07T20:38:29.470
> 
> 标签：sql, oracle

我创建了视图，`CREATE VIEW lalala AS SELECT * FROM lalalala`并且我有两个不同的视图。我怎样才能使它们相交？`view1 intersect view2`不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:44:40.620

`INNER JOIN`他们彼此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:48:16.833

我认为您可能误解了视图的目的。视图是一种“派生”表，其数据取决于（通常）一个或多个其他表中的数据。您仍然`SELECT`可以像普通桌子一样使用它。所以，例如，如果你有这个：

```
CREATE VIEW lalala AS SELECT * FROM lalalala; 
```

那么您可以通过以下方式查询此视图：

```
SELECT * FROM lalala WHERE ...; 
```

. . . 这意味着这种观点很可能没有用；抛开特权和所有权等问题，`lalala`等价于`lalalala`.

要计算两个视图的交集，您可以编写：

```
SELECT * FROM view1
INTERSECT
SELECT * FROM view2 
```

# android - 编辑：使用加速度计进行计时服务。为什么警报管理器玩具代码在这里失败？

> ID：13770624
> 
> 赞同：0
> 
> 时间：2012-12-07T20:38:49.200
> 
> 标签：android, service, accelerometer, android-3.0-honeycomb, alarmmanager

从字面上看，我和我的朋友正在通过编写玩具应用程序来自学安卓。我们制作了一个使用加速度计的简单游戏。游戏只是一个带球的迷宫游戏。我们使用加速度计来检测运动并使用瓷砖检测来确定球是在路径上还是撞到墙上。

但是，我们也想用加速度计构建一个计时服务。此计时服务将使用加速度计确定用户何时处于空闲状态（例如 10 秒），发出警告，然后关闭游戏。也就是说，杀死活动。

所以我现在要做的是看看我是否可以在游戏在小部件上运行的 10 秒内抛出一条消息。我完全基于[这里](http://justcallmebrian.com/?p=129)找到的代码：

我在下面的视图中实现了在上面那个教程中找到的代码，如下所示。我创建了一个名为 timingService 的方法并在我的 toyappView 中调用它：

```
public void timingService(Context context, Activity activity){
    // get a Calendar object with current time
     Calendar cal = Calendar.getInstance();

 // add 10 seconds to the calendar object
 cal.add(Calendar.SECOND, 10);
 Intent intent = new Intent(context, AlarmReciever.class);
 intent.putExtra("alarm_message", "This is the alarm message");

 // In reality, you would want to have a static variable for the request code instead of 192837
 PendingIntent sender = PendingIntent.getBroadcast(context, 192837, intent, PendingIntent.FLAG_UPDATE_CURRENT);

 // Get the AlarmManager service
 AlarmManager am = (AlarmManager) activity.getSystemService(context.ALARM_SERVICE);
 am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), sender);

} 
```

这是警报响起时它应该调用的类。

```
package com.example.toyapp;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.widget.Toast;

public class AlarmReciever extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
        try{
            Bundle bundle = intent.getExtras();
            String message = bundle.getString("alarm message");
            Toast.makeText(context, message, Toast.LENGTH_LONG).show();

        }catch(Exception e){
            Toast.makeText(context, "There was an error somewhere", Toast.LENGTH_LONG).show();
            e.printStackTrace();
        }

    }

} 
```

在这里之后，我又被卡住了。本教程中的我的 AlarmReciever 永远不会被调用。为什么？我用我的模拟器运行调试，它永远不会进入 AlarmReciever。就我而言，这个游戏应该持续 10 秒，然后调用 AlarmReciever 并在我的 widgit 上显示一条消息。正确的？我怀疑我的问题出在 am.set 中？但我不明白为什么。

一如既往，感谢大家的耐心等待。感谢您的评论和见解，因为我自学了如何在 android 中编写玩具应用程序。这在其他人看来可能很愚蠢，但我已经为此考虑了很多。因此，我将不胜感激其他人必须提供的任何帮助。希望你放过我的技术性。还有，我感冒了。我不相信这会重复 stackoverflow 上的其他问题，因为此警报将针对加速度计进行修改。我会将它从发送祝酒信息更改为终止游戏。

热烈的问候， GeekyOmega

PS - 一些类似的问题，但没有找到解决我的课程没有被调用的原因。我也得了重感冒，所以请放过我的技术性问题。我正在努力。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:12:03.733

我建议使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。每次调用 onSensorChanged(...) 时，您都会重置一个警报，该警报将在 10 秒内结束您的游戏。

# c# - 实例内的数据交易？

> ID：13770629
> 
> 赞同：1
> 
> 时间：2012-12-07T20:39:16.043
> 
> 标签：c#, clone, transactional

我有一个包含大量数据的类，它允许对类中的数据进行一些复杂的操作。该类还具有一些成员函数，这些函数允许检索一些数据，即检索对包含在该类中的对象实例的引用。所有数据都保存在 RAM 中（没有支持后台事务的数据库）。

现在我想实现一种事务的概念，即我想添加一个StartTransaction() 方法和一个Rollback() 方法。这就是我的问题开始的地方：如何在不更改任何对象引用的情况下将类中的数据恢复到以前的状态（因为它们可能在类外使用）。

因此，所有克隆概念都没有用。

这种方法是否有解决方案，或者这种方法太奇怪以至于我不应该遵循它。有什么替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:40:39.563

您仍然可以使用克隆，但您的代码需要一个新的间接级别：

老的：

```
class Data { int SomeValue; }

class DataInternal { int SomeValue; }
class Data { DataInternal internal; int SomeValue { get { return internal.SomeValue; } } 
```

这允许您将外部接口 ( `Data`) 与存储 ( `DataInternal`) 分离。您可以随意克隆和还原`internal`，而不会引起任何人的注意。

# c - 用C写串口

> ID：13770634
> 
> 赞同：0
> 
> 时间：2012-12-07T20:39:46.143
> 
> 标签：c, serial-port, arduino

该程序旨在将文本从串行端口写入 Arduino 的[LCD](http://en.wikipedia.org/wiki/Liquid_crystal_display)和串行监视器上。但是，它会打印出一长串随机数。字符需要存储在一个数组中，因此可以在 LCD 上移动文本而无需再次读取串行端口（我计划稍后将其放入）。我究竟做错了什么？

这是代码：

```
// These are the pins our LCD uses.
LiquidCrystal lcd(8, 9, 4, 5, 6, 7);

void setup()
{
    Serial.begin(9600); //Set the serial monitor.
    lcd.begin(16, 2); //Set the LCD
}

char ch;
int index = 0;
char line1[17]; //17 is the max length of characters the LCD can display
char line2[17];
void loop() {
   lcd.setCursor(0,0); //Set the cursor to the first line.
   if( Serial.available() ) { //If the serial port is receiving something it will begin
        index=0;               //The index starts at 0
        do {
            char ch = Serial.read(); //ch is set to the input from the serial port.
            if( ch == '.' ) {        //There will be a period at the end of the input, to end the loop.
                line1[index]= '\0';   //Null character ends loop.
                index = 17;           //index = 17 to end the do while.
            }
            else
            {
                line1[index] = ch;    //print the character
                lcd.print('line1[index]');  //write out the character.
                Serial.print('line1[index]');
                index ++;            //1 is added to the index, and it loops again
            }
        } while (index != '17');  //Do while index does not = 17
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:43:39.787

您将很多东西用单引号括起来，这不应该是：

```
 lcd.print('line1[index]');  //write out the character.
  Serial.print('line1[index]'); 
```

这些都应该是`line1[index]`（不带引号），因为您想要该表达式的结果。

```
} while (index != '17');  //Do while index does not = 17 
```

这应该是`17`，不是`'17'`。

至于`ÿ`-- 那是字符 255 （也将显示为字符`-1`），并表示它`Serial.read()`正在用完数据并返回`-1`. 请记住，串行链路另一端的设备并不总是一次写入一整行数据——在大多数情况下，它会一次写入一个字符。

# bash - 子命令语句分组？

> ID：13770639
> 
> 赞同：1
> 
> 时间：2012-12-07T20:40:07.567
> 
> 标签：bash

今天我尝试了这个，有点惊讶地发现它不起作用：

```
$ nice -n 10 { ./configure && make ; }
-bash: syntax error near unexpected token `}' 
```

有没有办法在“子命令”中使用分组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:41:56.940

你试过这个吗？=)

```
 nice -n10 bash -c './configure && make' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:56:24.600

您不能只将 shell 语法传递给程序的 argv 并期望它能够理解它。具体来说，您看到的错误是因为`&&`and `;`，它们是分隔命令的“列表运算符”。Bash 试图将参数评估`nice`为：

```
nice '-n' '10' '{' './configure' 
```

然后 Bash 尝试评估`&&`( `make`) 之后的下一个命令，然后是下一个命令，即`}`. 从技术上讲，大括号既是“保留字”又是“控制运算符”。不同的贝壳对裸牙套的处理方式略有不同，但这是一个深奥的细节。关键取决于shell，它要么是解析错误（如这里），要么是由于无法找到名为“ `}`”的命令而导致的错误（通常是前者。

此规则的例外情况仅存在于 shell 本身中。例如，Bash`coproc`关键字的工作方式就是这样，几乎可以像在您的示例中那样对其参数进行特殊的解析和评估。

# ruby-on-rails - Rails 3、HABTM 和显示数据

> ID：13770640
> 
> 赞同：1
> 
> 时间：2012-12-07T20:40:10.997
> 
> 标签：ruby-on-rails, ruby-on-rails-3, has-and-belongs-to-many

我正在使用三张桌子；HABTM 设置中的用户、角色和角色用户。

我正在尝试显示所有用户及其角色。

user.rb 模型

```
class User < ActiveRecord::Base

  has_and_belongs_to_many :roles
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, # :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email,:username, :password, :password_confirmation, :remember_me,     :role_ids
  # attr_accessible :title, :body

  def role?(role)
    return !!self.roles.find_by_name(role.to_s.camelize)
  end

end 
```

role.rb 模型

```
 class Role < ActiveRecord::Base
  attr_accessible :role_name
   has_and_belongs_to_many :users

end 
```

users_controller.rb 控制器

```
class UsersController < ApplicationController
 # GET /users
  # GET /users.xml

#load_and_authorize_resource

  def index
   #  @user = User.find(params[:id])
    #@user.roles
    @users = User.all
    @roles = Role.all
    respond_to do |format|
      format.html # index.html.erb
  format.xml  { render :xml => @users }
end
  end

  # GET /users/1
  # GET /users/1.xml

 def show
    @user = User.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @user }
    end
  end 
```

我可以创建一个新用户并为他分配一个角色。我可以编辑用户并更改他的角色。我可以使用 show 查看单个用户的角色。

问题在于我试图显示所有用户及其角色的 index.html.erb 文件。

这是代码。

../views/users/index.html.erb

# 列出用户

```
<table>
  <tr>
     <th>ID</th>
    <th>Email</th>
    <th>Username</th>
    <th>Role    </th>
     <th>Role ID</th>>
  </tr>

  <% @users.each do |user| %>
    <tr>
     <td><%= user.id %></td>
         <%= current_user = user.id %>
      <td><%= user.email %></td>
      <td><%= user.username %></td>
     <td> <%= User.find(user.id).roles %> </td>
      <td><%= link_to 'Show', user %></td>
      <td><%= link_to 'Edit', edit_user_path(user) %></td>
      <td><%= link_to 'Destroy', user, :confirm => 'Are you sure?', :method => :delete %></td>
    </tr>
  <% end %>
</table>

<br /> 
```

这会产生以下输出：

```
john_user@nomail.com    john     [#<Role id: 1, role_name: "basic_user", created_at: "2012-12-06 18:03:43", updated_at: "2012-12-06 18:03:43">] Show    Edit    Destroy 
```

所以它给了我整个角色行，而不仅仅是角色名称。

我已经尝试过 User.find(user.id).roles.role_name、User.find(user.id).roles[1] 和其他几种可能性，但无法弄清楚如何让角色名称只出现。

什么是正确的语法来显示“role_name”，如下所示：

```
john_user@nomail.com    john     basic_user        Show   Edit  Destroy 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:42:38.027

您可以直接访问它：

```
<td> <%= user.roles.collect(&:name).join(",") %> </td> 
```

# java - 凌晨 3 点的 Spring cron 表达式

> ID：13770646
> 
> 赞同：6
> 
> 时间：2012-12-07T20:40:20.833
> 
> 标签：java, spring, cron, quartz-scheduler

我正在使用 Java - Spring - Quartz 调度程序。我想在凌晨 3 点之前运行工作，以下是我的 cron 表达式。

```
0 0 3 * * ? 
```

有人可以告诉我它是正确的吗？它会在 24 小时下午 3 点和凌晨 3 点执行两次吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:47:37.647

是的，这是正确的，您可以通过[此](https://stackoverflow.com/questions/4469276/convert-cron-expression-into-nice-description-strings-is-there-a-library-for-ja)验证它，并且 Hhour 字段需要 0-23，因此它将在凌晨 3 点调用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T20:47:52.253

我已经检查了您在[CronMaker](http://www.cronmaker.com/)中的表达。

这仅适用于每天凌晨 3:00。如果您需要凌晨 3 点和下午 3 点，请使用以下命令：

```
0 0 3/12 1/1 * ? * 
```

# css - CSS 固定宽度 + 100% 填充。一个容器可以吗？

> ID：13770652
> 
> 赞同：0
> 
> 时间：2012-12-07T20:40:54.080
> 
> 标签：css

我需要制作具有 100% 宽度和渐变背景的 ui 控制面板。此控制面板上的 UI 元素的宽度应为 1000 像素并且应居中。

暂时我有两个元素：面板（宽度 100%，渐变背景），全局包装器面板包装器（宽度 1000 像素，透明背景），放置在“面板”元素内，包含 UI 元素。

它在我需要的所有浏览器中都表现出色，但我真的不喜欢使用两个 HTML 元素，从逻辑上讲它应该只是一个。也许可以有一个固定宽度（1000px）和自动填充的元素“面板”，它将覆盖左侧和右侧的所有可用空间？（如果我的解释很疯狂，我已经制作了一张图片来展示它:)）

![在此处输入图像描述](../Images/d23b8767c495ad78c5f5be02323f08b1.png)

有可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:51:28.570

您可能会使用该`calc()`功能，尽管它不是高度兼容浏览器的。

[这](http://jsbin.com/imerit/1/edit)是一个简单的示例，有关兼容性和使用的更多信息可以在[这里](http://webdesignernotebook.com/css/the-wonderful-calc-function/)找到。

*我在 Firefox 中制作了示例，没有在其他地方进行测试。

只是一个快速的代码示例，下面显示了一个解决方案：

```
div {
    width: 100px;
  background-color: blue;
  height: 100px;
  padding-left: calc(50% - 50px);
  padding-right: calc(50% - 50px);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:54:05.143

挑战在于您不能真正将百分比和固定宽度与传统意义上的填充结合起来，因为填充被添加到总宽度中。

如果总宽度为 100%，并且您希望中心的内容为 500px，则无法计算填充。

但是，使用 CC3，您可以使用`box-sizing`更改填充在盒子模型中的“位置”。

[http://www.css3.info/preview/box-sizing/](http://www.css3.info/preview/box-sizing/)

唉，我仍然认为这不会让你想要你想要的，因为仍然有一个未知的变量在起作用（100% 宽度对象所在的容器的宽度）。

最后，我们有时会以过度优化的名义过度思考这些解决方案。在这种情况下，额外的 div 似乎是完全可以接受的，并且很可能是正确的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:46:50.890

为什么`padding`？

您可以将左右边距设置为`auto`，这将使 div 居中..

所以只要设置

```
.panel{
    width:1000px;
    margin:0 auto;
} 
```

# asp.net-mvc - 如何在 ASP.Net MVC 3 中使用 @Html.ListBoxFor 方法？

> ID：13770653
> 
> 赞同：0
> 
> 时间：2012-12-07T20:41:00.670
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, razor

我看到“不包含...的定义”错误。

这是视图中的代码

```
 @model Variant.SystemV.Web.Models._TaggingVM

      @Html.ListBoxFor(x=>x.Tags, Model.SelectedTags, new { @class = "chzn-select", data_placeholder = "Select Tag(s)...", style = "width: 500px" }) 
```

这是我的模型

```
public class _TaggingVM
{
    public IEnumerable<Tag> SelectedTags { get; set; }
    public IEnumerable<Tag> Tags { get; set; }
    public Article Article { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:55:20.087

这是因为[Html.ListBoxFor()](http://msdn.microsoft.com/en-us/library/ee830422%28v=vs.108%29.aspx)扩展采用参数类型，`IEnumerable<SelectListItem>`并且可能您的视图模型中的属性没有实现它。

您可以像这样在视图中创建项目：

```
@Html.ListBoxFor(x => x.SelectedTags, new SelectList(Model.Tags, "Id", "Text")) 
```

它假定您的 Tag 类中有名为 Id 和 Text 的属性。此外，您可能应该在表达式中使用 SelectedTags 属性。它将确保您在表格发布时将它们收集回来。

# python - CSRF 令牌传递打破了我的 django 视图

> ID：13770656
> 
> 赞同：0
> 
> 时间：2012-12-07T20:41:13.323
> 
> 标签：python, django, fastcgi

当传递 X-CSRFToken 标头或将 POST 数据中的 csrfmiddlewaretoken 发送到我的视图时，它完全跳过 ajax 处理程序并直接进入索引/基础视图。

**Javascript：**

```
$.post("/action/register", {
          name: $('#input_name').val(),
          email: $('#input_email').val(),
          csrfmiddlewaretoken: '{{ csrf_token }}'

        }, function(data) {
          var response;
          try {
            response = JSON.parse(data.toString());  
          } catch(e) {
            response = {"status":"error", "message":"Please try again later, we're having some tech issues!"};
          }

          // ... process some stuff, the callback works which is good 

```

**看法：**

```
 def handle_register(req):
    ''' Request handler pyfor registration, should return JSON for the AJAX request. '''

    if req.is_ajax():
        return validate_and_register(req)
    else:
        return HttpResponse('{"status":"error","message":"Invalid request."}') 
```

**网址.py：**

```
 from django.conf.urls.defaults import *
# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^action/register$', 'views.handle_register', name='handle_register'),
    url(r'^admin/', include(admin.site.urls)),
    url(r'^.*$', 'views.handle_home', name='handle_home'),
) 
```

当我不通过标头时，我得到一个 403 (CSRF_VERIFICATION_FAILED)。当我传递适当的标头（在多个浏览器中确认）时，它会跳过 /action/register 处理程序并直接进入“handle_home”视图。

我被困住了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:02:00.533

这可能是由于您的网址上缺少斜杠

> /动作/注册

尝试在 url 和 javascript 中添加斜杠。

另一个猜测是：

> 'views.handle_register'

缺少应用名称？

更安全的方法是使用反向 url：

```
from django.core.urlresolvers import reverse

url = reverse('appname.views.handle_register')

$.post(url, {}, func... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:02:53.110

这是 nginx 的问题。根据 django/nginx 设置文档，我发现我的 nginx 配置中缺少这个：

```
        fastcgi_split_path_info ^()(.*)$;

```

# delphi - 在 Delphi XE2 上使用运行时包构建

> ID：13770664
> 
> 赞同：2
> 
> 时间：2012-12-07T20:41:51.710
> 
> 标签：delphi, runtime, delphi-xe2, packages

我发现了一个类似的问题，但没有找到答案。问题是如何轻松地将所有已安装的运行时包添加到 Delphi XE2 项目的“项目选项/包/运行时包”列表中？在 XE 和更早的版本中，您可以通过简单地选中/取消选中“使用运行时包构建”来完成，这些包会立即出现在下面的编辑中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T10:21:08.500

创建一个新项目并从其选项中复制列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T13:41:40.663

检查`Link with runtime packages`。检查`Inherit`“运行时包”。

![在此处输入图像描述](../Images/56fc283feab18098f745c88a15bc3a07.png)

默认（继承）运行时包显示在底部列表中，并包含在您的项目中。仅将运行时包添加到未包含在下方列表中的上方列表中。

![在此处输入图像描述](../Images/f651fa9e9ff17b073b4bd0747da61705.png)

# c# - 使用和不使用私有访问器的单元测试

> ID：13770666
> 
> 赞同：2
> 
> 时间：2012-12-07T20:42:09.430
> 
> 标签：c#, unit-testing

使用私有访问器测试一段代码有什么缺点吗？

我正在权衡仅使用私有访问器来测试我的 GUI 的选项，而不是公开公开的方法/属性。

这将允许我需要进行一些 GUI 测试，我只是想确保它们在使用私有访问器的行为方式时没有任何隐藏的“陷阱”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:49:00.993

最好不要使用它们，而是尝试找出是否可以注入任何依赖项。除非您正在处理想要使用私有访问器创建一些单元测试的遗留代码，否则我建议不要使用它们，即使在这种情况下，我也建议您暂时这样做，直到您重构遗留代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T22:16:26.907

回顾一下，您的既定目标是：

> > 我正在权衡仅使用私有访问器来测试我的 GUI 的选项...这将允许我需要进行一些 GUI 测试...

简而言之，是的，有陷阱。您正在测试的代码仍然与用户界面紧密耦合。

在评论中，您将您的目标/问题阐明为：

> > 如果我想测试，拖/放怎么办。自定义控件，覆盖事件？

我只能说欢迎登机。软件行业为此苦苦挣扎了近半个世纪。事实仍然是测试 UI 很难，真的很难。是的，您可以使用一段与 UI 元素紧密耦合的代码并尝试将其自动化；但是，您将竭尽全力对抗糟糕的假设。

可测试 UI 的“技巧”不是让您的 UI 可测试，而是从 UI 中删除您想要测试的代码。因此，N-Tier 应用程序开发和演示设计模式（如 MVC、MVVM 等）得到广泛接受。

请参阅以下内容：

*   [模型视图控制器](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)
*   [模型视图视图模型](http://en.wikipedia.org/wiki/Model_View_ViewModel)
*   [模型-视图-适配器](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93adapter)
*   [模型-视图-演示者](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)

许多这些设计模式背后的主要目标或驱动力是消除行为和表示之间的紧密耦合。这使您能够在没有用户界面的情况下测试诸如拖放之类的行为。我的建议是查看模式，选择你喜欢的模式，然后在编写单元测试时开始重构代码。

另一种考虑编写用于测试的 UI 的方法是从用户界面代码中删除每个 if、else、for、while、switch 或其他[控制语句。](http://en.wikipedia.org/wiki/Control_flow)UI 的最终“外壳”应该非常适应变化。在使用依赖反射的数据绑定之类的东西时要小心（这通常是一种可接受的做法）。这样做的主要缺点是编译器无法告诉您成员不再存在。

**更新**

@timmy 你写道：

> > ...例如，如果我想测试鼠标点击行为...

那么鼠标点击行为不能移动到控制器而不是嵌入到表单中呢？我猜“关闭”按钮可能有问题，但除此之外，为什么不将逻辑移到另一个可以测试的类呢？

顺便说一句，您不必只选择一种模式 MVC、MVVM 等，它们是“指南”或“建议”而不是硬规则，所以不要对此感到可笑。只需尝试将逻辑与 UI 分开并独立测试即可。例如，也许您的“单击”事件更适合简单的命令类？使用命令模式很容易，新建一个对象并执行它。考虑文件夹复制表单的示例代码：

```
private void OnCopyClick(object sender, EventArgs args)
{
    var cmd = new MyCopyCommand(this.FolderPath, this.txtTargetFolderPath.Text);
    new ErrorHandler(this).Perform(cmd);
} 
```

这很好用，除了提供命令的内容之外没有“真正的”逻辑，也没有条件代码路径。请注意，我们甚至不直接调用该命令，而是将其交给可以适当处理错误的人。通常这个'ErrorHandler'会被提供给表单而不是直接构造，但你明白了。

由此我们应该能够很容易地验证 MyCopyCommand 的正确行为。最后，您应该在 UI 中使用一堆“平面功能”，即。没有嵌套或花括号的函数。当然，这是一条经验法则，不要走极端，以免妨碍您的工作效率。

我知道这可能看起来需要做很多工作，但说实话，当你已经在努力编写一组测试时，情况并非如此。您可以高效*并*编写可靠的代码。你只需要知道什么时候作弊，什么时候不作弊。这伴随着经验，在 20 年后，其中 10 位编写 NUnit 的人，我仍然偶尔会失败。当由于您没有这样做而导致故障时，首先从 UI 中提取逻辑，然后编写一个单元测试来证明它已损坏，然后修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T20:54:29.257

除了 AD.NET 所说的。我只能在测试中使用这些私有属性，直到我完成重构（到模型视图控制器、模型视图演示器、模型视图视图模型），这样我根本不需要测试 GUI！

# c# - 消息框 If 循环

> ID：13770674
> 
> 赞同：-2
> 
> 时间：2012-12-07T20:42:44.560
> 
> 标签：c#, loops

实现变量时，我会弹出一个简单的消息框。由于我没有塞子，它会螺旋到无穷大。也许这只是我无法弄清楚塞子应该放在哪里，但无论我的解决方案如何，它似乎都没有停止。

```
if (number == 10)
{
    MessageBox.Show("Woot!");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:43:38.090

没有更多代码，您可以使用 a `break`（因为听起来您正在使用循环），或者将您的数字设置为 10 以外的其他值

```
while(switchstatement)
{
    ...logic...
    if(number == 10)
    {
        MessageBox.Show("woot");
        break;
    }
    ...more logic...
} 
```

或者，您可以设置终止循环的开关

```
while(switchstatement)
{
    ...logic...
    if(number == 10)
    {
        MessageBox.Show("woot");
        switchstatement = false;
    }
    ...more logic...
} 
```

这是基于有限的代码......所以如果这不正确，您可能必须提供更多代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:44:56.263

您正在使用一个变量，但我看不到您在哪里设置值，所以我假设您永远不会在循环中更改它。因此，您处于无限循环中。

你可以使用 a`for-loop`代替

```
for(int number = 0; number < 10; number++)
{
    MessageBox.Show("Woot!");
} 
```

或在一个`while`

```
int number = 0;
while(number++ < 10)
{
    MessageBox.Show("Woot!");
} 
```

*   [C#**增量**整数](http://www.dotnetperls.com/increment)
*   [**++ 运算符**（C# 参考）](http://msdn.microsoft.com/en-us/library/36x43w8w%28v=vs.110%29.aspx)

# java - Hibernate 4 - 可以向@ManyToMany Hibernate 额外表添加额外字段吗？

> ID：13770675
> 
> 赞同：0
> 
> 时间：2012-12-07T20:42:52.407
> 
> 标签：java, hibernate, annotations

[我有同样的问题，这里](https://stackoverflow.com/questions/1153409/can-add-extra-fields-to-manytomany-hibernate-extra-table)在 hibernate 3 中得到了回答。但是，我不能将此应用于休眠 4，因为没有 @CollectionOfElements 注释。有人可以提供可以使用hibernate 4执行的解决方案吗？

编辑：将@CollectionOfElements 更改为@ElementCollection 对我有用。我现在应该用@JoinTable 做什么，因为那里没有表格字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:00:35.917

Hibernate 4 仅支持标准 JPA 注释，即[@ElementCollection](http://docs.oracle.com/javaee/6/api/javax/persistence/ElementCollection.html)。

请注意，即使[Hibernate 3 也建议使用此标准注释](http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/annotations/CollectionOfElements.html)：

> 已弃用。使用@ElementCollection

# java - Java中PHP PDO的等价物

> ID：13770677
> 
> 赞同：6
> 
> 时间：2012-12-07T20:43:01.130
> 
> 标签：java, mysql, database, sqlite

有没有类似 PHP PDO for Java 的东西？所以我可以在开始时为 SQLite 开发，然后切换到 MySQL 或 PostgreSQL。

**更新：**不，我没有搜索*Java 数据库抽象*，因为我不知道要搜索什么

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T20:47:29.367

[**Java 数据库连接**](http://en.wikipedia.org/wiki/Java_Database_Connectivity)

JDBC 是 Sun Microsystems 的一种基于 Java 的数据访问技术（Java 标准版平台）。它是一个首字母缩略词，因为它被非正式地称为 Java 数据库连接，而 DB 被普遍认为是数据库的缩写。该技术是一种用于 Java 编程语言的 API，它定义了客户端如何访问数据库。它提供了查询和更新数据库中数据的方法。JDBC面向关系数据库。JDBC 到 ODBC 桥允许连接到 JVM 主机环境中任何 ODBC 可访问的数据源。

# mercurial - 如何区分在两者之间重命名的文件的两个修订版，而 Mercurial 不知道重命名？

> ID：13770678
> 
> 赞同：2
> 
> 时间：2012-12-07T20:43:02.863
> 
> 标签：mercurial

我不小心重命名了 Mercurial 之外的文件。当我提交更改时，Mercurial 将更改视为两个不相关的文件（即删除和添加）。我需要回去比较这两个版本，但当 Mercurial 将它们视为跨不同版本的两个相应文件时，我不知道该怎么做。我该怎么做才能区分文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T02:55:30.107

如果您想真正修复历史记录以便 Mercurial 知道重命名（并且可以在需要时在未来的合并中使用该信息），有一种[方法可以](http://mercurial.selenic.com/wiki/TipsAndTricks#Restore_file_history_after_file_move_without_rename)在 Mercurial wiki 上的[提示和技巧页面上记录。](http://mercurial.selenic.com/wiki/TipsAndTricks)

当前内容复制到此处以方便使用（以防链接稍后断开）：

脚步：

1.  将工作目录更新到重命名之前
2.  做一个实际的“hg rename”，这将创建一个新的头
3.  将该新头合并到您进行“手动”重命名的修订中（不是头修订！）
4.  然后最后将头部修订合并到这个合并结果中。

建议：

1.  先做一个克隆然后再做，以防万一！
2.  完成这些步骤后，使用文件比较工具检查原始文件和克隆文件是否相同
3.  检查任何移动文件的文件历史记录以确保它现在已恢复

话虽这么说，如果您只想比较当时的内容，那么您绝对可以在不让 Mercurial 意识到重命名的情况下完成此操作（如 Stephen Rasku 的回答中所述）。事实上，您可以结合使用“hg cat”和外部比较工具来比较任何文件，而不仅仅是 Mercurial 知道的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T21:06:46.463

修复历史：

*   使用新文件名更新到第一个变更集，将文件保存在 WC 之外
*   更新到错误替换变更集的父级，正确替换文件（使用重命名跟踪），提交，获得第二个头
*   将旧匿名分支的所有变更集重新设置在新的好变更集之上
*   `--close-branch`在替换错误的变更集上或删除此不需要的变更集或保持不活动的头部完好无损

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T22:13:16.217

你没有说你使用的是什么操作系统。以下内容适用于 Linux 上的 bash：

```
diff <(hg cat -r rev1 file1) <(hg cat -r rev2 file2) 
```

`vimdiff`如果你想要一个视觉差异，你可以用另一个程序替换差异。

# android - Android：使用简单日期格式显示时间

> ID：13770679
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:05.167
> 
> 标签：android, time, simpledateformat

我试图显示用户输入的时间，无论是在祝酒词中还是使用基本的 println 命令。如果时间格式正确，我想将它与当前时间一起输入数据库。

这是我到目前为止所拥有的：

```
public void addListenerOnButton ()
{
    spinner_hours = (Spinner)findViewById(R.id.hours);
    spinner_minutes = (Spinner)findViewById(R.id.minutes);
    btnSubmit = (Button) findViewById(R.id.btnSubmit);
    btnSubmit.setOnClickListener(new OnClickListener() {

        @Override
          public void onClick(View v) {
            Date time;
            String enteredTime= String.valueOf(spinner_hours.getSelectedItem())+String.valueOf(spinner_minutes.getSelectedItem())+"00";
            SimpleDateFormat format = new SimpleDateFormat("HH:mm:ss");

            try {
                time= format.parse(enteredTime);
                System.out.println(enteredTime);
            } catch (ParseException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        //   Toast.makeText(MainActivity.this,
        //              "Your alarm has been set for : " + time,
        //                  Toast.LENGTH_SHORT).show();

          }
    });
} 
```

如果我将吐司（下面评论）放在 try 块中，则在我运行应用程序时它不会显示。如果我放一个 system.out.println 它不会打印任何东西。如何打印输入的时间？

另外，我想在数据库中以相同的格式（“HH:mm:ss”）输入当前时间。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:53:29.697

它可能会引发异常，因为`System.out.println`应该可以工作。尝试替换这个：

`String enteredTime= String.valueOf(spinner_hours.getSelectedItem())+String.valueOf(spinner_minutes.getSelectedItem())+"00";`

这样：

`String enteredTime= String.valueOf(spinner_hours.getSelectedItem())+ ":" + String.valueOf(spinner_minutes.getSelectedItem())+":00";`

似乎您在小时和分钟之间以及 00 之前缺少 : 并且解析失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:33:35.923

首先尝试打印从 Spinner 获得的值

```
 System.out.println(spinner_hours.getSelectedItem().toString());
 System.out.println(spinner_minutes.getSelectedItem().toString()); 
```

如果这没有任何价值，那么问题就在这里。

# c# - asmx Web 服务中命名空间的顺序

> ID：13770680
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:10.443
> 
> 标签：c#, asp.net, web-services, asmx

我们有数百名客户使用的 asmx Web 服务。我们最近进行了一些重构，包括升级到 .NET 4.0。

我们通过使用日志中的数据作为参数执行大量请求来测试重构版本，并比较旧的和重构的 Web 服务的原始结果。我们发现的唯一区别是结果的命名空间是另一个顺序。请注意，旧的和重构的 Web 服务位于不同的服务器上。命名空间的不同顺序似乎可以安全释放，所以这就是我们所做的......

今天，一位客户联系我，告诉我他们无法读取我们的结果，并指出这个命名空间问题是原因。这对我来说似乎很奇怪，因为他们必须有一个或多或少损坏的 XML 解析器才能得到这样的问题。但是，我会尝试隔离这一点，因为我们每小时都会损失很多钱。

我将我们的项目恢复到 .NET 3.5，但获得了相同的命名空间顺序。但是服务器之间的命名空间顺序似乎有所不同。

有谁知道为什么顺序不同？它与 .NET 版本、其他组件的版本有关还是只是随机的？

从服务器一：

```
<?xml version="1.0" encoding="utf-8"?>
<result xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://mydomain.com/">
... 
```

从服务器二：

```
<?xml version="1.0" encoding="utf-8"?>
<result xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://mydomain.com/">
... 
```

我有点卡住了...

# c++ - 奇怪的函数似乎改变了向量值

> ID：13770682
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:22.120
> 
> 标签：c++, vector, return

我必须通过检查电子邮件的来源是否在黑名单中或电子邮件内容中的任何单词是否在被阻止的单词列表中找到来对电子邮件进行过滤。

这是过滤电子邮件的功能。

```
void filterEmail(vector<email>& amis, vector<email>& corbeille, 
                 vector<email>& rejete, vector<email>& emails, 
                 vector<string> b, vector<string> w, 
                 vector<string> spam)
    {
        bool isListed(email, vector<string>);
        bool isSpam(email, vector<string>);

        for(vector<email>::size_type i = 0; i < emails.size();)
        {
            if(isListed(emails[i], b))
            {
                corbeille.push_back(emails[i]);
                emails.erase(emails.begin() + i); 
            }
            else i++;
        }
        for(vector<email>::size_type i = 0; i < emails.size();)
        {
            if(isListed(emails[i], w))
            {
                amis.push_back(emails[i]); 
                emails.erase(emails.begin() + i);
            }
            else i++;
        }
        for(vector<email>::size_type i = 0; i < emails.size();)
        {
            if(isSpam(emails[i], spam))
            {
                cout << emails[i].source << "   " << emails[i].content[0]; 
                rejete.push_back(emails[i]); 
                emails.erase(emails.begin() + i);
            }
            else i++;
        }

        return;
    } 
```

我在第一次isSpam返回true后意识到，在几次测试cout之后检查内容中的垃圾邮件词（第三个for循环）的部分有一个非常奇怪的问题，电子邮件的内容更改为它首先出现的行返回 true，所有接下来的电子邮件都返回 true。

```
bool isSpam(const email e, const vector<string> motsinterdis)
{
    for(vector<string>::size_type i = 0; i < e.content.size(); ++i)
    {
        for(vector<string>::size_type j = 0; j < motsinterdis.size(); ++j)
        {
            if(string::npos != e.content[i].find(motsinterdis[j]))
            {
                cout << e.source << endl;
                cout << motsinterdis[j] << " found in " << e.content[i] << endl;

                return true;

            }
        }
    }

return false;
} 
```

我有一个结构电子邮件，其中包含一个矢量内容。对不起那里的法语变量：P希望我已经足够清楚了，非常感谢。

# sql-server - 在 Powershell 脚本中使用 SQL Server Service Broker？

> ID：13770684
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:35.017
> 
> 标签：sql-server, powershell, service-broker

我有一个 PowerShell 脚本执行以下任务：

```
Loop a big database table
  Generate text file
  Zip the text file
  FTP upload the zipped file
  Write to the log table 
```

生成文本文件的步骤可能需要更短或更长的时间，具体取决于数据。并且FTP上传时间需要一段时间。所以我想至少使这两个步骤异步。SQL Server Service Broker 是一个可行的选择吗？有什么例子吗？还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T07:43:51.347

您不能在 PowerShell 中将它们设置为 aysnc，但您可以使用 Start-Job cmdlet 将它们放在另一个线程上并等待它们完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T15:38:34.913

默认情况下，使用 Service Broker 将使它们异步工作。棘手的事情是，如果您仍然想按顺序运行其中的一些，您需要为它们添加一个对话组 ID。

# ios - 如何处理 iOS UIViews 旋转和对齐

> ID：13770687
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:53.003
> 
> 标签：ios, alignment, rotatetransform

在我现有的应用程序中，我有 5 个 UIView 衍生物（标签和按钮）水平放置，即 0 度。它们都在左边缘对齐（因此 button1.frame.origin.x = button2.frame.origin.x 等等。）

现在，为了更新的目的，我需要将它们中的所有 5 个逆时针旋转 9 度。

我很容易实现旋转。但我不知道如何调整它们的左边缘，以便它们在旋转后再次对齐。

总而言之，要求是：第一个控件需要保持固定（充当枢轴点） - 其他 4 个控件需要向右移动以在旋转后保持左对齐。

我尝试将增量 x 值添加到最后 4 个控件中的每一个（保持枢轴 x 固定），但到目前为止还没有实现精确对齐。

旋转后，看起来它们都是中心对齐的，而不是我真正想要的左对齐。我知道我真正想要什么，但只是寻找一种更聪明的方式，这样它就不会像现在这样丑陋。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:26:08.193

阅读有关布局约束的信息。这真的会在很多方面帮助你。在布局约束中，这个概念非常简单，比如

Control1.attribute = Control2.attribute + C

因此，您可以从字面上对每个控件属性进行编程并实现细粒度控制。然后，您可以对其进行编码，使所有控件 X 与其他控件 X 相同，它们与另一个控件的距离都相同等。

您可以有多个布局约束，系统将尝试满足尽可能多的约束。

但唯一的一点是，这在 iOS 6.0 中是可能的。

# c# - 如何实现嵌套列？

> ID：13770688
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:52.930
> 
> 标签：c#, winforms, datagrid

我正在尝试使用 VS2010 C# 重新开发 Delphi db Windows 应用程序。

在 Delphi 应用程序中，我在 DBGrid 组件中创建了一个嵌套列。

文本列（“虚拟问题”）通常如下所示：

![在此处输入图像描述](../Images/499f1b6805a902876dead8d9b6807c51.png)

然后我破解了网格列，因此我可以选择像这样显示它：

![在此处输入图像描述](../Images/7fe8267d0c88f7475afd7431983443d4.png)

如何使用 Visual Studio 2010 C# 控件实现这样的可扩展/可折叠嵌套列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:02:08.027

看看 DevExpress 数据网格 - BandedGridView。

> 带状网格视图允许您将列排列成带状。从视觉上看，波段由它们的标题表示，这些标题显示在属于该波段的列的标题上。

[BandedGridView 类](http://documentation.devexpress.com/#WindowsForms/clsDevExpressXtraGridViewsBandedGridBandedGridViewtopic)

# azure - 在 azure 上提供静态 JSON 文件

> ID：13770689
> 
> 赞同：0
> 
> 时间：2012-12-07T20:43:54.693
> 
> 标签：azure, sencha-touch

我制作了一个简单的 Sencha Touch Web 应用程序并将其部署到 Azure 以试用 Azure。Sencha Touch 所做的第一件事就是尝试下载 app.json 文件。在 IIS 上，我通常会在 mime 类型部分启用 json，但我无法弄清楚如何使用 Azure Web 控制台执行此操作。因此，当应用执行 XMLHttpRequest 以获取文件时，将返回 404 错误。

我在 SO 上看到了一些关于将 .json 添加到 web.config 的帖子，我尝试了以下方法，但无济于事：

```
<system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <staticContent>
      <remove fileExtension=".json"/>
      <mimeMap fileExtension=".json" mimeType="application/json"  />
    </staticContent>
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer> 
```

网络应用程序在这里。

[http://nsgapp.azurewebsites.net](http://nsgapp.azurewebsites.net)

非常感谢有关如何启用 Azure 共享实例来提供 .json 文件的任何输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:14:51.440

没关系，这是一个愚蠢的错误。我有两个网站……一个为 sencha Web 应用程序提供服务，一个为 Web 服务提供 ASP.NET MVC WebAPI 站点。我在后者上启用了 json，而我应该在前者上启用它，因为 app.json 是从实际的客户端应用程序中提供的。因此，启用 azure 下载静态 json 文件的正确方法是确保您拥有以下内容：

```
<system.webServer>
    <staticContent>
      <remove fileExtension=".json"/>
      <mimeMap fileExtension=".json" mimeType="application/json"  />
    </staticContent>
  </system.webServer> 
```

在 web.config 中。

# c# - 调试托管在 Web 应用程序中的 WCF 服务库没有达到断点

> ID：13770693
> 
> 赞同：0
> 
> 时间：2012-12-07T20:44:03.157
> 
> 标签：c#, wcf, visual-studio-2012

我在同一个解决方案中创建了一个 WCF 服务应用程序（在 VS 2012 中使用 IIS Express 托管的 WAS）项目和一个 WCF 类库。当我运行解决方案时，服务器应用程序在 IIS Express 下运行。我的类库命名空间是：Wfm.MarketManager.WebServices 和网络应用程序命名空间是 Wfm.MarketManager.WebServices.Web 在 Wfm.MarketManager.WebServices.Web 我有一个 .svc 文件：

```
<%@ ServiceHost Language="C#" Debug="true" Service="Wfm.MarketManager.WebServices.ListWebService" Factory="Wfm.MarketManager.WebServices.WcfServiceFactory" %> 
```

我有另一个 VS 2012 实例，其 Web 应用程序具有对从 WCF 服务应用程序 (http://localhost:12345/ListWebService.svc) 创建的内容的服务引用该服务被正确调用，但我的断点不是在里面被击中。我记得在创建类似项目时在 VS 2010 中工作。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:19:48.173

原来我的自定义工厂（WcfServiceFactory）存在问题，我在调试器中没有看到。一旦我打开，`includeExceptionDetailInFaults`我看到它失败的地方。现在它步入正轨。不过，奇怪的是我的工厂有一个断点。它现在正在工作。

```
<serviceDebug includeExceptionDetailInFaults="true" /> 
```

# android - 连接到PC时如何更新android中的文件

> ID：13770695
> 
> 赞同：0
> 
> 时间：2012-12-07T20:44:22.197
> 
> 标签：android, android-sdcard, android-file

我有一个应用程序，每当用户点击记录按钮时都会写入信息并且工作正常。现在，当我将设备连接到 PC 并运行该应用程序时，它仍然可以正常工作并向我显示设备上的最新信息，但它不会更新我在 PC 上查看的文件。每次文件写入完成后，如何更新（或刷新）我的文件？（顺便说一下，我正在设备的内存上写信息）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:34:29.760

您是否尝试在 SD 卡安装在您的 PC 上时对其进行写入？当它安装在 PC 上时，由于其文件系统的工作方式，它会在您的手机上卸载，这就是发生这种情况的原因。

# javascript - !function ($) { }(window.jQuery) 这段代码是干什么用的？

> ID：13770704
> 
> 赞同：0
> 
> 时间：2012-12-07T20:45:00.300
> 
> 标签：javascript, jquery

> **可能重复：**
> [这样做的目的是什么？(function ($) { //这里的函数代码 })(jQuery);](https://stackoverflow.com/questions/8305288/what-is-the-purpose-of-this-function-function-code-here-jquery)
> [函数前的感叹号有什么作用？](https://stackoverflow.com/questions/3755606/what-does-the-exclamation-mark-do-before-the-function)
> [否定自调用函数？!function ($) { ... }(window.jQuery);](https://stackoverflow.com/questions/13597481/negating-self-invoking-function-function-window-jquery)

```
!function ($) {
     $(function() {
            .
            .
            .
    })
}(window.jQuery) 
```

我在一个 jquery 示例中看到了这一点，并且想知道 !function($){}(window.jQuery) 的用途。特别是感叹号对我来说是新的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:45:00.300

好的，我在做了一些研究后想通了，但我会把答案留给其他人。

基本上是为了**避免与其他**也使用美元符号的 javascript 库发生冲突。

所以 Jquery 建议使用**jQuery 或 window.jQuery 而不是美元符号**。它通常与 **jQuery.noConflict()结合使用，以使 jQuery 在****混合库**时放弃其他 javascript 库中使用的 $ 符号。

这实际上是一种运行**自执行函数**的方法，该函数**传入****window.jQuery 对象**并将其传递给**$**符号。这样，您可以继续在代码中使用美元符号，而不必担心其他可能导致与您的代码发生冲突的 JavaScript 库。

**将它包装在这个函数中可以避免在任何地方使用 window.jQuery**来替换 $ 符号。

如果你**`execute function () {}()`** 喜欢这个，它会导致**语法错误**，因为它只是一个函数声明。**！** _ **把它变成一个**可以执行的表达式。

所以基本上你可以将两者用于相同的目的。

```
!function($){}()
(function($){})() 
```

随意修改或补充。

参考：

*   [这样做的目的是什么？(function ($) { //这里的函数代码 })(jQuery);](https://stackoverflow.com/questions/8305288/what-is-the-purpose-of-this-function-function-code-here-jquery)
*   [函数前的感叹号有什么作用？](https://stackoverflow.com/questions/3755606/what-does-the-exclamation-mark-do-before-the-function)

# scala - CRUDify MegaProtoUser - 这是一个正确的解决方案吗？

> ID：13770705
> 
> 赞同：3
> 
> 时间：2012-12-07T20:45:01.287
> 
> 标签：scala, lift, crud

我正在使用带有 Scala 2.9.1 的 liftweb 2.5-SNAPSHOT。

在我的电梯应用程序中，我想同时使用一个 USer 类，用于每个用户的自我管理的 MegaProtoUser 特征和用于管理员的 CRUD 视图的 CRUDify 特征。

当我尝试一个简单的方法并同时使用两个训练扩展我的 User 模型对象时，我得到编译错误，因为这两个特征有几个共同的部分（函数和类型）而不使用覆盖。

相反，我对两个模型对象使用以下方法：

```
import net.liftweb.mapper._

/**
 * Entity class for users
 */
class User extends MegaProtoUser[User] {
  override def getSingleton = User
}

/**
 * Provides the meta model for User together with the self administration features for each user
 */
object User extends User with MetaMegaProtoUser[User] {
  override def dbTableName = "users"
}

/**
 * Again the meta model for User, but this time without self administration but with the CRUD view for the administrator
 */
object UserAdministration extends User with KeyedMetaMapper[Long, User] with ProtoUser[User] with CRUDify[Long, User] {
  override def dbTableName = User.dbTableName
} 
```

这种方法似乎有效，但我不确定是否遗漏了一些细节。

1.  有更好的方法吗？
2.  我的方法是否有一些我在这里遗漏的无意影响？
3.  最后，当我将来应该升级到更新的电梯版本时，它仍然可以工作吗？

# java - Java 中的 Monitor.TryEnter 等效项

> ID：13770706
> 
> 赞同：2
> 
> 时间：2012-12-07T20:45:01.780
> 
> 标签：java, multithreading, thread-safety

如果某个线程在java中通过此方法拥有，如何跳过方法，我知道在.net中存在`Monitor.TryEnter`，我可以通过以下方式完成：

```
if(Monitor.TryEnter()){
 //do work
}
//else skip 
```

但是我怎样才能在 java 中完成这种行为，这与 java 中的任何等价物都是`Monitor.TryEnter`一样的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:50:02.843

会[`ReentrantLock#tryLock()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html#tryLock%28%29)为你工作吗？

它具有您想要的行为，*但*它需要一个显式锁定对象，因此它不适用于嵌入式 Java 对象监视器 - 我不相信`tryLock()`Java 对象监视器有等效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T11:25:13.027

我认为您最好使用[java.util.concurrent.Semaphore](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Semaphore.html)。

如果您使用持有一个许可证的信号量：

```
Semaphore semaphore = new Semaphore(1); 
```

结果代码看起来几乎相同：

```
if (semaphore.tryAcquire()) {
    try {
        // do work
    } finally {
        semaphore.release();
    }
}
// else skip 
```

我想在.Net中你还必须确保再次释放锁。

# java - Java 继承之谜

> ID：13770710
> 
> 赞同：8
> 
> 时间：2012-12-07T20:45:19.953
> 
> 标签：java, inheritance

我为 Java 中的继承创建了以下难题：

**动物.java**

```
public class Animal {
    private String sound;

    public void roar() {
        System.out.println(sound);
    }

    public void setSound(String sound) {
        this.sound = sound;
    }
} 
```

**老虎.java**

```
public class Tiger extends Animal {
    public String sound;

    public Tiger() {
        sound = "ROAR";
    }
} 
```

**丛林.java**

```
public class Jungle {
    public static void main(String[] args) {
        Tiger diego = new Tiger();

        diego.roar();
        diego.sound = "Hust hust";
        diego.roar();
        diego.setSound("bla");
        diego.roar();
        System.out.println(diego.sound);
    }
} 
```

**输出：**

```
null
null
bla
Hust hust 
```

我想这种奇怪的行为正在发生，因为`sound`在 Animal 中是私有的，而`sound`在 Tiger 中是公共的。但是你能解释一下（并告诉我 JLS 的相关部分）为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T20:49:51.470

字段不是多态的，方法是多态的。

```
 diego.roar(); 
```

调用`roar()`方法 in并从`Animal`打印。`sound``Animal`

```
diego.sound = "Hust hust"; 
```

`Tiger`在类`sound`变量中设置声音值

```
diego.roar(); 
```

返回空值；因为从 Animal 打印声音，它仍然是空的。上面的声音分配反映在 Tiger 类变量上，而不是 Animal 类。

diego.setSound("bla");

将`Animal`声音设置为`bla`

```
diego.roar(); 
```

打印`bla`是因为 setSound 更新了 Animal 类的声音变量`bla`。

System.out.println(diego.sound);

打印`Hust hust`是因为 diego 是 type`Tiger`并且您访问了 field sound of`Tiger`并且字段不是多态的。

有关详细信息，请参阅[java 语言规范 8.3 。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T20:49:04.927

您可以覆盖 Java 中的函数，而不是变量。

`public String sound;`从_`Tiger.java`

或者：

*   声明`String sound`为`protected`或`public`,`Animal.java`或
*   为受控访问成员变量定义一个`setSound()`函数（即）`Animal.java``sound`

有关更全面的解释，请参阅[Jon Skeet 昨天对几乎相同问题的出色回答](https://stackoverflow.com/questions/13748124/why-java-polymorphism-not-work-in-my-example/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T21:04:47.880

正如其他人已经指出的那样：字段不受多态性的影响。

我对此的新转变是：对字段的访问是在编译时*静态*决定的，而不是在运行时*动态决定的。*所以在这里

```
Tiger diego = new Tiger();
diego.sound = "Hust hust"; 
```

该变量`diego`具有静态类型`Tiger`。因此编译器将生成对`Tiger.sound`. 但相比之下（如果`Animal.sound`不会`private`）：

```
Animal diego = new Tiger();
diego.sound = "Hust hust"; 
```

编译器将生成对`Animal.sound`. 这也可以通过强制转换：

```
Tiger diego = new Tiger();
((Animal)diego).sound = "Hust hust"; 
```

考虑到这一点，您可以完成您的难题，并且对于对任何`sound`字段的每次访问，您都可以告诉静态类型是隐式的`this`还是`diego`那个点的静态类型。然后您还知道实际访问了这两个字段中的哪一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T20:58:32.560

您必须认识到`Animal.sound`与 不同的字段`Tiger.sound`。实际上，您有两个不同的字段，可以有两个不同的值，并以两种不同的方式设置。

`Animal.setSound()`更新 的值`Animal.sound`，不更新 的值`Tiger.sound`。

`diego.sound = "Hust hust"`更新 的值`Tiger.sound`，而不是 的值`Animal.sound`。

请参阅[Inheritance Turorial](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)[中您可以在子类](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)中做什么部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T20:50:01.690

将类更改`Tiger`为：

```
public class Tiger extends Animal {

    public Tiger() {
        setSound("ROAR");
    }
} 
```

问题是`roar()`定义的方法使用了在同一个类中定义`Animal`的成员私有字段。`sound``Animal`

`sound`from对班级`Animal`不可见`Tiger`，因为它是私有的。因此，您为子类声明了一个新`sound`字段`Tiger`，但这并没有覆盖来自`Animal`. 该类`Animal`仍然使用它自己的版本`sound`，因为它是它看到的唯一版本。**与方法不同，字段不能被覆盖**。

一种解决方案是使用基类 ( `Animal`) 中声明的 getter/setter 方法对属性的所有访问，甚至从子类中访问。

* * *

另一种可能的解决方案是使用**抽象**方法和多态性：

您无需在 Animal 基类中实现 sound 方法，您只需声明一个抽象方法并强制子类提供它们自己的实现：

```
public abstract class Animal {
    public void roar() {
        System.out.println(sound());
    }

    public abstract String sound();
}

public class Tiger extends Animal {
    public String sound() {
        return "ROAR";
    }
}

public class Dog extends Animal {
    public String sound() {
        return "HOOF HOOF";
    }
} 
```

即使`sound()`Animal 中的方法没有实现（没有带有代码的主体），仍然可以从该类的其他方法调用该方法，例如`roar()`.

当然，这种做法会让你无法改变一个已经存在的动物对象的声音（没有setter），让动物**不可变**，乍一看可能看起来很不方便，但如果你仔细想想，你可能会发现在许多情况下，您实际上不需要以这种方式更改对象的状态。

使用*不可变*对象实际上很方便，因为代码更加简单和安全，因为您不必考虑程序执行过程中可能出现的所有可能状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T20:50:18.737

system out 语句 (1) 和 (2) 指的是超类的实例变量声音，它没有被继承，因为实例/类变量在 java 中没有被继承，并且您没有设置超变量。(3), super 变量是通过调用继承的方法来设置的。(4) 是在你进行直接赋值时设置的。

# ruby-on-rails - Rails：在 Heroku 上启动 Sidekiq

> ID：13770713
> 
> 赞同：51
> 
> 时间：2012-12-07T20:45:44.600
> 
> 标签：ruby-on-rails, heroku, sidekiq

我在 Heroku 部署的 Rails 应用程序上启动并运行 Sidekiq 时遇到问题。我的应用程序在开发中运行良好（以及在没有 Sidekiq 的 Heroku 上）。

我创建了一个 Procfile：

```
worker: bundle exec sidekiq 
```

如果我运行`heroku ps`，我看到的唯一进程是`web.1`.

我应该为 Sidekiq 看一个吗？

我确实收到一个错误：

`Redis::CannotConnectError (Error connecting to Redis on localhost:6379)`在我的 Heroku 日志中。

更新：发现我可能需要`heroku addons:add redistogo`. 还是行不通。我觉得我缺少一些基本配置。

我需要做些什么来让 Redis 为我的 Heroku 应用程序启动并运行吗？

我已经使用 Redis/Sidekiq 大约一天了，所以这对我来说是新的。

谢谢！

格雷格

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-12-19T09:04:46.403

不，你不需要对 Sidekiq 的 Heroku 进行任何配置，只需添加**RedisToGo**插件就可以了。不要忘记在您的 Heroku 配置中将至少 1 个*工作人员分配给您的应用程序。*

这是我的默认 Procfile：

```
web: bundle exec thin start -p $PORT
worker: bundle exec sidekiq -c 5 -v 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-08-23T22:48:45.757

值得检查一下 sidekiq 进程是否真的是用这个命令启动的：

```
heroku ps 
```

如果没有工人，那么您可能需要运行以下命令：

```
heroku ps:scale worker+1 
```

事实证明，Web UI 中存在一个错误，即不允许某些团队成员将工作人员的数量从 0 增加到 1，即使 UI 似乎显示了这一点！

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-07-03T21:58:31.910

从 sidekiq 3.0 版开始，有一个额外的步骤，`heroku config:set REDIS_PROVIDER=REDISTOGO_URL`在控制台中运行。

这是我用于 Rails 4 的过程：

在控制台中：

```
heroku addons:create redistogo
heroku config:set REDIS_PROVIDER=REDISTOGO_URL 
```

在我的`Procfile`我补充说：

```
worker: bundle exec sidekiq 
```

在我的`gemfile.rb`我补充说：

```
gem 'redis' 
```

我添加了以下文件`config/initializers/redis.rb`：

```
uri = ENV["REDISTOGO_URL"] || "redis://localhost:6379/"
REDIS = Redis.new(:url => uri) 
```

这是sidekiq 文档的[链接。](https://github.com/mperham/sidekiq/wiki/Deployment#heroku)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-05-30T17:16:41.023

补充 gdurelle 答案：

您确实需要使用 Heroku 为 Sidekiq 进行一些配置：

1）在我的情况下，安装 Sidekiq 和 Redis gem（在 gemfile 中并捆绑）：

宝石文件

```
gem 'redis', '~> 3.1'
gem 'sidekiq', '~> 2.7', '>= 2.7.1' 
```

2）添加一个工人，如果你没有在本地创建任何工人我建议你至少创建一个，以防万一，使用这个：

```
rails g sidekiq:worker Hard # will create app/workers/hard_worker.rb 
```

应该创建这个：

应用程序/工人/hard_worker.rb

```
class HardWorker
  include Sidekiq::Worker
  def perform(name, count)
    # do something
  end
end 
```

3) 添加 Redis 插件（在我的例子中是 Heroku Redis）：

```
heroku addons:create heroku-redis:hobby-dev 
```

4）添加你的 redis.rb 文件，在我的例子中：

配置/初始化程序/redis.rb

```
$redis = Redis.new(url: ENV["REDIS_URL"]) 
```

5）添加 Procfile 或 config/sidekiq.yml 或两者，这是我的：

档案

```
worker: bundle exec sidekiq -c 1 -q default -q mailers 
```

您可以通过将其粘贴到终端中来更轻松地创建

```
echo "worker: bundle exec sidekiq -c 1 -q default -q mailers" > Procfile 
```

配置/sidekiq.yml

```
:concurrency: 1
:queues:
  - [mailers, 7]
  - [default, 5] 
```

6）最重要的部分在[这里](https://dashboard.heroku.com/apps/equitec-app/resources)： ![](../Images/7afbae916e4a10a98c676d8121940dfb.png) 打开你的工人的开关，点击铅笔，然后打开丢失的开关。现在应该一切正常，祝您有美好的一天！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-06T12:43:20.997

我发现您必须像这样手动扩展流程：

```
heroku ps:scale worker+1 
```

没有意义，因为我的 Procfile 说：

```
web: bundle exec....
worker: bundle exec sidekiq 
```

...人们会期望 Heroku 自动启动工作程序。最后，我不必扩展 Web 流程......

此外，您可能会遇到以下问题：worker: bundle exec sidekiq

为并发添加标志：

```
worker: bundle exec sidekiq -c 5 -v 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-07T23:11:00.660

听起来你快到了。可能您只需要在[heroku 配置](https://devcenter.heroku.com/articles/config-vars)上设置 REDISTOGO_URL吗？

```
heroku config 
```

应该向您展示 redistogo 的价值吗？

如果您将其复制到 REDISTOGO_URL 那么 sidekiq 应该可以工作吗？

```
heroku config:add REDISTOGO_URL=<redistogo value> 
```

***编辑：*** Sidekiq 目前将使用这些中的任何一个： [https ://github.com/mperham/sidekiq/blob/master/lib/sidekiq/redis_connection.rb#L29-L33](https://github.com/mperham/sidekiq/blob/master/lib/sidekiq/redis_connection.rb#L29-L33)

***Edit2：*** Greg 是正确的，如果您使用 RedisToGo，则不需要添加配置。但是如果您使用的是 OpenRedis 或其他 Redis 提供程序，则需要为 Sidekiq 添加 REDISTOGO_URL

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-09-19T16:10:21.937

您当然可以在当前作业队列旁边运行 sidekiq。

我们的 Procfile 目前看起来像这样：

```
web: bundle exec thin start -R config.ru -e $RAILS_ENV -p $PORT
worker:  bundle exec rake jobs:work
sidekiq: bundle exec sidekiq -c 5 -v 
```

# java - 抽象类中有空的具体方法有什么原因吗？

> ID：13770715
> 
> 赞同：6
> 
> 时间：2012-12-07T20:45:53.360
> 
> 标签：java, oop, class-hierarchy

我最近在浏览一些开源代码 PicketLink 代码。如果你看一下[这个类](http://grepcode.com/file/repository.jboss.org/nexus/content/repositories/releases/org.picketlink/picketlink-web/2.0.1.final/org/picketlink/identity/federation/web/handlers/saml2/BaseSAML2Handler.java#BaseSAML2Handler)，你会在一个抽象类中看到许多具体方法，它们什么都不做。这样做有什么目的吗？

我想到了两件事：

1.  如果该方法需要被子类覆盖而不是在父抽象类中定义，为什么不简单地将其抽象化呢？
2.  如果实际上只有*一些*子类需要实现该方法，这是否表明需要重组类层次结构，以免子类被迫拥有不适用的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T21:02:15.417

[虽然不是最常见的情况，但有时在模板方法](http://www.oodesign.com/template-method-pattern.html)的上下文中很方便。在这种情况下，有一个定义流程的方法，将某些部分的具体实现留给它的子类。在某些情况下，默认的具体行为是什么都不做，将基类中的具体方法留空，但允许通过覆盖在子类中进行自定义。

高温高压

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T21:14:02.640

我个人认为这是一种代码气味。

就像您说的那样，除非它们具有某些基本功能-它们没有，否则它们应该是抽象的，从而强制派生类提供实现。

如果某些派生类不应该有这些方法的实现，那么设计可能有问题。

考虑一下：

```
public abstract class Animal
{
    public abstract string Speak();
}

public class Dog : Animal
{
    public override string Speak()
    {
        Console.WriteLine("Woof");
    }
}

public class Cat : Animal
{
    public override string Speak()
    {
        Console.WriteLine("Meow");
    }
} 
```

到目前为止一切都很好，但是如果你想添加一个不会说话的动物怎么办？

```
public class Ant : Animal
{
    public override string Speak()
    {
        // do nothing - ants don't speak.
    }
} 
```

在我看来，这很糟糕。有人可能会这样做（你所描述的）。

```
public abstract class Animal
{
    public string Speak()
    {
        // not abstract because not all derived animals speak.
    }
} 
```

在我看来，这更好，但仍然不是很好。在这种情况下，我希望看到的是将 Speak 移动到一个界面，并且只有会说话的动物才能实现它，或者类似的东西。

```
public abstract class Animal
{
}

public abstract class Mammal : Animal
{
    public abstract string Speak();
}

public class Dog : Mammal
{
    public override string Speak()
    {
        Console.WriteLine("Woof");
    }
}

public class Cat : Mammal
{
    public override string Speak()
    {
        Console.WriteLine("Meow");
    }
}

public class Ant : Animal
{
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T21:25:15.873

根据 Andres Fortier 的回答，您还将在 Swing 中看到很多这种模式，以及各种 EventListener Adapter 类。例如，[MouseAdapter](http://docs.oracle.com/javase/6/docs/api/java/awt/event/MouseAdapter.html)为每个监听器方法提供了对应的空方法。这允许接口定义所有相关方法，但实现扩展相应的适配器并且只覆盖他们关心的单个方法，而不是被迫为所有其他接口方法提供空主体。

# c - 添加到 malloc 数组的值成为 malloc 数组中的所有值

> ID：13770716
> 
> 赞同：-2
> 
> 时间：2012-12-07T20:45:54.373
> 
> 标签：c, struct, malloc, arrays

我已经写了这个函数（下）。它应该逐行读取文件。编辑该行并将某些单词/字符放在各种功能中。然后将这些函数放入“进入”结构的数组（malloc）中。

问题是，当我退出循环并尝试打印出数组时，放入数组的最后一个结构名称变量是唯一打印出的名称变量。例如，如果我尝试打印出数组的前 10 个结构名称变量，则最后一个结构名称变量将被打印 10 次。然而，整数（数字变量）工作正常。

我使用 fgets() 读取文件的行，并在文件末尾从循环中中断。可能 fgets() 可能是问题，但这似乎不太可能......

我不知道问题是什么，但正如我所说，数字变量打印得很好，但名称只打印出最后一个。

但是从文件中获取信息却没有。如果将我的循环打印语句放在 while 循环中，它仍然不起作用。

需要注意的一件事是，使用 strtok、strcpy 和 strcat 将行放入单独的变量中工作正常。我不认为这是造成它的原因。

```
struct entrant {
  int number;
  char *name;
};

void read_in_entrants(char fileName[]) {
    FILE *fr;
    fr = fopen(fileName, "rt");

    //Init.
    struct entrant * entrant_array = (struct entrant*) malloc(sizeof (struct entrant));
    int j, temp, k = 0;
    int *number;
    char line[80];
    char name[80];
    char surname[80];

    while(1) {
        //Read line in file.
        fgets(line, 80, fr);

        //If at end of file break from loop.
         if (feof(fr)) break;

        //Edit line to be stored in variables.
        number = strtok(line, " ");
        strcpy(name, strtok(NULL, " "));
        strcpy(surname, strtok(NULL, " "));
        strcat(name, " ");
        strcat(name, surname);

        //Add variables to struct array.
        entrant_array[k].number = atoi(number);
        entrant_array[k].name = name;
        printf(" %d %s\n", entrant_array[k].number, entrant_array[k].name);

        //Handle malloc array memory.
        temp = realloc(entrant_array, (k + 2) * sizeof (struct entrant));
        if (temp != NULL) {
            entrant_array = temp;
        } else {
            free(entrant_array);
            printf("Error in memory allocation!");
            return 1;
        }
        //Increase k.
        k++;
    }

    //Print struct values in array.
    for (j = 0; j < 10; j++) {
        printf(" %d %s", entrant_array[j].number, entrant_array[j].name);
    }

   //Shut down.
   free(entrant_array);
   fclose(fr);
} 
```

无论如何，我已经为此苦苦挣扎了几个小时，但我无法解决它。我对 C 的了解非常有限，而且我很不知道我需要做什么来解决这个问题。

感谢您的帮助，非常感谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:51:35.337

entrant.name 是一个指针，您将其分配给同一个本地 char 数组。所以所有的指针都指向同一个变量，它只包含你最后读到的东西。直到它超出范围，此时它将指向随机存储器。

最快的解决方法是更换

```
entrant_array[k].name = name; 
```

和

```
entrant_array[k].name = strdup(name); 
```

但是您需要记住稍后释放该内存。

# php - 我需要在 Wordpress 中使用什么功能来解析自定义分类的子类别的 URL？

> ID：13770721
> 
> 赞同：0
> 
> 时间：2012-12-07T20:46:12.997
> 
> 标签：php, wordpress, wordpress-theming

我环顾四周，注意到已经问了很多关于这个的问题。但没有人有我需要的答案。

您可以在下面找到我自己主题中的页面模板的 php/html 脚本（我使用它们是因为公司网站上有更多功能）。那不是问题所在。奇迹般有效。

这个脚本有什么作用？

它在分类客户端下输出所有类别的特色图像（通过插件“类别图像”）。

完美运行！！那不是问题。

我需要的唯一代码行在 PHP 循环中作为评论提到......有人可以帮助我吗？

```
 <ul>
 <?php $args = array( 
    'type'                     => 'post',
    'child_of'                 => '',
    'parent'                   => '',
    'orderby'                  => 'name',
    'order'                    => 'ASC',
    'hide_empty'               => 0,
    'hierarchical'             => 1,
    'exclude'                  => '',
    'include'                  => '',
    'number'                   => '',
    'taxonomy'                 => 'clients',
    'pad_counts'               => false ); ?>

<?php foreach (get_categoris($args) as $cat) : ?>
<li>
<a href=" <?php // WHAT GOES HERE?? ?>">
<img src="<?php echo z_taxonomy_image_url($cat->term_id); ?>"/></a></li>
<?php endforeach; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T08:59:36.353

知道了！！！作品！！

```
 <ul>
 <?php $args = array( 
    'type'                     => 'post',
    'child_of'                 => '',
    'parent'                   => '',
    'orderby'                  => 'name',
    'order'                    => 'ASC',
    'hide_empty'               => 0,
    'hierarchical'             => 1,
    'exclude'                  => '',
    'include'                  => '',
    'number'                   => '',
    'taxonomy'                 => 'clients',
    'pad_counts'               => false );

 $tax_menu_items = get_categories( $args );
 foreach ($tax_menu_items as $cat) : ?>
 <li>
 <a href=" <?php echo get_term_link($cat,$cat->taxonomy); ?> ">
    <img src="<?php echo z_taxonomy_image_url($cat->term_id); ?>" alt="<?php echo $cat->cat_name; ?>"/>
 </a>
 </li>
 <?php endforeach; ?>
</ul> 
```

# python - 导入处理程序 - 使用 Flask 的应用程序路由

> ID：13770732
> 
> 赞同：0
> 
> 时间：2012-12-07T20:47:30.147
> 
> 标签：python, url-routing, flask

我的文件目录：

```
app/
app.py
app/server/
   views.py 
```

我没有收到任何视图导入错误，但我无法通过 URL 路由到视图 - 我只能从 app.py 执行此操作 - 我该如何解决这个问题？我已经坚持了6个小时。

app.py 中的代码 - 我如何导入视图

```
sys.path.append(os.path.join(os.path.abspath('.'), 'server'))
import views 
```

而且我的 url 路由似乎很好，所以我不确定问题出在哪里：

```
@app.route("/login/", methods=['GET', 'POST'])
def login():
    doSomething() 
```

* * *

我觉得这个问题更多地与 url 路由有关，而不是导入文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T21:26:15.100

尝试`from views import *`代替`import views`.

此外，不要执行.，而是`sys.path.append`添加一个名为服务器目录的空文件`__init__.py`，您应该可以执行类似`from server.views import *`.

**解决方案**：还要确保您的视图导入位于应用程序文件的底部，在应用程序初始化和配置等下方。

# python - python 中的 execfile() ，用于用户输入

> ID：13770735
> 
> 赞同：2
> 
> 时间：2012-12-07T20:47:41.390
> 
> 标签：python, python-2.7, execfile

我正在尝试从用户那里获取文件名，然后`execfile()`用来执行文件。下面是我的代码：

```
print "Please enter the name of the file"
filename = raw_input().split(".")[0]
module = __import__(filename)
execfile(module)             <-- this is where I want to execute the file 
```

我了解它的`execfile()`工作原理如下：

```
execfile("example.py") 
```

当文件名作为变量传递时，我不确定如何执行此操作。我正在使用python 2.7。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:59:21.200

删除导入并执行文件名。您需要使用此方法的 .py 扩展名，它将运行任何`if __name__ == '__main__'`部分：

```
filename = raw_input("Please enter the name of the file: ")
execfile(filename) 
```

如果您只想导入它，则需要剥离“.py”，它*不会*执行一个`if __name__ == '__main__'`部分：

```
filename = raw_input("Please enter the name of the file: ").split(".")[0]
module = __import__(filename) 
```

# c++ - OpenVMS 和大型机上的 C++ 开发

> ID：13770736
> 
> 赞同：-1
> 
> 时间：2012-12-07T20:47:46.310
> 
> 标签：c++, mainframe, openvms

在 OpenVMS 和 Mainframe 上开发 C++ 有什么特点？

我认为 OpenVMS 比大多数 UNIX 更 POSIX，而且大多数东西都可用，但似乎不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T17:31:36.880

它是一个被忽视的平台，但 z/OS UNIX ® 系统服务是 POSIX 标准以及其他几个标准的完整且健壮的实现。总的来说，它不是一个好的 X 平台，但与其他软件包相比，它具有竞争力和可扩展性。

Linux 也可以在 System z 上运行，但作为本机或来宾操作系统，而不是在 z/OS 下。

OpenVMS 与 UNIX 不兼容，需要对代码进行大量更改。您可能会发现此 HP 官方链接很有帮助： [http ://h71000.www7.hp.com/portability/](http://h71000.www7.hp.com/portability/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T06:13:36.720

IBM 大型机自 1996 年以来就符合 POSIX。OpenVMS，嗯，我不知道。

# php - 添加多个自定义标记/点

> ID：13770740
> 
> 赞同：1
> 
> 时间：2012-12-07T20:48:06.783
> 
> 标签：php, javascript, google-maps-api-3

我有以下代码，它工作正常，但我不知道如何添加更多标记/点。有人可以帮助我吗，在此先感谢！

```
 <?php
    // Get the JSON - THIS CODE WILL CONVERT CITY,STATE INTO LAT/LNG.
    $url='http://maps.googleapis.com/maps/api/geocode/json?address=Chicago+IL&sensor=false';
    $source = file_get_contents($url);
    $obj = json_decode($source);
    $LATITUDE = $obj->results[0]->geometry->location->lat;
    $LNG = $obj->results[0]->geometry->location->lng;
    echo ('LAT: ').$LATITUDE;
    echo ('<BR>LNG: ').$LNG;
    ?>
    <!DOCTYPE html>
    <html>
    <head>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">

    function load(){

var point = new google.maps.LatLng(<?php echo ($LATITUDE); ?>, <?php echo ($LNG); ?>);

      var myMapOptions = {
        zoom: 4,
        center: point,
        mapTypeId: google.maps.MapTypeId.TERRAIN
      };

      var map = new google.maps.Map(document.getElementById("map"),myMapOptions);

      var image = new google.maps.MarkerImage(
        'marker-images/image.png',
        new google.maps.Size(40,35),
        new google.maps.Point(0,0),
        new google.maps.Point(20,35)
      );

      var shadow = new google.maps.MarkerImage(
        'marker-images/shadow.png',
        new google.maps.Size(62,35),
        new google.maps.Point(0,0),
        new google.maps.Point(20,35)
      );

      var shape = {
        coord: [27,0,30,1,32,2,34,3,35,4,36,5,38,6,39,7,39,8,39,9,39,10,38,11,37,12,33,13,34,14,34,15,33,16,32,17,31,18,27,19,28,20,28,21,27,22,26,23,22,25,23,26,24,27,24,28,24,29,24,30,24,31,24,32,23,33,22,34,17,34,16,33,15,32,15,31,14,30,14,29,15,28,15,27,16,26,17,25,13,23,12,22,11,21,11,20,12,19,8,18,7,17,6,16,5,15,5,14,6,13,2,12,1,11,0,10,0,9,0,8,0,7,1,6,3,5,4,4,5,3,7,2,9,1,12,0,27,0],
        type: 'poly'
      };

      var marker = new google.maps.Marker({
        draggable: true,
        raiseOnDrag: false,
        icon: image,
        shadow: shadow,
        shape: shape,
        map: map,
        position: point
      });

    }

    </script>
    </head>
    <body onload="load()">
    <div id="map" style="width:900px;height:500px;margin:40px auto;"></div>

    </body>
    </html> 
```

更新：这是我也尝试过的（借助：hansvedo）：

```
<?php
// Get the JSON 
$url='http://maps.googleapis.com/maps/api/geocode/json?address=Chicago+IL&sensor=false';
$source = file_get_contents($url);
$obj = json_decode($source);
$LATITUDE = $obj->results[0]->geometry->location->lat;
$LNG = $obj->results[0]->geometry->location->lng;

$url2='http://maps.googleapis.com/maps/api/geocode/json?address=Akron+OH&sensor=false';
$source2 = file_get_contents($url2);
$obj2 = json_decode($source2);
$LATITUDE2 = $obj2->results[0]->geometry->location->lat;
$LNG2 = $obj2->results[0]->geometry->location->lng;

echo ('LAT: ').$LATITUDE;
echo ('<BR>LNG: ').$LNG;
echo ('<BR><BR>');
echo ('LAT: ').$LATITUDE2;
echo ('<BR>LNG: ').$LNG2;
?>
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">

function load(){

var point = new google.maps.LatLng('LATITUDE', 'LNG');
var point2 = new google.maps.LatLng('LATITUDE2', 'LNG2');

  var myMapOptions = {
    zoom: 5,
    center: point,
    mapTypeId: google.maps.MapTypeId.TERRAIN
  };

  var map = new google.maps.Map(document.getElementById("map"),myMapOptions);

  var image = new google.maps.MarkerImage(
    'marker-images/image.png',
    new google.maps.Size(40,35),
    new google.maps.Point(0,0),
    new google.maps.Point(20,35)
  );

  var shadow = new google.maps.MarkerImage(
    'marker-images/shadow.png',
    new google.maps.Size(62,35),
    new google.maps.Point(0,0),
    new google.maps.Point(20,35)
  );

  var shape = {
    coord: [27,0,30,1,32,2,34,3,35,4,36,5,38,6,39,7,39,8,39,9,39,10,38,11,37,12,33,13,34,14,34,15,33,16,32,17,31,18,27,19,28,20,28,21,27,22,26,23,22,25,23,26,24,27,24,28,24,29,24,30,24,31,24,32,23,33,22,34,17,34,16,33,15,32,15,31,14,30,14,29,15,28,15,27,16,26,17,25,13,23,12,22,11,21,11,20,12,19,8,18,7,17,6,16,5,15,5,14,6,13,2,12,1,11,0,10,0,9,0,8,0,7,1,6,3,5,4,4,5,3,7,2,9,1,12,0,27,0],
    type: 'poly'
  };

//  var marker = new google.maps.Marker({
//    draggable: true,
//    raiseOnDrag: false,
//    icon: image,
//    shadow: shadow,
//    shape: shape,
//    map: map,
//    position: point
//  });

var marker = new google.maps.Marker({ draggable: true, raiseOnDrag: false, icon: image, shadow: shadow, shape: shape, map: map, position: point });
var marker2 = new google.maps.Marker({ draggable: true, raiseOnDrag: false, icon: image, shadow: shadow, shape: shape, map: map, position: point2 });

}

</script>
</head>
<body onload="load()">
<div id="map" style="width:900px;height:500px;margin:40px auto;"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:08:44.107

只需复制点和标记，并相应地递增即可。

var point = new google.maps.LatLng('php echo($LATITUDE);', 'php echo($LNG);');

var **point2** = new google.maps.LatLng(' **echo($LATITUDE2);** ', ' **echo($LNG2);** ');

var marker = new google.maps.Marker({ draggable: true, raiseOnDrag: false, icon: image, shadow: shadow, shape: shape, map: map, position: point });

var **marker2** = new google.maps.Marker({ draggable: true, raiseOnDrag: false, icon: image, shadow: shadow, shape: shape, map: map, position: **point2** });

# jquery - 使用不同的锚重新加载页面

> ID：13770741
> 
> 赞同：5
> 
> 时间：2012-12-07T20:48:10.413
> 
> 标签：jquery, hash, tabs, anchor, reload

只是被一个问题困住了。我有一个带有 Jquery UI 选项卡的页面。通过向链接添加哈希标记，可以从不同的页面访问每个选项卡，并使用我需要的选项卡加载页面。但是，我还需要访问同一页面中的不同选项卡。我想出的是将**target="_parent"**添加到带有哈希标签的链接中：

```
<a href="pictures.htm#tab2" target="_parent"> 
```

它可以满足我的需要，但仅在 IE 中。它使用不同的哈希标签重新加载页面，但由于某种原因，Chrome 和 Firefox 每次都加载相同的选项卡。我需要为**链接创建一个 javascript 函数，该函数将完全重新加载具有不同哈希标记的页面**。

我想出了这段代码：

```
function gototab(reload)
   {
    window.location.href = 'pictures.htm#tab2';
    window.location.reload(true);
   }

<a href="pictures.htm#tab2" onclick="gototab();">open tab 2</a> 
```

我觉得我几乎要关闭它，但我的脚本有问题。有人可以帮我解决吗？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-07T20:58:00.033

你可以这样做：

```
function gototab(reload)
   {
    window.location.hash = '#tab2';
    window.location.reload(true);
   }

<a href="pictures.htm#tab2" onclick="gototab();">open tab 2</a> 
```

# .net - 当事件对其他 .NET 语言可见时，互操作 DLL 不显示事件

> ID：13770747
> 
> 赞同：1
> 
> 时间：2012-12-07T20:48:32.460
> 
> 标签：.net, f#

我已经生成了一个互操作 DLL。工作正常。奇怪的是，在 C# 中可见的事件在 F# 中不可见。幸运的是，DLL 中存在添加/删除函数来添加/删除我的处理程序。所以有一个解决方法。

我不明白为什么我不能看到实际的事件参数本身，因为它们是界面的一部分。在生成用于 F# 的互操作时，有什么特别需要做的吗？就好像事件的访问修饰符在 F# 中查看时是私有的或受保护的，但在 C# 中不是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T11:12:06.973

Possibly you are using the Client profile, switch to the full .Net 4.0 profile in project properties and try that. In VS2010 thats the default setting and it catches a lot of people out.

Another possibility is that it is a non standard event implementation, I encountered that in MonoTouch yesterday.

Failing those I would have a look at the dll with reflector or similar and see whats what with the generated code.

# c# - 如何正确使用世界矩阵转换 Vector3s？

> ID：13770750
> 
> 赞同：1
> 
> 时间：2012-12-07T20:48:46.860
> 
> 标签：c#, matrix, xna, collision-detection

我认为这很简单：

```
 Vector3 point = Vector3.Transform(originalPoint, worldMatrix); 
```

但显然不是......这使得这一点的数字飙升至数千。

基本上，我想做的是创建一个碰撞系统，这个系统中的每两个点都是一条线，所以基本上我想碰撞线。我希望线条能够基于世界矩阵进行缩放、旋转和平移（以便碰撞线与对象的缩放、旋转和平移保持一致）。

我已经尝试了几个小时，但我似乎无法弄清楚。我也尝试过乘以 View Matrix，虽然这最接近我想要的，但它似乎在两组数字之间切换！如果它保持在一组就完美了，我不知道为什么它一直在变化......

请问有什么帮助吗？:(

编辑：补充一点，我不断更新更新调用中的点。但我不知道这是否会改变任何事情，无论哪种方式，点=原始点。

Steve H：一条线有两点，所以：

```
originalPoint[0] = new Vector3(-42.5f, 0f, 0f);
originalPoint[1] = new Vector3(42.5f, 0f, 0f);
point[0] = Vector3.Transform(originalPoint[0], worldMatrix);
point[1] = Vector3.Transform(originalPoint[1], worldMatrix);` 
```

起初，`point[0] & [1]`等于`originalPoint[0] & [1]`。但是，当我移动我的播放器时，哪怕只是几个像素......

```
point[0] = (-5782.5f, 0f, 0f)
point[1] = (-5697.5, 0f, 0f) 
```

玩家的位置是`-56.0f`。

我`worldMatrix`的做法是：

```
_world = Matrix.Identity // ISROT
       * Matrix.CreateScale(_scale) // This object's scale
       * Matrix.CreateFromQuaternion(_rotation) // It's rotation
       * Matrix.CreateTranslation(_offset) // The offset from the centre
       * Matrix.CreateFromQuaternion(_orbitRotation) // It's orbit around an object
       * _orbitObjectWorld // The object to base this world from
       * Matrix.CreateTranslation(_position); // This object's position 
```

对象在图形中正确显示。它们完全可以缩放、旋转、平移。它们也遵循轨道的比例、旋转和平移，但我还没有对轨道进行太多测试。

我希望这是足够的细节......

编辑：经过进一步研究，原点也正在改变......：| 我不明白为什么会这样。它们与新点完全相同...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T16:41:07.033

我发现了我的问题... -_-

因此，在创建线点之后，我会在最后执行此操作：

```
originalLines = collisionLines; 
```

`collisionLines`&`originalLines`都是`Vector3[]`数组。

我想只要使一个相等，就好像它们完全相同，而改变一个会改变另一个……那是我不知道的。

所以我做了这个功能：

```
void CreateOriginalPoints()
{
    _originalPoints = new Vector3[_collisionPoints.Length];

    for (int i = 0; i < _collisionPoints.Length; i++)
        _originalPoints[i] = _collisionPoints[i];
} 
```

这完全解决了问题。现在我完全明白为什么这个问题会首先发生。

非常感谢 Donnie 和 Steve H。我知道你们两个没有回答我的问题，但这让我更深入地探索，直到找到答案。

# css - 如果分号后跟右大括号，是否在最后一个分号后出现空声明？

> ID：13770761
> 
> 赞同：5
> 
> 时间：2012-12-07T20:49:21.980
> 
> 标签：css

让我们看一下这个 CSS 规则：

```
#foo { color: red; } 
```

如您所见，上述规则的声明块包含一个声明，即`color: red`. 但是，根据我对 CSS 标准的解释，上面的声明块还**包含第二个空声明**，它位于 chars`;`和`}`.

```
#foo { color: red; }
                  ^ --- an empty declaration is located here 
```

我在 Stack Overflow 上提出这个问题，以确定我的解释是否正确，即上述 CSS 规则中是否确实存在第二个空声明。

顺便说一句，我使用的是 CSS 2.1 标准，特别是[“Chapter 4: Syntax”](http://www.w3.org/TR/CSS2/syndata.html#syntax)，因为[“CSS Syntax”](http://www.w3.org/TR/css3-syntax)模块已经过时，使用起来不安全。

好的，让我解释一下。我的解释基于以下定义：

*   该标准规定，在声明块中，分号是出现**在**各个声明之间的**分隔符：**

     **> 声明块以左花括号 ({) 开始，并以匹配的右花括号 (}) 结束。在两者之间必须有零个或多个分号分隔 (;) 声明的列表。

    所以，根据上面的定义，分号只能出现**在**两个声明之间，即分号必须在声明之前和声明之后。** 
***   该标准将声明定义为：

    > 声明要么为空，要么由属性名称、后跟冒号 (:) 和属性值组成。

    上面的定义表明声明可以为空。不幸的是，该标准没有定义术语“空声明”，该术语也没有在标准的其他任何地方提及。** 

 **让我们回到这个例子：

```
#foo { color: red; } 
```

上述规则是有效的 CSS。通过应用分号的定义（从上面），此规则中的分号必须在前面和后面都有一个声明。但是，分号后面是右花括号（结束声明）。为了解释这个矛盾，我在 and 之间插入了一个空声明`;`，`}`并提供了这个定义：

> 空声明是在声明块中需要声明但未找到的位置中没有声明。

这种对标准的解释是否正确，声明块是否确实包含两个声明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:22:06.303

我同意你的观点，读物表明你的情况是一个空洞的声明。`;`实际上，在大多数情况下，您的参考页面在其示例中的结束大括号之前没有 final 。我认为您的定义很接近，但并没有完全触及“空”的想法。反而：

> 空声明是在需要声明的声明块中没有任何内容的声明。

或者，[鉴于此处的注释](http://www.w3.org/TR/CSS2/syndata.html#declaration)，这...

> 空声明是在需要声明的声明块中的内容不超过空格的声明。

Contra Jukka 关于“没有实际影响......没有影响”的评论***我倾向于认为会有一个非常轻微的影响***，因为它们是对这样一个代码块进行的额外解析（意识到，正如一些人似乎认为的那样）认为我在争论的时候不是，它没有功能效果）。该页面指出：

> 该规范将忽略定义为意味着用户代理解析非法部分（以便找到它的开始和结束），但在其他方面就像它不存在一样。

虽然空声明不是非法的，但我相信解析器需要执行一个额外的步骤来确定它是空的，然后才能意识到它位于声明块的末尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T21:03:02.600

是的，这在将分号定义为分隔符而不是语句（或声明或其他）的一部分的计算机语言中是正常的。没有其他可能的解释，这个问题没有实际影响，因为空洞的声明没有效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:13:48.167

乍一看，规范在这方面似乎略有不一致；尽管您引用了这些段落，[但形式语法](http://www.w3.org/TR/CSS2/grammar.html)将`declaration`产生式定义为`property ':' S* expr prio?`，它永远不会为空。但是，无论何时`declaration`出现在任何其他产生式中，它总是后面跟着`?`，将其标记为可选；换句话说，语法允许的任何地方`declaration`，它也允许[无]。

我们可以通过说出现在规范的英文散文中的术语“声明”指的是`declaration?`( `declaration`-or-[nothing]) 而不是`declaration`;来解决不一致的问题。但我认为主要的要点是这并不重要。规范以这样一种方式编写，即空声明确实没有任何效果。

（嘿，情况可能更糟。[标准 ML](http://en.wikipedia.org/wiki/Standard_ML)允许空声明，*并*允许在声明之间省略分号；因此可以将类似的东西`val a = 7 val b = 20`解析为任意多个空声明的序列，并混入两个非空声明。）**

# php - 使用PHP将XML文件上传到mysql

> ID：13770763
> 
> 赞同：0
> 
> 时间：2012-12-07T20:49:27.987
> 
> 标签：php, mysql, sql, xml

* * *

这是我最新的代码，它没有向数据库发送任何值，但没有报告任何错误。

```
 foreach($library->time_report as $project){
            mysql_query("INSERT INTO instancetable (project_ID,          project_status, client_ID, project_start_time, project_end_time, project_total_time, employee_ID, employee_name, date_created, date_modified, created_by, client_name, priority, organization, number_of_required_types) 
            VALUES ('{$project->project_ID}',{$project->project_status}, '{$project->client_ID}', {$project->project_start_time}, '{$project->project_end_time}', '{$project->project_total_time}','{$project->employee_ID}', {$project->employee_name}, {$project->date_created}, {$project->date_modified}, {$project->created_by}, {$project->client_name}, {$project->priority}, {$project->organization}, {$project->number_of_required_types}"); 
```

}

我需要将一个 XML 文件上传到 mysql 中。它说它正在成功上传，但它只是在表中放置了一个值 0。这是我的代码：

```
<?php

     echo "starting <br><br>";
     //mysql connection
$con2 = mysql_connect("localhost","test","test");
if (!$con2)  {  die('Could not connect: ' . mysql_error());  }
$selectdb = mysql_select_db("test", $con2);
if (!$selectdb)  { die('Database not used: ; ' . mysql_error());  }

echo "connected to DB<br/><br/>";

 //simplexml load xml file   
$library =  simplexml_load_file('http://localhost/instance.xml');

echo "xml loaded<br/><br/>";

//loop through parsed xmlfeed and print output      

foreach ($library->message as $message) {                  
printf("project_ID: %s\n", $project_ID->project_ID);                  
}

echo "xml parsed<br/><br/>";

//insert into databse                     
mysql_query("INSERT INTO instancetable (project_ID)
VALUES ('project_ID')")
or die(mysql_error());

echo "inserted into mysql<br/><br/>";

//show updated records            
printf ("Records inserted: %d\n", mysql_affected_rows());  

//close connection 
mysql_close($con2);
echo " <br /> Finished "
?> 
```

所以这是我得到的输出：

```
starting 

connected to DB

xml loaded

xml parsed

inserted into mysql

Records inserted: 1 
Finished 
```

XML 文件：

```
 <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<project>
<time_report>
    <project_ID>4</project_ID>
    <project_status>Closed</project_status>
    <client_ID>6001</client_ID>
    <time_record>
        <project_start_time>13:03:19.000</project_start_time>
        <project_end_time>13:14:26.000</project_end_time>
        <project_total_time>0.0104166666666667</project_total_time>
    </time_record>
    <employee_ID>10001</employee_ID>
    <employee_name>Mary Beth</employee_name>
    <date_created>2009-07-02</date_created>
    <date_modified>2009-11-24</date_modified>
    <created_by>Mary Beth</created_by>
    <client_name>BlackRock Funds</client_name>
    <priority/>
    <organization/>
    <number_of_required_types>9999999999</number_of_required_types>
</time_report> 
```

XML 文件如上所示，它要大得多，所以我只取出了一个条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:56:00.223

我不知道您是否只想在该文件中插入最后一个 project_ID 或全部。试试这个在你的 XML 文件中插入每个 project_ID。

试试这个：

```
foreach ($library->message as $message) { 
    mysql_query("INSERT INTO instancetable (project_ID) VALUES ('" . $message->time_report->project_ID . "')");
} 
```

请注意，所有 mysql_* 函数都被标记为已弃用。您应该了解[PDO](http://php.net/manual/de/book.pdo.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:18:25.243

$project_ID 未设置。foreach 循环可能会运行，但由于 $project_ID 未定义，它不会输出任何内容。

如果要插入和打印每个项目 ID，则需要在 foreach 循环中插入查询。

```
foreach($library->time_report as $project){
  mysql_query("INSERT INTO instancetable (project_ID) 
    VALUES ('{$project->project_ID}')");

  printf("project_ID: %s\n", $project->project_ID);
} 
```

请注意，project_ID 在此处作为字符串插入。如果数据库字段是整数，则应删除`$project->project_ID`.

# python - “NoneType”对象没有“匹配”属性

> ID：13770765
> 
> 赞同：0
> 
> 时间：2012-12-07T20:49:37.253
> 
> 标签：python, regex, django, validation

我正在使用 re 库通过正则表达式验证电话号码，并且我之前在其他项目上使用过相同的确切代码，它运行良好，但现在我得到了

**“NoneType”对象没有“匹配”属性**

模型.py

```
from django.core.exceptions import ValidationError
import re

def validate_phone(value): #the validation regex here to be used in models later
    if re.match('^(010|011|012)[0-9]{8}',value) is None :
        raise ValidationError(u'%s is not a valid number' % value)
    if UserProfile.objects.filter(phone_number=value).count() > 1:
        raise ValidationError("Phone number already exists")

class UserProfile(User):
    #.... some other attributes
    mobile_number = models.CharField(validators=[validate_phone],null=True, blank=True, unique=True,max_length=16) 
```

当我尝试从管理员更改手机号码进行测试时，我收到此错误：

```
Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in wrapper
  366\.                 return self.admin_site.admin_view(view)(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/sites.py" in inner
  196\.             return view(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapper
  25\.             return bound_func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in bound_func
  21\.                 return func(self, *args2, **kwargs2)
File "/Library/Python/2.7/site-packages/django/db/transaction.py" in inner
  209\.                 return func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in change_view
  1035\.             if form.is_valid():
File "/Library/Python/2.7/site-packages/django/forms/forms.py" in is_valid
  124\.         return self.is_bound and not bool(self.errors)
File "/Library/Python/2.7/site-packages/django/forms/forms.py" in _get_errors
  115\.             self.full_clean()
File "/Library/Python/2.7/site-packages/django/forms/forms.py" in full_clean
  272\.         self._post_clean()
File "/Library/Python/2.7/site-packages/django/forms/models.py" in _post_clean
  326\.             self.instance.clean_fields(exclude=exclude)
File "/Library/Python/2.7/site-packages/django/db/models/base.py" in clean_fields
  844\.                 setattr(self, f.attname, f.clean(raw_value, self))
File "/Library/Python/2.7/site-packages/django/db/models/fields/__init__.py" in clean
  201\.         self.run_validators(value)
File "/Library/Python/2.7/site-packages/django/db/models/fields/__init__.py" in run_validators
  154\.                 v(value)
File "/Users/fadykamal/Work/Projects/Django/ShoghlanahProject/shoghlanah/models.py" in validate_phone
  23\.     if re.match('^(010|011|012)[0-9]{8}',value) is None :

Exception Type: AttributeError at /admin/shoghlanah/userprofile/2/
Exception Value: 'NoneType' object has no attribute 'match' 
```

# ios - NSMutableData 消失

> ID：13770770
> 
> 赞同：0
> 
> 时间：2012-12-07T20:49:57.287
> 
> 标签：ios, nsmutabledata

在我的程序中，我有一个 NSMutableData 变量，它从[http://www.nhara.org/scored_races-2013.htm](http://www.nhara.org/scored_races-2013.htm)收集信息。大约第三次从网站获取信息后，当它包含 90810 字节时，它要么消失，要么变为空，因为如果我将它打印为 NSString，它是空的。这是代码

```
- (void)viewWillAppear:(BOOL)animated
{
    // Create a new data container for the stuff that comes back from the service
    xmlData = [[NSMutableData alloc] initWithCapacity:180000];

    [self fetchEntries];
    [super viewWillAppear:animated];
}
- (void)fetchEntries
{
        // Construct a URL that will ask the service for what you want 
    NSURL *url = [NSURL URLWithString: @"http://www.nhara.org/scored_races-2013.htm"];//

    // Put that URL into an NSURLRequest
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Create a connection that will exchange this request for data from the URL 
    connection = [[NSURLConnection alloc] initWithRequest:req delegate:self startImmediately:YES];
}

- (void)connection:(NSURLConnection *)conn didReceiveData:(NSData *)data 
{
    // Add the incoming chunk of data to the container we are keeping 
    // The data always comes in the correct order 
    [xmlData appendData:data];

    NSLog(@"%@",xmlData);
    NSString *xmlCheck = [[[NSString alloc] initWithData:xmlData encoding:NSUTF8StringEncoding]autorelease];
    NSLog(@"xmlCheck = %@", xmlCheck);

}
-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"error= %@",error);
}

- (void)connectionDidFinishLoading:(NSURLConnection *)conn {

    // We are just checking to make sure we are getting the XML 
    NSString *xmlCheck = [[[NSString alloc] initWithData:xmlData encoding:NSUTF8StringEncoding] autorelease];
    NSLog(@"xmlCheck2 = %@", xmlCheck);

} 
```

最让我困惑的是，我的 NSMutableData 存储数据，但随后在声称具有相同字节数时丢失了数据。

NSMutableData 的大小是否有限制，或者我的问题只是内存管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:56:27.640

您需要为您的 xmlData 变量创建一个属性。在你之后的头文件中 `@interface MyClass`，像这样

```
@property (nonatomic, retain) NSMutableData * xmlData; 
```

如果您使用 ARC，则将其保留为强，如果您使用低于 ARC，则将其更改为强以保留。当你想使用你的变量时`self.xmlData`

# osx-mountain-lion - 如何在 Mountain Lion 上同时安装 MySQLdb 和 cx_Oracle？

> ID：13770774
> 
> 赞同：1
> 
> 时间：2012-12-07T20:50:23.103
> 
> 标签：osx-mountain-lion, mysql-python, cx-oracle

几天来，我一直在尝试让 MySQLdb 和 cx_Oracle 在 Mountain Lion 上成功运行，但无济于事。看来我只能让一个或另一个运行，但不能同时运行。这是我的规格...

运行（64 位）英特尔酷睿 i7 处理器的 Mac OS X 10.8.2

**Python** :
~: python --version
Python 2.7.2

~: file `which python`
/usr/bin/python: Mach-O Universal binary with 2 architectures
/usr/bin/python (for architecture i386): Mach-O executable i386
/usr/bin/python (for architecture x86_64): Mach-O 64 位可执行 x86_64

在 .bashrc 中，我设置了以下内容...
export VERSIONER_PYTHON_PREFER_32_BIT=yes

**MySQL** :
~: mysql --version
mysql Ver 14.14 Distrib 5.1.63, for apple-darwin10.3.0 (i386) using readline 5.1
~: file `which mysql`
/usr/local/mysql/bin/mysql: Mach-O 64-bit executable x86_64

**MySQLdb** :
~: 文件 /Library/Python/2.7/site-packages/_mysql.so
/Library/Python/2.7/site-packages/_mysql.so: Mach-O 64-bit bundle x86_64

**Oracle**：
版本 10.2.0.4（32 位）即时客户端和 SDK

我使用 pip 来安装 cx_Oracle 和 mysql-python (MySQLdb)。目前，我可以成功交互导入 cx_Oracle，但是，尝试交互导入 MySQLdb 时出现以下错误：

回溯（最后一次调用）：
文件“”，第 1 行，在
文件“/Library/Python/2.7/site-packages/MySQLdb/init .py”中，第 19 行，在 import _mysql **ImportError** : dlopen(/Library/Python /2.7/site-packages/_mysql.so, 2): 没有找到合适的图片。确实找到了： /Library/Python/2.7/site-packages/_mysql.so: mach-o，但是架构错误

在完成所有阅读和故障排除之后，我了解到当 Python 和 MySQL 不在同一架构上运行时，会出现此错误。由于我有 64 位版本的 MySQL，我可以删除我放入 .bashrc 的环境变量，该变量将首选项设置为 32 位版本的 Python（导出 VERSIONER_PYTHON_PREFER_32_BIT=yes）并且 MySQLdb 导入有效。但是，然后在导入 cx_Oracle 时出现以下错误：

Traceback（最近一次调用最后一次）：
文件“”，第 1 行，在
ImportError 中：dlopen（/Library/Python/2.7/site-packages/cx_Oracle.so，2）：找不到符号：_OCIAttrGet
引用自：/Library/Python /2.7/site-packages/cx_Oracle.so预期在： /Library/Python/2.7/site-packages/cx_Oracle.so
中的平面命名空间

在深入这个兔子洞时，我发现关于我为 cx_Oracle 设置的内容、需要 32 位架构以及需要 64 位跟踪一直到我的 Oracle 安装的信息相互矛盾。我遇到了segmentation fault错误，libclntsh.dylib错误和clang错误等。也许，在这一点上，信息过载让我在圈子里转了这么久，我看不清解决方案？但我知道必须有办法...

我提前感谢您在这方面的任何帮助。

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T11:06:18.440

你写了：

```
/usr/local/mysql/bin/mysql: Mach-O 64-bit executable x86_64 
```

您必须像安装 cx_Oracle 一样安装 MySql 32 位并保留

```
export VERSIONER_PYTHON_PREFER_32_BIT=yes 
```

# c++ - 根据#define 切换功能

> ID：13770778
> 
> 赞同：0
> 
> 时间：2012-12-07T20:51:03.810
> 
> 标签：c++, visual-studio-2010

我有一段代码在哪里发生这样的事情

```
 type<X> function( args<x> g)
     {
        ...
        function2();
        .....
     } 
```

现在 X 可以有两种类型，即 type1 和 type2。我想将函数编写为类型函数（args g）{ ...

```
 if X is of type1 then call function2();
        if X is of type2 then call function3();
        .....
     } 
```

我怎么能做到这一点。我正在用 C++ 编写并在 Visual Studio 中开发。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T20:59:11.160

您可以使用*模板特化*或*函数重载*。例如：

```
template <class X>
int foo(std::vector<X> a)
{
  foo1(); 
}

template <>
int foo<int>(std::vector<int> a)
{
  foo2(); 
} 
```

请注意，如果您只需要为少数类型专门化您的函数，最好使用函数重载。如果您有很多类似的代码，并且唯一的区别在于 1 个函数调用，则可能会使用`typeid`：

```
if (typeid(X) == typeid(type1)) {
  function2()
} else if (typeid(X) == typeid(type2)) {
  function3()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:00:08.243

注意：根据类型进行比较的代码通常表明设计不佳。

您可以使用一个具有不同签名的函数：

```
void my_function(const type_1& t1);
void my_function(const type_2& t2); 
```

让编译器根据参数类型选择函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:01:13.407

我假设 X 是一个类？您应该使用虚函数并创建 X 的派生版本。请参见下面的示例：

```
class X
{
public:
    virtual void myFunction(int input) { // do stuff here... }
};

class Y : public X
{
public:
    void myFunction(int input) { // do overridden stuff here... }
}; 
```

然后，如果您创建一个 X 类型的对象并在其上调用 myFunction()，那么它将运行“在这里做事”代码。如果您创建一个 Y 类型的对象并在其上调用 myFunction()，那么它将运行“在此处执行覆盖的内容”代码。但是您可以以多态方式使用您创建的任何对象，如下所示：

```
X *obj = NULL;

if (condition met)
{
    obj = new X();
}
else
{
    obj = new Y();
}

obj->myFunction(myInput); // will call either X or Y's myFunction() depending on what type it is 
```

# python - 如何将 django 模板提供给 javascript

> ID：13770781
> 
> 赞同：2
> 
> 时间：2012-12-07T20:51:24.893
> 
> 标签：python, django

我在服务器端使用 django，显然在客户端使用 javascript。现在我想在客户端使用[板块模板引擎](https://github.com/chrisdickinson/plate)。

向客户端提供 django 模板的最佳方式是什么？我们教了一些方法来做到这一点。

1.  创建一个提供原始模板的视图。
    *   可能不是最好的方法
2.  将所需的模板复制到静态文件夹。
    *   这可以通过自定义静态文件查找器来完成
    *   broser 能够缓存模板
3.  使用将原始模板放入 javascript 变量的模板标签提供模板。
    *   以这种方式收到的模板不能单独缓存

有一个 django 应用程序可以让这更容易吗？

我需要客户端上的模板的原因是，我想在服务器和客户端上使用相同的客户端。首次加载页面时，会在服务器上呈现完整的模板，在通过应用程序导航时，仅加载所需的数据，并使用推送状态完成页面更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:28:28.507

如果您需要能够拥有 A) 动态生成的板模板，或 B) 动态创建的板模板（例如，通过管理员输入数据库等），您将希望使用 1（不是一件坏事- django 是为提供文本内容而设计的，所以只要您需要以动态方式拥有它，就没有问题）。3 是一个不好的选择，因为这意味着浏览器无法缓存静态资源（如果它输出到每个页面中）......当然，除非您需要为每个页面使用不同的板模板。

如果您不需要上面的 A 或 B，我只需将模板粘贴在您的静态目录中，正如您所提到的（例如，`collectstatic`或者只是将它们添加到您的存储库中，如果它们是您的应用程序的一部分）。

关于使这变得简单的应用程序-您可以查看 Django Chunks（将静态块输出到页面中的某个位置，例如 `{% chunk "header-snippet" %}），但我认为您不需要那个。

# java - JavaPNS 错误处理 - 文档中的矛盾？

> ID：13770785
> 
> 赞同：0
> 
> 时间：2012-12-07T20:51:34.800
> 
> 标签：java, push-notification, apple-push-notifications

在 JavaPNS 文档中，我看到了这个：

> 要确定推送是否成功发送到 Apple 并且 Apple 没有返回任何错误响应数据包，只需调用 pushNotification.isSuccessful() 方法。**如果发生以下任何一种情况，通知可能不会成功**：
> 
> *   由于明显的规范违规，图书馆拒绝了您提供的令牌（例如：令牌不是 64 字节长等）
> *   库拒绝了您提供的有效负载，因为明显违反规范（例如：有效负载太大等）
> *   发生连接错误，库无法与 Apple 服务器通信
> *   您的证书或密钥库发生错误（例如：密码错误、密钥库格式无效等）
> *   **从 Apple 服务器接收到有效的错误响应数据包**
> 
> **以及许多其他可能的错误...**

但是提供的代码片段确实如此

```
for (PushedNotification notification : notifications) {
    if (notification.isSuccessful()) {
        /* Apple accepted the notification and should deliver it */  
        System.out.println("Push notification sent successfully to: " + notification.getDevice().getToken());
    /* Still need to query the Feedback Service regularly */  
    } else {
        String invalidToken = notification.getDevice().getToken();
        /* Add code here to remove invalidToken from your database */  

        /* Find out more about what the problem was */  
        Exception theProblem = notification.getException();
        theProblem.printStackTrace();

        /* If the problem was an error-response packet returned by Apple, get it */  
        ResponsePacket theErrorResponse = notification.getResponse();
        if (theErrorResponse != null) {
            System.out.println(theErrorResponse.getMessage());
        }
     }
 } 
```

这似乎暗示 isSuccess() == false 意味着不可恢复的错误，并且设备令牌无效。

但是，可能的原因列表确实表明 isSUccess() 可能是错误的，因为返回了合法的错误数据包。我不知道，但我想如果 Apple 由于运营商问题未能发送通知，可能会被退回，例如，这意味着令牌不一定无效。

那么，isSuccess() == false 在发送消息时是一个不可恢复的错误，但不是需要异常的错误，例如密钥库失败或根本无法连接到服务器？

换句话说 - id isSuccessful() == false，我真的应该按照建议从我的数据库中删除设备令牌吗？片段说是的，但在我看来，文档似乎另有建议......

链接：[http ://code.google.com/p/javapns/wiki/ManagingPushErrors](http://code.google.com/p/javapns/wiki/ManagingPushErrors)

提前感谢任何勇敢地提出这个冗长而漫无边际的问题的人。

-- 浮潜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:57:48.177

文档说您是正确的。从技术上讲，这意味着推送失败，但并不是因为异常而失败。它可能由于合法的失败而失败。（我定义为我们成功连接的合法失败，消息没有明显缺陷，但服务器拒绝接受。）关键行如下：

IE`To find out if a push was successfully sent to Apple and that Apple did not return any error-response packet, simply invoke the pushedNotification.isSuccessful() method.`

不过，您的整个问题似乎很迂回。简单来说，你的推送失败了。异常和失败之间的区别真的很重要吗？无论哪种方式，它都无法恢复，您需要检查日志以确切了解发生了什么。

# graph-theory - 车辆路径算法？

> ID：13770786
> 
> 赞同：1
> 
> 时间：2012-12-07T20:51:41.827
> 
> 标签：graph-theory

我有

*   一个仓库
*   一个运输车队，每辆最多可运载 10 吨
*   几个客户。

我怎样才能最大限度地增加运输车的负载并最大限度地减少旅行？

到目前为止，我使用 1d *bin-packing*对运输机进行分组，并使用*蚁群优化*来缩短行程，但感觉不对。我读过背包算法？我能做得更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-13T16:51:06.893

这是经典的车辆路径问题（[VRP](http://en.wikipedia.org/wiki/Vehicle_routing_problem)）。对于中小型实例，您可以通过制定（混合）整数问题并使用 MIP 求解器（例如 Gurobi）找到最佳解决方案。

应用启发式是很常见的。但是，它们不一定会产生最佳解决方案。该领域最重要的启发式算法是禁忌搜索、模拟退火和受生物学启发的各种算法。事实证明，这些启发式方法产生了相当好的解决方案，当涉及具有许多侧面约束的大规模问题时，它们是无可替代的。对于许多问题，它们甚至会产生最佳解决方案，但通常很难证明。

然而，理解和实现这些算法并不是一天的事情。

我实现了一个名为[jsprit](https://jsprit.github.io)的项目。jsprit 是一个轻量级的 java 工具包，可以解决您的问题，并让您分析生成的解决方案，例如通过可视化它们。它使用了一个大型邻域搜索，它结合了模拟退火和阈值接受（此处引用了应用的算法原理）。您将找到许多帮助您解决问题的示例。

一个简单的方法是在考虑车辆的固定成本的同时，尽量减少可变成本（无论您的成本衡量标准是什么，例如距离、时间、燃料或综合衡量标准）。我相信您最终会得到一个“最大限度地减少旅行”并适当利用您的运输工具的解决方案。如果您在设置问题时遇到问题，请随时直接与我联系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-12T00:08:17.360

你的问题可以用这个免费的软件来解决，用于解决 Java 中的 VRP [https://jsprit.github.io或 Lisp 中的](https://jsprit.github.io)[https://github.com/mck-/Open-VRP](https://github.com/mck-/Open-VRP)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:10:58.463

A* 搜索（修改为最大成本路径）与 Microsoft Research 论文中描述的最短路径算法的组合可能值得研究： [http ://research.microsoft.com/pubs/154937/soda05.pdf](http://research.microsoft.com/pubs/154937/soda05.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T09:20:06.707

我认为您的问题没有完美的解决方案。如果我做对了，你的问题就是帕累托最优。您可以优化您的路线或负载或您需要的车队数量（侧面限制日常工作时间可能也是一个问题）。您必须重视自己更重要的事情，例如由于燃料成本而缩短的路线，更少的汽车等等。

在我看来，您应该对您的客户进行地理分区，每个分区的负载总和不大于 10 吨。之后，您可以在那个小问题上使用 TSP 来计算出完美的路线。主要的“魔法”是在分区步骤中完成的，如果你以一种好的方式解决了这个问题，你的问题可能会消失。

希望有帮助

# asp.net - 使用树节点使当前选择不再可选择

> ID：13770789
> 
> 赞同：1
> 
> 时间：2012-12-07T20:51:51.317
> 
> 标签：asp.net, vb.net, attributes, treeview, treenode

我有一个作为树视图的菜单，我想做的是使用户选择的任何树节点都不能再次选择，除非他转到不同的页面。我将如何在 asp.net 和 vb 中执行此操作？

更新：

好的，到目前为止，这就是我在树节点选择中所做的更改子

```
 ViewState(10) = TreeView1.SelectedNode

    TreeView1.SelectedNode.SelectAction = TreeNodeSelectAction.None

    If ViewState(10).valuepath <> TreeView1.SelectedNode.ValuePath Then
        TreeView1.SelectedNode.SelectAction = TreeNodeSelectAction.Select
    End If 
```

我确信那里的专家确切地知道为什么这不起作用，尽管我很惊讶它遵守了。无论如何，这给了我一个错误，尽管我想不出另一种方法来保留该选定节点

更新：

```
 ViewState(10) = TreeView1.SelectedNode.DataItem

    If ViewState(10) <> TreeView1.SelectedNode.DataItem Then
        TreeView1.SelectedNode.Selected = ViewState(10)
        TreeView1.SelectedNode.SelectAction = TreeNodeSelectAction.Select
    Else
        TreeView1.SelectedNode.SelectAction = TreeNodeSelectAction.None
    End If 
```

这适用于 selectaction.none 这正是我想要的，但是当用户选择另一个树节点时我无法再次启用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T23:19:31.153

这是将来需要此功能的任何人的答案

```
For Each n As TreeNode In TreeView1.Nodes
        For Each a As TreeNode In n.ChildNodes
            If a.Selected = True Then
                a.SelectAction = TreeNodeSelectAction.None
            Else
                a.SelectAction = TreeNodeSelectAction.Select
            End If
        Next
    Next 
```

# java - 使用 UTF-8 的 DataEditorSupport 和/或 ClonableEditor

> ID：13770790
> 
> 赞同：2
> 
> 时间：2012-12-07T20:51:53.767
> 
> 标签：java, netbeans-platform, netbeans-7.1

我有一个使用自定义 DataEditorSupport 和自定义 ClonableEditor 的 Netbeans 平台程序。它读取的文件是 UTF-8 编码的，并且创建的编辑器似乎没有使用 UTF-8。

例如我的文件有

```
"TêSt" 
```

并且编辑器将其显示为

```
"TÃªStÃ" 
```

如何让 DataEditorSupport 或 ClonableEditor 使用正确读取的 UTF-8？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T08:15:18.427

[NetBeans wiki 中的这个 FAQ 条目](http://wiki.netbeans.org/FaqI18nProjectEncoding)可能会有所帮助。另请参阅[通用查询 API](http://bits.netbeans.org/dev/javadoc/org-netbeans-modules-queries/index.html)，特别是[FileEncodingQuery](http://bits.netbeans.org/dev/javadoc/org-netbeans-modules-queries/org/netbeans/api/queries/FileEncodingQuery.html)。

# c# - 如何在运行游戏之前运行控制台应用程序？

> ID：13770791
> 
> 赞同：2
> 
> 时间：2012-12-07T20:51:55.763
> 
> 标签：c#, console

我想要做的是运行一个控制台应用程序，让用户输入一些细节，然后将用户输入传递给我的游戏。

我希望用户指定游戏的分辨率，以放入 PreferredBackBuffer。

这可能吗？我知道我可以编写一个设置文件并从中读取，但我宁愿把那部分删掉并直接执行。

这是我的“游戏”。我省略了 Player.cs，因为我认为为了我的问题不必展示。

主文件

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.IO;
using System.Text.RegularExpressions;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;  
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace SimplePlayer
{
    public class Main : Microsoft.Xna.Framework.Game
    {
    const string fileName = "AppSettings.dat";

    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;
    Texture2D spaceTexture;
    Player playerShip;

    public Main()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";

        ReadRes();
    }

    protected override void Initialize()
    {

        base.Initialize();
    }

    protected override void LoadContent()
    {
        // Create a new SpriteBatch, which can be used to draw textures.
        spriteBatch = new SpriteBatch(GraphicsDevice);
        spaceTexture = Content.Load<Texture2D>("spaceBackground");
        Texture2D playerTexture = Content.Load<Texture2D>("shipSprite");
        playerShip = new Player(GraphicsDevice, new Vector2(400, 300), playerTexture);

    }

    protected override void UnloadContent()
    {
    }

    protected override void Update(GameTime gameTime)
    {
        // Allows the game to exit
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
           this.Exit();

        playerShip.Update(gameTime);

        UpdateInput();

        base.Update(gameTime);
    }

    private void UpdateInput()
    {
        KeyboardState keyState = Keyboard.GetState();
        GamePadState gamePadState = GamePad.GetState(PlayerIndex.One);

        if (keyState.IsKeyDown(Keys.Up) || gamePadState.DPad.Up == ButtonState.Pressed)
        {
            playerShip.Accelerate();
        }

        if (keyState.IsKeyDown(Keys.Down) || gamePadState.DPad.Down == ButtonState.Pressed)
        {
            playerShip.MoveReverse();
        }

        if (keyState.IsKeyDown(Keys.Left) || gamePadState.DPad.Left == ButtonState.Pressed)
        {
            playerShip.StrafeLeft();
        }

        if (keyState.IsKeyDown(Keys.Right) || gamePadState.DPad.Right == ButtonState.Pressed)
        {
            playerShip.StrafeRight();
        }
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin();
        spriteBatch.Draw(spaceTexture, Vector2.Zero, Color.White);
        playerShip.Draw(spriteBatch);
        spriteBatch.End();

        base.Draw(gameTime);
    }

        public void SetWindowSize(int x, int y)
        {
        graphics.PreferredBackBufferWidth = x;
        graphics.PreferredBackBufferHeight = y;
        graphics.ApplyChanges();
        }
    }
} 
```

程序.cs

```
using System;

namespace SimplePlayer
{
#if WINDOWS
    static class Program
    {
        static void Main(string[] args)
        {
            using (Main game = new Main())
            {
                game.Run();
            }
        }
    }
#endif
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:53:34.453

您的游戏可执行文件实际上可能只是控制台应用程序的可执行文件。使用完成后输入他的首选项，您的控制台应用程序可以执行您的游戏，将首选项作为命令行参数传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:58:39.040

您可以执行以下操作以在代码中启动可执行文件：

```
const string ex1 = "C:\\";
const string ex2 = "C:\\SomeDirectory";

ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.CreateNoWindow = false;
startInfo.UseShellExecute = false;
startInfo.FileName = "YourGame.exe";
startInfo.WindowStyle = ProcessWindowStyle.Hidden;
startInfo.Arguments = "-f j -o \"" + ex1 + "\" -z 1.0 -s y " + ex2;

try
{
    // Start the process
    using (Process exeProcess = Process.Start(startInfo))
    {
    exeProcess.WaitForExit();
    }
}
catch
{
    // Log error.
} 
```

# ruby-on-rails - Rails - 许多其他人可以使用的一种模型？

> ID：13770795
> 
> 赞同：1
> 
> 时间：2012-12-07T20:52:18.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sqlite, ruby-on-rails-3.1, models

使用 SQLite 运行 Rails 3.2.8（来自 ruby​​onrails.org 上当前 dl 的基本设置）

如果我有几个模型我想要一个“notes”属性并且所有“notes”都是字符串，是否应该只有一个特定的 Note 模型，所有其他模型都引用 Note 模型？

或者

每个模型都必须有自己的“注释”属性吗？

如果是第一个响应，这是否意味着对于引用“注释”的每个关系，我是否需要创建另一个定义该`:through`关系的类？（即 tableOne、tableTwo 和 tableThree 都是参考笔记，那么我需要创建额外的类 tableOne_notes、tableTwo_notes 和 tableThree_notes）

多态解决方案是否适用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T22:01:10.493

如果您想要一个可以为许多其他模型提供相同目的的“笔记”模型，这将是一种多态关系。无论应用程序框架如何，这实际上都是正确的。

在此示例的多态关系的 rails 实现的特定情况下，您将添加一个

```
note_type 
```

注释模型/表和注释模型中的列，使用数据库迁移加上：

```
belongs_to :notable, :polymorphic => true 
```

在`Note`然后

```
has_many notes, :as => notable` 
```

在需要注释的其他模型中。

有关更多信息，请参见[http://guides.rubyonrails.org/association_basics.html#polymorphic-associations](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)。

多态关系的常见用途：

*   笔记（如您所用）
*   更新信息（时间戳、IP 地址、用户代理等）
*   属于简单键值查找的类别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:59:49.390

这取决于您的需求。但基本上可以创建一个模型`Notice`并`1-n`在`Notice`and`Other`和`Other2`...

据我了解，您的问题只有一个`1-n`或多个`1-n`关系才有意义。如果您在每个表中添加一列`notes`，则每个数据行只能是一个注释。另一个定义`:through`的类不是`1-n`关系所必需的。

# c# - 如何在 MVC4 中创建动态视图？

> ID：13770799
> 
> 赞同：-1
> 
> 时间：2012-12-07T20:52:53.567
> 
> 标签：c#, asp.net-mvc-4

我正在开发基于内容的网站，该网站将显示所有内容标题，并附上相同的链接。链接模式将是这样的

```
www.mydomain.com/category/nobel-award-2012    
www.mydomain.com/category/spain-win-the-world-cup-football 
```

这些 url 将动态生成，我想通过单个`view`&来处理这种情况`controller`。每当添加任何新内容时，都会自动生成一个新链接。

任何人都可以帮助我设计我的视图以及控制器。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:58:29.127

**从 MVC 2 版本开始，动态视图**的创建几乎具有相同的方法。

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<dynamic>" %> 
```

您可以轻松查看以下教程并获得一个想法：- [ASP.NET MVC 2 中的动态视图](http://www.gregshackles.com/2010/07/dynamic-views-in-asp-net-mvc-2/)。

您可能还需要使用本文所述的**自定义 URL 路由**-[**了解 ASP.NET MVC 中的路由**](http://www.dotnetcurry.com/ShowArticle.aspx?ID=814)-

# json - 在 webgl 中加载 3d 模型

> ID：13770800
> 
> 赞同：0
> 
> 时间：2012-12-07T20:52:59.863
> 
> 标签：json, webgl, three.js

我有一个要在 webgl 中加载的 3DS 文件。我可以将其转换为 OBJ、JSON 或 JS 文件类型。我尝试了使用和不使用 THREE.js。我就是想不通，谁能教我如何让这个模型出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T22:34:55.713

如果您有当前的 THREE.js 和 Autodesk 的 FBX 转换器的当前版本，请尝试[Verold 的 FBX->JSON Converter for Three.js](http://verold.com/blog/2012/11/27/designing-the-fbx-converter-for-threejs)，它是 THREE 的 github 存储库的一部分。到目前为止，这似乎是将数据从 Max/Maya 获取到 THREE 的最佳、最完整的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T06:23:44.740

像这样的东西应该可以让 OBJ 进入场景，尽管你会想在某个时候添加一个素材。我正在为我当前的项目使用 max 并从 max 导出到 OBJ，然后加载到 three.js 中工作正常。

```
var objLoader = new THREE.OBJLoader();
objLoader.addEventListener('load', objLoaded);
objLoader.load(filepath);

function objLoaded (event) {
    scene.add(event.content);
} 
```

# vb.net - VB中获取进程所有者返回错误

> ID：13770801
> 
> 赞同：0
> 
> 时间：2012-12-07T20:53:01.253
> 
> 标签：vb.net, process

我在这个网站上找到了一些代码，这些代码在大多数情况下似乎都很好用。

这是代码：

```
 Private Function GetProcessOwner(processId As Integer) As String
    Try
        Dim query = "Select * From Win32_Process Where ProcessID = " & processId
        Dim searcher = New ManagementObjectSearcher(query)
        Dim processList = searcher.Get()
        For Each obj As ManagementObject In processList
            Dim argList As String() = {String.Empty, String.Empty}
            Dim returnVal = Convert.ToInt32(obj.InvokeMethod("GetOwner", argList))
            If returnVal = 0 Then
                Return argList(1) & "\" & argList(0)
            End If
        Next
    Catch ex As Exception
    End Try

    Return ""
End Function 
```

但是，有时我会得到这个：

```
RuntimeCallableWrapper avec l'erreur suivante : Un appel sortant ne peut pas être effectué étant donné que l’application répartit un appel entrant synchrone. (Exception de HRESULT : 0x8001010D (RPC_E_CANTCALLOUT_ININPUTSYNCCALL)). Cela se produit habituellement car le contexte COM 0x78e910 dans lequel ce RuntimeCallableWrapper a été créé a été déconnecté ou est occupé à autre chose et ne peut pas traiter la transition des contextes. Aucun proxy ne sera utilisé pour traiter la demande sur le composant COM. Cela peut entraîner des dysfonctionnements ou des pertes de données. Pour éviter ce problème, assurez-vous que tous les contextes/cloisonnements/threads COM restent actifs et sont disponibles pour la transition des contextes, tant que l'application n'en a pas terminé avec les RuntimeCallableWrappers qui représentent les composants COM qui s'y trouvent. 
```

它是法语的，但我不能用我自己的语言真正理解它，所以我不能真正翻译。谁能告诉我我做错了什么以及如何纠正它？

我发现还有另一种获取流程所有者的方法 (http://www.codeproject.com/Articles/14828/How-To-Get-Process-Owner-ID-and-Current-User-SID) ，但它在c#，整个项目都是在VB中。另外，当我复制代码时，我在 HANDLE 一词上出现编译错误。我不介意使用这段代码，但我无法让它工作

有谁能够帮我 ？

关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:34:59.800

1.  [translate.google.com](http://translate.google.com/)是您的朋友。
2.  从翻译来看，您可能有一个出色的先前调用。
3.  由于 ManagementObjectSearcher 实现了 IDisposable，我将使用如下所示的 Using 块创建（并处置）它：

    使用搜索器作为新的 ManagementObjectSearcher(query) [...] 结束使用

这将确保**searcher**被正确处理，因为它引用了非托管资源。（有以前的**搜索者**可能是您的问题的原因。）

# ruby-on-rails - Rails 单元测试 - 找出断言失败的确切原因

> ID：13770805
> 
> 赞同：0
> 
> 时间：2012-12-07T20:53:19.183
> 
> 标签：ruby-on-rails, unit-testing, assertion

我编写了一个断言失败的单元测试——我想找出原因，而不必检查模型的每个属性。

## 这是我的测试：

```
test "a correct document should be saved" do
  document = documents(:one)
  document.pdf = File.new("test/files/document_test_file.pdf")
  assert document.save
end 
```

## 这是夹具：

```
one:
  user_id: 1
  title: MyString
  published_on: 2012-12-06
  tags: MyText
  language: MyString 
```

显然，缺少某些内容并且无法保存文档。但是我如何找出究竟缺少什么？是否有任何高级断言方法可以做到这一点？

## 我的模型：

```
class Document < ActiveRecord::Base
  attr_accessible :language, :pdf, :pdf_file_name, :published_on, :tags, :title, :user_id

  # Validations
  validates_presence_of :language, :published_on, :tags, :title, :user
  validates_date :published_on, on_or_before: Date.current,
                                on_or_before_message: "must be today or earlier"
  validates :user_id, numericality: { only_integer: true, greater_than: 0 }
  validates :pdf, attachment_presence: true

  # Relations
  belongs_to :user

  # Paperclip
  has_attached_file :pdf
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T20:59:07.667

找出`save`失败原因的一种简单方法是调用`save!`。例外将为您提供足够的信息。

另一种方法是先跟`valid?`注，然后再看跌`errors`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T20:58:45.623

怎么样：

```
assert document.save, document.errors.full_messages.join(" ") 
```

# vb.net - 无法在 VisualBasic 中调用 WMP 的 controls.play() 函数

> ID：13770806
> 
> 赞同：5
> 
> 时间：2012-12-07T20:53:23.393
> 
> 标签：vb.net, windows-media-player, wmp

我有以下代码：[http://pastebin.com/EgjbzqA2](http://pastebin.com/EgjbzqA2)基本上只是[http://www.dreamincode.net/forums/topic/57357-mymusic-player/](http://www.dreamincode.net/forums/topic/57357-mymusic-player/)的精简版。我希望程序重复播放一个文件，但是，由于某种原因，此功能不起作用。程序播放每个文件一次然后停止。

```
Private Sub Player3_PlayStateChange(ByVal NewState As Integer) Handles Player3.PlayStateChange
    Static Dim PlayAllowed As Boolean = True
    Select Case CType(NewState, WMPLib.WMPPlayState)
        Case WMPLib.WMPPlayState.wmppsReady
            If PlayAllowed Then
                Player3.controls.play()
            End If
        Case WMPLib.WMPPlayState.wmppsMediaEnded
            ' Start protection (without it next wouldn't play
           PlayAllowed = False
            ' Play track
           Player3.controls.play()
            ' End Protection
           PlayAllowed = True
            updatePlayer()
    End Select
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T22:55:48.040

PlayAllowed doo-wop 是 hackorama，当您要求它在事件中执行其他操作时，它可以解决控制变得暴躁的问题。这经常出错，他们不希望在触发事件时地板垫会被猛拉。技术术语是他们不能很好地处理重入，这是一个非常普遍的问题。

重入问题有一个非常优雅的解决方案，关键是您在事件引发*后**延迟*再次播放同一首歌曲的请求。在 Winforms 中，您可以通过使用 Control.BeginInvoke() 轻松获得这样的延迟，目标在一切恢复后运行。技术术语是“等待程序重新进入消息循环”。这在这段代码上效果很好，我在 Windows 8 上测试的这段代码一遍又一遍地循环播放同一首歌曲没有任何问题：

 *```
Public Class Form1
    Dim WithEvents Player3 As New WMPLib.WindowsMediaPlayer
    Dim Song As String = "c:\temp\ding.wav"

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        PlayCurrentSong()
    End Sub

    Private Sub Player3_PlayStateChange(ByVal NewState As Integer) Handles Player3.PlayStateChange
        If NewState = WMPLib.WMPPlayState.wmppsMediaEnded Then
            Me.BeginInvoke(New MethodInvoker(AddressOf PlayCurrentSong))
        End If
    End Sub

    Private Sub PlayCurrentSong()
        Player3.URL = Song
        Player3.controls.play()
    End Sub
End Class 
```

根据需要调整代码，因为它与您的不太匹配。基本部分是 PlayStateChanged 事件处理程序中的 Me.BeginInvoke() 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T00:39:38.743

我调查了这个，问题是你太努力了。你看，如果你分析封装的MP3播放器文件的内容，你会发现音障被转换为模拟文件而不是二进制数字。这个问题是当你说它只分配给“WMP”时视频音频播放。如果您切换操作系统，它可能会起作用，但我会继续购买一台新电脑，然后再使用它。谢谢和 :)*

# c# - 如何以编程方式在 Active Directory LDS (ADAM) 中检查用户密码何时过期？

> ID：13770808
> 
> 赞同：1
> 
> 时间：2012-12-07T20:53:25.483
> 
> 标签：c#, asp.net, asp.net-mvc, active-directory

有没有办法在 Active Directory 轻量级目录服务实例中检查用户密码是否已过期？具体来说，是否有一个属性（希望是 a `boolean`）定义密码是否过期，考虑到用户的密码是否已过期，以及用户的密码是否设置为过期（在这种情况下它应该总是返回`false`）。

我们正在尝试使用 DirectoryEntry API 和 PrincipalContext API 在 Active Directory 中查询此信息，但无法确定它的存储位置。仅仅查询`pwdLastSet`是不够的，因为我们无法访问域的到期期限，并且我们希望能够支持就地密码策略。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T14:01:08.427

检查[`userAccountControl`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680832%28v=vs.85%29.aspx)属性。

# c# - 试图用 C# 围绕工作单元模式展开思考

> ID：13770811
> 
> 赞同：0
> 
> 时间：2012-12-07T20:53:34.233
> 
> 标签：c#, unit-of-work

我正在尝试创建一个基本的工作单元来充分理解这些原则。我可以稍后重新考虑。我只是想让它工作。我遇到了一些麻烦。

我有一个简单的实体代码：

```
public class Code
{
    public int Id { get; set; }
    public string Type { get; set; }
    public string Value { get; set; }
    public string Description { get; set; } 
} 
```

我有一个带有一个简单方法的 CodeRepository。

```
public class CodeRepository
    {
        public Code GetByCode(string value)
        {
            // Go to DB and find code. Just using a sample.
            var code = new Code();
            code.Type = "Dx";
            code.Value = "20";
            return code;
        }
    } 
```

我有一个简单的 UnitOfWork 类：

```
public class UnitOfWork
{
    private CodeRepository _codeRepository;
    public CodeRepository CodeRepository
    {
        get
        {
            if (_codeRepository == null)
                _codeRepository = new CodeRepository();
            return _codeRepository;
        }
    }

    public void Commit()
    {

    }

    public void Rollback()
    {

    }
} 
```

如果我想使用 UnitOfWork 调用我的存储库并按名称获取代码，我会这样做：

```
var uow = new UnitOfWork();
var code = uow.CodeRepository.GetByCode("x"); 
```

创建的连接在哪里使用？我不确定下一步我需要去哪里。还得使用ADO.NET。

**更新** 下面的许多人说应该在存储库中打开连接。例如，如果我需要在 3 个单独的存储库中调用 3 个不同的 GetBy 方法来获取视图的值，我是否想每次都打开一个新连接？或者，我可以打开一个连接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T20:57:23.727

在这种情况下，您可以在`GetByCode`方法本身中创建连接。您可能会使其延迟加载并且在实际引用其数据之前不加载，但这可能会使事情复杂化，除非它是必需的

但是，这是一种`Get`方法的简单答案。当涉及到持久化任何更改时，这一切都将在内存中完成，并且连接将发生在 Commit 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T20:59:23.933

您正在使用的存储库正在抽象您的所有数据访问权限。因此，在 UoW 类中，您不关心连接，您只需获取一个存储库（理想情况下注入到构造函数中）并使用它。另一方面，存储库将使用您首选的数据访问方法处理与 db 的连接。希望这是有道理的...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:01:23.517

我将在您实际从数据库中检索它的最后一点创建、打开、使用和关闭连接，因此在`GetByCode`

```
public Code GetByCode(string value)
{
    // Go to DB and find code. Just using a sample.
    // assuming SqlConnection, store the connection-string f.e. in the settings
    string sql = "SELECT Columns FROM dbo.Table Where Value=@Value";
    using(var con = new SqlConmection(connectionString))
    using(var cmd = new SqlCommand(sql, con))
    {
        cmd.Parameters.AddWithValue("@Value", value);
        con.open();
        using(var reader = cmd.ExecuteReader())
        {
            while (reader.Read())
            {
                Code code = new Code();
                // initiliaze it from the reader, f.e.
                code.Id = reader.GetInt32(reader.GetOrdinal("Id"));
            }
        }
    }
} 
```

`

# gwt - 序列化存储在 JavaScriptObject 中的非常小的数字

> ID：13770812
> 
> 赞同：2
> 
> 时间：2012-12-07T20:53:34.830
> 
> 标签：gwt

我有一个二维数组，我在 GWT 中将其表示为 type 的对象`JsArray<JsArrayNumber>`。如果我要将数组转换为 Javascript，它看起来像这样：

```
var test = [[0.6578396255487482,7.875995798E-314,3.1688557021480858E55],
                [9.365832954E-315,0.9866897170404328,9.378991533366766E54],
            [4.999803162025956E51,6.32672779777942E54,1.987536773023561]]; 
```

问题是，当我尝试使用 将 GWT 对象序列化为 JSON 字符串时`JSONObject.toString()`，进程挂起并且永远不会完成。通过一些混乱，我发现如果我将非常小的数字（以 E-315 结尾的数字）更改为零，则序列化成功完成。为什么 GWT 很难处理这些数字？`JSONObject.toString()`序列化这样的东西的正确方法是什么？我意识到，由于这些数字非常小，我可以在序列化之前对这些对象进行清理，但如果可能的话，我不希望更改它们，因为它们是某种敏感计算的结果。

编辑：

这是一个显示行为的示例单元测试：

```
import org.junit.Test;

import com.google.gwt.core.client.JsArray;
import com.google.gwt.core.client.JsArrayNumber;
import com.google.gwt.json.client.JSONObject;
import com.google.gwt.junit.client.GWTTestCase;

public class SmallDoubleTest extends GWTTestCase{

    @Test
    public void test(){

        // When the very small numbers are replaced with 0 everything works
        String jsonStr = "[[0.6578396255487482,0,3.1688557021480858E55]," +
                        "[0,0.9866897170404328,9.378991533366766E54]," +
                        "[4.999803162025956E51,6.32672779777942E54,1.987536773023561]]";
        JsArray<JsArrayNumber> jsobj = buildArray(jsonStr);
        System.out.println("First Item: " + jsobj.get(0).get(0));
        System.out.println("Last Item: " + jsobj.get(2).get(2));
        JSONObject jsonobj = new JSONObject(jsobj);
        System.out.println(jsonobj.toString());

        // Putting them back in cause everything to hang on jsonobj.toString();
        jsonStr = "[[0.6578396255487482,7.875995798E-314,3.1688557021480858E55]," +
                         "[9.365832954E-315,0.9866897170404328,9.378991533366766E54]," +
                         "[4.999803162025956E51,6.32672779777942E54,1.987536773023561]]";
        jsobj = buildArray(jsonStr);
        System.out.println("First Item: " + jsobj.get(0).get(0));
        System.out.println("Last Item: " + jsobj.get(2).get(2));
        jsonobj = new JSONObject(jsobj);
        System.out.println(jsonobj.toString());
    }

    public static native JsArray<JsArrayNumber> buildArray(String json) /*-{
        return eval('(' + json + ')');
    }-*/;

    public String getModuleName(){
        return "com.iai.cgs.rest.gwtclient.CGSGWTClient";
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:37:33.467

我可能会建议问题出在`JSONObject`实现上，因为它总是尝试从提供的数据手动创建 json。我很确定使用本机浏览器`JSON.stringify()`功能会快得多。例子：

```
public static native String stringify(JavaScriptObject object)/*-{
   return JSON.stringify(object);
}-*/; 
```

唯一的问题是[旧的浏览器](http://caniuse.com/json)（比如 IE6-7）不支持这个功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:26:42.253

对于一个`JsArray`你必须使用`new JSONArray(jsobj).toString()`，而不是`JSONObject`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:25:58.983

正如 JSONArray 的 JavaDoc 已经警告的那样，如果数组很大， toString() 可能需要很长时间（尽管您可能不会使用 JSONArray，但 toString 对于 JSON 对象可能很昂贵。如果您有 JsArray，您可以尝试以下`join`方法还返回一个字符串，它只是原生 JavaScript，可能会更快。

# regular-language - 为给定的正则表达式绘制最小 DFA

> ID：13770814
> 
> 赞同：5
> 
> 时间：2012-12-07T20:53:54.500
> 
> 标签：regular-language, dfa, nfa

什么是绘制最小的直接和简单的方法`DFA`，它接受与给定相同的语言`Regular Expression(RE)`。
我知道可以通过以下方式完成：

```
Regex ---to----► NFA ---to-----► DFA ---to-----► minimized DFA 
```

但是有什么捷径吗？像`(a+b)*ab`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T17:35:54.653

## 正则表达式到 DFA

虽然没有从正则表达式（RE）中绘制 DFA 的算法捷径，但是通过分析而不是推导可以使用捷径技术，它可以节省您绘制最小化 dfa 的时间。但是偏离了你只能通​​过练习才能学习的技术。我以你的例子来展示我的方法：

```
(a + b)*ab 
```

首先，考虑正则表达式的语言。如果第一次尝试很难说出语言描述是什么，那么找到可以用语言生成的最小可能字符串，然后找到第二小的......

记住一些基本正则表达式的解决方案。例如，我在[这里写了一些直接从正则表达式编写左线性和右线性语法的基本思想。](https://stackoverflow.com/questions/13816439/left-linear-and-right-linear-grammars/13945932#13945932)同样，您可以编写用于解释最小化的 dfa。

在 RE `(a + b)*ab`中，可能的最小字符串是`ab`因为使用`(a + b)*`一个可以生成`NULL(^)`字符串。第二小的字符串可以是`aab`或`bab`。现在我们可以很容易地注意到关于语言的一件事是，这个 RE 语言中的任何字符串总是以`ab`(suffix) 结尾，而前缀可以是任何可能的字符串`a`，`b`包括`^`.

此外，如果当前符号是`a`; 那么一个可能的机会是下一个符号将是 a `b`和字符串结尾。因此，在 dfa 中，我们需要一个转换，使得当 `b`符号出现*在*symbol`a`之后时，它应该移动到 dfa 中的某些**最终状态**。

接下来，如果一个新符号进入最终状态，那么我们应该进入某个*非最终*状态，因为之后的任何符号`b`都可能只出现在语言中的某个字符串的中间，因为所有语言字符串都以 suffix 结尾`'ab'`。

所以在这个阶段有了这些知识，我们可以绘制一个不完整的转换图，如下所示：

> --►(Q [0] )---a---►(Q [1] )---b----►((Q [f] ))

现在在这一点上您需要了解：例如，每个状态都有一些含义

> (Q [0] ) 表示 = 起始状态
> (Q [1] ) 表示 = 最后一个符号是“a”，再加一个“b”，我们可以转换到最终状态
> (Q [f] ) 表示 = 最后两个符号是“ab”

现在想想如果符号`a`进入最终状态会发生什么。更多地说明 Q [1]因为这个状态意味着最后一个符号是`a`。（*更新的转换图*）

```
--►(Q0)---a---►(Q1)---b----►((Qf))  
                ▲-----a--------| 
```

但是假设符号不是符号`a`，而是`b`最终状态。然后我们应该从最终状态转移到某个非最终状态。在这种情况下的当前转换图中，我们应该从最终状态 Q [f]移动到初始状态。（*同样我们需要`ab`在字符串中接受*）

```
--►(Q0)---a---►(Q1)---b----►((Qf))  
     ▲          ▲-----a--------|  
     |----------------b--------| 
```

这张图还是不完整的！因为没有`a`来自 Q [1]的符号的出边。对于`a`状态 Q [1]上的符号， 需要自循环，因为 Q [1]表示最后一个符号是`a`.

```
 a-  
                ||
                ▼|
--►(Q0)---a---►(Q1)---b----►((Qf))  
     ▲          ▲-----a--------|  
     |----------------b--------| 
```

现在我相信上图中的 Q [1]和 Q [f]都存在所有可能的出边。一个缺失边是符号的 Q [0]`b`的出边。[并且在状态 Q 0]必须有一个自循环，因为我们再次需要一个序列，`ab`以便字符串可以被接受。（*从 Q [0]到 Q [f]的转变是可能的`ab`*）

```
 b-          a-  
    ||          ||
    ▼|          ▼|
--►(Q0)---a---►(Q1)---b----►((Qf))  
     ▲          ▲-----a--------|  
     |----------------b--------| 
```

现在 DFA 完成了！

在最初的几次尝试中，该方法可能看起来很困难。但是，如果你学会用这种方式画画，你会发现你的分析能力有所提高。你会发现这种方法是快速而客观的绘制 DFA 的方法。

[* 在我给出的链接中，我描述了更多的正则表达式，我强烈建议您学习它们并尝试为这些正则表达式制作 DFA。]

# git - 添加 -A/commit 主/所有子模块的简单方法

> ID：13770818
> 
> 赞同：5
> 
> 时间：2012-12-07T20:54:13.877
> 
> 标签：git, git-submodules, git-commit

通过使用`git add -A`and `git commit -a`，我显然可以添加/提交对我当前所在的仓库的所有更改。但是，有没有办法将*所有*子模块包含在添加/提交中并将相同的提交消息应用于每个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T20:59:12.690

您可以使用别名。制作脚本：例如`~/supercommit.sh`

```
#!/bin/bash -e
if [ -z $1 ]; then
    echo "You need to provide a commit message"
    exit
fi

git submodule foreach git add -A .
git submodule foreach git commit -am "$1"

git add -A .
git commit -am "$1" 
```

并将其标记为可执行（`chmod +x`）。现在，创建一个别名：

```
git config alias.supercommit '!~/supercommit.sh "$@"; #' 
```

那应该可以（我会稍微测试一下）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-12-15T01:11:11.703

好吧，这是 9 年前提出并回答的，今天我在寻找同样的东西时它对我有帮助。但是，我在让它工作时遇到了一些问题，所以我发布这个是为了帮助其他可能面临同样问题的人。

问题 ：

*   因“第 2 行：[：参数太多”而失败
*   如果任何子模块没有更改，则失败

修复：

*   在第 2 行的 $1 周围添加引号 (")，否则包含多个单词的注释将被视为多个参数
*   在提交之前检查子模块是否已暂存更改

更新代码

```
#!/bin/bash -e
if [ -z "$1" ]; then
    echo "You need to provide a commit message"
    exit
fi

git submodule foreach "
    git add -A .
    git update-index --refresh
    commits=\$(git diff-index HEAD)
    if [ ! -z \"\$commits\" ]; then
        git commit -am \"$1\"
    fi"

git add -A .
git commit -am "$1" 
```

# php - Varnish 503 错误（缓存过载？）

> ID：13770820
> 
> 赞同：4
> 
> 时间：2012-12-07T20:54:29.913
> 
> 标签：php, node.js, varnish

最近我的公司得到了一些媒体的报道，因此很多流量都进入了我们的网站。我们是一家位于[http://rayku.com](http://rayku.com)的在线辅导公司，让学生通过交互式 HTML5 白板获得辅导员的按需帮助。通过 google talk 通知导师，一旦导师单击通过 google talk 发送的自动消息中的链接，两个用户都会连接到白板。

我们遇到的问题与连接到白板时的清漆有关。不幸的是，在随机时间，导师有时无法到达白板并收到以下错误消息：

[http://grab.by/i65A](http://grab.by/i65A)

> 连接到服务器时出错：503 服务不可用
> 
> # 错误 503 服务不可用
> 
> 暂停服务
> 
> ### 上师冥想：
> 
> 西ID：1564976246
> 
> * * *
> 
> 优化缓存服务器

清除我的 cookie 后，此问题已解决（但未缓存）。不幸的是，这个问题很难复制，我怀疑它与 Varnish 的缓存过载有关，并且没有采用正确的参数。

你能帮我调试这个问题吗？许多导师报告了这个问题，并且许多课程因此被取消:)。

非常感激！唐尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-28T16:23:32.363

VARNISH 3.0.7：这个问题有多种原因。我目前正在我的一台服务器上对此进行调查，发现我有不止一个问题。在我的情况下，“第一次读取错误”与慢页面（获取图像）失败有关。我发现它的方法是使用 varnishlog 命令。

[https://www.varnish-cache.org/docs/3.0/tutorial/troubleshooting.html](https://www.varnish-cache.org/docs/3.0/tutorial/troubleshooting.html)

```
 varnishlog -d -c -m TxStatus:503

     24 SessionOpen  c 127.0.0.1 39370 :6081
     24 ReqStart     c 127.0.0.1 39370 657793361
     24 RxRequest    c GET
     24 RxURL        c /inventory/part/MYPAGE.HTML
     24 RxProtocol   c HTTP/1.1
     24 RxHeader     c User-Agent: Mozilla/5.0 (Windows NT 6.1)       AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36
     24 RxHeader     c Referer: https://MYWEBSITE.com/inventory/new?limit=100
     24 RxHeader     c Accept: image/gif, image/x-xbitmap, image/jpeg,       image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/msword, application/xaml+xml, application/vnd.ms-xpsdocument, application/x-ms-xbap, application/x-ms-application, */*
     24 RxHeader     c Accept-Encoding: gzip, deflate
     24 RxHeader     c Accept-Language: en-US
     24 RxHeader     c Pragma: no-cache
     24 RxHeader     c Host: MYWEBSITE.com
     24 RxHeader     c Cookie: PHPSESSID=crp0881ji0qgfdqgtde10ovh72;             laravel_session=eyJpdiI6ImIrRVVGRFBWdHErdk85cU9oQThqemc9PSIsInZhbHVlIjoid0g2Zk56elVybUdlVkVQb0dCdzlVVVBhMWVmVlwvZnRPOFlEOVwvQjRWOW5ITUVyNUFCMGZyRUI5aDlGSVBoWWpsR0Z3NGxZK2NjQ2Z6Q01Lam5IWVdcL3c9PSIsIm1hYyI6ImZlZ
  ....   ....  .... 
```

对我来说表明它在 MYSITE.com 上获取上面的 URI 失败。在这种情况下，这是预期的，因为页面存在问题。

Varnish 有一些价值可以帮助缓解这个问题和其他问题。以下要注意的是这些：

```
 .connect_timeout = 1s; # Wait a maximum of 1s for backend connection (Apache, Nginx, etc...)
  .first_byte_timeout = 120s; # Wait a maximum of 120s for the first byte to come from your backend
  .between_bytes_timeout = 2s; # Wait a maximum of 2s between each bytes sent 
```

如果您在日志中看到“第一个字节错误”，那么可以通过设置 first_byte_timeout 来解决它（在许多情况下这有效）。不是在我的情况下，而是在上面的情况下。我要试验的是来自后端“connect_timeout”的响应超时。如果您收到不健康的消息，那么您需要在您的 varnish 配置文件中编辑 .probe 设置。另一个简单的问题是端口配置错误或 /httpcheck 上的配置文件或任何实际上无法访问的文件（请务必检查您是否可以使用 curl 访问它）。

PS> 我正在回复这个帖子，因为我注意到它没有得到充分的回答，我希望我的调查至少能对某人有所帮助。

更多阅读： [https ://varnish-cache.org/tips/varnishlog/fetcherror.html](https://varnish-cache.org/tips/varnishlog/fetcherror.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-07T22:57:39.710

多亏了 Rackspace 的好人，这似乎已经解决了！原来是缓存问题，通过指示 Varnish 只缓存图像、js 和 css 文件，这解决了我的问题。

# opengl - Windows 上的 GL_POINTS 故障

> ID：13770821
> 
> 赞同：0
> 
> 时间：2012-12-07T20:54:42.113
> 
> 标签：opengl, glut

我有一个奇怪的错误影响了我的 GLUT 程序

```
void display(void) {
/* clear the screen to the clear colour */
glClear(GL_COLOR_BUFFER_BIT);

jVector** buff = antialias ? antialiasedBuffer : screen;
for (int y = 0; y < sceneModel.height(); ++y){
    for (int x = 0; x < sceneModel.width(); ++x){
        glBegin(GL_POINTS);
            glColor3d(buff[x][y].x, buff[x][y].y, buff[x][y].z);
            glVertex2f(x,y);
        glEnd();
    }
}

/* swap buffers */
glutSwapBuffers();
}

void reshape (int w, int h) {
/* set the viewport */
glViewport (0, 0, (GLsizei) w, (GLsizei) h);

/* Matrix for projection transformation */
glMatrixMode (GL_PROJECTION); 

/* replaces the current matrix with the identity matrix */
glLoadIdentity ();

/* Define a 2d orthographic projection matrix */
gluOrtho2D (0.0, (GLdouble) w, 0.0, (GLdouble) h);
}

int main(int argc, char** argv) {

// PROJECT CODE

sceneModel.generateProjectModel();
screen = rayTrace(sceneModel);

// OPENGL CODE

/* deal with any GLUT command Line options */
glutInit(&argc, argv);

/* create an output window */
glutInitDisplayMode(GLUT_DOUBLE|GLUT_RGB);
glutInitWindowSize(sceneModel.width(), sceneModel.height());

/* set the name of the window and try to create it */
glutCreateWindow("CS 488 - Project 3");

/* specify clear values for the color buffers */
glClearColor (0, 0, 0, 1.0);

  /* Receive keyboard inputs */
glutKeyboardFunc (Keyboard);

  /* assign the display function */
glutDisplayFunc(display);

/* assign the idle function */
glutIdleFunc(display);

  /* sets the reshape callback for the current window */
glutReshapeFunc(reshape);

  /* enters the GLUT event processing loop */
glutMainLoop();

return (EXIT_SUCCESS);
} 
```

发生的情况是渲染图像显示了一些随机的垂直黑线。我可以向你保证缓冲区没有它们。这只发生在使用 GL_POINTS 绘图时，当我使用 GL_LINES 时，这些线不会出现。我还注意到在 Mac 上编译它不会导致这个故障。此外，在调整窗口大小后，黑线的数量和位置会发生变化，从第二张和第三张图像可以看出。

![图 1](../Images/1420447aeb0eefc60f70792caef1fb46.png) ![图 2](../Images/46247edc547d6ceac3acd4e920300e8a.png) ![图 2 调整窗口大小后](../Images/2de7350b6daca68501c9c29b0015b076.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:03:42.363

这是将位图传输到帧缓冲区的*最慢方法。*至少将你的`glBegin()/glEnd()`配对移到`for`-loops 之外！

尝试将位图上传到纹理并渲染视口大小的纹理四边形。

# linux - Linux 3.2 内核与 2.6 内核的不平衡套接字接受

> ID：13770826
> 
> 赞同：26
> 
> 时间：2012-12-07T20:55:13.877
> 
> 标签：linux, node.js, http, kernel, epoll

我正在运行一个相当大规模的 Node.js 0.8.8 应用程序，它使用具有 16 个工作进程的集群，在具有超线程的 16 处理器机器上（所以 32 个逻辑核心）。我们发现，自从迁移到 Linux 3.2.0 内核（从 2.6.32 开始）后，工作子进程之间传入请求的平衡似乎被重压到 5 个左右的进程，而其他 11 个根本没有做太多工作。这可能对吞吐量更有效，但似乎增加了请求延迟，对我们来说并不是最优的，因为其中许多是可以同时开始工作的长期 websocket 连接。

子进程都在套接字上接受（使用 epoll），虽然这个问题在 Node 0.9 中有一个修复（https://github.com/bnoordhuis/libuv/commit/be2a2176ce25d6a4190b10acd1de9fd53f7a6275），但该修复似乎没有帮助我们的测试。是否有人知道内核调整参数或构建选项可能会有所帮助，或者我们是否最好回到 2.6 内核或使用不同的方法跨工作进程进行负载平衡？

我们将其归结为一个简单的 HTTP Siege 测试，但请注意，这是在具有超线程（即 24 个逻辑内核）的 12 核机器上运行 12 个 proc，并且在套接字上接受 12 个工作进程，而不是我们的 16 个生产中的过程。

HTTP Siege 在 Debian Squeeze 上使用 Node 0.9.3，在裸机上使用 2.6.32 内核：

```
reqs pid
146  2818
139  2820
211  2821
306  2823
129  2825
166  2827
138  2829
134  2831
227  2833
134  2835
129  2837
138  2838 
```

除了 3.2.0 内核之外的所有内容都相同：

```
reqs pid
99   3207
186  3209
42   3210
131  3212
34   3214
53   3216
39   3218
54   3220
33   3222
931  3224
345  3226
312  3228 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:40:55.097

不要依赖操作系统的套接字多重接受来平衡 Web 服务器进程之间的负载。

Linux 内核的行为因版本而异，我们看到 3.2 内核的行为特别不平衡，在以后的版本中似乎更加平衡。例如 3.6。

我们的操作是假设应该有一种方法可以让 Linux 用这个来做类似循环的事情，但是这样做有很多问题，包括：

*   Linux 内核 2.6 在裸机上表现出类似循环的行为（不平衡约为 3 比 1），Linux 内核 3.2 没有（10 比 1 的不平衡），内核 3.6.10 似乎再次正常。我们没有试图将实际变化一分为二。
*   无论使用何种内核版本或构建选项，我们在 Amazon Web 服务上的 32 个逻辑核心 HVM 实例上看到的行为都严重偏向于单个进程；Xen 套接字接受可能存在问题：[https ://serverfault.com/questions/272483/why-is-tcp-accept-performance-so-bad-under-xen](https://serverfault.com/questions/272483/why-is-tcp-accept-performance-so-bad-under-xen)

您可以在我们用来与优秀的 Node.js 团队对应的 github 问题上详细查看我们的测试，从这里开始：[https ://github.com/joyent/node/issues/3241#issuecomment-11145233](https://github.com/joyent/node/issues/3241#issuecomment-11145233)

该对话以 Node.js 团队结束，表示他们正在认真考虑在 Cluster 中实现显式循环，并为此启动一个问题：[https](https://github.com/joyent/node/issues/4435) ://github.com/joyent/node/issues/4435和 Trello团队（也就是我们）执行我们的后备计划，即使用本地 HAProxy 进程在每台服务器机器上的 16 个端口上进行代理，每个端口上运行一个 2-worker-process 集群实例（用于在接受级别进行快速故障转移在进程崩溃或挂起的情况下）。该计划运行良好，请求延迟的变化大大减少，平均延迟也更低。

这里还有很多要说的，我没有采取邮寄 Linux 内核邮件列表的步骤，因为不清楚这是否真的是 Xen 或 Linux 内核问题，或者真的只是对多接受的错误期望我们的行为。

我很想看到关于多重接受的专家的回答，但我们将回到使用我们更好理解的组件可以构建的内容。如果有人发布更好的答案，我会很高兴接受它而不是我的。

# wordpress - 如何在 wordpress 中设置 mediaelement.js startVolume？

> ID：13770827
> 
> 赞同：3
> 
> 时间：2012-12-07T20:55:13.957
> 
> 标签：wordpress, mediaelement.js

我安装了 mejs 2.9.1 wordpress 插件，但找不到任何方法来调整（mp4、wmv 等）vid 播放的 startVolume。各种 .js 文件都显示 startVolume="0.8" 但更改没有效果；在 WP 短代码调用上使用 startVolume 属性时也没有效果。看起来这应该很容易。有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-18T10:52:51.897

您可以将 startVolume: 0.8 更改为 startVolume: 0.5, 为我工作

# c# - 我可以将两个元素放在网格的同一个单元格中，并且一次只显示一个吗？

> ID：13770829
> 
> 赞同：0
> 
> 时间：2012-12-07T20:55:34.733
> 
> 标签：c#, windows-8, winrt-xaml, windows-store-apps

我想根据状态显示分配给网格单元格的一个或另一个控件，例如：

```
<Button x:Name="btnBla" Grid.Row=42 Grid.Column=7></Button>
<TextBlock x:Name="txtblockOh" Grid.Row=42 Grid.Column=7 IsEnabled="false"></TextBlock> 
```

...然后在代码隐藏中：

```
btnBla.IsEnabled = someBool;
txtblockOh.IsEnabled = ! btnBla.IsEnabled; 
```

这是完成此任务的首选方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T20:59:15.760

如果您想按照问题所述一次“显示”一个，则应更改`Visibility`IsEnabled 的属性。

您可以在代码中执行此操作，尽管我始终建议不要在代码中操作 UI 元素（无论是 WPF、Silverlight 还是 WinRT），但如果您使用 MVVM 思维方式，所有基于 XAML 的技术都会更加友好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:23:45.037

哟可以看看这个页面：[可见性](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.uielement.visibility.aspx)

# events - 从非托管 C/C++ 函数触发 C++/CLI 中的事件

> ID：13770832
> 
> 赞同：4
> 
> 时间：2012-12-07T20:55:47.783
> 
> 标签：events, c++-cli, unmanaged

我需要从 C++ 中的无人函数触发用 C++/CLI 编写的事件。

做这个的最好方式是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T20:19:54.213

我从codeproject上的一些帮助帖子中找到了一些帮助

想把它贴在这里可能对其他人有用

```
#include "stdafx.h"
#include "windows.h"

using namespace System;
using namespace System::Runtime::InteropServices;

class Camera
{
public:
    Camera()
    {
    }
    ~Camera(){}
    void (*test)(void);
    void OnNewCameraData();
    void StartDataAcquisition();

};

void Camera::StartDataAcquisition()
{
    int i;
    while(i<10)
    {
        test();
        i++;
        Sleep(1000);
    }

}

delegate void FunctionToCallDelegate();

ref class CameraAdapter
{
private:
  Camera *_camera;
  FunctionToCallDelegate ^_Function;
public:
    CameraAdapter(FunctionToCallDelegate ^handler)
    {
        _Function = handler;
    }
    void Init()
    {
        _camera = new Camera();
        pin_ptr<FunctionToCallDelegate^> tmp = &_Function;
        _camera->test = (void (__cdecl *)(void))(Marshal::GetFunctionPointerForDelegate(_Function).ToPointer());
        _camera->StartDataAcquisition();
    }

    ~CameraAdapter()
    {
        delete _camera;
        _camera = 0;
    }
  void OnNewCameraData()
  {
      Console::WriteLine("Received Frame \n");

  }  
};

int main(array<System::String ^> ^args)
{

    FunctionToCallDelegate ^dsi;
    dsi += gcnew FunctionToCallDelegate(gcnew CameraAdapter(dsi), &CameraAdapter::OnNewCameraData);
    CameraAdapter ^camera = gcnew CameraAdapter(dsi);
    camera->Init(); 
    Console::ReadKey();
    return 0;
} 
```

# sql-server - 如何从 Windows 8 应用程序访问 SQL Server？

> ID：13770834
> 
> 赞同：5
> 
> 时间：2012-12-07T20:55:51.487
> 
> 标签：sql-server, ado.net, windows-8

我意识到我的 Windows 8 应用程序无法访问本地 SQL Server 实例。相反，我在 Azure 中有一个 SQL Server。在 SQL Server Management Studio 中，我只需更改查询字符串并像其他任何方式一样与 Azure 数据库进行交互。如何在我的 Windows 8 应用程序中引用该数据库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T22:01:54.800

这就是[Azure 移动服务 SDK](http://www.windowsazure.com/en-us/develop/mobile/)的用途。 [斯科特·格思里（Scott Guthrie）不久前写了一篇关于它](http://weblogs.asp.net/scottgu/archive/2012/08/28/announcing-windows-azure-mobile-services.aspx)的文章。

毫无疑问，您知道 WinRT 中缺少 ado.net 和 Entity Framework……请注意[明显不支持](http://msdn.microsoft.com/en-us/library/windows/apps/br230232%28v=VS.85%29.aspx)System.Data。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T22:19:16.137

您不能直接在 sql 数据库上访问。因为 Windows 8 Apps 与 windows 窗体不同。但你可以使用 web 服务或 azure、amazon 服务、存储文件等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T04:19:14.843

您还可以在数据库上放置一个 OData 头，然后使用各种 OData 客户端库通过 REST 与其通信。有关客户端和服务器库，请参见[http://www.odata.org/libraries](http://www.odata.org/libraries)。Azure 上的 SQL Server 绝对受支持，客户端上的 .NET、JavaScript 和其他平台也是如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-07T20:58:31.797

听起来您想开发一个与数据库通信的 Web 服务，将其部署到 Azure 实例上的 IIS，然后从 Windows 8 应用程序中使用它（通过在 Visual Studio 中添加对 Web 服务的 Web 引用）。

# php - php中的邮件功能

> ID：13770839
> 
> 赞同：1
> 
> 时间：2012-12-07T20:56:17.847
> 
> 标签：php

调试有时会很忙……我该如何处理这个`mail`功能？似乎我需要更改一些设置，但我不知道如何处理它们：当我尝试在我的论坛上发布回复时，会弹出此错误：

```
Warning: mail() [function.mail]: Failed to connect to mailserver at "localhost" port 25, verify your "SMTP" and "smtp_port" setting in php.ini or use ini_set() in C:\xampp\htdocs\mysite\forum part two\post_reply_parse.php on line 72 
```

我在第 72 行的代码是这样的

```
mail($to, $subject, $message, $headers); 
```

我的邮件代码是这样的

```
$email = '';
        $email = substr($email, 0, (strlen($email) - 2));
        address with your domain at the end
        $to = "";
        $from = "";
        // $bcc is the list of emails that will be sent out as blind carbon copies
        $bcc = $email;
        $subject = "YOUR_SUBJECT_HERE";

        $message = "YOU MESSAGE CONTENT HERE";

        $headers = "From: $from\r\nReply-To: $from";
        $headers .= "\r\nBcc: {$bcc}";
        // Send out the email
        mail($to, $subject, $message, $headers); 
```

我不想忽略这个错误，我很想了解如何修复它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T20:57:44.390

默认情况下， PHP 将`sendmail`在 Linux/Unix 机器上使用，因为它是一种普遍可用的邮件服务。

另一方面，Windows 不附带一个。为了`mail()`在 Windows 机器上使用，您需要安装本地 SMTP 服务器或配置您的 PHP 安装以通过另一个 SMTP 服务器中继消息。

注意：我个人没有使用过任何东西，因为我倾向于在 Linux/Unix 机器上进行开发，但这可能对你有用：[http ://www.hmailserver.com/](http://www.hmailserver.com/)

# c# - 如何以相同的角度将相机移动到模型后面？

> ID：13770847
> 
> 赞同：1
> 
> 时间：2012-12-07T20:56:36.753
> 
> 标签：c#, 3d, xna, camera

我遇到在 3D 世界中将相机移动到物体后面时遇到困难。我会创建两种视图模式。

1：用于 fps（第一人称）。第二：人物背后的外景（第二人称）。

我在网上搜索了一些示例，但它在我的项目中不起作用。

如果按下 F2，这是我用于更改视图的代码

```
 //Camera
        double X1 = this.camera.PositionX;
        double X2 = this.player.Position.X;
        double Z1 = this.camera.PositionZ;
        double Z2 = this.player.Position.Z;

        //Verify that the user must not let the press F2
        if (!this.camera.IsF2TurnedInBoucle)
        {
            // If the view mode is the second person
            if (this.camera.ViewCamera_type == CameraSimples.ChangeView.SecondPerson)
            {
                this.camera.ViewCamera_type = CameraSimples.ChangeView.firstPerson;

                //Calcul position - ?? Here my problem
                double direction = Math.Atan2(X2 - X1, Z2 - Z1) * 180.0 / 3.14159265;
                //Calcul angle - ?? Here my problem

                this.camera.position = ..
                this.camera.rotation = ..

                this.camera.MouseRadian_LeftrightRot = (float)direction;
            }
            //IF mode view is first person
            else
            {
                    //.... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:02:28.413

如果我是你，我会使用你现在工作的 FPS 相机（我假设它可以正确移动，有一个位置矩阵等？），然后添加另一个平移变换以将它“移动”回玩家后面。

换一种方式：

如果您的 FPS 视图的“平移/视图矩阵”类似于：

（抱歉，有一段时间没玩 XNA，所以不记得正确的类名）

```
var camTranslateMatrix = [matrix representing player position];
var camDirectionMatrix = [matrix representing player direction, etc];
var camViewMatrix = camTranslateMatrix * camDirectionMatrix; 
```

然后你可以像这样改变它：

```
var camTranslateMatrix = [matrix representing player position];
var camDirectionMatrix = [matrix representing player direction, etc];

// If not in 3rd person, this will be identity == no effect
var camThirdPersonMatrix =
       IsInThirdPersonMode ?
             new TranslateMatrix(back a bit and up a bit) :
             IdentityMatrix();

var camViewMatrix = 
      camTranslateMatrix * 
      camDirectionMatrix * 
      camThirdPersonMatrix; 
```

有道理？那样的话，每次你在两个视图之间切换而没有大量令人讨厌的数学是微不足道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T18:39:35.243

这是 Xna 中一个非常基本的第三人称相机（你所说的第二人称）。它假设您存储了玩家的世界矩阵并且可以访问它：

```
Vector3 _3rdPersonCamPosition = playerWorldMatrix.Translation + (playerWorldMatrix.Backward * trailingDistance) + (playerWorldMatrix.Up * heightOffset);// add a right or left offset if desired too
Vector3 _3rdPersonCamTarget = playerWorldMatrix.Translation;//you can offset this similarly too if desired
view = Matrix.CreateLookAt(_3rdPersonCamPosition, _3rdPersonCamTarget , Vector3.Up); 
```

如果您的 FPS cam 工作正常并假设它与玩家的位置和方向基本相同，您可以用它的视图矩阵代替上面的 playerWorldMatrix，如下所示：

```
Matrix FPSCamWorld = Matrix.Invert(yourWorkingFPSviewMatrixHere); 
```

现在，无论我写`playerWorldMatrix`什么，你都可以使用`FPSCamWorld`。

# c# - MVC ActionLink 触发 RouteConstraint？

> ID：13770851
> 
> 赞同：0
> 
> 时间：2012-12-07T20:57:09.267
> 
> 标签：c#, asp.net-mvc

`Area`我的项目中有这个简单的用户`MVC 4`。

```
public class UserAreaRegistration : AreaRegistration
{
    public override string AreaName { get { return "User"; } }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute("User_Constraint",
                "{userName}/{controller}/{action}/{id}",
                new { userName = string.Empty, controller = "Products", action = "Index", id = UrlParameter.Optional },
                new { userName = new UserNameRouteConstraint() },
                new[] { "T2b.Web.Areas.User.Controllers" }
            );
    }
} 
```

为了确保用户名存在，我有一个`RouteConstraint`叫`UserNameRouteConstraint()`

所有这一切都是在我的用户表中进行简单的查找，如果找到了用户，则返回 true。

到目前为止一切顺利，这个结构工作正常！

现在; 我在用户`Area`中的视图具有以下代码行

```
@Html.ActionLink("More information", "details", new {id = product.Guid}) 
```

这条单行导致`UserNameRouteConstraint()`被调用....

怎么和为什么！？如果我用简单的方式编写链接`HTML`（参见下面的示例），它会很好地工作，但我想`MVC`尽可能接近原则。

```
<a href="/username/Products/details/@product.Guid">More information</a> 
```

有什么办法可以阻止`RouteConstraint`通话吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:12:01.167

每当生成路由时，都会处理约束。

您可以添加此检查以停止约束，具体取决于约束是在处理传入请求还是从以下函数生成 URL `ActionLink`：

```
public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
{
    if(routeDirection == RouteDirection.UrlGeneration)
        return false;

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:13:35.153

当您`ActionLink`在幕后调用时，它会创建一个`RouteValueDictionary`并运行`RouteCollection.GetVirtualPath()`。这部分不是开源的，但我对其工作原理的最佳猜测是，它会根据每个路由的默认值和约束检查生成的路由值字典的参数，直到找到匹配的。正因为如此，它运行你的约束，你应该希望它运行你的约束，这样它就不会最终匹配到错误的路线。

# javascript - Classify lon/lat coordinate into geojson polygon using Javascript

> ID：13770853
> 
> 赞同：2
> 
> 时间：2012-12-07T20:57:15.647
> 
> 标签：javascript, node.js, d3.js, geospatial, geojson

I have a geojson object defining [Neighborhoods in Los Angeles](http://pastebin.com/raw.php?i=8BuTkNak) using lon/lat polygons. In my web application, the client has to process a live stream of spatial events, basically a list of lon/lat coordinates. How can I classify these coordinates into neighborhoods using Javascript on the client (in the browser)?

I am willing to assume neighborhoods are exclusive. So once a coordinate as been classified as neighborhood X, there is no need to further test it for other neighborhoods.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T05:53:35.657

There's a great set of answers [here](https://stackoverflow.com/questions/217578/point-in-polygon-aka-hit-test) on how to solve the general problem of determining whether a point is contained by a polygon. The two options there that sound the most interesting in your case:

*   As @Bubbles mentioned, do a bounding box check first. This is very fast, and I believe should work fine with either projected or unprotected coordinates. If you have SVG paths for the neighborhoods, you can use the native `.getBBox()` method to quickly get the bounding box.

*   the next thing I'd try for complex polygons, especially if you can use D3 v3, is rendering to an off-screen canvas and checking pixel color. D3 v3 offers a geo path helper that can produce canvas paths as well as SVG paths, and I suspect if you can pre-render the neighborhoods this could be very fast indeed.

**Update**: I thought this was an interesting problem, so I came up with a generalized raster-based plugin here: [http://bl.ocks.org/4246925](http://bl.ocks.org/4246925)

This works with D3 and a canvas element to do raster-based geocoding. Once the features are drawn to the canvas, the actual geocoding is O(1), so it should be very fast - a quick in-browser test could geocode 1000 points in ~0.5 sec. If you were using this in practice, you'd need to deal with edge-cases better than I do here.

If you're not working in a browser, you may still be able to do this with [node-canvas](https://github.com/LearnBoost/node-canvas).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T22:09:46.543

I've seen a few libraries out there that do this, but most of them are canvas libraries that may rely on approximations more than you'd want, and might be hard to adapt to a project which has no direct need to rely on them for intersections.

The only other half-decent option I can think of is implementing [ray casting in javascript](https://en.wikipedia.org/wiki/Point_in_polygon#Ray_casting_algorithm). This algorithm isn't technically perfect since it's for Euclidean geometry and lat/long coordinates are not (as they denote points on a curved surface), but for areas as small as a neighbourhood in a city I doubt this will matter.

Here's a [google maps extension](https://github.com/tparkin/Google-Maps-Point-in-Polygon/blob/master/maps.google.polygon.containsLatLng.js) that essentially does this algorithm. You'd have to adapt it a bit, but the principles are quite similar. The big thing is you'd have to preprocess your coordinates into paths of just two coordinates, but that should be doable.*

This is by no means cheap - for every point you have to classify, you must test every line segment in the neighborhood polygons. If you expect a user to be reusing the same coordinates over and over between sessions, I'd be tempted to store their neighborhood as part of it's data. Otherwise, if you are testing against many, many neighborhoods, there are a few simple timesavers you can implement. For example, you can preprocess every neighborhoods extreme coordinates (get their northmost, eastmost, southmost, and westmost points), and use these to define a rectangle that inscribes the town. Then, you can first check the points for candidate neighborhoods by checking if it lies inside the rectangle, then run the full ray casting algorithm.

*If you decide to go this route and have any trouble adapting this code, I'd be happy to help

# android - 模拟器中没有控件？

> ID：13770858
> 
> 赞同：0
> 
> 时间：2012-12-07T20:57:38.510
> 
> 标签：android

我正在尝试使用 eclipse ADT 运行一个非常简单的 Android 演示。应用程序编译并打开模拟器，但没有显示控件。我有应用程序的标题，但未显示按钮和文本字段。有任何想法吗？我在控制台中看不到任何错误。

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal">
    <EditText android:id="@+id/edit_message"
        android:layout_weight="1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:hint="@string/edit_message" />
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/button_send" 
        android:onClick="sendMessage"/>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:13:16.270

你需要调用`setContentView (R.layout.yourLayout);`这个方法来扩展你的布局文件并允许它在你的活动中显示。

# php - Zend Framework 2.0 Acl 库

> ID：13770861
> 
> 赞同：0
> 
> 时间：2012-12-07T20:57:49.203
> 
> 标签：php, zend-framework2, zend-acl

好的，我已经开始这个新项目 2 周了，到目前为止一切都很好。

直到今天我才意识到 Zend 2.0 中没有 Acl 组件。是真的吗？或者我错过了什么。

所以目前我对我的应用程序 acl 一无所知。

你们对我不知道的任何与 Zend 2.0 配合良好的 acl 组件有什么建议吗？或者我应该只下载 Zend 1.x。

非常感谢任何输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T23:53:39.930

Zend Framework 2.0 中的 ACL 组件现在称为`Zend\Permissions\Acl`.

我强烈建议您[查看参考手册](http://framework.zend.com/manual/2.0/en/index.html)。对该页面上的术语进行简单搜索即可立即找到它。

# windows-8 - Windows 8 环回如何工作？

> ID：13770863
> 
> 赞同：1
> 
> 时间：2012-12-07T20:57:51.077
> 
> 标签：windows-8, loopback

本地服务不适用于 Windows 8 应用程序。如果我启用 Loop Back，那么我可以访问本地服务，但我的 Windows 8 应用程序将不允许出现在应用商店中。如果我不关心商店（对于业务线应用程序），我该如何使用 Loop Back？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:28:59.067

[本文档告诉您如何](http://msdn.microsoft.com/en-us/library/windows/apps/Hh780593.aspx)；但是，它还包括以下注释：

> 警告 Loopback 仅允许用于开发目的。不允许安装在 Visual Studio 之外的应用使用。

我读到即使是侧面加载的应用程序也不允许这样做；不过，我不确定如何执行。

# sql - 在plpgsql的循环中增加一个数字

> ID：13770869
> 
> 赞同：13
> 
> 时间：2012-12-07T20:58:08.940
> 
> 标签：sql, postgresql, increment, plpgsql, postgresql-8.4

我无法从示例中立即找到这一点。我想在循环中增加一个变量，在一个函数中。

例如：

```
DECLARE
   iterator float4;
BEGIN
   iterator = 1;

    while iterator < 999
       .....
      iterator ++;
END; 
```

这将如何完成？

我正在查看有关流量控制的文档：
[http ://www.postgresql.org/docs/8.4/static/plpgsql-control-structures.html](http://www.postgresql.org/docs/8.4/static/plpgsql-control-structures.html)

而且它们似乎都与我无关，除非这些绝对是模拟递增变量的唯一方法。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-07T21:18:12.443

在 plpgsql 中增加一个变量：

```
iterator := iterator + 1; 
```

没有`++`操作员。

关于 plpgsql 中的赋值运算符：

*   [被遗忘的赋值运算符“=”和常见的“:=”](https://stackoverflow.com/questions/7462322/the-forgotten-assignment-operator-and-the-commonplace/7641260#7641260)

[手册中 PL/pgSQL 中循环的](https://www.postgresql.org/docs/current/interactive/plpgsql-control-structures.html#PLPGSQL-CONTROL-STRUCTURES-LOOPS)正确语法。

您的代码片段将像这样工作：

```
DECLARE
   iterator float4 := 1;  -- we can init at declaration time
BEGIN
   WHILE iterator < 999
   LOOP
      iterator := iterator + 1;
      -- do stuff
   END LOOP;
END; 
```

[`FOR`](https://www.postgresql.org/docs/current/interactive/plpgsql-control-structures.html#PLPGSQL-INTEGER-FOR)更简单、更快的循环替代方案：

```
 FOR i in 1 .. 999   -- i is integer automatically, not float4
   LOOP
      -- do stuff
   END LOOP; 
```

[手册：](https://www.postgresql.org/docs/current/static/plpgsql-control-structures.html#PLPGSQL-INTEGER-FOR)

> 该变量`name`被自动定义为类型`integer`并且仅存在于循环内（任何现有的变量名定义在循环内都将被忽略）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-12T12:45:30.913

对于一个[sscce](http://sscce.org/)

```
DO $$
DECLARE
   counter INTEGER := 0 ; 
BEGIN
   WHILE counter <= 5 LOOP
      counter := counter + 1 ; 
      RAISE NOTICE 'Counter: %', counter;
   END LOOP ; 
END; $$ 
```

如果你想避免声明变量（更简洁）

```
DO $$
BEGIN
   FOR counter IN 1..5 LOOP
      RAISE NOTICE 'Counter: %', counter;
   END LOOP;
END; $$ 
```

[学分](http://www.postgresqltutorial.com/plpgsql-loop-statements/)

# zend-framework - Zend Framework 1 .htaccess 在子目录中

> ID：13770870
> 
> 赞同：0
> 
> 时间：2012-12-07T20:58:21.847
> 
> 标签：zend-framework

我在 Linux Apache Web 服务器上使用了 Zend 框架 1，必须将它放在名为“go”的子文件夹中，然后我将 .htaccess 与这些行放在其中（在 go 文件夹内）：

```
# Rewrite rules for Zend Framework 
RewriteEngine on 
RewriteRule ^(.*)$ /public/$1 [QSA,L] 
```

进入我的 domain.com/go 后我得到的是：

> 未找到
> 
> 在此服务器上未找到请求的 URL /index.php。
> 
> 此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。

我做错了什么？

将“/public”更改为“public”后，我也收到“未找到”错误。

我为我的应用程序使用子域，例如：go.domain.com，但我想知道为什么我的第一种方法不起作用？.htaccess 不能在子目录上工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T13:33:01.117

以下解决方案对我有用：

首先，在**/go**目录中放置一个**.htaccess**文件，内容如下

 **```
RewriteEngine on 
RewriteRule ^(.*)$ public/$1 [NC,L] 
```

**这会将向/go** url发出的每个请求重定向到公共目录。

**接下来，确保您的/go/public/.htaccess**文件中没有任何内容`RewriteBase`，除非需要。

 **最后，创建一个控制器插件并将以下代码放入`routeStartup()`.

```
Zend_Controller_Front::getInstance()
                       ->getRequest()
                       ->setBaseUrl('/database/'); 
```

最后一步将使您可以轻松地通过仅使用`$this->baseUrl()`helper 将资源（css、js、图像）添加到 HTML。您不必在每个文件路径中添加**/go 。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:43:22.300

您需要使用 RewriteBase 才能使其正常工作

```
RewriteBase /go 
```

并且仍然将 .htaccess 放在公用文件夹中，而不是其他任何地方。

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)****

# android - Android VKontake 官方客户端。如何获得授权

> ID：13770874
> 
> 赞同：1
> 
> 时间：2012-12-07T20:58:36.433
> 
> 标签：android, android-intent, vk

我的设备上有来自 VKontakte 的官方应用程序。

我在那里授权。

我尝试编写自己的使用 VKontake API 的应用程序，但我需要授权。

是否有任何方法可以通过发送 Intent 和某些操作从官方应用程序中获取用户的授权状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:19:23.620

现在有可能吗！请仔细阅读本教程 [http://vk.com/dev/android_sdk](http://vk.com/dev/android_sdk)

您也可以通过 webview 授权 Vkontakte 中的授权是 OAuth 授权。因此，对于所有使用 OAuth 的服务，以下步骤都是相似的：Facebook、Instagram 等。

1.  在 vk.com 上创建应用程序：http://vk.com/editapp?act= [create](http://vk.com/editapp?act=create)
2.  得到它的ID。
3.  [在您的登录活动中，使用登录网址https://oauth.vk.com/authorize?client_id=APP_ID&scope=SETTINGS&redirect_uri=REDIRECT_URI&display=DISPLAY&response_type=token](https://oauth.vk.com/authorize?client_id=APP_ID&scope=SETTINGS&redirect_uri=REDIRECT_URI&display=DISPLAY&response_type=token)打开一个 web 视图

APP_ID 是您的应用程序的 ID。您将在 VK -> 应用程序 -> 设置 -> 我管理的应用程序（在底部）-> 管理中找到它

此登录 url 将显示一个标准的 VK 授权对话框。在那里，用户将输入他的登录名和密码。

之后，用户将被重定向到您的 Redirect-Uri。所以你需要准备一个 Redirect_Uri - 这是一个成功登录后将打开的页面。

该 url 将连接一个 access_token。access_token 是授权后唯一需要存储的参数。在接下来的请求中，您只需要提供 access_token。

关于您可以在 VK 站点中阅读的其他参数：http: [//vk.com/developers.php ?oid=-17680044&p=Authorizing_Client_Applications](http://vk.com/developers.php?oid=-17680044&p=Authorizing_Client_Applications)

# javascript - JavaScript 样式属性为空

> ID：13770879
> 
> 赞同：4
> 
> 时间：2012-12-07T20:58:52.627
> 
> 标签：javascript, css, dom, properties

我需要计算元素边框的宽度。如果我明确设置它（通过 CSS），那么我可以通过以下方式在 JavaScript 中访问它：

```
 element.style.borderWidth 
```

但是，如果*只*指定边框样式属性（而不是'border-width'）->

```
 border-style: solid 
```

然后`borderWidth`属性是空的。为什么？我计算宽度的方法如下：

```
if(element.style.borderWidth == ''){
    borderWidth = (offsetHeight - clientHeight)/2
} 
```

有没有其他方法可以计算边框宽度而只设置`border-style`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-07T21:05:46.480

您可以使用`window.getComputedStyle`现代浏览器

```
window.getComputedStyle(element).borderBottomWidth; 
```

* * *

对于 IE pre-9，您将不得不使用替代方法

```
element.currentStyle.borderBottomWidth 
```

# sql - 随时间删除重复

> ID：13770883
> 
> 赞同：2
> 
> 时间：2012-12-07T20:59:03.763
> 
> 标签：sql, sql-server-2008, tsql

我们有一个“审计日志”表，每天存储每个项目的价格。以下是一些示例数据：

```
1 - Item 587 - $19.99 - 12/1/2012
2 - Item 587 - $19.99 - 12/2/2012
3 - Item 587 - $18.99 - 12/3/2012
4 - Item 587 - $18.99 - 12/4/2012
5 - Item 587 - $20.99 - 12/5/2012
6 - Item 587 - $19.99 - 12/6/2012
7 - Item 587 - $19.99 - 12/7/2012
8 - Item 587 - $17.99 - 12/8/2012
9 - Item 587 - $17.99 - 12/9/2012
10 - Item 587 - $17.99 - 12/10/2012 
```

这很好用，但是，这个表增长得太快了。我们现在需要一个 T-SQL 脚本来删除重复的行。脚本后的数据集应该是这样的：

```
1 - Item 587 - $19.99 - 12/1/2012
3 - Item 587 - $18.99 - 12/3/2012
5 - Item 587 - $20.99 - 12/5/2012
6 - Item 587 - $19.99 - 12/6/2012
8 - Item 587 - $17.99 - 12/8/2012 
```

似乎需要`GROUP BY`or `DISTINCT`，但我不确定如何开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T21:03:52.517

```
WITH DuplicateTableWithDupNumbers
as
(
    SELECT recid, itemid, price, date, 
        ROW_NUMBER() OVER (PARTITION BY itemid ORDER BY  dateDESC ) AS DupNumber
    FROM YourTable
)
delete from YourTable
where EXISTS
(
    SELECT 1 
    from DuplicateTableWithDupNumbers as dup 
    WHERE DupNumber > 1 AND dup.recid = yourtable.recid
) 
```

您可以根据需要更改分区首选项。这将在一个查询中直接从您的表中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:02:25.527

假设您在表中有这些值，则需要以下内容：

```
select id, t.item, t.price, date 
from table t inner join
(select item, price, min(date) as min_date
from table
group by item, price) g on 
t.item = g.item and
t.price = g.price
t.date = g.min_date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T00:02:17.320

使用递归 СTE 检查相同的值

```
;WITH cte AS
 (
  SELECT Id, ItemId, Price, [date], 
         0 AS ChPrice
  FROM dbo.audit_log
  WHERE Id = 1
  UNION ALL
  SELECT a.Id, a.ItemId, a.Price, a.[date],
         CASE WHEN a.Price = c.Price THEN a.Id ELSE 0 END
  FROM dbo.audit_log a JOIN cte c ON a.Id = c.Id + 1  
  )
DELETE a
FROM dbo.audit_log a JOIN cte c ON a.Id = c.ChPrice 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/d6773/2/1)上的演示[](http://sqlfiddle.com/#!3/d6773/2/1)

# javascript - 在 ChildBrowser 而不是主 Webview 中的 Cordova 中打开非白名单 URL

> ID：13770894
> 
> 赞同：0
> 
> 时间：2012-12-07T20:59:23.330
> 
> 标签：javascript, cordova, childbrowser

我正在尝试在我的 Cordova/Phonegap 应用程序中实现官方 Twitter 和 Facebook 共享按钮，但我遇到了很大的困难。他们都尝试加载一个`iframe`元素来显示他们的按钮，这有效，但是单击其中任何一个都会导致它们在 Webview 中打开，而无法在 ChildBrowser 中打开它们。当用户完成共享但由于缺少导航按钮而无法返回应用程序时，这会成为一个问题。

默认情况下，有没有办法在 ChildBrowser 而不是 Webview 中打开 URL 列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:27:32.213

那么你可以使用：

```
ChildBrowser.showWebPage(); 
```

打开非白名单 URL 的命令。

在 2.3.0 中，我们将[重载 window.open()](https://wiki.apache.org/cordova/InAppBrowser)以便您可以指定是否要在主 Web 视图、操作系统浏览器或无法访问 Cordova 的特殊应用程序浏览器中打开 url API。

# java - 搜索数组

> ID：13770902
> 
> 赞同：1
> 
> 时间：2012-12-07T21:00:17.040
> 
> 标签：java, search

我试图弄清楚如何创建一种方法来查找数组中的字符串并将该字符串连同其索引一起打印出来。我认为方法签名是正确的，但我不知道如何在方法中返回字符串值。

```
String name = search(array,"Dog"); //the method implementation in main
System.out.println(name); 
```

.

```
public static int search(String[] array, String key)
{
    for (int i= 0; i< array.length; i++)
        {
         if ( array[i] == key ) 
         return i;  
        }
     return ("Name cannot be found in array);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T21:02:34.653

您不能`String`从声明为 return 的方法返回 a `int`。指示失败的最常见方法是返回超出范围的值：

```
return -1; 
```

或者抛出异常：

```
throw new NameNotFoundException("Name cannot be found in array"); 
```

* * *

此外，这条线不起作用：

```
if ( array[i] == key ) 
```

字符串需要与 进行[比较`equals()`，而不是`==`](https://stackoverflow.com/questions/767372/java-string-equals-versus)。`==`操作员检查字符串是否是相同的对象*，*而不是检查它们的*内容*是否相同。

```
if (key == null && array[i] == null ||
    key != null && key.equals(array[i])) 
```

并确保您不调用`.equals()`空引用。上面的代码检查了这种可能性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T21:02:25.453

为什么要返回字符串？调用此方法的人已经知道 String 是什么，因为他们必须首先提供它。（否则怎么知道你在找什么：P）

你也应该这样做`array[i].equals(key)`。

`==`是为了对象相等。 `.equals()`是为了价值平等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:02:23.240

如果你想返回 a `String`，那么......你的返回类型应该是`String`，而不是`int`。

此外，您不应该使用`==`with `String`s 或大多数对象，`array[i].equals(key)`而是使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T21:08:16.887

最大的问题是，当 java 已经为您实现了搜索时，为什么还要实现它？

```
 String[] array;
 String val = "Dog";

 if( Arrays.asList(array).contains(val) ){
      System.out.println("your string is found");
 } else {
      System.out.println("your string is found");
 } 
```

或者更好的是对你实施

```
 String[] array;
 String val = "Dog";
 String name = ( Arrays.asList(array).contains(val) ) ? val : "Name cannot be found in array"; 
```

应该注意的是 Arrays.asList DOES NOT COPY 数组只是将其包装在 List 结构中，以便可以将其视为可枚举。此方法的性能与您提供的方法大致相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T21:02:48.967

首先修复您的比较以使用该`equals`方法：

```
 if (array[i].equals(key)) 
```

还将最后一个 return 语句更改为：

```
 return -1; //string not found 
```

然后只需执行此操作（使用 array[searchIndex] 获取字符串）：

```
int searchIndex = search(array,"Dog");
if(i >= 0){
  System.out.println("String="+array[searchIndex] + ", Array Index="+searchIndex);
 }else{
   System.out.println("String not found");
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T21:03:02.627

您已经拥有正在搜索的字符串值。为什么需要退货？只返回索引

```
int index = search(array,"Dog"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-07T21:12:27.510

你可以试试这个......

```
import java.util.*;  
public class xyz {  
 public static void main(String [] args){  
    String [] sa = {"abc","def","ghi"};  
    Arrays.asList(sa);  
    Arrays.sort(sa);  
    for(String s : sa){  
        System.out.println(s);  
    }  
} 
```

}

# ios - iOS - 检测 UITableViewCell 被移出可见视图？

> ID：13770903
> 
> 赞同：5
> 
> 时间：2012-12-07T21:00:23.060
> 
> 标签：ios, uitableview

一旦单元格在屏幕上不再可见，我需要得到通知。

UITableView 已经调用了一个委托方法，`tableView:didEndDisplayingCell:forRowAtIndexPath:`但是这个委托方法永远不会被调用。是的，我确实有我的 UITableView 集的委托。

还有其他方法可以检测细胞被移除吗？我需要能够保存此单元格的内容（输入），然后才能被另一个项目重用。

**编辑：**

根据文档`tableView:didEndDisplayingCell:forRowAtIndexPath:`是 iOS 6 和更高版本的 API。有没有办法在 iOS 5 上实现这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T21:35:26.853

在 6.0 之前的 iOS 版本上，表格视图不会发送`tableView:didEndDisplayingCell:forRowAtIndexPath:`消息。

如果您使用 的子类`UITableViewCell`，则可以通过覆盖在旧版本的 iOS 上获得相同的效果`didMoveToWindow`：

```
- (void)didMoveToWindow {
    if (self.window == nil) {
        // I have been removed from the table view.
    }
} 
```

您可能需要给您的单元格一个（弱或 unsafe_unretained）引用返回到您的表视图委托，以便您可以向委托发送消息。

但是，您不能只依赖`didMoveToWindow`于所有版本的 iOS。在 iOS 6 之前，表格视图总是在重用之前将表格视图单元格作为子视图移除，因此单元格`didMoveToWindow`在被重用之前总是会接收。但是，从 iOS 6 开始，表格视图可以重用单元格*，而无需*将其作为子视图移除。表格视图将简单地更改单元格的框架以将其移动到新位置。这意味着从 iOS 6 开始，一个单元格在被重用之前**并不**总是接收。`didMoveToWindow`

因此，您应该`didMoveToWindow`在您的单元子类和`tableView:didEndDisplayingCell:forRowAtIndexPath:`您的委托中实现这两者，并确保如果两者都被调用，或者只有一个被调用，则它可以工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T21:37:15.730

我最终使用下面的组合来确保逻辑适用于 iOS 5.0 和 6.0

**单元逻辑**

```
@protocol MyCellDelegate
- (void)myCellDidEndDisplaying:(MyCell *)cell;
@end

@implementation MyCell

// Does not work on iOS 6.0
- (void)removeFromSuperview
{
   [super removeFromSuperview];

   [self.delegate myCellDidEndDisplaying:(MyCell *)self];
}

@end 
```

**视图控制器逻辑**

```
@implementation MyViewcontroller

- (void)myCellDidEndDisplaying:(MyCell *)cell
{
   IndexPath *indexPath = [self.tableView indexPatForCell:cell];
   // do stuff
}

// Does not work on iOS below 6.0
- (void)tableView:(UITableView *)tableView didEndDisplayingCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{

}

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T21:17:31.210

```
tableView:didEndDisplayingCell:forRowAtIndexPath: 
```

仅适用于 iOS6 及更高版本。

完成您所追求的一种（尽管很慢）方法是使用 scrollView 委托方法来监视 tableview 何时滚动。从那里调用：

```
NSArray *visiblePaths = [tableView indexPathsForVisibleRows]; 
```

并检查可见路径数组是否有任何更改。

# c# - 输入 3 个日期并在不同的 VIEW 中显示顺序，点击后

> ID：13770904
> 
> 赞同：0
> 
> 时间：2012-12-07T21:00:29.390
> 
> 标签：c#, asp.net, asp.net-mvc-3, html-parsing

嘿伙计们，我正试图将一个项目放在一起以增加我对 MVC3 的了解，但我碰壁了......

因此，从我的索引“视图”中的 HolidaysController，我创建了一个超链接，它将用户导航到“create3”ActionResult

@Html.ActionLink("选择 3 个日期", "Create3")

* * *

在我的 create3 页面中，我希望用户在文本框中输入 3 个日期，当他们单击“创建”时，用户将返回到以前的 HolidaysController/Index 页面，日期将按日期升序显示

....ATM 我一直在工作，直到用户输入 3 个日期并单击“创建”...但是我只知道如何显示一个显示订单的消息框，它正在工作我只需要帮助才能获得订单从索引页面显示。

请看我的代码：

## HolidayController/索引的代码：

```
 //submit will go to post
        [HttpPost]
        public ViewResult Index(int HolidayDate)
        {
            var holidays = db.Holidays.Include("Person");

            HolidayList model = new HolidayList();

            model.currentPersonID = HolidayDate;
            model.PList4DD = db.People.ToList();           
            model.Categories = holidays.Select(x => new SelectListItem
                                            {
                                                Value = x.Id.ToString(),
                                                Text = x.Person.Name
                                            }
                                          );

            int data = HolidayDate;

            model.HList4DD = db.Holidays.Where(h => h.PersonId == HolidayDate).ToList();      

            return View(model);

        }

        [HttpGet]
        public ViewResult Index(string sortOrder, int? currentPersonID)
        {
            var holidays = db.Holidays.Include("Person");

            HolidayList model = new HolidayList();

            //not null
            if (currentPersonID.HasValue)
            {
                model.currentPersonID = currentPersonID.Value;

            }
            else
            {
                model.currentPersonID = 0;
            }

            model.PList4DD = db.People.ToList();

            ViewBag.NameSortParm = String.IsNullOrEmpty(sortOrder) ? "date" : "";
            var dates = from d in db.Holidays
                        where d.PersonId == currentPersonID.Value
                        select d;

            switch (sortOrder)
            {
                case "date":
                    dates = dates.OrderBy(p => p.HolidayDate);
                    break;
            }

            model.HList4DD = dates.ToList();

            return View(model);
        } 
```

* * *

```
//View for Index

@*@model IEnumerable<HolidayBookingApp.Models.Holiday>*@
@model HolidayBookingApp.Models.HolidayList
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<p>
@Html.ActionLink("Select 3 Dates", "Create3")
</p>

<table>
    <tr>
        <th>
            PersonId
        </th>
        <th>
            @*HolidayDate*@
            @Html.ActionLink("HolidayDate", "Index", new { sortOrder = ViewBag.NameSortParm, currentPersonID = Model.currentPersonID })
        </th>
        <th></th>
    </tr>
    <tr>  
    </tr>

@foreach (var item in Model.HList4DD)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.PersonId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.HolidayDate)

        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
        </td>
    </tr>}

    <tr>
      <div class="editor-label">
         @*   @Html.LabelFor(model => model.PList4DD, "Person")*@
        </div>

        <div class="editor-field">           
             &lt;form action ="/Holidays/Index" id="some" method="post"> 

  @Html.DropDownListFor(model => model.HList4DD.First().HolidayDate, new SelectList(Model.PList4DD, "Id", "Name", Model.currentPersonID), "--select--")    
       &lt;script>
           function updateFormEnabled() 
           {
               if (verifyAdSettings()) 
               {
                   $('#sbmt').removeAttr('disabled');
               }
               else 
               {
                   $('#sbmt').attr('disabled', 'disabled');
               }
           }

           function verifyAdSettings() 
           {
               if ($('#HolidayDate').val() != '') 
               {
                   return true;
               }
               else 
               {
                   return false;
               }
           }

           $('#HolidayDate').change(updateFormEnabled);

           &lt;/script>

             &lt;input type="submit" id= "sbmt" name="ViewHolidaysDD" value="View"/>
              &lt;/form>
  &lt;script>
      $('#sbmt').attr('disabled', '');
        &lt;/script>

        </div>

</table>

<br />
<br />
<table>
    <div>
    Judging by your selection the order of dates are: //HERE IS WHERE I WANT TO DISPLAY THE ORDER OF DATES
    </div>

</table> 
```

## 就在上面是我想按顺序显示日期的地方，升序

```
//my create 3 Action result

 [HttpGet]
        public ActionResult Create3()
        {
            return View();
        }

        [HttpPost]
        public ActionResult Create3(string date1, string date2, string date3)
        {
            string FirstDateOrder, SecondDateOrder, ThirdDateOrder;

            //date 1 is biggest
            if (date1.Length > date2.Length && date1.Length > date3.Length)
            {
                //date 2 is 2nd & date 3 is 3rd
                if (date2.Length > date3.Length)
                {
                    FirstDateOrder = date1;
                    SecondDateOrder = date2;
                    ThirdDateOrder = date3;

                    System.Windows.Forms.MessageBox.Show("Order is 1, 2, 3");

                    return RedirectToAction("Index");
                }

                //date 3 is 2nd & date 2 is 3rd
                else
                {
                    FirstDateOrder = date1;
                    SecondDateOrder = date3;
                    ThirdDateOrder = date2;

                    System.Windows.Forms.MessageBox.Show("Order is 1, 3, 2");

                    return RedirectToAction("Index");
                }

            }

            //date 2 is biggest
            if (date2.Length > date1.Length && date2.Length > date3.Length)
            {
                //date 1 is 2nd & date 3 is 3rd
                if (date1.Length > date3.Length)
                {
                    FirstDateOrder = date2;
                    SecondDateOrder = date1;
                    ThirdDateOrder = date3;

                    System.Windows.Forms.MessageBox.Show("Order is 2, 1, 3");

                    return RedirectToAction("Index");
                }

                //date 3 is 2nd & date 1 is 3rd
                else
                {
                    FirstDateOrder = date2;
                    SecondDateOrder = date3;
                    ThirdDateOrder = date1;

                    System.Windows.Forms.MessageBox.Show("Order is 2, 3, 1");

                    return RedirectToAction("Index");
                }

            }

            //date 3 is biggest
            if (date3.Length > date1.Length && date3.Length > date2.Length)
            {
                //date 1 is 2nd & date 2 is 3rd
                if (date1.Length > date2.Length)
                {
                    FirstDateOrder = date3;
                    SecondDateOrder = date1;
                    ThirdDateOrder = date2;

                    System.Windows.Forms.MessageBox.Show("Order is 3, 1, 2");

                    return RedirectToAction("Index");
                }

                //date 2 is 2nd & date 1 is 3rd
                else
                {
                    FirstDateOrder = date3;
                    SecondDateOrder = date2;
                    ThirdDateOrder = date1;

                    System.Windows.Forms.MessageBox.Show("Order is 3, 2, 1");

                    return RedirectToAction("Index");
                }

            }

            return RedirectToAction("Index"); 
```

## }

```
and my view:

    @model HolidayBookingApp.Models.Dates

@{
    ViewBag.Title = "Create3";
}

<h2>Create3</h2>

&lt;script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript">&lt;/script>
&lt;script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript">&lt;/script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Dates</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.date1)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.date1)
            @Html.ValidationMessageFor(model => model.date1)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.date2)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.date2)
            @Html.ValidationMessageFor(model => model.date2)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.date3)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.date3)
            @Html.ValidationMessageFor(model => model.date3)
        </div>

        <p>
            &lt;input type="submit" value="Create" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>"Index")

</div> 
```

* * *

不确定从这里去哪里，比如在索引视图中创建一个拉过订单的参数？

任何帮助都会非常感谢你们，对这篇文章感到抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:15:25.947

还有其他更优雅的方法可以做到这一点，但最简单的方法可能是使用 ViewBag。而不是：

```
System.Windows.Forms.MessageBox.Show("Order is 3, 1, 2"); 
```

尝试这样的事情：

```
ViewBag.DateOrder = "Order is 3, 1, 2"; 
```

然后在您的视图中简单地说：

```
<span>@ViewBag.DateOrder</span> 
```

# php - 重定向时出错

> ID：13770906
> 
> 赞同：0
> 
> 时间：2012-12-07T21:00:32.317
> 
> 标签：php, redirect

> **可能重复：**
> [PHP 中的“警告：标头已发送”](https://stackoverflow.com/questions/8028957/warning-headers-already-sent-in-php)

我有一个 php 页面，当我填写提交的电子邮件并按 Enter 时，它在发送邮件后连接到此页面中的 mail.php，我想返回我原来的页面，但它给了我这个错误：

警告：无法修改标头信息 - 第 15 行 /home/mysite/public_html/users/teachers/mail.php 中的标头（输出开始于 /home/mysite/public_html/users/teachers/mail.php:3）

这是 mail.php 代码：

```
<html>
<body>

<?php

$email = $_GET['email'] ;

$subject =$_GET['author'] ;

$message = $_GET['text'] ;

$to = "mail@mail.com";

$from = $email;

$headers = "From:" . $from;

mail($to,$subject,$message,$headers,$from);

?> 

    <script language="javascript">

alert('your mail has sent !');</script>

<?php

header('location:../teachers/index.php');

?>

</body>

</html> 
```

我该怎么办 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:04:32.623

在 HTTP 中，响应分为两部分：标头和正文。它们由双换行符分隔。

通过`<html><body>`在 mail.php 脚本的顶部打印，您有效地告诉 PHP 您已完成标题并准备好输出。由于 PHP 将信息发回给 Apache，它已经发回了完整的标头集（它需要，因为您现在已经开始发送实际的响应正文）。

你有两个选择：

*   在您的 PHP 安装中启用输出缓冲（然后 PHP 将缓冲响应正文，直到脚本执行结束或直到您显式调用其中一种`ob*end()`方法。
*   更改您的页面以发送电子邮件，然后在将任何输出打印到浏览器之前重定向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:04:00.740

停止在需要重定向的页面上发送任何内容。

你的代码应该是这样的

```
<?php

$email = $_GET['email'] ;

$subject =$_GET['author'] ;

$message = $_GET['text'] ;

$to = "mail@mail.com";

$from = $email;

$headers = "From:" . $from;

mail($to,$subject,$message,$headers,$from);

header('location:../teachers/index.php');

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:03:15.670

你的代码中有一些东西会写入输出缓冲区。重定向必须在任何输出写入输出缓冲区之前完成。

这不起作用：

```
<?php
echo 'bla';
header('Location: index.php'); 
```

这将起作用：

```
<?php
header('Location: index.php'); 
```

# facebook - Facebook 描述在 Recommend 不起作用

> ID：13770909
> 
> 赞同：4
> 
> 时间：2012-12-07T21:00:37.837
> 
> 标签：facebook, facebook-graph-api, facebook-like, facebook-opengraph

我有这个问题： 为 facebook 正确配置的页面：

```
    <html xmlns:og="http://ogp.me/ns#"  
        xmlns:fb="https://www.facebook.com/2008/fbml">

```

（我也试过：）

```
    <html xmlns:og="http://ogp.me/ns#"  
        xmlns:fb="http://ogp.me/ns/facebook#">

```

（和其他一些人）

在头部，对应的OG代码：app_id、url、type、title、image、description、site_name。

然后，在页面中，点赞按钮：

```
    <fb:like href="##my_url##" send="false" layout="button_count" show-faces="false" action="recommend"></fb:like>

```

但是，当按下按钮并发送表单时，在 Facebook 中，它看起来像：

```
    No hay ninguna descripción disponible para esta frase
    No hay ninguna descripción disponible para esta frase
    No hay ninguna descripción disponible para esta frase
    No hay ninguna descripción disponible para esta frase

```

在描述中...（西班牙语帐户）。标题和图片，完全没有问题。[我已经使用Debug Page](https://developers.facebook.com/tools/debug)测试了 URL ，但没有收到任何错误，并且它正确读取了描述。

**更新：** 我已经制作了一个只有基本内容的测试页面，但我得到了相同的结果： http: [//www.cooperativa.cl/noticias/mundo/test-facebook/2012-12-11/160015.html](http://www.cooperativa.cl/noticias/mundo/test-facebook/2012-12-11/160015.html)

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T06:55:36.363

I'm from Argentina, and I've found this happens if I use Facebook in Spanish language [es_LA], but if I use it in Spanish (Spain) [es_ES] the post shows correctly.

The weird thing is that on my website (I have this problem too on my website) I'm using the JS SDK in es_LA and not in es_ES.

Obviously, if you use Facebook un English the post will show correctly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T13:13:51.253

在带有描述的html头中添加元标记

```
 <meta property="og:description"  content="Bla bla bla " /> 
```

# php - 使用 CURL 发送自定义标头

> ID：13770910
> 
> 赞同：12
> 
> 时间：2012-12-07T21:00:41.550
> 
> 标签：php, xml, api, curl, header

我想通过如下所示的 API 向 Web 服务发送请求，我必须传递自定义 http 标头（哈希），我正在使用 CURL，我的代码似乎可以工作，但我没有得到正确的响应，我被告知它与哈希值有关，尽管该值被认为是正确的，但我传递它的方式或代码本身是否有任何问题。

```
 <?php
    $ttime=time();
    $hash="123"."$ttime"."dfryhmn";
    $hash=hash("sha512","$hash");
    $curl = curl_init();
    curl_setopt($curl,CURLOPT_HTTPHEADER,array('Hash:$hash'));      
    curl_setopt ($curl, CURLOPT_URL, 'http://web-service-api.com/getresult.xml?clientid=456&time=$ttime');  
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);  
    $xml = curl_exec ($curl);  

    if ($xml === false) {
        die('Error fetching data: ' . curl_error($curl));  
    }
    curl_close ($xml);  

    echo htmlspecialchars("$xml", ENT_QUOTES);

    ?> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-10-25T07:27:32.083

如果您需要在 php 中获取和设置自定义 http 标头，以下简短教程非常有用：

**发送请求标头**

```
$uri = 'http://localhost/http.php';
$ch = curl_init($uri);
curl_setopt_array($ch, array(
    CURLOPT_HTTPHEADER  => array('X-User: admin', 'X-Authorization: 123456'),
    CURLOPT_RETURNTRANSFER  =>true,
    CURLOPT_VERBOSE     => 1
));
$out = curl_exec($ch);
curl_close($ch);
// echo response output
echo $out; 
```

**读取自定义标题**

```
print_r(apache_request_headers()); 
```

你应该看到

```
Array
(
    [Host] => localhost
    [Accept] => */*
    [X-User] => admin
    [X-Authorization] => 123456
    [Content-Length] => 9
    [Content-Type] => application/x-www-form-urlencoded
) 
```

**使用 PHP CGI 的自定义标头**

在.htaccess

```
RewriteEngine On
RewriteRule .? - [E=User:%{HTTP:X-User}, E=Authorization:%{HTTP:X-Authorization}] 
```

**从 $_SERVER 读取自定义标头**

```
echo $_SERVER['User'];    
echo $_SERVER['Authorization']; 
```

**资源**

*   [http://www.omaroid.com/php-get-and-set-custom-http-headers/](http://www.omaroid.com/php-get-and-set-custom-http-headers/)
*   [如何让 PHP 显示它从浏览器收到的标头？](https://stackoverflow.com/questions/1403670/how-can-i-get-php-do-display-the-headers-it-recieved-from-a-browser)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-07T21:04:35.000

`'Hash:$hash'`应该是`"Hash: $hash"`（双引号）或`'Hash: '.$hash`

传入的 URL 也是如此`CURLOPT_URL`

# list - F# 联合类型列表

> ID：13770911
> 
> 赞同：5
> 
> 时间：2012-12-07T21:00:46.803
> 
> 标签：list, f#, discriminated-union

我想要一份报告清单。报告可以是详细信息或部分类型。

```
module Data

type Section = { Header: string;
                 Lines:  string list;
                 Total:  string }

type Detail = { State:     string;
                Divisions: string list;
                Sections:  Section list }

type Summary = { State:    string;
                 Office:   string;
                 Sections: Section list }

type Report = Detail | Summary 
```

然后在我的代码中，我想做以下事情：

```
let mutable (reports:Report list) = []

...

reports <- detail::reports
// or
reports <- summary::reports 
```

编译器在第一种情况下抱怨：“表达式应该具有报告类型，但这里有详细类型”，并且在第二种情况下适当地类似。

我是不是因为想做这样的事情而发疯了？我应该以不同的方式思考这个问题吗？因为报告是详细信息或摘要，报告列表不应该接受详细信息或摘要吗？如果不是详细信息或摘要列表，那么报告列表是什么？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T21:13:27.950

你的语法有点错误：

```
type Report = Detail of Detail | Summary of Summary

reports <- (Detail detail)::reports
// or
reports <- (Summary summary)::reports 
```

在您的代码中，您基本上只是将`Report`类型定义为具有两个可能值的枚举，`Details`或者`Summary`（这些就像标签，而不是在这种情况下不同子类型的类型）。F# 中的可区分联合是显式标记的，因此您还必须使用联合构造函数之一来创建要放入列表的实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T21:17:07.710

您需要将`Report`类型更改为：

```
type Report = Detail of Detail | Summary of Summary 
```

因为您当前的定义只是命名了 Report 类型的两种情况，而这些名称与现有的`Detail`和`Summary`类型无关。

然后，您可以使用例如过滤`Detail`and`Summary`元素`List.choose`

```
let details = reports |> List.choose (function Detail(d) -> Some(d) | _ -> None) 
```

# php - 我需要为 PHP MYSQL 表的 TR 分配一个 unqiue 类

> ID：13770912
> 
> 赞同：1
> 
> 时间：2012-12-07T21:00:57.610
> 
> 标签：php, css, mysql, html-table

我怎样才能分配一个唯一的类 id，`<tr>` 即使我刷新时，id 也需要保持不变，因为我将使用它们来设置表格的样式。

这是我正在使用的代码：

```
while($row = mysql_fetch_array($result2))
  {
echo "<tr id='centered' class='";  echo "'";   
echo "<td>" . $row['Year_9'] . "</td>";
echo "<td>" . $row['Year_8'] . "</td>";
echo "<td>" . $row['Year_7'] . "</td>";
echo "<td>" . $row['Year_6'] . "</td>";
echo "<td>" . $row['Year_5'] . "</td>";
echo "<td>" . $row['Year_4'] . "</td>";
echo "<td>" . $row['Year_3'] . "</td>";
echo "<td>" . $row['Year_2'] . "</td>";
echo "<td>" . $row['Year_1'] . "</td>";
echo "<td>" . $row['Year_0'] . "</td>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:10:33.117

也许使用具有多值类的计数器？

```
$i = 1;

while($row = mysql_fetch_array($result2))
{
    $secondClass = 'abc' + $i;

    echo "<tr id='centered' class='firstClass $secondClass'>";
    ...
    $i++;
} 
```

# jquery - 回发后调用登录屏幕javascript？

> ID：13770915
> 
> 赞同：0
> 
> 时间：2012-12-07T21:01:13.467
> 
> 标签：jquery, asp.net-mvc-4, asp.net-mvc-3, jquery-events

在我的第一个 MVC 4 应用程序上工作，但我的登录屏幕有问题。它是针对在生产车间拥有普通 PC 的公司的 Intranet 应用程序，因此他们需要能够单独登录该应用程序。（该网站也在 jQuery mobile 中，并且有一个 Javascript 触摸键盘，但我认为他们不需要参与这个问题）

问题是，如果有人无法登录，设置它的 Javascript 代码使得在用户名字段中输入按键将焦点发送到密码字段将停止工作。

我有一个可行的技巧（使用 setTimeout，100），但它让我感到恶心和肮脏。

这是我的登录表单：

```
@ModelType FAToolAdmin.LogOnModel

@Code
    ViewData("Title") = "Log In"
End Code

@Using Html.BeginForm()
    @<div class="content-primary">

        <div data-role="header" data-position="fixed" data-theme="b">
            <h2>Account Info</h2>
        </div>

        <fieldset>
            <div class="editor-label">
                @Html.LabelFor(Function(m) m.UserName)
            </div>

            <div class="editor-field">
                @Html.EditorFor(Function(m) m.UserName)               
            </div>

            <div class="editor-label">
                @Html.LabelFor(Function(m) m.Password)
            </div>

            <div class="editor-field">
                @Html.EditorFor(Function(m) m.Password)
            </div>

            <p>
                <input type="submit" value="Log In" class="notfocus"/>
            </p>

            @* This Html.ValidationSummary will show a ul element containing any login errors that were returned.  
                The call here has been edited to send an empty string, because sending 2 lines of text regarding 
                a login failure is a little excessive.  You failed to login.  Type everything again and move on 
                with your day.*@

            @Html.ValidationSummary(True, "")

        </fieldset>
    </div>

End Using

<script type="text/javascript">

    //This is the script that adds the keyboards to the screen.

    $(function () {
        //setTimeout(function () {

            //This is the script that makes it so that when the enter button is pressed on the screen that the 
            //focus is changed to the password box (rather than having the form be submitted).

            // set the focus to the UserName field and select all contents
            $('#UserName').focus().select();
            // bind the keypress event on the UserName field to this little piece of code here
            var $inp = $('#UserName');
            $inp.bind('keydown', function (e) {
                var key = e.which;
                // if this is keycode 13 (enter), then prevent the default form behavior and change focus to the Password box.
                if (key == 13) {
                    e.preventDefault();
                    // find the Password input box and set the focus to it.
                    $('#Password').focus();
                }
            });
        //}, 100);
    });

</script> 
```

这是我的控制器：

```
Imports System.Diagnostics.CodeAnalysis
Imports System.Security.Principal
Imports System.Web.Routing

Public Class AccountController
    Inherits System.Web.Mvc.Controller

    ' GET: /Account/LogOn
    <AllowAnonymous()>
    Public Function LogOn() As ActionResult
        Dim model As New LogOnModel
        Return View(model)
    End Function

    '
    ' POST: /Account/LogOn
    <AllowAnonymous()>
    <HttpPost()>
    Public Function LogOn(ByVal model As LogOnModel, ByVal returnUrl As String) As ActionResult
        Try
            If ModelState.IsValid Then

                If Membership.ValidateUser(model.UserName, model.Password) Then

                    FormsAuthentication.SetAuthCookie(model.UserName, False)
                    If Url.IsLocalUrl(returnUrl) AndAlso returnUrl.Length > 1 AndAlso returnUrl.StartsWith("/") _
                       AndAlso Not returnUrl.StartsWith("//") AndAlso Not returnUrl.StartsWith("/\\") Then
                        Return Redirect(returnUrl)
                    Else
                        Return RedirectToAction("Index", "Home")
                    End If
                Else
                    ModelState.AddModelError("", "The user name or password provided is incorrect.")
                End If
            Else
                ' if you just click on login without ever having entered anything into the username and password fields, you'll get this message.
                ModelState.AddModelError("", "Please enter a valid user name and password.")
            End If

        Catch ex As Exception
            MsgBox(ex.Message)

        End Try

        ' If we got this far, something failed, redisplay form
        Return View(model)

    End Function

    '
    ' GET: /Account/LogOff
    <AllowAnonymous()>
    Public Function LogOff() As ActionResult
        FormsAuthentication.SignOut()
        Session.Abandon()
        Return (RedirectToAction("Index", "Home"))
    End Function

End Class 
```

和型号：

```
Public Class LogOnModel

    <Required()> _
    <Display(Name:="SomeCompany Username")> _
    Public Property UserName() As String

    <Required()> _
    <DataType(DataType.Password)> _
    <Display(Name:="Password")> _
    Public Property Password() As String

End Class 
```

所以我的问题是，我该如何设置它，以便将输入错误用户名（并因此触发`ModelState.AddModelError`and `Return View(model)`）的人发送回已加载 enter press 脚本的页面版本？

我觉得我错过了一些基本的东西。感谢有人可以提供的任何帮助。否则，`setTimeout`它是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:13:32.907

我认为 jQueryMobile 可能是您的问题 - jqm 默认使用 ajax 提交所有表单，因此您没有得到完整的回发。我遇到了类似的问题，这就是根本原因。

尝试使用重载`Html.BeginForm`并添加`new {data_ajax="false"}`到 HttpAttributes

# excel - 在参考中使用 TREND 时 Excel OFFSET 函数错误

> ID：13770919
> 
> 赞同：0
> 
> 时间：2012-12-07T21:01:36.077
> 
> 标签：excel, excel-formula, offset, named-ranges, trend

考虑具有以下值的 Excel 工作表：

```
 A   B
 --------
1| 1   5
2| 2   8
3| 3  11 
```

正如预期的那样，`=TREND(B1:B3,A1:A3,A1:A3)`在单元格 C1:C3 中输入数组公式会返回 。`{5;8;11}`输入`=OFFSET(C1:C3,1,0)`return `{8;11;0}`，也符合预期。

但是，如果我尝试输入`=ROWS(OFFSET(TREND(B1:B3,A1:A3,A1:A3),1,0))`，我会收到消息“您键入的公式包含错误”。我不能做任何事情让它接受这个公式。

`=Sheet1!$C$1:$C$3`接下来，我分别用公式和创建了命名范围“TrendRange”和“TrendFormula” `=TREND(Sheet1!$B$1:$B$3,Sheet1!$A$1:$A$3,Sheet1!$A$1:$A$3)`。

再次，`=OFFSET(TrendRange,1,0)`给出正确的结果，但`=OFFSET(TrendFormula,1,0)`没有（结果为`#VALUE!`）。

有一个简单的测试似乎总能确定 OFFSET 何时会出现此问题。如果`=CELL("address", xxx)`或`=AREAS(xxx)`结果为`#VALUE!`，则 xxx 部分不能用于 OFFSET。

有没有办法解决？我尝试使用 LINEST 和 SLOPE/INTERCEPT 而不是 TREND，但我得到了相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:40:21.567

OFFSET 需要一个**引用**（一个单元格或一个范围作为第一个参数），它不会接受一个数组，所以因为像这样的公式

`=TREND(B1:B3,A1:A3,A1:A3)`

总是返回一个数组，你不能用它作为OFFSET的第一个参数。这与您之前的问题有关吗？

# wcf - 向 Oracle Advanced Queuing Notification11g 注册 WCF 服务

> ID：13770921
> 
> 赞同：1
> 
> 时间：2012-12-07T21:01:42.350
> 
> 标签：wcf, oracle, notifications

我编写了一个 WCF 服务，当被调用时，它将使 Oracle 数据库中的项目出列。是否可以注册 ac#.Net WCF 服务以在项目入队时得到通知？

从文档（特别与 9i 相关）中，我知道可以注册 HTTP servlet（[在此处](http://docs.oracle.com/cd/A91202_01/901_doc/appdev.901/a88890/adq08qap6.htm)找到文档）

```
sys.aq$_reg_info('WS.WS_BOOKEDORDERS_QUE:BOOKED_ORDERS', 
                      DBMS_AQ.NAMESPACE_AQ, 
                      'http://xyz.oracle.com/servlets/NotifyServlet', 
                        HEXTORAW('FF')); 
```

但我还没有在 WCF 和注册通知上找到任何东西？

# html - div内的表溢出

> ID：13770928
> 
> 赞同：4
> 
> 时间：2012-12-07T21:02:02.663
> 
> 标签：html, css, css-tables

我有一个非常基本的 CSS 问题。我有一个固定高度的 div，我在那个 div 里面有一个表格。

除非 div 有滚动条，否则表格的内容将不适合 div。现在的问题是，表格的内容溢出了 div，因为它的高度超过了我在 div 上设置的高度。

这就是我为 Div 所拥有的

```
 display: inline-block;
    float: left;
    max-height: 200px; 
```

这是一个例子。

[jsfiddle](http://jsfiddle.net/LNS26/58/)

如何让表格适合 div 并具有滚动条？这并不特定于任何浏览器。我自己在 Chrome 和 IE 中都试过了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T21:04:18.993

[**编辑**]引用您的请求：

> 如何让表格适合 div**并有一个滚动条**。

将以下内容添加到`.test`（[小提琴](http://jsfiddle.net/LNS26/60/)）

```
overflow-y:scroll; 
```

文档[`overflow-y`](http://www.w3.org/TR/css3-box/#overflow-y)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:04:38.380

```
.test {
  background-color: gray;
  display: inline-block;
  float: left;
  max-height: 200px;
  overflow-y: scroll;
}
.matrix td, .matrix th{
  border: 0.1em solid #E2E2E2;
  padding: 4px 2px;
  min-width: 65px;
  white-space: normal;
  text-align: center;
} 
```

# windows-8 - 是否有可通过 WinRT 获得的设备信息的完整列表？

> ID：13770934
> 
> 赞同：1
> 
> 时间：2012-12-07T21:02:24.347
> 
> 标签：windows-8, windows-runtime

我想了解有关该设备的一些事情。是ARM还是英特尔？支持蓝牙吗？用户运行的是什么版本的 Windows？设备的分辨率是多少？设备的IP是多少。像这样的东西。而且，我知道并非一切都可用。是否有一个完整的列表（甚至是演示）来显示可用的信息，而不是针对每个信息数据提出问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T23:36:00.773

您可以使用 DeviceInformation.FindAllAsync() 列出相机、麦克风、音频输出设备和外部存储。对于 Accelerometer，我认为您需要在尝试使用异常时捕获异常。我怀疑是否需要检查 ARM/Intel 或 Windows 版本，尽管您可以为 ARM/Intel 编译单独的构建并使用#defines 来检查差异。对于屏幕分辨率，我会使用 Window.Current.Bounds 之类的东西（假设您处于完整模式）。IP，蓝牙可能是您可以在他们自己的堆栈中检查的东西（从不需要这些，所以不确定在哪里）。我还没有看到展示所有这些的演示，但这听起来像是值得添加到工具包中的东西......

# jquery - 使用 Twitter Bootstrap、JQuery 和 VB 显示数据表

> ID：13770937
> 
> 赞同：0
> 
> 时间：2012-12-07T21:02:28.710
> 
> 标签：jquery, vb.net, twitter-bootstrap

我正在尝试在 Twitter 引导布局中显示数据表。当我运行相同的代码、调用相同的函数时，它会返回一个数据表并按照我的预期将其显示在页面上。但是，当我将相同的代码带入 TwitterBootstrap 时，它不会显示它。Twitterbootstrap 中有什么不同的东西会阻止它显示表格吗？这是我的代码：

```
 $('#TableHere').html( '<table cellpadding="0" cellspacing="0" border="0" class="display" id="example"></table>' )
    $('#example').dataTable( {
     <%= returnWeeklyTable() %> 
```

然后在包含调用的页面上。代码前半部分的饼图正在显示。

```
<form id="form1" runat="server">
    <div class="container-fluid">
        <asp:DropDownList ID="SelectComponent" runat="server">
        </asp:DropDownList>
        <div class="row-fluid">
        </div>
    </div>
    <div class="container-fluid">
        <div class="row-fluid">
            <a href="#pieChart" class="block-heading" data-toggle="collapse">Browser Usage</a>
            <div id="pieChart" class="block-body collapse in">
                <div>
                    <div id="container" style="min-width: 400px; height: 400px; margin: 0 auto">
                    </div>
                </div>
            </div>
        </div>
        <div class="row-fluid">
            <div class="row-fluid">
                <a href="#bTable" class="block-heading" data-toggle="collapse">Browser User Agent Table</a>
                <div id="bTable" class="block-body collapse in">
                    <div id="TableHere" runat="server">
                    </div>
                </div>
            </div>
        </div>
    </div>
</form> 
```

当页面被执行时，这就是 HTML 部分中显示的内容：

```
<div id="TableHere">
    <table id="example" class="display" cellspacing="0" cellpadding="0" border="0"></table>
</div> 
```

这是javascript部分：

```
$('#demo').html('<table cellpadding="0" cellspacing="0" border="0" class="display" id="example"></table>');
$('#example').dataTable({
    "aaData": [
        ['Internet Explorer', '8.0', '14038'],
        ['Andriod', '2.3.7', '20'],
        ['Safari', '4.1', '18'],
        ['BlackBerry Browser', 'Unknown', '16'],
        ['Safari', '4.0', '12'],
        ['Mobile Safari', '7.0', '10'],
        ['Chrome', '17.0', '6'],
        ['Firefox', '5.0', '4'],
        ['Firefox', '2.0', '2'],
        ['Opera', '12.10', '2']
    ],
    "aoColumns": [
        {"sTitle": "Browser Name"},
        {"sTitle": "Browser Version"},
        {"sTitle": "Total"}
    ]
}); 
```

那么，据我所知，VB 正在执行并正确执行？当我将代码放入 jsBin 示例时，我的 javascript 会显示吗？所以我能做出的唯一结论是引导程序中的某些东西是停止它？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T14:19:20.590

我认为您的问题不是源于使用引导程序和数据表。我做了一个 jsbin 来测试它，并且能够让你的代码得到简化，因为它没有 asp，可以毫无问题地执行。

[http://jsbin.com/elixor/1/edit](http://jsbin.com/elixor/1/edit)

下面是我使用的代码。

```
<script src="http://code.jquery.com/jquery.min.js"></script>
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet" type="text/css" />
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap.js"></script>
<link href="http://www.datatables.net/release-datatables/media/css/demo_table.css" rel="stylesheet" type="text/css">
<script src="http://www.datatables.net/release-datatables/media/js/jquery.dataTables.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready
    (
            function ()
            {
                $('#TableHere').html( '<table cellpadding="0" cellspacing="0" border="0" class="display" id="example"></table>' );
                $('#demo').html('<table cellpadding="0" cellspacing="0" border="0" class="display" id="example"></table>');
                $('#example').dataTable({
                    "aaData": [
                        ['Internet Explorer', '8.0', '14038'],
                        ['Andriod', '2.3.7', '20'],
                        ['Safari', '4.1', '18'],
                        ['BlackBerry Browser', 'Unknown', '16'],
                        ['Safari', '4.0', '12'],
                        ['Mobile Safari', '7.0', '10'],
                        ['Chrome', '17.0', '6'],
                        ['Firefox', '5.0', '4'],
                        ['Firefox', '2.0', '2'],
                        ['Opera', '12.10', '2']
                    ],
                    "aoColumns": [
                        {"sTitle": "Browser Name"},
                        {"sTitle": "Browser Version"},
                        {"sTitle": "Total"}
                    ]
                });

            }
    );
</script>
<div class="container-fluid">
    <div class="row-fluid">
        <div class="row-fluid">
            <a href="#bTable" class="block-heading" data-toggle="collapse">Browser User Agent Table</a>
            <div id="bTable" class="block-body collapse in">
                <div id="TableHere">
                </div>
            </div>
        </div>
    </div>
</div> 
```

也只是为了您的信息，如果您正在寻找该功能，我已成功使用 Knockout 隐藏和显示数据表。

# postgresql - 如何在 Postgresql 命令行中指定要运行 sql 文件的架构

> ID：13770944
> 
> 赞同：74
> 
> 时间：2012-12-07T21:02:50.590
> 
> 标签：postgresql

我像这样对我的数据库运行脚本......

```
psql -d myDataBase -a -f myInsertFile.sql 
```

唯一的问题是我希望能够在此命令中指定运行脚本的模式。我可以调用 set search_path='my_schema_01' 但文件应该是可移植的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-12-07T21:06:30.937

您可以创建一个包含该`set schema ...`语句的文件，然后包含您要运行的实际文件：

创建一个文件`run_insert.sql`：

```
set schema 'my_schema_01';
\i myInsertFile.sql 
```

然后使用：

```
psql -d myDataBase -a -f run_insert.sql 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2014-07-29T11:25:00.190

More universal way is to set search_path (should work in PostgreSQL 7.x and above):

```
SET search_path TO myschema; 
```

Note that `set schema myschema` is an alias to above command that is **not** available in 8.x.

See also: [http://www.postgresql.org/docs/9.3/static/ddl-schemas.html](http://www.postgresql.org/docs/9.3/static/ddl-schemas.html)

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2016-02-11T18:32:12.893

**主要示例**

下面的示例将使用模式*myschema*在数据库*mydatabase上运行**myfile.sql*。

 **```
psql "dbname=mydatabase options=--search_path=myschema" -a -f myfile.sql 
```

其工作方式是[psql](http://www.postgresql.org/docs/current/static/app-psql.html)命令的第一个参数是*dbname*参数。文档提到可以提供[连接字符串。](http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-CONNSTRING)

> 如果此参数包含 = 符号或以有效的 URI 前缀（postgresql:// 或 postgres://）开头，则将其视为 conninfo 字符串

[dbname 关键字](http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-PARAMKEYWORDS)指定要连接的数据库，options[关键字](http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-PARAMKEYWORDS)允许您指定在连接启动时发送到服务器的命令行选项。这些选项在[服务器配置一章](http://www.postgresql.org/docs/current/static/runtime-config.html)中有详细说明。我们用来选择模式的选项是[search_path](http://www.postgresql.org/docs/current/static/runtime-config-client.html)。

**另一个例子**

下面的示例将使用模式*myschema*连接到数据库*mydatabase*上的主机*myhost*。特殊字符必须使用转义序列进行 url转义。**`=``%3D`**

 **```
psql postgres://myuser@myhost?options=--search_path%3Dmyschema 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-01-07T10:48:57.520

`PGOPTIONS`环境变量可用于以灵活的方式实现这一点。

在 Unix shell 中：

```
PGOPTIONS="--search_path=my_schema_01" psql -d myDataBase -a -f myInsertFile.sql 
```

如果脚本或子 shell 中有多个调用需要相同的选项，则只需设置`PGOPTIONS`一次并导出它会更简单。

```
PGOPTIONS="--search_path=my_schema_01"
export PGOPTIONS

psql -d somebase
psql -d someotherbase
... 
```

`PGOPTIONS`或从外部调用顶级 shell 脚本

```
PGOPTIONS="--search_path=my_schema_01"  ./my-upgrade-script.sh 
```

在 Windows CMD 环境下，`set PGOPTIONS=value`应该是一样的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-21T11:48:45.687

我正在使用这样的东西并且效果很好：* :-)

```
(echo "set schema 'acme';" ; \
  cat ~/git/soluvas-framework/schedule/src/main/resources/org/soluvas/schedule/tables_postgres.sql) \
  | psql -Upostgres -hlocalhost quikdo_app_dev 
```

**注意：**仅限 Linux/Mac/Bash，尽管在 Windows/PowerShell 中也可能有办法做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-02T09:13:30.770

这对我有用：

```
psql postgresql://myuser:password@myhost/my_db -f myInsertFile.sql 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-23T17:22:16.453

就我而言，我想动态地将模式添加到文件中，这样无论用户从 cli 提供什么模式名称，我都将使用提供的模式名称运行 sql 文件。为此，我替换了 sql 文件中的一些文本。首先我`{{schema}}`像这样在文件中添加

```
CREATE OR REPLACE FUNCTION {{schema}}.usp_dailygaintablereportdata( 
```

然后在命令`{{schema}}`的帮助下用用户提供的模式名称动态替换`sed`

```
sed -i "s/{{schema}}/$pgSchemaName/" $filename
result=$(psql -U $user -h $host -p $port -d $dbName -f "$filename" 2>&1)
sed -i "s/$pgSchemaName/{{schema}}/" $filename 
```

首先替换完成，然后运行目标文件，然后我们的替换再次恢复

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2014-11-05T11:13:23.893

我在尝试在中间模式上进行一些 dat 导入时遇到了类似的问题（稍后我们将进入最后一个模式）。由于我们依赖于扩展（例如 PostGIS）之类的东西，“run_insert”sql 文件并没有完全解决问题。

一段时间后，我们发现至少使用 Postgres 9.3 解决方案要容易得多……只需创建 SQL 脚本**，在引用表时始终指定架构**：

`CREATE TABLE "my_schema"."my_table" (...); COPY "my_schema"."my_table" (...) FROM stdin;`

这种方式使用`psql -f xxxxx` 效果很好，您不需要更改 search_paths 也不需要使用中间文件（并且不会遇到扩展架构问题）。****

# python - 如何实际下载附件？

> ID：13770947
> 
> 赞同：4
> 
> 时间：2012-12-07T21:03:01.243
> 
> 标签：python, python-2.7, urllib2

我正在使用 urllib2 来（尝试）从网站下载文件。该文件只能在指定某些表单字段后才能下载。我可以毫无问题地创建请求并获得响应，如下所示：

```
req = urllib2.Request(url, data, headers)
response = urllib2.urlopen(req) 
```

当我查看这样的响应标头时`print response.info()['Content-Disposition']`，我看到了那里的文件，即它打印出类似`attachment;filename=myfile.txt`

但是我如何实际*下载*附件？如果我这样做，`response.read()`我只会在 url 处得到一个包含页面 HTML 的字符串。关键是 url 不是一个文件，它是一个带有“附件”的网页，我正在尝试使用 urllib2 下载该附件。我相信附件是动态生成的，所以它不只是坐在服务器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T03:02:55.740

问题是我没有发送所有必要的标题。特别是，在请求标头中发送正确的 cookie 非常重要。我做了以下事情：

1.  打开 Chromium（或 Chrome）并按 Ctrl+Shift+I 打开开发者工具。
2.  点击“网络”
3.  访问要下载文件的页面。
4.  单击开发人员工具中新创建的条目，然后单击 Headers。这就是我获得有关我需要发送的标题的所有信息的地方。

# primefaces - 手风琴面板显示为打开，但不显示内容

> ID：13770951
> 
> 赞同：0
> 
> 时间：2012-12-07T21:03:23.227
> 
> 标签：primefaces, accordion

我想显示第一个选项卡，默认情况下（我的意思是，没有`activeIndex`）它向我显示该选项卡，但它不显示内容。

```
<p:accordionPanel id="acordeon" value="#{editarReporteExcelBean.reporteOperacionDtoList}" var="reporteOperacion" activeIndex="0" >
    <p:tab id="areaTab" >
        <f:facet name="title">Area #{reporteOperacion.area.nombre}</f:facet>
        <anglosgi:reporteOperacion id="reporteOperacion1"
                            reporteOperacionDto="#{reporteOperacion}"
                            formId="reporteForm"
                            contenedorId="reporteForm:acordeon"/>
    </p:tab>
</p:accordionPanel> 
```

还有 {#reporteOperacion} 的第一行：

```
<composite:interface>
        <composite:attribute name="reporteOperacionDto" required="true" />
        <composite:attribute name="contenedorId" required="true" />
        <composite:attribute name="formId" required="true" />
    </composite:interface>

    <composite:implementation>

        <p:outputPanel id="panelGeneral" >

            <fieldset>
                <legend>Reporte 
                    <h:outputText value="#{cc.attrs.reporteOperacionDto.metaArchivoReporte.fecha}" >
                        <f:convertDateTime pattern="dd/MM/yyyy" timeZone="GMT-4" />
                    </h:outputText>
                </legend> 
```

# jruby - 使用 Apache Buildr 构建 JRuby 项目？

> ID：13770953
> 
> 赞同：1
> 
> 时间：2012-12-07T21:03:41.300
> 
> 标签：jruby, buildr

这个问题之前提出[过](https://stackoverflow.com/questions/12424733/buildr-for-compiling-and-building-jruby-project)，但当时并没有真正回答。你如何设置 buildr 来构建 JRuby 项目？

# ios - IOS - 缩小太多时自动调整视图的问题

> ID：13770957
> 
> 赞同：0
> 
> 时间：2012-12-07T21:03:51.580
> 
> 标签：ios, size, frame, transform, autoresize

我在视图中使用适当的 AutoresizingMask 将子视图放在视图中，以便它们在视图大小发生变化时相应地适应。

当视图缩小太多甚至没有缩小时，我的问题就出现了。子视图似乎忘记了它们的原始位置并开始放置在奇怪的位置或缩放太多或太少。

最初的要求是将视图“缩小”到其中心，然后像气球一样“弹出”，从〜=零大小到原始帧大小。

我之前在其他项目中缩小并弹出视图没有太大问题我不知道是不是因为现在视图更复杂了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:03:51.580

好吧，正如我所说，我以前做过这个，所以我只是检查了我的另一个项目，我发现了我的问题，我在这里发布答案，为任何感兴趣的人分享知识，因为我之前无法谷歌搜索。

*问题是使用它们的**框架缩小或扩大视图并不是正确的**方法。*

不好的例子：

```
[UIView animateWithDuration: 0.4 delay:0 options: UIViewAnimationCurveEaseInOut animations:^{
    self.frame = CGRectMake(frame.origin.x + frame.size.width/2, frame.origin.y + frame.size.height/2, 10, 10);

} completion: nil]; 
```

相反，应该使用转换：

```
 self.transform = CGAffineTransformScale(CGAffineTransformIdentity, 1, 1);

    [UIView animateWithDuration: 0.4 delay:0 options: UIViewAnimationCurveEaseInOut animations:^{

       self.transform = CGAffineTransformScale(CGAffineTransformIdentity, 0.001, 0.001);

   } completion: nil]; 
```

考虑到这仅用于动画目的，以上将元素放在我缩小和扩大视图后它们应该放置的位置。

希望能帮助到你。

# sql - 不使用 EXISTS 引入子查询时，选择列表中只能指定一个表达式

> ID：13770960
> 
> 赞同：0
> 
> 时间：2012-12-07T21:03:57.657
> 
> 标签：sql, sql-server, sql-server-2008

```
(SELECT 
   Dbo.DecryptString(LastName) + '', '' +
   Dbo.DecryptString(FirstName) as PatientName 
 FROM Persons.Informations 
 WHERE PersonId = (SELECT PersonId 
                   FROM Patients.Informations 
                   WHERE PatientId = TST.PatientId))
From Transactions.SessionTransaction TST ON TST.PaymentId = TP.PaymentId 
```

你能告诉我这个查询有什么问题吗？

为什么会通过错误：

> “当不使用 EXISTS 引入子查询时，选择列表中只能指定一个表达式。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T12:58:55.673

如果您尝试将姓氏和名字组合在一起，用逗号分隔，则引号过多：

```
(SELECT 
   Dbo.DecryptString(LastName) + ', ' +
   Dbo.DecryptString(FirstName) as PatientName 
 FROM Persons.Informations 
 WHERE PersonId = (SELECT PersonId 
                   FROM Patients.Informations 
                   WHERE PatientId = TST.PatientId))
From Transactions.SessionTransaction TST ON TST.PaymentId = TP.PaymentId 
```

您的原始查询试图返回两列 - 最后一个带有空字符串的姓氏（实际上是一个无操作），以及一个带有空字符串的名字（同样，实际上是一个无操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T08:23:53.187

您必须使用`IN`谓词而不是`=`，以防您必须比较`WHERE`子句返回的多个值，所以在您的查询中，而不是

```
 WHERE PersonId = (SELECT PersonId 
                       FROM Patients.Informations 
                       WHERE PatientId = TST.PatientId) 
```

试试这个：

```
 ...
  WHERE PersonId IN (SELECT PersonId 
                       FROM Patients.Informations 
                       WHERE PatientId = TST.PatientId)
  ... 
```

但是，您可以`JOIN`直接使用表，而不是这个 predicate `IN`，如下所示：

```
SELECT 
   ...
FROM Persons.Informations i
INNER JOIN Transactions.SessionTransaction TST ON i.PersonId = TST.PersonId
INNER JOIN ... TP ON TST.PaymentId = TP.PaymentId 
```

# java - 需要帮助测试我的课程

> ID：13770962
> 
> 赞同：0
> 
> 时间：2012-12-07T21:04:01.020
> 
> 标签：java, loops

我的任务：

Stix 的游戏——类似于前段时间在“泰国幸存者”中玩的游戏——在简化版本中看起来像这样：

它由两个玩家玩（在幸存者中超过两个，但这里我们只处理两个）。许多棍子（如火柴）放在桌子上。第一个玩家拿走 1、2 或 3 根棍子，前提是桌子上有那么多棍子。然后第二个玩家拿走 1、2 或 3 根棍子（如果可能的话），依此类推。谁拿了最后一根棍子，谁就输了。

这是我的课：

```
 public class StixBoard
    {
        public int number;

        public StixBoard(int number)
        {
        number = number;
        }

        public int getNumStix()
        {
        return number;
        }

        public boolean takeStix(int number)
        {
            int take = 1;
            while(take <= getNumStix())
            {
            takeStix(take);
            take++;
            }

            if(number >= 1 && number <= 3)
            {
            number = number - this.number;
                System.out.println("Number of sticks on board:" + number);
            return(true);
            }
        else
        System.out.println("Illegeal Move");
        return(false);
        }

        public boolean isGameOver()
        {
            if(number >=1)
            {
            return(true);
            }
            else
            return false;
        }

            public String toString()
        {
            return(getNumStix() + " Stix Remaining.");
        }
    }

This is my tester:

    public class StixGame
    {

        public static void main(String[] args)
        {

        StixBoard game1 = new StixBoard(6);
        System.out.println(game1.getNumStix());

        }

    }

Can someone tell my why game1 only returns 0?

*UPDATE*
Now that it constantly displays:

    6
    Illegeal Move
    false
    6

I've been playing around with it but can't figure out why =/

Program now looks like this:

public class StixBoard
{
    public int number;

    public StixBoard(int number)
    {
    this.number = number;
    }

    public int getNumStix()
    {
    return number;
    }

    public boolean takeStix(int number)
    {
        int take = 0;

        while(take != number && number <= 3 && number > 0)
        {
        number = this.number - take;
        take++;
        }

        if(this.number >= 1 && this.number <= 3)
        {
        number = number - this.number;
            System.out.println("Number of sticks on board:" + number);
        return(true);
        }
    else
    System.out.println("Illegeal Move");
    return(false);
    }

    public boolean isGameOver()
    {
        if(number >=1)
        {
        return(true);
        }
        else
        return false;
    }

        public String toString()
    {
        return(getNumStix() + " Stix Remaining.");
    }
} 
```

这是我的测试仪：

```
public class StixGame
{

    public static void main(String[] args)
    {

    StixBoard game1 = new StixBoard(6);
    System.out.println(game1.getNumStix());
    System.out.println(game1.takeStix(3));
    System.out.println(game1.getNumStix());
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T21:06:25.513

当您`number = number`在构造函数中使用时，它实际上使用输入中的变量，因此您基本上是将其重置为自身。然后当构造函数完成时，它超出了范围，因此该变量消失了。您需要做的是重命名函数参数或使用`this.number = number`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T21:08:52.887

你必须初始化你的类：

```
public StixBoard(int number)
{
this.number = number;
} 
```

避免在构造函数中为变量使用相同的名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:09:30.470

您的构造函数将`number`参数设置为自身：

```
public StixBoard(int number)
{
number = number;
} 
```

`this.number`并且保留的默认值`0`。您需要使用`this.`前缀将参数值分配给实例变量以避免名称冲突：

```
this.number = number; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T21:10:31.550

问题是你的构造函数：

```
public StixBoard(int number) {
    number = number;
} 
```

用。。。来代替：

```
public StixBoard(int number) {
    this.number = number;
} 
```

如您所见，参数编号隐藏了您的字段编号。因此，分配是将参数编号分配给自身，而不是您的类字段。要消除阴影，您必须使用关键字`this`来引用在当前线程中执行的对象字段。

# php - 插入 MySQL 数据库的桌面客户端-现在要创建 Web 服务

> ID：13770967
> 
> 赞同：2
> 
> 时间：2012-12-07T21:04:33.890
> 
> 标签：php, mysql, linux

我开发了一个 Ubuntu 桌面应用程序来监控当前直接写入 MySQL 数据库的计算机何时启动。出于安全目的，我假设我不想让所有这些客户端直接与我的数据库对话，而是需要在客户端和数据库之间创建一些其他 Web 界面。我应该用 PHP 编写这个接口吗？客户端如何调用这个接口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:11:30.337

> 出于安全目的，我假设我不想让所有这些客户直接与我的数据库对话

可能不是。您可以在一定程度上锁定数据库，但可能还不够。

> 而是需要在客户端和数据库之间创建一些其他 Web 界面。

如今，Web 服务是为数据库提供受控接口的常用方法。

> 我应该用 PHP 编写这个接口吗？

你可以。不过，语言应该是一件相当私人的事情。我自己可能会使用 Perl 的[Dancer 框架](http://www.perldancer.org/)。它[能够处理 RESTful API](http://advent.perldancer.org/2010/8)（尽管该指南假设您已经了解了 Dancer 的基础知识）。

> 客户端如何调用这个接口？

通过发出 HTTP 请求。它可能就像带有`on`正文的 POST 请求一样简单（然后服务器使用客户端 IP 地址来确定请求来自哪台机器）。具体操作方式取决于您编写客户端所使用的语言以及您可以使用的库。

# android - android 2.3.6 的定位服务问题

> ID：13770973
> 
> 赞同：1
> 
> 时间：2012-12-07T21:04:48.790
> 
> 标签：android, service, gps, position, sleep

30 分钟后，垃圾收集器杀死或重新启动（startCommand 函数与 START_STICKY 一起）服务，然后服务不再工作，此问题仅在 android 2.3.* 操作系统中发生。

30 分钟后，操作系统再次创建服务，但是这个新创建的服务并没有完成初始服务应该做的事情

```
public int onStartCommand(Intent intent, int flags, int startId) {
super.onStartCommand(intent, flags, startId);

startForeground(0, null);

sessionId = null;
app_version = null;

if(intent != null){

    extras = intent.getExtras();
    if(extras != null){
        sessionId = extras.getString("SESSION_ID");
        app_version= extras.getString("app_version");

        if(sessionId != null && app_version != null && !sessionId.equals("") && !app_version.equals("")){
            SharedPreferences prefs = getSharedPreferences("POSITION_CACHE",Context.MODE_PRIVATE);
            SharedPreferences.Editor editor = prefs.edit();
            editor.putString("sessionId", sessionId);
            editor.putString("app_version", app_version);
            editor.commit();
        }
    }
}

SharedPreferences prefs = getSharedPreferences("POSITION_CACHE",Context.MODE_PRIVATE);
sessionId = prefs.getString("sessionId", null);
app_version = prefs.getString("app_version", null);

if(sessionId != null && !sessionId.equals("") && app_version != null && !app_version.equals("")){
    timer();
}
else{
    logout();
}

// We want this service to continue running until it is explicitly
// stopped, so return sticky.
return START_STICKY;
 }

   private void timer(){
updateTask = new TimerTask() {
    @Override
    public void run() {
        if(checkInternetConnection()){

            try{

            if (currentBestLocation != null && currentStatus==1) {

                    WebServiceConnector ws = new WebServiceConnector(sessionId,PositionService.this.getApplicationContext());
                    ws.pushPosition(currentBestLocation.getLatitude(), currentBestLocation.getLongitude() ,app_version);
                    ws.close();
                }
            }catch(Exception e){

            }
        }

    }
};

try{
    positionTimer = new Timer("TaxiPositionTimer");
    positionTimer.schedule(updateTask, 1000L, updatePeriod * 1000L);
}catch(Exception e){
    timer();
} 
```

}

# ios - 使用 [NSFileManager URLForUbiquityContainerIdentifier:] 和 [NSFileManager ubiquityIdentityToken] 的主要区别是什么？

> ID：13770974
> 
> 赞同：6
> 
> 时间：2012-12-07T21:04:50.317
> 
> 标签：ios, icloud, nsfilemanager

我正在尝试将 iCloud 支持添加到我的应用程序中，并且一直在遵循 Apple 自己的[iCloud Design Guide](http://developer.apple.com/library/mac/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/iCloudFundametals.html#//apple_ref/doc/uid/TP40012094-CH6-SW1)。该指南说我应该通过调用来检查用户凭据`[NSFileManager ubiquityIdentityToken]`。它还说我应该检查`[NSFileManager URLForUbiquityContainerIdentifier:]`以使应用程序的无处不在的容器可用。

我遇到的问题`ubiquityIdentityToken`是返回`nil`而`URLForUbiquityContainerIdentifier:`不是返回。因为后者返回了正确的 URL，所以我假设我的配置文件和权利设置正确。我还仔细检查了我正在运行应用程序的设备是否启用了 iCloud，它已登录并启用了文档和数据。

为什么一种方法暗示没有 iCloud 连接而另一种方法暗示没有 iCloud 连接？

**更新：** 我注意到，如果`ubiquityIdentityToken`我*在*调用`URLForUbiquityContainerIdentifier:`. 然而，`ubiquityIdentityToken`如果我的应用程序使用键值存储而不是无处不在的容器，它将如何工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T21:14:35.570

ubiquityIdentityToken 是 Apple 引入的一个新东西，允许应用程序检查用户是否登录到 icloud。这是一种非常快速的方法，可以查明同一用户是否在应用程序激活之间登录/用户是否实际上已登录等。

它可以在主线程上运行并且速度非常快。这将允许您对您的应用程序逻辑做出决定。

需要注意的关键是它可以在主线程上运行并且速度非常快。

您通常会获取此令牌，将其存储在您的应用程序中，然后在您的应用程序从后台返回时再次进行比较。

这样，您可以确保它是同一用户等。

如果返回 nil，则表示用户未登录 iCloud。

以前要检查用户是否登录，有一个单独的调用，但您必须在另一个线程上异步运行它。我猜，他们看到了用户登录 iCloud、暂停他们的应用程序、登录另一个帐户并返回您的应用程序的情况。这将使您能够非常有效且轻松地检查这些内容。但是，令牌没有任何用户身份信息。

# python - 具有多个提交元素的 POST 表单

> ID：13770977
> 
> 赞同：1
> 
> 时间：2012-12-07T21:05:29.163
> 
> 标签：python, urllib2, urllib

基于在 SO 和其他来源上找到的一些快速示例，我正在尝试使用 Python urllib/urllib2 通过以下方式提交表单：

```
>>> import urllib, urllib2
>>> url = 'http://example.com'
>>> r_params = {'a':'test','b':'hooray'}
>>> e_params = urllib.urlencode(r_params)
>>> user_agent = 'some browser and such'
>>> headers = {'User-Agent': user_agent}
>>> req = urllib2.Request(url, e_params, headers)
>>> response = urllib2.urlopen(req)
>>> data = response.read() 
```

我已经让这个工作了，但是，在我正在寻找的特定表单上，有两个“提交”类型的按钮。例如：

```
<b><input type="submit" name="ButtonA" value="SUBMIT"></b>
<b><input type="submit" name="ButtonB" value="LINK"></b> 
```

我相信我遇到的问题是由于当前代码选择了错误的代码。如何通过提交 ButtonB 而不是 ButtonA 来获得响应？我读过的一些东西似乎表明我可以尝试使用 mechanize，但我希望保持简单，而无需阅读和学习 mechanize。有没有一种简单的方法可以做到这一点，或者我需要接受它并真正花时间学习和理解我在做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:21:24.367

如果是这样的话，它应该相当简单——你应该看看你到底在做什么。具体来说，您正在发送一个 POST 请求（如果提供了 data 参数，urllib2.urlopen 将自动发送一个 POST 请求），其中的数据通常由表单元素本身提供。在多个“提交”输入的情况下，激活的提交输入的名称和值与其余的表单数据一起发送。

所以，这就是你所要做的 - 包括 "ButtonB":"LINK" 作为数据。

快速参考，以便您了解 HTML 如何完成所有功能： http: [//www.w3.org/TR/html401/interact/forms.html#submit-format](http://www.w3.org/TR/html401/interact/forms.html#submit-format)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T21:25:46.917

我建议使用像[TamperData](https://addons.mozilla.org/en-us/firefox/addon/tamper-data/) for Firefox 这样的工具来准确地发现站点的 POST 是如何形成的。在您准备好单击其中一个按钮之前激活 TamperData。当它启动时，继续并单击一个。POST 将记录在 TamperData 中。找到它并单击它。

找到下面的 POSTDATA 行并双击它。选择“已解码”单选按钮以删除 HTML 转义。现在，您在制作“r_params”字典时应该复制 1:1 参考。例如，如果 POSTDATA 看起来像这样：

```
Name        | Value
--------------------
QueryString | test
Page        |
Search      | blah 
```

然后你会像这样创建你的字典：

```
r_params = {'QueryString': 'test',
            'Page': '',
            'Search':, 'blah'} 
```

在您了解每个单独的提交事件的 POSTDATA 是什么样子之后，您将知道如何创建正确的字典来发送。此外，请务必确认您发布到正确的 URL。祝你好运！

# java - JTree 中的复选框和单选按钮

> ID：13770978
> 
> 赞同：3
> 
> 时间：2012-12-07T21:05:39.990
> 
> 标签：java, swing, jtree, jcheckbox, jradiobutton

我想创建一个或多或少具有以下结构的 JTree（带有隐藏的根节点）

```
[No Option] Main Dish
    [Radio Button] Steak
    [Radio Button] Fish
    [Radio Button] Filet Mignon
[Checkbox] Side Dish
    [Checkbox] Mashed Potatoes
    [Checkbox] Green Beans
    [Checkbox] Mixed Vegetables
[Checkbox] Dessert
    [Radio Button] Ice Cream
    [Radio Button] Pudding
    [Radio Button] Cake 
```

基本上，至少可以选择一个主菜（但最多一个），可以选择任意数量的配菜（或者没有，如果“配菜”复选框未选中），并且只能选择一个甜点（或无，如果未选中“甜点”复选框）。

[本文](http://itblackbelt.wordpress.com/2007/09/20/swing-based-tree-layouts-with-checkboxtree/)介绍了如何通过创建自定义渲染器来创建使用 JCheckboxes 的树（我想将其用于 Side Dish 和 Dessert 部分），并且同一篇文章的第 3 页描述了如何使用单选按钮（正如我喜欢用于主菜）部分。但它没有描述如何在同一个 JTree 中混合它们。

是否可以创建这样的结构？如果是这样，怎么办？

# java - SQLite 不允许我为数据库中的某些表添加条目

> ID：13770984
> 
> 赞同：0
> 
> 时间：2012-12-07T21:05:53.423
> 
> 标签：java, android, database, sqlite

所以基本上代码工作正常，直到我点击我评论的行“//这不起作用！！！”。然后什么都没有输入到数据库中。任何人都知道为什么我可以为“StringCategory_Table”输入它们，但不能输入其他的？

```
public class SetupOfSQLite{

    private DBHelper myHelper;
    private final Context myContext;
    private SQLiteDatabase myDatabase;

     private static final String DATABASE_NAME = "restaurantDatabase";
     private static final int DATABASE_VERSION = 1;
     private static final String COLUMN_RESTAURANT = "RestaurantName";
     private static final String COLUMN_CATEGORIES= "CategoryName";

     public static String currentRestaurant = null;
     public static String deletingRestaurant= null;

     public static final String American_Table ="Restaurant_List_American";
     public static final String Asian_Table = "Restaurant_List_Asian";
     public static final String BarPub_Table = "Restaurant_List_BarPub";
     public static final String Breakfast_Table ="Restaurant_List_Breakfast";
     public static final String FastFood_Table ="Restaurant_List_FastFood";
     public static final String Healthy_Table = "Restaurant_List_Healthy";
     public static final String Mexican_Table ="Restaurant_List_Mexican";
     public static final String SeaFood_Table = "Restaurant_List_SeaFood";
     public static final String Italian_Table = "Restaurant_List_Italian";
     public static final String Deserts_Table = "Restaurant_List_Desert";
     public static final String StringCategory_Table = "Categories_of_Restaurants";

     static ContentValues contValues = new ContentValues();

private static class DBHelper extends SQLiteOpenHelper {

public DBHelper (Context ctx){
     super (ctx, DATABASE_NAME, null, DATABASE_VERSION);
     }

@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE " + American_Table       + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");  
    db.execSQL("CREATE TABLE " + Asian_Table          + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + BarPub_Table         + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + Breakfast_Table      + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + Deserts_Table        + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + FastFood_Table       + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + Healthy_Table        + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + Italian_Table        + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + Mexican_Table        + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    db.execSQL("CREATE TABLE " + SeaFood_Table        + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_RESTAURANT + " TEXT NOT NULL);");
    // The table below is for keeping the categories persistent
    db.execSQL("CREATE TABLE " + StringCategory_Table + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + COLUMN_CATEGORIES + " TEXT NOT NULL);");
    // The table below is for suggestions

    // now I'll create some entries for default categories
    contValues.put(COLUMN_CATEGORIES, "American"); 
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Asian");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Bar or Pub");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Breakfast");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Deserts");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "FastFood");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Healthy"); // this represents "Healthy" category
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Italian");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "Mexican");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

    contValues.put(COLUMN_CATEGORIES, "SeaFood");
    db.insert(StringCategory_Table, COLUMN_CATEGORIES, contValues);

// now ill add in some restaurants for the first time the user installs the app 
//THIS DOESNT WORK!!!

    contValues.put(COLUMN_RESTAURANT, "Olive Guarden"); 
    db.insert(Italian_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Red Lobster"); 
    db.insert(SeaFood_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Outback"); 
    db.insert(American_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Dunkin' Donuts"); 
    db.insert(Breakfast_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Taco Bell"); 
    db.insert(Mexican_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Burger King"); 
    db.insert(FastFood_Table, COLUMN_RESTAURANT, contValues);  //1st entry for fast food

    contValues.put(COLUMN_RESTAURANT, "McDonald's"); 
    db.insert(FastFood_Table, COLUMN_RESTAURANT, contValues);  // 2 entries for fast food

    contValues.put(COLUMN_RESTAURANT, "Cold Stone"); 
    db.insert(Deserts_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Panda"); 
    db.insert(Asian_Table, COLUMN_RESTAURANT, contValues);

    contValues.put(COLUMN_RESTAURANT, "Subway"); 
    db.insert(Healthy_Table, COLUMN_RESTAURANT, contValues);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T21:10:49.460

我认为您的`contValues`变量具有陈旧的列信息，这对餐厅餐桌没有意义。尝试以下操作：

```
contValues.clear();
contValues.put(COLUMN_RESTAURANT, "Olive Guarden"); 
```

# windows-8 - 我从哪里开始使用 XAML？

> ID：13770986
> 
> 赞同：0
> 
> 时间：2012-12-07T21:06:02.300
> 
> 标签：windows-8, winrt-xaml

我想学习 XAML（尤其是 Windows 8）从哪里开始？

教程？样品？白皮书？最佳实践？技巧和窍门？

什么帮助你学习？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T21:22:44.417

我通过实践学得最好，所以对我来说最好的资源是 Contoso Cookbook 动手实验室。他们为开发人员介绍了所有新的 Windows 8 功能，并为您提供了每个功能的编码体验。[您可以从这里](http://www.microsoft.com/en-us/download/details.aspx?id=29854)下载它们。为 C# 和 XAML 选择 Win8CS.Setup.exe 下载（Win8JS.Setup.exe 下载是 JavaScript 和 HTML）。实验室包括：
1.ListViews/GridViews 和数据绑定
2.Orientation、Snapping 和语义缩放
3.Searching 和共享
4.Appbars 和媒体捕获
5.Lifetime Management
6.Settings 和 Preferences
7.Tiles 和 Notifications
8.Windows Store

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:11:14.403

Charlez Petzold 有一本书叫 Programming Windows 8，非常好。不是很高级，但非常适合初学者。它没有发布你的，但在 O'Reilley 上有一个“测试版”可用......

[http://shop.oreilly.com/product/0790145369079.do](http://shop.oreilly.com/product/0790145369079.do)

# ruby-on-rails - 如何在 Rails 中将分页 XML（plist）数据插入数据库？

> ID：13770987
> 
> 赞同：0
> 
> 时间：2012-12-07T21:06:03.107
> 
> 标签：ruby-on-rails, xml, ruby-on-rails-3, mongodb, mongoid

我从外部 API 获取大量 XML 数据。

它给了我所有分页的数据，每页有 20 条记录。

它还为我提供了每个文档的总记录数。

我正在使用 gem 获取 XML（实际上是 plist 数据`Typhoeus`），我正在使用`Plist`gem 对其进行转换，并将它们插入到数据库中。

问题是；我可以很容易地插入前 20 条记录——这意味着第一页。但是如何计算每个文档有多少页以及如何动态查询其他页面？

这是我的控制器和操作。它适用于第一页，但不适用于其他页面。

```
class Admin::VideosController < ApplicationController
def index

      @videos = Video.where(program_id: params[:p_id])
      @program = Program.find(params[:p_id])

    if params[:cmd]=="get_videos_from_outer"
        @page=1
        @fetch = Typhoeus::Request.post("URL", :params => {:commandtype=>"getprogramepisodes", :feedtype=>"plist",:id=>@program.kid, :page=>@page})
        @plist = Plist::parse_xml(@fetch.body.force_encoding 'utf-8')

        import_outer_videos(@plist)
        redirect_to :action=>"index", :p_id=>params[:p_id]

    end

  end
end 
```

在这里我正在插入数据：

```
private

def import_outer_videos(plist)
  @total_count = plist.second.first['totalCount']
  if !plist.blank?

        plist.second.each_with_index do |t, i| 

                if @page==1
                   if i > 0
                   @new = Video.create(:thumb_path=>t['tnPath'], :vid=>t['id'], :title=>t['title'], :type=>t['type'], :kid=>@program.kid, :program_id=>@program.id)

                    end
                else
                  @new = Video.create(:thumb_path=>t['tnPath'], :vid=>t['id'], :title=>t['title'], :type=>t['type'], :kid=>@program.kid, :program_id=>@program.id)       

                end

        end
        @page = @page + 1 unless @page >=  @total_count/20 rescue 0
        puts "###############################    #{@page}   - #{@total_count}  ###############################"
          if @new.errors.blank?
          flash[:notice]="Videos has been uploaded."
          else
            flash[:notice]="No new video."
          end

      end

end 
```

PS：我正在使用 MongoDB 和 Mongoid。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T11:00:07.883

我已经自己解决了。这是我为可能需要做类似事情的人提供的解决方案。

```
def get_videos_from_outer(page=params[:page], kid=params[:kid], totalCount="")

        @videos = Video.where(program_id: params[:p_id])
        @program = Program.find(params[:p_id])

        @fetch = Typhoeus::Request.post("URL", :params => {:commandtype=>"getprogramepisodes", :feedtype=>"plist",:id=>kid.to_i, :page=>page.to_i})
        @plist = Plist::parse_xml(@fetch.body.force_encoding 'utf-8')

          @totalCount = @plist.second.first['totalCount']

          if !totalCount.blank?
            @totalCount = totalCount
          end
        import_outer_videos(@plist, kid, page.to_i, @totalCount.to_i)

  end 
```

和`import_outer_videos`方法。

```
private

def import_outer_videos(plist, kid, page, totalCount)

         @totalCount = totalCount

        plist.second.each_with_index do |t, i| 
        # First page has odd data and here we're getting rid off them
                if page.to_i==1
                   if i > 0
                   @new = Video.create(:thumb_path=>t['tnPath'], :vid=>t['id'], :title=>t['title'], :type=>t['type'], :kid=>kid, :program_id=>@program.id)

                    end
                else
                  @new = Video.create(:thumb_path=>t['tnPath'], :vid=>t['id'], :title=>t['title'], :type=>t['type'], :kid=>kid, :program_id=>@program.id)       

                end

        end

        if page.to_i < (@totalCount.to_i/20) + 1
        page = page.to_i + 1 

        get_videos_from_outer(page.to_i, kid.to_i, @totalCount)
        else
          redirect_to :action=>"index", :p_id=>params[:p_id]
        end

          if @new.errors.blank?
          flash[:notice]="#{@totalCount} videos has been transfered."
          else
            flash[:notice]="No new video."
          end
end 
```

# php - 通过 JSON 将数组从 jQuery 传递到 PHP

> ID：13770995
> 
> 赞同：1
> 
> 时间：2012-12-07T21:07:02.810
> 
> 标签：php, jquery, ajax, arrays, json

我想将一个数组从我的客户端 jQuery 代码发送到我的服务器 PHP 代码。在 jQuery 方面，这就是我正在做的事情：

```
$.ajax( {
    url: someUrl,
    data: {
       action:  'opensearch',
       search:  query,
       namespace:   [10, 846],
       suggest:     ''
    },
    dataType: 'json',
}); 
```

在 PHP 方面：

```
echo $params['action'] ."\r\n";
echo $params['namespace'][0] ."\r\n";
echo $params['namespace'][1] ."\r\n"; 
```

这个的输出是：

```
opensearch
0 
```

因此，当我设法正确打印字符串时，参数会正确发送。但是，阵列似乎未正确发送。

我尝试使用`json_decode`和不使用该`true`选项，但无济于事。

任何建议都是最受欢迎的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:11:31.883

```
$.ajax( {
    url: someUrl,
    type:'post'
    data: encodeURIComponent('action=opensearch&search=query&namespace[]=10&namespace[]=846&suggest='),
    dataType: 'json',
}); 
```

php

```
$params=json_decode($_POST);
    echo $params->action; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:17:24.083

json_decode() 将有效的 JSON 字符串转换为对象。它接受三个参数，每个参数如下所述：

JSON 字符串本身。

可选参数 assoc：默认情况下此值为 false。如果更改为 true，json_decode 会将对象转换为关联数组

深度：JSON 字符串中递归结构的最大允许深度。在 PHP 5.3 之前它曾经是 128。PHP 5.3 将此限制增加到默认的 512 字节。该参数也是可选的。

```
$objJson = json_decode($json); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T21:35:30.663

你不需要解码你的`$_POST`变量，实际上，`$_POST`已经包含了你想要的数据。

只需进行测试，使用以下代码创建一个 jsonpost.php ：

```
<?php

    if (count($_POST) > 0)
    {
        header("Content-type: text/plain; charset=utf-8");
        echo nl2br(var_export($_POST, true));
        die();
    }

?>

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
         <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    </head>
    <body>
        <div id="target"></div>

        <script type="text/javascript">

            $.ajax( {
                url: 'jsonpost.php',
                type:'post',
                data: {
                   action:  'opensearch',
                   search:  'test',
                   namespace:   [10, 846],
                   suggest:     ''
                },
                success: function(data) {
                    $('#target').html(data);
                }
            });

        </script>
    </body>
</html> 
```

这将显示：

```
array (
  'action' => 'opensearch',
  'search' => 'test',
  'namespace' =>
  array (
    0 => '10',
    1 => '846',
  ),
  'suggest' => '',
) 
```

您的主要错误是您认为`dataType`会将您的数据作为**json**发布，但实际上`dataType`内容将定义要获取的**预期**数据（在调用回调时有一个已经解码的对象）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T21:36:27.053

尝试记录您收到的数据并查看您收到的内容，我已经使用以下代码测试了您的 ajax 帖子，它根据需要返回值 10：

```
 $data = $_REQUEST;
   error_log($data['namespace'][0]."\n",3,"log.txt");
   print_r($data['namespace'][0]); 
```

还可以使用错误和成功选项来查看您从 php 脚本中得到的响应

```
 $.ajax( {
   url: 'rec.php',
   data: {
      action:  'opensearch',
      search:  "abc",
      namespace:   [10, 846],
      suggest:     ''
   },
   dataType: 'json',
   error: function (XMLHttpRequest, textStatus, errorThrown) {
    console.log(JSON.stringify(XMLHttpRequest));
    console.log(JSON.stringify(textStatus));
    console.log(JSON.stringify(errorThrown));

  },
  success: function (data) {
   console.log(JSON.stringify(data));
 }
 });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T21:42:01.677

您正在发送表单数据，因此它不会被 json_encoded。

```
$.ajax( {
    url: someUrl,
    data: {
        json_string: JSON.stringify({
            action:  'opensearch',
            search:  query,
            namespace:   [10, 846],
            suggest:     ''
        })
    },
    dataType: 'json',
}); 
```

然后在 PHP 端

```
$data = json_decode($params['json_string'], true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T21:15:15.527

数据不是以 JSON 形式发布的，而是以适当的 HTTP POST 形式发布的。

但是，PHP 只会将其转换为一个数组，该字段的名称的结构方式表明它是一个数组。尝试替换`namespace: [10, 846]`：`"namespace[]": [10, 846]`

现在，jQuery 很可能会发布这个: `namespace=10&namespace=846`，它不会被正确地转换为数组。添加方括号应该可以解决这个问题。

# php - 如何获得 PHP 生成的 javascript 文件的 304 响应？

> ID：13770999
> 
> 赞同：2
> 
> 时间：2012-12-07T21:07:52.313
> 
> 标签：php, apache, browser, browser-cache, http-status-code-304

我有以下 PHP 文件：

```
<?php

Header('Content-Type: application/javascript');

echo "// Some dynamically generated JavaScript here..."; 
```

所以它是一个 .php 文件，但它被解释为一个 JavaScript 文件。我会将它加载到这样的网页中：

```
<script type='text/javascript' src='myjavascript.php'></script> 
```

我的问题是关于访问此文件时发送的 HTTP 代码。每次我请求此文件（直接或通过请求它的网页）时，Chrome 开发工具都会显示 200 OK 的状态。即使内容没有改变，它也绝不是 304。

在内容没有改变的情况下，是否可以为这样的动态生成的文件获得 304 Not Modified ？如果不是，为什么？

我还使用了一些允许路由的 PHP 框架，例如：`/js/myjavascript.js`. 所以我可以把上面的代码放在那个路由中，以同样的方式动态生成 JavaScript。但同样，每次仍然是 200，即使内容没有改变并且 URI 是一个 .js 文件。

有解决方案吗？在我的情况下，这个 javascript/php 文件的内容大约每天更改一次。所以我需要我的访问者浏览器大部分时间缓存文件（304 未修改），但是当它发生变化时，我需要他们的浏览器下载并缓存新版本（200 OK）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:28:16.133

仅当客户端在请求中`304 Not Modified`包含标头时才应发送标头。`If-Modified-Since`

我有一个 PHP 脚本，它总是生成相同的一致输出（它恰好是图像/png），具体取决于重写规则提供给它的选项。对于我的脚本，我假设 ANY`If-Modified-Since`反映了浏览器中的有效缓存数据，因此我的脚本包括：

```
// If they've got it, they should use it.
if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) && strlen($_SERVER['HTTP_IF_MODIFIED_SINCE'])) {
    header("HTTP/1.0 304 Not Modified");
    exit;
} 
```

如果您想对此更聪明，您可以解析变量并将其与对您的脚本重要的任何内容进行比较。您需要考虑如何在每次运行时动态生成内容的 PHP 脚本的上下文中检测*内容是否已更改。*

有关浏览器缓存如何在 PHP 中工作的更多信息，请[查看`PHP: header`](http://ca.php.net/manual/en/function.header.php#61903).

`cURL`您可以使用命令行测试此行为：

```
[ghoti@pc ~]$ curl -sL -w "%{http_code} %{url_effective}\\n" https://www.google.com/images/srpr/logo3w.png -o /dev/null
200 https://www.google.com/images/srpr/logo3w.png
[ghoti@pc ~]$ curl -H"If-Modified-Since: Sat, 31 Dec 2011 00:00:00 GMT" -sL -w "%{http_code} %{url_effective}\\n" https://www.google.com/images/srpr/logo3w.png -o /dev/null
200 https://www.google.com/images/srpr/logo3w.png
[ghoti@pc ~]$ curl -H"If-Modified-Since: Mon, 31 Dec 2012 00:00:00 GMT" -sL -w "%{http_code} %{url_effective}\\n" https://www.google.com/images/srpr/logo3w.png -o /dev/null
304 https://www.google.com/images/srpr/logo3w.png
[ghoti@pc ~]$ 
```

注意不同的日期。

如果您在 Chrome 认为没有发送足够的标头时遇到问题，您可以尝试复制其他流行网站以标头的方式提供的内容：

```
[ghoti@pc ~]$ curl -H"If-Modified-Since: Mon, 31 Dec 2012 00:00:00 GMT" -sLI https://www.google.com/images/srpr/logo3w.png
HTTP/1.1 304 Not Modified
Date: Wed, 05 Dec 2012 17:40:52 GMT
Expires: Thu, 13 Dec 2012 17:40:52 GMT
Age: 241012
Server: GFE/2.0 
```

毫无疑问，`Server:`可以忽略，但如果您包括其他三个，您可能会减少来自 Chrome 的投诉。不过，正如我所说，您将不得不提出您想要使用的标准来确定您认为动态生成的内容的“年龄”，因为 Apache 检测到的静态文件上的文件系统时间戳不再可用。