# StackOverflow 问答 14792000-14792999

# android - 引导接收器和广播接收器之间的区别

> ID：14792002
> 
> 赞同：2
> 
> 时间：2013-02-09T21:51:55.417
> 
> 标签：android, broadcastreceiver, alarmmanager, reboot

我正在使用警报管理器，并且在系统重新启动时无法维持警报，因此，我已经读到我应该使用扩展广播接收器的启动接收器，但我想知道接收器本身和接收器之间的确切区别引导接收器。

我的 broadcastReceiver 的 onReceive 方法实际上将我带到一个使用意图的新活动，我应该使用此代码并将其粘贴到 bootReceiver 的 onReceive 中吗？或者我到底应该在 bootReceiver 中写些什么？

我对这一点感到非常困惑，因为我有多个警报，并且我给了每个警报一个唯一的 requestCode。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:26:10.043

Android 中没有单独的实体“Boot Receiver”。引导接收器只是广播接收器，它通过动作 android.intent.action.BOOT_COMPLETED 响应意图。

我相信你需要做几件事：

*   创建一个继承自 BroadcastReceiver 的类
*   将它添加到 Manifest 并添加它应该处理 android.intent.action.BOOT_COMPLETED 的信息
*   在 onReceive 代码中，从持久存储中读取所有警报并再次设置它们（因此，每次重新启动后都会再次设置它们）。

PS我建议通读：http: [//developer.android.com/reference/android/content/BroadcastReceiver.html](http://developer.android.com/reference/android/content/BroadcastReceiver.html)

# delphi - 枚举到整数，反之亦然（使用组合框 itemindex）

> ID：14792012
> 
> 赞同：0
> 
> 时间：2013-02-09T21:52:53.403
> 
> 标签：delphi, combobox

不知道我在这里做错了什么

```
//update controls from main form Tshape
 form2.cbxShape.ItemIndex:= ord(Shape1.Shape);
 form2.cbxColor.Selected:= Shape1.Brush.Color;
 form2.cbxStyle.ItemIndex:= Ord(Shape1.Brush.Style);
 if form2.ShowModal = mrOK then
 begin
  //update main form Tshape from controls
   Shape1.Shape:= TShapeType(form2.cbxShape.ItemIndex);
   Shape1.Brush.Color:= form2.cbxColor.Selected;
   Shape1.Brush.Style:= TBrushStyle(form2.cbxStyle.ItemIndex);
 end; 
```

我没有得到正确的形状或画笔样式（颜色效果很好）

列表框项如下：

```
Circle
Ellipse
Rectangle
RoundRect
RoundSquare
Square 
```

和

```
BDiagonal
Clear
Cross
DiagCross
FDiagonal
Horizontal
Solid 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T22:05:51.253

查看`TShapeType`and的声明`TBrushStyle`：

> TShapeType = (stRectangle, stSquare, stRoundRect, stRoundSquare, stEllipse, stCircle);
> 
> TBrushStyle = (bsSolid, bsClear, bsHorizo​​ntal, bsVertical, bsFDiagonal, bsBDiagonal, bsCross, bsDiagCross);

列表框中的项目必须具有相同的顺序，包含相同的对应枚举。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:00:12.173

LU RD 已经回答了这个问题。
另一种独立于任何排序的方法来达到目标​​可能是

```
implementation
uses TypInfo;
{$R *.dfm}

procedure TForm1.ComboBox1CloseUp(Sender: TObject);
begin
  SetPropValue(Shape1,'Shape','st' + Combobox1.Text);
  Caption := StringReplace(GetPropValue(Shape1,'Shape',true),'st','',[]);
end; 
```

# javascript - 选择刚刚附加 jquery 的选项

> ID：14792014
> 
> 赞同：1
> 
> 时间：2013-02-09T21:53:04.237
> 
> 标签：javascript, jquery, select, append, option

基于 AJAX 查询，我将一些选项附加到列表中。

```
for(var i = 0; i < options.length; i++) {
    var data = options[i];
    var option = $('<option id="mySelectElementOption_' + data['id'] + '" value="' + data['value'] + '">' + data['value'] + '</option>');
    $('#mySelectElement').append(option);
} 
```

现在，当用户在页面上进行交互时，我想选择刚刚附加的选项，我尝试了以下操作（这两种可能性都不适用于我）：

```
$('#mySelectElementOption_' + id).attr('selected', 'selected'); 
```

和

```
var option = document.getElementById('mySelectElementOption_' + id);
option.selected = true; 
```

所以我被卡住了，因为我不知道如何选择我的选项。你有什么想法我可以解决这个问题吗？谢谢！

**PS：当我在谷歌浏览器中尝试第二种可能性时，它运行良好。**

问候，约瑟夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:56:32.857

```
var opts = {

success: function(data)
         {
             //do everything here first before appending it,
             //including adding event bindings
         }

}

$.ajax(opts) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:58:59.347

使用`prop`代替`attr`：

```
$('#mySelectElementOption_' + id).prop('selected', true); 
```

或者

```
$('#mySelect').val($('#mySelectElementOption_' + id).val()); 
```

[http://jsfiddle.net/uG88d/](http://jsfiddle.net/uG88d/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:04:22.927

试试这个：
HTML：

```
<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<meta charset=utf-8 />
<title>JS Bin</title>
</head>
<body>
  <select id="mySelectElement">
    <option id="oldoption" >Old option</option>
  </select>
</body>
</html> 
```

JS：

```
//demo data
options = [{id:0, value:"aaa"},{id:1, value:"bbb"},{id:2, value:"ccc"}];

    for(var i = 0; i < options.length; i++) {
        var data = options[i];
        var option = $('<option id="mySelectElementOption_' + data['id'] + '" class="interactable" value="' + data['value'] + '">' + data['value'] + '</option>');
        $('#mySelectElement').append(option);
    }
//This is what you need:
        $("#mySelectElement :not([class])").attr("disabled","disabled"); 
```

说明：
`$("#mySelectElement :not([class=interactable])")`- 这告诉 jquery 查找 #mySelectElement 中没有“可交互”类的任何选项元素。
然后它禁用它：`.attr("disabled","disabled");`

试试看： [jsBin](http://jsbin.com/avumoj/2/)

**编辑：**

```
$("#mySelectElement .interactable:first").prop('selected', true); 
```

[试试看](http://jsbin.com/avumoj/4/)

# c - 链接器不想识别 lib 文件

> ID：14792015
> 
> 赞同：0
> 
> 时间：2013-02-09T21:53:18.913
> 
> 标签：c, winapi, codeblocks

我想创建一个[队列计时器](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686796%28v=vs.85%29.aspx)。我打电话`CreateTimerQueueTimer` 但它没有编译，因为它说

> 未定义对 CreateTimerQueueTimer 的引用

我向链接器展示了 Kernel32.lib 的路径。

我使用 CodeBlocks，右键单击项目名称 -> 构建选项 -> 链接器设置选项卡 -> 然后单击添加并转到 lib 路径，但它没有帮助。是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:12:24.760

CreateTimerQueueTimer 是 Win32 中更新的 API。要启用它，您需要将 _WIN32_WINNT 定义为 0x0500 或更高版本。添加到您的预处理器定义_WIN32_WINNT=0x0500。

# c++ - 在 C++11 中创建一个保留锁定尝试顺序的锁

> ID：14792016
> 
> 赞同：16
> 
> 时间：2013-02-09T21:53:21.453
> 
> 标签：c++, multithreading, c++11, locking

有没有办法确保被阻塞的线程以与被阻塞相同的顺序被唤醒？我在某处读到这将被称为“强锁”，但我没有找到任何资源。

在 Mac OS X 上，可以设计一个 FIFO 队列来存储阻塞线程的所有线程 ID，然后使用漂亮的函数`pthread_cond_signal_thread_np()`来唤醒一个特定的线程——这显然是非标准和不可移植的。

我能想到的一种方法是使用类似的队列，然后`unlock()`将 a 发送`broadcast()`到所有线程并让它们检查哪一个是下一个。
但这会导致大量开销。

解决该问题的一种方法是将 packaged_task 发送到队列并让它按顺序处理它们。但这对我来说更像是一种解决方法而不是解决方案。

**编辑：**
正如评论所指出的，这个问题听起来可能无关紧要，因为原则上没有保证锁定尝试的顺序。
作为澄清：

我有一个我称之为 ConditionLockQueue 的东西，它与 Cocoa 库中的 NSConditionLock 类非常相似，但它维护一个阻塞线程的 FIFO 队列，而不是一个或多或少的随机池。

基本上任何线程都可以“排队”（有或没有特定“条件”的要求 - 一个简单的整数值 - 要满足）。然后线程被放置在队列中并阻塞，直到它是队列中满足条件的最前面的元素。

这提供了一种非常灵活的同步方式，我发现它在我的程序中非常有用。
现在我真正需要的是一种唤醒具有特定 id 的特定线程的方法。
但这些问题几乎是一样的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-09T23:10:05.517

构建一个使用编号票证的锁对象非常容易，以确保其完全公平（按线程首先尝试获取它的顺序授予锁）：

```
#include <mutex>
#include <condition_variable>

class ordered_lock {
    std::condition_variable  cvar;
    std::mutex               cvar_lock;
    unsigned int             next_ticket, counter;
public:
    ordered_lock() : next_ticket(0), counter(0) {}
    void lock() {
        std::unique_lock<std::mutex> acquire(cvar_lock);
        unsigned int ticket = next_ticket++;
        while (ticket != counter)
            cvar.wait(acquire);
    }
    void unlock() {
        std::unique_lock<std::mutex> acquire(cvar_lock);
        counter++;
        cvar.notify_all();
    }
}; 
```

**编辑**

修正奥拉夫的建议：

```
#include <mutex>
#include <condition_variable>
#include <queue>

class ordered_lock {
    std::queue<std::condition_variable *> cvar;
    std::mutex                            cvar_lock;
    bool                                  locked;
public:
    ordered_lock() : locked(false) {};
    void lock() {
        std::unique_lock<std::mutex> acquire(cvar_lock);
        if (locked) {
            std::condition_variable signal;
            cvar.emplace(&signal);
            signal.wait(acquire);
        } else {
            locked = true;
        }
    }
    void unlock() {
        std::unique_lock<std::mutex> acquire(cvar_lock);
        if (cvar.empty()) {
            locked = false;
        } else {
            cvar.front()->notify_one();
            cvar.pop();
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-07T10:02:29.267

我尝试了 Chris Dodd 解决方案 [https://stackoverflow.com/a/14792685/4834897](https://stackoverflow.com/a/14792685/4834897)

但编译器返回错误，因为队列只允许有能力的标准容器。虽然引用 (&) 不可复制，但您可以在 Akira Takahashi 的以下回答中看到： [https ://stackoverflow.com/a/10475855/4834897](https://stackoverflow.com/a/10475855/4834897)

所以我使用允许可复制引用的 reference_wrapper 更正了解决方案。

**编辑：** @Parvez Shaikh 建议通过在 lock() 函数中的 signal.wait() 之后移动 cvar.pop() 来进行小的改动，以使代码更具可读性

```
#include <mutex>
#include <condition_variable>
#include <queue>
#include <atomic>
#include <vector>

#include <functional> // std::reference_wrapper, std::ref

using namespace std;

class ordered_lock {
    queue<reference_wrapper<condition_variable>> cvar;
    mutex                                        cvar_lock;
    bool                                         locked;
public:
    ordered_lock() : locked(false) {}
    void lock() {
        unique_lock<mutex> acquire(cvar_lock);
        if (locked) {
            condition_variable signal;
            cvar.emplace(std::ref(signal));
            signal.wait(acquire);
            cvar.pop();
        } else {
            locked = true;
        }
    }
    void unlock() {
        unique_lock<mutex> acquire(cvar_lock);
        if (cvar.empty()) {
            locked = false;
        } else {
            cvar.front().get().notify_one();
        }
    }
}; 
```

另一种选择是使用指针而不是引用，但它似乎不太安全。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-12T16:57:26.833

*我们在这个线程上问正确的问题吗？？？如果是这样：他们的回答是否正确？？？*

或者换一种说法：

*我完全误解了这里的东西吗？*

编辑段落：*似乎**StatementOnOrder**（见下文）是错误的。请参阅链接 1 （Linux 下的 C++ 线程等通常基于 pthreads）和链接 2（将当前调度策略作为决定因素）——感谢来自[cppreference](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_lock.html) ( [ref ) 的](http://en.cppreference.com/mwiki/index.php?title=Talk%3Acpp%2Fconcept%2FMutex&diff=86028&oldid=86025)[Cubbi](https://stackoverflow.com/questions/14947191/what-is-the-pthread-mutex-lock-wake-order-with-multiple-threads-waiting)。另请参阅[链接](https://stackoverflow.com/a/17528655/5106243)、[链接](https://stackoverflow.com/a/10461904/5106243)、[链接](https://stackoverflow.com/a/17528655/5106243)、[链接](https://stackoverflow.com/a/15395255/5106243)。如果该语句为假，那么拉原子（！）票的方法，如下面的代码所示，可能是首选！*

开始...

**StatementOnOrder**：“多个线程遇到锁定的互斥体并因此按特定顺序“进入睡眠状态”，随后将获得互斥体的所有权并以相同的顺序继续运行。

## 问题：**StatementOnOrder**是真还是假**？？？**

```
void myfunction() {
    std::lock_guard<std::mutex> lock(mut);

    // do something
    // ...
    // mutex automatically unlocked when leaving funtion.
} 
```

我问这个是因为迄今为止此页面上的所有代码示例似乎都是：

a) 浪费（如果**StatementOnOrder**为真）

或者

b) 严重错误（如果**StatementOnOrder**为假）。

**那么，如果StatementOnOrder**为假，为什么还要说他们可能“严重错误”呢？
原因是所有代码示例都认为他们通过使用 来超级聪明`std::condition_variable`，但实际上在此*之前*使用了锁，这会（如果**StatementOnOrder**为 false）弄乱了顺序！！！
只需在此页面上搜索`std::unique_lock<std::mutex>`，即可看到讽刺意味。

所以如果**StatementOnOrder**真的是假的，你就不能遇到锁，*然后再*处理票证和条件变量*的*东西。相反，你必须做这样的事情：在遇到任何锁*之前*拉一张原子票！！！
为什么要在撞锁*之前拉票？*因为这里我们假设**StatementOnOrder**为假，所以任何排序都必须在“邪恶”锁之前完成。

```
#include <mutex>
#include <thread>
#include <limits>
#include <atomic>
#include <cassert>
#include <condition_variable>
#include <map>

std::mutex mut;
std::atomic<unsigned> num_atomic{std::numeric_limits<decltype(num_atomic.load())>::max()};
unsigned num_next{0};
std::map<unsigned, std::condition_variable> mapp;

void function() {
    unsigned next = ++num_atomic; // pull an atomic ticket

    decltype(mapp)::iterator it;

    std::unique_lock<std::mutex> lock(mut);
    if (next != num_next) {
        auto it = mapp.emplace(std::piecewise_construct,
                               std::forward_as_tuple(next),
                               std::forward_as_tuple()).first;
        it->second.wait(lock);
        mapp.erase(it);
    }

    // THE FUNCTION'S INTENDED WORK IS NOW DONE
    // ...
    // ...
    // THE FUNCTION'S INDENDED WORK IS NOW FINISHED

    ++num_next;

    it = mapp.find(num_next); // this is not necessarily mapp.begin(), since wrap_around occurs on the unsigned                                                                          
    if (it != mapp.end()) {
        lock.unlock();
        it->second.notify_one();
    }
} 
```

上面的函数保证了订单按照拉取的原子票执行。（编辑：*使用 boost 的侵入式映射，将 condition_variable 保留在堆栈上（作为局部变量），将是一个很好的优化，可以在这里使用，以减少免费存储的使用！*）

但主要问题是：**StatementOnOrder**是真的还是假的？？？
（如果是真的，那么我上面的代码示例也是一种浪费，我们可以只使用互斥锁并完成它。）
我希望像[Anthony Williams](https://stackoverflow.com/users/5597/anthony-williams)这样的人会检查这个页面......;）

# android - 启动默认音乐播放器

> ID：14792018
> 
> 赞同：2
> 
> 时间：2013-02-09T21:53:29.633
> 
> 标签：android, android-intent, android-music-player

我正在尝试启动音乐播放器，以便它启动并立即开始播放第一首歌曲。我正在使用 Intent，但它不起作用......它说“没有找到处理意图的活动”。

```
 Intent intent = new Intent(android.content.Intent.ACTION_VIEW);
       //"songsList" is an array with paths of all the songs in the sdcard
    Uri uri = Uri.parse(songsList.get(0));
    String type = "audio/mp3";
    intent.setDataAndType(uri, type);
    startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T03:07:06.313

```
 Intent intent = new Intent();
        intent.setAction(android.content.Intent.ACTION_VIEW);
        File file = new File(AUDIO_PATH);
        intent.setPackage("com.google.android.music");          
        intent.setDataAndType(Uri.fromFile(file), "audio/*");
        mContext.startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T21:57:23.763

为什么不使用[`android.intent.action.MUSIC_PLAYER`](http://developer.android.com/reference/android/provider/MediaStore.html#INTENT_ACTION_MUSIC_PLAYER)？

```
Intent intent = new Intent("android.intent.action.MUSIC_PLAYER");
startActivity(intent); 
```

请注意，这已从 API 15 中弃用，从 API 向上您可以使用[`android.intent.category.APP_MUSIC`](http://developer.android.com/reference/android/content/Intent.html#CATEGORY_APP_MUSIC).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-30T08:03:04.997

要启动默认音乐播放器，请尝试使用以下代码。

```
try {
    Intent intent = Intent.makeMainSelectorActivity(Intent.ACTION_MAIN, Intent.CATEGORY_APP_MUSIC);
    getContext().startActivity(intent);
} catch (Exception e) {
    Log.d(TAG, "Exception for launching music player "+e);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T00:04:21.230

好的，所以我发现这段代码有效

```
 Intent intent = new Intent();  
                intent.setAction(android.content.Intent.ACTION_VIEW);  
                File file = new File(songsList.get(0));  
                intent.setDataAndType(Uri.fromFile(file), "audio/*");  
                startActivity(intent); 
```

但问题是，让我们说用户点击后退按钮，然后点击音乐播放器的按钮，它重新启动播放器并再次开始播放第一首歌曲......那么我如何只启动音乐播放器而没有其他任何东西...？

# xna - 计算目标到旋转精灵的方向

> ID：14792037
> 
> 赞同：0
> 
> 时间：2013-02-09T21:55:00.733
> 
> 标签：xna, rotation, directions

我有一个通过旋转移动的玩家精灵，它的旋转不断变化，但我还需要确定目标是在它的左侧还是右侧，而不是在前后旋转的 45 度范围内。

我已经编写了这段代码，我认为它应该可以工作，但它似乎只是偶尔拿起一侧，而另一侧则稍微多一些。

```
 public void GrappleCheck(AsteroidSprite target)
    {
        float targetTragectory = (float)Math.Atan2(Position.Y - target.Position.Y, Position.X - target.Position.X);

        if (targetTragectory < 0)
            targetTragectory += (float)(Math.PI * 2);

        if (Rotation < 0)
            Rotation += (float)(Math.PI * 2);

        if ((targetTragectory > Rotation + (float)(MathHelper.PiOver4 / 2)) && (targetTragectory < Rotation + (float)(Math.PI - (MathHelper.PiOver4 / 2))))
        {
            target.Distance = Vector2.Distance(Position, target.Position);
            if (RightTarget != null)
            {
                if (RightTarget.Distance > target.Distance)
                {
                    RightTarget.isTarget = false;
                    RightTarget = target;
                    RightTarget.ColorTint = Color.Blue;
                    RightTarget.isTarget = true;
                }
            }
            else
            {
                RightTarget = target;
                RightTarget.ColorTint = Color.Blue;
                RightTarget.isTarget = true;
            }
        }
        else if ((targetTragectory < Rotation - (float)(MathHelper.PiOver4 / 2)) && (targetTragectory > Rotation - (float)(Math.PI - (MathHelper.PiOver4 / 2))))
        {
            target.Distance = Vector2.Distance(Position, target.Position);
            if (LeftTarget != null)
            {
                if (LeftTarget.Distance > target.Distance)
                {
                    LeftTarget.isTarget = false;
                    LeftTarget = target;
                    LeftTarget.ColorTint = Color.Red;
                    LeftTarget.isTarget = true;
                }
            }
            else
            {
                LeftTarget = target;
                LeftTarget.ColorTint = Color.Red;
                LeftTarget.isTarget = true;
            }
        }
        else
        {
            target.isTarget = false;
        }

        if (controlInput.IsHeld(Keys.X))
        {
            Speed = Speed;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:56:15.633

使用角度可能会很烦人。以下是一些不使用角度来解决问题的方法：

首先，我们需要到目标的方向和运动方向：

```
var targetDirection = target.Positon - Position;
// Update this to match the actual direction. The following line assumes that
// a rotation of 0 results in the right direction.
var movementDirection = new Vector2((float)Math.Cos(Rotation), (float)Math.Sin(Rotation)); 
```

您要解决的第一个问题是确定目标是否在 45° 圆锥内。您可以使用以下公式计算实际角度：

```
var dot = Vector2.Dot(myDirection, targetDirection);
//if dot is negative, then target is behind me, so just use the absolute value
var cos = Math.Abs(dot) / myDirection.Length() / targetDirection.Length();
var angle = Math.Acos(cos);
if(angle < MathHelper.PiOver4 / 2) //45° opening angle
    ; // within cone
else
    ; // outside cone 
```

您的第二个问题是确定目标是在左侧还是右侧。为此，我们使用正交`myDirection`并指向左侧的向量：

```
//assuming that +x is the right axis and +y is the down axis
var normal = new Vector2(myDirection.Y, -myDirection.X);
dot = Vector2.Dot(normal, targetDirection);
if(dot > 0)
    ; // target is on the left side
else
    ; // target is on the right side 
```

我希望这能让你的代码更容易更容易理解。您应该考虑在单独的方法中提取一些代码以使其更具可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:35:54.520

好的，我已经解决了，玩家轮换可以从 0 到 2 x PI + 或 -，保持它 + 虽然我输入

```
if (Rotation < 0)
    Rotation += (float)Math.PI * 2; 
```

到目标的旋转可以是 0-PI 或 0 - 负 PI，具体取决于您声明 atan2 的方式和玩家所在的位置。

```
//This works out the difference from the targets rotation to the players rotation.

RotationDif = TargetRotation - PlayerRotation;

//If the difference is greater than PI then when we check to see if its is within
//the range 0-PI or 0-Negative PI it will be missed whilst still possibly being on 
//either side of the player, adding PI * 2 to the targets rotation basically spins
//it past the player so the Difference will be the shortest angle.

if(Math.Abs(RotationDif) > Math.PI)
   RotationDif = TargetRotation + (float)(Math.PI * 2) - PlayerRotation;

//Next we check to see if the target is left(negative) or
//the right(positive), the negative/positive assignment will depend
//on which way round you did the atan2 to get the target rotation.

if ((RotationDif > 0) && (RotationDif < (float)Math.PI))

    //Insert right target code here

else if ((RotationDif < 0) && (RotationDif > -(float)Math.PI))

    //Insert left target code here

else

    //Insert no target code here to cover all basis 
```

就是这样，我制作了不同的 If (RotationDif > 0) 等，因此通过制作它来忽略前后 45 度角

```
If ((RotationDif > (float)(Math.PI / 8) &&
    (RotationDif < (float)(Math.PI - (Math.PI / 8))) 
```

而另一方则相反，希望这对其他人有所帮助，因为我花了将近 2 周的时间来锻炼：/

# java - 如何用鼠标滚轮移动 JSlider

> ID：14792039
> 
> 赞同：3
> 
> 时间：2013-02-09T21:55:05.933
> 
> 标签：java, swing, mousewheel, jslider, mouse-listeners

我有这段代码，但没有任何反应。我不知道为什么`degreesSlider.getValue() + 1`不起作用。如果有任何建议，我将不胜感激。

```
degreesSlider.addMouseWheelListener(new MouseWheelListener() {
    @Override
    public void mouseWheelMoved(MouseWheelEvent e) {
        int notches = e.getWheelRotation();
        if (notches < 0) {
            System.out.println("Mouse wheel moved UP " + -notches + " notch(es)");
            degreesSlider.setValue(degreesSlider.getValue() + 1);
        } else {
            System.out.println("Mouse wheel moved DOWN " + notches + " notch(es)");
            degreesSlider.setValue(degreesSlider.getValue() - 1);
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:38:49.573

这是使用鼠标滚轮旋转移动 JSlider 的代码演示。我希望这可以帮助您更有效地处理 JSlider 的鼠标滚轮旋转。

```
import javax.swing.*;
import java.awt.event.*;
public class JSliderDemo extends JFrame implements MouseWheelListener
{
    JSlider degreesSlider;
    public void prepareAndShowGUI()
    {
        degreesSlider = new JSlider(0,100);
        degreesSlider.setMajorTickSpacing(2);
        degreesSlider.setMinorTickSpacing(1);
        degreesSlider.setPaintLabels(true);
        degreesSlider.setPaintTicks(true);
        degreesSlider.setPaintTrack(true);
        degreesSlider.addMouseWheelListener(this);
        getContentPane().add(degreesSlider);
        setSize(1000,100);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
    }
    @Override
    public void mouseWheelMoved(MouseWheelEvent evt)
    {
        if (evt.getWheelRotation() < 0 )//mouse wheel was rotated up/away from the user
        {
            int iNewValue = degreesSlider.getValue() - degreesSlider.getMinorTickSpacing()  ;
            if (iNewValue >= degreesSlider.getMinimum())
            {
                degreesSlider.setValue(iNewValue);
            }
            else
            {
                degreesSlider.setValue(0);
            }
        }
        else
        {
            int iNewValue = degreesSlider.getValue() + degreesSlider.getMinorTickSpacing()  ;
            if (iNewValue <= degreesSlider.getMaximum())
            {
                degreesSlider.setValue(iNewValue);
            }
            else
            {
                degreesSlider.setValue(degreesSlider.getMaximum());
            }
        }
    }
    public static void main(String[] st)
    {
        SwingUtilities.invokeLater( new Runnable()
        {
            @Override
            public void run()
            {
                JSliderDemo jsd = new JSliderDemo();
                jsd.prepareAndShowGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:14:29.777

尝试运行有关[如何编写鼠标滚轮侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/mousewheellistener.html)的 Swing 教程中的代码。当我运行该代码时，似乎“凹口”仅针对每 3 个车轮移动单位发生变化。因此，当您向上滚动时，实际上每次向上滚动都会获得 3 个向下滚动，并且滑块会慢慢向 0 移动。

作为一个快速修复，我刚刚做了：

```
 if (notches < 0) {
        System.out.println("Mouse wheel moved UP " + -notches + " notch(es)");
        slider.setValue(slider.getValue() + 1);
    } else
    if (notches > 0) {
        System.out.println("Mouse wheel moved DOWN " + notches + " notch(es)");
        slider.setValue(slider.getValue() - 1);
    } 
```

# android - Android BluetoothSocket.isConnected 总是返回 false

> ID：14792040
> 
> 赞同：8
> 
> 时间：2013-02-09T21:55:09.883
> 
> 标签：android, api, bluetooth

我正在尝试检测蓝牙设备当前是否使用 API 14 或更高版本连接到 Android 设备。似乎我应该能够使用 BluetoothSocket.isConnected() 方法，但无论我做了什么，到目前为止，我都会得到错误的回报，无论是否连接。

AndroidManifest 包括以下几行：

```
<uses-permission android:name="android.permission.BLUETOOTH" />
<uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />

<!-- Locale 4.x supports API 14 or greater. -->
<uses-sdk android:minSdkVersion="14" android:targetSdkVersion="17" />

<uses-feature android:name="android.hardware.bluetooth" /> 
```

和有问题的代码：

```
protected void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Set<BluetoothDevice> pairedDevices = mBluetoothAdapter.getBondedDevices();

    for (BluetoothDevice device : pairedDevices) {
        Log.i(Constants.LOG_TAG, String.format(Locale.US, "Device: %s connected: %b", device.getName(), isConnected(device))); //$NON-NLS-1$z
    }
}

private boolean isConnected(BluetoothDevice device) {
    BluetoothSocket socket = null;

    // Get a BluetoothSocket for a connection with the given BluetoothDevice
    UUID SPP_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");
    try {
        socket = device.createRfcommSocketToServiceRecord(SPP_UUID);
    } catch (IOException e) {
        Log.e(Constants.LOG_TAG, e.getMessage()); //$NON-NLS-1$z
        return false;
    }

    Log.i(Constants.LOG_TAG, socket.toString()); //$NON-NLS-1$z

    return socket.isConnected();
} 
```

不会抛出任何错误，它只是在 100% 的时间里返回“false”。有什么我做的不对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-06T10:19:19.953

我相信 jkane001 已经解决了他的问题，所以我希望这个答案对其他人有所帮助。

首先在创建套接字之后

```
socket = device.createRfcommSocketToServiceRecord(SPP_UUID); 
```

您应通过以下方式启动连接

```
socket.connect(); 
```

之后，您将能够使用检查连接状态`socket.isConnected()`

由于`connect()`方法没有阻塞，所以套接字可能还没有连接。我建议使用这样的东西

```
while(!socket.isConnected() && trial++ < 3){
    try {
        Thread.sleep(300);
    } catch (Exception e) {}
} 
```

顺便说一句，我发现在某些 android 设备上`isConnected()`总是返回 false。在这种情况下，只需尝试向套接字写入一些内容并检查是否没有异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-06T18:51:37.240

显然有实现 isConnected() 的设备和/或 Android 版本（即该函数存在并且您可以调用它），但比无用更糟糕，因为它总是返回 false。我的办公桌上有一部运行 Android 4.2.2 的阿尔卡特手机，它表现出这种行为。

我的代码假设它已断开连接，因此杀死了我的连接线程，这让我发疯了很长时间。但是，我删除了 isConnected() 调用并假设它已连接，并且一切正常！除了等待错误并声明连接失效之外，我还没有找到更好的方法来检查有效连接。线程中被阻塞的 read() 最终会失败。

我们有来自该领域的报告听起来相似，并且我们知道版本的 2 个问题设备中的 2 个也在 4.2.2 上。尚未部署修复程序，因此不确定它是否修复了这些情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:06:53.107

首先，你为什么要使用反射？！这对我来说是一个危险信号。API 允许您通过蓝牙与另一台设备通信，请参阅[此链接](http://developer.android.com/reference/android/bluetooth/BluetoothDevice.html#createRfcommSocketToServiceRecord%28java.util.UUID%29)，因此您不应使用反射。

`connect`在调用其方法之前，套接字将始终返回未连接。您的代码似乎获得了套接字，但从未尝试与它建立连接。您首先需要调用[此方法](http://developer.android.com/reference/android/bluetooth/BluetoothSocket.html#connect%28%29)。

# javascript - 源映射 HTTP 请求不发送 cookie 标头

> ID：14792045
> 
> 赞同：6
> 
> 时间：2013-02-09T21:55:36.087
> 
> 标签：javascript, cookies, google-chrome-devtools, source-maps

关于源映射，我在 chromium 中遇到了一个奇怪的行为（build 181620）。在我的应用程序中，我使用的是缩小的 jquery，登录后，我开始在服务器日志文件中看到对“jquery.min.map”的 HTTP 请求。这些请求缺少 cookie 标头（所有其他请求都很好）。这些请求甚至没有在开发人员工具的 net 选项卡中公开（这对我来说并没有太多困扰）。

关键是，这个应用程序中的 js 文件应该只对登录的客户端可用，所以在这个设置中，源映射要么不起作用，要么我必须将源映射的位置更改为公共目录.

我的问题是：这是一种期望的行为（意思是源映射请求不应发送 cookie）还是 Chromium 中的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T10:35:31.830

[InspectorFrontendHost.cpp](http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/InspectorFrontendHost.cpp)中的`String InspectorFrontendHost::loadResourceSynchronously(const String& url)`实现（调用加载源映射资源）使用该标志，我相信这会导致您观察到的行为。`DoNotAllowStoredCredentials`

这种方法有潜在的危险，所以这个标志是为了让我们（你）保持安全，避免泄露敏感数据。

附带说明一下，`jquery.min.js`仅向登录用户（即，不是来自无 cookie 域的用户）提供信息在生产环境中部署并不是一个好主意。我不确定您背后的想法，但如果您确实需要避免将文件提供给未访问您网站的客户，您可以求助于检查`Referer`HTTP 请求标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-09T18:40:21.890

我遇到了这个问题，并对为什么某些身份验证 cookie 没有在 .js.map 文件的请求中发送到我们的应用程序感到好奇。

在我使用 Chrome 71.0.3578.98 进行的测试中，如果[SameSite cookie 属性](https://datatracker.ietf.org/doc/html/draft-west-first-party-cookies-07)设置为cookie`strict`或`lax`cookie，则 Chrome 在请求 .js.map 文件时不会发送该 cookie。当没有`sameSite`限制时，cookie 将被发送。

我不知道预期行为的任何规范。

# ruby-on-rails - Rake Cron 作业错误

> ID：14792053
> 
> 赞同：0
> 
> 时间：2013-02-09T21:56:59.920
> 
> 标签：ruby-on-rails, cron, rake

0/5 * * * * /bin/bash -l -c 'cd /home/mss/ruby/example && RAILS_ENV=development /usr/local/bin/bundle exec rake check_me_out --silent >> /tmp/cron_log.日志 2>&1'

上面的 cron 抛出错误“bash: bundle: command not found...”

该命令从命令行工作得很好

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T22:25:56.297

好的，所以我得到了这个工作。Cron 不加载配置文件设置。我必须将 bash_profile 作为命令的一部分加载，现在它可以工作了。

0/5 * * * * /bin/bash -l -c 'source ~/.bash_profile && cd /home/mss/ruby/example && RAILS_ENV=development bin/rake check_me_out --silent >> /tmp/cron_log.log 2>&1'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T06:51:00.870

我遇到了同样的问题。

在 CRON 中设置正确的 RVM 路径时，我已经解决了它：

** * * * /bin/bash -l -c 'cd /home/alex/Projects/my_app && source ~/.bash_profile && rvm use ruby​​-1.9.3-p194-perf && bundle exec rake RAILS_ENV=development my_tasks - -silent >> /tmp/cron_log.log 2>&1'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-15T07:47:50.540

当我在 AWS EC2 服务器上设置 cron 时，我也遇到了同样的问题。它是通过在`config/schedule.rb`文件中明确设置捆绑路径来解决的。

```
set :bundle_command, "/usr/local/bin/bundle exec" 
```

这会在 cron 中创建条目，例如：

```
30 1 * * * /bin/bash -l -c 'cd <app_path> && RAILS_ENV=beta /usr/local/bin/bundle exec rake 'task_name' --silent >> log/cron.log 2>&1' 
```

# ios - 重构 iOS 代码：减少代码行数

> ID：14792055
> 
> 赞同：0
> 
> 时间：2013-02-09T21:57:13.327
> 
> 标签：ios, optimization, coding-style, refactoring

我第一次在这里发布一个带有实际工作代码的问题！但是，我相信有一种方法可以减少代码行数。希望有大神给我指路。

这是供参考的故事板窗口：

![在此处输入图像描述](../Images/89f6625fc106687c73b193f0f3493d3b.png)

我有一个带有 containerView 的主 ViewController。ContainerView 有它自己的导航控制器。主视图控制器左侧的每个按钮 (B1-B5) 与其各自的场景编号相连。即 B2 会将场景 2 推入堆栈。B4 将场景 4 推入堆栈。如果 visibleViewContoller 是场景 5，并且用户按下 B1，它将弹出所有 viewController，直到我们到达场景 1。依此类推。

下面的代码再次运行良好，我只是想缩小 B1 和 B2 的代码大小：

```
- (IBAction)B1Pressed:(id)sender {

UINavigationController *navController = [self.childViewControllers objectAtIndex:0];
NSMutableArray *VCs = [navController.viewControllers mutableCopy];
UIViewController *visibleViewController = [navController visibleViewController];

if (visibleViewController == [VCs objectAtIndex:0])
{
    return;
}
else if (visibleViewController ==[VCs objectAtIndex:1])
{
     [navController popViewControllerAnimated:YES];
}

else if (visibleViewController ==[VCs objectAtIndex:2])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];
}

else if (visibleViewController ==[VCs objectAtIndex:3])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];

}
else if (visibleViewController ==[VCs objectAtIndex:4])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];

}
else if (visibleViewController ==[VCs objectAtIndex:5])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];

    }
}

- (IBAction)B2Pressed:(id)sender {

UINavigationController *navController = [self.childViewControllers objectAtIndex:0];
NSMutableArray *VCs = [navController.viewControllers mutableCopy];
UIViewController *visibleViewController = [navController visibleViewController];

if (visibleViewController == [VCs objectAtIndex:0])
{
    STLMEatDrinkViewController *stlmEDVC = [self.storyboard instantiateViewControllerWithIdentifier:@"B2"];
    [navController pushViewController:stlmEDVC animated:YES];
}
else if (visibleViewController ==[VCs objectAtIndex:1])
{
    return;
}

else if (visibleViewController ==[VCs objectAtIndex:2])
{
    [navController popViewControllerAnimated:YES];
}

else if (visibleViewController ==[VCs objectAtIndex:3])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];

}
else if (visibleViewController ==[VCs objectAtIndex:4])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];

}
else if (visibleViewController ==[VCs objectAtIndex:5])
{
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:NO];
    [navController popViewControllerAnimated:YES];   
 }
} 
```

现在想象为 B3Pressed、B4Pressed 和 B5Pressed 再写 3 次相同的代码。我认为代码太多了，我几乎肯定有更好的方法来解决这个问题。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:01:37.750

1.) 您不得使用 比较对象`==`。使用`isEqual:`.

2.) 循环。

```
int idx = [VCs indexOfObject:visibleViewController];

if (idx == 0) {
    STLMEatDrinkViewController *stlmEDVC = [self.storyboard instantiateViewControllerWithIdentifier:@"B2"];
    [navController pushViewController:stlmEDVC animated:YES];
} else if (idx == 1) {
    return;
} else {
    int i;
    for (i = 2; i < idx; i++) {
        [navController popViewControllerAnimated:NO];
    }

    [navController popViewControllerAnimated:YES];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:07:26.800

我认为这可以解决您的问题：

```
- (IBAction)B1Pressed:(id)sender
{
    UINavigationController *navController = [self.childViewControllers objectAtIndex:0];
    UIViewController *B1ViewController = [navController.viewControllers objectAtIndex:0];
    [navController popToViewController:B1ViewController animated:YES];
} 
```

# android - android枚举USB应用程序

> ID：14792057
> 
> 赞同：2
> 
> 时间：2013-02-09T21:57:16.247
> 
> 标签：android, usb, enumerate, accessory

我有一个使用 USB 附件的应用程序。该应用程序设置为在插入设备然后启动应用程序时使用 Intent 过滤器自动检测设备。我的清单遵循 android 开发示例：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.switchpanel"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="12"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.switchpanel.MainActivity"
            android:label="@string/app_name"
            android:screenOrientation="landscape"  >

            <intent-filter>
               <action android:name="android.hardware.usb.action.USB_ACCESSORY_ATTACHED"/>
            </intent-filter>

            <meta-data 
                android:name="android.hardware.usb.action.USB_ACCESSORY_ATTACHED"
                android:resource="@xml/accessory_filter">
            </meta-data> 

                   </activity>
    </application>

</manifest> 
```

**我需要应用程序运行，然后在应用程序运行后枚举（连接）到设备！**

为此，我知道您需要请求许可、getlist、枚举、广播……等等。

不完全确定如何实现所有这些以及如何设置清单（使用什么意图）。

任何人都可以阐明或更好地展示一个示例应用程序来说明这一切是如何设置的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T18:58:49.703

FTDI[在这里](http://www.ftdichip.com/Support/SoftwareExamples/Android_Projects.htm)提供了一些演示应用程序，展示了如何建立 USB 通信。

希望这可以帮助。

# delphi - 检查帧上 TEdit 的文本属性是否为空

> ID：14792059
> 
> 赞同：1
> 
> 时间：2013-02-09T21:57:26.307
> 
> 标签：delphi, delphi-xe2

所以这是我的情况。我有一个表单（MainMenu）和一个框架（TestFrame）。TestFrame 显示在位于 MainMenu 的 TPanel 上。使用此代码：

```
frTestFrame := TfrTestFrame.Create(nil);
frTestFrame.Parent := plMain;
frTestFrame.Align := alClient;
frTestFrame.Visible := true; 
```

TestFrame 显示正常，没有错误。TestFrame 上有几个 TEdit 框。MainMenu 上的 TButton 调用位于 TestFrame 中的过程来检查 TEdit 框文本属性是否为空。

```
procedure TfmMainMenu.tbCheckClick(Sender: TObject);
begin
frTestFrame.Check;
end; 
```

TestFrame 上的这个函数应该遍历所有“TEdit”组件并使用函数 GetErrorData，如果 TEdit 的 text 属性为空，则该函数返回一个字符串。该字符串被添加到 TStringList 并在任何 TEdit 框为空时显示。

```
function TfrTestFrame.Check: Boolean;
var
 ErrorList: TStringList;
 ErrorString: string;
 I: Integer;
begin
 ErrorList := TStringList.Create;
 for I := 0 to (frTestFrame.ComponentCount - 1) do
begin
  if (frTestFrame.Components[I] is TEdit) then
    begin
      ErrorString := GetErrorData(frTestFrame.Components[I]);
      if (ErrorString <> '') then
        begin
          ErrorList.Add(ErrorString);
        end;
    end;
end;
if (ErrorList.Count > 0) then
begin
  ShowMessage('Please Add The Following Information: ' + #13#10 + ErrorList.Text);
  result := false;
end;
result := true;
end;

function TfrTestFrame.GetErrorData(Sender: TObject): string;
var
 Editbox: TEdit;
 ErrorString: string;
begin
if (Sender is TEdit) then
 begin
   Editbox := TEdit(Sender);
   if (Editbox.Text <> '') then
     begin
       Editbox.Color := clWindow;
       result := '';
     end
   else
    begin
      Editbox.Color := clRed;
      ErrorString := Editbox.Hint;
      result := ErrorString;
    end;
end;
end; 
```

问题是，当它到达“for I := 0 to (frTestFrame.ComponentCount - 1) do”行时，它会爆炸，我收到错误“0x00458 处的访问冲突......读取地址 0x000......”我不知道为什么会发生这个错误。我只能假设框架可能没有被创建。任何帮助都会很棒。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:11:52.240

根据你的问题，这条线

```
for I := 0 to (frTestFrame.ComponentCount - 1) do 
```

导致 address 的访问冲突`0x000....`。现在，首先，您为什么不告诉我们带有完整详细信息的准确错误消息？隐藏地址会更难！

无论如何，看起来地址将是一个非常接近于零的值。无论如何，对访问冲突的唯一解释`frTestFrame`是无效的。很可能是`nil`。

我注意到有问题的代码在一个`TfrTestFrame`方法中。那么为什么要使用`frTestFrame`来指代对象呢？您已经在对象的实例中。你有多个名为的全局变量`frTestFrame`吗？也许一个在主窗体单元中，一个在框架单元中？

您应该停止为您的 GUI 对象使用全局变量。我知道 IDE 会以这种方式引导您。抵制以这种方式编程的诱惑。滥用全局变量会导致痛苦和痛苦。

由于代码位于`TfrTestFrame`您可以使用的方法中`Self`。在您的所有`TfrTestFrame`方法中，删除所有对`frTestFrame`. 你的循环应该是这样的：

```
for I := 0 to ComponentCount - 1 do 
```

并且该类中的其余方法需要类似的处理。请注意，您不需要显式编写`Self`，而且习惯上不要这样做。

最后，我敦促您学习如何使用调试器。这是一个很棒的工具，如果您使用它，它会告诉您问题所在。不要束手无策，让工具来帮助你。

# vb.net - vb.net 访问数据库

> ID：14792060
> 
> 赞同：0
> 
> 时间：2013-02-09T21:57:29.343
> 
> 标签：vb.net, ms-access, dao

我正在尝试将查询中的字段读入文本字符串数组。在 vb6 中，我可以简单地声明数组，然后将字段读入其中，而无需关心其中包含什么类型的值。现在，当我尝试做同样的事情时，我得到一个*"unable to cast com object of type 'dao.fieldclass' to type 'system.string"*。我是否需要将字段值读入单独的变量，然后将其转换为字符串？这`seqNum`就是我遇到的问题

```
Public dbEngine As dao.DBEngine
Public db As dao.Database, recSet As dao.Recordset
dbEngine = New dao.DBEngine
Dim seqNum As Long
scExportTemplatePath = "M:\robot\scTemplates\"
db = dbEngine.OpenDatabase(scExportStuffPath & "scExport.mdb")
tsOut = fso.CreateTextFile(wildePath & dte & "-" & fle.Name & ".csv", True)
With recSet
    .MoveFirst()
    Do While Not .EOF
        seg = .Fields("segmentID")
        If seg <> segHold Then
            seqNum = 1
        End If
        arrOut(0) = .Fields("jobnum_AM")
    Loop
End With 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:05:41.963

这段代码有几个问题。除了杰里米提到的几点：

1.  `Long`VB6 中的内容现在在`Integer`VB.NET 中。`Long`现在是 64 位整数。

2.  用于`System.IO.Path.Combine`组合路径字符串。`Combine`自动添加缺少的反斜杠并删除多余的反斜杠。`Path.Combine(scExportTemplatePath, "scExport.mdb")`

3.  该`Field`属性不再具有默认属性。非索引属性永远不是 VB.NET 中的默认属性。使用 获取字段值`.Fields("segmentID").Value`。

4.  将其值转换为适当的类型：`seg = Convert.ToInt32(.Fields("segmentID").Value)`
    注意：VB 的`Integer`类型只是`System.Int32`.

5.  您总是添加到同一个数组字段。我不知道你到底在想什么。如果您只想添加一个字段，则可以使用`List(Of String)`. 如果您为每条记录添加多个字段，那么`List(Of String())`（即字符串数组列表）将是合适的。列表具有自动增长的优势。

```
Dim list As New List(Of String())
Do While Not .EOF
    Dim values = New String(2) {}
    values(0) = Convert.ToString(.Fields("field_A").Value)
    values(1) = Convert.ToString(.Fields("field_B").Value)
    values(2) = Convert.ToString(.Fields("field_C").Value)
    list.Add(values)
    recSet.MoveNext()
Loop 
```

但是，如果您创建一个自定义类来存储字段值，则更容易理解：

```
Console.WriteLine("{0} {1} ({2})", user.FirstName, user.LastName, user.DateOfBirth) 
```

...读起来比：

```
Console.WriteLine("{0} {1} ({2})", values(0), values(1), values(2)) 
```

* * *

在 VB.NET 中，您还有其他使用数据库的可能性：

```
Dim list As New List(Of String())
Using conn = New OleDb.OleDbConnection( _
        "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=MyPath\MyDb.mdb")
    Dim sql = "SELECT myStuff FROM myTable"
    Dim command = New OleDbCommand(sql, conn)
    conn.Open()
    Using reader As OleDbDataReader = command.ExecuteReader()
        While reader.Read()
            Dim values = New String(reader.FieldCount - 1) {}
            For i = 0 To reader.FieldCount - 1
                values(i) = Convert.ToString(reader.GetValue(i))
            Next
            list.Add(values)
        End While
    End Using
End Using 
```

请注意，该`Using`语句最后会自动关闭资源。即使发生错误并且代码过早终止。

* * *

在 VB.NET 中，您可以写入这样的文件（不使用 fso，它不像 .NET）

```
Using writer As New StreamWriter("myFile.txt", False)
    writer.WriteLine("line 1")
    writer.WriteLine("line 2")
    writer.WriteLine("line 3")
End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:28:28.870

1) You dont show how you open the Recordset, eg:

```
Set recSet = db.OpenRecordset("query_name or SQL") 
```

2) You dont have a .MoveNext in the While Loop:

```
With recSet
 .MoveFirst()
  Do While Not .EOF
  seg = .Fields("segmentID")
    If seg <> segHold Then
     seqNum = 1
    End If
    arrOut(0) = .Fields("jobnum_AM")
    .MoveNext()
  loop 
```

# c# - TCP ZeroWindow 问题 C#

> ID：14792061
> 
> 赞同：1
> 
> 时间：2013-02-09T21:57:56.090
> 
> 标签：c#, tcp, client, tcpclient, tcpserver

我一直在用 c# 编写一个文件服务器/客户端应用程序，它似乎正在工作，但后来我意识到流没有被推进，客户端一直无法从服务器接收。所以我检查了wireshark，发现我的客户端正在发送带有TCPZeroWindow标记的数据包。有什么想法吗？谢谢。

客户 ：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.Net.Sockets;
using System.IO;
namespace PortalClient
{
    class Program
    {
        static string s1;
        static byte[] data03;
        static int int02;
        static string str01;
        static int length;
        static IPEndPoint ipe01;
        static TcpClient tcp01;
        static FileStream s01;
        static string ip01;
        static string port01;
        static string path01;
        static byte[] data01;
        static byte[] data02;
        static byte[] data04;
        static void Main(string[] args)
        {

            while (true)
            {
            label1:
                {
                    try
                    {
                        string version = "V:1.1.4";
                        Console.Title = (" Portal Client " + version);
                        ConsoleColor ccolor1 = new ConsoleColor();
                        ccolor1 = Console.ForegroundColor;
                        Console.ForegroundColor = ConsoleColor.Green;
                        Console.WriteLine();
                        Console.WriteLine("         PORTAL CLIENT " + version);
                        Console.WriteLine();
                        Console.ForegroundColor = ccolor1;
                        data01 = new byte[20];
                        data03 = new byte[100];
                        data04 = new byte[100];
                        Console.Write(" Enter IPv4 address of server : ");
                        ip01 = Console.ReadLine();
                        Console.Write(" Enter port to connect on : ");
                        port01 = Console.ReadLine();
                        ipe01 = new IPEndPoint(IPAddress.Parse(ip01), Convert.ToInt32(port01));
                        tcp01 = new TcpClient();
                        tcp01.ReceiveTimeout = 2500;
                        tcp01.NoDelay = true;
                        Console.WriteLine(" Connecting...");
                        tcp01.Connect(ipe01);
                        Console.WriteLine(" Done.");
                        tcp01.Client.Receive(data04, SocketFlags.None);
                        System.Threading.Thread.Sleep(100);
                        Console.WriteLine(" Server message : " + Encoding.UTF8.GetString(data04));
                        tcp01.Client.Receive(data03, SocketFlags.None);
                        System.Threading.Thread.Sleep(100);
                        Console.WriteLine(" File on server : " + Encoding.UTF8.GetString(data03));
                        tcp01.Client.Receive(data01, SocketFlags.None);
                        System.Threading.Thread.Sleep(100);
                        str01 = Encoding.UTF8.GetString(data01);
                        Console.WriteLine();
                        Console.WriteLine(" file size : " + str01);
                        Console.WriteLine();
                        Console.Write(" Enter the number you see above : ");
                        length = Convert.ToInt32(Console.ReadLine());
                        Console.Write(" Save file as : ");
                        path01 = Console.ReadLine();
                        for (int i = 1; i <= 9000; i++)
                        {
                            if (length % i == 0) { int02 = i; }
                        }
                        if (length < 9000) { int02 = length; }
                        int int03 = length / int02;
                        s01 = File.OpenWrite(@path01);
                        Console.WriteLine(" Receiving file from " + tcp01.Client.RemoteEndPoint.ToString() + "...");
                        tcp01.Client.Send(new byte[1], SocketFlags.None);
                        System.Threading.Thread.Sleep(1000);
                        for (int i = 0; i <= int03; i++)
                        {
                            bool bool1 = false;
                            data02 = new byte[int02];
                            int n = tcp01.Client.Receive(data02, 0, int02, SocketFlags.None);
                            while (n < int02)
                            {
                                Console.WriteLine(" Entered Loop ");
                                int int04 = int02 - n;
                                tcp01.Client.Send(Encoding.UTF8.GetBytes("2"), 0, 1, SocketFlags.None);
                                int int05 = 0;
                                byte[] data05 = new byte[int04];
                                if (int04 >= 1 && int04 <= 9) { s1 = int04 + "xxx"; }
                                if (int04 >= 10 && int04 <= 99) { s1 = int04 + "xx"; }
                                if (int04 >= 100 && int04 <= 999) { s1 = int04 + "x"; }
                                if (int04 >= 1000 && int04 <= 9000) { s1 = int04.ToString(); }
                                tcp01.Client.Send(Encoding.UTF8.GetBytes(s1), 0, 4, SocketFlags.None);
                                int05 = tcp01.Client.Receive(data05, 0, int04, SocketFlags.None);
                                n = n + int05;
                                s01.Write(data05, 0, int05);
                                bool1 = true;
                            }
                            if (bool1 == false)
                            {
                                s01.Write(data02, 0, int02);
                                tcp01.Client.Send(new byte[1], 0, 1, SocketFlags.None);
                            }
                        }
                        System.Threading.Thread.Sleep(1000);
                        s01.Close();
                        Console.WriteLine(" Received all data.");
                        Console.WriteLine(" Press enter to disconnect...");
                        Console.ReadLine();
                        tcp01.Client.Send(new byte[1], SocketFlags.None);
                        System.Threading.Thread.Sleep(1000);
                        Console.WriteLine(" Disconnecting...");
                        tcp01.Close();
                        Console.WriteLine(" Done.");
                    }
                    catch (Exception e)
                    {
                        Console.WriteLine(" Error! : " + e.Message.ToString() + " - " + e.Data.ToString() + " - " + e.TargetSite.ToString()); if (!(tcp01 == null)) { tcp01.Close(); } if (!(s01 == null)) { s01.Close(); goto label1; }
                    }
                }

            }
        }
    }
} 
```

服务器 ：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.Net.Sockets;
using System.IO;
namespace PortalServer
{
    class Program
    {
        static long length;
        static int int03;
        static int int02;
        static TcpListener tcp01;
        static TcpClient tcp02;
        static FileStream s01;
        static byte[] data01;
        static byte[] data03;
        static byte[] data04;
        static byte[] data05;
        static string str01;
        static string str02;
        static IPEndPoint ipe01;
        static string port01;
        static void Main(string[] args)
        {
            while (true)
            {
            label1:
                try
                {
                    string version = "V:1.1.4";
                    Console.Title = (" Portal Server " + version);
                    ConsoleColor ccolor1 = new ConsoleColor();
                    ccolor1 = Console.ForegroundColor;
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine();
                    Console.WriteLine("         PORTAL SERVER " + version);
                    Console.WriteLine();
                    Console.ForegroundColor = ccolor1;
                    Console.Write(" Enter port for connecting clients : ");
                    port01 = Console.ReadLine();
                    Console.Write(" Enter path of file to send : ");
                    str01 = Console.ReadLine();
                    ipe01 = new IPEndPoint(IPAddress.Any, Convert.ToInt32(port01));
                    tcp01 = new TcpListener(ipe01);
                    Console.Write(" Enter server message : ");
                    str02 = Console.ReadLine();
                    s01 = File.OpenRead(@str01);
                    length = s01.Length;
                    for (int i = 1; i <= 9000; i++)
                    {
                        if (length % i == 0) { int02 = i; } 
                    }
                    if (length < 9000) { int02 = (int)length;}

                    int03 = (int)length / int02;
                    tcp01.Start();
                    Console.WriteLine(" Server started. Waiting for clients...");
                    tcp02 = tcp01.AcceptTcpClient();
                    tcp02.Client.NoDelay = true;
                    Console.WriteLine(" Client " + tcp02.Client.RemoteEndPoint.ToString() + " connected.");
                    data05 = Encoding.UTF8.GetBytes(str02);
                    tcp02.Client.Send(data05, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    data04 = Encoding.UTF8.GetBytes(str01);
                    tcp02.Client.Send(data04, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    data03 = Encoding.UTF8.GetBytes(length.ToString());
                    tcp02.Client.Send(data03, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    Console.WriteLine(" Waiting for response...");
                    tcp02.Client.Receive(new byte[1], SocketFlags.None);
                    Console.WriteLine(" Received response...");
                    Console.WriteLine(" Sending file to " + tcp02.Client.RemoteEndPoint.ToString() + "...");
                    System.Threading.Thread.Sleep(1);
                    for (int i = 0; i <= int03;i++ )
                    {
                        System.Threading.Thread.Sleep(30);
                        data01 = new byte[int02];
                        s01.Read(data01, 0, data01.Length);
                        int n = tcp02.Client.Send(data01, 0 ,data01.Length, SocketFlags.None);
                        if (n != int02) { throw new Exception("unable to write bytes, insufficient memory."); }
                        byte[] data07 = new byte[1];
                        while (true)
                        {
                            tcp02.Client.Receive(data07,0,1,SocketFlags.None);
                            if (Encoding.UTF8.GetString(data07) == "2") 
                            {
                                byte[] data06 = new byte[4];
                                int b = tcp02.Client.Receive(data06, 0, 4, SocketFlags.None);
                                if (b != 4) { throw new Exception("ex1"); }
                                string s1 = Encoding.UTF8.GetString(data06);
                                s1 = s1.Replace("x", "");
                                int int05 = Convert.ToInt32(s1);
                                int int06 = int02 - int05;
                                byte[] data08 = new byte[int05];
                                Buffer.BlockCopy(data01, int06, data08, 0, int05);
                                tcp02.Client.Send(data08, 0, data08.Length, SocketFlags.None);
                                System.Threading.Thread.Sleep(30);
                            }
                            break;
                        }
                    }
                    System.Threading.Thread.Sleep(1000);
                    s01.Close();
                    Console.WriteLine(" All data sent.");
                    Console.WriteLine(" Waiting for terminate message...");
                    tcp02.Client.Receive(new byte[1], SocketFlags.None);
                    Console.WriteLine(" Received terminate message.");
                    tcp02.Close();
                    Console.WriteLine(" Stopping client and server.");
                    tcp01.Stop();
                    Console.WriteLine(" Done. Restarting.");

                }

                catch (Exception e)
                {
                    Console.WriteLine(" Error! : " + e.Message.ToString() + " - " + e.Data.ToString() + " - " + e.TargetSite.ToString());
                    if (!(tcp02 == null)) { tcp02.Close(); }
                    if (!(tcp01 == null)) { tcp01.Stop(); goto label1; }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:06:36.313

如果您没有在客户端正确清空网络缓冲区并且因此 TCP 窗口大小减小到零，我已经看到这种情况发生。

这可能发生在您使用

```
tcp01.Client.Receive(data04, SocketFlags.None); 
```

这可能没有充分清除缓冲区，请参阅[MSDN](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)。您想连续调用 Receive 直到没有更多数据可用。

如果您想要一个工作示例作为比较，请参见[此处](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T03:20:57.413

我为繁重的发送/接收方法使用了单独的线程，增加了缓冲区大小，增加了发送之间的时间，确保碎片处于打开状态。现在就像一个魅力。

客户 ：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.Net.Sockets;
using System.IO;
using System.ComponentModel;
namespace PortalClient
{
    class Program
    {
        static int partloop;
        static bool bool1;
        static byte[] data05;
        static int int03;
        static int int04;
        static int int05;
        static int numbytesreceived;
        static BackgroundWorker bw1;
        static int bytestoreceive;
        static string s1;
        static byte[] data03;
        static int int02;
        static string str01;
        static int length;
        static IPEndPoint ipe01;
        static TcpClient tcp01;
        static FileStream s01;
        static string ip01;
        static string port01;
        static string path01;
        static byte[] data01;
        static byte[] data02;
        static byte[] data04;
        static void Main(string[] args)
        {
            newvoid();
        }
        static void newvoid()
        {
            while (true)
            {
                try
                {
                    Console.Clear();
                    Console.WindowWidth = 95;
                    string version = "V:1.1.4";
                    Console.Title = (" Portal Client " + version);
                    ConsoleColor ccolor1 = new ConsoleColor();
                    ccolor1 = Console.ForegroundColor;
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine();
                    Console.WriteLine(@"
 __________              __         .__    _________ .__  .__               __   
 \______   \____________/  |______  |  |   \_   ___ \|  | |__| ____   _____/  |_ 
  |     ___/  _ \_  __ \   __\__  \ |  |   /    \  \/|  | |  |/ __ \ /    \   __\
  |    |  (  <_> )  | \/|  |  / __ \|  |__ \     \___|  |_|  \  ___/|   |  \  |  
  |____|   \____/|__|   |__| (____  /____/  \______  /____/__|\___  >___|  /__|  
                                  \/               \/             \/     \/       " + version);
                    Console.WriteLine();
                    Console.ForegroundColor = ccolor1;
                    data01 = new byte[20];
                    data03 = new byte[100];
                    data04 = new byte[100];
                    Console.Write(" Enter IPv4 address of server : ");
                    ip01 = Console.ReadLine();
                    Console.Write(" Enter port to connect on : ");
                    port01 = Console.ReadLine();
                    ipe01 = new IPEndPoint(IPAddress.Parse(ip01), Convert.ToInt32(port01));
                    tcp01 = new TcpClient();
                    Console.WriteLine(" Connecting...");
                    tcp01.Connect(ipe01);
                    Console.WriteLine(" Done.");
                    tcp01.Client.Receive(data04, SocketFlags.None);
                    System.Threading.Thread.Sleep(100);
                    Console.WriteLine(" Server message : " + Encoding.UTF8.GetString(data04));
                    tcp01.Client.Receive(data03, SocketFlags.None);
                    System.Threading.Thread.Sleep(100);
                    Console.WriteLine(" File on server : " + Encoding.UTF8.GetString(data03));
                    tcp01.Client.Receive(data01, SocketFlags.None);
                    System.Threading.Thread.Sleep(100);
                    str01 = Encoding.UTF8.GetString(data01);
                    Console.WriteLine();
                    Console.WriteLine(" file size : " + str01);
                    Console.WriteLine();
                    Console.Write(" Enter the number you see above : ");
                    length = Convert.ToInt32(Console.ReadLine());
                    bytestoreceive = length;
                    Console.Write(" Save file as : ");
                    path01 = Console.ReadLine();
                    for (int i = 1; i <= 60000; i++)
                    {
                        if (length % i == 0) { int02 = i; }
                    }
                    if (length < 60000) { int02 = length; }
                    int03 = length / int02;
                    s01 = File.OpenWrite(@path01);
                    Console.WriteLine(" Receiving file from " + tcp01.Client.RemoteEndPoint.ToString() + "...");
                    tcp01.Client.Send(new byte[1], SocketFlags.None);
                    System.Threading.Thread.Sleep(1000);
                    while (bytestoreceive > 0)
                    {
                        bw1 = new BackgroundWorker();
                        bw1.DoWork += new DoWorkEventHandler(bw1_DoWork);
                        bw1.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw1_RunWorkerCompleted);
                        bool1 = false;
                        numbytesreceived = 0;
                        data02 = new byte[int02];
                        bw1.RunWorkerAsync();
                        while (numbytesreceived == 0) { }
                        while (numbytesreceived < int02)
                        {
                            bw1 = new BackgroundWorker();
                            bw1.DoWork += new DoWorkEventHandler(bw1_DoWork);
                            bw1.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw1_RunWorkerCompleted);
                            bool1 = true;
                            partloop += 1;
                            int04 = int02 - numbytesreceived;
                            tcp01.Client.Send(Encoding.UTF8.GetBytes("2"), 0, 1, SocketFlags.None);
                            int05 = 0;
                            data05 = new byte[int04];
                            if (int04 >= 1 && int04 <= 9) { s1 = int04 + "xxxx"; }
                            if (int04 >= 10 && int04 <= 99) { s1 = int04 + "xxx"; }
                            if (int04 >= 100 && int04 <= 999) { s1 = int04 + "xx"; }
                            if (int04 >= 1000 && int04 <= 9999) { s1 = int04 + "x"; }
                            if (int04 > 10000 && int04 <= 60000) { s1 = int04.ToString(); }
                            tcp01.Client.Send(Encoding.UTF8.GetBytes(s1), 0, 5, SocketFlags.None);
                            bw1.RunWorkerAsync();
                            while (int05 == 0) { }
                            if (int05 == 0) { throw new Exception("ex1"); }
                            numbytesreceived += int05;
                            bytestoreceive -= numbytesreceived;
                            s01.Write(data05, 0, data05.Length);
                            Console.WriteLine(" Received " + (length - bytestoreceive) + " / " + length + " bytes | P.B.R. loops: " + partloop.ToString());
                            Console.SetCursorPosition(0, Console.CursorTop - 1);
                        }

                        if (bool1 == false)
                        {

                            bytestoreceive -= numbytesreceived;
                            s01.Write(data02, 0, int02);
                            tcp01.Client.Send(new byte[1], 0, 1, SocketFlags.None);
                            Console.WriteLine(" Received " + (length - bytestoreceive) + " / " + length + " bytes | P.B.R. loops: " + partloop.ToString());
                            Console.SetCursorPosition(0, Console.CursorTop - 1);
                        }
                    }
                    Console.SetCursorPosition(0, Console.CursorTop + 1);
                    Console.WriteLine();
                    System.Threading.Thread.Sleep(500);
                    s01.Close();
                    Console.WriteLine(" Received all data.");
                    Console.WriteLine(" Press enter to disconnect...");
                    Console.ReadLine();
                    tcp01.Client.Send(new byte[1], SocketFlags.None);
                    System.Threading.Thread.Sleep(1000);
                    Console.WriteLine(" Disconnecting...");
                    tcp01.Close();
                    Console.WriteLine(" Done.");
                }
                catch (Exception e)
                {
                    Console.WriteLine(" Error! : " + e.Message.ToString() + " - " + e.Data.ToString() + " - " + e.TargetSite.ToString());
                    if (!(tcp01 == null)) { tcp01.Close(); }
                    if (!(s01 == null)) { s01.Close(); }
                    Console.Write(" Press enter to continue..."); Console.ReadLine();
                    newvoid();
                }
            }
        }

        static void bw1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            try
            {
                bw1.Dispose();
            }
            catch (Exception e1)
            {
                Console.WriteLine(" Error! : " + e1.Message.ToString() + " - " + e1.Data.ToString() + " - " + e1.TargetSite.ToString());
                if (!(tcp01 == null)) { tcp01.Close(); }
                if (!(s01 == null)) { s01.Close(); }
                Console.Write(" Press enter to continue..."); Console.ReadLine();
                newvoid();
            }
        }

        static void bw1_DoWork(object sender, DoWorkEventArgs e)
        {
            try
            {
                if (bool1 == false)
                {
                    numbytesreceived = tcp01.Client.Receive(data02, 0, int02, SocketFlags.None);
                }
                if (bool1 == true)
                {
                    int05 = tcp01.Client.Receive(data05, 0, int04, SocketFlags.None);
                }
            }
            catch (Exception e2)
            {
                Console.WriteLine(" Error! : " + e2.Message.ToString() + " - " + e2.Data.ToString() + " - " + e2.TargetSite.ToString());
                if (!(tcp01 == null)) { tcp01.Close(); }
                if (!(s01 == null)) { s01.Close(); }
                Console.Write(" Press enter to continue..."); Console.ReadLine();
                newvoid();
            }
        }
    }
} 
```

服务器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net;
using System.Net.Sockets;
using System.IO;
using System.ComponentModel;
namespace PortalServer
{
    class Program
    {
        static int bytesresent;
        static BackgroundWorker bw1;
        static int int06;
        static int int05;
        static string string01;
        static int bytesCreceived;
        static byte[] data06;
        static byte[] data07;
        static byte[] data08;
        static int bytessent;
        static bool bool1;
        static int bytestosend;
        static long length;
        static int int03;
        static int int02;
        static TcpListener tcp01;
        static TcpClient tcp02;
        static FileStream s01;
        static byte[] data01;
        static byte[] data03;
        static byte[] data04;
        static byte[] data05;
        static string str01;
        static string str02;
        static IPEndPoint ipe01;
        static string port01;
        static void Main(string[] args)
        {
            newvoid();
        }
        static void newvoid()
        {
            while (true)
            {
                try
                {
                    Console.Clear();
                    Console.WindowWidth = 95;
                    string version = "V:1.1.4";
                    Console.Title = (" Portal Server " + version);
                    ConsoleColor ccolor1 = new ConsoleColor();
                    ccolor1 = Console.ForegroundColor;
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine();
                    Console.WriteLine(@"
 __________              __         .__      _________                                
 \______   \____________/  |______  |  |    /   _____/ ______________  __ ___________ 
  |     ___/  _ \_  __ \   __\__  \ |  |    \_____  \_/ __ \_  __ \  \/ // __ \_  __ \
  |    |  (  <_> )  | \/|  |  / __ \|  |__  /        \  ___/|  | \/\   /\  ___/|  | \/
  |____|   \____/|__|   |__| (____  /____/ /_______  /\___  >__|    \_/  \___  >__|   
                                  \/               \/     \/                 \/       " + version);
                    Console.WriteLine();
                    Console.ForegroundColor = ccolor1;
                    Console.Write(" Enter port for connecting clients : ");
                    port01 = Console.ReadLine();
                    Console.Write(" Enter path of file to send : ");
                    str01 = Console.ReadLine();
                    ipe01 = new IPEndPoint(IPAddress.Any, Convert.ToInt32(port01));
                    tcp01 = new TcpListener(ipe01);
                    Console.Write(" Enter server message : ");
                    str02 = Console.ReadLine();
                    s01 = File.OpenRead(@str01);
                    length = s01.Length;
                    bytestosend = (int)length;
                    for (int i = 1; i <= 60000; i++)
                    {
                        if (length % i == 0) { int02 = i; }
                    }
                    if (length < 60000) { int02 = (int)length; }

                    int03 = (int)length / int02;
                    tcp01.Start();
                    Console.WriteLine(" Server started. Waiting for clients...");
                    tcp02 = tcp01.AcceptTcpClient();
                    Console.WriteLine(" Client " + tcp02.Client.RemoteEndPoint.ToString() + " connected.");
                    data05 = Encoding.UTF8.GetBytes(str02);
                    tcp02.Client.Send(data05, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    data04 = Encoding.UTF8.GetBytes(str01);
                    tcp02.Client.Send(data04, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    data03 = Encoding.UTF8.GetBytes(length.ToString());
                    tcp02.Client.Send(data03, SocketFlags.None);
                    System.Threading.Thread.Sleep(500);
                    Console.WriteLine(" Waiting for response...");
                    tcp02.Client.Receive(new byte[1], SocketFlags.None);
                    Console.WriteLine(" Received response...");
                    Console.WriteLine(" Sending file to " + tcp02.Client.RemoteEndPoint.ToString() + "...");
                    System.Threading.Thread.Sleep(1);
                    while (bytestosend > 0)
                    {
                        System.Threading.Thread.Sleep(50);
                        bool1 = false;
                        bytessent = 0;
                        bw1 = new BackgroundWorker();
                        bw1.DoWork += new DoWorkEventHandler(bw1_DoWork);
                        bw1.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw1_RunWorkerCompleted);
                        data01 = new byte[int02];
                        s01.Read(data01, 0, data01.Length);
                        bw1.RunWorkerAsync();
                        while (bytessent == 0) { }
                        if (bytessent != int02) { throw new Exception("unable to write bytes, insufficient memory."); }
                        while (true)
                        {
                            data07 = new byte[1];
                            tcp02.Client.Receive(data07, 0, 1, SocketFlags.None);
                            if (Encoding.UTF8.GetString(data07) == "2")
                            {
                                bytesresent = 0;
                                bool1 = true;
                                bw1 = new BackgroundWorker();
                                bw1.DoWork += new DoWorkEventHandler(bw1_DoWork);
                                bw1.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw1_RunWorkerCompleted);
                                data06 = new byte[5];
                                bytesCreceived = tcp02.Client.Receive(data06, 0, 5, SocketFlags.None);
                                if (bytesCreceived != 5) { throw new Exception("invalid client response."); }
                                string01 = Encoding.UTF8.GetString(data06);
                                string01 = string01.Replace("x", "");
                                int05 = Convert.ToInt32(string01);
                                int06 = int02 - int05;
                                bytestosend -= int05;
                                data08 = new byte[int05];
                                Buffer.BlockCopy(data01, int06, data08, 0, int05);
                                bw1.RunWorkerAsync();
                                while (bytesresent == 0) { }
                                Console.WriteLine(" Sent " + (length - bytestosend) + " / " + length + " bytes");
                                Console.SetCursorPosition(0, Console.CursorTop - 1);
                                System.Threading.Thread.Sleep(50);
                            }
                            if (Encoding.UTF8.GetString(data07) != "2")
                            {
                                bool1 = false;
                                bytestosend -= bytessent;
                                Console.WriteLine(" Sent " + (length - bytestosend) + " / " + length + " bytes");
                                Console.SetCursorPosition(0, Console.CursorTop - 1);
                                break;
                            }
                        }
                    }
                    Console.SetCursorPosition(0, Console.CursorTop + 1);
                    Console.WriteLine();
                    System.Threading.Thread.Sleep(500);
                    s01.Close();
                    Console.WriteLine(" All data sent.");
                    Console.WriteLine(" Waiting for terminate message...");
                    tcp02.Client.Receive(new byte[1], SocketFlags.None);
                    Console.WriteLine(" Received terminate message.");
                    tcp02.Close();
                    Console.WriteLine(" Stopping client and server.");
                    tcp01.Stop();
                    Console.WriteLine(" Done. Press enter to continue...");
                    Console.ReadLine();
                }

                catch (Exception e)
                {
                    Console.WriteLine(" Error! : " + e.Message.ToString() + " - " + e.Data.ToString() + " - " + e.TargetSite.ToString());
                    if (!(tcp02 == null)) { tcp02.Close(); }
                    if (!(tcp01 == null)) { tcp01.Stop(); }
                    if (!(s01 == null)) { s01.Close(); }
                    Console.Write(" Press enter to continue..."); Console.ReadLine();
                    newvoid();
                }
            }
        }

        static void bw1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            try
            {
                bw1.Dispose();
            }
            catch (Exception e1)
            {
                Console.WriteLine(" Error! : " + e1.Message.ToString() + " - " + e1.Data.ToString() + " - " + e1.TargetSite.ToString());
                if (!(tcp02 == null)) { tcp02.Close(); }
                if (!(tcp01 == null)) { tcp01.Stop(); }
                if (!(s01 == null)) { s01.Close(); }
                Console.Write(" Press enter to continue..."); Console.ReadLine();
                newvoid();
            }
        }

        static void bw1_DoWork(object sender, DoWorkEventArgs e)
        {
            try
            {
                if (bool1 == false)
                {
                    bytessent = tcp02.Client.Send(data01, 0, data01.Length, SocketFlags.None);
                }
                if (bool1 == true)
                {
                    bytesresent = tcp02.Client.Send(data08, 0, data08.Length, SocketFlags.None);
                }
            }
            catch(Exception e2)
            {
                Console.WriteLine(" Error! : " + e2.Message.ToString() + " - " + e2.Data.ToString() + " - " + e2.TargetSite.ToString());
                if (!(tcp02 == null)) { tcp02.Close(); }
                if (!(tcp01 == null)) { tcp01.Stop(); }
                Console.Write(" Press enter to continue..."); Console.ReadLine();
                if (!(s01 == null)) { s01.Close(); }
                newvoid();
            }
        }
    }
} 
```

# facebook-graph-api - 自 2013 年 2 月 6 日以来，通过 'feed' 连接使用 Graph API 发布到朋友的墙上失败

> ID：14792062
> 
> 赞同：15
> 
> 时间：2013-02-09T21:58:05.110
> 
> 标签：facebook-graph-api, stream, publishing

我的应用开始无法在朋友的供稿上发布项目。我收到此错误：

```
Facebook request error: The operation couldn’t be completed.
(facebookErrDomain error 10000.), details: Error Domain=facebookErrDomain Code=10000 "The operation couldn’t be completed. (facebookErrDomain error 10000.)" UserInfo=0xa26e990 {error={
    code = 200;
    message = "(#200) Feed story publishing to other users is disabled for this application";
    type = OAuthException;
}} 
```

我没有更改应用程序中的任何内容。也许它与Facebook升级有关？这些是我连接到 Facebook 的权限：

```
[appDelegate.facebook authorize:[NSArray arrayWithObjects:@"publish_stream", @"friends_birthday", nil]]; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-10T16:02:45.910

是的，这是几个月前[宣布](https://developers.facebook.com/docs/apps/migrations/completed-changes#feb_2013)的，并于 2013 年 2 月 6 日生效：

> **删除通过 Graph API 向朋友墙发帖**
> 的功能 我们将删除通过 Graph API 向用户朋友墙发帖的功能。具体来说，针对 [user_id]/feed 的 [user_id] 与会话用户不同的帖子，或用户与会话用户不同的 stream.publish 调用`target_id`将失败。如果您想允许人们发布到他们朋友的时间线，请调用[提要对话框](https://developers.facebook.com/docs/reference/dialogs/feed/)。[通过用户提及标记](https://developers.facebook.com/docs/opengraph/mention_tagging/)或[动作标记](https://developers.facebook.com/docs/opengraph/actions/#taggingpeople/)包含朋友的故事将显示在朋友的时间线上（假设朋友批准标签）。有关详细信息，请参阅[此博客文章](https://developers.facebook.com/blog/post/2012/10/10/growing-quality-apps-with-open-graph/)。

解决方法是使用[Feed Dialog](https://developers.facebook.com/docs/reference/dialogs/feed/)，它允许用户发布相同的内容，但选择他们想要发布的用户。

# regex - 7 位数字的正则表达式，后跟可选的 3 个字母

> ID：14792063
> 
> 赞同：3
> 
> 时间：2013-02-09T21:58:09.987
> 
> 标签：regex, vba, ms-access

我是正则表达式的新手，我正在尝试使用正则表达式验证我们数据库中的收据编号。

我们的收据可以采用以下格式：

*   0123456（Manditory 七位数，不多不少）
*   0126456a（强制七位数字和一个字母 az）
*   0126456ab（强制性七位数字，两个字母 az）
*   0126456abc（强制七位数字，三个字母 az）

我尝试过使用一堆不同的正则表达式组合，但似乎都不起作用。现在我有：

```
(\d)(\d)(\d)(\d)(\d)(\d)(\d)([a-z])?([a-z])?([a-z])? 
```

但这允许超过 7 个数字，并且允许超过 3 个字母。

这是我在 Access 2010 中的 VBA 函数，它将验证表达式：

```
Function ValidateReceiptNumber(ByVal sReceipt As String) As Boolean

    If (Len(sReceipt) = 0) Then
        ValidateReceiptNumber = False
        Exit Function
    End If

    Dim oRegularExpression     As RegExp

'   Sets the regular expression object
    Set oRegularExpression = New RegExp

    With oRegularExpression
'   Sets the regular expression pattern
        .Pattern = "(\d)(\d)(\d)(\d)(\d)(\d)(\d)([a-z])?([a-z])?([a-z])?"

'   Ignores case
        .IgnoreCase = True

'       Test Receipt string
        ValidateReceiptNumber = .Test(sReceipt)

    End With
End Function 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T21:59:35.773

您可能需要在末端使用锚点。此外，您的正则表达式可以简化为： -

```
^\d{7}[a-z]{0,3}$ 
```

*   `\d{7}`完全匹配`7 digits`。您不需要为此使用`\d`7 次。
*   `{0,3}`创建一个范围，并匹配前面模式的 0 到 3 次重复，
*   `Caret(^)`匹配行的开头
*   `Dollar($)`匹配行尾。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-09T22:01:44.880

`^(\d){7}[a-z]{0,3}$`可能运作良好。`^`和将`$`分别匹配行的开始和结束。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T22:05:02.820

您可能希望通过使用锚来确保匹配整个字符串。

```
^(\d)(\d)(\d)(\d)(\d)(\d)(\d)([a-z])?([a-z])?([a-z])?$ 
```

您还可以简化正则表达式。首先，您不需要所有这些括号。

```
^\d\d\d\d\d\d\d[a-z]?[a-z]?[a-z]?$ 
```

此外，您可以使用有限的重复，以防止重复自己。

```
^\d{7}[a-z]{0,3}$ 
```

where`{7}`表示“正好 7 次”，`{0,3}`表示“0-3 次”。

# c# - 在 C# 控制台应用程序上更改背景颜色

> ID：14792066
> 
> 赞同：15
> 
> 时间：2013-02-09T21:59:02.230
> 
> 标签：c#, colors, background, console

我搜索了网络，但我似乎无法找到解决方案。我希望我的整个控制台应用程序窗口是一种特定的颜色，例如蓝色。我怎么做？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-09T22:27:22.850

只需设置背景颜色并调用`Console.Clear()`：

```
class Program {
    static void Main(string[] args) {
        Console.BackgroundColor = ConsoleColor.Blue;
        Console.Clear();
        Console.ForegroundColor = ConsoleColor.White;
        Console.Write("Press any key to continue");
        Console.ReadKey();
    }
} 
```

![在此处输入图像描述](../Images/da4f32531a821b19032dddddb8759a51.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T22:02:24.990

OP 问题是询问如何将整个背景颜色设置为蓝色。其他样本都没有正确显示这一点。就是这样：

```
namespace ClearConsole
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.BackgroundColor = ConsoleColor.Blue;
            Console.Clear();

        }
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-09T22:03:21.570

您可以将[`Console.BackgroundColor`](http://msdn.microsoft.com/en-us/library/system.console.backgroundcolor.aspx)属性设置为[`ConsoleColor`](http://msdn.microsoft.com/en-us/library/system.consolecolor.aspx)枚举..

> 获取或设置控制台的背景颜色。要整体更改 > 控制台窗口的背景颜色，请设置 BackgroundColor 属性并调用该`Clear`方法。

```
Console.BackgroundColor = ConsoleColor.Blue;
Console.Clear(); 
```

![在此处输入图像描述](../Images/a46b8a64cbbd9b8e638e17cd696fe7c5.png)

您可以将[`Console.ForegroundColor`](http://msdn.microsoft.com/en-us/library/system.console.foregroundcolor.aspx)财产用于

> 获取或设置控制台的前景色。

```
Console.ForegroundColor = ConsoleColor.Blue; 
```

![在此处输入图像描述](../Images/5dc160e489267f03a566d0cf1b117171.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-07T17:40:01.213

```
Console.ForegroundColor = Color.Blue; 
```

`Console.WriteLine("This string is blue!");`

# c++ - size_t 是字长吗？

> ID：14792068
> 
> 赞同：33
> 
> 时间：2013-02-09T21:59:16.817
> 
> 标签：c++, c, size-t

是`size_t`编译代码的机器的字长吗？

使用 g++ 进行解析，我的编译器将`size_t`其视为`long unsigned int`. 在调用编译器之前，编译器是否在内部选择了 的大小`size_t`，或者`size_t`实际上是在某个预处理器宏中将其类型定义`stddef.h`为字长？

还是我偏离了轨道？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-09T22:01:48.663

在 C++ 标准中，[support.types] (18.2) /6：“该类型`size_t`是实现定义的无符号整数类型，它大到足以包含任何对象的字节大小。”

无论这意味着什么，这可能与“字长”相同，也可能不同。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-09T22:02:34.227

不; `size_t`不一定是您所说的将运行代码（在交叉编译的情况下）或编译代码（在代码将在相同类型的机器上运行的正常情况下）的机器的“字大小”编译代码）。它是一个无符号整数类型，足以容纳实现可以分配的最大对象的大小（以字节为单位）。

* * *

## 一些历史`sizeof`和`size_t`

我不知道`size_t`确切的介绍是什么时候，但它是在 1979 年到 1989 年之间。1978 年的 K&R The C Programming Language 的第 1 版没有提到`size_t`. 第 7 版 Unix Programmer's Manual 根本没有提及`size_t`，它的历史可以追溯到 1979 年。Kernighan 和 Pike 于 1984 年出版的“The UNIX Programming Environment”一书`size_t`在索引中没有提及（也没有提及`malloc()`or `free()`，有点令我惊讶） ，但这只是指示性的，不是决定性的。C89 标准当然有`size_t`。

C99 基本原理记录了一些关于`sizeof()`和的信息`size_t`：

> ### 6.5.3.4 sizeof 运算符
> 
> 它是正确使用函数的基础，例如`malloc`和`fread`that `sizeof(char)`be one。实际上，这意味着 C 术语中的一个字节是最小的存储单元，即使这个单元是 36 位宽；所有对象都是由这些最小单元的整数个组成。如果内存是位可寻址的，也适用。C89 和 K&R 一样，将`sizeof`运算符的结果定义为无符号整数类型的常量。常见的实现和常见的用法通常假设生成的类型是`int`. 依赖此行为的旧代码从未移植到将结果定义为非`int`. C89 委员会认为更改语言以保护不正确的代码是不合适的。
> 
> 的类型`sizeof`，无论它是什么，都被发布（在库头中`<stddef.h>`）为 `size_t`，因为程序员能够引用这种类型很有用。此要求隐含地限制`size_t`为现有无符号整数类型的同义词。另请注意，尽管`size_t`是无符号类型，`sizeof`但不涉及任何算术运算或转换，如果大小太大而无法表示为 a `size_t`，则会导致模数行为，因此消除了任何关于最大可声明对象可能太大而无法跨越的概念即使`unsigned long`在 C89 或`uintmax_t`C99 中。这也限制了可以在数组中声明的元素的最大数量，因为对于任何 元素数组`a`，`N`
> 
> `N == sizeof(a)/sizeof(a[0])`
> 
> 因此`size_t`，它也是数组大小的一种方便类型，并且在多个库函数中如此使用。[...]
> 
> ### 7.17 常用定义
> 
> `<stddef.h>`是一个头文件，旨在提供与库一起广泛使用的几种类型和宏的定义：`ptrdiff_t`、`size_t`、`wchar_t`和`NULL`. 包括引用这些宏之一的任何标头也将定义它，这是通常库规则的一个例外，即每个宏或函数仅属于一个标头。

请注意，这特别提到`<stddef.h>`是由 C89 委员会发明的。我没有找到说这`size_t`也是由 C89 委员会发明的词，但如果不是，那它是对最近 C 语言发展的编纂。

* * *

在对[bmargulies](https://stackoverflow.com/users/131433/bmargulies) [answer](https://stackoverflow.com/a/14792080/15168)的评论中，[vonbrand](https://stackoverflow.com/users/1839777/vonbrand)说“它 [ `size_t`] 肯定是 ANSI-C-ism”。我可以很容易地相信它是原始 ANSI (ISO) C 的一项创新，尽管理由没有说明这一点有点奇怪。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T22:02:37.237

不必要。C ISO 规范（§17.1/2）定义`size_t`为

> size_t，即`sizeof`运算符结果的无符号整数类型

换句话说，`size_t`必须足够大以容纳可以从 生成的任何表达式的大小`sizeof`。这可能是机器字长，但它可能会小得多（例如，如果编译器限制了数组或对象的最大大小）或大得多（如果编译器允许您创建如此巨大的对象，以至于单台机器word 无法存储该对象的大小）。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T22:01:35.923

size_t 原本只是 sys/types.h 中的 typedef（传统上在 Unix/Linux 上）。它被假定为“足够大”，例如文件的最大大小，或 malloc 的最大分配。然而，随着时间的推移，标准委员会抓住了它，因此它最终被复制到许多不同的头文件中，每次都使用自己的#ifdef 保护免受多重定义。另一方面，具有非常大潜在文件大小的 64 位系统的出现掩盖了它的角色。所以它有点像旧书。

语言标准现在将其称为存在于 stddef.h 中。它与硬件字长没有必然关系，也没有编译器魔法。关于这些标准所说的它有多大，请参阅其他答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T22:38:01.467

虽然定义没有直接说明具体是什么类型`size_t`，~~甚至没有要求最小尺寸~~，但它间接给出了一些很好的提示。A`size_t`必须能够包含任何对象的大小（以字节为单位），换句话说，它必须能够包含最大可能对象的大小。

最大的可能对象是一个数组（或结构），其大小等于整个可用地址空间。不可能以有意义的方式引用*更大的*对象，除了交换空间的可用性之外，没有理由让它需要*更小*。

因此，按照定义的措辞，在 32 位架构上`size_t` **必须**至少有 32 位，在 64 位系统上必须至少有 64 位。实现当然可以选择更大的`size_t`，但通常情况并非如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-09T22:12:53.363

这些定义都是实现定义的。如果我需要一个最佳猜测大小，我会使用 sizeof(char *) 或 sizeof(void *)。这给出的最好的结果是软件使用的明显字长......硬件真正拥有的可能不同（例如，32 位系统可能通过软件支持 64 位整数）。

此外，如果您不熟悉 C 语言，请参阅 stdint.h 以了解有关整数大小的各种材料。

# ios - iOS 在实时字幕视频上绘制 gps 点

> ID：14792073
> 
> 赞同：0
> 
> 时间：2013-02-09T22:00:32.820
> 
> 标签：ios, gps, avfoundation, core-location

我正在尝试从实时捕获的视频中在屏幕上绘制点，如下图所示。

![图像示例](../Images/8f872b52a75906200b9240f7c02a26f3.png)

我在从手机 GPS 读取的位置 XY。我插入两个点（GPS）P1 和 P2。

如何在屏幕上显示这些点 (p1, p2)。与以下视频 (0:45) 中显示的逻辑相同。

[http://www.youtube.com/watch?v=O0qQNo3jp5Q&feature=player_embedded](http://www.youtube.com/watch?v=O0qQNo3jp5Q&feature=player_embedded)

有没有人知道任何博客、论坛或教程来解释我如何创建这个或任何其他建议或提示？垂直精度不如水平精度重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T18:02:58.643

你说的是“增强现实”

总而言之，这是一项艰巨的任务：

简单的部分： - 将所有 GPS 坐标转换为基于笛卡尔米的坐标系。- 找出相机前进的方向：使用内置指南针（水平方位角） - 使用加速度计找出垂直方位角（如果相机向上或向下）

现在更难了

*   找出技术数据/或校准相机物镜（焦距）

使用这些数据，建立一个 3d 矢量世界，（例如，一条每条线长 10m 的立方体），并将其投影到该 3d 世界中的虚拟相机传感器位置（就像 3d 游戏在 csn 选择相机位置时所做的那样）。
他们要校准您的相机参数，使模拟世界 10m 网格线适合现实世界。
现在将两个地理位置创建为该 3d 世界中的对象，并绘制它们。

您想阅读 3d 计算机图形学和“增强”现实的介绍。

如果你幸运的话，你会找到一个用于 iphone 增强现实的库。

# c++ - 如何确定 Qt 文档行的渲染高度

> ID：14792074
> 
> 赞同：1
> 
> 时间：2013-02-09T22:00:46.393
> 
> 标签：c++, qt

Windows 7 SP1
MSVS 2010
Qt 4.8.4

我正在尝试确定 Qt 文档的每一行（准确地说是文本块）的渲染高度是多少。该文档具有富文本，因此每个文本块都可能有片段。假设没有自动换行，因此每个文本块都是一行。为了简化事情，这就是我想要做的：

```
 #include <QTGui>

int CalculateLineHeight(QTextBlock text_block);

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QMainWindow* window = new QMainWindow;
    QTextEdit* editor = new QTextEdit(window);

    QTextDocument* text_document = new QTextDocument(window);
    editor->setDocument(text_document);

    QFile file("test.html");
    if (file.open(QFile::ReadOnly | QFile::Text))
        editor->setHtml(file.readAll());

    QTextBlock text_block = text_document->begin();
    while (text_block.isValid() )
    {
        qDebug() << text_block.text() << CalculateLineHeight(text_block);
        text_block = text_block.next();
    }
    window->setCentralWidget(editor);
    window->show();
    return app.exec();
}

int CalculateLineHeight(QTextBlock text_block)
{
    QList<QTextLayout::FormatRange> text_block_format_ranges;

    // Gather the format ranges for each fragment of the text block.
    for (QTextBlock::Iterator fragment_it = text_block.begin(); !(fragment_it.atEnd()); ++fragment_it)
    {
        QTextFragment fragment = fragment_it.fragment();

        QTextCharFormat fragment_format = fragment.charFormat();
        QTextLayout::FormatRange text_block_format_range;
        text_block_format_range.format = fragment_format;
        text_block_format_range.start = fragment.position();
        text_block_format_range.length = fragment.length();

        text_block_format_ranges << text_block_format_range;
    }
    // Create text layout
    QTextLayout text_layout(text_block.text());
    text_layout.setAdditionalFormats( text_block_format_ranges );
    text_layout.beginLayout();
    QTextLine line = text_layout.createLine();
    text_layout.endLayout();

    return text_layout.boundingRect().height();
} 
```

这是 test.html：

```
<!DOCTYPE html>
<html>
<head>
<style>
.consolas{
    font-family: "Consolas";
    font-size:14pt;
    background-color: cyan; 
}
.arial{
    font-family: "Arial";
    font-size:14pt;
    background-color: cyan; 
}
</style>
</head>

<body>
<p><span class="consolas">E</span></p>
<p><span class="arial">E</span></p>
<p><span class="consolas">E</span><span class="arial">E</span></p>
</body>
</html> 
```

窗口显示（我的注释指示 LineHeights）：

![在此处输入图像描述](../Images/0c6ebb00f10b28635581830651f9a651.png)

但我得到以下控制台输出：

```
"E" 22
"E" 13
"EE" 13 
```

因此，它显然在第一行正确计算它，但后续行它没有正确计算它（第 2 行 s/b 23、第 3 s/b 24）。我怀疑我的问题在于我如何处理文本布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T03:36:42.850

这成功了：

```
int CalculateLineHeight(QTextBlock text_block)
{
    QList<QTextLayout::FormatRange> text_block_format_ranges;

    // Gather the format ranges for each fragment of the text block.
    for (QTextBlock::Iterator fragment_it = text_block.begin(); !(fragment_it.atEnd()); ++fragment_it)
    {
        QTextFragment fragment = fragment_it.fragment();

        QTextCharFormat fragment_format = fragment.charFormat();
        QTextLayout::FormatRange text_block_format_range;
        text_block_format_range.format = fragment_format;
        // fragment.position = position within the document whereas
        // .start = position within the text block. Therefore, need
        // to subtract out the text block's starting position within the document.
        text_block_format_range.start = fragment.position()
                                       - text_block.position();
        text_block_format_range.length = fragment.length();

        text_block_format_ranges << text_block_format_range;
    }

    // Create text layout
    QTextLayout text_layout(text_block.text());
    text_layout.setAdditionalFormats( text_block_format_ranges );
    text_layout.beginLayout();
    QTextLine line = text_layout.createLine();
    text_layout.endLayout();                    
    line.setLeadingIncluded(true);                  // Need to include the leading
    return line.height(); 
```

# php - PHP 错误：未定义的偏移量

> ID：14792075
> 
> 赞同：0
> 
> 时间：2013-02-09T22:01:04.333
> 
> 标签：php

我创建了一个数组来列出学生所学课程的成绩。但是，我在第 33 行收到 PHP 错误：未定义偏移量。该表似乎以我想要的方式显示，上传到 EasyPHP 后，我似乎只是在浏览器中反复收到此错误。我做错了什么？

```
<?php
$studentGrades = array(
       array(
          array("<b>Frank Thomas</b>","<b>Courses Taken</b>", "<b>Course Grade</b>"),
          array("Frank Thomas", "Compilers",  "<i>D</i>"),
          array("Frank Thomas", "Logic and Automated Reasoning", "<i>A</i>"),
          array("Frank Thomas", "Advanced Robotics", "<i>A</i>")                      
       ),
       array(
             array("<b>Garry Beebs</b>", "Intro to Computer Vision", "<i>B</i>"),
             array("Garry Beebs", "Machine Learning", "<i>B</i>"),
             array("Garry Beebs", "Compilers", "<i>A</i>"), 
             array("Garry Beebs", "Interactive Computer Graphics", "<i>A</i>") 
            ),
       array(
             array("<b>Jesse Kline</b>", "Distributed Systems", "<i>A</i>"),
             array("Jesse Kline", "Intro to Artificial Intelligence", "<i>C</i>"),
             array("Jesse Kline", "Advanced Robotics", "<i>B</i>"), 
             array("Jesse Kline", "Natural Language Processing", "<i>B</i>")
            )
       );

echo '<table border="2">';
for ( $arrnum = 0; $arrnum < 3; $arrnum++ )
{

for ( $row = 0; $row < 4; $row++ ) 
{
echo '<tr>';

for ( $col = 0; $col < 4; $col++ )
{
 if ($studentGrades[$arrnum][$row][$col] == '') 
 {
    echo "<td> </td>";
 }
 else
 {
    if ($row == 0 and $col == 0)
    {
    echo "<td>". $studentGrades[$arrnum][$row][$col] . "</td>";
    }
    else if ($row != 0 and $col == 0)
    {
        echo "<td> </td>";
    }
    else
    {
    echo "<td>". $studentGrades[$arrnum][$row][$col] . "</td>";
    }                   
 } 
} 

}
echo "</tr>";
}   
echo "</table>";

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:25:54.677

您要求四列，但该数组中只有三列。

代替

```
for ( $col = 0; $col < 4; $col++ ) 
```

和

```
for ( $col = 0; $col < 3; $col++ ) 
```

但是，错误消息应该告诉您发生错误的行和索引，这应该已经提示您了。

# python - Numpy 沿轴的 cumsum 有符号最大值

> ID：14792077
> 
> 赞同：2
> 
> 时间：2013-02-09T22:01:09.183
> 
> 标签：python, arrays, numpy, multidimensional-array, cumsum

我有一个 numpy 数组`a`，`a.shape=(17,90,144)`. 我想找到 的每一列的最大幅度`cumsum(a, axis=0)`，但保留原始符号。换句话说，如果给定列`a[:,j,i]`的最大值`cumsum`对应于负值，我想保留减号。

代码`np.amax(np.abs(a.cumsum(axis=0)))`让我知道幅度，但不保留符号。相反，使用`np.argmax`会得到我需要的索引，然后我可以将其插入原始`cumsum`数组。但是我找不到这样做的好方法。

以下代码有效，但很脏而且非常慢：

```
max_mag_signed = np.zeros((90,144))
indices = np.argmax(np.abs(a.cumsum(axis=0)), axis=0)
for j in range(90):
    for i in range(144):
        max_mag_signed[j,i] = a.cumsum(axis=0)[indices[j,i],j,i] 
```

必须有一种更清洁、更快的方法来做到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T01:04:21.603

我找不到任何替代方案，`argmax`但至少你可以用更矢量化的方法来解决这个问题：

```
# store the cumsum, since it's used multiple times
cum_a = a.cumsum(axis=0)

# find the indices as before
indices = np.argmax(abs(cum_a), axis=0)

# construct the indices for the second and third dimensions
y, z = np.indices(indices.shape)

# get the values with np indexing
max_mag_signed = cum_a[indices, y, z] 
```

# php - 我将如何 MySQL 注入我自己的网站？

> ID：14792078
> 
> 赞同：-2
> 
> 时间：2013-02-09T22:01:17.693
> 
> 标签：php, mysql

没有任何保护，我有这条线：

```
$check = mysql_query("SELECT * FROM school_users WHERE username = '".$_POST['username']."'")or die(mysql_error()); 
```

在我的 php.ini 中。我将如何注入此代码？我尝试了很多其他的东西，但似乎没有任何注射效果。mysql_query 对此有自动捕获吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:08:56.640

检查您的`php.ini`选项`magic_quotes_gpc`，您应该将其设置`0`为轻松注入 SQL。然后你可以尝试注入你的代码，你可以在浏览器中使用一些[REST插件来实现这一点。](https://addons.mozilla.org/en-us/firefox/addon/restclient/)作为`username`在体内使用的值，例如：

```
username: "' OR 1=1; --" 
```

这将生成如下查询：

```
SELECT * FROM school_users WHERE username = '' OR 1=1; -- 
```

这将始终为真，并将返回`school_users`表中的所有行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:09:39.383

请参阅[示例 SQL 注入攻击](http://www.unixwiz.net/techtips/sql-injection.html)。它不是特定于 PHP 的，但提供并解释了各种常见攻击的示例。

> “SQL 注入”是未经验证/未经清理的用户输入漏洞的子集（“缓冲区溢出”是不同的子集），***其想法是说服应用程序运行非预期的 SQL 代码***。如果应用程序在运行中天真地创建 SQL 字符串然后运行它们，那么很容易产生一些真正的惊喜。

虽然正如其他人所指出的那样，诸如[“魔术引号”之](http://php.net/manual/en/security.magicquotes.php)类的环境因素可能是一个因素，但减轻 SQL 注入的唯一可靠方法是使用经过验证的编码实践。请参阅[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)用于减轻此类攻击的方法。

# python - Pygame：渲染字体周围有实心框

> ID：14792081
> 
> 赞同：0
> 
> 时间：2013-02-09T22:01:37.000
> 
> 标签：python, fonts, pygame, render

在升级到 Python 3.3 之前，我有一些运行良好的代码

[http://www.lfd.uci.edu/~gohlke/pythonlibs/#pygame](http://www.lfd.uci.edu/~gohlke/pythonlibs/#pygame) Pygame 3.3。

现在，当我运行它时，我会在渲染的字体周围看到难看的白色方块。

![](../Images/8a6e8f18f04e044670db60bbd32c0e0b.png)

呸。还有其他人遇到这个问题，或者可能有任何解决方案来纠正它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:32:57.570

我有两个建议。首先，尝试命令`(255, 255, 255, 0)`中的第四个参数`font.render`。其次，如果这不起作用，请将颜色放在第四个参数的文本后面。第一个可能行不通，但第二个肯定行。

# 编辑

实际解决方案：只需将文本表面对象的颜色键设置为`(255, 255, 255)`. 简单的。

# javascript - 我需要用 JavaScript 可视化一个动态集合，它可以用 Reactive Extensions 实现吗？

> ID：14792084
> 
> 赞同：1
> 
> 时间：2013-02-09T22:01:42.867
> 
> 标签：javascript, system.reactive, reactive-extensions-js

我正在编写这个 Web 应用程序，我需要通过 JavaScript 可视化过滤、排序和分页（在服务器上）的集合（计划使用[Isotope](http://isotope.metafizzy.co/)来呈现集合）。这些集合是动态的，即它们从某些项目开始，但它们的内容可能会在整个应用程序的生命周期内发生变化。我可以通过 Reactive Extensions for JavaScript 观看服务器上的集合来实现此功能吗？如果是这样，怎么做？

## 例子

对于这个特定问题，假设一个集合在 HTML 中呈现为一个元素，每个集合项都有`#container`一个 class 的子元素：`item`

```
<div id="container">
  <div class="item">Item 1</div>
  <div class="item">Item 3</div>
</div> 
```

如果“Item 2”随后被添加到集合中，并且“Item 1”在服务器上从中删除，JavaScript 应该通过将更新的集合呈现为 HTML 来做出反应，如下所示：

```
<div id="container">
  <div class="item">Item 2</div>
  <div class="item">Item 3</div>
</div> 
```

我创建了一个动画[小提琴](http://jsfiddle.net/aknuds1/SNHeH/1/)来演示这种场景。想象一下，对集合的更改发生在服务器上，而 JavaScript 只是对其作出反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T21:59:33.183

我发现 Reactive Extensions 可能有助于解决这个问题，但它并不关心服务器和客户端之间的通信。应用 RX 的一种可能方式是在服务器和客户端之间建立一座桥梁，RX 事件可以通过该桥梁流动。[SignalR](http://signalr.net/)是实现网桥的一个可能的选择。甚至还有一个项目[SignalR.Reactive](https://github.com/cburgdorf/SignalR.Reactive)以这种方式结合了 SignalR 和 RX。

我认为，解决我的问题的真正问题是如何在服务器上发布更改。我发现我选择的数据库 RavenDB 有一个用于观察数据变化的 API，所以希望我能够围绕这个设计一个方案。一旦解决了这个问题，我设想在 RX 和 SignalR 的帮助下向客户端发布更改是相当简单的。

# php - ZipArchive php 获取损坏或空的 zip

> ID：14792086
> 
> 赞同：7
> 
> 时间：2013-02-09T22:01:45.597
> 
> 标签：php, zip, ziparchive

我正在通过以下代码下载 zip 文件，没有任何错误，但下载的 zip 文件为空或损坏，大小始终约为 200 字节。即我无法打开那个 zip 文件。ZipArchive::getStatusString() 也显示“无错误”

代码是：

```
public function getzip(){
    global $config;
    $files=array();
    if(isset($_COOKIE['hashes'])){
        $hashes=explode(',',$_COOKIE['hashes']);
        for ($i=0; $i <count($hashes); $i++) {
            array_push($files,$config["domain"]."/download/".$hashes[$i]); 
        }
    }
    if(count($files)){
        $zipname='basket.zip';
        $zip = new ZipArchive;
        $zip->open($zipname,ZipArchive::CREATE);
        foreach ($files as $key=>$value ) {
            $zip->addFile($value);
        }
        $status=$zip->getStatusString();
        $zip->close();

    if(!$zipname)
    {
        echo "Nothing in Basket";
    }
    else
    {   header('Content-Description: File Transfer');
        header('Content-Type: application/zip');
        header('Content-Disposition:attachment; filename='.basename($zipname));
        header('Content-Length:'.filesize($zipname));
        readfile($zipname);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T22:21:41.887

尝试在之前获取完整的文件路径和名称`$zip->close();`

```
$filename = $zip->filename; 
```

并`$zipname`在读取文件和获取文件大小时使用它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T12:29:26.930

这是我最好的猜测。这里的问题是，在您的数组`$files`中，您存储的值可能不是文件的实际路径。

请记住：您不能将 URL 传递给`$zip->addfile()`，您需要您的实际文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-26T10:45:42.247

即使这个问题很难解决，我也会发布我发现如何创建损坏的 zip 的内容：

制作 zip 存档时，您通常会使用 echo/print_r 命令进行调试。如果您不清除这些，则输出的 zip 文件将损坏。

基于问题的示例：

```
public function getzip(){
    global $config;
    $files=array();
    if(isset($_COOKIE['hashes'])){
        $hashes=explode(',',$_COOKIE['hashes']);
        for ($i=0; $i <count($hashes); $i++) {
            array_push($files,$config["domain"]."/download/".$hashes[$i]); 
        }
    }
    if(count($files)){
        $zipname='basket.zip';
        $zip = new ZipArchive;
        $zip->open($zipname,ZipArchive::CREATE);
        foreach ($files as $key=>$value ) {
            $zip->addFile($value);
        }
        $status=$zip->getStatusString();
        $zip->close();

    if(!$zipname)
    {
        echo "Nothing in Basket";
    }
    else
    {   
        // to fix your corrupt zip file, remove this line.
        echo 'THIS IS AN EXAMPLE DEBUG: ' . $zipname;
        header('Content-Description: File Transfer');
        header('Content-Type: application/zip');
        header('Content-Disposition:attachment; filename='.basename($zipname));
        header('Content-Length:'.filesize($zipname));
        readfile($zipname);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-02T15:33:47.913

即使最初的问题已经解决，因为我刚刚花了几个小时来解决类似的问题，所以添加到这个线程。

事实证明，执行 $zip->close() 时文件都需要存在，无论何时使用 $zip->addFile() 添加它们。

因此，如果您创建临时文件，将它们添加到您的 zip 中，然后在使用 close() 之前将其删除，您最终可能会得到一个空/损坏的存档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-28T11:44:54.873

我通过将代码移动到我想要添加到 Zip 存档的文件所在的同一文件夹来解决了同样的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-01T07:29:16.103

可能这对 OP 没有用，但我在更改我的虚拟服务器时遇到了这个问题。我不知道服务器设置发生了什么变化，但 zip 开始制作空拉链。

经过一些研究和测试，我发现我需要做的就是添加文件名（我不知道为什么它在旧服务器上工作）作为第二个参数：
`$zip->addFile($value, $zipname); // $zipname in this case`

我遇到的另一个问题是我太低了`memory_limit`

希望这可以帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-28T11:56:10.480

就我而言，问题归结为在`ZipArchive::addGlob()`方法的 add_path 选项中传递了一个 '/' 值：

```
 $zipArchive->addGlob($tmpFolder . DIRECTORY_SEPARATOR ."*", 
                         0, 
                         ['add_path' => '/', 'remove_all_path' => true]); 
```

删除它为我解决了问题：

```
 $zipArchive->addGlob($tmpFolder . DIRECTORY_SEPARATOR ."*", 
                         0, 
                         ['remove_all_path' => true]); 
```

# r - 如何找到 R 的 MASS 包中的 lda( ) 函数使用的切点值？

> ID：14792088
> 
> 赞同：1
> 
> 时间：2013-02-09T22:01:56.370
> 
> 标签：r

我正在使用中的`MASS`包`R`，特别是`lda()`函数。我想知道*如何让R返回*函数用来确定每个样本应该分配到哪个组或类的阈值`LD1`（即切点或截止） 。`lda`

我知道 R 不仅仅使用两组平均值之间的中点平均值`LD1`。我需要知道切点值，以便我可以`lda`在每次新迭代之前运行多次迭代并重新分配错误分类的样本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T02:03:04.623

除非您以其他方式强制它，否则它将取决于数据。`?lda`产生：

```
prior   
the prior probabilities of class membership. If unspecified, the class proportions for 
the training set are used. If present, the probabilities should be specified in the 
order of the factor levels. 
```

如果您想查看代码或生成预测，请查看`predict.lda`或进一步阅读`?predict.lda`MASS 书中的内容。`predict.lda`还提供了指定切割点的句柄：

```
prior   
The prior probabilities of the classes, by default the proportions in the training set
 or what was set in the call to lda. 
```

# javascript - 在函数中更改 Element 上的 className

> ID：14792090
> 
> 赞同：1
> 
> 时间：2013-02-09T22:02:08.950
> 
> 标签：javascript

标题可能有点错误，但这就是我认为该函数应该更改为正确的类。

所以这是我的问题，我创建了一个骰子滚轮，它计算骰子的总和。问题是计数器是在骰子总和之后切换的图像，它们被从零到九的类名调用。

当我有一个数字为 5 的骰子时，图像 5 显示，但是当我有 2 个总和的骰子时，可以说 5 + 2 图像 5 和 2 显示而不是 7。所以 classChange 将不起作用。我试图插入一个 element.className = " " 但它立即更改了变量，因为我把它放在了一个循环中。好吧，很难解释，所以我做了一个 jsFiddle。

[http://jsfiddle.net/3nZNM/3/](http://jsfiddle.net/3nZNM/3/)

计数器的代码在 81 和 125 之间的行

```
function numberTotext(nr){
    var arrClass=["zero","one","two","three","four","five","six","seven","eight","nine"];
    ret=[];
    nr=nr.toString();
    for(i in nr){
        ret.push(arrClass[nr[i]]);
    }
    console.log(ret);
    return ret;
}
numberTotext(total)

        function turnCounter(){       
        for (var i = 0; i < arguments.length; i++){ 
            dice_toolbar_counter_wrapper_Li = createElementWithClass('li',arguments[i]);
            console.log(dice_toolbar_counter_wrapper_Li)
            dice_toolbar_counter_wrapper_Ul.appendChild(dice_toolbar_counter_wrapper_Li);
            document.getElementById("ul");
        } 

    }   turnCounter(ret); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:45:58.870

Remove element before appending new one when you calculate the total each time, so the counter only shows one time and not multiple times. Also you have to change CSS to make it easier to be able to calculate what class you have to use.

[**WORKING JSFIDDLE DEMO**](http://jsfiddle.net/3nZNM/5)

Change relevant parts of CSS to:

```
.dice-toolbar-counter-wrapper .side-0
{
    background-position : 0 0;
}

.dice-toolbar-counter-wrapper .side-1
{
    background-position : 0 -17px;
}

.dice-toolbar-counter-wrapper .side-2
{
    background-position : 0 -34px;
}

.dice-toolbar-counter-wrapper .side-3
{
    background-position : 0 -51px;
}

.dice-toolbar-counter-wrapper .side-4
{
    background-position : 0 -68px;
}

.dice-toolbar-counter-wrapper .side-5
{
    background-position : 0 -85px;
}

.dice-toolbar-counter-wrapper .side-6
{
    background-position : 0 -102px;
}

.dice-toolbar-counter-wrapper .side-7
{
    background-position : 0 -119px;
}

.dice-toolbar-counter-wrapper .side-8
{
    background-position : 0 -136px;
}

.dice-toolbar-counter-wrapper .side-9
{
    background-position : 0 -153px;
} 
```

Change JS to:

```
/*###CREATE ELEMENT WITH CLASS ###*/

function createElementWithClass(elementName, className)
{
    var el = document.createElement(elementName);
    el.className = className;
    return el;
}

/*###CREATE ELEMENT WITHOUT CLASS ###*/
function createElementWithOutClass(elementName)
{    var el = document.createElement(elementName);
    return el;
  }
/*###CREATE ELEMENT WITH ID ###*/
function createElementWithId(elementName, idName)
{
    var element = document.createElement(elementName);
    element.id = idName;
    return element;
}    
var outerDiv = createElementWithClass('div', 'dice-window-wrapper'),
    innerDiv = createElementWithClass('div', 'dice-menubar-wrapper');
    outerDiv.appendChild(innerDiv);
    document.getElementById("page-content-wrapper").appendChild(outerDiv);

    dice_windows_wrapper_close = createElementWithClass('div', 'close');
    innerDiv.appendChild(dice_windows_wrapper_close);
    document.getElementById("dice-window-wrapper");

    dice_toolbar_wrapper_close = createElementWithClass('div', 'dice-toolbar-wrapper');
    outerDiv.appendChild(dice_toolbar_wrapper_close);
    document.getElementById("page-content-wrapper");

    add_remove_roll = createElementWithOutClass('ul');
    dice_toolbar_wrapper_close.appendChild(add_remove_roll);
    document.getElementById("dice-content-wrapper");

    dice_content_wrapper = createElementWithClass('div', 'dice-content-wrapper');
    outerDiv.appendChild(dice_content_wrapper);

    document.getElementById("page-content-wrapper");

    dice_toolbar_counter_wrapper_Ul = createElementWithClass('ul', 'dice-toolbar-counter-wrapper');
    dice_toolbar_wrapper_close.appendChild(dice_toolbar_counter_wrapper_Ul);

    add_remove_roll_func("add","remove","roll");

    lielement = createElementWithOutClass('li');
    add_remove_roll.appendChild(lielement);

    lielement.appendChild(dice_toolbar_counter_wrapper_Ul);

    /* <div class="dice-content-wrapper">*/  /*Visar tärningen som kastast*/
    ul_dice_sides = createElementWithOutClass('ul');
    dice_content_wrapper.appendChild(ul_dice_sides);
    document.getElementById("dice-content-wrapper");
    function add_remove_roll_func(){
        for (var i = 0; i<3; i++){
            li_dice_side_one = createElementWithClass('li',arguments[i]);
            add_remove_roll.appendChild(li_dice_side_one);
            document.getElementById("ul");
        }
    }

function getNumberForClass(className){
    var diceArray = Array=[ 
    "dice dice-side-one", 
    "dice dice-side-two", 
    "dice dice-side-three", 
    "dice dice-side-four", 
    "dice dice-side-five", 
    "dice dice-side-six"]; 
    return diceArray.indexOf(className)+1;
}

/*###CREATE DICES ###*/
function dicesides_func(nr){
    // go to dice-window-wrapper again
    // this could be put in a seporate functon
    var elementToAddDice=" dice-window-wrapper ",
    obj=this, // using this here that's why it's called wiht
    dice,i=0,total=0; // all the dice in this dice window
    // dicesides_func.call to set the right this context
    while((" "+obj.className+" ").indexOf(elementToAddDice)==-1){
        obj=obj.parentNode;
    }
    obj=obj.getElementsByTagName("ul")[2];
    var dicessides = createElementWithClass('li',nr);
    obj.appendChild(dicessides);
    // calculate total (can do in a seporate function)
    dice = obj.getElementsByTagName("li");
    for(i=0;i<dice.length;i++){
        total=total+getNumberForClass(dice[i].className);
    }
    //alert(total);

    var wrapper = document.getElementsByClassName("dice-toolbar-counter-wrapper")[0];

        while (wrapper.hasChildNodes()) {
    wrapper.removeChild(wrapper.lastChild);
     }

     var newelem = createElementWithClass('li',"side-" + total.toString());
            //alert(dice_toolbar_counter_wrapper_Li)
            wrapper.appendChild(newelem);

   function numberTotext(nr){
    var arrClass=["zero","one","two","three","four","five","six","seven","eight","nine"];
    ret=[];
    nr=nr.toString();
    for(i in nr){
        ret.push(arrClass[nr[i]]);
    }
    console.log(ret);
    return ret;
}
numberTotext(total)
/*
        function turnCounter(){       
        for (var i = 0; i < arguments.length; i++){ 
            dice_toolbar_counter_wrapper_Li = createElementWithClass('li',arguments[i]);
            //alert(dice_toolbar_counter_wrapper_Li)
            dice_toolbar_counter_wrapper_Ul.appendChild(dice_toolbar_counter_wrapper_Li);
            document.getElementById("ul");

        } 

    }   turnCounter(ret);*/
}
function AddEvent(){ 
        var AddEvent = "add"; 
        var addClass= document.getElementsByClassName(AddEvent); 
        addClass=addClass[addClass.length-1]; 
        addClass.addEventListener("click", addDiceEvent, true); 
        var diceArray = Array=[ 
        "dice dice-side-one", 
        "dice dice-side-two", 
        "dice dice-side-three", 
        "dice dice-side-four", 
        "dice dice-side-five", 
        "dice dice-side-six"]; 
        <!-- console.log("when set",addClass); -->
        function addDiceEvent() { 
            var rand = diceArray[Math.floor(Math.random() * diceArray.length)];
            dicesides_func.call(addClass,rand);
                  }        

    }
    AddEvent(); 
    function RemoveEventDice(){ 
        var removeEvent = "remove"; 
        var removeClass= document.getElementsByClassName(removeEvent); 
        var remove=removeClass[removeClass.length-1]; 
        remove.addEventListener("click", removeDice, true); 

        function removeDice(e) { 
            var obj=e.target; 
            var elementToRemove=" dice-window-wrapper "; 
            while((" "+obj.className+" ").indexOf(elementToRemove)==-1){ 
                obj=obj.parentNode; 
            } 
            var allDiceInWindow=obj.getElementsByClassName("dice"); 
            var diceToRemove=allDiceInWindow[allDiceInWindow.length-1]; 
            diceToRemove.parentNode.removeChild(diceToRemove); 
        } 
    }
    RemoveEventDice();
 function rollEvent(){ 
        var rollDices = "roll"; 
        var addClass= document.getElementsByClassName(rollDices); 
        addClass=addClass[addClass.length-1]; 
        addClass.addEventListener("click", rollDice, true); 
        var diceArray = Array=[ 
        "dice dice-side-one", 
        "dice dice-side-two", 
        "dice dice-side-three", 
        "dice dice-side-four", 
        "dice dice-side-five", 
        "dice dice-side-six"]; 
        function rollDice(e) { 
    var obj=e.target; 
    var elementToRemove = " dice-window-wrapper "; 
    while((" "+obj.className+" ").indexOf(elementToRemove)==-1){ 
        obj=obj.parentNode; 
    }
    var allDiceInWindow=obj.getElementsByClassName("dice"); 

    for(var i = 0; i<allDiceInWindow.length; i++){
        // set the name individually for each die
        var name = diceArray[Math.floor(Math.random() * diceArray.length)]; 
        allDiceInWindow[i].className = name;
    }
} 
    }
    rollEvent(); 
```

# opencv - 模糊模板匹配？

> ID：14792103
> 
> 赞同：20
> 
> 时间：2013-02-09T22:03:14.960
> 
> 标签：opencv, computer-vision

我正试图围绕简历的基础知识。最初让我感兴趣的是模板匹配（在与 CV 无关的 Pycon 演讲中提到过），所以我想我会从那里开始。

我从这张图片开始：

![来自 SMB3 的场景](../Images/332e24abdc30ab4f7fa46dcbf0b08a3b.png)

我想从中检测到马里奥。所以我把他删掉了：

![水管工](../Images/ac53cbc759fc0fdff65ec8dc52a9e418.png)

我了解在图像周围滑动模板以查看最佳匹配的概念，并且按照教程，我可以使用以下代码找到 mario：

```
def match_template(img, template):
    s = time.time()
    img_size = cv.GetSize(img)
    template_size = cv.GetSize(template)

    img_result = cv.CreateImage((img_size[0] - template_size[0] + 1, 
                            img_size[1] - template_size[1] + 1), cv.IPL_DEPTH_32F, 1)
    cv.Zero(img_result)

    cv.MatchTemplate(img, template, img_result, cv.CV_TM_CCORR_NORMED)
    min_val, max_val, min_loc, max_loc = cv.MinMaxLoc(img_result)
    # inspect.getargspec(cv.MinMaxLoc)
    print min_val
    print max_val 
    print min_loc 
    print max_loc
    cv.Rectangle(img, max_loc, (max_loc[0] + template.width, max_loc[1] + template.height), cv.Scalar(120.), 2)
    print time.time() - s
    cv.NamedWindow("Result")
    cv.ShowImage("Result", img)
    cv.WaitKey(0)
    cv.DestroyAllWindows() 
```

到目前为止一切顺利，但后来我意识到这是非常脆弱的。它只会找到具有特定背景并显示特定动画帧的马里奥。

所以我很好奇，鉴于马里奥将始终具有相同的马里奥属性，（大小，颜色）是否有一种技术可以让我找到他，无论他的当前框架是静止不动，还是各种跑步中的一种循环精灵？有点像模糊匹配，你可以在字符串上做，但对于图像。

也许既然他是唯一的红色东西，有一种方法可以简单地跟踪红色像素？

另一个问题是从模板中删除背景。也许这会帮助 MatchTemplate 函数找到马里奥，即使他与模板不完全匹配？截至目前，我不完全确定它是如何工作的（我看到 MatchTemplate 中有一个掩码参数，但我必须进一步调查）

我的主要问题是模板匹配是否是检测几乎相同但变化的图像的方法（比如他走路时），还是我应该研究另一种技术？

## 更新：

## 尝试匹配其他马里奥

* * *

根据 mmgp 的建议，它应该可以匹配其他东西，我进行了一些测试。

我用这个作为模板来匹配：

![超级马里奥](../Images/90ed62c82d129af0aa83aafca6fb5232.png)

然后拍了几张屏幕截图来测试匹配。

首先，我成功找到了马里奥，并获得了最大值 1。

![在此处输入图像描述](../Images/8c33420c25a454f1b64eb96b5b83de62.png)

然而，试图找到跳跃的马里奥会导致完全失火。

![失火](../Images/7f2cd8264f25ed917e7cba88121c0d04.png)

现在，模板中的 mario 和场景中的 mario 面向相反的方向，并且是不同的动画帧，但我认为它们仍然比图像中的其他任何东西都匹配*得多*——如果只是为了单独的颜色。但它将平台定位为与模板最接近的匹配项。

请注意，这个最大值是`0.728053808212`.

*接下来我尝试了一个没有*马里奥的场景，看看会发生什么。

![在此处输入图像描述](../Images/212cec1b5c36e89400392a472b97240c.png)

但奇怪的是，我得到了作为跳跃马里奥图像的*确切*结果——直到相似度值：`0.728053808212`. *马里奥出现在照片中与他不在*照片中一样准确。

真的很奇怪！我不知道底层算法的实际细节，但我想，从标准偏差的角度来看，场景中至少与模板马里奥西装中的红色相匹配的盒子会比蓝色更接近平均距离平台，对吧？因此，它甚至不在我期望的一般区域中，这更加令人困惑。

我猜这是我的用户错误，或者只是一个误解。

为什么一个有类似马里奥的场景会和没有马里奥的场景有同样多的匹配？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-10T15:16:49.743

没有一种方法是万无一失的，但是模板匹配确实有很好的机会在那里工作。它可能需要一些预处理，直到有一个更大的样本（例如一个短视频）来演示可能的问题，尝试更高级的方法并没有多大意义，仅仅因为某些库为您实现了它们——尤其是如果你不知道他们应该在什么条件下工作。

例如，这是我使用模板匹配（红色矩形）得到的结果——所有这些都使用模板[http://i.stack.imgur.com/EYs9B.png](https://i.stack.imgur.com/EYs9B.png)，甚至是最后一个：

![在此处输入图像描述](../Images/b3956c6f1da0dee765f23926c02cfa95.png) ![在此处输入图像描述](../Images/1dff2f1f98d8ad71d957d478086f3c2f.png) ![在此处输入图像描述](../Images/0cb5f9ddbb4d7e050a00c9c50e6f59ae.png) ![在此处输入图像描述](../Images/090fcf0149a01c50369918352ed2efea.png)

为了实现这一点，我首先只考虑模板和输入图像的红色通道。从中我们很容易计算内部形态梯度，然后才执行匹配。为了在马里奥不存在时不得到矩形，需要为匹配设置一个最小阈值。这是这两个转换后的模板和图像之一：

![在此处输入图像描述](../Images/7dce9ccf50a1df90838e688160bfeeca.png) ![在此处输入图像描述](../Images/cc8c13b36d4a8f96ab23a07edaec70fc.png)

这是一些示例代码来实现这一点：

```
import sys
import cv2
import numpy

img = cv2.imread(sys.argv[1])

img2 = img[:,:,2]
img2 = img2 - cv2.erode(img2, None)
template = cv2.imread(sys.argv[2])[:,:,2]
template = template - cv2.erode(template, None)

ccnorm = cv2.matchTemplate(img2, template, cv2.TM_CCORR_NORMED)
print ccnorm.max()
loc = numpy.where(ccnorm == ccnorm.max())
threshold = 0.4
th, tw = template.shape[:2]
for pt in zip(*loc[::-1]):
    if ccnorm[pt[::-1]] < threshold:
        continue
    cv2.rectangle(img, pt, (pt[0] + tw, pt[1] + th),
            (0, 0, 255), 2)

cv2.imwrite(sys.argv[2], img) 
```

我希望它在更多不同的情况下会失败，但是有几个简单的调整要做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-10T12:26:42.763

模板匹配并不总是能给出好的结果。您应该查看关键点匹配。

## Step1：找到关键点

让我们假设您设法剪掉了马里奥或获得了马里奥的 ROI 图像。将此图像设为您的模板图像。现在，在主图像和模板中找到关键点。所以现在你有两组关键点。一个用于图像，另一个用于马里奥（模板）。

您可以根据自己的喜好使用[SIFT](https://en.wikipedia.org/wiki/Scale-invariant_feature_transform "尺度不变特征变换")、[SURF](https://en.wikipedia.org/wiki/SURF "加速强大的功能")、[ORB 。](http://amarsinghhpcs.blogspot.com/2013/06/surf-freak-brisk-orb-classes-in-opencv.html "定向简介")

[编辑]：

这就是我使用这种方法与 SIFT 和基于 flann 的 knn 匹配得到的结果。我还没有完成边界框部分。

![在此处输入图像描述](../Images/1c590c368d11470f46bd746cb7ba45bf.png)

由于您的模板非常小，SIFT 和 SURF 不会给出很多关键点。但是要获得大量的特征点，您可以尝试使用 Harris Corner 检测器。我在图像上应用了哈里斯角，我在马里奥上得到了很好的分数。

![在此处输入图像描述](../Images/5eb2eb099e1fe50283a668da297319ec.png)

## Step2：匹配关键点

如果您使用过 SIFT 或 SURF，您将拥有图像和模板的描述符。使用 KNN 或其他一些有效的匹配算法匹配这些关键点。如果您使用的是 OpenCV，我建议您查看基于 flann 的匹配器。匹配关键点后，您需要过滤掉不正确的匹配项。您可以通过 K-最近邻来执行此操作，并且根据最近匹配的距离，您可以进一步过滤掉关键点。您可以使用 Forward-Backward Error 进一步过滤匹配项。

### 前后误差估计：

1.  将模板关键点与图像关键点匹配这将为您提供一组匹配项。
2.  将图像关键点与模板关键点匹配。这将为您提供另一组匹配项。
3.  这两个集合的共同集合将过滤掉不正确的匹配。

![在此处输入图像描述](../Images/094d2180b6958d5632609d628f0d3ca2.png)

[编辑]：如果您使用哈里斯角检测器，您将只得到点而不是关键点。您可以将它们转换为关键点或编写自己的蛮力数学器。这并不难。

## 第三步：估计

过滤关键点后，您的对象（在本例中为马里奥）附近会有一组关键点，并且有几个分散的关键点。要消除这些分散的关键点，您可以使用聚类。DBSCAN 聚类将帮助您获得良好的点聚类。

## step4：边界框估计

现在你有一个关键点集群。使用 k-means，您应该尝试找到集群的中心。一旦你获得了集群的中心，你就可以估计边界框了。

我希望这有帮助。

[编辑]

尝试使用**Harris Corners**匹配点。过滤哈里斯角后，我使用蛮力方法来匹配点。一些更好的算法可能会给你更好的结果。

![在此处输入图像描述](../Images/9e07856a29bd4b714c841f6166cf0648.png)

# iphone - 在 ViewController 上找不到属性

> ID：14792105
> 
> 赞同：0
> 
> 时间：2013-02-09T22:03:23.160
> 
> 标签：iphone, ios, objective-c, properties

我开始从事 iOS 开发。几天来我一直在寻找解决方案，但我无法得到它。我得到以下代码：

```
@interface SAProfileViewController : UITableViewController {
    @public NSNumber *userId;
}

    @property (weak, nonatomic) IBOutlet UIView *awesomeProfileHeader;

    @property (nonatomic, assign) NSNumber *userId;

@end 
```

如您所见，我正在声明我的财产，然后我这样做：

```
@implementation SAProfileViewController

@synthesize userId = _userId;

... 
```

在另一个 ViewController 上，我导入 SAPProfileViewController。

```
#import "SAProfileViewController.h"
...

-(void)goToUserProfile :(id) sender
{
   UITapGestureRecognizer *gesture = (UITapGestureRecognizer *) sender;

   SAProfileViewController *controller = [[SAProfileViewController alloc] init];

   controller.userId = gesture.view.tag; // << HERE THE ERROR APPEARS

   [self.navigationController pushViewController:controller animated:YES];
} 
```

就是这样，这是我的代码，我收到以下错误：“在'SAProfileViewController *'类型的对象上找不到属性'userId'

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:08:59.620

您在属性类型上犯了一个错误。

改变

```
@property (nonatomic, assign) NSNumber *userId; 
```

至

```
@property (nonatomic, retain) NSNumber *userId; 
```

比你必须创建一个这样的`NSNumber`实例`gesture.view.tag`

```
controller.userId = [NSNumber numberWithInteger:gesture.view.tag]; 
```

或者您可以将您的 userId 更改`NSInteger`为`NSNumber*`

```
@property (nonatomic, assign) NSInteger userId; 
```

（您也必须为 object 属性执行此操作`userId`）

# android - 如何存储和过滤谷歌地方api返回的结果

> ID：14792106
> 
> 赞同：0
> 
> 时间：2013-02-09T22:03:23.673
> 
> 标签：android

我开发了一个使用谷歌地方 API 的应用程序。我设置了查询来搜索按距离排名的“电子商店”。我想缓存 Google Places API 返回的结果，因为我想执行一些操作，比如过滤结果。例如：目前我的应用程序调用列出离用户最近的“咖啡馆”。现在，如果我想过滤结果，只显示“星巴克”而不显示其他咖啡馆，我该怎么做？我如何缓存 api 返回的这些信息？

这是我的 logcat 的一小部分。当返回结果并且我点击星巴克时，这就是我得到的。其中我要缓存的唯一信息是咖啡馆的名称及其纬度经度值。

02-09 15:48:58.728: D/Place(6960): Starbucks300 美国 32.731918-97.111658

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:19:14.763

将结果插入 SQLite 数据库，它还将使用 SQL 查询使搜索、过滤和排序更容易和更快。

# jquery - 如何用其他类名替换一些类名并特别显示这种变化？

> ID：14792109
> 
> 赞同：0
> 
> 时间：2013-02-09T22:03:43.160
> 
> 标签：jquery, html-lists, onload, addclass, removeclass

`<ul>`有很多`<li>`项目，其中一些是`highlighted`，另一些是`simple`：

```
<ul class="news">
      <li class="highlighted">Item 1</li>
      <li class="highlighted">Item 2</li>
      <li class="simple">Item 3</li>
      <li class="highlighted">Item 4</li>
      <li class="simple">Item 5</li>
      <li class="simple">Item 6</li>
      <li class="highlighted">Item 7</li>
      <li class="simple">Item 8</li>
      //...etc..
</ul> 
```

我需要在此页面加载时将所有`highlighted`项目设置为`simple`.

***如果可以显示更改的项目，专门用于打击。**喜欢`fadeOut()`或替换类 2 次，最后将所有项目设置为`simple`类。*

我试过这样，但没有工作：

```
$(document).ready(function () {
    $('.news').onload(function () {
        $(this).find(".highlighted").each(function () {
            setTimeout(function () {
                $(this).removeClass('highlighted');
            }, 4500);
            $(this).addClass("simple");
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:07:46.673

缓存`this`，摆脱`onload`：

```
$(document).ready(function () {
    $('.news').find(".highlighted").each(function () {
        var $that = $(this);
        setTimeout(function () {
            $that.removeClass('highlighted');
        }, 4500);
        $that.addClass("simple");
    });
}); 
```

[**演示**](http://jsfiddle.net/c2j44/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:13:12.510

> *" 或替换类 2 次，最后将所有项目设置为简单类。"*

像这样的东西：

```
$(document).ready(function() {
    var $lisToChange = $("ul.news li.highlighted");
    for (var i = 0; i < 3; i++)
       setTimeout(function() {
           $lisToChange.toggleClass('highlighted simple');
       }, i * 500 + 500);
}); 
```

演示：http: [//jsfiddle.net/Ex6tw/1](http://jsfiddle.net/Ex6tw/1)

也就是说，获取对需要更改的元素的引用（`$lisToChange`在我的代码中），然后仅在这些元素上切换类。要通过多次执行来引起对更改的注意，只需`setTimeout()`在循环中使用即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T22:17:07.477

以下将等待 4.5 秒，然后`highlighted`从元素内的所有元素中删除该类，`news`并将其替换为`simple`.

```
<script type="text/javascript">
    $(document).ready(function () {
        setTimeout(function() {
            $('.news > .highlighted').toggleClass('highlighted simple');
        }, 4500);
       });       
    });
</script> 
```

如果您希望它们一次完成一个，那么相隔 4.5 秒。

```
<script type="text/javascript">
    $(document).ready(function () {
        $('.news > .highlighted').each(function(i) {
            var $self = $(this);
            setTimeout(function() {
                 $self.toggleClass('highlighted simple');
            }, (i + 1) * 4500);
        });      
    });
</script> 
```

如果您想要淡出效果，请以不同的外观淡入，看起来像

```
<script type="text/javascript">
    $(document).ready(function () {
        $('.news > .highlighted').each(function(i) {
            var $self = $(this);
            setTimeout(function() {
                 $self.fadeOut(function() {
                      $self.toggleClass('highlighted simple')
                           .fadeIn();
                 });
            }, (i + 1) * 4500);
        });      
    });
</script> 
```

# vb.net - VB.Net 更改 Windows7 密码提示

> ID：14792127
> 
> 赞同：1
> 
> 时间：2013-02-09T22:05:10.810
> 
> 标签：vb.net, windows-7, passwords

我正在创建一个 Windows 窗体程序，它将更改新映像 PC 上的特定设置。所有 PC 都将运行 Windows7，并且它们不在任何域中。我需要做的是更改或删除此 PC 上本地帐户的密码提示。如果不更改密码就无法更改密码提示即可。

我有更改密码的代码，但不幸的是它不会更改或删除密码提示。我搜索了谷歌，似乎没有任何关于如何做到这一点的信息。

# r - 另一种 Quantmod ZigZag 叠加

> ID：14792128
> 
> 赞同：6
> 
> 时间：2013-02-09T22:05:19.433
> 
> 标签：r, quantmod

我目前正在使用`quantmod`ZigZag 叠加，我注意到它的计算方式与原始叠加有所不同。我已经展示了下[图](http://i.imgur.com/MrTPotq.gif)使用 ZigZag(5%)`quantmod`和 a 和不同程序的 RDWR 的区别。如您所见`quantmod`，缺少重要的点峰和高点。使用[StockCharts](http://stockcharts.com/h-sc/ui?s=RDWR&p=D&yr=0&mn=7&dy=0&id=p46452609438)时，您还可以非常清楚地看到差异。

我认为这是因为`quantmod`平滑趋势的方式。该算法应该同时使用高值和低值，而不仅仅是平均价格或其他一些回归。我想知道是否`quantmod`或可能`TTR`提供一个替代之字折线叠加层来产生所需的输出（如图的上部所示）。

谢谢。

在图片中显示`quantmod`输出的代码是

```
s<-get(getSymbols('rdwr'))["2012-07::"]
chart_Series(s)
add_TA(ZigZag(s,5),on=1) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T16:24:22.643

问题是`?ZigZag`说输入应该是高/低价系列，而您提供了 OHLCVA 系列。如果您提供高/低系列，它可以正常工作。

```
s <- getSymbols('rdwr', auto.assign=FALSE)
chart_Series(s, subset="2012-07::")
add_TA(ZigZag(s[,2:3],5),on=1) 
```

![在此处输入图像描述](../Images/fe6ef9ad2b9d0f8798a270b147b310b9.png)

# php - 跨所有链接的一致查询字符串

> ID：14792129
> 
> 赞同：0
> 
> 时间：2013-02-09T22:05:22.290
> 
> 标签：php, javascript, html

在我网站的每个页面上都有一个用户可以选择的过滤器。让我们称之为 option1、option2 和 option3。此过滤器是一个链接，单击该链接会将查询字符串附加到 URL 中，例如 www.mysite.com/?option2。

问题是，一旦您开始导航，此查询字符串就不会保留在其他页面中。?option2 在途中迷路了。

我的问题：如何将当前查询字符串附加到当前页面的链接中，直到我更改它？

假设如果在一个页面上我选择了 option2，那么我的菜单链接将类似于 www.mysite.com/menu1/title?option2、www.mysite.com/menu1/title?option2 等以及所有其他链接该页面，直到我选择另一个过滤器。

我更喜欢 PHP 解决方案，但也不介意 js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:11:28.563

试试饼干。
这是一个小教程： http:
[//php.about.com/od/advancedphp/qt/php_cookie.htm](http://php.about.com/od/advancedphp/qt/php_cookie.htm)

# c# - 应用程序压力测试错误

> ID：14792134
> 
> 赞同：1
> 
> 时间：2013-02-09T22:06:17.800
> 
> 标签：c#, multithreading, thread-safety

我正在对我的应用程序进行压力测试，并编写了一个简单的测试来生成数百个调用方法的线程。下面的代码适用于 1000 个线程和 100 毫秒延迟。

在下面的代码中，当线程数为 2000 且延迟为 100 时，我收到错误无法在 radButtonEmptyThread_Click 的 catch 语句中将“shell32.dll”DLL 加载到内存中

1.  我该如何解决？
2.  写入的值“Debug.Print(count.ToString());” 总是 1000 - 为什么？

**C# 代码**

```
private void radButtonEmptyThread_Click(object sender, EventArgs e)
        {
            try
            {

                for (int i = 0; i < int.Parse(radTextBoxWaitThreads.Text); i++)
                {
                    Thread Trd = new Thread(() => EmptyThreadRequest(int.Parse(radTextBoxFloodDelay.Text), i));
                    Trd.IsBackground = true;
                    Trd.Start();
                }
            }
            catch (Exception ex)
            {

                MessageBox.Show(ex.Message.ToString());

            }
        }

        private void EmptyThreadRequest(int delay, int count)
        {

            try
            {

                System.Threading.Thread.Sleep(delay);
                Debug.Print(count.ToString());

            }

            catch (Exception ex)
            {

                MessageBox.Show(ex.Message.ToString());

            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:14:45.410

1.  停止创建这么多线程。这是非常耗费资源的。相反，使用[Tasks](http://msdn.microsoft.com/en-us/library/dd537609.aspx)。

2.  `i`是一个[捕获的变量](https://stackoverflow.com/q/271440/785745)，这意味着线程都访问原始变量，而不是副本。如果您在循环内创建变量的副本，它将按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:39:18.963

要处理捕获的变量问题，请在循环内执行以下操作：

```
int x = i;
Thread Trd = new Thread(() => EmptyThreadRequest(int.Parse(radTextBoxFloodDelay.Text), x)); 
```

当然，考虑使用任务。

2000 是 Windows 强制执行的功能限制。我认为这可能与分配给每个线程的最小堆栈有关，但我不会赌上我的生命。任务是非常轻量级的线程，在可能的情况下更喜欢它们而不是线程。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-09T22:42:50.767

**C# 代码**

```
private void radButtonCallEmptyTasks_Click(object sender, EventArgs e)
{
    try
    {

        for (int i = 0; i < int.Parse(radTextBoxWaitThreads.Text); i++)
        {

            // Create a task and supply a user delegate by using a lambda expression. 
            var taskA = new Task(() => EmptyTaskRequest(int.Parse(radTextBoxFloodDelay.Text), i));
            // Start the task.
            taskA.Start();
        }
    }
    catch (Exception ex)
    {

        MessageBox.Show(ex.Message.ToString());

    }
}

private void EmptyTaskRequest(int delay, int count)
{

    try
    {

        System.Threading.Thread.Sleep(delay);
        Debug.Print(count.ToString());

    }

    catch (Exception ex)
    {

        MessageBox.Show(ex.Message.ToString());

    }
} 
```

}

# c# - MVC 3 任务等待

> ID：14792136
> 
> 赞同：3
> 
> 时间：2013-02-09T22:06:30.813
> 
> 标签：c#, asp.net, asp.net-mvc-3, task

我正在开发一个 mvc3 项目，该项目使用的是进行异步调用的外部 sdk。我已经尝试了以下代码，但它不会等待我的任务完成。

```
public ActionResult Index()
    {
        var price = 0m;
        var t = Task.Factory.StartNew(() =>
                                          {
                                              // calculate price for example                                         });
                                          });
        t.Wait();
        ViewBag.price = price;
        return View();
    } 
```

当我调试第一个断点是 ViewBag 中的价格设置，然后它进入任务。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T22:09:24.973

该`t.Wait()`调用将阻止当前操作的执行，直到任务完成。在您的示例中，任务由您编写的匿名函数表示。当然，如果您在放置评论 ( `// calculate price for example`) 的位置放置了一些异步代码，该评论会立即返回，那么使用任务和等待就没有多大意义了。

所以我想这一切都取决于你在那里执行的具体任务。请记住，在 ASP.NET MVC 应用程序中阻塞主线程是一种非常糟糕的做法。我建议您查看一下[`asynchronous controllers`](http://msdn.microsoft.com/en-us/library/ee728598%28v=vs.100%29.aspx)，以优化 ASP.NET MVC 应用程序中异步任务的执行并充分利用 I/O 完成端口，以免危及工作线程。

这是一个示例，说明在您的情况下这种异步控制器的外观：

```
public class HomeController : AsyncController 
{
    public void IndexAsync() 
    {
        AsyncManager.OutstandingOperations.Increment();
        sdk.Items().GetAll(items => 
        {
            decimal price = items.Sum(i => i.Price); 
            AsyncManager.Parameters["price"] = price;
            AsyncManager.OutstandingOperations.Decrement();
        };
    }

    public ActionResult IndexCompleted(decimal price) 
    {
        // Oh Dude, please use view models and crap on this ViewBag shit
        ViewBag.price = price;
        return View();
    }
} 
```

# python - 本地和部署服务器之间的 Django 设置差异

> ID：14792147
> 
> 赞同：0
> 
> 时间：2013-02-09T22:08:03.160
> 
> 标签：python, django, settings, importerror, openshift

我在设置我的 Django 应用程序以在 openshift 上部署和在本地测试时遇到问题。

这是我的结构

```
root_folder/
    my_project/
        anoter_app/
            urls.py
            views.py
        my_project/
            settings.py
            urls.py
            views.py
        manage.py
    application.py (to tell openshift where my settings file is: my_project.myproject.settings) 
```

因此，为了让它在部署服务器上工作，在设置中，ROOT_URL_CONF 是：

`myproject.myproject.urls`

在我的 url 文件中，必须以`myproject.myproject.views`

但是当我想在本地工作时，我必须将 ROOL_URL_CONF 更改为`myproject.urls` 并且可以通过`myproject.views`

如何使用相同的设置使其在本地和部署服务器上工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:54:21.477

在 settings.py 的底部创建一个名为 local_settings.py 的新文件，添加：

```
try:
    import local_settings
except:
    print 'CAUTION -- NOT USING LOCAL SETTINGS!' 
```

将您需要在本地环境中覆盖的任何设置放在 local_settings.py 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T23:50:49.170

我解决了，问题是文件夹和应用程序名称相同。我重命名了应用程序，现在我不必做 myproject.myproject

# java - 当我们调用重写方法 addFive() 时，在创建 Bar 对象时打印 b，但为什么它在 Boo Class.Output 中调用“a”是 b3

> ID：14792149
> 
> 赞同：0
> 
> 时间：2013-02-09T22:08:11.010
> 
> 标签：java

```
class Boo {
    public int a = 3;

    public void addFive() {
        a += 5; 
        System.out.print("f "); 
    }
}

class Bar extends Boo {
    public int a = 8;
    public void addFive() { 
        this.a += 5;
        System.out.print("b " ); 
}

public static void main(String[] args) {
    Boo f = new Bar();
    f.addFive();
    System.out.println(f.a);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:10:40.403

您不会覆盖实例字段，而只会隐藏它们。因此，当您访问`Boo`引用上的实例字段时，您将获得仅在`Boo`类中声明的字段。

当你`a`在`Bar`构造函数中增加时：

```
this.a += 5; 
```

它正在增加`a`声明的 in `Bar`，因为它隐藏了`a`声明的字段 in `Boo`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:10:05.533

因为你用过`Boo`

```
Boo f=new Bar(); 
```

引用和字段不是多态的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:12:58.170

`a`Bar 中的字段是 Boo 中的*阴影*字段`a`。这是一个单独的字段，但因为它具有相同的名称，所以您必须在 Boo by`super.a`中引用该字段才能从 Bar 访问它。

[上一个问题](https://stackoverflow.com/questions/1092099/what-is-variable-shadowing-used-for-in-a-java-class)很好地涵盖了阴影。

# c++ - 在 C++ 中动态地而不是静态地使用 STL

> ID：14792151
> 
> 赞同：0
> 
> 时间：2013-02-09T22:08:19.117
> 
> 标签：c++, visual-studio, dll, stl

我正在阅读一篇关于减少 win32 PE 大小的文章：http: [//www.catch22.net/tuts/reducing-executable-size](http://www.catch22.net/tuts/reducing-executable-size)

我目前正在从事一个项目，其特点之一是 PE 尺寸非常小。

我问自己**——STL（即标准模板库）是否可以动态而不是静态使用？**

我想因为它使用的是编译时生成的模板，所以它可能有点问题。

所以 - 有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:47:49.133

是的，这是可能的。MSVC++ 有一个标准库的 DLL 版本，其中包含例如，`std::string`您可以使用相同的技术在您的实例化中添加额外的 DLL。

# php - 为所有图像 URL 添加时间戳

> ID：14792152
> 
> 赞同：0
> 
> 时间：2013-02-09T22:08:23.990
> 
> 标签：php, regex, preg-replace

我认为自己相当聪明，但除了简单的正则表达式之外的任何东西我都害怕。

我试图找出一个 preg_replace 来替换所有图像链接并添加时间戳（通常的傻瓜缓存技巧）。所以我正在寻找的是一个正则表达式

```
blah blah blah <a href='blah>blah</a> blah <img src="http://blah.com/test.jpg" /> blah blah <a href="blah"><img src='/tester.jpg' /></a> blah blah 
```

并使其成为

```
blah blah blah <a href='blah>blah</a> blah <img src="http://blah.com/test.jpg?timestamp=123" /> blah blah <a href="blah"><img src='/tester.jpg?timestamp=123' /></a> blah blah. 
```

是否可以在单个 preg_replace 中完成？如果没有，关于最好的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:16:38.127

HTML解析并不是那么简单。但你可以尝试这样的事情：

```
$search = "/(\<img[^>]+src=)(['\"])([^'\"]+)['\"]/i";
$result = preg_replace($search, '\1\2\3?timestamp='.$ts.'\2', $input); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:58:00.510

您可以通过 JQuery 函数运行您的页面：

```
var timestamp = '?timestamp=123';
$('img').each(function () {
  if ($(this).attr('src')) {
    $(this).attr('src', ($(this).attr('src') + timestamp));
  }
}); 
```

[这是一个例子](http://jsfiddle.net/4DSU3/)。

# jquery - 动画图像不会出现在使用 jquery-1.3.2.min.js 的 Chrome 中。如果使用 jquery-1.9.1.js，它不会出现在 IE 或 Chrome 中

> ID：14792156
> 
> 赞同：0
> 
> 时间：2013-02-09T22:09:07.373
> 
> 标签：jquery, image, animation, using

我无法弄清楚为什么使用 jquery-1.3.2.min.js 动画图像不会出现在 Chrome 中。如果使用 jquery-1.9.1.js，它不会出现在 IE 或 Chrome 中。我正在使用 HTML、css、js。我清除了 Chrome/IE 中的缓存，但这并没有什么不同。还尝试了此论坛中的建议，如下所述，但不适用于此问题。

```
<html>
<head>
<title>left.html</title>
<link rel="stylesheet" type="text/css" href="css/animate.css" />
<script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="js/animatea.js"></script>
</head>
<body>
<div id="mask">
<div><img id="logo" border="0" src="logo.jpg"></div>  
<div id="subtitle">subtitle</div></div>
</body>
</html>

#mask{  
position:relative;  
/*margin-left: 10px;*/  
width: 400px;  
height: 100px;  
border: 0px solid grey;  
}  
#logo{  
float: right;  /*Tried w/o but made no difference*/ 
margin-left: 100%;  /*Tried different values but makes no difference*/
position: absolute; /*Tried fixed/relative but made no difference*/ 
z-index: 1;  
display: none; /*Tried w/o but made no difference*/ 
}  
#subtitle{
float: right; /*Tried w/o but made no difference*/ 
font-size: 0px;
font-family: verdana;
margin-left: 100%;
position: absolute;
z-index:2; /*Tried different number but made no difference*/
}

$(function(){  
//$('#lat1').click(function(){  
var l = $('#logo').width();  
var t = $('#logo').height();  
var speed = 800;  
$('#logo').css({width:0,height:0,display:''});  
moveIt(t,l,s,speed,0);  
});  
function moveIt(a,b,c,d,e){
$('#logo').animate({height:a,width:b,marginLeft:e},d);
aa = a-5;
$('#subtitle').animate({marginTop:aa,marginLeft:e,'fontSize':c},d,function(){
//setTimeout(function(){getBack(a,b,d);a=null,b=null,c=null},500);
});
$('#lat1').hide();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:28:16.477

尝试将您的`img`元素更改为 have`id="logo"`而不是`id="title"`. 您的 CSS 样式和 JS 都引用了一个元素`#logo`，但您没有具有该 ID 的元素。

**编辑：**`moveIt()`直到发布上述内容后，我才看到您添加该功能的更新。我现在看到您的`moveIt()`函数实际使用`#title`了 - 您需要使其与其他代码一致。（您还在`#subtitle`为未显示的元素设置动画？）

另外，我不确定使用`#logo`as`float:right` *和* `position:absolute`- 尝试没有`float`.

# phpmyadmin - 数据库连接正常，phpmyadmin 不起作用

> ID：14792157
> 
> 赞同：0
> 
> 时间：2013-02-09T22:09:18.247
> 
> 标签：phpmyadmin, localhost, wamp

我已经能够很好地连接到我的本地数据库；从 mysql 命令行运行查询工作得很好，当我尝试导航到 phpmyadmin 时，它给了我以下错误：

```
 Error

    MySQL said: Documentation
    #2002 - No connection could be made because the target machine actively refused it.

    The server is not responding (or the local server's socket is not correctly configured). 
```

谁能告诉我如何解决这个问题，我尝试搜索其他地方，但我就是不明白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:26:37.270

如果 phpmyadmin 与数据库在同一台机器上，那么它可以连接到套接字或通过 TCP。虽然我不知道，因为您没有发布任何配置，看起来可能正在使用 TCP，并且它指向一个地址，或 localhost，或 127.0.0.1，或 xxxx，或端口号，未打开、未侦听或已防火墙。（这是一个很长的镜头，但检查 conf 文件中的主机名与**cat /etc/hosts**的输出，看看它们是否指向相同的位置或 IP。）如果你发布你的配置，我可以告诉你分钟。如果要运行**netstat -tupl**或**netstat -an | grep -i sql**并查看您的守护程序是否正在侦听预期的 IP 和端口，这将为我们提供线索。根据你的机器，你也可以尝试做一个**updatedb**后跟“locate mysql | grep -i sock”以查看您的 mysql 套接字所在的位置。将这几个测试的结果与您的配置进行比较。让我知道。干杯。Jason *Post Script：下次发布时，请包括操作系统、版本、版本、位置等，以便我们更好地帮助您。*

# jquery - 阻止新的 CSS3 和 jQuery 动画，直到前一个动画完成

> ID：14792161
> 
> 赞同：0
> 
> 时间：2013-02-09T22:09:41.900
> 
> 标签：jquery, css, jquery-animate, css-transitions

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:25:15.433

设置一个变量来跟踪动画过程。当您在按键上触发动画时，将变量设置为 true；

```
var isTransitioning = true; 
```

在播放函数的顶部添加此行以检测它是否处于转换中，如果它不执行该函数。

```
if ( isTransitioning ) { return false; } 
```

检测[过渡结束 如何在没有 JavaScript 库的情况下检测过渡结束？](https://stackoverflow.com/questions/8814631/how-do-i-detect-a-transition-end-without-a-javascript-library)并将变量设置回false。

# iphone - 图像未从 css 文件加载

> ID：14792162
> 
> 赞同：0
> 
> 时间：2013-02-09T22:09:44.833
> 
> 标签：iphone, ios, objective-c

我已经设法在 UIWebView 中显示 html，但我的问题是图像没有显示在我的 HTML 中，尽管我的图像、css 和 javascript 都位于同一个项目文件夹中。

这是我的 HTML：

```
<html>
    <head>
        <meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no, width = 320"/>
        <link rel="stylesheet" type="text/css" href="site.css">
        <script src="site.js" type="text/javascript" />
    </head>
    <body style="margin:0;padding:0;">
        <div class="player"></div>
        <div class="controller">
            <div class="search"></div>
        </div>  
    </body>
</html> 
```

这是我的CSS：

```
body{
    padding:0;
    margin:0;
}

div.player{
    width:320px;
    height:180px;
}

div.controller{
    float:left;
     width:320px;
}

div.search{
    float:left;
    height:40px;
    width:320px;
    background-image:url('search.jpg');
} 
```

最后，我的 Objective-C：

```
-(void)viewDidLoad {
    NSString *path = [[NSBundle mainBundle] bundlePath];
    NSURL *baseURL = [NSURL fileURLWithPath:path];

    NSString *htmlFile = [[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"];
    NSString *htmlString = [NSString stringWithContentsOfFile:htmlFile encoding:NSUTF8StringEncoding error:nil];
    [navigatorWindow loadHTMLString:htmlString baseURL:baseURL];

    NSLog(@"%@",htmlString);
    [super viewDidLoad];
} 
```

知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:13:06.393

确保将`search.jpg`其添加到 Xcode 项目中。我相信这就是问题所在，因为它是一个本地 html 文件，而不是托管在服务器上。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T04:23:20.643

`background-image:url('search.jpg');`您必须在此处提供图像的完整路径

# html - HTML/CSS 背景图像不显示？

> ID：14792165
> 
> 赞同：1
> 
> 时间：2013-02-09T22:10:03.290
> 
> 标签：html, css, background-image, fullscreen

我只是想设置我的背景，但这个图像不起作用。它的大小在 15 到 20MB 之间，所以我试着把它变成 5MB。仍然没有运气。我制作了一个非常小的图像，大小为 25 KB，并且效果很好，但只是重复了一遍。我的本地主机也不会显示大图像。有什么限制吗？我需要做什么才能获得完整的图像页面？

```
body {
    background-image:url(background.jpg);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:13:08.203

这样做是为了避免重复图像：

```
body
{
    background-image:url(background.jpg);
    background-repeat:no-repeat;
} 
```

你也可以`background-size: cover`这样尝试：

```
body
{
    background-image: url("http://www.google.com/doodle4google/images/carousel-winner2012.jpg");
    background-repeat: no-repeat;
    background-position: center center;
    -moz-background-size: cover;
    -webkit-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    background-attachment: fixed;
} 
```

这是 JS Bin 的一个演示，使用漂亮的[Doodle 4 Google](http://www.google.com/doodle4google/)作为背景图像来测试行为：

[http://jsbin.com/ivexah/2](http://jsbin.com/ivexah/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:13:13.347

您需要为 body 指定宽度和高度。例如：

```
html, body {
   width: 100%; 
   height: 100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:21:22.123

您可以使用速记`background`css 属性：

```
background: url(background.jpg) no-repeat; 
```

此外，您`body`的高度可能不是 100%，因为您的页面上没有内容。要么给你的`html`和`body`100% 的高度，要么给你的页面添加更多的内容。

要使背景图像覆盖其整个容器，请使用[background-size](http://www.w3schools.com/cssref/css3_pr_background-size.asp)：

```
background-size: cover; 
```

IE8 及更低版本不支持此功能。对于那些浏览器，您需要一个 javascript 后备。css-tricks.com 上有一篇[很棒的文章，展示了不同的技术。](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T22:28:49.287

您不应该对背景图像有任何“大小”限制。很可能，您的文件太大，以至于您没有等待足够长的时间来加载它，或者您没有设置宽度和高度。如果没有尺寸，您尝试加载背景图像的元素 tahat 基本上将具有 0px x 0px 的大小。请参阅以下 jsfiddle 示例：

[http://jsfiddle.net/GymxW/1/](http://jsfiddle.net/GymxW/1/)

的HTML：

```
<div class="container"></div> 
```

CSS：

```
.container {
    width: 400px;
    height: 100px;
    background-image: url(http://dummyimage.com/400x100/4d494d/686a82.gif&amp;text=background+image);
    background-repeat: none;
    background-position: 0 0;
} 
```

重要提示：如果您希望将图像“拉伸”到视口的全尺寸，一个简单的解决方案是使用插件，例如[Backstretch](http://srobbin.com/jquery-plugins/backstretch/)。

# php - for () 循环中的函数：致命错误：无法重新声明

> ID：14792169
> 
> 赞同：1
> 
> 时间：2013-02-09T22:10:47.890
> 
> 标签：php, function, for-loop, fatal-error

我有[这段](http://pastebin.com/pND5v1N9)代码，但是当我尝试执行它时，它给出了以下错误：
`Fatal error: Cannot redeclare genereerLiveCodeP() (previously declared in livestream.php:33) in livestream.php on line 32.`

```
session_start();

mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

//header("location: index.php");
if($_SESSION['***'] == '***'){
$fp = fopen("test.html", 'w');
fwrite($fp, "");
fwrite($fp, '<p class="green">*** is online</p>');

$result = mysql_query("select count(1) FROM ***");
$row = mysql_fetch_array($result);

$rows = $row[0]+1000;

echo "Rows: ".$rows."\n";

for ($id = 1000; $id < $rows; $id++) {

echo "ID: ".$id."\n";

function genereerLiveCodeP () {
        $lengthCode = 6;
        $characters = '1234567890abcdefghijklmnopqrstuvwxyz';
        $liveCodeFunction = '';

        for ($p = 0; $p < $lengthCode; $p++) {
        $liveCodeFunction .= $characters[mt_rand(0, strlen($characters))];
    }

    return $liveCodeFunction;
}

$livecode = genereerLiveCodeP ();

echo "Livecode: ".$livecode."\n";

$x = mysql_query("UPDATE *** SET livecode='".$livecode."' WHERE *** = '".$***."'");

echo $x."\n";

}

} 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:13:36.217

在`for`声明`function`. 您的代码应如下所示：

```
...
for ($id = 1000; $id < $rows; $id++) {
echo "ID: ".$id."\n";
}

function genereerLiveCodeP () {
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:42:04.827

首先，您使用的是已弃用的扩展名 ( [`ext/mysql`](https://stackoverflow.com/q/12859942/))。

您需要将函数移到`for`循环之外。PHP 不能那样工作（重新声明函数是不可能的，因此会出现错误）

如果您使用准备好的查询，您可以获得更大的性能提升，并且拥有更多面向未来的代码（当这些函数开始抛出错误时，您的代码将在 PHP 5.5 中中断）

```
session_start();
$db = new mysqli($host, $username, $password, $db_name);
function generate_live_code($length = 6) {
    $characters = '1234567890abcdefghijklmnopqrstuvwxyz';
    $str = '';
    for ($i = 0; $i < $length; $i++) {
        $str .= $characters[mt_rand(0, strlen($characters))];
    }

    return $str;
}

//header("location: index.php");
if($_SESSION['id'] == 'debug') {
    $fp = fopen("test.html", 'w');
    fwrite($fp, "");
    fwrite($fp, '<p class="green">*** is online</p>');
    // writing html to a file? consider using a database...
    $result = $db->query("select count(1) FROM x");
    $row = $result->fetch_assoc($result);
    $rows = $row[0]+1000;

    echo "Rows: $rows\n"; // no need to concat with double quotes.
    if ($query = $db->prepare("UPDATE x SET livecode = ? WHERE id = ?")) {
        for ($id = 1000; $id < $rows; $id++) {
            echo "ID: ".$id."\n";
            $livecode = generate_live_code();
            echo "Livecode: $livecode\n";
            $query->bind_param("si", $livecode, $id);
            $query->execute();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:14:51.627

您`genereerLiveCodeP()`在循环中声明函数，尝试将其放在文件的开头。

# e-commerce - Shopify 上的供应商特定定价

> ID：14792171
> 
> 赞同：1
> 
> 时间：2013-02-09T22:10:58.733
> 
> 标签：e-commerce, shopify

我的一个客户在 Shopify 上有一个面向服务的电子商务网站，他要求我协助进行一些更改。我从来没有使用过这项服务，所以我对它不是很熟悉。

价目表起初是静态的，因为客户使用相同的供应商，但现在他们正在增长 - 因此使用多个供应商 - 成本在波动，因此 Shopify 上的价格需要反映这一点。

我需要进行设置，以便在客户登录时根据其地理位置以编程方式选择供应商，并且价格（向客户显示）相应调整。

这可能吗？如果是这样，我应该查看哪些对象/API 文档。我似乎可以使用 IF 语句轻松地对其进行硬编码，但我希望它能够干净地扩展，所以我正在寻找更有效的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T13:13:52.967

我认为这应该是可能的。根据您的评论：

> 我不会有客户的邮政编码吗？– 瑞安麦克

最简单的方法是为每个区域创建一个[产品变体。](http://wiki.shopify.com/Products-2#Create_new_product_variant)根据`customer.default_address`您可以找到[客户](http://wiki.shopify.com/Customer_variable#customer.default_address)的邮政编码。下一步是在`product.liquid` [模板](http://wiki.shopify.com/Product.liquid)中使用它来选择正确的变体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T17:59:53.577

您遇到的最大问题是确定它们的位置。当客户登录时，您知道他们是谁，因此您可以只提供他们感兴趣的产品。问题是，您如何将人们归为这些区域？你的工作已经完成了。当您创建客户时，您可以为他们分配您想要的任何代码，因此也许您可以使用匹配来将客户与供应商匹配。将任何客户集中到 GroupA 中，您只显示供应商 GroupA 的产品，分配给 GroupB 的任何客户都呈现供应商 GroupB 的产品......等等

# f# - 具有非公共可区分联合的 %A 格式的奇怪行为

> ID：14792173
> 
> 赞同：6
> 
> 时间：2013-02-09T22:11:18.530
> 
> 标签：f#

输出：

```
type Test =
  | First
  | Second
  | Third

let test = First

printf "test=%A" test 
```

是

```
test=First 
```

正如预期的那样，但如果我声明类型`internal`：

```
type internal Test =
  | First
  | Second
  | Third

let internal test = First

printf "test=%A" test 
```

输出变为：

```
test=FSI_0019+Test 
```

这是设计使然吗？为什么？还是一个错误？

我正在使用带有 F# 2.0 的 Visual Studio 2010

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-09T22:25:45.137

要打印非公共成员，请使用“+”标志。MSDN 中缺少它的事实看起来像文档问题：

```
printf "test=%+A" test 
```

# java - Netty - 忽略 IP_TOS 的失败设置

> ID：14792176
> 
> 赞同：0
> 
> 时间：2013-02-09T22:11:40.557
> 
> 标签：java, netty

我的用户正在向我报告此错误，我想默默地忽略它，因为它不是我的应用程序的非关键部分。

> 2013-02-09 15:20:15 [警告] 无法设置通道选项：[id: 0x8cf59443, /84.100.204.150:51292 => /87.98.181.225:22091] io.netty.channel.ChannelException: java. net.SocketException：无效参数：在 io.netty.channel.socket.DefaultSocketChannelConfig.setOption(DefaultSocketChannelConfig.java:115) 在 io.netty.channel.socket.DefaultSocketChannelConfig.setTrafficClass(DefaultSocketChannelConfig.java:264) 在 io 没有更多信息.netty.bootstrap.ServerBootstrap$ServerBootstrapAcceptor.inboundBufferUpdated(ServerBootstrap.java:264) 在 io.netty.channel.DefaultChannelHandlerContext.invokeInboundBufferUpdated(DefaultChannelHandlerContext.java:1170) 在 io.netty.channel.DefaultChannelHandlerContext.fireInboundBufferUpdated0(DefaultChannelHandlerContext.java:1148) ) 在 io.netty.channel。DefaultChannelHandlerContext.fireInboundBufferUpdated(DefaultChannelHandlerContext.java:1127) 在 io.netty.channel.DefaultChannelPipeline.fireInboundBufferUpdated(DefaultChannelPipeline.java:903) 在 io.netty.channel.socket.nio.AbstractNioMessageChannel$NioMessageUnsafe.read(AbstractNioMessageChannel.java:84)在 io.netty.channel.socket.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:397) 在 io.netty.channel.socket.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:361) 在 io.netty.channel.socket .nio.NioEventLoop.run(NioEventLoop.java:301) at io.netty.channel.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:110) at java.lang.Thread.run(Unknown Source) 原因：java.net。 SocketException：无效参数：sun.nio.ch.Net 上没有更多信息。setIntOption0(Native Method) at sun.nio.ch.Net.setSocketOption(Unknown Source) at sun.nio.ch.SocketChannelImpl.setOption(Unknown Source) at sun.nio.ch.SocketAdaptor.setIntOption(Unknown Source) at sun。 nio.ch.SocketAdaptor.setTrafficClass(Unknown Source) at io.netty.channel.socket.DefaultSocketChannelConfig.setTrafficClass(DefaultSocketChannelConfig.java:262) ... 12 更多

为了做到这一点，我只是`IP_TOS`在我的`ServerBootstrap`： `childOption(ChannelOption.IP_TOS, 0x18)`

如果您知道我需要在哪里放置处理程序，或者选择忽略设置此选项失败的选项，请告诉我。

md_5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T00:57:02.683

这是一个设置选项的示例引导代码：

```
 Bootstrap b = new Bootstrap();
        b.group(new NioEventLoopGroup(), new NioEventLoopGroup())
         .channel(NioServerSocketChannel.class)
         .option(ChannelOption.SO_BACKLOG, 100)
         .handler(new LoggingHandler(LogLevel.INFO))
         .childHandler(new ChannelInitializer<SocketChannel>() {
             @Override
             public void initChannel(SocketChannel ch) throws Exception {
                 try {
                     ch.config().setTrafficClass(0x18);
                 } catch (ChannelException e) {
                     // Ignore
                 }
                 ch.pipeline().addLast(
                         new LoggingHandler(LogLevel.INFO),
                         new EchoServerHandler());
             }
         }); 
```

# java - Java Web 应用程序配置

> ID：14792178
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:12:27.907
> 
> 标签：java, eclipse, configuration-files

我有一个关于 Web 应用程序的非常基本的问题。我决定在论坛上问，因为我不完全知道，在谷歌中寻找什么，我的意思是，我不知道我应该使用什么关键词。我阅读了有关 maven 和 ant 的信息，但我仍然不明白一些事情。这是我的项目结构：

[http://imageshack.us/photo/my-images/842/projectstructure.png/](http://imageshack.us/photo/my-images/842/projectstructure.png/)

我没有任何 build.xml（用于 ant）或 pom.xml（用于 maven）文件，但无论如何我的项目在我的本地计算机上正常运行。如果没有配置文件怎么可能？我只有 applicationContext.xml 负责 spring 配置， faces-config.xml 用于 jsf 2.0 配置和 web.xml 用于 servlet 配置。我尝试以这种方式在 openshift.com 上部署它：我将我的项目导出到 .war 文件，然后将其提交并推送到服务器上。推送结束得很好，但它不起作用。无论如何，我必须了解我的项目如何在本地工作的基础知识。请给我任何提示，我应该从哪里开始。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:21:10.673

这是一篇关于如何在 openshift 上部署 Java EE 应用程序的好 wiki 文章：

[http://jaitechwriteups.blogspot.com/2011/08/deploy-java-ee-application-on-openshift.html?m=1](http://jaitechwriteups.blogspot.com/2011/08/deploy-java-ee-application-on-openshift.html?m=1)

它应该让你走上正确的轨道。

# javascript - 在滑块中显示图像

> ID：14792180
> 
> 赞同：0
> 
> 时间：2013-02-09T22:12:31.323
> 
> 标签：javascript, jquery

我想知道是否有一种简单的方法可以像滑块一样将图像放置在如下循环中？用户在滑块中看到第一张图像，然后通过使用箭头，例如，能够滑动到下一张或上一张图像的旁边。如果用户在最后一张图像上并且想要继续下一张图像，它会再次显示第一张图像。如果用户在第一个图像上并单击上一个图像，它将继续最后一个图像。所以它保持连续。

下面是代码，如果没有图像，则显示空白，但如果有图像，则将这些图像显示在滑块中：

```
<?php
        //start:procedure image
        $img_result = '';
        if(empty($arrImageFile[$key])){
          $img_result = '&nbsp;';
        }else{

?>

<?php foreach ($arrImageFile[$key] as $i) { ?>
<p><img alt="<?php echo $i; ?>" height="200" width="200" src="<?php echo 'ImageFiles/'.$i; ?>"></p>
<?php } ?>

<?php

        }
        //end:procedure image 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T06:51:40.720

A basic jquery slider is easy to implement with instructions of you fancy it: [http://basic-slider.com/](http://basic-slider.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:20:46.123

Codrops 是一个不错的前端解决方案网站，我发现这个插件也许可以帮助你，在本教程中她教你如何做到这一点，并给你一个演示代码。

[http://tympanus.net/codrops/2012/04/05/slideshow-with-jmpress-js/](http://tympanus.net/codrops/2012/04/05/slideshow-with-jmpress-js/)

好好享受！

# css - Is it possible to assign a class inside of a stylesheet

> ID：14792182
> 
> 赞同：0
> 
> 时间：2013-02-09T22:12:43.990
> 
> 标签：css, sass

I'm wanting to do something like:

```
.devise_links a {
  assign-class: 'btn'
} 
```

Is there any way to do this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:23:12.660

No, you need to use Javascript to do that.

But I don't understand the point. Why do you want something like this?

Another thing you can do with SASS is to [extend](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#extend) another class though.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:23:41.920

No, but you can achieve that goal using javascript.

But, and I think this may solve your dilemma, why not just create two classes?

For example, in case you didn't know, you can write css like the following:

```
.devise_links a {
/* your code for all links with the ".devise_links" class  */    
}

.devise_links .device_links_btn a {
/* your code for all links with both the ".devise_links" class and the ".device_links_btn" class */
} 
```

Hope this helps!

# xcode - 缺少来自 Restkit git pull 的 AFHTTPClient.h 和其他供应商/AFNetworking 文件

> ID：14792188
> 
> 赞同：0
> 
> 时间：2013-02-09T22:13:03.223
> 
> 标签：xcode, git, restkit

在离开我的 IOS/Restkit 项目几个月后，在 XCode 更新到 4.6 之后，我遇到了许多链接错误。我将更新下载到 Restkit v0.10.x（来自 XCode Source Control/Pull）。根据 github.com/RestKit/RestKit/wiki/Installing-RestKit-in-Xcode-4.x 进一步配置和清理/构建后，我得到一个丢失的 AFHTTPClient.h。

在 Vendor/AFNetworking 中查看似乎是空的红色文件。

被选为 ResKit 的 IOS 库的 libRestKit.a 也是红色的。

我不是 Git 专家。

我应该从 Git 源卸载/删除并重新安装 Restkit 吗？

还是有什么原因我没有拉下这些文件？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T14:19:13.883

正如 flashfabrixx 指出的那样，在尝试更新 v0.10 时，我已经使用了 v0.20 而不是 v0.10（v010 似乎不再可用）。因此，由于找不到旧的 v0.10 下载，我正在安装 v0.20。

# ruby-on-rails - rails 数据库查询，html 下拉，交互 1:n 关系

> ID：14792193
> 
> 赞同：0
> 
> 时间：2013-02-09T22:13:14.753
> 
> 标签：ruby-on-rails, relationship

晚上好，伙计们，

我已经生成了四个脚手架 Person、Trainer、Sportsman 和 Index。

```
class Person < ActiveRecord::Base
  attr_accessible :alter, :name
end

class Sportler < Person
   belongs_to :trainer
end

class Trainer < Person
  has_many :sportler
end 
```

然后我创建了一个表单：views/index/index.html.erb

```
<table>
  <tr>
      <td>Trainer</td>
      <td>
        trainers = Trainer.find(:all)

        <% @trainers.each do |trainer| %>

          puts "print Results in <select> as Options"
          <select name="trainer">
              </option>Max Musterman</option>
          </select>

        <% end %>

      </td>

      <td>
        <%= link_to 'Neuer Trainer', new_trainer_path %>
      </td>

    <tr>
    <tr>
      <td>Sportler</td>
      <td>
<!--
 <% @sportlers.each do |sportler| %>
       <select name="sportler">
       </select>
 <% end %>
-->
      </td>
      <td>
        <%= link_to 'Neuer Sportler', new_sportler_path %>
      </td>
    <tr>
    <tr>
      <td></td>
      <td></td>
      <td><input type="button" name="trSpAdd" value="Hinzufügen"></td>
    <tr>

</table> 
```

**现在我想将 Trainer 和 Sportman 添加到 DropDown 中。** **一名教练可以拥有一名或多名运动员。一名运动员可以拥有一名教练员。使用表格时必须考虑这一点。我该如何解决这个问题。**

我的开始是这样的，它确实查询 Trainer 行并将其放入下拉列表中：

```
 trainers = Trainer.find(:all)

    <% @trainers.each do |trainer| %>

      puts "print Results in <select> as Options"
      <select name="trainer">
          </option>Max Musterman</option>
      </select>

    <% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:21:30.000

您应该使用 FormTagHelper 中的 select_tag，如下所示：

```
select_tag "trainer", options_from_collection_for_select(@trainers, "id", "name") 
```

# ruby-on-rails - 在 Github 上分叉一个 Ruby/Rails gem 的正确协议/礼仪是什么，可以作为一个持续的并行分叉进行维护？

> ID：14792194
> 
> 赞同：10
> 
> 时间：2013-02-09T22:13:23.537
> 
> 标签：ruby-on-rails, ruby, github, rubygems, gem

最近我使用了一个由单个开发人员创建的不错的 gem，它托管在 Github 上。

在我的工作中，我不得不对它进行了一些实质性的修改，增加了一些改进。有些是特定于项目的，有些是特定于 gem 的，还有一些是独立的改进。

对于特定于 gem 的改进（例如，错误修复），我分叉了 repo，应用了修复，并提出了拉取请求。

然而，然后，我注意到独立改进属于原始 gem 的并行、持续分支的类别。更清楚地说，你以前见过它；我重写了原始 gem 的视图以使用 Twitter Bootstrap 框架。所以，我也把它推送到了 Github，但是，当然，没有提出拉取请求——相反，我更新了 README 来解释有什么不同，并感谢 gem 的原作者。

我的问题是，在这种情况下还应该做什么，假设 gem 是其他人想要使用的东西并且要在 ruby​​gems 等上发布？我是否应该简单地编辑 .gemspec 并保持原作者的信息完整，但将我的信息添加到作者/电子邮件字段，并重写任何其他已更改的内容？还是应该完全重写 .gemspec？

此外，如果原始发行版具有远程测试框架（如**travis.yml**），这些应该被删除，还是留在原地？

是否还有其他通常必须更改/重新创建的文件？

到目前为止我已经更新了

```
.gemspec
README.md
CHANGELOG.md
lib/libraryname/VERSION.rb #called as a constant in .gemspec 
```

最后一个问题本身提出了一个单独的额外问题，版本控制如何在并行发行版中工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-11T20:03:15.503

听起来您已经正确处理了错误修复/分叉。

根据 gem 的许可证，将其作为 yourname-originalname 发布。

您已经做出了整个社区可能感兴趣的实质性更改，这是分叉和发布的公认标准。

它还解决了您的奖金问题。更改您想要发布的任何内容。它现在基本上是一个新项目。当然还是要归功于原始开发人员:)

# batch-file - Windows cmd 批处理循环命令

> ID：14792195
> 
> 赞同：1
> 
> 时间：2013-02-09T22:13:33.887
> 
> 标签：batch-file, cmd, imagemagick

我有一个这样的文件夹结构：

```
my/
 1/
  jpg/
 2/
  jpg/
 3/
  jpg/

etc. 
```

现在我在所有文件夹中手动运行它（比如 1,2,3（在其中我有 jp2 文件要转换））我的 imagemagick 命令：

```
for %f in (*.jp2) do (convert %f -quality 25 jpg/%~nf.jpg) 
```

但是我如何编写批处理文件或将用完`my`文件夹并在循环中输入、压缩为 jpg、先输入`1`、然后输入`2`等的批处理文件。

只是for循环用于win cmd的目录...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T00:32:35.300

我可能会使用这样的东西：

```
cd my
for /d %%d in (*) do (
  for %%f in ("%%~d\*.jp2") do (
    convert "%%~ff" -quality 25 "%%~dpf\jpg\%%~nf.jpg"
  )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:47:13.930

在更高的目录中试试这个

```
for /f "tokens=*"  %f  in ('dir /b/s *.jp2') do pushd "%~pf" & convert "%f" -quality 25 %~nf.jpg & popd 
```

其他选项：

此外，增强了 FOR 变量引用的替换。您现在可以使用以下可选语法：

```
 %~I         - expands %I removing any surrounding quotes (")
    %~fI        - expands %I to a fully qualified path name
    %~dI        - expands %I to a drive letter only
    %~pI        - expands %I to a path only
    %~nI        - expands %I to a file name only
    %~xI        - expands %I to a file extension only
    %~sI        - expanded path contains short names only
    %~aI        - expands %I to file attributes of file
    %~tI        - expands %I to date/time of file
    %~zI        - expands %I to size of file
    %~$PATH:I   - searches the directories listed in the PATH
                   environment variable and expands %I to the
                   fully qualified name of the first one found.
                   If the environment variable name is not
                   defined or the file is not found by the
                   search, then this modifier expands to the
                   empty string

The modifiers can be combined to get compound results:

    %~dpI       - expands %I to a drive letter and path only
    %~nxI       - expands %I to a file name and extension only
    %~fsI       - expands %I to a full path name with short names only
    %~dp$PATH:I - searches the directories listed in the PATH
                   environment variable for %I and expands to the
                   drive letter and path of the first one found.
    %~ftzaI     - expands %I to a DIR like output line 
```

请记住在批处理文件中使用 %% 而不是 %。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T00:22:52.507

或者，您可以使用`FOR /R`循环，它是`FOR`递归的变体：

```
for /r "d:\root" %I in (*.jp2) do (convert "%I" -quality 25 "%~dpI\jpg\%~nI.jpg") 
```

以上内容`d:\root`应替换为您的`my\`目录的路径。

请注意，您不必`CD`进入根目录。上面的命令可以从任何位置正常运行，并且只处理`/R`切换后指定的目录。

另请注意，该`/R`开关指示 FOR 循环处理整个目录树。如果树中可能包含您想要跳过的 .jp2 文件的文件夹，则此解决方案可能不适合您。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-11T21:00:02.773

以下将起作用

```
FOR /F "tokens=* delims=" %%G IN ('DIR /b /s /a-d  my') DO CALL :FileName "%%G"

Exit /b

:FileName
set str1=%~1
convert %f -quality 25 jpg/%str1%.jpg

Exit /b 
```

# mysql - MySQL 错误 2002 (HY000): Can't connect to local MySQL server through socket '/var/run/mysql.sock' in widows 7

> ID：14792200
> 
> 赞同：1
> 
> 时间：2013-02-09T22:14:16.967
> 
> 标签：mysql, windows, cmd, cygwin

好吧，我问的问题可能看起来很愚蠢，但在过去的几天里它让我很难受。即使 mysql 安装文件夹包含在 PATH 中，我也无法从 Windows 命令行运行任何 mysql 命令。

当我尝试执行 mysql 命令时，出现上述错误。我尝试了几次安装/卸载 mysql 版本，但最终没有运气并得到同样的错误。即使在从 Windows 7 完全卸载 mysql 后，我仍然收到同样的错误。如果我在安装文件夹中打开 cmd，则没有问题，但是在其他文件夹中打开 cmd 时会出现问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:49:47.270

**编辑**

***OP 自己解决了这个问题，方法是删除现有的 cygwin 安装和 mysql 安装，然后再次重新安装 mysql 和 cygwin。***

我自己尝试了一下，一开始遇到了同样的问题。但是，这就是我解决它的方法。我添加`c:\xampp\mysql\bin`到路径系统环境变量。我使用 XAMPP，但您可以将其更改为您的安装目录。请注意，我没有在用户变量中设置路径。如果您将路径添加到用户变量它不起作用，但是当您将路径添加到系统时它会起作用。确保您的 MYSQL 服务器正在运行，否则您将收到无法连接的消息。希望这可以帮助。

有关参考，请参阅： [如何使用 XAMPP for Windows 访问 MySQL 命令行？](https://stackoverflow.com/questions/698914/how-can-i-access-the-mysql-command-line-with-xampp-for-windows)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T11:53:50.503

我在更改 mysql ini 文件 C:\wamp\bin\mysql\mysql5.5.24\my.ini 后遇到了这个问题更改了导致错误 2002 的路径。当我重新评论它，即恢复原始设置时，一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T09:59:12.393

`PATH`我通过修改环境变量中 %CYGWIN_HOME%/bin 和 %MYSQL% 路径的顺序解决了这个问题。MYSQL 二进制文件现在首先列在`PATH`变量中：

```
C:\Program Files (x86)\MySQL\MySQL Workbench CE 6.0.7;c:\cygwin\bin;... 
```

当然，它需要启动一个新的命令提示符才能工作（环境变量在命令提示符启动时被缓存）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-06T20:32:10.987

只需使用 setupXXX.exe（针对 mysql 过滤）卸载所有 mysql 客户端库即可为我解决此问题。

# module-pattern - 创建一个模块的多个实例

> ID：14792211
> 
> 赞同：15
> 
> 时间：2013-02-09T22:15:52.363
> 
> 标签：module-pattern, revealing-module-pattern, javascript

我以为我开始很好地理解 JavaScript，但显然不是。让我用一个例子来解释我的问题。首先，我定义了以下模块：

```
var Test = function() {
    var counter = 0;

    function init() {
        alert(counter);
    }

    return {
        counter: counter,
        init: init
    }
}; 
```

然后我创建 2 个实例：

```
var test1 = new Test();
var test2 = new Test(); 
```

现在我更新计数器变量（因为它是公开的）并发出一些警报。到现在为止还挺好。

```
alert(test1.counter); // Alerts 0
test1.counter = 5;
alert(test2.counter); // Alerts 0
test2.counter = 10;
alert(test1.counter); // Alerts 5 
```

现在最后我说以下几点：

```
test1.init(); // Alerts 0
test2.init(); // Alerts 0 
```

这是我不明白的一点。为什么这个警报 0？我以为第一个警报是 5，第二个是 10。

如果有人能解释上述内容如何工作或为我指明正确的方向，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T22:22:37.040

它保留`0`是因为您没有更改内部的变量`Test`，而是更改了函数返回的对象。`counter`保持“私有”，只有一个函数`Test`可以访问它。

```
var Test = function() {
    var counter= 0;

    function init() {
            alert(counter);
    }
    function changeNum(n){
        counter = n;            //add a function inside `Test` so that it can
    }                           //access the variable

    return {
        counter: counter,
        init: init,
        changeNum: changeNum
    }
}; 
```

现在它可以工作了：http: [//jsfiddle.net/DerekL/pP284/](http://jsfiddle.net/DerekL/pP284/)

```
var test1 = new Test();
alert(test1.counter);           //0
test1.init();                   //0
test1.changeNum(5);
alert(test1.counter);           //5
test1.init();                   //5 
```

有关更多信息，请参阅[JavaScript 闭包](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T22:28:56.040

这就是发生的事情：

1.  init() 函数对`counter`在 Test 范围内定义的变量进行了闭包，并持有对它的引用。
2.  Test() 函数的返回创建了一个新对象，其中另一个变量`counter`设置为 internal 的值`counter`。
3.  您通过设置 test1.counter = X 来更新“另一个” `counter`，但 init() 仍然包含对原始变量的引用。

这就是为什么你看到旧的价值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T22:21:36.380

我不确定您是否在帖子中犯了错误，但是您可以将上面的代码重写如下

```
var Test = function() {
  this.counter = 0;
}

Test.prototype.init = function() {
  alert(this.counter);  
}

var test1 = new Test();
var test2 = new Test();

test1.counter = 5;
test2.counter = 10;

test1.init(); // alerts 5

test2.init(); // alerts 10 
```

在您的示例中，您没有将计数器设置为 Test 对象/函数上的属性，而是在调用时`test1.counter`实际上设置了一个以前不存在的新属性，并且您的 init 函数没有引用该属性。

正如德里克斯的回答所示，您似乎对我的回答和他的回答之间的两种不同模式略有混淆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-05T14:48:15.563

```
alert(test1.counter); // Alerts 0 ????? It's "0" because you call it before change counter to 5
test1.counter = 5;
alert(test2.counter); // Alerts 0 ????? It's "0" because you call it before change counter to 10
test2.counter = 10;
alert(test1.counter); // Alerts 5 | It's 5 because you call it AFTER change counter to 5 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-25T00:23:11.270

这是我要做的：

```
function Test() {
    this.counter = 0;
    this.init = function() { console.log(this.counter); }
};

var test1 = new Test();
var test2 = new Test();

console.log(test1.counter); //0
test1.counter = 5;
console.log(test2.counter); //0
test2.counter = 10;
console.log(test1.counter); //5

test1.init(); //5
test2.init(); //10 
```

# c++ - 从数组中存储和读取字符串

> ID：14792214
> 
> 赞同：0
> 
> 时间：2013-02-09T22:16:22.797
> 
> 标签：c++

我正在为作业做的一些代码有问题。当我去编译文件时，它有时可以工作，有时不能。该程序的基本思想是从文件中读取每一行文本并将其存储到一个数组中（数组的大小应该是 100，应该有 100 行文本）。每个文本字符串（每一行）都应该存储在它自己的数组地址中。一旦存储了所有行，程序将从数组中拉出每一行，注意它来自哪个行号。当用 Code::Blocks 编译它时，它运行没有问题，但是，当我用 cygwin 编译它时，我去运行它并得到一条错误消息，上面写着“在抛出一个 'std::bad_cast' 实例后调用终止什么（ ): std::bad_cast 中止（核心转储）"

你们能给我的任何帮助将不胜感激！

这是我到目前为止得到的代码：

```
#include <iostream>
#include <fstream>
#include <cstdlib>

using namespace std;

int main()
{
string aFile[100];
ifstream nFile("TMA1Question4 Text.txt");
string nText;

    if (nFile)
    {
        for (int nLineCounter=1; nLineCounter <=100; getline(nFile, nText))
        {
            aFile [nLineCounter] = nText;
            nLineCounter++;
        }
    }

for (int nLineReader=1; nLineReader<=100; nLineReader++)
{
    cout << "Line" << nLineReader << ": " << aFile[nLineReader] << endl;
}

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:20:29.983

首先，数组从 0 开始索引。数组索引的范围是 0 到 99，而不是 1 到 100。你的`for`循环应该更像：

```
for (int nLineReader=0; nLineReader<100; nLineReader++) 
```

您试图以`for`偷偷摸摸的方式使用循环也是一个问题。`getline`只会在每次迭代*后调用。*在第一次迭代中，您将空字符串粘贴`nText`到数组中。将其更改为：

```
for (int nLineCounter=0; nLineCounter<100; nLineCounter++)
{
    getline(nFile, nText);
    aFile [nLineCounter] = nText;
} 
```

当然，这取决于您*确定*文件中有 100 行。从文件中读取行的更安全的方法是`getline`用作循环的条件：

```
int nLineCounter = 0;
while (getline(nFile, nText))
{
    aFile[nLineCounter] = nText;
    nLineCounter++;
} 
```

但是，如果您要使用标准容器（您应该这样做），您可以[从文件中读取行，而根本没有循环](https://stackoverflow.com/a/1731005/150634)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:19:23.900

C 和 C++ 中的索引是**从零开始的**，所以你的计数器从 0 开始，然后到 1 小于最大值

* * *

也就是说，考虑使用 a`std::vector`而不是原始数组。然后就可以使用的`push_back`方法了`std::vector`。这样您就可以更轻松地存储任意数量的行，而不仅仅是 100 行。

* * *

当前代码还存在一些其他问题，但是当您修复技术问题时，您可能会发现并修复所有这些问题……;-)

# magento - 在产品详细信息页面上调用产品模型覆盖默认产品

> ID：14792215
> 
> 赞同：0
> 
> 时间：2013-02-09T22:16:22.927
> 
> 标签：magento

我被困在这里。客户希望在产品详细信息页面（在产品加售部分）上随机显示产品。出于多种原因，我选择不使用内置的追加销售功能，但无需讨论。

我目前正在展示一个随机产品，如下所示：

```
<?php

    $category = Mage::getModel('catalog/category')->load(9);
    $products = Mage::getModel('catalog/product')
        ->getCollection()
        ->addCategoryFilter($category)
        ->load();

    foreach ($products as $product) {
        $result[$product->getId()] = $product;
    }

    $_product = Mage::getModel('catalog/product')->load(array_rand($result, 1));

?>

<a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_product->getName(); ?>">

    <img src="<?php echo $this->helper('catalog/image')->init($_product, 'thumbnail')->resize(190); ?>" />

    <?php echo $_product->getName(); ?><br />
    <?php echo Mage::helper('core')->currency($_product->getPrice()); ?>

</a> 
```

问题是通过调用 Mage::getModel('catalog/product')，我相信当前产品正在被覆盖。例如，当我单击“添加到购物车”按钮时，我的自定义特色加售产品将被添加到购物车，而不是产品详细信息页面中的实际产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:13:05.103

原因是因为您覆盖`$_product`了默认模板使用的变量。使用你自己的变量名，你会没事的

```
$_myProduct = Mage::getModel('catalog/product')->load(array_rand($result, 1)); 
```

# php - PHP获取月份日期并放入数组

> ID：14792217
> 
> 赞同：0
> 
> 时间：2013-02-09T22:16:29.087
> 
> 标签：php, arrays, date, datetime, days

今天我发现了这个函数，它显示一个月有多少天`cal_days_in_month()`。但我想要做的是把所有的日子都列进数组中，像这样。

```
$days = array(
"2012-11-01","2012-12-01","2012-13-01"...etc
) 
```

有人能指出我正确的方向吗？

亲切的问候弗兰克！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:20:42.060

```
$start    = new DateTime('first day of this month');
$end      = new DateTime('first day of next month');
$interval = DateInterval::createFromDateString('1 day');
$period   = new DatePeriod($start, $interval, $end);

foreach ($period as $dt)
{
  echo $dt->format("l Y-m-d") . PHP_EOL;
} 
```

[看到它在行动](http://codepad.viper-7.com/3PHKgc)

**参考**

*   [约会时间](http://www.php.net/manual/en/class.datetime.php)
*   [日期期间](http://www.php.net/manual/en/class.dateperiod.php)
*   [日期间隔](http://www.php.net/manual/en/class.dateinterval.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T06:52:49.680

```
 $fromdate=strtotime(date("Y-m-d",mktime(0, 0, 0, $month, '01', $year)));
    $todate=strtotime(date("Y-m-t",mktime(0, 0, 0, $month, '01', $year)));

        for($i=$fromdate;$i<=$todate;$i++)
        {
        $i=$i+84600;
        echo     $nextdate[]=date('Y-m-d',$i);
        } 
```

# .htaccess - ModRewrite 转义特殊字符

> ID：14792219
> 
> 赞同：0
> 
> 时间：2013-02-09T22:16:38.300
> 
> 标签：.htaccess, mod-rewrite

出于某种原因，我有一些指向我的域的链接：`http://www.domain.com/$!`

我想 301 将它们重定向到根域。

我试过了：

```
RewriteRule ^\$\!$ / [L.R=301] 
```

但收到 500 错误。关于如何正确转义这些字符的任何想法？

# php - 以 php 变量作为参数的 echo javascript 函数

> ID：14792224
> 
> 赞同：-2
> 
> 时间：2013-02-09T22:17:58.950
> 
> 标签：php, javascript

在 test.php 中：

```
<?php
$result = "test";
echo '<script type="text/javascript">parent.showThanksDiv(\"<?php echo $result;?>\");</script>';
?> 
```

并在 test.html

```
 <script type="text/javascript">
 function showThanksDiv(text){
      document.getElementById("myThanksDivtext").value = text;
    }
</script> 
```

那是行不通的。它接缝我没有正确传递 php 变量。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:19:27.490

我猜你想做这样的事情：

```
<?php
$result = "test";
echo '<script>parent.showThanksDiv("' . $result . '");</script>';
?> 
```

或者为了更安全，我建议使用`json_encode()`：

```
echo '<script>parent.showThanksDiv(' . json_encode($result) . ');</script>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:19:55.870

将 PHP 更改为：

```
<?php
$result = "test";
echo '<script type="text/javascript">parent.showThanksDiv("' . $result . '");</script>';
?> 
```

您不需要将 PHP 变量包装在其中`<?php`，`?>`因为您仍在 PHP 中。

# python - open() 语法错误

> ID：14792226
> 
> 赞同：0
> 
> 时间：2013-02-09T22:18:08.197
> 
> 标签：python

我收到运行时错误；当我删除“try except”时，它在行 tagstats = open("rramtag256.txt", 'r') 的第一个字母处显示无效语法

我的 rramtag256.txt 肯定有正在搜索的字符串

```
import sys
import os
import string

    tagstats = open("rramtag256.txt", 'r')
    list=[]
    for line in tagstats:
            if "Tag array:  Total dynamic read energy/access" in line:
                    s=line.split()
                    print s[0]
                    x=1
            if 'Area Components:' in line:
                    if 'Total leakage read/write power of a bank' in list:
                            s=list.split()
                            print s[0]
            if x==1:
                    list.append(line)

    tagstats.close() 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:23:59.040

Python 使用前导空格来确定哪些代码行放在一起。在您的情况下，您在主块中有零前导空格（导入语句）和 4 个空格（从错误提到的行开始）的代码。

空格需要保持一致，因此您需要将所有以`tagstats = open...`

# python - 主要因素实施

> ID：14792228
> 
> 赞同：0
> 
> 时间：2013-02-09T22:18:25.273
> 
> 标签：python

下面我附上了我的素数分解代码，它可以工作。我只是想知道是否有任何方法可以使输出更清晰。我将主要因素添加到列表中，但递归结束时的最终列表包含列表列表，但我只想要一个带有数字的列表。

```
def prime_factor(n):
    list = [] 
    if prime(n)==1:
        list.append(n)
        return list
    else:
        for i in range(2,n):
            if n %i ==0:
                a =prime_factor(i)
                b = prime_factor(n/i)
                list.extend(a)
                list.extend(b)
                return list

def prime(n):
    if n ==2 or n==3:
        return 1
    if n==1:
        return 0
    for i in range(2,n):
        if n%i ==0:
            return 0
            break
        if i ==n-1:
            return 1
            break 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:02:47.473

您可以更轻松地获得主要因素：

```
def factorize(n):
    factors = []

    p = 2
    while True:
        while(n % p == 0 and n > 0): #while we can divide by smaller number, do so
            factors.append(p)
            n = n / p
        p += 1  #p is not necessary prime, but n%p == 0 only for prime numbers
        if p > n / p:
            break
    if n > 1:
        factors.append(n)
    return factors

print factorize(32*9*11*13*13) 
```

印刷

[2、2、2、2、2、3、3、11、13、13]

您的解决方案可以改进为：

```
def prime_factor(n):
    list = [] 
    if n==1:
        return [1] #or []?
    else:
        for i in range(2,n+1): #additional improvement could be made here
            if n %i ==0:
                b = prime_factor(n/i)
                list.append(i) #i is always prime in here, you return once first i is found
                list.extend(b)
                return list 
```

（你`def prime(n):`把我弄糊涂了，没必要）

# d3.js - 描述“实时”数据 D3 的过渡线/路径

> ID：14792230
> 
> 赞同：1
> 
> 时间：2013-02-09T22:18:48.410
> 
> 标签：d3.js

继上一篇文章之后：

带有模拟数据的“实时”图[d3.js。](https://stackoverflow.com/questions/14664496/live-graph-d3-js-with-simulated-data)

我每隔 1 分钟从数据库中提取数据。json 数组正在使用新的“实时”数据进行更新，但是当 x 和 y 轴都在更新行/路径时不是吗？

[https://gist.github.com/Majella/5fc4cd5f41a6ddf2df23](https://gist.github.com/Majella/5fc4cd5f41a6ddf2df23)

我不知道为什么会这样 - 任何人都可以帮忙吗？

PS - 尝试将 data.push() 和 data.shift() 添加到“SetInterval”函数以允许新数据 - 似乎没有任何区别 - 并且轴被压缩并且难以读取为新数据添加的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T02:44:31.030

您提到轴正在压缩。这表明您的数据不断被添加到 MySQL 表中，但是当您运行查询时，您将***所有***时间值都提取出来。

我能否建议您在 MySQL 查询中包含一行，仅在您想要显示的时间长度内提取数量数据。

例如，如果您想显示 60 分钟的数据，只需选择最后一小时的结果，并使用类似这样的适当“WHERE”语句......

```
SELECT dateTimeTaken, reading FROM TestSourceSampleData 
WHERE dateTimeTaken BETWEEN NOW()-INTERVAL 1 HOUR AND NOW()
GROUP BY dateTimeTaken 
```

（该查询未经测试）

您可能想尝试的另一件事是使用 d3.js 的 v3（`d3.v3.js`在您的 html 文件的第 14 行）。这意味着我认为您必须像这样在 d3.json 行中包含错误陷阱；

```
d3.json("getdata.php", function(error, data) { 
```

在第 45 和 131 行。

试试这些想法。

# jquery - jQuery Mobile 的（双）rangeslider 产生两个独立的滑块

> ID：14792232
> 
> 赞同：0
> 
> 时间：2013-02-09T22:18:55.153
> 
> 标签：jquery, jquery-mobile, slider, rangeslider

我在使用 jQuery mobile 创建双范围滑块时遇到了很多麻烦。[当我从jQuery Mobile 文档](http://jquerymobile.com/branches/range/docs/demos/sliders/sliders.html)中实现以下建议的代码时，我只需在彼此下方获得两个单独的滑块。

```
<div data-role="fieldcontain">
    <div data-role="rangeslider" data-mini="true">
        <label for="range-8a">Rangeslider:</label>
        <input type="range" name="range-8a" id="range-8a" min="0" max="100" value="0">
        <label for="range-8b">Rangeslider:</label>
        <input type="range" name="range-8b" id="range-8b" min="0" max="100" value="100">
    </div>
</div> 
```

理想情况下，我希望远离 jQuery UI，因为这将是另一个框架（而且是一个相当大的框架），如果用户还没有缓存它，他们将不得不下载它。我试图让我的应用程序尽可能轻量级。也许我在实施中做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T21:47:40.010

根据您的评论，问题是您使用了错误版本的 jQuery Mobile。rangeslider 是 1.3.0 版本的新功能，目前处于测试阶段。所以，如果你想使用这个新功能，你必须使用那个版本。

# computer-science - 如何理解 ADT（抽象数据类型代数）？

> ID：14792233
> 
> 赞同：1
> 
> 时间：2013-02-09T22:19:02.870
> 
> 标签：computer-science, algebra, abstract-data-type

我正在上 CS 课程，但坦率地说，我不知道讲师在谈论抽象数据类型代数方面的内容。这不是我很容易在网络上找到解决方案的东西，我想也许社区中的某个人会对这个问题有更深入的了解或不了解。

堆：

```
isempty(createstack()) = true
isempty(push(n, s)) = false 
top(push(n, s)) = n 
pop(push(n, s)) = s 
```

队列：

```
isempty(createqueue()) = true
isempty(add(n, q)) = false
front(add(n, q)) = n, if q is empty
front(add(n, q)) = front(q), if q is not empty removefront(add(n, q)) = q,
if q is empty      removefront(add(n, q)) = add(n, removefront(q)),
if q is not empty 
```

符号肯定有点奇怪......上面的实际含义是什么〜我理解队列和堆栈的一般行为是先进先出与先进后出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T16:24:13.253

抽象数据类型可用于*描述*类型的行为必须如何，而无需指定实现。您将类型定义为一组公理或规则，这些公理或规则描述了每时每刻必须满足的条件。[Djikstra](http://en.wikipedia.org/wiki/Djikstra)曾经说过 ADT 是一种非常有用的工具来描述队列的行为……但是，撇开 Djikstra 著名的超批评幽默不谈，我至少可以想到 ADT 的一个实际应用：[断言](http://en.wikipedia.org/wiki/Assertion_%28computing%29)。

断言允许您指定您的类型如何在正式的、可编译的、可运行的语言中工作（与自然语言文档相反）。在[契约式设计中，](http://en.wikipedia.org/wiki/Design_by_contract)它们通常被写成谓词，在源语言或某种形式的元语言中执行方法（通常是对类型的任何操作）之前或之后必须保持。支持断言的框架（例如[CodeContracts](http://research.microsoft.com/en-us/projects/contracts/)对于 .NET) 自动检查每个谓词是否应该成立。这样，如果你自己的代码违反了你的一个断言，你就知道你有一个错误。因此，在某种意义上，它可以被视为一种单元测试形式，不是通过指定测试用例（这将是经验测试方法），而是通过指定您的类型必须适合的前置条件、后置条件和不变量（这将是理论测试方法）。

虽然没有在主流软件开发中使用，但据我所知，（检查断言可能会影响性能）它们可以在测试期间使用。

从纯理论的角度来看，ADT 只是一种抽象，它允许我们推理类型的行为，而不管它们的具体实现如何。如果你喜欢形式主义（就像我一样），没有什么比让开发人员给你一个定理列表更好的了，而不是一个模棱两可的胡说八道来描述他的代码应该做什么。

另一方面，诸如逻辑或函数式编程之类的一些替代编程范式（替代面向对象的替代方案，而不是次要的、不重要的等）在类型构造中大量基于 ADT。一个非常有趣的例子是[Haskell](http://en.wikipedia.org/wiki/Haskell_%28programming_language%29)语言。它为您提供了类型、继承和多态性的全新图景。

# html - 无法使用 #ID 修改 CSS

> ID：14792234
> 
> 赞同：0
> 
> 时间：2013-02-09T22:19:21.107
> 
> 标签：html, css, stylesheet

首先是我目前的菜单的样子。

![在此处输入图像描述](../Images/d28cddc5fe82e62df8796e538d32858e.png)

问题是不应看到 dsasdf div 中的边界线或此背景。

![在此处输入图像描述](../Images/f04999f1844a0b6021f7a0b143e8a50f.png)

我当前的 HTML 代码是：

```
<div id='cr'>
        <div>
            NEWS
            <div id="m_news">dfadf</div>
        </div>
</div> 
```

#cr 的 CSS：

```
 div#cr{

    /*background-color:#1a0f08;*/
    float:right;
    padding:10px;
    width:260px;
    height:100%;
}
div#cr div{
    background-image:url("../img/bg_post.jpg");
    background-position:0px -5px;
    background-repeat:repeat-x;
    border-radius:2px;
    color:#663b20;
    margin-top:5px;
    height:80px;
    padding:8px;
}
div#cr div:hover{
    border:1px solid #bd8100;
    color:#FFF;
} 
```

以及#m_news 的 CSS：

```
div#m_news{
background-image:url("../img/menu/messages.gif");
border:0;
} 
```

问题是**m_news** ID 无法修改之前由#cr 设置的 CSS，即使它更像是一般的页面修改。我曾尝试在 Internet 上搜索此问题的答案，但据我所知，它有时取决于您的 CSS 代码的位置，但我尝试更改顺序，但它也不起作用。

为什么**div#cr div**比**div#m_news**更重要？

另外，不设置ID，如何在最里面的DIV中设置CSS？我是说， ![在此处输入图像描述](../Images/f2d70b48d5c09e7896ecb9458ca10f0a.png)

如何将新的 CSS 设置为**#id1**中的最小框，但不修改另一个大框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:26:19.987

`div#cr div`的优先级高于`div#m_news`。您可以将其更改为`div#cr div#m_news`.

您可以在此页面上阅读有关*特殊性的更多信息：*[了解 CSS 中的样式优先级：特殊性、继承和级联](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)。

您可以看到优先级是这样排列的：

*   元素，伪元素：*0,0,0,1*
*   类，伪类，属性：*0,0,1,0*
*   编号：*0,1,0,0*
*   内联样式：*1,0,0,0*

所以根据这个：

`div#cr div`具有*0,1,0,2*的特异性，而`div#m_news`具有“仅” *0,1,0,1 之一*。

# ios - 界面生成器中 UIView 的边框颜色不起作用？

> ID：14792238
> 
> 赞同：74
> 
> 时间：2013-02-09T22:19:28.160
> 
> 标签：ios, objective-c, swift, cocoa-touch, uiview

我正在尝试通过 IB 设置视图的图层属性。除边框颜色（属性`layer.borderColor`）外，一切正常：

![在此处输入图像描述](../Images/6e86931ece4eb22f109161a58c91c43c.png)

我记得一年前遇到了这个问题，我最终以编程方式解决了这个问题。而且，我仍然可以通过编程方式执行此操作，但我很好奇为什么该`layer.borderColor`属性从不通过界面生成器工作。我不想 import `QuartzCore`，然后仅仅因为这个而编写额外的代码行，这似乎是一种矫枉过正。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-02-21T19:16:24.350

可以这样做，但这不是内置功能。这是因为`Color`User Defined Runtime Attributes 面板中的类型创建了一个`UIColor`，但`layer.borderColor`拥有一个`CGColorRef`类型。不幸的是，没有办法`CGColorRef`在 Interface Builder 中分配类型。

但是，这可以通过代理属性实现。有关此问题的可能解决方案，请参阅[Peter DeWeese 对不同问题的回答。](https://stackoverflow.com/a/17993890/770938)他的回答定义了一个类别，允许通过 Interface Builder 设置代理颜色。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2015-01-16T14:56:06.647

您必须为 CALayer 创建类别：

**CALayer+UIColor.h**

```
#import <QuartzCore/QuartzCore.h>
#import <UIKit/UIKit.h>

@interface CALayer(UIColor)

// This assigns a CGColor to borderColor.
@property(nonatomic, assign) UIColor* borderUIColor;

@end 
```

**CALayer+UIColor.m**

```
#import "CALayer+UIColor.h"

@implementation CALayer(UIColor)

- (void)setBorderUIColor:(UIColor*)color {
    self.borderColor = color.CGColor;
}

- (UIColor*)borderUIColor {
    return [UIColor colorWithCGColor:self.borderColor];
}

@end 
```

然后在**用户定义的运行时属性**中，您可以使用它，如下图所示：

![在此处输入图像描述](../Images/408486f3a046db060c0cb6f95c474492.png)

对于**Swift**，它要简单得多：

```
import QuartzCore

extension CALayer {
    @IBInspectable var borderUIColor: UIColor? {
        get {
            guard let borderColor = borderColor else { return nil }
            return UIColor(cgColor: borderColor)
        }

        set {
            borderColor = newValue?.cgColor
        }
    }
} 
```

然后在 Xcode 中你可以像这样使用它：

![在此处输入图像描述](../Images/5b6f948d97b11bcc9067260d427cffe5.png)

一旦你选择了某事，它就会自动添加到你的**运行时属性**中：

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-08-20T15:44:12.297

复制并粘贴此类：

```
import UIKit

@IBDesignable class BorderView : UIView {
    @IBInspectable var borderColor: UIColor = .clear {
        didSet {
        layer.borderColor = borderColor.cgColor
        }
    }

    @IBInspectable var borderWidth: CGFloat = 0 {
        didSet {
            layer.borderWidth = borderWidth
        }
    }

    @IBInspectable var cornerRadius: CGFloat = 0 {
        didSet {
            layer.cornerRadius = cornerRadius
        }
    }
} 
```

现在在 Interface Builder 中，转到 Identity 检查器并将您的视图设置为 CustomView 类。

之后，检查您的属性检查器：

[![带有新 IBInspectable 选项的属性检查器](../Images/46b0534ebc9ef2a36d11b9b558b98242.png)](https://i.stack.imgur.com/O2ICM.png)

不再需要弄乱用户定义的运行时属性。您的更改也将显示在画布上！

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-05-18T19:43:31.753

将 Bartłomiej Semańczyk 对 Swift 的回答移植到我的两分钱：

在视图控制器中为 CALayer 创建一个扩展：

```
import UIKit

extension CALayer {
    func borderUIColor() -> UIColor? {
        return borderColor != nil ? UIColor(CGColor: borderColor!) : nil
    }

    func setBorderUIColor(color: UIColor) {
        borderColor = color.CGColor
    }
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-02-16T17:32:05.397

使用 IBDesignable 而不是运行时属性更清楚。

将此代码放在任何类中并直接在情节提要上编辑属性。

```
import UIKit

@IBDesignable extension UIView {
    @IBInspectable var borderColor:UIColor? {
        set {
            layer.borderColor = newValue!.CGColor
        }
        get {
            if let color = layer.borderColor {
                return UIColor(CGColor:color)
            }
            else {
                return nil
            }
        }
    }
    @IBInspectable var borderWidth:CGFloat {
        set {
            layer.borderWidth = newValue
        }
        get {
            return layer.borderWidth
        }
    }
    @IBInspectable var cornerRadius:CGFloat {
        set {
            layer.cornerRadius = newValue
            clipsToBounds = newValue > 0
        }
        get {
            return layer.cornerRadius
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-16T22:21:16.537

这是克服这个问题的快速方法。类别...

```
@interface UIView (IBAppearance)

@property (nonatomic, strong) UIColor *borderColor;

@end 
```

您不必存储它，它很好，因此您可以稍后查询。重要的是取值并将 UIColor 的 CGColor 分配给图层。

```
#import <objc/runtime.h>

#define BORDER_COLOR_KEYPATH @"borderColor"

@implementation UIView (IBAppearance)

- (void)setBorderColor:(UIColor *)borderColor {
    UIColor *bc = objc_getAssociatedObject(self, BORDER_COLOR_KEYPATH);
    if(bc == borderColor) return;
    else {
        objc_setAssociatedObject(self, BORDER_COLOR_KEYPATH, borderColor, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
        self.layer.borderColor = [borderColor CGColor];
    }
}

- (UIColor *)borderColor {
    return objc_getAssociatedObject(self, BORDER_COLOR_KEYPATH);
}

@end 
```

当然，在 Interface Builder 中，您没有设置值 on `layer.borderColor`，而只是设置 on `borderColor`。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-01-22T22:56:15.860

在 Swift 中，您可以扩展`UIButton`该类并添加一个`@IBInspectable`使您能够从情节提要中选择一种颜色并设置它的颜色（宽度为 1，可以更改）。在视图控制器的末尾添加：

```
extension UIButton{
    @IBInspectable var borderColor: UIColor? {
        get {
            return UIColor(CGColor: layer.borderColor!)
        }
        set {
            layer.borderColor = newValue?.CGColor
            layer.borderWidth = 1
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-11-17T08:33:58.457

为了使 CALayer KVC 兼容属性borderColorFromUIColor，只需实现

```
layer.borderColorFromUIColor=[UIColor red]; 
```

[此链接有遮阳篷](http://ios-blog.co.uk/tutorials/user-defined-runtime-attributes/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-11-16T04:03:10.557

斯威夫特4

```
extension CALayer {

  open override func setValue(_ value: Any?, forKey key: String) {

    /// If key is borderColor, and the value is the type of a UIColor.
     if key == "borderColor" , let color = value as? UIColor {

        /// After converting UIColor to CGColor, call the system method.
        return super.setValue(color.cgColor, forKey: key)
     }

     super.setValue(value, forKey: key)
   }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-07-28T03:45:30.043

我遇到了同样的问题，我通过创建一个自定义按钮类来解决它：

```
class UIButtonWithRoundBorder: UIButton {

required init?(coder aDecoder: NSCoder) {
    super.init(coder: aDecoder)
    self.layer.cornerRadius = 6
    self.layer.borderWidth = 1
    self.layer.borderColor = UIColor.whiteColor().CGColor
    self.clipsToBounds = true
}

} 
```

然后在 IB 中，将类型从“UIButton”更改为“UIButtonWithRoundBorder”。

简单又好用。:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-06T11:06:19.180

`borderColor``borderWidth`除非图层的属性设置为**大于 0**的值，否则将不起作用。

*斯威夫特 3：*

```
button.layer.borderColor = UIColor.white.cgColor
button.layer.borderWidth = 1.0 // Default value is 0, that's why omitting this line will not make the border color show. 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-10T08:32:04.333

我认为这可能是因为您将 maskToBounds 设置为 YES。我不认为边界是在图层的边界内绘制的，所以它不会被绘制，因为你将所有东西都隐藏在它的边界之外。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-08T10:48:10.280

**在用户定义的运行时属性**中试试这个：

1.  关键路径：`layer.borderUIColor`
2.  类型：`Color`
3.  价值：`--you prefered color--`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-25T07:13:24.220

您可以使用 2 种方法自定义边框。第一个是这个。只需单击对象转到身份检查器并设置属性。

[![在此处输入图像描述](../Images/39fea447a94913029aef289641530aa6.png)](https://i.stack.imgur.com/v3lkW.png)

第二个是这个。制作所需对象的 IBOutlet 并将此代码放在视图中确实加载了。

```
@IBOutlet weak var uploadView: UIView!

    override func viewDidLoad() {
        super.viewDidLoad()

        uploadView.layer.cornerRadius = 10
        uploadView.layer.borderWidth = 1.0
        uploadView.layer.borderColor = #colorLiteral(red: 0.08235294118, green: 0.5058823529, blue: 0.9450980392, alpha: 1)
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-09-14T09:33:37.670

您可以在 XIB 中为“borderColor”键设置一个值并使用：

```
extension UIView {

    open override func setValue(_ value: Any?, forKey key: String) {
        guard key == "borderColor", let color = value as? UIColor else {
            super.setValue(value, forKey: key)
            return
        }

        layer.borderColor = color.cgColor
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-07-15T05:49:22.447

Swift 5.2 - Fede Henze 的回答

```
@IBDesignable extension UIView {

@IBInspectable var borderColor:UIColor? {
    set {
        layer.borderColor = newValue!.cgColor
    }
    get {
        if let color = layer.borderColor {
            return UIColor(cgColor:color)
        }
        else {
            return nil
        }
    }
}
@IBInspectable var borderWidth:CGFloat {
    set {
        layer.borderWidth = newValue
    }
    get {
        return layer.borderWidth
    }
}
@IBInspectable var cornerRadius:CGFloat {
    set {
        layer.cornerRadius = newValue
        clipsToBounds = newValue > 0
    }
    get {
        return layer.cornerRadius
    }
}
} 
```

# matlab - 如何在使用 matlab 模拟 gibbs 采样时使用 isempty 函数？

> ID：14792239
> 
> 赞同：0
> 
> 时间：2013-02-09T22:19:30.673
> 
> 标签：matlab, simulation

我对 gibbs 采样算法进行了模拟，以下代码是模拟的一部分：

```
mamodel=@(x)find(ismember(x(:,2:end),[1 0 0 0 0],'rows'))

if ~isempty(a)
    macount=a(mamodel(a),:)
else
    macount=zeros(1,size(a,2))
end

h(i,:)=(macount) 
```

第一行是从模拟结果中找到某一行问题是当这一行不在结果中时，smulation 停止，因为结果是 Empty matrix: 0-by-6 ，我尝试了 isempty 函数并且模拟停止了！！我想让模拟忽略结果并继续下一步

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:33:20.180

据我了解，您的问题`h(i, :) = (macount)`很可能是因为尺寸不一致。

考虑到，`isempty`您要检查的是变量`a`是否为空，但是您正在其中搜索给定的行，然后您会发现自己处于变量`a`不为空但不包含你正在搜索的行，然后你得到一个`Emtpy matrix: 0-by-1`.

因此，如果我对您的问题的理解是正确的，那么如果您仔细检查检查的内容以及检查的时间点，那么您应该没问题。

如果先尝试在矩阵中求结果`a`，然后检查结果是否为空，可以避免空变量问题。在下面的代码中，这是完成的（`~isempty`通过对变量元素数量的测试来改变，但这只是一个微小的改变，至少在这种情况下是这样）：

```
macount = a(mamodel(a), :);
if numel(macount) == 0
    macount = zeros(1, size(a, 2));
end
h(i, :) = macount; 
```

我不知道这是否适合您的模拟，但它应该可以解决尺寸问题。

# python - Python将整数列表作为列添加到CSV

> ID：14792241
> 
> 赞同：1
> 
> 时间：2013-02-09T22:19:51.117
> 
> 标签：python, list, csv

我有 3 个格式的整数列表：

```
a = [1,2,3]
b = [4,5,6]
c = [7,8,9] 
```

我正在尝试以以下格式将这些输入到 CSV 文件中，每个列表中的每个项目占用一行，每个列表占用一个新列：

```
1  4  7
2  5  8
3  6  9 
```

目前我的代码（如下）能够将第一个列表添加到 CSV 中，尽管我无法以我希望的方式添加第二个和第三个列表。

```
with open('Test.csv', 'wb') as f:
    for item in a:
        csv.writer(f).writerow([item]) 
```

给出 CSV 输出：

```
1
2
3 
```

如果我只是使用以下代码将 b 列表添加到同一列，我需要将其插入第二列：

```
for itemB in b:
        csv.writer(f).writerow([itemB]) 
```

给出 CSV 输出：

```
1
2
3
4
5
6 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:21:08.777

`zip(a, b, c)`给你一个行列表：`[(1, 4, 7), (2, 5, 8), (3, 6, 9)]`

```
with open('Test.csv', 'wb') as f:
    w = csv.writer(f)
    for row in zip(a, b, c):
        w.writerow(row) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:47:58.610

这有效：

```
a = [1,2,3]
b = [4,5,6]
c = [7,8,9]

with open('/tmp/test.csv','wb') as out:
    for row in zip(a,b,c):
        csv.writer(out, delimiter=' ').writerow(row) 
```

甚至：

```
with open('/tmp/test.csv','wb') as out:
    csv.writer(out, delimiter=' ').writerows(zip(a,b,c)) 
```

输出：

```
$ cat /tmp/test.csv
1 4 7
2 5 8
3 6 9 
```

# delphi - 如何在 TListView 列上显示排序箭头？

> ID：14792244
> 
> 赞同：6
> 
> 时间：2013-02-09T22:20:06.987
> 
> 标签：delphi, listview, delphi-xe3

Windows 资源管理器有一个箭头，指示列表视图（报表视图样式）的排序依据和方向（ASC 与 DESC）。

`TListView`是否可以在 Delphi中显示这样的排序指示箭头？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-09T22:37:16.910

这是一些将标题列标记为升序排序的简单代码：

```
uses
  Winapi.CommCtrl;

var
  Header: HWND;
  Item: THDItem;
begin
  Header := ListView_GetHeader(ListView1.Handle);
  ZeroMemory(@Item, SizeOf(Item));
  Item.Mask := HDI_FORMAT;
  Header_GetItem(Header, 0, Item);
  Item.fmt := Item.fmt and not (HDF_SORTUP or HDF_SORTDOWN);//remove both flags
  Item.fmt := Item.fmt or HDF_SORTUP;//include the sort ascending flag
  Header_SetItem(Header, 0, Item);
end; 
```

为了简单起见，我省略了错误检查。如果你想要相反方向的箭头，我相信你可以弄清楚如何交换逻辑。

MSDN 的关键主题是[`HDITEM`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775247.aspx)结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-16T02:48:52.127

您可以轻松地扩展此代码，使其适用于 ListView 中的所有列；声明两个变量（在表单的私有部分）：

ColumnToSort：整数；升序：布尔值；

在 FormCreate 过程中用 0 和 True 初始化它们。

```
procedure TForm1.ListView1ColumnClick(Sender: TObject; Column: ListColumn);
var
  Header: HWND;
  Item: THDItem;
begin
  Header := ListView_GetHeader(ListView1.Handle);
  ZeroMemory(@Item, SizeOf(Item));
  Item.Mask := HDI_FORMAT;

  // Clear the previous arrow
  Header_GetItem(Header, ColumnToSort, Item);
  Item.fmt := Item.fmt and not (HDF_SORTUP or HDF_SORTDOWN);//remove both flags
  Header_SetItem(Header, ColumnToSort, Item);

  if Column.Index = ColumnToSort then
    Ascending := not Ascending
  else
    ColumnToSort := Column.Index;

  // Get the new column
  Header_GetItem(Header, ColumnToSort, Item);
  Item.fmt := Item.fmt and not (HDF_SORTUP or HDF_SORTDOWN);//remove both flags

  if Ascending then
    Item.fmt := Item.fmt or HDF_SORTUP//include the sort ascending flag
  else
    Item.fmt := Item.fmt or HDF_SORTDOWN;//include the sort descending flag
  Header_SetItem(Header, ColumnToSort, Item);

  with ListView1 do
    begin
      Items.BeginUpdate;
      AlphaSort;
      Items.EndUpdate;
    end;
end; 
```

当然，您必须为列的实际排序提供自己的 OnCompare 函数。此代码仅在单击的列标题中显示排序箭头。

# python - 渲染管理静态文件 - DJANGO

> ID：14792245
> 
> 赞同：0
> 
> 时间：2013-02-09T22:20:09.950
> 
> 标签：python, django, macos, django-admin

我是 Django 新手，管理区域的 css 没有呈现。首先，我创建了一个加载了管理模块的应用程序，这就是我所做的：

通过将调试模式更改为 false 并添加数据库凭据来配置 setting.py。然后：

```
manage.py syncdb

Creating tables ...
Installing custom SQL ...
Installing indexes ...
Installed 0 object(s) from 0 fixture(s) 
```

-

```
manage.py collectstatic

You have requested to collect static files at the destination
location as specified in your settings.

This will overwrite existing files!
Are you sure you want to do this?

Type 'yes' to continue, or 'no' to cancel: yes
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/base.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/changelists.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/dashboard.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/forms.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/ie.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/login.css'
Copying '/Library/Python/2.7/site-packages/django/contrib/admin/static/admin/css/rtl.css' 
```

(...)

当我启动服务器时我得到了什么

```
Development server is running at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
[09/Feb/2013 13:57:53] "GET /admin/ HTTP/1.1" 200 3270
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 85, in run
  File "/Library/Python/2.7/site-packages/django/core/handlers/wsgi.py", line 241, in __call__
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 85, in run
  File "/Library/Python/2.7/site-packages/django/core/handlers/wsgi.py", line 241, in __call__
    response = self.get_response(request)
    response = self.get_response(request)
  File "/Library/Python/2.7/site-packages/django/core/handlers/base.py", line 153, in get_response
  File "/Library/Python/2.7/site-packages/django/core/handlers/base.py", line 153, in get_response
    response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
  File "/Library/Python/2.7/site-packages/django/core/handlers/base.py", line 228, in handle_uncaught_exception
    response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
  File "/Library/Python/2.7/site-packages/django/core/handlers/base.py", line 228, in handle_uncaught_exception
    return callback(request, **param_dict) 
```

主页给出“发生服务器错误。请联系管理员。”，我可以访问 site.com/admin/ 但没有 css。项目文件夹如下所示：

```
--project
----manage.py
----admin
-------css
-------img
-------js
----project
-------setting.py
-------urls.py
-------wsgi.py
-------__init__.py 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:34:48.773

首先，如果您正在运行开发服务器（带有`python manage.py runserver`），那么您应该将您的`DEBUG`设置为 true。此外，您的`STATIC_ROOT`设置似乎尚未设置（或设置为项目的根目录 - 当您在生产中运行应用程序时，这不是您想要的）。

在您的 settings.py 文件中，您需要确保您已`django.contrib.staticfiles`包含在`INSTALLED_APPS`设置中。然后确保你已经定义了 STATIC_URL （我认为它应该默认为`/static/`）。假设您在 django 的开发服务器上使用 django 1.4，那么一切都应该可以正常工作而无需运行`collectstatic`.

查看有关[提供静态文件](https://docs.djangoproject.com/en/1.4/howto/static-files/)的文档。值得注意的是，在生产服务器上提供静态文件的过程是不同的。

# java - 使用线程中断 jFrame 类中的递归函数

> ID：14792247
> 
> 赞同：0
> 
> 时间：2013-02-09T22:20:20.783
> 
> 标签：java, multithreading, jform

我目前有一个 jFrame 窗口，其中一个按钮执行一个耗时的递归函数。

我想要的是，当我单击窗口的另一个按钮时，程序会停止执行该功能。

这是我的代码：

```
 public class CrawlerInterface extends javax.swing.JFrame 
 {
       public CrawlerInterface() 
       {
           initComponents();
       }

    private void playButtonActionPerformed(java.awt.event.ActionEvent evt) 
    {

       playButton.setEnabled(false);
       stopButton.setEnabled(true);

       Crawler.crawl("http://www.mywebsite.com", "site"); //That's the one to interrupt
    }

    private void stopButtonActionPerformed(java.awt.event.ActionEvent evt) 
    {
       stopButton.setEnabled(false);
       playButton.setEnabled(true);

       //Interrupt crawl function here!
    }
    [...]
 } 
```

如何使用线程修改上述代码？如果有不使用线程的方法，请告诉我！

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:23:00.013

如果您在后台线程中运行代码（只要它不接触任何 UI 组件就可以了），您可以`interrupt`使用该线程。或者设置一个布尔变量作为停止递归的基本条件。即一旦你进入方法并且设置了变量然后停止递归。
这是一个开始的示例

```
private static volatile boolean stop = false;  

public static void stop(){  
   stop = true;  
}  

public void Crawler.crawl(String url, String word){  
    if(stop) return;
    else{ ... //recurce}  
}  

private void playButtonActionPerformed(java.awt.event.ActionEvent evt) 
{

       playButton.setEnabled(false);
       stopButton.setEnabled(true);

       Thread t = new Thread(new Runnable(){  
              @Override  
              public void run(){  
                    Crawler.crawl("http://www.mywebsite.com", "site"); //That's the one to interrupt  
               }  
        });  
        t.start();  
}  

 private void stopButtonActionPerformed(java.awt.event.ActionEvent evt) 
    {
       stopButton.setEnabled(false);
       playButton.setEnabled(true);

       Crawler.stop();  //or you could keep reference to t and call interrupt
    } 
```

# java - 为什么对非整数值使用模会失去浮点精度？

> ID：14792253
> 
> 赞同：1
> 
> 时间：2013-02-09T22:21:03.093
> 
> 标签：java, modulo, floating-point-precision

我想知道为什么在使用此代码时会丢失精度：

```
double x = 12.0456;    // or float : same result
System.out.println(x); // outputs 12.0456 obviously
x %= 1;                // should now be equal to 0.0456 right?
System.out.println(x); // outputs 0.04560000000000031 or 0.045599937 when using float 
```

12.0456 模 1 应该等于 0.0456 对吗？但是它显示的值略有不同，为什么我一直在丢失精度？我的意思是代码应该正好减去 1，直到值小于 1。

但是，我找到了一种获得正确值的方法：

```
double x = 12.0456;
System.out.println(x);
x %= 1;
System.out.println((float)x); //outputs 0.0456 exactly 
```

这种方式效果很好，但是你们有更好的解决方案吗？

**我不在乎我应该使用哪种浮点类型，我只想找到一种干净的方法来获得正确的值！**我不喜欢将值转换为双精度然后再转换为浮点数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:59:34.813

Float 和 double 是不精确的 - 它们具有有限数量的位来表示一个值。

因为人类使用以 10 为底，而计算机使用以 2 为底，所以对我们来说看起来“简单”的数字可能无法准确地表示为浮点数/双精度数，尤其是由于 CPU 执行方式而导致的计算结果。

# c++ - 将终端的输入/输出重定向到 iOS JB 中的 gui

> ID：14792256
> 
> 赞同：0
> 
> 时间：2013-02-09T22:21:11.040
> 
> 标签：c++, ios, objective-c, user-interface, compiler-construction

我正在编写一个 GUI C/C++ 编辑器，它还使用 Cydia 附带的 GNU 编译器为 iOS 平台编译源文件。

这将是一个 Cydia 应用程序，所以一切都应该工作。

要编译文件，我需要运行终端命令行，并且我正在考虑使用函数“system()”，因为我想不出其他任何东西。

我现在正在寻找一种方法，以某种方式将终端的输出和输入重定向到 GUI，但我真的不知道从哪里开始。

我读到我可能可以使用管道来做到这一点，但它并没有真正做我需要的事情，因为我需要终端的“实时”输入和输出，而不是`.txt`只有终端输出的文件......

希望有人能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:34:47.897

当然。使用`popen()`. 像这样的东西：

```
const char *cmd = [NSString stringWithFormat:@"gcc -o %1$@.o %1$@.c", sourceFileName].UTF8String;

FILE *p = popen(cmd, "r");
size_t sz;
char buf[1024];

while ((sz = fread(buf, sizeof(buf), 1, p) != 0) {
    NSString *s = [[NSString alloc] initWithBytes:buf length:sz encoding:NSUTF8StringEncoding];
    textView.text = [textView.text stringByAppendingString:s];
    [s release];
}

pclose(p); 
```

# java - 如何调用也是aWeakReference的对象的构造函数

> ID：14792257
> 
> 赞同：1
> 
> 时间：2013-02-09T22:21:13.683
> 
> 标签：java, weak-references

所以我有这个：

```
 private WeakReference<ViewThread> mThread; 
```

我想调用`ViewThread`, like的构造函数`new ViewThread(this)` 并将结果实例分配给`mThread`;

但是无论我尝试什么，它都会给我编译错误，因为它无法将类型 `ViewThread`与类型调和`WeakReference` 我想要做的可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:22:59.300

你需要，

```
mThread = new WeakReference<ViewThread>(new ViewThread(this)); 
```

# javascript - 自定义网络字体提供程序

> ID：14792258
> 
> 赞同：0
> 
> 时间：2013-02-09T22:21:16.013
> 
> 标签：javascript, css, webfont-loader

我想在我自己的服务器上使用谷歌的网络字体加载器和我自己的自定义字体。

[对于如何](https://developers.google.com/webfonts/docs/webfont_loader)按照谷歌自己的文档中的描述配置我自己的***网络字体提供程序***，我有点困惑：

```
In addition to the google, typekit, ascender and monotype options, 
there is also a custom module that can load a stylesheet
from any web-font provider.

WebFontConfig = {
  custom: { families: ['OneFont', 'AnotherFont'],
    urls: [ 'http://myotherwebfontprovider.com/stylesheet1.css',
      'http://yetanotherwebfontprovider.com/stylesheet2.css' ] }
}; 
```

为了使用这个库，我的外部 css 应该包含什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:30:55.910

看看@font-face kits，像 font squirrel 这样的地方是一个不错的起点。您可以将各种文件格式（如 woff、svg 等）保存到字体文件夹中，将@font face kit 提供的 css 添加到您自己的样式表中，然后尽快将其与其余 CSS 一起在您的脑海中调用当您阅读网站上的文档时，它会很有意义，任何进一步的帮助都可以随时询问

# three.js - 有人有 BSP 的例子吗？

> ID：14792262
> 
> 赞同：4
> 
> 时间：2013-02-09T22:21:33.667
> 
> 标签：three.js, bsp

有没有人可以分享或了解在 ThreeJS 中使用 BSP 树的示例？我正在考虑创建一个地形喷溅示例，并希望使用 BSP（或者可能是八叉树...？）来帮助加快渲染速度。

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T01:41:06.883

看看这个八叉树源：[https ://github.com/collinhover/threeoctree](https://github.com/collinhover/threeoctree)

编辑：现在有几个 three.js 示例：

[http://threejs.org/examples/webgl_octree.html](http://threejs.org/examples/webgl_octree.html)

[http://threejs.org/examples/webgl_octree_raycasting.html](http://threejs.org/examples/webgl_octree_raycasting.html)

三.js r.60

# java - 从哪里调用 ArrayList 中的元素更有效？

> ID：14792267
> 
> 赞同：0
> 
> 时间：2013-02-09T22:22:05.017
> 
> 标签：java

`deal`我正在制作一个甲板类，通过使用 ArrayList 来保存多张卡片（我制作的另一个类）但是，当我的老师提到返回顶部卡片的方法时，我无法弄清楚我的老师的意思是什么甲板：

> 请记住，由于 ArrayList 的设计，您可以发牌中的顶牌、底牌或任何牌。想想哪一个是最有效的实现。

我一直认为从任何数组类型结构的前面调用元素都是有效的。ArrayList 是这种情况吗？

常规数组和链表呢？

* * *

我打算把它放在`homework`标签下，但它给了我一个说明它已经过时的描述。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:33:20.487

当您发牌时，您是从牌组中取出一张牌，这与仅访问该牌不同。访问卡将是恒定的时间，但移除不是。从 中删除时`ArrayList`，您需要重新排列列表中的所有元素。考虑这个`remove`方法的实现（来自 OpenJDK）

```
public E remove(int index) {
   rangeCheck(index);
   modCount++;
   E oldValue = elementData(index);
   int numMoved = size - index - 1;
   if (numMoved > 0)
          System.arraycopy(elementData, index+1, elementData, index, numMoved);
   elementData[--size] = null; // Let gc do its work
   return oldValue;
} 
```

因此，如果移动列表前面的元素，它必须移动整个数组。

现在在一个`LinkedList`实现中，每个节点只维护一个指向下一个节点的指针，所以删除很简单，它只是改变了前一个节点的链接。`remove`考虑in 的这个实现`LinkedList`（同样来自 OpenJDK）：

```
private E remove(Entry<E> e) {
       if (e == header)
           throw new NoSuchElementException();
       E result = e.element;
       e.previous.next = e.next;
       e.next.previous = e.previous;
       e.next = e.previous = null;
       e.element = null;
       size--;
       modCount++;
       return result;
} 
```

这并不是说`LinkedList`s 在任何情况下都更好。如果需要访问数组的随机索引，an`ArrayList`通常效率更高（a`LinkedList`需要从头到尾遍历每个节点，直到找到该索引）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:34:12.577

如果您的类中没有特别介绍，那么您想阅读类和方法的 Java 文档。

特别是，当你从牌堆中“发”一张牌时，你就是在移除它。阅读[ArrayList.remove(index) 的 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#remove%28int%29)发现：

> 移除此列表中指定位置的元素。**将任何后续元素向左移动（从它们的索引中减去 1）**。

考虑如何根据`ArrayList`您“发牌”的位置来应用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:33:36.620

ArrayList 只是一个数组，在里面。所以访问任何项目都是 O(1)。但是，删除东西是另一回事。如果“交易”是指“将其从列表中删除”，稍微思考一下就会发现，从 ArrayList 中的一个位置删除它很便宜，而在其他地方则很昂贵。因此，如果您必须有效地处理从任何地方删除，您可能不想使用 ArrayList。

# vim - 如何加载自定义 .vimrc 文件，但保留初始化序列的其余部分？

> ID：14792268
> 
> 赞同：1
> 
> 时间：2013-02-09T22:22:15.903
> 
> 标签：vim

我愿意`vim -u ~/.my_custom_vimrc some_file`。.my_custom_vimrc 的第一行是：`call pathogen#infect()`. 我收到以下错误：

```
Error detected while processing .my_custom_vimrc:
line    1:
E117: Unknown function: pathogen#infect 
```

vim 手册`:h -u`说：

> -u {vimrc} 读取文件 {vimrc} 进行初始化。大多数其他初始化被跳过......

我假设未加载定义病原体的插件。如果我将 .my_custom_vimrc 重命名为 .vimrc，错误就会消失。这就是我真正想要的：几个 .vimrc 文件，这样我就可以决定使用哪一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T20:00:39.157

我相信关键是在文档中[`:h -u`](http://vimdoc.sourceforge.net/htmldoc/starting.html#-u)，接近尾声：

> 使用“-u”参数的副作用是默认情况下会启用“兼容”选项。

我的猜测是，由于`pathogen#infect()`使用了绝对与*vi不兼容的**自动加载*功能，因此函数调用失败。或者，该目录甚至不被视为兼容模式。无论根本原因是什么，在使用插件时，兼容模式绝对不是您想要的。*`.vim`*

 *`-N`解决方案是使用标志强制不兼容模式：

```
vim -Nu ~/.myvimrc myfile 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T14:25:12.300

为此，您可以使用自己的变量启动 VIM，然后`.vimrc`根据该变量获取不同的文件。

在您的`.vimrc`（显示一些不同的使用方式）中：

```
"# this is _not_ an error if env. variable 'what_to_do' isn't used
let WhatToDo = $what_to_do

if WhatToDo == "this"
  "# Use 'source'
  source $HOME/.vim/.vimrc_this
  "# This should not do 'common stuff'
  finish

elseif WhatToDo == "that"
  "# ...or use 'runtime', finds and sources the first file with the given
  "# name looking in folders in 'runtimepath' (default includes e.g. ~/.vim)
  runtime .vimrc_that

else
  runtime .vimrc_default
endif

"# common stuff... 
```

然后在 Unix 命令行中使用它：

```
$ vim text.txt                  # will use '.vimrc_default'
$ what_to_do=that vim text.txt  # will use '.vimrc_that'
$ # what_to_do is not defined after that line 
```

当在同一行使用 Unix 环境变量作为命令时，该变量仅对该命令有效。**注意！`=`设置 Unix 变量前后不能有空格**。
或者你可以在之前设置它：

```
$ what_to_do=that
$ vim text.txt                  # will use '.vimrc_that'
$ # what_to_do has still the value "that" here 
```

或者在脚本（startvim）中：

```
what=$1
shift
what_to_do=$what vim "$@" 
```

并将其与
`$ startvim that <whatever flags you want> text.txt`

或者最好的方法可能是为每个选项使用一个别名：
`$ alias vim_that='what_to_do=that vim'`然后您可以使用与使用相同的方式使用它`vim`，并使用您想要的标志。例如
`$ vim_that <whatever flags you want> text.txt`

* * *

使用环境变量还有一个替代方法，使用标志**--cmd**

> **--cmd** {command} *--cmd* {command} 将在处理任何 vimrc 文件之前执行。否则，它的作用类似于 -c {command}。您最多可以使用这些命令中的 10 个，独立于“-c”命令。{Vi 无此功能}

并 以
`$ vim --cmd 'let WhatToDo = "that"' text.txt`. _ _ _ _

`$ alias vi_that='vi --cmd "let WhatToDo = \"that\""'`

`if ! exists("WhatToDo") | let WhatToDo = "" | endif``.vimrc``$what_to_do`

您当然可以使用`-c "source the_file_you_want"`并拥有一个空的`.vimrc`，但是在开始序列中的采购可能与在`.vimrc`.

* * *

帮助：
[`:h runtime`](http://vimdoc.sourceforge.net/htmldoc/repeat.html#%3aruntime)
[`:h runtimepath`](http://vimdoc.sourceforge.net/htmldoc/options.html#%27runtimepath%27)
[`:h --cmd`](http://vimdoc.sourceforge.net/htmldoc/starting.html#--cmd)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:25:24.600

您可以使用`-c`它来加载它：

```
vim -c "so ~/.my_custom_vimrc some_file" 
```*

# json - 映射 iOS 的 JSON 输出

> ID：14792270
> 
> 赞同：0
> 
> 时间：2013-02-09T22:22:22.833
> 
> 标签：json, cocoa-touch

我在发帖后得到了这个结果。我不确定这个输出是什么。

a) 这是 JSON 吗？

b）当输出只是一个客户时，输出很好地映射到 NSDictionary 并使用 valueForKeyPath 方法，我能够获取每个元素的详细信息。但是，当有多个客户或客户数组时，我在将输出 id 映射到一个类时遇到问题，我尝试映射到 NSArray、NSDictionary，但没有取得多大成功。我正在使用五方软件 RESTClient ( [https://github.com/FivesquareSoftware/RESTClient](https://github.com/FivesquareSoftware/RESTClient) )。我想使用基本身份验证进行 http GET 或 http POST。如果我使用 SOAP UI，则 REST 服务输出是 JSON 编辑器可读的正确 JSON

试图弄清楚它是什么。

```
{
    InvoiceQueryResponse =     
    {
        ApplicationArea = {
            CreationDateTime = "2013-02-09T10:30:44-08:00";
            Sender = "Mobile";
        };
        DataArea = {
            InvoiceQueryResponseDetails = {
                Customer = {
                    CommunicationInfo = {
                        EmailInfo = {
                            Email = "lol@test.com";
                        };
                        PhoneInfo = {
                            TelPhoneNO = "000-000-0000";
                            TelPhoneRole = "Home";
                        };
                        PostalAddressInfo = {
                            Address = "7000 200TH ST";
                            City = "LONG ISLAND CITY";
                            PostalCD = "11101-1701";
                            StateProvinceCD = NY;
                        };
                    };
                    InvoiceID  = NY201302_G240
                    CustomerID = G765451;
                    CustomerType = BUSINESS;
                    OrganizationNM = "Therapy Center";
                    PreferredLanguage = "";
                    ProductAssociationsInfo = {
                        TotalProductCount = 2;
                        Product = (
                            {
                                Product1 = "Vitamin B";
                                Qty = 20;
                            },
                            {
                                Product2 = "Vitamin C";
                                Qty = 20;
                            },
                        );
                    };
                };
            };
            ServiceFooter = {
                RecordCount = 1;
                Status = "SUCCESS";
                TimeStamp = "2013-02-09T10:30:46-08:00";
            };
        };
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:25:32.710

> 这是 JSON 吗？

不，不是。如果是，键将被引用，键值分隔符将是冒号，如

```
"ApplicationArea": {
    "CreationDateTime": "2013-02-09T10:30:44-08:00";
    "Sender": "Mobile";
}; 
```

# html - 如何在不编辑所有页面的情况下设置具有动态内容的侧边栏？

> ID：14792277
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:23:05.803
> 
> 标签：html, css, dynamic, web

如何在不编辑所有页面的情况下设置具有动态内容的侧边栏？我已经尝试过 iframe，但我无法特别控制 css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:52:59.460

您需要使用 PHP 并有权访问服务器。如果您仍在离线构建站点，则需要使用[xampp 之](http://www.apachefriends.org/en/xampp.html)类的东西设置本地服务器。

要在页面上包含侧边栏，请将此命令插入到您希望侧边栏所在的任何位置：

```
<body>
    ...
    <?php include "mySidebar.php" ?>
    ...
</body> 
```

然后创建一个名为“mySidebar.php”的新文件并为您的侧边栏编写标记。当您加载页面时，您在“mySidebar.php”中编写的所有标记都将替换 php 包含行。确保“mySidebar.php”与使用它的页面位于同一文件夹中，或者如果要将其保存在其他位置，则必须在 php 包含中指定它的路径。

**还要使用 PHP，将所有 .html 文件转换为 .php。

# c++ - 与 get_instance() 分离的单例构造函数

> ID：14792286
> 
> 赞同：1
> 
> 时间：2013-02-09T22:24:32.420
> 
> 标签：c++, design-patterns, constructor, singleton

在典型的单例中，构造函数在第一次调用 getInstance() 时被调用。我需要的是分离 init 和 getInstance 函数。*init 函数必须使用构造*函数创建实例，并且只有在调用了 init 函数时才能使用 getInstance（否则它会引发异常）。我怎样才能做到这一点？

```
 Singleton::init(required argument); //calls constructor
    Singleton::getInstance(); //only possible if init had been called, otherwise throws exception 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:27:04.107

在 init 方法中设置一个表示 init 成功的布尔值。在 getInstance 方法中，如果为 false，则抛出异常。

您可以将其作为静态私有成员存储在类中。

```
#include <iostream>
class Single
{
public:
    static void init(int x)
    {
        single.number = x;
        inited = true;
    }

    static Single & GetInstance()
    {
        //Do exception stuff here....
        if(inited)
        {
            std::cout << "Inited" << std::endl;
        }
        else
        {
            std::cout << "NOT Inited" << std::endl;
        }
        return single;
    }

    void printTest()
    {
    std::cout << single.number << std::endl;
    }

private:
    Single() : number(5)
    {
        std::cout << "Construction " << std::endl;
    }

    int number;
    static bool inited;
    static Single single;
};

bool Single::inited = false;
Single Single::single;

int main()
{
    std::cout << "Entering main" << std::endl;

    Single::GetInstance();
    Single::init(1);
    Single::GetInstance().printTest();

} 
```

程序输出：

```
Construction 
Entering main
NOT Inited
Inited
1 
```

# html - 两个 div 并排：第一个固定宽度，第二个拉伸以适应

> ID：14792288
> 
> 赞同：2
> 
> 时间：2013-02-09T22:24:39.907
> 
> 标签：html, css

我想创建一个`div`并排放置两个 s 的布局。第一个`div`应该尽可能宽，因为它的内容需要它。第二个`div`应该伸展以填充剩余空间。标记将如下所示：

```
<div id="d1">
    <div id="d2">fixed width</div>
    <div id="d3">stretching</div>
</div> 
```

问题是，要么两个`div`s 都和它们的内容一样宽，并且不拉伸以填充整个水平空间，要么（例如，当使用`display: table`on`d1`和`display: table-cell`on`d2`时`d3`）两者都`div`拉伸。

如何固定宽度`d2`并拉伸`d3`以填充剩余空间？请注意，宽度`d2`是未知的，因此我无法以像素为单位指定它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T22:27:54.200

我认为应该这样做：

```
#d1 {
  display: table;
  width: 100%;
}

#d2, #d3 {
  display: table-cell;
  padding: 2px 6px;
}

#d2 {
  white-space: nowrap;
}

#d3 {
  width: 100%;
} 
```

[你可以在这里](http://codepen.io/ByScripts/pen/wGpbn)试试

# iphone - iPhone 如何设置帧速率和减慢 AVCapture didOutputSampleBuffer 委托

> ID：14792290
> 
> 赞同：4
> 
> 时间：2013-02-09T22:24:50.703
> 
> 标签：iphone, objective-c, cocoa-touch, avcapturesession, avcapturedevice

我想降低 iPhone 4S 上视频设备的帧速率，以减少调用 didOutputSampleBuffer 委托的频率。这是为了提高性能，因为我处理每一帧并且需要一个大帧来显示细节。

当我设置我的 AVSession 时，我尝试使用以下方法：

```
AVCaptureConnection *conn = [self.output connectionWithMediaType:AVMediaTypeVideo];
[conn setVideoMinFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)];
[conn setVideoMaxFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)]; 
```

但这没有任何效果，我可以将 CAPTURE_FRAMES_PER_SECOND 从 1 更改为 60，并且看不出性能上的差异或视频捕获速度减慢。为什么这没有效果？如何降低视频设备的捕获帧速率？

我使用以下代码设置了我的会话：

```
// Define the devices and the session and the settings
self.session = [[AVCaptureSession alloc] init];

//self.session.sessionPreset = AVCaptureSessionPresetPhoto;
//self.session.sessionPreset = AVCaptureSessionPresetHigh;
self.session.sessionPreset = AVCaptureSessionPreset1280x720;

self.device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
self.input = [AVCaptureDeviceInput deviceInputWithDevice:self.device error:nil];

// Add the video frame output
self.output = [[AVCaptureVideoDataOutput alloc] init];
[self.output setAlwaysDiscardsLateVideoFrames:YES];
self.output.videoSettings = [NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA]
                                                        forKey:(id)kCVPixelBufferPixelFormatTypeKey];

// A dispatch queue to get frames
dispatch_queue_t queue;
queue = dispatch_queue_create("frame_queue", NULL);

// Setup the frame rate    
AVCaptureConnection *conn = [self.output connectionWithMediaType:AVMediaTypeVideo];
[conn setVideoMinFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)];
[conn setVideoMaxFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)];

// Setup input and output and set the delegate to self
[self.output setSampleBufferDelegate:self queue:queue];
[self.session addInput:self.input];
[self.session addOutput:self.output];

// Start the session
[self.session startRunning]; 
```

我使用下面的“didOutputSampleBuffer”委托实现来捕获帧：

```
// The delegate method where we get our image data frames from
- (void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection
{

    // Extract a UImage
    CVPixelBufferRef pixel_buffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    CIImage *ciImage = [CIImage imageWithCVPixelBuffer:pixel_buffer];

    // Capture the image
    CGImageRef ref = [self.context createCGImage:ciImage fromRect:ciImage.extent];

    // This sets the captured image orientation correctly
    UIImage *image = [UIImage imageWithCGImage:ref scale:1.0 orientation:UIImageOrientationLeft];

    // Release the CGImage
    CGImageRelease(ref);

    // Update the UI on the main thread but throttle the processing
    [self performSelectorOnMainThread:@selector(updateUIWithCapturedImageAndProcessWithImage:) withObject:image waitUntilDone:YES];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:30:06.103

这是部分答案：我相信 iOS 5 和 iOS 6 之间的 Quicktime 视频捕获引擎发生了变化。在 iOS 5 中，可以以 60 FPS 的速度捕获视频，并且有一些应用程序利用了这一点以流畅的慢动作录制回放（例如 SloPro 应用程序）。在 iOS 6 中，使用相同的方法不再可能达到 60 FPS。MacRumors 论坛帖子中对此问题进行了长时间的讨论：

[iPhone 4S、iOS 6.1 越狱后可以录制 60 FPS 视频吗？](http://forums.macrumors.com/showthread.php?t=1533985/ "iPhone 4S、iOS 6.1 越狱后可以录制 60 FPS 视频吗？")

希望您可以在那里找到一些可能为您的问题提供解决方案的信息。我很想知道是否有人可以再次进行这项工作。我怀念以 60 FPS 录制...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T20:50:12.237

我不确定您正在运行什么 iOS，但您的代码如下所示：

```
AVCaptureConnection *conn = [self.output connectionWithMediaType:AVMediaTypeVideo];
if ([conn isVideoMaxFrameDurationSupported] && [conn isVideoMinFrameDurationSupported])
{
  [conn setVideoMinFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)];
  [conn setVideoMaxFrameDuration:CMTimeMake(1, CAPTURE_FRAMES_PER_SECOND)];
}

else
  NSLog(@"Setting Max and/or Min frame duration is unsupported"; 
```

然后从那里去。我怀疑你的 iOS 不支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-13T16:47:56.697

看起来 OP 已经知道如何设置帧速率，但不知道代码为什么不起作用。

在将输入和输出添加到捕获会话之前，不会创建 AVCaptureConnection：[AVCaptureConnection 文档](https://developer.apple.com/documentation/avfoundation/avcaptureconnection?language=objc)。

所以我怀疑'conn'是空的。将“设置帧速率”中的代码移到“设置输入和输出并将委托设置为自身”中的代码之后。

# python - 如何绘制列表的元素？

> ID：14792291
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:24:54.217
> 
> 标签：python, list, plot

我已将雅虎数据导入列表列表，以便每个列表包含每天的所有数据。我想使用列表的第一个条目（日期条目）作为横坐标。我经历了很多例子，很多人使用我不熟悉的字典。我想到了这样的事情：

`chart.plot(data[:][0], data[:][1])`

会工作，但它没有。显然，`data[:][0]`只会给你第一个列表，而不是每个列表的第一个元素。我知道，我可以只列出所有日期的 2 个新列表，然后用 for 循环说股票价格，但这似乎是错误的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:50:01.657

要获取`n`列表中每个列表的元素，您可以使用列表推导：

```
#nth_elements = [l[n] for l in data]
#for example:
x_list = [l[0] for l in data]
y_list = [l[1] for l in data] 
```

现在您可以调用`chart.plot(x_list, y_list)`.

* * *

如果您不喜欢“额外”变量，可以直接在函数调用中使用列表推导：

```
chart.plot([l[0] for l in data], [l[1] for l in data]) 
```

* * *

然而，一个简单的 for 循环在一个循环中执行相同的操作，因此无需在您的`data`列表上循环两次：

```
x_list = []
y_list = []
for l in data:
    x_list.append(l[0])
    y_list.append(l[1]) 
```

即使它不是pythonic，它也可以工作并且是原创的。它根本不应该感到“错误”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:58:08.093

`data[:]`只获取`data`列表中的所有元素。这与`data[1:4]`获取从 1 到 4: 的元素相同`[1, 2, 3]`。

*要为列表的*每个元素做一些事情，你需要使用`for`循环。

```
list1, list2 = [], []
for list in data:
    list1.append(list[0])
    list2.append(list[1]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T00:00:18.350

你对此感兴趣吗？：

```
li = [["GLD","SPDR Gold Trust",
       '161.57','161.47','162.02','161.20','0.00','N/A'],

      ["SLV","iShares Silver Trust",
       '30.29','30.65','25.34','36.44','0.00','N/A'],

      ["GDX","Market Vectors Gold Miners ETF",
       '42.31','42.77','39.08','57.91','0.00','N/A']]

from itertools import izip

for el in zip(*li):
    print el 
```

显示

```
('GLD', 'SLV', 'GDX')
('SPDR Gold Trust', 'iShares Silver Trust', 'Market Vectors Gold Miners ETF')
('161.57', '30.29', '42.31')
('161.47', '30.65', '42.77')
('162.02', '25.34', '39.08')
('161.20', '36.44', '57.91')
('0.00', '0.00', '0.00')
('N/A', 'N/A', 'N/A') 
```

# javascript - div 包装内容或全屏

> ID：14792292
> 
> 赞同：1
> 
> 时间：2013-02-09T22:24:55.533
> 
> 标签：javascript, css

我想知道，有没有办法让 DOM 元素更喜欢 100% 的视口高度和宽度，除非它的内容会溢出视口高度或宽度？

我尝试使用这个咖啡脚本，但结果是一些讨厌的递归

```
resizeHandled = false;
$(window).resize ->
    if(resizeHandled)
        resizeHandled = false;
        return;
    docHeight = $(document).height();
    vpHeight = $(window).height();
    if(docHeight > vpHeight)
        tallestHeight = docHeight;
    else
        tallestHeight = vpHeight;

    $("[data-fullscreen]").height(tallestHeight);
    resizeHandled = true; 
```

我需要这样的东西，所以如果我旋转我的设备并且它上面的另一个 div 的内容溢出视口，全屏谷歌地图不会自行切断。

[http://i.imgur.com/16ohHhV.png](http://i.imgur.com/16ohHhV.png) 这是我现在面临的问题，像谷歌地图一样，将高度与顶部的覆盖 div 匹配，如果容器同时具有地图和叠加层的行为方式与我在这里描述的方式相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:38:45.517

我不熟悉coffeescript，但是使用普通的javascript你可以做这样的事情

```
var resizeHandled = false;

window.onresize = function(){

  // you may want to use document.getElementsByClassName here
  var div = document.getElementsByTagName('div')[0]; 

  if(resizeHandled || (div.clientHeight < document.documentElement.clientHeight)){
    div.style.height = document.documentElement.clientHeight + 'px';
    resizeHandled = true;
  }          
};  

window.onresize(); 
```

[演示](http://jsfiddle.net/Fa25v/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:38:54.440

如果地图上方 div 的文本或图像内容溢出了实际的 div 容器并覆盖了您的 Google 地图，那么您可以尝试将该 div 元素上的 CSS 更改为：

```
overflow-y: hidden; 
```

或者

```
overflow-y: scroll; 
```

# php - 保护除登录页面外的整个网站

> ID：14792293
> 
> 赞同：0
> 
> 时间：2013-02-09T22:24:55.447
> 
> 标签：php, symfony, fosuserbundle

我想通过使用 FOSUserBundle 登录来保护整个站点。我尝试像这样设置 security.yml：

```
 firewalls:
   login:
        pattern: ^/login
        anonymous: ~
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider

   main:
        pattern: ^/ 
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider 
```

但是后来我不知道在 config.yml 中设置什么

```
fos_user:
    db_driver: orm # other valid values are 'mongodb', 'couchdb' and 'propel'
    firewall_name: main
    user_class: My\UserBundle\Entity\User 
```

无论我尝试什么，我都无法登录，或者仍然出现以下错误：

> 您必须在安全防火墙配置中使用 form_login 配置要由防火墙处理的检查路径。

编辑：这里的第二个响应似乎有效： [Symfony 2 - 防火墙和访问控制问题](https://stackoverflow.com/questions/9649527/symfony-2-firewall-and-access-control-issue)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:32:39.677

您的登录防火墙意外需要`login_check`驻留在主防火墙中。除了登录防火墙中的一件事外，您无需更改配置中的任何内容：

```
firewalls:
    login:
        pattern: ^/login$ 
```

如果您没有注意到，末尾有一个 $，它确保只有路径`/login`匹配，但不匹配`/login_check`.

@Patt 建议的 access_control 和更改不是必需的。

# django - 有没有办法更改默认的 Haystack 表单模板？

> ID：14792297
> 
> 赞同：1
> 
> 时间：2013-02-09T22:25:22.290
> 
> 标签：django, django-forms, django-templates

我想更改 Django-haystack 默认表单模板。

默认表单模板就像

```
 <table>
        <tr><th><label for="id_q">Ara:</label></th><td><input type="text" name="q" id="id_q" /></td></tr>
        <tr>
            <td>&nbsp;</td>
            <td>
                <input type="submit" value="Ara">
            </td>
        </tr>
    </table> 
```

当我说`{{form}}`我不想要标签“Ara”以及模板中的一些修改时。但我无法在文件夹 site-packages/haystack 中找到将其删除的位置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T02:11:49.173

您的问题实际上更多是关于表单渲染，而不是 Haystack 特有的任何问题。

您要做的是为此特定表单使用自定义表单模板，或者选择一个新的通用表单模板来呈现表单。这就是我要向您指出的方向，例如[Django-floppyforms](http://django-floppyforms.readthedocs.org/en/latest/)或[crispy-forms](http://django-crispy-forms.readthedocs.org/en/latest/)以获得更好的表单渲染。这些包和[其他几个](https://www.djangopackages.com/grids/g/forms/)包提供了一些更好的默认模板和对表单呈现的更多控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:26:57.610

您不需要使用默认表单。最简单的方法（我倾向于使用）就是在基本模板中定义一个指向您的搜索 url 的纯 html 表单，然后从中继承。

# iphone - 点击按钮时显示图像？

> ID：14792301
> 
> 赞同：0
> 
> 时间：2013-02-09T22:25:39.167
> 
> 标签：iphone, objective-c, uiview, uibutton

我有 3 个按钮代表 3 个不同的图像。只要点击其按钮，就会显示图像。我的问题是，如何使用 if() 和 NSArray/NSMutableDictionary/UIButton 标签或其他方法来缩短代码。

```
- (id)initWithFrame:(CGRect)frame
{
    _button1 = [UIButton buttonWithType:UIButtonTypeCustom];
    _button1.frame = CGRectMake(20, 250, 50, 50);
     [_button1 addTarget:self action:@selector(button1Tapped) forControlEvents:UIControlEventTouchUpInside];
    [self addSubview:_button1];

    _button2 = [UIButton buttonWithType:UIButtonTypeCustom];
    _button2.frame = CGRectMake(140, 250, 50, 50);
    [_button2 addTarget:self action:@selector(button2Tapped) forControlEvents:UIControlEventTouchUpInside];
    [self addSubview:_button2];

    _button3 = [UIButton buttonWithType:UIButtonTypeCustom];
    _button3.frame = CGRectMake(210, 250, 50, 50);
    [_button3 addTarget:self action:@selector(button3Tapped) forControlEvents:UIControlEventTouchUpInside];
    [self addSubview:_button3];
}

- (void)button1Tapped
{ 
    UIImage *_image = [UIImage imageNamed:@"IMAGE_1"];
    _imageView = [[UIImageView alloc] initWithImage:_image];
    _imageView.frame = CGRectMake(0, 0, 256, 384);        
    [self addSubview:_imageView];
}

- (void)button2Tapped
{ 
    UIImage *_image = [UIImage imageNamed:@"IMAGE_2"];
    _imageView = [[UIImageView alloc] initWithImage:_image];
    _imageView.frame = CGRectMake(0, 0, 256, 384);        
    [self addSubview:_imageView];
}

- (void)button3Tapped
{ 
    UIImage *_image = [UIImage imageNamed:@"IMAGE_3"];
    _imageView = [[UIImageView alloc] initWithImage:_image];
    _imageView.frame = CGRectMake(0, 0, 256, 384);        
    [self addSubview:_imageView];
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:48:03.613

像这样设置一组图像。使其成为您班级的财产。此外，也要尽早构建您的图像视图。

```
@property(nonatomic, strong) NSArray *images;
@property(nonatomic, strong) UIImageView *imageView;

- (id)initWithFrame:(CGRect)frame {

    self.images = [NSArray arrayWithObjects:[UIImage imageNamed:@"IMAGE_1"], [UIImage imageNamed:@"IMAGE_2"], [UIImage imageNamed:@"IMAGE_3"], nil];

    _imageView = [[UIImageView alloc] initWithImage:[self.images objectAtIndex:0]];
    _imageView.frame = CGRectMake(0, 0, 256, 384);        
    [self addSubview:_imageView];
} 
```

创建按钮时，给它们这样的标签......

```
_button1.tag = 1;
_button2.tag = 2;
_button3.tag = 3; 
```

此外，在创建按钮时，让它们都使用相同的点击选择器...

```
 [_button1 addTarget:self action:@selector(buttonTapped) forControlEvents:UIControlEventTouchUpInside];
 [_button2 addTarget:self action:@selector(buttonTapped) forControlEvents:UIControlEventTouchUpInside];
// etc 
```

在水龙头上，tag-1 将成为数组索引......

```
- (void)buttonTapped:(id)sender {

    NSUInteger tag = ((UIButton *)sender).tag;
    UIImage *image = [self.images objectAtIndex:tag];
    self.imageView.image = image;
} 
```

# linux - bash 脚本从一个目录中获取文件并将它们与另一个目录进行比较

> ID：14792302
> 
> 赞同：1
> 
> 时间：2013-02-09T22:25:41.217
> 
> 标签：linux, bash, centos, ls

假设我有一个只有文件*（t1.txt、t2.txt、t3.txt）*的 Dir1 我如何才能仅在 bash 脚本中获取文件名列表，该脚本允许我将其与 Dir2 中的另一个文件列表进行比较和在不使用**rSync**的情况下查找丢失的文件

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:29:10.180

`diff -r --brief Dir1 Dir2`

将告诉您两个目录之间的差异，包括一个目录何时包含另一个目录不包含的文件。顺便说一句，它还会告诉您 Dir1 和 Dir2 是否都包含同名的文件，例如*t1.txt*，但内容不同。它不会打印两个目录之间相同的文件。**

# android - Android：如何将图片推送到模拟器内部存储？（不在 SD 卡上）

> ID：14792304
> 
> 赞同：1
> 
> 时间：2013-02-09T22:25:54.160
> 
> 标签：android, android-emulator, push, directory-structure

您好，非常感谢您的帮助！

请我需要将一些图片推送到模拟器的内部存储上，以便可以通过 MediaStore.Images.Media 、 INTERNAL_CONTENT_URI 访问它们。

因此我需要它们在内部存储上，而不是 SD 卡上。

请问如何找到模拟器的正确目录来推送图片？

多谢！！！

# c++ - opengl中的多纹理添加剂混合

> ID：14792309
> 
> 赞同：0
> 
> 时间：2013-02-09T22:26:02.733
> 
> 标签：c++, opengl, alpha, blending

我想要一个具有强烈太阳反射的金属表面在光线下几乎变成白色的效果。它在两遍渲染和第二遍（具有近乎白色的纹理和最高的镜面光）在第一遍（金属）上的添加混合时效果很好。

但是，为了性能，我想切换到 MultiTexturing，但是那里没有加法混合之类的东西，只有

```
glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE);
glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);
glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE,  GL_BLEND);
glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE); 
```

这些都不能用作添加剂混合物。:-(

我的第二个问题：是否有可能让第二个纹理比同一个三角形上的第一个纹理更亮？似乎使用 glMaterial 会覆盖其他纹理的材质。

解决方案可能是一个很好的 glTexEnvi - hack，可以模拟具有强烈光泽的纹理效果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T00:06:36.520

伙计们，我终于为此目的编写了一个着色器！奇怪的是，我最终没有使用加法混合（只是在着色器中改变一条线来实现这一点），而是扩展了这个想法，使第二个纹理成为高光贴图 - 这样它的纹理只有在高光时才能看到光击中它！

大多数效果可以通过以下事实来实现：我自己的着色器可以简单地处理**远高于 1 的镜面反射**值- 邪恶的 OpenGL 会在不询问的情况下将其剪辑为 1 :-(

```
GLfloat mat_specular[] ={ 2, 2, 2, 1 }; glMaterialfv(GL_FRONT, GL_SPECULAR,mat_specular); //works here :-) 
```

顶点着色器：

```
 vs = const_cast<char *>(
     "varying vec4 diffuse, ambient;"
     "varying vec3 normal, lightDir, halfVector;"
     "uniform float time;"
     "void main(void){"
       "normal = normalize(gl_NormalMatrix * gl_Normal);"  //Transform Normal into Eye Space
       "lightDir = normalize(vec3(gl_LightSource[0].position));"
       "halfVector = normalize(gl_LightSource[0].halfVector.xyz);"
       "diffuse = gl_FrontMaterial.diffuse * gl_LightSource[0].diffuse;"
       "ambient = gl_FrontMaterial.ambient * gl_LightSource[0].ambient + gl_FrontMaterial.ambient * gl_LightModel.ambient;"
       "gl_TexCoord[0]  = gl_MultiTexCoord0;"
       "gl_Position = ftransform();"     //Apply Changes
     "}") ; 
```

和片段着色器：

```
fs =const_cast<char *>( 
  "uniform sampler2D tex1;"
  "uniform sampler2D tex2;"      
  "varying vec4 diffuse,ambient;"
  "varying vec3 normal, lightDir, halfVector;"
  "void main() {"
    "vec3 n,halfV,colortexel,colorfragment;"
    "vec4 texel,specularmap;"
    "float NdotL,NdotHV,alphatexel,alphafragment;\n"
    "colorfragment = ambient.rgb;"    //initialize color with ambient part
    "alphafragment = gl_FrontMaterial.diffuse.a;"
    "n = normalize(normal);"   //copy to write
    "NdotL = max(dot(normal, lightDir), -0.1);"
    "specularmap = texture2D(tex2,gl_TexCoord[0].st);"   //MUST Be started first!
    "texel = texture2D(tex1,gl_TexCoord[0].st*2.0);" 

    "if (NdotL>=-0.1) {"
        "colorfragment += diffuse.rgb * NdotL;"
        "halfV = normalize(halfVector);"
        "NdotHV = max (dot(n,halfV),0.0);"
        "colorfragment += gl_FrontMaterial.specular.rgb * specularmap.rgb * gl_LightSource[0].specular.rgb * pow(NdotHV, gl_FrontMaterial.shininess);"            
    "}"         

    "colortexel = texel.rgb; alphatexel = texel.a;"         
    "gl_FragColor = vec4(colortexel * colorfragment, alphatexel * alphafragment);"
    "}"); 
```

它根本没有优化，目前只是一个没有艺术技巧的概念验​​证，但结果如下：

在没有任何着色器的情况下渲染，但在“调制”上使用多纹理。您可以看到容器上有一些污垢，但镜面光很差：

![http://i.stack.imgur.com/8whUC.jpg](../Images/a1f7d9b0bd6be5e35458d82c6d54e36b.png)

使用着色器渲染 - 虽然在这张照片上看不清楚，但污垢在那里。重镜面光，甚至可以通过增加 glMaterialfv 中的镜面值来加强：

![http://i.stack.imgur.com/IpnTa.jpg](../Images/922b008d3de0df4dd97aab870f43887a.png)

以夸张的 4 倍光泽度渲染。您现在可以在辉光中看到污垢纹理：

![http://i.stack.imgur.com/MPAm3.jpg](../Images/a1f7d9b0bd6be5e35458d82c6d54e36b.png)

仍然存在一个问题 - 为什么我不能使用 gl_TexCoord(1) - 结果是没有纹理，而是像素渲染伪影，尽管多纹理在没有着色器的情况下可以正常工作。任何帮助表示赞赏。

# mysql - 删除/替换 SQL 数据库中的所有图像

> ID：14792314
> 
> 赞同：0
> 
> 时间：2013-02-09T22:26:37.400
> 
> 标签：mysql, sql, regex, html-parsing

我有一个包含 400k 个帖子的 mysql 数据库。在 arround 100k 帖子中是图像。例子：

```
text text text <img src="/images/test.jpg"> text text text 
```

`<img src="/images/test.jpg">`必须删除完整的图像字符串。但它并不总是`<img src/images/test.jpg">`有很多变体。所以我不能使用典型的 sql replace 。

我需要的是“两个字符之间的 sql 替换”。对我来说，删除/替换所有`"<img" and ">"` 内容`<img and >`

这还是可能的吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:58:59.427

MySQL 支持正则表达式：

```
UPDATE Mytable SET url = '' WHERE url RLIKE someregex; 
```

见：[http ://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

就像是：

```
UPDATE Mytable SET url = '' WHERE url RLIKE '\\<img.\\>' 
```

**但请注意**，MySQL 不支持正则表达式错位字符串的输出。它只会比较。

但是，有一个 MySQL 用户函数 REGEX_REPLACE，请参阅：[https](https://launchpad.net/mysql-udf-regexp)
://launchpad.net/mysql-udf-regexp 另请参阅此问题：[如何在 MySQL / 正则表达式替换器中计算单词？](https://stackoverflow.com/questions/1755408/mysql-regex-replace)

# php - 在 Windows 服务器上的 PHP 5.3.14（Apache2.2 版本）上安装 mbstring/libmbfl

> ID：14792315
> 
> 赞同：1
> 
> 时间：2013-02-09T22:26:54.160
> 
> 标签：php, apache2.2, mbstring

我想在我的开发环境中使用一个正在运行的`simpleHTMLDom`Windows 服务器（从 Apache 下载）。我想启用，但是当我重新启动 Apache 时，我在 PHP 日志中看到以下错误：`Apache 2.2``PHP 5.3.14``mbstring (extension=php_mbstring.dll)`

> PHP 警告：PHP 启动：无法在第 0 行的未知中加载动态库“C:\PHP\ext\php_mbstring.dll”

DLL文件在那里。我在[php.net](http://php.net/manual/en/mbstring.installation.php)上发现 mbstring 需要 libmbfl 才能工作。我找不到如何让 libmbfl 工作。

我找不到加载 libmbfl 的任何类型的 DLL。如何让 simpleHTMLDom 在我的开发环境下工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T09:14:49.927

我认为这将有助于安装 libmbfl 然后你可以这样做

[https://github.com/moriyoshi/libmbfl](https://github.com/moriyoshi/libmbfl)

# perl - HTML::FormHandler 持久化表单类

> ID：14792316
> 
> 赞同：0
> 
> 时间：2013-02-09T22:26:55.533
> 
> 标签：perl, forms, persistent, catalyst

我正在使用[HTML::FormHandler](https://metacpan.org/module/HTML::FormHandler)并且我想通过在我的控制器类中使其成为 moose 属性来使我的表单持久化。在 HTML::FormHandler 的[Manual Intro 文档](https://metacpan.org/module/HTML::FormHandler::Manual::Intro#Performance)中，它是这样说的：

```
FormHandler makes heavy use of Moose, so almost all of FormHandler's 
profiled time will actually be in Moose methods, mostly constructing form 
and field attributes. Some people prefer to use a persistent form class 
(in a Moose attribute) in order to skip the form building step on each call. 
```

我想这样做，但是它没有给出示例，而且我对 Moose 不太熟悉，所以我不知道该怎么做。在此之前有没有人做过这个，可以举例说明在你的 Catalyst 代码中添加什么来完成这个？或者只是和想法如何去做？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:40:31.077

所以我最终找到了解决方案。事实证明，一个示例只是在有关如何将 HTML::FormHandler 与 Catalyst 一起使用的文档的不同部分中：[HTML::FormHandler::Manual::Catalyst](https://metacpan.org/module/GSHANK/HTML-FormHandler-0.40019/lib/HTML/FormHandler/Manual/Catalyst.pod#Putting-a-form-in-a-Moose-attribute)。这是一个关于如何使表单持久化的示例（直接来自文档）

```
package MyApp::Controller::Book;
use Moose;
BEGIN { extends 'Catalyst::Controller'; }
use MyApp::Form::Book;
has 'edit_form' => ( isa => 'MyApp::Form::Book', is => 'rw',
    lazy => 1, default => sub { MyApp::Form::Book->new } ); 
```

# json - System.Json 不见了？

> ID：14792318
> 
> 赞同：2
> 
> 时间：2013-02-09T22:27:07.337
> 
> 标签：json, mono, xamarin.ios, xamarin.android

我最近下载并安装了 MonoTouch & Mono for Android 试用版 SDK。其中包括 MonoDevelop，我使用这个工具进行开发。我正在尝试创建一个多平台应用程序。

我正在尝试调用 Web 服务并解析返回的 JSON 数据。不知何故，似乎缺少 System.JSON 库。

也许我做错了什么或错过了什么。任何人都知道如何解决这个问题？

**编辑：**如果 System.Json 确实丢失了，我可能不得不求助于[这个项目......](https://github.com/moljac/System.Json)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T00:41:26.977

我现在觉得有点傻。我没有意识到我必须在我的项目中添加对 System.Json 库的引用才能使用它。由于我看到了包含的基本 System 库，因此我认为 System 命名空间中的所有其他内容也默认包含在内。

无论哪种方式，要修复框架中存在的缺少程序集等问题，只需双击`References`Mono 项目中的文件夹，然后选择要包含的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:36:28.503

使用[Newtonsoft 的 JSON 转换](http://json.codeplex.com/)，它具有比 System.Json 更多的功能，并且具有更好的性能特征。有一个用于 Mono 的构建，您也可以在您的项目中使用它。

# android - 确保 http 连接通过 wifi

> ID：14792319
> 
> 赞同：3
> 
> 时间：2013-02-09T22:27:22.240
> 
> 标签：android, wifi

我在应用程序上有一个小服务，可以在白天收集数据，并将数据保存到 sd 卡。前提是数据量很大，因此应用程序在任何情况下都不应通过用户的数据计划上传该数据。

在某些情况下，wifi“存在”但无法使用，并且电话尽可能地路由网络请求，如果可以的话，使用数据计划连接。

有没有办法，无论多么肮脏，以确保请求将仅通过 wifi 连接或失败？

编辑：

通过阅读我的问题，我发现我没有详细解释发生了什么。我正在从环境中收集数据（某种形式的日志记录），这些数据会累积在 SD 卡上。当用户在附近或在家（或任何其他启用 WiFi 的地方）时，软件应检测到该情况并通过 http POST 请求将 sd 卡内容出列。文件大小为 1MB 或更大，因此即使我检测到 Wifi 的存在，它也会在传输过程中发生变化。或者更糟糕的是，Wifi 可以打开，但无法路由，因此电话会通过您的数据计划路由连接，并破坏您本月的预算。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:30:56.017

你可以通过两件事来实现这一点：

1-在上传之前，请检查当前手机是否通过 Wi-Fi 连接，这是一个示例函数

```
 public static boolean isConnectedToWiFi(Context context) {
    NetworkInfo activeNetwork = getConnectivityManager(context)
            .getActiveNetworkInfo();
    if (activeNetwork != null) {
        return activeNetwork.isConnected()
                && activeNetwork.getType() == ConnectivityManager.TYPE_WIFI;
    }
    return false;
} 
```

2- 收听连接变化广播`android.net.conn.CONNECTIVITY_CHANGE`以监控连接何时发生变化，例如切换到 3G

# python - Pyinstaller .exe 无法在所有计算机上运行

> ID：14792323
> 
> 赞同：0
> 
> 时间：2013-02-09T22:28:06.447
> 
> 标签：python, pyinstaller

今天我第一次使用 PyInstaller（单个文件）成功地打包了一个 python 程序。它编译没有任何错误，并且在我编译它的计算机上正常运行。但是，当我将 .exe 文件传送到另一台计算机时，它运行良好，直到我按下某个特定按钮来处理我的数据并且它什么也不做。我收到以下消息：

```
No module named numpy.distutils.msvccompiler in numpy.distutils; trying from distutils
Cannot build import library: "C:\Users\****\AppData\Local\Temp\_MEI94842\libs\python27.lib" not found
Cannot build import library: "C:\Users\****\AppData\Local\Temp\_MEI94842\libs\python27.lib" not found
Exception in Tkinter callback
[ some bunch of tracebacks ]
CompileError: error: could not create 'c:\users\****\appdata\local\temp\****\python27_intermediate\
compiler_d41d8cd98f00b204e9800998ecf8427e\Release\users\****\****\pyinstaller\gui\dist\gui.exe?175104':
The syntax of the filename, directoryname or volumename is incorrect 
```

由于在打包我的代码时我是一个绝对的初学者，所以我对我必须做些什么来解决这个问题一无所知。

导入的库：`Tkinter, tkFileDialog, tkMessageBox, numpy, matplotlib.pyplot, scipy.signal.medfilt, scipy.weave, pywt`

有一些 C++ 代码包含使用`scipy.weave`

更新：我强制使用 GCC 编译器而不是 MSVC，它解决了第一行的警告，但没有解决其余的问题。它似乎与 相关`scipy.weave`，因为所有回调（我省略了）都引用了使用 weave 的代码片段。如何使 PyInstaller 与 weave 一起工作？

谢谢

# c++ - 对象数组和崩溃

> ID：14792324
> 
> 赞同：0
> 
> 时间：2013-02-09T22:28:08.723
> 
> 标签：c++, arrays, class, sdl

我一直在使用 SDL 库开发程序。一切都在 Linux 中完成并且运行良好，移植到 Windows 时出现问题。当我构建并运行程序崩溃（程序停止工作）并关闭时，我首先认为它与 SDL 有关，但我将错误隔离到我刚刚定义二维数组或类对象的行. 类原型在头文件中定义，如下所示：

```
#ifndef PARTICULA_H
#define PARTICULA_H

class particula {
    public:
    particula();
    particula(const particula& orig);
    virtual ~particula();

    int x,y;
    int vx,vy;
    int tipo;
    int tipo2;
    int peso;
    int empuje;
    bool update;
    bool update_temp;
    int contador;
    int temperatura;
};

#endif 
```

现在，在其 .cpp 文件中定义的类构造函数

```
particula::particula() {
    vx = 0; vy = 0; tipo = 0; peso = 0; empuje = 0; 
    update = true; contador = 0; temperatura = 0;
    update_temp = true; tipo2 = 0;
}

particula::particula(const particula& orig) {
}

particula::~particula() {
} 
```

好的，在 main() 函数中，刚开始，我定义了这个类的一个数组：

```
particula matriz[400][220]; 
```

如果我构建并运行，程序会崩溃，如果我评论那一行，程序不会崩溃。不可能是别的，我已经评论了整个`main`函数来找到它，所以那行是唯一执行的东西。会是什么呢？我做错什么了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:31:54.287

我认为你在堆栈上分配了这么大的数组，所以你会崩溃。你在 main 函数中写了这一行，我没有看到 new 运算符。所以你在堆栈上为你的结构分配内存。堆栈无法容纳这么多数据...使用 new 关键字在堆中分配内存，不要忘记稍后释放它。 [阅读这篇文章。](http://www.learncpp.com/cpp-tutorial/79-the-stack-and-the-heap/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:41:00.477

默认情况下，Windows 上的最大堆栈空间量为 1mb，但该数组需要大约 4mb。所以你必须在堆上分配它：

```
particula (*matriz)[220] = new[400][220]; 
```

或者：

```
vector<vector<particula>> matriz; 
```

然后根据需要添加元素。

# android - 使用 Android NDK 编译命令行 C 应用程序

> ID：14792330
> 
> 赞同：2
> 
> 时间：2013-02-09T22:28:32.077
> 
> 标签：android, c, android-ndk, cygwin

我正在尝试编译[Fritz](http://sourceforge.net/projects/frotz/)以在 a 中运行，`terminal emulator`以便它可以在我的 Android Ice Cream Sandwich 智能手机上执行。`Frotz`是一个用于播放交互式小说的开源`Z-Machine`解释器，基本上只是一个命令行应用程序。我做了以下事情：

*   下载 Android NDK (android-ndk-r8d) 并将其提取到我的 Windows 7 笔记本电脑上。（提取到`c:\android\android-ndk-r8d`）
*   下载并安装 Cygwin，包括所有开发包。（所以`make`安装）
*   使用 Cygwin，导航到包含提取的 Fritz makefile 和源文件夹的文件夹，然后尝试执行`make`.

当我尝试运行时`make`，我遇到了与`curses.h`未找到相关的问题（但这个问题不是这个问题的重点；也许是后续问题的重点）。当我这样做时`make dumb`（它编译了 Fritz 的简化版本），编译成功并且我能够在`Cygwin`. 但是如果我将编译好的命令行应用程序复制到手机并尝试执行它，我会收到以下错误：

> 不可执行：魔法 4D5A

我怀疑这里的问题是可执行文件现在没有为 Arm 架构编译。make 文件中包含以下行：

```
CC = gcc 
```

我尝试将其更改为：

```
CC = /cygdrive/c/android/android-ndk-r8d/toolchains/arm-linux-androideabi-4.7/prebuilt/windows/bin/arm-linux-androideabi-gcc.exe 
```

但是现在当我执行时`make`，我收到以下错误消息：

```
fatal error: signal.h: No such file or directory 
```

我对 C 开发（和 Android）非常陌生，并且正在努力弄清楚如何更改 makefile 以便它可以为 Android 正确编译。我将在下面包含完整的 makefile，并将感谢任何人可以提供的任何帮助，以使其正确编译为 Android。

完整的`Frotz`生成文件：

```
# Define your C compiler.  I recommend gcc if you have it.
# MacOS users should use "cc" even though it's really "gcc".
#
CC = gcc
#CC = cc

# Define your optimization flags.  Most compilers understand -O and -O2,
# Standard (note: Solaris on UltraSparc using gcc 2.8.x might not like this.)
#
OPTS = -O2

# Pentium with gcc 2.7.0 or better
#OPTS = -O2 -fomit-frame-pointer -malign-functions=2 -malign-loops=2 \
#-malign-jumps=2

# Define where you want Frotz installed.  Usually this is /usr/local
PREFIX = /usr/local

MAN_PREFIX = $(PREFIX)
#MAN_PREFIX = /usr/local/share

CONFIG_DIR = $(PREFIX)/etc
#CONFIG_DIR = /etc

# Define where you want Frotz to look for frotz.conf.
#
CONFIG_DIR = /usr/local/etc
#CONFIG_DIR = /etc
#CONFIG_DIR = /usr/pkg/etc
#CONFIG_DIR =

# Uncomment this if you want color support.  Most, but not all curses
# libraries that work with Frotz will support color.
#
COLOR_DEFS = -DCOLOR_SUPPORT

# Uncomment this if you have an OSS soundcard driver and want classical
# Infocom sound support.
#
#SOUND_DEFS = -DOSS_SOUND

# Uncomment this too if you're running BSD of some sort and are using
# the OSS sound driver.
#
#SOUND_LIB = -lossaudio

# Define your sound device
# This should probably be a command-line/config-file option.
#
#SOUND_DEV = /dev/dsp
#SOUND_DEV = /dev/sound
#SOUND_DEV = /dev/audio

# If your vendor-supplied curses library won't work, uncomment the
# location where ncurses.h is.
#
#INCL = -I/usr/local/include
#INCL = -I/usr/pkg/include
#INCL = -I/usr/freeware/include
#INCL = -I/5usr/include
#INCL = -I/path/to/ncurses.h

# If your vendor-supplied curses library won't work, uncomment the
# location where the ncurses library is.
#
#LIB = -L/usr/local/lib
#LIB = -L/usr/pkg/lib
#LIB = -L/usr/freeware/lib
#LIB = -L/5usr/lib
#LIB = -L/path/to/libncurses.so

# One of these must always be uncommented.  If your vendor-supplied
# curses library won't work, comment out the first option and uncomment
# the second.
#
CURSES = -lcurses
#CURSES = -lncurses

# Uncomment this if your need to use ncurses instead of the
# vendor-supplied curses library.  This just tells the compile process
# which header to include, so don't worry if ncurses is all you have
# (like on Linux).  You'll be fine.
#
#CURSES_DEF = -DUSE_NCURSES_H

# Uncomment this if you're compiling Unix Frotz on a machine that lacks
# the memmove(3) system call.  If you don't know what this means, leave it
# alone.
#
#MEMMOVE_DEF = -DNO_MEMMOVE

# Uncomment this if for some wacky reason you want to compile Unix Frotz
# under Cygwin under Windoze.  This sort of thing is not reccomended.
#
#EXTENSION = .exe

#####################################################
# Nothing under this line should need to be changed.
#####################################################

SRCDIR = src

VERSION = 2.43d

NAME = frotz
BINNAME = $(NAME)

DISTFILES = bugtest

DISTNAME = $(BINNAME)-$(VERSION)
distdir = $(DISTNAME)

COMMON_DIR = $(SRCDIR)/common
COMMON_TARGET = $(SRCDIR)/frotz_common.a
COMMON_OBJECT = $(COMMON_DIR)/buffer.o \
    $(COMMON_DIR)/err.o \
    $(COMMON_DIR)/fastmem.o \
    $(COMMON_DIR)/files.o \
    $(COMMON_DIR)/hotkey.o \
    $(COMMON_DIR)/input.o \
    $(COMMON_DIR)/main.o \
    $(COMMON_DIR)/math.o \
    $(COMMON_DIR)/object.o \
    $(COMMON_DIR)/process.o \
    $(COMMON_DIR)/quetzal.o \
    $(COMMON_DIR)/random.o \
    $(COMMON_DIR)/redirect.o \
    $(COMMON_DIR)/screen.o \
    $(COMMON_DIR)/sound.o \
    $(COMMON_DIR)/stream.o \
    $(COMMON_DIR)/table.o \
    $(COMMON_DIR)/text.o \
    $(COMMON_DIR)/variable.o

CURSES_DIR = $(SRCDIR)/curses
CURSES_TARGET = $(SRCDIR)/frotz_curses.a
CURSES_OBJECT = $(CURSES_DIR)/ux_init.o \
    $(CURSES_DIR)/ux_input.o \
    $(CURSES_DIR)/ux_pic.o \
    $(CURSES_DIR)/ux_screen.o \
    $(CURSES_DIR)/ux_text.o \
    $(CURSES_DIR)/ux_audio_none.o \
    $(CURSES_DIR)/ux_audio_oss.o

DUMB_DIR = $(SRCDIR)/dumb
DUMB_TARGET = $(SRCDIR)/frotz_dumb.a
DUMB_OBJECT =   $(DUMB_DIR)/dumb_init.o \
    $(DUMB_DIR)/dumb_input.o \
    $(DUMB_DIR)/dumb_output.o \
    $(DUMB_DIR)/dumb_pic.o

TARGETS = $(COMMON_TARGET) $(CURSES_TARGET)

OPT_DEFS = -DCONFIG_DIR="\"$(CONFIG_DIR)\"" $(CURSES_DEF) \
-DVERSION="\"$(VERSION)\"" -DSOUND_DEV="\"$(SOUND_DEV)\""

COMP_DEFS = $(OPT_DEFS) $(COLOR_DEFS) $(SOUND_DEFS) $(SOUNDCARD) \
$(MEMMOVE_DEF)

FLAGS = $(OPTS) $(COMP_DEFS) $(INCL)

$(NAME): $(NAME)-curses

$(NAME)-curses:     soundcard.h  $(COMMON_TARGET) $(CURSES_TARGET)
$(CC) -o $(BINNAME)$(EXTENSION) $(TARGETS) $(LIB) $(CURSES) \
    $(SOUND_LIB)

all:    $(NAME) d$(NAME)

dumb:       $(NAME)-dumb
d$(NAME):   $(NAME)-dumb
$(NAME)-dumb:       $(COMMON_TARGET) $(DUMB_TARGET)
$(CC) -o d$(BINNAME)$(EXTENSION) $(COMMON_TARGET) \
    $(DUMB_TARGET) $(LIB)

.SUFFIXES:
.SUFFIXES: .c .o .h

.c.o:
$(CC) $(FLAGS) $(CFLAGS) -o $@ -c $<

# If you're going to make this target manually, you'd better know which
# config target to make first.
#
common_lib: $(COMMON_TARGET)
$(COMMON_TARGET): $(COMMON_OBJECT)
@echo
@echo "Archiving common code..."
ar rc $(COMMON_TARGET) $(COMMON_OBJECT)
ranlib $(COMMON_TARGET)
@echo

curses_lib: config_curses $(CURSES_TARGET)
$(CURSES_TARGET): $(CURSES_OBJECT)
@echo
@echo "Archiving curses interface code..."
ar rc $(CURSES_TARGET) $(CURSES_OBJECT)
ranlib $(CURSES_TARGET)
@echo

dumb_lib:   $(DUMB_TARGET)
$(DUMB_TARGET): $(DUMB_OBJECT)
@echo
@echo "Archiving dumb interface code..."
ar rc $(DUMB_TARGET) $(DUMB_OBJECT)
ranlib $(DUMB_TARGET)
@echo

soundcard.h:
@if [ ! -f $(SRCDIR)/soundcard.h ] ; then \
     sh $(SRCDIR)/misc/findsound.sh $(SRCDIR); \
fi

install: $(NAME)
strip $(BINNAME)$(EXTENSION)
install -d $(PREFIX)/bin
install -d $(MAN_PREFIX)/man/man6
install -c -m 755 $(BINNAME)$(EXTENSION) $(PREFIX)/bin
install -c -m 644 doc/$(NAME).6 $(MAN_PREFIX)/man/man6

uninstall:
rm -f $(PREFIX)/bin/$(NAME)
rm -f $(MAN_PREFIX)/man/man6/$(NAME).6

deinstall: uninstall

install_dumb: d$(NAME)
strip d$(BINNAME)$(EXTENSION)
install -d $(PREFIX)/bin
install -d $(MAN_PREFIX)/man/man6
install -c -m 755 d$(BINNAME)$(EXTENSION) $(PREFIX)/bin
install -c -m 644 doc/d$(NAME).6 $(MAN_PREFIX)/man/man6

uninstall_dumb:
rm -f $(PREFIX)/bin/d$(NAME)
rm -f $(MAN_PREFIX)/man/man6/d$(NAME).6

deinstall_dumb: uninstall_dumb

distro: dist

dist: distclean
mkdir $(distdir)
@for file in `ls`; do \
    if test $$file != $(distdir); then \
        cp -Rp $$file $(distdir)/$$file; \
    fi; \
done
find $(distdir) -type l -exec rm -f {} \;
tar chof $(distdir).tar $(distdir)
gzip -f --best $(distdir).tar
rm -rf $(distdir)
@echo
@echo "$(distdir).tar.gz created"
@echo

clean:
rm -f $(SRCDIR)/*.h $(SRCDIR)/*.a
rm -f $(COMMON_DIR)/*.o $(CURSES_DIR)/*.o $(DUMB_DIR)/*.o

distclean: clean
rm -f $(BINNAME)$(EXTENSION) d$(BINNAME)$(EXTENSION)
rm -f $(BINNAME).exe $(BINNAME).bak $(BINNAME).lib
rm -f *core $(SRCDIR)/*core
-rm -rf $(distdir)
-rm -f $(distdir).tar $(distdir).tar.gz

realclean: distclean

clobber: distclean

help:
@echo
@echo "Targets:"
@echo "    frotz"
@echo "    dfrotz"
@echo "    install"
@echo "    uninstall"
@echo "    clean"
@echo "    distclean"
@echo 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T05:34:10.867

使用 android-ndk-r8d，您不需要 cygwin：make 可以在 c:\android\android-ndk-r8d\prebuilt\windows32\bin 中找到。

无论如何，要使用 makefile，您应该按照 c:\android\android-ndk-r8d\STANDALONE-TOOLCHAIN.html 中的说明进行操作

# php - display random mysql results whilst limiting them 0,12 and 12,24?

> ID：14792331
> 
> 赞同：0
> 
> 时间：2013-02-09T22:28:36.727
> 
> 标签：php, mysql

I'm using two functions here, `get_user_set1` and `get_user_set2`.

On my page I have `div1` that displays 12 users, and then `div2` which also displays 12 users. I have 24 users all together.

What I am trying to do is display all 24 users across the 2 divs so 12 in each. at the moment I have `Limit 0`, 12 for the first function and then 12, 24 for the second which displays the first 12 users in the first div and then the second function which displays the next 12 users in the second div.

However, I am trying to figure out how I can make the order in which the 24 users are displayed random without creating a duplicate user and whilst still displaying each of the 24 users and still limiting it to 12\. can someone please show me how could I do this?

Thanks.

```
function 1: 

function get_user_set1() {
            global $connection;
            $query = "SELECT *
                        FROM ptb_users, ptb_profiles
                        WHERE ptb_users.account_type = \"User\"
                        AND ptb_users.account_status = \"Active\"
                        AND ptb_profiles.user_id = ptb_users.id
                        AND ptb_users.subscription = \"Free\"
                        ORDER BY RAND()
                        LIMIT 0 , 12";
            $get_user_set1 = mysql_query($query, $connection);
            confirm_query($get_user_set1);
            return $get_user_set1;
        }
function 2:

        function get_user_set2() {
            global $connection;
            $query = "SELECT *
                        FROM ptb_users, ptb_profiles
                        WHERE ptb_users.account_type = \"User\"
                        AND ptb_users.account_status = \"Active\"
                        AND ptb_profiles.user_id = ptb_users.id
                        AND ptb_users.subscription = \"Free\"
                        ORDER BY RAND()
                        LIMIT 12 , 24";
            $get_user_set2 = mysql_query($query, $connection);
            confirm_query($get_user_set2);
            return $get_user_set2;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:50:19.777

Every`ORDER BY RAND()`为您提供了一组不同的随机排序的用户，因此使用第二个查询来询问“下一个”12 个用户是没有意义的——您从不同的随机顺序中获得下一个 12 个用户。

如果您真正想要做的是在两组 12 个中显示 24 个用户，请`SELECT`使用 a 做一个`LIMIT 24`，然后将集合切成两半。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:38:15.960

您只需要一个查询，当您执行循环以显示每个查询时，您可以在循环内使用“IF”来控制迭代器是否小于 12，并将其打印在正确的 DIV 中。如果您需要更多详细信息，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:43:06.577

我想知道为什么你有两个功能，你可以只做一个查询并通过限制变量控制它。

```
 "SELECT *
                    FROM ptb_users, ptb_profiles
                    WHERE ptb_users.account_type = \"User\"
                    AND ptb_users.account_status = \"Active\"
                    AND ptb_profiles.user_id = ptb_users.id
                    AND ptb_users.subscription = \"Free\"
                    ORDER BY RAND()
                     $limit ";
                        ^---------limit variable here 
```

像这样的东西

```
 if (something here ){$limit = 'LIMIT 0,12'; }
 if (something else){$limit = 'LIMIT 12,24';} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T23:20:10.963

如果我正确理解了这个问题，那么您有两个用户部门。您希望从每个中随机选择 12 个，然后您希望随机呈现它们。

下面通过对每个组使用子查询然后将它们联合在一起并随机排序来做到这一点：

```
select *
from ((SELECT *
       FROM ptb_users join
            ptb_profiles
            on ptb_profiles.user_id = ptb_users.id
       WHERE ptb_users.account_type = \"User\" and
             ptb_users.account_status = \"Active\" and
             ptb_users.subscription = \"Free\" and
             DIVISION = DIV1
       ORDER BY RAND() 
       limit 12
      ) union all
      (SELECT *
       FROM ptb_users join
            ptb_profiles
            on ptb_profiles.user_id = ptb_users.id
       WHERE ptb_users.account_type = \"User\" and
             ptb_users.account_status = \"Active\" and
             ptb_users.subscription = \"Free\" and
             DIVISION = DIV2
       ORDER BY RAND() 
       limit 12
      )
    ) t
ORDER BY RAND() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T22:52:28.473

不要进行两次查询，而是进行一次以下查询：

```
SELECT *
FROM ptb_users, ptb_profiles
WHERE ptb_users.account_type = \"User\"
AND ptb_users.account_status = \"Active\"
AND ptb_profiles.user_id = ptb_users.id
AND ptb_users.subscription = \"Free\"
ORDER BY RAND()
LIMIT 0 , 24 
```

使用 PHP 在一个 div 中显示结果的前 12 行，在另一个 div 中显示后 12 行。

# javascript - JQuery blocking for an asynch initialization

> ID：14792335
> 
> 赞同：0
> 
> 时间：2013-02-09T22:29:02.473
> 
> 标签：javascript, jquery, angularjs, signalr

I'm writing an AngularJS service for a SignalR hub. Here's my factory for the service:

```
.factory('gameManager', [function () { 
        $.connection.hub.start();
        var manager = $.connection.gameManager;
        return manager;
    }]) 
```

That code would be perfect, except that that `.start()` call is asynchronous, and the [hub](https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs) has not completed starting by the time the manager is returned. Basically, I want to block until the start is complete before returning the manager. The `.start()` method returns a Jquery [deferred](http://api.jquery.com/category/deferred-object/) object, which I'm guessing is part of the answer, but I don't know how to use it without a callback function?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:42:32.853

像下面这样的东西应该可以解决问题。

```
app.factory('gameManager', [function () { 
    return $.connection.hub.start().then(function() {
      return $.connection.gameManager;
    });
}]) 
```

现在你的回调函数也将返回一个延迟/承诺，所以服务消费者需要期待这一点。您的消费代码可能如下所示：

```
gameManager.then(function(gameManager) {

  // do whatever with game manager
  gameManager.doSomething();
}); 
```

jquery Deferred的文档[在这里](http://api.jquery.com/category/deferred-object/)。特别是，检查[`Deferred.then()`](http://api.jquery.com/deferred.then/)。

注意：

> deferred.then() 方法返回一个新的promise，它可以通过函数过滤deferred 的状态和值……这些过滤器函数可以返回一个新值，传递给promise 的.done() 或.fail( ) 回调，或者它们可以返回另一个可观察对象（Deferred、Promise 等），它将其已解决/拒绝状态和值传递给 promise 的回调...

* * *

**更新**：

另一种方法（可能是更好的方法 - 因为它不需要您的消费者处理承诺）是让集线器在设置您的工厂之前完全初始化，并启动您的应用程序控制器。像这样的东西...

```
$.connection.hub.start().then(function() {
  app.factory('gameManager', function() {
    return $.connection.gameManager;
  });

  // ...
  // kick off the rest of the app..

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:27:13.500

你不会找到你要找的东西，你将不得不接受李的回答。Javascript 大多是单线程的，不允许阻塞（有特定的例外，例如警报窗口或同步 ajax 调用）。

# iphone - Getting string from NSManagedObject

> ID：14792337
> 
> 赞同：0
> 
> 时间：2013-02-09T22:29:14.690
> 
> 标签：iphone, ios, objective-c, core-data, nsmanagedobject

When I try to get a string value from an NSManagedObject, I get this

```
<Entity: 0x1e043140> (entity: Entity; id: 0x1e041c30 <x-coredata://8F48C331-B879-47B4-B257-4802A13ED12C/Entity/p4> ; data: {
number = "<UITextField: 0x1d8b7cc0; frame = (159 183; 161 30); text = 'test'; clipsToBounds = YES; opaque = NO; autoresize = RM+BM; gestureRecognizers = <NSArray: 0x1d8b3c10>; layer = <CALayer: 0x1d892a30>> : ";
}) 
```

how do I get the string from this (it's text = 'test';)

i get the object using this

```
NSString *rowValue = [self.fetchedResultsController objectAtIndexPath:indexPath]; 
```

ok, well the nsmanaged object is this and sets a uitableview cell to its string

```
NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];

cell.textLabel.text = [[object valueForKey:@"number"] description]; 
```

The reason it's showing what it does is because, as you can see, I am getting it's description. I can't find a property that would return the text value, so does anyone know how? Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:48:56.907

我假设当您在托管对象中*存储值时已经发生错误。*也许你会做类似的事情

```
[myObject setValue:[aTextField description] forKey:@"number"] 
```

而不是存储文本字段的文本内容：

```
[myObject setValue:[aTextField text] forKey:@"number"] 
```

**更新：**正如您在评论中所写，托管对象值存储为

```
NSString *string = [NSString stringWithFormat:@"%@ : %@", self.numtext, self.comtext];
[newManagedObject setValue:string forKey:@"number"]; 
```

但是a*本身*`%@`的格式被扩展为文本字段*描述*，而不是*文本内容*。因此已经看起来像`UITextField` ***`string`***

 ***```
"<UITextField: 0x1d8b7cc0; frame = (159 183; 161 30); text = 'test'; .... " 
```

并且此字符串作为“数字”属性存储在托管对象中。您应该改用以下代码：

```
NSString *string = [NSString stringWithFormat:@"%@ : %@", self.numtext.text, self.comtext.text];
[newManagedObject setValue:string forKey:@"number"]; 
```

请注意，您必须在测试时删除旧数据库以消除已经存在的错误条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T08:50:04.493

```
NSString *str = managedObject.objectID.URIRepresentation.absoluteString 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-09T22:39:31.143

你应该写：

```
Entity *entity = [self.fetchedResultsController objectAtIndexPath:indexPath];
NSString *rowValue = entity.text; 
```

**编辑：**

好的，那试试`object.number.text;`***

# vb.net - VB .NET run without form and without UAC when /q argument passed

> ID：14792338
> 
> 赞同：0
> 
> 时间：2013-02-09T22:29:17.523
> 
> 标签：vb.net, visual-studio-2012

I'm VERY new at VB .NET and have recently downloaded MS Visual Studio Express 2012\. I'm trying to design an application to replace a VBScript I created and can't find the answer to Two of the main design phase features I require so I apologize ahead of time for my ignorance.

I'm trying to create an application to edit the configuration parameters of an existing application I support. the configurations are edited in both the Files System and in the Windows Registry.

I'm looking for a way to pass a "/q" or "/quiet" and allow the application to run silently. I have developed the program far enough to edit the options in the form and save them. I can run code (so far only messages displaying the options) from the start configuration button from a "Windows Form Application".

I'm also needing to make sure that when running silently the application does not need UAC elevation. In the original VBScript I need to elevate UAC when editing the Windows Registry.

I know this is a lot to ask for with my current knowledge level. But I'm still in the design stage and trying to learn fast and really need to know if this is even possible before I go too far.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:32:37.917

如果原始应用程序需要 UAC 提升来编辑注册表，那么新应用程序也需要。访问级别基于每个用户而不是每个应用程序，因此除非您以其他用户身份运行应用程序，否则您的新应用程序将遇到相同的问题。

至于在不显示表单的情况下运行，您需要像这样编辑 Main ：

```
 <STAThread()> _
 Shared Sub Main()
    ' Read the arguments    
    ' Starts the application.
    if (argument == "/q" or argument == "/quiet") then
        ' Edit the other program configurations here
    else
        Application.Run(New Form1())
    End if
 End Sub 
```

您可以调用[不显示表单的](http://msdn.microsoft.com/en-us/library/ms157901.aspx)[版本`Run(ApplicationContext )`](http://msdn.microsoft.com/en-us/library/ms157901.aspx)，但是在启动消息循环时，您仍然需要某种方式来实际编辑其他程序的配置，也许是为了响应击键。

# regex - How can I write a regular expression match for a string that must contain the following characters: thankYou.sjs?donate_page

> ID：14792339
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:29:27.233
> 
> 标签：regex

I need to create a regex query for a Google Analytics goal. The goal url must contain:

thankYou.sjs?donate_page

However, there are many urls than can render this string, all with other modifiers that I don't care about.

Please advise.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:30:39.790

Just the string itself will work. If you want *only* this string, just use the start/end of string zero-width assertions:

```
^thankYou\.sjs\?donate_path$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:26:44.577

@ExplosionPills：我想你忘记了问号的特殊含义。如果你不逃避它，你的表情：

```
^thankYou.sjs?donate_path$ 
```

会匹配

```
thankYou.sjsdonate_path 
```

或者

```
thankYou.sjdonate_path 
```

更不用说点的特殊含义了。

所以我想这样的事情应该有效：

```
thankYou\.sjs\?donate_path 
```

此外，如果 donate_path 可能不是查询字符串中的第一个，您可以使用它：

```
thankYou\.sjs\?([^&]*&)*donate_path 
```

# javascript - 多次刷新div触发内部HTML的document.ready

> ID：14792341
> 
> 赞同：0
> 
> 时间：2013-02-09T22:29:59.743
> 
> 标签：javascript, jquery, html, load, refresh

情况如下：我有一个带有一些链接的 index.php。每个链接都会获得另一个页面（例如 nicetry.html）以加载到 div 中。正在加载的这个页面（例如 nicetry.html）需要在 document.ready 中触发一些 ajax 并将点击事件绑定到按钮。（实际上，我绑定onclick函数时并不重要）。此按钮应刷新所述 div 的内容，从而触发 nicetry.html 的 document.ready。

在代码中...

索引.php：

```
<script>
    $("#nicetry").click(function(){
         $('#content').load('nicetry.html');
    });
</script>
<body>
<div id="nav">
 <ul>
  <li id="home"> <a href="#"> Home </a></li>
  <li id="nicetry"> <a href="#"> nicetry </a></li>
 </ul>
</div>

<div id="content"></div>
</body> 
```

nicetry.html

```
$(document).ready({

//some stuff

 $("#next").on("click", function() {
   $("#content").load("nicetry.html");
 });
}); 
```

这适用于我第一次点击“下一步”按钮，然后它停止重新加载 div。由于按钮的 id 没有改变，我猜这是缓存的问题。我尝试附加无缓存元标记，将 ?val=randomInts 附加到 url ......没有任何效果。要么是因为我做错了，要么因为它实际上不起作用。

我最终实现了一个解决方法，让 index.php 在 document.ready 加载 nicetry.html 并简单地从 nicetry.html 执行 location.reload(true)。不过，我想知道是否有更好的解决方案，或者为什么这不能按照我认为的方式工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T01:11:43.033

我不知道为什么我花了这么长时间才弄清楚。正如我所怀疑的那样，我太纠结于自己的疯狂和缺乏经验。

解决方案如下： 1\. 确保您有一个相当新的 jQuery 版本 2\. 像这样在索引中绑定加载：

```
 $(document).on("click", "#next",
            function() {
                    $("#content").load("nicetry.html");
            }); 
```

简单的 ：）

# jquery - jQuery 和 iFrame 在 HTML 注入后检测新高度

> ID：14792348
> 
> 赞同：0
> 
> 时间：2013-02-09T22:30:52.930
> 
> 标签：jquery, iframe

我有一个 iFrame，我像这样通过 jQuery 动态设置 HTML。

```
$("#iframe").contents().find('body').html("This is a large HTML string"); 
```

效果很好。但是现在我的身高无法调整 iFrame 的高度。我猜它在 DOM 改变之前而不是之后得到高度。我现在如何使用新的 HTML 获得新的高度？我什至不认为 .load 事件会触发。这是我到目前为止所拥有的：

```
$("#iframe").load(function () {
   //alerting this new height returns nothing
   $("#iframe").contents().find('body').height();
}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:35:55.050

使用方法链

```
$("#iframe").contents().find('body').html("This is a large HTML string").height() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:40:27.940

[html 方法](http://api.jquery.com/html/#html2)根据作为参数传入的 HTML 设置内容。如果你想让它触发`load()`事件，你应该使用[load 方法](http://api.jquery.com/load/)。此外，如果您不想依赖事件，可以使用回调函数[。](http://api.jquery.com/load/#callback-function)`load()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:46:11.260

由于您已经在使用 jQuery，您可以创建一个回调函数，该函数将在 iframe 链完成后触发。只是一个演示，你可以从这里把它带到你想要的地方。

```
var callbacks = $.Callbacks();
callbacks.add( createIframe );
callbacks.fire( getHeight() );

function createIframe() {
 $("#iframe").contents().find('body').html("This is a large HTML  string");
}

function getHeight() {       
   alert( $("#iframe").contents().find('body').height() );
} 
```

# pebble-watch - Pebble Watch Faces

> ID：14792351
> 
> 赞同：14
> 
> 时间：2013-02-09T22:30:57.620
> 
> 标签：pebble-watch, pebble-sdk

I'm trying to create my own Pebble watch faces. It appears no one has done this yet and there's no SDK.

So far I've figured out that the watch faces are hosted here: [http://pebble-static.s3.amazonaws.com/watchfaces/index.html](http://pebble-static.s3.amazonaws.com/watchfaces/index.html)

Each watch face is a .pbw file which is a zip file. There's 3 files inside: app_resources.pbpack, manifest.json and pebble-app.bin.

The JSON file includes a list of all the parts of the watch face (images), which appears to be an app. The .bin file is probably the executable binary and the .pbpack file is probably a bundle of all the resources. I can't figure out how to extract the .pbpack file. I'm also not sure what to do with .bin file.

I'm trying to post my progress here: [http://hackingpebble.tumblr.com](http://hackingpebble.tumblr.com)

Any thoughts on what to do with the .pback and .bin files?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-12T19:46:19.647

SDK 现已上线。[developer.getpebble.com](http://developer.getpebble.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T05:22:21.317

我已经开始在十六进制编辑器中查看 .pbpack 和 .bin ，这很奇怪。首先是 .pbpack，我注意到一些模式，在每个主要的位块之间，有一堆 0，然后是 45 00 54，我猜这就像一个分隔符。我尝试搜索文件的十六进制签名，看看我是否会幸运地发现它是一些晦涩的文件格式，但一无所获。现在有了 .bin，我想我无法通过十六进制编辑获得任何结果，但是我们确实知道它设计用于运行的处理器（ARM Cortex-M3），这意味着我们可以合理地假设使用为 arm 设计的反编译器处理器文件，我们可以读取它。我正在研究寻找一个，但是对于我做太多工作来说有点晚了，所以我想我会给你我目前所拥有的。

我知道这不是一个很好的回应，但我想也许它会帮助你解决你想做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-08T17:13:48.150

由于不再有 Pebble 公司，新的社区项目[Rebble](https://rebble.io)接手了。它在[开发门户上有](https://developer.rebble.io/)[新的 SDK](https://developer.rebble.io/developer.pebble.com/sdk/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T23:56:03.817

我想你们可能正在寻找像[Hopper](http://www.hopperapp.com)这样的东西。这应该会给你一些原始数据。

# php - WHILE statement which requires multiple lines of code for conditional

> ID：14792353
> 
> 赞同：0
> 
> 时间：2013-02-09T22:31:29.877
> 
> 标签：php

The following receives a proposed username, and returns the username if not used, or the username appended by the smallest integer if used. It works fine, but I just can't help wondering if it could be done just as well with a single method. What's got me stumped is the WHILE statement requires both `$stmt->execute(...)` and `return $stmt->fetchColumn()` as the conditional. I guess an anonymous function would work, but don't think this will allow the prepared statement to be used for each call. I am thinking a DO loop might work, but I don't have much experience with them and reading [http://www.php.net/manual/en/control-structures.do.while.php](http://www.php.net/manual/en/control-structures.do.while.php) implies I should "use goto operator instead of this hack." Please provide recommended way of doing this. Thanks

```
<?php
    class myClass
    {
        public function createUsername($name)
        {
            $i='';
            while($this->openUsername($name.$i)==FALSE){$i=$i+1;}
            return $name.$i;
        }
        private function openUsername($name)
        {
            $sql='SELECT id FROM users WHERE username=?';
            try
            {
                $stmt = db::db()->prepare($sql);
                $stmt->execute(array($name));
                return $stmt->fetchColumn()?FALSE:TRUE;
            }
            catch(PDOException $e){die(library::sql_error($e,$sql));}
        }

    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:44:12.517

我个人会这样做：

```
function createUsername($name) {
    // validate $name, for instance restrict to alphanumeric characters with preg_match
    $sql = "SELECT GREATEST(`username`) AS `out` FROM `users` 
         WHERE `username` REGEXP '^".$name."\d*$'";
    $result = // whatever code it takes for PDO to run the above query
    if( !$result) return $name; // nobody with that name yet
    $number = preg_replace("^.*(\d*)$","$1",$result['out']);
    if( !$number) return $name."1";
    return $name.($number+1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:17:54.597

不知道这是否可行，如果您认为这不是一个好方法，请投反对票（但请评论原因）。谢谢

```
public function createUsername($name)
{
    try
    {
        $i='';
        $sql='SELECT id FROM users WHERE username=?';
        $stmt = db::db()->prepare($sql);
        do {
            $stmt->execute(array($name.$i));
            $used=$stmt->fetchColumn()?TRUE:FALSE;
            if(!$used) {$i=$i+1;}
        } while ($used);
    }
    catch(PDOException $e){die(library::sql_error($e,$sql));}
    return $name.$i;
} 
```

# java - 从另一个类访问枚举

> ID：14792357
> 
> 赞同：11
> 
> 时间：2013-02-09T22:31:59.317
> 
> 标签：java, enums

我是 Java 新手，我正在努力让我的枚举工作。我在 BlueJ 工作，我有 2 节课（试图建立一个纸牌游戏）。我的第一堂课叫做 Card 并且在这个类里面我有一个叫做 Suit 的枚举。我的另一个班级是 Deck，我正在尝试从这个班级调用枚举。我的问题是在我声明西装套装的甲板的 for 循环中。它不识别类套装。

我的代码在下面，如果有人能告诉我我做错了什么......将不胜感激。谢谢！

```
public class Deck
{

private Bag<Card> cardBag = new Bag<Card>();

public Deck()
{
  for(Suit suit : Suit.values())
     {
         Card card= new Card (suit, 5);
     }
 } 
```

//

```
public class Card
{
public enum Suit
{
    H, S, C, D
}

private Suit suit;
private int valueOfCard;

public static final int ACE = 1;
public static final int JACK = 11;
public static final int QUEEN = 12;
public static final int KING = 13;

public Card(int valueOfCard, Suit suit)
{
    this.valueOfCard= valueOfCard;
    this.suit=suit;
}
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-09T22:34:04.533

这里至少有两种可能的解决方案：

1.  将`Suit`枚举放在它自己的文件中。

2.  `Suit`在其他类中使用其完全限定名称进行访问。那是使用`Card.Suit`，而不是仅仅`Suit`。

# php - 在 Jquery 中调用 JavaScript 的问题

> ID：14792359
> 
> 赞同：0
> 
> 时间：2013-02-09T22:32:09.247
> 
> 标签：php, javascript, jquery, jquery-ui

单击链接后，我试图在 Jquery 中调用 javascript 中的函数。当我尝试这样做时，什么也没有发生。

代码：

```
function run(){
    var url = '/pcg/popups/grabnotes.php';
    showUrlInDialog(url);
}

$("#NotesAccessor").click(function () {
      run();
    }); 
```

PHP：

```
..
echo "<a href='#' id='NotesAccessor'>Click to access</a>";
.. 
```

不知道为什么，我在调试中检查了我的调用，没有任何调用。从运行函数转到将打开的 Jquery UI 对话框。它只是没有达到这一点。

如果你能帮我一把，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:39:00.200

当您为 $("#NotesAccessor") 定义单击事件时，您的 DOM 可能尚未加载。将您的指令包装在 $(document).ready 处理程序中：

```
$(document).ready(function() {
    $("#NotesAccessor").click(function () {
      run();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:43:28.570

您的问题可能是因为 NotesAccessor 是一个锚元素。您可以使 NotesAccessor 成为一个 div，并使用 css 使您看起来像一个锚。

另一方面，您可以直接从锚点调用 JavaScript 函数，例如：

```
<a href:'javascript:run()' >Click to access</a> 
```

# r - 将分组的连续变量转换为 R 中的行

> ID：14792360
> 
> 赞同：5
> 
> 时间：2013-02-09T22:32:09.020
> 
> 标签：r, linear-regression

我有一个包含这些值的数据框 dummy vales，我想对它们进行 lm 回归。其中一个变量是分组的连续变量，如下所示

```
df <- data.frame("y" = c(10, 11, 12, 13, 14),
                 "x" = as.factor(c("100-102", "103-105", "106-108", "109-111", "112-114"))) 
```

我想回归 y~x，一种方法是用它们的平均数值替换 x 因子。使用正则表达式很容易做到这一点。

另一种方法是创建额外的行并扩展您的数据集，使其看起来像这样

```
data.frame("y" = c(10, 10, 10, 11, 11, 11......),
           "x" = c(100, 101, 102, 103, 104, 105......)) 
```

有没有可以做到这一点的功能？

我正在考虑首先创建额外的变量，如 x1、x2、x3，然后使用 reshape2 包将 x 列转换为行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:20:25.887

一个`data.table`解决方案。`data.frame`这在大型's 上也应该非常快。

```
require(data.table)
dt <- data.table(df, key="y")
dt[, list(x=seq(sub("-.*$", "", x), sub(".*-", "", x))),by=y] 
```

如果您有更多列，并且在按列拆分时不希望每个组合`x`，那么这是要使用的代码：

```
require(data.table)
dt <- data.table(df)
# get all column names except "x"
key.cols <- setdiff(names(df), "x") 
# set the data.table columns to key.cols
setkeyv(dt, key.cols)
dt.out <- dt[, list(x=seq(sub("-.*$", "", x), sub(".*-", "", x))), by = key.cols] 
```

这应该给你你所期望的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:53:56.170

```
require(stringr)
require(foreach)

foreach(i=1:nrow(df), .combine=rbind) %do% {
  s <- as.numeric(str_extract_all(df$x[i], "[0-9]+")[[1]])
  data.frame(y=rep(df$y[i], s[2]-s[1]+1), x=seq(s[1], s[2]))  
} 
```

如果你`data.frame`真的很大，你可以一起去`%dopar%`。

# javascript - 创建一个 javascript，根据以 html 形式选中的单选框创建一个动态总计

> ID：14792363
> 
> 赞同：0
> 
> 时间：2013-02-09T22:32:26.140
> 
> 标签：javascript, html, radio-button

最亲爱的stackoverflow朋友，

我正在创建一个在线 html 表单，并创建了一个 javascript 函数来动态地（不完全确定我是否正确使用了这个词）在选择选项时在表单底部显示会员费总额。总费用取决于会员类型、国家和付款方式。当我计算的只是会员类型和根据国家/地区的邮资时，它工作得很好（我对这两个选项使用了下拉表格）。现在我想将第三项添加到等式（付款方式 - 可以选择支票或贝宝），但我无法让它工作。这次我使用单选按钮。

我的总计函数是这样的（没有“+ getPaypalfee()”它工作得很好）：

```
function getAmountDue()
    {
    var amountDue = getMembershipPrice() + getExtraPostagePrice() + getPaypalfee();
    document.getElementById('amountDue').innerHTML ="Amount Due: $"+amountDue;
    } 
```

我写的用于返回贝宝费用的 javascript 是这样的（它变得非常复杂，我不确定我哪里出错了以及如何重新启动！）：

```
var paymentmethod_Fee = new Array();
paymentmethod_Fee["cheque"]=0;
paymentmethod_Fee["paypal"]=2;

function getPaypalfee()
    {
    var paypalFee=0;
    for (var i=0; i < document.membershipform.payment_method.length; i++)
        {
        if (document.membershipform.payment_method[i].checked)
            {
             var selectedPaymentmethod = document.membershipform.payment_method[i].value;
            }
        }
    paypalFee = paymentmethod_Fee[selectedPaymentmethod.value];
    return paypalFee;
    } 
```

单选按钮的 html 如下所示：

```
<p>I will make payment via: <BR>                                
<input type="radio" id="payment_method" name="payment_method" value="cheque" checked="yes" onchange="getAmountDue()">Cheque
<input type="radio" id="payment_method" name="payment_method" value="paypal" onchange="getAmountDue()">Paypal (Add $2) 
```

非常感谢对我的逻辑缺陷的任何见解！我是 javascript 新手，单选按钮似乎是我的克星（我想学习如何使用它们，而不是用下拉菜单或我已经知道如何做的事情来替换它们）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:40:23.507

不应该使用数组来创建项目之间的映射。您正在寻找的是一个对象：

```
var fees = {
    cheque: 0,
    paypal: 2
}; 
```

至于您的错误，就在这里：

```
paypalFee = paymentmethod_Fee[selectedPaymentmethod.value]; 
```

`paymentmethod_Fee`已经是一个字符串。它没有`value`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:44:31.823

不要使用多个相同的元素`id`。这样做会产生**故障。** *超过 9000 个* **故障。**所以，不要使用重复`id`的 s。只是不要。这是Web开发的格言。它会很好地为您服务。顺其自然。否则，您将遇到**故障。**我相信你不想要**小故障。**摆脱**故障。**不要使用重复`id`的 s。

（*前一段 tl;dr：*总是有唯一`id`的 s，否则你会遇到**故障。**）

你应该把你的`radio`按钮包装在一个`div`带有 id的地方`payment_methods`。然后，使用`document.getElementById("payment_methods").childNodes[i]`访问每个连续的按钮。

（顺便说一下，两个`radio`相同的按钮`name`是互斥的，所以按钮应该有相同`name`的s但不同`id`的s。）

您使用`checked`正确。这就是您访问导致**故障的元素的方式。**

希望这可以消除您的**故障。**

# ruby - 返回数组中的下一个对象

> ID：14792366
> 
> 赞同：0
> 
> 时间：2013-02-09T22:32:54.713
> 
> 标签：ruby, ruby-on-rails-3

我希望这段代码输出当前和下一个维度成员的名称，其中 next 由每个维度成员的 absorder 属性定义。

```
<% @dimension_members.each do |dm| %>
    <p><%= dm.name %></p>
    <p><%= DimensionMember.where(:absorder => dm.absorder+1).name %></p>
<% end %> 
```

相反，代码返回当前维度成员的名称，然后为每个下一个成员返回“DimensionMember”。

以下代码产生`#<ActiveRecord::Relation:0x3f952e0>`：

```
<% @dimension_members.each do |dm| %>
    <p><%= dm.name %></p>
    <p><%= DimensionMember.where(:absorder => dm.absorder+1) %></p>
<% end %> 
```

我不得不想象有一种更简单的方法可以返回数组中的下一个成员，但我不能让它工作。考虑到这个想法，我尝试了以下代码，但它产生了`#<DimensionMember:0x3f943f8>`：

```
<% @dimension_members.each do |dm| %>
    <p><%= dm.name %></p>
    <p><%= @dimension_members[dm.absorder+1] %></p>
<% end %> 
```

最后，我试过这个：

```
<% @dimension_members.each do |dm| %>
    <p><%= dm.name %></p>
    <p><%= @dimension_members[dm.absorder+1].name %></p>
<% end %> 
```

但这会返回错误：

`undefined method 'name' for nil:NilClass`

那么我将如何获得由特定属性 absorder 定义的下一个维度成员？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:39:16.083

您得到奇怪结果的原因是 where 查询返回的是关系/集合而不是单个对象。您只需要从查询中获取第一个对象：

```
DimensionMember.where(:absorder => dm.absorder+1).first.try(:name) 
```

...

```
<% @dimension_members.each do |dm| %>
    <p><%= dm.name %></p>
    <p><%= DimensionMember.where(:absorder => dm.absorder+1).first.try(:name) %></p>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:37:12.870

您可以使用以下方法访问数组的下一个元素`next`：

```
<% @dimension_members.each_with_index do |dm, index| %>
    <p><%= dm.name %></p>
    <p><%= @dimension_members[index + 1].name %></p>
<% end %> 
```

这是您要查找的内容，还是`@dimension_members`尚未按此“absorder”属性排序？如果没有，也许您应该在迭代之前对其进行排序。

# client-server - MPI非阻塞通信和pthreads的区别？

> ID：14792368
> 
> 赞同：1
> 
> 时间：2013-02-09T22:32:57.507
> 
> 标签：client-server, mpi, p2p

`MPI_Isend`在 MPI 中，有诸如和之类的非阻塞调用`MPI_Irecv`。

如果我正在处理 p2p 项目，则服务器会监听许多客户端。

一种方法：

```
for(int i = 1; i < highest_rank; i++){
    MPI_Irecv(....,i,....statuses[i]); //listening to all slaves
}
while(true){
   for( int i = 1; i < highest_rank; i++){
         checkStatus(statuses[i])
         if true do somthing
} 
```

我可以做到的另一种旧方法是：

```
Server creating many POSIX threads, pass in a function, 
that function will call MPI_Recv and loop forever. 
```

从理论上讲，哪一个会在服务器端执行得更快？如果有另一种更好的方法来编写服务器，也请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:06:24.853

后一种解决方案对我来说似乎不是很有效，因为在 MPI 进程中管理 pthread 会产生所有开销。

无论如何，我会将您的 MPI 代码重写为：

```
for(int i = 1; i < highest_rank; i++){
   MPI_Irev(....,i,....requests[i]); //listening to all slaves
}
while(true){
   MPI_waitany(highest_rank, request[i], index, status);
   //do something useful

} 
```

更好的是，您可以使用 MPI_Recv 和 MPI_ANY_SOURCE 作为消息源的等级。似乎您的服务器除了服务请求之外没有任何事情可做，因此无需使用异步接收。代码将是：

```
while(true){
    MPI_Recv(... ,MPI_ANY_SOURCE, REQUEST_TAG,MPI_comm,status)
    //retrieve client id from status and do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T05:01:50.270

调用 MPI_Irecv 时，在调用并成功完成 MPI_Test* 或 MPI_Wait* 之前测试 recv 缓冲区是不安全的。直接测试缓冲区而不进行这些调用的行为取决于实现（范围从不太糟糕到段错误）。

可以为每个远程等级设置一个具有一个 MPI_Irecv 的 1:1 映射。根据正在发送的数据量，以及一旦接收到该数据的生命周期，这种方法可能会消耗不可接受的系统资源量。使用 MPI_Testany 或 MPI_Testall 可能会在消息处理和 CPU 负载之间提供最佳平衡。如果在等待传入消息时不需要进行非 MPI 处理，则 MPI_Waitany 或 MPI_Waital 可能更可取。

如果有未完成的 MPI_Irecv 调用，但应用程序已到达正常处理的末尾，则 MPI_Cancel 那些未完成的调用是“必要的”。未能做到这一点可能会在 MPI_Finalize 中被捕获为错误。

MPI_ANY_SOURCE 上的单个 MPI_Irecv（或只是 MPI_Recv，取决于消息处理的积极程度）也提供了一个合理的解决方案。如果接收到的数据量“大”并且可以在处理后安全丢弃，这种方法也很有用。一次处理单个传入缓冲区可以减少所需的总系统资源，但会以串行化处理为代价。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T11:21:22.047

让我评论一下您使用 POSIX 线程（或可能存在的任何其他线程机制）的想法。同时从多个线程进行 MPI 调用需要使用最高级别的线程支持来初始化 MPI 实现`MPI_THREAD_MULTIPLE`：

```
int provided;

MPI_Init_thread(&argv, &argc, MPI_THREAD_MULTIPLE, &provided);
if (provided != MPI_THREAD_MULTIPLE)
{
    printf("Error: MPI does not provide full thread support!\n");
    MPI_Abort(MPI_COMM_WORLD, 1);
} 
```

尽管支持来自不同线程的并发调用的选项在很久以前就在 MPI 标准中引入，但仍有 MPI 实现难以提供完全工作的多线程支持。MPI 完全是关于编写可移植的应用程序，至少在理论上是这样，但在这种情况下，现实生活与理论有很大不同。例如，最广泛使用的开源 MPI 实现之一 - Open MPI - 在`MPI_THREAD_MULTIPLE`级别初始化时仍然不支持本机 InfiniBand 通信（InfiniBand 是非常快速的低延迟结构，目前在大多数 HPC 集群中使用），因此切换到不同的，通常更慢且延迟更高的传输，例如常规以太网上的 TCP/IP 或 InfiniBand 上的 IP。还有一些超级计算机供应商，其 MPI 实现不支持`MPI_THREAD_MULTIPLE`根本上，通常是因为硬件的工作方式。

此外，`MPI_Recv`是一个阻塞调用，它会导致适当的线程取消（如果需要）出现问题。您必须确保所有线程以某种方式逃脱无限循环，例如通过让每个工作人员发送带有适当标记或其他协议的终止消息。

# browser - 图片在 Safari 中的位置不同

> ID：14792372
> 
> 赞同：0
> 
> 时间：2013-02-09T22:33:23.173
> 
> 标签：browser, compatibility

我的页面是 tomblex.com。

有一个绿色的矢量丝带，它在 Safari 中的位置不同。

我打算使用 PHP 制作单独的样式表，但我认为这可能非常困难，所以我想我可以先在这里问一下。

这是显示不同的 HTML 代码：

```
<div style="position:relative;top: -192;left:-541;"id="wrapper">
  <img style="position:absolute;width:1083;height:77px;"
       src="http://www.tomblex.com/leengchoste.png">
</div> 
```

# java - 如何在 Apache Tomcat 启动中创建单例

> ID：14792374
> 
> 赞同：4
> 
> 时间：2013-02-09T22:33:51.443
> 
> 标签：java, web-services, apache, constructor, singleton

我需要在 Apache Tomcat 启动时创建一个单例，以便我可以使用 servlet 访问它们。单例定义 servlet 将给出什么响应。

我想知道 tomcat 是否有构造函数，以便我可以添加代码以便可以创建单例。

*编辑：经过一番搜索，我发现我可以尝试使用网络服务（JAX-WS）。我不知道 jvm 如何处理 web 服务中的实例。我可以在到 WS 的不同连接上访问同一个对象吗？

我使用 bmargulies 解决方案将这些资源添加到*web.xml*描述符中：

```
<resource-env-ref>
  <description>
     Factory for the Arduino Connection
  </description>
  <resource-env-ref-name>
     arduino/ArduinoConnectionFactory
  </resource-env-ref-name>
  <resource-env-ref-type>
     br.com.evans.jndi.basic.ArduinoConnection
  </resource-env-ref-type>
</resource-env-ref> 
```

这对*context.xml*：

```
<Context>
  <Resource name="arduino/ArduinoConnectionFactory" auth="Container"
        type="br.com.evans.jndi.basic.ArduinoConnection"
        factory="br.com.evans.jndi.basic.ArduinoConnectionFactory"/>
</Context> 
```

创建了单例类：

```
public enum ArduinoConnection implements SerialPortEventListener {
    INSTANCE;
    public void initialize() {...}
} 
```

创建了单例“工厂”：

```
public class ArduinoConnectionFactory implements ObjectFactory {

    public ArduinoConnectionFactory() {
        ArduinoConnection.INSTANCE.initialize();
        try {
            Thread.sleep(1800);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    public Object getObjectInstance(Object obj, Name name, 
        Context nameCtx,Hashtable environment) throws NamingException {
            // Return the customized instance
            return (ArduinoConnection.INSTANCE);
        }
    } 
```

最后是 servlet 中的 get 函数：

```
 Context initCtx;
    try {
        initCtx = new InitialContext();
        Context envCtx = (Context) initCtx.lookup("java:comp/env");
        ArduinoConnection arduino = (ArduinoConnection) envCtx.lookup("arduino/ArduinoConnectionFactory");
        arduino.doSomething();
    } catch (NamingException e) {
        System.out.println("Something went wrong!");
        e.printStackTrace();
    } 
```

我现在的问题是知道如何在不创建新 InitialContext() 的情况下从另一个 servlet 调用这些方法

**编辑：**由于 new InitialContext() 并不是很贵，所以我这样做，它对我来说效果很好

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:38:12.017

阅读 Tomcat 中的 JNDI 配置。文档在[这里](http://tomcat.apache.org/tomcat-7.0-doc/jndi-resources-howto.html)。您可以定义一个在查找时创建的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:43:18.017

或者，您可以定义一个[Servlet 侦听器](http://docs.oracle.com/cd/B15904_01/web.1012/b14017/filters.htm)来侦听 Servlet 上下文初始化事件。servlet 初始化后，您可以创建对象并将其存储在 Servlet 上下文中。您的每个 servlet 都可以通过 servlet 上下文访问该对象并使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T05:15:26.210

或者，您可以使用启动 servlet 来初始化`<load-on-startup>1</load-on-startup>`web.xml 中定义的单例。

# apache - 为什么是` ` 优先于 ` ` 在 Apache 中，使用正则表达式时？

> ID：14792381
> 
> 赞同：3
> 
> 时间：2013-02-09T22:34:13.027
> 
> 标签：apache

[文档](http://httpd.apache.org/docs/current/mod/core.html#files)说：

> 也可以使用正则表达式，加上`~`字符。例如：
> 
> ```
> <Files ~ "\.(gif|jpe?g|png)$"> 
> ```
> 
> 将匹配最常见的 Internet 图形格式。`<FilesMatch>`然而，是首选。

但我不明白为什么它是首选。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T11:53:10.790

基本上两者都会做同样的事情。通常当这种情况发生时，它是样式/可读性的问题。例如，如果有人不熟悉 Apache 的配置`Files`，则会读取为“这将匹配给定的文件名，就像在 Unix 文件名中一样”，`FilesMatch`但是在使用正则表达式时更易于阅读。匹配部分将放弃匹配器，因为涉及正则表达式匹配器，而不是`~`with `Files`。

一定要为正则表达式选择一个，而不是两者。保持一致，这将确保您的配置文件的可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T11:40:10.450

没有充分的理由，他们在运行时做同样的事情。

具有 *Match 替代选项的指令是 Apache 使用的一致方式，以具有现有指令的正则表达式接受风格。

这只是一个配置风格/一致性问题。

# c# - 如何在c#中使用网格包围网络摄像头

> ID：14792382
> 
> 赞同：1
> 
> 时间：2013-02-09T22:34:33.107
> 
> 标签：c#, webcam, using

我正在使用 A Forge.NET 库使用 c# 制作网络摄像头，我想打开网络摄像头来拍摄 rubix 立方体图片。我使用图片框来处理网络摄像头框架，我想在图片框内制作一个 3*3 的网格。

它可以工作，但在运行 3 秒后会产生异常：

```
g = Graphics.FromImage(videoBox.Image);  ----> InvalidOperationException 
```

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using AForge.Video;
using AForge.Video.DirectShow;

namespace WebcamTester
{
    public partial class Form1 : Form
    {
        public Form1()
        {
        InitializeComponent();
        }

    private FilterInfoCollection webcam;
    private VideoCaptureDevice cam;
    private Bitmap bit = new Bitmap(640, 480);
    private Graphics g;
    private int cellsNumber;
    private int cellSize;

    private void Form1_Load(object sender, EventArgs e)
    {
        webcam = new FilterInfoCollection(FilterCategory.VideoInputDevice);
        foreach (FilterInfo VideoCaptureDevice in webcam)
        {
            comboBox1.Items.Add(VideoCaptureDevice.Name);
        }
        comboBox1.SelectedIndex = 0;

        cam = new VideoCaptureDevice(webcam[comboBox1.SelectedIndex].MonikerString);
        cam.NewFrame += new NewFrameEventHandler(cam_NewFrame);
        cam.Start();

    }

    void cam_NewFrame(object sender, NewFrameEventArgs eventArgs)
    {
        bit = (Bitmap)eventArgs.Frame.Clone();
        videoBox.Image = bit;
        g = Graphics.FromImage(videoBox.Image);
        Pen p = new Pen(Color.Black, 2);

        cellSize = 100;
        cellsNumber = 4;

        for (int y = 0; y <= cellsNumber; ++y)
        {
            g.DrawLine(p, 0, y * cellSize, cellsNumber * cellSize, y * cellSize);
        }

        for (int x = 0; x <= cellsNumber; ++x)
        {
            g.DrawLine(p, x * cellSize, 0, x * cellSize, cellsNumber * cellSize);
        }

    }

    private void button2_Click(object sender, EventArgs e)
    {
        saveFileDialog1.InitialDirectory = @"d:\picture";
        cam.Stop();
        if (saveFileDialog1.ShowDialog() == DialogResult.OK)
        {

            videoBox.Image.Save(saveFileDialog1.FileName);
            cam.Start();
        }

        else
            cam.Start();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:14:49.743

如果这没有帮助，您应该尝试使用

```
private object Lock = new object();

  lock (Lock) {

      using (var g = Graphics.FromImage(videoBox.Image) {  

        Pen p = new Pen(Color.Black, 2);

        cellSize = 100;
        cellsNumber = 4;

        for (int y = 0; y <= cellsNumber; ++y)
        {
            g.DrawLine(p, 0, y * cellSize, cellsNumber * cellSize, y * cellSize);
        }

        for (int x = 0; x <= cellsNumber; ++x)
        {
            g.DrawLine(p, x * cellSize, 0, x * cellSize, cellsNumber * cellSize);
        }

        g.Dispose();

     }        

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:04:32.543

这个异常与 ～Object 当前在别处使用有关。～ 可能是因为没有释放...

你应该试试：

```
 (...)

    for (int x = 0; x <= cellsNumber; ++x)
    {
        g.DrawLine(p, x * cellSize, 0, x * cellSize, cellsNumber * cellSize);
    }
    g.Dispose();

} 
```

# zend-framework - 在 Zend_Controller_Router_Route_Hostname 路由内部时，如何将 URL 组装回 www 路由？

> ID：14792384
> 
> 赞同：1
> 
> 时间：2013-02-09T22:34:38.890
> 
> 标签：zend-framework, zend-route

我花了几个小时试图找到解决方案，但似乎没有太多。

我目前`admin.domain.com`指向管理模块，它很容易这样做：

```
$adminRoute = new Zend_Controller_Router_Route_Hostname(
        'admin.domain.com', array(
            'module' => 'admin'
        )
    );
$router
    ->addRoute('admin', $adminRoute->chain(
        new Zend_Controller_Router_Route(
            ':controller/:action/*',
            array(
                'controller' => 'index',
                'action' => 'index'
            ))
    )); 
```

并且所有其他路由都将按照默认路由工作，因此`www.domain.com/module/controller`两者`www.domain.com/controller`都按预期工作。

但是，如果我当前在`admin`模块内部并且想要组装一个指向`www.domain.com`路由的 URL，那么如何做到这一点？

不幸的是，将默认路由设置为主机名路由并不是一个简单的案例，`www.domain.com`因为这样您就不会从路径中的“可选”模块参数中受益。例如

```
 $wwwRoute = new Zend_Controller_Router_Route_Hostname(
        'www.domain.com', array(
            'module' => 'default'
        )
    );
$router
    ->addRoute('default', $wwwRoute->chain(
        new Zend_Controller_Router_Route(
            ':module/:controller/:action/*',
            array(
                'controller' => 'index',
                'action' => 'index'
            ))
    )); 
```

将简单地以格式构建所有路径，`www.domain.com/default/controller/action`而不是`www.domain.com/controller/action`

文档建议使用默认路由，`Zend_Controller_Router_Route_Module`但我已经尝试过了，似乎还有更多。

有任何想法吗？

编辑：我怀疑您要么需要采取一种方式，要么需要采取另一种方式，即在子域上拥有所有模块，然后严格像这样路由请求`/controller/action/*`，或者将模块作为路由路径的一部分。否则，可以通过两个 URL 访问一个模块 -`module.domain.com`而且`www.domain.com/module`- 显然有办法解决这个问题，当然，您可以为每个模块设置特定的路由，从而不依赖默认 Zend 路由的“可选”模块特性。

# javascript - 使用选项执行一些Javascript onChange？

> ID：14792387
> 
> 赞同：0
> 
> 时间：2013-02-09T22:34:45.007
> 
> 标签：javascript, html, jsp, option, onchange

我一直在潜伏，找不到答案。基本上我有一堆按钮，我想把它们变成一个下拉菜单并执行代码`onChange`。但是，我是 javascript 的新手，我很难弄清楚它是如何工作的。我有点让它工作，但我无法让它与多个选项一起工作。这是我所拥有的：

```
<button class="lightbutton" onclick="lightswitch(1,true);lightswitch(2,true);lightswitch(3,true);">
All lights on</button> 
<button class="lightbutton" onclick="lightswitch(1,false);lightswitch(2,false);lightswitch(3,false);">
All lights off</button> 
```

我通过这样做来打开灯：

```
<form name="functions">
<select name="jumpmenu" onChange="lightswitch(1,true);lightswitch(2,true);lightswitch(3,true);">
<option>LightFunctions</option>
<option value="*";>Light 1 On</option>
<option value="*";>Light 1 Off</option>
</select>
</form> 
```

现在，我明白它为什么起作用了——它只是告诉它，每当它改变以打开所有灯时。但是如何更改“onChange”以使其获得我选择的任何选项？

我想我错过了一些 JS 但不确定。

我很感激帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:42:55.687

要让该选择元素控制第一个灯开关，您可以这样做：

```
<select name="jumpmenu" onChange="lightswitch(1,this.value==='on');">
<option value="on";>Light 1 On</option>
<option value="off";>Light 1 Off</option>
</select> 
```

也就是说，代替硬编码`true`作为第二个参数来`lightswitch()`测试选择元素的当前值。（请注意，我已将 value 属性更改为更有意义的内容。表达式`this.value==='on'`将评估为`true`or 或`false`。）

在 select 的`onChange`属性`this`中将引用 select 元素本身。

编辑：要让相同的选择控制多个参数，您可以`data-`向选项元素添加一些属性，以便根据需要为每个选项存储尽可能多的额外参数（在这种情况下，我认为您只需要一个额外的参数）。我会将逻辑移出内联属性：

```
<select name="jumpmenu" onChange="jumpChange(this);">
  <option value="">LightFunctions</option>
  <option data-switchNo="1" value="on";>Light 1 On</option>
  <option data-switchNo="1" value="off";>Light 1 Off</option>
  <option data-switchNo="2" value="on";>Light 2 On</option>
  <option data-switchNo="2" value="off";>Light 2 Off</option>
  <option data-switchNo="3" value="on";>Light 3 On</option>
  <option data-switchNo="3" value="off";>Light 3 Off</option>
</select>

function jumpChange(sel) {
   if (sel.value === "") return; // do nothing if user selected first option

   var whichLight = +sel.options[sel.selectedIndex].getAttribute("data-switchNo");
   lightswitch(whichLight, sel.value==='on');

   sel.value = ""; // reset select to display the "Light Functions" option
} 
```

演示：http: [//jsfiddle.net/N7b8j/2/](http://jsfiddle.net/N7b8j/2/)

在`jumpChange(sel)`我添加的函数中，参数`sel`将是选择元素（`this`从`onChange`属性中设置）。“魔法”发生在这一行：

```
var whichLight = +sel.options[sel.selectedIndex].getAttribute("data-switchNo"); 
```

解释该行：`sel.options[sel.selectedIndex]`获取对当前选定选项的引用，并`.getAttribute("data-switchNo")`获取该选项的`data-`属性。将`+`属性从字符串转换为数字。

# sorting - 需要帮助覆盖 compareTo

> ID：14792388
> 
> 赞同：0
> 
> 时间：2013-02-09T22:34:44.573
> 
> 标签：sorting, interface, comparable, compareto

我是一名 Java 新手，在覆盖 Comparable 接口中的 compareTo 方法时遇到了一些麻烦。我的代码创建了一个将字符串与 int 相关联的 HashMap。我想覆盖 compareTo 以便 ArrayList 键中的字符串根据它们的 HashMap 值排序，而不是按字母顺序排序。但是，在此实现下，字符串仍按字母顺序排序。

哦，澄清一下，nameWeight 是 String,Integer 对的 HashMap。

有任何想法吗？

```
List<String> keys = new ArrayList<String>(nameWeight.keySet());
System.out.println(keys);
Collections.sort(keys);

public int compareTo(String that){
    int gtr = 1;
    int less = -1;
    int eql = 0;
    System.out.print(this);
    System.out.print(that);
    if(that=="JOHN")
        return less;
    int valThis = nameWeight.get(this);
    int valThat = nameWeight.get(that);
    if(valThis==valThat)
        return eql;
    if(valThis>valThat)
        return gtr;
    if(valThis<valThat)
        return less;
    return gtr;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:41:18.777

您正在对字符串列表进行排序，因此`compareTo`调用的方法是在类`String`（或其超类）中定义的方法。由于您无法修改`String`，因此您必须创建 String 的子类，`compareTo`在该类中覆盖并使用`List<StringSubClass>`. 但是因为`String`是`final`不允许你继承它的子类（感谢@pst）。

或者，您不使用`String`列表中的对象，而是使用您创建和覆盖的类型的对象`compareTo`（不要忘记添加`implements Comparable`到类定义中）。

或者（再次来自@pst 的无耻插件），这可能是最好的解决方案，您将比较器传递给`sort`将用于对字符串进行排序而不是默认实现的函数。

# php - WordPress 一次循环查询和显示两种自定义帖子类型

> ID：14792389
> 
> 赞同：0
> 
> 时间：2013-02-09T22:34:45.627
> 
> 标签：php, wordpress

我创建了两种自定义帖子类型，每种类型都有几个类别。我需要运行一个查询，在标记的不同部分返回两种帖子类型的结果（“问题”、“解决方案”）。如果不重写依赖于每个“提示”的 ID 的大量 jquery，我就无法更改我的标记。我尝试了各种循环但没有成功。有人可以给我一些见解吗？WordPress循环如下：

```
<?php get_header(); ?>

<?php 
$args = array(
    'post_type' => array('problems', 'solutions'),
    'tax_query' => array(
        array(
            'taxonomy' => 'category',
            'field' => 'slug',
            'terms' => array('my-category')
        )
    )
);
$loop = new WP_Query( $args );
    $tipID = array('tip-1','tip2','tip-3','tip-4','tip-5');
$tipID_count = count($tipID);
$tipID_index = 0;
while($loop->have_posts()) : $loop->the_post();
?>

<div class="tooltip" <?php $k = $tipID_index % $tipID_count; echo "id=#$tipID[$k]"; $tipID_index++; ?>>
    <dl>
        <dt><a href="" class="imageText">1</a></dt>
<!--///////problems\\\\\\\-->
            <dd class="problem">
                <span class="close pull_right"><a href="" class="imageText">close</a></span>
                    ...do stuff
                <div class="tip-foot"></div>
            </dd>
<!--///////solutions\\\\\\\-->
            <dd class="solution">
                <span class="close pull_right"><a href="" class="imageText">close</a></span>
                    ...do stuff
                <div class="tip-foot"></div>
            </dd>

        </dl>
    </div>

<?php endwhile; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T01:04:26.290

您可以创建两个数组，一个 $problems_arr 和一个 $solutions_arr，并将问题帖子 ID 放在问题数组中，将解决方案帖子 ID 放在解决方案数组中。

此代码未经测试，但这是一个示例：

```
$problems_arr = array();
$solutions_arr = array();
while($loop->have_posts()) : $loop->the_post();
    if(get_post_type() == 'problems')
       array_push($problems_arr, get_the_ID());
    else
       array_push($solutions_arr, get_the_ID());
endwhile;
for(i = 0; i<count($problems_arr); i++){
?>
   <div class="tooltip" <?php $k = $tipID_index % $tipID_count; echo "id=#$tipID[$k]"; $tipID_index++; ?>> 
```

您可以使用帖子 ID 显示帖子的内容，例如：

echo apply_filters ('the_content', get_post_field ('post_content', $problems_arr[i]))

您不想将帖子内容保存在数组中，因为它会占用大量内存，因此只需存储帖子 ID。

# php - 如果输入字段不为空，则返回错误

> ID：14792392
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:35:22.887
> 
> 标签：php

我的联系表格中有此代码：

```
$bots = $_POST['bots'];
        if ($bots == '')
            fatal_error($txt['contact_bot_error'], false); 
```

我想做的是，让它做相反的事情。如果输入不为空，则返回错误。

我做到了，有一个问题“1 + 1 是什么？” 并为其输入字段，并为其设置“display：none”样式。所以只有机器人才能看到它。因此，如果他们在其中放入任何内容，我希望它返回错误。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:38:19.953

```
$bots = $_POST['bots'];

if ( empty( $bots ) === false )
{
   fatal_error($txt['contact_bot_error'], false);
} 
```

`empty()`完全满足您的需求。它检查传递的字符串以查看它是否为空（的值`''`）。如果是，则返回`true`，`false`如果不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:39:09.343

你不能用`isset`吗？

```
if (isset($_POST['bots'])) {
  fatal_error($txt['contact_bot_error'], false);
} 
```

# python - Y通道的高斯模糊图像直方图

> ID：14792397
> 
> 赞同：1
> 
> 时间：2013-02-09T22:36:55.567
> 
> 标签：python, opencv, numpy, matplotlib, computer-vision

我是计算机视觉和图像处理的新手，无论如何我正在尝试计算图像 y_channel 的直方图，该直方图之前已经用 cv2.GaussianBlur 模糊并从 BGR 转换为 YCr-cb 颜色空间。然而，最终结果并不完全符合我的预期，它似乎没有典型的高斯分布外观。以下是我的形象和情节。

![人脸图像](../Images/79922bec550d9119db7421dab5151cc5.png)

![直方图](../Images/b0c8ce9b32e9c1c320a1e0977a4840cb.png)

这是代码片段。

```
 cv2.imwrite("/home/carlo/face.png", roi2)    
    img = cv2.imread('/home/carlo/face.png')
    yuma = cv2.split(img)[0]
    Hist = yuma.flatten().tolist()
    grayscales  = np.unique(Hist)
    frequencies = [Hist.count(x) for x in grayscales]
    plt.figure()
    plt.bar(grayscales,frequencies,color='g',edgecolor='k')
    plt.show() 
```

谁能告诉我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T01:45:46.567

正如@tcaswell 向我建议的那样，这实际上是一个与明亮照明有关的问题。在不同条件下，Y 直方图看起来很像高斯直方图。

# php - 返回 PHP 数组中每个日期的报告

> ID：14792401
> 
> 赞同：2
> 
> 时间：2013-02-09T22:37:49.807
> 
> 标签：php, mysql, sql, date

我在这里尝试做的是从 MYSQL 表中为当前月份的每个日期呈现报告。

我有一个表，其中很多行具有相同的**date**。正如你在这里看到的![我的 MYSQL 表中包含重复日期的行](../Images/f1f62a883d152726fab354bc9e1150d8.png)

**对于当前月份**的每个日期，我想做的是查看在该日期的 MYSQL 表中找到了多少行，然后将其返回到数组中。最终产品将是当月每个日期的多维数组。像这样的东西

```
array("dates"=>
array(
"1 feb"=>2, //the number of rows for that date found in the MYSQL table
"2 feb"=>8,
"3 feb"=>0
)
) 
```

但问题是我不知道从哪里开始编码，比如我会使用什么 PHP 函数？所以我希望有人能把我推向正确的方向:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:43:22.520

可能无法正常工作的代码，但应该指出你正确的方向：

```
SELECT 
    SUM(money) AS sum,
    `date`
FROM 
    money_table
WHERE
    MONTH(`date`) = 2
GROUP BY 
    DAY(`date`) 
```

**参考**

*   [`GROUP BY`](http://www.tizag.com/mysqlTutorial/mysqlgroupby.php)
*   [`MONTH`](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month)
*   [`DAY`](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_day)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-09T23:21:38.513

你说你没有一张包含所有日期的表格。如果你这样做了，这将是微不足道的。假设您有一个称为日历的表。

```
select calendardate
, ifnull(sum(money), 0) sum_of_money
from calendar left join money on calendardate = money.date
where calendardate >= {d '2013-02-01'}
and calendardate < {d '2013-03-01'}
group by calendardate 
```

可以存储在日历表中的其他内容是财务信息和假期。创建和维护一个可能值得您花时间。

# php - preg_replace 除非字符串存在

> ID：14792402
> 
> 赞同：0
> 
> 时间：2013-02-09T22:37:57.317
> 
> 标签：php, regex

我正在尝试将 CSS 样式添加到所有超链接*，除非*它具有“donttouch”属性。

例如

*   风格这个：`<a href="http://whatever.com">style me</a>`
*   不要这样设计：`<a href="http://whatever.com" donttouch>don't style me</a>`

这是我的 preg_replace 没有“donttouch”排除，它工作正常。

```
preg_replace('/<a(.*?)href="([^"]*)"(.*?)>(.*?)<\/a>/','<a$1href="$2"$3><span style="color:%link_color%; text-decoration:underline;">$4</span></a>', $this->html) 
```

我已经到处找了，希望有任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:26:47.107

这可以在没有正则表达式的情况下完成。相反，使用 CSS 属性选择器。

例如，使用以下规则：

```
a { font-weight: bold; color: green }
a[donttouch=''] { font-weight: normal; color: blue } 
```

从技术上讲，您正在使用“donttouch”属性设置元素的样式，但您可以使用默认值。这将比尝试使用正则表达式来解析 HTML 更有效，这通常是一个坏主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:11:55.093

查找（也适用于 Notepad++）

```
(?s)(<a (?:(?!donttouch)[^>])+>)(.*?)</a> 
```

替换为（在 Notepad++ 中全部替换）：

```
\1<span style="whatever">\2</span></a> 
```

# php - if(!$pages) 如果不是 $pages 我不明白

> ID：14792404
> 
> 赞同：0
> 
> 时间：2013-02-09T22:38:03.473
> 
> 标签：php, function

下面是分页函数中的以下代码，我试图理解我不明白的部分`if(!pages){ $pages =1)}` 是他们指的是什么。如果什么不是 $pages 变量。我想说的是要比较的 Pages 变量是什么，如果不是什么。我很困惑

```
if($pages == '')
     {
         global $wp_query;
         $pages = $wp_query->max_num_pages;
         if(!$pages)
         {
             $pages = 1;
         }
     } 
```

这是完整的功能，我试图逐个理解它，以便我可以重写而无需分页中的数字只有左右。

```
function kriesi_pagination($pages = '', $range = 2)
{  
     $showitems = ($range * 2)+1;  

     global $paged;
     if(empty($paged)) $paged = 1;

     if($pages == '')
     {
         global $wp_query;
         $pages = $wp_query->max_num_pages;
         if(!$pages)
         {
             $pages = 1;
         }
     }   

     if(1 != $pages)
     {
         echo "<div class='pagination'>";
         if($paged > 2 && $paged > $range+1 && $showitems < $pages) echo "<a href='".get_pagenum_link(1)."'>&laquo;</a>";
         if($paged > 1 && $showitems < $pages) echo "<a href='".get_pagenum_link($paged - 1)."'>&lsaquo;</a>";

         for ($i=1; $i <= $pages; $i++)
         {
             if (1 != $pages &&( !($i >= $paged+$range+1 || $i <= $paged-$range-1) || $pages <= $showitems ))
             {
                 echo ($paged == $i)? "<span class='current'>".$i."</span>":"<a href='".get_pagenum_link($i)."' class='inactive' >".$i."</a>";
             }
         }

         if ($paged < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($paged + 1)."'>&rsaquo;</a>";  
         if ($paged < $pages-1 &&  $paged+$range-1 < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($pages)."'>&raquo;</a>";
         echo "</div>\n";
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:57:43.490

> 如果什么不是页面，则 if 语句中的代码很有趣。

您的代码“全球化”了`$wp_query`对象，以便在函数范围内可以访问它。然后设置`$pages`为`$wp_query->max_num_pages`。然后检查该值以确定是否执行`if`. 它的工作原理有点棘手，但你去吧。

[PHP 认为有几件事是`FALSE`](http://php.net/manual/en/language.types.boolean.php)

*   布尔值 FALSE 本身
*   整数 0（零）
*   浮点数 0.0（零）
*   空字符串和字符串“0”
*   一个元素为零的数组
*   具有零成员变量的对象（仅限 PHP 4）
*   特殊类型 NULL（包括未设置的变量）
*   从空标签创建的 SimpleXML 对象

如果这些匹配都不为`$pages`真，这通常会触发`if`执行，但匹配会与`!`. 因此，如果`$pages`设置为某个真值，则`if`条件是`false`并且`if`不运行 - 不理会`$pages`。如果`$pages`设置为某个`false`值，则`if`条件为`true`，它会执行，并且 pages 设置为 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T23:12:38.043

这有几个部分：

*   `True`并且`False`是可以保存在变量中的值。这种类型的值称为布尔值。而不是`if ($a == $b) { ... }`你可以说`$c = ($a == $b);`，然后再做`if ($c) { ... }`。这种布尔概念对于大多数（如果不是所有）编程语言都是通用的。
*   在 PHP 中（但不是在所有语言中），如果您将非布尔变量视为布尔变量（例如，通过使用 测试它`if`，或将其与`and`or组合`or`）它不会是错误，并且变量将得到使用某些规则转换。基本上大多数东西都转换为真（它们是“真”），除了 0、NULL、空数组、空字符串和其他一些东西，它们会转换为假（它们是“假的”）。

因此，`if (!$pages) { $pages = 1; }`在您的示例中，如果页数为零，请确保至少有一个。这是一种较短的说法`if ($pages == 0)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T22:53:05.153

条件检查是否`$pages`为`0`。布尔值`true`和`false`通常由二进制文件`1`和`0`分别定义。因此，`if(!$pages)`意味着“如果 的值`$pages`评估为`false`（或`0`），则执行条件体并设置`$pages`为`1`”。相反，`if($pages)`将意味着`execute the condition body if $pages > 0`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T22:53:12.910

我不确定这是什么语言，但它应该清楚地定义什么算作“真”和“假”，其中需要布尔表达式。例如，在 C 中，任何非零整数值都是“真”；其他任何东西都是“假的”。一些语言还将定义哪些字符串值被认为是“真”或“假”。这正是代码中的 if 语句正在做的事情。

# python - 来自 PIL.Image.open 的 PIL 图像和 NumPy 图像 matplotlib.image.imread 有什么区别？

> ID：14792406
> 
> 赞同：0
> 
> 时间：2013-02-09T22:38:04.550
> 
> 标签：python, matplotlib, python-imaging-library

我想知道为什么我应该或不应该在 PIL 图像上使用 matplotlib 图像。我知道 matplotlib 使用 PIL 加载任何不是 PNG 的图像，但是将它放在一个 numpy 数组中而不是 PIL 后端表示有什么优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:11:03.317

PIL API 包括用于执行[各种图像处理](http://www.pythonware.com/library/pil/handbook/imageops.htm)的函数。但当然，它并没有为所有可能的操作提供功能。当您要对未内置在 PIL API 中的图像执行数学运算时，Numpy 很有用。PIL 有一种逐个[更改像素的方法，但是因为如果它依赖 Python 循环，则它可能是一种处理大图像（或许多图像）的非常慢的方法。](http://www.pythonware.com/library/pil/handbook/image.htm#putpixel)

Numpy 数学相对较快，并且它具有表达性语法，可以使编码新的图像操作更容易。此外，scipy 有许多额外的[图像处理功能](http://docs.scipy.org/doc/scipy/reference/ndimage.html)，可以应用于 numpy 数组。

这里有一些例子：

*   [浮雕](https://stackoverflow.com/a/2034258/190597)
*   [rgb转hsv](https://stackoverflow.com/a/7274986/190597)
*   [替换颜色](https://stackoverflow.com/a/5536415/190597)

# excel - 如何使用 VBA 2003 从 Excel 工作表中动态读取数据

> ID：14792414
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:38:38.963
> 
> 标签：excel, ms-access, vba

我是 vba 编程的新手，因此我需要您的专家帮助，以便能够使用 VBA 2003 将以下 excel 表中的所有值读取到 ADODB 记录集对象中

![在此处输入图像描述](../Images/bcd1043b5318ee17552e44c086d0d0f5.png) 记录集将按如下方式填充

```
 'Create new recordset with the following fields
        Dim rsData as new ADODB.Recordset
        rsData.Fields.Append "Month", adVarChar, 20
        rsData.Fields.Append "Product", adVarChar, 20
        rsData.Fields.Append "Type", adVarChar, 50
        rsData.Fields.Append "Value", adVarChar, 50
        rsData.Open

    'for each row in spreadsheet read the following info
       rsData.Addnew
            rsData.Fields("Month") = 'value from row 2 Jan followed by data below
            rsData.Fields("Product") = "Color" ' Value from B5
            rsData.Fields("Type") = "MK1" ' value from C5
            rsData.Fields("Value") = "111=" ' value from D6

'Now move to next set of values for Feb

    rsData.Addnew
            rsData.Fields("Month") = 'value from row 2 FEB
            rsData.Fields("Product") = "Shade" ' Value from F5
            rsData.Fields("Type") = "AB2" ' value from G5
            rsData.Fields("Value") = "345=ABX" ' value from H5

    'Now move to next set of values for Mar
    rsData.Addnew
            rsData.Fields("Month") = 'value from row 2 MAR
            rsData.Fields("Product") = "Color" ' Value from F5
            rsData.Fields("Type") = "3FG" ' value from G5
            rsData.Fields("Value") = "PLZ" ' value from H5

    'Now move to next row
 rsData.Addnew
            rsData.Fields("Month") = 'value from row 2 Jan
            rsData.Fields("Product") = "Color" ' Value from F5
            rsData.Fields("Type") = "MK2" ' value from C6
            rsData.Fields("Value") = "234=BZX" ' value from D6

...and so on 
```

请注意，**数据可能会移动，但整体布局将保持不变。

从下图中可以看出。顺序已更改：一月、三月、二月**

![在此处输入图像描述](../Images/796f882475b90bcd3b852f2533c35f50.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T08:07:55.943

您的问题实际上不是 Excel 的 VBA，问题在于那是一个垃圾数据源。如果这些块可以四处移动并按任何顺序排列，那么您真的没有简单的方法来判断它们将在哪里以及其中有多少数据。在这种情况下，您最好提出以下问题：

*   源数据是否需要采用这种格式；和
*   有没有办法让我们做得更好？

（“更好”=更有条理，更可预测。）

此外，您在每一行都是记录方面考虑得太多。每个块都与其他块完全分开，并且由于每个块都有一个唯一的“标题记录”（即月份），我倾向于依次处理每个块，而不是像您的示例代码尝试那样尝试从一个块跳到另一个块去做。

以下内容应该为您提供足够的基础，以便您能够浏览 Excel 工作表。这只是我快速拼凑起来的东西，虽然我确实在你的第二张插图中用一张纸的模型对其进行了测试，但它确实有效。这应该足以帮助您走上正确的道路，但我再次强调……您所拥有的并不是真正的数据源。这是一个需要几乎任意解析的报告。在你做任何事情之前，你需要看看是否可以解决这个问题。

```
Sub DemonstrateReadingFromExcel()

'Every cell in Excel is a range.
'A range can also be a collection of cells.
'Ranges have properties that you can query. More importantly
'you can redefine a range by offsetting it from
'your current range, which makes it easy to step through a block.
Dim rng_Month As Excel.Range
Dim rng_Data As Excel.Range

'Let's define some string variables that you can use to assign
'to your recordset's fields.
Dim s_Month As String
Dim s_Product As String
Dim s_Type As String
Dim s_Value As String

Dim l_RowCurrent As Long
Dim l_RowLastType As Long

Dim l_ColumnOfMonth As Long

'We have to start with the cell containing the month.
'Rather than reading row by row, you'd be better off
'reading a whole block at a time.

'Your big problem will be telling WHERE the cell containing
'that month is and for that reason I think you need to seriously
'look at WHY the data is in the format that it is and whether
'you can actually use a much more structured data source.

'For now though let's pretend that you have some magic way of knowing
'where the range is and assign it to a range variable.

'ActiveSheet is a reference to the active worksheet but just as you
'can use a range variable to store a reference to a range,
'you can use a worksheet variable to store a reference to a worksheet
'(even one which is not the active sheet) if you want to.
'I'm only using ActiveSheet for convenience.

'You need to use the Set statement because you're assigning an object.

Set rng_Month = ActiveSheet.Range("C2")

'Ranges have properties like their column number.
'We already know the column number for this range but let's
'assume that we don't in a more general solution.

l_ColumnOfMonth = rng_Month.Column

'Now let's check that the range is valid.
'Don't worry about what the number means,
'just look at the error description.
'If this is True then there must be something wrong with the range.

If l_ColumnOfMonth < 2 Then
    Err.Raise vbObjectError + 20000, , "There are no columns to the left of the month. " _
     & "The range is invalid."
End If

'Now let's find out where the last Type entry occurs in the current
'block. We go up from the bottom of the column to do that.

'In this case we're passing the row and column to the Cells
'property. This defines a range for us representing the bottom
'of the Type column. Using End(xlUp) is the same as pressing the
'[End] key then the [Up arrow] key. It takes us to the last
'populated row, which we read the .Row property of.

l_RowLastType = ActiveSheet.Cells( _
 ActiveSheet.Rows.Count, l_ColumnOfMonth).End(xlUp).Row

'If this is the same as the Month's own row, there's no data
'in that block.

If l_RowLastType = rng_Month.Row Then
    Err.Raise vbObjectError + 20000, , "There are no Type entries in this block. "
End If

'So we've checked that the range looks OK.
'Before we proceed, let's store the month for this block.
'We just get the Value property of the range.
s_Month = rng_Month.Value

'We know that the first product should be 3 rows down and
'one row to the left of the month, so let's just keep looping
'through and reading the values for each row in the block
'until we reach the end of it. We know the end because
'we have its row stored in the l_RowLastType variable.

Set rng_Data = rng_Month.Offset(3, -1)

'Let's get the name of the first product.
s_Product = rng_Data.Value

'If that's nothing, there's a problem.
If s_Product = "" Then
    Err.Raise vbObjectError + 20000, , "No valid product in the expected location. "
End If

'Now let's loop through each row.
For l_RowCurrent = rng_Month.Row + 3 To l_RowLastType

    'Let's look at another way that we can get a reference to
    'a range; by using the Cells property of the sheet.
    'For that we specify the row number and column number.

    Set rng_Data = ActiveSheet.Cells(l_RowCurrent, rng_Month.Column - 1)

    'We know that there won't be a product on each row,
    'so if there isn't one we just use the previous one.
    'Otherwise we assign the new product.

    If rng_Data.Value <> "" Then
        s_Product = rng_Data.Value
    End If

    'Now let's get the type, which is offset 0 rows, 1 column
    'to the right of the product.
    s_Type = rng_Data.Offset(0, 1)

    'If that's a blank cell (like row 8 in your
    'second example we won't do anything else.
    'We only proceed if it's populated.

    If s_Type <> "" Then
        s_Value = rng_Data.Offset(0, 2)

        'Now at this point you have gathered all of your values
        'into variables, and can feed them to your recordset.
        'In this case though we'll just output
        'a messagebox.

        MsgBox "Row " & rng_Data.Row & " is for month " & s_Month _
         & ", product " & s_Product & ", Type " & s_Type _
         & ", Value " & s_Value

    End If

Next

ExitPoint:

On Error Resume Next
Set rng_Month = Nothing
On Error GoTo 0

Exit Sub

ErrorHandler:

MsgBox "Error " & Err.Number & vbCrLf & Err.Description

Resume ExitPoint

End Sub 
```

# php - 使用 Zend2 读取/写入配置的模块化方式

> ID：14792415
> 
> 赞同：1
> 
> 时间：2013-02-09T22:38:42.220
> 
> 标签：php, zend-framework2, zend-config

我想在我的模块中有一堆设置，它们应该可以从应用程序中写入。由于它们是应用程序设置，我认为它的表格效率不高（它只有一行）。

我找到了 Zend 模块[`Zend\Config`](http://framework.zend.com/manual/2.1/en/modules/zend.config.introduction.html)，它似乎可以编写配置文件，而 Zend 又可以使用它。

建议写入`module.config.php`? 还是放到不同的文件中？我还能将它加载到标准模块配置中吗？

我对 Zend 和这种完全模块化的方法很陌生，所以我想对此进行一些澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T14:00:04.410

您永远不应该写入模块目录本身。取而代之的是，有一个数据目录，例如在您的应用程序的根目录，并将编写的配置文件放在那里。

# linux - 循环输入中有多个变量？

> ID：14792422
> 
> 赞同：0
> 
> 时间：2013-02-09T22:39:13.207
> 
> 标签：linux, bash, shell

使用以下内容时：

```
for what in $@; do
read -p "Where?" where
grep -H "$what" $where -R | cut -d: -f1 
```

在调用脚本时，如何不使用 read 来定义用户变量，而是将第二个变量输入与第一个变量一起输入。

例如，我相信我能得到的理想用法是：

```
sh scriptname var1 var2 
```

但我的理解是 for... 行用于将后续的整体循环到一个变量中；我需要改变什么来输入多个变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:43:55.497

`$1` `$2`您可以使用等获取在命令行上传递的参数。

阅读位置参数：[http](http://www.linuxcommand.org/wss0130.php) ://www.linuxcommand.org/wss0130.php 。您不需要 for 循环来解析它们。

```
sh scriptname var1 var2

v1=$1 # contains var1
v2=$2 # contains var1 
```

`$@`基本上只是所有位置参数的列表：`$1 $2 $3`等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:58:40.750

顺便说一句：使用`| cut -D: -f1`是不安全的，因为 grep 不会转义文件名中的冒号。要明白我的意思，你可以试试这个：

```
ghoti@pc:~$ echo bar:baz > foo
ghoti@pc:~$ echo baz > foo:bar
ghoti@pc:~$ grep -Hr ba .
./foo:bar:baz
./foo:bar:baz 
```

清晰度..没有。

所以......让我们澄清你在寻找什么。

1.  您想在多个文件中搜索一个字符串吗？或者，
2.  您想在一个文件中搜索多个字符串吗？

如果是前者，那么以下可能有效：

```
#!/bin/bash

if [[ "$#" -lt 2 ]]; then
  echo "Usage: `basename $0` string file [file ...]
  exit 1
fi

what="$1"
shift        # discard $1, move $2 to $1, $3 to $2, etc.

for where in "$@"; do
  grep -HlR "$what" "$where" -R
done 
```

如果是后者，那么就是这样：

```
#!/bin/bash

if [[ "$#" -lt 2 ]]; then
  echo "Usage: `basename $0` file  string [string ...]
  exit 1
fi

where="$1"
shift

for what in "$@"; do
  grep -lR "$what" "$where"
done 
```

当然，如果你用一个或小节连接你的字符串，然后使用 egrep，这个可能会被简化。取决于你真正在寻找什么。

# variables - 读取 NASM 中的输入，并将其全部存储到变量中

> ID：14792424
> 
> 赞同：0
> 
> 时间：2013-02-09T22:39:17.030
> 
> 标签：variables, assembly, input, store

我可以通过什么方法读取用户的输入，比如输入是“500”然后将这个数字存储在一个变量中？

我知道的唯一方法是逐个字符地存储它们，可能需要寄存器偏移量。

有没有其他方法，最好直接存储号码？

即类似的东西：

`mov var1, inbuffer`

环境详情： `32 bit Assembly w/ DGJPP`

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T01:04:16.647

啊……DJGPP，我猜是这样。查看 int 21h/0Ah (0Ah in `ah`)。或者您可能会更好地使用标准输入上的 readfile 子功能（3Fh ???）。在 Ralf Brown 的中断列表中查找它。

在任何情况下，您将得到的是字符 '5'、'0' 和 '0' - 35h、30h、30h。需要一些处理才能从中获得数字 500。如果您从左到右读取数字，请将寄存器归零以用作“到目前为止的结果”。从输入缓冲区中读取一个字符。如果它是有效的十进制数字，减去“0”以将字符转换为数字，将“到目前为止的结果”乘以 10，然后添加新数字。重复直到你用完字符。

# multithreading - 映射用户级线程和内核级线程

> ID：14792428
> 
> 赞同：2
> 
> 时间：2013-02-09T22:39:48.700
> 
> 标签：multithreading, operating-system

用户级线程如何映射到内核级线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:46:25.687

It varies by implementation. The three most common threading models are:

1.  1-to-1: Each user-level thread has a corresponding entity that is scheduled by the kernel.

2.  n-to-1: Each process is scheduled by the kernel. Thread scheduling takes place entirely in user space.

3.  n-to-m: Each process has a pool of entities that are scheduled by the kernel. These are assigned to run particular user-level threads by a user-space scheduler that is part of the process.

Modern implementations are almost all 1-to-1.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T06:40:30.713

用于指代 ULT 和 KLT 的术语有些混乱。以下是两种不同的解释。如果我错了，请纠正我：

1.  KLT 需要在内核中实现并发（注意将内核解释为进程或活动实体）。对于像 Symbian 这样的微内核来说也是如此，其中内核线程负责系统的每个硬件资源（例如文件服务器、位置服务器、日历服务器等）。然而，在像 Linux 这样的内核中，它主要是一个库（而不是一个进程或一个独立的生命实体），内核线程实际上没有任何意义。在 Linux 中，您创建的每个线程都被内核视为一个进程，并且内核始终在进程上下文或中断上下文中运行。

2.  第二种解释是基于线程（或并发）是否对内核可见。例如，使用 setjmp、longjmp 可以在用户空间实现并发。就像已经讨论过的那样，内核完全没有意识到这一点。这种并发性可以称为 ULT。并且内核知道其创建的线程（使用 Clone() 系统调用的线程）可以称为 KLT。

# javascript - 使用 Javascript 中的用户输入动态更改表格单元格

> ID：14792431
> 
> 赞同：5
> 
> 时间：2013-02-09T22:39:52.580
> 
> 标签：javascript, input, dynamic, html-table, cell

这就是我想要做的：我有一个表格，由 Javascript 创建，每个单元格都有用户输入。此表只是为了确认用户输入的数据是正确的。如果用户看到错误，他们单击需要编辑的单元格，然后在表格单元格中放置一个带有当前单元格数据的文本框。然后，如果用户单击了错误的单元格，则用户将能够提交更改或放弃更改。这是我目前拥有的：

```
 <table id = "confirm">
      <tr><th>Firstname</th><td id = "txtFirstname" onclick = "update(this.id)">Adan</td></tr>
      <tr><th>Lastname</th><td>Smith</td></tr>
      <tr><th>Username</th><td>ASmith</td></tr>
      <tr><th>Email</th><td>abc@123.com</td></tr>
      <tr><th>Phone</th><td>123-456-7890</td></tr>
    </table>

<script type = "text/javascript">
  function update(id){
    //Get contents off cell clicked
    var content = document.getElementById(id).firstChild.nodeValue;
    //Switch to text input field
    document.getElementById(id).innerHTML = "<input type = 'text' name = 'txtNewInput' id = 'txtNewInput' value = '" + content + "'/>";
  }
</script> 
```

这就是我当前的代码所做的：当用户单击单元格时，它会将其替换为文本框中的当前文本，这很棒，但是当您尝试编辑文本时，它会再次调用该函数，将文本替换为“空值”。请帮我解决这个问题！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-09T22:44:53.363

它是由[事件冒泡](http://www.quirksmode.org/js/events_order.html)引起的。您不想`onclick`申请`input`，但不幸的是，情况并非如此。要解决这个问题，只需这样做（取自[http://jsfiddle.net/DerekL/McJ4s/](http://jsfiddle.net/DerekL/McJ4s/)）

```
table td, th{
    border: 1px solid black;
}
```

```
<table id="confirm">
    <tr>
        <th>Firstname</th>
        <td contentEditable>Adan</td>
    </tr>
    <tr>
        <th>Lastname</th>
        <td>Smith</td>
    </tr>
    <tr>
        <th>Username</th>
        <td>ASmith</td>
    </tr>
    <tr>
        <th>Email</th>
        <td>abc@123.com</td>
    </tr>
    <tr>
        <th>Phone</th>
        <td>123-456-7890</td>
    </tr>
</table>
```

[当简单的 HTML](https://developer.mozilla.org/en-US/docs/HTML/Content_Editable)可以做同样的事情时，为什么用 JavaScript来做呢？`;)`

* * *

# IE浏览器：

IE 中有一个奇怪的“错误”，它不允许表格单元格可编辑^([（为什么，微软？）])所以你必须用一个`<div>`（取自[http://jsfiddle.net/DerekL/McJ4s /3/](http://jsfiddle.net/DerekL/McJ4s/3/) ):

```
table td,
th {
  border: 1px solid black;
}
```

```
<table id="confirm">
  <tr>
    <th>Firstname</th>
    <td>
      <div contenteditable>Adan</div>
    </td>
  </tr>
  <tr>
    <th>Lastname</th>
    <td>Smith</td>
  </tr>
  <tr>
    <th>Username</th>
    <td>ASmith</td>
  </tr>
  <tr>
    <th>Email</th>
    <td>abc@123.com</td>
  </tr>
  <tr>
    <th>Phone</th>
    <td>123-456-7890</td>
  </tr>
</table>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:41:44.237

> ```
> <table id = "confirm">
>       <tr><th>Firstname</th><td id = "txtFirstname" onclick = "update(this.id)">Adan</td></tr>
>       <tr><th>Lastname</th><td>Smith</td></tr>
>       <tr><th>Username</th><td>ASmith</td></tr>
>       <tr><th>Email</th><td>abc@123.com</td></tr>
>       <tr><th>Phone</th><td>123-456-7890</td></tr>
>     </table>
> 
> <script type = "text/javascript">
>   function update(id){
>     //Get contents off cell clicked
>     var content = document.getElementById(id).firstChild.nodeValue;
>     //Switch to text input field
>     document.getElementById(id).innerHTML = "<input type = 'text' name = 'txtNewInput' id = 'txtNewInput' value = '" + content + "'/>";
>   }
> </script> 
> ```

在 update() 函数中添加了 if 语句。将其更改为：

```
<script type = "text/javascript">
  function update(id){
    if(document.getElementById(id).firstChild != "[object HTMLInputElement]"){
      //Get contents off cell clicked
      var content = document.getElementById(id).firstChild.nodeValue;
      //Switch to text input field
      document.getElementById(id).innerHTML = "<input type = 'text' name = 'txtNewInput' id = 'txtNewInput' value = '" + content + "'/>";
    }
  }
</script> 
```

这就像一个魅力！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T09:05:14.517

```
 var table = document.getElementById('');
    var rowCount = table.rows.length;
    var noRowSelected = 1;
    for(var i=1; i<rowCount; i++) {
            var row = table.rows[i];
            var chkbox = row.cells[0].childNodes[0];
            if(null != chkbox && true == chkbox.checked) {
                if(rowCount <= 1) {
                   break;
                }
                document.getElementById("").value = row.cells[1].innerHTML;
                document.getElementById("").value = row.cells[2].innerHTML;
                document.getElementById("").value = row.cells[3].innerHTML;
                document.getElementById("").value = row.cells[4].innerHTML;
           }
       }

  The Above Example the checkbox must be need for the each row.then we used this check box to get the current edit row values in the dynamic table. then to use the id for edit field to set valued got from the table. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-26T09:10:29.867

**动态更改表格行值：**

var table = document.getElementById('');

```
var rowCount = table.rows.length;

var noRowSelected = 1;

for(var i=1; i<rowCount; i++) {
        var row = table.rows[i];
        var chkbox = row.cells[0].childNodes[0];
        if(null != chkbox && true == chkbox.checked) {
            if(rowCount <= 1) {
               break;
            }
            document.getElementById("").value = row.cells[1].innerHTML;
            document.getElementById("").value = row.cells[2].innerHTML;
            document.getElementById("").value = row.cells[3].innerHTML;
            document.getElementById("").value = row.cells[4].innerHTML;
       }
   } 
```

上述示例中的每一行都必须有复选框。然后我们使用此复选框来获取动态表中的当前编辑行值。

# r - 使用 ggplot2 和 faceting 将每年绘制为单独的系列

> ID：14792432
> 
> 赞同：2
> 
> 时间：2013-02-09T22:39:53.740
> 
> 标签：r, ggplot2

我有从 2001 年到 2009 年的九条河流的数据。我想创建九个方面的图表，每个方面我希望每年有九条线。x 轴是从 1 月到 12 月。到目前为止，我已经想到了这个：

我使用的代码如下：

```
testseries<- read.csv("testseries.csv")
meltedtestseries <- melt(testseries,id=c("date"))
head(meltedtestseries)
ggplot(meltedtestseries,aes(x=date,y=value))+geom_line()+facet_wrap(~variable,scales="free")+xlab("Date")+ylab("Discharge(cms)") 
```

我得到的图表如下： ![在此处输入图像描述](../Images/2b9ce1653ade975a6b471eaf9c46b709.png)

现在，我想以 Months 为单位更改 X 轴，并为每个方面绘制每年的九条曲线。我知道我需要更改 color=year 或类似的东西。但它没有成功。非常感谢任何帮助。谢谢。

该数据集可在[https://www.dropbox.com/s/ykhu8vc9211xtzu/testseries.csv上找到](https://www.dropbox.com/s/ykhu8vc9211xtzu/testseries.csv)

贾巴巴

**编辑：额外信息**

我也试过这段代码：

```
ggplot(meltedtestseries,aes(x=as.Date(date),y=value,color=date))+geom_line()+facet_wrap(~variable,scales="free")+xlab("Date")+ylab("Discharge(cms)") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:11:28.040

我认为你缺少的是一个分组`year`。假设你`data.frame`是`df`，

```
require(ggplot2)
require(reshape2)
df1 <- read.csv("~/Downloads/testseries.csv")
df <- melt(df1,id=c("date"))
df$date <- as.Date(df$date)

# get `year` first
# df$year <- as.POSIXlt(df$date)$year + 1900 (old code)
# df$year <- format(df$date,'%Y') # following @agstudy's comment.
p <- ggplot(data = df, aes(x=date, y=value))
# group/colour by year
p <- p + geom_line(aes(colour=factor(year))) 
p <- p + scale_colour_brewer(palette="Set3") 
p <- p + facet_wrap(~ variable, scales="free", ncol=3)
p <- p + xlab("Date") + ylab("Discharge(cms)")
p 
```

这给出了：

![ggplot2_facet](../Images/9ab02a00299dc64440ce37c403246287.png)

**编辑 2：**如果这不是您想要的，那么您可能需要使用 2 个变量进行分面`facet_grid`，如下所示：

```
df$year <- factor(as.POSIXlt(df$date)$year + 1900)
p <- ggplot(data = df, aes(x=date, y=value))
p <- p + geom_line() 
p <- p + facet_grid(variable ~ year)
p <- p + xlab("Date") + ylab("Discharge(cms)")
p 
```

给出一个密集图：

![ggplot2_facet_grid_dense](../Images/eef46a12bba76895f61d2d91aa2a3df6.png)

# xml - Perl XML::LibXML 更新内容

> ID：14792443
> 
> 赞同：1
> 
> 时间：2013-02-09T22:41:01.820
> 
> 标签：xml, perl, xml-libxml

我正在尝试更新 xml 元素的内容。我正在使用 XML::LibXML 并且需要使用这个库。这是一些示例数据。

```
<data-table>
   <data>
      <number>1</number>
      <letter>one</letter>
   </data>
   <data>
      <number>2</number>
      <letter>two</letter>
   </data>
</data-table> 
```

如果数字为 2，我想做的是将字母的内容更改为“紫色”。但是我相信我在指定 Xpath 以使其工作时遇到问题。我收到以下错误

“无法通过包“XML::LibXML::NodeList”定位对象方法“setData”

我已经为此苦苦挣扎了好几天，因此非常感谢任何帮助。

```
 use XML::LibXML;
    my $p = XML::LibXML->new;
    my $d = $p->parse_fh(\*DATA);
    for my $node ($d->findnodes('//data-table/data')) 
    { 
       for my $childNode ($node->findnodes('./number/text()'))
       {
          if($childNode->textContent() == '1')
          { # here is where the problem is!
             my $changeNumerNode = $node->findnodes('./letter/text()'); 
             $changeNumerNode->setData("Purple");
          }
       }
    }
    print $d->toString;

   __DATA__
   <data-table>
      <data>
         <number>1</number>
         <letter>one</letter>
      </data>
      <data>
         <number>2</number>
         <letter>two</letter>
      </data>
  </data-table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:36:53.430

`findnodes`不返回节点。它返回节点列表或 ::NodeList。您可以强制它返回一个列表并获取返回的第一个节点。

```
for my $node ($d->findnodes('//data-table/data')) 
{ 
   my ($number_node) = $node->findnodes('number')
      or next;
   $number_node->textContent() eq '1'
      or next;
   my ($letter_text) = $node->findnodes('letter/text()')
      or next;
   $letter_text->setData('Purple');
} 
```

（如您所见，我删除了 . 的纯噪声用法`./`。）

你甚至可以使用

```
for my $letter_text ($d->findnodes(
   '//data-table/data[number/text()="1"]/letter/text()')) 
{ 
   $letter_text->setData('Purple');
} 
```

# ruby - 检查数组是否包含字符串，不区分大小写

> ID：14792448
> 
> 赞同：1
> 
> 时间：2013-02-09T22:41:33.540
> 
> 标签：ruby, arrays, string

我正在尝试编写一个从单词列表中删除单词的应用程序：

```
puts "Words:"
text = gets.chomp
puts "Words to remove:"
remove = gets.chomp
words = text.split(" ")
removes = remove.split(" ")
words.each do |x| 
    if removes.include.upcase? x.upcase
        print "REMOVED "
    else
        print x, " "
    end
end 
```

我如何使这种情况不敏感？我试着放在`.upcase`那里，但没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:03:59.367

```
words.each do |x| 
    if removes.select{|i| i.downcase == x.downcase} != []
        print "REMOVED "
    else
        print x, " "
    end
end 
```

`array#select`如果块为真，将从数组中选择任何元素。因此，如果`select`不选择任何元素并返回一个空数组，则它不在数组中。

* * *

**编辑**

您也可以使用`if removes.index{|i| i.downcase==x.downcase}`. 它比它执行得更好，`select`因为它不创建临时数组并在找到第一个匹配项时返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:56:20.787

```
puts "Words:"
text = gets.chomp
puts "Words to remove:"
remove = gets.chomp
words = text.split(" ")
removes = remove.upcase.split(" ")

words.each do |x|
  if removes.include? x.upcase
    print "REMOVED "
  else
    print x, " "
  end
end 
```

# javascript - TideSDK：有没有办法将数据传递给子窗口？

> ID：14792449
> 
> 赞同：2
> 
> 时间：2013-02-09T22:41:35.593
> 
> 标签：javascript, tidesdk

当我从主窗口创建一个子窗口时，我想向它传递一个 JavaScript 对象，但我不确定是否真的有办法做到这一点？

使用 TideSDK 创建的两个窗口每个都有自己的 JavaScript 环境，就像两个浏览器窗口一样（如果我理解正确的话，它们就是这样），所以你不能从另一个窗口访问一个窗口中的变量。另一方面，您可以从您所在的窗口访问其他窗口（例如使用`Ti.UI.getOpenWindows`）。那么……有没有办法呢？

我相信有一些解决方法是可能的，但它们都不是非常简单的，并且每个都使用其他的东西，而不是简单的 JavaScript：

*   使用`Ti.Database`或`Ti.Filesystem`存储我要传递的数据，然后从子窗口中检索它
*   将数据作为 GET 变量传递到新窗口，例如：`Ti.UI.createWindow("app://page.html?data1=test&data2=foobar");`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T08:55:27.943

您可以将对象分配给子窗口对象

```
var objToBePassed = {foo:'bar'};    
var currentWindow = Ti.UI.currentWindow;
var newWindow = currentWindow.createWindow("app://page.html");
newWindow.obj = objToBePassed;
newWindow.open(); 
```

在子窗口的 javascript 环境中，您可以通过以下方式访问该对象

```
var currentWindow = Ti.UI.currentWindow;
var obj = currentWindow.obj; 
```

另一种方法是使用 Ti.API.set：

```
Ti.API.set('objKey', objToBePassed); 
```

您可以通过以下方式在任何地方访问该对象

```
var obj = Ti.API.get('objKey'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T12:29:50.557

我知道这已经得到解答，但我遇到了一种模仿 PHP $_GET 变量的方法，这将按照 OP 的要求完成我认为的：

```
<script type="text/javascript">
(function(){ 
   document.$_GET = [];
   var urlHalves = String(document.location).split('?');
   if(urlHalves[1]){
      var urlVars = urlHalves[1].split('&');
      for(var i=0; i<=(urlVars.length); i++){
         if(urlVars[i]){
            var urlVarPair = urlVars[i].split('=');
            document.$_GET[urlVarPair[0]] = urlVarPair[1];
         }
      }
   }

})();

</script> 
```

然后使用它：

```
<script type="text/javascript">
    var conts = '<li><a  title="back to list" href="/menu.html?module='+document.$_GET['module']+'">Unit Listing</a></li>';
    document.write(conts);
</script> 
```

对我有用。

# ios - 如何在 Objective-C 中返回类似于 std::pair 的对象？

> ID：14792454
> 
> 赞同：5
> 
> 时间：2013-02-09T22:42:25.203
> 
> 标签：ios, objective-c

我来自 c++，我正在尝试为文本字段中的用户输入创建验证器类。我的函数需要返回一个`bool`和一个消息（如果`bool`是 YES 消息是`NULL`）。Objective-C 中是否有类似于[`std::pair`](http://en.cppreference.com/w/cpp/utility/pair)C++ 的内容（包含一对值）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T22:46:37.387

好吧，不完全是一对，但你有几个选择：

一。使用数组或字典（“标准集合类”）：

```
NSArray *pair1 = @[@NO, @"Foo"];
NSArray *pair2 = @[@YES, [NSNull null]]; 
```

或者

```
NSDictionary *pair = @{@"Flag" : @NO, @"Message" : @"Foo" }; 
```

所以你明白了……

二：如果它还不存在，为什么不编写自己的 Pair 类？

```
@interface MyPair: NSObject

@property (assign) BOOL flag;
@property (strong) NSString *message;

@end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T22:47:11.087

可可中没有`std::pair`；你可以创建你自己的。但是，解决该问题的更惯用的方法类似于其他返回错误的方法，即，将指针传递给指向错误的指针，然后返回`BOOL`：

```
-(BOOL) validateInput:(id)input error:(NSError**)errPtr {
    // Validate the input
    // If the input is valid, do not assign `errPtr`, and return `YES`
    // Otherwise, create a `NSError` object, and assign to errPtr
} 
```

您可以按如下方式调用此方法：

```
NSError *err;
if (![validator validateInput:@"some input" error:&err]) {
    // Show the error
} 
```

有关如何在 Cocoa 中使用此习惯用法的示例，请参见类的`regularExpressionWithPattern:options:error:`方法`NSRegularExpression`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-10T02:01:04.157

为什么不尝试使用 Objective-C++？只需使用`.mm`扩展名命名您的源文件，然后您就可以将 c++ 与 Objective-c 混合使用。你不能混合类，但你可以使用标准模板的东西。因此，在某些对象 Foo 中，我有一个带有以下代码的方法 doFoo：

```
std::pair<id, NSString*> foo;

foo.first = @"First";
foo.second = @"second";

NSLog(@"%@ %@", foo.first, foo.second); 
```

# java - 将 CharSequence 转换为 IntegerArray

> ID：14792455
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:42:27.953
> 
> 标签：java, arrays, character-encoding, integer

我尝试将 CharacterSequence 直接转换为具有单个整数的整数数组。

```
CharSequence nbr = "478";
int j;
int[] testArray = new int[100];

for(j = 0; j <= nbr.length() - 1; j++)
    testArray[j] = Character.getNumericValue(nbr.charAt(j));

System.out.println(testArray); 
```

控制台返回的不是所需的 [4,7,8]，而是这样的：

```
[I@424c2849 
```

使用 case '0','1',...,'8','9' 和相应的分配设置开关并不能解决问题。

我希望你能帮帮我！提前致谢 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:43:23.207

数组不会覆盖该`toString`方法。因此，当您尝试打印任何数组时，将调用`Object`类`toString`方法，并获得该方法返回的表示形式，其形式为 -`Type@hashCode`

要获得所需的表示，请使用[`Arrays.toString`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5b%5d%29)打印数组的方法：-

```
System.out.println(Arrays.toString(testArray)); 
```

除此之外，您确实应该将整数数组声明为：

```
int[] testArray = new int[nbr.length()]; 
```

而不是使用`100`大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:45:11.233

尝试

```
 CharSequence nbr = "478";
    int j;
    int[] testArray = new int[100];

    for(j = 0; j <= nbr.length() - 1; j++)
        testArray[j] = Character.getNumericValue(nbr.charAt(j));

    for(int i : testArray){
        System.out.println(i);
    } 
```

# css - CSS 扩展背景

> ID：14792459
> 
> 赞同：0
> 
> 时间：2013-02-09T22:42:42.300
> 
> 标签：css, background, position, absolute

```
.page {
background: none;
width: 1000px;
margin: 0 auto;
text-align: left;
padding: 0px 0px 0px 0px;
}

.header-container { 
background-image: url("http://patolino.com/img/fundo-top.jpg");
width: 100%;
height: 133px;
 }

.header{
padding:0px 0px 0px 0px;
width: 1000px;
position: fixed;
}

.header .logo { float:left;
margin-top:15px;
width: 30%;
 }

.header h1.logo {
float:left;
width: 30%;
padding: 0;
}

.nav-container {background: url(http://www.patolino.com/img/bg-menu.jpg) repeat;
width: 1000px;
height: 43px;
left: 0;
padding: 0px 0px 0px 0px;
}

.header .welcome-msg {
}

.header .form-search {
top-margin: 15px;
}

.header .links {
}

div.slidercontrolwr {
top: 30px;
}

.quick-access{
height: 133px;
} 
```

[http://imageshack.us/photo/my-images/46/screenshot20130209at818.png/](http://imageshack.us/photo/my-images/46/screenshot20130209at818.png/) [http://img145.imageshack.us/img145/3022/screenshot20130209at817.png](http://img145.imageshack.us/img145/3022/screenshot20130209at817.png)

但基本上：

```
 <div class="page">
        <div class="header-container">
    <div class="header">
                <h1 class="logo"><strong>Carol Baby</strong><a href="http://carolbaby.com.br/" title="Carol Baby" class="logo"><img src="http://carolbaby.com.br/skin/frontend/base/default/logo.png" alt="Carol Baby"></a></h1>
                <div class="quick-access">
            <p class="welcome-msg">Seja bem vindo! </p>
            <form id="search_mini_form" action="http://carolbaby.com.br/catalogsearch/result/" method="get">
    <div class="form-search">
        <label for="search">Buscar:</label>
        <input id="search" type="text" name="q" value="" class="input-text" autocomplete="off">
        <button type="submit" title="Buscar" class="button"><span><span>Buscar</span></span></button>
        <div id="search_autocomplete" class="search-autocomplete" style="display: none;"></div>
        <script type="text/javascript">
        //<![CDATA[
            var searchForm = new Varien.searchForm('search_mini_form', 'search', 'Procure na loja inteira aqui...');
            searchForm.initAutocomplete('http://carolbaby.com.br/catalogsearch/ajax/suggest/', 'search_autocomplete');
        //]]>
        </script>
    </div>
</form>
<ul class="links">
                        <li class="first"><a href="https://carolbaby.lojablindada.com/customer/account/?SID=utnm23in5j98qahq3gmtmaiem7" title="Minha Conta">Minha Conta</a></li>
                                <li><a href="https://carolbaby.lojablindada.com/wishlist/?SID=utnm23in5j98qahq3gmtmaiem7" title="Minha Lista de Desejos">Minha Lista de Desejos</a></li>
                                <li><a href="http://carolbaby.com.br/checkout/cart/" title="Meu Carrinho" class="top-link-cart">Meu Carrinho</a></li>
                                <li><a href="http://carolbaby.com.br/checkout/" title="Fechar Compra" class="top-link-checkout">Fechar Compra</a></li>
                                <li class=" last"><a href="https://carolbaby.lojablindada.com/customer/account/login/?SID=utnm23in5j98qahq3gmtmaiem7" title="Entrar">Entrar</a></li>
            </ul>
         </div>
     </div>
</div>
<div class="nav-container">
    <ul id="nav">
        <li class="level0 nav-1 level-top first">
<a href="http://carolbaby.com.br/bercos.html" class="level-top">
<span>Berços</span>
</a>
</li><li class="level0 nav-2 level-top">
<a href="http://carolbaby.com.br/roupeiros.html" class="level-top">
<span>Roupeiros</span>
</a>
</li><li class="level0 nav-3 level-top">
<a href="http://carolbaby.com.br/comodas.html" class="level-top">
<span>Cômodas</span>
</a>
</li><li class="level0 nav-4 level-top">
<a href="http://carolbaby.com.br/linhas-completas.html" class="level-top">
<span>Dormitórios Completos</span>
</a>
</li><li class="level0 nav-5 level-top last">
<a href="http://carolbaby.com.br/kits-para-bercos.html" class="level-top">
<span>Kits para Berços</span>
</a>
</li>    </ul>
</div> 
```

我需要的：

将背景 fundo-top.jpg 和 bg-menu.jpg 扩展至显示在示例图像 [2] 边框中的白边（左侧和右侧）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T14:42:59.170

我用 CSS 解决了这个问题，使用相对和绝对位置，除了注意 div 和 sub div 编码。

# css - 更新主题后悬停图像不显示

> ID：14792463
> 
> 赞同：0
> 
> 时间：2013-02-09T22:43:12.877
> 
> 标签：css, hover

这是我在 style.css 中与图像和悬停图像相关的代码。

```
#gallery_prettyphoto.portfolio a span
{
z-index: 2000;
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 98%;
display: none;
cursor: pointer;
}

.portfolio .gallery_2columns a span.image_hover
{background: black url("images/gallery_hover/hover_image_big.png") no-repeat center center;
} 
```

一切都很好，直到我将主题更新到新版本。我检查了 hover_image_big.png 是否丢失，不，文件在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:47:39.523

这最近发生在我身上，我花了很长时间才找到解决方案，但事实证明你必须像这样使用编写 css：

```
.portfolio .gallery_2columns a span.image_hover
{
background: black;
background: url("..images/gallery_hover/hover_image_big.png") no-repeat center center;

} 
```

我希望这有帮助！

# iphone - 我在 iPhone 上看不到我的 iad。但在模拟器上他们工作

> ID：14792468
> 
> 赞同：1
> 
> 时间：2013-02-09T22:43:36.373
> 
> 标签：iphone, ios, ios-simulator, iad

当我在 iOS 模拟器上测试我的应用程序时，我可以看到广告。但是如果我在我的 iPhone 上打开这个应用程序，我就看不到它们了。

我用这个：

```
- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error
- (void)bannerViewDidLoadAd:(ADBannerView *)banner 
```

哪里可能有问题？

我在这两种方法上都设置了 NSLog。每次我在 iPhone 上打开这个应用程序时，我都会从 didFailToReceiveAdWithError 获取日志。

错误说：

> 错误域 = ADErrorDomain 代码 = 0“操作无法完成。未知错误” UserInfo = 0x8892fd0 {ADInternalErrorCode = 0，ADInternalErrorDomain = ADErrorDomain，NSLocalizedFailureReason =未知错误}

# java - 如何在 Eclipse 控制台中获得没有换行效果的回车？

> ID：14792478
> 
> 赞同：30
> 
> 时间：2013-02-09T22:44:48.793
> 
> 标签：java, eclipse, console, carriage-return, linefeed

如果我

```
System.out.print("something\r"); 
```

在控制台，我将光标移回到行首，最后在

```
System.out.print("something\r");
System.out.print(" any\r"); 
```

我有

```
 anything 
```

打字。

但在 Eclipse 控制台我得到

```
something
 anything 
```

好像它被`\r`视为 CR/LF。

我该如何设置？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-08T22:27:18.540

正如 Nishant 在评论中已经指出的那样，**[您在](https://bugs.eclipse.org/bugs/show_bug.cgi?id=76936)**这里发现了一个错误。

这个错误最初是在 2004 年报告的*（>9 年前！？！！）*，这个错误似乎**不会很快**（或永远）得到修复。我在几个 Eclipse 版本上对其进行了测试，甚至在*Eclipse Juno SR2*上也进行了测试，并且错误仍然存​​在。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-05-30T20:11:38.557

该错误现已修复（Eclipse 2020-03）。只是去

```
窗口➺首选项➺运行/调试➺控制台
```

并确保两个复选框

```
解释 ASCII 控制字符
```

和

```
将回车 (\r) 解释为控制字符
```

已启用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-08T20:36:34.250

它似乎终于在火星上修复了！

```
Version: Mars Release (4.5.0)
Build id: 20150621-1200
Used Java: jre1.8.0_60 
```

你的代码

```
public class Main {

    public static void main(String[] args) {
        System.out.print("something\r");
        System.out.print(" any\r");
    }
} 
```

输出

```
 anything 
```

# css - Spacing in Nav Menu

> ID：14792479
> 
> 赞同：0
> 
> 时间：2013-02-09T22:44:48.917
> 
> 标签：css, navigation, margin, padding

I have a small space in my main navigation menu at:

[http://ranchocordovaeventscenter.com/](http://ranchocordovaeventscenter.com/)

I can't seem to find any css that is causing it to do this.

Can anyone help?

Thanks in advance,

Matt

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:49:09.543

`<a>`问题是元素内的每个锚标记`<li>`在两侧都有边框......

要解决此问题，请在`border-right-width`此处添加：

```
.main-navigation li a {
    border-right-width: 1px solid #F9B233;
} 
```

并删除上述选择器中的以下属性：

```
 border-width: 1px solid #F9B233; 
```

要删除最后一个元素的右边框，您可以这样做：

```
.main-navigation li:last-child a
{
    border-right-width: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:50:24.893

由于您将列表元素设置为内联块。它在每个元素之间创建空格，就好像它是文本一样（单词之间应该有空格，如果您考虑一下，这是有道理的）。

```
.nav-menu {
  font-size: 0;
} 
```

只要确保你重置了孩子的字体大小，否则他们将继承这个大小并且难以辨认。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:51:48.700

我没有看到你所说的空间，但我之前也发生过类似的事情。

[CSS 盒子模型拼图 - 我一定错过了什么](https://stackoverflow.com/questions/14096165/css-box-model-puzzle-i-must-be-missing-something)

关键是下面这段css代码：

```
box-sizing: border-box; /* needs prefixes for webkit/moz */ 
```

尝试为您可能拥有的容器 div 包含此 css 属性。

希望这可以帮助！

# javascript - Google Maps API infoWindow.close() does nothing

> ID：14792484
> 
> 赞同：0
> 
> 时间：2013-02-09T22:46:20.640
> 
> 标签：javascript, google-maps-api-3

```
function bindInfoWindow(marker, map, infoWindow, html) {

    //infoWindow.close(); <---- ignore this one

      google.maps.event.addListener(marker, 'click', function() {

        infoWindow.close();

        infoWindow.setContent(html);
        infoWindow.open(map, marker);
      });
    } 
```

This is my function with the listener for when a marker is clicked but regardless to what I do the infoWindows will NOT close unless I click them they just stay on the screen when I click them and sometimes I get an error that there is no Close function. Someone help please!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:54:19.737

InfoWindow close 工作得很好。我怀疑您希望它关闭不同的信息窗口。

在您的示例中，它将关闭信息窗口（如果它已打开）并立即再次打开它，您可能不会看到它。

尝试添加：

```
google.maps.event.addListener(map, "click", function() {infoWindow.close();}); 
```

然后点击地图。请注意，这可能不是您的最终解决方案，只是一种向您展示它确实关闭的技术。

[例子](http://www.geocodezip.com/v3_markers_infowindows.html)

# rest - Hyperlinking in WebAPI

> ID：14792487
> 
> 赞同：2
> 
> 时间：2013-02-09T22:46:28.093
> 
> 标签：rest, asp.net-web-api

Is there any solid guidance for generating hyperlinks for your resources in ASP.NET WebAPI? I've read a couple of posts on this:

[http://codebetter.com/glennblock/2012/01/08/hypermedia-and-web-api-design-brain-dump-and-samples/](http://codebetter.com/glennblock/2012/01/08/hypermedia-and-web-api-design-brain-dump-and-samples/)

[http://blog.ploeh.dk/2012/04/17/HyperlinkingWithTheASPNETWebAPI.aspx](http://blog.ploeh.dk/2012/04/17/HyperlinkingWithTheASPNETWebAPI.aspx)

Although informative, there appears to be no concrete guidance from Microsoft or otherwise in terms of how best to implement links for your resources (i.e. object model implemented using DTOs at the service layer). If we are moving towards using WebAPI to implement a true RESTful service, hyperlinking is crucial and I would have expected built in support / guidance for this in WebAPI.

A simple example I'm trying to implement this for is using a Contact entity which has a collection of Addresses and a collection of SupportIncident. The class definitions based on the first article I've referenced would look something like so:

```
 public class Link 
{         
    public Uri Uri { get; set; } 
    public string Rel { get; set; }
    public string Name { get; set; } 
}

public class ContactDTO
{
    public int ID { get; set; }

    public string Name { get; set; }

    public IList<AddressDTO> Addresses { get; set; }

    public IList<IncidentDTO> Incidents{ get; set; }

    public IList<Link> Links { get; set; }

} 
```

WebAPI is great at exposing this model over HTTP (xml/json) and the GET/PUT/POST/DELETE action on the resource but in order to build a true RESTful service I would like to know if a) Is there inherent support for link generation in WEBAPI? b) Is there proper guidance for exposing the model above containing links to resources and how should the API handle PUT/POST if a client sends links as part of the payload. Should these be ignored?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:51:09.277

在我看来，[本·福斯特](http://ben.onfabrik.com)在这方面做得很好。请参阅以下博客文章：

*   [在 ASP.NET Web API 中生成超媒体链接](http://ben.onfabrik.com/posts/generating-hypermedia-links-in-aspnet-web-api)

基本思想是，您将通过消息处理程序在退出时修改`ObjectContent`'`Value`属性。该消息处理程序将这项工作委托给注册的所谓“响应丰富者”，并且每个人都有机会评估它是否可以丰富对象类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T14:07:24.967

[我在这里](https://github.com/darrelmiller/ndc)构建了一个示例应用程序，演示了在 Web API 中使用超媒体。这里还有一个[https://github.com/webapibook/issuetracker](https://github.com/webapibook/issuetracker) 和 Amy Palamountain 这里有另一个很好的例子[https://github.com/ammeep/hyper-library](https://github.com/ammeep/hyper-library)。

使用 DTO 和链接的主要问题之一是默认情况下，这些 DTO 将被序列化为`application/json`或 `application/xml`。这些媒体类型都没有关于如何序列化链接的任何规范。因此，客户需要有关如何处理这些链接的带外知识。

要正确执行超媒体，您需要使用启用超媒体的媒体类型，例如 xhtml、hal、collection+json、json-ld、siren。

# javascript - Javascript：选择除某个类中的所有内容之外的所有内容

> ID：14792489
> 
> 赞同：-2
> 
> 时间：2013-02-09T22:46:49.023
> 
> 标签：javascript

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:48:40.530

在你的`for`循环中：

```
var node = nodes[i],
    parent = node.parentNode,
    inFoo = false;

// loop through all parent nodes and search for the unwanted class
while(parent){
  if(parent.className && parent.className.indexOf('foo') > -1){
     inFoo = true;
     break;
  }                       
  parent = parent.parentNode;        
}

if(!inFoo) {
   // do your stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:48:36.983

像这样的选择器应该可以工作：

```
a:not(.class_name) 
```

# ruby - Middleman & Haml 与 Github 风格的围栏代码块

> ID：14792490
> 
> 赞同：2
> 
> 时间：2013-02-09T22:46:49.183
> 
> 标签：ruby, sinatra, markdown, pygments, middleman

我开始将[Middleman](http://middlemanapp.com/)用于静态网页和博客目的。我将它与基于 ZURB Fondation 的模板[Middleman-Foundation](https://github.com/vocino/middleman-foundation)一起使用。它使用[Haml](http://haml.info/)，我确实倾向于使用 Haml，偶尔会使用 Markdown 文件。

我正在使用 redcarpet 进行降价，也可以使用 Github 风格的围栏代码块来突出显示源代码。但我不知道如何在 Haml 中为 Markdown 设置它。

我检查了适用于但不适[用于](https://github.com/middleman/middleman-syntax). 我试图从[Glorify](https://github.com/zzak/glorify)中弄清楚但失败了。我已经检查过[这个](https://github.com/middleman/middleman/issues/456)和[这个](https://github.com/middleman/middleman/issues/577)了。`.html.md``.html.haml`

在 Haml Markdown 中实现工作隔离代码块以生成突出显示的源代码的基本步骤是什么。

从一开始就有一套步骤，从`gem install middleman`克隆/使用中间人基金会开始，这将是很棒的，但欢迎任何简短的、实际的答案。

## 编辑

我能够通过以下方式在 Haml 中实现 pygmentized 代码块（遗憾的是，似乎无法为此使用带有围栏代码块的 markdown ......）：

```
 %li#simple3Tab This is simple tab 3's content. It's, you know...okay.
  %li#simple4Tab
    -code("ruby") do
      :plain
        def my_cool_method(message)
          puts message
        end
%h3 Buttons 
```

但是有一个持久的问题，这就是我得到的：

![无法放置标题换行符](../Images/0fb291792ab2daabe7c25c4c4b06fa12.png)

可以看出第一行没有正确缩进，这是因为前面的代码片段没有产生标题换行符：

```
 <li id='simple3Tab'>This is simple tab 3's content. It's, you know...okay.</li>
  <li id='simple4Tab'>
    <div class="highlight"><pre><span class="k">def</span> <span class="nf">my_cool_method</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="n">message</span>
    <span class="k">end</span>
    </pre></div>
  </li>
</ul>
<h3>Buttons</h3> 
```

**我不知道**如何在第一行之前换行`<span>`，在开头`<pre>`之后，以便代码像其他行一样正确缩进。

期望：

```
 <li id='simple3Tab'>This is simple tab 3's content. It's, you know...okay.</li>
  <li id='simple4Tab'>
    <div class="highlight"><pre>
    <span class="k">def</span> <span class="nf">my_cool_method</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="n">message</span>
    <span class="k">end</span>
    </pre></div>
  </li>
</ul>
<h3>Buttons</h3> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T04:46:28.487

我能够使用@bhollis 提供的信息、Haml 参考资料以及[Glorify 作者](https://github.com/zzak/glorify)指出的[这个 SO 问题](https://stackoverflow.com/questions/1993993/haml-with-pre-how-to-remove-unwanted-intend)，通过反复试验来解决这个问题。

这是神奇的组合：

```
 %li#simple3Tab This is simple tab 3's content. It's, you know...okay.
  %li#simple4Tab
    =preserve do
      -code("ruby") do
        :plain
          def my_cool_method(message)
            puts "Hello" + message
          end
%h3 Buttons 
```

结果（对于这个我启用了 emacs 样式表）：

![我得到了力量](../Images/df4f822a778f9f61543255d9ae2abc55.png)

这不仅解决了有关“缺少”标题换行符的问题，而且还删除了所提到的 SO 问题所涉及的额外缩进。

我仍然愿意接受更短更好的方法。三行前导码输入代码有点不方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:28:04.203

查看中间人语法的文档：[https ://github.com/middleman/middleman-syntax](https://github.com/middleman/middleman-syntax)

代码高亮自动包含在 Markdown 代码块中（通过 Redcarpet），但在 Haml 中，最好使用“代码”助手：

```
- code("ruby") do
  My ruby code here 
```

# puppet - 如何更改 vagrant 安装的 puppet 版本

> ID：14792491
> 
> 赞同：7
> 
> 时间：2013-02-09T22:46:51.363
> 
> 标签：puppet, vagrant

我在一个精确的 32 基础盒上使用 vagrant 1.0.1 来玩木偶。配置工作正常，我的清单正在执行。默认情况下，vagrant 在客户机的 /opt/vagrant_ruby/bin/puppet 下安装 puppet 2.7.14。

如何配置 vagrant（或曾经在来宾上安装 puppet 的人）以使用更新的版本，如 puppet 3.0 或 3.1？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-06-20T10:52:46.140

您还可以使用在 puppet 配置器*之前*指定的 shell 配置器来更新 puppet 。正如[Vagrant 文档](http://docs.vagrantup.com/v2/provisioning/basic_usage.html)中所说：

> `config.vm.provision`可以使用多种方法来定义多个供应商。这些配置程序将按照它们定义的顺序运行。出于各种原因，这很有用，但最常见的是它用于 shell 脚本可以引导系统的某些部分，以便稍后可以由另一个供应商接管。

这是[CentOS 6](http://docs.puppetlabs.com/guides/puppetlabs_package_repositories.html#for-red-hat-enterprise-linux-and-derivatives)的示例 Vagrantfile ：

```
# Update puppet to version 3.2.2 before using puppet provisioning.
$puppet_update_script = <<SCRIPT
[ `rpm -qa puppetlabs-release` = 'puppetlabs-release-6-7.noarch' ] || rpm -ivh http://yum.puppetlabs.com/el/6/products/i386/puppetlabs-release-6-7.noarch.rpm 
[ `rpm -qa puppet` = 'puppet-3.2.2-1.el6.noarch' ] || yum -y update-to puppet-3.2.2
SCRIPT
config.vm.provision :shell, :inline => $puppet_update_script

# Puppet-3.2.2 provisioning here
config.vm.provision :puppet do |puppet|
  puppet.options = '--parser future'
  puppet.manifests_path = 'puppet/manifests'
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T15:10:44.830

你需要重建你在 vagrant 中使用的 basebox 并安装你想要的任何版本的 Puppet。我为 Cent 6.3 w/puppet 3.0 做了同样的事情。Veewee [gem](https://github.com/jedi4ever/veewee)是为 Oracle Virtualbox 构建和管理 Vagrant basebox 的绝佳实用程序。

# performance - 寻求有效的关联位集散列

> ID：14792492
> 
> 赞同：2
> 
> 时间：2013-02-09T22:46:58.800
> 
> 标签：performance, hash, bit-manipulation, bitset, associative

假设您有一个有序的位集序列`b1, b2, b3, ..., bN`。

是否有有效的按位运算符散列计算可用于生成也是关联的散列？

换句话说，什么是推荐的散列函数`hash(bX, bY)`，例如：

```
hash(hash(b1, b2), b3) == hash(b1, hash(b2, b3)) 
```

按位排他或`XOR`提供可接受的低冲突率？

编辑：请注意，这里有一个相关的[问题](https://stackoverflow.com/questions/5491130/associative-noncommutative-hash-function)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:56:06.023

XOR 是关联的，但也是可交换的。它超出了您的需要，但我想不出一个实用的纯关联变体。我想到了矩阵乘法，但我不确定如何将它与二进制哈希一起使用。

加法也是关联的，因此您可以进行组合哈希：保留两个不同的哈希，一个与加法相结合，一个与 XOR 相结合。碰撞必须同时影响两者才能成为有效的碰撞。更有可能。

一个缺点是`hash(a, b) == hash(b, a)`（这是交换性）。不知道如何删除该属性。

# java - Java Swing 和 JGoodies

> ID：14792501
> 
> 赞同：0
> 
> 时间：2013-02-09T22:47:36.107
> 
> 标签：java, swing, jgoodies

我用 Java 开发了一个简单的桌面系统

我的系统将有一个连接到前端的数据库。

现在我想使用 JGoodies 来设计用户界面。

JGoodies 是 Swing GUI 框架的扩展吗？

在学习使用 JGoodies 之前，我是否必须掌握 Java Swing GUI 框架？

或者我可以在不首先掌握 Java Swing GUI 框架的情况下学习 JGooodies 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:09:03.457

您肯定需要学习 Swing 才能使用 JGoodies。JGoodies 提供了额外的外观、布局、Swing 组件和帮助类，但 UI 框架仍然是 Swing。

# vba - 从串口读取到 Excel

> ID：14792502
> 
> 赞同：1
> 
> 时间：2013-02-09T22:47:36.263
> 
> 标签：vba, excel, serial-port, arduino

我需要在 Excel 中创建一个按钮来从串口读取数据。我不能将任何额外的文件附加到 Excel 工作表中。我需要将此 excel 文件传输到另一台计算机以读取此数据。以下是文件的功能假设： 按下按钮选择串行端口。然后，按另一个按钮将数据从串行端口读取到 excel 单元格中。有人可以告诉我该怎么做吗？使用 VB 宏还是 ActiveX 宏？对不起，这是我第一次使用excel。请帮忙。同样，我不能将另一个文件附加到 Excel 工作表。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T12:21:26.800

我在这里的德国 microcontroler.net 论坛上找到了关于这个主题的讨论：

[http://www.mikrocontroller.net/topic/64788](http://www.mikrocontroller.net/topic/64788)

由于我在 Linux 上运行，我无法验证代码是否正确。无论如何，这是它的副本：

```
Sub Send_and_Read()
  '--------------------------------------------------------
  cmnd$ = "Hello World"        'A string to send
  '--------------------------------------------------------
  Open "COM1" For Binary Access Read Write As #1
  cmnd$ = cmnd$ + Chr(13)      'add [CR] to command string
  Put #1, , cmnd$              'write string to interface
  '--------------------------------------------------------
  answer = ""                  'clear response string
  char = Input(1, #1)          'get first character
  While (char <> Chr(13))      'loop until [CR]
    If (char > Chr(31)) Then
      answer = answer + char   'add, if printable char
    Else
      ' Do what ever you like
    End If
    char = Input(1, #1)        'get the next character
  Wend
  Close #1
  '--------------------------------------------------------
  Cells(1, 1) = answer         'put response in cell("A1")
End Sub 
```

# c - 组合公式“n！/（（nk）！*k！）”不起作用

> ID：14792509
> 
> 赞同：-6
> 
> 时间：2013-02-09T22:48:26.687
> 
> 标签：c, function, combinations

为什么是=n！/ ((nk)!*k!) 不打印？

这段代码也能解决下面的问题吗？

卡住。

```
"The number of combinations of n things taken k at a time as an integer" 
```

稍微澄清一下：“例如，一次取三个的四个项目a，b，c，d的组合是abc，abd，acd和bcd。换句话说，总共有四个不同的组合。东西“一次拿三个”。

```
#include <stdio.h>
#include <math.h>   

int main (void)
{
    int z = 0, n_in, k_in, k = 0, n = 0, result, nfr = 0, kfr = 0;

    do
    {
        printf("Enter the number of items in the list (n):");
        scanf("%d*c", &n_in);

        if (n_in>1 && n_in<11)
        {

            printf("Enter the number of items to choose (k)");
            scanf("%d*c", &k_in);

            if (k_in>0 && k_in<5)
            {

                if (k_in <= n_in)
                {

                    k_in = k;
                    n_in = n;

                    result = n! / ((n-k)!*k!);

                    z = 1;

                }

                else
                    printf("?Please Try again k must be less than n \n");
            }

            else
                printf("?Invalid input: Number must be between 1 and 4 \n");

        }

        else
            printf("?Invalid input: Number must be between 1 and 10 \n");

    } while (z == 0);

    result = (nfr / (nfr * kfr));
    printf("k value = %d n value = %d the result is %d", nfr, kfr, result);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:53:01.820

这一行：

```
result = n! / ((n-k)!*k!); 
```

...不是有效的 C 代码。`!`在 C 中表示“不”。

您将需要提供[一个阶乘函数](https://stackoverflow.com/questions/2416483/how-to-find-a-factorial)，以便您可以调用：

```
 result = factorial(n) / (factorial(n-k) * factorial(k)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:53:15.750

`!`不是`NOT`C 中的运算符。请改用此阶乘函数。

```
int factorial(int n)
{
  return (n == 1 || n == 0) ? 1 : factorial(n - 1) * n;
} 
```

所以你的计算是：

```
result = factorial(n) / (factorial(n-k)*factorial(k)); 
```

可能有更快的方法来做到这一点，但这是可读的。

另外，这条线

```
result = (nfr / (nfr * kfr)); 
```

对我来说没有任何意义，因为`nfr`和`kfr`都是零，但我猜你想在完成逻辑之前编译代码。

编辑：完整的代码应该是这样的：

```
#include <stdio.h>
#include <math.h>

int factorial(int n)
{
    return (n == 1 || n == 0) ? 1 : factorial(n - 1) * n;
}

int main (void)
{
    int z = 0, n_in, k_in, k = 0, n = 0, result, nfr = 0, kfr = 0;
    do
    {
        printf("Enter the number of items in the list (n):");
        scanf("%d*c", &n_in);

        if (n_in>1 && n_in<11)
        {
            printf("Enter the number of items to choose (k)");
            scanf("%d*c", &k_in);
            if (k_in>0 && k_in<5)
            {
                if (k_in <= n_in)
                {
                    k_in = k;
                    n_in = n;
                    result = factorial(n) / (factorial(n-k)*factorial(k));
                    //result = n! / ((n-k)!*k!);
                    z = 1;
                }
                else
                    printf("?Please Try again k must be less than n \n");
            }
            else
                printf("?Invalid input: Number must be between 1 and 4 \n");
        }
        else
            printf("?Invalid input: Number must be between 1 and 10 \n");
    } while (z == 0);
    //result = (nfr / (nfr * kfr));
    printf("k value = %d n value = %d the result is %d\n", nfr, kfr, result);
    return 0;
} 
```

输出：

```
~/so$ gcc test.cc
~/so$ ./a.out 
Enter the number of items in the list (n):3
Enter the number of items to choose (k)2
k value = 0 n value = 0 the result is 1
~/so$ 
```

# html - Javascript 变量属性列表

> ID：14792512
> 
> 赞同：3
> 
> 时间：2013-02-09T22:16:45.127
> 
> 标签：html, javascript, css, properties

我在哪里可以找到 Javascript 中变量的所有可用方法的列表？

例如：

```
var Variable1 = document.getElementById("Button1");
var Variable2 = document.getElementById("Label1");
var Variable3 = document.getElementById("TextBox1"); 
```

变量 1、变量 2 和变量 3 的属性是什么？

即使 Variable1 是 Button 元素，Variable2 是 Label 元素，Variable3 是 TextBox 元素，它们是否相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:52:07.717

除了 Dredel 的回答之外，您还可以使用`console.dir(document.getElementById('idhere'));`或其变体登录控制台以获取对象的可用属性和方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T22:50:46.467

您可以执行 a`for(var a in obj)`并获取对象中包含的所有内容的列表。在您的情况下`for(a in Variable1)`将显示所有对象。然后，您可以通过以下方式查看它们（在循环中）`Variable1[a]`

而且它们在很大程度上是相同的，假设它们是 DOM 的一部分，因为 DOM 对象都继承自同一个显示对象，但是不，它们不会相同，因为某些 HTML 对象具有不全局共享的独特属性。准备好一个长长的清单！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T22:56:01.410

MDN 是一个很好的参考。[从Node](https://developer.mozilla.org/en-US/docs/DOM/Node)和[Element](https://developer.mozilla.org/en-US/docs/DOM/Element)开始，几乎每个 HTML 元素都将从中继承。

另一种学习 DOM 引用的好方法：HTML Level 2 [IDL](http://www.w3.org/TR/DOM-Level-2-HTML/idl-definitions.html)和[JavaScript](http://www.w3.org/TR/DOM-Level-2-HTML/ecma-script-binding.html)定义。

[HTML5 标准](http://www.w3.org/TR/html5/)本身还有一些其他定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T23:33:27.070

在现代浏览器中，您可以使用

```
Object.getOwnPropertyNames(variable1) 
```

这将只返回*自己的*属性，而不是继承的。如果您希望所有这些都使用`for (var property in obj) ...`.

元素都继承自相同的对象，因此它们大多具有相同的属性；您会发现`.checked`,`.multiple`等差异。

# android - 短信发送在 Android 中不起作用

> ID：14792518
> 
> 赞同：0
> 
> 时间：2013-02-09T22:49:02.757
> 
> 标签：android, alarmmanager, smsmanager

我正在尝试创建一个计划将 SMS 消息事件发送到您自己的手机的程序。由于某种原因，它不起作用。我创建了一个扩展 BroadcastReceiver 的 SmsAlarm 类，它的作用是设置/取消警报。这是课程：

```
public class SmsAlarm extends BroadcastReceiver {
private int hour1, minute1, hour2, minute2, frequency;
private PendingIntent pi;

@Override
public void onReceive(Context context, Intent intent) {
    SmsManager manager = SmsManager.getDefault();
    TelephonyManager tMgr =(TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
    String phoneNumber = tMgr.getLine1Number();
    Calendar c = Calendar.getInstance();
    int currentHour = c.get(Calendar.HOUR_OF_DAY);
    int currentMinute = c.get(Calendar.MINUTE);
    if (currentHour >= hour1 && currentHour <= hour2 && currentMinute >= minute1 && currentMinute <= minute2) {
        String[] messages = context.getResources().getStringArray(R.array.messages);
        manager.sendTextMessage(phoneNumber, phoneNumber, messages[(int)(Math.random() * messages.length)], pi, null);
    }
}

public void SetAlarm(Context context) {
    AlarmManager am=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
    Intent i = new Intent(context, SmsAlarm.class);
    pi = PendingIntent.getBroadcast(context, 0, i, 0);
    am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 1000 * 60 * frequency, pi); //millisecond * second * minutes
}

public void CancelAlarm(Context context) {
    Intent intent = new Intent(context, SmsAlarm.class);
    PendingIntent sender = PendingIntent.getBroadcast(context, 0, intent, 0);
    AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
    alarmManager.cancel(sender);
}
//getters and setters after this method 
```

为了在每次打开应用程序时使用相同的调度程序，我们在安装后第一次运行应用程序时序列化 SmsManager 对象。这些是 MainActivity 类中的 saveAlarm 和 loadAlarm 方法：

```
public void saveAlarm(Context context){
    try{
    FileOutputStream fos = context.openFileOutput(FILENAME, Context.MODE_PRIVATE);
    ObjectOutputStream os = new ObjectOutputStream(fos);
    os.writeObject(manager);
    os.close();
    }
    catch(IOException e){
        e.printStackTrace();
    }
}

public SmsAlarm loadAlarm(Context context){

    try{
    FileInputStream fis = context.openFileInput(FILENAME);
    ObjectInputStream is=new ObjectInputStream(fis);
    try {
        manager=(SmsAlarm) is.readObject();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    is.close();

    }
    catch(IOException e){
        e.printStackTrace();
    }
    return manager;
} 
```

在 MainActivity.java 中，我有一个 SmsManager 的私有实例变量，并且在 onCreate 方法中，如果以前从未打开过应用程序，我将 manager 设置为新的 SmsManager：

```
if (!welcomeScreenShown) {
        manager = new SmsAlarm();
        saveAlarm(getApplicationContext());
        String whatsNewTitle = getResources().getString(R.string.whatsNewTitle);
        String whatsNewText = getResources().getString(R.string.whatsNewText);
        new AlertDialog.Builder(this).setIcon(android.R.drawable.ic_dialog_alert).setTitle(whatsNewTitle).setMessage(whatsNewText).setPositiveButton(
                R.string.ok, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        dialog.dismiss();
                    }
                }).show();
        SharedPreferences.Editor editor = mPrefs.edit();
        editor.putBoolean(welcomeScreenShownPref, true);
        editor.commit(); // Very important to save the preference
    } 
```

配置页面有两个时间选择器，让用户可以选择他们的时间限制和一个频率微调器，其中有多个选项用于接收消息的频率。对于测试，我使用了每一分钟。此代码在配置屏幕的 MainActivity 的 onCreate 中运行，但尚未显示：

```
if (configScreenShown)
    {
        manager = loadAlarm(getApplicationContext());
        //get the values from the SharedPreferences
        hour1 = setPrefs.getInt("hour1", 0);
        hour2 = setPrefs.getInt("hour2", 0);
        minute1 = setPrefs.getInt("minute1", 0);
        minute2 = setPrefs.getInt("minute2", 0);
        int freqInt = setPrefs.getInt("frequency", 0);
        frequencySet=freqInttoString(freqInt);

    } 
```

它调用 loadAlarm 以检索上次打开应用程序时使用的 SmsAlarm。我认为 SmsAlarm.java 存在问题，我正在考虑摆脱该类并将所有逻辑放在 MainActivity 中。

清单文件：

```
package="com.example.myapp"
android:versionCode="1"
android:versionName="1.0" >
<uses-permission android:name="android.permission.SEND_SMS"></uses-permission>
<uses-permission android:name="android.permission.RECEIVE_SMS"></uses-permission>
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"></uses-permission>
<uses-permission android:name="android.permission.GET_TASKS"></uses-permission>
<uses-permission android:name="android.permission.READ_PHONE_STATE"></uses-permission>

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme"
    android:debuggable="true" >
    <activity
        android:name="com.example.myapp.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
   <receiver android:name=".SMSReceiver"> 
    <intent-filter>
    <action android:name="android.intent.action.DATA_SMS_RECEIVED" /> 
        <data android:scheme="sms" /> 
        <data android:port="8901" /> 
    </intent-filter> 
    </receiver>
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:02:17.377

`AndroidManifest.xml`如果您必须从手机发送消息，则可以将权限添加到文件中。

```
<uses-permission android:name="android.permission.SEND_SMS"/> 
```

你加了这个吗？我想你可能会错过这个！

检查[本教程](http://mobiforge.com/developing/story/sms-messaging-android)。

# c - 按位运算和移位

> ID：14792521
> 
> 赞同：10
> 
> 时间：2013-02-09T22:49:09.447
> 
> 标签：c, bit-manipulation, bitwise-operators, twos-complement, bit-shift

我在理解这段代码的工作方式和原因时遇到了一些麻烦。我在这项任务中的合作伙伴完成了这部分，我无法让他了解它是如何以及为什么起作用的。我已经尝试了一些不同的方法来理解它，但是任何帮助都将不胜感激。此代码使用 2 的补码和 32 位表示。

```
/* 
 * fitsBits - return 1 if x can be represented as an 
 *  n-bit, two's complement integer.
 *   1 <= n <= 32
 *   Examples: fitsBits(5,3) = 0, fitsBits(-4,3) = 1
 *   Legal ops: ! ~ & ^ | + << >>
 *   Max ops: 15
 *   Rating: 2
 */
int fitsBits(int x, int n) {
    int r, c;
    c = 33 + ~n;
    r = !(((x << c)>>c)^x);
    return r;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-09T22:59:49.320

```
c = 33 + ~n; 
```

`n`这将计算在使用低位后剩余多少高位。

```
((x << c)>>c 
```

这用与 的符号位相同的值填充高位`x`。

```
!(blah ^ x) 
```

这相当于

```
blah == x 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-08-30T03:22:07.527

*   在 2 的补码平台`-n`上等价于`~n + 1`. 因此，`c = 33 + ~n`在这样的平台上实际上相当于`c = 32 - n`. 这旨在表示如果低位被占用，则`c`32 位`int`值中剩余多少高位。`n`

    请注意此代码中存在的两个平台依赖性：2 的补码平台，32 位`int`类型。

*   然后`((x << c) >> c`旨在对那些高阶位进行*符号填充。*`c`符号填充意味着那些在 bit-position 中的值`x`，`0`这些`n - 1`高阶位必须清零。但是对于那些在 bit-position 中的值`x`，`1`这些`n - 1`高位必须用`1`s 填充。这对于使代码对 . 的负值正常工作很重要`x`。

    这引入了另外两个平台依赖性：`<<`在移动负值或`1`移动到符号位时表现良好的运算符（正式地它是未定义的行为）和`>>`在移动负值时执行符号扩展的运算符（正式地它是实现定义的)

*   其余的，如上面回答的，只是与原始值的比较`x`:`!(a ^ b)`相当于`a == b`。如果上述转换没有破坏 then 的原始值，`x`则`x`确实适合`n`2 的补码表示的低位。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-30T04:22:56.990

[对有符号整数使用按位补码（一元`~`）运算符具有实现定义和未定义的方面](http://www.iso-9899.info/n1570.html#6.5p4)。换句话说，即使您只考虑二进制补码实现，此代码也不可移植。

* * *

重要的是要注意，即使是 C 中的二进制补码表示也可能有陷阱表示。[6.2.6.2p2 甚至](http://www.iso-9899.info/n1570.html#6.2.6.2p2)非常清楚地说明了这一点：

> 如果符号位为 1，则该值应通过以下方式之一进行修改：
> 
> -- 符号位为 0 的对应值取反（符号和幅度）；
> 
> -- 符号位的值为 -(2 M )（二进制补码）；
> 
> -- 符号位的值为 -(2 M - 1)（反码）。
> 
> 其中哪个适用是实现定义**的，符号位为 1 且所有值位为零（对于前两个）**或符号位和所有值位为 1（对于一个补码）的值**是否是陷阱表示**或正常值。

重点是我的。[使用陷阱表示是未定义的行为](http://www.iso-9899.info/n1570.html#6.2.6.1p5)。

**有一些实际的实现将该值保留为**默认模式下的陷阱表示。我倾向于引用的值得注意的是[OS2200 上的 Unisys Clearpath Dordado（转到 2-29）](https://public.support.unisys.com/2200/docs/cp13.2/pdf/78310430-015.pdf)。请注意该文件上的日期；这样的实现不一定是古老的（因此我引用这个的原因）。

* * *

根据[6.2.6.2p4](http://www.iso-9899.info/n1570.html#6.5.7p3)，向左移动负值也是未定义的行为。我还没有对现实中存在哪些行为进行大量研究，但我有理由期望可能存在符号扩展的实现，以及没有符号扩展的实现。这也是形成上述*陷阱表示*的一种方式，其本质上是未定义的，因此是不受欢迎的。从理论上讲（或者可能在遥远或不那么遥远的将来的某个时间），您可能还会面临“对应于计算异常”的信号（这是一个类似于`SIGSEGV`落入的 C 标准类别，对应于诸如“除以零”）或其他不稳定和/或不良行为......

* * *

**总之，**问题中的代码有效的唯一原因是巧合，您的实现所做的决定恰好以正确的方式对齐。如果您使用我列出的实现，您可能会发现对于某些值，此代码无法按预期工作。

如此*沉重的魔法*（正如评论中所描述的）并不是真正必要的，而且对我来说看起来也不是那么理想。如果您想要一些不依赖*魔法*的东西（例如可移植的东西）来解决这个问题，请考虑使用这个（实际上，这段代码至少可以工作`1 <= n <= 64`）：

```
#include <stdint.h>

int fits_bits(intmax_t x, unsigned int n) {
    uintmax_t min = 1ULL << (n - 1),
              max = min - 1;
    return (x < 0) * min + x <= max;
} 
```

# java - 如何在 iOS WebApp 上编写即时响应代码？

> ID：14792523
> 
> 赞同：0
> 
> 时间：2013-02-09T22:49:21.447
> 
> 标签：java, ios, web-applications, touch, delay

我正在 iOS 上编写一些 WebApp，用于为我的工作收集一些数据。但我发现它有一些问题。

我想写的程序很简单，一碰就让图片消失。所以我想出了这个非常简单的代码。

```
<!DOCTYPE HTML>
<html lang="en-US" manifest="manifest.mf">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />  
    <meta name="viewport" content="width=device-width; initial-scale=1.0; user-scalable=0;">
    <link rel="apple-touch-icon-precomposed" href="icon.png"/> 
    <style type="text/css">

    *{
        -webkit-touch-callout: none;
    }

</style>
<script src="http://code.jquery.com/jquery.min.js"></script>

<script>
function show_coords(event)
{
var x=event.offsetX;
var y=event.offsetY;
//alert("X coords: " + x + ", Y coords: " + y);
$("#result p").text("coX= "+x+" coY= " +y);
}

 $(document).ready(function() {
        $('img').each(function() {
            $(this).click(function() {
                $(this).stop().animate({ opacity: 1.0 }, 1);
            },
           function() {
               $(this).stop().animate({ opacity: 0.0 }, 0);
           });
        });
    });
</script>
    <title>DataCollect</title>
</head>
<body>
<img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><br>
<img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><br>
<img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><br>
<img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><br>
<img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><img src="flower.gif"width='50' height='50' onmousedown="show_coords(event)" /><br>

<div id='result'>
    <p></p>
</div>
</body>
</html> 
```

此代码在 pc 的浏览器上运行良好。它如我所愿地响应。但是当我在 iphone 的 Safari 上运行它时。好像有点延迟。图片不会突然消失。似乎滞后了大约一秒钟。

你们可以在这里尝试使用 ios 的 Safari `http://jjwestwind.tk/napp/`

所以我该怎么做？有没有其他方法可以在 WebApp 上编写这种应用程序？或者我别无选择，只能回到原生应用程序？（这会给我提供给其他用户带来很多麻烦）

请帮我！太感谢了 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:56:23.183

正如这个答案所建议的那样，它可能有助于消除点击延迟：[删除点击延迟](https://stackoverflow.com/questions/6471188/uiwebview-links-delay)

或者使用这个[FastClick 代码](https://github.com/ftlabs/fastclick)javascript 代码。

# informatica-powercenter - Informatica 查找和更新策略错误

> ID：14792524
> 
> 赞同：0
> 
> 时间：2013-02-09T22:49:22.617
> 
> 标签：informatica-powercenter, informatica

我正在尝试查找和更新策略转换，但由于某种原因它不起作用。

我的映射中有一个断开连接的查找，该查找基于特定条件调用，当查找为 null 时，我尝试将变量设置为 'INS',REJ,UPD,DEL..

我的 agg_trans-INS_UPD_DEL 中的新变量没有链接到 upd_strategy trans。我能够将变量从表达式移动到 update_strategy 但没有看到正在显示的链接..

![在此处输入图像描述](../Images/6a9dc19238fbbd6dbb140c945909833b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T14:23:58.397

好吧，Aggregator 是一个积极的转变。如果您在聚合器中创建新端口，则在更新策略时将无法超越其他端口的这种转换。

在不要求您提供更多功能的情况下，您可以通过简单地将端口流过聚合器来解决此问题。无论您在更新策略中需要什么，请确保它们通过聚合器... Src 限定符 -> 聚合器 -> 更新策略。

我希望它足够清楚，如果没有，请考虑通过有关主动转换的文档..

# facebook - 如何访问我的客户 ID 和身份验证？原始开发人员继续前进

> ID：14792526
> 
> 赞同：3
> 
> 时间：2013-02-09T22:49:41.787
> 
> 标签：facebook, api, authentication, client

好的，这是我的情况。我们有两个开发人员为我们创建了一个社交网络程序。他们创建了一项功能，允许它链接到您的 Facebook 帐户。他们说他们使用了标准的 Facebook API，并使用令牌进行授权。当代码在我们的开发网站 dev.maizing.com 上时，该功能运行良好，但现在它在 www.maizing.com 上，我们遇到了问题。

我搜索并找到了一个 PHP 文件，其中有几个对 dev.maizing.com 的引用，我将它们更改为 www.maizing.com 在我们的应用程序中，当我现在尝试链接到我的 Facebook 帐户时，我收到一个很长的错误 URL。我注意到它包括......

```
 https://www.facebook.com/dialog/oauth?client_id=____________ 
```

我不会在这里包含整个 client_id。

有人告诉我，我的原始客户端 ID 被硬编码为与 dev 而不是 www 一起使用。我的原始开发人员已经走了，无法访问。我认为他们在另一个帐户下拥有 client_id，而我无权访问它。我现在可以访问让我们的 client_id 指向正确的服务器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-06T10:59:33.337

您的应用仪表板页面上显示的 AppID 是 client_id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-29T14:37:45.653

听起来您**需要**访问应用程序设置，可在此处找到：

https://developers.facebook.com/apps/[client_id]/summary/

正如此[页面](https://developers.facebook.com/docs/reference/dialogs/oauth/)所说，“您指定的 URL 必须是与您的应用程序设置中指定的相同基域的 URL...”

因此，除非您可以访问您的应用程序设置，否则您必须使用“dev.maizing.com”

对不起。

但是有一线希望，如果您将应用程序域更改为“maizing.com”而不是“dev.maizing.com”，那么您可以从“*.maizing.com”使用此应用程序，如应用程序工具提示中所述领域。

# ruby-on-rails - postgres 准备好的语句中与 rails 时间相差 1 小时

> ID：14792539
> 
> 赞同：1
> 
> 时间：2013-02-09T22:51:07.843
> 
> 标签：ruby-on-rails, postgresql

我有一个问题，在 Rails 中进行查询会在生成的 postgres sql 语句中转换错误的时间。shell、ruby和postgres中的时间是23:32，但是在生成的sql语句中是22:32

任何想法有什么问题？我使用 rails 3.2.11, pg gem 0.14.1 （使用 bundle install 安装）

debian系统时间：

```
$ date
Sat Feb  9 23:32:10 CET 2013 
```

在红宝石中：

```
1.9.2p290 :004 > Time.now
=> 2013-02-09 23:32:15 +0100 
```

在 postgres 中：

```
=> select current_time;
   timetz       
--------------------
23:32:24.213487+01
(1 row) 
```

生成的rails查询：

```
1.9.2p290 :003 > Item.where "next_crawling_at < ?", Time.now
Item Load (1.1ms)  SELECT "items".* FROM "items" WHERE (next_crawling_at < '2013-02-09 22:32:17.935595') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:23:08.660

看起来您已经在客户端中设置了 UTC 时区 - 尽管这似乎与您的结果相矛盾`Time.now`。你得到`Time.zone`什么？

如果没有夏季的额外 DST 偏移量（因为我们现在有冬天），您的时区可能是 CET（中欧时间），而`Time.now`似乎被转换为 UTC。

[`Time.now.in_time_zone("Europe/Paris")`](https://stackoverflow.com/questions/5300493/convert-utc-to-local-time-in-rails-3)您可以使用- （或任何适合您的数据库时区设置的时区名称）强制 Ruby 中的特定时区。

或者您可以强制使用 UTC 时间戳[`Time.now.utc`](https://stackoverflow.com/questions/755669/how-do-i-convert-datetime-now-to-utc-in-ruby)并将其附加`AT TIME ZONE 'Europe/Berlin'`在 Postgres 中。

或者你在`timestamp with time zone`任何地方都可以操作。

# javascript - 响应光标移动的背景精灵

> ID：14792540
> 
> 赞同：0
> 
> 时间：2013-02-09T22:51:17.803
> 
> 标签：javascript, jquery, html, css

我正在尝试创建一种效果，该效果根据鼠标光标移动的方向在某个方向上移动图像精灵。我研究了视差滚动，但找不到太多帮助。关于在哪里可以找到有关光标移动相关对象的更多信息或教程的任何想法？

为了更好地了解我在说什么，请访问[http://web-features.net/](http://web-features.net/)并创建一个响应鼠标移动的新层。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:07:23.023

[谷歌是你的朋友](http://www.jquery4u.com/animation/jquery-parallax-tutorial/)。这是我能找到的唯一针对您的问题的教程，但我相信还有更多关于在 javascript 中使用鼠标位置进行操作的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:03:07.883

我不知道任何教程，但请查看这篇文章的答案：

[根据单独元素中的光标位置旋转元素](https://stackoverflow.com/questions/9972449/rotating-an-element-based-on-cursor-position-in-a-separate-element)

这会让你开始。您可以更改背景位置，而不是旋转元素。

基本上，您想想象一个直角三角形，其中斜边的一端是元素的中心，另一端是光标。

使用 javascripts Math.atan2() 您可以传入 y,x 位置，它以弧度返回角度。

这些信息足以让你继续前进吗？

///////// 更新 /////////

这是我为您制作的演示，也使用 css3 转换：[http ://codepen.io/jeffpowersd/pen/ryBJz](http://codepen.io/jeffpowersd/pen/ryBJz)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-09T22:56:05.720

这对我有帮助！

[http://www.w3schools.com/css/css_image_sprites.asp](http://www.w3schools.com/css/css_image_sprites.asp)

希望这可以帮助！

另请注意，在图像精灵上向右移动时，css 方向为负。例如，

```
#prev{background:url('img_navsprites_hover.gif') -47px 0;}

#prev a:hover{background: url('img_navsprites_hover.gif') -47px -45px;} 
```

悬停时，图像向右移动 47 像素，向下移动 45 像素。

# php - 在 Aptana Studio 3 中使用 PHP 我得到“没有定义 PHP 可执行文件”

> ID：14792545
> 
> 赞同：1
> 
> 时间：2013-02-09T22:52:53.407
> 
> 标签：php, xampp, wamp, aptana3

我是一个长期使用 M/S Visual Studio 的爱好者，但我正试图摆脱 ASP .Net。我已经安装了 Aptana Studio 3，并且除了 PHP 之外的所有东西都可以在 HTML5 网页上运行。测试网站由一个 index.html、一个访问 PHP 的 javascript 和一个响应 javascript 的 PHP 页面组成。

我将这 3 个文件上传到我的域的服务器，它工作正常。使用 Aptana 3，我将 3 个文件放在一个新的 PHP 项目中，但是当我尝试预览项目时，我得到“没有定义 PHP 可执行文件”。我在网上搜索但没有得到任何帮助。

一些信息似乎说 PHP 解释器应该已经安装了 Aptana，其他人说你必须单独安装。不过，其他人说我必须安装 WAMP。我无法破译 Aptana 网站文档来解决问题。

任何有关如何设置/配置 Aptana Studio 3 以使用 PHP 正确预览 Html5 网站的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T02:00:57.603

无论 Aptanta Studio 是否附带 PHP，请下载并安装最新版本的 PHP，以防万一：http: [//php.net/downloads.php](http://php.net/downloads.php)

然后在 Aptana Studio 中，转到 Preferences -> Aptanta Studio -> Editors -> PHP -> PHP Interpreters 并指定您的 PHP 安装详细信息。

然后再试一次，看看是否有帮助。

# sql - Oracle中的语句触发器？

> ID：14792549
> 
> 赞同：2
> 
> 时间：2013-02-09T22:53:04.563
> 
> 标签：sql, oracle, triggers

我正在为 DBMS 考试而学习，我正在尝试做一些触发器。“标准”行触发器没有问题，但问题出现在语句触发器上。

练习是创建一个触发器，如果​​某个列的值的总和更新到低于最小值 (30)，则引发异常。

所以表是这样的：

```
ID | VALUE
----------
 1 |  23
 2 |  11
 3 |  14 
```

并且更新将执行类似的操作

```
UPDATE TABLE SET VALUE = VALUE - 10 
```

这应该抛出一个异常，因为之前的总和是 48，更新之后的总和是 18。

我已经尝试过使用行触发器，但是在同一张表上进行选择会引发“变异表”警告，所以寻找这个我想这应该是由于触发器设计不佳造成的。

可能我应该实现一个语句触发器，但似乎我无法访问 new_table 或 old_table，而且我不知道如何编写它们。这很糟糕，因为它们看起来很简单，但我找不到任何有用的东西或任何例子。

有什么帮助吗？

提前致谢！

编辑：

并且新表/旧表引用似乎也存在于[Oracle](http://docs.oracle.com/javadb/10.3.3.0/ref/rrefsqlj43125.html#rrefsqlj43125__sqlj54276)中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:45:09.043

尝试这样的事情：

```
CREATE OR REPLACE TRIGGER trg_xyz
AFTER UPDATE ON tableX
DECLARE
  v_sum number;
BEGIN

  SELECT SUM(VALUE) into v_sum
  FROM tableX;

  IF v_sum < 30 THEN
    raise_application_error(-20001,"ERROR MESSAGE");
  END IF;
END;
/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:17:22.580

我不知道 Oracle 语法，但我相信与 SQL Server 中`new_table`的语法相同`INSERTED`；如果是这样的话：

```
CREATE TRIGGER TableName_U
BEFORE UPDATE
IF (SELECT SUM(VALUE) FROM new_table) < 30 THEN
    BEGIN
        raise error syntax
        abort update syntax
    END 
```

# php - 保护我的 php 应用程序的基本技术是什么？

> ID：14792554
> 
> 赞同：-1
> 
> 时间：2013-02-09T22:53:32.547
> 
> 标签：php, security, web-applications

到目前为止，我练习清理所有 $_GET/$_POST 输入，并始终在操作请求中调用 php 文件名，而不是 PHP_SELF。但我知道还有更多，而且它有点分散在网络上。

我将不胜感激任何有关 php 安全性的基本提示，并希望这个问题可以作为任何寻求开发 Internet 应用程序所需的标准安全措施的人的一站式场所。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:20:01.177

如果脚本正在与数据库服务器交互，则必须对发送到该服务器的所有查询进行转义以避免[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)。如果不采取这种安全措施，可能会造成很多破坏，但幸运的是，转义字符串非常简单，因为 php.ini 中已经存在这些函数。对于 MySQL 数据库，它是[`mysql_real_escape_string(string $unescaped_string [, resource $link_identifier ])`](http://php.net/manual/de/function.mysql-real-escape-string.php)

这是一个示例，它是如何工作的：

脚本：index.php?user= **'; 截断表用户；SELECT * FROM users WHERE user = '**

```
$user = mysql_real_escape_string($_GET['user']);
mysql_query("SELECT * FROM users WHERE user = '$user'"); //The table users won't be truncated 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:29:22.370

比使用 mysql_real_escape_string 转义每个用户输入更好的方法是使用准备好的语句。

你可以在这里阅读：http: [//php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

使用准备好的语句，您既快速又安全。快，因为它们准备一次并执行多次。安全，因为它们对 SQL 注入攻击免疫。

另一种类型的攻击是跨站点请求伪造攻击。许多 PHP 框架已经为此类问题做好了准备，并以一种或另一种方式解决它。如果你使用框架，你应该检查它是否提供 csrf 防御。如果你在没有框架的情况下工作，你应该开始阅读这种攻击。

最后但同样重要的是，还有 XSS 类型的攻击（跨站点脚本）。它与 javasript 中用户输入的不当转义有关。攻击者可能会从您的用户那里窃取一些重要数据。所以你也应该防范这种攻击。看这里： http: [//phpmaster.com/php-security-cross-site-scripting-attacks-xss/](http://phpmaster.com/php-security-cross-site-scripting-attacks-xss/)

这些是基本类型的攻击。如果您可以阻止它们，那么您可以更安全地保护 80% 的网络。

# django - 我想在所有页面中包含干草堆搜索

> ID：14792555
> 
> 赞同：0
> 
> 时间：2013-02-09T22:53:37.250
> 
> 标签：django, django-templates, django-urls, django-haystack

我已经为我的索引页配置了一个干草堆搜索。我有如下配置

```
urlpatterns = patterns('',

url(r'^admin/doc/', include('django.contrib.admindocs.urls')),
url(r'^admin/', include(admin.site.urls)),
url(r'^$',SearchView(
    template='index.html',
    form_class=SearchForm),name="haystack_search") 
```

但通常当我在其他页面中包含我的 index.html 时，我看不到搜索栏，因为它仅配置为索引页面。任何想法，如果有办法将干草堆搜索作为上下文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:00:22.650

就个人而言，我不会为搜索结果提供根 url，而是使用 haystack 文档建议的行。

```
(r'^search/', include('haystack.urls')), 
```

然后，在您的基本模板中放置一个搜索表单，该表单在表单操作中指向该 url。从基础继承的任何模板都将包含该表单。同样，[haystack 文档](http://django-haystack.readthedocs.org/en/latest/tutorial.html)提供了关于如何组织模板代码的非常好的指导。

# php - 如何管理使用 git 开发应用程序？

> ID：14792561
> 
> 赞同：0
> 
> 时间：2013-02-09T22:54:42.020
> 
> 标签：php, git, version-control, installation, state

我坚持这个想法。

如果我开发一个应用程序，比如说 PHP 论坛或 cms。

大多数 PHP 论坛和 CMS 都有这些（加上一些）共同点：

*   它们包括一个安装程序目录。
*   安装后，出于安全原因，应删除安装程序目录。
*   在删除安装程序目录之前，该应用程序将无法正常工作（显示消息，或根本无法工作）。

现在这是有道理的，但我不太明白应该如何管理开发这个应用程序和版本控制。

目前，我的系统上有两个应用程序副本。

一个“干净”的副本，没有做任何事情。
一个“开发”副本，此副本已安装并且是工作副本。

如果我修复了错误，或者向开发版本添加了新功能，然后我手动将更改复制到干净副本，提交并推送。

这非常耗时，而且在我看来并不实用。

如果应用程序有扩展名，我会执行相同的过程，我的“开发”副本与插件一起安装，并且我有一个干净的扩展副本。

有没有更好的方法来管理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:21:14.810

您可以删除安装文件夹进行测试，然后将已删除的文件标记为：

```
git update-index --assume-unchanged [list of filenames] 
```

并且 git 不会提示您从存储库中删除它们。

您可以使用：

```
git ls-files --deleted 
```

列出所有已删除的文件，以便您可以使用以下命令自动删除它们：

```
git update-index --assume-unchanged `git ls-files --deleted` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:58:40.960

将所有更改和错误修复提交到`dev`( `develop`) 分支；并且仅当您想要发布一系列更改时才从`develop`to `clean`( )合并。`master`使用其他分支开发特定的新功能；并使用标记显示发布质量代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T23:12:42.730

典型的企业工作流程看起来像这样（当然有无限的变化）：

`production`分支包含所有实际发布的代码。标签用于标记特定的发行版或版本。

一个`staging`（或者可能`qa`；名称是相当随意的）分支用于准备新版本和/或补丁。因此，如果正在进行开发但需要紧急补丁，则可以在此分支中制作它，然后合并到`production`( `git merge staging`) 作为部署或发布过程的一部分。

各个`development`分支机构跟踪特定的开发工作。新功能等。当它们准备好发布时，它们会合并到`staging`/`qa`等中，直到它们实际发布。如果您的工作流程中有更多步骤，您可以在必要时将更多分支添加到列表中（生产 -> 登台 -> qa -> 集成 -> 测试 -> 等）。

这个工作流程的想法是你总是可以从`production`-> `staging`->`development`分支安全地向下合并。当您想将一些代码推进到启动时，您会以相反的方向合并。

git 中的分支很便宜，所以如果你愿意，你甚至可以对简单的错误修复进行分支。如果您的分支很忙，您可以`git branch`从本质上为您的紧急错误修复制作一个临时迷你版，将这个新分支合并到完成后，然后合并回您的正常分支。完成后只需删除临时分支。`production``staging``staging``production``production``staging`

有时会出现的一种情况是：你想做一个紧急补丁，但你正处于开发过程中，你不想制作一个新的克隆并检查`staging`它。在这种情况下，您可以使用`git stash`来保存您的工作，然后签出您想要的分支，修复错误，然后返回`development`分支并`git stash pop`获取最后一个存储并恢复您的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T23:07:02.173

git 可以很容易地在不同版本的代码之间切换，因此从技术上讲，您不需要多个副本。您可以在开发时创建一个`dev`包含所有杂乱提交的分支。您甚至可以创建专门针对特定错误功能或功能实现的分支。当您完成某个稳定状态时，您可以将分支合并到`master`分支中。然后，每当您需要“干净副本”时，您只需签出`master`分支即可。如果您确实想要一个单独的干净副本，您可以简单地克隆您正在工作的仓库或将您的主分支从本地仓库推送到远程仓库。

# python - 将整数分配给字符串

> ID：14792562
> 
> 赞同：5
> 
> 时间：2013-02-09T22:54:41.640
> 
> 标签：python, string, variables, integer

我在 Python 中工作，我有一个整数列表：`[1, 2, 1, 3, 2, 2, 1, 3]`.

我想为每个整数分配一个字符串，就好像它是一个变量： `['red', 'orange', 'red', 'yellow', 'orange', 'orange', 'red', 'yellow']`。

我该怎么做呢？

在该示例中，`1`对应于`'red'`，`2`对应于`'orange'`，并且`3`对应于`'yellow'`。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T22:56:42.913

使用字典。

```
d = {1: 'red', 2: 'orange', 3: 'yellow'} 
```

然后你可以这样做来改变列表：

```
lst = [d[k] for k in lst] 
```

字典基本上将对象（在本例中为整数）“映射”到其他对象，这正是您想要的。

# php - 用信息填充日历

> ID：14792566
> 
> 赞同：0
> 
> 时间：2013-02-09T22:55:48.850
> 
> 标签：php, mysql

我正在使用以下 jQuery 日历：[http ://www.htmldrive.net/items/show/568/astonishing-iCal-like-calendars-with-jQuery](http://www.htmldrive.net/items/show/568/astonishing-iCal-like-calendars-with-jQuery)

我想使用以下查询填充它：

```
public function get_upcoming_events()
{
    $query = "SELECT * FROM events
            WHERE date >= NOW()
            ORDER BY date ASC";

    return DB::get_results($query);
} 
```

我已经开始使用与此类似的格式的事件信息填充弹出框。

```
 echo '<li><span class="title">'.date('n/j/Y', strtotime($event->date)).' - '.$event->title.'</span>';
    echo '<span class="desc"><a href="'.SITE_URL.'/index.php/events/get_event?id='.$event->id.'">Click here for details and to sign up...</a></span></li>'; 
```

我现在已经为此下载了一个扩展：[https](https://github.com/MrHus/jquery-monthly-ical/tree/) ://github.com/MrHus/jquery-monthly-ical/tree/按照文档我已经改变了这个：

```
$(document).ready(function()
{   
    $("#ical").ical({

    eventdates: [{"date": "2009-03-21", "title": "My birthday", "desc": "Its my birthday!"},
                 {"date": "yyyy-01-01", "title": "New Year", "desc": "Its a new year!"},
                 {"date": "2009-mm-01", "title": "New Month", "desc": "First day of the new month!"},
                 {"date": "2010-mm-01", "title": "New Month", "desc": "First day of the new month!"},
                 {"date": "2010-09-01", "title": "Convention", "desc": "September convention."}, 
                 {"date": "2010-09-02", "title": "Convention", "desc": "September convention day two."}, 
                 {"date": "2010-mm-01", "title": "Towl", "desc": "Dont forget to bring a towl."}    
                ]                   
}); 
```

对此：

```
$(document).ready(function()
{   
    $("#ical").ical({

                        <?php
                        foreach($events as $event)
                        {
                        ?>
                        eventdates: [{"date": "<?php date('Y/m/d') ?>", "title": "<?php $event->title ?>", "desc": "Its my birthday!"},
                                     {"date": "yyyy-01-01", "title": "New Year", "desc": "Its a new year!"},
                                    ]
                        <?php
                        }
                        ?>                 
}); 
```

如何使用上述内容填充弹出框日历？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T01:22:54.130

假设`get_upcoming_events`处于工作状态并且您获取对象数组，您可以使用[foreach](http://www.php.net/manual/en/control-structures.foreach.php)循环：

```
// $events is the fetched array
foreach ($events as $event) {
    echo '<li><span class="title">'.date('n/j/Y', strtotime($event->date)).' - '.$event->title.'</span>';
    echo '<span class="desc"><a href="'.SITE_URL.'/index.php/events/get_event?id='.$event->id.'">Click here for details and to sign up...</a></span></li>';
} 
```

# coding-style - JS 库的这种模式有什么问题吗？

> ID：14792567
> 
> 赞同：1
> 
> 时间：2013-02-09T22:55:55.440
> 
> 标签：coding-style, javascript

诚然，我对 javascript 的内部工作原理知之甚少，但需要制作一个库并想学习（因此在这里询问）。我理解使用闭包并导出到窗口不会污染全局命名空间，但除此之外它让我有点困惑。

```
(function() {
    var Drop = window.Drop = function() { 

        var files = [];

        var add = function(word) {
              files.push(word);    
              return files;
        }

        return {
            files: files,
            add: add
        }
    }
})()

// All of these seem to be the same?
var a = Drop();
var b = new Drop();
var c = new Drop;

// Each has their own state which is what I want.
a.add("file1");
b.add("file2");
c.add("file3"); 
```

*   为什么三种“初始化”Drop的方式都一样？
*   究竟是什么让他们有能力拥有自己的状态？
*   是否有替代返回语法的方法来在 Drop 上导出这些函数？
*   是否有一种更好的最佳实践方式来创建这样的自包含库？

我在网上搜索过，但在这个主题上几乎没有一致性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:09:08.100

1.  第一种方式 ( `Drop()`) 只是正常调用函数，`this`全局对象也是如此（`window`在浏览器环境中）。正如您所期望的那样，它完成它的工作，然后返回一个对象。

    第二种方式 ( `new Drop()`) 创建一个新`Drop`对象并执行`this`设置为该对象的构造函数。但是，您不会`this`在任何地方使用并返回从对象字面量创建的对象，因此该`Drop`对象将被丢弃并返回对象字面量。

    第三种方式（`new Drop`）在语义上与第二种方式相同；这只是句法上的差异。

2.  它们都有自己的状态，因为每次调用时`Drop`，它都有自己的一组局部变量，与任何其他调用的局部变量不同`Drop`。

3.  您可以转换您的代码以使用正常的`new`语法和原型。这有几个优点：即，您只需创建`add`一次函数，而不是为每次`Drop`调用创建一个函数。您修改后的代码可能如下所示：

    ```
    function Drop() {
        this.files = [];
    }
    Drop.prototype.add = function(word) {
        this.files.push(word);
        return this.files;
    }; 
    ```

    但是，通过这样做，您将无法在没有`new`. 但是，有一种解决方法：您可以将其添加为内部的第一行`function Drop`：

    ```
    if(!(this instanceof Drop)) {
        return new Drop();
    } 
    ```

    因为当你用 调用它时`new`，`this`将是 a `Drop`，当你没有调用它时`new`，它将是 a`this`以外的东西`Drop`，你可以看看是否`this`是 a `Drop`，如果是，继续初始化；否则，使用 重新调用它`new`。

    还有另一个语义差异。考虑以下代码：

    ```
    var drop = new Drop();
    var adder = drop.add;
    adder(someFile); 
    ```

    您的代码将在这里工作。基于原型的代码不会，因为`this`它将是全局对象，而不是`drop`. 这也有一个解决方法：在构造函数的某个地方，您可以这样做：

    ```
    this.add = this.add.bind(this); 
    ```

    当然，如果你的库的消费者不打算从对象中提取函数，你就不需要这样做。此外，您可能需要对`Function.prototype.bind`没有它的浏览器进行填充。

4.  不，这完全是口味问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:11:10.073

*   *为什么三种“初始化”Drop的方式都一样？*

```
// All of these seem to be the same?
var a = Drop();
var b = new Drop();
var c = new Drop; 
```

当你`new`在 JavaScript 中使用调用一个函数时，函数`this`内部的值变成了新的对象。

但是在您的情况下它们相同的原因是您根本没有使用`this`。您正在使用*对象文字*语法创建一个单独的对象，然后返回它，因此`new`没有影响。

* * *

*   *究竟是什么让他们有能力拥有自己的状态？*

因为每次函数调用都会创建一个新对象，所以每次调用的每个对象都是完全不同的。

分配给对象的函数在每次`Drop`调用中都会重新创建，因此会在封闭变量范围内创建一个闭包。因此，每个调用的`files`数组对于每个相应调用中所做的函数都是可连续访问的。

* * *

*   *是否有替代返回语法的方法来在 Drop 上导出这些函数？*

是的。将函数和数组分配给`this`，然后删除该`return`语句。但这将*需要*使用`new`. 或者，将函数放在 的`.prototype`对象上`Drop`，它们将在所有使用 的实例之间共享`new`，但将分配给的数组保留`this`在构造函数中，使其不被共享。

对于引用数组的原型函数，他们将使用`this.files`.

* * *

*   *是否有一种更好的最佳实践方式来创建这样的自包含库？*

JavaScript 非常灵活。有很多方法可以解决一个问题，每种方法都有自己的优点/缺点。一般来说，它会归结为利用*闭包*、*原型继承*或两者的某种组合。

* * *

这是一个完整的原型继承版本。另外，外部`(function() {})()`没有被使用，所以我要添加一个变量来利用它。

```
(function() {
    var totalObjects = 0; // visible only to functions created in this scope

    var Drop = window.Drop = function() { 
        this.files = [];
        this.serialNumber = totalObjects++;
    }

    Drop.prototype.add = function(word) {
        this.files.push(word);    
        return this.files;
    };
})(); 
```

# android - 安卓文字换行

> ID：14792572
> 
> 赞同：1
> 
> 时间：2013-02-09T22:56:17.393
> 
> 标签：android

在我的 android 应用程序中，我将一个长字符串显示到多个页面中。我通过将长字符串分解成一个字符串数组来实现这一点，其中每个数组元素都包含一个屏幕上可以容纳的字符数（无需滚动）。此外，通过在我的活动底部使用上一个/下一个按钮，我更改了我的 textview 的内容以在页面（数组元素）之间切换。

我被困的地方是找出一页/屏幕上将显示多少个字符。请记住，我不希望用户滚动。我使用`paint.breaktext`with`screenwidth`作为参数并找出一行中有多少个字符，然后将其乘以一个屏幕上的行数以获得一页中的字符数。Android 在每行末尾的文本换行是我计算在页面中查找字符的原因，这是错误的。我正在尝试使用自己的逻辑来适应文本换行，但这不起作用。

所以我的问题是：

*   有什么办法可以知道一个屏幕上会显示多少个字符？
*   或者还有什么可以帮助我的是，如果我找出android遵循什么逻辑来包装换行符的文本。因为如果我知道这一点，那么我可以相应地重新调整页面上的字符数。
*   或者其他选项可能是禁用文本换行（不确定是否可能）。因为这样我就可以使用我自己的逻辑来包装文本，而不是试图找出 Android 的文本包装逻辑并相应地调整我的页面上的字符。

非常感谢任何帮助。

# html - CSS :: child 设置为在父悬停时更改颜色，但在悬停时也会更改

> ID：14792574
> 
> 赞同：53
> 
> 时间：2013-02-09T22:56:22.860
> 
> 标签：html, css, hover, parent-child

我有`<a>`一个`<span>`孩子。我已经编写了一些 CSS，当父级悬停时它会改变子级的边框颜色，但是当我悬停子级时它也会改变边框颜色，这是不应该的。

```
a {
    padding: 50px;
    border: 1px solid black;
}

a span {
    position: absolute;
    top: 200px;
    padding: 30px;
    border: 10px solid green;
}

a:hover span {
    border: 10px solid red;
} 
```

```
<a>
    Parent text
    <span>Child text</span>    
</a>
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-02-09T23:11:36.397

# 更新

以下对 2013 年有意义。但是，现在，我将使用[如下](https://stackoverflow.com/a/14792594/1911755)`:not()`所述的选择器。

* * *

CSS 可以被覆盖。

演示：http: [//jsfiddle.net/persianturtle/J4SUb/](http://jsfiddle.net/persianturtle/J4SUb/)

用这个：

```
.parent {
  padding: 50px;
  border: 1px solid black;
}

.parent span {
  position: absolute;
  top: 200px;
  padding: 30px;
  border: 10px solid green;
}

.parent:hover span {
  border: 10px solid red;
}

.parent span:hover {
  border: 10px solid green;
}
```

```
<a class="parent">
    Parent text
    <span>Child text</span>    
</a>
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-09T22:59:51.923

如果您不关心支持旧浏览器，则可以使用`:not()`排除该元素：

```
.parent:hover span:not(:hover) {
    border: 10px solid red;
} 
```

**演示：http: [//jsfiddle.net/vz9A9/1/](http://jsfiddle.net/vz9A9/1/)**

如果您*确实*想支持它们，我想您将不得不使用 JavaScript 或再次覆盖 CSS 属性：

```
.parent span:hover {
    border: 10px solid green;
} 
```

# windows - 有没有办法拦截 KMDF 中的每一个 IRP

> ID：14792578
> 
> 赞同：5
> 
> 时间：2013-02-09T22:57:11.570
> 
> 标签：windows, driver, kmdf

我正在编写一个 KMDF 驱动程序，该驱动程序需要在每个 IRP 传递到 ioQueue 之前拦截它。

我有一个注册了 PreprocessIrpCallback 的回调函数，并希望像这样将它挂接到框架中

```
status = WdfDeviceInitAssignWdmIrpPreprocessCallback(DeviceInit
    , PreprocessIrpCallback
    , ?
    , ?); 
```

但是，如果我想拦截每一个 IRP，问号里的内容是什么？

# java - 使 jar 文件首先运行特定文件

> ID：14792581
> 
> 赞同：0
> 
> 时间：2013-02-09T22:57:54.497
> 
> 标签：java, executable-jar

我为我的所有课程制作了一个 jar 文件，是的，它可以工作。虽然它没有运行我的自定义 GUI。我想将 jar 文件设置为先运行我的 GUI，然后从那里执行其余文件。

我该怎么做？提前致谢。

当我通过命令提示符运行它时

```
java GUI 
```

它可以工作，但我需要使用 jar 文件来执行此操作，因为我希望我的类文件被混淆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:29:31.377

我想你现在只是 .class 文件，你想创建一个 .jar 文件。

要运行 jar 文件，您必须在 java 命令后添加 -jar。

Jar 文件是 zip 文件，其中包含类、可能的资源和说明哪个类具有 main() 方法的清单。

jar 命令用于创建 jar 文件。

```
jar cvfm output.jar Manifest.txt *class package1 package2 
```

在**Manifest.txt**你应该有这一行：

```
Main-Class: MainClass 
```

之后运行：

```
java -jar output.jar 
```

# php - 用于在 2 个 MySQL 表之间复制数据库表行的 Cron 作业

> ID：14792582
> 
> 赞同：2
> 
> 时间：2013-02-09T22:57:59.270
> 
> 标签：php, mysql, joomla, cron, phpfox

我想将登录数据从一个表复制到另一个表。

1.  表包含 Joomla 登录数据
2.  表包含 phpFox 登录数据。我想每隔 30 秒/1 分钟将表 1 中的登录数据复制到表 2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T09:48:24.493

如果您想将用户信息数据库从主服务器共享到其他 Joomla 网站，有一个更好的解决方案。

唯一的要求是所有数据库必须位于同一服务器 + Joomla 2.5.x 上！

打开 PhpMyAdmin 并应用此修改：

**xxxx1... 是来自主站点
的表 xxxx2... 是来自客户端站点的表**

```
DROP TABLE xxxx2_session
DROP TABLE xxxx2_usergroups
DROP TABLE xxxx2_users
DROP TABLE xxxx2_user_notes
DROP TABLE xxxx2_user_profiles
DROP TABLE xxxx2_user_usergroup_map

CREATE VIEW xxxx2_users AS SELECT * FROM xxxx1.jos_users
CREATE VIEW xxxx2_session AS SELECT * FROM xxxx1.jos_session
CREATE VIEW xxxx2_usergroups AS SELECT * FROM xxxx1.jos_usergroups
CREATE VIEW xxxx2_user_notes AS SELECT * FROM xxxx1.jos_user_notes
CREATE VIEW xxxx2_user_profiles AS SELECT * FROM xxxx1.jos_profiles
CREATE VIEW xxxx2_user_usergroup_map AS SELECT * FROM xxxx1.jos_usergroup_map 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T04:29:39.820

如果您想从默认的 phpfox 函数运行 cron，请查看数据库`phpfox_cron`中的表。`phpfox`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:09:37.617

这很简单。只需编写一个执行您想要的操作的查询并将其保存为`.sql`文件。然后`crontab -e`在命令行输入开始编辑您的 crontab。[Ubuntu 文档](http://manpages.ubuntu.com/manpages/precise/man5/crontab.5.html)对编辑 crontab 有很好的说明，但您的最后一行可能类似于：

```
* * * * *       mysql --user=your_dbuser --password=your_password --database=zero < /path/to/your_query.sql 
```

# ios - 目标 C 中的全局变量（方向）

> ID：14792583
> 
> 赞同：1
> 
> 时间：2013-02-09T22:58:10.163
> 
> 标签：ios

我是来自 .NET 和 java 的 xcode 的新手，我正在使用许多通过代码加载的 xib，并在不同的设备方向上工作。我通过我的代码注意到，在每个 xib 中，我需要根据方向（主要是纵向 VS 横向）分叉一些代码，因此经常使用这一行：

```
 UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation]; 
```

我的问题是：我怎样才能使它成为一个全局变量（不想在这里使用静态这个词。）但是在我的多 xib 大型项目中的某些地方我可以做到这一点：

```
 -(UIInterfaceOrientation)currentOrientation {
return [[UIApplication sharedApplication] statusBarOrientation]; 
```

}

这是最好的做法吗？

谢谢。

# c++ - C++中的指针和栈

> ID：14792585
> 
> 赞同：0
> 
> 时间：2013-02-09T22:58:40.300
> 
> 标签：c++, arrays, pointers, stack

我无法弄清楚整个指针推送和弹出的工作原理。在我的程序中，用户应该创建一个空（NULL）的堆栈，并且用户可以选择将一个数字压入堆栈或弹出被压入、关闭的数字。它还应该计算堆栈的数量和存储的内容，但我假设如果我了解应该如何编写 push 和 pop，我可以弄清楚这一点。我理解那些我只是不知道它应该如何写的背后的概念。有人请帮我理解这一点。我去找了一位导师，但他需要恢复记忆，并告诉我改天再来。我会的，但我不能依赖它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:01:39.707

这是我的`pop`. 从这个例子中应该很明显需要做什么`push`。*我不能说这是最具成本效益的方式。*

```
template <class T>
T SimpleStack<T>::popOff()
{
    T popped = *(aptr + --arraySize); //aptr points to the existing stack
    int tSize = arraySize;            //arraySize is a member holding the size

    T *temp = new T[tSize];           //Temp holder for the elements that stay 
                                      //on the stack
    for(int i = 0; i < tSize; ++i)
    {
        *(temp+i) = *(aptr+i);        //Fill the temp holder with the original 
                                      //stack - popped
    }
    delete [] aptr;                   //Get rid of the old stack
    aptr = new T [tSize];             //Create a new stack with the new size
    for(int i = 0; i < arraySize; ++i)
    {
        *(aptr+i) = *(temp+i);        //Fill the new stack with the kept values
    }
    delete [] temp;                   //Get rid of the temp holder
    return popped;                    //Send the popped number back
} 
```

事实仍然是，如果不了解堆栈或您要模拟的任何自定义容器是什么，以及它是如何使用的以及最适合您的位置，您可能会感到困惑。

# clojure - Clojure :: arity-overloaded 函数相互调用

> ID：14792592
> 
> 赞同：10
> 
> 时间：2013-02-09T22:59:48.033
> 
> 标签：clojure

Clojure arity-overloading 函数的示例如下（取自[cookbook](http://en.wikibooks.org/wiki/Clojure_Programming/Examples/Cookbook)）：

```
(defn argcount
  ([] 0)                                ; Zero arguments
  ([x] 1)                               ; One argument
  ([ x &  args] (inc (count args))))    ; List of arguments 
```

...使用一种似乎不允许较低数量的函数简单地调用具有一些默认值的较高数量的函数的形式（这是 Java 中的常见习语）。是否有其他特殊形式用于此？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T02:54:20.847

通常有一种很好的方式来表达更高的参数，而无需使用高阶函数和`map`/来引用其他参数`reduce`。在这种情况下，它非常简单：

```
(defn argcount
  ([] 0)
  ([x] 1)
  ([x & args]
    (reduce + 1 (map (constantly 1) args)))) 
```

注意表达式的一般形式是：

```
(reduce reducing-function arity-1-value (map mapping-function rest-of-args)) 
```

您不能以这种方式做所有事情，但这适用于相当大比例的多参数函数。它还获得了使用 laziness 的优点`map`，所以你可以做一些疯狂的事情，比如将一千万个参数传递给一个函数，而不用担心：

```
(apply argcount (take 10000000 (range)))
=> 10000000 
```

在大多数其他语言中尝试一下，你的堆栈将是 toast :-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-27T16:55:04.320

mikera 的回答很棒；我只是添加一个额外的方法。当重载函数需要默认值时，可以使用局部变量。

在下面的示例划分中，本地需要数字和精度。定义的函数使用默认值重载精度。

```
(def overloaded-division
 (let [divide-with-precision
  (fn [divisor dividend precision]
    (with-precision precision (/ (bigdec divisor) (bigdec dividend))))]
     (fn
      ;lower-arity calls higher with a default precision.
      ([divisor dividend] (divide-with-precision divisor dividend 10))
      ;if precision is supplied it is used.
      ([divisor dividend precision] (divide-with-precision divisor dividend precision)))
   )
 ) 
```

当以较低的数量调用时，它应用的默认值：

```
user=> (overloaded-division 3 7)
0.4285714286M
user=> (overloaded-division 3 7 40)
0.4285714285714285714285714285714285714286M 
```

# javascript - 通过 Node.js Ajax 提供 Javascript 文件的正确方法？

> ID：14792595
> 
> 赞同：1
> 
> 时间：2013-02-09T23:00:07.017
> 
> 标签：javascript, jquery, node.js

我正在尝试编写一个节点应用程序，为静态网页提供 crjavascript 代码。然后将在网页中评估代码。与[此示例](http://labs.ft.com/2012/08/basic-offline-html5-web-app/)类似，但使用 node 而不是 php。服务器应用程序如下所示：

```
// Load the http module to create an http server.
var http = require('http');

// Configure our HTTP server
var server = http.createServer(function (req, res) {
    var js;
    //send back all libraries
    fs = require('fs');
    res.writeHead(200, {'Content-Type': 'text/plain'});
    //var paths = ['javascript.js'];
    js = fs.readFileSync('example.js').toString();
    res.end('_js(\'{"message": " ' + js + '"}\')');
});

// Listen on port 8000, IP defaults to 127.0.0.1
server.listen(8000);

// put a message on the terminal
console.log("Server running at http://127.0.0.1:8000/"); 
```

虽然客户端代码如下所示：

```
<html>
<head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" charset="utf-8"/>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                url: 'http://127.0.0.1:8000/',
                dataType: "jsonp",
                jsonpCallback: "_js",
                cache: false,
                timeout: 20000,
                success: function(data) {
                    var dataJson = JSON.parse(data);
                    console.log(dataJson['message']);
                    eval(dataJson['message']);
                    alert(test);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log('error ' + textStatus + " " + errorThrown);
                }
            });

        });
    </script>
</head>
<body>
    <div class="container" id="container"></div>
</body>
</html> 
```

example.js 当前包含一行`alert('hello world')`。想法是使用 ajax 查询将这行代码发送到 index.html，然后运行它。但是，由于撇号和括号的乱七八糟，我不断收到基于此行的错误：

```
res.end('_js(\'{"message": " ' + js + '"}\')'); 
```

我在想一定有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:15:52.833

如果您没有通过 ajax 提供 javascript 的硬性要求，那么使用基于节点的 Web 服务器会更简单，例如[expressjs](http://expressjs.com)，它可以让您轻松提供[静态内容](http://expressjs.com/api.html#app.use)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:11:22.297

好的，通过`res.end('_js(\'{"message": " ' + escape(js) + '"}\')');`在服务器和`eval(unescape(dataJson['message']))`客户端上使用来解决。很抱歉发帖，但在找到解决方案之前，我在一个多小时内无处可去......

# php - PHP中的Mysqli资源作为参数或全局

> ID：14792599
> 
> 赞同：3
> 
> 时间：2013-02-09T23:00:32.187
> 
> 标签：php, mysql, function, mysqli

哪种方法更好地将 MySQLi 资源传递给页面上的函数？作为值参数？作为参考参数？让它全球化？

我一直在考虑这个问题，但我不知道哪个更好或如何看待它。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:42:04.607

大多数人建议的模式是通过参数的函数传递它，或者如果您正在编写 OOP 方式，则使用依赖注入。

全局变量通常被认为是一种不好的做法，因为它们使阅读代码和检测依赖关系变得困难。

知道还有另一种选择是正确的，但它一直是网络上批评的主题：Singleton 设计模式。它最大的问题是：

*   基本上是一种引入全局变量（实例）的技巧，因此继承了全局变量的问题。
*   违背单一责任原则。
*   隐藏程序的依赖
*   很难进行单元测试

在这里您可以找到一些参考资料：

*   [全局变量不好](http://c2.com/cgi/wiki?GlobalVariablesAreBad)
*   [依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)
*   [单身人士真的那么糟糕吗？](https://stackoverflow.com/q/1020312/493122)
*   [单身人士有什么不好的？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)
*   [为什么单身人士是邪恶的](http://blogs.msdn.com/b/scottdensmore/archive/2004/05/25/140827.aspx)
*   [单例是一种反模式](http://molecularmusings.wordpress.com/2011/11/11/singleton-is-an-anti-pattern/)
*   [单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T06:18:39.873

**全球肯定。**

你将用无用的额外参数污染你的代码，只是徒劳无功。
看，大多数人只是背诵一些规则，并无条件地遵循它们。但最好*理解*它们的含义并*明智地*使用，这取决于上下文。

称猫为猫并没有错。*然而，将全局变量称为全局变量并*没有错。
尽管“全局变量*通常*被认为是一种不好的做法”，但这种情况是不同的。
当您使用`global`关键字传递*局部*变量时，这确实是一种不好的做法。它使您的代码晦涩难懂且难以支持-我不是在争论这一点。但是真正的**全局**变量是完全不同的事情。PHP 一直在使用它们——`$_SERVER`数组就是一个很好的例子。

因此，对于一个真正的全局变量，它在整个代码中一直使用并作为文档化 API 的一部分 -`global`是最佳选择。

# ruby-on-rails-3 - Rails 3 基本验证不适用于 :prompt 或 :include_blank？

> ID：14792602
> 
> 赞同：0
> 
> 时间：2013-02-09T23:01:00.200
> 
> 标签：ruby-on-rails-3, validation, model, controller

在我看来，我有以下代码：

```
<%= f.select :user_id, user_all_select_options, :include_blank => '--Select a name-----' %> 
```

它`--Select a name-----`在顶部显示用户列表。当用户未从列表中选择名称并保持`--Select a name-----`选中状态时，我会收到错误，因为 user_id 为空白。

作为参考，辅助方法代码如下所示：

```
def user_all_select_options
  User.all.map{ |user| [user.name, user.id] }
end 
```

我的模型如下：

```
class Parcel < ActiveRecord::Base

  attr_accessible :parcel, :received_at, :received_by, :chilled, :courier, :location, :passed_to, :user_id, :user, :content, :localip

  validates :user_id, :presence => true

  belongs_to :user

end 
```

由于某种原因，验证似乎没有运行，但是如果我从下拉列表中选择一个用户并为其他字段输入添加验证，应用程序会正确地向用户显示一条消息，说明哪个字段错误地为空。

有趣的是，如果我将选择下拉菜单保留为`--Select a name-----`并保留附加验证，则会引发异常。它不会提示缺少的字段，它只是错误。

这是错误期间的记录（此记录来自我对位置字段进行验证存在检查时：

```
{"utf8"=>"✓", "authenticity_token"=>"wM4KPtoswp3xdv8uU4UasdadNsZi9yFZmk=", "parcel"=>{"user_id"=>"", "received_by"=>"dan", "content"=>"", "chilled"=>"0", "courier"=>"", "location"=>"", "passed_to"=>"", "received_at(3i)"=>"9", "received_at(2i)"=>"2", "received_at(1i)"=>"2013", "received_at(4i)"=>"22", "received_at(5i)"=>"59"}, "commit"=>"Receive this Parcel", "action"=>"create", "controller"=>"parcels"} 
```

我应该从哪里开始寻找？显示的错误是控制器对用户执行除非检查。

宗地控制器创建方法如下所示：

```
 def create
    @parcel = Parcel.new(params[:parcel])
    @parcel.localip = request.env['REMOTE_ADDR']
    @parcel.received_by = @parcel.received_by.upcase

    unless @parcel.user.mobilenumber.blank?
      UserMailer.parcel_notification(@parcel).deliver
    end

    respond_to do |format|
      if @parcel.save
        format.html { redirect_to @parcel, notice: 'Parcel was successfully created.' }
        format.json { render json: @parcel, status: :created, location: @parcel }
      else
        format.html { render action: "new" }
        format.json { render json: @parcel.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:50:31.617

当您不选择用户时出现异常的原因是这一行

```
unless @parcel.user.mobilenumber.blank? 
```

由于`user_id`未设置，`@parcel.user`因此`nil`导致异常。我建议你把它移到`@parcel.save`块内。

```
def create
  @parcel = Parcel.new(params[:parcel])
  @parcel.localip = request.env['REMOTE_ADDR']
  @parcel.received_by = @parcel.received_by.upcase

  respond_to do |format|
    if @parcel.save
      unless @parcel.user.mobilenumber.blank?
        UserMailer.parcel_notification(@parcel).deliver
      end

      format.html { redirect_to @parcel, notice: 'Parcel was successfully created.' }
      format.json { render json: @parcel, status: :created, location: @parcel }
    else
      format.html { render action: "new" }
      format.json { render json: @parcel.errors, status: :unprocessable_entity }
    end
  end
end 
```

# c - 使用 switch 语句时出现 MACRO 错误

> ID：14792603
> 
> 赞同：0
> 
> 时间：2013-02-09T23:01:01.370
> 
> 标签：c, macros, switch-statement

嘿，看看代码：

```
#define SUFFIX(n)  (switch(n)                                               \
                   {                                                        \
                        case 1: printf("st\n");                             \
                        break;                                              \
                                                                            \
                        case 2: printf("nd\n");                             \
                        break;                                              \
                                                                            \
                        case 3: printf("rd\n");                             \
                        break;                                              \
                   }                                                        \
                   ) 
```

在 main 中调用上述宏：

```
int main()
{
    printf("%s", suffix(1));
} 
```

但是当我调用它时，我收到一条错误消息：

```
expected expression before switch 
```

但是我缺少什么表达方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T23:11:14.093

你试图做的事情是行不通的。`switch`是一个语句，但`printf`需要一个表达式。

**选项1：**

`()`从你的括号中删除`#define`，简单地说`SUFFIX(1)`没有`printf`.

```
#define SUFFIX(n)  switch(n)                                               \
                   { case 1: printf("st\n"); break;                        \
                     case 2: printf("nd\n"); break;                        \
                     case 3: printf("rd\n"); break;                        \
                   }
int main()
{
    SUFFIX(1);
} 
```

**选项 2：**

```
#define SUFFIX(n) ( n == 1 ? "st" : (n == 2 ? "nd" : (n == 3 ? "rd" : "")) )
int main()
{
  printf("%s", SUFFIX(1));
} 
```

**选项 3 和 4：**

使上述之一成为功能。第一个返回`void`，第二个返回`char *`。

# python - python烧瓶导入错误

> ID：14792605
> 
> 赞同：49
> 
> 时间：2013-02-09T23:01:05.893
> 
> 标签：python, flask, importerror

我正在运行以下代码

```
from flask import Flask
app = Flask(__name__)
@app.route("/")
def hello():
    return "Hello World!"
if __name__ == "__main__":
    app.run(host='0.0.0.0', port=80, debug=True) 
```

并得到以下错误

```
Traceback (most recent call last):
  File "test.py", line 1, in <module>
    from flask import Flask
  File "/home/pi/programs/flask.py", line 1, in <module>
    from flask import Flask
ImportError: cannot import name Flask 
```

我已经尝试通过各种方法安装flask，但问题仍然存在

还有，烧瓶有什么替代品？？？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2013-10-19T20:42:15.013

我遇到了这个错误，因为我将**测试文件**命名为**flask.py**并尝试运行它！它会与**真正的烧瓶模块产生****命名空间冲突**！

 ****删除**您命名的**本地测试文件****flask.py**和相应的**flask.pyc**。给个别的名字吧！这将发生在其他模块（如`socket`etc）中，您可能会为测试文件提供与标准模块相同的名称:-)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2016-08-10T09:27:13.263

原因是你的 python 文件名是flask。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-02-09T23:52:52.583

赶紧跑`apt-get install python3-flask`

编辑安装 python3 版本，因为现在没有人应该使用 python2。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-05-22T12:32:29.723

只需重命名**flask.py**文件也删除**flask.pyc**文件

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-08-16T15:46:56.900

**这是因为名称 flask.py。如果名称是flask.py，它将自行导入。更改名称并重试。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-21T08:22:48.983

重启虚拟环境

```
$ virtualenv flask 
```

进入 dir flask 运行

```
$source ./bin/activate 
```

再次安装python模块

```
$pip install "module" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-13T17:30:38.293

我遇到过同样的问题。显然你**也不能**命名你的文件**socket.py**。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-13T20:25:08.830

正是当我们将文件名创建为 flask.py 然后第一次执行它时，它会执行，同时框架会创建另一个名为 flask.pyc 的文件。现在停止进程并重新启动它会抛出这个错误查看实际框架烧瓶文件时，它正在查看您创建的文件。解决这个问题 转到你创建的flask.py文件夹并删除flask.pyc，然后将flask.py重命名为test_1.py ..保存并执行它。您应该看不到任何错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-16T00:26:56.243

添加`PYTHONPATH`到您的环境： `export PYTHONPATH=/root/environments/my_env/lib/python3.6/site-packages/`**

# php - 如何解决php中的会话？

> ID：14792606
> 
> 赞同：0
> 
> 时间：2013-02-09T23:01:07.680
> 
> 标签：php, session, xampp

好的，这就是我所做的：我创建了网站，我使用的是 xampp 服务器，我在 phpMyAdmin 中创建了数据库，但是出现了问题，我不得不重新安装 xampp，所以我删除了数据库（是的，我没有't make backup:( )，所以我在安装 xampp 后，创建了相同的数据库。但是现在当我运行 localhost/website 时，我遇到了一些问题：

注意：未定义的索引：第 6 行 C:\xampp\htdocs\BookShop\klasici.php 中的命令，这是第 6 行：

```
if($_REQUEST['command']=='add' && $_REQUEST['productid']>0){ 
```

我认为问题出在会话上，但我没有更改脚本中的任何内容。会话在与数据库连接后开始。谢谢

但是现在当我用这个改变上面的行时：

```
if(isset($_REQUEST['command']) && $_REQUEST['command']=='add' && $_REQUEST['productid']>0) 
```

{

我还有一个问题，我无法更新或删除购物车中的任何 itam，下面是我认为有问题的部分代码：

```
if(isset($_REQUEST['command']) && $_REQUEST['command']=='add' &&$_REQUEST['productid']>0)
    {
    remove_product(isset ($_REQUEST['pid']));
}
else if(isset($_REQUEST['command'])=='clear'){
    unset($_SESSION['cart']);
}
else if(isset($_REQUEST['command'])=='update'){
    $max=count($_SESSION['cart']);
    for($i=0;$i<$max;$i++){
        $pid=$_SESSION['cart'][$i]['productid'];
        $q=intval($_REQUEST['product'.$pid]);
        if($q>0 && $q<=999){
            $_SESSION['cart'][$i]['qty']=$q;
        }
        else{
            $msg='Some proudcts not updated!, quantity must be a number   between 1 and 999';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:03:23.243

尝试将其更改为

if(isset($_REQUEST['command']) && $_REQUEST['command']=='add' && $_REQUEST['productid']>0)

# java - 使用包名在 Java 中创建对象

> ID：14792611
> 
> 赞同：5
> 
> 时间：2013-02-09T23:02:05.903
> 
> 标签：java, object, package

我正在查看其他人的代码，他们使用包名称对其进行编码。

```
String filename = "";

java.io.PrintWriter writer;

writer = new java.io.PrintWriter(new java.io.FileWriter(filename)); 
```

如果没有用包名编码，语法是否等同？既然Java允许，那么用包名对其进行编码有什么用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T23:05:09.693

在以下情况下，您必须使用包名（或“完全限定名” - 这指的是包名和类名）：

1.  您需要在同一个源文件中使用两个同名的类。
2.  `import`无论出于何种原因，您都没有使用您正在使用的课程。（通常是精神错乱。）
3.  你`import`编辑了这些类，但仍然使用包名，因为我不知道。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T23:05:20.997

使用[*完全限定名称*](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html)在语义上与给定类是*导入*的相同。

FQN 的一种可能用法是，如果您需要使用两个具有相同名称但位于不同包中的类。

```
import java.util.Date;

Date date = new Date();
java.sql.Date sqlDate = new java.sql.Date(date); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T23:04:20.663

您*不能*使用包名称，并且代码仍然完全相同，您只需从程序`java.io`顶部的包中导入类：

```
import java.io.PrintWriter;
import java.io.FileWriter;

String filename = "";
PrintWriter writer;

writer = new PrintWriter(new FileWriter(filename)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-09T23:04:55.447

您可以编写包含其包的类名以避免歧义，例如在您的程序编写中有两个名为 PrintWriter 的类`java.io.PrintWriter`将取自 java.io 中的一个。

即使在“标准”类中也有很多重复的名称，这并不奇怪——例如，日期存在于 java.util 和 java.sql 中，队列存在于 java.util 和 javax.jms 中——所以你会从次次。

# ios - 本地通知样式以横幅形式出现，而不是警报

> ID：14792616
> 
> 赞同：0
> 
> 时间：2013-02-09T23:02:37.203
> 
> 标签：ios

所以我正在开发我的第一个应用程序。我正在尝试发出其他功能的警报。根据我的发现，我想要 UIlocalnotification。所以我已经关注了一些关于这个主题的教程，我收到了通知。但是，它显示为很快消失的横幅。我希望它看起来像闹钟提醒...或任何带有 OK、CANCEL 的客户提醒。

在此论坛中进一步阅读后，其他人提出了这个问题，如果我没有正确阅读，只有用户可以指定警报样式的外观。

这是正确的吗？我可以不强制在指定时间弹出警报框吗？
那么 UIAlertView 呢...看起来也像我正在寻找的东西...可以用来像闹钟和未来的 x 时间一样响起吗？

感谢输入，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T00:51:13.837

不，你不能那样做。用户是决定他/她得到什么样的通知的人。

# python - 如何判断 pysqlite 2.6.3 中的更新语句是否成功

> ID：14792619
> 
> 赞同：2
> 
> 时间：2013-02-09T23:03:01.467
> 
> 标签：python, sqlite, pysqlite

我`pysqlite`用来与 SQLite 数据库交谈，我想知道检查`UPDATE`SQL 语句是否实际上已成功更新表中的某些内容的正确方法是什么。

是否有一个变量我可以在执行后快速检查`pysqlite`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T23:20:33.887

检查`cursor.rowcount`属性；它将指示受影响的行数。

如果 an`UPDATE`不成功，`rowcount`则为 0：

```
>>> conn = sqlite3.connect(':memory:')
>>> conn.execute('CREATE TABLE foo (bar, baz)')
<sqlite3.Cursor object at 0x1042ab6c0>
>>> conn.execute('INSERT INTO foo VALUES (1, 2)')
<sqlite3.Cursor object at 0x1042ab730>
>>> cursor = conn.cursor()
>>> cursor.execute('UPDATE foo SET baz=3 WHERE bar=2')
<sqlite3.Cursor object at 0x1042ab6c0>
>>> cursor.rowcount
0
>>> cursor.execute('UPDATE foo SET baz=3 WHERE bar=1')
<sqlite3.Cursor object at 0x1042ab6c0>
>>> cursor.rowcount
1 
```

当然，如果您尝试更新不存在的表或列，则会引发异常：

```
>>> cursor.execute('UPDATE nonesuch SET baz=3 WHERE bar=2')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
sqlite3.OperationalError: no such table: nonesuch
>>> cursor.execute('UPDATE foo SET nonesuchcolumn=3 WHERE bar=2')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
sqlite3.OperationalError: no such column: nonesuchcolumn 
```

我使用Python 附带的[`sqlite3`库来演示这个；](http://docs.python.org/2/library/sqlite3.html)`pysqlite2`在 Python 2.5 中以该名称添加到 Python。不同之处仅在于导入：

```
try:
    import sqlite3  # included library
except ImportError:
    from pysqlite2 import dbapi2 as sqlite3  # use pysqlite2 instead 
```

# perl - socat 在标准输入上阻塞

> ID：14792621
> 
> 赞同：3
> 
> 时间：2013-02-09T23:03:05.570
> 
> 标签：perl, bash, ssl, aix, socat

我在 AIX 主机 myscript.sh 上有一个 bash 脚本，如下所示：

```
MODE="$1"
if [ "$MODE" == "start" ]; then
    socat -T100 -lf $LOGF -d -d -d -x TCP4-LISTEN:$LISTENINGPORT,bind=$LISTENINGADDR,reuseaddr,fork EXEC:"$0 proxy" &
    PID=$!
    echo $PID > $PIDFILE
    echo "$0 $MODE started (pid=$PID)"

elif [ "$MODE" == "proxy" ]; then
    cat - > $TMPFILE
    # process $TMPFILE before the SSL connection.
    cat $TMPFILE | socat -T 100 -lf $LOGF -d - OPENSSL:$HOST
    rm -f $TMPFILE 
```

当我运行时一切都很好：

```
$ cat somefile | myscript.sh proxy | xxd 
```

当我使用测试脚本连接到 socat 侦听器时出现问题：

```
my $file = $ARGV[0];
my $fsize = -s $file;
my $socket = IO::Socket::INET->new("127.0.0.1:$port")
    or die "Couldn't connect to remote host: $!";
$socket->autoflush(1);
binmode($socket);
open (FILE,$file);
binmode(FILE);
my $buffer ;
while(sysread(FILE, $buffer, $blocksize)) {
    print $socket $buffer ;
}
print "sent\n" ;
close (FILE) ;

my $answer = <$socket>;
if (defined($answer)) {
    print $answer; # never reached
print "...\n" ;
} else {
    die "connection reset by peer\n";
} 
```

在 myscript.sh 中，它阻塞就行了：

```
cat - > $TMPFILE 
```

在测试脚本中，它阻塞就行了：

```
my $answer = <$socket>; 
```

至此，数据已经被socat监听器接收到了（用tcpdump检查）。

但是，当我在 socat 超时之前`Ctrl`+`c`测试脚本时，数据会通过管道（即最终联系 SSL 服务器）。

我究竟做错了什么？

更新：感谢有关 cat 和 EOF 的提示。目前，我已经解决了这样的问题：

```
timeout 0.2 cat -u - > $TMPFILE 2>>/dev/null
# process $TMPFILE before the SSL connection.
cat $TMPFILE | socat -T 100 -lf $LOGF -d - OPENSSL:$HOST 
```

很丑，浪费0.2秒，希望能找到更好的解决方案。但它现在完成了这项工作。2>>/dev/null 部分是因为 AIX 抱怨计数器无效（与 timeout 命令有关）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:00:23.607

我的第一个想法是，您尝试使用`cat -`or接收的数据中没有换行符`<STDIN>`。一旦有换行符或文件描述符的缓冲区已满（Linux 中默认为 4KB），这两个命令的默认行为都会返回数据。

# python - python中的简单模式匹配

> ID：14792623
> 
> 赞同：1
> 
> 时间：2013-02-09T23:03:11.220
> 
> 标签：python

我正在尝试用 python 编写一个基本的解释器。所以，我正试图声明在命令提示符中输入的字符串是方法还是变量类型。

所以不要尝试任何花哨的东西..

```
s="12345" #variable
s ="foo()" method
s = "foo(1234)" method 
```

什么是一种强大的方法来做到这一点（例如..对空格健壮...如果语法不正确则抛出错误）

我的代码非常简单

```
s = s.strip()

params=   s[s.find("(") + 1:s.find(")")] # find the params.. 
```

上面的命令适用于案例二和案例三，但对于案例 1.. 它给出了奇怪的结果..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:46:01.983

对于你被要求的场景，我认为这可以解决问题

试试吧

```
s[ 1+s.find("(") if s.find("(") > 0 else None : -1 if s.find(")") > 0 else None] 
```

编辑：按照保罗的建议做一点整洁：

```
s[ 1+s.find("(") if '(' in s else None : -1 if ')' in s  else None] 
```

# http - HTTP缓存控制：无过期日期

> ID：14792624
> 
> 赞同：2
> 
> 时间：2013-02-09T23:03:16.213
> 
> 标签：http, caching, http-headers

我发现了一些与缓存相关的 HTTP 标头：

```
Cache-Control: max-age=3600, must-revalidate
Expires: Fri, 30 Oct 1998 14:19:41 GMT
Last-Modified: Mon, 29 Jun 1998 02:28:12 GMT 
```

我想设置标题，以便一旦加载网页，它就会被缓存。它应该在 24 小时后过期，如果浏览器想在它过期之前加载它，它应该从缓存中加载它（而不是重新验证）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T06:46:06.927

要将您的内容设置为 24 小时后过期，http-header 应该是

```
 Cache-Control: max-age=86400, must-revalidate
       Expires: Fri, 30 Oct 1998 14:19:41 GMT
       Last-Modified: Mon, 29 Jun 1998 02:28:12 GMT 
```

max-age 告诉客户端内容在 86400 秒后过时。must-revalidate 告诉客户端在过期后重新验证内容。

你可以避免`Expires`for , 因为应该使用`HTTP/1.1`HTTP/1.0标头。`Expire`

有关更多详细信息，请参阅以下链接 -

[必须重新验证](https://stackoverflow.com/questions/4006839/how-necessary-it-is-to-use-must-revalidate-in-cache-control-no-cache-must-r)

[最大年龄](https://stackoverflow.com/questions/2932890/http-cache-control-max-age-must-revalidate)

[过期与最大年龄](https://stackoverflow.com/questions/7549177/expires-vs-max-age-which-one-takes-priority-if-both-are-declared-in-a-http-resp)

# asp.net - 在gridview上设置页数

> ID：14792627
> 
> 赞同：2
> 
> 时间：2013-02-09T23:03:23.683
> 
> 标签：asp.net, performance, linq, gridview

我正在尝试根据两种 linq 方法的结果在 gridview 上填充记录： `GetRecords(string SearchCriteria, int skip, int take)`
它为我提供了我要显示到 gridview 中的行数，以及
`CountRecords(string SearchCriteria)`
它为我提供了记录的总数`count`。

首先我通过`CountRecords`方法获取记录数，然后计算页数让用户知道gridview有多少页，但是gridview.PageCount属性是只读的。如何在不获取所有记录的情况下设置 gridview 将拥有的页面数量（它们大约为 300000，所以我负担不起这个选项）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T02:33:15.560

设置虚拟计数。将 AllowCustomPaging 设置为 true。

[http://msdn.microsoft.com/en-us/library/zxdbyxtc.aspx](http://msdn.microsoft.com/en-us/library/zxdbyxtc.aspx)

# javascript - 从函数访问变量

> ID：14792629
> 
> 赞同：2
> 
> 时间：2013-02-09T23:03:30.850
> 
> 标签：javascript

我是 C# 开发人员，正在尝试在 javascripts 中使用面向对象的编程。对于以下代码

```
var np =  np || {};

 np.Class1 = function () {

    var var1,
        var2,
        var3;

    var init = function(a) {
        var1 = a;
        this.var2 = a;
        init3(a);
    };

    var init3 = function(b) {
        this.var3 = b;
    };

    return {
        init: init,
        var1: var1,
        var2: var2,
        var3: var3
    };
};

var t = new np.Class1();
t.init("t");
console.log("var1 " + t.var1);
console.log("var2 " + t.var2);
console.log("var3 " + t.var3); 
```

我越来越：

```
 var1 undefined 
 var2 t 
 var3 undefined 
```

我可以获得私有变量的唯一方法`Class1`是使用`this.var2 = a;`，但它不适用于从其他函数调用的函数。如何从函数访问私有变量`init3()`？

已编辑

即使我`init3()`像这样改变功能

```
var init3 = function(b) {
  var3 = b;
}; 
```

结果是一样的。所以问题仍然有效。如何从函数中操作私有变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:01:52.347

您的退货声明

```
return {
        init: init,
        var1: var1,
        var2: var2,
        var3: var3
    }; 
```

正在公开（设置为返回对象的属性）变量的*初始*值（之前`init`已运行），即`undefined`. `var2`您稍后会通过设置覆盖暴露的值`this.var2 = a`，并尝试对 执行类似的操作`var3`，但是（如先前的答案中所述）它不起作用，因为`this`within`init3`引用`window`. 所以对象属性`var1`并`var3`保持未定义，只会`var2`发生变化。

如果这些变量是对象（包括数组和函数，原样`init`），它们将通过引用而不是值传递，因此`console.log("var1 " + t.var1);`etc. 的输出将表示当前值，而不是初始值。

为了说明，[试试这个](http://jsfiddle.net/kBv9g/)：

```
np.Class1 = function () {
    var someVariables = {},
        self;

    var init = function(a) {
        self = this; // self now refers to the object from which init was called
        someVariables.var1 = a;
        this.var2 = a;
        init3(a);
    };

    var init3 = function(b) {
        self.var3 = b;
    };

    return {
        init: init,
        vars: someVariables
    };
};

var t = new np.Class1();
t.init("t");
console.log("var1 " + t.vars.var1); // 't'
console.log("var2 " + t.var2); // 't'
console.log("var3 " + t.var3); // 't'
var newObj = {init: t.init}
newObj.init(true);
console.log(newObj); // Object {init: function, var2: true, var3: true} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:08:17.050

您`var3`在返回的对象中公开了本地，但您从未将其设置为任何东西；你只设置过`this.var3`。您必须对其进行设置`var3 = b`才能返回一个值。

此外，如果您的意图是让他们保密，为什么要直接公开他们？难道您不想公开操纵对象私有状态的函数（[因为您正在尝试面向对象](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:25:55.240

而不是使用：

```
init3(a); 
```

尝试：

```
init3.call(this, a); 
```

为什么？使用时`init3(a)`，`this`设置为全局对象（`window`在浏览器环境中）。函数的`call`方法可以让你设置`this`别的东西。在这种情况下，我们只想传播我们的`this`价值。

# ruby - 如何切片和切片！影响Ruby中的object_id？

> ID：14792630
> 
> 赞同：1
> 
> 时间：2013-02-09T23:03:55.090
> 
> 标签：ruby

我正在研究`object_id`Ruby 中的方法行为，以便了解何时创建新对象。我可以理解（1）与（2）相同，（3）与（4）相同。但我不明白为什么（5）与（6）不同。

*(1) 到 (6) 下面用我的源代码描述。*

所以我想了解何时`object_id`会在 Ruby 中更改（新分配）。有人简明扼要地解释一下吗？

非常感谢您提前。

**源代码**

```
a = "foo"
b = a
b.slice!(0)

p a.object_id # (1)
p b.object_id # (2)

b = b

p a.object_id # (3)
p b.object_id # (4)

b = b.slice(0)

p a.object_id # (5)
p b.object_id # (6) 
```

**结果**

```
70302398954840                                                                                                                                                                                      
70302398954840
70302398954840
70302398954840
70302398954840
70302398954680 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:06:34.673

变量不是对象，改变对象不会改变对象的*本质*。也就是说，改变一个对象永远不会改变哪些变量对该对象求值。

这两种方法之间的区别在于`slice!`改变原始字符串/对象（ick！）并`slice`返回一个新的字符串/对象*而不*改变原始字符串/对象（耶！）。

在下面`X`表示一个特定（但任意）的字符串，并`Y`表示一个*不同*的特定（但任意）字符串。不要混淆`X`和`Y`与变量；它们仅代表不同的对象来解释行为。

```
a = X                # a = X
b = a                # b = a -> b = X, so b = X
b.slice!(0)          # MUTATE object X

p a.object_id # (1)  # a = X
p b.object_id # (2)  # b = X

b = b                # b = b -> b = X, so b = X (no effect)

p a.object_id # (3)  # a = X
p b.object_id # (4)  # b = X

b = b.slice(0)       # b = f(b), where NEW object (Y) is returned, so b = Y

p a.object_id # (5)  # a = X
p b.object_id # (6)  # b = Y 
```

# jsp - Kendo UI Grids 销毁和更新命令不会触发事件 onclick

> ID：14792633
> 
> 赞同：3
> 
> 时间：2013-02-09T23:04:02.127
> 
> 标签：jsp, kendo-ui

我有这个剑道 UI 网格。它读取并填充网格。但我面临的问题是更新或删除按钮都不会发送 POST 请求。

保存按钮什么也不做。删除按钮给了我一个确认警报框，然后它在网格中将其删除，但没有请求。

```
<kendo:grid name="grid" pageable="true" groupable="false" editable="true" sortable="true" filterable="true" height="300" >
    <kendo:grid-columns>
        <kendo:grid-column title="Account" field="name"/>
        <kendo:grid-column width="250">
            <kendo:grid-column-command>
                <kendo:grid-column-commandItem name="showAccount" text="Visa konto" click="showAccount"/>
                <kendo:grid-column-commandItem name="ShowAccountSummary" text="Sammanställning" click="showAccountSummary"/>
            </kendo:grid-column-command>
        </kendo:grid-column>
        <kendo:grid-column title="&nbsp;" >
            <kendo:grid-column-command>
                <kendo:grid-column-commandItem name="save" />
                <kendo:grid-column-commandItem name="destroy" />
            </kendo:grid-column-command>
        </kendo:grid-column>
    </kendo:grid-columns>
    <kendo:dataSource pageSize="10" batch="false">
        <kendo:dataSource-schema>
            <kendo:dataSource-schema-model id="id">
                <kendo:dataSource-schema-model-fields>
                    <kendo:dataSource-schema-model-field name="id" type="number"/>
                    <kendo:dataSource-schema-model-field name="user_id" type="number"/>
                    <kendo:dataSource-schema-model-field name="name" type="string"/>
                </kendo:dataSource-schema-model-fields>
            </kendo:dataSource-schema-model>
        </kendo:dataSource-schema>
        <kendo:dataSource-transport>
            <kendo:dataSource-transport-read url="${transportReadUrl}" dataType="json" type="GET" contentType="application/json" />
            <kendo:dataSource-transport-update url="${updateAccountUrl}" dataType="json" type="POST" contentType="application/json" />
            <kendo:dataSource-transport-destroy url="${destroyUrl}" dataType="json" type="POST" contentType="application/json" />
        </kendo:dataSource-transport>
    </kendo:dataSource>
</kendo:grid> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T19:06:07.677

我解决了这个问题。数据源需要具有属性“autoSync='true'”

**从剑道手册**

> autoSync 布尔值（默认值：false）
> 
> 为所做的每个更改启用 (true) 或禁用 (false) 自动调用 sync() 方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T20:36:42.657

类似的情况，但我禁用了自动同步，因为我的网格数据源在页面加载后被读取。实现了 javascript 以在 autosync=false 时同步更改或删除。

```
function gridChange(e) {
    if (e.action == "itemchange") {
        e.sender.sync();
    };
    if (e.action == "remove") {
        e.sender.sync();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T20:22:34.277

所以我假设你的 crUD 网址没有被击中。这两个操作背后有一个与 Kendo 想要的不匹配的方法签名。这就是我能用你在这里发布的东西做的所有事情。希望能帮助到你。当你让它工作时，不要忘记在你的更新上将数据返回到网格，否则你会得到有趣的行为。

# php - 日期时间、SELECT 和准备好的语句

> ID：14792645
> 
> 赞同：0
> 
> 时间：2013-02-09T23:05:09.877
> 
> 标签：php, mysqli, prepared-statement

我希望同一个查询使用准备好的语句运行两次，但不能让它工作？

这是我得到的：

```
$yearFrom = date("Y-01-01");
$yearTo = date("Y-12-31");

$monthFrom = date("Y-01-01");
$monthTo = date("Y-01-31");

$stmt = $mysqli->stmt_init();

$getuserpoints = "SELECT SUM(points) as userpoints FROM ".$prefix."_publicpoints
                    WHERE date BETWEEN ? AND ? AND fk_player_id = ?";

if($stmt->prepare($getuserpoints)){
    $stmt->bind_param('ssi', $yearFrom,$yearTo,$playerid);
    $stmt->execute();
    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    }
    $stmt->bind_result($userPoints);

    $stmt->bind_param('ssi', $monthFrom,$monthTo,$playerid);
    $stmt->execute();
    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    }
    $stmt->bind_result($userMPoints);
} 
```

我认为是造成麻烦的日期时间。我该怎么做呢？

提前致谢 ：-）

# c - 归并排序算法

> ID：14792651
> 
> 赞同：1
> 
> 时间：2013-02-09T23:05:49.547
> 
> 标签：c, algorithm, sorting

首先让我说这是硬件，所以我正在寻找更多的建议而不是答案。我要编写一个程序来读取输入序列，然后生成一个链接数组，以升序给出值。

输入文件的第一行是序列的长度 (n)，其余 n 行中的每一行都是一个非负整数。输出的第一行表示最小输入值的下标。其余的每一行输出都是一个三元组，由一个下标以及相应的输入序列和链接值组成。

（在递归排序开始之前链接值不会被初始化。当每个链接的序列值被放置在递归树底部的单个元素列表中时，每个链接将被初始化为-1）

输出看起来像这样：

```
0  3  5
1  5  2
2  6  3
3  7  -1
4  0  6
5  4  1
6  1  7
7  2  0 
```

其中（我认为）最后一列是下标，中心是未排序的数组，最后一列是链接值。我已经有了 mergeSort 的代码，并且了解它是如何工作的，我只是感到困惑以及链接是如何到位的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:06:44.613

我使用结构向量来保存每行的三个值。

主要步骤是：

*   初始化索引并从输入中读取值
*   按值对向量进行排序
*   确定链接
*   按索引对向量进行排序（返回）

这是代码的草图：

```
struct Element {
    int index;
    int value;
    int nextIndex; // link
}

Element V[N + 1];
int StartIndex;

V[i].index = i;
V[i].value = read_from_input;

sort(V); // by value

startIndex = V[0].index;
V[i].nextIndex = V[i + 1].index;
V[N].nextIndex = -1;

sort(V); // by index 
```

# java - 使用字符集解码器以逐字节方式解码多字节 UTF8 符号？

> ID：14792654
> 
> 赞同：4
> 
> 时间：2013-02-09T23:06:29.850
> 
> 标签：java, utf-8, character-encoding

我正在尝试使用字符集解码器逐字节解码 UTF8。这可能吗？

以下代码

```
public static void main(String[] args) {

    Charset cs = Charset.forName("utf8");
    CharsetDecoder decoder = cs.newDecoder();
    CoderResult res;

    byte[] source = new byte[] {(byte)0xc3, (byte)0xa6}; // LATIN SMALL LETTER AE in UTF8

    byte[] b = new byte[1];
    ByteBuffer bb = ByteBuffer.wrap(b);

    char[] c = new char[1];
    CharBuffer cb = CharBuffer.wrap(c);

    decoder.reset();

    b[0] = source[0];
    bb.rewind();

    cb.rewind();
    res = decoder.decode(bb, cb, false);

    System.out.println(res);
    System.out.println(cb.remaining());

    b[0] = source[1];
    bb.rewind();

    cb.rewind();
    res = decoder.decode(bb, cb, false);

    System.out.println(res);
    System.out.println(cb.remaining());

} 
```

给出以下输出。

```
UNDERFLOW
1
MALFORMED[1]
1 
```

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:59:57.863

我的理论是，你这样做的问题是在“下溢”条件下，解码器将未使用的字节留在输入缓冲区中。至少，那是我的阅读。

请注意 javadoc 中的这句话：

> *“无论如何，如果要在同一解码操作中重新调用此方法，则应注意保留输入缓冲区中剩余的任何字节，以便它们可用于下一次调用。”*

但是您正在破坏（大概）未读字节。

`bb`您应该能够通过查看第一次`decode(...)`调用后仍有多少字节未使用来检查我的理论/解释是否正确。

* * *

如果我的理论是正确的，那么答案是您**不能通过**为解码器提供恰好包含一个字节的字节缓冲区来解码 UTF-8。但是您可以通过从包含一个字节的 ByteBuffer 开始并添加额外的字节直到解码器成功输出字符来实现逐字节解码。只要确保您没有破坏尚未使用的输入字节。

请注意，这样的解码效率不高。API 设计针对一次性解码大量字节进行了优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T23:29:43.730

如前所述，utf 每个字符有 1-6 个字节。您需要在解码之前将所有字节添加到字节缓冲区，试试这个：

```
public static void main(String[] args) {

    Charset cs = Charset.forName("utf8");
    CharsetDecoder decoder = cs.newDecoder();
    CoderResult res;

    byte[] source = new byte[] {(byte)0xc3, (byte)0xa6}; // LATIN SMALL LETTER AE in UTF8

    byte[] b = new byte[2]; //two bytes for this char
    ByteBuffer bb = ByteBuffer.wrap(b);

    char[] c = new char[1];
    CharBuffer cb = CharBuffer.wrap(c);

    decoder.reset();

    b[0] = source[0];
    b[1] = source[1];
    bb.rewind();

    cb.rewind();
    res = decoder.decode(bb, cb, false); //translates 2 bytes to 1 char

    System.out.println(cb.remaining()); //prints 0
    System.out.println(cb.get(0)); //prints latin ae

} 
```

# macos - 在 Mac 上与 AVR 微控制器交互

> ID：14792657
> 
> 赞同：1
> 
> 时间：2013-02-09T23:06:36.973
> 
> 标签：macos, avr, avr-gcc, atmel, freertos

我最近购买了[ATiny84 微控制器](https://www.sparkfun.com/products/11232)，我想知道是否可以从运行 snowleopard 的 Macbook Pro 上传代码。具体来说，我可以运行 c 文件和 FreeRTOS 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:24:49.223

正如 H [2] CO [3]建议的那样，您可以使用[avr-gcc 和 avrdude，](http://www.nongnu.org/avr-libc/)但我希望您熟悉 osx 中的 C/复制/设置路径变量。

如果您只是开始使用嵌入式编程，我建议您查看[Arduino](http://arduino.cc)项目。这很容易上手。此外，对于您的特定芯片（ATiny 84），请查看[MIT 的本指南](http://hlt.media.mit.edu/?p=1695)：

![图表](../Images/b9ae02fb5b1a41230d15606b82569570.png)

![小程序员](../Images/26cfb42e6d963a9d7ea6d3e8dbfb47ab.png)

![Arduino板定义](../Images/3370f8b8caf96a31ee61f9b497dd1a22.png)

# c - 将纪元时间字符串转换为时间

> ID：14792658
> 
> 赞同：2
> 
> 时间：2013-02-09T23:06:40.233
> 
> 标签：c, linux, unix, time, epoch

我一直在寻找一种将字符串（以纪元时间）转换为日期的方法。

基本上，我需要把这个：（`1360440555`以字符串形式）做成这个：`Feb 9 12:09 2013`。

我一直在研究 strptime 和 strftime，但似乎都不适合我。有什么建议么？

编辑：谢谢，伙计们。我将它转换为 int `atoi()`，将其转换为`time_t`，然后运行`ctime()`它。工作完美！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T23:19:07.267

如果你的值是整数而不是字符串，你可以调用`ctime`. 如果只有某种方法可以将字符串转换为整数....

```
time_t c;
c = strtoul( "1360440555", NULL, 0 );
ctime( &c ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T23:53:22.417

您可以使用[`%s`(GNU extension)](http://linux.die.net/man/3/strptime)将作为字符串给出的 POSIX 时间戳转换为分解时间`tm`：

```
#define _XOPEN_SOURCE
#include <stdio.h>
#include <string.h>
#include <time.h>

int main() {
    struct tm tm;
    char buf[255];

    memset(&tm, 0, sizeof(struct tm));
    strptime("1360440555", "%s", &tm);
    strftime(buf, sizeof(buf), "%b %d %H:%M %Y", &tm);
    puts(buf); /* -> Feb 09 20:09 2013 */
    return 0;
} 
```

注意：本地时区为 UTC（与其他时区结果不同）。

# php - 如何在 Jquery 中获取 php 值？

> ID：14792660
> 
> 赞同：0
> 
> 时间：2013-02-09T23:07:15.737
> 
> 标签：php, javascript, jquery, jquery-ui

嘿伙计们，我有这个填充的搜索表单，它将根据搜索结果显示一个人员表。我需要能够获取具有我想要获取的用户名的 php 变量，然后使用 JQuery UI 将其发送到 .php 文件，该用户界面将打开一个注释窗口。

所以在这里：

用户名、其他、其他、注释 - 这是一个链接，单击后会调用以下内容：

```
$(document).ready(function () {
    $("#NotesAccessor").click(function () {

      alert(notes_name);
      run();
    });
    }); 
```

这导致 ：

函数 run(){ var url = '/pcg/popups/grabnotes.php'; showUrlInDialog(url); }

到打开 Jquery 对话框的函数。

我需要访问被单击的基于注释的用户名....如果有 20 个不同名称的结果，david、joe、john 等...我单击以 david 作为用户名的注释，我需要那个发送到正在打开的文件，以便我可以在适当的用户名上显示基于的注释。

这是我的php：

```
.........
    <td>
        $csvusername
    </td>
.........
    <td>
    ";
      if ($checkNotes[1] == 'No')
    {
        echo "None";
    }
    if ($checkNotes[1] == 'Yes')
    {
            echo "<a href='#' id='NotesAccessor'>Click to access</a>";
    }
    echo "
    </td>
........ 
```

让我知道这对您是否有意义。我有点坚持这一点，可以用手:)

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:10:31.300

我不知道你想得到什么 PHP 变量，但一般来说，你可以这样做：

```
<!-- /myScript.php?myVar=helloWorld -->
<script type="text/javascript">
    $(document).ready(function(){
        var myPhpVar = <?php echo $_GET['myVar']; ?>;
        alert(myPhpVar);
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:16:15.373

```
<script>
var x = '<?php echo $variable; ?>';
or
var x = '<?php echo my_function(); ?>'; 
</script>

<?php
function my_function()
{
  return $variable;
}
?> 
```

这应该做你喜欢的:)

# php - jquery自动完成与php foreach生成的结果

> ID：14792661
> 
> 赞同：0
> 
> 时间：2013-02-09T23:07:19.013
> 
> 标签：php, jquery, image, autocomplete, foreach

几天来，我一直在尝试让 jquery 自动完成以我需要的方式工作。

到目前为止，我有这个工作正常：

```
<script>
$(function() {
var availableTags = [<?php 

$taglist = Array();
  foreach ($users as $user) 
    if ($user->getAttribute('first_name') == ''){
       $taglist[] = '"'.$user->getUserName().'"';
}else{
       $taglist[] = '"'.$user->getAttribute('first_name').' '.$user->getAttribute('last_name').'"';
}

echo join(',', $taglist); 

?>];

$("#searchmem").autocomplete({
    source: availableTags,
    minLength: 2,
    select: function(event, ui) { 
        $("#searchmem").val(ui.item.label);
        $("#submit").click(); 
    }
}).data("autocomplete")._renderItem = function (ul, item) {
        return $("<li />")
        .data("item.autocomplete", item)
        .append("<a><img src='/files/avatars/1.jpg' />" + item.label + "</a>")
        .appendTo(ul);
    }
});
</script> 
```

这将在相应用户的用户名或全名旁边输出图像 /files/avatars/1.jpg。

我遇到的问题是尝试输出正确的用户头像。每个 .jpg 文件都对应于用户名，因此我可以在 src 中使用 $user->getUserID() 但这不起作用，因为它不在 foreach $users as $user 循环中。

我尝试将整个自动完成脚本放在 foreach 中，测试时确实会提醒正确的事情，但自动完成功能不起作用。

我也尝试过创建两个变量，例如

availableTags1 = { 标签： .... $user->getUserName() 等... }

availableTags2 = { 头像: .... $user->getUserID() 等... }

可用标签 = 可用标签 1 + 可用标签 2；

和

```
.data("autocomplete")._renderItem = function (ul, item) {
    return $("<li />")
    .data("item.autocomplete", item)
    .append("<a><img src=' + item.avatar + ' />" + item.label + "</a>")
    .appendTo(ul);
} 
```

但这又没用。我完全迷路了！如何让它与相关用户名一起输出图像？帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:24:23.487

在您的情况下，您必须构建一个数组，例如：

```
var availableTags = [
    {label: '...', avatar: '...'},
    {label: '...', avatar: '...'},
    ...
]; 
```

并使用：

```
.data("autocomplete")._renderItem = function (ul, item) {
    return $("<li />")
    .data("item.autocomplete", item)
    .append("<a><img src='" + item.avatar + "' />" + item.label + "</a>") // Note the additional double quotes
    .appendTo(ul);
} 
```

（有关使用自定义数据，请参阅[jQuery UI上的此示例）](http://jqueryui.com/autocomplete/#custom-data)

然后，为了通过 PHP 生成你的数组，你应该使用：

```
<?php
$taglist = Array();
foreach ($users as $user) {
    $data = array();
    if ($user->getAttribute('first_name') == ''){
        $data["label"] = $user->getUserName();
    } else {
        $data["label"] = $user->getAttribute('first_name').' '.$user->getAttribute('last_name');
    }
    $data["avatar"] = $user->getUserID();
    $taglist[] = $data;
}
?>
var availableTags = <?php echo json_encode($taglist); ?>; 
```

# c++ - 打印到控制台的警告消息不会导致构建失败

> ID：14792664
> 
> 赞同：1
> 
> 时间：2013-02-09T23:07:23.723
> 
> 标签：c++, unit-testing, visual-studio-2012, compiler-warnings, visual-leak-detector

当错误打开并且警告级别升至最大值时，我会收到警告。我已经在我的单元测试中集成了[VLD 。](http://vld.codeplex.com/)当我故意创建内存泄漏时，VLD 在 Visual Studio 输出控制台和警告控制台中打印一个警告。

警告的格式如下`warning : Visual Leak Detector detected memory leaks!`

但是，Visual Studio 报告生成成功。**作为错误的警告是否仅限于 Visual Studio 生成的警告？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:16:54.000

是的，“警告是错误”是一个编译器设置，基本上是说“如果（错误级别==警告）错误级别=错误；” 在编译器内部。

# javascript - 如何计算垂直时间线的比例

> ID：14792668
> 
> 赞同：0
> 
> 时间：2013-02-09T23:08:25.347
> 
> 标签：javascript, html, css, ruby-on-rails, ruby

我正在尝试创建从最新到最旧排序的事件的垂直时间线，我需要动态创建垂直时间线并按比例间隔将这些事件添加到其中。时间线的长度可能应该根据事件的数量以及这些事件之间的时间分布情况进行调整。

每个事件都有一个 ruby​​ 日期时间属性。我只需要关于如何计算时间线长度以及间隔范围的帮助。这些事件的发生时间可以从几秒到几天到几个月不等。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:17:13.133

大多数图表的轴上都有均匀的间隔。为什么不拿`(dateEnd - dateStart) / 10`？

# android - Android和IOS中SQLite数据库的区别

> ID：14792671
> 
> 赞同：2
> 
> 时间：2013-02-09T23:08:58.377
> 
> 标签：android, ios, sqlite, porting

我的任务是将几个月前构建的 Android 应用程序移植到 iOS 上。

现在，我过去也曾在 iOS 中使用过 SQLite。但是，我记得它比 Android 同类产品要多得多。特别是在查询方面。

在 Android 中，我能够使用以下命令（见下文）执行查询，其中**db**是 SQLite 的实例，**dbName()**是返回数据库名称的方法，**getFieldNames()**返回字段名称字符串的数组where包含 where 子句**。**

```
Cursor result = db.query(dbName(), getDBFieldNames() , where,null,null,null,null); 
```

我想在 SQLite3 的 iOS 版本中使用这样一个漂亮而干净的**db.query**命令。但是，它（或类似的东西）是否存在，因为我找不到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:34:09.210

不同之处在于您将使用用于 sqlite 的 C api，它比 Java 更难使用。它肯定是非常不同的，所以不要指望它会以相同的方式工作。

您应该查看 sqlite 文档，了解如何将[sqlite 与 C/C++ 结合](http://www.sqlite.org/cintro.html)使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T03:06:07.210

可可亚是对的。或者，您可以在 iOS 中使用[FMDB](https://github.com/ccgus/fmdb)，它为您提供了一个很好（但仍然非常轻量级）的 SQLite 包装器。该 API 将与您熟悉的 API 略有不同，但 FMDB 可让您摆脱 SQLite C 接口的杂草。

* * *

因此，在 FMDB 中，您可以使用以下命令打开数据库：

```
FMDatabase *db = [FMDatabase databaseWithPath:dbPath]; 
```

您可以像这样打开您的记录集：

```
FMResultSet *rs = [db executeQuery:@"select rowid,* from test where a = ?", @"hi'"]; 
```

您可以像这样遍历结果集的行：

```
while ([rs next]) {
    // just print out what we've got in a number of formats.
    NSLog(@"%d %@ %@ %@ %@ %f %f",
          [rs intForColumn:@"c"],
          [rs stringForColumn:@"b"],
          [rs stringForColumn:@"a"],
          [rs stringForColumn:@"rowid"],
          [rs dateForColumn:@"d"],
          [rs doubleForColumn:@"d"],
          [rs doubleForColumn:@"e"]);
} 
```

您可以像这样关闭结果集：

```
[rs close]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-05T19:03:02.963

我一直在开发一种工具来帮助在 iOS（使用 ARC）和 Android 上轻松访问 SQLite 数据库。该工具接收一个 sqlite 数据库文件并自动生成基类和一些帮助类来处理 CRUD 查询。还有一些关于如何在 iOS 和 Android 上使用它的示例。我希望这会有所帮助。 [https://github.com/pl4u/flyingdb](https://github.com/pl4u/flyingdb)

# javascript - js，从委托分配的事件中检查父级的子名或选择器

> ID：14792673
> 
> 赞同：2
> 
> 时间：2013-02-09T23:09:02.557
> 
> 标签：javascript, jquery, events, handler

我有一个难题。

```
events = $._data( element[0], 'events'); 

$.each(events, function(_event_name, _event_handler){ 
    var _handlers=[]; 
    for(var i= 0 ;i < _event_handler.length;i ++) 
            _handlers.push(_event_handler[i].handler);
    event_handler.push(_handlers); 
    event_name.push(_event_name); 
}); 

element.off(); 
```

我有上面的代码可以成功读取所有内容`event name`及其`handler`为元素分配的内容。

然后我将它们中的每一个保存到`event_name`关闭`event_handler`事件之前；

但是，此方法仅适用于直接为元素分配事件的情况。

当事件被委派分配时，我该如何开发代码来做到这一点？

```
$(document).on('click', '#id', handler); 
```

上面的代码将只显示事件名称`click`及其处理程序`handler`，而不显示委托分配元素的名称或选择器`#id`。

我想知道如何读取委托分配元素的名称，以便我可以关闭委托，否则父级上的所有事件都将关闭。

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:28:45.580

`selector`存储在单击事件数组中的对象中，如下`selector`所示。

`selector`当您查看`click`直接绑定到元素的事件时，该字段似乎是空的。

我假设您可以以某种方式对您的代码进行检查。请注意，该`selector`属性显然仅供内部使用，因为我过去曾对此提出疑问，当时我发现它偶尔包含奇怪的值。

为此，虽然它可能对你有用，但我不知道它有多可靠，或者即使它会在未来的 jQuery 版本中使用。

但是，如果您只将它用于委托事件，您可能会发现它包含有用的值，但请注意它。

![在此处输入图像描述](../Images/280fc883cb309511f6c35b8310369406.png)

# mysql - MySQL upsert 额外检查

> ID：14792677
> 
> 赞同：3
> 
> 时间：2013-02-09T23:09:10.950
> 
> 标签：mysql, database, upsert

我想使用`INSERT ... ON DUPLICATE KEY UPDATE`. 但我无法让它工作。

这就是我想做的：

1.  尝试插入记录。如果插入成功，那很好。
2.  如果该记录存​​在，则更新该记录。
3.  更新记录时，如果check_status字段为1，则留下description和comment字段。
4.  更新记录时，check_status 字段为 0，然后更新 description 和 comment 字段。

在写出SQL之前，我们假设some_table中有如下记录：

```
column name      | val
-----------------+-------------------------
some_unique_key  | 32
description      | existing description
comment          | existing comment
check_status     | 1 
```

所以为了做我上面描述的操作，我使用 SQL 如下：

```
INSERT INTO some_table ('description', 'comment', 'some_unique_key')
VALUES ('some description', 'some comment', 32)
ON DUPLICATE KEY UPDATE
description = IF(check_status = 1, VALUES(description), 'some description')
comment = IF(check_status = 1, VALUES(comment), 'some comment') 
```

我认为 VALUES(description) 会给我数据库表中现有记录（即“现有描述”）的值。然而，它似乎给了我我试图插入的内容，即“一些描述”。

有谁知道如何使用 SQL 正确执行此操作。尝试 upsert 时引用现有记录中的值的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T23:28:22.937

简单的。不要使用`VALUES()`（您已经在使用它来引用 的现有值`check_status`）：

```
INSERT INTO some_table ('description', 'comment', 'some_unique_key')
VALUES ('some description', 'some comment', 32)
ON DUPLICATE KEY UPDATE
description = IF(check_status = 1, description, 'some description')
comment = IF(check_status = 1, comment, 'some comment') 
```

或者用它来设置新的内容，而不是重复自己：

```
INSERT INTO some_table ('description', 'comment', 'some_unique_key')
VALUES ('some description', 'some comment', 32)
ON DUPLICATE KEY UPDATE
description = IF(check_status = 1, description, VALUES(description))
comment = IF(check_status = 1, comment, VALUES(comment)) 
```

# css - 这是什么意思：css [class*="span"]

> ID：14792678
> 
> 赞同：1
> 
> 时间：2013-02-09T23:09:11.997
> 
> 标签：css, css-selectors

我正在玩 twitter bootstrap，我注意到这个 css 定义，我似乎无法用我自己的 css 定义覆盖它。它是什么以及它意味着什么：

```
[class*="span"] {
  margin-left: 20px;
} 
```

我尝试了谷歌搜索，但没有任何结果 - 也许它不允许搜索字符或其他东西

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T23:12:13.743

这是一个[属性选择器](https://developer.mozilla.org/en-US/docs/CSS/Attribute_selectors)。

`[class*="span"]`选择具有`class`包含以下属性的元素`span`：

```
<div class="in-spanish">Test</div>
               ^^^^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:12:36.933

它是一个[属性选择器](http://css-tricks.com/attribute-selectors/)，用于选择任何具有 class 的元素`span`。

# prolog - Prolog中一组向量的求和

> ID：14792680
> 
> 赞同：1
> 
> 时间：2013-02-09T23:09:31.290
> 
> 标签：prolog

我试图在 Prolog 中总结一组向量。

我有用于总结一个向量中的元素的代码，但我不确定如何将其扩展到多个向量。

我有这个：

```
set_addtion([],0).   
set_addtion([Head | Tail], TotalSum) :-
  set_addtion(Tail, Sum1),
  TotalSum is Head + Sum1. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T07:26:55.363

在 SWI Prolog 中，使用[`sum_list/2`](http://www.swi-prolog.org/pldoc/man?predicate=sum_list/2)and[`maplist/3`](http://www.swi-prolog.org/pldoc/doc_for?object=maplist/3)这是一个简单的组合：

```
sum_vectors(Vectors,Sum):-
  maplist(sum_list,Vectors,Sums),
  sum_list( ... , ... ).           % fill in the blanks! 
```

这是假设这`Vectors`是一个数字列表的列表。

* * *

关于您的代码 - 它不是[*tail-recursive*](http://en.wikipedia.org/wiki/Tail_call)。编写 TR 代码要好得多，堆栈使用将是恒定的*。*为了实现TR，通常意味着*不要拖延你可以马上做的事情*。在这里，您正在延迟添加`Head`, 直到`Sum1`找到 - 但这将是很久以后，当列表的所有其余部分都被消耗掉时。

但是我们有什么可以`Head`立即添加的呢？好吧，我们可以有`SumSoFar`，并添加到*那个*。然后这个新变量将作为一个累加器，它的初始值 - `0`。累加器转换是实现 TR 的标准方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T11:37:24.917

如果你需要处理*嵌套*列表——也许是一些树结构计算的结果——你可以使用这些内置函数：

```
sum_lists(Nested, Total) :-
   flatten(Nested, List),
   sum_list(List, Total). 
```

# c++ - 将字符串转换为整数或双精度数

> ID：14792681
> 
> 赞同：0
> 
> 时间：2013-02-09T23:09:32.640
> 
> 标签：c++, string, int, type-conversion

我知道这是一个重复的问题，我已经查看了很多答案，但到目前为止没有一个真正能够帮助我。

我需要能够将各种字符串传递给两个方法，一个返回一个 double，另一个返回一个 int。主要问题是我需要对这两种方法进行严格的错误检查，以便如果我传递一个不包含数字且仅包含数字的字符串，则该方法不会进行转换。正如我所说，我已经看到了一些解决方案，但我看到的唯一一个好的解决方案（能够遵循）是使用我不想使用的 Boost。至于我在这里无法遵循的答案是其中一部分复制自

[如何在 C++ 中将字符串解析为 int？](https://stackoverflow.com/questions/194465/how-to-parse-a-string-to-an-int-in-c)

## 最佳解决方案

幸运的是，已经有人解决了上述所有问题。C 标准库包含`strtol`没有这些问题的系列。

```
enum STR2INT_ERROR { SUCCESS, OVERFLOW, UNDERFLOW, INCONVERTIBLE };

STR2INT_ERROR str2int (int &i, char const *s, int base = 0)
{
    char *end;
    long  l;
    errno = 0;
    l = strtol(s, &end, base);
    if ((errno == ERANGE && l == LONG_MAX) || l > INT_MAX) {
        return OVERFLOW;
    }
    if ((errno == ERANGE && l == LONG_MIN) || l < INT_MIN) {
        return UNDERFLOW;
    }
    if (*s == '\0' || *end != '\0') {
        return INCONVERTIBLE;
    }
    i = l;
    return SUCCESS;
} 
```

如果有人可以再解释一下，我认为这是我正在寻找的答案，我只是无法充分了解它的作用，以便我可以将这个想法应用于我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:17:18.237

使用[`strtol`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/strtol.html)（和[`strtod`](http://pubs.opengroup.org/onlinepubs/007904975/functions/strtod.html)双打）听起来是正确的方法。您引用的实现直接来自以下文档`strtol`：

*   它`errno`在调用之前设置为零（成功后`strtol`不会更改`errno`）
*   它`errno`在返回时检查`strtol`是否已发出错误信号
*   最后一个条件检查输入是否为空，并且整个输入已被`strtol`.

s的实现`double`看起来是一样的，除了你会使用`strtod`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:18:45.917

作为学习练习，您可能想尝试自己编写此内容。我建议从一些例子开始。您可能希望首先牢牢掌握数字是如何以书面形式表示的。“42”是什么意思？换句话说，2代表什么，4代表什么？同样，“1000000”是什么意思？一旦掌握了这些概念，请写下将字符串转换为整数的步骤（英文）。从那里开始将其转换为代码。如果您在此过程中遇到任何问题，请随时回来提出更多问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T04:21:53.077

我在另一个地方重新措辞了这个问题，终于得到了我正在寻找的答案。对于任何想知道的链接：

[strtol 的基础知识？](https://stackoverflow.com/questions/14794079/basics-of-strtol)

# google-apps-script - 我已准备好信用卡，如何增加应用脚本应用程序的配额限制

> ID：14792689
> 
> 赞同：0
> 
> 时间：2013-02-09T23:10:22.483
> 
> 标签：google-apps-script

我编写了一个完整的应用程序来做一件且唯一的事情，通知驱动器中共享文件夹上的人一个新文件已添加到该文件夹​​中。我必须编写应用程序的事实让我感到莫名其妙，但无论如何。

生成内容的人在添加新文件时单击通知按钮，在好的一天大约是 2 或 300 次，系统将退出，查找新文件，获取其共享对象的列表基于文件夹，并为那些说他们的文件已准备好通过电子邮件中的链接下载的人生成一封电子邮件。

我的问题是他早上 8 点左右开始工作，早上 9 点左右他收到通知说他已经达到了当天的电子邮件配额。

所以，为了节省时间，让我回答一些平凡的问题

1.  他有一个 Google Apps for Business 帐户
2.  不，他不能简单地每天少点击通知按钮。他通常会在 5 到 15 分钟的时间内处理文件
3.  在给定的一年中，他平均向 200 个客户的系统添加了大约 14,000 个文件，我猜每天大约有 600 封电子邮件。
4.  是的，我现在已经多次重写应用程序，以尽量减少调用 api 的次数。我不能比我现在打电话给他们的少，因为工具集不是那么好。
5.  之前运行该系统的服务器是一个 P4 1 gig 处理器，带有 2 gigs 内存和一个 500 gig 硬盘驱动器，位于他地下室的 128k ISDN 线路末端。该服务器处理这项任务超过 10 年，我认为谷歌可以处理负载
6.  他的客户都没有 gmail 帐户，可以将新文件作为共享文件夹通知

我已经准备好用他的信用卡升级 gmailapp api 和 google app 脚本语言中的 driveapp api 的配额，我只需要知道进入哪个屏幕来升级这些配额。

我是否将不得不再次将此应用程序重写为 GAE 应用程序以使其按预期工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:58:45.867

作为更新，事实证明没有人确定这些限制是否可以增加。因此，我在 GAE 中重写了该应用程序。至少使用该框架和 Drive API，如果他达到免费帐户的任何限制，他可以使用信用卡在几分钟内恢复并运行，而不是使用 App Script 毫不客气地关闭他的整个业务 24 小时.

谢谢你们

# php - 使用 php 而不是 mysql 查询随机化数据库结果

> ID：14792714
> 
> 赞同：0
> 
> 时间：2013-02-09T23:13:58.733
> 
> 标签：php, mysql, random, ezsql

我目前在 php 中使用 EZSQL 类来查询 MySQL 数据库。我正在尝试从数据库中获取随机记录，但我想知道是否可以通过 php 而不是 sql 查询本身随机化结果。查询当前如下所示：

```
$results = $db->get_results("SELECT * FROM table ORDER BY RAND()");

foreach($results AS $result)
{

//code here

} 
```

相反，我可以只从数据库中获取结果，然后通过 php 将其随机化吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:25:33.760

不推荐 ORDER BY RAND()：[为什么不使用 mysql ORDER BY RAND()？](https://stackoverflow.com/questions/6592751/why-dont-use-mysql-order-by-rand)

另外： [http ://www.titov.net/2005/09/21/do-not-use-order-by-rand-or-how-to-get-random-rows-from-table/](http://www.titov.net/2005/09/21/do-not-use-order-by-rand-or-how-to-get-random-rows-from-table/)

你可以打电话`shuffle($results)`来随机化一个数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:25:21.507

同意@shuffle，但如果你真的想使用 PHP，我不会使用 foreach；相反，取 $results 大小，获取 0 到 length-1 之间的随机数，并使用它从数组中获取第 n 个元素

# java - 如何计算经过时间的加密和解密算法？

> ID：14792716
> 
> 赞同：3
> 
> 时间：2013-02-09T23:14:20.263
> 
> 标签：java, performance, cryptography

```
for (int ii = 0 ; ii < 200 ; ii++)
    {
     encrypt();    
    }

long start = System.currentTimeMillis();
    for (int ii = 0 ; ii < 2000 ; ii++)
    {
     encrypt();    
    }
long elapsed = System.currentTimeMillis() - start;

for (int ii = 0 ; ii < 200 ; ii++)
    {
     decrypt();    
    }

long start = System.currentTimeMillis();
    for (int ii = 0 ; ii < 2000 ; ii++)
    {
     decrypt();    
    }
long elapsed = System.currentTimeMillis() - start;

private void encrypt()
    {
            M = new BigInteger(64,random);
            C = M.multiply(k).mod(N);  
    }

private void decrypt()
    {
            kk= k.modinverse(N); 
            Mp = kk.multiply(c).mod(N); 
    } 
```

但是我觉得在netbeans平台上运行这个程序的结果是不正确的。有没有办法在执行时间下比较任何两种算法密码学。必要的解密算法是否比加密算法花费更长的时间？请任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:21:01.087

首先，您的加密和解密方法显然不适合任何严重的安全性。

加密方法似乎也包含随机 BigInteger 的生成。通常你只会在生成密钥对时这样做（然后你会生成一个素数，而不是任何随机整数，至少对于 RSA 算法）。所以这是一种什么样的加密/解密方法是我无法理解的。

此外，Java VM 的优化需要很长时间。所以基本上你最好使用非常多的测试轮数，然后将经过的时间除以轮数。

您当前的输出很大程度上取决于随机数生成器的状态。如果熵耗尽，它需要很长时间才能产生新的数字。

# javascript - 本地存储和 Web SQL 不能跨多个页面工作

> ID：14792717
> 
> 赞同：2
> 
> 时间：2013-02-09T23:14:22.800
> 
> 标签：javascript, local-storage, web-sql

一开始我有两个页面（在同一个文件夹中，在同一个域中），我们称它们为 dummy 和 dummy2。

我已经尝试了 html5 localstorage 和现在的 webSQL，我发现我可以在 dummy 上保存和读取数据（dummy 是具有保存和读取按钮的页面，而 dummy2 只有一个读取按钮），但是当我从 dummy 切换时到 dummy2 本地存储和 Web SQL 消失。

据我了解，这两种技术都应该保存要在您网站上的多个页面上使用的数据？

这是我的 webSQL 代码，其中本地存储被注释掉了

```
<script>
    $(document).ready(function () {
        $("#save").click(function() {
            //localStorage.setItem('dummy', 'Hello there');
            //console.log(localStorage.getItem('dummy'));
            var db = window.openDatabase("UserDetails", "1.0", "User Details", 10000);
            db.transaction(populateDB, onDBError, onDBSuccess);
            function populateDB(tx) {
                tx.executeSql('DROP TABLE IF EXISTS DETAILS');
                tx.executeSql('CREATE TABLE IF NOT EXISTS DETAILS (id unique, Name, Email)');
                tx.executeSql('INSERT INTO DETAILS (id, Name, Email) VALUES (1, "User1", "example@example.com")');
            }
            function onDBError(error) {
                console.log("Error");
            }
            function onDBSuccess(msg) {
                console.log("Success (Saved)");
            }
        });
        $("#read").click(function() {
            tx.executeSql('SELECT * FROM DETAILS ORDER BY Name', [], onQuerySuccess, onDBError);
            function onQuerySuccess(tx, results){
                var name = results.row.item(i).Name;
                console.log(name);
            }

        });
    });
</script> 
```

这是点击保存的结果； ![在此处输入图像描述](../Images/a7adf3e6937f647627a8606a364b088b.png)

但是当我搬到 dummy2 时： ![在此处输入图像描述](../Images/9022042315215587ae0f92f6c3f4cc80.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:54:56.787

它是某种奇怪的系统，甚至是关于资源选项卡的 chrome 安装损坏。当我查看它时，您的代码工作正常，并且 localStorage 下的资源选项卡会立即更新并在重新加载时持续存在，尽管我记得有一次资源选项卡对我来说不起作用，并且我遇到了类似的问题，即它无法在刷新时工作，而我必须使用控制台才能看到正确的结果。

如果它在 chrome 控制台中对您有用，或者通过以其他方式以编程方式查询 localStorage 对象，那么它在那些 Web 检查器 UI 中所说的内容并不重要，它仍然可以工作并且您的代码很好。

# ruby - 使用变量名称的一部分创建字典名称

> ID：14792723
> 
> 赞同：0
> 
> 时间：2013-02-09T23:14:59.767
> 
> 标签：ruby

我需要使用数组当前迭代的名称来创建字典的名称。

例如：

```
sites = ["google", "facebook", "twitter", "stackoverflow"]

sites.each do |site|

  #{site}_success_hash = {}  <-- I need the correct syntax for achieving this result.

   ... populate ... hash

end 
```

所以我想要 4 个名为 的哈希值`google_success_hash`，等等。

我无法弄清楚这一点，这让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:27:22.110

您是否考虑过仅嵌套哈希而不是将它们保存在单独的变量中？

像这样的东西：

```
success_hash = {}
sites.each do |site|
  success_hash[site] = #populate hash
end 
```

但是，您要求的事情可以这样完成（假设可以使用实例变量）：

`instance_variable_set("@#{variable_name}", :something)`[（在这里](https://stackoverflow.com/questions/881239/using-a-string-as-a-variable-at-run-time-in-ruby-on-rails) 查看答案）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:25:12.297

首先为您的网站使用符号而不是字符串：

```
sites = [:google, :facebook, :twitter, :stackoverflow] 
```

然后我认为这可能有效：

```
sites.each do |site|
  instance_variable_set("@#{site}_success_hash", {})
  # populate @site_success_hash
end 
```

请注意，您在这里设置了一个实例变量。

# php - FTP 连接错误

> ID：14792724
> 
> 赞同：0
> 
> 时间：2013-02-09T23:15:08.280
> 
> 标签：php, ftp, connect

我正在尝试使用标准 PHP 函数通过 PHP 连接到我的 FTP 站点：

[http://www.php.net/manual/en/function.ftp-login.php>](http://www.php.net/manual/en/function.ftp-login.php)

但它不会连接。不过，我可以通过程序和资源管理器登录服务器。我的服务器中有什么我必须更改的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:23:06.200

*如果没有代码或*错误消息，这有点难以判断，但是，是的，*您*必须运行 FTP 服务器，许多系统默认情况下不会打开。

能够通过资源管理器登录和附加使用不同的功能，不一定与 FTP 端口相关。登录将使用 telnet 端口，而 Explorer 很可能使用 SMB/CIFS。

# activereports - 活动报表关闭 VB6 应用程序

> ID：14792733
> 
> 赞同：0
> 
> 时间：2013-02-09T23:16:33.733
> 
> 标签：activereports

我正在运行带有 ActiveReports Standard v2 sp3 的 VB6。在创建报告时突然在一次安装中应用程序关闭。最终系统要在actrpt2.dll Version 2.0.0.1252 上向Microsoft 报告错误。如果我将客户端数据库复制到我的机器上，它运行得很好。我们已经在几台机器上进行了尝试。我已经重新安装了应用程序。重新注册 DLL。客户端使用的是运行 Server 2003 的终端服务器。它只是一个列式报表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T18:04:38.833

我会怀疑actrpt2.dll 的依赖问题。检查您机器上的依赖关系，并在失败的客户端机器上执行相同操作。

有关检查[依赖关系的详细信息](https://stackoverflow.com/questions/227886/how-do-i-determine-the-dependencies-of-a-net-application)

也许最好联系葡萄城的人，他们的 [论坛](http://www.datadynamics.com/forums/61/ShowForum.aspx)非常活跃。

更新：如果您使用的是 win32 版本的 AR（不是活动报告的 dot net 版本）。尝试[依赖walker](http://www.dependencywalker.com/)来检查依赖

# r - 用 R 中的前一行替换 NA 行

> ID：14792736
> 
> 赞同：3
> 
> 时间：2013-02-09T23:17:02.123
> 
> 标签：r, matrix, na

我想知道是否有人对以下问题有一个快速而肮脏的解决方案，我有一个包含 NA 行的矩阵，我想用前一行替换 NA 行（如果它也不是一行 NA） .

假设第一行不是一行 NA

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T01:11:35.607

改编自对这个问题的回答：[Idiomatic way to copy cell values "down" in an R vector](https://stackoverflow.com/questions/14449717/idiomatic-way-to-copy-cell-values-down-in-an-r-vector/14449823#14449823)

```
f <- function(x) {
  idx <- !apply(is.na(x), 1, all)
  x[idx,][cumsum(idx),]
}

x <- data.frame(a=c(1, 2, NA, 3, NA, NA), b=c(4, 5, NA, 6, NA, 7))

> x
   a  b
1  1  4
2  2  5
3 NA NA
4  3  6
5 NA NA
6 NA  7

> f(x)
     a b
1    1 4
2    2 5
2.1  2 5
4    3 6
4.1  3 6
6   NA 7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:32:18.003

试着想想你可能连续有两个全 NA 行。

```
#create a data set like you discuss (in the future please do this yourself)
set.seed(14)
x <- matrix(rnorm(10), nrow=2)
y <- rep(NA, 5)
v <- do.call(rbind.data.frame, sample(list(x, x, y), 10, TRUE)) 
```

一种方法：

```
NArows <- which(apply(v, 1, function(x) all(is.na(x))))          #find all NAs
notNA <- which(!seq_len(nrow(v)) %in% NArows)                    #find non NA rows
rep.row <- sapply(NArows, function(x) tail(notNA[x > notNA], 1)) #replacement rows
v[NArows, ] <- v[rep.row, ]                                      #assign
v                                                                #view 
```

如果您的第一行都是 NA，这将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T00:09:14.537

您始终可以使用循环，这里假设 1 不是 NA 所示：

```
fill = data.frame(x=c(1,NA,3,4,5))
for (i in 2:length(fill)){
  if(is.na(fill[i,1])){ fill[i,1] = fill[(i-1),1]}
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-15T08:45:25.567

这是一个直截了当且在概念上可能是最简单的单线：

```
x <- data.frame(a=c(1, 2, NA, 3, NA, NA), b=c(4, 5, NA, 6, NA, 7))

   a  b
1  1  4
2  2  5
3 NA NA
4  3  6
5 NA NA
6 NA  7

x1<-t(sapply(1:nrow(x),function(y) ifelse(is.na(x[y,]),x[y-1,],x[y,])))

     [,1] [,2]
[1,] 1    4   
[2,] 2    5   
[3,] 2    5   
[4,] 3    6   
[5,] 3    6   
[6,] NA   7 
```

要放回列名，只需使用 colnames(x1)<-colnames(x)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T01:52:05.877

马修的例子：

```
x <- data.frame(a=c(1, 2, NA, 3, NA, NA), b=c(4, 5, NA, 6, NA, 7))
 na.rows <- which( apply( x , 1, function(z) (all(is.na(z)) ) ) )
 x[na.rows , ] <- x[na.rows-1, ]
 x
#---
   a b
1  1 4
2  2 5
3  2 5
4  3 6
5  3 6
6 NA 7 
```

显然，所有 NA 的第一行都会出现问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-09T23:23:37.693

如果`m`是您的矩阵，这是您快速而**肮脏**的解决方案：

```
sapply(2:nrow(m),function(i){ if(is.na(m[i,1])) {m[i,] <<- m[(i-1),] } }) 
```

请注意，它使用丑陋（且危险）的`<<-`运算符。

# c - c socket：同时接收和发送数据

> ID：14792741
> 
> 赞同：0
> 
> 时间：2013-02-09T23:18:27.607
> 
> 标签：c, sockets, tcp, fork

我在客户端实现多个客户端连接的客户端服务器聊天程序时遇到问题。问题是我遇到的是我应该如何同时发送（聊天消息到另一个客户端）和接收（来自另一个客户端的聊天消息）？发生的事情是我总是在发送数据而从不阅读。我是否需要分叉并读取另一个发送？

这是相关代码

**客户端**

```
while(1) {

  fd_set rfds, wfds;
  FD_ZERO(&rfds);
  FD_ZERO(&wfds);

  FD_SET(serverSocket, &rfds);
  FD_SET(serverSocket, &wfds);

  if(select(serverSocket+1, &rfds, &wfds, NULL, NULL) < 0) {
      perror("select");
      exit(-1);
  }

  if (FD_ISSET(serverSocket, &rfds)) {
     // we got data, read it
  }
  if (FD_ISSET(serverSocket, &wfds)) {
     printf(">");

     // read keyboard
     sendLen = 0;
     while ((cmd[sendLen] = getchar()) != '\n')
        sendLen++;
     cmd[sendLen] = '\0';

     // send the data
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:47:44.333

您也应该将文件描述符 0（标准输入）放在 select 中，然后读取字符并缓冲它们，当套接字可用于写入时，将整个缓冲区复制到上面。这样，您就一直阻止读取标准输入。

添加

```
FD_SET(0, &rfds); 
```

所以当用户输入某些内容时，select 也会返回。

您还必须使用 fcntl 将 stdin 设置为非阻塞。然后每次 select 都会告诉您 stdin 上有数据，请执行以下操作：

```
while(read(0,buffer+filled,1)>0) {} 
```

如果缓冲区已满，请确保设置另一个条件以退出循环。

然后，当您可以在套接字上写入时，发送缓冲区中字节数的大小，检查是否所有字节都已写入，或者将剩余字节移动到缓冲区的开头。

while(getchar()) 阻止您接收任何消息。

# java - 重新定位并将按钮更改为图像？

> ID：14792742
> 
> 赞同：0
> 
> 时间：2013-02-09T23:18:36.743
> 
> 标签：java, swing, user-interface, jpanel, jbutton

我正在尝试重新定位按钮，使其位于框架的右下角，但是我尝试的所有操作（例如 setLocation 和 setBounds）似乎都没有做任何事情。另外，如何将按钮更改为图像？所以它仍然是一个按钮，但显示了一个图像。

```
package TrainCounselor;

import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Start extends JPanel {

public Start() {

    // Game Properties
    setOpaque(false);
    setLayout(new FlowLayout());

}

public void paint(Graphics g) {
    Image a = Toolkit
            .getDefaultToolkit()
            .getImage(
                    "C:/Users/Mel/workspace/camptycoon/javagame/src/javagame/background1.png");
    g.drawImage(a, 0, 0, this);
    super.paint(g);
}

public static void main(String[] args) {
    JFrame myFrame = new JFrame("Put Image");
    JButton startButton = new JButton("Start");
    startButton.setLayout(null);
    startButton.setLocation(50, 50);
    Start c = new Start();
    c.add(startButton);
    myFrame.add(c);
    myFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    myFrame.setTitle("Counselor Training");
    myFrame.setSize(755, 600);
    myFrame.setResizable(false);
    myFrame.setVisible(true);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:27:03.343

> 我正在尝试重新定位按钮，使其位于框架的右下角

使用适当的布局管理器。

我将从使用具有右对齐 FlowLayout 的 JPanel 开始。然后将此面板添加到 JFrame 使用的 BoderLayout 的“SOUTH”。

有关详细信息，请参阅[布局管理器的视觉指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)。

请注意，当您将 Start 类添加到框架时，您将其添加到“CENTER”，而不是南边。此外，自定义绘画是通过覆盖 paintComponent() 方法而不是 paint() 方法完成的，并且不要忘记在绘制图像之前调用 super.paintComponent()，而不是之后。

> 另外，如何将按钮更改为图像？所以它仍然是一个按钮，但显示了一个图像。

阅读 Swing 教程中有关[如何使用按钮](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)的部分。

# ios - 通过原生 iOS 应用使用 Devise 创建用户帐户

> ID：14792746
> 
> 赞同：1
> 
> 时间：2013-02-09T23:18:58.183
> 
> 标签：ios, ruby-on-rails, json, devise

我有一个使用[Devise](https://github.com/plataformatec/devise "设计")进行身份验证的本机 Rails 应用程序（使用[token_authenticable](http://rubydoc.info/github/plataformatec/devise/master/Devise/Models/TokenAuthenticatable%20%22Token%20Authenticatable)模块）。使用现有帐户，一旦获得令牌，我就可以使用 JSON 在我的本机 iOS 应用程序中成功执行 API 调用。

我想添加通过 iOS 应用程序**创建新帐户**的功能，而无需使用浏览器。Devise 是否只允许通过 HTML 创建帐户？

我看过这篇文章 [Rails/Devise - Creating new users via json request](https://stackoverflow.com/questions/9044141/rails-devise-creating-new-users-via-json-request?lq=1)

并通过 CURL 尝试了各种方法，包括：

```
$ curl -H "Content-Type: application/json" -d '{"email":"who@me.com","password":"mypass"}' -vX POST http://localhost:5000/users.json
...
* Connected to localhost (127.0.0.1) port 5000 (#0)
> POST /users.json HTTP/1.1
> User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
> Host: localhost:5000
> Accept: */*
> Content-Type: application/json
> Content-Length: 44
> 
* upload completely sent off: 44 out of 44 bytes
< HTTP/1.1 406 Not Acceptable 
< Content-Type: application/json; charset=utf-8
< X-Ua-Compatible: IE=Edge
< Cache-Control: no-cache
< X-Request-Id: 338234ca2a6c378426ab67d7a080d44e
< X-Runtime: 0.006427
< Server: WEBrick/1.3.1 (Ruby/1.9.3/2012-12-25)
< Date: Sat, 09 Feb 2013 23:11:19 GMT
< Content-Length: 1
< Connection: Keep-Alive
< Set-Cookie: _MyRailsApp_session=BAh7BkkiD3Nlc3Npb25faWQGOgZFRkkiJTY1ZWIzMTdiYzc5ODdmMzNkOWI5MDM4NTMzYTQ0MWVkBjsAVA%3D%3D--c5871e8577987f36c614483b7a28b08fed55b7b8; path=/; HttpOnly 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T00:13:34.073

为设计启用 json

config.navigational_formats = [" */* ", :json]

并添加新文件

```
class RegistrationsController < Devise::RegistrationsController

  def create

    @user = User.create(params[:user])
    if @user.save
      render :json => {:state => {:code => 0}, :data => @user }
    else
      render :json => {:state => {:code => 1, :messages => @user.errors.full_messages} }
    end

  end
end 
```

在路线：

```
 devise_for :users, :controllers => {:registrations => "registrations"} 
```

**更新**

json也应该看起来：

```
{"user" : {"email":"who@me.com","password":"mypass"}} 
```

# git - SSH 到 Openshift 服务器失败

> ID：14792747
> 
> 赞同：5
> 
> 时间：2013-02-09T23:19:00.397
> 
> 标签：git, ssh, openshift

我在 openshift 服务器上使用 jboss catridge。我希望与其他人共享此实例并添加其他用户的公钥(id_rsa.pub)。当其他人尝试访问该实例时，他会收到以下错误。我对他的实例进行了同样的尝试，但我看到了同样的错误。与 openshift 实例共享代码并在开发人员之间同步代码的最佳方式是什么。在这一点上，我们没有私人 Github 存储库。请指教。

```
2013-02-09 14:37:47 Connecting to 54.234.36.245 port 22
2013-02-09 14:37:47 Server version: SSH-2.0-OpenSSH_5.3
2013-02-09 14:37:47 Using SSH protocol version 2
2013-02-09 14:37:47 We claim version: SSH-2.0-PuTTY_Release_0.61
2013-02-09 14:37:47 Doing Diffie-Hellman group exchange
2013-02-09 14:37:47 Doing Diffie-Hellman key exchange with hash SHA-256
2013-02-09 14:37:51 Host key fingerprint is:
2013-02-09 14:37:51 ssh-rsa 2048 cf:ee:77:cb:0e:fc:02:d7:72:7e:ae:80:c0:90:88:a7
2013-02-09 14:37:51 Initialised AES-256 SDCTR client->server encryption
2013-02-09 14:37:51 Initialised HMAC-SHA1 client->server MAC algorithm
2013-02-09 14:37:51 Initialised AES-256 SDCTR server->client encryption
2013-02-09 14:37:51 Initialised HMAC-SHA1 server->client MAC algorithm
2013-02-09 14:37:51 Using SSPI from SECUR32.DLL
2013-02-09 14:37:51 GSSAPI authentication request refused
2013-02-09 14:37:51 Access denied
2013-02-09 14:37:51 Disconnected: No supported authentication methods available (server sent: publickey,gssapi-keyex,gssapi-with-mic) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T04:27:08.673

我终于让这个工作了：

1.  将转换后的密钥（.ppk 文件）从 puttygen 添加到 pagent。
2.  使用 putty 访问在 openshift 服务器中定义的 git url。

ssh 和 git 访问现在都可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:31:57.197

如果您使用 GSSAPI 进行身份验证，您的系统和服务器必须启用它。根据您的错误消息，这似乎是失败前最后一次尝试的身份验证形式。

# css - 在 Sencha Touch 2 的视图中，列表不会以适当的高度显示其他元素

> ID：14792748
> 
> 赞同：0
> 
> 时间：2013-02-09T23:19:02.960
> 
> 标签：css, listview, height, sencha-touch-2

我有一个包含一些内容和列表的布局。我已经为包含元素尝试了各种 ST2 布局，但我根本无法显示列表。有数据，我通过开发者控制台强制列表的高度验证了这一点。这是我的视图的配置代码：

```
config: {
        scrollable: {
            direction: 'vertical',
            directionLock: true
        },
        items: [
            {
                xtype: 'container',
                layout: 'vbox',
                items: [
                    {
                        xtype: 'container',
                        layout: 'vbox',
                        cls: 'retailer-detail-container',
                        items: [
                            {
                                xtype: 'container',
                                layout: {
                                    type: 'hbox'
                                },
                                items: [
                                    {
                                        xtype: 'img',
                                        cls: 'offerDetailImg',
                                        itemId: 'retailer-detail-image'
                                    },
                                    {
                                        xtype: 'container',
                                        layout: 'vbox',
                                        items: [
                                            {
                                                xtype: 'container',
                                                layout: 'vbox',
                                                items: [
                                                    {
                                                        xtype: 'panel',
                                                        cls: 'offer-detail-name',
                                                        itemId: 'retailer-detail-name'
                                                    },
                                                    {
                                                        xtype: 'panel',
                                                        cls: 'offer-detail-distance',
                                                        itemId: 'retailer-detail-distance'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'container',
                                                cls: 'offer-detail-actions',
                                                layout: 'hbox',
                                                items: [
                                                    {
                                                        xtype: 'button',
                                                        cls: 'retailer-detail-contact-button',
                                                        itemId: 'retailer-detail-contact-button'
                                                    },
                                                    {
                                                        xtype: 'button',
                                                        cls: 'retailer-detail-map-button',
                                                        itemId: 'retailer-detail-map-button'
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                xtype: 'container',
                                cls: 'offer-detail-description',
                                itemId: 'retailer-detail-description'
                            }
                        ]
                    },
                    {
                                xtype: 'list',
                                itemId: 'retailerOffersList',
                                scrollable: 'true',
                                ui: 'round',
                                itemTpl: '<strong>{offer_title}</strong>',
                                onItemDisclosure: true
                    }
                ]
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T04:21:46.837

关于这个已经有几个问题了，你有没有尝试过他们的一些答案？我的第一个建议是使用`layout`列表的直接父级的属性：

```
layout:'fit' 
```

*   [Sencha Touch 2：面板中不显示列表](https://stackoverflow.com/questions/10820016/sencha-touch-2-list-does-not-display-in-panel)
*   [Sencha Touch 2 - 无法显示列表//或加载商店？[更新 X2]](https://stackoverflow.com/questions/12334109/sencha-touch-2-cant-get-list-to-display-or-load-a-store-updated-x2)

# html - 在html中定位？

> ID：14792750
> 
> 赞同：-2
> 
> 时间：2013-02-09T23:19:13.143
> 
> 标签：html, css, positioning

如何在我的网站上放置[这个](http://i1081.photobucket.com/albums/j359/hetsig/test2-2_zps4d6d9b4a.png)L 形容器，使其看起来像[这样](http://i1081.photobucket.com/albums/j359/hetsig/testest_zps6876a446.png)？

当涉及到网页设计或代码时，我几乎一无所知，我在这里得到了一些帮助，并且能够将 2 个图像放入其中，但是在正确定位它时我感到完全迷失了。

我的网站的 html

```
<!--==============================content================================-->
<section id="content">
<div class="container_12">
    <div class="grid_9" style="width:900px;">
        <h2>Etvab luxury estates</h2>
        <div class="line-1">
        </div>
        <div style="float: left; width:410px;">
            <p>
                &nbsp;<br>
            </p>
            <p>
                Etvab luxury estates är en webportal för den kräsne bostadsköparen. Här har vi samlat ett representativt urval av de mest exklusiva bostäderna på Spaniens södra kust. Bostäder med unika lägen – havsnära eller örnnästen. Bostäder med förfinad design. Bostäder med vyer som är ”breathtaking”. Bostäder med luft och ytor som andas välbefinnande. Bostäder som har allti modern utrustning och senaste teknologi. Vi har medvetet lagt ribban högt, för att kittla fantasin, ge en svindlande resa i tid och rum och visa det bästa av spansk modern arkitektur. Vi har i första hand valt bostäder med lägen och kvalitet som är i absolut topskikt. Vi har inte tittat på status i områden då vi bedömer att det inte avgör bostadens värde och attraktion. Vår ambition är att förnya dessa sidor regelbundet, till nöje och nytta för den som söker inspiration till ett husköp med högsta kvalitet och läge. Men även för den som njuter av design och vackra miljöer - på avstånd.
            </div>
            <p>
                &nbsp;<br>
            </p>
            <style>
        .qs_input { height:40px; padding: 0px 0px 0px 8px; background: #f3f3f3; border: 1px solid #dfdfdf; border-bottom: 2px solid #d7d6d6; font-family: 'Helvetica Neue', sans-serif; font-size: 1.0 em;}
        .the_table {font-family: 'Helvetica Neue', sans-serif; font-size: 0.8em;}
        .fastighet { padding:5px;}
        .inne { padding:8px 0px 8px 8px;  height:15px;}
            </style>
            <div id='qsResale' class='qs_body' style='width:50%; float:right; margin-left: 15px; padding:0px; margin: 0px;'>
                <form name='qsFormResale' id='qsFormResale' method='post' action='search.php'>
                    <table class="the_table" style='width:98%; float:left;'>
                    <tr>
                        <td class='qs_label' style='width:98%;'>
                            <h7>Typ av fastighet</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select class='qs_input fastighet' name='Type' id='Type' style='width:90%;'>
                                <option class='qs_input' value='No Preference'></option>
                                <option class='qs_input' value='S'>Studio</option>
                                <option class='qs_input' value='A'>Lägenhet</option>
                                <option class='qs_input' value='T'>Radhus</option>
                                <option class='qs_input' value='V'>Villa</option>
                                <option class='qs_input' value='P'>Tomt</option>
                                <option class='qs_input' value='C'>Kommersiella</option>
                                <option class='qs_input' value='AS'>Lägenhet & Studio</option>
                                <option class='qs_input' value='AT'>Lägenhet & radhus</option>
                                <option class='qs_input' value='AV'>Lägenhet & villa</option>
                                <option class='qs_input' value='TV'>Radhus & villa</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label' style='vertical-align:top;'>
                            <h7>Kust</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select class='qs_input fastighet' name="Area" id="Area" onchange="cambia(this, document.qsFormResale.Location);" style='width:90%;'>
                                <option value='Costa de la Luz'>Costa de la Luz</option>
                                <option value='Costa del Sol'>Costa del Sol</option>
                                <option value='Costa del Sol East'>Costa del Sol East</option>
                                <option value='Granada (Costa Tropical)'>Granada (Costa Tropical)</option>
                                <option value='Almería (Costa Almería)'>Almería (Costa Almería)</option>
                                <option value='Murcia (Costa Calida)'>Murcia (Costa Calida)</option>
                                <option value='Alicante (Costa Blanca)'>Alicante (Costa Blanca)</option>
                                <option value='Costa Azahar'>Costa Azahar</option>
                                <option value='Costa Brava'>Costa Brava</option>
                                <option value='Costa Dorada'>Costa Dorada</option>
                                <option value='Ibiza'>Ibiza</option>
                                <option value='Cordoba'>Cordoba</option>
                                <option value='Tenerife'>Tenerife</option>
                                <option value='Mallorca'>Mallorca</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label' style='vertical-align:top;'>
                            <h7>Område</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select class='qs_input' size='5' style="height:150px; width:395px;" name='Location' id='Location' multiple='multiple' style='width:90%;'>
                                <option class='qs_input inne' value='No Preference'>Ingen Preferens</option>
                                <option class='qs_input inne' value='Ayamonte'>Ayamonte</option>
                                <option class='qs_input inne' value='Huelva'>Huelva</option>
                                <option class='qs_input inne' value='Sanlucar de Barrameda'>Sanlucar de Barrameda</option>
                                <option class='qs_input inne' value='Tarifa'>Tarifa</option>
                                <option class='qs_input inne' value='Jimena de la Frontera'>Jimena de la Frontera</option>
                                <option class='qs_input inne' value='San Pablo de Buceite'>San Pablo de Buceite</option>
                                <option class='qs_input inne' value='Jerez de la Frontera'>Jerez de la Frontera</option>
                                <option class='qs_input inne' value='Cadiz'>Cádiz</option>
                                <option class='qs_input inne' value='Olvera'>Olvera</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label'>
                            <h7>Sovrum</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select size='1' class='qs_input fastighet' name='Beds' id='Beds' style='width:90%;'>
                                <option class='qs_input' value='No Preference'>Ingen Preferens</option>
                                <option class='qs_input' value='1'>1 Bädd</option>
                                <option class='qs_input' value='1x'>1 Bädd eller fler</option>
                                <option class='qs_input' value='2'>2 Bäddar</option>
                                <option class='qs_input' value='2x'>2 Bäddar eller fler</option>
                                <option class='qs_input' value='3'>3 Bäddar</option>
                                <option class='qs_input' value='3x'>3 Bäddar eller fler</option>
                                <option class='qs_input' value='4'>4 Bäddar</option>
                                <option class='qs_input' value='4x'>4 Bäddar eller fler</option>
                                <option class='qs_input' value='5'>5 Bäddar</option>
                                <option class='qs_input' value='5x'>5 Bäddar eller fler</option>
                                <option class='qs_input' value='6'>6 Bäddar</option>
                                <option class='qs_input' value='6x'>6 Bäddar eller fler</option>
                                <option class='qs_input' value='7'>7 Bäddar</option>
                                <option class='qs_input' value='7x'>7 Bäddar eller fler</option>
                                <option class='qs_input' value='8'>8 Bäddar</option>
                                <option class='qs_input' value='8x'>8 Bäddar eller fler</option>
                                <option class='qs_input' value='9'>9 Bäddar</option>
                                <option class='qs_input' value='9x'>9 Bäddar eller fler</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label'>
                            <h7>Pris från</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <p>
                                <input type='text' class='qs_input' id='PriceMin' name='PriceMin' style='width:80%;' value='0' maxlength='8' onchange='return f_checkNumber(this,0,0);'>
                                &nbsp;<span class='qs_text'>&euro;</span>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label'>
                            <h7>Pris upp till</h7>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type='text' class='qs_input' id='PriceMax' name='PriceMax' style='width:80%;' value='0' maxlength='8' onchange='return f_checkNumber(this,0,0);'>&nbsp;<span class='qs_text'>&euro;</span>
                        </td>
                    </tr>
                    <tr>
                        <td class='qs_label'>
                            <h7>Referens nr</h7>
                        </td>
                    </tr>
                    <tr>
                        <td style='padding-right:5%;'>
                            <input type='text' class='qs_input' id='RefNum' name='RefNum' value='' maxlength='12'>
                        </td>
                    </tr>
                    <tr>
                        <td style='padding-top:10px;'>
                            <input type='submit' input type='button' class="button-5" value="Sök">
                        </td>
                    </tr>
                    </table>
                    <input type='hidden' name='P1' id='P1' value='ETvabResales'>
                    <input type='hidden' name='P2' id='P2' value='R'>
                    <input type='hidden' name='P3' id='P3' value='ALL'>
                    <input type='hidden' name='QS' id='QS' value='RESALE'>
                    <input type='hidden' name='Country' id='Country' value='Spain'>
                    <input type='hidden' name='RentalType' id='RentalType' value=''>
                    <input type='hidden' name='RentalDateFrom' id='RentalDateFrom' value='06-02-2013'>
                    <input type='hidden' name='RentalDateTo' id='RentalDateTo' value='06-02-2013'>
                    <input type='hidden' name='Language' id='Language' value='8'>
                    <input type='hidden' name='CustomArea' id='CustomArea' value=''>
                </form>
            </div>
        </div>
    </div>
    <div class="clear">
    </div>
    </section>
    <div class="clear">
    </div>
    <!--==============================footer=================================-->
    <footer>
    <div class="container_12">
        <div class="grid_12">
            <div class="line-2">
            </div>
        </div>
        <div class="grid_2">
            <p>
                &nbsp;
            </p>
            <h5>Kontor Stockholm: </h5>
            <h5>Kontor Marbella:</h5>
            <h5>E-mail:</h5>
            <ul class="list1">
            </ul>
        </div>
        <div class="grid_2">
            <p>
                &nbsp;
            </p>
            <h5>+46 8 966 545</h5>
            <h5>+34 951087873</h5>
            <h5>Info@etvab.nu</h5>
            <ul class="list1">
            </ul>
        </div>
        <div class="grid_2">
            <h3 class="marg6"></h3>
            <ul class="list1">
            </ul>
        </div>
        <div class="grid_2">
            <p>
                &nbsp;
            </p>
            <h5>&nbsp;</h5>
            <p>
                &nbsp;
            </p>
            <ul class="list1">
            </ul>
        </div>
        <div class="grid_4">
            <p class="foot-text">
                Etvab luxury estates © 2012 <a href="index-6.html"></a>&nbsp;
                <!-- {%FOOTER_LINK} -->
            </p>
        </div>
        <div class="clear">
        </div>
    </div>
    <div class="clear">
    </div>
    </footer>
</div>
</body>
</html> 
```

图像的 HTML

```
<div class="container-3">
  <div class="top"><img src="Images/bildlyx2.jpg" height="626" class="img1" />
  </div>
  <div class="bottom"></div>
  <img  src="Images/bildlyx1.jpg" width="202" height="210" class="img5" />
</div>
</div> 
```

图像和容器的 CSS

```
.img1{
    top: 1px;
    left: -1px;
    z-index: 10;
    position: absolute;
    width: 452px;
    height: 660px;
}

.img5{
    top: 439px;
    right: 42px;
    z-index: 20;
    position: absolute;
    width: 574px;
    height: 230px;
}

.container-3{    
  position:relative; 
}

.top{
    width: 459px;
    height: 800px;
    border-bottom: none;
    position: absolute;
    z-index: 4;
} 

.bottom{
  z-index:2;
  width: 1100px;
  height: 250px;
  position:absolute;
  top:600px;
  left:0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:27:17.330

DIV 本质上是矩形的，不能是“L”形。由于您已经在使用绝对定位，因此只需定位您的图像并为表格留出空间。然后设置表单的 z-index 并将其绝对定位在图像容器的顶部。

# node.js - 使用 Express.js 在 Node.js 中获取 POST 参数

> ID：14792753
> 
> 赞同：1
> 
> 时间：2013-02-09T23:19:51.783
> 
> 标签：node.js, http, post, express

我试图在使用 Express 的请求后获取一些 POST 参数，但我无法获取数据。这是我的`app.configure`：

```
app.configure(function() {
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');

    app.use(express.bodyParser());
    app.use(express.methodOverride());

    app.use(gzippo.staticGzip(__dirname + '/public'));
    app.use(gzippo.compress());
}); 
```

在 POST HTTP 请求之后，我尝试在控制台中输出它：

```
console.log(req.body); 
```

对象始终为空。

知道我忘记了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:33:55.933

您必须使用**req.body**来检索正文参数。您也必须在 HTML 代码中使用表单。

例子：

```
<form action="myaction" method="post">
  <input name="address" id="address" type="text" />
  <button type="submit" value="Send" />
</form> 
```

...

在您的表格中：

```
var address = req.body.address; //get address value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T01:55:17.380

我唯一需要做的就是从这段代码中添加正文解析器和 app.post 行：

```
app.use(express.static(__dirname + '/public'))
    .use(express.favicon())
    .use(express.bodyParser())
    .use(express.cookieParser(COOKIE_P))
    .use(express.session());

app.post('/',function(req,res){
    res.writeHead(200,{"content-type":"text/html;charset=UTF8;"});
    res.end("POST");
    console.log(req.body);
}); 
```

我的失败是尝试从 app.get 而不是 app.post 获取值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T00:58:21.917

尝试交换以下行：

```
app.use(express.bodyParser());
app.use(express.methodOverride()); 
```

# c# - 将 JSON 字符串转换为 C# 字符串数组

> ID：14792755
> 
> 赞同：3
> 
> 时间：2013-02-09T23:20:01.867
> 
> 标签：c#, json, string, split, stringify

使用 JSON.Stringify 我在另一个 Stringify 对象中传递了以下字符串。

```
[
    [
        "I-000-4310-000",
        "Convention Registration",
        "59.99"
    ],
    [
        "I-000-4311-000",
        "Convention Breakout",
        "39.99"
    ]
] 
```

在我的 C# Web 服务中，我需要将字符串拆分成一个字符串数组，如下所示：

```
 string[, ,] GLCodes = new string[,,] 
 { 
    {
        { "I-000-4310-000", "Convention Registration", "59.99" }, 
        { "I-000-4311-000", "Convention Breakout", "9.99" }
    } 
 }; 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T15:25:15.437

使用 Json.NET，您可以使用此反序列化该列表

```
string[][] strings = JsonConvert.DeserializeObject<string[][]>(jsonData); 
```

希望这可以帮助！

# c - 使用 C 中的位运算向下舍入浮点数

> ID：14792758
> 
> 赞同：0
> 
> 时间：2013-02-09T23:20:25.533
> 
> 标签：c, floating-point, bit-manipulation

我正在尝试使用 C 中的位运算来舍入浮点数。我首先将浮点数转换为无符号整数。我认为我的策略应该是获取指数，然后将位归零，但我不确定如何编码。这是我到目前为止所拥有的：

```
float roundDown(float f);
unsigned int notRounded = *(unsigned int *)&f;
unsigned int copy = notRounded;
int exponent = (copy >> 23) & 0xff;
int fractional = 127 + 23 - exponent;
if(fractional > 0){
   //not sure how to zero out the bits. 
   //Also don't know how to deal with the signed part. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:11:14.800

因为它只是为了好玩，而且我不确定约束是什么，所以这里有一个变体，它确实适用于负数：

```
float myRoundDown_1 (float v) {        //only works right for positive numbers
    return ((v-0.5f)+(1<<23)) - (1<<23);
}

float myRoundDown_2 (float v) {        //works for all numbers
    static union {
        unsigned long i;
        float f;
    } myfloat;
    unsigned long n;
    myfloat.f = v;
    n = myfloat.i & 0x80000000;
    myfloat.i &= 0x7fffffff;
    myfloat.f = myRoundDown_1(myfloat.f+(n>>31));
    myfloat.i |= n;
    return myfloat.f;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:42:07.107

`float roundDown(float f);`应该是`float roundDown(float f) {`。

`unsigned int notRounded = *(unsigned int *)&f;`与现代编译器优化不兼容。查找“<a href="https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule">严格别名”。

这是一个向下取整到 2 次方的工作函数：

```
#include <stdio.h>
#include <assert.h>
#include <string.h>

float roundDown(float f) {
  unsigned int notRounded;
  assert(sizeof(int) == sizeof(float));
  memcpy(&notRounded, &f, sizeof(int));

  // zero out the significand (mantissa):
  unsigned int rounded = notRounded & 0xFF800000; 

  float r;
  memcpy(&r, &rounded, sizeof(int));
  return r;
}

int main()
{
  printf("%f %f\n", 1.33, roundDown(1.33));
  printf("%f %f\n", 3.0, roundDown(3.0));
} 
```

这应该产生：

```
1.330000 1.000000
3.000000 2.000000 
```

# c# - .NET 中是否有等效于 WinAPI GetColorDirectory 的方法？

> ID：14792764
> 
> 赞同：2
> 
> 时间：2013-02-09T23:21:49.487
> 
> 标签：c#, .net, icc, color-profile

有没有类似的功能[`GetColorDirectory`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd316928%28v=vs.85%29.aspx)？

还是我应该只通过 DLL 调用？

目的是使用颜色配置文件获取系统目录的路径

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:30:05.127

根据[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd316928%28v=vs.85%29.aspx)，您使用 API 调用它：

```
[DllImport(DllImport.Mscms, CharSet = CharSet.Auto, BestFitMapping = false)]
internal static extern bool GetColorDirectory(IntPtr pMachineName, StringBuilder pBuffer, ref uint pdwSize); 
```

# node.js - 如何使用 socket.io 发出事件并将函数作为参数传递

> ID：14792765
> 
> 赞同：1
> 
> 时间：2013-02-09T23:22:42.390
> 
> 标签：node.js, socket.io

我正在使用socket.io，我试图从我的服务器发出一个事件并传递一个带有函数的对象作为参数。这是我的代码：

```
 socket.emit('customEvent', {
    name : "Test".
    myFunc : function() {
        //some logic here
    }
  }); 
```

然后在客户端（我在浏览器中的应用程序）中，我可以访问“名称”属性，但是当我尝试访问“myFunc”时，却得到“未定义”。这是我的代码

```
socket.on('customEvent', function(data){
    data.myFunc();
}); 
```

什么是正确的方法（如果可能的话）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:28:22.797

数据以 JSON 格式传输，因此不能包含函数。[也许您正在寻找socket.io 文档](http://socket.io/#how-to-use)中所谓的“确认” ？

```
// server
socket.on('customEvent', function (data, fn) {
    fn(data.x)
})

// client
socket.emit('customEvent', { x: 1 }, function(){
    // ...
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:43:54.267

你可以序列化你的函数，也许这对某些函数来说是一种危险的方式。但 socket.io 仅将字符串作为纯字符串或 JSON 传输。您可以在从服务器端接收字符串函数时尝试评估它。

注意：以下代码未测试：

```
function hello() {
  return "Hello Cruel World";
}

socket.emit('send-function', { myFunc : hello.toString() }); 
```

...

在服务器端：

```
socket.on('send-function', data) {
  console.log(eval(data.myFunc));
} 
```

试试这个代码，如果它有效，请给我们反馈。

# iphone - 为导航控制器创建自定义类（立即崩溃）

> ID：14792772
> 
> 赞同：0
> 
> 时间：2013-02-09T23:23:22.780
> 
> 标签：iphone, objective-c, class, storyboard

我正在开发一个基于 Storyboards 的应用程序，它由通过**导航控制器**（初始视图控制器）链接的**多个视图控制器组成。**这用作主屏幕。**我正在使用静态单元格和静态表格视图**。

 ****现在，我想将一些标签、按钮等作为出口/操作连接到“ *.h* ”文件，然后在 .m 文件中编写自定义方法。**但是（正如预期的那样？）在身份检查**器中还没有可供选择的自定义类。所以我创建了一个新的自定义类作为**UITableViewController**的子类（*这似乎是正确的？*）

我的新自定义类现在已连接到我的故事板视图控制器。然后我输入（我认为是）正确的**numberOfSectionsInTableView** : 1 和**numberOfRowsInSection** :5 （我得到了 1 个部分，包括 5 行）。运行时，它立即崩溃并出现以下错误：

*由于未捕获的异常“ `NSInternalInconsistencyException`”而终止应用程序，原因：“无法使具有标识符 Cell 的单元格出列 - 必须为标识符注册 nib 或类或连接情节提要中的原型单元格”*

如果返回 0 个部分和 0 行，一切正常（预计没有显示行）。**一旦我在其中任何一个中返回任何> 0，它就会因此错误而崩溃。**

我错过了什么？在将其作为自定义类附加之前，我还应该添加其他任何内容吗？我可以将它用作任何其他自定义类吗？同样，我已经在界面构建器（故事板）中设置了所有内容，包括表格单元格行、样式等。我做错了什么？

我的表视图设置

![我的表视图设置](../Images/e74ec5960eb227f74b2b2f3f91c70aab.png)

我的表格单元格设置

![在此处输入图像描述](../Images/48169f1fac25cc1481293ab5b466a9b2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:36:43.050

很确定这就是答案：在情节提要中，确保在表格视图（崩溃视图控制器中的那个）上绘制了一个原型单元格，并确保它的重用标识符设置为“单元格”。您的 rowAtIndexPath: 代码正在尝试使具有该标识符的单元格出列，但它不存在。

可以使用情节提要中的属性检查器（右上角的中间选项卡）设置标识符。****

# apache - 用htaccess重写图像路径？

> ID：14792773
> 
> 赞同：1
> 
> 时间：2013-02-09T23:23:26.413
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我有这些旧网站，它的所有 .htm 文件中都有图像 url，如下所示，

```
<img border="0" src="images/logo.jpg" alt="xxx" width="170" height="150"> 
```

我想知道是否可以在所有带有 htaccess 的图像 URL 之前添加**绝对路径。**

例如，

```
<img border="0" src="http://localhost/mysite/local/applications/bin/oldsite/images/logo.jpg" alt="xxx" width="170" height="150"> 
```

可能吗？

还是我必须逐个文件手动更改图像路径？

我的尝试，

```
RewriteRule ^(.*\.(gif|jpg|png))$ local/applications/bin/oldsite/images/$1 [QSA,L] 
```

当然不工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:47:46.417

我用这个规则做到了，

```
RewriteRule ^images\/(.*\.(gif|jpg|png))?$ local/applications/bin/oldsite/images/$1 [QSA,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:31:40.767

你的规则

```
RewriteRule ^(.*\.(gif|jpg|png))$ local/applications/bin/oldsite/images/$1 [QSA,L] 
```

将重定向`images/image.jpg`到`local/applications/bin/oldsite/images/images/image.jpg`

丢失`images/`规则末尾的部分：

```
RewriteRule ^(.*\.(gif|jpg|png))$ local/applications/bin/oldsite/$1 [QSA,L] 
```

# emgucv - 用旋转的矩形逼近轮廓

> ID：14792779
> 
> 赞同：1
> 
> 时间：2013-02-09T23:24:19.307
> 
> 标签：emgucv, contour

经过一些颜色检测和二进制阈值处理后，我使用以下代码查找轮廓并将它们绘制到图像上：

```
 using (MemStorage stor = new MemStorage())
        {
           Contour<Point> contours = img.FindContours(
              Emgu.CV.CvEnum.CHAIN_APPROX_METHOD.CV_CHAIN_APPROX_SIMPLE,
              Emgu.CV.CvEnum.RETR_TYPE.CV_RETR_LIST,
              stor);

           for (; contours != null; contours = contours.HNext)
           {
              Contour<Point> currentContour = contours.ApproxPoly(contours.Perimeter * poly, stor);

              img.Draw(currentContour,new Bgr(255,255,255),1);

              Rectangle currentrect = currentContour.BoundingRectangle;

              img.Draw(currentrect,new Bgr(255,255,255),2);
            }
        } 
```

我的问题是，正如我所料，如果轮廓是矩形但在图像中旋转，则边界矩形不会改变其方向以适应旋转。他们是完成此功能的另一种方式吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:22:02.650

是的，还有另一种方法可以做到这一点。您可以使用

```
contour.GetConvexHull(ORIENTATION.CV_CLOCKWISE); 
```

使用 Moments，您可以轻松获取方向并相应地调整矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T17:22:53.560

您正在寻找的方法是：

```
PointCollection.MinAreaRect(points); 
```

工作示例在这里： [http ://www.emgu.com/wiki/index.php/Minimum_Area_Rectangle_in_CSharp](http://www.emgu.com/wiki/index.php/Minimum_Area_Rectangle_in_CSharp)

完整的文档（仅包含上述内容）位于此处： [http ://www.emgu.com/wiki/files/2.4.0/document/html/0d5fd148-0afb-fdbf-e995-6dace8c8848d.htm](http://www.emgu.com/wiki/files/2.4.0/document/html/0d5fd148-0afb-fdbf-e995-6dace8c8848d.htm)

# ruby-on-rails - 导轨继承

> ID：14792783
> 
> 赞同：0
> 
> 时间：2013-02-09T23:24:51.623
> 
> 标签：ruby-on-rails, inheritance, relationship

晚上好，伙计们，

我有三个脚手架：rails 生成脚手架 person alter:integer, name:string

rails 生成脚手架训练器

轨道生成脚手架运动者

```
 class Person < ActiveRecord::Base
   attr_accessible :alter, :name
 end

 class Sportler < Person
    belongs_to :trainer
 end

 class Trainer < Person
   has_many :sportler
 end 
```

我已在运动者和教练视图/_form.html.erb 中添加此代码

```
 <div class="field">
     <%= f.label :name %><br />
     <%= f.text_field :name %>
   </div>
  <div class="field">
     <%= f.label :alter %><br />
     <%= f.number_field :alter %>
   </div> 
```

然后我添加了一些教练和运动员，然后我查看了数据库。有一张供人、教练员和运动员使用的表。 **但是所有条目都在 peple_table 中。出了什么问题？**

people 表具有 name 和 alter 作为列。Trainers and Sportlers 没有这些栏目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:57:52.927

当您为其创建脚手架时`Trainer`，`Sportler`它们被视为单独的模型，因此它们在数据库中拥有自己的表。而且由于您没有指定任何列，因此他们没有得到任何列。

然后，当您为子类化`Person`时`Trainer`，`Sportler`我猜 rails 假定您正在使用单表继承，因此它们都存储在`people`表中。如果你想要这种行为，你应该添加一`type`列`people`我认为。

我不确定您是否可以在模型中显式设置表名（应该是这样的）： `set_table_name "sportlers"`并将`set_table_name "trainers"`它们放入自己的表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T14:12:05.303

要在 Rails 中使用 STI，您需要将 type:string 字段添加到您的父模型。

`rails generate scaffold person alter:integer, name:string, type:string`

之后，您不需要为您的子类搭建脚手架。只需创建新模型文件并从 Person 继承。

Rails 足够聪明，可以使用添加的类型字段来保持子类的持久性。您的子类的工作方式与 ActiveRecord 模型完全相同。如果您使用子类运行以下代码：

```
Trainer.create(name: 'John') 
```

您将收到一个新的数据库条目，其类型字段值为 Trainer。

# ruby - 有没有办法在 Vim 中折叠所有多行 Ruby 注释？

> ID：14792787
> 
> 赞同：1
> 
> 时间：2013-02-09T23:25:45.080
> 
> 标签：ruby, vim, comments, macvim

我正在研究一个 Ruby gem，我希望能够隐藏文件中的所有文档注释，因为它们更适合使用库的人，而不是阅读或编写代码。我看到了评论的价值，但是当我处理代码时，它们在视觉上分散了我的注意力。

在 MacVim 中，我可以通过选择并单击来手动折叠代码行`Tools > Folding > Create Fold`，但是有没有办法使用某种快捷方式自动隐藏所有注释？

例如，下面的代码：

```
 # Returns a 2D array for Rails select helper options.
  # Also used internally for Formtastic support
  #
  # ==== Example
  #  # Create an Enum with some elements
  #  class Priority < ClassyEnum::Base
  #  end
  #
  #  class Priority::Low < Priority; end
  #  class Priority::ReallyHigh < Priority; end
  #
  #  Priority.select_options # => [["Low", "low"], ["Really High", "really_high"]]
  def select_options
    map {|e| [e.text, e.to_s] }
  end 
```

将显示为：

```
 def select_options
    map {|e| [e.text, e.to_s] }
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:41:43.120

你可以试试[这个方法](http://www.rtfm-sarl.ch/articles/hide-comments.html)：

```
:set fdm=expr
:set fde=getline(v:lnum)=~'^\\s#'?1:getline(prevnonblank(v:lnum))=~'^\\s#'?1:getline(nextnonblank(v:lnum))=~'^\\s*#'?1:0 
```

问题是这种方法将成为唯一的折叠选项，所以这可能有点极端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T05:29:50.633

我猜你想玩`vim`'s`foldmethod`设置。抱歉回答有点模糊，但我这里没有 MacVim，所以你应该自己调整我的建议中的目录/文件名。

首先，尝试`:setlocal foldmethod=syntax`在命令模式下仅在当前文件中启用折叠。如果它有效，则您已安装所有先决条件（即`ruby.vim`语法文件）。尝试添加`let ruby_fold=1`到您的`.vimrc`文件中。后者应该启用折叠所有 ruby​​ 文件（或者，或者，您可以明确地将折叠设置为 true 用于支持折叠的所有文件类型`set foldmethod=syntax`。）

现在你要找到`ruby.vim`你的文件系统来调整它。提示一下，在 Linux 发行版上，它位于`/usr/share/vim/vim73/syntax/ruby.vim`. 我的语法文件允许折叠所有“可能”折叠的东西（例如函数、方法等）。将原始文件复制到您的`$HOME/.vim/syntax`目录并根据您的需要进行调整。浏览它（`fold`例如，通过搜索）并删除`fold`您不希望应用折叠的关键字。语法文件中的名称是不言自明的，所以你不会在这里遇到麻烦。

重新启动 vim 并享受你的折叠。希望有帮助。

# scala - 在 Heroku 上使用 Play Framework 的后台作业

> ID：14792790
> 
> 赞同：3
> 
> 时间：2013-02-09T23:26:14.740
> 
> 标签：scala, heroku, playframework-2.0, rabbitmq, akka

在 Heroku 上，并使用 Play Framework，是否有必要设置后台作业处理器（使用 Akka/RabbitMQ/等）以执行繁重的任务*？

我知道 Play 提供了在请求中异步执行任务的能力，但这是否足以避免需要后台作业处理器？在非 Heroku 部署的独立 Play 应用程序上，异步功能可以在一个进程中完成所有操作，但在 Heroku 应用程序上，这似乎还不够：根据《[Professional Heroku Programming](http://www.wiley.com/WileyCDA/WileyTitle/productCd-1118508998.html) 》一书，（第 254 页，在使用 Ruby 开发部分中），Web dyno 在收到请求和传递响应之间被阻塞，并且在此期间所有其他请求都排队。

如果需要后台作业处理器，是否有任何示例？我见过 Play 和 Akka、Play 和 Heroku 的例子，但不是所有三个都在一起。

*（对于繁重的任务，我通常是指需要回答的可能长时间运行的任务，例如复杂的数据库查询的结果或提供给最终用户的 Web 服务调用，而不是一劳永逸的事情比如发邮件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T21:56:36.970

使用 Play 时不需要明确的工作人员。Play 2 的常见模式是在控制器和[Akka中使用](http://www.playframework.com/documentation/2.1.0/ScalaAkka)[异步响应](http://www.playframework.com/documentation/2.1.0/ScalaAsync)来运行更长时间的进程。Play Framework 网站上的所有示例都应该在 Heroku 上开箱即用。

# java - 从 Switch 语句打印有序日期

> ID：14792791
> 
> 赞同：0
> 
> 时间：2013-02-09T23:26:17.230
> 
> 标签：java, date, loops, switch-statement

我正在尝试编写一个循环，该循环将从我的 switch 语句中获取其值。我希望它在自己的行上按顺序打印出日期，例如：1/1 1/2 1/3 ... 12/31

我曾尝试自己编写它，但我不完全确定如何以正确的顺序将月份分配给我在 switch 语句中的 3 个案例。

下面是我正在使用的 switch 语句：

```
int month = 0;
    int yearInt = year;
    int totalDays = 0;

    switch (month) {
    case 1:
        totalDays = 30;
        break;
    case 2:
        if (((yearInt % 4 == 0) && !(yearInt % 100 == 0))
                || (yearInt % 400 == 0))
            totalDays = 29;
        else
            totalDays = 28;
        break;
    default:
        totalDays = 31;
        break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:30:50.117

像这样？一月假设为 1

```
case 1:
case 3:
case 5:
case 7:
case 8:
case 10:
case 12:
    totalDays = 31;
    break;
case 2:
    if (((yearInt % 4 == 0) && !(yearInt % 100 == 0))
            || (yearInt % 400 == 0))
        totalDays = 29;
    else
        totalDays = 28;
    break;
default:
    totalDays = 30;
    break; 
```

请注意，我使用的贯穿语法有时被认为是有害的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:50:17.453

您也可以使用内置方法获得所需的结果：

```
 Calendar c = Calendar.getInstance();
    c.set(Calendar.YEAR, yearInt);
    c.set(Calendar.MONTH, month);
    int totalDays = c.getActualMaximum(Calendar.DAY_OF_MONTH); 
```

注意：值`month`从`0`（`0`一月，`1`二月..）开始。

# ruby-on-rails - rails：跟踪独特点击的最佳方式是什么？

> ID：14792792
> 
> 赞同：1
> 
> 时间：2013-02-09T23:26:35.027
> 
> 标签：ruby-on-rails, ruby, unique

我目前正在开发一个带有 rails 的附属工具，它正在生成一些独特的附属链接。我曾经通过 bitly 创建这些链接，并通过 bitly API 简单地获取链接点击。太棒了，但如果你删除了你的 cookie，繁荣 - 再次点击它会再次计数。所以有点没用。我试图熟悉谷歌分析 api 来计算唯一点击次数，但相信这只是开销。存储 IP 地址也不是我喜欢的工作方式。

现在我想保持简单，并在用户单击链接时将用户的 mac 地址存储在数据库表中。“统计模型”与链接模型有关，因此我会找出哪个链接被哪个mac地址单击。如果链接表中已经存在mac地址，则不要计算。

这是解决我的问题的正确方法吗？我读了几篇文章，其中也可以伪造 mac 地址，所以我担心这会以某种方式被劫持。如果您有任何很棒的方法可以在 Rails 中使用独特的链接跟踪，我很想与他们合作。

感谢您提供任何帮助和提示。

# c++ - “没有用于调用的匹配函数”模板 C++

> ID：14792796
> 
> 赞同：3
> 
> 时间：2013-02-09T23:27:01.423
> 
> 标签：c++, templates

帮助 我不明白为什么我不能运行这个用于家庭作业的代码片段，当它说我没有定义函数时，xCode 似乎不同意我的看法。见下面的主要错误

```
template <class Comparable>
Comparable maxSubsequenceSum1( const vector<Comparable> & a, int & seqStart, int & seqEnd){
        int n = a.size( );
        Comparable maxSum = 0;

        for( int i = 0; i < n; i++ )
            for( int j = i; j < n; j++ )
            {
                Comparable thisSum = 0;
                for( int k = i; k <= j; k++ )
                    thisSum += a[ k ];

                if( thisSum > maxSum )
                {
                    maxSum = thisSum;
                    seqStart = i;
                    seqEnd = j;
                }
            }

        return maxSum;

}

int main(){

        vector<int> vectorofints;
        vectorofints.resize(128);
        for (int i=0; i<vectorofints.size(); i++){
            vectorofints[i] = (rand() % 2001) - 1000;
        }
        maxSubsequenceSum1(vectorofints, 0, 127) //**---->the error i get in xcode is "No matching function for call to maxSubsequenceSum1"

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:33:47.450

将签名从

```
Comparable maxSubsequenceSum1( const vector<Comparable> & a,
                               int & seqStart, int & seqEnd) 
```

至

```
Comparable maxSubsequenceSum1( const vector<Comparable> & a, 
                                 int seqStart, int seqEnd) 
```

如果你愿意，同样的问题也会发生`int & i = 0;`。您不能从右值初始化非常量引用。`0`并且`127`是在表达式末尾过期的临时对象，临时对象不能绑定到非常量引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:34:00.177

编译器是正确的。你打电话`maxSubsequenceSum1(std::vector<int>&, int, int)`，你定义`maxSubsequenceSum1(std::vector<int>&, int &, int &)`

有2个快速解决方案：

1）重新定义您的功能以不参考。
2）将常量移动到变量并以这种方式传递它们。

~~注意：您的代码还有另一个问题。您调用函数 maxSubsequenceSum1，但没有告诉它使用什么模板参数。~~

我已经更正了，更正是正确的。注释无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:34:35.870

您已经声明了一个函数，该函数需要两个整数引用，但您调用的函数需要两个整数值。应该是这样的

```
vector<int> vectorofints;
        vectorofints.resize(128);
        for (int i=0; i<vectorofints.size(); i++){
            vectorofints[i] = (rand() % 2001) - 1000;
        }
        int k = 0;
        int j = 127;
        maxSubsequenceSum1(vectorofints, k, j) 

        return 0; 
```

# java - 如何让 IntellijIDEA 忽略正在进行的类文件？

> ID：14792798
> 
> 赞同：17
> 
> 时间：2013-02-09T23:27:12.533
> 
> 标签：java, intellij-idea

当我在 IntellijIDEA 工作时，我如何告诉它忽略可能有问题的类文件并且我想暂时休眠？

当我编译我正在处理的任何类时，它会抛出错误，直到我修复第一个“休眠”类。

我尝试将我的类添加到一个伪造的包中，但 Intellij 也不喜欢这样，因为路径不匹配。

![IntellijIDEA](../Images/e1e4c71f98114b3b1de8f762e64bcaf3.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-10T00:42:40.417

`Settings`| `Compiler`| `Excludes`，在那里添加您的 WIP 文件：

![排除](../Images/b4e1b1142cd7de8c4ad3827973ce44af.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T23:34:03.500

您可以使用**Refactor** -> **Rename File...**，并更改文件扩展名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T23:57:27.377

这是在检查级别设置的

配置当前文件分析`CTRL`+ `SHIFT`+ `ALT`+`H`

我根据项目构建的阶段松散地设置了具有不同检查级别的配置文件......我建议看看[Customizing Inspection Profiles](http://www.jetbrains.com/idea/webhelp/customizing-profiles.html)。

![在此处输入图像描述](../Images/0c4c6ce4ca583bd32efb6e380c31392d.png)

要在编译期间忽略特定文件，您可以通过项目设置面板单独或递归添加文件...

[配置编译器分析](http://www.jetbrains.com/idea/webhelp/compiler-validation.html) `CTRL`+ `ALT`+ `S`:: 编译器 => 验证

![在此处输入图像描述](../Images/c592b43dc1e1819e607fffbf1e25415e.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T23:53:27.547

通常，仅实际编译应用程序中使用的类。
在您的情况下，我猜想只有损坏的单元测试会阻碍编译（与`/main`文件夹中的任何其他 Java 类相反）。

原因是这样的：在包或源文件夹中运行所有单元测试时，IntelliJ 会搜索并包含默认情况下*看起来*`Test`像单元测试的所有文件：类名中带有or的文件，以及带有or`Suite`注释的文件。`@Test``@Suite`

因此，排除测试的最简单方法是创建第三个源文件夹，将其命名为 /ignore，而*不是*将其标记为 IntelliJ 中的源文件夹。然后，您可以将任何不想包含在编辑中的文件暂时放在那里，并在您想继续处理时将其拖回其原始文件夹。但请注意：如果您在未标记的源文件夹中打开和编辑文件，您将只能获得有限的工具支持，因此它应该仅用于“停车”。

正如另一个答案所暗示的那样，您也可以更改文件扩展名，但是 IntelliJ 还将在其他方面更改其对文件的处理，而不仅仅是在编译期间。

此外，如果您使用的是 JUnit 4，则始终可以使用 注释任何单个测试方法或整个测试类，`@Ignore`并且在测试运行期间将跳过它。但是，这要求该类在形式上是正确的，即：没有编译时错误。

PS：如果您真的想要更改包，您实际上需要将测试移动到不同的文件夹 - 而不仅仅是编辑`package`声明。否则，不匹配的声明也将被视为错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-13T09:21:52.617

有点晚了，还是

如果您的所有文件都在同一个包中，则右键单击项目工具窗口中的包并选择“将目录标记为 -> 排除”。包内的所有类都不会被编译。您可以随时以相同的方式取消排除。

# c# - 附加到 C# 中的现有 Xml

> ID：14792806
> 
> 赞同：0
> 
> 时间：2013-02-09T23:27:55.337
> 
> 标签：c#, xml, visual-studio-2012, append

我在下面有一个 Xml 文件，我试图将其加载到 Visual Studio，然后将 D100 的另一个条目附加到文件中，然后写入或附加 1000 次。

下面的代码保存了文档，但没有附加任何内容。

```
<flp:Tab xmlns:flp="http://www.w3.org/2001/XMLSchema"   Title="Testing">
  <flp:Form Number="0" id="1005" />
  <flp:Rev Time="2013-01-21T15:08:00">
    <flp:Author Name="Brad" Aid="15" />
  </flp:Rev>
  <flp:Designs Id="D100">
    <flp:D100 Number="1">
      <flp:Code>A</flp:Code>
      <flp:Documented>true</flp:Documented>
      <flp:Note>In Process</flp:Note>
      <flp:Testers>
        <flp:Tester Name="David">
          <flp:Titles>
            <flp:Title Number="0" Name="Entry 1">
              <flp:Start>Begin</flp:Start>
              <flp:Finish>End</flp:Finish>
            </flp:Title>
          </flp:Titles>
        </flp:Tester>
      </flp:Testers>
      <flp:TestGivers>
        <flp:TestGiver Name="James" />
      </flp:TestGivers>
      <flp:IsRequired>true</flp:IsRequired>
      <flp:IsOptional>false</flp:IsOptional>
    </flp:D100>
  </flp:Designs>
</flp:Tab> 
```

我正在尝试在 Xml 文件中附加并写出 1000 次信息

这是我的 C# 代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Xml;

namespace AppendXml
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void Button_Click_1(object sender, RoutedEventArgs e)
        {

            XmlDocument doc = new XmlDocument();
            doc.Load("C:\\Desktop\\Temp.xml");

            //XmlElement root = doc.CreateElement("Tab");

            XmlElement D100 = doc.CreateElement("D100");
            D100.SetAttribute("Number", "2");

            XmlElement Code = doc.CreateElement("Code");
            Code.InnerText = "B";

            XmlElement Documented = doc.CreateElement("Documented");
            Documented.InnerText = "false";

            XmlElement Note = doc.CreateElement("Note");
            Note.InnerText = "Complete";

            XmlElement Tester = doc.CreateElement("Tester");
            Tester.SetAttribute("Name", "John");

            XmlElement Title = doc.CreateElement("Title");
            Title.SetAttribute("Number", "0");
            Title.SetAttribute("Name", "Ronald");

            XmlElement Start = doc.CreateElement("Start");
            Start.InnerText = "Begin";

            XmlElement Finish = doc.CreateElement("Finish");
            Finish.InnerText = "End";

            XmlElement TestGiver = doc.CreateElement("TestGiver");
            TestGiver.SetAttribute("Name", "Jeremy");

            XmlElement IsRequired = doc.CreateElement("IsRequired");
            IsRequired.InnerText = "true";

            XmlElement IsOptional = doc.CreateElement("IsOptional");
            IsOptional.InnerText = "false";

            D100.AppendChild(IsOptional);
            D100.AppendChild(IsRequired);
            D100.AppendChild(TestGiver);
            D100.AppendChild(Finish);
            D100.AppendChild(Start);
            D100.AppendChild(Title);
            D100.AppendChild(Tester);
            D100.AppendChild(Note);
            D100.AppendChild(Documented);
            D100.AppendChild(Code);

            //root.AppendChild(D100);
            //doc.AppendChild(root);

            doc.Save("test13.xml");

        }
      }
    } 
```

文档保存但注意附加。我遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:41:51.747

您应该附加`D100`到`flp:Designs`- 现在您没有将其附加到任何内容，因此不会将任何内容添加到文档中：

```
XmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);
nsmgr.AddNamespace("flp", "http://www.w3.org/2001/XMLSchema");
XmlNode designs = doc.SelectSingleNode("//flp:Designs", nsmgr);
designs.AppendChild(D100); 
```

您还在`D100`默认命名空间中创建，可能您想在`http://www.w3.org/2001/XMLSchema`命名空间中创建它，`flp`前缀为 XML 的其余部分：

```
XmlElement D100 = doc.CreateElement("flp", "D100", "http://www.w3.org/2001/XMLSchema"); 
```

最后：`http://www.w3.org/2001/XMLSchema`是一个标准命名空间，这里用于一些自定义 XML，这通常是错误的。

# php - 简单的 php 投票系统不会更新数据库

> ID：14792807
> 
> 赞同：1
> 
> 时间：2013-02-09T23:27:55.170
> 
> 标签：php, mysql, database

```
<?php
session_start();
$host        =    'localhost';
$user        =    'root';
$password    =    '8******8';
$database    =    'tg*****ba';

$conn = mysql_connect($host,$user,$password) or 
  die('Server Information is not Correct'); 

//Establish Connection with Server
mysql_select_db($database,$conn) or die('Database Information is not correct');
$InGameName    =    mysql_real_escape_string($_POST['InGameName']);
$LastVoteTime;

//===When I will Set the Button to 1 or Press Button to register
if(isset($_POST['btnVote'])) 
{
  if(md5($_POST['code']) != $_SESSION['key']) 
    die("You've entered a wrong code!");
  $query = mysql_query("SELECT * FROM entities WHERE Name = '". $InGameName ."'"); 
  if (mysql_num_rows($query) < 0) 
  { 
     die("This In game name doesn't exist , please enter your account name not username!");
  }
  else
  {
    $date = date('YmdHis');
    $row=mysql_fetch_object($query);
    $lastvote=$row->LastVoteTime;
    $votingpoints = $row->VotsPoints;
    $url = "http://www.xtremetop100.com/in.php?site=***********";

    if(($lastvote + 120000) < $date)
    {
      $lastvote = $date;
      $votingpoints += 1;
      $query = mysql_query("update entities set VotsPoints ='$votingpoints' set LastVoteTime ='$lastvote' WHERE Name = '". $InGameName ."'"); 
    }
    else
      die("You've Already voted in the last 12 hrs!");
  }
}

?> 
```

它不会使用投票点和 lastvotetime 更新数据库，但是它通过了第一次检查（这意味着它在数据库中找到了帐户记录），但它没有在该代码的末尾设置它们提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:34:15.000

尝试：

```
$query = mysql_query("update entities set VotsPoints = '$votingpoints', LastVoteTime = '$lastvote' WHERE Name = '". $InGameName ."'"); 
```

您多次使用“set”，不确定是否可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:59:15.480

UPDATE 语句中的 SQL 语法不正确。 [http://dev.mysql.com/doc/refman/5.0/en/update.html](http://dev.mysql.com/doc/refman/5.0/en/update.html)

# firefox - 微信挣扎

> ID：14792812
> 
> 赞同：0
> 
> 时间：2013-02-09T23:28:43.730
> 
> 标签：firefox, scripting, imacros

```
//declaring the macro
 var macroIronMaiden;

  macroIronMaiden ="CODE:";
 macroIronMaiden +="VERSION BUILD=7500718 RECORDER=FX"+"\n";
macroIronMaiden +="SET !EXTRACT_TEST_POPUP NO"+"\n";
macroIronMaiden +="SET !ERRORIGNORE YES"+"\n";
 macroIronMaiden +="SET !TIMEOUT_PAGE 15"+"\n";
macroIronMaiden +="TAB T=1"+"\n";
macroIronMaiden +="TAB CLOSEALLOTHERS"+"\n";
macroIronMaiden +="ONDIALOG POS=1 BUTTON=OK CONTENT="+"\n";
macroIronMaiden +="URL GOTO=http://google.com/search=ironmaiden/"+"\n";
 macroIronMaiden +="TAG POS=1 TYPE=P ATTR=TXT:Leyton EXTRACT=TXT"+"\n"; 
```

////////这不起作用，我希望它在页面上提取任何“”LEYTON“”文本//////////////////// /

```
var macroWait;

macroWait ="CODE:";
macroWait +="WAIT SECONDS=600";    
////////Beginning///////

 //this loop will search 10 times. Change number 10 for more times

for(var i=0;i<10;i++)
 {

iimPlay(macroIronMaiden)

var extract=iimGetLastExtract();

if(extract.toLowerCase()=="eddy") 
```

///////////////////////////////////搜索结果页上的leyton词拼写为“ leyton”。我如何更改此信息它不仅仅是小写字母////////////////////////////

```
 {

//go to yahoo.ca
}
 else
{

    iimDisplay("Waiting for 10 minutes")
  iimPlay(macroWait)
  //////////go back to top and search again.
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T01:56:47.310

欢迎来到 iMacros 的问题世界。这可能是问题所在。

```
macroIronMaiden +="TAG POS=1 TYPE=P ATTR=TXT:Leyton EXTRACT=TXT"+"\n"; 
```

检查页面上的类型是否设置正确。它可能与 P 不同。可能是 DIV、SPAN 或其他东西。

如果要将 JavaScript 中的文本更改为小写，请使用。

```
text=text.toLowerCase(); 
```

并使用 iimSet 命令将其设置为 iMacros。也访问[此页面](http://wiki.imacros.net/Main_Page)

# vim - 滚动屏幕线，我知道，这是不可能的

> ID：14792820
> 
> 赞同：-1
> 
> 时间：2013-02-09T23:29:33.403
> 
> 标签：vim

我在一个非常小的屏幕设备（7 英寸）上使用 vim；我使用换行和换行，您可以想象滚动（通过*键盘*和*鼠标*）是一场噩梦，因为如果您的行很长，它可以换行到可见屏幕下方。

我浏览了很多帖子，除了 gj 和 gk 之外，没有一个提供明确的解决方案。

澄清一下：只需尝试在可见窗口下方写一行长线： ctrl-e 或 jk 将转到下一行的开头，您将看不到第一行的最后一个字符。

有什么我没找到的吗？似乎真的有很多人对此感兴趣，但没有一个开发人员想要处理这个:-(

谢谢

[http://vim.1045645.n5.nabble.com/Scrolling-screen-lines-I-knew-it-s-impossible-td3358342.html](http://vim.1045645.n5.nabble.com/Scrolling-screen-lines-I-knew-it-s-impossible-td3358342.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T00:30:41.567

`gj`并将`gk`在一行内滚动，而不是移动到下一行。这可能会帮助你。如果是这样，您可能需要暂时执行以下操作：

```
:nmap j gj
:nmap k gk 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T19:43:54.723

我能得到的最接近的是这个，无论如何都不支持鼠标：

[在插入模式下遍历文本](https://stackoverflow.com/questions/1737163/vim-traversing-text-in-insert-mode/6311099#6311099)

[http://vim.wikia.com/wiki/Move_cursor_by_display_lines_when_wrapping](http://vim.wikia.com/wiki/Move_cursor_by_display_lines_when_wrapping)

```
"use up and down to move by screen line
map <Up> gk
map <Down> gj
vmap <Up> gk
vmap <Down> gj
inoremap <Up> <C-o>gk
inoremap <Down> <C-o>gj

" make hjkl movements accessible from insert mode via the <Alt> modifier key
inoremap <A-h> <C-o>h
inoremap <A-j> <C-o>gj
inoremap <A-k> <C-o>gk
inoremap <A-l> <C-o>l 
```

# javascript - 影响功能的头文件中 javascripts 的排列

> ID：14792821
> 
> 赞同：0
> 
> 时间：2013-02-09T23:29:42.887
> 
> 标签：javascript, jquery, css

我有一个使用一些 jquery 功能的网站。在主页上我使用了 Nivo Slider 插件，而在另一个页面上我使用了 Lightbox 效果。

在我的`header.php`文件中脚本的链接安排中，我在 Nivo Slider 链接下有灯箱链接。灯箱工作，但 Nivo 滑块不工作。当我重新排列时，滑块工作但灯箱不工作。

**在这种情况下，灯箱工作，但滑块不起作用**

```
<script type="text/javascript" src="js/jquery.nivo.slider.js"></script>

<script src="js/prototype.js" type="text/javascript"></script>      
<script src="js/scriptaculous.js?load=effects,builder" type="text/javascript"></script>
<script src="js/lightbox.js" type="text/javascript"></script> 
```

这是正常的吗？我怎样才能让两者同时工作。

我的主页有滑块在[这里](http://goo.gl/QgxUl)

有灯箱的页面[在这里](http://goo.gl/sIJOz)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:36:31.220

由于来自很多地方的大量代码，有些事情会停止工作。不能简单地假设添加少量单独工作的代码在集成在一起时会起作用。在这种特殊情况下，jQuery 和 Prototype 发生了争执。

这可以通过在顶部只加载一个 jQuery 来解决，然后包含这个小片段：

```
jQuery.noConflict(); 
```

然后 jQuery 不再接管该`$`变量。（您的代码还需要使用`jQuery`而不是考虑此更改`$`，但所有编写良好的插件都应与此更改进行良好的互操作。）

之后，您应该能够包含 Prototype 和其他插件。理论上，无论如何。

* * *

在实践中，Prototype 挂钩了其他一些东西。`Array.​prototype.​reverse`在您的特定情况下，它以 jQuery 插件不期望的方式挂钩，并且不知何故，它导致了堆栈溢出。我真的不知道如何在不破坏其中一个的情况下解决 Prototype 对该功能的劫持，因此您可能只想找到一个仅适用于 jQuery 的灯箱插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:40:47.453

当您尝试调用它时，jQuery 不可用。你可以试着把所有的东西都移到身体的底部。还值得注意的是，您正在加载 jQuery 两次。

```
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script src="js/jquery.min.js"></script> 
```

# animation - 在 gnuplot 中用 1 个命令制作动画

> ID：14792823
> 
> 赞同：0
> 
> 时间：2013-02-09T23:29:45.090
> 
> 标签：animation, gnuplot

我正在尝试使用 gnuplot 显示动画我得到了以下脚本：

```
plot   ”heat1d.txt ”  using   1:2   every   :::a::a 
pause   0.01
a=a+1
if ( a<b )   reread 
```

我执行使用

```
a = 0
b = 100
load "a.plot" 
```

它可以工作，但是有没有办法只使用 shell 中的 1 个命令来执行所有这些操作？或者有没有办法将变量定义集成到 .plot 文件中，以便我可以简单地执行它？我尝试了不同的东西，比如`echo 'a=0'|gnuplot`etc，但它似乎并没有真正正确地定义变量

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-19T08:39:23.977

您可以使用 do for 循环。

```
do for [a = 0:100] {
  plot   ”heat1d.txt ”  using   1:2   every   :::a::a 
  pause   0.01
} 
```

Linux 上的默认终端通常是`wxt`，并且它具有`raise`选项，它将在每次迭代时将焦点更改为绘图窗口。如果不是不可能，这将使停止动画变得困难。

我建议将`noraise`其作为终端选项。例如，您可以将以下行放在脚本的开头：

```
set term wxt noraise 
```

现在，如果您想中途停止动画，请按`Ctrl``C`gnuplot 终端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T00:16:38.657

`-e`您可以作为命令行参数传递。例如，如果您有脚本：

```
#script test.gp
print foo,bar 
```

然后你可以使用 gnuplot 运行它：

```
gnuplot -e "foo=1;bar=2" test.gp 
```

在您的情况下，您可以通过以下方式调用脚本来完成几乎您想要的操作：

```
gnuplot -e "a=0;b=100" a.plot 
```

# ios - 为什么CFStreamCreatePairWithSocketToHost成功时CFStreamCreatePairWithSocketToCFHost失败

> ID：14792840
> 
> 赞同：1
> 
> 时间：2013-02-09T23:32:23.763
> 
> 标签：ios, objective-c, network-programming, core-foundation

在 iOS6.1 上，下面的代码应该做同样的事情，但是当我忘记写`addr.sin_len = sizeof(adde)`第一个块时失败了。原来的错误是：

```
GOT EVENT FROM INPUT Event: 8
ERR: Error Domain=NSPOSIXErrorDomain Code=12 "The operation couldn’t be completed. Cannot allocate memory" 
```

在添加缺少的行以设置结构大小后，第一个块与第二个块一样工作。可能其他开发人员会看到该错误消息并在此帖子上跳闸。

编码：

```
 CFReadStreamRef readStream = NULL;
    CFWriteStreamRef writeStream = NULL;

#if 1 // LONG WAY
    struct sockaddr_in addr;
    memset(&addr, 0, sizeof(addr));
    addr.sin_len        = sizeof(addr);  // ORIGINALLY WAS MISSING
    addr.sin_family     = AF_INET;
    addr.sin_port       = htons(5566);
    int ret = inet_pton(AF_INET, "192.168.1.2", &(addr.sin_addr.s_addr)); // IPv4
    assert(ret == 1);

    NSLog(@"CONNECT");
    CFDataRef address = CFDataCreate(kCFAllocatorDefault, (const UInt8 *)&addr, sizeof(addr));
    assert(address);

    CFHostRef macMini = CFHostCreateWithAddress(kCFAllocatorDefault, address);
    CFRelease(address);
    assert(macMini);

    // (tried, makes not difference) CFHostScheduleWithRunLoop (macMini, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);

    CFStreamCreatePairWithSocketToCFHost(kCFAllocatorDefault, macMini, 5566, &readStream, &writeStream);
    CFRelease(macMini);
#else // SHORT WAY
    CFStreamCreatePairWithSocketToHost(kCFAllocatorDefault, CFSTR("192.168.1.2"), 5566, &readStream, &writeStream);
#endif

    assert(readStream);
    assert(writeStream);

    iStream = CFBridgingRelease(readStream);
    oStream = CFBridgingRelease(writeStream);

    [iStream setDelegate:self];
    [iStream scheduleInRunLoop:[NSRunLoop mainRunLoop] forMode:NSDefaultRunLoopMode];
    [iStream open];
    NSLog(@"ISTREAM %@ status=%d", iStream, [iStream streamStatus]);
    NSLog(@"ERR: %@", [iStream streamError]);

    [oStream setDelegate:self];
    [oStream scheduleInRunLoop:[NSRunLoop mainRunLoop] forMode:NSDefaultRunLoopMode];
    [oStream open];
    NSLog(@"OSTREAM %@ status=%d", oStream, [oStream streamStatus]);
    NSLog(@"ERR: %@", [oStream streamError]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:17:04.153

问题是`sin_len`没有设置。拥有上述两组代码的好处是，您可以看到如何以任何一种方式完成任务。

# unicode - 大写 utf8 字符是否总是与其小写变体相同的字节数？

> ID：14792841
> 
> 赞同：8
> 
> 时间：2013-02-09T23:32:24.373
> 
> 标签：unicode, utf-8, case-insensitive

显然，拉丁字母是这样的。但我是在概念意义上问这个问题，跨语言和 Unicode 规范。

实际上，这是为了比较两个字符串。如果您已经知道它们的字节数不同（在所有语言中），您是否可以认为足以保证它们不是同一字符串的不同“大小写”版本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T23:50:40.310

不。

考虑 U+0069 "i"，它具有`69`UTF-8 中的八位字节值。在大写形式 U+0130 "İ" 中，此代码点形成 UTF-8 序列`C4 B0`。

*强制性说明：区分大小写。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T23:36:06.247

Unicode 标准中没有任何原则或不变量可以保证这一点。我会特别关注重音大写字母，在这种情况下，不同情况下的预合成和非预合成之间可能存在不匹配。但是，我无法为您举一个问题的例子。

# php - 交互式 PHP shell 是如何工作的？

> ID：14792842
> 
> 赞同：7
> 
> 时间：2013-02-09T23:32:26.230
> 
> 标签：php, console

我在 PHP 的交互式 shell 中使用`php -a`终端中的命令，但没有任何命令有效。我什至尝试了一个简单`2 * 2`的 ，但我没有得到任何结果。

我做错了什么，它是如何工作的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-09T23:37:40.297

在[交互式 shell 的文档中](http://php.net/manual/en/features.commandline.interactive.php)，Ryan P. 的第一条注释有一些值得注意的信息：

> 尽管名称和功能相似，但交互外壳和交互模式并不是一回事。
> 
> 如果您键入`php -a`并收到“Interactive Shell”的响应，然后出现`php>`提示，则您可以使用交互式 shell（PHP 是在 readline 支持下编译的）。相反，如果您收到“已启用交互模式”的响应，则说明您没有可用的交互式 shell，并且本文不适用于您。

因此，如果您只获得“启用交互模式”，那么您将只能输入 PHP 代码，然后当您完成后，向 PHP 发送 EOF 以执行它。

这可能不是你想要的。您可能想改为查看[phpsh](http://phpsh.org/)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-12-08T09:44:27.463

## 如何使用 PHP 交互式 shell

你说的`php -a`就是一坨屎。

phpsh 是由 facebook 制作的。

安装 git，到你要构建 phpsh 的地方：

```
sudo apt-get install git
cd /home/youruser; 
```

拉入存储库， cd 进入并安装：

```
git clone https://github.com/facebook/phpsh
cd phpsh
sudo python setup.py install 
```

运行：

```
el@apollo:~$ phpsh
Starting php
type 'h' or 'help' to see instructions & features
php> 
```

将 Hour 赋值给一个变量并打印：

```
php> $t = date("H");
php> echo $t;
04 
```

每个人都喜欢 if 语句：

```
php> if (false){echo "derp"; } else if(true){ echo "foobar"; } else{echo "moo"; }
foobar 
```

获取字符串的长度：

```
php> echo strlen("012345678");
9 
```

排序：

```
php> $numbers=array(4,6,2,22,11);
php> sort($numbers);
php> echo $numbers;
Array
php> print_r($numbers);
Array
(
    [0] => 2
    [1] => 4
    [2] => 6
    [3] => 11
    [4] => 22
) 
```

按键排序：

```
php> $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
php> ksort($age);
php> print_r($age);
Array
(
    [Ben] => 37
    [Joe] => 43
    [Peter] => 35
) 
```

将值压入堆栈并将它们弹出。

```
php> $a[]="one"
php> $a[]="two"
php> print_r($a);
Array
(
    [0] => one
    [1] => two
)
php> echo array_pop($a);
two
php> echo array_pop($a);
one
php> echo array_pop($a);
php> 
```

Basename 得到右边的单词：

```
php> echo basename("http://foobar/helicase");
helicase
php> echo basename("/home/el/polymerase");
polymerase 
```

触摸一个文件并获取上次修改的时间：

```
php> touch("/home/el/myfile.txt");
php> echo filemtime("/home/el/myfile.txt");
1386494608 
```

爱我一些json：

```
php> $myjson = '{"a":1}';
php> var_dump(json_decode($myjson));
object(stdClass)#2 (1) {
  ["a"]=>
  int(1)
} 
```

从 json 内部抓取东西的几种方法：

```
php> $json = '{"foobar": 123}';
php> $obj = json_decode($json);
php> print $obj->foobar;
123
php> print $obj->{'foobar'};
123 
```

函数，JSON 验证器

```
php> function isJson($string) {
 ...  json_decode($string);
 ...  return (json_last_error() == JSON_ERROR_NONE);
 ... }

php> echo isJson("");
1
php> echo isJson("{}");
1
php> echo isJson("abc");

php> echo isJson("{'a': 1}");

php> echo isJson('{"a": 1}');
1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T23:40:13.530

你有 PHP 5.1.0 编译`--with-readline`吗？

> 从 PHP 5.1.0 开始，如果 PHP 使用 --with-readline 选项编译，CLI SAPI 使用 -a 选项提供交互式 shell。

PHP手册页中的示例：

> $ php -a
> 
> 交互式外壳
> 
> php > 回声 5+8;
> 
> 13

更多信息：[http ://www.php.net/manual/en/features.commandline.interactive.php](http://www.php.net/manual/en/features.commandline.interactive.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T23:38:14.663

您使用的是 print() 还是 echo()？您的 2*2 示例将执行，但在您告诉 PHP 对输出执行某些操作（如 print()）之前，您不会看到任何证明。

```
php -a
php > 2 * 2;            #This doesn't return anything.
php > print (2 * 2);
4 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-07T23:51:29.183

确保以分号结束每个命令。

# c - 套接字上的 send() 函数不会为从不/未连接的套接字返回 -1

> ID：14792852
> 
> 赞同：1
> 
> 时间：2013-02-09T23:34:05.953
> 
> 标签：c, sockets

我在调用 send() 函数时遇到了一个奇怪的行为，其中 socketfd 是 0，p 是 "test\n" ，长度是 5 ，标志是 0 ：

```
 size_t n = 0;

  n = send(socketfd, p, length, flags); 
```

send 似乎在 n 18446744073709551615 中返回一个值

函数文档说它在错误时返回 -1。

代码在 mac os x 10.7 lion 上编译。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:41:05.850

`size_t`是无符号类型，它不能包含负值。事实上，如果你查看 send 的手册页，它的返回类型是`ssize_t`，它是签名版本，可以包含负值。

尝试更改类型。

# .net - 使用 .NET 在 Windows 上获得最佳屏幕分辨率

> ID：14792855
> 
> 赞同：1
> 
> 时间：2013-02-09T23:34:25.147
> 
> 标签：.net, windows, screen

在 Windows 7 上，系统控制中可以识别最佳屏幕分辨率设置，但是如何使用 .NET 应用程序获取此信息？

这是我的意思的窗口的屏幕截图：![Windows 7 中的屏幕分辨率](../Images/fed75f33426b0cb3df7f77e12c27fc99.png)

我已经检查了这个问题：[Getting the best resolution in Visual Studio 2010](https://stackoverflow.com/questions/7668275/getting-the-optimal-resolution-in-visual-studio-2010) 然而，这个解决方案只能用于获得尽可能高的分辨率，在某些情况下不推荐使用。

# .net - SimpleMembership 取消用户身份验证？

> ID：14792863
> 
> 赞同：4
> 
> 时间：2013-02-09T23:35:07.973
> 
> 标签：.net, asp.net-mvc-4, simplemembership

我正在制作一个新的 MVC 4 网站，并且我已经设置了 SimpleMembership。我还创建了一个继承自 RolePrincipal 的 CustomPrincipal，并具有一个名为 UserInfo 的附加属性，其中包含有关用户的附加信息，例如 LastName、FirstName 和 IsActive。这一切都通过 FormsAuthenticationTicket userData 属性存储在 cookie 中。

我的问题如下。假设我有一个管理页面，管理员用户可以在其中禁用其他用户的帐户 - 将 IsActive 属性设置为 false。假设同时被禁用的用户实际上当前已登录。如果他的访问权限被拒绝，我不希望该用户能够继续浏览该站点。

我怎样才能杀死他的会话意味着销毁他的 FormsAuthentication cookie？这是正确的做法还是我在 SimpleMembership 中缺少其他东西？完成这项任务的正确途径是什么？任何建议将不胜感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T01:26:27.823

我建议结合使用 Application_AuthenticateRequest 和 ASP.NET Cache，如下所示：

1) 当一个用户被删除时，将用户 ID 写入 ASP.NET 缓存中，它可以在那里停留一段有限的时间（可能是一天）：

```
string cacheKey = "RecentlyDeletedUserId" + userId;
Cache.Add(
    cacheKey,
    true,
    null,
    DateTime.Now.AddDays(1),
    null,
    CacheItemPriority.Normal,
    null
); 
```

2) 在 global.asax 中，您可以添加处理程序，该处理程序在服务器成功接收到表单身份验证票后*为每个请求*`Application_AuthenticateRequest`触发。在此处理程序中，您发出一个廉价的内存缓存请求，以查看该用户是否在最近删除的用户列表中。如果是，您将它们注销并将它们重定向到登录页面。

 *```
protected void Application_AuthenticateRequest(object sender, EventArgs e) {
    string cacheKey = "RecentlyDeletedUserId" + userId;
    if (Cache[cacheKey] != null)
    {
        FormsAuthentication.SignOut();
        FormsAuthentication.RedirectToLoginPage();
    }
} 
```

如果由于某种原因您不喜欢重定向方法，则可以采用以下方法：

```
protected void Application_AuthenticateRequest(object sender, EventArgs e) {
    string cacheKey = "RecentlyDeletedUserId" + userId;
    if (Cache[cacheKey] != null)
    {
        IPrincipal anonymousPrincipal = new GenericPrincipal(new GenericIdentity(String.Empty), null);
        Thread.CurrentPrincipal = anonymousPrincipal;
        HttpContext.Current.User = anonymousPrincipal;
    }     
} 
```

这只是将用户替换为匿名用户，从而确保该用户无法在您的网站上执行任何操作。（这种替代方法来自[Invalidating ASP.NET FormsAuthentication server side](https://stackoverflow.com/questions/2893334/invalidating-asp-net-formsauthentication-server-side)。）*

# ruby - Telnet 在 Ruby 中不工作

> ID：14792865
> 
> 赞同：2
> 
> 时间：2013-02-09T23:35:18.453
> 
> 标签：ruby, telnet

我需要 Telnet 到我的同事的服务器以进行我正在从事的项目：

```
telnet = Net::Telnet::new(
  "Host" => "example_ip",
  "Port" => 80,
  "Timeout"=>90,
  "Waittime" => 1,
  "Output_log"=>"output_log.log",
  "Dump_log"=> "dump_log.log"
)# => #<Net::Telnet:0x007f8142321c00 ...
telnet.cmd('ls')  # => "HTTP/1.1 0 ERROR\n\nERROR 0\n" 
```

我的 output_log 看起来像：

```
Trying example_ip...
Connected to example_ip.
HTTP/1.1 0 ERROR

ERROR 0 
```

我知道他的服务器正在运行，我可以连接到它。为什么我无法从 Ruby 连接？

（来自 OSX 终端）

```
$ telnet example_ip 80
Trying example_ip...
Connected to c-example_ip...comcast.net.
Escape character is '^]'.
...
$ ls
_~1     .TRA 22       4096
TRASHE~1\.    12          0
FSEVEN~1\.    12          0
20110221.LOG  0         73
CONFIG  .     0        573
20110223.LOG  0         95
20110224.LOG  0         17
20110225.LOG  0         17
20110315.LOG  0         73
... 
```

* * *

编辑：

我尝试设置`Binmode`to `false`、`Telnetmode`to`false`和一些不同的值`Prompt`（但我不知道正确的值是什么）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:51:58.957

一个问题是您在代码中远程登录到端口 80，即 HTTPd 端口。这就是为什么你得到：

```
HTTP/1.1 0 ERROR 
```

服务器希望您发送 HTTP 命令，例如`GET /index.html`，但您发送的是“ls”。

您没有说明您在机器的命令行上使用什么主机操作系统连接到服务器，但是，该机器上的 telnet 命令可能需要使用冒号将端口命令与主机 IP 或 FQDN 分开：

```
telnet example_ip:80 
```

未能在该类型的客户端上使用冒号会导致连接到端口 23 上的标准 telnet 端口，这似乎由您的`ls`命令工作备份。端口 80 上的 HTTPd 不会知道您的意思`ls`。

您可以使用 Telnet 协议连接到 HTTPd，也可以使用 telnet 客户端应用程序。不过，您必须使用正确的命令集。尝试调整您的代码`telnet.cmd("GET /index.html\r\n")`，看看您是否收到回复。

* * *

编辑：

使用 OpenURI 进行实验。这是一种非常简单方便的方式来戳 Web 服务器：

```
需要'open-uri'
doc = open('http://example.com').read
放置文档 [0, 100]

```

这将在给定的主机上打开到端口 80 的连接，然后进行重定向，并返回收到的文档。然后打印前 100 个字符，如下所示：

```
<!doctype html>
<html>
<head>
  <title>Example Domain</title>

  <meta charset="utf-8" />
  <meta http- 
```

您没有说明为什么“需要”远程登录到 Web 服务器。它们不支持您可以通过普通 telnet 会话发出的相同命令，并且不会让您访问文件系统，除非已为此目的编写代码。

# jquery - jQuery load() 问题

> ID：14792866
> 
> 赞同：0
> 
> 时间：2013-02-09T23:35:24.633
> 
> 标签：jquery, jquery-address

我有一个页面：`index.html`有一些内容：

```
<section id="content">
...
</section> 
```

我正在尝试使用 jQuery（带有 jQ​​uery 地址）来更新内容，而无需从具有*相同* `section`标签和*相同*id 的其他 HTML 文件重新加载。

我被这个困住了：

```
 $.address.init(function(event) {
    console.log("init: " + $('[rel="address:' + event.value + '"]').attr('href'));
  }).change(function(event) {
    $("#content").load($('[rel="address:' + event.value + '"]').attr('href') + ' #content');
    console.log("change");
  }); 
```

它几乎可以工作。但！它用 再插入*一个* `<section id="content">`，`</section>`所以一切都爆炸了。

我怎样才能摆脱一个`<section id="content">`+ `</section>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:41:58.693

而不是`.load()`使用`$.get()`和的组合`.replaceWith()`。

```
$('#content').html().load() ... 
```

采用

```
$.get({
  url:...,
  success:function(data) {
    $('#content').replaceWith( data )
  }
}); 
```

# excel - 错误 1004：Microsoft Excel 无法粘贴数据

> ID：14792868
> 
> 赞同：0
> 
> 时间：2013-02-09T23:35:32.863
> 
> 标签：excel, error-handling, copy-paste, ms-word, vba

我在复制和粘贴一些 Excel 图表作为图片时遇到问题，并收到错误消息：“1004”Microsoft Excel 无法粘贴数据。”我的代码找到了一个预制图表，更新了范围，复制了图表，并将其粘贴到另一个工作表中。奇怪的是，这个错误是不一致的，有时它会将某个图表粘贴为图片，有时它不会。我可以使用类似的代码复制到word没有问题，如果我使用基本的复制功能，它可以重新粘贴为图表。

这是我用来复制图表并粘贴为图片的功能：

```
chtObj.CopyPicture xlScreen, xlPicture
 PasteSheet.Paste 
```

如果有什么明显的我遗漏了，或者如果有任何变通方法，我愿意接受想法

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T20:57:20.637

我发现对于非常大的数据点，excel 很容易失去对这些点的引用。因此，如果您复制并粘贴图片，我相信它仍会以某种方式保留指向这些数据点的链接，这些数据点可能会不稳定并导致弹出 1004 错误。在 Floris、chuff 和其他 SO 成员的帮助下，我的工作是复制 chartArea 并使用 pastespecial 方法粘贴

```
ActiveSheet.ChartObjects(chtName).Activate
ActiveChart.ChartArea.Copy
PasteSheet.Select
PasteSheet.PasteSpecial Format:="Bitmap", Link:=False, DisplayAsIcon:=False 
```

不幸的是，使用格式化为位图的 pastespecial 粘贴到另一个工作表的唯一方法似乎是先选择工作表粘贴，然后重新选择您从中复制的工作表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T21:36:50.600

唯一对我有用的是选择性粘贴，然后是“XML 电子表格”。它保留了电子表格的完整性，包括我的日期和美元金额以及网站链接。

# java - Css/Html 文本框消失文本不起作用

> ID：14792870
> 
> 赞同：2
> 
> 时间：2013-02-09T23:35:51.220
> 
> 标签：java, html, css, textbox, maskedtextbox

我正在做一个[网站](http://gigster.webege.com)。当您单击我的搜索框时，文本会消失，就像它应该的那样，但是一旦您单击离开，文本就不会回来，我希望它会。这是我的片段

```
<div class='search'>
<form method="get" id='search' action="http://www.google.com/search">
<input type="hidden" name="q" size="31" maxlength="255" value="Site Name:" />
<input type="text" name="q" size="31" maxlength="255" style="height: 24px;" value="Search..." onFocus="this.value=''" />
</div> 
```

我在它后面有很多 css 来使文本框放大和改变颜色。这是代码以防万一。

```
#search input[type="text"] {
background: url(imgs/search-white.png) no-repeat 10px 6px #444;
border: 0 none;
font: bold 12px Arial,Helvetica,Sans-serif;
color: #d7d7d7;
width:150px;
padding: 6px 15px 6px 35px;
-webkit-border-radius: 20px;
-moz-border-radius: 20px;
border-radius: 20px;
text-shadow: 0 2px 2px rgba(0, 0, 0, 0.3); 
-webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 3px rgba(0, 0, 0, 0.2)   inset;
-moz-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 3px rgba(0, 0, 0, 0.2) inset;
box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 3px rgba(0, 0, 0, 0.2) inset;
-webkit-transition: all 0.7s ease 0s;
-moz-transition: all 0.7s ease 0s;
-o-transition: all 0.7s ease 0s;
transition: all 0.7s ease 0s;
outline: none;
}

#search input[type="text"]:focus {
background: url(imgs/search-dark.png) no-repeat 10px 6px #fcfcfc;
color: #6a6f75;
width: 175px;
-webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(0, 0, 0, 0.9) inset;
-moz-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(0, 0, 0, 0.9) inset;
box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(0, 0, 0, 0.9) inset;
text-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
outline: none;
}
div.search
{
position:fixed;
top:8px;
right:5px;
} 
```

单击该框时，该框会放大，并且`Search...`文本会像预期的那样消失。但是，一旦您单击离开，文本就不会返回，我希望它能够返回。我怎么做？*旁注对不起，如果网站看起来不好，我 13

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:49:11.790

改变：

```
<input type="text" name="q" size="31" maxlength="255" style="height: 24px;" value="Search..." onFocus="this.value=''" /> 
```

为了：

```
<input type="text" name="q" size="31" maxlength="255" style="height: 24px;" placeholder="Search..." onFocus="this.value=''" /> 
```

只需要将值更改为占位符:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T01:32:53.300

如果您希望它与旧浏览器（不支持 html5 的浏览器）兼容，您可以执行以下操作：

```
 function removePlaceholder(element)  {
        if (element.value == "Search...") {
            element.value = "";
        }
    }

    function replacePlaceholder(element)  {
        if (element.value == "") {
            element.value = "Search...";
        }
    } 
```

然后将您的`input`标签设置为：

```
<input type="text" name="q" size="31" maxlength="255" style="height: 24px;" value="Search..." onBlur = "replacePlaceholder(this)" onFocus="removePlaceholder(this)" /> 
```

希望这可以帮助！

# php - SimpleXML 加载字符串将值放入 PHP 中的 Array()

> ID：14792873
> 
> 赞同：0
> 
> 时间：2013-02-09T23:36:15.213
> 
> 标签：php, arrays, simplexml

我有一个字符串形式的 XML（在 XLS 转换之后）：

```
<course>
    <topic>
        <chapter>Some value</chapter>
        <title>Some value</title>
        <content>Some value</content>
    </topic>
    <topic>
        <chapter>Some value</chapter>
        <title>Some value</title>
        <content>Some value</content>
    </topic>
    ....
</course> 
```

然后我将上述 XML 推送到 Array() 中：

```
$new_xml = $proc->transformToXML($xml);

$xml2 = simplexml_load_string($new_xml);
$root = $xml2->xpath("//topic");

$current = 0;
$topics_list = array();

// put the xml values into multidimensional array
foreach($root as $data) {
    if ($data === 'chapter') {
        $topics_list[$current]['chapter'] = $data->chapter;
    }
    if ($data === 'title') {
        $topics_list[$current]['title'] = $data->title;
    }
    if ($data === 'content') {
        $topics_list[$current]['content'] = $data->content;
    }
    $current++;
}
print_r($topics_list); 
```

**问题：**结果是空数组。我试过像这样的**字符串**：

```
$topics_list[$current]['chapter'] = (string) $data->chapter; 
```

但结果仍然是空的。谁能解释一下，我的错误在哪里。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T20:04:19.327

因为我的主题元素只有简单的子元素而没有属性，所以我可以将其转换为数组并将其添加到列表中（[Demo](http://eval.in/26406)）：

```
$xml2 = SimpleXMLElement($new_xml);
$topics_list = array();
foreach ($xml2->children() as $data) {
    $topics_list[] = (array) $data;
} 
```

另一种方法是映射[`get_object_vars`](http://php.net/get_object_vars)主题元素（[Demo](http://eval.in/26407)）：

```
$topics_list = array_map('get_object_vars', iterator_to_array($xml2->topic, false)); 
```

但这可能会变得有点难以阅读/理解。Foreach 可能更合适。

* * *

这是我的代码的第一个工作版本：

```
$xml2 = SimpleXMLElement($new_xml);
$current = 0;
$topics_list = array();
foreach($xml2->children() as $data) {
    $topics_list[$current]['chapter'] = (string) $data->chapter;
    $topics_list[$current]['title'] = (string) $data->title;
    $topics_list[$current]['content'] = (string) $data->content;
    $current++;
} 
```

再次感谢@Jack、@CoursesWeb 和@fab 的调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:49:31.660

问题是您没有获得 xml 元素的名称。

要获取 xml 元素的名称，请应用`elm->getName()`

在您的代码中应该是：

```
if ($data->getName() === 'chapter') 
```

有关使用 Simplexml 遍历和获取 xml 元素的更多详细信息，请参阅本教程：[http ://coursesweb.net/php-mysql/php-simplexml](http://coursesweb.net/php-mysql/php-simplexml)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T14:53:12.003

有几个错误。

**1.xpath()的返回值**

```
$root = $xml2->xpath("//topic"); 
```

在这里，您分配`$root`给由 XPath 检索的所有节点的列表`//topic`。所以，当你用

```
foreach($root as $data) 
```

$data 指的是每个`<topic>`元素，而不是它们的子元素。

**2\. SimpleXMLElements 与字符串的比较**

假设，您遍历正确的元素并`$data`引用该`<chapter>`元素：那么以下表达式为真：

```
$data == 'Some value'
(string) $data === 'Some value' 
```

但是您不能`===`在 SimpleXMLElement 和字符串之间进行类型安全比较 ( )，并且转换为字符串不会产生元素名称。你想做的是：

```
if ($data->getName() === 'chapter') 
```

**3.如何获取文本值**

从上面的解释中应该已经很清楚了，但是您还必须替换

```
$data->chapter 
```

和

```
(string) $data 
```

# mysql - MySQL，我如何计算一个月内发生的事情的数量，并在月份名称旁边显示总和？

> ID：14792874
> 
> 赞同：1
> 
> 时间：2013-02-09T23:36:23.200
> 
> 标签：mysql

我需要显示 2 列。第一列应该有月份名称。第二列应该告诉我每个月发布了多少次。例如：

```
 Month     number_of_releases
 January        4
 March          9
 December       2 
```

到目前为止，我有这个：

```
 SELECT DISTINCT MONTHNAME(date) AS 'Month',
    /*Here is where I need help!*/ AS 'number_of_releases'
    FROM table_name; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:37:44.067

在不知道您是如何计算`number_of_releases`的情况下，很难确定...但您可能希望按月份名称对表进行分组并使用合适的[聚合函数](http://dev.mysql.com/doc/en/group-by-functions.html)来产生发布数量。

例如，要获取每个月内的记录数：

```
SELECT   MONTHNAME(date) AS Month, COUNT(*) AS number_of_releases
FROM     table_name
GROUP BY Month 
```

# html - css - 获取 div 来填充杯子支架的父级

> ID：14792875
> 
> 赞同：0
> 
> 时间：2013-02-09T23:36:26.287
> 
> 标签：html, css

我的 CSS 有问题。我不能让我的“圆形”课程的 div 孩子来填补他们的父母。

[http://jsfiddle.net/ubJxJ/10/](http://jsfiddle.net/ubJxJ/10/)

更清楚地说：我希望 div 对齐支架设置。Fx “Match #17”的中心与“Match #1”和“Match #2”的中心相同。

CSS：

```
#cup { display:table; }
#headlinecontainer, #roundcontainer { display:table-row; }
#headlinecontainer div {
    display:table-cell;
    text-align:center;
}
#roundcontainer .round {
    display:table-cell;
    vertical-align:middle;
    background-color:#F00;
    overflow:hidden;
}
#roundcontainer .round div.match { background-color:#0F0; } 
```

HTML：

```
<div id="cup">
    <div id="headlinecontainer">
        <div>Round of 32</div>
        <div>Round of 16</div>
        <div>Quarter</div>
        <div>Semi</div>
        <div>Final</div>
    </div>
    <div id="roundcontainer">
        <div class="round ro32">
            <div class="match">Match #1</div>
            <div class="match">Match #2</div>
            ...
            <div class="match">Match #15</div>
            <div class="match">Match #16</div>
        </div>
        <div class="round ro16">
            <div class="match">Match #17</div>
            ...
            <div class="match">Match #24</div>
        </div>
        <div class="round quarter">
            <div class="match">Match #25</div>
            <div class="match">Match #26</div>
            <div class="match">Match #27</div>
            <div class="match">Match #28</div>
        </div>
        <div class="round semi">
            <div class="match">Match #29</div>
            <div class="match">Match #30</div>
        </div>
        <div class="round">
            <div class="match">Match #31</div>
        </div>
    </div>
</div> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:46:41.710

我想我明白您在寻找什么：典型的支架设置。

但是，您似乎已经做到了！

看看我的 jfiddle 截图：

![在此处输入图像描述](../Images/1143548b6d8932bea7d5ee810d4152e3.png)

你使用的是什么浏览器？你觉得它怎么样？（我正在使用 Chrome）。

# symfony - 79 个字符的行宽 Symfony 2

> ID：14792879
> 
> 赞同：0
> 
> 时间：2013-02-09T23:37:06.557
> 
> 标签：symfony, formatting

我在 PHP 框架 Symfony 2 中进行了大量编程。当我在 Python 中编程时，将行长保持在 79 个字符以内并没有太大问题，但是当我在 PHP 中编程时，尤其是在具有长包名称的 Symfony 中，我发现很难保持 79 个字符的行宽同时保持代码美观和易于理解。例如，下面的代码很难包装到 79 个字符并保持“nice”。

```
return $this->render('MyDemoCodeVendorBundle:Default:preregister_service_vendor.html.twig', array('form' => $form->createView())); 
```

对于如何为这种相当短的线宽格式化代码，您有什么建议/风格推荐吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T00:34:40.273

我建议使用广泛接受的标准，例如 PSR-2：[https](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md) ://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md 。该页面上有一些处理长行的示例。PSR-2 建议 120 个字符的“软”限制，而不是您对 79 个字符的偏好，但按照他们的指导，我会这样写：

```
return $this->render(
    'MyDemoCodeVendorBundle:Default:preregister_service_vendor.html.twig',
    array('form' => $form->createView())
); 
```

假设有 4 个空格缩进，最多可以给你 75 个字符。

# php - 将 2 个查询合二为一

> ID：14792885
> 
> 赞同：0
> 
> 时间：2013-02-09T23:38:06.710
> 
> 标签：php, mysqli, query-optimization

我有这两个查询：

```
$sql = "SELECT SUM(points) as userpoints FROM ".$prefix."_publicpoints
                        WHERE date BETWEEN ? AND ? AND fk_player_id = ?";

// Getting the users points into a variable to use in the next query
$userPoints;

$getuserplacement = "SELECT fk_player_id FROM ".$prefix."_publicpoints
                            WHERE date BETWEEN ? AND ?
                                GROUP BY fk_player_id
                            HAVING SUM(points) > $userPoints";

// After this I count the rows I get and put that into a variable and thats the users Rank
$userRank = $stmt->num_rows + 1; 
```

这给了我这些数字： 点数：-178 位置：1891

然后我尝试了 Ivan 的示例：

```
 $sql= "SELECT fk_player_id FROM ".$prefix."_publicpoints
                        WHERE date BETWEEN ? AND ?
                            GROUP BY fk_player_id
                        HAVING SUM(points) > (
             SELECT SUM(points) as userpoints FROM ".$prefix."_publicpoints
                        WHERE date BETWEEN ? AND ? AND fk_player_id = ?
   )";

if($stmt->prepare($sql)){
    $stmt->bind_param('ssssi',$yearFrom,$yearTo,$yearFrom,$yearTo,$playerid);
    $stmt->execute();
    $stmt->store_result();
    $userMrank = $stmt->num_rows;
    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    }
    $stmt->bind_result($userPoints);
    $stmt->fetch();
} 
```

这给了我这些数字： 点数：3 位置：0

是否可以将这两个查询合并为一个？

希望得到帮助:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:44:32.497

我不知道我是否理解你，但是，你想要这个吗？

```
$sql= "SELECT fk_player_id FROM ".$prefix."_publicpoints
                            WHERE date BETWEEN '$year-01-01' AND '$year-12-31'
                                GROUP BY fk_player_id
                            HAVING SUM(points) > (
                 SELECT SUM(points) as userpoints FROM ".$prefix."_publicpoints
                            WHERE date BETWEEN ? AND ? AND fk_player_id = ?
       )"; 
```

# php - 本周 PHP 5.3

> ID：14792886
> 
> 赞同：0
> 
> 时间：2013-02-09T23:38:12.977
> 
> 标签：php, datetime

我试图找到答案但没有结果

问题是：

在下周星期一的星期天函数返回日期

```
$date = new DateTime();
$date->setTimezone(new DateTimeZone('Europe/Moscow'));
$date->setTimestamp(strtotime('Monday this week'));

echo $date->format("d.m.Y"); 
```

但在其他日子（星期日除外），它返回星期一的正确值。

我曾经设置 locale manualy ，它有一个星期一 - 一周的第一天，但​​ PHP“认为”星期天仍然是第一天。是虫子吗？？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:46:51.750

似乎有已知的特质`strtotime`。它在评论中提到：

[http://www.php.net/manual/en/datetime.formats.relative.php#108317](http://www.php.net/manual/en/datetime.formats.relative.php#108317)

他们没有具体提及不同的语言环境，但如果在不同语言环境下的`strtotime()`行为不正确，那就不足为奇了。`next/this week`

尝试`this Monday`或`next Monday`看看其中一个是否能得到你想要的。

# android - 通过稳定的标记获取纬度，经度？

> ID：14792888
> 
> 赞同：0
> 
> 时间：2013-02-09T23:38:36.457
> 
> 标签：android, google-maps, gis

我必须在屏幕中心创建一个带有标记的应用程序，并通过移动地图而不是标记获得标记显示点的纬度、经度。我已经在互联网上搜索了 Drag Marker 之类的东西，但我不确定这是否是我需要的。任何解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T07:47:12.057

在你的 mapActivity 中写这个。

```
Location l = new Location();
// Location class will be used to calculate distance moved by map
TimerTask tm;
GeoPoint oldCenterOfMap, newCenteOfMap; 
```

// 在你的 on resume 方法上做 oldCenterOfMap = mapView.getMapCenter();

```
Handler mHandler = new Handler();
int isTouched = 0;
MapView mapview = (MapView) findViewById(R.id.yourmapview_from_xml);

mapView.setOnTouchListener(new OnTouchListener() {

@Override
public boolean onTouch(View v, MotionEvent event) {

if (event.getAction() == MotionEvent.ACTION_UP) {
newCenteOfMap = mapView.getMapCenter();

if (mapchanged(oldCenterOfMap, newCenteOfMap)) {
isTouched++;

    // Here is what would you do when you lift your finger fromt he map*****
newCenteOfMap =mapView.getMapCenter());

if (isTouched >= 1) {
if (isTouched > 1) {
mHandler.removeCallbacks(tm_circle);
isTouched = 1;
}
mHandler.postDelayed(tm_circle, 1200);
}
}
if (!mapchanged(oldCenterOfMap, newCenteOfMap))
mHandler.removeCallbacks(tm_circle);
}

return false;
}
});

tm_circle = new TimerTask() {

@Override
public void run() {
isTouched = 0;
// here is what you do after you touched a map moved after 1.2 seconds
oldCenterOfMap = mapView.getMapCenter();

}
};

public boolean mapchanged(GeoPoint oldCenter, GeoPoint newCenter) {

    String distance = l.CalclauteDistance(oldCenter.getLongitudeE6() / 1E6,
            oldCenter.getLatitudeE6() / 1E6,
            newCenter.getLongitudeE6() / 1E6,
            newCenter.getLatitudeE6() / 1E6);

    if (Double.valueOf(distance) == 0.0)
        return false;
    else
        return true;
} 
```

以前的代码会跟踪地图的移动。下一个代码将在地图移动的情况下做出响应。在上面代码中的注释中（//这是您在触摸 1.2 秒后移动的地图后执行的操作和//这是当您从地图上抬起手指时您会执行的操作*****）遵循关于我在另一篇文章中的回答的说明。在地图视图上动态[添加多个叠加层](https://stackoverflow.com/questions/14826824/adding-multiple-overlays-on-mapview-dynamically/14827094#14827094)

编辑

```
public String CalclauteDistance(double long1, double lat1, double long2,
        double lat2) {
    String Result;
    Point p1 = new Point(long1, lat1);
    Point p2 = new Point(long2, lat2);
    Result = p1.distanceTo(p2) + "";
    return Result;

} 
```

这是来自位置类的函数（CalclauteDistance）。

# android - 在日期选择器片段上设置日期边界

> ID：14792889
> 
> 赞同：0
> 
> 时间：2013-02-09T23:38:37.667
> 
> 标签：android, datepicker, android-fragments

我有一个非常简单的日期选择器片段：

```
public class DatePickerFragment extends DialogFragment implements
        OnDateSetListener {

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        final Calendar c = Calendar.getInstance();
        int year = c.get(Calendar.YEAR);
        int month = c.get(Calendar.MONTH);
        int day = c.get(Calendar.DAY_OF_MONTH);

        return new DatePickerDialog(getActivity(), this, year, month, day);
    }

    @Override
    public void onDateSet(DatePicker view, int year, int month, int day) {
        Activity a = getActivity();

        Button dateDueButton = (Button) a.findViewById(R.id.dateDue);
        String sYear = Integer.toString(year).substring(2, 4);
        String sMonth = Integer.toString(month + 1);
        String sDay = Integer.toString(day);
        dateDueButton.setText(sMonth + "/" + sDay + "/" + sYear);
    }
} 
```

我希望能够设置“日期边界”。例如，如果当前日期是 2 月 9 日，我希望仅在 2 月 10 日或之后的日期显示在片段上。我该如何实施呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-11T09:16:09.973

您将使用此方法**getDatePicker()从 DatepickerDialog 获取 Datepicker 对象**

```
public class DatePickerFragment extends DialogFragment implements
    OnDateSetListener {
   private DatePickerDialog datepic;
@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    final Calendar c = Calendar.getInstance();
    int year = c.get(Calendar.YEAR);
    int month = c.get(Calendar.MONTH);
    int day = c.get(Calendar.DAY_OF_MONTH);
    datepic=new DatePickerDialog(getActivity(), this, year, month, day);
    return datepic;
}

@Override
public void onDateSet(DatePicker view, int year, int month, int day) {
    Activity a = getActivity();

    Button dateDueButton = (Button) a.findViewById(R.id.dateDue);
    String sYear = Integer.toString(year).substring(2, 4);
    String sMonth = Integer.toString(month + 1);
    String sDay = Integer.toString(day);
    dateDueButton.setText(sMonth + "/" + sDay + "/" + sYear);
}

public void setMinimumDate(Calendar mintime){
   datepic.getDatePicker().setMinDate(mintime.getTimeInMillis());
}
public void setMaximumDate(Calendar maxtime){
   datepic.getDatePicker().setMaxDate(maxtime.getTimeInMillis());
} 
```

> 使用公共方法 setMinimumDate 和 setMaximumDate 设置边界

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T17:36:05.307

在类中使用[`minDate`](https://developer.android.com/reference/android/widget/DatePicker.html#setMinDate%28long%29)and[`maxDate`](https://developer.android.com/reference/android/widget/DatePicker.html#setMaxDate%28long%29)参数。[`DatePicker`](https://developer.android.com/reference/android/widget/DatePicker.html)

请注意，这些是 API 级别 11 类，因此您必须自己实现此功能以实现向后兼容性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T06:27:36.903

好吧，您可以将当前系统日期与用户选择的日期进行比较。如果用户选择的日期小于当前日期，那么您可以在日期上设置边界。否则，您可以继续节省开支。给出的代码片段可能会对您有所帮助，

```
 public static long getTimeDiffInDays(String birthday) {
    int beforeLenght = birthday.length();
    int afterLenght = birthday.replace("/", "").length();
    int checkFormat = beforeLenght - afterLenght;
    String newBirthday;
    if (checkFormat == 2) {
        int lastIndex = birthday.lastIndexOf("/");
        newBirthday = birthday.substring(0, lastIndex).trim();
    } else {
        newBirthday = birthday.trim();
    }
    SimpleDateFormat sdf = new SimpleDateFormat("MM/dd");
    Calendar now = Calendar.getInstance();

    Date newDate = new Date();
    Date olddate = new Date();
    try {
        newDate = sdf.parse(sdf.format(now.getTime()));
        olddate = sdf.parse(newBirthday);
    } catch (ParseException e) {

        e.printStackTrace();
    }
    long datediff = (olddate.getTime() - newDate.getTime())
            / (1000 * 60 * 60 * 24);

    if (datediff < 0)
        return datediff + 365;
    else
        return datediff;
} 
```

# azure - Azure 表存储反向关系

> ID：14792890
> 
> 赞同：1
> 
> 时间：2013-02-09T23:39:13.680
> 
> 标签：azure, azure-storage, azure-table-storage

我正在使用 azure 表存储（注意：**不是**Azure SQL）并且我有以下情况：

在我的应用程序中，我有许多“邀请”用户的组织，并且在邀请中有一个关联的“角色”和“到期”。一旦组织邀请了用户，我希望组织看到他们邀请的用户列表，并且我希望用户看到他们被邀请的组织列表。

我认为在我的应用程序和这种情况下，数量会很少（即一个组织只会邀请几个用户，而一个用户通常只会被一个组织邀请）。但是，即使有非常大的数字，人们也可以使用一种通用模式来处理这种情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:39:13.680

我目前使用三种方法，具体取决于我的需要：

**事务性的**

我将正向和反向关系存储在同一个分区上......这意味着每个实体都在同一个分区上（即这种方法受单个分区的速率限制），但这意味着您可以使用批处理事务来插入正向和反向关系，这意味着你知道它们永远是正确的。

```
public class OrganisationInvite : TableEntity
{
    // Partition Id - string.Empty
    // Row Id - "Invite_" + OrangisationId + "_" + UserId

    public string Role { get; set; }
    public DateTime Expiry { get; set; }
}

public class OrganisationRequest : TableEntity
{
    // Partition Id - string.Empty
    // Row Id - "Request_" + UserId + "_" + OrganisationId

    public string Role { get; set; }
    public DateTime Expiry { get; set; }
} 
```

要查询，我使用`t.RowKey.StartsWith("Request_...")`或`t.RowKey.StartsWith("Invite_...")`取决于我是否想要获取用户/组织邀请列表。

我想这在数据非常关键时最好使用。

**最终一致性**

我为这两个表提供了所有属性，但它们位于不同的分区上，这为您提供了出色的可伸缩性，但您会丢失事务。我使用消息队列来更新反向关系以匹配正向关系，因此最终数据将匹配。（但有一段时间可能不会）。

```
// Assume both in the same table, thus the prefix on partition
public class OrganisationInvite : TableEntity
{
    // Partition Id - "Invite_" + OrangisationId
    // Row Id -  UserId

    public string Role { get; set; }
    public DateTime Expiry { get; set; }
}

public class OrganisationRequest : TableEntity
{
    // Partition Id - "Request_" + UserId
    // Row Id - OrganisationId

    public string Role { get; set; }
    public DateTime Expiry { get; set; }
} 
```

要查询，我使用`t.PatitionKey == "Request_..."`或`t.PatitionKey == "Invite_..."`取决于我是否想要获取用户/组织邀请列表。也许您会将其中之一视为“事实来源”，因此当用户确实接受邀请时，您将查找“事实来源”并为用户提供该角色等。

这是最具可扩展性的解决方案，如果您在其上使用缓存，则尤其有意义。

**真相的来源**

在这种情况下，我只给出一个实体的属性，而另一个实体只有反向关系的键。您可以将实体添加到最长或查询最多的列表中......在这种情况下，我会说它是一个组织的邀请。与最终一致性方法一样，您可以将逆向关系排队以添加逆向实体。此方法为您提供完整的数据一致性，除非您添加新关系（因为在创建反向关系之前有一点时间），并且具有高度可扩展性 - 虽然读取反向列表的成本更高。

```
 // Assume both in the same table, thus the prefix on partition
public class OrganisationInvite : TableEntity
{
    // Partition Id - "Invite_" + OrangisationId
    // Row Id -  UserId

    public string Role { get; set; }
    public DateTime Expiry { get; set; }
}

public class OrganisationRequest : TableEntity
{
    // Partition Id - "Request_" + UserId
    // Row Id - OrganisationId
} 
```

您可以使用 轻松查询正向关系`t.PatitionKey == "Invite_..."`。但是，这种反比关系并非微不足道。您必须使用查询`t.PatitionKey == "Request_..."`并创建 n 个并行调用来获取每个项目的数据转发数据（在这种情况下，使用在反向关系的 RowKey 中找到的组织 ID）。如果该项目不存在，则不要将其添加到最终列表中。这可确保如果组织更改其角色，例如，用户将在下一次点击时看到此更改。

如果很少使用反向关系并且数据是最新的（我在想用户权限等？），我认为这种方法很有用

# jsf - PrimeFaces 3.5 参数.DIR 动态

> ID：14792892
> 
> 赞同：1
> 
> 时间：2013-02-09T23:39:22.577
> 
> 标签：jsf, jakarta-ee, primefaces

为了使**PrimeFaces 3.5中的新 RTL 支持****动态**工作，我在**web.xml**中附加了以下内容：

```
<context-param>
      <param-name>primefaces.DIR</param-name>
      <param-value>#{facesBean.direction}</param-value>
   </context-param> 
```

如您所见，参数值是一个 EL**表达式**，从 bean 属性评估：方向：

```
 private String direction = "ltr";
    //......

    public String getDirection() {
          if (FacesContext.getCurrentInstance().getViewRoot().getLocale().getLanguage() == "ar") {
             direction = "rtl";
          } else {
             direction = "ltr";
          }
          return direction;

} 
```

但是这不起作用（我太天真了，不敢相信它可以以这种简单的方式工作，因为 web.xml 的加载方式与 xhtml 文件的加载方式不同......）

如果我明确告诉例如 ACCORDION 对方向值做出反应，它**会成功**（如果语言环境更改为 ar，dir 接收 rtl 值，如果更改为 fr 或 en，则 dir 属性接收的值是 ltr）：

```
<p:accordionPanel dir="#{facesBean.direction}" id="accordion_services" dynamic="true" cache="true"
                                  style="text-align: justify;" >
                    <p:tab title="#{i18n.seep}">
                        <h:panelGrid columns="2" cellpadding="10">
<!-- Remainder of code here ...... --> 
```

我可以将后一种解决方案应用于每个具有 DIR 属性的 PrimeFaces 组件，但这会产生反效果并且会消耗大量时间。应用范围 DIR 参数是理想的解决方案，并声称它支持 EL 表达式。所以我有兴趣让它发挥作用。

有什么线索吗？

## 谢谢。

JBoss AS 7.1 Mojarra 2.1 PrimeFaces 3.5 最新 Firefox/Chrome

* * *

**参考：** PrimeFaces 3.5 用户指南的第 491 页：

*全局配置

使用 primefaces.DIR 全局设置来 rtl 指示 PrimeFaces RTL 感知组件，例如数据表、手风琴、tabview、对话框、树以 RTL 模式呈现。*

```
`<context-param>     

<param-name>primefaces.DIR</param-name>

<param-value>rtl</param-value> 

</context-param>` 
```

*参数值也可以是动态值的 EL 表达式。在即将发布的 PrimeFaces 版本中，更多组件将获得内置 RTL 支持。在那之前，如果您使用的组件不提供它，那么在您的应用程序中覆盖 css 和 javascript 将是解决方案。491*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T21:11:17.460

RTL 目前不支持 web.xml 中的 EL（我使用的是 PF 3.5）我已经为 PF 团队创建了一个[功能请求](https://code.google.com/p/primefaces/issues/detail?id=6072&thanks=6072&ts=1377986205)

我在PF论坛上再次发布了这个问题，我在[这里得到了答案](http://forum.primefaces.org/viewtopic.php?f=3&t=33553)

也可以看看：

[在 web.xml 中使用 JSF EL 表达式](https://stackoverflow.com/questions/18519272/using-jsf-el-expression-inside-web-xml)

**更新** 其已修复，并将在即将推出的 Primefaces 4.1 中提供

# jquery - 用 AS3 和其他基于类的语言编写 jQuery 风格的函数链

> ID：14792893
> 
> 赞同：3
> 
> 时间：2013-02-09T23:39:24.963
> 
> 标签：jquery, flash, oop, coding-style, chaining

这不是我遇到的具体问题，更多的是我可以做出的选择，但我确实相信这个问题与 SO 相关，因为可能有一个“正确的”OO 答案，以及这样做的性能收益/损失。我在 AS3 工作，但我相信这个问题与其他基于类/oo 的语言有关。

我试图想办法为具有不同参数的类提供 Java 风格的多个构造函数（这是另一个故事），但这让我想到了 jQuery，以及它如何通过让函数尽可能地返回它们的对象来链接函数正在被召唤。

它并不总是使用 jQuery 编写最整洁的代码，我想这是与经典方法不同的做法，但我想知道**这种方法是否有什么要说的：**

```
//execute chains of methods on creation, as each returns its parent class (person)
var person:Person = new Person().male('a male', 25).wakeUp().lookAround();

//Or later
person.getUp().rubEyes(); 
```

**...以及是否让成员函数都返回一个通常不需要的对象是否代表任何重大浪费/性能问题？**

这似乎是一种保存代码并以更易读的方式表示函数序列的好方法，我想知道是否有人可以提供帮助。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T09:50:54.927

是的，有一点要说`person.getUp().rubEyes()`：语义上看起来更好。就这样。

`new Person().male('a male', 25)`不过是完全不同的情况。Male 不是 getUp 之类的动词。我更喜欢：`new Person({ gender: 'male', age: 25})`。

不使用返回的对象时是否会对性能造成重大影响？不。首先，大多数（jit）编译器足够聪明，可以确定返回的对象从未使用过，因此根本不会执行这些指令。这是一种称为死代码消除的优化策略。其次，即使编译器不会执行这种优化，我们仍然在谈论一些微不足道的时钟周期。没有什么你应该担心的。一般来说，我建议您根本不要担心这些性能问题。更好地将优化工作集中在编译器无法帮助您处理的代码部分（即设计、算法等）上。

玩得开心连锁！

# mysql - 编写联接以在给定邮政编码的一定距离内吸引客户

> ID：14792894
> 
> 赞同：-3
> 
> 时间：2013-02-09T23:39:30.003
> 
> 标签：mysql, sql

我有两个表：邮政编码和客户。

ZipCodes 有`lng`和列`lat`，客户有`zipcode`.

我需要一个查询来让所有客户都拥有一定距离的`XXXXX`邮政编码。

我有一个查询要获取 XXXXX 一定距离内的所有邮政编码：

```
SELECT ZIPCODE,( 3959 * ACOS( COS( RADIANS( $la ) ) * COS( RADIANS( LAT ) ) * COS( RADIANS( LNG ) - RADIANS( $lo ) ) + SIN( RADIANS( $la ) ) * SIN( RADIANS( LAT ) ) ) ) AS distance 
FROM ZipCodes 
HAVING distance <$rad 
ORDER BY distance 
LIMIT 0 , 20 
```

我只是不知道连接是如何工作的，或者如何用 SQL 来表达。如果您能解释提供的任何答案，我也将不胜感激。如果不是我也明白。

我的逻辑是这样的：

```
SELECT name FROM Customers WHERE Customers.zipcode = ( SELECT ZIPCODE,( 3959 * ACOS( COS( RADIANS( $la ) ) * COS( RADIANS( LAT ) ) * COS( RADIANS( LNG ) - RADIANS( $lo ) ) + SIN( RADIANS( $la ) ) * SIN( RADIANS( LAT ) ) ) ) AS distance 
FROM ZipCodes 
HAVING distance <$rad 
ORDER BY distance 
LIMIT 0 , 20) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:00:59.397

干得好。假设您的原始查询返回了它应该返回的内容，这样的事情应该可以工作：

```
SELECT Customers.* 
FROM Customers C 
INNER JOIN 
(
    SELECT ZIPCODE,( 3959 * ACOS( COS( RADIANS( $la ) ) * COS( RADIANS( LAT ) ) * COS( RADIANS( LNG ) - RADIANS( $lo ) ) + SIN( RADIANS( $la ) ) * SIN( RADIANS( LAT ) ) ) ) AS distance 
    FROM ZipCodes 
    HAVING distance <$rad 
    ORDER BY distance LIMIT 0 , 20
) as RelevantCodes 
  ON (C.ZipCode=RelevantCodes.ZipCode) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T00:06:49.283

考虑到邮政编码不圆也不小，精度不可能很好——你应该意识到这一点。

此外，由于地球周长为 40000km，这意味着 1 纬度或经度为 10000 / 90 ~= 111km。

有了这个，如果距离小于地球的一半（10000 公里或更小），这个查询应该可以很好地工作：

```
SELECT * FROM (
    SELECT c.*,
       (   SELECT
              sqrt(pow(mod(360+lat -z.lat, 360),2)
                 + pow(mod(360+long-z.long,360),2)
              ) * 111   -- exact value is 10000 km/90 degrees
           FROM zipcodes
           WHERE zipcode = $zipcode
       ) AS distance
    FROM customers c
    JOIN zipcodes z ON (z.zipcode = c.zipcode)
) x
WHERE distance < $distance_km
ORDER BY distance 
```

# php - 让php脱离身体

> ID：14792897
> 
> 赞同：0
> 
> 时间：2013-02-09T23:39:31.917
> 
> 标签：php, html

我已经阅读并听说将 PHP 和 HTML 标记尽可能分开是非常明智的。现在我的问题是我该怎么做？我真的找不到答案，所以我决定问你。我正在考虑使用 POST 功能。

查看我的代码：

```
<div class="aftelklok rondenSB">
    <a href="?page=agenda">
    <?php 
    // countdown function
    // parameters: (year, month, day, hour, minute, seconds)
    countdown(2013,2,24,18,0,0);
    function countdown($year, $month, $day, $hour, $minute, $seconds)
    {
        // make a unix timestamp for the given date
        $the_countdown_date = mktime($hour, $minute, $seconds, $month, $day, $year, -1);

        // get current unix timestamp
        $today = time();

        $difference = $the_countdown_date - $today;
        if ($difference < 0) $difference = 0;

        $days_left = floor($difference/60/60/24);
        $hours_left = floor(($difference - $days_left*60*60*24)/60/60);
        $minutes_left = floor(($difference - $days_left*60*60*24 - $hours_left*60*60)/60);
        $seconds_left = floor($difference - $days_left*60*60*24 - $hours_left*60*60 - $minutes_left*60);
        if($difference > 0){ echo "Nog ".$days_left." dagen ".$hours_left." uur               .$minutes_left." minuten  tot de dienst"; }
        else{ echo "De vorige dienst is afgelopen."; } 
    }
    ?> 
    </a>
</div> 
```

所以我想要的只是回声，但所有的 php 代码不在我的 div 中，而是在 html 代码之上。喜欢：

```
<?php ..... ?>
<html>
<body>
echo
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:25:23.060

正如 pemeon 所说，*Smarty*是一种非常聪明（双关语）的方法。

如果您想了解有关背景的更多信息，您可能想在谷歌上搜索“ PHP 中**的模型-视图-控制器**”或类似的东西。基本上，它是关于将您的视图（所有演示文稿，例如 HTML）与您的代码逻辑（控制器）和您的数据对象/源（模型）分开。

*Smarty*很好，但您需要一些学习时间来弄清楚模板引擎是如何设计的、如何使用它以及如何将其应用于您的特定挑战。

如果您目前不想要这么大的解决方案，并且希望从更小更容易开始，您可以围绕功能编写自己的非常简单的模板“引擎”`file_get_contents(...)`和`str_ireplace`. 这个想法看起来像这样：您将 HTML 内容放在不包含任何 php 代码但动态创建内容的占位符的模板文件中（例如 *.html 或 *.tpl 文件结尾）：

示例：*main-layout.tpl*

```
<html>
<head><title>${Title}</title></head>
<body>
<img src="yourfancylogo.png" alt="Header logo"><br>
<a href="#">Here some navigation</a> | <a href="#">...</a> | ... <br>
${Content}
<hr>
<div id="footer">&copy; 2013 John Doe - <a href="index.php?requestedpage=contact">Contact us</a></div>
</body>
</html> 
```

示例：*welcome.tpl*

```
<h1>Hello, ${Username}! Nice to see you!</h1>
<p>So your username is ${Username}? Then you might want to read our terms of service before starting to use our app:</p>
<pre>${TOS}</pre> 
```

示例：*tos-document.txt*

```
1) An apple a day keeps the doctor away!
2) No Smoking!
3) ... 
```

在您的 php 脚本中，您可以执行以下操作：

```
<?php

  $template = file_get_contents('main-layout.tpl');

  if (isset($_GET['requestedpage'])) {
    // Parameter given!
    $requestedPage = $_GET['requestedpage'];
  } else {
    // No page parameter. Assume "home".
    $requestedPage = "home";
  }

  $username = "Monty";   // get from session data

  if ($requestedPage == 'home') {
    // -- begin handler code for page "home" --
    $title = "Start Page - Welcome";
    $content = file_get_contents('welcome.tpl');
    $tos = file_get_contents('tos-document.txt');
    $content = str_ireplace('${TOS}', $tos, $content);
    // -- end handler code for page "home" --
  } else if ($requestedPage == 'aboutus') {
    ...
  } else {
    $title = "Page Not Found - Error";
    $content = file_get_contents('error404.tpl');
    $content = str_ireplace('${PageThatWasNotFound}', htmlentities($requestedPage), $content);
  }

  $output = str_ireplace('${Content}', $content, $template);
  $output = str_ireplace('${Title}', htmlentities($title), $output);
  $output = str_ireplace('${Username}', htmlentities($username), $output);

  die($output);

?> 
```

使用模板和要插入的数据的这种分离，您可以稍后修改您的布局/模板，而无需接触您的 php 脚本。例如，如果您想修改所有页面上显示的页眉或页脚，您只需进行**单点更改**，因为您可以从多个模板块模块化组装您的网站。

为了保持上述 php 源代码的可读性，当您的源代码变大时，您可以将所有处理程序代码放入单独的 php 文件中。您可以将它们包含在主源文件中`include`或`require`包含在主源文件中。

但请注意：您必须转义所有可能来自用户输入的占位符值 - 无论您是从数据库还是直接从`$_GET`或`$_POST`（-> XSS 漏洞）获取它们。**所有输入都是邪恶的！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:52:56.120

最好的方法是使用一些模板引擎，如[smarty](http://www.smarty.net/)或[twig](http://twig.sensiolabs.org/)。如果您没有时间学习，您现在可以在顶部编写代码，当您想在 ie 中使用一些计算时，您可以使用 .

```
<?php
    // calculations
    $foo = 'foo';
?>
<html>
<body>
<div><?=$foo?></div>
</body>
</html> 
```

而当你开始使用这种“分离”（文件顶部的php代码）和底部的html，你将使用这个快捷版本的回显功能，你将很容易转变为使用模板系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:53:12.233

您不能在 PHP 块之外使用 php 函数或变量。但是，可以在 php 中存储一个值，`variable`然后在一个小的 PHP 块中使用它。

例如：

```
<?php
// ...
$foo = 42;
// ...
?> 
```

然后

```
<html><body>
    <p>Answer is <?php echo $foo; ?></p>
</body></html> 
```

或者

```
<html><body>
    <p>Answer is <?= $foo; ?></p>
</body></html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T23:47:41.407

您可以将您的 php 放在一个单独的文件中，然后使用`include`or `require`。

do_stuff.php：

```
<?php
  // some calculations
  echo "stuff";
?> 
```

然后在你的html...

索引.php：

```
<html>
<body>
<?php include 'do_stuff.php'; ?>
</body>
</html> 
```

[关于包括](http://php.net/manual/en/function.include.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T00:34:37.350

目标不应该是`php`远离`html`代码，目标应该是让*业务逻辑*远离*表现逻辑*。其中一种方法是利用模型-视图-控制器布局，或者您可以使用许多其他范例之一。这种方法的要点是使更改一个部分独立于另一个：想象创建一个单独的移动端或`json`前端，它执行所有完全相同的逻辑，但输出完全不同。如果业务逻辑和表示逻辑完全纠缠在一起，您将很难，可能需要复制或公然复制代码，以及创建两个需要保持同步的不同分支，使其维护成为一场噩梦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T13:14:05.620

我现在正在使用这种框架，它有点像 MrSnurb 制作的框架，但后来用 HTML 而不是 php。你觉得这个框架怎么样？

```
<?php
if(isset($_GET['page'])) {
    $page = $_GET['page'];
}else{
    $page = "home";
}   
?>
<!DOCTYPE html>
<html>
<head>
<title> Younited - <?php echo $page; ?></title>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="js/slides.min.jquery.js"></script>
</head>
 <body>
<div class="container ronden">  
    <?php 
        include "partials/header.php";
        include "partials/menu.php"; 
    ?>
<div class="content">   
    <?php
        if (file_exists("partials/pages/".$page.".php")) {
            include "partials/pages/".$page.".php";
        }   
        else{ echo "<p>De pagina <b>".$page."</b> bestaat niet.</p>"; 
        } 
        include "partials/sidebar.php"; 
    ?>  
</div>
</div>
    <?php
        include "partials/footer.php";  
    ?>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-09T23:42:41.413

使用一些模板引擎，如[smarty](http://www.smarty.net/)。创建您的 html 代码模板并推送变量。

# haskell - cabal install errors-1.3.1 失败

> ID：14792898
> 
> 赞同：1
> 
> 时间：2013-02-09T23:39:44.473
> 
> 标签：haskell, cabal, heist

我正在尝试安装最新版本的 Heist，但`errors-1.3.1`无法安装依赖项。关于如何克服这个问题的任何建议？

```
$ cabal install errors-1.3.1
Resolving dependencies...
Configuring errors-1.3.1...
Building errors-1.3.1...
Preprocessing library errors-1.3.1...
[1 of 5] Compiling Data.EitherR     ( Data/EitherR.hs, dist/build/Data/EitherR.o )
[2 of 5] Compiling Control.Error.Util ( Control/Error/Util.hs, dist/build/Control/Error/Util.o )

Control/Error/Util.hs:74:10:
    Could not deduce (Monad m) arising from a use of `fmap'
    from the context (Functor m)
      bound by the type signature for
                 fmapRT :: Functor m => (a -> b) -> EitherT l m a -> EitherT l m b
      at Control/Error/Util.hs:74:1-13
    Possible fix:
      add (Monad m) to the context of
        the type signature for
          fmapRT :: Functor m => (a -> b) -> EitherT l m a -> EitherT l m b
    In the expression: fmap
    In an equation for `fmapRT': fmapRT = fmap
cabal: Error: some packages failed to install:
errors-1.3.1 failed during the building phase. The exception was:
ExitFailure 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T00:40:43.960

我在最新的错误中修复了这个问题，即 1.4.1（1.4.0 有一个错误，我没有导出 EitherT 和 MaybeT 类型）。这次我添加了任一依赖项的上限，以防止它在将来发生。

# c++ - Trello 通过 OAuth 写入权限

> ID：14792902
> 
> 赞同：2
> 
> 时间：2013-02-09T23:40:22.367
> 
> 标签：c++, qt, oauth, trello

我正在使用 KQOAuthManager 来获得 trello 授权。但它也只给了我读取权限如何获得写入权限。我走完每一步并使用这三个链接：

```
trello.com/1/OAuthGetRequestToken
trello.com/1/OAuthAuthorizeToken
trello.com/1/OAuthGetAccessToken 
```

但是，如果我在之后添加任何一些参数？它不影响代码。这是我正在运行的代码：http: [//pastebin.com/nDJuuJFR](http://pastebin.com/nDJuuJFR)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:05:01.930

好的，我找到了方法，只是将 oauthManager->getUserAuthorization(link) 中的链接更改为[https://trello.com/1/authorize?scope=read,write](https://trello.com/1/authorize?scope=read,write) from [https://Trello.com/1/OAuthAuthorizeToken](https://Trello.com/1/OAuthAuthorizeToken)

# c++ - 在 C++ 中从另一个源访问类，初始化构造函数时出现问题

> ID：14792903
> 
> 赞同：3
> 
> 时间：2013-02-09T23:40:25.390
> 
> 标签：c++, class, constructor, header

我有一个名为 Player 的类，它有一个构造函数，它接受在我的“player.h”文件中声明的 5 个浮点参数，然后在我的“player.cpp”文件中初始化，如帖子底部所示。

每当我尝试运行该程序时，我都会收到错误消息：

```
build/Debug/MinGW-Windows/player.o: In function `Player':
C:\Users\User\Dropbox\NetBeans Workspace\Testing/player.cpp:11: multiple definition of `Player::Player(float, float, float, float, float)'
build/Debug/MinGW-Windows/main.o:C:\Users\User\Dropbox\NetBeans Workspace\Testing/player.h:20: first defined here 
```

我在这里做错了什么？我尝试在构造函数之前摆脱“public：”，但这根本没有帮助。它说我有多个构造函数定义，但我只初始化一次。我确信这是显而易见的。

两个文件的完整来源：

“播放器.cpp”

```
#include "player.h"

Player::Player(float x, float y, float z, float rx, float ry) {

} 
```

“播放器.h”

```
#ifndef PLAYER_H
#define PLAYER_H

class Player {

public:

    Player(float x, float y, float z, float rx, float ry);
};

#endif 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T23:43:36.507

您可能没有保护您的`.h`文件。

你包括你的`player.h`in `main.cpp`，它会得到这个编译单元的一个定义。然后它被包含在 中`player.cpp`，在那里它得到了第二个定义。

如果您的编译器不支持`#pragma once`，则必须使用**经典**的手动保护它们：

```
#ifndef PLAYER_H
#define PLAYER_H

// all your class definition code here

#endif 
```

# macos - 在 Mac 上使用 Git？我找不到 git-svn

> ID：14792906
> 
> 赞同：1
> 
> 时间：2013-02-09T23:40:42.133
> 
> 标签：macos, git, git-svn

我正在尝试在 Mac OS X 上使用 git，但找不到`git-svn`类似的操作

```
git-svn clone -s http://example.com/my_subversion_repo local_dir 
```

是

```
git svn clone -s http://example.com/my_subversion_repo local_dir 
```

相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T23:49:42.217

虽然我从未使用过该功能，但我相信这两者应该是等价的。我的理由是：

*   执行只是`git svn`导致在脚本中找不到 .git 的错误`/usr/libexec/git-core/git-svn`；
*   在文本编辑器中打开该脚本会显示 git-svn 的作者的功劳：

> 版权所有 (C) 2006, Eric Wong

*   因此运行`git svn help`给出：

> git-svn - 单个 Subversion 树和 git 之间的双向操作

# iphone - StringElement 派生控件未更新标题

> ID：14792908
> 
> 赞同：1
> 
> 时间：2013-02-09T23:40:47.667
> 
> 标签：iphone, ios, xamarin.ios, monotouch.dialog

我有一个源自 MT.D 的控件`StringElement`。可以使用空白/空来创建元素`Caption`，随后当用户将文本添加到不同的控件时会更新该元素。`Caption`是 MT.D`Element`类中的一个字段，设置它不会自动更新关联的控件。因此，为了尝试更新控件，我创建了一个更新基本字段的属性，然后尝试更新控件。

```
public new string Caption {
    get {
        return base.Caption;
    }
    set {
        base.Caption = value;
        var cell = GetActiveCell();
        if (cell != null) {
            cell.TextLabel.Text = value;
        }
    }
} 
```

可悲的是，它没有用新值更新 UI。使用调试器我可以看到它正确设置了新值，但它没有显示文本。如果我使用非空白创建控件，`Caption`则它会正确显示。我使用类似的方法来更新`ImageView`正常工作的控件。

```
private void SetUiState(){
    var cell = this.GetActiveCell();
    if (cell != null) {
        var imgView = cell.ImageView;
        if (imgView != null) {
            imgView.Image = _isEnabled ? _enabledImage : _disabledImage;
        }
        cell.SelectionStyle = _isEnabled ? UITableViewCellSelectionStyle.Blue : UITableViewCellSelectionStyle.None;
    }
} 
```

知道为什么它对细胞不起作用`TextLabel`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T03:23:48.997

我以前见过这种情况，需要重新布置单元格，因为需要更改 TextLabel 的框架以适应文本的变化。

```
public class TestElement : StringElement
{
    public TestElement() : base("")
    {

    }

    public new string Caption {
        get 
        {
            return base.Caption;
        }

        set 
        {
            base.Caption = value;
            var cell = GetActiveCell();
            if (cell != null) 
            {
                cell.TextLabel.Text = value;
                cell.SetNeedsLayout();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T00:00:59.363

In addition to the answer from @Greg Munn, you want to make sure that you return a unique ID for your element. Currently you are not, so when UITableView dequeues a cell of TestElement mixed with StringELement, it would reuse cells that were not ready to be reused in the way they are.

# c++ - 第一个参数作为文件名的路径是什么意思？

> ID：14792912
> 
> 赞同：1
> 
> 时间：2013-02-09T23:41:33.593
> 
> 标签：c++, file, command-line-arguments, filenames

我在 codeeval.com 上闲逛，这是一个用于查看编码挑战的网站，我注意到其中不少具有以下规范：

```
Your program should accept as its first argument a path to a filename 
```

一个例子如下：

描述：

编写一个程序来确定列表的第 M 个到最后一个元素。

输入样本：

第一个参数将是一个文本文件，其中包含一系列以空格分隔的字符，后跟一个整数，表示列表中的索引（基于 1），每行一个。例如......（问题继续解释输入是什么）。

这是否意味着当我编译我的程序时，我会使用 argv[0] 作为参数来接受文件？一个例子如下所示。我对提示的要求有点困惑。谢谢你的帮助！

```
int main(int argc, char **argv)
{
   ifstream file;
   file.open(argv[0]);
   ...
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:44:09.070

`argv[0]`通常是指正在执行的程序的名称。您将使用`argv[1]`（这是程序的第一个参数，而不是程序的名称）。

`argc >= 2`在尝试取消引用之前确保`argv[1]`。

有关如何使用和接收命令行参数的更多详细信息，请参阅[http://crasseux.com/books/ctutorial/argc-and-argv.html 。](http://crasseux.com/books/ctutorial/argc-and-argv.html)`argc``argv`

# vb.net - VB.NET 中的 CLS 合规性问题

> ID：14792919
> 
> 赞同：3
> 
> 时间：2013-02-09T23:42:32.163
> 
> 标签：vb.net, cls-compliant

下面的简单类有什么不符合 CLS 的？

我收到警告说我的派生类不符合 CLS，因为它继承自下面不符合 CLS 的类（显然）。

```
Public MustInherit Class BaseModel

    Protected MustOverride Sub SetIDValue(nValue As Long)

End Class 
```

是的 - 以上是该课程的完整代码。

以下是基类和派生类的完整文件：

### 基类：

```
Imports System.ComponentModel.DataAnnotations

Namespace Core

    Public MustInherit Class BaseModel

        Protected MustOverride Sub SetIDValue(nValue As Long)

    End Class

End Namespace 
```

### 派生类：

```
Imports Snap.Core
Imports System.ComponentModel.DataAnnotations

Public Class SystemValueModel
    Inherits BaseModel

    Public Sub New()

    End Sub

    Public ID_SystemValue As Long

    <Required()> <StringLength(25)>
    Public Token As String

    <Required()> <StringLength(255)>
    Public Value As String

    Protected Overrides Sub SetIDValue(nValue As Long)
        'Nada
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-12T03:52:27.230

通过在构建中启用代码分析并使用“Microsoft 所有规则”，我能够重现此错误。要标记`BaseModel`为符合 CLS，请在`<Assembly: CLSCompliant(True)>`之前添加您可以[在此处](https://msdn.microsoft.com/en-us/library/ms182156(v=vs.120).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)`Namespace Core` 找到更多信息。

# css - CSS 浮动和一般混淆

> ID：14792922
> 
> 赞同：0
> 
> 时间：2013-02-09T23:42:40.363
> 
> 标签：css, css-float

如果这是一个太基本的问题，我很抱歉，但 CSS 让我感到困惑。我认为我正在做一些 CSS 应该很容易做到的事情，但它根本不像我阅读文档的方式那样工作。

这是我的例子。它已被大大简化，但基本问题仍然存在。我确信这是我的一些核心误解，我只是不知道它在哪里。

这是目标：

![标签之间有透明分隔符](../Images/dc6c54ae954c123386482c9a688afdc1.png)

这是我现在得到的： ![我在哪里](../Images/73b9e8ddaa0f33502456f3f8e1945e91.png)

这是HTML：

```
<div id="line-wrapper">
    <div id="block-nice-menus-1">
        <ul id="nice-menu-1">
            <li><span title="Departments" class="nolink">Departments</span>

            </li>
        </ul>
    </div>
    <div id="block-imageblock-40">
        <img src="http://www.kallenconsulting.com/home/files/top-menu-swish.png"
        alt="" />
    </div>
    <div id="block-imageblock-42">
        <img src="http://www.kallenconsulting.com/home/files/Transparent-4x6.png"
        alt="" />
    </div>
</div> 
```

这是CSS：

```
/* -- nice-menu-1 is Main Menu -- */
#line-wrapper {
    background-color: #ff0000;
}
#block-nice-menus-1 {
    position: relative;
    float: right;
    margin-right: 0px;
    height: 40px;
    border: none;
    background: #d6b982;
}
#nice-menu-1 {
    display: block;
    padding: 0px 30px;
    border-top: none;
    border-bottom: none;
    color: #000;
    background: #d6b982;
    line-height: 2.4em;
    font-weight: bold;
    font-family: Helvetica, Arial, Sans-Serif;
    text-transform:uppercase;
    text-decoration: none;
}
#nice-menu-1 ul, #nice-menu-1 li {
    border-top: none;
    border-bottom: none;
    border-color: #e11837;
}
#block-imageblock-40 {
    /* top-menu-swish */
    float: right;
    margin: 0px;
}
#block-imageblock-42 {
    /* top-menu-leading-line */
    bottom: 0px;
    height:6px;
    width:100%;
    background: #d6b982;
} 
```

我无法得到正确的浮动（我知道，还有另一个浮动问题）。主要问题是这将是一个包含可变数量项目的菜单，因此随着菜单的增长，（现在是“部门”，但后来是“部门”、“服务”、“部分”等）它应该向左推，减少线的长度我不能在引导线上使用固定长度（#block-imageblock-42）。此外，菜单项将有分隔符，所以我不能只是全角的东西。这需要在纯 CSS 中完成，而不是 jQuery 或其他 JS。

这是我的问题的 JSfiddle：http: [//jsfiddle.net/zjfsy/](http://jsfiddle.net/zjfsy/)

**更新：** *根据人们试图提供帮助的要求，我已将问题修改为更具体。顶部的“目标”图像已更新，以更准确地反映问题。我真正想澄清的一件事是，这个具体的例子并不那么重要。我已经修改了一个立场：短期内的绝对解决方案。我的愿望是更好地理解为什么这如此困难。我有三个容器。我希望其中两个向右浮动，第三个扩展以填充从最后一个容器到页面边缘的空间。这似乎是 float 应该做的。我认为这是我的一些基本误解。*

*反正。这里有更多的限制：*

1.  *前导条需要扩展以填充左侧和嗖嗖声之间的空白空间。*
2.  *每个选项卡都需要有一个分隔符，允许背景通过。*
3.  *选项卡的数量是可变的，取决于客户的选择——可以定期更改。*
4.  *除了用 CSS 修改它之外，我无法真正改变 HTML 的结构。*

再次，*非常*感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T08:11:16.690

这是我的解决方案：http: [//jsfiddle.net/abbood/b56Vq/](http://jsfiddle.net/abbood/b56Vq/)（以前从未使用过jsfiddle ..如果我做错了，或者我应该分叉你的项目，我很抱歉）

这是代码：

```
<html>
    <head>
        <link href="betterStyle.css" rel="stylesheet">
    </head>
    <body>
        <div id="wrapper">
            <ul>
                <li><div></div><div>Departments</div></li>
                <li><div></div><div>Services</div></li>
                <li><div></div><div>Sections</div></li> 
                <li><div></div><div>stuff</div></li> 
            </ul>
        </div>
    </body>
</html> 
```

//betterStyle.css

```
#wrapper {
    height: 2.5em;
    background-color: #e0203b;
    background-image: url('http://s11.postimage.org/a1jmymlgv/bage_Box.png');            
    background-position: bottom;
    background-repeat: repeat-x;  
}

ul
{
    list-style-type: none;
    float: right;
    margin: 0;
    padding: 0;
}

ul li {
    float: right ;
    display: inline-block;        
}

/* text */
ul li div:nth-child(2) {        
    line-height: 2.5em;
    line-weight: bold;
    font-family: Helvetica, Arial, Sans-Serif;
    text-transform: uppercase;
    background-color: #d6b982;
    float: right;
    padding-right: 1em;
}

/* image */
ul li div:nth-child(1) {
    background-image: url('http://s8.postimage.org/b2qycoatd/top_menu_swish.png');
    background-position: left top;
    background-repeat: no-repeat;  
    float: left;

    width: 53px;
    height: 40px;
    line-weight: bold;
    font-family: Helvetica, Arial, Sans-Serif;
    text-transform: uppercase;        
} 
```

**笔记：**

*   我创建了自己的[图像](http://s11.postimage.org/a1jmymlgv/bage_Box.png)，并使用一些图像托管服务链接到它。

*   您可以根据需要添加任意数量的选项卡（我假设每个选项卡都会附加该图像..我不确定您希望最终的外观如何（右边缘看起来太锋利）..但我'确定你可以根据自己的喜好调整它..添加额外的标签时，水平线会缩小..我认为这就是你所说的意思，*所以随着菜单的增长，它应该向左推，减少线的长度*

![在此处输入图像描述](../Images/721906fd1748cb900c3f2380d458858e.png)

**更新：**

这是更新后的答案，无需更改 html 中的一行：http: [//jsfiddle.net/abbood/SkxkC/](http://jsfiddle.net/abbood/SkxkC/)（出于某种原因，jsfiddle 中的文件夹图像下有一个凹凸。我在 mac chrome/safari/ 上对其进行了测试Firefox，他们工作得很好..让我知道它是否不适合你）

html（几乎相同..只是为了好玩而添加了几个标签）：

```
 <body>
        <div id="line-wrapper">
            <div id="block-nice-menus-1">
                <ul id="nice-menu-1">
                    <li><span title="Departments" class="nolink">Departments</span>

                    </li>
                    <li><span title="Departments" class="nolink">Services</span>

                    </li>
                    <li><span title="Departments" class="nolink">Classes</span>

                    </li>

                </ul>

            </div>
            <div id="block-imageblock-40">
                <img src="http://www.kallenconsulting.com/home/files/top-menu-swish.png"
                alt="" />
            </div>
            <div id="block-imageblock-42">
                <img src="http://www.kallenconsulting.com/home/files/Transparent-4x6.png"
                alt="" />
            </div> 
        </div>
    </body> 
```

CSS：

```
/* -- nice-menu-1 is Main Menu -- */
#line-wrapper {
    background-color: #ff0000;  /* red */
    height: 40px;
    position: relative;
    z-index: -2;
}

#line-wrapper div {
    background-color: #ff0000;  /* red */
}
#block-nice-menus-1 {
    position: relative;
    float: right;
    margin-right: 0px;
    height: 40px;
    border: none;
    background: #d6b982;
}
#nice-menu-1 {
    display: block;

    border-top: none;
    border-bottom: none;
    color: #000;

    line-height: 2.4em;
    font-weight: bold;
    font-family: Helvetica, Arial, Sans-Serif;
    text-transform:uppercase;
    text-decoration: none;
    margin: 0;
    padding: 0;
}

#nice-menu-1 ul {
    padding: 0;
        background-color: #ff0000;  /* red */
}
#nice-menu-1 ul, #nice-menu-1 li {
    border-top: none;
    border-bottom: none;
    border-color: #e11837;
}

#nice-menu-1 li{
    list-style-type: none;
    display: inline-block;
    padding: 0 2em;
    background: #d6b982;    /* bage */
    height: 40px;
}
#block-imageblock-40 {
    /* top-menu-swish */
    float: right;
    margin: 0px;
}
#block-imageblock-42 
{
    /* top-menu-leading-line */
    bottom: 0px;
    height:6px;
    width:100%;
    background-color: #d6b982 !important;
    position: absolute;
    z-index: -1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T00:00:26.050

我也做了类似的事情，不使用#line-wrapper 的 position:relative 特性，因为这可能会在你实现它时给你带来一些问题。

见[http://jsfiddle.net/zjfsy/](http://jsfiddle.net/zjfsy/)

```
#block-imageblock-42 {
/* top-menu-leading-line */
height:6px;
width:100%;
background: #d6b982;
position:absolute;
margin-top:34px;
}

#line-wrapper {   
display: block;
height: 40px;
width: 100%;
background-color: #ff0000;
} 
```

希望这可以帮助！（我肯定会投票 wxactly 的答案，因为它比我的答案更好，因为它不需要带有幻数边距的“硬编码”等。如果可以的话，绝对使用他的答案，但现在至少你有两个不同的方法。

# objective-c - 在 OSX 中拆分类似视图的 UI？

> ID：14792924
> 
> 赞同：0
> 
> 时间：2013-02-09T23:42:56.540
> 
> 标签：objective-c, macos, uisplitviewcontroller

我已经为 iOS 开发了很多应用程序，并且正在尝试使用 OSX 应用程序。设计 iPad 应用程序上的拆分视图等 UI 的最佳方法是什么？对于基于 mac 的示例，请考虑播放列表在 iTunes 中的工作方式。您在左侧选择一个选项，表格视图会根据您选择的内容选择不同的数据集。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:49:27.710

这种界面称为[源列表](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/AppleHIGuidelines/Windows/Windows.html#//apple_ref/doc/uid/20000961-CHDDIGDE)或源视图。它实际上是一种应用于大纲视图的特殊样式。Apple 提供了说明该技术的[SourceView 示例代码。](https://developer.apple.com/library/mac/#samplecode/SourceView/Introduction/Intro.html)

# c++ - Char* 相关的内存泄漏

> ID：14792928
> 
> 赞同：0
> 
> 时间：2013-02-09T23:43:39.740
> 
> 标签：c++, memory, memory-leaks

我正在运行 Valgrind 来检查我的代码是否存在内存泄漏。Valgrind 没有显示任何泄漏发生，但我有一段代码我认为应该导致泄漏，我不明白变量是如何被清理的，或者 Valgrind 没有捕捉到它。为什么两个 char* 数组不会造成泄漏？

```
void BasicEngine::ConnectionInput(int ConnectionId, const char* ClientInput)
{

    // find client assignment to this ConnectionId
    Client* thisClient = this->ClientFind(ConnectionId);

    int SpaceLocation = strcspn(ClientInput," ");

    char* verb;
    char* args;

    if(SpaceLocation == strlen(ClientInput))
    {
        verb = (char*)ClientInput;
        args = (char*)"";
    }
    else
    {
        verb = new char[SpaceLocation+1];
        args = new char[strlen(ClientInput)-SpaceLocation+1];

        sscanf(ClientInput,"%s %[^\n]",verb,args);
    }

    if(thisClient != NULL)
    {    
       // ... client is always null, this is not being reached at the moment.
    }
    else   
    {
        if(this->refCmdHandler != NULL)
         if(this->refCmdHandler->cmdHandler(ConnectionId,ClientInput))
            return;
    }

    this->refServer->TransmitNL(ConnectionId,"Invalid Command.");

}

bool BasicCmdProc::cmdHandler(int ConnectionId, string ClientInput)
{
    Transmit(ConnectionId,string("You Said: ") + ClientInput);

    return true;
} 
```

如果我输入“你好”

输出是：你说：你好

并且没有检测到泄漏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:48:45.660

`hello`不包含空格，因此`strcspn`返回`strlen(ClientInput)`，因此您采用第一个分支。在那个分支中，`verb`并且`args`不是动态分配的，所以没有泄漏。

但是请注意，在“可能已分配”的内存中有一个变量点通常是非常危险的，因为很难确定是否应该释放该变量。因此，您应该`new`在两个分支中都使用，并在最后无条件地释放两个变量。或者，更好的是，使用`std::string`s 并完全避免这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:48:35.870

> 为什么两个 char* 数组不会造成泄漏？

只有当您将`new`运算符的结果分配给它们时，它们才会这样做（在这种情况下，Valgrind 应该通知您）。如果您为它们分配常量字符串，那么就不会泄漏内存 - 常量字符串在程序的整个生命周期内都是活动的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:47:57.507

两个`char *`元素中的任何一个都没有被分配，`verbs`或者`args`当输入是`hello`因为：

```
int SpaceLocation = strcspn(ClientInput," ");

char* verb;
char* args;

if (SpaceLocation == strlen(ClientInput))
{
    verb = (char*)ClientInput;
    args = (char*)"";
}
else
{
    verb = new char[SpaceLocation+1];
    args = new char[strlen(ClientInput)-SpaceLocation+1];

    sscanf(ClientInput,"%s %[^\n]",verb,args);
} 
```

的输出`strcspn(ClientInput, " ")`aka`SpaceLocation`与 相同`strlen(ClientInput)`，因此`new[]`不执行操作，也不分配内存。

您将如何判断是否需要释放`verb`and `args`？不知道是否释放内存是危险的。

# php - 您可以在回调中使用 $this 来获取 phpunit 中模拟类的受保护属性吗？

> ID：14792929
> 
> 赞同：7
> 
> 时间：2013-02-09T23:43:41.557
> 
> 标签：php, unit-testing, mocking, phpunit

您可以在回调中使用 $this 来获取 phpunit 中模拟类的受保护属性吗？或者还有其他方法可以实现吗？

```
 $mock = $this->getMock('A', array('foo'));
 $mock->expects($this->any())->method('foo')->will(
     $this->returnCallback(function() {
         return $this->bar;
 })); 
```

如果您考虑注入模拟对象，这可能非常有用。有时类对其他类具有硬编码的依赖关系，但它使用您理论上可以模拟并创建模拟对象而不是硬编码对象的方法创建它。请看另一个例子。

```
class A {
  protected $bar = "bar";

  public function foo () {
    $b = new B();
    return $b->fizz($this->bar);
  }
}

class B {
  public function fizz ($buzz) {
    return $buzz;
  }
} 
```

但是让我们说 B 类做的不好，我想用模拟来代替它。

```
 $mockB = $this->getMock('B');
 // (...) - and probably mock other things
 $mockA = $this->getMock('A', array('foo'));
 $mockA->expects($this->any())->method('foo')->will(
     $this->returnCallback(function() use ($mockB) {
         return $mockB->fizz($this->bar);
 })); 
```

这在某种程度上可以实现吗？

当然，毫无疑问，目前，如果我像上面那样做，那么我会得到错误：

```
PHP Fatal error:  Using $this when not in object context in (...) 
```

使用`use`关键字我可以从父范围继承 $mockA ：

```
 $mockB = $this->getMock('B');
 // (...) - and probably mock other things
 $mockA = $this->getMock('A', array('foo'));
 $mockA->expects($this->any())->method('foo')->will(
     $this->returnCallback(function() use ($mockA, $mockB) {
         return $mockB->fizz($mockA->bar);
 })); 
```

但这样我会尝试以公共方式访问 bar ，我会得到：

```
PHP Fatal error:  Cannot access protected property (...) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T22:15:57.067

正如其他答案所指出的那样，`$this`可以在 PHP 5.4 以来的闭包中使用。一个鲜为人知的事实是，您可以将闭包绑定到任意对象，并且实际上可以像这样访问它们的私有属性。您需要的方法是[`bindTo()`](http://www.php.net/manual/en/closure.bindto.php)，它返回一个具有不同上下文的*新闭包。*

```
$cb = function() {
  return $this->bar;
};
$cb = $cb->bindTo($mockA); 
```

或更准确地说，您的示例如下所示：

```
 $mockB = $this->getMock('B');
 // (...) - and probably mock other things
 $mockA = $this->getMock('A', array('foo'));
 $fooCallback = function() use (&$mockB) {
     return $mockB->fizz($this->bar);
 };
 $mockA->expects($this->any())->method('foo')->will(
     $this->returnCallback($fooCallback->bindTo($mockA))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T19:45:21.053

As pointed out by dev-null-dweller, in PHP 5.4 you can use $this within the closure as if you where working normally in the method.

In 5.3 you can mimic this behavior by doing:

```
public function getCallback(B $b) {
    $self = $this;
    return function() use($b, $self) { 
        return $b->fizz($self->bar);
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T11:13:37.733

从 php 5.4 开始，您可以`$this`在闭包中使用，但您必须从包含以下受保护属性的对象返回此回调：

```
class A {
    protected $bar = "bar";

    public function foo () {
        $b = new B();
        return $b->fizz($this->bar);
    }

    public function getCallback(B $b) {
        return function() use($b) { 
            return $b->fizz($this->bar);
        };
    }
}

class B {
    public function fizz ($buzz) {
        return $buzz;
    }
}

$mockA = new A;
$mockB = new B;

$callBack = $mockA->getCallback($mockB);
var_dump($callBack() === $mockA->foo()); 
```

但是，如果您需要获取受保护属性的值，则应为其定义公共 getter。这样，测试也将在 php 5.3 中工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-12T16:45:50.323

对于 PHP >= 5.4，使用[`Closure::bind()`](http://php.net/manual/en/closure.bind.php)：

```
 $mockB = $this->getMock('B');
 // (...) - and probably mock other things
 $mockA = $this->getMock('A', array('foo'));
 $mockA->expects($this->any())->method('foo')->will(
     $this->returnCallback(
         \Closure::bind(function() use ($mockB) {
             return $mockB->fizz($this->bar);
 }, $mockA, 'A'))); 
```

对于 PHP >= 5.3，使用[反射](http://php.net/manual/en/book.reflection.php)：

```
 $mockB = $this->getMock('B');
 // (...) - and probably mock other things
 $mockA = $this->getMock('A', array('foo'));
 $mockA->expects($this->any())->method('foo')->will(
     $this->returnCallback(function() use ($mockA, $mockB) {
         $barProp = new \ReflectionProperty('A', 'bar');
         $barProp->setAccessible(true);
         return $mockB->fizz($barProp->getValue($mockA));
 })); 
```

# java - Java Regex - 拆分逗号分隔列表，但在括号内排除逗号

> ID：14792931
> 
> 赞同：4
> 
> 时间：2013-02-09T23:43:48.390
> 
> 标签：java, regex, comma, brackets

我正在尝试编写将像这样拆分Java字符串的正则表达式：

```
300x250,468x60,300x400v(480x320,768x1024,100x100),400x300v,640x480v(200x200,728x90) 
```

变成这样的东西：

```
300x250 
468x60
300x400v(480x320,768x1024,100x100)
400x300v
640x480v(200x200,728x90) 
```

我一直在尝试`\,(\()?`，但这最终也选择了括号中的逗号。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T00:12:59.877

如果您必须使用正则表达式，您可以拆分`,(?![^(]*\\))`

如果不是，那么对字符进行**一次简单的迭代就可以解决问题**

```
String data="300x250,468x60,300x400v(480x320,768x1024,100x100),400x300v,640x480v(200x200,728x90)";

List<String> tokens=new ArrayList<>();
StringBuilder buffer=new StringBuilder();

int parenthesesCounter=0;

for (char c : data.toCharArray()){
    if (c=='(') parenthesesCounter++;
    if (c==')') parenthesesCounter--;
    if (c==',' && parenthesesCounter==0){
        //lets add token inside buffer to our tokens
        tokens.add(buffer.toString());
        //now we need to clear buffer  
        buffer.delete(0, buffer.length());
    }
    else 
        buffer.append(c);
}
//lets not forget about part after last comma
tokens.add(buffer.toString());

String[] splitedArray=tokens.toArray(new String[tokens.size()]);

//lets test what is inside our array
for (String s : splitedArray)
    System.out.println(s); 
```

输出

```
300x250
468x60
300x400v(480x320,768x1024,100x100)
400x300v
640x480v(200x200,728x90) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T01:47:57.733

akburg，复活这个问题以完成，因为它有另一个没有提到的简单解决方案。这种情况类似于[匹配（或替换）模式，除了情况 s1、s2、s3 等](https://stackoverflow.com/q/23589174)。

这是我们的简单正则表达式：

```
\([^)]*\)|(,) 
```

交替的左侧匹配完整的`(parentheses)`标签。我们将忽略这些匹配。右侧将逗号匹配并捕获到第 1 组，我们知道它们是正确的逗号，因为它们与左侧的表达式不匹配。

[这个程序展示了如何使用正则表达式（见在线演示](http://ideone.com/4oDZfj)底部的结果）：

```
import java.util.*;
import java.io.*;
import java.util.regex.*;
import java.util.List;

class Program {
public static void main (String[] args) throws java.lang.Exception  {

String subject = "300x250,468x60,300x400v(480x320,768x1024,100x100),400x300v,640x480v(200x200,728x90)";
Pattern regex = Pattern.compile("\\([^)]*\\)|(,)");
Matcher m = regex.matcher(subject);
StringBuffer b= new StringBuffer();
while (m.find()) {
if(m.group(1) != null) m.appendReplacement(b, "SplitHere");
else m.appendReplacement(b, m.group(0));
}
m.appendTail(b);
String replaced = b.toString();
String[] splits = replaced.split("SplitHere");
for (String split : splits) System.out.println(split);
} // end main
} // end Program 
```

**参考**

[如何匹配（或替换）模式，除了情况 s1、s2、s3...](https://stackoverflow.com/q/23589174)

# c++ - c ++内存错误：free（）：下一个大小无效（快速）

> ID：14792934
> 
> 赞同：0
> 
> 时间：2013-02-09T23:44:24.820
> 
> 标签：c++, gdb, valgrind

当我运行我的测试程序时，我收到了这个错误报告：

```
*** glibc detected *** /home/me/work/co/myprog/build/myprog_test: free(): invalid next size (fast): 0x00000000006d7320 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x7eb96)[0x7ffff706ab96]
/home/me/work/co/myprog/build/myprog_test(_ZN9__gnu_cxx13new_allocatorIdE10deallocateEPdm+0x20)[0x47715e]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas15unbounded_arrayIdSaIdEED2Ev+0x38)[0x474aea]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas6vectorIdNS1_15unbounded_arrayIdSaIdEEEED2Ev+0x19)[0x473177]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas13vector_assignINS1_13scalar_assignENS1_6vectorIdNS1_15unbounded_arrayIdSaIdEEEEENS1_11zero_vectorIdS6_EEEEvRT0_RKNS1_17vector_expressionIT1_EENS1_10sparse_tagE+0x2bf)[0x47b2d9]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas13vector_assignINS1_13scalar_assignENS1_6vectorIdNS1_15unbounded_arrayIdSaIdEEEEENS1_11zero_vectorIdS6_EEEEvRT0_RKNS1_17vector_expressionIT1_EE+0x26)[0x4782f4]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas6vectorIdNS1_15unbounded_arrayIdSaIdEEEE6assignINS1_11zero_vectorIdS4_EEEERS6_RKNS1_17vector_expressionIT_EE+0x23)[0x4771fd]
/home/me/work/co/myprog/build/myprog_test(_ZN5boost7numeric5ublas6vectorIdNS1_15unbounded_arrayIdSaIdEEEEaSINS1_11zero_vectorIdS4_EEEERS6_RKNS1_16vector_containerIT_EE+0x4e)[0x474b52]
/home/me/work/co/myprog/build/myprog_test(_ZN9DataPointC1Ev+0x101)[0x4682d7]
/home/me/work/co/myprog/build/myprog_test(_ZN16Manager13processSampleEP6Sample+0x40)[0x46a49e]
/home/me/work/co/myprog/build/myprog_test(_ZN16Manager7addDataEP6Samplei+0x108)[0x46a8b6]
/home/me/work/co/myprog/build/myprog_test(_ZN16Manager14SetLogFileDataEP6Samplei+0x90)[0x46904a]
/home/me/work/co/myprog/build/myprog_test(_ZN36MyprogTest_testGetValuesToFilter_Test8TestBodyEv+0x6b)[0x4706a5]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc+0x52)[0x49eb29]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc+0x45)[0x499b76]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing4Test3RunEv+0xb9)[0x487461]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8TestInfo3RunEv+0xf6)[0x487bb8]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8TestCase3RunEv+0xe1)[0x48815f]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8internal12UnitTestImpl11RunAllTestsEv+0x272)[0x48ce3e]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc+0x52)[0x49ffcb]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc+0x45)[0x49aa62]
/home/me/work/co/myprog/build/myprog_test(_ZN7testing8UnitTest3RunEv+0x5e)[0x48bbee]
/home/me/work/co/myprog/build/myprog_test(main+0x3e)[0x4a8b76]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xed)[0x7ffff700d76d]
/home/me/work/co/myprog/build/myprog_test[0x466399]
======= Memory map: ========
00400000-004d2000 r-xp 00000000 08:01 11152935                           /home/me/work/co/myprog/build/myprog_test
006d1000-006d2000 r--p 000d1000 08:01 11152935                           /home/me/work/co/myprog/build/myprog_test
006d2000-006d3000 rw-p 000d2000 08:01 11152935                           /home/me/work/co/myprog/build/myprog_test
006d3000-006f4000 rw-p 00000000 00:00 0                                  [heap]
7ffff6fec000-7ffff71a1000 r-xp 00000000 08:01 12452670                   /lib/x86_64-linux-gnu/libc-2.15.so
7ffff71a1000-7ffff73a0000 ---p 001b5000 08:01 12452670                   /lib/x86_64-linux-gnu/libc-2.15.so
7ffff73a0000-7ffff73a4000 r--p 001b4000 08:01 12452670                   /lib/x86_64-linux-gnu/libc-2.15.so
7ffff73a4000-7ffff73a6000 rw-p 001b8000 08:01 12452670                   /lib/x86_64-linux-gnu/libc-2.15.so
7ffff73a6000-7ffff73ab000 rw-p 00000000 00:00 0
7ffff73ab000-7ffff73c0000 r-xp 00000000 08:01 12455438                   /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff73c0000-7ffff75bf000 ---p 00015000 08:01 12455438                   /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff75bf000-7ffff75c0000 r--p 00014000 08:01 12455438                   /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff75c0000-7ffff75c1000 rw-p 00015000 08:01 12455438                   /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff75c1000-7ffff76bc000 r-xp 00000000 08:01 12452678                   /lib/x86_64-linux-gnu/libm-2.15.so
7ffff76bc000-7ffff78bb000 ---p 000fb000 08:01 12452678                   /lib/x86_64-linux-gnu/libm-2.15.so
7ffff78bb000-7ffff78bc000 r--p 000fa000 08:01 12452678                   /lib/x86_64-linux-gnu/libm-2.15.so
7ffff78bc000-7ffff78bd000 rw-p 000fb000 08:01 12452678                   /lib/x86_64-linux-gnu/libm-2.15.so
7ffff78bd000-7ffff799f000 r-xp 00000000 08:01 794196                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff799f000-7ffff7b9e000 ---p 000e2000 08:01 794196                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff7b9e000-7ffff7ba6000 r--p 000e1000 08:01 794196                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff7ba6000-7ffff7ba8000 rw-p 000e9000 08:01 794196                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff7ba8000-7ffff7bbd000 rw-p 00000000 00:00 0
7ffff7bbd000-7ffff7bd5000 r-xp 00000000 08:01 12452672                   /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff7bd5000-7ffff7dd4000 ---p 00018000 08:01 12452672                   /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff7dd4000-7ffff7dd5000 r--p 00017000 08:01 12452672                   /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff7dd5000-7ffff7dd6000 rw-p 00018000 08:01 12452672                   /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff7dd6000-7ffff7dda000 rw-p 00000000 00:00 0
7ffff7dda000-7ffff7dfc000 r-xp 00000000 08:01 12452684                   /lib/x86_64-linux-gnu/ld-2.15.so
7ffff7fd6000-7ffff7fdb000 rw-p 00000000 00:00 0
7ffff7ff7000-7ffff7ffb000 rw-p 00000000 00:00 0
7ffff7ffb000-7ffff7ffc000 r-xp 00000000 00:00 0                          [vdso]
7ffff7ffc000-7ffff7ffd000 r--p 00022000 08:01 12452684                   /lib/x86_64-linux-gnu/ld-2.15.so
7ffff7ffd000-7ffff7fff000 rw-p 00023000 08:01 12452684                   /lib/x86_64-linux-gnu/ld-2.15.so
7ffffffde000-7ffffffff000 rw-p 00000000 00:00 0                          [stack]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall] 
```

我已经通过 gdb 运行它，导致它的行间接地是这个构造函数调用，当它到达构造函数中的行时

```
DataPointPtr data(new DataPoint());
=>
gyro_stdev = zero_vector; 
```

使用 DataPoint 和 Ptr 的这些定义：

```
typedef boost::numeric::ublas::vector<double> vector;

struct DataPoint {
  DataPoint(void);
  long timestamp;
  bool derived;

  vector accel;
  vector accel_filtered;

  vector gyro_filtered;
  vector gyro_stdev;

  vector gyro;

  vector velocity;
  vector position;
  vector orientation;

  vector gravity;
};

typedef boost::shared_ptr<DataPoint> DataPointPtr;

boost::numeric::ublas::zero_vector<double> zero_vector(3);

DataPoint::DataPoint(void) {
  derived = false;

  accel = zero_vector;
  accel_filtered = zero_vector;

  gyro_filtered = zero_vector;
  gyro_stdev = zero_vector;

  gyro = zero_vector;

  position = zero_vector;
  velocity = zero_vector;
  orientation = zero_vector;
  gravity = zero_vector;

} 
```

我也通过 valgrind 运行了相同的程序，我得到了难以置信的输出量，其中大部分看起来像这样，仅取决于我使用的三角函数（sin、tan、atan2 等）

```
==4161== Conditional jump or move depends on uninitialised value(s)
==4161==    at 0x536CC9D: __sin_sse2 (s_sin.c:115)
==4161==    by 0x46B23C: AccelGyroManager::getGyroEstimate(long, boost::numeric::ublas::vector<double, boost::numeric::ublas::unbounded_array<double, std::allocator<double> > >, boost::numeric::ublas::vector<double, boost::numeric::ublas::unbounded_array<double, std::allocator<double> > >) (AccelGyroManager.cxx:659)
==4161==    by 0x46BD53: AccelGyroManager::deriveData(int) (AccelGyroManager.cxx:753)
==4161==    by 0x46957A: AccelGyroManager::GetEstimate(long, float*, float*, float*, float*, float*, float*) (AccelGyroManager.cxx:294)
==4161==    by 0x467150: AgmanDllTest_testDeriveInterpolatedData_Test::TestBody() (agman_test.cxx:144)
==4161==    by 0x49EB28: void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2090)
==4161==    by 0x499B75: void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2126)
==4161==    by 0x487460: testing::Test::Run() (gtest.cc:2162)
==4161==    by 0x487BB7: testing::TestInfo::Run() (gtest.cc:2338)
==4161==    by 0x48815E: testing::TestCase::Run() (gtest.cc:2445)
==4161==    by 0x48CE3D: testing::internal::UnitTestImpl::RunAllTests() (gtest.cc:4237)
==4161==    by 0x49FFCA: bool testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) (gtest.cc:2090)
==4161== 
```

这个问题让我有点困惑。有没有可能我的内存不足？在程序的这一点之前，这个完全相同的构造函数调用成功了大约 400 次。

而且 valgrind 对 s_sin.c 的引用也令人困惑，我在任何地方都找不到这个文件..

非常感谢任何有关查看或浏览内容的建议或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T01:29:22.867

所以我发现了我的问题。正如 Mats Petersson 建议的那样，我的问题实际上是数组溢出。事实证明，我在我的实用程序中为我的单元测试埋下了这个小宝石：

```
SampleArray createPredictableSamples(int count) {
  SampleArray samples(new Sample[100]);
  for (int i = 0; i < count; ++i) {
  ... do stuff
  }
  return samples;
} 
```

*（注意在方法参数化时创建大小为 100 的静态数组...）*

## 所以请记住，**测试代码也有错误！**

这是我用来发现这一点的方法。

当我发布我的问题时，自上次运行测试以来，我已经做了很多更改。运行的输出

```
valgrind --tool=memcheck --leak-check=yes ./test 
```

正因为如此，所以有点不知所措。所以我退出了大部分更改（使用我的版本控制来保持它们可用），然后将它们作为功能集一一重新应用。

每次我引入一个变更集时，我都会重新运行测试，并使用 valgrind 检查内存错误。最后，我做了一个改变（改变我的测试数组大小），产生了大量的输出。我搜索了（正如 valgrind 建议的那样）“写入”到未初始化的内存（即缓冲区溢出）。你瞧，它把我引向了问题所在，行号等等。

在此过程中，我还在测试代码中发现了其他几个内存泄漏。现在，我还有更多的工作要做清理内存泄漏的测试代码，但我至少已经摆脱了缓冲区溢出。

感谢 Mats、David 和 vonbrand 为我指明了正确的方向！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T01:17:24.520

很高兴你已经运行了 valgrind！现在我认为我们应该解决它的担忧。

如果`getGyroEstimate()`正在读取硬件设备，即使事情正确完成，valgrind 也可能将该值视为未初始化。`--gen-suppressions`如果您认为是这种情况（如果不是，甚至可能是暂时的），您可以将其添加到 valgrind“抑制”文件中（如果您使用该选项，valgrind 可以帮助您半自动地执行此操作）。然后你就不会被这个可能无害的警告分心，并且可以继续修复它可能会抱怨的其他事情（其中一些可能是你崩溃的根本原因）。

# elasticsearch - 带有短语的 ElasticSearch Bool 过滤器（而不是单个单词/标签）

> ID：14792942
> 
> 赞同：7
> 
> 时间：2013-02-09T23:45:57.110
> 
> 标签：elasticsearch

在弹性搜索中，这个过滤器

```
{
  "bool": {
    "must": {
      "term": {
        "article.title": "google"
      }
    }
  }
} 
```

正确返回标题中带有“google”的文章。

然而，

```
{
  "bool": {
    "must": {
      "term": {
        "article.title": "google earth"
      }
    }
  }
} 
```

不返回任何结果，尽管有些文章的标题中包含确切的词“google earth”。我希望它这样做。

完整的查询：

```
{
  "size": 200,
  "filter": {
    "bool": {
      "must": {
        "term": {
          "article.title": "google maps"
        }
      }
    }
  },
  {
    "range": {
      "created_date": {
        "from": "2013-01-11T02:14:03.352Z"
      }
    }
  }]
}
} 
```

如您所见，我没有“查询”——只有过滤器、大小和范围。所以我认为 ElasticSearch 正在使用默认分析器......？

我有什么误解？

* * *

**编辑：**对于那些寻找解决方案的人，这是我的过滤器：

```
{
  "query": {
    "bool": {
      "must": {
        "must_match": {
          "article.title": "google earth"
        }
      }
    }
  }
} 
```

节点（1）我们用“query”包装了布尔过滤器，（2）“term”更改为“must_match”，这导致整个短语被匹配（而不是“match”，它将搜索文章。标题与谷歌地球上的标准分析仪）。

完整的查询如下所示：

```
{
  "size": 200,
  "filter": {
    "query": {
      "bool": {
        "must": {
          "must_match": {
            "article.title": "google earth"
          }
        }
      }
    }
  }
} 
```

FWIW，我在“过滤器”字段（而不是使用标准查询）中有这个条件的原因是有时我想使用“must_not”而不是“must_not”，有时我还会添加其他元素到询问。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-10T09:44:17.640

Elasticsearch 根本没有使用分析器，因为您使用了[`term`查询](http://www.elasticsearch.org/guide/reference/query-dsl/term-query.html)，它会查找准确的术语。

您的`title`字段已分析（除非您另有说明），因此`"google earth"`将被索引为两个术语`["google","earth"]`。这就是为什么`term`查询`"google"`有效，但`term`查询`"google earth"`无效 - EXACT 术语不存在。

如果您改用[`match`查询](http://www.elasticsearch.org/guide/reference/query-dsl/match-query.html)，则将在搜索之前分析您的查询词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-06T04:26:42.160

对于那些最近偶然发现的人，请注意，使用更简洁的方式来表示

```
{"query":{"bool":{"must":{"must_match":{"article.title":"google earth"}}}}} 
```

是与

```
{"query":{"match_phrase":{"article.title":"google earth"}}} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-01T14:03:53.357

我通过爆炸传递的短语解决了这个问题，所以只是改变了。

```
{"bool":{"must":{"term":{"article.title":"google earth"}}}} 
```

到

```
{"bool":{"must":{"term":{"article.title":["google", "earth"]}}}} 
```

如果您有很多查询，它并不漂亮并且可能会太慢，但它确实有效。

**注意，我刚刚发现这也会返回任何带有“google”或“earth”的结果。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-24T05:51:07.857

使用 Elasticsearch 5.4.2.，我的解决方案演变为以下解决方案：

```
{"query": {
     "bool": {
         "must": {
             "match_phrase": {
                 "article.title": "google earth"}}}}} 
```

希望这可以帮助某人。

# php - PHP脚本莫名其妙地停止工作而不被触摸

> ID：14792946
> 
> 赞同：0
> 
> 时间：2013-02-09T23:46:07.663
> 
> 标签：php, mysql, login

我有一个登录脚本，其中页面（index.php）可以请求用户登录（protect.php）但是我看到的`index.php`只是一个空白的白色屏幕，没有源代码也**没有错误消息**。我至少应该看到`login.php`要求用户登录。这个脚本工作了几分钟，而不是决定停止工作 *这个确切的脚本以前在我创建的许多其他网络应用程序中工作过，但是这个不工作。*经过数小时的调试，我仍然无法找到解决此问题的方法。

**索引.php：**

```
<?php
$allow=array('0','1','2');
    require("users/protect.php");
?>

<script>window.location="/setup.php";</script> 
```

**保护.php：**

```
<?php
session_start();
// --------------------------------THE VARIABLES---------------------------------- //
@include ("config.php");
// ----------------------------------THE CODE ------------------------------------ //
function clearance ($user_value, $pass_value, $level_value, $userlevel_value, $table_value, $column1, $column2, $path) { // Function to see if user can login
    $check = mysql_query ("SELECT $userlevel_value FROM $table_value WHERE email='$user_value' AND password='$pass_value'"); // Query to see if user exists
    $verify = mysql_num_rows ($check);
    $get = mysql_fetch_array ($check);
    if (count ($level_value) != 0) { // If the allow array contains userlevels
        if (in_array ($get[$userlevel_value], $level_value) && $verify > 0) { // Search allow to see if userlevels match
            $_SESSION['username'] = $user_value; // Register sessions
            $_SESSION['password'] = sha1 ($pass_value); // sha1 password for extra security
            $_SESSION['userlevel'] = $get[$userlevel_value];
        }
    } else {
        if ($verify == 0) { // If attempt fails then redirect to login page
            $_SESSION = array();
            $error = "Sorry but your login details were incorrect";
            @include ("login.php");
            exit;
        }
        if ($verify > 0) { // If attempt is good then register the user
            $_SESSION['username'] = $user_value;
            $_SESSION['password'] = sha1 ($pass_value);
        }
    }
}
function protect ($level_value, $password_value, $userlevel_value, $table_value, $column1, $path) { // Function to keep pages secure
    if (!isset ($_SESSION['username'])) { // If session doesn't exist then get user to login
        if (isset ($_POST['username']) && isset ($_POST['password'])) {
            $error = "Sorry but your login details were incorrect";
        }
        $_SESSION = array();
        @include ("login.php");
        exit;
    } else { // If user is logged in check to see if session is valid and that they have the required userlevel
        $check = mysql_query ("SELECT $password_value, $userlevel_value FROM $table_value WHERE $column1='$_SESSION[username]'"); // Query to see if user exists
        $verify = mysql_num_rows ($check);
        $get = mysql_fetch_array ($check);
        if ($verify == 0) {
            $_SESSION = array();
            $error = "Sorry but your login details were incorrect";
            @include ("login.php");
            exit;
        }
        if ($verify > 0 && count ($level_value) != 0) {     
            if (!in_array ($get[$userlevel_value], $level_value)) { // Check to see if the users userlevel allows them to view the page
                $error = "Sorry but your login details were incorrect";
                @include ("login.php");
                exit; // Ensure no other data is sent
            }
        }
    }
}
if (isset ($_POST['username']) && isset ($_POST['password'])) { // If user submits login information then validate it
    clearance ($_POST['username'], $_POST['password'], $allow, $userlevel, $table, $username, $password, $path);
}
protect ($allow, $password, $userlevel, $table, $username, $path);
mysql_close ($link); // Close the database connection for security reasons
// -----------------------------------THE END ------------------------------------ //
?> 
```

# macos - 在 Mac OS X 上构建 ( Cmake ) QtGStreamer

> ID：14792947
> 
> 赞同：1
> 
> 时间：2013-02-09T23:46:11.267
> 
> 标签：macos, build, cmake, gstreamer, qtgstreamer

我对 Gstreamer 的 Qt 绑定有疑问。我使用 QtGStreamer 包中的自述文件中的程序，但在执行 cmake 命令时出现一些错误。

基本信息：

```
    Mac OS X v. 10.6.8
    GStreamer v. 0.10.36 + 依赖项（通过 MacPorts 安装）
    Cmake v. 2.8.10 + 依赖项（通过 MacPorts 安装）
    Boost v. 1.52.0 + 依赖项（通过 MacPorts 安装）
    Qt v 4.8（通过 SDK 安装程序安装）

```

建议的构建过程：

```
    $ mkdir 构建 && cd 构建
    $ cmake .. -DCMAKE_INSTALL_PREFIX=/path/to/installation/prefix
    $ 制作
    $ 进行安装

```

cmake的结果：

```
    $ cmake .. -DCMAKE_INSTALL_PREFIX=/tmp1/install
    -- C 编译器标识为 GNU 4.2.1
    -- CXX 编译器标识为 GNU 4.2.1
    -- 检查C编译器是否有-isysroot
    -- 检查C编译器是否有-isysroot - yes
    -- 检查 C 编译器是否支持 OSX 部署目标标志
    -- 检查 C 编译器是否支持 OSX 部署目标标志 - 是
    -- 检查工作的 C 编译器：/usr/bin/cc
    -- 检查工作的 C 编译器：/usr/bin/cc -- 工作
    -- 检测 C 编译器 ABI 信息
    -- 检测 C 编译器 ABI 信息 - 完成
    -- 检查CXX编译器是否有-isysroot
    -- 检查CXX编译器是否有-isysroot - yes
    -- 检查 CXX 编译器是否支持 OSX 部署目标标志
    -- 检查 CXX 编译器是否支持 OSX 部署目标标志 - 是
    -- 检查工作的 CXX 编译器：/usr/bin/c++
    -- 检查工作的 CXX 编译器：/usr/bin/c++ -- 工作
    -- 检测 CXX 编译器 ABI 信息
    -- 检测 CXX 编译器 ABI 信息 - 完成
    -- 寻找 Q_WS_X11
    -- 寻找 Q_WS_X11 - 未找到
    -- 寻找 Q_WS_WIN
    -- 寻找 Q_WS_WIN - 未找到
    -- 寻找 Q_WS_QWS
    -- 寻找 Q_WS_QWS - 未找到
    -- 寻找 Q_WS_MAC
    -- 寻找 Q_WS_MAC - 找到
    -- 寻找 QT_MAC_USE_COCOA
    -- 寻找 QT_MAC_USE_COCOA - 找到
    -- 找到 Qt4：/opt/local/bin/qmake（找到版本“4.8.4”）
    -- 增强版：1.52.0
    -- 找到 PkgConfig：/opt/local/bin/pkg-config（找到版本“0.27.1”）
    -- 检查模块“gstreamer-0.10”
    -- 找到 gstreamer-0.10，版本 0.10.36
    -- 检查模块“gstreamer-base-0.10”
    -- 找到 gstreamer-base-0.10，版本 0.10.36
    -- 找到 GSTREAMER_BASE_LIBRARY：/opt/local/lib/libgstbase-0.10.dylib
    -- 找到 GSTREAMER_BASE_INCLUDE_DIR：/Library/Frameworks/GStreamer.framework/Headers/gst/base
    -- 找到 GStreamer：/opt/local/lib/libgstreamer-0.10.dylib（要求至少版本“0.10.33”）
    -- 检查模块“gstreamer-plugins-base-0.10”
    -- 未找到包“gstreamer-plugins-base-0.10”
    -- 检查模块“gstreamer-app-0.10”
    -- 未找到包“gstreamer-app-0.10”
    -- 找不到 GSTREAMER_APP_LIBRARY
    -- 找到 GSTREAMER_APP_INCLUDE_DIR: /Library/Frameworks/GStreamer.framework/Headers/gst/app
    -- 检查模块“gstreamer-interfaces-0.10”
    -- 未找到包“gstreamer-interfaces-0.10”
    -- 找不到 GSTREAMER_INTERFACES_LIBRARY
    -- 找到 GSTREAMER_INTERFACES_INCLUDE_DIR: /Library/Frameworks/GStreamer.framework/Headers/gst/interfaces
    -- 检查模块“gstreamer-video-0.10”
    -- 未找到包“gstreamer-video-0.10”
    -- 找不到 GSTREAMER_VIDEO_LIBRARY
    -- 找到 GSTREAMER_VIDEO_INCLUDE_DIR: /Library/Frameworks/GStreamer.framework/Headers/gst/video
    -- 找不到 GStreamerPluginsBase（缺少：GSTREAMER_APP_LIBRARY GSTREAMER_INTERFACES_LIBRARY GSTREAMER_VIDEO_LIBRARY）（至少需要版本“0.10.33”）
    -- 检查模块“glib-2.0”
    -- 找到 glib-2.0，版本 2.34.3
    -- 找到 GLIB2：/opt/local/lib/libglib-2.0.dylib  
    -- 检查模块“gobject-2.0”
    -- 找到 gobject-2.0，版本 2.34.3
    -- 找到 GObject：/Library/Frameworks/GStreamer.framework/Headers/gobject  
    -- 找到 OpenGL：/System/Library/Frameworks/OpenGL.framework  
    -- 找不到 OpenGLES2（缺少：OPENGLES2_INCLUDE_DIR OPENGLES2_LIBRARY）
    -- 找不到 Doxygen（缺少：DOXYGEN_EXECUTABLE）

    -------------------------------------------------- --------------------------
    -- 以下外部软件包位于您的系统上。
    -- 此安装将具有这些软件包提供的额外功能。
    -------------------------------------------------- --------------------------- * Qt 4 - 构建所有内容所必需 * QtOpenGL - qtvideosink 和 QtGStreamerUi 中的 OpenGL 加速所必需 * QtDeclarative - 必需用于构建 QML 支持 * Boost - 构建 QtGLib 所需 * GStreamer - 构建 QtGStreamer 所需 * GStreamer 基础库 - 用于构建 qwidgetvideosink 元素 * GLib - 构建 QtGLib 所需 * GObject - 构建 QtGLib 所需 * OpenGL - OpenGL 渲染所需支持 qtvideosink（仅限桌面）

    -------------------------------------------------- --------------------------
    -- 下列可选包无法在您的系统中找到。
    -- 考虑安装它们以启用该软件的更多功能。
    -------------------------------------------------- --------------------------- * GStreamer 视频库（0.10.33 或更高版本）  
         用于构建 qwidgetvideosink 元素 * OpenGLES（2.0 或更高版本）  
         qtvideosink 中的 OpenGLES 渲染支持需要（仅限嵌入式）* Doxygen  
         用于生成 API 文档

    -------------------------------------------------- --------------------------
    -- 您的系统上找不到以下必需的软件包。
    -- 在继续之前，您必须安装这些软件包。
    -------------------------------------------------- --------------------------- * GStreamer 应用程序库（0.10.33 或更高版本）  
         需要构建 QtGStreamerUtils * GStreamer 接口库（0.10.33 或更高版本）  
         需要构建 QtGStreamer

    -------------------------------------------------- --------------------------

    cmake/modules/MacroLogFeature.cmake:141 (MESSAGE) 处的 CMake 错误：退出：缺少要求调用堆栈（最近调用优先）：CMakeLists.txt:152 (macro_display_feature_log)

    CMake 错误：此项目中使用了以下变量，但它们设置为 NOTFOUND。请设置它们或确保它们在 CMake 文件中正确设置和测试：GSTREAMER_APP_LIBRARY (ADVANCED)
        由目录/Users/madman/Downloads/RELEASE-0.10.2/src/QGst GSTREAMER_INTERFACES_LIBRARY（高级）中的目标“QtGStreamerUtils”链接
        由目录 /Users/madman/Downloads/RELEASE-0.10.2/src/QGst 中的目标“QtGStreamer”链接

    -- 配置不完整，出现错误！

```

我需要这个绑定来开发一个从闭路电视摄像机播放 MJPEG/ASF 流的应用程序。我已经尝试过 libvlc 但是没有简单的方法来捕获已经显示的流...... GStreamer 是唯一的选择，因为它将是跨平台应用程序

我对 C++/Qt 编程相当陌生，整个构建/编译魔法对我来说仍然有点令人困惑......

我知道如何构建 QtGstreamer 绑定没有简单的答案，但我会非常感谢任何帮助

# javascript - Date toLocaleDateString in node

> ID：14792949
> 
> 赞同：18
> 
> 时间：2013-02-09T23:46:23.520
> 
> 标签：javascript, node.js

When I use `toLocaleDateString` in browser it returns

```
n = new Date()
n.toLocaleDateString()
"2/10/2013" 
```

but in node.js the format is completely different

```
n = new Date()
> n.toLocaleDateString()
'Sunday, February 10, 2013' 
```

How to get the browser's format (`mm/dd/yy`) in node.js?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2017-12-14T07:57:05.793

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-03-15T00:47:34.067

I also found this broken in node.JS. For example, in node console, type

```
new Date().toLocaleDateString('en-GB') 
```

it still displays US format. Using Werner's method above, you can override default Date.toLocaleDateString() behavior for your locale:

```
Date.prototype.toLocaleDateString = function () {
    return `${this.getDate()}/${this.getMonth() + 1}/${this.getFullYear()}`;
}; 
```

**UPDATE: 2021-12-01** Starting with Node.js v13.0.0, releases are now built with default full-icu support. So this shouldn't be a problem with later releases.

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2013-05-06T06:16:37.300

in node.JS you can not get browser's format. Node.JS runs on Server-side.

You have to do date formatting before displaying it in browser at your client side JS framework.

* * *

## 回答 #4

> 赞同：-20
> 
> 时间：2013-02-10T00:32:37.183

```
Date.prototype.toLocaleDateString = function () {
  var d = new Date();
  return (d.getMonth() + 1) + "/" + d.getDate() + "/" + d.getFullYear();
}; 
```

# algorithm - 针对不同成本函数修改 Quine-McCluskey 算法

> ID：14792951
> 
> 赞同：1
> 
> 时间：2013-02-09T23:46:46.690
> 
> 标签：algorithm, logic, computer-science, cad, computer-science-theory

[Quine-McCluskey](http://en.wikipedia.org/wiki/Quine%E2%80%93McCluskey_algorithm)的标准成本函数似乎涉及最小化与门的数量。出于我的目的，我需要最小化文字的数量而不是与门的数量（例如，我会选择 ab+cd 而不是 abcde，因为它有 4 个文字而不是 5 个，即使它还有 1 个与门）。谁能给我一些关于这种不同的成本函数将如何改变算法的指示？

# php - jquery.load() 在 phonegap 上不起作用

> ID：14792954
> 
> 赞同：0
> 
> 时间：2013-02-09T23:47:19.307
> 
> 标签：php, javascript, jquery, cordova

我正在开发带有 phonegap 的买家指南应用程序。我正在尝试使用 jquery 从服务器获取一些信息。但是当我使用phonegap运行以下代码时它不起作用

```
<!DOCTYPE html>
<html>
<head>
<script src="jquery-1.9.1.js">
</script>
<script>
$(document).ready(function(){
  $("button").click(function(){
    $('#div1').load('http://localhost/MySample.php');
  });
});
</script>
</head>
<body>

<div id="div1"><h2>Click to get information</h2></div>
<button>Get External Content</button>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:38:02.490

您是在模拟器上还是在设备上进行测试？

您不能在设备上使用 localhost 因为 localhost 是设备，您必须改用服务器本地 IP

而且您也必须将 IP 列入白名单（或使用 *，它将所有 IP 列入白名单） [白名单指南](http://docs.phonegap.com/en/2.3.0/guide_whitelist_index.md.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:32:04.193

您是否在服务器上启用了 CORS？

PhoneGap 从本地文件系统加载 index.html，同源策略阻止对不同域的 ajax 调用，例如 localhost。

# css - 不使用两个 div 的 div 中心的背景图像不透明度

> ID：14792956
> 
> 赞同：0
> 
> 时间：2013-02-09T23:47:36.810
> 
> 标签：css, opacity

我想在 div 的中心有一个背景图像（宽度是固定的，但高度取决于内容，所以我不知道高度。）

图像是登录系统的大学的标志。所以它的宽度和高度也因大学而异。

如何在没有两个 div 的情况下将徽标放在 div 的中心作为水印？可能吗？

谢谢K

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:49:27.753

CSS

```
#test {
    background-image: url(path/to/image.jpg);
    background-size: 50% auto;
    background-position: center center;
    background-repeat: no-repeat; 
```

}

这应该将图像放置在其父元素的中心，宽度将是您设置的任何百分比。该图像将是背景图像。我相信 IE8 及以下将无法按您的意愿显示。您将需要更改图像，因为我认为您无法通过 CSS 调整背景图像的不透明度。所以使图像半透明。

这是一个小提琴：http: [//jsfiddle.net/MWvCA/](http://jsfiddle.net/MWvCA/)

另一种选择是向 div 添加一个绝对定位的 img，将其居中，并通过 CSS 调整不透明度，但如果我是你，我只会调整图像。

# c++ - Xcode C++ 和文件夹结构

> ID：14792959
> 
> 赞同：1
> 
> 时间：2013-02-09T23:47:46.057
> 
> 标签：c++, xcode, macos

是否可以强制 Xcode 创建文件夹，而不是仅创建一些逻辑组？我需要做项目并且有一些文件夹结构，比如net文件夹中的NET类等，所以包括头文件和编写makefile必须与这个结构兼容。我不知道如何在xcode中创建真正的文件夹。它只创建一些逻辑组，并且源位于一个物理文件夹中，因此例如两个名为 Connection 的文件不能共存，即使它们的类位于不同的命名空间中并且它们应该位于不同的文件夹（“包”）中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T05:56:52.153

右键单击“添加文件...”，单击“新建文件夹”，然后选择文件夹。这会满足您的需求吗？或者，只需在查找器中创建文件夹并将其拖到源列表中。

无论哪种方式，只需确保单击“为任何添加的文件夹创建文件夹引用”而不是“为任何添加的文件夹创建组”。

# twitter-bootstrap - 使用 Twitter Bootstrap 的 MVC 4 页面中没有样式

> ID：14792963
> 
> 赞同：0
> 
> 时间：2013-02-09T23:48:12.140
> 
> 标签：twitter-bootstrap, asp.net-mvc-4

在 Windows 7 上的 VS 2010 中创建一个空白的 MVC 4 项目后，我做了以下安装引导程序包

```
Install-Package twitter.bootstrap.mvc4
Install-Package twitter.bootstrap.mvc4.sample 
```

当我运行该项目时，所有内容都已编译，但页面完全没有样式，这与[软件包站点](http://lostechies.com/erichexter/2012/11/20/twitter-bootstrap-mvc4-the-template-nuget-package-for-asp-net-mvc4-projects/)所建议的不同。这是正常的还是我需要做任何额外的事情？

![在此处输入图像描述](../Images/45b6a4e62b6611937c78553bb9918ce5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:17:40.970

在我看来，它不像是空的 MVC4 应用程序。看起来那是 Internet 应用程序模板，它已经有一个默认页面。看起来正在加载默认页面 - 它没有任何 HTML 来使用引导类。

使用 Empty MVC4 应用程序模板再试一次，它应该可以工作（我刚刚在 VS2012 中尝试过，它至少可以工作。）

# http-status-code-404 - 复制 Orchard CMS 时出现 404 错误

> ID：14792965
> 
> 赞同：1
> 
> 时间：2013-02-09T23:48:16.953
> 
> 标签：http-status-code-404, orchardcms

我有一个好网站。它按预期工作。我将所有文件从那个目录复制到一个新目录。我创建了一个具有正确主机头的新网站并将其指向新目录。当您浏览到新站点时，您会收到 404 错误。

我已经检查了文件权限。我什至让这两个网站共享同一个应用程序池。

任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T02:04:25.793

如果您查看 /App_Data/Logs ，您可以看到错误消息。结果对我来说，这是因为我试图在同一台服务器上两次运行相同的“租户”。

# java - ByteBuffer 的翻转方法的目的是什么？（为什么叫“翻转”？）

> ID：14792968
> 
> 赞同：106
> 
> 时间：2013-02-09T23:48:36.447
> 
> 标签：java, flip, bytebuffer

为什么ByteBuffer的flip()方法叫“flip”？这里“翻转”了什么？根据 apidoc，连续两次翻转不会恢复原始状态，多次翻转可能会趋于`limit()`为零。

我可以以某种方式“取消翻转”以重用超出限制的字节吗？

我可以连接尾部以与其他一些数据翻转吗？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2013-02-09T23:56:54.780

一个相当常见的用例`ByteBuffer`是逐个构建一些数据结构，然后将整个结构写入磁盘。`flip`用于`ByteBuffer`从“从I/O读取”（`put`ting）翻转到“写入I/O”（`get`ting）：使用s序列`put`填充后`ByteBuffer`，`flip`将缓冲区的限制设置为当前位置并将位置重置为零。这具有使未来`get`或`write`从缓冲区写入所有内容`put`到缓冲区中的效果，而不是更多。

完成后`put`，您可能希望重用`ByteBuffer`来构造另一个数据结构。要“取消翻转”它，请调用`clear`. 这会将限制重置为容量（使所有缓冲区都可用），并将位置重置为 0。

所以，一个典型的使用场景：

```
ByteBuffer b = new ByteBuffer(1024);
for(int i=0; i<N; i++) {
    b.clear();
    b.put(header[i]);
    b.put(data[i]);
    b.flip();
    out.write(b);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-05-23T05:30:14.483

Flip 将当前位置值分配给 limit 属性并将 position 属性设置为 0。 Flip 对于仅从缓冲区中排出活动元素很有用。

例如，下面的程序打印“hello”而不是缓冲区的空元素。方法调用限制和位置可以用翻转代替。

```
CharBuffer cbuff = CharBuffer.allocate(40);
cbuff.put("hello"); 
// what below two line of code is what flip does
cbuff.limit(cbuff.position());
cbuff.position(0);      
while(cbuff.hasRemaining()) {
    System.out.println(cbuff.get());
} 
```

有关缓冲区和通道的更多信息，请参阅[http://www.zoftino.com/java-nio-tutorial](http://www.zoftino.com/java-nio-tutorial)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T01:36:26.730

ByteBuffer 设计不当。体面的程序员有很多抱怨。

所以不要试图去推理它，只要仔细研究和使用 API。

现在我不能在没有提出替代方案的情况下说它，所以这里是：

缓冲区有一个固定的`capacity`；它维护 2 个指针：`start`和`end`. `get()`返回该`start`位置的字节并递增`start`。`put()`将字节放在`end`位置并递增`end`。不`flip()`！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-29T14:22:59.963

*flip()*方法使缓冲区为新的通道写入或相对获取操作序列做好准备：它将限制设置为当前位置，然后将位置设置为零。

缓冲区跟踪写入其中的数据。写入后，调用*flip()*方法从写入模式切换到读取模式。

# google-maps - 可以调整亮度或在传单地图上应用模糊效果吗？

> ID：14792969
> 
> 赞同：0
> 
> 时间：2013-02-09T23:48:38.083
> 
> 标签：google-maps, css, leaflet

我知道使用 Google Map API v3（`MapTypeStyler`选项）是可能的，但你认为它是使用 Leaflet API 吗？

问题是我有覆盖地图的文本，我需要通过调整亮度或 - 甚至更好 - 通过应用模糊效果，如本例所示：http: [//www.hongkiat.com/blog/css-filter/](http://www.hongkiat.com/blog/css-filter/)

CSS 着色器看起来很有前途[，但仅支持最新的 Chrome 浏览器](http://iweb.uz/azik/interactive-globe-with-css-shaders-and-google-maps/)。

地图上的文本是模态的（用户必须与按钮交互），我可以使用 PNG 图像文件添加叠加层。我不太喜欢这种需要将不必要的文件传输给客户端的解决方案。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T23:59:21.443

Leaflet is very lightweight and simply puts references to tile images on your html page. So I see two options to change the look of the tiles:

**CSS**

Which indeed depends on the browser.

**Custom tiles**

Leaflet will display tiles from any server. You can for example pick [one of the many styles served by cloudmade](http://maps.cloudmade.com/editor) or make one of your own there. Or use a tool like [TileMill](http://mapbox.com/tilemill/) to create (and perhaps even host) them yourself.

# sql-server - 如何确定 SQL Server 中正在编译的内容

> ID：14792971
> 
> 赞同：7
> 
> 时间：2013-02-09T23:48:42.013
> 
> 标签：sql-server, sql-server-2008

在跟踪我的 SQL Server 2008 Std Edition 安装的性能监视器时，我注意到 SQL Compilations/sec 每 5 秒左右出现一次峰值，从 3 到 50 左右。

我们的编译与批处理请求/秒的比率也相对较高。我知道理想情况下这应该是 1/10 的比率，但我们的工作比例更像是 8/10。

db 支持具有许多应用程序的繁忙网站，因此很难确定导致过度编译的原因，尤其是 5 秒的峰值。几乎所有查询都是存储过程调用而不是嵌入式 SQL，而且我们有大量 (48gb) RAM。

有没有办法在给定的时间查看当前正在编译的查询？如果是这样，我们可以解决是否有问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T05:10:37.150

过去，当我不得不研究计划缓存/过度查询重新编译的问题时，我遵循了 Microsoft 白皮书[“SQL Server 2008 中的计划缓存”中提供的指导</a>，我强烈建议将其阅读为它涵盖了计划缓存、查询计划重用、重新编译的原因、识别重新编译和其他相关主题。](http://msdn.microsoft.com/en-us/library/ee343986%28v=sql.100%29.aspx)

 [话虽如此，SQL Server Profiler（如果您将其作为客户端工具安装的一部分安装，则应位于 Microsoft SQL Server 2008 -> Performance Tools 下）公开了三个与查询编译直接相关的事件，这些事件可能对您有所帮助：

*   光标
    *   光标重新编译
*   表现
    *   用于查询编译的 Showplan XML
*   存储过程
    *   SP：重新编译](http://msdn.microsoft.com/en-us/library/ee343986%28v=sql.100%29.aspx) 

[您正在使用存储过程，因此您可能只需要担心](http://msdn.microsoft.com/en-us/library/ee343986%28v=sql.100%29.aspx)[SP:Recompile](http://msdn.microsoft.com/en-us/library/ms187105(v=sql.100).aspx)事件。每当重新编译存储过程、触发器或用户定义的函数时，都会触发此事件。TextData 列将显示导致语句重新编译的 tsql 语句的文本，EventSubClass 列将显示指示重新编译原因的代码。

**SP 的 EventSubClass 代码：在 SQL 2008 中重新编译**

*   1 = 架构已更改
*   2 = 统计数据已更改
*   3 = 重新编译 DNR
*   4 = 设置选项已更改
*   5 = 温度表已更改
*   6 = 远程行集已更改
*   7 = 浏览权限已更改
*   8 = 查询通知环境已更改
*   9 = MPI 视图已更改
*   10 = 光标选项已更改
*   11 = 带有重新编译选项

如果您监视以下 5 个事件，您将能够看到 SQL Server 上正在调用哪些存储过程和语句，以及哪些正在触发重新编译：

*   存储程序
    *   SP：开始
    *   SP:StmtStarting
    *   SP：重新编译
    *   SP：已完成
*   表现
    *   自动统计

我通常还设置 Profiler 跟踪以捕获这些事件的所有列。我会说使用这 5 个事件设置跟踪，运行 30 到 60 秒的跟踪，然后暂停它，然后您应该对导致重新编译的原因有一个很好的快照。

如果噪音太大，您可以开始将列过滤器添加到跟踪属性以过滤输入/输出事件。例如，如果您发现大多数重新编译只发生在一次数据库上，请在 databaseID 或 databaseName 列上设置列过滤器，以便仅针对该数据库运行的查询包含在您的跟踪中。

然后开始寻找正在重新编译查询的模式，并使用 Microsoft 的白皮书作为他们可能触发重新编译的指南。

# controller - Base_Controller：访问 Laravel 中的当前控制器名称

> ID：14792973
> 
> 赞同：0
> 
> 时间：2013-02-09T23:49:00.127
> 
> 标签：controller, laravel, laravel-3

我试图在 Laravel 3.2 的基本控制器中获取当前控制器名称，但它返回 null。在我的家庭控制器中没有问题。

我怎样才能在我的`Base_Controller`?

```
<?php

class Base_Controller extends Controller {

    public $page_data = array();

    public function __call($method, $parameters) {
        return Response::error('404');
    }

    public function __construct() {

        $this->page_data['body_id'] = Request::$route->controller;

        parent::__construct();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T02:16:46.570

如果您有 PHP 5.3 可用，为什么不使用 get_call_class() 以便获得控制器类名？虽然这是一种解决方法，但并不完全是您想要的......

# perl - Perl Apache：Perl 脚本显示为纯文本

> ID：14792978
> 
> 赞同：17
> 
> 时间：2013-02-09T23:49:39.247
> 
> 标签：perl, apache, windows-7, configuration, cgi

`apache`使用and进行配置时`perl cgi scripts`，不知道为什么`index.cgi`/`index.pl`显示为纯文本而不是执行它们。当我放入`http://localhost`浏览器时，它显示下面的代码，而不是执行它。

```
List item
    #!C:/Dwimperl/perl/bin/perl.exe -w

     print "Content-type: text/html\n\n";
        print <<HTML;
        <html>
        <head>
        <title>A perl web page</title>
        </head>
        <body>
        <h3>A hello world form perl</h3>
        </body>

        HTML
        exit; 
```

这是`httpd.conf`我大部分时间都编辑过的文件的一部分（在阅读了各种在线参考资料、教程之后）

```
# This should be changed to whatever you set DocumentRoot to.
<Directory "D:\webserver">

Listen 80
ServerName localhost:80
LoadModule cgi_module modules/mod_cgi.so

# First, we configure the "default" to be a very restrictive set of 
# features.  
<Directory />
    Options FollowSymLinks +ExecCGI
    AllowOverride None
</Directory>

DirectoryIndex index.html index.html.var index.cgi index.pl

AccessFileName .htaccess

# To use CGI scripts outside of ScriptAliased directories:
# (You will also need to add "ExecCGI" to the "Options" directive.)
#
#AddHandler cgi-script .cgi .pl

ScriptAlias /cgi-bin/ "C:/Apache/Apache2/cgi-bin/" 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-10T09:14:19.693

当浏览器正在打印脚本代码时，这意味着它无法找到运行脚本的应用程序。下面两行应该是您解决此问题的第一步。AddHandler 将确保以 cgi 脚本结尾`.cgi`并被`.pl`视为 cgi 脚本的文件。并且`+ExecCGI`选项将允许执行脚本。还要确保您的脚本指向正确的 perl 二进制位置。

> ```
>  AddHandler cgi-script .cgi .pl
>     Options FollowSymLinks +ExecCGI 
> ```

您的 httpd.conf 中还有一些错误/错误配置点

*   别名行应该指向你的 cgi 脚本所在的**cgi-bin目录。**

> ScriptAlias /cgi-bin/ "D:\webserver\cgi-bin"

*   对于相同的 cgi-bin 目录，以下配置应位于`httpd.conf`. 你应该`<Directory "D:\webserver">`用下面的替换你的部分。

> ```
> <Directory "D:\webserver\cgi-bin" />
>     AddHandler cgi-script .cgi .pl
>     Options FollowSymLinks +ExecCGI
>     AllowOverride None  
> </Directory> 
> ```

*   尝试从命令行运行您的 cgi 脚本，如下所示。它应该首先从命令行打印或运行。

> perl test.cgi

*   `cgi-bin`确保您对目录和 cgi 脚本具有读写递归权限。您还可以创建具有写入权限的目录或文件。`cgi-bin`如果不在其他地方创建目录，您可以在其中拥有写入权限，而是提供其路径`alias`和`directory`属性`httpd.conf`。
*   每次遇到 apache conf 问题时，请检查 apache 错误日志以获取确切的错误消息。它将使您对问题有很好的了解。

此[链接](http://homepages.paradise.net.nz/milhous/cgi.htm)也应该对您有所帮助。

（*额外评论，不是原始回答者*：您可能还需要启用该`cgi`模块。对我来说，让 cgi 在全新安装的 Apache 2 上工作的最后一步是`sudo a2enmod cgi`。在我这样做之前，网站只是向我展示了脚本的内容。）

> `sudo a2enmod cgi`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-13T13:17:32.977

更改新版本的 apache：选项 +FollowSymLinks +ExecCGI

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T00:11:26.910

目录/位置/文件没有与之关联的正确处理程序，或者没有`ExecCGI`启用该选项。请参阅[Apache 教程：使用 CGI 的动态内容](http://httpd.apache.org/docs/2.4/howto/cgi.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-12T07:25:06.863

在 Mac OS X 10.8 上

我不得不这样做

```
<Directory />
    Options FollowSymLinks +ExecCGI
    AllowOverride None
</Directory> 
```

和

取消注释

```
#AddHandler cgi-script .cgi .pl 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-21T19:05:18.073

```
 # use types www.site.com/visible-in-url
 # Apache serves /var/path/to/dir
 ScriptAlias /visible-in-url/ /var/path/to/dir/

 # Note the order of the aliases matters - first cgi than static content
 # Note this dir is a symlink pointing to the desirable directory
 <Directory "/var/path/to/dir">
    AddHandler cgi-script .cgi .pl
    AllowOverride Indexes
    Options +ExecCGI +MultiViews +SymLinksIfOwnerMatch
    Require all granted
 </Directory>

 <Files ~ "\.(pl|cgi)$">
    SetHandler perl-script
    PerlResponseHandler ModPerl::PerlRun
    Options +ExecCGI +SymLinksIfOwnerMatch
    PerlSendHeader On
 </Files> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-16T01:25:53.883

> 当浏览器正在打印脚本代码时，这意味着它无法找到运行脚本的应用程序。

使用`Apache 2.4`（在 OSX Yosemite，10.10.5 上），如果我使用路径错误的 shebang 行，我的浏览器会显示：

> **内部服务器错误**

但即使使用有效的 shebang 行，我也无法按照已接受答案中的建议执行我的 cgi 程序——Apache 只是将程序的文本提供给我的浏览器。经过一些试验，我发现我需要对`/usr/local/apache2/conf/httpd.conf`文件进行的唯一更改是取消注释该行：

```
LoadModule cgid_module modules/mod_cgid.so 
```

我的 cgi 程序具有扩展名 .pl、.py 和 .rb，具体取决于我使用的编程语言（并且 apache cgi-bin 目录包含一个没有扩展名的测试 cgi 脚本），它们都无需指定即可执行httpd.conf 文件中任何位置的有效扩展名。我的默认`httpd.conf`文件只有以下相关行：

```
<IfModule alias_module>
    #Lots of comments here

    ScriptAlias /cgi-bin/ "/usr/local/apache2/cgi-bin/"

</IfModule>
...
...
<Directory "/usr/local/apache2/cgi-bin">
    AllowOverride None
    Options None
    Require all granted
</Directory> 
```

我使用的 shebang 行是，取决于我的 cgi 程序是用什么语言编写的：

```
#!/usr/bin/env perl 
```

或者：

```
#!/usr/bin/env python 
```

或者：

```
#!/usr/bin/env ruby 
```

cgi 程序也必须是可执行文件，否则您将收到**内部服务器**错误：

```
$ chmod a+x myprog.pl 
```

`a+x`=> 全部 + 可执行文件。换句话说，将可执行权限添加到所有者、组、其他中的每一个。

而且，至少 cgi 程序必须`Content-Type header`在输出响应正文之前生成一个：

```
print "Content-Type: text/html\n\n";
print "<h1>Hello, World.</h1>"; 
```

（顺便说一句，该确切代码将在 perl、python 或 ruby​​ 中工作。）否则，您将再次收到**内部服务器**错误。

执行 cgi 脚本的 url：

```
http://localhost:8080/cgi-bin/myprog.pl 
```

这就是我安装apache的方式：

```
~/Downloads$ tar xvfz httpd-2.4.18.tar.bz2
...
...
~/Downloads$ cd httpd-2.4.18
...
...
~/Downloads/httpd-2.4.18$ ./configure --help
...
...
--enable-so       DSO capability. This module will be automatically
                  enabled unless you build all modules statically.
...
... 
```

我不知道这到底是什么意思，但是[php 文档](http://php.net/manual/en/install.unix.apache2.php)说要使用该选项安装 apache，所以我继续这样做：

```
~/Downloads/httpd-2.4.18$ ./configure --enable-so
...
...
~/Downloads/httpd-2.4.18$ make
...
...
~/Downloads/httpd-2.4.18$ sudo make install 
```

Apache DSO 文档[在这里](http://httpd.apache.org/docs/current/dso.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-08T17:38:34.613

如果没有其他工作，请确保您正在显示从本地服务器调用可执行脚本的 HTML 页面，例如[http://192.168.0.15/yourPage.html](http://192.168.0.15/yourPage.html)。如果您通过在浏览器中将 HTML 页面作为文件打开来调用它，它将始终将您的可执行脚本显示为文件。

# css - Twitter Bootstrap - 不想要响应

> ID：14792985
> 
> 赞同：0
> 
> 时间：2013-02-09T23:50:50.247
> 
> 标签：css

我正在重新设计我的漫画网站[http://HittingTreesWithSticks.com](http://HittingTreesWithSticks.com)，并且在响应能力方面遇到了很多麻烦。话虽如此，我想在没有响应的情况下重做它。

所以当我把屏幕变小时，元素不会缩小，比如[http://theoatmeal.com/](http://theoatmeal.com/)。

我只包含`<link rel="stylesheet" type="text/css" href="./bootstrap/css/bootstrap.css" media="screen"/>`在我的标题中，而不是响应文件中，但它仍然是响应的。这是为什么？

另外，我是否需要将所有内容更改为而不是？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T23:53:13.137

您可以通过执行以下操作使您的网站无响应：

*   删除`@media`bootstrap.css 底部的所有规则和样式
*   `max-width: 100%;`从`img {}`规则中删除
*   确保您的 HTML 不包含任何带有“-fluid”的类名

# html - QTextBrowser 不显示来自 html 文件的图像（Windows 7）

> ID：14792991
> 
> 赞同：4
> 
> 时间：2013-02-09T23:50:55.817
> 
> 标签：html, image, qt, qtextbrowser

我正在使用 QTextBrowser 来显示与应用程序位于同一目录中的外部 html 文档（及其图像资源）。一切正常，只是图像显示不正确。而不是实际的图片有一个“丢失的图像”图标。

使用 Ubuntu 12.04 我没有这个问题，但在 Windows 7 中它不能按预期工作（我之前描述过）。

我尝试了不同的图像格式和 Qt 版本，但没有成功。

如果我输入图像的绝对文件路径，它会显示得很好。但这不是我想做的，因为那时我不能分享我的应用程序。

这是将 html 文件加载到文本浏览器中的部分：

```
QFile file(QApplication::applicationDirPath().append("/test.html"));
if(!file.open(QIODevice::ReadWrite|QIODevice::Text))
    return;

QTextStream in(&file);
ui->textBrowser->setHtml(in.readAll());
file.close(); 
```

这是我的 html 文档：

```
<!doctype html>
<html>
    <img src="test.png">
    <p>paragraph which contains some text</p>
</html> 
```

有人知道为什么它不显示图像吗？

提前致谢，

彼得

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-10-19T06:28:20.207

我会说图像路径完全不正确，因为它当前是相对的，但是您必须将 HTML 文件作为绝对地址。

要进行测试，请尝试在图像 src 上使用绝对 URL 以查看它是否有效。您可以尝试使用互联网上的一个，然后在本地文件系统上尝试一个。

如果它们都使用绝对 URL，那么您只需要考虑在 HTML 文档中获取正确的文件路径。

我希望这可以帮助您调试问题。抱歉，我没有准确的答案，我也是 QT 的新手。

# java - 如何使用 Stringtemplate 4.x 直接写入 OutputStream？

> ID：14792992
> 
> 赞同：4
> 
> 时间：2013-02-09T23:51:30.510
> 
> 标签：java, stringtemplate, stringtemplate-4, st

我不想从我的一些模板中调用`.render()`和构建非常大`Strings`的模板。在以前的版本中，您可以`OutputStream`直接写入 a 而不必将整个模板渲染到 a`String`然后将其写出来。

我尝试使用`ST.write()`一个实例，`NoIndentWriter`但没有产生输出。

### 您如何`OutputStream`使用最新版本直接写入`Stringtemplate`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-25T19:26:10.953

`AutoIndentWriter`如果要保持标准格式，可以使用。

```
ST template = group.getInstanceOf("YourTemplate");
OutputStreamWriter osWriter = new OutputStreamWriter(stream);
STWriter stWriter = new AutoIndentWriter(osWriter);
template.write(stWriter);
osWriter.flush(); 
```

# c++ - 使用 MSGPACK_DEFINE 而不更改类声明

> ID：14792994
> 
> 赞同：5
> 
> 时间：2013-02-09T23:52:26.290
> 
> 标签：c++, msgpack, messagepack

MsgPack C++ 中有没有办法在不改变类成员的情况下使用 MSGPACK_DEFINE？我们希望将消息包内容保留在标头之外，并且仅在库内部使用它。

似乎只是包装每个类就可以了，但我希望有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-13T00:13:30.807

**升级版**。或者你可以使用`MSGPACK_DEFINE_EXTERNAL`我写的宏。

`.hpp.erb`源代码在这里[可用](https://gist.github.com/xyzz/2181e5f03a420bd7451f/raw/83f9ca06adb14d8255ceb476f914efec58b7f8b5/gistfile1.txt)，生成`.hpp`在[这里](https://gist.github.com/xyzz/3e1ee4b47fff1b48b916/raw/e9a7e9522cf69419b73acc1cae3752c04f473b4f/gistfile1.cpp)。

只需`#include "define_external.hpp"`, 然后调用`MSGPACK_DEFINE_EXTERNAL`传入要序列化/反序列化的类及其成员。

例如：

```
MSGPACK_DEFINE_EXTERNAL(v3f, X, Y, Z); 
```

我已经测试过这个头文件可以与 gcc 4.8.2、clang 3.3 和 MSVC 2010 一起使用。

* * *

为了在我的项目中实现这一点，我刚刚定义了`operator>>`和`operator<<`. 这不像使用那么简单`MSGPACK_DEFINE`，但它确实有效。

```
namespace msgpack {

inline v3f& operator>> (object o, v3f& v)
{
    if(o.type != type::ARRAY) { throw type_error(); }
    if(o.via.array.size != 3) { throw type_error(); }
    o.via.array.ptr[0].convert(&v.X);
    o.via.array.ptr[1].convert(&v.Y);
    o.via.array.ptr[2].convert(&v.Z);
    return v;
}

template <typename Stream>
inline packer<Stream>& operator<< (packer<Stream>& o, const v3f& v)
{
    o.pack_array(3);
    o.pack(v.X);
    o.pack(v.Y);
    o.pack(v.Z);
    return o;
}

} 
```

您可以在 中找到更多示例`src/msgpack/type/`。

# javascript - javascript将数字显示为带有动画的图片

> ID：14792995
> 
> 赞同：0
> 
> 时间：2013-02-09T23:52:39.747
> 
> 标签：javascript, jquery

我喜欢将一些数字显示为图片。所有数字都包含在一张图片中。

我开始为每个数字创建一个跨度，每个跨度都有一个不同的类，这样我就可以使用样式属性“背景位置”将图片更改为正确的数字。

这对我有用。但现在我想给这个数字添加一点动画，比如计数到正确的值。我可以为一个跨度（数字）执行此操作，但如何为所有数字执行此操作？

**HTML**：

```
 <style>
.digit0 { background-position: 0  0; }
.digit1 { background-position: 0  -120px; }
.digit2 { background-position: 0  -240px; }
.digit3 { background-position: 0  -360px; }
.digit4 { background-position: 0  -480px; }
.digit5 { background-position: 0 -600px; }
.digit6 { background-position: 0 -720px; }
.digit7 { background-position: 0 -840px; }
.digit8 { background-position: 0 -960px; }
.digit9 { background-position: 0 -1080px; }
</style>
</head>
<body>
    <h1>Examples</h1>
    <p> 

<div id="number">here</div>

    </p>
</body> 
```

**Javascript**：

```
<script type="text/javascript">
$(document).ready(function(){
    // Your code here
    var dd = "5487";
    dd = dd.replace(/(\d)/g, '<span class="digit0" id="count$1" style="display: inline-block; height: 20px; line-height: 40px; width: 14px; vertical-align: middle; text-align: center; font: 0/0 a; text-shadow: none; background-image: url(../src/jquery.counter-analog.png); color: transparent; margin: 0;"></span>');

    $("#number").html(dd);

    count = $("#count4").attr("id").replace("count", "").toString();

    var i = 0;
    setInterval(function() {
        counter();
    }, 100);

    function counter() {
        if(i < count) {
            i++;    
            $("#count4").attr("class", "digit" + i + "");
        }
    }
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:39:49.140

几天前我已经回答了另一个类似的问题：

```
$.fn.increment = function (from, to, duration, easing, complete) {
    var params = $.speed(duration, easing, complete);
    return this.each(function(){
        var self = this;
        params.step = function(now) {
            self.innerText = now << 0;
        };

        $({number: from}).animate({number: to}, params);
    });
};

$('#count').increment(0, 1337); 
```

**更新**

如果您真的想使用图像，请执行以下操作：

```
$.fn.increment = function (x, y, from, to, duration, easing, complete) {
    var params = $.speed(duration, easing, complete);
    return this.each(function(){
        var self = this;
        params.step = function(now) {
            self.style.backgroundPosition = x * Math.round(now) + 'px ' + y * Math.round(now) + 'px';
        };

        $({number: from}).animate({number: to}, params);
    });
};

$('#count').increment(0, 120, 9); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T00:11:46.210

使用纯 Javascript 是不可能的。

您所要求的必须使用[PHP 的 GD 之](http://php.net/manual/en/book.image.php)类的东西在服务器端执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T00:33:13.623

这是一种方法。它当然仍然有提高效率和易读性的空间，到处都是（请参阅此答案的编辑历史以了解此类改进:)）。但这是一个不错的开始恕我直言：

```
// goal digits
var dd = '5487';
// separate digits
var digits = dd.split( '' );
// set some animation interval
var interval = 100;

// create spans for each digit,
// append to div#number and initialize animation
digits.forEach( function( value, index ) {
    // create a span with initial conditions
    var span = $( '<span>', {
        'class': 'digit0',
        'data': {
            'current': 0,
            'goal' : value
        }
    } );
    // append span to the div#number
    span.appendTo( $( 'div#number' ) );
    // call countUp after interval multiplied by the index of this span
    setTimeout( function() { countUp.call( span ); }, index * interval );
} );

// count animation function
function countUp()
{
    // the current span we're dealing with
    var span = this;
    // the current value of the span
    var current = span.data( 'current' );
    // the end goal digit of this span
    var goal = span.data( 'goal' );

    // increment the digit, if we've not reached the goal yet
    if( current < goal )
    {
        ++current;
        span.attr( 'class', 'digit' + current );
        span.data( 'current', current );

        // call countUp again after interval
        setTimeout( function() { countUp.call( span ); }, interval );
    }
} 
```

[*在 jsfiddle 上查看它的实际应用*](http://jsfiddle.net/cDjGq/1/)

要更改动画的速度，请更改 的值`interval`。

# r - 添加从不同表派生的新列而不使用“合并”功能

> ID：14792999
> 
> 赞同：0
> 
> 时间：2013-02-09T23:52:55.263
> 
> 标签：r

假设这两个表 - A 和 B

表 A 是

```
id v1  
1  10
3  20
5  20
6  15 
```

表 B 是

```
id v2  
1  200
2  300
3  200
4  250
5  190
6  290 
```

我想将B的“v2”添加到具有相同“id”的A，如下所示：

表A应该是

```
id v1 v2
1  10 200
3  20 200
5  20 190
6  15 290 
```

我感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T00:15:49.903

使用`data.table`which 基于 X[Y] 语法：

```
require(data.table)
dt1 <- data.table(df1)
dt2 <- data.table(df2)
setkey(dt1, "id")
setkey(dt2, "id")
> dt2[dt1]

#    id  v2 v1
# 1:  1 200 10
# 2:  3 200 20
# 3:  5 190 20
# 4:  6 290 15 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T01:26:30.527

您可以使用`sqldf`

```
library(sqldf)
sqldf('SELECT dat.*,dat1.v2
       FROM dat,dat1
       WHERE dat.id = dat1.id')
  id v1  v2
1  1 10 200
2  3 20 200
3  5 20 190
4  6 15 290 
```

但是使用`merge`我们得到相同的结果

```
merge(dat,dat1)
  id v1  v2
1  1 10 200
2  3 20 200
3  5 20 190
4  6 15 290 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T01:40:06.770

您可以通过以下方式使用环境查找：

```
library(qdap)

A$v2 <- lookup(A$id, B)
A

> A
  id v1  v2
1  1 10 200
2  3 20 200
3  5 20 190
4  6 15 290 
```

这在大型数据集上非常快。