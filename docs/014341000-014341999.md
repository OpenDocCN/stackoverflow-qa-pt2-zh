# StackOverflow 问答 14341000-14341999

# c# - 在更新面板内的回发中保持可滚动的网格视图位置

> ID：14341006
> 
> 赞同：2
> 
> 时间：2013-01-15T15:28:00.490
> 
> 标签：c#, asp.net

我有一个带有溢出-y:auto 的网格视图。网格视图位于更新面板内，该面板包含在用户控件中。此用户控件使用 ajax 模式弹出扩展器显示。现在，这个 gridview 可能有数百个项目，如果用户必须选择一个项目，那么异步回发会再次重新加载弹出窗口并且滚动位置丢失。我也尝试使用链接[http://weblogs.asp.net/andrewfrederick/archive/2008/03/04/maintain-scroll-position-after-asynchronous-postback.aspx](http://weblogs.asp.net/andrewfrederick/archive/2008/03/04/maintain-scroll-position-after-asynchronous-postback.aspx)上发布的解决方案，但没有运气。不确定我是否放错了javascript代码。

这是我有模态弹出扩展器的地方。

```
<asp:Panel ID="pnlShowDirectMailMedium" runat="server" Visible="false" HorizontalAlign="Center">
        <uc2:DirectMailMedium ID="ucDirectMailMedium" runat="server" OnCloseEvent="ucDirectMailMedium_CloseEvent" />
        <asp:HiddenField ID="hfCloseDMMedium" runat="server" />
    </asp:Panel>
    <cc1:ModalPopupExtender ID="mpeDirectMailMedium" runat="server" BackgroundCssClass="Modal"
        TargetControlID="hfCloseDMMedium" PopupControlID="pnlShowDirectMailMedium" OkControlID="hfCloseDMMedium"
        CancelControlID="hfCloseDMMedium" Drag="true" RepositionMode="None" /> 
```

这是我拥有gridview的实际用户控件。

```
<asp:Panel ID="pnlDirectMail" runat="server">
<asp:UpdatePanel ID="upDirectMail" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
<div class="ZipCodeGrid" id="divGrid">
                            <asp:GridView ID="gvZips" runat="server" AutoGenerateColumns="false" OnRowDataBound="gvZips_RowDataBound"
                                GridLines="None" Width="870px">
                                <Columns>
                                    <asp:TemplateField HeaderText="Zip">
                                        <ItemStyle HorizontalAlign="Center" />
                                        <ItemTemplate>
                                            <asp:HiddenField ID="hfSelectedId" runat="server" Value='<%# Bind("SelectedId") %>' />
                                            <asp:HiddenField ID="hfID" runat="server" Value='<%# Bind("ID") %>' />
                                            <asp:Label ID="lblZip" runat="server" Text='<%# Bind("Zip") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lblDescription" runat="server" Text="City" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtDescription" runat="server" Text='<%# Bind("Description") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lblSegmentDescHeader" runat="server" Text="Segment" Visible="false" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lblSegment" runat="server" Text='<%# Bind("SegmentDesc") %>' Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl1Acre50KHeader" runat="server" Text="1 Acre (50K)" Visible="false" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl1Acre50KQty" runat="server" Text='<%# Bind("One50K") %>' Width="50px"
                                                Visible="false" />
                                            <asp:CheckBox ID="chk1Acre50K" runat="server" Checked='<%# Bind("One50KSelected") %>'
                                                OnCheckedChanged="chk1Acre50K_CheckChanged" AutoPostBack="true" Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl1Acre50KPriceHeader" runat="server" Text="Cost" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl1Acre50KCost" runat="server" Text='<%# Bind("One50KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl1Acre100KHeader" runat="server" Text="1 Acre (100K)" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl1Acre100KQty" runat="server" Text='<%# Bind("One100K") %>' Width="50px"
                                                Visible="false" />
                                            <asp:CheckBox ID="chk1Acre100K" runat="server" Checked='<%# Bind("One100KSelected") %>'
                                                OnCheckedChanged="chk1Acre100K_CheckChanged" AutoPostBack="true" Visible="false" />
                                            <asp:HiddenField ID="hf1Acre100KCost" runat="server" Value='<%# Bind("One100KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl2Acre50KHeader" runat="server" Text="Prospect 2Acre+" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl2Acre50KQty" runat="server" Text='<%# Bind("Two50K") %>' Width="50px" />
                                            <asp:CheckBox ID="chk2Acre50K" runat="server" Checked='<%# Bind("Two50KSelected") %>'
                                                OnCheckedChanged="chk2Acre50K_CheckChanged" AutoPostBack="true" />
                                            <asp:HiddenField ID="hf2Acre50KPrice" runat="server" Value='<%# Bind("Two50KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl2Acre100KHeader" runat="server" Text="Prospect 3Acre+" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl2Acre100KQty" runat="server" Text='<%# Bind("Two100K") %>' Width="50px" />
                                            <asp:CheckBox ID="chk2Acre100K" runat="server" Checked='<%# Bind("Two100KSelected") %>'
                                                OnCheckedChanged="chk2Acre100K_CheckChanged" AutoPostBack="true" />
                                            <asp:HiddenField ID="hf2Acre100KPrice" runat="server" Value='<%# Bind("Two100KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl3Acre50KHeader" runat="server" Text="3 Acre (50K)" Visible="false" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl3Acre50KQty" runat="server" Text='<%# Bind("Three50K") %>' Visible="false"
                                                Width="50px" />
                                            <asp:CheckBox ID="chk3Acre50K" runat="server" Checked='<%# Bind("Three50KSelected") %>'
                                                OnCheckedChanged="chk3Acre50K_CheckChanged" AutoPostBack="true" Visible="false" />
                                            <asp:HiddenField ID="hf3Acre50KPrice" runat="server" Value='<%# Bind("Three50KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lbl3Acre100KHeader" runat="server" Text="3 Acre (100K)" Visible="false" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="lbl3Acre100KQty" runat="server" Text='<%# Bind("Three100K") %>' Width="50px"
                                                Visible="false" />
                                            <asp:CheckBox ID="chk3Acre100K" runat="server" Checked='<%# Bind("Three100KSelected") %>'
                                                OnCheckedChanged="chk3Acre100K_CheckChanged" AutoPostBack="true" Visible="false" />
                                            <asp:HiddenField ID="hf3Acre100KPrice" runat="server" Value='<%# Bind("Three100KCost", "{0:$###,###,##0.00}") %>' />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:LinkButton ID="lblOccupiedHousingUnit" runat="server" Text="Housing Unit" Visible="false"
                                                ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtOccupiedHousingUnit" runat="server" Text='<%# Bind("OccupiedHousingUnit") %>'
                                                Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:LinkButton ID="lblHouseholdIncome" runat="server" Text="Household Income" Visible="false"
                                                ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtHouseholdIncome" runat="server" Text='<%# Bind("HouseholdIncome", "{0:$###,###,##0.00}") %>'
                                                Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:LinkButton ID="lblDistancetoSite" runat="server" Text="Distance" Visible="false"
                                                ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtDistancetoSite" runat="server" Text='<%# Bind("DistancetoSite") %>'
                                                Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:LinkButton ID="lblAverageIncome" runat="server" Text="Home Value" Visible="false"
                                                ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtAverageIncome" runat="server" Text='<%# Bind("AverageIncome", "{0:$###,###,##0.00}") %>'
                                                Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lblRuralPct" runat="server" Text="% Rural" Visible="false" ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtRuralPct" runat="server" Text='<%# Bind("RuralPct") %>' Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lblLawnGarden" runat="server" Text="Lawn & Garden" Visible="false"
                                                ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtLawnGarden" runat="server" Text='<%# Bind("LawnGarden") %>' Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <HeaderStyle HorizontalAlign="Center" />
                                        <ItemStyle HorizontalAlign="Center" />
                                        <HeaderTemplate>
                                            <asp:Label ID="lblLawnGardenEquipment" runat="server" Text="Lawn & Garden Equipment"
                                                Visible="false" ForeColor="White" />
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:Label ID="txtLawnGardenEquipment" runat="server" Text='<%# Bind("LawnGardenEquipment") %>'
                                                Visible="false" />
                                        </ItemTemplate>
                                    </asp:TemplateField>
                                </Columns>
                                <HeaderStyle CssClass="HeaderFreez" />
                                <AlternatingRowStyle BackColor="#E4E4E4" />
                                <RowStyle BackColor="#F7F7F7" />
                            </asp:GridView>
                        </div>
</ContentTemplate>
</asp:UpdatePanel> 
```

有人可以告诉我该怎么做。仅供参考 - 脚本管理器位于母版页上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:29:55.497

你需要这样做，

完整细节：[在部分回发后保持更新面板内的滚动条位置](http://basgun.wordpress.com/2008/06/09/maintain-scroll-position-updatepanel-postback/)

您需要写下 javascript，它是图像的一部分，用于保持滚动位置

![在此处输入图像描述](../Images/b6a052d5ddf4d9b98bdc4f4004c0adfd.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:54:33.803

由于您的 gridview 位于用户控件内，这将是添加代码以保持滚动位置的适当位置。

值得一提的是，javascript 需要在 DOM 完全加载后执行，可以按如下方式执行：

1.  使用@Pranay Rana 的方法并将脚本放在`ScriptManager`控件之后
2.  添加对jQuery的引用并使用`$(document).ready()...`

这是一个如何完成此操作的简单示例，我相信您可以相应地修改它以适用于您的场景:-)

**ASPX：**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="UserControl1.ascx.cs"
    Inherits="WebApplication16.UserControl1" %>
<script src="Scripts/jquery-1.7.1.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var xPos, yPos;
        var prm = Sys.WebForms.PageRequestManager.getInstance();
        prm.add_beginRequest(BeginRequestHandler);
        prm.add_endRequest(EndRequestHandler);

        function BeginRequestHandler(sender, args) {
            xPos = $get('scrollDiv').scrollLeft;
            yPos = $get('scrollDiv').scrollTop;
        }

        function EndRequestHandler(sender, args) {
            $get('scrollDiv').scrollLeft = xPos;
            $get('scrollDiv').scrollTop = yPos;
        }
    });
</script>
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <div id="scrollDiv" style="overflow:auto;height: 100px;" />
        <asp:GridView ID="gvEmployees" runat="server" AutoGenerateColumns="false">
            <Columns>
                <asp:CommandField ShowSelectButton="true" />
                <asp:BoundField DataField="Name" />
            </Columns>
        </asp:GridView>
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

**后面的代码：**

```
public partial class UserControl1 : System.Web.UI.UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            gvEmployees.DataSource = new List<Employee>
            {
                new Employee{Name="Employee 1"},
                new Employee{Name="Employee 2"},
                new Employee{Name="Employee 3"},
                new Employee{Name="Employee 4"},
                new Employee{Name="Employee 5"},
                new Employee{Name="Employee 6"},
                new Employee{Name="Employee 7"},
            };
            gvEmployees.DataBind();
        }
    }
}

public class Employee
{
    public string Name { get; set; }
} 
```

# php - PHP代码未成功运行

> ID：14341007
> 
> 赞同：4
> 
> 时间：2013-01-15T15:28:00.833
> 
> 标签：php, html, mysql, if-statement, while-loop

我的问题很简单。我在这里编写的代码绝对不会在网页上产生任何输出。我整天都在做这件事，我敢肯定这是一件很简单的事情，我错过了一个白痴。所以我很吸引你善良的新鲜眼睛！如果有人能找出这不起作用的原因，我将不胜感激。

前提：

这是一个决策树在线调查，具有以下条件：如果用户已经开始调查，它将在数据库中找到他们，找到他们最后回答的问题并显示下一个。但如果他们还没有开始，它会显示第一个问题。

所有调查问题以及决策树逻辑都保存在数据库中（例如，如果用户为问题 1 选择选项 2，他们将被引导至问题 3，而不是问题 2）。

请假设目前，我直接从数据库中更新相关信息，而不是在网站上自动更新。

谢谢 ：）

**PHP：**

```
 <?php
//Find the latest question reached by the user for display on the page
$sql = mysql_query("SELECT QuestionNumberReached FROM User WHERE EmailAddress = '***'");
$sqlCount = mysql_num_rows($sql);
if ($sqlCount > 0) {
    while ($row = mysql_fetch_array($sql)) {
        $QuestionNumberReached = $row["QuestionNumberReached"];
    }
}
?>

<?php
//Find the last question answered by the user from the database
$StartedQuery = mysql_query("SELECT LastQuestionAnswered FROM User WHERE EmailAddress = '***'");
//Count the number of rows that the query produces
$StartedQueryCount = mysql_num_rows($StartedQuery);
//If data is found, whether it be a number or null, define the value
if ($StartedQueryCount > 0) {
    while ($row = mysql_fetch_array($sql)) {
        $LastQuestionAnswered = $row["LastQuestionAnswered"];
        //If the field has a value and is not null, find the next question from the database
        if (!empty($LastQuestionAnswered)) {
            //Find the User's ID and the ID of the last question answered
            $sqlA = mysql_query("SELECT PKID, LastQuestionAnswered FROM User WHERE EmailAddress = '***'");
            //If the operation produces an error, output an error message
            if (!$sqlA) {
                die('Invalid query for SQLA: ' . mysql_error());
            }
            //Count the number of rows output
            $sqlACount = mysql_num_rows($sqlA);
            //If rows exist, define the values
            if ($sqlACount > 0) {
                while ($row = mysql_fetch_array($sqlA)) {
                    $sqlAPKID = $row["PKID"];
                    $sqlALastQuestionAnswered = $row["LastQuestionAnswered"];
                }
            }
            //Find the answer given by the user to the last answered question
            $sqlB = mysql_query("SELECT Answer FROM Responses WHERE User = $sqlAPKID");
            //If the operation produces an error, output an error message
            if (!$sqlB) {
                die('Invalid query for SQLB: ' . mysql_error());
            }
            //Count the number of rows output
            $sqlBCount = mysql_num_rows($sqlB);
            //If rows exist, define the values
            if ($sqlBCount > 0) {
                while ($row = mysql_fetch_array($sqlB)) {
                    $sqlBAnswer = $row["Answer"];
                }
            }
            //Find the number of the next question to be answered based on the user's previous answer and the question they answered
            $sqlC = mysql_query("SELECT NextQuestion FROM Answers WHERE QuestionNumber = $sqlALastQuestionAnswered AND PKID = $sqlBAnswer");
            //If the operation produces an error, output an error message
            if (!$sqlC) {
                die('Invalid query for SQLC: ' . mysql_error());
            }
            //Count the number of rows output
            $sqlCCount = mysql_num_rows($sqlC);
            //If rows exist, define the values
            if ($sqlCCount > 0) {
                while ($row = mysql_fetch_array($sqlC)) {
                    $sqlCNextQuestion = $row["NextQuestion"];
                }
            }
            //Find the question text pertaining to the ID of the next question that needs to be answered
            $sqlD = mysql_query("SELECT QuestionText FROM Questions WHERE PKID = $sqlCNextQuestion");
            //If the operation produces an error, output an error message
            if (!$sqlD) {
                die('Invalid query for SQLD: ' . mysql_error());
            }
            //Count the number of rows output
            $sqlDCount = mysql_num_rows($sqlD);
            //If rows exist, define the values
            if ($sqlDCount > 0) {
                while ($row = mysql_fetch_array($sqlD)) {
                    $SurveyStartedQuestionText = $row["QuestionText"];
                }
            }
            //Set a string of information that will show the question number and question text as appropriate
            $ToDisplay = '' . $QuestionNumberReached . ': ' . $SurveyStartedQuestionText . '<br /><br />Answer Text Here';
        //If the value for QuestionNumberReached is null, the user has not started the survey
        } else if (empty($LastQuestionAnswered)) {
            //Find the question text of the first question in the survey
            $sql3 = mysql_query("SELECT QuestionText FROM Questions WHERE PKID IN (SELECT FirstQuestion FROM Batch WHERE BatchNumber IN (SELECT BatchNumber FROM User WHERE EmailAddress = '***'))");
            //Count the number of rows output
            $sql3Count = mysql_num_rows($sql3);
            //If rows exist, define the values
            if ($sql3Count > 0) {
                while ($row = mysql_fetch_array($sql3)) {
                    $SurveyNotStartedQuestionText = $row["QuestionText"];
                }
            }
            //Set a string of information that will show the question number and question text as appropriate
            $ToDisplay = '' . $QuestionNumberReached . ': ' . $SurveyNotStartedQuestionText . '<br /><br />Answer Text Here';
        }
    }
}
?> 
```

**HTML：**

```
<body>

<?php
// Display the concatenated information that has been previously defined
echo $ToDisplay;
?>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:44:21.040

这一点：

```
if ($StartedQueryCount > 0) { 
```

可能评估为假，并且没有匹配的 else 标记添加内容。尝试改变：

```
 }
?> 
```

和：

```
 }
    else {
        $ToDisplay = 'Error: no rows found to display!';
    }
?> 
```

编辑：

另外，这一点：

```
} else if (empty($LastQuestionAnswered)) { 
```

可以替换为更具可读性：

```
} else { 
```

因为它做的事情完全一样。在你的 while 循环中，你不断地重新定义 $ToDisplay，我认为这是想要的行为？否则在顶部初始化变量（在 while() 循环之前），如下所示：

```
$ToDisplay = ''; 
```

并将循环中的分配更改为串联，如下所示：

```
$ToDisplay = 'text assignment'; 
```

到：

```
$ToDisplay .= 'text concat'; // look at the dot before = 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:39:31.180

谢谢你的帮助！我真的很感谢大家抽出时间。

我终于意识到出了什么问题……

在我的 PHP 代码的第 18 行，我有以下内容：

```
while ($row = mysql_fetch_array($sql)) { 
```

而它当然应该是这样的：

```
while ($row = mysql_fetch_array($StartedQuery)) { 
```

本质上我是从错误的查询中调用行。我因此而感到凝块！

再次感谢大家：）

# ios - 带有 && 运算符的 if 语句检查第二个值？

> ID：14341008
> 
> 赞同：7
> 
> 时间：2013-01-15T15:28:02.707
> 
> 标签：ios, objective-c, if-statement, operators

如果第一个参数是/ `if-statement`，是否`&& operator`检查第二个参数？`false``NO`

以下会崩溃吗？

```
NSDictionary *someRemoteData = [rawJson valueForKey:@"data"];
if( [someRemoteData isKindOfClass:[NSDictionary class]] && someRemoteData.count > 0 ){
    //..do something
} 
```

请不要简单地回答是或否，但要解释原因。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-15T15:29:28.370

不，在得知答案将是 后，它不会评估表达式`NO`。这称为*短路*，它是在 C、C++、Objective C 和其他具有类似语法的语言中评估布尔表达式的重要部分。从左到右评估条件，使评估方案可预测。

同样的规则也适用于`||`操作符：一旦代码知道值为`YES`，评估就会停止。

短路使您可以防止在单个复合表达式中进行无效评估，而不是选择`if`语句。例如，

```
if (index >= 0 && index < Length && array[index] == 42) 
```

如果不是短路，将导致未定义的行为。但是由于评估跳过了`array[index]`何时`index`无效的评估，所以上面的表达式是合法的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T15:41:06.463

Objective-C 使用[惰性评估](http://en.wikipedia.org/wiki/Lazy_evaluation)，这意味着在您的情况下仅评估左操作数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:31:31.043

不，不是的。如果第一个语句失败，则永远不会检查第二个语句，例如，您可以这样做`(ArrayList != null && ArrayList.size() > 0)`，如果变量未初始化，您将永远不会收到错误。

# c# - ASP.NET MVC 应用程序不喜欢我的 for 循环

> ID：14341009
> 
> 赞同：1
> 
> 时间：2013-01-15T15:28:04.897
> 
> 标签：c#, asp.net-mvc

前几天我重写了我的 MVC 应用程序的一部分，现在我收到了一个 RuntimeBinderException 说明“无法对空引用执行运行时绑定”。

我在控制器中为 ViewBag 变量 AvailableDocuments 分配一个集合（字典）并在视图中迭代它。我可以很好地完成第一个循环，但是当代码到达第二个 for 循环**的退出点**时，它会抛出这个异常。我已经用几种不同的方式重写了它，并且总是遇到同样的问题。我可以摆脱这个异常的唯一方法是从此视图中删除第二个/第三个循环。另外，我已经使用调试器来验证我没有在集合中接收到任何空值，并且第一个循环没有（无缘无故地）对该集合执行更改。

```
@foreach (KeyValuePair<int, string> doc in ViewBag.AvailableDocuments)
{
    <option value="@doc.Key" @((ViewBag.Product.Documents[0].OriginalDocID == doc.Key) ? "selected" : "")>@doc.Value</option>
} 
```

这是重复三次的 for 循环（以填充三个下拉菜单）。唯一改变的是 Documents 的索引（不为空）。

`Line 62: <select name="Doc1" style="width:300px;">`
`Line 63: <option value="-1">Don't Display a Document</option>`
`Line 64: @foreach (KeyValuePair<int, string> doc in ViewBag.AvailableDocuments)`***<--换行***
`Line 65: {`
`Line 66: <option value="@doc.Key" @((ViewBag.Product.Documents[0].OriginalDocID == doc.Key) ? "selected" : "")>@doc.Value</option>`'

和消息：

`Exception Details: Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: Cannot perform runtime binding on a null reference`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:01:13.537

您是从数据库还是 Web 服务中读取 ViewBag.Product.Documents 中的数据？如果是这样，我猜您遇到了延迟加载的问题（直到需要数据才被请求）。发生异常是因为在请求数据时，源不再可用。

在您后面的代码中，在分配上添加一个 ToList() 并查看是否可以解决问题。：

```
ViewBag.Product.Documents = something.GetProductDocuments.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:12:00.443

如果您使用所需数据创建 pocos 集合会发生什么，可能就像这样简单

```
public class OptionItem
{
   public int Id {get; set;}
   public string Text {get; set;}
} 
```

并将其添加到视图模型上的集合并将其传递给视图？这样您就知道所有数据在您查看视图之前都是他们的。我个人会避免将 viewbag 用于这样的事情。

# javascript - Highcharts - 在 x 轴上绘制年份

> ID：14341010
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:28:04.833
> 
> 标签：javascript, highcharts

每当新的一年开始时，我需要在 x 轴上绘制一条线。我一直在尝试修改此代码，但如果不对 plotLines 上的值进行“硬编码”，我就找不到解决方案。谢谢您的帮助。

```
 xAxis: {
        plotLines: [{ 
            color: 'red',
            width: 2,
            value: Date.UTC(2010, 0, 1), 
            dashStyle: 'longdashdot'
        }],
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:30:09.947

只需遍历您的图表数据即可创建所需的年份选项数组！

# wix - 包含文件中的窗口高度和宽度

> ID：14341020
> 
> 赞同：0
> 
> 时间：2013-01-15T15:28:53.167
> 
> 标签：wix, wix3.5

我有一个通用的 wxi 文件，我在其中保存所有 wxs 文件中的所有公共数据。

我也想保留安装 UI 窗口的宽度和高度。

当我尝试这样做时，它给了我一个不是整数类型的错误。

可以以某种方式完成吗？

# java - MiniMRYarnCluster，本地运行 MR

> ID：14341021
> 
> 赞同：0
> 
> 时间：2013-01-15T15:28:57.330
> 
> 标签：java, hadoop, mapreduce, cloudera

我正在尝试使用 MiniMRYarnCluster 在本地运行 MR 作业。 **我正在使用旧的 mapreduce（不是 YARN）和 mapreduce API v2** 这些东西可以在这里找到：

```
<dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
            <version>2.0.0-cdh4.1.1</version>
            <type>test-jar</type>
            <scope>test</scope>
        </dependency> 
```

这是日志的一部分：

```
--127.0.1.1-58175-1358256748215, blockid: BP-1072059606-127.0.1.1-1358256746988:blk_6137856716359201843_1008, duration: 229871
13/01/15 17:32:34 INFO localizer.LocalizedResource: Resource hdfs://localhost:50123/apps_staging_dir/ssa/.staging/job_1358256748507_0001/job.xml transitioned from DOWNLOADING to LOCALIZED
13/01/15 17:32:34 INFO container.Container: Container container_1358256748507_0001_01_000001 transitioned from LOCALIZING to LOCALIZED
13/01/15 17:32:34 INFO container.Container: Container container_1358256748507_0001_01_000001 transitioned from LOCALIZED to RUNNING
13/01/15 17:32:34 INFO nodemanager.DefaultContainerExecutor: launchContainer: [bash, /home/ssa/devel/POIClusterMapreduceTest/ru.mrjob.poi.POIClusterMapreduceTest-localDir-nm-0_1/usercache/ssa/appcache/application_1358256748507_0001/container_1358256748507_0001_01_000001/default_container_executor.sh]
13/01/15 17:32:34 WARN nodemanager.DefaultContainerExecutor: Exit code from task is : 1
13/01/15 17:32:34 INFO nodemanager.ContainerExecutor: 
13/01/15 17:32:34 WARN launcher.ContainerLaunch: Container exited with a non-zero exit code 1 
```

这是一个例外：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/hadoop/yarn/service/CompositeService
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.yarn.service.CompositeService
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    ... 12 more
Could not find the main class: org.apache.hadoop.mapreduce.v2.app.MRAppMaster.  Program will exit. 
```

我使用 org.apache.hadoop.mapreduce.v2.TestMRJobs 作为我自己测试的基础。有没有人遇到过这个问题？

这是我的代码，它是一个抽象基类，用于在 CI 服务器或开发人员机器上本地测试 MR 作业：

```
public abstract class AbstractClusterMapReduceTest {

    private static final Log LOG = LogFactory.getLog(AbstractClusterMapReduceTest.class);

    public static final String DEFAULT_LOG_CATALOG = "local-mr-logs";

    private static final int DEFAULT_NAMENODE_PORT = 50123;
    private static final int ONE_DATANODE = 1;

    private static final int DEFAULT_REDUCE_NUM_TASKS = 1;
    private static final String SLASH = "/";
    private static final String DEFAULT_MR_INPUT_DATA_FILE = "mr-input-data-file";

    private MiniMRYarnCluster mrCluster;
    private MiniDFSCluster dfsCluster;

    /** Shitty code from base Cloudera example*/
    private static Path TEST_ROOT_DIR = new Path("target",
            AbstractClusterMapReduceTest.class.getName() + "-tmpDir").makeQualified(getLocalFileSystem());
    static Path APP_JAR = new Path(TEST_ROOT_DIR, "MRAppJar.jar");

    private static FileSystem getLocalFileSystem(){
        try {
            return FileSystem.getLocal(new Configuration());
        } catch (IOException e) {
            throw new Error("Can't access local file system. MR cluster can't be started", e);
        }
    }

    /**
     * Always provide path to log catalog.
     * Default is: ${project.build.directory}/{@link AbstractClusterMapReduceTest#DEFAULT_LOG_CATALOG}
     * */
    protected String getPathToLogCatalog(){
        return getPathToOutputDirectory()+ SLASH + DEFAULT_LOG_CATALOG;
    }

    private String getPathToOutputDirectory(){
        return System.getProperty("project.build.directory");
    }

    private void checkAppJar(){
        if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
            throw new Error("MRAppJar " + MiniMRYarnCluster.APPJAR+ " not found. Not running test.");
        }else{
            LOG.info(MiniMRYarnCluster.APPJAR + " is at the right place. Can continue to setup Env...");
        }
    }

    public void setupEnv() throws IOException{
        checkAppJar();

        System.setProperty("hadoop.log.dir", getPathToLogCatalog());
        System.setProperty("javax.xml.parsers.SAXParserFactory",
                "com.sun.org.apache.xerces.internal.jaxp.SAXParserFactoryImpl");

        dfsCluster = buildMiniDFSCluster();
        //dfsCluster.getFileSystem().makeQualified(createPath(getHDFSPathToInputData()));
        //dfsCluster.getFileSystem().makeQualified(createPath(getOutputPath()));

        mrCluster = new MiniMRYarnCluster(this.getClass().getName(), 1);
        Configuration conf = new Configuration();
        conf.set("fs.defaultFS", getFileSystem().getUri().toString());   // use HDFS
        //conf.set(MRJobConfig.MR_AM_STAGING_DIR, getPathToOutputDirectory()+"/tmp-mapreduce");
        conf.set(MRJobConfig.MR_AM_STAGING_DIR, "/apps_staging_dir");
        mrCluster.init(conf);
        mrCluster.start();

        //Cloudera tricks :)
        // Copy MRAppJar and make it private. TODO: FIXME. This is a hack to
        // workaround the absent public discache.
        getLocalFileSystem().copyFromLocalFile(new Path(MiniMRYarnCluster.APPJAR), APP_JAR);
        getLocalFileSystem().setPermission(APP_JAR, new FsPermission("700"));
    }

    public void tearDown() {
        if (mrCluster != null) {
            mrCluster.stop();
            mrCluster = null;
        }
        if (dfsCluster != null) {
            dfsCluster.shutdown();
            dfsCluster = null;
        }
    }

    public boolean createAndSubmitJob() throws IOException, ClassNotFoundException, InterruptedException{
        LOG.info("createAndSubmitJob: enter");
        checkAppJar();
        LOG.info("MRAppJar has been found. Can start to create Job");

        Configuration configuration = mrCluster.getConfig();
        configuration.set(MRConfig.MASTER_ADDRESS, "local");

        Job job = Job.getInstance(configuration);
        job.setJobName(this.getClass().getSimpleName()+"-job");
        job.addFileToClassPath(APP_JAR); // The AppMaster jar itself.

        job.setJarByClass(getMRJobClass());
        job.setJobName(getMRJobClass().getSimpleName());

        job.setNumReduceTasks(getReduceNumTasks());

        job.setOutputKeyClass(getOutputKeyClass());
        job.setOutputValueClass(getOutputValueClass());

        job.setMapperClass(getMapperClass());
        job.setReducerClass(getReducerClass());

        job.setInputFormatClass(getInputFormat());
        job.setOutputFormatClass(getOutputFormat());

        FileInputFormat.setInputPaths(job, getHDFSPathToInputData());
        FileOutputFormat.setOutputPath(job, createPath(getOutputPath()));

        job.setSpeculativeExecution(false);
        job.setMaxMapAttempts(1); // speed up failures

        LOG.info("Submitting job...");
        job.submit();
        LOG.info("Job has been submitted.");

        String trackingUrl = job.getTrackingURL();
        String jobId = job.getJobID().toString();
        LOG.info("trackingUrl:" +trackingUrl);
        LOG.info("jobId:" +jobId);

       return job.waitForCompletion(true);
    }

    protected FileSystem getFileSystem() throws IOException {
        return dfsCluster.getFileSystem();
    }

    protected int getReduceNumTasks(){
        return DEFAULT_REDUCE_NUM_TASKS;
    }

    /**
     * @return InputStream instance to file you want to run with your MR job
     * */
    protected InputStream getInputStreamForInputData() {
        return this.getClass().getClassLoader().getResourceAsStream(this.getClass().getSimpleName()+"/"+getInputDatasetName());
        //return getPathToOutputDirectory()+ SLASH + DEFAULT_INPUT_CATALOG+"/mr-input-data";
    }

    protected String getHDFSPathToInputData() throws IOException{
        InputStream inputStream = getInputStreamForInputData();
        Path hdfsInputPath = new Path(DEFAULT_MR_INPUT_DATA_FILE);
        FSDataOutputStream fsDataOutputStream = getFileSystem().create(hdfsInputPath);
        copyStream(inputStream, fsDataOutputStream);
        fsDataOutputStream.close();
        inputStream.close();

        return hdfsInputPath.toString();
    }

    private void copyStream(InputStream input, OutputStream output) throws IOException {
        byte[] buffer = new byte[1024]; // Adjust if you want
        int bytesRead;
        while ((bytesRead = input.read(buffer)) != -1)
        {
            output.write(buffer, 0, bytesRead);
        }
    }

    /**
     * Dataset should be placed in resources/ConcreteClusterMapReduceTest
     * @return a name of a file from catalog.
     * */
    protected abstract String getInputDatasetName();

    /**
     * @return path reducer output
     * default is: @{link AbstractClusterMapReduceTest#DEFAULT_OUTPUT_CATALOG}
     * */
    protected String getOutputPath(){
        return "mr-data-output";
    }

    /**
     * Creates @{link Path} using absolute path to some FS resource
     * @return new Path instance.
     * */
    protected Path createPath(String pathToFSResource){
        return new Path(pathToFSResource);
    }

    /**
     * Builds new instance of MiniDFSCluster
     * Default: @{link DEFAULT_NAMENODE_PORT}, @{link DEFAULT_NAMENODE_PORT}
     * @return MiniDFSCluster instance.
     * */
    protected MiniDFSCluster buildMiniDFSCluster() throws IOException {
        return new MiniDFSCluster.Builder(new Configuration())
                    .nameNodePort(DEFAULT_NAMENODE_PORT)
                    .numDataNodes(ONE_DATANODE)
                    .build();
    }

    protected abstract Class<? extends Configured> getMRJobClass();
    protected abstract Class<? extends Mapper> getMapperClass();
    protected abstract Class<? extends Reducer> getReducerClass();
    protected abstract Class<? extends InputFormat> getInputFormat();
    protected abstract Class<? extends OutputFormat> getOutputFormat();
    protected abstract Class<?> getOutputKeyClass();
    protected abstract Class<?> getOutputValueClass();

} 
```

具体的测试子类：

```
public class POIClusterMapreduceTest extends AbstractClusterMapReduceTest{

    private static final String INTEGRATION = "integration";

    @BeforeClass(groups = INTEGRATION)
    public void setup() throws IOException {
        super.setupEnv();
    }

    //@Test(groups = INTEGRATION)
    public void runJob() throws InterruptedException, IOException, ClassNotFoundException {
        boolean result = createAndSubmitJob();
        MatcherAssert.assertThat(result, Matchers.is(true));

        String outputResultAsString = getFileSystem().open(createPath(getOutputPath())).readUTF();
        MatcherAssert.assertThat(outputResultAsString.length(), Matchers.greaterThan(0));

    }

    @AfterClass(groups = INTEGRATION)
    public void tearDown(){
        super.tearDown();
    }

    @Override
    protected Class<Main> getMRJobClass() {
        return Main.class;
    }

    @Override
    protected Class<POIMapper> getMapperClass() {
        return POIMapper.class;
    }

    @Override
    protected  Class<Reducer> getReducerClass() {
        return Reducer.class;
    }

    @Override
    protected Class<TextInputFormat> getInputFormat() {
        return TextInputFormat.class;
    }

    @Override
    protected Class<TextOutputFormat> getOutputFormat() {
        return TextOutputFormat.class;
    }

    @Override
    protected Class<LongWritable> getOutputKeyClass() {
        return LongWritable.class;
    }

    @Override
    protected Class<XVLRDataWritable> getOutputValueClass() {
        return XVLRDataWritable.class;
    }

    @Override
    protected String getInputDatasetName() {
        return "mr-input-data";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:24:05.573

问题在于可怕的专家冲突。以下是正确的 Maven 依赖项：

```
<dependencies>
        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-core</artifactId>
            <version>${hadoop.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-common</artifactId>
            <version>${hadoop.common.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-hdfs</artifactId>
            <version>${hadoop.common.version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-hdfs</artifactId>
            <classifier>tests</classifier>
            <version>${hadoop.common.version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-test</artifactId>
            <version>${hadoop.version}</version>
        </dependency>
    </dependencies> 
```

和：

```
<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <hadoop.version>2.0.0-mr1-cdh4.1.1</hadoop.version>
    <hadoop.common.version>2.0.0-cdh4.1.1</hadoop.common.version>
</properties> 
```

这是用于测试的基类：

```
public abstract class AbstractClusterMRTest {
    private static final Log LOG = LogFactory.getLog(AbstractClusterMRTest.class);

    public static final String DEFAULT_LOG_CATALOG = "local-mr-logs";
    public static final String SLASH = "/";
    public static final String MR_DATA_OUTPUT = "mr-data-output";
    public static final String DEFAULT_OUTPUT_FILE_NAME =  "part-r-00000";

    private static final int DEFAULT_REDUCE_NUM_TASKS = 1;

    private Configuration configuration;
    private FileSystem localFileSystem;
    private MiniMRCluster mrCluster;
    private JobConf mrClusterConf;

    /**
     * Always provide path to log catalog.
     * */
    protected String getPathToLogCatalog(){
        File logCatalog = new File(getPathToOutputDirectory()+ SLASH + DEFAULT_LOG_CATALOG);
        if(!logCatalog.exists()){
            logCatalog.mkdir();
        }
        LOG.info("Path to log catalog is: "+logCatalog.getAbsolutePath());
        return logCatalog.getAbsolutePath();
    }

    private String getPathToOutputDirectory(){
        return System.getProperty("project.build.directory");
    }

    public void setup() throws IOException{
        System.setProperty("hadoop.log.dir", getPathToLogCatalog());

        configuration = new Configuration(true);
        localFileSystem = FileSystem.get(configuration);
        mrCluster = new MiniMRCluster(1, localFileSystem.getUri().toString(), 1, null, null, new JobConf(configuration));
        mrClusterConf = mrCluster.createJobConf();
    }

    public void tearDown() {
        if (mrCluster != null) {
            mrCluster.shutdown();
            mrCluster = null;
        }
    }

    /**
     * Use this method to get JobBuilder configured for testing purposes.
     * @return JobBuilder instance ready for further configuration.
     * */
    public JobBuilder createTestableJobInstance() throws IOException{
        return new JobBuilder(mrClusterConf, this.getClass().getSimpleName()+"-mrjob")
                .withNumReduceTasks(DEFAULT_REDUCE_NUM_TASKS);
    }

    /**
     * Pass configured JobBuilder and wait for completion
     * @param jobBuilder is a JobBuilder ready to submit
     * @return job completion result.
     * */
    public boolean buildSubmitAndWaitForCompletion(JobBuilder jobBuilder)
                        throws InterruptedException, IOException, ClassNotFoundException {
        String pathToInputFile = getPathToInputData();
        checkThatFileExists(pathToInputFile);

        Job job = jobBuilder.build();
        FileInputFormat.setInputPaths(job, pathToInputFile);
        FileOutputFormat.setOutputPath(job, createPath(getOutputPath()));

        LOG.info("Submitting job...");
        job.submit();
        LOG.info("Job has been submitted.");

        String trackingUrl = job.getTrackingURL();
        String jobId = job.getJobID().toString();
        LOG.info("trackingUrl:" +trackingUrl);
        LOG.info("jobId:" +jobId);

        return job.waitForCompletion(true);
    }

    /**
     * By declaration input data should be stored in test/resources folder:
     * ConcreteTestClassName/in/getInputDatasetName()
     * Don't forget to override @link{AbstractClusterMRTest#getInputDatasetName()}
     * @return path to input data
     * */
    protected String getPathToInputData(){
        String pathFile = this.getClass().getSimpleName() + SLASH + "in" + SLASH+ getInputDatasetName();
        LOG.info("Path for getting URL to file:" + pathFile);
        URL urlToFile = this.getClass().getClassLoader().getResource(pathFile);

        File file = FileUtils.toFile(urlToFile);
        return file.getAbsolutePath();
    }

    /**
     * Dataset should be placed in resources/ConcreteClusterMapReduceTest
     * @return a name of a file from catalog.
     * */
    protected abstract String getInputDatasetName();

    /**
     * @return path reducer output
     * default is: @{link AbstractClusterMapReduceTestOld#DEFAULT_OUTPUT_CATALOG}
     * */
    protected String getOutputPath(){
        return getPathToOutputDirectory()+ SLASH + MR_DATA_OUTPUT;
    }

    /**
     * @return text lines from reducer output file.
     * */
    protected List<String> getLinesFromOutputFile() throws IOException{
        String pathToResult = getOutputPath()+SLASH+DEFAULT_OUTPUT_FILE_NAME;
        File resultFile = new File(pathToResult);
        return FileUtils.readLines(resultFile);
    }

    public abstract String getEtalonOutputFileName();

    protected List<String> getLinesFromEtalonOutputFile() throws IOException{
        String pathFile = this.getClass().getSimpleName() + SLASH + "out" + SLASH+ getEtalonOutputFileName();
        LOG.debug("path to etalon file: "+ pathFile);
        URL urlToFile = this.getClass().getClassLoader().getResource(pathFile);

        File file = FileUtils.toFile(urlToFile);
        return FileUtils.readLines(file);

    }

    /**
     * Creates @{link Path} using absolute path to some FS resource
     * @return new Path instance.
     * */
    protected Path createPath(String pathToFSResource){
        return new Path(pathToFSResource);
    }

    public void checkThatFileExists(String absolutePathToFile){
        if(! new File(absolutePathToFile).exists()){
            throw new Error("Path to input file is incorrect. Can't run MR job. Incorrect path is:"+absolutePathToFile);
        }
    }

} 
```

只需扩展，创建您自己的具体测试类。从 createTestableJobInstance 获取作业（作业有简单的构建器包装器）。配置它并调用 buildSubmitAndWaitForCompletion

# asynchronous - SSIS异步组件源码？

> ID：14341022
> 
> 赞同：0
> 
> 时间：2013-01-15T15:28:57.857
> 
> 标签：asynchronous, ssis, components, union

我正在构建一个自定义 SSIS 数据流组件，作为其过程的一部分，它接受多个输入并将它们滚动到单个输出中（沿着 UNION ALL 组件的功能）。我在实现运行时方法时遇到了一些麻烦，并且一直在寻找使用多个输入的异步转换的源代码，这些输入可以用作我自己的代码的模型。

有谁知道可用的源代码或有自己的代码愿意与我分享以帮助我走上正轨？非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:43:22.390

在我的脑海中，我会查看 MS 的 IS 团队的[Programming Samples](http://msftisprodsamples.codeplex.com/)以及[Community Transform](http://ssisctc.codeplex.com/)。其中一些是开源的，所以如果你能找到一个异步的，你应该能够看到你缺少什么。

我记得一半的逻辑是，您需要查看给定[IDTSComponentMetaData100的所有](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.pipeline.wrapper.idtscomponentmetadata100.aspx)[InputCollection](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.pipeline.wrapper.idtscomponentmetadata100.inputcollection.aspx)，然后使用该数据。

# php - 相当于 DBL_MAX 的 PHP 常量

> ID：14341035
> 
> 赞同：1
> 
> 时间：2013-01-15T15:29:39.717
> 
> 标签：php

是否有任何与 Objective C 等效的 PHP 常量`DBL_MAX`？换句话说，用可能的最高双数定义的常数？

我知道 PHP 常量`PHP_INT_MAX`，但这真的是 PHP 中可能的最高数字吗？

# perl - IO::Prompter - 是否可以禁用历史记录？

> ID：14341038
> 
> 赞同：3
> 
> 时间：2013-01-15T15:29:49.977
> 
> 标签：perl, input, history

是否有可能 - 在提示输入密码时 -`prompt`从[IO::Prompter](http://search.cpan.org/perldoc?IO%3A%3APrompter)以不将输入添加到历史记录的方式进行配置？

```
#!/usr/local/bin/perl
use warnings;
use strict;
use 5.10.1;
use utf8;
use open qw( :encoding(UTF-8) :std );
use IO::Prompter;

my $password = prompt( 'Password: ', -echo => '' );
say $password;
$password = prompt( 'Password: ', -echo => '' );
say $password;
$password = prompt( 'Password: ', -echo => '' );
say $password;
$password = prompt( 'Password: ', -echo => '' );
say $password;
$password = prompt( 'Password: ', -echo => '' );
say $password; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:02:12.747

如果您愿意使用其他模块，我建议您使用[Term::ReadKey](https://metacpan.org/module/Term%3a%3aReadKey)

这是我编写的示例脚本，它将禁用回显以进行读取，读取一行并返回它接收到的内容以用于测试目的。

```
#!/usr/bin/perl

use strict;
use warnings;
use Term::ReadKey;

ReadMode 2;
my $pw;
print "Enter password ";
while ( not defined( $pw ) ) {
  $pw = ReadLine(-1); 
}
chomp $pw;
print "\nI got $pw entered\n";
ReadMode 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T20:10:41.070

当您编写问题时这是不可能的，但是 IO::Prompter 已被修补以包含`NONE`禁用历史记录的特殊历史记录集。

带有补丁的 IO::Prompter 的第一个版本是 0.004003。

[http://search.cpan.org/~dconway/IO-Prompter-0.004003/lib/IO/Prompter.pm](http://search.cpan.org/~dconway/IO-Prompter-0.004003/lib/IO/Prompter.pm)

```
my $password = prompt('Password: ', -hNONE, -echo => '');

my $force_the_user_to_type = prompt('Type something: ', -hNONE); 
```

# jquery - 使用 jquery 检查按钮单击时某些特定输入是否为空

> ID：14341039
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:29:54.563
> 
> 标签：jquery, validation, if-statement, for-loop

我有一个按钮和一些输入，我想让 jquery 在执行某些操作之前检查我是否没有输入为空：所以这就是我所做的：

```
$('#my_button)').click(function() {
if(
for(i=0;i<$('#my _button').parent().prev().children().children().length;i++){){ //this is to check if the inputs exist
$('#my_button').parent().prev().children().children().eq(i).val()!==''; // i've tried .val().is(:empty); but not working too
//so the test fails for somehow ! and the if condition doesn't work
// google chrome developers inspector gives me this error (Uncaught SyntaxError: Unexpected token for)
}
){
//do some action
}} 
```

这是我的[jsfiddl 测试](http://jsfiddle.net/zFLqn/)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:40:53.240

```
<table>
 <tr>
  <td>
   <div><input id='i1'></div>
   <div><input id='i2'></div>  
  </td>
  <td><button id='my_button'>click me</button></td>
 </tr>
</table> 
```

脚本：

```
 $('#my_button').on('click', function() {
        var in1 = $('#i1').val();
        var in2 = $('#i2').val();

        if(in1 != '' && in2 != ''){
               // do something
            }
            else{
              //alert

            }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:43:19.397

它会在 上为您提供意外令牌警告，`for`因为*它是*意外令牌。您不能`for`在 if 语句的布尔表达式中放置循环。

您将需要执行类似于此伪代码的操作：

```
$('#my_button').click(function() {
  succeed = true;
  for all of my inputs {
    if(input is empty){
       succeed = false;
    }
  }
  if(succeed) //do stuff
} 
```

# android - 如何获得真实的屏幕高度和宽度？

> ID：14341041
> 
> 赞同：46
> 
> 时间：2013-01-15T15:29:57.400
> 
> 标签：android

```
DisplayMetrics metrics = new DisplayMetrics();
this.getWindowManager().getDefaultDisplay().getMetrics(metrics);
screenWidth = metrics.widthPixels;
screenHeight = metrics.heightPixels; 
```

我使用这些代码来获取屏幕的高度和宽度

我的 Nexus7 的屏幕高度应该是 1280

但它返回 1205 ......

我的 minSdkVersion 是 8 级

所以我不能使用这些方法：

```
Display display = getWindowManager().getDefaultDisplay();
Point size = new Point();
display.getSize(size);
int screen_width = size.x;
int screen_height = size.y; 
```

现在，我应该如何获得正确的屏幕尺寸？

编辑：

```
if (Build.VERSION.SDK_INT >= 11) {
        Point size = new Point();
        try {
            this.getWindowManager().getDefaultDisplay().getRealSize(size);
            screenWidth = size.x;
            screenHeight = size.y;
        } catch (NoSuchMethodError e) {
            Log.i("error", "it can't work");
        }

    } else {
        DisplayMetrics metrics = new DisplayMetrics();
        this.getWindowManager().getDefaultDisplay().getMetrics(metrics);
        screenWidth = metrics.widthPixels;
        screenHeight = metrics.heightPixels;
    } 
```

使用它有效！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-05-26T00:46:39.010

我编写了一个方法，该方法将尽可能接近 API 10 到 17+。它应该为 API 14+ 提供真实的宽度和高度，并且它对其他所有东西都做得很好。

```
 Display display = context.getWindowManager().getDefaultDisplay();
    int realWidth;
    int realHeight;

    if (Build.VERSION.SDK_INT >= 17){
        //new pleasant way to get real metrics
        DisplayMetrics realMetrics = new DisplayMetrics();
        display.getRealMetrics(realMetrics);
        realWidth = realMetrics.widthPixels;
        realHeight = realMetrics.heightPixels;

    } else if (Build.VERSION.SDK_INT >= 14) {
        //reflection for this weird in-between time
        try {
            Method mGetRawH = Display.class.getMethod("getRawHeight");
            Method mGetRawW = Display.class.getMethod("getRawWidth");
            realWidth = (Integer) mGetRawW.invoke(display);
            realHeight = (Integer) mGetRawH.invoke(display);
        } catch (Exception e) {
            //this may not be 100% accurate, but it's all we've got
            realWidth = display.getWidth();
            realHeight = display.getHeight();
            Log.e("Display Info", "Couldn't use reflection to get the real display metrics.");
        }

    } else {
        //This should be close, as lower API devices should not have window navigation bars
        realWidth = display.getWidth();
        realHeight = display.getHeight();
    } 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-01-15T16:34:07.853

我认为这会奏效。诀窍是你必须使用：

```
display.getRealSize(size); 
```

不是

```
display.getSize(size); 
```

要处理您的 API 8 编码问题，请执行以下操作：

```
try { 
    display.getRealSize(size);
    height = size.y; 
} catch (NoSuchMethodError e) {
    height = display.getHeight();
} 
```

只有更新的 API 设备才会有屏幕导航按钮，因此需要新方法，旧设备会抛出异常但不会有屏幕导航，因此旧方法很好。

如果需要说明：仅仅因为您的项目的最低 API 级别为 8 并不意味着您必须在该级别编译它。我也至少使用 8 级，但我的项目大部分是在 13 级（3.2）编译的，让他们可以访问很多新方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-11-07T10:18:03.657

您可以使用 using`Display`或`DisplayMetrics`

**使用显示：**

```
private void findRealSize(Activity activity)
{
    Point size = new Point();
    Display display = activity.getWindowManager().getDefaultDisplay();

    if (Build.VERSION.SDK_INT >= 17)
        display.getRealSize(size);
    else
        display.getSize(size);

    int realWidth = size.x;
    int realHeight = size.y;

    Log.i("LOG_TAG", "realWidth: " + realWidth + " realHeight: " + realHeight);
} 
```

**使用 DisplayMetrics：**

```
private void findRealSize(Activity activity)
{
    DisplayMetrics displayMetrics = new DisplayMetrics();

    if (Build.VERSION.SDK_INT >= 17)
    {
        activity.getWindowManager().getDefaultDisplay().getRealMetrics(displayMetrics);
    }
    else
    {
        activity.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
    }

    int realWidth = displayMetrics.widthPixels;
    int realHeight = displayMetrics.heightPixels;

    Log.i("LOG_TAG", "realWidth: " + realWidth + " realHeight: " + realHeight);
} 
```

# android - 哪个更好：@SuppressLint 或 @TargetApi？

> ID：14341042
> 
> 赞同：100
> 
> 时间：2013-01-15T15:29:57.997
> 
> 标签：android, eclipse, lint

我的应用程序中有关于`StrictMode`并添加了基本上禁用`StrictModeHelper`. 但是，Lint 现在抱怨`setThreadPolicy()`并建议添加

```
@SuppressLint 'NewApi' 
```

或者

```
@TargetApi(Build.VERSION_CODES.GINGERBREAD) 
```

到`onCreate()`视图的事件。

哪种方法是首选..或者他们基本上是在做同样的事情？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-01-15T16:30:23.517

> 我的应用程序中有关于 StrictMode 的问题，并添加了基本上禁用 StrictModeHelper 的代码片段

请修复网络错误。

> 哪种方法是首选..或者他们基本上是在做同样的事情？

`@TargetApi`并`@SuppressLint`具有相同的核心效果：它们抑制了 Lint 错误。

不同之处在于`@TargetApi`，您可以通过参数声明您在代码中处理的 API 级别，这样如果您稍后修改方法以尝试引用比`@TargetApi`.

例如，假设您没有阻止`StrictMode`有关您的网络错误的投诉，而是尝试解决`AsyncTask`在较新版本的 Android 上被序列化的问题。您的代码中有这样的方法可以选择进入较新设备上的线程池并在旧设备上使用默认多线程行为：

```
 @TargetApi(11)
  static public <T> void executeAsyncTask(AsyncTask<T, ?, ?> task,
                                          T... params) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
      task.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, params);
    }
    else {
      task.execute(params);
    }
  } 
```

拥有`@TargetApi(11)`意味着如果 Lint 检测到我使用的东西比我的 更新`android:minSdkVersion`，但达到 API 级别 11，Lint 不会抱怨。在这种情况下，这是可行的。但是，如果我修改此方法以引用在 API 级别 14 之前未添加的内容，则 Lint 错误将再次出现，因为我的`@TargetApi(11)`注释说我只修复了代码以在 API 级别 11 及更高级别~~上~~工作，而不是API 级别 14 及~~以下~~。

使用，无论我的代码引用什么以及我的代码设置为处理什么`@SuppressLint('NewApi')`，我都会丢失*任何API 级别的 Lint 错误。*

因此，`@TargetApi`首选注释，因为它允许您以更细粒度的方式告诉构建工具“好的，我修复了此类问题”。

# javascript - 有选择地改变一个类的href

> ID：14341046
> 
> 赞同：1
> 
> 时间：2013-01-15T15:30:08.277
> 
> 标签：javascript, jquery

我正在研究一个下拉菜单，并希望有选择地更改某些元素的 href 属性。菜单由两个类组成，菜单项和子菜单项。每个菜单项都有一个相应的子菜单，但有些子菜单包含空列表。对于具有空子菜单列表的菜单项，我希望 href 为“#”。

```
<div id="info" class="menuitem"><a href="http://www.asmithspace.net">Info</a><!--start menuitem-->
<div id="infosubmenu" class="submenu"><!--start submenu-->
<ul>
<li><a href="#">Item1</a></li>
<li><a href="#">Item2</a></li>
<li><a href="#">Item3</a></li>
</ul>
</div><!--end submenu-->
</div><!--end menuitem-->
<div id="business" class="menuitem"><a href="http://www.asmithspace.net">Business</a><!--start menuitem-->
<div id="businesssubmenu" class="submenu"><!--start submenu-->
<ul>
<li><a href="#">Item1</a></li>
<li><a href="#">Item2</a></li>
</ul>
</div><!--end submenu-->
</div><!--end menuitem-->
<div id="jobs" class="menuitem"><a href="http://www.asmithspace.net">Jobs</a><!--start menuitem-->
<div id="jobssubmenu" class="submenu">
<ul>
</ul>
</div><!--end submenu-->
</div><!--end menuitem--> 
```

我已经使用 $.each 循环和常规 javascript 尝试了此代码的不同变体，但我所做的一切要么将所有 menuitem href 更改为“#”，要么不更改其中任何一个。

```
if (!$('.menuitem').children('.submenu').children('ul').children('li').length > 0) {
$('.menuitem').children('a').attr('href', '#'); } 
```

如果有人能告诉我我做错了什么，我会非常感激！我的测试页可以在[这里](http://www.asmithspace.net/testing/temptest.html)找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:05:25.557

```
$(".menuitem > a").each(function () {
  if ($(this).next('.submenu').find('li').length > 0)
    $(this).attr("href","#");
}); 
```

[***演示***](http://jsfiddle.net/TshLC/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:06:19.613

我想这就是你要找的：

```
$('.menuitem')
  .children('.submenu')
  .each(function(index) {
    if($(this).children('ul').children('li').length === 0) {
      $(this).closest('.menuitem').children('a').attr('href', '#');
    }
  }); 
```

对于每个子菜单，它都会检查数组的长度`ul > li`，如果它是 0，我会更改最近的父菜单项中链接的 href。

# r - R中的空xts对象看起来有问题

> ID：14341051
> 
> 赞同：2
> 
> 时间：2013-01-15T15:30:22.410
> 
> 标签：r, xts

正如您在下面看到的，a 是一个空的“xts”对象。不知何故，当用日期索引时，它会以字符串形式返回暗名......

```
> a
Split
> dimnames(a)
[[1]]
NULL
[[2]]
[1] "Split"
> str(a)
An 'xts' object of zero-width
> str(a['2003'])
chr "Split" 
```

有没有人遇到过这个？有谁知道解决方法？任何帮助表示赞赏。

这是实际场景

```
library(TTR)
d = getYahooData('ACE', 20121201, 20121231, freq="daily", type="split", adjust=F, quiet=T)
s = d[!is.na(d[, 2]), 2]
> s
Split
> s['2012']
[1] "Split"
> str(s)
An 'xts' object of zero-width
> str(s['2012'])
chr "Split" 
```

和

```
> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
[4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
[7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C              
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
  [1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
  [1] XML_3.95-0.1    tseries_0.10-30 TTR_0.21-1      xts_0.9-1       zoo_1.7-9      

loaded via a namespace (and not attached):
  [1] grid_2.14.1      lattice_0.20-0   quadprog_1.5-4   rstudio_0.97.248 tools_2.14.1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:48:45.833

当我们尝试 susbset 索引时，这似乎是 xts 对象的错误。

一种解决方法是使用`drop = TRUE`

```
d = getYahooData('ACE', 20121201, 20121231, freq="daily", type="split", adjust=F, quiet=T)
s = d[!is.na(d[, 2]), 2,drop=TRUE]

 str(s)
An 'xts' object of zero-width

str(s['2012'])
An ‘xts’ object on NA/NA containing:
  Data: logi [1, 1] NA
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
List of 2
 $ tclass: chr [1:2] "POSIXct" "POSIXt"
 $ tzone : chr "" 
```

# git - Git回滚推送，.gitignore - 被忽略

> ID：14341053
> 
> 赞同：0
> 
> 时间：2013-01-15T15:30:28.870
> 
> 标签：git

我对 git 有一些问题。我有一个包含内容的文件 .gitignore：

```
uploads
.htaccess
robots.txt
etc.. 
```

我做了：

```
 git commit -a -m "GIT TEST" 
```

并且 git 发送了我的文件：.htaccess 和其他（在 .gitignore 中）。为什么 ？如何取消此提交？（提交被推送到回购“git push origin master”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:24:27.043

`git`如果文件在添加到 之前已经被跟踪`.gitignore`，则不会因为它`.gitignore`现在就被自动忽略。你需要

```
git rm --cached .htaccess
git commit 
```

告诉`git`停止跟踪该文件。您可以在下一次提交和推送周期中执行此操作，但如果您确实需要修改最近的提交以删除文件，您可以执行以下操作：

```
git rm --cached .htaccess
git commit --amend
git push -f 
```

（但请注意，如果其他人可能已经获取了“错误”提交 - 这会让他们感到悲伤）。如果有问题的提交不是最新的，而是更早的历史，您可以使用`git filter-branch`(确切语法的示例应该很容易找到)来完成相同的事情`git push -f`，但同样需要注意。

# javascript - JavaScript/jQuery“提前”确定文本的长度

> ID：14341055
> 
> 赞同：0
> 
> 时间：2013-01-15T15:30:37.023
> 
> 标签：javascript, jquery

我正在使用 jQuery 开发一个网络应用程序。我有一个固定宽度列的表格，以及 javascript 填充的行内容。

**问题：**一列的宽度为 140 像素。这一列中的大多数句子都很短，适合这个宽度。字体不是等宽的。有几个长句子，td 有 2 行，行高变得大于 20px。

我不希望这种情况发生，所以我必须缩短长句

**我的第一个想法**是用值填充 td，然后不久检查 td 或行的高度。当高度大于 20px 时，我必须缩短句子。

但我认为当行获取值时，这会导致表行“闪烁”。

所以**另一个想法**是制作一个不可见的 div 或 span 并做与之前描述的相同的事情。

有没有人以前做过这个并为我的问题找到了一个好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:34:41.997

没有办法计算文本的大小——或者至少没有可移植的方法。您甚至无法确定将使用哪种字体。

您可能会做的是使用 CSS 将其强制`td`为固定大小并忽略所有溢出的文本。`overflow: hidden`应该让你去。可能也想用`white-space: nowrap`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:36:25.090

您可以阻止使用 CSS 调整大小：

```
table { table-layout:fixed; }
table td, table th { white-space:nowrap; overflow:none; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:38:16.723

设置单元格的高度然后使用 text-overflow: ellipsis 怎么样？

```
table td { text-overflow: ellipsis; max-height: 20px; } 
```

**编辑**：固定小提琴 - 这是一个例子： [JSFiddle - td and ellipsis](http://jsfiddle.net/2pUeh/3/)

# java - 带有外部自定义绑定的 JAXB 和继承

> ID：14341060
> 
> 赞同：3
> 
> 时间：2013-01-15T15:31:07.790
> 
> 标签：java, xsd, jaxb, nested, polymorphism

我目前正在尝试在我的 XML 模式中对[Spring LDAP 过滤器进行建模。](http://static.springsource.org/spring-ldap/docs/1.3.x/reference/html/basic.html#basic-filters)这涉及多态类型，可以任意嵌套：

```
<andFilter>
  <notFilter>
     <equalsFilter name="mail" value="asfd@example.com" />
  </notFilter>
  <likeFilter name="mail" value="asdf*" />
</andFilter> 
```

这就是我在 xsd 中定义上述过滤器的方式（我实际上定义了一些中间抽象类型，但为简单起见将它们省略了）：

```
<xsd:complexType name="baseFilterType" abstract="true" />
<xsd:element name="filter" type="tns:baseFilterType" />

<xsd:complexType name="andFilterType">
  <xsd:sequence>
    <xsd:element ref="tns:filter" minOccurs="1" maxOccurs="unbounded" />
  </xsd:sequence>
</xsd:complexType>
<xsd:element name="andFilter" type="tns:andFilterType" substitutionGroup="tns:filter" />

<xsd:complexType name="notFilterType">
  <xsd:sequence>
    <xsd:element ref="tns:filter" />
  </xsd:sequence>
</xsd:complexType>
<xsd:element name="notFilter" type="tns:notFilterType" substitutionGroup="tns:filter" />

<xsd:complexType name="likeFilterType">
  <xsd:sequence>
    <xsd:element ref="tns:attributeName" />
    <xsd:element ref="tns:value" />
  </xsd:sequence>
</xsd:complexType>
<xsd:element name="likeFilter" type="tns:likeFilterType" substitutionGroup="tns:filter" />

<xsd:complexType name="equalsFilterType">
  <xsd:sequence>
    <xsd:element ref="tns:attributeName" />
    <xsd:element ref="tns:value" />
  </xsd:sequence>
</xsd:complexType>
<xsd:element name="equalsFilter" type="tns:equalsFilterType" substitutionGroup="tns:filter" /> 
```

我已经用一些自定义行为扩展了每个过滤器类（以实现访问者模式），但我不知道如何让 JAXB 绑定到这些过滤器类，而不是`JAXBElement<? extends BaseFilterType>`在整个生成的类中使用它。

JAXB 模型类是在构建时生成的，因此我不能直接修改它们——**我必须使用外部定制绑定来进行任何定制**。我已经尝试了`implClass`和`baseClass`自定义，但无法弄清楚如何做到这一点。

任何人都可以帮忙吗？

**编辑：**我使用 Spring's `Jaxb2Marshaller`with `contextPaths`set 进行编组和解组。我希望这可以`ObjectFactory`用于对象实例化，但似乎并非如此。

**编辑 2：**过滤器元素由顶级元素以及彼此引用，例如：

```
<xsd:element name="GetAttributesRequest">
  <xsd:complexType>
    <xsd:sequence>
      <xsd:element ref="filter:filter" />
    </xsd:sequence>
  </xsd:complexType>
</xsd:element> 
```

因此，`GetAttributesRequest`对象将被标记，`@XmlRootElement`而过滤器类本身则不会。但是，即使是顶级`GetAttributesRequest`对象也没有被`ObjectFactory`...实例化

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:54:09.243

**编辑 ：**

问题作者使用的解决方案：

> 我最终使用 JAXB 绑定自定义来使 ObjectFactory 生成我的类的实例，然后在 Spring 的 Jaxb2Marshaller 上设置 com.sun.xml.internal.bind.ObjectFactory（注意内部）unmarshaller 属性以强制它使用工厂。

* * *

**原始答案：**

是的，可以将行为添加到生成的类中。您想查看**[相关文档](http://jaxb.java.net/guide/Adding_behaviors.html)**

这是文档中的一个简单示例：

**JAXB 生成的代码**

```
package org.acme.foo;

@XmlRootElement
class Person {
  private String name;

  public String getName() { return name; }
  public void setName(String) { this.name=name; }
}

@XmlRegistry
class ObjectFactory {
  Person createPerson() { ... }
} 
```

**扩展类**

包 org.acme.foo.impl；

```
class PersonEx extends Person {
  @Override
  public void setName(String name) {
    if(name.length()<3) throw new IllegalArgumentException();
    super.setName(name);
  }
}

@XmlRegistry
class ObjectFactoryEx extends ObjectFactory {
  @Override
  Person createPerson() {
    return new PersonEx();
  }
} 
```

**解组示例**

```
Unmarshaller u = context.createUnmarshaller();
u.setProperty("com.sun.xml.bind.ObjectFactory",new ObjectFactoryEx());
PersonEx p = (PersonEx)u.unmarshal(new StringReader("<person />")); 
```

更多信息[在这里](http://jaxb.java.net/guide/Adding_behaviors.html)

# python - 在python中读取文件时出错

> ID：14341066
> 
> 赞同：0
> 
> 时间：2013-01-15T15:31:32.290
> 
> 标签：python, file

我正在尝试从另一台机器获取一些以文本文件发送的数据。

```
while(1):
    try:
            with open('val.txt') as f:
                    break
    except IOError as e:
            continue

f=open("val.txt","r")
counter = f.read()
print counter
f.close()
counter=int(counter) 
```

在第一次执行时，它返回一个错误

```
 counter=int(counter)
    ValueError: invalid literal for int() with base 10: '' 
```

但是如果我再次尝试执行该程序，我就能够获取数据。请帮忙，谢谢=）

更新：感谢 Ashwini 的评论，我能够解决这个问题。我将把我的解决方案留在这里供其他人参考。

在 f.close() 之后，我使用了 try-exception 方法来解决空字符串问题。显然，一旦文件到达目的地，文件内的数据仍然是空的。

```
while(1):
    try:
            counter= int(counter)
            break
    except ValueError:
            f=open("val.txt","r")
            counter = f.read()
            f.close()
            continue 
```

猜猜这不是编写程序的有效方法，但它仍然可以解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:33:53.797

您的文件是空的，并且对于无效/空字符串`int()`会引发此错误。

```
In [1]: int("")

ValueError: invalid literal for int() with base 10: ''

In [2]: int("abc")

ValueError: invalid literal for int() with base 10: 'abc'

In [3]: int("20")
Out[3]: 20 
```

您可以将`int()`呼叫环绕`try-except`以解决此问题：

```
try:
    print int("")
except ValueError:
    print "invalid string"

invalid string

#another example 

try:
    print int("23")
except ValueError:
    print "invalid string"

23 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:54:05.200

只需添加以下内容：

```
counter = f.read()
f.close()
if counter.strip():
   counter = int(counter)
   print counter 
```

如果文件为空，它将阻止打印，除非您有无法转换为数字的字符，否则您将不会再收到任何错误。

# javascript - 在数组中索引和声明的函数、可能性和替代方案

> ID：14341068
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:31:36.040
> 
> 标签：javascript, json

我有一些问题来组织我的代码。

这是我想做的一个例子：

```
var Test = {
  old: [
    get: function(who, when){
       returrn({ subject: "Old test 001", text: "The test 001 was perform by "+who });
    },
    get: function(who, when){
      returrn({ subject: "Old test 002", text: "The "+when+" the test 002 was performed"});
    }
  ],
  new: [
     //Same thing
  ]
}; 
```

问题是，我们显然不能这样做，所以我想知道在 Array 中声明函数的方法是什么？我需要这样做，因为数组的每个方法 get() 都可以返回不同的消息，并且消息可以包含在文本中不同位置的参数中传递的变量，所以我必须明确声明它。

我不这样做：

```
var Test = {
  old: [
    one: {
      get: function(who, when){
        returrn({ subject: "Old test 001", text: "The test 001 was perform by "+who });
      },
    },
    two: {
      get: function(who, when){
        returrn({ subject: "Old test 002", text: "The "+when+" the test 002 was performed"});
      }
    }
  ],
  new: [
     //Same thing
  ]
}; 
```

因为我需要动态访问内容，比如`Test.old[test_id].get("toto", "02/04/2013")`. 不幸的是，我们无法通过 JSON 中的数值索引事物。

但是我会这样做，没有比这更好的了。

那么在这种情况下最好的做法是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:50:44.717

这个问题含糊不清，但我明白为什么你的代码不起作用。您将数组和对象混为一谈。数组字面量如下所示：

```
var myArray = [
  "first item",
  "second item",
  {value: "third item"},
  ["first/only item in fourth item"],
  1,
  2,
  3.14159,
  function(a,b) { return a + b; },
  "etc."
]; 
```

**使用 push、pop、shift、unshift 和数字**索引访问数组中的项目。

对象字面量如下所示：

```
var myObject = {
  one: "some value",
  two: {
    value: "object values can be anything"
  },
  123: 456,
  "a million": function (a, b) { return a - b; }
}; 
```

使用字符串索引访问对象中的项目。

最后，您是否在某处声明了**returnrn()**函数？无论哪种情况，为什么不只**返回**您的*返回*值？

# c - 这个 C 函数有什么作用？

> ID：14341070
> 
> 赞同：-3
> 
> 时间：2013-01-15T15:31:49.093
> 
> 标签：c, function

```
double *f(int n, double v)
{
  double *a, *p;
  a = malloc(n * sizeof(double));
  if (a != NULL)
    for (p = a; p < a + n; p++)
      *p = v;
  return a;
} 
```

你能解释一下这个功能需要什么吗？它是否复制了 n 中 v 的内容？如果是，为什么它返回一个？我真的不明白...提前谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T15:33:18.843

它返回一个新分配`double`的大小数组，其中`n`填充了 value `v`，或者`NULL`如果分配失败。

这个循环：

```
for (p = a; p < a + n; p++)
    *p = v; 
```

使用指针算法。作为`p`指向 a 的指针`double`，递增它将指向下一个要写入的双精度数。`*p = v`在指定位置写入双精度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T15:33:34.180

它分配一个双精度数组，将数组的`n`每个元素初始化为 的值`v`。

函数返回`a`以允许调用者使用这个新分配的数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T15:37:41.233

```
double *f(int n, double v) 
{
  double *a, *p;
  a = malloc(n * sizeof(double));  // allocate memory enough for "n" doubles (an array)
  if (a != NULL)                   // if the allocation was successful
    for (p = a; p < a + n; p++)    // loop from the beginning of the array to the end
      *p = v;                // fill every element of the array with the value "v"
  return a;                  // return the new array
} 
```

所以如果我调用这个函数：

```
double * myarray;
myarray = f(3, 1.3); 
```

我现在有：

```
myarray[0] = 1.3
myarray[1] = 1.3
myarray[2] = 1.3 
```

所以回答你的问题：

> 你能解释一下这个功能需要什么吗？

*   分配并初始化一个双精度数组。

> 它是否复制了 n 中 v 的内容？

*   不，考虑`v`是一个双`n`精度整数，这甚至没有意义。它使数组`n`变大并使用 value 对其进行初始化`v`。

> If yes, why does it return a?

*   It returns `a` so you have a reference to the newly created array. (see example above on how it could be used)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T15:34:22.447

它分配一个字节的内存区域并用值`n * sizeof(double)`填充它`v`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T15:34:26.773

在堆中分配一个 n 双精度数组，用 v 填充它并返回指向它的指针？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T15:34:14.163

将 n 次复制`v`到浮点数组中

该数组在函数中分配并包含`n`浮点元素。

在函数的末尾，数组中的每个元素`a`都包含`v`为值

# c# - iTextSharp 在 AcroForm 字段中呈现捷克字符

> ID：14341076
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:13.277
> 
> 标签：c#, pdf, character-encoding, itextsharp, itext

我有一些 PDF 模板文件，`AcroForm`其中包含字段，是使用 OpenOffice 创建的。当我尝试使用以下方式填写字段时`iTextSharp`：

`form.SetField(field.Key, String.Format(field.Value.FormatString, value));`

我在展平字段中出现重叠和丢失的字符：

![在此处输入图像描述](../Images/f0a02dada819abbe07cd8cff0deb703e.png)

我可以将`Arial`字体嵌入到完成的 PDF 中，但这会使大小膨胀很多，这也意味着必须重置已在字段上设置的所有字体属性（由 Open Office 提供）。

当我在 Adob​​e Reader 中手动填写表格时，文本显示正确。欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T19:07:36.960

我不是 itextsharp 的用户，但在 java 中使用了很多 itext。所以我认为你在这里想念的是添加替换字体。我作为 Pdf 阅读器不知道是否有可用的字体来显示其文本字符。作为您正在使用 AcroForm，因此会有一个对象 PdfStamper，您还可以找到类似 PdfStamper.getWriter().getAcroForm().setNeedAppearances(true); 的方法；与 itext java 对应项一样。还有 form.addSubstitutionFont（您的语言的 BaseFont Obj）。您可以添加多个，因为在 java itext 透视图中它是一个数组列表。此外，在使用 .ttf 文件或 .ttc 文件的字体创建 basefont 时，请记住哪种编码使用。例如，为了保持中文字符不变，我们使用 IDENTITY_H 编码，对于阿拉伯语，我们使用 IDENTITY_V（V-垂直方向，H-水平方向）。

# javascript - 如何处理具有条件要求的 AMD 模块？

> ID：14341078
> 
> 赞同：3
> 
> 时间：2013-01-15T15:32:16.137
> 
> 标签：javascript, requirejs, amd, js-amd

假设我有一个 AMD 模块，它在某些环境中有条件地需要第二个模块：

```
定义（[“要求”]，功能（要求）{
  变量 myObj = {
    富：console.error.bind（控制台）
  };
  如果（浏览器环境）
    要求（[“./条件-polyfill”]，函数（polyfill）{
      myObj.foo = console.log.bind(console,polyfill) ;
    });
  返回我的对象​​；//在满足条件要求之前返回
});

```

**问题是：在条件要求完成后，如何延迟 define() 调用以返回/回调？**

即下面的代码失败：

```
需要（[“模块从上面”]，函数（记录器）{
  logger.foo("你好！"); //console.error 被调用
});

```

我对解决这个问题的想法：

*   如果我 inline `./polyfill`，一切都会奏效。但是，这只是规避了问题，并不适用于所有情况。我希望它模块化是有原因的。
*   我可以返回一个[Deferred](http://livedocs.dojotoolkit.org/dojo/Deferred)对象，而不是稍后`myObj`实现。`./conditional-polyfill`这会起作用，但是一直打电话真的很难看`loggerDeferred.then(function(logger){ ... });`。
*   我可以为这个模块制作一个 AMD 加载器插件。一切准备就绪后立即调用回调。同样，这会起作用，但自己的加载器插件不适用于我的构建工具。

我能想到的所有解决方案都是黑客而不是好的代码。但是，我认为我的问题并不太牵强。那么，如何处理呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:33:23.540

将条件推送到“工厂函数”之外（AMD 社区中常用的名称，指的是 require 和 define 的回调函数）

```
;(function() {

function factory(require, polyfill){
  var myObj = { 
    foo: console.error.bind(console) 
  }
  if(polyfill){
    myObj.foo = console.log.bind(console, polyfill)
  }
  return myObj
}

var need = ['require']

if(browserEnv){
  need.push("./conditional-polyfill")
}

define(need, factory)

})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:46:51.993

正如你所说，我会使用延迟。

延迟模式是此类问题的理想解决方案，因为它允许您以一致的方式将复杂的异步操作联系在一起。

它会使您的代码更大一些，但与修改加载器和构建工具相比，它是一个简单的解决方案。

# wix - 显示带有启动条件的自定义对话框

> ID：14341079
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:16.487
> 
> 标签：wix, windows-installer

当启动条件在 Wix 中失败时，我想显示我的自定义对话框而不是消息框。通常，启动条件的消息框有确定按钮，但我想通过我的对话框进行一些进一步的操作来做更多的事情。你能告诉我怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:13:08.350

可以使用 InstallExecuteSequence 和 Custom 元素对对话框进行排序。在欢迎对话框之前和 LaunchConditions 操作之后安排它。您可能希望在执行序列中安排一个错误自定义操作来处理静默安装期间的日志记录。

您可能还想使用 Publish 元素将您的对话框创作到主向导循环中（在 install welcome 之后）。如果不了解您的确切需求，就很难说。

# sql - 日期范围报告 - 聚合

> ID：14341080
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:17.817
> 
> 标签：sql, oracle

我在执行典型的报表样式 SQL 时遇到了一些问题，希望有更多经验的人能够提供帮助。

我有以下表格

**产品**

*   product_id
*   产品名称
*   产品分类

**产品缺陷**

*   product_id
*   缺陷日期
*   高优先级
*   med_priority
*   低优先级

**日历**

*   日期

我想要的是能够生成一份报告，概述每天与每个产品类别相关的高/中/低缺陷的数量，例如——即使特定日期的 product_defect 中可能不存在数据，在这种情况下它应返回为 0。示例：

> 产品类别 | 日期 | 高 | 中 | 低的
> 
> 1 2012-10-01 1 5 6
> 
> 2 2012-10-01 2 4 3
> 
> 3 2012-10-01 1 5 6
> 
> 1 2012-10-02 0 0 0
> 
> 2 2012-10-02 2 4 3
> 
> 3 2012-10-02 1 5 6
> 
> …</p>

到目前为止我所做的是：

*   创建一个名为 calendar 的查找表，其中包含一系列日期，可以向后/向前几年
*   右加入查找/产品缺陷表以获取一系列日期，因此可以将缺失的天数标记为 0
*   使用 COALESCE 和 SUM 计算总计并将任何缺失的数据更改为 0
*   在 defect_date 上使用 MIN / MAX 来获得准确的报告范围

这几天我一直在努力解决这个问题，希望有人能提供帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:37:43.223

您需要从产品和日期的所有组合开始，然后加入缺陷：

```
select p.product_category, c.date, 
       coalesce(SUM(high_priority), 0) as high_priority,
       coalesce(SUM(med_priority), 0) as med_priority,
       coalesce(SUM(low_priority), 0) as low_priority
from product p cross join
     calendar c left outer join
     product_defects pd
     on pd.product_id = p.product_id and
        pd.date = c.date
group by p.product_category, c.date
order by 2, 1 
```

（注意：这是未经测试的，所以可能有语法错误。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:44:11.247

像这样的东西。我使用双而不是日历，您可以使用或替换日历表。

例如，开始日期为 2013 年 1 月 1 日至 2013 年 1 月 15 日。

```
with dates as (select to_date('01/01/2013', 'dd/mm/yyyy') + rownum - 1 dte
                 from dual 
               connect by level <= to_date('15/01/2013', 'dd/mm/yyyy') 
                         - to_date('01/01/2013', 'dd/mm/yyyy') + 1)
select dt.dte, p.product_id, p.product_name, 
       sum(d.high_priority), sum(d.med_priority), sum(d.low_priority)
  from products p
       inner join product_defects d
               on d.product_id = p.product_id
       right outer join dates dt
                     on dt.dte = d.defect_date -- trunc(d.defect_date) if you store with a time element.
 group by dt.dte, p.product_id, p.product_name
 order by dt.dte; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:44:57.093

因此，这使用子工厂查询子句 ( `cte`) 来汇总每天每个类别的所有缺陷。我使用这个结构来使逻辑更清晰；还有其他方法可以做到这一点。然后将子查询外连接到日历表。

```
with cte as 
    ( select p.product_category
             , d.defect_date
             , sum(pd.high_priority) as high_priority
             , sum(pd.med_priority) as med_priority
             , sum(pd.low_priority) as low_priority
      from product p
           join product_defect pd
                on (pd.product_id = p.product_id )
     group by p.product_category
             , d.defect_date )
select cte.product_category
       , cal.date 
       , nvl(cte.high_priority, 0) as high_priority
       , nvl(cte.med_priority, 0) as med_priority
       , nvl(cte.low_priority, 0) as low_priority
from calendar cal
     left outer join cte 
        on cal.date = cte.defect_date
order by cte.product_category
       , cal.date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:23:40.243

仅日历表示例。将月数从 -24（2 年）增加到任意数字 - 复制/粘贴代码：

```
-- 2 years back by date  --
SELECT TRUNC(SYSDATE, 'YEAR') - LEVEL AS mydate
 FROM dual
CONNECT BY LEVEL <= TRUNC(SYSDATE, 'yy') - TRUNC(Add_Months(SYSDATE, -24), 'yy')
/ 
```

添加更多日期：

```
-- 2 years back by date and week  --
SELECT mydate
 , TRUNC(mydate, 'iw') wk_starts
 , TRUNC(mydate, 'iw') + 7 - 1/86400 wk_ends
 , TO_NUMBER (TO_CHAR (mydate, 'IW')) ISO_wk#  
FROM
(
SELECT TRUNC(SYSDATE, 'YEAR') - LEVEL AS mydate
  FROM dual
CONNECT BY LEVEL <= TRUNC(SYSDATE, 'yy') - TRUNC(Add_Months(SYSDATE, -24), 'yy')
)
/ 
```

发布创建表并插入脚本以回答您的其余问题或使用 sqlfiddle...

# php - PHP oop 致命错误：未捕获的 SoapFault 异常：

> ID：14341083
> 
> 赞同：1
> 
> 时间：2013-01-15T15:32:22.513
> 
> 标签：php, soap, ssl

我无法使用我的橙色服务器连接到我的网站，出现此错误：

我启用了 ssl 和 soap，但它仍然不起作用。

```
Fatal error: Uncaught SoapFault exception: [WSDL] SOAP-ERROR:
Parsing WSDL: Couldn't load from 'https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl':
Start tag expected, '<' not found in C:\xampp\htdocs\test\library\connect.class.php:10

Stack trace: #0 C:\xampp\htdocs\test\library\connect.class.php(10): SoapClient->SoapClient('https://m2mconn...')
#1 C:\xampp\htdocs\test\application\views\items\homepage.php(20): Connect->__construct()
#2 C:\xampp\htdocs\test\library\template.class.php(30): include('C:\xampp\htdocs...')
#3 C:\xampp\htdocs\test\library\controller.class.php(25): Template->render()
#4 C:\xampp\htdocs\test\library\shared.php(91): Controller->__destruct()
#5 C:\xampp\htdocs\test\library\shared.php(91): callHook()
#6 C:\xampp\htdocs\test\library\bootstrap.php(4): require_once('C:\xampp\htdocs...')
#7 C:\xampp\htdocs\test\public\index.php(8): require_once('C:\xampp\htdocs...')
#8 {main} thrown in C:\xampp\htdocs\test\library\connect.class.php on line 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:30:02.870

> [WSDL] SOAP 错误：解析 WSDL：无法从...加载

假设 WSDL 和服务实际上可以在 Internet 上访问，这意味着您的脚本无法连接到远程 Web 服务 - 它无法下载 WSDL 并且无法调用该服务。您需要检查服务器的网络连接（尤其是出站）。您可能需要询问您的主机，因为他们的防火墙/配置可能会停止出站连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:37:45.833

尝试将 WSDL 保存到本地文件，并在构造函数中引用它...

```
$client = new SoapClient('/local/path/to/wsdlfile.wsdl'); 
```

编辑：如果您在使用文件系统时遇到 http 错误，那么您做错了什么:-)

试图自己运行这个，这些是我的回应。注意：我也无法连接到橙色服务器，可能是他们的 https 连接有点臭...

Var-dump 一个新的 SoapClient：

```
$> php -r "var_dump(new SoapClient('https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl'));"
PHP Fatal error:  SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl' :
 failed to load external entity "https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl"
 in Command line code on line 1
PHP Fatal error:  Uncaught SoapFault exception: [WSDL] SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl' :
 failed to load external entity "https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl"
 in Command line code:1
Stack trace:
#0 Command line code(1): SoapClient->SoapClient('https://m2mconn...')
#1 {main}
  thrown in Command line code on line 1

Fatal error: Uncaught SoapFault exception: [WSDL] SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl' :
 failed to load external entity "https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl"
 in Command line code:1
Stack trace:
#0 Command line code(1): SoapClient->SoapClient('https://m2mconn...')
#1 {main}
  thrown in Command line code on line 1 
```

获取 WSDL：

```
$> wget https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl -O MSBC.wsdl
--19:41:45--  https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl
           => `MSBC.wsdl'
Resolving m2mconnect.orange.co.uk... done.
Connecting to m2mconnect.orange.co.uk[213.52.171.155]:443... connected.

Unable to establish SSL connection.

Unable to establish SSL connection. 
```

通过浏览器下载 WSDL，并使用该浏览器：

```
$> php -r "$s = new SoapClient('MSBC2.wsdl');var_dump($s, $s->__getFunctions());"
object(SoapClient)#1 (2) {
  ["_soap_version"]=>
  int(1)
  ["sdl"]=>
  resource(6) of type (Unknown)
}
array(11) {
  [0]=>
  string(133) "int sendMessage(string $username, string $password, string $deviceMSISDN, string $message, boolean $deliveryReport, string $mtBearer)"
  [1]=>
  string(116) "ArrayOf_xsd_string getDeliveryReports(string $username, string $password, string $deviceMSISDN, string $countryCode)"
  [2]=>
  string(122) "ArrayOf_xsd_string readMessages(string $username, string $password, int $count, string $deviceMsisdn, string $countryCode)"
  [3]=>
  string(100) "boolean flushMessages(string $username, string $password, string $deviceMSISDN, string $countryCode)"
  [4]=>
  string(139) "ArrayOf_xsd_string waitForMessage(string $username, string $password, int $timeout, string $deviceMSISDN, int $msgref, string $countryCode)"
  [5]=>
  string(204) "int sendMessageWithValidityPeriod(string $username, string $password, string $deviceMSISDN, string $message, boolean $deliveryReport, string $mtBearer, string $binarySmsDcs, string $validityDaysHoursMins)"
  [6]=>
  string(164) "int sendBinarySmsMessage(string $username, string $password, string $deviceMSISDN, string $message, boolean $deliveryReport, string $mtBearer, string $binarySmsDcs)"
  [7]=>
  string(162) "ArrayOf_xsd_string sendAndWait(string $username, string $password, int $timeout, string $deviceMSISDN, string $message, boolean $deliveryReport, string $mtBearer)"
  [8]=>
  string(193) "ArrayOf_xsd_string sendBinarySmsAndWait(string $username, string $password, int $timeout, string $deviceMSISDN, string $message, boolean $deliveryReport, string $mtBearer, string $binarySmsDcs)"
  [9]=>
  string(122) "ArrayOf_xsd_string peekMessages(string $username, string $password, int $count, string $deviceMsisdn, string $countryCode)"
  [10]=>
  string(142) "ArrayOf_xsd_string getDeliveryReportsFromDate(string $username, string $password, string $deviceMSISDN, string $countryCode, string $fromDate)"
}

$> 
```

请注意，我不能调用任何方法，因为我没有有效的详细信息。

# python - tell() 在遍历文件时返回不正确的结果

> ID：14341084
> 
> 赞同：2
> 
> 时间：2013-01-15T15:32:24.433
> 
> 标签：python, file-io, python-2.7

> **可能重复：**
> [file.tell() 不一致](https://stackoverflow.com/questions/14145082/file-tell-inconsistency)

考虑一个文件内容

```
D:\temp>od -c test.txt
0000000   x   x   x   x   x  \r  \n   y   y   y   y   y  \r  \n   z   z
0000020   z   z   z  \r  \n   t   t   t   t   t
0000032 
```

当我遍历这个文件并随后遍历`tell()`当前位置时，每次它返回一个不正确的结果（结果表明，它在最后）

```
>>> with open("test.txt","r+") as fin:
    for line in fin:
        print fin.tell(), line.strip()

26 xxxxx
26 yyyyy
26 zzzzz
26 ttttt 
```

但是当我线性读取文件时，结果与预期一致

```
>>> with open("test.txt","r+") as fin:
    while True:
        line = fin.readline()
        if not line:
            break
        print fin.tell(), line.strip()

7 xxxxx
14 yyyyy
21 zzzzz
26 ttttt 
```

似乎在遍历文件时，它要么缓冲整个内容，要么至少在开始迭代之前读取结束。

它是已知的记录行为吗

# bash - sed（使用 shell 替换 / 为 \/）

> ID：14341089
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:35.510
> 
> 标签：bash, sed

我正在使用一个使用 sed 的 shell 脚本

我在变量中有这句话

```
kpi="ENFRIADORA CONDENSADA POR AIRE/AIRE-AIRE/AGUA - MENSUAL" 
```

如果在控制台中我把

```
echo $kpi | sed 's/\//\\\//g' 
```

我懂了

```
ENFRIADORA CONDENSADA POR AIRE\/AIRE-AIRE\/AGUA - MENSUAL 
```

这就是我想要的，但是当我把它放在这样的脚本中时

```
echo start
echo $kpi2
kpi_2=`echo $kpi2 | sed 's/\//\\\//g'`
echo $kpi_2
echo end 
```

我看到的是：

```
start
ENFRIADORA CONDENSADA POR AIRE/AIRE-AIRE/AGUA - MENSUAL
sed: -e expresion #1, character 9: unknown option to `s'

end 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:37:21.293

```
$> kpi_2=$( echo $kpi | sed 's/\//\\\//g' )

$> echo $kpi_2
ENFRIADORA CONDENSADA POR AIRE\/AIRE-AIRE\/AGUA - MENSUAL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:40:11.487

这对我有用：

```
kpi_2=`echo $kpi2 | sed 's:\/:\\\/:g'` 
```

# asp.net-mvc - HtmlHelper 与 Partial 的性能对比

> ID：14341090
> 
> 赞同：5
> 
> 时间：2013-01-15T15:32:37.517
> 
> 标签：asp.net-mvc, asp.net-mvc-3

对给定任务使用 HtmlHelper 或 Partial 之间是否存在性能差异？

例如，我正在编写一个 HtmlHelper “控件”来在编辑器中创建一个具有以下签名的链接：

```
public static HtmlString RecordNameLink(
        this HtmlHelper htmlHelper, 
        string linkText, 
        string editActionName, 
        object editRouteValues, 
        string deleteActionName = null, 
        object deleteRouteValues = null) 
```

在这种情况下，将始终显示编辑按钮，只有包含删除按钮时才会显示删除按钮。或者，我可以这样做：

```
@Html.Partial("Controls/RecordNameLink", Model) 
```

（或者传递一个部分特定的模型）

但是*有理由*选择一个而不是另一个，特别是一个比另一个有更好的性能吗？（尽管我愿意更多地了解一般差异）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:46:07.250

在 MVC 3 中，对于这种事情来说，使用 html 助手渲染比使用 Partial 更快。

做一个测试，你在一个循环中渲染部分 100 多次，而不是让部分包含循环（表的每行部分渲染，表的所有行的部分渲染）。你可能会对结果感到非常惊讶。

您的 HTML 助手将跳过必须寻找部分的视图引擎、对虚拟路径提供程序的调用以加载它等。

# android - 当 Horizo ntalScrollView 到达右侧时？

> ID：14341093
> 
> 赞同：1
> 
> 时间：2013-01-15T15:32:41.187
> 
> 标签：android, android-layout

有什么方法可以知道什么时候`HorizontalScrollView`达到正确的极限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:49:31.707

是的，但首先你必须重写 Horizo​​ntalScrollView 类并提供你自己的监听器。由于某种原因，SDK 不允许您直接访问 OnScrollChanged 侦听器。

请执行下列操作：

```
public class FixedScrollView extends HorizontalScrollView
{
    private ScrollViewListener scrollViewListener = null;

    public FixedScrollView(Context context)
    {
        super(context);
    }

    public FixedScrollView(Context context, AttributeSet attrs, int defStyle)
    {
        super(context, attrs, defStyle);
    }

    public FixedScrollView(Context context, AttributeSet attrs)
    {
        super(context, attrs);
    }

    public void setScrollViewListener(ScrollViewListener scrollViewListener)
    {
        this.scrollViewListener = scrollViewListener;
    }

    @Override
    protected void onScrollChanged(int x, int y, int oldx, int oldy)
    {
        super.onScrollChanged(x, y, oldx, oldy);
        if (scrollViewListener != null)
        {
            scrollViewListener.onScrollChanged(this, x, y, oldx, oldy);
        }
    }

    public interface ScrollViewListener
    {
        void onScrollChanged(FixedScrollView scrollView, int x, int y, int oldx, int oldy);
    }
} 
```

然后你可以在你的代码中使用它：

```
FixedScrollView scrollView = (FixedScrollView) findViewById(R.id.scroller); 
```

设置 onScrollChangeListener：

```
scrollView.setScrollViewListener(scrollerChanged); 
```

然后在侦听器中执行以下操作以检测边缘：

```
ScrollViewListener scrollerChanged = new ScrollViewListener()
    {

        @Override
        public void onScrollChanged(FixedScrollView scrollView, int x, int y, int oldx, int oldy)
        {
            int maxScrollX = scrollView.getChildAt(0).getMeasuredWidth() - scrollView.getMeasuredWidth();

            if (scrollView.getScrollX() == 0)
            {
                //Left side
            }
            else if (scrollView.getScrollX() == maxScrollX)
            {
                //Right side
            }
            else
            {
                //Neither left nor right
            }
        }
    }; 
```

# relational-database - 关系代数查询

> ID：14341095
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:53.247
> 
> 标签：relational-database, relational-algebra

我正在为关系代数查询进行考试修订，其中一个示例问题与示例问题答案相比，我有完全不同的方法。如果有人可以给我一个提示，我将非常感激他们是否都有效？如果不是我的方法有什么问题，谢谢。

**来自以下实体：**

部门（*部门名称、员工人数、地点）

部门员工（*部门名称，*员工编号）

STAFF（*员工编号、员工姓名、薪级、薪水）

**我被要求：** 找出在外汇和保险部门工作的员工的姓名。

**我的做法：**

```
 RESTRICT Department-Staff WHERE dept-name = 'Foreign Exchange' GIVING T1

     RESTRICT Department-Staff WHERE dept-name = 'Insurance' GIVING T2

        T1 intersect T2 giving T3

         JOIN T3 and Staff (OVER Staff-no) giving T4

           PROJECT T4 over Staff-name giving RESULT 
```

**同时在示例问题答案中：**

```
RESTRICT DEPARTMENT-STAFF where DEPT-NAME = 'FOREIGN EXCHANGE' giving T1

RESTRICT DEPARTMENT-STAFF where DEPT-NAME = 'INSURANCE' giving T2

JOIN T1 and STAFF (over STAFF-NO) giving T3 

JOIN T2 and STAFF (over STAFF-NO) giving T4

T3 INTERSECT T4 GIVING T5

PROJECT T5 over STAFF-NAME GIVING RESULT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:31:23.917

您的 T1 INTERSECT T2 给 T3 是错误的。那个路口怎么可能包含任何东西？

由于同样的原因，模型答案是错误的，顺便说一句，在 T3 INTERSECT T4 GIVING T5 的地方。

# c# - new[] 和 new string[] 有什么区别？

> ID：14341097
> 
> 赞同：18
> 
> 时间：2013-01-15T15:32:56.383
> 
> 标签：c#, arrays, semantics

> **可能重复：**
> [这个 new[] 的简写是什么？](https://stackoverflow.com/questions/9056311/what-is-this-new-a-shorthand-for)

有没有区别

```
var strings = new string[] { "hello", "world" }; 
```

和

```
var strings2 = new[] { "hello", "world" }; 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-15T15:34:20.157

在这种情况下，没有区别，因为`new[]`将提供的值类型推断为`string`.

请参阅[隐式类型数组](http://msdn.microsoft.com/en-us/library/bb384090.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T15:35:14.397

没有不同。

第二个是称为[“隐式类型数组”](http://msdn.microsoft.com/en-us/library/bb384090.aspx)的语法糖，两个表达式都返回一个字符串数组。

当您不指定数组的类型时，它是从用于初始化数组的元素的类型中*推断出来的。*
为了允许推理，表达式必须满足以下条件：

*考虑像这样的隐式类型数组表达式：*

```
 var arr = new []{ obj1, ... , objn } 
```

*初始化中所有元素类型的集合是：*

```
 S = {T1, ..., Tn} 
```

*为了允许推理（即没有编译器错误），必须可以将所有类型* `{ T1, ... , Tn }` *隐式转换为 set 中的一种类型* `S`。

因此，例如，给定以下类：

```
class Base { }
class Derived1 : Base { }
class Derived2 : Base { }
class Derived3
{ 
    public static implicit operator Base(Derived3 m)
    { return null; }
} 
```

此代码编译：

```
var arr = new []{ new Derived1(), new Derived2(), new Derived3(), new Base()}; 
```

而以下没有：

```
var arr = new []{ new Derived1(), new Derived2(), new Derived3() }; 
```

因为在第一种情况下，所有 3 种类型都可以隐式转换为类型`Base`，并且`Base`类型在集合内`S = { Derived1, Derived2, Derived3, Base }`，而在第二种情况下，所有类型都不能转换为集合中的一种类型`S = { Derived1, Derived2, Derived3 }`

* * *

此功能已随 C# 3.0 以及匿名类型一起引入，它使后者的数组的实例化更加容易。

例如，如果没有隐式类型的数组，这将很难获得：

```
var arrayOfAnonymous = new[] { new { A = 3, B = 4 }, new { A = 2, B = 5 } }; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-15T15:37:10.307

在这种情况下，***没有区别***。因为`hello`和`world`是`string`;

```
var strings2 = new[] { "hello", "world" }; 
```

创建一个`string[]`与第一个相同的数组。

![在此处输入图像描述](../Images/0b5744d8ef4ef917dd26fd0afd8758b7.png)

第二个被称为*[`Implicitly Typed Arrays`](http://msdn.microsoft.com/en-us/library/bb384090.aspx)*

如果我们更进一步，它们具有相同的`IL`代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-15T15:35:21.067

无，编译将其解释为`new string[] { "hello", "world" };`

就像 using 一样`var`，编译器会处理您的意思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T15:34:00.263

new[] 创建一个[隐式类型数组](http://msdn.microsoft.com/en-us/library/bb384090.aspx)，其中类型是从元素中推断出来的。而另一种方法创建一个字符串数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T15:35:11.387

没有区别。在第二种情况下，C# 编译器足够聪明地推断出数组的类型，因为它看到用于初始化数组的值是字符串类型的。

# javascript - 使用 cookie 来记住一篇文章是否已被阅读 - 需要注意的标识符

> ID：14341098
> 
> 赞同：0
> 
> 时间：2013-01-15T15:32:56.347
> 
> 标签：javascript, css, cookies

我希望在我正在构建的网站上设置某种“您已阅读本文”功能。

每篇已阅读/尚未阅读的文章的标题旁边将显示一个小圆圈 - 不确定哪种效果最好。前者大概。

我想知道是否有人以前做过这种事情/有它的名字。我猜某种cookie会很有用。但是，我不确定它是否应该只存在于该会话中，因此一些简单的 CSS/JS 就足够了。

关于这个主题的任何想法和任何例子？

谢谢，R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:01:52.950

我将创建一个包含用户 ID 和文章 ID 的 youHaveRead 表。

不要使用 cookie，因为用户可以控制它。

此外，如果您使用多个设备，则无法共享 cookie。

例如，您希望这些通知无处不在，例如您的手机、电脑、平板电脑、电子阅读器等...

这样您就可以查看有关它的统计信息。;)

但那只是我的个人意见。

# mercurial - Mercurial：搁置提交的文件

> ID：14341100
> 
> 赞同：4
> 
> 时间：2013-01-15T15:33:01.577
> 
> 标签：mercurial, tortoisehg, shelve

我有两个存储库，开发和测试。在开发中，自上次推动测试以来，我已经做出了几次提交。但是，现在我想搁置所有这些提交，进行不同的更改，将其推送到测试，然后取回这些提交。搁置仅适用于未提交的文件。

我应该怎么办？以相反的顺序退出或回滚或恢复每个提交？重命名开发，将测试克隆到开发，进行更改，推送到测试，推送到重命名的开发，删除开发，重命名重命名的开发回开发？

最干净/最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:44:59.530

为了让其他读者清楚：实际的 HG shelve 命令不是这种情况的正确方法；它不适用于已经提交的更改，但在这种情况下也没有必要使用。

以下是您可以执行的操作：

1.  在*dev*中，更新到您不想推送到*testing*的提交之前的版本。
2.  *在开发*和提交中进行所需的更改。这将创建一个新的头部（这也将是新的提示）。
3.  推送*测试*
4.  在*dev*中，将提示与包含您避免推送的更改的另一个头合并，然后提交。

* * *

原始建议（在这种情况下无法实施）：

1.  将 dev 克隆到新的 repo 并更新到提交之前的版本（或者只是克隆测试）
2.  进行您想要的更改，提交并推送到测试和开发
3.  丢弃克隆
4.  将测试从测试拉到开发中，并在闲暇时合并头部，再次建立一个头部

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:56:25.070

另一个工作流程可能是：使用 MQ 扩展

*   为存储库启用 MQ 扩展
*   初始化 MQ
*   将所需的变更集转换为 MQ 补丁（[如何将 N 个本地最顶层提交转换为 MQ 补丁？](https://stackoverflow.com/questions/7297889/how-to-convert-n-local-topmost-commits-to-an-mq-patch)以及第 12 章中的“与永久修订之间的转换”主题。使用HG Book[的 Mercurial Queues 管理变更）](http://hgbook.red-bean.com/read/managing-change-with-mercurial-queues.html)
*   取消应用所有创建的补丁 'hg qpop -a'
*   做出改变，提交，推动
*   将补丁返回到变更集状态（`hg qpush -a`+ `hg qfinish -a`）

# javascript - chrome 控制台查找触发事件

> ID：14341121
> 
> 赞同：0
> 
> 时间：2013-01-15T15:34:10.643
> 
> 标签：javascript, debugging, google-chrome

我可以在 Chrome 控制台中设置全局断点的控制台功能是什么？例如，我可以执行类似

```
console.scf()
function scf(e){
  e.preventDefault();
  // show all events / methods attempting to fire.
} 
```

所以一个全局断点将指向文件/行号。

# python - 网页抓取到 HTML 代码

> ID：14341134
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:34:44.990
> 
> 标签：python, ruby, web-scraping

我已经阅读了有关使用 PERL、Ruby、Python 和 PHP 进行网络抓取或解析 RSS 提要的信息。

如果我使用其中一种语言来抓取页面，是否可以将抓取的信息写入 index.html 之类的 HTML 文件？我想从 RSS 提要中获取链接，并用它们在我的主页上制作一个菜单。

每次我抓取时，我都必须重写整个 HTML 文件？我有一个部分，“标题”，我需要每隔一小时左右更改一次，它从抓取的页面中获取信息。

这是每次抓取运行时我都需要更改的代码：

```
<article class="grid_4">
        <div class="box-1">
          <h3>HEADLINES</h3>
          <ul class="list-1 p2">
            <li><a href="more.html"><b></b><strong>Lorem ipsum</strong> dolor amet, consectetuer</a></li>
            <li><a href="more.html"><b></b><strong>Adipiscing elit</strong> sed diam nonummy nibh</a></li>
            <li><a href="more.html"><b></b><strong>Euismod tincidunt</strong> laoreet dolore magna</a></li>
            <li><a href="more.html"><b></b><strong>Aliquam erat</strong> volutpat wisi enim ad minim</a></li>
            <li><a href="more.html"><b></b><strong>Veniam nostrud</strong> exerci tation ullamcorper</a></li>
            <li><a href="more.html"><b></b><strong>Suscipit lobortis</strong> nisl ut aliquip commodo</a></li>
            <li><a href="more.html"><b></b><strong>Duis autem</strong> vel eum iriure dolor hendrerit</a></li>
            <li><a href="more.html"><b></b><strong>In vulputate</strong> velit esse molestie consequat</a></li>
            <li><a href="more.html"><b></b><strong>Vel illum</strong> dolore eu feugiat nulla facilisis</a></li>
            <li><a href="more.html"><b></b><strong>At vero</strong> eros et accumsan</a></li>
          </ul>
          <div class="alignright p3"><a href="more.html" class="link-1">read more</a></div>
        </div>
        <a href="more.html" class="banner-1"></a> </article>
    </div> 
```

是否有可能做到这一点？如果没有，你能指出我开始阅读/学习它的地方吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:42:20.423

安装 Beautiful Soup

```
pip install beautifulsoup4 
```

然后[阅读文档](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)

（如果您没有 pip，请从此处安装：[http](http://www.pip-installer.org/en/latest/installing.html) ://www.pip-installer.org/en/latest/installing.html ）

Beautiful Soup 会给你一个漂亮干净的网页版本。您可以搜索此结构以查找链接或您所追求的任何信息。

```
soup.find_all('a') 
```

将为您提供页面中的所有链接。

要将这些放到网页上，有无数种可能性，我想到了一些：

*   您可以生成网页

*   您可以生成一个网页并将其加载到 iframe 中

*   您可以生成一个包含所有链接的 JSON 格式的文本文件，并从嵌入在静态网页上的 Javascript 获取它

*   正如你所说，你可以运行 Django

什么是最好的取决于很多因素——你多久可以刮一次？*你应该*多久刮一次？抓取是否必须发生在 Web 服务器上，还是应该发生在其他定期上传到您的 Web 服务器的计算机上？

模糊的问题，模糊的答案……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:41:40.307

对的，这是可能的：

*   [蟒蛇/美丽的汤](http://blog.dispatched.ch/2009/03/15/webscraping-with-python-and-beautifulsoup/)
*   [更多汤](http://www.techrepublic.com/article/build-a-basic-web-scraper-in-python/6310689)
*   [刮擦](http://scrapy.org/)

# excel - Excel 菜单命令栏中的键盘快捷键

> ID：14341138
> 
> 赞同：5
> 
> 时间：2013-01-15T15:34:56.897
> 
> 标签：excel, menuitem, excel-2003, vba

*下面的代码在New...*之前添加了一个菜单项*Custom1*。如何让分配给*CodeCustom1*（通过）的键盘快捷键与*Ctrl+N*很好地右对齐？**`Application.OnKey`**

 ***```
Sub menuItem_Create()
   With CommandBars("Worksheet menu bar").Controls("File")
      .Controls.Add(Type:=msoControlButton, Before:=1).Caption = "Custom1"
      .Controls("Custom1").OnAction = "CodeCustom1"
   End With
End Sub 
```

![在此处输入图像描述](../Images/9859f7766627c6cb8cff1c35515f9b0e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:22:48.863

使用 CommandbarButton 的`ShortcutText`属性：

```
.Controls("Custom1").ShortcutText = "ctrl+W" 
```***

# xslt - XSLT 如何应用递归将平面文件转换为嵌套树

> ID：14341145
> 
> 赞同：0
> 
> 时间：2013-01-15T15:35:22.703
> 
> 标签：xslt, xslt-2.0

我知道还有其他几个与此类似的问题/答案，但我还没有读过一个可以解决我对这种转换的困惑的问题。我需要从这种格式中移动一个 XML 文档：

```
<root>
    <row>
        <t0>1</t0>
        <title>Main Title</title>
    </row>
    <row>
        <t0>2</t0>
        <title>Secondary Title</title>
        <note>Note</note>
    </row>
    <row>
        <t0>3</t0>
        <title>Tertiary Title</title>
    </row>
    <row>
        <t0>3</t0>
        <title>Another Title</title>
    </row>
    <row>
        <t0>2</t0>
        <title>A Second Secondary Title</title>
        <note>Note</note>
    </row>
    <row>  
        <t0>3</t0>
        <title>Third Level Title</title>
    </row>
    <row> 
        <t0>3</t0>
        <title>Title at Level Three</title>
    </row>
</root> 
```

到这种格式：

```
<root>
    <header>List</header>
    <t01>
        <title>Main Title</title>
        <t02>
            <title>Secondary Title</title>
            <note>Note</note>
            <t03>
                <title>Tertiary Title</title>
            </t03>
            <t03>
                <title>Another Title</title>
            </t03>
        </t02>
        <t02>
            <title>A Second Secondary Title</title>
            <note>Note</note>
            <t03>
                <title>Third Level Title</title>
            </t03>
            <t03>   
                <title>Title at Level Three</title>
            </t03>
        </t02>
    </t01>
</root> 
```

我正在使用 XSLT 2.0，我对递归地申请 for-each-group 感到厌烦。感谢您的时间和麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:57:24.900

对于 XSLT 2.0，我强烈建议将`for-each-grouping`与递归函数或模板一起使用；下面是一个使用函数的示例：

```
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="2.0"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:mf="http://example.com/mf"
  exclude-result-prefixes="xs mf">

<xsl:output indent="yes"/>

<xsl:function name="mf:group" as="element()*">
  <xsl:param name="elements" as="element(row)*"/>
  <xsl:param name="level" as="xs:integer"/>
  <xsl:for-each-group select="$elements" group-starting-with="row[t0 = $level]">
    <xsl:element name="t{format-number($level, '00')}">
      <xsl:copy-of select="* except t0"/>
      <xsl:sequence select="mf:group(current-group() except ., $level + 1)"/>
    </xsl:element>
  </xsl:for-each-group>
</xsl:function>

<xsl:template match="root">
  <xsl:copy>
    <header>List</header>
    <xsl:sequence select="mf:group(row, 1)"/>
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:18:11.353

请试一试：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/root">
    <root>
      <header>List</header>
      <xsl:apply-templates select="row[t0 = 1]" />
    </root>
  </xsl:template>

  <xsl:template match="row">
    <xsl:variable name="level" select="t0" />

    <xsl:element name="{concat('t0', $level)}">
      <xsl:apply-templates select="title | note" />
      <xsl:variable name="nextPeer" 
            select="following-sibling::row[t0 &lt;= $level]" />
      <xsl:variable name="children" 
            select="following-sibling::row[t0 = $level + 1][not($nextPeer) 
                 or (count(preceding-sibling::row) &lt; count($nextPeer[1]/preceding-sibling::row))]" />

      <xsl:apply-templates select="$children" />
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

# android - 制作一个自定义的 android ListView 适配器可点击

> ID：14341147
> 
> 赞同：0
> 
> 时间：2013-01-15T15:35:27.237
> 
> 标签：android, image, listview, customization, clickable

我一直在尝试创建一个可点击的列表视图，它接收一个字符串数组和一些图像，并以文本视图样式呈现它们。到目前为止，我已经设法为每个字符串和图像创建了一个列表视图，但是我不确定如何使用 onClick 方法来使文本视图可点击以开始新的活动等。

到目前为止，这是我的代码（不包括 XML）：

```
public class MySimpleArrayAdapter extends ArrayAdapter<String> {
    private final Context context;
    private final String[] values;

    public MySimpleArrayAdapter(Context context, String[] values) {
    super(context, R.layout.activity_test2, values);
    this.context = context;
    this.values = values;
}

    /* Print a toast when a list item is clicked, don't know what to do */
 public void onClick() {
    switch (list item) {
    case 0:
        Toast.makeText(this.context, "Pressed!", Toast.LENGTH_LONG).show()
        break;
    }
            case 1:
                    etc....

} 

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View rowView = inflater.inflate(R.layout.activity_test2, parent, false);
    TextView textView = (TextView) rowView.findViewById(R.id.label);
    ImageView imageView = (ImageView) rowView.findViewById(R.id.icon);
    textView.setText(values[position]);

    String s = values[position];
    if (s.startsWith("Report a Road Delay")) {
        imageView.setImageResource(R.drawable.ic_menu_compose);
    } else if (s.startsWith("View Reported Delays")) {
        imageView.setImageResource(R.drawable.ic_menu_view);
    } else if (s.startsWith("Search a Road for Delays")) {
        imageView.setImageResource(R.drawable.ic_menu_search);
    } else if (s.startsWith("Update a Delay Report")) {
        imageView.setImageResource(R.drawable.ic_menu_edit);
    } else if (s.startsWith("Validate a Delay Report")) {
        imageView.setImageResource(R.drawable.ic_menu_mark);

    }
    return rowView;
  }
}

 public class MainActivity extends ListActivity {
public void onCreate(Bundle SavedInstanceState) {
    super.onCreate(SavedInstanceState);
    String[] values = new String[] { "Report a Road Delay",
            "View Reported Delays", "Search a Road for Delays",
            "Update a Delay Report", "Validate a Delay Report" };
    MySimpleArrayAdapter adapter = new MySimpleArrayAdapter(this, values);
    setListAdapter(adapter);

}

 } 
```

这是到目前为止的样子：

![在此处输入图像描述](../Images/56bc82f3d5c027c2a8fbdeddd85695cb.png)

我基本上不明白的是 onClick 方法；它需要什么参数，以及如何确定单击了哪个项目。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:45:24.970

试试这个：

```
ListView list1 = getListView();

list1.setOnItemClickListener(
        new OnItemClickListener()
        {
            @Override
            public void onItemClick(AdapterView<?> arg0, View view,
                    int position, long id) {

                         //Take action here.
                 }
            }
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T15:37:09.670

您正在寻找[OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)而不是 OnClickListener

```
 lv.setOnItemClickListener(new OnItemClickListener(){

    @Override
    public void onItemClick(AdapterView<?> parent, View v, int position, long id) {   
         // DO SOMETHING WITH CICK EVENT HERE
    }
 } 
```

现在只讨论参数：

```
parent   The AdapterView where the click happened.
view     The view within the AdapterView that was clicked
position The position of the view in the adapter.
id       The row id of the item that was clicked. 
```

我从android参考中得到了最后一部分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:47:28.663

您可以使用以下代码：

```
lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {

        public void onItemClick(AdapterView<?> parentAdapter, View view, int position,
                long id) {

            // We know the View is a <extView so we can cast it
            TextView clickedView = (TextView) view;

            Toast.makeText(MainActivity.this, "Item with id ["+id+"] - Position ["+position+"] - Planet ["+clickedView.getText()+"]", Toast.LENGTH_SHORT).show();

        }
       });

      // we register for the contextmneu        
      registerForContextMenu(lv);
    } 
```

其中 lv 是列表视图。如果要添加上下文菜单：

```
 // We want to create a context Menu when the user long click on an item
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {

    super.onCreateContextMenu(menu, v, menuInfo);
    AdapterContextMenuInfo aInfo = (AdapterContextMenuInfo) menuInfo;

    // We know that each row in the adapter is a Map
    Planet planet =  aAdpt.getItem(aInfo.position);

    menu.setHeaderTitle("Options for " + planet.getName());
    menu.add(1, 1, 1, "Details");
    menu.add(1, 2, 2, "Delete");

}

// This method is called when user selects an Item in the Context menu
@Override
public boolean onContextItemSelected(MenuItem item) {
    int itemId = item.getItemId();
    AdapterContextMenuInfo aInfo = (AdapterContextMenuInfo) item.getMenuInfo();
    planetsList.remove(aInfo.position);
    aAdpt.notifyDataSetChanged();
    return true;
} 
```

[如果您想了解更多信息，请在此处](http://www.survivingwithandroid.com/2012/10/android-listviewarrayadapter-and.html)和[此处](https://github.com/survivingwithandroid/Surviving-with-android/tree/master/SimpleList/src/com/survivingwithandroid/listview/SimpleList)查看我的博客

# javascript - 在 JavaScript 中计算页面加载时间

> ID：14341156
> 
> 赞同：81
> 
> 时间：2013-01-15T15:36:16.197
> 
> 标签：javascript, load, setinterval

我正在尝试制作一个网页，当它开始加载时，它使用间隔来启动计时器。

当页面完全加载时，它会停止计时器，

但是 99% 的时间我得到 0.00 或 0.01 的时间测量值，即使它需要更长的时间。

有时，它会说一些更有意义的东西，例如 0.28 或 3.10。

如果有帮助，这里是代码：

```
var hundredthstimer = 0;
var secondplace = 0;

function addinc(){

    hundredthstimer += 1;
    if (inctimer == 100){
        hundredthstimer = 0;
        secondplace += 1;
    }

}

var clockint = setInterval(addinc, 10);

function init(){
    var bconv1 = document.getElementById("bconverter1");
    var bconv2 = document.getElementById("bconverter2");

    $(bconv2).hide();

    clearInterval(clockint);

    if (inctimer.len !== 2){
        inctimer = "0" + inctimer;
    }
    alert(secondplace + "." + inctimer);
}
onload = init; 
```

因此，它基本上创建了一个名为 percentthstimer 的变量，每 10 毫秒（0.01 秒）增加“1”。

然后，如果这个数字达到 1000（1 整秒），则名为 secondsplace 的变量会增加 1，因为这是它运行了多少整秒。

然后，它会提示秒位、小数点和百分位作为总加载时间。

但是上面数字不正确的问题仍然存在。为什么？

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2013-02-14T15:40:01.107

为什么这么复杂？什么时候可以做：

```
var loadTime = window.performance.timing.domContentLoadedEventEnd- window.performance.timing.navigationStart; 
```

如果您需要更多时间，请查看 window.performance 对象：

```
console.log(window.performance); 
```

将向您显示计时对象：

```
connectEnd                 Time when server connection is finished.
connectStart               Time just before server connection begins.
domComplete                Time just before document readiness completes.
domContentLoadedEventEnd   Time after DOMContentLoaded event completes.
domContentLoadedEventStart Time just before DOMContentLoaded starts.
domInteractive             Time just before readiness set to interactive.
domLoading                 Time just before readiness set to loading.
domainLookupEnd            Time after domain name lookup.
domainLookupStart          Time just before domain name lookup.
fetchStart                 Time when the resource starts being fetched.
loadEventEnd               Time when the load event is complete.
loadEventStart             Time just before the load event is fired.
navigationStart            Time after the previous document begins unload.
redirectCount              Number of redirects since the last non-redirect.
redirectEnd                Time after last redirect response ends.
redirectStart              Time of fetch that initiated a redirect.
requestStart               Time just before a server request.
responseEnd                Time after the end of a response or connection.
responseStart              Time just before the start of a response.
timing                     Reference to a performance timing object.
navigation                 Reference to performance navigation object.
performance                Reference to performance object for a window.
type                       Type of the last non-redirect navigation event.
unloadEventEnd             Time after the previous document is unloaded.
unloadEventStart           Time just before the unload event is fired. 
```

[浏览器支持](http://caniuse.com/#feat=nav-timing)

[更多信息](http://msdn.microsoft.com/en-US/en-en/library/ie/hh673552%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2013-01-15T17:16:43.337

永远不要使用`setInterval`or`setTimeout`函数来测量时间！它们不可靠，很可能是文档解析和显示过程中的JS执行调度延迟。

相反，使用该[`Date`对象](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)在页面开始加载时创建时间戳，并计算与页面完全加载时间的差异：

```
<doctype html>
<html>
    <head>
        <script type="text/javascript">
            var timerStart = Date.now();
        </script>
        <!-- do all the stuff you need to do -->
    </head>
    <body>
        <!-- put everything you need in here -->

        <script type="text/javascript">
             $(document).ready(function() {
                 console.log("Time until DOMready: ", Date.now()-timerStart);
             });
             $(window).load(function() {
                 console.log("Time until everything loaded: ", Date.now()-timerStart);
             });
        </script>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-01-05T12:27:26.627

@HaNdTriX 提到的答案很好，但我们不确定 DOM 是否在下面的代码中完全加载：

```
var loadTime = window.performance.timing.domContentLoadedEventEnd- window.performance.timing.navigationStart; 
```

当与 onload 一起使用时，这非常有效：

```
window.onload = function () {
    var loadTime = window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart; 
    console.log('Page load time is '+ loadTime);
} 
```

**编辑1：**添加了一些上下文来回答

**注意：** `loadTime` 以毫秒为单位，您可以除以 1000 得到秒，如 @nycynik 所述

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-23T02:30:48.987

很难做出好的计时，因为[performance.dominteractive 计算错误](https://developer.akamai.com/blog/2017/12/04/beware-performancetimingdominteractive)（无论如何，对于计时开发人员来说，这是一个有趣的链接）。

当 dom 被解析时，它仍然可以加载和执行延迟脚本。并且等待 css（css 阻塞 dom）的内联脚本也必须加载，直到[DOMContentloaded](https://varvy.com/performance/domcontentloaded.html)。所以它还没有被解析？

我们有[readystatechange](https://developer.mozilla.org/en-US/docs/Web/API/Document/readystatechange_event)事件，我们可以查看[readyState](https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState)不幸的是缺少“dom is parsed”，它发生在“loaded”和“interactive”之间。

如果 Timing API 没有给我们一个 dom 停止解析 HTML 并启动[The End](https://html.spec.whatwg.org/multipage/parsing.html#the-end)进程的时间，那么一切都会变得有问题。**该标准说第一点必须是在 dom解析**后精确地触发“交互式” ！[当文档](https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState)**在解析后的某个时间完成[**加载**](https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState)时，Chrome 和 FF 都实现了它。他们似乎（错误地）解释了标准，因为解析继续超出了延迟执行的脚本，而人们将 DOMContentLoaded 误解为在延迟执行之前而不是之后发生的事情。反正...**

 **我给你的建议是阅读[Navigation](https://developer.mozilla.org/en-US/docs/Web/API/Navigation_timing_API) Timing API 。或者用简单的方法选择其中的一个，或者运行所有三个并在浏览器控制台中查看......

```
 document.addEventListener('readystatechange', function() { console.log("Fiered '" + document.readyState + "' after " + performance.now() + " ms"); });

  document.addEventListener('DOMContentLoaded', function() { console.log("Fiered DOMContentLoaded after " + performance.now() + " ms"); }, false);

  window.addEventListener('load', function() { console.log("Fiered load after " + performance.now() + " ms"); }, false); 
```

时间以文档开始后的毫秒数为单位。我已经使用[NavigationTiming API](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/domInteractive)进行了验证。

要从你做的时间开始获得秒数，`var ti = performance.now()`你可以做`parseInt(performance.now() - ti) / 1000`

而不是那种 performance.now() 减法代码通过[用户计时 API](https://developer.mozilla.org/en-US/docs/Web/API/User_Timing_API)变得更短，您在代码中设置[标记并在标记之间进行](https://developer.mozilla.org/en-US/docs/Web/API/Performance/mark)[测量](https://developer.mozilla.org/en-US/docs/Web/API/Performance/measure)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-21T11:07:55.373

这是一个给出确切值的表达式：

```
window.performance.timing.loadEventEnd-window.performance.timing.navigationStart 
```**

# c# - 如何在程序中快速加载 XML？

> ID：14341157
> 
> 赞同：3
> 
> 时间：2013-01-15T15:36:21.283
> 
> 标签：c#, .net, winforms

我正在创建一个小工具，该工具将包含 XML 的树形视图。处理具有小文件大小的 XML 文件没有问题，但是当我尝试加载大型 XML 文件（大小为 21MB）时，我的应用程序变得无响应并且需要花费太多时间来加载 XML，而且大多数时候它没有根本不加载 XML。是否有任何修复或调整以使以下代码更快？

```
public TreeView(string filename)
        {
            InitializeComponent();

            this.Text = filename;

            XmlDataDocument xmldoc = new XmlDataDocument();
            XmlNode xmlnode;
            FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
            xmldoc.Load(fs);
            xmlnode = xmldoc.ChildNodes[1];
            treeView1.Nodes.Clear();
            treeView1.Nodes.Add(new TreeNode(xmldoc.DocumentElement.Name));
            TreeNode tNode;
            tNode = treeView1.Nodes[0];
            AddNode(xmlnode, tNode);
        }

        private void AddNode(XmlNode inXmlNode, TreeNode inTreeNode)
        {
            XmlNode xNode;
            TreeNode tNode;
            XmlNodeList nodeList;
            int i = 0;
            if (inXmlNode.HasChildNodes)
            {
                nodeList = inXmlNode.ChildNodes;
                for (i = 0; i <= nodeList.Count - 1; i++)
                {
                    xNode = inXmlNode.ChildNodes[i];
                    inTreeNode.Nodes.Add(new TreeNode(xNode.Name));
                    tNode = inTreeNode.Nodes[i];
                    AddNode(xNode, tNode);
                }
            }
            else
            {
                inTreeNode.Text = inXmlNode.InnerText.ToString();
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:39:37.103

您必须将加载部分与构建 TreeView 分开。

然后可以在后台线程 (BackgroundWorker) 上进行加载。

与 TreeView 相关的一切都必须发生在主线程上，但您可以使用 SuspendLayout 等加速它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:39:58.890

您可以尝试对子节点使用 Parallel.ForEach 来跨核心拆分事物。不过，这将很难实现。

[http://msdn.microsoft.com/en-us/library/dd991486.aspx](http://msdn.microsoft.com/en-us/library/dd991486.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:39:48.243

对于无响应的部分，您可以将xml异步加载到BackgroundWorker中，也许构建树视图结构的整个过程都可以这样完成，并在完成后加载到控件本身中。

这可能不会大大提高速度，但它会保持 UI 响应。请记住，您不能直接从 BackgroundWorker 中运行的代码访问 UI，您必须通过 Dispatcher 调用它，如下所示：

```
this.Dispatcher.Invoke(DispatcherPriority.Normal, new Action(() =>
{
     // Execute code that works with UI controls
})); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T17:44:19.243

首先，在处理大文件时，您应该真正切换到类似 SAX 的方法。请参阅[在 C# 代码中解析（大）XML 的最佳方法是什么？](https://stackoverflow.com/questions/676274/what-is-the-best-way-to-parse-big-xml-in-c-sharp-code)一种可能的解决方案。

现在，您有一种可靠的方法来读取文件，无论文件有多大，都不会导致系统崩溃。

下一步是填充您的树视图，如前所述，您需要在单独的线程中执行此操作，我建议使用[后台](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)工作人员，因为它们非常易于使用。

至于在发生更改时更新 UI，我不熟悉 winforms，但如果它支持[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms748365.aspx)，我建议使用 thou。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T15:49:49.023

不要使用`XmlDataDocument`，而是更改要使用的代码，`XmlReader`因为此类在处理 XML 文件时提供了最高性能。XmlReader 是一个抽象类，可以从文件或任何其他数据流中读取。从文件中读取时，您不会一次加载整个文档。

更多信息在这里：shanselman 或这里的[快速概述](http://www.hanselman.com/blog/AtAGlanceXmlReaderVsXPathNavigatorVsXmlDocument.aspx)[性能：LINQ to XML vs XmlDocument vs XmlReader](http://www.nearinfinity.com/blogs/joe_ferner/performance_linq_to_sql_vs.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T15:44:48.903

两个小建议：不要添加节点然后查找它，而是在临时变量中创建它，然后从那里使用它。您可以使用`foreach`循环而不是`for`循环。

代替

```
nodeList = inXmlNode.ChildNodes;
for (i = 0; i <= nodeList.Count - 1; i++)
{
    xNode = inXmlNode.ChildNodes[i];
    inTreeNode.Nodes.Add(new TreeNode(xNode.Name));
    tNode = inTreeNode.Nodes[i];
    AddNode(xNode, tNode);
} 
```

和

```
foreach (var node in inXmlNode.ChildNodes)
{
    tNode = new TreeNode(node.Name);
    inTreeNode.Nodes.Add(tNode);
    AddNode(node, tNode);
} 
```

我怀疑它会产生很大的不同，但它可能会有所帮助。

# java - Scala Spring检查空片段

> ID：14341159
> 
> 赞同：0
> 
> 时间：2013-01-15T15:36:25.163
> 
> 标签：java, scala, spring-security

我正在对 Java/Scala/Spring 项目进行大型 Java/Spring 重写。所以我只想检查这是否是正确的做法。

我从 SecuritContext 获取 Spring 用户详细信息。以下代码针对已登录和未登录的用户调用。我想检查检查是否`null`正确。请告知，因为检查这样的空值感觉不对。

```
private def getUserDetails : Option[UserDetails] = {
  if(userDetails == null && securityContextFacade.getSecurityContext.getAuthentication != null){
    val details = securityContextFacade.getSecurityContext.getAuthentication.getPrincipal
    userDetails = details.asInstanceOf[UserDetails]
  }
  if(userDetails != null){
    Option(userDetails)
  }
  else{
    None
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:39:40.997

没有必要进行后面的检查，因为 Option(...) 已经在内部进行了检查，并且在 null 的情况下评估为 None。所以

```
if(userDetails != null){
    Option(userDetails)
  }
else{
    None
} 
```

可以写成

```
Option(userDetails) 
```

# android - Android加载活动堆栈，与后退按钮

> ID：14341166
> 
> 赞同：2
> 
> 时间：2013-01-15T15:36:31.040
> 
> 标签：android, back-button, activity-stack

目前关于后退按钮的最佳做法是什么？

许多应用程序在您打开它们时会保存和恢复整个活动堆栈（在它们已经 onStop 和 onDestroyed 之后），以 Facebook 为例，当您打开它并且您的最后一个位置在照片中时，然后按回不会关闭 Facebook 应用程序，它会无限地回到您几天前打开该应用程序时所做的第一件事。

我认为，这种设计约定与后退按钮的预期功能有些不同。它通常用于终止应用程序或停止将您带回设备启动器屏幕的主视图。

Facebook 只是这样做的应用程序的一个例子。

是否有开发人员文章或像 Google I/O 这样的权威来源讨论此功能的实用性（恢复活动堆栈并让后退按钮遍历它们）与其他功能（杀死视图将用户从应用程序中退出）？如果是这样，请在此处讨论并链接它们。我希望这不会被认为太主观，因为有正确使用后退按钮以及错误使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:52:54.527

Facebook 应用实际上所做的是 Android 的基本默认行为。这些应用程序对这种行为没有做任何特别的事情。默认情况下会保存 Activity 堆栈。

关于它的引用较多的博客之一是[CommonsWare 的 BACK 表示 Back](http://commonsware.com/blog/2011/07/21/back-means-back.html)。基本上，“返回”按钮的功能意味着它应该将您带到您刚才所在的上一页。在 Android 中，这通常是您刚刚推送的最后一个 Activity。如果用户想离开应用程序，那么他或她可以按下“HOME”按钮，这将**始终**推动 Activity 堆栈并将用户带到主屏幕。

这意味着，BACK 按钮的功能完全取决于相关应用程序，但其概念是反转用户刚刚执行的操作。如果你在玩游戏，你会去一个子菜单，BACK 按钮应该把你带到顶部菜单。如果您在浏览器中，“返回”按钮可能会将您带到您查看的最后一个网页。如果您在浏览器中并且您在首页，则用户可能希望 BACK 按钮关闭应用程序，因为用户在打开浏览器之前所做的最后一个操作是打开应用程序。如果用户开始下载，BACK 按钮可能会取消它。

One functionality improvement that Facebook and others like is may consider is to wipe the stack after **x** number of days since the user may not remember exactly what they did since being interrupted from the last use. The use case for this is very small though.

Overall, this is why people always stress usability testing. You have to figure out what 99% of the people of the app expected when they press the back button.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T15:53:34.237

您可以在 Android 开发者网站上找到不应更改后退按钮的预期行为。让操作系统处理后退按钮。

> App 没有重新定义系统图标的预期功能（如返回按钮）。

该报价是从他们的核心应用[质量页面](http://developer.android.com/distribute/googleplay/quality/core.html)中提取的。

您应该考虑使用向上导航。[您可以在此处](http://developer.android.com/design/patterns/navigation.html)阅读有关为其设计的更多信息：

最后，这是一个关于如何实现各种类型导航（横向、祖先 [向上]、时间、后代）的教程。[在这里](http://developer.android.com/training/implementing-navigation/index.html)检查

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:06:44.090

我认为这种行为取决于应用程序逻辑。默认情况下，希望在前一个屏幕上移动（返回堆栈中的活动，或者如果它被保存到片段的返回堆栈中的片段）。实际上，这种情况没有任何灵丹妙药。只需使用您想要的“背压实现”即可。我的观点是，在后按时，应用程序必须以先前的逻辑状态显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T15:44:30.383

根据我的个人经验，您可以通过长按后退按钮来关闭大多数使用后按进入上一个屏幕的屏幕。
最好的例子是浏览器应用程序，无论是原生浏览器还是第三方浏览器

# sql-server - 使用 bcp 写入文件时 XML 输出未格式化

> ID：14341167
> 
> 赞同：1
> 
> 时间：2013-01-15T15:36:38.280
> 
> 标签：sql-server, xml, bcp

我有在 sql server 中创建一个 xml 并且工作正常的查询，问题是我需要将它保存到一个文件中。当我这样做时，格式会损坏。

```
SELECT mydata.dbo.tblBooking.ID, mydata.dbo.tblBooking.ReservationID,     mydata.dbo.tblBooking.EventName, mydata.dbo.tblBooking.TimeEventStart, mydata.dbo.tblBooking.TimeEventEnd, mydata.dbo.tblRoom.Room,
mydata.dbo.tblReservation.TempContact, mydata.dbo.tblGroup.GroupName, mydata.dbo.tblUserDefinedField.FieldValue, mydata.dbo.tblEventType.Description

FROM

mydata.dbo.tblBooking INNER JOIN mydata.dbo.tblReservation ON mydata.dbo.tblBooking.ReservationID = mydata.dbo.tblReservation.ID

INNER JOIN mydata.dbo.tblEventType ON mydata.dbo.tblBooking.EventTypeID = mydata.dbo.tblEventType.ID

INNER JOIN mydata.dbo.tblGroup ON mydata.dbo.tblReservation.GroupID = mydata.dbo.tblGroup.ID

INNER JOIN mydata.dbo.tblUserDefinedField ON mydata.dbo.tblBooking.ReservationID = mydata.dbo.tblUserDefinedField.ParentID

INNER JOIN mydata.dbo.tblRoom ON mydata.dbo.tblBooking.RoomID = mydata.dbo.tblRoom.ID

where mydata.dbo.tblBooking.TimeEventStart between '2012-11-1' and '2012-12-20'

for xml Raw ,elements , ROOT ('EMSExport') 
```

这是输出

```
<EMSExport>
  <row>
    <ID>10891</ID>
    <ReservationID>431</ReservationID>
    <EventName>Bowery Mission Trip Wrap Party</EventName>
    <TimeEventStart>2012-11-08T17:45:00</TimeEventStart>
    <TimeEventEnd>2012-11-08T19:30:00</TimeEventEnd>
    <Room>6-Conference </Room>
    <TempContact>Keith Yagnik</TempContact>
    <GroupName>Outreach</GroupName>
    <FieldValue></FieldValue>
    <Description>Meeting</Description>
  </row>
  <row>
    <ID>10894</ID>
    <ReservationID>434</ReservationID>
    <EventName>SBJ Meeting</EventName>
    <TimeEventStart>2012-11-06T11:45:00</TimeEventStart>
    <TimeEventEnd>2012-11-06T12:30:00</TimeEventEnd>
    <Room>6-Conference </Room>
    <TempContact></TempContact>
    <GroupName>Staff</GroupName>
    <FieldValue></FieldValue>
    <Description>Meeting</Description>
  </row>
  <row>
    <ID>10888</ID>
    <ReservationID>428</ReservationID>
    <EventName>PCUSA missionary Cobbie Palm</EventName>
    <TimeEventStart>2012-11-04T09:30:00</TimeEventStart>
    <TimeEventEnd>2012-11-04T10:30:00</TimeEventEnd>
    <Room>5-Corning Logan </Room>
    <TempContact>Kate Dunn</TempContact>
    <GroupName>Adult Education</GroupName>
    <FieldValue></FieldValue>
    <Description>Event</Description>
  </row> 
```

这是保存文件的过程

```
declare @cmd nvarchar(2000);
select @cmd = 'bcp "EXEC EMSXMLraw" queryout "C:\testraw.xml" -x -c -t, -T -S MYshel\EM'
exec xp_cmdshell @cmd 
```

这是输出文件的格式

```
<EMSExport><row><ID>10891</ID><ReservationID>431</ReservationID><EventName>Bowery Mission Trip Wrap Party</EventName><TimeEventStart>2012-11-08T17:45:00</TimeEventStart><TimeEventEnd>2012-11-08T19:30:00</TimeEventEnd><Room>6-Conference </Room><TempContact>Keith Yagnik</TempContact><GroupName>Outreach</GroupName><FieldValue></FieldValue><Description>Meeting</Description></row><row><ID>10894</ID><ReservationID>434</ReservationID><EventName>SBJ Meeting</EventName><TimeEventStart>2012-11-06T11:45:00</TimeEventStart><TimeEventEnd>2012-11-06T12:30:00</TimeEventEnd><Room>6-Conference </Room><TempContact></TempContact><GroupName>Staff</GroupName><FieldValue></FieldValue><Description>Meeting</Description></row><row><ID>10888</ID><ReservationID>428</ReservationID><EventName>PCUSA missionary Cobbie Palm</EventName><TimeEventStart>2012-11-04T09:30:00</TimeEventStart><TimeEventEnd>2012-11-04T10:30:00</TimeEventEnd><Room>5-Corning Logan </Room><TempContact>Kate Dunn</TempContact><GroupName>Adult Education</GroupName><FieldValue></FieldValue><Description>Event</Description></row><row><ID>10263</ID><ReservationID>372</ReservationID><EventName>AA Christmas Lunch </EventName><TimeEventStart>2012-12-13T11:30:00</TimeEventStart><TimeEventEnd>2012-12-13T14:30:00</TimeEventEnd><Room>2-Bonnell </Room><TempContact>jimenez@amexclusive.com</TempContact><GroupName>Alcoholics Anonymous </GroupName><FieldValue>THISISTHEWEBDESCRIPTION</FieldValue><Description>Event</Description></row><row><ID>10817</ID><ReservationID>391</ReservationID><EventName>E.S.N. General Meeting</EventName><TimeEventStart>2012-11-13T18:30:00</TimeEventStart><TimeEventEnd>2012-11-13T20:30:00</TimeEventEnd><Room>3-Jones </Room><TempContact></TempContact><GroupName>FAPC</GroupName><FieldValue>Emergency Network of Shelters General Meeting</FieldValue> 
```

如您所见，所有 XML 格式都丢失了，我该如何保留它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T15:02:29.627

BCP 实用程序不保留 XML 文件的格式，要格式化和缩进文件，请使用 notepad++ 等程序“漂亮地打印”xml 文件。

# javascript - 增加对 AND 运算符的理解

> ID：14341168
> 
> 赞同：2
> 
> 时间：2013-01-15T15:36:47.967
> 
> 标签：javascript

我一直在使用[MDN Docs - Logical Operators](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators)作为理解逻辑 AND 运算符的参考框架。

我已经理解了这些代码示例中的大部分，尤其是前 4 个，如下所示：

```
a1=true && true       // t && t returns true
a2=true && false      // t && f returns false
a3=false && true      // f && t returns false
a4=false && (3 == 4)  // f && f returns false
a5="Cat" && "Dog"     // t && t returns Dog
a6=false && "Cat"     // f && t returns false
a7="Cat" && false     // t && f returns false 
```

但是我有问题理解`a5`，`a6`并且`a7`。

我无法理解这两个字符串`a5="Cat" && "Dog"`是如何评估的`true && true returns Dog`

我也无法理解为什么字符串“Cat”作为`a6=false && "Cat" // f && t returns false`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:40:18.640

所有非空字符串`true`在评估为布尔值时。

在`a6=false && "Cat"`字符串 "Cat" 中根本不求值，因为左侧是`false`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T15:45:15.750

首先让我们看一下a5：

```
a5="Cat" && "Dog" 
```

返回`dog`，mdn-docs 声明 AND(&&)：

> 如果可以转换为 false，则返回 expr1；否则，返回 expr2。因此，当与布尔值一起使用时，如果两个操作数都为真，则 && 返回真；否则，返回 false。

由于非空字符串不能转换为false，所以它会返回`dog`，如果你改变and的顺序`dog`，`cat`它当然会返回`cat`。

在 a6 false 中，是 false，因此它因此返回`false`：

> 如果可以转换为 false，则返回 expr1...

在 a7`cat`中为真，因此它继续到下一个为假的表达式，因此返回假。

> ...否则，返回 expr2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:42:58.793

在`a && b`句子`a`中首先评估，如果`a`是`true`，则`b`评估。

1.  `(a5 = "Cat")`返回`"Cat"`which is `true`（只有空字符串是`false`），所以`Dog`返回。
2.  `(a6 = false)`返回，因此不评估`false`第二部分。`"Cat"`
3.  `(a7 = "Cat")`是`true`，所以返回第二`false`部分。

# php - PHP/PSQL/SQL 资源是否总是在成功查询时返回？

> ID：14341172
> 
> 赞同：0
> 
> 时间：2013-01-15T15:36:52.057
> 
> 标签：php, sql, resources, psql

我正在编写一些关键业务查询，并依靠 is_resource 过滤所有失败的查询（即语法错误等）

以这个查询为例：

```
$result = pg_query('SELECT * FROM logs');

if (!is_resource($result)) {
    die('Error');
} 
```

`die('Error')`如果查询有效但没有返回行，那也会吗？即使没有从数据库返回任何行，我也需要它来返回资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:40:11.870

如果没有错误，就会有资源。要检查行，您需要使用[pg_num_rows](http://php.net/manual/en/function.pg-num-rows.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:38:58.423

来自 php.net 的引用：“如果发生错误并返回 FALSE，如果连接有效，则可以使用 pg_last_error() 函数检索错误的详细信息。” “成功时的查询结果资源或失败时的 FALSE。”

听起来只要没有错误，结果总会有资源。

# css - 覆盖 Tapestry Grid 组件列排序图标

> ID：14341188
> 
> 赞同：1
> 
> 时间：2013-01-15T15:37:43.447
> 
> 标签：css, tapestry

Tapestry Grid 组件中的默认列排序图标是蓝色和白色。如果您的页面上有不同的配色方案，则需要对其进行自定义。

用您自己的自定义图标覆盖 Tapestry Grid 列排序图标的最佳方法是什么？

我正在使用 Tapestry 5.3.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T21:14:05.703

图标被定义为常量，您可以在应用程序的模块类（通常是 AppModule.java）中的contributeApplicationDefaults 方法中覆盖它们，如下所示：

```
 configuration.add(ComponentParameterConstants.GRIDCOLUMNS_ASCENDING_ASSET, "pathtofile"); 
```

其他两个常量是 GRIDCOLUMNS_DESCENDING_ASSET 和 GRIDCOLUMNS_SORTABLE_ASSET。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:10:27.283

我用css做这个。实际上，我将排序图像全部隐藏在一起，并在标题标题链接中使用了背景图像。但是，只要您的规则具有更高的特异性，您就可以以任何您想要的方式覆盖默认 css。

```
table.t-data-grid thead tr th a img.t-sort-icon {
   display: none !important;
}

table.t-data-grid thead tr th a {
   background-image: url(relative/path/to/your/custom/image.gif);
} 
```

# php - ON DUPLICATE KEY 插入新行而不是更新

> ID：14341189
> 
> 赞同：0
> 
> 时间：2013-01-15T15:37:44.777
> 
> 标签：php, mysql

我有一个小问题。

这是我得到的 SQL 代码：

```
INSERT INTO matches (match_id, league_name, league_id, test_one) 
VALUES (866860, 'Portugal',1,'testing') 
ON DUPLICATE KEY 
UPDATE league_name = 
  CASE match_id 
    WHEN 866860 
      THEN 'Portugal' END, 
league_id = 
  CASE match_id 
    WHEN 866860 
      THEN 1 END, 
test_one = 
  CASE match_id 
    WHEN 866860 
      THEN 'testing' END 
```

问题是，它总是插入新行而不是更新现有行。是不是因为我需要将“match_id”设置为`AUTO_INCREMENT`或其他任何内容（目前，我的“id”字段是`AUTO_INCREMENT`）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T15:44:29.900

`AUTO_INCREMENT`在这里无关紧要。但是[ON DUPLICATE **KEY**](http://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html)需要一个密钥。更具体地说，唯一键，例如主键或唯一索引。

鉴于列名，我怀疑它`match_id`不是主键。

**更新：**您还编写了一组复杂的`CASE ... END`构造。看看[VALUES()](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_values)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:47:20.457

您正在告诉您的数据库更新“ON DUPLICATE KEY”信息；如果其他字段都不是唯一键，则数据库将插入一个新行。

您可以`id`在此查询之前选择（或使其成为子查询）或向该表添加另一个键，这将为每一行生成一个唯一值。我不知道您的架构，但您也许可以创建一个跨度`match_id`和`league_id`.

# c# - 从 DataTable 继承并从 DataTable 复制数据

> ID：14341193
> 
> 赞同：0
> 
> 时间：2013-01-15T15:37:56.760
> 
> 标签：c#, datatable

我有以下课程：

```
public class ExcelStaticDataTable : DataTable
 {
        public ExcelStaticDataTable(string tableName): base(tableName)
        {

        }

 } 
```

另一方面，我有一个返回 DataTable 的方法：

```
public DataTable Foo()
{
    return new DataTable();
} 
```

让我们想象一下，`Foo`返回一个填充的数据表，我想要的是使用该方法`Foo`，填充我的其他类型，如：

```
ExcelStaticDataTable specialtable=new ExcelStaticDataTable("table1");
specialtable.DefaultView.Table=Foo(); 
```

或者

```
ExcelStaticDataTable specialtable=new ExcelStaticDataTable("table1");
specialtable=(ExcelStaticDataTable)Foo().Copy(); 
```

.Net 中是否有任何实现用于用`DataTable`实例填充我的派生类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:43:15.387

不，您不能将其分配给`DataTable`继承的类的另一个实例`DataTable`。您需要将所有值复制到另一个表中。因此，您可以使用[`DataTable.Merge`](http://msdn.microsoft.com/en-us/library/system.data.datatable.merge.aspx).

```
specialtable.Merge(Foo()); // same as t1.Merge(t2, false, MissingSchemaAction.Add); 
```

# svn - Centos 6 上的 Subversion Edge Java WrapperManager 错误

> ID：14341194
> 
> 赞同：0
> 
> 时间：2013-01-15T15:37:59.717
> 
> 标签：svn, jvm, openjdk, subversion-edge

我刚刚安装了新的 CentOS 6.3，现在尝试运行 CollabNet Subversion Edge 3.2.2。在自述文件中，我使用用户帐户提取了源（所有者现在是用户，而不是像以 root 身份提取的 7nnn）。

对于 Java，我已经安装了 java-1.6.0-openjdk

bin/csvn install
- 运行顺利
bin/csvn 控制台
- 带来了这个：

```
[root@svn-dev-co6 csvn]# bin/csvn console  
Running CSVN Console...  
wrapper  | --> Wrapper Started as Console  
wrapper  | Java Service Wrapper Community Edition 32-bit 3.4.1  
wrapper  |   Copyright (C) 1999-2010 Tanuki Software, Ltd.  All Rights Reserved.  
wrapper  |     http://wrapper.tanukisoftware.org  
wrapper  |  
wrapper  | Command[0] : /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/bin/java  
wrapper  | Command[1] : -XX:MaxPermSize=128m  
wrapper  | Command[2] : -Djetty.home=../appserver  
wrapper  | Command[3] : -Djetty.port=3343  
wrapper  | Command[4] : -Djetty.ssl.port=4434  
wrapper  | Command[5] : -Xms64m  
wrapper  | Command[6] : -Xmx512m  
wrapper  | Command[7] : -Djava.library.path=../lib  
wrapper  | Command[8] : -classpath  
wrapper  | Command[9] : ../lib/wrapper.jar  
wrapper  | Command[10] : -Dwrapper.key=TOmk3EllD5MzqPTW  
wrapper  | Command[11] : -Dwrapper.port=32000  
wrapper  | Command[12] : -Dwrapper.jvm.port.min=31000  
wrapper  | Command[13] : -Dwrapper.jvm.port.max=31999  
wrapper  | Command[14] : -Dwrapper.pid=16065  
wrapper  | Command[15] : -Dwrapper.version=3.4.1  
wrapper  | Command[16] : -Dwrapper.native_library=wrapper  
wrapper  | Command[17] : -Dwrapper.cpu.timeout=10  
wrapper  | Command[18] : -Dwrapper.jvmid=1  
wrapper  | Command[19] : org.tanukisoftware.wrapper.WrapperJarApp  
wrapper  | Command[20] : ../appserver/start.jar  
wrapper  | Launching a JVM...  
jvm 1    | WrapperManager: Initializing...  
jvm 1    | WrapperManager Error: Failed to connect to the Wrapper at port 32000\.    Cause:     java.net.ConnectException: Connection refused  
jvm 1    | WrapperManager Error: Exiting JVM...  
wrapper  | JVM exited while loading the application. 
```

测试java二进制+变量：

```
sh-4.1$ /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/bin/java -version
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.5) (rhel-1.50.1.11.5.el6_3-i386)
OpenJDK Client VM (build 20.0-b12, mixed mode)
sh-4.1$ $JAVA_HOME
sh: /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre: ist ein Verzeichnis.
sh-4.1$ $JAVA_HOME/bin/java -version
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.5) (rhel-1.50.1.11.5.el6_3-i386)
OpenJDK Client VM (build 20.0-b12, mixed mode) 
```

任何建议或提示要找出，为什么 Wrapper/JVM 没有启动？

data/logs/ 为空 将 csvn-wrapper.conf 日志级别设置为调试并没有改变任何东西，甚至更短的输出（不再有命令）。

谢谢，马克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:44:02.403

我还没有看到，但是我只在 Linux 上使用了 Sun/Oracle 1.6 JVM。我已成功使用 OpenJDK 7。

为了您的安心，请注意 csvn install 仅将启动脚本复制到 /etc/init.d。真的没有别的了。

如输出开头所述，“包装器”是 Java 服务包装器。也许他们的社区论坛有一些答案。

# javascript - 对 Twitter API 进行经过身份验证的调用以避免速率限制

> ID：14341195
> 
> 赞同：0
> 
> 时间：2013-01-15T15:38:01.157
> 
> 标签：javascript, ajax, twitter

我正在使用 Twitter API 在我的页面上显示来自 4 个不同用户的最新推文。看起来在特定数量的调用之后，我收到“NetworkError：400 Bad Request”错误并且不会显示推文。

在线阅读该主题后，我了解到避免此限制的一种方法是对 API 进行经过身份验证的调用。有谁知道这怎么可能？我正在寻找基于 Javascript 的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:41:53.630

你在使用 OAuth 吗？请参阅 Ryan Boyd 的“OAuth 2.0 入门”。

# jquery - 将对象的值存储在变量中

> ID：14341196
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:38:01.290
> 
> 标签：jquery, object, each

我正在尝试存储 packageid 等于 9 的对象的所有 dataid，请在此处查看我在 jfiddle 上的代码：

[http://jsfiddle.net/Tcwgf/](http://jsfiddle.net/Tcwgf/)

这似乎没有返回任何东西：

```
 $("h2").html(dataids); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:55:14.133

您将对象推入`localproducts`，然后将整个数组推入`catalogue`. 所以最后一个数组有 1 个包含数组的项目。

据我了解您的代码，您可以删除`localproducts`数组并直接推送到`catalogue`

[http://jsfiddle.net/Tcwgf/2/](http://jsfiddle.net/Tcwgf/2/)

```
catalogue.push({ ... });

...

$(catalogue).each(function(){  
  if (this.packageid == 3) dataids.push(this.dataid);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:44:22.053

我不知道这是否有帮助，但您可能想研究一下：[http ://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

您可以使用它找到您的 packageid 9，然后显示您想要显示的内容，现在使用 $("h2").html(dataids); 您正在尝试显示一个数组，这可能解释了为什么事情不正常；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:04:35.260

我不确定我是否完全理解你，但我认为这就是你的目标。如果不是，请解释更多。使用[.map()](http://api.jquery.com/jQuery.map/)和 .get()，您可以获得自定义对象的数组。

```
var store_products = function () {
  // get all li's that have a span.packageid with 9 as the text
  var $lis = $('span.packageid').filter(function(i,v){
       return $.trim($(v).text()) == 9;
  }).closest('li');  

  // get an array of objects properties you defined
  var x = $lis.map(function(i,v){
    var $itm = $(v);
    return {
         'dataid' : $itm.attr('data-id'), 
         'datapackage' : $itm.attr('data-package'), 
         'packageid' : $itm.children('.packageid').text()
    };
  }).get();

  // Now variable x is an array of the objects with packageid = 9
  console.log(x);
} 
```

[小提琴](http://jsfiddle.net/Prqkb/)

# asp.net - 除了 gembox.spreadsheet 和 asp.net 之外的东西

> ID：14341198
> 
> 赞同：1
> 
> 时间：2013-01-15T15:38:11.183
> 
> 标签：asp.net, validation, gembox-spreadsheet

曾经尝试使用 gembox.spreadsheet 从 asp.net 读取 excel 文档，不错的包但太贵了

任何人都知道任何其他这样的软件并不昂贵并且做同样的工作吗？

# ios - MKMapView visibleMapRect 属性的奇怪行为

> ID：14341200
> 
> 赞同：2
> 
> 时间：2013-01-15T15:38:15.970
> 
> 标签：ios, objective-c, cocoa-touch, mkmapview, mapkit

我试图设置`visibleMapRect`MKMapView 对象的属性，但结果映射 rect 不是我所期望的。

这是我的代码：

```
NSLog(@"current size %f %f", mapView.visibleMapRect.size.width, mapView.visibleMapRect.size.height);
NSLog(@"target size %f %f", newBounds.size.width, newBounds.size.height);
mapView.visibleMapRect = newBounds;
NSLog(@"new size %f %f", mapView.visibleMapRect.size.width, mapView.visibleMapRect.size.height); 
```

这是结果：

```
2013-01-15 19:21:25.440 MyApp[4216:14c03] current size 67108864.594672 46006272.643333
2013-01-15 19:21:25.441 MyApp[4216:14c03] target size 3066685.527175 2102356.690531
2013-01-15 19:21:25.442 MyApp[4216:14c03] new size 4194304.162631  2875392.126220 
```

这是什么魔法？以及如何将精确的可见矩形设置为我的地图视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:27:11.150

感谢 Anna Karenina 的评论，我找到了答案。MKMapView setVisibleMapRect 方法以最大缩放级别显示矩形以适应输入矩形并显示每个像素的地图图块像素以保持图像看起来清晰。

所以我编写了这段代码来预测 MKMapRect，它将为输入 MKMapRect 显示。

```
- (MKMapRect)expectedMapRectForMapRect:(MKMapRect)mapRect inMapView:(MKMapView*)mapView
{
    CGFloat targetPointPerPixelRatio = MAX(MKMapRectGetWidth(mapRect) / CGRectGetWidth(mapView.bounds), MKMapRectGetHeight(mapRect) / CGRectGetHeight(mapView.bounds));
    CGFloat expextedPointPerPixelRatio = powf(2, ceilf(log2f(targetPointPerPixelRatio)));

    NSLog(@"expextedPointPerPixelRatio %f", expextedPointPerPixelRatio);
    MKMapRect expectedMapRect;
    expectedMapRect.size = MKMapSizeMake(CGRectGetWidth(mapView.bounds)*expextedPointPerPixelRatio, CGRectGetHeight(mapView.bounds)*expextedPointPerPixelRatio);
    expectedMapRect.origin = MKMapPointMake(MKMapRectGetMidX(mapRect) - expectedMapRect.size.width/2, MKMapRectGetMidY(mapRect) - expectedMapRect.size.height/2);

    expectedMapRect.origin.x = roundf(expectedMapRect.origin.x / expextedPointPerPixelRatio) * expextedPointPerPixelRatio;
    expectedMapRect.origin.y = roundf(expectedMapRect.origin.y / expextedPointPerPixelRatio) * expextedPointPerPixelRatio;
    return expectedMapRect;
} 
```

# jquery - Primefaces selectOneButton：通过 JS/jquery 设置选定选项

> ID：14341203
> 
> 赞同：2
> 
> 时间：2013-01-15T15:38:22.477
> 
> 标签：jquery, jsf, primefaces, client-side

是否可以在客户端更改 JSF selectOneButton 组件的选定项？Primefaces 是否已经提供了一种方便的方法来做到这一点？

在组件上设置 'widgetVar' 属性时，对应的 JS 对象有一个方法 'select(a)' 似乎会停用以前激活的按钮，然后激活由参数 'a' 给出的新按钮：

```
select: function(a)
{
    this.buttons.filter(".ui-state-active").removeClass("ui-state-active ui-state-hover").children(":radio").removeAttr("checked");
    a.addClass("ui-state-active").children(":radio").attr("checked", "checked").change()
} 
```

但我不知道将什么设置为参数'a'。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:46:35.377

您需要传递代表`<div>`UI 中所需按钮的具体的 jQuery 对象。它们都可以通过`buttons`小部件 var 的属性获得，该属性返回一个数组。

因此，如果您需要选择第三个按钮，那么这个示例应该这样做，提供了一个小部件 var 名称`foo`：

```
foo.select($(foo.buttons[2])); 
```

请注意，这似乎是一种内部方法（没有使用模块模式隐藏）并且没有记录在用户指南中，因此它会受到未来 PF 版本中未记录的更改的影响。

# javascript - 离开页面时显示带有“onbeforeunload”的警告，除非单击“提交”

> ID：14341208
> 
> 赞同：6
> 
> 时间：2013-01-15T15:38:36.760
> 
> 标签：javascript, onbeforeunload

如果用户试图离开包含未保存设置的页面，我希望显示警告，但如果他们试图保存这些设置，显然不会。

我想我的理解是错误的，因为我认为以下内容应该有效，但事实并非如此。有人可以告诉我我做错了什么吗？谢谢。

```
$('input[name="Submit"]').off('onbeforeunload');

window.onbeforeunload = function closeEditorWarning(){

    /** Check to see if the settings warning is displayed */
    if($('#unsaved-settings').css('display') !== 'none'){
        bol_option_changed = true;
    }

    /** Display a warning if the user is trying to leave the page with unsaved settings */
    if(bol_option_changed === true){
        return '';
    }

}; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-26T16:59:45.440

您可以使用 jquery .on() 设置 onbeforeunload ，然后在表单提交中使用 .off()

```
// Warning
$(window).on('beforeunload', function(){
    return "Any changes will be lost";
});

// Form Submit
$(document).on("submit", "form", function(event){
    // disable unload warning
    $(window).off('beforeunload');
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T15:59:41.167

你可以试试这个：点击提交按钮时设置一个标志，并使用这个标志来检查用户是否点击了提交或中途离开页面

伪代码：

```
var submit_clicked = false;

$('input[type="submit"]').click(function(){
    submit_clicked = true;
});

window.onbeforeunload = function closeEditorWarning () {

  /** Check to see if the settings warning is displayed */
  if(($('#unsaved-settings').css('display') !== 'none') && 
      submit_clicked === false) {
    bol_option_changed = true;
  }

  /** Display a warning if the user is trying to leave the page with unsaved settings */
  if(bol_option_changed === true){
    return '';
  }

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-29T18:49:36.050

我遇到了这个问题，所以我想分享我的解决方案。

**Brent White**的解决方案对我不起作用，因为我使用 jQuery-validation 插件。这意味着如果用户提供了无效的输入，即使他们点击了提交按钮，他们仍然会停留在页面上。此时，如果他们离开或刷新页面，则不会显示警报消息。

```
$(window).bind('beforeunload', function(evt) {
  var isSubmitButton = (evt.srcElement.activeElement.type === "submit");
  var isModified = ($form.data("isModified") === true); 
  if ( !isSubmitButton && isModified) {
    return "You need to save your changes before you leave the page";
  } 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-24T10:15:59.107

这是您问题的完美答案。

```
document.querySelector('.send').addEventListener("click", function(){ // put a class="send" in submit button
    window.btn_clicked = true; // if it is click onbeforeunload will not add dialog anymore
});
window.onbeforeunload = function(){

      if(!window.btn_clicked){
          var lot = $('#lot_no').val(); //getting values from form
      if(!lot == ''){  //checking if it is not empty
        return 'Changes you made not be saved!';
      }

      }

}; 
```

# dictionary - ASP.Net MVC 4 - 控制器动作中的字典参数

> ID：14341210
> 
> 赞同：2
> 
> 时间：2013-01-15T15:38:37.190
> 
> 标签：dictionary, parameters, asp.net-mvc-4, controller, action

我发现了一些类似下面的问题，但是我发现在以前的 MVC 版本中，MVC 4 中有什么新的东西吗？

[MVC 3 控制器操作中的可选字典参数](https://stackoverflow.com/questions/10392966/optional-dictionary-parameter-in-mvc-3-controller-action)

**更新：用一些代码来帮助未来的访问者**

```
public class QueryStringDictionaryBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var querystrings = controllerContext.HttpContext.Request.QueryString;

        return querystrings.Cast<string>()
          .Select(s => new { Key = s, Value = querystrings[s] })
          .ToDictionary(p => p.Key, p => p.Value);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:30:57.787

相反，依赖于您的帖子数据的特定格式并希望 MVC 绑定器能够理解它，我将实施自定义模型绑定器，您可以在其中解析您的帖子值并构建字典对象。

这是如何实现它的示例代码，它非常简单且高度灵活。

看我的回答。

[在回发时将 MvcContrib 网格内容绑定到视图模型](https://stackoverflow.com/questions/13494156/bind-mvccontrib-grid-contents-to-view-model-on-postback/13495443#13495443)

# iphone - 如何确定图片是否需要旋转？

> ID：14341214
> 
> 赞同：2
> 
> 时间：2013-01-15T15:38:47.783
> 
> 标签：iphone, coldfusion

我让我的学生上传自己的照片，但 iPhone 用户习惯性地上传侧身照片。

Q：如何判断图片是横向的，可以自动旋转吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:54:04.017

我同意[Busches](https://stackoverflow.com/users/1200805/busches)的观点，即您应该显示预览并允许手动覆盖您的用户界面。话虽如此，您确实可以在 ColdFusion 中获取 exif 数据并查看方向信息。 [Pete Freitag](http://www.petefreitag.com/)有一篇关于如何使用 cfimage 标记以编程方式检索信息的文章：

[http://www.petefreitag.com/item/657.cfm](http://www.petefreitag.com/item/657.cfm)

看起来 CF 将 Orientation 数据转换为文本，因此挑战将是从原始信息转换，这将是[EXIF Orientation Handling is a Ghetto](http://recursive-design.com/blog/2012/07/28/exif-orientation-handling-is-a-ghetto/)中描述的数值。

最好的办法是使用您的设备以不同的方向拍摄测试图像，然后查看数据显示的内容。

# java - 如何从类路径中删除 JNA.jar？

> ID：14341218
> 
> 赞同：1
> 
> 时间：2013-01-15T15:38:59.467
> 
> 标签：java, eclipse, jna

我目前正在创建一个漂亮的实用程序，一旦笔记本电脑的电池电量达到 55% 或用户想要得到通知的任何百分比，它就会发出哔哔声。

有人告诉我，Java 不提供对这些信息的任何访问权限，为此我需要`JNA(Java Native Access)`Todd Fast 使用。

我下载了 jna.jar 文件，但我不知道接下来要做什么来创建该软件。
我得到了一个社区成员的帮助，他创建了一个代码来做到这一点，它就在这里：
[如何在 Windows 系统中获得剩余的电池寿命？](https://stackoverflow.com/questions/3434719/how-to-get-the-remaining-battery-life-in-a-windows-system)
在代码中，他留下了评论`Fill The Structure`。这就是我感到困惑的地方。填充必须是实现上述接口的类？
**以及**如何`jna.jar`从类路径中删除？（我什至不知道那是什么意思）。
我正在使用日食。我想首先我必须将 jar 文件包含为项目的导入。请指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:52:01.637

> *在代码中，他留下了评论填充结构。这就是我感到困惑的地方。填充必须是实现上述接口的类？*

不，代码按原样准备就绪。javadoc 注释仅描述方法自己的唯一工作。

* * *

> *以及如何从类路径中删除 jna.jar ？（我什至不知道那是什么意思）。*

类路径是包含`.class`文件的文件夹的磁盘文件系统路径和/或包含文件的单个 JAR 文件的磁盘文件系统路径的集合，`.class`当 Java 需要加载类以进行编译或运行时，Java 必须在这些文件中查找。

反过来，在何处以及如何准确地配置类路径取决于您执行 Java 应用程序的方式。例如，在命令控制台、IDE 中、作为 Web 应用程序等。

* * *

> *我正在使用日食。我想首先我必须将 jar 文件作为导入项目包含在内*

如果它是一个“普通的”Java 应用程序项目并且您正在`main()`通过 (Ctrl)F11 在 Eclipse 中执行一个方法，那么您需要将 JAR 文件直接放在项目根文件夹中，右键单击它并选择*构建路径 > 添加到构建路径*。就是这样。您可以在项目属性的*Java 构建路径*条目中管理它们。

# html - 在 Html5 按钮标签内嵌套标签

> ID：14341219
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:39:00.577
> 
> 标签：html

```
<button class="myClass">
<label style="width:500px">This is sample 1</label>
<img class="btnImg" src="images/list_item_arrow.png"/>
</button>
.myClass
{
opacity:0.3;
color:#30F;
height:50px;
width:90%;
font-size:20px;
text-decoration:blink;
font-family:"Arial Black", Gadget, sans-serif;
 } 
```

标签不占用宽度，提供。要求是：如果按钮以 % 或 px 为单位的宽度，我们可以在右端显示图像。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:28:24.343

它的按钮标签，所以我认为给定宽度不会有用。您可以添加*text-align:left;* 到类“.myClass”并给图像*留边距*，这样你就可以把你的图像放在右边的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:55:00.250

标签不属于控件内部。它们旨在标记控件。如果是在控件中，就不用说明是标签了，

要回答手头的问题，它的宽度可能不会改变，因为标签通常具有默认`display`属性`inline`. 你可能想要`block`或`inline-block`。

# android - 无法从 android 中的数据库填充的列表视图的项目中获取 _ID

> ID：14341221
> 
> 赞同：0
> 
> 时间：2013-01-15T15:39:05.063
> 
> 标签：android, database, listview

我正在开发 android 中的记事本应用程序。我有一个 SherlockListActivity，我用数据库中的信息填充它的 ListView。为了显示动作栏的动作模式，我放置了一个长按的监听器。直到这里，一切都很好。问题是当我单击删除选项时，它会显示一个 AlertDialog 询问我是否确定，当我单击是时，它应该从数据库中删除它，但是应用程序会冻结并关闭。我已经在这个网站上找到了 3 个答案，显然其他人也有这个问题，我尝试和他们一样，但没有成功。谁能告诉我应该如何进行？这是我的代码：

```
public class Scratchpad extends SherlockListActivity {
    private static final int ACTIVITY_CREATE=0;
    private static final int ACTIVITY_EDIT=1;

    private static final int INSERT_ID = Menu.FIRST;
    private static final int DELETE_ID = Menu.FIRST + 1;
    private static final int EDIT_ID = Menu.FIRST + 2;

    private ScratchHelper mDbHelper;

    protected Object mActionMode;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.scratch_list);
        mDbHelper = new ScratchHelper(this);
        mDbHelper.open();
        fillData(); //populates the ListView with info from my DB
        registerForContextMenu(getListView());

        getListView().setOnItemLongClickListener(new OnItemLongClickListener() {

            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view,
                int position, long id) {

              if (mActionMode != null) {
                return false;
              }

              // Start the CAB using the ActionMode.Callback defined above
              mActionMode = Scratchpad.this
                  .startActionMode(mActionModeCallback);
              view.setSelected(true);
              return true;
            }
          });
    }

    private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {

        // Called when the action mode is created; startActionMode() was called
        public boolean onCreateActionMode(ActionMode mode, Menu menu) {
          // Inflate a menu resource providing context menu items
          MenuInflater inflater = mode.getMenuInflater();
          // Assumes that you have "contexual.xml" menu resources
          inflater.inflate(R.menu.actionmenu_main_longclick, menu);
          return true;
        }

        // Called each time the action mode is shown. Always called after
        // onCreateActionMode, but
        // may be called multiple times if the mode is invalidated.
        public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
          return false; // Return false if nothing is done
        }

        // Called when the user selects a contextual menu item
        public boolean onActionItemClicked(ActionMode mode, final MenuItem item) {
          switch (item.getItemId()) {
          case R.id.menu_long_delete:
            AlertDialog.Builder alertDialog = new AlertDialog.Builder(Scratchpad.this);

            // Setting Dialog Title
            alertDialog.setTitle("Confirm Delete...");

            // Setting Dialog Message
            alertDialog.setMessage(R.string.confirm_delete);
            // Setting Positive "Yes" Button
            alertDialog.setPositiveButton(R.string.yes, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int which) {

                AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
                mDbHelper.deleteNote(info.id); //THERE IS THE PROBLEM!!!!!!!!
                fillData();
                }
            });

            // Setting Negative "NO" Button
            alertDialog.setNegativeButton(R.string.no, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    dialog.cancel();
                }
            });

            // Showing Alert Message
            alertDialog.show();
            // Action picked, so close the CAB
            mode.finish();
            return true;

          case R.id.menu_long_edit:
              Toast.makeText(getApplicationContext(), R.string.scratch_modified, Toast.LENGTH_SHORT).show();
              // Action picked, so close the CAB
              mode.finish();
              return true;

          default:
            return false;
          }
        }

        // Called when the user exits the action mode
        public void onDestroyActionMode(ActionMode mode) {
          mActionMode = null;
          selectedItem = -1;
        }
      }; 
```

问题出在我评论“这是问题所在”的那一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:45:32.803

SQLite 数据库中没有`_ID`，如果你想要 id，你必须使用隐藏`rowid`列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:54:57.930

对于你的数据库的详细信息，你可以使用 sql manager 打开数据库文件，它与 sql server 的 sql manager studio 相同.. 要获取数据库文件，你可以使用 DDMS 的文件资源管理器

# bash - 如何使用 bash 脚本实现监督

> ID：14341226
> 
> 赞同：0
> 
> 时间：2013-01-15T15:39:17.767
> 
> 标签：bash

supervise 是 daemontools 中的强大工具之一，我想知道如何使用 bash 脚本来实现它。有人有建议吗？我需要帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:11:13.037

`supervise`执行许多任务，并与`svscan`, `svcok`, . 互操作`svstat`。bash 中功能齐全的实现将是不平凡的，但守护程序重启脚本是一项相当简单的任务。

```
#!/bin/bash
DAEMON=/usr/sbin/whatever      # "/bin/sleep" for demo
DAEMON_ARGS="xxx"              # "15" for sleep demo

case "$1" in 
    start) 
        echo "Starting $DAEMON"
        (
            trap 'logger -i -p daemon.info "INFO: $DAEMON shutting down..."; exit 1' 1 2 3 15
            logger -i -p daemon.info "INFO: Starting $DAEMON"
            while : ; do
                $DAEMON $DAEMON_ARGS &
                pid=$!
                echo $pid > /var/run/mydaemon.pid
                wait $pid
                rc=$?
                logger -i -p daemon.warn "WARNING: $DAEMON exited, rc=$rc"
                sleep 1  # adjust as required
                logger -i -p daemon.warn "WARNING: Restarting $DAEMON"
            done
        ) &
        echo $! > /var/run/myscript.pid
    ;;        

    stop)
        echo "Stopping $DAEMON"
        [ -f /var/run/myscript.pid ] && kill $(</var/run/myscript.pid)
        [ -f /var/run/mydaemon.pid ] && kill $(</var/run/mydaemon.pid)
        ;;
esac 
```

上面几乎没有错误处理，没有正确地执行真正的守护进程，如 chdir() 并关闭未使用的 FD，但它确实通过 logger/syslog 进行记录，因此您可以看到它在做什么。它假定`$DAEMON`不分叉到后台本身（如`supervise`）。

您还没有说明您的平台，但是如果您想要一些非常非常简单的东西，inittab 可以解决问题，请参阅[如何使用 inittab 自动重启 PHP 程序？](https://stackoverflow.com/questions/937160/how-to-use-inittab-to-auto-restart-a-php-programme)一些提示。否则，我们将退出 Stack Overflow 领域，因此请查看[https://unix.stackexchange.com/](https://unix.stackexchange.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T13:30:57.180

我稍微更改[了 mr.spuratic 提供的代码](https://stackoverflow.com/a/14345093)：

```
echo "true" > $STATUSFILE

case "$1" in

    start) 
        echo "Starting $DAEMON_NAME"
        (
            trap 'logger -t italoService "INFO: $DAEMON_NAME shutting down..."; exit 1' 1 2 3 15
            logger -t italoService "INFO: Starting $DAEMON_NAME"
            while : ; do
                #do_start
                read STATUS <$STATUSFILE
                if [ "$STATUS" = "false" ] ; then
                     logger -t italoService "INFO: $DAEMON_NAME stopped by user"
                     break
                fi
                $DAEMON $DAEMON_OPTS &
                pid=$!
                echo $pid > $PIDFILE
                logger -t italoService "WARNING: pid File: $pid"
                wait $pid
                rc=$?
                logger -t italoService "WARNING: $DAEMON_NAME exited, rc=$rc"
                sleep 1  # adjust as required
                read STATUS <$STATUSFILE
                if [ "$STATUS" = "true" ] ; then
                     logger -t italoService "WARNING: Restarting $DAEMON_NAME"
                fi
            done
        ) &
        echo $! > $PIDFILE
    ;;        

    stop)
        echo "Stopping $DAEMON_NAME"
        echo "false" > $STATUSFILE
        [ -f $PIDFILE ] && kill $(<$PIDFILE)
        [ -f $PIDFILE ] && kill $(<$PIDFILE)
        ;; 
```

# mobile - 钛手机

> ID：14341228
> 
> 赞同：0
> 
> 时间：2013-01-15T15:39:27.237
> 
> 标签：mobile, titanium

我只是简单地将其视为一种可能的技术，可用于我最初想到的移动应用程序，但任何人都可以告诉我是否需要支付支持订阅才能使用 GWT-RPC jar。我简要地看了一个 RPC 教程，这是我得到的印象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:09:13.663

您可以免费开发和分发 Titanium。您无需支付或订阅任何东西。

只有当您需要支持或使用特殊功能（ACS 云服务、模块）时，您才需要付费。

# c# - 使用 Image.Save 将 jpg 转换为 gif 时出错

> ID：14341229
> 
> 赞同：-3
> 
> 时间：2013-01-15T15:39:30.857
> 
> 标签：c#, .net, image-processing, graphics, byte

我要做的是将图像转换为字节数组，然后将该字节数组写入文件。这是代码

```
public static byte[] Convert(Image img)
    {
        using (MemoryStream ms = new MemoryStream())
        {
            img.Save(ms, System.Drawing.Imaging.ImageFormat.Gif);
            // or whatever output format you like
            return ms.ToArray();
        }
    }

    public Form1()
    {
        InitializeComponent();
        Bitmap pic = new Bitmap("tulips.jpg");
        pictureBox1.Image = pic;
        byte[] img_array;
        img_array = Convert(pic);
        File.WriteAllBytes("test.txt", img_array);

    } 
```

现在我已经成功地将图像转换为字节数组。我已经通过断点检查了字节数组中的值，它们都是有效的。

但是，当我尝试将数组写入文件然后打开文件时，我看到的都是垃圾。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:49:48.073

你`Bitmap`的是一个`Image`. 当您可以简单地调用时，为什么要将其转换为`byte`数组`Save`（[在此处](http://msdn.microsoft.com/en-us/library/9t4syfhh.aspx)记录）

```
Bitmap pic = new Bitmap("tulips.jpg");
pictureBox1.Image = pic;
pic.Save("test.gif", System.Drawing.Imaging.ImageFormat.Gif); 
```

要操作图像，您通常会访问`pixel data`- 您现在拥有的包含**文件类型标题**以及像素！请参阅`Bitmap.LockBits`操作像素（[在此处](http://msdn.microsoft.com/en-us/library/5ey6h79d.aspx)记录）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:43:22.350

您确定您正在尝试使用图像查看器打开文件吗？该`.txt`扩展通常会导致它使用文本编辑器打开。由于图像文件的格式是二进制的，因此当您将其呈现为文本时，可以预期您只会看到“垃圾”。如果您`.gif`在保存文件时使用正确的扩展名 , 将会有所帮助。

```
File.WriteAllBytes("test.gif", img_array); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:43:35.863

你期待看到什么？您正在将字节数组保存到文本文件中。当您打开具有图像文件字节的文本文件时，您将无法获得好的结果。

确保您将文件保存为正确的类型，然后看看会发生什么。

# objective-c - Objective-c - 用户的登录和注销时间

> ID：14341230
> 
> 赞同：6
> 
> 时间：2013-01-15T15:39:33.943
> 
> 标签：objective-c, cocoa

是否可以在 Objective-C 程序中获取用户的登录和注销时间？我可以使用 CGSessionCopyCurrentDictionary 函数获取会话 ID、用户名、userUID、userIsActive 和 loginCompleted，但我无法从中获取登录和注销时间，可以吗？

我知道我可以从 console.app 获取信息，但我想把它放在一个程序中。

我在哪里可以找到更多信息？在 Apple 的开发指南中找不到它。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T19:57:27.123

我不知道是否有任何特殊的 Cocoa 功能来获取用户登录/注销时间。

但是您可以使用`getutxent_wtmp()`. 这就是“last”命令行工具的作用，可以在源代码中看到：[http ://www.opensource.apple.com/source/adv_cmds/adv_cmds-149/last/last.c](http://www.opensource.apple.com/source/adv_cmds/adv_cmds-149/last/last.c)

举一个非常简单的例子：以下程序将所有登录/注销时间打印到标准输出：

```
#include <stdio.h>
#include <utmpx.h>

int main(int argc, const char * argv[])
{
    struct utmpx *bp;
    char *ct;

    setutxent_wtmp(0); // 0 = reverse chronological order
    while ((bp = getutxent_wtmp()) != NULL) {
        switch (bp->ut_type) {
            case USER_PROCESS:
                ct = ctime(&bp->ut_tv.tv_sec);
                printf("%s login %s", bp->ut_user, ct);
                break;
            case DEAD_PROCESS:
                ct = ctime(&bp->ut_tv.tv_sec);
                printf("%s logout %s", bp->ut_user, ct);
                break;

            default:
                break;
        }
    };
    endutxent_wtmp();

    return 0;
} 
```

* * *

只是为了好玩：一个**Swift 4**解决方案：

```
import Foundation

extension utmpx {
    var userName: String {
        return withUnsafePointer(to: ut_user) {
            $0.withMemoryRebound(to: UInt8.self, capacity: MemoryLayout.size(ofValue: ut_user)) {
                String(cString: $0)
            }
        }
    }
    var timestamp: Date {
        return Date(timeIntervalSince1970: TimeInterval(ut_tv.tv_sec))
    }
}

setutxent_wtmp(0)
while let bp = getutxent_wtmp() {

    switch bp.pointee.ut_type {
    case Int16(USER_PROCESS):
        print(bp.pointee.userName, "login", bp.pointee.timestamp)
    case Int16(DEAD_PROCESS):
        print(bp.pointee.userName, "logout", bp.pointee.timestamp)
    default:
        break
    }
}
endutxent_wtmp(); 
```

# xcode - 是否有人将 iAds 添加到应用商店中已有的现有应用中？如果是这样，你如何做到这一点？

> ID：14341232
> 
> 赞同：0
> 
> 时间：2013-01-15T15:39:35.547
> 
> 标签：xcode, app-store, app-store-connect, iad

我以为你可以通过简单地更新来添加横幅，但我在 iTunes Connect 中看到了一些东西，这让我觉得我可能需要做一些其他事情来让广告正常运行。非常感谢任何见解，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:02:52.677

只需使用广告构建它并使用新的二进制文件提交以供审核。

# .net - 远程控制安装在内网机器上的windows服务

> ID：14341234
> 
> 赞同：1
> 
> 时间：2013-01-15T15:39:39.803
> 
> 标签：.net, asp.net-mvc, windows-services

我在本地 IIS 7 上部署了 Web 应用程序，应用程序池配置为在内置 NETWORK SERVICE 帐户下工作。从这个 Web 应用程序中，我需要检查我的 Windows 服务的状态（如果它已启动、停止等）。我用这样的语句来得到它：

```
public string GetServiceStatus(string machine, string service)
{
    var service = new ServiceController(machine, service);
    service.Refresh();
    return service.Status;
} 
```

这`machine`是我的 Intranet 中主机的 IP 地址（假设它是 192.168.0.7），Windows 服务在其中运行 - 也在内置的 NETWORK SERVICE 帐户下。

不幸的是，代码给出了一个例外：

```
service.Status threw an exception of type 'System.InvalidOperationException' 
Cannot open MyService service on computer '192.168.0.7'. Access is denied. 
```

哪里有问题 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T10:34:48.323

问题是 NETWORK SERVICE 没有足够的权限来控制 Windows 服务。我需要切换到另一个用户上下文才能控制它。但我不想为整个应用程序这样做。相反，我正在搜索特定身份下的任意代码执行。

我已经检查了很多关于模仿的资源，包括 Malcolm Frexner 展示的资源。因为我使用的是 Windows 7（64 位）和 Windows Server 2008 R2（64 位），所以我发现它不适合我。我最终得到了这样的通用解决方案：

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Security.Principal;

namespace Thing.Namespace
{
    public enum LogOnType
    {
        LogOn32LogOnInteractive = 2,
        LogOn32LogOnNetwork = 3,
        LogOn32LogOnBatch = 4,
        LogOn32LogOnService = 5,
        LogOn32LogOnUnlock = 7,
        LogOn32LogOnNetworkCleartext = 8,
        LogOn32LogOnNewCredentials = 9
    }

    public enum LogOnProvider
    {
        LogOn32ProviderDefault = 0,
        LogOn32ProviderWinnt35 = 1,
        LogOn32ProviderWinnt40 = 2,
        LogOn32ProviderWinnt50 = 3
    }

    public enum ImpersonationLevel
    {
        SecurityAnonymous = 0,
        SecurityIdentification = 1,
        SecurityImpersonation = 2,
        SecurityDelegation = 3
    }

    public static class IdentityBoss
    {
        private static WindowsImpersonationContext _impersonationContext;
        private static readonly object _locker = new object();

        private static class NativeMethods
        {
            [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
            public static extern int LogonUser(String lpszUserName,
                                               String lpszDomain,
                                               String lpszPassword,
                                               int dwLogonType,
                                               int dwLogonProvider,
                                               ref IntPtr phToken);

            [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
            public static extern int DuplicateToken(IntPtr hToken,
                                                    int impersonationLevel,
                                                    ref IntPtr hNewToken);

            [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
            [return: MarshalAs(UnmanagedType.Bool)]
            public static extern bool RevertToSelf();

            [DllImport("kernel32.dll", SetLastError = true)]
            [return: MarshalAs(UnmanagedType.Bool)]
            public static extern bool CloseHandle(IntPtr handle);
        }  

        public static void Impersonate(Action action, string user, string domain, string password,
                                       LogOnType logOnType, LogOnProvider logOnProvider,
                                       ImpersonationLevel impersonationLevel)
        {
            try
            {
                ImpersonateValidUser(user, domain, password, logOnType, logOnProvider, impersonationLevel);
                action();
            }
            finally
            {
                UndoImpersonation();
            }
        }

        public static void ImpersonateHappily(Action action, string user, string domain, string password)
        {
            Impersonate(action, user, domain, password, LogOnType.LogOn32LogOnNetworkCleartext,
                        LogOnProvider.LogOn32ProviderDefault, ImpersonationLevel.SecurityImpersonation);
        }

        public static TResult Impersonate<TResult>(Func<TResult> action, string user, string domain, string password,
                                                   LogOnType logOnType, LogOnProvider logOnProvider,
                                                   ImpersonationLevel impersonationLevel)
        {
            try
            {
                ImpersonateValidUser(user, domain, password, logOnType, logOnProvider, impersonationLevel);
                return action();
            }
            finally
            {
                UndoImpersonation();
            }
        }

        public static TResult ImpersonateHappily<TResult>(Func<TResult> action, string user, string domain, string password)
        {
            return Impersonate(action, user, domain, password, LogOnType.LogOn32LogOnNetworkCleartext,
                               LogOnProvider.LogOn32ProviderDefault, ImpersonationLevel.SecurityImpersonation);
        }

        private static void ImpersonateValidUser(String userName, String domain, String password, LogOnType logonType, LogOnProvider logonProvider, ImpersonationLevel impersonationLevel)
        {
            lock (_locker)
            {
                var token = IntPtr.Zero;
                var tokenDuplicate = IntPtr.Zero;
                WindowsIdentity tempWindowsIdentity = null;

                try
                {
                    if (!NativeMethods.RevertToSelf())
                        throw new Win32Exception(Marshal.GetLastWin32Error());
                    if (NativeMethods.LogonUser(userName, domain, password, (int) logonType, (int) logonProvider,ref token) == 0)
                        throw new Win32Exception(Marshal.GetLastWin32Error());
                    if (NativeMethods.DuplicateToken(token, (int) impersonationLevel, ref tokenDuplicate) == 0)
                        throw new Win32Exception(Marshal.GetLastWin32Error());

                    tempWindowsIdentity = new WindowsIdentity(tokenDuplicate);
                    _impersonationContext = tempWindowsIdentity.Impersonate();
                }
                finally
                {
                    if (token != IntPtr.Zero)
                        NativeMethods.CloseHandle(token);
                    if (tokenDuplicate != IntPtr.Zero)
                        NativeMethods.CloseHandle(tokenDuplicate);
                    if (tempWindowsIdentity != null)
                        tempWindowsIdentity.Dispose();
                }
            }
        }

        private static void UndoImpersonation()
        {
            lock (_locker)
            {
                if (_impersonationContext != null)
                {
                    _impersonationContext.Undo();
                }
            }            
        }
    }
} 
```

此外，我需要在安装了服务的机器上创建新用户。用户必须具有控制 Windows 服务的权限 - 为此，可以将其添加到管理员组。

现在我可以启动/停止我的服务并以这种方式获取它们的当前状态：

```
private const string user = "MyUser";  
private const string domain = ".";
private const string password = "MyPa$$w0rd";

public string StartService(string machine, string service)
{
    IdentityBoss.ImpersonateHappily(
        () =>
            {
                Controller.Instance.StartService(machine, service);
            }, user, domain, password
        );
}

public string GetServiceStatus(string machine, string service)
{
    return IdentityBoss.ImpersonateHappily(
        () =>
            {
                return Controller.Instance.GetServiceStatus(machine, service);
            }, user, domain, password
        );
} 
```

`ImpersonateHappily`只是一个函数，它接受与我的操作系统一起工作的参数。来自网络的其他类似解决方案使用`dwLogonType`参数传递给 win 32 api 函数`LogonUserA`，值为 2 或 9，而在我的系统下，值 8 是正确的。

顺便说一句：`Impersonate`是一个包装函数，它设置模拟，然后传递给它一个执行实际工作的 lambda。这种编写代码风格的计算机科学术语是[高阶编程](http://en.wikipedia.org/wiki/Higher-order_programming)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T21:31:48.187

试试如果你可以使用模拟

[http://support.microsoft.com/kb/306158/en-us](http://support.microsoft.com/kb/306158/en-us)

# c# - Asp.net，在 aspx 文件中使用 <%=getter%>，无法修改 Controls 集合，因为该控件包含代码块

> ID：14341241
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:39:49.973
> 
> 标签：c#, javascript, asp.net

我在使用javascript函数的aspx文件中有一个aspx，aspx.cs文件，

在 javascript 代码中，我使用在 aspx.cs 文件中定义的 getter (<%=getSize%>) 方法，

但是页面返回：“控件集合无法修改，因为控件包含代码块”为什么？

```
 <!-- language-all:lang-js -->
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="uploadFile.aspx.cs"
Inherits="UploadControl_CustomProgressPanel" Title="Untitled Page" %>
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
<title>Untitled Page</title>
<script language="javascript" type="text/javascript">
var size = <%=getSize%>;
var id= 0;

function ProgressBar() 
{
if(document.getElementById("FileUpload1").value != "")
{
    document.getElementById("divProgress").style.display = "block";
    document.getElementById("divUpload").style.display = "block";
    id = setInterval("progress()",20);
    return true;
}
else
{
    alert("Select a file to upload");
    return false;
}    

}

function progress()
{
//size = size + 1;
if(size > 299) 
{
    clearTimeout(id);
 }
document.getElementById("divProgress").style.width =  size + "pt";
document.getElementById("lblPercentage").firstChild.data = parseInt(size / 3) +  "%";
} 
```

aspx.cs 文件：

```
using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.IO;

public partial class UploadControl_CustomProgressPanel : System.Web.UI.Page 
{   

   protected int size = 2;

   protected int getSize{ get { return this.size; }}

   protected void Page_Load(object sender, EventArgs e)
    {
    string UpPath;
    UpPath = "C:\\";
    if (! Directory.Exists(UpPath))
    {
        Directory.CreateDirectory("C:\\");      
    }
    }
    protected void Button1_Click(object sender, EventArgs e)
    {
    //StatusLabel.Text = "File scelto, Upload in corso..";
    if(FileUpload1.HasFile)
    {
        try
        {   
            string filePath = Request.PhysicalApplicationPath;
            filePath += "classic/hub/csv/";
            filePath += FileUpload1.FileName;
            this.size = 50;
            FileUpload1.SaveAs(filePath);
            //StatusLabel.Text = "Upload status: File uploaded!";
            Label1.Text = "Upload successfull!";
        }
        catch(Exception ex)
        {
            //StatusLabel.Text = "Upload status: The file could not be uploaded. The following error occured: " + ex.Message;
        }
        }
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:06:16.393

您尚未发布完整的 HTML，但尝试将您的脚本移出`<head>`标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:46:31.880

是`getSize`属性还是函数？如果它的属性大小将采用它在页面加载时的值，如果它是一个函数，那么您需要查看页面方法，因为您不能以这种方式调用它，这[是一个示例](http://trentgardner.net/net/asp-net-webmethods-with-jquery-and-ajax/)

# javascript - TypeScript 中的未定义属性

> ID：14341244
> 
> 赞同：1
> 
> 时间：2013-01-15T15:39:53.097
> 
> 标签：javascript, events, typescript

我对事件有疑问。

我创建了两个接口：

```
export interface IEEvent extends JQueryEventObject, MSEventObj {
    preventDefault: () => void;
    cancelBubble: bool;
}

export interface IEElement extends HTMLElement {
    click: (event?: IEEvent) => void;
    onmousedown: (event?: IEEvent) => void;
    onmousemove: (event?: IEEvent) => void;
    onmouseup: (event?: IEEvent) => void;
} 
```

我尝试设置`onmousedown\move\up`道具，但出现错误...

```
public static StopPropagation(element: HTMLElement): void {
    (<IEElement> element).onmousedown = StopPropagationHandler; // error here
    (<IEElement> element).click = StopPropagationHandler; // error here
    (<IEElement> element).onmouseup = StopPropagationHandler; // error here
}

private static StopPropagationHandler(e?: IEEvent): void {
    if (typeof (e) === "undefined") {
        e = <IEEvent> window.event;
    }
    if (typeof (e.preventDefault()) !== "undefined") { // error here
        e.preventDefault(); // error here
    }
    e.cancelBubble = true;
} 
```

![特性](../Images/5ff63cb116ffa11b72ff7adae00c0ac9.png)

![方法](../Images/988354e85d60fee0ae84dd866516c8a7.png)

如何摆脱这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:54:05.533

听起来当异常发生时 StopPropagation 位于调用堆栈的顶部。如果您在调试器内部检查它，我怀疑元素将是未定义的。如果是这种情况，您可以考虑修改您的代码以处理此问题或抛出异常。例子：

允许取消定义：

```
public static StopPropagation(element: HTMLElement): void {
    if (element) {
        (<IEElement> element).onmousedown = StopPropagationHandler; // error here
        (<IEElement> element).click = StopPropagationHandler; // error here
        (<IEElement> element).onmouseup = StopPropagationHandler; // error here
    }
} 
```

禁止取消定义：

```
public static StopPropagation(element: HTMLElement): void {
    if (!element) {
        throw new Error("Null argument exception. An element must be provided.");

    (<IEElement> element).onmousedown = StopPropagationHandler; // error here
    (<IEElement> element).click = StopPropagationHandler; // error here
    (<IEElement> element).onmouseup = StopPropagationHandler; // error here
} 
```

# ios - iOS 和 PhoneGap 中的单击和长按

> ID：14341247
> 
> 赞同：0
> 
> 时间：2013-01-15T15:40:00.863
> 
> 标签：ios, cordova, click

使用Phonegap时，有什么方法可以区分html中的单击和长按吗？我已经使用 js 插件进行长按/单击，它们运行良好，但我必须在两种手势上调用不同的功能，但长按也会执行单击功能。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:54:52.630

我认为你必须捕捉“触摸开始”和“触摸结束”事件，启动一个计时器，如果在计时器触发之前触摸结束，它是一个短触摸，如果计时器触发它是一个长触摸。

# maven - 如何在 Maven 中设置 NetBeans 服务器？

> ID：14341248
> 
> 赞同：1
> 
> 时间：2013-01-15T15:40:02.127
> 
> 标签：maven, tomcat, netbeans

我有一个独立于环境的 Web 应用程序，因此它是可以部署到多个环境的单一战争。

我创建了多个 Tomcat 服务器（即开发、QA、生产）并在 NetBeans 服务器配置中定义了它们。

我可以通过手动更改项目属性来很好地针对每个环境运行战争，但我希望能够设置从 Maven 中连接到的服务器，并添加自定义调试/运行操作或使用 maven 配置文件.

我试过设置：

```
<netbeans.deployment.server.id>tomcat70:home=C:\Apache\Tomcat\7.0.34,base=C:\Apache\Tomcat\Devel</netbeans.deployment.server.id> 
```

但这对我不起作用。

有谁知道这是否可以做到？

谢谢，

抢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T16:14:08.967

正确的方法是在你的 pom 中设置单独的配置文件，然后在每个配置文件中设置属性。

# java - 如何为resteasy实现bson生产者/消费者

> ID：14341249
> 
> 赞同：1
> 
> 时间：2013-01-15T15:40:06.563
> 
> 标签：java, jax-rs, resteasy, bson

我们正在开发一个使用 resteasy 框架的服务。它适用于 XML 和 json 应用程序/内容类型。但是，我们需要使用另外一种格式：bson。

我安装了 bson4jackson 插件，但我不知道如何将它与 resteasy 一起使用。我知道我必须实现一个生产者/消费者类，但我没有找到任何示例。

有什么建议/想法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T04:59:04.640

您需要实现自定义`MessageBodyReader`并`MessageBodyWriter`处理 bson 媒体类型。

**读者：**

```
@Provider
@Consumes("application/bson")
public class BsonMessageBodyReader implements MessageBodyReader {

} 
```

**作家：**

```
@Provider
@Produces("application/bson")
public class BsonMessageBodyWriter implements MessageBodyWriter {

} 
```

# iphone - 方向改变后如何获得正确的视图边界？

> ID：14341250
> 
> 赞同：1
> 
> 时间：2013-01-15T15:40:07.063
> 
> 标签：iphone, ios6, ipad

我正在使用 view.bounds 来确定按下按钮时在何处添加日期选择器视图。如果方向与导航到视图时的方向相同，则此方法效果很好。不幸的是，如果在显示视图时方向发生变化，则边界不是未注明日期的，因此选择器视图显示不正确。我需要一种方法来确定视图的实际边界。如果可能的话，我想要在 iPad 和 iPhone 上都可以使用的东西，因为这是一个通用应用程序。同样在 iPad 版本中，选择器视图位于 splitview 详细信息控制器中，因此我不能只交换高度和宽度并调整导航栏。

```
-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
   [super didRotateFromInterfaceOrientation:fromInterfaceOrientation];

   // size up the picker view to our screen and compute the start/end frame origin for      our slide up animation
   //
   // compute the start frame

    CGRect screenRect = self.view.bounds;
    CGSize pickerSize = [self.pickerView sizeThatFits:CGSizeZero];
    CGRect startRect;
    CGRect pickerRect;
    UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];
    if (UIInterfaceOrientationIsPortrait(orientation))
    {
        // code for Portrait orientation
        startRect = CGRectMake(0.0,
                               screenRect.origin.y + screenRect.size.height,
                               pickerSize.width, pickerSize.height);
        pickerRect = CGRectMake(0.0,
                                screenRect.origin.y + screenRect.size.height - pickerSize.height,
                                screenRect.size.width,
                                pickerSize.height);

    }
    else
    {
        //code for landscape
        startRect = CGRectMake(0.0,
                               screenRect.origin.y + screenRect.size.height,
                               pickerSize.width, pickerSize.height);
        pickerRect = CGRectMake(0.0,
                                screenRect.origin.y + screenRect.size.height - pickerSize.height,
                                screenRect.size.width,
                                pickerSize.height);

    }

    self.pickerView.frame = startRect;

    // start the slide up animation
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    // we need to perform some post operations after the animation is complete
    [UIView setAnimationDelegate:self];

    self.pickerView.frame = pickerRect;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:42:09.720

如果我正确理解您的问题，您应该尝试设置：

```
self.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

在您的视图上，以便它们在方向更改时“更新”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T16:02:44.800

我最终将pickerview添加到操作表中，如下所示：

```
UIActionSheet *aac = [[UIActionSheet alloc] initWithTitle:@"Choose Date and Time"
                                                 delegate:self
                                        cancelButtonTitle:nil
                                   destructiveButtonTitle:nil
                                        otherButtonTitles:nil];

[datePicker addTarget:self action:@selector(dateChanged) forControlEvents:UIControlEventValueChanged];

pickerDateToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
pickerDateToolbar.barStyle = UIBarStyleBlackOpaque;
[pickerDateToolbar sizeToFit];

NSMutableArray *barItems = [[NSMutableArray alloc] init];

UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];
[barItems addObject:flexSpace];

UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(DatePickerDoneClick)];
[barItems addObject:doneBtn];

[pickerDateToolbar setItems:barItems animated:YES];

[aac addSubview:pickerDateToolbar];
[aac addSubview:datePicker];

[aac showFromTabBar:self.tabBarController.tabBar];
CGFloat wideth = self.view.frame.size.width;
if (UIDeviceOrientationIsLandscape([self interfaceOrientation])) {
   [aac setBounds:CGRectMake(0,0,wideth, 355)];
   [datePicker sizeToFit];
} else {
    [aac setBounds:CGRectMake(0,0, wideth, 470)];
    [datePicker sizeToFit];
}
picker = aac; 
```

希望这对其他人有帮助。

# flash - Actionscript - 无法追踪到回调

> ID：14341255
> 
> 赞同：0
> 
> 时间：2013-01-15T15:40:21.207
> 
> 标签：flash, actionscript, callstack

我正在尝试熟悉一个遗留项目。在一个特定的功能中，我有代码：

```
public function update(userObj:Object):void
{
    var comm2:CommManager;
    comm2 = CommManager.getInstance();
    comm2.statusManager.employeeStatus(employeeId);
} 
```

虽然我可以放置一个捕获的断点，但我无法追踪到这两行中的任何一行来查看相应的代码。在第一种情况下，调用堆栈的顶部显示：

```
comm::CommManager$/getInstance 
```

接下来，调用堆栈的顶部显示：

```
comm::StatusManager/employeeStatus 
```

在这两种情况下，我都会在“输出”窗口中得到一个新行：

```
Cannot display source code at this location. 
```

我怎样才能弄清楚这段代码来自哪里？我不知道有任何外部链接，但这肯定不会让我感到惊讶。

附录：虽然 CommManager.as 有一个匹配的 API，但我在其中添加了相应的断点，这些断点无法捕获。另外，如果我重命名文件，我会收到一个编译错误，告诉我找不到 CommManager 类型。好像 CommManager.as 只是部分被使用。虽然 CommManager 扩展了一个名为 BaseCommComponent 的类（它扩展了 flash.events.EventDispatcher），但 BaseCommComponent 没有任何与 CommManager 中的函数同名的函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:28:14.353

所以事实证明，代码实际上是使用外部 swf。幸运的是，我也有匹配的 fla 文件。进入发布设置并检查“允许调试”框，以及重新编译似乎可以解决它。希望这可以帮助任何有类似问题的人。

# ios - 如何获取要在 uitextfield 上显示的数组的内容

> ID：14341256
> 
> 赞同：0
> 
> 时间：2013-01-15T15:40:24.887
> 
> 标签：ios, objective-c, nsarray, uitextview

我试图让数组的内容显示在 uitextfield 上。

这是我的代码：

```
NSArray *arrayConditions = [[NSArray alloc] initWithObjects:[item objectForKey:@"conditions"], nil];

NSString * resultConditions = [arrayConditions description]; 
```

// conditionsDeal 是 uitextfield self.conditionsDeal.text = resultConditions;

条件是从这样的 url 中提取的：

```
"results": [
{
  "conditions": [
    "Il coupon è valido per soggiorni fino al...",
    "I coupon sono cumulabili, possibilità...",
    "Coupon non cumulabile con altre promozioni...",
  ],
  "deadline": "2013-11-27T22:59:59.000Z", 
```

目前在我的 uitextview 中显示的唯一内容是：

![在此处输入图像描述](../Images/23929c5ce243a9107b9884ae07967da5.png)

我需要删除 ( ( ) ) 括号并将其格式化。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:54:08.620

您想像这样连接数组中的所有字符串：

```
self.conditionsDeal.text = [arrayConditions[@"conditions"] componentsJoinedByString:@"\n"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:21:00.090

```
string = [string stringByReplacingOccurrencesOfString:@"}" withString:@""];
string = [string stringByReplacingOccurrencesOfString:@"{" withString:@""];
string = [string stringByReplacingOccurrencesOfString:@"\n" withString:@""];
string = [string stringByReplacingOccurrencesOfString:@"  " withString:@" "]; 
```

# c++ - Qt Creator 未定义对现有类的引用

> ID：14341257
> 
> 赞同：1
> 
> 时间：2013-01-15T15:40:25.253
> 
> 标签：c++, shared-libraries, qt-creator, codeblocks

我正在编写一个使用我同时开发的另一个库的应用程序。这会产生问题，QtCreator 将期望库永远不会更改到删除的标头导致构建项目失败的地步，并且即使新类可以很好地编译到库中，它们也会被报告为未定义。这是怎么回事？就好像它实际上并没有在看图书馆。有什么办法可以强制它让我使用库中的新添加内容？

这是应用程序.pro

```
QT       += core gui opengl

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = BlockEditor
TEMPLATE = app

SOURCES += main.cpp\
    mainwindow.cpp \
    openglqt.cpp \
    tilelabel.cpp

HEADERS  += mainwindow.h \
    openglqt.h \
    tilelabel.h

FORMS    += mainwindow.ui

LIBS += -L/usr/local/lib -lGLU -lGLEW

QMAKE_LFLAGS += -Wl,--rpath=\\\$\$ORIGIN/libs
QMAKE_RPATH=

release {
    LIBS += -L$$PWD/../drEngine/bin/Release/ -ldrEngine
}
debug {
    LIBS += -L$$PWD/../drEngine/bin/Debug/ -ldrEngine
}

INCLUDEPATH += $$PWD/../drEngine
DEPENDPATH += $$PWD/../drEngine

QMAKE_CXXFLAGS += -std=c++11 
```

该库是在 Code::Blocks 中开发的

```
<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<CodeBlocks_project_file>
    <FileVersion major="1" minor="6" />
    <Project>
        <Option title="Dark Realms Engine" />
        <Option pch_mode="2" />
        <Option compiler="gcc" />
        <Build>
            <Target title="Debug">
                <Option output="bin/Debug/drEngine" imp_lib="$(TARGET_OUTPUT_DIR)$(TARGET_OUTPUT_BASENAME).a" def_file="$(TARGET_OUTPUT_DIR)$(TARGET_OUTPUT_BASENAME).def" prefix_auto="1" extension_auto="1" />
                <Option object_output="obj/Debug/" />
                <Option type="3" />
                <Option compiler="gcc" />
                <Option createDefFile="1" />
                <Option createStaticLib="1" />
                <Compiler>
                    <Add option="-g" />
                </Compiler>
            </Target>
            <Target title="Release">
                <Option output="bin/Release/drEngine" imp_lib="$(TARGET_OUTPUT_DIR)$(TARGET_OUTPUT_BASENAME).a" def_file="$(TARGET_OUTPUT_DIR)$(TARGET_OUTPUT_BASENAME).def" prefix_auto="1" extension_auto="1" />
                <Option object_output="obj/Release/" />
                <Option type="3" />
                <Option compiler="gcc" />
                <Option createDefFile="1" />
                <Option createStaticLib="1" />
                <Compiler>
                    <Add option="-O3" />
                </Compiler>
                <Linker>
                    <Add option="-s" />
                </Linker>
            </Target>
        </Build>
        <Compiler>
            <Add option="-std=c++11" />
            <Add option="-Wall" />
        </Compiler>
        <Unit filename="Block.cpp" />
        <Unit filename="Block.hpp" />
        <Unit filename="BlockList.cpp" />
        <Unit filename="BlockList.hpp" />
        <Unit filename="Camera2D.cpp" />
        <Unit filename="Camera2D.hpp" />
        <Unit filename="Camera3D.cpp" />
        <Unit filename="Camera3D.hpp" />
        <Unit filename="Entity.hpp" />
        <Unit filename="Includes.hpp" />
        <Unit filename="RenderInfo.cpp" />
        <Unit filename="RenderInfo.hpp" />
        <Unit filename="Renderer.cpp" />
        <Unit filename="Renderer.hpp" />
        <Unit filename="Scene.cpp" />
        <Unit filename="Scene.hpp" />
        <Unit filename="TextureAtlas.cpp" />
        <Unit filename="TextureAtlas.hpp" />
        <Unit filename="dr.hpp" />
        <Unit filename="isoMap.cpp" />
        <Unit filename="isoMap.hpp" />
        <Extensions>
            <envvars />
            <code_completion />
            <lib_finder disable_auto="1" />
            <debugger />
            <DoxyBlocks>
                <comment_style block="0" line="0" />
                <doxyfile_project />
                <doxyfile_build />
                <doxyfile_warnings />
                <doxyfile_output />
                <doxyfile_dot />
                <general />
            </DoxyBlocks>
        </Extensions>
    </Project>
</CodeBlocks_project_file> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:30:34.053

我知道使用它开发库和应用程序的痛苦。

您确定要在更新时重新编译两者吗？- 通常 qt creator 只更新当前项目。如果您转到“项目”屏幕和“依赖项”选项卡，您可以告诉 QtCreator 一个项目依赖于另一个项目 - 应该始终保持同步。

如果库仍在开发中，还要避免将最终库复制到应用程序文件夹。最好的方法是将库从它的原始位置符号链接到您的应用程序目录。如今，即使是较新版本的 Windows 也提供符号链接（尽管我自己从未尝试过），因此您应该可以毫无困难地这样做。

如果这没有帮助，则需要更详细的分析，因此请为应用程序和库发布您的 qmake .pro 文件。

编辑：

顺便说一句“QtCreator 将期望库永远不会改变” - Qt Creator 根本不关心你的库 - 这是在 qmake 级别处理的（它也不关心它的内容，它只知道什么是写在 .pro 文件中），以及后来的链接器。

最简单的尝试是删除不是用户从两个项目中创建的所有内容 - 因此源和您的 .pro 文件以及任何等效的 Code::Block 使用是唯一保留的东西。然后像现在写它们一样编译它们。如果它仍然不起作用，则意味着它不是 QtCreator（或 qmake 或链接器）问题，而是您的源代码问题。

如果这不起作用，那么我怀疑您在构建环境中的某个地方有一些旧版本的库。看来您使用 linux 和 ld 作为编译器（对吗？）。尝试使用 --trace 选项来查看正在使用哪个版本的库。只需添加

```
LIBS += -Xlinker --trace 
```

到您的 .pro 文件，并查看编译器输出。

# java - 用于检测根并打印其 xml 节点的 for 循环

> ID：14341260
> 
> 赞同：0
> 
> 时间：2013-01-15T15:40:40.237
> 
> 标签：java, xml, itextsharp

我正在尝试根据从 jsp 页面发送的值动态读取节点。但不知何故，我陷入了 for 循环。假设我有这个 xml：

```
<123>
    <a1>A</a1>
    <a2>B</a2>
    <a3>C</a3>
</123> 
```

我正在使用这个函数来读取节点并获取输出：

```
try {
    PdfReader pdfReader = new PdfReader(fileName);
    PdfStamper pdfStamper = 
        new PdfStamper(pdfReader,new FileOutputStream(fileName));
    String xmlRecords = XmlString;
    DocumentBuilder db = 
        DocumentBuilderFactory.newInstance().newDocumentBuilder();
    InputSource is = new InputSource();
    is.setCharacterStream(new StringReader(xmlRecords));
    Document doc = db.parse(is);
    NodeList nodes = doc.getElementsByTagName("123");

    for(int i=1; i <= divlen; i++) {             
        for (int j = 0; j < nodes.getLength(); j++) {
            Element element = (Element) nodes.item(j);
            NodeList aval = element.getElementsByTagName("a"+i);
            Element line = (Element) aval.item(0);
            int avalue = Integer.parseInt(getCharacterDataFromElement(line));
        }
    }            
    pdfStamper.close();
} 
```

其中`divlen`是由 jsp 页面分配的“a”的总数。`for`但是，如果假设我删除 a2 节点并发送休息，我该如何运行 a1 和 a3 节点的循环？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T15:51:00.130

在您的情况下，我会创建 3 个列表（每个标签 a1、a2、a3 一个）。

然后我将只有内部 for 循环 (j)，在其中我根据元素的标签名称将元素放在列表之一中。

最后，在这个循环之后，我将处理每个列表中的每个元素以用于我需要做的任何目的。

# xml - Oracle XMLTABLE 函数未正确获取数据

> ID：14341261
> 
> 赞同：1
> 
> 时间：2013-01-15T15:40:41.297
> 
> 标签：xml, oracle, xml-parsing, oracle11g

我正在使用 Oracle 11g XMLTABLE 函数从附加的 XML 文件中获取数据。当我执行代码时，我得到 3 行。我正在检索产品，为与客户对应的每个产品正确生成一行。问题是我没有得到其余的客户数据，我得到了 CustomerName、CustomerDOB 和 CustomerEmail 的空值。出于某种原因，我正在使用的代码，Oracle 没有获取 2 个级别。请帮忙！我究竟做错了什么？

## XML

```
<?xml version="1.0" encoding="iso-8859-1"?>
<USACustomers>
    <NewYorkCustomers>
        <Customer>
            <CustomerData>
                <CustomerName>John Stark</CustomerName>
                <CustomerDOB>07/09/1973</CustomerDOB>
                <CustomerEmail>j.stark@liquid.com</CustomerEmail>
            </CustomerData>
            <CustomerAddress>
                <Address>400 Railroad Way</Address>
                <City>Larchmont</City>
                <State>NY</State>
                <Zip>10542</Zip>
            </CustomerAddress>
            <CustomerProducts>
                <CustomerProduct>
                    <PoductType>CTD</PoductType>
                    <ProductNumber>2050035302</ProductNumber>
                </CustomerProduct>
                <CustomerProduct>
                    <PoductType>REC</PoductType>
                    <ProductNumber>2050920400</ProductNumber>
                </CustomerProduct>
            </CustomerProducts>
        </Customer>
        <Customer>
            <CustomerData>
                <CustomerName>Maria Stark</CustomerName>
                <CustomerDOB>07/09/1972</CustomerDOB>
                <CustomerEmail>m.stark@liquid.com</CustomerEmail>
            </CustomerData>
            <CustomerAddress>
                <Address>410 Railroad Way</Address>
                <City>Larchmont</City>
                <State>NY</State>
                <Zip>10542</Zip>
            </CustomerAddress>
            <CustomerProducts>
                <CustomerProduct>
                    <PoductType>REC</PoductType>
                    <ProductNumber>2050920400</ProductNumber>
                </CustomerProduct>
            </CustomerProducts>
        </Customer>
    </NewYorkCustomers>
</USACustomers> 
```

## 代码

```
SELECT                            
CustomerName,
CustomerDOB,
CustomerEmail,
PoductType

FROM   XMLTABLE (                    '/USACustomers/NewYorkCustomers/Customer/CustomerProducts/CustomerProduct'
PASSING xmltype (BFILENAME ('BACKUP', 'TEST.xml'), NLS_CHARSET_ID ('AL32UTF8'))

COLUMNS CustomerName  VARCHAR2(50)    PATH 'CustomerData/CustomerName',
        CustomerDOB   VARCHAR2(50)    PATH 'CustomerData/CustomerDOB',
        CustomerEmail VARCHAR2(50)    PATH 'CustomerData/CustomerEmail',
        PoductType    VARCHAR2(50)    PATH 'PoductType',
        ProductNumber VARCHAR2(50)    PATH 'ProductNumber'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:06:44.523

嵌套它，因为您想首先提取客户数据，然后迭代每个产品。

```
select customername, customerdob, customeremail, PoductType, ProductNumber
  from (select customername, customerdob, customeremail, products
           from xmltable('/USACustomers/NewYorkCustomers/Customer' 
                         PASSING xmltype (BFILENAME ('BACKUP', 'TEST.xml'), NLS_CHARSET_ID ('AL32UTF8'))
                         columns customername varchar2(50) path 'CustomerData/CustomerName',
                                 customerdob varchar2(50) path 'CustomerData/CustomerDOB',
                                 customeremail varchar2(50) path 'CustomerData/CustomerEmail',
                                 products xmltype path 'CustomerProducts')) cust,
       xmltable('/CustomerProducts/CustomerProduct'
                passing cust.products
                columns PoductType    VARCHAR2(50)    PATH 'PoductType',
                        ProductNumber VARCHAR2(50)    PATH 'ProductNumber'); 
```

例如：

```
SQL> select customername, customerdob, customeremail, PoductType, ProductNumber
  2    from (select customername, customerdob, customeremail, products
  3             from mytable l,
  4                  xmltable('/USACustomers/NewYorkCustomers/Customer'
  5                           passing l.x
  6                           columns customername varchar2(50) path 'CustomerData/CustomerName',
  7                                   customerdob varchar2(50) path 'CustomerData/CustomerDOB',
  8                                   customeremail varchar2(50) path 'CustomerData/CustomerEmail',
  9                                   products xmltype path 'CustomerProducts')) cust,
 10         xmltable('/CustomerProducts/CustomerProduct'
 11                  passing cust.products
 12                  columns PoductType    VARCHAR2(50)    PATH 'PoductType',
 13                          ProductNumber VARCHAR2(50)    PATH 'ProductNumber');

CUSTOMERNAME         CUSTOMERDO CUSTOMEREMAIL        PODUCTTYPE PRODUCTNUMBER
-------------------- ---------- -------------------- ---------- -------------
John Stark           07/09/1973 j.stark@liquid.com   CTD        2050035302
John Stark           07/09/1973 j.stark@liquid.com   REC        2050920400
Maria Stark          07/09/1972 m.stark@liquid.com   REC        2050920400 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:15:15.050

你可以这样做（一个`xmltable()`电话：

```
SELECT                            
CustomerName,
CustomerDOB,
CustomerEmail,
PoductType

FROM   XMLTABLE ('for $i in $custt/USACustomers/NewYorkCustomers/Customer, 
                 $j in $i//CustomerProduct 
                 return <deNormalizedCust>{$i//CustomerData}{$j}</deNormalizedCust>'
PASSING xmltype(BFILENAME ('BACKUP', 'TEST.xml'), NLS_CHARSET_ID ('AL32UTF8'))
as "custt"
COLUMNS CustomerName  VARCHAR2(50)    PATH '/deNormalizedCust/CustomerData/CustomerName',
        CustomerDOB   VARCHAR2(50)    PATH '/deNormalizedCust/CustomerData/CustomerDOB',
        CustomerEmail VARCHAR2(50)    PATH '/deNormalizedCust/CustomerData/CustomerEmail',
        PoductType    VARCHAR2(50)    PATH '/deNormalizedCust/CustomerProduct/PoductType',
        ProductNumber VARCHAR2(50)    PATH '/deNormalizedCust/CustomerProduct/ProductNumber'); 
```

[这是一个 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/d41d8/6124)

# c++ - ffmpeg：如何将 h264 原始数据保存为 mp4 文件

> ID：14341262
> 
> 赞同：3
> 
> 时间：2013-01-15T15:40:45.037
> 
> 标签：c++, ffmpeg, h.264, mp4

我通过 libavcodec 对 h264 数据进行编码。前任。

```
while (1) {
  ...
  avcodec_encode_video(pEnc->pCtx, OutBuf, ENC_OUTSIZE, pEnc->pYUVFrame);
  ...
} 
```

如果我直接将 OutBuf 数据保存为 .264 文件，则播放器无法播放。现在我想保存 OutBuf

作为 mp4 文件。任何人都知道如何通过 ffmpeg lib 做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T15:47:35.013

您使用`avformat_write_header`, `av_interleaved_write_frame`,`avformat_write_trailer`和朋友。

它们的用法显示在FFmpeg的[复用示例中。](https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/muxing.c)

查看类似的主题：[使用 libavcodec 的 mpegts 容器中的原始 H264 帧](https://stackoverflow.com/questions/5964142/raw-h264-frames-in-mpegts-container-using-libavcodec)，同时写入文件（不同的容器，相同的 API）

另请参阅此处答案的链接：[FFMpeg encoding RGB images to H264](https://stackoverflow.com/questions/2911798/ffmpeg-encoding-rgb-images-to-h264/5995994#5995994)

# mysql - 这个 xslt 有什么问题？

> ID：14341271
> 
> 赞同：2
> 
> 时间：2013-01-15T15:41:17.693
> 
> 标签：mysql, xml, xslt, liquibase

数据文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <changeSet >
      ...
    </changeSet>
    <changeSet >
      ...
    </changeSet>
</databaseChangeLog> 
```

xslt

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="/">    
      <xsl:for-each select="databaseChangeLog/changeSet">       
        <top>  
         <xsl:copy-of select="*"/>      
        </top> 
      </xsl:for-each>   
  </xsl:template>
</xsl:stylesheet> 
```

使用`xsltproc`工具：

```
xsltproc input.xslt  input.xml 
```

什么都不输出。

我的 xslt 有什么问题？

**最终工作表.xslt：**

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:db="http://www.liquibase.org/xml/ns/dbchangelog"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml"  indent="yes" />
  <xsl:template match="/">    
      <xsl:for-each select="db:databaseChangeLog/db:changeSet">     
          <xsl:document  href="base/tables/{position()}_{name(*[1])}_{*[1]/@tableName}.xml">
           <databaseChangeLog 
                xmlns="http://www.liquibase.org/xml/ns/dbchangelog" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">               
                <xsl:copy-of select="."/>                   
            </databaseChangeLog> 
        </xsl:document> 
      </xsl:for-each>     
  </xsl:template>
</xsl:stylesheet> 
```

**注意：**这会将变更日志（liquibase generateChangeLog 输出）拆分为单独的变更日志文件

`xsltproc table.xslt liquibase.changelog.xml`

这成功地为 log file 中的每个 changeSet 生成一个文件。（我的下一个目标是对单个表上的变更集进行分组，但这超出了这个问题的范围）

如果你想知道我在做什么。

Liquibase 迁移工具为现有数据库生成单个更改日志文件。我正在尝试将该输出拆分为每个表/对象（特别是 mysql）的单独日志文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:48:51.923

样式表中缺少命名空间。这有效：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:db="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="/">    
      <xsl:for-each select="db:databaseChangeLog/db:changeSet">       
        <top>  
          <xsl:copy-of select="*"/>      
        </top> 
      </xsl:for-each>   
  </xsl:template>
</xsl:stylesheet> 
```

# linq - 加入来自多个上下文的 LINQ 查询

> ID：14341274
> 
> 赞同：1
> 
> 时间：2013-01-15T15:41:24.323
> 
> 标签：linq, asp.net-mvc-4, ef-code-first

我正在尝试为要在视图中显示的数据创建 ViewModel。问题是，显示的数据分布在 2 个数据库和每个数据库中的多个表中。我读过你不能跨多个上下文加入 Linq 查询，这是有道理的，而且我还读过我们不能在 EF5 中使用 Code-First 来使用存储过程......这导致我使用了 3 种不同的Linq 查询并尝试将它们组合成 1 个 ViewModel...我只是不确定如何到达那里。

这是我的 Linq 查询：

```
var csdContext = new CSDContext(CustomerCode);
var masterContext = new MasterContext();

//Only returns 1 row - which is what we want.
List<Site> sites = (from s in csdContext.Sites
                join sa in csdContext.SiteAddresses
                    on s.SiteID equals sa.SiteID
                join a in csdContext.Addresses
                    on sa.AddressID equals a.AddressID
                join spv in csdContext.SiteProductVersions
                    on s.SiteID equals spv.ProductVersionID
                where s.SiteID == id
                select s).ToList();

//List
List<States> states = (from s in masterContext.StatesTable
                    select s).ToList(); 
```

我的 ViewModel 看起来像这样：

```
public class SiteDetailsViewModel
{
    public string Address { get; set; }
    public string Address2 { get; set; }
    public string City { get; set; }
    public string StateCode { get; set; }
    public string ZipCode { get; set; }
    public string OfficePhone { get; set; }
    public string MobilePhone { get; set; }
    public string AlternativePhone { get; set; }
    public int ProductVersionID { get; set; }
} 
```

基本上，我需要这些表中的以下数据：
**csdContext - Address**
Address
Address2
City
ZipCode

**csdContext - 站点**
OfficePhone
MobilePhone
AlternativePhone

**csdContext - SiteProductVersions**
ProductVersionID

 **masterContext **-状态状态代码**** 

 **以下是表在 SQL 中的连接方式：

```
SELECT csd_a.Address, csd_a.Address2, csd_a.City, mstr_st.StateCode, csd_a.ZipCode, csd_s.OfficePhone, csd_s.MobilePhone, 
csd_s.AlternativePhone, csd_spv.ProductVersionID
FROM CSD.dbo.Sites AS csd_s 
INNER JOIN  CSD.dbo.SiteAddress AS csd_sa ON csd_sa.SiteID = csd_s.SiteID 
INNER JOIN  CSD.dbo.Address AS csd_a ON csd_a.AddressID = csd_sa.AddressID 
INNER JOIN CSD.dbo.SiteProductVersions AS csd_spv ON csd_s.SiteID = csd_spv.SiteID 
INNER JOIN MasterDB.dbo.States AS mstr_st ON mstr_st.StateID = csd_a.StateID 
```

我不知道如何合并这 3 个结果来为 SiteDetailsViewModel 创建 ViewModel 数据。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:51:09.290

如果您按照 OP 中的描述具体化您的查询，您可以使用它：

```
var query = sites.Join(
            states,
            si => si.StateID,
            st => st.StateID,
           (si, st) => new SiteDetailsViewModel
                        {
                             Address = si.Address,
                             Address2 = si.Address2,
                             City = si.City,
                             StateCode = st.StateCode,
                             ZipCode = si.ZipCode,
                             OfficePhone = si.OfficePhone,
                             MobilePhone = si.MobilePhone,
                             AlternativePhone = si.AlternativePhone,
                             ProductVersionID = siProductVersionID
                        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:24:41.000

一种可能的替代解决方案是在 DB #1 中的表的 DB #2 中创建视图。然后，您可以在 EF 中为 DB #2 建模/映射这些视图。如果您需要更新任何表，您当然仍然需要 DB #1 的上下文。但是这个解决方案的好处是您可以在单个上下文中执行所有读取访问，并在服务器而不是内存中获得连接。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T15:45:44.767

那你为什么不这样写：

```
from ...
...
where s.SiteID == id
select new SiteDetailsViewModel()
{
    Address = sa.Address,
    Address2 = as.Address2,
    ..
} 
```**

# javascript - 当窗口缩放或不同分辨率时保持菜单不变？

> ID：14341276
> 
> 赞同：0
> 
> 时间：2013-01-15T15:41:31.123
> 
> 标签：javascript, jquery, html

这是我固定在窗口顶部的垂直导航，如果用户缩放窗口或以不同的分辨率打开，如果减小字体使其不会转到下一行并且所有项目都可见？

```
<ul id="navmenu" class="drop">

  <li><a href="#">Home</a></li>
  <li><a href="#">Updates</a></li>
  <li><a href="#">Assignment</a> </li>
  <li><a href="#">Project</a></li>  
  <li><a href="#">Practice</a></li>
   <li><a href="#">Shedule</a></li>
  <li><a href="#">Fee</a></li>
   <li><a href="#">Reports</a></li>
    <li><a href="#">Export</a></li>
  <li><a href="#">Account</a> </li>

</ul>

ul#navmenu {margin: 0 0 0 0%;}
ul.drop a { display:block; color:white; text-decoration:none;}
ul.drop, ul.drop li, ul.drop ul { list-style: none; margin: 0; padding: 0; color: #fff; }
ul.drop { position: relative; z-index: 60; float: left; }
ul.drop li { float: left; vertical-align: middle; }
ul.drop li.hover, ul.drop li:hover { position: relative; z-index: 70; cursor: default; }
ul.drop ul { width:6em; visibility: hidden; padding: 2px 1px;  position: absolute; top: 100%; left: 0; z-index: 65; }
ul.drop ul li { float: none; }
ul.drop ul ul { top: -2px; left: 100%; }
ul.drop li:hover > ul { visibility: visible ; } 
```

# java - 有没有一种通用的方法可以将 JUnit 测试标记为待处理？

> ID：14341277
> 
> 赞同：21
> 
> 时间：2013-01-15T15:41:31.527
> 
> 标签：java, junit, tdd, junit4

在进入 TDD 循环之前，我喜欢勾勒出需要实现的测试——即编写带有口语名称的空测试方法。

不幸的是，我还没有找到“将它们涂成黄色”的方法——将它们标记为 JUnit 待处理。我可以让他们要么失败要么通过。现在我通过抛出一个 让它们失败`Exception`，但我宁愿使用`pending`from rspec 的等价物。

JUnit 或“相邻”库中是否有这样的选项？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-15T15:43:59.747

您可以使用[`@Ignore`](http://junit.sourceforge.net/javadoc/org/junit/Ignore.html)忽略测试，

或者这个库来引入`@PendingImplementation`注解：

[https://github.com/ttsui/待定](https://github.com/ttsui/pending)

我认为没有其他方法可以实现这一目标..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T15:45:11.210

您可以使用[Assume](http://junit.sourceforge.net/javadoc/org/junit/Assume.html)或[@Ignore](http://api.dpml.net/junit/4.2/org/junit/Ignore.html)，两者都不是您所追求的，但很接近。也存在[未决](https://github.com/ttsui/pending)的第 3 方库。我没有使用它，但似乎可以做你想做的事。

# xml - XML 错误：Amazon Envelope XML 级别的格式错误

> ID：14341287
> 
> 赞同：1
> 
> 时间：2013-01-15T15:41:58.233
> 
> 标签：xml, coldfusion, amazon-web-services, xmlhttprequest

我正在尝试让 Amazon Order Fulfillment API 正常工作，但遇到了问题。当我提交 HTTP 请求时，响应说它已提交，但是当我查看亚马逊的“上传订单相关文件”部分时，它说有一个错误。我得到的错误如下所示：

```
The XML you submitted is ill-formed at the Amazon Envelope XML level at (or near) line 2, column 18. 
```

这是我的 XML 请求

```
<?xml version="1.0" encoding="UTF-8"?>
            <AmazonEnvelope xsi:noNamespaceSchemaLocation="amzn-envelope.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <Header> 
                    <DocumentVersion>1.01</DocumentVersion> 
                    <MerchantIdentifier>M_MySite_1234567</MerchantIdentifier> 
                </Header>
                <MessageType>OrderFulfillment</MessageType>
                <Message> 
                    <MessageID>1</MessageID> 
                    <OrderFulfillment> 
                        <AmazonOrderID>112-0023859-8293023</AmazonOrderID>
                        <MerchantFulfillmentID>789456123545646312</MerchantFulfillmentID> 
                        <FulfillmentDate>2013-01-14T10:42:33</FulfillmentDate> 
                        <FulfillmentData> 
                            <CarrierCode>UPS</CarrierCode> 
                            <ShippingMethod>UPS Ground</ShippingMethod> 
                            <ShipperTrackingNumber>1Z19Y92EYW42152145</ShipperTrackingNumber> 
                        </FulfillmentData> 
                        <Item> 
                            <MerchantFulfillmentItemID>123456700000074</MerchantFulfillmentItemID>
                            <Quantity>1</Quantity>
                        </Item>
                    </OrderFulfillment> 
                </Message>
            </AmazonEnvelope> 
```

我不确定我做错了什么。我正在运行 ColdFusion 9。

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T17:13:39.013

我能够找出这个帖子的问题。似乎它失败的原因是因为正在生成的 XML 在

```
<?xml version="1.0" encoding="UTF-8"?> 
```

这导致 XML 在 Amazon 方面失败。

# visual-c++ - Clickonce 安装程序

> ID：14341293
> 
> 赞同：1
> 
> 时间：2013-01-15T15:42:20.393
> 
> 标签：visual-c++, ms-word, clickonce, web-platform-installer

我在 MSVC2010 中使用 ClickOnce 作为安装程序创建了 MS Word 2007 应用程序，我的问题是这样的应用程序是否可以免费用于商业用途。如果不是，我或我的客户必须符合哪些标准？

谢谢

# android - Intent.FLAG_ACTIVITY_CLEAR_TASK|Intent.FLAG_ACTIVITY_NEW_TASK 无法正常工作 Android

> ID：14341294
> 
> 赞同：8
> 
> 时间：2013-01-15T15:42:21.137
> 
> 标签：android

好吧，那是我的问题。

我需要，当用户按下后底部时，删除所有打开的活动的堆栈：

```
@Override
public void onBackPressed(){
    Intent i = new Intent(context, CrisolMainApp.class);
    i.putExtra(CrisolMainApp.CERRAR_APP, true);
    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK|Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(i);
} 
```

关键是这适用于我的大多数手机，但昨天我尝试使用三星 Galaxy Mini（android 2.3.3）但它不工作！它不会删除活动堆栈。

有谁知道为什么？

编辑：我正在检查文档，我发现 API 11 上添加了“Intent.FLAG_ACTIVITY_CLEAR_TASK”（我的三星 Galaxy Mini 适用于 Android 2.3.3，因此，API 10）......我不知道，但我想这就是问题所在。

任何人都知道我怎样才能使它在 API 小于 11 时以相同的方式工作？

我试图通过添加这些标志，但它也不起作用：

```
@Override
public void onBackPressed(){
    Intent a = new Intent(this, CrisolMainApp.class);
    a.putExtra(CrisolMainApp.CERRAR_APP, true);
    a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK|Intent.FLAG_ACTIVITY_NEW_TASK);
    a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    a.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    startActivity(a);
    finish();
} 
```

我也试过：

```
@Override
    public void onBackPressed(){
        Intent a = new Intent(this, CrisolMainApp.class);
        a.putExtra(CrisolMainApp.CERRAR_APP, true);
        a.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        a.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
        startActivity(a);
        finish();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:39:17.093

一个简单的修复应该是将 xml 属性添加`android:noHistory="true"`到所有活动中，这意味着一旦用户离开该活动，它就会消失，并且不会存储任何回栈

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:44:04.570

你没有完成活动。

```
Intent i = new Intent(context, CrisolMainApp.class);
i.putExtra(CrisolMainApp.CERRAR_APP, true);
i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK|Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(i);
finish(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-03T13:25:24.360

您可以使用支持库并从支持库`IntentCompat.FLAG_ACTIVITY_CLEAR_TASK`导入API 10。`import android.support.v4.content.IntentCompat;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-12T17:44:51.433

如果您在 Intent 'i' 中添加 addFlags，您的 Intent ACTION_SEND 将不起作用，但如果在响应 createChooser() 中添加 addFlags，则仅创建一个 ACTION_SEND 实例。

```
 if (i == null) i = new Intent();
            i.setAction(Intent.ACTION_SEND);
            i.putExtra(Intent.EXTRA_STREAM, getImageUri());
            i.setType(Constantes.IMAGE_STREAM);
            startActivity(Intent.createChooser(i, messageShare).addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK)); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-15T16:07:55.380

尝试添加这些标志：

```
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); //use this if you want to clear the stack
intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP); // use this if you don't want to clear your home activity 
```

这应该清除堆栈中的所有活动，除了这个被带到前面的活动。你不应该使用`finish();`

# mysqli - “mysqli_stmt::bind_param”是否隐式使用“mysqli::real_escape_string”？

> ID：14341297
> 
> 赞同：0
> 
> 时间：2013-01-15T15:42:35.637
> 
> 标签：mysqli

mysqli_stmt **::bind_param**是否隐式使用**mysqli::real_escape_string**？还是我们必须手动完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:27:05.307

既不`mysqli_stmt::bind_param`是`mysqli::real_escape_string`隐含的，也不是你必须手动做的。

首先，**逃避不是安全的同义词。**虽然绑定是。
所以，这是无可比拟的事情。解释请参考我之前的回答：[Properly Escaping with MySQLI | 查询准备好的语句](https://stackoverflow.com/a/14313305/285587)

接下来，bind_param 无论如何都不使用转义 - 它是不同的机制
请参考另一个我的完整解释的答案：[准备好的语句如何防止 SQL 注入攻击？](https://stackoverflow.com/a/8265319/285587)

# c# - XML 动态序列化/反序列化

> ID：14341298
> 
> 赞同：1
> 
> 时间：2013-01-15T15:42:50.747
> 
> 标签：c#, .net, xml-serialization

我有一个对象，它的 XML 结构是动态的，可以根据应用程序更改运行时。

我想做的是为每个属性的声明指定 XML 元素位置。但是，这似乎无法在运行时完成，需要静态设置。还有另一种方法可以完成我想做的事情吗？

```
 public class user
 {
      [System.Xml.Serialization.XmlElement(XMLLocation.PersonUsername)]
      public String name;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:51:57.207

由于数据是相同的但传递给不同的应用程序，我建议使用相同的内部 XML 并在传递之前使用 XSLT 处理它。

实现 IXmlSerializable 当然是可能的，其他方法也是如此，但是您会发现自己编写了复杂且不可维护的代码。

# android - 在画布中翻转动画

> ID：14341299
> 
> 赞同：0
> 
> 时间：2013-01-15T15:42:57.870
> 
> 标签：android, android-canvas

如何在android画布中翻转位图。？

我可以使用动画类翻转视图，但如何翻转画布中的位图。？

通过使用`canvas.rotate(x)`；我可以旋转画布选择的路径，但我的要求是翻转..有人可以帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:51:04.353

您可以`Matrix`为此使用：

```
final Matrix matrix = new Matrix();  

matrix.postScale(-1, 1);
matrix.postTranslate(positionX, positionY);                     

canvas.drawBitmap(bitmap, matrix, paint); 
```

# c# - SQL 中未使用的字符/字符组合

> ID：14341304
> 
> 赞同：2
> 
> 时间：2013-01-15T15:43:08.610
> 
> 标签：c#, asp.net, sql, regex

我正在尝试从创建脚本的人定义的 SQL 脚本（在 C# 中使用正则表达式）中选择一个值，然后可以在其他人需要时替换该值。

我已经成功地使用了两次大于和小于符号来做到这一点，例如`SELECT * FROM users WHERE username = '<<username>>'`，这很好用。

我遇到的问题是，当我将此脚本添加到数据库中以存储它时（使用 aspx 页面），它会引发以下错误：

```
System.Web.HttpRequestValidationException: A potentially dangerous Request.Form value was detected from the client (ctl00$MainBody$tstScriptTextBox="...username = '<<username>>';"). 
```

我的问题是：是否有任何其他符号不会在 SQL 脚本中使用并且不会导致 Regex 出现任何问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:49:00.110

阅读这篇文章[Script Exploits Overview](http://msdn.microsoft.com/en-gb/library/w1sw53ds.aspx) - 例外不是关于特定符号，而是如标题所示，更多关于潜在的脚本漏洞。

# powershell - 想要使用 Powershell 从目录（递归）中查找和复制文件（带有特定文件 ext）？

> ID：14341312
> 
> 赞同：-2
> 
> 时间：2013-01-15T15:43:28.850
> 
> 标签：powershell, scripting

我正在寻找递归文件夹结构（ex.F:\Directory\layer1\layer2\layer3）并找到所有具有指定文件扩展名的文件（例如“.dll，.txt”）。然后我需要将列出/找到的文件复制到目标文件夹。

如果有人可以向我发送一个可以做到这一点的好的 PowerScript，我将不胜感激。

我有一个包含大约 1,000 个文件夹和 5,000 个文件的驱动器，因此这可能会为我节省一两天的手动工作。:)

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:33:26.247

尝试以下，根据需要修改：

```
$movetopath = "C:\new folder\"
New-Item -Path $movetopath -ItemType Directory -Force
$files = Get-ChildItem -Path F:\ -Recurse
$files | Where-Object {$($_.Extension -eq ".dll") -or $($_.Extension -eq ".txt")} | ForEach-Object {Copy-Item $_ -Destination $movetopath} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:46:36.390

我建议您先使用 find 命令，然后将 find 命令的输出通过管道传输到 tar。将存档解压缩到目标文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:31:01.453

尝试类似的东西

```
Get-ChildItem -Path $path -Recurse | where { !$_.PSIsContainer } | where { $_.Extension -eq ".txt" -or $_.Extension -eq ".log" } | Copy-Item -Destination $dest 
```

这可能比 robocopy 慢。另外，下次请表现出一些努力并提出一个问题，而不是一个完整的解决方案。这不是网店。

# api - 使用 Nokia/Yelp Map API 查找区域内的 POI

> ID：14341316
> 
> 赞同：0
> 
> 时间：2013-01-15T15:43:39.593
> 
> 标签：api, map, yelp, here-api

我正在尝试使用地图 API 查找特定区域内的 POI 数量。有人建议我使用诺基亚或 Yelp API，但我正在努力弄清楚如何开始这个项目。

兴趣点的实际类型并不重要，在这种情况下都是相关的。如果有人对这些地图 API 有任何经验并且知道我应该看什么，或者对我开始有用的示例，我将非常感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:03:05.830

首先要看的是相关 API 的开发者文档站点。对于诺基亚 API，您将查看[JavaScript 文档](http://developer.here.net/javascript_api)或[RESTful Places API](http://developer.here.net/places)，对于 Yelp，请尝试[http://www.yelp.com/developers/](http://www.yelp.com/developers/)下的链接 （免责声明 - 我个人不使用 Yelp）

有许多示例使用[API 资源](http://developer.here.net/javascript_api_explorer)管理器中的 Nokia Place api进行操作并在屏幕上查看结果。

这里有几个有用的例子可以帮助你入门

*   [附近地点 REST 响应示例](http://developer.here.net/apiexplorer/examples/api-for-rest/places-search/explore-nearby-places.html)
*   [吃饭的地方 JavaScript 示例](http://developer.here.net/apiexplorer/examples/api-for-js/places-search/places-search-by-category.html)

Nokia Places API 和 Yelp API 都是本地搜索 API - 换句话说，它们总是回答“我在哪里可以找到Y**附近**的X？”的问题，因此在他们的数据库中查找POI 的**总数**并不是一项现实的任务（因为许多 POI 将被认为与搜索位置无关，您可以做的是查找特定位置内 POI 的密度。

下面的代码最初会显示柏林市中心的书店，但如果你改变地图的焦点，它也会在其他城镇找到书店。您需要获取自己的免费[应用程序 ID 和令牌](http://www.developer.nokia.com/Community/Wiki/How_to_Obtain_Your_Own_Nokia_appID_and_Token)才能使其正常工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- 
    Example from Nokia Maps API Playground, for more information visit http://api.maps.nokia.com
 -->
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7; IE=EmulateIE9"/>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <title>Nokia Maps API Example: Search by category</title>
        <meta name="description" content="Search by category"/>
        <meta name="keywords" content="search, services, places, category"/>
        <!-- For scaling content for mobile devices, setting the viewport to the width of the device-->
        <meta name=viewport content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <!-- By default we add ?with=all to load every package available, it's better to change this parameter to your use case. Options ?with=maps|positioning|places|placesdata|directions|datarendering|all -->
        <script type="text/javascript" charset="UTF-8" src="http://api.maps.nokia.com/2.2.3/jsl.js?with=all"></script>
        <!-- JavaScript for example container (NoteContainer & Logger)  -->
        <style type="text/css">
            html {
                overflow:hidden;
            }

            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
                width: 100%;
                height: 100%;
                position: absolute;
            }

            #mapContainer {
                width: 80%;
                height: 80%;
                left: 0;
                top: 0;
                position: absolute;
            }
            #progress {
                width: 80%;
                height: 10%;
                left: 0;
                top: 80%;
                position: absolute;
            }
            #buttons {
                width: 80%;
                height: 10%;
                left: 0;
                top: 90%;
                position: absolute;
            }
        </style>
    </head>
    <body>
        <div id="mapContainer"></div>
        <div id="progress"></div>
        <div id="buttons">
         <a onClick="searchByCategory( map.center, 'bookshop' );return false;" href="#">Find Bookshops</a> 
        </div>
        <script type="text/javascript" id="exampleJsSource">
/*  Set authentication token and appid 
*   WARNING: this is a demo-only key
*   please register on http://api.developer.nokia.com/ 
*   and obtain your own developer's API key 
*/
nokia.Settings.set("appId", "YOUR APP_ID"); 
nokia.Settings.set("authenticationToken", "YOUR TOKEN");

// Get the DOM node to which we will append the map
var mapContainer = document.getElementById("mapContainer");
// Create a map inside the map container DOM node
var map = new nokia.maps.map.Display(mapContainer, {
    // Initial center and zoom level of the map
    center: [52.51, 13.4],
    zoomLevel: 10,
    components: [       
        new nokia.maps.map.component.Behavior()
    ]
});

var searchManager = nokia.places.search.manager,
    resultSet;

var searchCat;  
var maxDistance = 0;

// Function for receiving search results from places search and process them
var processResults = function (data, requestStatus, requestId) {
    var i, len, locations, marker;

    if (requestStatus == "OK") {
        // The function findPlaces() and reverseGeoCode() of  return results in slightly different formats
        locations = data.results ? data.results.items : [data.location];
        // We check that at least one location has been found
        if (locations.length > 0) {
            // Remove results from previous search from the map
            if (resultSet) map.objects.remove(resultSet);
            // Convert all found locations into a set of markers
            resultSet = new nokia.maps.map.Container();
            for (i = 0, len = locations.length; i < len; i++) {
                marker = new nokia.maps.map.StandardMarker(locations[i].position, { text: i+1 });
                resultSet.objects.add(marker);
                if (locations[i].distance > maxDistance){
                    maxDistance = locations[i].distance;
                }
            }
            // Next we add the marker(s) to the map's object collection so they will be rendered onto the map
            map.objects.add(resultSet);
            // We zoom the map to a view that encapsulates all the markers into map's viewport
            map.zoomTo(resultSet.getBoundingBox(), false);

            progressUiElt.innerHTML = locations.length  + " places found in the '" + searchCat + "' category within " + maxDistance + "m of "+ data.search.location.address.city ;
        } else { 
            alert("Your search produced no results!");
        }
    } else {
        alert("The search request failed");
    }
};

// Binding of DOM elements to several variables so we can install event handlers.
var progressUiElt = document.getElementById("progress");

searchByCategory = function(searchCenter   , category){
// Make a place search request
searchCat = category;
progressUiElt.innerHTML = "Looking for places in the '" + category + "' category...'";
searchManager.findPlacesByCategory({
    category: category,
    onComplete: processResults,
    searchCenter: searchCenter,
    limit: 100,
});
}
// Search for Bookshops in Berlin
searchByCategory( new nokia.maps.geo.Coordinate(52.51, 13.4), "bookshop" );

        </script>
    </body>
</html> 
```

所以你可以看到柏林有 100 多家书店，但波茨坦只有 37 家。

# php - Jquery DataTables 可排序距离列

> ID：14341318
> 
> 赞同：1
> 
> 时间：2013-01-15T15:43:50.780
> 
> 标签：php, javascript, datatables, jquery-ui-sortable

所以我有 jQuery DataTables 设置并运行良好。我的最终目标是允许用户使用谷歌位置自动完成，更新他们的位置，然后在刷新时将“可排序”距离列添加到我的 DataTables 表中。

计划是在谷歌自动完成的文本输入旁边有一个按钮，表示使用这个地址，一旦用户使用自动完成搜索并找到一个地址，然后按下按钮，我想（可能）将它们发送到加载页面几秒钟，而我们

1）读取文本字符串，将其格式化以与谷歌地理编码api一起使用，又名

“Cranbourne, Victoria, Australia” ----> “Cranbourne+Victoria+Australia”

2）将其插入地理编码请求

3) 从生成的 json 中提取 lat 和 lon 值，并将它们分配给 vars

现在是困难的部分，我正在考虑使用一些 php 来计算用户（纬度，经度）与 DataTable 表中的每个条目之间的距离，该表使用外键填充了 sql 数据（所有 sql行有纬度数据）

然后我正在考虑将所述条目发送到 xml，只是这次每个条目都会有一个额外的值“DISTANCE”。

粗略的一些聪明的代码，这整个事情不会花一秒钟，然后用 xml 填充新的 DataTable 表，只是这一次它包含一个距离列，每行的距离值，粗略的将是可排序的，没有任何 DataTables破解什么。

那么我是愚蠢的，还是这是一个好主意，有没有更简单的方法？

我真的很想得到一些答案，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:49:39.217

这实际上可能很困难（取决于您的数学专业知识），因为它需要使用球面几何。您可以考虑使用 API：

[https://developers.google.com/maps/documentation/distancematrix/](https://developers.google.com/maps/documentation/distancematrix/)

如果您想尝试自己做，您可能需要使用为此编写的类，例如：

[http://www.phpclasses.org/browse/file/36294.html](http://www.phpclasses.org/browse/file/36294.html)

第二种选择可能更好，因为 Google 对其 API 有限制。一旦有了计算距离的方法，查询数据库并创建 XML 就很简单了。我不知道您为什么要使用 XML 而不是 json，但是 PHP 函数 json_encode() 可能会使它更简单，并且它受到 DataTables 的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-02T14:00:59.710

我知道这是一个非常古老的问题，但我刚刚遇到它并想推荐使用[Haversine 公式](https://en.wikipedia.org/wiki/Haversine_formula)来计算纬度/经度值之间的距离

我已经使用[了这个](https://stackoverflow.com/a/21623206/1851509)实现，发现它工作得非常好

# python - Python 脚本参数条件

> ID：14341321
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:43:59.750
> 
> 标签：python, command-line

有人能告诉我如何在 python 脚本上为参数编写条件吗？如果它使用第二个命令行参数运行，我希望它打印“Argument2 Entered”，例如：

```
python script.py argument1 argument2 
```

如果它在没有命令行参数的情况下运行，则打印“No second argument”，如下所示：

```
python script.py argument1 
```

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:48:22.520

```
import sys

if len(sys.argv)==2: # first entry in sys.argv is script itself...
    print "No second argument"
elif len(sys.argv)==3:
    print "Second argument" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T15:52:40.427

对此有很多答案，具体取决于您想要做什么以及您可能需要多少灵活性。

最简单的解决方案是检查变量`sys.argv`，它是一个包含所有命令行参数的列表。（它还包含脚本的名称作为第一个元素。）为此，只需查看`len(sys.argv)`并根据其值更改行为。

但是，对于人们期望命令行程序执行的操作而言，这通常不够灵活。例如，如果您想要一个标志 ( `-i`, `--no-defaults`, ...)，那么如何用 just 编写一个标志并不明显`sys.argv`。对于参数 ( `--dest-dir="downloads"`) 也是如此。因此，人们编写了许多模块来简化这种参数解析。

内置解决方案是`argparse`，它功能强大且非常易于使用，但不是特别简洁。

一个聪明的解决方案是`plac`，它检查`main`函数的签名以尝试推断命令行参数应该是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:50:00.443

以下块应该是不言自明的

```
$ ./first.py second third 4th 5th
5
$ cat first.py 
#!/usr/bin/env python

import sys

print (len(sys.argv)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T15:52:45.680

这与许多其他帖子有关，具体取决于您的去向，因此我将在此处放置四个：

[获取/解析传递给 Python 脚本的命令行参数的最佳方法是什么？](https://stackoverflow.com/questions/20063/whats-the-best-way-to-grab-parse-command-line-arguments-passed-to-a-python-scrip)
[实现“[command] [action] [parameter]”风格的命令行界面？](https://stackoverflow.com/questions/362426/implementing-a-command-action-parameter-style-command-line-interfaces)
[如何在 Python 中处理命令行参数？](https://stackoverflow.com/questions/567879/how-can-i-process-command-line-arguments-in-python)
[如何使用 Python 的 optparse 格式化位置参数帮助？](https://stackoverflow.com/questions/642648/how-do-i-format-positional-argument-help-using-pythons-optparse)

但是 Python 文档对您的问题的直接回答：

> **sys.argv** - 传递给 Python 脚本的命令行参数列表。argv[0] 是脚本名称（它是否为完整路径名取决于操作系统）。如果命令是使用解释器的 -c 命令行选项执行的，则 argv[0] 设置为字符串“-c”。如果没有将脚本名称传递给 Python 解释器，则 argv[0] 是空字符串。要遍历标准输入或命令行上给出的文件列表，请参阅 fileinput 模块。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-12T18:09:00.540

在 Python 中有很多方法可以完成这个简单的事情。如果您有兴趣了解比我推荐的更多信息，请阅读[本文](https://realpython.com/python-command-line-arguments)。顺便说一句，我在下面给你一个解决方案：

```
import click

'''
Prerequisite: # python -m pip install click
run: python main.py ttt yyy
'''

@click.command(context_settings=dict(ignore_unknown_options=True))
@click.argument("argument1")
@click.argument("argument2")
def main(argument1, argument2):
    print(f"argument1={argument1} and argument2={argument2}")

if __name__ == '__main__':
    main() 
```

# opencv - C api 和 C++ api 中的 Sobel

> ID：14341324
> 
> 赞同：1
> 
> 时间：2013-01-15T15:44:06.963
> 
> 标签：opencv

我刚刚使用 C api 和 C++ api 测试了 Sobel。但为什么不一样呢？我使用的所有参数都是相同的。

![Sobel 使用 C API](../Images/1f6e5a89a71c8bea94e944ae6c697316.png)输出 - 使用 C API

![Sobel 使用 C++ API](../Images/d1318914d5656fa57ac997393f762fd7.png)输出 - 使用 C++ API

**已编辑**

C API：

```
/// Generate grad_x
grad_x = cvCreateImage(cvGetSize(grayImg), IPL_DEPTH_16S, 1);
abs_grad_x = cvCreateImage(cvGetSize(grayImg), 8, 1);

/// Gradient X
cvSobel(grayImg, grad_x, 1, 0, 3);
cvConvertScaleAbs(grad_x, abs_grad_x);
cvThreshold(abs_grad_x, abs_grad_x, 0, 255, CV_THRESH_BINARY|CV_THRESH_OTSU); 
```

C++ API：

```
cv::Mat img_sobel;
cv::Sobel(img_gray, img_sobel, CV_8U, 1, 0, 3, 1, 0, BORDER_DEFAULT);

Mat img_threshold;
threshold(img_sobel, img_threshold, 0, 255, CV_THRESH_OTSU+CV_THRESH_BINARY); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:42:49.897

结果不同只有一个原因。数据类型！

在 C 版本中，您正在深度创建`grad_x`。`IPL_DEPTH_16S`所以每个像素都有`short`数据类型。这提高了调用`cvSobel`函数时获得的结果的精度。`cvSobel`能够在结果中容纳更广泛的值（-32768 到 32767）`grad_x`。

在 C++ 版本中，您没有初始化矩阵并指定目标类型`CV_8U`。该函数在`cv::Sobel`内部创建 CV_8U 类型的目标矩阵，计算结果，然后将它们钳制在目标数据类型的范围内，即从 0 到 255。因此所有负值都变为 0。

要在 C 版本中获得相同的结果，`IPL_DEPTH_16S`请将`IPL_DEPTH_8U`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:55:04.050

将 c++ 代码的最后一行从更改
`threshold(img_sobel, img_threshold, 0, 255, CV_THRESH_OTSU+CV_THRESH_BINARY);`
为
`threshold(img_sobel, img_threshold, 0, 255, CV_THRESH_OTSU | CV_THRESH_BINARY);`

# javascript - 确定 execScript 抛出错误的原因

> ID：14341327
> 
> 赞同：1
> 
> 时间：2013-01-15T15:44:12.477
> 
> 标签：javascript, internet-explorer, internet-explorer-8

我正在开发 ExtJS 应用程序，但 Internet Explorer 存在兼容性问题。该应用程序中断并引发与此代码行相对应的错误：

```
execScript(code); 
```

使用 IE Developer Tools，我发现代码变量包含自定义组件的类声明。我不知道是什么导致了这个错误。我已经检查了这个文件 3 次（1400 行代码）。作为记录，这在 Firefox 和 Chrome 上完美运行......

所以，我想知道是否有一种方法可以更多地了解出了什么问题，并得到一个行号或堆栈跟踪，所以我可以纠正这个问题。

任何帮助表示赞赏。谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-04T09:50:39.427

有完全相同的问题。

花了很长时间才弄清楚问题出在哪里，但在我们的例子中，我们从两个单独的对象文字（Status 和 StatusElements）创建了一个双精度数组。见下文。

```
Status = {
    'new': 10,
    'automatic': 15}

StatusElements = {
    10: { name: 'new', color: 'black', bgcolor: '#ffd3cf'},
    15: { name: 'automatic', color: 'black', bgcolor: '#'}}

var y =  [
    [Status.new, StatusElements[Status.new].name],
    [Status.automatic, StatusElements[Status.automatic].name]
    ] 
```

由于某种原因，Internet Explorer 在尝试评估上述 y 时会崩溃。

老实说，我不知道为什么 execScript(code); 在 Internet Explorer 中出现上述代码失败。也许这是评估的顺序。也许它会在评估 Status 和 StatusElements 之前尝试评估 y。无论如何，我们通过降低复杂性并让 y 等于一些原始值来修复它。

# java - Java中的类变量

> ID：14341334
> 
> 赞同：0
> 
> 时间：2013-01-15T15:44:29.550
> 
> 标签：java

```
class C3 {
    public static int n = 0;
    public int m = 0;

    public C3() {
        n++; 
        m++; 
    }

    public void display() {
        System.out.println(n + " " + m);}
    }
} 
```

执行： -

```
C3 c1 = new C3(); 
c1.display(); 
C3 c2 = new C3(); 
c1.display(); 
c2.display(); 
```

打印数字（输出）

```
1 1 
2 1 
2 1 
```

任何人都可以请逐步解释我的输出吗？我对第二行输出有点困惑，为什么 m 和 n 值都没有增加？同样在第三个输出中，为什么它没有从头开始？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T15:45:43.083

`m`不是静态的。这意味着每个实例都有不同的变量。

当你执行`new C3();`时，

*   你创建了一个新的类实例`C3`，
*   您增加静态变量`n`（由所有实例共享）
*   您创建一个新变量，`m`初始化为`0`
*   并且您增加`m`但仅针对您的新实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T15:46:45.507

**n**是 a `static variable`，因此类的所有实例（在这种情况下为 c1 和 c2 ）共享其数据，其中**m**不是 a `static variable`，这意味着每个实例都有自己的**m值**

```
 //initial vals n=0 m=0;
  C3 c1 = new C3(); 
 //value of n is 1 value of m is 1   
 c1.display();

//initial values n=0, m=1(as c1 just incremented n which is static and c2 will now inc      n's current value(which is 1))    
C3 c2 = new C3(); 
//value of n is 2 value of m is 1 
c1.display(); 
c2.display(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:47:22.367

`n`是一个静态变量，因此它的作用域是类，而不是实例。

`m`另一方面，它是一个实例变量，并且只存在于一个实例中。

因此，每次初始化 a`new C3()`时，`m`都会设置为 1（因为它是 new `m`），但`n`每次都会递增（因为所有实例都共享它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T15:52:00.710

您实例化的每个对象都将拥有`m = 1`，因为 m 是一个实例变量。 `n`，另一方面，是一个类变量。您实例化的每个对象都会将 n 增加 1。

在您的情况下，`n`将计算您创建了多少个对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T15:50:40.390

对于 c1 和 c2，只有一个 n 可用，因为 n 是静态的。但由于 m 不是静态的，因此两者都将表现出单独的 m。

C3 c1 = 新 C3(); 现在 m=1 和 n=1（m 属于 c1，n 属于类） C3 c2 = new C3(); 现在 m=1 和 n=2（m 属于 c1，n 属于类）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T15:56:36.290

```
class C3 {
public static int n = 0; //static or class variable, n does not become 0 after every new instance
public int m = 0; //instance variable, m becomes 0 for every instance

public C3() {
    n++; //n becomes the "last value the class had for n" + 1
    m++; //m becomes 1
}

public void display() {
    System.out.println(n + " " + m);}
} 
```

}

始终将**静态变量**视为**类变量**，因此您只会在**第一次**将其实例化为 0 。

# android - 构建自定义列表

> ID：14341337
> 
> 赞同：0
> 
> 时间：2013-01-15T15:44:37.203
> 
> 标签：android, eclipse, listview, android-arrayadapter

我正在尝试使用 ArrayAdapter 从对象生成列表。结果看起来像：

项目 A (3) 项目 B (1) 项目 C (0)

括号中的数字表示该文件后面的项目数量。我想在括号中有 1 时显示图像 - 在这种情况下仅适用于 B 项。

我有一个可用的属性图像，只有在项目有 1 时才设置为真。

但是，当我创建列表时，它会在任何地方创建图像，除了在项目 C 中。我创建了一个简短的日志来尝试了解原因并发现，该`public View getView(int position, View convertView, ViewGroup parent) {` 方法被调用多达 11 次......虽然1st 3 应该足够了。当我修改我的 if 子句时，它应该在检测到项目时将 imageavailable 设置为 false - 只有第一个项目有图片。谁能帮我吗？（我也尝试让 if(imageavailable&number==1) 产生相同的结果 - 1st 2 有一张图片

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:55:23.080

您应该管理适配器，而不是向 getView 添加逻辑。您处理适配器的逻辑应该在它自己的方法中。例如：

```
ArrayList<Drawable> adapter = new ArrayList<Drawable>();

void constructAdapter(List<Drawable>... drawables, int sizeFilter) {
    if (drawables != null) {
        for (List<Drawable> l : drawables) {
            if (drawable.size() == sizeFilter) {
                for (int i = 0; i < sizeFilter) {
                    adapter.add(l.get(i));
                }
            }
        }
    }
} 
```

然后从这里您将适配器列表传递给您的阵列适配器。

注意：我用 drawable 作为我的例子，因为你说的是​​图像。这可以是任何你想要的，只要你改变逻辑来处理那个特定的数据集。

# php - 尝试将 php 数组加载到打印图像的 echo 中

> ID：14341339
> 
> 赞同：2
> 
> 时间：2013-01-15T15:44:44.910
> 
> 标签：php

您好我正在尝试使用数组中的文件名将图像加载到页面中，

这是我到目前为止所拥有的

```
<?php
$i=0;
$img=array("1.png","2.png","3.png","4.png");
while ($i<count($img))
{
echo "<img class='loadin' alt='imgg' src=" . "'http://www/images/" . $img[i] . "'" . "/" . ">" . "<br/>";
$i++;
}
?> 
```

它似乎忽略了文件名，只是输入：

```
http://www/images/ 
```

作为源并忽略数组中的文件名

任何帮助都会很棒谢谢

米奇

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:47:44.770

您忘记了`$i`变量的美元符号： `$img[$i]`

编辑：（顺便说一句。使用 foreach 循环会更容易......）

```
foreach($img AS $filename) {
    echo "<img class='loadin' alt='imgg' src='http://www/images/" . $filename . "'/><br/>";
} 
```

# jquery - 如何在ajax中查看受保护帖子的密码？

> ID：14341346
> 
> 赞同：0
> 
> 时间：2013-01-15T15:45:01.307
> 
> 标签：jquery, ajax, wordpress, post

我有一个带密码的受保护帖子。

我想检查密码发送在**ajax 中是否正确。**

HTML：

```
<form class="protected-post-form" action=".../wp-pass.php" method="post">
   <input name="post_password" id="pwbox-4470" type="password" size="20">
   <input type="submit" class="send" name="Submit" value="Login">
</form> 
```

jQuery :

```
$("input.send").live("click", function(){
  $.ajax({
    url: ".../wp-pass.php",
    cache: false,
    success: function(data) {
      // show content
    }
  });
}); 
```

可能吗 ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:48:51.650

我认为您感到困惑-该帖子不受密码保护，它恰好在提交的表单中包含一个密码。

服务器端检查它就像检查发布的任何其他表单变量一样。`$_POST["pwbox-4470"]`将包含您在服务器端提交的密码。

您需要确保通过 HTTPS 提供表单，以确保密码不会以纯文本形式传输。

# java - 服务器只读取从客户端发送的第一个对象

> ID：14341350
> 
> 赞同：0
> 
> 时间：2013-01-15T15:45:16.233
> 
> 标签：java, netbeans-platform

我在将对象发送到服务器时遇到问题。现在，我有一个服务器设置并监听客户端。客户端连接，发送一个测试对象（只是一个字符串）并将其输出到命令行。它适用于发送的第一个字符串，但之后没有。

服务器（Hivemind.java）：

```
 // Open server socket for listening
    ServerSocket ss = null;
    boolean listening = true;
    try {
        ss = new ServerSocket(PORT_NUMBER);
    } catch (IOException e) {
        System.err.println("Cannot start listening on port " + PORT_NUMBER);
        e.printStackTrace();
    }

    // While listening is true, listen for new clients
    while (listening) {
        Socket socket = ss.accept();
        ServerDispatcher dispatcher = new ServerDispatcher(socket);
        dispatcher.start();
    }

    // Close the socket after we are done listening
    ss.close(); 
```

服务器线程（ServerDispatcher）：

```
public ServerDispatcher(Socket socket) {
    super("ServerDispatcher");
    this.socket = socket;
}

public void run() {
    System.out.println("Client connected");
    try {
        input = socket.getInputStream();
        objInput = new ObjectInputStream(input);
        Object obj = null;

        try {
            obj = (String)objInput.readObject();
        } catch (ClassNotFoundException ex) {
            Logger.getLogger(ServerDispatcher.class.getName()).log(Level.SEVERE, null, ex);
        }

        System.out.println(obj);
    } catch (IOException ex) {
        Logger.getLogger(ServerDispatcher.class.getName()).log(Level.SEVERE, null, ex);
    } 
```

连接类（HivemindConnect.java）：

```
public HivemindConnect(int port) {
    this.port = port;
    url = "localhost";
}

public HivemindConnect(int port, String url) {
    this.port = port;
    this.url = url;
}

public void connect() {
    try {
        socket = new Socket(url, port);
        output = socket.getOutputStream();
        objOutput = new ObjectOutputStream(output);
    } catch (IOException e) {
        e.printStackTrace();
    }
}

public void close() {
    try {
        objOutput.close();
        output.close();
        socket.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

public void send(Object obj) {
    try {
        objOutput.writeObject(obj);
        objOutput.flush();
    } catch (IOException ex) {
        Logger.getLogger(HivemindConnect.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

客户顶部组件：

```
// When the TC is opened connect to the server
@Override
public void componentOpened() {
    hivemind = new HivemindConnect(9001);
    hivemind.connect();
}

private void btnSendActionPerformed(java.awt.event.ActionEvent evt) {
    hivemind.send(txtText.getText());
}

// When the TC is closed close the connection to the server
@Override
public void componentClosed() {
    hivemind.close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:59:06.900

你需要一个这样的循环：

```
 while(objInput.available()>0){
    Object obj = null;
    obj = (String)objInput.readObject();
    System.out.println(obj);} 
```

或类似的东西。

# cakephp - 在配置文件（routes.php、mail.php...）之间共享 CakePHP 的配置文件

> ID：14341355
> 
> 赞同：1
> 
> 时间：2013-01-15T15:45:31.273
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1, cakephp-2.2

我有一个在 localhost 中运行的站点作为开发环境，并在服务器中用于生产。

每次我必须更新服务器中的更改时，我和两者之间的某些配置文件存在一些差异，我必须小心不要覆盖某些不同的文件。

我希望能够通过为每个环境创建一个具有正确配置的文件来简化此过程。

我需要读取当前在此配置文件中的该文件：

*   应用程序/配置/email.php
*   应用程序/配置/routes.php

理想情况下，如果可能的话：

*   应用程序/供应商/供应商名称/供应商文件.php

有可能吗？

我曾尝试使用 Configure::read 和 Configure::write，但似乎无法在电子邮件设置（例如`public $smtp`路由文件）中完成。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:16:08.263

路由文件只是一个调用路由器的 php 文件。您可以非常简单地将其拆分为多个文件并自己加载它们：

```
app/Config/
  routes.php
  routes_dev.php
  routes_production.php 
```

`routes.php`然后将加载正确的路由文件。

```
<?php
if ($env == 'dev') {
  include 'routes_dev.php';
} else {
  include 'routes_production.php';
} 
```

电子邮件配置也只是一个 php 文件。您可以编写一个函数来根据环境设置正确的默认配置。

```
class EmailConfig {

  public function __construct() {
    if ($env == 'dev') {
      $this->default = $this->dev;
    }
  }

  public $default = array(
      'host' => 'mail.example.com',
      'transport' => 'Smtp'
  );

  public $dev = array(
      'host' => 'mail2.example.com',
      'transport' => 'Smtp'
  );

} 
```

至于供应商文件，则视具体情况而定。

如果您有一个部署系统，最好为每个环境实际拥有单独的文件（甚至可能是一个完整的配置目录）并在部署构建完成后重命名它们，从而使 Cake 和您的代码更加明智。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:48:28.260

我过去处理这种情况的方法是将环境变量添加到 apache 虚拟主机配置中。

```
SetEnv cake_apps_path /var/www/apps/
SetEnv cake_libs_path /var/www/libs/ 
```

这让我可以拉 $_SERVER['cake_apps_path'] 和 $_SERVER['cake_libs_path']。然后每个开发人员都可以在自己的虚拟主机配置中设置自己的变量，然后将其添加到服务器的虚拟主机配置中，就完成了。每个开发人员都可以有自己的路径。

# search - Magento 搜索总是返回相同的产品

> ID：14341357
> 
> 赞同：2
> 
> 时间：2013-01-15T15:45:33.630
> 
> 标签：search, magento-1.7

无论我搜索什么，我的 magento (1.7) 搜索总是返回相同的 15 种产品。

这显然是一个索引/缓存问题，所以我正在寻找有关如何调试搜索结果来自何处的答案。

我已经`rm -rf var/cache`禁用了缓存，并重新索引了所有内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T15:51:06.847

这个答案：[https](https://stackoverflow.com/a/11413620/347180) ://stackoverflow.com/a/11413620/347180解决了这个问题。

在我的`local.xml`我有：

```
<remove name="catalogsearch.leftnav" /> 
```

这是搜索功能所必需的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-16T09:08:57.603

在 catalogserach.xml 中...不应删除以下代码

```
<block type="catalogsearch/layer" name="catalogsearch" after="-" template="catalog/layer/view.phtml"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-11T00:59:40.823

我在 catalogsearch.xml 中添加了和

```
<block type="catalogsearch/layer" name="catalogsearch" after="-" template="catalog/layer/view.phtml"/> 
```

现在搜索结果显示正常。

# asp.net - 使用VB比较系统时间与字段值

> ID：14341360
> 
> 赞同：0
> 
> 时间：2013-01-15T15:45:42.833
> 
> 标签：asp.net, vb.net

我需要一些帮助来编写一个 VB 函数来将系统时间与我的第 1 列日期时间变量进行比较，并返回不同的颜色背景。这是条件...

*   如果 scheduleTime 延迟 0-15 分钟，则背景行颜色为红色
*   如果 scheduleTime 延迟 15mins-30mins，则背景行颜色为黄色
*   如果 scheduleTime 延迟 30 分钟到 2 小时，则背景行颜色为绿色

* * *

行渲染事件：

```
 Row_Rendered();

 DateTime systemTime = DateTime.Now();
 DateTime fieldTime = SCHD_DTM.CurrentValue;
 DateTime result As Integer = DateTime.Compare(fieldTime,systemTime).TotalMinutes

 if result <= 0.25 Then 
     RowATTrs("style") = "background-color:Red";

 else if result > 0.25 & result <- 0.5 Then 
     RowATTrs("style") = "background-color:Yellow";

 else if result > 0.5 & result <= 2 Then
     RowATTrs("style") = "background-color:Green";

 End If 
```

这就是我所拥有的，我没有得到任何回应......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:54:55.180

“我没有得到回应”并不是对错误或不良行为的良好描述。但是，您在代码中混合了 C# 和 VB.NET。当然不会编译。

但这应该：

```
Dim systemTime As date = Date.Now
Dim fieldTime As Date = SCHD_DTM.CurrentValue
Dim result As Double= (fieldTime - systemTime).TotalMinutes

If result <= 0.25 Then
    RowATTrs("style") = "background-color:Red"
ElseIf result > 0.25 & result < -0.5 Then
    RowATTrs("style") = "background-color:Yellow"
ElseIf result > 0.5 & result <= 2 Then
    RowATTrs("style") = "background-color:Green"
End If 
```

但是，不确定是否`fieldTime`应该低于`Date.Now`. 然后交换变量`(fieldTime - systemTime)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:20:57.170

你可以使用 datediff 函数找出你想要的，

```
DateDiff(DateInterval.Minute, systemTime, fieldTime) 
```

将返回一个 long 告诉您两个日期时间之间的分钟数。

# angularjs - 在 AngularJS 中的控制器之间共享可观察的数组引用

> ID：14341364
> 
> 赞同：11
> 
> 时间：2013-01-15T15:45:53.693
> 
> 标签：angularjs

我正在编写一个 AngularJS 应用程序，其中一个数组（活动工作订单列表）用于许多不同的控制器。`$http`使用对服务器的调用定期刷新此数组。为了分享这些信息，我将数组放在了服务中。

服务中的数组一开始是空的（或者，出于调试目的，使用 dummy values `["A", "B", "C"]`），然后查询服务器以初始化列表。不幸的是，我所有的控制器似乎都绑定到数组的预查询版本——在我的应用程序中，我看到的只是我初始化数组的虚拟值。

我的目标是以这样的方式将数组绑定到我的控制器中，这样 Angular 会意识到数组已更新，并导致我的视​​图在数组更改时重新呈现，而无需引入 a`$watch`或强制我的`$http`调用等待结果.

问题：如何将 wo_list 数组从我的服务绑定到我的控制器，以便 Angular 将其视为模型的常规可观察部分？

我有：

1.  包含数组的服务和用于从服务器初始化和定期更新数组的刷新函数（我知道这是通过`console.log()`消息工作的）。出于调试目的，我使用占位符“A”、“B”和“C”来初始化数组——真正的工作指令是五位数的字符串。

    ```
    angular.module('activeplant', []).
       service('workOrderService', function($http) {

       wo_list = ["A", "B", "C"]; //Dummy data, but this is what's bound in the controllers.

       refreshList = function() {
             $http.get('work_orders').success(function(data) {
                 wo_list = data;
                 console.log(wo_list) // shows wo_list correctly populated.
             })
       }

       refreshList();

       return {

           wonums: wo_list,  // I want to return an observable array here.

           refresh:  function() {
             refreshList();
           }

       }
     }) 
    ```

2.  一个控制器，它应该绑定到 workOrderService 中的数组，以便我可以显示工作订单列表。我在两种不同的尝试中绑定了服务和服务返回的数组，以使其正常工作。

    ```
    function PlantCtrl($scope, $http, workOrderService) {
      $scope.depts      = []
      $scope.lastUpdate = null
      $scope.workorders = workOrderService
      $scope.wonums     = workOrderService.wonums  // I want this to be observable

      $scope.refresh = function() {
          $scope.workorders.refresh()
          $http.get('plant_status').success(function(data) {
              $scope.depts = data;
              $scope.lastUpdate = new Date()
          }); 
      }

      $scope.refresh()

    } 
    ```

3.  一个视图模板，它遍历工厂控制器中的绑定数组以打印工作订单列表。我做了两次尝试让它工作，最终版本只有一次 ul 元素。

    ```
    <div ng-controller="PlantCtrl">
      <div style='float:left;background-color:red' width="20%">
          <h2>Work Orders</h2>
          <ul>
             <li ng-repeat="wonum in workorders.wonums"><a href=""> {{wonum}} </a></li>
          </ul>
          <ul>
              <li ng-repeat="wonum in wonums"><a href=""> {{wonum}} </a></li>
          </ul>
      </div>
    </div> 
    ```

4.  其他几个视图/控制器对（此处未显示）也绑定和迭代工作订单数组。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T16:53:48.717

看看这是否解决了你的问题：

而不是`wo_list = data`，填充相同的数组。当您将一个新`data`数组分配给 wo_list 时，您将失去与旧数组的绑定——即，您的控制器可能仍绑定到前一个`data`数组。

```
wo_list.length = 0
for(var i = 0; i < data.length; i++){
    wo_list.push(data[i]);
} 
```

有关更多信息，请参阅[https://stackoverflow.com/a/12287364/215945](https://stackoverflow.com/a/12287364/215945)。

**更新：** 可以/应该使用[angular.copy()代替：](http://docs.angularjs.org/api/angular.copy)

```
angular.copy(data, wo_list); 
```

当向 copy() 方法提供目标时，它将首先删除目标的元素，然后从源中复制新的元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:43:17.147

您可以将所有控制器使用的数组放在父控制器中。由于作用域继承自更高作用域，这意味着所有控制器都具有相同的数组副本。由于数组是更高范围的模型，因此无论何时使用，更改它都会更新视图。

例子：

```
<div ng-controller="MainControllerWithYourArray">
    <div ng-controller="PlantCtrl">
         Wonums length: {{wonums.length}}
    </div>
    <div ng-controller="SecondCtrl">
         Wonums length in other controller: {{wonums.length}}
    </div>
</div> 
```

您只需要在 MainController 中定义 wonums 数组：

```
function MainControllerWithYourArray($scope, workOrderService){
    $scope.wonums = workOrderService.wonums;
} 
```

希望这对你有用！

# python - Python TypeError 无法连接 str 和 'xxxxx' 对象

> ID：14341366
> 
> 赞同：0
> 
> 时间：2013-01-15T15:46:01.710
> 
> 标签：python, python-2.7

当我尝试“获取”我的远程文件时，我得到以下结果。我可以打印并且我知道文件在那里。我需要将文件构建到列表中吗？

```
file_list_attr = sftp.listdir_attr()
for pfile in file_list_attr:
    if DT.datetime.fromtimestamp(pfile.st_mtime) > yesterday:
       # print pfile
       localfile = path + "\\" + pfile
       sftp.get(pfile,localfile) 

Traceback (most recent call last):
  File "C:\Documents and Settings\tyoffe\Desktop\FTP", line 41, in <module>
localfile = path + "\\" + pfile
TypeError: cannot concatenate 'str' and 'SFTPAttributes' objects 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:50:27.520

您需要改用该`.filename`属性，请参阅[`SFTPAttributes`文档](http://www.lag.net/paramiko/docs/paramiko.SFTPAttributes-class.html)：

```
file_list_attr = sftp.listdir_attr()
for pfile in file_list_attr:
    if DT.datetime.fromtimestamp(pfile.st_mtime) > yesterday:
       # print pfile
       localfile = path + "\\" + pfile.filename
       sftp.get(pfile,localfile) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:49:47.473

关键在最后一行：

```
TypeError: cannot concatenate 'str' and 'SFTPAttributes' objects 
```

该错误告诉您 SFTPAttributes 对象不是字符串，并且字符串只能与字符串连接。我不确定如何将 SFTPAttributes 类型转换为字符串，您可以尝试以下操作：

```
str(pfile) 
```

或类似 pfile.tostring()

最有效的方法通常取决于对象本身的细节。

# php - 拆分时间戳记录

> ID：14341367
> 
> 赞同：1
> 
> 时间：2013-01-15T15:46:03.920
> 
> 标签：php, mysql

我在我的 msql 数据库中有一个时间戳记录，它有日期和时间。我想从中得到时间，或者只是时间小时和分钟。

我怎样才能分割那条记录？

**编辑**这里是我的桌子的照片：

![在此处输入图像描述](../Images/cae184c7744935ca966dcc77fd088c8a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:47:18.900

使用 MySQL 的[`TIME()`](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_time)功能：

```
SELECT TIME(my_column) FROM my_table 
```

要仅获取日期部分，您可以使用该[`DATE()`](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_date)功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:52:14.457

您还可以使用[TIME_FORMAT](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_time-format)或[DATE_FORMAT](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)来获取特定格式，例如仅 hh:mm

```
SELECT TIME_FORMAT( CURRENT_TIMESTAMP, '%H:%i' );
+-------------------------------------------+
| TIME_FORMAT( CURRENT_TIMESTAMP, '%H:%i' ) |
+-------------------------------------------+
| 17:25                                     |
+-------------------------------------------+
1 row in set (0.00 sec) 
```

**编辑**

该功能当然也适用于表格的列

```
SELECT TIME_FORMAT( myColumn, '%H:%i' ) FROM myTable; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:54:34.993

也可以试试这个：

```
SELECT DATE_FORMAT(now(),'%r') AS timestamp;

|   TIMESTAMP |
---------------
| 03:51:43 PM |

SELECT DATE_FORMAT(your_Datetimecolumn,'%r') AS timestamp; 
```

# java - Java 2D 加权数据插值

> ID：14341369
> 
> 赞同：16
> 
> 时间：2013-01-15T15:46:04.627
> 
> 标签：java, algorithm, interpolation

我正在尝试找到一些**Java**库、代码示例（或起点）来帮助我弄清楚如何插入具有权重的 2d 点列表以生成具有水平曲线的插值。

谷歌搜索我发现有[几种算法可以](http://www.cnblogs.com/sorex/archive/2012/08/06/2624791.html)做到这一点，我发现了一些有趣内容的[解释](http://www.innovativegis.com/basis/mapanalysis/topic28/topic28.htm)。我想尝试的第一个算法是**反距离加权**插值。

但是有了所有这些信息，我有一些基本的疑问：

*   要生成如下图所示的一张图片，我必须做一个像素矩阵（带权重），插入数据，将像素组合在一起（按颜色范围），然后加入点绘制曲线并像[这样](http://images.cnblogs.com/cnblogs_com/sorex/201208/201208061048401288.png)放置参考文本值?

*   *如果*我需要做这个像素矩阵，那么巨大的插值会非常昂贵，所以我可以做更少的点并使用样条线加入然后创建颜色级别吗？

**示例数据：**

```
+-------------------+
|  X  |  Y  | WEIGHT|
+-------------------+
|  2  |  5  |   30  |
|  7  |  3  |   25  |
|  1  |  1  |   10  |
|  5  |  6  |   45  |
|  7  |  9  |   15  |
+-------------------+ 
```

**示例规则：**

*   00-10 之间的值：*蓝色*
*   10-20 之间的值：*绿色*
*   20-30 之间的值：*黄色*
*   30-40 之间的值：*红色*

**示例结果：**

![Shepard 插值示例](../Images/3783d5e173b1a773310b626bf3693cc8.png)

*示例数据，规则和结果不兼容，只是解释我的问题的随机示例。*

* * *

这是我最后的测试课： http: [//pastebin.com/nD6MT8eS](http://pastebin.com/nD6MT8eS)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T23:16:44.250

假设您有一个可以使用的 Point 类（例如 java.awt.Point），您可以将权重放入 Map：

```
Map<Point,Double> points = new HashMap<Point,Double>();
points.put( new Point(2,5), 30 )
... 
```

然后，您制作一个图像，并为每个 x,y 坐标找到最佳分数。我假设分数是反距离乘以表中点的权重。如果是这样，它是这样的：

```
image = createBitmap( width, height )
for( int x = 0; x < width; x++ )
    for( int y = 0; y < height; y++ )
    {
         double maxScore = -Double.MAX_VALUE
         for( Point p : points.keySet() ) 
         {
             double score = points.get(p)/p.distance( x, y ) //Inverse distance times point weight
             minDist = Math.max( maxScore, score )
         }
         image.setPixelColour( x, y, getColorForDistance( 1/minDist * points.get(p) )
    } 
```

getColourForDistance( double dist ) 应该很明显，尽管您必须正确设置级别。我假设 createBitmap(width, height) 是创建一个图像。您制作的图像类型取决于您的应用程序，它是否具有 setPixelColour 方法或类似方法也是如此。分数等级的选择也取决于您的应用程序。

这没有优化 - 它至少是 O(x*y*p) 其中 p 是点数。如果 p 变大，您可能需要查看更合理的数据结构来存储点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:49:09.427

为了补充@mo-seph 和@Xipan-Xiao 的答案，您可以查看jFreeChart 项目中的[NonGridContourDataset](http://www.jfree.org/jfreechart/api/gjdoc/org/jfree/data/contour/NonGridContourDataset-source.html)类，该类实现了反向距离功率算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:10:26.787

不知道如何添加评论，所以我在这个答案区域添加我的想法。

至少您不需要“将像素组合在一起（按颜色范围）然后加入点绘制曲线”。要生成您需要的图片，只需执行以下操作：

```
picture = createBitmap( width, height );
for( int x = 0; x < width; ++ x ){
    for( int y = 0;y < height; ++ y ){
        double value = interpolate( x, y, inputs );
        Color color = colorRangeOf( value );
        picture.setPixel( x, y, color );
    }
} 
```

因此，在不创建像素矩阵、对颜色进行分组的情况下创建图片。指定图片的每个像素值后，边界“曲线”将自动出现。

# mysql - 从另一个表中检索数据

> ID：14341370
> 
> 赞同：1
> 
> 时间：2013-01-15T15:46:06.740
> 
> 标签：mysql, sql, select, join

我有一张像

`tbl_scripts`

```
script_unique_id | system_id | script_name
+-----------------------------------------+
12345            |  89784    |   Demo 
```

另一张桌子是

`tbl_allowed_group_ids`

```
system_id | script_unique_id |allowed_group_id
+---------------------------------------------+
89784       12345             56987 
```

所以现在我想要的是`tbl_scripts`只有`group_id`当唯一 ID 在`allowed_group_id`

我试过的是这个，但离它还很远……我知道这是完全错误的

```
SELECT script_name FROM tbl_scripts WHERE script_unique_id = allowed_group_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:47:14.753

`JOIN`两张表：

```
SELECT t1.script_name
FROM tbl_scripts t1
INNER JOIN tbl_allowed_group_ids  t2 ON t1.script_unique_id = t2.allowed_group_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:48:21.753

您将需要`JOIN`以下表格：

```
select *
from tbl_scripts s
left join tbl_allowed_group_ids g
  on s.system_id = g.system_id 
  and s.script_unique_id = g.script_unique_id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e7c43/1)

如果您在学习连接语法方面需要帮助，这里有一个[关于连接的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

A`LEFT JOIN`将返回表中的所有行，`tbl_scripts`无论它在表中是否有匹配的行`tbl_allowed_group_ids`。如果您只想匹配行，那么您可以使用`INNER JOIN`

# android - Android：返回Application Home Activity

> ID：14341377
> 
> 赞同：1
> 
> 时间：2013-01-15T15:46:24.830
> 
> 标签：android, android-activity, return

我正在尝试使用下一个代码从我的应用程序堆栈返回到 My Application Home Activity：

```
protected void goHome(boolean offlineMode) {
    final Intent intent = new Intent(this, MainActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivity(intent);
...
} 
```

但在这种情况下，顶部的所有其他应用程序活动也将关闭。在这种情况下是否可以仅关闭我的应用程序的活动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:47:38.383

这应该做的工作。

```
Intent i = new Intent(context, HomeActivity.class);
i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK|Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(i);
finish(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:10:58.743

您也可以从您的**AndroidManifest.xml**文件中实现它，只需添加

```
android:noHistory="true" 
```

那些`<activity>`你想要的属性（例如HomeActivity）

看这里是清单的示例代码

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.rdc.helloWorld"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".HelloWorldActivity"
            android:label="@string/app_name" 
            android:noHistory="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

因此，当您单击主活动屏幕上的返回按钮时，它只会清除此屏幕的历史记录

您可能喜欢阅读 noHistory 标签详细信息，

[**android:noHistory="true" 是如何工作的？**](https://stackoverflow.com/questions/11836080/how-does-androidnohistory-true-work)

# oracle-apex - 离开 APEX 页面时触发进程（SQL 更新）

> ID：14341379
> 
> 赞同：1
> 
> 时间：2013-01-15T15:46:30.680
> 
> 标签：oracle-apex

这是一个非常奇怪的问题，但我想知道当用户离开此特定页面时，是否可以通过单击面包屑、选项卡或后退按钮来触发运行 SQL UPDATE 的进程？

我确实设置了在“返回”按钮上运行的过程；但是我遇到了以下问题：如果她/他点击面包屑或标签怎么办。

我已经在网上搜索并发布这个问题是最后的手段。我想知道是否有人可以指出我正确的方向？

**更新后的帖子**

**第 1 页：**
包括一个文本字段和一个按钮。用户在文本字段中输入类别并单击按钮进入下一页。该按钮将文本字段中的值传递到第 2 页上的文本字段。

**第 2 页：**
页面上的两个区域。一个区域包含有关类别的信息 - 上一页中的类别名称、类别描述和类别修订号（这是我想要工作的内容）。第二个区域是一个报告，它提取在类别文本字段中的类别下列出的项目名称和编号。报告上使用“查看”链接来加载所选特定项目的编辑页面。“查看”链接将“类别名称”（来自类别文本字段）和“项目编号”从报告传递到第 3 页。

**第 3 页**
使用了两个区域，第一个区域：列出来自第 2 页的项目编号和项目名称（我使用一个简单的查询来检索）。在第二个区域中：报表使用两列：第 1 列中的项目属性列表，以及第 2 列中每个项目属性旁边的文本字段，用于保存可更新的值。“应用更改”按钮后面有一些 PlSql，可在需要时查找更改和更新。它更新已更改的相关字段，然后将用户带回第 2 页（向用户显示为最初输入的类别列出的项目的页面）。

我无法在第 3 页上的“应用更改”按钮上增加类别修订，因为用户可能会完成对同一类别下的项目的编辑。所以我不知道在哪里可以将每个类别的类别修订增加 1 个。Ps 如果使用第 3 页上的“应用更改”按钮更改了信息，我已经将每个项目的修订号加 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:04:11.637

这样做的一种方法是通过 ajax 更新页面项目的会话状态（不正常提交页面），并在由 javascript onbeforeunload 调用时调用更新表的应用程序进程。

创建一个应用程序进程以按需触发，命名为 UpdatePageXOnExit 或其他名称。在该应用程序进程的 PL/SQL 块中，使用 SQL 更新命令以及您希望更新的页面上每个项目的项目状态；类似于以下内容：

```
BEGIN
    UPDATE table_name SET col1 = :PX_ITEM_1, col2 = :PX_ITEM_2, col3 = :PX_ITEM3, col4 = :PX_ITEM_4, col5 = PX_ITEM_5 
WHERE (condition... I would suggest ROWIDs to simplify changes to the 
       fields of the PK; otherwise you will have to create additional
       page items for each field of the PK, then set those items to
       the values of the PK when the page loads using a before
       header page process, and then use those values in this where
       clause like this: where col1 = :PX_ORIGINAL_PK_FIELD_1 AND col2 =
       :PX_ORIGINAL_PK_FIELD_2 );
END ; 
```

转到该特定页面的页面设置，然后在 JavaScript: Execute On Page Load 部分中，编写如下内容：

```
window.onbeforeunload = updateOnExit; 
```

在 JavaScript 函数和全局变量声明中，编写如下内容：

```
function updateOnExit() {
    var get = new htmldb_Get(null,&APP_ID.,'APPLICATION_PROCESS=UpdatePageXOnExit',&APP_PAGE_ID.);
    get.add('PX_ITEM_1',$x('PX_ITEM_1').value)
    get.add('PX_ITEM_2',$x('PX_ITEM_2').value)
    get.add('PX_ITEM_3',$x('PX_ITEM_3').value)
    get.add('PX_ITEM_4',$x('PX_ITEM_4').value)
    get.add('PX_ITEM_5',$x('PX_ITEM_5').value)
    gReturn = get.get();
    get = null;
    // Comment out the following line or not, as per the note in the following paragraph
    return 'Are you sure you would like to leave the page?';
} 
```

最后一部分是 AJAX，它更新页面上页面项目的会话状态，这些页面项目在用户端已更改但尚未上传到服务器端，这通常发生在页面提交期间。注意：如果您注释掉 return 语句，则不会有允许用户留在页面上的警告框。如果这是你喜欢的，那就去吧。如果您选择使用警告框，即使用户选择留在页面上，ajax 也会执行页面进程。

# iphone - 无法连接到 iTunes 商店错误

> ID：14341382
> 
> 赞同：7
> 
> 时间：2013-01-15T15:46:33.030
> 
> 标签：iphone, ios, objective-c, in-app-purchase, mkstorekit

嗯，我现在有这个问题。我在我的应用内购买中使用 MKStoreKit。这是我的错误：

```
Failed transaction: <SKPaymentTransaction: 0x136a62e0>
error: Error Domain=SKErrorDomain Code=2 "Cannot connect to iTunes Store" UserInfo=0x13654a90 {NSLocalizedDescription=Cannot connect to iTunes Store} 
```

任何的想法？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-16T10:54:12.263

您可以通过交叉检查此检查列表来消除该错误。如果您对任何一点的回答是否定的，那么它可能会导致问题

1.  您是否为您的 App ID 启用了应用内购买？
2.  您是否为您的产品检查过清仓？
3.  您项目的 .plist Bundle ID 是否与您的 App ID 匹配？
4.  您是否为新的 App ID 生成并安装了新的配置文件？
5.  您是否已将项目配置为使用此新的配置文件进行代码签名？
6.  您在发出 SKProductRequest 时是否使用了完整的产品 ID？
7.  将产品添加到 iTunes Connect 后，您是否等待了几个小时？
8.  您的银行详细信息在 iTunes Connect 上是否有效？
9.  你的设备越狱了吗？如果是这样，您需要恢复越狱才能使 IAP 正常工作。
10.  对于 iOS7 和 Xcode 5 尝试这样做：
    1.  您必须在物理设备上进行测试，因为苹果限制了模拟器中的 IAP 测试。
    2.  转到设置 -> iTunes & App Store -> 并注销您的帐户。从设备中删除应用程序并清除所有数据。

最重要的是，在尝试进行任何购买之前，请从您设备中的当前 iTunes 帐户中注销。

确保您已完成应用内购买测试的所有必要步骤。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-09-25T16:03:10.163

截至 2013 年 9 月/10 月，iOS7 模拟器无法处理应用商店内应用购买请求。

您需要使用真实设备

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-04T13:34:08.110

想象一下，您在 iTunes Connect 的“我的应用”中创建了新的应用配置文件。在应用程序中添加。全都正确。

现在你想测试购买。它显示产品列表，但在购买按钮上停止，日志中出现**“无法连接到 iTunes Store”**错误。

这是因为您尝试购买未经批准且不存在的产品！您现在只能测试沙盒产品。

所以，你必须

1.  创建沙盒用户（在 iTunes 连接 - 用户...）
2.  注销您在设备上的真实 iTunes 登录
3.  尝试在沙盒登录下购买（它会问你）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-19T22:46:05.040

有同样的问题，我只记得没有任何苹果 ID 可以工作。您必须在 iTunes 连接/管理用户/测试用户/添加新用户中创建一个测试苹果 ID。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-11T17:58:05.120

尝试输入内部版本号。Target > General > Identity > Build。

这为我解决了。

# weblogic - Weblogic数据源监控统计报表

> ID：14341383
> 
> 赞同：2
> 
> 时间：2013-01-15T15:46:34.470
> 
> 标签：weblogic, datasource, monitoring

我想从 weblogic 控制台获取数据源监控的统计报告。

场景是，我无权访问生产 weblogic 控制台，问题是超出池限制。

我想至少监控一周的连接计数（统计数据），并决定这个限制，如果有任何方法可以得到这个统计数据的报告会很好。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:36:14.243

您可以在以下内容中找到此信息：[监控 WebLogic JDBC 资源](http://docs.oracle.com/cd/E17904_01/web.1111/e13737/monitor.htm)。您想使用连接使用配置文件 = `PROFILE_TYPE_CONN_USAGE_STR`。

# python - 如何使用python执行mysql并使用replace into - 超过255个变量？

> ID：14341387
> 
> 赞同：3
> 
> 时间：2013-01-15T15:46:41.823
> 
> 标签：python, mysql, extract, etl

下面是我正在使用的代码

```
con.execute("""
REPLACE INTO T(var1,var2,...,var300)VALUES(?,?,....?)""",(var1,var2,...,var300) 
```

如果我有 var1-var255 ，这个语句就可以正常工作，一旦我有更多它给了我一个错误......到目前为止，我能够将 T 分成2个不同的时间

```
con.execute("""
REPLACE INTO T(var1,var2,...,var150)VALUES(?,?,....?)""",(var1,var2,...,var150)

con.execute("""
REPLACE INTO T(var151,var152,...,var300)VALUES(?,?,....?)""",(var151,var152,...,var300) 
```

这没有给我任何错误，但我在表“T”中的最终值只会是第二个执行语句中的值，所有的都`var1, var2, ... var 150`被替换为 null

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:02:39.847

您是否尝试过使用更新？

MySQL 文档告诉以下内容：“REPLACE 的工作方式与 INSERT 完全相同，只是如果表中的旧行与 PRIMARY KEY 或 UNIQUE 索引的新行具有相同的值，则在插入新行之前删除旧行"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:11:24.063

在 MySQL 中使用超过 255 列，与 MySQLdb 接口似乎没有任何固有问题：

```
import MySQLdb
import config

connection = MySQLdb.connect(
    host = config.HOST, user = config.USER,
    passwd = config.PASS, db = 'test')
cursor = connection.cursor()

cols = ['col{i:d}'.format(i =i) for i in range(300)]
types = ['int(11)']*len(cols)
columns = ','.join('{f} {t}'.format(f = f, t = t) for f, t in zip(cols, types))

sql = '''CREATE TABLE IF NOT EXISTS test (
       id INT(11) NOT NULL AUTO_INCREMENT,
       {c},
       PRIMARY KEY (id) 
       )'''.format(c = columns)

cursor.execute(sql)

sql = '''REPLACE INTO test({c}) VALUES ({v})'''.format(
    c = ','.join(cols),
    v = ','.join(['%s']*len(cols)))

cursor.execute(sql, range(300))
result = cursor.fetchall() 
```

`test.test`这会毫无问题地添加行。

# gwt - GXT 添加过滤器到存储

> ID：14341388
> 
> 赞同：2
> 
> 时间：2013-01-15T15:46:41.883
> 
> 标签：gwt, filter, filtering, store, gxt

我遇到了一段相对简单的代码问题。

我正在尝试为我的商店项目（与 GridView 关联的商店）设置过滤器。

```
gridStore.addFilter(new StoreFilter<IncidentDto>() {
                    @Override
                    public boolean select(Store<IncidentDto> store, IncidentDto parent, IncidentDto item) {
                        if (item.getDescription().equals("WEEEE-TEST")) {
                            return true;
                        } else {
                            return false;
                        }
                    }
                }); 
```

问题是商店根本没有过滤。

感谢任何愿意花时间帮助我解决这个问题的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T21:35:11.663

不要忘记启用过滤器 - 这存在以便您可以进行多个过滤器修改而无需实际要求它们采取行动：

```
gridStore.setEnableFilters(true); 
```

排序没有这个，因为没有关闭排序的概念 - 项目被排序以具有新的顺序，然后它们保持该顺序。相反，可以关闭过滤器以恢复不再可见的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:02:47.520

如果您跟踪代码，您会注意到在 onLoad() 中没有调用过滤器。您必须手动调用 filter();

# wpf - WPF DataTemplate Lookahead/behind

> ID：14341389
> 
> 赞同：0
> 
> 时间：2013-01-15T15:46:43.143
> 
> 标签：wpf, data-binding, datatemplate

我正在使用一个 ItemsControl，它填充了一个包含几种不同数据类型的集合。每种数据类型都有自己的DataTemplate，而且都显示正确，但是我的问题是：当有多个相同类型一个接一个显示时，第一个必须在它上面显示一个标题，最后一个必须显示它下面的一条水平线。有没有办法在 XAML 中检测到这一点，还是我需要稍微预处理这个列表来设置标志？

数据如下：

```
Patient
Test
Result <-- header before this
Result
Result <-- line after this
Test
Result <-- header before, line after
Patient
Comment <-- header before this
Comment
Comment <-- line after this
Test
Result <-- header before, line after 
```

我不想在显示之前对数据类型进行分组，它们需要按照它们到达的顺序显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:00:43.967

我认为您会受益于将您的 ItemsControl 绑定到某处定义的 CollectionViewSource 的资源键。您也许可以使用`CollectionViewSource.GroupDescriptions`[1] 在 UI 中显示它。

查看`ItemsControl.GroupStyle`[2] 以了解如何设置此样式。

[1] [http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.groupdescriptions.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.groupdescriptions.aspx)

[2] [http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.groupstyle.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.groupstyle.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:30:12.973

您需要向每个项目的下一个/上一个兄弟询问其类型，并将其与当前项目的类型进行比较，并考虑到如果两者都相等且等于该项目，则您什么也不做......绝对不能这样做纯xml。

对我来说最简单的方法是在项目的视图模型中实现两个 bool 属性`'HeaderVisible'`并`'BottonLineVisible'`在那里处理逻辑。在 DataTemplate 中将触发器绑定到它们以根据需要添加顶部/底部行。

# php - 嵌套的foreach循环，打破循环

> ID：14341395
> 
> 赞同：1
> 
> 时间：2013-01-15T15:46:54.780
> 
> 标签：php, foreach, nested-loops

我尝试使用嵌套的 foreach 循环创建一个列表。第一个循环是循环一些数字，第二个循环是循环日期。我想写一个数字到一个日期。所以还有另一个功能可以检查。但结果是数字多次写入日期。

Out 是这样的：

```
number 5 is on 2013.01.15;
number 5 is on 2013.01.16;
number 5 is on 2013.01.17;
number 6 is on 2013.01.15;
number 6 is on 2013.01.17; 
```

编码 ：

```
function create_event($numbers,$available_dates) {
  foreach($numbers as $number) {
    foreach($avaliable_dates as $av_date) {

      $date_check= dateCheck($av_date,$number);

      if ($date_check == 0) {
        echo "number ".$number." is on ".$av_date;
        break;
      } else {
        $send_again[] = $number;
      }

    }
  }
  create_event($send_again,$avaliable_dates);
} 
```

我认为内部循环不会中断。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T15:59:38.373

你`break;`应该打破内部 foreach 循环！
我看到这种行为的唯一原因是在你的数组中重复数字！（例如`$numers=array(5,5,5,6,6);`）
尝试`$numbers=array_unique($numbers);`在你的外部 foreach 循环之前插入：
如果你需要打破两个循环（内部和外部）写`break 2;`而不是`break;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:05:11.623

你可以检查这样的事情：

```
function create_event($numbers,$available_dates) {
    foreach ($numbers as $number) {
        foreach ($available_dates as &$av_date) {
            if (dateCheck($av_date, $number) == 0) {
                unset($av_date);
                break;
            }
        }
    }
} 
```

# bash - 如何以秒为单位获得UTC时间和本地时间之间的差异？

> ID：14341403
> 
> 赞同：0
> 
> 时间：2013-01-15T15:47:15.537
> 
> 标签：bash, date

如何以秒为单位获取 UTC 时间和本地时间之间的 bash 差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:10:54.883

`%s`如果没有一些与时间相关的滑稽动作，这并不是答案的一部分，纪元秒明确是 UTC（或者如果你是老派，可能是 GMT），所以设置 TZ 不会影响它。

类似于 twalberg 的建议：

```
IFS=":" read hh mm < <(date +%:z)
echo $(($hh*3600+$mm*60)) 
```

`date`您可以通过为命令设置 TZ 来测试这是否正在执行您想要的操作：

```
IFS=":" read hh mm < <(TZ=Australia/Sydney date %:z)    # answer is 39600
IFS=":" read hh mm < <(TZ=US/Eastern date +%:z)         # answer is -18000 
```

（这不是*严格*意义上的 bash 答案，因为它需要 GNU 日期或等效版本，5.90 及更高版本支持 %:z 和 %::z）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:16:00.323

您可能需要做一些工作才能在几秒钟内获得它，但`date +%z`会将您配置的时区偏移报告为`[+-]HHMM`. 解析它的输出并进行适当的数学运算以在几秒钟内计算出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T11:41:56.417

这仅适用于整个小时而不是分钟的地方。

```
echo $(($( date +%z)*36)) 
```

# magento - 如何在 Magento 中获得估计的运输邮政编码？

> ID：14341415
> 
> 赞同：2
> 
> 时间：2013-01-15T15:47:44.000
> 
> 标签：magento, magento-1.7

我正在编写一个自定义运费模块，但我似乎无法弄清楚如何获得估计的运费邮政编码......我知道一旦创建订单后如何获取邮政编码，但不适用于结帐的估计运费部分过程

非常感谢任何输入！

杰夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:38:05.707

在下订单之前，有关客户购物车的全部信息都保存在`Mage_Sales_Model_Quote`模型中。因此，您可以从 Quote 中获取 Shipping Address 模型。从送货地址模型中，您可以获得邮政编码，那里称为“邮政编码”。因此，您最初唯一需要的是为客户获取报价。

报价可以通过不同的方式获得：

*   通过其 id 或任何其他属性从数据库加载
*   从结帐会话收到
*   从结帐车模型收到

最通用的方法是通过从 DB 加载 Quote 来获取 - 这可以在所有 Magento 工作流程和区域（API、前端、后端等）中完成。

但是对于您的情况，最直接的方法是从 Checkout Cart 模型中获取 Quote，因为您不需要知道 Quote id - 在前端 Magento 会自动加载带有适当客户数据的购物车。

```
/** @var $cart Mage_Checkout_Model_Cart */
$cart = Mage::getSingleton('checkout/cart');
$quote = $cart->getQuote();
$shippingAddress = $quote->getShippingAddress();
$zip = $shippingAddress->getPostcode(); 
```

为了进一步理解，为什么在这种方法中使用结账车：结账模块在前端管理整个结账过程。它处理组成购物车、查看购物车、完成结帐步骤和下订单。结帐模块还将客户的报价模型存储在其购物车模型中。虽然 Quote 存储了全部信息，并且可以在任何地方使用来操作客户的购物车，但 Cart 模型只是帮助 Checkout 模块履行其职责的临时服务模型，它可以在**前端**用于**当前**客户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:09:40.470

您可以执行以下操作：

```
Mage::getSingleton('checkout/session')->getQuote()->getShippingAddress()->getPostcode();
//or
Mage::getSingleton('checkout/session')->getQuote()->getBillingAddress()->getPostcode(); 
```

# c - 对变量使用 c 宏

> ID：14341417
> 
> 赞同：0
> 
> 时间：2013-01-15T15:47:50.910
> 
> 标签：c, macros

我想访问表单的几个变量：

```
int arr1=1;
int arr2=1;
int arr3=1; 
```

所以我写了

```
#define arr(i) arr##i 
```

但是下面的代码不能像我预期的那样工作

```
#include <stdio.h>

int main(){
int arr1=1;
int arr2=1;
int arr3=1;
int j;
    for(j=1; j<3; j++)
        printf("%d",arr(j));

return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T15:49:57.057

你不可以做这个。在 C 中，变量名在运行时不存在。

您的宏将扩展为`arrj`，这是一个未定义的变量名。使用适当的数组：

```
int arr[] = { 1, 1, 1 }; 
```

然后 print `arr[j]`，但像这样循环：

```
for(j = 0; j < sizeof arr / sizeof *arr; ++j)
  printf("%d\n, arr[j]); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T15:49:37.630

宏代码用于预处理器阶段而不是运行时阶段

如果您使用`gcc -E`. 您将看到您的代码等效于：

```
int main(){
int arr1=1;
int arr2=1;
int arr3=1;
int j;
    for(j=1; j<3; j++)
        printf("%d",arrj);

return 0;
} 
```

当您构建程序时，gcc 从您的 c 代码生成另一个 c 代码，并在其中将代码中的所有宏替换为宏内容（此阶段称为预处理器阶段）。然后生成asm代码，然后生成二进制文件。

`gcc -E`您可以通过: code of preprocessor phase查看生成的 c 代码（来自您的代码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:56:09.743

因此，这将产生`arrj`结果。

C 的宏阶段是在程序运行之前发生的事情，甚至在它被解析为实际的 C 之前。

很久以前，预处理器是一个完全独立的程序，对 C 语言知之甚少。

像今天的大多数编译器一样，`cc`当时只是运行不同的阶段。在它运行编译器、汇编器和链接器之前，它运行`cpp`了*C 预处理器*。

而*cpp*只是解析定义，然后扩展宏，然后退出。然后*cc*将运行编译器。如今，宏扩展内置于编译器中，但它根据原始设计处理程序的文本输入。

今天在某些系统上仍然有一个`/usr/bin/cpp`，但它通常只是一个运行编译器映像的 shell 脚本，带有选项说不*编译*。

# matlab - 混淆matlab中的Hist默认函数

> ID：14341420
> 
> 赞同：0
> 
> 时间：2013-01-15T15:47:58.960
> 
> 标签：matlab

例如，我有一个看起来像这样的图像矩阵：

```
1 2 3
1 5 6
1 5 3 
```

假设我的强度从 1 变为 6，所以我需要生成类似数组的东西：

```
1 : 3
2 : 1
3 : 2
4 : 0
5 : 2
6 : 1 
```

我尝试使用 matlab 的 hist 函数，但它产生的东西对我来说真的很奇怪。任何人都可以帮助我吗？
非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:56:56.780

这里的关键是使用冒号运算符对图像矩阵进行线性化，如`hist(a(:))`. 调用`hist(a)`when `a`is a matrix 将计算每列的直方图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:52:37.297

我怀疑您可能没有指定正确的直方图箱`hist`（默认情况下，它会创建 10 个等间距的箱）。如果您对简单的直方图计数感兴趣，请考虑使用[`histc`](http://www.mathworks.com/help/matlab/ref/histc.html)：

```
vals = 1:max(A(:));
count = histc(A(:), vals); 
```

`A`你的图像矩阵在哪里。`vals`是您想要的输出数组中的第一列，并且`count`是第二列。

# ruby-on-rails - Ruby on Rails，计算某些类型的记录

> ID：14341424
> 
> 赞同：2
> 
> 时间：2013-01-15T15:48:14.857
> 
> 标签：ruby-on-rails

我有 3 种不同类型的记录。假设 4 条记录属于 A 类型，1 条记录属于 B 类型，10 条记录属于 C 类型。有些用户只有 A 和 B，而另一些用户只有 3 种类型。

首先，我需要检索类型，然后计算有多少条记录具有类型 A、B 或 C。

是否可以一次调用，以便我`Hash`从数据库中获取如下：

```
 A:4, B:1, C:10 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T15:56:03.627

```
User.group(:type).count
=> {"A"=>4, "B"=>1, "C"=>10} 
```

# ms-access - 没有为一个用户加载 Access 2010 子表单

> ID：14341426
> 
> 赞同：0
> 
> 时间：2013-01-15T15:48:18.730
> 
> 标签：ms-access, ms-access-2010

最近，我团队的 Microsoft Access 数据库已从 Access 2003 迁移到 2010。显然这会导致很多问题，但我们已经解决了大部分问题。但是，有一个问题我似乎无法解决。

许多人使用这个 Access 应用程序完全没有问题，但我的大约三个用户遇到了一个特殊的问题。

表单中有一个子表单，其内容通过查询加载。此子窗体上有一个图片框、一个文本框、一个复选框和一个按钮。对于我自己和使用该应用程序的 99% 的人来说，图片加载完毕，一切都按原样显示。然而，对于遇到问题的 3 个人来说，整个子表单是完全空白的。

数据存储在 OLE 对象中，每个人都使用相同的数据。

我不明白为什么它对这么多人有用，但对其他人却失败了。有人有什么想法吗？

# jquery - 使用 jquery 在 iframe 中加载图像

> ID：14341427
> 
> 赞同：2
> 
> 时间：2013-01-15T15:48:19.510
> 
> 标签：jquery, image, iframe, load

我需要从动态生成的字符串在 iframe 中显示图像。iframe 的 id 是`upload_target`.

这是我正在使用的代码

```
// assign esrc and upath
$.ajax 
({  type: "POST", 
    url: "editImage.php", 
    data:  {esrc: editsource, upath: upath } ,  
    success: function(esource) 
    {   //load into iframe 
        s = esource;
        console.log(s);
        $('#upload_target').contents().find('body').html(s);
    } 
}); 
```

文件 editImage.php 只返回正确的文件名。控制台显示了正确的文件名，所以我知道那里没有问题。但是 iframe 没有任何反应，它仍然像以前一样空白。我能够用另一个事件填充同一个 iframe，即提交一个`target`属于这个 iframe 的表单。但为什么它在这里不起作用？

我也试过`$('#upload_target').attr('src',s)`了，但我得到了 406 错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:53:48.707

尝试

```
...find("body").append($("<img/>").attr("src", s).attr("title", "sometitle")); 
```

我没有调试此代码，但应该可以工作。

**编辑**

这段代码对我来说很好

```
<iframe id="upload_target"><html><body></body></html></iframe>

<script type="text/javascript">
    $(function () {
        $('#upload_target').contents().find('body').append($("<img/>").attr("src", "http://www.bing.com/az/hprichbg/rb/NYBirds_ROW10420117938_1366x768.jpg").attr("title", "sometitle"));
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:12:40.450

最后，我只是破解了一个疯狂的修复程序。我不知道这是否合理，但它有效。我没有使用 ajax，而是创建了一个带有隐藏输入的表单，其中包含我需要传递`editImage.php`并提交该表单的值。然后 iframe 很好地加载了图像。

```
$('#imgdialog').append("<form id='imageeditform' method='post' action='editImage.php' target='upload_target'><input type='hidden' name='esrc' value='"+editsource+"' /><input type='hidden' name='upath' value='"+$('#upath').val()+"' /></form>");
$('#imageeditform').submit(); 
```

# git - 恢复复杂的 git repo

> ID：14341431
> 
> 赞同：1
> 
> 时间：2013-01-15T15:48:30.883
> 
> 标签：git

我们有几个人在做一个 git repo。我们都把它拉下来了。有几个功能分支，当然还有 master。

现在的问题是，master 分支中已经开发了一个功能，但它不完整，同时我们不能再将错误修复部署到代码中。

我对 git 有点了解，但肯定不足以“稳定”回购，我知道情况一团糟。

我将如何将推送的提交从 master 拆分到正确的分支中，同时仍然允许 master 独立提交、推送等 - 以便我们可以继续执行错误修复，但以后可以合并功能。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:53:32.100

从`development`当前的`master`. 将任何开发工作推入`developement`，并重新创建`master`以指向最新的**稳定**版本。

对于错误修复，请从新`master`的`master`. 这样，您团队的其他成员可以继续处理其他功能，这些错误修复可以合并到`master`并作为补丁发布。

请参阅[git 分支模型](http://nvie.com/posts/a-successful-git-branching-model/)。

假设您有一个稳定版本的标签（或者至少是它的提交哈希），您可以这样做：

```
 //lets sync origin master and local master
 git checkout master //checkout local copy of master
 git pull origin master //grab any changes in origin/master
 git push //now origin and local are in sync

 //create development branch off of master
 git checkout -b development master
 git push origin development:development

 //now point master to release tag
 git branch -d master
 git checkout -b master tag_name
 git push -f origin master:master 
```

现在让每个人都将开发合并到他们的功能分支中。错误修复进入大师。

# c# - 从 WP 应用程序的项目文件夹中访问文件

> ID：14341433
> 
> 赞同：0
> 
> 时间：2013-01-15T15:48:39.400
> 
> 标签：c#, c#-4.0, xna, windows-phone-8, xna-4.0

我是 Windows Phone 开发的新手，我正在尝试做一个简单的培训应用程序。

我希望我的应用程序加载一些我放入项目内文件夹中的音频文件。

这是一个简短的片段：

```
private void LoadSound(String SoundFilePath, out SoundEffect Sound)
    {

        // For error checking, assume we'll fail to load the file.
        Sound = null;
        try
        {                
            // Holds informations about a file stream.                
            StreamResourceInfo SoundFileInfo = Application.GetResourceStream(new Uri(SoundFilePath, UriKind.Relative)); 
```

我的文件夹结构类似于

```
- Project
    - Kits
        - TestKit_128
            - Bass_126.wav 
```

并打电话

```
Button.setSound("Kits\\TestKit_128\\bass_126.wav"); 
```

抛出 a`System.NullReferenceException`因为在创建 URI 时找不到路径。（至少我是这么认为的！）

我应该怎么办？

当我第一次运行应用程序时，有什么方法可以从项目中的文件夹加载文件或将它们复制到 IsolatedStorage 中？

谢谢

编辑：

我刚刚用 WinRar 打开了 XAP 文件，没有“Kits”文件夹，所以我想我的问题是如何让它将文件夹添加到 XAP 文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:57:06.527

尝试这个：

```
 Uri uri = new Uri("Kits/TestKit_128/bass_126.wav", UriKind.Relative);//Above the Kits folder only the project itself. 
        StreamResourceInfo sr = Application.GetResourceStream(uri);

        try
        {
            using (Stream stream = sr.Stream)
            {
                //working here with your data image or wav or whatever you want from URI
            }
        }
        catch (Exception)
        {
        } 
```

这是项目内部的资源，对我有用。另外关于“内容”的先前注释是正确的，没有它就无法工作。我认为问题是地址中的双斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:22:01.567

您是否将 wav 文件的构建操作设置为“内容”？右键单击 WAV 文件 --> 属性 --> 构建操作 == 内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:34:10.840

我认为您必须将文件夹和文件添加到您的项目中（我假设您使用的是 Visual Studio）。尝试右键单击您的解决方案并添加现有对象（在本例中为您的 wav 文件）。

# java - XML 布局，listview/textview 下的按钮

> ID：14341434
> 
> 赞同：-1
> 
> 时间：2013-01-15T15:48:50.267
> 
> 标签：java, android

我在同一行上有一个带有 imageview 和 textview 的 XML 布局。这工作得很好，但现在我想在它下面放置三个按钮，我无法弄清楚使用什么布局来实现这些按钮，因为布局只是设置在图像和 textview 之间的行内。

下图显示了我试图实现的目标。（b1、b2 和 b3 代表按钮）

![布局](../Images/7fb0ebaa0e183e014750f1a2f0b5ebbc.png)

谁能给我一个正确的方向推动我如何获得这种布局？

这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<ImageView
    android:id="@+id/imgLink"
    android:layout_width="78dp"
    android:layout_height="match_parent"
    android:src="@drawable/cons" />

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="match_parent"
            android:layout_height="75dp"
            android:gravity="center"
            android:text="Contacts"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textSize="40sp" />

    </LinearLayout>

</LinearLayout> 
```

现在布局错位的文本视图/布局 ![另一种布局](../Images/94137e4a46b440c94fe8dba3745658bd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:00:15.540

尝试这个：

**编辑：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <ImageView
            android:id="@+id/imgLink"
            android:layout_width="78dp"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:layout_weight="1"
            android:src="@drawable/cons" />

        <TextView
            android:id="@+id/textView1"
            android:layout_width="match_parent"
            android:layout_height="75dp"
            android:gravity="center"
            android:text="Contacts"
            android:layout_weight="1"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textSize="40sp" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <Button
            android:id="@+id/b1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_margin="20dp"
            android:text="b1" />

        <Button
            android:id="@+id/b2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_margin="20dp"
            android:text="b2" />

        <Button
            android:id="@+id/b3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_margin="20dp"
            android:text="b3" />
    </LinearLayout>

</LinearLayout> 
```

# ckeditor - CKEditor：使用工具栏按钮控制 Entermode

> ID：14341435
> 
> 赞同：0
> 
> 时间：2013-01-15T15:48:51.180
> 
> 标签：ckeditor

默认情况下，CKEditor 的回车键行为是添加一个`<p>`标签并开始一个新段落。但是可以在配置中使用`.EnterMode`参数修改该行为。

我想知道是否有一种方法可以更改运行时中的 Enter 键行为，方法是在其工具栏中放置一个按钮，在`<p>`和`<br>`（单行与双行）之间切换，就像在 Word 中一样。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:47:23.353

将以下内容保存到`editor_dir/plugins/entermode/plugin.js`：

```
'use strict';

(function() {
    CKEDITOR.plugins.add( 'entermode', {
        icons: 'entermode',
        init: function( editor ) {
            var enterP = new enterModeCommand( editor, CKEDITOR.ENTER_P );
            var enterBR = new enterModeCommand( editor, CKEDITOR.ENTER_BR );

            editor.addCommand( 'entermodep', enterP );
            editor.addCommand( 'entermodebr', enterBR );

            if ( editor.ui.addButton ) {
                editor.ui.addButton( 'EnterP', {
                    label: 'Enter mode P',
                    command: 'entermodep',
                    toolbar: 'paragraph,10'
                });

                editor.ui.addButton( 'EnterBR', {
                    label: 'Enter mode BR',
                    command: 'entermodebr',
                    toolbar: 'paragraph,20'
                });
            }

            editor.on( 'dataReady', function() {
                refreshButtons( editor );
            });
        }
    });

    function refreshButtons( editor ) {
        editor.getCommand( 'entermodep' ).setState(
            editor.config.enterMode == CKEDITOR.ENTER_P ? CKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF );

        editor.getCommand( 'entermodebr' ).setState(
            editor.config.enterMode == CKEDITOR.ENTER_BR ? CKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF );
    }

    function enterModeCommand( editor, mode ) {
        this.mode = mode;
    }

    enterModeCommand.prototype = {
        exec: function( editor ) {
            editor.config.enterMode = this.mode;
            refreshButtons( editor );
        },

        refresh: function( editor, path ) {
            refreshButtons( editor );
        }
    };
})(); 
```

现在将以下内容添加到`toolbar.css`您的皮肤文件中：

```
.cke_button__enterp_icon, .cke_button__enterbr_icon { display: none !important; }
.cke_button__enterp_label, .cke_button__enterbr_label { display: inline !important; } 
```

...或者画一些图标，如果你愿意的话。

运行编辑器时启用插件：

```
CKEDITOR.replace( 'id', { extraPlugins: 'entermode' } ); 
```

现在您可以`config.enterMode`从工具栏进行控制。

# postgresql - postgres 中的特殊字符 _

> ID：14341438
> 
> 赞同：1
> 
> 时间：2013-01-15T15:48:54.597
> 
> 标签：postgresql

我有一个这样的查询，它在 call_id 上使用索引，而如果我在值中添加 _，那么它会从索引搜索变为 seq 搜索。

```
explain analyze 
DELETE 
FROM completedcalls 
WHERE call_id like '560738a563616c6c004c7621@198.148.114.67-b2b1';

                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Delete on completedcalls  (cost=0.00..8.67 rows=1 width=6) (actual time=0.036..0.036 rows=0 loops=1)
   ->  Index Scan using i_call_id on completedcalls  (cost=0.00..8.67 rows=1 width=6) (actual time=0.034..0.034 rows=0 loops=1)
         Index Cond: ((call_id)::text = '560738a563616c6c004c7621@198.148.114.67-b2b1'::text)
         Filter: ((call_id)::text ~~ '560738a563616c6c004c7621@198.148.114.67-b2b1'::text)
 Total runtime: 0.069 ms
(5 rows) 
```

这个说法：

```
explain analyze 
DELETE 
FROM completedcalls 
WHERE call_id like '560738a563616c6c004c7621@198.148.114.67-b2b_1'; 
```

返回此执行计划：

```
QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Delete on completedcalls  (cost=0.00..39548.64 rows=84 width=6) (actual time=194.313..194.313 rows=0 loops=1)
   ->  Seq Scan on completedcalls  (cost=0.00..39548.64 rows=84 width=6) (actual time=194.310..194.310 rows=0 loops=1)
         Filter: ((call_id)::text ~~ '560738a563616c6c004c7621@198.148.114.67-b2b_1'::text)
 Total runtime: 194.349 ms
(4 rows) 
```

我的问题是如何在查询中转义这些字符。在 python 中使用 psycopg2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T15:54:01.687

您需要`_`使用反斜杠转义，如下所示：

```
DELETE FROM completedcalls 
WHERE call_id like '560738a563616c6c004c7621@198.148.114.67-b2b\_1'; 
```

此外，如果您不想要模式匹配，使用`=`而不是`LIKE`.

# javascript - cSlider：鼠标悬停时停止自动播放

> ID：14341448
> 
> 赞同：5
> 
> 时间：2013-01-15T15:49:37.853
> 
> 标签：javascript, jquery, slider

如何通过 onmouseover 事件停止 cSlider 的自动播放功能？

HTML：

```
<div id="da-slider" class="da-slider">

   <div class="da-slide">
     <p>Text</p>
   </div>

   <div class="da-slide">
     <p>More text</p>
   </div>

</div> 
```

到目前为止我用 jQuery 尝试过的内容：

```
$(function() {
    $('#da-slider').cslider({
            autoplay    : true,
            bgincrement : 450
    });
});

$('#da-slider').hover(function() {

    if($('#daslider').autoplay('true')){
        autoplay: false
    }

}, function () {
    autoplay: true
}); 
```

这是我正在使用的：

[http://tympanus.net/codrops/2012/03/15/parallax-content-slider-with-css3-and-jquery/](http://tympanus.net/codrops/2012/03/15/parallax-content-slider-with-css3-and-jquery/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:54:56.100

默认情况下未实现此功能，但这不应阻止您自己实现它。查看下面修改后的插件代码（注意`stop`和“启动”方法）

```
(function ($, undefined) {

    /*
    * Slider object.
    */
    $.Slider = function (options, element) {

        this.$el = $(element);

        this._init(options);

    };

    $.Slider.defaults = {
        current: 0,     // index of current slide
        bgincrement: 50, // increment the bg position (parallax effect) when sliding
        autoplay: false, // slideshow on / off
        interval: 4000  // time between transitions
    };

    $.Slider.prototype = {
        _init: function (options) {

            this.options = $.extend(true, {}, $.Slider.defaults, options);

            this.$slides = this.$el.children('div.da-slide');
            this.slidesCount = this.$slides.length;

            this.current = this.options.current;

            if (this.current < 0 || this.current >= this.slidesCount) {

                this.current = 0;

            }

            this.$slides.eq(this.current).addClass('da-slide-current');

            var $navigation = $('<nav class="da-dots"/>');
            for (var i = 0; i < this.slidesCount; ++i) {

                $navigation.append('<span/>');

            }
            $navigation.appendTo(this.$el);

            this.$pages = this.$el.find('nav.da-dots > span');
            this.$navNext = this.$el.find('span.da-arrows-next');
            this.$navPrev = this.$el.find('span.da-arrows-prev');

            this.isAnimating = false;

            this.bgpositer = 0;

            this.cssAnimations = Modernizr.cssanimations;
            this.cssTransitions = Modernizr.csstransitions;

            if (!this.cssAnimations || !this.cssAnimations) {

                this.$el.addClass('da-slider-fb');

            }

            this._updatePage();

            // load the events
            this._loadEvents();

            // slideshow
            if (this.options.autoplay) {

                this._startSlideshow();

            }

        },
        _navigate: function (page, dir) {

            var $current = this.$slides.eq(this.current), $next, _self = this;

            if (this.current === page || this.isAnimating) return false;

            this.isAnimating = true;

            // check dir
            var classTo, classFrom, d;

            if (!dir) {

                (page > this.current) ? d = 'next' : d = 'prev';

            }
            else {

                d = dir;

            }

            if (this.cssAnimations && this.cssAnimations) {

                if (d === 'next') {

                    classTo = 'da-slide-toleft';
                    classFrom = 'da-slide-fromright';
                    ++this.bgpositer;

                }
                else {

                    classTo = 'da-slide-toright';
                    classFrom = 'da-slide-fromleft';
                    --this.bgpositer;

                }

                this.$el.css('background-position', this.bgpositer * this.options.bgincrement + '% 0%');

            }

            this.current = page;

            $next = this.$slides.eq(this.current);

            if (this.cssAnimations && this.cssAnimations) {

                var rmClasses = 'da-slide-toleft da-slide-toright da-slide-fromleft da-slide-fromright';
                $current.removeClass(rmClasses);
                $next.removeClass(rmClasses);

                $current.addClass(classTo);
                $next.addClass(classFrom);

                $current.removeClass('da-slide-current');
                $next.addClass('da-slide-current');

            }

            // fallback
            if (!this.cssAnimations || !this.cssAnimations) {

                $next.css('left', (d === 'next') ? '100%' : '-100%').stop().animate({
                    left: '0%'
                }, 1000, function () {
                    _self.isAnimating = false;
                });

                $current.stop().animate({
                    left: (d === 'next') ? '-100%' : '100%'
                }, 1000, function () {
                    $current.removeClass('da-slide-current');
                });

            }

            this._updatePage();

        },
        _updatePage: function () {

            this.$pages.removeClass('da-dots-current');
            this.$pages.eq(this.current).addClass('da-dots-current');

        },
        _startSlideshow: function () {

            var _self = this;

            this.slideshow = setTimeout(function () {

                var page = (_self.current < _self.slidesCount - 1) ? page = _self.current + 1 : page = 0;
                _self._navigate(page, 'next');

                if (_self.options.autoplay) {

                    _self._startSlideshow();

                }

            }, this.options.interval);

        },
        page: function (idx) {

            if (idx >= this.slidesCount || idx < 0) {

                return false;

            }

            if (this.options.autoplay) {

                clearTimeout(this.slideshow);
                this.options.autoplay = false;

            }

            this._navigate(idx);

        },
        stop: function () {
            if (this.options.autoplay) {

                clearTimeout(this.slideshow);
                this.options.autoplay = false;

            }
        },
        start: function () {
            this.options.autoplay = true;
            this._startSlideshow();
        },
        _loadEvents: function () {

            var _self = this;

            this.$pages.on('click.cslider', function (event) {

                _self.page($(this).index());
                return false;

            });

            this.$navNext.on('click.cslider', function (event) {

                if (_self.options.autoplay) {

                    clearTimeout(_self.slideshow);
                    _self.options.autoplay = false;

                }

                var page = (_self.current < _self.slidesCount - 1) ? page = _self.current + 1 : page = 0;
                _self._navigate(page, 'next');
                return false;

            });

            this.$navPrev.on('click.cslider', function (event) {

                if (_self.options.autoplay) {

                    clearTimeout(_self.slideshow);
                    _self.options.autoplay = false;

                }

                var page = (_self.current > 0) ? page = _self.current - 1 : page = _self.slidesCount - 1;
                _self._navigate(page, 'prev');
                return false;

            });

            if (this.cssTransitions) {

                if (!this.options.bgincrement) {

                    this.$el.on('webkitAnimationEnd.cslider animationend.cslider OAnimationEnd.cslider', function (event) {

                        if (event.originalEvent.animationName === 'toRightAnim4' || event.originalEvent.animationName === 'toLeftAnim4') {

                            _self.isAnimating = false;

                        }

                    });

                }
                else {

                    this.$el.on('webkitTransitionEnd.cslider transitionend.cslider OTransitionEnd.cslider', function (event) {

                        if (event.target.id === _self.$el.attr('id'))
                            _self.isAnimating = false;

                    });

                }

            }

        }
    };

    var logError = function (message) {
        if (this.console) {
            console.error(message);
        }
    };

    $.fn.cslider = function (options) {

        if (typeof options === 'string') {

            var args = Array.prototype.slice.call(arguments, 1);

            this.each(function () {

                var instance = $.data(this, 'cslider');

                if (!instance) {
                    logError("cannot call methods on cslider prior to initialization; " +
                    "attempted to call method '" + options + "'");
                    return;
                }

                if (!$.isFunction(instance[options]) || options.charAt(0) === "_") {
                    logError("no such method '" + options + "' for cslider instance");
                    return;
                }

                instance[options].apply(instance, args);

            });

        }
        else {

            this.each(function () {

                var instance = $.data(this, 'cslider');
                if (!instance) {
                    $.data(this, 'cslider', new $.Slider(options, this));
                }
            });

        }

        return this;

    };

})(jQuery); 
```

使用更新的插件，您可以使用以下代码暂停和更新自动播放：

```
$('#da-slider').hover(
    function () {
        $(this).cslider("stop");
    },
    function () {
        $(this).cslider("start");
    }
); 
```

# unit-testing - 测试传出的 Akka Actor 消息

> ID：14341449
> 
> 赞同：4
> 
> 时间：2013-01-15T15:49:38.183
> 
> 标签：unit-testing, scala, akka, actor

假设我有这样的演员（使用 Akka 2.1 和 Scala 2.10）：

```
class ClientActor extends Actor with ActorLogging {

  val configurationManager = context.actorOf(Props[ConfigurationManager], "ConfigurationManager")

  def disconnected: Receive = {
    case msg: Connect => 
      configurationManager ! msg
      context.become(connecting)
  }

  ..

  def recieve = disconnected
} 
```

所以现在当客户端收到一个 Connect 消息时，它会将它发送到 ConfigurationManager 并进入不同的状态。很好，但现在我想测试一下。

```
val clientRef = TestActorRef(new ClientActor).
clientRef ! new Connect
// ?? 
```

我不能在这里期待Msg() 左右，因为它将被发送给不同的演员。处理这种情况的最佳做法是什么？我只是想确保消息被发送，但我不知道该怎么做。

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:30:05.957

将依赖项作为构造函数参数传递：

正常代码：

```
val configActor = 
  system.actorOf(Props[ConfigurationManager], "configManager")

val clientActor = 
  system.actorOf(Props(new ClientActor(configActor)), "clientActor") 
```

测试代码：

```
val clientActor = 
  system.actorOf(Props(new ClientActor(testActor)), "clientActor") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:30:34.287

如果你抽象出协作actor的创建，那么你可以注入一个测试actor来做你想做的任何事情。这种情况与测试普通对象之间的协作非常相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:59:39.363

也许您应该相信 Akka 内部的消息发送机制会像宣传的那样工作。如果你真的，真的不能相信这一点，那么最好的解决方案是下载 Akka 源代码，然后添加你自己的单元测试来覆盖你的用例，或者修改代码来支持你自己的单元测试需求。

或者你可以使用像 Camel 这样的东西来完成所有的消息发送和拦截消息。

# ruby-on-rails - 无法链接到属于某个类别的对象

> ID：14341452
> 
> 赞同：0
> 
> 时间：2013-01-15T15:49:41.583
> 
> 标签：ruby-on-rails, ruby-on-rails-3, relationship, rails-activerecord

我有一种方法可以将我所有的书籍类别组合在一起

```
def self.categories_list
joins(:books).
select('categories.id, categories.name, count(*) AS books_count').
group('categories.id, categories.name').
order('books_count DESC')
end 
```

然后我可以像这样将它们输出到我的视图中

```
@bookcategories = Category.categories_list 
```

然后我想做的是通过单击视图中的“计算”链接到属于“计算”的所有书籍

```
<% @bookcategories.each do |b| %>
  <li><%= link_to b.name, category_path(b.name) %></li>
<% end %> 
```

这应该带我进入我的类别控制器的显示操作

```
 def show
  @category = Category.where(:name => params[:name]).first
  @categorisedbooks = @category.books #get me all books that have the category name
  end 
```

以及 show 动作的视图

```
 <div class="container">
   <div class="row ">
    <div class="span12">     
     <% @categorisedbooks.each do |c| %>
      <%= image_tag c.avatar.url(:medium), :class=> "allBooksCover" %>
     <% end %>
   </div>
  </div>
 </div> 
```

因此，例如，当我单击“计算”时，我得到

```
 undefined method `books' for nil:NilClass 
```

并且参数被传递为

```
 Parameters:{"id"=>"Computing"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:53:08.977

所以，你需要在你的`show`行动

```
@category = Category.where(:name => params[:id]).first
# etc 
```

# yii - 使用用户表中的 user_status 字段更改 imageUrl

> ID：14341456
> 
> 赞同：0
> 
> 时间：2013-01-15T15:49:55.253
> 
> 标签：yii, cgridview, cbuttoncolumn

我必须建模：用户，UserFlag 在用户/索引中添加了 CGridView 中的一列：

```
array(
    'class' => 'CButtonColumn',
    'htmlOptions' => array("style" => 'width: 45px;'),
    'template' => '{enable}',
    'header' => 'management',
    'buttons' => array(
            'enable' => array(
                'name' => 'enable',
                'imageUrl' => Yii::app()->baseUrl."/images/ico/group.png",
                'url' => '"#".$data->username',
                'click' => 'js:function() {
                    if(confirm("Are you sure?")){
                                    changeUserStatus($(this).attr("href").replace("#", ""));
                                }
                            }',
                ),
    ), 
```

我将从 UserFlag 模型中读取用户状态，如果状态是活动的，我会显示 1.png，如果状态是非活动的，我会显示 2.png。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:36:40.550

是的，不幸的是，无法从 imageUrl 访问 $data var。我建议像 Stu 的链接那样从 CButtonColumn 扩展。

如果您不想这样做，您可以创建两个按钮列并根据状态显示它们。这将是这样的，但如果您的活动 user_status 值不是 1 或者您希望图像反转，您可能需要调整它：

```
'enable' => array(
                'name' => 'enable',
                'visible'=>'$data->user_status == 1'
                'imageUrl' => Yii::app()->baseUrl."/images/ico/1.png",
                'url' => '"#".$data->username',
                'click' => 'js:function() {
                    if(confirm("Are you sure?")){
                                    changeUserStatus($(this).attr("href").replace("#", ""));
                                }
                            }',
                ),

'disable' => array(
                'name' => 'disable',
                'visible'=>'$data->user_status == 0'
                'imageUrl' => Yii::app()->baseUrl."/images/ico/0.png",
                'url' => '"#".$data->username',
                'click' => 'js:function() {
                    if(confirm("Are you sure?")){
                                    changeUserStatus($(this).attr("href").replace("#", ""));
                                }
                            }',
                ), 
```

您还需要将 {disable} 添加到您的 CButtonColumn 模板。

这并不理想，因为您正在重复代码，但至少您可以在不必扩展任何类的情况下做到这一点。

# url - URL.openStream() 无响应

> ID：14341460
> 
> 赞同：2
> 
> 时间：2013-01-15T15:50:03.767
> 
> 标签：url, stream, inputstream

我测试了这一刻。这是在网络摄像机上拍照。

```
public static void main(String[] args) throws Exception {

    URL url = new URL("http://192.168.1.210:5500/snapshot.cgi?user=admin&pwd=123456");
    InputStream is = url.openStream();
    BufferedImage image = null;
    image = ImageIO.read(is);
    is.close();

} 
```

我的问题是这一行：“InputStream is = url.openStream();” 我知道我的地址是错误的，但它一直处于阻塞状态，我没有错误或其他问题。有人有想法解决我的问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:57:03.697

[URL.openStream()](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#openStream%28%29)的 Java API 文档说

> 打开到此 URL 的连接并返回一个 InputStream 以从该连接中读取。此方法是以下的简写：
> 
> openConnection().getInputStream()

因此，您可以尝试首先通过打开连接`openConnection()`，然后在该对象处设置超时，然后调用`getInputStream()`，也许这会起作用。

```
 URLConnection urlcon = url.openConnection();
    urlcon.setReadTimeout(10000);
    InputStream is = urlcon.getInputStream(); 
```

或者至少给你更多关于问题可能是什么的信息。

# android - 简单的 Android 应用颜色

> ID：14341461
> 
> 赞同：1
> 
> 时间：2013-01-15T15:50:12.923
> 
> 标签：android, android-layout

我有一个没有明确定义任何颜色的应用程序。该应用程序在我的手机上看起来与在我办公室周围的其他几部手机上看起来不同（我手机上应用程序顶部的标题栏是蓝色的白色字母，而在其他手机上它是灰色的白色字母）。我如何使它们都一样？是否像在我的应用程序中明确设置颜色一样简单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:58:11.347

您需要将可用主题之一应用于您的应用程序。你可以做到`AndroidManifest.xml`，只需使用`android:theme`属性：

`android:theme="@android:style/Theme.Holo"`如果您想要深色主题或`android:theme="@android:style/Theme.Holo.Light"`想要浅色主题。

如果你使用把这个应用程序放在你的`<activity>`标签中，只有相应的活动会被样式化，如果你把它放在`<application>`标签中，样式将被应用到整个应用程序。

当然，你可以定义自己的风格`styles.xml`：

```
<style name="AppTheme" parent="android:Theme.Light">
    <item name="android:windowBackground">@drawable/bg_window</item>
    <item name="android:windowActionBar">false</item>    
    <item name="android:windowNoTitle">true</item>
</style> 
```

以下是 的示例`AndroidManifest.xml`：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme"
    >

    <activity
        android:name=".Activity1"
        android:theme="@style/AppTheme2"
        />

    <activity
        android:name=".Activity2"
        /> 
```

在此示例中，`AppTheme2`将仅应用于`Activity1`，而`AppTheme`将应用于所有其他活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:00:49.690

所有非您设计的按钮、文本视图和其他 UI 元素将根据所选主题更改其外观。如果您选择默认主题，所有 GUI 小部件的外观会因设备制造商、Android 版本等不同而有所不同。

您可以指定一个具体的主题，例如 Holo，但问题是它不适用于 3.0 之前的 Android 版本。您可以保留旧版本的默认主题，或者您可以使用此网站自己生成所有 Holo 风格的 GUI 元素：

[http://android-holo-colors.com/](http://android-holo-colors.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:10:24.570

> 我手机上应用程序顶部的标题栏是蓝色的，带有白色字母，而在其他手机上，它是灰色的，带有白色字母

这是一些 OEM 定制框架的问题。它们覆盖了默认的 android 样式。我假设带有蓝色标题栏的设备是带有 TouchWiz 的三星设备，对吧？

我为了有一个一致的标题栏，你必须声明自己的主题：

```
<style name="AppTheme" parent="android:Theme.Light">
    <item name="android:windowBackground">@drawable/title_bar</item>
    <item name="android:windowTitleStyle">@style/WindowTitle</item>    
</style>

<style name="WindowTitle">
    <item name="android:singleLine">true</item>
    <item name="android:textAppearance">@style/TextAppearance.WindowTitle</item>
    <item name="android:shadowColor">#BB000000</item>
    <item name="android:shadowRadius">2.75</item>
</style> 
```

原始[title_bar](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/drawable-hdpi/activity_title_bar.9.png) 9 补丁。

* * *

这是您的问题的答案。但是，在我看来，您不应该使用标题栏，而应使用 ActionBar。您可以使用 ActionBarSherlock 来实现向后兼容性。

# python - 如何从芹菜链返回第一个任务的结果？

> ID：14341465
> 
> 赞同：1
> 
> 时间：2013-01-15T15:50:33.490
> 
> 标签：python, django, celery

这些是我的任务：

```
@task(name = 'hello')
def hello():
    print "hello"
    return "helo"

@task(name = 'hey')
def hey(resp):
    print resp 
```

我这样称呼他们：`g = celery.chain(hello.s(),hey.s())` 但我希望它像这样完成：你好任务应该返回一个值，不仅是任务“嘿”，它还应该返回一个值。我的意思是，一旦完成执行，我应该能够获得“hello”的返回值。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:59:32.693

调用链时返回的结果实例将是链中的最后一个任务，但它会保留对父级的引用，因此您可以遍历父级以获取第一个任务：

```
r = chain(hello.s(), hey.s())()

r.parent.get(timeout=1)
r.parent.parent.get(timeout=1)

first = r
while first.parent:
    first = first.parent 
```

见[http://docs.celeryproject.org/en/latest/userguide/canvas.html#chains](http://docs.celeryproject.org/en/latest/userguide/canvas.html#chains)

# node.js - 如何在 Heroku 上使用多个测功机的 node-openid？

> ID：14341471
> 
> 赞同：4
> 
> 时间：2013-01-15T15:50:56.407
> 
> 标签：node.js, heroku, openid

我正在尝试使用[node-openid](https://github.com/havard/node-openid)（通过[passport-google](https://github.com/jaredhanson/passport-google)）使用他们的 Google 凭据对我的用户进行身份验证。它在我的开发机器上运行良好，但是当我使用 2 个 dyno 将其部署到 Heroku 时，它会在一个 dyno 处理整个 OpenID 对话时工作，而当对话在一个 dyno 上开始并在第二个 dyno 上完成时它会失败。在这种情况下，我收到以下错误：

```
2013-01-15T15:18:24+00:00 app[web.2]: Failed to verify assertion (message: Invalid association handle)
2013-01-15T15:18:24+00:00 app[web.2]:     at Strategy.authenticate.identifier (/app/node_modules/passport-google/node_modules/passport-openid/lib/passport-openid/strategy.js:143:36)
... 
```

处理这个问题的正确方法是什么？我是否应该以某种方式将对话状态保存在数据库中，以便两个测功机都可以访问它？

**更新：**

这是我用来通过将关联存储在 MongoDB 中来解决问题的代码。

```
var
  GoogleStrategy = require('passport-google').Strategy;

// We have to save the OpenID state in the database so it's available to both
// dynos.

db.collection('OpenID').ensureIndex({expires: 1}, {expireAfterSeconds: 0},
    function(err, result) {
        if (err) {
            throw new Error('Error setting TTL index on OpenID collection.');
        }
    });

// Use the GoogleStrategy within Passport.
//   Strategies in passport require a `validate` function, which accept
//   credentials (in this case, an OpenID identifier and profile), and invoke a
//   callback with a user object.
strategy = new GoogleStrategy({
    returnURL: 'http://localhost:3000/auth/google/return',
    realm: 'http://localhost:3000/'
  },
  function(identifier, profile, done) {
    // asynchronous verification, for effect...
    process.nextTick(function () {

      // To keep the example simple, the user's Google profile is returned to
      // represent the logged-in user.  In a typical application, you would want
      // to associate the Google account with a user record in your database,
      // and return that user instead.
      profile.identifier = identifier;
      return done(null, profile);
    });
  }
);

strategy.saveAssociation(function(handle, provider, algorithm, secret, expiresIn, done) {
    db.collection("OpenID").insert({
        handle: handle,
        provider: provider,
        algorithm: algorithm,
        secret: secret,
        expires: new Date(Date.now() + 1000 * expiresIn)
    }, done);
});

strategy.loadAssociation(function(handle, done) {
    db.collection("OpenID").findOne({handle: handle}, function (error, result) {
        if (error)
            return done(error);
        else
            return done(null, result.provider, result.algorithm, result.secret);
    });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T21:34:09.333

您可能应该查看 node-openid README 中的[存储关联状态](https://github.com/havard/node-openid#storing-association-state)部分。默认情况下，会话状态存储在各个测功机的内存中，这就是导致您出现问题的原因。

覆盖`saveAssociation()`和`loadAssociation()`mixins 以使用您的应用程序当前正在使用的任何后备存储。[在 passport-openid 源代码中](https://github.com/jaredhanson/passport-openid/blob/master/lib/passport-openid/strategy.js#L199-L298)有更多文档。

# android - Android/Monodroid 图像小于 imagebutton

> ID：14341477
> 
> 赞同：2
> 
> 时间：2013-01-15T15:51:13.150
> 
> 标签：android, xamarin.android, imagebutton

我想创建一个图像按钮，但图像没有填充图像按钮。图像具有与图像按钮相同的尺寸。imagebutton 有正确的尺寸，好像 imagebutton 有一个填充？！

我尝试了大多数比例类型。

我的代码：

```
ImageButton ib = new ImageButton(Context);
AbsoluteLayout.LayoutParams lp = new AbsoluteLayout.LayoutParams((int)getWidth(3), (int)rowHeight, (int)offsetValue, (int)(offsetRow+row*rowHeight));

Stream bitmap = act.Assets.Open("somefolder/" + name + ".gif");
Bitmap bMap = Android.Graphics.BitmapFactory.DecodeStream(bitmap);

bMap = Bitmap.CreateScaledBitmap(bMap, (int)getWidth(3), (int)rowHeight, false);

ib.SetScaleType(ImageButton.ScaleType.FitXy);
ib.SetAdjustViewBounds(true);
ib.SetImageBitmap(bMap);

bitmap = null;
bMap = null;

ib.LayoutParameters = lp;

layout.AddView(ib); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:56:32.203

是的，它有一个填充或类似的东西，我想在 EditText 中创建一个按钮，以允许用户使密码可见并遇到同样的问题......直到现在还没有找到解决方案。
对于您正在尝试的内容，我建议您使用 ImageView 并使其可点击，而不是您具有相同的功能，就像图像按钮一样，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:04:05.120

Android 框架中定义的标准 9-patch drawable`ImageButton`具有内容填充，不允许您使用按钮内的所有空间。要解决此问题，请使用您自己的背景可绘制对象（使用`android:background="@drawable/..."`属性设置）或调整您在`android:src`属性中设置的可绘制对象。

请阅读[本文](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)以获取有关 9-patch 可绘制对象如何定义内容填充的更多信息。

# sql-server - 同时满足 WHERE 条件 - T-SQL

> ID：14341479
> 
> 赞同：1
> 
> 时间：2013-01-15T15:51:20.850
> 
> 标签：sql-server, tsql

我需要帮助改进下表查询中的 WHERE 子句：

```
Key   |   Name   |   Role   |   Location
111   |   Bob    | Manager  |  All Locations
222   |   Jim    | Manager  |  All Locations
333   |   Tim    | Sales    |  Washington
444   |   Roy    | Sales    |  New York
555   |   Lee    | Sales    |  All Locations
666   |   Gus    | Sales    |  All Locations
777   |   Joe    | Admin    |  All Locations
888   |   Jen    | Admin    |  New York 
```

我需要排除所有“所有位置”记录，但保留角色为经理的“所有位置”记录。要获得所需的结果：

```
Key   |   Name   |   Role   |   Location
111   |   Bob    | Manager  |  All Locations
222   |   Jim    | Manager  |  All Locations
333   |   Tim    | Sales    |  Washington
444   |   Roy    | Sales    |  New York
888   |   Jen    | Admin    |  New York 
```

我觉得下面的查询会排除所有的所有位置记录，包括经理的。

```
SELECT * FROM Table
WHERE (Location <> 'All Locations' AND Role <> 'Manager') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T15:53:36.787

您将要扩展`WHERE`：

```
select *
from yourtable
where
(
  role = 'Manager'
  and location = 'All Locations'
)
or
(
  location <> 'All Locations'
) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/db8ab/1)

返回结果：

```
| KEY | NAME |    ROLE |      LOCATION |
----------------------------------------
| 111 |  Bob | Manager | All Locations |
| 222 |  Jim | Manager | All Locations |
| 333 |  Tim |   Sales |    Washington |
| 444 |  Roy |   Sales |      New York |
| 888 |  Jen |   Admin |      New York | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:53:07.557

```
SELECT * FROM Table
WHERE (Location != 'All Locations' OR (Location = 'All Locations' AND Role = 'Manager') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:01:06.320

您说“排除所有'所有位置'记录，但保留角色为经理的'所有位置'记录。” 这是否意味着***排除角色******不是***经理的所有位置记录？即，您不希望包含记录 111 和 222 吗？

根据德摩根定律，Not A And Not B 等价于 Not (A or B)

在你的情况下，一个谓词是肯定的，另一个是否定的，所以德摩根会读到：

```
 Not (A And not B) <=> (Not A or B), i.e., 
```

这意味着***包括***所有不是所有位置或经理的记录。

如果是这样，那么您需要的是：

```
 ... Where Location != 'All Locations' Or Role = 'Manager' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T15:52:50.463

您应该使用 OR 而不是 AND

```
SELECT * FROM Table
WHERE (Location <> 'All Locations' OR Role = 'Manager') 
```

# javascript - 雷鸟 openTab 方法

> ID：14341480
> 
> 赞同：0
> 
> 时间：2013-01-15T15:51:22.323
> 
> 标签：javascript, thunderbird-addon

我正在编写一个扩展，我想在新选项卡中打开一个消息（不是默认选项卡，而是在用 HTML 编写的选项卡中，如本教程[http://xulforum.org/fosdem2012/presentation/template.html](http://xulforum.org/fosdem2012/presentation/template.html)）

我的问题是，我想将参数传递给新打开的选项卡，但我没有设法在 Internet 上找到有关传递参数的任何信息。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:27:24.047

你应该在你打开的标签的 URL 中传递你的参数，这绝对是最简单的方法。

```
openTab("chromeTab", { chromePage: "chrome://yourext/content/foo.html?foo=bar" }); 
```

这是一个例程，您可以使用它轻松地将当前 URI 的参数映射到 javascript 字典：

```
/**
 * Takes the <b>entire</b> query string and returns an object whose keys are the
 * parameter names and values are corresponding values.
 * @param aStr The entire query string
 * @return An object that holds the decoded data
 */
function decodeUrlParameters(aStr) {
  let params = {};
  let i = aStr.indexOf("?");
  if (i >= 0) {
    let query = aStr.substring(i+1, aStr.length);
    let keyVals = query.split("&");
    for each (let [, keyVal] in Iterator(keyVals)) {
      let [key, val] = keyVal.split("=");
      val = decodeURIComponent(val);
      params[key] = val;
    }
  }
  return params;
} 
```

（警告：这是特定于 mozilla 的 javascript）

# security - 使用多种算法散列密码

> ID：14341482
> 
> 赞同：7
> 
> 时间：2013-01-15T15:51:25.123
> 
> 标签：security, hash

使用多种算法会使密码更安全吗？（或更少？）

为了清楚起见，我不是在谈论做这样的事情：

```
key = Hash(Hash(salt + password)) 
```

我说的是使用两个单独的算法并匹配两者：

```
key1 = Hash1(user_salt1 + password)
key2 = Hash2(user_salt2 + password) 
```

然后在进行身份验证时要求两者匹配。我已经看到这是一种消除冲突匹配的方法，但我想知道意想不到的后果，例如创建“最弱链接”场景或提供使用户数据库更容易破解的信息，因为这种方法提供的数据比一个键就可以了。例如，将信息与哈希结合起来以更容易地找到它们。此外，如果真正消除了冲突，理论上您可以暴力破解实际密码，而不仅仅是匹配密码。实际上，您必须完全强制系统。

我实际上并不打算实现这一点，但我很好奇这是否实际上是对 single 标准实践的改进`key = Hash(user_salt + password)`。

编辑：

很多好的答案，所以只是在这里推测，这应该是显而易见的，但是你确实通过使用两者来创建一个最薄弱的链接，因为可以尝试两种算法中较弱的匹配。例如，如果您使用弱（快速）MD5 和 PBKDF2，我会先暴力破解 MD5，然后尝试我找到的任何匹配项，因此通过使用 MD5（或其他），您实际上会使情况变得更糟。此外，即使两者都属于更安全的集合（例如 bcrypt+PBKDF2），您也会将其中一个破坏的风险加倍。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:00:28.803

这将有助于减少碰撞的可能性。正如您所提到的，有几个缺点（最弱的链接是一个大的）。

如果目标是减少冲突的可能性，最好的解决方案就是使用`bcrypt`具有更大散列的单个安全算法（例如）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-15T16:02:29.640

**现代散列算法不关心冲突。**关键不是要确保数据库中的每个散列都是唯一的。真正的重点是确保在您的数据库被盗或意外泄露的情况下，攻击者很难确定用户的*实际*密码。现代散列算法将*错误*密码识别为*正确*密码的机会实际上为零——这可能比你在这里得到的更多。

需要明确的是，您可能担心碰撞有两个主要原因。

1.  “正确”密码和提供的“错误”密码之间的冲突可能允许使用“错误”密码的用户进行身份验证。
2.  如果用户 B 的密码已知，则两个用户密码之间的冲突可能会“泄露”用户 A 的密码。

问题 1 是通过使用强大/现代的哈希算法来解决的（并避免非常反智能的事情，例如仅根据密码哈希查找用户记录）。问题 2 可以通过适当的加盐来解决——每个密码都有一个“冗长”的唯一加盐。让我强调一下，**适当的腌制仍然是必要的**。

但是，如果你在混合中添加哈希，你只是给潜在的攻击者更多的信息。我不确定*目前*是否有任何已知的方法可以从一对散列中“三角化”消息数据（密码），但是通过包含另一个散列并没有获得显着收益。*有*办法利用附加信息的风险是不值得的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T16:02:52.627

要回答您的问题：

拥有独特的盐比拥有通用盐更好。H(S1 + PW1) , H(S2 + PW2) 使用多种算法*可能*比使用单个 H1(X) , H2(Y) 更好（但可能不是，正如 svidgen 提到的那样）

**然而**，

这个问题的精神有点错误，原因有两个：

1.  没有安全专家的指导，您不应该提出自己的安全协议。我知道这不是您自己的算法，但大多数安全问题都是因为使用不正确而开始的；算法本身通常是密封的。

2.  您不应该使用 hash(salt+password) 将密码存储在数据库中。这是因为散列被设计为快速而不安全。使用今天的硬件（尤其是使用 GPU 处理）在旧算法中查找哈希冲突有点容易。您当然可以使用更新的安全散列算法（SHA-256 或 SHA-512），其中冲突不是问题 - 但为什么要冒险呢？

您应该研究基于密码的[密钥派生函数](http://en.wikipedia.org/wiki/Key_derivation_function)( [PBKDF2](http://en.wikipedia.org/wiki/PBKDF2) )，该函数旨在缓慢地阻止此类攻击。通常它需要结合加盐、安全散列算法 (SHA-256) 并迭代几十万次。

对于登录时他们不会注意到这种减速的用户来说，使该功能花费大约一秒钟是没有问题的。但是对于攻击者来说，这是一场噩梦，因为他们必须为每次尝试执行这些迭代；显着减慢任何蛮力尝试。

看看支持 PBKDF 加密的库，这是一种更好的方法。 [Jasypt](http://www.jasypt.org/)是我最喜欢的 Java 加密之一。

**请参阅这个**相关的安全问题：[如何安全地散列密码](https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords) 和这个松散相关的[SO 问题](https://stackoverflow.com/questions/481160/is-bcrypt-a-good-encryption-algorithm-to-use-in-c-where-can-i-find-it)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:28:54.907

将盐添加到密码哈希中以防止使用通用的预构建哈希表。攻击者将被迫根据他们的单词列表和你的随机盐生成新表。

如前所述，哈希被设计为快速是有原因的。要将它们用于密码存储，您需要减慢它们的速度（大量嵌套重复）。

您可以创建自己的特定于密码的哈希方法。本质上，将您喜欢的散列嵌套在`salt+password`和 上。

```
string MyAlgorithm(string data) {
  string temp = data;
  for i = 0 to X {
    temp = Hash3(Hash2(Hash1(temp)));
  }
}
result = MyAlgorithm("salt+password"); 
```

其中“X”是大量重复，足以使整个事情在体面的硬件上至少需要一秒钟。正如其他地方所提到的，这种延迟对普通用户（知道正确密码并且只等待一次）来说是微不足道的，但对攻击者（他们必须为每个组合运行这个过程）来说很重要。当然，这一切都是为了学习，使用适当的现有 API 可能更简单。

# javascript - 使用 javascript 从客户端在 Rails 上设置时区

> ID：14341483
> 
> 赞同：1
> 
> 时间：2013-01-15T15:51:25.487
> 
> 标签：javascript, ruby-on-rails, cookies, timezone

我有一个设置时区的 webapp

```
post_controller.rb

before_filter :set_time_zone
def set_time_zone
  Time.zone = user.time_zone
end 
```

现在，我没有在注册时从用户那里获取 time_zone，而是想知道如何从客户端动态设置时区并将其设置在 before_filter 中。我试图使用[detect_timezone_rails gem](https://github.com/scottwater/detect_timezone_rails)。gem 提供了一种访问客户端时区的简单方法，只需从 js 文件中调用这样的函数即可。

```
$(document).ready(function(){
    $('#your_input_id').set_timezone(); 
}); 
```

现在，上面的代码自动设置你的隐藏字段输入或选择输入，但我想知道你是否可以简单地使用函数调用保存到会话并从 Rails 服务器检索它。我猜当用户第一次访问该站点时，可以设置时区，并且可以使用会话值来设置其余访问的时区。我认为可以使用会话值在前置过滤器中设置时区。作为 javascript 的新手，我不确定如何访问 Rail 的加密 cookie 存储来设置值。这可能吗？如果是这样，我该怎么做？提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:09:24.063

```
#javascript
function readCookieValue(cookieName)
{
  return (result = new RegExp('(?:^|; )' + encodeURIComponent(cookieName) + '=([^;]*)').exec(document.cookie)) ? decodeURIComponent(result[1]) : null;
}

$(document).ready(function(){

if(readCookieValue("time_zone") === null) {
  $.post('/set_time_zone',
       { 'offset_minutes':(-1 * (new Date()).getTimezoneOffset())});
}

#controller:
def set_time_zone
  offset_seconds = params[:offset_minutes].to_i * 60
  @time_zone     = ActiveSupport::TimeZone[offset_seconds]
  @time_zone     = ActiveSupport::TimeZone["UTC"] unless @time_zone
  if @time_zone
    cookies[:time_zone] = @time_zone.name if @time_zone
    render :text => "success"
  else
    render :text => "error"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-22T21:46:53.140

我们这样做有些不同。如果我们想从 JS 收集时区，我们使用`gon` [gem在 Rails 端设置一个变量。](https://github.com/gazay/gon)然后，我们在客户端上有 JS 代码检查该变量，如果设置，则使用[jstimezonedetect](https://bitbucket.org/pellepim/jstimezonedetect)脚本返回的时区字符串向端点发送 XHR（就像 OP 所做的那样），该脚本返回 IANA 时区键。最后，为了将其转换为 Rails 3.2.19 时区名称，我们做了`ActiveSupport::TimeZone::MAPPING.invert[iana_key]`. 花了一些步骤来解决这个问题，希望它对某人有所帮助。

# c# - 使用 caliburn micro 在代码中设置 RadioButton

> ID：14341484
> 
> 赞同：5
> 
> 时间：2013-01-15T15:51:29.757
> 
> 标签：c#, wpf, .net-4.0, radio-button, caliburn.micro

我在 WPF 应用程序中有一个带有 4 个单选按钮（2 个组）的向导内的页面。我正在使用 .Net4 和 Caliburn Micro。

单击并设置值时，它会正确绑定到相应的属性。当我离开页面并返回时，我需要在代码中设置属性并期望它们通过 NotifyPropertyChanged 在页面上更新。但是即使设置了相应的属性，也不会检查任何 RadioButtons...

有谁知道这应该如何与 caliburn.micro 一起使用？！

这是xml：

```
<RadioButton Name="NewInstallChecked" GroupName="InstallType" Content="New Installation (default)" Margin="75,10,0,0" />
<RadioButton Name="UpdateInstallChecked" GroupName="InstallType" Content="Update of existing Installation" Margin="75,10,0,0" />
<Label Content="Please select which version of Siseco you want to install:" Height="28" HorizontalAlignment="Left" Margin="20,20,0,0" Name="label2" VerticalAlignment="Top" />
<RadioButton Name="ServerChecked" GroupName="Version" Content="Server version (default)" Margin="75,10,0,0" />
<RadioButton Name="ClientChecked" GroupName="Version" Content="Client version" Margin="75,10,0,0" /> 
```

这里是我的视图模型中的代码：

```
 public bool ClientChecked
    {
        get { return _clientChecked; }
        set { _clientChecked = value; NotifyOfPropertyChange(() => ClientChecked); }
    }

    public bool ServerChecked
    {
        get { return _serverChecked; }
        set { _serverChecked = value; NotifyOfPropertyChange(() => ServerChecked); }
    }

    public bool NewInstallChecked
    {
        get { return _newInstallChecked; }
        set { _newInstallChecked = value; NotifyOfPropertyChange(() => NewInstallChecked); }
    }

    public bool UpdateInstallChecked
    {
        get { return _updateInstallChecked; }
        set { _updateInstallChecked = value; NotifyOfPropertyChange(() => UpdateInstallChecked);}
    } 
```

...

```
 protected override void OnActivate()
    {
        NewInstallChecked = _options.NewInstall;
        UpdateInstallChecked = _options.UpdateInstall;
        ServerChecked = _options.ServerInstall;
        ClientChecked = _options.ClientInstall;
        base.OnActivate();
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-03T18:45:57.803

我让这个工作没有任何问题，所以我希望我能正确理解你的问题。这是我使用的代码：

**视图模型**

```
public class RadioButtonTestViewModel : Screen
{
    private bool newInstallChecked;
    private bool updateInstallChecked;
    private bool serverChecked;
    private bool clientChecked;

    public bool NewInstallChecked
    {
        get { return newInstallChecked; }
        set
        {
            if (value.Equals(newInstallChecked)) return;
            newInstallChecked = value;
            NotifyOfPropertyChange(() => NewInstallChecked);
        }
    }

    public bool UpdateInstallChecked
    {
        get { return updateInstallChecked; }
        set
        {
            if (value.Equals(updateInstallChecked)) return;
            updateInstallChecked = value;
            NotifyOfPropertyChange(() => UpdateInstallChecked);
        }
    }

    public bool ServerChecked
    {
        get { return serverChecked; }
        set
        {
            if (value.Equals(serverChecked)) return;
            serverChecked = value;
            NotifyOfPropertyChange(() => ServerChecked);
        }
    }

    public bool ClientChecked
    {
        get { return clientChecked; }
        set
        {
            if (value.Equals(clientChecked)) return;
            clientChecked = value;
            NotifyOfPropertyChange(() => ClientChecked);
        }
    }

    public void SaveAndClose()
    {
        Options.Client = ClientChecked;
        Options.NewInstall = NewInstallChecked;

        Options.Server = ServerChecked;
        Options.UpdateInstall = UpdateInstallChecked;

        TryClose();
    }

    protected override void OnInitialize()
    {
        base.OnInitialize();

        ClientChecked = Options.Client;
        NewInstallChecked = Options.NewInstall;

        ServerChecked = Options.Server;
        UpdateInstallChecked = Options.UpdateInstall;
    }

    public static class Options
    {
        public static bool NewInstall { get; set; }
        public static bool UpdateInstall { get; set; }

        public static bool Server { get; set; }
        public static bool Client { get; set; }
    }
} 
```

**风景**

```
<UserControl x:Class="CaliburnMicroTest.Views.RadioButtonTestView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignHeight="300"
             d:DesignWidth="300"
             mc:Ignorable="d">
    <StackPanel>
        <RadioButton Name="NewInstallChecked"
                     Margin="75,10,0,0"
                     Content="New Installation (default)"
                     GroupName="InstallType" />
        <RadioButton Name="UpdateInstallChecked"
                     Margin="75,10,0,0"
                     Content="Update of existing Installation"
                     GroupName="InstallType" />
        <Label Name="label2"
               Height="28"
               Margin="20,20,0,0"
               HorizontalAlignment="Left"
               VerticalAlignment="Top"
               Content="Please select which version of Siseco you want to install:" />
        <RadioButton Name="ServerChecked"
                     Margin="75,10,0,0"
                     Content="Server version (default)"
                     GroupName="Version" />
        <RadioButton Name="ClientChecked"
                     Margin="75,10,0,0"
                     Content="Client version"
                     GroupName="Version" />
        <StackPanel Margin="10" Orientation="Horizontal">
            <Button Name="SaveAndClose"
                    Width="80"
                    Content="Ok" />
            <Button Name="TryClose"
                    Width="80"
                    Content="Cancel" />
        </StackPanel>
    </StackPanel>
</UserControl> 
```

使用上面的代码，我可以设置单选按钮的值，关闭视图，然后重新打开它，同时保持单选按钮的值。希望有帮助！

# java - VisualVM - 查找对类的所有引用

> ID：14341485
> 
> 赞同：10
> 
> 时间：2013-01-15T15:51:40.933
> 
> 标签：java, memory-leaks, visualvm

我正在尝试调试应用程序中的 permgen 错误。我正在运行 VisualVM 来分析应用程序并获取内存快照的堆转储。

将快照加载到 VisualVM 中进行分析，我目前可以在类列表中看到几个类出现了多次，所有类都列出了 0 个实例，0 个大小 - 我只期望这些类中的一个（可能链接到它的类加载器） - 有吗有什么方法可以确定什么仍然持有对这些没有实例的类的引用？如果我可以加载转储（.hprof）来分析持有引用的内容，那么很高兴使用另一个工具。

谢谢！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2015-12-06T17:29:59.157

好吧，说“使用 MAT”并不能真正回答问题！

要在 VisualVM 中执行此操作，在 Sampler 或 Profiler 视图中有一个标记为“Heap Dump”的按钮（右上角）。单击此按钮，将打开堆分析器。在“类”选项卡下，显示了所有加载的类。在底部有一个搜索框，输入您感兴趣的类名，在过滤视图中双击有问题的类。

这将打开实例视图。右键单击左侧窗格中的实例，然后选择“显示最近的 GC 根”以查找引用该对象的内容。

巴尼

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T15:56:44.607

我用[MAT 来做](http://www.eclipse.org/mat/)这样的事情。效果很好，即使在大堆上也是如此。

# game-physics - 石灰碰撞检测

> ID：14341486
> 
> 赞同：0
> 
> 时间：2013-01-15T15:51:46.907
> 
> 标签：game-physics, limejs

我知道 LimeJS 包含用于碰撞检测的 Box2d。我正在寻找一些帮助来开始创建检测。这就是我所拥有的：

一个球从屏幕顶部落下。下面有三个可拖动的平台。本质上，我需要球击中一个平台，然后沿着顶部滚动，直到它到达边缘并掉下来。

这种检测对于我正在创建的游戏至关重要（顺便说一下，我是一名 Web 开发人员，不是游戏开发人员，但我知道 JavaScript，所以这是分配给我的），因为它也将决定得分（有一个目标在底部）。我觉得如果我能在探测和改变方向上得到帮助，我就能让其他一切都发生。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T03:51:22.870

我认为你没有必要被 box2d 压得喘不过气来。有一点学习曲线，听起来你不需要它，除非你想让你的球真实地从平台上反弹。

这是一个非常简单易读的碰撞检测功能的链接： [http ://www.gamedev.net/page/resources/_/technical/game-programming/collision-detection-r735](http://www.gamedev.net/page/resources/_/technical/game-programming/collision-detection-r735)

请注意，在该示例中，它认为 y 轴从屏幕顶部开始，向下方向为正。

基本上，您要做的是检查球在下落时是否接触到任何平台。您可以使用精灵的边界框。当它触及时，你需要做出某种反应。如果平台是平的，那么只需阻止球在 y 方向上移动。如果平台是倾斜的，那么您将需要进行一些三角操作来确定球的运动方向。

之后，您必须检查球是否触及目标。如果是这样，添加到分数，玩一些花里胡哨，让玩家重新开始。

# ios - 从给定索引开始枚举 NSArray 双向搜索（无环绕）

> ID：14341488
> 
> 赞同：8
> 
> 时间：2013-01-15T15:51:50.910
> 
> 标签：ios, arrays, nsarray, enumeration

例子。我有一个包含 15 个对象的数组。我想从给定的索引开始枚举。说从索引 5 开始，然后是上面的索引，下面的索引，上面的索引，下面的等等……我不希望它环绕，而是停止并继续朝着未知的方向前进。

所以我的例子中的索引顺序是。5, 6, 4, 7, 3, 8, 2, 9, 1, 10, 0, 11, 12, 13, 14

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T19:22:52.177

这是一个不需要创建子数组的更紧凑的实现：

```
@implementation NSArray (Extensions)

- (void)enumerateFromIndex:(NSUInteger)index goBothWaysUsingBlock:(void (^)(id obj, NSUInteger idx, BOOL *stop))block
{
    BOOL stop = NO;
    for (NSUInteger i = 0; i < self.count && !stop; i++) {
        if (index + i < self.count) {
            block([self objectAtIndex:index + i], index + i, &stop);
        }
        if (i != 0 && !stop && i <= index) {
            block([self objectAtIndex:index - i], index - i, &stop);
        }
    }
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T08:32:03.770

```
-(void)enumerateArray:(NSArray *)array inBothDirectionsFromIndex:(int)startIndex
{
    for (int i=0; i<array.count; i++)
    {
        int index = startIndex;
        int indexAfter = startIndex + round(i/2.f) + (i%2 ? 0 : 1);
        int indexBefore = startIndex - round(i/2.f);

        if ((i%2 && indexAfter < array.count) || indexBefore < 0)
        {
            index = indexAfter;
            if (indexBefore < 0)
                index -= indexBefore + 1;
        }
        else if ((i > 0 && indexBefore > -1) || indexAfter > array.count-1)
        {
            index = indexBefore;
            if (indexAfter > array.count-1)
                index -= indexAfter - array.count;;
        }

        id item = [array objectAtIndex:index];

        //Do what you want with the item here

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:51:50.910

它回答了这个问题，但并不是特别干燥，并且创建子数组使其效率低于应有的效率。

```
@implementation NSArray (Extensions)

- (void)enumerateFromIndex:(NSUInteger)index goBothWaysUsingBlock:(void (^)(id obj, NSUInteger idx, BOOL *stop))block
{
    NSArray *lastObjects = [self subarrayFromIndex:index];
    NSArray *firstObjects = [self subarrayToIndex:index];
    int currentIndex = 0;

    NSEnumerator *firstObjectsEnumerator = [firstObjects reverseObjectEnumerator];
    NSEnumerator *lastObjectsEnumerator = [lastObjects objectEnumerator];
    BOOL shouldStop = NO;
    NSUInteger numberOfIndexesEnumerated = 0;
    id obj = nil;

    while(numberOfIndexesEnumerated < self.count)
    {
        if (obj = [lastObjectsEnumerator nextObject])
        {
            NSInteger objIndex = [self indexOfObject:obj];
            block(obj, objIndex, &shouldStop);
            currentIndex++;
            numberOfIndexesEnumerated++;
        }
        if (shouldStop)
        {
            return;
        }

        if (obj = [firstObjectsEnumerator nextObject])
        {
            NSInteger objIndex = [self indexOfObject:obj];
            block(obj, objIndex, &shouldStop);
            currentIndex++;
            numberOfIndexesEnumerated++;
        }
        if (shouldStop)
        {
            return;
        }
    }
}

@end 
```

此答案归功于@jalmaas

# c# - C# 中的程序化 XML 差异/合并

> ID：14341490
> 
> 赞同：17
> 
> 时间：2013-01-15T15:51:55.113
> 
> 标签：c#, xml, merge, diff

目前，我正在管理一个具有多个 XML 配置文件的软件。当新版本的软件发布时，有时基本配置文件会发生变化，我们目前有软件在启动时调用[KDiff](http://kdiff3.sourceforge.net/)。如果它检测到更改，它会提示用户选择更改。

这种方法的问题是 KDiff 是一个行比较程序并且不知道 XML 的方式（如节点等）

理想情况下，我想以编程方式使用 C# 中的库（因为我们是一家 MS 商店），它可以区分两个 XML 文件：源 XML 和当前工作 XML。

然后使用一些简单的规则将两者合并在一起：

1.  如果当前工作 XML 具有源 XML 没有的节点，则将其删除。
2.  如果源 XML 具有当前工作 XML 没有的节点，则添加它。
3.  如果两者具有相同的节点并且值不同，则优先使用 Source XML 的值，除非 Source XML 的值设置为“UseExistingValue”。

例如，这里是“源”XML：

```
<Configuration>
  <Items>
     <Item Id="1" Position="true">
       <Location X="UseExistingValue" Y="UseExistingValue" Z="UseExistingValue" />

       <Something/>
       <SomethingElse/>
     </Item>
   </Items>
 </Configuration> 
```

这是“当前工作”的 XML：

```
<Configuration>
  <Items>
    <Item Id="1" Position="false">
      <Location X="123" Y="234" Z="345" />
      <Another/>
      <Something/>

    </Item>
  </Items>
</Configuration> 
```

合并后的版本如下所示：

```
<Configuration>
  <Items>
    <Item Id="1" Position="true">
      <Location X="123" Y="234" Z="345" />

      <Something/>
      <SomethingElse/>
    </Item>
  </Items>
</Configuration> 
```

我查看了[MS XML Diff and Patch Tool](http://msdn.microsoft.com/en-gb/library/aa302294.aspx)，它确实将文件合并在一起，但不允许我想要定义的编程规则。

[用于 Java 开发人员的 XMLUnit](http://xmlunit.sourceforge.net/)似乎很有希望，但它的 .NET 版本似乎不发达，这是不幸的。

有人对可编写脚本的 XML Diff/Merge 工具和/或 .NET 库（付费或免费）有任何建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-17T16:45:50.047

经过几天的折腾，我找到了一个我认为适合我的解决方案。也许它也适用于其他人。

[MS XML Diff and Patch 工具](http://msdn.microsoft.com/en-gb/library/aa302294.aspx)是一个可行的选择。当您将第一个文件与第二个文件进行比较时，它会创建一个 XML“DiffGram”，列出它在两个 XML 文件之间检测到的变化。

为了处理上面列出的所有 3 条规则，我在一个方向上对这两个文件进行了比较，然后使用 Linq-to-XML 打开了 DiffGram 文件并删除了所有“添加”和“删除”行。

```
XNamespace xd = "http://schemas.microsoft.com/xmltools/2002/xmldiff";
var doc = XDocument.Load(_diffGramFile);
doc.Root.DescendantsAndSelf(xd + "add").Remove();
doc.Root.DescendantsAndSelf(xd + "remove").Remove(); 
```

然后我针对第一个文件修补（合并）这个编辑的 diffgram 并创建了一个部分合并的临时文件。这需要注意规则 1 和 2。

接下来，我将部分合并的文件与使用的第一个文件进行了比较。然后打开新的 DiffGram 并删除对“UseExistingValue”的所有更改引用。

```
var newdoc = XDocument.Load(_diffGramFile);
newdoc.Root.DescendantsAndSelf(xd + "change")
      .Where(x => x.Value == "UseExistingValue").Remove(); 
```

并将这个编辑的 DiffGram 与处理规则 3 的部分合并文件合并。将其保存到 XML 然后生成根据上面定义的规则合并的最终 XML。

希望这可以帮助其他人。

提示：安装 XmlDiffPatch 库后，可以在 C:\Windows\assembly\GAC\XmlDiffPatch\1.0.8.28__b03f5f7f11d50a3a\XmlDiffPatch.dll 中找到 XmlDiffPatch DLL

# android - 线程在屏幕仍然锁定时开始，想要防止

> ID：14341492
> 
> 赞同：1
> 
> 时间：2013-01-15T15:51:58.827
> 
> 标签：android, multithreading, view

我有一个布局，`MainView`在`HorizontalLayout`. `MainView`启动 a反过来`ControllerThread`启动其他线程。我的目标是`ControllerThread`在屏幕被解锁并且`HorizontalLayout`用户绝对可见之前不启动。

（以下`ControllerThread`为`_ctrlr`）

我首先天真地把`_ctrlr.start()`'`MainView`的构造函数。然后我把它放在了`onFinishInflation()`，但这是在屏幕解锁之前调用的。我最后一次尝试是将它放入`onWindowVisibilityChanged()`并启动控制器，如果`visibility`设置为`VISIBLE`，但即使在屏幕解锁之前也会调用它。我假设这些函数在屏幕解锁之前被调用，因为它们`_ctrlr`被确认正在运行。

's 中是否有可用的方法`View`来检查屏幕是否被锁定/解锁？还是我必须使用`KeyguardManager`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:17:37.277

根据 blackbelt 的建议，我通过在其中创建一个公共类来将启动线程的调用移至控制器，该类`MainView`将在调用时启动控制器。在`MainActivity`我调用的 OnResume 中：

```
((MainView) findViewById(R.id.mainView)).startController(); 
```

`ControllerThread`解锁屏幕后，直到应用程序实际在模拟器中被拉起，才会启动。

# kineticjs - 如何将形状拖放到指定的类画布中

> ID：14341495
> 
> 赞同：1
> 
> 时间：2013-01-15T15:52:00.477
> 
> 标签：kineticjs

嗨，我正在使用 kineticjs，我想知道如何将形状拖放到指定的类画布中。因此，如果我有 5 个具有相同类别的画布，那么我可以将我的形状放入其中。如果它没有掉在其中一个画布上，它就会回到原来的位置！我现在唯一的代码是我创建的形状。

```
var stage = new Kinetic.Stage({
    container: 'container',
    width: 965,
    height: 200
  });

  var layer = new Kinetic.Layer();    
  var poly = new Kinetic.Rect({
    x: 75,
    y: 75,
    width: 100,
    height: 50,
    fill: '#00D2FF',
    stroke: 'white',
    strokeWidth: 4,
    draggable: true
  });

  // add the shape to the layer
  layer.add(poly);

  // add the layer to the stage
  stage.add(layer); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:24:40.043

kineticJS 有一个

```
 .moveTo();  // (  node.moveTo(container);  ) 
```

方法。例子：

```
 poly.moveTo(stage); 
```

或者如果您有多个画布，例如 stage1、stage2、stage3：

```
 poly.moveTo(stage1); poly.moveTo(stage2); poly.moveTo(stage3); 
```

您还需要创建一个侦听器，该侦听器返回给定鼠标坐标的容器。因此，当您执行“mousemove”或“touchmove”时，您可以确定您所在的“容器/阶段”。如果您在有效容器中，则将形状移动到它。

我个人认为创建一个阶段会更容易，并将其划分为多个部分，并使这些部分层具有固定大小，这样您就可以这样做：

```
 var coordinates = stage.getUserPosition(); 
```

并使用它来确定将对象放置在哪个层（层是容器的类型）

# sql-server - Sql Server 2008 但不是 2005 中的死锁：并发 SqlBulkCopy

> ID：14341504
> 
> 赞同：1
> 
> 时间：2013-01-15T15:52:29.057
> 
> 标签：sql-server, locking, deadlock, sqlbulkcopy, database-deadlocks

我正在将并发批量复制运行到已经包含数据的 sql 表中。表上有一些索引，但在这种情况下没有聚集索引，只是非聚集索引。该表未分区。

在 Sql Server 2005 平台上我没有问题，数据被快速完美地复制。当我在 Sql Server 2008 上运行相同的进程时，在这个特定的表上，我总是遇到“PID x 在锁定资源上死锁......重新运行事务。”

在我努力解决这个问题的过程中，我禁用了表索引上的页面锁定并禁用了锁升级，但无济于事。

任何建议都非常感谢。我对此进行了广泛的研究，但不禁觉得我错过了一些东西。死锁图除了在每个椭圆上放置许多椭圆外没有显示任何其他内容 - 事实上，它们看起来与我在网上看到的其他死锁图完全不同。

# transactions - NHibernate 和事务 - “事务未连接，或已断开连接”

> ID：14341509
> 
> 赞同：2
> 
> 时间：2013-01-15T15:52:44.070
> 
> 标签：transactions, fluent-nhibernate

`transaction.Rollback()`以下是我的代码的代表性片段，其中在语句中抛出了一个意外的（至少就我而言）异常。

异常是类型`NHibernate.TransactionException`，消息是*“事务未连接，或已断开连接”。*堆栈跟踪如下所示`NHibernate.Transaction.AdoTransaction.CheckNotZombied() at NHibernate.Transaction.AdoTransaction.Rollback()`：

```
IEmployeeService employeeService = new EmployeeService(session);
var people = ReadFromFile('c:\temp.csv');

for (var person in people)
{
    ITransaction transaction = session.BeginTransaction();
    try
    {
        employeeService.Update(person);

        employeeService.CheckForRecursion();

        transaction.Commit();
    }
    catch(Exception exp)
    {
        if (!transaction.WasRolledBack)
            transaction.Rollback();
    }
} 
```

CheckForRecursion 使用一些 SQL 来查找上次更新引入的任何递归，如果是这样我想撤消。当引入递归时，SQL 会冒出一个异常，这是正确的，我抓住它并尝试回滚。那是我遇到错误的时候。

我已将回滚包装在 try catch 中，因此整个事情可以继续进行，但我在 for 循环的每次后续迭代中都看到相同的异常。

想法？这个模式正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-05T20:26:24.493

当表上的触发器引发错误时，我收到此错误。我修复了触发器，交易错误消失了。

我在输出窗口中显示了 NHibernate 生成的 SQL，因此我采用了最后生成的 sql 语句并在查询工具中运行它。触发器引发了关于截断字符串值的错误。

这是一个带有触发器的表的示例，它将在 NHibernate 中导致这种错误。

```
CREATE TABLE myTable (
    id int IDENTITY(1,1) NOT NULL,
    ThisIsA10CharField varchar(10),
    CONSTRAINT myTable_pk PRIMARY KEY CLUSTERED (id));
GO

CREATE TRIGGER myTable_MakeError ON myTable AFTER INSERT AS 
BEGIN
    INSERT INTO myTable (ThisIsA10CharField) values ('this will raise a truncate error')
END
GO

INSERT INTO mytable (ThisIsA10CharField) values ('x') 
```

> 消息 8152，级别 16，状态 14，过程 myTable_MakeError，第 4 行字符串或二进制数据将被截断。该语句已终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:41:42.417

你为什么不直接处理交易？

```
using (ITransaction transaction = session.BeginTransaction())
{
    employeeService.Update(person);

    employeeService.CheckForRecursion();

    transaction.Commit();
} 
```

当发生异常时，您应该销毁会话。更改已在此人身上进行，但并未撤消。不能存储时，在内存中无效。

# perl - 如何确定大型文本文件中的一列或多列是否已排序

> ID：14341520
> 
> 赞同：1
> 
> 时间：2013-01-15T15:53:08.060
> 
> 标签：perl, bash, unix, cmd

我有超过 1GB 的大文本文件。该文件有 4 列，由 TAB 分隔。

```
Col1: Guid
Col2: Date-time (yy-mm-yyyy 0000000000)
Col3: String
Col4: String 
```

我想确定它的一列或多列是否已排序。

有什么快速的方法吗？也许使用 Perl 或一些 unix 命令？或者类似的东西？

我在大型服务器和本地 Windows 机器上有文件，因此内存或 cpu 速度或操作系统不是问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T16:06:06.727

只需使用`-c`选项`sort`来检查排序顺序并`-k`指定在哪一列：

```
$ sort -c -k2,2 file
sort: file:2: disorder: Col2: Date-time (yy-mm-yyyy 0000000000) 
```

或者`-C`抑制输出并测试退出代码。您可能还想根据数据指定排序类型，例如版本排序`-n`的数字排序等。`-v`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T16:09:10.653

许多版本`sort`都有一个选项来检查文件是否已排序。例如，使用我的笔记本电脑 (Debian) 上的版本，我可以这样做：

```
if sort -C -k 2,2 somefile
then
  # something
else
  # something else
fi 
```

检查文件的第二列是否已排序。的退出代码`sort`表示成功或失败。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T15:59:29.100

首先确定列然后使用awk

```
awk '{print $2}' OFS="\t" test.tmp > unsorted_file.dat 
```

对于第二列

```
awk '{print $2}' OFS="\t" test.tmp | sort > sorted_file.dat

diff sorted_file.dat unsorted_file.dat 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T16:18:49.280

只需将行拆分为列并将它们与上一行中的值进行比较。如果前一个值大于当前行中的值，则不对该列进行排序。

```
#! /usr/bin/perl

use strict;
use warnings;

my @sorted = (1, 1, 1, 1);
my $first = <>; # read the first line
my @prev = split(/\t/, $first);

while (<>) {
    my @cols = split(/\t/);
    for (my $i = 0; $i < 4; ++$i) {
        $sorted[$i] = 0 if ($prev[$i] gt $cols[$i]);
    }

    @prev = @cols;
}

for (my $i = 0; $i < 4; ++$i) {
    my $not = $sorted[$i] ? '' : 'not ';
    print "Column $i is $not sorted\n";
} 
```

测试文件.txt

```
a   a   a   a
b   b   b   b
c   c   c   c
d   d   d   d
e   e   e   a
f   d   f   f
g   g   g   g 
```

调用为

```
perl script.pl file.txt 
```

会给你

> 第 0 列已排序
> 第 1 列未排序
> 第 2 列已排序
> 第 3 列未排序

这在文本上进行比较并测试升序。如果您需要另一个顺序或不同的比较，则必须相应地调整内部 for 循环。

# matlab - 按某些列值过滤矩阵

> ID：14341523
> 
> 赞同：14
> 
> 时间：2013-01-15T15:53:19.983
> 
> 标签：matlab, matrix

考虑我有这个矩阵：

```
 02, 04, 06, 08, 10, 2
   07, 14, 21, 28, 35, 2
   11, 22, 33, 44, 55, 0
   15, 14, 21, 28, 35, 2 
```

我想拥有相同的矩阵，但只有行带有 last `column = 2`。所以我想要这个矩阵：

```
 02, 04, 06, 08, 10, 2
   07, 14, 21, 28, 35, 2
   15, 14, 21, 28, 35, 2 
```

我可以解析所有矩阵，但还有其他方法吗？

## 编辑

更准确地说，我有一个带有字符串的单元格数组：

```
 02, 04, Some String, 08, 10, 2
   07, 14, Some String1, 28, 35, 2
   11, 22, Some String1, 44, 55, 0
   15, 14, Some String, 28, 35, 2 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-15T15:57:42.870

只需对矩阵的行使用逻辑索引：

```
row_idx = (A(:, end) == 2); 
```

现在`row_idx`包含`1`s 和`0`s 的逻辑数组，其中`1`s 的行的最后一个元素等于 2。

现在过滤这些行：

```
A_filtered = A(row_idx, :); 
```

所有这些步骤通常在单行中执行：

```
A_filtered = A(A(:, end) == 2, :); 
```

# c++ - 应该如何阅读这种 C++ 语法？

> ID：14341524
> 
> 赞同：6
> 
> 时间：2013-01-15T15:53:21.240
> 
> 标签：c++, syntax

我可能是个彻头彻尾的白痴，但我刚刚看到了这种 C++ 语法，但我终其一生都无法弄清楚它在做什么：

```
(*x)(&a, b, c); 
```

快速回答将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-15T15:55:19.880

那么还有更多的可能性：这完全取决于所有实体的类型：`x`, `a`, `b`, `c`。在 C++ 中，您甚至可以重载逗号运算符。

但我只会专注于`x`，看看事情会如何发展。但是，如果考虑到所有组合，实际答案将太长。

```
(*x)(&a, b, c); 
```

这里`x`可以是其中之一：

*   函数指针
*   指向函数对象的指针。
*   取消引用时返回函数指针或函数对象的迭代器。
*   （底部还有一个，被前一个部分覆盖！）

然后你调用它传递三个参数给它。

以下是几个示例，假设所有其他实体 ( `a`, `b` `c`) 为`int`：

*   一个假设

    ```
     int a,b,c; //FIXED as per the assumption 
    ```

*   函数指针

    ```
     void f(int *,int, int);
     auto *x = f;
     (*x)(&a,b,c); //x is function pointer 
     x(&a,b,c);    //works fine, even without (*x) 
    ```

*   函数对象

    ```
    struct X { void operator()(int*,int,int); };

    X y, *x = &y;
    (*x)(&a,b,c);  //x is pointer to function object 
    ```

*   迭代器

    ```
    std::list<std::function<void(int*,int,int)> l {X(), f};
    auto x = l.begin();  //x is an iterator
    (*x)(&a,b,c);  //(*x) is function object
    ++x;
    (*x)(&a,b,c);  //(*x) is function object (still!)

    //OR
    std::list<void(int*,int,int)> l {f};
    auto x = l.begin();  //x is an iterator
    (*x)(&a,b,c);  //(*x) is function pointer! 
    ```

正如@David 在评论中所说：

> 但是，还有第四种可能性：x 可能是某个类的实例，它重载了 operator* 以返回函数指针或函数对象。

*这是真的，但我相信迭代器部分*涵盖了这种可能性，或者至少迭代器示例给了你足够的提示来自己弄清楚。:-)

希望有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T15:54:56.130

这似乎`x`是一个函数指针。如果确实如此，那么这意味着：

1.  取消引用`x`以获得函数类型的表达式；

2.  用参数调用那个函数`addressof a`，`b`和`c`。

另请注意，周围的`*`(dereference) 和`()`运算符`x`是多余的；你可以写

```
x(&a, b, c); 
```

if`x`也是一个函数指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T15:59:10.567

如果不知道符号的定义，就不可能 100% 确定，但我怀疑这是一个函数调用。（假设`x`是一个指向函数的指针；如果`x`有类类型，它将取决于`*`类中一元的重载。）`(*x)`取消引用指针也是如此，逻辑上是一个函数；鉴于此，其余的应该是显而易见的。（请注意，正式地，在大多数情况下，函数会衰减为指向函数的指针，并且您通过指向函数的指针进行调用。因此，就编译器而言， if`x`是指向函数的指针`(*x)`并且是相同的。不是这样`x`然而，人类读者会很高兴被告知该调用是间接的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-15T16:01:44.557

以下是使用`operator()`可以产生相同签名的示例。

```
#include <iostream>
using namespace std;

struct sample {
    void operator()(int* a, int b, int c) {
        *a = b = c;
        return;
    }
};

int main() {
    sample* x;
    int a = 1, b = 1, c = 1;
    (*x)(&a, b, c);
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T15:54:26.177

x 可能是指向函数的指针，或指向函数的指针。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-15T15:54:29.973

它通过函数指针调用函数。

使用提供的参数调用指针“x”指向的函数。

此参考可能有用：[C++ 函数指针教程](http://www.cprogramming.com/tutorial/function-pointers.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-15T15:55:04.147

这很可能是*函数指针指向*的函数的调用。更传统的语法如下：

```
x(&a, b, c); 
```

`x`指向一个接受三个参数的函数。调用表达式取消引用指针，并将三个参数传递给指针指向的函数。

另一种方法可能`x`是指向一个对象的指针，该对象定义了一个三参数运算符的覆盖`()`。要知道它是哪一个，您需要提供更多上下文。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-15T15:54:52.813

它看起来`x`要么是指向函数的指针，要么是指向函子的指针。 `&a, b, c`是调用的参数列表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-15T15:55:02.893

它将参数传递`&a, b, c`给指向的函数`*x`

# php - symfony2 选择的选项

> ID：14341531
> 
> 赞同：1
> 
> 时间：2013-01-15T15:53:43.957
> 
> 标签：php, symfony, doctrine

我正在让用户编辑。
我想通过 Users.role_id = UsersRole.id 查看当前用户的选定角色

表**用户**有四列（id、用户名、roleId、描述）**表用户角色**
有两列（id、名称）

 ****控制器：**

```
public function editAction($id) {
    $user = $this->getDoctrine()
            ->getEntityManager()
            ->getRepository('TruckingMainBundle:Users')
            ->find($id);

    if (!$user) {
        throw $this->createNotFoundException('Unable to find user id.');
    }
    $form = $this->createForm(new \Trucking\AdminBundle\Form\UserType(), $user);
    $request = $this->getRequest();

    //save data
    if ($request->getMethod() == 'POST') {
        $form->bindRequest($request);
        if ($form->isValid()) {
            $em = $this->getDoctrine()->getEntityManager();
            $em->persist($user);
            $em->flush();
            return $this->redirect($this->generateUrl('tracking_admin_users'));
        }
    }
    return $this->render('TruckingAdminBundle:user:edit.html.twig', array(
                'id' => $id,
                'form' => $form->createView()
                    )
    );
} 
```

**用户类型.php**

```
 public function buildForm(FormBuilderInterface  $builder, array $options) {

     $builder
        ->add('roleId', 'entity', array(
                'class' => 'TruckingMainBundle:UsersRole',
                'property' => 'name'
        ))
        ->...->..
    } 
```

我不知道如何在该列表中设置选定的（默认）值，我已经尝试了 5 个小时，但仍然没有结果

我使用了**preferred_choices**，**query_builder** -> 我可以通过 critreia 选择的地方（但是我不需要那个）
[http://symfony.com/doc/current/reference/forms/types/entity.html](http://symfony.com/doc/current/reference/forms/types/entity.html) ![在此处输入图像描述](../Images/f0776026ed864b69c553c20fb133e950.png)

我可以打印我当前的用户 ID -> **print_r($user->getRoleId())**；
这东西我已经有了。我的“用户”实体与 UserRole 实体

**用户实体有联系**

```
namespace Trucking\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Security\Core\User\UserInterface;
/**
 * Trucking\MainBundle\Entity\Users
 *
 * @ORM\Table(name="Users")
 * @ORM\Entity
 */
class Users implements UserInterface
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    protected $id;

    /**
     * @var string $password
     *
     * @ORM\Column(name="password", type="string", length=15)
     */
    private $password;

    /**
     * @var string $username
     *
     * @ORM\Column(name="username", type="string", length=30)
     */
    private $username;

    /**
     * @var string $description
     *
     * @ORM\Column(name="description", type="string", length=20)
     */
    private $description;

    /**
     * @var string $permissions
     *
     * @ORM\Column(name="permissions", type="string", length=300)
     */
    private $permissions;

    /**
     * @var \DateTime $date
     *
     * @ORM\Column(name="date", type="datetime")
     */
    private $date;

    /**
     * @var integer $role_id
     *
     * @ORM\Column(name="role_id", type="integer")
     */
    private $role_id;

    /**
     * @var integer $company_id
     *
     * @ORM\Column(name="company_id", type="integer")
     */    
    private $company_id;

    /**
     * @ORM\ManyToMany(targetEntity="Company", inversedBy="users")
     *
     */
    protected $companies;

    /**
     * @ORM\OneToOne(targetEntity="UsersRole")
     * @ORM\JoinColumn(name="role_id", referencedColumnName="id")
     */
    protected $roles;

    public function __construct() {
        $this->companies = new ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set password
     *
     * @param string $password
     * @return Users
     */
    public function setPassword($password)
    {
        $this->password = $password;

        return $this;
    }

    /**
     * Get password
     *
     * @return string 
     */
    public function getPassword()
    {
        return $this->password;
    }

    /**
     * Set username
     *
     * @param string $username
     * @return Users
     */
    public function setUsername($username)
    {
        $this->username = $username;

        return $this;
    }

    /**
     * Get username
     *
     * @return string 
     */
    public function getUsername()
    {
        return $this->username;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Users
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set permissions
     *
     * @param string $permissions
     * @return Users
     */
    public function setPermissions($permissions)
    {
        $this->permissions = $permissions;

        return $this;
    }

    /**
     * Get permissions
     *
     * @return string 
     */
    public function getPermissions()
    {
        return $this->permissions;
    }

    /**
     * Set date
     *
     * @param \DateTime $date
     * @return Users
     */
    public function setDate($date)
    {
        $this->date = $date;

        return $this;
    }

    /**
     * Get date
     *
     * @return \DateTime 
     */
    public function getDate()
    {
        return $this->date;
    }

    /**
     * Set role_id
     *
     * @param integer $role
     * @return Users
     */
    public function setRoleId($role_id)
    {
        $this->roleId = $role_id;

        return $this;
    }

    /**
     * Get role_id
     *
     * @return integer 
     */
    public function getRoleId()
    {
        return $this->role_id;
    }

    /**
     * Set company_id
     *
     * @param Company $company_id
     * @return Users
     */
    public function setCompany(Company $company_id)
    {
        $this->company = $company_id;

        return $this;
    }

    /**
     * Get company_id
     *
     * @return integer 
     */
    public function getCompanyId()
    {
        return $this->company_id;
    }

    public function equals(UserInterface $user) {
        return $this->getUsername() == $user->getUsername();
    }

    public function eraseCredentials() {

    }

    public function getRoles() {
        return (array)$this->roles->getName();
    }

    public function setRoles($role) {
        $this->roles = array($role);
    }

    public function getSalt() {

    }    
} 
```

**用户角色实体**

```
namespace Trucking\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * USERS_ROLE
 *
 * @ORM\Table(name="USERS_ROLE")
 * @ORM\Entity
 */
class UsersRole
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=30)
     */
    protected $name;

    /**
     * @var string
     *
     * @ORM\Column(name="description", type="string", length=200)
     */
    protected $description;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return USERS_ROLE
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return USERS_ROLE
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }
} 
```

**用户类型（用于表单）**

```
<?php
namespace Trucking\AdminBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\Validator\Constraints;

class UserType extends AbstractType {

    public function buildForm(FormBuilderInterface  $builder, array $options) {

     $builder
        ->add("username","text",array(
                   "label" => "Name",
                       'attr'   =>  array(
                           'class'   => 'input-xlarge',
                       ),
                    'constraints' => new Constraints\Length(array('min' => 3))
                   ))
        ->add('roleId', 'entity', array(
                'class' => 'TruckingMainBundle:UsersRole',
                "label" => "Roles",
                'property' => 'name'
        ))
        ->add("description","text",array(
           "label" => "Description",
               'attr'   =>  array(
                   'class'   => 'input-xlarge'
               ),
                'constraints' => new Constraints\NotBlank()
           ));
    }

    public function getName()
    {
        return 'trucing_adminbundle_usertype';
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T12:20:05.193

ORM JOINS 出现问题。id 到 role_id

我已将映射从一对一**双向** 更改为一对一、**单向**和连接表。

完整代码：
**Users.php**

```
<?php

namespace Trucking\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Security\Core\User\UserInterface;
/**
 * Trucking\MainBundle\Entity\Users
 *
 * @ORM\Table(name="Users")
 * @ORM\Entity
 */
class Users implements UserInterface
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    protected $id;

    /**
     * @var string $password
     *
     * @ORM\Column(name="password", type="string", length=15)
     */
    protected $password;

    /**
     * @var string $username
     *
     * @ORM\Column(name="username", type="string", length=30)
     */
    protected $username;

    /**
     * @var string $description
     *
     * @ORM\Column(name="description", type="string", length=20)
     */
    protected $description;

    /**
     * @var string $permissions
     *
     * @ORM\Column(name="permissions", type="string", length=300)
     */
    protected $permissions;

    /**
     * @var integer $company_id
     *
     * @ORM\Column(name="company_id", type="integer")
     */    
    protected $company_id;

    /**
     * @var integer $role_id
     *
     * @ORM\Column(name="role_id", type="integer")
     */    
    protected $role_id;

    /**
     * @ORM\OneToOne(targetEntity="Company")
     * @ORM\JoinColumn( name="company_id", referencedColumnName="id" )
     */
    protected $companies;

    /**
     * @ORM\OneToOne(targetEntity="UsersRole")
     * @ORM\JoinColumn( name="role_id", referencedColumnName="id" )
     */
    protected $listRoles;

    public function __construct() {

    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set password
     *
     * @param string $password
     * @return Users
     */
    public function setPassword($password)
    {
        $this->password = sha1($password);

        return $this;
    }

    /**
     * Get password
     *
     * @return string 
     */
    public function getPassword()
    {
        return $this->password;
    }

    /**
     * Set username
     *
     * @param string $username
     * @return Users
     */
    public function setUsername($username)
    {
        $this->username = $username;

        return $this;
    }

    /**
     * Get username
     *
     * @return string 
     */
    public function getUsername()
    {
        return $this->username;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Users
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set permissions
     *
     * @param string $permissions
     * @return Users
     */
    public function setPermissions($permissions)
    {
        $this->permissions = $permissions;

        return $this;
    }

    /**
     * Get permissions
     *
     * @return string 
     */
    public function getPermissions()
    {
        return $this->permissions;
    }

    /**
     * Set company_id
     *
     * @param Company $company_id
     * @return Users
     */
    public function setCompanyId($company_id)
    {
        $this->company_id = $company_id;

        return $this;
    }

    /**
     * Get company_id
     *
     * @return integer 
     */
    public function getCompanyId()
    {
        return $this->company_id;
    }

    public function equals(UserInterface $user) {
        return $this->getUsername() == $user->getUsername();
    }

    public function eraseCredentials() {

    }

    /**
     * Get roles
     *
     * @return String 
     */
    public function getRoles() {
        $roles = $this->getListRoles();
        return (array)$roles->getName();
    }

    /**
     * Get roles
     *
     * @return \UsersRole 
     */
    public function getListRoles()
    {
        return $this->listRoles;
    }

    /**
     * Set roles
     *
     * @param \UsersRole
     * @return Users
     */
    public function setListRoles($roles)
    {
        $this->listRoles = $roles;
        return $this;
    }

    /**
     * Set role_id
     *
     * @param integer
     * @return Users
     */
    public function setRoleID($roleId) {
        $this->role_id = $roleId;
        return $this;
    }

    public function getSalt() {

    }

    /**
     * Get company
     *
     * @return Company
     */
    public function getCompanies()
    {
        return $this->companies;
    }

    /**
     * Set company
     *
     * @param Company $company
     * @return Users
     */
    public function setCompanies($company)
    {
        $this->companies = $company;
        return $this;
    }
} 
```

**用户角色.php**

```
<?php

namespace Trucking\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * USERS_ROLE
 *
 * @ORM\Table(name="USERS_ROLE")
 * @ORM\Entity
 */
class UsersRole
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=30)
     */
    protected $name;

    /**
     * @var string
     *
     * @ORM\Column(name="description", type="string", length=200)
     */
    protected $description;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return USERS_ROLE
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return USERS_ROLE
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }
} 
```

**控制器**未更改

```
public function editAction($id) {
    $user = $this->getDoctrine()
            ->getEntityManager()
            ->getRepository('TruckingMainBundle:Users')
            ->find($id);

    if (!$user) {
        throw $this->createNotFoundException('Unable to find user id.');
    }
    $form = $this->createForm(new \Trucking\AdminBundle\Form\UserType(), $user);
    $request = $this->getRequest();

    //save data
    if ($request->getMethod() == 'POST') {
        $form->bindRequest($request);
        if ($form->isValid()) {
            $em = $this->getDoctrine()->getEntityManager();
            $em->persist($user);
            $em->flush();
            return $this->redirect($this->generateUrl('tracking_admin_users'));
        }
    }
    return $this->render('TruckingAdminBundle:user:edit.html.twig', array(
                'id' => $id,
                'form' => $form->createView()
                    )
    );
} 
```

**用户类型.php**

```
<?php
namespace Trucking\AdminBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\Validator\Constraints;

class UserType extends AbstractType {

    public function buildForm(FormBuilderInterface  $builder, array $options) {

     $builder
        ->add("username","text",array(
                   "label" => "Name",
                       'attr'   =>  array(
                           'class'   => 'input-xlarge',
                       ),
                    'constraints' => new Constraints\Length(array('min' => 3))
                   ))
        ->add("password","password",array(
                   "label" => "Password",
                       'attr'   =>  array(
                           'class'   => 'input-xlarge',
                       ),
                    'constraints' => new Constraints\Length(array('min' => 3))
                   ))
        ->add("listRoles","entity",array(
            'label' => 'Roles',
            'class'    => 'TruckingMainBundle:UsersRole' ,
            'property' => 'name'
        ))
        ->add("companies","entity",array(
            'label' => 'Companies',
            'class'    => 'TruckingMainBundle:Company' ,
            'property' => 'name'
        ))
        ->add("description","text",array(
           "label" => "Description",
               'attr'   =>  array(
                   'class'   => 'input-xlarge'
               ),
                'constraints' => new Constraints\NotBlank()
           ));
    }

    public function getName()
    {
        return 'trucking_adminbundle_usertype';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:36:03.690

在呈现表单之前设置实体上的属性：

```
if (!$user) {
    throw $this->createNotFoundException('Unable to find user id.');
}

//THIS IS NEW
$theRole = getRoleEntityFromSomewhereItMakesSense();
$user->setRole($theRole); //Pass the role object, not the role's ID

$form = $this->createForm(new \Trucking\AdminBundle\Form\UserType(), $user);
$request = $this->getRequest(); 
```

当您生成表单时，它会自动填充您正在使用的实体的属性。

**编辑** 更改

```
->add('roleId', 'entity', array( 
```

至

```
->add('roles', 'entity', array( 
```

我不明白为什么你同时拥有**roleId**和**角色**。

还要更改以下内容，因为**角色**是单个元素，而不是数组（你有一个一对一的关系，并且应该是一对多的并且反转为多对一，但我想它会也可以工作）

```
public function getRoles() {
    return $this->roles;
}

public function setRoles($role) {
    $this->roles = $role;
} 
```**

# vb.net - VB.NET - 流读取器/写入器替代方案？

> ID：14341532
> 
> 赞同：0
> 
> 时间：2013-01-15T15:53:44.150
> 
> 标签：vb.net, save

我正在开发**客户关系管理**软件 (CRM)，并使用**列表**来存储从 excel (CSV) 文件中读取的所有信息。我想在我的自定义 CRM中**编辑一些信息，并且很好奇是否有更好的方法来保存信息，而不是仅将其全部写入文本文件并在下次启动时再次读取它们？**

提前致谢

# sockets - 避免在 socket.io 中的页面刷新时断开连接

> ID：14341534
> 
> 赞同：3
> 
> 时间：2013-01-15T15:53:55.657
> 
> 标签：sockets, socket.io

我目前正在开发一个聊天模块。我不希望客户端在页面刷新时断开连接，但在刷新时它会断开客户端并建立新连接。还有客户端消息的数据丢失。

那么如何避免这种断开连接以及如何在刷新时保留聊天消息？

# shell - 用 find、cat 和 if 编写一个 shell 脚本

> ID：14341535
> 
> 赞同：0
> 
> 时间：2013-01-15T15:53:58.307
> 
> 标签：shell, if-statement, grep, cat

我正在做一个 scipt 来搜索一个有年龄的日志文件，并比较谁在日志中有一串文本，如果继续制作一个函数是正确的，但没有受到影响。我感谢任何建议或帮助

```
#!/bin/bash
file= find /AUX/backup/log/ -iname "*.log" -daystart -type f -mtime 1
if cat $file | grep -qw “INF - Status = completed."  
then
  echo "there is OK" 
else
  echo "there is KO" 
fi 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:58:54.233

```
#!/bin/bash
file=`find /AUX/backup/log/ -iname "*.log" -daystart -type f -mtime 1`
if grep -qw “INF - Status = completed."  < $file
then
  echo "there is OK" 
else
  echo "there is KO" 
fi 
```

# three.js - 无法使用 three.js 将矩阵应用于加载的模型

> ID：14341537
> 
> 赞同：0
> 
> 时间：2013-01-15T15:54:02.950
> 
> 标签：three.js, webgl

我想使用 three.js 加载一个模型，然后在它上面应用一个转换矩阵。这是我正在使用的代码：

```
var loader = new THREE.OBJMTLLoader();
loader.addEventListener('load', function (event)
{
    var object = event.content;
    object.matrixAutoUpdate = false;
    object.applyMatrix(object_accumulated_matrix);
    scene.add(object);
},
{
    useWorker: true
});

// should check if ".mtl" file exists but there is no access to the filesystem
loader.load(dir_file_name + ".obj", dir_file_name + ".mtl"); 
```

这些是 object_accumulated_matrix 变量的内容：

```
({elements:{0:1, 1:0, 2:0, 3:0, 4:0, 5:1, 6:0, 7:322, 8:0, 9:0, 10:1, 11:0, 12:0, 13:0, 14:0, 15:1}}) 
```

Y 轴上有一个 322 的平移值，但我似乎无法让它工作。我也试过：

```
object.matrix.copy(object_accumulated_matrix); 
```

但这也不起作用。

我将不胜感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:49:47.153

你`object_accumulated_matrix`的换位了。

你也可以试试

```
object.geometry.applyMatrix( object_accumulated_matrix ); 
```

这将修改几何本身。

# python - 将一组 NumPy 数组传递给 C 函数用于输入和输出

> ID：14341549
> 
> 赞同：13
> 
> 时间：2013-01-15T15:54:39.260
> 
> 标签：python, c, numpy, ctypes, ffi

假设我们有一个 C 函数，它接受一组一个或多个输入数组，处理它们，并将其输出写入一组输出数组。签名如下（`count`表示要处理的数组元素的数量）：

```
void compute (int count, float** input, float** output) 
```

我想通过 ctypes 从 Python 调用此函数，并使用它将转换应用于一组 NumPy 数组。对于定义为的单输入/单输出函数

```
void compute (int count, float* input, float* output) 
```

以下作品：

```
import ctypes
import numpy

from numpy.ctypeslib import ndpointer

lib = ctypes.cdll.LoadLibrary('./block.so')
fun = lib.compute
fun.restype = None
fun.argtypes = [ctypes.c_int,
                ndpointer(ctypes.c_float),
                ndpointer(ctypes.c_float)]

data = numpy.ones(1000).astype(numpy.float32)
output = numpy.zeros(1000).astype(numpy.float32)
fun(1000, data, output) 
```

但是，我不知道如何为*多个*输入（和/或输出）创建相应的指针数组。有任何想法吗？

**编辑**：所以人们一直想知道如何`compute`知道预期有多少数组指针（`count`指每个数组的元素数）。事实上，这是硬编码的；一个给定的`compute`准确地知道有多少输入和输出。调用者的工作是验证这一点`input`并`output`指出正确数量的输入和输出。这是一个`compute`采用 2 个输入并写入 1 个输出数组的示例：

```
virtual void compute (int count, float** input, float** output) {
    float* input0 = input[0];
    float* input1 = input[1];
    float* output0 = output[0];
    for (int i=0; i<count; i++) {
        float fTemp0 = (float)input1[i];
        fRec0[0] = ((0.09090909090909091f * fTemp0) + (0.9090909090909091f * fRec0[1]));
        float fTemp1 = (float)input0[i];
        fRec1[0] = ((0.09090909090909091f * fTemp1) + (0.9090909090909091f * fRec1[1]));
        output0[i] = (float)((fTemp0 * fRec1[0]) - (fTemp1 * fRec0[0]));
        // post processing
        fRec1[1] = fRec1[0];
        fRec0[1] = fRec0[0];
    }
} 
```

我无法影响`compute`. 我可以验证（来自 Python！）需要多少输入和输出。关键问题是如何`argtypes`为函数提供正确的，以及如何在 NumPy 中生成适当的数据结构（指向 NumPy 数组的指针数组）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T10:23:35.460

要专门使用 Numpy 数组执行此操作，您可以使用：

```
import numpy as np
import ctypes

count = 5
size = 1000

#create some arrays
arrays = [np.arange(size,dtype="float32") for ii in range(count)] 

#get ctypes handles
ctypes_arrays = [np.ctypeslib.as_ctypes(array) for array in arrays]

#Pack into pointer array
pointer_ar = (ctypes.POINTER(C.c_float) * count)(*ctypes_arrays)

ctypes.CDLL("./libfoo.so").foo(ctypes.c_int(count), pointer_ar, ctypes.c_int(size)) 
```

事物的 C 面可能如下所示：

```
# function to multiply all arrays by 2
void foo(int count, float** array, int size)
{
   int ii,jj;
   for (ii=0;ii<count;ii++){
      for (jj=0;jj<size;jj++)
         array[ii][jj] *= 2;    
   }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T19:37:13.960

在 C 中，`float**`指向指针表/数组中的第一个元素`float*`。

大概这些中的每一个都`float*`指向`float`值表/数组中的第一个元素。

您的函数声明有 1 个计数，但不清楚此计数适用于什么：

```
void compute (int count, float** input, float** output) 
```

*   二维矩阵`count`x`count`的大小？
*   `count``float*`每个以某种方式终止的大小数组，例如`nan`?
*   `float*`每个元素的空终止数组`count`（合理的假设）？

请澄清你的问题，我会澄清我的答案:-)

假设最后一个 API 解释，这是我的示例计算函数：

```
/* null-terminated array of float*, each points to count-sized array
*/
extern void compute(int count, float** in, float** out)
{
    while (*in)
    {
        for (int i=0; i<count; i++)
        {
            (*out)[i] = (*in)[i]*42;
        }
        in++; out++;
    }
} 
```

示例计算函数的测试代码：

```
#include <stdio.h>
extern void compute(int count, float** in, float** out);

int main(int argc, char** argv)
{
#define COUNT 3
    float ina[COUNT] = { 1.5, 0.5, 3.0 };
    float inb[COUNT] = { 0.1, -0.2, -10.0 };
    float outa[COUNT];
    float outb[COUNT];
    float* in[] = {ina, inb, (float*)0};
    float* out[] = {outa, outb, (float*)0};

    compute(COUNT, in, out);

    for (int row=0; row<2; row++)
        for (int c=0; c<COUNT; c++)
            printf("%d %d %f %f\n", row, c, in[row][c], out[row][c]);
    return 0;
} 
```

以及如何通过 Python 中的 ctypes 使用相同的`count`== 10`float`个子数组和大小`2` `float*`数组，包含 1 个实子数组和 NULL 终止符：

```
import ctypes

innertype = ctypes.ARRAY(ctypes.c_float, 10)
outertype = ctypes.ARRAY(ctypes.POINTER(ctypes.c_float), 2)

in1 = innertype(*range(10))
in_ = outertype(in1, None)
out1 = innertype(*range(10))
out = outertype(out1, None)

ctypes.CDLL("./compute.so").compute(10, in_, out)

for i in range(10): print in_[0][i], out[0][i] 
```

此处介绍了 ctypes 的 Numpy 接口[http://www.scipy.org/Cookbook/Ctypes#head-4ee0c35d45f89ef959a7d77b94c1c973101a562f](http://www.scipy.org/Cookbook/Ctypes#head-4ee0c35d45f89ef959a7d77b94c1c973101a562f)， arr.ctypes.shape[:] arr.ctypes.strides[:] 和 arr.ctypes.data 就是你需要; 您也许可以将其直接提供给您的`compute`.

这是一个例子：

```
In [55]: a = numpy.array([[0.0]*10]*2, dtype=numpy.float32)

In [56]: ctypes.cast(a.ctypes.data, ctypes.POINTER(ctypes.c_float))[0]
Out[56]: 0.0

In [57]: ctypes.cast(a.ctypes.data, ctypes.POINTER(ctypes.c_float))[0] = 1234

In [58]: a
Out[58]: 
array([[ 1234.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.],
       [    0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.]], dtype=float32) 
```

# symfony - Symfony2：使用 Twig 的自动 htmlentities

> ID：14341552
> 
> 赞同：12
> 
> 时间：2013-01-15T15:54:48.250
> 
> 标签：symfony, twig, html-entities

我正在使用 Twig 显示在我的数据库中检索到的一些变量：

```
<p>{{ my_variable }}</p> 
```

问题是这个变量可能包含html标签，比如“ `<br />`”。

Twig 在显示变量时似乎会自动调用一些类似 htmlentities 的函数。

有什么方法可以禁用它，以便当我显示包含“ `Hello<br />world !`”的变量时，我得到：

```
Hello 
world ! 
```

而不是 ：

```
Hello<br />world ! 
```

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-15T15:57:41.827

用于`{{ my_variable|raw }}`防止`my_variable`被自动转义。

请参阅 Twig 文档：[http ://twig.sensiolabs.org/doc/filters/raw.html](http://twig.sensiolabs.org/doc/filters/raw.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T07:43:33.497

尝试使用这个

```
{% autoescape false %}{{ my_variable}}{% endautoescape %} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:09:30.080

更好的是：`{{ '<br />|raw('html') }}`避免逃避其他明智的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-23T21:35:24.677

If you just want to use linebreaks in the text stored in your database but don't care to use html , you can also use the nl2br filter as in `{{ var|nl2br }}`. Allows you to use string linebreak character `\n` in your text. Filter converts it to `<br/>`

# direct3d - 如何在每帧（在 D3D10 中）更新像素着色器中的 Texture2D？

> ID：14341558
> 
> 赞同：1
> 
> 时间：2013-01-15T15:54:56.457
> 
> 标签：direct3d, pixel-shader, d3dx

使用 D3D10，我正在绘制一个 2d 矩形，并希望用应该每秒更改几次的纹理（位图）填充它（例如显示视频）。

我正在使用带有 Texture2D 变量的着色器效果，并尝试更新 ID3D10EffectShaderResourceVariable 并重绘网格。

我的实际用法是从内存中复制位图，并使用 UpdateSubresource。但它不起作用，所以我将其缩小以测试两个 DDS 图像之间的切换。结果是它按预期绘制了第一张图像，但继续绘制它而不是在两个图像之间切换。

我是 D3D 的新手。您能否解释一下这种方法是否可行，或者建议正确的方法。

着色器效果：

```
Texture2D txDiffuse;
SamplerState samLinear
{
    Filter = MIN_MAG_MIP_LINEAR;
    AddressU = Wrap;
    AddressV = Wrap;
};
struct VS_INPUT
{
    float4 Pos : POSITION;
    float2 Tex : TEXCOORD;
};
struct PS_INPUT
{
    float4 Pos : SV_POSITION;
    float2 Tex : TEXCOORD0;
};
PS_INPUT VS( VS_INPUT input )
{
    PS_INPUT output = (PS_INPUT)0;
    output.Pos = input.Pos;
    output.Tex = input.Tex;    
    return output;
}
float4 PS( PS_INPUT input) : SV_Target
{
    return txDiffuse.Sample( samLinear, input.Tex );
}
technique10 Render
{
    pass P0
    {
        SetVertexShader( CompileShader( vs_4_0, VS() ) );
        SetGeometryShader( NULL );
        SetPixelShader( CompileShader( ps_4_0, PS() ) );
    }
} 
```

代码（跳过了很多部分）：

```
ID3D10ShaderResourceView*           g_pTextureRV = NULL;
ID3D10EffectShaderResourceVariable* g_pDiffuseVariable = NULL;

D3DX10CreateEffectFromResource(gInstance, MAKEINTRESOURCE(IDR_RCDATA1), NULL, NULL, NULL, "fx_4_0", dwShaderFlags, 0, device, NULL, NULL, &g_pEffect, NULL, NULL);

g_pTechnique = g_pEffect->GetTechniqueByName( "Render" );
g_pDiffuseVariable = g_pEffect->GetVariableByName( "txDiffuse" )->AsShaderResource();

// this part is called on Frame render:

device->CreateRenderTargetView( backBuffer, NULL, &rtView);
device->ClearRenderTargetView( rtView, ClearColor );

if(g_pTextureRV != NULL) {
    g_pTextureRV->Release();
    g_pTextureRV = NULL;
}

D3DX10CreateShaderResourceViewFromFile(device, pCurrentDDSFilePath, NULL, NULL, &g_pTextureRV, NULL );
g_pDiffuseVariable->SetResource( g_pTextureRV );

D3D10_TECHNIQUE_DESC techDesc;
g_pTechnique->GetDesc( &techDesc );
for( UINT p = 0; p < techDesc.Passes; ++p )
{
    g_pTechnique->GetPassByIndex( p )->Apply( 0 );
    direct2dDrawingContext->dev->Draw( 6, 0 );
}

// ... present the current back buffer 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T08:01:05.660

下面是一种解决方案，不一定是最好的，但不使用自定义着色器（我用 C# / Managed DirectX 编写，但它应该很容易转码。）

```
Bitmap bmp; //the bitmap that you will use to update the texture
Texture tex; //the texture that DirectX will render

void Render()
{
  //render some stuff

  bmp = GetNextTextureFrame(); //whatever you do to update your bitmap
  Surface s = tex.GetSurfaceLevel(0);
  Graphics g = s.GetGraphics();
  //IntPtr hdc = g.GetHdc();
  //BitBlt(hdc, 0, 0, bmp.Width, bmp.Height, bmpHdc, 0, 0, 0xcc0020);
  g.DrawImageUnscaled(bmp, 0, 0);
  g.ReleaseHdc(hdc);
  s.ReleaseGraphics();
  device.SetTexture(0, tex);
  //now render your primitives

  //render some more stuff
  //present
} 
```

注释掉的行是我实际使用的方式，使用 hBitmap 和 DC 和 BitBlt，因为它比 GDI+ 快。很多人可能会告诉您，上述方法是一种不好的方法，因为必须发生所有内存锁定，而且他们可能是对的。但是我能够使用多个 1920x1080 纹理实现 30fps，因此无论它是否正确，它都可以工作。

# html - 侧边栏不会坐右 - 移动到右下角

> ID：14341571
> 
> 赞同：0
> 
> 时间：2013-01-15T15:55:39.400
> 
> 标签：html

只是做了一些编码，一切都很好，现在突然间，当我改变与侧边栏无关的东西时，侧边栏决定移动，我似乎无法找出原因。

代码很长，所以我将发布一个指向该页面的链接：

[这里](http://www.thisdigicore.com/htmlcheck)

有人可以帮我解释为什么它突然移动到一个奇怪的位置吗？可能是因为我在页面上放了一个程序并且没有很好地格式化它，非常感谢任何帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:59:56.603

浮动侧边栏 div 必须位于 HTML 代码中的内容 div**之前。**

# c# - 使用连接字符串

> ID：14341578
> 
> 赞同：0
> 
> 时间：2013-01-15T15:55:59.897
> 
> 标签：c#, web-config

我下面的代码示例工作正常，但我想将我的客户端凭据添加到 web.config 文件中（即，在连接字符串中）。

我试过但没有运气。有人可以帮忙吗？

```
 protected void Page_Load(object sender, EventArgs e)
    {    

        // Organisation service URL
        var organizationUri = new Uri(ConfigurationManager.ConnectionStrings["CrmConnectionStr"].ConnectionString);

        //Client credentials
        var credentials = new ClientCredentials();
        credentials.UserName.UserName = @"domain\username";  
        credentials.UserName.Password = "password";

        // Use the Microsoft Dynamics CRM Online connection string from the web.config file named "CrmConnectionStr".
                    using (OrganizationServiceProxy _service = new OrganizationServiceProxy(organizationUri, null, credentials, null))
        {
     Response.Write("Connected");
        }
    } 
```

**Web.config 文件**

```
<?xml version="1.0"?>
<configuration>
<connectionStrings>
  <add name="CrmConnectionStr"  connectionString="https://test.domain.com/XRMServices/2011/Organization.svc" />     
 </connectionStrings>
 <system.web>
    <compilation debug="true" targetFramework="4.0" />
 </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:58:01.547

正如 RandomWebGuy 指出的那样，您可能正在连接到 Microsoft Dynamics CRM，在这种情况下，您只需更改连接字符串以包含用户名等，就像这样`connectionString="https://test.domain.com/XRMServices/2011/Organization.svc; Username=Fred.Bloggs; Password=P@ssword;"`

但是，如果您连接到 Web 服务或想要存储任意值（例如 URI、用户名、密码等），请使用**AppSettings**部分，而不是**ConnectionString**。

所以，在你的配置文件中是这样的：

```
<appSettings>  
    <add key="UserName" value="Fred.Bloggs" />
    <add key="Password" value="P@ssword" />
    <add key="ServiceUri" value="https://test.domain.com/XRMServices/2011/Organization.svc />
</appSettings> 
```

然后在代码中：

```
var organizationUri = new Uri(ConfigurationManager.AppSettings["ServiceUri"]);

// ...

credentials.UserName.UserName = ConfigurationManager.AppSettings["UserName"];
credentials.UserName.Password = ConfigurationManager.AppSettings["Password"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:20:35.237

编写自定义配置来存储您的特定数据（并且不要试图捎带现有的连接字符串区域，它具有精确的格式）。

这是一个示例： [如何在 ConfigurationSection 中包含简单集合](https://stackoverflow.com/questions/2699047/how-to-include-simple-collections-in-configurationsection/3366402#3366402)

这比有几个脱节的 AppSetting(s) 值要好得多。与您的价值观密切相关的所有内容都封装在一个已知区域中。

# c# - API和DLL之间提到的区别是否正确？

> ID：14341579
> 
> 赞同：-2
> 
> 时间：2013-01-15T15:56:02.293
> 
> 标签：c#, asp.net

假设我有一个项目包含以下

1.  表示层
2.  数据访问层（抽象）DLL
3.  业务逻辑层 DLL
4.  Sql Server层DLL

所有这些 DLL 都是项目的一部分。如果我准备一个 Web 服务或 WCF 项目并将其部署在其他一些 Web 服务器中，并通过将上述 dll 保留在这个新服务器中来从表示层访问该服务。会变成 API 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:58:38.987

谁知道？

[API](http://en.wikipedia.org/wiki/Application_programming_interface)可以采用多种形式。基本上，它是一种界面，系统的一部分与另一部分对话。这个接口可以在一个 DLL 中*实现*，也可以不在一个 DLL 中实现，或者部分在一个 DLL 中，或者在几个 DLL 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:12:48.417

任何程序集或类的任何公共方法都是 API。我想，我知道你的意思，即使你的问题没有正确形成。我认为，您的意思是，您希望将您的 DLL 移动到服务层并与服务而不是直接与 DLL 进行演示对话。好消息是，这相当容易。例如，如果您使用经典的 XML Web 服务，您可以创建 Web 服务项目，在该项目中您可以将 API 包装到 Web 方法中，并且在您的演示文稿中将需要 [最好] 编写适配器以从 Dll API 或 Web 服务中提取数据，具体取决于您连接到的。当然，您可以将对 Dll 的调用替换为对 Web 方法的调用——这非常简单。使用 WCF，您将需要定义服务合同，并且客户端（表示层）会有更多变化。但是需要添加一些安全层。你现在上网了，记得吗？

# apache - 拒绝访问成员目录

> ID：14341581
> 
> 赞同：0
> 
> 时间：2013-01-15T15:56:04.583
> 
> 标签：apache, security, .htaccess

有没有办法阻止人们访问存储我所有成员文件的目录。

例如，我有 mysite.com/members/$mem_id，其中存储了特定的成员文件，例如图像。有没有办法阻止所有这些直接从 URL 栏访问，而不用在每个文件夹中放置 index.php，可能使用 .htaccess？

此外，一旦文件夹被阻止，站点本身仍然需要访问其中的文件才能在站点周围显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:02:43.310

要禁用目录列表，您可以使用 .htaccess 并添加此行

`Options -Indexes`

# python - 使用 MultiIndex 导出 Pandas DataFrame

> ID：14341584
> 
> 赞同：1
> 
> 时间：2013-01-15T15:56:14.793
> 
> 标签：python, pandas

我刚刚发现了 pandas，它的功能给我留下了深刻的印象。我很难理解如何使用 MultiIndex 使用 DataFrame。

我有两个问题：

**(1) 导出DataFrame**

这是我的问题：这个数据集

```
import pandas as pd
import StringIO
d1 = StringIO.StringIO(
     """Gender,Employed,Region,Degree
     m,yes,east,ba
     m,yes,north,ba
     f,yes,south,ba
     f,no,east,ba
     f,no,east,bsc
     m,no,north,bsc
     m,yes,south,ma
     f,yes,west,phd
     m,no,west,phd
     m,yes,west,phd """
   )

df = pd.read_csv(d1)

# Frequencies tables
tab1 = pd.crosstab(df.Gender, df.Region)
tab2 = pd.crosstab(df.Gender, [df.Region, df.Degree])
tab3 = pd.crosstab([df.Gender, df.Employed], [df.Region, df.Degree])

# Now we export the datasets 
tab1.to_excel('H:/test_tab1.xlsx')  # OK 
tab2.to_excel('H:/test_tab2.xlsx') # fails 
tab3.to_excel('H:/test_tab3.xlsx') # fails 
```

我能想到的一种解决方法是更改​​列（R 的方式）

```
def NewColums(DFwithMultiIndex):
       NewCol = []
       for item in DFwithMultiIndex.columns:
               NewCol.append('-'.join(item))
       return NewCol 

# New Columns 
tab2.columns = NewColums(tab2)
tab3.columns = NewColums(tab3)

# New export  
tab2.to_excel('H:/test_tab2.xlsx')  # OK
tab3.to_excel('H:/test_tab3.xlsx')  # OK 
```

*我的问题是：在我在文档中遗漏的 Pandas 中是否有更有效的方法来执行此操作？*

**2) 选择列**

这种新结构不允许在给定变量上选择列（首先是分层索引的优势）。如何选择包含给定字符串的列（例如'-ba'）？

PS：我看到[了这个](https://stackoverflow.com/questions/11041411/)相关的问题，但没有理解提出的回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:29:30.967

这看起来像 中的一个错误`to_excel`，目前我建议使用它作为一种解决方法`to_csv`（这似乎没有显示这个问题）。

*我将此作为[问题添加到 github 上](https://github.com/pydata/pandas/issues/2701)。*

要回答第二个问题，如果您*确实*需要使用`to_excel`...

您可以使用[`filter`](http://docs.python.org/2/library/functions.html#filter)仅选择那些包含以下内容的列`'-ba'`：

```
In [21]: filter(lambda x: '-ba' in x, tab2.columns)
Out[21]: ['east-ba', 'north-ba', 'south-ba']

In [22]: tab2[filter(lambda x: '-ba' in x, tab2.columns)]
Out[22]: 
        east-ba  north-ba  south-ba
Gender                             
     f        1         0         1
     m        1         1         0 
```

# php - 将 JavaScript 代码转换为 PHP

> ID：14341585
> 
> 赞同：-2
> 
> 时间：2013-01-15T15:56:18.243
> 
> 标签：php, javascript

我需要帮助将此代码转换为 PHP。

```
var formula = [10,6.7,3.4];  
var user1 = [1,0,2,1,1,0,2,2,2,2];  
var user2 = [2,1,2,0,1,2,2,2,0,0];  
var result = 0;  
calculate();  
function calculate(){  
    for(var i=0; i<user1.length; i++){  
        result +=formula[Math.abs(user1[i]-user2[i])]  
    }
}  
alert(result); 
```

PHP代码：

```
<?php     
$formula = array(10,6.7,3.4);  
$user1 = array(1,0,2,1,1,0,2,2,2,2);  
$user2 = array(2,1,2,0,1,2,2,2,0,0);  
$result = 0;  
function calculate(){  
    for($i=0, $size = count($user1); $i<$size; $i++){  
        $result += $formula(abs($user1[$i]-$user2[$i]));  
    }
}
calculate();  
echo $result;  
?> 
```

PHP 代码不起作用。请帮帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T15:57:43.510

变量`$user1, $user2, $formula`不在范围内 - 将它们传递给函数：

```
function calculate( $user1, $user2, $formula) {  
    $result = 0;
    for( $i = 0, $size = count($user1); $i<$size; $i++){  
        $result += $formula[ abs( $user1[$i]-$user2[$i]) ]; 
    }
    return $result;
}  
$result = calculate( $user1, $user2, $formula);  
echo $result; 
```

另外，您缺少`$formula`数组上的索引，我在上面添加了它。

```
 $result += $formula[ abs( $user1[$i]-$user2[$i]) ]; 
```

最后，我添加`return $result;`了返回计算值的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:59:52.253

您必须传递变量并返回结果。

```
$formula = array(10,6.7,3.4);  
$user1 = array(1,0,2,1,1,0,2,2,2,2);  
$user2 = array(2,1,2,0,1,2,2,2,0,0);  

function calculate($user1, $user2, $formula){  
    for($i=0, $size = count($user1); $i<$size; $i++){  
        $result += $formula[abs($user1[$i]-$user2[$i])];  
    }
    return $result;
}  
$result = calculate($user1, $user2, $formula);  
echo $result; 
```

# objective-c - iOS：如何访问 viewController 的方法

> ID：14341586
> 
> 赞同：0
> 
> 时间：2013-01-15T15:56:25.907
> 
> 标签：objective-c, cocoa-touch

我有麻烦。这个 viewController 里面有 viewConnroller 和一个对象。该对象尝试通过 NSURLConnection 获取信息，稍后它必须通知 viewController 运行方法。如果我尝试在里面创建 viewController 的对象，我会发现问题：新的 viewController 做的事情和第一个做的一样，所以新的 viewController 做 NSURLConnection，创建第三个 viewController 等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:06:52.467

将 viewController 的引用传递给您在该 viewController 中创建的对象怎么样？

所以类似于：

```
Object *obj = [[Object alloc]init];
obj.viewController = self; 
```

显然，您必须创建一个属性来保存对象类上的 viewController。

然后，当您需要调用 viewController 上的方法时，您可以使用：

```
[self.viewController performSelector:@selector(methodName:)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:11:03.703

您可以传递对此对象的引用。但首先创建具有分配属性的新属性。

```
//property in your class
@property(nonatomic, assign) id myViewController;

//set reference to your UIViewController
[myClassInstance setMyViewController: self]; //self is MyViewController instance

//call UIViewController's method from your class
MyViewController *controller = (MyViewController *)self.myViewController;
[controller myMethodInUIViewController]; 
```

# android - 链接本地重命名的所有引用（不更改其他文件中的引用）

> ID：14341587
> 
> 赞同：4
> 
> 时间：2013-01-15T15:56:29.433
> 
> 标签：android

第一次使用显示指标时出现错误`"Link all references for a local rename (does not change references in other files)"`，因此所有具有 id 的显示 id 的行都没有得到解决。我在这里放置代码。帮助我。

```
 public void onConfigurationChanged(Configuration newConfig) {
            super.onConfigurationChanged(newConfig);
            try{
                emailForConfigChanges = emailTextBox.getText().toString().trim();
                passwordForConfigChanges = passwordTextBox.getText().toString().trim();

                DisplayMetrics displayMetrics = new DisplayMetrics();
                getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
                switch(displayMetrics.densityDpi){ 
                    case DisplayMetrics.DENSITY_LOW:
                        setContentView(R.layout.login_small);
*showing error in the above line "Link all references for a local rename (does not change references   in other files)"*

                        break; 
                    default:
                        setContentView(R.layout.login);
                }
            } catch(Exception e){
                e.printStackTrace();
            }

            getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
            ImageButton loginButton = (ImageButton) findViewById(R.id.loginButton);
            loginButton.setOnClickListener(this);
            ImageButton registerOrangeButton = (ImageButton) findViewById(R.id.registerOrangeButton);
            registerOrangeButton.setOnClickListener(this);
            TextView forgotPasswordText = (TextView) findViewById(R.id.forgotPasswordText);
            forgotPasswordText.setOnClickListener(this);

            passwordTextBox = (EditText) findViewById(R.id.passwordLogin);
            passwordTextBox.setText(passwordForConfigChanges);
            passwordTextBox.setOnKeyListener(this);
            emailTextBox = (EditText) findViewById(R.id.emailLogin);
            emailTextBox.setText(emailForConfigChanges);
            emailTextBox.setOnKeyListener(this); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-24T08:44:31.843

请检查导入部分

如果这一行 --> "import android.R;" 存在你应该删除

![在此处输入图像描述](../Images/71c507e9435450bb715fcee7526a9981.png)

# php - 以变 量的形式将文本框值附加到链接而不使用提交按钮

> ID：14341591
> 
> 赞同：1
> 
> 时间：2013-01-15T15:56:35.153
> 
> 标签：php, html, forms, hyperlink, textbox

我想知道如何将 HTML 表单的文本框值附加到链接。例如，我有 3 个链接，每个链接都指向不同的 PHP 文件，但是，我需要传递一个变量。由于我的页面设计，我不能使用按钮。所以，我创建了一个带有文本字段的表单。如何使用链接发送该文本字段值？

例如：

```
<form>
<input type="text" name="test1" id="test1"></input></form>

<a href=index.php?id=$test1">Link 1</a>
<a href=index2.php?id=$test1">Link 2</a>
<a href=index3.php?id=$test1">Link 3</a> 
```

我希望这对我正在尝试做的事情有意义。

编辑：

我试图动态地做到这一点，但是：

好的，我做了一个这样的函数：

```
 <script> 
function awardcode()
{ var awamount = document.getElementById("awardamount"); 
document.write('<?php $awardvar = ' + awamount.value + '; ?>');  
}; 
</script> 
```

然后，我通过 PHP 创建了如下所示的链接：

```
echo '<a id=awlink3 name=awlink3 href="index.php?siteid=gmaward&type=xp&post=' . $posts_row['posts_id'] . '&handle=' . $posts_row['handle'] . '&varamount=' . $awardvar . '">Award XP</a>'; 
```

然而，这并没有奏效。这是我的输入框代码：

```
<form><input type=text name='awardamount' id='awardamount' onchange='awardcode()' style:'width:10px;'></form> 
```

当我输入数字然后制表符时，它会加载一个空页面。

我该如何调整？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:01:56.710

您需要使用 JavaScript 动态更改链接。这是一种方法：

```
$('a').on('click',function(e) {
  e.preventDefault();
  var url = $(this).attr('href').split('$')[0];
  window.location = url + $('#test1').val();
}); 
```

但最好将`onchange`事件添加到文本框本身，以便 HREF 立即更改并且用户可以在鼠标悬停时看到预期的目的地：

```
$('#test1').on('change', function () {
  var val = $(this).val();
  $('a[href*=\\?id\\=]').each(function (i, el) {
    $(el).attr('href', function (j, str) {
      return str.split('?')[0] + "?id=" + val;
    });
  });
}); 
```

# c# - 从多个窗口进程中获取未读邮件时的并发问题

> ID：14341594
> 
> 赞同：0
> 
> 时间：2013-01-15T15:56:38.397
> 
> 标签：c#, windows, service

我想通过多个 Windows 服务从交换服务器获取电子邮件；每个 Windows 服务在不同的服务器上。我倾向于使用第三方工具来获取电子邮件。

我担心并发问题；即：两个服务同时获取同一封电子邮件。我不想使用一个控制器进程来控制哪个进程收到哪封电子邮件。

我正在考虑一种锁定机制，类似于数据库锁，每个进程都可以在进程中锁定电子邮件，然后标记它，一旦完成。或者

将立即标记电子邮件的“获取”方法。在任何其他进程到达之前，在微秒甚至更短的时间内。或者

想到的任何其他想法。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:24:15.947

您可能必须使用 DB 来锁定某些表。让您的服务用 ToDo 填充表格，然后将它们标记为已完成。您的服务将需要指向一个他们将获得工作 Todo 的地方，因此这将成为您的并发解决方案。可能是，一项服务只是填充 TODO 和其他服务来处理它们。可能是 MSMQ 可以提供帮助。一项服务堆积队列，其他服务取消库存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:36:35.117

这是您可能想要查看的 [.NET POP3 MIME 客户端](http://www.codeproject.com/Articles/21377/NET-POP3-MIME-Client)

您可能还想在代码中尝试这样的事情作为示例

```
 Outlook.Application outlook = new Outlook.ApplicationClass();
    Outlook.NameSpace ns = outlook.GetNamespace("Mapi");
    object _missing = Type.Missing;
    ns.Logon(_missing, _missing, false, true);
    Outlook.MAPIFolder inbox = ns.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderInbox);

    int unread = inbox.UnReadItemCount;
    foreach (Outlook.MailItem mail in inbox.Items)
    {
        string s = mail.Subject;
    } 
```

# css - 将浮动 div 锚定到页面上的众多元素

> ID：14341597
> 
> 赞同：0
> 
> 时间：2013-01-15T15:56:46.817
> 
> 标签：css

将 div 放置在页面上从左下角锚定 div 的多个位置的最佳方法是什么。它应该能够将其附加到页面上的任何元素，使用该元素作为相对定位。它的工具提示。每个工具提示将具有相同的宽度，但取决于工具提示中的文本，这将决定高度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:58:34.623

您将使用绝对定位，它相对的父元素将相对定位

当使用绝对定位来获取相对父级之外的元素时，对左和上使用负值

```
<div class="parent">
   <div class="tooltip"></div>
</div>

.parent{ position: relative;  /*set whatever else */}
.tooltip {position: relative; bottom: -20px; left: -20px; height 20px; width:20px;} 
```

只是位于父级底部和左侧的 20px X 20px 工具提示的示例

# haskell - HaLVM 和线程

> ID：14341598
> 
> 赞同：10
> 
> 时间：2013-01-15T15:56:46.960
> 
> 标签：haskell, unikernel, halvm

我不太明白 HaLVM 或类似技术在（OS）线程方面的作用。

我知道，当使用 -thread 选项编译代码时，Haskell 多线程 RTS 将使用 OS 线程重新分配现有的 Haskell 线程，从而避免外部调用的阻塞行为。现在，当您使用 HaLVM 时，您可能不必进行任何外部调用。但是，我想知道这一切是如何混合的，以及 HaLVM 运行了多少工作线程。是否没有其他情况下缺少操作系统工作线程可能导致阻塞或其他不良行为？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T16:09:30.570

HaLVM 使用单线程 GHC 运行时。

在多核 Xen 的支持下移植 HaLVM 以使用线程运行时将[是一个有趣的项目。](https://github.com/GaloisInc/HaLVM/issues/5)

# javascript - Javascript Split() 与显式数组声明的工作方式不同

> ID：14341599
> 
> 赞同：0
> 
> 时间：2013-01-15T15:56:48.927
> 
> 标签：javascript, jquery, arrays, split

谁能建议我做错了什么：

我希望将我的`#videoslist`DIV 中的 YouTube 视频 ID 列表拆分为一个数组，并填充我找到的一个简单视频轮播使用的数组。

当在脚本中显式声明视频 ID 数组时，它可以正常工作，但是如果我采用 DIV 的`.text()`or`.html()` `(jQuery)`并将其拆分为一个数组，即使该数组填充得很好，这意味着某处似乎存在问题它不起作用，但我无法弄清楚......

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T15:59:09.413

这是因为分号后面有空格。您可以删除 DIV 中分号后的空格，也可以在将字符串添加到 YouTube 代码之前修剪字符串。

# ios - 适用于 ipad 和 iphone 的 MainWindow.xib

> ID：14341605
> 
> 赞同：0
> 
> 时间：2013-01-15T15:57:06.150
> 
> 标签：ios, xib

我正在尝试[构建这个](http://brandontreb.com/image-manipulation-retrieving-and-updating-pixel-values-for-a-uiimage/)包含 MainWindow.xib 和 ImageManipViewController.xib 的演示。但是我的应用程序在 AppDelegate.m 中包含以下代码，并且我的应用程序不（还没有？）包含 MainWindow.xib。添加2个MainWindow.xib文件（一个用于iPhone，一个用于iPad）对我来说更好/最好（在我的方法中调用，每个都调用自己的xib文件）还是MainWindow.xibs只是额外的？

（顺便说一句，如果答案是 MainWindow.xibs 是多余的，那你能说为什么它可能会在原始演示中使用吗？这可能只是作者简化创建演示的步骤的结果，例如？）我还没有找到直接联系作者的方法。

如果有更好的方法来开发“通用”应用程序，请告诉我。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[BSViewController alloc] initWithNibName:@"BSViewController_iPhone" bundle:nil];
    } else {
        self.viewController = [[BSViewController alloc] initWithNibName:@"BSViewController_iPad" bundle:nil];
    }
    self.window.rootViewController = self.viewController; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:39:14.043

您可以通过编程方式或使用 Xib 文件构建主窗口及其附加的子视图（甚至视图控制器）。结果是一样的，但小型演示项目通常使用 Xib 文件，以简化代码并专注于他们想要向您展示的部分。

两个 Xib，一个用于 iPad，一个用于 iPhone 非常好，因为鼓励 iPad 应用程序使用可充分利用 iPad 大屏幕的视图；因此，建议将它们作为单独的文件保存。不过，您的型号和控制器应该是 iPad 和 iPhone 通用的。

关于加载 Xib，如果您的项目针对 iOS 4.0 或更高版本，您可以将 xib 文件命名为“BSViewController~iphone.xib”和“BSViewController~ipad.xib”，并避免代码中的一些条件：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.viewController = [[BSViewController alloc] initWithNibName:@"BSViewController" bundle:nil];
    self.window.rootViewController = self.viewController;
} 
```

# qml - 从 QML 中的函数调用？

> ID：14341606
> 
> 赞同：4
> 
> 时间：2013-01-15T15:57:07.570
> 
> 标签：qml, blackberry-10, blackberry-cascades

我可以使用页面中的 InvokeActionItem 轻松共享项目，但我需要能够在列表视图项目中调用它。我已经成功触发了一个调用，但我不知道在触发它时如何添加数据。我不断收到一条错误消息

InvocationPrivate::setQuery: 你不能改变 InvokeQuery 对象

注意：我试图在纯 QML 中执行此操作，如有必要，我将通过 c++ 执行此操作，但 QML 会更好。

在 Page 对象内工作的代码：

```
actions: [
    InvokeActionItem {
        ActionBar.placement: ActionBarPlacement.OnBar
        title: "Share"   
        query {
            mimeType: "text/plain"
            invokeActionId: "bb.action.SHARE"
        }

        onTriggered: {
            //myTextProperty is a string variable property for the page.
            data = myTextProperty;                
        }
    }
] 
```

我尝试在其他项目中使用的代码如下，但不起作用：

```
Container {
gestureHandlers: [
    TapHandler {
    LongPressHandler {
        onLongPressed: {
            console.log("Longpress");                

            invokeQuery.setData("test");

            invokeShare.trigger("bb.action.SHARE");
        }            
    }        

]

attachedObjects: [
    Invocation {
       id: invokeShare
       query: InvokeQuery {
           id:invokeQuery
           mimeType: "text/plain"         
       }   
    }
]
} 
```

有没有办法纯粹使用 QML 更改调用的数据，还是我需要只通过 c++ 运行它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T16:08:30.253

在浏览了相当多的论坛并测试了各种方法后，我终于找到了一种可行的方法。

在您的附加对象中添加以下内容：

```
attachedObjects: [      
    Invocation {
       id: invokeShare
       query: InvokeQuery {
           id:invokeQuery
           mimeType: "text/plain"                        
       }
       onArmed: {
           if (invokeQuery.data != "") {
               trigger("bb.action.SHARE");
           }
       }             
    }
] 
```

然后在需要调用调用的任何地方执行以下操作：

```
invokeQuery.mimeType = "text/plain"
invokeQuery.data = "mytext";
invokeQuery.updateQuery(); 
```

请注意，如果您不检查 onArmed 中的数据，它将自动调用创建时的调用 - 在列表视图的情况下，这可能会导致 20 多个屏幕要求您在 bbm 上共享...；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-21T16:23:31.990

对于删除“InvocationPrivate::setQuery: you are not allowed to change InvokeQuery object”消息我使用这个：

```
attachedObjects: [      
    Invocation {
        id: invoke
        query {
            mimeType: "text/plain"
            invokeTargetId: "sys.bbm.sharehandler"
            onDataChanged: {
                console.log("change data")
            }                   
        }
        onArmed: {
            if (invoke.query.data != "") {
                invoke.trigger("bb.action.SHARE");
            }
        } 
    }
]

function shareBBM(){
    invoke.query.setData("TEXT TO SHARE");
    invoke.query.updateQuery();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T02:42:04.747

您实际上可以使用 InvokeActionItem，您只需调用 updateQuery 来重新触发 invokeQuery。当 ListItemData 更改时，绑定将导致值更新。

```
InvokeActionItem {
      enabled: recordItem.ListItem.data.videoId != undefined

      id: invokeAction
      query{ 
            uri: "http://www.youtube.com/watch?v=" + recordItem.ListItem.data.videoId
            onQueryChanged: {
                  updateQuery()
            }
      }

} 
```

# powershell - FileVersion 输出为空

> ID：14341610
> 
> 赞同：0
> 
> 时间：2013-01-15T15:57:23.253
> 
> 标签：powershell, powershell-2.0

知道为什么我在下面一无所获吗？该文件在我查询的服务器上，如果我在本地执行它，它可以很好地获取文件版本。

```
$computer = Get-Content -Path c:\temp\servers1.txt

foreach ($server in $computer){

$path = Get-WmiObject Win32_Service -Filter "Name = 'SysMgmtHp'" -ComputerName $server | select pathname

(Get-Command $path).FileVersionInfo.FileVersion

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:15:08.013

尝试：

```
(Get-Command $path.pathname).FileVersionInfo.FileVersion 
```

当您使用`| select pathname`它时，本质上是创建一个具有`pathname`属性的新对象。您可以通过将输出`Get-Member`提供给您的类型信息和类型成员列表来查看这一点，例如：

```
PS> Get-WmiObject Win32_Service -Filter "Name = 'Spooler'" | Get-Member

   TypeName: System.Management.ManagementObject#root\cimv2\Win32_Service

Name                    MemberType    Definition
----                    ----------    ----------
PSComputerName          AliasProperty PSComputerName = __SERVER
... 
```

相对

```
PS> Get-WmiObject Win32_Service -Filter "Name = 'Spooler'" | select pathname| Get-Member

   TypeName: Selected.System.Management.ManagementObject

Name        MemberType   Definition
----        ----------   ----------
Equals      Method       bool Equals(System.Object obj)
GetHashCode Method       int GetHashCode()
GetType     Method       type GetType()
ToString    Method       string ToString()
pathname    NoteProperty System.String pathname=C:\Windows\System32\spoolsv.exe 
```

综上所述，您正在获取远程计算机上的服务路径，然后检查本地计算机上的版本。如果您可以在服务器上启用远程处理，您可以这样做：

```
Invoke-Command $server { $path = (Get-WmiObject Win32_Service -Filter "Name = 'SysMgmtHp'").PathName; (Get-Command $path).FileVersionInfo.FileVersion } 
```

这将获得远程计算机上服务二进制文件的文件版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:16:02.443

`$path.pathname`您可以发布名为“SysMgmtHp”的服务的输出吗？一些服务在 .pathname 属性中有附加参数或用引号括起来，您可能需要修剪这些参数/引号。另外，发布`Get-ChildItem $path.pathname | select *`结果。

# jquery - 加载第一张 JQuery 幻灯片，显示页面，然后在后台加载其他幻灯片

> ID：14341612
> 
> 赞同：1
> 
> 时间：2013-01-15T15:57:36.620
> 
> 标签：jquery, jquery-slider

是否可以加载第一张 JQuery 幻灯片，显示页面，然后在后台加载其他幻灯片？

我有一张 jquery 幻灯片，它显示了 4 个不同来源的 xml 提要。

每张幻灯片都有自己的 xml 提要。

问题是 xml 提要加载速度很慢。

我认为在加载页面其余部分的同时加载一个 xml 提要并在后台加载其他幻灯片（提要）是一个好主意。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:14:53.813

通过创建一个 cronjob 并每天将数据加载到 sql 数据库中来解决它

谢谢你的回复

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:12:22.387

当然可以，只需[读取 XML](http://api.jquery.com/jQuery.get/)并将其本地存储在变量中即可。您可以在页面加载时使用 ajax 调用开始加载它，并在此 ajax 调用结束时再次调用以阅读下一张幻灯片，依此类推。

保留一个数组来标记哪些feeds已经被读取，并且在显示幻灯片时，首先检查数组，看当前幻灯片索引是否已经被读取，否则[等到](http://www.w3schools.com/jsref/met_win_settimeout.asp)xml读取完成，从一个变量中读取内容而不是直接的 xml 读取调用。

如果您需要帮助编码，请上传您当前的代码。如果您需要更多帮助，请告诉我。

# c++ - 同步套接字发送（）

> ID：14341613
> 
> 赞同：2
> 
> 时间：2013-01-15T15:57:36.463
> 
> 标签：c++, sockets, networking, winsock, packet

好吧，基本上我有 3 个线程。

他们每个人都使用一个函数，该函数在内部使用特定套接字上的 send() （我们称之为 S）。这是一个小设计：

![http://i.imgur.com/5N744.png](../Images/99fc1f5c5fd4c5f65286e010c8d99a3b.png)

我将如何以这种方式同步 S 套接字，以便在队列中一个接一个地调用 send() 而不是同时访问套接字的线程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:03:48.320

首先，为什么没有要发送的实际数据*队列*，以及一个专门的 IO 线程从中弹出项目并写入套接字？

然后，如果您使用常规阻塞套接字语义，您可以同时从所有三个线程写入同一个套接字 - 内核将在系统调用级别提供所需的锁定。

# java - 摆动刷新周期

> ID：14341618
> 
> 赞同：5
> 
> 时间：2013-01-15T15:57:46.233
> 
> 标签：java, swing, refresh, repaint

我试图了解何时使用 revalidate/repaint/pack。

令人惊讶的是，我没有找到非常详细的幕后文档（请随意链接）。

到目前为止，我已经明白这是 RepaintManager 的全部责任。

*   油漆/重漆是指看起来很脏/干净的东西
*   pack/validate/revalidate 指的是什么是有效的

[这篇关于 Oracle](http://www.oracle.com/technetwork/java/painting-140037.html#swing)的文章解释说，调用重绘会在 Event Dispatcher 线程上将一个作业排入队列，该线程又会在组件上调用 paintImmediately()（这会重绘组件）。

[该轨迹](http://docs.oracle.com/javase/tutorial/uiswing/layout/howLayoutWorks.html)表明有效与否与 LayoutManager 相关联。这完全是关于组件的大小而不是内容。

1.  当您移动/调整组件大小并在更改其内容时重新绘制时，您是否应该调用 revalidate？
2.  pack() 方法真的是你不应该调用的不推荐使用的东西吗？
3.  上述任何主张有错吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:05:32.700

以下是您需要调用这些方法的一些基本情况（我介绍了基础知识，但我可能错过了一些需要调用这些方法的其他情况）。

1.  您应该`revalidate()`在以下情况下调用容器：添加一个或多个组件，删除一个或多个组件，更改一个或多个包含组件的约束（约束或 XXXSize()，尽管不建议使用后者），`LayoutManager`更改容器。
2.  您应该`repaint()`在想要重新绘制该组件（及其后代）时调用。最终，这将调用`paintComponent()`（对于基本小部件，这将委托给 XXXUI.paint()），`paintBorder()`并且`paintChildren()`（至少在 Swing 中）
3.  `pack()`实际上将窗口的大小设置为其首选大小。您通常应该在使窗口可见之前调用它。您可以稍后调用它，但这会给用户带来奇怪的体验（我不知道有多少应用程序会在显示后调整其窗口大小）

使用`revalidate()`and的主要优点`repaint()`是它们可以自行合并。这意味着如果您多次调用`repaint()`，绘画将只执行一次。

# c# - 不同的 IEqualityComparer<> 问题

> ID：14341619
> 
> 赞同：2
> 
> 时间：2013-01-15T15:57:48.943
> 
> 标签：c#, linq

大家好，我不知道为什么它不工作需要一些帮助。我有一个包含链接和一些数据的列表，我想按链接主机在此处区分列表代码

```
 public class DataContainerEqualityComparer : IEqualityComparer<DataContainer>
        {
            public bool Equals(DataContainer x, DataContainer y)
            {
                return x.Url.Host == y.Url.Host;
            }

            public int GetHashCode(DataContainer obj)
            {
                return obj.Url.GetHashCode();
            }
        }

List<DataContainer> items = new List<DataContainer>();
var item = new DataContainer("http://google.com/123");
items.Add(item);
item = new DataContainer("http://google.com/1234");
items.Add(item);
item = new DataContainer("http://google.com/12345");
items.Add(item);
item = new DataContainer("http://google.com/123456");
items.Add(item);
item = new DataContainer("http://google.com/1234567");
items.Add(item);                
items = items.Distinct(new DataContainerEqualityComparer()).ToList(); 
```

在此之后没有任何反应。提前谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-15T16:01:37.263

您实现的问题`DataContainerEqualityComparer`是您返回的是 URL 的哈希码，而不是主机的哈希码。

将其更改为此，它应该按预期工作：

```
public int GetHashCode(DataContainer obj)
{
    return obj.Url.Host.GetHashCode();
} 
```

在检查两个对象是否相等时，会发生以下情况：

首先，`GetHashCode`在两个对象上调用。如果哈希码不同，则对象被认为不相等并且`Equals`永远*不会被调用*。
`Equals`仅在`GetHashCode`为两个对象返回相同值时调用。

# c# - 更改现有集合 (OptionMetadataCollection) 的对象类型和现有类型的映射

> ID：14341620
> 
> 赞同：1
> 
> 时间：2013-01-15T15:57:52.327
> 
> 标签：c#, .net, dynamics-crm-2011

最终解决方案：

```
public class CustomOptionMetadata : OptionMetadata
{
    public CustomOptionMetadata(OptionMetadata optionMetadata) : base() 
    {
        this.Description = optionMetadata.Description;
        this.ExtensionData = optionMetadata.ExtensionData;
        this.Managed = optionMetadata.IsManaged;
        this.Label = optionMetadata.Label;
        this.MetadataId = optionMetadata.MetadataId;
        this.Value = optionMetadata.Value;
    }

    public string MappedName { get; set; }
    public bool? Managed { get; set; }
} 
```

.

```
foreach (MappingEntity meAtt in mappingEntityList.FindAll(me => me.ParentID == meEnt.ID))
{
    CRMOrganizationEntityAttribute crmOrganizationEntityAttribute = new CRMOrganizationEntityAttribute(meAtt.ID, meAtt.Name, true);
    if (meAtt.IsPicklist)
    {
        List<OptionMetadata> optionMetadataList = GetAttributePickList(meEnt.Name, meAtt.Name);
        if (optionMetadataList.Count > 0)
        {
            crmOrganizationEntityAttribute.OptionMetadataColl = optionMetadataList.Select<OptionMetadata, CustomOptionMetadata>(metadata => new CustomOptionMetadata(metadata)).ToList();
        }
        else
        {

        }
    }

    CRMOrgEnt.CRMAttributeNameList.Add(crmOrganizationEntityAttribute);
} 
```

==================================================== ===========================

我目前正在开发一个地图应用程序，它已经有很多自定义对象。为了限制类的查找和定义，我考虑过扩展我需要的现有类。

它`OptionMetaDataCollection`是 Microsoft.Xrm.SDK.Metadata 库的一部分，并且`OptionMetaData`在其 Ilist 中有对象。

现在我想创建这样的东西：

```
public partial class CustomOptionMetadataCollection : OptionMetadataCollection
{
    public CustomOptionMetadataCollection() : base() { }
}

public partial class CustomOptionMetadata : OptionMetadata
{
    public CustomOptionMetadata() : base() { }

    public string MappedName { get; set; }
} 
```

但是我将如何将`Ilist<OptionMetaData>`当前位于`OptionMetadatacollection`我的`IList<CustomOptionMetaData>`. 我知道我可以制作自己的 Ilist `CustomOptionMetaDataCollection`，但是我会（在我的其余代码上考虑）列出使用具有更高级集合类的类似东西。

我还想知道如何将`OptionMetaDataCollection`对象映射到我的`CustomOptionMetadataCollection`. 我可以创建一个循环，但我正在寻找一种更有效的映射方式。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:01:51.803

如果您想将 a 转换`IList<OptionMetadata>`为 a `IList<CustomOptionMetadata>`，您实际上是在问；如何将我的基类 ( `OptionMetadata`) 转换为派生类 ( `CustomOptionMetadata`)？

让我们`IList`暂时把这个等式排除在外——毕竟它只是持有该类的多个副本。

在最简单的级别上，您基本上想要做：

```
OptionMetadata optionMetadata = new OptionMetadata();
CustomOptionMetadata customOptionMetadata = (CustomOptionMetadata)optionMetadata; 
```

不幸的是，这种类型的向下转换并不是 C# 真正做的事情。

正如 Adam Wright 在[A way of cast a base type to a derived type 中](https://stackoverflow.com/questions/124336/a-way-of-casting-a-base-type-to-a-derived-type)所描述的那样。

> 这是令人沮丧的，并且没有理智的方法来处理它，. . . （子类提供的不仅仅是基类——这个“更多”来自哪里？）

也就是说，还有其他方法可以处理这个问题，例如向您的自定义类添加一个构造函数，该类采用基类。

```
class OptionMetadata
{
    public int X;
}

class CustomOptionMetadata : OptionMetadata
{
    public int Y;

    public CustomOptionMetadata(OptionMetadata metadata)
    {
        this.Y = metadata.X * 2;
    }
} 
```

然后最简单的变成：

```
OptionMetadata optionMetadata = new OptionMetadata();
CustomOptionMetadata customOptionMetadata = new CustomOptionMetadata(optionMetadata); 
```

并将其置于`IList`上下文中。

```
IList<OptionMetadata> optionMetadata = new List<OptionMetadata>() 
{            
    new OptionMetadata(),
    new OptionMetadata()
};

IList<CustomOptionMetadata> customOptionMetadata = optionMetadata
    .Select<OptionMetadata, CustomOptionMetadata>(metadata => new CustomOptionMetadata(metadata)).ToList(); 
```

我不太确定您将一个集合“映射”到另一个集合是什么意思，但这听起来有点像您试图将基类向下转换为派生类的问题。从您的问题中不清楚您要实现什么（派生类实际上在做什么？）。如果您只想将一个集合的内容复制到另一个集合，我建议您查看[如何在没有 foreach 的情况下将项目从列表复制到列表？](https://stackoverflow.com/questions/1952185/how-do-i-copy-items-from-list-to-list-without-foreach).

# java - Java 小程序：自定义加载动画要疯了？

> ID：14341622
> 
> 赞同：0
> 
> 时间：2013-01-15T15:57:56.763
> 
> 标签：java, html, applet, screen, loading

我为我的 Java 小程序创建了一个自定义加载程序：

html代码：

```
<applet [...]
<PARAM name="image" value="pmap_loader.gif"/>
<PARAM name="boxborder" value="false"/>
<PARAM name="centerimage" value="true"/>
<\applet> 
```

这很好用，但 gif 快疯了。加载条每秒填充 1000 倍，而您可以看到，gif 已正确创建：http: [//i.imgur.com/MQEof.gif](http://i.imgur.com/MQEof.gif)

有人知道如何解决这个问题吗？我猜图像会不断刷新自己或类似的东西，但我不知道如何解决这个问题。

谢谢您的帮助！

# e-commerce - Kentico 电子商务：获得最畅销的类别

> ID：14341625
> 
> 赞同：2
> 
> 时间：2013-01-15T15:58:05.803
> 
> 标签：e-commerce, kentico

我正在使用 Kentico 7.0，电子商务版本。

我想创建一个侧边栏菜单，显示 eshop 最畅销的产品类别。我是一名 kentico 新手，所以我正在四处寻找正确的术语/指导，以便我可以更深入地挖掘。

我认为理想的方法是能够在类别上添加一个字段，用于过滤菜单的类别。通过这种方式，我可以拥有某种根据销售额自动更新字段的工作，或者为管理员提供手动覆盖以指定一个类别是否会显示在菜单上。当然，还需要某种权重来指定菜单项排序。

我应该朝哪个方向看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T05:50:25.650

Kentico 有多种编码方式。我个人觉得 API 有点笨拙，在很多情况下，我很惊讶不存在需要额外调用才能获得所需结果的方法。在将数据放入 Kentico 时，我确实更多地使用 Kentico API。将其拉出我使用以下内容。

存储过程

编写一个 SQL 存储过程来获取前 X 个类别 - GetTop5Categories。

查看 COM_* 表，特别是 COM_OrderItem，将 OrderItemSKUID 链接回 COM_SKU（或 View_COM_SKU_Joined，如果您需要访问 IA）。

这将为您提供最畅销的产品，其中包含 group by、count、top X 和 order by。

然后，您可以链接到其他表格，例如 CMS_Category 或 CMS_Document（取决于您如何设置类别）。这样做的好处是编译过程，您在那里进行所有数据操作（这是 MSSQL 擅长的！）并且您只在结果集中发回您需要的内容。

DOMAIN（利用 EF）

我通常创建一个单独的类库项目 myproject.domain 并将一个实体框架 edmx 放在那里映射回 Kentico DB。将 proc 添加到 EDMX，然后从新导入的 proc 创建一个 Function Import MyProject_GetTop5Categories。

网络

从您的 Web 项目中添加对域项目的引用，并在控件的代码隐藏顶部添加一个“使用”。

使用 myproject.domain；

然后在 Page_Load 中为控件：

...

```
if(!IsPostBack)
{

var entities = new MyProjectModelContainer();
var list = entities.MyProject_GetTop5Categories().ToList();
StringBuilder sb = new StringBuilder("<ul>");
foreach(var category in list)
{
   sb.Append("<li><a href='"+category.Link+"'>" + category.Name + "</a></li>");
}
sb.Append("<ul>");

listPlaceHolder = sb.ToString();

} 
```

手写的，所以可能有一两个错字：）

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T17:19:44.497

您是否尝试过使用可用的“按销售额排名前 N 的产品”Web 部件？您可以配置它应该从内容树（产品）的哪个部分提取数据 - 在 Path 属性中，您还可以使用动态解析的路径表达式或宏，以便 Web 部件可以在不同部分显示不同的产品。

# sql - SQL Server：选择不同的，但指示另一列是否为空？

> ID：14341629
> 
> 赞同：1
> 
> 时间：2013-01-15T15:58:09.803
> 
> 标签：sql, sql-server, tsql

不确定这个标题是否合适，但这是我的场景......

我有一个看起来像这样的表：

```
Key1     Key2   Scheduled    Data
----------------------------------
abc123    io       null      asdf    
abc123    go     01/02/13    asdf
abc321    er       null      asdf 
abc321    fr       null      asdf 
```

无论其他列如何，我都需要选择 distinct 以获得不同的集合，`Key1`但我还需要一个布尔值来指示设置了任何预定列的天气。所以理想情况下我的结果集看起来像这样

```
Key1     IsAnyScheduled
-------------------
abc123      True
abc321      False 
```

我不是 SQL 专家，看不到如何做到这一点。此外，我们的系统基于 SQL Server，但它运行 sql 的一个子集，所以如果可能的话，有人可以帮助我用最基本的功能编写它吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:00:04.730

使用`MAX`,`CASE`和一个`GROUP BY`子句。

```
SELECT  Key1,
        CASE WHEN MAX(Scheduled) IS NULL
            THEN 'False'
            ELSE 'TRUE'
        END AS IsAnyScheduled
FROM    tableName
GROUP   BY Key1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/46e45/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:00:09.263

你需要一个组：

```
select key1, (case when count(Scheduled) = 0 then 'false' else 'true' end) as IsAnyScheduled
from t
group by key1 
```

# sql - SQL Server，来自不同客户端的查询

> ID：14341633
> 
> 赞同：1
> 
> 时间：2013-01-15T15:58:17.027
> 
> 标签：sql, sql-server, express, sql-server-express

我的问题是：我有 5 个 vba excel 客户端向远程服务器发送 SQL 查询。他们会矛盾吗？就像前任一样。一个表`food`包含：

```
itemId  Name
--------------
3       burger
4       pizza 
```

现在如果我通过 4-5 个不同的客户端增加 item id 的值，会不会发生冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:48:11.453

```
insert table food
select 1 + max(itemId), 'spaghetti' from food 
```

如果你这样做，不：5个客户端不会冲突，5000个也不会。

# android - Google Maps Android API v2 因 NoClassDefFound 错误而崩溃

> ID：14341636
> 
> 赞同：0
> 
> 时间：2013-01-15T15:58:22.177
> 
> 标签：android, google-maps

我正在尝试实现google maps android api v2 example的最基本示例。但它因错误而崩溃：java.lang.NoClassDefFoundError: com.google.android.gms.R$styleable。

我已经设置了 google api 并查看了 stackoverflow 帖子，例如：

*   - [https://stackoverflow.com/questions/14252879/google-maps-android-api-v2-tutorials](https://stackoverflow.com/questions/14252879/google-maps-android-api-v2-tutorials)，
*   -[谷歌地图 android API V2 崩溃](https://stackoverflow.com/questions/14230808/google-map-android-api-v2-crashed) 和
*   - [https://stackoverflow.com/questions/13796822/google-map-android-api-v2-application-crashes](https://stackoverflow.com/questions/13796822/google-map-android-api-v2-application-crashes.)

但他们的问题与我的略有不同。

你能指出我正确的方向吗？我正在使用 android 2.2 并希望使用新的地图在我的应用程序中使用片段；这样我就可以获得一些功能，例如苹果的 uinavigation 以在弹出活动中推送新视图。

# 谢谢。

谢谢，您是如何获得附件中显示的 png 的？ google play 服务在我的包资源管理器中显示为引用库；我确实添加了它；这是我的日志：

```
01-16 06:23:55.087: E/AndroidRuntime(305): FATAL EXCEPTION: main
01-16 06:23:55.087: E/AndroidRuntime(305): java.lang.NoClassDefFoundError: com.google.android.gms.R$styleable
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.google.android.gms.maps.GoogleMapOptions.createFromAttributes(Unknown Source)
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.google.android.gms.maps.SupportMapFragment.onInflate(Unknown Source)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:271)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:558)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.Activity.setContentView(Activity.java:1647)
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.example.afis.MainActivity.onCreate(MainActivity.java:13)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.os.Looper.loop(Looper.java:123)
01-16 06:23:55.087: E/AndroidRuntime(305):  at android.app.ActivityThread.main(ActivityThread.java:4627)
01-16 06:23:55.087: E/AndroidRuntime(305):  at java.lang.reflect.Method.invokeNative(Native Method)
01-16 06:23:55.087: E/AndroidRuntime(305):  at java.lang.reflect.Method.invoke(Method.java:521)
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-16 06:23:55.087: E/AndroidRuntime(305):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-16 06:23:55.087: E/AndroidRuntime(305):  at dalvik.system.NativeStart.main(Native Method)
01-16 06:23:55.097: W/ActivityManager(59):   Force finishing activity com.example.afis/.MainActivity
01-16 06:23:55.607: W/ActivityManager(59): Activity pause timeout for HistoryRecord{44ee9110 com.example.afis/.MainActivity} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-22T07:26:12.870

我通过在导入 Google Play 服务库时选中“将项目复制到工作区”解决了这个错误。更多信息在这里：http: [//developer.android.com/google/play-services/setup.html](http://developer.android.com/google/play-services/setup.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:02:12.447

请检查您的项目中是否存在包含“android-support-v4.jar”的“libs”文件夹。因为您使用的是 Android 2.2，所以您的项目根目录中必须有“libs”文件夹。如果没有，只需将该 jar 文件复制到“libs”文件夹中即可。

“android-support-v4.jar”位于目录下的“/extras/android/compatibility/v4/android-support-v4.jar”中。

在运行您的项目之前，您必须将您的项目构建目标设置为“Google APIs”，而不是 Android xx 版本：选择您的项目并在 Eclipse 中单击项目 > 属性 > 项目构建目标并选择任何“Google APIs”，然后运行您的手机上的项目。如果您使用模拟器，还必须将模拟器的 AVD 设置为任何“Google APIs”。

再一次，您不需要创建新的 Google Maps API 密钥来测试您的项目，只需使用默认提供的 API 密钥，在您的 Google API 控制台中显示为“浏览器应用程序的密钥（带引用者）” .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T10:20:03.937

1.  使用 Android SDK Manager 下载“google play services”

2.  将其导入您的工作区（路径：android-sdk root/extras/google/google_play_service/libproject/google-play-service_lib）

3.  项目属性 -> android -> 库添加 google-play-service_lib

4.  Build path -> Order and Export 检查Android私有库

# c# - 使用 LINQ SQL 的模板/通用方式？

> ID：14341642
> 
> 赞同：1
> 
> 时间：2013-01-15T15:58:53.060
> 
> 标签：c#, .net, linq

我有以下类，它为我的数据库中的客户创建数据访问功能：

```
 public static Customer Get(int ID)
    {
        KezberPMDBDataContext db = new KezberPMDBDataContext();
        return (from p in db.Customers
               where p.CustomerID == ID
               select p).FirstOrDefault();
    }

    public static bool Remove(int ID)
    {
        Customer c = Get(ID);
        if (c != null)
        {
            KezberPMDBDataContext db = new KezberPMDBDataContext();
            db.Customers.DeleteOnSubmit(c);
            db.SubmitChanges();
            return true;
        }

        return false;
    } 
```

我将创建更多的类，例如Employees，它们需要完全相同的功能，只是使用Employee 类。

有什么方法可以避免代码重复并以某种方式使用模板/泛型？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:03:03.277

EntityFramework 4.3 和 5 的[`DbSet`](http://msdn.microsoft.com/en-us/library/gg679599%28v=vs.103%29.aspx)类有一个[`Find`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.find%28v=vs.103%29.aspx)完全按照您的`Get`方法执行的方法，以及一个[`Remove`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.remove%28v=vs.103%29.aspx)执行您执行的操作的方法`Remove`（它接受对象而不是 id）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:05:13.333

你可以这样做：

```
 private T GetById(int id, IQueryable<T> list)
    {
        var itemParameter = Expression.Parameter(typeof(T), "item");

        var whereExpression = Expression.Lambda<Func<T, bool>>
            (
            Expression.Equal(
                Expression.Property(
                    itemParameter,
                    PrimaryKeyName
                    ),
                Expression.Constant(id)
                ),
            new[] { itemParameter }
            );

        var item = list.Where(whereExpression).SingleOrDefault();

        if (item == null)
        {
            throw new PrimaryKeyNotFoundException(string.Format("No {0} with primary key {1} found",
                                                                typeof(T).FullName, id));
        }

        return item;
    } 
```

# limit - Stata：如何使用 gabbed 时间数据提前 5 分钟获得观察值

> ID：14341644
> 
> 赞同：2
> 
> 时间：2013-01-15T15:58:57.633
> 
> 标签：limit, stata, stocks, hft

我从 Stata 的限价订单簿中获得高频数据。时间没有固定的间隔，有些观察是同时的（以毫秒为单位）。对于每个观察，我需要在 5 分钟后在单独的列中获得中点。因此，对于观察 1，中点为 10.49，因为最接近 09:05:02.579 的最后一个中点为 10.49。

如何在Stata中做到这一点？

```
datetime                         midpoint
12/02/2012 09:00:02.579          10.5125
12/02/2012 09:00:03.471          10.5125
12/02/2012 09:00:03.471          10.5125
12/02/2012 09:00:03.471          10.51
12/02/2012 09:00:03.471          10.51
12/02/2012 09:00:03.549          10.505
12/02/2012 09:00:03.549          10.5075
   ......
12/02/2012 09:04:59.785          10.495
12/02/2012 09:05:00.829          10.4925
12/02/2012 09:05:01.209          10.49
12/02/2012 09:05:03.057          10.4875
12/02/2012 09:05:05.055          10.485
 ..... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:14:02.987

我的方法是

1.  生成偏移五分钟的新数据集
2.  `append`这个移位器数据集
3.  找到最接近五分钟增量的观察前后
4.  使用一些标准来选择这两个值中的更好的值

您指定了最接近的，但您可能希望根据您的书添加一些其他条件。此外，您在给定的毫秒刻度上提到了多个值，但没有更多信息，我不确定如何处理。你想先合并这些中点吗？还是它们是不同的股票？

下面是一些实现上述方法基础的代码。

```
clear
version 11.2
set seed 2001

* generate some data
set obs 100000
generate double dt = ///
    tc(02dec2012 09:00:00.000) + 1000*_n + int(100*rnormal())
format dt %tcDDmonCCYY_HH:MM:SS.sss
sort dt
generate midpt = 100
replace midpt = ///
    round(midpt[_n - 1] + 0.1*rnormal(), 0.005) if (_n != 1)

* add back future midpts
preserve
tempfile future
rename midpt fmidpt
rename dt fdt
generate double dt = fdt - tc(00:05:00.000)
save `future'
restore
append using `future'

* generate midpoints before and after 5 minutes in the future
sort dt
foreach v of varlist fdt fmidpt {
    clonevar `v'_b = `v'
    replace `v'_b = `v'_b[_n - 1] if missing(`v'_b)
}

gsort -dt
foreach v of varlist fdt fmidpt {
    clonevar `v'_a = `v'
    replace `v'_a = `v'_a[_n - 1] if missing(`v'_a)
}

format fdt* %tcDDmonCCYY_HH:MM:SS.sss

* use some algorithm to pick correct value
sort dt    
generate choose_b = ///
    ((dt + tc(00:05:00.000)) - fdt_b) < (fdt_a - (dt + tc(00:05:00.000))) 
generate fdt_c = cond(choose_b, fdt_b, fdt_a)
generate fmidpt_c = cond(choose_b, fmidpt_b, fmidpt_a)
format fdt_c %tcDDmonCCYY_HH:MM:SS.sss 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T07:20:02.940

```
// Construct a variable to look for in the dataset
gen double midpoint_5 = (datetime + 5*60000)    
format midpoint_5 %tcNN/DD/CCYY_HH:MM:SS.sss

// will contain the closest observation number and midpoint 5 minutes a head
gen _t = .
gen double midpoint_at5 = . 

// How many observations in the sample?
local N = _N

// We will use these variables to skip some observations in the loop
egen obs_in_minute = count(minutes_filter), by(minutes_filter)
egen max_obs_in_minute = max(obs_in_minute)
set more off 

// For each observation
forvalues i = 1/`N' {

    // If it is a trade
    if type[`i'] == "Trade" {

        // Set the time to lookup in the data
        local lookup = midpoint_5[`i']

        // The time should be between the min and max(*5)
        local min = `i' + obs_in_minute[`i'] // this might cause errors
        local max = `i' + max_obs_in_minute[`i']*5

        // For each of these observations
        forvalues j = `min'/`max' {

            // Check if the lookup date is smaller than the datetime of the observation
            if `lookup' < datetime[`j'] {

                // Set the observation ID at the lookup ID 1 observation before
                quietly replace _t = `j'-1 in `i'
                // Set the midpoint at the lookup ID 1 observation before
                quietly replace midpoint_at5 = midpoint[`j'-1] in `i'

                // We have found the closest 5th min ahead... now stop loop and continue to next observation.
                continue, break
            }
        }

        // This is to indicate where we are in the loop
        display "`i'/`N'"
    }
} 
```

# tsql - 将一列中的数据拆分为多列

> ID：14341647
> 
> 赞同：0
> 
> 时间：2013-01-15T15:59:03.013
> 
> 标签：tsql, split, multiple-columns

我在表中有一个列，其中包含用连字符分隔的数字数据。我需要将此数据拆分为三列，因此该数值的每个部分都位于单独的列中。具体数据用于学习目的，但我也看到数据库名称字段是一列而不是三列（例如“FirstMiddleLast”而不是“First”、“Middle”、Last”）。

以下是数值示例：

```
1234-56-78 
```

我想拆分它，所以我有三列

```
1234 | 56 | 78 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:21:56.680

试试这个（[这里是 Sql Fiddle](http://sqlfiddle.com/#!3/d41d8/7755)）；

```
declare @s varchar(50)='1234-56-78'

select left(@s,charindex('-',@s,1)-1) Col1,
       substring(@s,charindex('-',@s,1)+1, len(@s)-charindex('-',reverse(@s),1)-
       charindex('-',@s,1)) Col2,
       right(@s,charindex('-',reverse(@s),1)-1) Col3

--results
Col1    Col2    Col3
1234    56      78 
```

# git - 如何在 git rebase 中提取特定提交

> ID：14341656
> 
> 赞同：0
> 
> 时间：2013-01-15T15:59:35.057
> 
> 标签：git, git-rebase

我的分支落后于 5 次提交。

```
muralish@vnc9[~/git/task](task-68↓3| ✓)$git status
# On branch task-68
# Your branch is behind 'origin/task-68' by 5 commits, and can be fast-forwarded.
#
nothing to commit, working directory clean
muralish@vnc9[~/git/task](desflow-68↓3| ✓)$ 
```

这些提交是 A-> B-> C -> D -> E。我怎样才能只获得与提交 C 相关的更改到工作目录。

它尝试了 git rebase -i 但根本不会列出该提交。它输出以下信息。

```
 noop

   # Rebase 484a22b..b7fa802 onto 484a22b
   #
   # Commands:
   #  p, pick = use commit
   #  r, reword = use commit, but edit the commit message
   #  e, edit = use commit, but stop f 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:06:51.830

尝试

```
git cherry-pick <C-sha> 
```

如果您不希望将这些更改存储为新的提交，请使用

```
git reset HEAD~1 
```

然后，这些更改既不会暂存，也不会提交。

**更新：**

如果您希望自己的分支*看起来*已经合并了 task-68 中的这 5 个提交，而*实际上*它只有提交 C，您可以编写（在挑选樱桃之后）：

```
git merge -s ours task-68 
```

**更新 2：**

保持本地`task-68`分支与 相同是一种常见的做法`origin/task-68`，因此如果您想省略父分支中的一些提交，最好预先分叉它：

```
git checkout -b task-68-wip 
```

在此之后，如上所述进行樱桃采摘和合并。

# css - HTML & CSS 如何防止 div 延伸到更大的窗口高度？

> ID：14341657
> 
> 赞同：1
> 
> 时间：2013-01-15T15:59:37.790
> 
> 标签：css, html, position, overflow

如何防止包含一长串项目的 div 扩展页面高度。我希望 div 占据整个屏幕，但不要更多，这样它就不会将页脚向下推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:14:29.070

为容器设置一个特定的高度`div`，并设置`overflow-y`为 auto 以便仅当 div 的内容大于`container`. 像这样：

```
.container { 
    height: 500px; 
    overflow-y:auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:28:27.380

没有js是不可能的，因为你的页面可以用不同的分辨率查看。不同的分辨率意味着不同的高度。事实上，当用户调整浏览器窗口大小时，您可能也想要这种行为，对吗？所以首先，找出浏览器的高度，从中减去页脚的高度，并将这个高度设置为你的容器，我相信你想让它在 yaxis 上滚动。这将解决问题。所有这些任务都非常简单，你可以通过谷歌搜索来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:12:13.763

为此使用 JavaScript/jQuery：

**jQuery解决方案：**

```
<div id="content-div">some content here</div>

$(document).ready(function() {
  var height = $(document).height();
  height = height - (your footer height);
  $("#content-div").css({ 'max-height' : height.toString() });
}); 
```

**标准 JavaScript 解决方案：**

```
<div id="content-div">some content here</div>

 function myfunction () {
       document.getElementById('content-div').style.height = getDocHeight() + 'px';
 }

window.onload = myfunction();

document.getElementById('content-div').style.height = getDocHeight() + 'px';

function getDocHeight() {
    var D = document;
    return Math.max(
        Math.max(D.body.scrollHeight, D.documentElement.scrollHeight),
        Math.max(D.body.offsetHeight, D.documentElement.offsetHeight),
        Math.max(D.body.clientHeight, D.documentElement.clientHeight)
    );
} 
```

另外，将 CSS 更改为：

```
#content-div { background-color:#1d1d1d; color:#eee; overflow-y: scroll; } 
```

# powershell - 在 Powershell 中将自定义对象数组转换为字符串数组

> ID：14341667
> 
> 赞同：23
> 
> 时间：2013-01-15T15:59:53.357
> 
> 标签：powershell

所以我正在调整一些 Powershell 库，我有一个简单的问题，我想以最好的方式解决......

简而言之，我在数组中有一些自定义 PSObject：

```
$m1 = New-Object PSObject –Property @{Option="1"; Title="m1"}
$m2 = New-Object PSObject –Property @{Option="2"; Title="m2"}
$m3 = New-Object PSObject –Property @{Option="3"; Title="m3"}

$ms = $m1,$m2,$m3 
```

我希望将其转换为字符串数组....理想情况下是单个字符串数组，其中每个项目都有一个连接属性的条目。IE

> “1m1”、“2m2”、“3m3”

我试过了`$ms | Select-Object Option,Title`，`$ms | %{ "O: $_.Option T: $_.Title "}` 但他们给了我 PSObject 的数组（再次）或数组的数组。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-15T16:09:08.877

这会给你你想要的：

```
$strArray = $ms | Foreach {"$($_.Option)$($_.Title)"} 
```

[Select-Object](http://technet.microsoft.com/en-us/library/hh849895.aspx)有点像 SQL [SELECT](https://en.wikipedia.org/wiki/Select_%28SQL%29)。它将选定的属性投影到一个新对象上（v1/v2 中的 pscustomobject 和 V3 中的 Selected.<orignalTypeName>）。您的第二种方法不起作用，因为`$_.Option`在字符串中只会“插入”变量`$_`。它不会评估表达式`$_.Option`。

您可以通过使用子表达式获取双引号字符串来评估表达式，例如“$(...)”或“$($_.Option)”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-11T22:44:21.343

`doesn't contain a method named 'op_Addition'.`尝试收集对象值并将它们添加到数组集合时，我也收到了相同的错误消息。`@(`用and包裹变量时效果很好`)`。

这是一篇参考文章：

*   [https://devblogs.microsoft.com/powershell/converting-to-array/](https://devblogs.microsoft.com/powershell/converting-to-array/)

PS脚本数组集合

```
##USER PROFILES...
$UserProfiles= @("cg2208", "cg0769", "ms8659", "sw1650", "dc8141", "bc0397", "bm7261")
$UserProfiles
$aduserlist = @()
foreach ($user in $UserProfiles {
  $user 
  #Write-Host "Press any key to continue ..."
  #$x = $host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
$aduser= Get-ADUser -Identity $user -Properties * | Select -Property  SamAccountName, Name, LastLogonDate, whenCreated, msExchWhenMailboxCreated, City, State, Department, Title, mailNickname, Description
#$aduserlist += $aduser | Select Name, SamAccountName, City, State, Department, Title, whenCreated, msExchWhenMailboxCreated, mailNickname, Description
#$aduserlist += $aduser | Foreach {"$($_.SamAccountName)$($_.Name)$($_.City)$($_.State)$($_.Title)$($_.whenCreated)$($_.msExchWhenMailboxCreated)$($_.mailNickname)$($_.Description)"}
$aduserlist += @($aduser)  
}
$aduserlist
$aduserlist | ft -auto 
```

# javascript - 改变数据标题的颜色（谷歌可视化）

> ID：14341673
> 
> 赞同：4
> 
> 时间：2013-01-15T16:00:02.187
> 
> 标签：javascript, colors, google-visualization, linechart

我正在尝试更改折线图的颜色（Google 可视化）。那行得通，但我找不到如何更改“猫”文本的颜色。 ![在此处输入图像描述](../Images/96eb2b1b623d46888dbad9d8ec39cb2d.png)

正如这里描述的那样？[https://developers.google.com/chart/interactive/docs/gallery/linechart](https://developers.google.com/chart/interactive/docs/gallery/linechart)

```
function drawVisualization() {
  // Create and populate the data table.
  var data = google.visualization.arrayToDataTable([
    ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
    ['A',   1,       1,           0.5],
    ['B',   2,       0.5,         1],
    ['C',   4,       1,           0.5],
    ['D',   8,       0.5,         1],
    ['E',   7,       1,           0.5],
    ['F',   7,       0.5,         1],
    ['G',   8,       1,           0.5],
    ['H',   4,       0.5,         1],
    ['I',   2,       1,           0.5],
    ['J',   3.5,     0.5,         1],
    ['K',   3,       1,           0.5],
    ['L',   3.5,     0.5,         1],
    ['M',   1,       1,           0.5],
    ['N',   1,       0.5,         1]
  ]);

  // Create and draw the visualization.
  new google.visualization.LineChart(document.getElementById('visualization')).
      draw(data, {curveType: "function",
                  width: 500, height: 400,
                  vAxis: {maxValue: 10}}
          );
} 
```

另一个问题这是我目前的工作，但为什么我看到 - 5 百万即使没有低于 0 的数字？

![在此处输入图像描述](../Images/3432baa4757a7d24a7e5935b1a09906e.png)

我的代码：

```
new google.visualization.LineChart(document.getElementById('visualization')).
    draw(data, {
                curveType: "function",
                width: 900, height: 300,
                vAxis: {minValue:0},
                colors: ['#769dbb'], //Line color
                backgroundColor: '#1b1b1b',
                hAxis: { textStyle: {color: '#767676'  , fontSize: 11} },
                vAxis: { textStyle: {color: '#767676'} },
                }
        ); 
```

}

​</p>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:24:51.223

让我们把你的问题分成两部分。

**自定义您的图例**

对于您的第一个问题，[API 文档](https://google-developers.appspot.com/chart/interactive/docs/gallery/linechart#Configuration_Options)并没有真正让我们直接访问图例本身。我认为解决您的问题的最佳方法是从关闭默认图例开始：

```
var chart = new google.visualization.LineChart(document.getElementById('visualization'))
.draw(data, {
    legend: { position: "none" }, // turn off the legend
    curveType: "function",
    width: 900, height: 300,
    vAxis: {minValue:0},
    colors: ['#769dbb'], //Line color
    backgroundColor: '#1b1b1b',
    hAxis: { textStyle: {color: '#767676'  , fontSize: 11} },
    vAxis: { textStyle: {color: '#767676'} },
}); 
```

完成此操作后，您可以通过与地图本身交互来创建自己的图例：

```
google.visualization.events.addListener(chart, 'ready', drawCustomLegend); 
```

查看[有关处理图表事件的文档](https://developers.google.com/chart/interactive/docs/events)以及[此问题](https://stackoverflow.com/a/13639884/616937)。

**配置轴尺寸**

要删除 -5 百万水平轴值，您可以将您设置`vAxis.minValue`为 0。所以把它们放在一起：

```
var chart = new google.visualization.LineChart(document.getElementById('visualization'))
.draw(data, {
    legend: { position: "none" }, // turn off the legend
    curveType: "function",
    width: 900, height: 300,
    vAxis: {minValue:0},
    colors: ['#769dbb'], //Line color
    backgroundColor: '#1b1b1b',
    hAxis: { textStyle: {color: '#767676'  , fontSize: 11} },
    vAxis: { minValue: 0, textStyle: {color: '#767676'} },
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-23T16:30:33.897

这对我有用。查看下面的“legend”属性。

```
options='{"title": "Abandoned Carts",
              "backgroundColor" : "transparent",
              "pieHole": "0.4",
              "legend" : { "textStyle" : { "color" : "white"} }
              }' 
```

# java - trayicon.displaymessage 文本大小 java

> ID：14341678
> 
> 赞同：1
> 
> 时间：2013-01-15T16:00:10.223
> 
> 标签：java, trayicon

这是我在这个论坛的第一篇文章，我真的希望它会尽快得到答复。我是 Java 新手，喜欢经常尝试不同的东西。我想用Java制作简单的气球消息应用程序，它会在系统托盘中的某个时间弹出，随着时间的推移传达不同的消息。只是想知道我是否可以更改气球消息的文本大小。此外，如果有人可以帮助我解决消息出现和消失的时间间隔和延迟。以下是我尝试过的代码，请考虑一下以帮助我解决这个问题。

```
import java.awt.Image;
import java.awt.SystemTray;
import java.awt.TrayIcon;
import javax.swing.ImageIcon;

 public class BubbleMessages {

 public static void main(String[] args) throws Exception{
    SystemTray tray = SystemTray.getSystemTray();
  Image i = new ImageIcon("resources/bulb.gif").getImage();
  TrayIcon ti = new TrayIcon(i);
  tray.add(ti);
  ti.displayMessage("Message", "message", TrayIcon.MessageType.INFO);

  }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T03:02:22.740

检查[api](http://docs.oracle.com/javase/7/docs/api/java/awt/TrayIcon.html#displayMessage%28java.lang.String,%20java.lang.String,%20java.awt.TrayIcon.MessageType%29)。用户单击该消息将自动消失。

如果要再次显示消息，可以使用[Timer](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html)

您可以像这样修改代码

```
import java.awt.Image;
import java.awt.SystemTray;
import java.awt.TrayIcon;
import javax.swing.ImageIcon;
public class BubbleMessages {
    private static TrayIcon ti;
    public static void main(String[] args) throws Exception{
        SystemTray tray = SystemTray.getSystemTray();
        Image i = new ImageIcon("resources/bulb.gif").getImage();
        ti = new TrayIcon(i);
        tray.add(ti);
        MessageDisplayTask mdt = new MessageDisplayTask(ti);
        java.util.Timer timer = new java.util.Timer("DM");
        timer.schedule(mdt, 0, 10000);//Every three seconds, it shows a message
    }
}
class MessageDisplayTask extends java.util.TimerTask {
    private TrayIcon ti;
    private int displayCount = 0;
    public MessageDisplayTask(TrayIcon ti){
        this.ti = ti;
    }
    public void run() {
        displayCount++;
        if (displayCount <= 10) {
            ti.displayMessage("Message", "Message#" + displayCount, TrayIcon.MessageType.INFO);
        } else {
            //Stop Timer.
            this.cancel();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-22T12:25:54.573

```
tray.add(ti);
ti.setImageAutoSize(true);
ti.displayMessage("Message", "message", TrayIcon.MessageType.INFO); 
```

# c# - 将编码的 XML 标记转换为节点

> ID：14341686
> 
> 赞同：0
> 
> 时间：2013-01-15T16:00:33.240
> 
> 标签：c#, xml, soap

我通过 SOAP 调用获得了以下 XML。

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
    <GetValueListForFieldResponse xmlns="http://URLHere/webservices/">
        <GetValueListForFieldResult>
            &amp;lt;SelectDef&amp;gt; &amp;lt;Id&amp;gt;1736&amp;lt;/Id&amp;gt; &amp;lt;SelectName&amp;gt;Values List&amp;lt;/SelectName&amp;gt; &amp;lt;GlobalFlag&amp;gt;False&amp;lt;/GlobalFlag&amp;gt; &amp;lt;Sort&amp;gt;1&amp;lt;/Sort&amp;gt; &amp;lt;SelectDefValues&amp;gt; &amp;lt;SelectDefValue&amp;gt; &amp;lt;guid&amp;gt;aaf6f3a7-6a74-4187-b4e7-3a9355b16796&amp;lt;/guid&amp;gt; &amp;lt;Id&amp;gt;14692&amp;lt;/Id&amp;gt; &amp;lt;Name&amp;gt;Open&amp;lt;/Name&amp;gt; &amp;lt;Description&amp;gt;&amp;lt;/Description&amp;gt; &amp;lt;Color&amp;gt;#000000&amp;lt;/Color&amp;gt; &amp;lt;DefaultFlag&amp;gt;False&amp;lt;/DefaultFlag&amp;gt; &amp;lt;SortOrder&amp;gt;1&amp;lt;/SortOrder&amp;gt; &amp;lt;select_id&amp;gt;1736&amp;lt;/select_id&amp;gt; &amp;lt;/SelectDefValue&amp;gt; &amp;lt;SelectDefValue&amp;gt; &amp;lt;guid&amp;gt;f5082b54-d799-4fdc-80c1-0e232b360057&amp;lt;/guid&amp;gt; &amp;lt;Id&amp;gt;14693&amp;lt;/Id&amp;gt; &amp;lt;Name&amp;gt;Closed&amp;lt;/Name&amp;gt; &amp;lt;Description&amp;gt;&amp;lt;/Description&amp;gt; &amp;lt;Color&amp;gt;#000000&amp;lt;/Color&amp;gt; &amp;lt;DefaultFlag&amp;gt;False&amp;lt;/DefaultFlag&amp;gt; &amp;lt;SortOrder&amp;gt;0&amp;lt;/SortOrder&amp;gt; &amp;lt;select_id&amp;gt;1736&amp;lt;/select_id&amp;gt; &amp;lt;/SelectDefValue&amp;gt; &amp;lt;SelectDefValue&amp;gt; &amp;lt;guid&amp;gt;94e29e78-2ab3-463f-bbb6-ab7f36003c7f&amp;lt;/guid&amp;gt; &amp;lt;Id&amp;gt;14780&amp;lt;/Id&amp;gt; &amp;lt;Name&amp;gt;Past Due&amp;lt;/Name&amp;gt; &amp;lt;Description&amp;gt;&amp;lt;/Description&amp;gt; &amp;lt;Color&amp;gt;#000000&amp;lt;/Color&amp;gt; &amp;lt;DefaultFlag&amp;gt;False&amp;lt;/DefaultFlag&amp;gt; &amp;lt;SortOrder&amp;gt;2&amp;lt;/SortOrder&amp;gt; &amp;lt;select_id&amp;gt;1736&amp;lt;/select_id&amp;gt; &amp;lt;/SelectDefValue&amp;gt; &amp;lt;/SelectDefValues&amp;gt; &amp;lt;/SelectDef&amp;gt;
        </GetValueListForFieldResult>
    </GetValueListForFieldResponse>
</soap:Body> 
```

有没有办法将 GetValueForFieldResult 节点中的数据转换为实际的 XML，以便我可以解析数据？

下面是我如何进行 SOAP 调用和存储 XML。我正在学习 C#，如果下面是一团糟，我的道歉。

```
HttpWebRequest reqVl = (HttpWebRequest)WebRequest.Create(serverURL + "/ws/Field.asmx");
reqVl.Headers.Add("SOAPAction", "http://URL/webservices/GetValueListForField");
reqVl.ContentType = "text/xml;charset=\"utf-8\"";
reqVl.Accept = "text/xml";
reqVl.Method = "POST";

using (Stream stm = reqVl.GetRequestStream())
{
    using (StreamWriter stmw = new StreamWriter(stm))
    {
        stmw.Write(VLsoap);
    }
}

WebResponse responseVL = reqVl.GetResponse();
Stream responseStreamVL = responseVL.GetResponseStream();
XmlReader rdrVL = XmlReader.Create(responseStreamVL);

XmlDocument vls = new XmlDocument();
vls.Load(rdrVL); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:52:26.410

这是一些实现您想要的代码 - 但是，请稍后阅读文本以解释为什么这可能不是获得您想要的最佳方式。

经测试可与您的消息和 .Net 4 一起使用。

假设 vls 包含您作为 XML 的 SOAP 消息，我们将问题分成两半；解析soap消息，并将`GetValueListForFieldResult`节点的内容提取和解码为可以加载到另一个的字符串`XmlDocument`

**第一部分**- 获取`GetValueListForFieldResult`节点的内容

```
 XmlNamespaceManager namespaceManager = new XmlNamespaceManager(vls.NameTable);
  namespaceManager.AddNamespace("soap", "http://schemas.xmlsoap.org/soap/envelope/");
  namespaceManager.AddNamespace("default", "http://URLHere/webservices/");

  XmlNode payLoadNode =
    vls.SelectSingleNode("/soap:Envelope/soap:Body/default:GetValueListForFieldResponse/default:GetValueListForFieldResult", namespaceManager);

  string encodedXml = payLoadNode.InnerText; 
```

**第 II 部分**- 将编码字符串放入 Xml 文档

正是在这一点上，我们有了编码的字符串。我们有几个选择来解码这个 HTML；当我使用.Net 4时，我选择了最简单的：

```
 string decodedXml = WebUtility.HtmlDecode(encodedXml);

  XmlDocument payloadDocument = new XmlDocument();
  payloadDocument.LoadXml(decodedXml); 
```

如果您使用的是 .Net 3.5，那么您将不得不考虑添加对 System.Web 的引用并使用它`HttpUtility.HtmlDecode`来解码字符串。

解析上面的消息给了我结果：

```
<SelectDef>
  <Id>1736</Id>
  <SelectName>Values List</SelectName>
  <GlobalFlag>False</GlobalFlag>
  <Sort>1</Sort>
  <SelectDefValues>
    <SelectDefValue>
      <guid>aaf6f3a7-6a74-4187-b4e7-3a9355b16796</guid>
      <Id>14692</Id>
      <Name>Open</Name>
      <Description></Description>
      <Color>#000000</Color>
      <DefaultFlag>False</DefaultFlag>
      <SortOrder>1</SortOrder>
      <select_id>1736</select_id>
    </SelectDefValue>
    <SelectDefValue>
      <guid>f5082b54-d799-4fdc-80c1-0e232b360057</guid>
      <Id>14693</Id>
      <Name>Closed</Name>
      <Description></Description>
      <Color>#000000</Color>
      <DefaultFlag>False</DefaultFlag>
      <SortOrder>0</SortOrder>
      <select_id>1736</select_id>
    </SelectDefValue>
    <SelectDefValue>
      <guid>94e29e78-2ab3-463f-bbb6-ab7f36003c7f</guid>
      <Id>14780</Id>
      <Name>Past Due</Name>
      <Description></Description>
      <Color>#000000</Color>
      <DefaultFlag>False</DefaultFlag>
      <SortOrder>2</SortOrder>
      <select_id>1736</select_id>
    </SelectDefValue>
  </SelectDefValues>
</SelectDef> 
```

**替代方案**

您可能不希望这样做的原因是您收到的响应已使用 SOAP 进行了包装；因此，您可能希望尝试将您连接的服务作为 Web 服务使用并生成代理库；这会将您在上面看到的所有代码以及您编写的代码封装在一个代理中，该代理可能允许您以更安全和更不脆弱的方式检索您想要的值。.Net 中内置了对此的支持。

此外，由于您要连接的 URL 在 ASMX 中终止，它会告诉您这很可能是本机 .Net Web 服务，因此将您的客户端连接到它应该很简单。

MSDN 主题“[如何添加对 Web 服务的引用](http://msdn.microsoft.com/en-us/library/bb628649.aspx)”应该可以帮助您生成代理并避免使用上述所有代码。

# sql - 在 pl/sql 中查询

> ID：14341687
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:00:42.500
> 
> 标签：sql, oracle, plsql

我试图在 pl/sql 中写一个查询我知道它应该是这个顺序

宣布 。. 开始 。. 结尾 。跑;

我这样做了，但结束后我遇到了一个奇怪的问题。oracle 在点下方标记一条红线和单词“end”的结尾，当我将鼠标放在该行上时，它说“语法错误，预期：标识符名称 name_wo_function_call”

这是我的代码

```
DECLARE
          temp_m model.model%TYPE;
          temp_mn model.modelnum%TYPE;
          temp_cap model.capacity%TYPE;
          temp_we model.weight%TYPE;
          CURSOR temp IS SELECT *  FROM model WHERE (weight>40) FOR UPDATE;
          CURSOR temp2 IS  SELECT model_num,COUNT(id)
                                            FROM TECH_MO
                                            GROUP BY model_num
                                            HAVING COUNT(id)>1;
BEGIN
          OPEN temp;
          OPEN temp2;
          LOOP
              FETCH temp INTO temp_m,temp_mn,temp_cap,temp_we;
              dbms_output.put_line(temp_m);
               EXIT WHEN temp%notfound;
          END LOOP;
          CLOSE temp;
          CLOSE temp2;
END;
.
RUN; 
```

谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:14:49.340

不知道你从哪里得到 .RUN ，因为这不是语法的一部分。在脚本中执行此操作的方法是这样的。

```
DECLARE
  ...
BEGIN
  ...
EXCEPTION
  ...
END;
/ 
```

（例外部分是可选的）

关于没有看到我怀疑的输出的问题是因为您没有设置服务器输出。您可以在 SQL*Plus 中这样做。

```
SET SERVEROUTPUT ON 
```

# python - 如何使用补丁相对路径进行模拟？

> ID：14341689
> 
> 赞同：28
> 
> 时间：2013-01-15T16:00:44.980
> 
> 标签：python, unit-testing, mocking

我在 python 测试文件中有这样的东西：

```
from mock import patch,
from ..monkey import ook
[...]
@patch('monkey.ook', Mock(return_value=None))
def test_run_ook (self, mock_ook):
    self.assertIsNone(ook())
    mock_ook.run.assert_called_once_with('') 
```

当我运行这个测试时，我得到一个`ImportError: No module named monkey`. 显然，我正在修补的路径不正确。`sys.path`但是，我不确定如何在不弄乱or的情况下使其正确`PYTHONPATH`。

任何指针？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-05-24T11:48:19.247

我使用了 Dan Passaro 的解决方案，直到我遇到了这个使用[`patch.object`](https://docs.python.org/3/library/unittest.mock.html#patch-object)- 这对我来说看起来更好：

```
from unittest.mock import patch,
from .. import monkey
[...]
@patch.object(monkey, 'ook', Mock(return_value=None))
def test_run_ook (self, mock_ook):
    self.assertIsNone(monkey.ook())
    mock_ook.run.assert_called_once_with('') 
```

好处：

*   不需要样板代码`__name__ + '.object_to_be_mocked'`
*   测试用例的所有依赖项都在文件开头作为`import`语句明确说明。
*   如果您尝试模拟的对象的虚线名称较长（例如“amazon.jungle.monkey.ook”）并且您因此编写`@patch.object(amazon.jungle.monkey, 'ook', …)`，您的 IDE 的静态代码分析可以确保至少`amazon.jungle.monkey`是一个有效的变量因为你没有把整个事情写成一个字符串`'amazon.jungle.monkey.ook'`。

缺点：

*   你不能做`from ..monkey import ook`，但需要做`from .. import monkey`和访问`ook`，`monkey`即`monkey.ook`。在我需要经常写这个的情况下，`ook = monkey.ook`为了方便起见，我会在测试的开头添加。（或者甚至是 import 语句，以防我不需要模拟 . 的这个特定属性`monkey`。）

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-06-26T15:56:04.760

从我收集到的信息来看，使用 mock 时，您*需要*在修补时提供一个带点的名称。`__name__`幸运的是，每个模块都可以访问一个包含模块名称的特殊模块级变量。使用这个，如果你想修补你的模块的本地变量，你*应该*能够做如下的事情：

```
import mock
import unittest

ook = lambda: "the ook"

class OokTest(unittest.TestCase):

    def test_ook(self):
        with mock.patch(__name__ + '.ook', return_value=None):
            self.assertIsNone(ook())
        self.assertEquals(ook(), "the ook")

    # the patch decorator should work the same way, I just tend to use the
    # context manager out of personal preference
    @mock.patch(__name__ + '.ook', return_value=None)
    def test_ook_2(self, mock_ook):
        self.assertIsNone(ook()) 
```

假设您已将该文件保存为`quicktest.py`，则单元测试会给出以下结果：

```
$ python -m unittest quicktest
..
----------------------------------------------------------------------
Ran 2 tests in 0.001s

OK 
```

当然，在你的包中`from a.b import c`给你一个普通的变量`c`，所以同样的机制应该可以工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-11-30T10:54:46.900

基于公认的答案，我相信这是实现预期目标的最干净的方法：

```
from mock import patch
from .. import monkey

@patch(monkey.__name__+'.ook', Mock(return_value=None))
def test_run_ook (self, mock_ook):
    self.assertIsNone(monkey.ook())
    mock_ook.run.assert_called_once_with('') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-03T06:38:11.770

不确定这是否是最好的方法（甚至推荐），但一种方法是使用类似的方法：

```
from mock import patch,
from ..monkey import ook
[...]

package_base = __package__.rsplit('.', 1)[0]

@patch('{0}.monkey.ook'.format(package_base), Mock(return_value=None))
def test_run_ook (self, mock_ook):
    self.assertIsNone(ook())
    mock_ook.run.assert_called_once_with('') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-24T13:12:30.790

当你`from ..monkey import ook`从一个模块中完成`pkg1.pgk2.mymodule`时，你最终得到的是`pkg1.pgk2.mymodule.ook`.

现在`ook`是在您执行`from ... import ...`. 这就是您需要修补的目标。

所以你只需修补`pkg1.pkg2.mymodule.ook`：

```
from unittest.mock import patch # mypackage.mymodule.patch
from ..monkey import ook        # mypacket.mymodule.ook

with patch("pkg1.pgk2.mymodule.ook"):
   .... 
```

正如其他人所指出的，如果您从执行导入的同一模块进行修补，那么您可以使用`__name__`来获取带点的包名称，但如果您从另一个模块进行修补，则需要将其拼写出来。

请记住，您导入的任何内容都可以从 target 修补`modulethatimports.nameimported`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T17:15:10.537

我认为这是因为您不 import`monkey`而是 import `ook`。如果你从那里导入猴子，`..`它应该可以工作。否则，只需调用 patch on `ook`。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-15T16:20:03.263

使用完整的导入路径。例如，如果你有这个文件系统：

*   根/
    *   假人/
        *   富/
            *   模块.py
    *   假人2/
        *   模块2.py

您可以使用以下命令从 module2.py 导入 module.py：

```
from root.dummy.foo import module 
```

# c# - DataGrid 就地编辑器，例如基于 ComboBox 的 MemoEdit

> ID：14341691
> 
> 赞同：0
> 
> 时间：2013-01-15T16:00:45.533
> 
> 标签：c#, wpf, data-binding, wpf-controls, wpfdatagrid

我的目标是在 WPF 数据网格列中创建一个就地编辑器来编辑大文本。

我的数据源是一个 DataTable，它可以包含来自不同表和字段的数据，这就是为什么我没有任何定义的类型可以绑定。在我的示例中，它有 1 个名为“Test”的列。现在我编写了一些 XAML 代码来定义我的列：

```
<ControlTemplate x:Key="ExtendedTemplate">
    <StackPanel>
        <TextBox Text="{Binding Test}" Width="200" Height="100" AcceptsReturn="True" TextWrapping="Wrap"/>
    </StackPanel>
</ControlTemplate>                

<DataGrid x:Name="grid" ItemsSource="{Binding}" AutoGenerateColumns="False">
    <DataGrid.Columns>
        <DataGridTemplateColumn Header="TEST Column" Width="200">
            <DataGridTemplateColumn.CellEditingTemplate>
                <DataTemplate>
                    <ComboBox IsDropDownOpen="True">
                        <ComboBoxItem Template="{StaticResource ExtendedTemplate}"/>
                    </ComboBox>
                </DataTemplate>
            </DataGridTemplateColumn.CellEditingTemplate>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Test}"/>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid> 
```

这是我的测试数据源：

```
Source = new DataTable("Test");
Source.Columns.Add("Test");
Source.Rows.Add("Item 1 - large amount of text ...");
Source.Rows.Add("Item 2");
Source.Rows.Add("Item 3");
grid.DataContext = Source; 
```

这很好用，但我需要做的最后一件事是在网格单元处于编辑模式时装饰网格单元，并且我在扩展组合中输入文本：

[![截屏](../Images/c5bd911ffcff6480161b8993700d5f79.png)](https://i.stack.imgur.com/ha55p.png)

这很重要：首先 - 组合框未绑定到任何 ItemsSource，但任何单元格都存在单个 ComboBoxItem 并包含来自该单元格的文本。

第二 - 我无法将 DataTemplate 定义为 SelectedItem，因为 ComboBox.SelectionBoxItemTemplate 属性是只读的。

有谁知道我怎样才能将 SelectionBoxItem 的数据模板替换为这样的东西？

```
<DataTemplate>
    <TextBlock Text="{Binding Test}"/>
</DataTemplate> 
```

我尝试使用命令“编辑模板 - 编辑副本...”为组合框创建自定义样式。有很多标记，我不想在这里发布。这是我编辑的一小部分。

```
<ContentPresenter ContentTemplate="{StaticResource SimplestTemplate}" 
                  ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" 
                  Content="{TemplateBinding SelectionBoxItem}" 
                  ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                  IsHitTestVisible="false"
                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                  VerticalAlignment="Stretch"
                  HorizontalAlignment="Stretch"/> 
```

它不起作用，因为 id 不知道如何编写应该将数据绑定到我的“测试”字段的“简单模板”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:50:42.287

我通过创建一种派生自`ComboBox`并覆盖其`ContentPresenter` `ContentTemplate`. 它工作正常，但我停止了我的工作，因为有许多额外的功能需要实现（例如调整弹出编辑器的大小、自动刷新网格单元格、将命令分配给热键以仅使用键盘编辑器等） . 最后我决定使用第三方组件（[这个](http://www.devexpress.com/Products/NET/Controls/WPF/Editors/memo-editor.xml)）。

作为对我的问题的回答，我发布了我的最终 XAML 标记：

资源：

```
<Window.Resources>

    <DataTemplate x:Key="SimplestTemplate">
        <Grid>
            <TextBlock Background="White" Foreground="Black" Text="{TemplateBinding Content}"/>
        </Grid>
    </DataTemplate>

    <ControlTemplate x:Key="ExtendedTemplate">
        <StackPanel>
            <TextBox Text="{Binding Test}" MinHeight="100" Height="Auto" MinWidth="{TemplateBinding Width}" Width="{Binding MinWidth}" TextWrapping="Wrap"/>
        </StackPanel>
    </ControlTemplate>                

    <Style x:Key="MyComboBoxStyle" TargetType="{x:Type ComboBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ComboBox}">
                    <Grid x:Name="MainGrid" SnapsToDevicePixels="true">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" Width="0"/>
                        </Grid.ColumnDefinitions>
                        <Popup x:Name="PART_Popup" AllowsTransparency="true" Grid.ColumnSpan="2" IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}" Margin="1" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Placement="Bottom">
                            <Themes:SystemDropShadowChrome x:Name="Shdw" Color="Transparent" MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{Binding ActualWidth, ElementName=MainGrid}">
                                <Border x:Name="DropDownBorder" BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}" BorderThickness="1" Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">
                                    <ScrollViewer x:Name="DropDownScrollViewer">
                                        <Grid RenderOptions.ClearTypeHint="Enabled">
                                            <Canvas HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
                                                <Rectangle x:Name="OpaqueRect" Fill="{Binding Background, ElementName=DropDownBorder}" Height="{Binding ActualHeight, ElementName=DropDownBorder}" Width="{Binding ActualWidth, ElementName=DropDownBorder}"/>
                                            </Canvas>
                                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Border>
                            </Themes:SystemDropShadowChrome>
                        </Popup>
                        <ContentPresenter ContentTemplate="{StaticResource SimplestTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" 
                                          Content="{TemplateBinding help:ComboboxHelper.BindedText}" 
                                          ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"                                               
                                          IsHitTestVisible="false"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          VerticalAlignment="Stretch"
                                          HorizontalAlignment="Stretch"
                                          Grid.ColumnSpan="2"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>      
</Window.Resources> 
```

网格列模板：

```
<DataGridTemplateColumn Header="TEST Column" Width="200">
    <DataGridTemplateColumn.CellEditingTemplate>
        <DataTemplate>
            <ComboBox IsDropDownOpen="True" Style="{StaticResource MyComboBoxStyle}" FocusVisualStyle="{x:Null}" help:ComboboxHelper.BindedText="{Binding Test}">
                <ComboBoxItem Template="{StaticResource ExtendedTemplate}"/>
            </ComboBox>
        </DataTemplate>
    </DataGridTemplateColumn.CellEditingTemplate>
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Test}" TextTrimming="CharacterEllipsis"/>
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

为了在单元格中显示剪切的文本，我创建了一个简单的附加属性。它会剪切`"\n"`文本中的所有符号以使其成为单行。

```
public static class ComboboxHelper
{
    public static readonly DependencyProperty BindedTextProperty = DependencyProperty.RegisterAttached("BindedText", typeof(string), typeof(ComboboxHelper));

    public static string GetBindedText(DependencyObject obj)
    {
        string s = (string)obj.GetValue(BindedTextProperty);
        s = s.Replace(Environment.NewLine, " ");
        return s;
    }

    public static void SetBindedText(DependencyObject obj, string value)
    {
        obj.SetValue(BindedTextProperty, value);
    }
} 
```

# android - 如何从android应用程序调试共享库[单独项目]

> ID：14341696
> 
> 赞同：5
> 
> 时间：2013-01-15T16:01:09.070
> 
> 标签：android, eclipse, debugging, android-ndk

我正在开发一个 android 应用程序并在项目中使用密集的 c++ 代码，首先我将 c++ 源代码放入项目中，并使用以下指南在 Android 应用程序中具有 Native Debugging 的 NDK 能力。

[http://tools.android.com/recent/usingthendkplugin](http://tools.android.com/recent/usingthendkplugin)

但是在开发的弱点之后，我决定将 Native 代码分离到一个独立的项目中，并在 Android Application 中使用输出 SO 。

**我的问题是如何调试作为 Android 应用程序中单独项目的结果的 SO 库？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:28:20.463

为此使用 nkd-gdb（您的 .so 必须包含在您为应用程序安装的 APK 中，位于应用程序特定 .so 文件的正常位置）它是 NDK 的一部分。请参阅 $NDK/docs/NDK-GDB.html

但是，请注意：nkd-gdb 只会在应用程序启动后的某个时间将 GDB 附加到您的 .so 中。因此，您可能会错过一些断点。在 IDE 插件之外，我知道解决该问题的两种方法：

1.  在 .so 的最早入口点放置一个无限循环，然后在设置断点后使用 GDB 打破该无限循环
2.  [从https://android-review.googlesource.com/#/c/48029/](https://android-review.googlesource.com/#/c/48029/)下载我的待定更新到 ndk-gdb，它修复了这个问题 （有人报告我的修复有问题，所以它没有被批准AOSP 尚未...但我从未重现过他们的问题。如果您使用它，请告诉我，它是否适合您。）

# json - 如何使用 json 元素列表构建烧瓶模板？

> ID：14341705
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:01:42.753
> 
> 标签：json, templates, flask

我很确定这应该很容易。我正在使用 Flask，并且正在构建一个获取 jeson 元素列表的模板。我希望建立一个以有序方式列出这些元素的表，并读取列表中每个 json 元素的特定属性。我一直在使用的代码如下：

```
<body>
  <div class="container-fluid">
   <h1> Users are: </h1>
   <table>
    <tr>
        <th>user name</th>
        <th>user fb_id</th>
        <th>user mt_id</th>
        <th>user ts_last_show_request</th>
    </tr>
    {% for item in users %}
    <tr>
        <td>item[fb_name]</td>
        <td>item[fb_uid]</td>
        <td>item[mt_uid]</td>
        <td>item[ts_last_show_request]</td>
    </tr>
    {% endfor %}
   </table>
  </div>
</body> 
```

但是这段代码只是创建了一个漂亮的表格标题，其中包含一个不解释“item [mt_uid]”命令的相同行列表，而只是列出了它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:07:16.633

你需要这样做：

```
<tr>
  <td>{{ item[fb_name] }}</td>
  <td>{{ item[fb_uid]  }}</td>
  <!-- etc. -->
</tr> 
```

# vim - 用#ifdef 包围多个选定的行

> ID：14341709
> 
> 赞同：1
> 
> 时间：2013-01-15T16:01:54.140
> 
> 标签：vim

我正在尝试编写一个宏，它允许我用#ifdef 包围当前突出显示的文本行。理想情况下，将光标放在#ifdef 之后以准备输入宏名称。我可以录制以创建宏，但我只能为一行代码做到这一点。

前：

```
 bool first_selected_line = false;
    int second_selected_line = 0; 
```

后：

```
#ifdef // if possible, cursor placed here in insert mode
    bool first_selected_line = false;
    int second_selected_line = 0;
#else
    bool first_selected_line = false;
    int second_selected_line = 0;
#endif 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:42:18.110

您可以按照以下方式做一些事情：

```
qjc#ifdef<esc>magpO#else<esc>gpO#endif<esc>`aq 
```

基本上：

*   开始录制`qj`
*   删除您选择的内容并进入插入模式`c`
*   键入您的构造，根据需要粘贴您的代码
*   您在键入 #ifdef 后添加一个标记 ( `ma`) 并在最后跳回它
*   重复宏`@j`

希望这个例子有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:50:30.807

我可能会使用 snipmate 或其他一些插件来完成这项任务。不过，有几种方法可以手动进行。这是我的宏解决方案：

目视选择文本，然后...

```
qqc#ifdef 
<C-r><C-o>"
#else
<C-r><C-o>"
#endif<esc>'[A<C-o>q 
```

如果您不想，您也不必在视觉上选择文本。使用相同的宏，但改为以开头`qqcj`。

# android - 从 Activity 向 TabHost 的 Fragment 发送消息

> ID：14341712
> 
> 赞同：0
> 
> 时间：2013-01-15T16:01:59.660
> 
> 标签：android

我有一个`Activity`其中包含一个`Fragment`。`Fragment`包含一个包含其他`TabHost`几个`Fragments`。`Activity`我需要向其中一个`TabHost`s发送消息`Fragment`，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:20:29.090

您可以观察者模式在您的活动中实现观察者接口，然后您可以将您的片段注册为可观察对象。现在如果你想向活动发送数据，你可以使用**notifyObserver** (object dataYouWantToSend) 并调用 hasChanged **(** )。
这应该由您的活动识别，其中接口方法**更新**将接收数据。

我建议创建一个自定义的可观察对象，您可以覆盖 notifyChange 方法并直接添加 hasChanged() 方法。覆盖的方法看起来像这样。

```
notifyChange(Object data) {
  super.notifyObservers(data);
  setChanged();
} 
```

# html - 使用 CSS 选择器查找与另一个 ID 相同但类不同的元素

> ID：14341716
> 
> 赞同：1
> 
> 时间：2013-01-15T16:02:17.070
> 
> 标签：html, css, css-selectors

我正在使用一个 HTML 文档，该文档使用灯箱实现来查看图像，并且由于与其 API 相关的原因，它在两个位置使用相同的元素 ID——一个用于缩略图视图，一个用于灯箱/完整视图。（这些元素位于单独的`<div>`标签中。）

这两个元素具有不同的类值，我想知道在编写选择器时如何区分它们？它类似于`#myElementWithDuplicateID.className1`and`#myElementWithDuplicateID.className2`吗？

一般来说，对页面上的不同元素使用相同的 ID 是不好的做法，还是有我不知道的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:23:42.383

重复 ID 在 HTML 文档中无效，尤其会导致脚本问题，因此使用它们被广泛认为是不好的做法。在任何情况下，拥有一个公共 ID 的元素比拥有一个公共类更合理。如果可以的话，您应该更正重复的 ID，以防止您的灯箱 API 和其他地方出现潜在的并发症。

也就是说，在您*无法*对 ID 进行重复数据删除的情况下，您提出的解决方案（链接 ID 和类选择器）将起作用。CSS 中的单独 ID 选择器将匹配具有给定 ID 的所有元素，无论它们是否重复，因此使用类选择器来区分它们是合理的。[进一步阅读。](https://stackoverflow.com/questions/7262195/several-elements-with-the-same-id-responding-to-one-css-id-selector/8753329#8753329)

# .net - [SQLServer JDBC Driver]对等连接重置：套接字写入错误

> ID：14341717
> 
> 赞同：1
> 
> 时间：2013-01-15T16:02:19.790
> 
> 标签：.net, sql-server, iis

我收到以下错误。让我知道出现此错误的可能原因。我没有应用程序代码。每当我们得到这个错误。我们重新启动应用程序。不是数据库服务器。它得到解决。让我知道是什么导致此错误发生？

```
(:initial ( (:initial java.sql.SQLException: [Vignette Corp.][SQLServer JDBC Driver]Connection reset by peer: socket write error)(:msg [Vignette Corp.][SQLServer JDBC Driver]Connection reset by peer: socket write error[1.65.143884]) ))(:msg remote queue failure) )
    at com.intraspect.objrel.collect.RemoteQueue.size(RemoteQueue.java:237)
    at com.intraspect.objrel.collect.LocalSharedQueue.size(LocalSharedQueue.java:98)
    at com.intraspect.scapi.datamodel.PersistentSharedQueue.size(PersistentSharedQueue.java:166)
    at com.intraspect.scapi.datamodel.Notification.processNotifications(Notification.java:287)
    at com.intraspect.scapi.datamodel.Notification.dailyProcessNotifications(Notification.java:263)
    at com.intraspect.background.NotificationHandler$1.doit(NotificationHandler.java:32)
    at com.intraspect.database.WrapTransaction.withCommandStateNew(WrapTransaction.java:251)
    at com.intraspect.database.WrapTransaction.withCommandState(WrapTransaction.java:212)
    at com.intraspect.database.WrapTransaction.withCommandState(WrapTransaction.java:107)
    at com.intraspect.database.WrapTransaction.withCommandState(WrapTransaction.java:92)
    at com.intraspect.database.WrapTransaction.withCommandState(WrapTransaction.java:83)
    at com.intraspect.database.WrapTransaction.withCommandState(WrapTransaction.java:76)
    at com.intraspect.background.NotificationHandler.dailyNotificationReporting(NotificationHandler.java:39)
    at com.intraspect.background.NotificationHandler.doIt(NotificationHandler.java:14)
    at com.intraspect.background.BackgroundJobHandler.run(BackgroundJobHandler.java:92)
Caused by: ( (:initial java.sql.SQLException: [Vignette Corp.][SQLServer JDBC Driver]Connection reset by peer: socket write error)(:msg [Vignette Corp.][SQLServer JDBC Driver]Connection reset by peer: socket write error[1.65.143884]) )
    at com.intraspect.objrel.db.jdbc.JDBCUtil.wrapException(JDBCUtil.java:68)
    at com.intraspect.objrel.db.jdbc.JDBCUtil.wrapException(JDBCUtil.java:27)
    at com.intraspect.objrel.db.jdbc.JDBCAttribute.fetchCollectionElements(JDBCAttribute.java:658)
    at com.intraspect.objrel.db.relational.RAttribute.fetchCollectionElements(RAttribute.java:111)
    at com.intraspect.objrel.db.jdbc.JDBCDatabase.loadQueue(JDBCDatabase.java:856)
    at com.intraspect.objrel.remote.collect.RRemoteQueue.<init>(RRemoteQueue.java:48)
    at com.intraspect.objrel.remote.collect.RQueueMgr.getQueue(RQueueMgr.java:250)
    at com.intraspect.objrel.remote.collect.RQueueMgr.size(RQueueMgr.java:318)
    at com.intraspect.objrel.collect.RemoteQueue.size(RemoteQueue.java:234)
    ... 14 more
Caused by: java.sql.SQLException: [Vignette Corp.][SQLServer JDBC Driver]Connection reset by peer: socket write error
    at com.vignette.jdbc.base.BaseExceptions.createException(Unknown Source)
    at com.vignette.jdbc.base.BaseExceptions.getException(Unknown Source)
    at com.vignette.jdbc.base.BaseExceptions.getException(Unknown Source)
    at com.vignette.jdbc.sqlserver.tds.TDSRPCRequest.submitRequest(Unknown Source)
    at com.vignette.jdbc.sqlserver.tds.TDSRPCNonCursorExecuteRequest.submitPrepExec(Unknown Source)
    at com.vignette.jdbc.sqlserver.tds.TDSRPCExecuteRequest.doPrepExec(Unknown Source)
    at com.vignette.jdbc.sqlserver.tds.TDSRPCExecuteRequest.execute(Unknown Source)
    at com.vignette.jdbc.sqlserver.SQLServerImplStatement.execute(Unknown Source)
    at com.vignette.jdbc.base.BaseStatement.commonExecute(Unknown Source)
    at com.vignette.jdbc.base.BaseStatement.executeQueryInternal(Unknown Source)
    at com.vignette.jdbc.base.BasePreparedStatement.executeQuery(Unknown Source)
    at com.intraspect.objrel.db.jdbc.JDBCAttribute.fetchCollectionElements(JDBCAttribute.java:642)
    ... 20 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:44:23.867

在 TDS 服务器（即 Microsoft 或 Sybase）上发生这种情况的最可能原因是应用程序在完成处理前一个查询的结果之前尝试发送一个新查询。如果您的应用程序可以跨 DBMS 产品移植，那么它很可能会以这种方式运行，因为其他 DBMS 产品没有这种限制。

您可能还会发现这个[FreeTDS 常见问题解答](http://www.freetds.org/faq.html#pending)条目很有趣。

# ruby-on-rails - Rails 3.2.8 路由错误

> ID：14341718
> 
> 赞同：0
> 
> 时间：2013-01-15T16:02:20.423
> 
> 标签：ruby-on-rails, rails-routing

几个小时前开始使用 Rails 的敏捷 Web 开发一书开始学习 Rails，并立即遇到了障碍。

创建了一个名为 Say 的控制器，使用： `rails generate controller Say hello goodbye`

然后我试图点击 URL `http://localhost:3000/Say/hello`，但它说：

`No route matches [GET] "/Say/hello"`

我的 routes.rb 看起来也不错（至少从同一问题的其他答案来看）：

```
Demo::Application.routes.draw do
  get "say/hello"

  get "say/goodbye"
end 
```

有什么帮助吗？只是无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:03:55.660

看起来像大写错误。你能去吗

```
http://localhost:3000/say/hello 
```

say中的小写s

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:07:19.780

它区分大小写。尝试到达它`http://localhost:3000/say/hello`

# c# - 使用 odata 更新任何属性

> ID：14341727
> 
> 赞同：0
> 
> 时间：2013-01-15T16:02:46.320
> 
> 标签：c#, .net, entity-framework, wcf-data-services, odata

你知道我如何在没有实体的关键属性的情况下使用 OData 语法更新 WCF 数据服务中的实体。

例如，一个实体：

```
public class Product
{
    [Key]
    public int Id { get; set; }

    public string Reference { get; set; }
} 
```

我想提出这个要求：

```
PUT myservice.svc/Product('REFXX') 
```

与 'REFXXX' 对应的做参考属性（这是唯一的）。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:58:03.330

目前没有办法做到这一点 - 问题是如果您将以下请求传递给服务器 (PUT myservice.svc/Product('REFXX'))，服务器如何知道 REFXX 是唯一属性的值和不是关键属性。

如果您真的想根据唯一属性更新客户端，请确保服务器将该唯一属性公开为键。

谢谢普拉蒂克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T16:32:45.007

我写了一个IDispatchMessageInspector，解析url并用正确的语法和真正的键替换请求参数中的匹配元素。我知道密钥不是具有特定用户代理或语法 Service.svc/Entity(SecondaryKey=value) 的真正“密钥”，通常用于多个 pk。

所以在方法 AfterReceiveRequest 中的过程是：

*   解析 url Service.svc/Entity(SecondaryKey=value)
*   获取实体的键值（通过构建动态 linq 表达式）
*   使用 Service.svc/Entity(PKValue) 更改请求的匹配元素

    ```
     public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext)
    {

        if (request.Properties.ContainsKey("UriTemplateMatchResults") && HttpContext.Current != null)
        {
            //get match for current request
            UriTemplateMatch match = (UriTemplateMatch)request.Properties["UriTemplateMatchResults"];

            Utils.ODataBasicUriParser uriParser = new Utils.ODataBasicUriParser(match.RequestUri.PathAndQuery);

            //verify if this is a SecondaryKey request
            if (uriParser.IsEntityQuery && uriParser.IsSecondaryKeyQuery)
            {               
                //TODO this syntax is also used for entities with multiple pk's, test it

                //get a new data context
                //TODO see if this can be improved, avoid two datacontext for one request 
                DataContext ctx = new DataContext();

                Type outType;
                //get entity type name from the service name 
                string entityName = DataContext.GetEntityNameByServiceName(uriParser.EntityServiceName);

                //get the pk for the entity
                string id = ctx.GetEntityId(entityName, uriParser.EntityKey, uriParser.EntityId, out outType);

                //verify if the pk has been found or cancel this to continue with standart request process
                if (string.IsNullOrEmpty(id))
                {
                    Trace.TraceWarning(string.Format("Key property not found for the the entity:{0}, with secondaryKeyName:{1} and secondaryKeyValue:{2}",
                        entityName, uriParser.EntityKey, uriParser.EntityId));

                    return System.Net.HttpStatusCode.NotFound;
                }

                //in odata syntax quotes are required for string values, nothing for numbers
                string quote = outType.FullName == typeof(Int32).FullName || outType.FullName == typeof(Int64).FullName ? string.Empty : "'";

                //build the new standart resource uri with the primary key
                var newUri = new Uri(string.Format("{0}/{1}({2}{3}{2})", match.BaseUri.ToString(), uriParser.EntityServiceName, quote, id));

                //create a new match to replace in the current request, with the new Uri
                UriTemplateMatch newMatch = NewMatch(match, newUri); 

                //set request values
                request.Properties["UriTemplateMatchResults"] = newMatch;
                request.Headers.To = newUri;
                request.Properties.Via = newUri;
            }
        }

        return null;
    }

    UriTemplateMatch NewMatch(UriTemplateMatch match, Uri newUri)
    {
        UriTemplateMatch newMatch = new UriTemplateMatch();
        newMatch.RequestUri = newUri;
        newMatch.Data = match.Data;
        newMatch.BaseUri = match.BaseUri;

        return newMatch;
    } 
    ```

适用于我当前的需求

# symfony - 如何在 Symfony 上格式化日期值？

> ID：14341729
> 
> 赞同：2
> 
> 时间：2013-01-15T16:02:52.063
> 
> 标签：symfony

我从 facebook 用户对象中获取数据，生日字段具有以下格式：**MM/DD/YYYY**。在 Symfony2 中使用学说我定义我的生日字段，如：

```
/**
 * @var \Date $birthday
 *
 * @ORM\Column(name="birthday", type="date", nullable=true)
 */
private $birthday; 
```

这在数据库上生成格式**YYYY-DD-MM**，我试图将 facebook 格式格式化为我可以与 symfony 一起使用但没有成功的东西，这是我的尝试：

```
if(isset($fbuser["birthday"]))  {                   //CHECK FOR FIELD birthday
   $date_pz = explode('/',$fbuser["birthday"]);
   // Firts try: $norm_date = array('year' => $date_pz[2], 'month' => $date_pz[0], 'day' => $date_pz[1]);
   // Second try: $norm_date = $date_pz[2] .'-'. $date_pz[0] .'-'. $date_pz[1]);
   $userinfo->setBirthday($norm_date); } 
```

我总是得到：

> 致命错误：在第 44 行的 /var/www/vhosts/punctis.com/httpdocs/vendor/doctrine/dbal/lib/Doctrine/DBAL/Types/DateType.php 中的非对象上调用成员函数 format()

这意味着我没有以 Symfony 期望的格式发送字符串，所以这里的问题是，如何格式化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-16T21:05:16.303

如果您有这样的 var 输出：

```
 echo '<pre>';
 print_r($yourDateTimeObjectVar);die;

//outputs;
DateTime Object
(
  [date] => 2013-12-16 15:17:27
  [timezone_type] => 3
  [timezone] => America/New_York
) 
```

然后，你只需要做：

```
echo $yourDateTimeObjectVar->format('d/m/Y'); 
```

这将输出：

2013 年 12 月 16 日

PS：在这种情况下，对象来自 MySql 日期时间列，它是这样插入的：

```
$myOrder = new OrderStatus();
$myOrder->setDateOrder(\new DateTime());
$em->persist($myOrder);
$em->flush() 
```

Var ORM 声明：

```
 @ORM\Column(name="DateOrder", type="datetime", nullable=true) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:09:42.300

Doctrine-Type`Date`期待 aa `DateTime`-object。您可以`DateTime::createFromFormat()`用来创建所述对象。

您可以在您的实体（例如 in `setBirthday($birthday)`）中执行此操作，或者创建一个自定义 DateType 来为您进行格式化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:10:08.547

您不应该将字符串传递给**$userinfo->setBirthday($norm_date)**而是传递**DateTime 对象**，尝试

```
 $userinfo->setBirthday(new \DateTime($norm_date));
 $userinfo->setBirthday(new \DateTime('now'));
 $userinfo->setBirthday(new \DateTime('2013-01-15'));
 $userinfo->setBirthday(new \DateTime('+2 days'), new \DateTimeZone('UCT')); 
```

您可以通过多种方式构造**DateTime**对象，请在此处查看文档：http: [//php.net/manual/en/datetime.construct.php](http://php.net/manual/en/datetime.construct.php)

# javascript - 为子元素添加类取决于 jQuery 的输入值

> ID：14341734
> 
> 赞同：1
> 
> 时间：2013-01-15T16:02:58.490
> 
> 标签：javascript, jquery, parent, children, fieldset

我有两个`fieldsets`：

```
<fieldset class="checkable">
   <span class="as_cp_checkbox"></span>
   <input type="hidden" name="register_condition_01" id="register_condition_01" value="no">
   <label for="register_condition_01">data</label>
</fieldset>
<fieldset class="checkable">
   <span class="as_cp_checkbox"></span>
   <input type="hidden" name="register_condition_02" id="register_condition_02" value="yes">
   <label for="register_condition_02">data</label>
</fieldset> 
```

现在：如果我的输入值为是，我需要添加`checked`类。`span.as_cp_checkbox`我尝试这样做，但每次这个类都附加为 first `fieldset`。

```
var checkable_fieldset = $('fieldset.checkable'),
    checkable_fieldset_input = checkable_fieldset.find('input');
if (checkable_fieldset_input.val('yes')){
    checkable_fieldset_input.parent(checkable_fieldset).prev().children('span').addClass('checked');
} 
```

我如何为这个 prev 添加`span`具有`input`yes 值的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:07:03.150

您可以这样做以将类添加到其值为 的输入之前的`checked`所有内容：`'span.as_cp_checkbox'``"yes"`

```
$('input').filter(function(){return $(this).val()=="yes";})
 .prev('span.as_cp_checkbox')
 .addClass('checked'); 
```

[示范](http://jsbin.com/ifatak/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:06:32.030

`checkable_fieldset_input.val('yes')`将值设置为是。你需要做`checkable_fieldset_input.val() == 'yes'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:07:57.930

您在 if 语句中的条件应为

```
checkable_fieldset_input.val() == 'yes' 
```

现在您正在**分配**值是。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-15T16:08:37.440

```
$('fieldset.checkable input').each(function(_, input){
    if($(input).val() == 'yes')
    {
        $(input).siblings('span.as_cp_checkbox').addClass('checked');
    }
}); 
```

# python - 从 Python 中的磁盘中选择？

> ID：14341737
> 
> 赞同：0
> 
> 时间：2013-01-15T16:03:04.217
> 
> 标签：python, unix

我正在编写一个`Python`用于`dd`将操作系统映像写入 USB 闪存驱动器的程序。在我的情况下，驱动器`/dev/sda`和`/dev/sdb`已安装`sdb`的闪存驱动器是我要写入的闪存驱动器。

但是，在其他人的系统上，他们想要写入的驱动器可能是`/dev/sdc`. 如何让用户选择要写入的驱动器？为了用户友好，最好让他们按磁盘标签进行选择。

编辑：让我改写一下：我已经插入了 USB 闪存驱动器 /dev/sdb 和 /dev/sdc。我想基本上告诉用户；“您要写入哪个闪存驱动器，sdb 还是 sdc？”，然后写入用户选择的磁盘。到目前为止，我还没有找到办法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:26:46.307

你想要的绝对是`psutil`。

[https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil)

```
>>> psutil.disk_partitions()
[partition(device='/dev/sda1', mountpoint='/', fstype='ext4'), 
partition(device='/dev/sdb5', mountpoint='/media/Storage', fstype='ext4')] 
```

这为您提供有关所有已安装磁盘的信息。最重要的是，它是跨平台的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:13:06.953

如果您的程序是 *nix 特定的，我想您最好的选择是解析`mount`命令的输出。

它为您提供挂载点、用户名和 FS 名称。其中，您可以过滤当前用户已安装或至少可写的点，并在其上使用正确的 FS（可能是 vfat？）。

# iphone - dismissViewControllerAnimated:completion: 有几秒钟的延迟

> ID：14341739
> 
> 赞同：16
> 
> 时间：2013-01-15T16:03:07.037
> 
> 标签：iphone, ios, objective-c, ios6, uikit

dismissViewControllerAnimated:completion: 在我的应用程序中工作正常，除了解雇之间的延迟。

```
[api loginWithUsername:[dict objectForKey:@"username"] andPassword:[dict objectForKey:@"password"] andSuccessBlock:^(id json) {
    NSLog(@"DONE... %@", [json objectForKey:@"status"]);
    NSString *status = [json objectForKey:@"status"];
    if([status isEqualToString:@"ok"]){
        app.user = [json objectForKey:@"data"];
        [self dismissViewControllerAnimated:YES completion:nil];
    }else{
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"could not log you in" delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil];
        [alert show];
    }
}]; 
```

在我的控制台中，我可以看到回显“DONE ... ok”，这意味着回调块已执行，但是大约 3-4 秒后，模态视图最终被关闭。

什么可能导致这种延迟？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-15T18:37:14.503

如果您不保证您的 UI 代码在主线程上运行，它可能会在其他线程上运行，在这种情况下，您会遇到几秒钟的延迟！

您可以添加它以确保在主线程上运行解雇：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [self dismissViewControllerAnimated:YES completion:nil];
}); 
```

通常，这不是问题，因为您的大部分代码已经在主线程上运行，因为我们主要添加从 UIKit 方法运行的代码，例如 viewDidLoad 等。这些方法保证在主线程上运行。

当您最终在另一个线程上运行代码时，就会出现问题。可能发生这种情况的一种情况是，例如在网络库的完成块调用中，请求是在后台完成的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:04:56.120

检查`viewWillAppear`ParentViewController 的 ' `viewWillDisappear`' 和 currentViewcontroller 的 ' '。确保这两个函数内部没有任何繁重的计算和内存分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:32:06.243

尝试改变

> ```
> NSString *status = [json objectForKey:@"status"];
> NSLog(@"DONE... %@", status); 
> ```

然后尝试

> if([状态 isEqualToString:@"ok"]){
> 
> ```
>  [self dismissViewControllerAnimated:YES completion:nil];
>     app.user = [json objectForKey:@"data"];
> }else{ 
> ```

因为我不知道你的 JSON 对象有多大，它可能需要一点时间来响应，并且你在 log 语句之后再次调用它并且在说解雇之前做其他事情可能就是这样。

# api - REST API 状态更改

> ID：14341743
> 
> 赞同：1
> 
> 时间：2013-01-15T16:03:26.260
> 
> 标签：api, rest

我正在设计一个 REST API。

我有一个资源，我希望能够针对不同的条件更改其状态，例如 URI 是：

**应用程序/{application_id}/**

可能的状态更改是将应用程序设置为：

1.  取消
2.  签核
3.  抓住

每个状态更改都需要不同的信息，例如取消的原因、签署的日期。

处理这个问题的好看 URI 是什么？我曾想过

1.  **POST：应用程序/{application_id}/取消**
2.  **POST：应用程序/{application_id}/SignOff**
3.  **POST：应用程序/{application_id}/Hold**

但这对我来说似乎不对。

**编辑：**

我应该提到我已经在计划 **POST: Applications/{application_id}** 使用全套应用程序数据更新现有应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:09:52.177

**我会坚持为所有状态使用一个 url，**并让您的 Status 对象封装所有不同的属性。这些可以防止您的 url 出现看起来像动作的单词并且更加安静。

```
POST: Applications/{application_id}/status

public class Status
{
   public string StatusType {get;set;}
   public string CancelReason {get;set;}
   public string SignOffDate {get;set;}
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:05:25.413

```
POST: Applications/{application_id}?cancel=true 
```

POST 仅用于 CREATE。我认为 put 会是更好的选择。

# vba - VBA ADODB - 获取受单个查询影响的多行

> ID：14341744
> 
> 赞同：2
> 
> 时间：2013-01-15T16:03:28.680
> 
> 标签：vba, adodb, multiple-records

我正在使用 VBA 的 ADODB 连接类通过 VBA 对 SQL Server 运行更新查询。在 SQL Server 中，查询返回受影响的行，这些行可以通过 ADODB 命令类在 VBA 中访问。

但是我不知道如何返回多个记录受影响语句的数组。

我正在使用示例代码：

```
Dim ADODBconn As ADODB.Connection
Dim rsRead As New ADODB.Recordset
Dim Rslt_Count As Long

'Set Up Connection and begin SQL Transaction
Set ADODBconn = CurrentProject.AccessConnection
ADODBconn.BeginTrans

'Build Update SQL
SQLLine = "******update query that runs on multiple tables here********"

'Execute SQL
ADODBconn.Execute SQLLine, Rslt_Count, dbFailOnError

MsgBox Rslt_Count
ADODBconn.CommitTrans
ADODBconn.Close 
```

任何帮助表示赞赏。谢谢理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:02:33.877

假设您有一个存储过程：

```
CREATE PROCEDURE UpdateTables
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
    DECLARE @RowCount2 INTEGER
    DECLARE @RowCount3 INTEGER
    DECLARE @RowCount4 INTEGER

    UPDATE Table2 Set atext = 'a' WHERE atext='b' 
    SELECT @RowCount2 = @@ROWCOUNT
    UPDATE Table3 Set atext = 'a' WHERE atext='b' 
    SELECT @RowCount3 = @@ROWCOUNT
    UPDATE Table4 Set atext = 'a' WHERE atext='b' 
    SELECT @RowCount4 = @@ROWCOUNT

    SELECT @RowCount2 AS Table2, @RowCount3 AS Table3, @RowCount4 AS Table4
END 
```

根据[受 UPDATE 语句影响的返回行数](https://stackoverflow.com/questions/1103260/return-number-of-rows-affected-by-update-statements)

另请参阅：[access-SQL 传递查询（创建 SP）错误](https://stackoverflow.com/questions/12197870/access-sql-pass-through-query-creating-sp-error/12198827#12198827)

然后您可以：

```
Dim dbconn As ADODB.Connection
Dim cmd As New ADODB.Command
Dim rs As New ADODB.Recordset
Dim param As New ADODB.Parameter

Set dbconn = New ADODB.Connection
dbconn.ConnectionString = ServerConLocal

dbconn.Open 

Set cmd = New ADODB.Command
cmd.ActiveConnection = dbconn
cmd.CommandType = adCmdStoredProc
cmd.CommandText = "updatetables"

rs.CursorType = adOpenStatic
rs.CursorLocation = adUseClient
rs.LockType = adLockOptimistic
rs.Open cmd

''Records affected
For Each fld In rs.Fields
    Debug.Print fld.Name & " : " & fld
Next
End Sub 
```

您还可以使用单行简单地创建传递查询：

```
UpdateTables 
```

可能会返回：

```
 Table2  Table3  Table4
    0       2       0 
```

# javascript - 悬停在条形图中的条上时监听的事件

> ID：14341745
> 
> 赞同：0
> 
> 时间：2013-01-15T16:03:29.350
> 
> 标签：javascript, jquery, html, jquery-plugins, bar-chart

我是前端开发的新手。

有没有人遇到过一个条形图插件，当我们将鼠标悬停在任何条上时，它会弹出一个带有一些表格的模式，其中将显示一些与条相关的超链接。

当我将鼠标悬停在每个条上时，我想显示一些与条相关的 html 表格。

我如何创建一个事件来监听悬停在栏上

我也想知道我怎样才能使这个动态。在所有演示中，我看到图形值都是硬编码的。我如何使用从服务器返回的一些内容加载这些数据。

谢谢

# url - 让用户通过点击网址发送推文（本机应用程序）

> ID：14341748
> 
> 赞同：3
> 
> 时间：2013-01-15T16:03:55.597
> 
> 标签：url, mobile, android-intent, twitter

我需要一些帮助。我们有一个移动网页，想使用用户的 Native TWITTER APP (iOS/Android) 让他在 Twitter 上分享一些东西。

所以我们设置了这段代码：

```
<a href="twitter://tweet?text=I share this on Twitter from a website">Share this on Twitter</a> 
```

当点击移动网页上的链接时，移动设备向我们显示此消息：无法加载推文，稍后再试。

有人知道使用本机应用程序发送预配置推文的正确网址吗？

# caching - Varnish - 如何缓存登录用户

> ID：14341749
> 
> 赞同：3
> 
> 时间：2013-01-15T16:04:09.397
> 
> 标签：caching, varnish, varnish-vcl

我安装了清漆，一切正常。

但是，我需要缓存已登录的用户。这就是我的 VCL 中的内容：

```
backend default { 
    .host = "127.0.0.1"; 
    .port = "8080"; 
}

sub vcl_recv {   
    unset req.http.Cookie;    
    if (req.http.Authorization || req.http.Cookie) {
        return (lookup);
    }
    return (lookup);
}

sub vcl_fetch {
    unset beresp.http.Set-Cookie;
    set beresp.ttl = 24h;
    return(deliver);
} 
```

上述方法有效，但用户可以查看其他用户数据，例如假设我以 Sam 身份登录并访问页面 A。当另一个用户（例如 Angie）登录并打开页面 A 时，她看到的内容与 Sam 相同。

有没有办法可以将页面限制为实际有权查看该页面的登录用户？

我的请求标头如下：

```
Request Headersview source
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language en-US,en;q=0.5
Authorization   Basic YWRtaW46YWRtaW4=
Connection  keep-alive
Cookie  tree-s="eJzTyCkw5NLIKTDiClZ3hANXW3WuAmOuRKCECUjWFEnWIyIdJGvGlQgEegAD3hAj"; __ac="0zVm7PLtpaeQUXtm9BeYrC5%2BzobmBLPQkjRtxjyRGHs1MGY1MTgzZGFkbWluIQ%3D%3D"; 'wc.cookiecredentials'="0241d135445f7ca0b1cb7aced45da4e750f5414dadmin!" 
```

我可以使用`Authorization`请求标头上的条目来强制执行此限制吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:43:48.893

您的 VCL 当前正在做的是从请求标头中删除 Cookie 并缓存所有请求。这会导致您描述的确切行为：第一个页面加载被缓存，所有后续用户都获得缓存的内容 - 无论谁发出请求。通常，您只想为尚未登录的用户缓存内容。

您不能使用 Varnish 进行授权或访问控制。这需要由后端处理。为此，您需要识别包含相关会话信息的 cookie，并在定义了会话时保留 cookie，并在其他情况下删除 cookie。

例如：

```
sub vcl_recv {
  if(req.http.Cookie) {
    # Care only about SESSION_COOKIE
    if (req.http.Cookie !~ "SESSION_COOKIE" ) {
      remove req.http.Cookie;
    }
  }
} 
```

这样，所有包含“SESSION_COOKIE”cookie 的请求都将被传递到后端，而尚未登录的用户会从 Varnish 接收缓存副本。

如果您也希望使用 Varnish 对登录用户进行缓存，我建议您查看[Varnish 的 ESI features](https://www.varnish-cache.org/trac/wiki/ESIfeatures)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-28T14:53:40.003

它只能通过 vcl 完成 - 添加 vmod 或内联 C。

一个简单的例子：假设你有三个不同的页面，用于三个不同级别的用户：（未登录、登录、管理员）并且级别存储在 cookie 中。您可以获取 cookie 值并将 get 参数添加到 url：

[http://example.com/homepage.html?user_level=none](http://example.com/homepage.html?user_level=none)

[http://example.com/homepage.html?user_level=logged_in](http://example.com/homepage.html?user_level=logged_in)

[http://example.com/homepage.html?user_level=admin](http://example.com/homepage.html?user_level=admin)

（您的 vmod 将处理添加 '?' 或 '&' 以及名称值对到 URL 的末尾。）

所有这些通常都可以在 vmod 中完成，但也可以根据大小来完成，因为内联 C. Vmod 是首选，但内联 C 可以让您启动并运行初始测试 - 然后移至 vmod。

当 vcl_hash() 运行时，它将散列您刚刚修改的 url。Varnish 缓存现在将包含最多三个不同版本的页面。从 Varnish 的角度来看，这是三个不同的缓存对象。您可以为页面的每个变体设置不同的 TTL。

在缓存未命中时，后端 Web 服务器可以忽略您刚刚添加的这个 get 参数，或者您可以在 vcl 中的 vcl_hash() 或 vcl_backend_fetch 中将其删除。您的后端服务器通常会使用 cookie 值，而不是这个 vcl 添加的参数。

总之，您正在更改 URL 参数，以便它针对您需要的不同用户级别进行不同的哈希处理。或者，您可以只更改您的 vcl_hash() 方法以散列 cookie 值，但我发现更改 URL 更好地用于 varnishncsa 日志记录和报告。此外，如果 cookie 是加密的，那么只需修改 URL 参数，就可以使用基本的 cURL 请求更轻松地处理 PURGE 请求。如果发送 PURGE 请求的客户端是授权用户，则您的 PURGE 条件将处理。

# azure-sql-database - 将首次登录添加到 SQL Azure 数据库

> ID：14341750
> 
> 赞同：3
> 
> 时间：2013-01-15T16:04:11.580
> 
> 标签：azure-sql-database, user-management

我正在尝试创建一个 SQL Azure 数据库。成功创建数据库后，我无法登录。原因是，我不知道默认的用户名/密码是什么。或者，如何创建第一个可以访问数据库的用户。

我必须在这里缺少一些基本的东西。如何为 SQL Azure 数据库创建第一个用户。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T16:24:44.190

该数据库存在于 Azure SQL 实例上。您需要创建实例时分配的管理登录名/密码。

当您在 Azure 管理门户 ( [https://manage.windowsazure.com](https://manage.windowsazure.com) ) 中时，请转到“SQL 数据库”。

在“DATABASES”页面（在顶部），找到您的数据库。在“SERVER”列中查找数据库服务器的名称，然后单击该服务器的链接。

![Azure 管理门户中的 Azure SQL 数据库](../Images/3ee3cbeb154f0023f46b150db47bb834.png)

在服务器页面的右侧，“快速浏览”下，您将看到“管理员登录”，然后您会看到“重置管理员密码”的链接。如果您不记得它，您可以重置它。

![Azure SQL Server 登录凭据](../Images/d46fcab946cb9a232d00cd807c1b06dd.png)

现在，您可以使用这些凭据（管理员登录名/密码）登录并根据需要创建其他登录名。

希望有帮助。

# sql - SQL选择最后一组日期？

> ID：14341752
> 
> 赞同：1
> 
> 时间：2013-01-15T16:04:23.257
> 
> 标签：sql, sql-server, sql-server-2008, select, group-by

我的桌子看起来像这样：

```
Date    DataPoint      Type    Value
2000         HVAC    Phase1      220
2000         HVAC    Phase2      221
2000       SERVER    Phase1      222
2000       SERVER    Phase2      223
2001         HVAC    Phase1      220
2001         HVAC    Phase2      221
2001       SERVER    Phase1      222
2001       SERVER    Phase2      223
2002         HVAC    Phase1      220
2002         HVAC    Phase2      221
2002       SERVER    Phase1      222
2002       SERVER    Phase2      223
...
...
2013         HVAC    Phase1      220
2013         HVAC    Phase2      221
2013       SERVER    Phase1      222
2013       SERVER    Phase2      223 
```

我想获取最后日期、数据点、类型值的总和。

预期结果

```
Date    DataPoint        Value
2013         HVAC          441
2013       SERVER          445 
```

我怎样才能做到这一点？提示，起点，代码示例？

谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:07:38.537

用于[`TOP... WITH TIES`](http://msdn.microsoft.com/en-us/library/ms189463.aspx)简化：

```
SELECT TOP 1 WITH TIES Date, DataPoint, SUM(Value) AS Value
FROM YourTable
GROUP BY Date, DataPoint
ORDER BY Date DESC 
```

**[SQL小提琴](http://sqlfiddle.com/#!3/fa600/1)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:08:04.430

您还可以使用子查询来获取`max(date)`然后将其连接回主表：

```
select t1.date,
  t1.datapoint,
  sum(t1.value) Total
from yourtable t1
inner join
(
  select max(date) date,
    datapoint
  from yourtable
  group by datapoint
) t2
  on t1.date = t2.date
  and t1.datapoint = t2.datapoint
group by t1.date, t1.datapoint; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c50c1/4)

您还可以使用`sum() over()`and`row_number() over()`来获得结果：

```
select  Date,  DataPoint, total
from
(
  select Date,
    DataPoint,        
    sum(value) over(partition by DataPoint, Date) total,
    row_number() over(partition by DataPoint order by Date DESC) rn
  from yourtable
) src
where rn = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c50c1/20)

结果是：

```
| DATE | DATAPOINT | TOTAL |
----------------------------
| 2013 |      HVAC |   441 |
| 2013 |    SERVER |   445 | 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:08:49.127

```
WITH latestDate
AS
(
    SELECT  DataPoint, MAX(Date) max_DATE
    FROM tableName
    GROUP BY DataPoint
)
SELECT  a.Date, a.DataPoint, SUM(a.Value) totalValue
FROM    tableName a
        INNER JOIN latestDate b
            ON a.DataPoint = b.DataPoint AND
                a.Date = b.max_date
GROUP BY a.Date, a.DataPoint 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/c50c1/5)

感谢[BlueFeet](https://stackoverflow.com/users/426671/bluefeet)的 SQLFiddle。

# asp.net - 将网格视图导出到 Excel。为什么有些带有数字数据的列向右对齐，有些向左对齐？我如何让它们都向左对齐？

> ID：14341755
> 
> 赞同：0
> 
> 时间：2013-01-15T16:04:29.503
> 
> 标签：asp.net, gridview, export, alignment, export-to-excel

将 gridview 导出到 Excel 时，我不知道如何“强制”列全部左对齐。有些似乎自动执行此操作，而列中的其他字段将向右对齐。（该栏全是数字）我做错了什么，或者忘记做什么？

**我的 .aspx 中的按钮**

```
<asp:ImageButton ID="Button1" runat="server" Height="30px" ImageUrl="~/images/Logo.jpg" OnClick="Button1_Click" Width="28px" /> 
```

**我的代码背后**

```
private void ExportToExcel(string strFileName, GridView dg) 
    { 
        Response.Clear(); 
        Response.Buffer = true; 
        Response.ContentType = "application/vnd.ms-excel"; 
        Response.Charset = ""; 
        this.EnableViewState = false; 
        System.IO.StringWriter oStringWriter = new System.IO.StringWriter(); 
        System.Web.UI.HtmlTextWriter oHtmlTextWriter = new System.Web.UI.HtmlTextWriter(oStringWriter); 
        GridView1.RenderControl(oHtmlTextWriter); 
        Response.Write(oStringWriter.ToString()); 
        Response.End(); 
    } 
    protected void Button1_Click(object sender, EventArgs e) 
    { 
        ExportToExcel("Test.xls", GridView1); 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:13:24.877

是 Excel 解释数据并决定使用哪种对齐方式，而不是您的代码。如果这些值都是数字，我希望它们默认都是右对齐的。左对齐的可能被解释为文本，并且很可能包含空格或导致 Excel 将其视为文本的其他字符。

# php - 如何在 PHP 中跟踪代码执行？

> ID：14341757
> 
> 赞同：25
> 
> 时间：2013-01-15T16:04:31.843
> 
> 标签：php, trace

我想查看 PHP 脚本的整个代码执行的日志。像这样的东西：[http](http://en.wikibooks.org/wiki/Ruby_Programming/Standard_Library/Tracer) ://en.wikibooks.org/wiki/Ruby_Programming/Standard_Library/Tracer （因为没有更好的例子；请不要火焰）。

有什么方法可以获取PHP中的日志吗？

**注意：**我知道我可以使用调试器，但不一样。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-01-05T11:15:35.017

[phptrace](https://github.com/Qihoo360/phptrace)是一个很棒的跟踪 php 代码执行的工具

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-15T16:13:27.597

Xdebug 绝对是你想要的，但也有[来自 valgrind 套件的 callgrind 之](http://valgrind.org/docs/manual/cl-manual.html "callgrind 文档")类的东西。

Zend 博客文章应该给你一些指点：[http ://devzone.zend.com/1139/profiling-php-applications-with-xdebug/](http://devzone.zend.com/1139/profiling-php-applications-with-xdebug/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-15T16:06:00.797

在任何功能中，您都可以通过使用查看整个回溯[`debug_backtrace(...)`](http://php.net/manual/en/function.debug-backtrace.php)

或者你可以使用[Xdebug profiler](http://xdebug.org/docs/profiler)来分析你的 PHP 脚本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-12T21:05:08.687

看看[金特](https://kint-php.github.io/)。

![调试回溯截图](../Images/8ecd124bb2777364dd1fb2df171fb07e.png)

> 它是类固醇上的 var_dump() 和 debug_backtrace()。易于使用，但功能强大且可定制。您的开发工具箱的重要补充。

[它在这里](https://kint-php.github.io/kint/advanced/#integrations)也有特定于平台的扩展

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T16:32:30.083

您可以使用由 Facebook 开发的名为 XHProf 的 PHP 扩展。

> 它能够报告函数级调用计数以及包含和排除的挂墙时间、CPU 时间和内存使用情况。

[https://github.com/facebook/xhprof](https://github.com/facebook/xhprof)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-20T12:03:51.303

这是我在 windows linux 子系统（WSL）中运行 php 或 Laravel 框架时需要跟踪的所有行。

`xdebug`在系统中安装，然后`/etc/php/7.4/mods-available/xdebug.ini`使用以下详细信息进行编辑

```
zend_extension=xdebug.so
xdebug.default_enable=1
xdebug.remote_enable=1
xdebug.remote_connect_back=1
xdebug.remote_port = 9001
xdebug.scream=0
xdebug.cli_color=1
xdebug.show_local_vars=1
xdebug.remote_autostart=1

; this part here, above is used for line by line debug in vscode
xdebug.auto_trace=1
xdebug.trace_output_dir = /mnt/c/projects/www/phptraces
xdebug.trace_output_name=trace.%u
xdebug.collect_params=4
xdebug.trace_format = 1 
```

这个在这里

```
xdebug.trace_output_dir = /mnt/c/projects/www/phptraces 
```

是存储日志的路径

对于 laravel 框架，它会生成非常大的文件，很可能是 4GB 大小。所以我用

```
split -l 1000 trace.1576842503_368392.xt pieces/traces 
```

将其拆分为每个包含 1000 行的较小部分并将其存储到 pieces 目录中。

然后您可以使用编辑器在文件中查找您要查找的内容

# javascript - 使用初始实例化类进行 Jasmine 测试

> ID：14341761
> 
> 赞同：1
> 
> 时间：2013-01-15T16:04:44.540
> 
> 标签：javascript, jasmine, revealing-module-pattern

我在我的 JavaScript 中使用了显示模式和初始类实例化。我也在使用 Jasmine 来测试这个类，但需要一种方法来在每次测试运行之前重置 myNamespace.myViewModel 的状态（这是一个简单的示例，但想象一个具有多个变量的复杂视图模型）。

这是一个示例类：

```
myNamespace.myViewModel = (function(ko, $, window){
   var init = function(){},
       name = 'bob',
       nameSetter = function(value){ name = value; };
   return {
     Init: init,
     Name: name,
     NameSetter: nameSetter
   };
}(ko, $, window)); 
```

在茉莉花中，我从以下内容开始：

```
describe("VM Specs", function () {
    'use strict';
    var vm;
    beforeEach(function(){
       // the vm isn't re-created since it is a "static" class in memory
       vm = myNameSpace.myViewModel;
    });
    it("should set name", function(){
       vm.NameSetter('joe');
       expect(vm.Name === 'joe').toBeTruthy();
    });
    it("should have the default state, even after the other test ran", function(){
       expect(vm.Name === 'bob').toBeTruthy();
    });
}); 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T09:43:58.307

你不能。因为该模式所做的只是创建一个新对象，该对象在闭包中绑定了一些变量。所以即使你在你的应用程序中使用它，你也不能传递这个对象的状态，因为你不能创建它的新版本。此外，这个词`class`并没有正确描述这种模式，因为您无法从中创建新实例。所以你应该问问自己在这种情况下这是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:08:52.497

有一个`afterEach()`功能。`beforeEach()`与运行测试后的工作相同：

```
afterEach(function(){
    //reset the state here!
}); 
```

# php - 如何使用 php / mysql 显示/过滤搜索结果

> ID：14341762
> 
> 赞同：0
> 
> 时间：2013-01-15T16:04:54.430
> 
> 标签：php, mysql, database, search

我对使用 php / mysql 编码非常陌生，并且在显示链接到 sql 数据库的结果时遇到了一个小问题。

目前人们使用以下代码进行搜索 - 效果很好 - 这是一个下拉选择框，但您只能选择一个选项。我想要它，所以项目是复选框，您可以选择多个项目。

我在下面包含了人们将数据输入到数据库时使用的代码——它们是复选框——我尝试用它替换“下拉选择代码”，但它不起作用。

有谁知道我必须使用什么代码来替换“下拉选择代码”，以便可以查看复选框并且您可以过滤多个项目 - 我还包括了“结果页面代码”，它显示了结果和我我认为“ClientStage”需要在某处添加“复选框代码”。

很抱歉我缺乏这方面的知识，并会感谢一些帮助？

* * *

下拉选择代码

* * *

```
<select name="ClientStage" id="ClientStage">
            <option value=""></option>
            <?php
        include 'Easyspace.php';
        $sql = 'SELECT * FROM `clienttype`;';
        $rs = mysql_query($sql, $conn) or die ("error with sql query ".$sql);

        while ($row = mysql_fetch_array ($rs)){
            $ClienttypeID = $row["ClienttypeID"];
            $Clienttype = $row["Clienttype"];

            echo '<option value="' .$ClienttypeID. '">' .$Clienttype. '</option>'; 
        }
        ?>
          </select></span> 
```

* * *

复选框代码

* * *

```
<table width="100%" border="0" cellspacing="1">
    <?php
    $side=1;  
    $sql = 'SELECT * FROM `clienttype`;';
    $rs = mysql_query($sql, $conn) or die ("error with sql query ".$sql);

    while ($row = mysql_fetch_array ($rs)){
        $ClienttypeID = $row["ClienttypeID"];
        $Clienttype = $row["Clienttype"];

        if ($side == 1){
            $side = 2;
            echo '<tr>';
            echo '<td><span class="RPATtext"><input type="checkbox" name="Clients[]" value="' .$ClienttypeID. '"> ' .$Clienttype. '</div></td>';

        } else {
            $side = 1;
            echo '<td><span class="RPATtext"><input type="checkbox" name="Clients[]" value="' .$ClienttypeID. '"> ' .$Clienttype. '</div></td>';
            echo '<option value="' .$ClienttypeID. '">' .$Clienttype. '</option>'; 
        }

    }
    ?>
    </table> 
```

* * *

结果页码

* * *

```
 <?php

    $Country = $_POST['Country'];
    $County = $_POST['County'];
    $ClientStage = $_POST['ClientStage'];
    $HealthIssues = $_POST['HealthIssues'];

    include 'Easyspace.php';
    $sql = "SELECT * FROM `therapists` WHERE ";

    if ($Country){
        $sql .= "`Country` = '$Country'";
    }

    if ($County){
        if ($Country){
            $sql .= ' AND ';    
        }
        $sql .= "`County` = '$County'";
    }

    if ($ClientStage){
        if ($Country or $County){
            $sql .= ' AND ';    
        }
        $sql .= "FIND_IN_SET('$ClientStage', Client_typeID)";
    }

    if ($HealthIssues){
        if ($Country or $County or $ClientStage){
            $sql .= ' AND ';    
        }
        $sql .= "FIND_IN_SET('$HealthIssues', IssuesID)";
    }
    // echo $sql;

    $rs = mysql_query($sql, $conn) or die ("error with sql query ".$sql);

    while ($row = mysql_fetch_array ($rs)){
        $TherapistID = $row['TherapistID'];
        $Title = $row['Title'];
        $FirstName = $row['First Name'];
        $LastName = $row['Last Name'];
        $PostCode = $row['PostCode'];

        echo '<tr>';
        echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$Title. '</td>';
        echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$FirstName. '</td>';
        echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$LastName. '</td>';
        echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$PostCode. '</td>';
        echo '<td height="34" valign="middle" bgcolor="#D9E5C3"><p class="bodycopy"><a href="Therapist.php?ID=' .$TherapistID. '">View more details</a></p></td>';
        echo '</tr>';

    }

    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:20:32.397

这是您的新结果代码。我希望这是你要找的。注意您的代码：尝试将 vars 放入小写（$Country 必须是 $country，尝试使用 PDO for MySQL，等等...）。

```
<?php

$Country = $_POST['Country'];
$County = $_POST['County'];
/* change here */
$ClientStage = $_POST['Clients'];
$HealthIssues = $_POST['HealthIssues'];

include 'Easyspace.php';
$sql = "SELECT * FROM `therapists` WHERE ";

if ($Country){
    $sql .= "`Country` = '$Country'";
}

if ($County){
    if ($Country){
        $sql .= ' AND ';    
    }
    $sql .= "`County` = '$County'";
}

if ($ClientStage){
    if ($Country or $County){
        $sql .= ' AND ';    
    }
    /* change here */
    $sql .= 'Client_typeID IN (';
    foreach($ClientStage as $i => $id) {
       if ($i !== 0)
           $sql .=  ',';
       $sql .=  "'" . $id . '"';
    }
    $sql .= ')';
}

if ($HealthIssues){
    if ($Country or $County or $ClientStage){
        $sql .= ' AND ';    
    }
    $sql .= "FIND_IN_SET('$HealthIssues', IssuesID)";
}
// echo $sql;

$rs = mysql_query($sql, $conn) or die ("error with sql query ".$sql);

while ($row = mysql_fetch_array ($rs)){
    $TherapistID = $row['TherapistID'];
    $Title = $row['Title'];
    $FirstName = $row['First Name'];
    $LastName = $row['Last Name'];
    $PostCode = $row['PostCode'];

    echo '<tr>';
    echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$Title. '</td>';
    echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$FirstName. '</td>';
    echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$LastName. '</td>';
    echo '<td valign="middle" bgcolor="#D9E5C3" class="bodycopy">' .$PostCode. '</td>';
    echo '<td height="34" valign="middle" bgcolor="#D9E5C3"><p class="bodycopy"><a href="Therapist.php?ID=' .$TherapistID. '">View more details</a></p></td>';
    echo '</tr>';

}

?> 
```

# php - 我的 RSS 代码有什么问题？

> ID：14341765
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:05:05.790
> 
> 标签：php, rss

我需要一双全新的眼睛来查看我的 RSS 代码，因为它正在输出一个空白页面。但是，当我运行时，我会`var_dump()`收到输出。你能告诉我发生了什么吗？

```
 if($_GET['uid'] == ''){
    $usrid = $udata['user_name'];
}else{
    $usrid = $_GET['uid'];
}
    $udata = $userObj->fetchUser(array("user_name"=>$usrid));

$rssfeed = '<?xml version="1.0" encoding="utf-8"?>';
$rssfeed .= '<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">';
$rssfeed .= '<channel>';
$rssfeed .= '<title>Brags By '.$udata['full_name'].'</title>';
$rssfeed .= '<link>'.BASE_URL.'</link>';
$rssfeed .= '<description>'.SITE_TITLE2.'Be amazing. Get noticed.</description>';
$rssfeed .= '<language>en-us</language>';
$rssfeed .= '<copyright>Copyright (C) '.date("Y").' ' . SITE_TITLE2 . '</copyright>'; 

$dbSel = $db->dbh->prepare("SELECT *,UP.id as bragid FROM ".USERS_BRAG." as UP,".USERS." as U  where                   U.id = UP.user_id AND UP.status = :stat AND U.id= :uID ORDER BY UP.id DESC");    
$dbSel->execute(array(':stat'=>'1',':uID'=>$udata['id']));
$result=$dbSel->fetchAll(PDO::FETCH_ASSOC);
//
while($row = $result) {

    //echo var_dump($row);die;

    $img="<img src='".BASE_URL."public/bragimages/thumb/".$row['brag']."'>";
    $link=BASE_URL."bragdetails/".$row['bragid'];

    $rssfeed .= "<item>";
    $rssfeed .= "<title>".$row['brag_desc']."></title>";
    $rssfeed .= "<description>".$img."></description>";
    $rssfeed .= "<link>".$link."></link>";
    $rssfeed .= "<pubDate>".date("D, d M Y H:i:s O", strtotime($row['added_date']))."></pubDate>";
    $rssfeed .= "</item>";
}

$rssfeed .= '</channel>';
$rssfeed .= '</rss>';

echo $rssfeed; 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:20:20.110

改用 foreach

```
foreach ($result as $row) {
...
} 
```

# android - AChartEngine XYMultipleSeriesRenderer 参数？

> ID：14341770
> 
> 赞同：2
> 
> 时间：2013-01-15T16:05:12.997
> 
> 标签：android, achartengine

我正在尝试创建一个包含六条线和两个 Y 轴的折线图。所有六条线都将使用相同的 X 轴，但 3 条线应相对于一个 Y 轴绘制，另外 3 条线应相对于另一个 Y 轴绘制。

我一直在看，[`this tutorial`](http://code.google.com/p/achartengine/source/browse/trunk/achartengine/demo/org/achartengine/chartdemo/demo/chart/MultipleTemperatureChart.java)但不能完全弄清楚发生了什么。

这条线是代表创建一个带有 2 条要绘制的线的图表，还是一个带有 2 个 y 轴的图表？

```
XYMultipleSeriesRenderer renderer = new XYMultipleSeriesRenderer(2); 
```

[`JavaDocs`](http://www.achartengine.org/content/javadoc/org/achartengine/renderer/XYMultipleSeriesRenderer.html#XYMultipleSeriesRenderer%28int%29)根本不解释参数。它只是说`scaleNumber`，没有任何解释。

另外，有`AChartEngine`没有使用 Intents 的方法？我目前已经设置好所有东西来创建图表，并设置 a`LinearLayout`来显示它。除了图表之外，页面上还有其他内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:18:13.487

> 我正在尝试创建一个包含六条线和两个 Y 轴的折线图。所有六条线都将使用相同的 X 轴，但 3 条线应相对于一个 Y 轴绘制，另外 3 条线应相对于另一个 Y 轴绘制。
> 
> 我一直在看这个教程，但不能完全弄清楚发生了什么。
> 
> 这条线是代表创建一个带有 2 条要绘制的线的图表，还是一个带有 2 个 y->axis 的图表？
> 
> XYMultipleSeriesRenderer 渲染器 = new XYMultipleSeriesRenderer(2); JavaDocs 根本没有解释这个参数。它只是说 scaleNumber，这在任何地方都无法解释。

简而言之，是的，scaleNumber 是指您在图表中拥有的 Y 比例的数量。当另一个方法调用引用 scaleNumber 时，通常是要明确将该方法应用于哪个比例。

> 另外，是否可以在不使用 Intents 的情况下使用 AChartEngine？我目前已经完成了创建图表的所有设置，并设置了一个 LinearLayout 来显示它。除了图表之外，页面上还有其他内容。

再次，是的。我在我的应用程序中使用它，如下所示：

```
GraphicalView graph = ChartFactory.getTimeChartView(myContext, data, renderer, xLabelFormat);

LinearLayout myLL = (LinearLayout) findViewById(R.id.graph_container);
myLL.addView(graph); 
```

所有图表类型都可以作为 Intents 或 Views 检索（Javadoc 中的完整列表：[http](http://www.achartengine.org/content/javadoc/org/achartengine/ChartFactory.html) ://www.achartengine.org/content/javadoc/org/achartengine/ChartFactory.html ）

# android - 下载没有 asyncTask 的文件

> ID：14341771
> 
> 赞同：1
> 
> 时间：2013-01-15T16:05:12.890
> 
> 标签：android, android-asynctask, download

我想知道是否有一种方法可以在不使用异步任务的情况下将文件下载到 android 设备。

我的问题是我想在我的应用程序中使用一个异步任务，我需要在这个 asyncTask 内部调用一个下载函数，但是 android 的文档说只能从 UI 线程创建一个 asyncTask。

我尝试通过使用`extends thread`而不是创建一个线程`extends asyncTask`，但android仍然给出了“UI线程异常上的网络”。

我需要一个像这样工作的函数： String downloadFile(String url){...} 返回下载的字符串（我正在下载一个 xml 文件，没什么特别的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:12:18.737

> 我需要在这个 asyncTask 里面调用一个下载函数

如果“INSIDE this asyncTask”真的意味着“来自”的`doInBackground()`方法`AsyncTask`，那么“下载函数”（不管*是*什么）不需要是异步的。

> but android still said the "Network on UI thread exception"

Then you are not doing the network I/O from `doInBackground()` of an `AsyncTask` or by any background means (e.g., from a regular `Thread` that you fork).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:11:52.670

您可以通过服务在 Android 中下载文件。

服务是一个应用程序组件，它代表应用程序希望在不与用户交互的情况下执行更长时间运行的操作，或提供功能供其他应用程序使用。每个服务类必须在其包的 AndroidManifest.xml 中有相应的声明。可以使用 Context.startService() 和 Context.bindService() 启动服务。

请注意，服务与其他应用程序对象一样，在其托管进程的主线程中运行。这意味着，如果您的服务要执行任何 CPU 密集型（例如 MP3 播放）或阻塞（例如网络）操作，它应该生成自己的线程来完成这项工作。更多信息可以在进程和线程中找到。IntentService 类可作为 Service 的标准实现使用，它有自己的线程来安排要完成的工作。

[http://www.java2s.com/Code/Android/Network/FileDownloadService.htm](http://www.java2s.com/Code/Android/Network/FileDownloadService.htm)

# ruby-on-rails - Rails 沙盒控制台停止显示反馈

> ID：14341778
> 
> 赞同：0
> 
> 时间：2013-01-15T16:05:29.143
> 
> 标签：ruby-on-rails

我不确定发生了什么，但我正在关注 Rails 教程，当我第一次发出这个命令时：

> 导轨控制台--沙盒

它工作得很好，并向我展示了正确的反馈：

```
Loading development environment in sandbox
Any modifications you make will be rolled back on exit 
```

但是当我输入这个时，它开始表现得很奇怪，没有显示我输入的整行，跳到第一行并且没有显示反馈：

```
user = User.new(name: "Michael Hartl", email: "mhartl@example.com") 
```

![在此处输入图像描述](../Images/0c03f55513a1ddd8251a7133900e7eb2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:12:17.970

那是因为你错过了我认为的右括号。尝试`ctrl+C`停止这个未完成的过程，然后重试。

# logging - 如何禁用部分代码的错误/异常处理程序？

> ID：14341779
> 
> 赞同：2
> 
> 时间：2013-01-15T16:05:29.643
> 
> 标签：logging, error-handling, runtime-error, php

我正在使用 PHP 5.3.19 版本，并且我有以下代码：

```
set_exception_handler(array($this->main_model,'nothing'));
set_error_handler(array($this->main_model,'nothing'));
error_reporting(0);
foreach ($data as $row){
...
}
restore_error_handler(); 
```

现在我只是尝试使用`nothing`那里进行黑客攻击，这是一个什么都不做的函数，因为我尝试将它们设置为 null 但没有改变，这也没有改变它。

我也尝试过包装，`try catch`但它仍然可以处理错误。

我无法完全禁用错误，因为我将它们与自定义错误处理程序一起使用，我想要的是禁用`foreach`错误循环，我也调用了该函数，`@`但由于我使用了自定义错误处理程序，它不再起作用。

我在[这里](https://stackoverflow.com/a/4946185/1026199)读到，当使用自定义处理程序 php 时会忽略`error_reporting`.

无论如何，我怎样才能让 foreach**不**处理错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:19:14.140

既不`set_error_handler()`也不`set_exception_handler()`使我们能够记录致命错误，例如 E_ERROR、E_PARSE 和 E_CORE_ERROR。

`solution`问题是[register_shutdown_function(](http://php.net/manual/en/function.register-shutdown-function.php) )

此函数允许您注册一个回调函数，该函数将在 PHP 关闭时运行，即使由于进入不稳定状态而被迫关闭也是如此。

这是一个[自定义类](https://stackoverflow.com/questions/2726524/can-you-unregister-a-shutdown-function)，可让您注册或取消注册 ShutDown 功能。

```
class UnregisterableCallback{

    // Store the Callback for Later
    private $callback;

    // Check if the argument is callable, if so store it
    public function __construct($callback)
    {
        if(is_callable($callback))
        {
            $this->callback = $callback;
        }
        else
        {
            throw new InvalidArgumentException("Not a Callback");
        }
    }

    // Check if the argument has been unregistered, if not call it
    public function call()
    {
        if($this->callback == false)
            return false;

        $callback = $this->callback;
        $callback(); // weird PHP bug
    }

    // Unregister the callback
    public function unregister()
    {
        $this->callback = false;
    }
} 
```

您可以将此 Class 逻辑与您的代码一起使用。

# android - OpenCV imwrite，颜色错误：我使用哪个 convertTo/cvColor 参数？

> ID：14341780
> 
> 赞同：2
> 
> 时间：2013-01-15T16:05:29.953
> 
> 标签：android, opencv, java-native-interface

好的，所以我一直在尝试和在线搜索，但我找不到这个。

我有：

1.  我以混合方式使用的 OpenCV4Android：Java 和 Native。
2.  获得的垫子

    `capture.retrieve(mFrame, Highgui.CV_CAP_ANDROID_COLOR_FRAME_RGBA);`

这**不能**更改为 Native，因为它是其他人的库，并且完全以非本地方式构建。

1.  `mFrame.nativeObj`我通过使用和使用传递此 Mat 的本机方法：

    ```
    JNIEXPORT int JNICALL Java_com_... ( ...jlong addr ... )
    {

        Mat& mrgba = *((Mat*)addr);

        // do stuff

        imwrite( mrgba, ... );
    } 
    ```

现在......我使用这个矩阵，然后我用 , 来写它`imwrite`，所有这些都在这个原生部分中。虽然 imwrite 确实写入了一个文件，但它的颜色都是错误的。红色的地方应该是白色的，绿色的地方应该是黑色的，紫色的地方应该是我桌子的颜色，即淡黄色。现在，与其盲目地尝试`cvColor`and `convertTo`，我宁愿**知道**一些东西。

关于第一次检索到的帧，我应该知道的通道数、类型、通道顺序以及诸如此类的东西是多少

```
capture.retrieve(mFrame, Highgui.CV_CAP_ANDROID_COLOR_FRAME_RGBA); 
```

然后通过JNI传递给原生OpenCV？实际上，我需要进行哪些转换才能使**本机**imwrite 正常运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T09:06:27.500

由于某种原因，使用

```
capture.retrieve(mFrame, Highgui.CV_CAP_ANDROID_COLOR_FRAME_RGBA); 
```

需要像这样转换：

```
cvtColor(mrgba, mbgr, CV_YCrCb2RGB, 4); 
```

为了`imwrite`正确地将图像输出到 SD 卡。

我不明白为什么（`imwrite`应该接受 BGR 图像），但至少这回答了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:11:23.243

尝试

```
capture.retrieve(mFrame, Highgui.CV_CAP_ANDROID_COLOR_FRAME_BGRA); 
```

因为 OpenCV 读取带有蓝色、绿色和红色通道的图像，而不是红色、绿色、蓝色。

# c# - EF 中的跨数据库查询

> ID：14341782
> 
> 赞同：21
> 
> 时间：2013-01-15T16:05:34.513
> 
> 标签：c#, sql-server, entity-framework, cross-database

有没有办法在实体框架中实现跨数据库查询？假设我有两个实体 User 和 Post，User 实体在 database1 中，Post 在 database2 中，这意味着这些实体在不同的数据库中。我应该如何在 Entity Framework 中获取用户的帖子？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-11-14T04:29:56.400

我知道这是一个老问题，但这实际上是可能的。如果数据库在同一台服务器上，那么您需要做的就是使用`DbCommandInterceptor`.

例如，如果我附加`DbCommandInterceptor`到`MyContext`，我可以拦截所有命令执行并将查询中的指定表替换为我的完整数据库路径。

```
public override void ReaderExecuting(DbCommand command, DbCommandInterceptionContext<DbDataReader> interceptionContext)
{
    // Here, I can just replace the CommandText on the DbCommand - but remember I
    // want to only do it on MyContext
    var context = contexts.FirstOrDefault() as MyContext;
    if (context != null)
    {
        command.CommandText = command.CommandText
            .Replace("[dbo].[ReplaceMe1]", "[Database1].[dbo].[Customers]")
            .Replace("[dbo].[ReplaceMe2]", "[Database2].[dbo].[Addresses]")
            .Replace("[dbo].[ReplaceMe3]", "[Database3].[dbo].[Sales]");
    }

    base.ReaderExecuting(command, interceptionContext);
} 
```

这种方法的另一个好处是 EF 模型映射仍然可以正常工作并尊重列属性，不需要视图，也不需要存储过程。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-15T16:09:50.393

EF 上下文不支持跨数据库查询。您需要通过 SQL 视图（[或同义词](http://rachel53461.wordpress.com/2011/05/22/tricking-ef-to-span-multiple-databases/)）公开 database1 中的帖子，并将其用作该数据库的一部分。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-15T16:15:21.407

您可以使用`ExecuteStoreQuery`，例如：

```
var myOb = context.ExecuteStoreQuery<PlainOldClrObject>(
        @"select  * 
          from    db1.dbo.table1 t1
          join    db2.dbo.table2 t2
          on      t2.t1_id = t1.id
          where   t1.id  = {0}",
        table1Id).FirstOrDefault(); 
```

您必须将`PlainOldClrObject`列定义为具有 getter/setter 的属性的类，例如：

```
class PlainOldClrObject
{
    public int Id ( get; set; }
    public int Name ( get; set; }
    ...
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-15T16:08:54.403

不，你不能。您将必须创建上下文并加入自己。见[这里](https://stackoverflow.com/questions/7404690/can-you-have-a-dbcontext-that-is-associated-with-multiple-databases)。

您可以解决数据库诡计，在一个数据库中创建一个视图，然后在另一个数据库中反映一个表。

# jquery - 使用 Phonegap 的 SVG 视图

> ID：14341786
> 
> 赞同：0
> 
> 时间：2013-01-15T16:05:49.487
> 
> 标签：jquery, cordova, svg

我在 PhoneGap 2.1 中使用基于 SVG 的图形节点显示。问题是我无法调整 SVG 画布的大小，因为图形溢出屏幕并且没有激活滚动条，因为 html 页面本身保持相同大小。我必须使 SVG 画布在 HTML 中完全可滚动/可拖动。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:49:59.693

看看你的元标记，“视口”可以帮助你： [https ://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)

# debugging - 使用 MP4Box -hint 的分段错误

> ID：14341788
> 
> 赞同：1
> 
> 时间：2013-01-15T16:05:53.450
> 
> 标签：debugging, segmentation-fault, ubuntu-12.04, video-processing

您好我最近一直在 AWS EC2 实例上设置 RTSP 服务器（我正在运行 ubuntu 12.04）。无论如何，我正在尝试运行 gpac 软件，即 bash 命令 MP4Box -hint filename.mp4。这样做的目的是格式化文件以进行流式传输。无论如何这里是终端输出

```
root@domU-12-31-39-0E-B4-44:/home/ubuntu/Videos# MP4Box -hint Homer_And_Apu.mp4 
Hinting file with Path-MTU 1450 Bytes
Hinting track ID 1 - Type "mp4v:mp4v" (MP4V-ES) - BW 1000 kbps
Hinting track ID 2 - Type "mp4a:mp4a" (mpeg4-generic) - BW 128 kbps
Hinting track ID 3 - Type "text:text" (3gpp-tt) - BW 0 kbps
Segmentation fault (core dumped)(83/100) 
```

根据我的研究，我现在知道分段错误通常来自代码中的无效指针，通常在边缘情况或硬件上（我排除了硬件，如 aws ？）。但是，我不是编码大师或 ubuntu 专家。我想知道是否有人可以指出我可以在哪里查找事件的详细日志文件的最佳方向，或者他们是否遇到了与 MP4Box 类似的事件并找到了解决方案，因为显然其他人之前遇到过这个问题. 我发现的唯一建议修复是确保允许访问目录，我已经通过以 root 用户身份运行并在多个不同的目录中进行了检查。任何有关如何进一步调试或工作解决方案的建议将不胜感激。
提前感谢布伦丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:01:22.340

在任何情况下，segfault 都是程序中遇到 segfault 的错误/错误。在这种情况下，该程序似乎是 MP4Box。

问题出在 MP4Box 的代码中。您可以将其报告给他们的开发者社区。[http://www.videohelp.com/contact](http://www.videohelp.com/contact)可以选择报告错误。

现在，一旦您报告错误，就无法保证何时/是否会解决该错误。

以下是您可以做的几件事。

1.  确保您使用的是该软件的最新版本。如果有人已经遇到过这个错误，那么它可能会在最新版本中得到修复。

2.  在我上面给出的链接上报告错误（首先尝试第 1 步很重要）。您也可以在论坛上发帖。您可以帮助他们解决问题的一件事是给他们导致问题的视频文件。如果视频文件很大，我可能会编辑视频文件，及时将其切碎，看看是否有任何块也产生了段错误。视频越短（时间上），帧越少，因此传输文件更容易，也更容易分析它以了解段错误。

3.  您可以尝试自己修复错误。这涉及您了解计算机编程，了解 MP4Box 正在使用的工具、库和平台，在调试器中运行它以准确找出段错误发生的位置。了解它发生的原因以及在这种情况下应该有什么理想的行为，并添加可以使程序表现得更好的代码。如果您不熟悉计算机编程，那么这将需要非常多的时间投入。

4 另一种选择是寻找 MP4Box 的替代品。

# android - 如何在 Android 库的清单文件中声明非活动类？

> ID：14341792
> 
> 赞同：0
> 
> 时间：2013-01-15T16:06:15.000
> 
> 标签：android, android-library

为了重构我的代码，我将在每个项目中使用的一些方法移动到一个 Android 库中。

例如。我用以下类创建了一个简单的库项目：

```
public class HttpUtils {

    public boolean isNetworkAvailable(Context context) {
        ConnectivityManager cm = (ConnectivityManager) 
          context.getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo networkInfo = cm.getActiveNetworkInfo();
        if (networkInfo != null && networkInfo.isConnected()) {
            return true;
        }
        return false;
    } 
} 
```

和以下（默认）清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.xxx.utils"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
    </application>

</manifest> 
```

我可以使用将它导入另一个 Android 项目

```
import com.xxx.utils.http.HttpUtils; 
```

但如果我尝试使用`HttpUtils.isNetworkAvailable`，我会得到`HttpUtils.isNetworkAvailable cannot be resolved to a type`。

我读到，对于库活动，应该将其添加到清单文件中，但是如何`HttpUtils`在库清单中添加一个简单的类，例如 my ，以便能够从另一个项目访问其方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:17:41.353

为什么要像库一样添加此类。将它添加到你的包中，然后你可以从任何这样的活动中调用它：

```
boolean isNetworkAvailable = new HttpUtils().isNetworkAvailable(this); 
```

或者使 isNetworkAvailable 静态：

```
public static boolean isNetworkAvailable(Context context) {....} 
```

然后你可以简单地调用它：

```
boolean isNetworkAvailable = HttpUtils.isNetworkAvailable(this); 
```

这样，清单文件中就没有什么要声明的了。

编辑：好的，我明白了。你有几个项目。因此，为此，您有 2 个选择：

1）您可以从 Eclipse 新项目创建并在第二个窗口中选择“将此项目标记为库”。然后在你的所有项目中在构建路径中添加这个库项目

2）创建一个jar文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:09:36.303

> 如何在库清单中添加一个简单的类

你没有。

您还有其他问题，例如：

*   没有将库项目正确附加到宿主项目
*   导入错误（例如，导入到其他名为 的类`HttpUtils`）

如果您有正确的错误消息，这将有所帮助。AFAIK，不可能将“无法解析为类型”放在方法的名称上。

# vb.net - 我将如何在功能上编写这个 VB.Net 循环？

> ID：14341795
> 
> 赞同：0
> 
> 时间：2013-01-15T16:06:27.917
> 
> 标签：vb.net, linq

我有一个将 a`NameValueColletion`转换为`IDictionary`. 我将如何在功能上编写这个（使用`Select`等而不是循环）？

```
<Extension()>
Public Function ToDictionary(ByVal source As NameValueCollection)
        As IDictionary(Of String, String)
    Dim ret = New Dictionary(Of String, String)
    Dim keys = source.Keys
    For Each key In keys
        Dim sKey = TryCast(key, String)
        Dim sVal = TryCast(source(key), String)
        If sKey Is Nothing OrElse sVal Is Nothing Then Continue For
        ret(sKey) = sVal
    Next
    Return ret
End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:08:43.417

```
Return source.Cast(Of String)().
             ToDictionary(Function(key) key, Function(key) source(key)) 
```

# matlab - 向量化冒号 (:) 的概念 - MATLAB 中两个向量之间的值

> ID：14341798
> 
> 赞同：15
> 
> 时间：2013-01-15T16:06:32.010
> 
> 标签：matlab, vector, vectorization, colon

我有两个向量`idx1`和`idx2`，我想获得它们之间的值。如果`idx1`和`idx2`是数字而不是向量，我可以通过以下方式做到这一点：

```
idx1=1;
idx2=5;
values=idx1:idx2 

% Result
 % values =
 % 
 %    1     2     3     4     5 
```

但在我的情况下，`idx1`和`idx2`是可变长度的向量。例如，对于长度 = 2：

```
idx1=[5,9];
idx2=[9 11]; 
```

我可以使用冒号运算符直接获取两者之间的值吗？这是，类似于以下内容：

```
values = [5     6     7     8     9     9    10    11] 
```

我知道我可以这样做`idx1(1):idx2(1)`，`idx1(2):idx2(2)`也就是分别提取每列的值，所以如果没有其他解决方案，我可以使用 for 循环来做到这一点，但也许 Matlab 可以更轻松地做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T16:11:37.740

您的示例输出不合法。矩阵不能有不同长度的行。您可以做的是使用以下方法创建一个元胞数组`arrayfun`：

```
values = arrayfun(@colon, idx1, idx2, 'Uniform', false) 
```

要将生成的元胞数组转换为向量，您可以使用[`cell2mat`](http://www.mathworks.com/help/matlab/ref/cell2mat.html)：

```
values = cell2mat(values); 
```

或者，如果生成的元胞数组中的所有向量都具有相同的长度，则可以按如下方式构造输出矩阵：

```
values = vertcat(values{:}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:34:17.787

尝试取集合的并集。给定`idx1`和`idx2`你提供的值，运行

```
values = union(idx1(1):idx1(2), idx2(1):idx2(2)); 
```

根据需要，这将产生一个带有值的向量`[5 6 7 8 9 10 11]`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-27T23:15:39.637

我无法让@Eitan 的解决方案起作用，显然您需要为冒号指定参数。接下来的小修改让它在我的 R2010b 版本上运行：

```
step = 1; 
idx1 = [5, 9];
idx2 = [9, 11];
values = arrayfun(@(x,y)colon(x, step, y), idx1, idx2, 'UniformOutput', false);
values=vertcat(cell2mat(values)); 
```

请注意，这`step = 1`实际上是 中的默认值`colon`，`Uniform`可以用来代替`UniformOutput`，但为了完整起见，我将它们包括在内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-10T23:10:11.643

*Loren*有一篇很棒的博文，名为[Vectorizing the Notion of Colon (:)](http://blogs.mathworks.com/loren/2008/10/13/vectorizing-the-notion-of-colon/)。它包含的答案（对于大型数组）比使用`arrayfun`或`for`-loop 快 5 倍，并且类似于运行长度解码：

> 这个想法是扩展冒号序列。我知道每个序列的长度，所以我知道输出数组中的起点。用 1s 填充起始值之后的值。然后我计算出从一个序列的结尾跳到下一个序列的开头的距离。如果有重复的起始值，跳跃可能是负数。一旦这个数组被填充，输出只是序列的累积和或累积和。
> 
> ```
> function x = coloncatrld(start, stop)
> % COLONCAT Concatenate colon expressions
> %    X = COLONCAT(START,STOP) returns a vector containing the values
> %    [START(1):STOP(1) START(2):STOP(2) START(END):STOP(END)].
> 
> % Based on Peter Acklam's code for run length decoding.
> len = stop - start + 1;
> 
> % keep only sequences whose length is positive
> pos = len > 0;
> start = start(pos);
> stop = stop(pos);
> len = len(pos);
> if isempty(len)
>     x = [];
>     return;
> end
> 
> % expand out the colon expressions
> endlocs = cumsum(len);  
> incr = ones(1, endlocs(end));  
> jumps = start(2:end) - stop(1:end-1);  
> incr(endlocs(1:end-1)+1) = jumps;
> incr(1) = start(1);
> x = cumsum(incr); 
> ```

# d3.js - 在 D3 中绘制序列徽标

> ID：14341800
> 
> 赞同：2
> 
> 时间：2013-01-15T16:06:38.300
> 
> 标签：d3.js

我将如何使用 D3 绘制序列徽标？

来自维基百科

> **序列标志**是核苷酸（在 DNA/RNA 链中）或氨基酸（在蛋白质序列中）序列保守性的图形表示。序列标志由每个位置的一堆字母组成。字母的相对大小表示它们在序列中的频率。字母的总高度描述了位置的信息内容，以位为单位。

一个例子：

![在此处输入图像描述](../Images/1aced7c540843b52360ac04aa3635ef1.png)

通常，数据以矩阵的形式出现，矩阵的行名是氨基酸/DNA序列，列表示序列的位置。

因此，如果我有一个长度为 4 的字符空间`A` `B` `C`和序列，则矩阵看起来像这样

```
 1     2     3     4
A 0.1   0.8   0.2   0.1
B 0.3   0.2   0.3   0.05
C 0     0.1   0.4   0.4 
```

矩阵中的值将对应于字符的相对高度

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:37:57.677

作为灵感，我从堆积条形图开始：http: [//bl.ocks.org/3886208](http://bl.ocks.org/3886208)

粗略的实现在这里：http: [//jsfiddle.net/QcPZ9/](http://jsfiddle.net/QcPZ9/)

更令人困惑的部分之一是：

```
data.forEach(function(d) {
    var y0 = 0;
    d.bits = d.map( function( entry ) { 

        return { bits: entry.bits, letter: entry.letter, y0: y0, y1 : y0 += +entry.bits };          
    } )
    d.bitTotal = d.bits[d.bits.length - 1].y1; 
}); 
```

基本上，它说要计算每个序列条目的总位数（最终成为一列）。它还保留先前的位，以便可以计算 y 偏移（堆叠）。

总的来说，这可以通过为字母使用定义的符号或图形来改进，而不是字体修改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-16T18:40:58.963

这是解决方案：

这是[cmonkey](https://stackoverflow.com/users/322722/cmonkey)实现的一个分支：http: [//jsfiddle.net/fgborja/rMArY/](http://jsfiddle.net/fgborja/rMArY/)

我使用 Inkspace 对字符进行了一些调整。'sequencelogo' 字体作为字形嵌入在 javascript 中。

```
 function sequencelogoFont(){
      var font = svg.append("defs").append("font")
                                       .attr("id","sequencelogo")
      //...
      font.append("glyph")
        .attr("unicode","A") 
        .attr("vert-adv-y","50") 
        .attr("d","M500 767l-120 -409h240zM345 948h310l345 -1000h-253l-79 247h-338l-77 -247h-253l345 1000v0z")      
      //...
    } 
```

如果将 svg 字体转换为 ttf、woff 和 eot 并将它们作为源代码放在 css 文件中，它会变得更加便携。

（加上氨基酸标志）

# eclipse-plugin - 开发eclipse插件时在source文件夹下创建包

> ID：14341803
> 
> 赞同：0
> 
> 时间：2013-01-15T16:06:44.090
> 
> 标签：eclipse-plugin

我正在开发一个将用于创建项目的 Eclipse 向导。我可以创建文件夹层次结构，但无法在“src”文件夹下创建包。我在这里找到了这个答案[如何通过插件在 Eclipse 项目中创建包（文件夹）](https://stackoverflow.com/questions/8606547/how-to-create-packages-folders-in-an-eclipse-project-via-plugin)。但是，它并没有解决我的问题。当我在“src”文件夹下创建一个文件夹时，eclipse 无法将其识别为一个包。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:15:29.357

使用 JDT API 试试这个，如下所示。

```
private void createPackage(IProject project) throws JavaModelException {
   IJavaProject javaProject = JavaCore.create(project);
   IFolder folder = project.getFolder("src");
   // folder.create(true, true, null);
   IPackageFragmentRoot srcFolder = javaProject
       .getPackageFragmentRoot(folder);
   IPackageFragment fragment = srcFolder.createPackageFragment(project.getName(), true, null);
} 
```

如需更多帮助，请访问此[链接](http://www.vogella.com/articles/EclipseJDT/article.html#jdt_javamodel)

# python - Pandas Merge (pd.merge) 如何设置索引并加入

> ID：14341805
> 
> 赞同：11
> 
> 时间：2013-01-15T16:06:47.973
> 
> 标签：python, pandas

我有两个熊猫数据框：dfLeft 和 dfRight，以日期为索引。

df左：

```
 cusip    factorL
date  
2012-01-03    XXXX      4.5
2012-01-03    YYYY      6.2
....
2012-01-04    XXXX      4.7
2012-01-04    YYYY      6.1
.... 
```

右：

```
 idc__id    factorR
date  
2012-01-03    XXXX      5.0
2012-01-03    YYYY      6.0
....
2012-01-04    XXXX      5.1
2012-01-04    YYYY      6.2 
```

两者的形状都接近`(121900,3)`

我尝试了以下合并：

```
test = pd.merge(dfLeft, dfRight, left_index=True, right_index=True, left_on='cusip', right_on='idc__id', how = 'inner') 
```

这给了 test 的形状`(60643500, 6)`。

关于这里出了什么问题的任何建议？我希望它基于日期和 cusip/idc_id 合并。注意：在这个例子中，尖点是一字排开的，但实际上可能并非如此。

谢谢。

预期输出测试：

```
 cusip    factorL    factorR
date  
2012-01-03    XXXX      4.5          5.0
2012-01-03    YYYY      6.2          6.0
....
2012-01-04    XXXX      4.7          5.1
2012-01-04    YYYY      6.1          6.2 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-15T17:00:28.477

重置索引，然后合并多个（列）键：

```
dfLeft.reset_index(inplace=True)
dfRight.reset_index(inplace=True)
dfMerged = pd.merge(dfLeft, dfRight,
              left_on=['date', 'cusip'],
              right_on=['date', 'idc__id'],
              how='inner') 
```

然后，您可以将“日期”重置为索引：

```
dfMerged.set_index('date', inplace=True) 
```

**这是一个例子：**

```
raw1 = '''
2012-01-03    XXXX      4.5
2012-01-03    YYYY      6.2
2012-01-04    XXXX      4.7
2012-01-04    YYYY      6.1
'''

raw2 = '''
2012-01-03    XYXX      45.
2012-01-03    YYYY      62.
2012-01-04    XXXX      -47.
2012-01-05    YYYY      61.
'''

import pandas as pd
from StringIO import StringIO

df1 = pd.read_table(StringIO(raw1), header=None,
                    delim_whitespace=True, parse_dates=[0], skiprows=1)
df2 = pd.read_table(StringIO(raw2), header=None,
                    delim_whitespace=True, parse_dates=[0], skiprows=1)

df1.columns = ['date', 'cusip', 'factorL']
df2.columns = ['date', 'idc__id', 'factorL']

print pd.merge(df1, df2,
         left_on=['date', 'cusip'],
         right_on=['date', 'idc__id'],
         how='inner') 
```

这使

```
 date cusip  factorL_x idc__id  factorL_y
0  2012-01-03 00:00:00  YYYY        6.2    YYYY         62
1  2012-01-04 00:00:00  XXXX        4.7    XXXX        -47 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-15T17:06:12.383

您可以在您之前将`'cuspin'`和`'idc_id'`作为索引附加到您的 DataFrames [`join`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html#pandas.DataFrame.join)（这是它在前几行上的工作方式）：

```
In [10]: dfL
Out[10]: 
           cuspin  factorL
date                      
2012-01-03   XXXX      4.5
2012-01-03   YYYY      6.2

In [11]: dfL1 = dfLeft.set_index('cuspin', append=True)

In [12]: dfR1 = dfRight.set_index('idc_id', append=True)

In [13]: dfL1
Out[13]: 
                   factorL
date       cuspin         
2012-01-03 XXXX        4.5
           YYYY        6.2

In [14]: dfL1.join(dfR1)
Out[14]: 
                   factorL  factorR
date       cuspin                  
2012-01-03 XXXX        4.5        5
           YYYY        6.2        6 
```

# qt - 快捷方式未触发

> ID：14341810
> 
> 赞同：0
> 
> 时间：2013-01-15T16:06:56.333
> 
> 标签：qt, qt4

这是我的班级声明：

```
class Browser : public QWidget {    
    Q_OBJECT
    public:
        Browser(QWidget *parent = 0);
        QStringList loadSettings(QString settings_file);
    private slots:
        void toggleFullscreen();               
    private:     
        void createActions();
        QAction *aToggleFullscreen;            
}; 
```

和相关定义：

```
void Browser::toggleFullscreen() {
    out << "fullscreen!" << endl;
}   
void Browser::createActions() {
    aToggleFullscreen = new QAction(this);
    aToggleFullscreen->setShortcut(tr("F11"));    
    connect(aToggleFullscreen, SIGNAL(triggered()), this, SLOT(toggleFullscreen()));    
} 
```

我从 打来`createActions()`的`Browser::Browser`。

我没有运行时警告说插槽不存在等。但如果我点击`F11`.

我也试过：

```
aToggleFullscreen->setShortcut(QString("F11")); 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:30:29.947

您忘记将您的操作实际添加到浏览器，因此它永远不会被触发。这应该有效：

```
void Browser::createActions() {
    aToggleFullscreen = new QAction(this);
    aToggleFullscreen->setShortcut(tr("F11"));    
    connect(aToggleFullscreen, SIGNAL(triggered()), this, SLOT(toggleFullscreen()));
    addAction(aToggleFullscreen);    
} 
```

# ruby-on-rails-3 - 将多个模型组合成 1 个视图 Rails

> ID：14341811
> 
> 赞同：0
> 
> 时间：2013-01-15T16:07:02.853
> 
> 标签：ruby-on-rails-3, templates

我是一名初学者，正在开发一个 RoR 应用程序，该应用程序允许用户通过经验和教育来更新他们的简历。我有两个模型用于这些不同的项目，并希望按时间顺序将它们一起显示。我想知道如何在我的配置文件控制器和视图中进行设置。

我想对应用程序的一个单独部分采用相同的做法，该部分将以相同的方式结合用户的帖子和讨论项目。但是，目前，我的重点是经验和教育部分。

个人资料/show.html.erb：

```
 <% if @experiences.any? or @educations.any? %>
<div class="postExpOuter">
    <% @experiences.each do |experience| %>
            <div class="postExp">
                <div>
                    <h2><%= experience.position %></h2>
                    <h3><%= experience.company %> | <%= experience.location %></h3>
                    <h4>
                        <%= experience.start_month %> <%= experience.start_year %>
                        <% if experience.end_year %>
                            <%= " - " + experience.end_month %> <%= experience.end_year %>
                        <% else %>
                            <span> - Present</span>
                        <% end %>
                    </h4>
                </div>
            </div>
    <% end %>
    <% @educations.each do |education| %>
            <div class="postExp">
                <div>
                    <h2><%= education.degree %></h2>
                    <h3><%= education.school %></h3>
                    <h4>
                        <% if education.end_year %>
                            <span>Class of </span><%= education.end_year %>
                        <% else %>
                            <%= education.start_year %><span> - Present</span>
                        <% end %>
                    </h4>
                </div>
            </div>
    <% end %>
</div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:19:20.370

刚刚在我的浏览器中被黑了，不知道它是否可以直接工作：

```
<%- (@experiences.to_a + @educations.to_a).sort_by(&:end_year).each do |item| -%>
  <%- if item.is_a? Experience -%>

    your markup here...

  <%- else -%>

   your other markup here...

  <%- end -%>
<%- end -%> 
```

从那以后就没有写过ERB了……呃，很久了。基本上就是这样：将 2 个 ActiveRecord-Relations 作为数组合并为一个大数组，按所需的时间戳对它们进行排序（如果需要，可以`.reverse`在最后添加）。在遍历列表时，检查您拥有的对象的类型。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T17:05:32.403

profile_controller.rb：

```
class ProfilesController < ApplicationController
  def show
    @user = User.find_by_profile_name(params[:id])
    if @user
        @posts = @user.posts.all(:order => "created_at DESC", :limit => 3)
        @experiences = @user.experiences.all(:order => "start_year DESC")
        @educations = @user.educations.all(:order => "start_year DESC")

      @items = (@experiences.to_a + @educations.to_a).sort_by(&:start_year).reverse[0,3]

        render action: :show
    else
        render file: 'public/404', status: 404, formats: [:html] 
    end
  end
end 
```

个人资料/show.html.erb：

```
<% if @items.any? %>
<div class="postExpOuter">
    <% @items.each do |item| %>
      <% if item.is_a? Experience %>
       <div class="postExp">
            <div>
                <h2><%= item.position %></h2>
                <h3><%= item.company %> | <%= item.location %></h3>
                <h4>
                    <%= item.start_month %> <%= item.start_year %>
                    <% if item.end_year %>
                        <%= " - " + item.end_month %> <%= item.end_year %>
                    <% else %>
                        <span> - Present</span>
                    <% end %>
                </h4>
            </div>
        </div>
      <%- else -%>
        <div class="postExp">
            <div>
                <h2><%= item.degree %></h2>
                <h3><%= item.school %></h3>
                <h4>
                    <% if item.end_year %>
                        <span>Class of </span><%= item.end_year %>
                    <% else %>
                        <%= item.start_year %><span> - Present</span>
                    <% end %>
                </h4>
            </div>
        </div>
      <% end %>
    <% end %>
</div>
<% end %> 
```

# php - 从 PHP 页面登录到 ASP.NET 网站？

> ID：14341813
> 
> 赞同：1
> 
> 时间：2013-01-15T16:07:07.863
> 
> 标签：php, asp.net, curl, login

我有两个网站，一个是用 ASP.NET 编写的，另一个是用 PHP 编写的。控制两个站点。

ASP.NET 站点有自己的登录页面，但我也需要用户从 PHP 站点登录到 ASP.NET 站点。

当用户在 PHP 站点中输入他们的信息并单击“登录”时，我需要在新窗口中打开 ASP.NET 站点。登录后的行为完全独立于 PHP 站点。

实现这一目标的最佳方法是什么？我尝试了几个用 curl 编写的示例，但没有一个有效。

编辑-它们位于不同的服务器中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:11:52.393

难道你不能只使用 cookie 将登录数据从 PHP 传递到 ASP.NET 吗？只需使用他们的用户 ID 或用户名设置一个 cookie。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:17:35.937

它们之间有一个共同的语言是 HTML5，您可以`LocalStorage`使用 JavaScript 在 PHP 页面中设置并使用 JavaScript 在 Asp.net 页面中检查它。

要了解有关`LocalStorage`检查此[链接的更多信息](http://www.w3schools.com/html/html5_webstorage.asp)

# file - 删除空白的第一行脚本

> ID：14341815
> 
> 赞同：0
> 
> 时间：2013-01-15T16:07:14.233
> 
> 标签：file, sed, find, grep

我有这个脚本打印出第一行空白的文件：

```
for f in `find . -regex ".*\.php"`; do 
  for t in head; do 
    $t -1 $f  |egrep '^[  ]*$' >/dev/null && echo "blank line at the $t of $f"; 
  done; 
done 
```

我该如何改进它以实际删除空白行，或者至少将所有带有空白第一行的文件复制到其他地方。

我尝试使用它进行复制，这很好，因为它复制保留了目录结构，但它复制了每个 php 文件，我需要捕获 egrep 的正输出并只复制这些文件。

```
rsync -R $f ../DavidSiteBlankFirst/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:22:36.393

我会亲自使用 sed

```
find ./ -type f -regex '.*\.php' -exec sed -i -e '1{/^[[:blank:]]*$/d;}' '{}' \; 
```

这将找到所有以 .php 结尾的常规文件并执行仅在第一行工作的 sed 命令，并检查其是否为空白，如果是则将其删除，文件中的其他空白行不受影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:22:45.003

只需使用`find`and `sed`：

```
find . -type f -name "*.php" -exec sed -i '1{/^\s*$/d;q;}' {} \; 
```

* * *

该`-type f`选项仅查找文件，而不是我希望您使用`.php`后缀命名文件夹，但这是一种很好的做法。`-regex '.*\.php'`仅使用 globbing的使用是矫枉过正和混乱的`-name "*.php"`。使用 find`-exec`而不是 shell 脚本，该`sed`脚本将对通过`find`.

该`sed`脚本仅查看第一行`1`并将内部的操作应用于`{}`该行。如果该行匹配，我们检查该行是否为空白，我们将其`/^\s*$/`删除`d`并退出`q`脚本，以便不读取文件中的所有其他行。该`-i`选项将更改保存回文件，因为默认行为`sed`是打印到`stdout`. 如果您想要使用后备文件， `-i~`这将为`file~`.`file`

# matlab - 结构数组：将所有空属性 ([]) 设置为 NaN

> ID：14341819
> 
> 赞同：4
> 
> 时间：2013-01-15T16:07:26.157
> 
> 标签：matlab

我有一个结构数组，想将所有空属性设置为 NaN：

```
structArray = 
29x1 struct array with fields:
    value
    id 
```

如果它们为空，如何将所有 struct.value 属性设置为 NaN？

如果它们为空，则转换将`[structArray.value]`省略空元素...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:32:17.497

鉴于这种：

```
x(29).id = [];
x(29).value = []; 
```

您可以像这样设置所有`.id`字段的值

```
[x.value] = deal(nan); 
```

要仅设置特定的值子集，请定义要设置的值掩码，然后在赋值语句中使用它：

```
maskEmptyId = arrayfun(  @(a)isempty(a.id),  x  );
[x(maskEmptyId).id] = deal(nan); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:13:59.107

正如@Pursuit 解释的那样，有一种用 NaN 替换空字段的好方法

但是，您可能也对不同的方法感兴趣。

而不是事后更换，您可以首先防止出现空位。假设它们是空的，因为没有分配任何东西给它们，你可以简单地用 NaN 初始化你的结构。

例如：

```
structArray = struct ('id',[],'value',NaN) 
```

在将任何内容分配给 structArray 之前调用它会使用 NaN 初始化 value 字段，但仍会将 id 初始化为空。

# java - 如何在 JSP 中通过 EJB 显示数据库表中的数据？

> ID：14341824
> 
> 赞同：0
> 
> 时间：2013-01-15T16:07:44.570
> 
> 标签：java, jsp, ejb

我需要在 JSP 中显示一个数据库表。

我有一个会话 bean，它包含一个显示数据库中找到的所有数据的方法。

如何在 JSP 中使用它？

代码（来自下面的评论）：

```
@Override public List findAll() { 
   String flightQuery = "SELECT f FROM Flights f"; 
   Query q = em.createQuery(flightQuery); 
   List existing = q.getResultList(); 

   if (existing.isEmpty()) { 
       System.out.println("Invalid");
   }
   return existing; 
} 
```

JSP 代码

```
<c:forEach items="${flights}" var="flight"> 
   <tr> 
   <td>${flight.flightid}</td> 
   <td><c:out value="${flight.flightnumber}" /></td> 
   <td><c:out value="${flight.datetime}" /></td> 
   <td><c:out value = "${flight.seatsleft}"</td> 
   <td><c:out value="${flight.id}" /></td> 
   <td><c:out value="${flight.price}" /></td> 
   <td><c:out value="${flight.originairport}" /></td> 
   <td><c:out value="${flight.destinationairport}" /></td>
   </tr>
</c:forEach> 
</table> 
```

它没有显示在表格中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:11:59.120

使用控制器 servlet。执行所需工作的基本示例已经在[我们的 servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)中演示，在“Hello World #2（预处理请求）”部分下，大约页面的一半。`@EJB`您可以使用注释直接在 servlet 中注入 EJB 。

这是相关性的摘录：

```
@WebServlet("/products")
public class ProductServlet extends HttpServlet {

    @EJB
    private ProductService productService;

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Product> products = productService.list();
        request.setAttribute("products", products);
        request.getRequestDispatcher("/WEB-INF/products.jsp").forward(request, response);
    }

} 
```

然后在 JSP 中：

```
<c:forEach items="${products}" var="product">
    <tr>
        <td>${product.id}</td>
        <td><c:out value="${product.name}" /></td>
        <td><c:out value="${product.description}" /></td>
        <td><fmt:formatNumber value="${product.price}" type="currency" /></td>
    </tr>
</c:forEach> 
```

最后只需通过它的 URL 调用 servlet: `http://localhost:8080/context/products`。

# user-interface - 您可以使用自己的函数安全地扩展 Ti 或 Ti.UI 对象吗？

> ID：14341825
> 
> 赞同：0
> 
> 时间：2013-01-15T16:07:53.060
> 
> 标签：user-interface, include, styles, titanium, require

我正在开发一个中型 Appcelerator Titanium 应用程序。我想扩展 Ti.UI 对象，我想知道这是否安全。

**我想要做什么** 将一些与 UI 相关的辅助函数和对象存储为 Ti.UI 树的一部分。

一个简单的例子是：

```
Ti.UI.COLORS = {
    RED: '#213234',
    BLUE: '#ABDCEF'
} 
```

我最担心的是，这可能不安全，或者只是不能面向未来。

**为什么我要这样做** 我在 Titanium 的 JSS 方面有过不好的经历，我目前正在 CSS.js 文件中存储和检索我的文件。该文件捆绑了一些使样式更容易的函数和对象（如上面的颜色示例），并将它们与一长串样式类组合在一起，存储为对象。这些类使用辅助函数。

像这样：

```
//Provide helper functions
COLORS = { RED: 'etc' };
IOS_ANDROID = function(iosValue,androidValue){ 
    if (Device.isIOS) {

        return iosValue
    } else {
        return androidValue
    };

//Provide the styles as exports object (using commonJS)
exports.styles = {
    winHome: {
        backgroundColor: COLORS.RED
    },
    winProducts: {
        navBarHidden: IOS_ANDROID(true,false),
    }
} 
```

现在我的应用程序已经长大了，这个样式对象的大小变得很烦人。我正在尝试将样式拆分为几个 .js 文件，并使用包含和要求组合它们（以及必要的功能）。所以我现在有一个“css-Home.js”、“css-Products.js”等。

这有点工作，但我目前需要在每个 css-.js 文件中重新包含/需要帮助函数。这感觉很尴尬。我试图严格遵守只使用 require() 而不使用 include() 的 CommonJS 实践。但是，如果我使用 require() 添加辅助函数，就像这样......

```
var cssHelpers = require('css-helpers.js') 
```

...然后我需要在所有助手前面加上该变量，就像这样...

```
exports.styles = {
    winHome: { 
        backgroundColor: cssHelpers.COLORS.RED,
    },
} 
```

这就是为什么我想在应用程序初始化期间将这些基本的东西放入 Ti.UI 中。然后我将在任何地方都可以使用样式辅助函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T17:53:53.860

如果您必须扩展默认对象，请尝试使用 applyproperties 方法，这将是推荐的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T10:24:23.740

我找到了一个不涉及更改 Ti.UI 的不错的解决方案。提示来自尝试在 Android 上运行应用程序并发现它在不同部分之间传递的变量更少。所以我需要深入挖掘 CommonJS 的原理以及 require() 和 Ti.include() 的含义。

不必在我的 CSS 助手前面加上其父级名称的技巧如下：

1.  在需要帮助函数的文件中需要一个 CSS-helpers.js 文件。
2.  让 CSS-helper.js 的导出对象只返回一个函数。
3.  要求后立即执行该功能。像这样：

    //将 CSS 辅助函数作为局部变量引入 require('shared/css-helpers')();

4.  在 CCS-helpers 的一个导出函数中，使用“this”变量将函数直接应用于包含 globals 的 js 上下文：

    出口 = 函数（）{ this['IOS_ANDROID'] = 函数（ios,android）{ 等 }; this['otherHelperFunction'] = function(){}; }

现在，在包含 CSS-helpers 的文件中，您可以使用不带任何前缀的 IOS_ANDROID() 等辅助函数。这是因为 CSS-helpers 中的 'this' 变量指向调用函数的上下文。

# java - 针对 WAR 运行测试

> ID：14341831
> 
> 赞同：1
> 
> 时间：2013-01-15T16:08:28.887
> 
> 标签：java, unit-testing, testing, http-unit

我的应用程序的文件夹结构与 WAR 文件不同。web.xml 等配置文件位于配置文件夹中，消息包/资源文件位于资源文件夹中，资源文件存储为 UTF-8 等。Ant 构建用于生成结构正确的 WAR。

目前，正在使用容器内测试框架（Cactus）；但是，该框架已不再维护。

是否有容器外的测试框架可以爆炸 WAR，而不是要求源代码的文件夹结构与 WAR 的文件夹结构相匹配？如果框架支持将文件的实际位置映射到它们未来的 WAR 位置，那也可以。

是否有仍在维护的容器内测试框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:36:50.180

选项是有限的。还有一些其他框架可以做类似的事情。[MockRunner](http://mockrunner.sourceforge.net/)也已停产。[Spring Mock](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mock/web/package-summary.html)可能是一个选项，但它缺少一些功能（如果您需要 HTTP 请求转发，则必须扩展一些类）。

我在 Jetty 上取得了一些成功，因为从测试用例中启动嵌入的 Jetty 很容易，但是当然，这将真正启动您的应用程序，就好像它真的被部署了一样，这可能不是您想要的[。](http://www.eclipse.org/jetty/)

这就是为什么我通常尝试编写不包含对 Java EE 类型的任何依赖关系的代码的原因。这样，我可以以我喜欢的任何方式测试所有内容。

然后 CI 服务器有一个单一的（缓慢的）测试，它偶尔运行一次，部署整个应用程序（包括擦除数据库并用干净的测试数据填充它）并执行一些简单的 UI 操作（登录、浏览一些页面） .

# android - 如何在布局属性中使用动态变量？

> ID：14341834
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:08:35.337
> 
> 标签：android, variables, layout, dynamic, global

嗨，我是 Android 的新开发人员

我想创建全局变量以将它们放在我的布局中，如下所示：

在 Java 中：`final dimen myglobalValue = screenSize.width; final dimen myglobalValue2 = screenSize.height;`

在布局中：

```
 <TextView
android:layout_width="@dimen/myglobalValue"
android:layout_height="@dimen/myglobalValue2"
android:text="@string/app_name"
android:textSize="18dp"
android:textColor="#ffffffff"
android:layout_alignParentBottom="true"
android:layout_alignParentRight="true" /> 
```

但在不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:18:04.490

你不能这样做; 通常，您不能在运行时修改资源。

你可以做什么：

*   在代码（java）中，inflating布局后，可以为视图的宽高指定其他值；虽然我不推荐它。

*   如果您只想让视图与显示器一样宽和高，请使用：

    android:layout_width="fill_parent" android:layout_height="fill_parent" 用于 TextView 及其父 ViewGroup（LinearLayout 等）。可能需要进行一些 XML 修饰以删除边距等。

# javascript - 编辑 D3 Sunburst 可视化的 innerRadius

> ID：14341836
> 
> 赞同：4
> 
> 时间：2013-01-15T16:08:38.480
> 
> 标签：javascript, svg, d3.js, sunburst-diagram

如何更改 Sunburst 可视化最内圈的半径？请参阅以下示例：（[http://bl.ocks.org/d/910126/](http://bl.ocks.org/d/910126/) - 注意中心区域有多大；可以更小吗？）

![在此处输入图像描述](../Images/7ea4f7e3ef6a82cb5e5ce2428c53180d.png)

此外，是否可以为 Sunburst 中的所有图层定义不同的高度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-10T14:31:29.037

`Yes`， 有可能的。

* * *

## 基本示例

[jsfiddle](http://jsfiddle.net/BmW2q/)

![在此处输入图像描述](../Images/e2de1ffafbcfc8bb09190971e8e308cd.png)

* * *

## 自定义层高 1

[jsfiddle](http://jsfiddle.net/QDP9H/)

![在此处输入图像描述](../Images/b1fd22dc20e06b98d29a6e03646f3b80.png)

* * *

## 自定义层高 2

[jsfiddle](http://jsfiddle.net/Hq4ef/)

![在此处输入图像描述](../Images/50b72a7350a503b08ca09161a8ae89fb.png)

* * *

## 自定义层高 3

[jsfiddle](http://jsfiddle.net/gq7GR/)

![在此处输入图像描述](../Images/4aae6a3f8dc42ea4ad19c8eeb1b0d2c6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-23T16:12:57.343

我刚刚比较了上面的例子，所以不能在这里声称任何高超的技能\知识，但所有的变化都在这个部分：

```
var arc = d3.svg.arc()
    .startAngle(function(d) { return d.x; })
    .endAngle(function(d) { return d.x + d.dx; })
    .innerRadius(function(d) { return radius * Math.sqrt(d.y) / 10; })
    .outerRadius(function(d) { return radius * Math.sqrt(d.y + d.dy) / 10; }); 
```

当我找到这个问题\答案时，效果很有趣，但并不是我想要的。我真的希望能够单独控制每一层\环的大小。无论如何...希望以上 jsfiddles 的挑选对其他人有所帮助。

# c++ - 如何从 2 个单独的线程同步打印奇数和偶数

> ID：14341837
> 
> 赞同：-4
> 
> 时间：2013-01-15T16:08:41.547
> 
> 标签：c++, multithreading, winapi

我想在 win32 C++ 中以同步方式从 2 个单独的线程中打印奇数和偶数。我正在使用关键部分来实现它，但没有得到想要的结果。可以使用临界区来完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:17:32.773

我相信它只能用关键部分来完成，但方式并不明显。

```
// all in pseudocode:

mutex printMutex;
int printedOdd = 1;

//thread 1
int start = 1;
while(1) {
  lock (printMutex);
  if (printOdd == 1) {
    print ( start );
    start += 2;
    printedOdd = 0;
  } else {
    unlock (printMutex);
    yield();
    continue;
  }
  unlock (printMutex);
}

// thread 2
int start = 2;
while(1) {
  lock (printMutex);
  if (printOdd == 0) {
    print ( start );
    start += 2;
    printedOdd = 1;
  } else {
    unlock (printMutex);
    yield();
    continue;
  }
  unlock (printMutex);
} 
```

我实际上并不理解做这样的事情的意义，但答案是......一个答案:)

# flash - 用于创建游戏的平台

> ID：14341840
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:08:46.593
> 
> 标签：flash

使用什么平台来创建智力游戏、谜题等类型的游戏比较好。我们只是初学者，我们无法决定使用什么平台。请帮忙。我可以要求参考。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:13:55.593

这取决于您所针对的平台。[过去我用Unity](http://unity3d.com/)做过一些工作，免费版本允许网络发布。如果您随后扩展到 iOS、Android 或它支持的其他平台，您需要为发布许可付费。

Adobe Flash 还不错，我相信您根据这篇文章的标签就知道了，尽管您必须从 Adob​​e 购买该程序才能合法地发布任何内容。

我听说过一些关于[GameMaker Studio](http://store.steampowered.com/app/214850/)的好消息，但老实说，我对此了解不多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:13:44.210

我建议移动网络富互联网应用程序在浏览器上使用 jquery 和 spin.js 或主干.js，在 heroku 上托管的服务器上使用 express.js 和 mongoose/mongo 的 node.js。一种语言，易于托管，编程有趣，部署速度快。

# php - 使用 array_key_exists

> ID：14341854
> 
> 赞同：0
> 
> 时间：2013-01-15T16:09:19.650
> 
> 标签：php, arrays

我有一个可以通过访问的数组`$request`（这与 不同`$_REQUEST`）。数组 print_r 的输出为

```
Array
(
    [num_days] => 30
    [customer_id] => 5
) 
```

`num_days`密钥可能存在也可能不存在（可以是任意数量的东西。）我需要测试以查看密钥是否存在。我试过这个：

```
if(array_key_exists($request['num_days'], $request)) {
    echo "num_days exists";
}
else {
    echo "num_days doesn't exist";
} 
```

这总是打到其他人。我做错了吗？num_days 不被视为密钥吗？如果不是，我如何测试该元素的存在（不是它的值，而是它是否存在）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:11:20.943

使用`array_key_exists('num_days', $request)`或`isset($request['num_days'])`

您所做的是**错误**的，只是检查该数组元素的值是否作为键存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:13:32.333

你所做的是错误的

array_key_exists — 检查给定的键或索引是否存在于数组中

**您的带有 array_key_exists 的代码** [阅读更多](http://php.net/manual/en/function.array-key-exists.php)

```
if(array_key_exists('num_days', $request)) {
    echo "num_days exists";
}
else {
    echo "num_days doesn't exist";
} 
```

**使用 isset 的替代方法** [阅读更多](http://php.net/manual/en/function.isset.php)

```
 if(isset($_REQUEST['num_days'])) {
        echo "num_days exists";
    }
    else {
        echo "num_days doesn't exist";
    } 
```

# android - 使用适用于 Android 的 Adob e Air Mobile 根据设备方向进行平滑的视图调整

> ID：14341856
> 
> 赞同：3
> 
> 时间：2013-01-15T16:09:21.860
> 
> 标签：android, actionscript-3, mobile, air, device-orientation

我正在寻找一种更好的方法来使用原生 AS（非柔性）Air for mobile 来响应方向变化。当前使用的实现`stage.autoOrients = true`非常糟糕，并且看起来不像专业应用程序中原生方向更改的方式那样完美。

您如何处理 Android 移动设备上的方向更改和平滑重新布局（我尚未在 iOS 上进行测试）？您是否接受自动重新定位动画、截断显示和重新布局视图之前的延迟？有没有一种时髦的解决方法可以让你在屏幕外绘制东西，或者以其他方式让用户体验不那么糟糕，更像原生应用程序的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-14T14:23:22.297

您可以将 autoOrients 设置为 false 并收听[Accelerometer Events](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/sensors/Accelerometer.html)。

通过这种方式，您可以猜测设备方向，并在需要时使用您自己的过渡和动画执行您自己的舞台旋转。

# forms - Symfony2 - 如何用大量数据（接近 40.000）填充选择字段

> ID：14341857
> 
> 赞同：1
> 
> 时间：2013-01-15T16:09:23.617
> 
> 标签：forms, symfony, orm, doctrine-orm

我使用 Symfony 2。到目前为止，我有 2 个捆绑包。第一个包称为 UserBundle，是使用 FosUserBundle 构建的。第二个包称为 GeoBundle，包含一个名为 France 的实体，其表包含近 40.000 条记录。每条记录指的是一个带有邮政编码、区域代码的城市......基本上我在我的用户注册表单中使用这个实体，以便用户可以从列表中选择一个合适的城市。顺便说一句，我使用实体字段类型来做到这一点。

我的问题是，表中只有几条记录一切正常，但几乎有 40.000 条记录，我的表单所在的页面甚至没有打开。我已经将 php.ini 中的内存扩展至 256M 或更多，但页面仍未打开。

所以我的问题很简单。用这么多记录填充选择字段的最佳解决方案是什么？我当然愿意接受其他解决方案。先感谢您。干杯。马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:17:20.090

您可能最好使用自动完成字段。您可以在 Google 上找到大量解决方案。或者尝试像[https://github.com/shtumi/ShtumiUsefulBundle这样的捆绑包](https://github.com/shtumi/ShtumiUsefulBundle)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:18:51.120

简单地不要加载完整列表，这对您的服务器、带宽和客户端所需的内存都是不利的（如果它是移动浏览器，算了吧！）

我建议使用**jQuery UI Autocomplete**，这是一个 jQuery 插件，可以通过 Ajax 从您的服务器加载所需的元素，因此您不必加载孔的东西。它也经过了很好的测试并且易于实施。

[http://jqueryui.com/autocomplete/#remote-jsonp](http://jqueryui.com/autocomplete/#remote-jsonp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T07:40:27.880

尝试使用这个 Symfony2 包。

[https://github.com/genemu/GenemuFormBundle/blob/master/Resources/doc/jquery/autocomplete/text.md](https://github.com/genemu/GenemuFormBundle/blob/master/Resources/doc/jquery/autocomplete/text.md)

这在 Symfony2 中非常有帮助。它将节省您的时间并查看其其他扩展

# css - Chrome 没有完全渲染 CSS

> ID：14341859
> 
> 赞同：0
> 
> 时间：2013-01-15T16:09:28.457
> 
> 标签：css, google-chrome, rendering, font-face

**编辑：**

Chrome 以某种方式错误地渲染了我通过 @font-face 使用的字体。当我将检查元素的字体系列更改为 arial 时，我发现了这一点。这可能是因为我正在寻找有关 chrome 如何呈现字体的修复程序，以使它们看起来更平滑而不是像素化，我发现您可以交换字体格式的顺序并将 svg 放在顶部，这会导致chrome 来完美渲染它。[如此处](http://www.adtrak.co.uk/blog/font-face-chrome-rendering/)所见。

所以要么是顺序把它们弄乱了，要么只是字体以某种方式被破坏了。

现在的问题是，我如何在不破坏网站并保持字体流畅的情况下使用这种字体？

**这是我使用的@font-face 代码：**

```
@font-face {
    font-family: 'alegreya_scregular';
    src: url('../includes/fonts/alegreyasc-regular-webfont.eot');
    src: url('../includes/fonts/alegreyasc-regular-webfont.eot?#iefix') format('embedded-opentype'),
     url('../includes/fonts/alegreyasc-regular-webfont.svg#alegreya_scregular') format('svg'),
         url('../includes/fonts/alegreyasc-regular-webfont.woff') format('woff'),
         url('../includes/fonts/alegreyasc-regular-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'droid_sansregular';
    src: url('../includes/fonts/droidsans-webfont.eot');
    src: url('../includes/fonts/droidsans-webfont.eot?#iefix') format('embedded-opentype'),
         url('../includes/fonts/droidsans-webfont.svg#droid_sansregular') format('svg'),
         url('../includes/fonts/droidsans-webfont.woff') format('woff'),
         url('../includes/fonts/droidsans-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;

}

@font-face {
    font-family: 'droid_sansbold';
    src: url('../includes/fonts/droidsans-bold-webfont.eot');
    src: url('../includes/fonts/droidsans-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('../includes/fonts/droidsans-bold-webfont.svg#droid_sansbold') format('svg'),
         url('../includes/fonts/droidsans-bold-webfont.woff') format('woff'),
         url('../includes/fonts/droidsans-bold-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

* * *

我在 chrome 上遇到了一些渲染问题。由于某种原因，右侧的链接被截断，因此下划线只会填充一半的文本，而右侧的 div 不会将单词换行。它只在某些时候发生，如果我刷新页面几次（不同的次数）它最终会自行修复。图片如下。

注意：该网站使用丹麦语。

图片，用红色强调了问题：

[http://i.stack.imgur.com/zJHXD.jpg](http://i.stack.imgur.com/zJHXD.jpg)

是什么原因造成的，我该如何解决？

* * *

**注意：这是用于导航链接**

HTML：

```
<ul class="nav">
    <li class="first"></li>
    <li><a href="forside.html">Forside</a></li>
    <li><a href="booking.html">Booking</a></li>
    <li><a href="galleri.html">Galleri</a></li>
    <li><a href="begivenheder.html">Begivenheder</a></li>
    <li><a href="events.html">Events</a></li>
    <li><a href="politik.html">Politik</a></li>
    <li><a href="kontakt.html">Kontakt</a></li>
</ul> 
```

CSS：

```
.header .nav {
    position: absolute;
    overflow: hidden;
    font-size: .70em;
    bottom: -8px;
    right: 16px;
}
.header .nav li {
    float: left;
    background: #171717 url(../images/site/nav_divider.png) repeat-y right;
    text-transform: uppercase;
} .header .nav li:hover {
    background: #1a1a1a url(../images/site/nav_divider.png) repeat-y right;
}

.header .nav .first {
    width:2px;
    height:31px;
    margin-bottom:-0.95em;
}

.header .nav li a {
    display: block;
    padding: .75em .85em .75em .75em;
    color: #e0e0e0;
    text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:47:51.323

在对@font-face 和 chrome 行为进行了一些搜索之后，我找到了解决问题的方法。显然将 svg 移到顶部会使渲染的字体破坏布局，因此您应该保留原始格式并添加特殊的媒体查询，这将在不破坏布局的情况下在 chrome 中平滑地渲染字体。

**例子：**

```
@font-face {
    font-family: 'droid_sansregular';
    src: url('../includes/fonts/droidsans-webfont.eot');
    src: url('../includes/fonts/droidsans-webfont.eot?#iefix') format('embedded-opentype'),
         url('../includes/fonts/droidsans-webfont.woff') format('woff'),
         url('../includes/fonts/droidsans-webfont.ttf') format('truetype'),
         url('../includes/fonts/droidsans-webfont.svg#droid_sansregular') format('svg');
    font-weight: normal;
    font-style: normal;

}

@media screen and (-webkit-min-device-pixel-ratio:0) {
    @font-face {
        font-family: 'droid_sansregular';
        src: url('../includes/fonts/droidsans-webfont.svg#droid_sansregular') format('svg');
        font-weight: normal;
        font-style: normal;
    }
} 
```

# asp.net - 需要有效的方法从调查经理的 excel 文件执行数据库更新

> ID：14341860
> 
> 赞同：0
> 
> 时间：2013-01-15T16:09:29.617
> 
> 标签：asp.net, database, excel, application-design

我有一棵具有响应单元结构的树。受访者所属单位。让我们假设银行有两个部门，所以我将拥有：

```
 + Accountants
     - Homer Simpson
     - Bart Simpson
     - Leny
  + It department 
     - Charles Bartowski
     - Sarah Walker
     - Bill 
```

会计师和 IT 部门是部门，而受访者则是其中的一部分。每个`respondent`都有一般属性：

```
 - Email
 - Language
 - Name
 - DepartmentID 
```

每个部门都可以为所有受访者提供自己的动态属性：

```
 - Salary
 - Respondent age
 - Gender 
```

可以在运行时添加和删除此属性。它们存储为表

特性：

```
- Property name
- Property ID 
```

属性值：

```
 - PropertyValueID
 - PropertyID
 - Value 
```

我需要执行将它们导出到`Excel`文件中的可能性，然后用户可以在此 excel 中编辑 smth，当他将其上传到服务器时，应该更新数据库。

我确实在Excel中导出。现在我正在寻找执行允许上传的好方法。是否有任何文章或模式可以有效地做到这一点？

提前致谢）

我正在使用 ASP.NET 和 EPPlus 来处理 Excel。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:59:23.173

I will start my answer with a strong recommendation to not do this! =)

Exporting to Excel will be easy because your database is consistent and abides by certain rules and logic.

If you let a user modify an Excel file, let them upload it, and then try to parse it and update a database, you're asking for a lot of headaches.

Here is how you might think about doing it:

1.  First I would let them upload the file. Not sure what you're using for that, but it's the obvious start.
2.  Next I would create a job to import the Excel file into the database. If it's SQL Server, I would import it with an SSIS job as an example. The goal is to bring it in to your database in a temporary table.
3.  Write some code to read from the temporary table (which is your recently imported Excel data) and do validations. Validate the field names are correct, the data types are correct, etc.
4.  Write code to import the data from the temporary table to your master table(s). You only do this *after* you've verified programatically the imported file is good.
5.  Make sure you lock down Excel as much as possible. Lock the sheet(s) so the user can't modify your data entry template. Try to do validations in Excel so they don't use values that are wrong. (For example, if you have an enumeration, make sure they stick to it instead of putting in free form text.)

The real problem with this approach is that users are crazy and they will not follow your template or guidelines. I would expect to spend a lot of time debugging bad imports.

It's not an option to make a simple web application to let them add/edit data? That way you would have more control over their input. Excel potentially gives them too much power.

(Then again you can make forms with VBA in Excel to maybe restrict their input.)

# haskell - 如何打印出 Haskell 列表中的每个项目？

> ID：14341863
> 
> 赞同：3
> 
> 时间：2013-01-15T16:09:32.333
> 
> 标签：haskell, list-comprehension

我有一个类似的列表：

`[[1,2,3,4,5],[6,7,8,9]]`

我正在尝试使用列表理解来做到这一点，并且已经达到：

`each_in_lists x = [show y | y <- x]`

`x`列表列表在哪里。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T16:14:59.683

您是否尝试将其转换为字符串

```
> let x = [[1,2,3,4,5],[6,7,8,9]] 
> [show a | y <- x, a <- y]
["1","2","3","4","5","6","7","8","9"] 
```

如果您尝试打印，请使用`print`. `print`使用元素的 show 实例将其转换为字符串，然后使用`putStrLn`.

```
> mapM_ (mapM_ print) x                          
1                                                                                   
2                                                                                   
3                                                                                   
4                                                                                   
5                                                                                   
6                                                                                   
7                                                                                   
8                                                                                   
9 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T21:59:41.997

到目前为止，其他答案共享我认为的一个大缺陷：将问题拆分为较小的子问题总是好的，但他们不这样做。在这种情况下，适用的子问题是：

1.  展平嵌套列表
2.  打印平面列表的内容

执行 #1 的标准功能是`concat`：

```
>>> concat [[1,2,3,4,5],[6,7,8,9]]
[1,2,3,4,5,6,7,8,9] 
```

现在，打印元素的最简单方法是`mapM_ print`，正如其他答案所建议的那样：

```
>>> mapM_ print (concat [[1,2,3,4,5],[6,7,8,9]])
1
2
3
4
5
6
7
8
9 
```

这可以推广到各种情况，顺便说一句：在 Haskell 中，顺序迭代某些结构的元素的直接方法是将其转换为平面列表，然后处理该列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T17:32:52.610

扩展 Satvik mapM_ 回答一些我认为如果不是使用嵌套结构，例如：

```
> mapM_ (mapM_ print) x 
```

一种利用功能组合的结构。

```
> (mapM_.mapM_) print x 
```

这样做的好处是，您可以通过添加另一个 mapM_ 来简单地将其扩展到列表列表 [[[a]]] 的列表。

```
> (mapM_.mapM_.mapM_) print x 
```

这种组合概念[甚至可以进一步](https://github.com/ekmett/lens/wiki/Derivation)包括元组 [[(a,a)]] 和数据结构。这是在[lens](http://hackage.haskell.org/package/lens)中完成的。打印 [(a,a)] 的所有元素的示例是：

```
mapMOf_ (traverse.both) print [(1,2),(3,4),(5,6)] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T16:40:00.437

假设您正在尝试展平列表并希望尽可能多地使用列表理解，我认为以下内容与您将得到的最接近。

```
x = [[1,2,3,4,5],[6,7,8,9]]

sequence [print z | y <- x, z <- y] 
```

# eclipse - 如何在 Mac OS X 上安装 JRE 1.7 并将其与 Eclipse 一起使用？

> ID：14341865
> 
> 赞同：68
> 
> 时间：2013-01-15T16:09:36.727
> 
> 标签：eclipse, macos, java

我想使用[从 Oracle 网站](http://java.com/fr/download/mac_download.jsp?locale=fr)下载的 JRE 1.7 。

所以我正确安装了 .pkg 文件，当我`/Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java -version`在终端中尝试时，我得到了这个：

> java 版本“1.7.0_11”Java(TM) SE 运行时环境（构建 1.7.0_11-b21）Java HotSpot(TM) 64 位服务器 VM（构建 23.6-b04，混合模式）

但在 Eclipse 中，除了 JRE 1.6 之外，我不能使用其他任何东西。当我进入“属性”>“Java 构建路径”>“添加库”>“JRE 系统库”时，我找不到 1.7（它只有一个选项：`JavaSE-1.7 (unbound)`这个问题：

> 工作空间中没有与指定执行环境兼容的 JRE：JavaSE-1.7

我应该怎么办 ？谢谢

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-01-15T16:52:15.157

`java.com`从中安装的下载`/Library/Internet Plug-Ins`只是 JRE，对于开发，您可能希望从[http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)下载 JDK并安装它。这将安装 JDK，`/Library/Java/JavaVirtualMachines/jdk1.7.0_<something>.jdk/Contents/Home`然后您可以通过 Preferences -> Java -> Installed JREs 添加到 Eclipse。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-15T16:25:11.820

尝试编辑 eclipse.ini 文件并在顶部添加以下内容

```
-vm
/Library/Java/JavaVirtualMachines/jdk1.7.0_09.jdk/Contents/Home 
```

当然路径可能略有不同，看起来我有一个旧版本......

我不确定它是否会自动添加。如果不进入

首选项 --> Java --> 已安装的 JRE

单击添加并按照那里的说明添加它

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-15T16:45:30.093

您需要告诉 Eclipse 您安装了哪些 JDK/JRE 以及它们的位置。

这有点隐藏在 Eclipse 首选项中：在 Window-Menu 中选择“Preferences”。在首选项树中，打开节点“Java”并选择“Installed JRE's”。然后单击面板中的“添加”-按钮并选择“标准 VM”、“下一步”，对于“JRE Home”单击“目录”-按钮并选择要添加的 JDK 的顶级文件夹。

它比描述更容易使它看起来。

# html - 如何在 html 中设置箭头 od 选择下拉框的样式？

> ID：14341866
> 
> 赞同：0
> 
> 时间：2013-01-15T16:09:37.850
> 
> 标签：html, select

我只想用我自己的自定义箭头更改选择框中的箭头，而不使用任何 javascript 和 jquery。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-16T06:51:25.443

我无法清楚地理解你..

这是我的想法和建议：html：

```
<div class="my_checkbox">
<input type="checkbox" value="None" id="my_checkbox" name="check">
<label for="my_checkbox"></label>
</div> 
```

和CSS：

```
.my_checkbox input[type=checkbox]:checked + label:after {
-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
filter: alpha(opacity=100);
opacity: 1;
} 
```

所有人：[点我](http://cssdeck.com/labs/z7nvb163)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:12:11.270

你不能。它由操作系统呈现，而不是浏览器。有一些使用绝对定位的 hack 变通办法，但控件本身不能在浏览器之间可靠地设置样式。

# windows-8 - 根据 WinRT 的构建配置设置应用程序图标

> ID：14341870
> 
> 赞同：2
> 
> 时间：2013-01-15T16:09:42.457
> 
> 标签：windows-8, microsoft-metro, windows-runtime, manifest

我已经构建了一个 WinRT 应用程序。

当我使用 Debug 运行它时，我希望它在发布时具有不同的图标。

这可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T03:51:32.090

一种选择是预构建步骤。假设您将资产目录设置为：

```
Assets
    Debug
        logo.png  // debug version of logo
    Release
        logo.png  // release version of logo
    logo.png      // location of logo provided in app manifest 
```

在预构建步骤中（通过项目的属性），您可以使用以下命令：

```
 copy "$(ProjectDir)Assets\$(ConfigurationName)\logo.png"  "$(ProjectDir)Assets" /Y 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:35:55.533

这看起来也是一个可行的选择，并且可以证明更强大，我不仅可以更改图像，而且我还可以操作包名称（用于并行加载）以及清单中的任何其他内容（像背景颜色这样的小东西）。

[示例：如何使用构建后事件更改清单信息](http://msdn.microsoft.com/en-us/library/vstudio/ke5z92ks%28v=vs.100%29.aspx)

# asp.net-mvc-4 - ASP.NET MVC 电子商务解决方案（商业或开源）

> ID：14341875
> 
> 赞同：20
> 
> 时间：2013-01-15T16:10:05.637
> 
> 标签：asp.net-mvc-4, e-commerce, ninject, entity-framework-5

好的，所以我们有一个使用以下内容的开发基础架构： 1\. MVC 4（Razor 视图） 2\. Entity Framework 5 代码优先 3\. Ninject

我正在寻找的是尽可能接近我们现有基础设施的电子商务解决方案，以期尽可能无缝集成。

我看过很多很多选项，包括：1\. NopCommerce 2\. Magelia 3\. dashCommerce 4\. DotShoppingcart

到目前为止，NopCommerce 和 Magelia（尤其是 NopCommerce）似乎是我能找到的最接近的。我正在寻找其他电子商务解决方案的建议，这些解决方案可能更好地与我们上面提到的现有基础设施集成。成本真的不是问题，所以它可以是开源的或商业的。

欢迎任何和所有建议。

谢谢

缺口

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-04T18:20:09.440

try this [http://virtocommerce.com/](http://virtocommerce.com/) and enterprise open source ecommerce solutions using the latest technology of .Net

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:42:42.577

缺口，

我还没有机会评估它，因为我在找到您的帖子之前就遇到了它（我正在为我的公司进行类似的搜索），但您可能会考虑 [http://merchanttribe.codeplex.com /](http://merchanttribe.codeplex.com/)

正如我所说，我什至还没有查看代码，但他们有一个开源 MVC 电子商务平台。

德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-19T09:04:29.700

缺口，

您还可以查看[Cart42](http://www.cart42.com "购物车42") ( [GitHub](https://github.com/eStream/Cart42 "GitHub") )。它使用带有 Razor 视图的 ASP.NET MVC、带有代码优先的实体框架 5。但是对于 DI，它使用 StructureMap 而不是 Ninject。

# c# - 在这个程序中需要改变什么才能产生良好的输出？

> ID：14341879
> 
> 赞同：0
> 
> 时间：2013-01-15T16:10:11.800
> 
> 标签：c#

下面的代码取自我正在学习的书，他们说输出的后半部分应该是大写的，这要归功于 OnCarEngineEvent2。但是，当我编译程序时，情况并非如此。为什么它不起作用，需要改变什么？谢谢。

```
public class Car
{
// Internal state data.
public int CurrentSpeed { get; set; }
public int MaxSpeed { get; set; }
public string PetName { get; set; }

// Is the car alive or dead?
private bool carIsDead;

// Class constructors.
public Car() { MaxSpeed = 100; }
public Car(string name, int maxSp, int currSp)
{
    CurrentSpeed = currSp;
    MaxSpeed = maxSp;
    PetName = name;
}

// 1) Define a delegate type.
public delegate void CarEngineHandler(string msgForCaller);

// 2) Define a member variable of this delegate.
private CarEngineHandler listOfHandlers;

// 3) Add registration function for the caller.
public void RegisterWithCarEngine(CarEngineHandler methodToCall)
{
    // listOfHandlers = methodToCall;
    // listOfHandlers += methodToCall; 
    // listOfHandlers += methodToCall; 
    if (listOfHandlers == null)
        listOfHandlers = methodToCall;
    else
        Delegate.Combine(listOfHandlers, methodToCall);
}

// 4) Implement the Accelerate() method to invoke the delegate’s 
//    invocation list under the correct circumstances.
public void Accelerate(int delta)
{
    // If this car is 'dead', send dead message.
    if (carIsDead)
    {
        if (listOfHandlers != null)
            listOfHandlers("Sorry, this car is dead...");
    }
    else
    {
        CurrentSpeed += delta;

        // Is this car 'almost dead'?
        if (10 == (MaxSpeed - CurrentSpeed)
            && listOfHandlers != null)
        {
            listOfHandlers("Careful buddy!  Gonna blow!");
        }

        if (CurrentSpeed >= MaxSpeed)
            carIsDead = true;
        else
            Console.WriteLine("CurrentSpeed = {0}", CurrentSpeed);
    }
}

}

class Program
{
    static void Main( string[] args )
    {
        Console.WriteLine("***** Delegates as event enablers *****\n");

        // First, make a Car object.
        Car c1 = new Car("SlugBug", 100, 10);
        c1.RegisterWithCarEngine(new Car.CarEngineHandler(OnCarEngineEvent));

        // This time, hold onto the delegate object,
        // so we can unregister later. 
        Car.CarEngineHandler handler2 = new Car.CarEngineHandler(OnCarEngineEvent2);
        c1.RegisterWithCarEngine(handler2);

        // Speed up (this will trigger the events).
        Console.WriteLine("***** Speeding up *****");
        for (int i = 0; i < 6; i++)
            c1.Accelerate(20);

        // We won't see the 'uppercase' message anymore!
        Console.WriteLine("***** Speeding up *****");
        for (int i = 0; i < 6; i++)
            c1.Accelerate(20);

        Console.ReadLine();
    }

    #region Delegate targets
    // We now have TWO methods that will be called by the Car
    // when sending notifications. 
    public static void OnCarEngineEvent( string msg )
    {
        Console.WriteLine("\n***** Message From Car Object *****");
        Console.WriteLine("=> {0}", msg);
        Console.WriteLine("***********************************\n");
    }

    public static void OnCarEngineEvent2( string msg )
    {
        Console.WriteLine("=> {0}", msg.ToUpper());
    }
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:18:03.100

是因为你的`RegisterWithCarEngine`方法。目前，如果已附加事件处理程序，则您调用`Delegate.Combine(listOfHandlers, methodToCall)`但不更新`listOfHandlers`.

利用`listOfHandlers += (CarEngineHandler)Delegate.Combine(listOfHandlers, methodToCall);`

这也可以简化为；

```
 // 3) Add registration function for the caller.
public void RegisterWithCarEngine(CarEngineHandler methodToCall)
{
    listOfHandlers += methodToCall;
} 
```

但请记住**，这不会分离先前的处理程序**，因此您将同时显示小写和大写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:23:22.867

```
public void RegisterWithCarEngine(CarEngineHandler methodToCall)
{
    if (listOfHandlers == null)
        listOfHandlers = methodToCall;
    else
        listOfHandlers += (CarEngineHandler)Delegate.Combine(listOfHandlers, methodToCall);
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-03-29T23:10:37.723

if (listOfHandlers == null) listOfHandlers = methodToCall; 否则 listOfHandlers = (CarEngineHandler)Delegate.Combine(listOfHandlers, methodToCall); //它会比 += 在上下文中更好;)

# php - Apache 上传（提供下载）php 而不是执行它

> ID：14341881
> 
> 赞同：2
> 
> 时间：2013-01-15T16:10:14.390
> 
> 标签：php, apache, fastcgi, webmin

我在 Webmin 上使用 Virtualmin 在 VPS 上配置我的网站。

一切正常，但现在我尝试创建一个新域，但是当我将文件放入其中时，它`public_html`会提供 php 文件下载而不是执行它。如何解决这个问题

这是我的 apache 配置（找不到任何奇怪的东西）：

`/etc/apache2/sites-available/testbyc.--.nu.conf`

```
SuexecUserGroup "#1009" "#1011"
ServerName testbyc.--.nu
ServerAlias www.testbyc.--.nu
ServerAlias webmail.--.--.nu
ServerAlias admin.testbyc.--.nu
DocumentRoot /home/byc/domains/testbyc.--.nu/public_html
ErrorLog /var/log/virtualmin/testbyc.--.nu_error_log
CustomLog /var/log/virtualmin/testbyc.--.nu_access_log combined
ScriptAlias /cgi-bin/ /home/byc/domains/testbyc.--.nu/cgi-bin/
ScriptAlias /awstats/ /home/byc/domains/testbyc.--.nu/cgi-bin/
DirectoryIndex index.html index.htm index.php index.php4 index.php5
<Directory /home/byc/domains/testbyc.--.nu/public_html>
Options -Indexes +IncludesNOEXEC +SymLinksIfOwnerMatch +ExecCGI
allow from all
AllowOverride All Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
AddHandler fcgid-script .php
AddHandler fcgid-script .php5
FCGIWrapper /home/byc/domains/testbyc.--.nu/fcgi-bin/php5.fcgi .php
FCGIWrapper /home/byc/domains/testbyc.--.nu/fcgi-bin/php5.fcgi .php5
</Directory>
<Directory /home/byc/domains/testbyc.--.nu/cgi-bin>
allow from all
AllowOverride All Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
</Directory>
RewriteEngine on
RewriteCond %{HTTP_HOST} =webmail.testbyc.--.nu
RewriteRule ^(.*) https://testbyc.--.nu:20000/ [R]
RewriteCond %{HTTP_HOST} =admin.testbyc.--.nu
RewriteRule ^(.*) https://testbyc.--.nu:10000/ [R]
php_admin_value engine Off
IPCCommTimeout 31
FcgidMaxRequestLen 1073741824
<Files awstats.pl>
AuthName "testbyc.--.nu statistics"
AuthType Basic
AuthUserFile /home/byc/domains/testbyc.--.nu/.awstats-htpasswd
require valid-user
</Files>
RedirectMatch /cgi-bin/mailman/([^/\.]*)(.cgi)?(.*) https://testbyc.--.nu:10000/virtualmin-mailman/unauthenticated/$1.cgi$3
RedirectMatch /mailman/([^/\.]*)(.cgi)?(.*) https://testbyc.--.nu:10000/virtualmin-mailman/unauthenticated/$1.cgi$3
Alias /pipermail /var/lib/mailman/archives/public 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T21:14:17.060

尝试注释掉该行

`php_admin_value engine Off`

这与我仍在研究的一个更大的问题有关，但最近对 Virtualmin 的更新将该行添加到了一些与 FCGI 相关的配置文件中，从而为一些用户破坏了一些东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-14T02:32:36.883

正如接受的答案所说，注释掉

```
php_admin_value engine Off 
```

我们在将站点从使用 PHP 5.X 的 Virtualmin Install 移动到使用 PHP 7.1 的新服务器时遇到了这个问题。

发生的事情是 PHP7.1 的默认配置如下

```
<IfModule mod_userdir.c>
<Directory /home/*/public_html>
    php_admin_flag engine Off
</Directory>
</IfModule> 
```

这通过将该标志添加到所有本地 .conf 文件来阻止 virtualmin 在用户目录中运行 PHP 脚本。

php7.conf 文件`/etc/apache2/mods-available/php7.conf`也有以下内容

```
SetHandler application/x-httpd-php 
```

这导致所有子站点都使用进程 www-data 而不是 virtualmin 用户运行。导致写访问错误。所以也把它注释掉。

# css - 已选择 WinJS 列表视图样式

> ID：14341884
> 
> 赞同：1
> 
> 时间：2013-01-15T16:10:29.890
> 
> 标签：css, windows-8, css-selectors, windows-store-apps, winjs

我希望在选择 WinJS Listivew .win-item 时更改 CSS 样式（通过右键单击 || 向下滑动）。

本质上，我有两组数据将显示在 ListView 中。一个在加载时（默认...当前`#itemName`），一个在项目被选择、悬停或聚焦时。（目前`#itemValue and IMG`）

我有一个`WinJS.Binding.Template`如下：

```
<div id="itemTemplate" data-win-control'WinJS.Binding.Tempalte">
    <div id="imageContainer">
        <h4 id="itemName" data-win-bind="textContent: itemName"></h4>
        <h4 id="itemValue">$0.00</h4>
        <img src="#" alt="">
    </div>
</div> 
```

在我的 .CSS 文件中，我目前有以下内容：

```
/** note IMG and #itemValue opacity previously set to 0 **/
#itemList .win-item:hover #itemName, #itemList .win-item:focus #itemName {opacity 0;}
#itemList .win-item:hover IMG, #itemList .win-item:focus IMG{opacity 0;}
#itemList .win-item:hover #itemValue, #itemList .win-item:focus #itemValue{opacity 0;} 
```

我想在选择一个项目时保持这种样式，但没有主动聚焦或悬停在上面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:21:22.423

相信你想要`::selection`。从 Visual Studio 运行您的应用程序，选择一个项目，然后返回 VS 并查看 DOM Explorer。单击 DOM Explorer 选项卡正下方的“选择元素”。然后在您的应用程序中单击您选择的项目。这将带您回到 VS。查看**样式**和**跟踪样式**窗格，至少在 Visual Studio Ultimate 中位于右侧。您会看到`::selection`所选项目的样式。只需`opacity 0`在您自己的 CSS 文件中设置`::selection`.

如果您想在示例应用程序中使用它，请查看 MSDN 上的[HTML ListView Essentials 示例](http://code.msdn.microsoft.com/windowsapps/ListView-basic-usage-sample-fcc451db)。

编辑：尝试`.win-selectionbackground`：

```
.win-selectionbackground {
    opacity: 0;
} 
```

# html - 如何使用 CSS 填充颜色并使其成为正方形？

> ID：14341888
> 
> 赞同：0
> 
> 时间：2013-01-15T16:10:45.537
> 
> 标签：html, css

我想用白色方块填充所有液体。
如您所见，每种液体都充满了白色，但不是完全正方形。
我用 div class 包裹了整个`WhiteZone`，但它不会使它们成为正方形。
我怎样才能使它成为正方形？

**[现场演示](http://jsfiddle.net/EfwLj/)**

![这不是正方形！](../Images/62da248f0383b2c4741eb04667d8b72f.png)

**HTML**

```
<div class="WhiteZone">
    <div class="Box">
        <div class="Left">
            abcdefg<br />
            opqrstu
        </div>
    </div>
    <div class="Box">
        <div class="Right">
            hijklmn
        </div>
    </div>
</div> 
```

**CSS**

```
div.WhiteZone{
    color: #000;
    background-color: #fff;
}

div.Box{
    padding: 0px;
    text-align: center;
    float: left;
}

div.Left{
    width: 300px;
    padding-top: 5px;
    padding-bottom: 15px;
    text-align: center;
    color: #000;
    background-color: #fff;
    clear: both;
}

div.Right{
    width: 300px;
    padding-top: 5px;
    text-align: left;
    color: #000;
    background-color: #fff;
    clear: both;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:14:46.543

你可以用`display: table`这个。像这样写：

```
div.WhiteZone {
    color: #000;
    background-color: #fff;
    display: table;
}

div.Box {
    padding: 0px;
    text-align: center;
    display: table-cell;
} 
```

检查这个[演示](http://jsfiddle.net/EfwLj/2/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:18:26.620

```
div.WhiteZone{
    color:#000000;
    background-color:#ffffff;
    overflow:hidden;
} 
```

您可以将 overflow:hidden 添加到您的 whitezone 类中，以便它可以拉伸以适应内部浮动 div 的高度。但是只有添加了这个，你才会得到占据整个页面宽度的白色背景。喜欢[这里](http://jsfiddle.net/EfwLj/1/)

为避免这种情况，您还可以添加`float:left`到您的 whitezone 类（如此[处](http://jsfiddle.net/EfwLj/3/)）或`width`为其设置 a（如此[处](http://jsfiddle.net/EfwLj/4/)）

# c# - 使用C#程序如何执行cmd提示命令

> ID：14341891
> 
> 赞同：0
> 
> 时间：2013-01-15T16:10:57.127
> 
> 标签：c#, .net, c#-4.0, c#-3.0

> **可能重复：**
> [.NET 中的 ShellExecute 等效](https://stackoverflow.com/questions/258416/shellexecute-equivalent-in-net)
> [项 从代码执行 CMD 命令](https://stackoverflow.com/questions/1255909/execute-cmd-command-from-code)

例如，我想在命令提示符下取消隐藏驱动器中的所有文件和文件夹，我们使用此命令 **attrib -s -h -r -a /s /di:*.*** 如何使其在 C# 程序中执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:13:09.190

您当然可以通过[编程](http://msdn.microsoft.com/en-us/library/system.io.file.setattributes.aspx)方式进行，但快速而肮脏的解决方案是

```
Process.Start("attrib", "-s -h -r -a /s /d i:*.*"); 
```

# php - 两种形式相互冲突

> ID：14341904
> 
> 赞同：0
> 
> 时间：2013-01-15T16:11:47.943
> 
> 标签：php, forms, conflict, require-once

我在一页上放了两张表格。两种表单单独工作都很好，但是当它们同时放在一个页面上时，它们会相互冲突。以下是两种形式：

联系表：

```
<form name="contactform" id="contactform" method="post" action="#targetAnchorPage2">
<table>
<?php
if (isset($_POST["name"])){
?>
<tr>
 <td colspan="2" class="error">
 <?php
 require_once("contact_send.php");
 ?>
 </td>
</tr>
<?php
}
?>

<tr><td><label for="name" class="<?=$name_class?>">name:</label></td><td><input  type="text" name="name" maxlength="50" value="<?=$name?>"></td></tr>
<tr><td><label for="email" class="<?=$emailaddress_class?>">email:</label></td><td><input  type="text" name="email" maxlength="80" value="<?=$emailaddress?>"></td></tr>
<tr><td colspan="2"><label id="tworows" for="message" class="<?=$message_class?>">your message:</label></td></tr><tr><td colspan="2"><textarea  name="message" cols="22" rows="6" value="<?=$message_class?>"></textarea>
 </td></tr>

<tr>
 <td colspan="2" style="text-align:center"><br /><input class="button" type="submit" value="">   
 </td>
</tr>

</table>
</form> 
```

订阅表格：

```
<form name="subscribeform" id="subscribeform" method="post" action="#targetAnchorPage3">
<table>
<?php
if (isset($_POST["name"])){
?>
<tr>
 <td colspan="2" class="error">
 <?php
 require_once("subscribe_send.php");
 ?>
 </td>
</tr>
<?php
}
?>

<tr><td><label for="name" class="<?=$name_class?>">name:</label></td><td><input type="text" name="name" maxlength="50" value="<?=$name?>"></td></tr>
<tr><td><label for="email" class="<?=$emailaddress_class?>">email:</label></td><td><input type="text" name="email" maxlength="80" value="<?=$emailaddress?>"></td></tr>

<tr>
 <td colspan="2" style="text-align:center"><br /><input class="button" type="submit" value="">   
 </td>
</tr>

</table>
</form> 
```

如何解决？它是由“required_once”命令引起的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:17:21.820

我猜想，由于您根据相同的标准显示所需的文件，`isset($_POST['name'])`并且由于两个表单都有`name`字段，因此无论提交哪种表单，您最终都会在两个要求中显示代码。您应该简单地更改表单上的表单字段名称，以使它们不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:19:05.627

两种形式都有相同的动作属性，它们都指向同一个页面（注意哈希不会发送到服务器）。因为它们都有一个名为的字段`name`并且您正在检查它，所以无论发送哪种表单，这两个操作都会执行。

您可以执行以下任一操作：

*   使用不同的脚本/表单处理器（不要回发到同一页面）
*   对每个表单使用不同的检查，例如通过添加一个隐藏输入来区分表单。

# ruby-on-rails - Rails url 帮助程序在 Rspec 中不起作用

> ID：14341911
> 
> 赞同：5
> 
> 时间：2013-01-15T16:12:04.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, capybara, helpers

我是编程新手，这是我的第一个应用程序。在 Rails 中创建应用程序时，我有两个模型。用户&列表，嵌套。

```
resources :users do
  resources :lists
end 
```

这些是我通过此设置获得的以下路线：

```
user_lists GET    /users/:user_id/lists(.:format)             lists#index
           POST   /users/:user_id/lists(.:format)             lists#create
new_user_list GET    /users/:user_id/lists/new(.:format)      lists#new
edit_user_list GET    /users/:user_id/lists/:id/edit(.:format)lists#edit
user_list GET    /users/:user_id/lists/:id(.:format)          lists#show
           PUT    /users/:user_id/lists/:id(.:format)         lists#update
           DELETE /users/:user_id/lists/:id(.:format)         lists#destroy 
```

关于我已经使用以下链接创建了视图。

```
<div class="stats">
  <a href="<%= user_lists_path(current_user) %>">
    <%= pluralize(current_user.lists.count, 'List') %>
  </a>
</div>

<div class="list">
  <%= link_to 'Create List', new_user_list_path(current_user) %>
</div> 
```

这些按预期工作，但是当我在测试中使用相同的 url 助手时，我得到一个错误。

```
describe "List create page" do 
  let(:user) { FactoryGirl.create(:user) }
  before do  
    user.save
    visit new_user_list_path(user)
  end
  it { should have_selector('title', text: 'SocialTask | List') }
  it { should have_selector('h1', text: 'Create list') }

  describe "invalid list creation" do 
    before { click_button 'Create list' } 
    it { should have_content('Error in creating list') }
  end
 end 
```

这会导致测试出错。

```
Failure/Error: visit new_user_list_path(user)
 NoMethodError:
   undefined method `lists' for nil:NilClass 
```

我试过玩弄不起作用的网址。我尝试更新也不起作用的 rspec/capybara。我还检查了包含

```
config.include Rails.application.routes.url_helpers 
```

在规范助手中。

我如何让助手工作？还是我遗漏了一些小细节？提前致谢。

辅助方法。

```
module SessionsHelper

def sign_in(user)
  cookies.permanent[:remember_token] = user.remember_token
  self.current_user = user 
end

def current_user=(user)
  @current_user = user 
end

def current_user 
  @current_user ||= User.find_by_remember_token(cookies[:remember_token])
end

def signed_in?
  !current_user.nil?
end

def sign_out
  self.current_user = nil 
  cookies.delete(:remember_token)
end

def current_user?(user)
  current_user == user
end
end 
```

用于登录的 rspec 助手。support/utilities.rb

```
include ApplicationHelper
 def sign_in(user)
  visit signin_path
  fill_in "Email", with: user.email
  fill_in "Password", with: user.password
  click_button "Sign in"
  cookies[:remember_token] = user.remember_token
 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:22:20.607

在没有看到堆栈跟踪的情况下，我认为您的问题出在这一行的视图中：

```
<%= pluralize(current_user.lists.count, 'List') %> 
```

好像`current_user`是零。通常，您应该在 RSpec 套件中定义某种帮助方法来模拟用户登录。这样，`current_user`将返回您在测试中存根的用户。

这是一个例子：

```
# spec/support/session_helper.rb
module SessionHelper
  def login(username = 'admin')
    request.session[:user_id] = User.find_by_username(username).id
  end
end 
```

根据您对用户进行身份验证的方式，您的会有所不同。例如，Devise 发布了它自己的一组测试助手，所以你可以简单地直接包含它的助手：

```
# spec/support/devise.rb
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:15:00.683

似乎因为用户不存在而出现错误。尝试更改`user.save`为，`user.save!`然后您会发现我认为的创建错误..

# javascript - 使用 jQuery 检测是否在目标 div 内勾选了复选框

> ID：14341917
> 
> 赞同：1
> 
> 时间：2013-01-15T16:12:22.920
> 
> 标签：javascript, jquery, html, forms, checkbox

我有以下标记，结束跨度标记下方是一个数字列表项。

```
<div class="header_block">
   <span class="background_flag_container">
      <input id="block_background" type="checkbox" name="block_background">
      <span class="background_flag_text">Has Banner Background</span>
   </span>
   ...
</div> 
```

这是我的 jQuery。我要做的是检查是否选中了唯一一个名为“block_background”的复选框。页面上有许多“block_background”复选框，但只有一个*是*div 。`$(this)``.header_block`

```
$(this).find(".background_flag_container input:checkbox[name='block_background']").each(function(){
   if ($(this).checked) {
      console.log('is checked');
   }
}); 
```

如何检查是否已检查？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:14:17.780

您可以 `is(':checked')`用来检查是否选择了某些内容

```
 $(this).find(".background_flag_container input:checkbox[name='block_background']").each(function(){
       if ($(this).is(':checked')) {
          console.log('is checked');
       }
    }); 
```

虽然看到复选框具有`block_background`应该是唯一的 id。你可以这样做：

```
if ($('#block_background').is(':checked')) {
    console.log('is checked');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:16:05.800

```
$("input#block_background]").is(':checked') 
```

# c# - 执行 SqlBulkCopy 时出现内存泄漏

> ID：14341919
> 
> 赞同：3
> 
> 时间：2013-01-15T16:12:27.880
> 
> 标签：c#, sql, sqlbulkcopy

我遇到了以下代码中发生的严重内存泄漏：

```
 public void BulkInsert(string tableName, IDataReader reader, String connectionString)
    {
        using (var connection = new SqlConnection(connectionString))
        {
            connection.Open();
            using (var bulkCopy = new SqlBulkCopy(connection))
            {
                bulkCopy.DestinationTableName = tableName;
                bulkCopy.BulkCopyTimeout = 900;

                try
                {
                    bulkCopy.WriteToServer(reader);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                }
                finally
                {
                    reader.Close();
                }
            }
        }
    } 
```

此代码段执行数千次，因此只需一分钟即可发生内存不足异常。Ants 报告这是因为 IDataReader 指向的行没有被 GC 收集。但是，当我注释掉以下行时，没有泄漏，这就是我将问题隔离到这段代码的方式。

```
bulkCopy.WriteToServer(reader); 
```

有没有人建议如何防止内存泄漏？

先感谢您。

调用代码：

```
 var reader = datatable.CreateDataReader();
 BulkInsert(tablename, reader, connectionString);
 reader.Dispose();
 datatable.Dispose(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T17:46:21.200

我绝对讨厌回答我自己的问题，但我终于找到了解决方案，虽然我为犯这个错误而感到愚蠢，但我只是想把它作为答案发布，以防其他人遇到这个问题，所以没有其他人在这上面浪费宝贵的时间。

内存泄漏根本不是提供的代码段 - 事实上它根本不是泄漏......

查看性能分析，我发现 BulkCopy 调用是我整个程序的瓶颈。我有一个生产者-消费者模式为其提供数据表以供其插入。

我以为 Memory Profiler 向我展示了在我运行代码时没有被处理的 DataTable 对象。这些实际上是等待插入的排队表，但是因为我正在重新使用测试数据，所以排队表已经在数据库中（因此似乎已经插入）。

通过注释掉 BulkCopy 行，我实际上消除了瓶颈，数据表被快速处理，因此内存分析器上没有显示任何问题。这使得 Bulkcopy 行看起来有问题。

当我用 1 秒的延迟替换 BulkCopy 代码时，这还不足以成为瓶颈。只有当我用 5 秒的延迟替换 BulkCopy 时，我才注意到我的 Consumer Producer Queue Size 失控......因此我的内存很快就耗尽了。

感谢所有花时间在这个问题上的人。很抱歉，它没有更有趣的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:22:52.580

您可能需要处置阅读器，以便 GC 收集它。在您的 finally 块中尝试调用 Dispose。

```
finally
{
    //reader.Close();
    reader.Dispose();
} 
```

# twitter-bootstrap - Twitter Bootstrap 2.2.2 行水平对齐和宽度混合 940px 和 960px

> ID：14341920
> 
> 赞同：0
> 
> 时间：2013-01-15T16:12:35.457
> 
> 标签：twitter-bootstrap

我使用 Twitter Bootstrap 完成了一个非常基本的布局：

```
<body>
<div class="container">

    <!-- Navbar -->
    <div class="navbar">
        <div class="navbar-inner">
            ...
        </div>
    </div>

    <!-- Carousel -->
    <div class="row">
        <div class="span12">
            <div id="myCarousel" class="carousel slide" >
                ...
            </div>
        </div>
    </div>

    <!-- the content -->
    <section id="first_sect">
        <div class="row  alpha07">
            <div class="span12">
                <h1>header</h1>
                <p>Lorem ipsum dolor sit amet...</p>
            </div>
        </div>
    </section>

    <!-- whitespace row -->
    <div class="row  alpha07">
        <div class="span12">
            &nbsp; 
        </div>
    </div>

    <!-- adress footer -->
    <section id="adress section">
        <div class="row  alpha07">...
        </div>
    </section>
    <!-- End of Bootstrap Container -->
</div>
</body> 
```

我有一个行水平对齐和宽度问题，图片更好地说明了这一点： ![在此处输入图像描述](../Images/8f9d96157a7000ada5e88461a165a59f.png)

*   红色背景太左了
*   右侧没有填充

Bootstrap 是开箱即用的，没有进行任何更改。页面代码： http: [//jsfiddle.net/thomson256/DMnhL/10/](http://jsfiddle.net/thomson256/DMnhL/10/) Twitter bootstrap 2.2.2版

**问题是：**这是某种错误还是我只是缺少一些包装 html 元素或对 .less 变量的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:08:15.113

据我所知，这是按预期工作的。为内容区域添加一个内部包装 div 并将您的 css 应用到该内容区域。

```
.inner {
  padding: 2em;
  background: rgba(150, 50, 50, 0.7);
} 
```

这是一个叉子：http: [//jsfiddle.net/gyf6c/1/](http://jsfiddle.net/gyf6c/1/)。

# jquery - 尝试学习 JQuery，遇到 2 个问题

> ID：14341921
> 
> 赞同：1
> 
> 时间：2013-01-15T16:12:36.117
> 
> 标签：jquery

正如我所说，我正在尝试学习 jQuery，但似乎无法解决我遇到的 2 个问题。该页面在这里：[http ://www.illism.com/Manny/03](http://www.illism.com/Manny/03)

1.  当有人单击“休息室”或“餐厅”链接时，我希望页面滚动而不仅仅是“跳转”到该部分。我试了试了试了，没用。。。

2.  当用户单击“mainnav”hrefs 时，我想出了如何在页面的餐厅一侧显示隐藏的“部分”或“页面”（实际上只是 div）：

    ```
    $(function(){
    function contentSwitcher(settings){
        var settings = {
           contentClass: '.content',
           navigationId: '#mainnav'
        };
        $(settings.contentClass).hide();

        $(settings.navigationId).find('a').click(function(e){
            var contentToShow = $(this).attr('href');
            contentToShow = $(contentToShow).fadeTo('slow',1.0);

            e.preventDefault();

            $(settings.contentClass).hide();
            contentToShow.show();
        });
    }
    contentSwitcher();
    }); 
    ```

我遇到的问题是技术上有 2 组“#mainnav”和 2 组“.content”，一组在“#restaurant”div 中，一组在“#lounge”div 中。如何编辑脚本以同时使用两者？

# javascript - 如何检查 JavaScript 中的特定异常？

> ID：14341923
> 
> 赞同：2
> 
> 时间：2013-01-15T16:12:43.517
> 
> 标签：javascript, node.js, exception, exception-handling, error-handling

我正在编写一个 Node.js 应用程序，并且在它的一个代码块内可能会引发各种异常（通过我调用的第 3 方代码）。现在我想对这些异常做出反应，因此我这样做：

```
try {
  // Call 3rd party code
} catch (e) {
  // Handle e
} 
```

基本上，这很好用，但是......我在不同的异常之间有什么区别？

不幸的是，它们都具有`Error`构造函数，因此这不是可行的方法。我可能会使用该`message`属性，但这当然不是最好的方式（因为我依赖于消息永远不会改变的事实，即 - 恕我直言 - 比构造函数更改的可能性更大）。

有任何想法吗？

PS：具体来说 - 我需要在尝试执行`tls.connect`. 如何检测到这是 SSL 错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:19:57.927

大多数包含在 javascript 错误对象中的系统级错误都有一个`code`属性，`errno`您可以进行比较。该列表[在 node.js 源代码中的 uv.h 中](https://github.com/joyent/node/blob/master/deps/uv/include/uv.h#L73)定义。这可能是您的第二选择，偏好是

1.  instanceof 尽可能
2.  `code`或者`errno`
3.  `message`

但事实是有时你只需要看看`message`。鉴于 javascript 的动态和松散类型以及异常通常在 node.js 中不会发挥重要作用的事实，在某些情况下检查消息是您能做的最好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T20:31:00.630

我不建议在 Node 中使用 try/catch 结构，因为由于 Node 的异步特性，我认为它不会起作用（除非您使用的是基本的同步代码）。

假设您正在使用异步函数/包，您可能会更幸运地检查回调函数中的错误状态。

# java - JPA 映射 - 每个孩子的父母的独特组合

> ID：14341930
> 
> 赞同：1
> 
> 时间：2013-01-15T16:13:04.177
> 
> 标签：java, hibernate, jpa

我正在使用：
Spring 3.2
Hibernate 4.1.9

我需要用 JPA 映射三个类。A类与B类是ManyToMany关系。A类和B类的唯一组合需要拥有C类的集合。

**表 A**

```
foo
id | name 
```

**表 B**

```
bar
id | name 
```

**表 C**

```
data
id | xrefId 
```

**连接表**-- *(fooId,barId) 上的唯一键*

```
xref
id | fooId | barId 
```

改变现有的数据结构不是一种选择。

编辑1：

目标：加载一个 Foo，获取它的 Bars 集合。从每个 Bar 中，获取其（他们的！）数据集合。

**A级**

```
@Entity
public class Foo {
  @Id
  private UUID id;

  @ManyToMany(optional = false)
  @JoinTable(name               = "xref",
             joinColumns        = { @JoinColumn(name = "fooId") },
             inverseJoinColumns = { @JoinColumn(name = "barId") })
  private List<Bar> lstBar = new ArrayList<Bar>();
} 
```

**B类**

```
public class Bar {
  @Id
  private UUID id;

  @ManyToMany(mappedBy = "lstBar")
  private List<Foo> lstFoo = new ArrayList<Foo>();
} 
```

**C类**

```
public class Data {
  @Id
  private UUID id;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:34:33.153

吻就对了。创建另一个类外部参照，其中包含`id`、`foo`和字段。使用两个参数和（用简单的 HQL 实现）创建一个 DAO 方法来查找外部参照。唯一要求可以通过数据库中的唯一约束来实现。`bar``Set<Data>``foo``bar`

仅仅通过类层次来表达它看起来并不好，最好使用DAO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:34:35.837

您的连接表 ,`xref`有一个额外的`id`字段，为了能够使用 JPA 创建这样的表，您需要一个额外的实体类，然后您必须映射and 和之间的关系 and （`XRef`两者`A`都是一对多） . 然后，您可以创建实体类并映射和之间的关系。您需要更多帮助吗？我现在没有时间提供代码，但是如果您需要询问，我会尽快添加。`XRef``B``XRef``C``C``XRef`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:37:04.083

看这个例子（为简单起见，使用 Integer 而不是 UUID，其余的应该没问题）。

**酒吧类：**

```
public class Bar {
    @Id
    private Integer id;
    @Column(name = "name")
    private String name;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "barId")
    private Collection<Xref> xrefCollection;
} 
```

**富类：**

```
public class Foo {
    @Id
    private Integer id;
    @Column(name = "name")
    private String name;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "fooId")
    private Collection<Xref> xrefCollection;
} 
```

**外部参照类：**

```
public class Xref {
    @Id
    private Integer id;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "xrefId")
    private Collection<Data> dataCollection;
    @JoinColumn(name = "bar_id", referencedColumnName = "id")
    @ManyToOne(optional = false)
    private Bar barId;
    @JoinColumn(name = "foo_id", referencedColumnName = "id")
    @ManyToOne(optional = false)
    private Foo fooId;
} 
```

**数据类：**

```
public class Data {
    @Id
    private Integer id;
    @JoinColumn(name = "xref_id", referencedColumnName = "id")
    @ManyToOne(optional = false)
    private Xref xrefId;
} 
```

此代码已由[NetBeans 自动生成](http://netbeans.org/kb/docs/javaee/ecommerce/entity-session.html)，前提是在 DB 中正确定义了所有表和索引

# iphone - 获取国家域名代码

> ID：14341936
> 
> 赞同：0
> 
> 时间：2013-01-15T16:13:17.317
> 
> 标签：iphone, ios, objective-c

我有一个应用程序，我正在制作一个基本的内置网络浏览器，用于预填充书签。

但我想获取设备的国家域代码，例如 .com、.uk、.de 等。这可能吗？

我知道如何使用国家代码，`NSLocale`但它给出的是 GB 而不是 uk。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:22:41.370

使用`if`.

国家代码在 ISO-3166 中定义，并与国家代码顶级域相匹配。唯一的例外是英国，其 ISO-3166 为 GB，但它继续使用在编写 ISO-3166 之前定义的 .uk 域。

# gis - 以米为单位的 2D 开放街道地图数据表示

> ID：14341941
> 
> 赞同：0
> 
> 时间：2013-01-15T16:13:27.263
> 
> 标签：gis, postgis, minecraft, openstreetmap

我正在将 OSM 数据转换为开源 Minecraft 端口（用 javascript - [voxel.js 编写](http://voxeljs.com)）。javascript 版本的编写方式是，每个体素（任意定义为立方米）都创建为来自单个原点 (x,y,z)(0,0,0) 的关系。

举个例子，如果想要创建一个立方体块，可以简单地生成体素作为与原点 (0,0,0) 的关系：[(0,0,0),(1,0,0) , (0,1,0)...]。

我的问题是：我导出了 OSM 数据，标准 XML 输出 (.osm) 以纬度和经度绘制节点。[我最初的想法是，我可以通过使用Haversine公式](http://en.wikipedia.org/wiki/Haversine_formula)计算每个节点与任意原点（0,0,0）=（37.77559，-122.41392）的距离来创建地图，将距离转换为米，找到轴承，并将其绘制为与 (0,0,0) 的关系。

但是，我注意到还有许多其他可用的导出格式：（.osm.pbf、.osm2pgsql、.imposm）。我假设他们以类似的方式（lat、lng）绘制节点，但其中一些能够直接导入数据库（例如 PostgreSQL）。

我听说有人使用像 PostGIS 这样的 PG 插件，但是（因为这是我第一次深入 GIS）我不熟悉他们的功能以及PostGIS 之*类*的东西是否会帮助我将 OSM 数据绘制到二维体素网格中。

PostGIS 等附加组件中是否有功能可以让我动态计算两个 Lat/Lng 点之间的距离，并以 x,y 方式绘制它们？

我想，从根本上说，我的问题是：如果我创建一个将 OSM 数据绘制到 x,y 网格中的脚本，我会重新发明轮子，还是有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T13:20:50.853

默认情况下，OSM 数据位于 WGS84 (EPSG:4326) 投影中，该投影基于椭圆体地球，以度为单位测量纬度和经度。

大多数地图图块是在 EPSG:900913 “Google”球形墨卡托投影中生成的。该投影基于球形地球，纬度和经度从原点开始以米为单位测量。

看起来 900913 投影确实非常适合您的要求。

[这](https://gist.github.com/springmeyer/871897)是用于在两者之间进行转换的一些代码。

您可能想考虑使用[osm2psql](http://wiki.openstreetmap.org/wiki/Osm2pgsql)。在导入过程中，所有 OSM 地图数据都转换为 900913 投影。您剩下的是一个易于访问的 Postgres 数据库中的 OSM 地图数据的所有节点、线和多边形的数据库。

我最初对这个过程感到害怕，但它确实非常简单，并且在使用 OSM 数据时会给你很大的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T14:57:51.583

您需要从球坐标（LatLon，使用 WGS84）转换为笛卡尔坐标，如谷歌球墨卡托。

在伪代码中

```
 transform(double lat, double lon) {

double wgs84radius = 6378137;
double shift = PI * wgs84radius;
double x = lon * shift / 180;
double y = log(tan((90+lat)*PI/360)/ (PI/180);
return {x,y}
} 
```

这是最简单的方法。请记住，Lat/Lon 是角度，而 x 和 y 是距 (0/0) 的距离

# python - Python **kwargs 和 self 作为参数

> ID：14341943
> 
> 赞同：3
> 
> 时间：2013-01-15T16:13:31.203
> 
> 标签：python, python-2.7, arguments, keyword-argument

我在 python 方面没有太多经验，但我正在学习`**kwargs`。

在阅读了很多之后，我理解了一些东西，`**kwargs`但是我有一个小问题**，或者**我不理解正确的东西。

所以这**有效**：

```
def test_var_kwargs(farg, **kwargs):
    print "formal arg:", farg
    for key in kwargs:
        print "another keyword arg: %s: %s" % (key, kwargs[key])

test_var_kwargs(farg=1, myarg2="two", myarg3=3) 
```

并打印：

> 正式参数：1
> 
> 另一个关键字 arg：myarg2：两个
> 
> 另一个关键字 arg: myarg3: 3

但如果该函数是**实例函数**，则`self`必须包含：

```
def test_var_kwargs(self, farg, **kwargs):
        print "formal arg:", farg
        for key in kwargs:
            print "another keyword arg: %s: %s" % (key, kwargs[key])

self.test_var_kwargs(farg=1, myarg2="two", myarg3=3) 
```

但这会产生一个**错误**：

```
TypeError: test_var_kwargs() takes exactly 2 arguments (1 given) 
```

我知道我必须通过 self 像：

```
self.test_var_kwargs(self, farg=1, myarg2="two", myarg3=3) 
```

为什么我必须在类实例的方法中包含 self 作为参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:15:49.463

在这种情况下，您不能`farg`用作关键字参数；它不能同时解释为位置参数*和*关键字参数，在这种情况下，Python 将其解释为关键字参数。

采用

```
self.test_var_kwargs(self, 1, myarg2="two", myarg3=3) 
```

反而。

函数充当描述符；当在一个实例上查找时，它们会被包装在一个称为方法的新对象中，该方法会在调用时自动将该实例作为第一个参数添加到函数中。这个包装器本质上是这样做的：

```
class Method(object):
    def __init__(self, function, instance, cls):
        self.func = function
        self.instance = instance
        self.cls = cls

    def __call__(self, *args, **kw):
        return self.func(self.instance, *args, **kw) 
```

然后将您的`farg`关键字参数集中在`**kw`包罗万象下并传递给底层函数，`*args`留空。

但是`test_var_kwargs`您定义的方法有一个位置参数（在 旁边`self`，因此会引发异常。

# ios - 使用渲染缓冲区和帧缓冲区时是否应该清理 OpenGL 状态？

> ID：14341946
> 
> 赞同：1
> 
> 时间：2013-01-15T16:13:37.173
> 
> 标签：ios, objective-c, opengl-es

我正在围绕 OpenGL ES 编写一个简单的 OOP 包装器。在编写渲染和帧缓冲区时，我必须绑定缓冲区才能使用它：

```
- (void) setupSomething
{
    …
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, myBufferID);
    …
} 
```

现在，如果在已经绑定了其他渲染缓冲区的上下文中调用此设置代码怎么办？上面提到的我的简单版本会产生切换当前缓冲区的令人讨厌的副作用，这听起来很脆弱。我想我应该更加防御性地编写代码：

```
- (void) setupSomething
{
    // Store current state
    GLint previousRenderBuffer = 0;
    glGetIntegerv(GL_RENDERBUFFER_BINDING_OES, &previousRenderBuffer);
    // Do whatever I want to do
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, myBufferID);
    …
    // Restore previous state
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, previousRenderBuffer);
} 
```

我的问题是：真的有必要/明智/习惯像这样保存以前的状态吗？如果是的话，有`glPushSomething`什么方法可以为我做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:13:08.147

使用 OpenGL 之类的图形 api 通常最好尽量减少 api 调用的数量。有些调用可能非常昂贵——不过我不确定 glBindRenderBuffer ——它可能和存储一个一样便宜`int`。但这可能是一些复杂的状态切换操作。你最好自己处理它 - 使用你自己的缓冲区“堆栈”（`glPushAttrib`OpenGL ES中的渲染缓冲区没有或类似的东西），或者，在我看来，最好避免这些情况 - 始终确保你完成你的工作在传递到另一个缓冲区之前渲染您已绑定的缓冲区。

# java - Java中的斐波那契算法

> ID：14341947
> 
> 赞同：3
> 
> 时间：2013-01-15T16:13:38.390
> 
> 标签：java, fibonacci

我正在尝试解决算法类的作业问题，并且我一直在为我在下面编写的代码获取越界索引数组。我一直在尝试在 Python 中使用它，因为我对此很满意，但我似乎遇到了类似的例外。谁能给我一个提示我在哪里出错了？

```
public class Fibonacci1 {
    public static long F(int N) {
        long a[]  = new long [100];
        a[0] = 0; /*sets up first 2 digits in the sequence*/
        a[1] = 1;
        if (N<2) {   
            return N;
        }
        a[N] = a[N-1] + a[N-2]; /*appends F num for next number in the list*/
        N++; 
        return a[N]; /*should return the last number*/
    }
    public static void main(String[] args) {
        for (int N = 0; N<100; N++)
            StdOut.println(N+" " + F(N));
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T16:15:15.653

什么时候`N == 99`，你`N++`在方法F中做了一个，然后你调用return `a[N]`，这意味着return`a[100]`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T16:27:28.053

代码需要稍作改动。您没有打印出正确的序列，因为数组是局部变量，应该是静态变量。n++ 也应该被删除。下面的代码并不漂亮，但它可以工作。

```
public class Fibonacci1 {
    static long a[] = new long[100];

    public static long F(int N) {
        a[0] = 0; /* sets up first 2 digits in the sequence */
        a[1] = 1;
        if (N < 2) {
            return N;
        }
        a[N] = a[N - 1] + a[N - 2]; /* appends F num for next number in the list */
        return a[N]; /* should return the last number */
    }

    public static void main(String[] args) {
        for (int N = 0; N < 100; N++)
            System.out.println(N + " " + F(N));
        }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:16:01.430

从 F-Function 中删除 N++ 语句。

# jquery - Ajax 引入一个 div 并将其变成一个滑块

> ID：14341948
> 
> 赞同：0
> 
> 时间：2013-01-15T16:13:39.530
> 
> 标签：jquery, ajax

我使用 Ajax 加载了一个div `id`。`slider`

我想使用jquery语句`$('#slider').orbit();`

由于这是通过 Ajax 加载的，因此我不确定如何执行此操作。过去，`on`当我必须添加点击事件时，我会使用该功能。但是，由于这只需要在没有任何`click`等的情况下运行`hover`。我不知道该怎么做？

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:15:25.427

使用 ajax 回调函数来运行该代码。

您可以在 JQuery api 的相关函数中找到语法。

[http://api.jquery.com](http://api.jquery.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:15:54.303

在执行 jQuery AJAX 调用时，您可以（通常应该）指定一个`success`函数，该函数在收到来自服务器的成功响应时运行。只需在其中执行您的代码：

```
$.ajax({
    url: url,
    success: function(response) {
        // some code
        $('#slider').orbit();
    }
}); 
```

如果您正在使用其中一种速记 jQuery 函数 - 例如`$.get()`or `$.post()`- 那么成功函数将作为其参数之一传递：

```
$.post(url, function(response) {
    // some code
    $('#slider').orbit();
}); 
```

相关文档：

*   [`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)
*   [`jQuery.post()`](http://api.jquery.com/jQuery.post/)

# linux - 用于多线程文件处理的 Shell 脚本

> ID：14341954
> 
> 赞同：0
> 
> 时间：2013-01-15T16:14:04.473
> 
> 标签：linux, multithreading, bash, shell, unix

我有一个包含 10-20 条记录的文件。我需要对这些记录调用一个进程。有人可以帮我写一些多线程的shell脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:23:52.677

在一般执行中，您可以使用`xargs`：

```
cat file | xargs -n 1 -I {} bash -c 'your_script.sh {}' 
```

将`{}`作为参数提供给`your_script.sh`，并`-n 1`确定要作为参数传递给脚本的行数。

例如：

```
$ cat > file
a
b 
c

$ cat > t.sh
echo [ $1 ];

$ cat file | xargs -n 1 -I {} bash -c './t.sh {}'
[ a ]
[ b ]
[ c ] 
```

# android - 将自定义布局视图膨胀为 Android 中的 Layout 扩展类

> ID：14341955
> 
> 赞同：1
> 
> 时间：2013-01-15T16:14:05.067
> 
> 标签：android, android-custom-view, layout-inflater

我在 XML 文件中定义了一个自定义布局，它有一个带有一堆子视图的 RelativeLayout 根。

现在，我定义了以下类：

```
public class MyCustomView extends RelativeLayout {

    public MyCustomView(Context context) {
        super(context);
        init();
    }

    public MyCustomView(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();     
    }

    public MyCustomView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);    
        init();
    }

    private void init() {
        LayoutInflater inflater = (LayoutInflater)  getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        inflater.inflate(R.layout.my_custom_view, this, true);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

        Log.d("Widget", "Width spec: " + MeasureSpec.toString(widthMeasureSpec));
        Log.d("Widget", "Height spec: " + MeasureSpec.toString(heightMeasureSpec));

        int widthMode = MeasureSpec.getMode(widthMeasureSpec);
        int widthSize = MeasureSpec.getSize(widthMeasureSpec);

        int heightMode = MeasureSpec.getMode(heightMeasureSpec);
        int heightSize = MeasureSpec.getSize(heightMeasureSpec);

        int chosenWidth = chooseDimension(widthMode, widthSize);
        int chosenHeight = chooseDimension(heightMode, heightSize);

        int chosenDimension = Math.min(chosenWidth, chosenHeight);

        setMeasuredDimension(chosenDimension, chosenDimension);
    }

    private int chooseDimension(int mode, int size) {
        if (mode == MeasureSpec.AT_MOST || mode == MeasureSpec.EXACTLY) {
            return size;
        } else { 
            return getPreferredSize();
        }
    }

    private int getPreferredSize() {
        return 400;
    }
} 
```

如您所见，我将根设置为`MyCustomView`实例，并将附加标志设置为真。

我想要实现的是，当我将此自定义视图添加到另一个布局的 xml 中时，它将实例化`MyCustomView`将在 XML 中定义布局的类。

我已经尝试使用`<merge>`标记，但是这样我就无法根据需要在 XML 中排列我的子视图。

我还尝试膨胀 XML 并将其添加为视图`MyCustomView`，但这样我就变得多余了`RelativeLayout`。

最后一件事，我添加了`onMeasure()`只是为了完整性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:30:15.060

> 发生膨胀但未显示子视图

`RelativeLayout`与您在布局中所做的相比，它做的更多（很多）（`onMeasure`基本上，孩子们根本没有用您的代码衡量，所以他们没有要显示的东西）。如果你扩展一个`ViewGroup`like `RelativeLayout`，你需要让那个类来做它的回调（`onMeasure`，`onLayout`），或者至少，非常小心地复制方法并按照你的意愿修改它（如果你想看到一些东西）。

因此，删除该`onMeasure`方法以查看子项或更好地解释为什么要覆盖它。

# plasticscm - 将可测试代码部署到 QA 的最佳实践

> ID：14341957
> 
> 赞同：1
> 
> 时间：2013-01-15T16:14:07.143
> 
> 标签：plasticscm

我正在尝试实现一种将我编译的程序集部署到 QA 进行测试的方法。我有许多存储库，每个存储库都包含包含项目和源代码的文件夹，以及一个包含从这些项目生成的已编译程序集的文件夹。下图代表我的源存储库工作区。

![源代码库](../Images/1d8a8ace006a1bac671be47ab39a73df.png)

我还有一个 Development 用户组和一个 QA 用户组。Development 用户组对源存储库具有完全权限。

我尝试了几种不同的方法来实现我的目标，但几乎没有成功：

我尝试创建一个名为 Assemblies 的新存储库，并将 Xlinks 添加到我的源存储库，然后拒绝 QA 用户组对源存储库中所有文件夹和文件的所有权限，但 Assemblies 文件夹除外。但是，当作为 QA 用户组的成员登录到 Plastic 时，我仍然可以下载所有源文件。

我还尝试以 QA 用户组的成员身份直接访问源存储库，但我仍然可以访问不应该可用的文件。

我正在考虑签到触发器。每当将 .exe 和 .dll 签入源存储库的主分支时，触发器就会将它们添加/签入到程序集存储库中。但是，我不确定我是否朝着正确的方向前进。如果已经有我应该采用的首选方法或最佳实践，我不想“重新发明轮子”。

任何建议或参考将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:08:05.780

这是我的建议，

创建一个**新的存储库**，以便将所有二进制文件放在输出工件中。在您的中央存储库中，即链接到外部“*第三方*”存储库的存储库中，创建一个**指向新的全新“二进制”存储库的新**链接。

现在您需要更改构建系统以**将所有二进制文件**和工件复制到此 xlinked 存储库。(cm ci -a) 命令将**提交**所有更改的二进制文件，最后使用“cm **label** ”命令标记变更集，该标签将帮助 QA 团队测试某些版本。

**删除**中央存储库和“第三方”存储库中 QA Plastic SCM 组的查看权限。现在 QA 小组永远不会知道甚至有源代码存储库。QA 组将拥有一个**使用“二进制”存储库的工作区，**并且您的源代码/存储库将被**安全地隐藏**并且该 QA 组无法访问。

您甚至可以在**外部服务器/机器**中拥有“二进制”存储库。因此源代码位于 devMachine:8087 中，而二进制文件位于不同的 Plastic SCM 服务器中，例如“qaMachine:8087”。使用这种方法，QA Plastic 用户将使用专用服务器。

# visual-studio-2012 - VS2012 pubxml 和 TransformWebConfigEnabled

> ID：14341959
> 
> 赞同：3
> 
> 时间：2013-01-15T16:14:11.823
> 
> 标签：visual-studio-2012, publishing

也许有人可以给我建议。

我正在尝试使用 VS2012 发布项目。我已经设置了一个发布配置文件以将其发布到文件系统驱动器。

我需要几个环境/构建配置，因此正在使用 Web.Config 转换。

目前，我有一个 web.config + 5 个转换（每个构建配置一个）。发布解决方案后，它会成功部署到指定的文件系统。但是，它也将 Web.Config 转换为 web.config。

我已修改 .pubxml 以包含该`<TransformWebConfigEnabled>False</TransformWebConfigEnabled>`元素，但发布过程似乎只是忽略它并转换 web.config 无论如何。通过此链接关注：http: [//msdn.microsoft.com/en-us/library/dd465342 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd465342(v=vs.100).aspx)

任何人都可以建议吗？

[编辑] 我已经尝试将`<TransformWebConfigEnabled>False</TransformWebConfigEnabled>`元素放入 pubxml 和 proj 文件中，并且两种方式都被完全忽略，并且 web.config 无论如何都会被转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T17:57:27.490

您将其粘贴在错误的文件中。你想修改

> `YourProject.csproj`

而不是`PublishProfile.pubxml`.

# testing - 定义非自动化软件测试并跟踪测试结果？

> ID：14341960
> 
> 赞同：1
> 
> 时间：2013-01-15T16:14:12.540
> 
> 标签：testing, qa, gui-testing, ui-testing

我们想要一个系统来定义测试，非自动化 UI 测试，我们的 Q/A 人员将使用它来测试我们的软件。我们需要概述需要测试的区域，然后允许它们转到列表的末尾并在此处标记**通过/失败**以及任何注释，例如注释失败、错误消息等。

对有效执行此操作的产品有什么建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:52:07.383

有许多好的系统可以帮助您管理手动测试并允许您的测试人员报告他们的步骤（通过/失败/等）。您可以使用 excel 甚至 word，但是您将无法管理该过程，并且您不会在测试人员简单地“记住他们测试的内容”的过程中获得太多收益。

我在一家开发其中一个测试管理系统[PractiTest](http://www.practitest.com)的公司工作。

我们的产品与众不同的是，我们帮助团队管理他们的流程并更智能地使用他们的测试（重用它们、自动报告问题和生成图表等），但没有更多“企业解决方案”的极端开销。

我们还与 Jira、Redmine、Bugzilla 和其他错误跟踪系统集成，以便您能够在失败的测试和错误之间建立联系，并更清楚地了解产品的状态。

PractiTest 也是 SaaS，因此用户无需安装或配置任何东西，我们会为他们处理所有这些问题。

正如我所说，还有像 PractiTest 这样的其他产品可以为您提供比 excel、工作或非正式 wiki 更好的解决方案。你也可以用谷歌搜索他们。

希望这可以帮助！

-乔尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T20:36:33.773

可能比您要寻找的更多，但是 Microsoft 测试管理器可以完成您所说的一切，而且还有更多。就报告而言，它还可以很好地集成到 TFS 中。

Excel 也非常好用。

# mysql - 由于访问 mysql 服务器而无法启动 rails 服务器 - 'root'@'localhost' 的访问被拒绝

> ID：14341967
> 
> 赞同：0
> 
> 时间：2013-01-15T16:14:59.010
> 
> 标签：mysql, ruby-on-rails

我已经 git 克隆了一个存储库，以便开始为私人项目做出贡献。

现在，当我启动 mysql 服务器和 rails 服务器时，我收到以下错误：

`Access denied for user 'root'@'localhost' (using password: YES) (Mysql2::Error)`

现在我尝试使用在 config/database.yml 文件中找到的密码登录，但没有成功。我应该怎么做才能让应用程序在我的本地环境中正常运行？

感谢您的帮助。

database.yml 文件：

```
 development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: sc_development
  pool: 5
  username: root
  password: Mysql2047
  socket: /tmp/mysql.sock

 # Warning: The database defined as "test" will be erased and
 # re-generated from your development database when you run "rake".
 # Do not set this db to the same as development or production.

  test:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: sc_test
  pool: 5
  username: root
  password: Mysql2047
  socket: /tmp/mysql.sock 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:38:52.323

您需要在本地计算机上启动 mysql 服务器，创建数据库`sc_development`并清除数据库设置文件中的密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:39:27.633

我会创建一个新的 MySQL 用户，用户名不是`root`. 为每个不同的应用程序设置不同的数据库用户是一种很好的做法。

当然，您还需要将`sc_development`数据库权限授予应用程序的用户。

```
CREATE DATABASE sc_development;
CREATE USER sc IDENTIFIED BY 'somepassword';
GRANT ALL PRIVILEGES ON sc_development.* TO sc; 
```

像这样的东西可能会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T07:30:49.463

这对我有用：

首先，而不是登录到mysql

`mysql`

像这样登录：

`mysql -uroot`

root@localhost 拥有所有权限并且没有密码。

接下来，我创建了数据库和另一个我授予所有权限的用户。

`mysql> CREATE USER joe identified by 'foobar'`

`mysql> Grant All PRIVILEGES ON smartcheckups_development.* TO joe;`

创建数据库： `mysql> CREATE DATABASE sc_development;`

在我的 database.yml 文件中，我使用上述用户 joe 的登录名和密码进行了更新。这将允许我登录。

通过离开mysql`\q`

然后

`bundle exec rake db:create`

和启动轨道`rails s`

# .net - VB.NET 如何从 SQL 查询中获取文本结果

> ID：14341970
> 
> 赞同：3
> 
> 时间：2013-01-15T16:15:03.523
> 
> 标签：.net, sql, vb.net, sql-server-2000

有了这张表：

```
CREATE TABLE #TEMP(
ID INT,
NAME VARCHAR(30)
)
INSERT INTO #TEMP VALUES(1,'a')
INSERT INTO #TEMP VALUES(2,'b')
INSERT INTO #TEMP VALUES(3,'c')
INSERT INTO #TEMP VALUES(4,'d')
INSERT INTO #TEMP VALUES(5,'e') 
```

而这个查询：

```
print '-----------------------'
select * from #TEMP
print '******************************************' 
```

我需要得到如下文本的结果：

```
-----------------------
ID          NAME
----------- ------------------------------
1           a
2           b
3           c
4           d
5           e

****************************************** 
```

当我选择“文本结果”或“文件结果”时，我可以使用 SQL Server Management Studio 获取它。我怎样才能通过 VB.Net 得到这个结果？

las 查询只是一个示例。这是我真正的需要：

![在此处输入图像描述](../Images/73d1ed412c3dfddbbd3b8da1d38c4929.png) ……

我在 MS Server 2000 上。感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:25:35.487

您可以使用`ADO.NET`和[`StreamWriter`](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)：

```
Using stream = New StreamWriter(path)
    stream.WriteLine("----------------")
    stream.WriteLine("ID          NAME")
    stream.WriteLine("----------------")
    Using con = New SqlConnection(YourConnectionString)
        Using cmd = New SqlCommand("select * from #TEMP", con)
            Using reader = cmd.ExecuteReader()
                While reader.Read()
                    stream.WriteLine(String.Format("{0} {1}", reader.GetString(0), reader.GetString(1)))
                End While
            End Using
        End Using
    End Using
    stream.WriteLine("******************************************")
End Using 
```

[**如何：将文本写入文件**](http://msdn.microsoft.com/en-us/library/6ka1wd3w.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

请注意，这些`Using`语句确保即使在发生异常时也会处理对象。

# c++ - 如何检查 QPushButton 是否被点击

> ID：14341971
> 
> 赞同：1
> 
> 时间：2013-01-15T16:15:06.627
> 
> 标签：c++, qt, qpushbutton

我想用一个`if-else`语句来检查是否`QPushButton`被点击。
我怎样才能做到这一点？。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T16:25:08.843

这个问题没有意义。被点击不是可以检查的*状态；*单击按钮是一个*事件*。区分状态和事件很重要。

您通过将插槽连接到信号来处理按钮单击事件`QAbstractButton::clicked()`。

也许您的意思是“我如何检查按钮是否关闭？”。情绪低落是一种状态；您使用该方法检查该状态`QAbstractButton::isDown()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:51:58.567

QPushButton 的父类 QAbstractButton 有一个检查属性（setChecked/isChecked），如果您试图确定按钮是否被按下且 checkable 属性设置为 true。

# tsql - 如何使用 Resharper 测试运行器对 T-SQL 代码进行单元测试？

> ID：14341975
> 
> 赞同：2
> 
> 时间：2013-01-15T16:15:16.607
> 
> 标签：tsql, unit-testing, resharper

基本上，标题说明了一切：我正在使用 Resharper 测试运行程序（我的测试是使用 NUnit 编写的），现在我需要测试一些 T-SQL 代码。

我怎么做？

任何帮助（教程和公司的链接）将不胜感激。

我不知道的是：

*   我把测试放在哪里？C＃？T-SQL 也是如此？...？
*   如何设置测试运行器来运行这些测试？
*   Resharper甚至可以做到这一点吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-10T19:39:37.933

我已经为 T-SQL 编写了一些单元测试，用于测试 Sql 代码中的语法错误。在 NUnit 或 Microsoft 的单元测试框架中从 C# 执行测试并使用前面的语句运行：

```
SET FMTONLY ON; 
```

[微软对此声明的引用。](http://msdn.microsoft.com/en-us/library/ms173839.aspx)

在你只取回元数据之后，之后什么都没有真正执行，所以你甚至可以测试通常会修改数据的查询。

例如，请参阅下面的此 NUnit 测试，如果该过程存在并且它自身或任何存储过程依赖项中没有语法错误，则该测试将成功。

```
[Test]
public void GivenStoredProcedure_WhenParsedBySqlServer_ThenItsResultShouldBeZero()
{
    const string sqlText = "SET FMTONLY ON; EXEC dbo.MyStoreProc;";

    var sqlConnection = new SqlConnection(connectionString);
    var sqlCommand = new SqlCommand(sqlText, sqlConnection);
    sqlCommand.CommandType = CommandType.Text;

    try
    {
        sqlConnection.Open();
        var result = sqlCommand.ExecuteNonQuery();              
        Assert.That(result, Is.EqualTo(0));
    }
    finally
    {
        if (sqlConnection.State == ConnectionState.Open)
        {
            sqlConnection.Close();
        }
        sqlConnection.Dispose();
    }      
} 
```

# javascript - Wijmo 调试选项

> ID：14341977
> 
> 赞同：0
> 
> 时间：2013-01-15T16:15:17.157
> 
> 标签：javascript, componentone

使用 ComponentOne 控件（例如：LineChart、Slider）时，您可以传入许多选项。使用 FireBug 或 Chrome 开发者工具，我如何访问控件的选项？如果我更改了一个值，我需要做什么才能使更改反映在 UI 上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:07:24.937

您可以在调试期间使用以下 jQuery 中的选择器访问选项：

$("#wijlinechart").data("wijlinechart").options

# php - 将'保存到数据库时，我在文本框中得到\'

> ID：14341981
> 
> 赞同：1
> 
> 时间：2013-01-15T16:15:26.147
> 
> 标签：php, html, mysql, pdo

在很多人告诉我这样做之后，我正在学习 PDO。然而，在更新我的一个脚本时，PDO 给我带来了一个我不知道如何解决的问题。

我的问题是用户将标题输入到网站。说它的“史密斯的库存”。

由于整个 PDO 切换，它在 db 中保存为“Smith\'s Inventory”。这是我网站上各个地方的输出。如标题、html 标题和设置文本框。如果您使用 \' 再次单击保存，则会得到 \\'，依此类推。

我知道为什么会这样做，但是如何解决呢？

这是插入代码：

```
foreach ($_POST as $key => $value)
{
    $sql = $dbh->prepare("UPDATE settings set value=? where variable=?");
    $sql->bindParam(1, $value);
    $sql->bindParam(2, $key);
    $sql->execute();
}
echo '<h2><font  color=green>Saved</font></h2>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:18:45.440

看起来您正在双重转义数据。

最可能的原因是：

*   您的 PHP 安装启用了魔术引号 -[最好将其关闭](https://stackoverflow.com/questions/517008/how-to-turn-off-magic-quotes-on-shared-hosting)
*   您正在使用 mysql_real_escape_string 之类的东西**和**带有占位符的预处理语句 - 仅使用后者

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:23:18.607

我以前遇到过这个问题，这是由于 PHP 魔术引号引起的。PHP 会自动插入斜杠来转义“有风险”的字符，以防止 sql 注入。

您需要在 php 安装中禁用魔术引号，或者在输出之前使用 stripstashes 函数。

```
http://php.net/manual/en/security.magicquotes.disabling.php
http://php.net/manual/en/function.stripslashes.php 
```

您可以在此处阅读有关魔术引号的信息：

```
http://www.tizag.com/phpT/php-magic-quotes.php 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:17:13.243

您可以`stripslashes`在 PHP 端使用。

```
<?php
$str = "Is your name O\'reilly?";

// Outputs: Is your name O'reilly?
echo stripslashes($str);
?> 
```

# android - Android线程封装，无法从封装的类中获取变化的变量

> ID：14341982
> 
> 赞同：0
> 
> 时间：2013-01-15T16:15:26.143
> 
> 标签：android, multithreading, encapsulation

我对 Android 和 Java 很陌生。基本上，我想实现一个Android后台线程的封装，在这个后台线程中，我有一个无限循环，它会定期执行一些获取数据的操作（比如从互联网，或者从一些硬件设备）。

封装的类必须只提供类似`getData()`其他人获取数据的功能。但是每次当我`getData()`从其他类调用这个函数时，它永远不会给我变化的值，而只会给我初始化的值。我研究了`AsyncTask`,`Handler`和`Message`实现多线程的方法。他们都给了我初始化的值。

下面是 Handler 和 Message 的封装类：

```
public class getDataFromUSB{

private int usb_data;

private Handler handler = new Handler(){
    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);
        if(msg.what==1){

            usb_data=msg.arg1;

        }
    }
};

private Thread thread = new Thread(){
    @Override
    public void run(){
        while(!Thread.currentThread().isInterrupted())
        {
                            int a=read_usb();
            Message msg = new Message();
            msg.arg1 = a;
            msg.what = 1;
            handler.sendMessage(msg);
            try {
                Thread.sleep(15);
            } catch (InterruptedException e) {
                System.err.println("");
                this.interrupt();
            }
        }
    }
};
public void start(){
    thread.start();

}
public int get_data(){
    return usb_data;
}
public int read_usb()
{ 
    int a=10;
    return a;
}

} 
```

然后在另一个类中，这里是调用代码`getDataFromUSB`：

```
getDataFromUSB usb1= new getDataFromUSB();
usb1.start();
int a=usb1.getData();
Log.e(TAG,"a = " +a); 
```

然后每次我调用这个`usb1.getData()`，值总是0。我不明白为什么。

现在我继续做一些更现实的事情。我在我的 getDataFrom USB 类中添加了一个随机对象以提供不同的数字，我还更改了为 usb_data 分配值的方式，我认为最好只在后台线程中进行，无需将其移动到句柄消息中. 所以它变成：

```
public class getDataFromUSB{

private int usb_data;
    private Random random = new Random(555L);

private Handler handler = new Handler(){
    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);

    }
};

private Thread thread = new Thread(){
    @Override
    public void run(){
        while(!Thread.currentThread().isInterrupted())
        {
            int a=read_usb();
            usb_data=a;
            Message msg = new Message();
            handler.sendMessage(msg);
        }
    }
};
public void start(){
    thread.start();

}
public int get_data(){
    return usb_data;
}
public int read_usb()
{ 
    return random.nextInt();
}

} 
```

然后我像 Nikita 建议的那样从另一个班级调用它：

```
 Handler h = new Handler();   
    for (int i=0;i<20;i++){
    h.postDelayed(new Runnable() {
        public void run() {
            int data=usb1.get_data();
            Log.e(TAG,"data= " +data);  
            }
        },500); 
    } 
```

奇怪的是，它有时会给出所有相同的数字，有时会给出几个数字，有时会给出不同的数字。据我了解，usb_data 一直在后台线程内更改，因此我们没有义务等待 handlemessage 继续进行。每次我调用 getData() 时，它都应该给我最新的值。不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:22:32.430

问题可能如下：您从主 UI 线程运行代码。当您新启动线程时 - 它向处理程序发送消息。此消息被添加到主线程的队列中，当它完成当前工作时将在主线程中处理。当前主线程运行您的代码，并且在您调用之前不可能处理该消息`usb.getData()`。要检查您的更新线程是否正常工作，您可以发布延迟的可运行，它将打印值`usb1.getData()`：

```
final getDataFromUSB usb1= new getDataFromUSB();
usb1.start();
Handler h = new Handler();
h.postDelayed(new Runnable() {
    public void run() {
        int a=usb1.getData();
        Log.e(TAG,"a = " +a);
    }
}, 500); // Waits 500 milliseconds and runs runnable on current thread. 
```

# c - 无法获得整数数组的长度

> ID：14341984
> 
> 赞同：1
> 
> 时间：2013-01-15T16:15:39.573
> 
> 标签：c, pointers

> **可能重复：**
> [函数参数中的数组长度](https://stackoverflow.com/questions/8269048/length-of-array-in-function-argument)

我正在尝试获取整数数组的长度，但我没有得到正确的答案

```
void main()
{
    int x[]={33,55,77};
    printf("%d",getLength(x));//outputs 1
    printf("%d",sizeof(x)/sizeof(int));//outputs 3
}

int getLength(int *inp)
{
    return sizeof(inp)/sizeof(int);
} 
```

那么为什么 getLength 返回值 1 而不是 3 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:16:56.833

因为数组不是指针，指针也不是数组。`sizeof(pointer)`不一样`sizeof(the array which the pointer points to)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:16:57.287

由于数组*衰减*为指针，因此您无法在函数中执行长度计算：函数获取的是指针，而不是数组。您需要按照函数打印时的方式进行内联计算`3`，或者使用宏来计算数组长度：

```
#define GET_LENGTH(inp) (sizeof(inp)/sizeof(*inp)) 
```

[这是 ideone 上的演示链接。](http://ideone.com/nTX4vN)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:16:48.603

这里`sizeof(inp)`返回指针的大小而不是数组的大小和指针的大小= 4

所以

```
sizeof(inp)/sizeof(int)
 ^__ 4        ^__ 4      = 1 
```

# uiviewcontroller - 一个视图一次最多只能关联一个视图控制器。UIViewControllerHierarchyInconsistency

> ID：14341985
> 
> 赞同：3
> 
> 时间：2013-01-15T16:15:39.290
> 
> 标签：uiviewcontroller, ios6

我在 iOs5 上的 iOs6 上遇到了这个问题，效果很好。

这会加载 LoginView

```
- (void)viewDidLoad {
if(!currentView ){
      currentView = [[Login alloc] init];
}
self.view = currentView.view;
   [super viewDidLoad]; 
} 
```

这是在 AppDelegate

```
 if (!mvc) {
    mvc = [[[mainViewController alloc] init] autorelease];
}
[window addSubview:mvc.view];
[window sendSubviewToBack:mvc.view];
[window makeKeyAndVisible]; 
```

2013-01-15 18:02:33.137 fodboldfabrikken[5412:19d03] *** 由于未捕获的异常“UIViewControllerHierarchyInconsistency”而终止应用程序，原因：“一个视图一次最多只能与一个视图控制器关联！视图 > 与 关联。在将此视图与关联之前清除此关联。***第一掷调用堆栈：（0x2097012 0x1c78e7e 0x2096deb 0xa90309 0xb275ac 0xb23a90 0x3206 0xb23817 0xb23882 0x2b49 0xa3f7b7 0xa3fda7 0xa40fab 0xa52315 0xa5324b 0xa44cf8 0x2aafdf9 0x2aafad0 0x200cbf5 0x200c962 0x203dbb6 0x203cf44 0x203ce1b 0xa407da 0xa4265c 0x2a4d 0x2985为0x1）的libc ++ abi.dylib：终止叫做抛出一个异常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T16:59:50.713

你不能在另一个控制器里面有一个控制器，这就是你在这里所做的 mvc = [[[mainViewController alloc] init] autorelease];

# eclipse - 在 Eclipse HTML 编辑器中，是否有一种简单的方法可以在内容辅助（自动完成）中使用自定义标签？

> ID：14341995
> 
> 赞同：2
> 
> 时间：2013-01-15T16:16:29.573
> 
> 标签：eclipse, content-assist

我正在学习在工作中使用新的托管电子商务系统，该系统使用专有的标记/脚本语言作为其页面模板。它们类似于 JSP 页面（尽管服务器标签没有前缀，即没有“xsp:”）并使用类似于表达式语言的 ${expressions}。我们正在从 .Net 系统过渡，所以我所有的开发人员都非常习惯在我们的编辑器中提供全面的 IntelliSense。

所以，我的问题是是否可以在内容辅助中使用这些自定义标签，以及是否值得麻烦。（我知道后者是主观的——我是一个理性的人，愿意接受意见。）

仅供参考，我更关心标签的自动完成，但表达式也会很好，具体取决于涉及的工作量。我们正在使用带有 WTP 的 Java EE、Juno（核心 IDE v4.2.1）的 eclipse ......抱歉，我不太确定如何或共享什么，就版本和组件而言！让我知道是否有任何其他信息会有所帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:29:26.137

一个绝对轻松的答案是创建一个 Eclipse 插件来支持您的专有模板语言。一个开始的地方可能是[Veloeclipse](http://code.google.com/p/veloeclipse/)，一个用于 Eclipse 的 HTML/XML/JSP/Velocity 编辑器，它声称具有以下您可能会感兴趣的特性：

*   速度指令的智能缩进（按回车键或使用制表符时）
*   代码折叠
*   代码格式
*   html标签的智能缩进（按回车键或使用标签时）
*   html和velocity的语法高亮
*   **标签、指令和引用的自动完成和内容辅助**（html 属性值中的 Ctrl + 空格或打开或关闭标签时）

来源：[http ://code.google.com/p/veloeclipse/source/checkout](http://code.google.com/p/veloeclipse/source/checkout)

# python - Python 对象定义

> ID：14341999
> 
> 赞同：0
> 
> 时间：2013-01-15T16:16:43.957
> 
> 标签：python, oop, object, instantiation

这应该很容易，但因为我错过了一些东西。

我有一个完全符合我预期的对象。

```
class TextElement(ContentItemElement):
    '''
    Single String Elements, for example, headlines
    '''
    def __init__(self, name, data):
       super(TextElement, self).__init__()
       self.name=name
       self.text=data

    def prettyPrint(self):
        printstring =  u'*HTML* '
        self.name.encode('utf-8')
        printstring += u'<h3> '+self.name+u' </h3>'
        self.text.encode('utf-8')
        printstring += u'<p> '+self.text+u' </h3>'
        print printstring 
```

好的，太好了，我可以实例化它，它完全符合我的要求。但我真的很想创建一个更具体的 TextObjects 版本。所以我这样做：

```
class CiteElement(TextElement):
    '''
    Single String Elements, for example, headlines
    '''
    def __init__(self, name, data):
        super(CiteElement, self).__init__()
        self.validValues=['Crap I make up', 'Crap I found on the web'] 
```

但是当我尝试实例化它时，这有效：

```
ee = TextElement(element, self.raw[element])
ee.validValues=['Crap I make up', 'Crap I found on the web'] 
```

但这不

```
ee = CiteElement(element, self.raw[element]) 
```

而是给我这个错误：

```
TypeError: __init__() takes exactly 3 arguments (1 given) 
```

显然我错过了一些小东西。python对象的关键。我应该很清楚的东西，但多年来一直在编码。但它是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:18:43.787

这条线

```
super(CiteElement, self).__init__() 
```

应该

```
super(CiteElement, self).__init__(name, data) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:19:05.573

因为你的基类的构造函数被定义为

```
def __init__(self, name, data):
.... 
```

而且您在没有派生类参数的情况下调用它。

```
def __init__(self, name, data):
    super(CiteElement, self).__init__() 
```