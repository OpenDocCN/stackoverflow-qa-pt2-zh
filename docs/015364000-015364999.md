# StackOverflow 问答 15364000-15364999

# javascript - JQuery UI、Jquery touch打孔和JQuery工具冲突

> ID：15364000
> 
> 赞同：0
> 
> 时间：2013-03-12T14:28:42.403
> 
> 标签：javascript, jquery, jquery-ui, jquery-tools

我使用标题中的所有库。我想使用 Jquery 工具来获得这个：http: [//jquerytools.org/documentation/rangeinput/index.html](http://jquerytools.org/documentation/rangeinput/index.html)和触摸打孔来模拟移动事件。这两个库一起无法工作。

如何包含和使用这两个库不引起冲突？

使用示例如下：

触摸打孔器的使用：

```
$(thumb).draggable({}); 
```

jQuery工具的使用：

```
$(":range").rangeinput(); 
```

出于某种奇怪的原因，如果我使用 JQuery 工具中的范围工具，我的拖动实现会失败：S

# quickbooks - QBWC 错误 QBWC1013：“无法启动 QuickBooks。”

> ID：15364005
> 
> 赞同：4
> 
> 时间：2013-03-12T14:28:51.523
> 
> 标签：quickbooks, qbwc

我无法从 Web 连接器启动 QuickBooks。我正在传递有效的文件路径，根据文档，一切看起来都是正确的。

*   QBWC 版本为 2.1.0.3.0
*   QB Ver 是 Premier Contractor Edition 2010

如果我已经打开 QuickBooks，则 Web 连接器运行良好。如果它没有打开，我会收到 QBWC1013 错误...

日志的相关部分：

```
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.instantiateWebService() : Initiated connection to the following application.
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.instantiateWebService() : AppName: FOO
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.instantiateWebService() : AppUniqueName (if available): FOO
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.instantiateWebService() : AppURL: https://www.foo.com/server.php
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.do_serverVersion() : *** Calling serverVersion().
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.do_serverVersion() : Received from serverVersion() following parameter:<serverVersionRet="PHP QuickBooks SOAP Server v1.5.3 at /server.php">
20130312.14:14:56 UTC   : QBWebConnector.SOAPWebService.do_clientVersion() : *** Calling clientVersion() with following parameter:<productVersion="2.1.0.30">
20130312.14:14:57 UTC   : QBWebConnector.SOAPWebService.do_clientVersion() : Received from clientVersion() following parameter:<clientVersionRet="">
20130312.14:14:57 UTC   : QBWebConnector.SOAPWebService.do_clientVersion() : This application agrees with the current version of QBWebConnector. Allowing update operation.
20130312.14:14:57 UTC   : QBWebConnector.SOAPWebService.do_authenticate() : Authenticating to application 'FOO', username = 'foo'
20130312.14:14:57 UTC   : QBWebConnector.SOAPWebService.do_authenticate() : *** Calling authenticate() with following parameters:<userName="foo"><password=<MaskedForSecurity>
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.updateWS() : Received from authenticate() following parameters:<authRet[0]="91f62aac622b49ad483f20ef9d7729a3"><authRet[1]=""\\FOOSERVER\Users\Public\Documents\Intuit\QuickBooks\Company Files\Some Company File Inc..QBW""><authRet[2]=""><authRet[3]="">
20130312.14:14:58 UTC   : QBWebConnector.RegistryManager.setCurrentWebServiceName() : HKEY_CURRENT_USER\Software\Intuit\QBWebConnector\CurrentWebServiceName has been set to FOO
20130312.14:14:58 UTC   : QBWebConnector.RegistryManager.setCurrentWebServiceSessionTicket() : HKEY_CURRENT_USER\Software\Intuit\QBWebConnector\CurrentWebServiceSessionTicket has been set to 91f62aac622b49ad483f20ef9d7729a3
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.CheckCFNResponse() : User authenticated.
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.do_authenticate() : Done.
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.OpenConnection() : Connecting to QuickBooks...
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.handleAllOtherError() : QBWC1013: Error connecting to QuickBooks. Returning error message to application.
Could not start QuickBooks.
20130312.14:14:58 UTC   : QBWebConnector.SOAPWebService.do_connectionError() : *** Calling connectionError() with following parameters:<wcTicket="91f62aac622b49ad483f20ef9d7729a3"><hresult="0x80040408"><message="Could not start QuickBooks.">
20130312.14:14:59 UTC   : QBWebConnector.SOAPWebService.do_connectionError() : Received from connectionError() following parameters:<tryAgain="done">
20130312.14:14:59 UTC   : QBWebConnector.SOAPWebService.OpenConnection() : Error connecting to QuickBooks. Application sent back DONE. Job ending.
20130312.14:14:59 UTC   : QBWebConnector.RegistryManager.setUpdateLock() : HKEY_CURRENT_USER\Software\Intuit\QBWebConnector\UpdateLock has been set to False
20130312.14:14:59 UTC   : QBWebConnector.RegistryManager.setUpdateLock() : ********************* Update session unlocked *********************
20130312.14:14:59 UTC   : QBWebConnector.WebServiceManager.DoUpdateSelected() : Update completed with errors. See log (QWClog.txt) for details. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T21:39:46.480

I'm going to assume that your QWC file is with the correct format.

If may looks something like this

```
<QBWCXML>
  <AppName>Example WS</AppName>
  <AppID></AppID>
  <AppURL>https://localhost/Quickbooks.asmx</AppURL>
  <AppDescription>Example Service Service</AppDescription>
  <AppSupport>https://localhost/</AppSupport>
  <UserName>Etile</UserName>
  <OwnerID>{XXXXB9B1-86F1-4fcc-B1EE-566DE1813D20}</OwnerID>
  <FileID>{XXXX4FB5-33D9-4815-AC85-BC87A7E7D1EB}</FileID>
  <QBType>QBFS</QBType>
  <Scheduler>
    <RunEveryNMinutes>1</RunEveryNMinutes>
  </Scheduler>
</QBWCXML> 
```

When you add the application to QuickBooks's Web Connector, you will be prompted to allow the application access to QuickBooks data. You need to select the last option "**Yes, always; allow access even if QuickBooks is not running**"

![enter image description here](../Images/406970bf853b8dd4aba36bcbffb3b3ef.png)

And don't forget to return the full path to the company file from your Web Service's authenticate() method.

A Sample SOAP Response would be:

```
<?xml version="1.0" encoding="utf-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://developer.intuit.com/">
  <SOAP-ENV:Body>
    <ns1:authenticateResponse>
      <ns1:authenticateResult>
        <ns1:string>1e3ea2ed-a734-03e4-ed8c-80eb12f19845</ns1:string>
        <ns1:string>C:\Quickbooks Company File.QBW</ns1:string>
      </ns1:authenticateResult>
    </ns1:authenticateResponse>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

Note that if you are using [quickbooks-php](https://github.com/consolibyte/quickbooks-php), the file must be added [manually](http://wiki.consolibyte.com/wiki/doku.php/quickbooks_integration_php_consolibyte#how_can_i_tell_the_web_connector_to_connect_to_quickbooks_even_if_quickbooks_is_not_open) for some reason. The Web Connector documentation and the new [QuickBooks integration wiki](http://www.consolibyte.com/docs/index.php/Main_Page) both lack clarity on this detail.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-07-30T16:14:24.850

我在这件事上撞到了墙上，但在与 Intuit 通了 4 个小时的电话后，最终让 2 级开发团队参与其中，他们让我了解了这个模糊不清的错误的更多细节。当您收到此错误时，问题不在于它无法启动快速手册，而是您从服务器请求的请求试图错误地打开文件。会导致这种情况的事情。文件名错误，文件路径错误。您的请求格式不正确。
在我的情况下，我们的文件名是正确的，但是我的服务器应该提取文件的路径，您可以在 hkey_current_user\software\intuit\qbwebconnector\soapwebservices\ 的注册表中确认该文件的路径，查找 companyfile，您会看到名称和完整路径。

希望这可以帮助某人处理这个模糊的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-24T14:26:04.173

由于日志数据显示 -> 用户已通过身份验证，这意味着 .qwc 文件格式正确。身份验证后，Web 连接器向 QuickBook 发出连接请求，这在您的情况下失败。

通过网络连接器连接到 QuickBooks 桌面的步骤是：

1.  在管理员模式下运行 Web 服务和 QuickBook 桌面应用程序
2.  Web 服务名称和 QuickBook 公司名称应相同
3.  在多用户模式下运行 QuickBook 桌面，以便您也可以通过 Web 连接器连接 QuickBook。
4.  在 Web 服务代码中，如果用户是真实的，则使 authReturn[1]="" // 连接到当前在 QuickBooks 中打开的公司文件

它对我有用。祝你一切安好。

# javascript - 如何实现 KineticJS 层的 Minimap？

> ID：15364008
> 
> 赞同：4
> 
> 时间：2013-03-12T14:28:59.140
> 
> 标签：javascript, layer, kineticjs, stage

我目前正在开发一个显示某种地图的应用程序。您可以在地图上执行多项操作。地图可以变得非常大，因此用户需要一个较小的地图（Minimap）来跟踪整个地图。

目前有两个阶段。一张是大地图，一张是小地图。大地图包含多个图层，但只需要在小地图上显示其中一个（类似于布局）。

所以我想为特定图层的AfterDrawing添加一个EventListener。

`this.layoutLayer.afterDraw(this._initMinimap);`

在事件侦听器中，我正在执行以下操作：

```
//...
_initMinimap : function(event) {
    var ctrl = event;
    if (!this.minimap) {
        this.minimap = new Kinetic.Stage({
            container : 'container',
            width : 165,
            height : 165
        });
    }
    if (!this.mapLayer) {
        this.mapLayer = new Kinetic.Layer({});
    }
    this.mapLayer.clear();
    this.minimap.clear();
    this.layoutLayer.toImage({
        callback : function(img) {
            var image = new Kinetic.Image({
                image : img
            });
            image.setScale(0.01,0.01);
            ctrl.mapLayer.add(image);
        }
    });
    this.minimap.add(this.mapLayer);
    this.minimap.draw();
},
//... 
```

有谁知道如何解决这个问题？我对 JavaScript 还不是很熟悉，所以我不太确定这是否是正确的方法。

提前致谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-03T08:57:06.010

You can get a miniature copy of the layer by using `clone` and `scale`:

```
<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">
        <title>Minimap Test</title>
    </head>
    <body>
        <div id="container"></div>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/kineticjs/5.0.6/kinetic.min.js"></script>
        <script>
            var squareQuantity = 10,
                tileWidth = window.innerWidth / squareQuantity,
                tileHeight = window.innerHeight / squareQuantity,
                background = new Kinetic.Layer,
                stage = new Kinetic.Stage({
                    width: window.innerWidth,
                    height: window.innerHeight,
                    container: 'container'
                });

            for ( var x = 0; x < squareQuantity; x++ ){
                for ( var y = 0; y < squareQuantity; y++ ){
                    background.add(
                        new Kinetic.Rect({
                            x: x * tileWidth,
                            y: y * tileHeight,
                            width: tileWidth,
                            height: tileHeight,
                            fill: '#' + Math.random().toString( 16 ).substring( 2, 8 )
                        })
                    )
                }
            }

            var mini = background.clone().scale({ x: 0.2, y: 0.2 });

            stage.add( background );
            stage.add( mini );

            background.draw();
        </script>
    </body>
</html> 
```

[Example](http://codepen.io/anon/pen/pCjlb)

# javascript - 将自定义视图添加到子网格“添加现有按钮”时出错

> ID：15364009
> 
> 赞同：2
> 
> 时间：2013-03-12T14:29:04.260
> 
> 标签：javascript, dynamics-crm-2011

当用户在子网格中为多对多关系添加现有记录时，我想向弹出窗口添加自定义视图。

我按照以下[链接上的说明进行操作](http://community.dynamics.com/crm/b/magnetismsolutionscrmblog/archive/2013/02/04/filter-n-n-add-existing-lookup-dynamics-crm-2011-rollup-12.aspx#.UT8xpKWePzg)

但是当我去添加现有记录时，它会引发一个通用错误，即不允许我下载日志文件。谁能指出我正确的方向以找出为什么这不起作用？

我将在下面发布代码。

```
function FilterSubGridLookup(gridTypeCode, gridControl, primaryEntity) {

if (primaryEntity != "ts_pmo_activity_request") {

    Mscrm.GridRibbonActions.addExistingFromSubGridAssociated(gridTypeCode, gridControl);
}
else {

    var fetchXml = '<fetch distinct="false" mapping="logical" output-format="xml-platform" version="1.0"> -<entity name="ts_qualification_area"> <attribute name="ts_qualification_areaid"/> <attribute name="ts_descriptor"/> <attribute name="createdon"/> <order descending="false" attribute="ts_descriptor"/> -<filter type="and"> <condition attribute="ts_solution_qualification_id" value="' + solutionQualificationId + '" uitype="ts_solution_qualification" operator="eq"/> </filter> </entity> </fetch>';
    var layoutXml = "<grid name='resultset' object='1' jump='ts_qualification_areaid' select='1' icon='1' preview='1'><row name='result' id='ts_qualification_areaid'><cell name='ts_descriptor' width='150' /></row></grid>";

    addExistingFromSubGridCustom(gridTypeCode, gridControl, fetchXml, layoutXml, "Filtered Qualification Areas");
}    
} 
```

```
function addExistingFromSubGridCustom(gridTypeCode, gridControl, fetch, layout, viewName) {

var viewId = "{1DFB2B35-B07C-44D1-868D-258DEEAB88E2}"; // a dummy view ID 

var relName, roleOrd;

if (typeof (gridControl.GetParameter) === "function") { //post rollup 12 
    relName = gridControl.GetParameter("relName");
    roleOrd = gridControl.GetParameter("roleOrd");
}
else { //pre rollup 12 
    relName = gridControl.getParameter("relName");
    roleOrd = gridControl.getParameter("roleOrd");
}

//creates the custom view object 
var customView = {
    fetchXml: fetch,
    id: viewId,
    layoutXml: layout,
    name: viewName,
    recordType: gridTypeCode,
    Type: 0
};

//pops the lookup window with our view injected 
var lookupItems = LookupObjects(null, "multi", gridTypeCode, 0, null, "", null, null, null, null, null, null, viewId, [customView]);

//once the lookup window is closed, we need the parent record ID and ETC before associating selected records 
if (lookupItems && lookupItems.items.length > 0) {
    var parentId;
    var parentTypeCode;
    if (typeof (GetParentObject) == "function") { //post rollup 12 has its own function to get this 
        var parent = GetParentObject();
        parentId = parent.id;
        parentTypeCode = parent.objectTypeCode;
    }
    else { //pre rollup 12 still needs to use the old way 
        var parent = typeof (crmFormSubmit) == "undefined" ? $get("crmFormSubmit") : crmFormSubmit; //according to daniels blog crmFormSubmit should already be defined, but it's not... 
        if (parent) {
            parentId = parent.crmFormSubmitId.value;
            parentTypeCode = parent.crmFormSubmitObjectType.value;
        }
        else {
            parentId = window.parent.crmFormSubmit.crmFormSubmitId.value;
            parentTypeCode = window.parent.crmFormSubmit.crmFormSubmitObjectType.value;
        }
    }

    //associates the selected records 
    AssociateObjects(parentTypeCode, parentId, gridTypeCode, lookupItems, IsNull(roleOrd) || roleOrd == 2, "", relName);
}   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:19:01.600

在您的 fetch xml 中，您有破折号。看看删除它们是否可以解决您的问题：

前：

```
<fetch distinct="false" mapping="logical" output-format="xml-platform" version="1.0"> 
-<entity name="ts_qualification_area">
    <attribute name="ts_qualification_areaid"/>
    <attribute name="ts_descriptor"/>
    <attribute name="createdon"/>
    <order descending="false" attribute="ts_descriptor"/> 
    -<filter type="and">
        <condition attribute="ts_solution_qualification_id" value="' + solutionQualificationId + '" uitype="ts_solution_qualification" operator="eq"/>
    </filter>
</entity> 
```

后：

```
<fetch distinct="false" mapping="logical" output-format="xml-platform" version="1.0"> 
    <entity name="ts_qualification_area">
        <attribute name="ts_qualification_areaid"/>
        <attribute name="ts_descriptor"/>
        <attribute name="createdon"/>
        <order descending="false" attribute="ts_descriptor"/> 
        <filter type="and">
            <condition attribute="ts_solution_qualification_id" value="' + solutionQualificationId + '" uitype="ts_solution_qualification" operator="eq"/>
        </filter>
    </entity>
</fetch> 
```

# c++ - 用于 Sampler2D 的 c++ OpenGL glGetUniformLocation 在 Raspberry PI 上返回 -1 但适用于 Windows

> ID：15364010
> 
> 赞同：3
> 
> 时间：2013-03-12T14:29:07.153
> 
> 标签：c++, opengl-es, shader, raspberry-pi

我正在制作一个跨平台的 OpenGL 程序。但是，我遇到了一个问题，glGetUniformLocation 应该在我的着色器程序中返回一个统一变量的位置，它返回 -1，它只发生在 Linux（Raspbian 发行版，在 Raspberry PI 上运行）和 Windows相同的代码完美运行！这是我的代码：

**加载Shader程序功能：**

```
int shader, status;

programID = glCreateProgram();

// Load vertex shader
shader = LoadShaderFromString(GL_VERTEX_SHADER, Tools::GetFileAsString("VertexShader.glsl"), "Unable to compile vertex shader.\n");
glAttachShader(programID, shader);

// Load pixel shader
shader = LoadShaderFromString(GL_FRAGMENT_SHADER, Tools::GetFileAsString("FilterPixelShader.glsl"), "Unable to compile pixel shader.\n");
glAttachShader(programID, shader);

// Link the program
glLinkProgram(programID);
glGetProgramiv(programID, GL_LINK_STATUS, &status);

if (status == 0)
{
    Log("Unable to link filter shader program.\n");
    PrintProgramLog(programID);
    Fail();     // Quits program
}   

// returns -1 here!
frameTextureLocation = glGetUniformLocation(programID, "FrameTextureUnit");
if (frameTextureLocation == -1)
{
    int errorCode = glGetError();
    Log(string("Error retrieving variable frameTextureLocation from shader program: "));
    Log((const char*)glewGetErrorString(errorCode))
    Log("!\n");
    Fail();
} 
```

**LoadShaderFromString：**

```
int Shader::LoadShaderFromString(int type, const string& shaderSource, const string& errorMessage)
{
    int shader, status;
    const char* programSource;

    shader = glCreateShader(type);
    programSource = shaderSource.c_str();
    glShaderSource(shader, 1, &programSource, nullptr);
    glCompileShader(shader);
    glGetShaderiv(shader, GL_COMPILE_STATUS, &status);

    if (status == 0)
    {
        Log(errorMessage);
        PrintShaderLog(shader);
        Fail();
    }

    return shader;
} 
```

**最后，着色器本身：**

```
uniform sampler2D FrameTextureUnit; 
uniform sampler2D BackgroundTextureUnit;

#if __VERSION__ >= 130 
    // Texture coordinate 
    in vec2 texCoord; 

    // Final color 
    out vec4 gl_FragColor; 
#else
    // Texture coordinate 
    varying vec2 texCoord; 
#endif

uniform float Tolerance;                    // Tolerance for color difference
uniform vec4 FilterColor;                   // Color of the filter

void main()
{
    vec4 pixel = texture2D(FrameTextureUnit, texCoord);
    vec4 background = texture2D(BackgroundTextureUnit, texCoord);

    float difference = abs(background.x - pixel.x)
                   + abs(background.y - pixel.y)
                   + abs(background.z - pixel.z);

    if (difference > Tolerance)
    {
        gl_FragColor = FilterColor;
    }
    else
    {
        // Y = 0.2126 R + 0.7152 G + 0.0722 B 
        float gray = pixel.x * 0.2126 + pixel.y * 0.7152 + pixel.z * 0.0722;
        gl_FragColor = vec4(gray, gray, gray, 1);
    }
} 
```

有谁知道为什么会发生这种情况？:( 值得补充的是错误处理代码：

```
 int errorCode = glGetError();
    Log(string("Error retrieving variable frameTextureLocation from shader program: "));
    Log((const char*)glewGetErrorString(errorCode)); 
```

**打印“从着色器程序中检索变量 frameTextureLocation 时出错：没有错误”。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T15:38:33.650

始终在着色器顶部指定[GLSL 版本](http://www.opengl.org/wiki/GLSL_Core_Language#Version)，否则默认为非常旧的版本。它必须是第一行。它还将消除对内联版本检查的需要。

```
#version 150
// rest of shader here 
```

# sql-server-2008 - Lotus Domino NotesSQL ODBC 和 SQL 2008 查询

> ID：15364018
> 
> 赞同：3
> 
> 时间：2013-03-12T14:29:21.420
> 
> 标签：sql-server-2008, odbc, lotus-notes, lotus-domino, openquery

我正在尝试从几个不同的来源获取相同的信息，但在尝试使用 NotesSQL 和 SQL 2008 时遇到了困难。我想做的是从 Domino 服务器上的几个不同视图中检索信息。一个视图是默认视图，另一个是创建的视图。

我使用的一种方法是 Powershell，我在其中获取数据库，然后选择视图，获取第一个文档，然后遍历我需要的其余视图抓取字段。我选择的视图是**人物**视图。

我试图使用 SQL 2008 复制同样的东西，使用 NotesSQL 驱动程序，设置 ODBC 连接，然后创建到该 Notes 数据库的链接服务器。我正在使用以下查询从人员视图中进行选择：

```
select * from openquery(MyNotesServer,'Select * from People') 
```

但是，当我使用 Powershell 并遍历该视图中返回的文档时，从该视图返回的内容不是我能够看到的。Powershell 在其中显示 100 多列，而 SQL 仅返回 5 列。此外，它们被命名为“_12”、“17”等。一些字段（可能是自定义的，我不知道）有一个有意义的名称。在显示的字段中，我可以按名称（“_12”等）选择它们，但不能选择其他任何内容。行数 (SQL) 与视图中的文档数 (Powershell `$view.Allentries.Count`) 相同。

查询已创建的视图（3 个字段）：

```
select * from openquery(MyNotesServer,'Select * from MyCreatedView') 
```

返回该视图中的所有字段，它们的名称与视图中的一样。

在 T-SQL 查询 People 视图中，您如何获得我在 Powershell 脚本中发现的我知道的列的名称？它们似乎没有被命名为相同的东西，那么当您`select *`从视图中返回的 5 之外，您如何检索？我已通读 Notes 文档和示例，但无法弄清楚映射到何处。

这背后的原因是希望利用 SQL 和 notes.id 文件而不是运行脚本。另外，我想利用已经存在的全局视图，而不是只有作者才能访问的视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T04:32:31.917

首先，在 Lotus Notes 文档中，当您阅读视图时会找到“列”，而不是字段。

其次，这些列配置了一个名为“Programmatic Name”的选项。在该选项中，您可以添加“别名”。Lotus Notes 默认将值设置为“$12”、“$17”等。问题是 NotesSQL 将“$”更改为“_”。这就是您看到“_12”、“_17”等的原因。

你怎么得到原来的名字？据我记得（我附近没有 Lotus Notes 进行验证）你不能。但是，您可以使用包含所需数据的列创建另一个视图，并输入适当的名称。最简单的方法是复制/粘贴视图，删除不需要的列，然后根据需要进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T19:21:49.393

您可以使用`select * from Person`. Person 是表单名称，而不是视图名称。Notes 和 Domino 没有关系。NSF 文件是一个文档数据库。其中的视图是已经具有隐式选择的预构建索引。即，“人员”视图选择使用“人员”表单创建的所有文档。

上面的查询绕过了视图的使用，将为您提供使用 Person 表单创建的所有文档的所有字段。

实际上，仔细想想，更好的查询是`select * from Person where type='Person'`. 这是因为 Domino 中的“人物”视图在其选择公式中使用`type="Person"`而不是。`form="Person"`理论上可以使用 Person 表单创建文档，但 Type 字段设置为不同的值。这种变化将确保您始终获得您在“个人”视图中看到的相同列表。

**但是：** 无论哪种情况，它都是低效的。NotesSQL 驱动程序必须执行完整的数据库搜索，而不是简单地读取现有视图的索引。它将使用 Notes 公式 SELECT Form="Person" & Type="Person" 进行搜索。 *我真的不建议这样做，*除非您查询的是小型 Domino 目录数据库。

最佳实践是创建一个包含您真正需要的所有字段的视图，然后针对该视图进行查询。

# database - 字段结束修饰符在 SphinxQL 中不起作用

> ID：15364025
> 
> 赞同：0
> 
> 时间：2013-03-12T14:29:29.493
> 
> 标签：database, sphinx, sphinxql

当我按列字段结尾修饰符过滤确切的单词时不起作用。

这是示例：

> SELECT * FROM indexTable WHERE MATCH('@column1 ^abc$');

这返回了我：（不仅是精确的“abc”）

> 美国广播公司
> 
> 美国广播公司
> 
> A B C D

配置或语法中是否有解决此问题的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:49:58.413

1) 确保 $ 确实进入了 sql 查询，它可能被你的应用程序所写的任何语言所消耗。例如 PHP 认为它在双引号字符串中意味着一个变量。

2）你使用的是什么版本的狮身人面像。使用最新的。一些版本的字段结束修饰符被破坏。

# javascript - Window.Onload 函数未在 IE 10 中触发

> ID：15364034
> 
> 赞同：2
> 
> 时间：2013-03-12T14:29:46.287
> 
> 标签：javascript, html, onload, internet-explorer-10

我正在尝试创建一个缩放和平移应用程序以在所有浏览器上工作。它适用于所有其他浏览器，但在 IE 10 中 - 只是不加载图像，但当我单击画布放大时会重新绘制它。这是代码的 window.onload 部分：

```
window.onload = function(){     
    var ctx = canvas.getContext('2d');
    trackTransforms(ctx);
    function redraw(){
    ctx.save();
    ctx.setTransform(1,0,0,1,0,0);
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.restore();
    ctx.drawImage(map,0,0, canvas.width, canvas.height);

    }
    redraw();

    var lastX=canvas.width/2, lastY=canvas.height/2;
    var dragStart,dragged;
    canvas.addEventListener('mousedown',function(evt){
        document.body.style.mozUserSelect = document.body.style.webkitUserSelect = document.body.style.userSelect = 'none';
        lastX = evt.offsetX || (evt.pageX - canvas.offsetLeft);
        lastY = evt.offsetY || (evt.pageY - canvas.offsetTop);
        dragStart = ctx.transformedPoint(lastX,lastY);
        dragged = false;
    },false);
    canvas.addEventListener('mousemove',function(evt){
        lastX = evt.offsetX || (evt.pageX - canvas.offsetLeft);
        lastY = evt.offsetY || (evt.pageY - canvas.offsetTop);
        dragged = true;
        if (dragStart){
            var pt = ctx.transformedPoint(lastX,lastY);
            ctx.translate(pt.x-dragStart.x,pt.y-dragStart.y);
            redraw();
        }
    },false);
    canvas.addEventListener('mouseup',function(evt){
        dragStart = null;
        if (!dragged) zoom(evt.shiftKey ? -1 : 1 );
    },false);

    var scaleFactor = 1.1;
    var zoom = function(clicks){
        var pt = ctx.transformedPoint(lastX,lastY);
        ctx.translate(pt.x,pt.y);
        var factor = Math.pow(scaleFactor,clicks);
        ctx.scale(factor,factor);
        ctx.translate(-pt.x,-pt.y);
        redraw();
    }

    var handleScroll = function(evt){
        var delta = evt.wheelDelta ? evt.wheelDelta/40 : evt.detail ? -evt.detail : 0;
        if (delta) zoom(delta);
        return evt.preventDefault() && false;
    };
    canvas.addEventListener('DOMMouseScroll',handleScroll,false);
    canvas.addEventListener('mousewheel',handleScroll,false);
};
map.src = 'http://www.theodora.com/maps/new9/time_zones_4.jpg'; 
```

# c# - 变量如何知道它实现的类型？

> ID：15364036
> 
> 赞同：4
> 
> 时间：2013-03-12T14:29:55.857
> 
> 标签：c#

据我所知，每个变量都知道它的运行时类型。

这是一个例子：

```
void Main()
{
    C c = new C();
    c.M();
    I i = (I)c;
    i.M();
}

public interface I
{
    void M();
}

public class C : I
{
    void I.M() 
    {
        Console.WriteLine("I.M");
    }

    public void M() 
    {
        Console.WriteLine("M");
    }
} 
```

如果我理解正确，`i`仍然知道它的类型是`C`. 那么，让`i`我们决定使用`I.M`而不是的机制是`M`什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T14:36:51.950

每个对象内部都有自己的 TypeHandle，请参见下面的对象内部结构：

[MSDN - 深入了解 .NET Framework 内部结构以了解 CLR 如何创建运行时对象](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)

![在此处输入图像描述](../Images/b4ea91183d32a0e43f52cea64bbcdb4a.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T14:48:26.777

你想知道*运行时方法绑定*是如何工作的，也就是说，当编译时没有足够的信息来精确地编码到程序中调用哪个方法时，运行时如何知道调用一个方法 M 而不是另一个？

这是一个很好的练习：尝试编写一个具有该行为的程序，*而不使用该功能，因为它已经在运行时编写*。通过这样做，您将深入了解实现运行时的人员是如何做到的。

我在这里完成了虚拟功能的练习：

[http://blogs.msdn.com/b/ericlippert/archive/2011/03/17/implementing-the-virtual-method-pattern-in-c-part-one.aspx](http://blogs.msdn.com/b/ericlippert/archive/2011/03/17/implementing-the-virtual-method-pattern-in-c-part-one.aspx)

阅读该系列文章，您将了解如何在没有虚拟调度的语言中模拟虚拟调度。我在文章中展示的基本思想或多或少是虚拟调度在 C# 中的实际工作方式。接口调度在实践中有点棘手，但概念基本相同。

# css - 更改徽标位置后菜单栏不起作用

> ID：15364039
> 
> 赞同：0
> 
> 时间：2013-03-12T14:30:02.947
> 
> 标签：css, drop-down-menu

我正在使用免费的 wordpress 主题[Pitch](http://siteorigin.com/theme/pitch/)。我重新定位了徽标并将其与 menubar 对齐。

像这样：

![在此处输入图像描述](../Images/2f7b95e11bc893a39639412a947023a6.png)

但是在这样做之后，不仅下拉菜单栏而且整个菜单栏都不起作用。

如何使菜单栏在保持所需布局的同时工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:40:13.387

我什至不打算检查 css... 因为您使用的是 WordPress 主题，所以很有可能您设法删除了与菜单相关的部分代码，因为代码被最小化了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T09:29:10.527

我建议您对 CSS 和索引模板文件进行以下更改：

对于您的 CSS，编辑以下`id`s 如下：

```
#mainmenu {
    margin: 0 auto;
    width: 660px;
    word-wrap: break-word;
    position: relative;
}

ul#mainmenu-menu {
    background: -moz-linear-gradient(center top , #F7F7F7 0%, #F4F4F4 100%) repeat scroll 0 0 transparent;
    border: 1px solid #E2E2E2;
    float: none;
    margin-right: 160px;
    position: relative;
    width: 760px;
}

#logo {
    background: url("images/logo.png") no-repeat scroll 0 0 transparent;
    height: 50px;
    margin: 3px 0 0 -200px;
    position: absolute;
    width: 200px;
} 
```

为您的 HTML 进行以下更改：

1.  从您放置徽标的位置移除徽标容器并将其放入`mainmenu`容器中，如下所示：

    `<div id="mainmenu" class=""> <div id="logo"> <a href="http://aniyanetworks.net/Blog" title="Aniya Network Solutions LTD. - Our Experience is your Business Solutions" id="logo-link"><h1>Aniya Network Solutions LTD.</h1></a> </div> <div class="container"> <div class="menu-main-menu-container"> <ul id="mainmenu-menu" class="menu">......the rest of the menu HTML here`

2.  不要忘记`<div class="container">`在您的徽标容器内移除。这不是必需的。

3.  如果您同意我的建议，请勾选“已回答”。

# c++ - 使用 qt 和 opengl 编译 c++ 项目时找不到标识符错误

> ID：15364040
> 
> 赞同：0
> 
> 时间：2013-03-12T14:30:04.573
> 
> 标签：c++, visual-studio, opengl

我正在尝试编译一个使用 QT 和 opengl 的 C++ 程序。

当我尝试编译它时，我收到了这个错误：

```
 Error  1   error C3861: 'gluErrorString': identifier not found 
```

寻找这个标识符，告诉我它定义在：glu.h 文件的第 64 行，它是 VS 2012 安装的一部分。

为什么我会收到此错误？

我知道源代码是使用 VS 2010 开发的，但如果我使用 VS 2012，我认为应该没有任何区别。

我应该对项目设置进行任何更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:40:49.577

首先检查您是否有该行：

```
#include <glu.h> 
```

某处。

未能打开`glu.h`并确保没有`#define`阻止包含该行的 s。您可能需要为您的项目添加额外的定义。

有时只运行预处理器（不确定如何在 VS 中执行此操作）并确保符号最终出现在您的 cpp 文件中可能很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T09:02:00.753

添加头文件 glu.h 后，您可能还会收到未解析符号 gluErrorString 的链接错误。您可以通过在项目设置的输入库中添加 glu32.lib 库来解决此问题。

# c# - 实体框架 5.0。类似“任何”查询的东西

> ID：15364043
> 
> 赞同：3
> 
> 时间：2013-03-12T14:30:11.890
> 
> 标签：c#, linq, entity-framework

这是我上一个[问题](https://stackoverflow.com/questions/15363337/entity-framework-5-0-what-is-wrong-with-my-query)的代码：

```
public DateTime GibSomeStartDate(IEnumerable<int> partnerNumbers, DateTime startTime)
{
     var contractsStartDate = from contract in this.databaseContext.Contract
                              where partnerNumbers.Contains(contract.Pnr) 
                                 && contract.SomeDateTime >= startTime
                              select contract.SomeDateTime;
} 
```

*我希望即使使用相同的代码，它也不会被标记或否决，因为它是另一个问题。*

我只想返回`contractsStartDate`包含任何`partnerNumbers`in的 (s) `contract.Pnr`。

例如，如果`partnerNumbers`是 1、2、3 并且有`contracts`1、3、4`Pnr`和 7 - 四个`contract`实例 - 比我需要`contract`的有`Pnr`1 和 3

用我的`where partnerNumbers.Contains(contract.Pnr)`我检查完全匹配 - 这不是我想要的。

*   是`contractsStartDate`类型 `System.Data.Entity.Infrastructure.DbQuery`

*   英孚 5.0

*   `databaseContext`是的孩子`System.Data.Entity.DbContext`

*更新*

*   `Contract`是一个`Entity`。`Pnr`是`int`财产

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T06:28:42.320

它的工作很好对不起！

为什么会这样？因为我测试错了！)

# java - 在android中重复代码

> ID：15364044
> 
> 赞同：0
> 
> 时间：2013-03-12T14:30:12.670
> 
> 标签：java, android

我想要一个在按下按钮时改变背景颜色的应用程序。500 毫秒后，我想将背景颜色更改为黑色 2000 毫秒。然后再次重复整个过程，直到用户终止。

我有以下代码，但它没有按我认为的那样工作。

```
private void set() {
    rl.setBackgroundColor(Color.WHITE);
    timer.scheduleAtFixedRate(new TimerTask() {
        @Override
        public void run() {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    rl.setBackgroundColor(Color.BLACK);
                    set(); // can I do that?
                }
            });             
        }
    }, 500);    
} 
```

有人能指出我正确的方向吗？我该怎么做？所以我想要：

1.  执行一些代码
2.  X时间过去后，我想执行另一个代码，它应该保持这种状态X时间
3.  重复过程，直到用户取消。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T14:46:00.893

我认为这样的事情应该有效

```
 Handler handler = new Handler();
Runnable turnBlack = new Runnable(){

    @Override
    public void run() {
        myView.setBackgroundColor(Color.BLACK);
        goWhite();
    }};

    Runnable turnWhite = new Runnable(){

        @Override
        public void run() {
            myView.setBackgroundColor(Color.White);
            goBlack();
        }};

public void goBlack() {
    handler.postDelayed(turnBlack, 500);
}

public void goWhite() {
    handler.postDelayed(turnWhite, 2000);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:43:36.890

使用 AnimationDrawable 有更简单的方法：

```
 AnimationDrawable drawable = new AnimationDrawable();
    ColorDrawable color1 = new ColorDrawable(Color.YELLOW);
    ColorDrawable color2 = new ColorDrawable(Color.BLACK);

    // First color yellow for 500 ms
    drawable.addFrame(color1, 500);

    // Second color black for 2000 ms
    drawable.addFrame(color2, 2000);

    // Set if animation should loop. In this case yes it will
    drawable.setOneShot(false);

    Button btn = (Button)findViewById(R.id.button1);
    btn.setBackground(drawable);
    findViewById(R.id.buttonLan).setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // Start animation
            ((AnimationDrawable)v.getBackground()).start();
        }
    }); 
```

# knockout.js - knockout.js：$index 和 $data 在一个文本绑定中一起使用

> ID：15364046
> 
> 赞同：1
> 
> 时间：2013-03-12T14:30:22.327
> 
> 标签：knockout.js

我想加入`$index`和`$data`文本绑定：

```
<ul data-bind='foreach: myItems'>
    <li data-bind="text: $index() + ': ' + $data()"></li>
</ul> 
```

但上面的语法不起作用。KO不支持这种情况吗？我是否要在我的模型中编写一些辅助函数或计算 observable ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:45:09.633

除非您在`myItems`数组中有函数，否则您`$data`通常不会是函数，因此您不需要`()`：

正如你的例外也说明了这一点：

> 类型错误：$data 不是函数；

所以下面的代码应该可以工作：

```
<ul data-bind='foreach: myItems'>
    <li data-bind="text: $index() + ': ' + $data"></li>
</ul> 
```

# asp.net - 将 asp:button 更改为输入按钮

> ID：15364047
> 
> 赞同：0
> 
> 时间：2013-03-12T14:30:33.470
> 
> 标签：asp.net, html

正在使用 asp: 按钮，但必须切换到

```
<input id="SubmitComments" type="button" 
```

向屏幕上的 btn 添加文本的属性是什么。类似于 asp:button 的“文本”属性

另外：我可以使用什么而不是 TextMode="MultiLine" rows=5？塔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:38:54.287

您可以将 Html 中的按钮用作

```
<input type="button" value="Click Here" />      // value= Text to show 
```

提交按钮

```
<input type="submit" value="Click Here to Submit" /> 
```

多行文本框

```
<textarea rows="10" cols="25" />   // can define rows and columns 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:32:56.023

`value='your text'`对按钮的文本使用属性。

```
<input id='SubmitComments' name='SubmitComments' type='button' value='your text'/> 
```

至于多行，我假设这是一个文本框。按钮听不到多行。

使用一个`textarea`元素进行多行文本输入。

```
<textarea id='yourTextBoxName' name='yourTextBoxName' rows='5' /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T14:33:56.717

```
<input type="submit" value="Submit"> 
```

使用`Value`Attribute 将文本添加到您的输入类型按钮

# python - 沿短轴扩展 pandas 面板框架

> ID：15364050
> 
> 赞同：3
> 
> 时间：2013-03-12T14:30:37.090
> 
> 标签：python, pandas, panel

我想沿熊猫的短轴扩展面板数据框架。我开始创建一个`dic`of `DataFrame`s 来生成一个面板。

```
import pandas as pd
import numpy as np
rng = pd.date_range('1/1/2013',periods=100,freq='D')
df1 = pd.DataFrame(np.random.randn(100, 4), index = rng, columns = ['A','B','C','D'])
df2 = pd.DataFrame(np.random.randn(100, 4), index = rng, columns = ['A','B','C','D'])
df3 = pd.DataFrame(np.random.randn(100, 4), index = rng, columns = ['A','B','C','D'])
pf = pd.Panel({'df1':df1,'df2':df2,'df3':df3}) 
```

正如预期的那样，我发现我有一个具有以下尺寸的面板：

> 尺寸：3 (items) x 100 (major_axis) x 4 (minor_axis) 项目轴：df1 到 df3 Major_axis 轴：2013-01-01 00:00:00 到 2013-04-10 00:00:00 Minor_axis 轴：A到 D

我现在想向 Minor 轴添加一个新数据集：

```
pf['df1']['E'] = pd.DataFrame(np.random.randn(100, 1), index = rng)
pf['df2']['E'] = pd.DataFrame(np.random.randn(100, 1), index = rng)
pf['df2']['E'] = pd.DataFrame(np.random.randn(100, 1), index = rng) 
```

我发现添加这个新的短轴后，面板阵列尺寸的形状没有改变：

```
shape(pf) 
```

> [3,100,4]

我能够访问major_axis中每个项目的数据：

```
pf.ix['df1',-10:,'E'] 
```

> 2013-04-01 0.168205 2013-04-02 0.677929 2013-04-03 0.845444 2013-04-04 0.431610 2013-04-05 0.501003 2013-04-06 -0.403605 2013-04-07 -0.185033 2013-04-08 0.270093 2013-04-09 1.569180 2013-04-10 -1.374779 频率：D，姓名：E

但是，如果我将切片扩展为包括多个主轴：

```
pf.ix[:,:,'E'] 
```

然后我遇到一个错误，说“E”是未知的。

谁能建议我哪里出错或执行此操作的更好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:44:25.813

这不起作用现在看到这个，[https://github.com/pydata/pandas/issues/2578](https://github.com/pydata/pandas/issues/2578) 但是你可以通过这种方式完成你想要的。这是一个非常便宜的操作，因为没有任何内容被复制。

```
In [18]: x = pf.transpose(2,0,1)

In [19]: x
Out[19]: 
<class 'pandas.core.panel.Panel'>
Dimensions: 4 (items) x 3 (major_axis) x 100 (minor_axis)
Items axis: A to D
Major_axis axis: df1 to df3
Minor_axis axis: 2013-01-01 00:00:00 to 2013-04-10 00:00:00

In [20]: x['E'] = new_df

In [21]: x.transpose(1,2,0)
Out[21]: 
<class 'pandas.core.panel.Panel'>
Dimensions: 3 (items) x 100 (major_axis) x 5 (minor_axis)
Items axis: df1 to df3
Major_axis axis: 2013-01-01 00:00:00 to 2013-04-10 00:00:00
Minor_axis axis: A to E 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-28T09:58:56.513

似乎该错误已修复，但您的问题使我感兴趣。

由于您可以有效地将切片添加到长轴和短轴上的面板而无需转置，因此以下 2 行可以避免在 Dataframe 的大小上挠头...

```
pf.ix[:,'another major axis',:] = pd.DataFrame(np.random.randn(pf.minor_axis.shape[0],pf.items.shape[0]), index=pf.minor_axis, columns=pf.items)

pf.ix[:, :, 'another minor axis'] = pd.DataFrame(np.random.randn(pf.major_axis.shape[0],pf.items.shape[0]), index=pf.major_axis, columns=pf.items) 
```

**但是我想知道是否有更简单的东西？**

在沿各个轴添加切片的代码下方。

```
import pandas as pd
import numpy as np

rng = pd.date_range('25/11/2014', periods=2, freq='D')
df1 = pd.DataFrame(np.random.randn(2, 5), index=rng, columns=['A', 'B', 'C', 'D', 'E'])
df2 = pd.DataFrame(np.random.randn(2, 5), index=rng, columns=['A', 'B', 'C', 'D', 'E'])
df3 = pd.DataFrame(np.random.randn(2, 5), index=rng, columns=['A', 'B', 'C', 'D', 'E'])

pf = pd.Panel({'df1': df1, 'df2': df2, 'df3': df3})

# print("slice before adding df4:\n")
# for i in pf.items:
#     print("{}:\n{}".format(i, pf[i]))

pf['df4'] = pd.DataFrame(np.random.randn(pf.major_axis.shape[0], pf.minor_axis.shape[0]), index=pf.major_axis, columns=pf.minor_axis)
print pf

# print("slice after df4 before transposing 1:\n")
# for i in pf.items:
#     print("{}:\n{}".format(i, pf[i]))

x = pf.transpose(1, 0, 2)

x['new major axis item'] = pd.DataFrame(np.random.randn(pf.items.shape[0], pf.minor_axis.shape[0]), index=pf.items,
                                        columns=pf.minor_axis)

pf = x.transpose(1, 0, 2)

print pf
# print("slice after:\n")
# for i in pf.items:
#     print("{}:\n{}".format(i, pf[i]))

print("success on adding slice on major axis:")
print pf.major_xs(key='new major axis item')
print("trying to add major axis directly")
pf.ix[:,'another major axis',:] = pd.DataFrame(np.random.randn(pf.minor_axis.shape[0],pf.items.shape[0]), index=pf.minor_axis, columns=pf.items)

print pf.major_xs(key='another major axis')
print pf 
```

# asp.net - Crystal Reports 打印选项在 asp.net 应用程序上不起作用

> ID：15364053
> 
> 赞同：0
> 
> 时间：2013-03-12T14:30:58.223
> 
> 标签：asp.net, printing, crystal-reports

只需打开一个 rpt 的简单 .NET 4.0 应用程序。我只想强制使用 Landscape 和 A4 纸，但无法正常工作。

我尝试在报告设计中从页面设置中删除打印机，但没有运气。

资源：

```
private void Page_Init(object sender, EventArgs e)
        {
            ConfigureCrystalReports();
        }
        private void ConfigureCrystalReports()
        {
            //
            ConnectionInfo myConnectionInfo = new ConnectionInfo();
            //
            ReportDocument rptDoc = new ReportDocument();
            rptDoc.Load(Server.MapPath(Properties.Settings.Default.rptPath));
            rptDoc.PrintOptions.PaperOrientation = PaperOrientation.Landscape;
            rptDoc.PrintOptions.PaperSize = PaperSize.PaperA4;
            //
            myConnectionInfo.AllowCustomConnection = true;
            myConnectionInfo.UserID = "xxxxx";
            myConnectionInfo.Password = "xxxxx";
            //
            crViewer.ReportSource = rptDoc;
            //
            SetDBLogonForReport(myConnectionInfo);
        } 
```

# scala - Scala 选项返回类型

> ID：15364059
> 
> 赞同：4
> 
> 时间：2013-03-12T14:31:18.967
> 
> 标签：scala

我是 Scala 编程世界的新手，但我很喜欢它。最近我开始将我的研究应用程序移植到 Scala 中，而我仍在苦苦挣扎的一件事是 return 关键字。例如在下面的代码中

```
def readDocument(dbobj:MongoDBObject) = Option[ContainerMetaData] 
{
  for(a <- dbobj.getAs[String]("classname");
      b <- dbobj.getAs[Long]("id"); 
      c <- dbobj.getAs[Long]("version");
      d <- dbobj.getAs[String]("description");
      e <- dbobj.getAs[String]("name");
      f <- dbobj.getAs[String]("tag");
      g <- dbobj.getAs[Int]("containertype");
      h <- dbobj.getAs[Date]("createddate")
  )
  {
      val ctype = ContainerType(g)
      val jodadt = new DateTime(h) 
      val data = new ContainerMetaData(a,b,c,d,e,f,ctype,jodadt)
      Some(data)
  }
  None
} 
```

在上面的代码中，我收到错误消息：

```
type mismatch;  found   : None.type  required: om.domain.ContainerMetaData 
```

因此，如果我删除显式返回类型，则代码可以工作，但是如果没有显式 return 关键字，我将无法在`Some(data)`.

```
def readDocument(dbobj:MongoDBObject)= 
{
  for(a <- dbobj.getAs[String]("classname");
      b <- dbobj.getAs[Long]("id"); 
      c <- dbobj.getAs[Long]("version");
      d <- dbobj.getAs[String]("description");
      e <- dbobj.getAs[String]("name");
      f <- dbobj.getAs[String]("tag");
      g <- dbobj.getAs[Int]("containertype");
      h <- dbobj.getAs[Date]("createddate")
  )
  {
      val ctype = ContainerType(g)
      val jodadt = new DateTime(h) 
      val data = new ContainerMetaData(a,b,c,d,e,f,ctype,jodadt)
      Some(data)
  }
  None
} 
```

如果添加 return 关键字，则编译器会抱怨

```
method `readDocument` has return statement; needs result tye 
```

更多附加信息，这是我正在扩展的特征

```
trait MongoDAOSerializer[T] {
    def createDocument(content:T) :  DBObject
    def readDocument(db:MongoDBObject) : Option[T]
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T14:38:53.350

问题是，您`yield`在理解中缺少关键字。并且`None`结尾也是不必要的，因为 for-comprehension 将产生`None`，如果其中一个值丢失并且`Some`不需要在理解中显式创建 a ，因为它`Option`无论如何都会创建 a 。您的代码看起来像这样（未经测试）

```
def readDocument(dbobj: MongoDBObject): Option[ContainerMetaData] = {
  for {
      a <- dbobj.getAs[String]("classname")
      b <- dbobj.getAs[Long]("id")
      c <- dbobj.getAs[Long]("version")
      d <- dbobj.getAs[String]("description")
      e <- dbobj.getAs[String]("name")
      f <- dbobj.getAs[String]("tag")
      g <- dbobj.getAs[Int]("containertype")
      h <- dbobj.getAs[Date]("createddate")
  } yield {
      val ctype = ContainerType(g)
      val jodadt = new DateTime(h) 
      new ContainerMetaData(a,b,c,d,e,f,ctype,jodadt)
  }
} 
```

# matlab - 沿屏幕移动

> ID：15364060
> 
> 赞同：-7
> 
> 时间：2013-03-12T14:31:19.357
> 
> 标签：matlab

我不太擅长 Matlab，我的实验室实验需要帮助。我需要创建一个完整尺寸的图像/gif/视频吗？（全显示器尺寸），由白色背景和一个从左向右移动的黑色小方块组成。我需要以后能够修改这个正方形的大小、位置和速度。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:42:55.447

For this sort of thing, [Psychtoolbox](http://psychtoolbox.org/HomePage) is your friend. I don't have experience with it, but it is a MATLAB toolbox perfectly designed for full screen visual stimuli.

The toolbox contains an existing example called '[moving line demo](http://docs.psychtoolbox.org/MovingLineDemo)':

```
MovingLineDemo([xv=10][, twolines=0][, screenid=max])

Shows a pair of vertical lines, or a single line, which travel
horizontally across the display from the left to the right, repeating
infinitely. 
```

See if you can edit this to suit your need; if you get stuck, come back to ask a more specific question!

# html - 是否可以从带有 CSS 的链接中隐藏标题？

> ID：15364063
> 
> 赞同：34
> 
> 时间：2013-03-12T14:31:34.497
> 
> 标签：html, css, hide, anchor, title

我有一个带有标题属性的锚元素。我想隐藏在浏览器窗口中将鼠标悬停在它上面时出现的弹出窗口。就我而言，不可能做这样的事情，

```
$("a").attr("title", ""); 
```

由于 jQuery Mobile，标题会在某些事件发生后重新出现（基本上每次重绘锚元素时）。所以我希望通过CSS隐藏标题。

就像是：

```
a[title] {
    display : none;
} 
```

不起作用，因为它隐藏了整个锚元素。我只想隐藏标题。这甚至可能吗？弹出窗口不应显示。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2016-03-07T19:50:05.537

使用以下 CSS 属性将确保在悬停时不会出现标题属性文本：

```
pointer-events: none; 
```

请记住，JS 是更好的解决方案，因为此 CSS 属性将确保元素永远不会成为任何鼠标事件的目标。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-27T04:14:12.830

根据@boltClock 的建议，我会说我不觉得CSS 解决方案在这里是合适的，因为浏览器决定如何处理链接的标题属性，或者与此相关的任何事情。据我所知，CSS 无法处理这个问题。

如前所述，使用 jQuery 将标题替换为空字符串是行不通的，因为 jQuery mobile 在某些时候会重写它们。然而，这将独立于 JQM 工作，并且不涉及完全删除对 SEO 很重要的 title 属性。

这有效：

```
$('a["title"]').on('mouseenter', function(e){
    e.preventDefault();
}); 
```

*`$('body').on('mouseenter')`我在测试后将我的初始代码更改为这个。这被证实有效。*

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-07-08T11:44:12.470

您可以将内部文本包装在一个跨度中，并为其提供一个空的标题属性。

```
<a href="" title="Something">
  <span title="">Your text</span>
</a>
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-12T15:06:31.613

在 CSS 中这是不可能的，因为您只能将内容添加到 DOM（通常使用`:before :after`and `content: '...';`，而不是删除或更改属性。

唯一的方法是创建一个实时自定义事件（es. `"change-something"`）：

`$("a").on("change-something", function(event) { this.removeAttr("title"); });`

并触发每个更改：

`... $("a").trigger("change-something");`

更多信息和演示在这里：

[http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)
[http://api.jquery.com/removeAttr/](http://api.jquery.com/removeAttr/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-10T15:11:42.990

尝试使用此更改您的代码

```
$(document).ready(function() {
    $("a").removeAttr("title");
}); 
```

这将删除标题属性，因此在链接上悬停时不会出现提示标签

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-06-11T13:32:50.967

完整的纯javascript解决方案

```
var anchors = document.querySelectorAll('a[title]');
    for (let i = anchors.length - 1; i >= 0; i--) {
    anchors[i].addEventListener('mouseenter', function(e){
        anchors[i].setAttribute('data-title', anchors[i].title);
        anchors[i].removeAttribute('title');

    });
    anchors[i].addEventListener('mouseleave', function(e){
        anchors[i].title = anchors[i].getAttribute('data-title');
        anchors[i].removeAttribute('data-title');
    });
} 
```

# c++ - 透视投影 - 如何转换坐标

> ID：15364064
> 
> 赞同：1
> 
> 时间：2013-03-12T14:31:35.533
> 
> 标签：c++, graphics, 3d, rasterizing

我正在研究透视投影，我偶然发现了这个概念： ![在此处输入图像描述](../Images/3281fdc32b14f710f1c13cd29ef30569.png)

基本上它说如果我有一个点（x，y，z），我可以通过这样做将它投影到我的透视屏幕（相机空间）中

```
x' = x/z
y' = y/z
z' = f(z-n) / z(f-n) 
```

我不明白为什么 x' = x/z 或 y' = y/z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:39:38.000

看待这一点的一种方法是，您尝试做的是与一条穿过观察者位置（假设位于原点：）`0,0,0`和您希望投影的空间点 (P) 的线相交。

因此，您采用线的方程，即`P' = P * a`，其中`a`只是一个标量值并求解`P'.Z = 1`（这是您的投影平面所在的位置）。当标量倍数为 时，这是微不足道的`1 / P.Z`，因此投影点为`(P.X, P.Y, P.Z) * (1 / P.Z)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T18:53:04.227

在几何上，这是一个相似三角形的问题。

在您的图中，因为`(x,y,x)`与 位于同一条虚线上`(x',y',z')`：

```
triangle [(0,0,0), (0,0,z), (x,y,z)]
  is similar to
triangle [(0,0,0), (0,0,z'), (x',y',z')] 
```

这意味着相应的边具有固定的比例。而且，进一步，原始向量与投影向量成比例。最后，请注意，名义投影平面位于`z' = 1`：

```
(x,y,z) / z   =  (x',y',z') / z'

  -> so, since z' = 1:
       x'/z' = x' = x/z
       y'/z' = y' = y/z 
```

* * *

[警告：请注意，`z'`我的答案与问题中的出现不同。问题`z' = f(z-n) / z(f-n)`并不直接对应于物理点：它是一个“深度值”，用于执行隐藏表面移除等操作。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-04T06:06:09.480

齐次坐标使我们能够在无穷远处表示点/线。我们将 1 添加到向量表示中。3d空间中一点的距离越远，它倾向于向光学中心移动。笛卡尔到齐次 p=(x,y)to(x,y,1) 齐次到笛卡尔 (X, Y, Z)to(X/Z, Y/Z) 例如，1\. 你在飞机上旅行并且当您向下看时，似乎点从一个瞬间移动到另一个瞬间并不快。这是距离非常大，距离=1/Disparity（两帧中同一点的漂移）。2.尝试用Infinity代入视差，表示距离为0。

# php - 在循环中使用 pdf2text 类

> ID：15364065
> 
> 赞同：2
> 
> 时间：2013-03-12T14:31:37.523
> 
> 标签：php

我正在尝试将数据从几个 pdf 提取到数据库中，并且我找到了代码，但我只能在每次输入单个文件时让它工作。

我正在使用资源 class.pdf2text.php @ [http://pastebin.com/hRviHKp1](http://pastebin.com/hRviHKp1)

使用代码：

```
*#this is outside of the loop
   include('class.pdf2text.php'); 

   #this is inside the loop
   $a = new PDF2Text();
   $a->setFilename('$userDoc'); //grab the test file at    
   $a->decodePDF();
   echo $a->output();* 
```

我遇到的问题是成功完成第一个文档后，之后的所有文档都返回此错误致命错误：Cannot redeclare class PDF2Text in class.pdf2text.php on line 4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:37:20.467

您以某种方式再次包含该课程，没有更多代码，我们无法做到。您可以代替使用`include`use `include_once`，这应该可以解决您的错误。

# c# - 如何滚动到 StackPanel 中的特定元素？

> ID：15364068
> 
> 赞同：2
> 
> 时间：2013-03-12T14:31:43.490
> 
> 标签：c#, wpf, children, visible, stackpanel

我创建了一个垂直 StackPanel 并添加了大量的子元素。每个孩子都有不同的身高。如何滚动到特定的孩子？如果一个孩子不可见，例如由于位于列表的底部，该怎么办。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:47:53.260

尝试[`StackPanel.MakeVisible(Visual visual, Rect rectangle)`](http://msdn.microsoft.com/en-us/library/system.windows.controls.stackpanel.makevisible%28v=vs.100%29.aspx)通过传入您想要的控件作为第一个参数来使用该方法，并将带有坐标的 Rect 作为第二个参数使其可见。

# qt5 - QT 5.0 QDebug 编译错误

> ID：15364070
> 
> 赞同：11
> 
> 时间：2013-03-12T14:31:50.833
> 
> 标签：qt5

我在用 QDebug 编译我的代码时遇到了麻烦，但我真的需要它。

```
#include <QCoreApplication>
#include <QtDebug>
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    QDebug() << "hello";
    return a.exec();
} 
```

这是我在这个简单测试中遇到的错误的一个例子：没有匹配的函数调用 'QDebug::QDebug()'

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-12T14:36:11.887

尝试这个：

```
qDebug() << "hello"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T14:38:46.983

这里的问题是 QDebug 没有默认构造函数。`QDebug() << "hello";`如果它确实有一个就可以了。

这些是可用的构造函数：

```
QDebug(QIODevice* device);
QDebug(QString* string);
QDebug(QtMsgType type);
// and the copy constructor of course. 
```

duDE 的答案为您提供了您正在寻找的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-01T10:47:15.303

对于 Qt 的 5.15 版，以下对我有用，

添加包含文件，

```
#include <QDebug> 
```

并使用，

```
qDebug() << "Your debug message."; 
```

# shell - 如何从 shell 脚本调用 web 服务？任何 web 服务 restfull 或 normal

> ID：15364073
> 
> 赞同：1
> 
> 时间：2013-03-12T14:31:53.510
> 
> 标签：shell, unix

如何从 shell 脚本调用 web 服务？它可以是任何 web 服务，restful 或 normal。

我可以使用`curl`, 或其他命令吗？任何示例或链接都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:36:27.300

如果您希望发布查询字符串参数，请使用 -d 选项卷曲。

[http://blogs.plexibus.com/2009/01/15/rest-esting-with-curl/](http://blogs.plexibus.com/2009/01/15/rest-esting-with-curl/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-27T00:34:14.240

通过运行命令创建文件 nano scriptName.sh
将以下代码复制并粘贴到终端中

```
#!/bin/sh

# This is a comment!

curl 'http://example.com' 
```

现在通过运行授予文件正确的权限

> chmod 755 脚本名称.sh

  可执行的

> ./scriptName.sh

测试它是否有效

使用以下示例将脚本添加到 cron 选项卡中 在终端运行 

crontab -e

将 cron 添加到 crontab 以执行脚本。

此示例显示如何在每天凌晨 4 点执行脚本

> 0 4 * * * /home/joe/scriptName.sh

# algorithm - 是否存在一种算法来找到二维数组中非相交值的最小和？

> ID：15364078
> 
> 赞同：4
> 
> 时间：2013-03-12T14:32:09.133
> 
> 标签：algorithm, matrix, levenshtein-distance

我正在寻找一种快速算法来确定给定二维数组的特定最小属性 - 没有共同行或列的最小值的总和。我确定这必须有一个名字，但我不知道它叫什么。

我有一个字符串匹配系统，它将在空格上拆分输入字符串并将其与搜索值的语料库（也拆分为空格）进行比较，并返回每个字符串中标记之间的距离矩阵，我想减少通过采用不重复使用任何输入/输出令牌组合的最小距离组合，将其变为单个聚合距离。

例子：

```
{ 1, 2 }   => 5 (either 1+4, or 3+2)
{ 3, 4 }

{ 0, 2 }   => 6 (because 2+4 < 0+8)
{ 4, 8 } 

{ 1, 0, 0 }
{ 0, 1, 0 } => 0
{ 0, 0, 1 }

{ 2, 3, 4 }
{ 3, 2, 4 } => 6 (2+2+2)
{ 4, 3, 2 } 
```

到目前为止，我一直在使用的朴素算法看起来像这样（C#）：

```
public static int Minimux(this int[,] array) {
  var xUsed = new bool[array.GetLength(0)];
  var yUsed = new bool[array.GetLength(1)];
  var xMax = array.GetLength(0);
  var yMax = array.GetLength(1);
  var minima = new List<int>();
  var limit = Math.Min(xMax, yMax);
  int xMin = 0, yMin = 0;
  while (minima.Count < limit) {
    var vMin = Int32.MaxValue;
    for (var x = 0; x < xMax; x++) {
      for (var y = 0; y < yMax; y++) {
        if (xUsed[x] || yUsed[y] || array[x, y] >= vMin) continue;
        vMin = array[x, y];
        xMin = x;
        yMin = y;
      }
    }
    xUsed[xMin] = true;
    yUsed[yMin] = true;
    minima.Add(vMin);
  }
  return (minima.Sum());
} 
```

它基本上进行数组扫描，并在找到每个最小值时，将行/列组合标记为“已使用”，因此不会再次考虑它 - 一旦列表中的最小值与最短的元素一样多数组维度，它返回这些最小值的总和。

问题是它在这样的情况下崩溃了：

```
{ 0, 0, 0 }
{ 0, 0, 0 } => 3 (when it should be returning 1)
{ 1, 2, 3 } 
```

当扫描到达最后一行时，它已经将第 0 列和第 1 列标记为“已使用”，因此第 2 行中的最小未使用值是`3`它应该实际使用`1`

是否存在用于执行此操作的标准算法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:48:05.380

是的，有一个标准算法可以完全解决这个问题。它的名字是[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)。

# css - 有没有一种简单的方法来列出带有供应商前缀的 CSS3 关键帧？

> ID：15364081
> 
> 赞同：6
> 
> 时间：2013-03-12T14:32:20.790
> 
> 标签：css, css-animations

目前我必须列出所有变体：

```
@-webkit-keyframes show {
    from { background-color: rgba(0, 0, 0, 0); }
    to { background-color: rgba(0, 0, 0, 0.8); }
}

@-moz-keyframes show {
    from { background-color: rgba(0, 0, 0, 0); }
    to { background-color: rgba(0, 0, 0, 0.8); }
}

[…] 
```

你明白了。有什么办法可以写得更短吗？像这样并没有破坏它的东西：

```
@-webkit-keyframes show, @-moz-keyframes show {} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T14:37:08.363

在 CSS 中不是原生的，但您可以通过使用`CSS`预处理器来完成此操作，例如[LESS](http://lesscss.org/)，它支持“mixins”的概念以删除一些重复。

可以在[此处](http://radiatingstar.com/css-keyframes-animations-with-less)找到更多信息，特别是文章中的示例：

```
@-webkit-keyframes some-animation {.mixi-frames;}
@-moz-keyframes some-animation {.mixi-frames;}

.mixi-frames () {
    from {width: 254px;}
    to {width: 512px;}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-04T21:36:08.793

正如已接受的答案中所述，CSS 预处理器中的 mixin 已成为解决此问题的最先进技术。

但幸运的是，时代变了，工具变得越来越好。像[Bootstrap](http://getbootstrap.com/)这样的框架切换到像[autoprefixer](https://github.com/ai/autoprefixer#browsers)这样的工具，它会自动将供应商前缀添加到你的 CSS 中。这样，您无需再考虑供应商前缀，而且您仍然可以保持最新状态。

Autoprefixer 使用来自[caniuse.com](http://caniuse.com/)的数据来保持自己的最新状态，您只需要指定要支持的浏览器，您就无需再关心了。如果您还没有切换到[Grunt](http://gruntjs.com/)任务自动化，现在是时候尝试一下了，因为也有一个可用的[grunt-autoprefixer](https://www.npmjs.org/package/grunt-autoprefixer)任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-17T09:38:13.637

根据您的要求，诸如[https://github.com/jQueryKeyframes/jQuery.Keyframes](https://github.com/jQueryKeyframes/jQuery.Keyframes)之类的库也可以通过为您管理关键帧语法来完成自动前缀。

# php - PHP if 语句，合适吗？

> ID：15364083
> 
> 赞同：2
> 
> 时间：2013-03-12T14:32:23.517
> 
> 标签：php, html, if-statement, html-table

我正在做一个小型大学任务，使用 PHP 为网站构建一个简单的电子商务引擎。

我目前有以下脚本设置来显示一个类别中的产品，所有这些都是从 MySQL 数据库中检索的。

```
http://example.com/category.php?id=2 
```

我目前遇到的问题是，对于显示的每个产品，脚本只是将每个产品并排呼应到一个新的表条目中。这导致他们跨越页面而不是垂直。

更改此代码以例如每行最多三个产品的最佳方法是什么？If循环或类似的东西？将不胜感激支持！

```
<?php

//Create Session
   session_start();

//Connect to database
   include "conn.php";

//Retrieve Header
   include "header.php";

//Get Category ID 
if (isset($_GET['id'])){
    $CategoryID = $_GET['id'];

//QUERY collects product name, and product ID.
    $q="SELECT ProductID, ProductName, Price,img FROM Products WHERE CategoryID=$CategoryID";

//QUERY collects Product Category descriptions
    $d="SELECT `Desc` FROM ProductCategories WHERE CategoryID=$CategoryID";

//retrive and execute SQL query results and save into a variable
    $result = mysqli_query($_SESSION['conn'],$q);
    $result2 = mysqli_query($_SESSION['conn'],$d) or die(mysql_error());

//Retrieve Product Category Description
    echo "<div>";
    while ($myResult = mysqli_fetch_row($result2)){ //Create an array
        echo "<p>".$myResult[0]."</p>";
    }
    echo "</div>";

//Retrieve Products in category
    echo "<div align='center'><table border='1px' bordercolor='#000000' width='200px'><tr>"; //Define table, row and div containing each product

    while ($row = mysqli_fetch_row($result)){ //Create an array

        echo "<td>"; //Create table cell
        echo "<p><img src=".$row[3]."></p>"; //product image small (250x250 Pixels)
        echo "<p  align='center'><a href='product.php?id=".$row[0]."'>".$row[1]." </a></p>"; //Product ID Link and Name
        echo "<p align='center'>&#163; ".$row[2]."</p>";
        echo "</td>"; //Close table cell
    }
    echo "</tr></table></div>";//Close table, div and row
    mysqli_free_result($result);
}

// Retireve Footer
include "footer.php";
?> 
```

对于任何类型的编程，我都是新手，因此非常感谢您给予我的耐心/任何支持。我也知道 SQL 注入问题，并将在以后解决此问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:37:55.663

好吧，您将使用计数器跟踪您的 while 迭代，然后每次点击`$counter%3 === 0`（将 3 替换为每行所需的任何内容），您将关闭`tr`并开始一个新的：

```
$counter = 0;
$perRow = 3;
while ($row = mysqli_fetch_row($result)){ //Create an array
    if($counter === 0) {
        echo '<tr>';
    } else if ($counter%$perRow === 0 ) {
        echo '</tr><tr>';
    }
    echo "<td>"; //Create table cell
    echo "<p><img src=".$row[3]."></p>"; //product image small (250x250 Pixels)
    echo "<p  align='center'><a href='product.php?id=".$row[0]."'>".$row[1]." </a></p>"; //Product ID Link and Name
    echo "<p align='center'>&#163; ".$row[2]."</p>";
    echo "</td>";
    $counter++;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:36:07.863

干得好

```
while ($row = mysqli_fetch_row($result)){ //Create an array

    echo "<tr><td>"; //Create table cell
    echo "<p><img src=".$row[3]."></p>"; //product image small (250x250 Pixels)
    echo "<p  align='center'><a href='product.php?id=".$row[0]."'>".$row[1]." </a></p>"; //Product ID Link and Name
    echo "<p align='center'>&#163; ".$row[2]."</p>";
    echo "</td></tr>"; //Close table cell
}
echo "</table></div>";//Close table, div and row 
```

TR 需要在 while 内，因为 tr 是一行

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T14:45:12.817

您可以使用表格和迭代计数器以旧方式进行操作。您还可以使用更多基于 CSS 的方法。

循环您的结果集，并构建内部 HTML 部分（行、列）

```
$rows = '';
while ($myResult = mysqli_fetch_row($result2)){ //Create an array
    $rows .= '<div class="inner">'.$myResult[0].'</div>';
} 
```

确定内列 x 的宽度，使它们向左或向右浮动，并使外部 div 宽度 * x

```
<style type="text/css">
div.box {
  width:900px;
}

div.inner {
  float:left;
  width:300px;
}
</style> 
```

最后回显您的 HTML

```
<div class="box"><?php echo $rows; ?></div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T14:42:55.317

您需要的是跟踪您所处的位置。如果你想要每行 3 列，它会是这样的：

```
$count = 1;

echo '<table>';

while ($row = mysqli_fetch_row($result)) {
  $tmp = $count % 3; //get the remainder

  if ($tmp==1) {
    if ($count!=1) {
      //not the first row so close the last one
      echo "</tr>";
    }

    //start row
    echo "<tr>";
  }

  //show your <td> info

  $count++;
}
echo '</tr></table>'; 
```

# iis-7 - 如何以内置管理员身份运行 IIS 7 应用程序池？

> ID：15364093
> 
> 赞同：2
> 
> 时间：2013-03-12T14:32:44.413
> 
> 标签：iis-7

我试图授予对应用程序池的访问权限以在网站目录（inetpub 内部）中创建一些文件，但它一直拒绝我访问，因为它说用户没有管理员权限。我将 AppPool 作为 LocalSystem 运行，但仍然失败。LocalSystem 不能完全控制文件夹吗？我将它作为 AppPoolIdentity 运行，并为这些文件夹提供了适当的权限，但它不起作用。我可以让它工作的唯一方法是给它一个自定义管理员帐户......但这会将用户名/密码保存在 web.config 中，并且该密码每 90 天过期一次。我们不能让网站每 90 天就失败一次。

有没有一种简单的方法可以让我以内置管理员的身份运行 AppPool 而无需提供一些自定义帐户？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-25T08:08:02.970

只晚了18个月。不过，我认为问题在于您的网站使用匿名连接运行，对吗？连接到您网站的匿名用户不会以管理员身份运行。这是可配置的。

以下适用于 IIS7（我认为它也适用于 IIS6，尽管我无法访问该版本；几乎可以肯定不适用于 IIS5 和更早版本）。

所以无论如何，要在 IIS 管理器中更改此设置，请转到：

> 网站 > [您的网站]

在 IIS 小节下的“功能”视图中

> 身份验证[打开功能]>匿名身份验证[鼠标右键“编辑...”]>选择：应用程序池身份[确定]

这允许匿名连接在操作系统级别的管理员权限下工作，让您可以访问文件以及更多其他内容。

要么，要么我不太明白你的问题。

# mysql - 这是有效的 SQL 条件表达式还是 MySQL 错误（功能）？

> ID：15364094
> 
> 赞同：7
> 
> 时间：2013-03-12T14:32:45.127
> 
> 标签：mysql, sql

尝试调试一些似乎返回笛卡尔积的连接，我在选择中输入了等效的 ON 条件。

在 MySQL 中

```
select * 
from table 
where columnname 
```

似乎表现得好像我输入了`where columname is not null`. 在连接中输入`on table.columnname`被接受，但返回很多行。如果我纠正它，MySQL 会做正确的事情，`on table1.column=table2.column`但我的第一个版本肯定是不正确和非法的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T16:45:42.017

您正在谈论的上下文，连接中的`WHERE`子句和`ON`子句，只需接受一个表达式。

```
SELECT ...
FROM table1 JOIN table2 ON <expr>
WHERE <expr> 
```

表达式可以包括比较运算符，`=`但表达式也可以像单个列或单个常量值一样简单。

与另一个接受表达式的上下文进行比较：选择列表。

```
SELECT <expr>, <expr>, <expr> 
```

在这种情况下，使用单列作为表达式是正常的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T16:39:01.627

大多数编程语言将除 null、0、''、false 之外的所有值视为 true。而（1）；无论您是否给出 1,2,'a',true 等等，都是一个无限循环。我会说这是默认的预期行为，我经常使用类似的 where 子句

# android - 使用回栈的奇怪的 android 片段问题

> ID：15364095
> 
> 赞同：2
> 
> 时间：2013-03-12T14:32:50.343
> 
> 标签：android, android-fragments, android-lifecycle

我对 Android 兼容性包片段有以下问题。片段的层次结构如下：

A（登录）-> B（仪表板）-> C（详细信息）

登录片段添加了功能：

```
private void addFragment(Fragment f) {
    FragmentTransaction ft = mFragmentManager.beginTransaction();
    ft.replace(R.id.main_content, f);
    ft.commit();
} 
```

成功登录后，仪表板以相同的方式添加，无需将事务添加到后台堆栈。C片段添加如下：

```
FragmentTransaction ft = getFragmentManager().beginTransaction();
ft.replace(R.id.main_content, f, id);
ft.addToBackStack(null);
ft.commit(); 
```

所以基本上在详细信息屏幕上我有注销按钮，它应该让我登录 A 并从 backstack 中删除所有片段。根据android开发者文档：

> 然而，如果您在删除片段时确实调用了 addToBackStack()，那么片段将停止，并且如果用户导航回来，它将恢复。

但这不是我的问题。在 C 片段中按下注销时：

```
getFragmentManager.popBackStackImmediate(); 
FragmentTransaction ft = mFragmentManager.beginTransaction();
ft.replace(R.id.main_content, new LoginFragment());
ft.commit(); 
```

B片段的onActivityCreated（），onStart（）也被调用（而不是文档中编写的onResume），使我的代码崩溃，因为在这个片段中我开始了一些线程操作，并且在添加登录片段后我得到了IllegalStateException片段B没有附加到一个活动（当线程操作结束时，它会更新片段 UI）有谁知道替换是如何真正起作用的以及如何克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T11:19:46.380

我想您应该为添加的每个片段调用 addToBackStack，并为它们赋予不同的名称。在我看来，阅读您的代码似乎您不这样做。

# function - 在 jQuery 中单击后删除 CS

> ID：15364100
> 
> 赞同：3
> 
> 时间：2013-03-12T14:33:03.123
> 
> 标签：function, jquery

我有这个结构：

```
$('.user_adr_edit div a').click(function(){
$(this).css('width', '210px');
}); 
```

它正在工作。但我想，当再次点击时，删除`width:210px`

必须使用`unbind`，`remove`还是其他解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:36:11.030

您应该使用 css 规则来更改 css 属性

**CSS**

```
a.wide{
   width:210px;
} 
```

只需添加/删除类

```
$('.user_adr_edit div a').click(function(){
    $(this).toggleClass('wide');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:36:03.443

```
$('.user_adr_edit div a').click(function(){
   if($(this).css('width') != '210px'){
      $(this).css({'width':'210px'});
   }
   else{
      $(this).css({'width':'0px'});
   }
}); 
```

# python - 安装 distutils 包时如何使用 mingw32？

> ID：15364106
> 
> 赞同：4
> 
> 时间：2013-03-12T14:33:17.503
> 
> 标签：python, git, bash, distutils, git-bash

我遇到了[一个 github 项目](https://github.com/andrewschoen/django-cms-demo)，我正在尝试安装和运行它，但我遇到了一些问题。我也把它[作为一个问题](https://github.com/andrewschoen/django-cms-demo/issues/2)提出来。整个 pip 日志在那里可用。

如果我理解正确的话，这个问题似乎围绕着 distutils：

> f:\python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution option: 'use_2to3' warnings.warn(msg) error: Unable to find vcvarsall.bat

查找这个我被引导到[错误： Unable to find vcvarsall.bat](https://stackoverflow.com/questions/2817869/error-unable-to-find-vcvarsall-bat/10558328#10558328)。

现在检查我的系统，我安装了 MS Visual C++ 2005,2008,2010。我没有 Visual Studio。我正在使用带有安装了 MINGW32 的 git-bash 的 win 7。在上面的线程 fpessoa 中讨论了`setup.py install build --compiler=mingw32`. 我决定尝试以下方法：

1.  我已经安装了 python 2.7。
2.  将 mingw32 的 bin 目录添加到环境变量：将**PATH**附加到`f:\git\bin;`
3.  创建**distutils.cfg**位于`C:\Python27\Lib\distutils\distutils.cfg`：

    ```
    [build]
    compiler=mingw32 
    ```

不幸的是，我仍然遇到同样的错误。

这和执行是一样的`setup.py install build --compiler=mingw32`吗？如果不是，我如何让 setup.py 在读取 requirements.txt 时使用 --compiler=mingw32 参数？

我的 f:\git\bin 的内容是：

```
drwxr-xr-x   19 bsmith     Administ        0 Nov 23 10:33 ..
-rwxr-xr-x    1 bsmith     Administ   215040 Oct 23 03:26 antiword.exe
-rwxr-xr-x    1 bsmith     Administ      540 Jun 27  2012 astextplain
-rwxr-xr-x    1 bsmith     Administ      170 Jun 27  2012 awk
-rwxr-xr-x    1 bsmith     Administ    18432 Oct 23 03:26 basename.exe
-rwxr-xr-x    1 bsmith     Administ   540672 Oct 23 03:26 bash.exe
-rwxr-xr-x    1 bsmith     Administ  1299968 Oct 23 03:26 bison.exe
-rwxr-xr-x    1 bsmith     Administ      188 Jun 27  2012 bunzip2
-rwxr-xr-x    1 bsmith     Administ    75264 Oct 23 03:26 bzip2.exe
-rwxr-xr-x    1 bsmith     Administ     3802 Jun 27  2012 c_rehash
-rwxr-xr-x    1 bsmith     Administ    22528 Oct 23 03:26 cat.exe
-rwxr-xr-x    1 bsmith     Administ    28160 Oct 23 03:26 chmod.exe
-rwxr-xr-x    1 bsmith     Administ      103 Jun 27  2012 clear
-rwxr-xr-x    1 bsmith     Administ    11264 Oct 23 03:26 cmp.exe
-rwxr-xr-x    1 bsmith     Administ    52224 Oct 23 03:26 connect.exe
-rwxr-xr-x    1 bsmith     Administ    74240 Oct 23 03:26 cp.exe
-rw-r--r--    1 bsmith     Administ   227107 Jul 10  2012 curl-ca-bundle.
-rwxr-xr-x    1 bsmith     Administ   404992 Oct 23 03:26 curl.exe
-rwxr-xr-x    1 bsmith     Administ    24064 Oct 23 03:26 cut.exe
-rwxr-xr-x    1 bsmith     Administ    47616 Oct 23 03:26 date.exe
-rwxr-xr-x    1 bsmith     Administ    68608 Oct 23 03:26 diff.exe
-rwxr-xr-x    1 bsmith     Administ    17920 Oct 23 03:26 dirname.exe
-rwxr-xr-x    1 bsmith     Administ    11763 Jun 27  2012 docx2txt
-rwxr-xr-x    1 bsmith     Administ    15872 Oct 23 03:26 dos2unix.exe
-rwxr-xr-x    1 bsmith     Administ    65536 Oct 23 03:26 du.exe
-rwxr-xr-x    1 bsmith     Administ      171 Jun 27  2012 echo
-rwxr-xr-x    1 bsmith     Administ      175 Jun 27  2012 egrep
-rwxr-xr-x    1 bsmith     Administ    18944 Oct 23 03:26 env.exe
-rwxr-xr-x    1 bsmith     Administ    49152 Oct 23 03:26 expr.exe
-rwxr-xr-x    1 bsmith     Administ    12288 Oct 23 03:26 false.exe
-rwxr-xr-x    1 bsmith     Administ    52224 Oct 23 03:26 find.exe
-rwxr-xr-x    1 bsmith     Administ  1330176 Oct 23 03:26 flex.exe
-rwxr-xr-x    1 bsmith     Administ   149504 Oct 23 03:26 gawk.exe
-rwxr-xr-x    1 bsmith     Administ     5632 Oct 23 03:26 getcp.exe
-rwxr-xr-x    1 bsmith     Administ  1363968 Oct 23 03:26 git-receive-pac
-rwxr-xr-x    1 bsmith     Administ  1363968 Oct 23 03:26 git-upload-arch
-rwxr-xr-x    1 bsmith     Administ   654848 Oct 23 03:26 git-upload-pack
-rwxr-xr-x    1 bsmith     Administ  1363968 Oct 23 03:26 git.exe
-rwxr-xr-x    1 bsmith     Administ   330727 Oct 22 17:01 gitk
-rwxr-xr-x    1 bsmith     Administ     3374 Feb 28  2009 gpg-zip
-rwxr-xr-x    1 bsmith     Administ   486448 Feb 28  2009 gpg.exe
-rwxr-xr-x    1 bsmith     Administ    64309 Feb 28  2009 gpgsplit.exe
-rwxr-xr-x    1 bsmith     Administ   217749 Feb 28  2009 gpgv.exe
-rwxr-xr-x    1 bsmith     Administ    81408 Oct 23 03:26 grep.exe
-rwxr-xr-x    1 bsmith     Administ    50688 Oct 23 03:26 gunzip.exe
-rwxr-xr-x    1 bsmith     Administ    50688 Oct 23 03:26 gzip.exe
-rwxr-xr-x    1 bsmith     Administ    26624 Oct 23 03:26 head.exe
-rwxr-xr-x    1 bsmith     Administ    21504 Oct 23 03:26 id.exe
-rwxr-xr-x    1 bsmith     Administ    10240 Oct 23 03:26 kill.exe
-rwxr-xr-x    1 bsmith     Administ   112128 Oct 23 03:26 less.exe
-rwxr-xr-x    1 bsmith     Administ   812063 Jun 27  2012 libW11.dll
-rwxr-xr-x    1 bsmith     Administ   200015 Jun 27  2012 libapr-0-0.dll
-rwxr-xr-x    1 bsmith     Administ   146280 Jun 27  2012 libaprutil-0-0.
-rwxr-xr-x    1 bsmith     Administ  1723196 Jun  6  2012 libcrypto.dll
-rwxr-xr-x    1 bsmith     Administ   411907 Jan 12  2012 libcurl-4.dll
-rwxr-xr-x    1 bsmith     Administ   184599 Jun 27  2012 libexpat-0.dll
-rw-r--r--    1 bsmith     Administ     7465 Jan 12  2012 libgsasl-7.def
-rwxr-xr-x    1 bsmith     Administ   443550 Jan 12  2012 libgsasl-7.dll
-rwxr-xr-x    1 bsmith     Administ  1241889 May 31  2012 libiconv-2.dll
-rwxr-xr-x    1 bsmith     Administ   978432 Feb 28  2009 libiconv2.dll
-rwxr-xr-x    1 bsmith     Administ   177216 Jun 27  2012 libneon-25.dll
-rwxr-xr-x    1 bsmith     Administ  4884531 Jan 12  2012 libpoppler-7.dl
-rwxr-xr-x    1 bsmith     Administ   378238 Jun  6  2012 libssl.dll
-rwxr-xr-x    1 bsmith     Administ   255849 Jun 27  2012 libsvn_client-1
-rwxr-xr-x    1 bsmith     Administ    77401 Jun 27  2012 libsvn_delta-1-
-rwxr-xr-x    1 bsmith     Administ    57948 Jun 27  2012 libsvn_diff-1-0
-rwxr-xr-x    1 bsmith     Administ    49557 Jun 27  2012 libsvn_fs-1-0.d
-rwxr-xr-x    1 bsmith     Administ   172387 Jun 27  2012 libsvn_fs_fs-1-
-rwxr-xr-x    1 bsmith     Administ    37342 Jun 27  2012 libsvn_ra-1-0.d
-rwxr-xr-x    1 bsmith     Administ   181083 Jun 27  2012 libsvn_ra_dav-1
-rwxr-xr-x    1 bsmith     Administ    62039 Jun 27  2012 libsvn_ra_local
-rwxr-xr-x    1 bsmith     Administ   123176 Jun 27  2012 libsvn_ra_svn-1
-rwxr-xr-x    1 bsmith     Administ   202003 Jun 27  2012 libsvn_repos-1-
-rwxr-xr-x    1 bsmith     Administ   266235 Jun 27  2012 libsvn_subr-1-0
-rwxr-xr-x    1 bsmith     Administ    73712 Jun 27  2012 libsvn_swig_per

-rwxr-xr-x    1 bsmith     Administ   284454 Jun 27  2012 libsvn_wc-1-0.d
-rwxr-xr-x    1 bsmith     Administ   194947 Jun 27  2012 libz.dll
-rwxr-xr-x    1 bsmith     Administ    72704 Oct 23 03:26 ln.exe
-rwxr-xr-x    1 bsmith     Administ    69632 Oct 23 03:26 ls.exe
-rwxr-xr-x    1 bsmith     Administ   200192 Oct 23 03:26 m4.exe
-rwxr-xr-x    1 bsmith     Administ    27648 Oct 23 03:26 md5sum.exe
-rwxr-xr-x    1 bsmith     Administ    28672 Oct 23 03:26 mkdir.exe
-rwxr-xr-x    1 bsmith     Administ   108544 Oct 23 03:26 msmtp.exe
-rwxr-xr-x    1 bsmith     Administ   743240 Feb 10  2012 msys-1.0.dll
-rwxr-xr-x    1 bsmith     Administ  1325053 Jun 27  2012 msys-crypto-0.9
-rwxr-xr-x    1 bsmith     Administ    19968 Jun 27  2012 msys-minires.dl
-rwxr-xr-x    1 bsmith     Administ   939520 Jun 27  2012 msys-perl5_8.dl
-rwxr-xr-x    1 bsmith     Administ    82852 Jun 27  2012 msys-regex-1.dl
-rwxr-xr-x    1 bsmith     Administ   317994 Jun 27  2012 msys-ssl-0.9.8.
-rwxr-xr-x    1 bsmith     Administ    91792 Jun 27  2012 msys-z.dll
-rwxr-xr-x    1 bsmith     Administ    52064 Jun 27  2012 msysltdl-3.dll
-rwxr-xr-x    1 bsmith     Administ    81408 Oct 23 03:26 mv.exe
-rwxr-xr-x    1 bsmith     Administ   353280 Oct 23 03:26 openssl.exe
-rwxr-xr-x    1 bsmith     Administ    57344 Oct 23 03:26 patch.exe
-rw-r--r--    1 bsmith     Administ      570 Feb 28  2009 patch.exe.manif
-rwxr-xr-x    1 bsmith     Administ    28160 Oct 23 03:26 pdfinfo.exe
-rwxr-xr-x    1 bsmith     Administ    29184 Oct 23 03:26 pdftotext.exe
-rwxr-xr-x    1 bsmith     Administ     7168 Oct 23 03:26 perl.exe
-rwxr-xr-x    1 bsmith     Administ      175 Jun 27  2012 printf
-rwxr-xr-x    1 bsmith     Administ    10240 Oct 23 03:26 ps.exe
-rwxr-xr-x    1 bsmith     Administ    65124 Jun 27  2012 pthreadGC2.dll
-rwxr-xr-x    1 bsmith     Administ      169 Jun 27  2012 pwd
-rwxr-xr-x    1 bsmith     Administ   303616 Oct 23 03:26 rebase.exe
-rwxr-xr-x    1 bsmith     Administ     2137 Jun 27  2012 recodetree
-rwxr-xr-x    1 bsmith     Administ    62464 Oct 23 03:26 rm.exe
-rwxr-xr-x    1 bsmith     Administ    22528 Oct 23 03:26 rmdir.exe
-rwxr-xr-x    1 bsmith     Administ   102400 Oct 23 03:26 rxvt.exe
-rwxr-xr-x    1 bsmith     Administ    43008 Oct 23 03:26 scp.exe
-rwxr-xr-x    1 bsmith     Administ  1146880 Oct 23 03:26 sed.exe
-rwxr-xr-x    1 bsmith     Administ   540672 Oct 23 03:26 sh.exe
-rwxr-xr-x    1 bsmith     Administ    18432 Oct 23 03:26 sleep.exe
-rwxr-xr-x    1 bsmith     Administ    39936 Oct 23 03:26 sort.exe
-rwxr-xr-x    1 bsmith     Administ    23552 Oct 23 03:26 split.exe
-rwxr-xr-x    1 bsmith     Administ    81920 Oct 23 03:26 ssh-add.exe
-rwxr-xr-x    1 bsmith     Administ    69632 Oct 23 03:26 ssh-agent.exe
-rwxr-xr-x    1 bsmith     Administ   109056 Oct 23 03:26 ssh-keygen.exe
-rwxr-xr-x    1 bsmith     Administ   144384 Oct 23 03:26 ssh-keyscan.exe
-rwxr-xr-x    1 bsmith     Administ   256000 Oct 23 03:26 ssh.exe
-rwxr-xr-x    1 bsmith     Administ      192 Jun 27  2012 start
-rwxr-xr-x    1 bsmith     Administ    35840 Oct 23 03:26 tail.exe
-rwxr-xr-x    1 bsmith     Administ  1353728 Oct 23 03:26 tar.exe
-rwxr-xr-x    1 bsmith     Administ   843776 Jan 12  2012 tcl85.dll
-rwxr-xr-x    1 bsmith     Administ    16384 Jan 12  2012 tclpip85.dll
-rwxr-xr-x    1 bsmith     Administ     7680 Oct 23 03:26 tclsh.exe
-rwxr-xr-x    1 bsmith     Administ     7680 Oct 23 03:26 tclsh85.exe
-rwxr-xr-x    1 bsmith     Administ    19456 Oct 23 03:26 tee.exe
-rwxr-xr-x    1 bsmith     Administ  1011712 Jan 12  2012 tk85.dll
-rwxr-xr-x    1 bsmith     Administ    38400 Oct 23 03:26 touch.exe
-rwxr-xr-x    1 bsmith     Administ    33280 Oct 23 03:26 tr.exe
-rwxr-xr-x    1 bsmith     Administ    12288 Oct 23 03:26 true.exe
-rwxr-xr-x    1 bsmith     Administ    18944 Oct 23 03:26 uname.exe
-rwxr-xr-x    1 bsmith     Administ    24576 Oct 23 03:26 uniq.exe
-rwxr-xr-x    1 bsmith     Administ   159232 Oct 23 03:26 unzip.exe
-rwxr-xr-x    1 bsmith     Administ       45 Jun 27  2012 vi
-rwxr-xr-x    1 bsmith     Administ       45 Jun 27  2012 vim
-rwxr-xr-x    1 bsmith     Administ    32256 Oct 23 03:26 wc.exe
-rwxr-xr-x    1 bsmith     Administ      173 Jun 27  2012 which
-rwxr-xr-x    1 bsmith     Administ    10240 Oct 23 03:26 wish.exe
-rwxr-xr-x    1 bsmith     Administ    10240 Oct 23 03:26 wish85.exe
-rwxr-xr-x    1 bsmith     Administ    12288 Oct 23 03:26 xargs.exe 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T18:03:25.037

您似乎在此项目中使用 Python 2.7，但您的错误消息：

UserWarning：未知的分发选项：'use_2to3' warnings.warn(msg) 错误：无法找到 vcvarsall.bat

指将 Python 2.x 转换为 Python 3.x 语法的 2to3 实用程序。

[http://docs.python.org/2/library/2to3.html](http://docs.python.org/2/library/2to3.html)

您确定您正在使用适合您的操作系统的所有 Python 2.7 库吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T03:38:28.320

我在网上找到了一个解决方案，但没有对其进行测试：安装 MinGW 。在 MinGW 的 bin 字典中**找到 mingw32-make.exe，将其复制并重命名为 make.exe** 其他过程与您的问题相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T16:59:50.377

我最终能够使用[https://zignar.net/2012/06/17/install-python-on-windows/](https://zignar.net/2012/06/17/install-python-on-windows/)找到答案。

谢谢你的帮助。事实证明，我现在明白 GIT-BASH 不包含 ming32w 包含的编译器。

问候，

账单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T08:46:37.733

我有同样的错误；该帖子中解释的解决方案不起作用。
我的解决方案是安装[cygwin](http://www.cygwin.com/)并将其 python 用作我的 windows 的默认 python。

注意：cygwin 上 python 的默认版本是 2.6

# java - java, "如果通过就这样做"

> ID：15364108
> 
> 赞同：-5
> 
> 时间：2013-03-12T14:33:23.517
> 
> 标签：java, netbeans

作为初学者，请多多包涵，

代码是摘录：

```
'CalcCost calculate = new CalcCost();  '
 String key = stockNofive.getText(); 
 String quantityTxt = quantityfive.getText();
 int QuantityInt = Integer.parseInt(quantityTxt);            
 calculate.String(key, quantityTxt); // sending key and quantity to another class for user input check
 calculate.Jlabel(stockJLBfive, quantityJLBfive); // sending jlabel for colour change if any error found

error.Colour();// recieve error value if any, if there is  do not carry on,

//if error passes then do the following
        calculate.setKey(key);
        calculate.setQuantity(QuantityInt);
        double cost = calculate.calculateBill();
        information.append("\n\nTotal cost: £" + pounds.format(cost));
        ............
        ........ 
```

这是错误检查类

```
try {
        if (key.equals("")) {
            StockJLb.setText("<html><span style=\"color: red;\">Enter stock number</span></html>");
            JOptionPane.showMessageDialog(null, "One or more fields missing");
            return StockJLb;

        }
        if (QuantityStr.equals("")) {
            QuantityJLb.setText("<html><span style=\"color: red;\">Enter quantity</span></html>");
            JOptionPane.showMessageDialog(null, "One or more fields blank");
            return QuantityJLb;
        }

    } catch (NumberFormatException nfe) {
        QuantityJLb.setText("<html><span style=\"color: red;\">Enter quantity</span></html>");
        JOptionPane.showMessageDialog(null, "'" + QuantityStr + "' is not a number");
       error= true;
        return QuantityJLb;
    } 
```

如果需要更多代码或其他任何东西，请回复，现在已经被困了 2 周。对不起，如果仍然不清楚我在代码中添加注释以提供帮助，我想要编码的是如果有错误不进行计算，如果没有并且它通过错误检查进行计算，我尝试了 if statments，并尝试添加 boolean ，但仍然无法弄清楚，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:37:25.877

`error.Colour();// return the error value`

（然后将其保存到变量中或在 if 条件下使用它！）

```
if (error.Colour() == valueOfError) {
            calculate.setKey(key);
            calculate.setQuantity(QuantityInt);
            double cost = calculate.calculateBill();
            information.append("\n\nTotal cost: £" + pounds.format(cost));
            ............
            ........
} else {
//It is success
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:37:41.373

你不是在寻找一个`if`声明是吗？

```
if(error.Colour() == /*insert value to check here*/)
{
    calculate.setKey(key);
    calculate.setQuantity(QuantityInt);
    double cost = calculate.calculateBill();
    information.append("\n\nTotal cost: £" + pounds.format(cost));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T14:44:35.977

由于它只是代码的一小部分，因此很难获得整个图片，但是无论我理解什么，您都想`calculate.setKey(key);`根据条件执行之后的行。我对么？

您始终可以将 的值存储`error.Colour()`到某个变量中，即不确定它返回什么，我假设它是字符串类型。

`String colourErrorValue = error.Colour();// return the error value`

然后您可以检查该值以确保它没有任何错误。IE

```
//if error passes then do the following
if(colourErrorValue.equals("NO ERROR VALUE") { // I don't know what is no error scenario in                              
                                             //your case but just assuming the string
        calculate.setKey(key);
        calculate.setQuantity(QuantityInt);
        double cost = calculate.calculateBill();
        information.append("\n\nTotal cost: £" + pounds.format(cost));
        ............
        ........
} 
```

如果该`error.Colour()`方法抛出异常或错误，那么您只需将代码包装在 try 和 catch 周围。

希望这可以帮助。

# c# - DataGridView 优化

> ID：15364111
> 
> 赞同：2
> 
> 时间：2013-03-12T14:33:27.880
> 
> 标签：c#, caching, optimization, datagridview

我正在尝试优化我的速度过慢的 DataGridView，它使用 SQLite 数据库来使用虚拟模式和缓存获取数据，我已经使用了双缓冲的技巧并删除了列和行的自动调整大小。然而，尽管阅读了这个：http: [//msdn.microsoft.com/en-us/library/ha5xt0d9.aspx](http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx) 和那个：http: [//msdn.microsoft.com/en-us/library/ha5xt0d9.aspx](http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx)

我的网格非常慢，实际上对数据库的查询非常快，但似乎 DataGridView 的绘制速度非常慢，即使数据已经通过缓存加载...

但也许我的 Cache 类不是*那么*好，所以我想知道我是否做错了什么。原理很简单，一个Cache分为3个部分：Upper、Current（也可以称为“Middle”和Lower），每个部分由索引（start & end）分隔，如果已经加载了数据，Cache会给出根据那些非常简单的规则的值：

*   如果值在当前部分没问题，只需加载数据
*   如果需要的值是在上还是下，没有问题，这部分成为当前部分，只需要一个新部分。

IE

上部分：0 - 100 当前部分：101 - 201 下部分：202 - 302

需要的值在 Lower Part 之内，没有问题，Current 变为 Lower，Upper 变为 Current，只需要重新加载新的 Lower Part。显然，如果需要的值具有缓存不可用的行索引，则重新加载该值。

```
public class Cache
{
    private Dictionary<PagePart, Page> _pages;
    public Dictionary<PagePart, Page> Pages
    {
        get { return this._pages; }
        set { this._pages = value; }
    }

    private String _tableName;
    public String TableName
    {
        get { return this._tableName; }
        set { this._tableName = value; }
    }

    private SQLiteConnection _connection;
    public SQLiteConnection Connection
    {
        get { return this._connection; }
        set { this._connection = value; }
    }

    public Cache(String tableName, SQLiteConnection connection)
    {
        this.Connection = connection;
        this.TableName = tableName;

        this.Pages = new Dictionary<PagePart, Page>(PageNumber);

        IndexRange indexRangeUpper = new IndexRange(0, PageSize);
        IndexRange indexRangeCurrent = new IndexRange(PageSize + 1, 2 * PageSize);
        IndexRange indexRangeLower = new IndexRange(2 * PageSize + 1, 3 * PageSize);

        DataTable dataTableUpper = this.GetDataTableFromTable(indexRangeUpper);
        DataTable dataTableCurrent = this.GetDataTableFromTable(indexRangeCurrent);
        DataTable dataTableLower = this.GetDataTableFromTable(indexRangeLower);

        Page pageUpper = new Page(indexRangeUpper, dataTableUpper);
        Page pageCurrent = new Page(indexRangeCurrent, dataTableCurrent);
        Page pageLower = new Page(indexRangeLower, dataTableLower);

        Pages.Add(PagePart.Upper, pageUpper);
        Pages.Add(PagePart.Current, pageCurrent);
        Pages.Add(PagePart.Lower, pageLower);
    }

    private IndexRange GetTableIndexRange()
    {
        String commandText = String.Format("SELECT MAX(RowId) FROM {0}", this.TableName);
        SQLiteCommand command = new SQLiteCommand(commandText, this.Connection);

        this.Connection.Open();
        command.CommandText = commandText;
        String maxRowIdString = command.ExecuteScalar().ToString();
        this.Connection.Close();

        Int32 maxRowId = Int32.Parse(maxRowIdString);

        return new IndexRange(0, maxRowId);
    }

    public Object GetCellValue(Int32 rowIndex, Int32 columnIndex)
    {
        Int32 indexLowerStart = Pages[PagePart.Lower].Range.StartIndex;
        Int32 indexLowerEnd = Pages[PagePart.Lower].Range.EndIndex;

        Int32 indexCurrentStart = Pages[PagePart.Current].Range.StartIndex;
        Int32 indexCurrentEnd = Pages[PagePart.Current].Range.EndIndex;

        Int32 indexUpperStart = Pages[PagePart.Upper].Range.StartIndex;
        Int32 indexUpperEnd = Pages[PagePart.Upper].Range.EndIndex;

        IndexRange indexRangeTable = this.GetTableIndexRange();
        Int32 indexTableStart = indexRangeTable.StartIndex;
        Int32 indexTableEnd = indexRangeTable.EndIndex;

        // Using the cache...
        if ((indexUpperStart <= rowIndex) && (rowIndex <= indexLowerEnd))
        {
            if ((indexLowerStart <= rowIndex) && (rowIndex <= indexLowerEnd))
            {
                if (indexTableEnd > indexLowerEnd)
                {
                    this.Pages[PagePart.Upper] = this.Pages[PagePart.Current];
                    this.Pages[PagePart.Current] = this.Pages[PagePart.Lower];

                    IndexRange indexRangeLower = new IndexRange(this.Pages[PagePart.Current].Range.EndIndex + 1, this.Pages[PagePart.Current].Range.EndIndex + PageSize);
                    DataTable dataTableLower = this.GetDataTableFromTable(indexRangeLower);

                    Page pageLower = new Page(indexRangeLower, dataTableLower);

                    this.Pages[PagePart.Lower] = pageLower;

                    Int32 pageSize = this.Pages[PagePart.Current].Data.Rows.Count;
                    return this.Pages[PagePart.Current].Data.Rows[rowIndex % pageSize][columnIndex];
                }
                else
                {
                    Int32 pageSize = this.Pages[PagePart.Lower].Data.Rows.Count;
                    return this.Pages[PagePart.Lower].Data.Rows[rowIndex % pageSize][columnIndex];
                }
            }

            if ((indexCurrentStart <= rowIndex) && (rowIndex <= indexCurrentEnd))
            {
                Int32 pageSize = this.Pages[PagePart.Current].Data.Rows.Count;
                return this.Pages[PagePart.Current].Data.Rows[rowIndex % pageSize][columnIndex];
            }

            if ((indexUpperStart <= rowIndex) && (rowIndex <= indexUpperEnd))
            {
                if (indexTableStart < indexUpperStart)
                {
                    this.Pages[PagePart.Lower] = this.Pages[PagePart.Current];
                    this.Pages[PagePart.Current] = this.Pages[PagePart.Upper];

                    IndexRange indexRangeUpper = new IndexRange(this.Pages[PagePart.Current].Range.StartIndex - 1, this.Pages[PagePart.Current].Range.EndIndex - PageSize);
                    DataTable dataTableUpper = this.GetDataTableFromTable(indexRangeUpper);

                    Page pageUpper = new Page(indexRangeUpper, dataTableUpper);

                    this.Pages[PagePart.Upper] = pageUpper;

                    Int32 pageSize = this.Pages[PagePart.Current].Data.Rows.Count;
                    return this.Pages[PagePart.Current].Data.Rows[rowIndex % pageSize][columnIndex];
                }
                else
                {
                    Int32 pageSize = this.Pages[PagePart.Upper].Data.Rows.Count;
                    return this.Pages[PagePart.Upper].Data.Rows[rowIndex % pageSize][columnIndex];
                }
            }

            return null;
        }
        // Need to reload the cache...
        else
        {
            IndexRange indexRangeCurrent = new IndexRange(rowIndex - (PageSize / 2), rowIndex + (PageSize / 2));
            IndexRange indexRangeLower = new IndexRange(indexRangeCurrent.EndIndex + 1, indexRangeCurrent.EndIndex + PageSize);
            IndexRange indexRangeUpper = new IndexRange(indexRangeCurrent.StartIndex - 1, indexRangeCurrent.StartIndex - PageSize );

            DataTable dataTableUpper = this.GetDataTableFromTable(indexRangeUpper);
            DataTable dataTableCurrent = this.GetDataTableFromTable(indexRangeCurrent);
            DataTable dataTableLower = this.GetDataTableFromTable(indexRangeLower);

            Page pageUpper = new Page(indexRangeUpper, dataTableUpper);
            Page pageCurrent = new Page(indexRangeCurrent, dataTableCurrent);
            Page pageLower = new Page(indexRangeLower, dataTableLower);

            Pages[PagePart.Upper] = pageUpper;
            Pages[PagePart.Current] = pageCurrent;
            Pages[PagePart.Lower] = pageLower;

            Int32 pageSize = this.Pages[PagePart.Current].Data.Rows.Count;
            return this.Pages[PagePart.Current].Data.Rows[rowIndex % pageSize][columnIndex];
        }
    }

    private DataTable GetDataTableFromTable(IndexRange indexRange)
    {
        if (this.Connection != null)
        {
            String commandText = String.Format("SELECT * FROM {0} WHERE RowId BETWEEN {1} AND {2}", this.TableName, indexRange.StartIndex, indexRange.EndIndex);
            SQLiteCommand command = new SQLiteCommand(commandText, this.Connection);
            SQLiteDataAdapter dataAdapter = new SQLiteDataAdapter(command);

            DataTable dataTable = new DataTable(this.TableName, this.TableName);
            dataAdapter.Fill(dataTable);

            return dataTable;
        }
        else
        {
            return null;
        }
    }

    private const Int32 PageNumber = 3;
    private const Int32 PageSize = 128;

    public class Page
    {
        public Page(IndexRange range, DataTable data)
        {
            this.Range = range;
            this.Data = data;
        }

        private IndexRange _range;
        public IndexRange Range
        {
            get { return this._range; }
            set { this._range = value; }
        }

        private DataTable _data;
        public DataTable Data
        {
            get { return this._data; }
            set { this._data = value; }
        }
    }
    public enum PagePart
    {
        Upper,
        Current,
        Lower,
    }

    public class IndexRange
    {
        private Int32 _startIndex;
        public Int32 StartIndex
        {
            get { return this._startIndex; }
            set { this._startIndex = value; }
        }

        private Int32 _endIndex;
        public Int32 EndIndex
        {
            get { return this._endIndex; }
            set { this._endIndex = value; }
        }

        public IndexRange(Int32 startIndex, Int32 stopIndex)
        {
            this.StartIndex = startIndex;
            this.EndIndex = stopIndex;
        }
    }
} 
```

但是哎呀……画得太慢了……我该怎么办……？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T10:10:47.630

这是回答我自己的问题的一种方法，我只是使用主键来避免对向上或向下滚动的偏移量产生任何混淆（是的，懒惰的方式，所以它不是那种......高效但仍然不仅仅是没有缓存非常容易使用[即不使用 3 个缓存，但最终它只提供了一个用于正确完成工作的缓存]）：

```
public class Cache
{
    protected SQLiteConnection Connection { get; set; }
    protected String TableName { get; set; }
    protected const Int32 PageSize = 512;

    protected CachePage PageCurrent { get; set; }
    protected IndexRange IndexRangeTable { get; set; }

    public Cache(SQLiteConnection connection, String tableName)
    {
        SQLiteConnection.ClearAllPools();

        this.Connection = connection;
        this.TableName = tableName;

        IndexRange indexRangeCurrent = new IndexRange(0, PageSize - 1);
        DataTable dataTableCurrent = this.GetDataTableFromTable(indexRangeCurrent);

        this.PageCurrent = new CachePage(indexRangeCurrent, dataTableCurrent);
    }

    public Object GetCellValue(Int32 rowIndex, Int32 columnIndex)
    {
        DataRow dataRowFound = this.PageCurrent.Data.Rows.Find(rowIndex);

        if (dataRowFound != null)
        {
            return dataRowFound[columnIndex];
        }
        else
        {
            this.ShiftPageToIndex(rowIndex);

            return GetCellValue(rowIndex, columnIndex);
        }
    }

    private void ShiftPageToIndex(Int32 index)
    {
        this.PageCurrent.Range.Start = index;
        this.PageCurrent.Range.Stop = index + PageSize;
        this.PageCurrent.Data = this.GetDataTableFromTable(this.PageCurrent.Range);

        this.PageCurrent.Range.Start = index;
        this.PageCurrent.Range.Stop = index + this.PageCurrent.Data.Rows.Count;
    }

    private IndexRange GetTableIndexRange()
    {
        String commandText = String.Format("SELECT MAX(RowId) FROM {0}", this.TableName);
        SQLiteCommand command = new SQLiteCommand(commandText, this.Connection);

        this.Connection.Open();
        command.CommandText = commandText;
        String maxRowIdString = command.ExecuteScalar().ToString();
        this.Connection.Close();

        Int32 maxRowId = Int32.Parse(maxRowIdString);

        return new IndexRange(0, maxRowId);
    }
    private DataTable GetDataTableFromTable(IndexRange indexRange)
    {
        if (this.Connection != null)
        {
            String commandText = String.Format("SELECT * FROM {0} WHERE RowId BETWEEN {1} AND {2}", this.TableName, indexRange.Start, indexRange.Stop);
            SQLiteCommand command = new SQLiteCommand(commandText, this.Connection);
            SQLiteDataAdapter dataAdapter = new SQLiteDataAdapter(command);

            DataTable dataTable = new DataTable(this.TableName, this.TableName);

            dataAdapter.Fill(dataTable);

            dataTable.Columns.Add("RowId", typeof(Int64));

            for (Int32 i = 0; i < dataTable.Rows.Count; i++)
            {
                dataTable.Rows[i]["RowId"] = i + indexRange.Start;
            }

            dataTable.PrimaryKey = new DataColumn[] { dataTable.Columns["Rowid"] };

            return dataTable;
        }
        else
        {
            return null;
        }
    }

}
public class CachePage
{
    public CachePage(IndexRange range, DataTable data)
    {
        this.Range = range;
        this.Data = data;
    }

    public IndexRange Range {get; set;}
    public DataTable Data {get; set;}
} 
public class IndexRange
{
    public Int32 Start {get; set;}
    public Int32 Stop { get; set; }

    public IndexRange(Int32 start, Int32 stop)
    {
        this.Start = start;
        this.Stop = stop;
    }
} 
```

// 如何从虚拟 DataGridView 调用它？

```
private void dataGridViewMain_CellValueNeeded(Object sender, DataGridViewCellValueEventArgs e)
    {
        if (this.Cache != null)
        {
            e.Value = this.Cache.GetCellValue(e.RowIndex, e.ColumnIndex);
        }
    } 
```

所以它很酷，而且效果很好，不用大惊小怪，不用想那么多……

此代码段可用于使用 RowId 字段而不是主键（实际上不是真正的字段）创建 SQLite 数据库表查看器。

另一个更好的解决方案是通过... asc 或 desc 按顺序获取数据，然后使用模运算符查找此类数据，但我懒得执行该任务。我猜 SQLite dll 仍然比使用预先存在的 DataColumn 作为 PrimaryKey 更快地获取数据顺序......但正如我所说，我现在很懒惰......

# sharepoint-2010 - 将事件接收器附加到内容类型

> ID：15364112
> 
> 赞同：0
> 
> 时间：2013-03-12T14:33:28.660
> 
> 标签：sharepoint-2010

我创建了一些网站栏/内容类型和列表定义作为功能的一部分。我想将 eventreceiver 附加到内容类型。我添加了将事件接收器附加到内容类型的代码。使用 spmanager 我可以看到事件接收器已附加到内容类型，但是当我从内容类型创建列表时，事件接收器丢失了。有任何想法吗。我的代码如下

```
 public override void FeatureActivated(SPFeatureReceiverProperties properties)
            {
                string asmName = System.Reflection.Assembly.GetExecutingAssembly().FullName;
                string itemReceiverName = "xxxxxx.Intranet.SP.xxxxx.PermissionsUpdaterEventReceiver";

                ////surely a better way to get all lists than this
                ////re - do
                using (SPSite thisSite = (SPSite)properties.Feature.Parent) {
                    using (SPWeb web = thisSite.RootWeb) {
                        SPContentType RambollNewsContentType = web.ContentTypes["RambollNewsContentType"];
                        RambollNewsContentType.EventReceivers.Add(SPEventReceiverType.ItemAdded, asmName, itemReceiverName);
                        RambollNewsContentType.Update(true);
                    }
                }    
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T11:41:35.737

我不确定这是否与您的问题有关，但是

但是您能否在将内容类型添加到列表之前尝试将事件接收器添加到内容类型。

我认为必须先添加事件接收器，因为在将内容类型添加到列表时，内容类型不会直接添加到列表中，而是将其副本添加到列表中。因此，当您将内容类型添加到列表时，还没有事件接收器。

如果我理解你的问题是错误的，请纠正我？

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T16:18:05.513

我正在成功使用它。我留下了我的日志记录和日志记录方法。

```
 /// <summary>
    /// This method is executed on feature activation.
    /// It attaches the event receiver to the content type.
    /// </summary>
    public override void FeatureActivated(SPFeatureReceiverProperties properties)
    {
        LogMessage("FeatureActivated - Start");
        SPSite site = (SPSite)properties.Feature.Parent;
        LogMessage("FeatureActivated - 1");
        SPWeb web = site.RootWeb;
        LogMessage("FeatureActivated - 2");
        //ListContentTypes(web);
        SPContentType ctype = web.ContentTypes["Wells Project Task List"];
        LogMessage("FeatureActivated - 3");
        LogMessage("ctype name: " + ctype.Name.ToString());
        if (ctype != null)
        {
            LogMessage("FeatureActivated - I have a content type. Web url: " + web.Url);
            SPEventReceiverDefinition er = ctype.EventReceivers.Add();
            er.Class = "Wells.SharePoint.ProjectManagementEventReceiver";
            er.Assembly = "ProjectManagementEventReceiver, Version=1.0.0.0, Culture=neutral, PublicKeyToken=a1cb21c41d80b7ae";
            er.Type = SPEventReceiverType.ItemAdded;
            er.Name = "ItemAdded";
            er.SequenceNumber = 10001;
            er.Update();
            ctype.Update(false);
            LogMessage("FeatureActivated - After ctype.update");
            web.Dispose();
        }
        else
            LogMessage("CT not found: " + web.Url);

        LogMessage("FeatureActivated - End");
    }

    static void ListContentTypes(SPWeb web)
    {
        foreach (SPContentType ct in web.ContentTypes)
        {
            LogMessage("CT: " + ct.Name.ToString());
        }
    }

    /// <summary>
    /// This method is executed on feature deactivation.
    /// It removes the event receiver from the content type
    /// </summary>
    /// <param name="properties"></param>
    public override void FeatureDeactivating(SPFeatureReceiverProperties properties)
    {
        LogMessage("Feature DeActivated  - Start");
        SPSite site = (SPSite)properties.Feature.Parent;
        SPWeb web = site.OpenWeb();
        SPContentType contentType = web.ContentTypes["NAME OF CONTENT TYPE"];
        if (contentType != null)
        {
            LogMessage("im have a content type. Web url: " + web.Url);
            int i;
            //Use the above integer to loop through the event recievers on the first list and delete the above assembly
            for (i = 0; i < contentType.EventReceivers.Count; i++)
            {
                LogMessage("ER Count: " + contentType.EventReceivers.Count);
                if (contentType.EventReceivers[i].Assembly.Contains("ProjectManagementEventReceiver"))
                {
                    contentType.EventReceivers[i].Delete();

                    LogMessage("Deleting event receiver from CT");

                }
            }
            contentType.Update();
        }
        else
            LogMessage("CT not found: " + web.Url);

        LogMessage("Feature DeActivated  - End");

    }

static void LogMessage(string msg)
    {
        StreamWriter wrtr = null;
        try
        {
            wrtr = new StreamWriter("C:\\Logs\\FeatureActivatedDeactivated.txt", true);
            wrtr.WriteLine(msg + "--[" + System.DateTime.Now.ToString() + "]" + Environment.NewLine);
            wrtr.WriteLine(Environment.NewLine + "==================================");
        }
        catch (Exception e)
        {
            throw e;
        }
        finally
        {
            if (wrtr != null)
            {
                wrtr.Close();
                wrtr.Dispose();
            }
        }
    } 
```

# python - Python 在非常大的输出中打印“...”

> ID：15364114
> 
> 赞同：9
> 
> 时间：2013-03-12T14:33:31.393
> 
> 标签：python, numpy

我正在尝试在 python 中打印一些大的东西，而不是得到整个结果，我得到了其中的一部分，中间带有“...”。任何想法如何获得全部？

例如

```
'8.881386032' '5.737972827' '3.355746972' ..., '2.827335059', '2.598858336' '2.69954686' 
```

代码是：

```
 transposedMatrix = np.transpose(data)
 print (transposedMatrix) 
```

我已经将其转换为字符串，并且在写入文件时得到相同的结果

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-12T14:37:04.290

对于`numpy`，请致电：

```
import sys
import numpy

numpy.set_printoptions(threshold=sys.maxint) 
```

将阈值提高到无穷大。有关更多详细信息，请参阅[`numpy.set_printoptions()`文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.set_printoptions.html)。

对于 Python 3，请`sys.maxsize`改用：

```
numpy.set_printoptions(threshold=sys.maxsize) 
```

# perl - 从 unix 检查代码签名

> ID：15364116
> 
> 赞同：1
> 
> 时间：2013-03-12T14:33:34.127
> 
> 标签：perl, unix, code-signing, signtool

有谁知道是否有办法在 Unix 下验证 Windows 程序的签名？以类似于Windows 下的[signtool的方式？](http://msdn.microsoft.com/de-de/library/windows/desktop/aa388171%28v=vs.85%29.aspx "标志工具")

提前致谢！T。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T19:30:03.353

可能有不同的签名算法，Windows 可能已经编写了自己的签名算法，在这种情况下你可能会不走运。

您可以使用“md5”或“sum”。您可以在 Windows 中验证代码，如果经过验证，则计算它的“md5”签名并将其用于 Unix（从那时起，如果需要，也可以将 if 用于 Windows）。

我将首先研究 windows 工具使用哪种算法，然后您可以查看在 Unix 下是否可以使用等效算法。如果它不是 MS 专有代码，则可能已经存在 Unix 等效代码。

# php - 如何使用从 JSON 生成的传入 PHP 变量缩短 URL

> ID：15364123
> 
> 赞同：0
> 
> 时间：2013-03-12T14:34:02.777
> 
> 标签：php, jquery, json, jquery-mobile

我一直在使用这个 YouTube 视频中的代码：http: [//youtu.be/8GSQSYXv_TQ](http://youtu.be/8GSQSYXv_TQ) ，它非常适合我正在做的事情。本质上，我将 JSON 内容保存到变量中并将它们传递给另一个页面。不幸的是，当传递到另一个页面时，传入的变量包括传入的 JSON“节点”的所有内容。例如，

`<a href="detail.php?title=$title&description=$description&link=$link".....>`

将此 URL 传递到`detail.php`页面中：

`http:....../detail.php?title=SOME REALLY LONG TITLE&description=THIS IS AN ENTIRE PARAGRAPH OF TEXT. BLAHBLAH.........`等等。

有没有办法截断所有这些，加密传入的数据，或者其他什么？我想我在某处读到可以将其保存为会话变量，但我不确定这是否正确。

谢谢阅读。我很感激任何反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:05:05.290

是的，您可以使用 session ，因为它似乎更容易和更快地实现。

我建议的另一个解决方案是在隐藏类型字段中编写一个带有参数的表单，并告诉这个表单将这些信息发布到您的另一个页面中。

如果您想使用会话，我建议您这样做：

```
session_start();
$_SESSION['data'] = serialize (array("param1" => $value, "param2" => $value2)); 
```

在使用信息之前不要忘记取消序列化（）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:40:32.430

有两种方法可以解决您的问题...

如果可能，请使用 POST 而不是 GET。

使用您可以像这样将所有数据存储在 $_SESSION 变量中......

```
session_start();
$_SESSION['title'] = $title;
$_SESSION['description'] = $description;
$_SESSION['link'] = $link; 
```

然后在您访问的任何页面上，您都可以使用...

```
session_start();
$title = $_SESSION['title']
$description = $_SESSION['description'];
$link = $_SESSION['link']; 
```

# java - 封装 Shiro 主题

> ID：15364126
> 
> 赞同：0
> 
> 时间：2013-03-12T14:34:09.570
> 
> 标签：java, security, servlets, shiro

我想将 Apache Shiro 封装在 Servlet 环境中。我想创建 MySecurityUtils 并在静态方法中使用 Shiro SecurityUtils.getSubject。我的问题是这是否是在静态方法中使用 SecurityUtils.getSubject 方法的正确方法。这会在多线程 servlet 环境中引起任何问题吗？

MySecurityUtils.java

```
import org.apache.shiro.subject.Subject;
import org.apache.shiro.SecurityUtils;

public class MySecurityUtils {

    public static MyUser getUser() {
        Subject currentUser = SecurityUtils.getSubject();
        MyUser myUser = new MyUser(currentUser);
        ...
    }
} 
```

我的用户.java

```
public class MyUser {
   // ... constructors
   public boolean isPermitted(..) {subject.isPermitted(...)}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:59:37.127

我不明白您为什么要这样做，但是为了您的问题，这很好。

在 Web 上下文中，Shiro 的每个请求`SecurityUtils#getSubject()`返回一个不同的`Subject`实例。显然，如果主题已登录，凭据将被复制（从会话）到新`Subject`实例。通过`MyUser`在每次调用`getUser()`.

不过要小心，如果你`getUser()`在同一个请求中调用两次，你会得到一个不同的`MyUser`实例。但是，内部`Subject`将是相同的。如果您在`MyUser`课堂上进行委派以外的逻辑，则可能会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T08:00:35.400

在 Sotirios 的反馈后，我将代码更改如下

```
 public class SecurityHelper {
     public static boolean isAuthenticated(){
      Subject currentUser = SecurityUtils.getSubject();
      return currentUser.isAuthenticated();
     }
     public static void checkPermission(String permissionCode){
          Subject currentUser = SecurityUtils.getSubject();
          currentUser.checkPermission(permissionCode);
     }
     public static void checkPermission(String... permissionCodes){
          Subject currentUser = SecurityUtils.getSubject();
          currentUser.checkPermissions(permissionCodes);
     }
     ... and so on 
```

我将所有应用程序逻辑封装在一个 Helper 类中。

# c++ - 在实时绘图中仅绘制 QwtCurve 的一部分

> ID：15364132
> 
> 赞同：2
> 
> 时间：2013-03-12T14:34:24.573
> 
> 标签：c++, qt, qwt

我有一个 QVector，我在其中不断地附加数据，这样我就可以在 QwtPlot 上绘图。但是我猜这个向量太频繁了，程序崩溃了。

我的问题是，我如何创建一个仅在某个时间点开始的 QwtCurve，因为向量中不需要已经过去的时间，因为它已经被绘制了。

这是我的代码：

```
QVector<double> xv;
QVector<double> cv1;
QVector<double> cv2; 
```

作为全局变量，

```
void gui::process_new_info(QByteArray array)
{
    int v = 0;

    double f = ui->frequency->value();

    xv.append(sizeof_array/f);

    char *buf = array.data();

    if (ui->ecgPlux->isChecked() == true || ui->channel_1->currentIndex() != 0)
    {
        cv1.append(buf[1]);

        QwtPlotCurve *curve1 = new QwtPlotCurve;
        curve1->attach(plot_all[0]);
        curve1->setData(xv,cv1);
        curve1->setPen(QPen(Qt::blue,1));
        plot_all[0]->replot();

        QwtPlotCurve *curve2 = new QwtPlotCurve;
        curve2->attach(plot[0]);
        curve2->setData(xv,cv1);
        curve2->setPen(QPen(Qt::blue,1));
        plot[0]->replot();
    }

    if (ui->xyzPlux->isChecked() == true || ui->channel_2->currentIndex() != 0)
    {
        cv2.append(buf[2]);

        QwtPlotCurve *curve3 = new QwtPlotCurve;
        curve3->attach(plot_all[1]);
        curve3->setData(xv,cv2);
        curve3->setPen(QPen(Qt::blue,1));
        plot_all[0]->replot();

        QwtPlotCurve *curve4 = new QwtPlotCurve;
        curve4->attach(plot[1]);
        curve4->setData(xv,cv1);
        curve4->setPen(QPen(Qt::blue,1));
        plot[1]->replot();
    }

    //printf ("%d ->", buf[0]);
    fprintf (data, "%d,", buf[0]);

    for (int i = 1; i < 9; i++)
    {
        v = buf[i];
        //printf ("%d,", v);
        fprintf (data, "%d,", v);
    }

    //printf ("\n");
    fprintf (data, "\n");

    sizeof_array++;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:33:10.677

`QwtPlotCurve`

[http://qwt.sourceforge.net/class_qwt_plot_curve.html](http://qwt.sourceforge.net/class_qwt_plot_curve.html)

继承自`QwtPlotSeriesItem`

[http://qwt.sourceforge.net/class_qwt_plot_series_item.html](http://qwt.sourceforge.net/class_qwt_plot_series_item.html)

里面有一个警告`setData`

> 该项目拥有数据对象的所有权，不再使用时将其删除。

这可能不是您变得太大的事实......可能是您正在访问 Qwt 删除的内容。

在调试器中运行它，并查看堆栈跟踪它在哪里死亡，或者放入一堆`qDebug()`行以查看它在哪里死亡。

如果数据太大，您可以在设置矢量之前从矢量头部弹出项目。

希望有帮助。

# h.264 - vlc 以错误的帧速率支付使用 libavcodec 创建的视频

> ID：15364133
> 
> 赞同：1
> 
> 时间：2013-03-12T14:34:36.697
> 
> 标签：h.264, vlc, libavcodec

作为测试，我想创建一个帧速率为 1 fps 的视频。当我像这样创建它时，vlc 仍然以 25 fps 的速度播放。有人有想法吗？

```
AVFormatContext* formatContext;
avformat_alloc_output_context2(&formatContext, NULL, NULL, "test.h264");
AVOutputFormat* outputFormat = formatContext->oformat;

AVStream* videoStream = av_new_stream(formatContext, 0);
AVCodecContext* ctx  = videoStream->codec;

ctx->codec_type = AVMEDIA_TYPE_VIDEO;  
ctx->codec_id = CODEC_ID_H264;    

ctx->bit_rate = 500*1000;
ctx->bit_rate_tolerance = 0;
ctx->width = w;
ctx->height = h;
ctx->pix_fmt = AV_PIX_FMT_YUV420P;
ctx->time_base.den = 1;//25;
ctx->time_base.num = 1; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-17T11:22:50.727

这是一个老问题，但我希望它能帮助其他有同样问题的人

`AVStream`有一个明确`time_base`的，由 muxer 根据容器设置。如`AVStream.time_base`评论中所述：

> 复用器*可以*使用用户提供的值 `AVCodecContext.time_base`作为提示。

您需要使用`av_rescale_q()`将*RAW FRAME* pts 设置为正确的值：

```
/* AVFrame* */ raw_frame->pts = av_rescale_q(my_pts, ctx->time_base, videoStream->time_base);
.
.
.
/* AVPacket pkt; */
avcodec_encode_video2(ctx, pkt, &got_packet);
.
.
.
av_write_frame(formatContext, &pkt); 
```

# iphone - 在窗口级别获取键盘的框架

> ID：15364138
> 
> 赞同：1
> 
> 时间：2013-03-12T14:34:57.113
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我试图在窗口级别获取键盘框架的坐标，以便与 TableCell 进行比较，以对滚动进行微调，以便单元格中选定的 TextField 不会位于键盘或标题后面。

但是我在窗口级别获取键盘的 x,y 坐标时遇到问题，它们只是返回 0,0（原点），这是不正确的。或者，如果是，那不是我需要的。

我正在使用以下线路：

```
CGRect keyboardFrame = [self.view.window convertRect:_numericKeyboardView.frame toView:nil];
NSLog(@"Keyboard Frame: %f, %f, %f, %f", keyboardFrame.origin.x, keyboardFrame.origin.y, keyboardFrame.size.width, keyboardFrame.size.height); 
```

产生输出（用于肖像）：

```
Keyboard Frame: 0.000000, 0.000000, 768.000000, 264.000000 
```

什么时候应该更像：

```
Keyboard Frame: 415.000000, 0.000000, 768.000000, 264.000000 
```

关于如何获得正确的键盘坐标的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:38:30.167

来自[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)

您需要注册键盘通知，例如

```
 [[NSNotificationCenter defaultCenter] addObserver:self
            selector:@selector(keyboardWasShown:)
            name:UIKeyboardDidShowNotification object:nil]; 
```

然后

```
- (void)keyboardWasShown:(NSNotification*)aNotification
{
    NSDictionary* info = [aNotification userInfo];
    CGRect kbFrame = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue];
} 
```

并且不要忘记在您的`dealloc`方法中删除自我表单通知中心

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:45:50.387

如果你想这样做，你可能会发送`convertRect:toView:`到错误的接收者。做`[_numericKeyboardView convertRect:_numericKeyboardView.bounds toView:nil];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T14:48:24.273

你的问题具有误导性。听起来您的“键盘”是自定义视图，而不是系统键盘。问题应该是“在窗口坐标中获取视图的框架”。该`convertRect:toView`方法将起作用，但您将其倒退。

将您的代码更改为：

```
CGRect keyboardFrame = [_numericKeyboardView convertRect:_numericKeyboardView.bounds 
                                                  toView:self.view.window]; 
```

# rsa - RSA在哪里使用？

> ID：15364144
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:35:04.560
> 
> 标签：rsa, public-key-encryption, encryption-asymmetric

有人请说明 RSA 算法的两个或三个应用。我听说 RSA 用于 SSL。真的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:40:02.633

是的，这是真的。RSA是一种加密算法。

示例用途：

1.  SSL
2.  SSH
3.  数字签名
4.  PGP

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:39:51.370

RSA 用于基于密钥的身份验证中的加密。SSH 使用这种密钥生成方法，因为它被认为非常安全。

[看这里了解更多](https://help.ubuntu.com/community/SSH/OpenSSH/Keys)

# matlab - 为什么 conv2() 返回的是白色图像而不是过滤后的图像？

> ID：15364148
> 
> 赞同：1
> 
> 时间：2013-03-12T14:35:17.240
> 
> 标签：matlab, image-processing

在 Matlab 中，我用`fspecial()`. 我将内核分配给一个名为`h`. 我通过读取图像`imread()`并将图像分配给一个名为`Im`.

图像上有一些随机噪声，我的目的是看看如何消除噪声。现在，我想将图像`Im`与内核卷积`h`。我尝试以`conv2()`这种方式使用该功能：`conv2(Im, h);`

但事实证明，当我执行`imshow()`. `Im`在与内核卷积之后，我希望结果是图像的模糊版本`h`。

这就是我所做的：

```
>> Im = imread('image.jpg');
>> h = fspecial('gaussian', 5, 1.0);
>> C1 = conv2(Im, h); 
```

我对其他图片尝试了相同的过程，但我也得到了一张空白的图片`imshow()`。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T14:54:05.310

好像您正在处理`uint8`类型图像。在这种情况下，过滤可能会使像素值饱和并导致伪影。尝试：

```
Im = im2double( imread( 'image.jpg' ) );
h = fspecial( 'gaussian', 5, 1.0 );
C1 = imfilter( Im, h );
figure; imshow( C1, [] ); title( 'filtered image' ); 
```

PS
我不确定，但我认为当`Im`你`uint8`的值在[0..255]范围内时，`conv2`你的`double`值在大致相同的范围内。但是，`image`饱和像素（对于`double`图像）为 1（不是 255），这就是您看到全白图像的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-05T17:01:24.603

白色图像是因为您没有进行标准化。在您使用 C1 = conv2(Im, h) 对您的图像进行 conv2 后，在 maplab 中，如果您检查 C1 变量，您会发现这些值非常高。

要标准化您的图像，将图像除以 255 并执行 imshow。imshow(c1/255);

# android - 从 OnLongClickListener 振动

> ID：15364153
> 
> 赞同：0
> 
> 时间：2013-03-12T14:35:29.960
> 
> 标签：android, android-vibration

也许有人可以向我解释，如何正确地从 OnLongClickListener 中振动。在下面的方法中，振动很短。如果我`return false;`按预期设置振动持续 5000 毫秒，但`OnClickListener`会被解雇。

我应该如何在整个期间从 OnLongClickListener 振动，而不是开火`OnClickListener`？

```
final Vibrator x = (Vibrator) getParent()
            .getSystemService(Context.VIBRATOR_SERVICE);
button.setOnLongClickListener(new OnLongClickListener() {
        @Override
    public boolean onLongClick(View v) {
        x.vibrate(5000);
        return true;
    } 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:52:01.757

您可以设置一个计时器在振动期间运行，并且只有在超时后才返回 True。有点笨拙，但它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:03:53.210

当点击事件被触发时，它被传递给可用的最低处理程序（除非有人中断）。在您的情况下，首先将长点击事件传递给`OnLongClickListener`. 如果该侦听器返回`true`，它基本上宣布此单击事件已被处理。如果它返回`false`，则它宣布 click 事件没有被它处理，这就是为什么事件会沿着更高级别传递给层次结构中它上面的处理程序，在你的情况下，`OnClickListener`.

这就是为什么返回`false`不是要走的路，因为你确实想处理长点击事件。

如何`ASyncTask`为振动本身创建一个后台线程或一个。就像是：

```
@Override
public boolean onLongClick(View v) {
    getHandler().post(new Runnable() {

        @Override
        public void run() {
            x.vibrate(5000);           
        }

    });
    return true;
} 
```

*我没有测试代码，但应该没问题。*

# javascript - on() 方法不适用于动态生成的 HTML

> ID：15364156
> 
> 赞同：-2
> 
> 时间：2013-03-12T14:35:31.123
> 
> 标签：javascript, jquery

我正在`tr`向我的表中动态添加一个表行 ( )，并且这些`tr`标签包含一些链接。

我有一个 jQuery 脚本，当点击里面的链接时调用它`tr`。该脚本不适用于这些链接。它在我重新加载页面并`tr`从服务器端填充时起作用。

我该如何克服这个问题？

```
$(".comment-like").on('click',function() {
    var spanEle = $(this).closest('li').find('.comment-like-count');
    if (spanEle.length) {
        var newCount = parseInt(spanEle.text(),10);
        spanEle.text(newCount + 1);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:39:33.460

您应该[将侦听器委托给父](http://api.jquery.com/on/#direct-and-delegated-events)表，而不是链接本身，因为它们动态地来来去去试试这个：

```
$('your table selector').on('click','.comment-like', function () {
    var spanEle = $(this).closest('li').find('.comment-like-count');
    if (spanEle.length) {
        var newCount = parseInt(spanEle.text(), 10);
        spanEle.text(newCount + 1);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:37:35.927

我认为您想改用[委托](http://api.jquery.com/delegate/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T14:40:46.303

选择页面加载时存在的父选择器。如果没有，请使用`$('body')`

```
$('.elem-existing-on-pageload').on('click', '.comment-like', function() {
    ...
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-12T14:38:38.437

添加后，您必须为这些新元素附加事件处理程序。

# flash - Flex：禁用非美国或加拿大的邮政编码验证

> ID：15364157
> 
> 赞同：0
> 
> 时间：2013-03-12T14:35:35.320
> 
> 标签：flash, apache-flex, flash-builder

目前我正在根据国家/地区下拉值设置 ZipCode 域。

```
if(this.countryCTComboBox.getSelectedCode() == 'USA')
                {
                    this.zipCodeTextInputFieldValidator.domain = ZipCodeValidatorDomainType.US_ONLY;
                    this.zipCodeTextInputFieldValidator.wrongLengthError = this.zipCodeTextInputFieldValidator.wrongUSFormatError;
                } 
                else if(this.countryCTComboBox.getSelectedCode() == 'Canada')
                {
                    this.zipCodeTextInputFieldValidator.domain = ZipCodeValidatorDomainType.CANADA_ONLY
                    this.zipCodeTextInputFieldValidator.wrongLengthError = this.zipCodeTextInputFieldValidator.wrongCAFormatError;
                } 
```

如果从国家下拉列表中选择美国或加拿大，则效果很好。但它给`wrongUSFormat`所有其他国家/地区带来了错误。
是否有任何方法可以禁用任何其他国家/地区的验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:48:54.557

该语句的最后一部分是对输入 if 语句的字符串运行不同的验证器或根本不运行验证器。

```
} else {
    trace("this is not a US or Canada Zip code");
    // do something else with the zip code now, or do nothing
    zipCodeTextInputFieldValidator.source = null;
} 
```

您可能需要修改此`if/else`语句的其他分支，以便它们通过将 设置`source`为适当的文本输入来重新启用验证器。

我不确定您还需要做什么，但还要检查以确保您没有将文本字段限制为所有数字或一定长度的字符，这可能会让您感到困惑。

# c# - 防止用户缩放 ZedGraph 时 Y2Axis 发生变化

> ID：15364159
> 
> 赞同：0
> 
> 时间：2013-03-12T14:35:38.843
> 
> 标签：c#, zedgraph

我使用单个[ZedGraphControl](http://zedgraph.sourceforge.net/documentation/html/T_ZedGraph_ZedGraphControl.htm)来显示 2 条曲线，一条在主[YAxis](http://zedgraph.sourceforge.net/documentation/html/P_ZedGraph_GraphPane_YAxis.htm)上，另一条在[Y2Axis](http://zedgraph.sourceforge.net/documentation/html/P_ZedGraph_GraphPane_Y2Axis.htm)上。我想这样当用户手动放大数据时，只有 YAxis 上的比例会发生变化。

我找不到任何方法来锁定 Y2Axis 实际上首先防止更改。然后我认为我可以撤消对[AxisChangeEvent](http://zedgraph.sourceforge.net/documentation/html/E_ZedGraph_GraphPane_AxisChangeEvent.htm)中的轴的任何更改，但再次更改此事件的调用，从而导致无限循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:35:38.843

以本网站的典型方式，我在尝试正确提出问题时想出了一个答案。

我只是在 AxisChangeEvent 的开头设置了一个布尔标志，以防止递归调用。然后重置 Y2Axis 的比例：

```
 private bool resizingAxis = false;

    void GraphPane_AxisChangeEvent(ZedGraph.GraphPane pane)
    {
        if (!resizingAxis)
        {
            resizingAxis = true;
            this.zedGraphControl1.GraphPane.Y2Axis.ResetAutoScale(pane, this.CreateGraphics());
            resizingAxis = false;
        }
    } 
```

这感觉有点像 hack，不过我很想听听任何其他可能的解决方案。

# javascript - Javascript console.log 过早加载

> ID：15364160
> 
> 赞同：1
> 
> 时间：2013-03-12T14:35:40.373
> 
> 标签：javascript, jquery, raphael

我正在使用 Ian Li 的[Raphael SketchPad](http://ianli.com/sketchpad/)，并且在保存绘图时遇到了一些问题。

在我`sketchpad`的 id 对象发生更改后，我`data`应该更新，我放置了一个控制台日志“更改”只是为了检查。发生的情况是，在加载屏幕时，我看到了控制台日志消息，而在进行更改时我再也看不到它了。

如何使 console.log 仅在更改后运行？这是我正在使用的模板的扩展代码： [https ://gist.github.com/benbakhshi/5143484](https://gist.github.com/benbakhshi/5143484)

```
<script type="text/javascript">
   var sketchpad = Raphael.sketchpad("editor", {
      height: 260,
      width: 260,
      editing: true // true is default
   });

   // When the sketchpad changes, update the input field.
   sketchpad.change(function() {
      $("#data").val(sketchpad.json());
      console.log("changed");
   });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:52:56.683

这个问题看起来像你试图在`console.log`没有保证`.json`调用已经完成的情况下。相反，请尝试连接到`change`事件`#Data`以执行日志记录。这将**保证**在`.json`记录之前调用已经完成。

就像是：

```
var sketchpad = Raphael.sketchpad("editor", {
  height: 260,
  width: 260,
  editing: true // true is default
});

$("#data").change(function () {
    console.log("changed");
});

// When the sketchpad changes, update the input field.
sketchpad.change(function() {
  $("#data").val(sketchpad.json()).change();
}); 
```

# spring - Spring Security 登录失败

> ID：15364161
> 
> 赞同：0
> 
> 时间：2013-03-12T14:35:41.140
> 
> 标签：spring, security, jsf, login

我正在使用带有 JSF Mojarra 2.1.18 和 Primefaces 3.5 的 Spring Security 3.0.6。

我创建了一个 LoginManagedBean，它注入了 Spring Security 的 AuthenticationManager。

```
 @ManagedBean
    @SessionScoped
    public class LoginManagedBean implements Serializable {

        private static final long serialVersionUID = 1L;

        private static transient final Log logger = LogFactory.getLog(LoginManagedBean.class);

        private LoginDTO login;

        private String username;

        private String password;

        @ManagedProperty(value = "#{authenticationManager}")
        private transient AuthenticationManager authenticationManager = null;

... 
```

有用。但是如果登录失败，我将永远无法使用正确的值再次登录。我想我需要清除/重置 authenticationManager 对象，但我不知道如何。有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:40:51.200

你应该换一种方式。

1）定义身份验证管理器

```
<s:authentication-manager>
    <s:authentication-provider>
        <s:user-service>
            <s:user name="root" password="root"/>
        </s:user-service>
    </s:authentication-provider>
</s:authentication-manager> 
```

2) 定义安全配置和表单登录

```
<s:http auto-config="true" use-expressions="true">
    <s:intercept-url pattern="/favicon.ico" access="permitAll"/>
    <s:intercept-url pattern="/resources/**" access="permitAll"/>
    <s:intercept-url pattern="/login**" access="isAnonymous"/>
    <s:intercept-url pattern="/pages/*" access="hasAuthority('ROLE_USER')"/>      
    <s:form-login login-page="/login.xhtml" default-target-url="/"
                  authentication-failure-url="/login.xhtml?loginFailed=true"/>
</s:http> 
```

3）穿上`@EnableWebMvc`一些`@Configuration`

4）创建表单以`login.xml`将数据（字段`j_username`和`j_password`）发布到`/j_spring_security_check`

5）添加过滤器`web.xml`

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping> 
```

# javascript - 使用 .htaccess 和 javascript 处理 404？

> ID：15364164
> 
> 赞同：1
> 
> 时间：2013-03-12T14:35:49.177
> 
> 标签：javascript, .htaccess

我有一个使用静态 html 的网站；没有任何可用的 PHP 或 CGI 服务。我想在 javascript 中构建一个有点智能的 404 错误页面。从[JavaScript：404 页面，如何获取请求的 url？](https://stackoverflow.com/questions/9852263/javascript-404-page-how-to-get-the-requested-url)我知道`document.referer`接收 404 页面不可用，但是那里的答案之一表明可能可以通过 htaccess 传递请求 url。我该怎么做？以下不起作用：

`.htaccess`：

```
RewriteEngine on
ErrorDocument 404 /err404.html?url=%{HTTP_REFERER} 
```

和`err404.html`：

```
<html><body>
<script type="text/javascript">
    var file;
    file = window.location.pathname;
    document.write('sorry, ' + file + ' not found');
</script>
<body></html> 
```

生成的 url 与传入的 url 保持一致，`http://www.example.com/something-not-here`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T19:23:17.193

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-d   # `!-d` means if directory doesn't exist
RewriteCond %{REQUEST_FILENAME} !-f   # if file doesn't  ... 
RewriteCond %{REQUEST_FILENAME} !-l   # if link doesn't

# L = last rule, stop processing
# QSA = Query String Append
# R = Redirect (default is 302, temporary)
RewriteRule ^ /err404.html?url=%{REQUEST_URI}&refr=%{HTTP_REFERER} [L,QSA,R] 
```

然后像这样更改您的 err404.html：

```
<html><body>
<script type="text/javascript">
   function getQueryVariable(variable) {
       var query = window.location.search.substring(1);
       var vars = query.split('&');
       for (var i = 0; i < vars.length; i++) {
           var pair = vars[i].split('=');
           if (decodeURIComponent(pair[0]) == variable) {
               return decodeURIComponent(pair[1]);
           }
       }
       console.log('Query variable %s not found', variable);
   }
   document.write('sorry! ' + getQueryVariable('url') + 
                  ' not found, requesting URL: ' + getQueryVariable('refr'));
</script>
<body></html> 
```

这将导致在页面上显示**不存在的 URI**的以下文本`http://domain.com/not-here``http://domain.com/sample.html`

```
sorry! /not-here not found, requesting URL: http://domain.com/sample.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:40:59.917

如果我正确理解了这个问题，那是因为`window.location`总是会给出浏览器显示的 URL。重写后的 URL 仅在服务器端可用，因此您需要一种服务器端语言来完成此操作。

# bash - 检查是否在 Bash/Linux 中

> ID：15364166
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:35:57.940
> 
> 标签：bash

我对这种情况有疑问：

```
echo ${0##*/} # result: bady

my if: if [[ "$(pgrep -c "${0##*/}")" -eq 1 ]]... check OK!

edit if: if [[ "$(pgrep -c "bady")" -eq 1 ]]... check problem! 
```

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:37:43.613

你有双引号，改为：

```
if [[ "$(pgrep -c bady)" -eq 1 ]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:00:08.160

您真的关心计数是否为 1，还是只需要区分“匹配”和“不匹配”，而计​​数恰好为 1？您可以只检查退出状态`pgrep`以查看是否发生匹配：

```
if pgrep "${0##*/}"; then 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T14:38:35.897

尝试这个 ：

```
if (( $(pgrep -c bady) == 1 )) 
```

无需引用整数。

**注意**:`((...))`是一个算术命令，如果表达式非零，则返回退出状态 0，如果表达式为零，则返回 1。如果需要副作用（分配），也用作“让”的同义词。见[http://mywiki.wooledge.org/ArithmeticExpression](http://mywiki.wooledge.org/ArithmeticExpression)

# c# - 无法从表转换为类

> ID：15364183
> 
> 赞同：1
> 
> 时间：2013-03-12T14:36:45.433
> 
> 标签：c#, sql-server, asp.net-mvc, linq, visual-studio-2012

我正在制作一个 MVC 3 Article 应用程序并使用 LINQ 将其连接到 SQL 数据库。我正在尝试使用 LINQ 代码创建一篇新文章，但最终出现以下错误：

> ArticleRepository.cs(41,13,41,47)：错误 CS1502：“System.Data.Linq.Table.InsertOnSubmit(NyjiGrunnur.ArticleTable)”的最佳重载方法匹配有一些无效参数
> 
> ArticleRepository.cs(41,45,41,46)：错误 CS1503：参数 1：无法从 'NyjiGrunnur.Models.Article' 转换为 'NyjiGrunnur.ArticleTable'

添加文章功能：

```
public void AddArticle(Article s)
    {
        ArticleLINQDataContext db = new ArticleLINQDataContext();
        //Article a = new Article { Id = s.Id, Content = s.Content, Name = s.Name, Subject =        s.Subject, Created = (DateTime)s.Created };
    Line 41:    db.ArticleTables.InsertOnSubmit(s);
        db.SubmitChanges();
    } 
```

我有 Articles.cs 模型：

```
namespace NyjiGrunnur.Models
{
    public class Article
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Content { get; set; }
        public string Subject { get; set; }
        public DateTime Created { get; set; }
    }
} 
```

我有正在使用的 LINQ to SQL 类。我还有一个有效的编辑功能，就像这样：

```
public void UpdateArticle(Article s)
    {
      ArticleLINQDataContext db = new ArticleLINQDataContext();

      var a = (from article in db.ArticleTables
                   where article.Id == s.Id
                   select article).SingleOrDefault();
      a.Name = s.Name;
      a.Subject = s.Subject;
      a.Content = s.Content;
      a.Created = s.Created;
      a.Id = s.Id;
      db.SubmitChanges();

    } 
```

`HomeController`也应该可以正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T14:38:53.137

正如错误试图告诉您的那样，您的 LINQ to SQL 类使用`ArticleTable`该类，该类与`Article`该类不同。

您需要`ArticleTable`从（视图模型）创建一个（数据模型）实例，`Article`以便将其放入数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:43:00.630

看起来您正在使用 AddArticle，但注释掉了映射：

```
public void AddArticle(Article s)
{
    ArticleLINQDataContext db = new ArticleLINQDataContext();
    ArticleTable a = 
        new ArticleTable { 
                             Id = s.Id, // *see question below code sample
                             Content = s.Content, 
                             Name = s.Name, 
                             Subject = s.Subject, 
                             Created = (DateTime)s.Created 
                         };
    db.ArticleTables.InsertOnSubmit(a);   // <-- note it's "a" instead of "s"
    db.SubmitChanges();
} 
```

*是`Id`自动生成的吗？如果是这样，您不应该在插入时设置它。

# java - 使用 jstl 使用 for 循环模拟 while 循环

> ID：15364187
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:36:52.640
> 
> 标签：java, jakarta-ee, for-loop, iterator, jstl

我有这段代码如下

```
 while(children.hasNext())
            {
                Page child1=children.next();
            } 
```

我需要在我的 jstl 中使用 for 循环或每个循环来使用此代码。

我可以知道我们该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:53:44.897

您可以使用`<c:forEach>`核心 JSTL 库中的标记。它是最有用和最通用的标签之一，在需要迭代数据时使用。

```
<c:forEach var="listObject" items="${myForm.myList}">
    <c:out value="${listObject.name}" />
</c:forEach> 
```

**PS：**不要忘记添加`<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>`到您的`JSP`.

# c++ - 无法编译mongodb c++驱动Linux Centos 5.6

> ID：15364194
> 
> 赞同：1
> 
> 时间：2013-03-12T14:37:18.937
> 
> 标签：c++, mongodb, compiler-errors, driver, x11

在服务器端安装 MongoDB 后，我尝试使用 C++ 驱动程序代码配置我的客户端，该客户端位于 CentOS 5.6 操作系统上，来自以下链接：

[http://dl.mongodb.org/dl/cxx-driver/](http://dl.mongodb.org/dl/cxx-driver/)

安装顺利！我毫无问题地完成了教程，但此时，我需要在我的团队的构建过程中构建它。当我尝试编译时，我收到以下错误：

```
/usr/local/include/mongo/base/error_codes.h:36: error: expected identifier before numeric constant
/usr/local/include/mongo/base/error_codes.h:36: error: expected '}' before numeric constant

.... 
```

在这一点上，我对自己说肯定有另一个#define 与这段代码发生冲突。所以，我运行`g++ ... -E`命令，发现在 中`/usr/include/X11/X.h`，有一个`#define BadValue`.

`error_codes.h`这对我来说似乎很奇怪，因为如果代码包含在命名空间中的某个命名空间中，我不希望发生这种情况`mongo`。所以，我搜索了我的整个文件系统，寻找类似`using namespace mongo`认为全局命名空间被污染的东西，但事实并非如此。我没有看到任何这种情况发生，我想知道 - 因为这两个都是第三方 - 如何解决。

想法？

# php - 显示与输入的项目相似的结果的搜索方法

> ID：15364202
> 
> 赞同：0
> 
> 时间：2013-03-12T14:37:35.470
> 
> 标签：php, mysql, search, catalog

我正在为社区中的一些农民构建一个数据驱动的网站（使用 PHP 和 MySQL）（嗯，是 - 你会在一秒钟内看到）。他们希望能够列出他们的产品，并让人们搜索这些产品，然后他们的名字就会出现，并附有一个链接到详细说明他们所有产品的页面。

虽然我知道这将是一个很长的列表，但我想，“由于对 mysql 数据库的每次搜索都很挑剔 - 包括区分大小写 - 我将按字母顺序列出一个列表，人们可以从下拉框中选择他们想要的搜索。没问题。”

嗯，现在是个问题。他扩大了网站的参数。他现在想包括手工和自制产品。不用说，我们从几十个潜在产品变成了数百个，现在下拉列表不再可行。但是，如果我使用文本字段供访问者搜索站点，除非他们键入时没有拼写错误并使用相同的大小写，否则他们将无法从搜索中获得准确的结果。

谁能推荐另一种方法？我知道“LIKE”搜索，但它并不能真正解决我的问题 - 特别是因为它可能会在搜索中产生误报。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:46:10.940

我会使用两个表：

*   一个包含所有可能的搜索词
*   一个包含任何适用术语的同义词（例如“手工制作”和“自制”）

在文本框中输入字符时，使用 AJAX 从第一个表中搜索值。使用以下方法返回可能的术语列表：

> 从 search_table 中选择术语，其中术语如 '%<input string>%'

仅当您的点击数少于 10 次时才开始返回值。（当他们输入 2 个字母时，IE 不会填充）。然后，当输入特定术语时，在第二个表中搜索同义词并将其包含在搜索中。在结果页面中，表明您包含了同义词，并且可能在每个同义词旁边加上一个“X”以选择重新搜索那些被排除的。

请注意，“like”不区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:45:03.217

好吧，这个问题有点模糊，因为您正在谈论多个搜索参数。

它更多的是一种设计选择。例如，考虑以下情况：

*   对于诸如“自制”或“手工”之类的项目，可能在输入字段下方，您应该有一个复选框，人们可以在其中向搜索添加其他标志
*   比如说，按名称“John Smith”搜索并勾选“handmade”和“homemade”
*   数据库中的“手工”和“自制”字段将始终相同（开/关）

所以，一个sql查询可能是这样的：

```
SELECT * FROM products WHERE farmername LIKE '%$search%' AND handmade = 'handmade' 
```

或者，在输入数据时，如果勾选了handmade，则在handmade中插入一个整数，其中1表示勾选handmade，0表示不勾选handmade

因此，您的查询将变为 AND handmade = 1（或 0）表示非手工制作

这些只是一些让您前进的想法，但这更多的是设计决策而不是数据库决策，您如何创建表以使用标志

# ruby-on-rails - 保存用户时无法将符号转换为整数错误

> ID：15364205
> 
> 赞同：1
> 
> 时间：2013-03-12T14:37:36.957
> 
> 标签：ruby-on-rails, sql-server, ruby-on-rails-3, activerecord, rails-activerecord

所以这是我的问题。一个月以来，我一直在与我在项目开始时创建的用户合作。今天我从sqllite切换到sqlserver以满足客户的要求，当我去使用我的注册表创建一个新用户时，我得到了以下错误：

```
can't convert Symbol into Integer

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"51nF50CYGNqz3N4o7TUYSyWeTadulXojQBPqERjvlcY=",
 "user"=>{
   "email"=>"test@blizzardlabs.com",
   "login"=>"bgarrison",
   "password"=>"[FILTERED]",
   "password_confirmation"=>"[FILTERED]",
   "profile_attributes"=>{
     "prefix"=>"",
     "first_name"=>"Bill",
     "last_name"=>"Garrison",
     "suffix"=>"",
     "birthday"=>"1983-06-01",
     "phone_numbers_attributes"=>{
       "0"=>{
         "info"=>"1234567890",
         "label"=>"Cell"
       }
     }
   }
 },
 "commit"=>"Register"} 
```

我有一种感觉，在某些时候我搞砸了注册过程，但我一生都无法弄清楚在哪里。用户-> has_one 个人资料-> has_many phone_numbers。

用户控制器：

```
def create    
    @user = User.new(params[:user])

    if @user.save
      @profile = @user.profile
      flash[:notice] = "Your account has been created."
      redirect_to(@user)
    else
      flash[:notice] = "There was a problem creating you."
      render :action => :new, :layout => 'logged_out'
    end
  end 
```

用户模型：

```
 class User < ActiveRecord::Base
  # Accessible attributes
  attr_accessible :login,
    :email,
    :password,
    :password_confirmation,
    :profile_attributes,
    :active

  # Associations
  has_one :profile, dependent: :destroy, autosave: true

  # Allows for a profile hash in user creation (stored in :profile_attributes)
  accepts_nested_attributes_for :profile 
```

型材型号：

```
class Profile < ActiveRecord::Base
  # Accessible Attributes
  attr_accessible :birthday, 
    :company_id, 
    :first_name, 
    :last_name, 
    :prefix, 
    :suffix, 
    :phone_numbers_attributes,
    :addresses_attributes

  # Model Associations
  has_many :phone_numbers, :as => :contactable, :class_name => "PhoneNumber", autosave: true
  accepts_nested_attributes_for :phone_numbers, allow_destroy: true, reject_if: :all_blan 
```

任何帮助，将不胜感激。谢谢！

更新：1另外，我已经测试了一些，并意识到如果我遗漏了电话号码，那么它就可以工作......如果我然后使用相同的表格进行更新并添加一个电话号码，一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-28T16:39:02.820

嵌套属性应作为数组传入：

```
"user"=>{
  "email"=>"test@blizzardlabs.com",
  "login"=>"bgarrison",
  "password"=>"[FILTERED]",
  "password_confirmation"=>"[FILTERED]",
  "profile_attributes"=>[
    {
      "prefix"=>"",
      "first_name"=>"Bill",
      "last_name"=>"Garrison",
      "suffix"=>"",
      "birthday"=>"1983-06-01",
      "phone_numbers_attributes"=>{
        "0"=>{
          "info"=>"1234567890",
          "label"=>"Cell"
        }
      }
    }
  ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T19:26:48.723

因此，经过几天的头撞墙后，我终于想通了。但是要理解它，我需要更好地解释我的模型。

基本上，从上面你可以看到一个用户有一个配置文件，它通过多态关联（:as => :contactable）有许多电话号码和地址。但是，contactable 实际上是一个名为 ContactInformation 的基类，它使用 STI 来包含所有类型的可联系信息。

有一次，我认为有 4 个额外的地址字段会混淆 STI 关系，但我仍然想保留它。我的解决方案是将所有这些字段序列化到 ContactInformation 的“信息”字段中。现在，电话号码只有“号码”作为序列化并存储到“信息”中的字段，但如果我想将它分成“区号”“分机”等，实现将很简单。

这导致了问题。在我的注册表单上，我在 phone_number 字段中使用了标签/信息，而不是标签/号码。我编辑了我的编辑表单，但没有编辑我的新表单（是的，我知道它们应该是相同的，但我有一个特殊的 ajax 表单用于编辑）。

这是 ContactInformation / PhoneNumber / Address 的代码

```
class ContactInformation < ActiveRecord::Base

  attr_accessible :contactable_id, :contactable_type, :info, :label, :type
  belongs_to :contactable, :polymorphic => true

end

class PhoneNumber < ContactInformation
  attr_accessible :number
  stash :number, in: :info

  #----------------------------------Validations--Start-------------------------
  validates :number, presence: true
  #----------------------------------Validations--End---------------------------
end

class Address < ContactInformation
  attr_accessible :street_address, :city, :state, :postal
  stash :street_address, :city, :state, :postal, in: :info

  #----------------------------------Validations--Start-------------------------
  validates :street_address, :city, :state, :postal, presence: true
  #----------------------------------Validations--End---------------------------
end 
```

# coffeescript - 在 for 循环中使用 CoffeeScript 字符串插值

> ID：15364207
> 
> 赞同：1
> 
> 时间：2013-03-12T14:37:42.900
> 
> 标签：coffeescript

我正在用基于 JSON 数据块的元素填充 html`<select>`列表。`<option>`我想通过使用字符串插值来整理我的代码，但我无法正确替换这些值。

这是有效的代码（无插值）：

```
$list
.empty()
.append('<option value="' + item.Id + '">' + item.Name + '</option>' for item in data) 
```

这是我想做的事情（不起作用）：

```
$list
.empty()
.append('<option value="#{item.Id}">#{item.Name}</option>' for item in data) 
```

这是我正在使用的 JSON 示例：

```
[
  {"Id":"1","Name":"Client-1"},
  {"Id":"2","Name":"Client-2"}
] 
```

替换不会发生，相反，我只是得到一个包含正确数量的`#{item.Name}`字符串的列表。

是否可以在这样的 for 循环中使用 CoffeeScript 字符串插值？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T14:44:30.050

字符串插值仅适用于双引号字符串，不适用于单引号字符串。

[http://coffeescript.org/#strings](http://coffeescript.org/#strings)

这应该有效：

```
$list
.empty()
.append("<option value=\"#{item.Id}\">#{item.Name}</option>" for item in data) 
```

# tomcat - Tomcat REALM 在某些情况下不进行身份验证

> ID：15364209
> 
> 赞同：2
> 
> 时间：2013-03-12T14:37:52.183
> 
> 标签：tomcat, authentication, tomcat7, jdbcrealm

我正在使用 Tomcat 7 和 Realm 使用 JDBC 进行身份验证。我扩展了 DataSourceRealm 以使用我们自己的实现。我的问题是，在某些情况下，Tomcat REALM 似乎没有调用 DataSourceRealm 中的任何方法，但从一开始就未能通过身份验证。这通常发生在用户通过身份验证时更改数据库中的密码时。在使用户无效并尝试再次登录后，无论我尝试使用什么密码，tomcat 都不会让我进入。只有重新启动 tomcat 才能解决此问题。

在 DataSourceRealm 类（扩展类）中放置断点我看到通常 tomcat 会调用 authenticate 方法，但在特殊情况下，TC 根本不会调用 DataSourceRealm 中的任何内容。为什么是这样？有某种缓存吗？对此没有任何记录。

还有一件事：多次将用户名字符更改为大写将起作用。所以我可以以管理员身份登录，但不能以管理员身份登录（使用 aDmin 它将按预期调用 DataSourceRealm），这让我确信用户以某种方式被缓存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T21:44:57.977

如果您在使用基本身份验证时遇到此问题，则**浏览器**会缓存凭据并尝试再次使用它们。

如果您验证一次，更改凭据，注销并尝试再次登录，浏览器将不会再次询问凭据，并且无法通过。

尝试关闭浏览器并再次打开页面，它应该再次询问登录名和密码。

# php - 合并数组形式

> ID：15364214
> 
> 赞同：0
> 
> 时间：2013-03-12T14:38:02.853
> 
> 标签：php, html, arrays, forms, submit

我有一个简单的表格，例如：

```
<tr data-good-id="1">
    <td><input type="text" name="good_id[item1]" value="1"/></td>
    <td><input type="text" name="size[item1]" value="XL"/></td>
    <td><input type="text" name="color[item1]" value="White"/></td>
    <td><input type="text" name="count[item1]" value="1"/></td>
</tr>
<tr data-good-id="2">
    <td><input type="text" name="good_id[item2]" value="2"/></td>
    <td><input type="text" name="size[item2]" value="L"/></td>
    <td><input type="text" name="color[item2]" value="Black"/></td>
    <td><input type="text" name="count[item2]" value="10"/></td>
</tr> 
```

我需要在提交后对表格的每一行执行此功能：

```
foo_func($good_id, $size, $color, $count); 
```

样本：

```
foo_func('1', 'XL', 'White', '1');
foo_func('2', 'L', 'Black', '10'); 
```

怎么做？我没想过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:41:50.370

假设数据是安全的......试试这个：

```
foreach ($_POST[good_id] as $index => $good_id) {
    foo_func($good_id, $_POST['size'][$index], $_POST['color'][$index], $_POST['count'][$index]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:47:52.237

我认为最好是一个项目包含它的属性，而不是包含项目的属性。像这样做：

```
<tr data-good-id="1">
    <td><input type="text" name="item[1][good_id]" value="1"/></td>
    <td><input type="text" name="item[1][size]" value="XL"/></td>
    <td><input type="text" name="item[1][color]" value="White"/></td>
    <td><input type="text" name="item[1][count]" value="1"/></td>
</tr>
<tr data-good-id="2">
    <td><input type="text" name="item[2][good_id]" value="2"/></td>
    <td><input type="text" name="item[2][size]" value="L"/></td>
    <td><input type="text" name="item[2][color]" value="Black"/></td>
    <td><input type="text" name="item[2][count]" value="10"/></td>
</tr> 
```

然后为每个项目运行你的函数

```
foreach ($item as $c_item) {
    foo_func($c_item['good_id'],$c_item['size'],$c_item['color'],$c_item['count']);
} 
```

# ajax - 即10个跨域ajax请求

> ID：15364215
> 
> 赞同：1
> 
> 时间：2013-03-12T14:38:04.023
> 
> 标签：ajax, internet-explorer-10

我开发了一个 Web 应用程序，它向与托管 Web 应用程序的服务器不同域中的服务器上的 Web 服务发出 ajax 请求。

我已将 Web 服务配置为进行飞行前检查以设置必要的标头以允许跨域请求。

在 Web 应用程序中，我使用 JQuery 客户端来访问 Web 服务。我已经在 J​​query 命令上设置了属性以允许跨域访问。

$.support.cors = 真；

在 Chrome 中，这一切都很好。然而，在 IE9 中，跨域行为只是部分成功。所有获取请求都有效。但是内容类型为 application/json 的 post 请求失败，因为 IE9 拒绝使用除 text/html 之外的任何 content-type 发出 post 请求。IE9 切换请求的内容类型，请求在服务器上失败，请求为 400 错误。

我读过 IE10 的跨域请求可以像在 Chrome 中一样工作。但是在刚刚测试之后，我发现 IE10 与 IE9 具有相同的行为。浏览器不会将 content-type 设置为 application/json。所以发布请求失败。

有谁知道在 IE10 中是否可以使用除 text/html 之外的其他内容类型进行跨域发布请求。这使得编写除了显示数据之外的其他任何事情的 Web 应用程序变得极其困难。

我需要对 Jquery 请求进行其他设置吗？还是在服务飞行前？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:05:06.633

您的 $.ajax() 调用是什么样的？您可以尝试添加`data: 'json'`到您的 JQuery 调用以强制数据类型为 json。您也不需要设置`$.support.cors = true;`，JQuery 应该为您解决这个问题（但现在可以保留它）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-13T16:15:12.157

我确实有内容类型参数集数据：'json'。Chrome 尊重这一点，但 IE 切换到 text/html。我读过这是 IE9 及以下版本中的一个已知问题，但 IE10 将使用与 Chrome 相同的 ajax 实现，但显然情况并非如此。

# php - fopen 返回什么？

> ID：15364216
> 
> 赞同：3
> 
> 时间：2013-03-12T14:38:06.783
> 
> 标签：php, file-io

在以下声明中：

```
$handle = fopen('./readme.txt'); 
```

什么变量是`$handle`？它是布尔值还是什么？

运行这两个不同的语句后，我有疑问：

```
if($handle) echo "File opened !"
else echo "Error opening the file !"; 
```

和

```
$line = fgets($handle); 
```

那么变量实际上是`$handle`什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T14:46:45.510

它返回 a`resource`或`boolean`false。资源被称为*特殊类型，在*[此处](http://www.php.net/manual/en/language.types.resource.php)详细说明

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T14:40:33.880

成功时返回文件指针资源，错误时返回 FALSE。

[http://php.net/manual/en/function.fopen.php](http://php.net/manual/en/function.fopen.php)

# ruby-on-rails - 循环在模型中创建多条记录

> ID：15364222
> 
> 赞同：0
> 
> 时间：2013-03-12T14:38:19.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, loops, models

我正在使用 Nokogiri 从网页中获取数据，到目前为止我可以保存到模型中的一列

```
def update_fixtures #rake task method
 Fixture.destroy_all
 get_fixtures.each {|match| Fixture.create(home_team: match )}
end

def get_fixtures # Get me all Home Teams
 doc = Nokogiri::HTML(open(FIXTURE_URL))
 home_team = doc.css(".team-home.teams").map {|h| h.text.strip }
end 
```

我想知道同时保存到 2、3 或 4 列的最有效方法

例如，我有另一个名为 away_team 的列，我会以与主队相同的方式对这些数据进行评分

```
away_team = doc.css(".team-away.teams").map {|a| a.text.strip } 
```

将其放在 get_fixtures 方法中是否可取？然后用类似的东西添加到 update_fixtures

```
def update_fixtures #rake task method
 Fixture.destroy_all
 get_fixtures.each {|match| Fixture.create(home_team: match, away_team: match )}
end 
```

尝试此操作后，相同的数据将发布到主队和客队列。在回读后我可以看到原因（我认为这是因为比赛只获取了 home_team 数据？）。我如何将客队的属性与主队一起传递？

这都是非常新的，因此感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:53:43.860

这不是正确的方法，因为变量`home_team`和`away_team`两者都使用相同的共同点`match`，因此您将获得相同的数据。

请执行下列操作：

更新：

**您的型号：**

```
 attr_accessible :home_team, :away_team

 def update_fixtures #rake task method
  Fixture.destroy_all
  doc = Nokogiri::HTML(open(FIXTURE_URL))

  home_team = doc.css(".team-home.teams").map {|h| h.text.strip }
  away_team = doc.css(".team-away.teams").map {|a| a.text.strip }

  Fixture.create(home_team: home_team, away_team: away_team)
 end 
```

# php - 可以从类别视图中隐藏 MediaWiki 命名空间吗？

> ID：15364223
> 
> 赞同：1
> 
> 时间：2013-03-12T14:38:20.000
> 
> 标签：php, mediawiki

我想使用 [[category:name]] 列出类别中的文章，但忽略某些命名空间中的文章，除非用户是某个组的成员。

这可能吗？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T23:49:21.920

我注意到您正在运行 1.20.2，它具有组 CSS 和 js 页面，例如`MediaWiki:Group-sysop.css`. 假设您要隐藏 Mediawiki 页面，请添加

```
.page-Category_CATEGORYNAME a[href*="MediaWiki"] {display:none;} 
```

，`MediaWiki:Common.css`然后添加

```
.page-Category_CATEGORYNAME a[href*="MediaWiki"] {display:inline !important;} 
```

到`MediaWiki:Group-sysop.css`. 不过，这确实留下了一个备用的要点，它只能用 javascript 删除，因为 CSS3 不支持选择父选择器。有关这方面的更多信息，请参见[此处](https://stackoverflow.com/questions/1014861/is-there-a-css-parent-selector)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T18:09:13.580

这是你要找的吗？[http://www.mediawiki.org/wiki/Extension:Hidden_​​pages](http://www.mediawiki.org/wiki/Extension:Hidden_pages)

# python - 在设定的时间内减少变量

> ID：15364225
> 
> 赞同：0
> 
> 时间：2013-03-12T14:38:22.540
> 
> 标签：python, python-2.7

我试图将变量减少 5，打印新变量，然后在 X 时间后再次增加变量并打印变量。它是一款基于文本的小型游戏，您可以在其中将一些人送走，但他们在一定时间内不会回来。

```
import time

TimeReturned = time.time() + 5
Survivors = 10

Test = raw_input("Run Script?")
if Test == "Yes":
    print Survivors
    if TimeReturned > time.time():
        Survivors -= 5
        print Survivors
    Survivors += 5
    print Survivors 
```

我得到的只是输出是 10、5、10，它根本不会延迟时间。这是我的第一个问题，如果含糊不清，非常抱歉。

1.  我做错了什么导致此代码立即返回变量？

2.  如果我想在脚本中执行其他操作，例如将剩余的幸存者送走，是否可以在此脚本运行时进行，还是需要等待 5 秒？

谢谢你的耐心：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:55:18.690

为了让您的脚本等待，请使用[`time.sleep(num_seconds)`](http://docs.python.org/2/library/time.html#time.sleep). [`time.time()`](http://docs.python.org/2/library/time.html#time.time)只返回当前时间；它根本不会让任何东西等待。

可能有一些代码处于休眠状态，而其他代码同时运行，做其他事情。但是，要做到这一点，您必须使用[线程](http://docs.python.org/2/library/threading.html)，这需要一些时间来适应。也许[本教程](http://www.tutorialspoint.com/python/python_multithreading.htm)会有用。

编辑：哦，也可以在没有线程的情况下执行此操作，但是您必须仔细跟踪变量。你的数学有点搞砸了。假设当 time.time() 为 1000 时，您的代码运行了。然后`TimeReturned`是 1005。假设用户输入 1 秒钟`Yes`。然后`if TimeReturned > time.time()`检查`if 1005 > 1001`，这是真的。您真正想要检查的是`if time.time() > TimeReturned`- 当前时间是否晚于`TimeReturned`.

此外，您的脚本不是交互式的，因此很难看到任何进展。尝试运行此脚本：

```
import time

survivors = 15
survivor_return_seconds = 10.0
time_survivors_left = None

while True:
    action = raw_input("Type 'x' to make survivors leave, ENTER to see how many are left: ")

    #check if survivors returned
    if time_survivors_left is not None:
        if time.time() >= time_survivors_left + survivor_return_seconds:
            survivors += 5
            time_survivors_left = None
            print "Survivors came back!"

    if action == 'x':
        if time_survivors_left is not None:
            print "Survivors already left! Wait a bit!"
        else:
            survivors -= 5
            time_survivors_left = time.time()

    print "There are %s survivors left." % (survivors,)
    if time_survivors_left is not None:
        print "5 survivors will return in %.2fs" % (
            time_survivors_left + survivor_return_seconds - time.time()) 
```

示例输出：

```
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 15 survivors left.
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 15 survivors left.
Type 'x' to make survivors leave, ENTER to see how many are left: x
There are 10 survivors left.
5 survivors will return in 9.99s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 9.05s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 7.66s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 6.45s
Type 'x' to make survivors leave, ENTER to see how many are left: x
Survivors already left! Wait a bit!
There are 10 survivors left.
5 survivors will return in 5.73s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 4.15s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 2.90s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 1.72s
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 10 survivors left.
5 survivors will return in 0.48s
Type 'x' to make survivors leave, ENTER to see how many are left: 
Survivors came back!
There are 15 survivors left.
Type 'x' to make survivors leave, ENTER to see how many are left: 
There are 15 survivors left.
Type 'x' to make survivors leave, ENTER to see how many are left: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:56:45.697

好吧...您没有做任何事情来使脚本停止并等待。

```
if TimeReturned > time.time(): 
```

这只是检查条件是否为真并相应地进行，它不会指示任何人等待。

您应该使用该`time.sleep(secs)`函数在所需的时间内停止代码的执行。

但是请注意，在睡眠期间，没有执行任何操作。所以，如果你想让一些后台进程继续运行，并且只有你提到的那些人等待，你应该在它自己的线程中运行脚本的那部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:34:02.843

你可以用`Timer`. 它运行指定的秒数，然后执行您指定的函数。A`Timer`只是使用第二个线程的一种简单方法，这就是它在`threading`模块中的原因。

```
from threading import Timer
import time

Survivors = 10

def increase_survivors():
    global Survivors
    Survivors += 5

# start execution
print Survivors
Survivors -= 5

t = Timer(5, increase_survivors)
t.start()
for i in range(10):
    print Survivors
    time.sleep(1) 
```

最后一点只是展示它是如何工作的。不过，管理变量的方法可能比该`global`语句更好 - 我相信我会得到一些建议。

# asp.net-mvc - 为什么将 EmailAddressAttribute 添加到属性会导致 EditorFor 失败？

> ID：15364226
> 
> 赞同：2
> 
> 时间：2013-03-12T14:38:23.363
> 
> 标签：asp.net-mvc, .net-4.5

我的模型对象上有一个名为`EmailAddress`. 我正在使用`Html.EditorFor`此页面上所有字符串属性的输入字段，以及一个可以正常工作的自定义编辑器模板。但是，在我添加`EmailAddressAttribute`到此属性的那一刻，EditorFor 似乎不再将该属性检测为字符串类型，或者至少，它拒绝使用我为字符串提供的编辑器模板。

这有效：

```
[DisplayName("EmailAddress")]
[Required(ErrorMessage = "Required")]
[StringLength(100, ErrorMessage = "Must be <= 100 characters.")]
public string EmailAddress { get; set; }

// and then in my view...
@Html.EditorFor(x => x.EmailAddress) 
```

这不会：

```
[DisplayName("EmailAddress")]
[Required(ErrorMessage = "Required")]
[StringLength(100, ErrorMessage = "Must be <= 100 characters.")]
[EmailAddress(ErrorMessage="Invalid email address.")]
public string EmailAddress { get; set; }

// and then in my view...
@Html.EditorFor(x => x.EmailAddress) 
```

在第二个示例中，使用了默认的字符串编辑器模板，而不是我自己的。同一模型上的其他属性使用正确的编辑器模板进行渲染。

我是否遗漏了一些明显的东西，或者这看起来像是一个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:40:35.880

该`[EmailAddress]`属性将属性的 DataType 设置为`EmailAddress`，这会导致`EditorFor()`查找`EmailAddress`模板。

# java - Android Web 视图中的本地存储有时不起作用

> ID：15364228
> 
> 赞同：2
> 
> 时间：2013-03-12T14:38:25.130
> 
> 标签：java, javascript, android, html, android-webview

我在 HTML5/Javascript 游戏中使用本地存储变量来存储游戏的高分。这很好用，没有任何问题。但是当我将游戏包装在 Android 应用程序的 Web 视图中时，有时会出现问题。

所以高分保存在本地存储中，但有时当我关闭应用程序并重新启动时，高分被重置。但有时高分还在？！

例如：我开始游戏，做一个高分，关闭应用程序，重新启动它，高分丢失，我关闭应用程序，重新启动它，仍然丢失它，我关闭它，重新启动它然后高分在那里。

Java中的代码：

```
 webSettings.setJavaScriptEnabled(true);
    webSettings.setDatabaseEnabled(true);
    mywebview.getSettings().setDatabasePath("/data/data/" + mywebview.getContext().getPackageName() + "/databases/");
    webSettings.setDomStorageEnabled(true); 
```

任何想法，是什么导致了问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:14:20.833

我现在使用 SharedPreferences 作为一种解决方法，通过 Javascript 接口存储我的高分。这很好用。

# asp.net-mvc - 列表中具有相同 id 的 2 个相同项目在视图中修改了 id 值

> ID：15364235
> 
> 赞同：1
> 
> 时间：2013-03-12T14:38:38.463
> 
> 标签：asp.net-mvc, razor

我有这个视图，我需要在其中显示两次相同的项目。所以我传递了我的模型列表，这个列表包含两次相同的项目。

这是我显示它们的方式：

```
<p>
    @using (Html.BeginForm("Confirm", "Inventory"))
    {

        <table>
        <tr>
            <th>Item Name</th>
               (...)
        </tr>
            @for (int i = 0; i < Model.Count; i++)
            {
                <tr>
                    <td>@Html.DisplayFor(x => x[i].OtrObj.ObjName)</td>
                    (...)

                    @Html.HiddenFor(x => x[i].OtrObjID)
                </tr>
            }
        </table>
        <div class="float-right">
            <input type="submit" value="Ready!"/>    
        </div>
    }
</p> 
```

我确信它发生在视图中，因为就在我发送视图时，列表中的每个项目都带有正确的“ObjID”。

但是当页面被渲染时，结果是这样的：

第 1 项：

```
<input data-val="true" data-val-number="The field OtrObjID must be a number." 
    data-val-required="The OtrObjID field is required." 
    name="[0].OtrObjID" type="hidden" value="1" /> 
```

第 2 项：

```
<input data-val="true" data-val-number="The field OtrObjID must be a number." 
    data-val-required="The OtrObjID field is required." 
    name="[1].OtrObjID" type="hidden" value="2" /> 
```

为什么？我真的不明白。谁能帮我解决这个问题？

以下是这些项目的 HTML 输出：

```
<p>
    <form action="/Inventory/Confirm" method="post">         
        <table>
            <tr>
                <th>Item Name</th>
                ...
            </tr>
                <tr>
                    <td>Item one</td>

                    <td><input checked="checked" class="state1" name="[0].Destination" style="width: 50px" type="radio" value="State 1" /></td>
                    <td><input class="state2" name="[0].Destination" style="width: 50px" type="radio" value="State 2" /></td>
                    <td>
                        <input class="field1" data-val="true" data-val-number="The field m_Field1 must be a number." data-val-required="The m_Field1 field is required." name="[0].m_Field1" style="width:200px" type="text" value="0,99" />
                        <span class="field-validation-valid" data-valmsg-for="[0].m_Field1" data-valmsg-replace="false">Field 1 must be a number.</span>
                    </td>
                    <td>
                        <input class="field2" data-val="true" data-val-number="The field m_Field2 must be a number." data-val-required="The m_Field2 field is required." name="[0].m_Field2" style="width:200px" type="text" value="1,00" />
                        <span class="field-validation-valid" data-valmsg-for="[0].m_Field2" data-valmsg-replace="false">Field 2  must be a number.</span>
                    </td>
                    <td>
                        <input class="field3" data-val="true" data-val-number="The field m_Field3 must be a number." data-val-required="The m_Field3 field is required." name="[0].m_Field3" style="width:200px" type="text" value="1,00" />
                        <span class="field-validation-valid" data-valmsg-for="[0].m_Field3" data-valmsg-replace="false">Field 3 must be a number.</span>
                    </td>
                    <td><a href="/Inventory/DisplayItem/2">See other information</a></td>

                    <input data-val="true" data-val-number="The field OtrObjID must be a number." data-val-required="The OtrObjID field is required." name="[0].OtrObjID" type="hidden" value="1" />
                    <input data-val="true" data-val-number="The field ObjID must be a number." data-val-required="The ObjID field is required." name="[0].ObjID" type="hidden" value="1" />
                    <input name="[0].m_Field1" type="hidden" value="0,99" />
                    <input name="[0].m_Field2" type="hidden" value="1,00" />
                    <input name="[0].m_Field3" type="hidden" value="1,00" />
                </tr>
                <tr>
                    <td>Item 2</td>

                    <td><input checked="checked" class="state1" name="[1].Destination" style="width: 50px" type="radio" value="State 1" /></td>
                    <td><input class="state2" name="[1].Destination" style="width: 50px" type="radio" value="State 2" /></td>
                    <td>
                        <input class="field1" data-val="true" data-val-number="The field m_Field1 must be a number." data-val-required="The m_Field1 field is required." name="[1].m_Field1" style="width:200px" type="text" value="0,99" />
                        <span class="field-validation-valid" data-valmsg-for="[1].m_Field1" data-valmsg-replace="false">Field 1 must be a number.</span>
                    </td>
                    <td>
                        <input class="field2" data-val="true" data-val-number="The field m_Field2 must be a number." data-val-required="The m_Field2 field is required." name="[1].m_Field2" style="width:200px" type="text" value="1,00" />
                        <span class="field-validation-valid" data-valmsg-for="[1].m_Field2" data-valmsg-replace="false">Field2 must be a number.</span>
                    </td>
                    <td>
                        <input class="field3" data-val="true" data-val-number="The field m_Field3 must be a number." data-val-required="The m_Field3 field is required." name="[1].m_Field3" style="width:200px" type="text" value="1,00" />
                        <span class="field-validation-valid" data-valmsg-for="[1].m_Field3" data-valmsg-replace="false">Field 3 must be a number.</span>
                    </td>
                    <td><a href="/Inventory/DisplayItem/2">See other information</a></td>

                    <input data-val="true" data-val-number="The field OtrObjID must be a number." data-val-required="The OtrObjID field is required." name="[1].OtrObjID" type="hidden" value="2" />
                    <input data-val="true" data-val-number="The field ObjID must be a number." data-val-required="The ObjID field is required." name="[1].ObjID" type="hidden" value="2" />
                    <input name="[1].m_Field1" type="hidden" value="0,99" />
                    <input name="[1].m_Field2" type="hidden" value="1,00" />
                    <input name="[1].m_Field3" type="hidden" value="1,00" />
                </tr>
        </table>
        <div class="float-right">
            <input type="submit" value="Ready!"/>    
        </div>
    </form>
</p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:35:09.567

“问题”是你有`@model IEnumerable<Model>`这会强制`[#]`前缀。

~~一种可能的解决方案是将模型包装在 ViewModel 中。~~

 ~~```
public class ViewModel
{
    public IEnumerable<Model> Models { get; set; }
} 
```~~ 

~~然后使用`@model ViewModel`~~

我还想建议使用它，`@foreach`因为它更清洁。

```
@foreach (var item in Model.Models) {
    <tr>
        <td>
            @Html.DisplayFor(x => item.ObjName)
            (...)
            @Html.HiddenFor(x => item.OtrObjID)
        </td>
    </tr>
} 
```

**注意**：我把所有东西都放在里面，因为它不是有效的 HTML，在标签`<td>`之外`<td>`或`<th>`里面有任何东西。[http://www.w3schools.com/tags/tag_tr.asp](http://www.w3schools.com/tags/tag_tr.asp)`<tr>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:07:46.333

您可以使用简单的 html 隐藏字段控件

```
<input type="hidden" value="x[i].OtrObjID" name="OtrObjID" /> 
```

# java - 随机生成器返回 null

> ID：15364237
> 
> 赞同：2
> 
> 时间：2013-03-12T14:38:48.750
> 
> 标签：java, random

我正在使用 BlueJ 中的 Java 程序，并且我正在使用伪随机生成器来生成最大数和最小数之间的随机数。我没有收到任何语法错误，但是当我调用该方法时，它说它是空的。有人有什么主意吗？我已经导入了 Random 类，它在构造函数中被称为 randomizer。

```
public void attackEnemy()
{
    int damage = 0;
    int max = 41;
    int min = 20;
    damage = randomizer.nextInt(max - min) + min;
    health = health - damage;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:40:13.527

你做了这个了吗？

```
randomizer = new Random(); 
```

`null`显示的片段中唯一可以包含的值是`randomizer`对象。您应该在正在使用的类中的其他地方实例化它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:40:44.660

像这样初始化你的`randomizer`： -

```
randomizer = new Random(); // Without this, it'll throw a NPE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T17:53:12.127

您需要说明随机数发生器实际上是随机数。在您的原始代码中看起来您还没有完全完成计算。看看下面：

```
public void attackEnemy(){

int max = 41;
int min = 20;
Random randomizer = new Random();

int damage = min + (max - min) * randomizer.nextInt();
health = health - damage;
} 
```

我还认为您收到空输出的原因是因为您没有返回任何内容。因此，您还可以将其显示如下：

```
public int attackEnemy(){

int max = 41;
int min = 20;
Random randomizer = new Random();

int damage = min + (max - min) * randomizer.nextInt();
health = health - damage;

return health;
} 
```

# versioning - Marklogic：DLS-INVALIDVERSION

> ID：15364241
> 
> 赞同：1
> 
> 时间：2013-03-12T14:38:55.397
> 
> 标签：versioning, updating, marklogic, document-management, document-versioning

当尝试访问我的托管`XML`文件的旧版本时，它给了我类似的东西：

```
DLS-INVALIDVERSION: (err:FOER0000) /company/1448220.xml has no version number 3
in /MarkLogic/dls.xqy, at 1403:6, ... 
```

**实际上， /company/1448220_xml_versions**中版本 1、2、3 的文件不存在（在这种情况下，假设版本 4 是最新的）。

使用`dls`（文档管理）功能更新文档时，我运行以下任务：

> 1.  检查文档是否被管理
> 2.  当它不受管理时，设置为`dls:document-manage($uri, fn:false())`在 eval 语句中使用管理
> 3.  `dls:document-checkout-update-checkin($uri, $new-doc, "Document update", fn:true())`使用eval 语句内部更新文档

到现在为止还挺好。

在获取特定版本的文档时：

> 1.  dls:document-version($document-uri, xs:unsignedInt($version))
> 
> ==> 使用 $version := 4 时，它给了我一个有效的文档（这又是最新版本）
> 
> ==> 当使用 $version := 1 时，它只会给我一个错误，表明版本 1 的文档不存在。

我做错了什么？

我正在使用 MarkLogic 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:00:40.033

您可能尚未使用 设置保留策略`dls:retention-rule-insert`，并且默认保留规则不保留任何内容（这意味着`MarkLogic`每次存储新版本时都会删除给定文档的所有旧版本）。[请参阅此处的](http://docs.marklogic.com/guide/app-dev/dls#id_91470)**MarkLogic 应用程序开发人员指南**中的“**定义保留策略**”部分。

# jaxb - 使用 Jaxb 将对象转换为 XML 时出现 IllegalAnnotationExceptions

> ID：15364242
> 
> 赞同：1
> 
> 时间：2013-03-12T14:38:56.313
> 
> 标签：jaxb

我有一`TrainingCalendarWrapper`堂课，里面有一个列表`TrainingCalendarVO`。在我的应用程序中，我正在设置详细信息，`TrainingCalendarVO`然后添加到`trainingList`of`TrainingCalendarWrapper` 然后转换`TrainingCalendarWrapper` 为`XML`using `Jaxb`。

```
@XmlRootElement
 public class TrainingCalendarWrapper implements Serializable
   {
      public ArrayList<TrainingCalendarVO> trainingList;
      Getters & Setters for trainingList
   } 
```

*1个非法AnnotationException类的计数有两个同名的属性“trainingList”对于下面的代码行* `JAXBContext jaxbContext = JAXBContext.newInstance(TrainingCalendarWrapper.class);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:48:42.253

如果要注释字段（实例变量），则需要`@XmlAccessorType(XmlAccessType.FIELD)`在类级别指定。否则，您可以将注释添加到`get`or`set`方法。

*   [http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html](http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html)

# asp.net - 尽管在 asp.net 的 updatepanel 中，控制应该完全回发

> ID：15364243
> 
> 赞同：0
> 
> 时间：2013-03-12T14:38:57.253
> 
> 标签：asp.net

我有一个更新面板。在这里面我有几个控件，但问题是我有一个用于搜索 snagcode 的文本框，我将 jquery 自动完成插件应用到它。第一次页面加载它工作正常，但在此之后就不行了，这很明显，因为它放在更新面板内但我需要逐个搜索snadcode，我无法将文本框移到更新面板之外。我应该怎么办 ？专家的任何建议都值得期待。这是我下面的布局...

```
<asp:UpdatePanel ID="updatepnlForSnagDefinationPATQA" runat="server">
            <ContentTemplate>
                <table width="100%" class="table table-stripe">
                    <tr>
                        <td>
                            Snag Code:
                        </td>
                        <td>
                            <asp:TextBox ID="txtSnagCode" runat="server" AutoCompleteType="Search" ClientIDMode="Static"> </asp:TextBox>
                            <asp:LinkButton ID="lnkbtnFind" runat="server" CssClass="btn btn-info" OnClick="lnkbtnFind_Click"><i class="icon-search icon-white"></i>&nbsp;Search</asp:LinkButton>
                        </td>
                    </tr>
                    <tr>
                        /// Some other controls here....
 </table>
            </ContentTemplate>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="txtSnagCode" />
            </Triggers>
        </asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:43:21.103

在你的aspx页面中试试这个

```
<script></script> 
```

可能会有所帮助

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function (sender, e) {
       // Put your valueable code here [Between postbacks]
    }); 
```

# php - 如何获得 5 天的雅虎天气预报

> ID：15364248
> 
> 赞同：1
> 
> 时间：2013-03-12T14:39:12.603
> 
> 标签：php, xml, rss, yahoo-weather-api

我一直在为我的网站制作天气提要。

我目前只能获得未来 2 天的预测。我想要未来 5 天的预测。

这是我的代码：

```
$ipaddress = $_SERVER['REMOTE_ADDR'];
$locationstr = "http://api.locatorhq.com/?user=MYAPIUSER&key=MYAPIKEY&ip=".$ipaddress."&format=xml";

$xml = simplexml_load_file($locationstr);

$city = $xml->city;

switch ($city)
{
    case "Pretoria":
        $loccode = "SFXX0044";

        $weatherfeed = file_get_contents("http://weather.yahooapis.com/forecastrss?p=".$loccode."&u=c");
        if (!$weatherfeed) die("weather check failed, check feed URL");
        $weather = simplexml_load_string($weatherfeed);

        readWeather($loccode);
        break;
}

function readWeather($loccode)
{
    $doc = new DOMDocument();
    $doc->load("http://weather.yahooapis.com/forecastrss?p=".$loccode."&u=c");

    $channel = $doc->getElementsByTagName("channel");

    $arr;
    foreach($channel as $ch)
    {
        $item = $ch->getElementsByTagName("item");
        foreach($item as $rcvd)
        {
            $desc = $rcvd->getElementsByTagName("description");

            $_SESSION["weather"] = $desc->item(0)->nodeValue;
        }
    }
} 
```

我想请您注意查询天气的行：

```
$doc = new DOMDocument();
$doc->load("http://weather.yahooapis.com/forecastrss?p=".$loccode."&u=c");

// url resolves to http://weather.yahooapis.com/forecastrss?p=SFXX0044&u=c in this case 
```

搜索谷歌，我发现[这个链接](http://developer.yahoo.com/forum/General-Discussion-at-YDN/Yahoo-Weather-5-day-Forecast/1228762478000-84d25277-b9c6-35c0-8c54-c487a5093090)建议我改用这个网址：

```
$doc->load("http://xml.weather.yahoo.com/forecastrss/SFXX0044_c.xml"); 
```

虽然这也有效，并且我在 XML 文件中看到了 5 天的预测，但我仍然在我的网站上看到了 2 天的预测。

我有一种感觉，这是因为我正在利用`channel`RSS 提要中的子元素，而 XML 提要没有这样的子元素。

如果有人可以在这里提供任何见解，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:43:52.617

这就是我问得太早的问题...

当我再次查看我的代码时，我注意到我两次引用了 yahooapis URL：一次在 switch 中，一次在 readWeather 中。

根据提到的线程删除了多余的引用并更新了 url，我发现它现在可以工作了。

请参阅更新的代码以供参考：

```
switch ($city)
{
    case "Pretoria":
        $loccode = "SFXX0044";

        readWeather($loccode);
        break;
}

function readWeather($loccode)
{
    $doc = new DOMDocument();
    $doc->load("http://xml.weather.yahoo.com/forecastrss/".$loccode."_c.xml");

    $channel = $doc->getElementsByTagName("channel");

    $arr;
    foreach($channel as $ch)
    {
        $item = $ch->getElementsByTagName("item");
        foreach($item as $rcvd)
        {
            $desc = $rcvd->getElementsByTagName("description");

            $_SESSION["weather"] = $desc->item(0)->nodeValue;
        }
    }
} 
```

# scala - 如何从 Vector 中删除元素？

> ID：15364252
> 
> 赞同：1
> 
> 时间：2013-03-12T14:39:19.517
> 
> 标签：scala, collections, vector, immutability, trie

这就是我现在正在做的事情：

```
 private var accounts = Vector.empty[Account]

  def removeAccount(account: Account)
  {
    accounts = accounts.filterNot(_ == account)
  } 
```

有没有更易读的解决方案？理想情况下，我想写`accounts = accounts.remove(account)`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:47:47.147

不幸的是没有，更糟糕的是（也许），如果同一个帐户出现两次，`filterNot`将删除它们。我唯一能提供的可读性就是使用

```
accounts.filter(_ != account) 
```

另一种可能性是使用具有删除操作的集合类型，例如 a `TreeSet`（它被称为`-`）。如果您无论如何都没有重复的条目，那么 a`Set`完全可以。（当然，对于某些操作来说它比较慢，但它可能更适合应用程序——它在删除单个条目时更有效；`filterNot`你基本上必须重新构建整个条目`Vector`。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T16:25:01.387

我会用这个：

```
accounts filterNot account.== 
```

这对我来说读起来很好，但是ymmv。我也想要一个`count`不带谓词的，但是集合库确实缺乏专门的方法，其中一个带有谓词的方法可以概括操作。

在 2.8.x 之前，由于语义问题，有一种方法 iirc 被弃用了*。*`-`如果我的记忆对我有用，它实际上可能会在 2.10 恢复，但事实并非如此。**编辑：**我检查了它，发现它`-`现在保留给一个*可变*方法，该方法修改它所应用的集合。我完全赞成`-:`/`:-`尽管在序列上，在其中删除第一个或最后一个元素等于某物是有意义的。有人愿意为此买票吗？我会赞成。:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-12T17:06:09.980

你可以这样做：

```
def removeFirst[T](xs: Vector[T], x: T) = {
  val i = xs.indexOf(x)
  if (i == -1) xs else xs.patch(i, Nil, 1)
} 
```

然后

```
accounts = removeFirst(accounts, account) 
```

不过，我认为问题的关键在于 a`Vector`可能不是您想要取出的一*组*`Set`项目的正确集合类型（提示：try ）。如果您想对 ID 或插入索引进行索引，那么`Map`可能就是您所追求的（它确实有一个`-`方法）。如果你想有效地索引多个事物，你需要一个数据库！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-12T15:28:01.853

您可以使用`diff`为所有序列定义的方法。它计算两个序列之间的多重集差异 - 这意味着它将根据需要删除尽可能多的元素。

```
Vector(1, 2, 1, 3, 2).diff(Seq(1)) => 
Vector(2, 1, 3, 2)

Vector(1, 2, 1, 3, 2).diff(Seq(1, 1)) =>
Vector(2, 3, 2)

Vector(1, 2, 1, 3, 2).diff(Seq(1, 1, 2))  
Vector(3, 2) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T15:16:23.833

如果你不想使用`filterNot`闭包，你可以使用更详细但更明确的理解风格。

```
private var accounts = Vector.empty[Account]

def removeAccount(account: Account)
{
    accounts = for { a <- accounts
                     if a != account } yield { a }
} 
```

在这种情况下是否感觉更好，这是个人喜好问题。

当然，对于涉及嵌套 flatMaps 等的更复杂的表达式，我同意 Martin Odersky 的建议，即 for-comprehensions 可以更容易阅读，尤其是对于新手而言。

# iphone - 如何在没有打印选项对话框的情况下使用 UIPrintInteractionController 进行打印

> ID：15364256
> 
> 赞同：3
> 
> 时间：2013-03-12T14:39:31.493
> 
> 标签：iphone, ios, objective-c, ipad, options

我正在尝试使用 wi-fi 打印机打印照片而不显示打印选项对话框我想按下按钮并打印。如何禁用“打印选项”对话框？

我正在使用以下代码：

```
UIPrintInteractionController *printController = [UIPrintInteractionController sharedPrintController];
printController.printingItem = imageFromCurrentView;
UIPrintInfo *printInfo = [UIPrintInfo printInfo];
printInfo.outputType = UIPrintInfoOutputGrayscale;
printController.printInfo = printInfo;
printController.showsPageRange = YES;
[printController presentAnimated:YES completionHandler:completionHandler]; 
```

# node.js - 使用生成器角度为 Yeoman 自动化“npm install && bower install --dev”

> ID：15364259
> 
> 赞同：0
> 
> 时间：2013-03-12T14:39:40.887
> 
> 标签：node.js, npm, yeoman

我试图弄清楚如何`npm install && bower install --dev`在 Yeoman 的角度生成器生成角度脚手架结束时实现自动化，并且没有找到任何与我的问题完全匹配的信息。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T20:05:23.600

运行它，它将在完成脚手架后立即安装 npm 和 bower deps：

`yo angular && npm install && bower install --dev`

你也可以在你的`.bashrc`, `.bashprofile`,`.zshrc`文件中创建一个 shell 别名：

`alias ya='yo angular && npm install && bower install --dev'`

然后只需重新启动终端并输入`ya`.

# java - JAXB 没有为包含生成的 Java 类的类生成所需的模式？

> ID：15364263
> 
> 赞同：3
> 
> 时间：2013-03-12T14:39:49.173
> 
> 标签：java, xml, xsd, jaxb

我有这门课

```
@XmlRootElement
public class GpsDataRequest{

    //definition of variables

    @XmlElement(required=true, type=GpxType.class)
    public GpxType getGpxRoot() {
        return gpxRoot;
    }

    @XmlElement(required=true, type=JourneyXML.class)
    public JourneyXML getJourneyPlanRoot() {
        return journeyPlanRoot;
    }

    @XmlElement(required=true)
    public String getSecurityToken() {
        return securityToken;
    }

    @XmlElement(required=true)
    public UUID getUuid() {
        return uuid;
    }
} 
```

当我使用此代码生成架构时：

```
public class SchemaGenerator {

    public static void main(String[] args)
    {
        try {
            JAXBContext context=
                    JAXBContext.newInstance(GpsDataRequest.class);
            SchemaOutputResolver sor =new DemoSchemaOutputResolver();
            context.generateSchema(sor);

        } catch (JAXBException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    public static class DemoSchemaOutputResolver extends SchemaOutputResolver {

           @Override
           public Result createOutput(String namespaceUri, String suggestedFileName)
                 throws IOException {

              // create new file
              File file = new File("request.xsd");

              // create stream result
              StreamResult result = new StreamResult(file);

              // set system id
              result.setSystemId(file.toURI().toURL().toString());

              // return result
              return result;
           }
        }

} 
```

我得到的只是 GpxType 类的 XSD。这是为什么？

只是让您知道，GpxType 和 JourneyXML 是从 XSD 文件生成的。

如何强制执行此操作以生成我需要的适当 XSD？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:25:48.977

尝试更改您的`createOutput`方法以不总是写入`request.xsd`文件。我相信您的模型中有多个命名空间，因此会生成多个 XML 模式。

```
@Override
public Result createOutput(String namespaceUri, String suggestedFileName) throws IOException {

      // create new file
      File file = new File(suggestedFileName);

      // create stream result
      StreamResult result = new StreamResult(file);

      // set system id
      result.setSystemId(file.toURI().toURL().toString());

      // return result
      return result;
   } 
```

# c# - C# DragDrop 从 toolStrip

> ID：15364264
> 
> 赞同：3
> 
> 时间：2013-03-12T14:39:50.860
> 
> 标签：c#, drag-and-drop, toolstrip

我正在寻找一种方法来确定在 DragDrop 事件发生后拖动的 toolStrip 中的哪个项目，我要做的就是为工具条中的每个项目制作一个具有不同案例的 switch case，但我似乎找不到比较它们的方法。

**更新：短代码示例**

```
private void toolStrip1_DragDrop(object sender, DragEventArgs e)
{
    //Here I want something like a DoDragDrop() and send the specific item from the
    //toolstrip..
}

private void panel1_MouseUp(object sender, MouseEventArgs e)
{
    //And here some way to determine which of the items was dragged 
    //(I'm not completely sure if I need a mouseUp event though..)
} 
```

希望更容易得到我想要做的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:55:49.900

您示例中的事件看起来不像要使用的正确事件。

这是一个来自 ToolStrip 的工作示例，上面有 2 个 ToolStripButtons：

```
public Form1() {
  InitializeComponent();
  toolStripButton1.MouseDown += toolStripButton_MouseDown;
  toolStripButton2.MouseDown += toolStripButton_MouseDown;

  panel1.DragEnter += panel1_DragEnter;
  panel1.DragDrop += panel1_DragDrop;
}

void toolStripButton_MouseDown(object sender, MouseEventArgs e) {
  this.DoDragDrop(sender, DragDropEffects.Copy);
}

void panel1_DragEnter(object sender, DragEventArgs e) {
  e.Effect = DragDropEffects.Copy;
}

void panel1_DragDrop(object sender, DragEventArgs e) {
  ToolStripButton button = e.Data.GetData(typeof(ToolStripButton))
                           as ToolStripButton;
  if (button != null) {
    if (button.Equals(toolStripButton1)) {
      MessageBox.Show("Dragged and dropped Button 1");
    } else if (button.Equals(toolStripButton2)) {
      MessageBox.Show("Dragged and dropped Button 2");
    }
  }
} 
```

# python - 'ascii' 编解码器无法在位置 * 或不在范围内编码字符（128）

> ID：15364266
> 
> 赞同：10
> 
> 时间：2013-03-12T14:39:51.230
> 
> 标签：python, unicode, decode, encode

stackoverflow 上有几个线程，但我找不到整个问题的有效解决方案。

我从 urllib 读取函数中收集了大量文本数据，并将其存储在 pickle 文件中。

现在我想将此数据写入文件。在写作时，我遇到了类似的错误 -

```
'ascii' codec can't encode character u'\u2019' in position 16: ordinal not in range(128) 
```

并且大量数据正在丢失。

我想从 urllib 读取的数据是字节数据

我试过了

```
 1\. text=text.decode('ascii','ignore')
   2\. s=filter(lambda x: x in string.printable, s)
   3\. text=u''+text
      text=text.decode().encode('utf-8') 
```

但我仍然会遇到类似的错误。有人可以指出一个适当的解决方案。并且编解码器也会剥离工作。如果冲突字节没有作为字符串写入文件，我没有问题，因此接受丢失。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-12T14:54:12.143

您可以通过模块来`smart_str`完成。`Django`试试这个：

```
from django.utils.encoding import smart_str, smart_unicode

text = u'\u2019'
print smart_str(text) 
```

您可以通过以管理员权限启动命令 shell 并运行以下命令来安装 Django：

```
pip install Django 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-12T14:42:30.087

您的数据是*unicode*数据。要将其写入文件，请使用`.encode()`：

```
text = text.encode('ascii', 'ignore') 
```

但这会删除任何不是 ASCII 的东西。也许您想编码为更合适的编码，例如 UTF-8？

你可能想阅读 Python 和 Unicode：

*   [每个软件开发人员绝对、绝对必须了解 Unicode 和字符集（没有任何借口！）](http://joelonsoftware.com/articles/Unicode.html)作者：Joel Spolsky

*   Python [Unicode HOWTO](http://docs.python.org/2/howto/unicode.html)

*   Ned Batchelder 的[实用 Unicode](http://nedbatchelder.com/text/unipain.html)

# node.js - 如何使用 node-http-proxy 代理 Wordpress，我的 wordpress 重定向到不同的端口

> ID：15364267
> 
> 赞同：0
> 
> 时间：2013-03-12T14:39:53.083
> 
> 标签：node.js, node-http-proxy

我想代理托管在 localhost 的 8888 端口的 Wordpress。

当我按如下方式 http://localhost:8001/ 访问此节点-http-proxy 时，它会重定向到 http://localhost:8888/。我的意思是 Wordpress 会进行重定向，因为 Wordpress 认为它​​在端口 8888 上。

我怎样才能正确地反向代理呢？

```
var util = require('util'),
    http = require('http'),
    httpProxy = require('http-proxy');

//
// Create a new instance of HttProxy to use in your server
//
var proxy = new httpProxy.RoutingProxy();

http.createServer(function (req, res) {
  proxy.proxyRequest(req, res, {
    host: 'localhost',
    port: 8888
  });
}).listen(8001); 
```

这个问题有帮助吗？[https://github.com/nodejitsu/node-http-proxy/pull/376](https://github.com/nodejitsu/node-http-proxy/pull/376)但我不明白如何使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:47:58.663

我怀疑您需要进入您的 wordpress 管理设置并将站点 URL 参数设置为`http://localhost:8001`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2018-03-17T14:19:54.500

在 wp-config.php 中定义`WP_SITEURL`和`WP_HOME`指向代理 url。

例如。，

```
define('WP_SITEURL', 'http://example.com/blog/');
define('WP_HOME', 'http://example.com/blog/'); 
```

# javascript - 编辑完成后隐藏或关闭 dijit.editor

> ID：15364269
> 
> 赞同：0
> 
> 时间：2013-03-12T14:39:58.373
> 
> 标签：javascript, dojo

你能告诉我编辑完成后如何隐藏或关闭 dijit 编辑器.. 我使用了自动扩展 dijit.editor.. 所以当我点击 div 时，编辑器会打开.. 所以在编辑我的内容后我无法关闭/隐藏编辑器以再次取回包含更新/编辑内容的 div。你能帮我发布隐藏或关闭编辑器的代码吗？

```
enter code here
<script>
dojo.addOnLoad(function(){
var editor = dijit.byId("myEditor");
editor .onLoadDeferred.addCallback(function(){
editor.attr("value", "<b>This is new content.</b>");
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:43:52.013

I don't think you can really "close" the editor to get back to a plain div. I suggest that when the user is "done editing" (using onBlur or whatever), you extract the value as HTML, destroy the editor, and re-insert the extracted HTML. Something like this:

```
var parentNode = editor.domNode.parentNode;
var updatedContent = editor.get("value");
editor.destroyRecursive();
dojo.place(updatedContent, parentNode); 
```

# mysql - vb 6 执行存储过程时出错

> ID：15364271
> 
> 赞同：1
> 
> 时间：2013-03-12T14:40:05.270
> 
> 标签：mysql, stored-procedures, vb6, xampp, runtime-error

我有一个调用驻留在 MYSQL 数据库中的存储过程的 vb 6 程序。当我尝试在两台不同的计算机上测试这个时，它在计算机 1 中工作，但在计算机 2 中出现错误。

这些计算机具有：

*   相同的 php 和 mysql 版本（xampp）

*   相同的 odbc 3.51 驱动程序

*   相同的存储过程

*   相同的代码

*   两个 Windows 7 32 位操作系统

这是错误：

```
Run-time error -2147217900(80040e14)
[MySQL][ODBC 3.51 Driver][mysqld 5.1.41] You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right syntax to     
use '{ call Selectproducts}' at line 1. 
```

'selectproducts' 是我的存储过程的名称。我在谷歌上搜索过这个，但这个错误没有任何相同之处。

你能帮我解决这个问题吗？我真的不知道我的电脑有什么问题2。

SP代码：

```
DROP PROCEDURE `selectproducts`//
CREATE DEFINER=`root`@`localhost` PROCEDURE `selectproducts`()
begin
select * from products;
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T06:15:43.943

可能是病毒。重新安装您的 xampp、VB6 和驱动程序。然后再次测试，比较computer1和computer2的日志文件。如果一切都相同，请务必仔细查看代码。不要忘记仔细检查您的存储过程。

# meteor - 如何在 Meteor 中显示相关的子文档属性

> ID：15364275
> 
> 赞同：0
> 
> 时间：2013-03-12T14:40:20.340
> 
> 标签：meteor

我是 Meteor/MongoDB 的新手，我正在尝试使用这样的东西来描述一个用户和他在一个流星项目中的东西：

```
{ _id: whatever,
  name: "John Doe",
  myToys: [ {toy_id: "truck",
             quantity: 2},
            {toy_id: "legoset",
             quantity: 4} ]
} 
```

我有另一个集合，其中包含所有这些 toy_id 及其属性（制造商、流行度等以及其他可能稍后更改的属性，这就是为什么我将它放在单独的集合中）。

我将如何最好地在流星中对其进行编码并将其模板化以遍历特定用户的玩具子文档数组并仍然显示每个玩具的相关属性？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:47:00.917

我们可以用 来识别登录用户`Meteor.userId`，所以如果你存储了这个 id 来识别你的玩具收藏中每个人的玩具，这样用户在使用时就可以知道哪些玩具是他的`Toys.find({})`

您可以为您的[模板助手](http://docs.meteor.com/#template_call)执行此操作。

```
Template.home.toys = function() {
    return Toys.findOne({user:Meteor.userId});
} 
```

接下来，您可以使用[把手在模板中循环遍历它](http://handlebarsjs.com/)

```
<template name="home">
    Name: {{name}}
    {{#each toys.myToys}}
       Toy Id: {{toy_id}}
       Toy Quantity: {{quantity}}
    {{/each}}
</template> 
```

# android - Android WebView 和 NO_FAST_DRAW = false

> ID：15364281
> 
> 赞同：1
> 
> 时间：2013-03-12T14:40:38.153
> 
> 标签：android

我正在测试一个在 url 更改时打开一个新选项卡的网站。我正在尝试在 Web 视图中打开该网站并在同一视图中重新加载内容（不打开差异选项卡）。

它确实会加载新内容并引发错误的敌人特定事件。

这是未打开的网址之一

```
http://xxx.net/abcd/tablet/tocSelector.html?VERSION=CURRENT&DOCNBR=757_AARD&DOCTYPE=SRM&MODEL=G123&PAGEKEY=TOC

03-12 09:09:02.060: V/webview(4731): NO_FAST_DRAW = false
03-12 09:09:02.500: V/webview(4731):  singleCursorHandlerTouchEvent -getEditableSupport  FASLE 
```

怎样才能使所有 url 在单个 webview 中打开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T03:07:01.993

```
private class ChromeClient extends WebChromeClient {
   @Override
   public void onProgressChanged(WebView view, int newProgress) {
      YourActivity.this.setProgress(newProgress * 1000);
   }
}
webview.setWebChromeClient(new ChromeClient()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T10:48:41.457

我也面临同样的问题。在下面的第一行，我收到错误“Android WebView and NO_FAST_DRAW = false”。换到二线后。有效。错误出现在 createCustomAlert('wpt') 处。所以我被称为的函数看起来像一个字符串。这个错误来了。所以请检查函数调用的地方

onclick = 'createCustomAlert('wpt')'

onclick = 'createCustomAlert(3)'

# asp.net - 将图像从 Wep Api 服务传递到另一个 Web Api 服务

> ID：15364288
> 
> 赞同：3
> 
> 时间：2013-03-12T14:40:52.583
> 
> 标签：asp.net, asp.net-web-api

出于安全原因，我正在构建两个 Web Api 服务。第一个 Web Api 应用程序将有权访问图像生成服务，并将充当安全代理。第二个 Web Api 应用程序将从 Internet 调用第一个应用程序并检索图像。

但是，我似乎无法正确协商图像的通过。我的想法是让安全代理 Web API 获取图像，然后将其作为字节数组传递给我的其他服务，这将允许用户下载图像。但是，当我的浏览器尝试打开图像时，它总是损坏。

这是获取图像的安全代理，我知道这是成功的：

```
public byte[] Get(string invoice, string Customer)
    {
        object image;
        try
        {
            image = _repo.GetImage(invoice, Customer);
        }
        catch (ApplicationException exc)
        {
            var resp = new HttpResponseMessage(HttpStatusCode.NotFound)
            {
                Content = new StringContent(string.Format("No Image with Invoice Number = {0}", invoice.ToString())),
                ReasonPhrase = "Image Not Found"
            };
            throw new HttpResponseException(resp);
        }
        catch (Exception exc)
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));

        }
        return (byte[])image;
    } 
```

这将返回一个长度为 40133 的数组。

调用 Web API 服务如下所示：

```
public HttpResponseMessage Get(string invoice, string Customer)
    {           

        HttpClient client = new HttpClient();

        client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/octet-stream"));

        byte[] img = client.GetByteArrayAsync("http://localhost:1363/api/Image/" + invoice + "/" + Customer).Result;

        HttpResponseMessage response = new HttpResponseMessage();
        response.Content = new ByteArrayContent(img);
        response.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("image/tiff");
        var disposition = new ContentDispositionHeaderValue("attachment");
        disposition.FileName = "ImageDocument.tif";
        response.Content.Headers.ContentDisposition = disposition;

        return response;

    } 
```

但是，img 字节数组的长度是 53514。

当浏览器尝试打开图像时，它告诉我它已损坏。如果我在记事本中打开 TIFF，我会得到：

```
"SUkqAAgAAAASAP4ABAABAAAAAAAAAAABBAABAAAAsAYAAAEBBAABAAAAvgQAAAIBAwABAAAAAQAAAAMBAwABAAAABAAAAAYBAwABAAAAAAAAAAcBAwABAAAAAQAAABEBBAABAAAAAAMAABIBAwABAAAAAQAAABUBAwABAAAAAQAAABYBBAABAAAAvgQAABcBBAABAAAAxZkAABoBBQABAAAA+AIAABsBBQABAAAA8AIAACgBAwABAAAAAgAAADEBAgA4AAAAuAIAADIBAgAUAAAApAIAAOiAAwABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIwMTI6MTA6MDMgMDc6Mjc6MTkAS29mYXggc3RhbmRhcmQgTXVsdGktUGFnZSBUSUZGIFN0b3JhZ2UgRmlsdGVyIHYzLjAzLjAwMADIAAAAAQAAAMgAAAABAAAALcMjAGC+cBQRwhOKcIuzqZDzrHoxF8k+VAOR2cAgjhC5lQEI+VYoiIiIiIiIiJXLAazgaZvMBqEcNI0BoJwaTMGsjgqGA1yOGaUA0Hg0igC5qZ6I1GSsNMuGqeBrI+bBoNYQrfNIiMREWdl4zVWRERkQzVECBpNcRyMCz6PhQgZwQGQLjpCIWwgxERGLLYAx//zLWLx4IeDnBnxSGFMRgIeZ4zcaR+KuPM4KeZ6MBTqKcj8YjAQ4IejDoQ4eE07WGnra3p9w07Xhw1s7NHu+0/v+/SQf6/9+cjwp0Z0Z8KeCm4p4IGQwhoz4cwCFBZN8u8s5duXeXTLva7pN6J56l45sf8u8u 
```

***剪辑********

有人知道我在做什么错吗？

谢谢！

克里斯

**解决了**

如果有人对利用已识别解决方案的调用代码感兴趣，这里是：

```
public HttpResponseMessage Get(string invoice, string Customer)
    {

        HttpClient client = new HttpClient();

        client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("image/tiff"));

        byte[] img = client.GetByteArrayAsync("http://localhost:1363/api/Image/" + invoice + "/" + Customer).Result;

        HttpResponseMessage response = new HttpResponseMessage();
        response.Content = new ByteArrayContent(img);
        response.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("image/tiff");
        var disposition = new ContentDispositionHeaderValue("attachment");
        disposition.FileName = "ImageDocument.tif";
        response.Content.Headers.ContentDisposition = disposition;

        return response;

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:52:30.567

使用上述当前返回类型 (byte[]) 的操作，Web api 的格式化程序可能正在处理它们，因此您会看到意外的响应。

您可以尝试将图像作为 ByteArrayContent 发送吗？（您需要在此处将 HttpResponseMessage 作为返回类型）

例子：

```
HttpResponseMessage response = new HttpResponseMessage(HttpStatusCode.OK);
response.Content = new ByteArrayContent(..your byte array here...);
response.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("image/jpeg");

return response; 
```

# c# - 自动对焦例程检测非常小的模糊差异

> ID：15364289
> 
> 赞同：9
> 
> 时间：2013-03-12T14:40:54.147
> 
> 标签：c#, image, algorithm, image-processing, aforge

我正在开发一个用于在微米尺度上定位的自动对焦例程，因此我需要找到图像之间焦点/模糊的非常小的差异。幸运的是，图像模式将始终相同（这些是原始 2 MP 图像的 256x256 中心裁剪）：

![0 µm 关闭](../Images/6fac152c04c4de4c29a9e1a2c758a0b4.png) ![50 µm 关闭](../Images/ae46025e222f45a4030cb98c181e80db.png)

```
 Perfect focus         |           50 µm off 
```

找到上述两个更好聚焦的图像不是问题，我想大多数算法都可以。但我真的需要比较焦点差异较小的图像，如下所示：

![5 µm 关闭](../Images/224ebb797c5bfa94ad2f0fcd079de99f.png) ![10 µm 关闭](../Images/4be7d1f9dabfe1703301c09171706200.png)

```
 5 µm off            |           10 µm off 
```

越来越接近最佳焦点的另一种方法是在焦平面的相对两侧找到两个具有相同模糊量的图像。例如，可以保存 -50 µm 的图像，然后尝试在 +50 µm 附近找到模糊相等的图像。假设图像位于 +58 µm，那么焦平面应位于 +4 µm。

对合适的算法有什么想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-13T22:20:32.290

令人惊讶的是，许多非常简单的自动对焦算法实际上在这个问题上表现得非常好。我实现了 Liu、Wang 和 Sun的论文[Dynamic evaluation of autofocusing 对血液涂片和巴氏涂片进行自动显微分析中](http://amnl.mie.utoronto.ca/data/J25.pdf)概述的 16 种算法中的 11 种。由于我无法找到设置阈值的建议，因此我还添加了一些没有阈值的变体。我还在 SO 上添加了一个简单但聪明的建议：比较 JPEG 压缩图像的文件大小（更大的大小 = 更多的细节 = 更好的焦点）。

我的自动对焦例程执行以下操作：

*   以 2 µm 焦距的间隔保存 21 张图像，总范围 ±20 µm。
*   计算每个图像的焦点值。
*   将结果拟合到二次多项式。
*   找到给出多项式最大值的位置。

除直方图范围外的所有算法都给出了良好的结果。一些算法稍作修改，例如它们使用 X 和 Y 方向的亮度差异。我还必须更改 StdevBasedCorrelation、Entropy、ThresholdedContent、ImagePower 和 ThresholdedImagePower 算法的符号，以在焦点位置获得最大值而不是最小值。该算法需要一个 24 位灰度图像，其中 R = G = B。如果用于彩色图像，则只会计算蓝色通道（当然很容易校正）。

通过运行阈值 0、8、16、24 等直至 255 的算法并为以下各项选择最佳值，可以找到最佳阈值：

*   稳定的焦点位置
*   大的负 x² 系数导致焦点位置的窄峰
*   多项式拟合的低残差平方和

有趣的是，ThresholdedSquaredGradient 和 ThresholdedBrennerGradient 算法具有几乎平坦的焦点位置线、x² 系数和残差平方和。它们对阈值的变化非常不敏感。

算法的实现：

```
public unsafe List<Result> CalculateFocusValues(string filename)
{
  using(Bitmap bmp = new Bitmap(filename))
  {
    int width  = bmp.Width;
    int height = bmp.Height;
    int bpp = Bitmap.GetPixelFormatSize(bmp.PixelFormat) / 8;
    BitmapData data = bmp.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadOnly, bmp.PixelFormat);

    long sum = 0, squaredSum = 0;
    int[] histogram = new int[256];

    const int absoluteGradientThreshold = 148;
    long absoluteGradientSum = 0;
    long thresholdedAbsoluteGradientSum = 0;

    const int squaredGradientThreshold = 64;
    long squaredGradientSum = 0;
    long thresholdedSquaredGradientSum = 0;

    const int brennerGradientThreshold = 184;
    long brennerGradientSum = 0;
    long thresholdedBrennerGradientSum = 0;

    long autocorrelationSum1 = 0;
    long autocorrelationSum2 = 0;

    const int contentThreshold = 35;
    long thresholdedContentSum = 0;

    const int pixelCountThreshold = 76;
    long thresholdedPixelCountSum = 0;

    const int imagePowerThreshold = 40;
    long imagePowerSum = 0;
    long thresholdedImagePowerSum = 0;

    for(int row = 0; row < height - 1; row++)
    {
      for(int col = 0; col < width - 1; col++)
      {
        int current = *((byte *) (data.Scan0 + (row + 0) * data.Stride + (col + 0) * bpp));
        int col1    = *((byte *) (data.Scan0 + (row + 0) * data.Stride + (col + 1) * bpp));
        int row1    = *((byte *) (data.Scan0 + (row + 1) * data.Stride + (col + 0) * bpp));

        int squared = current * current;
        sum += current;
        squaredSum += squared;
        histogram[current]++;

        int colDiff1 = col1 - current;
        int rowDiff1 = row1 - current;

        int absoluteGradient = Math.Abs(colDiff1) + Math.Abs(rowDiff1);
        absoluteGradientSum += absoluteGradient;
        if(absoluteGradient >= absoluteGradientThreshold)
          thresholdedAbsoluteGradientSum += absoluteGradient;

        int squaredGradient = colDiff1 * colDiff1 + rowDiff1 * rowDiff1;
        squaredGradientSum += squaredGradient;
        if(squaredGradient >= squaredGradientThreshold)
          thresholdedSquaredGradientSum += squaredGradient;

        if(row < bmp.Height - 2 && col < bmp.Width - 2)
        {
          int col2    = *((byte *) (data.Scan0 + (row + 0) * data.Stride + (col + 2) * bpp));
          int row2    = *((byte *) (data.Scan0 + (row + 2) * data.Stride + (col + 0) * bpp));

          int colDiff2 = col2 - current;
          int rowDiff2 = row2 - current;
          int brennerGradient = colDiff2 * colDiff2 + rowDiff2 * rowDiff2;
          brennerGradientSum += brennerGradient;
          if(brennerGradient >= brennerGradientThreshold)
            thresholdedBrennerGradientSum += brennerGradient;

          autocorrelationSum1 += current * col1 + current * row1;
          autocorrelationSum2 += current * col2 + current * row2;
        }

        if(current >= contentThreshold)
          thresholdedContentSum += current;
        if(current <= pixelCountThreshold)
          thresholdedPixelCountSum++;

        imagePowerSum += squared;
        if(current >= imagePowerThreshold)
          thresholdedImagePowerSum += current * current;
      }
    }
    bmp.UnlockBits(data);

    int pixels = width * height;
    double mean = (double) sum / pixels;
    double meanDeviationSquared = (double) squaredSum / pixels;

    int rangeMin = 0;
    while(histogram[rangeMin] == 0)
      rangeMin++;
    int rangeMax = histogram.Length - 1;
    while(histogram[rangeMax] == 0)
      rangeMax--;

    double entropy = 0.0;
    double log2 = Math.Log(2);
    for(int i = rangeMin; i <= rangeMax; i++)
    {
      if(histogram[i] > 0)
      {
        double p = (double) histogram[i] / pixels;
        entropy -= p * Math.Log(p) / log2;
      }
    }

    return new List<Result>()
    {
      new Result("AbsoluteGradient",            absoluteGradientSum),
      new Result("ThresholdedAbsoluteGradient", thresholdedAbsoluteGradientSum),
      new Result("SquaredGradient",             squaredGradientSum),
      new Result("ThresholdedSquaredGradient",  thresholdedSquaredGradientSum),
      new Result("BrennerGradient",             brennerGradientSum),
      new Result("ThresholdedBrennerGradient",  thresholdedBrennerGradientSum),
      new Result("Variance",                    meanDeviationSquared - mean * mean),
      new Result("Autocorrelation",             autocorrelationSum1 - autocorrelationSum2),
      new Result("StdevBasedCorrelation",       -(autocorrelationSum1 - pixels * mean * mean)),
      new Result("Range",                       rangeMax - rangeMin),
      new Result("Entropy",                     -entropy),
      new Result("ThresholdedContent",          -thresholdedContentSum),
      new Result("ThresholdedPixelCount",       thresholdedPixelCountSum),
      new Result("ImagePower",                  -imagePowerSum),
      new Result("ThresholdedImagePower",       -thresholdedImagePowerSum),
      new Result("JpegSize",                    new FileInfo(filename).Length),
    };
  }
}

public class Result
{
  public string Algorithm { get; private set; }
  public double Value     { get; private set; }

  public Result(string algorithm, double value)
  {
    Algorithm = algorithm;
    Value     = value;
  }
} 
```

为了能够绘制和比较不同算法的焦点值，它们被缩放到 0 和 1 之间的值 ( `scaled = (value - min)/(max - min)`)。

±20 µm 范围内的所有算法图：

![±20 微米](../Images/ac9cc9765734f0bfc0ba60aaa276f8c2.png)

![0微米](../Images/e6a3a11def4ff72aedd1e58b0f0c7fa1.png) ![20微米](../Images/ec2341840a886952fdff2c819e0c8098.png)

```
 0 µm             |             20 µm 
```

对于 ±50 µm 的范围，情况看起来非常相似：

![±50 微米](../Images/d104e1fb72b6fe51e203af67159c4dd8.png)

![0微米](../Images/b2dec9a60fa0bf3c314a6bbf62ea3e48.png) ![50微米](../Images/d36a258fbcd6c964a7a73e306afc6ffc.png)

```
 0 µm             |             50 µm 
```

当使用 ±500 µm 的范围时，事情会变得更有趣。四种算法表现出更多的四次多项式形状，而其他算法开始看起来更像高斯函数。此外，直方图范围算法开始比较小范围执行得更好。

![±500 微米](../Images/fae7c926dddd7a64465167158b0e6093.png)

![0微米](../Images/acf6be14914038762ac21f9561796950.png) ![500微米](../Images/1a4f85d7489f3758344a88f72d850074.png)

```
 0 µm             |             500 µm 
```

总的来说，我对这些简单算法的性能和一致性印象深刻。用肉眼，很难判断即使是 50 µm 的图像也没有对焦，但算法可以轻松比较相距几微米的图像。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-20T05:24:56.880

NindzAl对原始答案的评论的额外答案：

我使用[极限优化](http://www.extremeoptimization.com/)库将锐度值拟合到二次多项式。然后使用多项式的一阶导数提取最大锐度的距离。

Extreme Optimization 库的单个开发许可证成本为 999 美元，但我确信有开源数学库也可以执行拟合。

```
// Distances (in µm) where the images were saved
double[] distance = new double[]
{
  -50,
  -40,
  -30,
  -20,
  -10,
    0,
  +10,
  +20,
  +30,
  +40,
  +50,
};

// Sharpness value of each image, as returned by CalculateFocusValues()
double[] sharpness = new double[]
{
  3960.9,
  4065.5,
  4173.0,
  4256.1,
  4317.6,
  4345.4,
  4339.9,
  4301.4,
  4230.0,
  4131.1,
  4035.0,
};

// Fit data to y = ax² + bx + c (second degree polynomial) using the Extreme Optimization library
const int SecondDegreePolynomial = 2;
Extreme.Mathematics.Curves.LinearCurveFitter fitter = new Extreme.Mathematics.Curves.LinearCurveFitter();
fitter.Curve = new Extreme.Mathematics.Curves.Polynomial(SecondDegreePolynomial);
fitter.XValues = new Extreme.Mathematics.LinearAlgebra.GeneralVector(distance,  true);
fitter.YValues = new Extreme.Mathematics.LinearAlgebra.GeneralVector(sharpness, true);
fitter.Fit();

// Find distance of maximum sharpness using the first derivative of the polynomial
// Using the sample data above, the focus point is located at distance +2.979 µm
double focusPoint = fitter.Curve.GetDerivative().FindRoots().First(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-22T13:19:56.243

至于免费图书馆，Math.Net 将为此目的而工作

# servicestack - ServiceStack - 主应用程序的不同服务器

> ID：15364293
> 
> 赞同：1
> 
> 时间：2013-03-12T14:41:14.567
> 
> 标签：servicestack

我希望创建一个将托管在服务器 A 上的服务（例如 URL: `http://servera:807`）。但是我的主要应用程序需要托管在服务器 B 上（例如 URL: `http://serverb:801`）。

我很好奇这是否可能？我的服务和主要应用程序需要位于不同服务器上的原因是我无法控制的。当前系统使用具有相同设置的 WCF，我想摆脱它。

在示例中，服务和客户端似乎都托管在同一位置/同一解决方案中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:20:34.083

以下是解决方案/项目的潜在设置。它简单且不完整，但我认为有助于说明一种可能的设置。您还需要考虑如何处理会话信息和身份验证，因为 MVC 和 ServiceStack 分别处理这些。请参阅[CustomAuthenticationMVC](https://github.com/ServiceStack/ServiceStack.UseCases)

**ServerA.sln（ASP.NET Web 应用程序）**

*   ServiceModel 项目 - 保存请求对象和 dto（这可以在 ServerA 和 ServerB 解决方案之间共享）
*   ServiceInterface 项目 - 有服务实现
*   Global.asx - 有 Application_Start 方法来配置 ServiceStack

**ServerB.sln（MV4 应用程序）**

*   ServiceModel 项目（共享）
*   意见
*   楷模
*   控制器

**ServiceModel 项目中的类示例：**

```
[Route("/Foos")]
public class Foos : IReturn<FoosResponse>
{}

public class FoosResponse
{
    public FoosResponse()
    {
        this.ResponseStatus = new ResponseStatus();
    }

    public ResponseStatus ResponseStatus {get; set;}
} 
```

**ServiceInterface 项目中的类示例**

```
public class FoosService : Service
{
    public FoosResponse Get(Foos request)
    {
        return new FoosReponse();
    }
} 
```

**示例如何在 MVC4 应用程序中调用 ServiceStack API**

```
public class FoosController
{
    public ActionResult Index()
    {
        var client = new JsonServiceClient("http://servera:807");
        var response = client.Get(new Foos());
        return View(response);
    }
} 
```

# c# - WPF 工具包图表 - Series.Clear() 之后的 NullReferenceException

> ID：15364296
> 
> 赞同：3
> 
> 时间：2013-03-12T14:41:34.707
> 
> 标签：c#, wpf, charts, wpftoolkit

该错误发生在更复杂的上下文中，但可以在这个简单的示例中重现：

主窗口.xaml

```
<Window>
  <StackPanel>
    <Button Click="Button_Click_1">Clear</Button>
    <Button Click="Button_Click_2">Modify</Button>
    <charting:Chart x:Name="chart" />
  </StackPanel>
</Window> 
```

主窗口.xaml.cs

```
public partial class MainWindow : Window
{
    Random rand = new Random();
    ObservableCollection<KeyValuePair<double, double>> values =
        new ObservableCollection<KeyValuePair<double, double>>();

    public MainWindow()
    {
        InitializeComponent();
        values.Add(new KeyValuePair<double, double>(10, 10));
        values.Add(new KeyValuePair<double, double>(20, 40));
        values.Add(new KeyValuePair<double, double>(30, 90));
        values.Add(new KeyValuePair<double, double>(40, 160));
        values.Add(new KeyValuePair<double, double>(50, 250));
        AddSeries();
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        chart.Series.Clear();
        AddSeries();
    }

    private void AddSeries()
    {
        var series = new LineSeries();
        series.SetBinding(LineSeries.ItemsSourceProperty, new Binding());
        series.DataContext = values;
        series.DependentValueBinding = new Binding("Value");
        series.IndependentValueBinding = new Binding("Key");

        chart.Series.Add(series);
    }

    private void Button_Click_2(object sender, RoutedEventArgs e)
    {
        values[3] = new KeyValuePair<double,double>(40, rand.NextDouble() * 300);
    }
} 
```

单击**清除**，然后单击**修改**。清除从图表中删除系列并创建一个新系列。Modify 修改系列绑定的源。`UpdateDataPoint`我得到 NullReferenceException的已删除系列调用`ActualDependentRangeAxis`为空：

```
protected override void UpdateDataPoint(DataPoint dataPoint)
{
  double maximum = ActualDependentRangeAxis.GetPlotAreaCoordinate(
    ActualDependentRangeAxis.Range.Maximum).Value; 
```

我使用[数据可视化开发版本 4.0](http://blogs.msdn.com/b/delay/archive/2010/04/20/phone-y-charts-silverlight-wpf-data-visualization-development-release-4-and-windows-phone-7-charting-sample.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T13:13:18.987

我想我已经找到了这个错误的原因。在删除它们之前，您应该`DataContext`从每个系列中删除它们：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    foreach (var series in chart.Series.OfType<Series>())
    {
        series.DataContext = null;
    }

    chart.Series.Clear();
    AddSeries();
} 
```

如果您清除`DataContext`- 事件将按原样取消订阅。

**编辑**

如果您快速单击“修改”按钮，然后立即单击“清除”按钮，它会在一种情况下崩溃。发生这种情况是因为图表需要一些时间来取消订阅事件中的数据点并隐藏它们。

无论如何，您可以手动取消订阅，但您必须使用反射，因为必要的方法 (`DetachEventHandlersFromDataPoints`和`PlotArea`) 是内部的或私有的。

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    this.DetachAllEventsFromSeries();

    chart.Series.Clear();

    AddSeries();
}

private void DetachAllEventsFromSeries()
{
    var plotAreaProperty = typeof(DataPointSeries).GetProperty("PlotArea", BindingFlags.Instance | BindingFlags.NonPublic);
    var detachMethod = typeof(DataPointSeries).GetMethod("DetachEventHandlersFromDataPoints", BindingFlags.Instance | BindingFlags.NonPublic);

    foreach (var series in chart.Series.OfType<DataPointSeries>().ToList())
    {
        var plotArea = (Panel)plotAreaProperty.GetValue(series, null);
        if (plotArea == null)
        {
            continue;
        }

        var datapoints = plotArea.Children.OfType<DataPoint>().ToList();
        detachMethod.Invoke(series, new[] { datapoints });
    }
} 
```

此外，如果您有可能重新编译工具包库，则可以将此方法添加到`DataPointSeries`类中而无需反射，那么它将在没有开销的情况下执行。

# jquery - 通过内容的完全匹配来选择元素

> ID：15364298
> 
> 赞同：179
> 
> 时间：2013-03-12T14:41:40.230
> 
> 标签：jquery, jquery-selectors

好吧，我想知道是否有一种方法可以让`:contains()`jQuery 的选择器选择**仅**包含输入的字符串的元素

例如 -

```
<p>hello</p>
<p>hello world</p>

$('p:contains("hello")').css('font-weight', 'bold'); 
```

选择器将选择两个`p`元素并使它们加粗，但我希望它只选择第一个。

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2013-03-12T14:43:07.947

不，没有 jQuery（或 CSS）选择器可以做到这一点。

您可以轻松使用[`filter`](http://api.jquery.com/filter)：

```
$("p").filter(function() {
    return $(this).text() === "hello";
}).css("font-weight", "bold"); 
```

它不是一个*选择器*，但它可以完成工作。:-)

如果你想在“hello”之前或之后处理空格，你可以[`$.trim`](http://api.jquery.com/jQuery.trim/)在里面扔一个：

```
return $.trim($(this).text()) === "hello"; 
```

对于那些过早的优化器，如果你不在乎它不匹配`<p><span>hello</span></p>`和相似，你可以避免调用`$`和直接`text`使用`innerHTML`：

```
return this.innerHTML === "hello"; 
```

...但是您必须有***很多***段落才重要，以至于您可能首先会遇到其他问题。:-)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2013-08-27T10:06:14.800

尝试添加一个扩展伪函数：

```
$.expr[':'].textEquals = $.expr.createPseudo(function(arg) {
    return function( elem ) {
        return $(elem).text().match("^" + arg + "$");
    };
}); 
```

然后你可以这样做：

```
$('p:textEquals("Hello World")'); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-12T14:43:11.227

您可以使用 jQuery 的[filter()](http://api.jquery.com/filter/)函数来实现这一点。

```
$("p").filter(function() {
// Matches exact string   
return $(this).text() === "Hello World";
}).css("font-weight", "bold"); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-10-17T18:31:26.403

所以阿曼杜的回答大多有效。然而，在野外使用它时，我遇到了一些问题，我期望找到的东西没有被发现。这是因为有时元素的文本周围会有随机的空白。我相信，如果您正在搜索“Hello World”，您仍然希望它匹配“Hello World”，甚至“Hello World \n”。因此，我只是在函数中添加了“trim()”方法，它删除了周围的空白，它开始工作得更好了。

具体来说...

```
$.expr[':'].textEquals = function(el, i, m) {
    var searchText = m[3];
    var match = $(el).text().trim().match("^" + searchText + "$")
    return match && match.length > 0;
} 
```

[另外，请注意，此答案与Select link by text (exact match)](https://stackoverflow.com/questions/6673777/select-link-by-text-exact-match)极为相似

次要注释...`trim`仅删除搜索文本*前后的空格。*它不会删除单词中间的空格。我相信这是可取的行为，但如果你愿意，你可以改变它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-02-20T19:55:41.013

我找到了一种适合我的方法。它不是 100% 准确的，但它消除了所有不只包含我要查找的单词的字符串，因为我检查了不包含单个空格的字符串。顺便说一句，你不需要这些“”。jQuery 知道您正在寻找一个字符串。确保在 :contains( ) 部分中只有一个空格，否则它将不起作用。

```
<p>hello</p>
<p>hello world</p>
$('p:contains(hello):not(:contains( ))').css('font-weight', 'bold'); 
```

是的，我知道如果你有类似的东西，它就行不通了`<p>helloworld</p>`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-06-03T17:00:46.837

就像上面提到的 TJ Crowder 一样，过滤器功能确实很神奇。在我的具体情况下，它对我不起作用。我需要在 div 中搜索多个表及其各自的 td 标签（在本例中为 jQuery 对话框）。

```
$("#MyJqueryDialog table tr td").filter(function () {
    // The following implies that there is some text inside the td tag.
    if ($.trim($(this).text()) == "Hello World!") {
       // Perform specific task.
    }
}); 
```

我希望这对某人有帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-23T00:52:31.877

与jQuery的[替代库](https://github.com/kenwheeler/cash)一起使用的单行器：

```
$('p').filter((i, p) => $(p).text().trim() === "hello").css('font-weight', 'bold'); 
```

这相当于 jQuery 的`a:contains("pattern")`选择器：

```
var res = $('a').filter((i, a) => $(a).text().match(/pattern/)); 
```

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2013-03-12T14:43:37.373

.first() 在这里会有所帮助

```
$('p:contains("hello")').first().css('font-weight', 'bold'); 
```

# validation - 密码验证缺少工作的正则表达式

> ID：15364299
> 
> 赞同：0
> 
> 时间：2013-03-12T14:41:41.103
> 
> 标签：validation, passwords, expression

我需要验证符合以下条件的密码：

*   长度必须至少为 6 个字符 (?=.{6})

*   字符串包含一个数字 (0-9) 和至少 1 个大写字母 (AZ) 和至少 1 个 (-) 字符。

*   字符串不以 - 字符开头和结尾（无效：-ABCDE 或 ABCDE- 等）

**有效字符串**

A-BCDE

ABC-DE

1B-CDE

1-BCDE

AB-CD1

ABCD-1

我的正则表达式

^。*(?=.{6})(?=.* \d)(?=. *[AZ])(?=.* [-]).*$

演示网址：

[http://www.rubular.com/r/YHdPCjSW6P](http://www.rubular.com/r/YHdPCjSW6P)

**无效字符串**

ABCDEF（否 - 字符必须是至少 1 个 - 之一）

-ABCDE（--第一个字符不能）

ABCDE-（-最后一个字符不能）

A-BC-D (- 不能超过 1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:12:02.013

这对你有用吗？

```
^.*(?=.{6})(?=[^\-].*[a-zA-Z])[a-zA-Z0-9\-]{1,5}[^\-]$ 
```

请参阅此处的示例[http://www.rubular.com/r/spfqXIVZyX](http://www.rubular.com/r/spfqXIVZyX)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T08:21:12.873

有效字符串

A-BCDE

ABC-DE

1B-CDE

1-BCDE

AB-CD1

ABCD-1

无效字符串

ABCDEF（否 - 字符必须是至少 1 个 - 之一）

-ABCDE（--第一个字符不能）

ABCDE-（-最后一个字符不能）

A-BC-D (- 不能超过 1)

我现在的正则表达式

^。*(?=.{6})(?=[^-].* [a-zA-Z])[a-zA-Z0-9-]{1,5}[^-]$

演示网址：

[http://www.rubular.com/r/3Q6Ozs4aVB](http://www.rubular.com/r/3Q6Ozs4aVB)

# java - 如何在 Spring 中从 @RequestMapping 中排除 url 映射？

> ID：15364304
> 
> 赞同：7
> 
> 时间：2013-03-12T14:42:01.333
> 
> 标签：java, spring, spring-mvc, spring-security, request

我有一个请求映射，可以处理上下文之后的任何字符串，例如**www.example.com/anystring**

我处理如下：

```
@RequestMapping(value="/{str}", method = RequestMethod.GET)
public String getApp(@PathVariable("str") String anyString, ModelMap model) {
        //Do something
    } 
```

问题是我的应用中有 2-3 个 URL，其中 URL 如下：**www.example.com/about**，**www.example.com/contact**等。

我为他们写了请求映射如下：

```
@RequestMapping("/about")
    public String getAboutPage() {
        return "about";
    } 
```

但显然，由于我已经声明任何字符串都应由 处理`getApp()`，因此`getAboutPage()`永远不会执行。如何从映射中排除`/about`等。我们显然可以在 URL 字符串中添加另一个关键字，但这在我的应用程序用例中是不可能的。请帮忙。:(`/contact``getApp()`

**编辑：**

我应该在里面处理`/about`吗：`/contact``getApp()`

```
@RequestMapping(value="/{str}", method = RequestMethod.GET)
    public String getApp(@PathVariable("str") String anyString, ModelMap model) {

    if(anyString.equals("about")){
     //do about related stuff
    }

    if(anyString.equals("contact")){
     //do contact related stuff
    }

    //Do something
    } 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:01:42.063

在“catch-all”映射中指定 HTTP 请求方法可能会使路径匹配器认为它比绝对路径映射更具体。

在绝对路径上指定请求方法，映射比较器应将绝对匹配排序在包含路径变量的匹配之前。

例如。

```
@RequestMapping("/about", method = RequestMethod.GET) 
```

或者，您可以删除包罗万象的方法规范：

```
@RequestMapping("/{str}") 
```

这完全取决于您的 url 结构以及这些路径中的任何一个是否会接受不同的 http 请求方法。

# java - 访问 Flex BlazeDS 中的 Java 对象字段

> ID：15364305
> 
> 赞同：0
> 
> 时间：2013-03-12T14:42:01.523
> 
> 标签：java, apache-flex, object, field, blazeds

我正在使用 BlazeDS 将 Flex 与 Java 连接起来。当我尝试访问 Flex 中的 java 对象字段时遇到问题

这是我的 Java 类路径：

```
package intetech;

public class Path {

    public Path(){

    }
    public Path(double x1, double y1, double x2, double y2){
        this.x1 = x1;
        this.y1 = y1;
        this.x2 = x2;
        this.y2 = y2;
    }

    public double getX1(){
        return x1;
    }
    public double getY1(){
        return y1;
    }
    public double getX2(){
        return x2;
    }
    public double getY2(){
        return y2;
    }

    private double x1;
    private double y1;
    private double x2;
    private double y2;
} 
```

以及在 getPaths 方法中返回 Path 的 ArrayList 的 Java 类 PathsService：

```
package intetech;

import org.xml.sax.SAXException;
import javax.xml.parsers.ParserConfigurationException;
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public class PathsService {
    public PathsService(){}

    public List<Path> getPaths(){
        File svgFile = new File("D:\\work\\blazedsTurnkey\\blazeds-turnkey-4.0.0.14931\\tomcat\\webapps\\blazeds\\WEB-INF\\classes\\intetech\\test.svg");
        try{
            SvgParser svgp = new SvgParser(svgFile);
            listOtr = svgp.getList();
        } catch (SAXException ex) {

        } catch (ParserConfigurationException ex) {

        } catch (IOException ex) { }

        return listOtr;
    }

    private static List<Path> listOtr;
} 
```

所以我尝试从 flex 中的 ArrayList 获取一条路径的坐标。主要.mxml：

```
 <fx:Declarations>
    <!--setup the connection to the Java class-->
    <mx:RemoteObject
        id="PathsService"
        destination="pathsservice"
        showBusyCursor="true"
        >

        <mx:method name="getPaths" 
                   result="resultGetPaths(event)" 
                   fault="faultGetPaths(event)"/>

    </mx:RemoteObject>
</fx:Declarations>

<fx:Script>
        import mx.collections.ArrayCollection;
        import mx.controls.Alert;
        import mx.rpc.events.FaultEvent;
        import mx.rpc.events.ResultEvent;
        import mx.utils.ObjectUtil;

        private var aPath:Path ;
        private var pathsArrCol:ArrayCollection;
        private var otr:Path;

        public function resultGetPaths(event:ResultEvent):void {

            pathsArrCol = event.result as ArrayCollection;
            **otr = pathsArrCol.getItemAt(0) as Path;
            Alert.show(ObjectUtil.toString(otr.getX1()));** 
        } 

        private function faultGetPaths(event:FaultEvent):void{

            Alert.show( ObjectUtil.toString(event.fault) );

        }

</fx:Script> 
```

和 Path.as 文件：

```
package
{
    [RemoteClass(alias="intetech.Path")]

[Bindable]
public class Path
{

    private var ax1:Number;
    private var ay1:Number;
    private var ax2:Number; 
    private var ay2:Number;

    public function getX1():Number {
        return ax1;
    }
    public function getY1():Number {
        return ay1;
    }
    public function getX2():Number {
        return ax2;
    }
    public function getY2():Number {
        return ay2;
    }

public function setX1(data:Number): void{
        ax1 = data;
    }
    public function setY1(data:Number): void{
        ax1 = data;
    }
    public function setX2(data:Number): void{
        ax1 = data;
    }
    public function setY2(data:Number): void{
        ax1 = data;
    }

}
} 
```

运行此应用程序时我有 NaN 结果，请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:58:43.167

您的 flex 对象中没有任何公共设置器/获取器：

```
package {

    [RemoteClass(alias="intetech.Path")]
    [Bindable]
    public class Path {

        private var ax1:Number;
        private var ay1:Number;
        private var ax2:Number; 
        private var ay2:Number;

        public function get x1():Number {
            return ax1;
        }

        public function get y1():Number {
            return ay1;
        }

        public function get x2():Number {
            return ax2;
        }

        public function get y2():Number {
            return ay2;
        }

        public function set x1(data:Number):void {
            ax1 = data;
        }

        public function set y1(data:Number):void {
            ay1 = data;
        }

        public function set x2(data:Number):void {
            ax2 = data;
        }

        public function set y2(data:Number):void {
            ay2 = data;
        }

    }
} 
```

结果是 BlazeDS 无法使用来自 Java 的序列化数据正确初始化您的新 Flex 对象。

# javascript - 浏览器图像缓存和 jQuery.load() 问题

> ID：15364311
> 
> 赞同：1
> 
> 时间：2013-03-12T14:42:23.490
> 
> 标签：javascript, jquery

代码示例：

```
var img = $("img");
var n = img.length;
var i = 0;
function loadImg(i) {
    if( i < n ) {
        $(img[i]).load( function() {
            console.log("img["+i+"] loaded");
            i++;
            loadImg(i);
        });
    } else {
        console.log("img["+i+"] loaded");
        return false;
    }
}
loadImg(0); 
```

此代码有效，但是当图像已经在浏览器缓存中时 - jQuery.load 没有触发。如何检查图片是否在浏览器缓存中并强制触发 jQuery.load？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:52:12.360

Paul Irish 为此编写了一个简洁的小插件。它完全符合您的要求，包括从缓存加载的图像：

[https://github.com/paulirish/jquery.imgloaded](https://github.com/paulirish/jquery.imgloaded)

我已经用包含的上述插件更新了你的小提琴。这应该回答你的问题：

[http://jsbin.com/acuhaf/9/edit](http://jsbin.com/acuhaf/9/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:52:58.253

[jQuery 文档](http://api.jquery.com/load-event/)说：

> 与图像一起使用时加载事件的注意事项
> 开发人员尝试使用 .load() 快捷方式解决的一个常见挑战是在图像（或图像集合）完全加载时执行一个函数。
> 
> 应该注意几个已知的警告。
> 它们是：
> - 它不能始终如一地工作，也不能可靠地跨浏览器
> - 如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
> - 它不会正确地冒泡 DOM 树
> -**可以停止触发已经存在于浏览器缓存中的图像**

您可能想使用其他库来预加载图像。我会推荐[PreloadJS](http://www.createjs.com/#!/PreloadJS)

# sql - 触发器尚未执行但已创建

> ID：15364312
> 
> 赞同：0
> 
> 时间：2013-03-12T14:42:23.410
> 
> 标签：sql, postgresql, triggers

我有一个尝试在 Postgres 中执行的触发功能。

它编译并添加触发器，但是它没有像我希望的那样将值插入到表中。

它使用的函数如下所示：

```
CREATE OR REPLACE FUNCTION
calc_gnpDifference(n integer, o integer)
RETURNS NUMERIC AS $$
        SELECT $1 ::numeric - $2::numeric AS gnpDifference;
$$ LANGUAGE SQL; 
```

和触发部分：

```
CREATE OR REPLACE FUNCTION autoCalculate() RETURNS TRIGGER AS $$
        BEGIN

        IF NEW.gnp_old > NEW.gnp_old THEN
                NEW.gnpDifference := calc_gnpDifference(NEW.gnp_old, NEW.gnp);
        END IF;

        RETURN NEW;
        END;
$$ LANGUAGE plpgsql;

DROP TRIGGER insertDifference ON country;
CREATE TRIGGER insertDifference BEFORE INSERT ON country
FOR EACH ROW EXECUTE PROCEDURE autoCalculate(); 
```

但是，当我插入数据时，触发器不会像我希望的那样更新 gnpDifference 字段。关于为什么会发生这种情况的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:52:11.903

显然这个条件：`IF NEW.gnp_old > NEW.gnp_old`永远不会是真的，所以触发器永远不会有任何效果。

# c# - 以编程方式更改选择器的 ListView 样式

> ID：15364313
> 
> 赞同：5
> 
> 时间：2013-03-12T14:42:24.957
> 
> 标签：c#, .net, wpf, listview, jscript.net

我正在做一个 Windows WPF 应用程序的插件。因此，我可以通过编程访问 ListView，但不能编辑 WPF 源。

`ListViewItem`要根据数据为 s 添加特殊格式，我创建了自己的`StyleSelector`类并将其实例分配给 ListView`ItemContainerStyleSelector`属性。

这是来源：

```
 public class MySelector extends System.Windows.Controls.StyleSelector {

    private var oldSelector : System.Windows.Controls.StyleSelector;

    public function MySelector(oldSelector : StyleSelector, debug : Object) {
      this.oldSelector = oldSelector;
    }
    public function SelectStyle(item : Object, container : DependencyObject) : Style {
      if (this.oldSelector != null) {
        var oldStyle : System.Windows.Style = this.oldSelector.SelectStyle(item, container);
        if (item[3] == "3") {
          var newStyle : System.Windows.Style = new System.Windows.Style(oldStyle.TargetType, oldStyle);
          newStyle.Setters.Add(new Setter(Control.BackgroundProperty, System.Windows.Media.Brushes.Red));
          return newStyle;
        } else {
          return oldStyle;
        }
      }
      return null;
    }
  } 
```

如果列索引 3 包含等于 的值，这将采用旧选择器并添加红色背景`"3"`。

这工作正常，但是当 ListView 中的一行被悬停或选择时，原始样式仍然适用并且红色背景丢失，直到该行被取消选择或取消悬停。

即使它们被选中或悬停，我如何为这些线条应用我的红色背景？

请记住，我无法编辑 XAML，但可以以编程方式访问大多数属性。如果这是用 JScript.NET 编写的插件代码。

* * *

我现在尝试在`newStyle`编程中添加触发器：

```
 var t1 : Trigger = new Trigger();
          t1.Property = ListBoxItem.IsSelectedProperty;
          t1.Value = true;
          t1.Setters.Add(new Setter(Control.BackgroundProperty, System.Windows.Media.Brushes.Black));
          newStyle.Triggers.Add(t1);
          var t2 : Trigger = new Trigger();
          t2.Property = UIElement.IsMouseOverProperty;
          t2.Value = true;
          t2.Setters.Add(new Setter(Control.BackgroundProperty, System.Windows.Media.Brushes.Violet));
          newStyle.Triggers.Add(t2);
          var t3 : Trigger = new Trigger();
          t3.Property = UIElement.IsFocusedProperty;
          t3.Value = true;
          t3.Setters.Add(new Setter(Control.BackgroundProperty, System.Windows.Media.Brushes.Yellow));
          newStyle.Triggers.Add(t3); 
```

没有效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T14:18:42.853

您可以在 WPF 中使用 StyleSelector 机制。

[http://msdn.microsoft.com/tr-tr/library/system.windows.controls.styleselector.aspx](http://msdn.microsoft.com/tr-tr/library/system.windows.controls.styleselector.aspx)

[http://www.shujaat.net/2010/10/wpf-style-selector-for-items-in.html](http://www.shujaat.net/2010/10/wpf-style-selector-for-items-in.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:34:08.350

我会使用资源库并在那里操作触发器等。

[开始使用](http://blogs.msdn.com/b/wpfsldesigner/archive/2010/06/03/creating-and-consuming-resource-dictionaries-in-wpf-and-silverlight.aspx)

例子：

```
<Style x:Key="MenuButtonStyle" TargetType="Button">
    <Setter Property="Background" Value="#FF494646"/>
    <Setter Property="Foreground" Value="#FFE5E5E5"/>
    <Setter Property="TextOptions.TextFormattingMode" Value="Display"></Setter>
    <Setter Property="Cursor" Value="Hand"></Setter>
    <Setter Property="Effect">
        <Setter.Value>
            <DropShadowEffect Opacity="0.7"/>
        </Setter.Value>
    </Setter>
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="Foreground" Value="Black"/>
        </Trigger>
        <Trigger Property="IsFocused" Value="True">
            <Setter Property="Background" Value="ForestGreen"></Setter>
            <Setter Property="Foreground" Value="Black"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

# android - 片段中的onClick方法内的吐司

> ID：15364315
> 
> 赞同：4
> 
> 时间：2013-03-12T14:42:29.947
> 
> 标签：android, onclick, android-fragments, toast

我有以下片段：

```
public class FragmentSocial extends Fragment implements ActionBar.TabListener, OnClickListener 
{

private Fragment mFragment;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getActivity().setContentView(R.layout.fragment_social);
}

public void onTabSelected(Tab tab, FragmentTransaction ft) {
    // relevant code...
}

public void onTabUnselected(Tab tab, FragmentTransaction ft) {
    // relevant code...
}

public void onTabReselected(Tab tab, FragmentTransaction ft) {
    // TODO Auto-generated method stub

}

public void onClick(View v) {
    switch(v.getId())
    {
    case R.id.imgBtnFB:
        Toast.makeText(this, "FB pressed", Toast.LENGTH_LONG).show();
        break;
    case R.id.imgBtnTwitter:
        Toast.makeText(this, "Twitter pressed", Toast.LENGTH_LONG).show();
        break;
    }

} 
```

我的`fragment_social`布局中有几个图像按钮。现在我只想发一条 Toast 消息，看看按下了什么按钮。但是，如果我`this`用作上下文，我会收到此错误消息： *Toast 类型中的方法 makeText(Context, CharSequence, int) 不适用于* 我尝试更改`this`为的参数 (FragmentSocial, String `FragmentSocial.this`, int) `FragmentSocial.this.getActivity()`，尝试创建`private Context mContext`并将其实例化到`mContext = (I tried various options here)`onCreate 方法内部 - 但没有任何效果。我要么没有错误消息，但也没有看到 Toast，或者有其他错误。

那么我怎样才能在这里创建一个 Toast 呢？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-12T14:43:17.107

采用：

```
getActivity().getBaseContext(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-02T05:44:24.973

如果您使用的是片段，请使用此代码

```
Toast.makeText(getActivity(), "You have insufficient points", Toast.LENGTH_LONG ).show(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-23T22:31:33.827

以下任一行都有效。

```
Toast.makeText(getActivity(), "hello",Toast.LENGTH_LONG).show();
Toast.makeText(getActivity().getApplicationContext(),"Hello",Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T14:45:16.400

扩展 Marcin S. 的答案，您还可以在 Fragment 内设置构造函数并传入上下文变量。然后，您可以随时使用此上下文来引用活动。这种方法也稍微快一点`getActivity().getBaseContext()`

将此添加到您的 FragmentSocial 类：

```
Context context;
public FragmentSocial(Context context) {
    this.context = context;
} 
```

`FragmentSocial fragmentSocial = new FragmentSocial();`当您在主要活动类中说过时，将参数添加`this`到 中`()`以使其看起来像`FragmentSocial fragmentSocial = new FragmentSocial(this);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T14:52:11.787

这是我在片段中做的方式

//编辑

```
 YourActivity activity;

@Override
public void onAttach(Activity activity) {
   this.activity = (YourActivity) activity;
}

@Override
public void onClick(View v) {
    Toast.makeText(this.activity, "message", Toast.LENGTH_LONG).show();
} 
```

# java - JPA 事务和 REST 服务：良好实践

> ID：15364318
> 
> 赞同：2
> 
> 时间：2013-03-12T14:42:31.843
> 
> 标签：java, spring, jpa, cxf

我正在编写一个提供管理 JPA 实体（使用 Hibernate）的 REST 服务（使用 Apache-CXF）的应用程序。

我对事务管理有点迷茫，想听听你关于这个话题的建议。

目前，我在我的业务 REST 服务和较低的服务之间放置了一个中间层，仅用于事务管理目的。

目前，我的代码看起来很像：

```
@Service 
class PersistanceService<MyBusinessClass>{
   MyBusinessClass load(Long id);
   void save(MyBusinessClass businessObject);
}

@Service 
class BusinessService<MyBusinessClass>{
   void doSomethingOn(MyBusinessClass businessObject);
}

@Service
class TransactionBusinessService<MyBusinessClass>{
   @Transactional
   void doSomethingOn(Long id) {
      MyBusinessClass businessObject = persistanceService.load(id);
      businessService.doSomethingOn(businessObject);
      persistanceService.save(businessObject);
   }
}

@Service
@path("/foo")
class RESTService {
   @Path("/doSomething")
   void doSomethingOn(Long id) {
      transactionBusinessService.doSomethingOn(id);
   }
} 
```

我认为**TransactionBusinessService**是矫枉过正。我希望 ''Spring'' 或 ''CXF'' 为我处理事务：我觉得请求是这样做的良好粒度：在每个请求的开头初始化一个实体管理器，并在最后提交更新.

我尝试将**@Transactional**注释添加到REST 方法本身，但它似乎被忽略了，或者与CXF 冲突。

1.  您认为在请求级别委派事务而不再为它烦恼是个好主意吗？
2.  如何让 Spring 或 CXF 将事务管理绑定到我的请求？

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:19:26.247

> 您认为在请求级别委派事务而不再为它烦恼是个好主意吗？

通常这不是一个好主意，因为：

*   通常分离事务隔离不是那么方便
*   如果你需要做一些改变`for-loop`，每一个都必须有自己的交易，它也不是那么透明；同时在服务层，您可以决定是否需要整个循环是事务性的或每次迭代；
*   `tx:annotation-driven`（和其他一些 AOP 拦截器）有时会有点不可预测，如果您直接在控制器中使用 AOP 注释（至少我在 Spring MVC/struts2 和其他一些框架中遇到了这样的问题）

所以基本上，你有 3 层：

*   持久层，只负责存储/获取数据；
*   服务层，负责数据准备和 AOP 注释（`@Transactional`、`@PreAuthorize`等`@Cacheable`），其中使用持久层；
*   控制器级别，它获取请求、绑定业务模型、可能对其进行验证、将模型传递给服务层并从那里返回结果或处理异常

> 我如何让 Spring 或 CXF 将事务管理绑定到我的请求？

请确保您：

*   您的配置中有适当`TransactionManager`的（'org.springframework.transaction.PlatformTransactionManager` 实现）
*   你有`tx:annotation-driven`你的配置
*   这些 bean 在 CXF 服务的配置中可见

```
    <bean name="txManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </豆>

    <tx:annotation-driven transaction-manager="txManager"/>

```

# ruby-on-rails - RoR + CanCan：在一行中检查嵌套条件

> ID：15364320
> 
> 赞同：0
> 
> 时间：2013-03-12T14:42:39.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我有用户和帖子模型。用户有很多帖子，帖子属于用户。我希望只有当他没有帖子时才允许管理员删除用户，所以现在我有我的ability.rb：

```
can :destroy, User do |u|
    u.posts.empty?
end 
```

但是我可以在一行中写这个（类似`can :destroy, User, :posts => empty?`）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:46:01.163

您可以使用单行块

```
can(:destroy, User) { |u| u.posts.empty? } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:53:04.643

试试这个：

```
can :destroy, User {|u| u.posts.empty? } 
```

# javascript - 更改锚点的 href 和 target

> ID：15364322
> 
> 赞同：3
> 
> 时间：2013-03-12T14:42:45.060
> 
> 标签：javascript, html

我写了这个，所以它用类名改变了锚的href，但我也希望它改变目标，我该如何添加这个？

```
window.onload = function() {
    var change = document.getElementsByTagName('a');
    for (var i = 0; i < change.length; i++) {
        if (change[i].className.match('(^|\\s+)classnamegoeshere(\\s+|$)')) {
          change[i].href = "/urlgoeshere";
            break;
        }      
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T14:44:00.633

```
change[i].setAttribute('target', '_blank'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:03:20.570

尝试这个

```
window.onload = function() {
  var change = document.getElementsByTagName('a');
  for (var i = 0, j =change.length; i < j ; i++) {
     if ((' ' + change[i].className + ' ').indexOf(' ' + "smeCls" + ' ') > -1) {
         change[i].href = "http://www.google.com";
     }      
  }
} 
```

# .net-4.0 - 为什么在 TeamCity 上运行此 MSpec 测试时会出现无效操作异常（非 STA 线程？）？

> ID：15364328
> 
> 赞同：2
> 
> 时间：2013-03-12T14:43:08.403
> 
> 标签：.net-4.0, teamcity, mspec, sta

作为我的应用程序迁移到 .NET 4 的一部分，我正在努力让一些 WPF 单元测试再次与 TeamCity 一起工作。

在以某种方式使用 WPF 控件（例如 ListItem）的所有测试中，我得到了一个以前没有得到的异常：

```
System.InvalidOperationException: The calling thread must be STA, because many UI components require this. 
```

我明白是什么意思，查了之后发现我的线程确实是MTA，不是STA。

我的问题是我不知道如何解决这个问题，以及这个问题可能来自哪里......它是 TeamCity 的设置吗？规格？再一次，它在我切换到 .NET 4 之前有效。

我尝试了许多不同的解决方案，但没有任何效果。

我也有点困惑，之前没有人报告过这个（使用我特定的 TeamCity + MSpec + WPF 测试堆栈），这可能意味着我在某处做错了什么。

如果你有线索，请告诉我！

完全例外：

```
System.InvalidOperationException: The calling thread must be STA, because many UI components require this.

 at System.Windows.Input.InputManager..ctor()
   at System.Windows.Input.InputManager.GetCurrentInputManagerImpl()
   at System.Windows.Input.KeyboardNavigation..ctor()
   at System.Windows.FrameworkElement.EnsureFrameworkServices()
   at System.Windows.FrameworkElement..ctor()
   at System.Windows.Controls.Control..ctor()
   at MyCompany.Dashboard.Client.Plugins.Common.Controls.Grids.CashflowGrid.ViewModel.ConfigureViewModel.CreateItem(String name) in d:\Program Files\JetBrains\BuildAgent2\work\6dd9af6ae2f9bbb9\Code\Src\MyCompany\Dashboard\Client\Plugins\Common\Controls\Grids\CashflowGrid\ViewModel\ConfigureViewModel.cs:line 171
   at MyCompany.Dashboard.Client.Plugins.Common.Controls.Grids.CashflowGrid.ViewModel.ConfigureViewModel.Initialise(Type type, IList`1 currentSelection, Action`1 selectionChangedCallback) in d:\Program Files\JetBrains\BuildAgent2\work\6dd9af6ae2f9bbb9\Code\Src\MyCompany\Dashboard\Client\Plugins\Common\Controls\Grids\CashflowGrid\ViewModel\ConfigureViewModel.cs:line 37
   at UnitTests.Plugins.Common.Controls.Grids.CashflowGrid.ViewModel.when_some_items_are_selected_on_the_chosen_list.<.ctor>b__1() in d:\Program Files\JetBrains\BuildAgent2\work\6dd9af6ae2f9bbb9\Code\Src\UnitTests.Plugins.Common\Controls\Grids\CashflowGrid\ViewModel\ConfigureViewModelTests.cs:line 82 
```

对于这个异常，代码只是试图实例化一个 ListBoxItem，没什么特别的，但是在 MTA 线程上这样做会破坏它。

我尝试了什么：

*   将当前线程设置为 STA

    Thread.CurrentThread.SetApartmentState(ApartmentState.STA)

它当然不起作用，因为它只有在线程开始之前才有可能

*   在初始化为 STA 的单独线程中运行代码：非常复杂，因为由于 MSpec 的性质，不同的方法在不同的时间被调用，所以你不能在同一个线程下运行所有​​东西。更准确地说，您不能在与“因为”语句相同的线程上运行“建立上下文”。

*   使用 STAThread 属性...是的，但在哪里？在我尝试过的任何地方都没有工作过

失败测试示例：

```
public class StaTestExample
{
    Establish context = () => _control = new ListBox();

    It should_not_be_null = () => _control.ShouldNotBeNull();

    protected static Control _control;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T11:49:49.610

现在可以了。

但问题是我们无法解释它。它仍然在不同的构建服务器上失败，但我们不关心这个。

万一有人遇到这个问题，我们做了什么：

*   禁用测试覆盖率
*   禁用 MSPec 任务：构建变为绿色
*   重新启用覆盖范围和 MSpec：它有效...

奇怪的是，在不同的构建服务器（我们不再使用的旧服务器）上应用了确切的过程，但它仍然失败。

没有什么其他我们能想到的改变了。

所以这有点神秘......我希望它不会回来咬我们！

# c# - 您如何从 MySQL 数据库中选择数据以用于组合框选择？

> ID：15364330
> 
> 赞同：1
> 
> 时间：2013-03-12T14:43:13.427
> 
> 标签：c#, mysql, database, combobox

因此，通常当您创建一个组合框时，您将成为放置选择值的人，但我希望我的组合框中的数据将从我的数据库 mysql 中选择。我要怎么做？

我被困在从我的 sql 中选择数据到组合框中！

到目前为止，这是我的代码！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

using MySql.Data.MySqlClient;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            MySqlConnection connection = null;            
            string hostname = "localhost";
            string database = "aparece_hoteldb";
            string username = "root";
            string password = "";
            connection = new MySqlConnection("host=" + hostname + 
                                            ";database=" + database + 
                                            ";username=" + username + 
                                            ";password=" + password + ";");

            string table = "reservations";
            string query = "SELECT * FROM " + table;
            connection.Open();
            MySqlDataAdapter da_res = null;
            DataSet ds_res = null;
            ds_res = new DataSet();
            da_res = new MySqlDataAdapter(query, connection);
            da_res.Fill(ds_res, table);

            dataGridView2.DataSource = ds_res.Tables[table];

        }

        private void label2_Click(object sender, EventArgs e)
        {

        }

        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:59:57.713

好的，因此将数据列表绑定到组合框，尤其是当它是您已经拥有的组合框时，将非常简单。所以，在这一行之后：

```
dataGridView2.DataSource = ds_res.Tables[table]; 
```

让我们再添加一些：

```
comboBox1.DisplayMember = "YourDisplayField";
comboBox1.ValueMember = "YourValueField";
comboBox1.DataSource = ds_res.Tables[table]; 
```

这会将数据绑定到组合框。但是，让我们分解一下。`DisplayMember`是您希望用户看到的字段值。通常这是行的名称或简要描述。`ValueMember`是您要绑定到`SelectedValue`属性的字段。当用户在组合框中选择一个项目时，`SelectedValue`将被设置为该字段的值。

现在你可以消费一个更好的事件`SelectedIndexChanged`，现在你可以消费了[`SelectedValueChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listcontrol.selectedvaluechanged.aspx)。每次用户选择一个新值时，该事件都会触发，您可以根据需要使用它。

`DataRow`如果需要，可以通过`SelectedItem`像这样转换组合框的属性来获得实际值：

```
var row = comboBox1.SelectedItem as DataRow; 
```

或者你可以抓住那个价值并用它做点什么：

```
var val = comboBox1.SelectedValue; 
```

您可以将其转换为该`ValueMember`字段的任何类型。如果您将其设置为一个`int`字段，那么您可能会执行以下操作：

```
var val = (int)comboBox1.SelectedValue; 
```

如果它是一个`string`字段，那么可能是这样的：

```
var val = comboBox1.SelectedValue as string; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:50:45.383

假设您得到 sql 返回的单个列，您可以设置组合框的数据源以从数据表或数据集中填充它。

```
comboBox1.DataSource = myDataTable; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-08T08:40:52.280

//在FORM_LOAD里面，

```
private void Form7_Load(object sender, EventArgs e){
        cboFloor.SelectedIndex = -1;
        cboFloor.DropDownStyle = ComboBoxStyle.DropDownList;
        GetFloor();
        } 
```

//创建一个函数并插入此代码。

```
private voide GetFloor{
        string query = @"SELECT DISTINCT floor FROM tbroom ORDER BY floor ASC";

        try
        {
            con.Open();
            MySqlCommand cmd = new MySqlCommand(query, con);
            MySqlDataReader rdr;
            rdr = cmd.ExecuteReader();
            while (rdr.Read())
            {
                cboFloor.Items.Add(rdr["floor"]);

            }
        }
        catch (MySqlException mysqlex)
        {
            MessageBox.Show(mysqlex.Message.ToString());
        }
        finally
        {
            con.Close();
        }} 
```

# c# - 使用悲观锁定向 Microsoft.ApplicationServer.Caching.DataCache 添加项目？

> ID：15364331
> 
> 赞同：3
> 
> 时间：2013-03-12T14:43:15.830
> 
> 标签：c#, azure, locking, pessimistic-locking

我正在服务器端的 Web 服务器上的缓存层上工作，使用 Azure 共享缓存来减少对数据库的请求量，从而使东西运行得更快（希望如此）。我遇到的问题是如何使整个 endevour 线程安全。我似乎没有找到一种可靠且可用的方法来锁定 DataCache 中的键。我缺少的是一种在密钥上存储任何内容之前预先锁定密钥的方法，这样我就可以添加一个值，而不会有另一个线程同时尝试做同样的事情的风险。

到目前为止，我一直只关注悲观锁定，因为这就是线程安全对我来说最有意义的方式，我想确保我正在处理的东西被锁定。

我明白，如果我要使用悲观锁定，我只负责使用与此相关的方法。混合使用会弄乱整个锁定机制（来源： http: [//go4answers.webhost4life.com/Example/datacacheput-unlocking-key-77158.aspx](http://go4answers.webhost4life.com/Example/datacacheput-unlocking-key-77158.aspx)）。

```
So basicly I only have access to these methods:
value GetAndLock(key, out DataCacheLockHandle);
void PutAndUnlock(key, value, DataCacheLockHandle);
void Unlock(key, DataCacheLockHandle); 
```

问题是，如果我尝试获取尚未在缓存中的内容，“GetAndLock”会引发异常。同时，我向缓存中添加内容的唯一方法是“PutAndUnlock”，除非我成功执行“GetAndUnlock”，否则无法使用该方法。

实际上，不可能向缓存中添加任何新内容，唯一可以做的就是替换已经存在的内容（这将一事无成）。

所以在我看来，在“GetAndLock”抛出异常的情况下，我被迫使用乐观的“Put”。但是，根据我所读到的内容，乐观的“Put”会破坏使用“GetAndLock”实现的任何现有锁，因此这将破坏线程安全的整个尝试。

```
Example plan:
1\. Try to GetAndLock
2\. In case of nothing there exception: 
     - Put a dummy item on the key. 
     - GetAndLock again.
3\. We have a lock, do computations, query database etc
4\. PutAndUnlock the computed value

One of probably several ways it would screw up:
Thread1: Tries to GetAndLock, gets nothing there exception
Thread2: Tries to GetAndLock, gets nothing there exception
Thread1: Put a dummy item on the key
Thread1: GetAndLock again, lock achieved
Thread2: Put a dummy item on the key (destroying Thread1:s lock)
Thread2: GetAndLock again, lock achieved
Thread1: We think we have a lock, do computations, query database etc
Thread2: We have a lock, do computations, query database etc
Thread1: PutAndUnlock the computed value (will this throw an exception?)
Thread2: PutAndUnlock the computed value 
```

基本上，这两个线程可以同时向同一个键写入不同的东西，而忽略它们都认为自己拥有的锁。

我唯一的结论可能是，DataCache 的悲观锁定是功能不完整，完全无法使用。我错过了什么吗？有没有办法解决这个问题？

我所缺少的只是一种在钥匙上存储任何东西之前抢先锁定钥匙的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T02:24:09.523

乔纳森，

您是否考虑过将内容添加到缓存中的这种逻辑（请原谅我的伪代码）？

> public bool AddToCache（字符串键，对象值）{

```
DataCache dc = _factory.GetDefaultCache();  
object currentVal = dc.Get(key);

if (currentVal == null) {
    dc.Put(key, value);
    currentVal = dc.GetAndLock(key);

    if (value == currentVal) {
        //handle this rare occurrence + unlock.
        return false;
    } else {
                   dc.Unlock(key);
            }
} else {
    currentVal = dc.GetAndLock(key);
    dc.PutAndUnlock (key, value);
}

return true; 
```

}

# ruby - 在 ruby 测试框架下执行特定测试

> ID：15364334
> 
> 赞同：0
> 
> 时间：2013-03-12T14:43:20.660
> 
> 标签：ruby

我在 ruby​​ 测试框架 1.8.7 下有一组测试用例

假设我有一个名为 check.rb 的 ruby​​ 文件，其中包含不同的测试，如 test_a_check、test_b_check 和 test_c_check。

现在当我运行文件 ruby​​ check.rb 时，所有的测试用例都会被执行。

我的部分问题是，我想在运行时向脚本传递一个新参数，比如 ruby​​ check.rb --sunset

基于日落参数，我希望我的脚本只执行 test_a_check 和 test_b_check 而不是 test_c_check。

默认情况下，如果我运行脚本，所有测试都应该被执行，但是当 --sunset 参数被传递时，只有三个测试中的两个应该被执行。

我有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:44:59.013

如果您使用的是 minitest，您可以通过以下方式指定方法

```
ruby check --name test_method_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:03:11.560

如果是通用的测试框架，就看它的手册，如果是你个人的测试脚本，就看ARGV：

```
test_a_check
test_b_check
test_c_check if ARGV[0] != '--sunset' 
```

# c# - 随机错误：试图读取或写入受保护的内存

> ID：15364337
> 
> 赞同：11
> 
> 时间：2013-03-12T14:43:27.890
> 
> 标签：c#, memory-leaks, shapefile, sharpmap, geoapi

我们有一个使用 WCF 服务的 C# .Net 应用程序。并且该应用程序部署在我们的生产服务器中的 Windows 服务应用程序下。该模块的一部分负责为工人今天将要工作的较小区域创建形状文件（（*.shp，*.dbf）并将它们发送到PDA。

要编写形状文件，我们使用第三方 dll，NetTopologySuite

```
GisSharpBlog.NetTopologySuite.IO.ShapefileWriter 
```

这也在 C# 中。**（我不确定它引用** 的任何 dll 是否使用非托管代码。）系统可能会在一段时间内正常工作，比如一周。然后突然我们得到一个例外说

```
Attempted to read or write protected memory. 
This is often an indication that other memory is corrupt. 
```

来自 Write 方法，我们将几何集合写入形状文件。

```
sfw.Write(FileName, new GeometryCollection(gc.ToArray())); 
```

**（GeometryCollection 也来自第三方 dll，GeoAPI.dll）**

此错误会导致整个服务中断并使其无法正常工作。然后我们将重新启动服务并尝试再次运行相同的数据，它会再工作一周，直到它再次崩溃。它仅在生产中和随机时间发生。我们无法找到问题的原因。

许多论坛建议这可能是因为某些非托管代码中的内存泄漏。但我们找不到哪一个。

我们还准备重写创建新形状文件的部分。请帮我解决这个问题。如果需要更多详细信息，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T16:33:24.010

根据我的经验，该消息是内存泄漏的结果。如果我遇到您的情况，尤其是您正在使用第三方 DLL，这就是我会做的事情。

1) 监视您的 WCF 服务器并查看 DLLHost.exe 和任务管理器中的 aspnet 服务发生了什么。我感觉您的第三方 DLL 存在内存泄漏，导致这 2 个服务膨胀并达到服务器内存的限制。这就是为什么它工作了一段时间然后突然停止工作的原因。

2) 确定何时可以回收服务器内存和应用程序池的良好时间表。由于这个问题很猖獗，您可能希望在每个午夜或没有人积极使用它时执行此操作。

3）编写一个好的错误记录代码，以准确了解在它陷入困境期间发生了什么。我会将以下信息放在错误日志中：您传递的参数、遇到该问题的用户等。这样您就可以确切地知道发生了什么。

4) 检查事件查看器，因为其中可能有一些可以查明问题的信息。

4) 做完 1、2、3 之后，我会打电话给你的第三方 DLL 供应商，看看他们能做些什么来帮助你。您可能需要提供从上述 1、2、3 和 4 项中收集的信息。

祝你好运，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T20:12:45.667

我认为您在第三个库中有一些非托管代码正在获取受系统保护或由其他应用程序使用的地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T10:29:59.557

您的第三方 DLL 中有一个`Access Violation`（指向不属于您的应用程序空间的内存的指针，包括`null`/mass - - 地址）。`0x0`

否则，可能`COMObject`是您正在使用的一些非托管导致此错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-27T12:47:30.290

这个错误的随机性向我暗示这可能是线程问题。具体来说，`Write`方法`ShapefileWriter`可能已经被调用，在线程中被延迟然后你调用`Close`. 然后，延迟`Write`方法会尝试覆盖已关闭（且受保护）的文件，这可能会导致您看到的错误。

这纯粹是猜测，因为没有太多代码可以做出更好的猜测，但是我使用视频编写库遇到过这个问题，所以在你的情况下可能是一样的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-08-08T17:32:02.410

检查以确保线程中没有线程。这就是我遇到此错误时发生的情况。有关详细信息，请参阅此链接：[尝试读取或写入受保护的内存。这通常表明其他内存已损坏](https://stackoverflow.com/questions/9982692/attempted-to-read-or-write-protected-memory-this-is-often-an-indication-that-ot/)

# c# - 为未知的提前线程线程化更高的优先级

> ID：15364338
> 
> 赞同：0
> 
> 时间：2013-03-12T14:43:28.853
> 
> 标签：c#, .net, multithreading

我创建了大约 5000 个后台工作人员，他们在控制台应用程序中进行密集工作。我还使用了一个实例化对象的外部库，比如 ObjectX。在某个时刻，比如 t0，ObjectX 尝试从 os 线程池中获取一个线程并启动它，但我无法控制它如何获取该线程。对于 100 名后台工作人员来说一切正常。对于 1000 个后台工作人员，ObjectX 在 t0 之后大约需要 10 分钟才能获取并启动一个线程。

1.  有没有办法提前为对象将来启动的任何线程设置高优先级？

2.  正如我认为 1 的答案是“否”，有没有办法限制后台工作人员的优先级，以便以某种方式支持其他一切？即使我只想“支持”ObjectX。

目标是始终拥有可用资源来运行由 ObjectX 启动的线程，无论机器有多过载。

我在 Windows 64 位机器上使用 C# 和 .Net fr 3.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:11:34.610

线程的工作方式是操作系统为它们提供处理器时间。当这种情况发生时，这称为上下文切换。上下文切换大约需要 2000-8000 个周期（即取决于处理器 2000-8000 条指令）。如果操作系统有许多 CPU 或内核，它可能不需要将 CPU 从一个线程中取出并交给另一个线程——避免上下文切换。每个 CPU 一次只能运行一个线程，当您需要 CPU 的线程多于 CPU 时，您将强制进行上下文切换。上下文切换的执行速度不超过系统时间片（客户端每 20 毫秒，服务器每 120 毫秒）。

如果您有 5000 个后台工作人员，那么您实际上有 5000 个线程。这些线程中的每一个都可能在争夺 CPU 时间。在客户端版本的 Windows 上，这意味着每秒 250,000 次上下文切换。即每秒 500,000,000 到 2,000,000,000 个周期**仅用于线程之间的切换**。（即超过你的线程正在执行的工作）*如果它甚至可以每秒处理那么多上下文切换*。

推荐的做法是每个处理器只有一个 CPU 绑定线程。CPU-bound 线程是一个花费很少时间“等待”的线程。UI 线程不是 CPU 绑定线程。如果您的后台工作线程花费大量时间等待锁定，那么它们也可能不受 CPU 限制——但一般来说，后台工作线程受 CPU 限制。（否则，使用后台工作人员有什么意义？）。

此外，操作系统会花费大量时间来确定接下来需要哪个线程来获取 CPU。当您开始更改线程优先级时，您会干扰它，并且大多数时候最终会使您的整个系统（不仅仅是您的应用程序）变慢而不是更快。

# 更新：

与之相关的是，创建一个新线程大约需要 200,000 个周期，而销毁一个线程大约需要 100,000 个周期。

## 更新 2：

如果问题的推动力不仅仅是“如果可以做到”，而是能够扩展工作负载，那么正如@JoshW/@Servy 提到的那样，使用生产者/消费者模式之类的东西将允许可扩展性，从而促进横向通过队列或服务总线扩展到多台计算机/节点。简单地启动大量线程是不可扩展的，超出了 CPU 的数量。如果您真正想要的是一种可以横向扩展的架构，因为“可用资源......机器的过载程度”根本不可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:26:07.853

但是，我个人认为这是一个坏主意……鉴于您对其他答案的评论以及您的要求“无论创建了多少后台工作人员，ObjectX 都会尽快运行”……您可以想象强制您的后台工作人员使用 ManualResetEvent 进行阻止。

例如，在您的工作代码的顶部，您可以使用 WaitOne 方法阻止手动重置事件。此手动重置可以是静态的，也可以作为输入参数传递，并且无论您的 ObjectX 被实例化/调用或其他什么，您都可以在 ManualResetEvent 上调用 .Reset 方法。这将阻止 WaitOne 线上的所有工作人员。接下来在运行 ObjectX 的代码的底部，调用 ManualResetEvent.Set() 方法，这将解除对工作人员的阻塞。

请注意，这不是管理线程的有效方法，但如果您“只需要让它工作”并且以后有时间改进它......我想这是一种可能的解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-12T15:01:56.937

> 目标是始终拥有可用资源来运行由 ObjectX 启动的线程，无论机器有多过载。

那么线程优先级可能不是正确的工具。[请记住，线程优先级是邪恶的](http://www.codinghorror.com/blog/2006/08/thread-priorities-are-evil.html)

一般来说，windows 不是实时操作系统；特别是，win32 甚至没有尝试软实时（IIRC，NT 内核在某些时候尝试过至少支持软实时子系统，但我可能错了）。因此，无法保证可用资源或时间。

另外，您是否担心系统中的其他线程？这些线程不在您的控制范围内（如果其他线程已经处于系统最大优先级怎么办？）。如果您担心应用程序中的线程......您可以控制和限制它们，使用更少的线程/工作人员来做更多的工作（例如，以更大的单位批量工作，并将其提交给工作人员，或者使用 TPL 或其他将为您处理和限制线程使用的工具）

也就是说，您可以在创建线程时进行拦截（例如查看这个问题[https://stackoverflow.com/a/3802316/863564](https://stackoverflow.com/a/3802316/863564)）查看它是否是为 ObjectX 创建的（例如，检查其名称）并使用 SetThreadPriority 来增强它。

# java - 将数组值导出到 csv 文件 java

> ID：15364342
> 
> 赞同：5
> 
> 时间：2013-03-12T14:43:33.363
> 
> 标签：java, arrays, csv

我只需要帮助将数组元素导出到 csv 文件。我不知道我的代码有什么问题。任何帮助都将不胜感激。谢谢。

```
for (int index = 0; index < cols.length; index++)
{
    FileWriter fw = new FileWriter(newFileName);
    if (index == cols.length - 1)
    {
        fw.append(cols[index]);
    }
    else
    {
        fw.append(cols[index]);
        fw.append(",");
    }

} 
```

当我运行这个。我的 csv 文件没有任何反应。事实上，它会抹去一切。请帮忙。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-12T14:52:32.097

假设您将 String 存储在数组中，我发布了一个替代解决方案：

```
BufferedWriter br = new BufferedWriter(new FileWriter("myfile.csv"));
StringBuilder sb = new StringBuilder();

// Append strings from array
for (String element : array) {
 sb.append(element);
 sb.append(",");
}

br.write(sb.toString());
br.close(); 
```

最好的祝福。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T14:45:37.153

您需要[**刷新**](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStreamWriter.html#flush%28%29)写入的数据，[**关闭**](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStreamWriter.html#close%28%29)**FileWriter**。

```
 finally {
        fw.close(); // close will automatically flush the data 
      } 
```

此外，请改用[**BufferedWriter**](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedWriter.html)或[**PrintWriter**](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html) **，因为它们比FileWriter**高效且进化。

顺便说一句，在你的 for 循环中声明 FileWriter。目前它将覆盖每次迭代的列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T14:54:49.127

如果您将更有效的 BufferedWriter 与 try-with-resources 结合使用，则编写器会自动关闭。（在 Java 7 中）

```
try {BufferedWriter br = new BufferedWriter(new FileWriter(newFileName)) {
    // your code
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T14:49:36.477

你必须使用

```
 FileWriter fw = new FileWriter(newFileName,true); 
```

*追加*内容，否则文件将被覆盖。

该`append`方法的名称可能会产生误导，实际上它*附加*到内部缓冲区，而不是文件内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-14T17:53:33.180

最好的方法是使用 CSVWriter。如果您有一个 Maven 项目，请将其添加为依赖项：

```
 <dependency>
      <groupId>com.opencsv</groupId>
      <artifactId>opencsv</artifactId>
      <version>4.4</version>
  </dependency> 
```

然后你可以像这样使用它：

```
try {
        //the list that contains the String arrays
        List<String[]> whatever = new ArrayList<>();
        CSVWriter writer = new CSVWriter(new FileWriter(csvFilename));
        String[] header = "Name,Age,Height,etc..".split(",");
        writer.writeNext(header);
        writer.writeAll(whatever, true); //And the second argument is boolean which represents whether you want to write header columns (table column names) to file or not.
        writer.close();
        System.out.println("CSV file created succesfully.");
    } catch (Exception e) {
        System.out.println("exception :" + e.getMessage());
    } 
```

# php - 将文本框输入插入数组php

> ID：15364343
> 
> 赞同：0
> 
> 时间：2013-03-12T14:43:34.250
> 
> 标签：php, arrays

我想知道是否可以将文本字段输入直接插入到数组中，然后将相同的值插入到 mysql 数据库中。这是我想使用的想法，但如果不可能的话，不想浪费时间。我还在学习PHP

```
if($Number == 1){
    echo '<table border="0">';
    echo '<th>'.'Attribute'.'</th>';
    echo '<th>'.'Score'.'</th>';

    echo '<tr>';
    //First Form
    echo '<td>'.'<input type="text" size="35" name="Attributes[]">'.'</td>';   
    echo '<td>'.'<select id="select55" name ="score[]">
        <option>-select-</option>
        <option>10</option>
        <option>9</option>
        <option>8</option>
        <option>7</option>
        <option>6</option>
        <option>5</option>
        <option>4</option>
        <option>3</option>
        <option>2</option>
        <option>1</option>
        </select>'.'</td>';            
    echo '</tr>'; 
    echo '</table>';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:24:06.040

我想我明白你在说什么，但我不确定。你是说你想允许用户在一个表单中输入任意数量的分数吗？如果你想使用纯 php 和 html 的方法是使用两种形式。你会像这样设置它。

**形式**

```
<?php 
if (empty($_GET["entries"]))
{ 
?>

<p>How many entries do you want to make?</p>
<form action="sadg.php" method="get">
    <input type="text" name="entries" placeholder="Number of entries" />
    <br/>
    <input type="submit" name="submit_entries" />
</form>

<?php 
}
else
{
    //Second form
    if (isset($_POST["submit"]))
    {
        //Process form
    }
    else
    {
        echo '<form action="" method="post">';

        for ($count = 0; $count < $_GET["entries"]; $count++)
        {
            echo '<input type="text" name="scores">';
        }

        echo '<input type="submit" name="submit"></form>';
    }
}
?> 
```

希望这是有道理的。您首先提示他们进行输入，将该数字保存为页面参数，然后根据该页面参数显示适当数量的表单。

# ios - 错误 Domain=com.flickr Code=108 “操作无法完成

> ID：15364347
> 
> 赞同：4
> 
> 时间：2013-03-12T14:43:45.403
> 
> 标签：ios, objective-c, uiimage, flickr

我使用他们的标准[API](https://github.com/lukhnos/objectiveflickr)将图像图像分享到*Flickr*。

互联网没有问题，有时它会上传图像，有时我会收到这样的错误。（当我按下自动按钮时）

可以帮助解决或解释这个问题吗？它是否与 API、我的共享代码、互联网或其他东西相关联？谢谢你。

> 错误域 = com.flickr 代码 = 108 “操作无法完成。无效的 frob” UserInfo = 0x1fdf10e0 {NSLocalizedFailureReason = Invalid frob}

```
OFFlickrAPIRequest *request = ....;
...
NSData *imageData = UIImageJPEGRepresentation(image, 0.8);
NSInputStream *imageStream = [NSInputStream inputStreamWithData:imageData];

[request uploadImageStream:imageStream suggestedFilename:@"Image.jpg" MIMEType:@"image/jpeg" arguments:[NSDictionary dictionaryWithObjectsAndKeys: @"text", @"title", nil]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:53:53.160

尝试这个：

1.  设置[burpsuite 代理](http://portswigger.net/burp/)
2.  将您的模拟器/mac/iphone 指向代理
3.  关闭 flickr API 客户端上的 SSL。如果您无法为 Flickr API 启用 SSL，请创建自签名证书，将其导入 iPhone，将其导入 burpsuite 并启用 https 代理。
4.  提出几个请求，直到你得到错误。
5.  检查 burpsuite 中的错误。

本教程中描述了大部分内容：[拦截需要有效 SSL 证书的 iPhone 和 iPad SSL 连接](http://community.securusglobal.com/2012/09/11/how-to-intercept-iphone-and-ipad-ssl-connections-that-require-a-valid-ssl-certificate/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:43:30.410

我花了很多时间调试这个错误：

```
Flickr says: Invalid frob 
```

但我确信使用 frob 字符串一切正常。

我知道这是一个糟糕的解决方案，甚至不是解决方案，但我让它工作了：所以我所做的是在收到如此罕见的错误后，我使用 save frob 再次发出令牌请求，一切正常。（如果 frob 真的无效，它如何从下一次尝试上传它）。

# c# - 根据函数C#中的数组检查数组的值

> ID：15364348
> 
> 赞同：0
> 
> 时间：2013-03-12T14:43:45.907
> 
> 标签：c#, arrays, file-io, console-application, scope

我是 C# 的新手，我确信我正在编写一个程序，如果由于现有 3rd 方程序的限制，它们满足特定的时间标准，则可以移动文件。该程序以其当前容量工作，但是我想让它检查目标中具有相同名称的文件并更改正在移动的文件的名称，因此如果已经存在具有一样的名字。在自定义类 GloDir 中还声明了一些 fname 和 target，并在其他函数中使用。

这有效，但不检查目标中的文件；

```
DirectoryInfo sourceInfo = new DirectoryInfo(GloDir.fname); 
FileInfo[] sourceFiles = sourceInfo.GetFiles("*.zip");                  
//creates array of all files ending in .zip
DirectoryInfo destInfo = new DirectoryInfo(GloDir.target);
FileInfo[] destFiles = destInfo.GetFiles("*.zip");

if (sourceFiles.Length == 0) // check to see if files are present. if not die.
{
    return;
}

foreach (var sFileInfo in sourceFiles)
{
    string sFip = sFileInfo.ToString();                                   
    //file info to string
    string fileName = System.IO.Path.GetFileName(sFip);                    
    //get file name
    string sourceFile = System.IO.Path.Combine(GloDir.fname, fileName);   
    //Full filename and path
    string targetFile = System.IO.Path.Combine(GloDir.target, fileName);  
    //New Target and Path

    DateTime createdOn = File.GetCreationTime(sourceFile);              
    //get file creation time
    DateTime rightNow = DateTime.Now;                                   
    //Variable for this moment

    var difference = rightNow - createdOn; 
    //Different between now and creation

    var minutos = difference.TotalMinutes;
    //turn difference into minutes

    //If time between creation and now is greater than 120 minutes move file to new directory
    if (minutos >= 1)                                             
    {
        //Console.Write(minutos + "  Old   - Moving! -");               
        //debug console msg
        System.IO.File.Move(sourceFile, targetFile);
        //move file to new directory
        //System.Threading.Thread.Sleep(1555);
        //debug sleep
    }
} 
```

为了检查目标中的文件，我将其更改为添加一个 If 语句，该语句检查目录中的任何文件，然后是一个嵌套的 foreach 循环，该循环比较值并且也可以工作。唯一的问题是当尝试在循环中使用字符串 declard 或 if 语句时，我复制了代码并添加了以下内容。我还留下了一些控制台写入和睡眠，让我可以看到最终代码中不会出现的程序功能；

```
DirectoryInfo sourceInfo = new DirectoryInfo(GloDir.fname); 
FileInfo[] sourceFiles = sourceInfo.GetFiles("*.zip");
//creates array of all files ending in .zip
DirectoryInfo destInfo = new DirectoryInfo(GloDir.target);
FileInfo[] destFiles = destInfo.GetFiles("*.zip");

if (sourceFiles.Length == 0)
// check to see if files are present. if not die.
{
    //Console.Write("no files present");
    //debug console msg
    return;
}

foreach (var sFileInfo in sourceFiles)
{
    string sFip = sFileInfo.ToString();               
    //file info to string
    string fileName = System.IO.Path.GetFileName(sFip);        
    //get file name
    if (destFiles.Length != 0)
    {
        foreach (var dFileInfo in destFiles)
        {
            string dFip = dFileInfo.ToString();  
            //file info to string
            string dfileName = System.IO.Path.GetFileName(dFip);     
            //get file name

            if (dfileName == fileName)
            {
                string newFilename = "Duplicate" + fileName;
                Console.Write(newFilename + "dup change name");
                System.Threading.Thread.Sleep(1000);
            }
            else
            {
                string newFilename = fileName;
                Console.Write(newFilename + "dest files no duplicate");
                System.Threading.Thread.Sleep(1000);
            }
        }
    }
    if (destFiles.Length == 0)
    {
        string newFilename = fileName;
    }
    string sourceFile = System.IO.Path.Combine(GloDir.fname, fileName);   
    //Full filename and path
    string targetFile = System.IO.Path.Combine(GloDir.target, newFilename);  
    //New Target and Path

    DateTime createdOn = File.GetCreationTime(sourceFile);
    //get file creation time
    DateTime rightNow = DateTime.Now;           
    //Variable for this moment

    var difference = rightNow - createdOn;
    //Different between now and creation
    var minutos = difference.TotalMinutes;
    //turn difference into minutes

    //If time between creation and now is greater than 120 minutes move file to new directory
    if (minutos >= 1)                                             
    {
        System.IO.File.Move(sourceFile, targetFile);
        //move file to new directory
    }
} 
```

每次它停下来并说 newFilename 变量在当前上下文中不存在，即使它应该根据目标目录的条件创建。我是否需要以不同的方式删除字符串 newFilename 以便可以在 if 语句和循环之外看到它？我确信这是一个简单的错误或我还没有学会的错误。这也可能是变量范围的问题，但考虑到另一个变量也是字符串，我不这么认为。再次，我是 C# 的新手，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:45:27.083

这是错误的：

```
 if (destFiles.Length == 0)
        {
                string newFilename = fileName;
        } 
```

`newFilename`仅存在于if 测试中*。*

将其替换为：

```
string newFilename = string.Empty;
if (destFiles.Length == 0)
{
    newFilename = fileName;
} 
```

之后您就可以使用它了。

您已在代码中多次执行此操作。

这篇关于[变量作用域](http://msdn.microsoft.com/en-us/library/ms973875.aspx)的 MSDN 文章包含您可能需要的有关此主题的所有信息。

# jquery - jQuery AJAX .Post 无法使用 Bootstrap

> ID：15364352
> 
> 赞同：3
> 
> 时间：2013-03-12T14:43:55.797
> 
> 标签：jquery, ajax, twitter-bootstrap

如果我使用传统的 html 表单帖子提交，我的登录表单可以正常工作

```
<form class="form-horizontal" id="loginform">
    <div class="control-group">
        <label class="control-label" for="user_name">
            Username or E-Mail
        </label>
        <div class="controls">
            <input type="text" id="user_name" name="user_name" autofocus>
        </div>
    </div>
    <div class="control-group">
        <label class="control-label" for="password">
            Password
        </label>
        <div class="controls">
            <input type="password" id="password" name="password">
        </div>
    </div>
    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox">Remember me
            </label>
            <br>
            <button type="submit" class="btn" id="submit_login">
                Sign-in
            </button>
        </div>
    </div>
</form> 
```

我不想让页面重定向，而是让用户登录并留在同一页面上。我有下面的 jQuery 来做到这一点

```
$(document).ready(function(){
    $("#submit_login").click(function(){
        var user_name = $("#user_name").val();
        var password = $("#password").val();
        $.post("login.php", {user_name: user_name, password: password});
    });
}); 
```

但这不是发布，我的会议也没有开始。我已经打印了 jQuery 'user_name' 和 'password' 变量，它们从表单中提取了正确的值。“login.php”文件查找的变量也是“user_name”和“password”。运行脚本时没有控制台错误。

是什么导致这里断开连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T19:40:08.567

它是 jQuery val() 方法和 Bootstrap 的 btn 类的组合，默认使用它设置样式的按钮为提交按钮。我换了

```
 var user_name = $("#user_name").val();
    var password = $("#password").val(); 
```

至

```
 var user_name = document.getElementById("user_name").value;
    var password = document.getElementById("password").value; 
```

和

```
<button type="submit" class="btn" id="submit_login"> 
```

至

```
<button type="button" class="btn" id="submit_login"> 
```

并且 AJAX 按预期工作。

关键是将“提交”更改为“按钮”，而不仅仅是一起删除类型分配。如果未指定类型，则按钮默认键入“提交”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:47:28.243

您应该在发送您之前立即阻止默认操作`$.post`以避免默认表单提交，否则您的`$.post`意志（在大多数情况下）将被中止。

```
$(document).ready(function(){
    $("#submit_login").click(function(event){
        event.preventDefault(); // stop form submit
        var user_name = $("#user_name").val();
        var password = $("#password").val();
        $.post("login.php", {user_name: user_name, password: password});
    });
}); 
```

# macos - 管道和正则表达式 bash 输出

> ID：15364358
> 
> 赞同：1
> 
> 时间：2013-03-12T14:44:06.297
> 
> 标签：macos, bash, ffmpeg, terminal, zsh

我正在尝试使用 ffmpeg 获取视频的尺寸。我使用命令`ffprobe video.mov`获取以下数据：

```
ffprobe version 1.0 Copyright (c) 2007-2012 the FFmpeg developers
  built on Jan 14 2013 10:18:07 with Apple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)
  configuration: --prefix=/usr/local/Cellar/ffmpeg/1.0 --enable-shared --enable-gpl --enable-version3 --enable-nonfree --enable-hardcoded-tables --cc=cc --host-cflags= --host-ldflags= --enable-libx264 --enable-libfaac --enable-libmp3lame --enable-libxvid
  libavutil      51\. 73.101 / 51\. 73.101
  libavcodec     54\. 59.100 / 54\. 59.100
  libavformat    54\. 29.104 / 54\. 29.104
  libavdevice    54\.  2.101 / 54\.  2.101
  libavfilter     3\. 17.100 /  3\. 17.100
  libswscale      2\.  1.101 /  2\.  1.101
  libswresample   0\. 15.100 /  0\. 15.100
  libpostproc    52\.  0.100 / 52\.  0.100
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'linebubble.mov':
  Metadata:
    major_brand     : qt
    minor_version   : 0
    compatible_brands: qt
    creation_time   : 2013-03-12 02:59:34
  Duration: 00:00:14.05, start: 0.050000, bitrate: 135 kb/s
    Stream #0:0(und): Video: h264 (Main) (avc1 / 0x31637661), yuv420p, 502x288 [SAR 1:1 DAR 251:144], 137 kb/s, 7.84 fps, 60 tbr, 6k tbn, 12k tbc
    Metadata:
      creation_time   : 2013-03-12 02:59:34
      handler_name    : Core Media Data Handler 
```

现在我想将它通过管道传递到一个正则表达式中，以便在 倒数第四行获得**502x288 。**

我已经看到了一些使用 python 和 perl 的解决方案，但我希望这是简单的 bash。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:47:18.753

试试这个 ：

```
$ ffprobe video.mov 2>&1 | grep -oP '^\s+Stream.*?,\s+\K\d{2,}x\d{2,}' 
502x288 
```

如果您没有`grep -oP`开关：

```
$ ffprobe video.mov 2>&1 |
    perl -lne 'print $& if /^\s+Stream.*?,\s+\K\d{2,}x\d{2,}/'
502x288 
```

此解决方案不是基于第 N 列，我认为搜索逗号后跟空格后跟 2 个至少 2 位数字的整数更可靠`x`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:48:36.340

你可以用 2 打方法做到这一点。这是一个使用`grep`and的方法`awk`：

```
ffprobe video.mov 2>&1 | grep 'Stream #0' | awk '{print $10}' 
```

# mysql - 用户权限问题，wordpress，phpmyadmin，我的主机提供商，我希望就是这样

> ID：15364362
> 
> 赞同：0
> 
> 时间：2013-03-12T14:44:12.770
> 
> 标签：mysql, wordpress, phpmyadmin, privileges

所以我一直在尝试在已经工作的网站旁边安装一个新的 wordpress 网站。我想要有 2 个不同的数据库，所以我创建了一个新的，我并没有走太远。我在 /wp-admin/ 中收到消息“无法选择数据库”，并且在 sql_error 中有：“用户 'user'@'host' 拒绝访问数据库 'database'”

*   创建数据库后，去phpmyadmin创建一个新用户和他的权限，但是phpmyadmin中没有权限选项卡。我做了空饼干和所有，但没有效果。
*   我的主机提供商提供“mysql 数据库”工具。有一个下拉列表可以在模式和用户之间建立关联，所以我做到了，但没有办法控制它是否真的被考虑在内
*   我安装了chive，但我也找不到权限选项卡
*   使用 sql 查询，在 phpmyadmin 中，我无法添加任何权限，我得到“在 my_schema 上拒绝访问 my_root_user”
*   当我在新架构上尝试使用旧用户时，这是同样的错误。

有人知道接下来要尝试什么吗？如果那来自我的提供者配置，我怎样才能得到证明？

# ruby-on-rails - 联合两个 where 子句

> ID：15364364
> 
> 赞同：0
> 
> 时间：2013-03-12T14:44:16.483
> 
> 标签：ruby-on-rails

```
# models/micropost.rb

def self.from_users_followed_by(user)
  followed_user_ids = "SELECT followed_id FROM relationships
                       WHERE follower_id = :user_id"
  where("user_id IN (#{followed_user_ids}) OR
        user_id = :user_id", user_id: user.id)
end

def self.in_reply_to(user)
  where("content LIKE :user_login", user_login: '@' + user.login + '%')
end

# models/user.rb

def feed
  Micropost.from_users_followed_by(self).in_reply_to(self) # AND
end 
```

它有效，但我需要用户的微博，然后是用户 OR（不是 AND！）回复用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T21:40:10.987

我知道如何做到这一点的最简单方法是`(Micropost.from_users_followed_by(self) + Micropost.in_reply_to(self)).uniq`

您还可以使用支持 OR 子句的 Squeel gem ( [https://github.com/ernie/squeel/](https://github.com/ernie/squeel/) ) - 但我不确定 Squeel 是否允许您在现有范围上使用 OR 运算符；它可能是也可能不是解决您的麻烦的有效方法。

# arrays - Perl - 匿名哈希图和数组 - 几个问题

> ID：15364365
> 
> 赞同：3
> 
> 时间：2013-03-12T14:44:18.353
> 
> 标签：arrays, perl, perl-data-structures

您好我正在学习 perl，我将在这里发布几个假设。因此，如果我在某处错了，请随时评论和纠正我。

1.  通过以下方式创建哈希（在其他几种方式中）：

    ```
    %numbers = qw(one 1 two 2); 
    ```

2.  创建数组通过以下方式完成：

    ```
    @array = qw(one two); 
    ```

3.  以上结构代表“非匿名”类型。非匿名类型和匿名类型之间的主要区别在于命名类型有一个我可以参考的名称。如果我想创建匿名类型，我需要更改数组中方`()`括号`[]`或`{}`散列中大括号的括号。换句话说，散列的散列是对其他散列的引用的散列。因此我需要`{}`在嵌套 hash 而不是经典 hash中使用`()`。

    ```
    %HoH = (
        flintstones => {
            husband   => "fred",
            pal       => "barney",
        },
        jetsons => {
            husband   => "george",
            wife      => "jane",
            "his boy" => "elroy",  # quotes needed on key.
        },
        simpsons => {
            husband   => "homer",
            wife      => "marge",
            kid       => "bart",
        },
    ); 
    ```

4.  同样的情况也适用于多维数组。多维数组是一个包含对另一个数组的引用的数组，因此需要使用 [] 代替 ()。

    ```
    @array_of_arrays =  ( [ "one", "two", "three" ],
                          [  4,   5,  6,  7  ],
                          [ "alpha", "beta" ]
                        ); 
    ```

5.  如果我有包含每个家庭成员（flinstones、jetsons、simpsons）的“非匿名”哈希，我应该使用哪个结构来创建`%HOH`？

    ```
    $HOH{flinstones} = {%flinstones}; 
    ```

    或者

    ```
    $HOH{flinstones} = \%flinstones; 
    ```

    我假设这`\%flinstones`只是简单地将引用分配给`$HOH{flinstones}`，这意味着我所做的任何事情`%flinstones`都会影响 ，`$HOH{flinstones}`因为它只包含对它的引用。另一方面`{%flinstones}`，类似于将“非匿名”哈希重新转换为“匿名”哈希。这具有`%flinstones`以后可以修改甚至删除的效果，并且不会影响，`$HOH{flinstones}`因为存在对匿名哈希的引用。

6.  循环中的变量会发生什么？当`my $variable;`在循环内发出时，它会覆盖旧的或创建新的，或者它是同一个变量，或者这里会发生什么？

    ```
    for($i=0;$i<4;$i++){
      my $variable=$i;
      print $variable
    } 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:26:59.443

至于问题 5，我假设是问题 1，你可以同时使用。尽管您应该意识到第一种方法：

```
$HOH{flinstones} = {%flinstones} 
```

只是简单地制作散列的浅表副本，将`%flinstones`其扩展为其键和值的列表。然而

```
$HOH{flinstones} = \%flinstones 
```

将散列作为引用传递，以便两个散列指向内存中的相同位置。

至于问题 6，词法范围的变量会发生什么？让我们来看看`perldoc -f my`：

```
A "my" declares the listed variables to be local (lexically) to
the enclosing block, file, or "eval". 
```

for 循环是一个块，这意味着`my`在 for 循环内声明的任何变量都是该循环的本地变量，并且该循环的每次迭代都是本地的。这意味着如果您执行以下操作：

```
for my $number (0 .. 3) {
    print "Number is $_. Last number was $last\n";
    my $last = $_;                       # WRONG!
}   # $last goes out of scope here! 
```

它会给你很多`Use of uninitialized value`警告。您需要扩大范围：

```
my $last = "N/A";  # default value
for my $number (0 .. 3) {
    print "Number is $_. Last number was $last\n";
    $last = $_;
} 
```

现在，我不知道这是否是您故意的，但您可以将这两个问题合二为一：

```
my %HOH;
{ # begin a block to reduce scope of variables
    my %flinstones = (
        husband   => "fred",
        pal       => "barney",
    );
    $HOH{flinstones} = \%flinstones;
} 
... # %flinstones hash is now out of scope, stored only in %HOH 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T17:52:10.637

该[`{ LIST }`](http://perldoc.perl.org/perlref.html#Making-References)构造采用一个值列表，从中构建一个匿名散列（就像您将相同的列表分配给具有 的命名散列一样`%hash = (LIST)`）并返回对该散列的引用。

Perl 中的“匿名散列”没有什么特别之处：它们和其他散列一样都是普通的散列。使它们“匿名”的唯一原因是它们（当前）没有名称，因此您只能使用引用来引用它们。

绑定到变量名也不是散列的固有属性：命名散列很可能变得匿名（例如，如果它的名称超出范围），甚至匿名散列通过[符号表操作](http://perldoc.perl.org/perldata.html#Typeglobs-and-Filehandles)，像这样：

```
my $hashref = {foo => 'bar'};
our %hash;             # required by "use strict"
*hash = $hashref;
print "$hash{foo}\n";  # prints "bar" 
```

在 line 之后`*hash = $hashref`，全局变量`%hash`成为 reference 指向的 hash 的新名称`$hashref`，无论它之前是否已经有名称。这种机制甚至允许同一个散列有多个名称：事实上，任何允许您将散列（或任何其他类型的变量）从其自己的名称空间导出到您的名称空间的 Perl 模块本质上就是在幕后做到这一点的。

当然，以上所有内容也同样适用于数组（实际上也适用于标量）。

* * *

至于你的最后一个问题，[`my`](http://perldoc.perl.org/perlsub.html#Private-Variables-via-my%28%29)实际上每次执行时都会创建一个新的词法范围变量，而不是每次都重用同一个变量。这实际上对您的示例代码没有任何影响，但*会*产生影响的一种情况是，如果您在变量超出范围之前保存了对变量的引用。例如，以下是将制表符分隔的数据解析为数组的一种相当常见的方法：

```
my @table;
while (my $line = <>) {
    chomp $line;
    my @row = split /\t/, $line;
    # maybe do some manipulation or checks on @row here...
    push @table, \@row;
} 
```

如果您对此进行测试，您会发现此代码确实`@table`为每一行填充了对不同（现在是匿名）数组的引用，而不是许多指向同一个数组的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:20:25.737

我称它们为“文字哈希”、“文字数组”，但对每个人来说都是他自己的。

你应该知道，在 Perl 中——除了[`tie`](http://perldoc.perl.org/perltie.html)s——`[...]`和`\@x`几乎是一回事。这`{...}`也是`\%h`。它们都“构造”对数组和散列的引用。

在问题 5 中，两者都会做你想做的事。*但是*一个人会更有效地做到这一点。您的第二个示例将对已定义哈希的引用存储为另一个哈希中的值。第一个例子，

```
$HOH{flinstones} = {%flinstones} 
```

根据列表上下文创建一个散列以返回地址并*扩展* `%flintstones`为一个列表。因此，它将一个哈希值`%flintstones`存储在一个单独的哈希值的精确副本中，该哈希值存储在`%HOH`. 您是正确的，更改`%flintstones`不会影响此副本。

这里给你一点建议。安装，[`Smart::Comments`](http://search.cpan.org/perldoc?Smart%3a%3aComments)（SC），创建一些测试脚本，然后通过 STDERR 转储变量内部。你会惊讶于你可以学到更多的东西，看到一切的内部，你愿意看到。

以下是我对 SC 的一些经验教训：

*   `$Data::Dumper::Maxdepth`如果要转储对象，请设置为某个正整数值`Win32::OLE`，因为同一 OLE 对象的每个引用在遍历时可能看起来像不同的 Perl 对象。

*   永远不要自己倾倒`$_`。由于某种原因，SC 中的代码可以更改它。所以总是做这样的事情：

    ```
    my $a = $_;
    ### $_ : $a 
    ```

*   IO 句柄不会转储，所以不要尝试。使用默认字符串化。

现在，最后，如果您不使用 转储`%flintstones`，`%HOH`您将无法通过简单的变量转储知道引用是否相同。但是，请记住，您可以设置`$Data::Dumper::Maxdepth`为不会获得完整的转储。因此，您可以通过部分转储它们并使用直接的通用 Perl 引用字符串化来测试两个引用是否相同。

```
### %flintstones : '' . \%flintstones 
local $Data::Dumper::Maxdepth = 1;
### %HOH 
```

亲眼看看是什么情况，这将比在 Stackoverflow 上问一大堆问题更快地帮助你学习 Perl。

# css - 填充DIV高度

> ID：15364369
> 
> 赞同：0
> 
> 时间：2013-03-12T14:44:27.727
> 
> 标签：css, footer, fill

一直在尝试解决这个问题大约一个小时，这令人沮丧。

所以我需要我的 div 将页面的其余部分填充到页脚。

[http://gyazo.com/999cce47ea567878586fbc4c843f80fc](http://gyazo.com/999cce47ea567878586fbc4c843f80fc)

在 div 上将高度设置为 100% 根本不会增加大小。

```
.body-middle {
    width: 979px;
    margin: 0 auto;
    bottom:0;
    height:100%;
    padding-bottom: 50px;
}
footer {
    height: 50px;
    width: 100%;
    text-align: center;
    position: absolute;
    bottom: 0;
    background-color:#ebebeb;
} 
```

它们都在一个名为 page 的 div 中

```
.page {
    min-height: 100%;
    position:relative;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:19:21.023

为了让它占据屏幕的整个高度，您必须同时添加`height:100%`和`html`标签`body`。

[http://jsfiddle.net/WtAg7/1/](http://jsfiddle.net/WtAg7/1/)

PS：除非有其他 div 使用这些类名（.page、.body-middle），否则您应该使用 ID 代替，通过将`.`前缀替换为前缀来连接到 CSS `#`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:56:16.393

试着给你的身体元素`width:100%`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:40:54.460

将 body 和 height 样式设置为 100%，然后将您的 div 设置为 100% height。

CSS

```
body { height: 100%; margin: 0px; padding: 0px; }
html { height: 100%; }
.container { height: 100%;} 
```

HTML

```
<body>
<div class="container">
<span>Something</span>
</div>
</body> 
```

# c++ - Tcl.h：没有这样的文件或目录

> ID：15364371
> 
> 赞同：8
> 
> 时间：2013-03-12T14:44:34.047
> 
> 标签：c++, linux, tcl

我正在尝试将一些代码从 Solaris 机器移植到 Linux（特别是 Redhat）机器上。代码编译没有问题，在 Solaris 机器上运行也没有问题。

但是，在 Linux 上重新编译时，我遇到了 tcl.h 的问题 - 编译器告诉我，`error: tcl.h: No such file or directory`对于多个`#include "tcl.h"`.

据我所知，tcl8.4 & tk8.4 都安装了：

*   /usr/lib/tcl8.4
*   /usr/share/tcl8.4
*   /usr/lib/tk8.4
*   /usr/share/tk8.4

但是，我在任何地方都找不到 tcl.h 。有谁知道它会在哪里？或者它是 Solaris 需要的那些文件之一，但不需要包含 Linux？或者我什至需要安装除 tcl/tk 8.4 之外的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T14:50:34.717

您需要安装*开发*包才能获取头文件。根据您的 Linux 发行版，查找名为`tcl8.4-dev`和的包`tk8.4-dev`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-12T14:50:50.060

听起来您没有安装 tcl 的开发文件（库通常与标头分开打包）。尝试：

```
$ rpm -qa | grep tcl 
```

如果它不存在，请找到要安装的 -devel 包。如果是，它可能位于编译器不包含的目录中。如果安装了，应该可以用 rpm 找到文件（我认为选项是`-ql <packagename>`）

# excel - 处理Excel公式长度

> ID：15364373
> 
> 赞同：0
> 
> 时间：2013-03-12T14:44:41.457
> 
> 标签：excel, excel-formula, vba

在成功开发数据库/应用程序之后，我的任务是创建一个非常高级的电子表格，供我们的招聘团队使用。

长话短说，有一个公式可以计算出营地的“所需员工”与“参加者”。

考勤和员工数据正在通过 ODBC 连接提取另外两个工作表，并变成漂亮的数据透视表。

有一个相当容易理解，但最终在程序上相当复杂的计算要完成。这大约需要 8 个步骤。

鉴于 [据我所知] 你不能在单元格中创建短期变量，并且结合引用外部单元格的事实需要相当多的字符，我最终得到了一个视觉上（如果不是概念上）的复杂公式。

最终......由于我使用 IFERROR() 添加了一些数据验证来解决数据的不确定性，这意味着我实际上已经达到了单元格的字符限制（大约 8100 个字符）。我尝试 FSVO 缩小单元格，但这并没有让我回到极限以下。

所以 - 现在你知道了问题 - 这是一组问题：

*   有没有办法扩大限制？
*   有没有办法在单元格内制作变量（这也可以解决问题）？
*   VB适合这类问题吗？

我怀疑答案将是：“去学习一些 VB”......我试图避免。我认为我离限制大约 3 行，鉴于这是一个久经考验的解决方案，不得不重新编码它是一种耻辱。

编辑包括公式

```
=IF(
    OR(
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),

        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),

        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),
        IFERROR(
        GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)
    ),

 SUM(
        IF(
            OR(
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)
            ),
                SUM(
                    (
                    (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)+($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))/$B$49
                    )
                    +
                    (
                    ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))+($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$50
                    )
                    +
                    (
                    CEILING(
                        IF(
                            ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51)<0,
                            0,
                            (
                            (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","Multi-Active","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51
                            )
                        ),1
                    )
                    )
                )
                ,
                0
        )
        +

        IF(
            OR(
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),
                IFERROR(
                GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)
            ),      
            SUM(
                (
                (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)+($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))/$B$49
                )
                +
                (
                ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))+($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$50
                )
                +
                (
                    CEILING(
                    IF(
                    ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51)<0,
                    0,
                    (
                    (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","ISS","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51
                    )
                    ),1
                    )
                )
            )
            ,
            0
        )       
        +
        SUM(
                (
                (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)+($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))/$B$49
                )
                +
                (
                ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49)))+($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$50
                )
                +
                (
                CEILING(
                        IF(
                         ((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51)<0,
                         0,
                         (
                         (IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","8 + years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$50-(MOD((IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","6/7 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0)-($B$49-MOD(IFERROR(GETPIVOTDATA("Child ID",'Child Numbers 2013'!$A$1,"Venue",$A4,"Age group","4/5 years","Activity","MVC","date",B$1-DATE(YEAR(B$1),1,0)),0),$B$49))),$B$50))))/$B$51
                         )
                        ),1
                    )
                )
        )       
 ),

 "-"
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:37:34.147

定义的名称已经破解了它。仅供参考 - 我已将外部数据透视表的引用重新定义为 CN 而不是全名，这节省了数百个字符。谢谢大家！我已经标记了所有提出这个建议的人。

# jpa-2.0 - JPA 2 超类的标准查询属性

> ID：15364374
> 
> 赞同：5
> 
> 时间：2013-03-12T14:44:41.723
> 
> 标签：jpa-2.0, criteria-api

我有两个实体：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Person implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "GEN_Person")
    @SequenceGenerator(name = "GEN_Person", sequenceName = "seq_person" , initialValue = 1, allocationSize = 10)
    @Column(nullable = false)
    private Long id;
    private String familienname;
    private String vorname;

    ...
} 
```

和子类：

```
@Entity
@DiscriminatorValue(value = "KIND")
public class Kind extends Person implements Serializable {
     ... // other properties
} 
```

我想通过 jpa 2 中的条件查询找到所有种类实体。

我的查询：

```
public List<Kind> find(String f_name, String v_name) {
    CriteriaBuilder       cb         = em.getCriteriaBuilder();
    CriteriaQuery<Kind> cq         = cb.createQuery(Kind.class);
    EntityType<Kind>    type       = em.getMetamodel().entity(Kind.class);
    Root<Kind>          kindRoot = cq.from(Kind.class);

// Constructing list of parameters
List<Predicate> predicates = new ArrayList<Predicate>();

if ((null != f_name) &&!f_name.isEmpty()) {
    predicates.add(cb.like(cb.lower(kindRoot.get(type.getDeclaredSingularAttribute("familienname",
            String.class))), "%" + f_name.toLowerCase() + "%"));
}

if ((null != v_name) &&!v_name.isEmpty()) {
    predicates.add(cb.like(cb.lower(kindRoot.get(type.getDeclaredSingularAttribute("vorname",
            String.class))), "%" + v_name.toLowerCase() + "%"));
}

cq.select(kindRoot).where(predicates.toArray(new Predicate[] {}));

    return (List<Kind>) em.createQuery(cq).getResultList();
} 
```

**但我得到这样的错误：**

```
 javax.ejb.EJBException: EJB Exception: ; nested exception is: 
        java.lang.IllegalArgumentException: The declared attribute [familienname] from the managed type [EntityTypeImpl@441955560:Kind [ javaType: class com.itech_progress.kiwi.entities.Kind descriptor: 
RelationalDescriptor(com.itech_progress.kiwi.entities.Kind --> [DatabaseTable(PERSON), DatabaseTable(KIND)]), mappings: 19]] is not present - however, it is declared on a superclass.; 
```

我如何为这种情况构建 typesafe 标准查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:08:43.937

我建议[生成](https://stackoverflow.com/questions/3037593/how-to-generate-jpa-2-0-metamodel)规范的[元模型](http://docs.jboss.org/hibernate/orm/4.0/hem/en-US/html/metamodel.html)（链接是 Hibernate 文档，但如果是 JPA 的概念）。然后`Kind_.familienname`可以直接在查询中使用，因为`Kind_`继承`familienname`自`Person_`.

如果这不是一个选项，则应通过超类的元模型引用超类中的属性：

```
EntityType<Person> metamodelPerson = em.getMetamodel().entity(Person.class);
...
metamodelPerson.getDeclaredSingularAttribute("familienname", String.class) 
```

# css - 字体加载速度更快？

> ID：15364376
> 
> 赞同：0
> 
> 时间：2013-03-12T14:44:49.023
> 
> 标签：css, font-face

我需要一些解决方案或建议来在网站中加载更快的字体。

就像是

```
@font-face {
    font-family: 'myfont';
    src: url('myfont.eot');
    src: url('myfont.eot?#iefix') format('embedded-opentype'),
         url('myfont.woff') format('woff'),
         url('myfont.ttf') format('truetype'),
         url('myfont.svg#nexa_heavyregular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

在 html 加载或下载字体 url 时需要一些时间来更改字体，有什么想法可以更快地加载它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T15:58:28.310

[您不能让它加载得更快，因为它取决于网络和浏览器字体渲染，但是您可以在使用FontLoader](https://github.com/smnh/FontLoader "字体加载器")加载字体时显示某种加载指示器：

```
// Show an activity indicator while font is loading...

var fontLoader = new FontLoader(["myfont"], {
    "fontsLoaded": function(error) {
        // Hide the activity indicator and show the text.
    }
}, 3000);
fontLoader.loadFonts(); 
```

这是关于[jsFiddle的演示](http://jsfiddle.net/gXtQA)

# java - 使用 Criteria 在休眠中优化查询（避免不必要的连接）

> ID：15364382
> 
> 赞同：1
> 
> 时间：2013-03-12T14:45:00.133
> 
> 标签：java, sql, hibernate, criteria

我有一门课`A`，里面有另一个课`B`。像这样的东西：

```
@Table(name = "A")
Class A {
    @OneToOne
    @JoinColumn(name="B_ID")
    B b;
} 
```

我想要这样的查询：

```
SELECT * from A where B_ID = 4 
```

但是当我`Criteria`用来实现我的目标时，它会在**内部连接**两个表。我怎么能`SELECT`像我说的那样。

* * *

如果有帮助，我的标准是这样的：

```
DetachedCriteria crit = DetachedCriteria(A.class, "a");
crit.createAlias("a.b", "b");
crit.add(Restrictions.eq("b.id", 4));
getHibernateTemplate().findByCriteria(crit); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:53:42.647

在 Hibernate 中，默认情况下会急切地获取一对一的关系——这就是你获得内部连接的原因。尝试这个：

```
@OneToOne(fetch = FetchType.LAZY)
@JoinColumn(name="B_ID")
B b; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-25T07:45:38.623

来自[如何避免 HQL 和 Criteria 中不必要的选择和连接](https://stackoverflow.com/questions/10665084/how-to-avoid-unnecessary-selects-and-joins-in-hql-and-criteria)。看来这是Hibernate中长期存在的错误。

[https://hibernate.atlassian.net/browse/HHH-3538](https://hibernate.atlassian.net/browse/HHH-3538)

[https://hibernate.atlassian.net/browse/JPA-19](https://hibernate.atlassian.net/browse/JPA-19)

这个问题也让我很困惑。

# c# - C# JsonConvert 错误

> ID：15364383
> 
> 赞同：2
> 
> 时间：2013-03-12T14:45:01.950
> 
> 标签：c#, json, json.net

我有这个 Json 返回：

```
[
{
  "url": "http://xxx.xxx.xxx", 
  "code": 0, 
  "aplication": 
  {
    "version":
    [
    {
       "silent": true, 
       "checksum": "9aabad09b09459ac6c9e54f9ca4eb5c4",
       "size": 1250619, 
       "force": true, 
       "apply_message": "", 
       "id": 116,
       "id_aplication": 4, 
       "number": "1.0.5.0", 
       "news": "", 
       "automatic": true, 
       "installation": "Setup.exe"
    }
    ], 
    "division_name": "DNT",
    "app_name": "MyApplication", 
    "id": 4, 
    "id_master": 0
}, 
"message": "New Application Found"
}
] 
```

使用这个网站[http://json2csharp.com/](http://json2csharp.com/)，我生成这些类：

```
public class Version
{
    public bool silent { get; set; }
    public string checksum { get; set; }
    public int size { get; set; }
    public bool force { get; set; }
    public string apply_message { get; set; }
    public int id { get; set; }
    public int id_aplication { get; set; }
    public string number { get; set; }
    public string news { get; set; }
    public bool automatic { get; set; }
    public string installation { get; set; }
}

public class Aplication
{
    public List<Version> version { get; set; }
    public string division_name { get; set; }
    public string app_name { get; set; }
    public int id { get; set; }
    public int id_master { get; set; }
}

public class RootObject
{
    public string url { get; set; }
    public int code { get; set; }
    public Aplication aplication { get; set; }
    public string message { get; set; }
} 
```

然后，在我的 C# 代码中，我这样写：

```
RootObject test = JsonConvert.DeserializeObject<RootObject>(jsonResult); 
```

但是，我收到此错误：

> 无法将当前 JSON 对象（例如 {"name":"value"}）反序列化为类型“System.Collections.Generic.List`1[ConsoleAPP.Aplication]”，因为该类型需要 JSON 数组（例如 [1,2, 3]）正确反序列化。要修复此错误，请将 JSON 更改为 JSON 数组（例如 [1,2,3]）或更改反序列化类型，使其成为普通的 .NET 类型（例如，不是像整数这样的原始类型，而不是像这样的集合类型可以从 JSON 对象反序列化的数组或列表。JsonObjectAttribute 也可以添加到类型中以强制它从 JSON 对象反序列化。路径“aplication.version”，第 1 行，位置 227。

我阅读了一些关于此的提示，但对我没有帮助。例如：

[无法在 WCF REST 中解析 JSON 数组](https://stackoverflow.com/questions/11463556/unable-to-parse-json-array-in-wcf-rest)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:51:14.657

您的 JSON 是一个数组 - 它只包含一个项目，但它仍然是一个数组。如果您从大 JSON 字符串中删除前导和尾随`[`，它应该可以很好地反序列化。`]`

或者你可以反序列化成`RootObject[]`而不是`RootObject`.

无论哪种方式都会奏效。

# c++ - PlaySound() 适用于 1 种声音，还有更多功能吗？

> ID：15364385
> 
> 赞同：0
> 
> 时间：2013-03-12T14:45:06.277
> 
> 标签：c++, wav, playsound

试图寻找答案，但我能找到的只是添加另一个库，如 OpenAL 等。（我用`windows.h`的都是过剩）

我写了一个多线程程序来检查是否有可能一个线程将继续播放主题，而第二个线程将播放声音效果，但不幸的是它不起作用......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:15:00.483

您是否尝试过 MCI 库？

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd742874(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd742874(v=vs.85).aspx)

这是我的做法：

```
mciSendString(L"open ../mp3/announce_start.mp3 alias announce", 0, 0, 0 );
mciSendString(L"play announce wait", 0, 0, 0 ); 
```

如果您希望声音文件重复，请尝试

```
mciSendString(L"play announce repeat wait", 0, 0, 0 ); 
```

# symfony - Symfony2 无法从教义捆绑运行命令行任务

> ID：15364393
> 
> 赞同：0
> 
> 时间：2013-03-12T14:45:27.637
> 
> 标签：symfony, doctrine-orm, command

我试图弄清楚为什么我不能从 Symfony2 (2.2) 的主要学说包中看到（当然也不能运行）命令行任务。当我执行

```
php app/console 
```

我只看到：

```
doctrine
  doctrine:database:create            Creates the configured databases
  doctrine:database:drop              Drops the configured databases
  doctrine:fixtures:load              Load data fixtures to your database.
  doctrine:generate:crud              Generates a CRUD based on a Doctrine entity
  doctrine:generate:entities          Generates entity classes and method stubs from your mapping information
  doctrine:generate:entity            Generates a new Doctrine entity inside a bundle
  doctrine:generate:form              Generates a form type class based on a Doctrine entity
  doctrine:mapping:import             Imports mapping information from an existing database
  doctrine:migrations:diff            Generate a migration by comparing your current database to your mapping information.
  doctrine:migrations:execute         Execute a single migration version up or down manually.
  doctrine:migrations:generate        Generate a blank migration class.
  doctrine:migrations:migrate         Execute a migration to a specified version or the latest available version.
  doctrine:migrations:status          View the status of a set of migrations.
  doctrine:migrations:version         Manually add and delete migration versions from the version table. 
```

为什么没有任务

```
doctrine:schema 
```

命名空间？

这是我的 AppKernel.php 的一部分：

```
 $bundles = array(
        new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
        new Symfony\Bundle\SecurityBundle\SecurityBundle(),
        new Symfony\Bundle\TwigBundle\TwigBundle(),
        new Symfony\Bundle\MonologBundle\MonologBundle(),
        new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
        new Symfony\Bundle\AsseticBundle\AsseticBundle(),
        new Doctrine\Bundle\DoctrineBundle\DoctrineBundle(),
        new Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle(),
        new JMS\AopBundle\JMSAopBundle(),
        new JMS\DiExtraBundle\JMSDiExtraBundle($this),
        new JMS\SecurityExtraBundle\JMSSecurityExtraBundle(),
        new Knp\Bundle\MenuBundle\KnpMenuBundle(),
        new Sonata\CacheBundle\SonataCacheBundle(),
        new Sonata\BlockBundle\SonataBlockBundle(),
        new Sonata\AdminBundle\SonataAdminBundle(),
        new Sonata\IntlBundle\SonataIntlBundle(),
        new Sonata\DoctrineORMAdminBundle\SonataDoctrineORMAdminBundle(),
        new Sonata\EasyExtendsBundle\SonataEasyExtendsBundle(),
        new Sonata\UserBundle\SonataUserBundle('FOSUserBundle'),
        new Sonata\SeoBundle\SonataSeoBundle(),
        new Sonata\jQueryBundle\SonatajQueryBundle(),
        new Stof\DoctrineExtensionsBundle\StofDoctrineExtensionsBundle(),
        new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle(),
        new Doctrine\Bundle\MigrationsBundle\DoctrineMigrationsBundle(),
        new FOS\UserBundle\FOSUserBundle(),
        new Genemu\Bundle\FormBundle\GenemuFormBundle(),
        new Liip\ImagineBundle\LiipImagineBundle(),
        new Knp\Bundle\GaufretteBundle\KnpGaufretteBundle(),
        new Vich\UploaderBundle\VichUploaderBundle(),
        new FOS\JsRoutingBundle\FOSJsRoutingBundle(),
        new Knp\Bundle\PaginatorBundle\KnpPaginatorBundle(),
        new Mopa\Bundle\BootstrapBundle\MopaBootstrapBundle(),
        new HWI\Bundle\OAuthBundle\HWIOAuthBundle(),

        new App\BackendBundle\AppBackendBundle(),
        new App\FrontendBundle\AppFrontendBundle(),
        new App\GeneralBundle\AppGeneralBundle(),
        new App\DemoBundle\AppDemoBundle(),
        new App\CompanyBundle\AppCompanyBundle(), 
```

其他捆绑包是否有可能覆盖来自学说捆绑包的任务？任何修复它的提示将不胜感激。

提前致谢！

# php - PHP 会话不可信吗？

> ID：15364400
> 
> 赞同：0
> 
> 时间：2013-03-12T14:45:52.130
> 
> 标签：php, sql, session

在 PHP 中的页面之间存储数据的最佳方式是什么？我会认为会话工作得很好，甚至对象会话（[https://stackoverflow.com/a/5515341/1445985](https://stackoverflow.com/a/5515341/1445985)）但是假设我正在构建一个购物车，PHP会话真的很容易被破解，因此不建议存储购物车/购物篮数据？无论如何，谁在乎是否有人确实设法获得了其他人的篮子数据，这肯定不会造成任何伤害？显然信用卡数据等是有害的，但订单中不同产品的列表根本不用担心。

我已经看到我目前使用的购物车（我没有做到）将每个订单存储到数据库中的一个表中，然后通过订单 ID 查询该表以检索所有订单信息。这是可取的吗？

我一直在努力寻找用 PHP 做事的最佳方法，但问题是似乎从来没有一种值得信赖的方法来做任何事情。总有人说这是个坏主意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:51:56.993

以下是有关确保 PHP 会话安全的一些一般信息：

[PHP 会话安全](https://stackoverflow.com/questions/328/php-session-security)

那就是说。我已经使用与您描述的类似的方法构建了一些自定义推车。我将数据库中的订单 ID 存储在 cookie 中。随着用户在结账过程中前进，购物车页面是使用存储在不同数据库表中的订单信息构建的。

不过，我不一定为了安全而这样做。将订单存储在数据库中意味着我不必担心用户的会话过期并且他们会丢失购物车中的所有东西。如果他们关闭浏览器并在第二天回来，他们仍然可以在之前的位置继续购物。将他们的订单存储在数据库中还可以将他们的购物车与用户 ID 关联起来，这样他们就可以从不同的机器登录并仍然保留他们的购物车信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:57:30.670

虽然 PHP 会话可以在某些情况下被劫持，但它们通常被认为是安全的，并且对于您所描述的情况应该绰绰有余。强烈建议对整个会话使用 SSL (HTTPS)。

此外，如果可能的话，根本不要在您的应用程序中保留 CC 数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T14:51:40.813

问题不在于 PHP 的会话（除非您的服务器被黑客入侵，在这种情况下，攻击者可以直接访问所有会话数据和其他内容），而是您如何将会话数据与特定用户相关联。您有一个必须发送给客户端的会话 ID。在 cookie 中或作为所有入站链接的 GET 参数。

这意味着有人可以拦截（中间人攻击）该会话 ID，然后自己使用它（从而充当受害者）。或者他可以以某种方式猜测会话 ID（这不太可能）。

因此，防止这种情况的唯一方法是使用`https`它将加密服务器和客户端之间的所有请求，并防止任何人获取该信息。

# java - 谷歌地图不在安卓应用中显示图块

> ID：15364401
> 
> 赞同：0
> 
> 时间：2013-03-12T14:45:53.983
> 
> 标签：java, android, google-maps

我知道这种类型的问题已经被问过很多次了，但我真的很困惑，不知道我的错误/错误在哪里。当我运行该应用程序时，我的地图会显示在我的模拟器和三星 Galaxy 3 上，但它显示的都是灰色瓷砖，可以放大或缩小。

这是我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.android.maptesting"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="3" android:targetSdkVersion="17"/>

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permisison android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true"/>

<permission 
    android:name="com.android.maptesting.permission.MAPS_RECEIVE"
    android:protectionLevel="signature"/>
<uses-permission android:name="com.android.maptesting.permission.MAPS_RECEIVE"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <uses-library android:name="com.google.android.maps" />

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="A#####################################4" />

    <activity
        android:name="com.android.maptesting.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

</application>

</manifest> 
```

这是我的布局文件

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:orientation="vertical" 
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".MainActivity">

<com.google.android.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map_view"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:layout_below="@+id/tridView"
    android:layout_centerHorizontal="true"
    android:clickable="true" 
    android:enabled="true" 
    android:apiKey="A####################################4" />

</RelativeLayout> 
```

最后是我的java文件

```
package com.android.maptesting;

import android.os.Bundle;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

public class MainActivity extends MapActivity {

    private MapView mapView;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mapView = (MapView) findViewById(R.id.map_view);       
        mapView.setBuiltInZoomControls(true);
    }

    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

} 
```

然后，当应用程序在 Galaxy S3 上“运行”时，所有 logcat 都说：

```
Couldn't get connection factory client
IOException processing: 26
java.io.IOException: Server returned: 3
at     android_maps_conflict_avoidance.com.google.googlenav.map.BaseTileReuqest.readResponseData(BaseTileRequest.java.115)
at     android_maps_conflictavoidance.com.google.googlenav.map.MapService$MapTileRequest.readResponseData(MapService.java:1473) 
```

并将继续定期重复。所以暗示我的应用程序正在尝试获取磁贴但没有成功。

通过查看论坛和其他 stackoverflow 问题，常见问题出现在清单文件中的权限中。老实说，我相信我拥有一切。下一个常见问题是 API 密钥。我确实对此感到有些困惑，但彻底遵循了教程和其他人的步骤。尽管在最终提供密钥时，谷歌要求提供 SHA-1 而不是其他人似乎使用的 MD5。我确实尝试了 MD5，但谷歌并没有将此作为对获取密钥的有效响应。

我正在尝试使用“Google Maps Android API v2”，并且在获取密钥时我使用了“创建新的 Android 密钥”并使用了我的 SHA-1，后跟“;” 然后是我的包名。要获得 SHA-1，我按照此分步说明进行操作 > [https://stackoverflow.com/a/11493316/1833809](https://stackoverflow.com/a/11493316/1833809)（是的，我知道它说 MD5，但我使用 -v 选项查看所有指纹）。

老实说，如果某个地方有一个愚蠢或简单的错误，我会很高兴的，因为我已经为此苦苦挣扎了几天并且失去了耐心。因此，对于可能重复此类问题，我再次道歉，但其他解决方案似乎对我没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:49:04.557

坦率地说，这看起来确实是一个关键问题。首先，我建议您阅读我写的关于获取 Google Map API V2 密钥和创建 Google Map 的那 2 篇文章：

[谷歌地图 API V2](https://blog-emildesign.rhcloud.com/?p=435)

[获取 Google API 的密钥](https://blog-emildesign.rhcloud.com/?p=403)

如果这些指南对您没有帮助，根据我的经验，您可以尝试 `debug.keystore`从目录中删除您的 current: 文件`C:\Users\"Your username"\.android`。

并重新创建它运行一个android项目的编译。

接下来尝试再次遵循密钥指南，因为您将收到一个新`SHA1`密钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:41:03.030

我在调试模式下一直遇到 Eclipse 的这个问题。

删除文件“debug.keystore”，运行你的应用程序。它会失败，但它也会创建一个新的 debug.keystore。从该密钥库中获取十六进制打印代码，然后去谷歌获取该代码的密钥。在控制台上查看您的代码：

keytool -list -alias androiddebugkey -keystore C:\Users\USUARIO.android\debug.keystore -storepass android -keypass android

然后在 MapView 中写入您的密钥并运行。它应该工作。

# java - JTable 在多行中具有多个标题

> ID：15364406
> 
> 赞同：0
> 
> 时间：2013-03-12T14:46:05.670
> 
> 标签：java, swing, header, jtable

我想知道是否可以使用 JTable 或类似的东西创建一个表来创建这个： ![在此处输入图像描述](../Images/d8ef9ddf4f8fb1cced8ca007bcba3513.png)

我接受大家的建议和意见！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:29:14.713

我不认为这在一张桌子上是可能的，但是自从我玩 JTables 以来已经有一段时间了，所以我可能会离开。我认为要做到这一点，您需要多个表，其中可能有 1 个大的“项目名称”JLabel。

# sqlite - SQLite：结果集游标已经在 stmt.executeQuery() 之后

> ID：15364407
> 
> 赞同：0
> 
> 时间：2013-03-12T14:46:12.250
> 
> 标签：sqlite, cursor, resultset

我正在使用命令从 SQLite 数据库读取到 ResultSet`allCustomers = stmt.executeQuery("SELECT * FROM customers");`

该表`customers`有 3 列：`customerID`、`firstname`，`lastname` 其中 customerID 是 0 到 199 之间的整数。

在我的代码中做了一些其他的事情之后，我来到了这一行：

```
if(alleKunden.next()){
    System.out.println( allCustomers.getInt(1) + " " + allCustomers.getString(2));
} 
```

在这一行中，我得到一个`column 2 out of bounds [1,1]`错误。如果我放弃 `allCustomers.getString(2)`输出`200`，并且在下一次迭代中（因为这发生在 for 循环中），异常会`ResultSet closed`终止程序。

我使用 firefox 插件 SQLite 检查了数据库，发现数据库正确包含所有客户信息。

那么为什么我的 ResultSet 中没有第二列，为什么我得到“200”作为 allCustomers.getInt(1) 的结果

这是我的整个代码：（
注意：由于某些原因，完全相同的事情在第一个任务中工作正常`createCustomers()`）

```
package telefonbook;

import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;

class SqlDB {

    private static final SqlDB dbcontroller = new SqlDB(Application.VERBOSE_MODE, Application.CREATE_NEW_DATA, Application.FAKTOR, Application.DB_PATH);
    private static Connection connection;
    private static final String DB_PATH = System.getProperty("user.home") + "/" + "tmp/telefonbook.sqlite";

    static boolean verboseMode;
    static boolean createNewData;
    static int faktor;
    static String dbPath;

    static {
        try {
            Class.forName("org.sqlite.JDBC");
        } catch (ClassNotFoundException e) {
            System.err.println("Error with the JDBC driver");
            e.printStackTrace();
        }
    }

    public SqlDB(boolean verboseMode, boolean createNewData, int faktor, String dbPath){
        this.verboseMode = verboseMode;
        this.createNewData = createNewData;
        this.faktor = faktor;
        this.dbPath = dbPath;
    }

    public static SqlDB getInstance(){
        return dbcontroller;
    }

    private void initDBConnection() {
        try {
            if (connection != null)
                return;
            System.out.println("Creating Connection to Database...");
            connection = DriverManager.getConnection("jdbc:sqlite:" + DB_PATH);
            if (!connection.isClosed())
                System.out.println("...Connection established");
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        Runtime.getRuntime().addShutdownHook(new Thread() {
            public void run() {
                try {
                    if (!connection.isClosed() && connection != null) {
                        connection.close();
                        if (connection.isClosed())
                            System.out.println("Connection to Database closed");
                    }
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
        });
    }

    private void createCustomers(int customerAmount) {
        try {
            System.out.print("Creating customers...\n ");

            Statement stmt = connection.createStatement();
            stmt.executeUpdate("DROP TABLE IF EXISTS customer;");
            stmt.executeUpdate("CREATE TABLE customer (customerID, lastname, firstname);");
            String  firstname;
            String lastname;

            for (int i = 0; i < customerAmount; i++){
                    //here a random name is generated. Gonna skip this code
                    firstname = randomname();
                    lastname = randomname();

                    stmt.execute("INSERT INTO customer (customerID, lastname, firstname) VALUES (" + i + ",'" + lastname + "','" + firstname + "')");
            }
            connection.commit();
            if(verboseMode){
                ResultSet allCustomers = stmt.executeQuery("SELECT * FROM customer");
                while(allCustomers.next()){
                    System.out.println(allCustomers.getString(1) + "\t" + allCustomers.getString(2) + "\t" +allCustomers.getString(3));
                }
            }   
        } catch (SQLException e) {
            System.err.println("Couldn't handle DB-Query");
            e.printStackTrace();
        }
    }

    private void createTelefone(int telefonAmount) {
        try {
            String  telefonnumber;
            System.out.print("Creating telefones...\n ");
            Statement stmt = connection.createStatement();
            stmt.executeUpdate("DROP TABLE IF EXISTS telefone;");
            stmt.execute("CREATE TABLE telefone (telefonID, telefonnumber, ownerID);"); 
            ResultSet allCustomers = stmt.executeQuery("SELECT * FROM customer");
            int customerAmount = stmt.executeQuery("SELECT COUNT(*) FROM customer").getInt(1);

            for (int i = 0; i < telefonAmount; i++){
                telefonnumber = randomNumber();
                if(allCustomers.next()){
                    // This line will fail!
                    System.out.println(allCustomers.getInt(1) + " " + allCustomers.getString(2));
                    stmt.execute("INSERT INTO telefone (telefonID, telefonnumber, ownerID) VALUES (" + i + ",'" + telefonnumber + "', " + allCustomers.getInt(1) + ")");
                } else {
                    //do something else
                }
            }
            ResultSet allTelefones = stmt.executeQuery("SELECT * FROM telefone");
            if(verboseMode){
                while(allTelefones.next()){
                    System.out.println(allTelefones.getString(1) + "\t" + allTelefones.getString(2) + "\t" +allTelefones.getString(3));
                }
            }
        } catch (SQLException e) {
            System.err.println("Couldn't handle DB-Query");
            e.printStackTrace();
        }
    }

    public static void Application() {
        int customerAmount = 100*faktor;
        int telefonAmount = 100*faktor;

        SqlDB dbc = SqlDB.getInstance();
        dbc.initDBConnection();
        try{
            connection.setAutoCommit(false);
            if (createNewData){
                dbc.createCustomers(customerAmount);
                dbc.createTelefone(telefonAmount);
            }
        connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T13:47:48.340

最后我没有找到问题的根源，但想出了一个解决方法。

首先，我（由于某些原因我无法弄清楚）取消注释以下行。

```
int customerAmount = stmt.executeQuery("SELECT COUNT(*) FROM customer").getInt(1); 
```

之后，我替换了`stmt.execute`in 行：

```
stmt.execute("INSERT INTO telefone (telefonID, telefonnumber, ownerID) VALUES (" + i + ",'" + telefonnumber + "', " + allCustomers.getInt(1) + ")"); 
```

用`java.sql.PreparedStatement`以下方式：

```
PreparedStatement prep = connection.prepareStatement("INSERT INTO telefone VALUES(?,?,?);");
prep.setInt(1, i); // telefonID
prep.setString(2, telefonnumber); // telefonnumber
prep.setInt(3, randomOwner); // ownerID
prep.addBatch(); 
```

# web - 什么是隐私政策、条款和使用？

> ID：15364410
> 
> 赞同：0
> 
> 时间：2013-03-12T14:46:26.093
> 
> 标签：web

好吧，我要开始一个新的酒店列表网站。我已经建立了网站，但是我对这两个页面的内容感到困惑

1.  使用条款
2.  隐私政策

我不知道该写什么。我关注了很多网站，但我不想从另一个网站复制粘贴它。

如果有人告诉我这些条款会很好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:10:04.280

我想知道您是否搜索过自己，但请看这里：

*   [使用条款](http://en.wikipedia.org/wiki/Terms_of_Use)
*   [隐私政策](http://en.wikipedia.org/wiki/Privacy_Policy)

这将告诉您它们的含义，因此您可以弄清楚在这些页面上写什么。本论坛不只是发布一些内容并期望其他人为您填补空白，请阅读[常见问题解答](https://stackoverflow.com/FAQ)

# asp.net - 使用自定义站点地图提供程序

> ID：15364411
> 
> 赞同：0
> 
> 时间：2013-03-12T14:46:34.057
> 
> 标签：asp.net, sitemap

我通过继承 StaticSiteMapProvider 类创建了我的自定义站点地图提供程序并将其注册到 web.config 中。如何使用该提供程序以 xml 格式显示站点地图，以便谷歌可以使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:29:43.860

不确定 StaticSiteMapProvider，但最近我正在使用[这篇](http://www.how-to-asp.net/generate-submit-sitemap/)精彩文章中的逐步说明来生成 xml 站点地图并 ping google、yahoo、bing 并询问它。希望它也能帮助你。

# python - 无法为 linux/python 安装 azure sdk

> ID：15364414
> 
> 赞同：2
> 
> 时间：2013-03-12T14:46:49.050
> 
> 标签：python, ubuntu, azure, sdk

在下载 SDK 并发现它确实会提取，即使它会引发大量警告并将输出写入非标准位置，然后我发现了更多非标准的东西 - 它需要安装 npn 和节点。此外，即使它们不应该大写，它也会将它们的名字大写。

所以，我终于安装了这些，现在当我为 SDK 运行 ./configure 时，它​​告诉我它需要节点 V0.6.15 或更高版本，正如您在此处看到的，我正在运行 0.10.0

```
mjs@ubuntu:/tmp/azure$ ./configure 
Node version needs to be higher than 0.6.15
Npm is installed. Version: 1.2.14
mjs@ubuntu:/tmp/azure$ node --version
v0.10.0 
```

另外，如果我阅读 SDK INSTALL 文件，它会说：

## Unix/麦金塔

*   需要 Python 2.6 或 2.7
*   需要 Node.js 6.15 或更高版本，以及 npm ( [http://nodejs.org/#download](http://nodejs.org/#download) )

但是如果我去 nodejs 网站，它会明确指出最新版本是 0.10.0。有没有人在 ubuntu 上成功安装了这个，还是我在浪费时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:23:36.613

我在这里写了一篇博客：http: [//codebetter.com/glennblock/2013/03/18/node-0-10-compat-issues-with-the-azure-sdk-and-cli/](http://codebetter.com/glennblock/2013/03/18/node-0-10-compat-issues-with-the-azure-sdk-and-cli/)

我们肯定在努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:51:45.113

节点 0.10 是一个非常新的版本，之前的稳定版本是 0.8.22。目前，用于节点的 azure sdk 不支持 0.8.x 以上的版本 - 您可以从[http://nodejs.org/dist/轻松安装以前的稳定版本之一（如 0.8.22）](http://nodejs.org/dist/)

# ruby-on-rails - 使用多态关联的 pg_search 的问题

> ID：15364422
> 
> 赞同：1
> 
> 时间：2013-03-12T14:47:06.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, pg-search

我的模型有以下范围：

```
class Cloth < ActiveRecord::Base
  include Ownerable
  has_many :cloth_tags, :dependent => :destroy

  pg_search_scope :full_search,
    associated_against: {
      cloth_tags: [:name, :brand_name]
    },
    against: [:name, :description],
    ignoring: :accents,
    using: {
      tsearch: {
        dictionary: "spanish",
        any_word: true
      }
    } 
```

因此，如果我调用类似的东西`Cloth.full_search('shirt')`可以正常工作，但如果我添加`owner: [:name]`到`associated_against`哈希中，它会抛出`NameError: uninitialized constant Cloth::Owner`. 不用说，正常情况下的所有者关系是有效的。无论如何在这样的模块中定义：

```
module Ownerable

  extend ActiveSupport::Concern

  included do
    belongs_to :owner, :polymorphic => true
  end 
```

任何线索可能是什么？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T21:41:08.230

我是 pg_search 的作者和维护者。

不幸的是，在纯 SQL 中不可能在这个方向上遍历多态关联，因此使用 pg_search 进行搜索是不可能的。

您可以做的一件事是从其他记录中计算文本并将其缓存到 Cloth 表上的列中，然后对其进行搜索。每当 Cloth 上的多态外键更改或 Owner 记录上的内容更改时，您都必须小心更新它。

希望我可以改进错误消息，使其不会那么混乱。感谢您指出了这一点。

# linq - 使用 LINQ 选择具有不同列值的所有行

> ID：15364424
> 
> 赞同：6
> 
> 时间：2013-03-12T14:47:16.133
> 
> 标签：linq, nhibernate

我有一个包含 4 个字段的数据库，看起来像这样：

```
ID      DeviceId       Location        Date
1           A             ...            2
2           A             ...            1
3           B             ...            2 
```

对于每个`DeviceId`我想要从最高日期的记录中获得的位置。我可以得到 distinct`DeviceId`是这样的：

```
// get all locations
var locations = Session.Query<Location>().ToList();

//Get the latest used unique deviceId's
var distinctDeviceIdsByDate = (
      from loc in locations
      orderby loc.DeviceId, loc.Date descending
      select loc.DeviceId).Distinct().ToList(); 
```

然后我会使用 join 来获取想要的行，但这不会有任何好处，因为除了`DeviceId`'s 之外我无法获得任何东西，因此无法确定要选择哪些行。如果我尝试选择以下内容：

```
select loc 
```

我只能得到所有列的唯一组合的行。我确信有一个简单的解决方案，但恐怕我现在无法弄清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T14:59:29.467

我猜你必须使用`GroupBy`和的某种组合`Take`。试试这个，

```
var distinctDeviceIdsByDate = 
    locations.OrderByDescending(location => location.DeviceId)
             .ThenByDescending(location => location.Date)
             .GroupBy(location => location.DeviceId)
             .SelectMany(location => location.Take(1)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:01:55.320

假设这`Date`是独一无二的，`DeviceId`你可以尝试

```
//Get the latest used unique deviceId's
var distinctDeviceIdsByDate = (
      from loc in Session.Query<Location>()
      group loc by loc.DeviceId
      into g
      select new
      {
          DeviceID = g.Key,  
          Location = g.OrderByDescending(l => l.Date).First().Location;
      }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:01:47.780

您可以使用分组来解决此问题。

```
var locations = new [] {
    new { DeviceId = "A", Date = 2, Location = ".." },
    new { DeviceId = "A", Date = 1, Location = ".." },
    new { DeviceId = "B", Date = 2, Location = "...." },
};

var lastUsedLocations = 
    from l in locations
    group l by l.DeviceId into g
    let lastUsed = g.OrderBy(x => x.Date).Last()
    select lastUsed;

// lastUsedLocations contains
// DeviceId       Date        Location
// A              2           ..
// B              2           .... 
```

# css - 我怎样才能使我的css菜单居中？

> ID：15364426
> 
> 赞同：-5
> 
> 时间：2013-03-12T14:47:18.183
> 
> 标签：css

我无法将我的 CSS 菜单居中。我正在使用 impresspages，所以我的菜单生成代码只是一个 php 代码。

```
 .cssmenu ul{z-index:50;width:960px;background:#666 url(img/overlay.png) repeat-x 0 -110px;line-height:100%;font:normal .8em/1.4em Arial, Helvetica, sans-serif;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-box-shadow:0 0 0 rgba(0,0,0,.0);-moz-box-shadow:0 0 0 rgba(0,0,0,.0);margin:0 auto;padding:0; text-align: center;}

.cssmenu li{float:left;position:relative;list-style:none;margin:0;padding:3px 0 3px 2px;}

.cssmenu a{font-weight:700;color:#FFF;text-decoration:none;display:block;border-radius:0;-webkit-border-radius:2px;-moz-border-radius:2px;text-shadow:0 1px 1px rgba(0,0,0,.3);margin:0 10px;padding:5px;}

.cssmenu >ul>li+li{border-left:solid 1px grey;margin:0 auto;}

.cssmenu a:hover{background:#000;color:#fff;}

.cssmenu .active a,.cssmenu li:hover > a{background:#666 url(img/overlay2.png) repeat-x 0 -40px;color:#444;border-top:solid 0 #f8f8f8;-webkit-box-shadow:0 1px 1px rgba(0,0,0,.2);-moz-box-shadow:0 1px 1px rgba(0,0,0,.2);box-shadow:0 1px 1px rgba(0,0,0,.2);text-shadow:0 1px 0 rgba(255,255,255,1);}

.cssmenu ul ul li:hover a,{color:#000;}

.cssmenu li:hover li a{background:none;border:none;color:#666;-webkit-box-shadow:none;-moz-box-shadow:none;}

.cssmenu ul ul a:hover{background:#000 repeat-x 0 -100px!important;color:#fff!important;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;text-shadow:0 1px 1px rgba(0,0,0,.1);}

.cssmenu ul ul{display:none;width:250px;position:absolute;top:38px;left:0;background:#fff url(img/overlay2.png) repeat-x 0 0;border:solid 1px #b4b4b4;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.3);-moz-box-shadow:0 1px 3px rgba(0,0,0,.3);box-shadow:0 1px 3px rgba(0,0,0,.3);margin:0 auto;padding:0;}

.cssmenu ul ul li{float:none;margin:0 auto;padding:3px;}

.cssmenu ul ul a{font-weight:700;color:#000;letter-spacing:0;word-spacing:0;font-size:16px;text-align:center;font-family:trebuchet MS, sans-serif;line-height:1;opacity:100;}

.cssmenu ul:after{content:'.';display:block;clear:both;visibility:hidden;line-height:0;height:0;}

* html .cssmenu ul{height:1%;}/* CSS Document */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:29:11.403

因为您的菜单包含两行，您将无法使用 CSS 将其居中。使用适合一行的更少（或更窄）元素来执行此操作：

```
<header class="grid_11_REMOVED">
    <div class="cssmenu clearfix" style="width: auto;">
        <div style="background: [styles from menu]; text-align: center;">
            <ul class="level1" style="display: inline-block;">
            ...
            </ul>
        </div>
    </div>
</header> 
```

菜单元素默认显示为块状，因此是全角的。也不是我通过删除 .grid_11 类来修复了太窄的标题元素的宽度。

# ruby-on-rails - 没有路线匹配 {:action=>"destroy", :controller=>"links"}

> ID：15364432
> 
> 赞同：0
> 
> 时间：2013-03-12T14:47:38.020
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, routes

**路线**

```
 resources :links, only: [:new, :create, :index, :destroy] 
```

**链接控制器**

```
class LinksController < ApplicationController
before_filter :signed_in_user

def new
@user = current_user
@tags = @user.tags
@link = Link.new
end

def create
@link = Link.new(params[:link])
if @link.save
  flash[:success] = "Link created!"
  redirect_to root_url
else
  render 'new'
end
end

def index
@links = Link.paginate(page: params[:page])
end

def destroy
@link.destroy
redirect_to links_path
end

end 
```

**html.erb**

```
<li>
<span class="location_info"> From Tag: <%= link.from_tag.ref %></span>
<span class="location_info"> To Tag: <%= link.to_tag.ref %></span>
<span class="location_info"> Cost: <%= link.value %>
| <%= link_to "delete", link, method: :delete,
                                 data: { confirm: "You sure?" } %></span>
</li> 
```

为什么我会收到此错误？

![grep](../Images/fa8b6f47e000804f083b9654bd3334a1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:59:11.150

您在 github 上的代码与您在此处的代码不同，但是您不需要先在`destroy`操作中找到链接然后将其销毁吗？现在它调用`destroy`一个空`@link`变量。

由于链接和路线看起来不错，我猜你应该有这样的破坏动作：

```
def destroy
  @link= Link.find(params[:id])
  @link.destroy
  redirect_to links_path
end 
```

除非您在应用程序中的某个位置找到了 @link 对象的过滤器。在 github 上更新您的代码，以便我可以下载它并将其安装在我的计算机上，以便在上述解决方案不起作用时进行更多调查。

# bash - Printf 在 BASH 中添加换行符，我不知道如何摆脱它们

> ID：15364433
> 
> 赞同：1
> 
> 时间：2013-03-12T14:47:38.493
> 
> 标签：bash, printf

我的 BASH 脚本中有以下 printf 语句，可以很好地显示我的脚本输出：

```
printf "%-20s %-25s %-5s %-10s %-20s \n" $hostn $kernl $uptim $owner $team 
```

输出如下：

```
Hostname1        2.6.32.12-0.7-default     307   Lastname, Firstname
Team1
Hostname2        2.6.32.12-0.7-default     270   Lastname, Firstname
Team1
Hostname3        2.6.32.12-0.7-default     298   Lastname, Firstname
Team1
Hostname4        2.6.32.12-0.7-default     271   Lastname, Firstname
Team2 
```

我不确定为什么将团队添加到新行。我尝试添加另一个字段，但它做同样的事情：

```
printf "%-20s %-25s %-5s %-10s %-20s %s\n" $hostn $kernl $uptim $owner $team "test"

Hostname1        2.6.32.12-0.7-default     307   Lastname, Firstname         Team1
test
Hostname2        2.6.32.12-0.7-default     270   Lastname, Firstname         Team1
test
Hostname3        2.6.32.12-0.7-default     298   Lastname, Firstname         Team1
test
Hostname4        2.6.32.12-0.7-default     271   Lastname, Firstname         Team2
test 
```

这些换行符来自哪里？我的 printf 格式不正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:51:26.570

在编写 shell 脚本时，请始终引用您的扩展（全部引用，除非您有特定的理由不这样做！）：

```
printf "%-20s %-25s %-5s %-10s %-20s %s\n" \
       "$hostn" "$kernl" "$uptim" "$owner" "$team" "test" 
```

由于您`$owner`可以包含空格，因此如果您没有正确引用，则姓氏可能会滑入该`$team`字段，否则会`test`显示为另一个`%-20s`字段，用于下一行的`$hostn`.

# c# - SemWeb - 将 C# 对象转换为 RDF 三元组

> ID：15364436
> 
> 赞同：0
> 
> 时间：2013-03-12T14:47:50.967
> 
> 标签：c#, rdf, ontology, triples, semweb

我想要的只是使用 semweb 将 C# 类实例转换为 rdf 三元组，以便用数据填充我的本体。我的类由原始属性和其他类组成，并且我构建了具有相同结构的本体。例如

```
class Place{

string name;
Image  pic;

} 
```

有什么资源可以提供帮助吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:28:29.713

您确实意识到 SemWeb 是废弃软件，并且近 3 年没有收到新版本，对吧？如果你真的想使用 SemWeb，那么看看[LinqToRdf](http://code.google.com/p/linqtordf/)，它甚至是更多的 adandonware（最后一个版本是 4 年半前），但它提供了一个 ORM 样式层来使用基于属性的注释将 C# 类与 RDF 进行转换。

对于一些更新且积极维护的替代方案，请参阅[BrightStarDB](http://www.brightstardb.com)或[RomanoWeb](https://bitbucket.org/romanticweb/romanticweb)，BrightstarDB 是该领域中更成熟的解决方案。

如果您喜欢推出自己的解决方案，您可以查看[dotNetRDF](http://www.dotnetrdf.org)（*免责声明 - 我开发了这个*），它是用作[BrightStarDB](http://www.brightstardb.com)和[RomanoWeb](https://bitbucket.org/romanticweb/romanticweb)基础的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:34:52.577

答案是使用 C# 反射来调查您要转换的实例的属性和类并使用：

```
store.Add( new Statement( subject, predicate, object ) 
```

为了编写你想要的三元组，在[SemWeb 文档中有很好的记录](http://razor.occams.info/code/semweb/semweb-current/doc/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-12T08:23:28.240

当我使用 rdf 数据时，我创建了 3 个**URI**节点
n1、n2、n3。然后，
`Triple t = new Triple(n1, n2, n3);`
`IGraph g = new Graph();`

`g.Assert(t);`
`store.Add(g);`

I hope this will help you.

# android - 清除android的dhcp和dns缓存

> ID：15364439
> 
> 赞同：6
> 
> 时间：2013-03-12T14:47:55.630
> 
> 标签：android, dns, ip

有没有办法以编程方式清除 android 设备的 dns 缓存？？我在谷歌上搜索了很多，但没有找到任何关于此的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-19T14:27:57.183

以 root 身份在 shell 中执行：

> ndc 解析器 flushdefaultif

如果您想以编程方式执行此操作，请尝试以下代码：

```
 public boolean reboot() {
    Process proc = null;
    try {
        proc = Runtime.getRuntime().exec("su");
        proc.getOutputStream().write(("ndc resolver flushdefaultif").getBytes());
        return proc.waitFor() == 0;
    } catch (IOException e) {
        e.printStackTrace();
    }
    catch (InterruptedException e) {
        e.printStackTrace();
    }

    return false;
} 
```

# sharepoint-2010 - 将参数传递给自定义 SharePoint 列表表单

> ID：15364444
> 
> 赞同：0
> 
> 时间：2013-03-12T14:48:05.427
> 
> 标签：sharepoint-2010

单击视图项时，是否可以将列数据作为参数传递给自定义 dispform.aspx？

例如，如果我的自定义显示表单名称是 MyDispform.aspx，并且当单击列表项时，它将打开我的显示表单，例如 MyDispform.aspx?user=participant，其中参与者是项目的列名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T11:36:41.510

在页面 url 中添加参数，通常在请求按钮单击事件中完成，如列表显示表单，从“编辑项目”按钮完成，但要做到这一点，需要自定义 ECB列表的菜单。

所以，根据我的理解，我们可以尝试在你的自定义显示表单页面加载事件中添加一个重定向选项，在事件中，重定向到指定参数的url：MyDisplayForm.aspx?user=participant，在事件中我们也可以得到项目信息，可以检索参数值。请试一试。

谢谢

# django-compressor - django-compressor：具有相对于文件夹的路径的 CSS 图像

> ID：15364445
> 
> 赞同：8
> 
> 时间：2013-03-12T14:48:06.393
> 
> 标签：django-compressor

我正在将 django-compresor 用于部署在 heroku 上的应用程序，亚马逊 S3 提供静态文件。除了背景图像中引用的我的css中的图像之外，一切都工作正常： url() 没有使用正确的路径呈现。

我的静态文件按以下目录结构组织：

```
-static
    -myapp
        -js
        -css
        -img
    -bootstrap
        -js
        -css
        -img
    -othervendor
        -js
        -css
        -img 
```

因此，我在 url() 中使用的路径是相对于 css 文件的：

```
url("../img/icon.png") 
```

我所有的 css 文件都被压缩并移动到我的静态目录中的 CACHE 文件夹中，并且 CACHE 目录的 url 正确呈现为：

```
https://mybucket.s3.amazonaws.com/static/CACHE/css/somehash.css 
```

问题是 css 文件 url() 中的图像呈现为：

```
https://mybucket.s3.amazonaws.com/static/CACHE/img/imagefile.png 
```

它应该是：

```
https://mybucket.s3.amazonaws.com/static/myapp/img/imagefile.png 
```

或者如果图像被复制到 CACHE 目录，这将起作用：

```
https://mybucket.s3.amazonaws.com/static/CACHE/img/imagefile.png 
```

我的临时解决方法是将我的 css 中的图像路径更改为以下内容，它可以工作：

```
url("/static/foldername/img/icon.png") 
```

我是 django 和压缩器的新手，所以我不确定正确的行为应该是什么，但这似乎不正确。我看到它的方式，如果我可以让 django 压缩器执行以下两项操作之一，则可以解决问题：1）将 css url() 中引用的所有图像复制到 CASHE/img 目录或 2）呈现由表示的正确 url ../这是我的设置：

我模板中的 css 文件位于 {% compress css %} 块中。

s3utils.py（用于在我的存储桶中创建单独的媒体和静态目录）

```
from storages.backends.s3boto import S3BotoStorage

StaticS3BotoStorage = lambda: S3BotoStorage(location='static')
StaticRootS3BotoStorage = lambda: S3BotoStorage(location='static')
MediaS3BotoStorage = lambda: S3BotoStorage(location='media')
MediaRootS3BotoStorage = lambda: S3BotoStorage(location='media') 
```

设置.py

```
DEFAULT_FILE_STORAGE = 'myapp.settings.s3utils.MediaRootS3BotoStorage'
STATICFILES_STORAGE = 'myapp.settings.s3utils.StaticRootS3BotoStorage'

AWS_ACCESS_KEY_ID = os.environ.get('AWS_ACCESS_KEY_ID')
AWS_SECRET_ACCESS_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
AWS_STORAGE_BUCKET_NAME = os.environ.get('AWS_STORAGE_BUCKET_NAME')

S3_URL = 'http://%s.s3.amazonaws.com/' % AWS_STORAGE_BUCKET_NAME
MEDIA_URL = S3_URL+'media/'
MEDIA_ROOT = S3_URL+'media/'
STATIC_URL = S3_URL+'static/'
STATIC_ROOT = S3_URL+'static/'

COMPRESS_STORAGE = STATICFILES_STORAGE 
COMPRESS_URL = STATIC_URL
COMPRESS_ROOT = STATIC_ROOT 
```

我认为必须有一些设置告诉压缩器将 css url("../img/image.png") 复制到 CACHE/img 目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T10:24:41.710

我遇到过同样的问题！

对我来说，它首先似乎是压缩机的问题。我将我的前缀 S3Storage 后端从

```
StaticS3Backend = lambda: S3BotoStorage(location='static') 
```

至

```
class StaticS3Backend(S3BotoStorage):
    location = 'static' 
```

因为另一种方法没有正确设置位置值（它保持为空）

这为我解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T18:26:01.027

我根本没有找到任何好的解决方案。这里有一些很好的讨论[https://github.com/jezdez/django_compressor/issues/226](https://github.com/jezdez/django_compressor/issues/226)

在您的 CSS 文件中，使用指向您的 Amazon S3 上的图像 url 的绝对路径将使其正常工作。但不用说，这是愚蠢的。为什么我希望我的本地开发和测试环境都使用来自 prod 的图像？有时，甚至不能接受。假设您要更改图像并测试一段时间。（您可以手动将新图像上传到 s3 并手动将对该图像的所有数千个 css 引用更改为新 url。再次，愚蠢。）

更好的方法是在你的 CSS 中使用 {{STATIC_URL}} 来构建绝对路径而不是相对路径。[是的，如果您添加此处提到的compressor.filters.template.TemplateFilter https://django_compressor.readthedocs.org/en/1.3/settings/#base-settings](https://django_compressor.readthedocs.org/en/1.3/settings/#base-settings)，您可以使用{{STATIC_URL}} 。这解决了多阶段问题。但是，它不适用于本地开发，因为您没有在此处进行压缩，如果这样做，您将很难调试。

我个人觉得 django-compressor 里面有compressor.filters.template.TemplateFilter 是错误的。它应该是 django 的一部分。您可以为 css 和 js 打开的可选进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-06T02:55:45.393

我最近遇到了这个问题，并通过设置`COMPRESS_OUTPUT_DIR = ''`. 这导致压缩文件保存在静态根目录中，而不是静态下的默认“CACHE”目录。

# opengl - 为 glsl 设置光泽度

> ID：15364454
> 
> 赞同：0
> 
> 时间：2013-03-12T14:48:39.983
> 
> 标签：opengl, glsl, lwjgl

我如何设置opengl shininess float，所以我可以在着色器程序中使用它`gl_FrontMaterial.shininess`？

*我试过了`glMaterialf(GL_FRONT_AND_BACK, GL_SHININESS, 100f);`，但亮点并没有变小，所以我猜 shinines 没有改变。*

**编辑：** 这是我使用它的片段着色器程序：

```
varying vec4 varyingColor;
varying vec3 varyingNormal;
varying vec4 varyingVertex;
varying vec2 varyingTexCoord;
uniform sampler2D my_color_texture;
varying vec3 varyingEyeVec;

void main() {
    vec3 vertexPosition = (gl_ModelViewMatrix * varyingVertex).xyz;
    vec3 surfaceNormal = normalize((gl_NormalMatrix * varyingNormal).xyz);
    vec3 lightDirection = normalize(gl_LightSource[0].position.xyz - vertexPosition);
    float diffuseLightIntensity = max(0, dot(surfaceNormal, lightDirection));
    gl_FragColor.rgb = diffuseLightIntensity * varyingColor.rgb;
    gl_FragColor += gl_LightModel.ambient;
    vec3 reflectionDirection = normalize(reflect(lightDirection, surfaceNormal));
    vec3 eyeVecNormal = normalize(varyingEyeVec);
    float specular = max(0.0, dot(eyeVecNormal, reflectionDirection));
    if (diffuseLightIntensity != 0) {
        float fspecular = pow(specular, gl_FrontMaterial.shininess)*gl_LightSource[0].specular.rgb;
        gl_FragColor += fspecular;
    }
    gl_FragColor = texture2D(my_color_texture, varyingTexCoord)*gl_FragColor;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T16:03:05.780

# javascript - 一键提交两张表格（新窗口支付宝支付）

> ID：15364461
> 
> 赞同：1
> 
> 时间：2013-03-12T14:48:45.303
> 
> 标签：javascript, jquery, forms

我正在尝试通过单击提交两个表单。我正在尝试打开一个新窗口，以便用户可以使用贝宝付款。

以下是它的工作原理：

有一个表格可以预约。

如果用户选择使用 paypal 单选按钮付款，并且表单已提交，则新的 paypal 结帐表单将添加到原始表单之外的页面。像这样：

```
if ($paypal_radio.eq(1).attr('checked')) {

    //make paypal buttons
    $('#content').append('<div id="paypal_form_container">');
    var $paypal_form = $('#paypal_form_container');

    //make the form template
    var paypal_form_template ='\
    <form action="https://www.paypal.com/cgi-bin/webscr" target="_blank" method="post" id="paypal_form"> \
    <input type="hidden" name="cmd" value="_xclick"> \
    <input type="hidden" name="business" value="email@email.com"> \
    <input type="hidden" name="lc" value="US"> \
    <input type="hidden" name="item_name" value="whatever"> \
    <input type="hidden" name="currency_code" value="USD"> \
    <input type="hidden" name="lc" value="US"> \
    <input type="hidden" name="rm" value="1"> \
    <input type="hidden" name="Cleaning Service" value="whatever"> \
    <input type="hidden" name="amount" value="'+totalValue+'"> \
    </form> \
    ';

    //add the form to the page
    $paypal_form.html(paypal_form_template);

    //submit both forms
    $('#paypal_form').submit();
    $(this).parents("form").submit();
} 
```

我希望提交贝宝表格并在新窗口中打开（注意目标空白），然后将预订表格提交到当前页面。

我的问题是，只有最后一个提交值被发送，无论是最后一个，都没有关系。

处理此问题并一键发送两种表单的最佳方法是什么？

# sql - INTEGER 括号内的数字表示什么？

> ID：15364467
> 
> 赞同：3
> 
> 时间：2013-03-12T14:49:14.403
> 
> 标签：sql, oracle, plsql, oracle11g

有什么作用：

```
value_1 INTEGER(5); 
```

意思是 ？

我知道这`value_1`是一个整数，但`5` 声明中的含义是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:16:50.530

在 Oracle 中，这意味着数字所允许的最大十进制位数。
因此，number(5) 类型的变量可以包含 99999，但不能包含 100000。
事实上，该子类型将您的值限制为 -99999 到 99999。

[涵盖子类型的 Oracle 文档`number`，其中一个是`integer`.](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/datatypes.htm#sthref677)

[涵盖该`number`类型的 Oracle 文档。](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/datatypes.htm#sthref669)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T18:02:21.087

简单来说，当有人写类似 value_1 INTEGER(5); 表示定义一个名为 value_1 的数字类型变量，该数字类型的精度为 5。

除了精度之外，还可以像这样定义比例： value_1 number(p,s) --其中 p 是精度，s 是比例。

在 Oracle 11g 中 - Precision 的范围可以从 1 到 38，Scale 的范围可以从 -84 到 127。

例如，number(7,2) 是一个小数点前 5 位和小数点后 2 位的数字。

现在假设您要定义一个应该始终 <1000 的数字，那么您可以这样定义：

NUMBER(3,2) 以便您可以容纳最大 999.99

希望这有帮助！

# c - 为什么获取请求格式不正确？

> ID：15364481
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:49:39.957
> 
> 标签：c, perl, http, activestate

我正在使用用 Active State Perl 编写的服务器。显然，如果`GET`请求格式不正确，响应结果将返回，但没有它们的 http 标头。在我的情况下确实如此。

`IO::Socket`Perl 服务器分别使用和监听请求并发送响应`SendHTTPRequest`。

所以我的问题如下。以下`GET`请求无效吗？

> "GET ?CA=1&STREET=990%20MASS%20AVENUE&STREET2=UNIT%20A37&CITY=ARLINGTON&STATE=MA&ZIP=00000%20HTTP/1.1\r\n\r\n"

如果请求无效，它如何无效？我想更正格式。

显然，ActiveState Perl 认为该请求无效。

正确设置套接字后，以下代码发送请求并等待响应。如果您需要查看包含主机名的套接字设置，我将编辑这篇文章并在底部添加，但假设套接字设置正确。

```
size_t bytes_read = 0; /* Keeps per-loop read-count. */
char local_buf[INET_BUF_LEN] = {'\0'};
total_socket_read_bytesM = 0; /* Initialize module-scope read length */
write (socket_fdP, request_bufP, strlen(request_bufP));

while(TRUE)
{
  if(total_socket_read_bytesM  <= (read_bufP_len - 1))
  {
    bytes_read = read(socket_fdP, (local_buf + bytes_read), sizeof(local_buf));

    if (bytes_read == 0)
    {
      break;
    }
    else
    {
     total_socket_read_bytesM += bytes_read;
    }
  }
  else
  {
    break;
  }
} 
```

我可以踢球，不用担心，因为我得到了结果。但是，我想编写我的 C 程序来创建一个有效的 http`GET`请求。

结语：

这是我的工作请求的样子：

"GET /?CA=1&STREET=990%20MASS%20AVENUE&STREET2=UNIT%20A37&CITY=ARLINGTON&STATE=MA&ZIP=00000 HTTP/1.1\r\n\r\n"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:54:10.413

HTTP/1.1 中需要“Host”请求字段，所以你的请求确实是无效的。

`%20HTTP/1.1`也是错的。在资源名称之后和 HTTP 版本之前必须有一个实际的空格字符，而不是转义空格。

我不确定（也懒得检查）资源标识符是否可以`?`在请求中开始。如果不是，那么它应该是`/?CA=1...`。

# javascript - jqplot条形图问题

> ID：15364482
> 
> 赞同：0
> 
> 时间：2013-03-12T14:49:44.843
> 
> 标签：javascript, jqplot

我需要帮助来用 jqplot 绘制图表。该图很简单，但 jqplot 使它变得复杂。我需要得到这样的图表：

![在此处输入图像描述](../Images/ac9591f5b9421c3c95bb101e0cd13bb3.png) .

有一些改进：

颜色在这里定义：

```
graphColors = ['#048ff1', '#79b924', '#ffa600', '#ef5257', '#7b279b', '#8ff104',
               '#b92479', '#5257ef', '#279b7b', '#f1048f', '#00ffa6', '#9b7b27'] 
```

一些渲染选项在这里：

```
seriesDefaults: {
    seriesColors: graphColors,
    renderer: $.jqplot.BarRenderer,
    rendererOptions: { barDirection: 'vertical' }
    },
    axes: {
        yaxis: {
            renderer: $.jqplot.CategoryAxisRenderer,
            ticks: [ /* to be filled in automatically */ ]
        },
    xaxis: {
        min: 0
        }
    } 
```

我需要渲染的数据在这里：

```
//in the image I used instead of letters '1'
data = [[['a', 1112]],
        [['b', 1127]],
        [['c', 822]],
        [['d', 1039]]
       ]; 
```

问题：

1.  如何为每个条设置一个标签（'a'、'b'、'c'、'd' 等）？

2.  如何将系列移动到从左侧开始（而不是像现在这样在中间，当然左侧有一个小边距？

3.  y 轴上的值，大于 1000 的值在图形线上呈现。如何在轴值和图形之间设置空间？

4.  我想画的图很简单。不使用系列可以获得相同的结果吗？我想要的只是一个条形图，每个条形图都有不同的颜色并显示特定的标签？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:43:49.340

请参阅下面的代码和注释。[在这里](http://jsfiddle.net/JWhmQ/1530/)拉小提琴。

您列表中的第 2 项，我不清楚，如果您将情节推到左侧，则右侧有空白区域。最好让情节填满所有可用空间。

```
$(document).ready(function(){

   var graphColors = ['#048ff1', '#79b924', '#ffa600', '#ef5257', '#7b279b', '#8ff104',
           '#b92479', '#5257ef', '#279b7b', '#f1048f', '#00ffa6', '#9b7b27'];

   var data = [
        [1112],
        [1127],    
        [822],
        [1039]];

    var ticks = ['This is how to tick'];

    plot2 = $.jqplot('chart1', data, {
        seriesColors: graphColors, 
        seriesDefaults: {                
            renderer:$.jqplot.BarRenderer
        },
        axesDefaults:{pad: 1.3}, // Item 2, increase this padding so labels are cut off
        // Item 4, no, jqplot treats each differently colored bar as a series, so you must provide series options
        series:[
            {pointLabels:{show:true,labels:['a']}}, // Item 1, the label for each bar is the "labels" array 
            {pointLabels:{show:true,labels:['b']}},
            {pointLabels:{show:true,labels:['c']}},
            {pointLabels:{show:true,labels:['d']}}
        ],
        axes: {                
            xaxis: {
                renderer: $.jqplot.CategoryAxisRenderer,
                ticks: ticks // comment this out for "autoticks"
            }
        }
    });
}); 
```

![在此处输入图像描述](../Images/619d07bc05c57208ccfc8a201178b050.png)

# c# - 尝试将第三项添加到过滤器时，“参数数据类型 ntext 对上层函数的参数 1 无效”

> ID：15364484
> 
> 赞同：3
> 
> 时间：2013-03-12T14:49:54.013
> 
> 标签：c#, linq, entity-framework

我一直在关注 ASP.NET 网站上的 Contoso 大学教程。我正在尝试扩展我的技能，因此决定尝试在过滤器中添加第三个选项。本教程提供：

```
if (!String.IsNullOrEmpty(searchString))
{
    students = students.Where(s => s.LastName.ToUpper().Contains(searchString.ToUpper())
                           || s.FirstMidName.ToUpper().Contains(searchString.ToUpper()));
} 
```

假设我有第三列称为昵称。我尝试通过添加额外的 || 将其添加到过滤器中 操作员：

```
if (!String.IsNullOrEmpty(searchString))
{
    students = students.Where(s => s.LastName.ToUpper().Contains(searchString.ToUpper())
                           || s.FirstMidName.ToUpper().Contains(searchString.ToUpper())
                           || s.Nickname.ToUpper().Contains(searchString.ToUpper()));
} 
```

当我添加第三个选项运行时，我得到：

`[SqlException (0x80131904): Argument data type ntext is invalid for argument 1 of upper function.]`

我在这里想念什么？接下来我需要学习什么来帮助我更多地了解这里发生的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:37:53.413

我记得在使用实体框架之前遇到了 NTEXT 列的问题。为了解决这个问题，我现在只使用 NVARCHAR(MAX)。我不确定这对您的情况是否有帮助..您是否能够更改数据库类型...否则，这里有更多信息：

[Linq to Entities：在 NText 字段上使用 ToLower()](https://stackoverflow.com/questions/2431908/linq-to-entities-using-tolower-on-ntext-fields)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:31:04.633

试试下面的链接。

[http://johnnblade.wordpress.com/2011/01/03/sql-query-replace-error-argument-data-type-ntext-is-invalid-for-argument-1-of-replace-function/](http://johnnblade.wordpress.com/2011/01/03/sql-query-replace-error-argument-data-type-ntext-is-invalid-for-argument-1-of-replace-function/)

您必须将当前的 text/ntext 值转换为 nvarchar(max)。

# sql - 带有联合子查询的 Oracle、cast 和 multiset

> ID：15364485
> 
> 赞同：1
> 
> 时间：2013-03-12T14:49:57.880
> 
> 标签：sql, oracle

我是 PL/SQL 的新手，在 Oracle 中使用自定义表类型创建视图时遇到问题。这些是创建的类型：

```
create or replace
TYPE "Control" AS OBJECT ("Date" nvarchar2(10), "R" number(7,3), "Limit(7,3);
create or replace TYPE Controls AS TABLE OF "Control";

CREATE OR REPLACE TYPE Result_typ AUTHID CURRENT_USER AS OBJECT (
  "Program" varchar(10),
  "ID_User" nvarchar2(25),
  "Controls" Controls,
 ) 
```

在 DB 中，我们有两种不同类型的控件（c_control、g_control）存储在不同的表中，公共字段很少。我正在尝试创建一个视图，选择所有不同的控件，尽管它们的类型不同，所以我使用 UNION 子句。这是我的视图创建语句（进行了一些细微的更改以使其更简单）：

```
CREATE OR REPLACE VIEW "all_controls" OF Result_typ 
with object IDENTIFIER ("ID_User") 
as SELECT 'MYAPP' as Program, 
u.user_id as "ID_User", 
CAST(MULTISET(
     select to_char(control_date,'yyyy-mm-dd') as "Date", 
  r as "R", 
     limit as "Limit"
     from g_control
     where control_date between to_date('20130310','yyyymmdd') 
     and to_date('20130313','yyyymmdd')
  UNION
     select to_char(control_date,'yyyy-mm-dd') as "Date", 
 r as "R", 
 limit as "Limit",
 from control
 where and control_date between to_date('20130310','yyyymmdd') 
     and to_date('20130313','yyyymmdd')
) AS Controls) 
FROM user u
WHERE u.user_name like 'Scott'; 
```

从 SQL Developer 执行语句时，返回值为“SQL 错误：没有更多数据可从套接字读取”。在 MULTISET 中执行 UNION 是否有任何问题？如何选择 UNION 结果作为 MULTISET？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T18:29:50.557

```
SELECT
    CAST(MULTISET(
            select '2013-01-01' a, 1 b, 1 c from dual union all
            select '2013-01-01', 1, 1 from dual
    ) AS Controls) 
FROM dual;

ERROR at line 1:
ORA-03113: end-of-file on communication channel
Process ID: 7292
Session ID: 201 Serial number: 4479 
```

添加一个额外的内联视图似乎可以解决它：

```
SELECT
    CAST(MULTISET(
        select * from
        (
            select '2013-01-01' a, 1 b, 1 c from dual union all
            select '2013-01-01', 1, 1 from dual
        )
    ) AS Controls) 
FROM dual;

CONTROLS(Control('2013-01-01', 1, 1), Control('2013-01-01', 1, 1)) 
```

（[感谢 Oracle 论坛上的 MichaelS](https://forums.oracle.com/forums/thread.jspa?threadID=671018)）

其他一些建议：

1.  避免引用标识符。它使对象更难使用。
2.  避免将日期存储为字符串。 **特别**是如果您使用对象类型。字符串类型的对象关系数据很奇怪。
3.  如果没有功能，AUTHID CURRENT_USER 将无济于事。
4.  更好的缩进有助于我们更容易理解问题
5.  始终包含完整的错误消息
6.  完整的模式定义会有所帮助。
7.  您的示例中有很多语法错误。
8.  正如@APC 提到的，Oracle 的对象关系特性非常困难。如果可能，您应该重新考虑使用它。您可能应该首先关注常规关系技术。
9.  这里还是有一些bug。检查警报日志，您会看到类似`ORA-07445: exception encountered: core dump [qcsfsqacn()+105] [ACCESS_VIOLATION] [ADDR:0x4] [PC:0x12286C1] [UNABLE_TO_READ] []`. 如果此解决方法还不够，您需要联系 Oracle 支持以了解此错误。我已经在 My Oracle Support 上进行了检查，目前没有关于此错误的文档。

# php - Codeigniter htaccess 重写器

> ID：15364489
> 
> 赞同：0
> 
> 时间：2013-03-12T14:50:12.470
> 
> 标签：php, .htaccess, codeigniter, mod-rewrite, localhost

我正在尝试使用带有 codeigniter 的重写器来缩短我的网页 url。

我有我的.htaccess：

```
RewriteEngine on
RewriteBase /ci/
RewriteRule ^([0-9a-zA-Z_-]+)?$ index.php/controller/method/$1 
```

但似乎我的应用程序忽略了所有。

我放：

```
http://localhost/ci/variable 
```

并显示错误页面：

找不到对象错误 404。

`LoadModule rewrite_module modules/mod_rewrite.so`也不评论。

我已经在一个简单的项目中完成了它，并且似乎它有效，但不适用于我的 codeigniter。

有人可以帮我解决这个问题吗？

谢谢。

已解决：

```
Adding RewriteEngine on
RewriteRule ^([0-9a-zA-Z_-]+)?$ /ci/index.php/controller/method/$1 [L,R=301] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:58:25.207

除非您有一个使用名为`Controller`的方法命名的控制器，否则`method`此行将失败：

```
index.php/controller/method/$1 
```

尝试这样的事情：

```
RewriteRule ^(.*)/index/?$ $1 [L,R=301] 
```

请记住，CodeIgniter 处理请求的方式是将脚本名称 (index.php) 之后发生的所有内容`/`用作分隔符。然后它开始搜索基于该数组的控制器。既然我打赌你没有`Controller`控制器，也没有`Controller_Method`控制器，CodeIgniter 会立即向你吐舌头并拒绝合作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:53:54.260

确保将 htaccess 文件放在本地服务器的根文件夹中

IE。

如果 WAMP 把它放在 wamp/www/.htacess

或者如果 XAMPP 把它放在 xampp/htdocs/.htaccess

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:47:37.327

如果所有内容都在文件夹`/ci`中，即 .htaccess、index.php，那么您`RewriteRule`应该可以正常工作。

如果`index.php`在根目录中，则添加前导斜杠

```
RewriteRule ^([0-9a-zA-Z_-]+)?$ /index.php/controller/method/$1 
```

如果`.htaccess`也在根目录中，请删除`RewriteBase`并`ci`添加到您的`RewriteRule`

```
RewriteEngine on
RewriteRule ^ci/([0-9a-zA-Z_-]+)?$ /index.php/controller/method/$1 
```

如果这些都不起作用，请准确指定每个文件的位置，即 .htaccess 在哪里，index.php 在哪里。

# ruby-on-rails - 如何为一张表中的两个模型生成 CSV 报告？

> ID：15364491
> 
> 赞同：0
> 
> 时间：2013-03-12T14:50:23.167
> 
> 标签：ruby-on-rails, ruby, csv

我有两个模型：具有以下属性的**公司**和**雇主：**

```
Company
  Name
  Phone
  Address
Employer
  Name
  Phone
  Address 
```

我想生成如下 CSV 表：

![在此处输入图像描述](../Images/8e803c9eba5595f30d61c4e9fcb7f6da.png)

这该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:01:52.963

只是在折叠循环中进行

UPD：正如 Yuriy 所说，应该使用急切加载

```
companies = Company.includes(:employers).all
...
companies.each do |c|
  csv << c.info
  c.employers.each do |e|
    csv << e.info
  end
end 
```

# javascript - 使用 jquery / javascript 从未加载的文档中加载 html 头

> ID：15364493
> 
> 赞同：1
> 
> 时间：2013-03-12T14:50:24.740
> 
> 标签：javascript, jquery, html, get, head

我正在为我父亲的驾校重新编写一个网站，将不必要的 iframe 和图像更改为 html5 和 css3 标记，并通过 javascript 和 jquery 改进功能。

现在，每个菜单项（用于搜索爬虫）都有一个完整的页面，而标题和菜单大部分保持不变。这就是为什么我想使用历史 API 并在启用了 javascript 的设备上单击链接时更改内容和文档标题和描述，因此不必刷新整个页面。

什么工作： - 获取目标页面的#content div并将其加载到当前页面 - 使用历史API显示一个新的url和popstate事件返回到以前的状态 - 从当前更改html头的内容文档

什么不起作用： - 从目标文档中获取 html 头

应该有一个简单的功能，对吧？或者一个好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:31:31.970

由于它位于同一来源，因此您*可以*这样做。这有点尴尬，尽管当你使用它的 ajax 时，它与 jQuery 在幕后所做的事情相差一百万英里`load`（我希望 jQuery 使用一个文档片段而不是一个`iframe`.

基本上，您可以创建一个 off-page `iframe`，将内容页面加载到那里，然后从中提取您需要的任何内容，如下所示（完全未优化）：

```
// I'm assuming you have a variable containing the content URL; I'll use `page`
var page = "/ocazuc/2";

// Create the iframe, put it off-page, and put it in the DOM
var iframe = $('<iframe>');
iframe.css({
  position: "absolute",
  left: -10000
}).appendTo(document.body);

// Hook the load event on it
iframe.load(function() {
  // Get the document
  var $doc = $(iframe[0].contentDocument.documentElement);

  // Steal its content
  $doc.find("body").contents().appendTo(document.body);

  // And use its title or whatever else you want from the `head`
  document.title = $doc.find('title').text();

  // Done with it
  iframe.remove();
});

// Start loading it
iframe[0].src = page; 
```

[实例](http://jsbin.com/esapuf/1)| [来源](http://jsbin.com/esapuf/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T23:24:47.730

在接受的答案下查看我的评论。基本上，使用该方法存在一些性能问题，这使我寻找更好的方法。为此，我采用了在 rails turbolinks 项目中发现的一种方法，该方法是麻省理工学院许可和编写的咖啡脚本。归功于他们解决了一些浏览器兼容性问题。

[https://github.com/rails/turbolinks](https://github.com/rails/turbolinks)

```
/*
 * A function that takes a string of HTML and returns a document object.
 */
var parseDocument = (function() {
    function createDocumentUsingParser(html) {
        return (new DOMParser()).parseFromString(html, 'text/html');
    }
    function createDocumentUsingDOM(html) {
        var doc = document.implementation.createHTMLDocument('');
        doc.documentElement.innerHTML = html;
        return doc;
    }
    function createDocumentUsingWrite(html) {
        var doc = document.implementation.createHTMLDocument('');
        doc.open('replace');
        doc.write(html);
        doc.close();
        return doc;
    }
    /*
     * Use createDocumentUsingParser if DOMParser is defined and natively
     * supports 'text/html' parsing (Firefox 12+, IE 10)
     * 
     * Use createDocumentUsingDOM if createDocumentUsingParser throws an exception
     * due to unsupported type 'text/html' (Firefox < 12, Opera)
     * 
     * Use createDocumentUsingWrite if:
     *  - DOMParser isn't defined
     *  - createDocumentUsingParser returns null due to unsupported type 'text/html' (Chrome, Safari)
     *  - createDocumentUsingDOM doesn't create a valid HTML document (safeguarding against potential edge cases)
     */
    var parser;
    if (window.DOMParser) {
        try {
            var testDoc = createDocumentUsingParser('<html><body><p>test');
            if (testDoc && testDoc.body && testDoc.body.childNodes.length === 1) {
                parser = createDocumentUsingParser;
            }
        } catch(ex) {
            parser = createDocumentUsingDOM;
        }
    }
    if (!parser) {
        parser = createDocumentUsingWrite;
    }
    return parser;
})(); 
```

然后大概例如您可以执行以下操作：

```
var doc = parseDocument(wadOfHtml);
var title = doc.title;
var $content = $(doc).find('#content'); 
```

请注意，我尚未亲自验证此代码是否有效，我将失去 rails 项目的声誉。我也没有验证我对coffeescript 的改编是否没有引入语法或其他错误。我什至还没有运行它。我只是乐观。

# javascript - 在 iPad 上更改方向后页面元素放置不正确

> ID：15364496
> 
> 赞同：1
> 
> 时间：2013-03-12T14:50:32.917
> 
> 标签：javascript, html, ios, css, safari

在窗口调整大小（桌面）或方向更改（iPad）后，我运行一些代码来重新定位页面上的元素。我面临着对我使用的那些元素进行不当重新定位的问题。我要重现此问题的方法是：

1.  以垂直方向加载页面。一切看起来都很好。
2.  将 iPad 旋转 90 度。应该重新定位的元素，正确执行。一切看起来都很好。
3.  将 iPad 向后旋转。问题出现并如下所示：

![旋转后元素重新定位不当](../Images/4e1c994acd89a51b1e7ecdb74ab0865f.png)

这是它的样子：

![这里看起来不错](../Images/c15c4f5ca69526c49d1e46c2c269b263.png)

如果我评论重新定位这些元素的代码，除了元素之外，它看起来都很好。iPad Safari 和 iPad Chrome 也是如此。如果我在桌面浏览器上调整窗口大小，我的代码可以正常工作。问题可能出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:54:19.457

旧 iPad 中存在一个错误，它不会在方向更改时调整大小/缩放。我不确定它是否已在最新的操作系统中修复。在这里查看：[如何在 ipad 中调整/重新缩放网页](https://stackoverflow.com/questions/7557971/how-to-resize-rezoom-webpage-in-ipad)

# r - 在 RMongo 中将字符串作为字符串而不是整数返回？

> ID：15364502
> 
> 赞同：2
> 
> 时间：2013-03-12T14:50:37.587
> 
> 标签：r, mongodb, rmongo

我在 RMongo 中运行以下查询：

```
> test <- dbGetQuery(db,'mycollection', '{"zip" : "06840"}', skip=0,limit=1e10)
> test
      update  zip 
1 2013-03-11 6840 
```

该项目以字符串形式存储在 MongoDB 中，前导零，并且 RMongo 能够以这种方式搜索它。

但是 R 中的 RMongo 返回对象将其转换为整数。我查看了 RMongo 帮助，找不到“不要将数字强制转换为不同类型”的标志。

有什么解决方案可以将我的数据保留为字符串并避免丢失我的前导零？邮政编码在这里是一个典型的违规者，也是一个非常常见的用例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T16:33:29.217

截至 2013 年 11 月 5 日，这是 RMongo 包中的一个错误，目前无法解决。

# json - 带有 JSON 双引号的 Highcharts

> ID：15364507
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:50:49.390
> 
> 标签：json, highcharts, double, quotes

我在这里找到了您的帖子[Trying to push data to a JSON array](https://stackoverflow.com/questions/6614564/trying-to-push-data-to-a-json-array)。我也面临与 highcharts 甘特图相同的 JSON 双引号问题。

从那篇文章中不清楚你是如何解决它的。你能给我更多的细节和示例代码吗？

问候克里希纳

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2017-07-20T08:16:06.020

$str="[";

$result = $conn->query("SELECT name , value AS y FROM table_name");

while($row = $result->fetch_assoc()) {

```
 $str.="{name: '".$row['name']."', y: ".$row['y']."},";

}
 $str.="]"; 
```

# jsf - 取消对 rich:tabPanel 开关的验证

> ID：15364508
> 
> 赞同：3
> 
> 时间：2013-03-12T14:50:49.957
> 
> 标签：jsf, jsf-2, richfaces

我尝试创建一个统一的登录/注册页面。我们为此使用 TabPanel。一个标签用于注册，另一个用于登录。用户应该选择要做什么，然后填写输入。

问题在于：注册有许多必需的输入。因此，如果您想从注册选项卡切换到登录选项卡，验证器会触发并打印有关未填充输入字段的错误消息。有没有办法禁用选项卡切换验证或将验证委托给 bean 函数。在此功能中，我可以根据所选选项卡自行验证。

有任何想法吗？

```
<h:form>
    //some inputs
    <rich:tabPanel id="panelRegisterLogin" switchType="server" activeItem="#{bean.registerLoginStatus}" itemChangeListener="#{bean.updateRegisterLoginStatus}">
        <rich:tab header="logIn" id="logIn" name="logIn">
            //inputs to log in an existing user
        </rich:tab>
        <rich:tab header="Register" id="registerNow" name="registerNow">
            //inputs to register a new user connected to managed bean
                    //some of them are required="true"
        </rich:tab>
    </rich:tabPanel>

    //submit-button
</h:form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T19:09:54.040

添加`immediate="true"`到整体`rich:tabPanel`或单个`rich:tab`元素。

> 即时
> 
> 指示此组件的值必须立即转换和验证的标志（即在应用请求值阶段），而不是等到流程验证阶段。

# search - jira：查找用户解决但失败的问题

> ID：15364510
> 
> 赞同：1
> 
> 时间：2013-03-12T14:50:51.787
> 
> 标签：search, reporting, jira

我刚刚开始使用 Jira 来获取报告。有人可以帮我获取已将状态设置为由用户解决但随后失败的问题列表吗？

我无法生成此报告：

```
(status was "Resolved" by UserX) AND status was "Failed" 
```

使用它，我可以让 UserX 解决所有问题，但它也会返回 userX 在其他人失败后解决的问题。

基本上我想做：

1.  查找所有设置为由 userX 解决的问题
2.  查找此集中在解决状态后失败的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:26:02.477

开箱即用 - 你不能。

我可以想到两种方法来做到这一点：

**创建您自己的 JQL 函数**- 添加一个函数来支持 this。查看[Jira 的插件教程 - 将 JQL 函数添加到 JIRA](https://developer.atlassian.com/display/JIRADEV/Plugin+Tutorial+-+Adding+a+JQL+Function+to+JIRA)。

**添加隐藏的自定义字段以标记**曾经`Resolved`和更改`Failed`为的问题，而不是在匹配自定义字段时搜索问题：

```
status was "Resolved" by UserX AND status was "Failed" AND "customeField" = true 
```

要填充此自定义字段，请使用[AJS](http://orangoo.com/labs/AJS/)（与 jQuery 相同）将函数添加到状态字段，或者使用[Script Runner 插件](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner)添加将更新自定义字段的发布函数。

# java - Java IndexOf 找不到正确的数据

> ID：15364511
> 
> 赞同：1
> 
> 时间：2013-03-12T14:50:52.000
> 
> 标签：java, parsing, indexof

我有一个需要从 HTML 页面解析 HTML 元素的 Java 应用程序。我的简单 HTML 测试设置如下：

```
<!DOCTYPE html>
<html>
<head>
<style type='text/css'>
  div {width:100%;height:100px;background-color:blue;}
</style>
</head>
<body>
  <div></div>
</body>
</html> 
```

我的代码将被设置为它将在文档中搜索此字符串：“<style”

然后搜索关闭的胡萝卜：“>”，因为用户可能已经为他们的 HTML 文件键入了这些组合中的任何一个：

```
<style type="text/css">

or

<style type = "text/css" >

or

<style type = 'text/css' >

or 

<style type='text/css'>

etc.. 
```

所以我的方法是找到“风格”标签和所有东西，直到它的结束胡萝卜

然后找到结束样式标签：

```
</style> 
```

然后抓取这两个实体之间的所有内容。

这是我的文件及其代码：

```
************strings.xml************

String txt_style_opentag = "<style"
String txt_end_carrot = ">"
String txt_style_closetag = "</style>"

***********************************

************Parser.java************
public static String getStyle(Context context, String text) {
    String style = "";

    String openTag = context.getString(R.string.txt_style_opentag);
    String closeTag = context.getString(R.string.txt_style_closetag);
    String endCarrot = context.getString(R.string.txt_end_carrot);

    int openPos1 = text.indexOf(openTag);
    int openPos = text.indexOf(endCarrot, openPos1);
    int closePos = text.indexOf(closeTag, openPos1);

    if (openPos != -1 && closePos != -1)
        style = text.substring(openPos + openTag.length(), closePos).trim();

    if (style != null && style.length() > 0 && style.charAt(0) == '\n')     // first \n remove
        style = style.substring(1, style.length());

    if (style != null && style.length() > 0 && style.charAt(style.length() - 1) == '\n')    // last \n remove
        style = style.substring(0, style.length() - 1);

    return style;
}
******************************************************** 
```

我的结果很接近，但不正确。结果是这样的：

```
{width:100%;height:100px;background-color:blue;} 
```

如果您注意到，它缺少“div”部分。它应该如下所示：

```
div {width:100%;height:100px;background-color:blue;} 
```

我在这里做错了什么。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:01:55.243

您从开始标签（右括号`>`）的末尾获取子字符串并添加开始标签的长度（而不是`endCarrot`），从而将子字符串的开始移动到您想要的位置之前。你想做

```
style = text.substring(openPos + endCarrot.length(), closePos).trim(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:01:01.337

当然......在我寻求帮助之后，我终于弄清楚了。以下代码应更改

从：

```
style = text.substring(openPos + openTag.length(), closePos).trim(); 
```

到：

```
style = text.substring(openPos + endCarrot.length(), closePos).trim(); 
```

对不起这个帖子。并感谢您的建议

# sockets - socketpair api接口的典故是什么？

> ID：15364513
> 
> 赞同：1
> 
> 时间：2013-03-12T14:50:53.473
> 
> 标签：sockets, unix

来自 sys/socket.h 的套接字对（int 系列，int 类型，int 协议，int* sockfd）。

unp 声明family 应该是AF_LOCAL，protocol 应该是0，那么为什么接口需要这样的参数呢？为什么不将其简化为 socketpair(int type, int *sockfd) ？

我相信这里一定有故事，但我就是不知道为什么。

谢谢你告诉我这个故事；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T00:01:56.500

您应该阅读该语句“AF_LOCAL”（或 _UNIX）是*当前*唯一*实现*socketpair() 的协议。

该接口是通用的，*可以*为其他类型的套接字提供实现。例如，通过创建两个使用 localhost IP 相互连接的套接字来实现对 AF_INET 的支持并不难。唯一的问题是它几乎没有实际用途。Unix 套接字更适合本地连接，现在更改现有的套接字对 API 太麻烦了。

# javascript - pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);

> ID：15364517
> 
> 赞同：5
> 
> 时间：2013-03-12T14:51:18.787
> 
> 标签：javascript, ios, objective-c, xcode, webgl

如果使用 OpenGL ES，我一直在试图找出 UNPACK_FLIP_Y_WEBGL 的等效线。我一直无法找到解决方案。

任何人都可以帮我找到一个等价物吗？

问候

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T05:54:31.653

它在 ES 2.0 中不存在。

解决方案从最好到最差

1.  在编译时翻转图像。

    这就是专业人士所做的。为什么要浪费内存和代码，如果不需要，为什么要让用户等待翻转图像？

2.  将图像倒置加载，（libpng 有该选项）

3.  加载后翻转。

    假设每个通道图像的 RGBA 8 位，翻转到位的代码类似于

    ```
     void flipInPlace(unsigned char* data, int width, int height) {
       size_t line_size = width * 4;
       unsigned char* line_buffer = new unsigned char[line_size];
       int half_height = height / 2
       for (int y = 0; y < halfHeight) {
         void* top_line = data + y * line_size;
         void* bottom_line = data + (height - y - 1) * line_size;
         memcpy(line_buffer, top_line, line_size);
         memcpy(top_line, bottom_line, line_size);
         memcpy(bottom_line, line_buffer, line_size);
       }
       delete [] line_buffer;
     } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-23T16:19:51.703

OpenGL ES 中没有 UNPACK_PREMULTIPLY_ALPHA_WEBGL 和 UNPACK_FLIP_Y_WEBGL。

在实现中，WebGL调用OpenGL ES实现js WebGL调用，对于这两个参数，WebGL会在调用OpenGL ES API之前先在CPU上处理，也就是说WebGL使用memcpy来翻转图像（如果flipY为true），然后调用glTexImage2D。

概括：

1.  js 调用 gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true)。WebGL 将其存储为 m_unpackFlipY。

2.  js调用gl.texImage2D，WebGL检查m_unpackFlipY，如果为真，翻转内存中的图像，然后调用glTexImage2D

# haskell - haskell - 使用 QuickCheck 的平均浮点错误

> ID：15364518
> 
> 赞同：14
> 
> 时间：2013-03-12T14:51:20.800
> 
> 标签：haskell, qa, mean, quickcheck, standard-deviation

我正在使用 QuickCheck-2.5.1.1 进行质量检查。我正在测试两个纯函数`gold :: a -> Float` 和`f :: a -> Float`，其中的`a`实例是任意的。

这`gold`是一个参考计算，`f`是我正在优化的一个变体。

迄今为止，我使用 quickcheck 的大多数测试都在使用`\a -> abs (gold a - f a) < 0.0001`.

但是，我想在检查阈值的同时收集统计数据，因为了解平均误差和标准偏差对指导我的设计很有用。

有没有办法使用 QuickCheck 来收集这样的统计数据？

* * *

### 具体例子

举一个我正在寻找的东西的具体例子，假设我有以下两个函数来近似平方根：

```
-- Heron's method
heron :: Float -> Float
heron x = heron' 5 1
    where
      heron' n est
          | n > 0 = heron' (n-1) $ (est + (x/est)) / 2
          | otherwise = est

-- Fifth order Maclaurin series expansion
maclaurin :: Float -> Float
maclaurin x = 1 + (1/2) * (x - 1) - (1/8)*(x - 1)^2
                + (1/16)*(x - 1)^3 - (5/128)*(x - 1)^4
                + (7/256)*(x - 1)^5 
```

对此的测试可能是：

```
test = quickCheck
       $ forAll (choose (1,2))
       $ \x -> abs (heron x - maclaurin x) < 0.02 
```

因此，作为测试的副作用，我想知道的是统计数据`abs (heron x - maclaurin x)`（例如平均值和标准差）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T16:33:50.770

感谢 Chris Kuklewicz 和 Ingo 的评论，我想出了以下内容，收集了我在示例中想要的统计信息：

```
resultToWeightList :: Result -> [(Double,Int)]
resultToWeightList r = [ (read s, n) | (s,n) <- labels r]

weightListMuSigma :: [(Double,Int)] -> (Double,Double)
weightListMuSigma wlst = (mu,sigma)  
  where 
    (weightSum,weightSqrSum,entryCount) = foldl addEntry (0,0,0) wlst
    addEntry (s,s2,c) (v,w) = (s + (v * w'), s2 + (v**2 * w'), c + w)
      where w' = fromIntegral w
    entryCount' = fromIntegral entryCount
    mu = weightSum / entryCount'
    var = weightSqrSum / entryCount' - mu**2
    sigma = sqrt var

quietCheckResult :: Testable prop => prop -> IO Result
quietCheckResult p = quickCheckWithResult args p
  where args = stdArgs { chatty = False }

test :: IO ()
test = do { r <- quietCheckResult $ forAll (choose (1,2)) test'
          ; let wlst = resultToWeightList r
          ; let (mu,sigma) = weightListMuSigma wlst 
          ; putStrLn $ "Average: " ++ show mu
          ; putStrLn $ "Standard Deviation: " ++ show sigma
          }
   where
     test' x = collect err (err < 0.1)
       where err = abs $ heron x - maclaurin x 
```

# google-maps - 谷歌地图返回错误 610

> ID：15364521
> 
> 赞同：7
> 
> 时间：2013-03-12T14:51:37.540
> 
> 标签：google-maps

我有一个谷歌地图 v3 应用程序工作了大约一年，没有任何问题。该应用程序使用两种不同的方法对地址进行地理编码，当我使用谷歌地图 javascript 进行地理编码时，一切正常。我还使用 ac# 页面进行地理编码，我通过 url 请求地理编码。我使用 URL 方法收到错误 610。

这是我使用的网址：[http ://maps.google.com/maps/geo?q=64108&key=KEY](http://maps.google.com/maps/geo?q=64108&key=KEY)

你的网址改了吗？我应该使用不同的东西吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-12T16:41:24.023

Google 已正式弃用对 API v2 的支持[https://developers.google.com/maps/documentation/geocoding/v2/](https://developers.google.com/maps/documentation/geocoding/v2/)

您必须更改查找：[https ://developers.google.com/maps/documentation/geocoding/index](https://developers.google.com/maps/documentation/geocoding/index)

```
Example:
https://maps.googleapis.com/maps/api/geocode/xml?address=64108&sensor=false 
```

而且您不再需要使用密钥，请注意限制已更改为 2500

Google 的这篇文章展示了如何从版本 2 升级到 3： [https ://developers.google.com/maps/articles/geocodingupgrade](https://developers.google.com/maps/articles/geocodingupgrade)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:57:08.250

错误 610 表明 API 密钥无效（密钥无效或域错误）。

您可以在此处生成一个：[http ://code.google.com/apis/maps/signup.html](http://code.google.com/apis/maps/signup.html)

# iphone - 想在应用程序中添加应付消息服务

> ID：15364523
> 
> 赞同：0
> 
> 时间：2013-03-12T14:51:43.537
> 
> 标签：iphone, ios

我正在创建一个应用程序，它使用来自应用程序的一些数据发送消息。我想在我的应用程序中添加应付消息服务。就像前 100 条消息是免费的，而用户将为`$0.50`每条消息收费。[我从这个苹果文档](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)中读到了应用程序中的内容。但不确定它是否能实现我的目的。请有任何想法和建议。

而且我想在我的应用程序中使用其他消息服务，而不是 iPhone 原生消息。对此有任何建议。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T14:54:01.390

消息服务通常需要一个处理客户端的服务器。因此，如果您有服务器，则可以要求进行身份验证，并且可能需要请求帐户信息。据我所知，应用内购买只能让您选择激活部分应用，还可以解锁或扩展代码。

但顺便说一句，如果已经有免费的应用程序/服务，为什么还要付费？你的应用有什么优势？

编辑
似乎您可以提供虚拟物品（例如在游戏中）。考虑预付帐户的想法，也许它适合您；）

# c - C中CHAR *的位操作

> ID：15364528
> 
> 赞同：0
> 
> 时间：2013-03-12T14:51:51.533
> 
> 标签：c

参考这个线程：[Decode FOUR_BITS of a byte array (in C)](https://stackoverflow.com/questions/15359060/decode-four-bits-of-a-byte-in-a-byte-array-in-c/15359290?noredirect=1#comment21700340_15359290)

成员 idooo 给了我一个解决方案，在那里可以看到它涉及对 CHAR * 的位操作。当我尝试编译时，它给了我错误：**'>>'：非法，左操作数的类型为'unsigned char *'**

我正在为此寻找解决方案。提前致谢。

PS：我无法更改数据类型。代码片段在我正在执行操作的那个线程中给出。那里也解释了变量及其作用域。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:54:19.880

位操作在*取消引用*的指针上，其类型是`char`, not `char *`。所以，如果你有`char *ptr`，你的班次表达式应该是`*prt >> 4`，而不是`ptr >> 4`。

# asp.net-mvc - “LocalDB 实例注册表项中缺少“DataDirectory”注册表值”错误是什么意思？

> ID：15364542
> 
> 赞同：8
> 
> 时间：2013-03-12T14:52:22.560
> 
> 标签：asp.net-mvc, iis-7.5, localdb

我有一个使用 localdb 的 MVC4/ASP.Net 应用程序。一切“似乎”都能正常工作。但是，我的事件日志中出现了大量错误：

> LocalDB 实例注册表项中缺少“DataDirectory”注册表值：{BB3F4304-E7E9-4EE7-9A25-B46BFAA73FB4}
> 
> LocalDB 实例注册表项中缺少“DataDirectory”注册表值：{BB31321B-BEB9-465B-8C8E-DEF9C2C67FBE}

每次实例更改时。

错误的 XML 详细信息：

```
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="SQLLocalDB 11.0" /> 
    <EventID Qualifiers="35269">512</EventID> 
    <Level>2</Level> 
    <Task>0</Task> 
    <Keywords>0x80000000000000</Keywords> 
    <TimeCreated SystemTime="2013-03-12T14:12:43.000000000Z" /> 
    <EventRecordID>1080755</EventRecordID> 
    <Channel>Application</Channel> 
    <Computer>XXXXXX</Computer> 
    <Security /> 
  </System>
  <EventData>
    <Data>{BB07CF13-2ABD-4FD5-AB2B-467FF08F28E6}</Data> 
  </EventData>
</Event> 
```

连接字符串：

```
<add 
    name="DefaultConnection" 
    connectionString="Data Source=(localdb)\v11.0; Initial Catalog=WebMVCContext-20121205135209; Integrated Security=True; MultipleActiveResultSets=True; AttachDbFilename=|DataDirectory|WebMVCContext-20121205135209.mdf" 
    providerName="System.Data.SqlClient" /> 
```

再一次，它正在工作，一切都在连接，每次连接只需获得 10-20 个。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-13T14:31:15.057

我有同样的问题。这似乎是 Localdb 的一个错误。我通过删除注册表项解决了这个问题：

```
HKEY_USERS\.DEFAULT\Software\Microsoft\Microsoft SQL Server\UserInstances\[GUID_FROM_EVENT_LOG] 
```

# javascript - Bootstrap 2.3.1 - 带遥控器的模态第一次不加载，但在第一次之后加载

> ID：15364543
> 
> 赞同：0
> 
> 时间：2013-03-12T14:52:22.860
> 
> 标签：javascript, twitter-bootstrap

我有一个加载远程内容的引导模式。这在第一次单击链接时不起作用。模态出现，但未加载远程内容。我检查了日志，甚至没有进行远程调用。

如果我第二次或多次单击该链接，它会完美运行。我最初使用的是标准的 bootsrap 链接方法，但后来改为纯 javascript 希望获得更多控制权。链接点击功能现在是：

```
$(function() {
                 $(".modal-link").click(function(event) {
                     $('.modal-body').text('Loading content...');
                     var modal = new $.fn.modal.Constructor();
                     $('#myModal').modal({keyboard: true})
                                  .remote($(this).attr("href"))
                                  .show();

                 })
             }) 
```

它每次都被调用，模型每次都会出现，但它只在第一次之后才进行远程调用。远程调用是对同一个域/机器。（所有这些都在一个 grails 应用程序中。）

有任何想法吗？我不确定还能尝试什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T17:12:09.623

我从来没有弄清楚为什么 Bootstrap 没有正确加载它，但确实使用了以下解决方法：

```
$('.modal-body').text('Loading content...');
if (firstLoad) {
      $('#myModal .modal-body').load($(this).attr("href"))
      firstLoad = false;
 } 
```

boolean firstLoad 回退到 jquery 以仅在第一次加载时加载 div 内容。

# ruby - 如何在照片上传后显示复选框？

> ID：15364545
> 
> 赞同：0
> 
> 时间：2013-03-12T14:52:35.430
> 
> 标签：ruby, ruby-on-rails-3, carrierwave

对于那些熟悉 ruby​​gems 的人，我使用 CarrierWave 允许在我的应用程序上上传照片。

这是我在视图中使用的代码

```
Add a photo:
  <%= f.file_field :image %> 
```

How can I make a checkbox appear in my View along with some text above it only IF a photo is selected for upload?

这是完整的 post.html.erb 视图

```
<%= form_for @post, :html => {:multipart => true} do |f| %>
  <%= render 'shared/error_messages', object: @post %>
  <div class="field">
    <%= f.text_area :content, :cols => 5, :rows => 5 %>
  </div>
  Add a photo:<br>
  <%= f.file_field :image %>
  <br>
  <%= f.submit "Submit", class: "btn btn-large btn-primary" %>
<% end %> 
```

这是post模型（相关部分）

```
class Post < ActiveRecord::Base
  attr_accessible :content, :image
  belongs_to :user

  mount_uploader :image, ImageUploader
end 
```

和上传者模型

```
class ImageUploader < CarrierWave::Uploader::Base

  include CarrierWave::MiniMagick

  # Choose what kind of storage to use for this uploader:
  storage :file
  # storage :fog

  # This is a sensible default for uploaders that are meant to be mounted:
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end

  # Provide a default URL as a default if there hasn't been a file uploaded:
  # def default_url
  #   # For Rails 3.1+ asset pipeline compatibility:
  #   # asset_path("fallback/" + [version_name, "default.png"].compact.join('_'))
  #
  #   "/images/fallback/" + [version_name, "default.png"].compact.join('_')
  # end

  # Avoid using model.id or version_name here, see uploader/store.rb for details.
  def filename
     "#{secure_token(10)}.#{file.extension}" if original_filename.present?
   end

   def cache_dir
    "#{Rails.root}/tmp/uploads"
  end

protected
  def secure_token(length=16)
    var = :"@#{mounted_as}_secure_token"
    model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.hex(length/2))
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:08:38.637

因此，您可以使用检查图像是否被选中的条件，然后您可以将文本框与文本一起附加，如下所示：

```
if image.image_url  
 #your checkbox stuff and text stuff
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T18:21:01.523

每个帖子只存储一张照片，您需要将照片存储在另一个表中。

```
class Post < ActiveRecord::Base
 attr_accessible :content, :title
 has_many :images
end

class Image < ActiveRecord::Base
  attr_accessible :image, :image_cache, :post_id
  belongs_to :post
  mount_uploader :image, ImageUploader
end 
```

因此，您可以选择要与每个帖子关联的图片。在这里找到一个例子：[https ://github.com/kdironside/carrierwave-multi-file-upload](https://github.com/kdironside/carrierwave-multi-file-upload)

# ios - dispatch_async(dispatch_get_main_queue(), ^ ...什么情况下什么都不做

> ID：15364547
> 
> 赞同：2
> 
> 时间：2013-03-12T14:52:42.717
> 
> 标签：ios, nsurlconnection, objective-c-blocks

在完成例程中

```
[NSURLConnection sendAsynchronousRequest:request
                                   queue:queue
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) 
```

我打电话

```
dispatch_async(dispatch_get_main_queue(), ^
{
  NSLog(@"CALLING SUCCESS");
}); 
```

我有两个测试应用程序，一个可以正常工作，另一个不能。发生的情况是日志语句不执行。队列是用

```
queue = [[NSOperationQueue alloc] init]; 
```

让我发疯，它根本拒绝执行。在这两种情况下，我都在应用程序启动期间调用了它。我尝试将通话延迟 5 秒。无论我做什么，它都不会在一个应用程序中执行该块，而是在另一个应用程序中执行。如果我对在什么情况下 dispatch_async(dispatch_get_main_queue()... 可能会失败有一些线索，我也许能够辨别出差异。

请注意，在实际代码中，我正在调用一个我想在主线程上执行的块。我将测试用例简化为只调用 NSLog。

更新：不同之处在于此代码不适用于 iOS 5.1 模拟器，但适用于 6.0 或 6.1。为什么？

更新2：好的，如果我使用默认的 NSURLConnection 它确实有效，但如果我使用

```
self.connection = [[NSURLConnection alloc]initWithRequest:request delegate:self startImmediately:NO];
[self.connection setDelegateQueue:queue];
[self.connection start]; 
```

它在 iOS 5.1 中不起作用。开始认为这可能是 5.1 中带有 setDelegateQueue 的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:13:52.693

好的，真正的问题是这个。如果你使用 NSURLConnection 的类方法

```
+ (void)sendAsynchronousRequest:(NSURLRequest *)request
                      queue:(NSOperationQueue *)queue
          completionHandler:(void (^)(NSURLResponse *, NSData *, NSError *))handler 
```

在 iOS 5 或 6 下一切正常。

如果相反（像我一样）你实现自己的连接处理程序，即通过实现 NSURLConnectionDelegate 和 NSURLConnectionDataDelegate 来实现你自己的类方法（在我的情况下是为了避免缓存），并调用

```
self.connection = [[NSURLConnection alloc]initWithRequest:request delegate:self startImmediately:NO];
[self.connection setDelegateQueue:queue];
[self.connection start]; 
```

那么 dispatch_async 在 iOS 5.X 下将无法工作，但在 iOS 6.X 下可以工作。我认为Apple修复了一个错误。

# http - 需要实现一个mjpeg流

> ID：15364550
> 
> 赞同：1
> 
> 时间：2013-03-12T14:52:49.070
> 
> 标签：http, mjpeg, mongoose-web-server

我想使用 mongoose 轻量级 Web 服务器实现 MJPEG 流。有人可以给我一些关于我如何有效地做到这一点的指示吗？我已经有了需要流式传输的 jpeg 文件，并且我了解 MJPEG 概念。我只需要知道如何从协议级别实现 MJPEG 流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T21:27:29.917

几乎所有 ip 摄像机都实现的基于 http 的 mjpeg 是多部分 mime 消息的子类型。[http://en.wikipedia.org/wiki/MIME#Mixed-Replace](http://en.wikipedia.org/wiki/MIME#Mixed-Replace)

您必须将 cvloop() 替换为填充 jbuf 的实现。

```
#include <vector>
#include "mongoose.h"

#ifdef _WIN32 
#include <windows.h>
#define SLEEP(ms) Sleep(ms)
#endif
#ifdef __linux__ 
#define SLEEP(ms) usleep(ms*1000)
#endif

std::vector<unsigned char> jbuf;//fill this with a single jpeg image data

#include "opencv2/highgui/highgui.hpp"
void cvloop()
{
    cv::VideoCapture cap("c:/toprocess/frame_%004d.jpg");
    cv::Mat frame;
    for(;;)
    {
        cap>>frame;
        std::vector<unsigned char> buffer;
        std::vector<int> param(2);
        param[0]=CV_IMWRITE_JPEG_QUALITY;
        param[1]=40;
        imencode(".jpg",frame,buffer,param);
        jbuf.swap(buffer);
        SLEEP(50);
    }
}

// This function will be called by mongoose on every new request.
static int begin_request_handler(struct mg_connection *conn) {
    mg_printf(conn,
        "HTTP/1.1 200 OK\r\n"
        "Content-Type: multipart/x-mixed-replace;boundary=b\r\n"
        "Cache-Control: no-store\r\n"
        "Pragma: no-cache\r\n"
        "Connection: close\r\n"
        "\r\n");
    for(;;)
    {
        if( jbuf.size()<4 || 
            (jbuf[0]!=0xff && jbuf[0]!=0xd8) ||
            (jbuf[jbuf.size()-2]!=0xff && jbuf[jbuf.size()-1]!=0xd9))
        {
            SLEEP(10);
            continue;
        }
        mg_printf(conn,
            "--b\r\n"
            "Content-Type: image/jpeg\r\n"
            "Content-length: %d\r\n"
            "\r\n",jbuf.size());
        int ret=mg_write(conn,&jbuf[0], jbuf.size());
        if(ret==0||ret==-1) return 1;
        SLEEP(50);
    }
    return 1;
}

int main(void) {
    struct mg_context *ctx;
    struct mg_callbacks callbacks;

    // List of options. Last element must be NULL.
    const char *options[] = {"listening_ports", "8080",NULL};

    // Prepare callbacks structure. We have only one callback, the rest are NULL.
    memset(&callbacks, 0, sizeof(callbacks));
    callbacks.begin_request = begin_request_handler;

    // Start the web server.
    ctx = mg_start(&callbacks, NULL, options);
    cvloop();

    // Wait until user hits "enter". Server is running in separate thread.
    // Navigating to http://localhost:8080 will invoke begin_request_handler().
    getchar();

    // Stop the server.
    mg_stop(ctx);

    return 0;
} 
```

# php - PHP购物车显示问题

> ID：15364551
> 
> 赞同：0
> 
> 时间：2013-03-12T14:52:50.133
> 
> 标签：php, shopping-cart

在为我的网站创建购物车时，我为单个产品添加和删除功能。当我添加产品时，它会将其添加到表中的新行，而不是当前行。

这是添加和删除产品的代码：

```
function addproduct($product_id, $product_qty){

$q = "SELECT p_name FROM Product WHERE product_id = $product_id LIMIT 1";
$result = mysqli_query($_SESSION['conn'],$q);
$row = mysqli_fetch_array($result);
$product_name = $row['p_name']; //get the product name from product id because it is better to display name than id in the cart
if (isset($_SESSION['cart'])){  //if shopping cart is not empty
    $cart = $_SESSION['cart'];
    if (array_key_exists($product_name, $cart)){ //if the product exists, update                        quantity
        $cart[$product_name] += $product_qty;
    }
    else {  //otherwise, add new product-quantity pair to the array
        $cart[$product_name] = $product_qty;
    }
$_SESSION['cart'] = $cart; //write the updated array back to session variable
}
else { //if shopping cart is empty
    $cart = array($product_name=>$product_qty); //add product and quantity to the                           shopping cart
    $_SESSION['cart'] = $cart; //write the updated array back
}
mysqli_free_result($result);
}
function deleteproduct($product_id, $product_qty){
$q = "SELECT p_name FROM Product WHERE product_id = $product_id LIMIT 1";
$result = mysqli_query($_SESSION['conn'],$q);
$row = mysqli_fetch_array($result);
$product_name = $row['p_name'];
if (isset($_SESSION['cart'])){ //if shopping cart is not empty
    $cart = $_SESSION['cart'];
    if (array_key_exists($product_name, $cart)){ //if product exists, update quantity
        $cart[$product_name] -= $product_qty;
        if ($cart[$product_name] == 0){ //if the qty 0, delete key
            unset($cart[$product_name]);
        }
    }
    else { //exception
        echo "<p>Error1</p>";
    }
    $_SESSION['cart'] = $cart; //write array back to session variable
} else {
    echo "<p>Error2</p>";
}
mysqli_free_result($result);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:00:07.440

也许剪掉这个

```
if (isset($_SESSION['cart'])){  //if shopping cart is not empty
    $cart = $_SESSION['cart'];
    if (array_key_exists($product_name, $cart)){ //if the product exists, update                        quantity
        $cart[$product_name] += $product_qty;
    }
    else {  //otherwise, add new product-quantity pair to the array
        $cart[$product_name] = $product_qty;
    }
$_SESSION['cart'] = $cart; //write the updated array back to session variable
}
else { //if shopping cart is empty
    $cart = array($product_name=>$product_qty); //add product and quantity to the                           shopping cart
    $_SESSION['cart'] = $cart; //write the updated array back
} 
```

减少到三行，让我知道它是否仍然不起作用。

```
if (!isset($_SESSION['cart'])) $_SESSION['cart']=array();
if (!isset($_SESSION['cart'][$product_name])) $_SESSION['cart'][$product_name]=$product_qty;
else $_SESSION['cart'][$product_name]+=$product_qty; 
```

# c# - 这是一个很好地使用继承的例子吗？

> ID：15364552
> 
> 赞同：2
> 
> 时间：2013-03-12T14:52:51.703
> 
> 标签：c#, inheritance

我一直在阅读继承通常是糟糕的代码设计。尽管如此，我有时会从业务对象的 List 或 BindingList 继承。这是我可能使用的一个简单的业务对象：

```
public class RowType
{
    public string Name { get; set; }
    public double Sales { get; set; }
} 
```

以下是包含`RowType`s 集合的对象的两个选项：

```
//Option A: "Has-A" relationship
public class RowHolderType
{
    private readonly BindingList<RowType> _rows;
    public BindingList<RowType> Rows { get { return this._rows; } }
    public RowHolderType() { this._rows = new BindingList<RowType>(); }
}

//Option B: "Is-A" relationship
public class RowHolderType : BindingList<RowType>
{
    public RowHolderType() : base() { }
    public RowHolderType(IList<RowType> list) : base(list) { }
} 
```

我通常使用选项 B。我发现使用选项 B 时通常需要编写更少的代码。我通常使用这样的类来在 WPF 窗口中显示可编辑数据的列表。

使用选项 B 是否有一些隐藏的缺点？或者我可以继续愉快地扩展`BindingList<T>`s 吗？

编辑：添加一个例子。

我在评论中提到，有时当我想更好地控制`BindingList`可以发送的通知时，我可能会使用选项 B。我可能想表明我正在开始一批更新，然后再完成同一批更新。为此，我将继承 BindingList 并添加一些功能：

```
public class RowTypeHolder : BindingList<RowType>
{
    public event BeforeListChangedEventHandler BeforeListChanged;
    public delegate void BeforeListChangedEventHandler(RowTypeHolder sender, RowTypeHolderEventArgs e);

    public event AfterListChangedEventHandler AfterListChanged;
    public delegate void AfterListChangedEventHandler(RowTypeHolder sender, RowTypeHolderEventArgs e);

    public void OnBeforeListChanged(RowTypeHolderEventArgs.ChangeType change, string eventName)
    {
        if (this.BeforeListChanged != null)
            this.BeforeListChanged(this, new RowTypeHolderEventArgs(change, 0, eventName));
    }

    public void OnAfterListChanged(RowTypeHolderEventArgs.ChangeType change, int numChanges, string eventName)
    {
        if (this.AfterListChanged != null)
            this.AfterListChanged(this, new RowTypeHolderEventArgs(change, numChanges, eventName));
    }
} 
```

调用者负责发送`BeforeListChanged`和`AfterListChanged`通知。我还没有尝试过使用“Has-A”类型的关系，但我认为该代码会更丑陋。（请注意，我省略了`RowTypeHolderEventArgs`and的定义`RowTypeHolderEventArgs.ChangeType`。我认为这对于这个例子并不重要。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:58:34.850

如果没有更多上下文，我很难决定我更喜欢哪一个，我通常喜欢根据我对问题的心理模型来构建代码。

问自己一个问题：

**`RowHolderType`是**修辞**`BindingList<RowType>`意义上的吗？如果是，那么继承是 100% 合适的。**

# asp.net - 根据列表检查用户输入的代码

> ID：15364565
> 
> 赞同：0
> 
> 时间：2013-03-12T14:53:19.987
> 
> 标签：asp.net, regex, vb.net

我正在 MS Visual Studio 中编写一个 Vb.NET 文件，需要为皮肤癌的诊断代码编写一些正则表达式。下面是代码。我已经使用这个基本表达式介绍了第一批：

```
^([C43\d]|[C44\d]){4}$ 
```

但现在我需要将其扩展为涵盖不包含 0-9 的所有数字作为第四个字符的代码，例如 C510、C511、C512、C518、C519，因此不包括第四个中的 3、4、5、6、7位置，这就是我挣扎的地方。有人可以帮忙吗？谢谢你。

```
C430
C431
C432
C433
C434
C435
C436
C437
C438
C439
C440
C441
C442
C443
C444
C445
C446
C447
C448
C449
C510
C511
C512
C518
C519
C792
D030
D031
D032
D033
D034
D035
D036
D037
D039
D040
D041
D042
D043
D044
D045
D046
D047
D048
D049
D485 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:07:54.883

据我了解，第一个字符必须是“C”或“D”之一，第二个和第三个任何数字，第四个任何数字，不包括 3、4、5、6 或 7（即任何数字 0 ,1,2,8 或 9)。如果是这样，下面的正则表达式应该这样做：

```
^([CD]\d\d[01289])$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T14:56:56.567

如果您有所有代码的列表，您可以简单地从列表中创建一个正则表达式：

```
(C430|C431|C432|...|D047|D048|D049|D485) 
```

# android - Android 视图布局

> ID：15364568
> 
> 赞同：0
> 
> 时间：2013-03-12T14:53:37.597
> 
> 标签：android, android-layout

我正在尝试在我的 android 应用程序顶部创建一个栏，该栏有三个按钮和一个徽标，一个按钮在最左侧，徽标居中，两个按钮在右侧。我的问题是右侧的两个按钮重叠，如何让它们都在右侧但不堆叠？

这是我的视图的 XML 结构：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent" 
          android:layout_height="42px" 
          android:orientation="horizontal"
          android:background="@drawable/header_background">

    <RelativeLayout
         android:layout_width="fill_parent"
         android:layout_height="fill_parent" >

    <Button android:id="@+id/button_menu"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@drawable/menu_button"
        android:layout_gravity="left"
        android:layout_alignParentLeft="true" />

    <ImageView
            android:id="@+id/imageViewLogo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/logo_white" 
            android:layout_centerInParent="true"/>

    <Button android:id="@+id/button_camera"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@drawable/camera_button"
        android:layout_gravity="right"
        android:layout_alignParentRight="true" />

    <Button android:id="@+id/button_switch"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@drawable/two_up_button"
        android:layout_gravity="right"
        android:layout_alignParentRight="true" />

    </RelativeLayout>
</LinearLayout> 
```

任何建议都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T14:56:22.160

两者`button_switch`和`button_camera`都在父级内部对齐，因为明显的属性指出：`android:layout_alignParentRight="true"`

使用属性`layout_toLeftOf`或`layout_toRightOf`详细指定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T14:56:53.497

我认为您的第一个按钮 ( `button_camera`) 需要与`button_switch`using的右侧对齐`layout_toRightOf="@id/button_switch`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-12T15:01:33.883

只需要另一个RelativeLayout-

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent" 
          android:layout_height="42px" 
          android:orientation="horizontal"
          android:background="@drawable/header_background">

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

    <Button android:id="@+id/button_menu"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@drawable/menu_button"
        android:layout_gravity="left"
        android:layout_alignParentLeft="true" />

    <ImageView
            android:id="@+id/imageViewLogo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/bloom_logo_white" 
            android:layout_centerInParent="true"

            />

    <Button android:id="@+id/button_camera"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@drawable/camera_button"
        android:layout_gravity="right"
        android:layout_alignParentRight="true" />

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@+id/button_camera">

            <Button android:id="@+id/button_switch"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:text=""
       android:background="@drawable/two_up_button"
       android:layout_gravity="right"
       android:layout_alignParentRight="true" />
    </RelativeLayout>

</RelativeLayout>
</LinearLayout> 
```

# c - 有色碰撞 C SFML

> ID：15364578
> 
> 赞同：0
> 
> 时间：2013-03-12T14:54:06.087
> 
> 标签：c, sfml

我想知道是否可以使用 SFML 库在 C 中使用颜色设置冲突？因为我正在使用带有瓷砖的地图，我不知道它是否可以一起使用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T14:20:13.500

据我所知，您使用具有两种颜色的图像来定义碰撞（例如白色是可以通过的，黑色是被阻挡的）。并且您希望 SFML 能够识别它。正确的？`sf::Image`（如果您使用`sfImage_createFromFile`的`sfImage_getPixelsPtr`是 CSFML）可以读取图像文件并为您提供像素（颜色）数组。但 SFML 不处理碰撞，它是一个渲染库。碰撞必须是程序逻辑的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-07T15:37:59.057

最简单的方法就是像这样使用 sprite.setColor 函数

```
//Sets the sprite to purple
sprite.setColor(sf::Color(255,0,255)); 
```

这是文档 [http://www.sfml-dev.org/documentation/2.0/classsf_1_1Sprite.php#a14def44da6437bfea20c4df5e71aba4c](http://www.sfml-dev.org/documentation/2.0/classsf_1_1Sprite.php#a14def44da6437bfea20c4df5e71aba4c)这是 sf::Color 文档[http://www.sfml-dev.org/documentation/2.0/类f_1_1Color.php](http://www.sfml-dev.org/documentation/2.0/classsf_1_1Color.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-25T09:01:05.803

处理冲突必须是您**在代码中定义的**内容。如果您正在使用瓦片地图，它应该保留每个瓦片的值，定义它是哪种类型的单元格。

使用这些值，您可以在程序中工作并**分别进行绘图和逻辑**，但都基于瓦片地图信息。

一方面，您必须使用与图块值对应的颜色绘制图块。这个过程是为了绘制每一帧，所以你**不应该用复杂的逻辑来充电**（因为碰撞）

另一方面，您必须检查其他实体（玩家、射弹等）是否与瓦片发生碰撞，最好仅在需要时（例如，由事件调用，作为用户输入）

# java - JScrollPane 修改内容

> ID：15364581
> 
> 赞同：0
> 
> 时间：2013-03-12T14:54:08.270
> 
> 标签：java, swing, jscrollpane

我有一个相当简单的视图类，我正在构建它。我边走边测试，*所以代码远未完成*。但是，当我测试时，一切看起来都很好，直到我滚动。如果我通过单击滚动条上的开放区域一次滚动页面，一切都很好。如果我使用滚动箭头、拖动滚动条或使用鼠标滚轮，新显示的内容将完全被破坏。1.6.35 和 1.7.09 都会出现这种情况。当我单击并拖动作为 JTextField 的“日志行”时，我还注意到了重整。请告诉我我在这里做错了什么。代码应该按原样运行。

```
package com.mycompany.utility.logs;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTextField;
import javax.swing.JTextPane;
import javax.swing.ScrollPaneConstants;
import javax.swing.border.EmptyBorder;

/**
 * This class implements the log viewer view.
 */
public class LogViewer extends JFrame
{
    private static final long serialVersionUID = 1L;
    private static final Color TRANSPARENT = new Color(255, 255, 255, 0);
    private JPanel contentPane;

    /**
     * Launch the application.
     */
    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run()
            {
                try
                {
                    LogViewer frame = new LogViewer();
                    frame.setVisible(true);
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the view.
     */
    public LogViewer()
    {
        GridBagConstraints gridBagConstraints = null;
        int row = 0;

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 713, 684);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new BorderLayout(0, 0));
        setContentPane(contentPane);

        JPanel topPanel = new JPanel();
        contentPane.add(topPanel, BorderLayout.NORTH);
        GridBagLayout gbl_topPanel = new GridBagLayout();
        gbl_topPanel.columnWidths = new int[] { 0 };
        gbl_topPanel.rowHeights = new int[] { 0 };
        gbl_topPanel.columnWeights = new double[] { Double.MIN_VALUE };
        gbl_topPanel.rowWeights = new double[] { Double.MIN_VALUE };
        topPanel.setLayout(gbl_topPanel);

        JLabel titleLabel = new JLabel("Tattle Tail Log Viewer");
        titleLabel.setFont(new Font("Lucida Sans", Font.BOLD, 12));
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridx = 0;
        topPanel.add(titleLabel, gridBagConstraints);

        JPanel bottomPanel = new JPanel();
        contentPane.add(bottomPanel, BorderLayout.SOUTH);

        JSplitPane splitPane = new JSplitPane();
        splitPane.setResizeWeight(0.75);
        splitPane.setOneTouchExpandable(true);
        splitPane.setOrientation(JSplitPane.VERTICAL_SPLIT);
        contentPane.add(splitPane, BorderLayout.CENTER);

        JPanel scrollPanel = new JPanel();
        scrollPanel.setBackground(Color.WHITE);
        scrollPanel.setLayout(new GridBagLayout());

        JScrollPane scrollPane = new JScrollPane();
        scrollPane.setViewportView(scrollPanel);
        scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        splitPane.setLeftComponent(scrollPane);

        final JTextPane textPane = new JTextPane();
        splitPane.setRightComponent(textPane);
        textPane.setFont(new Font("Courier New", Font.PLAIN, 11));

        for (int i = 0; i < 25; i++)
        {
            addLogEntry(scrollPanel, textPane, row,
                    "2013-03-11 15:40:19,123 INFO  com.mycompany.business.logic.ImportantProcess",
                    "Something of which you need to be aware happened " + i + ".");
            row++;
        }

        JPanel fillPanel = new JPanel();
        fillPanel.setBackground(Color.LIGHT_GRAY);
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = row;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.weighty = 1D;
        gridBagConstraints.fill = GridBagConstraints.BOTH;
        scrollPanel.add(fillPanel, gridBagConstraints);
    }

    private void addLogEntry(final JPanel scrollPanel, final JTextPane textPane, final int row, final String logText,
            final String messageText)
    {
        GridBagConstraints gridBagConstraints = null;

        JPanel entryPanel = new JPanel();
        entryPanel.setBackground(TRANSPARENT);
        entryPanel.setLayout(new GridBagLayout());
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = row;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1D;
        gridBagConstraints.weighty = 0D;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        scrollPanel.add(entryPanel, gridBagConstraints);

        JPanel logLinePanel = new JPanel();
        logLinePanel.setBackground(TRANSPARENT);
        logLinePanel.setFocusable(true);
        logLinePanel.setLayout(new GridBagLayout());
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1D;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        entryPanel.add(logLinePanel, gridBagConstraints);

        JLabel logLineLevelLabel = new JLabel("  ");
        logLineLevelLabel.setOpaque(true);
        logLineLevelLabel.setBackground(new Color(0, 128, 0));
        logLineLevelLabel.setFont(new Font("Courier New", Font.BOLD, 11));
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        logLinePanel.add(logLineLevelLabel, gridBagConstraints);

        JTextField logLineText = new JTextField(logText);
        logLineText.setEditable(false);
        logLineText.setBackground(TRANSPARENT);
        logLineText.setBorder(null);
        logLineText.setFont(new Font("Courier New", Font.PLAIN, 11));
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1D;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        logLinePanel.add(logLineText, gridBagConstraints);

        JPanel messageLinePanel = new JPanel();
        messageLinePanel.setBackground(TRANSPARENT);
        messageLinePanel.setLayout(new GridBagLayout());
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1D;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        entryPanel.add(messageLinePanel, gridBagConstraints);

        JLabel hasMoreMessageLineLabel = new JLabel("+ ");
        hasMoreMessageLineLabel.setFont(new Font("Courier New", Font.BOLD, 11));
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        messageLinePanel.add(hasMoreMessageLineLabel, gridBagConstraints);

        JLabel messageLineLabel = new JLabel(messageText);
        messageLineLabel.setBackground(TRANSPARENT);
        messageLineLabel.setFocusable(true);
        messageLineLabel.setFont(new Font("Courier New", Font.PLAIN, 11));
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1D;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;
        messageLinePanel.add(messageLineLabel, gridBagConstraints);

        entryPanel.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseEntered(MouseEvent e)
            {
                final JPanel containerPanel = (JPanel) e.getComponent();
                final JPanel messagePanel = (JPanel) containerPanel.getComponent(1);
                final JLabel messageLabel = (JLabel) messagePanel.getComponent(1);
                String text = messageLabel.getText();
                textPane.setText(text);
            }

            @Override
            public void mouseExited(MouseEvent e)
            {
                textPane.setText("");
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:07:24.223

```
private static final Color TRANSPARENT = new Color(255, 255, 255, 0); 
```

我猜那是你的问题。使用透明颜色设置背景时要小心。请参阅[具有透明度的背景](http://tips4java.wordpress.com/2009/05/31/backgrounds-with-transparency/)以了解为什么这是一个问题。

在您的情况下（因为您使用的是完全透明），您可以使用：

```
setOpaque( false ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:58:28.670

人啊，长得真奇怪。

对于任何想了解更多信息的人：滚动文本面板时，滚动面板中的面板内容无法保持其完整性；部分字母行留在后面，而它们的原件向下滚动，使它看起来有点“融化”。换句话说，“修改”并不意味着修改文本，而是修改了构成图像的像素。

我会尝试在没有 GridBag 的滚动面板中制作面板。我对 GridBag 不是很熟悉，我觉得它很不愉快，而且到目前为止，我几乎不用它。但是你的内部面板的结构看起来很简单，你也不需要它：看起来你有一个左上角的图像，然后是一个文本行，然后可能是另一个图像，然后是另一行文本。制作两个 JPanel，每行一个，您可以使用 flowlayout 和水平方向并将图像和文本粘贴在那里，然后水平布局并将两个 JPanel 粘贴到一个面板中，现在您有了一个面板，您可以添加到滚动面板。

我不知道这是否能解决问题，但 GridBag 是您的代码中唯一看起来与我之前所做的事情不同但没有这种行为的东西。而且我只是对 GridBag 不够灵活，无法快速找出它可能出了什么问题。

# css - 在每个新行上从右侧自动缩进文本

> ID：15364583
> 
> 赞同：0
> 
> 时间：2013-03-12T14:54:11.140
> 
> 标签：css

[jsfiddle](http://jsfiddle.net/ny5Uy/)

```
<div class='outer'>
<a href="javascript:void(0)" onclick='ShowSmiley();' class='emojie'>
<img src="images/smiley.png" height="20px" width="20px"></a>
<div class="emoji-menu" id="emojiMenu" style="display:none;" >
  </div>
 <div contenteditable="true" id='MsgToSend' onkeypress='ClientOnTyping(event);'class='msgtosend'></div>
  <style>
  .msgtosend /* The message to send div */
  {
display:block;
border:1px solid Gray;

height:100px;
width:270px;
max-width:270px;          
overflow:auto;
word-wrap:break-word;

}
 .outer
{
position: relative;
width: 100%;
}
 .outer .emojie
{

padding-top: 0;
position: absolute;
top: 0;
right: 0;
border:none;
}
</style> 
```

我应该如何让我的可编辑 div 在每次插入新行时从右侧自动缩进？比方说 20 px

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:01:18.293

我可能不完全理解你的问题，但如果你想正确对齐你的文本，你可以使用 text-align 属性和 padding-right 将确保它与右边的距离

```
div
{
    background-color:Red;
    padding-right:20px;
    text-align:right;
} 
```

看看[JS Fiddle](http://jsfiddle.net/8jQ7P/1/)

编辑 ：

如果要从右到左插入文本，请使用方向属性

```
 direction:rtl; 
```

这是更新的代码[Update JS Fiddle](http://jsfiddle.net/ny5Uy/1/)

# jquery - 如果未选中/选择已使用 jQuery 输入数据，如何为每个元素添加跨度

> ID：15364589
> 
> 赞同：0
> 
> 时间：2013-03-12T14:54:23.717
> 
> 标签：jquery, forms, select, checkbox, error-handling

我有这个表格...

```
<form action="" method="post" id="register">
    <ol class="subproduct">
        <li>
            <input type="checkbox" name="extra2" value="Multidispositivo" />
            <p class="checkbox"></p>
                <h3>Multidispositivo <span class="price"><span>+2</span>€&lt;/span></h3>

            <p>Disfrute la conexión en hasta 3 dispositivos simultáneamente</p>
        </li>
        <li>
            <input type="checkbox" name="extra2" value="Multidispositivo" />
            <p class="checkbox"></p>
                <h3>Multidispositivo <span class="price"><span>+2</span>€&lt;/span></h3>

            <p>Disfrute la conexión en hasta 3 dispositivos simultáneamente</p>
        </li>
        <li>
            <input type="checkbox" name="extra2" value="15 min extra" />
            <p class="checkbox"></p>
                <h3>15 min extra <span class="price"><span>+4</span>,10€&lt;/span></h3>

            <p>Además podrá usar correo, redes sociales, VPN y tendrá más velocidad de conexión</p>
        </li>
        <li>
            <input type="checkbox" name="extra2" value="Multidispositivo" />
            <p class="checkbox"></p>
                <h3>Multidispositivo <span class="price"><span>+2</span>€&lt;/span></h3>

            <p>Disfrute la conexión en hasta 3 dispositivos simultáneamente</p>
        </li>
    </ol>
    <div class="data">
            <h3>Datos de acceso</h3>

        <p class="email-login">
            <label for="email-login">Su correo electrónico</label>
            <input id="email-login" name="email-login" type="text" placeholder="Su correo electrónico" />
        </p>
        <p class="password-login">
            <label for="password-login">Elija una contraseña</label>
            <input id="password-login" name="password-login" type="text" placeholder="Elija una contraseña" />
        </p>
            <h3>Datos personales</h3>

        <p>
            <label for="name">Nombre y apellidos</label>
            <input id="name" name="name" type="text" placeholder="Nombre y apellidos" />
        </p>
        <div class="data1">
            <p class="gender">  <span class="female">
                    <label for="gender-female">Mujer</label>
                    <input id="gender-female" name="gender-female" type="radio" value="Mujer" />
                </span>
    <span class="male">
                    <label for="gender-male">Hombre</label>
                    <input id="gender-male" name="gender-male" type="radio" value="Hombre" />
                </span>

            </p>
            <p class="age select">  <span>Edad</span>

                <select></select>
            </p>
        </div>
        <div class="data2">
            <p class="country select">  <span>País</span>

                <select></select>
            </p>
            <p class="postal">
                <label for="postalcode">Código postal</label>
                <input id="postalcode" name="postalcode" type="text" value="" />
            </p>
        </div>
        <div class="terms">
            <input type="checkbox" name="terms" value="Acepto las condiciones" />
            <p class="checkbox"></p>
            <p class="termsconds">Acepto las condiciones
                <a title="Términos y condiciones" href="static.html">?</a>
            </p>
        </div>
        <p class="submit">  <span class="button">Conectar</span>

            <input id="register-submit" type="submit" value="Conectar" />
        </p>
    </div>
</form> 
```

如果每个人都没有输入/选择/复选框，我需要给出一个错误....

目前我有这个

```
$(document).ready(function () {
    $('#register').submit(function () {
        $("#email-login").each(function () {
            if ($(this).val() === "") {
                $("#email-login").after('<span class="register-error email-error">email</span>');
            }
        });
        $("#password-login").each(function () {
            if ($(this).val() === "") {
                $("#password-login").after('<span class="register-error password-error">password</span>');
            }
        });
        $("#name").each(function () {
            if ($(this).val() === "") {
                $("#name").after('<span class="register-error name-error">name</span>');
            }
        });

        if ($("#gender-female").is(':checked')) {
            //$(this).prop('checked',false);
            $("#gender-male").after('<span class="register-error female-error"></span>');
            $("#gender-female").hide().after();
        } else {
            //$(this).prop('checked',true);
            $("#gender-female").after('<span class="register-error female-error"></span>');
            $("#gender-male").hide().after();
        }

        $(".data select").each(function () {
            if ($(this).val() === "") {
                $(".data select").after('<span class="register-error select1-error">age</span>');
            }
        });
        $(".data2 select").each(function () {
            if ($(this).val() === "") {
                $(".data2 select").after('<span class="register-error select2-error">plage</span>');
            }
        });
        $("#postalcode").each(function () {
            if ($(this).val() === "") {
                $("#postalcode").after('<span class="register-error postalcode-error">postcode</span>');
            }
        });
        $(".terms checkbox").each(function () {
            if ($(this).val() === "") {
                $(".terms checkbox").after('<span class="register-error select2-error">agree</span>');
            }
        });
        return false;

    });

});

$(document).on('click', '.register-error', function () {
    $(this).remove();
    return false;
}); 
```

它的输入字段很好，但我不能让性别成为一个或者在点击时隐藏错误，我不知道如何让 jquery 来查找正在填写的内容？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:23:03.907

```
// Validate on submit
$('form').submit(function() { return validateForm(); });

// validate on change
$(':input').change(function() { validateForm(); });

var validateForm = function() {
    var validates = true;

    $(':input') // Find all form elements
        .not('input[type="submit"]') // Exclude the submit button
        .each(function(i) {
            var $this = $(this), // ~cache the jQuery object
                selected = $this.is(':checkbox') ? this.checked : !!$this.val(); // Check selected checkbox or a required value

            // TODO: Check for radio grouped buttons

            console.log(i, selected); // DEBUG

            // Toggle "invalid" class
            $this.toggleClass('invalid', !selected);

            if (!selected) validates = false;
        });

    console.log('Form validates', validates); // DEBUG
    return validates;
}; 
```

[http://jsfiddle.net/S2jJ3/](http://jsfiddle.net/S2jJ3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:08:02.793

首先，您没有以正确的方式使用单选按钮。name 属性必须相同，否则它们不会被分组。

示例：[http ://www.w3schools.com/html/tryit.asp?filename=tryhtml_radio](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_radio)

```
<form action="">
<input type="radio" name="sex" value="male">Male<br>
<input type="radio" name="sex" value="female">Female
</form> 
```

然后你可以这样做来获取检查的值。

```
var value = $("input[@name=sex]:checked").val(); 
```

如果`value`未定义，则不检查它们。

# sql-server - 比较两个数据库之间的列排序规则

> ID：15364594
> 
> 赞同：1
> 
> 时间：2013-03-12T14:54:40.370
> 
> 标签：sql-server, tsql

我有一个生产数据库和一个开发数据库，​​它们在某些表中的一个或多个列上显然有不同的排序规则。有没有一种方法可以编写脚本来返回哪些不同的列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:00:04.557

[Red-Gate SQL Compare](http://www.red-gate.com/products/sql-development/sql-compare/)将突出显示排序规则的差异。还有很多其他不同成本和质量的替代工具，[我在这里写过博客](http://madelinebertrand.com/2012/04/20/re-blog-the-cost-of-reinventing-the-wheel/)，但我可以保证 Red-Gate 工具的质量。如果这是一次性的，您可以使用试用版。

也就是说，如果数据库在同一台服务器上，或者其中一台服务器与另一台服务器有链接服务器，则可以执行以下操作：

```
SELECT DevObject  = do.name, DevColumn  = dc.name, DevColl  = dc.collation_name,
       ProdObject = po.name, ProdColumn = pc.name, ProdColl = pc.collation_name
FROM devdb.sys.objects AS do
INNER JOIN devdb.sys.schemas AS ds
  ON do.[schema_id] = ds.[schema_id]
INNER JOIN devdb.sys.columns AS dc
  ON do.[object_id] = dc.[object_id]
INNER JOIN productiondb.sys.objects AS po
  ON do.name = po.name
INNER JOIN productiondb.sys.schemas AS ps
  ON ds.name = ps.name
  AND po.[schema_id] = ps.[schema_id]
INNER JOIN productiondb.sys.columns AS pc
  ON dc.name = pc.name
  AND po.[object_id] = pc.[object_id]
WHERE
  dc.collation_name <> pc.collation_name
  -- AND do.name IN (N't1', N't2', N't3', ...) -- filter certain table names
; 
```

如果它们在不同的服务器上，您可能需要在一个服务器上创建链接服务器，然后将引用适当地更改为 4 部分名称`linkedservername.devdb.sys.objects`等。

# inheritance - 序列图中将如何描述继承？

> ID：15364595
> 
> 赞同：5
> 
> 时间：2013-03-12T14:54:42.730
> 
> 标签：inheritance, sequence-diagram

假设 A 类的方法 m 调用 B 类的方法 n，但是 B 类的源代码不包含 n，因为 n 是从 B 的超类之一继承而来的。

序列图看起来如何？

A和B之间会通过方法n进行消息交互还是通过方法n与A和B的超类进行消息交互

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:59:27.100

如果您要尊重封装原则，则交互纯粹是在`A`and之间`B`。的实现使用继承这一事实`B`与编写的代码无关`A`- 它唯一的世界观是它调用方法 on `B`。

您可以安全地更改实现`B`而不影响`A`. 这是以这种方式绘制交互图的另一个原因。

# php - Modx revo 检查成员组返回一个数组，如何将其转换为字符串以用于查询？

> ID：15364596
> 
> 赞同：0
> 
> 时间：2013-03-12T14:54:43.203
> 
> 标签：php, arrays, modx

我正在 modx 中开发一个自定义组件，客户要求通过资源组 ID 搜索它。我使用以下代码提取了资源组 ID 的片段：

```
// Check if user is logged in and get user group 
$user = (!empty($userId)) ? $modx->getObject('modUser', $userId) : $modx->user;

if (is_object($user)) {
    /*
    * modUser Groups
    */
    $group = print_r($user->getUserGroups(), true);
    $modx->toPlaceHolder('user.groups', $group);

} 
```

但是 $group 作为数组返回，所以我不能在查询中使用它：

```
Array ( [0] => 8 ) 
```

我试过这样称呼它：return $group[0];

但这只是转储第一个字母'A'

基本上我只想将数组中的值放入一个变量中，然后在我的搜索查询中使用它：

```
$query->where(array('accNumber:LIKE' => "%$accNo%"));
$query->andCondition(array('accName:LIKE' => "%$accName%"));
$query->andCondition(array('saleProperty:LIKE' => "%$saleProperty%"));
$query->andCondition(array('clientNumber' => "$group")); 
```

我是否认为我需要将数组的内容转换为字符串才能使用它们？对不起，如果这个问题是菜鸟，但我是菜鸟！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:12:47.593

正如已经建议的那样，删除`print_r()`所以 $groups 将包含一个数组。

```
$group = $user->getUserGroups(); 
```

`andCondition()`然后按如下方式调整您的最终结果（`:IN`需要一个数组）：

```
$query->where(array('accNumber:LIKE' => "%$accNo%"));
$query->andCondition(array('accName:LIKE' => "%$accName%"));
$query->andCondition(array('saleProperty:LIKE' => "%$saleProperty%"));
$query->andCondition(array('clientNumber:IN' => $group)); 
```

[http://rtfm.modx.com/display/xPDO20/xPDOQuery.where](http://rtfm.modx.com/display/xPDO20/xPDOQuery.where)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:17:16.453

只需删除`print_r`-> `$group = $user->getUserGroups()`，然后重试 `return $group[0];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:18:52.570

是的 - 您必须对其进行转换，但它会返回一个数组，因为任何给定的用户都可以属于多个组，如果您的客户决定更改他们管理用户的方式，您可能会提前计划该组。

# c# - PDFCreator的程序控制

> ID：15364606
> 
> 赞同：1
> 
> 时间：2013-03-12T14:55:06.863
> 
> 标签：c#, pdf, outlook, msg

我想以`Outlook .msg`编程方式将文件打印为 PDF。由于我无法在 Outlook 中设置`ActivePrinter`使用`C# AddIn`，因此我正在搜索是否有任何方法可以使用`PDFCreator`.

我发现，您可以`PDFCreator`使用`/PF<filename`> 选项调用，它会使用其默认启动器将指定的文件打印为 PDF。所以我在`.msg`文件上尝试了这个，它可以完美地打印它们，但是用户必须与`PDFCreator`GUI 交互来选择保存位置和其他一些东西......

那么，有什么方法、命令或脚本可以用来以编程方式将`.msg`文件转换为 PDF吗？`PDFCreator``without user input at all`

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-13T11:20:54.627

PDFCreator 实现了 COM 对象，您可以使用它。它（pdfcreator）附带使用示例，包括 VB 和 C# 示例。

# algorithm - 给定一个随机顺序的整数数组，您必须找到最小交换次数才能将其转换为循环排序数组

> ID：15364607
> 
> 赞同：10
> 
> 时间：2013-03-12T14:55:06.947
> 
> 标签：algorithm, data-structures, dynamic-programming, bubble-sort

如果数组以随机顺序给出，则必须输出转换为循环排序数组所需的最小交换次数。

例如，给定的数组是 3 5 4 2 1

所以第一次交换将是 5<-->4 结果：3 4 5 2 1 第二次交换将是 2<-->1 结果：3 4 5 1 2（最终）

输出：2

我无法理解这个问题背后的逻辑。

添加更多： **只能在相邻元素之间交换，数字在 1 到 N 之间**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:26:40.637

好吧，不知道它是否是可用的最佳算法，但我可以想到一个 O(n^2) 解决方案：

首先，忽略循环数组的可能性。让我们解决一个更简单的问题：对数组进行排序的最小交换次数是多少。

在这里要小心，因为这与排序算法无关。基于比较的排序算法的最坏情况至少为`O(n log n)`. 在这个问题中，您需要的最大交换次数是`n`.

为什么？因为它是您可以实现的最大[排列循环大小。](http://mathworld.wolfram.com/PermutationCycle.html)您需要的最小交换次数恰好是排列周期大小减一。我的意思是您可以将数组的任何排列表示为排列循环，例如：

`3 2 1 4 5`->`(2)(4)(5)(1 3)`

对于大小为 1 的排列循环，您不需要任何交换。对于大小为 2 的置换循环，您恰好需要 1 个交换。这缩放为：

`2 3 4 5 1`->`(1 2 3 4 5)`

忽略这个数组已经是循环排序的，这个数组完全乱了。要正常排序，我需要 4 次交换，基本上将 1 移动到正常位置。

计算排列周期非常简单，只需将数字跟踪到数组排序后的位置即可。使用前面的示例

`3 2 1 4 5`

*   开始于`A[0]`;
*   因为`A[0]==3`, 和 3 将是排序数组中的第三个元素，所以跟随到第三个位置；
*   因为`A[2]==1`, 和 1 将是...，因此排在第 1 位。因为我们已经在**这里了，所以我们有一个大小为 2 的循环**；

*   在下一个未访问的位置重新开始 (1)

*   `A[1]==2`处于正确的位置，所以我们不需要做任何事情，**这里我们有一个大小为 1 的循环**。

*   等等……

这个算法是 O(n)，但是由于我们需要对从每个可能位置开始的数组执行此操作（因为它是圆形的），所以我们会执行 n 次，所以整个算法是 O(n^2)。

**更新; 一些python代码来显示我的算法：**

```
def offset_swaps(A, S, offset):
    visited = [False]*len(A)
    swaps = 0

    for i in xrange(len(A)):
        if visited[i]: continue

        cycle, current = 0, i
        while not visited[current]:
            cycle += 1
            visited[current] = True
            current = (S[A[current]] + offset) % len(A)

        swaps += cycle - 1

    return swaps       

def number_of_swaps(A):
    S = {x:i for i,x in enumerate(sorted(A))}
    min_swaps = len(A)
    for i in xrange(len(A)):
        min_swaps = min(min_swaps, offset_swaps(A, S, i))
    return min_swaps

print number_of_swaps((3, 5, 4, 2, 1)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:23:04.437

我认为这里的方法应该是 - 将所有数字排序到一个辅助数组中。然后对于每个循环移位计算使原始数组到该循环移位所需的交换次数。选择其中最小的。

要找到使数组 A 到数组 B 所需的最小交换次数，只需计算交换值的数量（即值 a 在 A 中值 b 的左侧，但在数组 B 中反之亦然）。这个问题等同于计算给定数组中的倒数，并且可以使用修改后的归并排序再次解决`O(n*log(n))`。

我的方法的复杂性是`O(n^2*log(n))`（因为您对大小为 n 的数组的所有循环移位进行合并排序）。

我想不出更快的解决方案来解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:52:18.427

假设：

1.  数组元素是整数 1 到 N。

脚步：

1.  分配长度为 N 的第二个（直方图）数组 H。
2.  在通过初始数组 A 的单次传递中，对于每个索引 i 递增 H[ (A[i] - i) % N]
3.  在单次通过 H 中，识别 H 中具有最大计数的元素 R
4.  清除 H。
5.  确定原始阵列中在 R 旋转下的轨道数。（通过 H 向前步进直到 H[i]=0，然后在旋转 R 下步进 A[i] 是其成员的轨道）设置 H [i]=1 对于轨道的每个成员，并重复直到元素 H[N-1] 已被处理（计算轨道的数量）。这也是 O(N)，因为 A 的每个元素只被访问一次。
6.  所需的交换次数 = N - 轨道。

这是 O(N)。

更新：我已经更新了算法以考虑多个轨道。在处理每个轨道时，最终交换会放置两个元素，而不仅仅是 1。

我怀疑轨道的数量在任何旋转下都是不变的，这将大大简化算法但不会影响它的复杂性，它保持在 O(N)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-16T07:40:58.893

```
def number_of_swaps(A):
    l=len(A)
    if l < 2:
        return 0
    S1={x:i for i,x in enumerate(A)}
    pos_of_0=S1[0]
    pos_of_N=S1[l-1]
    if pos_of_0 > 0:
        if pos_of_N != (l-1):
            if pos_of_N < pos_of_0:
                n=(pos_of_0+(l-1)-pos_of_N-1)
            else:
                    n=(pos_of_0+(l-1)-pos_of_N)
        else:
            n=(pos_of_0)
    else :
        n=(l-pos_of_N-1)
    A.remove(0)
    A.remove(l-1)
    B=[x-1 for x in A ]
    return n+number_of_swaps(B)

def min_number_of_swaps(A):
    B=sorted(A)
    swaps=[]
    for i in range(len(A)):
        if i == 0:
            C=B
        else:
            C=B[-i:]+B[0:len(A)-i]

        S = {x:i for i,x in enumerate(C)}
        D=[S[i] for i in A]
        swaps.append(number_of_swaps(D))
    return min(swaps) 
```

打印 min_number_of_swaps([8,5,7,1,2,4,3,6])

7

上面的代码是解决问题复杂度 O(N^3) 的递归方法

代码已被编辑为仅打印最小交换次数。

# java - 向警报对话框添加第三个按钮会使应用程序崩溃

> ID：15364608
> 
> 赞同：1
> 
> 时间：2013-03-12T14:55:11.487
> 
> 标签：java, android, eclipse, android-alertdialog

我创建了一个布局，单击第一个按钮会触发一个带有两个按钮的警报对话框。当我尝试添加第三个按钮时 - 整个应用程序崩溃，我不知道为什么。（我已经包含了我的源代码和 logcat - 希望它会有所帮助！）我知道我忽略了一些简单的东西 - 但是任何识别问题的帮助将不胜感激。（在它开始崩溃之前添加的唯一代码行是：

```
 .setNeutralButton("Cancel", this) 
```

...如果您删除上面的行 - 一切正常。

* * *

## 爪哇

```
package com.example.linkingmanager;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.content.Intent;

public class AppActivity extends Activity {

final Context context = this;
private Button button;
@Override
public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);
setContentView(R.layout.main);

button = (Button) findViewById(R.id.button1);

// add button listener
button.setOnClickListener(new OnClickListener() {

@Override
public void onClick(View arg0) {

    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
        context);

    // set title
    alertDialogBuilder.setTitle("Settings Menu");

    // set dialog message
    alertDialogBuilder
        .setMessage("Link or Delete?")
        .setCancelable(false)
        .setNeutralButton("Cancel", this)
        .setPositiveButton("Link",new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog,int id) {
        //start new activity

        Intent intentApp2Activity = new Intent(AppActivity.this, User1.class);
        startActivity(intentApp2Activity);

        // if this button is clicked, close
        // current activity
        AppActivity.this.finish();
    }
  })
        .setNegativeButton("Delete",new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
                // if this button is clicked, just close
                // the dialog box and do nothing
                dialog.cancel();
            }
        });

        // create alert dialog
        AlertDialog alertDialog = alertDialogBuilder.create();

        // show it
        alertDialog.show();
    }
}); 
}} 
```

* * *

## XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/linearLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/link_devices"
android:orientation="vertical" >

<TextView android:textAppearance="?android:textAppearanceLarge" android:id="@+id/textView1"      android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="" />
<Button android:id="@+id/button1" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Core Device 1" android:onClick="onPopupBtClick" />
<Button android:id="@+id/Button2" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Core Device 2" />
<Button android:id="@+id/Button3" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Core Device 3" />
</LinearLayout> 
```

* * *

## 日志猫

```
03-12 14:51:41.037: E/Trace(1425): error opening trace file: No such file or directory (2)
03-12 14:51:41.717: D/dalvikvm(1425): GC_FOR_ALLOC freed 61K, 8% free 2467K/2660K, paused 48ms, total 52ms
03-12 14:51:41.817: I/dalvikvm-heap(1425): Grow heap (frag case) to 6.049MB for 3686416-byte allocation
03-12 14:51:41.877: D/dalvikvm(1425): GC_FOR_ALLOC freed 2K, 4% free 6065K/6264K, paused 59ms, total 59ms
03-12 14:51:41.967: D/dalvikvm(1425): GC_CONCURRENT freed <1K, 4% free 6064K/6264K, paused 7ms+16ms, total 89ms
03-12 14:51:43.258: D/libEGL(1425): loaded /system/lib/egl/libEGL_emulation.so
03-12 14:51:43.268: D/(1425): HostConnection::get() New Host Connection established 0x2a1825a8, tid 1425
03-12 14:51:43.340: D/libEGL(1425): loaded /system/lib/egl/libGLESv1_CM_emulation.so
03-12 14:51:43.428: D/libEGL(1425): loaded /system/lib/egl/libGLESv2_emulation.so
03-12 14:51:43.557: W/EGL_emulation(1425): eglSurfaceAttrib not implemented
03-12 14:51:43.577: D/OpenGLRenderer(1425): Enabling debug mode 0
03-12 14:51:45.047: D/dalvikvm(1425): GC_FOR_ALLOC freed 12K, 3% free 6125K/6268K, paused 72ms, total 80ms
03-12 14:51:45.137: I/dalvikvm-heap(1425): Grow heap (frag case) to 9.623MB for 3686416-byte allocation
03-12 14:51:45.347: D/dalvikvm(1425): GC_CONCURRENT freed 2K, 2% free 9722K/9872K, paused 70ms+23ms, total 193ms
03-12 14:51:48.188: W/EGL_emulation(1425): eglSurfaceAttrib not implemented
03-12 14:52:51.677: D/AndroidRuntime(1425): Shutting down VM
03-12 14:52:51.677: W/dalvikvm(1425): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
03-12 14:52:51.772: E/AndroidRuntime(1425): FATAL EXCEPTION: main
03-12 14:52:51.772: E/AndroidRuntime(1425): java.lang.Error: Unresolved compilation problem: 
03-12 14:52:51.772: E/AndroidRuntime(1425):     The method setNeutralButton(int, DialogInterface.OnClickListener)   in the type AlertDialog.Builder is not applicable for the arguments (String, new View.OnClickListener(){})
03-12 14:52:51.772: E/AndroidRuntime(1425):     at   com.example.linkingmanager.AppActivity$1.onClick(AppActivity.java:41)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.view.View.performClick(View.java:4204)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.view.View$PerformClick.run(View.java:17355)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.os.Handler.handleCallback(Handler.java:725)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.os.Looper.loop(Looper.java:137)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at android.app.ActivityThread.main(ActivityThread.java:5041)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at java.lang.reflect.Method.invokeNative(Native Method)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at java.lang.reflect.Method.invoke(Method.java:511)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at   com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-12 14:52:51.772: E/AndroidRuntime(1425):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:01:55.333

你错了`OnClickListener`。它需要是一个`DialogInterface.OnClickListener`. 通过使用 传递当前 Object 实例`this`，您传递了`View.OnClickListener`与 不同的a `DialogInterface.OnClickListener`。改变

```
 .setNeutralButton("Cancel", this) 
```

到

```
 .setNeutralButton("Cancel", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog,int id) {
            //your implementation here
    }
  }) 
```

# sql - excel 2010 vba。sql查询列'like' vlookup

> ID：15364609
> 
> 赞同：1
> 
> 时间：2013-03-12T14:55:12.193
> 
> 标签：sql, ms-access, excel, excel-2010, vba

我有一个“Filename.accdb”（2010）文件，我与 Excel 的 VBA 建立了连接。

假设在文件中我有一个 TableA：

```
Column1 Column2 Worker
------- ------- -------
Text1   Text2   15
Text3   Text4   4
...
Text5   Text6   20 
```

和一个表B：

```
ID      Name
------- -------
1       Name1
4       Name4
15      Name15
...
20      Name20 
```

我能够将这些表导入工作表，但我想要实现的是：

所需的查询结果（我不想要整个 TableA）：

```
Column1 Worker
------- -------
Text1   Name15
Text3   Name4
...
Text5   Name20 
```

目前，我分别导入两个表，然后将“名称”列的值写入“工人”列。我通过 for 循环和函数 Vlookup(...) 实现了这一点。它速度快而且效果很好，所以我的问题是什么？

好吧，它会生成大量代码，我相信它一定可以通过 sql 查询来实现。另外，我想我会从中学到很多东西，因为我对 sql 还是很陌生。

到目前为止，这是我的字符串...

```
sql = "SELECT TableA.Column1, TableA.Worker, TableB.Name " & _
      "FROM TableA " & _
      "LEFT JOIN TableB " & _
      "ON TableB.ID = TableA.Worker" 
```

它不起作用并抛出“......无法在多个字段上执行连接错误......”我在互联网上找不到适合我的解决方案。

有没有人看到问题？我究竟做错了什么？

预先感谢 干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:57:27.940

TableB.ID 是一个数字列，您想要从描述中获得的列是名称：

```
sql = "SELECT TableA.Column1, TableA.Worker, TableB.Name " & _
      "FROM TableA " & _
      "LEFT JOIN TableB " & _
      "ON TableB.Name = TableA.Worker" 
```

请注意，名称不是列名的好选择。在 MS Access 中测试您的查询总是明智的，查询设计窗口是一个很好的起点。

# c++ - 如何在没有数学函数（arctan）的情况下计算点和org（0,0）之间的快速路径角度（最接近八个提供值之一）？

> ID：15364619
> 
> 赞同：2
> 
> 时间：2013-03-12T14:55:30.253
> 
> 标签：c++, algorithm, math, mathematical-optimization

如何在没有数学函数（arctan）的情况下计算点和org（0,0）之间的快速路径角度（最接近八个提供值之一）？我将 xy 坐标系分为 8 段（0、45、90、135、180、225、270、315），我需要找到点和 org 之间的角度（不准确，只是上面八的最接近值）而不重数学函数。我可以找到喜欢

```
std::pair<float,float> point;
float angle =arctan(point.second/point.first);
int index =static_cast<int>( (angle+22.5)/45); 
```

然后按索引从数组中读取。（我添加了 22.5 度，因为`[-22.5, 22.5)=>0, [22.5,67.5)=>45,[67.5,112.5)=>90...`）有更快的方法，任何想法（执行时间非常重要）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T15:07:44.737

给定一个`(a,b)`带有和的点`a<b`，它是更接近 45 度还是 0 度？`a>=0``b>=0`

嗯，`tan(theta) = opposite/adjacent`，并且在 0 度到 45 度的范围内，tan 是单调递增的。

`tan(22.5 degrees) =~ 207107/500000`. 所以如果`a/b > 207107/500000`，最近的角度是 45 度。如果`a/b < 207107/500000`，最接近的角度是`0`度。我们甚至可以在没有浮点数学的情况下通过说 来做到这一点`500000*a < 207107*b`。

对于任意点`(a,b)`，我们可以通过 a 和 b 上的符号找出它在哪个象限。我们可以（通过否定）将问题旋转到正-正象限，然后在结果角度上反转该旋转（这是一个非常简单的映射）。

`(a,b)`对于正-正象限中的任意一个，如果`a>b`只是将a和b颠倒，如上求解，“接近0度”对应“接近90度”。

上面的一些内容过于分支，但您应该能够将这些分支转换为整数操作并以数组访问结束。

现在，请注意，在某些系统上，trig 函数内在函数可以非常快，比一堆无分支整数操作和数组查找快得多。你的第一步应该是看看你是否可以用`arctan`更快的`arctan`.

```
bool neg_a = a<0;
bool neg_b = b<0;
a *= (1-2*neg_a);
b *= (1-2*neg_b);
bool near_0 = 500000*a<207107*b; // a/b < 207107/500000
bool near_90 = 207107*a>500000*b; // a/b > 500000/207107
bool near_45 = !near_0 & !near_90;
// 3 CW 2     1
//   -+ | ++
//  2-4 | 0-2 CCW
//4 ----+---- 0
//CCW-- | +- CW
//  4-6 | 6-8
// 5    6     7

// 0 1 or 2
int index = near_45 + 2*near_90;
// negating a or b reverses angle
index *= (1-2*neg_a);
index *= (1-2*neg_b);
// base is 4 if a is negative:
index += 4*(neg_a);
// base is 8 if b is negative, and a is not negative:
index += 8*(neg_b&!neg_a);
index &= 7;

return index; 
```

这很荒谬，但没有分支。也没有调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:13:40.687

您可以通过将其射线的梯度与 22.5、67.5 度等处的八分圆边界的梯度进行比较来计算该点所在的八分圆。所以：

```
static const float borders[] = { tan(-3 * PI / 8), tan(-PI / 8), tan(PI / 8), tan(3 * PI / 8) };
static const int angles[] = { 270, 315, 0, 45, 90, 135, 180, 225 };
float gradient = y / x;
int i = std::distance(borders, std::lower_bound(std::begin(borders), std::end(borders), gradient)) + (x < 0 ? 4 : 0);
int angle = angles[i]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:40:36.270

This solution is based on maximizing cos(theta-theta_i) where theta_i is 0,45,90,...,315 degrees. I used the angle-difference identity cos(a-b)=cos(a)cos(b)-sin(a)sin(b) and worked with x=r*cos(a) and y=r*sin(a) to simplify the different expressions, so no actual trig functions have to be used:

```
int getIndex_simple(float x, float y){

  float rCosThetaMinusThetaI[8];
  rCosThetaMinusThetaI[0]=x;
  rCosThetaMinusThetaI[1]=(x+y)*M_SQRT1_2;
  rCosThetaMinusThetaI[2]=y;
  rCosThetaMinusThetaI[3]=(y-x)*M_SQRT1_2;
  rCosThetaMinusThetaI[4]=-x;
  rCosThetaMinusThetaI[5]=(-x-y)*M_SQRT1_2;
  rCosThetaMinusThetaI[6]=-y;
  rCosThetaMinusThetaI[7]=(x-y)*M_SQRT1_2;

  int best_i=0;
  float best_rCosThetaMinusThetaI=rCosThetaMinusThetaI[0];
  for(int i=1; i<8; i++)
    if( rCosThetaMinusThetaI[i]>best_rCosThetaMinusThetaI ){
      best_i=i;
      best_rCosThetaMinusThetaI=rCosThetaMinusThetaI[i];
    }

  return best_i;

} 
```

There are a few simple things you can do to speed this up. For example `rCosThetaMinusThetaI[i] == -rCosThetaMinusThetaI[i-4]` for i>=4, so you only need four variables. Obviously you don't have to use an array, I just did this to make it easy to read. Also, since `rCosThetaMinusThetaI[0]==x` and `rCosThetaMinusThetaI[2]==y`, you only really need two variables. So we can rewrite the above as just a series of eight `if` statements:

```
int getIndex_optimized(float x, float y){

  float cosTheta1 = (x+y)*M_SQRT1_2;
  float cosTheta3 = (y-x)*M_SQRT1_2;

  int best_i=0;
  float best_cosTheta=x;
  if( best_cosTheta < cosTheta1 ){ best_i=1; best_cosTheta=cosTheta1; }
  if( best_cosTheta < y         ){ best_i=2; best_cosTheta=y; }
  if( best_cosTheta < cosTheta3 ){ best_i=3; best_cosTheta=cosTheta3; }
  if( best_cosTheta < -x        ){ best_i=4; best_cosTheta=-x; }
  if( best_cosTheta < -cosTheta1){ best_i=5; best_cosTheta=-cosTheta1; }
  if( best_cosTheta < -y        ){ best_i=6; best_cosTheta=-y; }
  if( best_cosTheta < -cosTheta3){ best_i=7; best_cosTheta=-cosTheta3; }

  return best_i;

} 
```

These two functions are C99 code; you can compile them with -std=c99\. You need to include math.h to get the constant M_SQRT1_2=0.7071...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T16:24:31.927

在您使用的 8 条射线中，当点与 x 轴的距离比与 y 轴的距离更近（或相同距离）时，使用一组四条射线。其他四个以其他方式使用。
在这 4 条中，当 x 为正（或零）时，使用右边的两条光线。其他两个以其他方式使用。
在这 2 个中，当 y 为正时使用上光线。否则使用较低的。
因此，使用这些简单的测试在查找表中形成索引。

```
float ClosestAngle(std::pair<float,float> point) {
    float angle[8] = { 247.5 , 112.5f , 292.5 , 67.5f , 202.5 , 157.5 , 337.5 , 22.5f };

    int closerToXAxisThanYAxis = (abs(point.first) <= abs(point.second)) ? 4 : 0;
    int xIsPositive = (point.first >= 0) ? 2 : 0;
    int yIsPositive = (point.second >= 0) ? 1 : 0;

    return angle[closerToXAxisThanYAxis + xIsPositive + yIsPositive];
} 
```

# .htaccess - .htaccess 重写规则将所有从子文件夹重定向到另一个文件夹

> ID：15364622
> 
> 赞同：0
> 
> 时间：2013-03-12T14:55:44.890
> 
> 标签：.htaccess, mod-rewrite

我的 .htaccess 规则有问题。我有以下情况：在更改根目录之前，我有一个名为“eleague”的文件夹，一切正常。现在我有另一个名为“competitions”的文件夹（在根目录中）和一个.htaccess（在根目录中）文件，我在其中编写了一些规则，如下所示：

```
RewriteRule ^aleague/(.*)-(\d+).html.*$                 /competitions/competition.php?t_id=$2&text=$1  [L]
RewriteRule ^bleague/(.*)-(\d+).html.*$                 /competitions/competition.php?t_id=$2&text=$1  [L]
...
RewriteRule ^eleague/(.*)-(\d+).html.*$                 /competitions/competition.php?t_id=$2&text=$1 [L] 
```

我现在想要的是从“eleague”文件夹中修改 .htaccess 文件，以将所有请求重定向到我的新位置（上面要匹配的最后一条规则）。诀窍是我不能（必须！！）从我的目录结构中删除“eleague”文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:18:47.850

如果要在浏览器栏中显示新 URL，则必须在规则中添加[重定向`R`标志](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_r)

```
RewriteRule ^eleague/(.*)-(\d+).html.*$ /competitions/competition.php?t_id=$2&text=$1 [R,L] 
```

# java - 自 java 7 以来，JFileChooser 对按 Enter 没有反应

> ID：15364625
> 
> 赞同：4
> 
> 时间：2013-03-12T14:55:47.100
> 
> 标签：java, swing, java-7, look-and-feel, jfilechooser

我对**嵌入 JFrame 的 JFileChooser 有疑问**。如果我在文本字段中输入文件名或正则表达式并按“输入”键，则不会发生任何事情。

如果我使用“打开”按钮而不是输入它可以工作。这个问题从 java 7 开始出现，并且只有当我使用嵌入的 JFileChooser 时才会出现。在**JFileChooser OpenDialog**中，“enter”键起作用。

如果我使用 Nimbus 外观和感觉，它也可以嵌入，使用其他外观将不起作用。

我可以在 Windows 和 Linux 系统的外观和感觉以及 CrossPlatformLookAndFeel（我认为它称为 Metal）上重现此错误。

有没有人解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-21T13:18:27.100

如果您只想通过按回车键选择给定的路径和文件，您可以在实例化 JFileChooser 后在 JDialog 中添加以下行：

```
KeyStroke enter = KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0);
InputMap map = chooser.getInputMap(JFileChooser.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
map.put(enter, "approveSelection"); 
```

其中选择器是 JFileChooser 的一个实例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-15T13:27:56.200

在向 Oracle 提交错误报告后，但由于这真的很烦人，我一直试图解决这个问题几个小时（在几天的过程中）。最后浏览 OpenJDK 和 Oracle 源代码，了解我使用 JFileChooser 组件与其内置的 showOpenDialog 等方法之间的差异。

我相信我有一个可靠的解决方法，似乎对我们的应用程序很有效。只是一点背景知识：我们在JPanel（带有 GridBagLayout）内的**JDialog的自定义子类中使用****JFileChooser**组件和“系统”外观。

 **这是完成此操作的单行代码：

```
dialog.getRootPane().setDefaultButton(chooser.getUI().getDefaultButton(chooser)); 
```

在哪里

*   *dialog*是包含 JFileChooser 组件的**JDialog**的一个实例
*   *选择器*是**JFileChooser的一个实例**

上面的示例代码用于演示问题的代码中（就在显示模态对话框之前），但我们后来将代码移到了对话框子类的构造函数中以使事情变得更容易。从 JRE 1.7.0_45 开始，我们仍然面临着这个问题，所以希望如果其他人遇到这个问题，这会有所帮助。**

# paypal - 贝宝沙盒登录

> ID：15364626
> 
> 赞同：10
> 
> 时间：2013-03-12T14:55:50.427
> 
> 标签：paypal, paypal-sandbox

我通过以下方式登录到我的 PayPal 开发人员帐户：`developer.paypal.com`，在那里我设置了各种测试帐户。然后，我导航到`sandbox.paypal.com`，但该站点显示一条消息：“**请登录以使用 PayPal 沙盒功能。** ”

**这曾经在几个月前起作用；发生了什么变化？我错过了一步吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:21:25.610

错误：

“请登录以使用 PayPal 沙盒功能。”

登录沙盒帐户或浏览帐户是我们现在正在努力解决的已知问题。很抱歉给大家带来了影响，但是一旦修复，我一定会更新这篇文章。

如果您在开发人员或沙盒中遇到其他问题，请随时评论您遇到的问题，我一定会进一步调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:47:38.200

我使用了 opera 并删除了所有私有数据，例如 cookie、缓存、会话 cookie……它正在工作。我想它也可以在其他浏览器中工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T14:59:44.817

现有 Sandbox 用户 所有美国和非美国开发人员都必须使用 PayPal 帐户登录才能使用 Sandbox。登录后，使用您现有的 PayPal Developer Central 用户名和密码导入沙盒测试帐户。请参阅我们的常见问题解答。

# javascript - 如何将这种日期时间 2013-03-12T22:15:40+08:00 格式化为“2012 年 3 月 12 日 02:15:40 UTC”？

> ID：15364627
> 
> 赞同：1
> 
> 时间：2013-03-12T14:55:53.307
> 
> 标签：javascript, datetime

我从我的数据库中收到了我的日期时间，它以这种格式返回

`2013-03-12T22:15:40+08:00`

这是什么格式？T 和 + 代表什么？

我想将我的时间显示为：

`12 Mar 2012 02:15:40 UTC`

我想根据浏览器中设置的时区显示这个时间。因此，我应该用 Javascript 格式化它，而不是在后端。我怎样才能在 JS 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:02:01.727

“T”代表“时间”；“+”（或“-”）表示 UTC 偏移量。JavaScript 实际上在我的浏览器中可以很好地解析这种格式：

```
> new Date('2013-03-12T22:15:40+08:00');
Date {Tue Mar 12 2013 14:15:40 GMT+0000 (GMT Standard Time)} 
```

因此，如果您想要指定的格式：

```
var formatDate = function(d) {
  var date = new Date(d);
  return date.getUTCDate() + ' ' +
         ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][date.getUTCMonth()] + ' ' +
         date.getUTCFullYear() + ' ' +
         date.getUTCHours() + ':' +
         date.getUTCMinutes() + ':' +
         date.getUTCSeconds() + ' UTC';
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:05:15.710

```
function toUTC(datestring) {
    var date = new Date(datestring);
    var months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    return date.getUTCDate() + " " + 
           months[date.getUTCMonth()] + " " + 
           date.getUTCFullYear() + " " + 
           date.getUTCHours() + ":" + 
           date.getUTCMinutes() + ":" + 
           date.getUTCSeconds() + " UTC";
}
console.log(toUTC("2013-03-12T22:15:40+08:00")); 
```

给`12 Mar 2013 14:15:40 UTC`. 我想UTC时间应该是14小时而不是02小时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:37:18.407

具体细节在上面的答案中 - 如果这就是你所做的一切，那么它似乎对你很有帮助。如果您要进行更多的日期操作，那么您可能需要查看日期操作库。JavaScript 对日期的处理充其量是很弱的，所以有几个很好的可供选择，但出于显而易见的原因，我倾向于喜欢我自己的：

[DP_DateExtensions](http://depressedpress.com/javascript-extensions/dp_dateextensions/)

Parse 函数将从任何预定义的字符串中为您获取 JS 日期，而 Format 函数将输出您需要的任何内容。

# ios - 平铺 CGPattern 时正确绘制

> ID：15364628
> 
> 赞同：1
> 
> 时间：2013-03-12T14:55:54.557
> 
> 标签：ios, core-graphics, quartz-core

我正在尝试用 CGPattern 填充矩形，用条纹绘制典型的条形图。我得到这个。

![在此处输入图像描述](../Images/dff2fd874344a4c1e38e166a3d424440.png)

模式的代码（不是整个条）是这样的

```
CGContextSaveGState (context);

CGColorSpaceRef patternSpace = CGColorSpaceCreatePattern(NULL);
CGContextSetFillColorSpace(context, patternSpace);
CGColorSpaceRelease(patternSpace);
CGFloat alpha = 0.25f;
static const CGPatternCallbacks callbacks = {0, &DrawStripesPattern, NULL};
NSNumber *cellSide = [NSNumber numberWithFloat:kTAGBarHeight];
CGFloat cellSideFloat = [cellSide floatValue];

CGPatternRef pattern = CGPatternCreate((__bridge void *)(cellSide),
                                       CGRectMake(0.0f, 0.0f, cellSideFloat, cellSideFloat),
                                       CGAffineTransformIdentity,
                                       cellSideFloat,
                                       cellSideFloat,
                                       kCGPatternTilingConstantSpacing,
                                       true,
                                       &callbacks);
CGContextAddPath(context, [path CGPath]);
CGContextClip(context);
CGContextSetFillPattern(context, pattern, &alpha);
CGContextFillRect(context, barRect);
CGPatternRelease(pattern);

CGContextRestoreGState (context); 
```

模式单元格具有与条形高度相同的一侧（看`kTAGBarHeight`），并且绘图回调是在单元格矩形内绘制 5 条规则斜线。它看起来不错，但如果你放大一点......

![在此处输入图像描述](../Images/02925a27a153993ae6dddee5d2592603.png)

线条被剪裁到单元格矩形，所以看起来像这样。我有两个问题：

1.  为什么模式没有按照我在中指定的条形矩形的原点 (0,0) 绘制`CGPatternCreate`？会不会是第三个参数没有变换？
2.  我怎样才能避免这种恼人的影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:04:46.987

好吧，解决了：P

在我的绘图回调中，我绘制了 7 条线，而不是 5 条线，第一条在点 (0.0f, 0.0f)，第七条在点 (maxX, maxY)。这正确地连接了线条。

# mongodb - Ember、Ember Data 和 MongoDB 的 _id

> ID：15364630
> 
> 赞同：8
> 
> 时间：2013-03-12T14:56:01.967
> 
> 标签：mongodb, ember.js, mongoose, ember-data

我已经看到过这个问题，但我仍然对将 Mongo 处理`_id`成`id`. 我使用 mongoose 作为我的 ORM，虽然它有虚拟，但我似乎无法让它正常工作。以下是我的猫鼬模型中的内容。

**尝试从后端修复**

```
mongoose = require 'mongoose'
Schema = mongoose.Schema
ObjectId = Schema.ObjectId

ApartmentSchema = new Schema
  body: String
  date: { type: Date, default: Date.now }
  deleted: {type: Boolean, default: false}
  saved: {type: Boolean, default: false}
  visited: {type: Boolean, default: false}
  email: String
  phoneNumber: String
  href: String

ApartmentSchema.virtual('id').get -> return @_id

module.exports = mongoose.model 'Apartment', ApartmentSchema 
```

当我在 express 中创建此模型的新实例时，我可以进行查找`apt.id`并取回 id，但是当我将响应发送给客户端时，我只是有`_id`和没有`id`。

我尝试的第二个解决方案是创建一个计算属性，`id`但无论出于何种原因，ember 都不喜欢这样。这里有2个问题。Ember 不尊重被称为`id`或至少不再尊重的计算属性。这就是我的 ember-data 模型的样子。

**尝试从前端修复它**

```
App.Apartment = DS.Model.extend({
  body: DS.attr('string'),
  date: DS.attr('date'),
  deleted: DS.attr('boolean'),
  saved: DS.attr('boolean'),
  visited: DS.attr('boolean'),
  email: DS.attr('string'),
  phone: DS.attr('string'),
  _id: DS.attr('string'),
  id : function () {
    return this.get('_id')
  }.property('_id')
}); 
```

在我下面的模板中，没有为 id 呈现任何内容。

```
{{#each apartment in controller}}
    <li>{{apartment.body}} | {{apartment.date}} | {{apartment.href}} {{apartment.id}}</a>  {{#linkTo 'apartment' apartment }} View {{/linkTo}} </li>
{{/each}} 
```

助手工作，`linkTo`但 url 在 id 应该是 null 的地方。这会导致后退按钮中断并多次加载数据。下面是我的路由器的一些上下文。

```
App.Router.map(function(){
  this.resource('apartments', function (){
    this.resource('apartment', { path: ':apartment_id' } );
  });
}); 
```

将我的计算`id`属性的名称更改为类似的名称，`foo`然后将我的路由器更改为`path: ':apartment_foo'`在 url 中具有对象引用的 url，例如：`#/apartments/<App.Apartment:ember357:null>`.

正是这样的东西让我对 ember 感到不安。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T18:09:55.117

从 Ember 1.0.0-rc 1 和 Ember Data 修订版 11 开始，这似乎是解决此问题的最佳方法。

```
App.Adapter = DS.RESTAdapter.extend({
  serializer: DS.RESTSerializer.extend({
    primaryKey: function(type){
      return '_id';
    }
  })
});

App.Store = DS.Store.extend({
  revision: 11,
  adapter: 'App.Adapter'
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-09-25T17:10:04.483

从 Ember Data - 版本：v1.0.0-beta.2 开始，我能够做到以下几点：

```
App.ApplicationSerializer = DS.RESTSerializer.extend({
  primaryKey: "_id"
}); 
```

我对 Ember 很陌生，所以这可能不是最好的方法，但它确实有效！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-06T03:58:53.460

我和 Chris 有同样的问题，id 看起来像这样：

```
"_id":{"$oid":"52772aa44f6c6c5dd0000000"} 
```

将 $oid 部分添加到 claptimes 的解决方案对我有用。

```
App.ApplicationSerializer = DS.RESTSerializer.extend({
  primaryKey: "_id.$oid"
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-07T02:50:29.717

自从迁移到 Ember-CLI 后，这个过程略有改变。你现在想要这样做：

1.  从 Ember-CLI 项目命令行：

    ```
    ember g serializer application 
    ```

2.  使您新创建的序列化程序如下所示：

    ```
    import DS from 'ember-data';

    export default DS.RESTSerializer.extend({
      primaryKey: '_id'
    }); 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-22T23:05:02.457

从 Ember 2.0.0 开始，规范化 Mongo ID 的正确方法是`extractId`在序列化程序中使用 。这是针对 Rails/Grape API 运行的 RESTSerializer 的示例：

```
import DS from 'ember-data';

export default DS.RESTSerializer.extend({
  isNewSerializerAPI: true,
  extractId: function (modelClass, resourceHash) {
    return resourceHash.id.$oid;
  }
}); 
```

请注意，您必须设置`isNewSerializerAPI`为`true`才能正常工作。

根据您的需要，您可以尝试更改为`resourceHash._id.$id`或其他任何适合您的方法。如果您不确定，请尝试`console.log(resourceHash)`检查数据。

# javascript - 为什么 jQuery .after() 只触发一次？

> ID：15364631
> 
> 赞同：0
> 
> 时间：2013-03-12T14:56:04.820
> 
> 标签：javascript, jquery, dom-manipulation, jquery-after

我正在尝试创建一个连续循环的 jQuery 轮播。当用户选择“旋转”时，使用 .after() 方法将第一个 li 放置在最后一个 li 之后。这只适用于第一次。在那之后，李氏就不会重新安排自己了。这是我的 HTML：

```
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
</ul>

<a href="#">Rotate</a> 
```

这是我的 JavaScript：

```
var list = $('ul'),
    firstItem = list.find('li:first'),
    lastItem = list.find('li:last');

$('a').on('click', function(){
    lastItem.after( firstItem );
}); 
```

这是一个小提琴：http: [//jsfiddle.net/brianeoneill/76BP8/](http://jsfiddle.net/brianeoneill/76BP8/)

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:57:47.613

每次您的代码运行时，它**都会**`1`在`3`.

如果要继续重新排列，则需要每次将变量重新设置为`:first`and 。`:last`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:58:44.900

将您的选择器放在 click 函数中：

```
var list = $('ul');
$('a').on('click', function(){
    var firstItem = list.find('li:first'),
    lastItem = list.find('li:last');
    lastItem.after( firstItem );
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/76BP8/5/)**

通过将它们保留在单击事件之外，您不会更改每次选择的元素。通过将它们移动到你里面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:00:04.613

```
var list = $('ul');

$('a').on('click', function(){
    firstItem = list.find('li:first'),
    lastItem = list.find('li:last');

    lastItem.after( firstItem );
}); 
```

[http://jsfiddle.net/76BP8/2/](http://jsfiddle.net/76BP8/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T14:57:48.580

如果元素尚未插入，则插入元素会移动它。

在这里，您在同一个地方重复相同的插入，它没有做任何新的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:02:09.167

您没有更新变量，因此第一项和最后一项将始终相同。

如果您想将选择保留在外部，这是一种替代方法：

```
var list = $('ul'),
    firstItem = function(){
        return list.find('li:first');
    },
    lastItem = function(){
        return list.find('li:last');
    };

$('a').on('click', function(){
    lastItem().after( firstItem() );   
}); 
```

[http://jsfiddle.net/76BP8/3/](http://jsfiddle.net/76BP8/3/)

# vim - 如何用vim在不同的行打开多个文件？

> ID：15364634
> 
> 赞同：3
> 
> 时间：2013-03-12T14:56:30.693
> 
> 标签：vim

我知道可以使用以下命令在不同的行打开单个文件：

```
vim foo.c +123
vim +123 foo.c # same result 
```

可以使用以下方法打开多个文件：

```
vim foo.c bar.c 
```

但是我怎样才能将这两个动作结合起来呢？`vim +123 foo.c +456 bar.c`不起作用，`bar.c`在第一行而不是 456 处打开。

我看到[Vim : Open multiple files on different lines](https://stackoverflow.com/q/2148397/427545)，但这会在我习惯`:prev`和`:n`导航时打开不同的选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:36:03.997

我不知道是否有更简单的方法，但这里有一个非常简单的解决方法，并且不会影响您的工作流程，因为您不是选项卡用户。

1.  `.vimrc`首先，在您输入 vim 后立即在您的to issue `tabo[nly]`（关闭所有其他选项卡）中设置一个自动命令。

    ```
    autocmd VimEnter * tabo 
    ```

2.  接下来，使用链接问题中的解决方案在多个选项卡中打开文件

    ```
    vim +123 foo.c +"tabnew +456 bar.c" 
    ```

所以发生的事情是，在幕后，vim 在选项卡中打开文件，但立即关闭除最后一个之外的所有文件。所有打开的文件都应该在您的打开缓冲区中可用。

即使你在没有多个文件的情况下正常打开 vim 也能正常工作（你会看到一条无害的消息——“已经只有一个标签页”——在下一次击键时消失）。此外，由于此命令仅在 上发出`VimEnter`，因此它不会阻止您稍后在会话中使用选项卡（如果您愿意）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T07:59:54.280

使用[file:line - 允许您打开 file:line 并执行正确的](http://www.vim.org/scripts/script.php?script_id=2184)插件，您可以使用

```
$ vim foo.c:123 bar.c:456 
```

它不适用于`-o`拆分，但它适用于为参数列表中的文件预设行号的用例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T08:29:41.103

除了 file:line 插件，正如 Ingo 建议的那样，我刚刚在[https://gist.github.com/xim/6123691](https://gist.github.com/xim/6123691)上做了一个 bash 函数破解——作为对[Vim 的回答：Open multiples files on different lines](https://stackoverflow.com/q/2148397/427545#17976092)。

file:line 似乎不处理带有空格和其他特殊字符的文件名，并且在使用时没有在选项卡中打开我的文件`vim -p`– 不过，Lekensteyn 对你来说可能是一个更好的选择，因为它不会强迫你使用选项卡文件。

# extjs - ExtJs - 在编辑时保持选中网格行

> ID：15364636
> 
> 赞同：1
> 
> 时间：2013-03-12T14:56:35.240
> 
> 标签：extjs, extjs4, extjs4.1

`id`我通过收听`change`文本字段来更改网格中列的值：

```
oTextfieldName.on( 'change', function( oField, strValue ) {
   oStore.getAt( 0 ).setId( strValue );
} 
```

但是，如果`setId()`被调用，`0`则删除该行的选择。我的应用程序依赖于选定的行来保持选中状态。

如何保持选中行，同时仍编辑/更改该 id 列？

* * *

编辑：

使用时`store.sync()`，它会重新被选中。

但是，我的商店搞砸了：

`Uncaught TypeError: Object function () { this.destroy = Ext.emptyFn; } has no method 'indexOf' ext-dev.js:1253`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:19:08.757

你可以重新选择行吗？

```
oTextfieldName.on( 'change', function( oField, strValue ) {
   oStore.getAt( 0 ).setId( strValue );
   yourGrid.getSelectionModel().select(0);
} 
```

您也可以执行类似的操作来禁止触发选择事件。

```
var suppressEvent = true;
yourGrid.getSelectionModel().select(rowIndex, null, suppressEvent); 
```

查看[SelectionModel 选择方法的文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.selection.Model-method-select)

这是一个你可以玩的简单[小提琴。](http://jsfiddle.net/cfzFZ/7/)如果单击“测试”按钮，它将选择索引 1 处的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T16:18:06.410

由于`sync()`导致了这个错误，我现在使用这种糟糕的方式：

```
oSelectionModel.deselect( nIndex, true );        
oSelectionModel.select( nIndex, true ); 
```

更改后，我取消选择（幸运的是不可见）然后选择。至少它有效。

# c# - Linq to Xml - 输入字符串

> ID：15364637
> 
> 赞同：1
> 
> 时间：2013-03-12T14:56:41.450
> 
> 标签：c#, linq-to-xml

我正在使用 Linq to Xml 来解析一些来自遗留系统的 xml 消息。其中一条消息以名称/值对的形式出现。所以我正在按名称进行查找，然后尝试获取等效值。但是，当值为空白（`<Value/>`）时，我的代码会抛出错误`Input string was not in a correct format.`

我正在尝试找出解决此问题的最佳方法。任何建议将不胜感激（尝试用可为空的 int 类型 int 填充属性？）。

代码示例：

```
myRecord.myField= xdoc.Descendants("Information")
                        .Where(x => (string)x.Element("Name") == "myField")
                        .Select(x => (int?)x.Element("Value")).FirstOrDefault(); 
```

XML 片段：

```
 <Information>
      <Name>myField</Name>
      <Value />
    </Information> 
```

始终感谢反馈/输入。

谢谢，

小号

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:04:32.863

当元素为空时，它的值`String.Empty`不能被解析为整数。因此，您应该手动处理这种情况：

```
myRecord.myField = xdoc.Descendants("Information")
                       .Where(x => (string)x.Element("Name") == "myField")
                       .Select(x => x.Element("Value"))
                       .Select(v => (v == null || v.IsEmpty) ? null : (int?)v)
                       .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:18:01.167

这应该有效：

```
public static class Extensions
{
   public static int? ToInt32(this XElement element)
   {
      if (element == null) return null;
      if (element.IsEmpty) return null;

      // If the element is declared as <Value></Value>,
      // IsEmpty will be false, but the value will be an empty string:
      if (string.IsNullOrEmpty(element.Value)) return null;

      return XmlConvert.ToInt32(element.Value);
   }
}

myRecord.myField = doc.Descendants("Information")
   .Where(x => (string)x.Element("Name") == "myField")
   .Select(x => x.Element("Value").ToInt32()).FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:05:10.170

*已经提供了正确的答案，但我认为更多的解释会有所帮助。*

整个事情即将[`XElement`进行`Nullable<T>`显式转换](http://msdn.microsoft.com/en-us/library/bb340386.aspx)。注意那个例子，看看发生了什么：

```
XElement element = null;
// returns null
int? value = (int?)element;

element = new XElement("test", 1);
// returns 1
value = (int?)element;

element = new XElement("test");
// throws FormatException
value = (int?)element; 
```

`(int?)xElementInstance`仅返回`null`，其中元素为`null`. 否则，将处理 int 解析，这将引发异常，只要`XElement.Value`不是整数（就像在 out case 中，当没有`Value`，所以它就像`int.Parse(String.Empty)`）。

您必须在转换之前检查`is XElement set`和`does XElement has value`：

```
if (element == null)
    return null;
else if (element.IsEmpty)
    return null
else if (string.IsNullOrEmpty(element.Value))
    return null
else
    return (int?)element; 
```

使用 inline 语句可以轻松完成的工作：

```
(element == null || element.IsEmpty || string.IsNullOrEmpty(element.Value) ? null : (int?)element) 
```

总而言之，以下代码执行您想要的操作 -`int?`从 XElement 获取，当元素没有值时发生事件：

```
element = new XElement("test");
// returns null
value = element == null || element.IsEmpty || string.IsNullOrEmpty(element.Value) ? null : (int?)element; 
```

# mysql - 从右到左方向制作一列

> ID：15364639
> 
> 赞同：-3
> 
> 时间：2013-03-12T14:56:43.520
> 
> 标签：mysql, sql

我有一张桌子，在这张桌子上我有一列用于阿拉伯语文本。但是，在该列中，文本是从左到右的方向。是否有可能使它们成为 rtl 方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:00:06.757

`REVERSE()`功能来了 这是[手动](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_reverse)输入。

这个函数是**多字节安全**的，这意味着它对每个字符集/编码都是安全的。

```
SELECT REVERSE('abc'); 
```

结果是

```
cba 
```

要使其永久化，您可以像这样更新您的列：

```
UPDATE yourTable SET yourColumn = REVERSE(yourColumn) 
```

# ruby-on-rails - params[:page] 为 nil

> ID：15364648
> 
> 赞同：1
> 
> 时间：2013-03-12T14:57:05.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, will-paginate

我有以下代码

```
# Gemfile

gem 'will_paginate'

# /config/initializers/will_paginate_array.rb

require 'will_paginate/collection'

Array.class_eval do
  def paginate(page = 1, per_page = 15)
    WillPaginate::Collection.create(page, per_page, size) do |pager|
      pager.replace self[pager.offset, pager.per_page].to_a
    end
  end
end

# /app/controllers/games_controller.rb

def show
  @presenter = GamesPresenter.new(json)
  @games = @presenter.games.paginate(params[:page], 5)
end

# /app/views/games/index.html.erb

<% @games.each do |game| %>
  ...
<% end %>

<%= will_paginate @games %> 
```

但是，当我尝试传递 params[:page] 时，`line @games = @presenter.games.paginate(params[:page], 5)` 我得到`params[:page]` 了零。有谁知道为什么会这样？. 如果 page.blank 添加 page=1？只给我第一页的结果..有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:00:59.403

`params[:page]`默认情况下是`nil`. 我建议您通过将 class_eval 更改为来处理这种情况

```
def paginate(page = 1, per_page = 15)
  page ||= 1
  WillPaginate::Collection.create(page, per_page, size) do |pager|
    pager.replace self[pager.offset, pager.per_page].to_a
  end
end 
```

当您`nil`作为第一个参数传递时，它不会使用`1`，因为您显式传递了一个值。

# c# - 在 ASP.NET 条形图中显示持续时间

> ID：15364652
> 
> 赞同：2
> 
> 时间：2013-03-12T14:57:14.383
> 
> 标签：c#, asp.net, charts

我有一个应用程序，我在其中使用包含的 ASP.NET 图表控件。在我的一个图表中，我需要显示一个带有持续时间的条形图。持续时间存储为 TimeSpan 对象，如下所示：

```
List<TimeSpan> durations = GetDurations(); // Will be between 15 minutes and 6 hours
List<string> labels = GetLabels();  
...
chart.Series["Default"].Points.DataBindXY(xValues, durations); 
```

当我执行这个时，抛出一个异常，上面写着：

> 系列数据点不支持 System.TimeSpan 类型的值，只能使用以下类型的值：Double、Decimal、Single、int、long、uint、ulong、String、DateTime、short、ushort。

异常很清楚问题是什么。但是，我如何在条形图中显示我的持续时间呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:02:19.673

那么，与其让您的持续时间为 TimeSpan 类型（例外是告诉您系列数据点不支持该类型），为什么不使用时间跨度的 Minutes 属性呢？[http://msdn.microsoft.com/en-us/library/system.timespan.minutes.aspx](http://msdn.microsoft.com/en-us/library/system.timespan.minutes.aspx)

```
List<int> durations = GetDurations(); // Change GetDurations to return a List<int> of the *minutes* of the timespan
List<string> labels = GetLabels();  
...
chart.Series["Default"].Points.DataBindXY(xValues, durations); 
```

# html - 我们可以从 html 站点获取/抓取特定数据到 Batch 中以执行以下操作吗？

> ID：15364653
> 
> 赞同：0
> 
> 时间：2013-03-12T14:57:15.853
> 
> 标签：html, command-line, batch-file, batch-processing

[在这个网站](http://www.computing.net/answers/programming/parsing-html-with-batch/15572.html)上的这篇文章中，伙计们的工作很棒。
但是我需要根据我的需要修改这个脚本。

我不是铁杆编码员，但几乎没有什么帮助，我可以让它工作。

我有网站，它有 HH:MM AM/PM 格式的时间戳。
这就是我网站上的内容。

```
Last Updated as of 11:14 pm March 11th 
```

我想解析`2:14 PM`并比较它（减去它）与当前时间戳，并得到分钟。如果差异大于 30 分钟，那么我希望它做点什么。

有人可以帮我弄这个吗？谢谢

我正在尽力理解和修改这段代码。
**仅供参考**Google.com 只是示例，而不是 google，它将链接到 mysite。

```
@echo off
setLocal EnableDelayedExpansion
set curTimestamp=%date:~7,2% %date:~3,3%_%date:~10,4%_%time:~0,2%_%time:~3,2%
FOR /F "TOKENS=*" %%A IN ('TIME/T') DO SET Now=%%A

for %%F in (q r s t u v w x y z) do if exist %%F del %%F

wget <a href="http://google.com" target="_blank" rel="nofollow">http://google.com</a>

find "Updated" < index.html > q

for /f "tokens=1-4 delims==" %%a in (q) do (
echo %%d >> r
)
for /f "tokens=2-3 delims=>" %%a in (r) do (
echo %%a %%b >> s
)
for /f "tokens=1-2 delims=<" %%a in (s) do (
echo %%a %%b >> t
)
for /f "tokens=1-2 delims=^/" %%a in (t) do (
echo %%a %%b >> u
)
for /f "tokens=1,3 delims= " %%a in (u) do (
echo %%b %%a >> v
)
for /f "tokens=1-4 delims=- " %%a in (v) do (
echo %%c %%b %%a %%d >> w
)
for /f "tokens=* delims= " %%a in (w) do (
set str=%%a
set str=!str:Jan=01!
set str=!str:Feb=02!
set str=!str:Mar=03!
set str=!str:Apr=04!
set str=!str:May=05!
set str=!str:Jun=06!
set str=!str:Jul=07!
set str=!str:Aug=08!
set str=!str:Sep=09!
set str=!str:Oct=10!
set str=!str:Nov=11!
set str=!str:Dec=12!
echo !str! >> x
)
sort < x > y
for /f "tokens=4 delims= " %%a in (y) do (
set AVG=%%a
)
echo wget www.google.com
echo %curTimestamp%
ECHO %Now%
::for %%F in (q r s t u v w x y z) do if exist %%F del %%F
Pause 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T17:36:15.560

这是一个批处理脚本/JScript 混合，使用 JScript 对日期执行数学运算的能力。由于网页从未指定，此脚本假定年份是*今年*，因此如果文档最后一次修改是在 12 月，那么在 1 月初运行此脚本可能会得到意想不到的结果。无论如何，在这里。

```
@if (@X)==(@Y) @end /* (batch + jscript hybrid script init)

:: *** Batch script *****

@echo off
setlocal enabledelayedexpansion
for /f "delims=" %%I in ('wget "%~1" -O- -q 2^>NUL ^| findstr /i "last.*updated.*as.*of"') do (
    for /f "delims=" %%x in ('cscript /nologo /e:jscript "%~f0" "%%I"') do (

        rem test whether date diff >= 30 minutes
        set /a "thirtyMinutes = 30 * 60 * 1000"
        if %%x GEQ !thirtyMinutes! (
            echo Do that voodoo that you do.
        )

        rem Just to demonstrate, you can do some maths to make further sense of the date difference.
        rem set milliseconds=%%x
        set /a "seconds = %%x / 1000, seconds %%= 60"
        set /a "minutes = %%x / 1000 / 60, minutes %%= 60"
        set /a "hours = %%x / 1000 / 60 / 60, hours %%= 24"
        set /a "days = %%x / 1000 / 60 / 60 / 24"
        echo %~1 last modified !days! days !hours! hours !minutes! minutes ago.
    )

    rem Once the for loop has fired, exit.
    exit /b
)

rem In case the web page does not contain "last updated as of"
exit /b

:: *** JScript script *****/
var args = [];
for (var i=0; i<WScript.arguments.length; i++) { args.push(WScript.arguments(i)) }
var t = args.join(' ').replace(/^\s+|<[^>]+>|\s+$/g,'').replace(/\&nbsp;/g, ' ').split(' ');
var h = t[4].split(':')[0];
if (/pm/i.test(t[5])) h = h * 1 + 12;
var ds = t[6] + ' ' + t[7] + ', ' + new Date().getFullYear() + ' ' + h + ':' + t[4].split(':')[1];
var diff = new Date() - new Date(ds);
WScript.echo(diff); 
```

**示例输出：**

```
C:\Users\me\Desktop>test.bat http://stackoverflow.com/questions/15364653/
Do that voodoo that you do.
http://stackoverflow.com/questions/15364653/ last modified 0 days 23 hours 18 minutes ago. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:10:05.263

```
@echo off
set timeStamp=Last Updated as of 2:14 pm March 11th

rem Convert time of timeStamp to number of minutes
for /F "tokens=5-7 delims=: " %%a in ("%timeStamp%") do (
   set /A minutes=%%a*60 + 1%%b%%100
   if %%c equ pm set /A minutes+=12*60
)

rem Subtract that number of minutes from current time
for /F "tokens=1-2 delims=:" %%a in ("%time%") do (
   set /A minutes=%%a*60 + 1%%b%%100 - minutes
)

rem If time lapse is negative, timeStamp was taken from previous day
if %minutes% lss 0 (
   set /A minutes+=24*60
)

if %minutes% gtr 30 (
   echo Do something...
) 
```

# .net - 网络服务 IIS7 .net 框架 4 http 400

> ID：15364654
> 
> 赞同：0
> 
> 时间：2013-03-12T14:57:22.293
> 
> 标签：.net, web-services, iis-7

在我们的测试服务器上，当我尝试访问托管在 IIS 中的 WCF 服务的 URL 时，我收到 HTTP 400 错误。当我查看服务器上的 WCF 日志时，它指出“无法读取消息正文，因为它是空的”。如果我尝试为同一服务器上的另一个服务做同样的事情，它工作正常，我得到了 WSDL 的路径。

我也无法通过 SoapUI 连接到 WSDL。但是，我可以从 Visual Studio 连接到该服务。

我看到的大多数帖子都提到需要`httpGetEnabled="true"`在配置文件中。该属性存在于测试服务器的 web.config 中。

其他帖子提到需要额外的属性，但我不明白如果生产服务器在没有它们的情况下工作，为什么需要它们。

编辑以回应 Davin：这是 Fiddler 对生产请求的原始视图 GET [http://production.svc](http://production.svc) HTTP/1.1 Accept: text/html, application/xhtml+xml, */* Accept-Language: en-US User-代理：Mozilla/5.0（兼容；MSIE 9.0；Windows NT 6.1；WOW64；Trident/5.0）接受编码：gzip，放气连接：保持活动主机：生产

这是 Fiddler 对测试请求的原始视图 GET [http://test.svc](http://test.svc) HTTP/1.1 Accept: text/html, application/xhtml+xml, */* Accept-Language: en-US User-Agent: Mozilla/5.0 （兼容；MSIE 9.0；Windows NT 6.1；WOW64；Trident/5.0）接受编码：gzip，放气连接：保持活动主机：测试

这是试图使用 IE9 连接到服务。

致 CodeCaster：它使用框架 4 并在 asp.net v4.0 应用程序池中运行。框架 4 安装在服务器上。如果我使用我设置的测试应用程序，我可以连接到该服务并向其中一种方法发送请求并且它工作正常。

我的问题是使用 IE 或soapUI 连接到服务，因为我们的供应商在他们能够这样做之前不会在他们的测试系统上更新他们的端点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:05:11.763

HTTP 400 是一个`BadRequest`. 当服务器因为无法处理请求而拒绝请求时会抛出此错误。您收到的错误消息在这种情况下是有意义的。这也意味着服务器*能够*找到您的端点。所以，问题可能不在于`httpGetEnabled`.

您需要做的是查看发送到服务器的 HTTP 消息。为此，我建议将您的客户端指向代理（提琴手），然后配置提琴手以将请求转发到服务器。然后，您需要确保请求采用您期望的格式。

# android - 9 补丁 Android 4 问题，适用于 Android 2.3

> ID：15364655
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:57:22.313
> 
> 标签：android, nine-patch

我在下面的图片链接中为按钮“Day”创建了一个 9 补丁，它在我的 Android 2.3 手机上按预期工作。当我为 Android 4 平板电脑运行时，它不起作用。不确定我是否需要调整 xml 或如何创建 9-patch 的问题。另外，我在 Eclipse 的“drawable-hdpi”文件夹中只有 drawable。任何帮助表示赞赏！

```
 <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:background="@color/black"
        android:orientation="horizontal"
        android:weightSum="5" >

        <Button
            android:id="@+id/buttonTabSummary"
            android:layout_width="0dp"
            android:layout_height="50dp"
            android:layout_weight="1"
            android:background="@drawable/more_cap_en"
            android:textSize="9sp" />

        <Button
            android:id="@+id/buttonTabDay"
            android:layout_width="0dp"
            android:layout_height="50dp"
            android:layout_weight="1"
            android:background="@drawable/day_cap"
            android:textSize="9sp" />

        <Button
            android:id="@+id/buttonTabWeek"
            android:layout_width="0dp"
            android:layout_height="50dp"
            android:layout_weight="1"
            android:background="@drawable/more_cap"
            android:textSize="9sp" />

        <Button
            android:id="@+id/buttonTabShare"
            android:layout_width="0dp"
            android:layout_height="50dp"
            android:layout_weight="1"
            android:background="@drawable/more"
            android:textSize="9sp" />

        <Button
            android:id="@+id/buttonTabMore"
            android:layout_width="0dp"
            android:layout_height="52dp"
            android:layout_weight="1"
            android:background="@drawable/more"
            android:textSize="9sp" />
    </LinearLayout> 
```

[9 补丁创建者顶部屏幕。Android 2.3 左下，Android 4 右下（显示不正确](http://bodybuildingdietapp.com/printScreen.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:09:17.763

试着把它放在drawable文件夹而不是drawable-hdpi中。看起来您的平板电脑没有 hdpi 分辨率，所以它可能找不到图像。

# encryption - rsa 计算

> ID：15364660
> 
> 赞同：-1
> 
> 时间：2013-03-12T14:57:32.247
> 
> 标签：encryption, rsa

我正在尝试解决 2 个小数字的 RSA。我可以计算 n、phi 和 e，但是当我必须计算 d 时总是卡住。请帮助我。例子。

```
 p = 3,      q = 7,
        n =  3*7 = 21,
        phi(21)= 2*6 = 12, 
        e = 5

        d = (5^-1) (mod 21) 

        or

        d * 5 = k * 12 + 1   (where k is some number) 
```

我试图弄清楚 d * 5 = 25 = 5 * 12 + 1 的计算，但这是针对小数的，有没有其他方法可以用简单的方法计算 d

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:16:35.217

下面的伪代码可以帮助你（从[这个链接大量借用](http://www.cs.utexas.edu/%7Emitra/honors/soln.html)

```
// choose prime factors:
p = 3;
q = 7;

n = p * q; // =21
phi = (p-1)*(q-1); // = 12
// Choose e such that 1 < e < phi and e and n are coprime:
e = 5; 
// Compute a value for d such that (d * e) % phi = 1\. 
// in other words, solve 5 * d % 12 = 1
d = 5; // since 5 * 5 = 25; modulo 12 = 1\. How odd: d == e...

Public key is (e, n) => (5, 21) 
Private key is (d, n) => (5, 21) 

Testing this out on a "message" with the value of '2':
The encryption of m = 2 is 
    c = 2^5 % 21 = 32 % 21 = 11 
The decryption of c = 11 is 
    m = 11^5 % 21 = 161051 % 21 = 2 
```

如您所见，我们在加密/解密步骤后收到了“消息”。

请注意，由于 e==d，这是（不幸的是）对称密码：如果您再次应用加密，您也会收到消息。这表明e的选择很差。这是这些玩具RSA问题的问题......

# javascript - 在 Ajax 调用中获取访问被拒绝错误

> ID：15364662
> 
> 赞同：0
> 
> 时间：2013-03-12T14:57:35.037
> 
> 标签：javascript, html, ajax

我有以下用 html 页面编写的 javascript 代码。这个html页面保存在桌面，用来触发webservice；我从 IE9 浏览器运行它，但从本周开始，我开始在“httpRequest.open”调用中收到“拒绝访问”错误。我曾尝试更改 IE 的安全设置，但它不起作用。相同的代码在一周前可以工作，但它仍然只适用于一个人，我们无法区分所有浏览器设置是否相同。

```
function invokeService(name,url) 
{   
    try 
    {
        alert("entering"); 

        if (window.ActiveXObject) 
        {
            alert("activex");
            httpRequest=new ActiveXObject("Microsoft.XMLHTTP"); 
        }
        else if(window.XMLHttpRequest) 
        {
            alert("xmlhttp");
            httpRequest=new XMLHttpRequest();
        } 

        alert("going to open"+url); 

        httpRequest.open('GET',url,true);

        alert("opened");

        if (httpRequest.overrideMimeType) 
        { 
            httpRequest.overrideMimeType("text/xml"); 
        }

        alert("Going to pd");

        httpRequest.onreadystatechange=populateDiv;

        alert("going to send");

        httpRequest.send();

        valTimeout=setTimeout("timeout(httpRequest);",1200000);        

    }
    catch(e) 
    { 
        alert("Error in invoke"+e.description); 
    }   
} 
```

# css - Css float 搞乱了布局

> ID：15364663
> 
> 赞同：4
> 
> 时间：2013-03-12T14:57:41.417
> 
> 标签：css

我想要这个布局，我有一个矩形框。左边的方框内有一个文本，右边有一个图像。如果我在没有表格的情况下执行此操作，则浮动会导致框内的元素出现在外面。我如何使这项工作？

```
<div style="width: 100%;border-style:solid;">

    <span style="float: left;">  
         <h3> Your appointment Details</h3>
    </span> 
    <span style="float: right;">
        <img src="someImage"/>
    </span>

</div> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T14:59:00.930

将此添加到父容器：

```
.parent {
    overflow: hidden;
}

<div class="parent" style="width: 100%;border-style:solid;">

    <span style="float: left;">  
         <h3> Your appointment Details</h3>
    </span> 
    <span style="float: right;">
        <img src="someImage"/>
    </span>

</div> 
```

[带有解决方案示例的jsfiddle](http://jsfiddle.net/ZGdQM/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:21:07.540

比利护城河的答案是正确的方法。要添加还有另一种方法。您可以在父元素的末尾添加一个空元素，并清除其浮动。IE

```
.dummyClear{
   clear:both
} 
```

```
<div style="width: 100%;border-style:solid;">    
    <span style="float: left;">  
         <h3> Your appointment Details</h3>
    </span> 
    <span style="float: right;">
        <img src="someImage"/>
    </span>
    <div class="dummyClear"></div> <!-- Any tag is fine -->

</div> 
```

# android - 如何在“呼叫死亡”之前检测“呼叫已接受”？

> ID：15364671
> 
> 赞同：2
> 
> 时间：2013-03-12T14:58:04.630
> 
> 标签：android, broadcastreceiver, call, telephonymanager, phone-state-listener

我尝试为android编写一个程序。我想用我的程序拨打电话，然后识别通话状态。使用流动功能，我可以识别挂出状态，而对于应答状态，它不起作用。我尝试了这个功能，但它也不起作用。

## 我想在“呼叫死亡”之前检测“呼叫已接受”。

```
public class OutgoingCallReceiver extends BroadcastReceiver {
    protected static final String CLASS_TAG = "OutgoingCallReceiver : ";
    private static final String LOG_TAG = "MyActivity";
    private ConnectivityManager connectivityManager;
    private TelephonyManager telephonyManager;
    private NetworkInfo networkInfo;
    private String networkStauts = "Not connected !!";

    //************************************
    @Override
    public void onReceive(Context context, Intent intent) {

        //Toast.makeText(getApplicationContext(),String.valueOf(isPhoneCalling), Toast.LENGTH_SHORT).show();
        Bundle bundle = intent.getExtras();
        if(null == bundle) return;          

        String phonenumber = intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
        //Log.i(LOG_TAG, CLASS_TAG + "phone number " + phonenumber);
        //Toast.makeText(getApplicationContext(),String.valueOf("phone number " + phonenumber), Toast.LENGTH_SHORT).show();
            tm = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);

            tm.listen(new PhoneStateListener() {                    
                @Override
                public void onCallStateChanged(int state, String incomingNumber) {

                    switch (state) {
                    case TelephonyManager.CALL_STATE_RINGING:
                        Context context = getApplicationContext();
                        Toast.makeText(getApplicationContext(), "RINGING", Toast.LENGTH_SHORT).show();
                        break;
                    case TelephonyManager.CALL_STATE_OFFHOOK:

                        Toast.makeText(getApplicationContext(), "OFFHOOK", Toast.LENGTH_SHORT).show();

                        isPhoneCalling = true;
                        break;
                    case TelephonyManager. CALL_STATE_IDLE:
                        if (isPhoneCalling) {
                            Toast.makeText(getApplicationContext(),
                                    "Your call is disconnected by receiver", 10000)
                                    .show();
                            Intent i = getBaseContext().getPackageManager()
                                    .getLaunchIntentForPackage(
                                             getBaseContext().getPackageName());
                             i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                             startActivity(i);

                             isPhoneCalling = false;
                             //duration=c.getLong(c.getColumnIndex(CallLog.Calls.DURATION));
                             Toast.makeText(getApplicationContext(), "IDLE", Toast.LENGTH_SHORT).show();
                            call();
                        }

                        break;
                    default:
                        Toast.makeText(getApplicationContext(), "1", Toast.LENGTH_SHORT).show();
                        //Log.d(LOG_TAG, CLASS_TAG + "Default: " + state);
                        break;
                    }
                }

            }, PhoneStateListener.LISTEN_CALL_STATE )
            //registerReceiver(phoneInfo, new IntentFilter(Intent.ACTION_NEW_OUTGOING_CALL));
        } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-04T22:30:26.880

这个问题没有解决办法。Android 中没有 API 可以检测到成功发出的出站呼叫。

# android - 在android中的viewflipper中双击缩放imageview

> ID：15364674
> 
> 赞同：0
> 
> 时间：2013-03-12T14:58:09.737
> 
> 标签：android

如何在 viewflipper 中双击缩放图像视图？我想在 viewflipper 的双击时缩放 imageview。谁能告诉我如何在 viewflipper 的 imageview 双击时进行缩放。在此先感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:09:57.000

您可以使用 the`ImageViewZoom`而不是常规的，如此[处](http://blog.sephiroth.it/2011/04/04/imageview-zoom-and-scroll/)`ImageView`所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:22:35.983

您可以使用 GestureListener 来检测 viewflipper 类中的双击。

```
public ZoomingViewFlipper(Context context, AttributeSet attrs) {
    super(context, attrs);  
    gestureDetector = new GestureDetector(context, new GestureListener());
}   

@Override
public boolean onTouchEvent(MotionEvent e) {
    return gestureDetector.onTouchEvent(e);
}     

private class GestureListener extends GestureDetector.SimpleOnGestureListener {

    @Override
    public boolean onDown(MotionEvent e) {
        return true;
    }        
    @Override
    public boolean onDoubleTap(MotionEvent e) {
        //Your method to zoom the imageview    
        return true;
    }
} 
```

对于实际放大，您可以使用[此处](https://stackoverflow.com/questions/6650398/android-imageview-zoom-in-and-zoom-out)的解决方案，或者使用`ImageViewZoom`或编写您自己的方法。

# jakarta-ee - 为 Web 开发人员安装适用于 Eclipse Juno EE 的 AWS 工具包

> ID：15364689
> 
> 赞同：1
> 
> 时间：2013-03-12T14:58:54.417
> 
> 标签：jakarta-ee, amazon-web-services, installation, eclipse-juno, toolkit

我正在尝试为 Web 开发人员安装适用于 Eclipse Juno EE 的 AWS 工具包。一切正常，直到我到达必须接受安装条款的条款和条件页面。此时，即使我选择“我已阅读并同意条款和条件”选项，FINISH 或 NEXT 按钮也未启用，我无法继续进行。我已经尝试了很多次，但无法理解可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T03:32:09.780

我刚刚为 Java EE Developers 3.7（“Indigo”）的 Eclipse IDE 安装了 aws 工具包，它对我有用。我按照这里给出的简单步骤

[http://docs.aws.amazon.com/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup.html](http://docs.aws.amazon.com/AWSToolkitEclipse/latest/GettingStartedGuide/tke_setup.html)

他们推荐“靛蓝”，所以我的猜测是与“朱诺”不兼容，但我不确定。让我知道它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T09:31:17.433

我在 eclipse 3.7 和 4.2 上都遇到了同样的问题，尝试重新启动，多次重新安装，但在接受许可证后仍然没有启用***Finish按钮。***最后，我没有选择所有模块，而是部分安装了它，幸好它工作正常。

我的安装子集：

**第一个子集**

**第二子集**

**第三子集**

我没有安装安卓。这个过程使它适用于 Eclipse 3.7 (Indigo) 和 Eclipse 4.2 (Juno) 希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T04:57:55.400

如果你更新 eclipse 它应该可以工作。有一个难以重现的错误，但显然已解决。

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=277265](https://bugs.eclipse.org/bugs/show_bug.cgi?id=277265)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-04T02:19:20.813

启用“完成”按钮的另外两个建议；

*   重新启动 Eclipse（错误链接表明添加新站点/存储库是根本问题）
*   单击复选框“隐藏已安装的项目”（错误链接怀疑许可证列表与需要许可证读取更新停止按钮被启用的组件不匹配）

我还为每个 mprabhat 选择了上述“第一个子集”——不知道这是否相关。

还有一点可以加快您的速度：不需要单击每个许可证/滚动到底部以启用“完成”按钮...因为您可能已经第一次这样做了:)

# if-statement - 匹配if语句excel

> ID：15364690
> 
> 赞同：0
> 
> 时间：2013-03-12T14:58:55.587
> 
> 标签：if-statement, excel-2010

我正在尝试将 c 列中的术语员工与 e 列中所有公司员工的主列表进行匹配，其中包含以下内容：

```
=IF(MATCH(C2,$E$2:$E$13691,0),"N", "Y") 
```

该公式正确返回 N，但不是 YI，而是得到 #N/A ref 错误。
有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:07:53.197

为了`=match()`工作，您引用的单元格的值必须准确。此外，match 函数仅提供查询词在搜索数组中的位置。所以，如果你做对了，它会返回一个大于 0 的值，我们可以利用它来发挥我们的优势。您的`=if()`功能需要进行逻辑测试才能工作；如果`match`返回一个数字，则表示它在主列表中找到了匹配项。我们可以测试这个数字，`if`看看它是否大于 0（它将是）；你应该得到`"y"`.

尝试这个：`=if(match(c2,$e:$e,0)>0,"y","n")`

此外，另一个问题可能在于从 cols`C`到`E`. 你在用名字吗？如果是，这是一个不好的做法；输入文本字符串时可能会弄乱太多变量。尝试使用身份证号码而不是姓名。然后，您可以使用`=VLOOKUP()`直接引用您的员工姓名并将其与员工 ID 号匹配。这将在不同工作表的工作簿中工作。

您*可以*尝试进行字符串匹配。但是，我建议您切换到身份证号码。

# php - PHP mysql 将图像插入/上传到数据库/服务器命名问题

> ID：15364695
> 
> 赞同：1
> 
> 时间：2013-03-12T14:59:11.467
> 
> 标签：php, mysql, insert, naming

我正在构建一个表单，允许用户将图像上传到数据库中，作为眼科医生应用程序的一部分。我的问题涉及包含这些图像信息的表格（`shot`表格），该表格的列是：

`ID | Visit_ID | Patient_ID | Img_Filename | Shrunk_img_filename | Subdir | SubSubDir|`

因此该表仅存储有关图像的信息。图像文件以特定约定命名。例如，列`0000288964r.jpg`中的文件名是什么`Img_filename`样的。下一列中的文件名`Shrunk_img_filename`相同，除了`r`替换为 an`s`并且格式为`.bmp`. 例如，`0000288964s.bmp`。文件名中的这些数字来自`ID`该表的列，根据数字的位数，在开头添加可变数量的零`ID`。

另外，在我的表单中，我有一个文件上传输入，用户可以在其中选择要上传的图像。这就是我的问题出现的地方..

我想使用相同的文件名，如上所示，这些文件名存储在我的数据库中，作为这些图像上传到我的服务器时的文件名，但我不手动浏览数据库查找下一个可用的图像的 ID 并在选择要上传的图像时重命名图像。

我真的不知道这是否可能，但我很想听听有关如何使这项工作或任何解决方法的任何想法。谢谢。我将在下面包含我的代码（由于用于创建我的文件名的 2 个 CASE 语句，我的插入语句非常长，所以我只包含了它的 jist）

```
<?php
include('db.php');
if (isset($_FILES['myfile']) && isset($_GET['id'])) 
{
    $filename = $_FILES['myfile']['name'];
    $filetype = $_FILES['myfile']['type'];
    $filesize = $_FILES['myfile']['size'];
    $filetmp = $_FILES['myfile']['tmp_name'];
    $fileerror = $_FILES['myfile']['error'];
    $id = $_GET['id'];

if ( $fileerror > 0){
die("Error Uploading File Code $fileerror.");
}
else
{
move_uploaded_file($filetmp,"C:/wamp/www/vixer/images/".$filename);
echo "Upload Complete!";
}

$sqlvisit="INSERT INTO shot (VISIT_ID, PATIENT_ID, IMG_FILENAME, SHRUNK_IMG_FILENAME, SUBDIR, SUBSUBDIR, IMG_FILE_FORMAT, EYE) SELECT (SELECT max(ID) from visit where visit.patient_id =" . $id ."), " . $id . ", (SELECT CASE blah blah), (SELECT CASE blah blah), '9', '1', '124', '0' FROM SHOT WHERE shot.patient_id = " . $id . "";
mysql_query($sqlvisit);
}
?>

<form id="form3" action="" method="post" enctype="multipart/form-data" style="display:none;width:300px;background-color: #FFFFFF;"> 
Upload Image(s)..<input type="file" name="myfile"><br />
<input type="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T14:49:06.163

我想我基本上做了prodigitalson建议的...

我`include()`调用了一个插入新镜头的 php 文件（与我的问题中的查询相同）

然后我`include()`再次调用另一个 php 文件，该文件选择我刚刚插入的新行并将结果行的每一列分配给变量，然后分配给会话变量

然后在我的脚本中使用会话变量，该脚本使用 将图像上传到我的服务器，`image filename`并基于我的`shrunk image filename`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T10:43:37.113

最简单的方法是只使用 2 个单独的目录 Images/R 和 Images/S。将缩小后的图像设置为保存在相关位置。然后，您可以根据是否需要常规大小或更小来设置文件路径。

# java - BufferedReader 由 HTTPClient 终止

> ID：15364696
> 
> 赞同：0
> 
> 时间：2013-03-12T14:59:13.243
> 
> 标签：java, android, http

所以我有一个服务器和一个客户端。

服务器发送如下

```
public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException        
   StringBuilder builder = new StringBuilder();
   resp.setContentType("text/plain");

      DO A LOT OF THINGS AND WRITE IT INTO ONE JSONARRAY

   builder.append(JsonArray.toString());
   resp.getWriter().println(builder);
} 
```

客户收到如下：

```
 private class GetXMLTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {
        String output = null;
        for (String url : urls) {
            output = getOutputFromUrl(url);
        }
        return output;
    }

    private String getOutputFromUrl(String url) {
        String output = null;
        try {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(url);

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();

            InputStream in = httpEntity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(in));

            String line = "";
            StringBuilder builder = new StringBuilder();

            while ((line = reader.readLine()) != null) {
                builder.append(line + "\n");
            }
            Log.i("Test", builder.toString());
            in.close();

            httpClient.getConnectionManager().shutdown();
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return output;
    } 
```

客户端从异步任务中获取数据。

问题是客户端接收到的不是来自服务器的全部发送。我试图制作一个 reader.read()，但也有同样的问题。

如果我尝试通过浏览器获取代码，我会收到来自服务器的所有数据，但在我的 java 应用程序中却没有。所以服务器完全正确，也许我可以更改 jsonarray 并在每个 jsonobject 之后添加一个 \n。

会不会是logcat有问题，因为字符串有问题，因为字符串太长了？

谢谢你的帮助。

编辑： [在 HTTP GET 请求后关闭，结果字符串被截断 - 内容已被消耗](https://stackoverflow.com/questions/2744110/after-http-get-request-the-resulting-string-is-cut-off-content-has-been-consu)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:10:00.557

在方法“getOutputFromUrl”中没有分配给“输出”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:17:12.103

```
 resp.getWriter().println(builder); 
```

刷新您的响应编写器并关闭它以确保将整个字符串一致地写入套接字。此外，在返回之前分配输出的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T17:34:06.090

问题是：

Stringbuilder 拥有一切，但 LogCat 无法显示此内容。

[在 HTTP GET 请求之后，结果字符串被截断 - 内容已被消费](https://stackoverflow.com/questions/2744110/after-http-get-request-the-resulting-string-is-cut-off-content-has-been-consu)

这是同样的问题。

因此，为了在 LogCat 中显示字符串生成器，我制作了子字符串。

```
builder.substring(0,4000);
builder.substring(0,builder.length()); 
```

感谢您的帮助！

# symfony - 无法在冻结的 ParameterBag 上调用 set()

> ID：15364698
> 
> 赞同：9
> 
> 时间：2013-03-12T14:59:16.617
> 
> 标签：symfony

在我的 config.yml 我有这个：

```
parameters:
    gitek.centro_por_defecto: 1 
```

现在，我想使用表单从我的控制器更改此值，如下所示：

```
public function seleccionAction(Request $request)
{
  $entity  = new Centro();
  $form = $this->createForm(new SeleccionType(), $entity);
  $centro = $this->container->getParameter('gitek.centro_por_defecto');

  if ($this->getRequest()->getMethod() == 'POST') {
    $form->bind($this->getRequest());
    if ($form->isValid()) {
      $miseleccion = $request->request->get('selecciontype');
      $this->container->setParameter('gitek.centro_por_defecto', $miseleccion['nombre']);

      // return $this->redirect($this->generateUrl('admin_centro'));
    }
  }

  return $this->render('BackendBundle:Centro:seleccion.html.twig', array(
    'entity' => $entity,
    'form'   => $form->createView(),
    ));
} 
```

我`Impossible to call set() on a frozen ParameterBag.`一直在出错。任何帮助或线索？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T15:42:51.223

You can't modify Container once it has been compiled, which is done before invoking the controller.

The DIC parameters are intended for configuration purposes - not a replacement for global variables. In addition it seems you want to persist some kind of permanent modification. In that case consider using session if it's a per-user modification or persisting it (e.g. into DB) if it's supposed to be application-wide.

If you need to modify DIC parameters or services, you can do so using a compiler pass. More info on how to write custom compiler passes can be found at: [http://symfony.com/doc/master/cookbook/service_container/compiler_passes.html](http://symfony.com/doc/master/cookbook/service_container/compiler_passes.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2019-01-29T09:29:10.293

您可以设置 $_ENV 变量并在之后获取

```
putenv("VAR=1"); 
```

并得到

```
getenv("VAR"); 
```

# jquery - 带有 jquery ui 的意外布局

> ID：15364701
> 
> 赞同：1
> 
> 时间：2013-03-12T14:59:20.230
> 
> 标签：jquery, html, jquery-ui

我正在尝试使用 jquery ui 开发页面。一切看起来都很好，除了在菜单>饮料部分下，最后一个定义列表显得不合适。第一个单独出现在中间的一排，而最后一个单独出现在左侧的一排。你可以[在这里查看](http://jsbin.com/eviber/1/edit)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:07:27.667

看起来不错，因为您将它们全部浮动。这就是我期望发生的事情。如果您希望它们在超出 div 的宽度时能够下拉到下一行，请将 dl CSS 更改为：

```
dl{
    display:inline-block;
    vertical-align:top;
    padding-right: 10px;
} 
```

**[jsbin 示例](http://jsbin.com/eviber/3/)**

# c++ - istringstream 不标记引号之间的文本

> ID：15364702
> 
> 赞同：0
> 
> 时间：2013-03-12T14:59:25.007
> 
> 标签：c++, stringstream

我`istringstream`用来打破字符串的标记。假设我有一个这样的字符串：

```
print "this is a test" 
```

它将它分成 5 个标记：

> 打印 | “这 | 是 | 一个 | 测试”

它应该在哪里生成 2 个令牌：

> 打印 | “这是一个测验”

有什么好的方法可以解决吗？我尝试通过在文本中查找引号并执行子字符串来手动执行此操作，但工作量太大。

我想应该有一个更简单的方法，或者是`istringstream`这样做的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:14:22.427

您可以使用`wordexp`它来执行此操作，但它有限制，因为它使用命令 shell 进行解析。特别是，它会对处理重定向的 shell 符号做出不良反应。它还将进行环境变量扩展，这可能是也可能不是您想要的。

```
wordexp_t result;
wordexp(cmdstr.c_str(), &result, 0);
for (int i = 0; result.we_wordv[i]; ++i) {
    //...
}
wordfree(&result); 
```

可以在[`wordexp`手册页](http://linux.die.net/man/3/wordexp)中找到详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:01:07.627

那么 iostreams 通过 .. 标记进行标记。在这种情况下，标记用空格分隔。您将不得不逐行阅读（或者可能是整件事！）并自己正确解析它。

# python - django linke web2py 中是否有 SQLFORM.smartgrid 模块？

> ID：15364703
> 
> 赞同：1
> 
> 时间：2013-03-12T14:59:25.490
> 
> 标签：python, django, web2py

django 中是否有像 web2py 这样的 SQLFORM.smartgrid 模块？

```
def index():
    return dict(grid=SQLFORM.grid(query)) 
```

# xquery - 在 xquery 中添加默认命名空间

> ID：15364706
> 
> 赞同：0
> 
> 时间：2013-03-12T14:59:30.683
> 
> 标签：xquery

我有一个从 a.xml 转换为 b.xml 的 xquery 文件。下面是我的 x 查询的示例：

```
<TestMessage>
    <Header>
      <MessageType>
           {for $x in doc("input.xml")//Test/NewHeader return 
        if ($x/MessageType/text() = "FIRST") then "FirstMessageType"
        else "SecondMessageType"
    }   
      </MessageType>
    </Header>
 </TestMessage> 
```

这可以正常工作并正确填充我的 MessageType。但我需要将命名空间作为属性添加到 TestMessage 元素。所以，当我这样做时，

```
<TestMessage xmlns="http://www.testsource.com/TestMessage">
    <Header>
      <MessageType>
           {for $x in doc("input.xml")//Test/NewHeader return 
        if ($x/MessageType/text() = "FIRST") then "FirstMessageType"
        else "SecondMessageType"
    }   
      </MessageType>
    </Header>
 </TestMessage> 
```

xquery 结果有一个空的 MessageType 元素。除了在 x-query 文档中添加命名空间外，我没有更改任何内容。但我不明白为什么这会给我一个错误的结果 xml。

任何帮助将不胜感激。

多谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:06:54.817

当您向`TestMessage`元素添加默认命名空间时，该命名空间也将应用于您在其下执行的 XPath：`doc("input.xml")//Test/NewHeader`和`($x/MessageType/text()`.

如果该内容没有命名空间，那么最简单的做法是在 XML 根目录中声明命名空间前缀: `xmlns:test="http://www.testsource.com/TestMessage`，并为所有元素添加前缀: `<test:TestMessage xmlns:test="http://www.testsource.com/TestMessage>`，`<test:Header>`依此类推。

解决此问题的一种方法是在默认命名空间 XML 之外执行无命名空间 XQuery 代码：

```
declare function local:get-message-type()
{
  for $x in doc("input.xml")//Test/NewHeader 
  return 
    if ($x/MessageType/text() = "FIRST") 
    then "FirstMessageType"
    else "SecondMessageType"
};

<TestMessage xmlns="http://www.testsource.com/TestMessage">
    <Header>
      <MessageType>
           { local:get-message-type() }   
      </MessageType>
    </Header>
</TestMessage> 
```

# shell - awk linux shell 似乎错误

> ID：15364709
> 
> 赞同：0
> 
> 时间：2013-03-12T14:59:39.667
> 
> 标签：shell, awk

我不是 linux shell 命令的大师，我有一点可能了解我的命令有什么问题：

当我运行这个

```
netstat -lptn | cut -d : -f 2,3,4,5,6,7 
```

结果是；

```
Proto Recv-Q Send-Q Adresse locale          Adresse distante        Etat       PID/Program name
631           0.0.0.0:*               LISTEN      853/cupsd       
445             0.0.0.0:*               LISTEN      803/smbd        
139             0.0.0.0:*               LISTEN      803/smbd        
53            0.0.0.0:*               LISTEN      1394/dnsmasq    
:1:631                 :::*                    LISTEN      853/cupsd       
::445                  :::*                    LISTEN      803/smbd        
::139                  :::*                    LISTEN      803/smbd 
```

好的，现在我添加额外的命令“awk”来过滤结果：

```
netstat -lptn | cut -d : -f 2,3,4,5,6,7 |awk 'BEGIN {res="Down"} /^445.*smbd$/ {res=$3} END {print res} 
```

但结果显示`down`尽管第二行符合模式：

```
445             0.0.0.0:*               LISTEN      803/smbd 
```

那么为什么我不能有好的结果呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:11:32.517

你有

```
/^445.*smbd$/ 
```

但看看第二行，后面有空格/制表符`smbd`。所以它不会匹配。

尝试这个：

```
.......|awk 'BEGIN {res="Down"} /^445.*smbd\s*$/ {res=$3} END {print res}' 
```

以您的示例数据作为输入，上面的 awk 打印

```
LISTEN 
```

# jqgrid - jqGrid在保存之前验证数据时按下输入键并在esc之前确认

> ID：15364711
> 
> 赞同：0
> 
> 时间：2013-03-12T14:59:47.973
> 
> 标签：jqgrid

我正在尝试在网格中使用内联编辑，保存/编辑/取消/删除按钮是自定义的，对于需要在保存之前调用的每一列，我都有几个验证函数，我正在制作一个将被调用的函数按行上的输入，但是即使我在successfunc上返回false，我似乎也无法阻止它保存。

```
$grid.editRow(id,{
    keys : true,
    successfunc : function(data){
        saveData(data);
        return [false,""];       
    }
}); 
```

PS：在每列上定义的编辑规则对我没有帮助，因为我希望仅在保存时调用我的验证

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:34:22.797

在这种情况下，我认为您的验证有点晚了。

来自：[http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:inline_editing](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:inline_editing)

succesfunc：如果定义，则请求成功后立即调用此函数。该函数传递从服务器返回的数据。取决于来自服务器的数据；此函数应返回 true 或 false。

您是否在让 Save 发生之前进行验证？

# c++ - 在c ++中使用正则表达式匹配来确定是否二进制

> ID：15364712
> 
> 赞同：1
> 
> 时间：2013-03-12T14:59:51.700
> 
> 标签：c++, regex, binary, matching

我正在尝试在 c++ 中使用正则表达式来确定字符串是否仅包含二进制（1/0）。我在java中使用 .matches("[01]+") 非常简单地做到了这一点。但是现在当我尝试转换为 c++ 时，我遇到了问题

我正在使用 Visual Studio 2010 并收到此错误

错误：没有重载函数“regex_match”的实例与参数列表匹配

这是我的代码

```
#include <iostream>
#include <string>
#include <regex>
using namespace std;

// ...

string bFU;
do
{
    cout << "\nEnter a binary value containing up to 16 digits: ";
    getline (cin, bFU);
    if (!regex_match(bFU, "[01]+") || bFU.length()>16)
    {
        cout << "\nError: Invalid binary value.\nTry again.\n"
                "Press Enter to continue ... ";
        bFU = "a";
        cin.ignore(80, '\n');
    }
} while (!regex_match(bFU, "[01]+")); 
```

在 Visual Studio 中，当我将鼠标悬停在带有红色下划线的 regex_match 上时，我会收到该错误

感谢您的帮助，我一直在谷歌搜索和整理几十个网站，这让问题变得更加模糊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:04:04.657

`regex_match`正则表达式采用 a`std::basic_regex`而不是字符串。

有关可用的重载和使用示例，请参见[此处](http://en.cppreference.com/w/cpp/regex/regex_match)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:05:14.647

如果您检查[参考资料，`regex_match`](http://en.cppreference.com/w/cpp/regex/regex_match)您会发现您传递的参数与函数实际采用的参数不匹配。

请参阅参考中的示例以了解如何使用该`regex_match`功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:59:26.720

这是我编写程序的方式：

```
#include <iostream>
#include <string>
#include <regex>
using namespace std;

int main()
{
   const basic_regex<char> binmatcher("[01]+");
   string bFU;
   for (bool matched = false; !matched;)
   {
      cout << "\nEnter a binary value containing up to 16 digits: ";
      getline(cin, bFU);
      matched = regex_match(bFU, binmatcher);
      if (!matched || bFU.length()>16)
      {
         cout << "\nError: Invalid binary value.\nTry again.\n"
            "Press Enter to continue ... ";
         cin.ignore(80, '\n');
      }
   }
   cout << "The binary value I found acceptable was: " << bFU << '\n';
   return 0;
} 
```

不幸的是，我无法真正测试这一点，因为 g++ 4.7.2 中的正则表达式支持被破坏了。

如您所见，`regex_match`不带字符串。也不应该。编译正则表达式通常比使用正则表达式的计算密集度要高得多。

Perl 非常快，因为它在第一次遇到正则表达式时就编译它们，这是对您隐藏的步骤，并且在某些情况下会导致令人惊讶的结果（例如在运行时生成表达式时）。

这[是`::std::regex_match`](http://en.cppreference.com/w/cpp/regex/regex_match). 在这种情况下，您想要的重载是重载 6，它以 a`::std::string`和 a`::std::basic_regex`作为参数。

# button - 无法使用 html5boilerplate 隐藏兼容性按钮

> ID：15364726
> 
> 赞同：0
> 
> 时间：2013-03-12T15:00:40.343
> 
> 标签：button, html5boilerplate, compatibility-mode

我在stackoverflow上遇到了很多问题，但我无法让它工作。

我正在使用带有一点 WP PHP 的 html5boilerplate，我想知道这是否可能是我无法在 IE 中隐藏兼容性按钮的原因？还是我全都弄错了并且`<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">`不起作用？

这是应该首先出现的 HTML：

```
<?php
/**
 * The Header for our theme.
 *
 * Displays all of the <head> section and everything up till <div id="main">
 *
 * @package WordPress
 * @subpackage Twenty_Ten
 * @since Twenty Ten 1.0
 */
?><!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html <?php language_attributes(); ?>>
<head>
<meta charset="<?php bloginfo( 'charset' ); ?>" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
```

有任何想法吗？泰...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T21:38:02.763

您应该查看相关的 Github 问题[https://github.com/h5bp/html5-boilerplate/issues/378](https://github.com/h5bp/html5-boilerplate/issues/378)

似乎您需要将标签的位置移动到 IE 条件注释之前

```
<!doctype html>
<html lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <!--[if lt IE 9]><html class="oldie"><![endif]-->
        <meta charset="utf-8">
        <title>Document</title>
    </head>
    <body>
    </body>
</html> 
```

# php - 如何从 html 表中获取数据并将其放入 php 文本字段中？

> ID：15364727
> 
> 赞同：0
> 
> 时间：2013-03-12T15:00:46.553
> 
> 标签：php, javascript, jquery

这是我创建的表：

```
 <table class="table table-striped table-bordered" id="example">
    <thead>
    <?php
        foreach ($fields as $field_name => $field_display){
             echo "<th>".$field_display."</th>";
        }
    ?>
    </thead>
    <tbody>
    <?php
        foreach ($users as $row){
        echo "<tr>";
        foreach($fields as $field_name => $field_display){
            if($field_name == 'username'){
            echo "<td><a href='#' onclick=\"edituserdata('".$row->username."')\">".$row->$field_name."</a></td>";
        }else{
            echo "<td>".$row->$field_name."</td>";
        }
        }
        echo "</tr>";
        }
    ?>
    </tbody>
    </table> 
```

这是我单击一行时出现的引导模式：

```
 <!-- Modal -->
<div id="myModal1" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
<h3 id="myModalLabel">Update you're data</h3>
</div>
<div class="modal-body">
        <?php echo form_open('main/update'); ?>

        <?php 

        $name = array(
                'name' => 'name',
                'id' => 'name',
                'value' => set_value('name')
        );
        ?>

        <div class="control-group">
            <label class = "control-label" for="name">Name:</label>
            <div>
                <input type="text" name="name" placeholder="Name" id="name" value="">
                <?php echo form_error('name', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Username:</label>
            <div>
                <input type="text" name="username" placeholder="Username" id="username" value="">
                <?php echo form_error('username', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Password: </label>
            <div>
                <input type="password" name="password" placeholder="Password" id="password" value="">
                <?php echo form_error('password', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Retype password: </label>
            <div>
                <input type="password" name="password1" placeholder="Retype password" id="password1" value="">
                <?php echo form_error('password1', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Email address: </label>
            <div>
                <input type="email" name="email" placeholder="Email" id="email" value="">
                <?php echo form_error('email', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Phone number: </label>
            <div>
                <input type="tel" name="tel" placeholder="Phone number" id="phone_number" value="">
                <?php echo form_error('tel', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

        <div class="control-group">
            <label class = "control-label" for="name">Description: </label>
            <div>
                <input type="text" placeholder="Description" name="descr" id="description" value="">
                <?php echo form_error('descr', '<span class="alert-error help-inline">', '</span>')?>
            </div>
        </div>

</div>
<div class="modal-footer">
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span5" id="message_add_user_id">
        </div>

        <div class="span7">
            <button id="add_user_submit" type="button" class="btn btn-success">Update <i class="icon-white icon-check"></i> </button>
            <button class="btn" onClick="document.location.reload(true)" data-dismiss="modal" >Close</button>
        </div>          
    </div>
</div>
<?php echo form_close();?> 
```

这是模态将出现的功能：

```
 function edituserdata(username){
      $('#myModal1').modal('show');
    } 
```

当我点击一行时，我想让该用户的数据进入引导模式的文本字段。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T15:54:47.387

您可能希望像这样通过 ajax 完成所有操作：

**表格html页面**

```
<table class="table table-striped table-bordered" id="example">
    <thead>
    <?php
        foreach ($fields as $field_name => $field_display){
            echo "<th>$field_display</th>";
        }
    ?>
    </thead>
    <tbody>
    <?php
        foreach ($users as $row){
            echo "<tr>";
            foreach($fields as $field_name => $field_display){
                if($field_name == 'username'){
                    echo "<td><a href='#' onclick=\"edituserdata('".$row->username."')\">".$row->$field_name."</a></td>";
                } else {
                    echo "<td>".$row->$field_name."</td>";
                }
            }
            echo "</tr>";
        }
    ?>
    </tbody>
</table>   

<!-- Modal -->
<div id="myModal1" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Update you're data</h3>
    </div>
    <div class="modal-body">

        <!-- NOTE THE EMPTY MODAL -->

    </div>
    <div class="modal-footer">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span5" id="message_add_user_id">
                </div>

                <div class="span7">
                    <button id="add_user_submit" type="button" class="btn btn-success">Update <i class="icon-white icon-check"></i> </button>
                    <button class="btn" onClick="document.location.reload(true)" data-dismiss="modal" >Close</button>
                </div>          
            </div>
        </div>
    </div>
</div> 
```

**阿贾克斯页面**

```
<?php echo form_open('main/update'); ?>

<?php 
    // TODO get username from $_GET['username'] and then retrieve all user information from db
    // TODO echo user data into form fields

    $name = array(
            'name' => 'name',
            'id' => 'name',
            'value' => set_value('name')
    );
    ?>

    <div class="control-group">
        <label class = "control-label" for="name">Name:</label>
        <div>
            <input type="text" name="name" placeholder="Name" id="name" value="">
            <?php echo form_error('name', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Username:</label>
        <div>
            <input type="text" name="username" placeholder="Username" id="username" value="">
            <?php echo form_error('username', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Password: </label>
        <div>
            <input type="password" name="password" placeholder="Password" id="password" value="">
            <?php echo form_error('password', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Retype password: </label>
        <div>
            <input type="password" name="password1" placeholder="Retype password" id="password1" value="">
            <?php echo form_error('password1', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Email address: </label>
        <div>
            <input type="email" name="email" placeholder="Email" id="email" value="">
            <?php echo form_error('email', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Phone number: </label>
        <div>
            <input type="tel" name="tel" placeholder="Phone number" id="phone_number" value="">
            <?php echo form_error('tel', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

    <div class="control-group">
        <label class = "control-label" for="name">Description: </label>
        <div>
            <input type="text" placeholder="Description" name="descr" id="description" value="">
            <?php echo form_error('descr', '<span class="alert-error help-inline">', '</span>')?>
        </div>
    </div>

<?php echo form_close();?> 
```

**表格页面上的 Javascript**

```
<script>
    function edituserdata(username) {
        $.get('url-to-ajax-page', {username: username}, function(resp) {
            $('#myModal1 .modal-body').html(resp);
            $('#myModal1').modal('show');
        });
    }
</script> 
```

我们在这里所做的是有一个带有用户名的表。当您单击用户名时，它会对使用用户数据填充表单数据并在模式中显示的页面进行 ajax 调用。

所以这应该让你开始。在提交表单时，我没有时间写出其余的内容，但是您要做的是在他们单击提交按钮时进行另一个 ajax 查询，这会将数据发布到可能相同的 ajax url。如果发布的数据中有错误，则当数据返回时，您将模型主体的内容替换为 ajax 响应，否则关闭窗口。

# r - 从列表中引用 igraph 的布局函数

> ID：15364729
> 
> 赞同：2
> 
> 时间：2013-03-12T15:00:54.567
> 
> 标签：r, list, reference, igraph

我希望能够从列表中引用一个函数。使用此代码，我想自动导出具有不同布局的图形。我正在使用 igraph 库。

问题是我得到了函数的文本而不是对函数的引用。

您能否提供一些代码更改以使其正常工作？

```
library(igraph)
g2 <- barabasi.game(100)
layouts = list(layout.auto, 
        layout.random, 
        layout.circle, 
        layout.sphere, 
        layout.fruchterman.reingold, 
        layout.kamada.kawai, 
        layout.spring, 
        layout.reingold.tilford, 
        layout.fruchterman.reingold.grid, 
        layout.lgl, 
        layout.graphopt, 
        layout.svd, 
        layout.norm)
for(i in layouts) {
    plot.igraph(g, layout=i, vertex.label=NA, vertex.size=3, edge.color="darkblue", edge.lty=3)
    dev.copy(png,paste("figures/network_v0.1_",substitute(i),".png",sep=""))
    dev.off()
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T15:32:20.793

如果将实际的函数对象放入列表中，则无法再找到它们的名称。函数对象不存储它们的名称，AFAIK。您需要使列表成为命名列表，或者简单地收集函数名称：

```
library(igraph)
g <- barabasi.game(100)
layouts = c("layout.random",
  "layout.circle",
  "layout.sphere",
  "layout.fruchterman.reingold",
  "layout.kamada.kawai",
  "layout.spring",
  "layout.reingold.tilford",
  "layout.fruchterman.reingold.grid",
  "layout.lgl",
  "layout.graphopt",
  "layout.svd")

for (alg in layouts) {
  print(alg)
  coords <- do.call(alg, list(g))
  png(paste("figures/network_v0.1_", alg, ".png", sep=""))
  plot.igraph(g, layout=coords, vertex.label=NA,
              vertex.size=3, edge.color="darkblue", edge.lty=3)
  dev.off()
} 
```

一些评论。`layout.norm`不是布局功能。`layout.auto`只需根据图形的大小和其他属性调用其他布局函数之一。你错过了一些布局功能，例如`layout.drl`和其他。以下是如何列出所有这些，然后您可以过滤掉不需要的那些：

```
grep("^layout\\.", ls("package:igraph"), value=TRUE)
#  [1] "layout.auto"                      "layout.bipartite"                
#  [3] "layout.circle"                    "layout.drl"                      
#  [5] "layout.fruchterman.reingold"      "layout.fruchterman.reingold.grid"
#  [7] "layout.graphopt"                  "layout.grid"                     
#  [9] "layout.grid.3d"                   "layout.kamada.kawai"             
# [11] "layout.lgl"                       "layout.mds"                      
# [13] "layout.merge"                     "layout.norm"                     
# [15] "layout.random"                    "layout.reingold.tilford"         
# [17] "layout.sphere"                    "layout.spring"                   
# [19] "layout.star"                      "layout.sugiyama"                 
# [21] "layout.svd" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:18:47.090

我会做`do.call(layouts[i], list(g))`where`layouts`是一个向量（如下所示）并且`g`是你的图表。

```
library(igraph)
g <- barabasi.game(100) #example graph
layouts = c("layout.auto", 
        "layout.random", 
        "layout.circle", 
        "layout.sphere", 
        "layout.fruchterman.reingold", 
        "layout.kamada.kawai", 
        "layout.spring", 
        "layout.reingold.tilford", 
        "layout.fruchterman.reingold.grid", 
        "layout.lgl", 
        "layout.graphopt", 
        "layout.svd", 
        "layout.norm")

for(i in layouts) {
    plot.igraph(g, layout=get(i), vertex.label=NA, vertex.size=3, 
              edge.color="darkblue", edge.lty=3)
    dev.copy(png,paste("figures/network_v0.1_",i,".png",sep=""))
    dev.off();
} 
```

`layout.spring`, `layout.graphopt`, layout.svd layout.norm``and`给出错误（可能需要额外的参数）。我会把它留给你（因为你的问题是关于从列表/向量中获取函数内的布局矩阵）。

# php - 带有 .htaccess 的 php 配置文件

> ID：15364730
> 
> 赞同：0
> 
> 时间：2013-03-12T15:00:54.707
> 
> 标签：php, .htaccess

我创建了一个登录系统，用户可以通过插入电子邮件和密码登录到应用程序。在用户创建他的个人资料页面并设置他的时间表后，以下代码将在屏幕上打印他的个人资料，没有任何错误。这是打印个人资料页面的代码：

```
<?php
   if(  isset($_GET['email']) === true  &&  empty($_GET['email']) === false  ){

    $email = $_GET['email'];

  if(user_exists($email) === true) {

        $user_id = user_id_from_email($email);
        $profile_data = user_data($user_id,'name','surname','email');
?>

<h1><font size="5"><?php echo $profile_data['name'];?> <?php echo $profile_data['surname']; ?> </font></h1>

<a href="profile_timetable.php" >Timetable</a>

<?php

}else {
    echo 'Sorry, that user does not exist!';
}
  }else{
     header('Location: index.php');
     exit();
   } 
```

我也有一个 .htaccess 文件，它是这样的：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /work/profile.php?email=$1 
```

这是打印时间表页面的代码：

```
<?

if(  isset($_GET['email']) === true  &&  empty($_GET['email']) === false  ){

$email = $_GET['email'];

    if(user_exists($email) === true) {

       $user_id = user_id_from_email($email);

       $profile_data_timetable = $user_data_profile_timetable($user_id,'hour_start_1','minute_start_1','hour_finish_1','minute_finish_1','activity_1');

?>

<font size="5"> 
    <?php echo $user_data_profile_timetable['hour_start_1']; ?> 
    <?php echo $user_data_profile_timetable['minute_start_1']; ?> 
    <?php echo $user_data_profile_timetable['hour_finish_1']; ?> 
    <?php echo $user_data_profile_timetable['minute_finish_1']; ?> 
    <?php echo $user_data_profile_timetable['activity_1']; ?> 
</font>

<?php
  }else {
echo 'Sorry, that user does not exist!';
}
 }else{
header('Location: index.php');
exit();
 } 
```

我的问题是，如果我单击“时间表链接”来获取用户的时间表，我只会得到一个空屏幕（可能会重定向到 index.php，这是一个空页面）。我该如何解决这个问题，以便链接能够正常工作并打印用户的时间表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:15:29.760

哟应该编辑链接重新发送电子邮件

链接会去，`profile_timetable.php`但它应该去`profile_timetable.php?email=fooo@foo.fo`

你可以试试这个：

```
<a href="profile_timetable.php?email=<?php echo $email; ?>" >Timetable</a> 
```

我注意到您没有检查提交的电子邮件是否具有有效格式，请小心注入！

您可以简单地使用`if(filter_var($email, FILTER_VALIDATE_EMAIL))`检查电子邮件格式或使用正则表达式

# memory-leaks - PHP-FPM 占用太多内存

> ID：15364735
> 
> 赞同：8
> 
> 时间：2013-03-12T15:00:59.470
> 
> 标签：memory-leaks, php

我将 Nginx+PHP-FPM 与 php 5.3.6 一起使用，它运行了好几个星期。突然，每个 PHP-FPM 子进程开始占用太多内存。在最初的几周里，每个 PHP-FPM 孩子曾经占用 3MB，现在很少有孩子占用 700MB。有人可以指导吗？

```
This script I used to get memory usage by child pid 
 http://www.pixelbeat.org/scripts/ps_mem.py.

It could be verified by 'top' method too

top output::
------------------------------
------------------------------
28419 daemon    20   0  844m 757m 4200 S    0  6.4   0:14.27 php-fpm                                                          

16788 daemon    20   0  700m 614m 4632 S    0  5.2   0:28.34 php-fpm                                                          

29450 daemon    20   0  669m 581m 3548 S    0  4.9   0:08.31 php-fpm                                                          

17881 daemon    20   0  642m 556m 4108 S    0  4.7   0:14.83 php-fpm                                                          

19048 daemon    20   0  642m 555m 4108 S    0  4.7   0:08.86 php-fpm 
11956 daemon    20   0 97612  10m 5476 S    4  0.1   0:39.57 php-fpm                                                          
11993 daemon    20   0 97560  10m 5188 S    4  0.1   0:39.18 php-fpm                                                          
11925 daemon    20   0 97328  10m 5144 D    3  0.1   0:38.68 php-fpm                                                          
11953 daemon    20   0 97748  10m 5172 S    4  0.1   0:38.51 php-fpm 
```

php-fpm.conf：

```
/etc/php-fpm/php-fpm.conf
listen = 127.0.0.1:9000
user = daemon
group = daemon

pm = dynamic
pm.max_children = 2000
pm.start_servers = 50
pm.min_spare_servers = 40
pm.max_spare_servers = 90
pm.max_requests = 10000 
```

以下是更多调试输入：

地图::

```
pmap 28419
0000000000b52000     96K rw---    [ anon ]
0000000001a49000   1668K rw---    [ anon ]
0000000001bea000    208K rw---    [ anon ]
0000000001c1e000 770476K rw---    [ anon ] 
```

strace::

```
strace -p 28419
Process 28419 attached - interrupt to quit
restart_syscall(<... resuming interrupted call ...>) = 0
recvfrom(4, 0x1bda1d0, 8196, 64, 0, 0)  = -1 EAGAIN (Resource temporarily unavailable)
poll([{fd=4, events=POLLIN}], 1, 5000)  = 0 (Timeout)
recvfrom(4, 0x1bda1d0, 8196, 64, 0, 0)  = -1 EAGAIN (Resource temporarily unavailable)
poll([{fd=4, events=POLLIN}], 1, 5000^C <unfinished ...> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T19:14:00.340

尝试将 pm.max_requests 降低到 1000，然后根据需要降低。这将在 1000 个请求后终止子进程。当 php-fpm 占用资源时，需要考虑许多变量。我已经使用它很长一段时间了，还没有看到这种级别的内存消耗。我的猜测是代码问题或失控脚本。

# java - JAVA：将 main 拆分为方法并放入另一个类？

> ID：15364751
> 
> 赞同：-5
> 
> 时间：2013-03-12T15:01:21.587
> 
> 标签：java

我需要一点帮助。我正在尝试缩短我的 main() 并将一些代码移动到方法中并将其放在我的另一个类 Contact.java 中。就像读取文件这样的某些事情，我想要一个方法，它只用于读取文件并将其放入 Contact.java 中。写入文件也是如此，我想要一个可以在 main() 中回调的单独方法。我了解如何制作该方法，但是如何将该方法从 Contact.java 调用回 ContactList.java？有什么建议么？

```
import java.io.*;
import java.util.*;

public class ContactList {

public static void main(String args[]) throws IOException {
    Contact contact;
    contact = new Contact();
    int action = 0;

    ArrayList<Contact> contacts = new ArrayList<Contact>();
    while (action != 6) {

        System.out.println("\nWelcome to Contact List DB. "
                + "What would you like to do? \n");

        System.out.println("1\. Enter a new person" + "\n"
                + "2\. Print the contact list" + "\n"
                + "3\. Retrieve a person's information by last name" + "\n"
                + "4\. Retrieve a person's information by email address" + "\n"
                + "5\. Retrieve all people who live in a given zip code" + "\n" 
                + "6\. Exit");
        Scanner reader = new Scanner(System.in);
        reader.useDelimiter("\n");
        action = reader.nextInt();

        if (action <= 0 || action > 6) {
            System.out.println("Invalid selection. ");

        }

        switch (action) {

        case 1: {

            System.out.println("\nEnter Contact Last Name:");
            String lastname = reader.next();
            if (lastname == null) {
                System.out.println("\nInvalid entry. ");
                break;
            } 

            else {
                contact.setLastName(lastname.toLowerCase());
            }
            System.out.println("Enter Contact First Name: ");
            String firstname = reader.next();
            contact.setFirstName(firstname.toLowerCase());
            System.out.println("Enter Contact Street Address: ");
            String address = reader.next();
            contact.setHouseAddress(address.toLowerCase());
            System.out.println("Enter Contact City: ");
            String city = reader.next();
            contact.setCity(city.toLowerCase());
            System.out.println("Enter Contact Zip Code: ");
            String zip = reader.next();
            contact.setZip(zip.toLowerCase());
            System.out.println("Enter Contact Email: ");
            String email = reader.next();
            contact.setEmail(email.toLowerCase());
            System.out.println("Enter Contact Phone Number: ");
            String phone = reader.next();
            contact.setPhone(phone.toLowerCase());
            System.out.println("Enter Contact Notes: ");
            String notes = reader.next();
            contact.setNotes(notes.toLowerCase());

            contacts.add(contact);

            try {

                Contact c = contact;

                File file = new File("contactlist.csv");

                // If file doesn't exists, then create it.
                if (!file.exists()) {
                    file.createNewFile();
                }

                try (PrintWriter output = new PrintWriter(new FileWriter(
                        "contactlist.csv", true))) {
                    output.printf("%s\r\n", c);
                } catch (Exception e) {
                }

                System.out.println("Your contact has been saved.");
            }

            catch (IOException e) {
                e.printStackTrace();        
    }
        }

        break;

        case 2: {

            int counter = 0;
            String line = null;

            // Location of file to read
            File file = new File("contactlist.csv");

            // Sort contacts and print to console
            try {

                Scanner scanner = new Scanner(file);

                // Before printing, add each line to a sorted set. by Seth
                // Copeland
                Set<String> lines = new TreeSet<>();
                while (scanner.hasNextLine()) {
                    line = scanner.nextLine();
                    lines.add(line);
                    counter++;

                }

                // Print sorted contacts to console.
                for (String fileLine : lines) {
                    String outlook = fileLine.substring(0, 1).toUpperCase()
                            + fileLine.substring(1);
                    System.out.println(outlook);

                }

                scanner.close();

            } catch (FileNotFoundException e) {

            }
            System.out.println("\n" + counter + " contacts in records.");

        }

        break;

        case 3:

            try {
                System.out.println("\nEnter the last"
                        + "name to search for: ");
                String searchterm = reader.next();

                // Open the file as a buffered reader
                BufferedReader bf = new BufferedReader(new FileReader(
                        "contactlist.csv"));

                // Start a line count and declare a string to hold our
                // current line.
                int linecount = 0;
                String line;

                // Let the user know what we are searching for
                System.out.println("Searching for " + searchterm
                        + " in file...");
                // Loop through each line, putting the line into our line
                // variable.
                boolean noMatches = true;
                while ((line = bf.readLine()) != null) {
                    // Increment the count and find the index of the word.
                    linecount++;
                    int indexfound = line.indexOf(searchterm.toLowerCase());

                    // If greater than -1, means we found a match.
                    if (indexfound > -1) {
                        System.out.println("\nContact was FOUND\n"
                                + "\nContact " + linecount + ": " + line);
                        noMatches = false;
                    }

                }

                // Close the file after done searching
                bf.close();
                if (noMatches) {
                    System.out.println("\nNO MATCH FOUND.\n");
                }
            }

            catch (IOException e) {
                System.out.println("IO Error Occurred: " + e.toString());
            }

            break;

        case 4:

            try {
                System.out.println("\nEnter the email "
                        + "address to search for: ");
                String searchterm = reader.next();

                // Open the file as a buffered reader
                BufferedReader bf = new BufferedReader(new FileReader(
                        "contactlist.csv"));

                // Start a line count and declare a string to hold our
                // current line.
                int linecount = 0;
                String line;

                // Let the user know what we are searching for
                System.out.println("\nSearching for " + searchterm
                        + " in file...");

                // Loop through each line, put the line into our line
                // variable.
                boolean noMatches = true;
                while ((line = bf.readLine()) != null) {

                    // Increment the count and find the index of the word
                    linecount++;
                    int indexfound = line.indexOf(searchterm.toLowerCase());

                    // If greater than -1, means we found a match
                    if (indexfound > -1) {
                        System.out.println("\nContact was FOUND\n"
                                + "\nContact " + linecount + ": " + line);
                        noMatches = false;
                    }

                }
                // Close the file after done searching
                bf.close();
                if (noMatches) {
                    System.out.println("\nNO MATCH FOUND.\n");
                }

            }

            catch (IOException e) {
                System.out.println("IO Error Occurred: " + e.toString());
            }

            break;

        case 5:

            try {
                System.out.println("\nEnter the Zipcode to search for: ");
                String searchterm = reader.next();

                // Open the file as a buffered reader
                BufferedReader bf = new BufferedReader(new FileReader(
                        "contactlist.csv"));

                // Start a line count and declare a string to hold our
                // current line.
                int linecount = 0;
                String line;

                // Let the user know what we are searching for
                System.out.println("\nSearching for " + searchterm
                        + " in file...");

                // Loop through each line, stashing the line into our line
                // variable.
                boolean noMatches = true;
                while ((line = bf.readLine()) != null) {

                    // Increment the count and find the index of the word.
                    linecount++;
                    int indexfound = line.indexOf(searchterm.toLowerCase());

                    // If greater than -1, means we found a match.
                    if (indexfound > -1) {
                        System.out.println("\nContact was FOUND\n"
                                + "\nContact " + linecount + ": " + line);
                        noMatches = false;
                    }
                }
                // Close the file after done searching
                bf.close();
                if (noMatches) {
                    System.out.println("\nNO MATCH FOUND.\n");
                }
            }

            catch (IOException e) {
                System.out.println("IO Error Occurred: " + e.toString());
            }

            break;
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:11:07.367

首先，尝试将代码拆分为方法：

```
 while (action != 6) {

        printIntro()
        action = getAction();

        switch (action) {

        case 1: {
            contact = readContact()
            contacts.add(contact);

            try {
                writeContact(contact);
                System.out.println("Your contact has been saved.");
            }
            catch (IOException e) {
                e.printStackTrace();        
            }
        }

        break;
        etc. 
```

要将这个东西分成类，首先要确定你拥有的对象。对象通常用名词表示。例如，您有一个联系人列表文件。您可以创建一个具有, ,等`ContactListFile`方法的类。`AddContact``SearchContact``GetContacts`

然后，您可以使用如下代码：

```
contactListFile = new ContactListFile("contactlist.csv");
contact = readContact();
contactListFile.AddContacts(contact); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:08:29.007

[这听起来像是代码审查 Stack Exchange 站点](https://codereview.stackexchange.com/)的候选者，但我的 $.02：将处理每个操作的代码分解为它们自己的方法，并调用这些方法。一旦你得到它，你可以将循环移动到一个名为 runActions() 的方法，然后只需从 main() 调用 runActions()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:15:00.483

在 App 类的这个示例中，我调用了 Test 类的 meth1 方法：

```
class Test{
 public void meth1(){
  System.out.println("meth1 from Test Class");
 }//end of meth1
}//end of class Test
public class App{
 public static void main(String arg[]){
  Test t = new Test();
  t.meth1();
 }//end of main
}//end of class App 
```

# bash - 查找没有搜索词的文件

> ID：15364767
> 
> 赞同：1
> 
> 时间：2013-03-12T15:02:18.987
> 
> 标签：bash

我正在寻找一种快速的方法来搜索数千个日志文件以找到有错误的文件。对我来说不幸的是，只有那些成功完成的会被标记为“作业完成”这个词，而那些崩溃的不会包含这一行。

我将这些作业的确切名称存储为文件名。虽然执行以下操作很有用：

```
grep "Job Completed" * > completeJobs.txt 
```

在我的日志目录中，我真的很想知道不包含此行的作业的文件名。

上面的 grep 命令是否有补充来解决我的问题？

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-30T10:42:19.237

你想要选项`-L`：

> 抑制正常输出；而是打印通常不会打印输出的每个输入文件的名称。

```
grep -L 'Job Completed' * >../jobsNotCompleted 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:08:43.673

您可以使用 -v 开关来反转 grep 搜索。

```
 grep -v "Job Completed" * > incompleteJobs.txt 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-12T15:05:22.000

只需尝试

```
grep -vl 'Job Completed' * > notCompletedJobs.txt 
```

或者

```
grep -v 'Job Completed' * > notCompletedJobs.txt 
```

根据您的需要

## 笔记

来自`man grep`：

> ```
>  -v, --invert-match 
> ```
> 
> 反转匹配的感觉，选择不匹配的行。（-v 由 POSIX 指定。）
> 
> ```
>  -l, --files-with-matches 
> ```
> 
> 抑制正常输出；而是打印通常会从中打印输出的每个输入文件的名称。扫描将在第一次匹配时停止。（-l 由 POSIX 指定。）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-12T15:05:36.650

检查`man`页面，您可以使用 -v 选项反转匹配

```
grep -v "Job Completed" * > uncompletedJobs.txt 
```

# python - 在 Tornado 中为 http 请求设置超时

> ID：15364774
> 
> 赞同：2
> 
> 时间：2013-03-12T15:02:44.807
> 
> 标签：python, timeout, httprequest, tornado

我有这部分代码：

```
como_url = "".join(['http://', options.como_address, ':', options.como_port, 
                        '/ztc_config?netid=0&opcode_group=0&opcode=0&start=-20s&end=-1s'])

http_client = AsyncHTTPClient()
response = yield tornado.gen.Task(http_client.fetch, como_url) 
```

我在哪里做一个http请求。我会添加一个连接超时，以确保前面的代码被执行，所以我可以找到我的响应。

如何添加超时？我必须将它添加到 tornado.gen.Task 调用中吗？我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:07:02.390

使用`HTTPRequest`该类为请求添加超时，而不是仅将 url 传递给`fetch`. 尝试：

```
request = tornado.httpclient.HTTPRequest(url=como_url, connect_timeout=20.0, request_timeout=20.0)
response = yield tornado.gen.Task(http_client.fetch, request) 
```

见[http://www.tornadoweb.org/en/branch2.4/httpclient.html#tornado.httpclient.HTTPRequest](http://www.tornadoweb.org/en/branch2.4/httpclient.html#tornado.httpclient.HTTPRequest)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-23T05:21:47.737

我也遇到过这个问题，有时超时不起作用。原因是`SimpleAsyncHTTPClient.max_clients`达到最大值。

在`SimpleAsyncHTTPClient.fetch_impl`中，如果数量`self.active`大于数量，`max_clients`则不`timeout_handle`分配。

所以你添加增加龙卷风实例或者`max_clients`，可以解决它

# html - Sinatra 和 HAML：为整个模板自动转义/转换不安全的 HTML 字符？

> ID：15364777
> 
> 赞同：4
> 
> 时间：2013-03-12T15:02:49.603
> 
> 标签：html, ruby, sinatra, haml

我有一个用于运行基本网站的小 sinatra 应用程序。该网站的内容由客户提供，其中大部分来自 PDF。由于我不想手动替换所有`<`with`&lt;`和`&`with `&amp;`，有没有办法配置 HAML/Sinatra 来自动为我做这件事？

基本上，我有一些看起来像这样的块：

```
%p
  large block of text here...
  multi-line so I can see it in my IDE...
  more lines here... 
```

我只想找到一些配置选项，告诉 HAML 遍历所有内容并将不安全的字符替换为对应的 HTML 实体。

我尝试使用 HTMLEntities gem，但是这个站点有很多多行段落，我似乎无法让它工作。`server.rb`我的意思是我会在我的文件中做这样的事情：

```
def "/some_url"
  @encoder = HTMLEntities.new
  haml :some_template
end 
```

在我的模板中：

```
%p
  = @encoder.encode("Really long multiline string...
    some more lines here...
    and more lines...") 
```

它会吐出一个关于错过关闭的错误`)`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T17:52:29.077

您可以使用[`:escaped`过滤器](http://haml.info/docs/yardoc/file.REFERENCE.html#escaped-filter)：

```
%p
  :escaped
    A block of text here that might
    contain & and <. 
```

输出：

```
<p>
  A block of text here that might
  contain &amp; and &lt;.
</p> 
```

它不是完全自动的，但可能会减少所需的编辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:12:34.130

也许你正在寻找这个：

```
require 'cgi'
CGI::escapeHTML('unsafe string <script>kill() && destroy()</script>'
#=> "unsafe string &lt;script&gt;kill() &amp;&amp; destroy()&lt;/script&gt;" 
```

## 编辑

现在我真的得到了你想要的。只需使用`:escape_html => true`，您就可以将文本包装起来，`='...text here...'`因为所有字符串都被隐式转义。

```
require 'sinatra'

get '/' do
  haml :index, :escape_html => true
end

__END__

@@layout
!!! 5
%html
  %head
    %title Example
  %body
    = yield

@@index
%p
  ='Here is some <em>unsafe</em> HTML.'
  ='<script type="text/javascript">'
  ='killKittens() && destroyHumanity()'
  ='</script>' 
```

结果：

```
$ curl localhost:4567
<!DOCTYPE html>
<html>
  <head>
    <title>Example</title>
  </head>
  <body>
    <p>
      Here is some &lt;em&gt;unsafe&lt;/em&gt; HTML.
      &lt;script type=&quot;text/javascript&quot;&gt;
      killKittens() &amp;&amp; destroyHumanity()
      &lt;/script&gt;
    </p>
  </body>
</html> 
```

# haskell - 如何将 Haskell System.Directory getHomeDirectory 转换为常规字符串？

> ID：15364779
> 
> 赞同：1
> 
> 时间：2013-03-12T15:02:59.033
> 
> 标签：haskell, xmonad

我是 Haskell 菜鸟，目前只用它来配置 xmonad。

我想把我的配置放到一个 git repo 中，因为我不想硬编码我的主目录来获取我的图标。

我查看了 [http://www.haskell.org/haskellwiki/How_to_get_rid_of_IO](http://www.haskell.org/haskellwiki/How_to_get_rid_of_IO) 但我太无知了，无法理解。

```
hd h = h =<< getHomeDirectory

getIcon::String -> String
getIcon out = ( "^i("++hd++".xmonad/dzen2/"++out ) 
```

这真的可能吗？如果是这样，怎么做？我不想对目录进行操作，我只想要路径，作为一个字符串，它正在杀死我。

错误是：

> ```
> Couldn't match expected type `[Char]'
>             with actual type `(FilePath -> IO b0) -> IO b0'
> In the first argument of `(++)', namely `hd'
> In the second argument of `(++)', namely
>   `hd ++ ".xmonad/dzen2/" ++ out'
> In the expression: ("^i(" ++ hd ++ ".xmonad/dzen2/" ++ out) 
> ```

在我看来， IO monad 根本没有被删除。

更新：好的。我将学习如何适应 IO 规则，在此之前我将保持硬编码并使用将替换适当位的脚本克隆配置文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:06:24.243

你`getIcon`有错误的类型，因为`getHomeDirectory`IO：

```
getIcon :: String -> IO String
getIcon out = do
     hd <- getHomeDirectory
     return $ "^i(" ++ hd ++ ".xmonad/dzen2/" ++ out 
```

请记住，Haskell 通过类型区分具有副作用的代码（例如读取硬盘）`IO`。

所以调用者也会在 IO 中：

```
main = do
    s <- getIcon "foo"
    .. now you have a regular string 's' ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:56:28.777

你可以在你打电话的地方更改代码`getIcon`吗？

如果你可以在调用它之前获取主目录，你可以这样做

```
getIcon :: String -> String -> String
getIcon out hd = ( "^i("++hd++".xmonad/dzen2/"++out ) 
```

然后无论你从哪里打电话（假设它`IO`也在）

```
someIOFunction = do
    things
    ....
    hd <- getHomeDirectory
    getIcon out hd 
```

只是为了指出最后的手段，如果没有其他方法，有[`unsafePerformIO`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO-Unsafe.html#v%3aunsafePerformIO)，但我实际上从未使用过它（而且我觉得它通常不受欢迎），所以我在那里帮不了你太多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T14:07:25.663

您可以“突破”其他 monad，但不能突破 IO monad。Xmonad 配置文件中的类似内容可能是您想要的：

```
getIcon::String -> String
getIcon out = ( "^i("++hd++".xmonad/dzen2/"++out )

main =
   h <- getHomeDirectory
   let myIcon = getIcon "Firefox"
   xmonad $ desktopConfig . . . -- use myIcon somewhere in this expression 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-28T12:25:03.893

`IO`可以在编译时使用 Template Haskell解包某些值。一个人的主目录是一个合理的候选者，因为它不会经常更改。用于在编译时将主目录作为字符串获取的 Template Haskell 解决方案可能编码如下：

```
{-# LANGUAGE TemplateHaskell #-}
module HomeDirectory where

import Language.Haskell.TH
import System.Directory

myHome :: String
myHome = $(LitE . StringL `fmap` runIO getHomeDirectory) 
```

不过请注意，Template Haskell 是出了名的狡猾的野兽。这个例子很简单，但很容易变得复杂和混乱。

# php - Fancybox：使用背景图片

> ID：15364784
> 
> 赞同：0
> 
> 时间：2013-03-12T15:03:20.187
> 
> 标签：php, jquery, css, wordpress, fancybox

我在照片部分的花式框有点麻烦。

当您单击其中一个图像时，它会加载与页面上相同的大小（图像实际上要大得多），并且还会从页面中删除 div。

**我想将 div 的全尺寸背景图像加载到fancybox中。**

```
<div class="main-photo fancybox" rel="group" style="background-image:url('<?php echo $photo; ?>');">
   <a href="<?php echo the_sub_field('photo'); ?>">
      <img src="<?php bloginfo('stylesheet_directory'); ?>/images/picture-of-health-photo-frame.png" height="240" width="360" />
   </a>
</div> 
```

链接中的`img`实际上是相框，我不想将其包含在fancybox 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T06:42:17.393

您需要设置`class="fancybox"`为锚`<a>`标签，而不是`<div>`标签，所以：

```
<div class="main-photo" rel="group" style="background-image:url('<?php echo $photo; ?>');">
   <a class="fancybox" href="<?php echo the_sub_field('photo'); ?>">
      <img src="<?php bloginfo('stylesheet_directory'); ?>/images/picture-of-health-photo-frame.png" height="240" width="360" />
   </a>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:44:14.910

您是否使用 Firebug 或任何其他检查器检查过 Fancybox 加载的图像实际上是您想要的“大图像”？

因为我有，并且您正在加载完全相同的图像。:)

# c# - 使用 C# 将 Excel 文件另存为值

> ID：15364785
> 
> 赞同：3
> 
> 时间：2013-03-12T15:03:20.593
> 
> 标签：c#, excel

我有一个包含公式的 excel 文件。这些公式使用了一些需要第三方插件的函数。我正在尝试使用 C# 中的以下代码将 excel 文件保存为 csv。但公式字段显示为错误。如何将公式字段保存为值，然后将其保存在 csv 中。

```
 public static void SaveExcelFileAsCsvAllSheets(string fileName)
    {
        var app = new Microsoft.Office.Interop.Excel.Application();
        try
        {
            Microsoft.Office.Interop.Excel.Workbook wb = app.Workbooks.Open(fileName);
            app.DisplayAlerts = false;
            app.ScreenUpdating = false;
            int sheetCount = 1;
            foreach (Microsoft.Office.Interop.Excel.Worksheet sht in wb.Worksheets)
            {
                if (sht.Visible == XlSheetVisibility.xlSheetVisible)
                {
                    sht.Select();
                    wb.SaveAs(Path.GetDirectoryName(fileName) + @"\" + Path.GetFileNameWithoutExtension(fileName) + "-" + sheetCount.ToString() + ".csv", Microsoft.Office.Interop.Excel.XlFileFormat.xlCSV, AccessMode: XlSaveAsAccessMode.xlNoChange);
                    sheetCount++;
                }

            }

            wb.Close(false);
            app.DisplayAlerts = true;
            app.ScreenUpdating = true;
        }
        catch (Exception ex)
        {
            throw;
        }
        finally
        {
            app.Quit();

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:14:56.873

选择包含您的数据的范围，然后将值复制并粘贴到位：

```
using Excel = Microsoft.Office.Interop.Excel;
Excel.Range targetRange = (Excel.Range)CurrentSheet.UsedRange;
targetRange.Copy(Type.Missing);
targetRange.Paste(Excel.XlPasteType.xlPasteValues, 
    Excel.XlPasteSpecialOperation.xlPasteSpecialOperationNone, false, false); 
```

# iphone - 在应用程序处于前台并且屏幕被锁定时播放声音 - iOS

> ID：15364787
> 
> 赞同：19
> 
> 时间：2013-03-12T15:03:21.740
> 
> 标签：iphone, ios, background, screen, locked

前言：我正在构建一个闹钟应用程序。许多其他闹钟应用程序（例如 Alarm Clock Pro）能够在屏幕锁定且应用程序位于前台时播放闹钟。他们的警报可以无限播放时间，并且可以使用系统音量逐渐增加音量。他们也不控制音乐控件（如果您打开多任务屏幕并滚动播放音频，您将看不到他们的图标）

我在重现该功能时遇到了一些麻烦。

要在应用程序处于前台时播放警报，我们会触发本地通知，效果很好。屏幕锁定时我取得了一些有限的成功（应用程序处于非活动状态）

我使用了以下方法：

1.  `NSTimer`屏幕锁定时每秒运行一次后台任务。我设法让应用程序在最长 10 分钟后保持打开状态，但我无法播放声音。时间到了

2.  使用 播放 1 秒无声的声音`AVAudioPlayer`。当声音结束时，重新播放声音并检查应用程序是否处于非活动（锁定屏幕）状态。如果它处于锁定屏幕状态并且是时候播放警报，请播放它。这里的问题是我必须使用

    `[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];`

以便在歌曲处于后台时继续更新歌曲。该方法将在音乐控件中显示唤醒，并将停止我们想要避免的任何当前播放的音乐。

3.  #1 和 #2 的组合。当应用程序打开时，无限重复播放无声的声音。当屏幕被锁定时，会触发一个计时器来检查是否是时候播放警报了。当需要播放警报时，将静音声音切换为警报声音。系统最终会强制关闭应用程序

有帮助但没有解决我的问题的相关知识：

1.  [如何在静音模式下开始播放音频并锁定在 iOS 6 中？](https://stackoverflow.com/questions/9725192/how-do-i-start-playing-audio-when-in-silent-mode-locked-in-ios-6)
2.  [iOS 5 深度睡眠预防](https://stackoverflow.com/questions/8561504/ios-5-deep-sleep-prevention)
3.  [应用程序在后台时中断后恢复执行代码](https://stackoverflow.com/questions/10406874/resuming-execution-of-code-after-interruption-while-app-is-in-background)
4.  [如何在后台播放音乐 iphone sdk](https://stackoverflow.com/questions/11843326/how-to-play-music-in-background-iphone-sdk?rq=1)

**摘要：当屏幕被锁定并且应用程序处于前台时，我无法阻止该进程在 10 分钟标记后被终止。**

**更新**

我最终使用了[https://github.com/mruegenberg/MMPDeepSleepPreventer](https://github.com/mruegenberg/MMPDeepSleepPreventer)让我在 10 分钟后播放声音。但是，这会像疯了一样消耗电池。我需要找到更有效的解决方案。

**更新 2**

我从应用商店下载了一些[http://marcopeluso.com/应用。](http://marcopeluso.com/)他是深度睡眠预防器的创造者。我下载了他的一些应用程序并进行了一些仪器测试，发现他的应用程序没有像我的应用程序那样消耗电池电量（大约每小时 2.5%，正如他博客上的某处所声称的那样）。我非常确定我需要优化我的应用程序，电池耗尽问题将消失，我的问题将得到解决！

**更新 3** 我最终使用了[https://github.com/mruegenberg/MMPDeepSleepPreventer](https://github.com/mruegenberg/MMPDeepSleepPreventer)

我在它自己单独的 xCode 项目中运行它，当应用程序在后台时它只使用 0.5% 的 cpu。原来是我的应用程序在吸cpu。所以现在一切都很好:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:08:12.760

见我上面的回复。基本上虽然

我最终使用了[https://github.com/mruegenberg/MMPDeepSleepPreventer](https://github.com/mruegenberg/MMPDeepSleepPreventer)

我在它自己单独的 xCode 项目中运行它，当应用程序在后台时它只使用 0.5% 的 cpu。原来是我的代码杀死了 CPU。现在一切都很好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T20:01:04.497

即使您的应用在设备打开时处于前台，在它被锁定后它也会进入后台（调用 willresignactive）。现在根据我在互联网上收集的信息，您不应该自己循环播放声音，而是在您的主应用程序包中提供以下格式之一的自定义音乐文件：

*   线性PCM
*   MA4 (IMA/ADPCM)
*   微定律
*   一条法律

自定义声音只能是 30 秒或更短。初始化 UILocalNotification 对象后，您需要**设置其firedate 属性，即触发通知的日期和时间（也是重复的）**。然后通过 alertBody 设置警报消息（如“wake up”），通过 alertAction 设置警报按钮上的字符串。自定义声音的文件名进入 soundName 属性。您通过调用 scheduleLocalNotification:，一个 UIApplication 方法来展示您的通知实例。**请注意，您调用此方法的时间不需要，通常也不是，通知将触发的时间**.而且即使您设置了定期通知，您也只需要调用一次。您可以通过调用 cancelLocalNotification: 来取消它。现在，无论您的应用程序处于前台、后台还是未打开，您的闹钟都应该播放。

都在[这里](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW1)。

# c# - Foreach，对象引用未设置为对象c#的实例

> ID：15364795
> 
> 赞同：0
> 
> 时间：2013-03-12T15:03:49.283
> 
> 标签：c#, object, inheritance, foreach, instance

我想创建所有单独的食物对象，这些对象已被玩家拾取，但不知何故我一直收到错误；对象引用未设置为对象的实例。

```
int indexFood;

public Sprite(Graphics paper)
{
    while (indexFood < 50)
    {
        foodArray[indexFood] = new Food();
        indexFood++;
    }
}

public void DrawFood(Graphics drawArea)
{
    foreach (Food food in foodArray)
    {
        food.DrawFood(drawArea);
        food.XPos = 8;
        food.XPos += 32;
    }
} 
```

这是 foodClass 方法代码：

```
public void DrawFood(Graphics drawArea)
{
    drawArea.FillEllipse(new SolidBrush(Color.Yellow), xPosFood, yPosFood, size, size);
} 
```

# drupal - 使用带有上下文过滤器的“字段视图”

> ID：15364801
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:00.513
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-views

我正在使用“字段视图”模块，它使您能够将多个 viens 放入内容类型中。多亏了这种内容类型，我可以在一个网页中放置多个视图，这非常棒。

现在我在分类法上创建了一个带有上下文过滤器的视图，所以当我使用普通视图时，我放了[http://test.local/nameOfMyView/133](http://test.local/nameOfMyView/133)（133 是一个 termId），一切都很好，但是当我想放这个时在我的内容类型中查看，我不能使用 termId（[http://test.local/content/nameOfTheNode/133](http://test.local/content/nameOfTheNode/133)给出 404。

我看到了“占位符令牌”。我认为这可能是解决方案，但我不知道如何将 termId 从 URL 中继到我包含在同一内容类型中的所有视图

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T05:00:38.373

我试着在这里回答这个问题：[https ://stackoverflow.com/a/15491704/2036095](https://stackoverflow.com/a/15491704/2036095)

您可以尝试将其直接放入 node.tpl.php 模板中：

```
<?php print views_embed_view('view_name', 'default', $arg); ?> 
```

只需获取术语 id 并将其作为参数传递。

# java - php mcrypt_encrypt 结果不等于 java gnu-crypto

> ID：15364803
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:01.093
> 
> 标签：java, php, encryption

PHP版本：

```
mcrypt_encrypt(MCRYPT_RIJNDAEL_256, "11111111111111111111111111111111", "11111111111111111111111111111111", MCRYPT_MODE_CFB, "11111111111111111111111111111111")
//byte array result:197 225 204 225 20 63 221 2 108 243 172 211 201 17 108 221 53 236 203 147 221 148 73 227 59 26 253 96 240 102 230 118 
```

爪哇版：

```
byte[] pt = "11111111111111111111111111111111".getBytes();
byte[] ct = new byte[32];

IMode mode = ModeFactory.getInstance("CFB", "Rijndael", 32);
Map attributes = new HashMap();
attributes.put(IMode.KEY_MATERIAL, "11111111111111111111111111111111".getBytes());
attributes.put(IMode.CIPHER_BLOCK_SIZE, new Integer(32));
attributes.put(IMode.STATE, new Integer(IMode.ENCRYPTION));
attributes.put(IMode.IV, "11111111111111111111111111111111".getBytes());
mode.init(attributes);
mode.update(pt, 0, ct, 0);
//byte array result: -59 39 -23 -128 94 -42 97 -120 122 -3 -34 -13 70 43 -16 -41 -104 40 -11 83 36 56 -55 66 115 -78 97 -104 58 -38 74 -110 
```

PHP mcrypt_encrypt 结果不等于 java gnu-crypto。

这真的很奇怪。我检查了所有密钥大小、块大小、vi 大小是否相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:44:59.657

尝试在没有 iv 的情况下使用 MCRYPT_MODE_ECB。还请确保您的块大小为 16。

# process - 如何在多核环境中为某个核指定进程/线程？

> ID：15364805
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:07.860
> 
> 标签：process, operating-system, multicore

我的意思是，在操作系统的实现中，什么机制可以完成这项工作？例如，在 Linux 内核中？或者，众所周知，有一些工具可以方便地实现这一点，比如 Windows 任务管理器，但内部机制是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T10:45:13.723

**快速回答**

在 Linux 中，您需要查看 sched_setaffinity() 或 pthread_setaffinity_np()。

**更长的答案**

您需要对核心亲和性相当小心（即，将进程/线程指定给某个核心）。现代 CPU 和操作系统会做各种各样的事情，以使在一般情况下不必摆弄核心亲和力，如果您摆弄并弄错了，这些可能会开始对您不利。

*例子*

在双芯片 i7 平台上，它确实会变得相当复杂。在这样的平台上，超线程意味着 BIOS 报告 16 个内核，其中只有 8 个是真实的。将两个线程绑定到一个核心及其超线程的另一个自我很容易导致两个慢线程。

内存通常在两个芯片之间交错，一次 4kpage（另一种 BIOS 设置）。因此，将线程绑定到特定核心可以使其远离正在操作的数据；这会使两个芯片之间的 QPI 链接过载并减慢一切。顺便说一句，您也可以将内存分配给芯片，看看[这个](http://linux.die.net/man/3/numa)。这是一个复杂的话题，但你可能也必须接受它。

一般来说，跨机器内核、芯片和 SIMM 的线程及其内存的最佳部署是特定于每台 PC 的。例如，考虑一台机器中有两个 i7；最佳部署取决于插入了多少内存 SIMM。这些是操作系统非常清楚的事情，并且通常可以很好地移动线程以获得最佳性能。

您必须有一个非常特殊的环境，您会发现自己进行分发会更好。除非你有一个非常固定的硬件配置，否则你已经编写了你的​​应用程序，以便它在每次运行时为自己确定最佳部署。这是很多编程工作。

**概括**

简而言之，通常最好不要管它。

**英特尔做了什么**

让我们退后一步，看看英特尔当前设计背后的理念是什么，其中存在两个或更多芯片。

英特尔决定，一般来说，计算机在不同的数据集上同时执行许多不同的任务，线程和进程之间仅适度共享数据。这允许他们使用 QPI 合成一个 SMP 架构，将他们的 CPU 绑定到一个公共内存映射中（否则它将是严格的 NUMA，而不是 SMP）。在一般情况下，这会提供出色的性能。当然，AMD 早在几年前就得出了同样的结论，并使用 Hypertransport 来实现它。

重要的是，就应用程序和操作系统而言，它还提供了简单性，因为整台机器中的每个内核都可以看到整个内存，即使只是通过 QPI 间接地看到。

**规则的例外**

但是，如果应用程序的性质是由每个内核上的线程处理的海量数据集，那么 QPI 上的内存远程性可能是一个问题。该架构必须保持所有 CPU 之间的缓存一致性，因此 QPI 链接最终可能会因内存访问和缓存一致性流量而受到影响。例如，在我使用的平台上，QPI 只有 19GB/s，而每个 CPU 的三个内存库都有 25GB/s。这可能在英特尔最近的芯片上发生了变化。

在这种情况下，最好将这两个芯片视为 NUMA 架构。这可以通过分配数据集 NUMA 的两个副本来完成，这样每个 CPU 都有自己的副本。还可以让线程只处理本地内存。这减轻了 QPI 链路的负担。

**围绕芯片的行为工作**

如果一个人要优化到这种程度，那么一个人很快就会开始不喜欢现代 CPU 架构中内置的泛化。例如，缓存会假设要加载哪些数据、何时加载以及何时更新 RAM 和其他缓存。一般来说，这很好，但有时一个人知道得更好。

对我来说，最好的 CPU 是 Playstation 3 中使用的 Cell 处理器。在它的八个数学核心中，它没有缓存，所以没有缓存一致性，什么也没有。程序员全权负责让 DMA 引擎（我希望 Intel 包括）在正确的时间将数据移动到正确的位置，以便由正确的代码处理。或者可以将数据留在原处，然后将代码 DMA 到数据中。它非常复杂，需要大量的脑力，但如果做对了，你可以获得巨大的数学性能（2005 年为 200GFLOPs；领先英特尔数英里）。

至于哪种哲学是对的？好吧，英特尔正在抨击 Core this 和 Xeon that，而 Cell 则垂死挣扎。事实证明，没有多少程序员能够通过自己控制一切来获得最佳性能。

# javascript - qunit jquery ajax 测试，用于始终和完成回调

> ID：15364806
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:17.300
> 
> 标签：javascript, jquery, qunit

我正在尝试测试 jquery ajax 请求

```
Widget.seriesEditLoadSeriesAjax  = function( id , jqXHRCallbacks ) {

    var ajax_url        = '/dashboard/charts/ajax/2';

    var data_obj = {
        SID : id || 0 ,
        getSeries : true             
    };

    var jqxhr  = $.ajax({
        url     : ajax_url,
        type    : "GET",
        data    : data_obj
    });

    jqXHRCallbacks = jqXHRCallbacks || {
        done : Widget.seriesEditLoadSeriesCallback ,
        always : function(){
             $('#series_loader').hide();
        }
    };

    jQuery.extend( jqxhr, jqXHRCallbacks );

    console.log( 'jqxhr.always',  jqxhr.always );
    console.log( 'jqxhr.done', jqxhr.done );

} 
```

并使用 qUnit 库为它编写了一个测试

```
test( "Widget.seriesEditLoadSeriesAjax", function() {

    stop();

    Widget.seriesEditLoadSeriesAjax( 67,{
        done : function(){

            ok( true, "asynchronous Success !");
            start();
        } ,
        always : function(){

            ok(true, "asynchronous completed PASS!");
            start();
        }
    });

}); 
```

但它总是返回结果

```
asynchronous completed PASS! 
```

为什么它省略了测试`done`。请帮忙 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:50:29.357

修改函数为

```
Widget.seriesEditLoadSeriesAjax  = function( id , callbacks  ) {

    var ajax_url        = '/dashboard/charts/ajax/2';

    var data_obj = {
        SID : id || 0 ,
        getSeries : true             
    };

    var ajaxSettings = {
        url     : ajax_url,
        type    : "GET",
        data    : data_obj ,
        success : Widget.seriesEditLoadSeriesCallback ,
        complete : function(){
                $('#series_loader').hide();
        },
        error   : function(){

        }
    };

    jQuery.extend( ajaxSettings, callbacks  );

    var jqxhr  = $.ajax( ajaxSettings );
} 
```

并将测试代码更改为

```
test( "Widget.seriesEditLoadSeriesAjax", function() {

    stop();

    Widget.seriesEditLoadSeriesAjax( 67,{
        success : function( response ){
            ok( true, "asynchronous Success !");

        } ,
        complete : function(){
            ok(true, "asynchronous completed PASS!");
            start();
        }
    });

}); 
```

有效 ！

# c# - 在另一个线程中通过方法调用类成员（IService）

> ID：15364807
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:25.570
> 
> 标签：c#

我想在我的类中实现一个模板方法，因此我有一个带有受保护成员的抽象基类。在具体类中，我想在另一个线程调用的方法中使用这个成员。

现在我的问题是 - 这安全吗？

```
public abstract class ClassBase
{
    protected IService service = new Service();

    protected internal abstract Method();
}

public sealed class Class : ClassBase
{
    public void RunAsync()
    {
       InvokeAsync(Method); //Just a sample - runs asyncrounus
    }

    protected internal override Method()
    {
       var v = this.service.GetById(125);
       ...
    }
} 
```

或者我是否必须在继承类的 Method() 中创建服务类型？它只是一个处理数据库操作的服务类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:20:42.017

每个应用程序都有自己的“安全”定义，尤其是在线程安全方面。（例如`Console`是线程安全的，但您可以`Console.OutputEncoding`在一个线程上进行更改并影响另一个线程输出文本的方式——这对于特定应用程序可能不是“安全的”）。您的代码是“安全的”，因为`service`它不会被任何其他线程破坏——它总是有一个“有效”的值（所有`object`分配在 .NET 中都是原子的），但它可以在何时`InvokeAsync`被调用和何时发生变化`Method`被调用——这对应用程序来说可能不是“安全的”。

# linux - Linux - 计算会话持续时间并将其添加到您的提示中

> ID：15364808
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:31.450
> 
> 标签：linux, shell, session, command-line, command-prompt

有没有办法计算当前用户的会话持续时间或会话长度？

我知道使用`last`命令我们可以获取用户的登录和空闲时间，但是当用户登录时，是否有直接命令或任何可以计算的数学运算。

还如何在提示中添加此会话持续时间信息。我知道`export PS1`可以使用它，但是要输入的参数是什么？

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:00:30.867

在 Bash 中执行此操作的最简单方法是将其添加到您的 .bashrc 中：

```
PS1="\$SECONDS $PS1" 
```

假设你还没有对你的 PS1 做任何奇特的事情，比如动态设置它`PROMPT_COMMAND`或其他什么。您之前需要反斜杠`$SECONDS`以确保每次都对其进行评估。（您也可以使用单引号，但也可能没有必要`$PS1`每次都进行评估。）

这只是给你一个代表会话已经存在的秒数的裸数字。对于更高级的格式，您将不得不付出更多的努力。例如：

```
PROMPT_COMMAND='SESSIONTIME=$(printf "%02d:%02d:%02d" $(($SECONDS / 3600)) $(($SECONDS / 60 % 60)) $(($SECONDS % 60)))'
PS1="\$SESSIONTIME $PS1" 
```

其他 shell 可能有`SECONDS`，但不会有`PROMPT_COMMAND`；例如，在 zsh 中，您可以通过定义一个`precmd`函数来完成同样的事情。阅读文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:36:50.777

这取决于您使用的外壳。在`bash`中，`SECONDS`参数的值是自当前 shell 启动以来的秒数。

# sorting - 挣扎于 solr 查询和相关性

> ID：15364813
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:34.703
> 
> 标签：sorting, solr, lucene, solr-boost

我在使用 Solr 时遇到了提升问题。我们最近从 Lucene 切换到了 Solr。

我们有 4 个（主要）搜索字段供我们搜索：本质、关键字、allSearchable 和质量；其中，对于索引中的每个文档，essential 包含关键字中的前 3 个非停用词。“关键字”只是关键字列表。'allSearchable' 保存的数据只是给定文档的其他数据的集合。我们在 lucene 中所做的是对用户在搜索框中键入的任何给定搜索进行 3 次搜索（以便按相关性对搜索结果进行排名），如下所示：

在搜索框中输入的单词：`tree`

查询 1：（ `+essence:tree`按“质量”排序）如果查询 1 返回的页面足够我们想要获取的页面，则返回。

查询 2：（ `+keywords:tree`按“质量”排序）如果查询 1 和查询 2 的组合为我们所在的页面返回了足够的结果，则返回结果。

查询 3：（ `+allSearchable:tree`按“质量”排序）返回结果。如果没有，那就倒霉了。

我的问题是分页。我以前不必将分页（startIndex，行）发送到 Lucene。我可以要求所有内容，然后翻转我返回的所有内容，收集足够的结果以返回，具体取决于我要求的页面。使用 Solr，我必须传递分页参数。我们的索引中有超过 800 万个文档，因此要获取与“树”之类的查询匹配的所有内容太昂贵了。问题是，如果我在查询 1 中请求第 3 页，但我没有得到足够的结果，那么我必须继续查询 2（关键字：树）。但这是不对的，因为我要求查询 2 的第 3 页结果（换句话说，给我与第 3 页的“关键字：树”匹配的所有文档）。但这并不是我真正想问的问题。如果本质不匹配任何内容，我只想询问关键字的第 1 页。等等。

我真正要找的是一个查询，这足以满足我之前所做的这三个查询，这样我首先得到本质匹配，其次是关键字匹配，最后是 allSearchable 匹配。

我尝试对这个查询使用提升： `essence:tree^4.0 keywords:tree^2.0 allSearchable:tree^1.0`

但这似乎不起作用，我不知道为什么？我拿出了各种东西，但事情仍然没有给我正确的结果。我正在使用默认的 StandardRequestHandler（它似乎使用 LuceneQueryParser（不是 dismax 或 edismax）。我可以看到提升正在发送到 URL 中的 solr（我通过在我的 requestHandler 的默认部分添加一个 qf 参数来使用提升） solrconfig.xml)。我当然知道 lucene 可以理解这些参数。谁能告诉我如何构造一个查询，让我得到我想要的结果，如上所述？`enter code here`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:16:21.203

我建议使用[ExtendedDismax 查询解析器 (eDisMax)](http://wiki.apache.org/solr/ExtendedDisMax)，然后您可以指定跨字段的提升，如下例所示：

```
http://localhost:8983/solr/select/?q=tree
  &defType=edismax&qf=essence^4.0+keywords^2.0+allSearchable^1.0 
```

您可能需要在字段中向上或向下调整提升值以获得所需的结果。此外，eDisMax 还有其他影响提升的参数以及您应该检查的查询执行方式。

# php - JSON（或 PHP）返回意外消息

> ID：15364815
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:35.627
> 
> 标签：php, android, mysql, json

我不明白为什么从 Php 返回 Json 对象后会显示错误消息。看了很多遍代码还是搞不懂

例如：

1.成功插入采购订单后，我收到消息“No value for messagesucc”，而不是 $poid，即 mysql_insert_id() 值

2.当没有产品发布时，预期的消息是“未提交采购订单”，但我得到“消息成功没有价值”

以及许多类似的不匹配错误。

php代码

```
<?php
//acceptporder.php
//to accept the purchase order

include("login.php");
include("functions.php");

// array for JSON response
$retJson = array();

$conn= mysql_connect($hname, $uname, $pass) or die (mysql_error());
mysql_select_db($dbase, $conn) or die (mysql_error());

$atleastone=0;  //To make sure atleast one product was registered

$custid=clean($_POST['custid']);
$smid=clean($_POST['smid']);

$query="SELECT custid FROM custinfo WHERE custid='$custid'";
$res = mysql_query($query,$conn) or die(mysql_error());
$rows= mysql_num_rows($res);

if($rows>0)
{
    $mustcommit=1; //Flag to indicate committing

    $timestamp=time();
    $odate=date("Y-m-d",$timestamp); //Date of Purchase Order
    $otime=date("H:i:s",$timestamp); //Time of Purchase Order

    $query="SELECT poid FROM purchaseordermaster WHERE orderdate='$odate' AND custid='$custid'";
    $res=mysql_query($query, $conn) or die(mysql_error());
    $rows=mysql_num_rows($res);

    if($rows>0)
    {
        $retJson["success"] = 0;
        $retJson["messagefail"] = "You have already submitted your Purchase Order for the day";     
    }
    else
    {
        $query="SET AUTOCOMMIT=0"; //As we deal with transaction involving multiple tables.
        mysql_query($query, $conn) or die(mysql_error());
        $query="BEGIN";
        mysql_query($query, $conn) or die(mysql_error());

        //Create the master record
        $querymaster="INSERT INTO purchaseordermaster (custid,smid,orderdate,ordertime) VALUES('$custid','$smid','$odate','$otime')";
        $r1=mysql_query($querymaster, $conn) or die(mysql_error());
        $poid=mysql_insert_id($conn);

        if($r1)
        {
            $query="SELECT productid, productname FROM productinfo WHERE status=1 ORDER BY category";
            $res=mysql_query($query, $conn) or die(mysql_error());
            $rows=mysql_num_rows($res);

            for($j=0; $j<$rows; $j++)
            {
                $thisrow=mysql_fetch_assoc($res);   
                $pid=$thisrow['productid']; //Take productid from productinfo table
                $cases=clean($_POST["$pid"]);  //Use the product id to retrieve the posted variable

                if($cases==0)
                {
                    continue;
                }

                $atleastone=1;

                //Update the slave table of purchase order
                $queryslave="INSERT INTO purchaseorderslave (poid,productid,cases) VALUES ($poid,'$pid',$cases)";
                $r2=mysql_query($queryslave, $conn) or die(mysql_error());
                if(!$r2)
                {
                    $mustcommit=0;                  
                    break;
                }                                           
            }
        }
        else
        {
            $retJson["success"] = 0;
            $retJson["messagefail"] ="Error Updating Purchase Order Master Table";
            $mustcommit=0;
        }

        if($mustcommit==1 && $atleastone>0)
        {
            $query="COMMIT";
            mysql_query($query, $conn) or die(mysql_error());

            $retJson["success"] = 1;
            $retJson["messagesucc"] = "Purchase Order ID: $poid";           
        }
        else
        {
            $query="ROLLBACK";
            mysql_query($query, $conn) or die(mysql_error());   

            $retJson["success"] = 0;            
            $retJson["messagefail"] = "Purchase Order Has Not Been Submitted";

            if($atleastone==0)
            {
                $retJson["messagefail"] = "No products could be ordered";
            }           
        }               
        $query="SET AUTOCOMMIT=1";
        mysql_query($query, $conn) or die(mysql_error());       
    }   
    echo json_encode($retJson); //Json encode and return
}
else    //invalid custid
{
    $retJson["success"] = 0;
    $retJson["messagefail"] = "Check Customer ID";
    echo json_encode($retJson); //Json encode and return
}

mysql_close($conn);
?> 
```

清洁功能

```
function clean($var) 
{
    $var = strip_tags($var);
    $var = htmlentities($var); 
    $var = stripslashes($var);
    return mysql_real_escape_string($var);
} 
```

使用的表

```
#Purchase Order Table purchaseordermaster
create table purchaseordermaster(
poid bigint key auto_increment,
custid varchar(18) not null,
smid varchar(18) not null,
orderdate varchar(12) not null,
ordertime varchar(15) not null,
consider tinyint not null default 0);

#Purchase Order Table purchaseorderslave
create table purchaseorderslave(
poid bigint not null, 
productid varchar(18) not null,
cases mediumint not null,
primary key(poid,productid),
foreign key(poid) references purchaseordermaster(poid) on delete cascade); 
```

部分 Android 代码存在于 --> 类 MakePO 扩展 AsyncTask

```
 for(int i=0; i<totalprod; i++)
            {
                HashMap<String, String> map = new HashMap<String, String>();
                map=productsList.get(i);    //Get the map from arrayList at required position
                pid=map.get("productid");
                cases=map.get("cases");

                if(Integer.parseInt(cases) == 0)    //Only Send Cases More Than 0
                {
                    continue;
                }                           
                params.add(new BasicNameValuePair(pid, cases));
            }

            //Contacting the server and getting the result
            JSONObject json = pj.makeHttpRequest(link_acceptporder,"POST", params);             

             try 
            {
                int success = json.getInt("success");

                if (success == 1) 
                {
                    s = json.getString("messagesucc");
                } 
                else 
                {
                    s = json.getString("messagefail");  
                }
            } 
            catch (JSONException e) 
            {
                s = e.getMessage();
            }

            return s; 
```

感谢您阅读这篇文章。感谢任何帮助或提示（正面或负面）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:54:41.557

对于 1.，您可以尝试一步一步来： - 在实例化之后获取 $poid 的值 - 在 $retJson["success"] 设置为 1 的条件之前获取 $mustcommit 和 $atleastone 的值

对于 2.，您似乎试图从 messagesucc 中获取一个值，而在 messagefail 中设置了消息“未提交采购订单”。

此致，

# node.js - expressJS 的请求正文类型

> ID：15364817
> 
> 赞同：2
> 
> 时间：2013-03-12T15:04:42.730
> 
> 标签：node.js, express

我想知道需要什么样的内容类型`req`来`app.post('/',function(req,res))`支持。我正在从 HTML 表单发送数据。它必须是 JSON 格式还是可以直接从表单发送？

我已将 json 格式的数据从表单发送到服务器，但是当我访问`req.body.{name attribute of inout element}`它时，会给出未定义的错误无效属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:10:52.013

Express 支持这两种格式。但是，在它可以工作之前，您确实需要使用`bodyParser`中间件，否则`req.body`将不会被填充：

```
app.use(express.bodyParser()); 
```

这是一个最小的应用程序，它接受发布到它的表单和 json 数据：

```
var express = require('express');
var app     = express();

app.use(express.bodyParser());
app.post('/submit', function(req, res) {
  res.send('You submitted: ' + JSON.stringify(req.body));
});

app.listen(3012); 
```

您需要确保在路由*之前*`bodyParser`加载中间件，否则中间件不会首先处理对您的路由的请求，并且您的路由处理程序将无法使用.*`bodyParser``req.body`*

# c# - 设置列值时出现 StrongTypingException

> ID：15364819
> 
> 赞同：4
> 
> 时间：2013-03-12T15:04:49.517
> 
> 标签：c#, .net, strongly-typed-dataset

谁能告诉我为什么在为强类型 DataTable 中的列分配值时会出现 StrongTypingException？（我明白如果我要读取带有 DBNull 值的列，为什么会得到它）

在下面的示例中，我尝试将一个值从一个 DataTable 分配给另一个（示例中的所有列都是**Int32**类型）。我可以为“newOrderRow.items”列分配一个值，但是当我对“newOrderRow.debcode”列执行相同操作时，会引发异常！为什么？！

***到目前为止我尝试过的一些事情（没有任何运气）：***
- 分配硬编码值而不是 'calclineRow.debcode'
- 在分配另一个值之前调用 newOrderRow.SetdebcodeNull()
- 更改了 'debcode' 列中的 DefaultValue 属性orderrows 的表从 DBNull 到 -1，*它仍然抛出异常并说它是 DBNull ！*

```
myDataSet.orderrowsRow newOrderRow;

foreach (MyDataSet.calclinesRow calclineRow in myDataSet.calclines)
{
    newOrderRow = myDataSet.orderrows.NeworderrowsRow();  //Create new 'orderrows' row

    //Assign values from one DataTable to another
    if (!calclineRow.IsitemsNull())
        newOrderRow.items = calclineRow.items;  //calclineRow.items == 1\. Assignment successful
    if (!calclineRow.IsdebcodeNull()) 
        newOrderRow.debcode = calclineRow.debcode; //calclineRow.debcode == 556\. Assignment raises System.Data.StrongTypingException ! (See message below)

    myDataSet.orderrows.AddorderrowsRow(newOrderRow);
}

/*Exception Message:
=====================

System.Data.StrongTypingException: The value for column 'debcode' in table 'orderrows' is DBNull. 
---> System.InvalidCastException: Specified cast is not valid. 
at MyProject.MyDataSet.orderrowsRow.get_debcode() in Q:\MyProjFolder\DataSets\MyDataSet.Designer.cs:line 21680
*/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:14:58.737

`SetNull`如果可空属性为空，则必须使用自动生成的方法：

```
if (!calclineRow.IsitemsNull())
    newOrderRow.items = calclineRow.items;  
else
    newOrderRow.SetitemsNull();

if (!calclineRow.IsdebcodeNull()) 
    newOrderRow.debcode = calclineRow.debcode; 
else
    newOrderRow.SetdebcodeNull(); 
```

您还必须`DataRow`在循环中将新添加到表中，因为`NeworderrowsRow`这不会自动进行。

```
myDataSet.orderrows.AddNeworderrowsRow(newOrderRow); 
```

发生异常的行（MyDataSet.Designer.cs:line 21680）表明它是从`DataSet`读取此属性的自动生成的方法引发的。由于您尚未使用`SetdebcodeNull`它，因此它不知道它为 null 并`StrongTypingException`在尝试读取它时抛出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:27:57.473

你可以试试这个：

```
if (!calclineRow.IsdebcodeNull()) 
    newOrderRow["debcode"] = calclineRow.debcode; 
```

虽然我承认这没有多大意义，但似乎调用`Set`for newOrderRow.debcode 具有调用 的效果，`Get`如前所述，如果基础属性为 DbNull，则会引发异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T17:38:40.330

解决了。对不起这是我的错。

我忘记了我正在使用 DataTable 上的 OnColumnChanging 事件处理程序中的“debcode”列进行操作。当我禁用它时，它一切正常。

不管怎么说，还是要谢谢你！

# php - 仅以编程方式为 windows 和 linux 编写 CRON 选项卡，而不使用任何应用程序

> ID：15364820
> 
> 赞同：1
> 
> 时间：2013-03-12T15:04:53.313
> 
> 标签：php, cron, scheduled-tasks, scheduling, crontab

我正在尝试创建**CRON 作业**或**计划任务**（适用于 Windows）。

我在网上搜索并找到了几个教程，但结果很混乱。

有些尝试使用**Cpanel**进行解释，有些则使用**Task Scheduler**。作为开发人员，如果我无法直接访问**Cpanel**或**SSH**怎么办。是否有任何以编程方式执行 cron 命令的方法。

我只想知道为了使用 CRON 执行我的 php 脚本（传递推送消息的脚本），**我应该在哪里给出命令**

```
* * * * * /usr/php/php.exe /root/push.php 
```

我还发现了一些使用 vi 编辑器，实际上它用于 UNIX。

我想首先在我的本地主机（XAMPP，Windows 机器）上测试 cron 作业，然后在我公司的服务器（Windows）上，最后在客户端服务器（通常基于 LINUX）上测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:25:33.967

If you want to use a scheduled task in windows you must go trough the control panel. No other option. When you want to create a cronjob. (only unix based) use:

```
sudo crontab -e 
```

and paste this command in there.

```
* * * * * /path/to/php /path/to/push.php 
```

This job wil run every minute.

# node.js - 适用于 Windows 和 Mac 的 Node.js — 正斜杠、反斜杠校正

> ID：15364823
> 
> 赞同：7
> 
> 时间：2013-03-12T15:04:58.533
> 
> 标签：node.js, coffeescript

有没有一种方法可以纠正 node.js 从 Windows 到 Linux 和 Mac 关于反斜杠与正斜杠的差异？

Windows 在调用位置时需要反斜杠`git bash`，而 Mac/Linux 需要正斜杠。我正在与 Mac 和 Windows 用户一起开发一个项目，因此我无法将代码中的所有正斜杠更改为反斜杠，因为当 Mac 用户拉动时，coffee 将无法为他们正确运行，反之亦然。

有针对这个的解决方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-12T15:08:35.417

确保使用[路径](http://nodejs.org/api/path.html)方法而不是输入路径。[`path.normalize()`](http://nodejs.org/api/path.html#path_path_normalize_p)在开发[`path.join()`](http://nodejs.org/api/path.html#path_path_join_path1_path2)跨平台时特别有用：

在 Windows 上：

```
$ node
> var p = require('path')
undefined
> p.normalize('/hey/there/you')
'\\hey\\there\\you'
> p.join('/hey', 'there', '/you')
'\\hey\\there\\you' 
```

在 Linux 上：

```
$ node
> var p = require('path')
undefined
> p.normalize('/hey/there/you')
'/hey/there/you'
> p.join('/hey', 'there', '/you')
'/hey/there/you' 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:21:19.930

除了乍得的回答，当您构建路径时，您还可以：

```
var path = require("path");
"hey" + path.sep + "there" + path.sep + "you" 
```

或者

```
["hey", "there", "you"].join(path.sep); 
```

# sencha-touch - FB.getLoginStatus 突然停止在安卓浏览器上工作

> ID：15364827
> 
> 赞同：3
> 
> 时间：2013-03-12T15:05:04.647
> 
> 标签：sencha-touch, sencha-touch-2, facebook-javascript-sdk

我曾经使用此代码：

```
FB.getLoginStatus(function(response) {
....
} 
```

但是突然之间它不起作用，回调没有触发。奇怪的是，仅使用 android 原生浏览器（测试 4.0、4.1）。它适用于 iPhone、iPad、Chrome 和 Safari，包括适用于 Android 的 Chrome。我不知道为什么，但它不限于我的应用程序。例如，我这个由 Sencha 构建的应用程序也不再工作（我用它来建立我的代码）：

[http://www.sencha.com/apps/jog-with-friends](http://www.sencha.com/apps/jog-with-friends)

实际应用网址（Sencha Jog 与朋友）：http: [//j.mp/senchajwf](http://j.mp/senchajwf)

我已经阅读了很多关于这个问题的帖子并遵循了他们的指示，但是与朋友一起慢跑应用程序构建得很好并且包括例如`fbAsyncInit`也可能导致此问题的内容，但它会在所有浏览器上导致它。

我怎样才能解决这个问题？我正在考虑只使用我自己的节点脚本来处理 fb 而不是 js-sdk。

# etl - pentaho 数据集成：执行 PDI BI Server 还是使用 carte？

> ID：15364830
> 
> 赞同：4
> 
> 时间：2013-03-12T15:05:05.907
> 
> 标签：etl, pentaho, data-integration

我正在用 pentaho 做一个项目。我将使用整个社区版解决方案。

我将有一些工作和转换，这些工作和转换将由用户为某些人启动（因此在他们的计算机上使用 PDI），并为其他人自动启动。

我想知道我是否可以在服务器端（使用 BI 服务器和 DW）安装 PDI 并使用它安排自动作业/转换？

还有允许远程执行作业的点菜部分，但我看不出与上面的解决方案有什么区别。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T08:26:59.897

看起来 carte 只是如果您想在服务器上（远程）执行作业（即在计算机上），所以我猜主要是为了完成大工作。

否则要自动调度，您将 PDI 放在服务器上并使用您最喜欢的调度程序（cron ...），它将启动 kjb 文件

我只想知道在存储库中添加文件（xml）时是否可以在服务器上执行作业以及如何执行？

# javascript - 根据属性值从多维 Javascript 数组中删除项目

> ID：15364838
> 
> 赞同：2
> 
> 时间：2013-03-12T15:05:21.160
> 
> 标签：javascript, arrays, knockout.js

我正在使用 KnockoutJS 并有一个多维可观察数组（对象？）：

```
self.navItems = ko.observableArray([
    { name: "test1", children: [
        { name: "test1child1", children: [] },
        { name: "test1child2", children: [] }
    ]},
    { name: "test2", children: [] },
]); 
```

我希望能够根据属性值删除其中一个对象。在其他作品中，我想做这样的事情：

```
removeNavItem("test1child2"); 
```

我编写了一个函数，但无法让它工作，因为它正在寻找“test1child2”作为属性，而不是值。

```
self.removeNavItem = function (itemName) {
    var item = ko.utils.arrayFirst(self.navItems(), function (item) {
        if (item.name === itemName) { // this seems to work correctly
            delete self.navItems[itemName]; // this doesn't, because it tests property, not value
        }
    });
}; 
```

[jsfiddle链接](http://jsfiddle.net/bjFeb/2/)

**编辑：**

我不知道 KO 内置的 remove/removeAll 方法。

感谢下面的评论者，我让它部分工作，但是当我尝试删除 children[] 内部的某些内容时，它也会删除整个父项。

```
removeNavItem = function (itemName) {
    var items = self.navItems.remove(function (item) {
        for (i = 0; i < item.children.length; i++) {
            if (item.children[i].name === itemName) {
                return item.children[i].name;
            }
        }
        return item.name === itemName;
    });
}; 
```

[更新了 jsfiddle](http://jsfiddle.net/bjFeb/3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:08:51.023

如果您希望能够在任何级别上使用它，请传入要从中删除它的数组：

```
self.removeNavItem = function (obsArray, itemName)
{
    obsArray.remove(function(item) { return item.name === itemName });
}; 
```

然后你可以在每个元素上调用它：

```
click: function() { $root.removeNavItem($parent.children, $data.name); } 
```

我已经更新了你的[jsfiddle](http://jsfiddle.net/bjFeb/8/)，它可以工作，但你必须让所有子数组都成为可观察数组才能工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:13:15.687

有一种更简单的方法可以做到这一点。Knockout 提供了一个`remove()`可以使用函数来移除匹配项的功能：

```
self.removeNavItem = function (itemName) {
    var items = self.navItems.remove( function (item) { 
        return item.name === itemName; 
    });
}; 
```

（在[observableArrays 文档](http://knockoutjs.com/documentation/observableArrays.html)的“Remove and RemoveAll”部分提到）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:21:28.433

我认为您将需要一个在 n 级递归上进行搜索的函数

```
 function del(obj,val){
   $.each(obj,function(i,j){
       if(j['name'] == val){
          delete(j);
          return false;
       }else if(j['children'].length!=0){
           del(j['children'],val);
         }
   })

 } 
```

这个函数有两个参数你的对象和要搜索的值，你可以修改它以适应你的情况。

# html - 表格仅在第一次发送

> ID：15364842
> 
> 赞同：3
> 
> 时间：2013-03-12T15:05:27.357
> 
> 标签：html, forms, download

我有一个页面可以根据表单中的某些配置下载文件。

当我发送表单时，文件下载正常，但如果我更改表单并再次发送，则没有任何反应。

示例表格：

```
<form action="/download" method="get" target="_blank">
  <input type="checkbox" name="some_option" value="1" />
  <input type="submit" value="Download" />
</form> 
```

表格仅在第一次发送。

我考虑过使用 JS 发送表单，但我不认为文件下载那样工作。

有什么建议吗？

编辑：按`target="_blank"`建议添加。

更新：

添加了这个：

```
$('form').submit(function() {
  this.action = addRandomParam(this.action);
  console.log(this.action);
}); 
```

`submit`每次点击“下载”按钮时都会触发该事件，但我仍然只在第一次下载文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:11:42.180

假设你的下载地址是`download`，那你需要加一个斜杠，否则下一次提交会带你到`/download/download`那个明显不存在的地方。如果这是正确的，您可以尝试将您的操作设置为`action="/download"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:46:03.447

可能是浏览器以某种方式缓存了您提交的网址吗？您可以尝试在点击提交按钮后向下载 URL 添加随机参数吗？这样下次你点击提交时，浏览器会认为它是一个不同的 url？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T21:58:45.500

好的，问题是一些Javascript在做这样的事情（代码只是说明性的：P）......

```
$('form').submit(function() {
  if (alreadySent()) {
    this.preventDefault();
  }
  setAsSent();
}); 
```

这是为了防止正常表单被多次发送。

谢谢大家的回答。

# django - django 表 2 将外部模型显示为 LinkColumn

> ID：15364843
> 
> 赞同：2
> 
> 时间：2013-03-12T15:05:36.000
> 
> 标签：django, model, foreign-keys, multiple-databases, django-tables2

在 Django 中，我有一个模型“事件”，它有一个名为“messplatz”（DB-Id）的字段，它引用位于不同数据库上的另一个表。由于 Django 的 foreignKey-field 不能用于多个数据库，因此字段 'messplatz' 是一个 Integerfield，存储引用的 'Messplatz' 的 PK 值：

```
class Event(models.Model):
    messplatz = models.Integerfield() 
```

我遇到的问题是使用 django-tables 2 表示模型事件：

模型“Messplatz”在“prodis”应用程序中定义，该应用程序路由到不同的数据库。我的观点如下：

```
def eventList(request):
    table = EventTable(Event.objects.all())
    RequestConfig(request).configure(table)
    return render(request, 'mkv/eventList.html', {'table': table}) 
```

在视图中，我希望“Messplatz”字段显示实际 Messplatz-Object (1) 的名称。此外，我希望它成为另一个视图 (2) 的链接。我可以通过在 tables.py 中为字段“messplatz”定义自定义渲染方法来实现（1）：

```
from prodis.models import Messplatz

class EventTable(tables.Table):

    class Meta:
        model = Event

def render_messplatz(self):
    return '%s' % Messplatz.objects.get(id=self.messplatz) 
```

但是对于（2）我不知道。如果我将自定义渲染方法更改为

```
def render_messplatz(self):
    return '<a href="...">%s<a>' % Messplatz.objects.get(id=self.messplatz) 
```

链接标签由 django-tables 显示为纯文本 2\. 当我使用 django-tables 的 LinkColumn 时，我也无法实现（1），因为您不能同时使用 LinkColumn 和 custom_render 方法。

有人有想法吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:42:42.400

让它以某种方式工作。但是，这是一个非常糟糕的解决方案，我将不胜感激。

我使用了 django-tables2 模板列：

```
class EventTable(tables.Table):
    #override messplatz-column
    messplatz = tables.TemplateColumn('{% load url from future %}<a href="{% url \'messplatz_events\' record.messplatz %}">{{ record.get_messplatz }}</a>')
    #Hint: {% load url from future %} is only needed for django versions < 1.5

    class Meta:
        model = Event 
```

要访问 record.get_messplatz，我必须将 get_messplatz 方法移至 Event-Model：

```
from prodis.models import Messplatz

class Event(models.Model):
    messplatz = models.IntegerField()

    def get_messplatz(self):
        return Messplatz.objects.get(mpl_id=self.messplatz) 
```

不会将此标记为解决方案，因为我认为这是一个非常糟糕的解决方案。但我希望这个答案有帮助。

# sql - 仅选择单个记录

> ID：15364846
> 
> 赞同：0
> 
> 时间：2013-03-12T15:05:39.113
> 
> 标签：sql, select, db2

我有一张这样的桌子

```
custno, type, color
A1234, B, Red
A1234, C, Blue
A1277, B, Red
A1288, A, Black
A1288, B, Red
A1289, A, Black 
```

我只需要检索仅找到一次的唯一记录 A1277 和 A1289。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:07:01.733

这将显示`custNO`在结果列表中，

```
SELECT  custNo
FROM    tableName
GROUP   BY custNO
HAVING  COUNT(*) = 1 
```

但如果你想得到整行，

```
SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT  custNo
            FROM    tableName
            GROUP   BY custNO
            HAVING  COUNT(*) = 1
        ) b ON a.custNo = b.custNo 
```

*   [SQLFiddle 演示（*两个查询*）](http://sqlfiddle.com/#!2/d53e0/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:07:10.717

```
SELECT custno
FROM yourTable
GROUP BY custno
HAVING COUNT(*) = 1 
```

[**示例小提琴**](http://sqlfiddle.com/#!2/613143/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T07:25:37.073

试试这个，因为这样可以防止代价高昂的连接操作——

`SELECT custno,type,color FROM ( SELECT custno, type, color, COUNT(custno) OVER(PARTITION BY custno) CNT FROM tableName )TMP WHERE CNT=1`

# wpf - 为什么在某些控件的主题化方面，Windows8 的行为与 windows7 不同？

> ID：15364847
> 
> 赞同：3
> 
> 时间：2013-03-12T15:05:40.460
> 
> 标签：wpf, windows-8, theming

正如主题中已经提到的那样，我注意到 windows8 的行为与 windows7 不同，它们在控制一些主题化的东西方面。当我第一次在 windows8 中打开我的应用程序时，我注意到以下内容：

为组合框设置背景颜色对 windows8 没有影响，但对文本框效果很好。我必须覆盖组合框的整个控件模板，才能为某些组合框恢复我想要的颜色。

我在 Windows 8 上遇到的另一个问题是，默认情况下，我的文本框的所有内容都不再垂直居中，所有内容都与顶部对齐。在 windows7 中，所有内容默认垂直居中，无需设置 VerticalContentAlignment 属性。很高兴它不需要再次覆盖文本框的整个模板，就像之前组合框所要求的那样。将所有 tetxbox 的 VerticalContentAlignment 属性设置为“中心”。

到目前为止，我注意到的第三个问题是，我无法在大于 16x16 的 MenuItems 中显示图标。我所有的 MenuItems 都有一个 20x20 大小的图标，并且在 windows7 中显示良好。在 Windows8 中，我所有的图标都被裁剪为 16x16。

我使用了以下代码，在 Windows7 中运行良好：

```
<MenuItem Header="I'm a header">
   <MenuItem.Icon>
       <Image Source="Image.png" Height="20" Width="20" />
  </MenuItem.Icon>
</MenuItem> 
```

...但在 windows8 上没有。

我敢打赌这种类型的 windows8 上还有更多的小问题。

**任何人都知道 Windows8 中这种行为的原因是什么？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T07:19:54.623

我查看了 microsoft connect 页面，我描述的两个问题已经被报告为错误，组合框背景和将图像裁剪为 16x16 的菜单项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T08:20:40.447

只需提取组合框和菜单项的模板而不进行任何更改并将其设置为样式即可修复 windows8 上的问题。

现在您可以再次像往常一样使用组合框的背景属性，并且设置菜单项图标的高度和宽度现在也可以正常工作。

# c# - IDENTITY_INSERT 设置为 OFF（并且应该是）

> ID：15364848
> 
> 赞同：2
> 
> 时间：2013-03-12T15:05:41.043
> 
> 标签：c#, silverlight, linq-to-sql

我正在尝试使用具有服务引用的 Silverlight C# 在 SQL 表中创建一个包含数据的新行。我收到以下错误：

> `IDENTITY_INSERT`设置为`OFF`。

但我希望`Cart_ID`自动给出。

表定义：

![在此处输入图像描述](../Images/64213c48c219de9e6d9e6e446040e96e.png) ![在此处输入图像描述](../Images/cf05781661ab26b62deddc55609c9277.png)

这是我的 C# 代码：

```
void createNewCart(String inpCartName)
{
    PositionServiceReference.PositionServiceClient service = new PositionServiceReference.PositionServiceClient();

    Lloyds_Cart newCart = new Lloyds_Cart();
    newCart.Cart_Date = DateTime.Today;
    newCart.Cart_Name = inpCartName;

    service.CreateNewCartCompleted += 
        new EventHandler<System.ComponentModel.AsyncCompletedEventArgs>(service_CreateNewCartCompleted);
    service.CreateNewCartAsync(newCart);
} 
```

我的 C# 操作合同（服务参考）：

```
[OperationContract]
void CreateNewCart(Lloyds_Cart newCart)
{
    PositionDataClassesDataContext context = new PositionDataClassesDataContext();

    context.Lloyds_Carts.InsertOnSubmit(newCart);
    context.SubmitChanges();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:33:27.067

最有可能的属性`Cart_ID`未标记为在上下文类声明中生成的 DB。默认情况下此属性包含 0，Linq to SQL 尝试将此值插入 DB 中的相应列并失败。

确保`ColumnAttribute`decorates 属性`Cart_ID`具有参数`IsPrimaryKey`并`IsDbGenerated`设置为`true`. 您还可以在设计器的“属性”窗格中为`Cart_ID`.

**更新**（查看上下文代码后）：该`Cart_ID`属性在属性中缺少`IsDbGenerated`参数，正如预期的那样。将其设置为`true`，一切都应该工作。

# perl - 使用 perl 将数据从一个制表符分隔文件解析到另一个文件中

> ID：15364849
> 
> 赞同：2
> 
> 时间：2013-03-12T15:05:50.093
> 
> 标签：perl, text-processing, csv

我有一个这样的制表符分隔文件（在我的脚本 DIVERGE 中）：

```
contig04730 contigK02622 0.3515
contig04733 contigK02622 0.3636
contig14757 contigK03055 0.4 
```

我有第二个这样的制表符分隔文件（数据）：

```
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap
contig04730 F GO:0005528 reproduction GO:0001113 eggs
contig14757 P GO:0123456 immune GO:0003456 cells
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding
contig14757 C GO:0000001 immune GO:00066669 more_cells 
```

我正在尝试将第一个文件的第二和第三列添加到第二个文件中，这样我就可以拥有（OUT）：

```
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap contigK02622 0.3515
contig04730 F GO:0005528 reproduction GO:0001113 eggs contigK02622 0.3515
contig14757 P GO:0123456 immune GO:0003456 cells contigK03055 0.4
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding contigK03055 0.4
contig14757 C GO:0000001 immune GO:00066669 more_cells contigK03055 0.4 
```

这是我正在尝试使用的 perl 脚本（尝试调整我在这里找到的那​​些 - 对 perl 来说非常新）：

```
#!/usr/bin/env/perl

use strict;
use warnings;

#open the ortholog contig list
open (DIVERGE, "$ARGV[0]") or die "Error opening the input file with contig pairs";

#hash to store contig IDs
my ($espr, $liya, $divergence) = split("\t", $_);

#read through the ortho contig list and read into memory
while(<DIVERGE>){
    chomp $_;   #get rid of ending whitepace
    ($espr, $liya, $divergence)->{$_} = 1;
}
close(DIVERGE);

#open output file
open(OUT, ">$ARGV[2]") or die "Error opening the output file";

#open data file
open(DATA, "$ARGV[1]") or die "Error opening the sequence pairs file\n";

while(<DATA>){
    chomp $_;

    my ($contigs, $FPC, $GOslim, $slimdesc, $GOterm, $GOdesc) = split("\t", $_);
    if (defined $espr->{$contigs}) {
        print OUT "$_", "\t$liya\t$divergence", "\n";
    }
}
close(DATA);
close(OUT); 
```

但是我在第 15 行得到了一个关于私有变量的无用使用和在第 10 行拆分的统一值 _$ 的错误。我对 perl 术语/变量只有非常基本的掌握。因此，如果有人能指出我哪里出错以及如何解决，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:57:54.970

[`Text::CSV`](http://search.cpan.org/perldoc?Text%3a%3aCSV)这是使用该模块的机会。对 csv 数据使用适当的解析器的好处当然是避免边缘情况破坏您的数据。

```
use strict;
use warnings;
use Text::CSV;

my $div     = "diverge.txt";   # you can also assign dynamical names, e.g.
my $data    = "data.txt";      # my ($div, $data) = @ARGV
my $csv     = Text::CSV->new({
            binary      => 1,
            eol     => $/,
            sep_char    => "\t",
        });
my %div;

open my $fh, "<", $div or die $!;

while (my $row = $csv->getline($fh)) {
    my $key = shift @$row;              # first col is key
    $div{$key} = $row;                  # store row entries 
}
close $fh;

open $fh, "<", $data or die $!;

while (my $row = $csv->getline($fh)) {
    my $key = $row->[0];                # first col is key (again)
    push @$row, @{ $div{$key} };        # add stored values to $row
    $csv->print(*STDOUT, $row);         # print using Text::CSV's method
} 
```

**输出：**

```
contig04730     F       GO:0000228      nuclear GO:0000783      telomere_cap contigK02622    0.3515
contig04730     F       GO:0005528      reproduction    GO:0001113      eggs    contigK02622    0.3515
contig14757     P       GO:0123456      immune  GO:0003456      cells   contigK03055    0.4
contig14757     P       GO:0000782      nuclear GO:0001891      DNA_binding    contigK03055    0.4
contig14757     C       GO:0000001      immune  GO:00066669     more_cells    contigK03055    0.4 
```

请注意，输出看起来不同，因为它是制表符分隔的，而在问题中它是空格分隔的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:27:28.673

我会做什么：

```
#!/usr/bin/env perl

use strict; use warnings;

open my $fh1, "<", "file1" or die $!;
open my $fh2, "<", "file2" or die $!;

my %hash;

while (<$fh1>) {
    chomp;
    my @F = split;
    $hash{$F[0]} = join "\t", @F[1..2];
}

while (<$fh2>) {
    chomp;
    my @F = split;
    print join("\t", $_, $hash{$F[0]}), "\n";
}

close $fh1;
close $fh2; 
```

## 输出

```
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap        contigK02622    0.3515
contig04730 F GO:0005528 reproduction GO:0001113 eggs   contigK02622    0.3515
contig14757 P GO:0123456 immune GO:0003456 cells        contigK03055    0.4
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding contigK03055    0.4
contig14757 C GO:0000001 immune GO:00066669 more_cells  contigK03055    0.4 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:28:18.753

[这（如果我理解你的意图正确的话）可以通过命令join](http://www.manpagez.com/man/1/join/)在一行中完成（至少在 Linux 中）：

```
 $ cat DATA
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap
contig04730 F GO:0005528 reproduction GO:0001113 eggs
contig14757 P GO:0123456 immune GO:0003456 cells
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding
contig14757 C GO:0000001 immune GO:00066669 more_cells

 $ cat DIVERGE
contig04730 contigK02622 0.3515
contig04733 contigK02622 0.3636
contig14757 contigK03055 0.4

 $ join DATA DIVERGE
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap contigK02622 0.3515
contig04730 F GO:0005528 reproduction GO:0001113 eggs contigK02622 0.3515
contig14757 P GO:0123456 immune GO:0003456 cells contigK03055 0.4
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding contigK03055 0.4
contig14757 C GO:0000001 immune GO:00066669 more_cells contigK03055 0.4 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T16:08:23.723

这是另一种选择：

```
use strict;
use warnings;

my $data = pop;
my %diverge = map { /(\S+)\t+(.+)/; $1 => $2 } <>;
push @ARGV, $data;

while (<>) {
    chomp;
    $_ .= "\t$diverge{$1}\n" if /(\S+)/ and $diverge{$1};
    print;
} 
```

用法：`perl DIVERGE_File DATA_File [>outFile]`

数据集上的输出：

```
contig04730 F GO:0000228 nuclear GO:0000783 telomere_cap    contigK02622 0.3515
contig04730 F GO:0005528 reproduction GO:0001113 eggs   contigK02622 0.3515
contig14757 P GO:0123456 immune GO:0003456 cells    contigK03055 0.4
contig14757 P GO:0000782 nuclear GO:0001891 DNA_binding contigK03055 0.4
contig14757 C GO:0000001 immune GO:00066669 more_cells  contigK03055 0.4 
```

# java - 创建两个方法，返回布尔方法？

> ID：15364850
> 
> 赞同：-6
> 
> 时间：2013-03-12T15:05:53.750
> 
> 标签：java

我只是想知道是否可以对我的程序有一些帮助，这些需要：

现在添加两个公共方法来获取和设置这个新数组的值： public void discover(int thisCol, int thisRow) unlock 方法将指定方格的状态更改为 false。否则，如果输入坐标在雷区之外，或者方格已经被发现，它什么也不做。

public boolean isCovered(int thisCol, int thisRow)如果指定的方格被覆盖，isCovered方法返回true。否则，如果输入坐标在雷区之外或方格未被覆盖，则返回 false。

我尝试在下面创建这些方法，但我认为它们不正确，请任何人看一看？

```
public void uncover(int thisCol, int thisRow) {
    if(thisCol <0 || thisRow < 0)
        return null;
    if(thisCol>=numCols || thisRow>=numRows)
        return null;
}

public boolean isCovered(int thisCol, int thisRow){
    if(thisCol >0 || thisRow > 0)
        return true;
    if(thisCol>=numCols || thisRow>=numRows)
        return true;
    else;
        return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:18:25.190

我的理解（在 C# 中）是“public void”表示您没有向调用者返回任何内容。所以在“发现”方法中，我希望它在尝试返回 Null 时给你一个错误。

另外，在第二个中，我希望在“return null”行上也看到一个错误，因为您的返回类型是布尔值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:16:42.647

第一种方法：-

`public void uncover(int thisCol, int thisRow)`

这是一种无效的方法。这意味着你不能返回任何值`(null, true or false)`

第二种方法：-

`public boolean isCovered(int thisCol, int thisRow)`

你不能返回 null 因为返回类型是布尔值。所以应该是`return false;`

以上更改需要更正。之后您可以尝试使用您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-23T03:55:58.733

假设数组在类中的变量中声明：

```
private boolean thisArray[][]; 
```

这是正确的`uncover`功能：

```
public void uncover(int thisCol, int thisRow) {
    if(thisCol < 0 || thisRow < 0) return;
    if(thisCol >= numCols || thisRow >= numRows) return;
    thisArray[thisCol][thisRow] = true;
} 
```

更正：

1.  没有值的 return 语句，因为函数返回`void`
2.  最后一行数组值的赋值：`thisArray[thisCol][thisRow] = true`

这是正确的`isCovered`功能：

```
public boolean isCovered(int thisCol, int thisRow){
    if(thisCol < 0) return false;
    if(thisRow < 0) return false;
    if(thisCol >= numCols) return false;
    if(thisRow >= numRows) return false;
    return thisArray[thisCol][thisRow];
} 
```

更正：

1.  如果坐标在它必须返回的正方形之外`false`，那么你正在返回`true`；
2.  您缺少检查我在最后一行添加的数组的有效值：`return thisArray[thisCol][thisRow];`

# xna - 沿对角线移动精灵

> ID：15364852
> 
> 赞同：2
> 
> 时间：2013-03-12T15:06:05.007
> 
> 标签：xna, logic, sprite, draw

我希望你能帮助我。

当用户单击右键时，我正在根据鼠标位置移动我的精灵，如下所示：

```
protected override void Update(GameTime gameTime)
{
    int nextX = SpritePosition.X;
    int nextY = SpritePosition.Y;
    int SpriteWidth = 135;
    int SpriteHeight = 135;
    int Speed = 3;

    MouseState ms = Mouse.GetState();
    if (ms.RightButton == ButtonState.Pressed)
    {
        if (ms.X > SpritePosition.X + SpriteWidth) //check to move right
        {
            nextX = SpritePosition.X + Speed;
        }
        else if (ms.X < SpritePosition.X) //check to move left
        {
            nextX = SpritePosition.X - Speed;
        }

        if (ms.Y > SpritePosition.Y + SpriteHeight) //Check to move bottom
        {
            nextY = SpritePosition.Y + Speed;
        }
        else if (ms.Y < SpritePosition.Y) //Check to move top
        {
            nextY = SpritePosition.Y - Speed;
        }

        //Change the Sprite position to be updated in the DRAW.
        SpritePosition = new Rectangle(nextX, nextY, graphics.GraphicsDevice.Viewport.Width, graphics.GraphicsDevice.Viewport.Height);
    }

    base.Update(gameTime);
} 
```

它现在正在工作，但它的移动方式是这样的：

错误移动[http://i.imgur.com/xGsFy38.png](http://i.imgur.com/xGsFy38.png)

我希望它移动的方式如下：向右移动[http://i.imgur.com/kkEnoYD.png](http://i.imgur.com/kkEnoYD.png)

伙计们，现在我从以下答案中尝试了以下方法：

```
 Vector2 From = new Vector2(SpritePosition.X, SpritePosition.Y);
            Vector2 To = new Vector2(ms.X, ms.Y);
            From = Vector2.Subtract(From,To );
            Vector2 Direction = Vector2.Normalize(From);
            Direction = Direction * Speed;

            SpritePosition = new Vector2(Direction.X, Direction.Y); 
```

我的精灵不动，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:12:03.407

你有两个位置，都存储为 Vector2。

从目标位置减去当前位置，得到两点之间的向量。

规范化该向量以获得方向向量。

将方向矢量乘以您的移动速度，以所需的速度沿方向矢量移动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:39:43.757

我用下面的代码做了一个例子，这里是：

[http://pastebin.com/ep659g76](http://pastebin.com/ep659g76)

我创建了一个简单的点，5x5 像素，它是屏幕上的对象。您可以更改为您喜欢的任何内容。

这是我用于带有 spriteanimation 的自上而下射击游戏的方法。我将它从 C++ 转换为 C#，但它应该可以正常工作。就我而言，根据精灵的位置，我必须添加 +90 度的旋转才能获得正确的结果，但希望你能弄清楚。

```
public static class Helper_Direction
{

    // Rotates one object to face another object (or position)
    public static double FaceObject(Vector2 position, Vector2 target)
    {
        return (Math.Atan2(position.Y - target.Y, position.X - target.X) * (180 / Math.PI));
    }

    // Creates a Vector2 to use when moving object from position to a target, with a given speed
    public static Vector2 MoveTowards(Vector2 position, Vector2 target, float speed)
    {
        double direction = (float)(Math.Atan2(target.Y - position.Y, target.X - position.X) * 180 / Math.PI);

        Vector2 move = new Vector2(0, 0);

        move.X = (float)Math.Cos(direction * Math.PI/180) * speed;
        move.Y = (float)Math.Sin(direction * Math.PI / 180) * speed;

        return move;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:14:13.327

您需要将位置更改为：

```
nextY = SpritePosition.Y + SpriteHeight + Speed; 
```

但这会导致精灵在开始时跳跃，所以我建议你先计算完成位置，然后慢慢将其移动到该位置。

# ms-access - 引用现有表达式

> ID：15364853
> 
> 赞同：2
> 
> 时间：2013-03-12T15:06:08.840
> 
> 标签：ms-access

在 MS Access 中，如何引用构建器中的现有表达式？

我试着把它输入为：Expr1，我也试着把它放在这样的括号里：(Expr1)，在这两种情况下，出来的数字都没有意义。

更新：

目前我有这些现有的表达式

```
SELECT tblInventory.ProductNo, tblInventory.NewFSPrice, tblInventory.FSPrice,     tblInventory.FSMarkUp, tblInventory.Cost, [tblInventory]![Cost]/[tblInventory]![FSMarkUp]      AS Expr1, [tblInventory]![Cost]/[tblInventory]![FSPrice] AS Expr2
FROM tblInventory; 
```

如果真的归结为我必须将它们括起来然后运行它们，我会的，但我想知道是否有一种方法我不必再次将它们写出来，这样我就可以在一个表达式中使用它们像

FSPrice - Expr1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:43:10.157

Here is my query

```
SELECT tblInventory.ProductNo, 
       tblInventory.NewFSPrice, 
       tblInventory.FSPrice,  
       tblInventory.FSMarkUp,  
       tblInventory.Cost,  
       [tblInventory]![Cost]/[tblInventory]![FSMarkUp] AS Expr1,  
       [tblInventory]![Cost]/[tblInventory]![FSPrice] AS Expr2,  
       [FSPrice]-[Expr1] AS Expr3
FROM tblInventory; 
```

Returning

```
ProductNo   NewFSPrice  FSPrice FSMarkUp    Cost    Expr1   Expr2   Expr3
1           10          10      5           5       1       0.5     9 
```

Note that Expr3 must occur after Expr1 in the design grid. In addition, I am not dividing by zero at any point, nor are any nulls returned, if there were, I would need to allow for that by using IIfs and / or Nz.

# php - 如何将 mysql_real_escape_string 设为零

> ID：15364854
> 
> 赞同：1
> 
> 时间：2013-03-12T15:06:11.420
> 
> 标签：php, html, mysql, forms, mysql-real-escape-string

我正在尝试将 html 表单中的电话号码输入到我的 MySQL 数据库中`mysql_real_escape_string`。号码是 0123456789，但在我的数据库中写为 23456789。有谁知道如何将该零与我的数据库中的其他数字一起插入，或者是否有任何方法将表单值分解为字符然后将它们一一输入到我的 MySQL 数据库中？

这是我不输入零的代码：

```
<?php
$Phone = mysql_real_escape_string($_POST['phone']);
mysql_query("INSERT INTO `user` (`phone`) VALUES ('{$Phone}')");
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:06:53.563

这和逃跑无关。如果要保留前导零，则需要将值存储为字符串，而不是整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:10:46.127

您应该将数据类型更改为 varchar(10)，如果您想稍后将其作为数字处理，只需从字符串中解析它。数据库中不存在数字 01xxx。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-12T15:12:08.207

PHP 是松散类型的。假设电话字段被存储为 VARCHAR / CHAR 而不是数字数据类型，则转义字符串正在做它应该做的事情。PHP 会将 $_POST 变量中的数据视为整数，并在将其传递给 mysql_real_escape_string() 函数之前截断前面的 0。如果将参数修改为`( '' . $_POST['phone'] )`，它将转换为字符串并按预期工作。

```
<?php 
    $phone = mysql_real_escape_string( '' . $_POST['phone'] ); 
```

# ffmpeg - FFmpeg 的帧号叠加

> ID：15364861
> 
> 赞同：46
> 
> 时间：2013-03-12T15:06:32.813
> 
> 标签：ffmpeg

我需要使用 ffmpeg for windows 将帧号覆盖到视频文件的每一帧。

`drawtext`我使用以下代码成功地用过滤器覆盖了时间码戳：

```
ffmpeg -i video.mov -vcodec r210 -vf "drawtext=fontfile=Arial.ttf: timecode='01\:00\:00\:00': r=25: x=(w-tw)/2: y=h-(2*lh): fontcolor=white: box=1: boxcolor=0x00000099" -y output.mov 
```

但是，我需要一个帧号覆盖而不是时间码。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-12T19:04:32.520

您可以将[drawtext 过滤器](https://ffmpeg.org/ffmpeg-filters.html#drawtext)与`n`or`frame_num`函数一起使用：

[![在此处输入图像描述](../Images/4ffbadb680afdef95b2aa80c29b9e6a5.png)](https://i.stack.imgur.com/gHQ4N.gif)
[循环 5 fps 示例]

示例命令：

```
ffmpeg -i input -vf "drawtext=fontfile=Arial.ttf: text='%{frame_num}': start_number=1: x=(w-tw)/2: y=h-(2*lh): fontcolor=black: fontsize=20: box=1: boxcolor=white: boxborderw=5" -c:a copy output 
```

*   您可能必须提供字体文件的完整路径，例如`fontfile=/usr/share/fonts/TTF/Vera.ttf`.
*   `n`/从 0 开始，但您可以使用示例中所示`frame_num`的选项使帧计数从 1 开始。`start_number`

如果需要，您可以添加其他文本，但请注意您必须转义一些特殊字符：

```
text='Frame\: %{frame_num}' 
```

[![在此处输入图像描述](../Images/dda705c529e2c799ef243dc04828ce7a.png)](https://i.stack.imgur.com/B41la.gif)

有关详细信息，请参阅[drawtext 过滤器文档](https://ffmpeg.org/ffmpeg-filters.html#drawtext)。

# ios - 在同一 ios 设备上将多个用户与社交网络同步

> ID：15364862
> 
> 赞同：2
> 
> 时间：2013-03-12T15:06:43.310
> 
> 标签：ios

当您为 IOS 设备开发应用程序时，您可以将其设置为同步 Facebook 或 Twitter 等社交媒体帐户吗？我还尝试允许具有不同社交媒体帐户的不同用户登录到同一设备，并让他们在登录时自动同步到他们的社交媒体帐户。

我遇到了 API 令牌问题。

# ruby-on-rails - Apple 推送通知 Rails 应用程序消息

> ID：15364863
> 
> 赞同：2
> 
> 时间：2013-03-12T15:06:47.823
> 
> 标签：ruby-on-rails, ruby, message, apple-push-notifications

每次用户收到新消息时，我都想发送一个苹果推送通知。我找到了这个教程[http://www.waratuman.com/2011/01/13/apple-push-with-heroku/](http://www.waratuman.com/2011/01/13/apple-push-with-heroku/)

并使用此代码

```
 class Jobs::APN::DeliverNotifications
   @queue = "apn"

   def self.perform
      APN::Notification.send_notifications
   end

 end

 class Jobs::APN::Feedback < Job
   @queue = "#{RAILS_ENV}::apn"

   def self.perform
     APN::Feedback.process_devices
   end

 end

 class Api::ApnController < ApplicationController
   skip_before_filter :verify_authenticity_token

   def create
     APN::Device.create(:token => params[:token])
     render :text => "", :status => 200
   end

   def subscribe
     device = params['token'] ? APN::Device.find_or_create_by_token(:token =>  params['token']) : nil
     event = Event.first(:conditions => {:id => params['event_id']})
     subscription = Subscription.new :device => device, :event => event

     status = 200
     if device && event && subscription.valid?
       subscription.save
     else
       status = 422
     end
     render :text => "", :status => status
   end

   def unsubscribe
     device = APN::Device.find_or_create_by_token(:token => params['token'])
     event = Event.first(:conditions => {:id => params['event_id']})
     subscription = Subscription.first(:conditions => {:device_id => device.id, :event_id => event.id})
     subscription.delete if subscription
     render :text => "", :status => 200
   end

 end 
```

我知道这段代码应该设置通知并注册设备，但是当我真的想为新消息发送通知时，我应该怎么做？

我目前有一个消息索引

```
 def index
     if params[:mailbox] == "sent"
       @messages = @user.sent_messages
     elsif params[:mailbox] == "unread"
       @messages = @user.received_messages.unread
     else
       @messages = @user.received_messages
     end

     respond_to do |format|
       format.html
       format.json { render :json => @messages }
     end
   end 
```

因此未读路径将显示特定用户的所有未读消息。我想将它们作为推送通知发送。有什么建议吗？我还在学习，所以请原谅含糊不清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:45:49.710

从[本教程](http://yekmer.posterous.com/how-to-send-iphone-push-notifications-in-rail)

您可以使用以下方法创建通知：

```
device = #load your device
notification = APN::Notification.new   
notification.device = device   
notification.badge = 5   
notification.sound = true   
notification.alert = "My first push"   
notification.save 
```

这只会创建一个通知并存储它，所以实际上发送通知运行这个 rake 任务

```
rake apn:notifications:deliver 
```

或调用此函数

```
APN::App.send_notifications 
```

# java - 比较 google map v2 android 中的两个 LatLng 对象

> ID：15364871
> 
> 赞同：7
> 
> 时间：2013-03-12T15:07:03.367
> 
> 标签：java, android, double, latitude-longitude, google-maps-api-2

我有一个由 latLong 对象组成的数组列表，如下所示：

```
ArrayList < LatLng > latLngList = new ArrayList< LatLng >(); 
```

**注意：LatLng 是具有双精度格式的纬度和经度值的对象，即纬度是双精度格式，经度是双精度格式**

以下是存储在上述**latLngList**对象中的值：

```
Lat Long List:[lat/lng: (34.072516,-118.403609), lat/lng: (34.074227,-118.399248), lat/lng: (34.07304,-118.3995), lat/lng: (34.07304,-118.3995), lat/lng: (34.07304,-118.3995), lat/lng: (34.067856,-118.401485)] 
```

现在，由于我正在处理 android 中的 google map v2，每当我单击特定标记时，我都会获得纬度和经度位置，并尝试将其与**latLngList**对象进行比较，以查找该对象是否存在于**latLngList**中。

我正在通过以下方式进行操作：

```
 for(LatLng latLng : latLngList) {
       marker.getPosition().equals(latLng); **Always returns false**
 } 
```

标记位置返回给我以下 latLng 对象：

```
lat/lng: (34.074226888265116,-118.39924816042185) 
```

很明显，marker 返回的经纬度对象有点长，因此比较失败。

有没有更好的方法来比较 latLng 对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-07T11:40:51.580

一个更好的方法不是比较标记基于`LatLng`，而是基于身份`Marker`。由于某些奇怪的原因`Marker.getPosition()`，它不会返回完全相同的值。

我建议将所有标记存储在 a 中，`List`或者`Map`如果您想将一些附加信息附加到每个`Marker`.

或者，您可以`Marker.getId()`在创建后使用`Marker`、存储它，然后在`onMarkerClick`.

**编辑：**

我也在[gmaps-api-issues](http://code.google.com/p/gmaps-api-issues/issues/detail?id=5353)上报告了这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-09T22:22:36.943

像这样实现 latlngs。这对我有用。

```
final LatLng[] latLngs = new LatLng[2];
latLngs[0] = new LatLng(lat, lng);
latLngs[1] = new LatLng(lat, lng);

if(latLngs1[0].equals(latLngs1[1])) {
//to do 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T07:17:39.583

我认为最好的方法是使用静态[Location](http://developer.android.com/reference/android/location/Location.html#distanceBetween%28double,%20double,%20double,%20double,%20float%5B%5D%29)方法计算您的 latlng 点和标记点之间的距离。您可以处理以米为单位的返回距离，并确定是否是大致相同的点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T12:31:45.277

我想稍微澄清一下 Maciej 的答案，因为问题标题讲述了比较`LatLng`对象。`LatLng`对象本身是完全等同的——它们`equals`和`hashCode`语义都是正确的。（[文档也这么说](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/LatLng#equals%28java.lang.Object%29)）这只是' 不准确地存储其位置的`Marker`错误。 因此，如果您确实想跟踪精确的位置，您可以简单地将所有添加的标记存储在. 但是，如果您只想比较两个标记，则根本不要使用它们的位置，正如 MaciejGórski 所说，一个简单的就可以完成这项工作。`Marker`
`Marker``HashMap<Marker, LatLng>``Marker.getId()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-20T11:24:26.620

你有两个我能想到的选项，一个是使用四叉树库： http: [//koti.mbnet.fi/ojalesa/quadtree/quadtree_intro.htm](http://koti.mbnet.fi/ojalesa/quadtree/quadtree_intro.htm)它易于使用且很有帮助，另一个是一个很好的答案@geocodezip（在 JavaScript 中）

```
var SameThreshold = 0.1;
if (google.maps.geometry.spherical.computeDistanceBetween(latlng1,latlng2) < SameThreshold)
marker1.setAnimation(google.maps.Animation.BOUNCE); 
```

# html - 如何将表格菜单与横幅对齐

> ID：15364874
> 
> 赞同：1
> 
> 时间：2013-03-12T15:07:11.963
> 
> 标签：html, css

我在调整菜单时遇到了一点问题。我正在制作一个占框架 80% 的横幅（宽度），我在横幅上方有一张桌子，这是我的菜单。在这里我的问题我不知道如何将位置固定到横幅的右上角，因为如果我将他的位置设置为绝对位置，当我缩小框架时它不会跟随横幅。所以我想知道他们是否可以让表格跟随图像而不是框架。这是我的 HTML 表的 CSS 代码：

```
border: 1px solid black;
border-color:Black;
display:none;
width:150px;
position:absolute;
left:1200px; 
vertical-align:top; 
```

这里是横幅：

```
 style="width: 80%; height: 175px; margin-left: 0px" align="middle" /> 
```

这是我的母版页的代码，其中包含菜单和横幅：

```
 <%@ Master Language="VB" CodeFile="MasterPage.master.vb" Inherits="MasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
    <link rel="Stylesheet" type="text/css" href="StyleSheet.css" />
    <style type="text/css">
        .style2
        {
           width:471px;
           background-size: 100%;
           background-position:center;

        }
        </style>
</head>
<body class="MainBody">
    <form id="form1" runat="server" class="MainForm">
    <div class="Header" runat="server" style="width:100%;">
        <div style="text-align:right; width:100%;" align="center">
            <table id="Tablessss";border="1"; 
                style="text-align:center; width:100%; table-layout:fixed; height: 94px;" 
                width="100%" align="center">
                <tr>
                    <td id="td_Title" runat="server" valign="middle" class="style2"><asp:ScriptManager ID="ScriptManager1" EnablePageMethods="true" runat="server"></asp:ScriptManager>
                         <table id="TB_Conn"  runat="server"  class="Connection" align="right">
                            <tr>
                                <td align="center"  class="Cells">
                    <asp:Label ID="lbl_User" runat="server" Font-Size="Medium" ></asp:Label>
                                </td>

                                <td align="center"  class="Cells">
                    <asp:Label ID="lbl_Access" runat="server" Font-Size="Medium" ></asp:Label>
                                </td>

                                <td align="center" class="Cells">
                    <asp:Button ID="btn_Disconnect" runat="server" text="D&eacute;connecter" 
                            Visible="true" />
                                </td>
                            </tr>
                        </table>
                        <img alt="" src="pharmacy-banner.jpg" 
                            style="width: 80%; height: 175px; margin-left: 0px" align="middle" />

                   </td>
                </tr>
            </table>
        </div>
    </div>
    <div style="position:relative;min-height:100%;height:auto !important;height:100%;">
        <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">

        </asp:ContentPlaceHolder>
    </div>
    <div class="Footer" runat="server">
        <asp:Label ID="lb_Developped" runat="server" Text="D&eacute;velopp&eacute; par EXA Systems Inc."></asp:Label><br />www.exainc.com</div>
    </form>
</body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:56:45.840

尝试使用`float:right;`并尝试在 jsfiddle.net 之类的网站上显示您的代码...

# ios - iOS中通过wifi的点对点网络

> ID：15364876
> 
> 赞同：21
> 
> 时间：2013-03-12T15:07:15.430
> 
> 标签：ios, iphone, networking, multipeer-connectivity, peer

我已经在这几天了，似乎无法找到解决方案。我想在 iOS 上通过 wifi 创建一个点对点网络。所有开源代码似乎都支持运行服务器或作为客户端，但没有构建支持两者的代码 - 对等。有人知道我可以做到这一点吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-11-12T08:38:06.640

iOS 7正是为此目的添加了[Multipeer Connectivity Framework 。](https://developer.apple.com/library/ios/documentation/MultipeerConnectivity/Reference/MultipeerConnectivityFramework/index.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-18T02:16:33.717

我认为[Open Peer](http://www.openpeer.org)是正确的解决方案。它在设备之间提供真正的直接对等连接，而无需集中式服务器。看看这个介绍[视频](https://www.youtube.com/watch?v=mF_ckU1dGwE)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-12T15:36:32.967

你有没有想过使用 Apple 的 GameKit 框架？我过去曾将它用于设备之间的一些简单通信。这真的很简单，可以让你快速走出大门。 [这](http://imagineric.ericd.net/2011/04/20/ios-gamekit-iphone-to-iphone-communication/)看起来是一个很好的教程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-20T16:30:51.803

iOS 支持[Multipeer Connectivity 框架](https://developer.apple.com/library/ios/documentation/MultipeerConnectivity/Reference/MultipeerConnectivityFramework/Introduction/Introduction.html)，该框架使 iOS 设备能够通过蓝牙、基础设施（带有路由器）WiFi 或 P2P 相互通信。

但是，它没有提供一种明确使用 P2P 的方法。有一个抽象层远离设备的任何对等设备（其他 iOS 设备）的连接方式，并且目前不允许连接非 iOS 设备。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-12T15:53:20.487

您无法使用当前 API 在 iOS 中以编程方式创建 wi-fi 网络。GameKit 提供了一些 API 来通过蓝牙实现这一点。

如果您希望使用 CocoaHTTPServer 实现自定义解决方案，请注意您仍然无法创建直接的 wi-fi 连接，您只能在相同（预先存在的）wi-fi 网络上连接设备。

iOS 中的 Ad-hoc 点对点 Wi-Fi（例如 802.11s）还有几年的时间。也许是 iOSX ;)

# php - 消息：尝试增加/减少非对象的属性

> ID：15364882
> 
> 赞同：1
> 
> 时间：2013-03-12T15:07:42.103
> 
> 标签：php, operators

```
$order_temp = $this->mdl_admin->get_latest_order_id($_POST['parent_id']);

if ($order_temp) {
    $order = (string)$order_temp->order++;
    var_dump($order);
    die();
} 
```

上面的代码产生了这个错误：

```
Message: Attempt to increment/decrement property of non-object 
```

而vardump是`string '' (length=0)`

如果我只是做这样的事情来转储变量：

```
$order_temp = $this->mdl_admin->get_latest_order_id($_POST['parent_id']);
if ($order_temp) {
   var_dump($order_temp);
   die();
} 
```

输出是：

```
array (size=1)
  0 => 
    object(stdClass)[28]
      public 'id' => string '16' (length=2)
      public 'name' => string 'sssssssssssssss' (length=15)
      public 'slug' => string 'aaaaaaaaa' (length=9)
      public 'title' => string 'aaaaaa' (length=6)
      public 'body' => string '<p>asdas asd asd </p>' (length=21)
      public 'order' => string '1' (length=1)
      public 'parent_id' => string '5' (length=1) 
```

我只想在 $order_temp->order 上加 1，所以如果 $order_temp->order = 2 结果 $order = 3。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:10:16.460

```
<?php
class Test
{
    public $order = 10;
}

$order_temp = new Test();
$order = (string)$order_temp->order++;
var_dump($order);
//string(2) "10" 

$order = (string)$order_temp->order;
var_dump($order);
//string(2) "11" 
?> 
```

您的 $order_temp 不是对象。所以这就是造成问题的原因。另请注意，即使有效，您也可能无法获得预期的结果。

您的 $order 将包含 OLD 值。看我的测试。

更新

您的`var_dump`$order_temp 表明它是一个数组。你可以使用

```
$order_temp[0]->order++;
$order = $order_temp[0]->order
var_dump($order); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:12:05.853

`$order_temp`如错误消息所述，它不是对象。当您尝试访问（或者在这种情况下，增加）不是对象（因此没有属性）的东西的属性时，您会收到此错误。

不知道是什么`$this->mdl_admin->get_latest_order_id`，我只能走这么远，但是，我可以告诉您在 if 语句中使用显式比较，并且您的类型强制没有达到您的预期。

使用显式比较：

```
if (is_object($order_temp) === true) 
```

..这可能不是你的错误的原因，但这是一个很好的做法。

`(string)`您在赋值中使用 ( ) 将假定的对象变量强制转换为字符串，然后您尝试访问该字符串的属性。这不是您要寻找的机器人。从 PHP 的角度来看，您似乎想要这样做：

```
"0"->order++; 
```

......这没有意义。

PHP 使用类型杂耍[ [doc](http://php.net/manual/en/language.types.type-juggling.php) ]。无论您的对象的属性是否`order`以字符串开始，只要您使用增量运算符`++`，PHP 就会将类型转换为整数。如果你想要一个字符串，你所要做的就是开始把它当作一个字符串来对待：

```
$order_temp->order++; // <-- variable is an integer, $order_temp->order === 1
$order_temp->order .= " and bob's your uncle"; // <-- variable is a string, $order_temp->order === "1 and bob's your uncle" 
```

因此，PHP 中很少需要类型强制。

最后，您可以完全按照您尝试的方式执行此操作，但您必须了解增量`++`运算符的工作方式。

```
$number = 0;
$output = $number++;
echo "Output: ".$output; // Output: 0

$number = 0;
$output = ++$number;
echo "Output: ".$output; // Output: 1 
```

...通过将增量运算符放在赋值的前面，返回将是增量操作**后**的增量变量。如果你把操作符放在最后，那么返回的是自增操作**之前的变量。**

这意味着你可以这样做：

```
$order_number_as_string = (string) (++$one_order->order); 
```

通过将增量运算符括在括号中并在外部进行类型转换，再加上将增量运算符作为前缀，您将获得预期的结果。

**文档**

*   递增/递减运算符 - [http://php.net/manual/en/language.operators.increment.php](http://php.net/manual/en/language.operators.increment.php)
*   类型杂耍 - [http://php.net/manual/en/language.types.type-juggling.php](http://php.net/manual/en/language.types.type-juggling.php)
*   `settype`- [http://php.net/manual/en/function.settype.php](http://php.net/manual/en/function.settype.php)

# c# - Azure 存储容器命令运行时间极长

> ID：15364884
> 
> 赞同：6
> 
> 时间：2013-03-12T15:07:45.323
> 
> 标签：c#, azure, azure-storage, azure-blob-storage

我正在使用 Azure 存储，在容器上调用命令时遇到了一些问题。我通过单元测试运行它，有时当在容器上调用命令时，它只是坐下来等待该命令近 5 分钟。如果我等待足够长的时间，它将继续并成功。运行它时，容器确实存在，因此根本不必创建容器。

有没有其他人遇到过这个问题？我尝试设置 a `ServerTimeout`，`BlobRequestOptions`但没有任何影响。

这是我的代码正在执行的操作的示例：

```
var blobClient = _storageAccount.CreateCloudBlobClient();
var container = blobClient.GetContainerReference(containerName);
var options = new BlobRequestOptions() { ServerTimeout = TimeSpan.FromSeconds(10) };
if (!container.Exists(options)) //<<<<this is where it hangs
{
    container.Create();
} 
```

我也试过了`CreateIfNotExists()`：

```
var blobClient = _storageAccount.CreateCloudBlobClient();
var container = blobClient.GetContainerReference(containerName);
container.CreateIfNotExists(); //<<<this is where it hangs 
```

如果我只是尝试列出 blob，它也会挂起

```
var blobClient = _storageAccount.CreateCloudBlobClient();
var container = blobClient.GetContainerReference(containerName);
container.ListBlobs(); //<<<<this is where it hangs 
```

它不会发生在每个容器上，但是当它发生在一个容器上时，它似乎是同一个容器。我已经检查过，容器确实存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T19:31:46.603

我报告了一个非常相似的情况：[Checking if item exists in Azure blob container takes forever (SDK 2.0)](https://stackoverflow.com/questions/16681512/checking-if-item-exists-in-azure-blob-container-takes-forever-sdk-2-0)。还没有找到答案。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-13T07:06:04.477

你能把 Fiddler 挂到设置中，看看是否有任何有意义的信息出来吗？（有关设置，请参见[http://sepialabs.com/blog/2012/02/17/profiling-azure-storage-with-fiddler/ ）](http://sepialabs.com/blog/2012/02/17/profiling-azure-storage-with-fiddler/)

如果没有，我建议联系支持人员。

# asp.net - 如何使列名的值在asp中的sql helper的sql语句中显示为单撇号。网

> ID：15364886
> 
> 赞同：1
> 
> 时间：2013-03-12T15:07:52.217
> 
> 标签：asp.net, sql, sqlhelper

```
 SQLHelper sqhlpr = new SQLHelper();
    sqhlpr.SqlText = "Select StudentName from tblStudentInfo where class=" + NurseryButton.Text;
    DataTable dt = sqhlpr.getDataTable(false); 
```

这是我的代码。现在 sqhlpr.sqlText 的结果是

```
select StudentName from tblStudentInfo where class= **Nursery** 
```

（即NurseryButton.Text=Nursery），但我想要的结果是从tblStudentInfo 中选择StudentName，其中class=' **Nursery'。**这怎么做？？？这看起来很简单，但我无法弄清楚......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:10:19.190

```
"Select StudentName from tblStudentInfo where class='" + NurseryButton.Text + "'"; 
```

但是你绝对不应该那样使用它！（[SQL注入](http://en.wikipedia.org/wiki/SQL_injection)）

这是一个很好的答案：[Sql inline query with parameters。执行查询时不读取参数](https://stackoverflow.com/questions/2701506/sql-inline-query-with-parameters-parameter-is-not-read-when-the-query-is-execut)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:12:59.330

您的查询是一个字符串。你做：

```
result = "somestring" + someVariable; 
```

现在你想用`someVariable`单引号括起来，这样做是这样的：

```
result = "somestring" + "'" + someVariable + "'"; 
```

或更短：

```
result = "somestring'" + someVariable + "'"; 
```

然而值得注意的是，手动构建查询是相当“未完成”的。您应该查看参数化查询之类的工具，甚至是实体框架之类的 O/R 映射器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:13:13.533

以下代码将执行您想要的操作：

```
SQLHelper sqhlpr = new SQLHelper();
sqhlpr.SqlText = "Select StudentName from tblStudentInfo where class = '" + NurseryButton.Text + "'";
DataTable dt = sqhlpr.getDataTable(false); 
```

不过，您还需要考虑两件事：

1.  如果有人以某种方式在 NurseryButton.Text 中添加撇号会发生什么
2.  SQLHelper 会保护您免受此类事情的影响，还是您需要自己做

您应该以某种方式考虑参数化查询或存储过程，以确保您对数据库的输入是安全的。

# javascript - CSS Flyout Menu 与滚动菜单结合使用

> ID：15364890
> 
> 赞同：3
> 
> 时间：2013-03-12T15:08:09.127
> 
> 标签：javascript, jquery, html, css

我是 javascript 新手，在使用菜单时遇到了问题。我可以使用弹出菜单，也可以使用滚动菜单（滚动菜单演示[http://css-tricks.com/examples/LongDropdowns/](http://css-tricks.com/examples/LongDropdowns/)）。

但是，我无法弄清楚如何合并效果。有人可以帮我下面的弹出代码吗？

//HTML

```
<ul class="dropdown">
<li><a href="#">CITIES BY STATE</a>
<ul>
for (var p = 0; p < state.length; p++) {

    <li><a href="#"> + states[p][0] + "</a>");

    <ul  id="city\" class="city">
    <li>CITY 1</li>
    <li>CITY 2</li>
    <li>CITY 3</li>
    </ul>");

    </li>");

}   
</ul>
</ul>
</li> 
```

//允许滚动列表的脚本

```
<script>
    var maxHeight = 600;

    $(function(){

        $(".dropdown > li").hover(function() {

            var $container = $(this),
            $list = $container.find("ul"),
            $anchor = $container.find("a"),
            height = $list.height() * 1.1,       // make sure there is enough room at the bottom
            multiplier = height / maxHeight;     // needs to move faster if list is taller

            // need to save height here so it can revert on mouseout            
            $container.data("origHeight", $container.height());

            // so it can retain it's rollover color all the while the dropdown is open
            $anchor.addClass("hover");

            // don't do any animation if list shorter than max
            if (multiplier > 1) {
                $container
                .css({
                    height: maxHeight,
                    overflow: "hidden"
                })
                .mousemove(function(e) {
                    var offset = $container.offset();
                    var relativeY = ((e.pageY - offset.top) * multiplier) - ($container.data("origHeight") * multiplier);
                    if (relativeY > $container.data("origHeight")) {
                        $list.css("top", -relativeY + $container.data("origHeight"));
                    };
                });
            }

        }, function() {

            var $el = $(this);

            // put things back to normal
            $el
            .height($(this).data("origHeight"))
            .find("ul")
            .css({ top: 0 })
            .show()
            .find("a")
            .removeClass("hover");    
        });                                      
    });                  
</script> 
```

这是我尝试过的，但我已经离开了。当我将鼠标悬停在一个州上时，我希望在州列表的右侧显示一个城市列表。

```
/*code to show/hide city menu*/

#city li:hover ul ul, #city li:hover ul ul ul, #city li:hover ul ul ul ul{
display:none;
}

#city li:hover ul, #city li li:hover ul, #city li li li:hover ul, #city li li li li:hover ul{
display:block;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:11:25.637

Chrisoph is right. This is just jibberish:

```
<ul class="dropdown">
<li><a href="#">CITIES BY STATE</a>
<ul>
for (var p = 0; p < state.length; p++) {

    <li><a href="#"> + states[p][0] + "</a>");

    <ul  id="city\" class="city">
    <li>CITY 1</li>
    <li>CITY 2</li>
    <li>CITY 3</li>
    </ul>");

    </li>");

}   
</ul>
</ul>
</li> 
```

This is *syntactially* correct HTML/Javascript. Screw it... I decided to just code it for you because I'm bored, but you really need to go back to basics in HTML/JavaScript.

```
<html>        
    <head>        
        <title>test</title>        
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>        
        <script type="text/javascript">        
            $(document).ready(function()        
            {        
                var map = [        
                    {state: "NSW", cities: ["Sydney", "Newcastle", "Orange"]},        
                    {state: "QLD", cities: ["Brisbane", "Cairns", "Townsville"]},        
                    {state: "VIC", cities: ["Melbourne", "Geelong", "Ballarat"]},        
                    {state: "SA", cities: ["Radelaide", "Mount Gambier"]},        
                    {state: "TAS", cities: ["Hobart", "Devonport", "Launceston"]}        
                 ];        

                for (var i = 0; i < map.length; i++)         
                {        
                    var a = $('<a href="#">').html(map[i].state);        
                    var li = $('<li>').append(a);        
                    var cities = $('<ul>').attr('id', map[i].state).addClass('cityList');        

                    for(var j = 0; j < map[i].cities.length; j++)        
                    {        
                        cities.append($('<li>').html(map[i].cities[j]));        
                    }        

                    li.append(cities);        

                    $('#citiesByState').append(li);        
                }        
            });        
        </script>        
    </head>        
    <body>        
        <ul class="dropdown">        
            <li>        
                <a href="#">CITIES BY STATE</a>        
                <ul id="citiesByState"></ul>
            </li>        
        </ul>        
    </body>        
</html> 
```

Now go back and fix your question *and test it* then we'll look at any new problems.

# php - 如何将 JSON 结果输出为整数

> ID：15364891
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:08:22.130
> 
> 标签：php, json, twitter

我遇到的问题是我正在使用 twitter 端点来捕获推文中的某些关键字，但我没有在结果中得到任何数值来说明有多少结果。下面是使用的代码：

```
<?php

$response = file_get_contents('http://search.twitter.com/search.json?q=ps4&rpp=100&geocode=43.652527,-79.381961,10mi&geocode=49.263588,-123.138565,10mi&include_entities=true&result_type=mixed');
$search = json_decode($response);
$items = array();

foreach ($search->results as $item) {
      $items[] = array('text' => '@'.$item->from_user.': '.$item->text);
 }
 $data = array('item' => $items);

 header('Content-Type: application/json');

 echo json_encode($data);

 ?> 
```

我得到的输出只是显示用户名和推文。

```
 {"item":[{"text":"@detikcom: Gocekan PES 2014 Bakal Semakin Lincah di PS4 http:\/\/t.co\/CtrUtOf0GI via @detikinet"}}]} 
```

我想要的是要显示的单个整数中的提及总数。我找不到任何能让我走上正确道路的东西，如果有人能指出我正确的方向，那就太好了。

谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:13:26.977

怎么样`count($items)`？你可以这样做：

```
$data = array('item' => $items, 'itemCount' => count($items)); 
```

# android - android phonegap 触摸阴影

> ID：15364892
> 
> 赞同：0
> 
> 时间：2013-03-12T15:08:23.243
> 
> 标签：android, cordova, touch

Android/Phonegap，我在 index.html 中创建了一个弹窗，当我触摸移动弹窗的内容时，会显示按钮的阴影。如图所示：

![在此处输入图像描述](../Images/79f6b9c9d03b125827923c5be5ce7019.png)

它出什么问题了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T04:12:20.397

DMDGeeker 是对的！谢谢兄弟，这段代码工作得很好！不得不处理这个问题几分钟，直到我找到你的评论

```
 -webkit-touch-callout: none;
 -webkit-tap-highlight-color: rgba(0,0,0,0); 
```

# sed - 使用 awk 和 sed 搜索特定的多行模式

> ID：15364894
> 
> 赞同：2
> 
> 时间：2013-03-12T15:08:26.043
> 
> 标签：sed, awk

我想从文件中读取`/etc/lvm/lvm.conf`并检查以下可能跨越多行的模式。

```
tags {
 hosttags = 1
} 
```

`tags`和之间可能有很多空白`{`，`{`以此类推`hosttags`。也`{`可以跟随`tags`下一行而不是与它在同一行。

我打算使用`awk`并`sed`执行此操作。

在阅读文件`lvm.conf`时，它应该跳过空行和注释。

我正在使用的。

```
data=$(awk < cat `cat /etc/lvm/lvm.conf`            
/^#/        { next }                       
/^[[:space:]]*#/            { next }                
/^[[:space:]]*$/            { next }                
.          
. 
```

我怎样才能`sed`找到我上面描述的模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:11:24.970

你在寻找这样的东西吗

```
sed -n '/{/,/}/p' input 
```

即标记之间的打印行（包括）？

要删除包含`#`空行或仅包含空格的行，请使用

```
sed -n '/{/,/}/p' input | sed '/#/d' | sed '/^[  ]*$/d'

                              space and a tab--^ 
```

**更新**

如果空行只是空行（no ws），则上面可以缩短为

```
sed -e '/#/d' -e '/^$/d' input 
```

**更新2**

要检查模式`tags {...`是否存在于文件中，请使用

```
$ tr -d '\n' < input | grep -o 'tags\s*{[^}]*}'
tags { hosttags = 1# this is a comment} 
```

上面的`tr`部分删除了所有的换行符，即将所有内容都放在一行中（如果文件不是很大的话会很好用），然后搜索`tags`模式并输出所有匹配项。

grep 的返回码将`0`是找到模式，`1`如果没有。返回码存储在变量中`$?`。或通过管道将上述内容传递`wc -l`给以获取找到的匹配项数。

**更新3**

`tags { hosttags=1 }`用于在任何地方搜索任意数量的 ws 的正则表达式

```
'tags\s*{\s*hosttags\s*=\s*1*[^}]*}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:16:23.947

试试这一行：

```
 awk '/^\s*#|^\s*$/{next}1' /etc/lvm/lvm.conf 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:00:34.567

可以尝试先对文件进行预处理，删除注释和空行，并在右花括号后面引入空行，以便使用第二个 awk 轻松处理。

```
awk 'NF && $1!~/^#/{print; if(/}/) print x}' file | awk '/pattern/' RS= 
```

# php - PHP OpenSSL 解密返回零字节文件

> ID：15364895
> 
> 赞同：0
> 
> 时间：2013-03-12T15:08:28.780
> 
> 标签：php, openssl

我已经生成了一个公钥/私钥对：

```
-----BEGIN CERTIFICATE-----
MIIE6jCCA9KgAwIBAgIBADANBgkqhkiG9w0BAQQFADCBrjELMAkGA1UEBhMCVVMx
CzAJBgNVBAgTAkNBMREwDwYDVQQHEwhTYW4gSm9zZTEfMB0GA1UEChMWY29kZXdv
cnh4IHdlYiBzZXJ2aWNlczEaMBgGA1UECxMRVHJhbnNmZXJFbmdpbmUgSFExFzAV
BgNVBAMTDlRyYW5zZmVyRW5naW5lMSkwJwYJKoZIhvcNAQkBFhpub3JlcGx5QHRy
YW5zZmVyZW5naW5lLm5ldDAeFw0xMzAzMTIxNDI0NDFaFw0xNDEwMTMwMTI4MDla
MIGuMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExETAPBgNVBAcTCFNhbiBKb3Nl
MR8wHQYDVQQKExZjb2Rld29yeHggd2ViIHNlcnZpY2VzMRowGAYDVQQLExFUcmFu
c2ZlckVuZ2luZSBIUTEXMBUGA1UEAxMOVHJhbnNmZXJFbmdpbmUxKTAnBgkqhkiG
9w0BCQEWGm5vcmVwbHlAdHJhbnNmZXJlbmdpbmUubmV0MIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEAtmTfkg8+GA2xogfWU3eLiCLvpUcjGqht15/1tuy/
FKulH6wWByB6ufKcFqEPGjJ4qduqkfPl9hAxOfbKwrksvOTfIXkhXFQRxOSw5WT0
iXCjY03xqXBYmCofq7DjbLuvmKmnj1doZHtbH+kRLTOej9JNCOGHouGK3VQVOeYr
qQZK1WgcvsGJX6AWNaCdhSyJ4+FxNc1UQ6IRhI1G5bN0L0MTzIZ2eHhYqK0SnfSj
L6CKRw3GxS+92dWnA4kCjvcu5Kpq7ESuyAM3ELVFfAbYW5pkscyn7fEUNXFxATPH
STyhnL9X46vxQWt2Rk1hXcM6/wVjGvn/FT0338xcSiluFQIDAQABo4IBDzCCAQsw
HQYDVR0OBBYEFCYyn3nR5UlaDU+vhOAv1GtW0UxkMIHbBgNVHSMEgdMwgdCAFCYy
n3nR5UlaDU+vhOAv1GtW0UxkoYG0pIGxMIGuMQswCQYDVQQGEwJVUzELMAkGA1UE
CBMCQ0ExETAPBgNVBAcTCFNhbiBKb3NlMR8wHQYDVQQKExZjb2Rld29yeHggd2Vi
IHNlcnZpY2VzMRowGAYDVQQLExFUcmFuc2ZlckVuZ2luZSBIUTEXMBUGA1UEAxMO
VHJhbnNmZXJFbmdpbmUxKTAnBgkqhkiG9w0BCQEWGm5vcmVwbHlAdHJhbnNmZXJl
bmdpbmUubmV0ggEAMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEEBQADggEBAI9A
a5MNf2FZOyziY8Evv9lyYCFQzfOv1KvBg1H12QGSeXzktY3zZq4qQq3xFkL9F1ix
xUy+iupZZfKSoW8yTIQZOdCdWZgQ7oWGlDscRMOLmUIGbUp6sBobLXFhA3gkS6iY
30cvfxro12Ci6heNtBR4NN1H8S2UJAIVww2b4ATR+vanuQRXtIShegNdKC38cFsM
eCNJ6f/dV1VLOAe0BHr/Df8IpTS0S9lzrv7vfmyxAfImZSnF4jBeefo8jDLDdvU0
WmHEAecF8FyDOIGdwL0QBdfzy8lw5/3V3yhimRX4ngkCcemhnC7p+bbEnoiucp7X
dvtrzVOcAJOvJIDcqxU=
-----END CERTIFICATE-----

-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAtmTfkg8+GA2xogfWU3eLiCLvpUcjGqht15/1tuy/FKulH6wW
ByB6ufKcFqEPGjJ4qduqkfPl9hAxOfbKwrksvOTfIXkhXFQRxOSw5WT0iXCjY03x
qXBYmCofq7DjbLuvmKmnj1doZHtbH+kRLTOej9JNCOGHouGK3VQVOeYrqQZK1Wgc
vsGJX6AWNaCdhSyJ4+FxNc1UQ6IRhI1G5bN0L0MTzIZ2eHhYqK0SnfSjL6CKRw3G
xS+92dWnA4kCjvcu5Kpq7ESuyAM3ELVFfAbYW5pkscyn7fEUNXFxATPHSTyhnL9X
46vxQWt2Rk1hXcM6/wVjGvn/FT0338xcSiluFQIDAQABAoIBAQCEP6n3vsOYLz2w
LZyS0qhCYop+vZDPgHZ8lQhVxV1bQIWu7FjgfAVglG/m3IsVxKjHCHap8z23Z9A5
ph8oh5nPsOe03p540qA7slItUkEY8qoVk+t4nvQuCMUD+XM9YO0WdVUAUzFnQiY1
ggmpS7dZsvOWT+jICl9k0dW+MI1RtPvk0v011c8OOtMzdOCCcx52EIeVRlBce3Qk
AQSQ/Ql2TqVaNXW5PebIEOVv1h6ZWVB4hBq74FaI+A51yXfNayuiPQYq4AcZb1o9
cxxqv5Iy6ZkVZbke9dof+7uCeqyDlRAZ1XvkFCLeuHgx2Fa80B1ogR9ky0gtgEXz
Jju3G5m1AoGBANrv/Ddk3O89p6ptZg2tB+TD3pWJX3y/4uilK/2aFwCAi0qY3CyP
FnzPktlb4wVw56o+bzLPYHtsRn93XcoINoC2ioqgyN3eoha35w9fzQ9PxSwKHVyW
Vz7c1JZbaJuQnH5UYG1Qy3K4K4MgqAgTGny8ia0ct7aX05HaxPgQXWq3AoGBANVF
OCqrtGb+/b3KshtPOJbf5ZBSekGWLuDmosmjLcL4oD7FInQGoy4Npu6tb2FQHDZ+
47kNTwc/IiwOvHyXIrlTB4zbSqxOxY2Y7yv0txbaSAvwt136h5zuV93n48DO+BJD
xFAAzhYKAUCsnIxUjRKfLLIWfMjB+uTCEaOQCRGTAoGATsy5lqZy7pjeU/T0GlAA
21G0N1YuTBQ0c0+fubNQPBoICF1kQZVunpWHYTw1RawRdbDrDPqe201pQk+QLjsu
gr0wuByOr2yGIm8mdt4gTDaF3Qf28XAbDsEksslLqVIvQTjVTAMcdrnaz2Ndlypp
CiRB2VDQvqN+vqxi4HXjaZkCgYBaAFkgoM+D+64HTyf0oG0INrqBOl0/mmp0HMCs
CUIBmry9YKIWhsqMX9SHuwda8NzHHqtpZ7VnIHyCTUG77mgH/4MbLVwI9UEnbVfZ
m+88JKfs6gvoDBb44hiQnBCgSHel9ZU+Eejmohg/O9jg27mhFy1chmLosfv4V/Hr
rZg2IwKBgQCsngJZuupvJiEVSTe9SNGdqxA8dlxbbaZN7TgjBGfJacgUXAClZCU0
GpSzS9tu0RvsmuNLD1P2dEk1LFR3buo+BzVaer5bByE7PyYmWi1C802D+urDtJcz
dUWvXBOuZBbcHrHFj51pBDl5O5VUR2bbwFHtApj+r06lrBV+9HVeZA==
-----END RSA PRIVATE KEY----- 
```

现在我用 2097152 个块加密文件，因为文件很大：

```
// Now read the file!
$fp = fopen($file_name, 'rb');
$fw = fopen($file_name.'.enc', 'ab');

while (!feof($fp)) {
    $block_content = fread($fp, 2097152);

    $pubKey[] = openssl_pkey_get_public( $public_key );
    $sealed = "";
    $ekeys = "";
    openssl_seal( $dataToEncrypt, $sealed, $ekeys, $pubKey );

    fwrite( $fw, $_sealed );
    $sent_block_count++;
} // end while 
```

此代码没问题 - 文件已加密并保存....

问题是解密过程：

```
 $fp = fopen($file_name, 'rb');
    $fw = fopen($new_name, 'ab');
    if ( $fp && $fw ) {

    while (!feof($fp)) {
        $block_content = fread($fp, 2097152);
        $privKey = openssl_pkey_get_private( $_private );
        $open = "";
        $ekeys = "";
        openssl_open( $sealed, $open, $ekeys, $private_key );
        fwrite( $fw, $open );
        $sent_block_count++;
    } // end while 
```

我没有收到任何错误，但输出文件始终为零字节。

# wordpress - 谷歌搜索结果中的一些帖子标题中写有“头像”

> ID：15364906
> 
> 赞同：0
> 
> 时间：2013-03-12T15:08:52.527
> 
> 标签：wordpress

当我在 google 中搜索博客中的帖子时，某些结果的标题中包含“头像”。 [google 搜索链接](https://www.google.de/#hl=en&output=search&sclient=psy-ab&q=Jura-News%3a+Aktuelle+Entwicklungen+im+e-Trade-Recht&oq=Jura-News%3a+Aktuelle+Entwicklungen+im+e-Trade-Recht&gs_l=hp.3...4120.4120.0.4603.1.1.0.0.0.0.156.156.0j1.1.0.les;..0.0...1c.1.5.psy-ab.c5vqrSTFTD4&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.43287494,d.Yms&fp=aef84b2676c9749c&biw=1024&bih=668) 如果你打开链接，你会看到第 4 个结果的标题中写着“头像”，但第 3 个和第 4 个。任何人都可以提出任何解决方案如何删除这个东西吗？谢谢。

# dynamics-crm-2011 - 将联系人添加到 CRM2011 上的营销列表

> ID：15364907
> 
> 赞同：1
> 
> 时间：2013-03-12T15:09:02.593
> 
> 标签：dynamics-crm-2011, crm

我正在尝试构建一个将联系人添加到营销列表的工作流。

一切似乎都很好，但是当代码完成触发时，我转到营销列表-> 成员，联系人不在列表中。

```
public class ContactToMList : CodeActivity
    {
        [Input("Contatto")]
        [ReferenceTarget("contact")]
        public InArgument<EntityReference> contact { get; set; }

        [Input("Marketing List")]
        [ReferenceTarget("list")]
        public InArgument<EntityReference> MList { get; set; }

        [Input("Inserimento")]
        public InArgument<bool> inserimento { get; set; }

        bool action = false;
        private static IOrganizationService myService = null;
        private static Log_Entity log = new Log_Entity(string.Empty, myService);
        protected override void Execute(CodeActivityContext executionContext)
        {
            try
            {
                ITracingService tracingService = executionContext.GetExtension<ITracingService>();

                // Create the context
                IWorkflowContext context = executionContext.GetExtension<IWorkflowContext>();

                IOrganizationServiceFactory serviceFactory = executionContext.GetExtension<IOrganizationServiceFactory>();

                // Create the Organiztion service
                IOrganizationService service = serviceFactory.CreateOrganizationService(context.UserId);
                myService = service;
                log.WriteLog("");
                // Get the target entity from the context
                Entity target = (Entity)context.InputParameters["Target"];

                Guid contactiId = contact.Get<EntityReference>(executionContext).Id;
                Guid ListId = MList.Get<EntityReference>(executionContext).Id;
                bool insert = inserimento.Get<bool>(executionContext);

                // Prepare DataContext by using AutoGenerated cs file
                XrmDataContext datacontext = new XrmDataContext(service);

                var MyContact = (from c in datacontext.ContactSet where c.ContactId == contactiId select c.Id).ToArray();
                var MyList = (from l in datacontext.ListSet where l.Id == ListId select l).ToList().FirstOrDefault();
                // tutti i membri della lista di marketing
                var members = (from m in datacontext.ListMemberSet where m.ListId.Id == MyList.ListId select m.EntityId.Id).ToArray();

                foreach (Guid id in members)
                    if (MyContact.FirstOrDefault() == id)
                        action = true;

                if (insert && !action)
                {

                    AddListMembersListRequest AddMemberRequest = new AddListMembersListRequest();

                    AddMemberRequest.ListId = ListId;
                    AddMemberRequest.MemberIds = MyContact;
                    // Use AddListMembersListReponse to get information about the request execution 

                    AddListMembersListResponse AddMemberResponse = service.Execute(AddMemberRequest) as AddListMembersListResponse;
                    //service.Update(MyList);

                }
                else if (!insert && action)
                {

                    RemoveMemberListRequest RemoveMemberRequest = new RemoveMemberListRequest();
                    RemoveMemberRequest.ListId = ListId;
                    RemoveMemberRequest.EntityId = MyContact.FirstOrDefault();
                    // Use AddListMembersListReponse to get information about the request execution 
                    RemoveMemberListResponse RemoveMemberResponse = service.Execute(RemoveMemberRequest) as RemoveMemberListResponse;
                   // service.Update(MyList);

                }

            }
            catch (Exception ex)
            {
                log.WriteLog(ex.Message);

            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:22:13.407

你不是在设置后删除你的价值观`AddMemberRequest.MemberIds`吗？

编辑：好的，我想我这次找到了。你`public InArgument<bool> inserimento { get; set; }`很可能是罪魁祸首。

在这种情况下，您的 Workflow 活动希望在调用此 Workflow 的上游定义它。对于 Insert 和 Remove 实例，它很可能是静态设置的，并且从未更改过。如果这是真的，那么它本质上是针对 Insert 案例进行硬编码的，这使得`else if (!insert && action)`Remove 的`if (insert && !action)`评估为 True，而 Insert 的评估为 False。

由于代码确实适用于 Remove，因此可以合理地假设它`bool action`正在运行；因此，我将从查看另一个 bool 变量开始。

如果我错过了，请告诉我。（或者如果我是对的，我不介意绿色复选标记。）

# ios - 即时应用商店促销代码？

> ID：15364910
> 
> 赞同：1
> 
> 时间：2013-03-12T15:09:24.163
> 
> 标签：ios, app-store, promotion-code

我最近遇到了一个付费 iOS 应用的[促销活动](http://www.ign.com/prime/promo/walkingdead-free)，它似乎可以即时生成 App Store 促销代码。

我以为每个应用版本只能有 50 个促销代码。我在哪里可以找到有关此动态促销代码服务的更多信息？

*我找不到更好的 Stack Exchange 网站来问这个问题，而 iTunes Connect 确实属于“程序员常用的软件工具”类别。如果社区认为这个问题离题，请提前道歉。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:56:58.403

我认为这里的任何人都无法帮助您，至少在不违反保密协议的情况下不会。

对于大多数应用程序，您必须使用 iTunes Connect 中的 50 个促销代码限制。但是，Apple 将与开发者和发行商合作进行更大规模的促销活动——例如，星巴克的免费“本周应用程序”，或您链接到的这个 IGN 促销活动。

“普通”或典型的应用商店开发人员无法访问此内容。您需要直接访问 Apple 的营销/应用商店联系人，这通常仅适用于一定规模的开发人员。很抱歉，这对你来说不是更好的消息。如果您*是*大型开发人员，那么您应该直接与 Apple 联系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-03T00:44:28.667

您从 iTunes Connect 获得的 100 个促销代码与作为营销活动的一部分广泛分发的促销代码之间存在差异。从技术上讲，您只能在内部使用 100 个促销代码或与记者等分享。如果您想获得促销代码进行营销，请直接通过**AppStoreMarketing@apple.com**联系 Apple并索取促销代码以进行大型促销。

# svn - 如何在 SVN 中创建 UpdateOnly 帐户？

> ID：15364912
> 
> 赞同：1
> 
> 时间：2013-03-12T15:09:33.923
> 
> 标签：svn, tortoisesvn

我想知道有什么方法可以创建一个用户只能从主存储库更新并且他们不能提交任何东西的帐户。我想在 TortoiseSVN 中有这个配置。

# ios - 在 UICollectionViewFlowLayout 使其布局无效后重绘单元格

> ID：15364913
> 
> 赞同：3
> 
> 时间：2013-03-12T15:09:36.503
> 
> 标签：ios, uicollectionview, uicollectionviewlayout

当您使布局无效时，`UICollectionViewFlowLayout`它会为每个单元格创建一堆新的布局属性；但是，它不会告诉您的单元格重绘，这会导致任何图层图形失真。

我不想告诉我的集合重新加载它的数据，因为这会删除您在流属性之间拥有的任何不错的过渡：例如，我有一个网格布局过渡到一个覆盖流。

我需要一种方法让`UICollectionViewController`类告诉单元格`[setNeedsDisplay]`在获得布局属性后调用它们的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:27:46.477

当您的单元格改变大小时，由他们决定如何处理（拉伸与重绘）。这由 UIView`contentMode`属性控制；尝试将其设置`UIViewContentModeRedraw`为导致调整大小以使您的视图内容无效`setNeedsDisplay:`。

如果您将 CALayers 直接用作单元格的子层，则可以将其设置`needsDisplayOnBoundsChange`为`YES`以获得相同的效果。

# mongodb - MongoDB：匹配多个数组元素

> ID：15364920
> 
> 赞同：6
> 
> 时间：2013-03-12T15:09:58.110
> 
> 标签：mongodb

我有一个包含下一个数据的集合：

```
db.MyCollection.insert({ 
        id: 1, 
        Location: [ 1, 1 ],
        Properties: [ { Type: 1, Value: "a" }, { Type: 2, Value: "b" }, { Type: 3, Value: "c" } ]
    });

db.MyCollection.insert({ 
        id: 2, 
        Location: [ 1, 2 ],
        Properties: [ { Type: 1, Value: "a" }, { Type: 2, Value: "a" }, { Type: 3, Value: "c" } ]
    });

db.MyCollection.insert({ 
        id: 3, 
        Location: [ 2, 1 ],
        Properties: [ { Type: 1, Value: "a" }, { Type: 3, Value: "b" }, { Type: 3, Value: "a" } ]
    });

db.MyCollection.insert({ 
        id: 4, 
        Location: [ 2, 2 ],
        Properties: [ { Type: 2, Value: "b" }, { Type: 2, Value: "a" }, { Type: 3, Value: "c" } ]
    });

db.MyCollection.ensureIndex({ Location: "2d"});
db.MyCollection.ensureIndex({ "Properties.Type": 1, "Properties.Value": 1});
db.MyCollection.ensureIndex({ Location: "2d", "Properties.Type": 1, "Properties.Value": 1}); 
```

我想要的是找到所有项目（使用上述任何索引）：

1.  匹配位置
2.  包含 (Type=1 and Value="a") 和 (Type=2 and Value="b") 的属性

这是我的查询（它不起作用，但看起来接近正确的）：

```
db.MyCollection.find(
{ 
    Location: { "$within": { "$center": [ [1, 1], 5 ] } },
    Properties: {
        $elemMatch: {
            $and: [
                { Type: 1, Value: "a" },
                { Type: 2, Value: "b" }
            ]
        }
    }
}) 
```

* * *

更新：

$all 查询效果更好，因为 $and 有问题（请参阅我在 JohnnyHK 答案中的评论）。感谢帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-12T15:28:45.740

在这种情况下，您希望文档包含一组特定的数组元素，您可以使用[`$all`](http://docs.mongodb.org/manual/reference/operator/all/#_S_all)运算符：

```
db.MyCollection.find(
{ 
    Location: { "$within": { "$center": [ [1, 1], 5 ] } },
    Properties: {
        $all: [
            {$elemMatch: { Type: 1, Value: "a" }},
            {$elemMatch: { Type: 2, Value: "b" }}
        ]
    }
}) 
```

要在没有`$all`操作员的情况下执行此操作，您可以使用：

```
db.MyCollection.find(
{ 
    Location: { "$within": { "$center": [ [1, 1], 5 ] } },
    $and: [
        { Properties: {
            $elemMatch: { Type: 1, Value: "a" }
        }},
        { Properties: {
            $elemMatch: { Type: 2, Value: "b" }
        }}
    ]
}) 
```

# html - 在电子邮件通讯中插入图像

> ID：15364926
> 
> 赞同：0
> 
> 时间：2013-03-12T15:10:14.457
> 
> 标签：html, image, email, newsletter

有人可以告诉我如何创建带有图像的 HTML 时事通讯吗？

我像这样使用了 img src 标签

```
<img src="http://abload.de/img/dfdfb.png" width="234px" height="34px"> 
```

但如果我**从 Outlook 发送邮件并在****Thunderbird**中打开邮件，*则没有图像。*

**如果我从Thunderbird**发送相同的 html 时事通讯并在**Outlook**中打开它，则图片*可用*。

这个问题：[如何在时事通讯中发送图像？](https://stackoverflow.com/questions/3131815/how-to-send-image-in-newsletter)没有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T13:12:52.547

要直接从 Outlook 发送 html，请将您的 html 放入网页（或文本编辑器的呈现预览）中，然后将呈现的结果复制到您的电子邮件正文中。使用自己输入到 Outlook 中的 html 代码（甚至设置为 HTML 选项）将不会呈现。

在您的简单情况下，将您的图像标记代码保存为 html 文件，在浏览器中打开该文件。应该是一个只有您的图像的白页。在浏览器中拖动图像并将其复制粘贴到您的电子邮件正文中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:18:29.560

这应该有效。看看你的链接。我刚刚访问了您的 src 链接..我得到了 404。

# iphone - iOS - 获取长/纬度附近的地址

> ID：15364927
> 
> 赞同：0
> 
> 时间：2013-03-12T15:10:15.497
> 
> 标签：iphone, ios, geocoding

我想知道是否有人知道如何获取经度和纬度周围的地址列表？

我一直在使用以下代码，但它总是产生一个地址：

```
[self.geocoder reverseGeocodeLocation: currentLocation  completionHandler:
 ^(NSArray *placemarks, NSError *error) {
     for (int i = 0; i < placemarks.count; i++)
     {
         CLPlacemark *placemark = [placemarks objectAtIndex:i];
         if (placemark.addressDictionary != nil)
         {
             Location *aLocation = [[Location alloc] init];
             aLocation.locationName = [placemark.addressDictionary valueForKey:@"Name"];
             aLocation.locationAddress = [placemark.addressDictionary valueForKey:@"City"];
             aLocation.currentLocation = placemark.location;
             [self.tableData addObject:aLocation];
         }
     }
    [self.locationsTableView reloadData];
 }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:17:27.423

我不确定核心位置的地理编码是否打算这样做。

谷歌允许这种搜索，但他们的 Places API 有限制。话虽如此，您可以搜索“Pizza”之类的内容并在半径范围内获得结果。

有关更多信息，请查看：[https ://developers.google.com/places/documentation/](https://developers.google.com/places/documentation/)

您可以使用他们的 API 基于纬度/经度进行查询，并使用搜索查询和半径来获得看起来像您所追求的结果。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:19:24.677

首先更改您的纬度和经度值（*并检查您的代码是否正确*）因为地图中的某些坐标未提供完整信息。

以下提供代码，如果某个坐标未提供完整信息，那么如何为您提供获取特定 CITY（*或其他 Infor*）名称的条件。
这里`getReverseGeocode` 方法调用由`[self getReverseGeocode];`

```
- (void) getReverseGeocode
    {
        CLGeocoder *geocoder = [[CLGeocoder alloc] init];

        if(currentLatLong.count > 0)
        {
            CLLocationCoordinate2D myCoOrdinate;

            myCoOrdinate.latitude = LatValue;
            myCoOrdinate.longitude = LangValue;

            CLLocation *location = [[CLLocation alloc] initWithLatitude:myCoOrdinate.latitude longitude:myCoOrdinate.longitude];
            [geocoder reverseGeocodeLocation:location completionHandler:^(NSArray *placemarks, NSError *error)
             {
                 if (error)
                 {
                     NSLog(@"failed with error: %@", error);
                     return;
                 }
                 if(placemarks.count > 0)
                 {
                     NSString *MyAddress = @"";
                     NSString *city = @"";

                     if([placemark.addressDictionary objectForKey:@"FormattedAddressLines"] != NULL)
                         MyAddress = [[placemark.addressDictionary objectForKey:@"FormattedAddressLines"] componentsJoinedByString:@", "];
                     else
                         MyAddress = @"Address Not founded";

                     if([placemark.addressDictionary objectForKey:@"SubAdministrativeArea"] != NULL)
                         city = [placemark.addressDictionary objectForKey:@"SubAdministrativeArea"];
                     else if([placemark.addressDictionary objectForKey:@"City"] != NULL)
                         city = [placemark.addressDictionary objectForKey:@"City"];
                     else if([placemark.addressDictionary objectForKey:@"Country"] != NULL)
                         city = [placemark.addressDictionary objectForKey:@"Country"];
                     else
                         city = @"City Not founded";

                   NSLog(@"%@",city);
                   NSLog(@"%@", MyAddress);
                 }
             }];
        }
    } 
```

# wpf - 在 Shell 中获取 IModuleManager 的实例

> ID：15364932
> 
> 赞同：2
> 
> 时间：2013-03-12T15:10:21.093
> 
> 标签：wpf, prism, mef

我一直在尝试使用 PRISM 和 MEF 编写 WPF 应用程序，并且能够启动并运行 Shell。我希望能够按需加载模块，所以我需要一个 IModuleManager 在 Shell 中的实例。但是，当我尝试导入它时，应用程序会中断。以下是相关代码：

引导程序：

```
public class Bootstrapper : MefBootstrapper
{
    protected override DependencyObject CreateShell()
    {
        return this.Container.GetExportedValue<Shell>();
    }

    protected override void InitializeShell()
    {
        base.InitializeShell();

        Application.Current.MainWindow = (Shell)this.Shell;
        Application.Current.MainWindow.Show();
    }

    protected override void ConfigureAggregateCatalog()
    {
        base.ConfigureAggregateCatalog();

        // Add this assembly to export ModuleTracker
        this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(Bootstrapper).Assembly));

        DirectoryModuleCatalog moduleCatalog = new DirectoryModuleCatalog();
        moduleCatalog.ModulePath = @".\Modules";
        moduleCatalog.Load();
        foreach (ModuleInfo moduleInfo in moduleCatalog.Modules)
        {
            this.ModuleCatalog.AddModule(moduleInfo);
        }

        DirectoryCatalog catalog = new DirectoryCatalog(@".\Modules");
        this.AggregateCatalog.Catalogs.Add(catalog);

        base.ConfigureAggregateCatalog();
    }

    protected override void ConfigureContainer()
    {
        //Export the Container so that it can be injected if needed.
        this.Container.ComposeExportedValue(Container);

        //Export the Module Catalog so that it can be injected if needed.
        this.Container.ComposeExportedValue(ModuleCatalog);

        base.ConfigureContainer();
    }

    protected override IModuleCatalog CreateModuleCatalog()
    {
        return new ConfigurationModuleCatalog();
    }
} 
```

贝壳：

```
[Export(typeof(Shell))]
public partial class Shell : Window, IPartImportsSatisfiedNotification
{
    [Import(AllowRecomposition = false)]
    private IModuleManager moduleManager;

    public Shell()
    {
        InitializeComponent();
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {

    }

    public void OnImportsSatisfied()
    {

    }
} 
```

我得到的例外是：

```
No exports were found that match the constraint: 
ContractName    Shell
RequiredTypeIdentity    Shell 
```

如果我删除 IModuleManager 的 [Import] 属性，一切正常。我需要做些什么来导出 IModuleManager 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:25:01.247

通过在 Bootstrapper 中注释以下行来解决此问题：

```
this.Container.ComposeExportedValue(ModuleCatalog); 
```

不知道为什么它会引起问题，但欢迎对此事有任何见解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T21:43:55.470

您必须注意的一件事是同一类型有多个导出。`ComposeExportedValue`当您使用以及使用 a `DirectoryCatalog`（可能包含`Export`相同类型的 an ）时，这很容易发生。

Nuget 上有一个很棒的软件包，用于诊断这些问题，称为[MEFX](http://nuget.org/packages/MEFX.Core.Unofficial/)

如果你得到这个库，你可以添加以下行来帮助找出发生了什么

```
var compositionInfo = new CompositionInfo(AggregateCatalog, Container);
CompositionInfoTextFormatter.Write(compositionInfo, Console.Out); 
```

`this.Container.ComposeExportedValue(ModuleCatalog);`如果您不介意从中发布任何错误，我很想看看当您离开程序时它会打印到“输出”窗口中的内容。

# regex - 如何修复 emacs 中未成功匹配的字体锁定正则表达式

> ID：15364934
> 
> 赞同：1
> 
> 时间：2013-03-12T15:10:29.550
> 
> 标签：regex, emacs, font-lock

我正在尝试在 emacs 中创建一个正则表达式来锁定任务文件中的任务、项目和注释。

Taskpaper 是一种简单的基于文本的任务管理格式，格式如下：

```
Project 1:
    - Task 1
    - Task 2
    Note about Task2    
Project 2:
    - Task 3
    Note about Task 3
A general note about something 
```

我正在使用我在这里找到的任务纸模式作为基础（[https://github.com/jedthehumanoid/taskpaper.el/blob/master/taskpaper.el](https://github.com/jedthehumanoid/taskpaper.el/blob/master/taskpaper.el)）。但是，这种模式是基于空格缩进的，目前看来，任务纸格式使用制表符来缩进。

```
(setq font-lock-defaults 
'(("^.*@done.*$" . font-lock-comment-face)
  ("^.*:$" . font-lock-function-name-face)
  ("^[\t]*[^-\t].*[^:]$" font-lock-comment-face)
  ("@.*" . font-lock-variable-name-face))) 
```

目前，第三个正则表达式（应该在评论面上锁定注释）不起作用，我不明白为什么。注释是所有不以 a 开头`-`且不以 a 结尾的任何缩进的行`:`

奇怪的是，在正则表达式生成器中，正则表达式`^[\t]*[^-\t].*[^:]$`成功匹配注释行。

我已经尝试按照其他一些问题的建议对 \t 字符（如 \\t）进行双重转义，但这似乎没有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:29:51.167

第三条规则与其他规则的不同之处在于其他规则使用点对，即`(xxx . yyy)`，而第三条使用列表表示法，即`(xxx yyy)`。

也可以使用列表表示法，但您必须提供要突出显示的子表达式，如`(regexp 0 font-lock-comment-face)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T18:19:50.690

如果 \t 在第三个表达式中，则将空格放在一边，即 [ \t] 表示 [\t] 等。因此，空格与 TAB 相匹配。高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:14:45.210

部分问题可能与 * 字符的使用有关。由于它匹配 0 次或更多次，因此您实际上并不要求该行以制表符开头。

# java - Java中的最大连续关键字数

> ID：15364936
> 
> 赞同：3
> 
> 时间：2013-03-12T15:10:31.220
> 
> 标签：java, max, keyword

有谁知道Java中连续关键字的最大数量是多少？

我想到的最长的是6：

```
 private static final native synchronized int function(); 
```

谢谢 ：）

# vba - Word VBA - 插入带有预定义文本的表单域

> ID：15364940
> 
> 赞同：1
> 
> 时间：2013-03-12T15:10:45.363
> 
> 标签：vba, ms-word

我正在使用

```
Selection.FormFields.Add Range:=Selection.Range, Type:= _
        wdFieldFormTextInput 
```

将一些表单域插入到 Word 文档中。我被要求为每个表单域添加一些文本，例如需要使用默认文本“放置”。

Word VBA可以做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:02:44.740

您可以添加一个结果：

```
Dim fld As FormField
Set fld = Selection.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
fld.Result = "placement" 
```

请参阅[http://msdn.microsoft.com/en-us/library/office/ff839761.aspx](http://msdn.microsoft.com/en-us/library/office/ff839761.aspx)

# mysql - 将 SQL 粘贴到 MySQL 命令行中

> ID：15364945
> 
> 赞同：12
> 
> 时间：2013-03-12T15:11:02.360
> 
> 标签：mysql

我有一个定义一些 SQL 代码的应用程序：

```
mySql = "SELECT     
            sq.question, 
            qs.title, 
            sq.id as question_id, 
            sq.type,
            qs.id as option_id, 
            sri.title as rankTitle,
            sri.id as rankId,
            sfi.title as formTitle,
            sfi.id as formId,
            sq.sub_type,
            sq.sort_order
FROM        survey_questions as sq 
LEFT JOIN   question_suboptions as qs
ON          sq.id = qs.question_id 
LEFT JOIN   survey_rankingitems as sri
ON          sq.id = sri.question_id
LEFT JOIN   survey_formitems as sfi
ON          sq.id = sfi.question_id
WHERE       sq.survey_id = #{@surveyId}
ORDER BY    sq.sort_order" 
```

我想将此代码（双引号之间的所有内容）粘贴到 MySQL 命令行中，更改一个参数并执行它，但我遇到了一个问题，MySQL 上方的每一行都会显示：

> 显示所有 1450 种可能性？（是或否）

然后是 1450 个不同的可用命令。如果我删除所有换行符和制表符，那么我可以粘贴进去，但这既费时又痛苦。有没有一种方法可以简单地粘贴上面的代码，对其进行编辑，然后将其作为一个单元执行？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-12-16T10:12:29.337

这是用户每次按键时的默认*mysql (CLI) 行为（* *mysql*使用底层的*readline*或*EditLine*库（不在 Windows 上））。`Tab`

 ***默认情况下，当用户请求`use`数据库时， *mysql*会读取表和字段定义。然后，按`Tab`键使*mysql*方便地使用已知的表和字段完成当前输入。

但是，将一些包含 TAB 字符（或）的文本粘贴到*mysql*中会触发相同的行为 - 即使实际上没有从键盘按下任何键。这可能很烦人。`\t``0x09``Tab`

* * *

但是，给*mysql*的两个选项可以防止这种行为。我最喜欢的是`--disable-auto-rehash`。另一个是`--quiet`或`-q`。

*   `--disable-auto-rehash`防止数据库、表和列名完成（不是从数据库中读取的，`rehash`如果以后需要完成，请使用该命令）。但是，命令历史记录被保留（通过`↑</kbd> and `↓</kbd> keys for instance). Which is convenient.``

*   `--quick`或者`-q`这使得*mysql*不使用*历史*文件并且没有完成（不读取数据库定义）。

在 Linux 上，可以添加一个别名`.bashrc`以`--disable-auto-rehash`自动使用

```
alias mysql2='mysql --disable-auto-rehash' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T15:14:07.427

您需要删除换行符和制表符。双制表符导致它显示`Display all 1450 possibilities? (y or n)`和换行符导致它提前执行。

如果是 PHP，请编写一个小脚本为您剥离它：

```
echo (preg_replace("/\s+/", " ", $string)); 
```

或其他语言的类似内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-12T15:18:08.603

也许您可以将语句保存到文本文件`myTest.sql`中，然后使用 MySQL 命令`source myTest.sql`运行它？然后，您可以调整文件中的 SQL，保存更改并再次运行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-28T15:43:56.983

[Breaking not so bad's answer](https://stackoverflow.com/a/27502149/399105)很好地解释了这个问题的原因。

从问题：

> 如果我删除所有换行符和制表符，那么我可以粘贴进去，但这既费时又痛苦。

就我而言，我只是用空格替换了选项卡，并且能够很好地粘贴查询。MySQL 控制台似乎不关心换行符，只关心选项卡。

作为防止这种情况的一种方法，大多数编辑器都有一个设置，当您按下`Tab`键时会插入制表符而不是空格。我通常以这种方式配置我的 IDE，但在这种情况下，它是我从 MySQL 工作台复制的查询。方便的是，它还有一个使用空格而不是制表符的设置：

*编辑*>*首选项*>*常规编辑器*> 检查*Tab 键插入空格而不是制表符*>*确定****

# random - 通过平均 5 个均匀样本的正常随机数？

> ID：15364949
> 
> 赞同：0
> 
> 时间：2013-03-12T15:11:08.177
> 
> 标签：random, normal-distribution

查看我们应用程序中的一些遗留代码，发现了 Normal RNG 的这种奇怪的实现。我想将它换成适当的 Box-Muller 转换，但需要一些鼓励。

如您所见，它生成从 -3.875 到 +3.875 的 5 个随机数，然后将它们平均得到从 -1 到 +1 的准正态分布值。这可能是对的吗？这怎么可能奏效？为什么是 5 个样本？

有人，请解释一下：

```
private double GetRandomNormalNumber()
    {
      const double SPREAD = 7.75;
      const double HALFSPREAD = 3.875;
      var random = new Random();

      var fRandomNormalNumber = ((random.NextDouble()*SPREAD - HALFSPREAD) +
                                 (random.NextDouble()*SPREAD - HALFSPREAD) +
                                 (random.NextDouble()*SPREAD - HALFSPREAD) +
                                 (random.NextDouble()*SPREAD - HALFSPREAD) +
                                 (random.NextDouble()*SPREAD - HALFSPREAD)
                                )/5;

      return fRandomNormalNumber;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:17:49.343

通过平均几个随机均匀样本来近似正态分布是标准的，这是[中心极限定理](http://en.wikipedia.org/wiki/Central_limit_theorem)的结果。通常采集 12 个样本。在你的情况下，有人决定只取五个样本，也许是为了效率。

看看[在 C/C++ 中按照正态分布生成随机数](https://stackoverflow.com/questions/2325472/generate-random-numbers-following-a-normal-distribution-in-c-c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:20:49.227

代码看起来是对的，它只是导致 0.0 附近的区域比范围边缘（-HALFSPREAD，HALFSPREAD）具有更高的概率。

我怀疑这 5 个数字是一个经过良好计算的值，很可能是“因为它有效”而被选中的

如果您将一个 RNG 替换为另一个，您应该能够：只要替换具有更好的实用特性，就没有人应该依赖现有 RNG 的特定输出

# java - 为什么我在这个程序中得到空指针异常？

> ID：15364952
> 
> 赞同：0
> 
> 时间：2013-03-12T15:11:21.360
> 
> 标签：java, nullpointerexception

我是 Java 新手，谁能解释为什么我得到一个**空指针异常**？此外，任何人都可以解释除 Scanner 之外的其他**可靠输入方法。**

错误

> **线程“主”** java.lang.NullPointerException中的异常
> 
> > 在 Theatre.main( **Theater.java:18** )

```
import java.util.Scanner;
public class Theater 
{
    public static void main(String[] args) throws Exception 
    {
        int Screen;
        Screens[] X = new Screens[5];
        Scanner input = new Scanner(System.in);
        do
        {
            System.out.println();
            System.out.println(" '0' to exit");
            System.out.println(" '1-5' for Booking Seats");
            System.out.println(" '10' for Displaying Seating Status");
            System.out.println("Enter Screen Number : ");
            Screen = input.nextInt();
            if(Screen >= 1 && Screen <= 4)
                X[Screen-1].bookSeat();
            else if(Screen == 0)
            {
                System.out.println("Thank You for Booking Seats in PVR Cinemas.");
                System.in.read();
                System.exit(0);
            }
        }while(true);

    }
}
class Screens
{
    private
        int[] Gold = new int[3];
        int[] Platinum = new int[3];
        int[] Diamond = new int[3];
        int g,d,p;
        Scanner input = new Scanner(System.in);
        final int MAX=3;
    public  Screens()
    {
        for( int i=0;i<3;i++)
        {
            Gold[i] = 0;
            Platinum[i] = 0;
            Diamond[i] = 0;
            g = d = p = 0;
        }
    }
    public void bookSeat()
    {
        int n=0,choice,i;
        System.out.println("\t\tMenu");
        System.out.println("1.Gold \tAvailable Seats : "+(3-g));
        System.out.println("2.Platinum \tAvailable Seats : "+(3-p));
        System.out.println("3.Diamond \tAvailable Seats : "+(3-d));
        System.out.println("4.Return to Main Menu");
        System.out.println("Your Choice : ");
        choice = input.nextInt();
        if(choice>=1 && choice<=3)
        {
                    System.out.print("How many Seats ? : ");
                    n = input.nextInt();
                    if( n<=0 )
                    {
                        System.out.println("Please Check your Input.");
                        return;
                    }
                    else if( n>=MAX )
                    {
                        System.out.println("The Maximum Number of Seats is : "+MAX);
                    }
        }
        switch(choice)
        {
            case 1:
                if(g+n >3)
                {
                    System.out.println("Housefull!");
                    break;
                }
                else
                {
                    int total = 0;
                    System.out.print("Seat Numbers are : ");
                    for(i=0;i<n;i++)
                    {
                        Gold[g++] = 1;
                        System.out.print("\t"+g);
                    }
                    total = 100 * n;
                    System.out.println("Total Money to be paid : "+total);
                }
            break;
            case 2:
                if(p+n >3)
                {
                    System.out.println("Housefull!");
                    break;
                }
                else
                {
                    int total = 0;
                    System.out.print("Seat Numbers are : ");
                    for(i=0;i<n;i++)
                    {
                        Platinum[p++] = 1;
                        System.out.print("\t"+p);
                    }
                    total = 125 * n;
                    System.out.println("Total Money to be paid : "+total);
                }
            break;
            case 3:
                if(d+n >3)
                {
                    System.out.println("Housefull!");
                    break;
                }
                else
                {
                    int total = 0;
                    System.out.print("Seat Numbers are : ");
                    for(i=0;i<n;i++)
                    {
                        Diamond[d++] = 1;
                        System.out.print("\t"+d);
                    }
                    total = 150 * n;
                    System.out.println("Total Money to be paid : "+total);
                }
            break;
            case 4:
            break;
            default:
                System.out.println("Sorry, That's an invalid Choice!");

        }
        return;
    }
    public void viewSeats()
    {
        int i;
        System.out.println("Gold Category : ");
        for(i=0;i<3;i++)
        System.out.print("\t "+Gold[i]);
        System.out.println("Platinum Category : ");
        for(i=0;i<3;i++)
        System.out.print("\t "+Platinum[i]);
        System.out.println("Diamond Category : ");
        for(i=0;i<3;i++)
        System.out.print("\t "+Diamond[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:13:32.417

您需要**填充**您的`Scrrens array`. 换句话说，您只初始化了 Scrren 数组，但从未初始化其元素。如果您不初始化其元素，它们将获得默认值，在这种情况下为**null**。猜猜当你在 null 上调用某个方法时会发生什么。你得到的繁荣**NPE 。**

```
Screens[] X = new Screens[5];
x[0] = new Screen(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:13:40.670

尽管您初始化了数组`X`，但您并没有初始化它的成员，因此当`X[Screen-1]`您使用空对象时（即使索​​引在边界中）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:13:52.777

因为您的数组`X`中没有任何元素，所以默认情况下每个元素都初始化为`null`. 所以基本上你正在尝试这样做，这`null.bookseat()`会导致`NullPointerException`.

同样重要的是要注意 if `Screen`is ever `5`（这是您的条件允许的`<= 5`），那么您将得到一个，`ArrayIndexOutOfBoundsException`因为您的数组只有索引`0,1,2,3,4`（总共 5 个）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-12T15:14:01.827

你得到一个 NullPointerException 因为你已经声明了一个数组来保存 5 个屏幕对象但是你从来没有用一个实际的屏幕对象初始化 5 个插槽

因此，当您尝试使用

```
X[Screen-1].bookSeat(); 
```

您正在引用数组中的空元素，当然您不能调用空对象的方法

您可以在使用对象之前添加一个检查并初始化屏幕

```
if(Screen >= 1 && Screen <= 4) {
    if (X[Screen-1] == null) 
       X[Screen-1] = new Screens();

    X[Screen-1].bookSeat();
} 
```

你的用法也有一些奇怪的地方。数组从零索引开始，但您使用零作为退出程序的值，因此从不使用索引为零的元素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-12T15:14:24.757

`X`正在创建您的数组，但元素未初始化，它们仍然为空。我认为您期望您的数组初始化如下：

```
Screens[] X = new Screens[5];
for (int x = 0; x < 5; x++) {
    X[x] = new Screens();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-12T15:16:14.050

因为`Screens[] X = new Screens[5];`数组 X 的所有 5 个元素都是空的！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-12T15:51:31.747

填充 Screens 数组的另一种方法

```
Screens[] X = { new Screens(), new Screens(), new Screens(),new Screens(), new Screens() }; 
```

您可能会发现使用集合中的[列表](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)更有用。

# php - 用 where 子句计算

> ID：15364959
> 
> 赞同：1
> 
> 时间：2013-03-12T15:11:35.883
> 
> 标签：php, sql

我尝试在几个不同的地方放置一个 where 子句，但无法弄清楚。我已经阅读了已经被问到但到目前为止还没有解决的问题。我想要`COUNT`for`items.item_aprv='1'`但无论我把它放在哪里我都会得到一个错误。我已经包含了整个 .php 文件以供参考。

```
<?php

include 'header1.php';
?>
<div id="templatemo_main">

<div id="content_full" class="float_r">
<br><h10>Browse Mints</h10><br><br>
<?php

$search="SELECT mint.*, COUNT(items.item_id) as total
    FROM mint
    LEFT JOIN items ON mint.mint_id=items.item_mint
    GROUP BY mint_id
    ORDER BY `mint_name` ASC ;";

$items=mysql_query($search); 
while($it=mysql_fetch_array($items)) {
?>          
<div class="mint_box">

<h10 style="font-size:15px;">
    <a href="mintitem.php?id=<?php echo $it['mint_id']; ?>">
        <?php echo $it['mint_name']; ?>
    </a> (<?php echo $it['total']; ?>)
</h10>
</div>          
<?php
} 
?>
<div class="cleaner h10"></div>
</div> 

<?php
include 'footer.php';

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:15:00.560

这对你有用吗？

```
SELECT mint.*, COUNT(items.item_id) AS total 
FROM mint 
LEFT JOIN items ON mint.mint_id = items.item_mint 
WHERE items.item_aprv = '1'
GROUP BY mint.mint_id 
ORDER BY mint.mint_name ASC 
```

作为旁注，您应该使用[`PDO`](http://php.net/manual/en/book.pdo.php)您的查询。它更安全，并且不推荐使用旧方法。

# iis - 即使文件存在，IIS 404 错误？

> ID：15364961
> 
> 赞同：1
> 
> 时间：2013-03-12T15:11:47.710
> 
> 标签：iis, nginx, web, localhost

我使用 IIS 7 已经有一段时间了，它一直运行良好，直到它突然开始为我的多个网站抛出 404 错误，即使它们确实存在。所有配置看起来都很好（路径，默认文档），但不是一个文件，无论格式或位置如何都会被加载。

另一个奇怪的事情是，当我尝试通过 localhost 或 127.0.0.1 但不是通过我的外部 IP 访问网站时，一切正常。

有谁知道为什么会发生这种情况以及我该如何解决？

编辑：

看来这个 404 页面不是内置的 IIS 错误页面。它与 nginx 相关联，但我不确定文件在我的服务器上的位置或我的页面被拦截的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T00:23:45.890

原来服务器被 Morfeus F***ing Scanner 劫持了，直到发生这种情况我才知道这是一件事。它的活动显示在服务器访问日志中。我基本上不得不重置整个服务器。这真是一件苦差事。

# datetime - SQL Server 2008 将 int 转换为 dd:hh:mm

> ID：15364962
> 
> 赞同：2
> 
> 时间：2013-03-12T15:11:52.263
> 
> 标签：datetime, sql-server-2008-r2, int

如何将表示分钟的`int`值（即：）转换为如下所示的值：（）。`1800``dd:hh:mm``days:hours:minutes`

所以`1800`应该转换成`1:06:00`（`1 day 6 hours 0 minutes`）。

在存储过程中，我有这个：

```
SELECT 
    Record_ID, Project_ID, Ticket_ID, WO_Type, DC, Title, Device_Quantity, 
    Total/1440 as Total,  
    ((Total - Elapsed) - DATEDIFF(mi, Record_Time, getdate())) as FinalTimeLeft, 
    Completed 
FROM Record 
```

我将如何将转换实施到 SP 中？多于`FinalTimeLeft=1800`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:22:43.610

这个例子怎么样 - 它有小时，分钟和秒，但它应该很容易修改天，小时和分钟：

```
SELECT 
  CAST(mins / 3600 AS VARCHAR) + ':' + 
  RIGHT('0' + CAST((mins % 3600) / 60  AS VARCHAR), 2) + ':' +
  RIGHT('0' + CAST(mins % 60 AS VARCHAR), 2)
FROM 
  (SELECT 1800 AS mins) a 
```

编辑：包括您的存储过程和我的代码修改为天，小时和分钟：

```
SELECT 
  *
  ,CAST(FinalTimeLeft / 1440 AS VARCHAR) + ':' +
     RIGHT('0' + CAST((FinalTimeLeft / 60) % 24 AS VARCHAR), 2) + ':' +
     RIGHT('0' + CAST(FinalTimeLeft % 60 AS VARCHAR), 2) AS duration
FROM ( 
SELECT 
  Record_ID
  ,Project_ID
  ,Ticket_ID
  ,WO_Type
  ,DC
  ,Title
  ,Device_Quantity
  ,Total/1440 as Total
  ,((Total-Elapsed)-DATEDIFF(mi,Record_Time,getdate())) as FinalTimeLeft
  ,Completed
FROM record) a 
```

# c# - 如何使用 html 敏捷包从 html 文本中提取所有 url

> ID：15364965
> 
> 赞同：1
> 
> 时间：2013-03-12T15:11:54.207
> 
> 标签：c#, html-agility-pack

我经常使用正则表达式从 html 文本数据中提取文件名，但我听说 html 敏捷包非常适合解析 html 数据。如何使用 html 敏捷包从 html 数据中提取所有 url。任何人都可以用示例代码指导我。谢谢。

这是我的代码示例，效果很好。

```
using System.Text.RegularExpressions;

private ArrayList GetFilesName(string Source)
{
    ArrayList arrayList = new ArrayList();
    Regex regex = new Regex("(?<=src=\")([^\"]+)(?=\")", 1);
    MatchCollection matchCollection = regex.Matches(Source);
    foreach (Match match in matchCollection)
    {
        if (!match.get_Value().StartsWith("http://"))
        {
                    arrayList.Add(Path.GetFileName(match.get_Value()));
                }
                match.NextMatch();
            }
            ArrayList arrayList1 = arrayList;
            return arrayList1;
        }

private string ReplaceSrc(string Source)
{
    Regex regex = new Regex("(?<=src=\")([^\"]+)(?=\")", 1);
    MatchCollection matchCollection = regex.Matches(Source);
    foreach (Match match in matchCollection)
    {
        string value = match.get_Value();
        string str = string.Concat("images/", Path.GetFileName(value));
        Source = Source.Replace(value, str);
        match.NextMatch();
    }
    string source = Source;
    return source;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:19:47.980

就像是：

```
var doc = new HtmlDocument();
doc.LoadHtml(html);

var images = doc.DocumentNode.Descendants("img")
    .Where(i => i.GetAttributeValue("src", null) != null)
    .Select(i => i.Attributes["src"].Value); 
```

`<img>`这会从文档中选择所有具有`src`属性集的元素，并返回这些 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:31:21.700

选择所有`img`具有非空`src`属性的标签（否则在获取属性值时会得到*NullReferenceException ）：*

```
HtmlDocument html = new HtmlDocument();
html.Load(path_to_file);
var urls = html.DocumentNode.SelectNodes("//img[@src!='']")
               .Select(i => i.Attributes["src"].Value); 
```

# reporting-services - iif 语句的差异

> ID：15364973
> 
> 赞同：1
> 
> 时间：2013-03-12T15:12:11.893
> 
> 标签：reporting-services

希望有人可以提供帮助：

这有什么区别

```
=iif(Parameters!WhichReport.Value(0) = "Occupancy", False, True) 
```

还有这个

```
=iif(Parameters!WhichReport.Value = "Occupancy", False, True) 
```

塔

韦恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:18:49.997

这根本不是 T-SQL，如果有的话，这看起来像是来自 SSRS 的表达式，对吗？`Parameters!WhichReport.Value`如果是这样，和之间的区别在于`Parameters!WhichReport.Value(0)`，第一个表达式用于单值参数（因此，它是唯一可以存储的值），而第二个表达式用于多值参数（在这种情况下，选择的第一个值是`Value(0)`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:19:18.467

第一个适用于传入的参数是一个值数组的概念。所以`Value(0)`将检索数组中的第一项，而第二条语句的工作原理是**只有一个**带有该参数的项传入。

由于数组是从 0 开始索引的，`Value(0)`因此将返回值数组中的第一项，而`Value(1)`返回第二项，依此类推...

# python - 有没有一种简单的方法从python中的无空格句子生成一个可能的单词列表？

> ID：15364975
> 
> 赞同：10
> 
> 时间：2013-03-12T15:12:16.100
> 
> 标签：python, nlp

我有一些文字：

```
 s="Imageclassificationmethodscan beroughlydividedinto two broad families of approaches:" 
```

我想将其解析为单个单词。我迅速查看了附魔和 nltk，但没有看到任何看起来立即有用的东西。如果我有时间在这方面进行投资，我会考虑编写一个动态程序，该程序具有 enchant 检查单词是否为英文的能力。我本来以为网上会有这样的事情，我错了吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T17:00:50.377

# 使用 trie 的贪婪方法

[使用Biopython](https://github.com/biopython/biopython) ( )试试这个`pip install biopython`：

```
from Bio import trie
import string

def get_trie(dictfile='/usr/share/dict/american-english'):
    tr = trie.trie()
    with open(dictfile) as f:
        for line in f:
            word = line.rstrip()
            try:
                word = word.encode(encoding='ascii', errors='ignore')
                tr[word] = len(word)
                assert tr.has_key(word), "Missing %s" % word
            except UnicodeDecodeError:
                pass
    return tr

def get_trie_word(tr, s):
    for end in reversed(range(len(s))):
        word = s[:end + 1]
        if tr.has_key(word): 
            return word, s[end + 1: ]
    return None, s

def main(s):
    tr = get_trie()
    while s:
        word, s = get_trie_word(tr, s)
        print word

if __name__ == '__main__':
    s = "Imageclassificationmethodscan beroughlydividedinto two broad families of approaches:"
    s = s.strip(string.punctuation)
    s = s.replace(" ", '')
    s = s.lower()
    main(s) 
```

# 结果

```
>>> if __name__ == '__main__':
...     s = "Imageclassificationmethodscan beroughlydividedinto two broad families of approaches:"
...     s = s.strip(string.punctuation)
...     s = s.replace(" ", '')
...     s = s.lower()
...     main(s)
... 
image
classification
methods
can
be
roughly
divided
into
two
broad
families
of
approaches 
```

# 注意事项

英语中有一些退化的情况，这是行不通的。您需要使用回溯来处理这些问题，但这应该可以帮助您入门。

# 强制性测试

```
>>> main("expertsexchange")
experts
exchange 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T22:25:32.813

这是亚洲 NLP 中经常出现的问题。如果你有字典，那么你可以使用这个[http://code.google.com/p/mini-segmenter/](http://code.google.com/p/mini-segmenter/)（免责声明：我写的，希望你不介意）。

请注意，搜索空间可能非常大，因为字母英文中的字符数肯定比音节中文/日文长。

# c# - 从同一列中检索多个值的有效方法

> ID：15364976
> 
> 赞同：2
> 
> 时间：2013-03-12T15:12:19.897
> 
> 标签：c#, mysql, wpf

我想使用从`mysql`.

直到现在我总是这样做：

```
if (rdr.Read())
{
    Item1.Visibility = Visibility.Visible;
    Item1txt.Text = rdr.GetString("item_name");
}
if (rdr.Read())
{
    Item2.Visibility = Visibility.Visible;
    Item2txt.Text = rdr.GetString("item_name");
}
if (rdr.Read())
{
    Item3.Visibility = Visibility.Visible;
    Item3txt.Text = rdr.GetString("item_name");
} 
```

这种方法很好用，因为我在每个按钮中检索了正确的值，但它使可读性变得很糟糕......

当我开始这个项目时，我对 C# 的了解为零，所以我尝试了一些类似的东西：

```
while (rdr.Read())
{
    Item4.Visibility = Visibility.Visible;
    Item4txt.Text = rdr.GetString("item_name");
    Item5.Visibility = Visibility.Visible;
    Item5txt.Text = rdr.GetString("item_name");
} 
```

但这给了我从按钮中的数据库中检索到的相同值。

**例子：**

`button 1: test1 | button 2: test1 | button 3: test1.. etc..`

**我需要的：**

`button 1: test1 | button2: test2 | button 3: test3.. etc..`

现在我的 C# 知识每天都在进步，所以我想学习一些新东西。

现在我正在尝试使用 foreach 循环，但我觉得我错过了一些东西：

```
using (MySqlConnection conn = new MySqlConnection(_CS))
{
    conn.Open();
    string cmd = "SELECT * FROM ordertopos LIMIT 10";
    MySqlCommand custid = new MySqlCommand(cmd, conn);
    using (MySqlDataReader rdr = custid.ExecuteReader())
    {
        System.Data.DataTable dt = new System.Data.DataTable();
        dt.Load(rdr);

        foreach (System.Data.DataRow row in dt.Rows)
        {
            Orderl1.Text = row["customerid"].ToString();
        }
    }
} 
```

本质上，我想知道如何设置从 mysql 检索的按钮的内容，以更有效且更易于维护的代码..

我是新来的`foreach`，所以请具体一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T10:14:02.227

我建议分几个步骤来做，以获得更好的可重用性

## 步骤1

```
List<string> myItems;

using (MySqlConnection conn = new MySqlConnection(_CS))
{
    conn.Open();
    string cmd = "SELECT * FROM ordertopos LIMIT 10";
    MySqlCommand custid = new MySqlCommand(cmd, conn);
    using (MySqlDataReader rdr = custid.ExecuteReader())
    {
        myItems= new List<string>();

        while (rdr.Read())
       {
            myItems.Add(rdr.GetString("item_name"));
       }
    }
} 
```

## 第2步

修改后[的 Olivier Jacot-Descombe 版本](https://stackoverflow.com/a/15365380/1993545)

```
for(int i =0; i< myItems.count; i++) {
    Button btn =   FindChild<Button>(this, "Item" + i); //"this" will be the control which contains your button's
    TextBlock tb = FindChild<TextBlock>(btn, "Item" + i  + "txt");
    btn.Visibility = Visibility.Visible;
    tb.Text =myItems[i];
    i++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:19:02.057

如果您想扩展您的问题以便使用循环，那么您需要一个`List`或一个`Array`包含要为其设置属性值的对象。在您的特定情况下，将您`Orders`放入 a`List<Order>`然后您可以使用以下内容：

```
int count = 0;
foreach (System.Data.DataRow row in dt.Rows)
{
     if(count<orders.Count)
         orders[count++].Text = row["customerid"].ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:22:37.493

您需要遍历您的项目以设置相应的值。正如 DJ Kraze 建议的那样，您只是在覆盖相同的控件。并且它将具有最后访问的值（因为一旦循环结束它就不会被覆盖）。

您只需要以某种方式引用您的目标控件，或者如果您正在动态创建控件，那么您每次访问数据库中的一行时都可以简单地传递新创建的控件的引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:31:24.743

您可以使用此处找到的方法通过控件名称而不是成员变量来访问控件`FindChild`：[WPF 查找控件的方法](https://stackoverflow.com/a/1759923/880990)。

```
int i = 1;
while (rdr.Read()) {
    Button btn =   FindChild<Button>(this, "Item" + i);
    TextBlock tb = FindChild<TextBlock>(btn, "Item" + i  + "txt");
    btn.Visibility = Visibility.Visible;
    tb.Text = rdr.GetString("item_name");
    i++;
} 
```

这使您可以使用计数器 ( `i`) 循环遍历它们。

# android - Google Maps API v2 中的自定义叠加层

> ID：15364977
> 
> 赞同：0
> 
> 时间：2013-03-12T15:12:22.070
> 
> 标签：android, google-maps, google-maps-android-api-2

我需要在我的地图上创建一些自定义多边形叠加层，自定义是指我需要向叠加层添加更多信息，以便在单击它时可以显示一个对话框或包含有关叠加层信息的内容。

我做了一些阅读，看起来`Overlay`和`ItemizedOverlay`类已从 API v2 中以 等的形式`Polygons`删除`Polylines`...

为了创建自定义叠加层，看起来我必须`View`在地图顶部创建一个并仅在视图上绘制，但我的某些多边形对于当前可能不可见`map projection`

无论如何要为多边形类或其他东西分配一个ID，以便我知道点击了什么，以便我可以获取信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:44:42.440

首先，GMaps Android API v2 不提供单击多边形时的回调。您将不得不使用 onMapClick 并使用点内多边形算法迭代所有多边形。

如果您保留 Map 您可以迭代键，如果您有匹配项，则获取值。

或者，您可能想尝试[Android Maps Extensions](https://code.google.com/p/android-maps-extensions/)，它有一个`GoogleMap.getPolygons()`供您迭代和`Polygon.setData(Object)`+`Polygon.getData()`分配任何其他数据并在您使用多边形内的点算法找到匹配项时检索它。

# wpf - WPF：如何显示 Chart.ColumnSeries 的列值？

> ID：15364979
> 
> 赞同：0
> 
> 时间：2013-03-12T15:12:25.660
> 
> 标签：wpf, charts, wpftoolkit

我将 WPF 工具包用于用 C# 编写的 .Net 4.0 应用程序。我有一个包含绑定到字典的列系列的图表。该图表工作正常，但我想在每列下方的文本框中、每列中间或每列顶部显示每列的实际值。我已经搜索了一段时间，但无法找到有关此的任何信息。我为图表和 ColumnSeries 设置了样式，但还没有取得任何进展。有什么建议么？

我的图表 xaml 是：

```
xmlns:DV="clr-namespace:System.Windows.Controls.DataVisualization;assembly=System.Windows.Controls.DataVisualization.Toolkit"
xmlns:DVC="clr-namespace:System.Windows.Controls.DataVisualization.Charting;assembly=System.Windows.Controls.DataVisualization.Toolkit"
...
<Page.Resources>
 <Style x:Key="MyChart" TargetType="DVC:Chart">
  <Setter Property="PlotAreaStyle">
   <Setter.Value>
    <Style TargetType="Grid">
     <Setter Property="Background" Value="#FF2D2D30" />
    </Style>
   </Setter.Value>
  </Setter>
 </Style>

 <Style x:Key="NoLegend" TargetType="DV:Legend">
  <Setter Property="Visibility" Value="Hidden" />
  <Setter Property="Width" Value="0" />
 </Style>

 <Style x:Key="ColumnSeriesStyle" TargetType="{x:Type DVC:ColumnSeries}">
  <Setter Property="IsTabStop" Value="False"/>
  <Setter Property="Template">
   <Setter.Value>
    <ControlTemplate TargetType="{x:Type DVC:ColumnSeries}">
     <Canvas x:Name="PlotArea" Visibility="Visible">
      <TextBox Text="{Binding Path=Value.Value}" IsReadOnly="True"/>
     </Canvas>
    </ControlTemplate>
   </Setter.Value>
  </Setter>
 </Style>
</Page.Resources>
...
<DVC:Chart Name="TempChart" Style="{StaticResource MyChart}" LegendStyle="{StaticResource NoLegend}">
 <DVC:Chart.Series>
  <DVC:ColumnSeries IndependentValueBinding="{Binding Path=Value.Value}"
                    DepdendentValueBinding="{Binding Path=Value.Value}"
                    ToolTip="{Binding Path=Value.Value}"
                    Style="{StaticResource ColumnSeriesStyle}">
   <DVC:ColumnSeries.DependentRangeAxis>
    <DVC:LinearAxis x:Name="TempYAxis"
   </DVC:ColumnSeries.DependentRangeAxis>
 </DVC:Chart.Series>
</DVC:Chart> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:20:54.803

我设法用这个来设置我的 ColumnSeries 的样式：

```
<Style x:Key="ColumnSeriesStyle" TargetType="{x:Type DVC:ColumnSeries}">
 <Setter Property="IsTabStop" Value="False"/>
 <Setter Property="Template">
  <Setter.Value>
   <ControlTemplate TargetType="{x:Type DVC:ColumnSeries}">
    <Canvas x:Name="PlotArea" Visibility="Visible">
     <!-- Actual Values -->
     <ListBox x:Name="ActualValueListBox" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
              Background="{StaticResource WindowBackground}" Foreground="#FFBB702F" BorderBrush="#FF2D2D30" ItemsSource="{Binding}" >
      <ListBox.ItemTemplate>
       <DataTemplate>
        <TextBox HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center" FontSize="12"
                 Foreground="{StaticResource ValueForeground}" Background="{StaticResource ValueBackground}" Width="40"
                 Text="{Binding Path=Value.Value}" />
       </DataTemplate>
      </ListBox.ItemTemplate>
      <ListBox.ItemsPanel>
       <ItemsPanelTemplate>
        <UniformGrid Rows="1" Height="20" 
                     Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DVC:ColumnSeries}}, Path=ActualWidth}"/>
       </ItemsPanelTemplate>
      </ListBox.ItemsPanel>
     </ListBox>
    </Canvas>
   </ControlTemplate>
  </Setter.Value>
 </Setter>
</Style> 
```

# c++ - <更改为>时如何优雅地避免代码重复？

> ID：15364980
> 
> 赞同：1
> 
> 时间：2013-03-12T15:12:26.403
> 
> 标签：c++

这是我的代码的简化版本：

```
template<typename TIterator>
TIterator findMaximalPosition(TIterator begin, TIterator end)
{
    TIterator result(begin);
    for (TIterator it = begin + 1; it != end; ++it)
    {
        if ((*it)->value > (*result)->value) // Here I just need to change to "<"
            result = it;                     // to get a findMinimalPosition
    }
    return result;
}

template<typename TIterator>
TIterator findMinimalPosition(TIterator begin, TIterator end)
{
    // almost the same
} 
```

这只是一个简化的例子。我的代码充满了两个功能相同的地方，除了一个`<`或`>`符号或是否`++`应该`--`使用。

我的问题是：

有没有一种方法可以减少代码中的这种重复

1.  破坏可读性
2.  降低性能？

我正在考虑使用指向运算符（`<`或`>`）的指针作为模板参数。这不应该降低性能，因为指针将是一个编译时间常数。有没有更好或常用的方法？

编辑：

所以我根据答案所做的是实现：

```
template <typename TIterator, typename TComparison>
TIterator findExtremalPosition(TIterator begin, TIterator end, 
                               TComparison comparison); 
```

然后只需调用：

```
return findExtremalPosition(begin, end, std::less<double>()); 
```

和

```
return findExtremalPosition(begin, end, std::greater<double>()); 
```

我希望这就是你的意思。`++`我想经过一番苦苦挣扎后，可以为`--`运营商完成类似的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:16:02.723

我将创建一个通用函数，该函数接受谓词并使用`std::greater`和`std::less`作为该函数的参数，以分别实现给定类型`findMaximalPosition`和`findMinimalPosition`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:38:39.667

正如[Ivaylo Strandjev](https://stackoverflow.com/users/812912/ivaylo-strandjev)所建议的，一种可能的解决方案是使用谓词。

因此，如果您更改函数以使用谓词...

```
typename std::vector<int> vec;

template<typename TIterator, bool (*Predicate)(const TIterator &, const TIterator &)>
TIterator findPosition(TIterator begin, TIterator end)
{
    TIterator result(begin);
    for (TIterator it = begin + 1; it != end; ++it)
    {
        if (Predicate(it, result))
            result = it;
    }
    return result;
} 
```

...然后，您定义了一些谓词来帮助您实现目标...

```
bool lesser(const vec::iterator &a, const vec::iterator &b)
{
    return (*a) < (*b);
}

bool greater(const vec::iterator &a, const vec::iterator &b)
{
    return (*a) > (*b);
} 
```

...那么你就可以做到这一点：

```
vec::iterator min = findPosition<typename vec::iterator, lesser>(v.begin(), v.end());
vec::iterator max = findPosition<typename vec::iterator, greater>(v.begin(), v.end()); 
```

优点是提供您认为有用的任何功能，而不仅仅是检查元素是否大于或小于其他元素的功能：

```
bool weird(const vec::iterator &a, const vec::iterator &b)
{
    return ((*a) | (*b)) & 0x4;
}

vec::iterator weird = findPosition<typename vec::iterator, weird>(v.begin(), v.end()); 
```

[这里](http://ideone.com/JQV1Nd)的例子。

但在做这项工作之前，请检查[算法库](http://en.cppreference.com/w/cpp/algorithm)是否已经完成了这项工作。

我认为它看起来非常整洁和简单。

希望能帮助到你。

# c++ - 回文和镜像字符串

> ID：15364986
> 
> 赞同：2
> 
> 时间：2013-03-12T15:12:37.167
> 
> 标签：c++, visual-c++

我正在编写一个读取字符串行的代码并检查它是否是镜像、回文或镜像回文问题是它总是显示错误的输入值，除了最后一个

**样本输入：**

```
NOTAPALINDROME 
ISAPALINILAPASI 
2A3MEAS 
ATOYOTA 
```

**代码：**

```
 #include<iostream>
  #include<string>
  #include<vector>
  using namespace std;

bool is_palindrome(const string &s)
{
    for(int i=0,j=s.length()-1;i!=j;i++,j--)
    {
        if(s[i]!=s[j])
            return false;
    }
    return true;
}
char get_mirror(const char &c)
{
    switch(c)
    {

    case 'A':return c;
    case 'E':return '3';
    case 'H':return c;
    case 'I':return c;
    case 'J':return 'L';
    case'L':return 'J';
    case'M':return c;
    case 'O':return c;
    case 'S':return '2';
    case 'T':return c;
    case'U':return c;
    case'W':return c;
    case'X':return c;
    case'Y':return c;
    case'Z':return '5';
    case'1':return c;
    case'2':return 'S';
    case'3':return 'E';
    case'5':return 'Z';
    case'8':return c;
    default: return'-1'; 

    }
}
 bool is_mirrored(const string &s)
 {
     for(int i=0,j=s.length()-1;i!=j;i++,j--)
     {
         if(get_mirror(s[i])!=s[j])
         {
             return false;

         }
     }
     return true;

 }

int main()
{
    vector<string>cases;
    vector<string>::iterator pt;
    string temp;
    while(getline(cin,temp))
    {
        cases.push_back(temp);

    }
    for(pt=cases.begin();pt!=cases.end();pt++)
    {
        cout<<*pt<<"    "<<is_palindrome(*pt)<<"   "<<is_mirrored(*pt)<<endl;
    }

    system("pause");
    return 0;
} 
```

**如果有很多字符串，则输出：**

```
NOTAPALINDROME
ISAPALINILAPASI
2A3MEAS
ATOYOTA
^Z
NOTAPALINDROME     0   0
ISAPALINILAPASI     0   0
2A3MEAS     0   0
ATOYOTA    1   1
Press any key to continue . . . 
```

**如果是一个字符串则输出：**

```
2A3MEAS
^Z
2A3MEAS    0   1
Press any key to continue . . . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:38:36.780

您的输入似乎有额外的空格会破坏您的字符串检查。这方面的证据是，您对许多字符串的输出显示 5 个空格而不是它应该显示的 4 个空格，但最后一行除外。要么手动清理你的输入，要么在你的程序中修剪你的输入字符串。（参见，例如[，修剪 std::string 的最佳方法是什么？](https://stackoverflow.com/questions/216823/whats-the-best-way-to-trim-stdstring)。）

# c - 模拟类似 shell 的行为

> ID：15364990
> 
> 赞同：1
> 
> 时间：2013-03-12T15:12:50.173
> 
> 标签：c

所以我想要的是当用户按下向上按钮时，我想立即显示命令而不显示 ^[[AI 已经知道如何从键盘识别上下，我知道 termios 可能是解决方案，但是来自java背景，我不太清楚如何做到这一点。由于某些限制，Ncurses 不是一种选择。如果可以，请帮忙。

我期望发生的是，当用户按下向上按钮时，我想立即在同一行上执行 printf

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main()
{

    char input[100];
    char *history[5];
    int currentHistory=0;
    int historyCount=5;
    history[0]="hi";
    history[1]="bye";
    history[2]="computer";
    history[3]="science";
    history[4]="Yo";

    while(input[0]!='Q')
    {
       if(input[0]==LEFT_ARROW;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:31:28.157

[您会在 GNU readline](http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html)或 BSD[编辑行](http://www.thrysoee.dk/editline/)库中找到此功能以及更多功能。它们提供了大致相同的功能，但是 GNU readline 库在 GPL 许可下，而 editline 在 BSD 许可下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:44:03.207

目前尚不清楚您是想更好地处理输入，还是更好地处理终端。

如果您想更好地处理输入，我建议将您的字符识别包装到一个返回整数的函数中，该函数为每个“已处理”键定义。这样你的输入看起来更像

```
int char = readChar(input);
if (char == KEY_UP_ARROW) {
  ...
} 
```

其中 readChar 检测第一个键是否是转义键，然后“窥视”以查看是否有额外信息可用（以区分独立转义键和箭头键）。

如果您打算更好地处理屏幕方面的事情，并且您的意图是使用自己包装的终端处理软件驱动终端，则需要参考 VT100 终端参考（假设您的 xterm 模拟 VT100（许多人都这样做））。 [此处描述了 VT100 代码](http://www.vt100.net/docs/vt100-ug/chapter3.html)。

请注意，操作系统会对输入进行一些额外处理（组合键组合，使程序更容易区分死键键盘设置等），因此您可以通过将终端置于不同的“模式”来禁用此终端内处理”。典型的模式包括“cooked”和“raw”，其中“raw”为您提供了为简单起见未组合的关键代码。

# c - lseek 导致 O_APPEND 模块中的分段文件

> ID：15364993
> 
> 赞同：0
> 
> 时间：2013-03-12T15:12:55.243
> 
> 标签：c, file, segmentation-fault, append

```
int main(int argc,char* argv[]){
    int fd;
    off_t foffset;
    char* fpath;
    char* rbuf;
    if(argc!=2){
        printf("insert filename as argument!\n");
        exit(1);
    }
    strcpy(fpath,argv[1]);
    if( (fd = open(fpath,O_RDWR | O_APPEND)) <0 )
        perror("error on open()");
    //try to use lseek in file opened in O_APPEND mode
    char buf[] = "I'm appending some text!\n"; 
    if( write(fd, buf , sizeof(buf)) <0 )
        perror("error on write()");
    printf("the write() operation was succesful, let's try to seek and read the file..\n");
    foffset = lseek(fd,0L,SEEK_CUR);
    if(foffset<0)
        perror("error on lseek() :");
    close(fd);
    return 0;
} 
```

为什么执行此代码时会产生分段错误？segFault 仅在添加 lseek 操作时发生，否则正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:15:29.873

`fpath`是一个野指针，即在调用`strcpy`. 但是，由于您只需要一个`const char *`文件名，您可以进行以下更改。

改变：

```
strcpy(fpath,argv[1]); 
```

至：

```
fpath = argv[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:31:45.480

如果要`fpath`单独使用，请更改定义：

```
char fpath[30]; 
```

现在您`strcpy`将按预期工作（尽管您应该检查字符串的长度是否低于 30）。但是，您可以直接传递`argv[1]`to `open`，因为您没有对它做任何其他事情。

# javascript - 带有不规则 .png 形状的 Javascript“拼图”

> ID：15364998
> 
> 赞同：5
> 
> 时间：2013-03-12T15:13:11.673
> 
> 标签：javascript, jquery, css, png, alpha

太棒了，我想做的基本上是一个拼图游戏。左侧是一个区域，其中有十几个重叠的 .png 文件，这些文件是“撕开的”纸片（所有不同的不规则形状，带有 alpha），当它们放在一起时，在右侧按顺序形成一张纸上面有注释。视觉效果（忽略旋转的部分）：

![在此处输入图像描述](../Images/f8d59e412c3fdd8f47f707f54c063e0a.png) 我不知道什么新东西，但我在开发它时要注意的两个主要问题是它必须在 ie8+ 和触摸设备上工作。所以这意味着没有闪光灯（这很容易）和没有画布（愚蠢的ie）；这让我留下了 js 和 svg？

js 中的拖放部分很简单，但我遇到的问题是，我相信你知道，alpha 通道被忽略，不规则的撕裂部分实际上是一个矩形。这使得这无法使用，因为碎片是堆叠的，碎片相互重叠。

我可以通过使用图像映射并在翻转时设置变量来对跌落进行精细的命中检测。

我环顾四周（这里+谷歌）并尝试了一些想法，但我无法解决不规则形状选择/拖动问题。有任何想法吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:54:44.767

**低技术解决方案**

*具有绝对位置的嵌套元素*

如果您愿意多花一点时间，有一种方法可以相当接近地实现这一目标，而无需使用 Flash、Canvas、SVG 甚至图像映射。与图像地图不同的是，它允许您在需要时在每个热点内嵌套相关内容（例如，弹出窗口）。

在最简单的情况下，您可以为每个拼图块使用一个矩形超链接热点。显然，这极大地限制了您可以支持的形状范围（不干扰重叠元素）。

但是，如果您获取该超链接标签并为其赋予多个跨度标签子标签，并为每个标签赋予绝对位置（相对于超链接），并将图像的适当部分应用于背景，那么您可以“构造”不规则占据单个不规则热点的图像形状，对重叠元素的干扰相对较小。

实际上，图像（具有透明区域）被视为一个 sprite 文件，其中超链接标签和子 span 标签各自占据“sprite 文件”的一部分。图像的大部分透明部分不会被超链接标签或跨度标签占据。

大多数形状可能可以使用超链接标签和 4 - 10 个跨度构建。当然，形状越不规则，它需要的跨度就越多。

我以前做过这个，在美国地图上为每个州创建热点，而不使用图像地图（或 Flash、Canvas、SVG），它并没有你想象的那么成问题。只需要一点时间来弄清楚如何将每个形状分解成正确数量的矩形的细节。

**问题**

*移动设备上的舍入误差*

这就是问题所在，这很糟糕。当网页在移动设备上缩放时（常规页面几乎总是在较小的设备上缩放），这会引入舍入误差，导致超链接标签和跨度标签的 px 位置可能水平变化至少 1 个像素和/或垂直。如果桌面浏览器被缩放，也会发生这种情况；只是桌面浏览器不经常缩放。

会发生的情况是，您往往会在每个形状的不同部分之间产生 1 个像素左右的分离（或重叠）。在许多情况下，这往往非常明显，并且在视觉上是不可接受的。根据实现的不同，位置可能相差 2px 或 3px。当它发生时，它很难解决，并且可以解决多少是有限度的。

最后我检查了一下，Firefox 是唯一一个足够聪明的浏览器，它可以在缩放页面上舍入 px 值以避免这个问题。希望其他浏览器最终会更好地支持它，因为即使是简单的页面也经常会出现舍入错误。

**解决方案**

*将图像与热点分开*

舍入误差对于热点（精度并不重要）并不是什么大问题。真正引起问题的地方是图像（当您看到图像未在应有的位置排列时）。

通过执行以下操作，可以避免最严重的图像舍入错误：

*   有一套用于热点的 HTML 代码，与上述相同，只是不显示热点中的图像的任何部分。给他们所有透明的背景。
*   为图像准备另一组 HTML 代码。每个都是显示所有图像的单个矩形元素。
*   将每个图像放置在与相关热点相同的位置。
*   确保热点集和图像集都具有相同的 z-index 顺序。所有热点都将位于所有图像之上，但在热点内和图像内的顺序需要保持一致。
*   当一个片段的热点被拖动时，更新相关图像的位置以保持它们在同一位置。实际上，图像在拖动时会遮挡热点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:18:53.910

[ExplorerCanvas](http://code.google.com/p/explorercanvas/wiki/Instructions)不适合您吗？我认为这将允许您创建基于画布的解决方案。这将比通过 javascript 处理纯 html 元素所做的任何事情都要好得多