# StackOverflow 问答 15203000-15203999

# iphone - 有没有办法以编程方式将我的 iPhone 恢复到出厂设置？

> ID：15203001
> 
> 赞同：5
> 
> 时间：2013-03-04T13:45:34.223
> 
> 标签：iphone, ios, objective-c, jailbreak

我正在为越狱的应用程序开发，我不在乎它是否被应用商店拒绝。我找到了一种使用这种方式彻底清除 iPhone 的方法[有没有办法以编程方式完全清除 iPhone 数据？](https://stackoverflow.com/questions/15195941/is-there-a-way-to-completely-wipe-out-iphone-data-programatically). 然而，这种方法存在一个问题。它使我的 iphone 一文不值，我必须使用 iTunes 恢复它。我只想以编程方式恢复我的 iphone。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-04T16:07:40.680

SpringboardServices 私有框架中有一个私有 API SBDataReset。它会擦除所有数据。

您可以查看[以下代码](https://github.com/lite/osxrce/blob/master/resetapp/main.m)，例如如何使用它。

使用此 API 的应用程序应具有“com.apple.springboard.wipedevice”工作权限。

顺便提一句。另一种选择是使用 MDM 协议。它有一个擦除命令。但是，它需要更多的机器（MDM 服务器，注册用户）。

# 更新 1

看起来链接中的示例代码已过时。我查看了 Preferences 和其他几个使用 SBDataReset 的 iOS 软件，看起来新参数被引入到 SBDataReset。

试试下面的代码（对不起，我现在没有越狱的iOS设备，所以我不能自己尝试）

```
#import <UIKit/UIKit.h>
#import <UIKit/UIApplication.h>
#include <dlfcn.h>
#include <stdio.h>

// Framework Paths
#define SBSERVPATH "/System/Library/PrivateFrameworks/SpringBoardServices.framework/SpringBoardServices"
#define UIKITPATH "/System/Library/Framework/UIKit.framework/UIKit"

#define WIPE_MODE_NORMAL 4

int main(int argc, char **argv)
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    // Fetch the SpringBoard server port
    mach_port_t *p;
    void *uikit = dlopen(UIKITPATH, RTLD_LAZY);
    int (*SBSSpringBoardServerPort)() = 
    dlsym(uikit, "SBSSpringBoardServerPort");
    p = SBSSpringBoardServerPort(); 
    dlclose(uikit);

    // Getting DataReset proc
    void *sbserv = dlopen(SBSERVPATH, RTLD_LAZY);
    int (*dataReset)(mach_port_t* port, int wipeMode) = dlsym(sbserv, "SBDataReset");
    dataReset(p, WIPE_MODE_NORMAL);
    dlclose(sbserv);

    [pool release];
} 
```

请注意，SBDataReset 函数还有第二个参数。

看起来 4 是普通擦除模式，6 是砖块擦除模式。

**免责声明**此代码按原样提供。我不知道如果设备以砖块模式擦除会发生什么。

# c# - Server 2008 上的 Windows filewatcher 服务崩溃

> ID：15203003
> 
> 赞同：0
> 
> 时间：2013-03-04T13:45:52.510
> 
> 标签：c#, windows-services, report-viewer2010

我制作了一个文件观察器服务，它读取放在目录中的每个 XML 文件并在标签上打印内容（Visual Studio 2012，Report viewer 2010）。服务在 Windows 8 上运行良好，但在服务器 2008 R2 上，每次我在目录中复制文件时都会崩溃。

```
public partial class MyService : ServiceBase
{
    public MyService ()
    {

        InitializeComponent();

        GetSourcePath();
    }

    private void GetSourcePath()
    {
        RegistryKey myKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Company\\MyService", false);
        if (myKey == null)
        {
            fsw.Path = @"C:\Source\";
        }
        else
        {
            fsw.Path = (string)myKey.GetValue("SourcePath");
        }
    }

    protected override void OnStart(string[] args)
    {
        base.OnStart(args);
        fsw.EnableRaisingEvents = true;
    }

    protected override void OnPause()
    {
        base.OnPause();
        fsw.EnableRaisingEvents = false;
    }

    protected override void OnContinue()
    {
        base.OnContinue();
        GetSourcePath();
        fsw.EnableRaisingEvents = true;
    }

    private void fsw_Created(object sender, FileSystemEventArgs e)
    {
        System.Threading.Thread.Sleep(2000);

        ReportViewer reportViewer = new ReportViewer();

        reportViewer.ProcessingMode = ProcessingMode.Local;
        reportViewer.LocalReport.ReportPath = @"rptLabel.rdlc";
        reportViewer.LocalReport.DataSources.Add(new ReportDataSource("DataSet", PrintLabel.GetPrintLabels(e.FullPath)));
        reportViewer.RefreshReport();

        AutoPrint.Export(reportViewer.LocalReport);
        AutoPrint.Print();
    }

    protected override void OnStop()
    {
        fsw.EnableRaisingEvents = false;
    }

} 
```

这里是另一个类的代码

```
 public class AutoPrint
{
    private static int m_currentPageIndex;
    private static IList<Stream> m_streams;

    public static Stream CreateStream(string name, string fileNameExtension, Encoding encoding, string mimeType, bool willSeek)
    {
        Stream stream = new MemoryStream();
        m_streams.Add(stream);
        return stream;
    }

    public static void Export(LocalReport report)
    {
        string deviceInfo =
          @"<DeviceInfo>
            <OutputFormat>EMF</OutputFormat>
            <PageWidth>10cm</PageWidth>
            <PageHeight>4cm</PageHeight>
            <MarginTop>0</MarginTop>
            <MarginLeft>0</MarginLeft>
            <MarginRight>0</MarginRight>
            <MarginBottom>0</MarginBottom>
        </DeviceInfo>";

        Warning[] warnings;
        m_streams = new List<Stream>();

        try
        {
            report.Render("Image", deviceInfo, CreateStream, out warnings);
        }
        catch (Exception exc)
        {
            System.Diagnostics.EventLog.WriteEntry("My Service", DateTime.Now.ToLongTimeString() + " Error rendering print : " + exc.Message);
            foreach (Stream stream in m_streams)
            {
                stream.Position = 0;
            }
        }

    }

    public static void Print()
    {
        PrintDocument printDoc = new PrintDocument();

        if(printDoc.PrinterSettings.IsDefaultPrinter) printDoc.PrinterSettings.PrinterName = "Printer Name";

        if (m_streams == null || m_streams.Count == 0) System.Diagnostics.EventLog.WriteEntry("MyService", DateTime.Now.ToLongTimeString() + " Error: no stream to print.");

        if (!printDoc.PrinterSettings.IsValid)
        {
            System.Diagnostics.EventLog.WriteEntry("MyService", DateTime.Now.ToLongTimeString() + " Error: cannot find the default printer.");
        }
        else
        {
            printDoc.PrintPage += new PrintPageEventHandler(PrintPage);
            m_currentPageIndex = 0;
            printDoc.Print();
        }
    }

    public static void PrintPage(object sender, PrintPageEventArgs ev)
    {

        try
        {
            Metafile pageImage = new Metafile(m_streams[m_currentPageIndex]);

            // Adjust rectangular area with printer margins.
            Rectangle adjustedRect = new Rectangle(
                ev.PageBounds.Left - (int)ev.PageSettings.HardMarginX,
                ev.PageBounds.Top - (int)ev.PageSettings.HardMarginY,
                ev.PageBounds.Width,
                ev.PageBounds.Height);

            // Draw a white background for the report
            ev.Graphics.FillRectangle(Brushes.White, adjustedRect);

            // Draw the report content
            ev.Graphics.DrawImage(pageImage, adjustedRect);

            // Prepare for the next page. Make sure we haven't hit the end.
            m_currentPageIndex++;
            ev.HasMorePages = (m_currentPageIndex < m_streams.Count);
        }
        catch (Exception exc)
        {
            System.Diagnostics.EventLog.WriteEntry("MyService", DateTime.Now.ToLongTimeString() + " Error rendering print page: " + exc.Message + "Inner exception :" + exc.InnerException );
        }

    }

} 
```

数据还有一个静态类 printLabel，但在这种情况下没有什么有趣的。它只加载数据。这是来自日志事件的第一条错误消息

应用程序：MyService.exe 框架版本：v4.0.30319 描述：进程因未处理的异常而终止。异常信息：System.IO.FileNotFoundException 堆栈：在 System.IO.FileSystemWatcher.OnCreated(System.IO.FileSystemEventArgs) 在 System.IO.FileSystemWatcher.NotifyFileSystemEventArgs 在 MyService.MyService.fsw_Created(System.Object, System.IO.FileSystemEventArgs) (Int32, System.String) 在 System.IO.FileSystemWatcher.CompletionStatusChanged(UInt32, UInt32, System.Threading.NativeOverlapped*) 在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32, UInt32, System.Threading.NativeOverlapped*)

这是来自事件日志的第二条消息

错误应用程序名称：MyService.exe，版本：1.0.0.0，时间戳：0x51349c1b 错误模块名称：KERNELBASE.dll，版本：6.1.7601.17932，时间戳：0x50327672 异常代码：0xe0434352 错误偏移：0x0000c41f 错误进程 id：0x2dc4 错误应用程序启动时间：0x01ce18d947393653 错误应用程序路径：C:\Program Files (x86)\Company\MyService\MyService.exe 错误模块路径：C:\Windows\syswow64\KERNELBASE.dll 报告 ID：a27c24e2-84cc-11e2-bb34- 0019992623e2

我制作了与控制台相同的应用程序，它运行良好。也许该服务没有读取文件的权限？我有人有一个想法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T10:40:51.703

我发现了问题。这是reportviewer 2010。安装ReportViewer Service Pack 1 后，他似乎不再崩溃了。崩溃发生在以下行：

```
ReportViewer reportViewer = new ReportViewer(); 
```

我也改变了这一行：

```
reportViewer.LocalReport.ReportEmbeddedResource = "MyService.rptLabel.rdlc"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T16:36:40.943

你得到`FileNotFoundException`并且你正在使用相对路径。这意味着最可能的问题是您的工作目录错误。尝试改用绝对路径。

有关更多信息，请参阅[Windows 服务在哪个目录中运行？](https://stackoverflow.com/q/884963/41071)

# php - PHP SQL 查询 2 表

> ID：15203019
> 
> 赞同：0
> 
> 时间：2013-03-04T13:46:51.460
> 
> 标签：php

我需要使用 php 查询来查询数据库。

我需要获取与 $somevalue 匹配的 id 和具有该 ID 查询表 2 的 id，以便我可以获取包含在找到该 id 的行中的字段值。

```
$somevalue = '123';

Select id from table1 where $somevalue = id

...so we have the ID ... now we query table 2

select id, field2 from table2 where id = $id

echo $id;
echo $field2 
```

如何在 php 查询中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T13:55:38.137

简单地试试这个。

```
 select t2.id, t2.field2 from table2 t2, table1 t1 where t1.id = t2.id and t1.id = $someValue 
```

完整代码如下

```
$query = sprintf("select t2.id, t2.field2 from table2 t2, table1 t1 where t1.id = t2.id and t1.id = '%s'",
    mysql_real_escape_string($somevalue));

// Perform Query
$result = mysql_query($query);

while ($row = mysql_fetch_assoc($result)) {
    echo $row['id'];
    echo $row['field2'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T13:51:44.950

您的查询语法应如下所示：

```
Select id from table1 where id = $somevalue 
```

但是为什么你想要你正在搜索的同一个 id 呢？你可以直接这样做：

```
select id, field2 from table2 where id = $somevalue 
```

看起来一团糟:(

无论如何，您可以[查看此链接](http://php.net/manual/en/mysqli.query.php)以了解如何在 PHP 中执行查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T13:53:20.753

试试这个：

```
"SELECT * FROM table1 as t1 Left JOIN table2 as t2 ON t1.id = t2.id WHERE t1.id = ".$somevalue."" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T13:53:48.720

使用内连接

```
SELECT table2.id table2.field FROM table1
INNER JOIN table2 ON table2.id = table1.id 
```

没有测试代码，我对 SQL（连接）很陌生。但是你看到了模式:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T14:24:26.163

您应该可以使用 a 来实现此目的`JOIN`，这是使用问题中的代码的示例

```
SELECT t2.field2
FROM table1 t1
JOIN table2 t2
   ON t1.id = t2.id
WHERE t1.id = $someValue 
```

这里看起来不正确的是在它们的`Id`列上加入表格。这通常是主键，不太可能在连接的两侧使用。

从一个表到另一个表进行连接以重建数据模型。为了使这更具体一点，我将更`table1`改为`People`和。以下查询通过表获取特定人员的。在这种情况下，该表有一列在 Addresses 表中保存此人的`table2``Addresses``StreetName``People``People``AddressId``Id`

```
SELECT a.StreetName
FROM People p
JOIN Addresses a
   ON p.AddressId = a.id
WHERE t1.id = $someValue 
```

然后，您可以应用 PHP 提供的任何机制来运行查询

# c++ - 如何检查两个整数类型定义是否相等？

> ID：15203025
> 
> 赞同：0
> 
> 时间：2013-03-04T13:47:06.097
> 
> 标签：c++

我正在使用一些对整数类型有自己定义的库。如何检查两个 typedef 是否用于等效类型？我在另一个问题中问如何检查两个 typedef 是否相同。但是，假设 int 和 long int 在我的编译器上都是 32 位的，并且两个库可能会使用它们。我希望检查报告 int 的 typedef 和 long int 的 typedef 对于这个编译器是相同的（可能不是另一个）。谢谢。

这与另一个问题不同。另一个问题的解决方案是 (int) 和 (long int) 未能通过检查，即使两者都是 32 位的。现在我希望他们通过检查。

我没有使用 C++11。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:04:16.840

我自己想出了这个解决方案。我目前只关心整数，但更通用的解决方案将不胜感激。任何反馈？谢谢。

```
#include <limits>

using namespace std;

typedef unsigned long long UINT64;
typedef unsigned long long UINT_64;
typedef unsigned int UINT_32;
typedef unsigned long int UINT32;

template<bool> struct static_assert;
template<> struct static_assert<true> {};

#define CHECK_INTEGER_TYPES(T, U) (numeric_limits<T>::is_specialized && numeric_limits<U>::is_specialized && numeric_limits<T>::is_integer && numeric_limits<U>::is_integer && (numeric_limits<T>::is_signed == numeric_limits<U>::is_signed) && (numeric_limits<T>::digits == numeric_limits<U>::digits))

int main()
{
    static_assert<(CHECK_INTEGER_TYPES(UINT64, UINT_64))>(); // pass
    static_assert<CHECK_INTEGER_TYPES(UINT64, UINT64)>(); // pass
    static_assert<CHECK_INTEGER_TYPES(UINT64, UINT_32)>(); // fail
    static_assert<CHECK_INTEGER_TYPES(UINT32, UINT32)>(); // pass
    static_assert<CHECK_INTEGER_TYPES(UINT32, UINT_32)>(); // pass
} 
```

# android - 在特定用户配置文件上打开 Foursquare Android 应用程序

> ID：15203029
> 
> 赞同：1
> 
> 时间：2013-03-04T13:47:14.580
> 
> 标签：android, android-intent, foursquare

我正在尝试在给定的用户配置文件上从我的 Android 应用程序打开 Foursquare 应用程序。我按照官方文档： [https ://developer.foursquare.com/resources/client#android](https://developer.foursquare.com/resources/client#android)

我创建了一个 Intent 类型`ACTION_VIEW`并给出了 URI，例如`[http://m.foursquare.com/user?uid=USER_ID](http://m.foursquare.com/user?uid=USER_ID)`，以及我想查看的配置文件的 ID：

```
Uri uri = Uri.parse("http://m.foursquare.com/user?uid=USER_ID");
Intent intent = new Intent(Intent.ACTION_VIEW, uri);
startActivity(intent); 
```

在 Android、2.3.3 和 4.2.2 上执行时，我得到以下行为：出现意图选择器并询问我完成操作的方式（Foursquare 或浏览器）。单击“Foursquare”时，我看到应用程序立即出现并消失。

我可以在 log cat 中看到 Intent 已启动。然后，`onResume`我的 Fragment 方法被调用，但没有解释 Foursquare 失败：

```
 03-04 14:40:55.305: I/ActivityManager(2690): Starting: Intent { act=android.intent.action.VIEW dat=http://m.foursquare.com/user?uid=USER_ID flg=0x3800000 cmp=com.joelapenna.foursquared/.BrowsableActivity } from pid 2690
03-04 14:40:55.320: I/OrientationDebug(2690): [pwm] in updateOrientationListenerLp()
03-04 14:40:55.320: V/OrientationDebug(2690): in updateOrientationListenerLp(), Screen status=true, current orientation=-1, SensorEnabled=true
03-04 14:40:55.320: I/OrientationDebug(2690): [pwm] needSensorRunningLp(), return true #4
03-04 14:40:55.320: W/ActivityManager(2690): Trying to launch com.joelapenna.foursquared/.BrowsableActivity
03-04 14:40:55.355: E/ResourceType(4814): Style contains key with bad entry: 0x010102f3
03-04 14:40:55.355: E/ResourceType(4814): Style contains key with bad entry: 0x0101030b
03-04 14:40:55.355: E/ResourceType(4814): Style contains key with bad entry: 0x01010397
03-04 14:40:55.355: E/ResourceType(4814): Style contains key with bad entry: 0x0101039c
03-04 14:40:55.410: D/szipinf(4814): Initializing inflate state
03-04 14:40:55.420: I/OrientationDebug(2690): [pwm] in updateOrientationListenerLp()
03-04 14:40:55.420: V/OrientationDebug(2690): in updateOrientationListenerLp(), Screen status=true, current orientation=1, SensorEnabled=true
03-04 14:40:55.420: I/OrientationDebug(2690): [pwm] needSensorRunningLp(), return true #4
03-04 14:40:55.445: D/MyFragment(6374): onResume 
```

`ACTION_VIEW`当使用 URI创建一个 Intent 类型时`foursquare://users/USER_ID`，它会启动 Foursquare 应用程序，但会停留在我的个人资料屏幕上，而不是在给定的个人资料上。

任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T00:38:08.317

嗯，这些 Intent 目前似乎没有按预期工作。我们的工程师正在努力解决这个问题，我们会及时通知您。

如果您立即需要解决方案，或许可以在 WebView 中打开用户的个人资料？（例如，[https](https://foursquare.com/user/620652) ://foursquare.com/user/620652 ）

# soapui - soapUI 负载测试脚本没有被终止

> ID：15203033
> 
> 赞同：3
> 
> 时间：2013-03-04T13:47:18.653
> 
> 标签：soapui

我在 Mac 上使用 soapUI 4.5.1 版本来执行一些负载测试。我有一个负载测试设置，线程数为 100，限制为 900 秒。一旦达到时间限制，我已选中复选框以停止脚本。它工作得很好。

现在我将线程数增加到 200 并启动了脚本。请注意，我正在使用 ./loadrunner.sh 脚本从命令行执行脚本。脚本开始执行，但 900 秒后它并没有自行终止。事实上，它并没有被终止。

你能帮我解决这个问题吗？

我试图在 loadrunner 中运行我的测试，但是 loadrunner 在 mac 中有一些 java 问题并且它没有开始。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T15:52:01.213

有时测试会继续运行，超出您设置的时间限制，因为它需要在停止测试之前完成它正在做的所有事情。

所以我的问题是，它在 900 秒后运行了多长时间？

如果您不依赖于soapUI，请尝试使用JMeter 或loadUI。我发现 JMeter 比soapUI 或 loadUI 更可靠。

您在 loadrunner 上遇到什么错误？

ps：我只在windows上使用过soapUI！

# sitecore - Sitecore - 项目版本弹出

> ID：15203036
> 
> 赞同：0
> 
> 时间：2013-03-04T13:47:26.530
> 
> 标签：sitecore

在 Sitecore 工作框中，有一个弹出窗口可以查看项目版本和比较项目版本。它使用以下代码（在 Workbox 模块中找到）：

```
 protected void Diff(string id, string language, string version)
    {
        Assert.ArgumentNotNull((object)id, "id");
        Assert.ArgumentNotNull((object)language, "language");
        Assert.ArgumentNotNull((object)version, "version");
        UrlString urlString = new UrlString(UIUtil.GetUri("control:Diff"));
        urlString.Append("id", id);
        urlString.Append("la", language);
        urlString.Append("vs", version);
        urlString.Append("wb", "1");
        Context.ClientPage.ClientResponse.ShowModalDialog(urlString.ToString());
    } 
```

我想在 IFrame 中为我的一个自定义控件显示相同的弹出窗口。这是推荐的方法吗，或者 API 中还有其他可用的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:03:04.770

我不认为**Sitecore**开发人员创建此代码是希望在自定义控件中重用此代码。尽管如此，如果你需要这个，那么我完全同意最好的选择是重用这段代码——这个弹出窗口肯定已经过**Sitecore**团队的良好测试，所以可以理所当然地认为它工作正常。

据我所知，在 Sitecore 中没有用于比较项目版本的 API 调用。

# java - Mahout 导入 Eclipse 时出现错误

> ID：15203037
> 
> 赞同：1
> 
> 时间：2013-03-04T13:47:31.457
> 
> 标签：java, eclipse, maven-2, mahout

我是 mahout 的新手，我是。在 ubuntu 12.04 上使用 mahout 0.5 版，并在系统上运行 hadoop 0.20，maven 已作为插件安装在 eclipse 上。在命令行上使用命令 bin/mahout 似乎工作正常。我在将其导入 Eclipse 时遇到问题

[我已使用此链接帮助将 mahout 项目作为现有的 maven 项目导入到 eclipse 中。](https://cwiki.apache.org/MAHOUT/buildingmahout.html)

我按照网站上所说的步骤进行操作。首先我做了 svn co [http://svn.apache.org/repos/asf/mahout/trunk](http://svn.apache.org/repos/asf/mahout/trunk)

然后这在 mahout 目录中创建了一个卡车文件夹。然后我做了 mvn install

现在将项目导入 Eclipse，却发现它充满了错误。有人可以帮我弄清楚为什么会这样..

[PS：我在将 Mahout 的 Maven 资源导入 Eclipse 时](https://stackoverflow.com/questions/11282737/errors-when-importing-mahouts-maven-resource-to-eclipse)也提到了错误，但似乎没有发布答案

# c++ - 是 std::map , 双> AND std:map< std::pair , double> C++ 中的有效数据类型？

> ID：15203040
> 
> 赞同：2
> 
> 时间：2013-03-04T13:47:45.537
> 
> 标签：c++, map

我知道`std::map`我们有一个键和一个对应的映射值。

现在在我提到的数据类型中，键的类型是`std::set<long>` or `std::pair<long, long>`。因此，请记住，地图中的值是基于键的排序值存储的，这是否有效。那么，`std::map<std::set<long>, double>` AND `std:map< std::pair<long, long>, double>`有效吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T13:49:41.287

[`std::set`](http://en.cppreference.com/w/cpp/container/set)有一个[`operator<`](http://en.cppreference.com/w/cpp/container/set/operator_cmp)在相同类型的两个集合之间执行字典顺序比较. 所以是的， an`std::set<T>`可以是地图的有效键。

An`std::pair<T1,T2>`也有一个[`operator<`](http://en.cppreference.com/w/cpp/utility/pair/operator_cmp)实现字典比较的方法，所以*当*两者都`std::map<std::pair<T1, T2>, T3>`有效并且有一个小于比较实现严格的弱排序时也是有效的。所以要求更严格。两者和都需要比较作为映射的键，但它们不需要它来形成有效的对。因此，有效的对不一定构成映射的有效密钥。另一方面，您可以使用自己的比较标准来实例化地图。*`T1``T2``operator<``T1``T2`*

 *```
std::map<std::pair<T1, T2>, T3, Comp> m; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T13:54:04.490

不，语法错误。你想要的是`std::map<std::set<a_type_here>, double>`，所以为 set 添加模板参数。

注意`a_type_here`应该有`operator<`或者你需要使用`std::set<a_type_here, compare_function>`

**你似乎想要的是：** `std::map<std::pair<long, long>, double> mapping`

**如何使用的示例；** `mapping[std::make_pair(1,2)] = 0.1;`*

# c# - MVC 4 Web API 发布

> ID：15203043
> 
> 赞同：6
> 
> 时间：2013-03-04T13:47:53.860
> 
> 标签：c#, asp.net, asp.net-web-api, httpclient

我想从远程客户端进行插入，因为我需要通过 http 发送数据。
我可以`getPerformances()`正确使用`httpClient` `api/performances?date={0}`

我想问一下我`postPorformances()`内部的实现`PerformancesController`是否正确，以及如何从客户那里调用它？

这是我的实现：

```
public class PerformancesController : ApiController
    {
        // GET api/performances
        public IEnumerable<Performance> getPerformances(DateTime date)
        {
            return DataProvider.Instance.getPerformances(date);
        }

        public HttpResponseMessage postPerformances(Performance p)
        {
            DataProvider.Instance.insertPerformance(p);
            var response = Request.CreateResponse<Performance>(HttpStatusCode.Created, p);
            return response;
        }
    } 
```

```
public class Performance {
    public int Id {get;set;}
    public DateTime Date {get;set;}
    public decimal Value {get;set;}
} 
```

我已经尝试过这个，但我确定：

```
 private readonly HttpClient _client;
  string request = String.Format("api/performances");
  var jsonString = "{\"Date\":" + p.Date + ",\"Value\":" + p.Value + "}";
  var httpContent = new StringContent(jsonString, Encoding.UTF8, "application/json");
  var message = await _client.PutAsync(request, httpContent); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T13:57:42.657

您可以使用`HttpClient`来调用此方法：

```
using (var client = new HttpClient())
{
    client.BaseAddress = new Uri("http://example.com");
    var result = client.PostAsync("/api/performances", new
    {
        id = 1,
        date = DateTime.Now,
        value = 1.5
    }, new JsonMediaTypeFormatter()).Result;
    if (result.IsSuccessStatusCode)
    {
        Console.writeLine("Performance instance successfully sent to the API");
    }
    else
    {
        string content = result.Content.ReadAsStringAsync().Result;
        Console.WriteLine("oops, an error occurred, here's the raw response: {0}", content);
    }
} 
```

在这个例子中，我使用了通用`PostAsync<T>`方法，允许我发送任何对象作为第二个参数并选择媒体类型格式化程序。在这里，我使用了一个匿名对象，它模仿了与`Performance`服务器上的模型相同的结构，并且`JsonMediaTypeFormatter`. 您当然可以通过将它放在一个合同项目中来在客户端和服务器之间共享这个`Performance`模型，这样服务器上的更改也会自动反映在客户端上。

旁注：C# 命名约定规定方法名称应以大写字母开头。所以`getPerformances`应该`GetPerformances`甚至更好`Get`，`postPerformances`应该`PostPerformances`甚至更好`Post`。

# java - 在整个 Java 类中使用变量

> ID：15203048
> 
> 赞同：-3
> 
> 时间：2013-03-04T13:48:20.787
> 
> 标签：java, variables, global

这可能是一个非常简单的答案，但我什至不确定要搜索什么才能找到它，所以我想我最好问一下。

我真的不明白如何创建一个我可以在整个 java 程序中使用的变量（特别是一个数组）？该变量需要通过多种方法访问，其大小由用户输入（args）设置。任何人都可以对此有所了解吗？为任何帮助而欢呼。

```
Public class example{

 //this is the array that needs accessing from multiple places
 int anArray[][];

 public static void main(String args[]){

   int size = 5;
   add1(size);
   add2(size);
 }

 public static void add1(int size){

   //seeing as the size of the array is being defined by the user input, it's created here after being passed the size argument. 

 }

 public static void add2(int size){

    //add more content to the array here
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T13:57:28.777

小心那些讨厌的静态修饰符......在处理多线程的东西时可能会带来很多麻烦......

您应该考虑对象实例。该`main`方法是静态的：它属于类本身，而不是实例。`new`因此，首先，您必须通过使用关键字构造一个实例来创建类的实例，如下所示：

```
Public class Example{ //note: Class Names Start UpperCased!

 //this is the array that needs accessing from multiple places
 int anArray[][];

 public static void main(String args[]){
   int size = 5;

   Example example = new Example(); // create instance
   example.add1(size); //using the instance
   example.add2(size);
 }

 public void add1(int size){ //note: no static!

   //seeing as the size of the array is being defined by the user input, it's created here after being passed the size argument. 
   anArray = new int[size][size]; //you can create it here

 }

 public void add2(int size){ //note: no static
    //add more content to the array here
    //do something here
    System.out.prin
 }
} 
```

然而，OOP 编程还有很多微妙之处，比如我会在构造函数中进行初始化，接受初始大小等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T13:57:46.640

您首先要为该类创建一个构造函数，用于初始化对象：

```
public example() {
    anArray = new Integer[10][10]();
} 
```

现在您已经初始化，您可以在其他方法中访问该变量，例如 add1 方法：

```
public void add1(int size) {
    anArray[1][1] = size;
} 
```

您说得对，这个问题非常基础，最好先上 Java 基础课程。[Oracle提供](http://docs.oracle.com/javase/tutorial/getStarted/index.html)的教程非常好，如果您不想花钱，我会推荐它。如果你愿意花点钱，[梁的Java入门，综合版](http://www.cs.armstrong.edu/liang/)是一个不错的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:05:13.800

首先，您正在错误地初始化它。

```
int anArray[][]; 
```

应该：

```
int[][] anArray; 
```

这就是您设置变量的方式。首先，在这种情况下，您将类型声明为 int，但它是一个 int，它是一个 2d 数组，因此您必须使用 int[][]。此时应该可以在整个此类中访问它。

现在在 main 方法中，如果这是您想要的方式，您必须使用 args[] 获取用户输入。现在，您自己将值设置为 5。

如果您知道 args[] 的工作原理， int size = args[0] 可能会起作用。这是对此的解释：[什么是“String args []”？主要方法Java中的参数](https://stackoverflow.com/questions/890966/what-is-string-args-in-java)

一旦你得到你的大小整数，你必须调用 anArray 的构造函数，因为现在它还没有被构造。这看起来像（如果你希望它是一个正方形）：

```
anArray = new int[size][size] 
```

此链接可能有助于进一步了解如何创建二维数组：[http ://www.java2s.com/Code/Java/Collections-Data-Structure/CreatingaTwoDimensionalArray.htm](http://www.java2s.com/Code/Java/Collections-Data-Structure/CreatingaTwoDimensionalArray.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T13:57:06.190

采用：

```
static int anArray[][]; 
```

静态变量可以通过静态和非静态方法访问。

静态方法不能访问非静态变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T14:00:11.573

我建议在您使用的任何编辑器（eclipse 或我假设的东西）中创建一个新项目，然后制作一个包含构建其他（逻辑类或 GUI）fx 对象的主程序的类文件。

设置类的好方法是这样的：

```
class ClassYourMaking {

    // Field Values go here. (variables that are used throughout a 
    // class is called field values).

    variable1; (notice no instanciation.)
    variable 2;
    // etc.

    // Constructor(s).
    public ClassYourMaking() {  // perhaps some params if it makes sense.
        // field values are usually initialized in the constructor somehow.
    }

    // Methods goes here.

    public void method1() {
        // something.
    }

} 
```

然后你可以有一个主程序，它不一定是唯一的方法，但你最好习惯于制作一个小的主程序。

```
class ClassYourMakingsMainProgram {

    public static void main(String[] args) {

        ClassYourMaking newInstance = new ClassYourMaking();

        // you can then reach into the object of your class like so:

        newInstance.method1();
    }
} 
```

如果这一切对您来说毫无意义，请帮自己一个忙，阅读类层次结构和使用 Java 中的对象。通过前几英里可能有点困难，但一旦你习惯了，你就不会有那么多问题了。

# jquery - jQuery 窗口滚动捕捉

> ID：15203050
> 
> 赞同：2
> 
> 时间：2013-03-04T13:48:26.843
> 
> 标签：jquery, scroll, mousewheel

好的，所以我想要做的是有一个页面，其面板跨越 100% 的宽度和高度。

```
<body>
  <div class="panel">
  </div>
  <div class="panel">
  </div>
  <div class="panel">
  </div>
</body> 
```

正文将溢出：隐藏。我想要做的是每次用户滚动一定量时，让我们说滑动或半旋转轮子，然后它滚动到下一个面板。所以它就像一个将下一个元素带入视口的甲板。

我处理它的方式是这样的：但我想不出一种不让滚动功能​​触发一百万次的方法。

这是我的 JS：丑陋的我也在使用鼠标滚轮插件。但我不确定如何实现它！

```
var scrollAmt = 0;
        $(window).on('mousewheel', function(event, deltaY){
            $('.projects').addClass('scrolled');
            if(event.originalEvent.wheelDelta > 0) {
                //down  
                    scrollAmt = scrollAmt -= $winHeight;
                    console.log(scrollAmt);
                    $('.projects').animate({marginTop: ''+ scrollAmt +'px'}, 2000);

            } else {
                if ($totalComputed === scrollAmt ){
                    console.log('last');
                } else {

                        scrollAmt = scrollAmt += $winHeight;
                        console.log(scrollAmt);
                        $('.projects').stop().animate({marginTop: '-'+ scrollAmt +'px'}, 2000);

                }
            }
        }); 
```

我已经尝试过使用 if 和 else 语句做一些事情，但我只是在第一方。

我正在尝试实现类似[http://mirkoborsche.com](http://mirkoborsche.com)

非常感谢任何帮助！

最好的，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T08:25:38.240

我认为您可以使用此插件完成工作：[https](https://github.com/alvarotrigo/fullPage.js) ://github.com/alvarotrigo/fullPage.js 。

此外，它似乎正在积极更新。对 repo 的最后一次提交是在 3 天前进行的。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:05:54.703

取消绑定并重新绑定滚动事件以确保滚动事件在特定时间不会触发：

模式是这样的：

```
$(window).on('mousewheel', processMouse(event, deltaY);

function processMouse(event, deltaY){

    if(event.originalEvent.wheelDelta > 0) {
        // Unbind the mousewheel event
        $(window).off("mousewheel");
        // Do some things like scrolling the page to the next waypoint
    } else {
        // Rebind the mousewheel event
        $(window).on('mousewheel', processMouse(event, deltaY);
    }
} 
```

# ruby-on-rails - 如何在 Ruby on Rails 中使用 FactoryGirl 创建具有嵌套属性的测试对象？

> ID：15203053
> 
> 赞同：14
> 
> 时间：2013-03-04T13:48:39.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, factory-bot

我有一个`Invoice`模型，其中可能包含许多`Items`：

```
class Invoice < ActiveRecord::Base

  attr_accessible :number, :date, :recipient, :items_attributes

  belongs_to :user

  has_many :items

  accepts_nested_attributes_for :items, :reject_if => :all_blank, :allow_destroy => true

end 
```

我正在尝试使用 RSpec 对此进行测试：

```
describe InvoicesController do

  describe 'user access' do

    before :each do
      @user = FactoryGirl.create(:user)
      @invoice = @user.invoices.create(FactoryGirl.attributes_for(:invoice))
      sign_in(@user)
    end

    it "renders the :show view" do
      get :show
      expect(response).to render_template :show
    end

  end

end 
```

不幸的是，此测试（以及所有其他测试）失败，并显示来自 RSpec 的以下错误消息：

```
Failure/Error: @invoice = @user.invoices.create(FactoryGirl.attributes_for(:invoice))
ActiveModel::MassAssignmentSecurity::Error:
Can't mass-assign protected attributes: items 
```

如何创建包含将通过我的测试的项目的发票？

我正在使用 FactoryGirl 来制作这样的对象：

```
factory :invoice do
  number { Random.new.rand(0..1000000) }
  recipient { Faker::Name.name }
  date { Time.now.to_date }
  association :user
  items { |i| [i.association(:item)] } 
end

factory :item do
  date { Time.now.to_date }
  description { Faker::Lorem.sentences(1) }
  price 50
  quantity 2
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:54:21.320

这是我试图弄清楚时添加书签的堆栈答案：

[工厂女孩嵌套工厂](https://stackoverflow.com/questions/14093293/factory-girl-nested-factory)

编辑：对不起，刚刚意识到答案是纯 FactoryGirl 而不是 rspec。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T20:16:37.820

你检查过[https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#associations](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#associations)吗？

有一部分是关于 has_many-associations 的。基本上它所说的是用一个在创建发票后添加一些项目的发票工厂来扩展你的发票工厂。

# mysql - 在 MySQL 的特定字段中对具有相同值的行进行分组

> ID：15203058
> 
> 赞同：8
> 
> 时间：2013-03-04T13:48:52.610
> 
> 标签：mysql, sql, group-by

我在 MySQL 表中有以下数据。

```
+--------+----------+------+
| job_id | query_id | done |
+--------+----------+------+
|  15145 | a002     |    1 |
|  15146 | a002     |    1 |
|  15148 | a002     |    1 |
|  15150 | a002     |    1 |
|  15314 | a003     |    0 |
|  15315 | a003     |    1 |
|  15316 | a003     |    0 |
|  15317 | a003     |    0 |
|  15318 | a003     |    1 |
|  15319 | a003     |    0 |
+--------+----------+------+ 
```

我想知道是否有可能有一个 sql 查询，它可以按 query_id **IF ALL 'done' 字段标记为 1**。我想象的可能输出是：

```
+----------+------+
| query_id | done |
+----------+------+
|  a002    |  1   |
|  a003    |  0   |
+----------+------+ 
```

我尝试了以下 SQL 查询：

```
select job_id, query_id, done from job_table group by done having done = 1 ; 
```

但没有运气。我真的很感激任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T14:03:59.673

我对这个解决方案并不特别自豪，因为它不是很清楚，但至少它既快速又简单。如果所有项目都*“完成”= 1*，那么总和将等于计数 SUM = COUNT

```
SELECT query_id, SUM(done) AS doneSum, COUNT(done) AS doneCnt 
FROM tbl 
GROUP BY query_id 
```

如果你添加一个有子句，你会得到“完成”的项目。

```
HAVING doneSum = doneCnt 
```

我会让你正确格式化解决方案，你可以做一个 DIFERENCE 来获得“未完成”的项目或 doneSum <> doneCnt。

[顺便说一句，这里](http://sqlfiddle.com/#!2/437f8/3)的 SQL 小提琴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-13T08:34:58.830

所有“完成”的工作：

```
SELECT * FROM job_table GROUP BY done HAVING MIN(done) = 1; 
```

所有“未完成”的工作：

```
SELECT * FROM job_table GROUP BY done HAVING MAX(done) = 0; 
```

所有具有相同值的作业（“完成”或“撤消”）：

```
SELECT * FROM job_table GROUP BY done HAVING MAX(done) = 0 OR MIN(done) = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-18T07:16:02.857

您的示例中的输出可以通过以下方式获得：

```
SELECT query_id, min(done) as done
FROM job_table
GROUP by done 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-04T13:52:16.437

尝试类似的东西

```
SELECT qry_id, 1
FROM (
    SELECT qry_id, done
    FROM tbl
    GROUP BY qry_id, done
) AS t
GROUP BY qry_id
HAVING COUNT(*)=1
UNION
SELECT qry_id, 0
FROM (
    SELECT qry_id, done
    FROM tbl
    GROUP BY qry_id, done
) AS t
GROUP BY qry_id
HAVING COUNT(*)>1 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-03-04T13:52:13.957

我想你应该看看这个

```
SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name 
```

# delphi - madExcept 可以冻结我的 Delphi 应用程序吗？

> ID：15203064
> 
> 赞同：0
> 
> 时间：2013-03-04T13:49:01.800
> 
> 标签：delphi, madexcept

我有一个使用 madExcept 3.0m 的基于 Delphi 5 的应用程序。由于 madExcept，我很欣赏它的质量，因此它通常不会因为任何事情而受到责备，因此它似乎冻结了。

这是代码：

```
 AddLogEntry('ME_Settings');
  try
    AddLogEntry('ME_Settings2');
    with MESettings do begin                     // madExcept-Einstellungen
      AddLogEntry('FrozenMsg');
      sOldFrozenMsg := FrozenMsg;
      AddLogEntry('Meldung vorbereiten');
      FrozenMsg := AnsiString(_('Das Öffnen der Datenbank dauert ungewöhnlich lang.'));
      AddLogEntry('Remote?');
      [...]
    end;
  finally
    [...]
  end; 
```

它没有抛出任何异常，只是在阅读时似乎冻结了`FrozenMsg`：（ [来源：][[quodata.de](http://quodata.de/fileadmin/temp/Daub/log.png)][）][![](../Images/0de22aec82ce96593b161a9efdc80cb3.png)](https://i.stack.imgur.com/9j5J5.png)

它不会发生在我的任何计算机上，但会发生在客户计算机上。madExcept 的 MESettings 怎么会导致这种行为。我应该如何调试这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T10:56:15.150

我们现在已经使用常规（并且非常相同）madExcept 3.0m 向客户部署了常规更新。有效。由于其他问题，他们更换了计算机，所以我很确定问题出在特定计算机上，madExcept 或我们的产品都不需要修复。

# jquery - 替代 JQuery .slideDown()

> ID：15203065
> 
> 赞同：1
> 
> 时间：2013-03-04T13:49:10.263
> 
> 标签：jquery

是否有已知的 jquery slideDown() 替代方法？

我问的原因是，我认为 slideDown 真的应该被命名为 roll down，因为它会解开内容，而不是它们实际上是向下滑动。

这是我的意思的效果示例 - 将鼠标悬停在页面上的主要项目之一（在 ie 中不起作用）：[示例向下滑动](http://foodgawker.com/)

理想情况下也需要在 IE 中工作，所以我猜这比 js 更具过渡性，这在 ie10 上的每个人都可以，可能需要一段时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T13:53:56.960

使用更多代码，您可以使用`.animate()`.

参考：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

一个小例子：

```
$(document).ready(function(){
  $(element).toggle(function(){
    $(this).animate({height:40},200);
  },function(){
    $(this).animate({height:10},200);
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T13:58:02.763

The way I would do this is set my container to position relative and an overflow hidden; Then have my hover over as position absolute with a top of -50px, then use jquery animate to move it down on hover.

[An example is here](http://jsfiddle.net/domjgreen/wenYD/)

```
<div class="container">
    <div class="hover"></div>   
</div>

.container{width:400px;height:400px; border:1px solid grey; position:relative;overflow:hidden;}
.hover{position:absolute;top:-50px; width:100%;height:50px; background-color:red;}

$('.container').hover(function() {
    $('.hover').animate({
        top: '+=50'
    });
},function(){
    $('.hover').animate({
        top: '-=50'
    });

}); 
```

# objective-c - XPath 语句获取 NSXMLDocument 中第一个元素的名称

> ID：15203068
> 
> 赞同：1
> 
> 时间：2013-03-04T13:49:12.053
> 
> 标签：objective-c, xml, xpath, nsxmldocument

我需要获取 XML 文档中第一个元素的**名称**，例如 XML 片段的字符串“TitleName”（这是 XML 文档的第一行）：

```
<TitleName Major="1" Minor="0" Revision="1"> 
```

为了获得字符串“TitleName”，我需要为此指定什么`XPath`命令（在下面的代码片段中）？`XPathRootName``NSXMLDocument`

```
NSData *xmlData = [xmlStr dataUsingEncoding:NSUTF8StringEncoding];
NSError *error;
NSXMLDocument *xmlDocument = [[NSXMLDocument alloc]initWithData:xmlData 
      options:0 error:&error];

NSXMLElement *rootNameXMLElement = [[xmlDocument 
      nodesForXPath:XPathRootName error:&error] lastObject];;
NSString *rootName = rootNameXMLElement.stringValue; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T13:53:31.837

XPath 表达式`/*`将匹配文档元素，但不使用 XPath 直接使用 的`rootElement`属性`xmlDocument`获取该元素会更简单。

# timer - TIM4 上的 STM32 旋转编码器配置

> ID：15203069
> 
> 赞同：2
> 
> 时间：2013-03-04T13:49:13.940
> 
> 标签：timer, stm32

我正在尝试将 TIM4 用于我的 STM32F4DISCOVERY 板上的正交编码器输入。这是我的代码：

```
RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB, ENABLE);
RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4, ENABLE);

GPIO_InitTypeDef GPIO_InitStructure;
GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;

GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6| GPIO_Pin_7;
GPIO_Init(GPIOB, &GPIO_InitStructure);

GPIO_PinAFConfig(GPIOB, GPIO_PinSource6, GPIO_AF_TIM4);
GPIO_PinAFConfig(GPIOB, GPIO_PinSource7, GPIO_AF_TIM4);

/* Configure the timer */
TIM_EncoderInterfaceConfig(TIM4, TIM_EncoderMode_TI12, TIM_ICPolarity_Rising, TIM_ICPolarity_Rising);

/* TIM4 counter enable */
TIM_Cmd(TIM4, ENABLE); 
```

可悲的是，当我转动编码器时，TIM4->CNT 计数器不会移动。我与 TIM8 完美配合。这是工作 TIM8 和不工作 TIM4 的完整代码： [https ://gist.github.com/nraynaud/5082298](https://gist.github.com/nraynaud/5082298)

手动移动编码器后，我通过在 gdb 中打印 rT2() 进行检查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T22:48:21.850

我使用 STM32F407 从 3 个光学编码器读取编码器计数。我使用的是 ChibiOS RTOS，因此计时器结构与 ST 外设库计时器结构略有不同，但信息基本相同。以下是我如何配置实际定时器的寄存器：

```
stm32_tim_t * encoderTimers[3] = {STM32_TIM8, STM32_TIM3, STM32_TIM4};
for (auto timer : encoderTimers) {
  timer->SMCR = 3;          // Encoder mode 3
  timer->CCER = 0;          // rising edge polarity
  timer->ARR = 0xFFFF;      // count from 0-ARR or ARR-0
  timer->CCMR1 = 0xC1C1;    // f_DTS/16, N=8, IC1->TI1, IC2->TI2
  timer->CNT = 0;           // Initialize counter
  timer->EGR = 1;           // Generate an update event
  timer->CR1 = 1;           // Enable the counter
} 
```

此外，确保启用 RCC 的 APB1 或 APB2 寄存器中的定时器外设。就像是：

```
RCC->APB1ENR |= ((1 <<  2)  // TIM4  --  Front wheel angle measurement
             |   (1 <<  1));// TIM3  --  Steer angle measurement 
```

最后，您需要确保正确配置 GPIO 设置。这意味着将 GPIO 配置为备用功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T20:01:54.200

除非您使用外部电阻器或为编码器供电，否则您可能需要使用上拉电阻作为输入。我通常将编码器接地并使用内部上拉来设置空闲状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-18T13:43:31.100

带标准驱动器的编码器

```
#include "mbed.h"
#include "stm32f4xx.h"
#include "stm32f4xx_hal_tim_ex.h"

TIM_HandleTypeDef timer;
TIM_Encoder_InitTypeDef encoder;

//direction to PA_9 -- step pulse to PA_8

int main(){
     GPIO_InitTypeDef GPIO_InitStruct;
        __TIM1_CLK_ENABLE();
        __GPIOA_CLK_ENABLE();
        GPIO_InitStruct.Pin = GPIO_PIN_8 | GPIO_PIN_9;
        GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
        GPIO_InitStruct.Pull = GPIO_PULLDOWN;
        GPIO_InitStruct.Speed = GPIO_SPEED_HIGH;
        GPIO_InitStruct.Alternate = GPIO_AF1_TIM1;
        HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

    timer.Instance = TIM1;
    timer.Init.Period = 0xffff;
    timer.Init.Prescaler = 0;
    timer.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
    timer.Init.CounterMode = TIM_COUNTERMODE_UP;

    encoder.EncoderMode = TIM_ENCODERMODE_TI12; 
    encoder.IC1Filter = 0x0f;
    encoder.IC1Polarity = TIM_INPUTCHANNELPOLARITY_RISING; 
    encoder.IC1Prescaler = TIM_ICPSC_DIV4;
    encoder.IC1Selection = TIM_ICSELECTION_DIRECTTI;

    encoder.IC2Filter = 0x0f;
    encoder.IC2Polarity = TIM_INPUTCHANNELPOLARITY_FALLING;    
    encoder.IC2Prescaler = TIM_ICPSC_DIV4;
    encoder.IC2Selection = TIM_ICSELECTION_DIRECTTI;

    HAL_TIM_Encoder_Init(&timer, &encoder);
    HAL_TIM_Encoder_Start(&timer,TIM_CHANNEL_1);   

    TIM1->EGR = 1;           // Generate an update event
    TIM1->CR1 = 1;           // Enable the counter

 while (1) {
        int16_t count1; 
        count1=TIM1->CNT; 

        printf("%d\r\n", count1);
        wait(1.0);

 };
} 
```

# javascript - Javascript的随机边距方向

> ID：15203071
> 
> 赞同：1
> 
> 时间：2013-03-04T13:49:22.377
> 
> 标签：javascript, random, jquery-animate

我想使用 JS 随机生成一个边距方向，但没有任何效果。怎么了？

这是我的代码

```
$('.portfolio-img').hover(function(event){
    var str = '';
    var myPos = ['marginLeft', 'marginTop', 'marginBottom', 'marginRight'];
    var thisRand = Math.floor(Math.random() * myPos.length);
    var str = String(myPos[thisRand]);

    $(this).find('img').animate({
        str: '-60px',
    }, 300);
}, function(){
    $(this).find('img').animate({
        str: '0px',
    }, 300);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T13:50:57.767

Change

```
$(this).find('img').animate({
    str: '-60px',
}, 300); 
```

to

```
var o = {};
o[str] = '-60px';
$(this).find('img').animate(o, 300); 
```

As an aside, you can also replace

```
var str = String(myPos[thisRand]); 
```

with

```
var str = myPos[thisRand]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T13:51:08.920

Try this.

```
 var animOption = {};
   animOption[str] = '-60px';

   $(this).find('img').animate(animOptions, 300); 
```

You will have to cache `str` in `.data` and retrieve that in 2nd callback.

# css - iPad背景图像调整大小

> ID：15203072
> 
> 赞同：0
> 
> 时间：2013-03-04T13:49:23.307
> 
> 标签：css, ipad

我有一个相当大的图像，当我在 iPad 上查看它时，它的缩放比例非常小，我做了一些研究，发现我需要添加我已经完成的背景尺寸，但图像看起来很模糊，不如我很喜欢。我尝试将图像拆分，但它不起作用，因为我的图像是一堆人的照片，而且我已经设置了背景位置。无论如何我可以使图像看起来比它更清晰吗？提前致谢。

图像为 11025 像素 x 348 像素。

```
.box .image {
    background:url('../images/images.jpg') 0 0 no-repeat;
    background-size:11025px 348px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:00:39.453

你的问题就在那里：[iOS资源限制](http://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/CreatingContentforSafarioniPhone/CreatingContentforSafarioniPhone.html#//apple_ref/doc/uid/TP40006482-SW15)

取自指南：

> 由于 iOS 上的可用内存，它可以处理的资源数量存在限制：
> 
> *   对于 RAM 小于 256 MB 的设备，解码的 GIF、PNG 和 TIFF 图像的最大大小为 3 兆像素，对于 RAM 大于或等于 256 MB 的设备，最大大小为 5 兆像素。也就是说，对于 RAM 小于 256 MB 的设备，请确保 width * height ≤ 3 * 1024 * 1024。请注意，解码后的大小远大于图像的编码大小。
> *   JPEG 的最大解码图像大小为 32 兆像素，使用二次采样。由于二次采样，JPEG 图像最高可达 32 兆像素，这允许 JPEG 图像解码为像素数十六分之一的大小。对大于 2 兆像素的 JPEG 图像进行二次采样，即解码为缩小的尺寸。JPEG 二次采样允许用户查看来自最新数码相机的图像。

当系统将您的图像缩放回 5512 x 174 像素时，背景大小对您没有多大帮助。

# c#-4.0 - mvc4 使用另一个表中的数据插入到表中

> ID：15203079
> 
> 赞同：0
> 
> 时间：2013-03-04T13:49:41.230
> 
> 标签：c#-4.0, razor, asp.net-mvc-4

这是我的模型：

```
 public class Categories
            {
                [Key]
                public int Id { get; set; }
                public string  Name { get; set; }
                public UserProfile User { get; set; }
            }

        public class Profits
            {
                [Key]
                public int Id { get; set; }
                public double Value { get; set; }
                public string Description{ get; set; }
                public DateTime DateInput { get; set; }
                public UserProfile User { get; set; } // Foreign to User
                public Categories CategoryName { get; set; } // Foreign  to Categories
            } 
```

现在我想在我的视图中执行类似“插入利润（“列名”）值（“从文本框获取”和下拉列表中的类别以及类别表中的数据）“

我的逻辑是每个利润都有一个类别（薪水，大奖等），每个类别可能有不止一个利润。我应该知道什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T15:33:49.630

如果您在一个类别中有多个利润，则应使用类别中的一个集合，其中包含来自利润的 id。因此，您可以更快地访问数据，而无需进行太多处理。

# php - 在 MySQL 中使用唯一引用作为主键

> ID：15203088
> 
> 赞同：0
> 
> 时间：2013-03-04T13:50:05.993
> 
> 标签：php, mysql, primary-key, primary-key-design

我有一个普遍的问题。

我非常喜欢生成这样的页面的 URL：

www.example.com/order/1e4fk678

其中 1e4fk678 是发布到生成输出的 php 文件的变量。

我的问题是：创建数据库表的最佳方法是什么。具有主键自动认证的 ID 只会生成像 1、2、3、...这样的 ID。

那么使用唯一 id 并导致快速数据库跟踪/跟踪的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:15:41.393

您的 DBMS 已经生成了唯一的 (auto_increment) 标识符。您在问题中没有说的是您是否希望 URL 中显示的值是不可预测的。

如果没有，那么您可以简单地对生成的 id 进行基本转换。

如果您需要该值是不可预测的，则将其作为字符串填充（大多数加密算法将自动执行此操作，直到块大小的倍数）并使用可逆加密对自动增量整数进行编码 - 并添加一些验证检测蛮力攻击。该方法不必是可逆的，但大多数使加密不可逆的方法（生成散列，使用数据作为加密密钥，使用随机加密密钥）会引入冲突风险，要求加密数据是更大。

如果引用是远程提供的，那么只需在数据上添加唯一索引即可。但是您仍然需要考虑如何处理碰撞。

使用随机值对低数据量有一些好处 - 您可以在生成时检测到冲突 - 但验证生成的值不冲突的成本以至少 O(logN) 的速率增加（对于索引字段） .

**更新**

> 所以使用 [a varchar 而不是 integer] 作为主键不会减慢我的数据库到中世纪？

不——这是你最不担心的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:06:45.750

您实际上可以在 mysql 中使用带有`unique`约束的 String 列 - 甚至可以作为主键列。说啊：

```
`id` varchar(..) PRIMARY KEY 
```

在您的表定义中。

看看这个问题，它处理字符串作为主键及其性能问题：[MySQL - using String as Primary Key](https://stackoverflow.com/questions/3455297/mysql-using-string-as-primary-key)

# php - php 致命错误未捕获的 OAuthException：通过 flash 从 facebook 应用程序访问 php 页面时

> ID：15203101
> 
> 赞同：-2
> 
> 时间：2013-03-04T13:51:07.023
> 
> 标签：php, facebook, flash

我正在尝试通过 Flash 从 facebook 应用程序更新游戏分数。

```
function postdatas(){ 

var postpath="post.php";       
var my_vars:URLVariables = new URLVariables();
my_vars.times = encrypt(game.stopwatch.minText.text+"."+game.stopwatch.secText.text, "PheNi3$@$%!");

var my_url:URLRequest = new URLRequest(postpath);
my_url.method = URLRequestMethod.POST;
my_url.data = my_vars;

var my_loader:URLLoader = new URLLoader();
my_loader.dataFormat = URLLoaderDataFormat.VARIABLES;
my_loader.load(my_url);
}

postdatas(); 
```

在 Post.php 中

我正在获取 facebook 用户信息以更新他墙上的消息并更新数据库中的分数

```
$fbme  =   $facebook->api('/me'); 
```

但我收到“PHP 致命错误：未捕获的 OAuthException：必须使用活动访问令牌来查询有关当前用户的信息”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T14:09:00.377

终于想通了，需要把signedrequest传给post.php

# ckeditor - CKEditor 4 Toolbar Dropdown in IE7

> ID：15203104
> 
> 赞同：1
> 
> 时间：2013-03-04T13:51:11.223
> 
> 标签：ckeditor, wysiwyg, fckeditor, internet-explorer-7

I am using ckeditor 4 for my project. The dropdown list in ckedior toolbar is not opening in IE7 where as it is opening fine in Chrome and Firefox. Any idea why?

Internet Explorer 7 ![Internet Explorer](../Images/64f11830bdd5ad27a89cf9379baa4187.png)

Chrome ![Chrome](../Images/aaa34bc9095c449ec2ee2576e5c1d9a1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:04:13.860

我在将 IE9 降级为模拟 IE7 时遇到了类似的问题。然后我没有得到上下文菜单。

通过将文档模式强制为至少 IE8，它按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T12:10:22.280

我使用的 CKEditor 的实际版本是 4.0.1.1。我恢复到 CKEditor 4.0，它也可以在 IE7 中运行。版本 4.0.1.1 似乎有一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-30T10:09:40.147

我在 Symfony2 项目中遇到了同样的问题。

奇怪的是，我注意到下拉菜单在 Symfony2 开发环境中工作，并发现它们在启用 Sf2 调试栏时工作。

然后我在 chrome 中进行了一些检查，发现 CKEditor 下拉元素位于 iframe 中，该 iframe 作为正文中的最后一个元素添加。

然后我尝试添加一个空的 div 标签作为正文中的最后一个元素（以前最后一个元素是一个脚本标签），这解决了问题。

因此，添加一个普通的空 div 标签作为正文的最后一个元素，下拉菜单都可以。

# wxpython - wxpython：使用 textcontrol.GetValue() 时如何从字符串中删除空字节

> ID：15203106
> 
> 赞同：1
> 
> 时间：2013-03-04T13:51:17.270
> 
> 标签：wxpython

目标：使用两个文本控件框，一个作为输入，一个作为输出但是在这个过程中有一个额外的步骤，这可能会失败，因为 textcontrol.GetValue() 另外返回空字节

所以说我有

```
self.tc1 = wx.TextCtrl(panel)

self.tc2 = wx.TextCtrl(panel) 
```

我去做

```
cmd = self.tc1.GetValue() 
```

如何排除字符串 cmd 的最后一个字符（或任何空字节）

输出：

TypeError: execv() 参数 1 必须是没有 NULL 字节的编码字符串，而不是 str

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:25:27.387

才想通，

我不得不把它改成

```
cmd = self.tc1.GetValue().encode('ascii') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:26:17.777

您只需使用[`str.strip`](http://docs.python.org/2/library/stdtypes.html#str.strip).

```
>>> foo = "bar\n"
>>> foo
'bar\n'
>>> foo.strip()
'bar' 
```

请注意，这也会删除任何前导和尾随空格。

# android - ActionBar 中的可扩展自定义视图

> ID：15203108
> 
> 赞同：0
> 
> 时间：2013-03-04T13:51:23.653
> 
> 标签：android, android-actionbar

我需要在我的应用程序中编写媒体播放器。根据计划设计，它需要在操作栏中显示媒体控制器。此外，这些控件之一应该打开具有当前曲目详细信息和可滚动播放列表的完整版播放器。扩展版本应如下所示：

[http://petromi.com/get/5ea6d49e3e.png](http://petromi.com/get/5ea6d49e3e.png)

我试图用标准的 ActionBar 来实现这一点，但似乎自定义视图的高度不能超过 ActionBar 的高度。我对吗？

是否可以通过 ActionBar 或通过 ABS 以其他方式完成？或者我应该实现我自己的观点？你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:07:24.490

您可以[`ListPopupWindow`](http://developer.android.com/reference/android/widget/ListPopupWindow.html)在单击列表图标时显示。使用该图标作为锚点以将弹出窗口放置为下拉菜单。

显示后，您可以获取`ListView`from`getListView()`并调用`addHeaderView ()`它以在列表顶部添加一个固定的 View。

`ListView`可以滚动并且可以有任意数量的条目。这将消除拖动扩展它的需要。

# jquery-mobile - 无法在 JQuery Mobile 中禁用固定标题的点击切换

> ID：15203109
> 
> 赞同：2
> 
> 时间：2013-03-04T13:51:26.507
> 
> 标签：jquery-mobile

我正在使用 JQuery Mobile（版本 1.3.0）开发一个网络应用程序。它使用固定的标题，但当用户点击表单内容时，我无法禁用“点击切换”行为。

我尝试使用属性“data-tap-toggle=false”，但它不起作用。当用户点击表单时，标题继续隐藏，再次点击时显示。

提前致谢！

```
<div data-role="page" class="Page" id="parameter_page">
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
        <div class="headerContainer" >
            <a href="index.html"      data-role="button" class="ui-btn-left"  data-inline="true" data-direction="reverse" data-icon="back"  >Voltar</a>
            <a href="instrucoes.html" data-role="button" class="ui-btn-right" data-inline="true" >Instruções</a>
        </div>
    </div>
    ...
    ...
    ...
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:13:39.207

首先，为了使用你`data-tap-toggle`必须添加*Header*`data-fullscreen="true"`和*Footer*。现在不需要了，因为您可以动态控制它们。`data-position="fixed"`**`data-tap-toggle`**

 **然后以这种方式控制它们。

```
$("[data-role=header],[data-role=footer]").fixedtoolbar({ tapToggle: true });

$("[data-role=header],[data-role=footer]").fixedtoolbar({ fullscreen: true }); 
```

在点击或单击时，两者都会出现然后消失。

[在这里](http://jsfiddle.net/Pf4ca/)测试一下。

我希望我有所帮助。**

# c - 制作一个 C 程序来编译另一个

> ID：15203111
> 
> 赞同：1
> 
> 时间：2013-03-04T13:51:29.983
> 
> 标签：c, unix, ubuntu

我正在寻找一个旨在编译另一个程序的程序。目的是使用 exec 运行 gcc。我必须使用 execve 而我拥有的是：

```
#include <unistd.h>
#include <sys/types.h>

int main(int argc, char* argv[], char* envp[])
{
  argv[0] = "gcc";
  execve("/usr/bin/gcc" , argv, envp);
  return 0;
} 
```

通过做

```
gcc -Wall p3p4.c -o run 
```

它编译没有问题，但是在做的时候

```
./run p3p1.c 
```

要尝试编译另一个，会发生这种情况：

```
run: error trying to exec 'cc1': execvp: No such file or directory 
```

编辑：

按照建议，添加行时：

```
argv[0] = "gcc"; 
```

该程序设法工作。谢谢你的反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T13:56:52.490

Try setting `argv[0]` like a well-behaved program:

```
argv[0] = "gcc";
execve("/usr/bin/gcc" , argv, envp); 
```

> run: error trying to exec 'cc1':

This is apparently what gcc tries to run when it finds something unexpected in `argv[0]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:24:41.003

`excve`告诉你他没有找到`gcc`。尝试

```
execvpe ("gcc", argv, envp); 
```

请注意，这里`envp`是无用的（而不是 POSIX）；您可以安全地删除`envp`并`main()`调用

```
execvp ("gcc", argv); 
```

# knockout.js - 静态集线器方法不向客户端发送数据

> ID：15203112
> 
> 赞同：1
> 
> 时间：2013-03-04T13:51:41.093
> 
> 标签：knockout.js, signalr, signalr-hub

我刚刚开始使用 SignalR，所以我很可能在做一些愚蠢的事情。

我有一个外部任务完成工作，每次完成一个周期时，它都会调用一个静态集线器方法，该方法将一些更新的结果发送到网站。正如您在下面看到的，我正在向静态方法发送更新的统计数据行，并且只是尝试将该行写入控制台以进行测试。

服务器端代码如下所示：

```
public static void UpdateStats(Stats stats)
{
    var context = GlobalHost.ConnectionManager.GetHubContext<StatsHub>();
    context.Clients.All.updateStats(stats);
} 
```

客户端代码如下所示：

```
statsHub.client.updateStats = function (stats) {
    console.log(stats);
} 
```

我正在使用 SignalR 进行初始页面加载，效果很好。

```
$.connection.hub.start(function () {
   statsHub.server.getAll();
}); 
```

准备好的文档如下所示：

```
$.connection.hub.logging = true;
var statsHub = $.connection.statsHub;

var viewModel = new ScraperViewModel(statsHub);

statsHub.client.updateStats = function (stats) {
    viewModel.UpdateStats(stats);
};

ko.applyBindings(viewModel);
$.connection.hub.start(function () {
    statsHub.server.getAll();
}); 
```

**更新**

只是为了确认 - 我正在使用 SignalR - 1.01（我已经尝试过 1.0.0）。我已经注释掉了 Knockout 代码，所以它只是 SignalR。在 IE 和 Chrome 上都试过了。并且在日志记录开启时，日志控制台日志中没有任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T15:59:43.950

最后，我重新设计了后端任务以连接到集线器代理并通过调用方法更新统计信息。

问题可能是我从外部 dll 调用静态集线器方法？

# scala - 创建一个 Akka fat Jar

> ID：15203113
> 
> 赞同：6
> 
> 时间：2013-03-04T13:51:41.473
> 
> 标签：scala, sbt, akka, nutch, sbt-assembly

我需要创建一个使用 Akka 与一些外部应用程序通信的 Nutch 插件。为了做到这一点，我需要将插件打包为一个胖 Jar - 我使用的是[sbt-assembly](https://github.com/sbt/sbt-assembly/)版本 0.8.3。

当我尝试运行插件时，出现异常

```
com.typesafe.config.ConfigException$Missing: No configuration setting found for key 'akka' 
```

好像阿卡找不到一样`reference.conf`。这很奇怪，因为`sbt-assembly` [应该能够](http://letitcrash.com/post/21706121997/follow-up-sbt-assembly-now-likes-reference-conf)正确打包该文件，实际上我可以在创建的 jar 中看到它的内容。

我的`build.sbt`样子是这样的：

```
import AssemblyKeys._

name := "my-project"

version := "0.1-SNAPSHOT"

scalaVersion := "2.10.0"

resolvers ++= Seq(
  "Central Repo" at "http://repo1.maven.org/maven2",
  "Typesafe Repository" at "http://repo.typesafe.com/typesafe/releases/",
  "Akka io" at "http://akka.io/repository"
)

libraryDependencies ++= Seq(
  ...,
  "com.typesafe.akka" %% "akka-actor" % "2.1.1",
  "com.typesafe.akka" %% "akka-remote" % "2.1.1"
)

seq(assemblySettings: _*)

mergeStrategy in assembly <<= (mergeStrategy in assembly) { (old) =>
  {
    case "plugin.xml" =>
      MergeStrategy.first
    case x if x startsWith "org/apache/jasper" =>
      MergeStrategy.last
    case x if x startsWith "javax/xml" =>
      MergeStrategy.last
    case x if x startsWith "javax/servlet" =>
      MergeStrategy.last
    case x if x startsWith "org/apache/commons" =>
      MergeStrategy.last
    case x if x startsWith "org/apache/xmlcommons" =>
      MergeStrategy.last
    case x if x startsWith "org/xml/sax" =>
      MergeStrategy.last
    case x if x startsWith "org/w3c/dom" =>
      MergeStrategy.last
    case x => old(x)
  }
} 
```

需要最后几行来解决 nutch 和 hadoop 之间的一些冲突。

> 打包 Akka 应用程序的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-12T02:00:36.590

截至 2013 年 11 月， [sbt-assembly](https://github.com/sbt/sbt-assembly)的最新版本是 sbt 0.13 的[0.10.1](http://notes.implicit.ly/post/65751699253/sbt-assembly-0-10-1)。使用它，我能够使用默认的合并策略使用最新的稳定 Akka 2.2.3 创建一个胖 jar。

## 文件

项目/build.properties：

```
sbt.version=0.13.0 
```

项目/组装.sbt：

```
addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.10.1") 
```

组装.sbt：

```
import AssemblyKeys._

assemblySettings 
```

构建.sbt：

```
name := "sbt-assembly-akka-sample"

version := "0.1.0-SNAPSHOT"

scalaVersion := "2.10.3"

libraryDependencies ++= Seq(
  "com.typesafe.akka" %% "akka-actor" % "2.2.3",
  "com.typesafe.akka" %% "akka-remote" % "2.2.3"
) 
```

src/main/scala/actor.scala：

```
package hello

import akka.actor.{Actor, Props}
import akka.event.Logging

class MyActor extends Actor {
  val log = Logging(context.system, this)
  def receive = {
    case "test" ⇒ log.info("received test")
    case _      ⇒ log.info("received unknown message")
  }
} 
```

src/main/scala/app.scala：

```
package hello

object Main extends App {
  import akka.actor.{ActorSystem, Props}
  val system = ActorSystem("mySystem")
  val myActor = system.actorOf(Props[MyActor], "myactor")
  myActor ! "test"
} 
```

## 输出

这是我通过运行得到的`assembly`：

```
> assembly
[info] Updating {file:/xxx/sbt-assembly-01/}sbt-assembly-01...
[info] Resolving org.fusesource.jansi#jansi;1.4 ...
[info] Done updating.
[info] Compiling 2 Scala sources to /xxx/sbt-assembly-01/target/scala-2.10/classes...
[info] Including: uncommons-maths-1.2.2a.jar
[info] Including: protobuf-java-2.4.1.jar
[info] Including: config-1.0.2.jar
[info] Including: netty-3.6.6.Final.jar
[info] Including: akka-remote_2.10-2.2.3.jar
[info] Including: akka-actor_2.10-2.2.3.jar
[info] Passed: Total 0, Failed 0, Errors 0, Passed 0
[info] No tests to run for test:test
[info] Including: scala-library-2.10.3.jar
[info] Checking every *.class/*.jar file's SHA-1.
[info] Merging files...
[warn] Merging 'META-INF/NOTICE.txt' with strategy 'rename'
[warn] Merging 'META-INF/license' with strategy 'rename'
[warn] Merging 'META-INF/LICENSE.txt' with strategy 'rename'
[warn] Merging 'META-INF/MANIFEST.MF' with strategy 'discard'
[warn] Merging 'reference.conf' with strategy 'concat'
[warn] Strategy 'concat' was applied to a file
[warn] Strategy 'discard' was applied to a file
[warn] Strategy 'rename' was applied to 3 files
[info] SHA-1: 1e9dcebeddc8e2a7d41a0c55a663f9ca0000000
[info] Packaging /xxx/sbt-assembly-01/target/scala-2.10/sbt-assembly-akka-sample-assembly-0.1.0-SNAPSHOT.jar ...
[info] Done packaging.
[success] Total time: 13 s, completed Nov 11, 2013 8:57:18 PM 
```

下面是运行 jar 的样子：

```
$ java -jar target/scala-2.10/sbt-assembly-akka-sample-assembly-0.1.0-SNAPSHOT.jar
[INFO] [11/11/2013 20:59:48.265] [mySystem-akka.actor.default-dispatcher-2] [akka://mySystem/user/myactor] received test 
```

# iphone - 任何带有路由的离线 OpenStreetMaps 解决方案？

> ID：15203117
> 
> 赞同：2
> 
> 时间：2013-03-04T13:52:01.233
> 
> 标签：iphone, objective-c, routing, openstreetmap

目前，我们正在尝试开发具有离线地图和路线（导航）的应用程序。OpenStreetMaps 看起来很有前途（至少作为离线地图），但是我找不到任何相关的路由 API 或 SDK。我知道，OpenStreetMaps 可以用作平铺图像或矢量数据。但是这个矢量数据可以用于路线计算吗？是否已经开发了具有最短和最快路线计算的SDK？恕我直言，从原始数据计算路线可能是非常耗时的任务，可能被视为单独的项目。

我也开始寻找替代品并找到了[Google 原生 iOS 地图应用程序](http://googlegeodevelopers.blogspot.com/2012/12/a-new-way-to-add-google-maps-to-your.html)，但是，仍在搜索是否有离线地图和路线支持。对此的任何想法和经验将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T06:53:42.813

[OSRM](http://en.wikipedia.org/wiki/OSRM)是一个设计用于 OpenStreetMap 数据的路由引擎。它似乎旨在作为一种 Web 服务，但它是开源的 (AGPL) 和 C++，我认为这意味着您可以将其代码用于设备上的路由。

# r - 试图在ggplot的直方图上应用颜色渐变

> ID：15203124
> 
> 赞同：7
> 
> 时间：2013-03-04T13:52:09.000
> 
> 标签：r, colors, gradient, ggplot2

我在 ggplot 中纠结于颜色。我正在尝试根据下面的排名列应用颜色渐变。我很确定这是颜色和填充或离散和连续变量之间的差异。我想要如下“c”和“d”中的刻度所示的颜色，但我最接近的尝试是“e”和“f”，其中的点是彩色的，但不是由渐变着色的。我更喜欢的渐变适用于等级为 1:100 的值，所有其他值的点为黑色。

任何帮助将不胜感激。

```
library(reshape2)
library(ggplot2)

co2 <- read.table(
  header=TRUE, text='
rank tons
1     2 1.00
2     4 1.00
3     7 0.00
4    44 0.00
5   104 0.00
6    48 0.05
7    32 0.50
8     5 0.00
9    78 1.00
10   12 0.00
11   15 0.00
12  176 1.00
13  440 0.02
14  249 0.00
15  481 0.00
16  388 0.00
17  458 0.05
18  488 0.00
19  264 0.00
20  203 0.00
            ') 
```

我试过了：

```
#does not add rank as a color
c<- ggplot(data=co2, aes(x = tons, color=rank)) 
c + geom_dotplot(stackgroups = TRUE, binwidth = .05, binpositions = "all")  +
    scale_colour_gradient(limits=c(1, 500))

#also does not add rank as color
d<- ggplot(data=co2, aes(x = tons, color=rank)) 
d + geom_dotplot(stackgroups = TRUE, binwidth = 0.05, method = "histodot")  + 
    scale_colour_gradient(limits=c(1, 100))

#create breaks for fill-- works correctly but no gradient
co2$brks<- cut(co2$rank, c(seq(0, 100, 20), max(co2$rank)))
e<- ggplot(data=co2, aes(x = tons, fill=brks)) 
e + geom_dotplot(stackgroups = TRUE, binwidth = 0.05, method = "histodot")  

#also works correctly but no gradient
f<- ggplot(data=co2, aes(x = tons, fill=brks)) + geom_histogram() 
f 
```

我已经检查了这些，但我仍然缺少一些东西：

*   [使用 ggplot 进行颜色渐变](https://stackoverflow.com/questions/11315783/color-gradients-with-ggplot)
*   [使用直方图中断在第二列上应用函数](https://stackoverflow.com/questions/11872738/use-histogram-breaks-to-apply-function-over-second-column/11876746#11876746)
*   [ggplot stat_bin2d 图中的梯度中断](https://stackoverflow.com/questions/6793881/gradient-breaks-in-a-ggplot-stat-bin2d-plot)
*   [http://docs.ggplot2.org/current/geom_dotplot.html](http://docs.ggplot2.org/current/geom_dotplot.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T15:11:00.180

这是一个有点老套的答案，但它有效：

```
##Define breaks
co2$brks<- cut(co2$rank, c(seq(0, 100, 5), max(co2$rank)))
#Create a plot object:
g = ggplot(data=co2, aes(x = tons, fill=brks)) +
   geom_dotplot(stackgroups = TRUE, binwidth = 0.05, method = "histodot") 
```

现在我们手动指定要用作调色板的颜色：

```
 g + scale_fill_manual(values=colorRampPalette(c("white", "red"))( length(co2$brks) )) 
```

![在此处输入图像描述](../Images/e8e84643473ce6d9c579c3c8ce5afae6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T17:09:49.763

我只需要添加

```
+ scale_fill_brewer(palette="RdYlBu") 
```

见下文：

```
library(reshape2)
library(ggplot2)

co2 <- read.table(
  header=TRUE, text='
rank tons
1     2 1.00
2     4 1.00
3     7 0.00
4    44 0.00
5   104 0.00
6    48 0.05
7    32 0.50
8     5 0.00
9    78 1.00
10   12 0.00
11   15 0.00
12  176 1.00
13  440 0.02
14  249 0.00
15  481 0.00
16  388 0.00
17  458 0.05
18  488 0.00
19  264 0.00
20  203 0.00
            ')                                                                                                          

#create breaks for fill--
co2$brks<- cut(co2$rank, c(seq(0, 100, 20), max(co2$rank)))
e<- ggplot(data=co2, aes(x = tons, fill=brks)) 
e + geom_dotplot(stackgroups = TRUE, binwidth = 0.05, method = "histodot")  + scale_fill_brewer(palette="RdYlBu")

#also works correctly!
ggplot(data=co2, aes(x = tons, fill=brks)) + geom_histogram() + scale_fill_brewer(palette="RdYlBu") 
```

# php - json第一个索引值在jquery中获取

> ID：15203129
> 
> 赞同：1
> 
> 时间：2013-03-04T13:52:23.657
> 
> 标签：php, javascript, jquery, json

我正在通过 Ajax 循环生成 JSON，我成功地迭代并获得了结果。我只需要 JSON 的第一个索引值，`name` 我在 jQuery 中这样做：

## PHP

```
 $jsonRows[] = array(
            "name" => $result['name'],
            "datetime" => $result['datetime'],
            "place" => $result['place'],

        );
print_r(json_encode($jsonRows)); 
```

假设值即将到来：

```
name: raj,
datetime: 2013-03-01 16:50:21,
place: India

name: jatin,
datetime: 2013-03-01 20:50:21,
place: US

name: raman,
datetime: 2013-03-03 01:50:21,
place: Japan 
```

我只需要`name: raj`，但我没有得到这个值：

## JavaScript

```
$.each(response, function(i, item) {
       alert(item(0).name);
    }); 
```

**错误：对象不是函数**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T13:54:09.437

试试这个

```
$.each(response, function(i, item) {
   alert(item.name);
}); 
```

这里的例子[小提琴](http://jsfiddle.net/bipen/L9Zfx/)

**更新**

如果您只需要第一个，则不需要循环..

```
alert(response[0].name); 
```

[更新的小提琴](http://jsfiddle.net/bipen/L9Zfx/3/)

# jquery - Ajax 调用不接受函数参数作为数据值

> ID：15203131
> 
> 赞同：1
> 
> 时间：2013-03-04T13:52:25.290
> 
> 标签：jquery

我正在尝试使用数据将存储在函数参数中的值传递给 PHP 页面，但是 Ajax 总是执行生成弹出窗口的错误部分 - 警报。

代码附在下面。有什么建议么。提前致谢

```
function clickonaccept(contentid)
{

    $.ajax
    ({
        type: 'POST',
        url: '../scripts/s_updateinvites.php',
        data: { id: contentid},
        error: function() 
        {
           alert('Error!');
        },
        success: function(data) 
        {
           alert ('updatedt!');
        }
    });
} 
```

**脚本 s_updateinvites.php 的内容**

```
<?PHP

    include_once ("s_dbconnect.php");
    $connectobject= new dbconnect();

    $con = $_POST["id"]; 

    $connectobject->query("INSERT INTO workingon (Content_ID) VALUES ('$con')");

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:56:47.723

使用此代码，如果您有任何问题，请告诉我。

```
function clickonaccept(contentid)
{
  // I hope you are getting content
$.ajax
({
    type: 'POST',
    url: 'http://localhost/YOUR_PROJECT/scripts/s_updateinvites.php',//preferable is if you already define site path. not ../ path
    data: { id: contentid},
    dataType:"json",
    success: function(data) 
    {
      if(data.message=="done")
      {
        alert("yes Cracked!!!");
      }
    }
});
//I removeed error code from your code and used datatype json
} 
```

现在我在您的代码中进行了更改。

```
include_once ("s_dbconnect.php");
$connectobject= new dbconnect();

$con = $_POST["id"]; 

$connectobject->query("INSERT INTO workingon (Content_ID) VALUES ('$con')");

$data = array("message"=>"done")
echo json_encode($data);
die; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:33:23.100

这行得通。无法弄清楚仍然有什么区别

功能检查（）{

```
var value=2;
alert(value);
$.ajax({
    type: 'POST',
    url: 's_updateinvites.php',
    data: { id: value },
    cache: false,
    error: function() 
    {
       alert('Error!');
    },
    success: function(data) 
    {
        alert ('Done!');
    }
}); 
```

}

“更新”

PHP文件是

include_once ("s_dbconnect.php"); $connectobject = 新的 dbconnect();

```
$check = $_POST["id"];
$connectobject->query("INSERT INTO test (val) VALUES ('$check')"); 
```

# xml - 将元素属性转换为子元素

> ID：15203133
> 
> 赞同：1
> 
> 时间：2013-03-04T13:52:34.903
> 
> 标签：xml, xslt

我有一些看起来像这样的 xml 片段

```
<an_element1 attribute1="some value" attribute2="other value" ... attributeN="N value">
<an_element2 attribute1="some value" attribute2="other value" ... attributeN="N value">
... 
```

我需要把它改成这样：

```
<an_element1>
<attribute1>some value</attribute1>
<atttibute2>other value</attribute2>
...
<attributeN>N value</attributeN>
</an_element1>
<an_element2>
<attribute1>some value</attribute1>
<atttibute2>other value</attribute2>
...
<attributeN>N value</attributeN>
</an_element2>
... 
```

我已经成功地尝试了在其他答案中找到的一些示例，但我想知道是否有一种通用方法可以解决这个问题，可以这样总结：

为每个名为 an_element 的元素为其每个属性创建一个子元素，每个属性都包含它们各自的值。

由于重复元素可能包含重复值（两个 an_element 项目的所有属性都具有相同的值），我想知道是否可以仅过滤唯一元素。

如果过滤器是可能的，最好在转换之前或之后应用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:04:32.747

> 为每个名为 an_element 的元素为其每个属性创建一个子元素，每个属性都包含它们各自的值。

以下样式表将所有属性转换为同名元素。从属性生成的元素将优先于从源中的子元素复制的元素。

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XST/Transform" version="1.0">
  <xsl:template match="@*">
    <xsl:element name="{name()}">
      <xsl:value-of select="."/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

如果您只想对具有特定名称的元素执行此操作，则需要更像

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XST/Transform" version="1.0">
  <xsl:template match="an_element/@*">
    <xsl:element name="{name()}">
      <xsl:value-of select="."/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

这将转换

```
<an_element foo="bar"/> 
```

进入

```
<an_element>
  <foo>bar</foo>
</an_element> 
```

但会`<another_element attr="whatever"/>`保持不变。

# mysql - 可以检查一个数字是否在 GROUP_CONCAT 中

> ID：15203134
> 
> 赞同：1
> 
> 时间：2013-03-04T13:52:36.613
> 
> 标签：mysql, group-concat

我只想获取那些有 2 行且一行有 的 id，另一行`site_id = 1`有`site_id = 2`.

我尝试加入该表两次，但查询时间过长。所以我现在要做的是连接站点 id，并将行限制为仅在此 concat 值中为 1 且在其中 28 的行。但是，我无法让它工作。这与 site_id 是一个数字和我的 concat 值（即`sites`是一个字符串）有关吗？如何确保这两个值都在我的连接字符串中？

```
SELECT *, COUNT(id) as num_ids
FROM (
    SELECT id, CONVERT(GROUP_CONCAT(`site_id`) USING utf8) as `sites`, MAX(`Date_Added`) as `date_added_lb`
    FROM `product_location` pl
    WHERE `site_id` =1 OR `site_id` = 28
    GROUP BY id
) as t
WHERE t.`date_added_lb` >="2013-02-27"
AND 1 IN(`sites`)
AND 28 IN(`sites`)
AND num_ids=2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T13:56:03.097

通过在 when子句已经过滤到的`HAVING`子句中进行测试，您可以在没有子查询的情况下对其进行验证。`COUNT(DISTINCT site_id) = 2``WHERE``site_id IN (1,28)`

```
SELECT
  id
FROM  production_location
WHERE 
  date_added_lb >= '2013-02-27'
  /* Filters for only site_id 1, 28 */
  AND site_id IN (1, 28)
GROUP BY id
/* And verifies that the group has exactly 2 different results (one of each 1, 28) */
HAVING COUNT(DISTINCT site_id) = 2 
```

更新：

要验证只有`site_id = 28`has `date_added_bl >= '2013-02-27'`，您需要一个更智能的子查询：

```
WHERE
  site_id = 1
  OR (site_id = 28 AND date_added_lb >= '2013-02-27') 
```

没有其他东西需要改变。

如果性能似乎无法满足您的需要，请验证是否有一个索引 on`site_id`和一个 on `id`。如果可能，它可能会受益于`(id, site_id)`.

# java - 特殊字符（注册商标、TM- 商标、笑脸等）无法在 UI 上正确显示

> ID：15203140
> 
> 赞同：1
> 
> 时间：2013-03-04T13:52:46.863
> 
> 标签：java, javascript, json, jsp-tags

我正在开发一个网页（.jsp），我在其中以 JSON 对象的形式获取数据，然后对其进行解析，以便在显示不正确的 UI 上显示它。例如，黑莓等。我已经写了所有JAVA代码中的业务逻辑。当我检查了 JAVA 中的响应时，它是正确的。

为了解决这个问题，我提出了一种解决方法，将特定字符更改为它们的 HTML 形式（例如，对于注册商标，我用 HTMLcode 替换它并且它有效。但是，由于数据很长，我不认为这是一个很好的做法。

我检查了一些答案，在那里我发现了编码问题。但是，当我检查 HTML 文件时，它已经在那里了

```
<meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
```

任何人都可以提供帮助。

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T13:55:10.347

构建 JSON 字符串时，其中的所有字符串都必须以 UTF-8 编码。这是 JSON 的*要求*。您似乎没有这样做，因此 JSON 的接收端无法读取该字符（因为 128-255 范围内的字符无效，除非编码正确）

检查写入 JSON 的编码以解决此问题。

# asp.net-mvc - signalR 跟踪连接的用户

> ID：15203141
> 
> 赞同：5
> 
> 时间：2013-03-04T13:52:50.867
> 
> 标签：asp.net-mvc, signalr, signalr-hub

我需要检查特定用户是否仍处于连接状态。

我有以下跟踪用户的 HashSet：

```
public static class UserHandler
{
    public static HashSet<string> ConnectedIds = new HashSet<string>();
} 
```

所以断开连接：

```
 public override Task OnDisconnected()
    {
        UserHandler.ConnectedIds.Remove(this.Context.ConnectionId);
        if (UserHandler.ConnectedIds.Count == 0)
        {
               // STOP TASK -> SET CANCELLATION
        }
        return base.OnDisconnected();
    } 
```

和连接：

```
 public override Task OnConnected()
    {
        Logger.Log.file.Info("[TaskActionStatus HUB => OnConnected] Start");

        UserHandler.ConnectedIds.Add(this.Context.ConnectionId);

        // start task only if at least one listener
        if (UserHandler.ConnectedIds.Count < 2)
        {
            // START A TASK -> (WHILE LOOP THAT GETS DATA FROM DB EVERY 2 SEC)
        }

        return base.OnConnected();
    } 
```

现在，当用户简单地关闭他/她的浏览器窗口时，问题就出现了。我无法知道他/她是否断开了连接。

所以基于[这里](https://stackoverflow.com/questions/9654588/signalr-for-tracking-online-users-and-chat)的一些问题，我会打电话给每个客户并得到回复。我不知道该怎么做。

我想我会有这个：

```
public static void CheckConnectedUsers()
{
    var context = GlobalHost.ConnectionManager.GetHubContext<TaskActionStatus>();
    foreach (var connection in UserHandler.ConnectedIds)
    {
        context.Clients.Client(connection).verifyConnected("online?");
    }
} 
```

但是我如何从客户那里得到回复？

编辑：执行的步骤：

我需要连接的用户的确切数量，因为如果至少有一个用户连接，我需要开始一项任务。我想确保所有连接的用户< 2（启动任务）只运行 1 个任务。假设这样的情况：2 个用户查看使用 signalR 的页面。HashSet 现在包含 2 个 ID，并且正在运行一个任务。一个人关闭他/她的浏览器，几秒钟后，另一个人刷新他/她的浏览器。现在，第一个（关闭他/她的浏览器的那个没有执行 OnDisconnected 方法，所以 HashSet 仍然有他/她的 ConnectionId，而“刷新”的那个确实执行了 OnDisonnected 然后 OnConnected 将他的 connectionId 添加到 HashSet。所以在 HashSet 中只有 1 个 ConnectionId 并开始一项任务，HashSet 包含 2 个（旧的不再连接和刚刚刷新他/她的浏览器的那个），

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T16:02:59.457

使用 SignalR 1.0，`OnDisconnected`应始终触发，即使用户关闭其窗口（如果服务器重新启动则例外）。

`OnDisconnected`可能不会立即触发，因为如果客户端没有“中止”连接，则认为它“不干净”，因为客户端可能会尝试重新连接（如果重新连接，根据 SignalR 的语义，您还没有断开连接）。

默认情况下，服务器调用`OnDisconnected`“不干净”断开连接大约需要 30 秒。这可以通过重新配置`GlobalHost.Configuration.DisconnectTimeout`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T21:11:17.783

我刚刚遇到了同样的情况。onDisconnect 并不总是被触发。我的解决方案是偶尔轮询用户以查看他们是否仍处于连接状态。

```
Public Sub checkconnections()
    For Each s In users
        Clients.User(s).areYouThere()
    Next
    users = New List(Of String)
    System.Threading.Thread.Sleep(5000)
    checkconnections()
End Sub
Public Sub imHere()
    Dim id = GetClientId()
    If Not users.Contains(id) Then
        users.Add(id)
    End If
    Clients.All.sendCount(count)
End Sub 
```

因此，集线器每 5 秒向用户列表中的所有客户端发送一次，然后清除列表。

如果客户端收到“areYouThere”消息，它会回复“imHere”，然后将其添加到列表中。

希望这可以帮助。

# php - 返回包含 PHP 代码的 HTML 元素名称的函数

> ID：15203147
> 
> 赞同：0
> 
> 时间：2013-03-04T13:53:01.653
> 
> 标签：php, html, forms

我在 PHP 页面上有一个 HTML5 表单。一些表单元素包含用于诸如使用选项填充下拉菜单之类的 PHP 代码。每个菜单中都有不同的选项，但它们都由相同的 PHP 代码（称为 query.php）填充。

我想将 HTML 元素的名称传递给 query.php 以确定要执行的查询。query.php 的编码一般为：

```
<?php
$connection = pg_connect(...);
$query = "SELECT name FROM table ORDER BY name ASC;";
$results = pg_query($connection, $query);
$rows = pg_num_rows($results);

for ($i=0; $i < $rows; $i++) {
    ?>
    <option><?php echo pg_fetch_result($results, $i, 0); ?></option>
    <?php
}
?> 
```

我希望 'table'`$query`成为来自 HTML 的变量。这是 HTML 的示例行：

```
<p>Select a City: <select name="city"><?php include("query.php"); ?></select> 
```

我一直在尝试使用 HTTP GET 方法将 'query.php' 替换为`query.php?table=$this.name`. 我知道我应该能够`$_GET['table']`在 query.php 中使用并获取传递的值，但我不知道获取 HTML 元素名称的函数。什么函数在 HTML 标记中使用时会返回 HTML 元素的名称？例如，如果我`query.php?table=$this.name`在上面的 HTML 中使用，`$_GET['table']`在 query.php 中应该返回“city”。只有 $this.name 不是正确的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:00:22.787

我建议创建一个函数来执行此操作：

```
<?php include("query.php"); ?>

<p>Select a City: <select name="city"><?php echo queryFunction("city"); ?></select></p> 
```

在 query.php 中：

```
<?php
function queryFunction($table) {
    $connection = pg_connect(...);
    $query = "SELECT name FROM $table ORDER BY name ASC;";
    $results = pg_query($connection, $query);
    $rows = pg_num_rows($results);
    $string = "";    

    for ($i=0; $i < $rows; $i++) {
        $string = $string . "<option>" . pg_fetch_result($results, $i, 0) . "</option>";
    }

    return $string;
}
?> 
```

我很确定除非您自己提供，否则无法获取选择框的名称。如果这是在 JavaScript 中完成的，那将是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T13:59:04.717

通常的做法是：

在 query.php 中：

```
<?php
function generateTags() // you can put arguments here
{ 
    $connection = pg_connect(...);
    $query = "SELECT name FROM table ORDER BY name ASC;";
    $results = pg_query($connection, $query);
    $rows = pg_num_rows($results);

    for ($i=0; $i < $rows; $i++) {
            echo "<option>".pg_fetch_result($results, $i, 0)."</option>";
        }
}
?> 
```

然后在 php html 中：

```
<?php include("query.php"); ?><!-- do this just once at the beginning -->

<p>Select a City: <select name="city"><?php generateTags(/* here could be your arguments */); ?></select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:02:50.817

您无法在 PHP 中访问 html-tags，您必须在调用`query.php`. 有关如何使用该文件中的代码的更好解决方案，请查看其他答案。

（顺便说一句。`$this`ist 仅用于处理对象，访问对象属性的语法将`$this->name`在 PHP 中，不是`$this.name`，但由于这里没有对象，因此完全无关；）

# mysql - 如何从mysql中的表中获取具有最小值的行

> ID：15203149
> 
> 赞同：-1
> 
> 时间：2013-03-04T13:53:06.440
> 
> 标签：mysql, sql, group-by

我编写了一个包含几个连接的 mysql 查询，结果如下。

```
id | title | type   |    rent
------------------------------
1    abc     low         100
2    xyz     low         200
2    xyz     mid         150
2    xyz     high        300
3    mno     low         600
3    mno     mid         200 
```

我希望得到该组（`group by`）`title`具有“最低租金”的结果。

PLZ帮忙。

* * *

我想要以下结果集

```
 id | title | type    |    rent
    ------------------------------
    1  |  abc  |   low  |     100
    ------------------------------
    2  |  xyz  |   mid  |     150
    ------------------------------
    3  |  mno  |   mid  |     200
    ------------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T13:55:08.170

你可以这样做：

```
SELECT t1.*
FROM tablename AS t1
INNER JOIN
(
   SELECT title, MIN(rent) AS minrent
   FROM tablename
   GROUP BY title 
) AS t2  ON t1.title = t2.title 
        AND t1.rent  = t2.minrent; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!2/f0b89/1)

这会给你：

```
| ID | TITLE | TYPE | RENT |
----------------------------
|  1 |   abc |  low |  100 |
|  2 |   xyz |  mid |  150 |
|  3 |   mno |  mid |  200 | 
```

这将为您提供最低的租金`title`。

* * *

**但是：**如果您只寻找最新的瓷砖，`rent`那么您可以这样做：

```
SELECT t1.*
FROM tablename AS t1
ORDER BY rent  
LIMIT 1 
```

## [更新的 SQL Fiddle 演示](http://www.sqlfiddle.com/#!2/f0b89/3)

这会给你这一行：

```
| ID | TITLE | TYPE | RENT |
----------------------------
|  1 |   abc |  low |  100 | 
```

**请注意：**如果有重复`Rent`的最低租金相同，那么这不会给你那些重复的。在这种情况下，使用[@user2009463](https://stackoverflow.com/a/15203269/722783)建议的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:00:01.997

```
select * from table_name
where rent = (select min(rent) from table_name)
group by title; 
```

# bash - 使用 SAR 命令查找 cpu 利用率并在使用率超过 75% 时发送电子邮件的 Shell 脚本

> ID：15203158
> 
> 赞同：1
> 
> 时间：2013-03-04T13:53:31.050
> 
> 标签：bash, shell, unix

```
13:30:01          CPU     %user     %nice   %system   %iowait    %steal     %idle
13:40:01          all      0.56      1.21      0.69      1.64      0.00     95.89
Average:          all      0.63      1.25     11.10      7.48      0.00     79.55 
```

这是 sar 命令的输出。我想从平均值中添加 %user 和 %system ，如果超过 75% 则向用户发送电子邮件。请帮忙，也请让我知道是否有更好的方法来计算 CPU 使用率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:40:17.570

```
#!/bin/bash
saveIFS=$IFS
IFS=$' '
USAGE=( $( sar | tail -1 | cut -c20-29,40-49 ) )
IFS=$saveIFS
SUM=0
for (( CNTR=0; CNTR<${#USAGE[@]}; CNTR+=1 )); do
    FLOAT=( $( echo ${USAGE[$CNTR]} | tr ',' '.' ) )
    SUM=( $( echo "$SUM+$FLOAT" |bc  ) )
done
INT=${SUM/.*}
echo $INT
if [[ $INT == "" ]]; then
    INT=0
fi
if [ $INT -ge 75 ]; then
    mail -s "CPU usage is above 75%" mailbox@yourcompany.com < $INT
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T17:11:37.280

```
#!/bin/bash
TMPFILE=/tmp/CPUtmp
sar |awk '$1 == "Average:"{T=$3+$5; if (T > 75){print T}}' > $TMPFILE
if [ -s $TMPFILE ] ; then
  mail -s "CPU usage is above 75%" mailbox@yourcompany.com < $TMPFILE
fi 
```

如果您想要当前利用率，“sar 5 6”而不是“sar”将每隔 5 秒检查半分钟。

# jquery - 将所选项目移动到列表框顶部

> ID：15203165
> 
> 赞同：0
> 
> 时间：2013-03-04T13:54:00.727
> 
> 标签：jquery, knockout.js

我真的很想找到在顶部列表框中显示所选项目的解决方案。我在这里使用敲除来绑定我的列表框。在我看来，列表框绑定如下

```
<select id ="multiAltVersion" multiple="multiple"  data-bind="options:  $root.editOnlyAlternativeVersions,  optionsText: 'PlatformVersionName',optionsValue: 'Id',selectedOptions:  $root.copiedAltVersion, chosen: true  "> </select> 
```

我调用我的 WCF 服务来填充列表框。

```
 function loadVersionListByProductType(prodtype) {
        var input =
        {
            ProductType: prodtype

        };

        $.ajax({
            url: "../RestService/Test/ReturnData",
            type: "PUT",
            contentType: 'application/json',
            processData: false,
            data: JSON.stringify(input),
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(errorThrown);
            },
            success: function (allData) {
                var mappedVersionListByProdType = $.map(allData, function (item) {

                    return new productVersionListByProductType(item);
                });
                self.editOnlyAlternativeVersions(mappedVersionListByProdType);

            }

        });

    } 
```

当数据从 WCF 服务返回时，它按降序返回数据。但我想在顶部显示选中，然后以降序方式对列表进行排序。我从另一项服务中获取项目列表，并从另一项服务中获取选定项目。是否有意义？我如何使用 Jquery 来实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:04:23.517

下载数据时可以使用Knockout中的[排序功能：](http://knockoutjs.com/documentation/observableArrays.html)

```
editOnlyAlternativeVersions.sort(function(left, right)
{
    return left.selected == right.selected ? 
        // Selected is equal, so sort on name
        left.name == right.name ? 0 : (left.name < right.name ? -1 : 1) : (left.selected < right.selected ? -1 : 1)
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:12:23.113

一个使用计算的 observables 的简单示例（未经测试和未优化）：

```
var myViewModel = function() {
   var options = ko.observableArray(["option1","option2","option3"]);
   var selected = ko.observable(options[2]);

   var sortedOptions = ko.computed(function() {
       var sorted = [];
       sorted.push(selected());
       for (var i=0; i < options().length; i++) {
           if(options()[i]!=selected()) {
              sorted.push(options()[i]);
           }
       }
       return sorted;
   });
} 
```

然后绑定到`sortedOptions`，它应该是顺序：

```
option3, option1, option2 
```

选择一个新选项将强制它重新计算，就像向`options`数组添加新选项一样。

# php - 在 WordPress 循环中按日期显示自定义分类中的最后一篇文章

> ID：15203167
> 
> 赞同：5
> 
> 时间：2013-03-04T13:54:05.310
> 
> 标签：php, mysql, wordpress

我有一个自定义分类法，我用它来捆绑系列帖子（系列是该分类法中的一个术语）。我希望在执行 WordPress 循环时将这些捆绑的帖子视为特殊情况。

只有系列中的第一个帖子（日期最近的帖子）应显示，所有其他不属于自定义分类中的术语的帖子应视为普通帖子。除了自定义系列分类法之外，帖子还可以标记或分类（因此最多三个分类法，包括自定义分类法）。循环应该包含固定数量的帖子（例如，在 WordPress 后端设置的首页上的帖子数量）。

我不知道如何对这些帖子进行分组，部分原因是所有数据都在不同的表中，而且每个条目都可以属于多个分类法。当然，循环遍历帖子数组，在 MySQL 调用之后丢弃系列中较旧的帖子是可能的，但在这种情况下，如果不对数据库进行额外的查询，就很难维持固定数量的帖子。

所以我想实现一个纯SQL解决方案。我一直在尝试使用`posts_clauses`钩子。我相信，下面的这个查询在一系列中返回具有最高 ID 的帖子，而不是日期，并且对数据库相当繁重。

```
$clauses['fields'] .= ", $wpdb->posts.ID AS postID, (SELECT $wpdb->terms.term_id 
   FROM $wpdb->posts, $wpdb->term_taxonomy, $wpdb->term_relationships, $wpdb->terms     
   WHERE $wpdb->posts.ID=postID 
     AND $wpdb->term_taxonomy.taxonomy='post-series' 
     AND $wpdb->term_relationships.term_taxonomy_id=$wpdb->term_taxonomy.term_taxonomy_id 
     AND $wpdb->posts.ID=$wpdb->term_relationships.object_id 
     AND $wpdb->terms.term_id=$wpdb->term_taxonomy.term_id 
   ORDER BY $wpdb->posts.post_date DESC 
   LIMIT 0,1) AS uniqueID";

$clauses['groupby'] = "IFNULL(uniqueID,$wpdb->posts.ID)"; 
```

基于上面的条款，WordPress 构造了以下 SQL 查询：

```
SELECT SQL_CALC_FOUND_ROWS  wp_posts.*, wp_posts.ID AS postID, 
  (SELECT wp_terms.term_id FROM wp_posts, wp_term_taxonomy, wp_term_relationships, wp_terms 
    WHERE wp_posts.ID=postID 
      AND wp_term_taxonomy.taxonomy='post-bundles'
      AND wp_term_relationships.term_taxonomy_id=wp_term_taxonomy.term_taxonomy_id 
      AND wp_posts.ID=wp_term_relationships.object_id 
      AND wp_terms.term_id=wp_term_taxonomy.term_id 
    ORDER BY wp_posts.post_date DESC LIMIT 0,1) 
  AS uniqueID FROM wp_posts 
WHERE 1=1
AND wp_posts.post_type = 'post' 
AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private') 
GROUP BY IFNULL(uniqueID,wp_posts.ID) 
ORDER BY wp_posts.post_date DESC 
LIMIT 0, 10 
```

我也读过[这个教程](http://scribu.net/wordpress/sortable-taxonomy-columns.html)，但我不确定它是否适用于这种情况。

总结一下：在循环中，我只想显示属于自定义分类中的术语的最新帖子（按 post_date 排序），并在循环中排除该分类中的其他帖子。该循环还包含不属于自定义分类法的常规帖子，并且两种类型都可能属于多个类别并具有标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T23:14:59.693

好的，这是我的答案（这更像是一个建议）

我的方法是首先从他们任期内最新的帖子中选择每个 id，并且属于分类学帖子系列。

```
select * from wp_posts where ID in(
select ID from
(
select wp_posts.ID , wp_posts.post_date, d.name from wp_posts as a
join wp_term_relationships as b on ( a.ID = b.object_id)
join wp_term_taxonomy as c on (b.term_taxonomy_id = c.term_taxonomy_id)
join  wp_terms as d on (c.term_id = d.term_id)
where c.taxonomy = 'post-series'
group by d.name 
having (wp_posts.post_date = max(wp_posts.post_date))
)tmp) 
```

我按 d.name 分组，因为您想要该名称的一个条目并使用 have，因为您想要一个具有最大 post_date 的条目

然后我选择从该查询中出现的所有 id 并在`where ID in ()`子句中使用它们

我无法对此进行测试，但这就是我在 mysql 中解决它的方法。

# php - PHP 错误抑制被忽略

> ID：15203168
> 
> 赞同：5
> 
> 时间：2013-03-04T13:54:06.893
> 
> 标签：php, error-reporting, error-suppression

我当前的 php.ini 文件设置为报告除弃用和严格标准之外的所有错误，如下所示：

```
error_reporting = E_ALL & ~E_STRICT & ~E_DEPRECATED 
```

使用此设置的原因是我们迫切需要在托管我们网站的 linux 服务器上执行 PHP 升级；问题在于，不推荐使用的功能和严格的标准建议将很快填满 170 多个网站的错误日志文件。这些错误主要是由于诸如函数未声明为静态等小问题。最终我们将通过所有站点并修复这些问题，但同时我们需要抑制错误。

我在本地测试环境中遇到的问题（运行我们希望升级到的 PHP 版本 - 5.4.3）是错误仍然显示，之前打印了以下内容：

```
SCREAM: Error suppression ignored for 
```

谁能给我一些关于为什么忽略错误抑制以及如何正确抑制错误的见解？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T16:15:22.940

看来您正在使用尖叫扩展。从手册：

> 尖叫扩展提供了禁用静音错误控制运算符的可能性，以便报告所有错误。此功能由 ini 设置控制。

[Scream](http://www.php.net/manual/de/book.scream.php)是一个调试扩展，旨在显示尽可能多的错误消息。这是通过忽略`@`运算符并始终具有最高可用的 error_reporating 级别来完成的。（无论您的`error_reporting`设置如何）。因此，您必须停用 php.ini 中的扩展：

```
scream.enabled = off 
```

* * *

顺便说一句：我不会用代码错误更新一个有 170 个网站的服务器。现在是一颗定时炸弹。最好将它们逐个站点迁移到新的 PHP 版本。在迁移过程中可能有两台服务器并行。

# php - 在 wordpress 中获取每个类别的最新帖子，并附上帖子附件

> ID：15203173
> 
> 赞同：0
> 
> 时间：2013-03-04T13:54:34.833
> 
> 标签：php, wordpress, wordpress-theming

在 wordpress 安装的主页上，我想显示每个类别的最新帖子，包括类别标题、帖子附件、帖子标题、帖子摘录和发布日期。

帖子附件将始终是“特色图片”的缩略图版本。我希望使用附件而不是链接到文章的主图片的原因是我们正在使用一个插件，该插件允许编辑发布一个覆盖特色图片的 youtube 链接，所以如果我使用“get_the_post_thumbnail”它会拉入视频而不是图像。

我目前从我找到的解决方案的混搭中使用的代码如下：

```
 <?php

         query_posts('cat=3&showposts=1');
          if(have_posts()) :
            the_post();
            $images = get_children(array(
              'post_parent' => get_the_id(),
              'post_type' => 'attachment',
              'post_mime_type' => 'image',
              'orderby' => 'ID',
              'order' => 'ASC',
              'numberposts' => 1
            ));
            foreach((array)$images as $key => $image){
              echo wp_get_attachment_image($key);
              echo "<a href='" . get_permalink() . "'>Link</a>";
            }
            the_excerpt();
          endif;
        wp_reset_query();

    ?> 
```

我的上述问题如下：

1）我不知道如何获取类别名称（我可以硬编码并为每个类别重复上述内容，但这似乎是作弊）。

2）当我为下一个类别重复此代码时，图像或永久链接不显示。我认为这是因为我在重复引用或类似的东西，但我对 Wordpress 太业余了，不知道。

任何帮助都感激不尽。最终结果是这样的：[http ://www.tagdesignuk.com/lovethat/](http://www.tagdesignuk.com/lovethat/)

问候，

凯文

更新：

我现在已经简化了这个，但仍然有点卡住。我已经删除了视频插件，因为稍后我会找到一种更简单的方法来执行此操作，所以现在我唯一的问题是拉入正确大小的缩略图。

我正在使用以下代码：

```
<?php
$catquery = new WP_Query( 'cat=3&posts_per_page=1' );
while($catquery->have_posts()) : $catquery->the_post();
?>
<a href="<?php the_permalink() ?>" rel="bookmark"><?php the_title(); ?></a>
<?php echo get_the_post_thumbnail(); ?>
<?php the_content(); ?>
<?php the_date(); ?>
<?php endwhile; ?> 
```

关于如何更改缩略图大小的任何想法？文档（[http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail](http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail)）说使用如下：

```
<?php echo get_the_post_thumbnail( $post_id, $size, $attr ); ?> 
```

但是在没有帖子 ID 的情况下它不起作用......而且我不知道如何正确格式化它，也找不到任何关于我应该做什么的参考。

非常感谢，

凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:25:52.420

您可以使用 get_categories() 查询所有类别，然后使用 name 属性。例如，您应该查看此函数的[Wordpress Codex 条目](http://codex.wordpress.org/Function_Reference/get_categories)。

# sql - 使用Oracle..需要将具有1个单词内容的列的每一行与具有段落作为行值的列的行进行比较

> ID：15203174
> 
> 赞同：0
> 
> 时间：2013-03-04T13:54:47.157
> 
> 标签：sql, oracle

我有一列有 n 行。每行都有一个单词作为其值。例如“你好”、“那里”等我还有另一列有 m 行。每行都有一个很大的段落，我需要将第一列的每一行与后一列的每一行进行比较。基本上我需要在段落中找到特定的单词，并确定在第一列的行中存在甚至 1 个单词的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:01:51.917

做一个内连接和类似的条件。

当一个词是另一个词的一部分时，您可能会遇到问题。例如，单词“the”在“there”中，因此只要段落中有单词“there”，即使没有出现单词“the”，对 '%the%' 的查询都会为真。我将在单词前后使用空格来防止这种情况发生，但这会遗漏段落开头和结尾的单词，除非您（a）在段落表中存储前导和尾随空格，或（b）使用字符串连接在查询中执行相同的操作，这可能（或可能不会）影响性能。

```
select *
from word_table
  inner join paragraph_table
     on ' ' || paragraph_table.paragraph || ' ' like '% ' || word_table.word || ' %' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:37:18.317

不确定这是否是您想要的...我的示例计数发生了。或字符串中的单词“world”。有两个发生，所以它会返回 2。

```
SELECT count(*) word_count  FROM
(
 SELECT Distinct(Instr('Hello world! So happy to meet you world!', 'world', LEVEL)) str_cnt
  FROM dual
 CONNECT BY LEVEL < length('Hello world! So happy to meet you world!') 
 ) 
WHERE str_cnt > 0
/ 
```

这将返回 4：

```
SELECT REGEXP_COUNT('Hello world world! So happy to meet you world world!', 'world') word_count
 FROM dual
/ 
```

如果您的任何行的字数超过 0-0，那么您就获得了胜利——您确定了您在描述中所写的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T16:10:20.170

我假设您需要考虑单词位于行首或行尾，并且段落将在行首有正常的标点符号。

这应该考虑到这些情况。

```
select
word
,paragraph
from 
(select
'(\W|^)' || word || '(\W|$)' as regexp
,word
from t1
) t
join t2 on
 (regexp_instr(paragraph, t.regexp) > 0)
; 
```

如果您想要不区分大小写的搜索，那么您可以使用此查询

```
select
word
,paragraph
from 
(select
'(\W|^)' || word || '(\W|$)' as regexp
,word
from t1
) t
join t2 on 
    (regexp_instr(paragraph, regexp, 1, 1, 0, 'i') > 0)
; 
```

[这是sqlfiddle](http://sqlfiddle.com/#!4/097b2/4/0)

# powershell - 如何在 PowerShell 二进制模块中捕获外部 DLL 的控制台输出？

> ID：15203175
> 
> 赞同：3
> 
> 时间：2013-03-04T13:54:50.743
> 
> 标签：powershell, powershell-2.0

我正在创建一个 PowerShell 二进制模块，它使用输出到控制台的第三方库 (DLL)。所以，基本上我希望我的二进制模块输出它自己的消息和那个 DLL 的控制台输出。

是否可以？

因此，假设第三方 API 执行以下操作：

```
public static void SomeMethod() {
  ...
  Console.Write("Extracting the file...");
  ...
} 
```

二进制模块调用它：

```
protected override void ProcessRecord() {
  ...
  this.WriteObject("Hello!");
  SomeClass.SomeMethod();
  this.WriteObject("Goodbye!");
} 
```

我看到的输出是：

```
Hello!
Goodbye! 
```

我想看到的是：

```
Hello!
Extracting the file...
Goodbye! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T15:47:36.920

查看[System.Console.SetOut()](http://msdn.microsoft.com/en-us/library/system.console.setout.aspx)方法，将当前进程的标准输出临时设置为您可以读取的文本编写器。调用 DLL 后，您将使用 Console.OpenStandardOutput() 将标准输出重置为默认值。查看 SetOut 主题页面上的示例。

# apache - JSF 前的 Apache

> ID：15203177
> 
> 赞同：4
> 
> 时间：2013-03-04T13:54:56.693
> 
> 标签：apache, jakarta-ee, jsf-2, jboss, mod-proxy

在 Jboss AS 7 中：

将 Apache 放在 Jboss 前面可以正常工作：

```
ProxyPass / http://localhost:8080
ProxyPassReverse / http://localhost:8080 
```

所以 app 由*domain.com/app*访问。

瞄准更清晰的 URL（只是*domain.com*）时出现问题：

```
ProxyPass / http://localhost:8080/app
ProxyPassReverse / http://localhost:8080/app 
```

在第二种情况下，所有**javax.faces.resource**都不会交付，因为它们不使用*战争*上下文 URL。

知道如何在第二种情况下获取人脸资源吗？也许只是搬到 mod_jk？

这个关于 ResourceHandler 的[答案](https://stackoverflow.com/a/7356094/1341526)非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:45:58.447

JSF通过路由[`ResourceHandler`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ResourceHandler.html)发出 URL `<contextPath>/javax.faces.resource/`，尽管是通过 ScriptRenderer、StyleSheetRenderer 等间接发出的。

由于您在 ProxyPass 指令中省略了应用程序名称（上下文路径），因此在将 URL 提供给浏览器之前，您需要使用 URL 重写器来省略这些 URL。请参阅[相关问题](https://stackoverflow.com/questions/9905946/jsf-url-rewriting-solution-needed)中有关如何实现此目的的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-06T06:51:04.870

我使用多个`ProxyPass`和`ProxyPassReverse`条目来适应 JSF 可能吐出的不同上下文路径。以下通常是我对每个域 ( `ServerName`) 的默认设置...

```
<VirtualHost 127.0.0.1:8080>
    ServerAdmin email@email.com
    DocumentRoot "/"
    ServerName "dev.mydomain.com"

    ProxyPass /MyApp/ ajp://127.0.0.1:8009/MyApp/
    ProxyPassReverse /MyApp/ http://127.0.0.1:80/MyApp/

    ProxyPass /MyApp ajp://127.0.0.1:8009/MyApp/
    ProxyPassReverse / http://127.0.0.1:80

    ProxyPass / ajp://127.0.0.1:8009/MyApp/
    ProxyPassReverse / http://127.0.0.1:80/     
</VirtualHost> 
```

上述配置将允许使用以下任何 URI 访问 Web 应用程序：

```
http://dev.myapp.com/MyApp/
http://dev.myapp.com/MyApp
http://dev.myapp.com/ 
```

因此，`http://dev.myapp.com/javax.faces.resource/example.css`将达到最后一条规则并被路由到`http://dev.myapp.com/MyApp/javax.faces.resource/example.css`. 此外，`http://dev.myapp.com/MyApp/javax.faces.resource/example.css`将符合第一条规则并按原样通过。

**笔记：**

1.  **顺序很重要！**这些规则将自上而下处理。如果您将`ProxyPass`for '/' 放在首位，则其他条件将永远不会得到处理。由于每个 URI`/`在主机名之后都有一个，因此每个请求都将使用该条件进行处理......这就是为什么`/`条件应该始终放在最后的原因。
2.  I highly recommend using the Apache JServ Protocol (`ajp`) Connector (instead of HTTP). It's built into Apache and JBOSS, it's easy to turn on and it significantly improves performance... especially if there's any kind of binary data (images) being routed. [https://docs.jboss.org/jbossweb/2.1.x/config/ajp.html](https://docs.jboss.org/jbossweb/2.1.x/config/ajp.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:46:24.187

遇到同样的问题，也没有找到配置 apache 服务器的方法。

如果您只想整理您的 URL，我可以推荐[URLRewriteFilter](http://tuckey.org/urlrewrite/)这在这种情况下对我有帮助。

希望这会有所帮助，玩得开心！

# c - Segfault 无法访问地址处的内存

> ID：15203184
> 
> 赞同：4
> 
> 时间：2013-03-04T13:55:19.213
> 
> 标签：c, segmentation-fault, controls

我在下面的代码部分遇到了分段错误：（关于这个 segfault ，我在一个主题中问了 2 个问题）

```
req_cw(ECM_REQUEST *er, int32_t flag, int32_t reader_types){

    LL_NODE *ptr;
    for (ptr = er->matching_rdr->initial ; ptr ; ptr = ptr->nxt) {
        if (ptr == er->fail)
            break;
    rdr = (struct s_reader*)ptr->obj;
    we_equest(rdr->fd, er);
    }
} 
```

如您所见，即使控制结构`if(ptr->obj && ptr)`可以确定`ptr`（或`ptr->obj`不会是`null`指针），但它并不能阻止它，并且在我尝试打印值时出现分段错误`ptr->obj`：

打印 ptr->obj ，gdb 说：

> (gdb) 打印点 $1 = (LL_NODE *) 0x149
> 
> (gdb) x 0x149
> 
> 0x149：无法访问地址 0x149 处的内存

我的问题是：如何防止这种分段错误，为什么会发生这种分段错误以及如何解决？

1.  关于这个段错误，当使用 gdb 时，我检查了第 1 帧（段错误发生之前的一帧），我发现

er->cw我的问题是如果不等于，`"\000 <repeats 15 times>"` 我该如何控制？`er->cw``"'\000' <repeats 15 times"`

我这样做了，我知道这是不正确的（我错过了一些东西），这就是我在这里问的原因

```
if (er->cw)
req_cw(er , ...) 
```

问题在于添加`if(er->cw)`. 我认为`cw`是字符，我不应该表现得像 integer ，但我不知道如何检查它不为零？我的意思是，即使在我检查 gdb 时再次使用这一行，仍然`er->cw`具有 "'\ 000'" 正在传递，那么如何使用 if 控制块检查何时`er->cw`不等于 '\000'" ？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:56:07.470

`As you see, even with the control structure with if(ptr->obj || ptr) to be sure ptr (or ptr->null won't be null pointer)`

不......这实际上并不能确保两者都不会为NULL，这会使您陷入段错误。将在退出之前`||`评估***双方***，并且无论如何您都可以向后设置逻辑。你想要`&&`并且你需要翻转它们，否则它会尊重可能是`NULL`指针的东西：

```
if(ptr && ptr->obj) 
```

* * *

> > 在我尝试打印值 ptr->obj 时出现分段错误后：
> > print ptr->obj ，gdb 说：
> > ...
> > 0x149：无法访问地址 0x149 的内存

我从未见过`0x149`有效的地址，您在哪个硬件平台上？

* * *

> er->cw 是 "\000" 我的问题是如何控制 er->cw 不等于 "'\000'

这不清楚，你能展示一下结构`er`吗？你是说这`er->cw`是一种`char *`类型并且设置为`"\000 <repeats 15 times>"`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:47:27.103

> 如您所见，即使使用带有 if(ptr->obj || ptr) 的控制结构来确保 ptr （或 ptr->null 不会是空指针）

问题是您进行测试的顺序，编译时`ptr->obj`首先完成，因此如果`ptr`为 null 您正在访问无效内存，则获取`obj`成员。颠倒测试的顺序`if (ptr || ptr->obj)`

**但是**那仍然不对...您的`OR`逻辑也是错误的，代码应该是...

```
if ((ptr != NULL) && (ptr->obj != NULL))
{
   // use the pointer
} 
```

# c# - 如何在 Web 角色和服务总线以外的辅助角色之间发送消息？

> ID：15203189
> 
> 赞同：0
> 
> 时间：2013-03-04T13:55:32.857
> 
> 标签：c#, azure, azure-worker-roles, azureservicebus, azure-servicebus-queues

我一直在使用 azure 服务总线在 web 角色和工作角色之间来回发送消息，我真的认为这是一个非常好的解决方案，但最近我发现服务总线非常不稳定，有时它可以工作，有时消息会消失无缘无故变成一纸空文。我不知道它是否在我的代码中存在问题，但在我看来它只是不稳定的，因为有时它有效，有时它不起作用。所以我想知道是否有任何替代服务总线的解决方案，或者我很高兴知道在服务总线实现中出现的任何错误导致我的上述问题。下面是我的代码

```
public override void Run()
{
    while (!IsStopped)
    {
        try
        {
            if (BroadcastReceived)
                {
                    BroadcastReceived = false;
                    // Receive the message from Web Role to upload the broadcast to queue
                    BroadcastClient.BeginReceive(OnWebRoleMessageReceived, null);
                }

                if (SignalRMessageReceived)
                {
                    SignalRMessageReceived = false;
                    // Receive the message from SignalR BroadcastHub
                    SignalRClient.BeginReceive(OnSignalRMessageReceived, null);
                }

                if (SignalRFirstTimeMessageReceived)
                {
                    SignalRFirstTimeMessageReceived = false;
                    // Receive the message from SignalR BroadcastHub
                    SignalRFirstTimeClient.BeginReceive(OnSignalRFirstTimeMessageReceived, null);
                } 
     }
 }
public void OnWebRoleMessageReceived(IAsyncResult iar)
{
    BrokeredMessage receivedBroadcastMessage = null;
    receivedBroadcastMessage = BroadcastClient.EndReceive(iar);

    if (receivedBroadcastMessage != null)
    {
        // Process the message
       receivedBroadcastMessage.Complete();
    }
BroadcastReceived = true;
 } 
```

在上面的代码中，我只展示了一个服务总线客户端的方法。在我的工作角色中，使用了 3 个服务总线客户端，即异步发送和接收来自不同队列的消息。它真的很奇怪，有些消息是如何工作的，有些消息是无缘无故地死信的，有时它是替代的，所以我认为我的代码中一定有问题，但我找不到任何问题。如果有人不知道问题是什么，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:38:42.567

你考虑过 NServiceBus 吗？我不确定是否有很多关于集成 SignalR 和 NServiceBus 的示例，但谷歌搜索应该能让你开始

[http://ben.onfabrik.com/posts/push-notifications-with-nservicebus-and-signalr](http://ben.onfabrik.com/posts/push-notifications-with-nservicebus-and-signalr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:41:39.753

没有显式调用 message.DeadLetter() 的消息进入死信队列有几个原因。检查以下内容： 1)队列和消息上的[TimeToLive](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.brokeredmessage.timetolive.aspx)，如果此时间到期，则消息将被死信且未传递。默认情况下这是无限的。2) 传递计数决定了消息在被死信之前被接收的次数。上面我没有看到任何异常处理，所以说您在消息处理过程中遇到错误并且没有在消息上调用完成，传递计数会增加。在队列上，您可以[选择](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.queuedescription.maxdeliverycount.aspx)设置在死信之前应该传递多少次消息。

# haskell - 检索 Haskell 项目中所有导入的列表

> ID：15203191
> 
> 赞同：5
> 
> 时间：2013-03-04T13:55:35.270
> 
> 标签：haskell, code-analysis

因此，我的最终目标是评估 cabal 文件中依赖项的准确性，方法是确保项目导入的所有实体都存在于它声称可以使用的版本中。

一个好的开始是查找单个源文件使用的所有导入实体的列表，可选择包含它们来自何处的信息。

我愿意暂时忽略类实例的情况，因为检测它们的使用并不是那么简单。

理想的答案是指向一个工具的指针，它可以做到这一点，但我也会接受一个答案，指向我需要自己编写的资源（GHC 是否收集此信息？它是否将其转储到任何地方？可以吗？被说服这样做？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T16:01:20.657

最终，[haskell-names](https://github.com/feuerbach/haskell-names)应该能够以最小的努力完成类似的事情。需要注意的是，您需要使用 haskell-names 自己的“编译器”重新“编译”您引用的每个包，以便生成接口文件。将来我还计划为所有 hackage 包分发预编译的接口（可能来自 hackage 本身）。

现在 haskell-names 正在进行中，还不能编译`base`。

GHC API 的优点是如果您安装了软件包，您已经拥有接口文件，但我不确定它是否可以访问导入的实体列表。

# shell - 内存不足java堆异常

> ID：15203194
> 
> 赞同：0
> 
> 时间：2013-03-04T13:55:41.800
> 
> 标签：shell

我在 unix 环境中运行我的 java 代码时出现内存不足 java heap 异常。

我有调用java类的bash shell脚本，在运行脚本后几秒钟内我得到了错误。

任何建议都会有所帮助。

下面是我的shell脚本。

```
home_dir=/opt/IBM/IEEP/MigrationBatch
java_home=/opt/IBM/WAS/java
lib_path=$home_dir/lib
job_path=$home_dir/bin/jobs
config_path=$home_dir/bin/config

batch_root_path=$home_dir
root_path=$batch_root_path/migration

mkdir -p $root_path
mkdir -p $root_path/working

log_date=$(date +%m%d%Y_%H%M%S)
run_date=$(date +%Y%m%d_%H%M%S)
job_name="MigrationBatch"

script_log_path=$root_path/script_logs
logfile=$script_log_path/script_log_migration_txt_$log_date.txt
mkdir -p $script_log_path
echo "Script Log Files available at $logfile"
exec>>$logfile
echo "Starting Java process for MigrationBatch Job...."

## STEP 1 : Run the Java Job
export JAR_HOME=$lib_path
export JOB_HOME=$job_path
export CONFIG_HOME=$config_path

JAR_CLASSPATH=:$lib_path/activation-1.1.jar:
echo $JAR_CLASSPATH

$java_home/bin/java -Djob_name=$job_name - Drun_timestamp=$run_date -cp $JAR_CLASSPATH:$job_path:$config_path org.springframework.batch.core.launch.support.CommandLineJobRunner migrationJob.xml  migrationJob -next

script_output="$(echo $?)" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:48:16.823

这不是你的 shell 内存不足，这是你可以尝试的 java 命令行执行：

```
 java -Xmx1024m -jar jarfie
 java -Xms512m -Xmx2g -jar somejar
 $java_home/bin/java -Xms512m -Xmx2g -Djob_name=$job_name -Drun_timestamp=$run_date -cp $JAR_CLASSPATH:$job_path:$config_path org.springframework.batch.core.launch.support.CommandLineJobRunner migrationJob.xml migrationJob -next 
```

如果它仍然给您带来内存问题，您可能需要增加更多

# perl - Perl 中的标头有什么意义？

> ID：15203195
> 
> 赞同：2
> 
> 时间：2013-03-04T13:55:42.170
> 
> 标签：perl, syntax

我正在阅读一个教程，它说每个 Perl 程序都应该以

```
#!D:\Perl\bin\perl 
```

这样做的目的是什么？教程上根本没有解释。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T14:03:22.957

那个“标题”没有意义。[shebang 行](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)由 unix 程序加载器使用，您显然没有使用它。

没有它，系统将无法知道如何运行您的脚本。执行脚本的人必须启动`perl`并告诉它自己运行脚本。换句话说，它允许一个人替换

```
/usr/bin/perl program 
```

和

```
program 
```

在 Windows 中，这是由[文件关联](http://en.wikipedia.org/wiki/File_association)处理的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T14:05:09.700

脚本中的那一行被称为[shebang](https://en.wikipedia.org/wiki/Shebang_%28Unix%29)。在 unix 类型的操作系统中，它告诉程序加载器应该用什么来处理文件的其余部分。

我认为现在的规范是使用在路径上找到的 perl，例如：

`#!/usr/bin/env perl`

由于您的看起来像 Windows，因此 shebang 在[很大程度上被忽略](http://perldoc.perl.org/perlwin32.html#Running-Perl-Scripts)了，但 perl 仍然会查看它以查看您是否传递了诸如此类的`-w`标志`-T`。

# junit - 使用 MockServletInvocationTest 对 Apache Wink REST 服务进行单元测试

> ID：15203197
> 
> 赞同：0
> 
> 时间：2013-03-04T13:55:48.423
> 
> 标签：junit, mocking, apache-wink

我使用 Apache Wink 1.2.1。我想对我的 REST 服务进行单元测试，我宁愿在不使用[RestClient](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.wink/wink-client/1.2.1-incubating/org/apache/wink/client/RestClient.java)的情况下进行测试。我没有找到任何示例，但是经过大量搜索后，我猜想[MockServletInvocationTest](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.wink/wink-component-test-support/1.2.1-incubating/org/apache/wink/test/mock/SpringMockServletInvocationTest.java#SpringMockServletInvocationTest)是正确的起点……但是我无法使其工作。

这是一个对我来说失败的最小示例。

我的 REST 服务：

```
@Path("greetings")
public class GreetingsResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String hello() {
        return "Hello World!";
    }

} 
```

对应的单元测试：

```
public class GreetingsResourceTest extends MockServletInvocationTest {

    @Override
    protected Class<?>[] getClasses() {
        return new Class<?>[] { GreetingsResource.class };
    }

    public void testHello() throws ServletException, IOException {
        MockHttpServletRequest request = MockRequestConstructor.
            constructMockRequest("GET", "/greetings", MediaType.TEXT_PLAIN);
        MockHttpServletResponse response = invoke(request);
        assertEquals(200, response.getStatus());
    }

} 
```

所以，我有几个问题：

1.  我走错方向了吗？

2.  如果我朝着正确的方向前进，那我做错了什么？在执行上一个测试用例时，我收到以下错误（我真的不明白）：

> java.lang.NoSuchMethodError: javax/servlet/http/HttpServletResponse.getContentType()Ljava/lang/String; 在 org.apache.wink.server.internal.handlers.FlushResultHandler$FlushHeadersOutputStream.flushHeaders(FlushResultHandler.java:350) ~[wink-server-1.2.1-incubating.jar:1.2.1-incubating]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T16:57:25.920

我发现我的问题是什么，我只是在这里留下一个便条，以防有人遇到同样的问题。

这就是我得到的原因`NoSuchMethodError`：

*   我使用[Apache Maven](http://maven.apache.org/)来处理依赖项
*   使用`MockHttpServletRequest`，`MockHttpServletResponse`我包含了对 spring-mock 2.0.8 的依赖：

    ```
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-mock</artifactId>
      <version>2.0.8</version>
      <scope>test</scope>
    </dependency> 
    ```

*   不幸的是 spring-mock 2.0.8 依赖于 commons-logging 1.1，而后者又依赖于 servlet-api 2.3，其中`javax/servlet/http/HttpServletResponse.getContentType()Ljava/lang/String`不存在！该方法从 servlet-api 2.4 开始存在

So, to solve my problem I simply added an explicit dependency to servlet-api 2.4 with scope test! Now my unit test works without a problem!

# javascript - HTML 多列选择列表

> ID：15203198
> 
> 赞同：3
> 
> 时间：2013-03-04T13:55:49.413
> 
> 标签：javascript, html, css, xhtml

通常创建 html 列表，

```
<select size=6 name="sel" id="sel">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="4">5</option>
    <option value="4">6</option>
    <option value="4">7</option>
    <option value="4">8</option>
    <option value="4">9</option>
</select> 
```

但它显示为，

```
1
2
3
4
5 
```

相反，我想成为它，

```
1   2   3   4
5   6   7   8
9   ......... 
```

或者

```
1   3   5   7
2   4   6   8 
```

如何在不使用任何“插件”和“jquery”等的情况下显示它。只想用纯javascript、html、css方式做

```
......... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:07:36.780

这对于输入是不可能的`<select>`。尝试这样的事情，让你开始：http: [//jsfiddle.net/spryno724/z67w9/5/](http://jsfiddle.net/spryno724/z67w9/5/)

```
<ul>
  <li>
    <ul>
      <li>1</li>
      <li>2</li>
    </ul>
  </li>

  <li>
    <ul>
      <li class="selected">3</li>
      <li>4</li>
    </ul>
  </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:02:33.330

无法修改选择选项的样式，它是系统控制。您应该使用 css 和 html 绘制类似的东西（或者按照建议使用 jquery 之类的库为您完成它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:16:07.540

您不能以这种方式设置选择样式。您必须创建一个自定义小部件，或者使用三个常规选择并在后端合并结果。

# c# - How to convert plain text to html and assign it to an in c#

> ID：15203205
> 
> 赞同：0
> 
> 时间：2013-03-04T13:56:19.923
> 
> 标签：c#, asp.net, webforms, bulletedlist

I have a string with html content as follows:

```
string eg = "hi..how <b>are</b> you?" 
```

I am assigning this string value to the text property of a bulleted list as follows:

```
lst.Text = eg; 
```

The purpose is to display "are" in bold. But currently it displays the string as it is. What property of the bulleted list is to be used to render the html controls in the string? Any help is appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:07:39.710

您将需要使用 *中继器*而不是*项目符号列表*，因为项目符号列表
不支持其 ListItems 的 HTML

类似的问题可以帮助你

[以编程方式将超链接添加到不是 DisplayMode=Hyperlink 的项目符号列表](https://stackoverflow.com/questions/13080120/programmatically-adding-a-hyperlink-to-a-bulleted-list-that-is-not-displaymode-h)

[ASP.NET 中的自定义项目符号列表项](https://stackoverflow.com/questions/1097916/customized-bulleted-list-items-in-asp-net)

而这个 channel9 msdn 页面

[http://channel9.msdn.com/Forums/TechOff/257894-aspnet-BulletedList-list-item-with-HTML-](http://channel9.msdn.com/Forums/TechOff/257894-aspnet-BulletedList-list-item-with-HTML-)

从上面引用

> 尝试使用中继器。BulletedList 不幸的是，它的 ListItems 不支持 HTML。

标记

```
<asp:Repeater ID="Repeater1" runat="server">
    <HeaderTemplate><ul></HeaderTemplate>
    <ItemTemplate><li><span class="label">Test</span> <%# Container.DataItem %></li></ItemTemplate>
    <FooterTemplate></ul></FooterTemplate>
</asp:Repeater> 
```

C＃

```
Repeater1.DataSource = items;
Repeater1.DataBind(); 
```

# mysql - MySQL：在 SELECT 语句中使用 COUNT 计算数字？

> ID：15203206
> 
> 赞同：0
> 
> 时间：2013-03-04T13:56:22.590
> 
> 标签：mysql

我想基本上取一个数字（total_score）并将其除以 <= 今天的（release_date）数量。我绝对想在 SELECT 语句中进行数学运算。我试过这个，但它似乎不起作用：

```
SELECT 
total_score / COUNT(release_date <= CURDATE()) as final_score
from movies
WHERE id = 12 
```

所以说总分是 400，而今天 <= 的 release_dates 数是 2。final_score 应该是 200。

我可以像这样在 SELECT 语句中计算吗？ `COUNT(release_date <= CURDATE())`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:03:13.703

也许试试这个：

```
SELECT 
total_score / (SELECT COUNT(release_date) FROM movies where release_date <= CURDATE()) as final_score
from movies
WHERE id = 12 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:03:21.270

也许尝试这样的事情： -

```
SELECT (total_score / score_count) as final_score
FROM movies
CROSS JOIN (SELECT COUNT(*) as score_count
FROM movies
WHERE release_date <= CURDATE()) AS Sub1
WHERE id = 12 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:07:44.150

不起作用的一个原因是您只选择了一行（其中 id=12）。您需要从表中选择两次。一次获取 id 12 的 total_score，另一次计算 CURDATE 之前的行数。尝试类似：

```
select A.total_score / count(B.release_date) from movies as A, movies as B
   where A.id=12 and B.release_date <= CURDATE(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T14:23:32.083

根据我的假设，Id 是主键（即电影的 ID）。然后查询总是返回单行。现在到 final_score 取决于发布日期。该发布日期必须早于当前日期，因此以下查询足以实现您的目标，

```
SELECT total_score / DATEDIFF(CURDATE(), release_date) AS final_score FROM movies WHERE id = 12 
```

# django - 防止 Django 为 ModelFormSet 中的每个表单查询 ForeignKey 选项

> ID：15203207
> 
> 赞同：12
> 
> 时间：2013-03-04T13:56:26.297
> 
> 标签：django, django-forms, django-database

我正在为我的 Django 应用程序构建一个 csv 导入表单，并希望在 a 中显示要导入的行以`ModelFormSet`进行验证。

因此，我向相关内容添加了一个视图，该视图`ModelAdmin`从 csv 中读取行并打印`ModelFormSet(queryset=an_empty_queryset, initial={data_from_the_csv})`.

问题是模型通过`ForeignKey`字段引用了其他三个模型，并且对于表单集中**每个表单中的每个字段，都会**发出数据库查询以填充`ModelChoiceField`的选项。

为什么 Django 不缓存表单（因为它被多次使用）或者已经有一种我不知道的方法来完成这个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-06T15:30:55.687

Django 表单集只是将表单创建的所有细节委托给表单对象本身，并且各个表单实例不知道其他表单实例，因此每个实例都必须查询自己的选择也就不足为奇了。

缓存也可能有意想不到的副作用——例如，表单的`__init__`功能可能依赖于`initial`它接收到的数据，从而使缓存的`form`对象不正确。

减少查询数量的最佳方法是检索一次选择查询集，然后将它们传递给它们的构造函数中的表单类。这将需要定义一个 custom`ModelForm`和一个 custom `ModelFormSet`。

您的表单将需要一个直接接受选择的构造函数：

```
from django.forms.models import ModelForm

class MyForm(ModelForm):
    def __init__(self, my_field_choices=None, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        self.fields['my_field'].choices = my_field_choices 
```

并且您的表单集将需要覆盖一个方法来运行查询集并将它们传递到构造它们的表单中：

```
from django.forms.models import BaseModelFormSet

class MyFormSet(BaseModelFormSet):
    def _construct_forms(self):
        # instantiate all the forms and put them in self.forms
        self.forms = []

        # Define each of your choices querysets
        my_field_choices = Model.object.filter(...)

        #Add your querysets to a dict to pass to the form
        form_defaults = {'my_field_choices': my_field_choices, }

        for i in xrange(min(self.total_form_count(), self.absolute_max)):
            self.forms.append(self._construct_form(i, **form_defaults)) 
```

（请参阅[Django 源代码](https://github.com/django/django/blob/master/django/forms/formsets.py)以了解其工作原理）

# php - PHP 除法返回不同的结果（Linux/Windows）

> ID：15203209
> 
> 赞同：2
> 
> 时间：2013-03-04T13:56:31.153
> 
> 标签：php, linux, windows, apache, division

我用php做了一个简单的划分。然后我在运行 apache 的 windows 机器和运行 apache 的 linux 机器上测试结果。

```
 WINDOWS: 1/15 returns 0.066666666666667
 LINUX: 1/15 returns   0.0666666666667 
```

有什么建议为什么会发生这种情况？是php、apache还是操作系统？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T13:58:16.343

通常，[PHP 浮点数的大小取决于平台](http://www.php.net/manual/en/language.types.float.php)，因此如果您想要可移植代码，则不应做任何假设。

但是，您看到的差异也可能是由配置设置的差异引起的。[浮点](http://php.net/manual/pl/language.types.float.php#110766)值的[*打印值*`precision`取决于设置](http://php.net/manual/pl/language.types.float.php#110766)。

有关的：

*   [PHP - 获取浮点变量内部值，答案 1](https://stackoverflow.com/a/13800457/87698)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T13:58:14.947

php 配置。浮点精度设置。小数位数选项。

# python - 407 Proxy Authentication Required

> ID：15203211
> 
> 赞同：2
> 
> 时间：2013-03-04T13:56:35.877
> 
> 标签：python, django, windows

I'm trying to use django-social-auth in my django app. While everything is ok on my mac, I got 407 Proxy Authentication Required when I'm trying to use same code on windows machine.

```
 <urlopen error Tunnel connection failed: 407 Proxy Authentication Required ( Forefront 

TMG requires authorization to fulfill the request. Access to the Web Proxy filter is denied.  )> 
```

Any help will be greatly appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:24:09.397

```
Forefront TMG requires authorization to fulfill the request 
```

看起来您的机器已配置（必需？）通过代理服务器（在本例中为 Microsoft 的 TMG）路由出站流量。当用户尝试使用您的应用程序进行身份验证时，Django 正在尝试连接到另一个服务以验证它们，但由于代理配置，它无法访问该服务。

由于调用的代码`urlopen`可能在 django-social-auth 中，您可能不想直接修改它以使用代理。您可以尝试设置`http_proxy`环境变量（有关详细信息，请参阅[此答案](https://stackoverflow.com/a/3942980/70605)）以使*所有*urllib 请求都通过代理），或为您的 Web 服务器禁用代理身份验证。

# android - 我正在使用 Zync 909 平板电脑，我无法连接到电脑来运行我自己的 android 程序

> ID：15203213
> 
> 赞同：0
> 
> 时间：2013-03-04T13:56:41.323
> 
> 标签：android, tablet

我正在开发安卓应用程序。在 Eclipse 中，我需要直接在我的平板电脑上运行我的程序。当我将设备与 pc 连接时（只能访问我 sd 卡的数据）找不到要运行的设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:01:40.547

尝试以下操作：-

*   在平板电脑中启用 USB 调试（设置 --> 安全 --> 开发人员选项 --> 启用 USB 调试）。

*   如果仍然不起作用，请尝试在 Eclipse 中重置 adb（DDMS 透视图 --> 设备选项卡 --> 右侧的小三角形（最后一个选项） --> 重置 adb）。

# machine-learning - liblinear one vs rest learn parameters

> ID：15203218
> 
> 赞同：0
> 
> 时间：2013-03-04T13:56:51.717
> 
> 标签：machine-learning, computer-vision, svm, libsvm

Liblinear ([http://www.csie.ntu.edu.tw/~cjlin/liblinear/](http://www.csie.ntu.edu.tw/~cjlin/liblinear/)) does not support for probability estimates.

Say I have three classes C1, C2 and C3. I want to learn the model paramters for each 'one vs rest' cases:

```
 C1 vs C2&C3, 
           c2 vs C1&C3 and
           C3 vs C1&C2 
```

How can I do it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T07:53:42.617

在 lr 中，对于 -b 1 参数，它实际上并没有给出 p(c1) 值。它给

```
P(c1)=p(c1)/(p(c1)+p(c2)+p(c3)) 
```

在输出文件中。因此，当您只有 1 个类时，它会输出 1。

# c# - lambda 表达式中的条件 order by

> ID：15203220
> 
> 赞同：3
> 
> 时间：2013-03-04T13:56:56.410
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq

我有 2 个 Lists 返回相同的 Item 。 `<foo>`第`orderType`一个列表为 0，第二个列表为 1 在第一个列表中我进行过滤，我必须将第二个列表中的项目添加到受分页限制的结果中。基本上这是我的最终查询：

```
var listFoo= QueryList1.Concat(QueryList2);  //(IQueriable)
List<foo> listFoo =listFoo.OrderByDescending(r => r.ID)
                          .ThenBy(d =>d.orderType)
                          .Skip((currentPageIndex - 1) * pageSize)
                          .Take(pageSize)
                          .ToList(); 
```

这很好用，因为列表 1 用作主要项目，列表 2 用作第一个列表的详细信息。此外，我的过滤器应该只适用于第一个列表。但是问题来了。如何**仅**按日期订购第二个列表。我需要列出按日期排序的详细信息。基本上我需要类似的东西：

```
List<foo> listFoo =listFoo.OrderByDescending(r => r.ID)
                          .ThenBy(d =>d.orderType)
                          .ThenBy(x=>(x.ordertype==1)?x.Date)
                          .Skip((currentPageIndex - 1) * pageSize)
                          .Take(pageSize)
                          .ToList(); 
```

编辑 ：

```
List 1 : 
id =1,ordertype=0,Date = new DateTime(1950,1,4),  [0]
id =2,ordertype=0,Date = new DateTime(1950,2,1)   [1]
List 2 :
id =1,ordertype=1,Date = new DateTime(1950,1,5),  [2]
id =1,ordertype=1,Date = new DateTime(1950,1,2),  [3]
id =1,ordertype=1,Date = new DateTime(1950,1,3),  [4]
id =1,ordertype=1,Date = new DateTime(1950,1,4)   [5]

This should be ordered as follows : 
[0],[3],[4],[5],[2],[1] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T14:00:21.863

看起来您缺少三元运算符的最后一部分：

```
listFoo = listFoo.OrderByDescending(r => r.ID)
                           .ThenBy(d =>d.orderType)
                           .ThenBy(x => (x.ordertype==1) ? x.Date : DateTime.MinValue)
                           .Skip((currentPageIndex - 1) * pageSize)
                           .Take(pageSize)
                           .ToList(); 
```

如果您不关心订单 if`ordertype`不是 1 ，那么`else`条件是任意的。

# buddypress - Adding the Favorite/Like button post in buddypress so users can like content

> ID：15203221
> 
> 赞同：-1
> 
> 时间：2013-03-04T13:56:59.117
> 
> 标签：buddypress

How to add the Favorite/Like button post in buddypress so users can like content.

I search and tried manything.. Please help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T13:33:05.643

对于“喜欢”，我使用旧插件“BuddyPress Like” [http://wordpress.org/extend/plugins/buddypress-like/](http://wordpress.org/extend/plugins/buddypress-like/)

# python - Write list items to a text file in Python

> ID：15203225
> 
> 赞同：1
> 
> 时间：2013-03-04T13:57:13.710
> 
> 标签：python, list, output

I have a - probably - trivial question that's been bugging me for some time and I still haven't found an answer. Many of my scripts read some files, compare values from them and save these in a list or dictionary from which I then write an output file of some sort. What I always do is, I loop over the list and write the single items to my output, separated by a tab, comma, or line break. What I am always wondering is how I can prevent a separator appearing after the last item on my list has been printed.

Here is an example:

```
dict1 = {a: [1,2,3], b: [4,5,6], c: [7,8,9]}
for key in dict1:
    outfile.write(key +": ")
    for item in dict1[key]:
        outfile.write(str(item) +", ")
    outfile.write("\n") 
```

The output would then look like this:

```
a: 1, 2, 3, 
b: 4, 5, 6, 
c: 7, 8, 9, 
```

How do I avoid that last ", "?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T13:59:48.027

使用`str.join`方法和列表理解：

```
for key, value in dict1.iteritems():
    outfile.write(key +": ")
    outfile.write(', '.join([str(item) for item in value]))
    outfile.write("\n") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:02:44.030

使用标准库[CSV](http://docs.python.org/2/library/csv.html)模块怎么样？

它会处理这个问题，加上任何必要的转义符（如果您的值之一包含逗号怎么办？）

（然后，当然，作为一般情况，使用`string.join(list)`正确连接没有尾随分隔符）

# html - Vertical Align of text using css

> ID：15203230
> 
> 赞同：2
> 
> 时间：2013-03-04T13:57:44.520
> 
> 标签：html, css

I am trying to get this:

![http://img16.imageshack.us/img16/2198/screenshot20130304at146.png](../Images/d245ff2b64d686075fb831be4944d7f6.png)

But after 2 hours I have this:

![http://imageshack.us/photo/my-images/138/screenshot20130304at152.png](../Images/5ed25408286d098b28f8b065a743089c.png)

The problem is I have no idea of how align the text on the button without using javascript, only with css. There is anyway to do this without Javascript? This is my code:

```
<div class='chart_button'>
    <div>Pain Relief</div>
</div>
<div class='chart_button'>
   <div>Pain relief by attack</div>
</div> 
```

and here is the css:

```
.button_set .chart_button{
    display: inline-table;
    height: 50px;
    width: 110px;
    background: url('../img/button-chart.png');
    font-size: 14px;
    font-weight: bold;
    color: #717171;
    text-align: center;
    margin-right: 1px;
    cursor: pointer;
    vertical-align: bottom;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T14:01:14.563

添加这个CSS：

```
.chart_button>div {
    display:table-cell;
    vertical-align:middle;
} 
```

# linux - How to replace a string in a filename

> ID：15203235
> 
> 赞同：-1
> 
> 时间：2013-03-04T13:57:58.130
> 
> 标签：linux, bash, shell

I'm trying to replace a string in a filename:

Original filename:

```
gamename games.com.zip 
```

Target filename:

```
gamename.zip 
```

I'm trying to replace the string `games.com` with an empty string. `gamename` is not a constant string it can be anything, but `games.com` is a constant string.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:29:29.067

我会用

```
mv "$filename" "${filename/ games.com/}" 
```

这记录在“Bash”手册页中的“模式替换”下

或[http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)在线

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:30:36.063

Bash 参数扩展将有助于：

```
mv "$f" "${f/ games.com}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:13:02.067

尝试以下[`rename`](http://linux.die.net/man/1/rename)命令：

```
$ filename="gamename games.com.zip"
$ rename " games.com" "" "$filename" 
```

由于您的 zip 文件的名称有一个空格，因此您需要确保将其括在双引号中。

# jquery - 我如何单击 Jquery .Load 事件以更改活动选项卡

> ID：15203251
> 
> 赞同：1
> 
> 时间：2013-03-04T13:58:52.413
> 
> 标签：jquery, tabs

我正在尝试设置一种方式，以便在单击某些内容时可以加载特定的选项卡。这是运行良好的代码，但它没有加载特定的选项卡，它加载到选项卡中，但不会使其“活动”

我将如何选择使“$tabs-1”处于活动状态？

```
<script type="text/javascript">
$('#leftlist ').click(function() { 
var url = $(this).attr('href'); 
$('#tabs-1').load(url);
return false;
});
</script> 
```

# javascript - 更改 Texbox 颜色

> ID：15203255
> 
> 赞同：0
> 
> 时间：2013-03-04T13:59:06.313
> 
> 标签：javascript, asp.net, textbox

我正在使用 ASP.NET。我想`forecolor`在运行时使用 java 脚本或任何其他客户端脚本更改和调整大小。

我不想使用服务器方法，因为它会导致完整的回发。

我在做什么。我正在创建一个简单的图像。在那张图片上，我在写任何文字`textbox`。

现在我想在运行时设置文本颜色及其大小。目前它是硬编码的。

所以我正在寻找`textbox`使用任何客户端脚本在运行时更改文本颜色和大小。

更改样式属性`textbox`不起作用。我能够设置文本颜色，但无法使用`TextBox1.ForeColor`属性访问它。

请帮帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:06:51.987

查看生成的html并根据javascript编写：

```
document.getElementById('txtbox').style.color = 'red'; 
```

和尺寸：

```
var txtbox = document.getElementById('txtbox')
txtbox.style.width = '10px';
txtbox.style.height = '20px'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:08:09.387

试试这个（使用 jQuery）：

```
$("#textboxID").css('background','Red')
$("#textboxID").css('font-size','25px') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:05:24.707

您正在客户端更改颜色，并希望在服务器端访问更改后的值。TextBox 在回发后不会记住这种更改。您应该将更改后的颜色单独传递给服务器，可能在隐藏的输入中。

# php - PHP 5.3.18 Mcrypt 错误：无法开源设备

> ID：15203256
> 
> 赞同：0
> 
> 时间：2013-03-04T13:59:09.057
> 
> 标签：php, linux, encryption, laravel, mcrypt

我的虚拟主机上的 Mcrypt 库出现错误。我正在使用 Laravel 4 框架（目前处于测试阶段）。它给出了以下错误：

```
ErrorException: Warning: mcrypt_create_iv() [function.mcrypt-create-iv]: Cannot open source device in foo/bar line # 
```

一些托管规格：

*   共享主机
*   PHP 5.3.18
*   Linux
*   Mcrypt 2.5.8

正在发生的事情是框架中的某个地方 mcrypt_create_iv() 被调用。它通过了应该在 Linux 和 PHP >= 5.3.0 上工作的 MCRYPT_DEV_URANDOM 全局

但由于某种原因，它仍然给出了这个 ErrorException。如果我对函数进行硬编码以使用 MCRYPT_RAND 代替它可以工作，但我觉得奇怪的是为什么它会在另一个全局上给出错误，而这应该在这些规范上工作。

我能想到的只是某些文件夹混淆了，或者 /dev/urandom 有问题。我不熟悉这些类型的加密，所以我希望有人能给我一些关于如何修复它的建议。

[http://en.wikipedia.org/wiki//dev/random](http://en.wikipedia.org/wiki//dev/random)

**更新**

有人建议我的网站无权访问加密文件夹。这可能是问题所在。我正在联系我的虚拟主机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:04:36.833

我的第一个猜测是您的网站无法从网站的文档根目录中访问该文件夹。如果这是在共享主机上，他们可能会阻止它。我建议打电话给他们并了解一下。

因为 /dev/random 是机器根目录上的文件，所以大多数共享主机提供商不允许访问此级别的文件夹。

# java - 如何将 Modellica 代码转换为本体（.owl）？

> ID：15203258
> 
> 赞同：1
> 
> 时间：2013-03-04T13:59:14.683
> 
> 标签：java, binary-tree, semantic-web, owl, dymola

我从事机电一体化项目，我使用 dymola 工具为我的模型生成 modelica 代码。现在我想将 modellica 转换为 .owl 以实现元素的语义搜索。我使用 protege 手动生成本体，但它很耗时。我需要设计一个自动为我做这件事的工具。该工具可以用 Java 编程，但问题是如何使工具理解 d modellica 代码的语义（不仅仅是句法结构）？如果语法解析是答案，怎么做？或者除了使用解析器之外还有其他方法吗？sum1可以帮帮我！...如果你能给我推荐一些可以通读的书，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:08:35.977

[OWL-API](http://owlapi.sourceforge.net/)是一个与 OWL 一起工作的可靠 Java 库。它是 Protege 背后的引擎，因此您可能想从那里开始寻找。你也可以试试[Brain](http://loopasam.github.com/Brain/)，它目前只支持[OWL2 EL](http://www.w3.org/TR/owl2-profiles/#OWL_2_EL) 配置文件。

# html - 为什么 wordpress 在谷歌上有令人印象深刻的 SEO 结果

> ID：15203261
> 
> 赞同：2
> 
> 时间：2013-03-04T13:59:28.667
> 
> 标签：html, wordpress, seo

我将网站设计为大多数 SEO 规则，例如重要标签（h1、h2、文章、强...）、schema.org、html5、元键、描述等。

当我通过 SEO 的廉价规则设计一个具有相同内容的 wordpress 网站时，wordpress 在谷歌搜索中取得了令人印象深刻的结果。但我的常规网站有一周的结果。

然后我认为wordpress在后端或主要结构中有一些作弊。

发生什么事了？？

# c# - 使用javascript取消asp.net中的服务器端提交功能

> ID：15203262
> 
> 赞同：2
> 
> 时间：2013-03-04T13:59:32.213
> 
> 标签：c#, javascript, asp.net

我之前也提出过这个问题，但问题仍然存在：

我有这个代码：

```
<asp:Button ID="CrearCuenta" UseSubmitBehavior="false" OnClientClick="return validate()" runat="server" Text="Ready" /> 
```

javascript代码：

```
function validate()
{
return false;
} 
```

但是如果它返回true，**我如何执行de服务器端onclick函数？**那是我想不通的。我知道之前已经发布过类似的问题，但没有人回答上面的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:07:16.503

我希望，这是您需要的：

```
<asp:Button ID="CrearCuenta" UseSubmitBehavior="false" 
OnClientClick="return validate()" OnClick="CrearCuenta_Click" 
runat="server" Text="Ready" /> 
```

Javascript：

```
function validate()
{
    if()
        return false;  //if validation fails
    else
        return true;
} 
```

服务器端：

```
protected void CrearCuenta_Click(object sender, EventArgs e)
{
    //Put server side processing here
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T14:01:28.747

您是否添加了服务器端事件处理程序？

在您的页面代码中：

```
<asp:Button ID="CrearCuenta" OnClick="btn_Click".... 
```

在您的代码隐藏中：

```
protected void btn_Click(object sender, EventArgs e)
{
    ....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:02:17.090

检查此代码

```
document.getElementById('YourFrom').onsubmit = function() {
    return false;
} 
```

# sql - 计算那些天在数据库中的条目范围内的工作日数

> ID：15203264
> 
> 赞同：0
> 
> 时间：2013-03-04T13:59:41.227
> 
> 标签：sql, oracle

我有一个带有日期字段的表格，每天都会有多个条目。我需要计算在该工作日至少有一个条目的工作日数。

如果日期范围是 12 年 2 月 27 日到 2012 年 4 月 2 日，则有 26 个工作日，如果我们在所有工作日都有条目，则需要返回 26，如果在特定日期没有条目，则需要返回较小的计数。

用, ,说一个表**事务**。`tid``type``createddate`

有人可以建议我一个好的 SQL 方法吗？我在 Oracle DB 上运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:37:28.037

```
select to_date('02-04-2012','DD-MM-YYYY')-
to_date('27-02-2012','DD-MM-YYYY')- 
2*(to_char(to_date('02-04-2012','DD-MM-YYYY'),'WW')-
to_char(to_date('27-02-2012','DD-MM-YYYY'),'WW'))+1 from dual; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:35:47.687

我对这个问题的解释有点不同。@Pradeep，这就是你想要的吗？

```
SELECT COUNT(DISTINCT TRUNC(CreatedDate))
FROM Transaction
WHERE TRUNC(CreatedDate) BETWEEN DATE '2012-02-27' AND DATE '2012-04-02'
  AND TO_CHAR(CreatedDate, 'DY') NOT IN ('SAT', 'SUN') 
```

如果您在 2012 年 2 月 27 日和 2012 年 4 月 2 日之间的所有星期一至星期五都有条目，则此查询的结果将为 26。任何一天有多少条目都没有关系，只要每天至少有一个。

如果您在两天内（例如 2/28 和 3/22）没有任何记录，则结果将为 24。

请注意，如果您的列包含时间组件，我`TRUNC`在上面的第一行和第三行中使用了。`CreatedDate`如果没有，您可以不使用 TRUNC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:25:18.783

尝试将问题分解为多个较小的问题。方法如下..（在您的示例中，我使用的是 3 月 10 日而不是 4 月 2 日，以保持数据集更小）。

获取两个日期之间的所有日期。

```
select to_date('27-feb-2012','dd-mon-yyyy') + level -1
from dual
connect by level < ( to_date('10-mar-12','dd-mon-yy') -
                     to_date('27-feb-2012','dd-mon-yyyy') +2
                   )
TO_DATE('
---------
27-FEB-12
28-FEB-12
29-FEB-12
01-MAR-12
02-MAR-12
03-MAR-12
04-MAR-12
05-MAR-12
06-MAR-12
07-MAR-12
08-MAR-12 
```

接下来，从这个结果集中得到工作日..

```
with all_days as (
        select to_date('27-feb-2012','dd-mon-yyyy') + level -1 date1
        from dual
        connect by level < ( to_date('10-mar-12','dd-mon-yy') -
                             to_date('27-feb-2012','dd-mon-yyyy') +2
                           )
)
select  date1,
        to_char(date1,'D'),
        to_char(date1,'Day') Day
from    all_days
where   to_number(to_char(date1,'D')) between 2 and 6 -- monday through friday
/

DATE1     T DAY
--------- - ---------
27-FEB-12 2 Monday
28-FEB-12 3 Tuesday
29-FEB-12 4 Wednesday
01-MAR-12 5 Thursday
02-MAR-12 6 Friday
05-MAR-12 2 Monday
06-MAR-12 3 Tuesday
07-MAR-12 4 Wednesday
08-MAR-12 5 Thursday
09-MAR-12 6 Friday 
```

--最后，你的存在逻辑来检查你的表中是否有这个日期的任何数据。

```
with all_days as (
        select to_date('27-feb-2012','dd-mon-yyyy') + level -1 date1
        from dual
        connect by level < ( to_date('10-mar-12','dd-mon-yy') -
                             to_date('27-feb-2012','dd-mon-yyyy') +2
                           )
)
select  date1,
        to_char(date1,'D'),
        to_char(date1,'Day') Day
from    all_days
where   to_number(to_char(date1,'D')) between 2 and 6 -- monday through friday
  and   exists (
            select 1
            from your_table yt
            where yt.date_column = all_days.date_column
        ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T15:03:27.413

您在 2013 年的日期之间总共有 25 个工作日 - 我使用的是当年。使用我的假设数据，您将获得 17 个总工作日的条目。要查看所有天的评论 SUM() 部分并取消注释 Start_Date... 和其他列。然后您可以目视计数以检查结果：

```
SELECT SUM(CASE WHEN Entry_Val > 0 THEN 1 ELSE 0 END) entry_days  --, Start_Date, Wk_Day, Day#, entry_val, lvl
  FROM
  (
   SELECT TO_CHAR(TO_DATE('27-FEB-12') + LEVEL-1, 'DD-MON-YYYY')   Start_Date
        , TO_CHAR(TO_DATE('27-FEB-12') + LEVEL-1, 'DY')            Wk_Day
        , TO_CHAR(TO_DATE('27-FEB-12') + LEVEL-1, 'D' )            Day#
        , MOD(LEVEL, 3)                                            Entry_Val -- Hypot. entry day - count only days with entry_val > 0 -- 
        , LEVEL                                                    lvl  -- added for clarity
     FROM dual CONNECT BY LEVEL <= (SELECT to_date('02-APR-12') - to_date('27-FEB-12') days_btwn FROM dual)
  )
  WHERE Wk_Day NOT IN ('SAT', 'SUN') -- OR -- Day# NOT IN (1, 7)
  /

ENTRY_DAYS
--------
17 
```

# c++ - 初始化结构的私有成员

> ID：15203268
> 
> 赞同：3
> 
> 时间：2013-03-04T13:59:58.947
> 
> 标签：c++, constructor, struct

现在我有

```
Private:
Struct PageManagerData
{
   char name[20];
   IPage* storePagePtr;
} 
```

我想将 name 初始化为类似`'\0'`并将 storePagePtr 初始化为`NULL`但现在我无法在构造函数中访问这些值来初始化它们。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T14:02:21.470

您的代码看起来不像有效的 C++

```
struct PageManagerData
{
   PageManagerData() : name { 0 }, storePagePtr(nullptr) { }
private:
   char name[20];
   IPage* storePagePtr;
}; 
```

这仍然不是典型的 C++：

```
struct PageManagerData
{
private:
   std::string name;
   std::unique_ptr<IPage> storePage;
}; 
```

这避免了大量潜在的内存管理/初始化/缓冲区溢出错误。具体来说，它利用了[零规则](http://flamingdangerzone.com/cxx11/2012/08/15/rule-of-zero.html)：您无需实现特殊成员即可

*   （移动）构造函数
*   （移动）分配
*   析构函数

并享受健壮的对象值语义，没有泄漏和 UB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:01:19.843

实现您提到的初始化结构的构造函数。

# java - 无法创建 epoll 实例。错误号=24

> ID：15203271
> 
> 赞同：3
> 
> 时间：2013-03-04T14:00:16.697
> 
> 标签：java, android, runtime-error

这个运行时错误是什么意思？

我已经用谷歌搜索过了，有人说它属于计时器，有人说它是套接字错误，还有人说它属于图片。我有套接字和计时器（很多计时器），但我不知道是哪一个导致了它。有时它可以工作一个多小时，有时只工作 5 分钟。有任何想法吗？

对这个错误的基本印象就足够了。如果我发布所有可能发生的代码，则此页面将长达数公里（当然有点极端，但代码很多。）

现在发现，它可能属于`too many open files`但我没有在我的应用程序中使用任何外部文件。

似乎是内存泄漏，属于这部分：

```
public static Runnable connection() throws IOException {
    Log.e("Communication", "connection");

    new Thread(new Runnable() {
        public void run() {
            Looper.prepare();
            try {
                serv = new ServerSocket(port);                                                                      sock = serv.accept();
                reader();                                                                               } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }).start();
    return null; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T08:59:54.050

删除上面的部分代码后，一切正常。删除了`looper.prepare()`，我的应用程序不再死了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T18:49:25.810

```
public static void sendJsonList(final List<String> jsonStrlist,
        final String resturl) {
    Thread t = new Thread() {
        public void run() {
            Looper.prepare();
            /* Your HTTP clients code */
            try {
                for (String jsonStr : jsonStrlist) {
                    /* Loop logic */
                    response = client.execute(post);
                    if (response != null) {
                        /*reponse handler logic */
                    }
                }

            } catch (Exception e) {
                e.printStackTrace();
            }

            Looper.loop();
        }
    };

    t.start();
} 
```

# javascript - 在three.js中解析json几何数据

> ID：15203285
> 
> 赞同：1
> 
> 时间：2013-03-04T14:01:04.770
> 
> 标签：javascript, three.js

我使用 three.js 导出器从 Blender 导出了一个模型，并设法使用 JSONLoader 正确加载它。但是我现在需要将 JSON 信息存储在一个变量中并对其进行解析以显示模型，而无需加载外部文件。

根据文档，我可以使用 GeometryLoader ( [http://mrdoob.github.com/three.js/docs/56/#Reference/Loaders/GeometryLoader](http://mrdoob.github.com/three.js/docs/56/#Reference/Loaders/GeometryLoader) ) 中的解析函数来完成它，但我检查了 github 上的源代码并看到它不存在。我不确定文档是否已过时或作为未来实施的指南，并且找不到有关如何进行此解析的更多信息。有人知道吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:17:01.870

在 JSONLoader 中，您拥有`createModel`应该执行所需操作的方法：`loadAjaxJSON`当 Ajax 请求检索到 JSON 数据字符串时调用此方法。

该`createModel`方法具有以下签名：

```
createModel  = function ( json, callback, texturePath ) 
```

# c# - .NET 的秒表类，行为奇怪

> ID：15203286
> 
> 赞同：3
> 
> 时间：2013-03-04T14:01:07.103
> 
> 标签：c#, stopwatch, insertion-sort

所以，我有所有的搜索算法，我向每个算法发送随机的 20000 个数字，试图弄清楚每个算法需要多长时间。

```
 public void functionsForSorts(int[] array)
    {
        Stopwatch sw = new Stopwatch();
        long elapsedTime = sw.ElapsedTicks;

        if (array.Length == 20000) 
        {
            sw.Start();
            BubbleSort.Bubble(array);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label1.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();

            sw.Restart();
            SelectionSort.Selection(array);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label2.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();

            sw.Restart();
            InsertionSort.Insertion(array);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label3.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();

            sw.Restart();
            MergeSort.mergeSort(array, 0, array.Length - 1);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label4.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();

            sw.Restart();
            ShellSort.Shell(array);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label5.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();

            sw.Restart();
            QuickSort.Quicksort(array, 0, array.Length - 1);
            sw.Stop();
            elapsedTime = sw.ElapsedMilliseconds;
            label6.Text += "\t" + elapsedTime.ToString() + " miliseconds ";
            Application.DoEvents();
        } 
```

问题是秒表不会给出正确的结果，它适用于冒泡排序、选择排序和合并排序，但我不知道为什么，它总是为插入排序写入 0，即使它在调试时具有正确的值。并且它也没有为 shell 排序和快速排序提供正确的值。

另一个尴尬的部分是，当我注释掉气泡和选择排序时，插入会给出正确的结果，这对所有算法都是如此，如果我按顺序将它们设为第一个，我会得到正确的结果，我把这个展示给我的朋友，他们也没有任何线索，这真的没有任何意义......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:04:24.407

> 这是不可能的

是什么让你断定这是不可能的？请记住，即使`Stopwatch`精度有限。`0`并不意味着“根本不需要时间”；它可能意味着“没有足够的时间以可用的精度进行注册”。为了在快速的事情上获得合理的计时，您通常需要在计时区域内的循环中执行多次（意味着：数千甚至数百万次）。没有看到什么`Insertion`，据我们所知，这很好。

就个人而言，我会使用：

```
sw = Stopwatch.StartNew();
// probably loop here!!
i5k.Insertion(array);
sw.Stop(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T14:21:12.023

如果数组已经排序，则您的插入排序可能无事可做，并且在不到 1 毫秒的时间内完成。如果您之前的排序使数组排序，这可能是可能的。

（*编辑*- 我显然很难输入“可能”而不是“可能”这个词......更正。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T14:09:37.073

```
 elapsedTime = sw.ElapsedMilliseconds; 
```

一毫秒是很长的时间，现代处理器可以在一毫秒内执行数百万条指令。足以让您在不到一毫秒的时间内完成插入排序，因此 ElapsedMilliseconds 返回 0。避免丢弃您从 Stopwatch 获得的分辨率，请改用其 Elapsed 属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T14:12:07.277

不要使用 Stopwatch.ElapsedMilliseconds，如果操作时间少于 1 毫秒，它将返回 0。

请改用 Stopwatch.ElapsedTicks。并按照马克上面所说的去做。

# android - 从线程中获取字符串值

> ID：15203289
> 
> 赞同：0
> 
> 时间：2013-03-04T14:01:26.573
> 
> 标签：android

有人可以告诉我，如何从线程获取一个 Stringvalue 到 mainActivity？

我有一个这样的线程：

```
public class XMLHandler extends DefaultHandler {

XMLDataCollected data = new XMLDataCollected();

    ......
    ......

public String getInformation() {

    String information = "";

        if (data.getData().equals("residential")) {
            information = "Stadt";
        }           
        return information;
}   

} 
```

在 mainActivity 我尝试将值设置为这样的文本视图：

```
textView.setText(xmlHandler.getInformation()); 
```

毕竟我不工作。我做错了什么？任何解决方案和建议？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:18:36.367

如果你有一个separatethread 类，那么你需要创建一个接口说

```
public interface FetchValueListener{

public void sendValue(String value_to_send);

} 
```

您的活动将实现此接口，因此 sendValue(value_to_send) 方法将添加到您的活动中。

下一步是当您创建 THread 类的对象时，您需要在参数中传递该接口的对象，如下所示：

```
 public class myThreadClass{
    FetchValueListener mllistener;

    myThreadClass(FetchValueListener listenerObj){
         mllistener=listenerObj;
    }

    } 
```

现在，当您想从线程向活动发送一些值时，您只需调用

`mllistener.sendValue(value_you_wan_to_send);`

在您的活动中，您将获得 sendValue() 方法中的值..

在该方法中，您需要使用处理程序将数据发布到可运行状态，以便您可以对 UI 进行更改，例如**setText**等.....如果您直接尝试在该方法中设置文本视图的值，您将收到异常.

# javascript - JQueryMobile 打开手机图库并选择一张图片

> ID：15203292
> 
> 赞同：0
> 
> 时间：2013-03-04T14:01:34.783
> 
> 标签：javascript, jquery, jquery-mobile

是否可以打开手机的本地图库（iOs、Android、Windows Phone 等...）并使用 jQueryMobile 选择图像？如果怎么做？

用于响应的 Tnk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:47:42.873

我已经解决了 HTML5 表单的问题，因为 javascript 不可能加入文件系统。

# javascript - 如何根据另一个日期选择器设置日期选择器 maxDate？

> ID：15203295
> 
> 赞同：3
> 
> 时间：2013-03-04T14:01:41.660
> 
> 标签：javascript, jquery-ui, jquery-ui-datepicker

我已经声明了一个日期选择器：

```
define(["ui/nal.ui.core"], function () {
    $.widget("nal.datePi", {
        options: {
            numberOfMonths: 2
        },
        _create: function () {
            var $el = this.element;
            $el.datepicker(this.options);
        }
    });
}); 
```

其中有2个儿子：

```
define(["ui/nal.ui.datePi","ui/nal.ui.textFieldDateDeparture"], function() {
    $.widget( "lan.datePiDeparture", $.lan.datePi, {
    });
});
define(["ui/nal.ui.datePi","ui/nal.ui.textFieldDateArrival"], function() {
    $.widget( "lan.datePiArrival", $.lan.datePI, {
    });
}); 
```

我如何设置`maxDate`为`Arrival`1 年，具体取决于`Departure.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-03T15:24:27.647

像这样更简单的工作：（只是伪代码）

```
var depDate = $(".divToDate").datepicker('getDate');
depDate.setDate(depDate.getYear() + 1);

(".arrivalDiv").datepicker({
    maxdate: depDate; 
```

基本上，您获取与您的到达日期日期选择器相关的日期并添加一年并将 maxDate 设置为该新值。您可能必须 getDate 然后使用 .addYear()

# xcode - 我如何知道 2 个 NSStrings 是否彼此几乎相同？

> ID：15203301
> 
> 赞同：1
> 
> 时间：2013-03-04T14:01:55.993
> 
> 标签：xcode, nsstring, compare

我从用户那里获取了一个字符串，并对其进行了一些迭代。

例如用户输入文字@“今天天气真好。”；

`"the wether is beatifullll tdy"`当用户输入or`"th weather is beatttiful tooodayy"`或时，我想进行相同的迭代`"the weatherrr iss beautiful toda"`。

这是我的代码：

```
// (str is the user's text)

if ([str rangeOfString:@"hello" options:NSCaseInsensitiveSearch].location != NSNotFound) {
// when user entered helloo I want make to same iteration,
// but in this case the program goes else part.        
    [array insertObject:@"hello" atIndex:s];
} else if ([str rangeOfString:@"You are so beautiful" options:NSCaseInsensitiveSearch].location != NSNotFound ) {
    [dizi insertObject:@"I know, Thanks" atIndex:s];
} else if ([str rangeOfString:@"Have Lunch?" options:NSCaseInsensitiveSearch].location != NSNotFound) {
    [array insertObject:@"Yes,I have" atIndex:s];
} else {
    [array insertObject:@"please,speak english" atIndex:s];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T07:01:03.523

您可以使用 StringScore 进行模糊匹配：

> [https://github.com/thetron/StringScore](https://github.com/thetron/StringScore)

例子：

```
NSString *testString = @"Hello world!";

CGFloat result1 = [testString scoreAgainst:@"Hello world!"];
CGFloat result2 = [testString scoreAgainst:@"world"];
CGFloat result3 = [testString scoreAgainst:@"wXrld" fuzziness:[NSNumber numberWithFloat:0.8]];
CGFloat result4 = [testString scoreAgainst:@"world" fuzziness:nil options:NSStringScoreOptionFavorSmallerWords];
CGFloat result5 = [testString scoreAgainst:@"world" fuzziness:nil options:(NSStringScoreOptionFavorSmallerWords & NSStringScoreOptionReducedLongStringPenalty)];
CGFloat result6 = [testString scoreAgainst:@"HW"]; // abbreviation matching example

NSLog(@"Result 1 = %f", result1);
NSLog(@"Result 2 = %f", result2);
NSLog(@"Result 3 = %f", result3);
NSLog(@"Result 4 = %f", result4);
NSLog(@"Result 5 = %f", result5);
NSLog(@"Result 6 = %f", result6); 
```

输出：

```
Result 1 = 1.000000
Result 2 = 0.425000
Result 3 = 0.271528
Result 4 = 0.250000
Result 5 = 0.425000
Result 6 = 0.645833 
```

# android - 在 Android 中反序列化 Json

> ID：15203305
> 
> 赞同：1
> 
> 时间：2013-03-04T14:02:05.953
> 
> 标签：android, json, rest, gson, flexjson

在我的后端，我有一个类用户，它有多个旅行。这些旅行有多个用户。这是一个循环引用。

我在我的休息服务中使用此代码来序列化用户对象：

```
Gson gson = new Gson();
return gson.toJson(user, TripUser.class); 
```

在我的 android 应用程序中，我执行以下操作：

```
Gson gson = new Gson();
TripUser Tuser = gson.fromJson(data, TripUser.class);
return Tuser; 
```

循环引用异常怎么办？还有另一种方法可以使这项工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T10:31:52.500

您应该尝试使用 flexjson 2.1 这将解决您的问题，因为您可以选择他应该将哪些项目序列化为 Json 等。此外，该库对循环引用没有任何问题

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-04T14:26:45.230

我不完全确定，但你可以这样尝试：

```
Gson gson = new Gson();
Type type = new TypeToken<TripUser>(){}.getType();
TripUser user = (TripUser) gson.fromJson(data, type); 
```

# android - 背景图像未显示 -Android

> ID：15203306
> 
> 赞同：0
> 
> 时间：2013-03-04T14:02:06.153
> 
> 标签：android, eclipse, background-image

我编写了一个带有背景图像的着火倒计时应用程序。我将图像放置在所有可绘制文件夹中。我删除了它们，因此文件不是那么大，并且我收到了图像不再显示的投诉。我把图片放回去了，应用程序更新了，但我仍然被告知图片没有出现在某些设备上。Nexus 7 就是其中之一，而 Galaxy tab II 是我最近听说的两个。而不是我的图像，它只是一个黑色背景。

知道为什么吗？如何让图像显示在每台设备上？

我在读一些关于平板电脑、图像的东西，这可能是内存不足的事情吗？这听起来很熟悉吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:09:57.157

将您的图像集放在以下每个文件夹中

**drawable-mdpi

可绘制的 ldpi

可绘制的 hdpi

可绘制-xhdpi**

在查看 drawable-mdpi,drawable-ldpi,drawable-hdpi,drawable-xhdpi 之后。如果 Android 操作系统无法找到该图像，则最后一个查找图像的位置是**可绘制**文件夹所以尝试将图像也放入其中看看它是否有效。

# actionscript-3 - AS3 Socket ProcessEvent.SOCKET_DATA 似乎没有被触发

> ID：15203308
> 
> 赞同：1
> 
> 时间：2013-03-04T14:02:14.920
> 
> 标签：actionscript-3, sockets

我们使用 AS3 Event:ProcessEvent.SOCKET_DATA 来监听套接字数据。所以这是我的套接字数据句柄的 AS3 代码。

```
private function packetHandler( e:ProgressEvent ):void
    {
        while( m_socket.bytesAvailable && m_socket.bytesAvailable >= pLen )
        {
            //pLen means the packet length
            //pLen init is zero
            if( pLen == 0 )
            {
                //PACKET_LEN stands for the solid length of one packet
                //PACKET_LEN = HEAD_LEN + 4
                //the 4 means an unsigned int which means the packet content length
                if( m_socket.bytesAvailable > PACKET_LEN )
                {
                    m_socket.readBytes(  headByteBuffer, 0, HEAD_LEN );
                    headByteBuffer.clear();
                    pLen = m_socket.readUnsignedInt() + 4;
                }
                else
                {
                    break;
                }
            }
            //recieved a whole packet now handle it
            else
            {
                var newPacket:ByteArray = new ByteArray();

                newPacket.endian = Endian.LITTLE_ENDIAN;
                m_socket.readBytes( newPacket, 0, pLen );

                parasMsg( newPacket, pLen-4 );
                pLen = 0;
            }
        }
    } 
```

**这张图片可以描述一个完整的数据包：** ![http://wuzhiwei.net/problems/packet.gif](../Images/0d1d553a2b8a2b0b0605a3adef0cfbd1.png)

**我的问题是：当 Flash 收到一个不完整的数据包并触发句柄时。但是包的左边部分永远不会触发句柄，看起来包的左边部分已经丢失了！！！**

我用了一个抓包工具，发现tcp数据包没问题，但是为什么左边部分没有再次触发事件呢？

您可以在下面获得更多调试信息。谢谢！

**这是我的日志：**

*   byteava 表示 m_socket 的 bytesAvailable

> ==>sendPacket: {"rangeID":"1","uid":"145962","serviceType":"copyscene","cmd":"CopySceneMoveAsk","pathPoint":[{"col":7, "row":6},{"col":7,"row":5},{"col":7,"row":4},{"col":7,"row":3},{ "col":6,"row":3}],"sn":"79","smallPathPoint":[[22,19],[22,18],[22,17],[22,16] ,[22,15],[22,14],[22,13],[21,13],[21,12],[21,11],[20,11],[20,10]]} , bytesLoaded = 463
> 
> ProgressEvent 已触发！0 套接字 byteava = 373 evt 已加载：373 evt 总计：0 evt：[ProgressEvent type="socketData" bubbles=false cancelable=false eventPhase=2 bytesLoaded=373 bytesTotal=0]
> 
> 从socket中找一个包，pLen=288 socket byteava = 276
> 
> ProgressEvent 触发！288 套接字 byteava = 441 evt 加载：165 evt 总计：0 evt：[ProgressEvent type="socketData" bubbles=false cancelable=false eventPhase=2 bytesLoaded=165 bytesTotal=0]
> 
> 开始读取一个数据包到缓冲区，pLen=288 socket byteava = 441
> 
> 整个数据包内容：读取一个数据包到缓冲区，pLen=288 socket byteava = 153
> 
> 服务器数据包内容字节缓冲区 ava:288 len：288 pos: 0
> 
> 服务器参数数据：数据长度：284 数据内容：{"cmd":"CopySceneMoveNotify","gtcmd":"108","layer":"1","pathPoint":[{"col":7,"row ":6},{"col":7,"row":5},{"col":7,"row":4},{"col":7,"row":3},{"col ":6,"row":3}],"smallPathPoint":[[22,19],[22,18],[22,17],[22,16],[22,15],[22, 14],[22,13],[21,13],[21,12],[21,11],[20,11],[20,10]HTTP/1.1 200

**`_[20,10]HTTP/1.1 200_`这就是问题所在！！带有另一个数据包标头的不完整数据包 cat。**

**这是 TCP 连接的捕获：** ![http://wuzhiwei.net/problems/captured_pa​​ckets.jpg](../Images/f81a0295d3264a8e92f14b05bee57b6c.png)

希望你能**投票，**这样我就可以把这个问题的照片放上去！

我的英文不是很好，希望你能明白我的意思。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:14:19.613

Socket 的事件 flash.events.ProgressEvent.SOCKET_DATA 将在您收到数据时触发，此时您可以获得接收到的字节（检查 .bytesAvailable ）。当味精被分成多个包时，您将收到每个包的事件。在您的情况下，检查 m_socket.bytesAvailable >= pLen 时 pLen 的值可能有误。

我假设您在消息的请求中发送消息大小（在这种情况下，您可以检查是否收到了整个消息）。在这种情况下，您必须有一个类成员（ByteArray）作为保存接收到的字节的缓冲区。当新数据到来时，您必须将新字节复制到该成员，然后检查您是否收到整个消息。如果缓冲区包含整个味精而不是从中删除味精。一般来说，您的事件处理程序必须如下所示：

```
protected function onSocketData( pEvt: Event ): void
{
    try
{
       if ( 0 < pEvt.target.bytesAvailable )
       {
    var byteStream: ByteArray = new ByteArray();            
    pEvt.target.readBytes( byteStream, 0, Socket( pEvt.target ).bytesAvailable );
    // Append readed data to your buffer

    do 
    {
        //Check if you have enough bytes to read whole msg and execute it
                    //do..while because maybe it can be more than one msg in buffer

    }
    while ( null != msgContent );
    }
}
catch ( exc )
{

} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T07:13:21.230

问题应该是由数据包的可靠标头引起的。

下面是一个数据包的 93​​ 字节实心标头。

```
private static const HTTP_RESPONSE_CONTENT : String = "HTTP/1.1 200 OK \r\n"
        + "Connection: keep-alive \r\n"
        + "Content-Length: 280 \r\n"
        + "Content-Type: text/html \r\n\r\n"; 
```

此标头将位于每个数据包的标头中，AS3 可以将其视为 a`http`并可能使用`Content-Length: 280`. 所以 280 字节的左边部分永远不会触发 SOCKET_DATA 事件。

当我删除此标题时，现在可以了。

# python - 子进程未从使用鼻子运行的 Django 测试中捕获所有标准输出

> ID：15203309
> 
> 赞同：2
> 
> 时间：2013-03-04T14:02:15.137
> 
> 标签：python, django, testing, subprocess, nose

在使用 subprocess 执行测试时，如下所示：

```
subprocess.Popen(["./manage.py", "test", "-x", "--settings=settings_test"], stdout=subprocess.PIPE, stdin=subprocess.PIPE).communicate() 
```

仅捕获测试输出的初始部分。所以我得到了返回的元组

```
 ("\x1b[32mUsing database: develop\x1b[0m\n\x1b[33mRunning tests against sqlite3 in memory database\x1b[0m\nnosetests --verbosity 1 -x\nCreating test database for alias 'default'...\nDestroying test database for alias 'default'...\n", None) 
```

然而，这错过了关键的最后三行

```
Ran 260 tests in 70.131s

OK (SKIP=1) 
```

有没有办法使用子进程捕获这个输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T17:50:48.963

那是因为摘要被写入标准错误，所以你也需要抓住它。

```
sub = subprocess.Popen(
        ["./manage.py", "test", "-x", "--settings=settings_test"],
        stdout=subprocess.PIPE, stderr=subprocess.PIPE)
out, err = sub.communicate()
# err should have the summary 
```

# php - 如何在 facebook graph api 请求中使用 cURL

> ID：15203310
> 
> 赞同：5
> 
> 时间：2013-03-04T14:02:15.487
> 
> 标签：php, facebook-graph-api, curl, file-get-contents

我正在使用 file_get_contents() 将信息发送到 facebook graph api

但有时我会收到错误消息。

我发现必须使用 cURL 而不是 file_get_contents()。

问题是，我不知道如何将 cURL 与我需要传递的 URL 一起使用。

如果我转换

```
file_get_contents($graph_url); 
```

进入cURL，代码是什么？

这是 $graph_url 的内容

```
$graph_url= "https://graph.facebook.com/me/photos?"
  . "url=" . urlencode($photo_url)
  . "&message=" . urlencode('')
  . "&method=POST"
  . "&access_token=" .$access_token; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-04T14:04:57.247

```
 $graph_url= "https://graph.facebook.com/me/photos";
  $postData = "url=" . urlencode($photo_url)
  . "&message=" . urlencode('')
  . "&access_token=" .$access_token;

        $ch = curl_init();

        curl_setopt($ch, CURLOPT_URL, $graph_url);
        curl_setopt($ch, CURLOPT_HEADER, 0);
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);

        $output = curl_exec($ch);

        curl_close($ch); 
```

# php - 获取用户提交的小时-分钟时间 ===> 更改并显示

> ID：15203314
> 
> 赞同：0
> 
> 时间：2013-03-04T14:02:20.020
> 
> 标签：php, date, time

这就是我想要实现的目标：

1）用户从表单提交 roster_input（这里我只是设置一个变量作为示例输入）

2）php将其更改为时间戳并减去7500秒

3）php显示新时间，但在不同的时区

显然我做错了。但这是我第一次处理约会！

```
$roster_input='14:15' ;
$timestamp = strtotime($roster_input) - 7500;

$date = new DateTime($timestamp, new DateTimeZone('Pacific/Nauru'));
echo $date; 
```

也试过了，没有成功：

```
$date = DateTime::createFromFormat('H:i', $timestamp, new DateTimeZone('Pacific/Nauru')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:40:28.253

根据 PHP 手册

```
$date = new DateTime(null, new DateTimeZone('Pacific/Nauru'));
echo $date->format('Y-m-d H:i:sP') . "\n"; 
```

因此，您将使用有效的日期字符串：

## 这行得通。返回 12:10

```
$roster_input='14:15' ;

$timestamp = strtotime($roster_input)  - 7500;

$format =  date("H:i", $timestamp );

$date = new DateTime($format, new DateTimeZone('Pacific/Nauru'));
    echo $date->format('H:i') . "\n"; //Note how you echo the result 
```

## 失败（在您的情况下直接使用时间戳）；

```
$roster_input='14:15' ;

$timestamp = strtotime($roster_input)  - 7500;

$date = new DateTime($timestamp , new DateTimeZone('Pacific/Nauru'));
    echo $date->format('H:i') . "\n"; 
```

> 致命错误：未捕获的异常“异常”，带有消息“DateTime::_ *construct() [datetime.--construct]：无法在 writecodeonline.com/php 中的位置 8 (0) 解析时间字符串 (1362417000)：意外字符” :7 堆栈跟踪：#0 writecodeonline.com/php(7): DateTime->* _construct('1362417000', Object(DateTimeZone)) #1 {main} 在第 7 行抛出

## 要直接使用时间戳，这可行：返回 17:10

```
$roster_input='14:15' ;

$timestamp = strtotime($roster_input)  - 7500;

$date = new DateTime('@'.$timestamp , new DateTimeZone('Pacific/Nauru')); //Notice '@'.
    echo $date->format('H:i') . "\n"; 
```

哪个适合您的目标结果。请注意不同的结果阅读更多：[http ://www.php.net/manual/en/datetime.construct.php](http://www.php.net/manual/en/datetime.construct.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:05:44.560

你似乎走在正确的轨道上。唯一的问题是您不能将对象作为字符串转储。

尝试将最后一行更改为：

```
echo $date->format("c"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:52:25.090

或者对您的原件进行 3 个字符的更改：

```
$roster_input='14:15';
$timestamp = strtotime($roster_input) - 7500;
$date = new DateTime("@$timestamp", new DateTimeZone('Pacific/Nauru'));
echo $date->format(DATE_RFC822); 
```

# iptables - nfq_create_queue():资源暂时不可用

> ID：15203320
> 
> 赞同：0
> 
> 时间：2013-03-04T07:11:23.357
> 
> 标签：iptables, recv, netfilter

当我尝试在我的应用程序中创建多个 nf_queue 时出现错误“资源暂时不可用”。我找不到有关此错误的任何文档。

我正在尝试使用 NFQUEUE 实现多线程应用程序。我打开库并在主线程中绑定到 AF_INET 并尝试创建多个 NFQUEUE。它正在成功创建 5 个队列，下一个 nfq_create_queue 返回“资源暂时不可用”。

我也试过 sleep(1); 在调用 nfq_create_queue() 之间但得到了同样的错误。

全局变量：

```
struct nfq_handle *h;
int fd; 
```

主线程：

```
h = nfq_open();
nfq_unbind_pf(h, AF_INET)
nfq_bind_pf(h, AF_INET)
qh = nfq_create_queue(h,  NFQ_NUMBER_START_IPv4 + self_index, &cb_ip4, NULL);
nfq_set_mode(qh, NFQNL_COPY_PACKET, 0xffff);
nfq_set_queue_maxlen(qh, NFQ_LENGTH);
fd = nfq_fd(h);
nfnl_rcvbufsiz(nfq_nfnlh(h), NFQLENGTH * BUFSIZE); 
```

工作线程：

```
qh = nfq_create_queue(h,  NFQ_NUMBER_START_IPv4 + self_index, &cb_ip4, NULL);
nfq_set_mode(qh, NFQNL_COPY_PACKET, 0xffff)
nfq_set_queue_maxlen(qh, NFQ_LENGTH); 
```

# math - 基于相机旋转的弹丸旋转

> ID：15203321
> 
> 赞同：0
> 
> 时间：2013-03-04T14:02:42.550
> 
> 标签：math, rotation, three.js, quaternions

我一直在使用three.js 和flightcontrols.js（一个随three.js 提供的示例）制作一个小型空间模拟器演示

该演示可在以下位置查看 - [http://www.zacharycarter.com/PrivateerRedux/demo.html](http://www.zacharycarter.com/PrivateerRedux/demo.html)

控制方案非常简单 - 鼠标控制相机，您左键单击以发射弹丸。

我在如何生成射弹方面遇到了一些麻烦。目前我正在将它们的旋转设置为我的相机的相同旋转，我认为这是导致我的问题的原因。

您会注意到，当您在游戏世界中旋转相机并继续发射射弹时，射弹的位置和方向很快就会变得古怪。

我使用四元数来表示我的相机的旋转，但在设置我的射弹旋转以匹配我的相机之前，我也从四元数推导出欧拉角。

关于我在这里做错了什么的任何想法？我有一种感觉，我需要从我的相机旋转中找出一个恒定的正面旋转，但我不太确定如何做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:14:40.237

如果我理解正确，我认为您的问题是您错误地应用了世界变换和局部变换（即在世界空间中旋转以使子弹以正确的方向飞行并围绕子弹的局部轴旋转子弹）。似乎它们都被应用在同一个空间中。

然而，我不会写一个全新的例子，而是把它留给旧的、可靠的互联网，用太阳系的常见例子给我们一些关于这个问题的指导。

这可能会启发你：

[http://docs.techsoft3d.com/visualize/3df/latest/Hoops3DGS/prog_guide/03_3_viewing_modelling_matrices.html](http://docs.techsoft3d.com/visualize/3df/latest/Hoops3DGS/prog_guide/03_3_viewing_modelling_matrices.html) （看图3.3.2.b）

...这是一个 OpenGL 示例，演示了同样的事情：

[http://www.codemiles.com/c-opengl-examples/solar-system-transformations-t7292.html](http://www.codemiles.com/c-opengl-examples/solar-system-transformations-t7292.html)

还是有理论的，希望对你有帮助！

# git - 如何暂时从 git master 分支中删除一些更改？

> ID：15203327
> 
> 赞同：0
> 
> 时间：2013-03-04T14:02:58.827
> 
> 标签：git

因此，对于我的第一个 web 应用程序，我尝试一次开发所有或很多组件，并成功实现了我认为不可能的事情。但是，在部署过程中，我需要开始一点一点地发布这些代码，因此我承诺掌握的大量代码直到以后才真正存在。我现在需要将其删除，稍后再添加。

我怎样才能修剪我的代码库，使它只有我现在需要的代码，并将所有提交的代码保存在我回去的地方，然后用 git merge 添加它？（而不是让 git merge 删除我从 master 删除的那些东西）

我可能需要多次这样做。

（可能不应该这样做，但是当你在没有指导的情况下学会自己开发时会发生狗屎。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:04:39.253

您可以通过执行签出提交

```
git checkout hash 
```

其中 hash 是 git log 显示的哈希字符串。完成后，使用

```
git checkout master 
```

一般来说，您应该有一个稳定的分支，您可以将功能合并到其中以进行发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:14:31.327

## 选项 1：手动选择版本

（根据 hannes 的回答）。这样做的缺点是之后git中没有记录，其中的commits被释放了

* * *

## 选项 2：标记版本

无论如何，标记发布是一种好习惯！

与*选项 1*`git tag -am'first release' v1.0`相同，但您使用（或其他）标记已签出的提交。这样，您就有了哪些提交被释放的记录。

* * *

## 选项 3：虚假发布历史

您可以从您的第一个提交创建一个`release`分支，然后使用`git merge --no-ff`将每个受祝福的提交（根据选项 1 和 2）合并到发布分支。我仍然会标记它们，但这提供了类似虚假开发历史的东西。如果没有其他人克隆您的存储库，您可以在最后重置`master`到您的完整`release`分支，如果您想要结构而不是单独的分支。

# c# - 重复代码的设计模式/C#技巧

> ID：15203331
> 
> 赞同：10
> 
> 时间：2013-03-04T14:03:09.533
> 
> 标签：c#, asp.net, .net, wcf, logging

我有一个 WCF 服务，它记录任何异常，然后将它们作为 FaultExceptions 抛出。

我做了很多重复，例如在每种服务方法中。

```
try { 
   // do some work

}
catch(Exception ex)
{
  Logger.log(ex);

  // actually will be Fault Exception but you get the idea.
  throw ex;
} 
```

我正在寻找一种更优雅的方式来执行此操作，因为我在每个服务中剪切和粘贴 try/catch。

是否有设计模式/C# 技巧可用于使其更优雅？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T14:15:32.280

你在谈论AOP -[`Aspect Oriented Programming`](http://en.wikipedia.org/wiki/Aspect-oriented_programming)

这是我通过将“工作”作为 lambda 传递的方法：

```
public partial static class Aspect
{
  public static T HandleFaultException<T>( Func<T> fn )
  {
    try
    { 
      return fn();
    }
    catch( FaultException ex )
    {
      Logger.log(ex);
      throw;
    }
  }
} 
```

然后使用它：

```
return Aspect.HandleFaultException( () =>
  {
    // call WCF
  }
); 
```

还有其他方法可以实现相同的目标，甚至还有一些商业产品，但我发现这种方法是最明确和最灵活的。

例如，您可以编写一个方面来为您创建和处置客户端：

```
public partial static class Aspect
{
  public static T CallClient<T>( Func<Client, T> fn )
  {
    using ( var client = ... create client ... )
    {
      return fn( client );
    }
  }
} 
```

所以：

```
return Aspect.CallClient( client =>
  {
    return client.Method( ... );
  }
); 
```

然后，您可以包装您通常想要应用的所有方面并创建一个主方面。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T14:09:37.203

我们的一个 WCF 服务也有类似的问题，我已经通过使用帮助委托解决了这个问题：

```
public static void ErrorHandlingWrapper(Action DoWork)
{
    try { 
        DoWork();
    }
    catch(Exception ex)
    {
        Logger.log(ex);

        // actually will be Fault Exception but you get the idea.
        throw;
    }
} 
```

用法：

```
public void MyMethod1()
{
    ErrorHandlingWrapper(() => {
        // do work
    });
}

public void MyMethod2()
{
    ErrorHandlingWrapper(() => {
        // do work
    });
} 
```

您仍然需要重复包装器，但代码要少得多，您可以`try..catch`在一个地方修改逻辑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T14:08:02.243

对于 WCF 特定的，您可能会考虑添加自己的 ErrorHandler。这允许您“注入”您自己的代码，以便在每次任何方法抛出异常时执行。

你可以这样设置：

```
serviceHost.Description.Behaviors.Add(new ErrorHandlerBehavior()); //Add your own ErrorHandlerBehaviour

public class ErrorHandlerBehavior : IErrorHandler, IServiceBehavior
{
    private static readonly Logger log = LogManager.GetCurrentClassLogger();

    public bool HandleError(Exception error)
    {
        if (error is CommunicationException)
        {
            log.Info("Wcf has encountered communication exception.");
        }
        else
        {
            // Log
        }

        return true;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {
        //Here you can convert any exception to FaultException like this:
        if (error is FaultException)
            return;

        var faultExc = new FaultException(error.Message);
        var faultMessage = faultExc.CreateMessageFault();

        fault = Message.CreateMessage(version, faultMessage, faultExc.Action);
    }

    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, Collection<ServiceEndpoint> endpoints, 
        BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        foreach (ChannelDispatcherBase channelDispatcher in serviceHostBase.ChannelDispatchers)
        {
            var channelDisp = channelDispatcher as ChannelDispatcher;

            if (channelDisp != null)
                channelDisp.ErrorHandlers.Add(this);
        }
    }

    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
    }
} 
```

这也允许您抛出各种异常并将它们转换为错误异常，稍后由 WCF 正确处理，而无需修改您的业务层或应用 try/catch 代码并在那里转换它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T14:06:37.240

[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)就是这样做的，您可以使用 C# 的委托（或 lambdas）轻松实现它而无需继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T14:12:16.493

您可能想尝试 AspectF（不是我的）： http: [//www.codeproject.com/Articles/42474/AspectF-Fluent-Way-to-Add-Aspects-for-Cleaner-Main](http://www.codeproject.com/Articles/42474/AspectF-Fluent-Way-to-Add-Aspects-for-Cleaner-Main)。它是由 Omar Al-Zabir... Dropthings 框架的创建者，除此之外。希望这对您有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T14:17:36.130

一般来说，您可以编写一些异常处理程序来为您完成冗余工作：

```
public abstract class ExceptionHandler
{
    /// Returns true if the exception is handled; otherwise returns false.
    public abstract bool Handle(Exception ex);

    protected void Log(Exception ex)
    {
        // Log exception here
    }
}

public class FileExceptionHandler : ExceptionHandler
{
    public override bool Handle(Exception ex)
    {
        this.Log(ex);

        // Tries to handle exceptions gracefully
        if (ex is UnauthorizedAccessException)
        {
            // Add some logic here (for example encapsulate the exception)
            // ...
            return true;
        }
        else if (ex is IOException)
        {
            // Another logic here
            // ...
            return true;
        }

        // Did not handled the exception...
        return false;
    }
}

public class Program
{
    private static void Main(string[] args)
    {
        try
        {
            // File manipulation
            throw new IOException();
        }
        catch (Exception ex)
        {
            if (!new FileExceptionHandler().Handle(ex))
            {
                // Exception not handled, so throw exception
                throw;
            }
        }

        Console.WriteLine("end");
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-04T14:07:19.263

如果您只是抛出异常，因此在调用堆栈的顶部*传播*异常，您可以避免在每个深层处理它，只需在最顶层（可能的）级别捕获它并记录。请记住，`Exception`对象也包含堆栈跟踪。

顺便说一句，如果您需要在每个级别上捕获，请记住 use `throw`，因此调用堆栈不会受到影响，而是以您使用它的方式，它会受到影响。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-04T14:07:41.527

您也可以尝试订阅文件中的[`Application_Error`](http://msdn.microsoft.com/en-us/library/24395wz3.aspx)事件[`global.asax`](http://msdn.microsoft.com/en-us/library/1xaas8a2%28v=vs.71%29.aspx)。

对于桌面应用程序[`UnhandledException`](http://msdn.microsoft.com/de-de/library/system.appdomain.unhandledexception%28v=vs.110%29.aspx)，在`AppDomain`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-04T14:32:36.893

如果您的问题是关于如何让您的当前模式更快地使用，您可以通过创建一个重复该样板代码`Snippet`

```
<CodeSnippets
    xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
    <CodeSnippet Format="1.0.0">
        <Header>
            <Title>
                trylog
            </Title>
            <Shortcut>
                trylog
            </Shortcut>
        </Header>
        <Snippet>
            <Code Language="CSharp">
                <![CDATA[try { 
   // do some work

}
catch(Exception ex)
{
  Logger.log(ex);

  // actually will be Fault Exception but you get the idea.
  throw ex;
}]]>
            </Code>
        </Snippet>
    </CodeSnippet>
</CodeSnippets> 
```

# algorithm - 查找使用两台机器执行工作的最短时间

> ID：15203341
> 
> 赞同：3
> 
> 时间：2013-03-04T14:03:24.970
> 
> 标签：algorithm, dynamic-programming

我正在经历一些问题，我在[这里](http://learn.hackerearth.com/question/360/n-2-problem/)发现了一个问题。它需要动态规划算法。我试图想出一个复发，但我不认为它总是会给出正确的结果。如果我们不考虑限制K，那么很容易出现找到最小时间的递归，**我认为这也可以使用贪婪的方法来完成**，如果我错了，请纠正我。但是对于限制K我们需要考虑到，在后期我们可能会考虑使用机器A的值i，但它可能已经完成了K限制。所以这需要回溯。我认为我们可能需要多保留一个维度来考虑这一点。但是我想不出如何使用额外的维度来包含这种情况。请提供一些帮助。

> 给你2台机器。您必须执行 N 项工作。作业 i 在机器 A 上执行 Ai 时间，在机器 B 上执行 Bi 时间。每项作业都应在机器 A 或 B 上完成。作业应按顺序执行。给定数组 A 和 B 以及一个整数 K，找出完成这些作业所需的最短时间，假设您不能在同一台机器上连续完成 K 个以上的作业。这可以在 O(NK) 空间和时间中完成。这可以改进为 O(NK) 时间和 O(N ) 空间，并进一步改进为 O(N logN ) 时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T15:21:38.937

这是双向作业车间调度问题，可以使用[约翰逊算法](http://en.wikipedia.org/wiki/Job_shop_scheduling)进行优化求解。

# java - 转换为国际字符不适用于 jsonobject.tostring 但适用于字符串文字？

> ID：15203350
> 
> 赞同：0
> 
> 时间：2013-03-04T14:04:01.273
> 
> 标签：java, android, json

这不会转换为`å`

```
String j_post = new String((byte[]) j_posts.getJSONObject(i).get("tagline").toString().getBytes("utf-8"), "utf-8"); 
```

但以下确实

```
String j_post = new String((byte[]) "\u00e5".getBytes("utf-8"), "utf-8"); 
```

我该如何解决？

更新：现在我尝试在将其转换为 JSONObject 之前修复编码，但它仍然不起作用。

```
json = new JSONObject(new String((byte[]) jsonContent.getBytes("utf-8"), "utf-8"));

    JSONArray j_posts = json.getJSONArray("posts");
    for (int i = 0; i<j_posts.length();i++){
        //[String(byte[] data)][2]
        String j_post =j_posts.getJSONObject(i).get("tagline").toString();
        post_data.add(new Post(j_post));
    } 
```

请注意，我从我的网络服务器收到一个字符串作为响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:08:20.873

这是因为您的 JSON 没有所需格式的字符。`UTF-8`当 JSON 形成时，查看准备 JSON 的代码并在其中包含编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:51:56.600

```
String j_post = new String((byte[]) "\u00e5".getBytes("utf-8"), "utf-8"); 
```

确实是（更好）：

```
String j_post = "\u00e5"; 
```

因此

```
String j_post = new String((byte[]) j_posts.getJSONObject(i).get("tagline")
        .toString().getBytes("utf-8"), "utf-8"); 
```

是

```
String j_post = j_posts.getJSONObject(i).get("tagline").toString(); 
```

所以@RJ 是对的，并且数据被破坏：无论是获取还是发送（错误的编码）。

# javascript - 如何使用jquery从数组中删除选定的值

> ID：15203365
> 
> 赞同：4
> 
> 时间：2013-03-04T14:04:47.260
> 
> 标签：javascript, jquery, jquery-ui

我想从数组中删除特定值。我编写了如下代码：

```
 $(".remove", document.getElementById("TXT")).live("click", function () {      
          $(this).parent().remove();
          var removeitem = $(this).parent().attr('id');                         
          pushvar.splice($.inArray(removeitem, pushvar), 1);

      }); 
```

在上面的代码`pushvar`中是一个数组。假设它包含 3 个元素。当我们单击其中一个删除按钮时，该功能将重复 3 次。例如，`pushvar`包含`[5,6,7]`元素。如果我单击 6 的删除按钮。然后该功能将重复 3 次。但是

```
 pushvar.splice($.inArray(removeitem, pushvar), 1); 
```

将删除所有三个元素。但是当我单击删除类时，我只想从数组中删除 6 个。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:10:37.353

你可以这样做：

```
var myArray = [10, 20, 30, 40, 50];
var removeThis = 30;

myArray = jQuery.grep(myArray, function(data){
return data != removeThis;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:12:19.867

`live()` 已弃用

> 不推荐使用 jQuery 版本：1.7，已删除：1.9

所以用`on`

```
 $(".remove,#TXT").on("click", function () {      
      var removeitem = $(this).parent().attr('id');  //get parent id                        
      $(this).parent().remove(); //remove later
      pushvar.splice($.inArray(removeitem, pushvar), 1);

  }); 
```

如果您的选择器是动态添加的，则使用`on` 委托

```
 $(document).on("click", ".remove,#TXT",  function () { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:16:05.980

我会做这样的事情：

```
$("#TXT").on("click", ".remove", function () {      
    var removeitem = $(this).parent().remove().attr('id');     
    pushvar.splice($.inArray(removeitem, pushvar)-1, 1);
}); 
```

因为这似乎对我有用-> [**FIDDLE**](http://jsfiddle.net/adeneo/sxKrs/)，但是没有任何 HTML 有很多猜测？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T14:20:39.873

试试这个：

```
$(".remove", document.getElementById("TXT")).live("click", function () {
    $(this).parent().remove();
    var removeitem = $(this).parent().attr('id');

    if ($.inArray(removeitem, pushvar) > 0) pushvar.splice($.inArray(removeitem, pushvar), 1);
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T14:28:29.957

像这样试试

```
pushvar = [5,6,7];

$('.remove').on("click", function () {    
      var removeitem = $(this).attr('id');  
      pushvar.splice($.inArray(parseInt(removeitem), pushvar), 1);
      document.write(pushvar);
      return false;
  }); 
```

[看演示](http://jsfiddle.net/Dineshkani/PBHHQ/)

# django - Django-filebrowser：生产服务器上没有图像预览

> ID：15203369
> 
> 赞同：0
> 
> 时间：2013-03-04T14:04:57.857
> 
> 标签：django, image, preview, django-filebrowser

我安装了 django-filebrowser-no-grappelli。它在 django 开发服务器上运行良好。但是在生产服务器上，文件浏览器没有在管理员中创建预览图像（其他一切正常）。安装了 PIL。所有设置都是默认设置，开发服务器也是如此。怎么了？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T13:59:45.073

我在 Pillow 上更改了 PIL。它现在正在工作。

# ruby-on-rails-3 - form_for 丢失第一个 id 的嵌套资源

> ID：15203377
> 
> 赞同：0
> 
> 时间：2013-03-04T14:05:28.170
> 
> 标签：ruby-on-rails-3, form-for, nested-routes

这是一个奇怪的错误，真的让我很烦。首先，一些背景。

我的 config/routes.rb 中有以下嵌套资源：

```
scope :requirements => { :protocol => 'https' } do
    resource :user
    resources :orgs do
        resources :members
        resources :events
        resources :levels
        resources :attendances
    end
    resources :sessions,    :only => [:new, :create, :destroy]
end 
```

然后，在 app/controllers/levels_controller.rb 我有：

```
def edit
    @org = Org.find(params[:org_id])
    @level = OrgLevel.find(params[:id])
end

def update
    @level = OrgLevel.find(params[:id])
    if @level.update_attributes(params[:level])
        flash[:success] = "Level details updated"
        redirect_to @level
    else
        render 'edit'
    end
end 
```

最后，在 app/views/levels/edit.html.erb 中，我有：

```
<% provide(:title, "Edit #{@level.name} for #{@org.name}") %> 
<div class="hero-unit">
    <h2>Edit &quot;<%= @level.name %>&quot; membership level for <%= @org.name %></h2>
    <div class="row">
        <div class="span6 offset3">
            <%= form_for [@org, @level], :url => org_level_path do |f| %>
                <%= render 'shared/error_messages' %>
                <table class="editor">
                    <tr>
                        <td class="label_x">
                            <%= f.label :name %>
                        </td>
                        <td colspan="3">
                            <%= f.text_field :name %>
                        </td>
                    </tr>
                </table>
            <% end %>
        </div>
    </div>
</div> 
```

调用[https://spot-macbook.local/orgs/55/levels/162/edit](https://spot-macbook.local/orgs/55/levels/162/edit)的结果是正常的，但是点击“保存更改”会导致重定向到[https://spot-macbook.local/orgs/162 /levels/162](https://spot-macbook.local/orgs/162/levels/162)和以下错误：

```
ActiveRecord::RecordNotFound in LevelsController#show

Couldn't find Org with id=162
Rails.root: /Users/ogod/Projects/rails_projects/nom_de_joye_app

Application Trace | Framework Trace | Full Trace
app/controllers/levels_controller.rb:71:in `correct_user'
Request

Parameters:

{"requirements"=>{"protocol"=>"https"},
 "org_id"=>"162",
 "id"=>"162"} 
```

请注意，org_id 已更改为“162”而不是“55”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:11:49.643

嗬！

发布此问题五秒钟后，我意识到存在错误并进行了更正。

原来的更新方法如下：

```
 redirect_to @level 
```

这应该是：

```
 redirect_to org_level_path(@org, @level) 
```

这么简单的错误，但我找错地方了！

# java - 在浏览器 Jsp 中显示标签显示用户的本地时间

> ID：15203378
> 
> 赞同：0
> 
> 时间：2013-03-04T14:05:29.197
> 
> 标签：java, mysql, jsp, localization, displaytag

我正在使用表详细信息的显示标签我想将日期和时间更改为用户的本地浏览器设置，DB 中的数据是 UMT。如果用户来自印度，那么它将添加 +5:30 等。我该怎么做。我陷入了困境。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-08T08:13:39.250

聚会有点晚了，但仍然在这里回答以防其他人需要它。

Display.tag`MessageFormatColumnDecorator`在内部使用将`MessageFormat`格式化程序应用于具有“格式”参数集的所有列。

因此，您的选择是：

1.  创建您自己的自定义`MessageFormatColumnDecorator`。不幸的是，它包含在`ColumnTag`代码中并且不能很容易地替换（装饰器被链接），因此您必须编译自己的 Display.Tag jar 副本，其中包含您的自定义装饰器。

在您的自定义装饰器中，使用以下示例代码更改`MessageFormat`时区：

```
TimeZone tz = //get your timezone here
Object [] formats = format.getFormats(); //'format' is MessageFormat instance
for (int i = 0; i < formats.length; i++) {
  if (formats[i] instanceof SimpleDateFormat) {
    ((SimpleDateFormat)formats[i]).setTimeZone(tz);
  }
} 
```

2.  第二个选项是使用`<fmt:formatDate>`Display.tag 内的列标签来格式化输出。

示例代码：

```
<display:table name="dateList" id="object">
  <display:column title="Date">
    <fmt:formatDate value="${object.date}" type="both" dateStyle="long" timeStyle="long"/>
  </display:column>
</display:table> 
```

您可以为它们设置默认请求区域设置`<fmt:formatDate>`或将它们包装在`<fmt:timeZone>`标签中以设置它们使用的时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:03:45.950

你试过这样吗？？

```
Locale cLoc=request.getLocale();
Calendar cCal=Calendar.getInstance(cLoc);
TimeZone tz=cCal.getTimeZone(); 
//...... 
```

# extjs - 如何在extjs4的另一个函数中调用函数？

> ID：15203379
> 
> 赞同：2
> 
> 时间：2013-03-04T14:05:29.143
> 
> 标签：extjs, extjs4, extjs4.1

我在 extjs4 工作。如何在另一个成员函数 (showSubject) 中调用成员函数 (hellotest)？

我正在尝试添加`hellotest`对`tabchange`事件的调用`subjectBar`（这是`showSubject`函数的一部分）。我尝试使用此函数调用范围，但这不起作用，并且出现以下错误：`object[object object] error undefined function`

这是我的一些代码：

```
Ext.define('Am.DnycontentcategoriesController', {
    extend: 'Ext.app.Controller',

    init: function () {

        this.control({
            //'viewport > panel >Contentcategories':
            'Contentcategories': {
                render: this.showSubject,
            }
        });
    },
    hellotest: function () {
        console.log("inside hello test function");
    },

    showSubject: function () {
        //console.log(this.hellotest());
        subjectBar.on('tabchange', function () {
            //here I am getting error 
            this.hellotest();
            var tab = subjectBar.getActiveTab();
            --------

        });
    }, 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:37:48.360

设置`scope`为`this`：

```
showSubject: function () {
    subjectBar.on('tabchange', function () {
        this.hellotest();
        var tab = subjectBar.getActiveTab();
    }, this);
} 
```

> 执行处理程序函数的范围（此引用）。默认为`Element`

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.EventManager-method-on](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.EventManager-method-on)

# java - 安卓。如何捕捉键盘被隐藏的那一刻？

> ID：15203382
> 
> 赞同：2
> 
> 时间：2013-03-04T14:05:35.540
> 
> 标签：java, android, xml, android-edittext

我试图捕捉从屏幕上移除键盘的事件，我正在使用以下代码：

```
 searchTextField.setOnEditorActionListener(new OnEditorActionListener()
    {
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event)
        {

            System.out.println("ACTION ID " + actionId);

            if(actionId == EditorInfo.IME_ACTION_DONE)
            {
                System.out.println("ACTION DONE!!!!!!!!!!");
                return true;
            }

            return false;
        }

   searchTextField.setOnFocusChangeListener( new View.OnFocusChangeListener()
    {
        public void onFocusChange(View v, boolean hasFocus) 
        {
              if (hasFocus)
                  System.out.println("HAS FOCUS");
              else
                  System.out.println("FOCUS LOST");
        }
    }); 
```

但不幸的是，它不起作用。`onEditorAction`只是从来没有打电话，无论我是开始编辑还是完成。关于`onFocusChange`方法，它只是在键盘启动时第一次调用。当键盘下降或第二次上升时，它不会被调用。谁能解释我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:34:23.430

我在活动 rootView 上使用 GlobalLayoutListener 来检查键盘是隐藏还是可见：

它的工作原理如下：

```
final View activityRootView = findViewById(R.id.activityRoot);
    activityRootView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {
            int heightDiff = activityRootView.getRootView().getHeight() - activityRootView.getHeight();
            if (heightDiff > 100) { // if more than 100 pixels, its probably a keyboard...
                ... do something here
            }
         }
    }); 
```

# cordova - 如何在phonegap中获取上传的文件名和大小

> ID：15203383
> 
> 赞同：0
> 
> 时间：2013-03-04T14:05:37.717
> 
> 标签：cordova

全部，

我正在尝试使用 PhoneGap/Cordova 2.4 从下面的代码中获取照片的文件名和文件类型。

```
navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality:50, destinationType:Camera.DestinationType.DATA_URL, sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY, mediaType:navigator.camera.MediaType.ALLMEDIA}); 
```

如何从下面的回调函数和 base64(imageData) 数据中获取此文件名和文件类型。我无法得到请帮我解决这个问题

```
function onPhotoDataSuccess(imageData) {

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:38:28.617

您可能会做得更好（如[推荐](http://docs.phonegap.com/en/2.4.0/cordova_camera_camera.md.html#camera.getPicture)的那样）将destinationType 参数设置为Camera.DestinationType.FILE_URI 而不是DATA_URL。

然后，您可以从该 URI 中提取文件名，例如：

```
var filename = imageURI.substr(imageURI.lastIndexOf("/")+1); 
```

当您说文件类型时，我假设您的意思是 JPEG、PNG 或类似的？如果是这样，最简单的方法就是从文件名中查看文件扩展名：

```
var extension = filename.substr(filename.lastIndexOf(".")+1);
switch (extension.toLowerCase()) {
  case "jpeg":
  case "jpg":
    // Do something with JPEGs
    break;
  case "png":
    // Do something with PNGs
    break;
  default:
    // Some other image format...
    break;
} 
```

# ios - iOS 6 中位置显着更改功能的调用频率不如 iOS 5

> ID：15203396
> 
> 赞同：0
> 
> 时间：2013-03-04T14:06:32.423
> 
> 标签：ios, xcode, ios6

我的应用正在使用**“位置重大变化”**功能。我注意到在编译我的应用程序以在 iOS 6 上运行后，该`location update`方法没有像在 iOS 5 上那样频繁地被调用。

我在 Stackoverflow 上进行了一些搜索，我注意到一些建议在 plist 文件中设置**CFBundleDisplayName的值。**但是，这里的问题是该`location update`方法**确实**被调用，只是不像以前那样频繁。因此，应用程序的准确性下降了。

有没有人有类似问题的经验？有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:13:27.130

这可能有不同的原因

1.  重大变化服务使用设备的蜂窝无线电来确定用户的位置并报告该位置的变化。如果您没有适当的覆盖范围，则不会调用它
2.  它基于距离的显着变化而被调用。所以如果你移动得不够多，它可能不会被调用，因为你可能在之前的测试中移动得更多

如果服务发生重大变化，不要期望获得非常准确的数据。如果您想要准确性，请选择标准服务。但是你需要在电池使用上做出妥协。

# spring-mvc - 无法使用表单提交表单数据：输入

> ID：15203398
> 
> 赞同：0
> 
> 时间：2013-03-04T14:06:37.403
> 
> 标签：spring-mvc, jstl

我正在使用 Spring 3 MVC（3.0.1 版本）。我有一个 bean 类 Customer 和一个 CustomerForm 类，如下所示。

```
public class Contact {
private String firstname;
private String lastname;
private String email;
private String phone;
    //getters and setters
}

public class ContactForm {
private List<Contact> contacts;
    //getters and setters
} 
```

从 Spring Controller 我填充联系人并将其设置为 Model 如下所示

```
private static List<Contact> contacts = new ArrayList<Contact>();

static {
    contacts.add(new Contact("Barack", "Obama", "barack.o@whitehouse.com", "147-852-965"));
    contacts.add(new Contact("George", "Bush", "george.b@whitehouse.com", "785-985-652"));
    contacts.add(new Contact("Bill", "Clinton", "bill.c@whitehouse.com", "236-587-412"));
    contacts.add(new Contact("Ronald", "Reagan", "ronald.r@whitehouse.com", "369-852-452"));
}

@RequestMapping(value = "/get", method = RequestMethod.GET)
public ModelAndView get() {

    ContactForm contactForm = new ContactForm();
    contactForm.setContacts(contacts);

    return new ModelAndView("add_contact" , "contactForm", contactForm);
} 
```

在 JSP 中，我将其显示为可编辑的形式，如下所示，

```
<form:form method="post" action="save.html" modelAttribute="contactForm">
<table>
<tr>
    <th>No.</th>
    <th>Name</th>
    <th>Lastname</th>
    <th>Email</th>
    <th>Phone</th>
</tr>
<c:forEach items="${contactForm.contacts}" var="contact" varStatus="status">
    <tr>
        <td align="center">${status.count}</td>
        <td><form:input path="contacts[${status.index}].firstname"/></td>
        <td><form:input path="contacts[${status.index}].lastname"/></td>
        <td><form:input path="contacts[${status.index}].email" /></td>
        <td><form:input path="contacts[${status.index}].phone"/></td>
    </tr>
</c:forEach>
    </table>    
    <br/>
    <input type="submit" value="Save" />
</form:form> 
```

如果我正在修改联系人并将其提交，则未将值设置为模型。但是，如果我使用如下所示的纯 HTML 输入标签，而不是使用 Spring JSTL，则值将设置为模型。

```
<c:forEach items="${contactForm.contacts}" var="contact" varStatus="status">
    <tr>
        <td align="center">${status.count}</td>
        <td><input name="contacts[${status.index}].firstname" value="${contact.firstname}"/></td>
        <td><input name="contacts[${status.index}].lastname" value="${contact.lastname}"/></td>
        <td><input name="contacts[${status.index}].email" value="${contact.email}"/></td>
        <td><input name="contacts[${status.index}].phone" value="${contact.phone}"/></td>
    </tr>
</c:forEach> 
```

当我从浏览器检查呈现的 JSP 的 HTML 源代码时，我可以发现输入控件名称的不同之处如下

```
//JSP
<form:input path="contacts[${status.index}].firstname"/>
//corresponding HTML not working
<input id="contacts0.firstname" name="contacts0.firstname" type="text" value="Barack"/>

//JSP
<input name="contacts[${status.index}].firstname" value="${contact.firstname}"/>
//corresponding HTML working!
<input name="contacts[0].firstname" value="Barack"/> 
```

这是一个已知问题还是我遗漏了什么？

问候，马克什。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T06:18:21.890

您可以直接在表单中使用名称属性：输入标签，如下所示，它可能会起作用。

```
 <td><form:input name="contacts[${status.index}].firstname" path="contacts[${status.index}].firstname"/></td> 
```

# java - Android 虚拟机堆大小

> ID：15203400
> 
> 赞同：3
> 
> 时间：2013-03-04T14:06:44.923
> 
> 标签：java, android, memory

我不明白什么是 android 应用程序堆大小。我可以从 java 和 frome 本机代码分配的总体最大内存吗？如果是，那么为什么在我的 google nexus S 上。这段代码

```
Runtime rt = Runtime.getRuntime();
long maxMemory = rt.maxMemory();
Log.v("onCreate", "maxMemory:" + Long.toString(maxMemory)); 
```

dyplays 50331648 = 48MB 但 dumpsys meminfo 显示 Native 13 16 12 84028 83457 18

我可以轻松分配 74MB

```
int size = 1024*1024*74;
char* s = new char[size]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:16:55.570

好吧，堆大小实际上是一个编程概念，远比它是一个 Android 概念。[您可以在此处](http://www.azulsystems.com/technology/java-heap-size)阅读有关它的信息，但实际上（短篇小说）VM 正在使用多少内存并且它是独立于您的应用程序分配的。

分配给您的应用程序的内存是动态分配的。因此，如果您要求您的应用程序分配更多内存，您会看到它增长。但它不能无限增长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:20:15.523

堆大小是可以分配的 RAM 量。每个应用程序都位于一个小型 Dalvik 虚拟机上。每个 VM 都会分配一些堆空间。

`/system/build.prop`而且，每个设备的文件内部都有一个预定义的堆大小设置。

# sqlite - SpatiaLite v4.0.0 RecoverGeometryColumn 违反几何约束 [geom-type or SRID not allowed]'

> ID：15203403
> 
> 赞同：4
> 
> 时间：2013-03-04T14:06:48.650
> 
> 标签：sqlite, gis, spatialite

创建空间表并使用 RecoverGeometryColumn 函数恢复几何时，如果您未将几何列指定为小写，您最终会收到“违反几何约束 [不允许使用几何类型或 SRID]”错误。

我做错了什么还是我在某处错过了一些文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:06:48.650

举个例子：

1.  创建具有空间列的表

    ```
    CREATE TABLE "test1" (
    "PK_UID" INTEGER PRIMARY KEY AUTOINCREMENT,
    "Geometry" MULTIPOLYGON) 
    ```

2.  恢复几何

    ```
    SELECT RecoverGeometryColumn('test1', 'Geometry', 2, 'MULTIPOLYGON',2); 
    ```

3.  查看已创建的触发器

    ```
    select * from sqlite_master where type='trigger' and lower(tbl_name)='test1' 
    ```

结果：

```
 CREATE TRIGGER "ggi_test1_Geometry" BEFORE INSERT ON "test1"
    FOR EACH ROW BEGIN
    SELECT RAISE(ROLLBACK, 'test1.Geometry violates Geometry constraint [geom-type or SRID not allowed]')
    WHERE (SELECT type FROM geometry_columns
    WHERE f_table_name = 'test1' AND f_geometry_column = 'Geometry'
    AND GeometryConstraints(NEW."Geometry", type, srid, 'XY') = 1) IS NULL;
    END

    CREATE TRIGGER "ggu_test1_Geometry" BEFORE UPDATE ON "test1"
    FOR EACH ROW BEGIN
    SELECT RAISE(ROLLBACK, 'test1.Geometry violates Geometry constraint [geom-type or SRID not allowed]')
    WHERE (SELECT type FROM geometry_columns
    WHERE f_table_name = 'test1' AND f_geometry_column = 'Geometry'
    AND GeometryConstraints(NEW."Geometry", type, srid, 'XY') = 1) IS NULL;
    END 
```

与 geometry_columns 表中的内容进行比较

```
 select * from geometry_columns 
```

结果：

f_table_name f_geometry_column 类型 coord_dimension srid spaitial_index_enabled

test1 几何 MULTIPOLYGON XY 2 0

结论：请注意，geometry_columns 表 f_geometry_column 被指定为“几何”，但触发器正在寻找“几何”。这会导致“几何约束 [不允许使用几何类型或 SRID]”问题。所以解决方法是让你的空间列名小写。

# caching - Oracle中数据链路一侧的缓存表

> ID：15203404
> 
> 赞同：2
> 
> 时间：2013-03-04T14:06:50.433
> 
> 标签：caching, oracle11g

我想通过 oracle 中的 dblink 创建表的缓存副本。故事如下：

我有两个表（员工，工作），它们通过远程数据库中的第三个表（emloyee_work）连接。这样做的原因是为了解耦两个实体之间的连接，使它们无法直接连接。

为了轻松处理数据，我们有一个通过连接表连接表的视图。有人可能会争辩说，这与将连接表与其他两个数据库放在同一个数据库中是一样的，但现在不是重点。

在新站点上，数据库链接延迟非常高，这会导致性能大幅下降，因为每次选择都会构建视图并通过数据库链接为每个员工执行选择。

该结构具有相对较高的读取次数和较低的写入次数。

问题是是否有可能将远程连接表“镜像”或复制到本地数据库？此副本应该是临时的，不应保留。

这样，视图将在本地副本上执行。

编辑：Oracle 版本是 11gR2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:21:42.827

您可以使用刷新的按需[物化视图](http://www.skill-guru.com/blog/2010/01/03/understanding-materialized-view-in-oracle/)。另请参阅[此链接](http://www.dba-oracle.com/t_create_materialized_view_using_database_link.htm)，他们在其中讨论通过 dblink 实现物化视图。

由于您使用的是 Oracle 11g，因此您可以创建一个[临时的、基于 RAM 的物化视图](http://www.dba-oracle.com/oracle11g/oracle_11g_result_cache_sql_hint.htm)。

# search - 以编程方式传递常量“不喜欢”参数

> ID：15203409
> 
> 赞同：0
> 
> 时间：2013-03-04T14:07:10.593
> 
> 标签：search, parameters, yii, constants

是否可以在 Yii 中以编程方式将参数传递给搜索方法？我有表 Team 和 Workers，我创建了`add workers to the team`功能。我想展示 CGridView 搜索，它将显示除分配给实际编辑团队的工作人员之外的所有工作人员。如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T16:23:18.730

通常gridview正在调用`search()`模型的方法，您可以轻松地编辑此方法以添加可选参数，例如：

```
public function  search($notLike = false){
    if($notLike) {
        //add the new sql condition not like
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:02:34.037

只需使用

```
$criteria->addSearchCondition($column, $keyword, $escape, 'AND', $like) 
```

例如

```
$criteria->addSearchCondition('CustomerName', 'Jo', false, 'AND', 'NOT LIKE')
// Column 'CustomerName'
// Value to look for 'Jo'
// escape value? false
// append to query using 'AND'
// Compare using Not Like
//     This should generate: "... AND CustomerName LIKE 'Jo'" 
```

查看[`CDbCriteria->addSearchCondition()`](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#addSearchCondition-detail)

# sql - SQL Server 2005：如何删除选定的表以及所有相关对象

> ID：15203410
> 
> 赞同：3
> 
> 时间：2013-03-04T14:07:13.037
> 
> 标签：sql, sql-server, sql-server-2005

有一个巨大的 MS Sql Server 2005 数据库的副本，有 1300 多个表，加上数百个存储过程和数十个视图，这还不包括作业。它被多个应用程序使用。

我需要精简这个怪物，只留下不到 200 个表和 100 个存储过程和其他相关对象，一个应用程序需要它们才能正常工作。当然，此应用程序使用的表和存储过程的确切列表，但无法列出不是直接从代码调用的对象（如作业、视图、触发器等）。

所以有一个问题：请建议完成该任务的最佳方法。如何安全地删除 1000 个表，首先列出相关对象（如外键、相关视图和存储过程、作业、触发器等），以及如果这些对象不指向应用程序所需的其他对象（表或存储过程），删除它们，然后删除表。存储过程也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:11:03.147

您想使用`system`包含有关约束、视图等所有信息的表。[http://msdn.microsoft.com/en-us/library/aa260604(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa260604(v=sql.80).aspx)

我会专门查看`sysforeignkeys`等`sysconstraints`并加入正确的 object_id，为此，您可以执行以下操作：

```
select t.name as TableWithForeignKey, fk.constraint_column_id as FK_PartNo , c.name as ForeignKeyColumn 
from sys.foreign_key_columns as fk
inner join sys.tables as t on fk.parent_object_id = t.object_id
inner join sys.columns as c on fk.parent_object_id = c.object_id and fk.parent_column_id = c.column_id
where fk.referenced_object_id = (select object_id from sys.tables where name = 'TableOthersForeignKeyInto')
order by TableWithForeignKey, FK_PartNo 
```

这将列出您表中的外键，您可以替换 WHERE name = 以使用 OBJECT_ID IN (.. all your object id's)

此脚本基于（[如何列出引用 SQL Server 中给定表的所有外键？](https://stackoverflow.com/questions/483193/how-can-i-list-all-foreign-keys-referencing-a-given-table-in-sql-server-2005)）的答案之一

**编辑**

从@Jacek 的评论中，您还可以使用`stored procedure sp_depends`

[http://msdn.microsoft.com/en-us/library/ms189487.aspx](http://msdn.microsoft.com/en-us/library/ms189487.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:11:04.403

这是我的第一个想法：使用 Information_Schema 视图找出有关表的元数据并据此采取行动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:31:23.290

这不是 brill，但如果您使用脚本工具并编写脚本删除并创建数据库中的所有对象。它确实根据它所知道的依赖顺序来做到这一点。

# python - dbf 到 xls - 第一个非标题行未写入

> ID：15203423
> 
> 赞同：1
> 
> 时间：2013-03-04T14:07:42.333
> 
> 标签：python, excel, type-conversion, dbf

我想使用 python 将 .dbf 文件转换为 .xls。我已经引用了这个[代码片段](https://gis.stackexchange.com/questions/25125/saving-a-dbf-as-xls-in-python)，但是我无法使用此代码编写第一个非标题行：

```
 from xlwt import Workbook, easyxf
    import dbfpy.dbf

    dbf = dbfpy.dbf.Dbf("C:\\Temp\\Owner.dbf")
    book = Workbook()
    sheet1 = book.add_sheet('Sheet 1')

    header_style = easyxf('font: name Arial, bold True, height 200;')

    for (i, name) in enumerate(dbf.fieldNames):
        sheet1.write(0, i, name, header_style)

    for row in range(1, len(dbf)):
        for col in range(len(dbf.fieldNames)):
            sheet1.row(row).write(col, dbf[row][col])

    book.save("C:\\Temp\\Owner.xls") 
```

如何获得要写入的第一个非标题行？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:13:11.123

您错过了第一行 dbf 中的第 0 行。在 dbf 文件中，列名不是一行。但是 Excel 文件中的第 0 行是标题，因此 dbf 和 xls 中的索引需要不同，因此您需要将 1 添加到 Excel 工作表中使用的行。

所以

```
for row in range(len(dbf)):
    for col in range(len(dbf.fieldNames)):
        sheet1.row(row+1).write(col, dbf[row][col]) 
```

请注意，所指的狙击手也不会在范围内添加 1

# tinyos - 包装通用定时器的模块

> ID：15203427
> 
> 赞同：0
> 
> 时间：2013-03-04T14:07:56.953
> 
> 标签：tinyos, nesc

我正在尝试编写一个模块来包装通用计时器，但我想使用这个模块能够以任意精度包装计时器，而无需编写重复的代码。

我这样编写模块，但它抱怨precision_tag 缺少类型，但也给它一个无法编译的类型。

```
generic module TimerLoggerP(precision_tag) {
    provides {
        interface Timer<precision_tag> as Timer;
        interface LoggerComponent;
    }

    uses {
        interface Timer<precision_tag> as RTimer;
    }
} 
```

有谁知道如何使它以我试图实现的通用方式工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:11:55.967

只需要特殊的*typedef*类型。

```
generic module TimerLoggerP(typedef precision_tag) {
    provides {
        interface Timer<precision_tag> as Timer;
        interface LoggerComponent;
    }

    uses {
        interface Timer<precision_tag> as RTimer;
    }
} 
```

# java - 如何把一个按钮放在右边，另一个放在左边

> ID：15203428
> 
> 赞同：0
> 
> 时间：2013-03-04T14:07:59.273
> 
> 标签：java, android

我尝试创建动态 linerlayout 并创建了两个按钮。

```
LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.HORIZONTAL);
        layout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
                LayoutParams.FILL_PARENT));

        TextView titleView = new TextView(this);
        titleView.setWidth(LayoutParams.WRAP_CONTENT);
        titleView.setHeight(LayoutParams.WRAP_CONTENT);
        titleView.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        titleView.setText("Hallo Welt!");
        layout.addView(titleView);

        Button btnConnect = new Button(this);
        btnConnect.setText("Connect");
        layout.addView(btnConnect);

        Button btnDisconnect = new Button(this);
        btnDisconnect.setText("Disconnect");
        layout.addView(btnDisconnect); 
```

我想把连接按钮放在左角，想把断开按钮放在右上角。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:19:37.513

您是否尝试为按钮设置布局重力？

```
LayoutParams params;

Button btnConnect = new Button(this);
params = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
params.gravity = Gravity.Left;
btnConnect.setLayoutParams(params);
...
Button btnDisconnect = new Button(this);
params = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
params.gravity = Gravity.Right;
btnConnect.setLayoutParams(params);
... 
```

布局重力定义了在其父视图中放置视图的位置（也请参阅[Android 上的 Gravity 和 layout_gravity](https://stackoverflow.com/questions/3482742/android-gravity-and-layout-gravity)）

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:20:48.757

您可以使用 RelativeLayout 而不是线性布局。

并将规则添加到 RelativeLayout.Layoutparams 的布局参数 params = `RelativeLayout.Layoutparams params = (RelativeLayout.LayoutParams)button.getLayoutParams(); params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);`

# maven - 在耳边的战争中共享通用数据

> ID：15203429
> 
> 赞同：0
> 
> 时间：2013-03-04T14:08:01.357
> 
> 标签：maven, jboss, ear, data-sharing

为了减少数据库命中，我使用静态变量来存储数据库中的数据。在`WAR`部署时，这些数据存储在这些变量中，因为它的变化并不那么频繁。这种情况工作正常，因为范围只有一个 a `WAR`。现在我有另一个应用程序，我需要访问这些变量但由于不同的应用程序范围，我无法在另一个应用程序中访问它们。

另外，我有一个`EAR`包含上述内容的内容`WAR`和一个包含两个s`JAR`的一些常见业务逻辑的内容。`WAR`那么，`EAR`是否可以通过`JAR`或使用一些不同的方法来共享这些变量？

如果有任何`javaEE`概念可以在这种情况下提供帮助，那么也请告诉我。

我为此使用`maven`with`Jboss7.1.1.Final`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:54:10.953

[您应该使用 Infinispan，这是 JBoss 7 https://docs.jboss.org/author/display/ISPN/Getting+Started+Guide+-+JBoss+AS+7](https://docs.jboss.org/author/display/ISPN/Getting+Started+Guide+-+JBoss+AS+7)的内置缓存机制。在 Java EE 中，通常不赞成在静态字段中缓存数据。

但是，如果您仍希望将数据缓存在静态字段中，则需要确保具有缓存的类在所有 WAR 之间共享。这意味着您必须创建[瘦的 WAR](http://maven.apache.org/plugins/maven-ear-plugin/examples/skinny-wars.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T16:48:23.220

看起来您需要企业缓存解决方案。市场上有很多选择。它们包括但不限于

开源框架

1.  内存缓存
2.  EHCache
3.  Infinispan（菲利普提到）

商业产品

1.  甲骨文一致性
2.  千兆空间 XAP
3.  宝石之火

对于您的第二个问题，只要您的 JAR 部署在该`EAR/lib`文件夹中，就可以了。

# linux - 用于读取 USB UPS 状态的 Bash 脚本

> ID：15203433
> 
> 赞同：4
> 
> 时间：2013-03-04T14:08:14.603
> 
> 标签：linux, bash, usb, ups

我有一个通过 USB 端口连接到我的 linux 机器的 UPS。不幸的是，UPS 不受支持，并且不会显示为经过改造的设备。但是，它确实可以通过 lsusb 命令正确显示。

我想通过一个简单的 bash 脚本（例如由 cron 触发）从我的 UPS 读取电池状态。我不想要一个功能齐全的脚本，因为它需要知道特定 UPS 的协议；我只想创建一个脚本来编写原始命令并在给定已知 USB 地址的情况下从 UPS 读取原始响应，然后由我来对实际命令进行编码并解析响应。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:12:55.497

您也许可以使用普通`echo`命令将字符串直接发送到设备，例如：

```
echo "some command" > /dev/usbXXX 
```

要获得输出，您可能可以使用例如从中读取`cat`：

```
cat /dev/usbXXX | grep "what you're looking for" 
```

# java - 如何将 InputStream 转换为 Source？

> ID：15203439
> 
> 赞同：18
> 
> 时间：2013-03-04T14:08:54.937
> 
> 标签：java, android, validation, xsd

我想使用存储在我的设备上的*xsd模式文件来验证**xml*文档。这是我的示例代码：

 *```
SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

// schema file on my device
InputStream isSchema = context.getResources().openRawResource(xsd_file);
// InputStream => Source conversion
Source schemaSource = ????
Schema schema = factory.newSchema(schemaSource);

Validator validator = schema.newValidator();
validator.validate(new DOMSource(document)); 
```

**问题：**如何将 InputStream 转换为 SchemaFactory::newSchema 方法所需的 Source ？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-03-04T14:23:18.120

你不转换，你包装它。

```
Source schemaSource = new StreamSource(isSchema); 
```

请参阅：[http ://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/transform/stream/StreamSource.html#StreamSource%28java.io.InputStream%29](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/transform/stream/StreamSource.html#StreamSource%28java.io.InputStream%29)*

# c# - 跟踪每个版本的新增功能

> ID：15203440
> 
> 赞同：-1
> 
> 时间：2013-03-04T14:08:56.190
> 
> 标签：c#, .net, visual-studio

对于我的应用程序，我想跟踪每个功能在哪个版本中实现。现在我只是像我的例子一样在 de 评论中添加一些文本：

```
// Checks if a user exists
// Implemented: v2.6.8
public bool CheckIfUserExists(...)
{
    ...
} 
```

我对应用程序中的每个函数都执行此操作，以查看何时实现。但是有没有一种简单的方法或任何标准的方法可以在某种列表中看到这一点，所以我不必深入研究该特定函数的代码来查看它是在哪个版本中实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:10:53.803

是的，标准方法是使用源代码控制系统（例如 TFS 或 GIT），它将为您跟踪更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:12:30.397

我会首先查看一些版本控制系统，例如 Git。查看 github.com 或 bitbucket.org 了解一些在线托管服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:23:01.393

如果您想要进行版本控制，请按照建议使用 git 或 TFS。

也就是说，您可以使用[XML](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)注释和一个名为[SandCastle](http://shfb.codeplex.com/)的工具来生成一组帮助文件和/或网页，以帮助发布写在代码旁边的信息。

这是使用 Sandcastle的[教程](http://broadcast.oreilly.com/2010/09/build-html-documentation-for-y.html)

C# 中的 XML 注释如下所示：

```
/// <summary>
////Checks if a user exists
/// Implemented: v2.6.8
///</summary>
///<returns>
///True if the user exists, false otherwise
///</returns>
public bool CheckIfUserExists(...)
{
    ...
} 
```

# c# - 如何在 XDocument 上使用 SetElementValue

> ID：15203444
> 
> 赞同：0
> 
> 时间：2013-03-04T14:09:10.103
> 
> 标签：c#, xml, linq-to-xml

这是我的 xml 示例

```
<?xml version="1.0"?>
<SearchHistory>
    <Search>
        <title>Text 1</title>
        <count>0</count>
    </Search>
    <Search>
        <title>Text 2</title>
        <count>0</count>
    </Search>
</SearchHistory> 
```

我想改变Text 1的**计数值**

这是我尝试过的：

```
xdoc.Descendants("Search")
    .Where(x => x.Element("title").Value == tbSearch.Text)
    .Single().SetElementValue("count", curCount); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:17:22.163

`XDocument`当您进行更改时，您必须保存

```
xDoc.Save(fileName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:22:49.490

```
xdoc.Descendants("Search")
    .Where(x => x.Element("title").Value == tbSearch.Text)
    .Single()
    .Descendants("count")
    .Single()
    .Value = "1"; 
```

# c# - 使用 Reactive 并行运行方法

> ID：15203445
> 
> 赞同：2
> 
> 时间：2013-03-04T14:09:15.917
> 
> 标签：c#, .net, parallel-processing, system.reactive

晕，我一直在寻找 RX 框架的解决方案。我的 C# 4.0 类将调用 2 个不同的方法，为了节省时间，我想并行执行。有没有办法使用 Reactive Framework 并行运行 2 种不同的方法？不仅并行运行这两种方法，而且还应等待其他方法完成并结合两种结果。示例如下图：

```
AccountClass ac = new AccountClass();    
string val1 = ac.Method1();  
bool val2 = ac.Method2(); 
```

我如何运行这两种方法并行运行并在订阅部分中相互等待完成并将结果组合在一起？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T18:31:58.133

```
var result = Observable.Zip(
    Observable.Start(() => callMethodOne()),
    Observable.Start(() => callMethodTwo()),
    (one, two) => new { one, two });

result.Subscribe(x => Console.WriteLine(x)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:12:16.053

您可以使用[zip](http://rxwiki.wikidot.com/101samples#toc43)方法来实现所需的行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-04T14:19:07.200

尝试这个：

```
using System.Threading.Tasks;

string val1 = null;
bool val2 = false;

var actions = new List<Action>();

actions.Add(() =>
{
     val1 = ac.Method1();
});

actions.Add(() =>
{
     val2 = ac.Method2();
});

Parallel.Invoke(new ParallelOptions(), actions.ToArray());

// alternative - using Parallel.ForEach:
// Parallel.ForEach(actions, action => action());

// rest of your code here..... 
```

有用的链接：

[http://tipsandtricks.runicsoft.com/CSharp/ParallelClass.html](http://tipsandtricks.runicsoft.com/CSharp/ParallelClass.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-04T19:58:00.743

类似于[Rui Jarimba](https://stackoverflow.com/a/15203658/173099 "瑞·贾林巴")，但更简洁一些；

```
 string val1 = null;
        bool val2 = false;

        Action action1 = () =>
        {
            val1 = ac.Method1();
        };

        Action action2 = () =>
        {
            val2 = ac.Method2();
        };

        Parallel.Invoke(new ParallelOptions(), action1, action2); 
```

# f# - F# 类型的私有修饰符

> ID：15203446
> 
> 赞同：8
> 
> 时间：2013-03-04T14:09:24.000
> 
> 标签：f#

如果我们有

```
module M

type private A = B | C

(...) 
```

private 修饰符意味着 A 只能在模块 M 中使用。但在这种情况下：

```
namespace N

type private A = B | C

(...) 
```

该私有修饰符会产生什么影响？CLR 命名空间拥有私有成员是没有意义的，因为命名空间可以随意扩展，那么私有修饰符会产生任何影响吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T14:14:54.450

如果您`private`在命名空间中使用类似的修饰符，它将使类型或模块对文件私有——也就是说，该类型可以被同一文件中它下面的任何东西使用。

编译该类型时，F# 编译器会将其视为`internal`在 .NET 元数据中。（这是有道理的，因为类型是真的`internal`——编译器只是强制执行它只能由同一文件中的类型/函数使用的约束。）

顺便说一句，我经常使用此功能——它对于仅在少数地方内部使用的小型辅助类型非常有用，因为它可以防止它们弄乱 IntelliSense。

编辑：您可以使用它的另一个很酷的技巧是创建文件范围的“内置”辅助函数。

如果您创建这样的模块，其中的函数将自动对其下方的任何内容可用（感谢`[<AutoOpen>]`），但由于模块被标记`private`，这些函数不会阻塞您的 IntelliSense（在处理其他源文件时）或隐藏现有功能。

```
[<AutoOpen>]
module private Helpers =
    let [<Literal>] blah = "blah"

    let lessThanTwo value =
        value < 2.0 
```

# abap - Smartforms 为给定条件触发新页面

> ID：15203459
> 
> 赞同：2
> 
> 时间：2013-03-04T14:10:14.427
> 
> 标签：abap, sap-smart-forms

我准备了一个智能表格，它在主窗口中有一个表格。所以表中可能有数百行。我想要做的是每 10 条记录触发新页面。

我已将主窗口的大小调整为最多可容纳 10 条记录的高度，并在命令中选择了新页面刻度。这是一种工作，但我想以编程方式做到这一点。

像;

```
if count % 10 = 0
then GO_TO_NEW_PAGE 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:50:27.277

您应该能够使用[命令节点触发](http://help.sap.com/erp2005_ehp_04/helpdata/en/07/57f78ff5d111d4b65c006094192fe3/frameset.htm)[动态分页符](http://help.sap.com/erp2005_ehp_04/helpdata/en/70/e17a37dec511d3b575006094192fe3/frameset.htm)。我还没有尝试过这对表格页眉/页脚有什么影响......

# asp.net-mvc-4 - Windows 工作流 4.5 范式问题

> ID：15203460
> 
> 赞同：1
> 
> 时间：2013-03-04T14:10:15.973
> 
> 标签：asp.net-mvc-4, asp.net-web-api, workflow-foundation-4

作为初学者，我一直在深入研究 Windows Workflow 4.5 的技术细节和实现，并取得了不错的成果。我的问题更多是“为什么以及何时”与“如何”的问题，所以请耐心等待。

我把一个大家都熟悉的概念，把业务逻辑抽象成WF，即通用登录流程。我想要完成的是拥有可以从 MVC 网站、Windows 窗体应用程序等调用的可重用逻辑，并且让所有内容都通过相同的工作流程运行，我已经实现了。

现在我有 2 个关于“何时”应用 WF 和何时使用代码的概念性问题。

1 - 以简单验证为例。我正在尝试登录，但我传递了一个空的用户名或密码字符串。显然，我想将消息发送回最终用户“需要用户名”和“需要密码”，我已经完成了。现在，我这样做的方式是我有一个验证类（FluentValidation NuGet 包，如果重要的话），但重要的是我在代码中这样做。因此，在 WF 中，我通过 ExecuteMethod 调用我的验证代码，一切正常。我的问题是：这是 WF 思维方式的错误方法吗？我应该执行内联 WF“如果”操作/决策并直接在 WF 内部构建验证消息，而不是调用一些代码块？一世' 我不仅要求验证，而且作为一个我们都可以涉及的概念，但更一般地说，我应该尝试将任何东西和我能做的一切都放入 WF 本身，还是调用自定义代码更好？如果可能的话，我正在寻找更多来自具有 WF 经验的经验丰富的软件架构师的推理的最佳实践，而不是某人的意见。

2 - 在另一台机器上选择工作流程。因此，同一登录工作流活动的一部分需要服务方法调用。我以这样一种方式编写代码和工作流，即工作流接收 ILogOnService 的 In 参数，该参数具有接口方法“AuthenticateUser”。我传入的具体实现是异步调用 MVC4 Web Api post 方法，以执行标准的 Asp.Net 成员资格 ValidateUser。同样，我应该从 WF 工作流程中调用这个 Web Api PostAsync 吗？如果是这样，这不是将我的工作流程与 Asp.Net Membership 和我的特定服务选择紧密结合。似乎有办法让工作流达到某个点，然后在另一台机器上恢复进程，例如服务正在运行的地方，然后继续这个过程，但我

只是从这项技术的专业人士那里寻找一些指导方针和想法，但我会选择最有用的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:32:57.477

使用 C# 代码来实现工作流的细节并没有错。事实上，我总是告诉人们，如果他们仅使用标准的开箱即用活动来使用 WF4，他们可能做错了事。您确实需要创建或让其他人为您创建自定义活动，为您的业务建模业务活动。现在，如果这意味着创建一个使用 FluentValidation 验证登录的活动，那就太好了。另一次，您可能会从较低级别的 WF4 活动中构建更高级别的业务活动，只需将它们组合起来，以最适合您的情况。

如果您知道该操作是短暂的并且通常可用，则使用 PostAsync 之类的服务调用服务可以很好地工作。然而，当您进入 SOA 风格时，您真的想开始使用[时间解耦](http://en.wikipedia.org/wiki/Coupling_%28computer_programming%29)因此，一项服务不依赖于另一项立即可用的服务。当你进入时间解耦时，你真的想使用队列，也许是 MSMQ 或者其他类似的技术。因此，在这种情况下，您真的想用响应队列发送单向消息，并且工作流必须空闲并等待响应消息到达。这将重新加载工作流，可能在另一台机器上。现在这可能并不总是合适的，例如在您的登录中，由于会员服务不可用，因此在一天后授予登录并没有多大用处，但可以导致非常可扩展和容错的系统。当然，没有免费的午餐，因为这些系统很难正确设计。

# javascript - 类似于 youtube 播放器的视频播放器建议

> ID：15203461
> 
> 赞同：0
> 
> 时间：2013-03-04T14:10:17.790
> 
> 标签：javascript, jquery, flash, youtube, html5-video

创建类似于 youtube 视频播放器的视频播放器的最佳方法是什么，因为在播放视频后，它会显示更多要观看的视频集合？

这些视频不在 youtube 上托管。

生成视频建议不是问题。问题是在视频播放完毕后将它们显示在播放器中，如果用户单击其中一个建议，则会打开并播放所选视频页面。

我可以在 html5 或 jquery 或 flash 或其他东西中执行此操作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T22:02:13.550

Can be done in Flash. You could use the FLVPlayback Component to play the original video. Then use the Listener Class to listen for COMPLETE. You could then place thumbnails for each of the related videos on top of the FLVPlayback Component - these would then load the new video into the component and the process would continue.

Check [this tutorial](http://www.republicofcode.com/tutorials/flash/as3flvplayback/) out for using the component and also the Listener Class for the component.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:16:42.870

JWPlayer 是一款出色的 HTML5 视频播放器，具有 Flash 后备功能。它还有一个不错的 API 支持相关视频：[http](http://www.longtailvideo.com/support/addons/related-videos/22352/related-videos-reference-guide/) ://www.longtailvideo.com/support/addons/related-videos/22352/related-videos-reference-guide/ 。

还有一些许可选项：[http ://www.longtailvideo.com/jw-player/pricing/](http://www.longtailvideo.com/jw-player/pricing/)

希望有帮助。

# visual-c++ - 需要在目标机器上安装visual c++ 2005 dll项目和先决条件

> ID：15203463
> 
> 赞同：0
> 
> 时间：2013-03-04T14:10:20.443
> 
> 标签：visual-c++, installation, distribution

我写了一个简单的 dll 并包含在下面的头文件中：

```
#include <windows.h>
#include <sddl.h>
#include <winsock.h>
#include <stdio.h>
#include <stdlib.h>
#include <mprapi.h>
#include <raserror.h>
#include <mprerror.h>
#include <strsafe.h> 
```

所以我的 dll 在我的电脑上工作正常，但在另一台电脑上不工作。我在目标机器上安装了 vcredist_x86 但没有任何改变。我还使用了设置部署向导，没有任何反应。但是当我在目标机器上安装 Visual Studio 2005 时，我的 dll 运行良好。

所以这里有一个问题，我如何检索需要在目标机器上安装哪些先决条件？

我还必须提到我将我的代码编译为 c 代码“编译为 C 代码 (/TC)”。

抱歉我的英语不好，并提前感谢您的帮助。

# iis - WiX 3.7 IIS 设置

> ID：15203465
> 
> 赞同：0
> 
> 时间：2013-03-04T14:10:32.660
> 
> 标签：iis, iis-7, wix, wix3.5, wix3.7

运行我们的安装程序时，我们将其配置为在 IIS 中设置 3 个网站，在升级之前它按预期工作，即使默认网站（或侦听同一端口的任何网站）仍然存在。

如果监听端口 80 的网站已经启动，WiX 会从我们的安装程序创建网站，而不是启动它（这是我所期望的）。然而，自从升级到 3.7 后，我发现如果在 IIS 中配置了任何其他站点正在侦听同一端口，则安装程序不会创建该站点**。**

WiX 设置中是否缺少某些内容，我需要添加以强制 WiX 从我们的安装程序添加网站，或者这只是通过 WiX 创建网站的一个已知问题？

**编辑：**

进一步研究，该网站似乎是通过端口检查的，而不是通过名称检查的。如果我在端口 80 上有“默认网站”，那么我在安装程序中拥有的网站下的任何应用程序都会在默认网站下配置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T16:30:18.460

WiX 工具集中的 IIS CustomActions 使用“自然键”来查找作为`ip:port:header`组合的网站。大多数网站，仅`port`指定 。在您的情况下，我希望 WiX 工具集找到现有网站并根据您的安装包中的规范“修复它”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:18:48.683

谢谢 Rob，我设法通过将`ConfigureIfExists`标志设置为 true 来解决这个问题，它按照我最初的预期创建了网站。

# java - 我可以从 ApplicationContext 定义一个 bean，其类保存在 jar 文件中

> ID：15203468
> 
> 赞同：0
> 
> 时间：2013-03-04T14:10:35.747
> 
> 标签：java, spring, jakarta-ee

我可以从`ApplicationContext`保存在 jar 文件中的类中定义一个 bean 吗？

我有许多模块，每个模块都存储在一个 Jar 文件中，我的应用程序需要加载它们才能执行。我正在使用 Spring Framework，我需要为每个模块定义`ApplicationContext`它需要模块类的类路径。那么，如何从 jar 文件中提取类并将它们用作应用程序中的 bean？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:16:46.273

这可能会帮助你

考虑下面的bean配置

```
<bean id="simpleUrlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"> 
```

**SimpleUrlHandlerMapping**是 spring.jar 中存在的类文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:29:53.870

您可以尝试组件扫描

```
<context:component-scan base-package="com.planner.pov" /> 
```

记得添加上下文命名空间..

# c++ - OpenCV 中的函数

> ID：15203470
> 
> 赞同：0
> 
> 时间：2013-03-04T14:10:37.800
> 
> 标签：c++, codeblocks

嗨，我在 OpenCV 中编写了以下代码。基本上它从文件中读取视频。现在，我想创建一个函数来调整视频大小，但我不确定如何从主函数调用“VideoCapture”类。我已经编写了一个示例函数来查看它是否会读取任何内容，但它可以很好地编译显示来自主函数的内容，但没有来自新创建的函数。有什么帮助吗？PS我不是很有经验，请耐心等待LOL。

```
 using namespace cv;
     using namespace std;

     void resize_video(VideoCapture capture);

     int main(int argc, char** argv)
     {
        VideoCapture capture; //the C++ API class to capture the video from file

        if(argc == 2)
         capture.open(argv[1]);
        else
         capture.open(0);

        if(!capture.isOpened())
        {
           cout << "Cannot open video file " << endl;
           return -1;
        }

        Mat frame;
        namedWindow("display", CV_WINDOW_AUTOSIZE);
        cout << "Get the video dimensions " << endl;
        int fps = capture.get((int)CV_CAP_PROP_FPS);
        int height = capture.get((int)CV_CAP_PROP_FRAME_HEIGHT);
        int width = capture.get((int)CV_CAP_PROP_FRAME_WIDTH);
        int noF = capture.get((int)CV_CAP_PROP_FRAME_COUNT);
        CvSize size = cvSize(width , height);

        cout << "Dimensions: " << width << height << endl;
        cout << "Number of frames: " << noF << endl;
        cout << "Frames per second: " << fps << endl;

        while(true)
        {
          capture >> frame;
          if(frame.empty())
            break;
          imshow("display", frame);
          if (waitKey(30)== 'i')
            break;
        }
       //resize_video();
  }

  void resize_video(VideoCapture capture)
  {
     cout << "Begin resizing video " << endl;

    //return 0;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:23:32.283

你想在while循环中调用你的函数，而不是在它之后（为时已晚，程序结束）

所以，它可能看起来像这样：

```
void resize_video( Mat & image )
{
   //
   // do  your processing
   //
   cout << "Begin resizing video " << endl;
} 
```

并称之为：

```
while(true)
    {
      capture >> frame;
      if(frame.empty())
        break;

      resize_video(frame);

      imshow("display", frame);
      if (waitKey(30)== 'i')
        break;
    } 
```

# regex - 正则表达式：如何匹配特定字符序列前后的单词并包含其他一些字符

> ID：15203474
> 
> 赞同：0
> 
> 时间：2013-03-04T14:11:03.443
> 
> 标签：regex

我在文本上使用了一种书签。这些书签的结构是这样的：（# + field + #）

“字段”必须仅包含字母字符（AZ 和 az，而不是数字或其他字符）。

我需要匹配不满足此规则的单词。

因此，请考虑以下示例：

1.  （＃公司名＃）
2.  （＃公司名＃）
3.  (#Company5Name#)

只有第一个是正确的，但我必须匹配其他 2 个案例。匹配第一个的模式是：

```
(\(\#)[A-Za-z]+(\#\)) 
```

为了匹配错误的情况，我需要这样的东西：

```
(\(\#)[^A-Za-z]+(\#\)) 
```

但这不能正常工作。

谁能建议我如何让它工作？

提前感谢，对不起我的英语......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:13:13.837

这应该有效：

```
\(#.*?[^A-Za-z].*?#\) 
```

`\(`- 转义（
`#`- 散列
`.*?`- 零个或多个通配符（非贪婪）
`[^A-Za-z]`- 单个无效字符
`.*?`- 零个或多个通配符（非贪婪）
`#`- 散列
`\)`- 转义）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:13:33.870

你可以试试

```
\(#[^#]*?[^A-Za-z#]+[^#]*?#\) 
```

# python - 如何在 Python 中从解析的数据中实现树结构

> ID：15203477
> 
> 赞同：0
> 
> 时间：2013-03-04T14:11:06.910
> 
> 标签：python, parsing, tree, structure

我正在寻找一种有效的方法来解析下面引用的数据（一次一条记录）：

```
(00000001,([xx1#xx2,xx3#[xx4#[xx5#[xx6#0],xx8#false]]]))
(00000002,([xx1,xx3#[xx4#[xx5#[xx6#1,xx11#1],xx8#true#1],xx9#xx10]])) 
```

然后打印从根到叶子的所有内容。要记住的关键事项是：

1.  只要符号]已被解析，我们就下去\创建一个新级别
2.  只要符号被解析，我们就保持在同一级别
3.  我们不必费心去更新一个值，但是，只要符号 # 已经被解析，我们就必须降低一个级别

输出必须如下所示：

```
root>xx1>xx2
root>xx3>xx4>xx5>xx6>0
root>xx3>xx4>xx5>xx11>1
root>xx3>xx4>xx8>true>1
root>xx3>xx4>xx8>false
root>xx3>xx9>xx10 
```

任何提示都非常受欢迎！

# objective-c - 当应用程序在可可中加载时，如何显示具有透明背景（如 png）的图片？

> ID：15203481
> 
> 赞同：-2
> 
> 时间：2013-03-04T14:11:16.167
> 
> 标签：objective-c, macos, cocoa

一个例子是 Photoshop，当应用程序启动时，会出现一张非常漂亮的透明背景图片。如何在构建自己的应用程序时获得相同的结果？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:02:31.540

如果您想知道如何获得自定义着色窗口，而不是简单地在启动时显示它，Apple 提供的[RoundTransparentWindow](http://developer.apple.com/library/mac/#samplecode/RoundTransparentWindow/Listings/ReadMe_txt.html)示例代码展示了如何实现这一点。

# php - PHP元素数组，按循环“动画”排序？

> ID：15203482
> 
> 赞同：3
> 
> 时间：2013-03-04T14:11:19.267
> 
> 标签：php, arrays, algorithm, animation

我已经问过一个类似的问题，但我需要不同的效果。原来的问题在[这里](https://stackoverflow.com/questions/15201395/php-array-of-elements-sort-by-wave-animation)。

* * *

我有一个简单的数组。数组长度始终是平方数。所以 16、25、36 等等。

```
$array = array('1', '2', '3', '4' ... '25'); 
```

我所做的是用 HTML 排列数组，使其看起来像一个具有均匀边的块。

![](../Images/25ab824449cc89342ebf715dc38a99cc.png)

我想要做的是对元素进行排序，这样当我将 JSON 编码的数组传递给 jQuery 时，它将迭代数组，淡入当前块，所以我会得到一个循环动画。所以我想像这样对数组进行排序

![](../Images/3b14b685c6c96a1f912810ec0fcb3857.png)

所以我的排序数组看起来像

```
$sorted = array('1', '6', '11'', '16', '21', '22', '23' .. '13'); 
```

有没有办法这样做？..谢谢

* * *

编辑：

我试图通过创建类似矩阵的列/行数组来做到这一点：

```
$side = 5;

$elems = $side*$side;
$array = range(1,$elems);

for($i=1; $i <= $side; $i++) {
   for($x=$i; $x <= $elems; $x=$x+$side) {
      $columns[$i][] = $x; 
   }
}

for($i=1, $y=1; $i <= $elems; $i=$i+$side, $y++) {
   for($x=$i; $x < $side+$i; $x++) {
      $rows[$y][] = $x;
   }
} 
```

我的下一步是走第一列，最后如果它在最后一个元素列上，最后在最后一个元素上等等。如果有人有更好的主意，那就太好了:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:59:44.070

只要网格始终是方形的，这将起作用：

```
<?php

    // The size of the grid - 5x5 in the example above
    $gridSize = 5;

    // Create a 2D array representing the grid
    $elements = array_chunk(range(1, pow($gridSize, 2)), $gridSize);

    // Find the half way point - this will be the end of the loop since we
    // want to stop in the middle
    $end = ceil($gridSize / 2);

    // An array to hold the result    
    $result = array();

    // The stopping point of the current interation
    $stop = $gridSize;

    // Loop from start to the middle
    for ($i = 0; $i < $end; $i++) {

        // start in the top left corner
        $x = $y = $i;

        // Traverse Y top to bottom
        while ($y < $stop) {
            $result[] = $elements[$y++][$x];
        }
        $y--;
        $x++;

        // Traverse X left to right
        while ($x < $stop) {
            $result[] = $elements[$y][$x++];
        }
        $x--;
        $y--;

        // Traverse Y bottom to top
        while ($y >= $gridSize - $stop) {
            $result[] = $elements[$y--][$x];
        }
        $y++;
        $x--;

        // Make sure we come in a level
        $stop--;

        // Traverse X right to left
        while ($x >= $gridSize - $stop) {
            $result[] = $elements[$y][$x--];
        }
    }

    print_r($result); 
```

[看到它工作](http://codepad.org/4LmY3G9T)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:08:41.510

这应该有效。您可以将任何数组传递给 circularSort 函数，它将返回您的排序数组。

```
/*
Get the circular sorted array
*/
function circularSort($array)
{
    //Get the length of array
    $arrayLength = count($array);
    //Find the square root of length of array
    $arrayRows = sqrt($arrayLength);

    //Divide the arrays in $arrayRows
    $arrayChunks = array_chunk($array,$arrayRows);
    $circularArray = array();

    //Call Circular Array function .. Result will be stored in $circularArray
    circularArray($arrayChunks,$circularArray);
    return $circularArray;
}

/*
Loop arrayChunk in following order
1\. Fetch first item from each chunks
2\. Fetch all items from last chunk and remove that array from arrayChunk
3\. Reverse elements in each remaining chunk
4\. Reverse entire arrayChunk array
5\. Repeat above 4 steps until $arrayChunks is empty
*/
function circularArray(&$arrayChunks, &$circularArray)
{
    if(empty($arrayChunks))
    {
        return true;
    }

    //1\. Fetch first item from each chunks
    foreach($arrayChunks as &$arrayChunk)
    {
        $circularArray[] = array_shift($arrayChunk);
    }

    //Fetch Last Chunk from array
    $lastChunk = array_pop($arrayChunks);

    //2\. Fetch all items from last chunk and remove that array from arrayChunk
    foreach($lastChunk as $chunkElement)
    {
        $circularArray[] = $chunkElement;
    }

    //3\. Reverse elements in each remaining chunk
    foreach($arrayChunks as &$arrayChunk)
    {  
        if (is_array($arrayChunk))
        {    
            $arrayChunk = array_reverse($arrayChunk);
        }
    }

    $arrayChunks = array_reverse($arrayChunks);

    return circularArray(&$arrayChunks, &$circularArray);
} 
```

例如

```
$array = range(1, 25);
$circularArray = circularSort($array); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:45:03.993

O(n) 中的另一种方法：

```
<?php
function circ_sort ($inArray) {

    $rowSize = pow(count($inArray), 0.5);
    if((int)$rowSize != $rowSize) {
        throw new InvalidArgumentException();
    }
    $rowSize = (int)$rowSize;

    $round =-1;
    for ($x =-1, $y=0, $count =0; $count < count($inArray);) {

        if ($y > $x) {
            if ($x +1 == $y) {
                $direction = 'D';   //Down
                $round ++;
                $max_iter = $rowSize - (2 * $round);
            } else {
                $direction = 'L'; //Left
                $max_iter = $y - $x -1;
            }
        } else if ($x > $y) {
            $direction = 'R'; //Right
            $max_iter = $rowSize - (2 * $round) -1;

        } else if ($x == $y) {
            $direction = 'U'; //Up
            $max_iter = $rowSize - (2 * $round) -1;

        }

        switch ($direction) {
            case 'D':   //Down
                for ($iter =0; $iter < $max_iter; $iter++) {
                    $x++;
                    $circArray[] = $inArray[$x*$rowSize + $y];
                    $count++;
                }
                break;
            case 'R': //Right
                for ($iter =0; $iter < $max_iter; $iter++) {
                    $y++;
                    $circArray[] = $inArray[$x*$rowSize + $y];
                    $count++;
                }
                break;
            case 'U':   //Up
                for ($iter =0; $iter < $max_iter; $iter++) {
                    $x--;
                    $circArray[] = $inArray[$x*$rowSize + $y];
                    $count++;
                }
                break;
            case 'L':   //Left
                for ($iter =0; $iter < $max_iter; $iter++) {
                    $y--;
                    $circArray[] = $inArray[$x*$rowSize + $y];
                    $count++;
                }
                break;
        }
    }
    return ($circArray);
}

$array = range(1, 25);
$circ_array = circ_sort($array);

var_dump($circ_array);

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T16:58:42.917

我的解决方案：

诀窍是：第一次运行是 5，然后是 4 个元素的两个运行，3 个元素的两个，2 个元素的 2 个和 1 个元素的两个。(5,4,4,3,3,2,2,1,1) 在每次运行中，它都会增加一个状态模块 4。根据状态，运行会朝一个方向或另一个方向前进。

这是代码：

```
function circularSort(array $array) {
    $n2=count($array);
    $n=sqrt($n2);
    if((int)$n != $n) throw new InvalidArgumentException();

    $Result = Array();
    $run =$n; $dir=1;
    $x=0; $y=-1;
    $i=0;
    $st=0;
    while ($run) {
        while ($dir) {
            for ($j=0; $j<$run; $j++) {

                if ($st==0) $y++;
                if ($st==1) $x++;
                if ($st==2) $y--;
                if ($st==3) $x--;

                $p=$y * $n +$x;
                array_push($Result,$array[$p]);

            }
            $st = ($st +1) & 3;
            $dir--;
        }

        $dir=2;
        $run--;
    } 

    return $Result;
}

$a = range(1,25);
var_dump(circularSort($a)); 
```

# spring - Spring Test & Security：如何模拟身份验证？

> ID：15203485
> 
> 赞同：164
> 
> 时间：2013-03-04T14:11:35.410
> 
> 标签：spring, security, model-view-controller, testing, junit

我试图弄清楚如何对我的控制器的 URL 是否正确保护进行单元测试。以防万一有人更改并意外删除了安全设置。

我的控制器方法如下所示：

```
@RequestMapping("/api/v1/resource/test") 
@Secured("ROLE_USER")
public @ResonseBody String test() {
    return "test";
} 
```

我像这样设置了一个 WebTestEnvironment：

```
import javax.annotation.Resource;
import javax.naming.NamingException;
import javax.sql.DataSource;

import org.junit.Before;
import org.junit.runner.RunWith;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.web.FilterChainProxy;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration({ 
        "file:src/main/webapp/WEB-INF/spring/security.xml",
        "file:src/main/webapp/WEB-INF/spring/applicationContext.xml",
        "file:src/main/webapp/WEB-INF/spring/servlet-context.xml" })
public class WebappTestEnvironment2 {

    @Resource
    private FilterChainProxy springSecurityFilterChain;

    @Autowired
    @Qualifier("databaseUserService")
    protected UserDetailsService userDetailsService;

    @Autowired
    private WebApplicationContext wac;

    @Autowired
    protected DataSource dataSource;

    protected MockMvc mockMvc;

    protected final Logger logger = LoggerFactory.getLogger(this.getClass());

    protected UsernamePasswordAuthenticationToken getPrincipal(String username) {

        UserDetails user = this.userDetailsService.loadUserByUsername(username);

        UsernamePasswordAuthenticationToken authentication = 
                new UsernamePasswordAuthenticationToken(
                        user, 
                        user.getPassword(), 
                        user.getAuthorities());

        return authentication;
    }

    @Before
    public void setupMockMvc() throws NamingException {

        // setup mock MVC
        this.mockMvc = MockMvcBuilders
                .webAppContextSetup(this.wac)
                .addFilters(this.springSecurityFilterChain)
                .build();
    }
} 
```

在我的实际测试中，我尝试做这样的事情：

```
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;

import eu.ubicon.webapp.test.WebappTestEnvironment;

public class CopyOfClaimTest extends WebappTestEnvironment {

    @Test
    public void signedIn() throws Exception {

        UsernamePasswordAuthenticationToken principal = 
                this.getPrincipal("test1");

        SecurityContextHolder.getContext().setAuthentication(principal);        

        super.mockMvc
            .perform(
                    get("/api/v1/resource/test")
//                    .principal(principal)
                    .session(session))
            .andExpect(status().isOk());
    }

} 
```

我在这里捡到了这个：

*   [http://java.dzone.com/articles/spring-test-mvc-junit-testing](http://java.dzone.com/articles/spring-test-mvc-junit-testing)这里：
*   [http://techdive.in/solutions/how-mock-securitycontextholder-perfrom-junit-tests-spring-controller](http://techdive.in/solutions/how-mock-securitycontextholder-perfrom-junit-tests-spring-controller)或这里：
*   [如何JUnit测试@PreAuthorize注释及其由spring MVC控制器指定的spring EL？](https://stackoverflow.com/questions/5403818/how-to-junit-tests-a-preauthorize-annotation-and-its-spring-el-specified-by-a-s)

然而，如果仔细观察，这仅在不向 URL 发送实际请求时才有帮助，而仅在功能级别测试服务时才有用。在我的情况下，引发了“拒绝访问”异常：

```
org.springframework.security.access.AccessDeniedException: Access is denied
    at org.springframework.security.access.vote.AffirmativeBased.decide(AffirmativeBased.java:83) ~[spring-security-core-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.security.access.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:206) ~[spring-security-core-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:60) ~[spring-security-core-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) ~[spring-aop-3.2.1.RELEASE.jar:3.2.1.RELEASE]
        ... 
```

以下两条日志消息值得注意，基本上是说没有用户通过身份验证，表明设置`Principal`不起作用，或者它被覆盖了。

```
14:20:34.454 [main] DEBUG o.s.s.a.i.a.MethodSecurityInterceptor - Secure object: ReflectiveMethodInvocation: public java.util.List test.TestController.test(); target is of class [test.TestController]; Attributes: [ROLE_USER]
14:20:34.454 [main] DEBUG o.s.s.a.i.a.MethodSecurityInterceptor - Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@9055e4a6: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@957e: RemoteIpAddress: 127.0.0.1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2017-05-11T16:24:11.773

寻找答案我找不到任何既简单又灵活的方法，然后我找到了[Spring Security Reference](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-mockmvc)，我意识到有近乎完美的解决方案。AOP 解决方案通常是最适合测试的解决方案，Spring 为它提供了`@WithMockUser`,`@WithUserDetails`和`@WithSecurityContext`, 在这个工件中：

```
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-test</artifactId>
    <version>4.2.2.RELEASE</version>
    <scope>test</scope>
</dependency> 
```

在大多数情况下，`@WithUserDetails`收集我需要的灵活性和力量。

# @WithUserDetails 是如何工作的？

基本上，您只需要创建一个`UserDetailsService`包含您想要测试的所有可能用户配置文件的自定义。例如

```
@TestConfiguration
public class SpringSecurityWebAuxTestConfig {

    @Bean
    @Primary
    public UserDetailsService userDetailsService() {
        User basicUser = new UserImpl("Basic User", "user@company.com", "password");
        UserActive basicActiveUser = new UserActive(basicUser, Arrays.asList(
                new SimpleGrantedAuthority("ROLE_USER"),
                new SimpleGrantedAuthority("PERM_FOO_READ")
        ));

        User managerUser = new UserImpl("Manager User", "manager@company.com", "password");
        UserActive managerActiveUser = new UserActive(managerUser, Arrays.asList(
                new SimpleGrantedAuthority("ROLE_MANAGER"),
                new SimpleGrantedAuthority("PERM_FOO_READ"),
                new SimpleGrantedAuthority("PERM_FOO_WRITE"),
                new SimpleGrantedAuthority("PERM_FOO_MANAGE")
        ));

        return new InMemoryUserDetailsManager(Arrays.asList(
                basicActiveUser, managerActiveUser
        ));
    }
} 
```

现在我们的用户已经准备好了，想象一下我们要测试这个控制器函数的访问控制：

```
@RestController
@RequestMapping("/foo")
public class FooController {

    @Secured("ROLE_MANAGER")
    @GetMapping("/salute")
    public String saluteYourManager(@AuthenticationPrincipal User activeUser)
    {
        return String.format("Hi %s. Foo salutes you!", activeUser.getUsername());
    }
} 
```

在这里，我们有一个*映射*到路由**/foo/salute**`@Secured`的函数，我们正在使用注释测试基于角色的安全性，尽管您`@PreAuthorize`也可以进行测试`@PostAuthorize`。让我们创建两个测试，一个检查有效用户是否可以看到这个敬礼响应，另一个检查它是否真的被禁止。

```
@RunWith(SpringRunner.class)
@SpringBootTest(
        webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,
        classes = SpringSecurityWebAuxTestConfig.class
)
@AutoConfigureMockMvc
public class WebApplicationSecurityTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    @WithUserDetails("manager@company.com")
    public void givenManagerUser_whenGetFooSalute_thenOk() throws Exception
    {
        mockMvc.perform(MockMvcRequestBuilders.get("/foo/salute")
                .accept(MediaType.ALL))
                .andExpect(status().isOk())
                .andExpect(content().string(containsString("manager@company.com")));
    }

    @Test
    @WithUserDetails("user@company.com")
    public void givenBasicUser_whenGetFooSalute_thenForbidden() throws Exception
    {
        mockMvc.perform(MockMvcRequestBuilders.get("/foo/salute")
                .accept(MediaType.ALL))
                .andExpect(status().isForbidden());
    }
} 
```

如您所见，我们导入`SpringSecurityWebAuxTestConfig`以提供我们的用户进行测试。每一个都在其对应的测试用例上使用，只需使用简单的注释，减少代码和复杂性。

# 更好地使用 @WithMockUser 以获得更简单的基于角色的安全性

如您所见`@WithUserDetails`，它具有大多数应用程序所需的所有灵活性。它允许您使用具有任何 GrantedAuthority 的自定义用户，例如角色或权限。但是，如果您只是使用角色，测试会更容易，并且您可以避免构建自定义`UserDetailsService`. [在这种情况下，使用@WithMockUser](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-method-withmockuser)指定用户、密码和角色的简单组合。

```
@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@WithSecurityContext(
    factory = WithMockUserSecurityContextFactory.class
)
public @interface WithMockUser {
    String value() default "user";

    String username() default "";

    String[] roles() default {"USER"};

    String password() default "password";
} 
```

注释为非常基本的用户定义了默认值。在我们的例子中，我们正在测试的路由只要求经过身份验证的用户是管理员，我们可以退出使用`SpringSecurityWebAuxTestConfig`并执行此操作。

```
@Test
@WithMockUser(roles = "MANAGER")
public void givenManagerUser_whenGetFooSalute_thenOk() throws Exception
{
    mockMvc.perform(MockMvcRequestBuilders.get("/foo/salute")
            .accept(MediaType.ALL))
            .andExpect(status().isOk())
            .andExpect(content().string(containsString("user")));
} 
```

请注意，现在我们得到的不是用户**manager@company.com**`@WithMockUser`提供的默认值：**user** ; 但这并不重要，因为我们真正关心的是他的角色：`ROLE_MANAGER`。

# 结论

正如您所看到的注释`@WithUserDetails`，`@WithMockUser`我们可以*在不同的经过身份验证的用户场景之间切换，*而无需构建与我们的架构疏远的类，只是为了进行简单的测试。它还建议您查看[@WithSecurityContext](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-method-withsecuritycontext)如何工作以获得更大的灵活性。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2017-11-30T13:51:27.853

从 Spring 4.0+ 开始，最好的解决方案是使用 @WithMockUser 注释测试方法

```
@Test
@WithMockUser(username = "user1", password = "pwd", roles = "USER")
public void mytest1() throws Exception {
    mockMvc.perform(get("/someApi"))
        .andExpect(status().isOk());
} 
```

请记住将以下依赖项添加到您的项目中

```
'org.springframework.security:spring-security-test:4.2.3.RELEASE' 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2013-03-04T14:11:35.410

事实证明，`SecurityContextPersistenceFilter`作为 Spring Security 过滤器链的一部分，总是重置 my `SecurityContext`，我设置调用`SecurityContextHolder.getContext().setAuthentication(principal)`（或使用`.principal(principal)`方法）。这个过滤器设置了`SecurityContext`一个`SecurityContextHolder`从`SecurityContext`一个`SecurityContextRepository` **覆盖**我之前设置的一个。默认情况下，存储库是一个`HttpSessionSecurityContextRepository`。`HttpSessionSecurityContextRepository`检查给定的并`HttpRequest`尝试访问相应的`HttpSession`. 如果存在，它将尝试`SecurityContext`从`HttpSession`. 如果失败，存储库会生成一个空的`SecurityContext`.

因此，我的解决方案是将 a`HttpSession`与请求一起传递，其中包含`SecurityContext`：

```
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Test;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;

import eu.ubicon.webapp.test.WebappTestEnvironment;

public class Test extends WebappTestEnvironment {

    public static class MockSecurityContext implements SecurityContext {

        private static final long serialVersionUID = -1386535243513362694L;

        private Authentication authentication;

        public MockSecurityContext(Authentication authentication) {
            this.authentication = authentication;
        }

        @Override
        public Authentication getAuthentication() {
            return this.authentication;
        }

        @Override
        public void setAuthentication(Authentication authentication) {
            this.authentication = authentication;
        }
    }

    @Test
    public void signedIn() throws Exception {

        UsernamePasswordAuthenticationToken principal = 
                this.getPrincipal("test1");

        MockHttpSession session = new MockHttpSession();
        session.setAttribute(
                HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, 
                new MockSecurityContext(principal));

        super.mockMvc
            .perform(
                    get("/api/v1/resource/test")
                    .session(session))
            .andExpect(status().isOk());
    }
} 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-05-14T14:57:04.637

在 pom.xml 中添加：

```
 <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-test</artifactId>
        <version>4.0.0.RC2</version>
    </dependency> 
```

并`org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestPostProcessors`用于授权请求。[请参阅https://github.com/rwinch/spring-security-test-blog](https://github.com/rwinch/spring-security-test-blog) ( [https://jira.spring.io/browse/SEC-2592](https://jira.spring.io/browse/SEC-2592) )上的示例用法。

更新：

4.0.0.RC2 适用于 spring-security 3.x。对于 spring-security 4 spring-security-test 成为 spring-security 的一部分（[http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test)，版本相同）。

设置已更改：[http ://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-mockmvc](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-mockmvc)

```
public void setup() {
    mvc = MockMvcBuilders
            .webAppContextSetup(context)
            .apply(springSecurity())  
            .build();
} 
```

基本身份验证示例： http: [//docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#testing-http-basic-authentication](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#testing-http-basic-authentication)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-02-25T02:09:37.303

这是一个示例，供那些想要使用 Base64 基本身份验证测试 Spring MockMvc 安全配置的人使用。

```
String basicDigestHeaderValue = "Basic " + new String(Base64.encodeBase64(("<username>:<password>").getBytes()));
this.mockMvc.perform(get("</get/url>").header("Authorization", basicDigestHeaderValue).accept(MediaType.APPLICATION_JSON)).andExpect(status().isOk()); 
```

Maven 依赖

```
 <dependency>
        <groupId>commons-codec</groupId>
        <artifactId>commons-codec</artifactId>
        <version>1.3</version>
    </dependency> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-11-02T07:32:06.287

**简短的回答：**

```
@Autowired
private WebApplicationContext webApplicationContext;

@Autowired
private Filter springSecurityFilterChain;

@Before
public void setUp() throws Exception {
    final MockHttpServletRequestBuilder defaultRequestBuilder = get("/dummy-path");
    this.mockMvc = MockMvcBuilders.webAppContextSetup(this.webApplicationContext)
            .defaultRequest(defaultRequestBuilder)
            .alwaysDo(result -> setSessionBackOnRequestBuilder(defaultRequestBuilder, result.getRequest()))
            .apply(springSecurity(springSecurityFilterChain))
            .build();
}

private MockHttpServletRequest setSessionBackOnRequestBuilder(final MockHttpServletRequestBuilder requestBuilder,
                                                             final MockHttpServletRequest request) {
    requestBuilder.session((MockHttpSession) request.getSession());
    return request;
} 
```

从 spring 安全测试执行后`formLogin`，您的每个请求都将被自动调用为登录用户。

**长答案：**

检查这个解决方案（答案是spring 4）：[How to login a user with spring 3.2 new mvc testing](https://stackoverflow.com/questions/14308341/how-to-login-a-user-with-spring-3-2-new-mvc-testing/47069613#47069613)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-04T17:38:25.650

避免在测试中使用 SecurityContextHolder 的选项：

*   **选项 1**：使用模拟 - 我的意思是`SecurityContextHolder`使用一些模拟库进行模拟 -例如*EasyMock*
*   **选项 2**：在您的代码中包装调用`SecurityContextHolder.get...`某些服务 - 例如在实现接口`SecurityServiceImpl`的方法中，然后在您的测试中，您可以简单地创建此接口的模拟实现，该接口返回所需的主体而无需访问.`getCurrentPrincipal``SecurityService``SecurityContextHolder`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-12-04T16:50:14.863

虽然很晚的答案。但这对我有用，并且可能有用。

在使用 Spring Security 和 mockMvc 时，您只需使用 @WithMockUser 注释，就像提到的其他注释一样。

Spring security 还提供了另一个注释，称为**`@WithAnonymousUser`**测试未经身份验证的请求。但是，您应该在这里小心。你会期待 401，但默认情况下我得到 403 Forbidden Error。在实际场景中，当您运行实际服务时，它会被重定向，最终您会得到正确的 401 响应代码。匿名请求使用此注解。

您也可以考虑省略注释并简单地保持未经授权。但这通常会引发正确的异常（如 AuthenticationException），但如果处理正确（如果您使用自定义处理程序），您将获得正确的状态代码。我曾经为此得到500。所以寻找调试器中引发的异常，检查是否处理正确并返回正确的状态码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-05T12:58:39.143

`TestUserDetailsImpl`在您的测试包上创建一个类：

```
@Service
@Primary
@Profile("test")
public class TestUserDetailsImpl implements UserDetailsService {
    public static final String API_USER = "apiuser@example.com";

    private User getAdminUser() {
        User user = new User();
        user.setUsername(API_USER);

        SimpleGrantedAuthority role = new SimpleGrantedAuthority("ROLE_API_USER");
        user.setAuthorities(Collections.singletonList(role));

        return user;
    }

    @Override
    public UserDetails loadUserByUsername(String username) 
                                         throws UsernameNotFoundException {
        if (Objects.equals(username, ADMIN_USERNAME))
            return getAdminUser();
        throw new UsernameNotFoundException(username);
    }
} 
```

休息端点：

```
@GetMapping("/invoice")
@Secured("ROLE_API_USER")
public Page<InvoiceDTO> getInvoices(){
   ...
} 
```

测试端点：

```
@Test
@WithUserDetails("apiuser@example.com")
public void testApi() throws Exception {
     ...
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-12T22:38:57.197

使用时`MockMvcBuilders.webAppContextSetup(wac).addFilters(...)`比`springSecurityFilterChain`（更具体地说`SecurityContextPersistenceFilter`）将接管并删除`SecurityContext`由`@WithMockUser`（相当愚蠢）准备的；发生这种情况是因为`SecurityContextPersistenceFilter`试图`SecurityContext`从`HttpSession`找不到的地方“恢复”。好吧，使用`AutoStoreSecurityContextHttpFilter`下面定义的这个简单的定义，它将负责将`@WithMockUser`' 准备好`SecurityContext`放入`HttpSession`这样以后`SecurityContextPersistenceFilter`才能找到它的地方。

```
@ContextConfiguration(...) // the issue doesn't occur when using @SpringBootTest
public class SomeTest {
    @Autowired
    private Filter springSecurityFilterChain;
    private MockMvc mockMvc;

    @BeforeEach
    void setup(WebApplicationContext wac) {
        this.mockMvc = MockMvcBuilders.webAppContextSetup(wac)
                .addFilters(new AutoStoreSecurityContextHttpFilter(), springSecurityFilterChain).build();
    }

    @WithMockUser
    @Test
    void allowAccessToAuthenticated() {
        ...
    }
}

// don't use this Filter in production because it's only intended for tests, to solve the 
// @WithMockUser & springSecurityFilterChain (more specifically SecurityContextPersistenceFilter) "misunderstandings"
public class AutoStoreSecurityContextHttpFilter extends HttpFilter {
    protected void doFilter(HttpServletRequest req, HttpServletResponse res, FilterChain chain) throws IOException, ServletException {
        req.getSession().setAttribute(HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, SecurityContextHolder.getContext());
        super.doFilter(req, res, chain);
    }
} 
```

# python - 在二进制文件中查找字节对位置以使用 Python 进行编辑

> ID：15203490
> 
> 赞同：0
> 
> 时间：2013-03-04T14:11:47.667
> 
> 标签：python, binary, jpeg, edit

我有以二进制格式存储的 jpeg 图像。需要编辑这些二进制文件以删除之前的所有字节对`0xff 0xd8`（因为这是我的 jpeg 的初始部分）。原因是当我尝试在图像程序中查看这些文件时，只要我不摆脱在这个`0xff 0xd8`字节之前的所有字节数组部分，它们就不会打开。这是我到目前为止所尝试的：

```
data= open ('C:/Users/Umberto/Desktop/_BR_Browse.001_2065642654_1.BINARY', 'rb+')
edit= str (data.read () )
data.close ()
edit.find ('/xff/xd8') 
```

但我总是收到'-1'作为索引，无论我使用“find”方法作为参数。代码有什么问题？一旦我知道 的位置`/xff/xd8`，我就会以某种方式简单地删除它之前的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:15:45.573

你的逃跑方式是错误的。尝试`edit.find('\xff\xd8')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:18:07.597

这条线的问题：

```
edit.find ('/xff/xd8') 
```

使用 '\' 而不是 '/'

```
edit.find ('\xff\xd8') 
```

更多信息： [Python：搜索/读取二进制数据](https://stackoverflow.com/questions/3217334/python-searching-reading-binary-data)

# android - 获取视频视图的位图

> ID：15203491
> 
> 赞同：1
> 
> 时间：2013-03-04T14:11:49.203
> 
> 标签：android, bitmap, android-videoview

有没有办法截取在视频视图中播放的视频的屏幕截图。我在论坛上搜索但无法获得所需的信息。我试过了

```
 Bitmap bitmap = Bitmap.createBitmap(this.view.getWidth(), this.view.getHeight(), Config.ARGB_8888);
            Canvas canvas = new Canvas(bitmap);
            view.draw(canvas); 
```

和

```
mCustomVideoView.setDrawingCacheEnabled(true);
Bitmap videoView = mCustomVideoView.getDrawingCache(false); 
```

但是这些方法都没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-03-14T19:04:27.380

只要做到这一点：

```
videoview.buildDrawingCache();

Bitmap bitmap = yourvideoview.getDrawingCache(); 
 java.io.ByteArrayOutputStream stream=new java.io.ByteArrayOutputStream();  

bitmap.compress(Bitmap.CompressFormat.WEBP, 90, stream); 

byte[] videoByteArray=stream.toByteArray(); String video_str = Base64.encodeToString(videoByteArray, 0); 
```

输出是字符串 video_str 和 Bitmap 位图。

# firebreath - 无法使用 Visual Studio 调试 FireBreath 插件 API

> ID：15203492
> 
> 赞同：1
> 
> 时间：2013-03-04T14:11:49.413
> 
> 标签：firebreath

我已尝试上述**步骤**来调试我的 FB 插件，但无法在插件 API 中设置断点。

**步骤**：

1) 在加载我的 FB 插件的 Firefox 浏览器上启动“示例页面”。

2) 在 Visual Studio 2008 中转到调试 ->“附加到进程”。

3) 附加标题为“示例页面”的 FireFox.exe 进程。

4) 无法在插件 API 中设置断点，因为我的插件 DLL 符号未在 Visual Studio 中加载。

我不确定为什么我的插件 DLL 符号没有加载。请帮帮我。

注意：FB 插件是在调试模式下构建的。

谢谢你，桑德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:09:01.457

您的问题是 firefox 在单独的进程中运行插件；我认为它被称为 plugin_container.exe

更多关于[FireBreath 的调试插件页面的信息](http://www.firebreath.org/display/documentation/Debugging+Plugins)

# javascript - 在 Javascript 中声明和填充多维数组的有效方法

> ID：15203495
> 
> 赞同：2
> 
> 时间：2013-03-04T14:11:56.540
> 
> 标签：javascript, multidimensional-array

在 JavaScript 中声明和填充多维数组的最有效方法是什么？

我目前正在这样做：

```
ff = Array();
for (i = 0; i < 30; i++) {
    ff[i] = Array();
    ff[i][i] = 1.0;
}

ff[1][2] = 0.041666667;
ff[1][3] = 0.000694444;
ff[2][3] = 0.016666667;
ff[1][4] = 0.000011574;
ff[2][4] = 0.000277778;
ff[3][4] = 0.016666667;
ff[1][5] = 0.000011574;
ff[2][5] = 0.000035315;
ff[3][5] = 0.00211888;
ff[4][5] = 0.1271328;
ff[1][6] = 0.000000025;
ff[2][6] = 0.000000589;
ff[3][6] = 0.000035315;
ff[4][6] = 0.00211888;
ff[5][6] = 0.016666667; 
```

最多可以`ff[n][n]`达到`n`30 行，这会导致数百行声明数组值（这是否重要，即使在缩小时也是如此？）。我只需要填充数组的“顶部”一半，因为`ff[n][n] = 1`在`ff[i][j] = 1/(ff[j][i])`声明之后我循环整个数组并反转“顶部”一半以填充“底部”一半。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:32:27.220

从您的数字来看，您似乎正在尝试在各种时间单位之间进行转换。

我想知道是否更合适的对象不会成为对象。

```
var seconds = {
  day:   86400,
  hour:   3600,
  minute:   60,
  second:    1
};

var conversions = {};

['day','minute','hour','second'].forEach(function(fromUnit){
  var subConversions = {};
  var fromValue = seconds[fromUnit];
  ['day','minute','hour','second'].forEach(function(toUnit){
    subConversions[toUnit] = fromValue / seconds[toUnit];
  });
  conversions[fromUnit] = subConversions;
});

function convert(value, from, to){
  return value * conversions[from][to];
} 
```

这会给你。

> 转换（1，“天”，“小时”）=== 24
> 
> 转换（1，'天'，'秒'）=== 86400
> 
> 转换（3，'小时'，'秒'）=== 10800

即使事情比简单的时间转换更复杂，这种方法也可能会导致更易于理解的代码。一旦你开始为多维数组的元素赋予特殊含义，事情就会变得非常丑陋。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:22:38.640

我会做类似以下的事情：然后我会将脚本放在一个可以缓存的单独文件中。

```
ff=[];
ff[0]=[0.041666667,000694444,016666667,000277778,016666667];
ff[1]=[0.041666667,000694444,016666667,000277778,016666667];
ff[2]=[0.041666667,000694444,016666667,000277778,016666667];
ff[3]=[0.041666667,000694444,016666667,000277778,016666667];
ff[4]=[0.041666667,000694444,016666667,000277778,016666667];
ff[5]=[0.041666667,000694444,016666667,000277778,016666667]; 
```

# intellij-idea - IntelliJ IDEA：将 shell 脚本作为运行/调试配置运行

> ID：15203498
> 
> 赞同：119
> 
> 时间：2013-03-04T14:12:08.200
> 
> 标签：intellij-idea

有没有一种方法可以从 IntelliJ 运行/调试配置中调用 shell 脚本？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-03-04T15:54:25.377

我刚刚发现我们可以在**[BashSupport](http://plugins.jetbrains.com/plugin/4230?pr=phpStorm)**插件的帮助下调用一个 shell 脚本。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2013-11-20T19:35:46.853

“启动前”中的“添加外部工具”可以解决问题。

截屏

![编辑工具添加shell脚本](../Images/96ad1064cd4a23457b10ec53b013e314.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-09-11T10:17:47.007

# IntelliJ IDEA 2019.2 更新

新版本的 IntelliJ IDEA 包含了**Shell 脚本支持**。这意味着您现在可以为您的项目创建*Shell 脚本构建*。

`Edit Configurations` **>** `(+) Add New Configuration` **>** `Shell Script`

*您还可以通过添加运行另一个配置*任务在执行脚本之前构建您的项目。这就是它的样子：[添加 Shell 构建窗口](https://i.stack.imgur.com/SKkL8.jpg)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-03-04T14:20:40.790

不确定 11，但在 12 中有一部分运行/调试配置称为“启动前”，您可以在“添加外部工具”选项中选择您的 shell 脚本。

# search - 支持对字符串进行快速starts_with和like操作的数据结构

> ID：15203500
> 
> 赞同：0
> 
> 时间：2013-03-04T14:12:13.723
> 
> 标签：search, data-structures

你能建议我一些数据结构来存储大约 100000 个字母数字字符串吗？每个字符串都有一个与之关联的整数 X。它应该有效支持的操作是：

`starts_with(String s)`

.

## 其他操作：

DataEntry 结构（你已经猜到了）

```
 {
    string s;
    int x;
 } 
```

# express - 如何在 Express.js 子应用中使用 socket.io？

> ID：15203503
> 
> 赞同：2
> 
> 时间：2013-03-04T14:12:18.353
> 
> 标签：express, socket.io

因为 socket.io 依赖于服务器对象，而子应用程序没有自己的服务器，所以我想知道您将如何做到这一点？

我希望可能有一个 app.on('start') 事件可以访问服务器对象，但看起来情况并非如此。

# android - Android - setAdapter ViewPager 上的 NullPointerException

> ID：15203511
> 
> 赞同：1
> 
> 时间：2013-03-04T14:12:42.330
> 
> 标签：android, android-fragments, android-viewpager, android-fragmentactivity

我有一个小问题。我正在尝试使用片段创建布局，但是当我调用该`setAdapter`方法时，我有一个 Java `NullPointerException`，但找不到错误。谢谢大家！

**班级代码**

```
public class Agenda extends FragmentActivity{

PagerAdapter mPagerAdapter;

ViewPager mViewPager;

protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.agenda_sw);

    mPagerAdapter = new PagerAdapter(getSupportFragmentManager());

    // Set up the ViewPager with the sections adapter.
    mViewPager = (ViewPager) findViewById(R.id.agendaPager);

    mViewPager.setAdapter(mPagerAdapter); //Line 32, the error is on this line.

} 
```

**xml代码**

```
<android.support.v4.view.ViewPager
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/agenda_sw"
android:layout_width="match_parent"
android:layout_height="match_parent" 
/> 
```

**日志猫**

```
03-04 11:06:14.686: E/AndroidRuntime(1356): FATAL EXCEPTION: main
03-04 11:06:14.686: E/AndroidRuntime(1356): java.lang.RuntimeException: Unable to start activity ComponentInfo{conf.main/conf.main.Agenda}: java.lang.NullPointerException
...
03-04 11:06:14.686: E/AndroidRuntime(1356): Caused by: java.lang.NullPointerException
03-04 11:06:14.686: E/AndroidRuntime(1356): at conf.main.Agenda.onCreate(Agenda.java:32) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:17:11.607

错误的浏览器 ID。你在 xml 中写道：

```
android:id="@+id/agenda_sw" 
```

但在代码中，您可以找到 R.id.agendaPager 并且应该找到 R.id.agenda_sw。

# c# - 与 DataGrid asp.net 中的 ItemCommand 事件相关的问题

> ID：15203512
> 
> 赞同：1
> 
> 时间：2013-03-04T14:12:48.947
> 
> 标签：c#, asp.net

我的 asp.net 应用程序在 aspx 页面上有 DataGrid，有一些自动生成的列：

我在网格上绑定了 ItemCommand 事件，如下所示：

```
 protected void DataGrid2_ItemCommand(object sender, System.Web.UI.WebControls.DataGridCommandEventArgs e)
        {
            if (e.CommandName == "CheckInventoryAndPrice")
            {

                string itemMainPageLink = E2WConstants.Pages.ITEM_MAIN;
                string itemId = (DataRowView)e.Item.DataItem).Row["ItemId"].ToString();

                //Response.Redirect();
            }
        } 
```

但我总是得到 DataItem Null：那么我怎样才能得到选定行的单元格的值？

谢谢..

# php - 带有 FOSUserBundle 的 Symfony2 - 重定向在控制器中不起作用

> ID：15203522
> 
> 赞同：0
> 
> 时间：2013-03-04T14:13:15.107
> 
> 标签：php, symfony, fosuserbundle

我的默认控制器将路由“ `/`”设置为运行索引：

```
public function indexAction() {
    if ($this->get('security.context')->isGranted('IS_AUTHENTICATED_FULLY')) {
        //render the logged in view(s)
        $response = $this->render('Pan100MoodLogBundle:Default:index.html.twig');
    } else {
        //redirect to the login controller
        $response = $this->redirect($this->generateUrl('login'));
    }
    return $response;
} 
```

但是 Symfony 找不到路径：

> 路由“登录”不存在。500 内部服务器错误 - RouteNotFoundException

有什么问题？我正在使用 FOSUserBundle。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-26T17:53:12.480

如果你输入

```
php app/console router:debug 
```

你会看到你所有的申请路线。

随着`php app/console router:debug | grep login`，它显示：

```
fos_user_security_login               ANY      /login
fos_user_security_check               ANY      /login_check 
```

所以试试

```
$response = $this->redirect($this->generateUrl('fos_user_security_login')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:27:53.873

您可以重定向到`fos_user_security_login`

```
$response = $this->redirect($this->generateUrl('fos_user_security_login')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T16:19:52.807

看起来，您没有名为“登录”的路线。你必须在你的 route.yml|xml 文件中创建它，但你不必指定控制器，因为 FOS 会处理它，就像在 yml 中这样：

```
login:
    pattern: /login 
```

编辑：对不起，我的错误，当然不是布局，登录。但是你在岸上，路线已经加载了吗？原因 generateUrl 需要一个路由名称。

# jquery - jQuery 验证插件在 jQuery UI 模式窗口中不起作用

> ID：15203525
> 
> 赞同：0
> 
> 时间：2013-03-04T14:13:20.950
> 
> 标签：jquery, jquery-ui, jquery-validate

我正在尝试在 jQuery UI 模式框中验证表单，但看起来 jQuery Validation 不想使用模式窗口，或者我真的不知道在哪里放置此验证代码。

`$("#create_form").validate`当我在`$document.ready(`.

```
<!doctype html>
    <html lang="en">
    <head>
    <meta charset="utf-8" />
    <title>jQuery UI Dialog - Modal form</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css" />

    <script>

$(function() {

     $( "#dialog-form" ).dialog({
         autoOpen: false,
         height: 500,
         width:  400,
         modal: true,

         buttons: {

            Submit: function() { 

                $("#create_form").validate({

                    //submitHandler: function(form) {
                    //  doAjaxPost();
                    //},

                    rules:{
                        name:{
                            required: true,
                            minlength: 3,
                            maxlength: 16,
                        },
                        password:{
                            required: true,
                            minlength: 3,
                            maxlength: 16,
                        }, 

                   },
                   messages:{
                        name:{
                            required: "Login - is a mandatory field",
                            minlength: "Name should contain minimum {0} symbols",
                            maxlength: "Maximum symbols - {0}",
                        },
                        password:{
                            required: "Password - is a mandatory field",
                            minlength: "Password should contain minimum {0} symbols",
                            maxlength: "Password should contain maximum {0} symbols",
                        },

                   },

                });

                //$( this ).dialog( "close" );
            },

            Cancel: function() {
                $( this ).dialog( "close" );
            }
         },
         //close: function() {
         //allFields.val( "" ).removeClass( "ui-state-error" );
         //}
 });

     $( "#create-user" )
     .button()
     .click(function() {
     $( "#dialog-form" ).dialog( "open" );
     });

});

</script>

</head>
<body>

<!-- Create user form -->
<div id="dialog-form" title="Create new user">
<p class="validateTips">All form fields are required.</p>
<form id="create_form">
<fieldset>
<label for="name">Name</label>
<input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
<label for="email">Email</label>
<input type="text" name="email" id="email" value="" class="text ui-widget-content ui-corner-all" />
<label for="password">Password</label>
<input type="password" name="password" id="password" value="" class="text ui-widget-content ui-corner-all" />
</fieldset>
</form>
</div>

<div id="users-contain" class="ui-widget">
<h1>Existing Users:</h1>
<table id="users" class="ui-widget ui-widget-content">
<thead>
<tr class="ui-widget-header ">
<th>Name</th>
<th>Email</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>John Doe</td>
<td>john.doe@example.com</td>
<td>johndoe1</td>
</tr>
</tbody>
</table>
</div>
<button id="create-user">Create new user</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:50:25.673

我看到你已经把对话框`.validate()`的按钮放在里面了。`submit`

[`.validate()`是*初始化*插件](http://docs.jquery.com/Plugins/Validation/validate#options)的代码。你应该只把它放在准备好的 DOM 中，与任何其他 jQuery 插件没有太大区别。即使您已经说过，*“`$("#create_form").validate`当我在其中使用它时，功能运行良好`$document.ready`”*

将它放回 DOM 中，准备好它所属的位置。我只是在模态框内`$("#create_form").submit()`的`Submit`按钮代码中添加了一行，它工作正常。

**工作演示：http: [//jsfiddle.net/7bA8M/](http://jsfiddle.net/7bA8M/)**

```
$(document).ready(function() {

    $("#create_form").validate({
        /*submitHandler: function(form) {
            doAjaxPost();
        },*/
        rules: {
            name: {
                required: true,
                minlength: 3,
                maxlength: 16
            },
            password: {
                required: true,
                minlength: 3,
                maxlength: 16
            }
        },
        messages: {
            name: {
                required: "Login - is a mandatory field",
                minlength: "Name should contain minimum {0} symbols",
                maxlength: "Maximum symbols - {0}"
            },
            password: {
                required: "Password - is a mandatory field",
                minlength: "Password should contain minimum {0} symbols",
                maxlength: "Password should contain maximum {0} symbols"
            }
        }
    });

    $("#dialog-form").dialog({
        autoOpen: false,
        height: 500,
        width: 400,
        modal: true,
        buttons: {
            Submit: function () {
                $("#create_form").submit();
            },
            Cancel: function () {
                $(this).dialog("close");
            }
        }
    });

    $("#create-user").button().click(function () {
        $("#dialog-form").dialog("open");
    });

}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T14:22:00.627

您需要在结束 body 标记之前包含所有 JS 才能`document.ready()`触发您的函数。

这是一个例子：http: [//jsfiddle.net/ZgGZ3/3/](http://jsfiddle.net/ZgGZ3/3/)

# sql - Sql Server - 仅替换字符串中的第一个字符

> ID：15203526
> 
> 赞同：0
> 
> 时间：2013-03-04T14:13:22.407
> 
> 标签：sql, sql-server, sql-server-2008

如何仅替换字符串中的第一个零？例子：

```
string : '0000089001232100'
result:  '89001232100' 
```

我不能使用 SQL Server`REPLACE`函数，因为我不想替换所有的零。谢谢你：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:17:22.580

`select substring(ColumnName, patindex('%[^0]%',ColumnName), 10)`应该给你你需要的。

还要研究`RIGHT`and`LEFT`函数。它们分别从左侧或右侧剥去一根绳子。

如果您想使用，您可以使用（[http://msdn.microsoft.com/en-us/library/ms186323.aspx](http://msdn.microsoft.com/en-us/library/ms186323.aspx)`RIGHT` ）获取第一个“想要”字符的索引，然后使用该索引作为剥离点从你的功能。`CHARINDEX``RIGHT`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:16:33.840

如果字符串总是只有数字，你可以使用这个：

```
DECLARE @String VARCHAR(30)
SET @String = '0000089001232100'
SELECT CONVERT(VARCHAR(20),CONVERT(NUMERIC(20,0),@String)) 
```

# android - 滚动时调用 getView。

> ID：15203533
> 
> 赞同：2
> 
> 时间：2013-03-04T14:13:39.943
> 
> 标签：android

在我的自定义适配器中`listview`，我添加了这样的动画：

```
 View lastAddedItem = parent.getChildAt(0);  
        if(lastAddedItem != null)  {
            Animation a = AnimationUtils.loadAnimation(c, R.anim.push);
            lastAddedItem.startAnimation(a);
        } 
```

此代码将动画应用于列表中的第 0 个项目。当我滚动列表时也会应用此动画，当然列表必须在滚动时再次呈现，但是有什么办法可以防止这种情况发生吗？记住，记住这段代码在方法中`getView()`

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:22:37.577

如果您希望它在第 0 个项目上运行动画，您应该能够检查`position`附带的变量`getView()`。如果为 0，则在提供的`View`.

**编辑：**为每个评论添加了一个布尔标志。

```
boolean isFirstRun = true;

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if(convertView == null) {
        // init view
        ...
    } 
    // populate view
    ...

    if(position == 0 && isFirstRun) {
        isFirstRun = false;
        // do animation stuff to convertView
        // this will be the 0th item
        ...
    }
} 
```

# c# - Convert.ToDateTime：如何设置格式

> ID：15203534
> 
> 赞同：20
> 
> 时间：2013-03-04T14:13:45.217
> 
> 标签：c#, .net, datetime

我使用转换，如：

```
Convert.ToDateTime(value) 
```

但我需要将日期转换为“mm/yy”等格式。
我正在寻找这样的东西：

```
var format = "mm/yy";
Convert.ToDateTime(value, format) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-04T14:15:17.517

您可能应该使用其中一个[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/7ee1y0t7.aspx)或[`DateTime.TryParseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx)代替。它们允许您指定特定的格式。我个人更喜欢`Try`-versions，因为我认为它们会为错误情况生成更好的代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-04T14:15:30.843

如果`value`是`string`该格式的 a 并且您想将其转换为`DateTime`对象，则可以使用[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)静态方法：

```
DateTime.ParseExact(value, format, CultureInfo.CurrentCulture); 
```

例子：

```
string value = "12/12";
var myDate = DateTime.ParseExact(value, "MM/yy", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None);

Console.WriteLine(myDate.ToShortDateString()); 
```

结果：

```
2012-12-01 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T14:20:02.510

`DateTime`没有格式。该格式仅在您将 a`DateTime`转换为字符串时适用，这会隐含地在表单、网页等上显示值。

查看您在*哪里*显示 DateTime 并在那里设置格式（或者如果您需要其他指导，请修改您的问题）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-29T01:08:34.987

您可以使用 Convert.ToDateTime 是否显示在[How to convert a Datetime string to a currentculture datetime string](https://stackoverflow.com/questions/5590180/how-to-convert-a-datetime-string-to-a-current-culture-datetime-string/5590213#5590213)

```
DateTimeFormatInfo usDtfi = new CultureInfo("en-US", false).DateTimeFormat;

var result = Convert.ToDateTime("12/01/2011", usDtfi) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T21:30:39.637

这个怎么样：

```
 string test = "01-12-12";
    try{
         DateTime dateTime = DateTime.Parse(test);
         test = dateTime.ToString("dd/yyyy");
    }
    catch (FormatException exc)
    {
        MessageBox.Show(exc.Message);
    } 
```

其中 test 将等于“12/2012”

希望能帮助到你！

请阅读[这里](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。

# jquery - 用 css 类选择器覆盖 JQuery 类选择器

> ID：15203536
> 
> 赞同：0
> 
> 时间：2013-03-04T14:13:52.030
> 
> 标签：jquery, css, jquery-selectors, css-selectors

我有下一个 HTML 代码：

```
<ul data-role="listview" style="margin-top: 0;">
   <li>
      <a  data-bind="attr: {href: 'tel:' + person().officePhone}">
            <img class="PersonDetailsUlImage" src="/view/mobile/images/Icon_phone_36x36_drkgry.png" />
            <h6>Office</h6>
            <p data-bind="text: person().officePhone"></p>
      </a>
   </li>
</ul> 
```

在我的 CSS 文件中，我将“PersonDetailsUla”类设置为如下代码：

```
.PersonDetailsUla 
{
    padding: 0 0 0 50px;
} 
```

当我尝试查看我的 PersonDetailsUla 样式是否正常工作时，我看到 Jquery 正在覆盖并应用另一个类：

```
Class="PersonDetailsUla ui-link-inherit" 
```

是否有任何选项可以覆盖 ui-link-inherit 的填充但尽可能不具体？如果我将使用 ID 选择器，它会起作用，但我会尽量不那么具体。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:20:52.280

你试过`!important`吗？

```
padding: 10px !important; 
```

或者，您也可以使用更具体的选择器，如下所示：

```
.PersonDetailsUla.ui-link-inherit {
    padding: 10px;
} 
```

这会选择同时具有“personDetails”和“ui-link-inherit”类的所有元素，但它不像使用 ID 那样具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:31:31.750

创建一个新的 css 文件并将其包含**在**jquery css 文件之后，并在自定义样式表中定义您的样式以覆盖 jquery ui 样式。所以：

```
<!-- jQuery stylesheet-->
<link href="/Content/Styles/jquery-ui-1.8.14.css" media="screen" rel="Stylesheet" type="text/css" />
<!-- Your own custom stylesheet-->
<link href="/Content/Styles/Custom.css" media="screen" rel="Stylesheet" type="text/css" /> 
```

# c++ - 为什么 std::unique_ptr operator* 会抛出而 operator-> 不会抛出？

> ID：15203541
> 
> 赞同：35
> 
> 时间：2013-03-04T14:14:12.647
> 
> 标签：c++, c++11, language-lawyer

在 C++ 标准草案 (N3485) 中，它声明如下：

**20.7.1.2.4 unique_ptr 观察者 [unique.ptr.single.observers]**

```
typename add_lvalue_reference<T>::type operator*() const;

1 Requires: get() != nullptr.
2 Returns: *get().

pointer operator->() const noexcept;

3 Requires: get() != nullptr.
4 Returns: get().
5 Note: use typically requires that T be a complete type. 
```

可以看到`operator*`(dereference) 没有被指定为`noexcept`，可能是因为它会导致段错误，但随后`operator->`在同一个对象上被指定为`noexcept`。两者的要求相同，但异常规范有所不同。

我注意到它们有不同的返回类型，一个返回一个指针，另一个返回一个引用。这句话`operator->`实际上并没有取消引用任何东西吗？

事实是，`operator->`在任何类型的 NULL 指针上使用都会出现段错误（是 UB）。那么，为什么其中一个被指定为`noexcept`而另一个不是？

我确定我忽略了一些东西。

编辑：

看着`std::shared_ptr`我们有这个：

**20.7.2.2.5 shared_ptr 观察者 [util.smartptr.shared.obs]**

```
T& operator*() const noexcept;

T* operator->() const noexcept; 
```

这是不一样的？这与不同的所有权语义有什么关系吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-04T14:47:42.833

段错误在 C++ 的异常系统之外。如果取消引用空指针，则不会引发任何类型的异常（好吧，至少如果您遵守该`Require:`子句；有关详细信息，请参见下文）。

For `operator->`，它通常被简单地实现`return m_ptr;`（或`return get();`for `unique_ptr`）。如您所见，运算符本身不能抛出 - 它只是返回指针。没有取消引用，什么都没有。该语言有一些特殊的规则`p->identifier`：

`§13.5.6 [over.ref] p1`

> 如果存在并且运算符被重载决策机制（13.3）选择为最佳匹配函数，则表达式`x->m`被解释为类型`(x.operator->())->m`的类对象。`x``T``T::operator->()`

以上递归适用，最后必须产生一个指针，使用内置指针`operator->`。这使得智能指针和迭代器的用户可以简单地做`smart->fun()`而不必担心任何事情。

`Require:`规范部分的注释：这些表示先决条件。如果你没有遇到他们，你就是在调用 UB。

> 那么，为什么其中一个被指定为 noexcept 而另一个不是呢？

老实说，我不确定。似乎取消引用指针应该始终是`noexcept`，但是，`unique_ptr`允许您完全*更改*内部指针类型是什么（通过删除器）。现在，作为用户，您可以为`operator*`您的`pointer`类型定义完全不同的语义。也许它会即时计算事物？所有有趣的东西，可能会抛出。

* * *

> 查看 std::shared_ptr 我们有这个：

这很容易解释 -`shared_ptr`不支持上述对指针类型的自定义，这意味着内置语义*始终*适用 - 并且`*p`where `p`is`T*`根本不会抛出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-09T01:02:32.570

对于它的价值，这里有一点历史，以及事情是如何发展到现在的。

在 N3025 之前，`operator *`没有用 指定`noexcept`，但它的描述确实包含`Throws: nothing`. [N3025](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3025.html)中删除了此要求：

> 按照指示更改 [unique.ptr.single.observers] (834) [有关详细信息，请参阅备注部分]：
> 
> `typename add_lvalue_reference<T>::type operator*() const;`
> 1 - 需要：`get() !=` ~~0~~`nullptr`。
> 2 - 返回：`*get().`
> ~~3 - 抛出：没有。~~

以下是上述“备注”部分的内容：

> 在本文的评审过程中，如何正确指定 operator*、operator[] 和异构比较函数的操作语义引起了争议。[structure.specifications]/3 没有明确说明 Returns 元素（在没有新的等效于公式的情况下）是否指定效果。此外，如果另外提供了 Throws:-Nothing 元素，这是否允许这样的返回表达式通过异常退出尚不清楚（是否需要实现者捕获这些元素？）。为了解决这个冲突，为这些操作删除了任何现有的 Throws 元素，这至少与 [unique.ptr.special] 和标准的其他部分一致。这样做的结果是，我们现在隐式支持可能抛出的比较函数，但不支持齐次 == 和 !=，

同一篇论文还包含编辑 的定义的建议`operator ->`，但内容如下：

> `pointer operator->() const;`
> 4 - 要求：`get() !=` ~~0~~ nullptr。
> 5 - 返回：get()。
> 6 - 抛出：什么都没有。
> 7 - 注意：使用通常要求 T 是一个完整的类型。

就问题本身而言：归结为运算符本身与使用运算符的表达式之间的基本区别。

使用`operator*`时，运算符会取消引用指针，该指针可能会抛出。

使用`operator->`时，运算符本身只返回一个指针（不允许抛出）。然后在包含`->`. 取消引用指针的任何异常都发生在周围的表达式中，而不是运算符本身中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T19:07:35.920

坦率地说，这对我来说只是一个缺陷。从概念上讲，a->b 应该始终等价于 (*a).b，即使 a 是智能指针也是如此。但是如果 *a 不是 noexcept，则 (*a).b 不是，因此 a->b 不应该是。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-04T14:47:16.573

关于：

> 那是说 operator-> 实际上并没有取消引用任何东西吗？

`->`不，类型重载的标准评估`operator->`是：

```
a->b; // (a.operator->())->b 
```

即评估是递归定义的，当源代码包含 a`->`时，`operator->`应用产生另一个表达式，其`->`本身可以引用 a `operator->`...

关于整体问题，如果指针为 null，则行为未定义，并且缺少`noexcept`允许实现`throw`. 如果签名是，`noexcept`则实现不能`throw`（a`throw`将是对 的调用`std::terminate`）。

# c - 如何编译 APRON 的例子？

> ID：15203552
> 
> 赞同：0
> 
> 时间：2013-03-04T14:14:36.393
> 
> 标签：c, compilation

我正在尝试了解如何使用[APRON](http://apron.cri.ensmp.fr/library/)。

我想到的第一件事是在上面链接的“文档”部分中编译[C 示例](http://apron.cri.ensmp.fr/library/0.9.10/example1.c) 。

有人可以帮我吗？我没能理解如何编译这个例子

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:20:02.910

您需要该库的其余源代码，链接在该页面的底部，即：[http ://apron.cri.ensmp.fr/library/apron-0.9.9.tgz](http://apron.cri.ensmp.fr/library/apron-0.9.9.tgz)

# javascript - 使用 jquery 上传多个文件，有限制

> ID：15203557
> 
> 赞同：1
> 
> 时间：2013-03-04T14:14:47.620
> 
> 标签：javascript, jquery, html, file-upload

我正在尝试找到具有限制的多个文件上传的解决方案。

我创建了这个小提琴来展示我的想法。

[http://jsfiddle.net/8MzNs/](http://jsfiddle.net/8MzNs/)

在我的表单中使用 HTML

```
<ul id="file-list">
    <li class="file-box">Image 1</li>
    <li class="file-box">Image 2</li>
    <li class="file-box">Image 3</li>
    <li class="file-box">Image 4</li>
    <li class="file-box">Image 5</li>
</ul> 
```

代替：

```
<input type="file" name="file-1" />
<input type="file" name="file-2" />
<input type="file" name="file-3" />
<input type="file" name="file-4" />
<input type="file" name="file-5" /> 
```

但我找不到像这样有限制的解决方案。但我可能错过了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T07:36:16.687

我已经安装了 Uploadify，它运行良好，然后我将添加一个小脚本（jQuery/PHP），它会在添加图像时显示它们。

# base - 将长度为 12 的正整数转换为长度为 10 的唯一字母数字

> ID：15203558
> 
> 赞同：0
> 
> 时间：2013-03-04T14:14:49.517
> 
> 标签：base

可以通过从基数 10 进行基数转换来做到这一点吗？如果是这样，为了将生成的字符串的长度限制为最多 10 个字符，最好转换到哪个基础？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:18:20.267

十六进制将满足您的需求。

`999999999999`十六进制中最大的 12 位数字[`e8d4a50fff`](https://www.google.dk/search?q=999999999999+in+hex)只有十个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:21:22.950

以 10 为底的最大 12 个字符的数字是 999 999 999 999。

ruby 中的一个小片段显示，您可以用来确保有 10 个字符的字符串的最小基数是基数 16，或十六进制：

```
1.9.3-p194 :044 > 999999999999.to_s(15)
 => "1b02b766469" 
1.9.3-p194 :045 > 999999999999.to_s(15).length
 => 11 
1.9.3-p194 :046 > 999999999999.to_s(16)
 => "e8d4a50fff" 
1.9.3-p194 :047 > 999999999999.to_s(16).length
 => 10 
```

# javascript - 如何使用 JQuery Mobile 为外部 HTML 文件绑定事件“pageshow”

> ID：15203560
> 
> 赞同：0
> 
> 时间：2013-03-04T14:14:55.697
> 
> 标签：javascript, jquery-mobile

我正在使用 JQuery Mobile（1.3.0 版）开发一个网络应用程序。如果一个只有一个 HTML 文件，我可以将“pageshow”事件绑定到页面 div：

```
<!DOCTYPE HTML>
<html>
<head>
    <title>Funil de Vendas</title>
    <meta http-equiv="Content-type" name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <script src="lib/jquery-1.8.2.min.js"></script>
    <script src="lib/jquery.mobile-1.3.0.min.js"></script>

    <script>
        var nice = false;
        $(document).ready( function(){
            $("#other_page").bind('pageshow',function() {
                alert('The page was called!');
            });     
        });
    </script>       
</head>
<body>
        <div data-role="page" class="Page" id="home_page">
            <div data-role="content">
                <a data-role="button"  href="#other_page" data-inline="true" style="width:300px;">Iniciar</a>
            </div>
        </div>
    </div>  

    <div data-role="page" class="Page" id="other_page">
        <div data-role="content">
            ...
        </div>
        ...
        ...
        ...
    </div>
</body></html> 
```

如何使用多个 HTML 文件来做同样的事情。我无法绑定到页面，因为这个 div 在另一个 HTML 文件中。

```
<div data-role="page" class="Page" id="home_page">
    <div data-role="content">
        <a data-role="button"  href="other_page.html" data-inline="true" style="width:300px;">Iniciar</a>
    </div>
</div> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:39:30.073

这里有两种可能的方法：

**第一个解决方案。**如果您使用多个 HTML 文件并且所有这些文件都使用 ajax 加载（这是标准的 jQuery Mobile 页面加载方式）。在这种情况下，必须将所有 javascript 加载到第一个 html 文件中，因为 jQM 只会加载其他 html 文件的 BODY 内容。

## 例子 ：

**索引.html：**

```
 <!DOCTYPE html>
    <html>
    <head>
        <title>jQM Complex Demo</title>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script>    
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script>
                $(document).on('pagebeforeshow', '#index', function(){       
                        alert('This is a first page!');
                    });

                    $(document).on('pagebeforeshow', '#second', function(){       
                        alert('This is a second page!');                
                    }); 
        </script>
    </head>
    <body>
        <div data-role="page" id="index" data-theme="b">
            <div data-role="header" data-theme="a">
                <h3>First page</h3>
            </div>

            <div data-role="content">
                        <a data-role="button" id="some-btn" href="second.html">Open next page</a>                        
            </div>

            <div data-theme="a" data-role="footer" data-position="fixed">

            </div>
        </div>
    </body>
    </html> 
```

**第二个.html：**

```
 <div data-role="page" id="second" data-theme="b">
        <div data-role="header" data-theme="a">
            <h3>Second page</h3>
        </div>

        <div data-role="content">
                This is a second page
        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div> 
```

**第二种解决方案。**如果您有多个 HTML 文件，但您的所有页面都链接了具有 rel="external" 属性的链接，或者在应用程序级别打开了 ajax。在这种情况下，每个 html 页面都必须有自己的 HEAD 和 BODY。每个页面都必须有它自己的javascript。

## 例子 ：

**索引.html：**

```
 <!DOCTYPE html>
    <html>
    <head>
        <title>jQM Complex Demo</title>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script>    
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script>
                $(document).on('pagebeforeshow', '#index', function(){       
                        alert('This is a first page!');
                    });
        </script>
    </head>
    <body>
        <div data-role="page" id="index" data-theme="b">
            <div data-role="header" data-theme="a">
                <h3>First page</h3>
            </div>

            <div data-role="content">
                        <a data-role="button" id="some-btn" href="second.html" rel="external">Open next page</a>                         
            </div>

            <div data-theme="a" data-role="footer" data-position="fixed">

            </div>
        </div>
    </body>
    </html> 
```

**第二个.html：**

```
 <!DOCTYPE html>
    <html>
    <head>
        <title>jQM Complex Demo</title>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script>    
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script>
                    $(document).on('pagebeforeshow', '#second', function(){       
                        alert('This is a second page!');                
                    }); 
        </script>
    </head>
    <body>
        <div data-role="page" id="second" data-theme="b">
            <div data-role="header" data-theme="a">
                <h3>Second page</h3>
            </div>

            <div data-role="content">
                    This is a second page
            </div>

            <div data-theme="a" data-role="footer" data-position="fixed">

            </div>
        </div>
    </body>
    </html> 
```

# java - 使用对象属性之一比较两个对象列表

> ID：15203561
> 
> 赞同：2
> 
> 时间：2013-03-04T14:14:58.493
> 
> 标签：java

我有两个需要比较的对象列表。这些对象具有名称属性，我想检查一个具有该名称的对象是否存在于另一个列表中。

我遇到了 ListUtils.subtract 方法，但我只看到人们将它与 Int 或 String 等类型一起使用...

它可以与自定义对象类型一起使用吗？

编辑：

```
Myclass{
    private String name;
    public getName(){
        return this.name;
    }

} 
```

我有两个这种对象类型的列表：

```
List<MyClass> list1;
List<MyClass> list2; 
```

这些列表之一是使用一些 sql 查询创建的。另一个是创建检查服务器中的一些文件。这些列表中的对象数量可能相同，或者其中一个或另一个可能有更多对象。

有没有办法获取一个列表中但不在另一个列表中的对象？

像这样的东西：

```
List result = ListUtils.subract (list1,list2); 
```

但是使用名称属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:18:25.600

您可以将 ListUtils.subtract 与您的两个列表一起使用。要使其工作，您必须定义`equals`自定义类的方法以在且仅当两个对象的 name 属性相同时才返回 true。

~~也就是说，`ListUtils.substract`不要给你两个列表之间的交集。为此，您将使用`ListUtils.retainAll`. 您也可以简单地使用`List.retainAll`，但它会修改您的列表之一，而不是创建副本，因此您应该自己创建这样的副本。~~

编辑：所以你不想要交集，你真的想要一个减法。这种方式很好，只需像这样编写对象的等号：

```
bool equals(Object other) {
    if (other==null || !other instanceof MyClass) {
        return false;
    }
    return name.equals(other.name); // assume name is never null. You can check for that
} 
```

您也可以`Collection.removeAll`在您的列表中使用。

覆盖 并不总是可行的`equals`，例如，如果您有不同的场景要根据其他属性进行比较。在这种情况下，您可以使用`Comparator`and `Collections2.filter`from [Guava library](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Collections2.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:30:29.603

您还可以使用比较器和比较器。这是一个示例[http://www.digizol.com/2008/07/java-sorting-comparator-vs-comparable.html](http://www.digizol.com/2008/07/java-sorting-comparator-vs-comparable.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:25:32.340

使对象实现[`Comparable`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html)。在`compareTo()`方法中，根据名称属性进行比较。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-04T14:25:24.373

答案是no rtf 为什么不用google自己找 为什么不用ide给你看文档

我认为覆盖等于解决问题，但这是一个黑客

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Main {

    public static void main(String arg[]) {
        ArrayList<Dog> firstGroup = new ArrayList<Dog>();

        firstGroup.add(new Dog("Rintintin"));
        firstGroup.add(new Dog("Courage"));
        firstGroup.add(new Dog("Scooby-Dooby-Do"));

        ArrayList<Dog> secondGroup = new ArrayList<Dog>();

        secondGroup.add(new Dog("fido"));
        secondGroup.add(new Dog("Courage"));
        secondGroup.add(new Dog("Rintintin"));

        List<Dog> filterByName = filterByName(firstGroup,secondGroup);

        System.out.print(Arrays.toString(filterByName.toArray()));
    }

    private static List<Dog> filterByName(ArrayList<Dog> firstGroup, ArrayList<Dog> secondGroup) {
        List<Dog> result=new ArrayList<>();
        for (Dog orginal : firstGroup) 
            for (Dog finDog : secondGroup) 
                if(orginal.getName().equals(finDog.getName()))
                    result.add(new Dog(orginal.getName()));
        return result;
    }

} 
```

# c++ - Crypto++ 在 algparam.h 中给出编译器错误

> ID：15203562
> 
> 赞同：6
> 
> 时间：2013-03-04T14:15:01.407
> 
> 标签：c++, crypto++

我在一个相当大的文件中有以下几行：

```
#include <sha.h>
#include <hex.h> 
```

编译时会引发此编译器错误：

```
1>d:\work\app\tools\cryptopp\algparam.h(322): error C2061: syntax error : identifier 'buffer'
1>          d:\work\app\tools\cryptopp\algparam.h(321) : while compiling class template member function 'void CryptoPP::AlgorithmParametersTemplate<T>::MoveInto(void *) const'
1>          with
1>          [
1>              T=bool
1>          ]
1>          d:\work\app\tools\cryptopp\algparam.h(329) : see reference to class template instantiation 'CryptoPP::AlgorithmParametersTemplate<T>' being compiled
1>          with
1>          [
1>              T=bool
1>          ] 
```

我很确定我忘记了什么，但我不确定是什么。如果我不包含 hex.h，我没有任何问题，我得到一个 SHA256 哈希就好了，但是当我包含 hex.h 时，会弹出错误。

**编辑**

如果有人想知道，来自 Crypto++ 工具包的 algparam.h：

```
void MoveInto(void *buffer) const //<=== line 320
{
    AlgorithmParametersTemplate<T>* p = new(buffer)
    AlgorithmParametersTemplate<T>(*this);
}

CRYPTOPP_DLL_TEMPLATE_CLASS AlgorithmParametersTemplate<bool>; // <== line 329 
```

**编辑**：删除不相关的代码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-28T13:32:03.843

我通过暂时取消定义来解决问题`new`，它被定义为一些额外调试代码的宏。

```
#pragma push_macro("new")
#undef new
/* #includes for Crypto++ go here */
#pragma pop_macro("new") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-19T06:34:09.630

如果您在支持 MFC 的 Visual Studio 项目中包含 Crypto++，则此错误可能是由以下行引起的：

```
#ifdef _DEBUG
#define new DEBUG_NEW
#endif 
```

确保将其删除或注释掉。

# glassfish-3 - glassfish 配置、服务器、实例和集群有什么区别？

> ID：15203565
> 
> 赞同：2
> 
> 时间：2013-03-04T14:15:16.137
> 
> 标签：glassfish-3

以下是 glassfish 3.1.2.2 管理指南中的一段

> 您可以在远程模式下使用 rotate-log 子命令手动轮换日志文件。此子命令的默认目标是 DAS。或者，您可以针对**配置、服务器、实例或集群**。您可以在远程模式下使用 rotate-log 子命令手动轮换日志文件。此子命令的默认目标是 DAS。或者，您可以针对配置、服务器、实例或集群。

配置、服务器、实例和集群有什么区别？我了解集群是实例的集合。但是服务器和实例和配置有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T16:17:26.023

来自 Glassfish 管理员指南：

> 这两个子命令的默认目标是 DAS。但是，您可以选择指定以下目标之一：
> 
> **配置**：以共享特定配置名称的所有实例或集群为目标。
> **服务器**：仅针对特定服务器。
> **实例**：仅针对特定实例。
> **集群**：仅针对特定集群。

> GlassFish Server 实例是运行 GlassFish Server 的单个节点上的 Java 平台（Java 虚拟机或 JVM 机器）的单个虚拟机。节点定义 GlassFish Server 实例所在的主机。

和

> 通常在一台机器上创建一个服务器实例就足够了，因为 GlassFish Server 和随附的 JVM 都设计为扩展到多个处理器。但是，在一台机器上创建多个实例用于应用程序隔离和滚动升级可能是有益的。

这意味着您可以在单个**服务器上运行多个 glassfish****实例**，您可以针对单个实例或整个服务器。

# c# - 客户端上的 wcf 服务器启动方法

> ID：15203566
> 
> 赞同：1
> 
> 时间：2013-03-04T14:15:17.003
> 
> 标签：c#, .net, wcf, wcf-binding

我的 WCF 服务器上有一个执行回调的方法，如下所示。这工作正常，包括回调。

但是我如何从服务器启动客户端上的方法执行。即**我想在**下面的 C# 按钮代码部分中的代码。

目前我得到的错误是：

```
Object reference not set to an instance of an object. 
```

可能我的架构在这里都错了，WCF 客户端也需要内置 WCF 服务器？

**WCF 服务器上的 C# 方法**

```
public void ChatToServer(string texttoServer) // send some text to the server
{
    Logging.Write_To_Log_File("Entry", MethodBase.GetCurrentMethod().Name, "", "", "", 1);

    try
    {
        IMyContractCallBack callback = OperationContext.Current.GetCallbackChannel<IMyContractCallBack>();
        callback.ChatToClient("your message: " + texttoServer + " has been recieved");          

        Logging.Write_To_Log_File("Exit", MethodBase.GetCurrentMethod().Name, "", "", "", 1);

    }
    catch (Exception ex)
    {
        Logging.Write_To_Log_File("Error", MethodBase.GetCurrentMethod().Name, "", "", ex.ToString(), 2);
    }

} 
```

**我想要的 WCF 服务器上的 C# 按钮代码**

```
private void radButtonSend_Click(object sender, EventArgs e)
        {

            try
            {
                Logging.Write_To_Log_File("Entry", MethodBase.GetCurrentMethod().Name, "", "", "", 1);

                IMyContractCallBack callback = OperationContext.Current.GetCallbackChannel<IMyContractCallBack>();
                callback.ChatToClient(radTextBox2Send.Text);   

                Logging.Write_To_Log_File("Exit", MethodBase.GetCurrentMethod().Name, "", "", "", 1);
            }

            catch (Exception ex)
            {
                Logging.Write_To_Log_File("Error", MethodBase.GetCurrentMethod().Name, "", "", ex.ToString(), 2);
                MessageBox.Show(ex.Message.ToString());

            }

        } 
```

**WCF 服务配置**

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="Throttled">
          <serviceMetadata httpGetEnabled="False" />
          <serviceDebug includeExceptionDetailInFaults="False" />
          <serviceThrottling maxConcurrentCalls="100000" maxConcurrentInstances="100000" maxConcurrentSessions="100000" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  <services>
    <service name="WCFService.WCFJobsLibrary" behaviorConfiguration="Throttled" >
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:8732/Design_Time_Addresses/WCFService/WCFJobsLibrary/" />
        </baseAddresses>
      </host>
      <endpoint name ="duplexendpoint"
          address =""
          binding ="wsDualHttpBinding"
          contract ="WCFService.IWCFJobsLibrary"/>
      <endpoint name ="MetaDataTcpEndpoint"
                address="mex"
                binding="mexHttpBinding"
                contract="IMetadataExchange"/>
    </service>
  </services>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

**WCF 客户端配置**

```
<configuration>
  <system.serviceModel>
    <bindings>
      <wsDualHttpBinding>
        <binding name="duplexendpoint" closeTimeout="00:01:00" openTimeout="00:01:00"
          receiveTimeout="00:10:00" sendTimeout="00:01:00" bypassProxyOnLocal="false"
          transactionFlow="false" hostNameComparisonMode="StrongWildcard"
          maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text"
          textEncoding="utf-8" useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00" />
          <security mode="Message">
            <message clientCredentialType="Windows" negotiateServiceCredential="true"
              algorithmSuite="Default" />
          </security>
        </binding>
      </wsDualHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://localhost:8732/Design_Time_Addresses/WCFService/WCFJobsLibrary/"
        binding="wsDualHttpBinding" bindingConfiguration="duplexendpoint"
        contract="ServiceReference1.IWCFJobsLibrary" name="duplexendpoint">
      </endpoint>
    </client>
  </system.serviceModel>
</configuration> 
```

**合同**

```
namespace WCFService
{
    [ServiceContract(CallbackContract = typeof(IMyContractCallBack))]
    public interface IWCFJobsLibrary
    {
        [OperationContract(IsOneWay = true)]
        void ChatToServer(string texttoServer); // send some text to the server

        [OperationContract(IsOneWay = true)]
        void NormalFunction();

        [OperationContract(IsOneWay = false)]
        int ChatToServerWithResult(string texttoServer); // send some text to the server and send back success indication

    }

    public interface IMyContractCallBack
    {
        [OperationContract(IsOneWay = true)]
        void CallBackFunction(string str);

        [OperationContract(IsOneWay = true)]
        void ChatToClient(string str);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:25:11.000

在您的情况下，我建议您使用 wsDualHttpBinding：*一种安全且可互操作的绑定，旨在与允许服务和客户端发送和接收消息的双工服务合同一起使用。* 参见示例：[http ://blog.binarymist.net/2010/05/23/duplex-communication-and-callbacks-in-wcf/](http://blog.binarymist.net/2010/05/23/duplex-communication-and-callbacks-in-wcf/)

# javascript - Jquery - 防止通过覆盖层触发点击事件

> ID：15203570
> 
> 赞同：1
> 
> 时间：2013-03-04T14:15:28.493
> 
> 标签：javascript, jquery, z-index, layer

.PopBgd 是屏幕大小的 100%，另一个 div .PopUp 包含在 .PopBgd 中并出现在其顶部。单击 .PopBgd 可提供所需的隐藏效果。但是，单击 PopUp 中的任意位置也会运行下面脚本的淡出部分。

**问题** 如何防止脚本的淡出部分通过覆盖的div触发？

```
$('.BtnPop').click(function(e) {
    e.preventDefault();
    $($(this).data('popup')).fadeIn();
    $('.PopClose, .PopBgd').click(function() {
    $('.PopBgd').fadeOut();});
}); 
```

**回答**

```
<button type="button" class="BtnPop" data-popup=".Pop1">CLICK</button>

<div class="Pop1 PopBgd">
  <div class="PopUp">
    <a class="PopClose">&#215;</a>
    <div>Content</div>
  </div>
</div>

$('.BtnPop').click(function(e) {
    e.preventDefault();
    $($(this).data('popup')).fadeIn();
});
$('.PopClose, .PopBgd').click(function() {
$('.PopBgd').fadeOut();});

$('.PopUp').click(function(e) {
    e.stopPropagation();
}); 
```

**新问题** 当目标 div 的名称未知时如何使用 StopPropogation？我在上面尝试过的不起作用。

我通过简单地将第二个静态类名添加到所需的 div 以允许 stopPropogation 正常工作，解决了我的额外问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T14:19:27.517

```
$('.Pop').click(function(e) {
    e.stopPropagation();
}); 
```

[.stopPropagation()](http://api.jquery.com/event.stopPropagation/) “防止事件在 DOM 树中冒泡，防止任何父处理程序收到事件通知。”

# python - 与软件包安装和卸载不一致的 pip 行为

> ID：15203576
> 
> 赞同：2
> 
> 时间：2013-03-04T14:15:34.510
> 
> 标签：python, virtualenv, pip, virtualenvwrapper

在新的控制台中，无需先发出任何其他命令，

```
pip freeze 
```

告诉我我已经安装了 virtualenvwrapper 3.2。我想将它升级到最新版本，所以我发布了

```
pip install -U virtualenvwrapper 
```

pip 告诉我升级成功，实际上它只是作为一个单独的版本安装在其他地方：

```
/Library/Python/2.6/site-packages/virtualenvwrapper
/Library/Python/2.6/site-packages/virtualenvwrapper-3.6-py2.6-nspkg.pth
/Library/Python/2.6/site-packages/virtualenvwrapper-3.6-py2.6.egg-info 
```

所以当我再次执行 pip freeze 时，我仍然看到我有 3.2（没有 3.6 的迹象），而这个 3.2 版本就在这里：

```
/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/virtualenvwrapper
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/virtualenvwrapper-3.2-py2.7-nspkg.pth
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/virtualenvwrapper-3.2-py2.7.egg-info 
```

所以我想删除用 pip 安装的 3.6 版本，方法是

```
pip uninstall virtualenvwrapper 
```

但是，现在**pip 想要卸载与 Python 2.7 一起使用的 3.2 版本**！那么为什么 pip 没有首先升级正确的 virtualenvwrapper 呢？

另外，当我做

```
workon some_env 
```

这明明用的是3.2版本的virtualenvwrapper，那是怎么回事呢？

# c++ - Linux 中的 FreeGLUT 链接问题

> ID：15203577
> 
> 赞同：6
> 
> 时间：2013-03-04T14:15:35.900
> 
> 标签：c++, linux, linker, freeglut, linux-mint

我正在运行**Linux Mint 14.1 64 位**

我已经安装了以下库：

**mesa-common-dev、freeglut3-dev、libglew-dev**

通过**apt-get**工具。

这是我的包含，位于我的**Main.h**文件中：

```
#include <cmath>
#include <cstdlib>
#include <iostream>
#include <stdio.h>

#include <GL/glew.h>
#include <GL/glut.h>
#include <time.h> 
```

我检查了库是否安装正确，它们似乎位于**/usr/lib/x86_64-linux-gnu** 和**/usr/include/GL中的标头**

我继续使用以下标志编译我的**Main.C文件：**

```
g++ -Wall -Wextra -Weffc++ -Winit-self -Wmissing-include-dirs -Wswitch-default -switch-enum -Wunused-parameter -Wstrict-overflow=5 -Wfloat-equal -Wshadow -Wc++0x-compat -Wconversion -Wsign-conversion -Wmissing-declarations -Wstrict-null-sentinel -Woverloaded-virtual -Wsign-promo -Werror -pedantic -Wcast-qual -fno-pretty-templates -fmessage-length=80 -fdiagnostics-show-option -g -std=c++0x -pipe -frepo -c  Main.C -o Main.o 
```

**Main.o**生成没有任何问题，然后我尝试创建二进制文件：

```
g++  -I/usr/include -L/usr/lib/x86_64-linux-gnu -lGL -lglut -lGLU -lGLEW -lX11 -lm -lrt -lpng Main.o -o main 
```

并收到以下错误：

```
Main.o: In function `init()':
/path/to/Main.C:12: undefined reference to `glClearColor'
Main.o: In function `initGLUT(int, char**)':
/path/to/Main.C: undefined reference to `glutInit'
/path/to/Main.C:21: undefined reference to `glutInitDisplayMode'
/path/to/Main.C:24: undefined reference to `glutInitWindowSize'
/path/to/Main.C:25: undefined reference to `glutCreateWindow'
/path/to/Main.C:28: undefined reference to `glutDisplayFunc'
/path/to/Main.C:31: undefined reference to `glutKeyboardFunc'
/path/to/Main.C:34: undefined reference to `glutMouseFunc'
/path/to/Main.C:37: undefined reference to `glutReshapeFunc'
/path/to/Main.C:40: undefined reference to `glutIdleFunc'
Main.o: In function `printFPS()':
/path/to/Main.C:96: undefined reference to `glutGet'
Main.o: In function `reshape(int, int)':
/path/to/Main.C:123: undefined reference to `glutPostRedisplay'
Main.o: In function `getTime()':
/path/to/Main.C:129: undefined reference to `glutGet'
Main.o: In function `idle()':
/path/to/Main.C:141: undefined reference to `glutPostRedisplay'
Main.o: In function `display()':
/path/to/Main.C:148: undefined reference to `glClearColor'
/path/to/Main.C:149: undefined reference to `glClear'
/path/to/Main.C:150: undefined reference to `glFlush'
/path/to/Main.C:151: undefined reference to `glutSwapBuffers'
Main.o: In function `main':
/path/to/Main.C:164: undefined reference to `glutMainLoop' 
```

该程序在另一个 Linux 系统上编译和链接。我能错过什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T14:20:59.833

您必须最后传递库（在目标文件之后）

```
g++  -I/usr/include -L/usr/lib/x86_64-linux-gnu Main.o \
  -lGL -lglut -lGLU -lGLEW -lX11 -lm -lrt -lpng -o main 
```

这背后的原因是，链接器仅链接当前未定义的符号。如果您在目标文件之前传递库，则没有任何未定义的符号要链接，因此编译/链接将失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:21:21.133

库需要在您的目标文件之后：

```
g++ -I/usr/include -L/usr/lib/x86_64-linux-gnu Main.o -lGL -lglut -lGLU -lGLEW -lX11 -lm -lrt -lpng  -o main 
```

# codeigniter - 一个视图中的 CI 多页分页，

> ID：15203578
> 
> 赞同：4
> 
> 时间：2013-03-04T14:15:39.503
> 
> 标签：codeigniter, pagination

我尝试在同一视图中的 codeigniter 中使用多个分页。我的控制器是：

```
 public function gallery()
{

    $config1 = array();
    $config1["base_url"] = site_url("pages/gallery");
    $config1["total_rows"] = $this->pagination_model->video_count();
    $config1["per_page"] = 1;
    $config1["uri_segment"] = 3;

    $this->pagination->initialize($config1);

    $page1 = ($this->uri->segment(3,0)) ? $this->uri->segment(3,0) : 0;
    $data["videos"] = $this->pagination_model->fetch_video($config1["per_page"], $page);
    $data["links1"] = $this->pagination->create_links();

    $config2 = array();
    $config2["base_url"] = site_url("pages/gallery").'/'.$this->uri->segment(3,0);
    $config2["total_rows"] = $this->pagination_model->gallery_count();
    $config2["per_page"] = 3;
    $config2["uri_segment"] = 4;

    $this->pagination->initialize($config2);

    $page2 = ($this->uri->segment(4)) ? $this->uri->segment(4) : 0;
    $data["galleries"] = $this->pagination_model->fetch_gallery($config2["per_page"], $page2);
    $data["links2"] = $this->pagination->create_links();

    $this->template->gallery_view($data);
} 
```

分页在第一个和第二个配置上工作正常，独立，但是当我点击页面 nr。3例如。在分页链接 2 上的分页链接 1 中转到 nr。3（只有页面编号内容是好的），并且在第 6 页链接 1 但链接 2 以 +1 递增。

需要按一下链接1：

*   链接1 ------------ 链接2

    1 ----curent_page_link2(默认是link2 = '')

    2 ---- 当前页面链接2

    3 ---- 当前页面链接2

    3 ---- 当前页面链接2

但我点击链接1：

*   链接1 ---------- 链接2

    1 ----curent_page_link2(默认是link2 = '')

    2 ----curent_page_link2(默认是link2 = '')

    3 ----curent_page_link2 **（需要（默认为link2 =''）但我有来自link2 =''的activ link2 ='2'内容）**

    4 ---- current_page_link2

    5 ----curent_page_link2 **（需要（默认为link2 =''）但我有来自link2 =''的activ link2 ='3'内容）**

对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:54:59.727

我没有对此进行测试。这可能会对您有所帮助。在 config1 中使用“前缀”和“后缀”进行分页。

```
...

$config1 = array();
$config1["base_url"] = site_url("pages/gallery");
$config1["total_rows"] = $this->pagination_model->video_count();
$config1["per_page"] = 1;
$config1["uri_segment"] = 3;

////////////////////////////////////////////////////////

$config1['prefix'] = '';
$config1['suffix'] = '/'.$this->uri->segment(4,0);

////////////////////////////////////////////////////////

$this->pagination->initialize($config1);

... 
```

# c# - 颜色转换 CMYK - RGB - Lab with WCS 使用 ICC 配置文件

> ID：15203580
> 
> 赞同：2
> 
> 时间：2013-03-04T13:26:27.837
> 
> 标签：c#, dll, colors, type-conversion, color-profile

从上周开始，我尝试使用 Windows 颜色系统进行颜色转换。通过从 CMYK 到 RGB 的转换，我得到了正确的值：

```
 // Example CMYK - VALUES with 0
    float[] cmykValues = new float[4];
    cmykValues[0] = 0f / 255f;
    cmykValues[1] = 0f / 255f;
    cmykValues[2] = 0f / 255f;
    cmykValues[3] = 0f / 255f;

    System.Windows.Media.Color color = Color.FromValues(cmykValues, new Uri(@"ISOcoated_v2_300_eci.icc"));
    System.Drawing.Color rgbColor = System.Drawing.Color.FromArgb(color.R, color.G, color.B); 
```

当我尝试将 RGB 值转换为 Lab 值时，我得到一个不正确的 Lab - 结果：

```
[StructLayout(LayoutKind.Sequential)]
public struct RGBColor
{
    public ushort red;
    public ushort green;
    public ushort blue;
    public ushort pad;
};

[StructLayout(LayoutKind.Sequential)]
public struct LABColor
{
    public ushort L;
    public ushort a;
    public ushort b;
    public ushort pad;
};

 StringBuilder profileName = new StringBuilder(256);
 uint size = (uint)profileName.Capacity * 2;
 success = GetStandardColorSpaceProfile(0, LogicalColorSpace.sRGB, profileName, ref size);

 ProfileFilename sRGBFilename = new ProfileFilename(profileName.ToString());
 IntPtr hSRGBProfile = OpenColorProfile(sRGBFilename, ProfileRead, FileShare.Read, CreateDisposition.OpenExisting);

 ProfileFilename isoCoatedFilename = new ProfileFilename(@"ISOcoated_v2_300_eci.icc");
 IntPtr hIsoCoatedProfile = OpenColorProfile(isoCoatedFilename, ProfileRead, FileShare.Read, CreateDisposition.OpenExisting);

 IntPtr[] profiles = new IntPtr[] { hSRGBProfile, hIsoCoatedProfile };
 uint[] intents = new uint[] { IntentPerceptual };
 IntPtr transform = CreateMultiProfileTransform(profiles, 2, intents, 1, ColorTransformMode.BestMode, IndexDontCare);

 RGBColor[] rgbColors = new RGBColor[1];
 rgbColors[0] = new RGBColor();
 LABColor[] labColors = new LABColor[1];
 labColors[0] = new LABColor();

 rgbColors[0].red    = Convert.ToUInt16(rgbColor.R * 257);
 rgbColors[0].green  = Convert.ToUInt16(rgbColor.G * 257);
 rgbColors[0].blue   = Convert.ToUInt16(rgbColor.B * 257);

 success = TranslateColors(transform, rgbColors, 1, ColorType.RGB, labColors, ColorType.Lab);

 double colorL = Convert.ToDouble(labColors[0].L) / 65535;
 double colorA = Convert.ToDouble(labColors[0].a) / 65535;
 double colorB = Convert.ToDouble(labColors[0].b) / 65535; 
```

当我将 CMYK 值 (0;0;0;0) 转换为 RGB (= 254:254;254) 并将 RGB 值转换为 Lab 时，我得到以下值：

```
L = 0.0039978637360036373
a = 0.002777141984552145
b = 0.0030670634005218744 
```

但是 L 值应该是 100% 左右

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-23T09:27:42.990

嗯。`CMYK`我认为从彩色监视器的 ( `RGB`) 转换为与设备无关的颜色模型 ( ) 时，您不需要使用打印配置文件 ( `Lab`)。

[RGB -> XYZ -> Lab](http://www.brucelindbloom.com/index.html?Math.html)或[这个](http://www.easyrgb.com/index.php?X=MATH)

# ios - APNS 中的“缺少主题”错误是什么意思？

> ID：15203590
> 
> 赞同：15
> 
> 时间：2013-03-04T14:16:01.717
> 
> 标签：ios, push-notification

我已经在我的代码中实现了**APNS**，我正在尝试在**ad-hoc distribution profile**上测试我的应用程序。设备正在正确注册。但我没有在我的设备上收到任何推送通知。反馈显示**130**作为响应，这意味着**主题**`"missing topic."`指的是 什么？我的**推送通知中的****主题**是什么？

 ******* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-04T14:18:24.273

这似乎包含在有关该主题的[Apple 指南](https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/sending_notification_requests_to_apns)中：

> 主题当前是 iOS 设备上目标应用程序的包标识符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-02T03:12:25.550

解决了，</p>

现在需要配置主题，查看请求，例如：APNS MissingTopic 是因为你使用第一个请求，你应该使用第二个请求，添加一个主题。没关系

***topic 是你应用的 bundleID***

1.  单个主题的请求：

    ```
    HEADERS
    - END_STREAM
    + END_HEADERS
      :method = POST
      :scheme = https
      :path = /3/device/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0
      host = api.development.push.apple.com  
      apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b
      apns-expiration = 0
      apns-priority = 10
    DATA
    + END_STREAM
      { "aps" : { "alert" : "Hello" } } 
    ```

2.  多个主题的请求

    ```
    HEADERS
    - END_STREAM
    + END_HEADERS
      :method = POST
      :scheme = https
      :path = /3/device/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0
      host = api.development.push.apple.com
      apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b
      apns-expiration = 0
      apns-priority = 10
      apns-topic = <MyAppTopic> 
    DATA
    + END_STREAM
      { "aps" : { "alert" : "Hello" } } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T08:49:06.880

新错误表 [https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html](https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html)

400: MissingTopic: 请求的 apns-topic 标头未指定，是必需的。当客户端使用支持多个主题的证书连接时，apns-topic 标头是必需的。******

# jquery - 从ajax打开一个HTML页面

> ID：15203594
> 
> 赞同：0
> 
> 时间：2013-03-04T14:16:16.990
> 
> 标签：jquery, html, ajax

我需要从 ajax 调用中打开一个单独的 html 页面。我正在使用以下代码。但它不起作用。

```
 $('#cm').blur(function(){
    var cmnumber = document.forms['myform']['cm'].value;

    $.ajax({
    type:'get',
    url: "/validatecm/"+cmnumber,
    cache:false,
    async:false,
    data:cmnumber,
    success: function(data) {

            if ( data == cmnumber)
            {  alert ("Its a valid CM")}
            else
            { var answer = confirm("Want to create New one")
                if(answer)
                {
                    alert("good")
                    var win=window.open('cm.html',"_self");
                    with(win.document)
                    {
                        open();
                        write();
                        close();
                    }
                }
            }
    }
    })
    }); 
```

我需要在同一页面上打开 html 文件“cm.html”。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:19:23.763

不太确定使用 , 和 的目的是什么`open()`，`write()`但`close()`您应该可以使用[window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)打开页面：

```
window.location = 'cm.html'; 
```

请注意，您可以指定相对路径或完全限定路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:17:57.803

使用[window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)属性：

```
window.location.href = "cm.html"; 
```

# java - WebView Android 应用程序 - 如何读取网站内容

> ID：15203598
> 
> 赞同：2
> 
> 时间：2013-03-04T14:16:28.237
> 
> 标签：java, android, android-layout, android-intent, webview

基本上我正在设计一个 webview 应用程序，它可以像这样工作......

**图片链接**：[http ://tinypic.com/r/2z9060n/6](http://tinypic.com/r/2z9060n/6)

我制作了一个 webview 浏览器应用程序，如图所示。现在我想定义一种机制，使用它我可以爬取网络内容并获取图片中标记为红色的内容。基于此内容，我想调用另一个 API，它将在绿色框下方显示一条消息。

在这方面的任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:20:36.697

您可以使用 HTML 解析器（例如[Jsoup）](http://jsoup.org/)来解析 HTML 页面以获取商品的标题/价格。根据标题和价格，您可以使用叠加层显示消息。

顺便说一句，该网站是flipkart.com。您还可以询问他们是否有想要向您公开的 API。

# jquery - 带有链接和 AJAX 问题的 JQ 数组

> ID：15203599
> 
> 赞同：0
> 
> 时间：2013-03-04T14:16:32.810
> 
> 标签：jquery, ajax, arrays

我正在尝试将多个链接从数组传递到 AJAX。我从以下位置获取链接：

```
var additionalProducts = new Array;

    $(".chk").click(function() {
        additionalProducts=[];
        $('.chk:checked').each(function() {
            additionalProducts.push($(this).attr('data-carturl',$("a[data-slot='"+newslot2[i]+"']").attr('href')));
        });
        var ilosc = additionalProducts.length;

        console.log(additionalProducts);
        console.log(ilosc);
    }); 
```

我得到了正确的链接，因为我可以使用控制台日志显示它。我可以在提交表单之前使用 AJAX 提交这些链接吗？

//////////// 更新

那是我的提交功能：

```
$('.submitOrder').click(function() {
    e.preventDefault();
    additionalProducts=[];
    $('.chk:checked').each(function() {

        additionalProducts.push($(this).attr('data-carturl',$("a[data-slot='"+newslot2[i]+"']").attr('href')));
    });

        for(var i = 0; i < additionalProducts.length; i++)
            {
                var page = additionalProducts[i];
                $.ajax({
                    url: page,
                    beforeSend: function() {
                        console.log(page)
                       },
                    success: function(data) {
                        console.log(page)
                    }

                });

            }
        window.location = window.location.protocol + '//' + window.location.hostname + '/my/cart';

}); 
```

我可以进入我的购物车，但仍然没有产品。console.log(page) 对我来说很好用

```
$("#submitOrder").submit(function(e){
        e.preventDefault();     
        var radio1 = $("input:radio[name=radio1]:checked").attr("data-carturl");

        additionalProducts=[];
        $('.chk:checked').each(function() {

            additionalProducts.push($(this).attr('data-carturl',$("a[data-slot='"+newslot2[i]+"']").attr('href')));
        });

             $.ajax({
                    type: 'GET',
                    url: radio1,
                    data: { theArray: JSON.stringify(additionalProducts ) }

              }),

            $(this).submit();

window.location = window.location.protocol + '//' + window.location.hostname + '/my/cart';          
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:20:52.580

当然，`data`在使用 ajax 调用时将其作为 JSON 字符串传递：

```
$.ajax({
    url: 'yourwebservice.php'
    data: { theArray: JSON.stringify(additionalProducts ) }
}); 
```

在表单的[提交事件](http://api.jquery.com/submit/)中，阻止提交，直到 ajax 调用完成：

```
e.preventDefault(); 
```

并在 ajax 调用完成后提交：

```
$(this).submit(); 
```

如果您使用的是 PHP，则可以使用`$theArray = $_GET['theArray'];`. 如果您使用的是 ASP.NET：`string json = HttpContext.Current.Request.Querystring['theArray'];`

# c++ - 从程序中获取编译器选项

> ID：15203605
> 
> 赞同：1
> 
> 时间：2013-03-04T14:16:51.733
> 
> 标签：c++, gcc

c++ 中是否有任何宏（使用 gcc）来获取用于构建可执行文件的编译选项？我确定我在一些关于对话框的内容中看到了类似的内容。

任何帮助将不胜感激

PS：虽然[Detect GCC compile-time flags of a binary](https://stackoverflow.com/questions/189350/detect-gcc-compile-time-flags-of-a-binary)中的问题是查找激活的选项以编译程序，但我很感兴趣的是找到用于从该程序源中编译我的程序的确切命令行选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:37:38.607

除了从 Common Predefined Macros 创建编译字符串，这看起来很忙。我认为有一个简单的方法可以做到这一点。`gcc -V`on debian 会返回用于配置的标志。

但是，我的想法是在等效步骤中获取完整命令`./configure`并将其转储到像 config_line.h 这样的文件中作为定义。

就像是：

。/配置：

```
#!/bin/sh
echo "#define conf_flags \"configured with: "$*"\"" >> config_line.h
#do some configuration steps here
#maybe even compilation itself 
```

然后：

```
luk32:~/projects/tests$ ./test.sh --with=test
luk32:~/projects/tests$ cat ./config_line.h 
#define conf_flags "configured with: --with=test" 
```

您可以在定义语句下的外部文件中获得完整的配置行。我认为它相当直接且易于使用。并且不需要太多的编译器魔法。

还值得注意的是，您很可能（如果不是总是）在实际编译之前创建此类文件，因此它们实际上是最新的并且在编译步骤期间有效。[在get-the-compiler-options-from-a-compiled-executable 中的](https://stackoverflow.com/questions/12112338/get-the-compiler-options-from-a-compiled-executable)回答将暗示可执行文件已经存在，这在某些情况下可能会很糟糕。

**注意：**我给出了 bash 示例，但我很确定您可以在任何半下降构建系统下输出类似的头文件，无论是 make、qmake、cmake 等。bash 开始最简单的情况。

我认为它们中的大多数都可以访问调用它们的命令行，并且它们提供了获取实际编译命令的简便方法。例如，提供两种文字，一种用于 make like 命令`-j 13`，另一种`g++ ...`用于 make 执行的实际编译步骤。

**注2：**我知道这不是 OP 要求的答案，但我想这首先符合他的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:59:06.807

因为我使用的是 qmake 构建系统，所以我遇到了这个解决方案：

我将此行添加到我的专业文件的末尾：

```
QMAKE_CXXFLAGS += -DFLAGS=\"$$QMAKE_CXXFLAGS $$QMAKE_CXXFLAGS_RELEASE\" 
```

然后从 FLAGS 宏中检索我想要的内容

# javascript - 用 jQuery 查找和替换 HTML 字符串

> ID：15203611
> 
> 赞同：14
> 
> 时间：2013-03-04T14:17:09.657
> 
> 标签：javascript, jquery, replace

来自数据库的链接是网站标题并呈现在“[有趣的文章](http://nowhere.com/)：作者”页面上 - 但有时链接是一个问题“[中国在哪里？](http://nowhere.com)：GoogleMaps”。`?:`看起来很傻，所以我想`?</span>:`用`?</span>`.

这是我制定的jQuery：

`$('#relatedinfo ul li a').html().replace('?</span>:','?</span>');`

但这实际上并没有在 DOM 中替换它。如何让该字符串实际更改页面？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-04T14:26:13.313

我建议：

```
$('#relatedinfo ul li a').html(function(index,html){
    return html.replace(/<\/span>(\:)/,'');
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/RRfFr/)。

甚至：

```
$('#relatedinfo ul li a').text(function(index,text){
    return text.replace(':','');
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/RRfFr/1/)。

一种更新的方法是检查 中的最后一个字符`span`是否在数组中`['?','!','.']`，如果是，`:`则从 nextSibling 的 nodeValue 中删除 ：

```
$('#relatedinfo ul li a span').text(function(index,text){
    var lastchar = text.split('').pop();
    if (['?','!','.'].indexOf(lastchar) > -1) {
        this.nextSibling.nodeValue = this.nextSibling.nodeValue.replace(':','');
    }
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/RRfFr/3/)。

参考：

*   [`html()`](http://api.jquery.com/html/).
*   [`String.replace()`](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/String/replace).
*   [`text()`](http://api.jquery.com/text/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-03T07:57:33.473

您还可以使用正则表达式：

```
var rx = new RegExp('(?![^<&]+[>;])' + searchString, 'gi');

$('#relatedinfo').html(function (i, html) {
   return html.replace(rx, '<b>$&</b>')
}); 
```

来源：[当不在 P、DIV、SPAN、TD 以外的 html 标记内时，使用 jQuery 查找/替换 html 文本](https://stackoverflow.com/questions/4087984/jquery-to-find-replace-html-text-when-not-inside-an-html-tag-other-than-p-div)

# facebook - 自动电子邮件通知，让现有用户知道他们的朋友也加入了网站

> ID：15203619
> 
> 赞同：-2
> 
> 时间：2013-03-04T14:17:27.460
> 
> 标签：facebook, email, notifications, notify

我想创建一个自动电子邮件通知系统，每次他/她的 Facebook 朋友注册/加入我的网站时通知我现有的用户。我从 Pinterest 等主要网站看到很多此类电子邮件通知。即“你的朋友 OOO 也加入了 Pinterest！” 谁能告诉我我怎么能做到这一点？提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:00:50.710

这是快速而肮脏的解决方案：

当用户加入您的网站时，您应该要求他让您的 Facebook 应用访问他/她的基本信息、电子邮件和朋友。当您有权访问该信息时，只需将用户的朋友列表保存在数据库中。当新用户加入时，检查数据库中他/她的ID，如果找到了，请检查它的朋友并发送电子邮件。解决方案并不完美，当有很多用户时，它会变得非常沉重。

# ruby-on-rails - Heroku 应用程序每隔几天就会关闭 10 - 30 分钟。普通的？

> ID：15203622
> 
> 赞同：1
> 
> 时间：2013-03-04T14:17:39.860
> 
> 标签：ruby-on-rails, heroku, newrelic

这是一个简单的 Rails 应用程序。它只使用 postgresql 数据库，除了 newrelic 监控之外不进行任何 http 调用。但是每周一到两次，我会收到来自 newrelic 的警报，说我的应用程序已关闭，并且持续时间从 10 到 30 分钟不等。这是正常的吗？

日志只显示了一堆 H12 请求超时错误，没有别的。

这不是一个免费帐户，我有两个 dynos 正在运行。这不是在部署之后立即进行的。

我已经尝试过 puma 和 unicorn，按照那里的所有指南进行配置。在 puma 的情况下，heroku 路由器最终开始对请求超时。在独角兽的情况下，独角兽本身开始超时。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-04T19:55:55.217

如果您在单个测功机应用程序上运行，则测功机在长时间不活动后处于空闲状态。New Relic 有可能将其报告为停机时间。如果您的应用程序需要很长时间才能启动，那么它可能已经将其报告为已关闭。运行 2 个或更多测功机的所有应用程序永远不会空闲。

# python - 将熊猫 DateTimeIndex 转换为 Unix 时间？

> ID：15203623
> 
> 赞同：64
> 
> 时间：2013-03-04T14:17:41.270
> 
> 标签：python, pandas

将 pandas DateTimeIndex 转换为（可迭代的）Unix 时间的惯用方法是什么？这可能不是要走的路：

```
[time.mktime(t.timetuple()) for t in my_data_frame.index.to_pydatetime()] 
```

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2013-03-04T14:47:36.513

就像`DatetimeIndex`在`ndarray`引擎盖下一样，您可以在没有理解的情况下进行转换（更快）。

```
In [1]: import numpy as np

In [2]: import pandas as pd

In [3]: from datetime import datetime

In [4]: dates = [datetime(2012, 5, 1), datetime(2012, 5, 2), datetime(2012, 5, 3)]
   ...: index = pd.DatetimeIndex(dates)
   ...: 
In [5]: index.astype(np.int64)
Out[5]: array([1335830400000000000, 1335916800000000000, 1336003200000000000], 
        dtype=int64)

In [6]: index.astype(np.int64) // 10**9
Out[6]: array([1335830400, 1335916800, 1336003200], dtype=int64)

%timeit [t.value // 10 ** 9 for t in index]
10000 loops, best of 3: 119 us per loop

%timeit index.astype(np.int64) // 10**9
100000 loops, best of 3: 18.4 us per loop 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-03-04T14:31:21.453

注意：时间戳只是 unix 时间，单位为纳秒（所以除以 10**9）：

```
[t.value // 10 ** 9 for t in tsframe.index] 
```

例如：

```
In [1]: t = pd.Timestamp('2000-02-11 00:00:00')

In [2]: t
Out[2]: <Timestamp: 2000-02-11 00:00:00>

In [3]: t.value
Out[3]: 950227200000000000L

In [4]: time.mktime(t.timetuple())
Out[4]: 950227200.0 
```

正如@root 指出的那样，直接提取值数组会更快：

```
tsframe.index.astype(np.int64) // 10 ** 9 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-09-21T20:05:54.930

其他答案的摘要：

```
df['<time_col>'].astype(np.int64) // 10**9 
```

`10**6`如果你想保持毫秒除以

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-09T16:35:36.753

补充其他答案：`//10**9`将做一个地板划分，它给出过去的完整秒数，而不是最接近的以秒为单位的值。如果需要，获得更合理舍入的一种简单方法是`5*10**8 - 1`在进行地板划分之前添加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-23T14:16:47.217

为了解决 NaT 的情况，上述解决方案将转换为大的负整数，在 pandas>=0.24 中，可能的解决方案是：

```
def datetime_to_epoch(ser):
    """Don't convert NaT to large negative values."""
    if ser.hasnans:
        res = ser.dropna().astype('int64').astype('Int64').reindex(index=ser.index)
    else:
        res = ser.astype('int64')

    return res // 10**9 
```

在缺少值的情况下，这将返回可为空的 int 类型“Int64”（ExtensionType pd.Int64Dtype）：

```
In [5]: dt = pd.to_datetime(pd.Series(["2019-08-21", "2018-07-28", np.nan]))                                                                                                                                                                                                    
In [6]: datetime_to_epoch(dt)                                                                                                                                                                                                                                                   
Out[6]: 
0    1566345600
1    1532736000
2           NaN
dtype: Int64 
```

否则为常规 int64：

```
In [7]: datetime_to_epoch(dt[:2])                                                                                                                                                                                                                                               
Out[7]: 
0    1566345600
1    1532736000
dtype: int64 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-13T14:29:21.930

如果您在数据框的日期时间列上尝试过此操作：

```
dframe['datetime'].astype(np.int64) // 10**9 
```

＆您正在努力解决以下错误：`TypeError: int() argument must be a string, a bytes-like object or a number, not 'Timestamp'`您可以只使用这两行：

```
dframe.index = pd.DatetimeIndex(dframe['datetime'])
dframe['datetime']= dframe.index.astype(np.int64)// 10**9 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-27T19:02:00.417

其他答案的代码

```
dframe['datetime'].astype(np.int64) // 10**9 
```

截至我发帖时打印以下警告：

> FutureWarning：不推荐使用 .astype(...) 将 datetime64[ns] 值转换为 int64，并将在未来版本中提出。使用 .view(...) 代替。

因此，请改用以下内容：

```
dframe['datetime'].view(np.int64) // 10 ** 9 
```

# visual-studio - Word vsto Addin 无法在 Windows XP 中加载

> ID：15203626
> 
> 赞同：0
> 
> 时间：2013-03-04T14:17:48.490
> 
> 标签：visual-studio, ms-word, windows-xp, vsto

我有一个用于 Word 的小型 vsto 插件，它曾经在 Windows XP 上的 Word 2010 上工作，然后改为在 Windows 7 上的 Word 2010 上工作。现在，客户希望该插件在 XP 上再次工作，但我无法得到它去工作。我在 Visual Studio 2008 中从头开始该项目，但无济于事。Windows 7 和 XP 的区别在于 Windows 7 使用 Servicemodel 而 XP 使用数据库调用。我已经删除了 Servicemodel 参考，但它仍然不起作用。我启用了 Fusion 日志，以下是我得到的。我做了一些研究，它说不要为插件放置任何依赖项，并在要安装此插件的每台机器上手动安装它们......但是，在我们的例子中，这似乎不是一个选项，由于必须安装许多机器，并且用户自己没有在他们的机器上安装程序的管理员权限。此外，它工作时我不需要安装任何东西。有什么输入吗？

操作失败。绑定结果：hr = 0x80070002。该系统找不到指定的文件。

LOG：开始绑定原生镜像eMESAHECOWordAddinXP，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null。日志：从 C:\Documents and Settings\Administrator\Local Settings\Application Data\assembly\dl3\E6C2NQ04.WJ1\GC7HN260.7J2\4c4ce18f\00a69b13_9c16ce01\eMESAHECOWordAddinXP.dll 加载的 IL 程序集。警告：未找到匹配的本机图像。LOG：绑定到本机映像程序集未成功。使用 IL 图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:27:45.240

我可以通过将 VSTO_SUPRESSDISPLAYALERTS 环境变量设置为 0 来解决此问题。之后，Word 在尝试加载插件时给了我一条弹出消息，说明该问题。我安装了 Office 2007 PIA，一切正常。

# wcf - NServiceBus 和 WCF

> ID：15203631
> 
> 赞同：1
> 
> 时间：2013-03-04T14:18:00.883
> 
> 标签：wcf, nservicebus

我想实现以下目标：

1.  将 WCF 终结点公开给他们请求长时间运行的操作的客户端。
2.  将入站请求映射到 NServiceBus 消息。
3.  将消息发布到总线进行处理。
4.  向客户发送回复，确认他们的请求已收到，我们将开始处理它。
5.  Bus 通过处理程序处理消息。

你能帮我举一些例子吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:44:46.920

您可以查看 NSB 附带的 WcfIntegration 示例，了解如何通过 WCF 公开端点。要传递消息，您只需调用 Bus.Send() 到另一个端点进行处理，然后使用示例中的 Bus.Return()。从那里，另一个端点看起来就像 FullDuplex 示例的服务器部分，没有 Bus.Reply() 逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:57:38.437

不久前，我创建了一些与此类似的示例代码，虽然它使用了传统的 ASMX Web 服务而不是 WCF 服务，但这实际上只是一个实现细节。

查看GitHub 上的[NServiceBus 外部 WebService 示例](https://github.com/DuctTapeMan/NServiceBus-External-WebService-Example)。

# css - 使用 Bootstrap 流体样式时，Durandal/Hot Towel 模板将 body max-width 设置为 1100px 的原因是什么？

> ID：15203636
> 
> 赞同：0
> 
> 时间：2013-03-04T14:18:05.463
> 
> 标签：css, durandal, hottowel

在使用带有 Durandal 的“Hot Towel”SPA 模板时，值得注意的是，视图位于宽度为 1100 像素的中间窗口中，而不是使用所有可用空间。

然而，applicationHost 中的所有视图都设置为使用来自 Twitter“流体”样式的 Bootstrap。实际上，在 body 标签上设置的硬编码最大宽度使所有这些流畅的样式变得多余且毫无意义。

覆盖 app.css 中设置的主体样式很容易（假设将其设置为高得离谱的值不会有副作用）但我只是想知道是否有人知道在模板中以这种方式设置它的原因，因为它正在取消尝试实现所有那些 Bootstrap“*-fluid”样式试图实现的响应式设计的所有好的工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:26:48.347

没有特别的理由。如果布局仍然吸引您，请随意删除它。您也可以在 github 上提交拉取请求以进行更改，因为 HotTowel 是开源的。

# oop - is there any more standard way to resume function from jQuery ajax call?

> ID：15203638
> 
> 赞同：0
> 
> 时间：2013-03-04T14:18:08.667
> 
> 标签：oop, jquery, import, visual-studio-2012, javascript-intellisense

I am trying to write a big project which involves of a lot of code. That's why I want to separate functionalities from different files.

第一个文件 dataJS，我进行 AJAX 调用以从 JSON 文件中获取数据。第二个文件，showJS 我想显示从dataJS文件获得的数据。

在实现方面，我意识到 AJAX 调用需要更长的时间，即使我按顺序包含了 dataJS 和 showJS，showJS 仍然会得到一个空数据

*因此，我在 showJS 文件中创建了一个名为 continueFromDataJS() 的函数，并在 AJAX成功*函数的末尾调用 continueFromDataJS() 。

我认为这是一个相当勉强的解决方案。有没有标准的方法来做到这一点？

此外，我的 Visual Studio 中的所有智能感知都消失了。尽管有单独的文件，有没有办法让 Visual Studio 从 dataJS 中获得智能感知？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T10:28:02.417

抱歉，我不知道如何添加后续问题这是代码

为简单起见，我重命名了一些文件，并且只提取了其中的一部分。希望有帮助

html中的代码

dataJS.js 中的代码

```
var planets = [];
var jsonData = null;

$(function () {

$.getJSON("Scripts/planetData.js", function (data) {
    //planets[0] = new planet("uranus", "career", 45, 700, 400, 0.1, 5, 3);
    jsonData = data;
    for (var i = 0; i < data.planets.length; i++) {

        var curPlanet = data.planets[i];

        planets[i] = new planet(curPlanet.graphic, i, curPlanet.field, curPlanet.planetInitialAngle, curPlanet.distanceFromStar, curPlanet.planetRadius, curPlanet.planetRevolvingSpeed, curPlanet.planetRotationSpeed, curPlanet.contents.length);

        $("#result").append("<p>" + curPlanet.graphic + " " + curPlanet.field + " " + curPlanet.planetInitialAngle + " " + curPlanet.distanceFromStar + " " + curPlanet.planetRadius + " " + curPlanet.planetRevolvingSpeed + " " + curPlanet.planetRotationSpeed + " " + curPlanet.contents.length + "</p>");

    }

    callDisplayScript(); //**continue from showJS.js file is that the way to do this?**

    });

});
// more functions below in dataJS.js 
```

显示JS.js

```
function callDisplayScript() { **// this is the ugly part. What's the proper way to do it?**
    $("#display #close").click(function () {
        $("#display").fadeOut('slow');
    });
    $article = $("#display article");
    $article.empty();
    var data = jsonData.planets[pID].contents; // **this line won't get jsonData if it's out this curly brace.**

    for (var i = 0; i < data.length; i++) {
        $article.append(data[i].title);
        $article.append(data[i].content);
    }

    $("#display").fadeIn('slow');
}; 
```

不要忘记回答我的智能感知问题。我想在 datajs.js 中自动提示在 datajs.js 中声明的行星和 jsonData 是否可能？

# svg - 以编程方式将 SVG 形状转换为路径（lineto、moveto）

> ID：15203650
> 
> 赞同：9
> 
> 时间：2013-03-04T14:18:44.537
> 
> 标签：svg, automation, coordinates, shapes, save-as

我有一个来自 Inkscape、Illustrator 或任何其他应用程序的 SVG 文件。我想将形状转换为`lineto`, `moveto`,`curveto`格式。

我想要的是这样的：

```
./Appname svgfile outfilewithpath 
```

我会将 SVG 文件作为参数，然后我的应用程序会将对象转换为相应的路径。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T18:02:50.507

Inkscape 有一个命令行界面。使用[Inkscape 手册页](http://inkscape.org/doc/inkscape-man.html)和[动词源](http://bazaar.launchpad.net/~inkscape.dev/inkscape/trunk/view/head:/src/verbs.cpp)作为参考：

`ObjectToPath`动词将对象转换为路径：

```
inkscape filename.svg --select=myobject --verb=ObjectToPath --export-plain-svg=filename_to_path.svg 
```

该`export-text-to-path`参数将文本节点转换为路径：

```
inkscape filename.svg --export-eps=filename.eps --export-text-to-path 
```

这些是关于如何从 Perl、Ruby、PHP 或 Python 运行 InkScape 的相关问题：

*   [在 perl 中使用 Inkscape shell](https://stackoverflow.com/questions/7695641/1113772)
*   [在 PHP 中运行inkscape](https://stackoverflow.com/questions/3219507/1113772)
*   [在 Python 中调用 Inkscape](https://stackoverflow.com/questions/11651826/1113772)
*   [Inkscape 合并红宝石宝石](https://rubygems.org/gems/inkscape_merge/versions/0.1.3)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-02T19:45:20.483

这最终对我有用：

```
inkscape -f filename.svg --verb EditSelectAll --verb SelectionUnGroup --verb EditSelectAll --verb ObjectToPath --verb FileSave --verb FileQuit 
```

运行大约需要 9 秒并短暂打开 inkscape gui，它成为活动应用程序，所以它并不理想，但这是我能找到的唯一真正有效的答案。

# php - 使用 substr() 方法后在 PHP 中渲染 �

> ID：15203652
> 
> 赞同：0
> 
> 时间：2013-03-04T14:18:52.063
> 
> 标签：php, unicode

我需要通过 PHP 从 MySQL 数据库中选择 180 个字符，并为想要阅读全部文本的用户显示**阅读更多链接。**所以我从 MySQL 读取所有文本并使用 substr() 函数，如下所示：

```
$some_text = substr($total_text, 0, 180); 
```

一切都很好，但是在出现一些字符串 char 之后。

这是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:20:11.830

听起来您正在使用多字节字符。

尝试[`mb_substr()`](http://www.php.net/manual/en/function.mb-substr.php)改用：

```
$some_text = mb_substr($total_text, 0, 180); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T14:28:57.700

我最近一直在从事的一个语言翻译项目遇到了[这个确切的问题。](http://j7mbo.blogspot.co.uk/2013/01/php-html-polish-characters-and.html)

除了更改数据库中的字符集之外，您还可以在上面的代码之后尝试以下操作：

```
echo htmlentities($some_text, ENT_QUOTES, 'UTF-8'); 
```

# java - Java：转置 SpringLayout

> ID：15203653
> 
> 赞同：0
> 
> 时间：2013-03-04T14:18:54.580
> 
> 标签：java, swing, layout-manager, springlayout

我有一个需要转置的 SpringLayout。

基本上，当您创建 SpringLayout 时，它会按列填充面板，因此如果您有

```
JPanel temp = new JPanel()
retCase2.add(label = new JLabel("A"));
retCase2.add(label = new JLabel("B"));
retCase2.add(label = new JLabel("C"));
retCase2.add(label = new JLabel("D"));

Utils.makeCompactGrid(retCase2,
2, 2, //rows, cols
1, 1,        //initX, initY
10, 10); 
```

结果是一个如下所示的表：

```
A B
C D 
```

然而，我想要

```
A C
B D 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-24T23:33:24.933

只需切换“b”和“c”的顺序

# c# - 拦截文件系统写入流或字节数组

> ID：15203654
> 
> 赞同：1
> 
> 时间：2013-03-04T14:18:58.283
> 
> 标签：c#, file-io, stream, shapefile

我有一个带有 .NET 包装器（在本例中是[Shapelib](http://shapelib.maptools.org/) ）的 C 库，它使用 .NET 之类的路径将文件（Shapefiles）写入文件系统`C:\Path\To\Things\Filename.shp`。但是，将文件写入文件系统实际上并不是我需要的。编写完成后，无论如何我都必须将它们读回流中，以通过网络传递它们，将它们添加到 zip 文件中，或执行其他任务。将它们写入文件系统意味着我只需要跟踪混乱并不可避免地以某种方式清理它们。

我不确定是否有像[PHP的流协议寄存器](http://php.net/manual/en/function.stream-wrapper-register.php)这样的路径可能像`stream://output.shp`......

是否可以拦截文件系统写入并在内存中处理整个任务？就算能做到，这也是可怕的做法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:55:46.223

共识是，这“几乎是不可能的”。如果你真的需要确保这是在 RAM 中完成的，最好的办法是安装 RAM 磁盘驱动程序。谷歌搜索[windows拦截文件输出]。或者查看[Windows 7 中程序的截取输出](https://stackoverflow.com/q/3812249/56778)。

也就是说，很可能您写入磁盘的大部分数据都将缓存在内存中，因此右转并从磁盘读取数据不会那么昂贵。您仍然有清理问题，但解决起来并不难：只需使用一个`try/finally`块：

```
try
{
    // do everything
}
finally
{
    // clean up
} 
```

# java - OSGi 模块/包粒度

> ID：15203655
> 
> 赞同：5
> 
> 时间：2013-03-04T14:19:01.950
> 
> 标签：java, osgi

当我第一次开始研究 OSGi 时，我的印象是你可以只构建一个 JAR，只要它有一个清单文件，你就可以将它部署在一个 OSGi 容器中。我想象以经典方式（maven）构建我的模块，并且可能使用一些插件或类似的东西来编写清单，然后我可以让我的模块基本上是一个独立的应用程序，通过 OSGi 与其他模块通信。

进一步阅读有关 OSGi 的信息，我开始看到更多在更底层使用它的示例，它基本上取代了依赖注入并提供了横切关注点服务，如日志记录。并且似乎使用休眠或其他东西是一个问题......（或者我可能只是错过了一些东西）。

至少对我来说，我并没有真正看到拥有如此高水平的模块化和与 OSGi 集成的意义，我更愿意拥有一个单独的模块，每个模块都有自己的一套技术和框架，可能还有一个 Web 资源和持久层。这可以通过 OSGi 实现吗？如果是的话，你能指出我正确的方向，例子等吗？

**编辑**，添加了一些关于我如何尝试使用 OSGi 的更多细节：

我只是在设想拥有一个以上模块的可能性，它可能具有更高级别的责任。

比如议程模块。在这种情况下，我想要事件的持久性、添加事件、使用过滤器列出事件等......这个议程可能有几个内部类，甚至可能需要一个持久层。所以我想使用 Guice 之类的东西来 DI 这些类，并使用一些 JPA 来保存我的数据。

我可以理解，服务器或日志记录等一些 X-cutting 问题可以有一个包，但数据模型是特定于议程包的。所以我认为我的问题最后是什么是捆绑包内不可能做什么？作为一般做法，应该和不应该在内部做什么？

谢谢！毛里西奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T09:14:37.737

OSGi 对很多人来说是很多东西，您几乎可以选择要使用它的哪些部分：

1.  您是否有一个不使用任何其他依赖项的普通库？亲爱的，只需建立一个最小的 MANIFEST.MF 列出公共包，使用 maven 构建你的 JAR，你就完成了。
2.  你有依赖吗？与 (1) 相同，您只需在清单中添加导入的包。
3.  您需要执行一些初始化吗？编写一个 Activator，并在清单中提及它。
4.  服务？只需将它们的依赖关系和描述放在 XML 文件中，然后将它们添加到清单中。

依此类推 - 只需使用您感到舒适的级别即可。

另一方面，如果你想做 Web 应用程序，你真的需要考虑 OSGi、你使用的库、你的应用程序管理器和 servlet/jee/whatever 容器之间的架构相互作用。OSGi 将驻留在什么级别？一般来说，有 OSGi->container->app、container->OSGi->app 和 container->app->OSGi 解决方案，各有各的特点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T15:55:44.363

您可以使用 OSGi，而无需在应用程序代码上强制依赖于 OSGi。然而，由于 OSGi 提供了模块化，中间件（你的层）需要有一些 OSGi 的知识。问题在于，在模块化世界中，您想要隐藏实现细节，这就是全部目的。然而，像 Spring 和 Hibernate 这样的东西倾向于假设类路径没有边界，并且它们会直接进入栅栏。幸运的是，越来越多的中间件正在为此做好准备，我听说 Hibernate 现在正在努力，JPA 也可以在 OSGi 中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T08:44:46.283

OSGi 有时被称为 JVM 的面向服务的体系结构。将包视为提供服务的模块化单元有助于定义正确的粒度：您通常会拥有 API 包，它们只是在这里提供定义 API 的 java 包、提供这些 API 实现的服务包，以及提供这些 API 的实用程序/辅助包您提到的跨领域服务。

您可以在 OSGi 之上使用一些依赖注入框架，但根据我的经验（使用 Apache Sling 和 Adob​​e CQ5），保持简单通常会更好。OSGi 服务组件运行时和配置管理提供了我管理服务、依赖项和配置所需的一切，特别是如果您从一开始就为此设计系统。

您可以在我的“来自 OSGi 战壕的故事”幻灯片中找到更多关于我们使用 OSGi 设计 Adob​​e CQ5 的经验，网址为[http://www.slideshare.net/bdelacretaz/tales-from-the-osgi-trenches-2012-简短版](http://www.slideshare.net/bdelacretaz/tales-from-the-osgi-trenches-2012-short-form-edition)- 这可能有助于更好地了解 OSGi 如何用于构建复杂系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T07:58:41.687

关于使用 maven 构建，您可以使用[Maven-Bundle-Plugin](https://felix.apache.org/site/apache-felix-maven-bundle-plugin-bnd.html "Maven 捆绑插件")，它可以帮助您构建 OSGi 包，而无需自己编写清单。所有必需的元信息都将在您的 POM 中。

依赖注入可以在模块层之上实现。一种可能的解决方案是*声明式服务*，它使您能够通过 XML 描述或代码注释进行注入。它强烈反映了 OSGi 服务的动态特性（服务的动态绑定解除绑定）。替代方案是*Blueprint*，它基于 Spring，并具有非常相似的语法。一个关键特性是它可以抽象服务绑定和解除绑定的性质。如果您考虑使用 Spring，请使用 Blueprint。

OSGi 仅暗示您如何构建模块。您会得到一个定义明确的模块交互图（谁导入/导出包？谁导出服务以及谁使用它？）因此，您可以通过为每个任务构建有凝聚力的捆绑包来在其之上构建企业架构。

# c# - 在 Windows Phone 8 中以编程方式使用 WCF 服务

> ID：15203661
> 
> 赞同：1
> 
> 时间：2013-03-04T14:19:18.347
> 
> 标签：c#, wcf, windows-phone-8, windows-phone

我希望能够在我的 Windows Phone 8 应用程序中使用 WCF 服务端点。

在 Google 上搜索只显示我必须右键单击 WP8 项目，选择“添加服务参考”......在我的情况下，这不是一个可行的解决方案。

*   我希望能够以编程方式在我的 Windows Phone 8 应用程序中使用 WCF*服务*。

*   在 Windows Phone 8 应用程序中的何处定义我的客户端端点证书？

想象一下，我想制作一个 Windows Phone 8 应用程序，它应该能够连接到托管在另一台设备（即计算机）上的 WCF 服务。然后 WP 用户需要输入该计算机的主机名才能连接到 WCF 服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:20:42.223

我建议您使用“添加服务引用”来生成代理类。DTO 和客户端代理将自动生成。您将受益于生产力、类型安全和名称检查的巨大提升。

然后，您可以使用适当的构造函数在运行时指定 url。例如 ：

```
private MyServiceClient GetMyServiceClient(string url)
{
  Uri uri = new Uri(url);
  BasicHttpBinding binding = new BasicHttpBinding(BasicHttpSecurityMode.None);
  EndpointAddress address = new EndpointAddress(uri);
  MyServiceClient client = new MyServiceClient(binding, address);
  return client;
} 
```

（MySericeClient 是生成的代理）

*.config*的东西是可选的，你可以删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:27:07.833

当您添加服务引用时，您的 WP8 项目会自动生成包装 WCF 服务的代理类。然后你的代码使用这个代理类。

另一种方法是手动创建代理类，相信我，如果可以的话，你想避免这种情况......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T22:10:05.630

1.  仅当您使用其无参数构造函数时，添加服务引用生成的代理客户端类才会使用配置中的主机名（端点地址）。当然，您可以在运行时手动指定端点地址。
2.  您可以创建服务合同可移植类库并在客户端和服务器之间共享它。然后你不必生成代理类，但你使用 ChannelFactory API：[http ://www.c-sharpcorner.com/UploadFile/ff2f08/channel-factory-in-wcf/](http://www.c-sharpcorner.com/UploadFile/ff2f08/channel-factory-in-wcf/)

# .net - 正则表达式太松散

> ID：15203662
> 
> 赞同：3
> 
> 时间：2013-03-04T14:19:19.267
> 
> 标签：.net, regex

我有以下正则表达式

```
Regex(@"(^http|https)://(w){0,3}(\.)?(.)*lycos\.(.)*/(.)*(&|\?)(q|query)=(.)*") 
```

我希望它与：

```
http://search.lycos.com/web?q=cautare 
```

但它不应该匹配：

```
http://www.google-analytics.com/__utm.gif?utmwv=5.3.9&utms=1&utmn=932580756&utmhn=search.lycos.com&utmcs=utf-8&utmsr=1920x1080&utmvp=1920x979&utmsc=32-bit&utmul=en-us&utmje=1&utmfl=11.6 r602&utmdt=searchmeup - lycos&utmhid=2063854819&utmr=0&utmp=/web?q=searchmeup&utmac=ua-2342215-18&utmcc=__utma=1.950014844.1362381742.1362387055.1362404209.3;+__utmz=1.1362387055.2.2.utmcsr=lycos.com|utmccn=(referral)|utmcmd=referral|utmcct=/;&utmu=qlag~ 
```

有没有办法使正则表达式更具限制性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:25:11.973

`(.)*`（实际上应该是`.*`）匹配*任何东西*（换行符除外），这就是您的模式如此宽松的原因。

所以而不是

```
Regex(@"(^http|https)://w{0,3}(\.)?.*lycos\..*/.*(&|\?)(q|query)=.*") 
```

您可以应用除 之外的其他标记`.`，例如`[^/]`用于非斜线字符、`\w`字母数字字符`\S`或非空格字符：

```
Regex(@"(^http|https)://w{0,3}(\.)?\w*\.lycos\.[^/]*/[^&?]*(&|\?)(q|query)=\w*") 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T15:16:42.927

您可以大大简化您的正则表达式。

1.  你在你的捕获组中非常自由`()`。只有当您有想要*捕获*的东西或者您有多个正则表达式字符需要一些修饰符来影响时，您才需要它们。所以你可以把所有的都`(.)*`改成`.*`.
2.  该`w{0,3}(\.)?`部分与该部分完全无关`(.)*`，因此将其杀死。
3.  我不太确定你在用 做什么，在`^`我看来，它只会在行首开始时匹配“http”。它会在任何地方匹配“https”。因此，要么将其删除，要么将其放在括号外。
4.  `(http|https)`相当于`https?`
5.  `.*`匹配任何不是换行符的内容。让我们更加严格。域名只能包含字母、数字、句点和连字符 ->`[0-9a-z\-]`
6.  蒂姆的回答建议使用`[^&?]*`. 只要你知道你不会在一个字符串中得到一堆乱七八糟的 URL，它就会起作用。例如，它可以匹配“ [http://www.lycos.com/movies](http://www.lycos.com/movies) blah blah blah blah [http://www.google.com/?query=blah](http://www.google.com/?query=blah) ”。您需要添加更多限制以防止出现这种情况。
7.  在最后一个“.”之后 在域名中，您需要匹配至少 1 个字符才能使 URL 被视为可能有效。所以使用 a`+`而不是 a`*`

    ```
    Regex(@"https?://[0-9a-z\-.]*lycos\.[0-9a-z\-.]+/[^&?]*(&|\?)(q|query)=\w*"); 
    ```

# javascript - 减少多个 if else 语句

> ID：15203663
> 
> 赞同：2
> 
> 时间：2013-03-04T14:19:20.797
> 
> 标签：javascript, jquery

```
My Name:<input class="clr" id="name" type="text" /><span class="clr" id="name_error">Name is required</span> <br /><br />

My Email Adress:<input class="clr" id="email" type="text" /><span class="clr" id="email_error">Email is required</span> <br /><br />

My Organisation Name:<input class="clr" id="organisation" type="text" /><span class="clr" id="org_error">Organisation is required</span> <br /><br /> 
```

我有 3 个输入字段。我`span`用来在提交空字段时显示错误消息。

我的问题是，如果`name`字段为空，我们应该得到`"Name is required"`错误，如果`email`字段为空，我们应该得到`"email is required"`错误等等。

为此，我正在编写以下代码。

```
if (name == "")
    $("#name_error").show();
else
    $("#name_error").hide();

if (email == "")
    $("#email_error").show();
else
    $("#email_error").hide();

if (organisation == "")
    $("#org_error").show();
else
    $("#org_error").hide(); 
```

有什么方法可以减少 if/else 语句？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T14:22:05.713

### 有效地使用 jQuery，您可以这样做。

```
$('input.clr').each(function(){
    if ($(this).val() == "")
        $(this).next('span.clr').show();
}); 
```

在此之前，我们需要以这种方式隐藏它们：

```
$('span.clr').hide(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T14:21:45.040

你可以这样做：

```
 var obj = window; // or something else, depending on your scope
   ['name', 'email', 'organisation'].forEach(function(v) {
       var $e = $('#'+v+'_error');
       if (obj[v]=="") $e.show();
       else $e.hide();
   }); 
```

注意

*   这假设更严格一些，用“组织”替换“组织”
*   我试图模仿您的代码，但在根（即您填充变量的位置`name`）进行更改将允许更简单的代码
*   如果您知道 DOM 不会改变并且错误跨度始终跟随输入，那么 Praveen 的答案可能更简单且适合

# android - Eclipse 中 android:singleLine 的 Android xml 文件中的内容辅助

> ID：15203664
> 
> 赞同：0
> 
> 时间：2013-03-04T14:19:21.703
> 
> 标签：android, eclipse, android-layout

内容辅助（ctrl-space）工作

```
<EditTextPreference 
```

但是对于以下单行和值“真”或“假”它不起作用？

```
android:singleLine="true" 
```

获取消息：Content Assist 不适用于当前位置

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >
 ...
 <EditTextPreference
    android:hint="your@address.com"
    android:inputType="textEmailAddress"
    android:key="@string/key_dest_email"
    android:maxLines="1"
    android:selectAllOnFocus="true"
    android:singleLine="true"
    android:title="@string/pref_dest_email" />
 ...
</PreferenceScreen> 
```

我用“Android 通用 XML 编辑器”打开 xml 文件它应该可以工作吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:28:30.107

你可以参考这个：

[http://developer.android.com/reference/android/preference/EditTextPreference.html](http://developer.android.com/reference/android/preference/EditTextPreference.html)

他们不支持那些。

# iphone - 如何在我的 Xcode 项目中使用 Speech-To-Text 库？

> ID：15203669
> 
> 赞同：0
> 
> 时间：2013-03-04T14:19:35.640
> 
> 标签：iphone, ios, objective-c, speech-to-text

我想在我的 Xcode 项目中使用语音到文本库。我成功地将“ [Speech-To-Text](https://github.com/todoroo/iPhone-Speech-To-Text) ”库添加到我的 Xcode 项目中，并将头文件导入到我的应用程序中。我使用以下代码，但什么都不会发生。我看不到任何视图。

```
#import "SineWaveViewController.h"

SineWaveViewController *sineWav = [[SineWaveViewController alloc]init];

[self.navigationController pushViewController:sineWav animated:YES]; 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-14T11:27:03.870

```
- (id)init {
    self = [super init];
    if (self) {
        NSArray *cmds = [NSArray arrayWithObjects:@"Sing", @"Jump", @"Roll over", nil];
        recog = [[NSSpeechRecognizer alloc] init]; // recog is an ivar
        [recog setCommands:cmds];
        [recog setDelegate:self];
    }
    return self;
} 
```

# android - 如何在 android 2.3 及更高版本中设置没有操作栏的全息 UI 主题

> ID：15203672
> 
> 赞同：1
> 
> 时间：2013-03-04T14:19:48.287
> 
> 标签：android, android-theme, android-holo-everywhere

有没有办法在 android 2.3 中使用 Holo 主题而不使用 actionBar。我尝试使用 Holoeverywhere 库，但它也显示操作栏。此外，无论用户使用哪个操作系统版本（2.3.3 及更高版本），我都希望整个应用程序中的 Holo UI 相同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T03:34:33.770

将主题`Holo.Theme.NoActionBar`应用于活动。为了减少内存泄漏，您可以通过设置来禁用 abs `requireSherlock = false`，`onCreateConfig`就像在演示中一样。

# objective-c - HTTP Live Streaming Mac 应用程序

> ID：15203673
> 
> 赞同：0
> 
> 时间：2013-03-04T14:19:49.543
> 
> 标签：objective-c, cocoa, ffmpeg, avfoundation, http-live-streaming

我正在开发一个 Mac 应用程序，它需要为主屏幕（桌面）提供 HTTP 实时流（仅最后 2 秒左右）。

我正在考虑以下过程：

1.  使用 AVCaptureScreenInput 作为输入创建 AVCaptureSession (sessionPreset = AVCaptureSessionPresetPhoto)
2.  将 AVCaptureVideoDataOutput 输出添加到会话
3.  在 captureOutput:didDropSampleBuffer:fromConnection: 中捕获帧（采用 kCVPixelFormatType_32BGRA 格式）并将它们写入 ffmpeg 进程以进行分段（使用管道或其他东西），从而创建 MPEG-TS 和播放列表文件。
4.  使用嵌入式 HTTP 服务器来提供分段文件和播放列表文件。

这是最好的方法吗？是否没有办法绕过 ffmpeg 部分来编码和分割视频流？

将原始帧传输到 ffmpeg 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:52:01.447

这听起来是个不错的方法。您可以使用将 ffmpeg 输出到流并使用 Apple 的分段工具对其进行分段。我相信 Apple 工具的复用率稍好一些，但这对您的用例可能无关紧要。

# iphone - 如何使用核心图形图层绘图

> ID：15203678
> 
> 赞同：-4
> 
> 时间：2013-03-04T14:20:05.590
> 
> 标签：iphone, core-graphics, calayer

谁能告诉我如何用图案（蝴蝶）上色，如以下链接[链接](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_layers/dq_layers.html#//apple_ref/doc/uid/TP30001066-CH219-TPXREF101)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T01:36:27.573

除了阅读您在原始问题中发布的完整[CGLayer](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGLayer/Reference/reference.html)参考资料外，我强烈建议您观看 2012 年 WWDC 的“[优化 2D 图形和动画性能](https://developer.apple.com/videos/wwdc/2012/)”会议。

[随着您的进步，我想您会发现使用Quartz 2D](https://developer.apple.com/library/ios/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/Introduction/Introduction.html)和[Core Animation](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)之类的工具将内容绘制到屏幕上并不是特别困难，但真正的挑战是以达到可接受的性能水平的方式进行。

在会议中，他们优化了与您要创建的绘图应用程序类似的绘图应用程序。他们用来优化绘图应用程序的基本原则是：

*   只更新尽可能少的屏幕
*   每隔一段时间就会创建一个用户绘制的平面合成图像，并在进行绘图操作时重新使用该图像。这避免了必须将用户绘制的所有内容单独绘制到画布上，从而提高应用程序的性能。

除此之外，它们还涵盖了一系列技巧来挤出每一滴性能。

很抱歉我没有给你的代码示例（我通常喜欢我的答案包括一些），但你的问题非常广泛。我建议您观看我建议的视频，继续您的研究并尝试自己开始实施该应用程序。一旦遇到更具体的问题，如果在其他地方找不到问题，您可以返回此处寻求答案。

祝你好运！

# oracle - Oracle 数据库 11g .pkb 和 .pks 文件

> ID：15203682
> 
> 赞同：1
> 
> 时间：2013-03-04T14:20:19.657
> 
> 标签：oracle, stored-procedures, oracle11g

我有 filename.pkb 和 filename.pks 文件。这些文件里面有存储过程，如果 .pks 文件包含存储过程签名并且 .pkb 文件包含二进制源，我如何将它们加载到模式中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-05-01T00:00:17.747

如果您使用具有正确权限的用户使用 sqlplus 连接到数据库，您应该能够执行以下操作：

```
@filename.pks
@filename.pkb 
```

应加载规范和正文。

鲍比

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:26:53.577

只需编译它们。如果 pkb 文件似乎包含二进制文件，则它可能只是被[混淆](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/wrap.htm)了并且无论如何都会编译。

# php - 是否可以让 php 只向错误日志报告错误？

> ID：15203687
> 
> 赞同：0
> 
> 时间：2013-03-04T14:20:45.933
> 
> 标签：php, error-logging

如标题所述。

我的网站已移至更新的环境，并且出现了一些非关键错误。我想禁止网站上的所有警告，但仍希望将它们记录到标准 error_log 中，这样我就可以修复错误，而不会让我的网站看起来无法正常工作。

有没有一些简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:23:49.527

```
error_log = /var/log/php-scripts.log
display_errors = Off 
```

修改php.ini如上图。并重新启动 apache 以加载新的 php.ini

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:23:00.627

相关设置见[这里。](http://php.net/manual/en/errorfunc.configuration.php)`php.ini`您需要特别注意`display_errors`,`log_errors`和`error_log`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:32:34.563

在 php.ini 集中（查找现有条目并更改它们）

```
display_errors to "0" 
```

禁用错误输出并设置

```
log_errors to "1" 
```

启用错误记录。

You should be able to use [ini_set()](http://www.php.net/manual/en/function.ini-set.php) as well as [.htaccess](http://davidwalsh.name/php-values-htaccess) to set these values as they are both marked as INI_ALL if you don't have access to php.ini

# scala - （重新）在scala中定义（）

> ID：15203691
> 
> 赞同：4
> 
> 时间：2013-03-04T14:20:50.957
> 
> 标签：scala

假设我在 scala 中有一个 MyList 类，其中一个列表作为私有成员。是否可以为我的类定义“（）”以在给出正索引的情况下返回预期的内容，并在负索引的情况下从结尾开始（就像在 python 中一样）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T14:46:33.310

这可以通过以下`apply`方法完成：

```
class PythonicArray {
   private val underlying = Array(1,2,3,4)

   def apply(n: Int) = {
    val i = if (n < 0) (underlying.length + n) else n
    underlying(i)
   } 
} 
```

# mysql - 如何在mysql中找到一段时间内的日平均值？

> ID：15203695
> 
> 赞同：0
> 
> 时间：2013-03-04T14:20:58.870
> 
> 标签：mysql, sql, database

我有一个表，其中有两列：

**分数**

**CREAT_TS**

我想要两个日期范围之间的每日平均分数（例如 startDate 和 endDate）

我进行了以下查询：

```
select SUM(MARKS)/ COUNT(date(CREAT_TS)) AS DAILY_AVG_MARKS, 

date(CREAT_TS) AS DATE 

from TABLENAME

group by date(CREAT_TS) 
```

使用此查询，只有当数据库中有该日期的行时，我才能获得每日平均值。但我的要求是，即使没有行，我也想在那个日期显示 0。我的意思是如果 (startDate, endDate) 之间有 X 天，我希望查询返回 X 行

谁能帮我。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:49:58.780

您需要创建一组可以添加到日期的整数。下面会给你一个思路：

```
select thedate, avg(Marks) as DAILY_AVG_MARKS
from (select startdate+ interval num day as thedate
      from (select d1.d + 10 * d2.d + 100*d3.d as num
            from (select 0 as d union select 1 union select 2 union select 3 union select 4 union
                  select 5 union select 6 union select 7 union select 8 union select 9
                 ) d1 cross join
                 (select 0 as d union select 1 union select 2 union select 3 union select 4 union
                  select 5 union select 6 union select 7 union select 8 union select 9
                 ) d2 cross join
                 (select 0 as d union select 1 union select 2 union select 3 union select 4 union
                  select 5 union select 6 union select 7 union select 8 union select 9
                 ) d3
            ) n cross join
            (select XXX as startdate, YYY as enddate) const
       where startdate + num <= enddate
      ) left outer join
      tablename t
      on date(CREAT_TS) = thedate
group by thedate 
```

复杂性在于为报告创建一组连续日期。如果你有一个`numbers`表或一个`calendar`表，那么 SQL 看起来要简单得多。

这是如何运作的？第一个大子查询有两个部分。第一个只是通过交叉连接数字 0-9 并做一些算术来生成从 0 到 999 的数字。第二个将它连接到两个日期，`startdate`并且`enddate`- 您需要为 XXX 和 YYY 输入正确的值。使用此表，您可以获得两个值之间的所有日期。如果您需要超过 999 天，只需添加另一个交叉连接。

这是左连接到您的数据表。结果是分组依据的所有日期都出现了。

在报告方面，在表示层执行此操作有利有弊。基本上，在 SQL 中执行此操作的优点是报表层更简单。在报告层这样做的好处是 SQL 更简单。外人很难做出这样的判断。

My suggestion would be to create a numbers table that you can just use in reports like this. Then the query will look simpler and you won't have to change the reporting layer.

# regex - 友好的 URLs htaccess 重写规则正则表达式

> ID：15203699
> 
> 赞同：1
> 
> 时间：2013-03-04T14:21:01.583
> 
> 标签：regex, apache, .htaccess, url-rewriting, friendly-url

我试图弄清楚为什么我的 htaccess 文件中的重写规则没有将 URL 更改为更“SEO 友好的 URL”。

这是我的意思的一个例子：

我想从这个出发：

```
www.mydomain.com/Folder/post.php?url="how-to-make-me-a-happy-camper" 
```

对此：

```
www.mydomain.com/Folder/how-to-make-me-a-happy-camper 
```

或这个：

```
www.mydomain.com/Folder/post/how-to-make-me-a-happy-camper 
```

这是我的 htacess 代码：

```
RewriteEngine on
RewriteRule ^post/([a-zA-Z0-9-/]+)$ /post.php?url=$1 
```

或没有帖子/

我似乎无法使正则表达式正常工作，因为当我点击链接时，它会将我带到 `www.mydomain.com/Folder/post.php?url=how-to-make-me-a-happy-camper`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:27:54.767

尽管这个问题令人困惑（描述与重写规则所指示的相反）并且没有所有必需的信息，但您可以在根目录中的一个 .htaccess 文件中尝试此操作：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI} !post\.php             [NC]
RewriteCond %{REQUEST_URI} ^/Folder               [NC]
RewriteRule ^.*/([^/]+)/? /Folder/post.php?url=$1 [L] 
```

静默地图

`http://www.mydomain.com/Folder/post/anything`或者

`http://www.mydomain.com/Folder/anything`

到

`http://www.mydomain.com/Folder/post.php?url=anything`

字符串`post`和`anything`假定是可变的，而`Folder`脚本名称（post.php）假定是固定的。

对于永久和可见的重定向，将 [L] 替换为 [R=301,L]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:40:17.283

在您的 htaccess 文件中使用 RewriteBase 选项。

```
 RewriteBase / #( or if your document root in a subfolder named Folder: /Folder/ ) 
```

并且您应该添加两个 RewriteCondition，因此您的 .htaccess 文件（它不连接到您的主题，但如果您使用 apache rewrite_mod 则推荐）应该如下所示：

```
RewriteEngine on

RewriteBase /Folder/
RewriteCond %{REQUEST_FILENAME} !-f # the requested uri does not points to a file
RewriteCond %{REQUEST_FILENAME} !-d # the requested uri does not points to a directory
RewriteRule ^post/([a-zA-Z0-9-/]+)$ post.php?url=$1 
```

而且，.htacces 文件应该是您的 post.php 文件所在的位置。（在这种情况下在名为文件夹的目录中）

# sql-server - 数据仓库中的列存储

> ID：15203700
> 
> 赞同：0
> 
> 时间：2013-03-04T14:21:03.257
> 
> 标签：sql-server, data-warehouse, columnstore

我有一个关于数据仓库和面向列的数据库的问题。在我的项目中，该公司在 Visual Studio SQL Server 中使用仓库解决方案，他们在查询大量数据的复杂问题时遇到性能问题。我想尝试用基于列的数据库替换数据库。我知道您可以将面向行的数据库“转换”为更多基于列的数据库，或者使用开源数据库，例如 Vertica 或 Sybase IQ，我只是想知道它如何适合仓库？您是否必须在仓库中有星型连接模式，或者您可以使用列式方法，我意识到这是一个愚蠢的问题，但我只是在开始探索不同的数据库和解决方案之前试图理解它。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:09:30.833

> 您是否必须在仓库中使用星型连接模式，或者您可以使用列式方法来代替？

星型连接模式由数据仓库的表定义组成。星型模式和类似模式以查询性能换取查询灵活性。通常，查询灵活性比数据仓库中的查询性能更重要。

根据您在评论中链接到的[Wikipedia 文章](http://en.wikipedia.org/wiki/Column-oriented_DBMS)，面向列的数据库引擎按列顺序存储实际的数据库字节，而不是关系数据库的传统行顺序。

正如文章所说，这可以提高磁盘访问性能。

星型模式是您定义表的方式。面向列的数据库引擎关注如何将数据库信息写入磁盘。这两个概念彼此无关，只是它们都适用于数据仓库。

保留您当前的数据仓库模式，并查看面向列的数据库引擎是否会提高查询性能。

# javascript - javascript中的拆分函数以输入类型=“文本”

> ID：15203705
> 
> 赞同：0
> 
> 时间：2013-03-04T14:21:19.490
> 
> 标签：javascript

我通过谷歌找到了一些我可以使用的代码，应该更正它以适合我，但是当我从下拉菜单中选择一些东西时，什么也没有发生。不知道我做错了什么。

```
<select name="h1" id="h1">
            <?php

            echo "<option value=".$rowlift['H1'].">".$rowlift['H1']."</option>";
                $pris = mysql_query("SELECT * FROM priser ORDER BY id ASC");

            while($rowP = mysql_fetch_assoc($pris))

                echo "<option value='".$rowP['pris'].",".$rowP['id']."'>".$rowP['hojde']. "</option>";
            ?>
        </select>

<?php
            if($rowlift['p1'] != '')
                echo "<input type='text' id='pris1' name='p1' value='".$rowlift['p1']."'>";
            else
                echo "<input type='text' id='pris1' name='p1'>"
            ?>

     <script type="text/javascript">
    var mytextbox = document.getElementById('pris1');
    var mydropdown = document.getElementById('h1');

    var mySplitResult = mydropdown.split(",");

    mydropdown.onchange = function(){
           mytextbox.value = mySplitResult[0];
    }
    </script> 
```

我希望这是您正在寻找的想法..当我选择某些东西时，什么也没有发生。

```
 <select name="h1" id="h1">
      <option value=""></option>
      <option value="80,1">1000m</option>
      <option value="90,2">1200m</option>
      <option value="100,3">1500m</option>
      <option value="110,4">2000m</option>
      <option value="120,5">2250m</option>
      <option value="130,6">2500m</option>
      <option value="140,7">3000m</option>
      <option value="150,8">3500m</option>
      <option value="160,9">4000m</option>
      <option value="160,10">Elev man.</option>
      <option value="160,11">Elev auto</option>
      <option value="0,12">HM</option>
      <option value="2000,13">Tandem pass u/video</option>
      <option value="2300,14">Tandem håndhold video</option>
      <option value="2600,15">Tandem pass m/video</option>
      <option value="0,16">Tandem master</option>
      <option value="-100,17">Tandem video</option>
    </select>
   <td>
            <input type="text" id="pris1" name="p1">        <script type="text/javascript">
            var dropdownId = document.getElementById("h1");
            var mytextbox = document.getElementById('pris1');

            var mySplitResult = strUser .split(",");

        dropdownId.onchange = function(){
               mytextbox.value = mySplitResult[1] //to (not) appened
             //mytextbox.innerHTML = this.value;
        }
        </script>

            </td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:26:03.890

我认为应该是`mydropdown.value.split(',');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T11:45:05.863

应该是这样的.. :D

```
 <select name="sel1" id="sel1" onchange ="show()" >
          <option value="">Choose .....</option>
          <option value="80~1">1000m</option>
          <option value="90~2">1200m</option>
          <option value="100~3">1500m</option>
          <option value="110~4">2000m</option>
          <option value="120~5">2250m</option>
          <option value="130~6">2500m</option>
          <option value="140~7">3000m</option>
          <option value="150~8">3500m</option>
          <option value="160~9">4000m</option>
          <option value="160~10">Elev man.</option>
          <option value="160~11">Elev auto</option>
          <option value="0~12">HM</option>
          <option value="2000~3">Tandem pass u/video</option>
          <option value="2300~14">Tandem håndhold video</option>
          <option value="2600~15">Tandem pass m/video</option>
          <option value="0~16">Tandem master</option>
          <option value="-100~17">Tandem video</option>
        </select>
       <td>
    <input type="text" id="pris1" name="pris1">      

    <script type="text/javascript">

    function show() {
    var dropdownId = document.getElementById("sel1").value;
    var mytextbox = document.getElementById('pris1');
    var mySplitResult = dropdownId .split("~");
    mytextbox.value = mySplitResult[0];
    }

    </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:29:05.777

```
var dropdownId = document.getElementById("yourdropdownId");
var strUser = dropdownId .options[dropdownId .selectedIndex].value;

var mySplitResult = strUser .split(","); 
```

将上面的代码包装在 onchange() 中

# mongodb - Spring Data MongoDB 防止持久化某些字段

> ID：15203709
> 
> 赞同：6
> 
> 时间：2013-03-04T14:21:22.420
> 
> 标签：mongodb, persistence, spring-data

我正在使用 Spring Data for MongoDB 来持久化我的域对象。我想知道是否有办法（可能使用注释？）来防止 Spring Data 将某些字段持久化到 MongoDB 中？

有人知道该怎么做还是我必须编写自己的映射器？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-05T11:38:02.207

在这种情况下，请使用`@Transient`您需要忽略的字段的注释。

在这里看更多 -[瞬态](http://docs.spring.io/spring-data/data-commons/docs/current/api/org/springframework/data/annotation/Transient.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-10T05:43:59.917

如果您正在寻找像我一样的实际包裹，这个可以工作：

```
import org.springframework.data.annotation.Transient; 
```

来自[Spring 框架 API](http://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/annotation/Transient.html)文档。

但是这个是[JPA](http://en.wikipedia.org/wiki/Java_Persistence_API)注释，不适用于 Spring Data 的 MongoDB：

```
import javax.persistence.Transient; 
```

这是[Java Persistence API](http://docs.oracle.com/javaee/5/api/javax/persistence/Transient.html)的一部分。

# build - jenkins 在构建失败后执行操作

> ID：15203711
> 
> 赞同：0
> 
> 时间：2013-03-04T14:21:23.553
> 
> 标签：build, jenkins

我只想在构建失败时处理一些操作。例如，如果运行时执行抛出了一个核心转储（当然，它并不总是发生）并且我想将它移动到某个地方，这样第二天的构建就不会删除它。

有谁知道在构建失败的情况下如何执行任何操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:19:30.787

试试[Groovy Postbuild 插件](https://wiki.jenkins-ci.org/display/JENKINS/Groovy+Postbuild+Plugin)。有了这个，您可以使用`hudson`api 检查构建是否失败，然后使用 groovy 脚本执行所需的操作。例如，您可以使用以下脚本检查构建是否不稳定或更好

```
if(manager.build.result.isBetterOrEqualTo(hudson.model.Result.UNSTABLE))
{
 \\ do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:28:08.693

好吧，如果它设置为记录到标准输出，它将在 Jenkins 日志中，如果没有，您可以将其设置为记录到您工作区中的文件，然后您可以根据名称打包为工件.. . 如果您在 posix 系统中运行，您可以将 stderr 重定向到 stdout 并将它们都定向到运行命令中的文件。或者通过三通管把它们放进去，这样你就可以把它们都放进去

# eclipse - Eclipse .metadata 文件夹超出工作区

> ID：15203713
> 
> 赞同：2
> 
> 时间：2013-03-04T14:21:33.563
> 
> 标签：eclipse

该`.metadata`目录位于我的工作区目录中。我可以配置 Eclipse 以使该`.metadata`目录不在工作区中吗？

原因是我们有很多开发人员使用同一个项目目录，如果每个人都在同一个工作区启动它的 Eclipse 实例，那么`.metadata`每个开发人员都会对其进行修改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T14:37:15.713

据我所知，没有办法让`.metadata`工作区目录之外的目录。但是，您可以*将实际项目*放在工作区目录之外！

*   为每个开发人员创建一个单独的工作空间，例如在该人的本地硬盘驱动器上。该工作区将保存该用户的`.metadata`目录以及对实际项目的*引用。*
*   *使用Import -> Existing Projects into Workspace*将项目从“共享工作区”（现在不再是 Eclipse 工作区而是普通的共享目录）导入到各个工作区。取消选中*将项目复制到工作区*复选框！

这样，每个开发人员都有自己的工作区，具有单独的设置等，而项目仍然驻留在共享目录中。但是，这可能会导致*严重*的问题，因为 Eclipse 不会意识到其他人正在编辑项目中的文件。因此，这*仅*应用作解决方法，以防 SVN 或 Git 等“适当的”版本控制系统*不是*一个选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T16:27:56.513

您不能配置 .metadata 目录的路径。

您尝试使用 Eclipse 的方式只会给您和您的团队带来悲伤。每个工作区都会跟踪它是否查看过文件的当前版本。如果多人编辑同一个项目文件，团队中的每个人都必须不断调用刷新。也有丢失更改的风险，因为一个团队成员可以轻松、默默地覆盖另一个人所做的更改。

更加努力地使用源代码控制系统。像 SVN 这样需要托管在某个地方的集中式系统并不是唯一的选择。像 git 这样的系统允许您在团队成员之间直接安全地交换更改。

# c# - 带有大量文本的 Clipboard.SetText 失败，没有错误 .NET

> ID：15203714
> 
> 赞同：1
> 
> 时间：2013-03-04T14:21:38.240
> 
> 标签：c#, .net, clipboard

我试图用来`Clipboard.SetText()`允许我的应用程序的用户将某些项目复制到剪贴板中。用户很可能会尝试将大量文本复制到剪贴板 (130 MB+)。我已经尝试了几次，然后当我将文本粘贴到另一个程序中时，什么也没有出现。我没有得到任何指示/异常`SetText()`操作失败。有没有一种方法可以检测到这一点，而无需实际从剪贴板读回并执行比较？或者也许我可以强制执行一个硬限制，以便在将错误消息发送到之前抛出错误消息`SetText()`？

非常感谢。

# ruby-on-rails - 用于显示的 Rails 嵌套路由错误

> ID：15203721
> 
> 赞同：0
> 
> 时间：2013-03-04T14:21:50.020
> 
> 标签：ruby-on-rails, controller, nested-routes

编辑3：当我尝试访问通过此方法创建的链接时，我为用户和文档设置了嵌套设置，该设计用于对用户进行身份验证

```
root :to => "users#index"

   resources :users do
   resources :documents
end 
```

然后我尝试列出所有文件：

```
 @documents.each do |doc|

     link_to(doc.title, [@user, doc]) 
```

但是我在尝试访问控制器中的私有 get_user 方法时遇到错误，这样做的正确方法是什么

该文档属于一个用户，但只给出了 user_id 我要使用它吗？

```
private #get_user should not be called outside contoller
def get_user
  @user = User.find(params[:user_id])
end 
```

错误：不应为外部控制器调用私有方法

编辑：似乎是被调用的 get_document 方法......

```
def get_document
  @document = @user.documents.find(params[:id])
end 
```

但是文档引用正在传递给路由不是吗？

编辑 2：文档的控制器代码：

```
 class DocumentsController < ApplicationController
before_filter :get_user
before_filter :get_document, :only => [:show, :update, :edit, :destroy] 
before_filter :authenticate_user!
load_and_authorize_resource

def new
  @document = @user.documents.build
end

def index
 if params[:tag]
  @documnets = Document.tagged_with(params[:tag])
 else
  @documents = Document.all
 end
end

def create
 @document = @user.documents.build(params[:document])
 if @document.save
  flash[:notice] = "Document has been created."
  redirect_to [@user, @document]
 else
  flash[:notice] = "Failed to create document."
  render :action => "new"
 end
end

def edit

end

def show

end

def update  
if @document.update_attributes(params[:document])
  flash[:notice] = "Update Complete"
  redirect_to [@user, @document]
else
  flash[:notice] = "Update Failed"
  render :action => "edit"
end
end

def destroy
 if @document.destroy
  flash[:notice] = "document deleted."
  redirect_to @user
 else 
  flash[:notice] = "Can't delete document"
  redirect_to [@user, @document]
 end
 end

private #get_user should not be called outside contoller
def get_user
  @user = User.find(params[:user_id])
end
public 
def get_document
  @document = @user.documents.find(params[:id])
end
end 
```

# .net - 为什么 .NET 货币格式包含货币符号？

> ID：15203726
> 
> 赞同：2
> 
> 时间：2013-03-04T14:22:06.487
> 
> 标签：.net, localization, currency

此代码：`Console.Out.WriteLine(string.Format(CultureInfo.GetCultureInfo("hu-HU"), "{0:C}", 1234.56M))`将产生以下输出：1 234,56 Ft，这在技术上是正确的，但它是如何猜测货币的呢？

这种行为意味着，只需将显示区域性从 hu-HU 更改为 en-US，该值将乘以 200 以上，具体取决于当前速率。你永远不会犯 500 福林兑换 500 美元的错误。明显的。

设置货币的唯一“好”方法是克隆所需的文化并设置货币符号：

```
var format = NumberFormatInfo.GetInstance(CultureInfo.GetCultureInfo("en-US")).Clone() as NumberFormatInfo;
format.CurrencySymbol = "asd";
Console.Out.WriteLine(string.Format(format, "{0:C}", 1234.56M)); 
```

这可以正常生产`asd1,234.56`，但非常麻烦。

我的问题是：

1.  在我们生活了几十年的这个全球化世界中，违约国家货币的比例是多少？
2.  为什么没有办法以更相关的方式指定金额和货币，因为它们如此耦合？
3.  奖励：如果我将 sk-SK 用于文化，我会得到欧元作为“默认”货币。如果我更改为 Framework 2.0，我应该得到`Sk`（对于斯洛伐克克朗），因为在 2005 年它是本国货币。（嗯，它不会发生。但我没有在任何不迟于 2.0 的系统上尝试过。）

更新：结论：

1.  文化中的违约货币对某些人来说是正常的，对其他人来说很奇怪（包括我）
2.  没有“金额”类型，因为没有长度、重量等类型，限制在哪里？Virtlink 为此创建了一个库：[M42 Financial](https://bitbucket.org/Virtlink/m42-financial/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:32:25.183

我改变了主意：我同意你的观点，货币是文化的一部分很奇怪。

在.NET 和 Java 中用值指定单位*并不常见。*您通常不会用单位指定温度、距离或货币。对于大多数意图和目的，开发人员假定单位：米表示距离，摄氏度表示温度。.NET 中没有为给定区域性指定默认距离单位或温度单位。

为了保持一致，.NET Framework 也不应该将货币信息添加到文化中。大多数人处理不止一种货币，有些国家甚至接受多种货币。并非特定文化的每个人都会使用一种且仅一种货币。

.NET 框架包含一个`System.Currency`类，但它是隐藏的（内部），并且仅用于`Decimal.ToOACurrency()`方法。它也不是很实用。Java 包含一个`Currency`自 2002 年以来的类，但由于 .NET Framework 是在 2000 年创建的，并且许多设计错误都是从 Java 中复制而来的，这可能就是其中之一。但是，我找不到有关 Java`Locale`类是否包含（或包含）任何货币信息的信息，而且我不是通灵者。

好吧，继续从 .NET 中从未指定单位的想法开始，并且不应该有文化的默认货币，那么他们应该将货币价值的货币单位放在哪里？当然，他们应该创建一个`Currency`类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:37:35.850

我只是认为这并不意味着在应用程序中可能出现多种货币时使用。当您有一个简单的应用程序将货币处理为必须以当地货币解释的数字时，它可能会很有用。

在所有其他情况下，请勿使用它。

我不认为有很多这样的应用程序是有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:32:13.293

我不能说设计师在想什么，但他们的决定对我来说很有意义。要回答您的问题：

1.  我们大多数人和我们的客户都使用单一货币，这取决于我们所居住的国家。默认为该文化的默认货币是有意义的。
2.  货币符号和数字格式是单独设置的，因为在更改货币符号时，您很可能希望保留默认数字格式。例如，如果我（在美国）以英镑打印一个金额，我不希望数字格式改变——只是货币符号。如果我必须同时设置它们，我不仅要知道新的货币符号，还要知道我正在使用的特定数字格式。此外，如果将它们组合在一起，那么更改数字格式（对于非货币值）也需要我指定货币符号。除非你有两种完全不同的数字格式……这太疯狂了。
3.  没有关于那个特定问题的答案。

简而言之，拥有两个单独的设置可以为您提供更大的灵活性并让事情变得简单。将事物结合起来会做更多的工作来单独改变事物。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T15:53:42.863

为什么 .NET 货币格式包含货币符号？

因为它是一种货币格式。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2013-03-04T14:24:20.677

我不知道 .NET，但您的格式化程序是否允许您在格式字符串中省略“M”？

所以这个：`1234.56`而不是这个`1234.56M`

# r - 预测警告

> ID：15203728
> 
> 赞同：0
> 
> 时间：2013-03-04T14:22:33.217
> 
> 标签：r, warnings, predict

我在尝试预测我的测试数据框的值时收到此警告。这是我构建树和预测的代码：

```
library(pgmm)
data(olive)
olive = olive[,-1]
tree2 <- tree(olive$Area ~ olive$Palmitic + olive$Palmitoleic+olive$Stearic+olive$Oleic+olive$Linoleic+olive$Linolenic+olive$Arachidic+olive$Eicosenoic,data=olive)
newdata = as.data.frame(t(colMeans(olive)))
pred1 <- predict(tree2,newdata) 
```

[我在这里](https://stackoverflow.com/questions/11802943/warning-when-calculating-predicted-values)读到了类似的帖子，所以我替换了这一行

```
newdata = as.data.frame(t(colMeans(olive))) 
```

经过

```
aa<-t(colMeans(olive))
aa[1,1]
newdata <- data.frame(Palmitic=aa[1,1],Palmitoleic=aa[1,2],Stearic=aa[1,3],Oleic=aa[1,4],Linoleic=aa[1,5],Linolenic=aa[1,6],Arachidic=aa[1,7],Eicosenoic=aa[1,8]) 
```

代码来命名我的数据集的列，但我仍然收到相同的警告并且预测是错误的：-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:24:04.530

（从评论升级。）

`$`尝试从您的模型中消除：

```
tree2 <- tree(Area ~ Palmitic + Palmitoleic+Stearic+Oleic+
    Linoleic+Linolenic+Arachidic+Eicosenoic,data=olive) 
```

原则上，您可以进一步简化为

```
tree(Area~.-Region,data=olive) 
```

where`.`指定“数据集中的所有其他变量”，并`-Region`表示您*不想*包含该`Region`变量。（糟糕，这实际上不起作用——尽管我认为它应该）

基本问题是`predict`试图寻找`newdata`原始模型中指定的预测变量的名称：它需要寻找`predvar`，而不是`origdata$predvar`。

我会使用：

```
predict(tree3,newdata=as.data.frame(rbind(colMeans(olive[-(1:2)])))) 
```

# google-apps-script - 当我未登录时，UiApp.getActiveApplication.remove(0) 不起作用

> ID：15203729
> 
> 赞同：0
> 
> 时间：2013-03-04T14:22:36.197
> 
> 标签：google-apps-script

我已将脚本发布为 webapp，并在我选择的设置中以我的身份运行脚本，任何人都可以访问它。

但是，我发现如果我没有登录，那么该应用程序不会被删除。在我的脚本中，每次列表框中的值发生变化时，当前应用程序的内容将被删除并读取小部件。如果我没有登录，当前应用程序的内容会保留，因此我将拥有应用程序中的内容以及嵌入其下方的新内容。

请帮助我，即使我没有登录，如何让 app.remove(0) 工作？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T00:54:27.617

我在 UiApp.getActiveApplication.remove (0) 之前添加 mainPanel.clear ()

这可以确保即使我没有登录该应用程序也会被删除。我认为它可能是气体怪癖或其他什么。因为我登录时不需要清除。

# android - android：字符串数组（复制全部或从另一个字符串数组中选择条件）

> ID：15203735
> 
> 赞同：0
> 
> 时间：2013-03-04T14:22:53.380
> 
> 标签：android, arrays, string

# 情况：

我在资源中有一个字符串数组，它由所有类型的问题组成。

如果用户单击所有类型，例如，选择全部，则`selection_question`字符串数组将复制 中的所有项目`all_question`。

然而，如果用户点击特定类型的问题，例如，只选择与动物相关的问题，那么`selection_question`字符串数组将复制`all_question`包含“动物”这个词的所有项目。

我的代码很简单如下：

**宣布：**

```
String[] all_Question ;
String[] selection_Question; 
```

**创建时：**

```
all_Question = getResources().getStringArray(R.array.all_Q_List); 
all_numberofquestions = all_Question.length;

// reset 
selection_numberofquestions = 0;
selection_Question = new String[0];
j =0; 
```

**如果要全选：**

```
for (int i = 0; i < all_numberofquestions ; i++) 
{
    selection_Question[i] = all_Question [i];
} 
```

**如果根据一些标准进行选择：**

```
for (int i = 0; i < all_numberofquestions ; i++) 
{
    if (all_Question [i].contains("animal"))
    {
        selection_Question [j] = all_Question [i];
        j++;
    }
} 
```

# 问题：

然后它会弹出以下错误，如 Logcat 所示：

```
03-04 22:14:10.568: E/AndroidRuntime(24917): Caused by: java.lang.ArrayIndexOutOfBoundsException: length=0; index=0 
```

我不明白为什么它是越界？如何修改上述代码？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:25:34.883

这就是问题。

`selection_Question = new String[0];`

应该是

`selection_Question = new String[all_numberofquestions];`

甚至你的`all_question`可能是`blank/empty`。

# php - 在 PHP 中输 入路径

> ID：15203741
> 
> 赞同：0
> 
> 时间：2013-03-04T14:23:20.067
> 
> 标签：php

我知道这看起来很简单，但它让我发疯。

我的域中有 3 个文件夹，它们是：

1.  行政
2.  来源
3.  目的地

所有三个文件夹都在同一级别。

在 admin 文件夹中，我有一个名为 xyz.php 的 PHP 文件

这个 PHP 基本上将文件从“源”文件夹传输到“目标”文件夹。该脚本工作正常。但是当我把 xyz.php 放在 admin 中时，它就停止了。基本上是因为 xyz.php 使用“源”和“目标”的路径。由于我将其转移给管理员，因此我无法找到文件夹的正确路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:29:03.177

那应该工作：

> $ImagesDirectory = '../source/';
> 
> $DestImagesDirectory = '../destination/';

把前面的斜线去掉...

# mysql - 如何解决这个问题 - 无法删除或更新父行：外键约束失败

> ID：15203742
> 
> 赞同：0
> 
> 时间：2013-03-04T14:23:26.593
> 
> 标签：mysql, sql-delete, drop-table

我正在尝试删除表，但出现此错误：

> 无法删除或更新父行：外键约束失败

有些人可以帮助我：

声明：`DROP TABLE vehiculo` 错误：`#1217 - Cannot delete or update a parent row: a foreign key constraint fails`

与vehiculo有关系的表：

```
CREATE TABLE `vehiculo` (
 `numero_movil` int(3) unsigned NOT NULL,
 `numeroChasis` varchar(30) COLLATE utf8_spanish2_ci NOT NULL,
 `numeroMotor` varchar(30) COLLATE utf8_spanish2_ci NOT NULL,
 `Marca` varchar(15) COLLATE utf8_spanish2_ci NOT NULL,
 `Modelo` smallint(5) unsigned NOT NULL,
 `Color` varchar(10) COLLATE utf8_spanish2_ci NOT NULL,
 `Propietario_Cedula` int(11) NOT NULL,
 `Cuota` int(11) NOT NULL,
 `Turno_idTurno` tinyint(3) unsigned NOT NULL,
 `estado_pago_central` int(11) NOT NULL,
 `DocumentoVehiculo` int(10) unsigned NOT NULL,
 `f_numero_movil` int(10) unsigned NOT NULL,
 `f_Propietario_Cedula` int(11) NOT NULL,
 `idEstadoPapelesVehiculo` tinyint(3) unsigned NOT NULL,
 `placa` varchar(8) COLLATE utf8_spanish2_ci NOT NULL,
 PRIMARY KEY (`numero_movil`,`Propietario_Cedula`,`Turno_idTurno`,`estado_pago_central`,`DocumentoVehiculo`,`f_numero_movil`,`f_Propietario_Cedula`,`idEstadoPapelesVehiculo`),
 UNIQUE KEY `numeroChasis_UNIQUE` (`numeroChasis`),
 UNIQUE KEY `numeroMotor_UNIQUE` (`numeroMotor`),
 KEY `fk_Vehiculo_Propietario1_idx` (`Propietario_Cedula`),
 KEY `fk_Vehiculo_Turno1_idx` (`Turno_idTurno`),
 KEY `fk_Vehiculo_estado_pago_central1_idx` (`estado_pago_central`),
 KEY `fk_Vehiculo_DocumentosVehiculo1_idx` (`DocumentoVehiculo`,`f_numero_movil`,`f_Propietario_Cedula`,`idEstadoPapelesVehiculo`),
 CONSTRAINT `fk_Vehiculo_DocumentosVehiculo1` FOREIGN KEY (`DocumentoVehiculo`, `f_numero_movil`, `f_Propietario_Cedula`, `idEstadoPapelesVehiculo`) REFERENCES `documentosvehiculo` (`idDocumentoVehiculo`, `Vehiculo_numero_movil`, `Vehiculo_Propietario_Cedula`, `EstadoPapelesVehiculo_idEstadoPapelesVehiculo`) ON DELETE NO ACTION ON UPDATE NO ACTION,
 CONSTRAINT `fk_Vehiculo_estado_pago_central1` FOREIGN KEY (`estado_pago_central`) REFERENCES `estado_pago_central` (`idestado`) ON DELETE NO ACTION ON UPDATE NO ACTION,
 CONSTRAINT `fk_Vehiculo_Turno1` FOREIGN KEY (`Turno_idTurno`) REFERENCES `turno` (`idTurno`) ON DELETE NO ACTION ON UPDATE NO ACTION,
 CONSTRAINT `vehiculo_ibfk_1` FOREIGN KEY (`Propietario_Cedula`) REFERENCES `propietario` (`Cedula`) ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish2_ci

CREATE TABLE `estadopapelesvehiculo` (  `idEstadoPapelesVehiculo` tinyint(3) unsigned NOT NULL,  `EstadoPapelesVehiculocol` varchar(45) COLLATE utf8_spanish2_ci NOT NULL,  PRIMARY KEY (`idEstadoPapelesVehiculo`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish2_ci

CREATE TABLE `propietario` (  `Cedula` int(11) NOT NULL,  `apellidos` varchar(30) COLLATE utf8_spanish2_ci NOT NULL,  `nombre` varchar(30) COLLATE utf8_spanish2_ci NOT NULL,  `fechaNacimiento` date NOT NULL,  PRIMARY KEY (`Cedula`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish2_ci 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:26:40.973

您有一个表，该表依赖于该表内的数据，并且正在阻止删除或删除该行。如果您发现任何表依赖于它，您可以删除它们，或删除约束，然后删除车辆表。

# css - 用css水平显示div

> ID：15203745
> 
> 赞同：0
> 
> 时间：2013-03-04T14:23:32.890
> 
> 标签：css, html

我是网页设计的新手，我尝试了几种方法将我的按钮水平`<div>`放在一个中`<div>`。我尝试使用`display:inline-block`，`float:left`但都没有奏效。请有人告诉我那里的错误是[什么](http://jsfiddle.net/wZf4C)：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:29:36.740

你`clear:both`在那里有一个声明，它有效地使你的`float:left;`. 此外，您的包含 div 的尺寸很小，只有 125 像素，这可能太小而无法容纳您的浮动。您可以让容器自动调整大小，并在进入图形设计阶段后限制大小。

此外，您还有很多不必要的并且可能有错误的标记。在投入大量时间和金钱进行维护之前，您应该考虑进行系统的重写。您可能会以更简单、不易出错的方式获得相同的布局。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T14:30:34.150

约扎！调试的第一条规则：简化你的条件。你有大量的 CSS 打包到那个小提琴中，这使得任何人都很难将你的问题归零。

你有两件事阻止你的按钮水平出现在同一行。

```
.pin .actions {
    width: 125px;
} 
```

这使得容器太窄，每行不能容纳一个以上的按钮。尝试将其更改为 300 像素。（或者，你知道，任何更大的东西。）

```
.actions .WhiteButton.Button11 {
    clear: both;
} 
```

这种风格意味着在按钮的右侧或左侧都不允许浮动项目。

改变这两个，你应该有你想要的。

[http://jsfiddle.net/nate/wZf4C/2/](http://jsfiddle.net/nate/wZf4C/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:32:31.307

```
<style>
.grid{
    width:200px;
    height:200px;
    background-color:#666666;
    float:left;
    margin:5px;
}
</style>

<div class="grid">Div 1</div>
<div class="grid">Div 2</div>
<div class="grid">Div 3</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T15:06:59.053

我认为一个简单的 css 代码行可以解决您的问题。

```
maring-left:auto;
margin-right:auto; 
```

当我想对齐`div`或`span`水平对齐时，我会使用这个技巧

# android - 从文件夹中获取所有音频文件

> ID：15203751
> 
> 赞同：2
> 
> 时间：2013-03-04T14:24:09.103
> 
> 标签：android

如何使用 managedQuery() 从 android 的特定文件夹中获取所有音频文件。表示在 managedQuery() 中应该使用 where 子句来过滤 Cursor 结果。

代码是：

```
String[] proj = { MediaStore.Audio.Media._ID, MediaStore.Audio.Media.DATA, MediaStore.Audio.Media.DISPLAY_NAME, MediaStore.Audio.Media.DURATION };
Cursor cursor = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,proj, /*where clause here*/, null, null); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-21T05:46:44.830

IS_MUSIC != 0 AND DATA LIKE '/dir/%':

```
String selection = MediaStore.Audio.Media.IS_MUSIC + " != 0 AND " +
            MediaStore.Audio.Media.DATA + " LIKE '/mnt/sdcard/Music/SomeArtist/%'"; 
```

这会将您的 managedQuery 结果限制在 .../SomeArtist/ 目录中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T06:34:27.393

我希望您检查文件的扩展名以检查它是否是上述代码中的媒体文件

```
public class ReadAllFilesFromPathActivity extends Activity {
private List<String> myList;
File file;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
ListView listView = (ListView) findViewById(R.id.mylist);
myList = new ArrayList<String>();

File directory = Environment.getExternalStorageDirectory();
file = new File( directory + "/Test" );
File list[] = file.listFiles();

for( int i=0; i< list.length; i++)
{
    if(checkFileExtension( list[i].getName() )
    {
         myList.add( list[i].getName() );
    }
}
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, android.R.id.text1, myList);
listView.setAdapter(adapter); //Set all the file in the list.
}
} 
```

并添加以下方法来检查扩展。在枚举中添加了扩展

```
private boolean checkExtension( String fileName ) {
    String ext = getFileExtension(fileName);
    if ( ext == null) return false;
    try {
        if ( SupportedFileFormat.valueOf(ext.toUpperCase()) != null ) {
            return true;
        }
    } catch(IllegalArgumentException e) {
        return false;    
    }
    return false; 
}

public String getFileExtension( String fileName ) {
    int i = fileName.lastIndexOf('.');
    if (i > 0) {
        return fileName.substring(i+1);
    } else 
        return null;
} 
```

和支持的扩展的枚举（你也可以添加你自己的）

```
public enum SupportedFileFormat
{
    _3GP("3gp"),
    MP4("mp4"),
    M4A("m4a"),
    AAC("aac"),
    TS("ts"),
    FLAC("flac"),
    MP3("mp3"),
    MID("mid"),
    XMF("xmf"),
    MXMF("mxmf"),
    RTTTL("rtttl"),
    RTX("rtx"),
    OTA("ota"),
    IMY("imy"),
    OGG("ogg"),
    MKV("mkv"),
    WAV("wav");

    private String filesuffix;

    SupportedFileFormat( String filesuffix ) {
        this.filesuffix = filesuffix;
    }

    public String getFilesuffix() {
        return filesuffix;
    }
} 
```

这是更多的代码，但可以帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-16T05:05:54.690

这是我的代码，它与我的特定目录路径一起使用

我做了一个光标，并在它的帮助下找到了我目录中的所有歌曲。

DOWNLOAD_FILE_DIR 有我的目录的路径

```
public static final  String DOWNLOAD_FILE_DIR = Environment.getExternalStorageDirectory().getPath() + "/MYDIR"; 
```

这是查找该目录的歌曲的查询。

```
String selection = MediaStore.Audio.Media.IS_MUSIC + " != 0 AND " +
        MediaStore.Audio.Media.DATA + " LIKE '"+DOWNLOAD_FILE_DIR+"/%'" 
```

这将返回一个游标。

```
context.getContentResolver().query(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
                null, selection, null, null); 
```

# wpf - 在 MVVM 模式中使用超链接的单元格模板

> ID：15203753
> 
> 赞同：5
> 
> 时间：2013-03-04T14:24:11.290
> 
> 标签：wpf, xaml, mvvm, hyperlink, icommand

我试图在 a 中插入一个超链接`DataGrid`并找到一种方法，以便`RequestNavigate`使用 MVVM 模式实现该行为。

到目前为止，我已经尝试了很多解决方案，但没有一个有效。请问你能帮帮我吗？

这是我的 xaml 代码：

```
<dgWPFCtrl:ExtDataGridTemplateColumn  Header="Link to XXX"  Width="*">
                    <dgWPFCtrl:ExtDataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock >
                                <Hyperlink NavigateUri="{Binding Path=ID_HTTP_LINK}"
                                           >
                                    <TextBlock Text="{Binding Path=ID_HTTP_LINK}"/>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="RequestNavigate">
                                            <WPFCtrl:EventToCommand 
                                                PassEventArgsToCommand="True"
                                                Command="{Binding Path=OpenLinkCommand}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Hyperlink>
                            </TextBlock>
                        </DataTemplate>
                    </dgWPFCtrl:ExtDataGridTemplateColumn.CellTemplate>
                </dgWPFCtrl:ExtDataGridTemplateColumn> 
```

并遵循相对`ICommand`发展：

```
//Command for open link
RelayCommand _openLinkCommand;
public ICommand OpenLinkCommand
{
    get
    {
        if (_openLinkCommand == null)
            _openLinkCommand = new RelayCommand(param => 
            {
                //Command Body ...
            });
        return _openLinkCommand;
    }
} 
```

我哪里错了？没想到，`ICommand`甚至从未调用过！

我也尝试使用其他类型的事件（例如`MouseEnter`），但没有任何改变！

预先感谢您的贡献，

代比

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-04T15:00:54.543

超链接的 DataContext 是由 DataGridRow 表示的对象，而不是您的 ViewModel。因此，您必须使用绑定方法来获取该 ViewModel（RelativeSource AncestorType 或 ElementName）。

**ElementName（假设您的 DataGrid 名为“myDataGrid”）**

```
Command="{Binding ElementName=myDataGrid, Path=DataContext.OpenLinkCommand}" 
```

**相对来源**

```
Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}, Path=DataContext.OpenLinkCommand}" 
```

# knockout.js - 使用 Jquery 模板从 observableArray 填充表行

> ID：15203754
> 
> 赞同：0
> 
> 时间：2013-03-04T14:24:15.687
> 
> 标签：knockout.js, jquery-templates

我正在使用 knockoutjs v1.2.0 和 Jquery 模板。我会使用 data-bind: foreach 等，但我发现它只出现在 knockoutjs 的 v2.0.0 中。所以我将不得不使用 jquery 模板。

我的 aspx 文件有以下代码：

```
....
....
....
<tbody data-bind="template: {name: 'tasksTemplate', foreach: form.model.tasks}">                           
                            </tbody>                                
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <script id="tasksTemplate" type="text/html">
                                <tr>
                                    <td>
                                        <input id="Selected" type="checkbox" data-bind="checked: ${isSelected}" />
                                    </td>
                                    <td>
                                        <select id="CableCode" data-bind="options: CableCodes, value: ${CableCodeId}, optionsText: 'Code', optionsValue: 'Id'" style="width: 95%"></select>
                                    </td>
                                    <td>
                                        <input type="text" />
                                    </td>
                                    <td>
                                        <input type="text"/>
                                    </td>
                                    <td>
                                        <select style="width: 95%"></select>
                                    </td>
                                    <td>
                                        <input type="text" class="datePicker" />
                                    </td>
                                    <td>
                                        <input type="text" class="datePicker" disabled="disabled" />
                                    </td>
                                    <td>
                                        <input type="text" disabled="disabled" />
                                    </td>
                                </tr>   
                             </script> 
</asp:Content> 
```

并且我保存表单对象（包含所有函数和可观察对象等）的 js 文件具有以下代码：

```
....
....    
self.tasks = ko.observableArray([]);
    self.addTask = function () {
        self.tasks.push({'isSelected': '', 'CableCodeId': '' });
    };
....
.... 
```

但是，即使当我加载页面时，当我尝试使用 addTask 函数向我的表中添加一行时，我也没有收到任何 js 错误，但我得到了一个**错误：预期的标识符、字符串或数字。**

我尝试从 isSelected 和 CableCodeId 中去掉单引号，但仍然没有。

我还尝试关闭第二个数据绑定（关于 CableCode 的那个），所以我只能检查第一个（isSelected）但我仍然得到同样的错误。

我也在使用 IE 8。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:26:31.400

为什么你的绑定参数周围有一个 $ ？

```
checked: ${isSelected} 
```

删除它，然后重试。

```
checked: isSelected 
```

看看这是否有效。

# javascript - 在 DOM 或 JS 对象中存储数据和元数据？哪个是高性能的？

> ID：15203755
> 
> 赞同：0
> 
> 时间：2013-03-04T14:24:19.850
> 
> 标签：javascript, dom, object, performance

我有一个带有元素的表单，我需要根据下拉值动态地为每个主表单元素创建一个包含更多元素的字段集/子表单。在表单元素的子表单之间移动时，我需要注意显示/隐藏子表单，同时保留子表单中的值。

您认为哪种方法高效？

在 DOM 中有 1 个子表单/字段集，并在 JS 内部维护一个主 JS 对象（如 JSON 的名称：值对），该对象将包含表单元素的信息，其子表单元素的数据和元数据提交时，只需发送将字符串化的 JS 对象发送到服务器。

此方法涉及每次需要添加新字段集或编辑字段集（用户认为已创建）时创建和删除 DOM 元素。

或者

在 DOM 中创建字段集的克隆，并在需要时执行 display:none/block。元数据将作为属性存储在子表单元素上，数据将在 DOM 本身中。在提交之前，循环遍历主表单元素的字段集中的子表单元素（使用选择器），构建一个类似的 JS 对象，字符串化并发送到服务器。

此方法涉及在 DOM 元素上设置属性，根据需要执行 display:none/block 以及在提交以形成主 JS 对象之前的最终循环。

截屏 ：![显示属性的子表单和 dom](../Images/5e84fc2dcb57a28881f871956f912df1.png)

我不确定如何使用 jsperf.com 来了解上述两种方法之间的性能差异。

请分享你的想法。

# maven - Maven，显示当前正在运行的单元测试

> ID：15203756
> 
> 赞同：11
> 
> 时间：2013-03-04T14:24:20.080
> 
> 标签：maven, testing, progress

我的公司最近切换到 maven，过渡非常顺利，但是有一个让我很恼火。所以早些时候，在前 maven 时代，你可以看到当前类正在运行哪个测试（如果你在一个类中有 40 个单元测试，并且第二个测试失败，你会看到它）。现在它看起来是这样的：它显示测试类的名称，仅此而已。您必须等到课堂上的所有测试都完成才能真正看到结果（您可以停止测试，它会显示您停止点的进度，但在实际停止它们之前您什么都看不到）。在某些集成测试中，这确实很烦人且耗时。

如果有人知道解决方案，我将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T08:22:12.227

您可以配置一个侦听器，它将在控制台上打印当前运行的测试。请参阅[junit maven-surefire-plugin 文档](http://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html)或[testng maven-surefire-plugin 文档](http://maven.apache.org/surefire/maven-surefire-plugin/examples/testng.html)`Using custom listeners and reporters`的部分

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.19.1</version>
    <configuration>
      <properties>
        <property>
          <name>listener</name>
          <value>com.mycompany.MyResultListener,com.mycompany.MyResultListener2</value>
        </property>
      </properties>
    </configuration>
  </plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T08:24:37.293

如果您使用 JUnit，则可以[为此](https://stackoverflow.com/questions/13489388/how-junit-rule-works)[使用 a`@Rule`](https://stackoverflow.com/questions/13489388/how-junit-rule-works)。

如果您只希望它在 Maven 运行测试时应用，请使用系统属性来启用/禁用输出。

# swing - 使用 Swing 进行异步 UI 更新

> ID：15203758
> 
> 赞同：6
> 
> 时间：2013-03-04T14:24:24.983
> 
> 标签：swing, scala

我编写了一个 Scala 程序，我想通过 UI（也在 Swing 中）触发它。问题是，当我触发它时，UI 会挂起，直到后台程序完成。我开始想，解决这个问题的唯一方法是让程序在另一个线程/actor中运行，并让它在需要时更新 UI。更新将包括一个显示当前正在处理的文件的状态栏和一个进度条。

由于 Scala 演员已被弃用，我很难尝试通过 Akka 来运行某种基本的多线程。Akka 网站上给出的例子也相当复杂。

但更重要的是，我发现很难思考如何尝试这个问题。我能想到的是：

1.  后台程序作为一个参与者运行
2.  UI是主程序
3.  让另一个演员告诉 UI 更新一些东西

第 3 步让我感到困惑。如何在不锁定某个变量的情况下告诉 UI？

另外，我确信这个问题已经解决了。任何相同的示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T16:43:27.183

*对于 Scala 2.10*

您可以使用`scala.concurrent.future`然后在完成时注册一个回调。回调将更新 EDT 线程上的 GUI。

我们开始做吧！

```
//in your swing gui event listener (e.g. button clicked, combo selected, ...)
import scala.concurrent.future
//needed to execute futures on a default implicit context
import scala.concurrent.ExecutionContext.Implicits._ 

val backgroundOperation: Future[Result] = future {
    //... do that thing, on another thread
    theResult
}

//this goes on without blocking
backgroundOperation onSuccess {
    case result => Swing.onEDT {
        //do your GUI update here
    }
} 
```

这是最简单的情况：

1.  我们只在完成后更新，没有任何进展
2.  我们只处理成功的案例

* * *

为了处理（1），您可以使用实例上的`map`/`flatMap`方法组合不同的期货。`Future`当这些被调用时，您可以更新 UI 中的进度（始终确保您在一个`Swing.onEDT`块中进行

```
//example progress update
val backgroundCombination = backgroundOperation map { partial: Result =>
    progress(2)
    //process the partial result and obtain
    myResult2
} //here you can map again and again

def progress(step: Int) {
    Swing.onEDT {
        //do your GUI progress update here
    }
} 
```

* * *

要处理 (2)，您可以注册回调`onFailure`或使用`onComplete`.

相关示例：[scaladocs](http://www.scala-lang.org/api/current/index.html#scala.concurrent.Future)和相关[SIP](http://docs.scala-lang.org/sips/pending/futures-promises.html)（​​虽然 SIP 示例似乎已经过时，但它们应该给你一个好主意）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T08:02:04.097

如果您想使用 Actors，以下可能对您有用。

有两个演员：

*   *进行数据处理的WorkerActor*（这里有一个带有 Thread.sleep 的简单循环）。这个actor向另一个actor发送关于工作进度的消息：
*   *GUIUpdateActor - 通过调用**handleGuiProgressEvent*方法接收有关进度和更新 UI 的更新

UI 更新方法*handleGuiProgressEvent*接收更新事件。重要的一点是，此方法由 Actor 使用 Akka 线程之一调用，并使用 Swing.onEDT 在 Swing 事件调度线程中执行 Swing 工作。

您可以将以下内容添加到各个地方以查看当前线程。

```
println("Current thread:" + Thread.currentThread()) 
```

代码是可运行的 Swing/Akka 应用程序。

```
import akka.actor.{Props, ActorRef, Actor, ActorSystem}
import swing._
import event.ButtonClicked

trait GUIProgressEventHandler {
  def handleGuiProgressEvent(event: GuiEvent)
}

abstract class GuiEvent

case class GuiProgressEvent(val percentage: Int) extends GuiEvent
object ProcessingFinished extends GuiEvent

object SwingAkkaGUI extends SimpleSwingApplication with GUIProgressEventHandler {

  lazy val processItButton = new Button {text = "Process it"}
  lazy val progressBar = new ProgressBar() {min = 0; max = 100}

  def top = new MainFrame {
    title = "Swing GUI with Akka actors"

    contents = new BoxPanel(Orientation.Horizontal) {
      contents += processItButton
      contents += progressBar
      contents += new CheckBox(text = "another GUI element")
    }

    val workerActor = createActorSystemWithWorkerActor()

    listenTo(processItButton)

    reactions += {
      case ButtonClicked(b) => {
        processItButton.enabled = false
        processItButton.text = "Processing"
        workerActor ! "Start"
      }

    }

  }

  def handleGuiProgressEvent(event: GuiEvent) {
    event match {
      case progress: GuiProgressEvent  => Swing.onEDT{
        progressBar.value = progress.percentage
      }
      case ProcessingFinished => Swing.onEDT{
        processItButton.text = "Process it"
        processItButton.enabled = true
      }
    }

  }

  def createActorSystemWithWorkerActor():ActorRef = {
    def system = ActorSystem("ActorSystem")

    val guiUpdateActor = system.actorOf(
      Props[GUIUpdateActor].withCreator(new GUIUpdateActor(this)), name = "guiUpdateActor")

    val workerActor = system.actorOf(
      Props[WorkerActor].withCreator(new WorkerActor(guiUpdateActor)), name = "workerActor")

    workerActor
  }

  class GUIUpdateActor(val gui:GUIProgressEventHandler) extends Actor {
    def receive = {
      case event: GuiEvent => gui.handleGuiProgressEvent(event)
    }
  }

  class WorkerActor(val guiUpdateActor: ActorRef) extends Actor {
    def receive = {
      case "Start" => {
        for (percentDone <- 0 to 100) {
            Thread.sleep(50)
            guiUpdateActor ! GuiProgressEvent(percentDone)
        }
      }
      guiUpdateActor ! ProcessingFinished
    }
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T15:01:09.620

如果你需要一些简单的东西，你可以在一个新线程中运行长任务，并确保在 EDT 中更新它：

```
 def swing(task: => Unit) = SwingUtilities.invokeLater(new Runnable {
     def run() { task }
  })
  def thread(task: => Unit) = new Thread(new Runnable {
     def run() {task}
  }).run()

  thread({
    val stuff = longRunningTask()
    swing(updateGui(stuff))
  }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-27T10:45:29.717

你可以定义你自己`ExecutionContext`的在 Swing Event Dispatch Thread 上执行任何事情`SwingUtilities.invokeLater`，然后使用这个上下文来调度需要由 Swing 执行的代码，仍然保留链接`Future`Scala 方式的能力，包括在它们之间传递结果。

```
 import javax.swing.SwingUtilities
  import scala.concurrent.ExecutionContext

  object OnSwing extends ExecutionContext {
    def execute(runnable: Runnable) = {
      SwingUtilities.invokeLater(runnable)
    }
    def reportFailure(cause: Throwable) = {
      cause.printStackTrace()
    }
  } 
```

```
 case ButtonClicked(_)  =>
        Future {
          doLongBackgroundProcess("Timestamp")
        }.foreach { result =>
          txtStatus.text = result
        }(OnSwing) 
```

# java - 如何获取包含单个点或句点的文件中的单词？

> ID：15203759
> 
> 赞同：1
> 
> 时间：2013-03-04T14:24:25.483
> 
> 标签：java, regex, java.util.scanner

我想从下面名为“查询”的文件中查找表名和列名。

```
var query = "  SELECT accounts.name, SUM((COALESCE((jan_val_c),0)+  ";
query += "  COALESCE((feb_val_c),0)+ COALESCE((march_val_c),0)+ COALESCE((apr_val_c),0)+ ";
query += "  COALESCE((may_val_c),0)+ COALESCE((june_val_c),0)+ COALESCE((july_val_c),0)+   ";
query += "  COALESCE((aug_val_c),0)+ COALESCE((sept_val_c),0)+ COALESCE((oct_val_c),0)+   ";
query += "  COALESCE((nov_val_c),0)+ COALESCE((dec_val_c),0))) AS sales_plan,SUM((COALESCE((jan_actual_val_c),0)+   ";
query += "  COALESCE( (feb_actual_val_c),0)+ COALESCE( (march_actual_val_c),0)+ COALESCE( (apr_actual_val_c),0)+   ";
query += "  COALESCE( (may_actual_val_c),0)+ COALESCE( (june_actual_val_c),0)+ COALESCE( (july_actual_val_c),0)+   ";
query += "  COALESCE( (aug_actual_val_c),0)+ COALESCE( (sept_actual_val_c),0)+ COALESCE( (oct_actual_val_c),0)+   ";
query += "  COALESCE( (nov_actual_val_c),0)+ COALESCE( (dec_actual_val_c),0))) AS Actual_plan ,month_name_c,  ";
query += "   cl_sales_planning_month.year_c, cl_products.volume,cl_brands.name AS brand ,cl_therapies.name   ";
query += "   AS therapy,cl_products.name AS product, accounts.created_by,accounts.assigned_user_id ,   ";
query += "   DATE_FORMAT(STR_TO_DATE(CONCAT_WS('-',cl_sales_planning_month.month_name_c,  ";
query += "   cl_sales_planning_month.year_c),'%M-%Y'),'%b-%y' ) AS monthyear FROM cl_sales_planning_month   ";
query += "   LEFT JOIN accounts ON cl_sales_planning_month.account_id_c =accounts.id LEFT JOIN cl_products   ";
query += "   ON cl_sales_planning_month.cl_products_id_c = cl_products.id LEFT JOIN cl_brands ON   ";
query += "   cl_products.cl_brands_id_c=cl_brands.id LEFT JOIN cl_therapies ON   ";
query += "   cl_products.cl_therapies_id_c=cl_therapies.id WHERE   ";
 query += "            cl_sales_planning_month.month_name_c = MONTHNAME(CURRENT_DATE - INTERVAL 2 MONTH) AND  ";
      query += "            cl_sales_planning_month.year_c = YEAR(CURRENT_DATE - INTERVAL 2 MONTH)  AND";

query += "   cl_sales_planning_month.user_id_c IN ("+ params["childs"].value +") ";
query += "   GROUP BY therapy,monthyear   ";
query += "   ORDER BY STR_TO_DATE(cl_sales_planning_month.year_c,'%Y') ASC,   ";
query += "  STR_TO_DATE(cl_sales_planning_month.month_name_c,'%M') ASC, Actual_plan DESC   "; 
```

为此，我编写了一个 Java 程序：

```
package com.waprau;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;
import java.util.regex.Pattern;

public class SeparateTableNamesColumnNames {
    public static void main(String[] args) {
        File file = new File("/home/waprau/Desktop/query");
        //Pattern = new Pattern("([^\\s]+(\\.(?i))$)");

        try {
            Scanner scanner = new Scanner(file);
            scanner.useDelimiter("\\s|=|,|\\)|\\(|this.|\\].");

            while(scanner.hasNext()){
                if(scanner.next().matches("(?<!\\.)\\b[a-zA-Z]\\w*\\.[a-zA-Z]\\w*\\b(?!\\.)"))
                 System.out.println(scanner.next());;
               }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

使用上述程序，我可以分隔所有单词。但我只想得到那些包含单个点或句点的单词，例如accounts.name、cl_sales_planning_month.year_c、cl_products.volume、cl_brands.name、cl_therapies.name 等。但是我找不到模式或任何可以将这些单词与文件分开。

但它不起作用。

这是我得到的结果：

![在此处输入图像描述](../Images/1e36f1746d4f23867257b1f465f9e403.png)

这就是我想要的：

![在此处输入图像描述](../Images/b4133ca927139106eee3b91f7f9d1930.png)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:28:54.200

要匹配包含点的单词，您可以使用：`"\\w+\\.\\w+"`？

`\w`匹配字母、数字和下划线。

但是，这也将匹配具有多个句点的内容。您可以通过使用环视来改进它，以确保在您匹配的单词之前或之后没有另一个句点：

```
"(?<!\\.)\\b\\w+\\.\\w+\\b(?!\\.)" 
```

这匹配包含点的单词，并且不能在紧接之前或之后包含点。`\b`是单词边界。

但是，这将匹配十进制数，如`123.45`. 表格可以包含数字，但不能以 1 开头。所以我们还可以确保每个单词都以字母开头：

```
"(?<!\\.)\\b[a-zA-Z]\\w*\\.[a-zA-Z]\\w*\\b(?!\\.)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:42:47.513

该句`.`点必须转义，因为它意味着“任何字符”。由于这不是正常的字符串转义（如`\n`），它使用两个反斜杠：`\\.`

也`\\s`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T16:07:44.523

无论正则表达式如何（dan1111 的答案似乎涵盖了这一点）。您的 Java 代码存在缺陷，scanner.next() 获取下一个字符串，并且由于您调用它两次，因此您不会打印匹配的内容。相反，您将在每次匹配后打印该项目。

如果您按如下方式更改循环，它似乎会打印您想要的内容：

```
String tmp;
while (scanner.hasNext()) {
    // Store next item so we can match AND print it.
    tmp = scanner.next();
    if (tmp.matches("(?<!\\.)\\b[a-zA-Z]\\w*\\.[a-zA-Z]\\w*\\b(?!\\.)"))
        System.out.println(tmp);
} 
```

# javascript - 使用 Javascript 在 HTML 页面中保存图像

> ID：15203761
> 
> 赞同：1
> 
> 时间：2013-03-04T14:24:36.437
> 
> 标签：javascript, html

我正在尝试使用以下代码在 HTML 中单击按钮时使用 Javascript 保存图像：

```
function saveImage(anImage) {

if (typeof anImage== 'object') 
  Image= anImage.src;  
window.win = open(anImage);           
setTimeout('win.document.execCommand("SaveAs")', 500);
} 
```

当我从本地 PC 运行代码时它工作正常（即它会弹出一个新窗口并提示我将图像保存为 png 文件），但是当我将它部署到服务器时它会弹出新窗口但它会尝试保存页面而不是图像（它会打开一个对话框，要求保存 htm 文件）

任何原因 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:10:09.537

John Culviner 编写了一个 jquery 插件来处理这个问题。

[https://github.com/johnculviner/jquery.file 下载](https://github.com/johnculviner/jquery.fileDownload)

# java - Java 数组计数器

> ID：15203764
> 
> 赞同：2
> 
> 时间：2013-03-04T14:24:43.613
> 
> 标签：java, arrays, random, counter

我正在练习使用新的波士顿教程，但是有一个程序我并不完全理解。该程序旨在计算每个掷骰子中出现的数字的频率，并将结果存储在数组中。我遇到的问题是**++freq[1+newDice.nextInt(6)]**。我了解**[1+newDice.nextInt(6)]**；但是，数组如何知道每次出现数字时将每个索引加一？

```
Random newDice = new Random ();

        int freq[] = new int [7];

        for(int i = 1; i<= 1000; i++)
        {
            ++freq[1+newDice.nextInt(6)];
        }

        System.out.println("Dice Number\tFrequency");
        for(int i = 1; i< freq.length; i++)
        {
            System.out.println(i+"\t\t"+freq[i]);

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:26:35.037

它正在递增存储在数组中该位置的值。它不会增加数组索引。

它相当于：

```
int index = 1+newDice.nextInt(6);
int f = freq[index];
++f;
freq[index] = f; 
```

# perl - 文件排对抗

> ID：15203765
> 
> 赞同：0
> 
> 时间：2013-03-04T14:24:47.030
> 
> 标签：perl

我有以下问题：来自`file.dat`具有以下格式化数据的文件 ( )

```
1 2 3 4
2 1 3 4 5
3 1 2
4 1 2
5 2 6 7
6 5 8
7 5 8
8 6 7 9
9 8 
```

我想找到：

1.  如果一行的第一个元素出现在其他行中，并且后续行的第一个元素出现在考试中的行中；
2.  如果它存在，那么我想打印“*我找到了链接 xy* ”；
3.  如果“*链接*”存在，那么我想计算考试行中的其他元素出现在链接所在行中的次数并打印“*我找到了 z 个三角形*”。

例如在这种情况下，当程序比较第一行和第二行并发现“*链接 1 2* ”存在然后还写“*我找到 2 个三角形*”（因为在每一行中都有数字 3 和 4） .

为此，我尝试编写以下程序：

```
use strict;
use warnings;
use diagnostics;
use Data::Dumper;

############ DATA ABSORTION

my $file = 'file.dat';
open my $fh, "<", $file or die "Cannot open $file: $!";

############ COLLECT THE DATAS IN A VECTOR as vector[i][j]

my @vector;

while (<$fh>) {

push @vector, [ split ];

}

############ START THE RESEARCH OF THE LINKS AND TRIANGLES BY MEANS OF FOR LOOPS

my @link;
my $triangles;

for (my $i=0 ; $i < scalar @vector; $i++){

$triangles=0;

for(my $j=0; $j < scalar @vector; $j++){

    for (my $k=$i+1; $k < scalar @vector; $k++){        

        for(my $l=0; $l < scalar @vector; $l++){

            if($vector[$i][0]==$vector[$k][$l] && $vector[$i][$j]==$vector[$k][0] && $l != 0 && $j != 0) {

                 @link=($vector[$i][0],$vector[$k][0]);

            print "I found the link @link\n";

                if($vector[$i][$j]==$vector[$k][$l] && $l != 0 && $j != 0 && $i != $k){

                $triangles++;

                }
            print "The number of triangles is $triangles\n\n";              
            }

        }
    }
  }
} 
```

该程序打印正确数量的链接，但我发现如果行数低于文件中的列数，则程序不会读取整行，这可能是我的链接研究的问题。我认为问题出`scalar @vector`在 for 指令的上限（但我不明白为什么）。

第二个问题是它不计算我正在寻找的正确数量的*三角形......有什么帮助吗？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:41:23.977

[只回答第一个问题]

`$j`并`$l`假设迭代列索引，但你计算行数。正确的循环是：

```
for my $i (0 .. $#vector-1) {
for my $j (0 .. $#{ $vector[$i] }) {
for my $k ($i+1 .. $#vector) {
for my $l (0 .. $#{ $vector[$k] }) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T15:34:24.280

该程序可以满足您的要求。此外，当找到一个三角形时，它会打印每个三角形的三个角。

```
use strict;
use warnings;
use 5.010;

my $filename = 'file.dat';
open my $fh, '<', $filename or die qq{Cannot open "$filename": $!};

my %vector;
while (<$fh>) {
  my @fields = split;
  my $root = shift @fields;
  $vector{$root} = { map { $_ => 1} @fields };
}
my @roots = sort { $a <=> $b } keys %vector;

for my $i (0 .. $#roots) {
  my $aa = $roots[$i];
  for my $j ($i + 1 .. $#roots) {
    my $bb = $roots[$j];
    next unless $vector{$aa}{$bb} and $vector{$bb}{$aa};

    say "I found the link $aa $bb";

    my $triangles = 0;
    for my $cc ( keys %{$vector{$aa}} ) {
      next if $cc == $aa or $cc == $bb;
      if ($vector{$bb}{$cc}) {
        say "Triangle $aa - $bb - $cc";
        $triangles++;
      }
    }
    say "I have found $triangles triangle". ($triangles == 1 ? '' : 's');
    print "\n";

  }
} 
```

您显示的数据中只有两个三角形：1-2-3 和 1-2-4。遵循您的算法会导致该程序不止一次地计算三角形，角的顺序不同。要仅计算每个不同的三角形一次，请更改行

```
next if $cc == $aa or $cc == $bb; 
```

至

```
next if $cc <= $aa or $cc <= $bb; 
```

**输出**

```
I found the link 1 2
Triangle 1 - 2 - 4
Triangle 1 - 2 - 3
I have found 2 triangles

I found the link 1 3
Triangle 1 - 3 - 2
I have found 1 triangle

I found the link 1 4
Triangle 1 - 4 - 2
I have found 1 triangle

I found the link 2 3
Triangle 2 - 3 - 1
I have found 1 triangle

I found the link 2 4
Triangle 2 - 4 - 1
I have found 1 triangle

I found the link 2 5
I have found 0 triangles

I found the link 5 6
I have found 0 triangles

I found the link 5 7
I have found 0 triangles

I found the link 6 8
I have found 0 triangles

I found the link 7 8
I have found 0 triangles

I found the link 8 9
I have found 0 triangles 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T15:18:16.880

这个问题有两个部分：

*   确定两行之间是否存在链接
*   确定他们共有的“独特”总数

* * *

使用 AoA 很好，但使用 HoH 会让生活更轻松：

```
my %links;

while ( <$fh> ) {

    chomp;
    my ( $from, @to ) = split;

    $links{$from}{$_}++ for @to;
} 
```

然后，您可以检查链接是否存在：

```
print "Link $from $to\n" if exists $links{$from} && exists $links{$from}{$to}; 
```

找到共同的“三角形”也应该很容易：

```
use List::MoreUtils 'uniq';

sub get_triangles {

    my ( $from, $to ) = @_;

    for ( $from, $to ) {  # Bail out if link doesn't exist
        warn( "'$_' does not exist"), return unless exists $links{$_};
    }

    my @triangles = map {  exists $links{$from}  &&  exists $links{$to} }
                    uniq( values %{$links{$from}}, values %{$links{to}} );

    return @triangles;
} 
```

# android - 子片段无缘无故被破坏

> ID：15203766
> 
> 赞同：5
> 
> 时间：2013-03-04T14:24:49.440
> 
> 标签：android, android-fragments, android-fragmentactivity, android-nested-fragment

**信息：**我在 a 中有一个 2 窗格布局（2 个 child `Fragments`）`ParentFragment`，当然，它在 a`FragmentActivity`中。我`setRetainInstance(true)`在`ParentFragment`. 在方向改变时，**左**子片段**不会被**破坏（`onCreate()`不会被调用），这是正常的（因为父片段保留了它的实例）。

**问题：**在方向改变时，**正确**的片段**被**破坏（`onCreate()`被调用）。为什么右边的碎片被破坏了而左边的碎片没有？

**编辑：**如果我删除`setRetainInstance(true)`，则**左侧**片段`onCreate()`被调用**两次**（lol wtf），**右侧**片段`onCreate()`被调用一次。所以这也不好...

**ParentFragment的代码如下：**

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    this.setRetainInstance(true);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState)
{
    View view = inflater.inflate(R.layout.fragment_schedule, container, false);
    setHasOptionsMenu(true);

    if (getChildFragmentManager().findFragmentById(R.id.fragment_schedule_framelayout_left) == null || 
            !getChildFragmentManager().findFragmentById(R.id.fragment_schedule_framelayout_left).isInLayout())
    {
        if (mPresentationsListFragment == null)
            mPresentationsListFragment = PresentationsListFragment.newInstance(PresentationsListFragment.TYPE_SCHEDULE, mScheduleDate);
        getChildFragmentManager().beginTransaction()
                                     .replace(R.id.fragment_schedule_framelayout_left, mPresentationsListFragment)
                                     .commit();
    }
    mPresentationsListFragment.setOnPresentationClickListener(this);

    return view;
}

@Override
    public void onPresentationClick(int id)
    {
        if (Application.isDeviceTablet(getActivity()))
        {
            if (getChildFragmentManager().findFragmentById(R.id.fragment_schedule_framelayout_right) == null)
            {
                if (mPresentationDetailFragment == null)
                    mPresentationDetailFragment = PresentationDetailFragment.newInstance(id);
                else
                    mPresentationDetailFragment.loadPresentation(id);
                getChildFragmentManager().beginTransaction()
                                           .replace(R.id.fragment_schedule_framelayout_right, mPresentationDetailFragment)
                                           .commit();
            }
            else
                mPresentationDetailFragment.loadPresentation(id);
        }
        else
        {
            Intent presentationDetailIntent = new Intent(getActivity(), PresentationDetailActivity.class);
            presentationDetailIntent.putExtra(PresentationDetailActivity.KEY_PRESENTATION_ID, id);
            startActivity(presentationDetailIntent);
        }
    } 
```

**LE解决方案：** 非常感谢***antonyt***，答案如下。pe 执行的唯一更改位于 parent 的 onCreateView() 中`Fragment`。

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState)
{
    View view = inflater.inflate(R.layout.fragment_schedule, container, false);
    setHasOptionsMenu(true);

    if (getChildFragmentManager().findFragmentById(R.id.fragment_presentations_framelayout_left) == null)
    {
        mPresentationsListFragment = PresentationsListFragment.newInstance();
        mPresentationsListFragment.setOnPresentationClickListener(this);
        getChildFragmentManager().beginTransaction()
                .add(R.id.fragment_presentations_framelayout_left, mPresentationsListFragment)
                .commit();
    }

    return view;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-25T15:05:42.773

据我了解，如果您`setRetainInstance(true)`在父片段上使用上述代码，则在更改方向时应该重新创建**左侧**片段，但不应该重新创建**右侧片段。**这与您上面写的内容相反，但我会解释为什么会这样。如果您有`setRetainInstance(false)`父片段，您确实应该看到左侧片段被创建了两次，而右侧片段被创建了一次。

**情况1：`setRetainInstance(true)`**

您的父片段不会在旋转时被销毁。但是，它每次仍会重新创建其视图（`onDestroyView`并将`onCreateView`按此顺序调用）。在`onCreateView`你有代码在某些条件下添加你的左片段。`getChildFragmentManager().findFragmentById(R.id.fragment_schedule_framelayout_left)`应该是非空的，因为之前已经向该容器添加了一个片段。`getChildFragmentManager().findFragmentById(R.id.fragment_schedule_framelayout_left).isInLayout()` 应该是 false 因为[只有通过 XML 添加的片段才会导致它返回 true](http://developer.android.com/reference/android/app/Fragment.html#isInLayout%28%29)。整体条件为真，因此将创建左侧片段的新实例，并将替换旧实例。您的右片段仅在单击事件期间实例化，因此不会发生特殊行为。

摘要：父片段仍然存在，新的左侧片段被创建，右侧片段仍然存在。

**案例二：`setRetainInstance(false)`**

您的父片段被销毁，左右片段也被销毁。所有三个片段都由 Android 自动重新创建。然后，您的父片段将有机会创建其视图，并且它将根据上面的说明创建左侧片段的新实例。刚刚创建的左片段将被这个新实例替换。您会观察到一个左片段将被销毁，另一个左片段将被创建。正确的片段不会发生特殊行为。

总结：创建了新的父fragment，创建了两个新的左fragment，创建了新的右fragment。

如果您确定在这种`setRetainInstance(true)`情况下，您的右侧片段被破坏而不是您的左侧片段，请将示例项目发布到 github/etc。这证明了这一点。

**`FragmentTransaction.replace()`更新：如果您在左侧片段上使用，为什么右侧片段会被删除**

由于内部条件，您的代码将尝试在同一个容器上将您的左侧片段替换为自身。

以下是处理替换的 Android 4.1 源代码中的代码片段：

```
...
case OP_REPLACE: {
    Fragment f = op.fragment;
    if (mManager.mAdded != null) {
        for (int i=0; i<mManager.mAdded.size(); i++) {
            Fragment old = mManager.mAdded.get(i);
            if (FragmentManagerImpl.DEBUG) Log.v(TAG,
                    "OP_REPLACE: adding=" + f + " old=" + old);
            if (f == null || old.mContainerId == f.mContainerId) {
                if (old == f) {
                    op.fragment = f = null;
                } else {
                    if (op.removed == null) {
                        op.removed = new ArrayList<Fragment>();
                    }
                    op.removed.add(old);
                    old.mNextAnim = op.exitAnim;
                    if (mAddToBackStack) {
                        old.mBackStackNesting += 1;
                        if (FragmentManagerImpl.DEBUG) Log.v(TAG, "Bump nesting of "
                                + old + " to " + old.mBackStackNesting);
                    }
                    mManager.removeFragment(old, mTransition, mTransitionStyle);
                }
            }
        }
    }
    if (f != null) {
        f.mNextAnim = op.enterAnim;
        mManager.addFragment(f, false);
    }
} break;
... 
```

如果您尝试用自己替换相同的片段，有一些代码可以尝试忽略此操作：

```
if (old == f) {
    op.fragment = f = null;
} 
```

由于`f`为空，并且我们仍在继续迭代我们的片段，这似乎具有从 FragmentManager 中删除每个后续片段的副作用。我不认为这是故意的，但至少可以解释为什么你的正确片段被破坏了。不使用替换/不替换同一个片段本身可以解决您的问题。

有趣的是，这是最近的变化，在以前的 Android 版本中不存在。 [https://github.com/android/platform_frameworks_support/commit/5506618c80a292ac275d8b0c1046b446c7f58836](https://github.com/android/platform_frameworks_support/commit/5506618c80a292ac275d8b0c1046b446c7f58836)

错误报告：[https ://code.google.com/p/android/issues/detail?id=43265](https://code.google.com/p/android/issues/detail?id=43265)

# php - 下载脚本非常慢

> ID：15203768
> 
> 赞同：0
> 
> 时间：2013-03-04T14:24:56.790
> 
> 标签：php, javascript, download

我用 javascript 和 php 编写了一个下载脚本。它可以工作，但如果我想下载一个大文件（例如 1GB zip 文件），它的请求时间太长了。我认为这与我阅读文件有关。如果是这样，知道如何更快地获得它吗？
**注意**：我需要一个标题，强制下载图像、pdf、任何类型的文件类型的原因。

JS很简单。看这个：

```
function downloadFile(file){
    document.location.href = "script.php?a=downloadFile&b=."+ file;
} 
```

PHP 很简单：

```
function downloadFile($sFile){
    #Main function
    header('Content-Type: '.mime_content_type($sFile)); 
    header('Content-Description: File Transfer');
    header('Content-Length: ' . filesize($sFile)); 
    header('Content-Disposition: attachment; filename="' . basename($sFile) . '"');
    readfile($sFile);
}

switch($_GET['a']){

    case 'downloadFile':
        echo downloadFile($_GET['b']);
        break;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:35:46.097

我猜缓冲是大文件的问题。尝试以小块（如兆字节）读取文件，并在打印每个块后调用[刷新函数刷新输出缓冲区。](http://php.net/manual/en/function.flush.php)

编辑：嗯，好的，这是您应该尝试的代码示例：

```
function downloadFile($sFile){
    #Main function

    if ( $handle = fopen( $sFile, "rb" ) ) {
        header('Content-Type: '.mime_content_type($sFile)); 
        header('Content-Description: File Transfer');
        header('Content-Length: ' . filesize($sFile)); 
        header('Content-Disposition: attachment; filename="' . basename($sFile) . '"');

        while ( !feof($handle) ) {
            print fread($handle, 1048576);
            flush();
        }
        fclose($handle);
    } else {
        header('Status: 404');
        header('Content-Type: text/plain');
        print "Can't find the requested file";
    }
} 
```

# python - Python：读取文件并用特定条件逐行替换

> ID：15203771
> 
> 赞同：1
> 
> 时间：2013-03-04T14:25:07.560
> 
> 标签：python, python-2.7

我有一个像下面这样的文件。

```
0       0       0 
0.00254 0.00047 0.00089
0.54230 0.87300 0.74500 
0       0       0 
```

我想修改这个文件。如果值小于 0.05，则值为 1。否则，值为 0。

python脚本运行后，文件应该是这样的

```
1       1        1
1       1        1
0       0        0
1       1        1 
```

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:47:37.670

好的，既然您是 StackOverflow 的新手（欢迎！），我将引导您完成此操作。我假设您的文件名为`test.txt`.

```
with open("test.txt") as infile, open("new.txt", "w") as outfile: 
```

打开我们需要的文件，我们的输入文件和一个新的输出文件。该`with`语句确保在退出块后关闭文件。

```
 for line in infile: 
```

逐行循环文件。

```
 values = [float(value) for value in line.split()] 
```

现在这更复杂了。每行包含空格分隔的值。可以使用 将它们拆分为字符串列表`line.split()`。但它们仍然是字符串，所以必须先转换为`float`s。所有这些都是通过列表理解完成的。结果是，例如，在以这种方式处理第二行之后，`values`现在是以下列表：`[0.00254, 0.00047, 0.00089]`.

```
 results = ["1" if value < 0.05 else "0" for value in values] 
```

现在我们正在创建一个名为 的新列表`results`。每个元素都对应于 的一个元素`values`，如果它是一个，如果不是，`"1"`它就是一个。`value < 0.05``"0"`

```
 outfile.write("      ".join(results)) 
```

将“整数字符串”列表转换回字符串，每个字符串由 7 个空格分隔。

```
 outfile.write("\n") 
```

添加一个换行符。完毕。

* * *

如果您不介意额外的复杂性，这两个列表推导可以合并为一个：

```
 results = ["1" if float(value) < 0.05 else "0" for value in line.split()] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:49:53.413

如果您可以使用库，我建议您使用 numpy ：

```
import numpy as np
myarray = np.genfromtxt("my_path_to_text_file.txt")
my_shape = myarray.shape()
out_array = np.where(my_array < 0.05, 1, 0)
np.savetxt(out_array) 
```

您可以将格式添加为 savetxt 函数的参数。该函数的文档字符串非常易于解释。

如果你被纯 python 困住了：

```
with open("my_path_to_text_file") as my_file:
    list_of_lines = my_file.readlines()
    list_of_lines = [[int( float(x) < 0.05) for x in line.split()] for line in list_of_lines] 
```

然后将该列表写入您认为合适的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:57:08.670

您可以使用此代码

```
f_in=open("file_in.txt", "r")       #opens a file in the reading mode
in_lines=f_in.readlines()           #reads it line by line
out=[]
for line in in_lines:
    list_values=line.split()        #separate elements by the spaces, returning a list with the numbers as strings
    for i in range(len(list_values)):
        list_values[i]=eval(list_values[i])     #converts them to floats
#       print list_values[i],
        if list_values[i]<0.05:     #your condition
#           print ">>", 1
            list_values[i]=1
        else:
#           print ">>", 0
            list_values[i]=0
    out.append(list_values)         #stores the numbers in a list, where each list corresponds to a lines' content
f_in.close()                        #closes the file

f_out=open("file_out.txt", "w")     #opens a new file in the writing mode
for cur_list in out:
    for i in cur_list:
        f_out.write(str(i)+"\t")    #writes each number, plus a tab
    f_out.write("\n")               #writes a newline
f_out.close()                       #closes the file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:37:46.837

以下代码就地执行替换：为此，文件以`'rb+'`模式打开。绝对必须以二进制模式打开它`b`。`+`in`'rb+'`表示可以在文件中写入和读取。注意模式也可以写`'r+b'`。

但是使用`'rb+'`很尴尬：

*   如果您使用 读取`for line in f`，则文件将按块读取，并且将几行保留在缓冲区中，它们实际上是一个接一个地读取，直到另一块数据被读取并加载到缓冲区中。这使得执行转换变得更加困难，因为必须在 的帮助下跟随文件指针的位置`tell()`并移动指针，`seek()`事实上我还没有完全理解它必须如何完成。
    .
    令人高兴的是，有一个解决方案`replace()`，因为，我不知道为什么，但我相信事实，当`readline()`读取一行时，文件的指针在磁盘上不会比行尾更远（也就是说它停在换行符处）。
    现在很容易移动和知道文件指针的位置

*   读后写，必须要`seek()`执行，即使应该执行，也就是`seek(0,1)`从实际位置移动0个字符。那必须改变文件指针的状态，类似的。

好吧，对于你的问题，代码如下：

```
import re
from os import fsync
from os.path import getsize

reg = re.compile('[\d.]+')

def ripl(m):
    g = m.group()
    return ('1' if float(g)<0.5 else '0').ljust(len(g))

path = ...........'

print 'length of file before : %d' % getsize(path)

with open('Copie de tixti.txt','rb+') as f:
    line = 'go'
    while line:
        line = f.readline()
        lg = len(line)
        f.seek(-lg,1)
        f.write(reg.sub(ripl,line))
        f.flush()
        fsync(f.fileno())

print 'length of file after : %d' % getsize(path) 
```

`flush()`并且`fsync()`必须被执行以确保指令在被命令`f.write(reg.sub(ripl,line))`的那一刻有效地写入。

请注意，我从未管理过以 unicode 编码的文件。这当然更加困难，因为每个 unicode 字符都编码在几个字节上（在 UTF8 的情况下，字节数取决于字符）

# java - 生成对象并放入没有重复的arraylist

> ID：15203779
> 
> 赞同：2
> 
> 时间：2013-03-04T14:25:24.923
> 
> 标签：java

嗨，我正在弄清楚为什么这段代码不能按照我想要的方式工作..

我基本上想要的是一个随机对象，它有一个 char 和一个 int 生成并将其放入 arraylist 中。但是，如果生成的与 arraylist 中的匹配相同，则它必须再次重新生成该数字并检查它是否存在。如果它不存在，它将被添加到数组列表中。

```
 private final char letter;
    private final int num;
    private static Collection<RegistrationNumber> REGISTRATION_NUMBER = new ArrayList<RegistrationNumber>();

    private RegistrationNumber(){
        Random rand = new Random();
        this.num = (1+(rand.nextInt(3)));
        this.letter = Character.toUpperCase((char)(rand.nextInt(1)+'a'));
    }

    public static RegistrationNumber getInstance(){
        boolean foo = false;
        RegistrationNumber rn = null;
        while(!foo){
            rn = new RegistrationNumber();
            if(!REGISTRATION_NUMBER.contains(rn)){
                REGISTRATION_NUMBER.add(rn);
                foo=true;
            }           
        }return rn;
    } 
```

一旦我查看了数组列表，仍然有一些重复，例如 [A1,A1,A2] 或 [A2,A2,A3]

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:28:12.767

为了使该`contains(rn)`方法起作用，`RegistrationNumber`必须重写`equals`. 否则，两个具有相同信息的不同对象将不会被认为是相同的。

当您覆盖时`equals`，您还需要覆盖`hashCode`，因为`java.Object`的合同要求您同时覆盖两者。

最后，您可以考虑使用该[`LinkedHashSet`](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashSet.html)集合进行注册：它为您提供可预测的迭代顺序，同时自动防止重复。当然，您仍然需要覆盖`equals`and `hashCode`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:29:00.893

`RegistrationNumber`类必须实现`equals()`and `hashCode()`。

我建议首先覆盖这些方法，然后使用 HashSet，它会给你一个不允许重复的 Set。

```
@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + num;
    return result;
}

@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (obj == null)
        return false;
    if (getClass() != obj.getClass())
        return false;
    RegistrationNumber other = (RegistrationNumber) obj;
    if (num != other.num)
        return false;
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:29:22.060

ArrayLists 的`contains`方法需要使用`equals`方法重载，告诉集合它将如何将此对象与现有对象进行比较（因此能够找到重复项）

```
@Override
public boolean equals(Object obj) {
  if (this == obj)
    return true;

  if (obj == null)
    return false;

  if (getClass() != obj.getClass())
    return false;

  final RegistrationNumber other = (RegistrationNumber ) obj;

  if (num != other.num && letter != other.letter) 
    return false;

  return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T14:30:10.027

默认情况下， contains 方法使用类的 equals 方法。如果 equals 没有被覆盖，它就像你使用了 "==" 运算符一样。这将测试它是否是同一个对象；不是具有相同内容的对象。

您需要做的是覆盖 RegistrationNumber 类中的 equals() 方法，因此它测试成员相等性，而不是引用相等性。

# hadoop - 将 map reduce 作业的输出记录到文本文件中

> ID：15203785
> 
> 赞同：2
> 
> 时间：2013-03-04T14:25:35.857
> 
> 标签：hadoop, mapreduce

我一直在使用这个 jobclient.monitorandprintjob() 方法将 map reduce 作业的输出打印到控制台。我的用法是这样的：

```
job_client.monitorAndPrintJob(job_conf, job_client.getJob(j.getAssignedJobID())) 
```

其输出如下（打印在控制台上）：

```
13/03/04 07:20:00 INFO mapred.JobClient: Running job: job_201302211725_10139<br>
13/03/04 07:20:01 INFO mapred.JobClient:  map 0% reduce 0%<br>
13/03/04 07:20:08 INFO mapred.JobClient:  map 100% reduce 0%<br>
13/03/04 07:20:13 INFO mapred.JobClient:  map 100% reduce 100%<br>
13/03/04 07:20:13 INFO mapred.JobClient: Job complete: job_201302211725_10139<br>
13/03/04 07:20:13 INFO mapred.JobClient: Counters: 26<br>
13/03/04 07:20:13 INFO mapred.JobClient:   Job Counters<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Launched reduce tasks=1<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Aggregate execution time of mappers(ms)=5539<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Launched map tasks=2<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Data-local map tasks=2<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Aggregate execution time of reducers(ms)=4337<br>
13/03/04 07:20:13 INFO mapred.JobClient:   FileSystemCounters<br>
13/03/04 07:20:13 INFO mapred.JobClient:     MAPRFS_BYTES_READ=583<br>
13/03/04 07:20:13 INFO mapred.JobClient:     MAPRFS_BYTES_WRITTEN=394<br>
13/03/04 07:20:13 INFO mapred.JobClient:     FILE_BYTES_WRITTEN=140219<br>
13/03/04 07:20:13 INFO mapred.JobClient:   Map-Reduce Framework<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Map input records=6<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Reduce shuffle bytes=136<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Spilled Records=22<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Map output bytes=116<br>
13/03/04 07:20:13 INFO mapred.JobClient:     CPU_MILLISECONDS=1320<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Map input bytes=64<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Combine input records=13<br>
13/03/04 07:20:13 INFO mapred.JobClient:     SPLIT_RAW_BYTES=180<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Reduce input records=11<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Reduce input groups=11<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Combine output records=11<br>
13/03/04 07:20:13 INFO mapred.JobClient:     PHYSICAL_MEMORY_BYTES=734961664<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Reduce output records=11<br>
13/03/04 07:20:13 INFO mapred.JobClient:     VIRTUAL_MEMORY_BYTES=9751805952<br>
13/03/04 07:20:13 INFO mapred.JobClient:     Map output records=13<br>
13/03/04 07:20:13 INFO mapred.JobClient:     GC time elapsed (ms)=0<br> 
```

我希望将上述输出/日志打印在文本文件中，而不是控制台中。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:20:45.630

在您的 HADOOP_HOME/conf 中，您可能会找到一个名为 :的文件`log4j.properties`。我相信您可以在那里配置登录的位置和方式。

准确地说，您将使用*滚动文件 appender*，因此您应从文件中取消注释（只需删除`#`）以下行`log4j.properties`：

```
# Rolling File Appender
#

#log4j.appender.RFA=org.apache.log4j.RollingFileAppender
#log4j.appender.RFA.File=${hadoop.log.dir}/${hadoop.log.file}

# Logfile size and and 30-day backups
#log4j.appender.RFA.MaxFileSize=1MB
#log4j.appender.RFA.MaxBackupIndex=30

#log4j.appender.RFA.layout=org.apache.log4j.PatternLayout
#log4j.appender.RFA.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} - %m%n
#log4j.appender.RFA.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n 
```

并根据自己的喜好自定义其他参数。

有关 log4j 配置的更多信息，请阅读[此处](http://logging.apache.org/log4j/2.0/manual/configuration.html#AutomaticConfiguration)。

# ruby-on-rails-3 - 可以在 postgre 数据库上的 heroku 上运行迁移

> ID：15203787
> 
> 赞同：0
> 
> 时间：2013-03-04T14:25:36.093
> 
> 标签：ruby-on-rails-3, postgresql, heroku, rails-migrations

我需要通过迁移将属性/列添加到 Heroku.com（Rails 应用程序）上的生产数据库（Postgre）中的表中。当我进行迁移时，它看起来不错，但是当我查看表上的列时，它没有添加列！

我的开发数据库是 sqlite3，生产数据库是 postgre

我执行以下操作：

```
heroku run rails generate migration AddUtc_OffsetToEvents utc_offset:integer RAILS_ENV=production --app app-name-1111 
```

它返回：

```
invoke  active_record
      create    db/migrate/20130304070946_add_utc_offset_to_events.rb 
```

然后我运行迁移

```
heroku run rake db:migrate RAILS_ENV=production --app app-name-1111 
```

接着：

```
heroku restart 
```

当我跑

```
heroku pg:psql HEROKU_POSTGRESQL_GRAY_URL --app app-name-1111 
```

并检查表格的列：

```
\d+ events 
```

它仍然没有 utc_offset 列，并且在执行之前的 cmds 时不会显示任何错误。

有什么想法或提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T00:15:36.847

看起来你正在打几个电话`heroku run`

每次您这样做时`heroku run`，它都会使用您的最新代码启动一个全新的测功机，并且当运行结束时，该测功机将被销毁。所以第二次 heroku 运行没有在第一次创建迁移文件。

由于您已经熟悉 psql，您可以直接使用`ALTER TABLE`。否则，您需要检查您的代码迁移到`git push heroku master`heroku，*然后*运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:35:23.130

为什么不直接下载代码、添加迁移并推送更改？之后，只需在应用程序上运行 heroku run rake db:migrate。

# c# - 从密码短语创建非对称密钥

> ID：15203788
> 
> 赞同：2
> 
> 时间：2013-03-04T14:25:50.390
> 
> 标签：c#, encryption-asymmetric

我想允许我网站上的用户创建一个非对称的私钥和公钥，以便他们可以：

*   将公钥上传到站点，以便我的 Web 应用程序可以加密他们上传的文件
*   下载文件并使用本地应用程序和私钥解密它们

我的问题是，如果用户机器死了，那么他们很可能会丢失他们的私钥。

我的概念是，用户下载以从站点提取文件的应用程序也将允许他们生成在站点上使用的密钥。

所以我的问题是，是否可以基于密码创建非对称私钥/公钥对？如果需要，这将允许用户重新生成私钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-10T16:28:50.447

完全按照您的要求进行操作的一种方法是：

1.  定义一个安全级别N，越大越安全，但这个过程会更慢。
2.  生成一个“salt”并将其与用户的 id 相关联。
3.  由于 RSA 密钥生成需要安全的随机数生成器，因此从迭代 N 开始，使用用户的密码和盐与 PBKDF2，生成安全的随机数据。

此过程应确定性地生成公钥/私钥 RSA 密钥对。但是，不这样做的原因是：

*   这是我编造的，AFAIK，这篇文章是这个过程第一次被公开审查。
*   我不知道 PBKDF2 是否真的可以作为与 RSA 一起使用的安全随机数生成器。
*   PBKDF2 可以保证生成一个公共/私有 RSA 密钥对的来源数据，这可能是真的，也可能不是。
*   在实践中，虽然这确实有效，但需要很长时间，并且需要的时间基于用户的密码，这是需要考虑的用户体验和安全暴露点。

完成您正在尝试做的事情的更好方法是：

1.  定义一个安全级别N，越大越安全，但这个过程会更慢。
2.  生成一个“salt”并将其与用户的 id 相关联。
3.  生成 RSA 公钥/私钥对。
4.  迭代 PBKDF2 N 次以根据用户的密码和盐创建对称密钥。
5.  使用对称加密算法加密私钥。
6.  将未加密的公钥和加密的私钥上传到服务器。

这更好，因为：

*   上面列出的所有流程都是 AFAIK 标准和经过审查的。
*   公钥/私钥的生成（耗时）仅在设置用户帐户时发生一次。
*   访问密钥总是在固定的时间内发生。

这解决了你的问题：

*   由于服务器只有加密的私钥，它不能解密用户的数据。
*   如果客户端机器死了，服务器可以重新发布私钥。

当然会有明显的警告，比如如果用户忘记了他们的密码，他们的所有数据都会被锁定，直到公众知道如何破解 RSA 或者用 10 亿年的当前计算能力来破解他们的密码;-) (当然取决于 N 和密钥大小）。此外，盐对于防止字典攻击也很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:38:15.017

您的算法的字段（例如 RSA [http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsaparameters.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsaparameters.aspx)）或多或少取决于您。您可以轻松地创建一个算法来从某个字符串生成 D 和 P（从中计算其他 RSA 字段）。不过，我真的建议您不要从 StackOverflow 上的答案中选择一个（这只会让想要获取您的数据的人容易尝试）。

像 RSA 这样的算法难以破解的原因是基于加密数据对私钥/公钥进行逆向工程所付出的努力。如果您引入“快捷方式”，例如基于密码的可重现生成算法，那么系统的安全性现在取决于密码的保密程度，而不是加密算法本身。

私钥也是如此；这就是为什么许多组织不将私钥存储在硬盘驱动器上，而是将它们存储在受密码或某些生物特征信息保护的安全外部设备上。

我建议您*不要*从密码短语中生成密钥，而只需使用推荐的做法来存储和保护您的私钥。

# sql - 使用特定数字更新 int 列

> ID：15203789
> 
> 赞同：-4
> 
> 时间：2013-03-04T14:25:50.717
> 
> 标签：sql

我想通过一些偏移量更新我的表的列。现在我正在使用这个

```
SELECT FROM reward where id = xx
$score = id->score + 1;
then
UPDATE reward SET score = $score WHERE id = xx 
```

有没有办法代替我可以做的两个查询`UPDATE SET score = score + 1`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:27:13.143

如果您希望增加一次尝试：

```
UPDATE reward SET score = score + 1 WHERE id = xx 
```

如果要添加奖励：

```
UPDATE reward SET score = score + reward WHERE id = xx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:29:55.510

如果您需要从另一个表中选择它，您可以这样做：

```
update reward set score = (select score from reward where id = xx) + 1 where id = xx 
```

或者，如果您只需要将该分数加一：

```
UPDATE reward SET score = score + 1 WHERE id = xx 
```

# google-maps-api-3 - 避免信息框重叠 - 谷歌地图 v3

> ID：15203790
> 
> 赞同：1
> 
> 时间：2013-03-04T14:25:51.957
> 
> 标签：google-maps-api-3, overlapping, infobox

我在谷歌地图上显示巡航路线，并用信息框标记每个港口。不幸的是，这些信息框经常重叠。如何避免这种情况？

我已经尝试过 spiderfy，但它不适合这种情况。

更改地图的缩放级别也不是一种选择。理想的情况是一个插件或类似的东西，可以在创建时识别重叠的信息框并重新排列它们。但是，我无法在任何地方找到这样的东西。

第二种可能性是通过 javascript 更改位置，但由于我缺乏 javascript 和谷歌地图的专业知识，我无法实现这一点。我也没有找到可以破解的示例。

将不胜感激一些正确方向的信息/建议/指针。

谢谢 MK

这是我的代码：

```
function initialize() {
    var arrayMarkers = [];
    var idx = 0;
    var mapLatlng = new google.maps.LatLng(-27.6264198719, 146.9179666042);
    var mapOptions = { center: mapLatlng,
    zoom: 13, 
    mapTypeId: google.maps.MapTypeId.SATELLITE };
    var map = new google.maps.Map(document.getElementById("karte"), mapOptions);
    var bounds = new google.maps.LatLngBounds();

    arrayMarkers[idx] = [];
    arrayMarkers[idx]['breite'] = -33.859261813133;
    arrayMarkers[idx]['laenge'] = 151.200070381165;
    arrayMarkers[idx]['farbe'] = "http://new.kfb.localhost:8888/img/ico/button2_gruen.png";arrayMarkers[idx]['hafen'] = "Abfahrt Sydney";
    arrayMarkers[idx]['link'] = "Karte&#44; Wetter und<br>Landausfl&uuml;ge f&uuml;r<br><a href='hafen.php?hafen=528'>Sydney</a><br>Do, 07.02.13";idx++;
    arrayMarkers[idx] = [];

      .
      .
      . etc. 
```

要将标记和信息框添加到地图，我调用此函数：

```
function create_markers_v3(map, bounds, arrayMarkers) {

var latLng = [];
var img = [];
var marker = [];
var optionsPort = [];
var ib = [];
var infoWindow = [];

for (i = 0; i < arrayMarkers.length; i++)
{
    latLng[i] = new google.maps.LatLng(arrayMarkers[i]['breite'], arrayMarkers[i]['laenge']);
    bounds.extend(latLng[i]);
    map.fitBounds(bounds);
    img[i] = arrayMarkers[i]['farbe'];
    marker[i] = new google.maps.Marker(
    {
        position: latLng[i],
        map: map,
        icon: img[i]
    });
    optionsPort[i] = {
        content: arrayMarkers[i]['hafen'],
        disableAutoPan: false,
        pixelOffset: new google.maps.Size(3, -20),
        position: new google.maps.LatLng(arrayMarkers[i]['breite'], arrayMarkers[i]['laenge']),
        zIndex: null,
        boxStyle: { 
            opacity: 0.81,
            fontSize: "6pt",
            backgroundColor: "#ffffff",
            padding: "0 2px 1px 3px",
            lineHeight: "1em",
            border: "1px solid #333333"
        },
        closeBoxURL: "",
        isHidden: false,
        pane: "floatPane",
        enableEventPropagation: true
    };
    if (arrayMarkers[i]['hafen'].length > 0)
    {
        ib[i] = new InfoBox(optionsPort[i]);
        ib[i].open(map, marker[i]);
        arrayMarkers[i]['ib'] = ib[i];

        if (arrayMarkers[i]['link'].length > 0)
        {                   
            addInfoWindow(map, arrayMarkers[i], marker[i], i);
        }
    }
}
return arrayMarkers; 
```

}

# sql - 在不使用临时表的情况下排序并将运行总计应用于同一列

> ID：15203797
> 
> 赞同：3
> 
> 时间：2013-03-04T14:26:04.093
> 
> 标签：sql, sql-server, sql-server-2005, cumulative-sum

我的表的表示：

```
CREATE TABLE Sales 
    (
     id int identity primary key, 
     SaleAmount numeric(10,2)
    );

DECLARE @i INT;
SELECT @i = 1;
SET NOCOUNT ON
WHILE @i <= 100
BEGIN
    INSERT INTO Sales VALUES (ABS(CHECKSUM(NEWID()))/10000000.0 );
    SELECT @i = @i + 1;
END;
SET NOCOUNT OFF 
```

我需要对我的表进行排序`Sales`，`SaleAmount`然后选择运行总数`SaleAmount`不大于 X的所有记录。

为此，我目前正在使用一个临时表来首先对记录进行排序，然后选择运行总计小于或等于 X 的记录（在此示例中为 10）。

```
CREATE TABLE #TEMP_TABLE 
    (
      ID integer IDENTITY PRIMARY KEY, 
      SaleAmount numeric(10,2)
    );

INSERT INTO #TEMP_TABLE 
(SaleAmount)
SELECT SaleAmount FROM Sales
ORDER BY SaleAmount

SELECT * FROM
  (SELECT
      Id,
      SaleAmount,
      (SaleAmount+COALESCE((SELECT SUM(SaleAmount)
          FROM #TEMP_TABLE b
          WHERE b.Id < a.Id),0))
          AS RunningTotal
    FROM #TEMP_TABLE a) InnerTable
WHERE RunningTotal <= 10 
```

有没有一种方法可以让我在不使用临时表的情况下先订购我`Sales`的桌子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:34:49.803

如果您使用的是 SQL Server 2012，那么您可以只使用窗口函数进行累积和：

```
select s.*,
       sum(SaleAmount) over (order by id) as RunningTotal
from Sales s 
```

这等效于以下相关子查询：

```
select s.*,
       (select sum(SalesAmount) from sales s2 where s2.id <= s.id) as RunningTotal
from Sales s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T16:17:00.127

遵循 Aaron Bertrand 关于使用游标方法的建议：

```
DECLARE @st TABLE
(
    Id       Int PRIMARY KEY,
    SaleAmount  Numeric(10,2),
    RunningTotal Numeric(10,2)
);

DECLARE
    @Id         INT,
    @SaleAmount  Numeric(10,2),
    @RunningTotal Numeric(10,2) = 0;

DECLARE c CURSOR
    LOCAL STATIC FORWARD_ONLY READ_ONLY
    FOR
    SELECT id, SaleAmount
      FROM Sales
      ORDER BY SaleAmount;

OPEN c;

FETCH NEXT FROM c INTO @Id, @SaleAmount;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @RunningTotal = @RunningTotal + @SaleAmount;

    INSERT @st(Id, SaleAmount,  RunningTotal)
        SELECT @Id, @SaleAmount, @RunningTotal;

    FETCH NEXT FROM c INTO @Id, @SaleAmount;
END

CLOSE c;
DEALLOCATE c;

SELECT Id, SaleAmount, RunningTotal
    FROM @st
    WHERE RunningTotal<=10
    ORDER BY SaleAmount; 
```

这是代码的增加，仍然需要一个表变量。但是，性能的提高是显着的。

归功于 Aaron Bertrand写的[关于运行总计的出色文章](http://www.sqlperformance.com/2012/07/t-sql-queries/running-totals)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:06:31.077

CTE、[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734%28v=sql.90%29.aspx)排名函数和[APPLY()](http://msdn.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)运算符的另一种选择

```
 ;WITH cte AS
   (
    SELECT ROW_NUMBER() OVER(ORDER BY SaleAmount) AS rn, SaleAmount
    FROM Sales s  
    )
    SELECT *
    FROM cte c CROSS APPLY (
                            SELECT SUM(s2.SaleAmount) AS RunningTotal
                            FROM Sales s2
                            WHERE c.SaleAmount >= s2.SaleAmount
                            ) o
    WHERE o.RunningTotal <= 10 
```

仅供参考，为了避免排序操作，您可以使用此索引：

```
CREATE INDEX ix_SaleAmount_Sales ON Sales(SaleAmount) 
```

![在此处输入图像描述](../Images/45618d4a30f8f9ce094ddb053f64ec63.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T14:31:18.473

首先，您正在执行子选择，然后从子选择中执行 select *。这是不必要的。

```
SELECT
  Id,
  SaleAmount,
  (SaleAmount+COALESCE((SELECT SUM(SaleAmount)
      FROM #TEMP_TABLE b
      WHERE b.Id < a.Id),0))
      AS RunningTotal
FROM #TEMP_TABLE
WHERE RunningTotal <= 10 
```

现在，临时表只是对 Sales 表的查询。对临时表进行排序是没有意义的，因为根据 SQL 的规则，不必遵守临时表中的顺序，只需要外部查询上的 order by 子句，所以

```
SELECT
  Id,
  SaleAmount,
  (SaleAmount+COALESCE((SELECT SUM(SaleAmount)
      FROM Sales b
      WHERE b.Id < a.Id),0))
      AS RunningTotal
FROM Sales
WHERE RunningTotal <= 10 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T14:45:56.247

经过一番研究，我相信你的目标是不可能的，除非使用 SS2012 或 Oracle。

由于您的解决方案似乎有效，我建议使用表变量而不是模式表：

```
DECLARE @TEMP_TABLE TABLE (
    ID integer IDENTITY PRIMARY KEY,
    SaleAmount numeric(10,2) 
);

INSERT INTO @TEMP_TABLE 
(SaleAmount)
SELECT SaleAmount FROM Sales
ORDER BY SaleAmount

SELECT * FROM
  (SELECT
      Id,
      SaleAmount,
      (SaleAmount+COALESCE((SELECT SUM(SaleAmount)
          FROM @TEMP_TABLE b
          WHERE b.Id < a.Id),0))
          AS RunningTotal
    FROM @TEMP_TABLE a) InnerTable
WHERE RunningTotal <= 10 
```

在并行测试时，我发现了一些性能改进。

# javascript - 似乎无法将样式应用于 Google MAP API

> ID：15203798
> 
> 赞同：0
> 
> 时间：2013-03-04T14:26:09.797
> 
> 标签：javascript, google-maps

我试图改变这个谷歌地图实例的饱和度。除了饱和样式外，其他一切都在工作。我究竟做错了什么 ？

代码：

```
$(function() { // when the document is ready to be manipulated.
    if (GBrowserIsCompatible()) { // if the browser is compatible with Google Map's
        var map = document.getElementById("myMap"); // Get div element
        var m = new GMap2(map); // new instance of the GMap2 class and pass in our div location.

        m.setCenter(new GLatLng(59.334951,18.088598), 13); // pass in latitude, longitude, and zoom level.
        m.openInfoWindow(m.getCenter(), document.createTextNode("Looking Good")); // displays the text
        m.setMapType(G_NORMAL_MAP); // sets the default mode. G_NORMAL_MAP, G_HYBRID_MAP

        // var c = new GMapTypeControl(); // switch map modes
        // m.addControl(c);

        // m.addControl(new GLargeMapControl()); // creates the zoom feature

        var styleArray = [
            {
                featureType: "all",
                stylers: [
                    {saturation: -80}
                ]
            }
        ];
    }
    else {
        alert("Upgrade your browser, man!");
    }
}); 
```

我整天都在寻找（并且失败）以找到解决此问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:38:19.330

你有这样的一行：

```
m.setOptions({styles: styleArray}); 
```

在您声明样式器之后的某个地方？上面的行会将您创建的样式应用于您拥有的地图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T08:15:55.717

感谢您的所有帮助，我终于想通了。感觉有点愚蠢，但“m.setOtions”显然是 V3 API 的一个功能，我使用的是 V2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:42:16.733

看起来你`styleArray`的从未使用过。

# android - Android：更改背景颜色时声音应用程序崩溃

> ID：15203801
> 
> 赞同：0
> 
> 时间：2013-03-04T14:26:13.813
> 
> 标签：android, audio, background, onclick

我有以下问题。我有 3 个按钮用于更改背景颜色（分别为蓝色、红色和绿色），还有 5 个单选按钮，单击时会播放声音。背景颜色更改按钮和声音单选按钮都可以独立工作。As soon as I put them together on one screen, the application will crash when one of the background color change button is selected. 问题在于 RadioButton 行，特别是在这里：

`RadioButton rb = (RadioButton) v;`

我不知道该怎么做才能解决这个错误。有人可以帮助我吗？

这是 onClick 方法的代码：

```
 public void onClick(View v) {

            RelativeLayout rl = (RelativeLayout) findViewById(R.id.RelativeLayout1);

               switch (v.getId()) 
               {
               case R.id.button1:
                   Toast.makeText(getBaseContext(), "You switched the color to red!" , Toast.LENGTH_SHORT ).show();
                   rl.setBackgroundColor(Color.RED);

               break;
               case R.id.button2:
                   Toast.makeText(getBaseContext(), "You switched the color to green!" , Toast.LENGTH_SHORT ).show();
                   rl.setBackgroundColor(Color.GREEN);
               break;
               case R.id.button3:
                   Toast.makeText(getBaseContext(), "You switched the color to blue" , Toast.LENGTH_SHORT ).show();
                   rl.setBackgroundColor(Color.BLUE);
               break;
               case R.id.cancel:
                   Toast.makeText(getBaseContext(), "This application will be closed!" , Toast.LENGTH_SHORT ).show();
                   finish();
               break;
               }

               //Perform action on clicks
                 RadioButton rb = (RadioButton) v;  

                 //get the user sound settings
                 AudioManager audioManager = (AudioManager) getSystemService(AUDIO_SERVICE);

                 //get current volume
                 float actualVolume = (float) audioManager.getStreamVolume(AudioManager.STREAM_MUSIC);

                 //get maximum volume
                 float maxVolume = (float) audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);

                 float volume = actualVolume / maxVolume;

             //is the sound loaded already?
                 if(loaded) {
                     //play the sound
                     if (rb.getText().toString().equals("Clong!"))
                         gameAudio.play(soundIDs[0], volume, volume, 1, 0, 1f);
                     else if (rb.getText().toString().equals("Hammering!"))
                         gameAudio.play(soundIDs[1], volume, volume, 1, 0, 1f);
                     else if (rb.getText().toString().equals("Chainsaw Attack!"))
                         gameAudio.play(soundIDs[2], volume, volume, 1, 0, 1f);
                     else if (rb.getText().toString().equals("Smoke alarm!"))
                         gameAudio.play(soundIDs[3], volume, volume, 1, 0, 1f);
                     else if (rb.getText().toString().equals("Sharp the knife!"))
                         gameAudio.play(soundIDs[4], volume, volume, 1, 0, 1f);
                 }

           } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:32:52.563

尝试这个

```
//Perform action on clicks
if(v instanceof RadioButton)
{
                 RadioButton rb = (RadioButton) v;  
}else return; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:31:26.950

听起来你`onClick()`是因为按下按钮而被解雇......在这种情况下，这`View v`不是`RadioButton`一个按钮而是一个​​按钮。

在这种情况下，您的 logcat（您应该始终包括在此处）将显示 ClassCastException。

将整个第二部分（处理声音）包裹在

```
if( v instanceof RadioButton ) {
    ... your code here
} 
```

你应该没事。

# c# - 我如何在我自己的数据库 ASP.NET mvc 4 中使用内置的成员资格方法

> ID：15203809
> 
> 赞同：2
> 
> 时间：2013-03-04T14:26:48.007
> 
> 标签：c#, asp.net, asp.net-mvc, authentication, logging

好的，所以我一直在努力寻找，但我找不到这个问题的解决方案，虽然这应该是相当普遍的。

问题是 ASP.NET MVC 使用`WebSecurity`帮助方法自动创建代码来登录用户。现在我想要的是连接 mvc 创建的用户和密码数据库与我自己的数据库，这样我就可以编写查询来识别哪些用户在博客上写了哪些帖子。

请我在这件事上需要一点指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:37:54.880

最简单的方法是更改​​ web.config 文件中的 DefaultConnection 连接字符串以指向您自己的数据库。然后将在您的数据库中创建 MVC 安全表。然后，您可以将您的表格链接到这些表格。

# wcf - WCF服务器客户端异步回调与对象

> ID：15203812
> 
> 赞同：0
> 
> 时间：2013-03-04T14:26:52.650
> 
> 标签：wcf, callback

我有服务器和客户端。
客户端调用服务器上的方法，服务器作为响应必须准备一个字典并发送回客户端。
此操作可能需要一些时间。
它应该是异步的。我阅读说明和示例。
主要是 BeginXXX 和 EndXXX IAsyncResult。但是如果我需要服务器返回对象字典。我该如何实施？

我想在发送回调委托时，我可以发送客户端函数之一的签名作为委托，当服务器完成时，它将使用正确的字典数据调用委托。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:31:13.000

1) 在 VS（或[SLSvcUtil](http://msdn.microsoft.com/en-us/library/cc197958%28v=vs.95%29.aspx)）中添加服务引用会为 Silverlight 项目生成带有事件的方便代理代码。如果需要，您可以使用它为您的“服务/服务器代理”实现回调模式。您可以将此代码与常规 .net 应用程序一起使用，也可以进行一些修改。

2) .Net 项目的 VS 可以使用异步方法生成代理。SvcUtil -[太](http://jeffbarnes.net/blog/post/2007/07/26/svcutil-essentials-asynchronous-proxy-methods.aspx)。

3) 对于真正长时间运行的操作，您可以使用带有[回调](http://blogs.msdn.com/b/carlosfigueira/archive/2012/04/12/event-based-callback-contracts-on-wcf-duplex-clients.aspx)的 WCF 服务（+ 一些绑定限制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T12:09:36.323

如果我以正确的方式理解你，你会问这个（基于 eLibrary 项目）： WCF 服务器端：

```
 EBooksLibraryEntities ebe = new EBooksLibraryEntities();    
 public List<Book> tabBooks()
    {
        return ebe.Books.ToList();
    } 
```

客户端：

```
 ServiceReference1.Service1Client sr = new ServiceReference1.Service1Client();
    List<ServiceReference1.Book> llb = new List<ServiceReference1.Book>();
    private void GetBooksByAuthor()
    {
        sr.tabBooksByAuthorCompleted += new EventHandler<ServiceReference1.tabBooksByAuthorCompletedEventArgs>(sr_tabBooksByAuthorCompleted);
        sr.tabBooksByAuthorAsync();
    }
    void sr_tabBooksByAuthorCompleted(object sender, ServiceReference1.tabBooksByAuthorCompletedEventArgs e)
    {
        foreach (var item in e.Result)
        {
            yourList.Add(item);
        }
    } 
```

# codeigniter-2 - 在 codeigniter 中路由是如何完成的？

> ID：15203816
> 
> 赞同：0
> 
> 时间：2013-03-04T14:27:02.640
> 
> 标签：codeigniter-2

我在框架中找不到该`.htaccess`文件，`CodeIgniter`我想知道没有它他们如何进行路由？还是隐藏在某个地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:00:54.203

默认情况下，codeigniter 没有提供 .htaccess。他们通过 index.php 提供服务。.htaccess 仅用于将 url 指向 index.php。这样，codeigniter 在不允许重写的环境中工作。获取控制器和函数的另一种方法是通过查询字符串。无论如何，实际路由是在 system/core/Router.php 中完成的，因此您可以阅读代码。由于 Codeigniter 是无法隐藏的开源应用程序。

# c - 如何创建工会

> ID：15203817
> 
> 赞同：-2
> 
> 时间：2013-03-04T14:27:05.063
> 
> 标签：c, unions

我在使用 union 时犯了一个错误，我不知道为什么。问题出在`goto_xy();` 我从书中读到的函数中，但无法编译。在此函数中，我试图定位光标，但未`REGS`声明变量。我想知道它的功能是什么。

```
#include<stdio.h>
#include<windows.h>
#include<dos.h>
#include<conio.h>

void goto_xy(int x,int y);                         //goto is a key word;define the subfunction to creat the original cursor int the coordinate system
void rectangle_clear(int x1,int x2,int y1,int y2); //define the rectangle_clear opening subfunction 
void center_clear(int x1,int x2,int y1,int y2);    //define the center_clear opening subfunction
void creat();                                  //define the subfunction of creating the star
int main()                                             //the main function
{
    creat();
    getch();
    center_clear(0,25,0,79);
    getch();
}
void center_clear(int x1,int x2,int y1,int y2)     //the subfunction which creats the stars while opening the project
{
    int x00,y00,x0,y0,i,d;
    if((y2-y1)>(x2-x1))
    {
        d=(x2-x1)/2;
        x0=(x1+x2)/2;
        y0=y1+d;
        y00=y2-d;
        for(i=0;i<(d+1);i++)
        {
            rectangle_clear((x0-i),(x00+i),(y0-i),(y00+i));
        }
        delay(10);                                  //to delay the dismis of the star
    }
    else
    {
        d=(y2-y1)/2;
        y0=(y1+y2)/2;
        x0=x1+d;
        x00=x2-d;
        for(i=0;i<d+1;i++)
        {
            rectangle_clear((x0-i),(x00+i),(y0-i),(y00+i));
        }
        delay(10);
    }
}
void rectangle_clear(int x1,int x2,int y1,int y2)   //to creat the star int the shape of a rectangle
{
    int i,j;
    for(i=y1;i<y2;i++)
    {
        goto_xy(x1,i);
        putchar(' ');
        goto_xy(x2,i);
        putchar(' ');
        delay(10);
    }
    for(j=x1;j<x2;j++)
    {
        goto_xy(i,y1);
        putchar(' ');
        goto_xy(i,y2);
        putchar(' ');
        delay(10);
    }
}
void goto_xy(int x,int y)
{
    union REGS r;

    r.h.ah=2;
    r.h.dl=y;
    r.h.dh=x;
    r.h.bh=0;
    int86(0x10,&r,&r);
}
void creat()
{
    int i,j;
    for(i=0;i<24;i++)
    {
        for(j=0;j<79;j++)
        {
            goto_xy(i,j);
            printf("a");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:36:12.973

在我看来，联合`REGS`必须已经存在于其中一个头文件中，并且您包含相同的头文件。

从下面的代码中可以看出，即使是 union like`h`和 members of 的成员`h`也存在，这意味着 union 存在于某个头文件中，并且您正在包含它。

```
void goto_xy(int x,int y)
{
    union REGS r;

    r.h.ah=2; //Here you are accessing the member of REGS and even the sub-members of h
    r.h.dl=y;
    r.h.dh=x;
    r.h.bh=0;
    int86(0x10,&r,&r);
} 
```

**编辑：** 谷歌搜索告诉我`UNION REGS`将在其中定义`dos.h`，它有点像

```
union REGS { 
 struct WORDREGS x;
 struct BYTEREGS h;
}; 
```

*因此，您需要包含 dos.h 来解决您的问题。但是，尽管您包括在内，但似乎仍然存在此问题。您也可以打开 dos.h 并检查 union REGS 是否存在。*

有关更多详细信息，请参见[此处](http://en.allexperts.com/q/C-1587/2009/11/union-REGS.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:32:20.723

要定义 a `union`，您需要执行以下操作：

`union REGS { some_type h; other_type f; };`

现在您可以创建类型变量`REGS`并使用联合。

# asp.net-mvc - 模拟设置未按预期工作

> ID：15203820
> 
> 赞同：1
> 
> 时间：2013-03-04T14:27:11.190
> 
> 标签：asp.net-mvc, nunit

我正在使用 NUnit 来测试我的应用程序，方法为

```
 public int POCRemainingUnits()
    {

        var units = _transportService.GetUnits(x => x.Shipment.Id == shipmentId && x.POCAllowed == true && x.IsPOC == false, 0);
        int POCUnitCount = units.Count();

        //
        //
    } 
```

我的测试方法类似于

```
[Test]
        public void Invoke_POCUnitCommand_As_Many_Times_As_Number_Of_Remaining_Units_With_Valid_Input()
        {
            //arrange
            var unit1 = new Unit { IsPOC = false, POCAllowed = true };
            var unit2 = new Unit { IsPOC = false, POCAllowed = true };
            IQueryable<Unit> units = (new Unit[] { unit1, unit2 }).AsQueryable();

            _transportServiceMock.Setup(y => y.GetUnits(x => x.Shipment.Id == 1 && x.POCAllowed == true && x.IsPOC == false, 0)).Returns(units);

     //
     //
    } 
```

但它失败了，因为它没有设置 GetUnits 方法。如果我检查 POCRemainingUnits 中的计数，它仍然返回零。谁能告诉我我做错了什么。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:48:15.850

要设置模拟，您需要编写类似

```
transportServiceMock
    .Setup(ts => ts.GetUnits(It.IsAny<Func<Unit, bool>>(), It.IsAny<int>()))
    .Returns(units); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:31:24.397

根据我的经验，使用 lambdas 作为参数进行模拟是行不通的。我们认为相等的表达式实际上并不相等。

例如：

```
[whatever].Where(x=>x.ShipmentId == 3); 
```

不被视为等于

```
id = 3;
[whatever].Where(x=>x.ShipmentId == id); 
```

我的建议是要么伪造你的存储库进行测试，要么隔离查询并使用集成测试对其进行测试。

[看这里](https://stackoverflow.com/a/4340585/1640800)

你可以做些什么来获得回报是这样的

```
Where(Arg.Any<Expression<Func<Unit, bool>>>()).Returns(units); 
```

您对 lambda 表达式的测试必须以另一种方式进行。要么将其分离为单独的方法并集成测试该方法，要么创建一个您插入的假存储库并将实体插入该存储库以从中获取。

# .net - .net 紧凑框架中的 C++/CLI

> ID：15203824
> 
> 赞同：1
> 
> 时间：2013-03-04T14:27:27.270
> 
> 标签：.net, c++-cli, compact-framework

C++/CLI 在 .net 紧凑框架中可用吗？当我谷歌它说它不可用但文章很旧。那么它现在可用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:30:49.423

不，您不能为 .NET CF 构建 C++/CLI 应用程序。

可以为 CF 构建的最后一个 VS 版本是 VS2008，因此您会发现与 .NET CF 相关的所有内容都是旧版本。

您还需要注意，编组代码的功能远不如完整框架中的完整，但遗憾的是，这些限制仅在运行时出现（各种不受支持的异常）。因此，即使是 P/Invoke 及其周围环境也可能会给您带来痛苦。

就个人而言，我今天不会启动 .NET CF 项目，尽管我确实支持一些现有的项目。

# python - python argparse 文件扩展名检查

> ID：15203829
> 
> 赞同：5
> 
> 时间：2013-03-04T14:28:02.400
> 
> 标签：python, argparse

可`argparse`用于验证文件名 cmd 行参数的文件扩展名？

例如，如果我有一个从 cmd 行运行的 python 脚本：

```
$ script.py file.csv
$ script.py file.tab
$ script.py file.txt 
```

我希望 argparse 接受第一个两个文件名 cmd 行选项，但拒绝第三个

我知道你可以这样做：

```
parser = argparse.ArgumentParser()
parser.add_argument("fn", choices=["csv","tab"])
args = parser.parse_args() 
```

为 cmd 行选项指定两个有效选项

我想要的是这样的：

```
parser.add_argument("fn", choices=["*.csv","*.tab"]) 
```

为 cmd 行选项指定两个有效的文件扩展名。不幸的是，这不起作用 - 有没有办法使用`argparse`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T14:34:20.930

当然——你只需要指定一个适当的函数作为`type`.

```
import argparse
import os.path

parser = argparse.ArgumentParser()

def file_choices(choices,fname):
    ext = os.path.splitext(fname)[1][1:]
    if ext not in choices:
       parser.error("file doesn't end with one of {}".format(choices))
    return fname

parser.add_argument('fn',type=lambda s:file_choices(("csv","tab"),s))

parser.parse_args() 
```

演示：

```
temp $ python test.py test.csv
temp $ python test.py test.foo
usage: test.py [-h] fn
test.py: error: file doesn't end with one of ('csv', 'tab') 
```

* * *

这是一种可能更干净/更通用的方法：

```
import argparse
import os.path

def CheckExt(choices):
    class Act(argparse.Action):
        def __call__(self,parser,namespace,fname,option_string=None):
            ext = os.path.splitext(fname)[1][1:]
            if ext not in choices:
                option_string = '({})'.format(option_string) if option_string else ''
                parser.error("file doesn't end with one of {}{}".format(choices,option_string))
            else:
                setattr(namespace,self.dest,fname)

    return Act

parser = argparse.ArgumentParser()
parser.add_argument('fn',action=CheckExt({'csv','txt'}))

print parser.parse_args() 
```

这里的缺点是代码在某些方面变得有点复杂——结果是当你真正去格式化你的参数时，界面变得更干净了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-04T14:36:58.147

定义一个将名称作为字符串的自定义函数 - 将扩展名分开以进行比较，如果没问题就返回字符串，否则会引发 argparse 期望的异常：

```
def valid_file(param):
    base, ext = os.path.splitext(param)
    if ext.lower() not in ('.csv', '.tab'):
        raise argparse.ArgumentTypeError('File must have a csv or tab extension')
    return param 
```

然后使用该功能，例如：

```
parser = argparse.ArgumentParser()
parser.add_argument('filename', type=valid_file) 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-04T14:33:44.250

不，您可以为选择参数或任何支持“in”运算符的容器对象提供容器对象。您可以在[pydocs阅读更多内容](http://docs.python.org/dev/library/argparse.html#choices)

您可以随时自行检查并向用户提供反馈。

# android - 如何更改菜单的操作栏子菜单项样式

> ID：15203830
> 
> 赞同：3
> 
> 时间：2013-03-04T14:28:03.183
> 
> 标签：android, android-menu

我的操作栏；

```
 <item
        android:id="@+id/userMenuItem"
        android:orderInCategory="100"
        android:showAsAction="ifRoom|withText">
        <menu>
            <item android:id="@+id/logout"
                  android:title="@string/logout"
                  android:showAsAction="ifRoom|withText" />
        </menu>
    </item> 
```

和 style.xml ；

```
<style name="AppTheme" parent="android:style/Theme.Holo.Light">
    <item name="android:actionBarStyle">@style/MyActionBar</item>
    <item name="android:actionMenuTextAppearance">@style/MyActionBar.MenuTextStyle</item>
</style>

<style name="MyActionBar" parent="@android:style/Widget.Holo.Light.ActionBar">
    <item name="android:titleTextStyle">@style/MyActionBar.TitleTextStyle</item>
    <item name="android:background">@drawable/action_bar_style</item>
</style>

<style name="MyActionBar.TitleTextStyle" parent="android:style/TextAppearance.Holo.Widget.ActionBar.Title">
    <item name="android:textColor">#191970</item>
    <item name="android:textStyle">bold</item>
    <item name="android:textSize">24sp</item>
</style> 
```

问题是如何更改注销项目样式，如字体大小、颜色分机。

```
 <item name="android:actionMenuTextAppearance">@style/MyActionBar.MenuTextStyle</item> 
```

正在为菜单项样式工作，但我无法更改子菜单样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-30T17:30:56.210

您可以更改参考`android:listViewStyle`以更改您的子菜单列表布局。如果你想在你的 Light 主题中使用来自 Holo 黑暗版本的菜单，你可以写：

```
<style name="AppTheme" parent="android:style/Theme.Holo.Light">
   <item name="android:actionBarStyle">@style/MyActionBar</item>
   <item name="android:actionMenuTextAppearance">@style/MyActionBar.MenuTextStyle</item>
   <item name="android:listViewStyle">@android:style/Widget.Holo.ListView</item>
</style> 
```

当然，您可以使用调整后的字体指定自己的样式。这只会更改下拉菜单。

# android - Android 数据库与 Dropbox SyncAPI 同步

> ID：15203832
> 
> 赞同：3
> 
> 时间：2013-03-04T14:28:09.037
> 
> 标签：android, dropbox

我想将 Android 应用程序的数据库与新的 Dropbox SyncAPI 同步。我不太了解[https://www.dropbox.com/developers/sync/tutorial/android](https://www.dropbox.com/developers/sync/tutorial/android)上的教程，“Notes”的示例对我来说有点混乱。我仍然可以使用API​​登录平台，并且我知道我应该将数据库作为单个文件来处理，获取它的路径。我的问题是：这样做的主要关键点是什么（处理程序？监听器到文件？）？我在哪里可以找到其他例子来研究我的案例？谢谢。

# r - R中的运动数据分析；飞行和时间子采样

> ID：15203834
> 
> 赞同：3
> 
> 时间：2013-03-04T14:28:13.310
> 
> 标签：r, spatial, temporal

我想分析动物运动的角度。我有每秒记录 10 次的跟踪数据。每次记录的数据包括动物的位置 (x,y)、相对于先前记录的角度和距离，此外还包括速度和加速度。我想分析动物在做出特定角度时的速度，但是由于我的数据的时间分辨率非常高，所以每个转弯都包含许多微小的角度。

我认为有两种可能的方法可以解决这个问题，对于这两种方法我都不知道如何在 R 中实现这样的事情，我们将不胜感激。

第一个：将我的时间分辨率降低某个因素。然而，这带来了丢失数据的可能重要部分的缺点。尽管如此，我如何能够自动对数据集的每 3 次或 10 次记录进行二次采样？

第二种：将直线运动转化为所谓的“飞行​​”；基于规则的步骤聚合在大致相同的方向上，由急转弯隔开（见图）。当与飞行主方向的垂直距离大于 x（可以任意设置的值）时，两点之间的飞行结束。有谁知道如何使用我拥有的 xy 坐标位置数据来做到这一点？

![在此处输入图像描述](../Images/c72666014b409e78cb2b1f663919dd7a.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T14:54:52.887

听起来您可能需要三件潜在的帮助：算法、数学或 R 语法。

您需要的算法可能取决于您的数据的具体情况。例如，您有多少数据？它是什么格式的？它是 2D 还是 3D？一种可能性是遍历您的数据集。对于每个新点，您需要检查所有以前的点，看看它们是否在您想要的列中。但是，如果数据集很大，这可能真的很慢。最坏的情况是，所有数据点都在一个**航段中**，这意味着您将检查第一个点的次数与您有数据点的次数相同，第二个点少一次，等等。这意味着 n + (n-1) + (n-2) + ... + 1 = n(n-1)/2 次操作。那是 O(n^2); 相对于数据集的大小，操作时间可能呈二次增长。因此，您可能需要更复杂的东西。

检查一个点是否在所需的 x 列内的数学非常简单，尽管更复杂的数学可能有助于为更好的算法提供信息。一种方法是使用矢量算术。举个例子，假设您有点 A、B 和 C。您的目标是查看 B 是否落在从 A 到 C 的向量周围的宽度为 x 的列中。为此，找到与 C 正交的向量 v，然后看向量从A到B到v上的标量投影的大小是否小于x。有很多文献可以帮助解决这类问题，[这里](http://www.math.oregonstate.edu/home/programs/undergrad/CalculusQuestStudyGuides/vcalc/dotprod/dotprod.html)有一个例子。

我认为这是我可能开始的地方（对单个点使用布尔函数），因为确定这一点的 R 函数似乎很方便。然后另一个函数获取一组点并计算向量 v 并为集合中的每个点调用第一个函数。然后运行一些数据，看看需要多长时间。

恐怕我不会对 R 语法有太大帮助，尽管它在我想学习的东西的清单上。昨晚我查看了 R 手册，里面有很多有用的例子。我相信这是非常可行的，即使对于像我这样的 R 新手也是如此。如果你有一个大数据集，它可能会有点慢。但是，有了一些可行的方法，也可能更容易从具有更多知识和经验的人那里获得帮助来优化它。

* * *

两个快速澄清点，以防它们有帮助：

1.  上面的建议只是从单一动物的数据开始，所以当我谈论数据增长时，我指的是单一动物的平均数据样本量。如果这很慢，您可能需要先修复它。然后，您需要潜在地分析/优化用于处理多种动物的算法。
2.  我隐含地假设**航段**的定义是连续数据点的最大子集，其中没有“子”航段违反列规则。也就是说，我想我可以想出一个例子，其中一组点满足你的规则，即落在向量周围宽度 x 的列中到最后一个点，但是如果你查看宽度 x 的列周围向量到倒数第二个点，一个点将不再符合标准。根据您定义**航段**的方式（例如，如果您希望它是满足您的条件并且不关心内部发生的情况的最大可能点集），您可能需要一些不同的东西（例如，向后而不是向前工作）。

# openldap - OpanLdap 密码策略

> ID：15203837
> 
> 赞同：0
> 
> 时间：2013-03-04T14:28:36.367
> 
> 标签：openldap, ldap-query

我已经在 windows xp 上安装了 openldap 版本 2.4.23 并使用 apache DS 作为客户端。我可以在我为测试设置的客户端服务器上验证用户。

我的下一步是打开密码策略。这是事情对我来说有点模糊的地方，我希望有人可以帮助我。

我还使用以下命令添加了密码策略

ldapadd -x -c -f -D "cn=Manager,dc=maxcrc,dc=com" -w 秘密

但是在添加密码策略之后，我如何使它们生效。

openldap 文档说密码策略模块应该使用默认策略的 DN 进行配置。

我在 slapd.conf 文件中添加了以下几行

```
# invokes password policies for this DIT only
overlay ppolicy
# Default ppolicy
ppolicy_default "cn=passwordDefault,ou=policies,dc=maxcrc,dc=com" 
```

但不知何故，它没有被加载，我已经在这上面花了很多时间，但我没有得到正确的指南。

任何人都可以用简单的外行术语来阐明这一点吗？

提前致谢。

我的 ldif 文件如下。

```
dn: cn=passwordDefault,ou=policies,dc=localdomain,dc=com
objectClass: pwdPolicy
objectClass: person
objectClass: top
cn: passwordDefault
sn: passwordDefault
pwdAttribute: userPassword
pwdCheckQuality: 1
pwdMinAge: 1
pwdMaxAge: 90
pwdMinLength: 6
pwdInHistory: 4
pwdMaxFailure: 3
pwdFailureCountInterval: 0
pwdLockout: TRUE
pwdLockoutDuration: 0
pwdAllowUserChange: TRUE
pwdExpireWarning: 604800
pwdGraceAuthNLimit: 3
pwdMustChange: TRUE
pwdSafeModify: TRUE 
```

添加此策略并重新启动服务器后，我尝试更改现有用户和新添加用户的密码。服务器允许我将密码更改为长度小于 6 的字符串，而我在 ldif 中提到了 pwdMinLength: 6。

以及我多次尝试更改密码，但它允许我将密码更改为最近使用的密码，而 ldif 中的 pwdInHistory: 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T11:29:44.810

如果您使用 rootDN 执行更新，密码策略将不起作用。您必须使用现有的管理员帐户或用户自己的帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-05T08:11:50.227

> rootdn 绕过密码策略，所以不要在 ldappasswd 命令中使用 rootdn。

[https://www.openldap.org/lists/openldap-technical/201102/msg00262.html](https://www.openldap.org/lists/openldap-technical/201102/msg00262.html)

如果使用 ldappasswd 设置密码并与 rootdn 绑定，则基本上可以输入任何密码（不是空的）。这是一个有点棘手的情况，因为您也无法使用“passwd”命令为用户更改密码。在这种情况下，密码策略将生效。

如果您知道 rootdn 密码，则可以绕过所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-06T05:16:29.643

目前尚不清楚您在测试时如何设置密码，但我会检查您是否以正确的格式传递密码，这意味着服务器需要以明文形式接收密码。一些客户端会在将值发送到 OpenLDAP 服务器之前对该值进行哈希处理，在这种情况下，OpenLDAP 服务器将无法确定密码的长度。通信可以而且应该被加密，但它不应该被预先散列。哈希可以由服务器处理：

**pwdCheck质量**

如果值为 1 并且提供的密码是明文形式，则用户提供的函数（使用 pwdCheckModule 定义 - 如果已定义 - 将被调用以检查密码质量。如果此函数不可用，则密码将被接受（假设它通过各种 pwdPolicy 属性定义的所有其他测试）。

参考：[http ://www.zytrax.com/books/ldap/ch6/ppolicy.html](http://www.zytrax.com/books/ldap/ch6/ppolicy.html)

# java - 如何获取耶拿查询的所有主题？

> ID：15203838
> 
> 赞同：8
> 
> 时间：2013-03-04T14:28:41.633
> 
> 标签：java, sparql, semantic-web, jena

假设我有一些耶拿查询对象：

```
String query = "SELECT * WHERE{ ?s <some_uri> ?o ...etc. }";
Query q = QueryFactory.create(query, Syntax.syntaxARQ); 
```

在查询中获取三元组的所有主题的最佳方法是什么？最好不必手动进行任何字符串解析/操作。

例如，给定一个查询

```
SELECT * WHERE {
    ?s ?p ?o;
       ?p2 ?o2.
    ?s2 ?p3 ?o3.
    ?s3 ?p4 ?o4.
    <http://example.com> ?p5 ?o5.
} 
```

我希望返回一些看起来像的列表

```
[?s, ?s2, ?s3, <http://example.com>] 
```

换句话说，我想要查询中所有主题的列表。即使只有那些是变量的主题或那些是文字/uris的主题也会很有用，但我想在查询中找到所有主题的列表。

我知道有一些方法可以返回结果变量 ( `Query.getResultVars`) 和一些其他信息（请参阅[http://jena.apache.org/documentation/javadoc/arq/com/hp/hpl/jena/query/Query.html](http://jena.apache.org/documentation/javadoc/arq/com/hp/hpl/jena/query/Query.html)），但是我似乎找不到任何可以专门获取查询主题的内容（所有结果变量的列表也将返回谓词和对象）。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T16:13:29.483

有趣的问题。您需要做的是通过查询，并为每个三元组块迭代并查看第一部分。

最可靠的方法是通过一个元素遍历器，它将遍历查询的每个部分。在您的情况下，它可能看起来很重要，但查询可以包含各种各样的东西，包括`FILTERs`,`OPTIONALs`和 nested `SELECTs`。使用 walker 意味着你可以忽略那些东西，只专注于你想要的东西：

```
Query q = QueryFactory.create(query); // SPARQL 1.1

// Remember distinct subjects in this
final Set<Node> subjects = new HashSet<Node>();

// This will walk through all parts of the query
ElementWalker.walk(q.getQueryPattern(),
    // For each element...
    new ElementVisitorBase() {
        // ...when it's a block of triples...
        public void visit(ElementPathBlock el) {
            // ...go through all the triples...
            Iterator<TriplePath> triples = el.patternElts();
            while (triples.hasNext()) {
                // ...and grab the subject
                subjects.add(triples.next().getSubject());
            }
        }
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-06T11:10:20.817

可能为时已晚，但另一种方法是利用 Jena ARQ 库并创建给定查询的代数。一旦创建了代数，就可以对其进行编译，并且可以遍历所有三元组（在 where 子句中给出）。下面是代码，希望对你有帮助：

```
Query query = qExec.getQuery(); //qExec is an object of QueryExecutionFactory

// Generate algebra of the query
Op op = Algebra.compile(query);
CustomOpVisitorBase opVisitorBase = new CustomOpVisitorBase();
opVisitorBase.opVisitorWalker(op);
List<Triple> queryTriples = opVisitorBase.triples; 
```

CustomOpVisitor 类如下：

```
public class CustomOpVisitorBase extends OpVisitorBase {
List<Triple> triples = null;
void opVisitorWalker(Op op) {
    OpWalker.walk(op, this);
}

@Override
public void visit(final OpBGP opBGP) {
    triples = opBGP.getPattern().getList();
}
} 
```

遍历 Triples 列表并使用给定的属性函数，例如triple.getSubject() 等。

# c++ - .obj 中已定义的函数

> ID：15203839
> 
> 赞同：10
> 
> 时间：2013-03-04T14:28:44.197
> 
> 标签：c++, object, header, linker, include

据我了解，此错误是由于当您有多个文件（包括同一个文件）时未正确使用标头保护引起的。就我而言，这是导致错误的包含树：

`File A includes Z, which contains the functions I need. File B includes A, and file C includes A.`

没有任何`#pragma once`'s，程序给出了相同错误的一堆变体：

```
blahblah.obj: error LNK2005: class some::namespace::ObjectType Object already 
    defined in dialogDlg.obj 
```

我只是想知道，鉴于我描述的包含树，正确编译它的正确方法是什么？

我尝试`#pragma once`在文件 Z 上使用，但没有奏效。我还在文件 A 上尝试过 #pragma 一次，但也没有用。最后我在A和Z上都试过了，也没有用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-04T14:31:30.013

您似乎正在尝试在头文件中*定义*一个变量。如果该头文件包含在多个源文件中，它将在每个源文件中定义，从而给您错误。

而是将其*声明*为`extern`，然后在您的源文件之一中定义。

所以在头文件中：

```
extern ObjectType Object; 
```

在源文件中：

```
ObjectType Object; 
```

# ubuntu - Heroku 问题 - 卸载/重新安装 heroku toolbelt ubuntu

> ID：15203840
> 
> 赞同：3
> 
> 时间：2013-03-04T14:28:46.220
> 
> 标签：ubuntu, heroku, heroku-toolbelt

我在 Amazon Web Services 上运行一个 Ubuntu 实例，用于开发 Ruby on Rails 应用程序（用于测试运行本地 Rails 服务器），并将应用程序推送到 Heroku 进行部署。

直到昨天，当我想将我的开发数据库的内容推送到生产环境而不仅仅是应用程序本身时，这个设置对我来说一直没有问题。经过一些快速的谷歌搜索，这似乎很容易通过使用`Taps`. 我不确定 Taps 是否预装了 Heroku Toolbelt（这是我一直在使用的），所以在遵循 Heroku 上的文档之后，我只运行了命令`rake db:push`- 这返回了错误：

```
Taps Load Error: cannot load such file -- taps/operation
You may need to install or update the taps gem to use db commands.
On most systems this will be:

sudo gem install taps 
```

很容易，对吧？错误的。运行后`sudo gem install taps`（并观看安装运行没有任何问题），我重新运行命令`rake db:push`只是发现自己面临相同的`Taps Load Error`. 考虑到 Heroku 服务之前运行的轻松程度，这有点令人惊讶，事情一开始就没有顺利进行。

经过一番谷歌搜索后，我发现了两年前在 Heroku 的 github 页面上打开的一个问题，该页面直到最近 3 个月前才收到处理此问题的人的帖子，所以在阅读了一些推荐后，我决定尝试直接安装 heroku gem（即使它已被弃用，完全被 Toolbelt 取代），因为人们似乎得到了正确的结果。

我很犹豫，因为我不想让工具带和独立的 gem 相互竞争，所以我用谷歌搜索了如何卸载 heroku 工具带（这似乎没有一个好的 heroku 提供的解决方案 - 可能会打开一张票在heroku ...）上，但我按照此[链接](http://johntwang.com/blog/2011/09/13/remove-heroku-toolkit/)上的说明进行操作，有人应该为此打我，因为它只是以下命令：

```
rm -rf /usr/local/heroku
rm -rf /usr/bin/heroku 
```

而且这些命令不考虑依赖关系等......我认为这部分（如果不是完全）是我问题的根源。此时，我运行了命令`sudo gem install heroku`，得到了弃用警告，然后只是尝试运行命令`heroku login`作为试金石测试，看看它是否安装正确，但我收到一个野兽`Gem:LoadError`说

```
Could not find heroku (>= 0) amongst [... a bunch of gems ...] 
```

所以，我决定我只是尝试回到开始而不担心事情，所以我卸载了简单的 heroku gem `sudo gem uninstall heroku`，删除了相关的可执行文件，然后尝试按照上列出的命令重新安装 Toolbelt赫罗库：

```
wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh 
```

在将一堆看起来很积极的输出打印到屏幕上之后，我认为一切都会好起来的，但是安装过程的最后一条消息是：

```
heroku-toolbelt is already the newest version.
0 upgraded, 0 newly installed, 0 to remove and 102 not upgraded. 
```

这就是我所在的位置，我已经通过[链接](http://johntwang.com/blog/2011/09/13/remove-heroku-toolkit/)删除了明显重要的内容（请再打我一次），现在安装工具带并没有注意到它们丢失了，我在没有 heroku 的情况下被困住了或水龙头！（此外，令人不安的是，heroku 没有提供一种干净的方式来卸载工具带——这会使这样的事情变得不那么复杂）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-04T20:38:46.253

呃——想通了。检查下载的 shell 脚本后，我看到它最终运行了命令

```
sudo apt-get install heroku-toolbelt 
```

所以我最终不得不通过运行 apt-get 删除 heroku 和 heroku-toolbelt 包

```
sudo apt-get --purge remove heroku
sudo apt-get --purge remove heroku-toolbelt 
```

然后重新安装工具带

```
wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh 
```

现在一切似乎又恢复了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-15T12:44:24.690

我只想补充一点，如果您有 heroku-accounts 插件，您还需要检查**~/.gitconfig**文件中是否存在旧帐户条目并删除它们。否则工具带和帐户插件的全新安装将导致完全无法工作的环境。

# c# - 登录失败：未知用户名或密码错误。使用 C# 的 FTP

> ID：15203841
> 
> 赞同：0
> 
> 时间：2013-03-04T14:28:46.913
> 
> 标签：c#, ftp

我正在尝试访问我们网络外部的 FTP 服务器以获取 CSV 文件。这是我正在使用的代码

```
string XMLPATH = @"\\server\file.csv";
FileWebRequest request = (FileWebRequest)FileWebRequest.Create(XMLPATH);
request.Credentials = new NetworkCredential("admin", "password");
FileWebResponse response = request.GetResponse() as FileWebResponse;
Stream stReader = response.GetResponseStream(); 
```

当我通过我的控制台应用程序运行它时，我收到了这条消息。

```
Logon failure: unknown user name or bad password 
```

如果我去服务器位置在 Windows 资源管理器中获取文件，我可以正常登录并检索文件。之后，我的应用程序可以正常访问该文件。我读了这个以前的堆栈线程

[登录失败：未知用户名或密码错误？但我使用了正确的用户名和密码](https://stackoverflow.com/questions/10242990/logon-failure-unknown-user-name-or-bad-password-but-i-am-using-the-right-usern)

我将此添加到我的配置中

```
<system.net>
 <defaultProxy useDefaultCredentials="false">
  <proxy usesystemdefault="True"/>
 </defaultProxy>
</system.net> 
```

这没有任何改变。我也尝试将我的域添加到凭据构造函数中，但这也不能解决任何问题。此连接需要作为客户端应用程序完成，因此上一篇文章与我的有点不同。任何帮助将不胜感激。谢谢

**编辑**

因为我很好奇，我对 Windows 资源管理器和我的应用程序请求的调用运行了 Wireshark 跟踪。使用资源管理器时，它使用正确的凭据发送请求。但是，当我使用该应用程序时，它会将请求作为我机器的登录名（也就是我的用户 ID）发送。为什么当我在请求中发送请求凭据时，它仍然默认为登录用户？我必须为此配置一个设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:33:25.877

我怀疑您需要指定域（或计算机名）：

```
new NetworkCredential("admin", "password", domainOrComputerName) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:58:45.543

我能够通过在将运行该应用程序的服务器上创建一个本地用户来解决此问题。该用户的设置方式与对 FTP 服务器具有读取权限的用户完全相同

# matlab - 使用 Matlab 提取 ISE 网站的数据

> ID：15203843
> 
> 赞同：1
> 
> 时间：2013-03-04T14:28:49.190
> 
> 标签：matlab, finance

我正在尝试从爱尔兰证券交易所网站提取股票价格。使用该函数的行出现错误`datenum()`。

```
function get_ise_data(equity_name,equity,start_date,end_date)

% Example:
%   get_ise_data('CandC',22076,'01-Jan-2010','10-Jan-2010')
% Note:

% This program reads data from the ISE website. It creates a vector of
% trading days, and then requests data for each specific day from the
% website

% Specify the equity name and reference number, start and end dates as in
% the example above.

% C&C corresponds to the reference number 22076 and you can check this on ise.ie. Kerry 
% Group and BOI have similar reference numbers.
% The data is saved to a file called "[stock]data.mat". The first
% column is the date in serial number format. You can convert to string
% format using "datestr()" The graph produced is not automatically saved.
% The data is also saved to an excel file by the same name. When viewing in
% Excel we need to change the format of the first column to 'custom'
% and specify format as "hh:mm dd/mm/yy".
% Close the excel file before running the program.

% Convert start and end dates to serial format:
start_date = datenum(start_date, 'dd­-mmm­-yyyy');
end_date = datenum(end_date, 'dd­-mmm-­yyyy');

clear final_data

% Work out relevant trading days:

bdates = busdays(start_date, end_date, 'daily');

% The above assumes the same trading days as NYSE - need to modify this for the ISE. See the
% documentation of "busday" to change the default holidays.

itterations=length(bdates);
count=0;

% Loop over each trading day:

for i=1:itterations
    [year,month,date]=datevec(bdates(i));
    str1='http://www.ise.ie/Prices,-Indices-Stats/Equity­Market-Data/EquityDetails/?equity=';
    str2=sprintf('%d&start_day=%d&start_month=%d&start_year=%d',equity,date,month,year);
    url=sprintf('%s%s',str1,str2);
    raw=urlread(url); % Read in html code from website
    exp='<tr?\w+.*?>([\d]+:[\d]+)</\w+.*?>([%\­\d/:A-­Z\.]+)</\w+.*?>([%\­\d/:A­Z\.]+)</\w+.*?>([%\-\d/:A-Z\.]+)</\w+.*?>([%\-\d/:A­Z\.]+).*?/tr>';
    % The following extracts the parts of the html code that match the
    % format specified by 'exp':
    data = regexp(raw,exp,'tokens','freespacing');
    number_of_quotes=length(data);

    % Print out current day:
    sprintf('Now reading: date: %d, month: %d',date,month)
    % A number of quotes are given each day. Loop through these:

    for j=1:number_of_quotes
% Determine the serial date number of each quote:
time=data{1,j}(1,1);

hour=regexp(time{1,1},'([\d]+):[\d]+','tokens');
minute=regexp(time{1,1},'[\d]+:([\d]+)','tokens');
hour = str2double(cell2mat(hour{1,1}));
minute = str2double(cell2mat(minute{1,1}));
second=0;
time_serial _number=datenum(year,month,date,hour,minute,second);
price=str2double(cell2mat(data{1,j}(1,3)));
% Save the price and date number to temporary file, while ignoring
% missing data:
if ~isnan(price)
count=count+1;
final_data(count,1)=time_serial_number;
final_data(count,2)=price;
end
end % End of inter-­?day loop
end % End of daily loop
str=sprintf('% s_data',equity_name);
% Save data to hard disk:
save(str,'final_data');
xlswrite(str,final_data)
end 
```

我得到的错误是

```
??? Error using ==> datenum at 182
DATENUM failed.

Error in ==> get_ise_data at 25
start_date = datenum(start_date, 'dd­-mmm-­yyyy');

Caused by:
    Error using ==> dtstr2dtnummx
    Failed on converting date string to date number. 
```

有人有什么主意吗？我想我已经在评论中解释了一切。

露丝

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T13:07:26.620

该错误是由于您的日期字符串不符合此处指定的格式（因此错误消息说明这一点）：

```
start_date = datenum(start_date, 'dd­-mmm­-yyyy'); 
```

检查网站返回的日期字符串格式是否正确。在欧洲国家，通常以以下格式返回财务日期：DD/MM/YY 或 DD/MM/YYYY

在报告错误的行设置断点并检查传递给 datenum 的数据。

# git - 如何使用 LibGit2(Sharp) 为 Git 存储库构建版本树

> ID：15203844
> 
> 赞同：3
> 
> 时间：2013-03-04T14:28:49.563
> 
> 标签：git, graph-visualization, libgit2, libgit2sharp

一些背景：

我正在研究使用 Git 作为数据存储层的可能性。基本上我需要保留一些描述应用程序状态的 XML 文件的所有版本。用户需要一个“时间机器”才能恢复到以前的状态，以及分支以前的状态等。这将隐藏在服务层后面，但我正在考虑在后端使用 Git。

我需要展示应用程序状态随时间的演变，所以我想构建一个网络图来显示变化、分支等。

为此，我需要直观地构建版本树。基本上，我想这样做：

```
git log --oneline --graph --decorate --all 
```

我正在使用 LibGit2Sharp。我已经浏览了 API，但没有立即看到任何有用的东西。我对 Git 也很了解，但这并没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T13:50:46.127

使用 LibGit2Sharp，您可以`git log`仅通过枚举`Commits`. 您还可以过滤提交列表，或指定一些排序选项（例如让列表按拓扑顺序排序）。[更多信息](https://github.com/libgit2/libgit2sharp/wiki/git-log)可以在与`git log`.

使用像[QuickGraph](http://quickgraph.codeplex.com/)这样的图形库（但还有其他的，可以在 this other [SO question](https://stackoverflow.com/q/1578493)中找到），您可以像这样构建图形：

```
var graph = new AdjacencyGraph<Commit, Edge<Commit>>();

using (var repo = new Repository(path_to_your_repo))
{
    foreach (var c in repo.Commits.Take(20))
    {
        graph.AddVerticesAndEdgeRange(c.Parents.Select(p => new Edge<Commit>(c, p)));
    }
} 
```

然后，您可以将此图输出为多种可视化格式（graphML、Glee、graphviz）。以 graphviz (.dot) 格式输出：

```
var graphviz = new GraphvizAlgorithm<Commit,Edge<Commit>>(graph);
graphviz.FormatVertex +=
    (o, e) =>
        {
            e.VertexFormatter.Label = string.Format("{0} {1}", e.Vertex.Id.ToString(7),
                                                    e.Vertex.MessageShort.Replace("\"", "\\\""));
        };

graphviz.Generate(new FileDotEngine(), @"d:\graph"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T13:31:27.327

`libgit2`是关于底层 Git 概念的。如果要显示图表，则需要查看提交以及它们之间的关系。然后，您可以使用您喜欢的任何图形库绘制图形。

如果您想要的是该命令的输出，那么运行该命令是最简单的方法。

# haskell - 使用 Haskell FFI 调用由指向该函数的 C 指针引用的 C 函数

> ID：15203847
> 
> 赞同：1
> 
> 时间：2013-03-04T14:28:59.893
> 
> 标签：haskell, ffi

“C”wiringPi 库中有一个函数类型，

```
extern void (*pinMode) (int pin, int mode) ; 
```

我尝试使用带有 FunPtr 的 FFI 从 haskell 调用它。所以我做了，

```
foreign import ccall unsafe "wiringPi.h &pinMode" c_pinMode 
        :: FunPtr (CInt -> CInt -> IO ())
foreign import ccall "dynamic" dc_pinMode 
        :: FunPtr (CInt -> CInt -> IO ()) -> (CInt -> CInt -> IO ()) 
```

但由于某种原因，即使它编译，它似乎也没有调用 'pinMode' 指向的函数。

所以我尝试使用普通的 Foreign.Ptr，我想我可能能够偷看 Ptr 以获取对“pinMode”指向的底层“C”函数的引用。所以我尝试了，

```
foreign import ccall "wiringPi.h &pinMode" c_pinMode
    :: Ptr (Ptr (CInt -> CInt -> IO ())) 
```

然后，在调用'pinMode'的haskell函数的实现中，我使用了两次peek来获取对底层函数的引用。但是我不断收到编译错误，编译器告诉我类型的函数`(CInt -> CInt -> IO ())`不是“可存储”类型类的实例。

所以我检查了可存储类型类，以创建可存储类型类`(CInt -> CInt -> IO ())`的实例。所需的最低实现是 peek、poke 和其他一些函数。我意识到，调用一个函数真的不应该那么难由指针引用..

我觉得我错过了一些基本的东西。有人可以指出我正确的方向吗？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T08:30:35.820

假设我们在 foo.c 中定义了一个 C 函数指针。

```
void foo(int x, int y)
{
    printf("foo: sum = %d\n", x+y);
}

typedef void (*FooPtr) (int, int);
FooPtr fooptr = foo; 
```

为了调用`fooptr`指向的函数，我们不仅需要声明静态地址导入，还需要声明动态导入。动态存根可以帮助我们将`FunPtr`值转换为相应的 Haskell 函数。

```
type Foo = CInt -> CInt -> IO ()

foreign import ccall "foo.c &fooptr" fooptr :: Ptr (FunPtr Foo)
foreign import ccall "dynamic" mkFooFun :: FunPtr Foo -> Foo

main = do
    funcptr <- peek fooptr
    mkFooFun funcptr 1 2 
```

`fooptr`是一个指向外部函数的导入地址。它的类型既不是`Ptr (Ptr a)`也不是`FunPtr a`。

如果我们 import`foo`的地址，它的类型将是`FunPtr Foo`。为了使用它，我们仍然需要来自`mkFooFun`.

```
foreign import ccall "foo.c &foo" fooptr2 :: FunPtr Foo
main = mkFooFun fooptr2 1 2 
```

在这个例子中，由于我们可以访问`foo`，最简单的调用方式`foo`是

```
foreign import ccall "foo.c foo" foo :: Foo
main = foo 1 2 
```

# dart - Dart Web Sockets 中是否支持心跳、超时或断开连接？

> ID：15203850
> 
> 赞同：1
> 
> 时间：2013-03-04T14:29:04.480
> 
> 标签：dart, dart-html

在 Dart 中使用 Web Sockets 时，是否有任何心跳、超时或断开连接的支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:45:52.393

您可以在短暂超时后手动重新建立与客户端服务器的连接，如下所示：

```
 establishConnection() {
    connection = new WebSocket('ws://...');

    // Upon connection close, wait a while and try to re-connect.
    connection.onClose.listen((e) => new Timer(5000, (t) => establishConnection()));

    connection.onOpen.listen((_) => print('Connection to the server opened.'));
  } 
```

我不认为服务器可以做到这一点......因为浏览器是打开连接的，而 Chrome 和 Firefox 等 Web 浏览器不支持心跳。

# ios - UICollectionView 滚动不顺畅

> ID：15203852
> 
> 赞同：2
> 
> 时间：2013-03-04T14:29:07.967
> 
> 标签：ios, uicollectionview

我`UICollectionView`在我的应用程序中使用来显示图像。它的工作，但滚动不流畅的问题。我已经`UITableView`为另一个应用程序（iOS 6 以下）使用多个 ImageViews 创建了 GridView。没有这个问题滚动工作非常顺利。为什么会发生这种情况`UICollectionView`？？

```
- (PSUICollectionViewCell *)collectionView:(PSUICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{

RSCollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:CELL_ID forIndexPath:indexPath];

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
dispatch_async(queue, ^{
    UIImage *image = [UIImage imageNamed:[_images objectAtIndex:indexPath.item]];
    dispatch_sync(dispatch_get_main_queue(), ^{
        cell.imageView.image = image;
    });
});

return cell;
} 
```

# c# - C# Windows 应用程序中的 PayPal API

> ID：15203863
> 
> 赞同：0
> 
> 时间：2013-03-04T14:30:11.987
> 
> 标签：c#, wpf, winforms, paypal

我在 C# 中实现 Windows 窗体应用程序，它使用 Paypal API 从 Paypal 获取交易详细信息。我在我实施 Windows 服务的每个时间间隔都得到它，它成功地从 Paypal 获取交易详细信息并更新本地数据库。有什么方法可以让我只获得新的交易细节而不是获得所有交易？我知道我们可以在按事务编号插入时在数据库中应用过滤器，并通过开始和结束日期检索事务，但每次检索大事务我认为不是一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:26:15.150

在将请求发送到 PayPal 之前，是否有任何原因无法更新数据库？我看到的典型过程是：

*   在数据库中记录表单数据。
*   向 PayPal 提交请求
*   根据 PayPal 的批准或拒绝更新记录

这样，所有付款都将实时更新，无需在特定时间范围内获取所有交易详细信息。

# javascript - YUI JSON - 如何在解析过程中添加新的对象成员？

> ID：15203864
> 
> 赞同：1
> 
> 时间：2013-03-04T14:30:13.287
> 
> 标签：javascript, html, yui, json.net

近两天来，我一直在尝试获取 YUI JSON 实用程序：在解析期间添加新对象成员以毫无乐趣地工作。

这对我来说很难，因为我是编码新手。在尝试将不同的 JS 文件、引用和脚本放入项目后，我使用了 Configurator 脚本。

我尝试在 Explorer 和 Firefox 中运行代码；但是，结果表将不会显示。

代码运行是因为页面显示错误消息：“Error Getting Inventory Data”，这是页面代码中的 try/catch 错误消息。

文本编辑器错误控制台中的错误消息是否与未显示的数据有关？

文本编辑器错误控制台显示错误（第 76 行，第 12 列） - 未知属性：错误控制台中的单元格间距

* * *

Mozilla Firefox 错误控制台也显示错误：

```
 Error: ReferenceError: YUI is not defined
    Source File: http://localhost:53753/currency.html 
    Line: 87 
```

Firefox 识别的第 87 行代码行是：

```
<tr><td colspan="4">Click <em>Get Data</em></td></tr> 
```

* * *

YUI 库中的示例代码位于：http: [//developer.yahoo.com/yui/examples/json/json_convert_values.html](http://developer.yahoo.com/yui/examples/json/json_convert_values.html)

这是我的完整代码：

```
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
        <title>Example: Adding New Object Members During Parsing</title>

    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic">
    <link rel="stylesheet" href="css/grids-min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/prettify-min.css">
    <link rel="shortcut icon" type="image/png" href="images/favicon.png">

</head>

<body> 
<!--
<a href="https://github.com/yui/yui3"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
-->

    <div id="doc">
        <div id="hd">

        <h1><img src="http://yuilibrary.com/img/yui-logo.png"></h1>

    </div>
        </div>
    <div id="demo">
        <p>Choose a currency, then get the data</p>

        <select>
        <option value="ARS">Argentine Peso</option>
        <option value="AUD">Australian Dollar</option>
        <option value="BRL">Brazilian Real</option>
        <option value="GBP">British Pound</option>
        <option value="CAD">Canadian Dollar</option>
        <option value="CNY">Chinese Yuan</option>
        <option value="COP">Colombian Peso</option>
        <option value="HRK">Croatian Kuna</option>
        <option value="CZK">Czech Koruna</option>
        <option value="DKK">Danish Krone</option>
        <option value="EEK">Estonian Kroon</option>
        <option value="EUR">Euro</option>
        <option value="HKD">Hong Kong Dollar</option>
        <option value="HUF">Hungarian Forint</option>
        <option value="ISK">Iceland Krona</option>
        <option value="INR">Indian Rupee</option>
        <option value="JPY">Japanese Yen</option>
        <option value="KRW">Korean Won</option>
        <option value="LVL">Latvian Lat</option>
        <option value="LTL">Lithuanian Lita</option>
        <option value="MYR">Malaysian Ringgit</option>
        <option value="MXN">Mexican Peso</option>
        <option value="NZD">New Zealand Dollar</option>
        <option value="NOK">Norwegian Krone</option>
        <option value="PHP">Philippine Peso</option>
        <option value="PLN">Polish Zloty</option>
        <option value="RUB">Russian Rouble</option>
        <option value="SGD">Singapore Dollar</option>
        <option value="SKK">Slovak Koruna</option>
        <option value="ZAR">South African Rand</option>
        <option value="LKR">Sri Lanka Rupee</option>
        <option value="SEK">Swedish Krona</option>
        <option value="TRY">Turkey Lira</option>
        <option value="USD" selected="selected">U.S. Dollar</option>
        <option value="CHF">Swiss Franc</option>
        <option value="TWD">Taiwan Dollar</option>
        <option value="THB">Thai Baht</option>
    </select>

        <input type="button" id="demo_go" value="Get Data">

    <table cellspacing="0">
        <caption>Inventory</caption>
            <thead>
        <tr>
            <th>SKU</th>
            <th>Item</th>
            <th>Price (USD)</th>
            <th>Price (<span>USD</span>)</th>
        </tr>
            </thead>
    <tbody>
        <tr><td colspan="4">Click <em>Get Data</em></td></tr>
     </tbody>
   </table>
 </div>

<!-- JS -->
<script type="text/javascript" src="http://yui.yahooapis.com/combo?3.8.1/build/yui-base/yui-base-min.js&3.8.1/build/json-parse/json-parse-min.js&3.8.1/build/json-stringify/json-stringify-min.js"></script>

<script>
    YUI().use("node", "io", "json-parse",function (Y) {

// Safari 4.0.3's native JSON does not support adding members during parse,
// so use JavaScript implementation for consistency
    Y.JSON.useNativeParse = false;

var example = {
    rates : {"USD":1,"EUR":0.6661,"GBP":0.5207,"AUD":1.1225,"BRL":1.609,"NZD":1.4198,"CAD":1.0667,"CHF":1.0792,"CNY":6.8587 ,"DKK":4.9702,"HKD":7.8064,"INR":42.0168,"JPY":109.8901,"KRW":1000,"LKR":107.5269,"MXN":10.1317,"MYR" :3.3167,"NOK":5.3277,"SEK":6.2617,"SGD":1.4073,"THB":33.7838,"TWD":31.1526,"VEF":2.1445,"ZAR":7.6923 ,"BGN":1.3028,"CZK":16.0514,"EEK":10.4275,"HUF":158.7302,"LTL":2.2999,"LVL":0.4692,"PLN":2.1758,"RON" :2.3804,"SKK":20.2429,"ISK":4.8008,"HRK":81.3008,"RUB":24.3309,"TRY":1.1811,"PHP":44.2478,"COP":2000 ,"ARS":3.1289},

    currency : 'USD',

    convert : function (k,v) {
        // 'this' will refer to the object containing the key:value pair,
        // so this step will add a new object member while leaving the original
        // intact (but formatted to two decimal places).  If the original
        // is not needed, just return the converted value.

        if (k === 'Price') {
            var x = Math.round(v * example.rates[example.currency] * 100) / 100;
                this.convertedPrice = x.toFixed(2); // added to item
                    return v.toFixed(2); // assigned to item.Price
        }
        return v;
    },

    updateTable : function (inventory) {
        // Update the column header
        Y.one('#demo table th span').set('innerHTML',example.currency);

        var tbody = Y.one('#demo table tbody'),
            html  = ['<table><tbody>'],
            rowTemplate = '<tr><td>{SKU}</td><td>{Item}</td><td>{Price}</td><td>{convertedPrice}</td></tr>',
            i, len;

        if (inventory) {
            for (i = 0, len = inventory.length; i < len; ++i) {
                html.push(Y.Lang.sub(rowTemplate, inventory[i]));
            }
        } else {
            html.push('<tr><td colspan="4">No Inventory data</td></tr>');
        }

        html.push('</tbody></table>');

        tbody.replace(Y.Node.create(html.join('')).one('tbody'));
    }
};

Y.one('#demo_go').on('click', function (e) {
    // Disable the button temporarily
    this.set('disabled',true);

    // Store the requested currency
    var sel = Y.one("#demo select");
    example.currency = sel.get("options").item(sel.get("selectedIndex")).get("value");

    Y.io('js/json-convert-values-response.json',{
        timeout : 3000,
        on : {
            success : function (xid, res) {
                var inventory;
                try {
                    inventory = Y.JSON.parse(res.responseText,example.convert);

                    example.updateTable(inventory);
                }
                catch(e) {
                    alert("Error getting inventory data");
                }
                finally {
                    Y.one('#demo_go').set('disabled',false);
                }
            },
            failure : function () {
                alert("Error getting inventory data");
            }
        }
    });
});

// Expose example objects for inspection
YUI.example = example;
});
</script>
    </body>
        </html> 
```

**更新 - 显然这些 JSON 示例不适用于 jsfiddle，因为它们使用 XHR 来获取 JSON 数据。该数据在他们的服务器上不存在，因此它将归档。所以请忽略小提琴**

这是我的问题的 JS Fiddle，有人可以帮我解决这个问题吗？

在解析期间添加新对象成员：http: [//jsfiddle.net/DanyB/3ntvw/](http://jsfiddle.net/DanyB/3ntvw/)

谢谢，有好心人看看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:05:05.273

昨天早上，我终于设法让这个 JSON 脚本工作了；但是，这是通过解决问题。也就是说，我确信我终于也找到了根本原因——我只是无法纠正它。

下面我记录了我是如何让代码运行的，最后是我研究过的领域的列表。对于那些等不及的人，我只是将我的 JSON 文件名更改为 .JS 并将我的文件路径也更改为 .JS。

* * *

我的研究非常广泛，如果记录在案，可能会对面临相同或类似情况的其他人有所帮助。我也详细说明了我的方法；尽管该方法对大多数人来说是常识，但它可能会帮助某人找到问题的根源。

顺便说一句：感谢 YUI 论坛的 Juan 用他的话提供了“第二双眼睛”，它预先确认问题与 JSON 文件未正确加载有关。他也给了我一些他的时间——感激。

通过在 Firefox 中运行该页面，我能够使用错误控制台。这仅在一开始有帮助，因为在我删除了除与示例特别相关的代码之外的任何多余代码之后，即使站点脚本不起作用，Firefox 控制台也没有给出任何错误？

然而，Firefox 错误控制台在早期确实给出了两个明显的错误：一个与服务器未响应调用有关，另一个概述了再次指向服务器 (IIS 7.0) 的 JSON MIME 类型问题。

然后我更改了脚本中的 try/catch 错误消息，使它们都不同。然后我能够根据显示的警报看到应用程序在脚本中的哪个位置失败。

在达到这一点之前，我在谷歌上搜索答案有点偏题——这很容易做到。不过，有条不紊地处理我面前的事情使我能够更直接地专注于具体问题。

我知道我遇到了 JSON 文件无法运行的问题；我还知道服务器没有响应并且服务器没有识别 MIME 类型。因此，如果我在服务器上对 MIME 类型问题进行排序，服务器似乎很可能会识别并运行 JSON 文件。

为了添加一个新的 JSON MIME 类型，我访问了 Microsoft IIS 知识库的以下链接，并阅读了有关如何设置 IIS 7.0 来管理 JSON 文件的说明——确保在我的 IIS 管理器中没有将足够多的 JSON 文件列为已知文件类型.

新 MIME 类型 = JSON 文件扩展名 - .json MIME 类型描述 = application/json

[http://technet.microsoft.com/en-us/library/cc725608%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/cc725608%28v=ws.10%29.aspx)

由于该网站仍然无法正常工作，我看起来更深入。更多研究告诉我，我需要为我的新 JSON MIME 类型配置一个处理程序映射。我再次使用了 Microsoft IIS 站点：（由于信誉点不足，链接被删除）

在某些情况下，您可能需要更改 web.config，所以这是另一个 MS 链接：

（由于信誉点不足，链接被删除）

我又遇到了麻烦，因为 C/Windows/system32/inetsrv/asp.dll 中的 ASP.DLL 丢失了。

为了克服这个问题，我从系统的其他地方找到了另一个副本，并将该文件复制到 inetsrv 文件夹中。该站点仍然无法运行，因此我继续发现系统上应该至少有一个 32 位 asp.dll 文件和一个 64 位 asp.dll 文件。我认为我已将不正确的位 asp.dll 复制到 inetsrv 文件夹中，但我无法确定哪个是哪个；所以，这就是我要去的地方。

然后，当我遇到一个名叫 Colanth 的人在 yahoo 上的回答时，我回到了基础，试图了解更多关于打开 JSON 文件的信息，他说“JSON 是一种技术，而不是一种格式”。

更多地考虑这个陈述，我发现了另一个 JSON 教程，它只专注于在这里创建一个简单的 JSON 调用函数：

（由于信誉点不足，链接被删除）

请注意，本教程还概述了我继续阅读的“JSON 是一种技术”。该教程详细说明了 JSON 是 JavaScript。

然后，我想到如果 JSON 不是格式，而是 JavaScript，我应该将我的 JSON 文件的文件名更改为 .js，然后将我的 JSON 文件路径更改为 .js，因为我的系统可以识别 JavaScript 以查看会发生什么。

所以我做到了，Blam！（引用赏金猎人狗）一切正常！

当然，我需要对 MIME 类型和缺少的 asp.dll 问题进行排序。我认为 asp.dll 可能丢失了，因为我为 VS2012 卸载了 Visual Studio 2010，并且删除 VS2010 可能已经删除了 asp.dll 文件。我知道 VS2012 是基于已安装的 VS2010 版本构建的，因此 VS2012 可能预计 asp.dll 已经安装。说如果是这种情况VS2010不应该删除它；谁知道？

此外，JSON 文件是 JSON 文件是有原因的，所以我需要深入了解该问题。但是，经过大量的努力，我现在有一个工作要做。

以下是我检查的其他一些内容，它们也可能会给您一些想法：

URL'S，文件路径和文件名

本地主机——站点和响应文件在哪个端口上运行

使用验证器获取想法的 JSON 脚本：http: [//jsonlint.com/](http://jsonlint.com/)

检查他的代码是否有错误和拼写错误

尝试在 2.0 和 4.0 模式下运行 IIS

检查 JSON 的 web.config 脚本

尝试在 html、aspx、cshtml 和 php 网站中运行代码

尝试将 JSON 文件移动到不同的位置；检查 JSON 文件路径

使用配置器尝试了本地和外部的不同 YUI 配置

查看了不同的浏览器安全设置

更改 Firefox about:config: 为 security.fileuri.strict_origin_policy

增加代码中的超时设置

检查你的系统处理 JSON MIME 类型

IIS 的版本是否正确 5.0、6.0、7.0、7.5 等

检查服务器 WCF 设置

更改代码

更改全局设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:43:37.843

As Bergi says in the comments above, it looks like the script did not load or execute early enough.

**ONE POSSIBLE SOLUTION...**

To make sure it is, you should declare the YUI script tag in the head of your HTML. Try that first to see if it solves your problem. However...

...

**WAITING UNTIL READY**

You should put your other code in the head too, but specify it so that it only loads when the whole document has loaded.

The simplest way to do this would be:

```
window.onload = function () { // what to do when window has loaded
    YUI().use("node", "io", "json-parse",function (Y) {

    // ... the code in your callback function, as provided above ...

    }); // end callback -- UPDATED
}; // end window onload function 
```

YUI has its own way of handling code that should when the document is ready...

```
YAHOO.util.Event.onDOMReady 
```

But as your problem is with `YUI` not being defined, I'm not sure this will help.

...

**CHECKS AND SAFEGUARDS PATTERN?**

A more sophisticated pattern could involve setting an intermittent check to see if `YUI` is defined and then cancelling the check once it is and executing the code you need. That would use a method called `setInterval()` and look something like this:

```
var checkYUI = setInterval(function() { // create a function to be executed within the interval and assign the interval to a global variable
    if (YUI) { // check the global variable `YUI` exists
        clearInterval(checkYUI); // cancel the interval check
        YUI().use("node", "io", "json-parse",function (Y) { // now we know `YUI` exists call its `use()` method
            // ... the code in your callback function, as provided above ...
        }
    }
}, 100); // checks every 100 ms 
```

You could make the checking more complicated still by, for example, checking that `YUI` is an object, that it has a `use()` method, etc. But hopefully this will suffice to show how it could work.

I'm not sure what you did in your previous trials that made them succeed whilst this one failed but it might be worth studying them to see if such checks/safeguards are already in place.

# xaml - 为 Windows 商店应用程序捕获并保存 XAML/C# 中的照片

> ID：15203866
> 
> 赞同：2
> 
> 时间：2013-03-04T14:30:21.283
> 
> 标签：xaml, windows-8, image-capture

我正在尝试使用 Windows Surface 设备拍摄并保存照片。

我正在使用下面的代码拍摄照片，但我想在设备的本地驱动器上自动创建一个目录，并将这张照片保存在那里，而不需要任何对话框提示。

所以我用来捕捉照片的代码如下：

```
CameraCaptureUI camera = new CameraCaptureUI();

StorageFile file = await camera.CaptureFileAsync(CameraCaptureUIMode.Photo);
if (file!=null)
{
    using (IRandomAccessStream ras=await file.OpenAsync(FileAccessMode.Read))
    {
        BitmapImage source = new BitmapImage();
        source.SetSource(ras);

        imageBuildingPhoto.Source = source; // this is just an image control.
    }
} 
```

所以在此之后我想自动将照片保存到一个新目录。例如

我的图片\新目录\Photo1.jpg

有人知道我该怎么做吗？

这是一个使用 C#4.5 和 XAML 编写的 Windows 商店应用程序。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:24:07.767

对您返回的对象（文件）使用该`CopyAsync`方法。`StorageFile`您可以指定目录和文件名。如果您需要创建自己的目录结构，则需要在 Package Manifest 中启用对相应库的访问，然后在代码中创建它。然后，您将使用`StorageFolder`该类及其`CreateFolderAsync`方法来创建文件夹。

[http://aka.ms/30Days](http://aka.ms/30Days)有一些很好的资源来学习这样的场景。可能值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T21:59:35.030

您的代码将需要查看该文件夹是否存在，如果不存在则创建它。您的应用也需要在应用清单中声明访问用户照片库的能力。

要拍照，您的代码是正确的。如果您想根据其他代码验证它，我有一个演练：http: [//blog.jerrynixon.com/2012/10/walkthrough-capturing-photos-in-your.html](http://blog.jerrynixon.com/2012/10/walkthrough-capturing-photos-in-your.html)

要与文件系统交互，这可能会很棘手，但如果你想引用它，我会写更长的文章：http: [//blog.jerrynixon.com/2012/06/windows-8-how-to-读取文件-in-winrt.html](http://blog.jerrynixon.com/2012/06/windows-8-how-to-read-files-in-winrt.html)

你的问题的答案是，是的，你可以。我已经在自己的应用程序中完成了。现在，这只是你在你的实现它的问题。你会发现这很容易。

# c# - ViewBag、ViewData、TempData、Session - 如何以及何时使用它们？

> ID：15203870
> 
> 赞同：16
> 
> 时间：2013-03-04T14:30:37.473
> 
> 标签：c#, asp.net-mvc, visual-studio-2010

ViewData 和 ViewBag 允许您访问从控制器传递的视图中的任何数据。

这两者之间的主要区别在于您访问数据的方式。在 ViewBag 中，您使用字符串作为键来访问数据 - ViewBag[“numbers”] 在 ViewData 中，您正在使用属性 - ViewData.numbers 来访问数据。

**查看数据**示例

控制器

```
 var Numbers = new List<int> { 1, 2, 3 };

          ViewData["numbers"] = Numbers; 
```

看法

```
<ul>
 @foreach (var number in (List<int>)ViewData["numbers"])
 {
     <li>@number</li> 
 }

 </ul> 
```

**ViewBag**示例

控制器

```
 var Numbers = new List<int> { 1, 2, 3 };

         ViewBag.numbers = Numbers; 
```

看法

```
<ul>

@foreach (var number in ViewBag.numbers)

{
<li>@number</li> 
}

</ul> 
```

**Session**是另一个非常有用的对象，它可以保存任何信息。

例如，当用户登录系统时，您希望保留他的授权级别。

```
// GetUserAuthorizationLevel - some method that returns int value for user authorization level.

Session["AuthorizationLevel"] = GetUserAuthorizationLevel(userID); 
```

只要用户会话处于活动状态，此信息就会存储在 Session 中。这可以在 Web.config 文件中更改：

```
<system.web>
    <sessionState mode="InProc" timeout="30"/> 
```

那么在控制器里面的动作：

```
 public ActionResult LevelAccess()
     {
         if (Session["AuthorizationLevel"].Equals(1))
         {
             return View("Level1");
         }

        if (Session["AuthorizationLevel"].Equals(2))
        {
            return View("Level2");
        }

        return View("AccessDenied");
    } 
```

**TempData 与 ViewData 和ViewBag**非常相似，但是它只包含一个请求的数据。

控制器

// 您创建了一个添加新客户端的方法。

```
TempData["ClientAdded"] = "Client has been added"; 
```

看法

```
@if (TempData["ClientAdded"] != null)
{ 
   <h3>@TempData["ClientAdded"] </h3>
} 
```

当您想将一些信息从 View 传递到 Controller 时，TempData 很有用。例如，您希望在请求查看时保持时间。

看法

```
@{
TempData["DateOfViewWasAccessed"] = DateTime.Now;
} 
```

控制器

```
if (TempData["DateOfViewWasAccessed"] != null)
   {
    DateTime time = DateTime.Parse(TempData["DateOfViewWasAccessed"].ToString()); 
   } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-04T14:41:28.753

> ViewBag、ViewData、TempData、Session - 如何以及何时使用它们？

# 查看包

躲开它。尽可能使用视图模型。

原因是当你使用动态属性时，你不会得到编译错误。偶然或故意更改属性名称非常容易，然后忘记更新所有用法。

如果您使用 ViewModel，您将不会遇到这个问题。视图模型还将调整 MVC 中的“M”（即业务实体）的责任从控制器和视图转移到了 ViewModel，因此您可以获得具有明确职责的更清晰的代码。

**行动**

```
public ActionResult Index()
{
    ViewBag.SomeProperty = "Hello";
    return View();
} 
```

**查看（剃刀语法）**

```
@ViewBag.SomeProperty 
```

# 查看数据

避免它。尽可能使用视图模型。与 ViewBag 相同的原因。

**行动**

```
public ActionResult Index()
{
    ViewData["SomeProperty"] = "Hello";
    return View();
} 
```

**查看（剃刀语法）：**

```
@ViewData["SomeProperty"] 
```

# 温度数据

您存储的所有内容都`TempData`将保留在 tempdata 中，直到您读取它，无论其间是否有一个或多个 HTTP 请求。

**行动**

```
public ActionResult Index()
{
    TempData["SomeName"] = "Hello";
    return RedirectToAction("Details");
}

public ActionResult Details()
{
    var someName = TempData["SomeName"];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T14:35:38.850

> [临时数据](http://rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp.net-mvc-3-applications)

意味着是一个非常短暂的实例，您应该只在当前和后续请求期间使用它！由于 TempData 以这种方式工作，您需要确定下一个请求将是什么，并且重定向到另一个视图是您唯一可以保证这一点的时间。因此，使用 TempData 可靠工作的唯一情况是在重定向时。这是因为重定向会终止当前请求（并将 HTTP 状态代码 302 Object Moved 发送到客户端），然后在服务器上创建一个新请求以提供重定向视图。回顾之前的 HomeController 代码示例意味着 TempData 对象可能会产生与预期不同的结果，因为无法保证下一个请求来源。例如，下一个请求可以来自完全不同的机器和浏览器实例。

> 查看数据

ViewData 是一个字典对象，您可以将数据放入其中，然后视图可以使用该对象。ViewData 是 ViewDataDictionary 类的派生类，因此您可以通过熟悉的“键/值”语法进行访问。

> 查看包

ViewBag 对象是 ViewData 对象的包装器，允许您为 ViewBag 创建动态属性。

```
public class HomeController : Controller
{
    // ViewBag & ViewData sample
    public ActionResult Index()
    {
        var featuredProduct = new Product
        {
            Name = "Special Cupcake Assortment!",
            Description = "Delectable vanilla and chocolate cupcakes",
            CreationDate = DateTime.Today,
            ExpirationDate = DateTime.Today.AddDays(7),
            ImageName = "cupcakes.jpg",
            Price = 5.99M,
            QtyOnHand = 12
        };

        ViewData["FeaturedProduct"] = featuredProduct;
        ViewBag.Product = featuredProduct;
        TempData["FeaturedProduct"] = featuredProduct;  

        return View();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-20T10:02:52.370

```
namespace TempData.Controllers
{
 public class HomeController : Controller
 {
    public ActionResult Index()
    {
        TempData["hello"] = "test"; // still alive
        return RedirectToAction("About");
    }

    public ActionResult About()
    {
        //ViewBag.Message = "Your application description page.";
        var sonename = TempData["hello"]; // still alive (second time)
        return RedirectToAction("Contact");
    }

    public ActionResult Contact()
    {
        var scondtime = TempData["hello"]; // still alive(third time)
        return View();
    }
    public ActionResult afterpagerender()
    {
        var scondtime = TempData["hello"];//now temp data value becomes null

        return View();
    }
} 
```

}

在上面的对话中，每个人都没有什么困惑。如果您查看我上面的代码，tempdata 就像 viewdata 概念，但它也能够重定向其他视图。这是第一点。

第二点：他们中很少有人说它在阅读之前保持价值，而且很少有人会问，所以它会只读时间吗？不是这样。实际上，您可以在页面渲染之前在一个 postpack 中读取代码中的任意时间。一旦页面渲染发生，如果您再次执行 postpack (request) 意味着，tempdata 值将变为 NULL。

即使您请求了这么多时间，但 tempdata 值仍然存在 - >这种情况下您的请求数不应该读取临时数据值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-16T07:20:14.107

简单来说：

ViewBag 是一个动态（动态：不同程序在同一对象上分配多个值的能力）对象，用于将数据从控制器发送到视图。当我们从控制器的动作跳转到某个视图时可以使用它。但是，我们在视图中（在 viewbag 对象中）获得的值不能在其他视图/控制器/js 页面等中进一步复制。含义：控制器-> 视图（可能）。现在这个值不能发送到下一个视图/控制器。意思是Controller->View->View/controller/一些js文件（不可能），要携带这个值，你需要定义一些其他变量并将viewbag值存储到其中，然后将其作为参数发送。

Tempdata 与 viewbag 有很大不同。它与视图完全无关。当我们将数据从一个动作（方法）发送到同一控制器中的另一个动作时使用它。这就是我们在将临时数据值从一个动作发送到另一个动作时使用 RedirectToAction 的原因。从控制器发送到 veiw 时，不会保留 tempdata 的值（因为它不打算这样做）。

ViewData 与 viewbag 类似，但它是一个字典对象。ViewData 可能需要类型转换，而 viewbag 可能不需要。这取决于用户他可能想要使用哪一个。

# javascript - 获取 HTML 列表中项目的位置

> ID：15203872
> 
> 赞同：3
> 
> 时间：2013-03-04T14:30:47.837
> 
> 标签：javascript, jquery

我需要知道一个项目在 HTML 列表中的位置。

```
<ul>
  <li>first</li>
  <li>second</li>
  <li>third</li>
</ul>

$('ul').on("click", function(event){
  var target = event.target;
}) 
```

所以当我得到第一个`li`作为事件的目标时。我怎样才能得到`0`项目位置的结果。我能想到的唯一方法是遍历所有项目并将它们与事件目标进行比较，但我想知道是否有更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:32:25.913

你可以使用：

```
$('ul').on("click", function(event){
  var target = event.target,
      index = $(target).index();
  console.log(target, index);
}) 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/vAnCY/)。

参考：

*   [`index()`](http://api.jquery.com/index/).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:32:27.480

```
var listItem = $(event.target);
alert('Index: ' + $('ul > li').index(listItem)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:36:38.327

```
$('ul li').on("click", function(){
var index = $(this).index();
alert(index);
}) 
```

[http://jsfiddle.net/6QZbT/](http://jsfiddle.net/6QZbT/)

# c# - SQL CE 3.5 - 从另一个表中选择字段

> ID：15203876
> 
> 赞同：0
> 
> 时间：2013-03-04T14:30:56.973
> 
> 标签：c#, visual-studio-2008, .net-3.5, sql-server-ce

我是第一次使用数据库（SQL CE 3.5），我不确定如何定义表之间的关系，以后（我认为）我将不得不使用连接来为一个字段选择一些值另一张桌子。

```
_________       __________    __________
MY TABLE|      | TABLE A |   | TABLE B |
---------      |---------|   |---------|
OrderID |      | a_Text  |   | b_Text  |   
---------      |---------|   |---------| 
a_Text  |
---------
b_Text  |
--------- 
```

当我在 [MY TABLE] 中为 a_Text 定义值时全部实现时，我只想能够为 [Table A] 中定义的 a_Text 设置一个值（并再次为 b_Text 设置）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:33:20.100

你在这里想要的是你的字段上的[外键约束](http://msdn.microsoft.com/en-us/library/ms175464%28v=sql.105%29.aspx)`a_Text`，它强制`MY_TABLE`/`TABLE_A`为那个特定的字段值建立一个链接。

这是一个*数据库*关系，因此应该在数据库级别定义，如果需要，在模型级别定义。大多数现代 ORM 技术，例如 EntityFramework/NHibernate，在表示模型级别的相同关系方面做得很好，或者至少让它变得非常简单——如果你直接通过数据库创建上下文，EF 会自动完成.

通过 VS 设计器使用 SQLCE 创建关系非常简单 -[演练：创建 SQL Server Compact 数据库](http://msdn.microsoft.com/en-gb/library/vstudio/bb546200%28v=vs.90%29.aspx)提供了在两个表之间添加关系的示例。

* * *

根据您的要求，我不建议您将值字段 ( `a_Text`)`TABLE A`作为 PK。最大的担忧之一是，如果您更新需要将该更改级联到其他引用表中的键。[引入代理键](http://en.wikipedia.org/wiki/Surrogate_key)并使您的`a_Text`字段本身成为[唯一键](http://en.wikipedia.org/wiki/Unique_key)更加灵活。

```
 My Table      Table A    Table B
  --------      -------    -------
  OrderID       a_ID       a_ID
  a_ID          a_Text     a_Text
  b_ID 
```

# javascript - 两个图像，如前进/后退按钮

> ID：15203891
> 
> 赞同：0
> 
> 时间：2013-03-04T14:31:27.700
> 
> 标签：javascript, image, html5-canvas

我在画布上有两个图像（向前箭头和向后箭头）。

```
<script>    
var ileri = new Image();
var geri = new Image();
ileri.src= "ileri.png";
geri.src = "geri.png";
var ilerigeri = 0;

GetFeedback = function(a){
context.drawImage(ileri,50,330);
context.drawImage(geri,300,330); 
}

</script> 
```

……

```
<div id="ccontainer">
    <canvas id="myCanvas" width="600" height="400"></canvas>
</div> 
```

如果点击了 ileri.png，我想将“ilerigeri”的值更改为 1。如果点击了geri.png，我想将“ilerigeri”的值更改为2。我可以使用 image.onclick 之类的东西还是需要找到点击点的坐标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:55:31.353

画布元素会自己捕捉点击事件，但你必须自己知道光标下的像素是什么。

请记住，canvas 标签只是一个渲染的地方。本质上，它不是场景图或任何对象结构。

所以至少有2个解决方案：

1.  检测自己单击了哪个按钮。您可以检查光标是否在图像的边界框内。类似的东西：

    if (mousePosition > img.x && mousePosition < (img.x + img.width) && mousePosition>img.y && mousePosition<(img.y+img.height) { // 完成工作 }

2.  使用像[cgSceneGraph](http://gwennaelbuchet.github.com/cgSceneGraph/)这样的框架可以轻松地为您完成工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:13:09.553

```
<div id="ccontainer">
    <canvas id="myCanvas" width="600" height="400" ></canvas>
</div> 
```

JS：

```
var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
var ileri = new Image();
var geri = new Image();
ileri.src = "ileri.png";
geri.src = "geri.png";
ileri.onload = function() {
    context.drawImage(ileri,50,330);
}

geri.onload = function() {
    context.drawImage(geri,300,330);
}

canvas.onclick = function(e) { 
   if(e.pageX >= (this.offsetLeft + 50) && e.pageY >= (this.offsetTop + 330)){
       if(e.pageX <= (this.offsetLeft + 50 + ileri.width) && e.pageY <= (this.offsetTop + 330 + ileri.height)){
          alert('ileri');
       }
   }
   if(e.pageX >= (this.offsetLeft + 300) && e.pageY >= (this.offsetTop + 330)){
       if(e.pageX <= (this.offsetLeft + 300 + geri.width) && e.pageY <= (this.offsetTop + 330 + geri.height)){
          alert('geri');
       }
   }    
   } 
```

这是工作示例， [http://jsfiddle.net/wcxc2/6/](http://jsfiddle.net/wcxc2/6/)

# php - 是否可以将 php.ini 设置为使用多个错误日志？

> ID：15203898
> 
> 赞同：0
> 
> 时间：2013-03-04T14:31:56.430
> 
> 标签：php

我当前的 php.ini 读取：error_log = error_log

很好，它将所有脚本的错误记录到单独的文件中，具体取决于它们所在的文件夹。所以它给出的结果如下：

```
public_html/error_log
public_html/folder1/error_log
public_html/folder2/error_log 
```

但除此之外，是否也可以将其记录到一个通用的 error_log 中？像下面这样？

```
public_html/general_error_log_for_all_folders
public_html/error_log
public_html/folder1/error_log
public_html/folder2/error_log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:44:51.737

```
error_log = /absolute/path/to/error_log 
```

如果您想为某些应用程序设置不同的错误日志，请使用运行时配置，例如 .htaccess

```
php_value error_log = /absolute/path/to/public_html/certain/app/error_log 
```

# android - 在 Android 应用程序中启用 AllShare Cast

> ID：15203900
> 
> 赞同：3
> 
> 时间：2013-03-04T14:32:00.783
> 
> 标签：android, samsung-smart-tv, screensharing

我正在开发一个非常简单的应用程序，其中有一个按钮。单击该按钮，我的手机屏幕应该与我的智能三星电视共享。现在的问题是如何在单击该按钮时启用 AllShare Cast 功能？

根据我的阅读，我应该从一开始就创建一个 AllShare 应用程序（请参阅：http: [//developer.samsung.com/allshare-framework/start](http://developer.samsung.com/allshare-framework/start)）.. 但我想使用普通的 Android 应用程序来实现它。

感谢您的提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T09:45:53.153

我正在使用该`activateManagerUI()`方法来启用 AllShare Cast。

[链接到`activateManagerUI()`javadoc。](http://img-developer.samsung.com/onlinedocs/ASF_API_Reference_1_0/com/sec/android/allshare/screen/ScreenCastManager.html#activateManagerUI%28%29)

我知道这不是您要求的解决方案，但据我所知，如果不要求用户这样做，您就无法启用 AllShare Cast。

# asp.net-mvc - 通过 MVC 清除输出缓存

> ID：15203904
> 
> 赞同：0
> 
> 时间：2013-03-04T14:32:21.070
> 
> 标签：asp.net-mvc

```
[OutputCache(Duration = 3600, VaryByParam = "startindex;endindex")]
public ActionResult GetTop100Student(int startindex, int endindex)
{
    artistlist = new List<Artist>();          
    artistlist = statisticsmanager.GetTopStudent(id,  startindex, endindex);   

    ViewData["studentlist"] = studentlist; 
    return view();
} 
```

我通过 jquery/json 调用该函数。

XHR 完成加载：“ [http://EEE.COM/Top100/GetTop100Student/?startindex=1&endindex=10](http://EEE.COM/Top100/GetTop100Student/?startindex=1&endindex=10) ”。jquery-1.4.4.min.js:145

XHR 完成加载：“ [http://EEE.COM/Top100/GetTop100Student/?startindex=11&endindex=20](http://EEE.COM/Top100/GetTop100Student/?startindex=11&endindex=20) ”。jquery-1.4.4.min.js:145

XHR 完成加载：“ [http://EEE.COM/Top100/GetTop100Student/?startindex=21&endindex=30](http://EEE.COM/Top100/GetTop100Student/?startindex=21&endindex=30) ”。jquery-1.4.4.min.js:145

XHR 完成加载：“ [http://EEE.COM/Top100/GetTop100Student/?startindex=31&endindex=40](http://EEE.COM/Top100/GetTop100Student/?startindex=31&endindex=40) ”。jquery-1.4.4.min.js:145

XHR 完成加载：“ [http://EEE.COM/Top100/GetTop100Student/?startindex=41&endindex=50](http://EEE.COM/Top100/GetTop100Student/?startindex=41&endindex=50) ”。jquery-1.4.4.min.js:145

我在输出缓存中进行每次调用。我的问题是：如何删除此输出缓存。请任何人解决这种解决方案。谢谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:42:23.477

请参阅服务器故障：

[https://serverfault.com/questions/176943/will-an-iis-reset-force-cached-items-to-be-resent](https://serverfault.com/questions/176943/will-an-iis-reset-force-cached-items-to-be-resent)

看起来 IISReset 会这样做，否则请尝试为该站点循环应用程序池。

# wcf - WCF Exception Contract Missmatch ，我不这么认为

> ID：15203908
> 
> 赞同：1
> 
> 时间：2013-03-04T14:32:26.677
> 
> 标签：wcf, service, iis-8

> 服务器没有提供有意义的回复，这可能是由于合同错误、会话过早关闭或内部服务器错误造成的

嘿，调用 wcf 服务后出现异常。我知道这个异常可以在 stackoverflow 上找到很多，但我有一个特殊的行为。我也尝试了几乎所有推荐的解决方案，但没有成功......

我的项目执行以下操作：该模块就像一个普通的聊天，一个 wpf 和 asp 用户控件每 5 秒调用一次服务并获取在线用户。这通常在我的 Windows 7 工作站上运行良好。在我开始在装有 win 8 的新工作站上开发软件后，我遇到了这个异常。IIS 配置仍然相同。在第一个用户开始频繁调用该服务后，一切正常，直到第二个用户调用相同的服务，上述异常出现。我在win 7上设置了一个测试机，看看会发生什么......一切都恢复正常了......我不知道该怎么做......

服务 web.config：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
<system.diagnostics>
<sources>
  <source name="System.ServiceModel" switchName="Information, ActivityTracing"     propagateActivity="true">
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
  <source name="System.ServiceModel.MessageLogging">
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
  <source name="myUserTraceSource" switchName="Information, ActivityTracing">
    <listeners>
      <add name="xml" />
    </listeners>
  </source>
</sources>
<sharedListeners>
  <add name="xml" type="System.Diagnostics.XmlWriterTraceListener" initializeData="hi5.PSA.ServiceLog.svclog" />
</sharedListeners>
</system.diagnostics>
<appSettings>
<add key="Log4NetPath" value="config.log4net" />
</appSettings>
<system.web>
<compilation debug="true" targetFramework="4.0">
  <assemblies>
    <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  </assemblies>
</compilation>
<pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID" />
<!-- that many MB should be enough :) -->
<httpRuntime maxRequestLength="2147483647" />
</system.web>
<system.serviceModel>
<bindings>
  <basicHttpBinding>
    <binding name="BasicHttpBinding_IPmiLookup" />
  </basicHttpBinding>
</bindings>
<services>
  <service name="SolutionName.ChatService" behaviorConfiguration="chatServiceBehavior">
    <endpoint address="" binding="wsDualHttpBinding" contract="SolutionName.contracts.Chat.IChatManager" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>        
    <behavior name="chatServiceBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
    <behavior name="">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
  </serviceBehaviors>
</behaviors>
</system.serviceModel>
<system.webServer>
  <modules runAllManagedModulesForAllRequests="true"></modules>
 </system.webServer>
<connectionStrings>
<add name="MyEntities" connectionString="metadata=res://*/Users.csdl|res://*/Users.ssdl|res://*/Users.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=localhost;Initial Catalog=MyDB;Integrated Security=SSPI;MultipleActiveResultSets=True&quot;&#xD;&#xA;" providerName="System.Data.EntityClient" />
</connectionStrings>
</configuration> 
```

客户端 app.config：

```
<system.serviceModel>
<bindings>
  <wsDualHttpBinding>
    <binding name="WSDualHttpBinding_IChatManager" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true">
      <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
      <reliableSession ordered="true" inactivityTimeout="00:10:00" />
      <security mode="Message">
        <message clientCredentialType="Windows" negotiateServiceCredential="true" algorithmSuite="Default" />
      </security>
    </binding>
  </wsDualHttpBinding>
</bindings>
<client>
  <endpoint address="http://localhost/SolutionName/ChatService.svc" binding="wsDualHttpBinding" bindingConfiguration="WSDualHttpBinding_IChatManager" contract="hi5.medview.server.contracts.Chat.IChatManager" name="WSDualHttpBinding_ChatManager">
    <identity>
      <servicePrincipalName value="host/MyName"/>
    </identity>
  </endpoint>
</client> 
```

有没有人有任何想法。让我抓狂的是，该服务对于第一个调用它的用户来说工作正常，但是在第二个用户调用它之后，该死的东西不再工作了......请帮助......谢谢

# asp.net-mvc-4 - 在 MVC4 中捕获 404 错误

> ID：15203918
> 
> 赞同：7
> 
> 时间：2013-03-04T14:32:41.900
> 
> 标签：asp.net-mvc-4, iis-8

我在处理 HTTP 错误 404.0 - 未找到时遇到问题。我已经打开了

```
<customErrors mode="On" defaultRedirect="~/Error/General">
      <error statusCode="404" redirect="~/Error/HttpError404" />
      <error statusCode="500" redirect="~/Error/HttpError500" />
    </customErrors> 
```

在 Web.Config 中。但问题依然存在。我也尝试过这个解决方案（但它从来没有达到这个方法）：

```
protected void Application_Error()
    {
      var exception = Server.GetLastError();
      var httpException = exception as HttpException;
      Response.Clear();
      Server.ClearError();
      var routeData = new RouteData();
      routeData.Values["controller"] = "Errors";
      routeData.Values["action"] = "General";
      routeData.Values["exception"] = exception;
      Response.StatusCode = 500;
      if (httpException != null)
      {
        Response.StatusCode = httpException.GetHttpCode();
        switch (Response.StatusCode)
        {
          case 403:
            routeData.Values["action"] = "HttpError404";
            break;
          case 404:
            routeData.Values["action"] = "HttpError404";
            break;
        }
      }

      IController errorsController = new ErrorController();
      var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
      errorsController.Execute(rc);
    } 
```

由[@Darin Dimitrov提供](https://stackoverflow.com/questions/5226791/custom-error-pages-on-asp-net-mvc3/5229581#5229581)

这是控制器：

```
public class ErrorController : Controller
  {

    public ActionResult HttpError404(string error)
    {
      ViewData["Title"] = "Sorry, an error occurred while processing your request. (404)";
      ViewData["Description"] = error;
      return View("Index");
    }

    public ActionResult HttpError500(string error)
    {
      ViewData["Title"] = "Sorry, an error occurred while processing your request. (500)";
      ViewData["Description"] = error;
      return View("Index");
    }

    public ActionResult General(string error)
    {
      ViewData["Title"] = "Sorry, an error occurred while processing your request.";
      ViewData["Description"] = error;
      return this.View();

    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T08:09:35.717

好的，感谢@alistair-findlay 和[这个网站](http://www.digitallycreated.net/Blog/57/getting-the-correct-http-status-codes-out-of-asp.net-custom-error-pages)，我找到了解决方案。这就是 web.config 现在的样子：

```
<system.web>
    <customErrors mode="On" defaultRedirect="~/Error/General" redirectMode="ResponseRewrite"> 
        </customErrors>
 </system.web>
  <system.webServer>
<httpErrors errorMode="Detailed" defaultResponseMode="Redirect">
      <clear/>
      <error statusCode="404" path="/Error/HttpError404"/>
    </httpErrors>

  </system.webServer 
```

这是 Global.asax.cs：

```
 protected void Application_Error()
    {

      if (Context.IsCustomErrorEnabled)
        ShowCustomErrorPage(Server.GetLastError());

    }
    private void ShowCustomErrorPage(Exception exception)
    {
      var httpException = exception as HttpException ?? new HttpException(500, "Internal Server Error", exception);

      Response.Clear();
      var routeData = new RouteData();
      routeData.Values.Add("controller", "Error");
      routeData.Values.Add("fromAppErrorEvent", true);

      switch (httpException.GetHttpCode())
      {
        case 403:
          routeData.Values.Add("action", "HttpError403");
          break;

        case 404:
          routeData.Values.Add("action", "HttpError404");
          break;

        case 500:
          routeData.Values.Add("action", "HttpError500");
          break;

        default:
          routeData.Values.Add("action", "GeneralError");
          routeData.Values.Add("httpStatusCode", httpException.GetHttpCode());
          break;
      }

      Server.ClearError();

      IController controller = new ErrorController();
      controller.Execute(new RequestContext(new HttpContextWrapper(Context), routeData));
    } 
```

最后：

```
 public class ErrorController : Controller
  {

    public ActionResult HttpError403(string error)
    {
      ViewBag.Description = error;
      return this.View();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T15:03:43.920

您是否`ErrorController`在 customErrors 属性中实现了处理重定向的方法？在您的情况下，它看起来像这样：

```
public class ErrorController : Controller
{
    public ActionResult General()
    {
        return View();
    }

    public ActionResult HttpError404()
    {
        return View();
    }

    public ActionResult HttpError500()
    {
        return View();
    }
} 
```

您还需要为 Views 文件夹中的每个 ActionResults 实现视图。

在记录错误方面，您需要在`Application_Error`事件处理程序中实现这一点，如下所示：

```
protected void Application_Error()
{
    var exception = Server.GetLastError();
    var httpException = exception as HttpException;
    // Do logging here
} 
```

这是为了在 302 重定向到`ErrorController`上面定义的错误页面之前“捕获”错误。

# spring-ws - WebServiceGatewaySupport 与 WebServiceTemplate 的优势

> ID：15203919
> 
> 赞同：19
> 
> 时间：2013-03-04T14:32:44.240
> 
> 标签：spring-ws

我必须使用 Spring WS 实现一个 web 服务客户端。

我已经阅读了[http://static.springsource.org/spring-ws/site/reference/html/client.html](http://static.springsource.org/spring-ws/site/reference/html/client.html)上的文档，但我不清楚在我的服务类中扩展[`WebServiceGatewaySupport`](http://static.springsource.org/spring-ws/sites/2.0/apidocs/org/springframework/ws/client/core/support/WebServiceGatewaySupport.html)与直接使用的优势是什么。[`WebServiceTemplate`](http://static.springsource.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/client/core/WebServiceTemplate.html)

据我所知，`WebServiceGatewaySupport`只有几个包装方法`WebServiceTemplate`和一些初始化支持。

那么我为什么要扩展`WebServiceGatewaySupport`而不是直接使用 a`WebServiceTemplate`呢？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-07T11:06:51.307

我认为这总结了一切（在您链接的客户参考中找到）：

> 或者，考虑从 Spring-WS 的 WebServiceGatewaySupport 便利基类派生，它公开了方便的 bean 属性以实现轻松配置。（您不必扩展此基类......它仅作为便利类提供。）

因此，如果`WebserviceTemplate`提供您所需要的一切，那可能就足够了。如果您需要任何额外的东西，您可以使用 .`WebServiceGatewaySupport`作为示例，了解如何在`WebserviceTemplate`.

在我的客户端软件中，我只是`WebserviceTemplate`在我的[`@Configuration`](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-java)类中配置如下：

```
@Bean
public WebServiceTemplate webServiceTemplate() {
    WebServiceTemplate template = new WebServiceTemplate();
    template.setMessageFactory(messageFactory());
    template.setDefaultUri(defaultUri);
    template.setMarshaller(marshaller());
    template.setUnmarshaller(marshaller());
    template.setInterceptors(new ClientInterceptor[] {interceptor()});

    return template;
} 
```

（所有方法调用都是对配置中其他方法的引用，这些方法在本示例中并不相关）。我可以在代码中的任何地方使用该 bean 来发送消息。

# javascript - 为什么这个类不返回 false|| 真的？

> ID：15203920
> 
> 赞同：-2
> 
> 时间：2013-03-04T14:32:48.520
> 
> 标签：javascript

我有这门课

```
Class.V = function(v) {
    if (v.BooleanValue == true) {
        v.Success();
    } else {
        v.Fail();
    }

    return Class;
} 
```

我有一个按钮，它将执行一个函数，该函数将返回 true 或 false 以继续或不使用表单。

```
<input type="submit" onclick="return check()" Value="Check" />

function check() {
    Class.V({
        BooleanValue: true,
        Success: function() {
            return true;
        },
        Fail: function() {
            return false;
        }
    }) 
```

但它不起作用。这项工作改为：

```
function check() {
    Class.V({
        o: true,
        Success: function() {
            results = true;
        },
        Fail: function() {
            results = false;
        }
        return results;
        //now works as expected
        }) 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:36:01.470

根据您当前的代码，您必须从外部函数传播内部函数的返回值：

```
Class.V = function(v)
{
    if (v.BooleanValue) {
        return v.Success();
    } else {
        return v.Fail();
    }

    return Class;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:35:58.433

您需要进一步返回`v.Success`and`v.Fail`函数返回的值`Class.V`：

```
if (v.BooleanValue) {
    return v.Success();
    // ^ return here
} else {
    return v.Fail();
    // ^ and here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:36:19.390

您需要返回方法的值：

```
Class.V = function(v)
{
if(v.BooleanValue==true)
{
   return v.Success();
}
else{
   return v.Fail();
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T14:36:46.550

`return`只影响当前函数调用，不影响链。对于您的第一个代码块，`return true;`仅从匿名回调返回。你必须传递它。像这样的东西：

```
Class.V = function(v) {
    return v.BooleanValue ? v.Success() : return v.Fail();
}

function check() {
    return Class.V({
      BooleanValue: true,
      Success:function() {
          return true;
      },
      Fail:function() {
          return false;
      }
    })
} 
```

# jquery-ui - 更改和滑动一起调用 jqueryui 滑块

> ID：15203922
> 
> 赞同：0
> 
> 时间：2013-03-04T14:32:57.077
> 
> 标签：jquery-ui, slider

我正在尝试创建一个 jquery 句柄，当您滑动它时，它会在容器内移动另一个 div。以下是我的js

```
function handleSliderChange(e, ui)
{
    console.log('1');
    var maxScroll = $(".content-item").width()*$(".content-item").length - $("#content-scroll").width();
    $("#content-scroll").animate({scrollLeft: ui.value * (maxScroll / 100) },1000);
}

function handleSliderSlide(e, ui)
{
    console.log('2');
    var maxScroll = $(".content-item").width()*$(".content-item").length - $("#content-scroll").width();
    $("#content-scroll").animate({scrollLeft: ui.value * (maxScroll / 100) }, 10);
}

    $("#content-slider").slider({
        animate: true,
        slide: handleSliderSlide,
        change: handleSliderChange
    }); 
```

因此，当我单击该栏时，会同时调用 handleSliderChange 和 handleSliderSlide，但是当我拖动滑块时，任何解决方案都可以正常工作吗？我不介意从滑块取消点击功能我只需要拖动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T08:31:45.303

我找到了解决方案，诀窍是在运行方法之前检查触发了哪种类型的事件。我就是这样做的

```
sliderBar.slider({
                start: checkType,
                animate: options.animateSpeed,
                slide: handleSliderSlide,
                step: options.step,
                change: handleSliderChange,
                });

function checkType(e){
            _isSlide = $(e.originalEvent.target).hasClass("ui-slider-handle");
        } 
```

# scala - 扩展助手 inputRadioGroup play2

> ID：15203925
> 
> 赞同：0
> 
> 时间：2013-03-04T14:33:06.823
> 
> 标签：scala, templates, radio-group, playframework-2.1

我按照[文档](http://www.playframework.com/documentation/2.0.4/ScalaFormHelpers)创建了自己的字段构造函数，我的字段的 html 是根据我的需要呈现的。
现在我想扩展`@helper.inputRadioGroup`以符合我的需要。

我当前的模板如下所示：

```
@(smsReviewForm: Form[SmsReview], grades: Seq[Grade]) 

@helper.inputRadioGroup(smsReviewForm("grade"),
            options = grades.map(g => g.value.toString -> g.name)
        ) 
```

结果是：

```
<div class="clearfix ">
<label for="grade">grade</label>
  <span class="buttonset" id="grade">   
      <input type="radio" id="grade_1" name="grade" value="1">
      <label for="grade_1">Brilliant</label>    
      <input type="radio" id="grade_2" name="grade" value="2">
      <label for="grade_2">Good</label>    
      <input type="radio" id="grade_3" name="grade" value="3" checked="">
      <label for="grade_3">Ok</label>    
  </span>
<span class="help-inline">Numeric</span>
</div> 
```

我想要的是创建一个`@helper.customInputRadioGroup`可以呈现：

```
<div class="clearfix ">
<label for="grade">grade</label>
  <span class="buttonset" id="grade">   
      <input type="radio" id="grade_1" name="grade" value="1" class="hover-star star_on">
      <input type="radio" id="grade_2" name="grade" value="2" class="hover-star star_on">
      <input type="radio" id="grade_3" name="grade" value="3" checked="" class="hover-star star_on">      
  </span>
<span class="help-inline">Numeric</span>
</div> 
```

我如何以及在哪里实现我自己的 customInputRadioGroup？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T15:28:31.303

[您可以在播放源代码](https://github.com/playframework/Play20/tree/master/framework/src/play/src/main/scala/views/helper)中看到其他视图助手是如何完成的

如果您将以下代码放入`views.helper`您的项目中，您应该得到您所需要的：

```
@(field: play.api.data.Field, options: Seq[(String,String)], args: (Symbol,Any)*)(implicit handler: FieldConstructor, lang: play.api.i18n.Lang)

@input(field, args:_*) { (id, name, value, htmlArgs) =>
  <span class="buttonset" id="@id">
    @options.map { v =>
      <input type="radio" id="@(id)_@v._1" name="@name" value="@v._1" @(if(value == Some(v._1)) "checked" else "") @toHtmlArgs(htmlArgs)>
    }
  </span>
} 
```

我想知道是否真的有必要创建一个自定义视图助手只是为了省去额外的标签，也许你可以用一点 css 来实现相同的视觉效果。

# heroku - Heroku 合作者控制 Dynos？

> ID：15203939
> 
> 赞同：1
> 
> 时间：2013-03-04T14:33:39.590
> 
> 标签：heroku

Heroku 文档指出：“虽然只有应用程序所有者可以更改资源（dynos、worker 和附加组件），但应用程序上的协作者几乎可以做任何他们想做的事情——推送……”

这听起来很明智。所以我刚刚在我的 Heroku 应用程序中添加了一个协作者，但偶然我意识到协作者实际上拥有更改资源的完全访问权限——这意味着他们可以轻松地启动 dynos 并为我带来巨额账单。

如何更改协作者的权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:16:24.087

目前您无法更改协作者权限。

来自“[合作者特权](https://devcenter.heroku.com/articles/sharing#collaborator-privileges)”：

> 协作者支持所有操作，就像应用程序所有者一样，除了：
> 
> *   添加或删除付费插件
> *   删除或重命名应用程序
> *   查看发票

# nsnotificationcenter - 应用在后台时获取 EAAccessoryDidConnectNotification (iOS)

> ID：15203940
> 
> 赞同：2
> 
> 时间：2013-03-04T14:33:44.193
> 
> 标签：nsnotificationcenter, eaaccessory

在我的 '`viewDidLoad'in` `ViewController.m`中，我正在`NSNotificationCenter defaultCenter`使用 ' `EAAccessoryDidConnectNotification`' 和 ' `EAAccessoryDidDisconnectNotification`' 注册当我的应用程序在前台处于活动状态时，我会收到通知，并在 accessoryDidConnect 中做出响应。一切正常。但是，当应用程序在后台时，我怎样才能得到这样的通知？

```
('EAAccessoryDidConnectNotification' and 'EAAccessoryDidDisconnectNotification')
[Code below] 
```

非常感谢。担

```
(void)viewDidLoad
{

  [super viewDidLoad];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(accessoryDidConnect:)
                                                 name:EAAccessoryDidConnectNotification
                                               object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(accessoryDidDisconnect:)
                                                 name:EAAccessoryDidDisconnectNotification
                                               object:nil];    

    [[EAAccessoryManager sharedAccessoryManager] registerForLocalNotifications];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-06T14:57:27.953

根据[文档](https://developer.apple.com/library/ios/featuredarticles/ExternalAccessoryPT/Articles/MonitoringEvents.html)，这是不可能的：

> 如果附件通知到达时您的应用程序在后台暂停，则该通知将放入队列中。当您的应用再次开始运行时（无论是在前台还是在后台），队列中的通知都会发送到您的应用。通知也会尽可能合并和过滤，以消除任何不相关的事件。例如，如果在您的应用程序暂停时连接了一个配件并随后断开了连接，那么您的应用程序最终将不会收到任何此类事件发生的指示。

但如果有人证明我错了，那会很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-05T12:17:08.743

在 iOS 12.1.4 中，当应用程序处于前台时，将中继线插入 iPhone 和 DSLR 相机，然后将应用程序切换到后台模式，拔下中继线并将应用程序切换回前台，您将通过 EAAccessory 的委托方法收到附件DidDisconnect 通知.

# c# - 我可以在不使用 OpenFileDialog 的情况下读取目录中的文件吗？

> ID：15203943
> 
> 赞同：0
> 
> 时间：2013-03-04T14:33:55.660
> 
> 标签：c#, wpf, xbap

我有一个应用程序，我认为 WPF XBAP 应用程序最适合这个。但是，我不知道它带来的限制。因此，在选择此工具之前，我需要了解它。

基本上我想读取操作系统内的任何文件夹并获取该文件夹内的文件列表。这可能使用 WPF XBAP 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:36:43.007

`OpenFileDialog`只是一个让`selection`&`reading`更容易的媒体。`folder`只要您知道`path`并`have permission`阅读文件夹，您就可以阅读任何内容。

# .net - ABBYY FineReader SDK 如何定义最小识别率

> ID：15203946
> 
> 赞同：1
> 
> 时间：2013-03-04T14:34:05.457
> 
> 标签：.net, ocr, abbyy, finereader

有人使用fineReader abbyy sdk 10吗？我很好奇图像ocr处理后是否有可能获得数据挖掘的成功率。

对于我们有从图像中收集数据的工作流的场景，如果识别的结果小于 90%，那么我们将我们的批次进行视觉验证/校正。

对于 sdk 处理，我使用的是 .net - 知道它不是那么重要，但是......以防万一

我怎样才能达到这个数字？谢谢你的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-15T10:56:27.300

没有“全局识别置信度”属性。开发人员应使用自己的置信度标准自行计算。最简单的方法是遍历每个字符，检查 CharParams.IsSuspicious 属性。这是 FREngine 11 的代码示例 (C#)

```
 //Statistics counters 

    //Count of all suspicious symbols in layout
    private int suspiciousSymbolsCount;
    //Count of all unrecognized symbols in layout
    private int unrecognizedSymbolsCount;
    //Count of all nonspace symbols in layout
    private int allSymbolsCount;
    //Count of all words in layout
    private int allWordsCount;
    //Count of all not dictionary word in layout
    private int notDictionaryWordsCount;
    private void processImage()
    {
        // Create document
        FRDocument document = engineLoader.Engine.CreateFRDocument();

        try {
            // Add image file to document
            displayMessage( "Loading image..." );
            string imagePath = Path.Combine( FreConfig.GetSamplesFolder(), @"SampleImages\Demo.tif" );

            document.AddImageFile( imagePath, null, null );

            //Recognize document
            displayMessage( "Recognizing..." );
            document.Process( null );

            // Calculate text statistics
            displayMessage( "Calculating statistics..." );
            clearStatistics();
            for( int i = 0; i < document.Pages.Count; i++ ) {
                calculateStatisticsForLayout( document.Pages[i].Layout );
            }

            //show calculated statistics
            displayStatistics();

        } catch( Exception error ) {
            MessageBox.Show( this, error.Message, this.Text, MessageBoxButtons.OK, MessageBoxIcon.Error );
        }
        finally {
            // Close document
            document.Close();
        }
    }
    private void calculateStatisticsForLayout( Layout layout )
    {    
        LayoutBlocks blocks = layout.Blocks;
        for( int index = 0; index < blocks.Count; index++ ) {
            calculateStatisticsForBlock( blocks[index] );
        }
    }

    void calculateStatisticsForBlock( IBlock block )
    {           
        if( block.Type == BlockTypeEnum.BT_Text ) {
            calculateStatisticsForTextBlock( block.GetAsTextBlock() );
        } else if( block.Type == BlockTypeEnum.BT_Table ) {
            calculateStatisticsForTableBlock( block.GetAsTableBlock() );
        }
    }

    void calculateStatisticsForTextBlock( TextBlock textBlockProperties )
    {
        calculateStatisticsForText( textBlockProperties.Text );
    }

    void calculateStatisticsForTableBlock( TableBlock tableBlockProperties )
    {
        for( int index = 0; index < tableBlockProperties.Cells.Count; index++ ) {
            calculateStatisticsForBlock( tableBlockProperties.Cells[index].Block );
        }
    }

    void calculateStatisticsForText( Text text ) 
    {
        Paragraphs paragraphs = text.Paragraphs;
        for( int index = 0; index < paragraphs.Count; index++ ) {
            calculateStatisticsForParagraph( paragraphs[index] );
        }
    }

    void calculateStatisticsForParagraph( Paragraph paragraph )
    {
        calculateCharStatisticsForParagraph( paragraph );

        calculateWordStatisticsForParagraph( paragraph );
    }

    void calculateCharStatisticsForParagraph( Paragraph paragraph )
    {
        for( int index = 0; index < paragraph.Text.Length; index++ )
        {
            calculateStatisticsForChar( paragraph, index );
        }
    }

    void calculateStatisticsForChar( Paragraph paragraph, int charIndex )
    {
        CharParams charParams = engineLoader.Engine.CreateCharParams();
        paragraph.GetCharParams( charIndex, charParams );
        if( charParams.IsSuspicious ) 
        {
            suspiciousSymbolsCount++;
        }

        if( isUnrecognizedSymbol( paragraph.Text[charIndex] ) ) 
        {
            unrecognizedSymbolsCount++;
        }

        if( paragraph.Text[charIndex] != ' ' ) 
        {
            allSymbolsCount++;
        }
    }

    void calculateWordStatisticsForParagraph( Paragraph paragraph )
    {
        allWordsCount += paragraph.Words.Count;

        for( int index = 0; index < paragraph.Words.Count; index++ ) 
        {
            if( !paragraph.Words[index].IsWordFromDictionary ) 
            {
                notDictionaryWordsCount ++;
            }
        }
    }

    bool isUnrecognizedSymbol( char symbol )
    {
        //it is special constant used by FREngine recogniser
        return ( symbol == 0x005E );
    }

    void displayStatistics()
    {
        labelAllSymbols.Text = "All symbols: " + allSymbolsCount.ToString();
        labelSuspiciosSymbols.Text = "Suspicious symbols: " + suspiciousSymbolsCount.ToString();
        labelUnrecognizedSymbols.Text = "Unrecognized symbols: " + unrecognizedSymbolsCount.ToString();

        labelAllWords.Text = "All words: " + allWordsCount.ToString();
        labelNotDictionaryWords.Text = "Non-dictionary words: " + notDictionaryWordsCount.ToString();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:30:16.243

恕我直言，没有这样的“全局置信度”值 - 但您可以通过获取每个角色的置信度并对总数进行平均来轻松获得此值。但是，我认为您应该将您的请求发送到 ABBYY 的论坛或支持电子邮件地址，以了解他们的建议。

真的不可能告诉你如果我使用引擎我会得到什么程度的信心，因为这一切都取决于图像的质量、字体的大小等等：没有像'这样的东西行业用来作为数据基础的平均文档。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-12T13:49:25.223

FRE SDK 识别结果仅在文本或表格块中具有文本。我建议你有一个全局字数统计变量。

1.  运行异步方法来遍历单词并获取单词中可疑字符的数量。（可疑）
2.  查找每页中带有可疑字符的单词总数
3.  （带有可疑字符的单词）/（总单词数）并将结果乘以 100。

    2/4 等于 0.5。乘以 0.5 * 100 = 50%。那是您的准确性。上面在 abbyy 的另一个答案中给出了检查可疑字符和置信度的代码示例。

# ant - 构建可以使用 Ant 或 Maven 为我的 Talend 作业创建 WAR 的脚本

> ID：15203951
> 
> 赞同：0
> 
> 时间：2013-03-04T14:34:12.840
> 
> 标签：ant, talend

我正在尝试创建一个构建脚本，它可以使用基于 Ant 或 Maven 的构建脚本为我的 Talend 作业创建 WAR，这些构建脚本可以从命令行运行并最终集成到像 Hudson 这样的持续集成系统中。有一些方法可以在 Talend Enterprise 版本 5.2.1 中集成 Ant/Maven 脚本，但是我正在尝试使用社区版本来实现这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T12:15:25.957

You can export jobs to WAR (or ZIP, or whatever you want) by using the command line export tool. Are you aware of this?

# sql-server - 将用户和密码从 AD 迁移到 SQL Server

> ID：15203954
> 
> 赞同：1
> 
> 时间：2013-03-04T14:34:16.747
> 
> 标签：sql-server, active-directory, migration

让我描述一下这个问题，我当前的门户网站正在使用 AD 登录和 pwd 详细信息来验证外部用户。我将拥有一个新门户，它将 SQL Server 中的登录名和密码保存在一个表中。我需要将登录名/密码从 AD 域迁移到 sql 数据库，以便外部用户可以使用他们的旧密码。是否可以？我应该如何处理？

谢谢你的帮助，拉法尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:41:49.370

收集用户名列表应该不是问题。然而，SQL Server 存储密码的散列版本，并且可能 Active Directory 以不同的方式执行此操作。除了在 Active Directory 下创建一个桥接应用程序之外，我没有看到任何解决方案，该应用程序使用临时密码将它们登录到 SQL Server 并让他们分配一个新密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-13T06:33:00.293

权限应该与数据库有关。也许您已经失去了服务器登录和数据库用户之间的关联。看看他们的 SID 是否不同。如果是这样，您可以使用

使用登录名更改用户 =
或

exec sp_change_users_login（在线查看书籍以了解如何使用它）
[http://technet.microsoft.com/en-us/library/ms174378.aspx](http://technet.microsoft.com/en-us/library/ms174378.aspx)

# log4j - Log4J - 记录器不工作

> ID：15203956
> 
> 赞同：0
> 
> 时间：2013-03-04T14:34:21.750
> 
> 标签：log4j, appender

我将 Log4J 用于 Java 应用程序。

请在下面找到我的 log4j.xml 文件的摘录：

```
 <appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender">
        <errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"/>
        <param name="Target" value="System.out"/>
        <param name="Threshold" value="INFO"/>

        <layout class="org.apache.log4j.PatternLayout">
           <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p [%c{1}] %m%n"/>
        </layout>
    </appender>

   <logger name="my.package.name">
     <priority value="debug" />
   </logger> 
```

我想为我的包打印一个`info`级别和日志的每个日志。但是，这些日志没有出现...... :(`debug``my.package.name``debug`

有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:07:59.583

改变

```
 <param name="Threshold" value="INFO"/> 
```

至

```
 <param name="Threshold" value="debug"/> 
```

由于您已放置`Threshold`到`INFO`仅`info and above`将记录。调试级别低于信息级别。这就是为什么不记录调试级别的原因。

log4j 层次结构是`TRACE Level < DEBUG Level< INFO Level< WARN Level < ERROR Level < FATAL Level`.

希望这可以帮助

# java - 从同步方法中调用同步方法，两者都是同一个对象

> ID：15203958
> 
> 赞同：5
> 
> 时间：2013-03-04T14:34:41.063
> 
> 标签：java, synchronized

为什么下面的代码不会导致死锁？我的意思是在我调用 getNumber(.) 之后，Test 类的对象应该被锁定，所以我不应该能够访问 getNumber2(.)。

```
class Test() {
    synchronized int getNumber(int i){
        return getNumber2(i);
    }

    synchronized int getNumber2(int i) {
        return i;
    }

    public static void main(String[] args) {
        System.out.println((new Test()).getNumber(100));
    }
} 
```

输出：

```
100 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-04T14:35:41.137

这是因为锁是可重入的，这意味着它可以被同一个线程多次获取。

来自[Java 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)：

> **可重入同步**
> 
> 回想一下，一个线程不能获得另一个线程拥有的锁。但是线程可以获取它已经拥有的锁。允许一个线程多次获取同一个锁可以实现重入同步。这描述了一种情况，同步代码直接或间接调用一个也包含同步代码的方法，并且两组代码都使用相同的锁。如果没有可重入同步，同步代码将不得不采取许多额外的预防措施来避免线程导致自身阻塞。

JLS 的相关部分是[**§17.1。同步**](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.1)：

> Java 编程语言为线程之间的通信提供了多种机制。这些方法中最基本的是同步，它是使用监视器实现的。Java 中的每个对象都与一个监视器相关联，线程可以锁定或解锁监视器。一次只有一个线程可以锁定监视器。任何其他试图锁定该监视器的线程都会被阻塞，直到它们能够获得对该监视器的锁定。**一个线程 t 可能会多次锁定一个特定的监视器；每次解锁都会反转一次锁定操作的效果。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T14:37:34.180

它不会导致死锁，因为当一个线程进入一个同步方法时，它所做的就是检查它是否有一个锁`this`，如果没有，它会等到它可以拥有锁并获得它。

在您的情况下，当线程进入第二个同步方法时，它已经拥有`this`对象上的锁，因此它可以在不阻塞的情况下进入该方法。

# c# - C# 对象创建需要时间

> ID：15203961
> 
> 赞同：2
> 
> 时间：2013-03-04T14:34:50.720
> 
> 标签：c#, object, creation

我需要在运行时在我的应用程序中创建大约 720 个按钮或标签。这里的问题是当我启动我的应用程序或使其（重新）可见时，我可以看到正在加载的按钮。

我怎样才能避免它或让它更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T14:37:56.317

最好的方法是在开始用按钮填充控件之前使用[Control.SuspendLayout](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout.aspx)方法，而不是在完成之后使用[Control.ResumeLayout](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resumelayout.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:36:57.683

您可以尝试在加载控件之前暂停布局，然后再恢复。这应该加快加载速度： [SuspendLayout](http://msdn.microsoft.com/en-gb/library/system.windows.forms.control.suspendlayout.aspx)

这是一个可能证明有用的链接：（提高 wndows 表单应用程序性能的提示）-

[Winforms 性能](http://msdn.microsoft.com/en-us/magazine/cc163630.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:37:47.437

您几乎不可能同时需要**所有**这些按钮*。*

如果您正在设计 UI，请将其拆分为选项卡，其中选项卡表示 UX 逻辑组。

如果你*不*设计 UI，使用控件不是一个好的选择，选择其他东西在屏幕上*绘制*，它会快得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T14:38:37.980

这里有一些很好的提示，您可以通过这些提示来加快您的申请速度。

[http://devcomponents.com/blog/?p=361](http://devcomponents.com/blog/?p=361)

也就是说，我真的会提出一个问题，为什么你需要加载 720 个按钮。很有可能您只会使用表单上可用控件的 5%。找出减少它们的好方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T14:43:17.817

如果您想“隐藏”加载所有控件的过程，只需使用启动屏幕，以便用户可以看到应用程序正在加载，但在加载完成之前无法看到所有实际组件。

PS：考虑将这些按钮分成几组，因为`m sure you don`它需要将所有按钮都放在一个位置（也许分成标签？并在按下标签时加载它们？）好吧，想想吧。

# html - 身体离开画布

> ID：15203962
> 
> 赞同：-1
> 
> 时间：2013-03-04T14:34:51.457
> 
> 标签：html, css, layout

我尝试修复布局，因为如果您从手机上看到此链接，您会看到整个右侧部分离开画布一些像素。

我尝试设置一个`max-width:1280px;`属性，但它没有工作。有没有人容易解决？也许我应该定义一个 body max-width ？

[http://www.2kfilms.com/films.html](http://www.2kfilms.com/films.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:52:57.913

在您的`page`和`films-list`样式中，您定义的是固定的。这些永远不会被“挤压”。如果你想让它们变得更小，你需要以不同的方式定义它们。您的代码中可能有更多地方正在执行此操作。修复它以适应。

# ios - 静态 NSDateFormatter 始终为零

> ID：15203963
> 
> 赞同：1
> 
> 时间：2013-03-04T14:34:53.593
> 
> 标签：ios, cocoa, static, nsdateformatter

在我的模型对象中，我正在分配这样的日期：

```
static NSDateFormatter *dateFormat = nil;
if (nil == dateFormat) {
    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
}

dateCreated = [dateFormat dateFromString:@"2013-03-04 09:16:41"]; 
```

我所看到的`dateFormat`是总是这样`nil`；因此，`dateCreated`设置为`nil`。不知道如何去调试这个......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T14:44:05.187

问题只是您在语句中引入了另一个非`static` `dateFormat`变量。`if`

尝试这个：

```
static NSDateFormatter *dateFormat = nil;
if (nil == dateFormat) {
    dateFormat = [[NSDateFormatter alloc] init]; // NOT NSDateFormatter *dateFormat = ...
    [dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T14:37:21.753

`NSDateFormatter`不是nil 的原因是`static`开头的关键字，`static`关键字只初始化`NSDateFormatter`nil 一次，当你`NSDateFormatter`在代码中检查后面的时候，它永远不会是 nil

# javascript - 使用 javascript localstorage 存储和加载数据？

> ID：15203968
> 
> 赞同：0
> 
> 时间：2013-03-04T14:35:06.743
> 
> 标签：javascript, html5-canvas, local-storage

我正在用 javascript 制作一个简单的游戏，我有兴趣使用 localstorage 存储和加载分数，而不是在刷新后重置它。

当前代码：

```
var points = 0;   
if (
        hero.x <= (monster.x + 30)
        && monster.x <= (hero.x + 30)
        && hero.y <= (monster.y + 30)
        && monster.y <= (hero.y + 30)
    ) {
        ++points;
    } 
```

我存储点的最终结果应该是这样的，但我不太明白：

```
if (
        hero.x <= (monster.x + 30)
        && monster.x <= (hero.x + 30)
        && hero.y <= (monster.y + 30)
        && monster.y <= (hero.y + 30)
   ) {
        localStorage.points=Number(localStorage.points)+1;
     }
else
     {
        localStorage.points=0;
     } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:38:21.013

您正在寻找的是：`localStorage.setItem("points", localStorage.getItem("points")+1);`

# java - 参数中的 Java 访问变量

> ID：15203969
> 
> 赞同：1
> 
> 时间：2013-03-04T14:35:07.610
> 
> 标签：java, variables, pointers, arguments

我希望能够访问传递给我的方法的变量。我知道 C 可能有某种方法可以将某物的地址作为参数传递，然后将其作为指针引用并能够使用该变量。无论如何，这是一个例子。

```
void myFunction(address to variable) {
    *variable = "example";
} 
```

然后将其称为：

```
myFunction(&somevariable); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:37:13.770

在 Java 中无法通过引用或指针传递参数，因此实现您想要的效果的唯一方法是传递一个*可变*对象，并在您调用的方法中更改其值：

```
public class ChangeableInt {
    private int number;
    public ChangeableInt(int value) {number = value;}
    public int get() {return number;}
    public void set(int value) {number = value;}
} 
```

有了这个类，你可以这样做：

```
void myFunction(ChangeableInt arg) {
   arg.set(42);
}
...
ChangeableInt val = new ChangeableInt(123);
myFunction(val);
System.out.println(val.get()); // prints 42 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:39:14.207

您需要的是一个简单的包装模板类...

```
class ObjWrapper<T> {
  T value;

  void setValue(T val) {
    value=val;
  }

  T getValue() {
    return value;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:45:14.693

就像是

```
 class Myclass{
    int x=15;

    System.out.println(x) //15

    public static void main(String... ){

    Myclass obj = new Myclass()
    Myclass newRef =  method(obj)
    System.out.println(newRef.x)   //20

    }
   static Myclass method(Myclass ref){
       ref.x=20

    return ref
  }  
    }//class 
```

请注意，在 'obj' 中是对驻留在堆中某处的对象的引用。

# java - 修复 html 中未闭合的标签或使用 HTML 解析器进行解析以进行 XSLT 转换

> ID：15203972
> 
> 赞同：5
> 
> 时间：2013-03-04T14:35:28.363
> 
> 标签：java, html, parsing, xslt, tags

我有一些 HTML 代码是 XSLT 转换的结果。(XML->HTML)

我想在结果 HTML 上运行另一个 XSLT 转换。(HTML->HTML)

我的问题是第一个转换可能会返回像“ `<img>`”这样的未闭合标签，这意味着我无法使用 DocumentBuilder 解析结果 html，因为它使用 SAXparser，当然我的 html 文件在所有情况下都不是有效的 xml。（我得到一个例外，必须关闭以下 XY 标记。）

我想有两种解决方案。

1.  通过关闭未关闭的标签来修复结果 HTML。

2.  使用某种 HTML 解析器来获取有效的 org.w3c.dom.Document 并跳过像 SAX 这样的 XML 解析器。

我真的很想主要使用与第一次转换相同的方法，所以我更喜欢上述问题的一个解决方案是我找不到任何明显的第 3 方罐子可以提供帮助。（虽然我看过。）所以基本上我想知道我在这里有什么选择，这个问题有什么解决方案吗？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T14:44:14.587

你需要的是`Jsoup : Java HTML Parser`. 它具有输出整洁的 HTML 的功能。

```
String html = "<p>The recurrence, in close succession <ul><li>list item 1</li><li>list item 2</li></ul> second part of thisssss";
String clean = Jsoup.clean(html, Whitelist.relaxed()); 
```

您也可以使用其他[白名单](http://jsoup.org/apidocs/org/jsoup/safety/Whitelist.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T16:19:10.817

## ![替代文字](../Images/cc0c4385097e2934614ee013202a3434.png)[TagSoup - Just Keep On Truckin'](http://vrici.lojban.org/~cowan/XML/tagsoup/)![替代文字](../Images/8368d9aa1c71d016f060ff9416a21881.png)

您可以使用[**TagSoup**](http://vrici.lojban.org/~cowan/XML/tagsoup/)来确保所有文档格式正确。

> ...一个用 Java 编写的符合 SAX 的解析器，它不是解析格式良好或有效的 XML，而是解析在野外发现的 HTML：糟糕、肮脏和野蛮，尽管通常很不短。
> 
> TagSoup 是为那些必须使用某种看似合理的应用程序设计来处理这些东西的人设计的。
> 
> 通过提供 SAX 接口，它允许将标准 XML 工具应用于甚至最糟糕的 HTML。TagSoup 还包括一个命令行处理器，它可以读取 HTML 文件，并且可以生成干净的 HTML 或与 XHTML 非常接近的格式良好的 XML。

如果您使用的是 Saxon，[则可以通过添加以下选项使 TagSoup 成为您的解析器](http://vrici.lojban.org/~cowan/XML/tagsoup/tsaxon/)：

> `-x org.ccil.cowan.tagsoup.Parser`...在确保 TagSoup 在您的 Java 类路径上之后，您可以使用标准的 Saxon选项。

我已经使用它一次性解析和转换 HTML 文档，并且发现它工作得很好。它将文档作为格式良好的 XHTML 文档读取，可通过 XML 工具进行操作和转换。

此外，[C++ 中的 TagSoup Taggle 现已上市](http://www.jezuk.co.uk/arabica/log?id=3591)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:48:41.960

您需要整理您的 XML。试试这个库：

[http://jtidy.sourceforge.net/](http://jtidy.sourceforge.net/)

# soap - Camel：处理 CXF 请求后如何返回有效的 SOAP 响应

> ID：15203973
> 
> 赞同：1
> 
> 时间：2013-03-04T14:35:29.077
> 
> 标签：soap, cxf, response, apache-camel, envelope

所以，我有一个公开 Web 服务端点的路由。收到请求后，我将一些信息发送到一些队列，我想将响应返回给原始调用者。响应是一个可以有 4 个值的枚举`(OK,NULL,RPT,NOK)`。

我可以在soapUI 中获得响应，但它不在有效的SOAP 信封中。这意味着当在 Java 或 .Net 中处理响应时，会引发异常，说明没有有效的 Envelope 命名空间。

如何保证发送的响应是 SOAPMessage？

要生成我的回复消息，我有这个方法：

```
public OnClientEventResponse process(Message message){
    if(message.getBody().toString().contains("OnClientEventResponse")){
        return (OnClientEventResponse) message.getBody();
    }
    OnClientEventResponse resp = new OnClientEventResponse();
    resp.setReturn(Response.OK);
    return resp;
} 
```

在soapUi我得到这个：

```
<onClientEventResponse>
   <Response>OK</Response>
</onClientEventResponse> 
```

但我需要这样的东西：

```
<soap:Envelope xmlns:soap="blabla/soap/envelope">
<soap:Headers/>
<soap:Body>
    <onClientEventResponse>
       <Response>OK</Response>
    </onClientEventResponse>
<soap:Body>
<soap:Envelope> 
```

我的 Webservice 接口类是：

```
@WebService(name = "ClientEventNotifierEndpoint")
public interface ClientEventNotifierEndpoint {

@WebMethod(operationName = "onClientEvent", action = "urn:OnClientEvent")
@WebResult(name = "return")
public Response onClientEvent(@WebParam(name = "readerCode") String readerCode, @WebParam(name = "clientRfid") String clientRfid,
        @WebParam(name = "eventType") String eventType, @WebParam(name = "dateTime") Date dateTime); 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-16T13:49:48.113

我相信你不再等待这个答案，但因为我刚刚完成寻找同样的事情，这就是你必须做的：

```
package com.xxxxx.esb.invoice.processors;

import java.io.StringWriter;
import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.Marshaller;
import javax.xml.namespace.QName;
import javax.xml.transform.Source;
import javax.xml.transform.dom.DOMSource;

import org.apache.camel.Exchange;
import org.apache.camel.Processor;
import org.apache.camel.component.cxf.CxfPayload;
import org.apache.camel.converter.jaxp.XmlConverter;
import org.apache.cxf.binding.soap.SoapHeader;
import org.apache.log4j.Logger;
import org.w3c.dom.Document;

import com.xxxxx.esb.invoice_service_spec.ProcessFileResponse;

/**
 * @author pantinor
 * 
 * 
 * 
 */
public class SoapResponseProcessor implements Processor {
    private static final String ROOT_NODE = "processFileResponse";
    private static final String NAMESPACE = "http://www.xxxxx.com/Esb/invoice-service    -spec";
    private static final String OK = "OK";
    protected static final Logger LOG = Logger
            .getLogger(SoapResponseProcessor.class);

    @Override
    public void process(Exchange exchange) throws Exception {
        //lots a support classes to serialize my answer
        List<Source> outElements = new ArrayList<Source>();
        XmlConverter converter = new XmlConverter();
        StringWriter writer = new StringWriter();
        JAXBContext context = JAXBContext
                .newInstance(ProcessFileResponse.class);
        Marshaller m = context.createMarshaller();

        //build my business answer
        ProcessFileResponse result = new ProcessFileResponse();
        result.setReturn(OK);

        //serialize the answer

        //the following is required since the JAXB annotated class does not include     the XMLRoot annotation
        m.marshal(new JAXBElement<ProcessFileResponse>(new QName(NAMESPACE,
                ROOT_NODE), ProcessFileResponse.class, result), writer);

        Document outDocument = converter.toDOMDocument(writer.toString());
        outElements.add(new DOMSource(outDocument.getDocumentElement()));

        //use camel class cxf class to produce a payload that the cxf component can     consume for the answer
        CxfPayload<SoapHeader> responsePayload = new CxfPayload<SoapHeader>(
                null, outElements, null);

        //write the anwer
        exchange.getIn().setBody(responsePayload);

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T18:14:05.557

我不确定它是否适用于骆驼，但尝试将此注释添加到您的界面。

```
@WebService(name = "ClientEventNotifierEndpoint")
@SOAPBinding(style = SOAPBinding.Style.RPC) 
```

公共接口 ClientEventNotifierEndpoint {

# android - Android SQLite：如何将变量传输到不同的活动？

> ID：15203974
> 
> 赞同：0
> 
> 时间：2013-03-04T14:35:33.817
> 
> 标签：android, database, sqlite, extending

**主程序.JAVA**

```
public void onClick(View arg0) {
    switch (arg0.getId()) {
    case R.id.buttonupdate:
        String name = sqlName.getText().toString();
        String value = sqlValue.getText().toString();
        MainActivity entry = new MainActivity(Main.this);
        entry.open();
        entry.createEntry(name, value);
        entry.close();
        break;
    case R.id.buttonview:
        Intent intentone = new Intent();
        intentone.setClassName("com.example.sqltwo", "com.example.sqltwo.View");
        startActivity(intentone);
        break;
    case R.id.buttonsearch:
        String searchtext = sqlQuery_value.getText().toString();
        break;
    }   public void onClick(View arg0) {
    switch (arg0.getId()) {
    case R.id.buttonsearch:
        String name = sqlName.getText().toString();
        String value = sqlValue.getText().toString();
        MainActivity entry = new MainActivity(Main.this);
        entry.open();
        entry.createEntry(name, value);
        entry.close();
        break;
    case R.id.buttonview:
        Intent intentone = new Intent();
        intentone.setClassName("com.example.sqltwo", "com.example.sqltwo.View");
        startActivity(intentone);
        break;
    case R.id.buttonsearch:
        String searchtext = sqlQuery_value.getText().toString();
        break;
    } 
```

MAINACTIVITY.JAVA

```
public long createEntry(String name, String value) {
    ContentValues cv = new ContentValues();
            cv.put(KEY_NAMES, name);
            cv.put(KEY_VALUES, value);
            return qdatabase.insert(DATABASE_TABLE, null, cv);
}
public String getData() {
    String[] columns = new String[]{KEY_NAMES, KEY_VALUES};
    Cursor c = qdatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);
    String result = "";

    int iValue = c.getColumnIndex(KEY_VALUES);
    int iName = c.getColumnIndex(KEY_NAMES);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + c.getString(iName) + "\n" + c.getString(iValue) + "\n";
    }
    return result;  
}
public String search(String searchtext) {
    String searchresult = "";
    String arg = searchtext;

    String query = "select * from " + DATABASE_TABLE + " where title=\"" + arg +"\"";

    Cursor c = qdatabase.rawQuery(query, new String[] {arg});
    int iName = c.getColumnIndex(KEY_NAMES);

    if (c.moveToFirst()) {
        searchresult = searchresult + c.getString(iName);
    }

    return searchresult;

} 
```

在 R.id.buttonsearch 的情况下：

它抓取 TextEdit 并将其存储到 searchtext 中。我需要 MainActivity 中的 searchtext 运行搜索功能并返回与该查询匹配的所有行。如何将 Main 中的 searchtext 链接到 MainActivity？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:40:24.433

在 MAIN.JAVA 中使用 AsyncTask 在 AsyncTask 中你在方法 doInBackground 连接到数据库（使用源 MAINACTIVITY.JAVA）和方法 onPostExecute 更改 MAIN.JAVA

例如

```
private class loudAllTranslate extends
        AsyncTask<Void, Void, HashMap<String, Translate>> {

    Context context;
    String fullText;

    loudAllTranslate(Context cont, String fullText_) {
        context = cont;
        fullText = fullText_;
    }

    @Override
    protected void onPostExecute(HashMap<String, Translate> success) {
        super.onPostExecute(success);

        // do somting

    }

    @Override
    protected HashMap<String, Translate> doInBackground(Void... params) {

        LBD conection = new LBD(context);
        conection.open();
        conection.tblSettings();

        HashMap<String, Translate> listTranstate = Settings
                .updateAllTranslate(fullText);
        conection.close();
        return listTranstate;

    }

} 
```

# php - 在 PHP and MySQL Missing Manuals 2nd Edition 一书中，我收到错误：警告：mysql_connect() [function.mysql-connect]: Access denied for user

> ID：15203975
> 
> 赞同：-2
> 
> 时间：2013-03-04T14:35:34.720
> 
> 标签：php, header, warnings, mysql-connect

我正在使用 zymichost.com 试图按照标题中的书。

这是我得到的错误：

> 警告：mysql_connect() [function.mysql-connect]：/www/zymichost.com/6/5/4/654456/htdocs/ 中的用户 '831445_juzer'@'192.168.1.1'（使用密码：YES）的访问被拒绝第 5 行的 phpMM/connect.php
> 
> 警告：无法修改标头信息 - 标头已由 /www/zymichost.com/6/ 中的（输出开始于 /www/zymichost.com/6/5/4/654456/htdocs/phpMM/connect.php:5）发送5/4/654456/htdocs/phpMM/scripts/app_config.php 第 25 行

这是 app_config.php 文件：

```
<?php

// Set up debug mode
define("DEBUG_MODE", true);

// Site root
define("SITE_ROOT", "/phpMM/");

// Database connection constants

define ("DATABASE_HOST", "xxxxx");
define ("DATABASE_USERNAME", "xxxxx");
define ("DATABASE_PASSWORD", "xxxxxx");
define ("DATABASE_NAME", "xxxxxx");

// function debug print

function debug_print($message) {
   if (DEBUG_MODE) {
      echo $message;
   }
}

function handle_error($user_error_message, $system_error_message) {
   header("Location: show_error.php?" . "error_message={$user_error_message}&" . "system_error_message={$system_error_message}");
   exit();
}

?> 
```

这是connect.php代码：

```
<?php 

require_once 'scripts/app_config.php';

if (!mysql_connect(DATABASE_HOST, DATABASE_USERNAME, "foo")) { handle_error("There was a problem connecting to the database " . "that holds the information we need to get you connected.", mysql_error());
}

echo "<p>Connected to MySQL!</p>";

if (!mysql_select_db(DATABASE_NAME)) {
handle_error("There's a configuration problem with our database.", mysql_error());
}

echo "<p>Connected to MySQL, using database " . DATABASE_NAME . ".</p>";

$result = mysql_query("SHOW TABLES;");

if (!$result) {

handle_error("There's a problem looking up information in our database.", "Error in listing tables: " . mysql_error());

}

echo "<p>Tables in database:</p>";
echo "<ul>";
while ($row = mysql_fetch_row($result)) {
echo "<li>Table: {$row[0]}</li>";
}
echo "</ul>";

?> 
```

最初我认为这是一个空白问题，但我想事实并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:42:58.027

拒绝访问意味着您的凭据错误。检查哪些凭据对您的数据库有效，并将它们输入到 app_config.php 中。

# objective-c - NSComboBox - 陷阱返回键

> ID：15203984
> 
> 赞同：1
> 
> 时间：2013-03-04T14:35:56.223
> 
> 标签：objective-c, xcode, nscombobox

在我的应用程序中，我显示了一个带有 NSComboBox 的工作表。如果用户使用箭头键从菜单中选择一个条目，然后 Return 选择它，则工作表的 OK 按钮也会被操作，因为它具有 Return 作为其等效键。我想停止这些 Return 键充当 OK 点击。在尝试了很多事情之后（除了子类化 NSComboBox 开始变成一场噩梦）如果组合框是第一响应者并且当前事件是返回键键，我试图忽略 OK 点击，但是 NSPanel sheet 是从始终返回自身作为当前第一响应者的子类。我期待一个字段编辑器，但我得到的只是 NSPanel。
1）有没有更好的方法来做到这一点？用户真的想要基于键盘的数据输入而不是鼠标。
2）如果这是最好的方法，我怎么知道组合框是第一响应者？
任何帮助都欣然接受。以前肯定处理过吗？
安迪牧师

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-19T15:05:01.807

有一个解决方法，它不是很漂亮，但它会起作用：

注册两个通知**NSComboBoxWillPopUpNotification**和**NSComboBoxWillDismissNotification**。

```
- (void)comboBoxWillPopUp:(NSNotification *)notification
{
    okButton.keyEquivalent = @"";
}

- (void)comboBoxWillDismiss:(NSNotification *)notification
{
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 0), dispatch_get_main_queue(), ^{
        okButton.keyEquivalent = @"\r";
    });
} 
```

# ios - iOS GoogleMaps SDK - animateToCameraPosition 动画完成处理程序？

> ID：15203991
> 
> 赞同：13
> 
> 时间：2013-03-04T14:36:17.220
> 
> 标签：ios, animation, google-maps-mobile, google-maps-sdk-ios

目前我正在使用适用于 iOS 的 GoogleMaps SDK 进行各种操作。打电话时

```
[self.googleMapsView animateToCameraPosition:[GMSCameraPosition 
                            cameraWithLatitude:LATITUDE
                                     longitude:LONGITUDE
                                          zoom:ZOOM]]; 
```

是否有一个完成处理程序来确定动画是否完成？

当然，我会收到有关 cameraPosition 的 GMSMapViewDelegate 更新，但我应该如何检查动画是否完成？

```
- (void)mapView:(GMSMapView *)mapView 
didChangeCameraPosition:(GMSCameraPosition *)position; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-07-27T12:04:55.460

为了给这篇文章的未来读者提供参考，2013 年 7 月发布的适用于 iOS 的 Google Maps SDK 1.4.0 版添加了一个新的委托方法**mapView:idleAtCameraPosition:**它将在任何相机移动结束时触发 - 无论是像程序动画这样的在这个问题或用户触发的动作中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-19T08:59:04.387

这可能有效（我没有尝试过）：

```
[CATransaction begin];
[CATransaction setValue:[NSNumber numberWithFloat: 1.0f] forKey:kCATransactionAnimationDuration];
[self.googleMapsView animateToCameraPosition:[GMSCameraPosition 
                        cameraWithLatitude:LATITUDE
                                 longitude:LONGITUDE
                                      zoom:ZOOM]];
[CATransaction setCompletionBlock:^{
    // ... whatever you want to do when the animation is complete
}];
[CATransaction commit]; 
```

基本上，这会创建一个动画事务，为您的相机移动设置动画（更改值`numberWithFloat:`以更改速度），然后您设置自己的完成块，说明动画结束时您想要做什么。 `[CATransaction commit]`是什么触发了动画。

注意：此答案部分基于[此答案](https://stackoverflow.com/a/15663039/129475)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T00:42:19.297

我不相信有，但是...

到目前为止对我来说效果很好的一种方法是在位置停止更新后不久（非常）设置一个计时器：

```
- (void)mapView:(GMSMapView*)mapView didChangeCameraPosition:(GMSCameraPosition*)position {
  // _panTimer is an instance variable of the delegate.
  [_panTimer invalidate];
  _panTimer = [NSTimer timerWithTimeInterval:0.2
                                      target:self
                                    selector:@selector(_mapHasStoppedMoving)
                                    userInfo:nil
                                     repeats:NO];
  [[NSRunLoop currentRunLoop] addTimer:_panTimer forMode:NSDefaultRunLoopMode];
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-02T14:40:22.847

我最近遇到了谷歌动画方法缺少完成处理程序的问题。
到目前为止，我发现的最佳解决方案是通过 CATransation API 附加我自己的完成处理程序。

```
private func attachCompletionHandlerToGoogleAnimations(@noescape animations: () -> Void, #completion: (() -> Void)!) {
    CATransaction.begin()
    CATransaction.setCompletionBlock(completion)
    animations()
    CATransaction.commit()
} 
```

示例用法：

```
attachCompletionHandlerToGoogleAnimations({
    googleMapView.animateToLocation(coordinate)
}) {
    println("camera moved to location \(coordinate)")
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-12T22:45:11.330

SWIFT 版本示例：

```
let vancouver = CLLocationCoordinate2D(latitude: 49.26, longitude: -123.11)
let calgary = CLLocationCoordinate2D(latitude: 51.05,longitude: -114.05)
let bounds = GMSCoordinateBounds(coordinate: vancouver, coordinate: calgary)
let cameraPosition = GMSCameraUpdate.fit(bounds)

CATransaction.begin()
CATransaction.setValue(1.0/*duration in seconds*/, forKey: kCATransactionAnimationDuration)
CATransaction.setCompletionBlock({
    print("animation complete, do whatever you want here")
})
mMapView.animate(with: cameraPosition)
CATransaction.commit() 
```

# javascript - 从数组中找到最接近不同数字的数字

> ID：15203994
> 
> 赞同：4
> 
> 时间：2013-03-04T14:36:25.830
> 
> 标签：javascript, jquery, arrays, numbers

示例：我有一个这样的数组：`[0,22,56,74,89]`我想找到最接近不同数字的数字。假设数字是`72`，在这种情况下，数组中最接近的数字是`56`，所以我们返回它。如果数字是`100`，那么它大于数组中的最大数字，所以我们返回最大的数字。如果数字是`22`，那么它是完全匹配的，只需返回即可。给定的数字永远不会低于 0，并且数组始终是排序的。

我确实看到[了这个问题](https://stackoverflow.com/questions/3561275/using-jquery-how-would-i-find-the-closest-match-in-an-array-to-a-specified-num)，但它返回最接近向上或向下的数字。无论如何，我必须让最近的一个向下返回。

我该如何开始？我应该使用什么逻辑？

最好不要太多循环，因为我的代码每秒运行一次，而且它已经足够占用 CPU。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T14:44:08.883

```
var theArray = [0,22,56,74,89];
var goal = 56;
var closest = null;

$.each(theArray, function(){
  if (this <= goal && (closest == null || (goal - this) < (goal - closest))) {
    closest = this;
  }
});
alert(closest); 
```

jsFiddle [http://jsfiddle.net/UCUJY/1/](http://jsfiddle.net/UCUJY/1/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T14:46:02.263

您可以对该值使用[二进制搜索。](http://en.wikipedia.org/wiki/Binary_search_algorithm)改编自[这个答案](https://stackoverflow.com/a/14370245/1048572)：

```
function index(arr, compare) { // binary search, with custom compare function
    var l = 0,
        r = arr.length - 1;
    while (l <= r) {
        var m = l + ((r - l) >> 1);
        var comp = compare(arr[m]);
        if (comp < 0) // arr[m] comes before the element
            l = m + 1;
        else if (comp > 0) // arr[m] comes after the element
            r = m - 1;
        else // arr[m] equals the element
            return m;
    }
    return l-1; // return the index of the next left item
                // usually you would just return -1 in case nothing is found
}
var arr = [0,22,56,74,89];
var i=index(arr, function(x){return x-72;}); // compare against 72
console.log(arr[i]); 
```

顺便说一句：这是一个[快速的性能测试](http://jsperf.com/test-a-closest-number-function/3)（改编自 @Simon 的测试），它清楚地展示了二分搜索的优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T14:51:03.643

这是一个没有 jQuery 的解决方案，可以提高效率。如果数组始终是排序的，则可以工作，无论如何都可以很容易地覆盖：

```
var test = 72,
    arr = [0,56,22,89,74].sort(); // just sort it generally if not sure about input, not really time consuming

function getClosestDown(test, arr) {
  var num = result = 0;

  for(var i = 0; i < arr.length; i++) {
    num = arr[i];
    if(num <= test) { result = num; }
  }

  return result;
} 
```

逻辑：从最小的数字开始，`result`只要当前数字小于或等于测试单元就设置。

注意：只是出于好奇做了一些[性能测试:)。](http://jsperf.com/test-a-closest-number-function)在不声明函数的情况下将我的代码精简到基本部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-04T15:00:16.803

```
Array.prototype.getClosestDown = function(find) {            
    function getMedian(low, high) {
       return (low + ((high - low) >> 1));
    }

    var low = 0, high = this.length - 1, i;  

    while (low <= high) {
     i = getMedian(low,high);
     if (this[i] == find) { 
         return this[i]; 
     }        
     if (this[i] > find)  { 
         high = i - 1;
     }
     else  { 
         low = i + 1;
     }
  }  
  return this[Math.max(0, low-1)];
}

alert([0,22,56,74,89].getClosestDown(75)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-18T10:27:20.943

这是一个使用reduce的ES6版本，OP引用。受此答案的启发，[从数组中获取最接近的数字](https://stackoverflow.com/questions/8584902/get-closest-number-out-of-array#answer-19277804)

查找数组总是排序的，所以这很有效。

```
const nearestBelow = (input, lookup) => lookup.reduce((prev, curr) => input >= curr ? curr : prev);
const counts = [0,22,56,74,89];
const goal = 72;
nearestBelow(goal, counts); // result is 56. 
```

不如二分搜索快（很长一段路），但比循环和 jQuery grep [https://jsperf.com/test-a-closest-number-function/7都好](https://jsperf.com/test-a-closest-number-function/7)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T15:18:12.273

正如我们知道数组已排序，我会将断言小于我们给定值的所有内容推送到临时数组中，然后返回其中的一个弹出窗口。

```
var getClosest = function (num, array) {
    var temp = [],
        count = 0,
        length = a.length;

    for (count; count < length; count += 1) {

        if (a[count] <= num) {
            temp.push(a[count]);
        } else {
            break;
        } 
    }

    return temp.pop();
}

getClosest(23, [0,22,56,74,89]); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-15T18:09:27.033

这里是从@Simon 编辑的。它比较前后最接近的数字。

```
var test = 24,
arr = [76,56,22,89,74].sort(); // just sort it generally if not sure about input, not really time consuming

function getClosest(test, arr) {
  var num = result = 0;
  var flag = 0;
  for(var i = 0; i < arr.length; i++) {
    num = arr[i];
    if(num < test) {
      result = num;
      flag = 1;
    }else if (num == test) {
      result = num;
      break;
    }else if (flag == 1) {
      if ((num - test) < (Math.abs(arr[i-1] - test))){
        result = num;
      }
      break;
    }else{
      break;
    }
  }
  return result;
} 
```