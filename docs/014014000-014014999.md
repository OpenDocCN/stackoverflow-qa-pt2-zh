# StackOverflow 问答 14014000-14014999

# google-api - 谷歌驱动器“无法同步”如何以编程方式知道？

> ID：14014000
> 
> 赞同：1
> 
> 时间：2012-12-23T19:24:14.053
> 
> 标签：google-api

我所看到的是我们公司经常“无法同步”，而且这个问题已经存在了几个月。如果这应该被修复，它不可能从谷歌获得任何信息..？每次重新启动 Google Drive 时，问题似乎都得到了解决，但由于没有人真正监控这一点，因此这种同步可能会过时一段时间。

现在我们实际上正在考虑创建一个应用程序来尝试查看 Google Drive 的状态，并在同步出现问题时强制重启它。

我已经看到可以将 Google Drive 日志记录到“%LOCALAPPDATA%\Google\Drive\sync_log.log”，但是必须使用“shift-click on icon and select Diagnostics”从 GUI 触发它。还有其他方法可以强制 Google Drive 在启动时登录吗？

这样我们就可以跟踪日志，如果我们看到“无法同步”，我们会关闭进程并从另一个程序重新启动它。

或者有没有更好的解决方案，不需要人手动执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T12:19:14.843

我们通过创建一个应用程序来解决这个问题，该应用程序通过它自己使用他们的 API 在云和硬盘驱动器之间同步这些文件。

# android - 为什么无法从 android 蓝牙客户端发现蓝牙模块？

> ID：14014002
> 
> 赞同：0
> 
> 时间：2012-12-23T19:24:16.363
> 
> 标签：android, bluetooth, rfcomm

我已经在[这个例子](http://jayxie.com/mirrors/android-sdk/resources/samples/BluetoothChat/index.html)中使用了安卓蓝牙通信的代码，它在两个安卓设备上都可以正常工作。

但我有一个使用这个[蓝牙模块](http://www.parallax.com/tabid/768/productid/550/default.aspx)的硬件。该设备被 J2ME 应用程序发现。但是在使用之前的android应用程序搜索它时，应用程序找不到蓝牙模块。问题是什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T12:03:36.907

您必须更改蓝牙模块的类别。一些 android 操作系统阻止类 id 0

# php - 加载时显示页面

> ID：14014004
> 
> 赞同：1
> 
> 时间：2012-12-23T19:24:25.180
> 
> 标签：php, javascript, jquery, hide, show

我尝试了多种解决方案，但对我来说没有任何效果。我试过这个：

```
<script type="text/javascript">
$('body').hide();
$(document).ready(function() {
    $('body').show();
});
</script> 
```

与 ：

```
$(window).load(function() {. 
```

页面加载就像它不存在一样。

有人有真正有效的代码吗？

帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T19:30:54.163

可以在 head 中添加一个脚本标签，该标签将创建一个样式标签以使用 css 隐藏正文。使用脚本创建样式标签意味着如果禁用 js，使用默认 css 隐藏正文不会影响用户

```
<script>
/* place in head tag so it fires before body is present*/
document.write('<style>body{display:none}</style>')

</script> 
```

然后使用 jQuery 在准备好的处理程序中显示。

如果问题与需要加载图像有关，这里有很多帖子来创建图像预加载脚本，一旦加载所有图像，您就可以使用它来显示正文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:34:08.450

我想你是那个意思

```
 <script>  document.write('<style>body{display:none}</style>') </script>  // in head tag
       <script type="text/javascript">

      $(window).load(function() {
   $('body').show();
  });
     </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:37:34.123

为什么不能一开始就设置`display:none`在正文中：

```
<body style="display:none;"> 
```

然后在`script`标签中你会显示它：

```
<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    </head>
    <body style="display:none;">
        <p>Text</p>
        <script type="text/javascript">
        $(document).ready(function(){$('body').show();});
        </script>
    </body>
</html> 
```

# python - 使用类创建 png 图像

> ID：14014007
> 
> 赞同：0
> 
> 时间：2012-12-23T19:24:36.307
> 
> 标签：python, image, python-3.x, png

我要做的是使用指定的参数创建一个 png 图像，例如：

> ```
> img = Image(200, 100, Color(0, 0, 255))
> h_line(img, 20, Color(255, 0, 0))
> c = img.get_pixel(20, 20)
> c.b = 200
> img2 = img.copy()
> h_line(img, 40, Color(255, 0, 0))
> save('file01_01_out.png', img) 
> ```

这是我到目前为止写的：

```
 import png

class Color(object):
    def __init__(self, r, g, b):
        self.r = r
        self.g = g
        self.b = b

    def copy(self):
        return Color(self.r, self.g, self.b)

class Image(object):
    #'''Class must have height and width attributes'''
    def __init__(self, width, height, c):
        self.width = width
        self.height = height
        self.c = Color
        #'''Initializes the image with width, height and every pixel with copies of c
       # c being an object of Color type'''
 #    

    def set_pixel(self, x, y, c):
        self.img.put("{" + c +"}", (x, y))
       # '''Sets the color in position (x, y) with a copy of object
        #    c of type Color. If the position (x, y) is beyond the
        #    object, then it won't do anything'''

    def get_pixel(self, x, y):
        value = self.img.get(x,y) 
        if type(value) ==  type(0):
            return [value, value, value]
        else:
            return None 
#        '''Returns a copy of the color (Color type) in position
#           (x, y). If (x, y) is beyond the picture, it will return
#           None'''

    def copy(self):
        return Image(self.width, self.height, self.c)

def h_line(img, y, c):
    for x in range(img.width):
        img.set_pixel(x, y, c)

def save(filename, img):
    png_img = []
    for i in range(img.height):
        png_row = []
        for j in range(img.width):
            c = img.get_pixel(j, i)
            png_row.extend([c.r, c.g, c.b])
        png_img.append(png_row)
    with open(filename, 'wb') as f:
        png.Writer(img.width, img.height).write(f, png_img) 
```

问题是程序不会崩溃，但它不会保存任何东西！我尝试了不同的示例，但结果始终相同。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:54:58.173

**更新 - 刚刚注意到 Py3 标签 - 所以答案可能无效 - 但可能有一些用途**

例如 - 使用[PIL](http://www.pythonware.com/products/pil/) - 您可以创建具有特定 RGB 颜色的 200x200 图像，然后使用`.png`扩展名保存它......

```
>>> from PIL import Image
>>> img = Image.new('RGB', (200, 200), (127, 127, 127))
>>> img.save('/path/to/some/file.png') 
```

给你：

![示例图片](../Images/fc0d66f05596a248d8a6685ebfa96dda.png)

# php - 我需要一些帮助来优化读取 php 类中的注释的代码

> ID：14014013
> 
> 赞同：0
> 
> 时间：2012-12-23T19:25:10.233
> 
> 标签：php, regex, optimization, annotations

我用一个静态方法编写了这个类，该方法读取注释并将它们转换为一个数组。所以，这段代码：

```
/**
 * @MyAnnotation(attr1=value,attr2=value);
 */
class MyClass
{

    public static function readMyAnnotation()
    {
        $classComment = (new ReflectionClass(get_class()))->getDocComment();
        $comments = explode("\n", $classComment);
        foreach ($comments as $item) {
            if(strpos($item, "@")) {
                $comment = explode("@", $item);
                $annotation = explode(")", $comment[1])[0];
                $annotationName = explode("(", $annotation)[0];
                $annotationValue = explode("(", $annotation)[1];
                $annotationParams = explode(",", $annotationValue);
                $params = [];
                foreach ($annotationParams as $item) {
                    $params[explode("=", $item)[0]] = explode("=", $item)[1];
                }
                print_r([$annotationName => $params]);
            }
        }
    }

}

MyClass::readMyAnnotation(); 
```

将输出：

```
Array ( [MyAnnotation] => Array ( [attr1] => value [attr2] => value ) ); 
```

有人可以帮助我使用正则表达式优化此代码吗？我无法用正则表达式编写好的代码。我的代码工作正常，但我不喜欢它！

```
/**
 * @MyAnnotation(attr1=value,attr2=value);
 */
class MyClass
{

    public static function readMyAnnotation()
    {
        $classComment = (new ReflectionClass(get_class()))->getDocComment();
        $comments = explode("\n", $classComment);
        foreach ($comments as $item) {
            if(strpos($item, "@")) {
                /* ?????????????? */
                print_r([$annotationName => $params]);
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:22:03.130

您可以使用 php 函数`preg_match`，它将匹配的子字符串存储在括号`(.*)`中`$match_name[1]`：

```
preg_match("/\@(.*)\(/",$item,$match_name);
$annotationName = $match_name[1];
preg_match("/\((.*)\)/",$item,$match_values);
$values = explode(",",$match_values[1]);
foreach ($values as $value) {
  $exploded = explode("=", $value);
  $params[$exploded[0]] = $exploded[1];
} 
```

# c++ - 在函数上输入智能感知？

> ID：14014014
> 
> 赞同：0
> 
> 时间：2012-12-23T19:25:21.597
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012

如何在我的函数中输入智能感知信息？在 VS2010 上使用 C#，我只是在函数前面使用了“///”，它会自动创建一个模板。在 C++ VS2012 上，我什么都做不了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:04:59.453

如果您正在谈论功能的文档，您可以使用像 GhostDoc 这样的扩展。

链接： [http ://submain.com/products/ghostdoc.aspx](http://submain.com/products/ghostdoc.aspx)

您可以指定一个快捷方式（默认为 ctr + shift + d），它会自动使用模板记录函数，它还会尝试根据函数名称猜测函数的作用。

这是一个幽灵文档的例子：

```
/// <summary>
/// Initialize a complex number with a real and imaginary part.
/// </summary>
/// <param name="real">The real.</param>
/// <param name="imaginary">The imaginary.</param>
public Complex(double real, double imaginary)
{
    this.real = real;
    this.imaginary = imaginary;
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T22:27:21.510

查看 Visual Studio 中的 XMLDoc 注释功能：http: [//msdn.microsoft.com/en-US/library/ms177226 (v=vs.100).aspx](http://msdn.microsoft.com/en-US/library/ms177226(v=vs.100).aspx)

# node.js - 在 express.js 中，req.files 未定义

> ID：14014017
> 
> 赞同：9
> 
> 时间：2012-12-23T19:25:29.497
> 
> 标签：node.js, upload, express

我尝试将 png 上传到我的 node.js 服务器，但每次`req.files.avatar`调用时，都会出现错误并显示`TypeError: Cannot read property 'avatar' of undefined`。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-24T11:21:47.370

问题是我没有写`enctype="multipart/form-data"`表格。这就是 req.files 未定义的原因。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-06T22:49:01.200

此外，我认为您必须在使用 app.router 或静态中间件的任何说明**之前包含您的 bodyParser。**经过反复试验，这是适合我的顺序。

```
app.configure(function(){
    app.set('port', process.env.port || 3000);
    app.set('views', __dirname + '/app/server/views');
    app.set('view engine', 'jade');
    app.locals.pretty = true;
    app.use(express.favicon());
    app.use(express.bodyParser( { keepExtensions: true, uploadDir: __dirname + '/app/uploads' } ));
    app.use(express.methodOverride());
    app.use(express.cookieParser());
    app.use(express.session({ secret: 'super-duper-secret-secret' }));
    app.use(app.router);
    app.use(require('stylus').middleware({ src: __dirname + '/app/public' }));
    app.use(express.static(__dirname + '/app/public'));
}); 
```

# java - 元素在点 (693, 14) 处不可点击。其他元素会收到点击：仅使用 Chrome 驱动程序

> ID：14014018
> 
> 赞同：3
> 
> 时间：2012-12-23T19:25:36.637
> 
> 标签：java, selenium, selenium-webdriver

大家好，我正在使用 selenium 支持的 webdriver 我正在自动化一些第三方站点，所以我无法访问该站点的**代码在点 (693, 14) 处不可点击。其他元素会收到**我在某些博客上阅读的点击，即使用代码行使问题解决，下面给出的行

```
WebElement elementToClick = driver.findElement(By.id("create_item_button"));
((JavascriptExecutor)driver).executeScript("window.scrollTo(0," + elementToClick.getLocation().y + ")");
elementToClick.click(); 
```

但这无济于事，任何人都可以建议我解决我的代码如下所示

```
 selenium.click("//img[@alt='Upload']");
    selenium.click("link=basic uploader");
            WebElement fileUpload = driver.findElement(By.id("file-box"));

    ((JavascriptExecutor)driver).executeScript("window.scrollTo(0,"+fileUpload.getLocation().y+")");

    Thread.sleep(1000);
    fileUpload.sendKeys("C:\\Users\\Shoaib\\Desktop\\kkk.java"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-23T23:53:13.173

您可以将鼠标移动到元素的位置，然后单击，使用操作：

```
Actions builder = new Actions(driver);   
builder.moveToElement([VisibleElementThatIsNearby], [XOffset], [YOffset])
    .click()
    .build()
    .perform(); 
```

where`VisibleElementThatIsNearby`是您可以毫无问题地识别的元素，`XOffset`是您需要从那里移动以单击元素的左/右量，以及`YOffset`您需要向上/向下移动以单击元素的量。

# ruby - 使用 Wordnet Gem - Wordnet::Lexicon.new 给出 NameError

> ID：14014019
> 
> 赞同：0
> 
> 时间：2012-12-23T19:25:51.697
> 
> 标签：ruby, nlp, wordnet

我刚刚安装了[wordnet gem](https://github.com/ged/ruby-wordnet)和[wordnet-defaultdb](http://rubygems.org/gems/wordnet-defaultdb) gem 。当我尝试使用 WordNet::Lexicon.new 命令创建新词典时，出现名称错误。Lexicon 也不显示为 WordNet 的子类。

我花了一整天的时间试图弄清楚这一点。这是安装问题吗？如果有人可以指导我或指导我如何安装 wordnet gem。

我正在使用 MRI-1.9.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T04:06:54.300

使用 WordNet gem 遇到了类似的问题。wordnet-defaultdb gem 依赖于两个依赖项：sqlite3，它应该是标准的，以及 wordnet 本身。将 gem "wordnet", "~> 1.0.0" 添加到您的 gemfile 中，wordnet-defaultdb gem 现在应该可以正常工作了。

# javascript - 如何检查 JQuery 中的所有复选框？

> ID：14014026
> 
> 赞同：3
> 
> 时间：2012-12-23T19:26:28.610
> 
> 标签：javascript, jquery, html, checkbox, webforms

我是 jQuery 的初学者，我知道以前有人问过这个问题，但我不知道为我的 HTML 做这件事的正确方法是什么：

```
<fieldset>
    <legend>ABC</legend>
    <label class="selectAllButton"><input type="checkbox" onclick="SelectAll(this)" />(select all)</label><br />
    <table>

            <tr>
            <td>
                <input id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_0" type="checkbox" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl00$chkItem" /><label for="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_0">Discs</label>
                <input type="hidden" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl00$pgNos" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_pgNos_0" value="9;71;72;108;109" />
                <input type="submit" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl00$btnXRefs" value="x-refs" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_btnXRefs_0" class="xRefButton" />
            </td>
            </tr>

            <tr>
            <td>
                <input id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_1" type="checkbox" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl01$chkItem" /><label for="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_1">Drums</label>
                <input type="hidden" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl01$pgNos" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_pgNos_1" value="73" />
                <input type="submit" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl01$btnXRefs" value="x-refs" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_btnXRefs_1" class="xRefButton" />
            </td>
            </tr>

            <tr>
            <td>
                <input id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_2" type="checkbox" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl02$chkItem" /><label for="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_chkItem_2">Pads</label>
                <input type="hidden" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl02$pgNos" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_pgNos_2" value="70" />
                <input type="submit" name="ctl00$MainContentPlaceHolder$CategoryRepeater$ctl00$ItemRepeater$ctl02$btnXRefs" value="x-refs" id="MainContentPlaceHolder_CategoryRepeater_ItemRepeater_0_btnXRefs_2" class="xRefButton" />
            </td>
            </tr>

    </table>
</fieldset> 
```

我希望点击它：

```
<label class="selectAllButton"><input type="checkbox" onclick="SelectAll(this)" />(select all)</label><br /> 
```

`table`并为选中或未选中的所有复选框。

我试过了 ：

```
// selects all the items in same category
function SelectAll()
{
    $(arguments[0]).siblings('table:eq(0)').find(':checkbox').attr('checked', arguments[0].checked);
} 
```

但它没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T19:30:33.233

您可以使用

```
function SelectAll(element)
{
    $(element).closest('fieldset').find('table :checkbox').prop('checked', element.checked);
} 
```

* * *

您的版本不起作用的原因是该表不是全选复选框的兄弟。它是包含该复选框的标签的兄弟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T20:04:56.030

你必须做这样的事情：

```
$('.selectAllButton input').click(function() {
    var checked = $(this).is(':checked');
    var el = $('table input[type=checkbox]');

    if(checked) {
        el.attr('checked', 'checked');
    } else {
        el.removeAttr('checked');
    };
}); 
```

[http://jsfiddle.net/yM9yf/1/](http://jsfiddle.net/yM9yf/1/)

下面的代码看起来不错，更简单，可以工作，但这并不是 W3C 推荐的。我不确定它是否适用于 IE6。

```
$('.selectAllButton input').click(function() {
   var checked = $(this).is(':checked');
   $('table input[type=checkbox]').attr('checked', checked);
});​ 
```

[http://jsfiddle.net/CAYef/](http://jsfiddle.net/CAYef/)

有用的链接： 1\. [W3C 工作草案：输入类型=复选框](http://www.w3.org/TR/html-markup/input.checkbox.html) 2\. [W3C Wiki：复选框](http://www.w3.org/wiki/HTML/Elements/input/checkbox) 3\. [MSDN：选中属性](http://msdn.microsoft.com/en-us/library/ie/ms533556%28v=vs.85%29.aspx) 4\. [MDN：输入](https://developer.mozilla.org/en-US/docs/HTML/Element/Input)

我希望这可以帮助你。

# html - 响应式 Twitter 引导程序：当宽度 < 767/768px 时出现导航栏右侧填充/边距

> ID：14014028
> 
> 赞同：3
> 
> 时间：2012-12-23T19:26:48.080
> 
> 标签：html, css, twitter-bootstrap, responsive-design, bootstrap-sass

当我将窗口的大小调整到 767/768 像素以下时，主体和导航栏会得到一个奇怪的右边距/填充（每个 20 像素；导航栏右侧总共有 40 个白色像素）。我找不到这是正常行为还是我做错了什么。

css 大小/填充/边距引导覆盖的唯一片段是：

```
.navbar { margin-bottom: 20px; } 
```

这里是 HTML：

```
<body>
  <header class='navbar navbar-static-top'>
    <nav class='navbar-inner'>
      <div class='container'>
        <a class='btn btn-navbar' data-target='.nav-collapse' data-toggle='collapse'>
          <div class='icon-bar'></div>
          <div class='icon-bar'></div>
          <div class='icon-bar'></div>
        </a>
        <a href="/" class="brand">Brand Name</a>
        <div class='nav-collapse collapse'>
          <ul class='nav'>
            <li><a href="...">...</a></li>
            <li><a href="...">...</a></li>
            <li><a href="...">...</a></li>
          </ul>
          <form accept-charset="UTF-8" action="/search" class="navbar-search pull-right" method="get">
            <input class="search-query" id="q" name="q" placeholder="Search" type="text" />
            <input class="hidden" type="submit" value="Find" />
          </form>
        </div>
      </div>
    </nav>
  </header>
  <div class='container'>
    <div class='row'>
      <div class='span12'>
        <!-- ... -->
      </div>
    </div>
  </div>
</body> 
```

我使用带有导轨的 bootstrap-sass gem。我不确定`.container`角色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:38:52.787

我没有找到任何东西，所以我写了这个黑客：

```
@media (max-width: 767px) { body { padding-left: 0; padding-right: 0; } } 
.navbar { margin-left: 0; margin-right: 0; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:28:04.863

检查该媒体查询的主体上的填充。同样对于黑客尝试将以下代码添加到处理该大小的媒体查询中：

```
 .navbar-inner{
    left: 0x;
 } 
```

# javascript - jQuery - 像 Windows 8 开始屏幕一样滚动时为背景图像设置动画的可能插件或方法？

> ID：14014033
> 
> 赞同：0
> 
> 时间：2012-12-23T19:27:45.483
> 
> 标签：javascript, jquery, css, background, jquery-animate

我注意到在 Windows 8 开始屏幕中，滚动背景图像时会以相反的方式拖动。我想知道是否有 jQuery 动画插件或方法（或 CSS，如果可能）可以在网页中完成此操作。我试过寻找，但可惜没有找到这样的东西……但 jQuery 似乎总是能解决所有问题。

任何帮助将不胜感激！:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:36:49.750

好吧，您可以使用[jQuery 视差](http://stephband.info/jparallax/)插件，或者如果愿意，也可以自己编写 - 我有一篇关于如何将[垂直视差滚动](http://wowmotty.blogspot.com/2011/04/vertical-parallax.html)添加到页面的博客文章。

# java - 从麦克风或音频文件中识别拨号音

> ID：14014036
> 
> 赞同：2
> 
> 时间：2012-12-23T19:27:59.733
> 
> 标签：java, audio, signal-processing, fft

我用谷歌搜索了很多，但没有成功解决我的问题。我需要识别 wav 文件中或直接来自麦克风的拨号音，或者更好：检测线路（直接连接到声卡的线路输入）是否空闲。

在我的国家（意大利），拨号音是 425 Hz 的声波。我的想法是从 mic 将 2s 录音注册到 wav 文件中，然后加载数据并应用离散 FFT，然后在结果中搜索该频率。但是我不知道要编写什么代码。

我有一些问题：1）使用哪个 DFT 库 2）字节和双精度之间的转换 3）转换完成后，如何从复杂数组中检测是否存在所需频率

欢迎使用代码示例！

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:46:43.870

检测特定音调是否存在的最简单方法是[Goertzel 滤波器](http://en.wikipedia.org/wiki/Goertzel_algorithm)。这有效地仅在感兴趣的频率上评估 DFT，这比评估完整的 FFT 然后丢弃除一个输出 bin 之外的所有数据更简单且计算成本更低。

有很多关于使用 Goertzel 算法进行音调检测的问题和答案，例如 DTMF 检测 - 您可能想研究其中的一些，因为它们包含有用的信息和示例代码。

# css - 如何在 tinyMCE 编辑器中突出显示短代码

> ID：14014039
> 
> 赞同：9
> 
> 时间：2012-12-23T19:28:03.973
> 
> 标签：css, tinymce, shortcode

我在 tinyMCE 编辑器中有短代码，它们用括号括起来，如下所示：

```
[my_shortcode]some text that gets parsed by my shortcode function[/my_shortcode] 
```

是否可以将运行时样式的 css 应用于 tinyMCE 编辑器内容，以便括号中的任何元素（在我的短代码*列表中）获得特殊的 css 处理以使它们脱颖而出？

这个想法是，短代码目前没有特殊的颜色或格式来区分它们与周围的任何文本，除非它们更加突出，否则很难使用它们。

我的简码列表（示例）：

```
[my_shortcode],[my_shortcode_2],[my_shortcode_3] 
```

更新：我将尽我所能，但理想情况下，我只想将样式应用于括号，而不是括号环绕的文本。因此，我只想将运行时 css 样式应用于短代码括号：例如 [my_shortcode] 和 [/my_shortcode] 并保留它们单独包含的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:26:48.567

Problem here is that you cannot apply css to parts of text content of a html element. My solution approch would look like this: You will need to wrap those closed tags into a span with a special class. This way your shortcodes can be highlighted. When you submit your editor content to the server you will have to strip the spans with your special class and replace them with with its textContent.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T14:07:57.743

为简码或其他元素提供突出显示的最佳方法是使用自定义简码菜单，该菜单将列出所有简码并将它们插入突出显示的编辑器区域，或者更好地使用语法突出显示 html、css、javascript 和简码（仅在原始模式下）

~~一个使用 codemirror 的简单解决方案在这里： [http ://nikos-web-development.netai.net/blog/shortcodes-highlighting-overlay-in-codemirror/](http://nikos-web-development.netai.net/blog/shortcodes-highlighting-overlay-in-codemirror/)~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:02:36.943

如果输入了方括号，您可以点击按键事件并添加格式。

[http://www.tinymce.com/tryit/3_x/setup_editor_events.php](http://www.tinymce.com/tryit/3_x/setup_editor_events.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-17T08:46:48.467

在文本编辑器中突出显示短代码长期以来一直是一个未解决的大问题。最后有一个插件可以做到这一点。

[HTML 编辑器语法高亮插件](https://de.wordpress.org/plugins/html-editor-syntax-highlighter/)

[![语法高亮 Wordpress 简码](../Images/fc7b07c03ed3a835ed149d6b632b42f1.png)](https://i.stack.imgur.com/gImKo.jpg)

# salesforce - Salesforce 站点需要授权

> ID：14014041
> 
> 赞同：0
> 
> 时间：2012-12-23T19:28:26.067
> 
> 标签：salesforce

我是salesforce 的新手。我在salesforce 中创建了一个站点并面临一条消息需要授权。我想让我的站点公开我应该遵循什么一般方法来公开我的站点？请提供一些相关内容或链接！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:31:20.737

没看懂楼上你说的意思`site`。您是指您的 Salesforce.com*帐户*还是`site`创建了*Force.com 站点*？

对于前一种情况：Salesforce.com 基于 B2B 模式。要让每个用户获得访问权限，您必须在 Salesforce.com 中创建一个用户，并且每个用户都会向您收取许可费（开发人员组织只允许创建 2 个用户）。简单地说，您不能让所有人都可以公开访问您的 Salesforce.com 帐户。

对于后一种情况：Salesforce.com 允许以其他方式创建公共网站——Force.com 站点。您可以在 http://wiki.developerforce.com/page/Sites 找到对 Force.com 站点的介绍，按照[http://wiki.developerforce.com/page/An_Introduction_to_Force](http://wiki.developerforce.com/page/An_Introduction_to_Force.com_Sites)[中](http://wiki.developerforce.com/page/Sites)的说明直接跳转到创建 Force.com 站点[.com_Sites](http://wiki.developerforce.com/page/An_Introduction_to_Force.com_Sites)。

如果您在访问 Force.com 站点时遇到困难，那么您可能没有对用于 Force.com 站点的 Visualforce 页面中使用的资源授予适当的访问权限。

# ruby-on-rails - 下划线模板中 <%% 的用途是什么？

> ID：14014046
> 
> 赞同：0
> 
> 时间：2012-12-23T19:28:55.380
> 
> 标签：ruby-on-rails, templates, backbone.js, underscore.js

有人能告诉我“<%%”“<%”之间的区别吗

```
<%%= hello %>

<%= hello %> 
```

我在谷歌搜索中找不到正确的答案。

任何解释都会有所帮助:)

```
**Index.html**

<div id="container">Loading...</div>
<script type="script/template" id="hello_sen">
<%= hello %>
</script>

**Backbone View**

class Bckbone.Views.EntriesIndex extends Backbone.View

initialize: ->
    @template = _.template($("#hello_sen").html())

render: ->
    datas = {hello: "Senthil"}
    $(@el).html(@template(datas))
    this 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:27:34.043

您在上面发布的屏幕截图中收到错误，因为您在文件中使用`erb`样式下划线模板（默认）`erb`。

`<%`里面的代码`%>`被解析为 Ruby 代码。

您应该使用备用插值字符串，如此[处](http://documentcloud.github.com/underscore/#template)所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T06:27:11.167

Backbone.js 依赖 underscore.js 进行模板化。<% 是下划线的约定。<%% 转义 Rails 的 ERB 标签。您可以更改下划线的设置：

```
 _.templateSettings = {
    interpolate: /\{\{\=(.+?)\}\}/g,
    evaluate: /\{\{(.+?)\}\}/g
}; 
```

或者使用 <%% 逐行转义。转义仍然以 %> 结束

更多信息：[带有 Underscore.js 模板的 Rails](https://stackoverflow.com/questions/7514922/rails-with-underscore-js-templates)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-01T18:56:25.617

我首选的解决方案：将模板移动到部分，并且不要在文件名中包含 .html 之后的 .erb。然后 rails 不会解析该文件中的 ERB。

# java - 以编程方式生成的 EditText 问题

> ID：14014047
> 
> 赞同：0
> 
> 时间：2012-12-23T19:29:00.433
> 
> 标签：java, android, autocomplete, android-edittext, autocorrect

我一直在尝试创建一个打开单词建议的文本编辑器。这就是我一直在做的希望让它工作但到目前为止还没有这样的运气

```
EditText test = (EditText) new EditText(Page.this);
test.setRawInputType(InputType.TYPE_TEXT_FLAG_AUTO_CORRECT);
test.setRawInputType(InputType.TYPE_TEXT_FLAG_MULTI_LINE);
test.setRawInputType(InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE);

LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT, 1);
params.setMargins(5, 0, 5, 0);

test.setLayoutParams(params);
test.setText(text);
test.setId(id);
holder.addView(test); 
```

持有人是容器。Edittext 从该数据库中加载了文本，但我认为这并不重要。一切正常。EditText 加载并且数据库内容很好，这就是我没有发布该部分的原因。我遇到的唯一问题是自动更正或任何形式的自动完成都不起作用。我有一些从 xml 加载的 EditText，它们似乎工作正常。我无法从 xml 加载这些，因为根据用户提供的输入，会生成额外的 EditText，所以我必须以编程方式进行。关于为什么这不起作用有什么建议吗？

是的，我查看了文档，但我似乎也没有在那里找到答案，因为我添加的标志没有起到作用。

意图以编程方式添加启用了自动完成功能的 Edittext

问题：生成了 Edittext，但未将任何文本支持帮助显示为自动完成或更正

提前感谢 StackOverFlow 国家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T19:44:32.080

您调用`setRawInputType()`了三次，这会覆盖前两次调用，而是调用`setRawInputType()`一次并用于`|`传递所有三个标志：

```
test.setRawInputType(InputType.TYPE_TEXT_FLAG_AUTO_CORRECT | 
                     InputType.TYPE_TEXT_FLAG_MULTI_LINE | 
                     InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T01:19:37.967

好吧，我发现你最好的办法是使用一种叫做布局充气机的东西。

这是因为在 xml 中为 Edittext 设置了很多东西。为您的 xml 文件创建此（下）。请注意，您只能有一个 Root 元素。因此，您需要为每个模板创建一个新文件。

请注意，我也有一个 id

使用这个（下）以编程方式插入

```
EditText Stest = (EditText) getLayoutInflater().inflate(R.layout.section_header, null);

<?xml version="1.0" encoding="utf-8"?>
<EditText xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:inputType="textAutoCorrect|textCapWords"
    android:id="@+id/section" >
</EditText> 
```

这样，它将插入并拥有所有默认值以及您创建的任何添加。事实上，由于大多数使用 XML，因此缺乏对服务代码库的支持。

这样，您仍然可以使用代码进行动态插入，但使用 xml 来定义插入的对象/视图的行为方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:46:00.467

如果您想要一个具有自动完成功能的可编辑文本视图，您可能只想立即使用[AutoCompleteTextView](http://developer.android.com/reference/android/widget/AutoCompleteTextView.html)并为自己节省一些实现麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-08T02:36:59.867

为我添加`InputType.TYPE_CLASS_TEXT`作品

# css - 自定义自动 HTML 电子邮件

> ID：14014048
> 
> 赞同：0
> 
> 时间：2012-12-23T19:29:00.467
> 
> 标签：css, google-apps-script, html-email, google-docs-api

提交谷歌表单时如何发送自定义html自动电子邮件？我想让我的公司徽标在顶部，并在电子邮件周围加上边框。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:02:15.940

我的猜测是你得到了负面的分数，因为你的问题太宽泛了，显然你自己完全没有努力去做。但是，嘿，我感受到了你的痛苦，因为我也经历过同样的事情。

我假设您已经知道如何使用表单提交触发器发送包含表单提交数据的电子邮件。我不是专家，但是让它以 html 形式发送的一个很好的起点是使用 html/css 设计器设计您的电子邮件并使其看起来完全符合您的要求，然后将代码复制为脚本中的正文变量：

```
var messageBody = '<html><body style="border:1px solid black"><img src="path-to-logo/logo.jpg" /><h1>Heading</h1><p>You submitted:</p><p>'+[form data]+'.</p></body></html>'; 
```

然后`htmlBody`按照 eggyal 的建议发送电子邮件。为我工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:48:06.217

将`htmlBody`高级参数设置为[`MailApp.sendEmail()`](https://developers.google.com/apps-script/class_mailapp#sendEmail)。

# php - codeigniter 获取行不工作

> ID：14014051
> 
> 赞同：2
> 
> 时间：2012-12-23T19:29:24.153
> 
> 标签：php, codeigniter

我一直在做 CodeIgniter 的教程。现在我只是从数据库中读取一些东西。我已经检查了我从数据库中得到的东西是合法的。然后，我只需将查询结果发送到名为`form`. 现在我要做的`form`就是从查询中提取内容。我收到以下错误：

```
Severity: Notice

Message: Undefined index: Name

Filename: views/form.php

Line Number: 36 
```

这是我的控制器代码：

```
function index()
    {
        $data['reason'] = '';
        $this->load->model('CRUD_Model');
        $data['query']= $this->CRUD_Model->Read('tertiarystudy','Name is not NULL');
        $this->load->view('form',$data);
    } 
```

这是我的视图代码：

```
foreach ($query as $row) 
    {
        echo $row['Name'];

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:47:41.310

尝试使用 print_r 结果，

```
 foreach ($query as $row) {
      echo '<pre>';
      print_r($row);
      echo '</pre>'; 

      // if you get result a array, format array is $row['namefield'].
      // if you get result a object, format object is $row->namefield.
      // if you not get any result, you must check code in controller n model again.
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T19:51:09.917

请在你看来试试这个..

```
foreach ($query as $row) 
    {
        echo $row[0]['Name'];

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:42:14.113

您的模型是使用`db->result()`还是`db->result_array()`取回数据？如果是，`result()`那么您的行是`stdClass`. 在这种情况下，请执行以下操作：

```
foreach($query as $row) {
    echo $row->Name;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-08T06:01:29.780

我认为这个示例代码很有用

```
<?php
class Test extends CI_Controller{
    function __construct(){
        parent::__construct();
        $this->load->database();
    }

    public function index(){
        $this->db->select('userid');
        $some = $this->db->get('users_key',1)->result_array();
        var_dump($some);
    }

    // result_array Output
    // array(1) { [0]=> array(1) { ["userid"]=> string(1) "1" } } 

    // result Output
    // array(1) { [0]=> object(stdClass)#15 (1) { ["userid"]=> string(1) "1" } } 

} 
```

# ios - IOS中的容器视图

> ID：14014052
> 
> 赞同：4
> 
> 时间：2012-12-23T19:29:30.720
> 
> 标签：ios

我想使用容器视图来启动另一个视图控制器，但我看不到任何有关如何以编程方式分配它的信息。我可以从用户界面中做到这一点，但如果我想用 coes 创建一个，并将其链接到 UIviewController，我该怎么做？它的行为像普通的 UIview 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-23T19:39:57.563

如果我遵循您的问题，您是在询问如何在代码中使用视图控制器包含。我建议查看*View Controller Programming Guide的*[Creating Custom Container View Controllers](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)部分，它向您展示了执行此操作的代码，包括添加子视图控制器：

 *```
[self addChildViewController:content];                 // 1
content.view.frame = [self frameForContentController]; // 2
[self.view addSubview:self.currentClientView];
[content didMoveToParentViewController:self];          // 3 
```

当使用子视图控制器（至少不占据整个屏幕的）时，`UIView`在父视图控制器的视图上有一个很有用的，它指示子视图控制器的边界。它极大地简化了一堆任务。在上面的代码片段中，他们假设子视图被调用`frameForContentController`。

或删除一个（在此代码段中，`content`是`UIViewController *`引用要删除的子控制器的那个）：

```
[content willMoveToParentViewController:nil];  // 1
[content.view removeFromSuperview];            // 2
[content removeFromParentViewController];      // 3 
```

如果你想用另一个子控制器替换一个子控制器：

```
- (void) cycleFromViewController: (UIViewController*) oldC
                toViewController: (UIViewController*) newC
{
    [oldC willMoveToParentViewController:nil];                        // 1
    [self addChildViewController:newC];

    newC.view.frame = [self newViewStartFrame];                       // 2
    CGRect endFrame = [self oldViewEndFrame];

    [self transitionFromViewController: oldC toViewController: newC   // 3
          duration: 0.25 options:0
          animations:^{
             newC.view.frame = oldC.view.frame;                       // 4
             oldC.view.frame = endFrame;
           }
           completion:^(BOOL finished) {
             [oldC removeFromParentViewController];                   // 5
             [newC didMoveToParentViewController:self];
            }];
} 
```

我还建议查看[WWDC 2011 - Implementing UIViewController Containment](https://developer.apple.com/videos/wwdc/2011/?id=102)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:47:11.027

只需使用父 VC 拥有的普通 UIView 即可。创建一个子 VC 并在 VC 的帮助下将其添加到父 VC `addChildViewController:`，然后将子 VC 的视图作为子视图添加到容器视图 -`addSubview:`在 VC 的`viewDidLoad`方法中。*

# plone - 如何使用 Dexterity 类型的属性作为 url 部分

> ID：14014053
> 
> 赞同：1
> 
> 时间：2012-12-23T19:29:31.363
> 
> 标签：plone, dexterity

我正在用 Dexterity 编写这样的内容类型：

```
class IArticle(form.Schema):

    title = schema.TextLine(
        title=_(u"Name"),
    )

    code = schema.TextLine(
        title=_(u"Code"),
    ) 
```

如果某个用户创建了一篇新文章，将“foo”设置为标题，将“bar”设置为代码，则标题将为“foo”，文章 URL 将为“.../foo”。如何获取内容 URL 为“.../bar”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T22:06:54.523

您想要做的是影响[名称选择器](http://plone.org/products/dexterity/documentation/manual/developer-manual/reference/manipulating-content-objects)，您可以使用界面的[自定义行为来做到这一点。](http://plone.org/products/dexterity/documentation/manual/behaviors/creating-and-registering-behaviors)

子类化`INameForTitle`接口是最简单的：

```
from plone.app.content.interfaces import INameFromTitle
from zope import interface, component

from ..types.interfaces import IArticle

class INameFromCode(INameFromTitle):
    pass

class ArticleCodeAsTitle(object):
    component.adapts(IArticle)
    interface.implements(INameFromCode)

    def __init__(self, context):
        self.context = context

    @property
    def title(self):
        return self.context.code 
```

默认名称选择器尝试使新添加的对象适应`INameForTitle`接口，然后如果成功，将使用该`.title`属性为对象构建新名称。通过实现该接口的子类作为`IArticle`对象的适配器，您可以将标题替换为`.code`字段，从而确保将其用于新名称。

将此注册为：

```
<configure
    xmlns="http://namespaces.zope.org/zope"
    xmlns:plone="http://namespaces.plone.org/plone"
    i18n_domain="your.i18n.domain"
    >

<plone:behavior
    title="ArticleCode"
    description="Use .code as the title when choosing a new object name"
    provides=".articlecode.INameFromCode"
    factory=".articlecode.ArticleCodeAsTitle"
    for="..types.interfaces.IArticle"
    />

</configure> 
```

并将此行为添加到您的`Article`类型定义*而不是*行为`INameFromTitle`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:37:41.363

创建**自定义行为**以将**对象 id**设置为`code` **属性值**：

*   [http://plone.org/products/dexterity/documentation/manual/behaviors/creating-and-registering-behaviors](http://plone.org/products/dexterity/documentation/manual/behaviors/creating-and-registering-behaviors)

# python - 使用python将文件部分加载到内存中

> ID：14014054
> 
> 赞同：0
> 
> 时间：2012-12-23T19:29:39.050
> 
> 标签：python, xml, file

我正在处理一个相当大的 XML 文件，我需要解析和内存使用问题，我正在考虑只读取这个文件的一部分，有没有办法做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:28:35.130

根据您的数据格式，ElementTree（[此处](http://docs.python.org/2/library/xml.etree.elementtree.html)、[此处](http://effbot.org/zone/element-iterparse.htm)）或 lxml（支持 ElementTree API；[此处](http://lxml.de/parsing.html)、[此处](http://www.ibm.com/developerworks/library/x-hiperfparse/)）可能会满足您的需求。它有点混合了面向事件和面向 DOM 的解析器，允许您使用 iterparse() 方法迭代高级子树，依次询问每个子树的内部。

这种方法比 SAX 慢（在我的使用中，我注意到它需要 2-4 倍的时间），但生成的代码最终更容易理解、维护和重用。与直接的 DOM 解析器相比，由于它在迭代期间丢弃访问过的元素，因此内存使用更易于管理。我的经验只是使用内置的 xml.etree.ElementTree 库；lxml 或其他支持 API（或以不同方式执行类似功能）的库将具有不同的特性。

如果您可以轻松地将文档分解成块，ElementTree 可以很好地迭代工作——例如，一个包含数千个产品描述的文档，其中根元素本质上包含一个可以轻松迭代的产品列表。另一方面，如果您的文档仅包含大量非结构化/未解析的数据，那么您可能还有一些工作要做，以使内存使用易于管理。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:27:29.013

我会使用`lxml`和`etree`部分来解析非常大的`xml`文件。

一篇文章，这里有关于该过程的更好解释，[高性能 XML](http://www.ibm.com/developerworks/xml/library/x-hiperfparse/)

[lxml 文档](http://lxml.de/tutorial.html)

这将为您提供`xml`以内存有效的方式快速处理非常大的文件的最佳方法。

# jquery - JQuery可拖动捕捉取消键

> ID：14014058
> 
> 赞同：0
> 
> 时间：2012-12-23T19:30:34.220
> 
> 标签：jquery, triggers, keyboard-shortcuts, jquery-ui-draggable

虽然在 IE 中这适用于 chrome，但它不会：在按下“Ctrl”时，可拖动中的“Snap”选项停止工作，我什至在拖动时按下 ctrl 时似乎都无法收到警报（“SNAP”）。我的尝试是：

```
 $("#object").draggable({
        handle: '#handle_',
        containment: '#MainBody',
        snap: ".drag_alignLines", // Setting snap to alignment lines
        snapTolerance: 15
                            }).bind('keydown', function(event){ 
                        alert("SNAP");
                    if(event.ctrlKey)
                    {
                        alert("hi");
                        this.draggable( "option", "snap", false );
                    }
                }); 
```

拖动时无法让 Chrome 捕捉到 ctrl 键...甚至在 IE 中：“this.draggable("option", "snap", false);" 只是不要让它在拖动时停止捕捉......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:40:55.027

你想要做的是像这样重置 snap 选项：

```
$( "#object" ).draggable( "option", "snap", false ); 
```

并记住在常规点击时将其设置回原始值。这是[此 jsfiddle](http://jsfiddle.net/BYPJz/2/)的相关部分：

```
$("#object").draggable({
containment: '#MainBody',
snapTolerance: 15,
start: function(event)
    {
        if(event.ctrlKey)
        {
            $(this).draggable("option", "snap", false);
        }else {
            $(this).draggable("option", "snap", '.drag_alignLines');
        }

    }}); 
```

它绑定到“start”而不是“keydown”，因此您不必在点击 Control 之前瞄准。

# sencha-touch - 为什么 Sencha Touch 没有同步回调？

> ID：14014068
> 
> 赞同：5
> 
> 时间：2012-12-23T19:32:09.583
> 
> 标签：sencha-touch, sencha-touch-2

一旦商店同步成功完成，我希望能够向用户显示一条消息。但是，似乎没有任何方法可以使用回调或同步调用它。我有点惊讶这不是开箱即用的，因为它一定是一个常见问题。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T16:56:09.573

我们花了很长时间才找到一个合适的解决方案。最后，我们在商店的 write 事件中添加了监听器，似乎工作正常。由于经常需要它，因此已将其添加到商店原型中

```
Ext.data.Store.prototype.syncWithListener = function(onWriteComplete, syncMethod) {

    this.on('write', onWriteComplete, this, {single:true});

    var syncResult = syncMethod ? syncMethod.apply(this) : this.sync();

    if (syncResult.added.length === 0 &&
        syncResult.updated.length === 0 &&
        syncResult.removed.length === 0) {

        this.removeListener('write', onWriteComplete, this, {single:true});
        onWriteComplete(this);    
    }

    return syncResult;
}; 
```

# ios - 如何刷新我从 iOS 中的 google oauth 2.0 获得的令牌

> ID：14014069
> 
> 赞同：8
> 
> 时间：2012-12-23T19:32:25.423
> 
> 标签：ios, post, youtube-api, oauth-2.0

我正在制作一个 iOS 应用程序，它使用用户的 google 帐户从他的 youtube 帐户中获取数据并显示给他们....第一步是使用 gtm2 对用户进行身份验证并获取访问令牌和刷新令牌问题是访问令牌在 60 分钟后过期，我必须登录并再次允许应用程序...我发现您可以使用刷新令牌从文档中获取新的访问令牌：->我的问题是如何发出 POST 请求以获取目标 c 中的访问令牌这是我需要使用的数据：

```
POST /o/oauth2/token HTTP/1.1

Host: accounts.google.com
Content-Type: application/x-www-form-urlencoded

client_id=21302922996.apps.googleusercontent.com&
client_secret=XTHhXh1SlUNgvyWGwDk1EjXB&
refresh_token=1/6BMfW9j53gdGImsixUH6kU5RsR4zwI9lUVX-tqf8JXQ&
grant_type=refresh_token 
```

这是我正在使用的代码：

```
NSString *post =[[NSString alloc] initWithFormat:@"client_secret=%@&grant_type=refresh_token&refresh_token=%@&client_id%@",kGoogleClientSecretKey,kRefreshToken,kGoogleClientIDKey];
    NSLog(@"%@",post);
    NSURL *url=[NSURL URLWithString:@"https://accounts.google.com/o/oauth2/token"];

    NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init] ;
    [request setURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];

    NSError *error;
    NSURLResponse *response;
    NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

    NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];
    NSLog(@"%@",data); 
```

我得到的错误是：{“错误”：“无效请求”}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T15:02:44.027

您的格式字符串中缺少 a `=`。

改变

```
NSString *post =[[NSString alloc] initWithFormat:@"client_secret=%@&grant_type=refresh_token&refresh_token=%@&client_id%@",kGoogleClientSecretKey,kRefreshToken,kGoogleClientIDKey]; 
```

到

```
NSString *post =[[NSString alloc] initWithFormat:@"client_secret=%@&grant_type=refresh_token&refresh_token=%@&client_id=%@",kGoogleClientSecretKey,kRefreshToken,kGoogleClientIDKey]; 
```

# c++ - 野牛和用户类：编译错误

> ID：14014070
> 
> 赞同：0
> 
> 时间：2012-12-23T19:32:33.623
> 
> 标签：c++, compiler-errors, g++, bison, flex-lexer

`C++`我正在尝试使用,`flex`和创建具有简单语法的玩具语言`bison`。我有四个文件：`types.hpp`、`scanner.l`和. 当我试图编译时，对于ld 中的每个函数来说，它已经被定义了。我猜这个问题出在包含指令中。这是我在每个文件开头的内容（我省略了语法内容，因为我认为这不是原因；如果有需要，我会发布它）：`parser.y``Makefile``types.hpp`

// 扫描仪.l

```
%{
#include "parser.hpp"
#include <iostream>
#include <cstring>
#include <cstdlib>
#include <cctype>
#include <string>
using namespace std;

extern "C" {
  int yylex(void);
} /* extern "C" */

char BUFFER[32768];
int POSITION;

%}

%option noyywrap
%x COMMENT
%x BYTESMODE
%x indent
%s normal 
```

// 解析器.y

```
%{
#include <iostream>
using namespace std;

extern "C" {
  int yylex(void);
  int yyparse(void);
  int yywrap() { return 1; }
} /* extern "C" */

void yyerror(const char *error) {
  cerr << error << endl;
} /* error handler */

%}

/*============================================================================*/
/* Create Bison union and stack */
/*============================================================================*/
%code requires {
#include "types.hpp"
}

%union {
  object_type* pointer;
  type_type*   type_buffer;
  none_type*   none_buffer;
  bool_type*   bool_buffer;
  int_type*    int_buffer;
  float_type*  float_buffer;
  bytes_type*  bytes_buffer;
} /* union */ 
```

// 类型.hpp

```
#include <iostream>
#include <typeinfo>
#include <sstream>
#include <string>
using namespace std;

//============================================================================//
// Declare classes
//============================================================================//
class object_type;
class none_type;
class type_type;
class bool_type;
class int_type;
class float_type;
class bytes_type;

type_type  type_function(object_type* object);
bytes_type name_function(object_type* object);
bytes_type repr_function(object_type* object);
bool_type  bool_function(object_type* object);
int_type   int_function(object_type* object);
float_type float_function(object_type* object);
bytes_type bytes_function(object_type* object); 
```

// 生成文件

```
caesar: scanner.l parser.y types.hpp
    clear && clear && clear
    bison -d parser.y -o parser.cpp --graph
    flex -o scanner.cpp scanner.l
    g++ -Wall -g -o $@ parser.cpp scanner.cpp -lfl 
```

错误可能在哪里？我想这很简单，但是由于我是 C++ 的新手，所以我很难找到它。提前致谢！如果有需要，我会发布整个代码。

这是错误消息的示例。

```
/home/ghostmansd/lang/types.hpp:559: multiple definition of `repr_function(object_type*)'
/tmp/ccv2zJdS.o:/home/ghostmansd/lang/types.hpp:559: first defined here 
```

存储库：http: [//github.com/ghostmansd/caesar](http://github.com/ghostmansd/caesar)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:25:51.347

问题是你的头文件中有实现，例如

```
type_type::~type_type(void) { /* destructor */ } 
```

这需要转到 types.cpp，在 types.hpp 中你应该只有类定义（除非你内联那些东西，但这将是第二步）。这是因为如果 types.hpp 被多次包含，那么您还会有两个实现，这是链接器不喜欢的。

您也不应该在 types.hpp 中声明变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:28:54.663

您在头文件中定义常量：

```
const none_type NONE_TYPE;
const bool_type BOOL_TYPE;
const int_type INT_TYPE;
const float_type FLOAT_TYPE;
const bytes_type BYTES_TYPE; 
```

这会在链接期间引起问题，因为相同的符号多次存在。

避免该问题的一种方法：

您应该只在标头中将它们声明为外部：

```
extern const none_type NONE_TYPE;
extern const bool_type BOOL_TYPE;
extern const int_type INT_TYPE;
extern const float_type FLOAT_TYPE;
extern const bytes_type BYTES_TYPE; 
```

并且只在一个 cpp 文件中定义：

```
const none_type NONE_TYPE;
const bool_type BOOL_TYPE;
const int_type INT_TYPE;
const float_type FLOAT_TYPE;
const bytes_type BYTES_TYPE; 
```

标题的函数定义似乎也出现了同样的问题。

# salesforce - 在记事本中插入换行符

> ID：14014071
> 
> 赞同：1
> 
> 时间：2012-12-23T19:32:36.650
> 
> 标签：salesforce, visualforce

我正在尝试向记事本文件添加新行字符。我正在使用\n，但它实际上插入了实际的字符串\n。

基本上我正在尝试使用visualforce页面插入它。

我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T07:23:30.290

这个问题令人困惑。*“在记事本文件*中添加换行符”是什么意思？你是如何在visualforce中处理*文件的？*

如果您尝试在字段中插入换行符，则可以使用`<apex:inputTextArea>`该字段并将其与该字段合并。

其次，由于您使用的是visualforce，您可以在*控制器*中编写一些逻辑来添加换行符。希望能帮助到你。

*更新：*
尝试使用[html 代码](http://code.cside.com/3rdpage/us/newLine.html)换行和回车，LF - `&#x0A;`， CR - `&#x0D;`， CRLF -`&#x0D;&#x0A;`而不是使用`\n`or`<br />`

# mongodb - Dart 使用 MongoDB 进行强类型化

> ID：14014072
> 
> 赞同：1
> 
> 时间：2012-12-23T19:32:41.013
> 
> 标签：mongodb, dart

取自 mongo_dart 的 blog.dart 中的示例，我想在将记录添加到数据库时添加一些强类型。任何帮助表示赞赏。

```
 Db db = new Db("mongodb://127.0.0.1/mongo_dart-blog");
  DbCollection collection;
  DbCollection articlesCollection;
  Map<String,Map> authors = new Map<String,Map>();
  db.open().chain((o){
    db.drop();
    collection = db.collection('authors');
    collection.insertAll( //would like strongly typed List here instead
      [{'name':'William Shakespeare', 'email':'william@shakespeare.com', 'age':587},
      {'name':'Jorge Luis Borges', 'email':'jorge@borges.com', 'age':123}]
    );
    return collection.find().each((v){authors[v["name"]] = v;});
  }).chain((v){
    print(">> Authors ordered by age ascending");
    db.ensureIndex('authors', key: 'age');
    return collection.find(where.sortBy('age')).each(
      (auth)=>print("[${auth['name']}]:[${auth['email']}]:[${auth['age']}]"));
  }).then((dummy){
    db.close();
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T06:46:57.123

也许[Objectory](http://pub.dartlang.org/packages/objectory)会适合你。

来自自述文件：

**Objectory - 用于服务器端和客户端 Dart 应用程序的对象文档映射器**。Objectory 提供类型化、检查的环境来建模、保存和查询持久在 MongoDb 上的数据。

objectory 中 blog_console.dart 示例的相应片段如下所示：

```
 objectory = new ObjectoryDirectConnectionImpl(Uri,registerClasses,true);
  var authors = new Map<String,Author>();
  var users = new Map<String,User>();  
  objectory.initDomainModel().chain((_) {
    print("===================================================================================");
    print(">> Adding Authors");
    var author = new Author();
    author.name = 'William Shakespeare';
    author.email = 'william@shakespeare.com';
    author.age = 587;
    author.save();
    author = new Author();
    author.name = 'Jorge Luis Borges';
    author.email = 'jorge@borges.com';
    author.age = 123;
    author.save();    
    return objectory.find($Author.sortBy('age'));
  }).chain((auths){  
    print("============================================");
    print(">> Authors ordered by age ascending");
    for (var auth in auths) {
      authors[auth.name] = auth;
      print("[${auth.name}]:[${auth.email}]:[${auth.age}]");
    }
........ 
```

Author 类定义为：

```
class Author extends PersistentObject  {
  String get name => getProperty('name');
  set name(String value) => setProperty('name',value);

  String get email => getProperty('email');
  set email(String value) => setProperty('email',value);

  int get age => getProperty('age');
  set age(int value) => setProperty('age',value);

} 
```

查看[快速浏览](https://github.com/vadimtsushko/objectory/blob/master/doc/quick_tour.md)、样品和测试以获取更多信息

# google-maps - Google Maps API OVER QUERY LIMIT 每秒限制

> ID：14014074
> 
> 赞同：32
> 
> 时间：2012-12-23T19:32:54.153
> 
> 标签：google-maps, google-maps-api-3

我正在使用 Google Maps API 在地图上显示大约 50 个位置。我正在使用客户端地理编码。我正在使用 window.setTimeout 来控制应用程序每秒发送的地理编码请求数。如果我每秒发送超过 1 个请求，我会收到 OVER QUERY LIMIT 响应。

**问题：这个限制不应该是每秒 10 个查询吗？如果是，那么我做错了什么？如果不是，那么 Business API 是否有更慷慨的每秒查询限制？**

请注意，我们的应用程序不会达到每天 25,000 个查询。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-23T20:35:11.923

地理编码器具有配额和速率限制。根据经验，您可以对大约 10 个位置进行地理编码而不会达到查询限制（实际数量可能取决于服务器负载）。最好的解决方案是在收到 OVER_QUERY_LIMIT 错误时延迟，然后重试。请参阅这些类似的帖子：

*   [Google Maps API v3 中的 OVER_QUERY_LIMIT：如何在 Javascript 中暂停/延迟以减慢速度？](https://stackoverflow.com/questions/11792916/over-query-limit-in-google-maps-api-v3-how-do-i-pause-delay-in-javascript-to-sl)

*   [如何在未收到 OVER_QUERY_LIMIT 响应的情况下对 20 个地址进行地理编码？](https://stackoverflow.com/questions/2419219/how-do-i-geocode-20-addresses-without-receiving-an-over-query-limit-response)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T09:36:37.990

通常，当您需要在地图上显示这么多点时，最好使用服务器端方法，本文解释了何时使用每个点：

地理编码策略：[https ://developers.google.com/maps/articles/geocodestrat](https://developers.google.com/maps/articles/geocodestrat)

客户端限制并不完全是“每秒 10 个请求”，并且由于 API 文档中没有解释，我不会依赖它的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-04T14:32:34.830

* * *

由于 Google Server Overload，这种方法不正确。有关更多信息，请参阅 [https://gis.stackexchange.com/questions/15052/how-to-avoid-google-map-geocode-limit#answer-15365](https://gis.stackexchange.com/questions/15052/how-to-avoid-google-map-geocode-limit#answer-15365)

* * *

顺便说一句，如果你想继续，在这里你可以找到一个代码，让你加载来自谷歌地图的多个标记 ajax，避免 OVER_QUERY_LIMIT 错误。

**我已经在我的 onw 服务器上进行了测试，它可以工作！**：

```
var lost_addresses = [];
    geocode_count  = 0;
    resNumber = 0;
    map = new GMaps({
       div: '#gmap_marker',
       lat: 43.921493,
       lng: 12.337646,
    });

function loadMarkerTimeout(timeout) {
    setTimeout(loadMarker, timeout)
}

function loadMarker() { 
    map.setZoom(6);         
    $.ajax({
            url: [Insert here your URL] ,
            type:'POST',
            data: {
                "action":   "loadMarker"
            },
            success:function(result){

                /***************************
                 * Assuming your ajax call
                 * return something like: 
                 *   array(
                 *      'status' => 'success',
                 *      'results'=> $resultsArray
                 *   );
                 **************************/

                var res=JSON.parse(result);
                if(res.status == 'success') {
                    resNumber = res.results.length;
                    //Call the geoCoder function
                    getGeoCodeFor(map, res.results);
                }
            }//success
    });//ajax
};//loadMarker()

$().ready(function(e) {
  loadMarker();
});

//Geocoder function
function getGeoCodeFor(maps, addresses) {
        $.each(addresses, function(i,e){                
                GMaps.geocode({
                    address: e.address,
                    callback: function(results, status) {
                            geocode_count++;        

                            if (status == 'OK') {       

                                //if the element is alreay in the array, remove it
                                lost_addresses = jQuery.grep(lost_addresses, function(value) {
                                    return value != e;
                                });

                                latlng = results[0].geometry.location;
                                map.addMarker({
                                        lat: latlng.lat(),
                                        lng: latlng.lng(),
                                        title: 'MyNewMarker',
                                    });//addMarker
                            } else if (status == 'ZERO_RESULTS') {
                                //alert('Sorry, no results found');
                            } else if(status == 'OVER_QUERY_LIMIT') {

                                //if the element is not in the losts_addresses array, add it! 
                                if( jQuery.inArray(e,lost_addresses) == -1) {
                                    lost_addresses.push(e);
                                }

                            } 

                            if(geocode_count == addresses.length) {
                                //set counter == 0 so it wont's stop next round
                                geocode_count = 0;

                                setTimeout(function() {
                                    getGeoCodeFor(maps, lost_addresses);
                                }, 2500);
                            }
                    }//callback
                });//GeoCode
        });//each
};//getGeoCodeFor() 
```

例子：

```
map = new GMaps({
  div: '#gmap_marker',
  lat: 43.921493,
  lng: 12.337646,
});

var jsonData = {  
   "status":"success",
   "results":[  
  {  
     "customerId":1,
     "address":"Via Italia 43, Milano (MI)",
     "customerName":"MyAwesomeCustomer1"
  },
  {  
     "customerId":2,
     "address":"Via Roma 10, Roma (RM)",
     "customerName":"MyAwesomeCustomer2"
  }
   ]
};

function loadMarkerTimeout(timeout) {
  setTimeout(loadMarker, timeout)
}

function loadMarker() {	
  map.setZoom(6);

  $.ajax({
    url: '/echo/html/',
    type: "POST",
    data: jsonData,
    cache: false,
    success:function(result){

      var res=JSON.parse(result);
      if(res.status == 'success') {
        resNumber = res.results.length;
        //Call the geoCoder function
        getGeoCodeFor(map, res.results);
      }
    }//success
  });//ajax

};//loadMarker()

$().ready(function(e) {
  loadMarker();
});

//Geocoder function
function getGeoCodeFor(maps, addresses) {
  $.each(addresses, function(i,e){				
    GMaps.geocode({
      address: e.address,
      callback: function(results, status) {
        geocode_count++;		

        console.log('Id: '+e.customerId+' | Status: '+status);

        if (status == 'OK') {		

          //if the element is alreay in the array, remove it
          lost_addresses = jQuery.grep(lost_addresses, function(value) {
            return value != e;
          });

          latlng = results[0].geometry.location;
          map.addMarker({
            lat: latlng.lat(),
            lng: latlng.lng(),
            title: e.customerName,
          });//addMarker
        } else if (status == 'ZERO_RESULTS') {
          //alert('Sorry, no results found');
        } else if(status == 'OVER_QUERY_LIMIT') {

          //if the element is not in the losts_addresses array, add it! 
          if( jQuery.inArray(e,lost_addresses) == -1) {
            lost_addresses.push(e);
          }

        } 

        if(geocode_count == addresses.length) {
          //set counter == 0 so it wont's stop next round
          geocode_count = 0;

          setTimeout(function() {
            getGeoCodeFor(maps, lost_addresses);
          }, 2500);
        }
      }//callback
    });//GeoCode
  });//each
};//getGeoCodeFor()
```

```
#gmap_marker {
  min-height:250px;
  height:100%;
  width:100%;
  position: relative; 
  overflow: hidden;
 }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://maps.google.com/maps/api/js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.24/gmaps.min.js" type="text/javascript"></script>

<div id="gmap_marker"></div> <!-- /#gmap_marker -->
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-24T02:11:28.180

而不是客户端地理编码

```
geocoder.geocode({
    'address': your_address
  }, function (results, status) {
     if (status == google.maps.GeocoderStatus.OK) {
       var geo_data = results[0];
       // your code ...
   } 
}) 
```

我会去服务器端地理编码 API

```
var apikey = YOUR_API_KEY;
var query = 'https://maps.googleapis.com/maps/api/geocode/json?address=' + address + '&key=' + apikey;
$.getJSON(query, function (data) {
  if (data.status === 'OK') { 
    var geo_data = data.results[0];
  } 
}) 
```

# iphone - 为 MapKit 转换“世界文件”GIS？

> ID：14014077
> 
> 赞同：0
> 
> 时间：2012-12-23T19:33:35.820
> 
> 标签：iphone, objective-c, ios, mapkit, gis

我对如何将世界文件转换为左上角和右下角坐标以在 MapKit 中使用有点困惑。我正在尝试将 NOAA 雷达图像放在地图上。

这是一个世界文件的例子：

```
0.0147268399325284
0.000000
0.000000
-0.0147268399325284
-166.284681479714
64.8355168290572 
```

这是所有世界文件的关键：

```
Line 1: x-dimension of a pixel in map units
Line 2: rotation parameter
Line 3: rotation parameter
Line 4: NEGATIVE of y-dimension of a pixel in map units
Line 5: x-coordinate of center of upper left pixel
Line 6: y-coordinate of center of upper left pixel 
```

我知道如果我有图片的左上角和右下角（反之亦然）坐标，我将能够在 MKMapView 上显示它。但我不确定如何在 MKMapView 上执行世界文件，或者如何转换它。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T06:09:36.337

第 5 行和第 6 行提供的 (x,y) 坐标不是图像左上边界的坐标。这是图像最左上角像素**中心**的坐标。所以给定第 1 到 6 行的值：

```
Line 1: x-dimension of a pixel in map units                      = dx
Line 2: rotation parameter                                       
Line 3: rotation parameter
Line 4: NEGATIVE of y-dimension of a pixel in map units          = dy
Line 5: x-coordinate of center of upper left pixel               = centerOfULX
Line 6: y-coordinate of center of upper left pixel               = centerOfULY 
```

您可以按如下方式计算左上角和右下角坐标：

```
upperLeftX = centerOfULX - dx/2
upperLeftY = centerOfULY + (-dy/2)

lowerRightX = (centerOfULX - dx/2) + imageWidth * dx
lowerRightY = (centerOfUL + (-dy/2)) - imageHeight * (-dy) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:55:20.120

我能够找到等式，使其成为左上角（NW）和右下角（SW）的纬度和经度。这是方程式。

```
0.017971305190311 A
0.000000000000000 B
0.000000000000000 C
-0.017971305190311 D
-127.620375523875420 E
50.406626367301044 F

RESOLUTION OF PICTURE 3400 G x 1600 H pixels

CALCULATION:
E + (G*A) = EASTERN POINT
F + (H*D) = SOUTHERN POINT

RESULTS:
Lower left coordinate: 21.652538062803, -127.620375523875420
Upper right coordinate: 50.406626367301044, -66.517937876818 
```

# php - Symfony2、symfony1.4 和 $_SESSION

> ID：14014081
> 
> 赞同：2
> 
> 时间：2012-12-23T19:34:27.147
> 
> 标签：php, session, symfony-1.4, session-variables, symfony-2.1

我有一个我想使用的项目，`Symfony2.1`当然`symfony 1.4`我需要在它们之间与会话共享一些数据，但我不明白为什么会话在它们之间不可见。例如：

在 symfony1 过滤器中，我有：

```
echo session_id().'<br>';
echo session_name();
$_SESSION['test_s1'] = '123';
var_dump($_SESSION); 
```

结果是：

```
d30irfcdhjio27uiqd7a52blv7
symfony
array (size=6)
  'symfony/user/sfUser/lastRequest' => int 1356289903
  'symfony/user/sfUser/authenticated' => boolean false
  'symfony/user/sfUser/credentials' => 
    array (size=0)
      empty
  'symfony/user/sfUser/attributes' => 
    array (size=0)
      empty
  'symfony/user/sfUser/culture' => string 'en_US' (length=5)
  'test_s1' => string '123' (length=3) 
```

所以，一切看起来都很好。

在 Symfony2 控制器中，我有：

```
echo session_id() . '<br>';
echo session_name();
$_SESSION['test_s2'] = '123';
$session->set('test_s2_second', '321');
var_dump($_SESSION);
die; 
```

结果：

```
d30irfcdhjio27uiqd7a52blv7
symfony
array (size=4)
  '_sf2_attributes' => &
    array (size=4)
      'razvan' => string 'test' (length=4)
      '_security_secured_area' => string 'C:74:"Symfony\Component\Security\Core\Authentication\Token\UsernamePasswordToken":777:{a:3:{i:0;N;i:1;s:12:"secured_area";i:2;s:728:"a:4:{i:0;O:41:"Symfony\Component\Security\Core\User\User":7:{s:51:"?Symfony\Component\Security\Core\User\User?username";s:6:"user";s:51:"?Symfony\Component\Security\Core\User\User?password";s:8:"userpass";s:50:"?Symfony\Component\Security\Core\User\User?enabled";b:1;s:60:"?Symfony\Component\Security\Core\User\User?accountNonExpired";b:1;s:64:"?Symfony\Component\Security\Core'... (length=865)
      'search_form' => string '' (length=0)
      'test_s2_second' => string '321' (length=3)
  '_sf2_flashes' => &
    array (size=0)
      empty
  '_sf2_meta' => &
    array (size=3)
      'u' => int 1356289889
      'c' => int 1356287606
      'l' => string '0' (length=1)
  'test_s2' => string '123' (length=3) 
```

所以，session_id 和 session_name 是相同的，但是我看不到我在 Symfony2 中通过 symfony1 设置的会话的键/值，即使我使用 $_SESSION 也是如此。

背后的架构更复杂，我试图只暴露主要问题。

那么，知道如何将一些变量从 Symfony2.1 设置到会话中并在 symfony 1.4 页面中可见吗？

（我用 Symfony2.0 做了同样的把戏，而且这个把戏奏效了）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T12:16:41.940

[文档](http://symfony.com/doc/current/cookbook/session/php_bridge.html)中有一篇关于该主题的食谱文章。这是 theodo 的一篇博客文章（他们的简介是将 symfony1 应用程序移植到 Symfony2）关于[如何使用 memcache 共享会话](http://www.theodo.fr/blog/2013/06/sharing-session-between-symfony1-and-symfony2-using-memcache-2/)并且他们也有一个[包（TheodoEvolutionSessionBundle）](https://github.com/theodo/TheodoEvolutionSessionBundle)。还有一个关于将遗留应用程序移植到 Symfony2 的问题和其他问题的[视频。](http://www.youtube.com/watch?v=kZocRPreQ5g)

# jquery - 使用 CSS 打印效果

> ID：14014085
> 
> 赞同：1
> 
> 时间：2012-12-23T19:34:48.093
> 
> 标签：jquery, css

![在此处输入图像描述](../Images/7fe17d9479d774c2798e3b67ad26ec27.png)

是否有可能使用 CSS3（也许还有 jQuery）来实现这种效果？我尝试了通常的'slideDown'效果，但它甚至没有接近这个。有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T20:25:04.577

你可以用 CSS 过渡来做到这一点..

这个概念是有一个带有`height:0`and的元素`overflow:hidden`（*让我们将其命名为 paper-holder*），并在其内部有一个绝对定位的元素在底部（*with`bottom:0`*）（*paper*）

这样，当您将*纸架*元素的高度从 0 过渡到纸的高度时，*纸*似乎正在滑出。

**演示在** [http://jsfiddle.net/9FfKZ/1/](http://jsfiddle.net/9FfKZ/1/)

* * *

***更新***

使打印步骤更明显的改进是使用`steps`（*[文档](http://dev.w3.org/csswg/css3-transitions/#transition-timing-function-property)*）计时功能而不是我最初演示的线性

**演示在** [http://jsfiddle.net/9FfKZ/4/](http://jsfiddle.net/9FfKZ/4/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-23T19:41:50.903

我的想法之一是拥有 3 种不同的元素。暂时忘记这张纸。只考虑打印机插槽。我会把它做成两个单独的图像。上半部有下半部。这两个图像应该在您希望纸张送入的位置相遇。绝对定位这两个图像，使它们看起来正常连接。

这里的诀窍在于`z-index`您希望上半部分的 z-index 高于下半部分，本质上使其在 z 轴上“更接近用户”。使顶部有一个`z-index:9999;`，下半部分有一个`z-index:9995;`

现在，您将要创建一个代表论文的 div。给那个 div 一个 z-index: 在顶部和底部图形之间的某个地方，所以给它一个`z-index:9997;`. 将它绝对定位在顶部图形的后面，然后慢慢地向下动画直到它的终点。

**工作演示：http: [//jsfiddle.net/XzVA9/2/](http://jsfiddle.net/XzVA9/2/)**

* * *

**HTML**

```
<img id="top" src="http://s1.postimage.org/txsnx2v9r/imgtop.png" />
<div id="paper">Receipt</div>
<img id="bottom" src="http://s1.postimage.org/3o7lea9cf/imgbot.png" /> 
```

* * *

**CSS**

```
#top{
    position:absolute;
    top:0;
    left:0;
    z-index:9999;
}
#bottom{
    position:absolute;
    top:284px;
    left:0;
    z-index:9995;
}
#paper{
    position:absolute;
    top:204px;
    left:250px;
    z-index:9997;
    width:300px;
    height:50px;
    line-height:50px;
    padding:15px 0;
    background:#fff;
    border:1px solid #999;
    text-align:center;
    font-weight:bold;
    font-size:22pt;
    -webkit-box-shadow: 0 8px 6px -6px black;
       -moz-box-shadow: 0 8px 6px -6px black;
            box-shadow: 0 8px 6px -6px black; 
} 
```

* * *

**JS**

```
$('#paper').animate({'top':'284px'}, 3000);​ 
```

* * *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:41:09.377

在 javascript 中使用 setInterval 每 x 毫秒设置一次位置，以创建抖动效果。确保您有适当的 CSS 来完成这项工作，即。在正确的元素上定位绝对/相对

```
var offset_y = 0,
    slide_interval = setInterval(function() {
        $('#element').css({
            left    : 0,
            top     : offset_y
        });

        offset_y += 2;

        if(offset_y > 1000) // Desired Value Here
            clearInterval(slide_interval);
    }); 
```

# java - Spring Data JPA 中的 CrudRepository 和 JpaRepository 接口有什么区别？

> ID：14014086
> 
> 赞同：921
> 
> 时间：2012-12-23T19:35:12.087
> 
> 标签：java, spring, jpa, spring-data, spring-data-jpa

[Spring Data JPA中的](https://spring.io/projects/spring-data-jpa)[CrudRepository](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html)和[JpaRepository](https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html)接口有什么区别？

当我在网上看到这些例子时，我看到它们在那里可以互换使用。

它们之间有什么区别？

为什么要使用其中一个而不是另一个？

* * *

## 回答 #1

> 赞同：1273
> 
> 时间：2012-12-24T19:36:34.490

[`JpaRepository`](http://static.springsource.org/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html)扩展[`PagingAndSortingRepository`](http://static.springsource.org/spring-data/data-commons/docs/current/api/org/springframework/data/repository/PagingAndSortingRepository.html)而扩展[`CrudRepository`](http://static.springsource.org/spring-data/data-commons/docs/current/api/org/springframework/data/repository/CrudRepository.html)。

它们的主要功能是：

*   [`CrudRepository`](http://static.springsource.org/spring-data/data-commons/docs/current/api/org/springframework/data/repository/CrudRepository.html)主要提供CRUD功能。
*   [`PagingAndSortingRepository`](http://static.springsource.org/spring-data/data-commons/docs/current/api/org/springframework/data/repository/PagingAndSortingRepository.html)提供对记录进行分页和排序的方法。
*   [`JpaRepository`](http://static.springsource.org/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html)提供一些 JPA 相关的方法，例如刷新持久化上下文和批量删除记录。

由于上面提到的继承， `JpaRepository`将具有`CrudRepository`和的所有功能`PagingAndSortingRepository`。因此，如果您不需要存储库具有 and 提供的功能`JpaRepository`，请`PagingAndSortingRepository`使用`CrudRepository`.

* * *

## 回答 #2

> 赞同：451
> 
> 时间：2013-12-26T11:25:27.650

肯的​​回答基本上是正确的，但我想插话“你为什么要使用一个而不是另一个？” 你问题的一部分。

## 基本

您为存储库选择的基本接口有两个主要用途。首先，您允许 Spring Data 存储库基础架构找到您的接口并触发代理创建，以便您将接口的实例注入客户端。第二个目的是在接口中引入尽可能多的功能，而无需声明额外的方法。

## 常用接口

Spring Data 核心库附带两个基本接口，它们公开了一组专用功能：

*   `CrudRepository`- CRUD 方法
*   `PagingAndSortingRepository`- 分页和排序方法（扩展`CrudRepository`）

## 商店特定的界面

各个存储模块（例如，用于 JPA 或 MongoDB）公开这些基本接口的特定于存储的扩展，以允许访问特定于存储的功能，例如将某些存储细节考虑在内的刷新或专用批处理。`deleteInBatch(…)`这方面的一个例子`JpaRepository`是不同的，`delete(…)`因为它使用查询来删除给定的实体，它具有更高的性能，但具有不触发 JPA 定义的级联的副作用（正如规范所定义的那样）。

我们通常建议*不要*使用这些基本接口，因为它们将底层持久性技术暴露给客户端，从而加强它们与存储库之间的耦合。另外，您与存储库的原始定义有所不同，它基本上是“实体的集合”。因此，如果可以，请留下来`PagingAndSortingRepository`。

## 自定义存储库基础接口

直接依赖于提供的基本接口之一的缺点是双重的。它们都可能被认为是理论上的，但我认为它们很重要，需要注意：

1.  **依赖于 Spring Data 存储库接口将你的存储库接口耦合到库。**我不认为这是一个特别的问题，因为无论如何你可能会在你的代码中使用`Page`抽象`Pageable`。Spring Data 与任何其他通用库（如 commons-lang 或 Guava）没有任何不同。只要它提供合理的好处，就可以了。
2.  **通过扩展 eg `CrudRepository`，您可以一次公开一套完整的持久性方法。**这在大多数情况下可能也很好，但是您可能会遇到希望对公开的方法进行更细粒度控制的情况，例如创建一个`ReadOnlyRepository`不包括.`save(…)``delete(…)``CrudRepository`

解决这两个缺点的方法是制作自己的基础存储库接口，甚至是其中的一组。在很多应用程序中，我看到过这样的事情：

```
interface ApplicationRepository<T> extends PagingAndSortingRepository<T, Long> { }

interface ReadOnlyRepository<T> extends Repository<T, Long> {

  // Al finder methods go here
} 
```

第一个存储库接口是一些通用的基本接口，它实际上只修复了第 1 点，但也绑定了 ID 类型以`Long`保持一致性。第二个接口通常具有`find…(…)`从其中复制的所有方法`CrudRepository`，`PagingAndSortingRepository`但不公开操作方法。[在参考文档](http://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.definition-tuning)中阅读有关该方法的更多信息。

## 摘要-tl；博士

存储库抽象允许您选择完全由您的架构和功能需求驱动的基本存储库。如果适合，请使用开箱即用的接口，如有必要，请制作您自己的存储库基础接口。除非不可避免，否则请远离商店特定的存储库接口。

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2018-03-10T06:02:15.987

[![在此处输入图像描述](../Images/1874af712e0222f2f3ff069c4b3ec5df.png)](https://i.stack.imgur.com/ee7XF.jpg)

**概括：**

*   PagingAndSortingRepository 扩展 CrudRepository

*   JpaRepository 扩展了 PagingAndSortingRepository

**CrudRepository**接口提供了用于 CRUD 操作的方法，因此它允许您创建、读取、更新和删除记录，而无需定义自己的方法。

PagingAndSortingRepository**提供**了额外的方法来使用分页和排序检索实体。

最后，**JpaRepository**添加了更多特定于 JPA 的功能。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2019-04-07T04:57:00.393

我正在学习 Spring Data JPA。它可能会帮助您： [![在此处输入图像描述](../Images/97ac29b79eadaf0d9fa7e334af42029c.png)](https://i.stack.imgur.com/SBx4b.png)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2020-06-25T01:56:54.850

[`CrudRepository`](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html)以下是和as之间的区别[`JpaRepository`](https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html)：

# `CrudRepository`

1.  `CrudRepository`是基本接口并扩展[`Repository`](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/Repository.html)接口。
2.  `CrudRepository`主要提供CRUD（创建、读取、更新、删除）操作。
3.  方法的返回类型`saveAll()`是[`Iterable`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Iterable.html).
4.  用例 - 要执行 CRUD 操作，请定义存储库扩展`CrudRepository`。

# `JpaRepository`

1.  `JpaRepository`延伸[`PagingAndSortingRepository`](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/PagingAndSortingRepository.html?is-external=true)那个延伸`CrudRepository`。
2.  `JpaRepository`提供 CRUD 和分页操作，以及其他方法，如`flush()`、`saveAndFlush()`和`deleteInBatch()`等。
3.  方法的返回类型`saveAll()`是 a [`List`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)。
4.  用例 - 要执行 CRUD 以及批处理操作，请定义存储库扩展`JpaRepository`。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2020-01-10T20:46:51.770

所有答案都为问题提供了足够的细节。不过，让我再补充一点。

**我们为什么使用这些接口：**

*   它们允许 Spring 找到您的存储库接口并为它们创建代理对象。
*   它为您提供了允许您执行一些常见操作的方法（您也可以定义您的自定义方法）。我喜欢这个功能，因为创建一个方法（并定义查询和准备好的语句，然后使用连接对象执行查询）来做一个简单的操作真的很糟糕！

**哪个接口做什么：**

*   **CrudRepository** : 提供 CRUD 功能
*   **PagingAndSortingRepository** : 提供分页和排序记录的方法
*   **JpaRepository**：提供JPA相关的方法，例如刷新持久化上下文和批量删除记录

**何时使用哪个接口：**

根据[http://jtuts.com/2014/08/26/difference-between-crudrepository-and-jparepository-in-spring-data-jpa/](http://jtuts.com/2014/08/26/difference-between-crudrepository-and-jparepository-in-spring-data-jpa/)

一般来说，最好的办法是使用**CrudRepository**或**PagingAndSortingRepository**，具体取决于您是否需要排序和分页。

如果可能，应该避免使用**JpaRepository ，因为它将存储库与 JPA 持久性技术联系在一起，并且在大多数情况下，您甚至可能不会使用它提供的额外方法。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-28T07:00:37.030

Crud Repository 是基本接口，它充当标记接口。

JPA 存储库还扩展了 PagingAndSorting 存储库。它提供了所有对实现分页有用的方法。Crud Repository 不提供实现分页和排序的方法

您可以参考 - [https://www.tutorialspoint.com/difference-between-crudrepository-and-jparepository-in-java#:~:text=Crud%20Repository%20is%20the%20base,acts%20as%20a%20marker %20interface.&text=JPA%20repository%20also%20extends%20the,for%20implementing%20pagination%20and%20sorting](https://www.tutorialspoint.com/difference-between-crudrepository-and-jparepository-in-java#:%7E:text=Crud%20Repository%20is%20the%20base,acts%20as%20a%20marker%20interface.&text=JPA%20repository%20also%20extends%20the,for%20implementing%20pagination%20and%20sorting)。

# android - 在布局层次结构中覆盖在 YouTubePlayerFragment 或 YouTubePlayerView 上方的视图会导致播放立即暂停

> ID：14014087
> 
> 赞同：18
> 
> 时间：2012-12-23T19:35:28.720
> 
> 标签：android, youtubeplayer

我正在使用 YouTube Android Player API，并希望在 a 顶部覆盖一个视图`YouTubePlayerFragment`，以便在播放视频上方显示上下文信息和控件。

不幸的是，在布局层次结构中播放器上方有一个或多个视图时，`YouTubePlayerFragment`播放似乎无法正常工作。`YouTubePlayerView`播放时间不到半秒，然后立即暂停。

该问题可以通过使用 SDK 附带的 Simple PlayerFragment 演示的以下布局来重现：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

  <fragment
      android:name="com.google.android.youtube.player.YouTubePlayerFragment"
      android:id="@+id/youtube_fragment"
      android:layout_width="match_parent"
      android:layout_height="match_parent"/>

  <TextView
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:textAppearance="@android:style/TextAppearance.Small"
      android:layout_alignParentTop="true"
      android:text="@string/playerfragment_text"/>

</RelativeLayout> 
```

我已经尝试了使用这两种布局的各种布局配置`FrameLayout`，`RelativeLayout`但问题总是一样的。我意识到这个 API 已作为“实验性”发布，但如果这是一个已知问题，它对于许多实现来说是一个相当大的障碍。有没有人有好的解决方案或解决方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-24T01:07:36.993

杰夫 - 这按设计工作。不支持在我们的任何 YouTube 播放器（包括 YouTube Android 播放器）上叠加。当检测到覆盖时，播放停止并且日志包含有助于调试问题的信息。我们确实支持操作栏覆盖，请查看此演示以了解更多信息：[https](https://developers.google.com/youtube/android/player/sample-applications#Overlay_ActionBar_Demo) ://developers.google.com/youtube/android/player/sample-applications#Overlay_ActionBar_Demo 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-11T03:21:13.537

Youtube Player 不允许任何视图覆盖它。只需使用 setVisibility(View.GONE) 为所有视图覆盖它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-12T15:13:29.647

不能按照 Google 的规定在播放器上方添加按钮作为叠加层，否则播放器将停止：

[https://developers.google.com/youtube/android/player/reference/com/google/android/youtube/player/YouTubePlayerView](https://developers.google.com/youtube/android/player/reference/com/google/android/youtube/player/YouTubePlayerView)

> 请注意，在播放视频时，此视图的最小尺寸为 200x110 dp。如果您将视图缩小，视频将自动停止播放。此外，在播放视频时，不允许将视图与其他视图重叠。
> 
> 此视图不支持填充。要达到相同的效果，请将视图包装在另一个 ViewGroup 中或为其设置边距。

YouTubePlayer 也不支持填充。

为了在视频上叠加您的视图，我建议您使用**ExoPlayer**，它不是 android sdk 的一部分，但由 google 推荐并包含在 android 开发人员文档中：

[http://google.github.io/ExoPlayer/](http://google.github.io/ExoPlayer/)

值得一提的是，在 youtube 应用程序中使用了 Exoplayer。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-23T23:02:10.337

您可以将播放器主题设置为 YouTubePlayer.PlayerStyle.CHROMELESS，然后在下面实现您自己的控件。

我遇到了一个问题，我找不到关于如何使用自定义布局重新实现搜索栏的好资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-02T09:42:55.347

沃拉！！我有一个场景，这个问题出现在设备棒棒糖及更高版本中，这是因为状态栏。我隐藏状态栏问题解决了。只是把它写成一个答案，以防它帮助别人:)

# java - Java while循环与数组

> ID：14014090
> 
> 赞同：-3
> 
> 时间：2012-12-23T19:36:03.820
> 
> 标签：java

假设 p 是一个具有 int 类型元素的二维数组。以下哪个陈述最能描述以下代码的效果？

```
int i = 0;

while ( i < p[ 0 ].length )
{
  p[ 0 ][ i ] = 0;
  i++;
} 
```

有人可以帮我把它翻译成简单的英语吗？我只知道循环会在什么时候继续进行，`i < p[0].length`但是什么是`p[0]`什么是什么`p[0][i]`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T19:43:04.317

```
"i" equals zero
"p" is an array of arrays
while i is smaller than the "first" array's size in p
    give 0 as value to i'th element of first array in p 
    increase i by 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T19:41:24.443

该变量`p`可能是一个`int[][]`- 一个整数数组。

`p[0]`是 的第一个元素`p`，并且具有类型`int[]`。`[]`运算符索引到数组中。`a[n]`从数组中获取索引 n 处的元素`a`。请注意，它使用基于 0 的索引，因此第一个元素的索引为 0（而不是您可能期望的 1）。

循环将所有元素设置`p[0]`为 value `0`。

请注意，这也可以更简洁地使用[`Arrays.fill`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html#fill%28int%5b%5d,%20int%29). 以下代码与您发布的循环具有相同的效果：

```
Arrays.fill(p[0], 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:38:51.120

这是一个循环，`i`随着数组的第一个数组的长度递增`p`，将`i`第 th 元素设置为`0`.

在 java`p[0][i]`中与`p[i]`第一个数组相同`p`。

据推测，`p`被声明为`int[][] p`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T19:41:46.783

p[0].length 指的是第二个指定维度的大小，就像如果有一个 n 维度的数组说 int a[][][][][][][][...n 次然后是 a。 length 指的是第一维，a[0].length 将指的是第二维的长度等。

p[0][i] 显然是指第一行，其列索引由 i 的当前值指定。

# ajax - 如何在 MVC 4 应用程序中使用星级插件？

> ID：14014091
> 
> 赞同：0
> 
> 时间：2012-12-23T19:36:06.577
> 
> 标签：ajax, asp.net-mvc, jquery, jquery-plugins

我想 在我的 MVC 4 应用程序中使用[这个星级插件。](http://irfandurmus.com/projects/jquery-star-rating-plugin/)我有这样的评级表：

```
 public class Rating
    {
        public int FromUserId { get; set; }
        public int ToProductId { get; set; }
        public int RateValue { get; set; }
    } 
```

我有这样的动作：

```
public ActionResult SubmitRating(int fromUserId, int toProductId , int rateValue )
   {
       return View();
   } 
```

`FromUserId`是`@WebSecurity.CurrentUserId`和 `ToProductId` 是`Model.Id`

我有ajax的问题​​。我需要将 RateValue 发送到行动。如何将所选值发送到控制器中的**SubmitRating**操作并反转，从控制器发回答案以查看（显示所选值，向用户显示任何消息等）？

这不起作用。这里怎么写ajax代码？

```
$(function(){
    $('#star-rating').rating(function(vote, event){
        $.ajax({
            url: "@Url.Action("SubmitRating", "MyController")",
            type: "GET",
            data: {rateValue : vote},
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:24:50.227

让我们假设一些事情：

您的 HTML 具有产品 ID：

```
<div id="star-rating" data-pid="@Model.Id">
    <input type="radio" name="example" class="rating" value="1" />
    <input type="radio" name="example" class="rating" value="2" />
    <input type="radio" name="example" class="rating" value="3" />
    <input type="radio" name="example" class="rating" value="4" />
    <input type="radio" name="example" class="rating" value="5" />
</div> 
```

所以你可以有一个产品列表，而不是每页只有一个产品。

如果用户 ID 与当前登录的用户 ID 相同，则传递用户 ID 不是一种安全做法，您可以简单地从当前会话中获取用户 ID，因此我们将在我们的控制器中：

```
public class ServicesController : Controller
{
    public ActionResult RateProduct(int id, int rate)
    {
        int userId = WebSecurity.CurrentUserId;
        bool success = false;
        string error = "";

        try
        {
            success = db.RegisterProductVote(userId, id, rate);
        }
        catch (System.Exception ex)
        {
            // get last error
            if (ex.InnerException != null)
                while (ex.InnerException != null)
                    ex = ex.InnerException;

            error = ex.Message;
        }

        return Json(new { error = error, success = success }, JsonRequestBehavior.AllowGet);
    }
} 
```

这样您就可以轻松地调用您的费率，例如：

```
<script>
    $(function () {

        $('#star-rating').rating(function (vote, event) {
            var anchor = $(event.currentTarget),
                pid = anchor.closest(".ratting-item").data("pid"),
                url = '@Url.Action("RateProduct", "Services")';

            // show a loading div that would have a animated gif
            $(".loading").show();

            $.ajax({
                url: url,
                type: "GET",
                data: { rate: vote, id: pid },
                success: function (data) {
                    if (data.success) {
                        // all went well, here you can say Thank you

                    }
                    else {
                        // There must be an Exception error, let's show it

                    }
                },
                error: function (err) {
                    // the call thrown an error
                },
                complete: function () {
                    $(".loading").hide();
                }
            });
        });

    });
</script> 
```

* * *

**更新**

`$(this)`没有返回正确的元素，所以我们需要使用`event`调用传递的属性：

所以我们需要改成这样：

```
var anchor = $(event.currentTarget),
    pid = anchor.closest(".ratting-item").data("pid"),
    url = '@Url.Action("RateProduct", "Services")'; 
```

一个简单的`console.log($(this))`then`console.log(event);`会告诉您，另外，如果您触发[Fiddler](http://www.fiddler2.com/fiddler2/)，您将看到缺少的内容以及在返回的调用中看到错误。

**GIT 上的项目示例**

这是该项目的**源代码：** [https ://github.com/balexandre/Stackoverflow-Question-14014091](https://github.com/balexandre/Stackoverflow-Question-14014091)

# c - 使用 qsort 按字母顺序对二维数组的字符串进行排序

> ID：14014094
> 
> 赞同：0
> 
> 时间：2012-12-23T19:36:28.157
> 
> 标签：c

我如何使用 qsort 按字母顺序对二维数组的字符串进行排序字符串按字母顺序？

我用这个

```
 qsort(arr, i, 500*sizeof(arr[0]), compare);
            for (j=0; j<i; j++) {
                    printf("%s\n",arr[j]);
            } 
```

我使用的比较器是

```
 int compare (const void * a, const void * b ) {
                    return strcmp(a, b);
            } 
```

但它在尝试编译时给了我分段错误错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:07:23.617

这样就可以了。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define size 10
int compare (const void * a, const void * b ) {
  return strcmp(*(char **)a, *(char **)b);
}
int main () {
    char *arr[size];
    char buf[1000];
    for (int i=0;i<size;i++) {
      arr[i]=strdup (gets (buf)); // using gets is risky because it can write past buf
    }
    qsort (arr, size, sizeof (char*), compare);
    for (int i=0;i<size;i++) {
      printf ("%s\n", arr[i]);
      free (arr[i]);
    }
} 
```

# video - RED5 - 配置问题 - 记录部分流

> ID：14014100
> 
> 赞同：0
> 
> 时间：2012-12-23T19:37:19.913
> 
> 标签：video, installation, red5, configure, rtmp

我以最简单的方式安装了 Red5。我正在使用 Ubuntu 12.10 32 位系统。我只是下载并提取了最新的编译版本（1.0.0）。我使 sh 脚本可执行并运行服务器......一切都很好......

我终于注意到，输出到我的流文件夹的所有视频几乎都是我通过 Red5-Recorder 录制的长度的一半或三分之一。

我换了另一个录音机；这次是Flash-VideoIO，但问题依旧。我查看了 red5recorder 的官方演示，他们的演示似乎运行良好。

我什至从他们的演示中提取了 SWF、config.xml 和 JS 文件，并在我的 red5 安装中试用了它们……不使用；相同的结果。

有人可以帮我吗？我应该配置一些东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T21:20:08.253

不幸的是，这似乎是用户在许多不同设置中发现的已知错误。

请参阅：[http ://code.google.com/p/red5/issues/detail?id=312](http://code.google.com/p/red5/issues/detail?id=312)

# php - 具有中等数字的php数组分页

> ID：14014105
> 
> 赞同：0
> 
> 时间：2012-12-23T19:37:49.967
> 
> 标签：php, pagination

我有一个数组分页类。但是该类显示所有页码。

我的意思是如果我有 100 页，它会显示所有 100 页码。

有人可以帮我在这个分页类中实现中间数字吗

```
<?php

  class pagination
  {

    /**
     * Properties array
     * @var array   
     * @access private 
     */
    private $_properties = array();

    /**
     * Default configurations
     * @var array  
     * @access public 
     */
    public $_defaults = array(
      'page' => 1,
      'perPage' => 10 
    );

    /**
     * Constructor
     * 
     * @param array $array   Array of results to be paginated
     * @param int   $curPage The current page interger that should used
     * @param int   $perPage The amount of items that should be show per page
     * @return void    
     * @access public  
     */
    public function __construct($array, $curPage = null, $perPage = null)
    {
      $this->array   = $array;
      $this->curPage = ($curPage == null ? $this->defaults['page']    : $curPage);
      $this->perPage = ($perPage == null ? $this->defaults['perPage'] : $perPage);
    }

    /**
     * Global setter
     * 
     * Utilises the properties array
     * 
     * @param string $name  The name of the property to set
     * @param string $value The value that the property is assigned
     * @return void    
     * @access public  
     */
    public function __set($name, $value) 
    { 
      $this->_properties[$name] = $value;
    } 

    /**
     * Global getter
     * 
     * Takes a param from the properties array if it exists
     * 
     * @param string $name The name of the property to get
     * @return mixed Either the property from the internal
     * properties array or false if isn't set
     * @access public  
     */
    public function __get($name)
    {
      if (array_key_exists($name, $this->_properties)) {
        return $this->_properties[$name];
      }
      return false;
    }

    /**
     * Set the show first and last configuration
     * 
     * This will enable the "<< first" and "last >>" style
     * links
     * 
     * @param boolean $showFirstAndLast True to show, false to hide.
     * @return void    
     * @access public  
     */
    public function setShowFirstAndLast($showFirstAndLast)
    {
        $this->_showFirstAndLast = $showFirstAndLast;
    }

    /**
     * Set the main seperator character
     * 
     * By default this will implode an empty string
     * 
     * @param string $mainSeperator The seperator between the page numbers
     * @return void    
     * @access public  
     */
    public function setMainSeperator($mainSeperator)
    {
      $this->mainSeperator = $mainSeperator;
    }

    /**
     * Get the result portion from the provided array 
     * 
     * @return array Reduced array with correct calculated offset 
     * @access public 
     */
    public function getResults()
    {
      // Assign the page variable
      if (empty($this->curPage) !== false) {
        $this->page = $this->curPage; // using the get method
      } else {
        $this->page = 1; // if we don't have a page number then assume we are on the first page
      }

      // Take the length of the array
      $this->length = count($this->array);

      // Get the number of pages
      $this->pages = ceil($this->length / $this->perPage);

      // Calculate the starting point 
      $this->start = ceil(($this->page - 1) * $this->perPage);

      // return the portion of results
      return array_slice($this->array, $this->start, $this->perPage);
    }

    /**
     * Get the html links for the generated page offset
     * 
     * @param array $params A list of parameters (probably get/post) to
     * pass around with each request
     * @return mixed  Return description (if any) ...
     * @access public 
     */
    public function getLinks($params = array())
    {
      // Initiate the links array
      $plinks = array();
      $links = array();
      $slinks = array();

      // Concatenate the get variables to add to the page numbering string
      $queryUrl = '';
      if (!empty($params) === true) {
        unset($params['page']);
        $queryUrl = '&amp;'.http_build_query($params);
      }

      // If we have more then one pages
      if (($this->pages) > 1) {
        // Assign the 'previous page' link into the array if we are not on the first page
        if ($this->page != 1) {
          if ($this->_showFirstAndLast) {
            $plinks[] = ' <a href="?page=1'.$queryUrl.'">&laquo;&laquo; First </a> ';
          }
          $plinks[] = ' <a href="?page='.($this->page - 1).$queryUrl.'">&laquo; Prev</a> ';
        }

        // Assign all the page numbers & links to the array
        for ($j = 1; $j < ($this->pages + 1); $j++) {
          if ($this->page == $j) {
            $links[] = ' <a class="selected">'.$j.'</a> '; // If we are on the same page as the current item
          } else {
            $links[] = ' <a href="?page='.$j.$queryUrl.'">'.$j.'</a> '; // add the link to the array
          }
        }

        // Assign the 'next page' if we are not on the last page
        if ($this->page < $this->pages) {
          $slinks[] = ' <a href="?page='.($this->page + 1).$queryUrl.'"> Next &raquo; </a> ';
          if ($this->_showFirstAndLast) {
            $slinks[] = ' <a href="?page='.($this->pages).$queryUrl.'"> Last &raquo;&raquo; </a> ';
          }
        }

        // Push the array into a string using any some glue
        return implode(' ', $plinks).implode($this->mainSeperator, $links).implode(' ', $slinks);
      }
      return;
    }
  } 
```

## 更新：

这是我的使用方式

```
$contacts = array();
if(count($contacts))
    { 
      $pagination = new pagination($contacts,  (isset($_GET['page']) ? $_GET['page'] : 1), 50);
      $ContactPages = $pagination->getResults();
  if (count($ContactPages) != 0) {
        echo $pageNumbers = $pagination->getLinks();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:57:11.793

首先，您应该在类头中声明您的类成员`$start`，例如`$pages`等，而不是按需声明它们。这将提高可读性和代码质量，并有助于避免错误。

要修复您的课程，请将 for 循环及其周围的代码更改为`getLinks()`：

```
// Assign the 'previous page' link into the array if we are not on the first page
if ($this->page != 1) {
  if ($this->_showFirstAndLast) {
    $plinks[] = ' <a href="?page=1'.$queryUrl.'">&laquo;&laquo; First </a> ';
  }
  $plinks[] = ' <a href="?page='.($this->start).$queryUrl.'">&laquo; Prev</a> ';
}

// Assign all the page numbers & links to the array
for ($j = $this->start + 1; $j < ($this->start + $this->pages + 1); $j++) {
   if ($this->page == $j) {
     $links[] = ' <a class="selected">'.$j.'</a> '; // If we are on the same page as the current item
   } else {
     $links[] = ' <a href="?page='.$j.$queryUrl.'">'.$j.'</a> '; // add the link to the array
   }
}

// Assign the 'next page' if we are not on the last page
if ($this->page < $this->pages) {
    $slinks[] = ' <a href="?page='.($this->start + $this->page + 2).$queryUrl.'"> Next &raquo; </a> ';
    if ($this->_showFirstAndLast) {
        $slinks[] = ' <a href="?page='.($this->pages).$queryUrl.'"> Last &raquo;&raquo; </a> ';
    }
} 
```

你没有 $this->start 的想法。

我已经基本测试过它并且它有效。

# php - php没有从html表单中获取变量

> ID：14014106
> 
> 赞同：-1
> 
> 时间：2012-12-23T19:37:57.207
> 
> 标签：php, html, forms, variables

我是 PHP 新手，所以我不确定我在这里做错了什么......

```
<?php

$date = $_POST['date'];
$promoter = $_POST['promoter'];
$email = $_POST['email'];
$headliner = $_POST['headliner'];
$headsite = $_POST['headsite'];
$headdesc = $_POST['headdesc'];
$support1 = $_POST['support1'];
$sup1site = $_POST['sup1site'];
$sup1desc = $_POST['sup1desc'];
$support2 = $_POST['support2'];
$sup2site = $_POST['sup2site'];
$sup2desc = $_POST['sup2desc'];
$support3 = $_POST['support3'];
$sup3site = $_POST['sup3site'];
$sup3desc = $_POST['sup3desc'];
$support4 = $_POST['support4'];
$sup4site = $_POST['sup4site'];
$sup4desc = $_POST['sup4desc'];
$support5 = $_POST['support5'];
$sup5site = $_POST['sup5site'];
$sup5desc = $_POST['sup5desc'];

print '<b>$date</b> - info: <a href="mailto:$email">$promoter</a><br />';
print '<b>$headliner</b> [<a href="$headsite" target="_blank">$headsite</a>]<br />';
print '<i>$headdesc</i><br />';
print '<b>$support1</b> [<a href="$sup1site" target="_blank">$sup1site</a>]<br />';
print '<i>$sup1desc</i><br />';
print '<b>$support2</b> [<a href="$sup2site" target="_blank">$sup2site</a>]<br />';
print '<i>$sup2desc</i><br />';
print '<b>$support3</b> [<a href="$sup3site" target="_blank">$sup3site</a>]<br />';
print '<i>$sup3desc</i><br />';
print '<b>$support4</b> [<a href="$sup4site" target="_blank">$sup4site</a>]<br />';
print '<i>$sup4desc</i><br />';
print '<b>$support5</b> [<a href="$sup5site" target="_blank">$sup5site</a>]<br />';
print '<i>$sup5desc</i><br />';

?> 
```

这是我提交后的结果...

```
$date - info: $promoter<br />
$headliner [$headsite]<br />
$headdesc<br />
$support1 [$sup1site]<br />
$sup1desc<br />
$support2 [$sup2site]<br />
$sup2desc<br />
$support3 [$sup3site]<br />
$sup3desc<br />
$support4 [$sup4site]<br />
$sup4desc<br />
$support5 [$sup5site]<br />
$sup5desc 
```

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T19:39:51.637

您必须使用双引号（`"`）字符串来扩展其中的变量。例如

```
print "<b>$date</b> - info: <a href=\"mailto:$email\">$promoter</a><br />"; 
```

见[http://php.net/manual/en/language.types.string.php#language.types.string.parsing](http://php.net/manual/en/language.types.string.php#language.types.string.parsing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T19:49:57.937

或者你可以这样写

```
print '<b>'.$date.'</b> - info: <a href="mailto:'.$email.'">'.$promoter.'</a><br />'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:56:18.783

尝试这个

```
 echo '<b>'.$date.'</b> - info: <a href="mailto:'. $email.'">'. $promoter .'</a><br />';
  print '<b>'.$headliner.'</b> <a href="'. $headsite.'" target="_blank">'. $headsite.'</a><br />';
  print '<i>'.$headdesc.'</i><br />';
  print '<b>'.$support1.'</b> <a href="'.$sup1site.'" target="_blank">'.$sup1site.'</a><br />';
  print '<i>'.$sup1desc.'</i><br />';
  print '<b>'.$support2.'</b> <a href="'.$sup2site.'" target="_blank">'.$sup2site.'</a><br />';
  print '<i>'.$sup2desc.'</i><br />';
  print '<b>'.$support3.'</b> <a href="'.$sup3site.'" target="_blank">'.$sup3site.'</a><br />';
  print '<i>'.$sup3desc.'</i><br />';
  print '<b>'.$support4.'</b> <a href="'.$sup4site.'" target="_blank">'.$sup4site.'</a><br />';
  print '<i>'.$sup4desc.'</i><br />';
  print '<b>'.$support5.'</b> <a href="'.$sup5site.'" target="_blank">'.$sup5site.'</a><br />';
  print '<i>'.$sup5desc.'</i><br />'; 
```

# jquery - 首先设置一个活动链接css并动态更改它

> ID：14014107
> 
> 赞同：0
> 
> 时间：2012-12-23T19:38:13.447
> 
> 标签：jquery, css, onclick, background-color

如果有人点击它，我有一个带有不同背景颜色的列表项的菜单。我使用这段代码来实现这一点：

```
$(function() {
   var links = $('a.link').click(function() {
       links.removeClass('active');
       $(this).addClass('active');
   });
}); 
```

那工作得很好。CSS 也可以正常工作，因此颜色会发生变化，但我有一个问题，那就是我无法在有人点击它之前将标准列表项设置为具有背景颜色。所以我想在有人点击它之前在列表项上有一个红色背景。如果有人单击不同的列表项，则此红色背景颜色必须从标准切换到单击的颜色。

我怎样才能做到这一点？

这是菜单：

```
<nav id="navigation">
<ul id="quick-index-nav" class="slim">
<li>
<a class="link" href="#">First one</a>
</li>
<li>
<a class="link" target="main" href="#">Second one</a>
</li>
<li>
<a class="link" href="#">Third one</a>
</li>
</ul>
</nav> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T12:43:09.987

我在脚本中添加了另一个 removeClass 并在列表项上提供了一个背景颜色，我希望在单击它之前将其突出显示。这就像一个魅力。

```
$(function() {
    $('a.link').click(function() {
       $('.link').removeClass('active');
       $('.a-class-name').removeClass('a-class-name');
       $(this).addClass('active');
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:06:09.833

你为什么把它放在一个var中？如果你想选择一个类，你需要把它放在一个 jquery 选择器中`$('.link')`

```
$(function() {
    $('a.link').click(function() {
       $('.link').removeClass('active');
       $(this).addClass('active');
   });
}); 
```

# c# - 实例化部分类：ASP.NET C# 中的页面类型

> ID：14014108
> 
> 赞同：0
> 
> 时间：2012-12-23T19:38:30.280
> 
> 标签：c#, partial-classes

下面是我试图通过实例化部分类以从单个 .aspx 页面中使用多个类（及其方法）的示例。

**登录.aspx：**

```
<%@ Page Language="C#" Codefile="Web_Code/LogonService.cs" Inherits="Client.LogonService" %>
<!-- html here, also will be calling methods here via a form --> 
```

**Web_Code/SessionHandler.cs：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Client {

    public partial class SessionHandler : Page {

        //Constructor method here

        public string setSessionUser(string username) {
            return "this works, this is just a test";
        }

    }   
} 
```

**Web_Code/LoginService.cs：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Client {

    public partial class LoginService : Page {

        public void checkCredentials(object sender, EventArgs e) {

            //Check credentials here

            //If credentials are good, add the username to session

            /* PROBLEM HERE: VS CAN'T FIND TYPE NOR INSTANTIATE*/
            SessionHandler ses = new SessionHandler();
            ses.setSessionUser(username.Value);  

        }
    }
} 
```

该问题在 Web_Code/LogonService.cs 中有注释 - 它无法实例化 SessionHandler。- 这是为什么？

我正在从 PHP 切换到 C#，在 PHP 世界中我会简单地输入“require(”Web_Code/SessionHandler.php“);” 并称它为一天，但 C# 的方式似乎更复杂一些。

我很感激任何意见！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T19:44:19.233

您正在尝试以 PHP 方式使用 .NET，最终这会给您带来问题。在 ASP.NET 中，您不（也可能不应该）从该类继承每个`Page`类。这通常仅用于您正在实现的特定网页的代码隐藏。在 WebForms 中，您还可以使用`Controls`, like `Label`,`Repeater`等而不是调用页面方法。此外，您已经可以访问页面中的`Session`对象和`User`对象，并且通常不需要添加自己的会话处理。

鉴于您才刚刚开始，您可能希望查看 ASP.NET MVC。对于网络编程来说，这是一个更好的范例。

# html - IndexedDB 中的地理空间查询

> ID：14014113
> 
> 赞同：2
> 
> 时间：2012-12-23T19:39:28.080
> 
> 标签：html, geospatial, indexeddb

我想将地理点和相关数据存储在浏览器的 IndexedDB 中，并能够在给定纬度/经度位置的情况下定位 X 个最近点。数据集可能包含数千个点，因此效率是一个考虑因素。是否有任何现有的解决方案可用于此类查询？如何建立索引以便可以找到靠近给定地理点的点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T02:08:17.947

对于查询两个变量，IndexedDB 有两个选项，手动合并和使用复合索引。

对于手动合并，您只需要索引 lat 和 long。然后您将对键光标进行键范围查询。交集就是结果。结果是主键。使用结果主键，您可以获得完整的记录。

```
var r = 10; // require distance
lat_range = IDBKeyRange.bound(query_lat - r, query_lat + r);
long_range = IDBKeyRange.bound(query_long - r, query_long + r);

obj_store = db.objectStore('geopoint');
lat_key_cursor = obj_store.index('lat').openKeyCursor(lat_range);
long_key_cursor = obj_store.index('long').openKeyCursor(long_range);

// get primary keys from cursors, sort and find intersection as results 
var cursor = obj_store.openCursor(results.shift());
cursor.onsuccess = function(e) {
  console.log(e.target.result);
  if (results.length > 0) {
    cursor.continue(results.shift());
  }
} 
```

通过将索引 keyPath 指定为数组 ['lat', 'long']，可以将 Lat 和 long 索引为数组复合索引。然后您将查询 'lat' 的范围查询。有效密钥的结果是“长”。在给定范围内过滤“长”并查询完整记录。

```
var compound_index = obj_store.index('lat, long');
var range = IDBKeyRange.bound([query_lat - r], [query_lat + r]);
var cursor = compound_index.openKeyCursor(range);
cursor.onsuccess = function(e) {
  var key = e.target.result.key();
  var lat = key[0];
  var long = key[1];
  if (long > query_long - r && long < query_long + r) {
     // we get result
     var req = obj_store.get(e.target.result.primaryKey());
     req.onsuccess = function(e2) {
        console.log(e2.target.result);
     }
  }
} 
```

# java - java - 如何使用java POI插入从excel表读取的数据库？

> ID：14014123
> 
> 赞同：0
> 
> 时间：2012-12-23T19:40:33.950
> 
> 标签：java

我正在使用 java POI 从 excel 表中读取值并需要插入到数据库中。我有来自 excel 表的字符串、数字和日期值，并且第一个字段是列标题。

```
public class SimpleExcelReadExample {
  static Connection con1 = null;
  static Connection con3 = null;
  static PreparedStatement preparedstatement = null;
  static ResultSet resultset = null;
  int j = 0;

  public static void main(String[] args) {

        String fileName = "D:/Excel/Report.xls";
        Cleartables.table_daily_report();
        Vector dataHolder = read(fileName);
        saveToDatabase(dataHolder);
  }

  public static Vector read(String fileName) {
        Vector cellVectorHolder = new Vector();
        try {
              FileInputStream myInput = new FileInputStream(fileName);
              POIFSFileSystem myFileSystem = new POIFSFileSystem(myInput);
              HSSFWorkbook myWorkBook = new HSSFWorkbook(myFileSystem);
              HSSFSheet mySheet = myWorkBook.getSheetAt(0);
              Iterator rowIter = mySheet.rowIterator();
              while (rowIter.hasNext()) {
                    HSSFRow myRow = (HSSFRow) rowIter.next();
                    Iterator cellIter = myRow.cellIterator();
                    Vector cellStoreVector = new Vector();
                    while (cellIter.hasNext()) {
                          HSSFCell myCell = (HSSFCell) cellIter.next();
                          //System.out.println("read method"+myCell);
                          cellStoreVector.addElement(myCell);
                    }
                    cellVectorHolder.addElement(cellStoreVector);
              }
        } catch (Exception e) {
              e.printStackTrace();
        }
        return cellVectorHolder;
  }

  private static void saveToDatabase(Vector dataHolder)
  {

                    for (int i=0;i<dataHolder.size(); i++)
                    {
                       Vector cellStoreVector=(Vector)dataHolder.elementAt(i);
                       for (int j=0; j < cellStoreVector.size();j++)
                    {
                             System.out.println("show.....");
                            HSSFCell myCell = (HSSFCell)cellStoreVector.elementAt(j);

                           Please help me here....How to get the each column values  ?
                    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-10T09:50:10.107

```
try {

        FileInputStream file = new FileInputStream(new File("E://Imp/Details.xlsx"));
        XSSFWorkbook workbook = new XSSFWorkbook(file);
        XSSFSheet sheet = workbook.getSheetAt(0);
        Iterator<Row> rowIterator = sheet.iterator();
        rowIterator.next();
        while(rowIterator.hasNext())
        {
            Row row = rowIterator.next();
            //For each row, iterate through each columns
            Iterator<Cell> cellIterator = row.cellIterator();

            while(cellIterator.hasNext())
            {
                Cell cell = cellIterator.next();
                //This will change all Cell Types to String
                cell.setCellType(Cell.CELL_TYPE_STRING);
                switch(cell.getCellType()) 
                {
                    case Cell.CELL_TYPE_BOOLEAN:
                        System.out.println("boolean===>>>"+cell.getBooleanCellValue() + "\t");
                        break;
                    case Cell.CELL_TYPE_NUMERIC:

                        break;
                    case Cell.CELL_TYPE_STRING:

                       list.add(cell.getStringCellValue());

                                                 break;
                }

            }
            name=row.getCell(0).getStringCellValue();
            empid=row.getCell(1).getStringCellValue();
            add=row.getCell(2).getStringCellValue();
            mobile=row.getCell(3).getStringCellValue();
            System.out.println(name+empid+add+mobile);
            ex.InsertRowInDB(name,empid,add,mobile);
            System.out.println("");

        }
        file.close();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
  }
    public void InsertRowInDB(String name,String empid,String add,String mobile) throws SQLException{

        Statement stmt=db.con.createStatement();
        PreparedStatement ps=null;
        String sql="Insert into Employee(Name,EmployeeId,Address,ContactInfo) values(?,?,?,?)";
        ps=db.con.prepareStatement(sql);
        ps.setString(1, name);
        ps.setString(2, empid);
        ps.setString(3, add);
        ps.setString(4, mobile);
    ps.executeUpdate();
    System.out.println("Values Inserted Successfully");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-02T09:11:34.050

Excel 文件插入数据库。这个对我有用。

导入的jar文件：

*   poi-ooxml 3.5-beta5
*   xmlbeans
*   apache-日志记录-log4j
*   dom4j-1.5
*   poi 3.10.1
*   兴趣点 3.14
*   poi ooxml-schema 3.7-beta5

不要忘记导入数据库`jar`文件。

希望它会帮助你。

```
public class ExcelToDatabase {
 public static void main(String[] args) {
  try {
   String filename = "exceldatabase.xlsx";
   try (FileInputStream file = new FileInputStream(new File(filename))) {
    Workbook workbook = WorkbookFactory.create(file);
    Class.forName("com.mysql.jdbc.Driver");
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/test", "root", "root");

    String jdbc_insert_sql = "INSERT INTO employee" + "VALUES(?,?,?)";
    PreparedStatement preStatement = con.prepareStatement(jdbc_insert_sql);

    Sheet sheet = workbook.getSheetAt(0);
    Row row;
    System.out.println("last row number is=========" + sheet.getLastRowNum());
    for (int i = 1; i <= sheet.getLastRowNum(); i++) {
     row = sheet.getRow(i);
     int empId = (int)(row.getCell(0).getNumericCellValue());
     String empName = row.getCell(1).getStringCellValue();
     String empEmail = row.getCell(2).getStringCellValue();

     String sql = "insert into employee " + "values('" + empId + "','" + empName + "','" + empEmail + "')";
     preStatement = (PreparedStatement) con.prepareStatement(sql);
     preStatement.execute();
     System.out.println("Records inserted.........." + i);

    }
    System.out.println("");
   }
  } catch (Exception e) {}
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-16T08:54:30.447

尝试这个：

尝试 {

```
 String jdbc_insert_sql = "INSERT INTO TBL_PUNETORET"
                + "( NUMRI_PERSONAL, EMRI_MBIEMRI,DATELINDJA,ADRESA,TELEFONI,DATA_PUNSIMIT,DATA_LARGIMIT,NJESIA,POZITA,TELEFONI_P,EMAIL,PERSHKRIMI,PUNTORI,REKOMANDUAR) "
                + "VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
        Class.forName("oracle.jdbc.driver.OracleDriver");

        PreparedStatement preStatement = con.prepareStatement(jdbc_insert_sql);
        con.setAutoCommit(false);

        FileInputStream input = new FileInputStream(filename);
        POIFSFileSystem fs = null;
        try {
            fs = new POIFSFileSystem(input);
        } catch (IOException ex) {
            Logger.getLogger(PunetoretForm.class.getName()).log(Level.SEVERE, null, ex);
        }
        HSSFWorkbook wb = new HSSFWorkbook(fs);
        HSSFSheet sheet = wb.getSheetAt(0);
        Row row;
        for (int i = 1; i <= sheet.getLastRowNum(); i++) {
            row = sheet.getRow(i);
            int numripersonal = (int) (row.getCell(0).getNumericCellValue());
            //String numripersonal =  row.getCell(0).getStringCellValue(); 
            String emri = row.getCell(1).getStringCellValue();
            Date datelindja = row.getCell(4).getDateCellValue();
            DateFormat df = new SimpleDateFormat("dd/MMM/yyyy");
            String reportDate = df.format(datelindja);
            df.parse(reportDate);
            String adresa = row.getCell(5).getStringCellValue();
            int telefoni = (int) (row.getCell(6).getNumericCellValue());
            //String telefoni = row.getCell(4).getStringCellValue();
            Date datap = row.getCell(7).getDateCellValue();
            df = new SimpleDateFormat("dd/MMM/yyyy");
            String reportDatap = df.format(datap);
            df.parse(reportDatap);

            Date datal = row.getCell(8).getDateCellValue();
            String ss = null;
            if (datal != null) {
                df = new SimpleDateFormat("dd/MMM/yyyy");
                ss = df.format(datal);
                df.parse(ss);

            }

            String njesia = row.getCell(9).getStringCellValue();
            String pozita = row.getCell(10).getStringCellValue();
            int telp = (int) (row.getCell(11).getNumericCellValue());
            if (telp == 0) {
                String s = String.valueOf(telp);
                s = "Ska numer";
            }
            //String telp = row.getCell(9).getStringCellValue();
            String email = row.getCell(12).getStringCellValue();
            String pershkrimi = row.getCell(13).getStringCellValue();
            String punetori = row.getCell(14).getStringCellValue();
            String rekomanduar = row.getCell(15).getStringCellValue();
            if (datal == null) {
                String sql = "INSERT INTO TBL_PUNETORET ( NUMRI_PERSONAL, EMRI_MBIEMRI,DATELINDJA,ADRESA,TELEFONI,DATA_PUNSIMIT,DATA_LARGIMIT,NJESIA,POZITA,TELEFONI_P,EMAIL,PERSHKRIMI,PUNTORI,REKOMANDUAR) "
                        + "VALUES('" + numripersonal + "','" + emri + "','" + reportDate + "','" + adresa + "','" + telefoni + "','" + reportDatap + "'," + datal + ",'" + njesia + "','" + pozita + "','" + telp + "','" + email + "','" + pershkrimi + "','" + rekomanduar + "','" + punetori + "')";
                preStatement = (PreparedStatement) con.prepareStatement(sql);
                preStatement.execute();
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-25T12:17:55.123

**这是我为同一操作编写的代码。请注意，我还创建了一个包含所有这 4 个属性的 Employee java 类：id、name、gender 工资及其 getter-setter。**

```
package com.hibernate.poiex2;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Iterator;
import java.util.Properties;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

/**
 *
 * @author nidhi
 */
public class POIex2 {

    XSSFRow row;
    Employee e = new Employee();

    public static void main(String[] args) throws IOException {

        String fileName = "/home/nidhi/Downloads/Employees.xlsx";
        POIex2 poIex2 = new POIex2();
        poIex2.readFile(fileName);
    }

    public void readFile(String fileName) throws FileNotFoundException, IOException {
        FileInputStream fis;
        try {
            System.out.println("-------------------------------READING THE SPREADSHEET-------------------------------------");
            fis = new FileInputStream(fileName);
            XSSFWorkbook workbookRead = new XSSFWorkbook(fis);
            XSSFSheet spreadsheetRead = workbookRead.getSheetAt(0);

            Iterator< Row> rowIterator = spreadsheetRead.iterator();
            while (rowIterator.hasNext()) {
                row = (XSSFRow) rowIterator.next();
                Iterator< Cell> cellIterator = row.cellIterator();

                while (cellIterator.hasNext()) {
                    Cell cell = cellIterator.next();
                    cell.setCellType(CellType.STRING);
                    switch (cell.getColumnIndex()) {
                        case 0:
                            System.out.print(
                                    cell.getStringCellValue() + " \t\t");
                            break;
                        case 1:
                            System.out.print(
                                    cell.getStringCellValue() + " \t\t");
                            break;
                        case 2:
                            System.out.print(
                                    cell.getStringCellValue() + " \t\t");
                            break;
                        case 3:
                            System.out.print(
                                    cell.getStringCellValue() + " \t\t");
                            break;
                        case 4:
                            System.out.print(
                                    cell.getStringCellValue() + " \t\t");
                            break;
                    }
                }
                System.out.println();
                e.empId = Integer.parseInt(row.getCell(0).getStringCellValue());
                e.empName = row.getCell(1).getStringCellValue();
                e.gender = row.getCell(2).getStringCellValue();
                e.salary = row.getCell(3).getStringCellValue();

                InsertRowInDB(e.empId, e.empName, e.gender, e.salary);
            }
            System.out.println("Values Inserted Successfully");

            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void InsertRowInDB(int empId, String empName, String gender, String salary) {

        Float salaryDB = Float.parseFloat(salary);
        try {

            Properties properties = new Properties();
            properties.setProperty("user", "root");
            properties.setProperty("password", "root");
            properties.setProperty("useSSL", "false");
            properties.setProperty("autoReconnect", "true");

            Class.forName("com.mysql.jdbc.Driver");
            Connection connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/Attendance", properties);
            Statement stmt = connect.createStatement();
            PreparedStatement ps = null;
            String sql = "INSERT INTO `Attendance`.`Employee_Master`\n"
                    + "(`EmployeeId`,\n"
                    + "`EmployeeName`,\n"
                    + "`Gender`,\n"
                    + "`Salary`)\n"
                    + "VALUES(?,?,?,?)";
            ps = connect.prepareStatement(sql);
            ps.setInt(1, empId);
            ps.setString(2, empName);
            ps.setString(3, gender);
            ps.setFloat(4, salaryDB);
            ps.executeUpdate();
            connect.close();
        } catch (ClassNotFoundException | SQLException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-07T10:06:40.087

尝试这个

```
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.AnnotationConfiguration;

import com.mani.beans.Student;

public class ReadDataFromExcel {
    public static void main(String args[]) throws IOException {
        SessionFactory sf = new AnnotationConfiguration().configure("com/mani/resources/hibernate.cfg.xml").buildSessionFactory();
        Session session = sf.openSession();
        FileInputStream file = new FileInputStream(new File("C:/Users/mani/Desktop/data.xlsx")); 
        XSSFWorkbook workbook = new XSSFWorkbook(file); 
        XSSFSheet sheet = workbook.getSheetAt(1); 
        Row row;
        for(int i=1; i<=sheet.getLastRowNum(); i++){  //points to the starting of excel i.e excel first row
            row = (Row) sheet.getRow(i);  //sheet number

                String id;
                if( row.getCell(0)==null) { id = "0"; }
                else id= row.getCell(0).toString();

                   String name;
                if( row.getCell(1)==null) { name = "null";}  //suppose excel cell is empty then its set to 0 the variable
                   else name = row.getCell(1).toString();   //else copies cell data to name variable

                   String address;
                if( row.getCell(2)==null) { address = "null";   }
                   else  address   = row.getCell(2).toString();
        Transaction t = session.beginTransaction();
        Student std = new Student();
        std.setId(Double.parseDouble(id));
        std.setName(name);
        std.setAddress(address);
        System.out.println(std.getId()+" "+std.getName()+" "+std.getAddress());
        session.saveOrUpdate(std);
        t.commit();     
        }
        file.close();
    }

}` 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-02-23T07:18:48.647

***如何从excel表中读取数据并插入到java中的数据库表中***

if (fileName.endsWith(".xls")) {

```
 CustomerVo customerVo = new CustomerVo();//your vo 
                File myFile = new File("file location" + fileName);
                FileInputStream fis = new FileInputStream(myFile);

                // Finds the workbook instance for XLSX file

                org.apache.poi.ss.usermodel.Workbook workbook = null;
                try {
                    workbook = WorkbookFactory.create(fis);
                } catch (InvalidFormatException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                Row row = null;
                // Return first sheet from the XLSX workbook
                org.apache.poi.ss.usermodel.Sheet sheet = workbook.getSheetAt(0);

                // Get iterator to all the rows in current sheet
                Iterator<Row> rowIterator = sheet.iterator();
                int i = 0;
                // Traversing over each row of XLSX file
                while (rowIterator.hasNext()) {

                    row = rowIterator.next();
                    Iterator<Cell> cellIterator = row.cellIterator();
                    if (i != 0) {

                        while (cellIterator.hasNext()) {
                            Cell cell = cellIterator.next();
                            if (i != 0) {
                                switch (cell.getCellType()) {
                                case Cell.CELL_TYPE_STRING:
                                    System.out.print(cell.getStringCellValue());
                                    customerVo.setName(row.getCell(1).getStringCellValue());
                                    customerVo.setSex(row.getCell(2).getStringCellValue());

                                    DateFormat formatter = new SimpleDateFormat("E MMM dd HH:mm:ss Z yyyy");
                                    Date date;
                                    try {
                                        date = (Date) formatter.parse(row.getCell(3).getStringCellValue());
                                        customerVo.setDob(date);
                                    } catch (ParseException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }

                                    customerVo.setEmail(row.getCell(4).getStringCellValue());
                                    customerVo.setAddress(row.getCell(6).getStringCellValue());
                                    customerVo.setCity(row.getCell(8).getStringCellValue());
                                    customerVo.setState(row.getCell(9).getStringCellValue());
                                    break;
                                case Cell.CELL_TYPE_BOOLEAN:
                                    System.out.print(cell.getBooleanCellValue());
                                    break;
                                case Cell.CELL_TYPE_NUMERIC:
                                    System.out.print(cell.getNumericCellValue());
                                    customerVo.setAccountnumber((int) row.getCell(0).getNumericCellValue());
                                    customerVo.setPincode((int) row.getCell(7).getNumericCellValue());
                                    customerVo.setBalance((int) row.getCell(10).getNumericCellValue());
                                    customerVo.setMobile((long) row.getCell(5).getNumericCellValue());
                                    break;
                                }
                                System.out.print(" - ");
                            }
                            i++;

                        }
                        System.out.println(customerVo);//your data store in the object
                        fileUploadService.customerFile(customerVo);//this method using mvc service to dao impl 
                    }
                    i++;
                }
            } 
```

// 用于将文件存储到 db

@Repository 公共类 FileUploadDAOImpl 实现 FIleUploadDAO {

```
@Autowired
private DataSource dataSource;

@Override
public CustomerVo customerFile(CustomerVo customerVo) {

    String query = "insert into file_upload_table(name,sex,dob,email,mobile,address,pincode,city,state,balance,account_number)"
            + "values(?,?,?,?,?,?,?,?,?,?,?)";

    Connection connection = null;
    try {
        connection = dataSource.getConnection();

        Date oldDate = new Date(customerVo.getDob().getTime());

        java.sql.PreparedStatement ps = null;
        java.sql.ResultSet rs = null;
        try {
            ps = connection.prepareStatement(query);
            // ps.setLong(1, customerVO.getAccountNo());
            ps.setString(1, customerVo.getName());
            ps.setString(2, customerVo.getSex());
            ps.setDate(3,oldDate);
            ps.setString(4, customerVo.getEmail());
            ps.setLong(5, customerVo.getMobile());
            ps.setString(6, customerVo.getAddress());
            ps.setLong(7, customerVo.getPincode());
            ps.setString(8, customerVo.getCity());
            ps.setString(9, customerVo.getState());
            ps.setLong(10, customerVo.getBalance());
            ps.setLong(11, customerVo.getAccountnumber());
            ps.executeUpdate();

        } catch (SQLException e) {
            // TODO: handle exception
            e.printStackTrace();
        }

    } catch (SQLException e) {

        // TODO Auto-generated catch block

        e.printStackTrace();
    } 
```

# javascript - 如何以另一种语言返回本地日期？

> ID：14014125
> 
> 赞同：0
> 
> 时间：2012-12-23T19:40:53.093
> 
> 标签：javascript, jquery

如何以其他语言而不是英语返回本地日期字符串？

我正在使用这个：

```
new Date().toLocaleDateString() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:48:08.313

您不能在 JS 中更改语言环境。我建议使用[**MomentJS**](http://momentjs.com/)库来处理日期。有了它，您的请求可以轻松解决...

```
var localLang = moment();
localLang.lang('fr');     // set this instance to use French
localLang.format('LLLL'); // dimanche 15 juillet 2012 11:01 
```

# android - 根据 Message 在 handleMessage 中动态更改 onClickListener

> ID：14014128
> 
> 赞同：1
> 
> 时间：2012-12-23T19:41:30.000
> 
> 标签：android

我有一个带有 Android.os.Handler 的 Activity，它用于与 openGL 线程进行通信。我想从opengl线程获取消息并根据消息数据在活动中绘制一些GUI，所以我这样做：

```
Handler handle = new Handler(new Handler.Callback(){
        public boolean handleMessage(Message msg){
            // update  GUI like
            TextView v1 = (TextView) GamescreenActivity .this.findViewById(R.id.mytextview)
            // then what I actually would like to do but it does not work:
            Button b = (Button) GamescreenActivity.this.findViewById(R.id.mybutton);
            b.setOnClickListener(null);
            if (msg.what == MY_OWN_CONSTANT) { 
                b.setOnClickListener(getOnClickDoSomething(msg));
            }
        }
View.OnClickListener getOnClickDoSomething(final Message msg)  {
    return new View.OnClickListener() {
        public void onClick(View v) {
            makeDialog(msg);
        }
    };
}
private void makeDialog(Message msg) {      
    AlertDialog.Builder builder = new AlertDialog.Builder(GamescreenActivity.this);
    builder.setMessage("yo")
    .setTitle(""+ msg.what);
    AlertDialog dialog = builder.create();
    dialog.show();
} 
```

我希望很清楚我想要达到的目标。我现在得到的是 msg 在 makeDialog 方法中几乎一直为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:43:27.330

> 我现在得到的是 msg 在 makeDialog 方法中几乎一直为空。

我相信当这种情况发生时，消息已经被回收了。让我们创建一个本地副本`msg`并稍微修改您的代码以使其更高效。首先创建一个新的字段变量：

```
Message message; 
```

接下来更改您的 if-else 块：

```
if (msg.what == MY_OWN_CONSTANT) { 
    message = Message.obtain(msg);
    b.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            AlertDialog.Builder builder = new AlertDialog.Builder(GamescreenActivity.this);
            builder.setMessage("yo")
                    .setTitle(""+ message.what)
                    .show();
            message.recycle(); // Recycle our message when we're done
        }
    });
}
else {
    b.setOnClickListener(null);
} 
```

# java - java 2客户端应用程序与服务器通信

> ID：14014136
> 
> 赞同：3
> 
> 时间：2012-12-23T19:43:07.257
> 
> 标签：java, sockets

我正在尝试一个简单的`socket programming`例子。我能够运行服务器应用程序和客户端应用程序以相互通信。我现在需要知道一个教程，它解释了 2 个客户端如何通过服务器相互通信。

我怎样才能做到这一点 ？有人可以指点我一个很好的教程或解释如何在 Java 中做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:02:18.120

这与编写客户端/服务器对没有什么不同和困难。您只需要在服务器上创建线程，在那里您接受来自客户端的连接。如果您的客户应该相互交流，那么您肯定需要一个列表来存储它们。你必须实现，你的服务器在这个线程中做什么（通信）。

这是一个很好的聊天程序教程：[http ://www.dreamincode.net/forums/topic/259777-a-simple-chat-program-with-clientserver-gui-optional/](http://www.dreamincode.net/forums/topic/259777-a-simple-chat-program-with-clientserver-gui-optional/)

# ios - 无法分配区域 malloc

> ID：14014137
> 
> 赞同：0
> 
> 时间：2012-12-23T19:43:10.473
> 
> 标签：ios

我收到此错误导致我的应用程序崩溃：

```
..Splash-it(1369,0x5783000) malloc: *** mmap(size=516096) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug 
```

我不知道为什么会导致错误。是内存问题错误吗？我该如何预防？“在 malloc_error_break 中设置断点进行调试”是什么意思？

感谢您的任何回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T13:39:18.403

在我的情况下，我得到这个是因为 imgCount 没有因为我的条件失败而获得价值。并且非 void 函数正在返回 imgCount 的值。

```
- (NSInteger)collectionView:(PSUICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
{
    NSInteger imgCount;
    if(collectionView == self.imageCollection) {
        imgCount=self.imageCount;
    }
    return imgCount;
} 
```

所以我通过将值分配给 imgcount 来解决它。这个对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-23T10:34:22.207

您可能试图一次分配太多内存。我试图 malloc 疯狂的大量内存，我得到了这个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:59:21.300

不确定，但这是在我的情况下发生的，我通过**删除 breakpoint**解决了。

我正在从服务器加载数据并将它们添加到 tableview 并隐藏或显示页脚。有时我的页脚视图没有按我想要的那样出现，所以我插入了断点来检查出了什么问题。但是经过一段时间做同样的活动后，我的应用程序出现了上述错误。

我在没有断点的情况下尝试了 2-3 次，它没有崩溃，但是，每当我添加断点时，就会发生错误。

这可能不是您的情况，但我想如果您在主线程上执行一些大型操作并且如果您插入了断点，您至少可以尝试一次。

# django - Django OperationalError：无法创建新的连接进程

> ID：14014138
> 
> 赞同：5
> 
> 时间：2012-12-23T19:43:30.817
> 
> 标签：django, postgresql, heroku, out-of-memory

今天早上我开始在生产环境中遇到这个错误，在昨天让 Django-storages、Boto 和 Django-compressor 工作将静态文件放在 S3 上之后，虽然我不知道这是否相关......

```
OperationalError: could not fork new process for connection: Cannot allocate memory

could not fork new process for connection: Cannot allocate memory
could not fork new process for connection: Cannot allocate memory

Stacktrace (most recent call last):

  File "django/core/handlers/base.py", line 89, in get_response
    response = middleware_method(request)
  File "reversion/middleware.py", line 17, in process_request
    if hasattr(request, "user") and request.user.is_authenticated():
  File "django/utils/functional.py", line 184, in inner
    self._setup()
  File "django/utils/functional.py", line 248, in _setup
    self._wrapped = self._setupfunc()
  File "django/contrib/auth/middleware.py", line 16, in <lambda>
    request.user = SimpleLazyObject(lambda: get_user(request))
  File "django/contrib/auth/middleware.py", line 8, in get_user
    request._cached_user = auth.get_user(request)
  File "django/contrib/auth/__init__.py", line 98, in get_user
    user_id = request.session[SESSION_KEY]
  File "django/contrib/sessions/backends/base.py", line 39, in __getitem__
    return self._session[key]
  File "django/contrib/sessions/backends/base.py", line 165, in _get_session
    self._session_cache = self.load()
  File "django/contrib/sessions/backends/db.py", line 19, in load
    expire_date__gt=timezone.now()
  File "django/db/models/manager.py", line 131, in get
    return self.get_query_set().get(*args, **kwargs)
  File "django/db/models/query.py", line 361, in get
    num = len(clone)
  File "django/db/models/query.py", line 85, in __len__
    self._result_cache = list(self.iterator())
  File "django/db/models/query.py", line 291, in iterator
    for row in compiler.results_iter():
  File "django/db/models/sql/compiler.py", line 763, in results_iter
    for rows in self.execute_sql(MULTI):
  File "django/db/models/sql/compiler.py", line 817, in execute_sql
    cursor = self.connection.cursor()
  File "django/db/backends/__init__.py", line 308, in cursor
    cursor = util.CursorWrapper(self._cursor(), self)
  File "django/db/backends/postgresql_psycopg2/base.py", line 177, in _cursor
    self.connection = Database.connect(**conn_params)
  File "psycopg2/__init__.py", line 178, in connect
    return _connect(dsn, connection_factory=connection_factory, async=async) 
```

我正在 Heroku 上部署该站点。我重新启动应用程序后它会工作一段时间，但几分钟后会再次停止工作。

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-24T22:23:22.880

我在尝试在 heroku 上使用 postgresql 数据库设置一个简单的 django Web 应用程序时遇到了同样的问题，并设法解决了它。

我不完全理解该错误，但修复相当简单：当您将查询创建的 python 列表传递到数据库时，您需要***限制列表的大小***。

因此，例如，如果您将以下列表作为上下文传递：

`set_list = userSetTable.objects.all()`

`return render(request, 'fc/user.html', {'set_list': set_list,})`

这将导致错误，因为 set_list 可能非常大。您需要指定最大尺寸：

```
set_list = userSetTable.objects.all()[0:20] 
```

因此，在实际应用程序中，您可能希望将列表显示为页面结果或其他任何内容……您明白了。

# php - 如何使用二进制数据存储关联数组以便在记事本中进行编辑？

> ID：14014139
> 
> 赞同：0
> 
> 时间：2012-12-23T19:43:31.870
> 
> 标签：php, var-dump

我有一个数组，它看起来像

```
$a=array('HEX'=>Chr(0).Chr(1).Chr(2),'b'=>123,'c'.......); 
```

我需要将它存储在文本文件中，在文本编辑器中打开并编辑它。

```
$fwp = fopen ('edit.txt', "wb");
FWrite($fwp,var_export($a,true));
FClose ($fwp); 
```

我看到十六进制数据存储为 'HEX' => '' 。"\0" 。[][] '' 并且在文本编辑器中加载保存后似乎丢失了。

那么，如何将它以二进制安全的方式存储在 php 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:46:47.080

您可以使用 json 格式。签出 json_encode() 函数。二进制数据问题稍微复杂一些，但也可以解决。您可以使用 base64_encode 将它们转换为 base64 格式。然后一切都将存储在清晰的 ASCII 中，没有任何乱码。

# c - 在 C 中使用 winmm 库

> ID：14014141
> 
> 赞同：2
> 
> 时间：2012-12-23T19:43:54.247
> 
> 标签：c, winmm

我正在尝试制作一个可以播放音乐的程序，即 mp3 文件。我正在尝试通过使用 winmm 库来做到这一点。起初，当我尝试链接它时，编译器给出了错误，我从中意识到该程序没有与库正确链接，但后来我在链接器设置中添加了库文件，现在程序执行良好（没有错误 - 表明它已正确链接）但没有播放音乐。我不知道问题是什么。我目前正在使用代码块，它使用 gcc 编译器。谁能解释问题是什么以及为什么音乐没有播放？如果有人可以帮助我，我将不胜感激！:)

我的代码（它只是打印文本但不播放音乐）：

```
#include <stdio.h>
#pragma comment (lib, "winmm.a")
#include <windows.h>
#include <mmsystem.h>

int main()
{
    printf("Hello world!\n");

    mciSendString("play song.mp3",NULL,NULL,NULL);

    printf("\nY");

    mciSendString("pause song.mp3",NULL,NULL,NULL);
    mciSendString("close song.mp3",NULL,NULL,NULL);

    printf("\ndone");

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T19:57:19.597

MCI 命令立即返回。这意味着您在开始播放之前立即暂停并关闭 mp3。查看文档，您必须使用[Wait Flag](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757622%28v=vs.85%29.aspx)：

```
mciSendString("play song.mp3 wait",NULL,NULL,NULL); 
```

# c# - 在 MVP 模式中，如何创建 List 类型的 Property 在视图中，其中 T 是实体框架生成的数据类型？

> ID：14014143
> 
> 赞同：0
> 
> 时间：2012-12-23T19:44:11.127
> 
> 标签：c#, asp.net, entity-framework, mvp

**前提：**我正在为一个 ASP.NET 项目使用实体框架、存储库模式和 MVP。

**问题：**在MVP模式中，如何在View中创建一个List<T>类型的Property，其中T是Entity Framework生成的数据类型？

在下面的代码中，List<TeamMember> 中的“TeamMember”是Entity Framework 基于SQL 表TeamMembersTable 创建的一个类。这里的问题是我在我的视图中创建一个 List<T> 属性，其中 T 是我的实体框架模型中的数据类型。这似乎违反了关注点分离，因为视图现在依赖于模型层中的数据类型。在这种情况下如何实现 View 和 Model 的干净分离？

**注意：**对于简单的 TextBox，这很容易，因为数据类型是 .NET 类型，如 String 或 DataTime。但是，如果要在 View 中创建的属性的 DataType 来自模型，那么就数据类型而言，这似乎使 View 与 Model 耦合更紧密。

```
//***************Simplified Code Sample*******************//
using Model;

namespace View
{
    public interface IEmployeeView
    {
        List<TeamMember> TeamMembers { set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T20:16:13.043

引入一个视图模型，它将代表您的 TeamMember 类并将其传递到您的视图中，例如

```
public class TeamMemberViewModel
{
    ...
}

public interface IEmployee
{
    public List<TeamMemberViewModel> TeamMembers { get; set; }
} 
```

# jquery - 拟态开关 CSS3 精灵动画只有一半的时间有效

> ID：14014144
> 
> 赞同：0
> 
> 时间：2012-12-23T19:44:18.213
> 
> 标签：jquery, css-sprites, css-animations

我的精灵动画在奇数点击（1、3、5 ......）上完美运行，这将开关置于向下位置，但我无法获得偶数点击（2、4、6......）来触发动画将开关置于向上位置。跨浏览器 CSS 从帖子中删除但在小提琴中。

[http://jsfiddle.net/aNsHU/8/](http://jsfiddle.net/aNsHU/8/)

**HTML**

```
<div class="switch s-up"></div> 
```

**jQuery**

```
$(document).ready(function() {

  $(".switch").click(function () {
    $(this).toggleClass("s-down s-up");
  });

})​ 
```

**CSS**

```
.switch{
  background: transparent url(http://i.imgur.com/taIR0.jpg);
  height:65px;
  width: 75px;
  margin-bottom:75px;
  cursor:pointer;
}
.s-down{
  animation: play .4s steps(5);
}
.s-up{
  animation: reverse .4s steps(5);
}
.switch.s-down{
  background: transparent url(http://i.imgur.com/taIR0.jpg) -300px 0;
}

@keyframes play {
   0% { background-position:    0px; }
   100% { background-position: -375px; }
}

@keyframes reverse {
   0% { background-position:   -375px; }
   100% { background-position: 0px; }
}​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T20:09:40.363

我联系了启发初始代码的人来帮助我解决问题。s-up 类需要包含播放和反向动画。谢谢[http://simurai.com/](http://simurai.com/)。

```
.s-up{
  animation: play reverse .4s steps(5);
} 
```

小提琴：

[http://jsfiddle.net/simurai/hEfpt/](http://jsfiddle.net/simurai/hEfpt/)

# maps - 在 Mapbox 地图中禁用鼠标滚轮缩放？

> ID：14014146
> 
> 赞同：2
> 
> 时间：2012-12-23T19:44:20.287
> 
> 标签：maps, mapbox

如何在 Mapbox 地图上禁用鼠标滚轮缩放？

[根据简单示例](http://mapbox.com/mapbox.js/examples/)，我正在尝试创建一个简单的地图：

```
mapbox.auto('map', 'examples.map-vyofok3q'); 
```

[Mapbox 文档说](http://mapbox.com/mapbox.js/api/v0.6.7/#mapbox.map)您可以在创建地图时提供额外的事件处理程序参数，包括 MM.MouseWheelHandler() 事件，但他们没有举例说明如何实际提供处理程序：

```
eventHandlers can be an array of event handlers, including any of the following:
.... MM.MouseWheelHandler() 
```

请有人举例说明如何使用此处理程序禁用鼠标滚轮缩放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-05T09:32:42.963

对于 Mapbox GL JS 地图

```
map.scrollZoom.disable(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T04:42:19.843

（这是一个带有支持论坛问题的替身，但我也会在这里写）-> [http://bl.ocks.org/4404508](http://bl.ocks.org/4404508)

# android - 为什么 Android XmlPullParser 在我的旧设备上真的很慢？

> ID：14014154
> 
> 赞同：4
> 
> 时间：2012-12-23T19:45:49.903
> 
> 标签：android, xmlpullparser

我已经实现了一个简单的 XML 解析器，使用官方 Android 指南`XmlPullParser`解析一个非常简单和短的 XML 文件（120 行，10.5Kb）。在我运行 Android 4.1.1 的 HTC One X 上，解析它需要几分之一秒。但是在我运行 Android 2.1 的 HTC Hero 上，它花了 3 多分钟...

我知道两者之间的硬件有很大的不同，但是3分钟对于这么小的文件？这是不可接受的......尤其是自从 API 1 以来 XmlPullParser 就已经可用，这么慢是没有意义的。

为了尝试查明问题，我一步一步地浏览了解析代码。而且我注意到这`nextTag()`是一个需要很长时间才能处理的问题，其他一切似乎都相当快。不知道这是不是唯一的问题......

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T04:29:04.923

经过更彻底的调试和研究后，我意识到问题并不`XmlPullParser`像我怀疑的那样，它只是没有任何意义......

真正的问题在于我正在解析 date 并使用`SimpleDateFormat`，指定与当前使用的语言环境不同的语言环境。ICS 以下的 Android 版本（如果我没记错的话）在这方面存在严重错误，并且需要很长时间才能加载`SimpleDateFormat`. 这些版本加载并缓存默认系统区域设置（用户设置），并且`Locale.US`在系统启动时，如果使用任何这些区域设置，`SimpleDateFormat`则操作速度很快。否则，它会像地狱一样缓慢。

我还`SimpleDateFormat`为每个日期解析创建了一个新实例，这是不必要且愚蠢的。使用单个对象作为实例变量，大大减少了解析文件所需的时间。

# iphone - 3 个文本框，总数必须为 100

> ID：14014156
> 
> 赞同：-1
> 
> 时间：2012-12-23T19:45:51.197
> 
> 标签：iphone, objective-c, xcode

所以我有 3 个文本字段（A、B、C），用户只能在其中输入数字，因为键盘是数字键盘。

如果用户尝试在每个框中输入超过 100 个，我有一个检查（这里的用户为我整理）会引发错误。

我需要一种方法来查看在文本字段中输入的数字，然后查看 3 的总数，然后相应地调整其他数字。

例如，我输入了以下内容：

示例 1 A = 50 我希望 B 填写剩余的 50

示例 2 A =40 B=50 C=10

然后我将A更改为60。现在总数为120。我希望它看看B，然后拿走20，所以我有以下。A=60 B=30 C=10

我见过这样的场景，用户有 2 个文本字段，他想要总计 100 个，但我没有看到要求 3 个的线程。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:09:24.093

假设您有三个字段。这是伪代码。将此委托功能附加到所有 3 个文本区域。

```
// Take 3 fields
FieldA, FieldB, FieldC

// Total target to reach
TotalTarget = 100

// The total we currently have
total = FieldA + FieldB + FieldC

// Work out how much we are under by. 
// If positive, we are under. If negative, we are over.
underBy = TotalTarget - total

// Now two variables for the 'other two' fields.
if sender == FieldA:
  other1 = FieldB, other2 = FieldC
if sender == FieldB:
  other1 = FieldA, other2 = FieldC
if sender == FieldC:
  other1 = FieldA, other2 = FieldB

// Split the difference and assign to other 2 fields so they are raised or lowered the same amount.
// If under, add, if over, subtract.
other1 = other1 + overBy / 2
other2 = other2 + overBy / 2        

// This will add 1 or 0 to other2 (i.e. compensate for round-down)
other2 = other2 + overBy % 2; 
```

如果您使用整数除法，那么您将遇到舍入问题。提示：如果它很奇怪，您可以在其中一个字段中添加一个。

确保编写测试。我没有尝试过任何这些，但它应该可以工作。

# java - Java中的双倍分数

> ID：14014158
> 
> 赞同：4
> 
> 时间：2012-12-23T19:46:07.627
> 
> 标签：java, double, fractions

所以我想做的是将双精度数转换为有理数。我检查小数点后有多少位数，例如，我想将数字 123.456 保存为 123456 / 1000。

```
public Rational(double d){      
    String s = String.valueOf(d);
    int digitsDec = s.length() - 1 - s.indexOf('.');        

    for(int i = 0; i < digitsDec; i++){
        d *= 10;
    }

    System.out.println((int)d); //checking purposes
} 
```

但是，对于数字 123.456，我得到一个舍入错误，结果是 123455。我想可以用 BigDecimal 解决这个问题，但我无法让它工作。另外，在计算了有理数之后，我想用参数（int numerator, int denominator）调用另一个构造函数，但我显然不能在 println 现在所在的行中调用构造函数。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T19:51:33.533

对于问题的第一部分，Java 将 .6 存储为 .5999999（重复）。看到这个输出：

```
(after first multiply): d=1234.56
(after second multiply): d=12345.599999999999
(after third multiply): d=123455.99999999999 
```

一种解决方法是在循环完成后立即使用 d = Math.round(d) 。

```
public class Rational {

     private int num, denom;

     public Rational(double d) {
          String s = String.valueOf(d);
          int digitsDec = s.length() - 1 - s.indexOf('.');        

          int denom = 1;
          for(int i = 0; i < digitsDec; i++){
             d *= 10;
             denom *= 10;
          }
          int num = (int) Math.round(d);

          this.num = num; this.denom = denom;
     }

     public Rational(int num, int denom) {
          this.num = num; this.denom = denom;
     }

     public String toString() {
          return String.valueOf(num) + "/" + String.valueOf(denom);
     }

     public static void main(String[] args) {
          System.out.println(new Rational(123.456));
     }
} 
```

它有效 - 试试看。

对于你问题的第二部分......

为了从第一个调用第二个构造函数，您可以使用“this”关键字

```
this(num, denom) 
```

但它必须是构造函数中的第一行......这在这里没有意义（我们必须先做一些计算）。所以我不会费心去尝试这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-01T19:00:31.760

这里，d=123.456 然后 num=123456, j=1000。

```
/**
 * This method calculates a rational number from a double.
 * The denominator will always be a multiple of 10\. 
 *
 * @param d the double to calculate the fraction from.
 * @return the result as Pair of <numerator , denominator>.
 */
private static Pair<Integer,Integer> calculateRational(double d){
    int j=1, num;
    do{
        j=j*10;
    }while((d *j)%10!=0);
    j=j/10;
    num=(int)(d*j);
    return new Pair<>(num,j);
} 
```

这里有一些测试：

```
@Test
public  void testCalculateRational() {
    Assert.assertEquals(new Pair<>(124567, 1000), calculateRational(124.567));
    Assert.assertEquals(new Pair<>(12456, 100), calculateRational(124.56));
    Assert.assertEquals(new Pair<>(56, 100), calculateRational(0.56));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-28T12:09:11.407

这段代码对你来说可能有点过头了，但它处理了你遇到的舍入错误，它还负责重复小数（4.99999999999999 变成 5，0.33333333333333333333 变成 1/3）。

```
public static Rational toRational(double number){
return toRational(number, 8);
}

public static Rational toRational(double number, int largestRightOfDecimal){

long sign = 1;
if(number < 0){
    number = -number;
    sign = -1;
}

final long SECOND_MULTIPLIER_MAX = (long)Math.pow(10, largestRightOfDecimal - 1);
final long FIRST_MULTIPLIER_MAX = SECOND_MULTIPLIER_MAX * 10L;
final double ERROR = Math.pow(10, -largestRightOfDecimal - 1);
long firstMultiplier = 1;
long secondMultiplier = 1;
boolean notIntOrIrrational = false;
long truncatedNumber = (long)number;
Rational rationalNumber = new Rational((long)(sign * number * FIRST_MULTIPLIER_MAX), FIRST_MULTIPLIER_MAX);

double error = number - truncatedNumber;
while( (error >= ERROR) && (firstMultiplier <= FIRST_MULTIPLIER_MAX)){
    secondMultiplier = 1;
    firstMultiplier *= 10;
    while( (secondMultiplier <= SECOND_MULTIPLIER_MAX) && (secondMultiplier < firstMultiplier) ){
        double difference = (number * firstMultiplier) - (number * secondMultiplier);
        truncatedNumber = (long)difference;
        error = difference - truncatedNumber;
        if(error < ERROR){
            notIntOrIrrational = true;
            break;
        }
        secondMultiplier *= 10;
    }
}

if(notIntOrIrrational){
    rationalNumber = new Rational(sign * truncatedNumber, firstMultiplier - secondMultiplier);
}
return rationalNumber;
} 
```

这提供了以下结果（测试用例的结果显示为注释）：

```
Rational.toRational(110.0/3.0); // 110/3
Rational.toRational(11.0/1000.0); // 11/1000
Rational.toRational(17357.0/33300.0); // 17357/33300
Rational.toRational(215.0/21.0); // 215/21
Rational.toRational(0.123123123123123123123123); // 41/333
Rational.toRational(145731.0/27100.0); // 145731/27100
Rational.toRational(Math.PI); // 62831853/20000000
Rational.toRational(62.0/63.0); // 62/63
Rational.toRational(24.0/25.0); // 24/25
Rational.toRational(-24.0/25.0); //-24/25
Rational.toRational(-0.25333333333333333333333); // -19/75
Rational.toRational(-4.9999999999999999999999); // -5
Rational.toRational(4.9999999999999999999999);  // 5
Rational.toRational(123.456); // 15432/125 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-23T20:55:23.270

但是，它并不优雅，我相信这可以满足您的要求。

```
double a = 123.456;
String aString = Double.toString(a);        
String[] fraction = aString.split("\\.");

int denominator = (int)Math.pow(10, fraction[1].length());
int numerator = Integer.parseInt(fraction[0] + "" + fraction[1]);

System.out.println(numerator + "/" + denominator); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T19:57:18.190

尝试

```
for(int i = 0; i <= digitsDec; i++){

} 
```

# c# - 如何在 C# 中保持 Windows 应用程序处于活动状态？

> ID：14014165
> 
> 赞同：-3
> 
> 时间：2012-12-23T19:47:49.290
> 
> 标签：c#, timer, keep-alive

我的主函数中有一个包含以下代码的应用程序：

> var timer = new System.Threading.Timer(Callback_f, null, TimeSpan.Zero, TimeSpan.FromMinutes(srcInterval));

好的，这实际上有效，但只有当我放一些东西来让我的应用程序保持活力时，比如`console.readkey()`或无限循环：

```
while (true) 
{

}. 
```

无限循环对我来说不是一个选择，因为它太耗时了。问题是我也不能使用该`console.readkey`功能，因为它是一个 Windows.forms 应用程序，其中没有任何表单。（即当我将它作为控制台应用程序运行并`console.readkey()`在最后放置一个方法时它可以工作。但是我想避免显示黑色窗口，它是一个在后台运行的没有界面的应用程序）。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T19:51:29.033

尝试使用方法[Thread.Join();](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)

# jquery - 如何将鼠标事件从父 iframe 传递给子 iframe

> ID：14014167
> 
> 赞同：0
> 
> 时间：2012-12-23T19:48:01.693
> 
> 标签：jquery, events, iframe, mousemove

我需要在我的主机页面的子 iframe 中使用 jQuery UI。我的问题是，如果用户鼠标在子 iframe 之外移动到父 iframe 中，则拖动操作效果不佳。如果发生这种情况，则不再将 mousemove 事件或 mouseup 事件发送到 UI 控件。我已经用我自己的 GUI 函数解决了这个问题，只需让父级将这些事件传递给子级进行处理，但使用 jQuery UI 我不知道如何正确传递这些事件。在下面的示例中，我展示了使用触发器将事件传递给子 iframe 的失败尝试。

有谁知道将这些事件传递给子 iframe 并让 jQuery UI 能够正确处理它们的方法？

这是我的主机页面：

```
<!DOCTYPE html>
<html lang="en-us">
<head>
    <script src="/SharedLib/jquery-1.8.3.js" type="text/javascript"></script>
    <script type="text/javascript">
        var MouseMoveCallback;
        function OnMouseMove(e) {
            if (MouseMoveCallback)
                MouseMoveCallback(e);
        }
        $(document).ready(function () {
            $(document).mousemove(OnMouseMove);
        });
    </script>
</head>
<body>
    <p>
        If your mouse strays outside of the iframe during a drag of the slide handle
        it no longer moves or detects mouseup.
    </p>
    <iframe src="EventTestChildFrame.html" style="width: 500px; height: 80px;">
    </iframe> 
</body>
</html> 
```

这是我的孩子 iframe，它丢失了鼠标事件：

```
<!DOCTYPE html>
<html lang="en-us">
<head>
    <link href="/SharedLib/jquery-ui-1.9.2.custom/css/smoothness/jquery-ui-1.9.2.custom.css" rel="stylesheet" />
    <script src="/SharedLib/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script src="/SharedLib/jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.js"></script>
    <script type="text/javascript">
        function OnMouseMove(e) {
            // this doesn't work...
            $(document).trigger("mousemove", e);
        }
        $(document).ready(function () {
            parent.MouseMoveCallback = OnMouseMove;
            $("#slider").slider();
        });
    </script>
</head>
<body style="background-color: #D0D0D0;">
    <p>Child iframe with jQuery UI control.</p>
    <div id="slider" style="margin: 8px;"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:57:23.327

您可以尝试将消息发布到 iframe。有点不清楚您需要子 iframe 如何对消息做出反应，但也许这有助于在那里迈出一步：

把它放在 iframe 页面中：

```
window.addEventListener('message',function(e) {
}); 
```

给 iframe 一个 ID 并在父页面中执行此操作以将消息（可以是字符串或对象，任何东西）传递给 iframe：

```
document.getElementById("iframe_id").contentWindow.postMessage({ "json_example": true }, "*"); 
```

将其放在父级中以收听消息：

```
window.addEventListener("message", messageReceived, false);
function messageReceived(e) {
} 
```

从 iframe 内部发回一条消息： window.parent.postMessage('Hello Parent Page','*');

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T06:56:22.853

我发现 jquery.simulate.js 完美地解决了这个问题。我所要做的就是改变一切`$(document).trigger("mousemove", e);`，`$(document).simulate("mousemove", e);`一切正常。

# html - 调整浏览器大小时图像溢出容器

> ID：14014171
> 
> 赞同：1
> 
> 时间：2012-12-23T19:48:23.740
> 
> 标签：html, css

我已经开始设计一个网站，并且我使用了一个包装器来放置我的信息和图像。我已将我的第一张图片添加到包装器中，当浏览器全尺寸时，它看起来很棒。

但是当我调整浏览器的大小时，图像（这是一个穿过页面的链）移出包装器的每一侧。

理想情况下，我想更改它，以便在调整浏览器大小并滚动页面时，链保留在包装器内。

```
body {
    background-color:#2791ce;
    background-image:url(../img/images/lightblue_02.jpg);
    background-size:98%;
    background-repeat: repeat-y;
    background-position:center;
}

#wrapper {
    width:1174px;
    margin-left:auto;
    margin-right:auto;
    position:relative;
    padding-bottom:350px;
}

#logo {
    position:relative;
    padding-left:6%;
    margin-left:auto;
    margin-right:auto;
}

#chain {
    position:relative;
    margin-left:auto;
    margin-right:auto;
    padding-top:5%;
} 
```

```
<html>
</head>
<body/>
<div id="wrapper">
    <div id="logo">
        <img src="img/images/skip.png"/>
    </div>
    <div id="chain">
        <img src="img/images/images/images/Untitled-1_02_02.png" width="1174" height="32" /> 
    </div>
</div>    
</div>
</body>
</html>
<html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:34:40.800

如果您想保持纵横比，请尝试将这些线条添加到您的图像中。我正在考虑 img 是你的形象类。

```
.img {
max-width:<max-width of your parent div>
max-height:<max-height of your parent div>
} 
```

如果要缩放图像，请插入以下代码。

```
.img {
width:100%;
max-width:100%;
display:block;
height:100%;
max-height:100%;
} 
```

# javascript - 是否可以仅通过 Javascript 获取外部图像并通过 REST API 发送？

> ID：14014174
> 
> 赞同：1
> 
> 时间：2012-12-23T19:48:49.760
> 
> 标签：javascript, image, parse-platform

我有一个表单，用户可以在其中粘贴图像的外部 url。是否可以通过 javascript 获取该文件，然后将其发布到 REST API？我将 parse.com 用于其余的 api。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:51:26.010

> …图像的外部网址。是否可以通过 javascript 去获取该文件……</p>

[不可以。这是由同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)阻止的，您将不被允许访问它。只需将它的 URL 发布到您的 REST api 并在服务器端获取它。

虽然您无法访问与其关联的文件或数据，但您当然可以通过`<img>`元素嵌入来显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:43:06.747

无论如何，由于使用跨域资源的限制，首先必须将图像拉到您的服务器上。完成此操作后，您可以使用我精心制作的示例将图像转换为准备好传输到服务器`Base64`的字符串：`JSON``POST``REST`

```
<input id="urlText" />
<input id="sendData" type="submit" />
<img id="img" src="http://fiddle.jshell.net/img/logo.png" />
<script>
var imgElem = document.getElementById('img');
$('#urlText').keyup(function(){
   $('#img').attr('src',$('#urlText').val());
});

$('#sendData').click(function(){
var imgData = JSON.stringify(getBase64Image(imgElem));
  $.ajax({
  url: 'http://url.com/rest/api',
  dataType: 'json',
  data: imgData,
  type: 'POST',
  success: function(data) {
    console.log(data);
    }
  });
});

function getBase64Image(imgElem) {
// imgElem must be on the same server otherwise a cross-origin error will be thrown "SECURITY_ERR: DOM Exception 18"
    var canvas = document.createElement("canvas");
    canvas.width = imgElem.clientWidth;
    canvas.height = imgElem.clientHeight;
    var ctx = canvas.getContext("2d");
    ctx.drawImage(imgElem, 0, 0);
    var dataURL = canvas.toDataURL("image/png");
    return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
}
</script> 
```

我的[jsFiddle 示例](http://jsfiddle.net/jasdeepkhalsa/L5HmW/)在这里。

# php - 在 PHP 中从十六进制字符串写入二进制数据

> ID：14014175
> 
> 赞同：4
> 
> 时间：2012-12-23T19:48:56.503
> 
> 标签：php, string, hex, fwrite

我正在尝试从十六进制字符串编写二进制文件。例如，如果我的十六进制字符串是`C27EF0EC`，那么十六进制文件应该包含、和的**ASCII**字符。 我该怎么做？`C2``7E``F0``EC`
`PHP`

这是我尝试过的：

```
$s="";
for ($i=0; $i<count($h); $i++) {
    $s+=pack("C*", "0x".$h[$i]);
}
$f2=fopen("codes0", "wb+");
fwrite($f2, $s); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:08:08.087

所以你需要做的第一件事是把你的单个字符串变成一个包含两个字符的字符串数组`str_split`。

```
$hex_bytes = str_split($h, 2); 
```

然后，您想将这些值中的每一个从十六进制字符串转换为相应的数字`hexdec`。

```
$code_array = array_map(hexdec, $hex_bytes); 
```

然后，您需要与每个字符代码对应的字节值，您可以通过以下方式获得`chr`：

```
$char_array = array_map(chr, $code_array); 
```

最后，您希望将所有这些字节连接到一个字符串中，您可以使用`implode`.

```
$s = implode($char_array); 
```

您可以按顺序使用上述步骤，也可以将它们放在一个表达式中，如下所示：

```
$s = implode(array_map(chr, array_map(hexdec, str_split($h,2)))); 
```

请注意，一旦您获得高于 0x7F 的值，它就不再是“ASCII”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-18T01:55:50.860

假设该数组`$binary`是您希望按此确切顺序写入磁盘的先前构造的数组字节（如我的情况下的单色位图像素），则以下代码在运行 ubuntu 服务器 10.04 LTS 的 AMD 1055t 上为我工作。

我遍历了我可以在网上找到的每一种答案，检查输出（我使用了 shed 或[vi，就像在这个答案中一样](https://stackoverflow.com/a/9441399/946112)）来确认结果。

```
<?php
$fp = fopen($base.".bin", "w");
$binout=Array();
for($idx=0; $idx < $stop; $idx=$idx+2 ){
    if( array_key_exists($idx,$binary) )
        fwrite($fp,pack( "n", $binary[$idx]<<8 | $binary[$idx+1]));
    else {
        echo "index $idx not found in array \$binary[], wtf?\n";
    }
}
fclose($fp);
echo "Filename $base.bin had ".filesize($base.".bin")." bytes written\n";
?> 
```

# sql-server - 单击按钮时我的存储过程没有更新

> ID：14014176
> 
> 赞同：0
> 
> 时间：2012-12-23T19:49:03.570
> 
> 标签：sql-server, vb.net, visual-studio-2010

这是我进行更新的存储过程，当我使用 SQL Server 测试该过程时，它运行良好。

```
ALTER PROCEDURE [TKSFlex].[UpdateComment]
-- Add the parameters for the stored procedure here
  @Comment char(50),
  @Employee char(25)
AS
BEGIN TRANSACTION 
 -- SET NOCOUNT ON added to prevent extra result sets from
 -- interfering with SELECT statements.
 SET NOCOUNT On;

    -- Insert statements for procedure here

 Update whiteboard set Comment = @Comment 
 where Employee = @Employee

COMMIT 
```

这是单击更新按钮时执行的代码

```
Private Sub btnUpdate_Click(ByVal sender As System.Object, ByVal es System.EventArgs) Handles btnUpdate.Click

    InputsModule.Employee = "'Mathe BF'"
    Objconn.Open()

    dbcommand.Connection = Objconn

    dbcommand.CommandType = CommandType.StoredProcedure
    dbcommand.CommandText = "[TKSFlex].[UpdateComment]"

    dbcommand.Parameters.AddWithValue("@Comment", txtComment.Text)
    dbcommand.Parameters.AddWithValue("@Employee", InputsModule.Employee)

    'dbcommand.Parameters.Add("@Comment", SqlDbType.Char).Value = txtComment.Text
    'dbcommand.Parameters.Add("@Employee", SqlDbType.Char).Value = InputsModule.Employee
    Dim i As Integer = 0

    Try
        i = dbcommand.ExecuteNonQuery()
    Catch ex As SqlException
        MsgBox("failed")
    End Try

    Objconn.Close()
End Sub 
```

执行查询时表没有更新并且没有抛出异常，这意味着代码确实被执行但没有对数据库进行修改，我只是不确定我哪里出错了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T19:59:50.333

最合乎逻辑的原因是：

```
InputsModule.Employee = "'Mathe BF'" 
```

那应该是：

```
InputsModule.Employee = "Mathe BF" 
```

ADO.NET 将为您引用该参数。手动输入引号将导致搜索quote-mathe bf-quote，它可能不存在:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:59:50.663

对于添加值，您需要指定参数的类型，如下面的代码所示。

`SqlParameter parameter = command.Parameters.AddWithValue("paramName", value); parameter.SqlDbType = SqlDbType.Int;`

# java - 使用 XMLslurper 获取内部数据

> ID：14014178
> 
> 赞同：2
> 
> 时间：2012-12-23T19:49:28.713
> 
> 标签：java, grails, groovy

我正在摆弄一个股票报价器应用程序。我正在使用谷歌的服务。所以，我阅读了他们的页面并解析了 XML。我可以遍历 xml，但问题是 Google 将实际信息放入标签中。所以，对于最新的价格，我会迭代到：< last data="30.32" />。但我无法读取实际数据部分。我尝试像 groovy api 所说的那样使用@data，但它只是返回空白。这是我的代码：

```
def stockTicket(params) {
  def BASE_URL = "http://www.google.com/ig/api?stock="+params.url
  def stock_url = BASE_URL
    def url = stock_url.toURL().text
    stock_url = urlMaker(stock_url)

    def slurper = new XmlSlurper()
   BufferedReader br = new BufferedReader(new InputStreamReader(stock_url.openStream()))
    String strTemp = ""
    strTemp = br.readLine()
    def records = new XmlSlurper().parseText(url)
    render records.xml_api_reply.finance.last.@data.text()

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:53:52.500

您只需

```
records.finance.last.@data 
```

slurper 已经指向根节点

# ruby-on-rails - Rails 模型关系，有很多和属于很多吗？

> ID：14014179
> 
> 赞同：2
> 
> 时间：2012-12-23T19:49:32.527
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model

我有以下结构：

```
class User < ActiveRecord::Base
end

class Item < ActiveRecord::Base
end

class Group < ActiveRecord::Base
end 
```

A`User`可以创建（并因此拥有） a `Group`。
A`Group`是可以访问这些项目的列表`Items`和列表。`Users`换句话说，用户拥有一个列表，`Items`并且可以控制哪些人`Users`可以通过成员资格查看这些项目`Group`。

我应该如何建立关系？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T21:14:29.107

好吧，你会遇到一些问题，因为你想要一个双多对多的关系。IE。组拥有并属于许多项目，项目拥有并属于许多用户。

所以，我会以这种方式设置关系，假设您希望一个组能够拥有许多项目，并且项目可能属于多个组：

```
User has_many :groups
User has_and_belongs_to_many :items
User has_many :own_items, :class_name => 'Item'

Group belongs_to :user
Group has_and_belongs_to_many :items

Item has_and_belongs_to_many :groups
Item has_and_belongs_to_many :users
Item belongs_to :owner, :class_name => 'User' 
```

您的迁移需要如下所示：

```
# Group
:user_id, :integer

# Item
:owner_id, :integer

# GroupsItems
:group_id
:item_id

#ItemsUsers
:item_id
:user_id 
```

现在，您正在查看的结构并不是世界上最干净的，但只要您注意用户关联，它就会按照您的预期运行。

例如，要创建用户的项目：

```
@user = User.first
@user.own_items.create(...) 
```

要分配用户能够查看项目...

```
@item = Item.find(...) #or @user.own_items.find(...)
@item.users = [user1,user2,user3] 
```

现在，这设置了您想要的关系，但是您还必须编写自己的控制器/视图逻辑来限制访问，或者使用像 CanCan 这样的库。

例如：

```
# View
- if @item.users.include?(current_user)
  ...show item... 

# Items Controller:
def show
  @item = Item.find(params[:id])
  if @item.users.include?(current_user)
    ...continue...
  else
    redirect_to :back, :alert => 'You are not authorized to view this item.'
  end
end 
```

我希望这些例子能为您指明正确的方向。您将有许多与访问控制相关的问题需要处理，但尝试思考它们并解决我能想到的每一个问题都超出了这个问题的范围。

另外，请注意，这是我能想到的最简单的设置。如果您在关联中有更复杂的逻辑，您可能想要制作一个完整的连接模型并使用 has_many :through 关联而不是 HABTM。

祝你好运！

# javascript - 扩展缩略图 Twitter Bootstrap

> ID：14014180
> 
> 赞同：2
> 
> 时间：2012-12-23T19:49:48.673
> 
> 标签：javascript, twitter-bootstrap

参考：http: [//twitter.github.com/bootstrap/components.html#thumbnails](http://twitter.github.com/bootstrap/components.html#thumbnails)

我一直在使用 Twitter Bootstrap，但是当我点击缩略图时，我无法将它们展开为全尺寸图像。我是否必须使用 jQuery 手动实现这个，或者 boostrap 在他们的 JS 库中支持这个？

如果我必须使用 jQuery，有人可以指出他们的文档中可能提到的地方吗？

谢谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T20:23:28.043

是的，您必须手动实现此功能。

有很多 jQuery 插件可用于此。我喜欢[Fancybox](http://fancybox.net)和[prettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone)。

此链接可能对您有所帮助： [15 个令人惊叹的 jQuery Lightbox 插件，适用于您即将推出的设计](http://www.onextrapixel.com/2012/03/29/15-stunning-jquery-lightbox-plug-ins-for-your-upcoming-designs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-09T15:30:08.693

这可以通过 Bootstrap 来完成。

像这样：

```
 <a href="images/content/dummy-image.jpg" class="thumbnail"><img src="images/content/dummy-image.jpg " alt='Dummy Image' /></a> 
```

我设置了视口比例并确保也使用了您的 Bootstrap JS 和 CSS 链接：

```
 <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-11T08:20:36.767

仅仅因为我需要同样的东西并且现有的答案并不令人满意：单独使用引导程序有一个很好的方法。我有这个功能：

```
function image(id, img, text) {
        return text + "<div id='" + id + "' class='modal fade' tabindex='-1' role='dialog'>" 
             + "<div class='modal-dialog'><div class='modal-content'><div class='modal-body'>"
             + "<img src='" + img + "' class='img-responsive'></div></div></div></div>"
             + "<div class='col-xs-4 col-md-4 text-right'><a class='thumbnail' href='#' data-toggle='modal' data-target='#" + id + "'>"
             + "<img src='" + img + "'/></a></div>"
    } 
```

这会产生这样的 HTML：

```
<div id="tea-live" class="modal fade" tabindex="-1" role="dialog" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <img src="images/tea-live.png" class="img-responsive">
            </div>
        </div>
    </div>
</div>
<div class="col-xs-4 col-md-4 text-right">
    <a class="thumbnail" href="#" data-toggle="modal" data-target="#tea-live">
        <img src="images/tea-live.png">
    </a>
</div> 
```

这会在同一页面上创建一个淡入淡出的模型框。

# c++ - C++ - 我如何将我自己类型的值插入到集合中？

> ID：14014186
> 
> 赞同：0
> 
> 时间：2012-12-23T19:50:38.703
> 
> 标签：c++, collections, types, vector

我正在编写一个程序，它需要一个姓名和号码来创建一个学生。然后，我想将这些学生添加到集合中。

但是，我正在努力解决的是如何将学生添加到向量中。

到目前为止，我编写的代码如下所示：

```
Student stud(name, i);
vector<Student> vS

Student::Student(const string &name, int regNo) : Person(name)
{

} 
```

我想我正在做一些非常愚蠢的事情，但在编程方面我真的很弱。

我基本上是从文件中获取字符串和整数，然后将它们传递给 Student 构造函数。然后我试图创建一个包含所有学生的 Student 类型的向量。但我就是不知道该怎么做。

如果有人知道我需要做什么，那就太好了？我尝试了几种方法，但似乎都没有奏效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T19:53:58.160

`vector` `push_back`可以使用插入元素：

```
vS.push_back(stud); 
```

或者如果 C++11 可用：

```
vS.emplace_back(name, i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:57:56.790

寻找的好地方是 c++ 文档。那里也有很好的例子。例如关于矢量： [http](http://www.cplusplus.com/reference/vector/vector/) ://www.cplusplus.com/reference/vector/vector/ 以及关于向矢量添加元素 [http://www.cplusplus.com/reference/vector/vector/push_back/](http://www.cplusplus.com/reference/vector/vector/push_back/)

作为附加评论，如果您关心效率，您可以为元素保留空间：

```
your_vector.reserve(number_of_elements);
your_vector.push_back(your_element); 
```

# html - CSS 属性“最大宽度”使 Internet Explorer 8 中的图像折叠

> ID：14014188
> 
> 赞同：0
> 
> 时间：2012-12-23T19:51:01.060
> 
> 标签：html, css, internet-explorer, cross-browser

我创建了一个使用 FF 17.0.1、Chrome 23.0.1271.97 或 Safari 5.0.3 观看时看起来不错的图片库。工具“IETester”也为 IE 9 正确显示了页面。在 IE8 中以兼容模式查看时，它也呈现正常，但不是在默认模式下。

CSS 文件“core.css”添加了以下规则：

```
/* Image ---*/
img {
  max-width: 100%;
} 
```

我不知道是否可以更改此规则，因为它是众多第三方模板之一。这个规则似乎折叠了我的 IE8 画廊的图像。设置附加规则“宽度：自动”不是一个选项，因为图像并不总是以原始尺寸显示。

**html**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb" dir="ltr" >

    <head>
      <title></title>
    <link rel="stylesheet" href="/media/plg_fancybox2/css/aobgallery.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/templates/ja_lens/css/reset.css" media="all" />
    <link rel="stylesheet" type="text/css" href="/templates/ja_lens/css/core.css" media="all" />

    </head>
    <body>

    <p><script type='text/javascript'>var tlist = ['/images/showroom/playground/displaced/Disp_7b1.jpg','/images/showroom/playground/displaced/dispm_6.jpg','/images/showroom/playground/displaced/dispm_9.jpg','/images/showroom/playground/displaced/dispm_9b.jpg','/images/showroom/playground/displaced/dispm_9c.jpg','/images/showroom/playground/displaced/dispm_10a.jpg','/images/showroom/playground/displaced/dispm_12b.jpg','/images/showroom/playground/displaced/dispm_12d.jpg','/images/showroom/playground/displaced/dispm_12e.jpg','/images/showroom/playground/displaced/dispm_12f.jpg'];

    </script><div id="fancycontainer">
    <div class="fancyitem"><a href="/images/showroom/playground/displaced/Disp_7b1.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 0,helpers : { title  : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/Disp_7b1.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_6.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 1,helpers : { title   : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_6.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_9.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 2,helpers : { title   : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_9.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_9b.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 3,helpers : { title  : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_9b.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_9c.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 4,helpers : { title  : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_9c.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_10a.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 5,helpers : { title : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_10a.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_12b.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 6,helpers : { title : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_12b.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_12d.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 7,helpers : { title : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_12d.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_12e.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 8,helpers : { title : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_12e.jpg" /></a></div>

    <div class="fancyitem"><a href="/images/showroom/playground/displaced/dispm_12f.jpg" class="fancyframe" rel="gallery" onclick="callMe(tlist,{index: 9,helpers : { title : { type : 'inside' },  buttons : {}}, playSpeed: 5000, closeBtn : false});return false;"><img width="215" src="/images/showroom/playground/displaced/thumbs/dispm_12f.jpg" /></a></div>

    </div></p>

    </body>
    </html> 
```

这是用于格式化图库的 css： **aobgallery.css**

```
#fancycontainer
{
    list-style: none outside none;
    margin: 8px auto !important;
    overflow: hidden;
    padding: 8px !important;
    border:1px solid #000000;
}

.fancyframe
{
    display: block;
    float:left;
    font-size: 11px;
    font-weight: bold;
    left: 0;
    padding: 5px;
    right: 0;
    text-align: left;
    top: 0;
}

.fancyframe:hover
{
  background-color: #333333;
} 
```

为什么属性“最大宽度”设置为 100% 折叠 IE8 中的图像？我可以调整我的 html 以防止这种情况发生吗？我可以定义一个额外的 CSS 规则来解决这个问题吗？

这是该问题的在线演示：http: [//demo.artonbit.com/test.htm](http://demo.artonbit.com/test.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:01:23.613

那么您是否尝试过重新安排css命令？在我看来，您可能希望将 'ol css reset 移到加载顺序的前面，以帮助重置间距浏览器。

这有助于解释 css 重置的要点： [使用 CSS 浏览器重置代码的目的是什么？](https://stackoverflow.com/questions/9370294/whats-the-purpose-of-using-css-browser-reset-code)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:42:27.913

这是 IE8 中的一个错误，容器将缩小到图像的宽度。我正在路上，现在无法在我的错误列表中查找它，但如果没有其他人提供完整描述，我相信你可以谷歌搜索它。

解决方法是在图像周围设置一个 div 并将 max-width 放在 div 上。问题是由替换元素引起的，这就是 img 。（好吧，问题实际上是由 IE 引起的，但我离题了。）

# css - Webkit 滚动条不接受 RGBa 值？

> ID：14014189
> 
> 赞同：3
> 
> 时间：2012-12-23T19:51:03.817
> 
> 标签：css, user-interface, webkit, scrollbars, rgba

我在 webkit 的网页上设计了一些滚动条，我希望轨道是半透明的，这样一些背景图像就会流出来，但是当我插入一个 RGBa 值时，它就像一个 RGB 值一样对待它（没有任何阿尔法通道）。不`::-webkit-scrollbars`接受RGBa？我知道它不接受类似的东西`transitions`，那么 WebKit 是否也跳过了其他很酷的效果？

代码：

```
::-webkit-scrollbar {
    -webkit-appearance: none;
    width: 8px;
}

::-webkit-scrollbar-track {
    background-color: rgba(57,57,57, .6);
    border-radius: 8px;
}
::-webkit-scrollbar-thumb {
    border-radius: 8px;
    background-color: rgba(156, 156, 156, .6);
} 
```

（但是 - 在我这边 - 它`rgba`只是一个普通的`rgb`价值）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T19:59:41.367

查看我的[垂直 jsfiddle](http://jsfiddle.net/NmvRb/4/)以使用垂直页面进行操作。我设置了一个带有背景图像的透明轨道，其中包含以下内容：

```
::-webkit-scrollbar-track {
    background: rgba(57,57,57, .6);;
} 
```

对于水平页面，请查看此[水平小提琴](http://jsfiddle.net/YbrX3/72/)。与水平代码的区别在于我将页面设置为 100% 高度：

```
body, html, .scrolls {
    height: 100%;   
} 
```

然后我将页面内容包装在一个 div 中，这是滚动发生的地方，而不是页面本身，如下所示：

```
.scrolls { 
    overflow-x: scroll;
    overflow-y: hidden;
    white-space:nowrap;
    background-image: url('http://www.evokia.com/images/large-background.jpg');
} 
```

这是解决方法，因为页面上的水平滚动似乎永远不会获得页面的背景，因此为了获得透明轨道，我们需要在页面中创建滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:01:57.560

我很确定 webkit 确实支持 RGBa 值，我使用过`body::-webkit-scrollbar-track{}`它运行良好。

我还使用了[Jscroll 窗格插件](http://jscrollpane.kelvinluck.com/)，我发现它非常直观，而且它也支持 rgba 值。这也可以支持全网页自定义滚动条和IE 7+。

是否可以查看您的代码以查看是否有任何问题？

# objective-c - 如何在启用沙盒的帮助应用程序中终止我的应用程序？

> ID：14014192
> 
> 赞同：3
> 
> 时间：2012-12-23T19:51:05.507
> 
> 标签：objective-c, macos, cocoa, sandbox

我创建了一个助手应用程序，它监视 iTunes 并启动/终止主应用程序。

发射工作完美。唯一的问题是，由于沙盒，我不允许终止主应用程序。我得到这 3 个日志：

```
12/23/12 8:45:37.522 PM appleeventsd[70]: Sandboxed application with pid 8293 attempted to lookup App:"Significator 2"/8877/0x0:0x150150 ???? sess=100011 but was denied due to sandboxing. (handleMessage()/appleEventsD.cp #2007) com.apple.coreservices.appleevents.peer.0x7fd9c2401f00.xpcq

12/23/12 8:45:37.000 PM kernel[0]: Sandbox: sandboxd(8888) deny mach-lookup com.apple.coresymbolicationd

12/23/12 8:45:37.873 PM sandboxd[8888]: ([8293]) SignificatorHelp(8293) deny appleevent-send ch.ilijatovilo.significator-2 
```

我试过在帮助应用程序中像这样终止它：

```
NSRunningApplication *app = [[NSRunningApplication runningApplicationsWithBundleIdentifier:[self mainApplicationBundle].bundleIdentifier] objectAtIndex:0];
[app terminate]; 
```

当然，我可以在主应用程序中添加另一个观察者，但我想避免这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T08:46:01.223

明白了，我不得不添加一个临时权利例外：

```
<key>com.apple.security.temporary-exception.apple-events</key>
<array>
    <string>mainAppBundleIdentifier</string>
</array> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:41:54.293

如果您将应用程序放在[应用程序组](http://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW19)中，您可以向主应用程序发送信号以自行终止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T07:25:12.483

10.8 中 IPC 的推荐方法是使用 NSXPCConnection。

请参阅[使用 NSXPCConnection 进行沙盒处理中的代码](http://developer.apple.com/library/mac/#samplecode/SandboxingAndNSXPCConnection/Introduction/Intro.html)

# php - 如何使用 JavaScript 和 PHP 永久更改 div 的内容？

> ID：14014194
> 
> 赞同：-4
> 
> 时间：2012-12-23T19:51:15.257
> 
> 标签：php, javascript, persistence

好的。所以我没有任何示例代码可以展示，但是在做了一些研究并学习了 PHP 的基础知识之后，我认为我的问题的答案应该很简单。

这是我希望的场景：

在主页上会有几个团队名称，旁边有分数。就像哈利波特中的“房屋积分”。

分数下方是一个小的文本字段。下面是一个提交按钮。

用户将在文本字段中输入一个数字，然后按提交，该数字将被添加到团队的总分中。

现在。我知道如何使用 JavaScript 实现所有这些。简单的。我想知道的是：

我如何让那个新数字（新的总分）留在那里。按下提交按钮时，我需要永久更改 HTML。

我只知道我需要使用 PHP。我知道 PHP 的基础知识，所以无论答案是什么，只要把它扔给我，我就会弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:10:47.873

听起来您想要做的是提交表单。首先删除 JavaScript，您将不需要它。您需要将文本字段放入表单中，当您提交时，您可以使用`$_<GET|POST|REQUEST>['<name_of_field>']`.

然后你需要以某种方式存储它。最好的方法是使用 MySQL 或 MongoDB 之类的数据库来存储它，但如果你只是学习这个可能会有点棘手，所以也许你想坚持使用文件。您可以使用 INI 文件和 PHP 的 INI 函数来执行此操作。

最后，您需要将正确的值打印到网站上。现在这很容易：只需编辑您的 HTML 文件以执行类似的操作

```
<?php echo $score['team1']; ?> 
```

在顶部或某处检索正确值后为每个团队。（不要忘记将 HTML 文件也重命名为 .php）。

现在你应该准备好保存你的分数了。=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:09:13.360

如果您的意思是真正永久的，则必须通过 Ajax（PHP 和 Javascript 的组合）将其发送到数据库。或将其写入文本文档，这不太好。

# html - 可拖动对象对齐

> ID：14014195
> 
> 赞同：5
> 
> 时间：2012-12-23T19:51:20.137
> 
> 标签：html, jquery-ui, drag-and-drop, alignment

我试图使可拖动的对象从远处相互对齐。它几乎完成了，但不起作用的事情是，如果您仔细观察示例，助手会落后 1 步。如果您将其向上移动 1 个像素，助手将转到您所在的 -1 位置.. 并且只有下一个移动到鼠标所在的位置:(

希望你明白[这是一个工作代码（演示）](http://jsbin.com/oqohuq/1/watch)

有什么想法吗？

我认为问题出在这部分，但我不知道在没有这个错误的情况下要改变什么：

```
drag: function(event, ui) { drawGuideLines($(this)); },
        start: function(event, ui) { removeAlignLines($(this)); },
        stop: function(event, ui) {
                rebuildAlignLines($(this));
                linesTimeout = setTimeout("hideGuideLines()", 100);
            }, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:57:04.780

听起来像一个错误，最后一次移动后不调用拖动事件。如果用户快速移动鼠标，问题就会非常明显。

作为解决方法，您可以在拖动期间设置间隔函数并每 100 毫秒绘制一次网格线：

更新 jsbin：http: [//jsbin.com/oqohuq/4/edit](http://jsbin.com/oqohuq/4/edit)

```
var handleInterval = null;
$(".draggable").draggable({
    opacity : 0.35,
    handler : "._header",
    stack : ".draggable",
    grid: [1, 1],
    refreshPositions: true,
    snap: ".drag_alignLines", // Setting snap to alignment lines
    snapTolerance: 10,
    snapMode: "inner",
    drag: function(event, ui) { drawGuideLines($(this)); },
    start: function(event, ui) {
      //Init the interval here
      var self = $(this);
      handleInterval = setInterval(function(){ drawGuideLines(self);},100);
      removeAlignLines($(this)); },
    stop: function(event, ui) {
      //Clear interval here
      clearInterval(handleInterval);
      rebuildAlignLines($(this));
      linesTimeout = setTimeout("hideGuideLines()", 100);
     }//Don't forget to remove the last coma!            
}); 
```

# php - 语法错误，意外的 T_DOUBLE_ARROW

> ID：14014201
> 
> 赞同：-2
> 
> 时间：2012-12-23T19:51:35.907
> 
> 标签：php, arrays, syntax, array-push

我怎样才能摆脱这个错误

解析错误：语法错误，意外的 T_DOUBLE_ARROW

PHP代码：

```
$uniqueOrderCodes = array();
foreach ($checks as $check)
{
    array_push($uniqueOrderCodes,"string" => $check);
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:35:24.340

无意冒犯，但您应该阅读[手册](http://php.net/array_push)。`=>`它是一个赋值运算符，用于数组。

在示例`$my_array = array('color' => 'blue')`中， `color`是键，`blue`是值（*类型`string`*）并且`$my_array`是保存数组的变量。用一种*书呆子*的语言来说，这听起来像是*“变量`$my_array`包含一个数组，我在其中分配了一个字符串`blue`给 key `color`；我可以通过使用`$my_array['color']`which will output来访问它`blue`。”*

你推送到这样的数组：

```
array_push($my_array, $var); 
```

`$var`它可以是`mixed`（*混合 = 任何*）类型，如`string`, `int`,`array`等。

但是，对于一个元素，您不需要`push`在数组中。选择：

```
foreach ($checks as $check)
{
    $uniqueOrderCodes[] = $check;
} 
```

看：

*   [数组](http://php.net/manual/en/language.types.array.php)
*   [运算符优先级](http://php.net/manual/en/language.operators.precedence.php)
*   [array_push()](http://php.net/array_push)

# java - 具有复杂对象的 ConcurrentHashMap

> ID：14014204
> 
> 赞同：-1
> 
> 时间：2012-12-23T19:52:40.193
> 
> 标签：java, concurrency, concurrenthashmap

我从网上获取了一些并发 LRU 缓存实现，它们有 HashMap 和同步块。我想要的是使用 ConcurrentHashMap 并避免（在可能的情况下）使用同步块。我放了 ConcurrentHashMap 而不是 HashMap 并且一切都出错了。线程在 map.get(key) 上退出。也许我的 ConcurrentHashMap 参数需要以某种方式定制？

```
 private ConcurrentHashMap<Object, LRUListEntry> map;

        protected class LRUListEntry extends Object
        {
            LRUListEntry next;
            LRUListEntry prev;
            Object value;
            Object key;
            int hits;
            final int penalty = -1;

            public String toString()
            {
                return key + "=" + value;
            }

            public Object getKey()
            {
                return key;
            }

            public Object getValue()
            {
                return value;
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:22:53.773

问题是每次访问时都会修改`prev`和LRU 引用，以将条目重新排序为最近最少使用的条目。`next`该实现假定这些操作是原子执行的，如果同步块被删除，则不是这样。Java`LinkedHashMap`是您的代码片段的一个很好的实现，并在标准库中提供。

[ConcurrentLinkedHashMap](http://code.google.com/p/concurrentlinkedhashmap/)提供了 LRU 算法的并发版本。[设计文档](http://code.google.com/p/concurrentlinkedhashmap/wiki/Design)从高层次上描述了所使用的想法。该项目是[Guava 的 Cache的基础，采用本](http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/cache/CacheBuilder.html)[演示文稿](http://concurrentlinkedhashmap.googlecode.com/files/ConcurrentCachingAtGoogle.pdf)中描述的修改方法。如果您对底层细节感兴趣，这两个项目都有很好的代码级文档和单元测试。

# database - 为电子商务商店设计数据库

> ID：14014209
> 
> 赞同：0
> 
> 时间：2012-12-23T19:53:08.807
> 
> 标签：database, database-design

嗨，我正在尝试为电子商务网站设计一个数据库，但我似乎找不到正确的方法，这就是我目前所拥有的： ![图式](../Images/cb58fb6dbddad97c5b3dcac465c0888d.png)

问题出现在产品上。我有 66 种类型的产品，其中大多数都有不同的领域。我必须 id，但它们似乎都不太实用：

**选项 A：**

起初我以为我要为每种产品类型制作一个表格，但那样会导致 66 个表格，这不是很容易维护。我已经开始这样做了，我创建了 Product_Notebook 和 Product_NotebookBag 表。然后我停下来想了一下，这个解决方案不是很好。

**选项 B**

在考虑了更多之后，我想出了选项 B，它将数据存储到一个名为 description 的单独字段中。例如：

```
"Color : Red & Compatibility : 15.6 & CPU : Intel" 
```

在这种方法中，我可以在从数据库中检索字符串后对其进行操作。

我知道这种方法也不是一个好主意，这就是为什么我要求一种更实用的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:01:37.847

只需创建一个 ProductProperties 表并将所有可能的字段放在那里。（实际上，您可以在 Products 表中添加更多字段）

然后，当您列出您的产品时，只需使用您需要的字段。

当然，也有许多共同的领域。

顺便说一句，如果您正在考虑将数据存储在数组中（选项 B？），您以后会后悔的。您将无法以这种方式轻松地对表格进行排序。

此外，该选项将使通过特定特征找到特定项目变得困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:17:54.847

在 Stack Overflow 上查看我对[这个问题的回答。](https://stackoverflow.com/questions/11779252/entity-attribute-value-table-design/11972029#11972029)对于您的情况，我建议使用实体属性值 (EAV)。

正如我在链接答案中解释的那样，几乎所有时间都应避免 EAV，原因有很多。但是，跟踪在线目录的产品属性是一种应用，其中 EAV 的问题很少，而且好处很广泛。

# php - PHP, Facebook, Like, fb-root div

> ID：14014210
> 
> 赞同：0
> 
> 时间：2012-12-23T19:53:16.613
> 
> 标签：php, facebook-like

我试图理解为什么我需要这个 div：

```
<div id="fb-root"></div> 
```

我在我的网站上添加了一个赞按钮，我使用了这个[链接](http://developers.facebook.com/docs/reference/plugins/like/)后面的代码。

如果有人能告诉我，请这个 div 在代码中完成什么部分（您可以在上面的链接中生成代码），谢谢大家，祝您有美好的一天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:58:45.243

这将是你的[答案](https://stackoverflow.com/questions/8097121/why-we-need-to-add-div-id-fb-root-div)

并从 facebook看到[这篇文章](https://developers.facebook.com/docs/reference/javascript/)

# php - PHP 的 OAuth 类 (pecl/oauth)

> ID：14014211
> 
> 赞同：0
> 
> 时间：2012-12-23T19:53:22.040
> 
> 标签：php, facebook, twitter, oauth

此扩展程序支持哪些版本的 OAuth，我是否可以使用它对 Facebook 和 Twitter 进行身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:20:25.297

该扩展仅支持 OAuth (1)。对于使用 OAuth2 的 Facebook，您可以使用这样的库：[https ://github.com/quizlet/oauth2-php](https://github.com/quizlet/oauth2-php)

当您查看诸如[OAuth 2 与 OAuth 1 有何不同之类的问题时？](https://stackoverflow.com/questions/4113934/how-is-oauth-2-different-from-oauth-1)你会发现 OAuth2 和 OAuth 很不一样

# fileoutputstream - 使用 OpenCSV 对 FileOutputStream 的性能影响

> ID：14014214
> 
> 赞同：1
> 
> 时间：2012-12-23T19:54:51.607
> 
> 标签：fileoutputstream, bufferedwriter, opencsv

我们正在使用 OpenCSV

(http://opencsv.sourceforge.net/apidocs/au/com/bytecode/opencsv/CSVWriter.html)

从具有 xml 内容的文件中编写报告。

有两种方法可以解决这个问题->

i) 使用 FileOutputStream 写入

```
FileOutputStream fos = new FileOutputStream(file);
OutputStreamWriter osr= new OutputStreamWriter(fos);
writer = new CSVWriter(osr); 
```

ii) 使用 BufferedWriter 写入

```
BufferedWriter out = new BufferedWriter(new FileWriter(file));
writer = new CSVWriter(out); 
```

有谁知道选择一个选项而不是另一个选项会如何影响撰写本报告的性能？

据我了解，OpenCSV 并不关心，只要它获得可以使用的流即可。

性能的*增量*（差异）将是它之前的步骤，其中输出流是从文件创建的。

使用**OutputStreamWriter**与**BufferedWriter**对性能有何影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T13:12:10.330

在使用 Google [Caliper](http://code.google.com/p/caliper/)运行一些基准测试后，似乎 BufferedWriter 选项是最快的（但实际上并没有太大区别，所以我只使用您喜欢的选项）。

如何解释结果：

*   该`FileOutputStreamWriter`方案对应于选项 i

*   该`BufferedWriter`方案对应于选项 ii

*   这个`FileWriter`场景是我添加的，它只使用一个普通的旧 FileWriter。

每个基准运行 3 次：写入 1000、10,000 和 100,000 行。

测试在 Linux Mint、i5-2500k (1.6GHz) CPU、8GB RAM、Oracle JDK7（写入 SATA 绿色硬盘）上运行。结果会因不同的设置而异，但这应该有利于比较。

```
 rows              benchmark     ms linear runtime
  1000 FileOutputStreamWriter   6.10 =
  1000         BufferedWriter   5.89 =
  1000             FileWriter   5.96 =
 10000 FileOutputStreamWriter  50.55 ==
 10000         BufferedWriter  50.71 ==
 10000             FileWriter  51.64 ==
100000 FileOutputStreamWriter 525.13 =============================
100000         BufferedWriter 505.05 ============================
100000             FileWriter 535.20 ============================== 
```

仅供参考，opencsv 将`Writer`您提供的内容包装在`PrintWriter`.

# ruby-on-rails - Rails 3 before_save 不改变属性

> ID：14014220
> 
> 赞同：1
> 
> 时间：2012-12-23T19:55:46.727
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我很抱歉提出这样一个菜鸟问题，但我真的很困惑为什么这不起作用。我正在创建一个 reddit 克隆作为自学 Rails 的一种方式。创建新帖子时，我想将 upvote 和 downvote 属性设置为零。我究竟做错了什么？

编辑：当我通过我的 Rails 服务器创建一个新的时，它看起来像 before_save 工作，但在控制台中`Post`创建一个新的时它不起作用。`Post`为什么是这样？

**post.rb**

```
class Post < ActiveRecord::Base
  attr_accessible :title, :url, :upvotes, :downvotes

  before_save :set_votes_to_zero

  def set_votes_to_zero
    self.upvotes = 0
    self.downvotes = 0
  end
end 
```

**架构.rb**

```
ActiveRecord::Schema.define(:version => 20121223192629) do

  create_table "posts", :force => true do |t|
    t.string   "title"
    t.string   "url"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
    t.integer  "upvotes"
    t.integer  "downvotes"
  end

end 
```

创建新帖子时的 Rails 控制台输出

```
irb(main):035:0> Post.create(title: "Facebook", url: "www.facebook.com")
  ←[1m←[35m (0.0ms)←[0m  begin transaction
  ←[1m←[36mSQL (0.0ms)←[0m  ←[1mINSERT INTO "posts" ("created_at", "downvotes",
"title", "updated_at", "upvotes", "url") VALUES (?, ?, ?, ?, ?, ?)←[0m  [["creat
ed_at", Sun, 23 Dec 2012 19:43:37 UTC +00:00], ["downvotes", nil], ["title", "Fa
cebook"], ["updated_at", Sun, 23 Dec 2012 19:43:37 UTC +00:00], ["upvotes", nil]
, ["url", "www.facebook.com"]]
  ←[1m←[35m (124.8ms)←[0m  commit transaction
=> #<Post id: 9, title: "Facebook", url: "www.facebook.com", created_at: "2012-1
2-23 19:43:37", updated_at: "2012-12-23 19:43:37", upvotes: nil, downvotes: nil> 
```

# python - Python继承——指特定的层次

> ID：14014229
> 
> 赞同：0
> 
> 时间：2012-12-23T19:56:31.077
> 
> 标签：python, inheritance, super

我在使用 Python (2.7) 继承时遇到问题。我试图从派生类引用父类并返回，如果你对类进行硬编码，这很容易，但这对我来说似乎是一种丑陋的方法。是吗？无论如何，我们开始：

```
class Alpha(object):
    def fie(self):
        pass

class Beta(Alpha):
    def fie(self):
        super(self.__class__, self).fie()

class Gamma(Beta):
    pass

Alpha().fie()
Beta().fie()
Gamma().fie() 
```

最后一个调用`fie`定义为 on `Beta`，但由于它是从调用的`Gamma`，所以`super`将引用`Beta`. 因此，它会再次调用自己并开始无限递归。

有没有办法引用最初定义函数的类？还是链条上最高的班级（除此之外`object`）？或者可能是一种更好的方法来实现这一点，而无需硬编码类名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:03:57.943

不——你只需要把它写成：

```
class Beta(Alpha):
    def fie(self):
        super(Beta, self).fie() 
```

请参阅：http: [//yergler.net/blog/2011/07/04/super-self/](http://yergler.net/blog/2011/07/04/super-self/) - 并从那里引用（因为它比我解释得更好！）：

> 根据 Python 2.7.2 标准库文档， super “返回 [s] 一个代理对象，它将方法调用委托给类型的父类或同级类。” 所以在单继承的情况下，它委托对超类的访问，它不返回超类的实例。在上面的示例中，这意味着当您实例化 B 时，会发生以下情况：

```
enter B.__init__()
call super on B and call __init__ on the proxy object
enter A.__init__()
call super on self.__class__ and call __init__ on the proxy object 
```

> 问题是当我们进行到第四步时，self 仍然指向我们的 B 实例，所以再次调用 super 指向 A。用技术术语来说：Ka-bloom。

在那篇文章中是 Raymond Hettinger 的博客链接（它们总是值得一读）：[http ://rhettinger.wordpress.com/2011/05/26/super-considered-super/](http://rhettinger.wordpress.com/2011/05/26/super-considered-super/)

**注意：阅读用户建议使用的评论`type(self)`（相当于你自己。_*类*_）以及为什么它不起作用**

# java - 如何将 java.util.zip 用于 epub

> ID：14014236
> 
> 赞同：1
> 
> 时间：2012-12-23T19:57:53.837
> 
> 标签：java, html, zip, epub, meta-inf

我必须以编程方式编辑 epubs 的 html 文件，所以我所做的是解压缩 .epub 并创建一个解析器来对 html 文件进行必要的编辑。但是，当我使用我的代码将它们转换回 .epub 时，EpubChecker 显示：

```
Error: Required META-INF/container.xml resource is missing 
```

当我解压缩我编辑的 .epub 时，container.xml 存在并且没有丢失。

我知道必须先压缩 mimetype 和 META-INF。这是我将文件转换回epub的代码：

```
 FileOutputStream fos = new FileOutputStream(zipFile);
    ZipOutputStream zos = new ZipOutputStream(fos);

    System.out.println("Output to Zip : " + zipFile);
    writeMimeType(zos);
    ZipEntry container = new ZipEntry("META-INF\\container.xml");
    zos.putNextEntry(container);
    FileInputStream inMime2 = new FileInputStream(SOURCE_FOLDER + File.separator + "META-INF\\container.xml");
    int len2;
    while((len2 = inMime2.read(buffer)) > 0){
        zos.write(buffer, 0, len2);
    }
    inMime2.close();
    for(String file : this.fileList){
            if(!file.toString().equals("mimetype") && !file.toString().equals("META-INF\\container.xml")){
                System.out.println("File Added : " + file);
                ZipEntry ze= new ZipEntry(file);
                zos.putNextEntry(ze);

                FileInputStream in = 
                    new FileInputStream(SOURCE_FOLDER + File.separator + file);

                int len;
                while ((len = in.read(buffer)) > 0) {
                        zos.write(buffer, 0, len);
                }

                in.close();
           }
    }

    zos.closeEntry();
    zos.close(); 
```

当我使用 WinRar 手动压缩目录时，没有看到任何错误并且它工作正常。我不知道我做错了什么。有人可以帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:32:02.343

看起来你在 Windows 上，所以你的`FileInputStream(SOURCE_FOLDER + File.separator + "META-INF\\container.xml");`声明对于操作系统是正确的，但我猜你需要更改其他 2 个字符串以使用正斜杠作为 zipentry 路径。

```
ZipEntry container = new ZipEntry("META-INF\\container.xml"); 
```

尝试改为

```
ZipEntry container = new ZipEntry("META-INF/container.xml"); 
```

和改变

```
if(!file.toString().equals("mimetype") && !file.toString().equals("META-INF\\container.xml")){ 
```

到

```
if(!file.toString().equals("mimetype") && !file.toString().equals("META-INF/container.xml")){ 
```

因此。

您可能还需要调整其他`ZipEntry`的。从[ZIP 规范](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)（“4.4.17 文件名”部分）：

> 所有斜杠必须是正斜杠 '/' 而不是反斜杠 '\'

# git - capistrano 部署：检查成功但部署失败

> ID：14014238
> 
> 赞同：0
> 
> 时间：2012-12-23T19:58:07.687
> 
> 标签：git, deployment, capistrano, cap

这是我第一次使用 capistrano，一切似乎都很好，但不幸的是部署失败。

上限部署后：检查它返回：

```
You appear to have all necessary dependencies installed 
```

所以我认为一切都很好。是时候部署了！但它返回了这个：

```
command finished in 81ms
failed: "sh -c 'if [ -d /home/alternate/domains/testserveraz.eu/public_html/shared/cached-copy ]; 
then cd /home/alternate/domains/testserveraz.eu/public_html/shared/cached-copy && 
git fetch -q origin && git fetch --tags -q origin && git reset -q --hard 
d5018b4b253e082bae9dd8b7566c7840f26fecaa && git clean -q -d -x -f; 
else git clone -q git@brive.lt:testserveraz.git 
/home/alternate/domains/testserveraz.eu/public_html/shared/cached-copy && 
cd /home/alternate/domains/testserveraz.eu/public_html/shared/cached-copy && 
git checkout -q -b deploy d5018b4b253e082bae9dd8b7566c7840f26fecaa; fi'" on testserveraz.eu 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:02:20.663

我尝试使用错误的凭据连接到用户“git”。所以我更改了 deploy.rb 中的用户名，这样它将使用正确的用户名和密码来上传文件。

# algorithm - 最短路径图

> ID：14014242
> 
> 赞同：0
> 
> 时间：2012-12-23T19:58:46.953
> 
> 标签：algorithm

给定一个有向图 G 、权重、s 源顶点和图中每个顶点的 d[v]（从 s 到 v 的距离），我需要找到一种算法来构建最短路径图。

我正在考虑通过 BFS 处理边，但我怎么知道哪条边应该在树中，以及如何检查每个顶点的 d[v] 是否为真。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:13:57.703

BFS 算法可帮助您找到给定根节点和所有其他节点之间的最短路径，仅适用于未加权图（或所有权重相同）。如果每条边的权重不同，那么 Dijkstra 算法是一个不错的选择。但是，如果图中存在负权重，则 Dijkstra 算法不起作用。如果有负权重，那么你应该使用贝尔曼福特算法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T20:15:39.693

运行 Dijkstra。如果连接 {u,v} 的边 e 具有 d[u]+w[e]=d[v] 的属性，则该边是您正在寻找的树的一部分。

这样，您实际上可能不会得到一棵树，但任何 MST 都具有您正在寻找的属性

# jquery - 如何使用 jquery validate 和 Chosen 验证多选？

> ID：14014245
> 
> 赞同：7
> 
> 时间：2012-12-23T19:58:49.600
> 
> 标签：jquery, jquery-validate, jquery-chosen

我能够使用 jquery-validate 验证多选，并创建了一个[小提琴](http://jsfiddle.net/houmie/8rn89/3/)作为演示。按住 Ctrl 取消选择选择，然后单击选择以查看效果。

```
<form id="myform">
    <select id="id_deals-1-sales_item" class="multi_select_mandatory" name="deals-1-sales_item" multiple="multiple">
    <option value="1">Hotel 3 Star</option>
    <option selected="selected" value="2">Hotel 4 Star</option>
    </select>
</form>

$(document).ready(function() {
    var validator = $('#myform').validate({
          // options
          rules: {
            "deals-1-sales_item": "required",            
        },

        //ignore: ':hidden:not("#id_deals-1-sales_item")'                                      
    });
}); 
```

但是一旦我选择了多选，它就会停止工作：见[fiddle](http://jsfiddle.net/houmie/vwHMT/1/)。

```
$('#id_deals-1-sales_item').chosen(); 
```

在研究时，我发现有人[尝试过这个](https://stackoverflow.com/questions/10225928/validating-multiselect-with-jquery-validation-plugin)而`jquery multiselect`不是选择。jquery validate 中似乎忽略了隐藏元素。我尝试应用该解决方案，但由于选择有不同的方法，我被卡住了（选择中不存在多选）

这里有任何 jQuery 大师可以为我指明正确的方向吗？此外，我宁愿基于类而不是基于字段名称的解决方案。像这样：

这是我中途想出的解决方案。但不知道如何进行`???`。

```
$.validator.addMethod("needsSelection", function(value, element) {
        return $(element).???.length > 0;
    });

var validator = $('#myform').validate({
});

$('#myform').find('select.multi_select_mandatory').each(function(){
        $(this).change(function(){
            $(this).valid();
        });
        $(this).rules('add', {
            needsSelection: ""
        });
    }); 
```

**解决方案：**

使用下面的 eicto 解决方案，我能够创建基于类而不是基于字段名称的解决方案。当您有想要立即验证而不向服务器提交任何内容的动态元素时，这特别有用。

```
 var validator = $('#deal_modal_form').validate({
        // options
        ignore: ':hidden:not(.chzn-done)'
     });

    $('#myform').find('select.multi_select_mandatory').each(function(){
    $(this).chosen().change(function(){
        $(this).valid();
    });
    $(this).rules('add', {
        required: true,
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:59:50.443

这对我有用：

```
$(document).ready(function() {
    var validator = $('#myform').validate({
        // options
        rules: {
            "deals-1-sales_item": "required",
        },

        ignore: ':hidden:not(.chzn-done)'
    });
    var checkerrors = function() {
        validator.form();
    };
    var chosen = $('#id_deals-1-sales_item').chosen().change(checkerrors);
});​ 
```

这个想法是在每次更改时手动检查表单。

[演示](http://jsfiddle.net/vwHMT/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T05:45:12.243

我在@eicto 和@kave 解决方案的帮助下编写了我的解决方案，如下所示：

```
 $.validator.addMethod("multiSelectRequired", function (value, element) {
    return element.length > 0;
});
$("#aspnetForm").find('select.multi_select_mandatory').each(function () {
    $(this).change(function () {
        $(this).valid();
    });

    $(this).rules('add', {
        'multiSelectRequired': true
    });
}); 
```

初始化插件时，我添加了 `ignoe:[] 以便不忽略验证中的隐藏输入。

我正在为我的引导项目使用名为 bootstrap-multiselect 的特殊插件来呈现复选框选择 - [https://github.com/davidstutz/bootstrap-multiselcet](https://github.com/davidstutz/bootstrap-multiselcet)

# hibernate - 使用 Hibernate 4 生成 SQL DB 创建脚本

> ID：14014247
> 
> 赞同：2
> 
> 时间：2012-12-23T19:58:56.390
> 
> 标签：hibernate, ant

我们目前正在使用 Hibernate 3，我们使用 Hibernate Tools 为 DB 模式生成 SQL 脚本。

我们使用以下 Ant 任务

```
<hibernatetool destdir="${target}">
    <jpaconfiguration persistenceunit="@{persistenceUnit}" propertyfile="@{propertyfile}"/>
    <classpath refid="@{classpathid}"/>
    <!-- the file name is relative to $destdir -->
    <hbm2ddl outputfilename="@{output}" format="true" export="false" drop="false"/>
</hibernatetool> 
```

我们想切换到 Hibernate 4：如果没有 Hibernate 工具，我们如何实现类似的功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T05:35:48.863

您可以直接使用[SchemaExport](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/tool/hbm2ddl/SchemaExport.html)类来生成 DDL 脚本：

对于休眠 4：

```
 Configuration config = new Configuration();

    Properties properties = new Properties();

    properties.put("hibernate.dialect", "org.hibernate.dialect.PostgreSQLDialect");
    properties.put("hibernate.connection.url", "jdbc:postgresql://localhost:5432/Test"); 
    properties.put("hibernate.connection.username", "username");
    properties.put("hibernate.connection.password", "password");
    properties.put("hibernate.connection.driver_class", "org.postgresql.Driver");
    properties.put("hibernate.show_sql", "true");
    config.setProperties(properties);

    config.addAnnotatedClass(MyMappedPojo1.class);
    config.addAnnotatedClass(MyMappedPojo2.class);
    ..................

    SchemaExport schemaExport = new SchemaExport(config);
    schemaExport.setDelimiter(";");

    /**Just dump the schema SQLs to the console , but not execute them ***/
    schemaExport.create(true, false); 
```

* * *

休眠 5 更新：

```
 Properties properties = new Properties();

    properties.put("hibernate.dialect", "org.hibernate.dialect.PostgreSQLDialect");
    properties.put("hibernate.connection.url", "jdbc:postgresql://localhost:5432/Test"); 
    properties.put("hibernate.connection.username", "username");
    properties.put("hibernate.connection.password", "password");
    properties.put("hibernate.connection.driver_class", "org.postgresql.Driver");
    properties.put("hibernate.show_sql", "true");

    StandardServiceRegistry serviceRegistry = new StandardServiceRegistryBuilder()
                .applySettings(properties).build();

    MetadataSources metadataSource = new MetadataSources(serviceRegistry);
    metadataSource.addAnnotatedClass(MyMappedPojo1.class);
    metadataSource.addAnnotatedClass(MyMappedPojo2.class);
    ...........

    Metadata meta = metadataSource.buildMetadata();

    SchemaExport schemaExport = new SchemaExport();
    schemaExport.setDelimiter(";");
    schemaExport.execute(EnumSet.of(TargetType.STDOUT), Action.CREATE, meta); 
```

# ios - 如何将 Facebook 帐户导出到设置

> ID：14014251
> 
> 赞同：3
> 
> 时间：2012-12-23T19:59:19.217
> 
> 标签：ios, facebook, acaccount

使用发布权限成功登录后，无法将 Facebook 帐户导出到系统帐户存储。有什么建议么？

```
NSString* refreshToken = nil;
NSString* accessToken = [[FBSession activeSession]accessToken];
NSDate* expiryDate = [[FBSession activeSession]expirationDate];
NSString* appId = [FBSession defaultAppID];

ACAccountStore *store = [[ACAccountStore alloc] init];
ACAccountType *fbType = [store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];

NSDictionary *options = @{
ACFacebookAppIdKey: appId,
ACFacebookPermissionsKey:  @[@"publish_stream"],
ACFacebookAudienceKey: ACFacebookAudienceEveryone
};

ACAccount *fbAccount = [[ACAccount alloc] initWithAccountType:[store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook]];

ACAccountCredential *outhCredential = [[ACAccountCredential alloc] initWithOAuth2Token:accessToken refreshToken:refreshToken expiryDate:expiryDate];

fbAccount.credential = outhCredential;

[store saveAccount:fbAccount withCompletionHandler:^(BOOL success, NSError *error) {

    if(success)
    {
        NSLog(@"Success");
    }

    return;
}]; 
```

# c++ - 如何在 C++ 中有效地将 double 转换为 int？

> ID：14014261
> 
> 赞同：2
> 
> 时间：2012-12-23T20:01:11.833
> 
> 标签：c++

抱歉没有具体说明，我只是认为上下文并不重要。

无论如何，这个问题可以看作是我[在 win32 中 Progressbars](https://stackoverflow.com/questions/14000715/progressbar-range-and-position-how-to-handle-big-numbers-in-c)上的另一个问题的扩展，我应该把整个代码放在这里还是链接就足够了？

最简单形式的问题可以描述为：

```
double d1 = x.xxxxxx;
double d2 = x.xxxxxx;
double d3 = x.xxxxxx;
double d4 = x.xxxxxx;
double d5 = x.xxxxxx;
...
...
double dn = x.xxxxxx;

int i1 = (int)d1;
int i2 = (int)d2;
int i3 = (int)d3;
int i4 = (int)d4;
int i5 = (int)d5;
...
...
int in = (int)dn;

int i = i1+i2+i3+i4+i5+...+in;
double d = d1+d2+d3+d4+d5+...+in;

now i needs to be not less then d - 0.5; 
```

怎么做 ？

编辑：代码已修改。编辑 2：n 的数量无法预测，d1,d2,...,dn 可能小于 1，例如 0.345627。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:13:58.163

我认为您感兴趣的是错误扩散：

```
double d1 = x.xxxxxx;
double d2 = x.xxxxxx;
double d3 = x.xxxxxx;
double d4 = x.xxxxxx;
double d5 = x.xxxxxx;

double error = 0;
int i1 = (int)floor(d1+error+0.5);
error += d1-i1;
int i2 = (int)floor(d2+error+0.5);
error += d2-i2;
int i3 = (int)floor(d3+error+0.5);
error += d3-i3;
int i4 = (int)floor(d4+error+0.5);
error += d4-i4;
int i5 = (int)floor(d5+error+0.5);

int i = i1+i2+i3+i4+i5;
double d = d1+d2+d3+d4+d5; 
```

每次对值进行四舍五入时，您都会看到引入了多少错误，并将更正传播到下一次计算。这样，您的错误永远不会累积。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:05:52.170

> 现在我需要不小于 d - 0.5；

这可以通过四舍五入轻松实现（转换为 int 会将它们四舍五入为 0）。

正如 Josua Green 所说，这可以通过`(int)(d + 0.5)`（如果 d>-0.5）来完成，或者`std::ceil()`如果您愿意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:24:35.127

转换为 int 会截断双精度：即丢弃任何小数位。

通过将 0.5 加到正数和 -0.5 到负数，我们得到了更传统的行为。

```
int ToInt(double x)
{
   double dx = x < 0.0 ? -0.5 : 0.5;
   return static_cast<int>(x + dx);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:07:43.913

总结双打：

```
double d = d1+d2+d3+d4+d5; 
```

检查双精度和不超过整数转换超过 0.5

```
if (d - (int)d > 0.5) { /* Error? */ } 
```

# c# - 并非所有代码路径都为我的快速选择方法返回值错误

> ID：14014270
> 
> 赞同：0
> 
> 时间：2012-12-23T20:02:05.933
> 
> 标签：c#

下面的代码是我的快速选择（与快速排序非常相似，只是它返回排序数组中的第 n 个项目，而不是整个排序数组）方法。输入是字符串数组（单词），如果给定单词​​已排序，我必须返回第 n 个索引的单词。

```
 static string QuickSelect(string[] lst, int index) {
        if (lst.Length == 1)
        {
            Console.Write(lst[0]);
            return lst[0];
        }

        else
        {
            int pivot = _r.Next(lst.Length); // pick a pivot by random number generator
            bool[] isDecre = new bool[lst.Length];
            string[] WordLeft, WordRight;
            int nLeft = 0, nRight = 0;

            for (int i = 0; i < lst.Length; i++) // compare values to pivot
            {
                if (i == pivot) continue;
                if (WordCompare(lst[pivot], lst[i]))
                {
                    nRight++;
                    isDecre[i] = false;
                }
                else
                {
                    nLeft++;
                    isDecre[i] = true;
                }
            }

            if (nLeft == index) // pivot was the (index)th item in the list
                return lst[pivot];

            else
            {

                WordLeft = new string[nLeft];
                WordRight = new string[nRight];
                int l = 0, r = 0;
                // divide list by saved comparison result
                for (int i = 0; i < lst.Length; i++)
                {
                    if (i == pivot) continue;
                    if (isDecre[i])
                    {
                        WordLeft[l] = lst[i];
                        l++;
                    }
                    else
                    {
                        WordRight[r] = lst[i];
                        r++;
                    }
                }

                if (nLeft > index)
                    return QuickSelect(WordLeft, index);
                else if (nLeft < index)
                    return QuickSelect(WordRight, index - nLeft - 1);
            }
        }
    } 
```

问题是这段代码无法运行，抛出“并非所有代码路径都返回值”错误。我认为这与这部分有关：

```
if (nLeft == index) // pivot was the (index)th item in the list
    return lst[pivot];
// build left and right word lists
 ...
if (nLeft > index)
    return QuickSelect(WordLeft, index);
else if (nLeft < index)
    return QuickSelect(WordRight, index - nLeft - 1); 
```

如果我在上面的“else if”之后加上一些“else”，错误就会消失。但是当枢轴是第n个索引字符串时，我不想构建左右单词列表。事实上，我认为这种检测到的非价值返回路径有点胡说八道。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:04:54.863

不，没有解决方法。

您必须在方法的所有路径中返回值**或**抛出异常（不会在该方法中处理）。

编辑：

另一方面，您的条件：

```
if (nLeft == index) // pivot was the (index)th item in the list
    return lst[pivot];
// build left and right word lists
 ...
if (nLeft > index)
    return QuickSelect(WordLeft, index);
else if (nLeft < index)
    return QuickSelect(WordRight, index - nLeft - 1); 
```

可以改成这样：

```
if (nLeft == index) // pivot was the (index)th item in the list
    return lst[pivot];
// build left and right word lists
 ...
if (nLeft > index)
    return QuickSelect(WordLeft, index);
return QuickSelect(WordRight, index - nLeft - 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:11:45.057

 ``if (nLeft > index)
return QuickSelect(WordLeft, index);
else if (nLeft < index)
return QuickSelect(WordRight, index - nLeft - 1);
else //nLeft== index
return "something";``

 `如果两个条件都失败，那么你仍然需要返回一些值，你可以根据返回值进一步处理这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:19:59.243

只有当指定的条件为真时，您的代码才会返回该值。由于您已经指定了三个条件，因此该方法只会在其中一个条件为真时返回一个值，但在这种情况下您会收到错误消息，因为如果这三个条件都为假，应用程序将不知道该怎么做。将没有返回值，因为您没有指定当这些条件变为 false 时将执行的操作，这就是您收到错误的原因，因为 bool 可以是`true`或`false`

```
if (nLeft == index) //Continue if the condition becomes true
    return lst[pivot]; //Return a value
 ...
if (nLeft > index) //Continue if the condition becomes true
    return QuickSelect(WordLeft, index); //Return a value
else if (nLeft < index) //Continue if the condition becomes true
    return QuickSelect(WordRight, index - nLeft - 1); //Return a value 
```

您应该在此方法中添加一行，它只是告诉应用程序在这些条件变为 false 时返回另一个值（a 的另一种可能性`bool`）

**例子**

```
if (nLeft == index) //Continue if the condition becomes true
    return lst[pivot]; //Return a value
 ...
if (nLeft > index) //Continue if the condition becomes true
    return QuickSelect(WordLeft, index); //Return a value
else if (nLeft < index) //Continue if the condition becomes true
    return QuickSelect(WordRight, index - nLeft - 1); //Return a value
else //Continue if these conditions become false
    return /* value */; //Return a value 
```

谢谢，
我希望你觉得这有帮助:)`

# c# - 主键值之一的类型与实体中定义的类型不匹配。有关详细信息，请参阅内部异常

> ID：14014271
> 
> 赞同：7
> 
> 时间：2012-12-23T20:02:11.840
> 
> 标签：c#, entity-framework, entity-framework-4

我有以下方法： -

```
public ActionResult CustomersDetails(string[] SelectRight)
{
    var selectedCustomers = new SelectedCustomers
    {
        Info = SelectRight.Select(GetAccount)
    };

    return View(selectedCustomers);
}

private AccountDefinition GetAccount(string id)
{
    return entities.AccountDefinition.Find(id);
} 
```

但它返回以下错误：-

```
The type of one of the primary key values did not match the type defined in the entity. See inner exception for details. 
```

上`return entities.AccountDefinition.Find(id);`线

那么是什么导致了这个错误呢？

内部例外是：-

```
System.ArgumentException was unhandled by user code
  HResult=-2147024809
  Message=The type of one of the primary key values did not match the type defined in the entity. See inner exception for details.
Parameter name: keyValues
  Source=EntityFramework
  ParamName=keyValues
  StackTrace:
       at System.Data.Entity.Internal.Linq.InternalSet`1.FindInStore(WrappedEntityKey key, String keyValuesParamName)
       at System.Data.Entity.Internal.Linq.InternalSet`1.Find(Object[] keyValues)
       at System.Data.Entity.DbSet`1.Find(Object[] keyValues)

  InnerException: System.Data.EntitySqlException
       HResult=-2146232006
       Message=The argument types 'Edm.Int64' and 'Edm.String' are incompatible for this operation. Near WHERE predicate, line 1, column 90.
       Source=System.Data.Entity
       Column=90
       ErrorContext=WHERE predicate, line 1, column 90
       ErrorDescription=The argument types 'Edm.Int64' and 'Edm.String' are incompatible for this operation.
       Line=1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-23T20:20:35.360

查看异常消息`The argument types 'Edm.Int64' and 'Edm.String' are incompatible for this operation. Near WHERE predicate, line 1, column 90.`。

这意味着`ID`您的`AccountDefinition`班级的 是 a`long`或者`Int64`您尝试使用 a 来查询它`string`。

您需要执行以下操作之一：

1.  更改`string[]`为和更改`CustomersDetails(string[] SelectRight)`为_`long[]``string``GetAccount(string id)``long id`
2.  更改`return entities.AccountDefinition.Find(id);`为`return entities.AccountDefinition.Find(long.Parse(id));`

选项 1 是更好的选项，但需要更多更改（我建议您这样做），选项 2 更改较少，但如果`id`为 null 或无法解析为`long`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-07T17:35:46.500

I know this is an old post but I figured I'd add a comment here since I had the same problem.

All I did was re-arrange the parameters in the find function.

I had it like this:

```
public ActionResult Details(Int32 id, string dataSource)
        {
            TVData_VW_ShowList tvdata_vw_showlist = context.TVData_VW_ShowList.Find(id, datasource);
            if (tvdata_vw_showlist == null)
            {
                return HttpNotFound();
            }
            return View(tvdata_vw_showlist);
        } 
```

And I had to change it to this:

```
public ActionResult Details(Int32 id, string dataSource)
        {
            TVData_VW_ShowList tvdata_vw_showlist = context.TVData_VW_ShowList.Find(dataSource, id);
            if (tvdata_vw_showlist == null)
            {
                return HttpNotFound();
            }
            return View(tvdata_vw_showlist);
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:11:59.533

您传递给 Find 方法 string 但预期为 Int64 `The argument types 'Edm.Int64' and 'Edm.String'`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-26T08:33:46.740

我花了很多时间来解决这个问题，但最后发现 .Find(Key1, Key2, ..) 中的键序列应该与 Edmx 图实体中的键序列匹配。

# r - 进入一个环境

> ID：14014272
> 
> 赞同：2
> 
> 时间：2012-12-23T20:02:13.533
> 
> 标签：r

我想问是否有一个功能可以将我们发送到一个环境中。例如：

```
# create two environments
Env1 <- new.env()
Env2 <- new.env()

# assign one variable into each environment
assign("v1", "1", envir = Env1)
assign("v2", "2", envir = Env2)

# In order to refer to the variable in Env2 I have to use Env2$v2, for example 
print(Env2$v2)

# The question is if there is some function that sents us into Env2
# so that when we refer to the variable in Env2 to use just v2, that is
print(v2) 
```

谢谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:06:44.300

根据“引用变量”的含义，`attach`执行以下操作：

```
attach(Env2)
print(v2)
## [1] "2"

detach()
print(v2)
## Error in print(v2) : object 'v2' not found 
```

尝试修改该值是另一回事，因为它附加在位置 2。

# php - 将表单重定向到另一个页面而不是 API

> ID：14014273
> 
> 赞同：3
> 
> 时间：2012-12-23T20:02:13.800
> 
> 标签：php, html, xml, forms, api

好的，这是我的情况。

我有一个 php 文件，其中包含一个简单的表单，要求输入姓名、编号等。现在，当我单击提交时，我将表单操作设置为处理这些变量的 API 的 URL。

问题是，当我提交表单时，它会将我带到 API 网站使用一些乱码 xml 文本确认提交的页面。

我想做的是能够让用户填写表单数据，秘密地将该数据提交到 API URL，并为用户显示一个感谢页面。我不希望用户知道 API 的确认页面，只是提交表单，直接将他带到感谢页面。

API 接受以下形式的请求

```
"MY-API-URL.com/json?api_key=KEY&api_secret=SECRET&login=LOGIN&password=PASSWORD" 
```

这是表格标题..

```
<form action="MY-API-URL.com" class="login"> 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:24:14.517

进行 ajax 调用以提交您的表单。

制作一个像这样的自我提交表单`action=""`：

```
<form id="login" name="login" action="" method="POST">
    <input type="text" name="login" value="">
    <input type="password" name="password" value="">
    <input type="submit" name="submit" value="Log in">
</form> 
```

使用 jQuery 处理表单的提交事件：

```
<script>
$(function(){
    $("form#login").submit(function(){
        var login = $("input[name=login]").val();
        var password = $("input[name=password]").val();

        $.ajax({
            url: "MY-API-URL.com/json", 
            type: "POST",
            data: {"api_key":"KEY", "api_secret":"SECRET", "login":login, "password":password},
            dataType: "jsonp",
            cache: false,
            success: function (data) {              
                //make your redirect here or just display a message on the same page
                window.location = "congrats.html";
            },
            error: function(jqXHR, textStatus, errorThrown){
                // handle your error here
                alert("It's a failure!");
            }       
        });
        //cancel the submit default behavior
        return false;
    });
});
</script> 
```

**更新：**
据我了解，*nexmo*不支持 jsonp 并且您不能使用 json，因为您正在进行跨域调用。这里有很多关于它的帖子。例如[json Uncaught SyntaxError: Unexpected token ：](https://stackoverflow.com/questions/7936610/json-uncaught-syntaxerror-unexpected-token)

作为一种解决方法，您可以使用代理。[您可以在此处](https://raw.github.com/cowboy/php-simple-proxy/master/ba-simple-proxy.php)阅读并[在此处](http://benalman.com/projects/php-simple-proxy/)下载简单代理。

如果您使用上面提到的代理，您的代码将如下所示：

```
<script> 
$(function(){ 
    $("form#sms").submit(function(){ 
        var from = $("input[name=from]").val(); 
        var to = $("input[name=to]").val(); 
        var text = $("input[name=text]").val(); 

        var url = "http://rest.nexmo.com/sms/json?api_key=key&api_secret=secret" + "&from=" + from + "&to=" + to + "&text=" + text; 
        $.ajax({ 
            url: "simple-proxy.php", 
            type: "GET", 
            data: {"url": url}, 
            dataType: "json", 
            cache: false, 
            success: function (data) {               
                //make your redirect here or just display a message on the same page 
                console.log(data); 
                if (data && data.contents && data.contents.messages && data.contents.messages.length) {
                    alert("The status is: " + data.contents.messages[0].status);
                }
                alert("SMS sent!"); 
            }, 
            error: function(jqXHR, textStatus, errorThrown){ 
                // handle your error here 
                alert("textStatus: " + textStatus + "\n" + "errorThrown: " + errorThrown); 
            }       
        }); 
        //cancel the submit default behavior 
        return false; 
    }); 
}); 
</script> 
```

我让它在我的机器上工作，它返回了正确的 json 响应。

# android - onSearchRequested() 不再适用于 Android 4.x+？

> ID：14014276
> 
> 赞同：25
> 
> 时间：2012-12-23T20:02:30.963
> 
> 标签：android, android-4.0-ice-cream-sandwich

我的应用拦截搜索按钮以提供与应用本身更相关的内容：

```
 @Override
  public boolean onSearchRequested() {
    if (isOkToSearchWithinTheApp())
      doRelevantOwnSearch();
    return true; 
  } 
```

除了在我的新 4.1.2 手机上之外，它在所有 Android 版本上（仍然有效）都很好用：在这款 Android 4.x 手机上，它自己调用了名为“Google Now”的东西。

这是众所周知的（即记录在案的变化）吗？

如果是这样，还有其他方法可以“拦截”搜索按钮吗？

**更新：**我完全按照下面@daniel_c05 的建议做了，但触摸搜索按钮仍然产生相同的行为：带来谷歌搜索活动（并暂停我自己的活动，这显然不是所需的行为）：

![在此处输入图像描述](../Images/ea95c003fc14d83112e25d844eaeb926.png)

顺便说一句，在[这个类似问题](https://stackoverflow.com/questions/11931395/jelly-bean-search-key)中接受的答案是不可接受的......那么，有没有其他方法可以“拦截”搜索按钮？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T21:43:05.307

是的，谷歌在引入 Jelly Bean (Android 4.1) 时劫持了搜索按钮，如果你试图更早地拦截它，在[onKeyDown()](http://developer.android.com/reference/android/view/View.html#onKeyDown%28int,%20android.view.KeyEvent%29)中：

```
...
else if (keyCode == KeyEvent.KEYCODE_SEARCH) {
  return this.onSearchRequested();
} 
```

你会发现它也行不通。

但也许[这种解决方法](http://linux-tipps.blogspot.com/2012/09/fix-how-to-disable-google-search-button.html)可以帮助你？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T03:47:33.263

我有一个运行 4.2.1 的 Galaxy Nexus，我使用没有问题`oonSearchRequested`

有几点需要考虑：

1 - 确保在清单中声明可搜索活动实际上是可搜索的，并确保添加搜索意图过滤器以捕获 onSearchRequested：

```
 <activity
        android:name="com.lazybits.rae.movil.Results"
        android:label="@string/title_activity_results"
        android:launchMode="singleTask"
        android:parentActivityName="com.lazybits.rae.movil.Home" >
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
        </intent-filter>
        <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
    </activity> 
```

2 - 覆盖`onKeyDown()`以制作正确的搜索界面：

```
 @Override
public boolean onKeyDown(int keyCode, KeyEvent event) {     

    if ((keyCode == KeyEvent.KEYCODE_SEARCH) && isOkToSearchWithinTheApp) {
        onSearchRequested();
        return true;
        }
    return super.onKeyDown(keyCode, event);
    } 
```

此时，如果您有一个 searchWidget，它应该会自动加载，而您现在只是在等待用户输入。您可能希望`onNewIntent`根据您的 searchable.xml 行为覆盖通过 Action.Search 或 Action.View 处理搜索。

**编辑**

好的，你能帮我一个忙，简单地尝试覆盖 onKeyDown，但不要在其中放入任何代码，如下所示：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {     

    if (keyCode == KeyEvent.KEYCODE_SEARCH) {
            //do nothing, simply return true to avoid regular behavious
            return true;
        }
    } 
```

我想测试的是，看看这是否会阻止谷歌现在出现，这绝对不会做任何事情。如果可行，那么之后您可以添加代码，只需确保返回 true（以避免进一步传播事件），并且不要调用 onSearchRequested。

# r - 产生单个结果的神经网络包

> ID：14014277
> 
> 赞同：0
> 
> 时间：2012-12-23T20:02:34.477
> 
> 标签：r, neural-network

我正在使用神经网络包来尝试预测一些连续数据的样本，但由于某种原因，它只产生一个预测值，有趣的是，这不是平均值。

这有什么常见的已知原因吗？我尝试过疯狂/随机地改变阈值、节点数和学习率的值，但无济于事，因为预测仍然是一个常数。

这是学习过程的一些输出

```
hidden: 40    thresh: 0.3    rep:  1/10    steps:     762   error: 0.39832  time: 5.65 secs
hidden: 40    thresh: 0.3    rep:  2/10    steps:      18   error: 0.33205  time: 0.21 secs
hidden: 40    thresh: 0.3    rep:  3/10    steps:      22   error: 0.33204  time: 0.18 secs
hidden: 40    thresh: 0.3    rep:  4/10    steps:      22   error: 0.33203  time: 0.19 secs
hidden: 40    thresh: 0.3    rep:  5/10    steps:      14   error: 0.33206  time: 0.11 secs
hidden: 40    thresh: 0.3    rep:  6/10    steps:      16   error: 0.33206  time: 0.14 secs
hidden: 40    thresh: 0.3    rep:  7/10    steps:      19   error: 0.33204  time: 0.14 secs
hidden: 40    thresh: 0.3    rep:  8/10    steps:      22   error: 0.33207  time: 0.19 secs
hidden: 40    thresh: 0.3    rep:  9/10    steps:    1000   min thresh: 1.054522176
                                                     1300   error: 0.3486   time: 11.05 secs
hidden: 40    thresh: 0.3    rep: 10/10    steps:      23   error: 0.33206  time: 0.22 secs 
```

有没有人遇到或解决过类似的问题？

# django - Django Postgres 错误，字段“不是字符类型”

> ID：14014280
> 
> 赞同：4
> 
> 时间：2012-12-23T20:03:07.360
> 
> 标签：django, django-models

这是这些健全性检查问题之一。这应该非常明显。要么是司机出了问题，要么我忽略了一些明显的事情。

我有一个 Django 模型字段。它是一个整数字段，非空，有选择。

```
PROVENANCE_X = 0
PROVENANCE_Y = 1

PROVENANCE_CHOICES = [
    (PROVENANCE_X, "Provenance X"),
    (PROVENANCE_Y, "Provenance Y")
] 
```

在模型中：

```
provenance = models.IntegerField(choices=PROVENANCE_CHOICES, default=PROVENANCE_X) 
```

只是为了检查一下，这是 Postgres 所说的：

```
provenance     | integer                 | not null 
```

当我在管理员中保存模型时出现错误。

```
DatabaseError
column "provenance" is not of a character type 
```

没有自定义的管理内容。错误完全出在 Django 代码中，但我不知道在哪里。`save`在调用 super 之前，我在方法中设置了一个断点来检查：

```
(Pdb) print self.provenance
0 
```

那么某些代码是否在某处试图插入一个字符而不是一个整数？

错误来自`django/db/backends/postgresql_psycopg2/base.py`.

该堆栈帧的本地查询变量：

```
'INSERT INTO "MODEL" ("A", "provenance", "B", "C") VALUES (%s, %s, %s, %s) RETURNING "MODEL"."id"'
args
(False,
 0,
 u'test',
 '098f6bcd4621d373cade4e832627b4f6',
 ) 
```

这表明查询构建接收正确的参数 (0)。注意 '%s' 不是标准格式的占位符，因为 Django 查询构建`%s`是唯一的类型。

所以这一切看起来都是正确的。

这是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:48:50.207

我追踪了它。就像最好的追踪一样，有点故事。

`backends/postgresql_psycopg2/base.py`首先，我在in 中设置了一个断点，`CursorWrapper.execute`并确定无法单步执行 with `pdb`，因此它必须是 C 模块。

因此，我搜索了确切的错误“不是字符类型”，这使我找到了`tsvector`用于全文搜索的 PostgreSQL 源代码。该行：

```
01419         if (!is_text_type(SPI_gettypeid(rel->rd_att, numattr)))
01420             ereport(ERROR,
01421                     (errcode(ERRCODE_DATATYPE_MISMATCH),
01422                      errmsg("column \"%s\" is not of a character type",
01423               trigger->tgargs[i]))); 
```

在[http://doxygen.postgresql.org/tsvector__op_8c_source.html中找到](http://doxygen.postgresql.org/tsvector__op_8c_source.html)

因此，它试图在相关领域之外创建一个 tsvector。

所以我查看了模式，你瞧，我有一个触发器。

```
Triggers:
MY_TRIGGER BEFORE INSERT OR UPDATE ON MY_TABLE FOR EACH ROW EXECUTE PROCEDURE tsvector_update_trigger('text_index', 'pg_catalog.english', 'X', 'Y', 'Z', 'provenance') 
```

我忘记了这件事。我不知道为什么它以前工作，然后停止工作，但这就是问题所在。

**tl;dr 更新触发器正在构建`tsvector`字段外，并且正在抱怨该类型。数据或驱动程序没有任何问题，只是触发器执行了错误的数据类型。**

# curl - curl：谷歌电子表格作为 .csv

> ID：14014283
> 
> 赞同：3
> 
> 时间：2012-12-23T20:03:53.780
> 
> 标签：curl, google-docs, google-sheets

我想使用 curl 下载我的一个谷歌电子表格并将其保存为 .csv 文件。以下是我正在使用的命令：

(curl --silent --header "授权：GoogleLogin auth=AUTH_KEY" [https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=SPREADSHEET_KEY&exportFormat=csv](https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=SPREADSHEET_KEY&exportFormat=csv) ) > a.csv

这是下载pdf格式的文件。谁能帮我解决这个问题，我被困了 1 小时...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-07-29T20:41:06.313

这有效：`curl 'https://docs.google.com/spreadsheets/d/<yourkey>/export?exportFormat=csv'`，具有足够的链接共享参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T02:12:41.373

尝试添加“&hl”和引号

IE。curl --silent --header "授权：GoogleLogin auth=AUTH_KEY" " [https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=SPREADSHEET_KEY&hl&exportFormat=csv](https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=SPREADSHEET_KEY&hl&exportFormat=csv) "

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-14T18:29:15.120

你需要报价。没有它们，`&`将命令分为后台进程和前台进程 - 此时，将`exportFormat=csv`在您的 bash shell 中设置一个名为 exportFormat 的变量，其值为 csv；exportFormat 不会转到 google 页面，因此它会以默认格式 pdf 将其吐出：这不是您想要的。尝试： `curl --silent -o a.csv--header "Authorization: GoogleLogin auth=AUTH_KEY" "https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=SPREADSHEET_KEY&exportFormat=csv"`

# gdb - GDB远程调试，好像找不到符号

> ID：14014288
> 
> 赞同：15
> 
> 时间：2012-12-23T20:04:29.983
> 
> 标签：gdb, remote-debugging

我正在尝试远程调试在地址为 192.168.98.64 的机器上运行的应用程序。在我运行的那台机器上：

```
gdbserver serveripaddr:4444 程序名

```

然后从服务器运行“gdb”，然后在 gdb 提示符下运行：

```
(gdb) 目标远程 192.168.98.64:4444
使用 192.168.98.64:4444 进行远程调试
[新线程 28432]
警告：无法加载 vsyscall 页面，因为未指定可执行文件
首先尝试使用“文件”命令。
0xb775e810 在?? ()
(gdb) 内部中断[TAB]

```

在尝试设置断点以显示以 internal 开头的相应函数列表时，我期待按下 TAB 键，但它没有显示任何内容。代码已在使用 -g 打开调试的情况下编译。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T00:53:13.293

> 我运行“gdb”

你应该给 GDB 你正在调试的可执行文件（最好是它的非剥离版本）：

```
gdb /path/to/progname
(gdb) target remote 192.168.98.64:4444 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T09:43:40.560

当我使用交叉编译的 gdb 时，我自己也遇到了这个问题（如果你的远程主机有不同的架构，你通常会需要这个）。在这种情况下，需要从远程主机上编译的二进制文件中读取符号。我发现以下内容对我有用（如果主机上的架构相同）：

在远程主机上：

```
gdbserver [host]:[port] [remote-path-to-binary-from-gdbserver-workdir] 
```

然后在（交叉编译的）gdb 中的本地主机上：

```
shell sleep 5
target remote [host]:[port]
symbol-file remote:[remote-path-to-binary-from-gdbserver-workdir]
directory [local-root-directory-for-source-files]
continue 
```

`[*]`用您的数据替换。您可以将其用作 gdb 脚本（因此`sleep`在第一行中）或在您的 gdb 命令行中输入它。可选的目录行告诉它将本地源目录添加到源的搜索路径中。如果您使用指向源代码的前端，这将很有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-12-11T15:29:45.973

远程调试时，gdb 客户端不知道从哪里加载符号。你有两个选择：

1.  启动 gdb 时指定可执行文件

    ```
     gdb <executable>
     (gdb) target remote <IP>:<port>
     (gdb) load <executable>
      gdb should know symbols now
     (gdb) b main
     (gdb) mon reset
     (gdb) continue
      it should break at main
     (gdb) bt 
    ```

2.  使用文件命令来讲述符号。

    ```
     gdb
     (gdb) target remote <IP>:<port>
     (gdb) load <executable>
     (gdb) file <executable>
      gdb should know symbols now
     (gdb) b main
     (gdb) mon reset
     (gdb) continue
      it should break at main
     (gdb) bt 
    ```

PS：确保你已经编译了带有调试符号的可执行文件`-g -O0`

# android - ICS下使用Android CalendarContract.Calendars获取用户创建的日历

> ID：14014289
> 
> 赞同：1
> 
> 时间：2012-12-23T20:04:34.650
> 
> 标签：android, calendar, android-contentresolver

我有一个在 Android API 14 之前编写的旧应用程序，它曾经可以很好地访问我所有的 Google 日历。几个月前我升级到 ICS 并合并了使用 API 的更改，一切仍然正常。但是最近的 ROM 闪存导致它再次损坏。

问题是应用程序无法查看除默认 Google 日历之外的任何日历。以前调用日历内容解析器将返回所有日历，包括假日日历。

我在 API 文档中找不到任何提示我可能需要在这里做什么的内容。

```
public static List<dateEvent> readCalendar(Context context, String idString ) {
  ContentResolver contentResolver = context.getContentResolver();
  final Uri calendar_URI = Calendars.CONTENT_URI;
  final Uri dates_URI = Instances.CONTENT_URI;

  String selection = "((" + Calendars.ACCOUNT_NAME + " = ?) AND ("
    + Calendars.ACCOUNT_TYPE + " = ?) AND ("
    + Calendars.OWNER_ACCOUNT + " = ?))";

  String[] selectionArgs = new String[] {
                "myaddress@gmail.com", "com.google", "myaddress@gmail.com"};
  cursor = contentResolver.query(calendar_URI,
            (new String[] {   Calendars._ID,
                              Calendars.CALENDAR_DISPLAY_NAME,
                              Calendars.VISIBLE  } ),
            selection, selectionArgs, null );

  List<dateEvent> dateList = new LinkedList<dateEvent>();

  while (cursor.moveToNext()) {
    final String _id = cursor.getString(0);
    final String displayName = cursor.getString(1);
    System.out.println("Id: " + _id + " Display Name: " + displayName);
  }
} 
```

# python - Python继承——从基类到派生类

> ID：14014292
> 
> 赞同：3
> 
> 时间：2012-12-23T20:04:49.190
> 
> 标签：python, inheritance, derived-class

给定 a`class`和其他直接或间接扩展它的类。有没有办法获得所有直接扩展原始类的类。

```
class Alpha(object):
    @classmethod
    def get_derivatives(cls):
        return [Beta, ] # when called from Alpha
        return [] # when called from Beta

class Beta(Alpha):
    pass 
```

我猜有一些并发症，或者完全不可能。必须有一些关于派生类在哪里定义的规范，这会使事情变得棘手......

我最好的选择是将派生类硬编码到基类中吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T20:11:27.973

也许您正在寻找[`__subclasses__`方法](http://docs.python.org/2/library/stdtypes.html#class.__subclasses__)：

```
class Alpha(object):
    @classmethod
    def get_derivatives(cls):
        return cls.__subclasses__() 

class Beta(Alpha):
    pass

print(Alpha.get_derivatives())
print(Beta.get_derivatives()) 
```

产量

```
[<class '__main__.Beta'>]
[] 
```

# gradle - 使用 Cobertura 会产生 NoClassDefFoundError

> ID：14014297
> 
> 赞同：2
> 
> 时间：2012-12-23T20:05:00.890
> 
> 标签：gradle, cobertura

我们正在使用 Cobertura（在 gradle 构建中定义）。当我部署应用程序并在 swing 客户端中单击时，出现来自 cobertura 的 NoClassDefFoundError。

```
java.lang.NoClassDefFoundError: net/sourceforge/cobertura/coveragedata/HasBeenInstrumented
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at com.sun.jnlp.JNLPClassLoader.findClass(JNLPClassLoader.java:345)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:247) 
```

我不知道这是从哪里来的。我的 Java 代码中没有任何来自 cobertura 的内容。唯一定义 cobertura 的地方是在 gradle 构建文件中作为依赖项：

```
testCompile "net.sourceforge.cobertura:cobertura:1.9.4.1" 
```

我对两个主要项目进行了 grep：

```
find -type f -name "*gradle*" -exec grep -Hn cobertura {} \; 
```

结果如下：

```
./BigTableDataProvider/ext-test/build.gradle:7:def cobSerFile = "$buildDir/cobertura.ser"
./BigTableDataProvider/ext-test/build.gradle:24:    testCompile 'net.sourceforge.cobertura:cobertura:1.9.4.1'
./BigTableDataProvider/ext-test/build.gradle:34:    codeCoverageRun 'net.sourceforge.cobertura:cobertura:1.9.4.1'
./BigTableDataProvider/ext-test/build.gradle:42:    jvmArgs = sampleJvmArg.split(" ").toList() << "-Dnet.sourceforge.cobertura.datafile=$cobSerFile"
./BigTableDataProvider/ext-test/build.gradle:50:        'cobertura-instrument'(datafile: cobSerFile) {
./BigTableDataProvider/ext-test/build.gradle:63:    ant.'cobertura-report'(destdir: "${project.buildDirName}/reports/codeCoverage",

./BigTableExplorer/sample/server/build.gradle:10:    testCompile 'net.sourceforge.cobertura:cobertura:1.9.4.1' // Add this if sample module has inherited classes from server.
./BigTableExplorer/ext-server/build.gradle:20:    testCompile "net.sourceforge.cobertura:cobertura:1.9.4.1"
./BigTableExplorer/ext-test/build.gradle:7:def cobSerFile = "cobertura.ser"
./BigTableExplorer/ext-test/build.gradle:22:    testCompile 'net.sourceforge.cobertura:cobertura:1.9.4.1'
./BigTableExplorer/ext-test/build.gradle:34:    codeCoverageRun 'net.sourceforge.cobertura:cobertura:1.9.4.1'
./BigTableExplorer/ext-test/build.gradle:42:    jvmArgs = sampleJvmArg.split(" ").toList() << "-Dnet.sourceforge.cobertura.datafile=$cobSerFile"
./BigTableExplorer/ext-test/build.gradle:50:        'cobertura-instrument'(datafile: cobSerFile) {
./BigTableExplorer/ext-test/build.gradle:63:    ant.'cobertura-report'(destdir: "${project.buildDirName}/reports/codeCoverage", 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T12:10:50.767

您不小心部署了 Cobertura 检测代码。Gradle 构建必须使用某些第三方 Cobertura 插件或 Cobertura Ant 任务，并且显然配置不正确。

# asp.net - 登录条件由下拉列表错误

> ID：14014299
> 
> 赞同：1
> 
> 时间：2012-12-23T20:05:15.490
> 
> 标签：asp.net, vb.net

我想为 2 种类型登录：管理员和普通用户，每个都有差异表，我将通过下拉列表检查类型，

问题：它赢得`t get into if statement that check the type. how to make it check what`了下拉列表的值，并取决于它决定检查哪个表。

```
Imports System
Imports System.Collections.Generic
Imports System.Linq
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls
Imports System.Data.SqlClient
Imports System.Configuration
Imports System.Data
Imports System.Threading

Public Class _Default
Inherits System.Web.UI.Page
Public s As String

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Session.Clear()

End Sub

Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    Dim con As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
    con.Open()
    Dim userCount As Int32 = GetUserCount(txtUserName.Text)
    Dim paasCount As Int32 = GetPassCount(TxtPassword.Text)
    Dim userCount2 As Int32 = GetUserCount(txtUserName.Text)
    Dim paasCount2 As Int32 = GetPassCount(TxtPassword.Text)
    Dim x As String = DrpType.SelectedValue

    If x = "Admin" Then
        If userCount2 > 0 And paasCount2 > 0 Then
            Session("FirstName") = txtUserName.Text
            Response.Redirect("LoggedIn.aspx")
            ClientScript.RegisterStartupScript(Page.GetType(), "Message", "alert('Admin')", True)
        Else
            lblErr.Visible = True
        End If

    ElseIf x = "Cus" Then
        If userCount > 0 And paasCount > 0 Then
            Session("FirstName") = txtUserName.Text
            Response.Redirect("LoggedIn.aspx")
            ClientScript.RegisterStartupScript(Page.GetType(), "Message", "alert('Customer')", True)
        Else
            lblErr.Visible = True
        End If
    End If
End Sub

' Method to check existence for users
Public Shared Function GetUserCount(ByVal userName As String) As Int32
    Const sql1 = "SELECT COUNT(*) FROM Registration where username = @UserName"
    Using con As New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        Using cmd = New SqlCommand(sql1, con)
            cmd.Parameters.AddWithValue("@UserName", userName)
            con.Open()
            Using reader = cmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim count As Int32 = reader.GetInt32(0)
                    Return count
                End If
            End Using
        End Using
    End Using
End Function

' Method to check PAssword for users
Public Shared Function GetPassCount(ByVal password As String) As Int32
    Const sql2 = "SELECT COUNT(*) FROM Registration where password = @Password"
    Using con As New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        Using cmd = New SqlCommand(sql2, con)
            cmd.Parameters.AddWithValue("@Password", password)
            con.Open()
            Using reader = cmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim count As Int32 = reader.GetInt32(0)
                    Return count
                End If
            End Using
        End Using
    End Using
End Function

        ' Method to check existence for admin
Public Shared Function GetUserCount2(ByVal userName2 As String) As Int32
    Const sql3 = "SELECT COUNT(*) FROM Adm_Login where username = @UserName"
    Using con As New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        Using cmd = New SqlCommand(sql3, con)
            cmd.Parameters.AddWithValue("@UserName", userName2)
            con.Open()
            Using reader = cmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim count As Int32 = reader.GetInt32(0)
                    Return count
                End If
            End Using
        End Using
    End Using
End Function

         ' Method to check PAssword for admin
Public Shared Function GetPassCount2(ByVal password2 As String) As Int32
    Const sql4 = "SELECT COUNT(*) FROM Adm_Login where password = @Password"
    Using con As New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        Using cmd = New SqlCommand(sql4, con)
            cmd.Parameters.AddWithValue("@Password", password2)
            con.Open()
            Using reader = cmd.ExecuteReader()
                If reader.HasRows Then
                    reader.Read()
                    Dim count As Int32 = reader.GetInt32(0)
                    Return count
                End If
            End Using
        End Using
    End Using
End Function

Public Sub DrpType_SelectedIndexChanged(sender As Object, e As EventArgs) Handles DrpType.SelectedIndexChanged

End Sub

End Class 
```

# objective-c - UITextView 行号

> ID：14014303
> 
> 赞同：0
> 
> 时间：2012-12-23T20:05:41.733
> 
> 标签：objective-c, ios, uitextview

> **可能重复：**
> [如何向 UITextView 添加行号？](https://stackoverflow.com/questions/2836162/how-to-add-line-numbers-to-a-uitextview)

我正在尝试在 iOS 上创建一个简单的代码编辑器视图。我见过许多在视图左侧有行号的应用程序。我不知道如何实现这一点。它是在代码编辑器视图更改时维护的单独视图吗？或者可能完成的自定义绘图是drawRect：？一些指导将不胜感激。

# html - 将 Video.js 集成到非 HTML5 页面

> ID：14014305
> 
> 赞同：0
> 
> 时间：2012-12-23T20:05:52.153
> 
> 标签：html, html5-video, flash-video

是否可以将[Video.js](http://videojs.com/)播放器安装到非 HTML5 页面（例如 HTML 4.01 Strict）？即在不实际使用 HTML5 文档类型的情况下使用 HTML5 功能。做这个的最好方式是什么？如果有的话，它会导致什么并发症或问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T23:13:49.990

HTML5 功能不依赖于您正在访问的站点的文档类型，而是依赖于显示页面的浏览器。如果您将 HTML5 标记（“视频”、“文章”等）插入到具有 html 4.01 严格文档类型的页面中，只要浏览器理解相关标记，它将正确显示。

# variables - python中的变量正确使用

> ID：14014306
> 
> 赞同：3
> 
> 时间：2012-12-23T20:06:05.293
> 
> 标签：variables

给定变量`a`, `b`:

```
b = 3

a = b++

a = --b 
```

你如何在 Python 中正确地写这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T20:10:04.410

来自[Python 之禅](http://www.python.org/dev/peps/pep-0020/)：

> 显式优于隐式

所以，让我们写：

```
b = 3
a = b; b +=1
b -= 1; a = b 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-23T20:09:21.027

Python中没有递增/递减 ( `++`/ ) 运算符。`--`这是因为 Python 中的整数是**不可变**的（不能修改，只能重新分配）。因此，让我们将其分解并模仿他们的行为。

做什么`b++`？它计算为`b`，然后递增`b`。因此，我们将其写为：

```
a = b
b += 1 
```

现在进入`--b`. 它递减`b`，然后计算为 的新值`b`。在 Python 中：

```
b -= 1
a = b 
```

把它们放在一起，我们得到：

```
b = 3
a = b
b += 1
b -= 1
a = b 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T20:07:12.657

在 Python 中，你不能做`b++`. 没有加号。

有 operator `+=`，所以你可以这样的东西：

```
b = 3

b += 1

b -= 1 
```

或者简单地说：

```
b = 3

a = b + 1

a = b - 1 
```

# xml - 使用 dtd 文档验证 xml 文档

> ID：14014307
> 
> 赞同：2
> 
> 时间：2012-12-23T20:06:16.417
> 
> 标签：xml, dtd

我是 XML 新手。我很困惑 DTD 文档如何验证 XML 文档。以下是我的代码，如果我错了，请纠正我。

```
<?xml version="1.0" encoding="iso-8859-1"?>

<!DOCTYPE note  
[
<!ELEMENT note (to,from,heading,body)>
<!ELEMENT to (#PCDATA)>
<!ELEMENT from (#PCDATA)>
<!ELEMENT heading (#PCDATA)>
<!ELEMENT body (#PCDATA)>
]>

<note>
<to>Tove</to>

<rom>Jani</rom> // Here i've miss-spelled the tag <from> but still not getting error

<heading>Reminder</heading>
<body>Don't forget me this weekend!</body> 
</note> 
```

我知道 DTD 用于验证 XML 数据。有一个元素名称`<form>`。我刚刚更改了 to 的拼写，`<form>`但`<rom>`在我的浏览器中仍然没有收到任何错误消息。我被困在这一点上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T02:32:05.867

欢迎来到 XML 社区。

您需要为您的 XML 找到并使用一个验证解析器；如果您想使用 Web 浏览器，您可能会感到失望。默认情况下，旧版本的 Internet Explorer 根据 DTD 验证 XML；较新的版本没有（但我相信如果您能弄清楚如何配置它们，您可以配置它们）。基于 Mozilla 的浏览器根本没有验证 XML 解析器。

大多数认真使用 XML 的人最终都会使用特定于 XML 的工具进行验证。我最喜欢的命令行验证是

*   xmllint（libxml2 的命令行界面，它是 Gnome 项目的一部分，但也可以在 Gnome 之外使用）

*   rxp（由爱丁堡大学的 Richard Tobin 撰写）

*   Xerces J、Xerces C（这些是 Apache 项目）

还有一些支持 XML 的编辑器，它们在编辑器内提供集成验证（有时来自您选择的几个解析器）。

# visual-c++ - DetourFunction 未定义

> ID：14014310
> 
> 赞同：3
> 
> 时间：2012-12-23T20:06:59.183
> 
> 标签：visual-c++, visual-studio-2012

我正在使用此代码进行挂钩，并且正在使用 MS Detours。我已将 Detours.cpp、Detours.h、Detours.lib 放入**detours**目录中，我将其临时创建到我的 VS（Visual Studio）代码所在的挂钩文件夹中。我使用VS设置将放置的detours目录包含为“Additional include directory”和“Additional Library directory”的目录。程序在这里

```
#include <Windows.h>
#include "detours.h"
#pragma comment(lib, "detours.lib")

typedef BOOL (__stdcall* tGetFileVersionInfoExW)(DWORD dwFlags, LPCWSTR lpwstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData);
tGetFileVersionInfoExW pGetFileVersionInfoExW;

BOOL WINAPI MyGetFileVersionInfoExW(DWORD dwFlags, LPCWSTR lpwstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData)
{
    //Messagebox
    MessageBox(NULL, "myGetFileVersionInfoExW Just Got Called","InsertDateTime", MB_OK);
    return pGetFileVersionInfoExW(dwFlags, lpwstrFilename, dwHandle, dwLen, lpData); //Return the origional function
}

BOOL APIENTRY DllMain(HANDLE hModule, DWORD ul_reason_for_call, LPVOID lpReserved)
{
    switch (ul_reason_for_call) //Decide what to do
    {
    case DLL_PROCESS_ATTACH: //On dll attach
        {
            pGetFileVersionInfoExW = (tGetFileVersionInfoExW)DetourFunction((PBYTE)0x0100A036, (PBYTE)MyGetFileVersionInfoExW);
        }
        break;

    case DLL_THREAD_ATTACH: //On thread attach
        break;
    case DLL_THREAD_DETACH: //On thread detach
        break;
    case DLL_PROCESS_DETACH: //on process detach
        {
            DetourRemove((PBYTE)pGetFileVersionInfoExW, (PBYTE)MyGetFileVersionInfoExW);
        }
        break;
    }
    return true;
} 
```

我仍然收到此错误-

```
IntelliSense: identifier "DetourRemove" is undefined    
IntelliSense: identifier "DetourFunction" is undefined 
```

如果我使用MS Detours的默认安装目录，程序仍然无法编译。我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-31T10:20:46.570

旧版本是`DetourFunction`and `DetourRemove`，现在更名为`DetourAttach`and `DetourDetach`(Detours ver. 2.0 or above)。

# java - Java - 尝试生成阶乘

> ID：14014311
> 
> 赞同：2
> 
> 时间：2012-12-23T20:06:59.410
> 
> 标签：java, calculator

我正在制作一个计算器，并添加了一些更复杂的按钮。我无法理解的是阶乘。我知道它是什么，但似乎无法做到。当我查看其他人的问题时，代码 - 无论如何对我来说 - 不起作用（顺便说一句，这不是家庭作业问题）。这是阶乘的算法（是这个词吗？）周围的代码：

```
} else if (oper.equals("shriek")) {

                resultm.setText("" + answer);
                resultl.setText("");
                resultr.setText("");
                oper = "";
                currentNuml = "";
                currentNumr = "";
            } 
```

注意：之间的差距

```
} else if (oper.equals("shriek")) { 
```

和

```
resultm.setText("" + answer); 
```

是算法要去的地方。谢谢，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:38:15.390

创建阶乘的两种变体是递归和非递归方法。

阶乘的基本逻辑是`5! = 5*4*3*2*1`

所以这应该很容易用循环（非递归）实现。只需将数字与循环号相乘即可生成循环号

```
int fact(int no){
   int result=1;
   for (int i=1;i<no;i++)result*=i;
   return result;
} 
```

第二种是递归算法。这意味着从自身内部调用函数。

```
int fact(int no){
   if(no==1)
           return 1;
   else
           return no * fact(no-1);
} 
```

这将像这样工作。

例如事实（3）

```
no=3 Go to else return 3*fact(2)
    no=2 Go to else return 2* fact(1)
                 no=1 return 1
    no=2 return 2*1 => 2
no=3 Return 3*2 => 6 
```

希望这有助于您理解

# bash - bash脚本重定向输出并通过ssh显示在另一台机器上的另一个终端上

> ID：14014312
> 
> 赞同：0
> 
> 时间：2012-12-23T20:06:59.037
> 
> 标签：bash

好的。我很难过。我有两台计算机，分别称为 machine1 和 machine2。我想在 machine1 上执行一个命令，并将输出通过管道传输到 machine2。这部分很简单，我已经可以做到了。我被难住的是如何在 machine2 上打开一个终端，该终端在机器 1 上显示终端的输出。

一个例子：我在工作中运行一个脚本，需要很多时间。这个脚本有一个内置的进度对话框，它在 machine1 的终端中显示进度。当这个脚本运行时，我离开我的工作办公室（机器 1 的位置），开车回家到我的家庭办公室（机器 2）。当我回到家时，我想在 machine2 上的终端中查看脚本的输出。

现在我使用以下解决方法：

```
#!/bin/bash

ssh user@machine2 'echo "" > file.txt; DISPLAY=:0.0 \
nohup conky -q -c /path/to/a/conkyrc \
> /dev/null 2> /dev/null < /dev/null &' \
#the conkyrc displays the last few lines of file.txt
echo "Hello world, or other commands" | ssh -q user@machine2 "sh -c 'cat >> file.txt'" 
```

因此，这会在 machine1 上运行命令，并将输出通过管道传输到机器 2 上的 file.txt，conky 读取并显示在 machine2 的屏幕上。当我回到家时，我看到我开始在工作中运行的脚本的状态显示在一个 conky 面板中。

这是实用的——但我想做得更好。

问题 1：我怎样才能修改上面的脚本，以便输出到 machine2 上的 file.txt 并且仍然在 machine1 上输出？我试过使用

```
tee -a - ???? 
```

在哪里 ？？？？是一个 ssh 位置。不幸的是，除非 ssh 位置安装在 machine1 上，否则这不起作用，我不想这样做。

问题2：我可以创建类似的效果吗，通过机器1 上的ssh 打开机器2 上的终端，并在机器1 上的终端和机器2 上的终端中显示输出。示例：我使用以下脚本的变体在 machine1 的终端中显示进度条。我想通过 machine1 的 ssh 在 machine2 上打开一个终端，并显示在 machine1 上执行的命令的进度对话框。

```
#!bin/bash
#A gauge Box example with dialog
(
c=10
while [ $c -ne 110 ]
do
    echo $c
    echo "###"
    echo "$c %"
    echo "###"
    ((c+=10))
    sleep 1
done
) |
dialog --title "A Test Gauge With dialog" --gauge "Please wait ...." 10 60 0 
```

提前感谢任何可以提供帮助的人。我不是一个伟大的程序员，只是一个头脑简单的数学家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T20:19:45.700

你必须使用`screen`

这是一个具有许多功能的神话般的`tty`模拟器！

看一眼`man screen`

（有点像*远程桌面*或*VNC*，但在字符模式下，非常快，我坚持：有**很多**不错的功能）

在机器 1 上：

```
screen -D -R 
```

这将打开一个新的`bash`.

在机器 2 上：

```
ssh -t user@machine1 screen -x 
```

*并且machine1*`tty`上会话的伪用户是共享的。

 *在任何时候，您都可以关闭窗口或断开与这两个终端中的任何一个的连接，方法是点击转义序列，`Control + A`然后按`d`.

完全可以通过键入从其他地方连接其他控制台，或者通过键入而不是`screen -x`强制断开其他控制台。`screen -D -R``screen -x`

（注意不要`screen`从屏幕会话内部运行）*

# c# - 使用 C# 创建 HTML UI 标签

> ID：14014315
> 
> 赞同：-3
> 
> 时间：2012-12-23T20:07:18.613
> 
> 标签：c#, asp.net, html

我想`LI`使用 C# 创建一个标签，如下所示：

```
<li>
    <a class="thumb" name="leaf" href="Images/Image0.jpg" title="Image 0">
        <img src="Images/Image0Thumb.jpg" alt="Image 0" />
    </a>
    <div class="caption">
        <div class="image-title">Image 0</div>
        <div class="image-desc">Description for image 0</div>
    </div>
</li> 
```

然后将其添加到现有`UL`标签中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:10:48.730

您应该使用[`LiteralControl`](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx)类来创建这种层次结构，而不是将其`ul`作为内容附加到您的标签中。

# php - 使用 PHP 创建图像 - 大文件

> ID：14014317
> 
> 赞同：0
> 
> 时间：2012-12-23T20:07:24.800
> 
> 标签：php, image-processing, png, image-resizing, imagecreatefrompng

## 问题

我正在尝试将 260x310px PNG 的大小调整为 120x120px，同时还保留透明度并使图像居中。我在下面包含了我正在使用的功能，它在图像外观方面工作得很好，但是创建的图像要大得多。事实上，所有图像看起来都是 128kb（有数千个我还没有看过它们），尽管图像大小超过一半（以像素为单位），但包含 50,000 个这些图像的目录要大 1gb。

我想这是因为 PHP 没有像 Photoshop 那样做任何优化。我可以做些什么来优化 PHP 中的图像吗？

## 编码

这是我的代码：

```
if ($handle = opendir($mydir_path)) {
    while (false !== ($entry = readdir($handle))) {
        if(strpos($entry, '.png'))
        {
            resize($mydir_path.$entry);
        }
    }
    closedir($handle);
}

function resize($img_loc)
{
    $mini_loc = str_replace('megapack', 'handheld_megapack', $img_loc);

    $canvas = imagecreatetruecolor(310, 310);
    imagefill($canvas, 0, 0, imagecolorallocatealpha($canvas, 255, 255, 255, 127));
    imagealphablending($canvas, false);
    imagesavealpha($canvas, true);

    $img = imagecreatefrompng($img_loc);
    imagecopy($canvas, $img, 25, 0, 0, 0, 260, 310);

    $resizedImg = imagecreatetruecolor('120', '120');
    imagefill($resizedImg, 0, 0, imagecolorallocatealpha($resizedImg, 255, 255, 255, 127));
    imagealphablending($resizedImg, false);
    imagesavealpha($resizedImg, true);

    imagecopyresampled($resizedImg, $canvas, 0, 0, 0, 0, '120', '120', '310', '310');

    $dirname = dirname($mini_loc);

    imagepng($resizedImg, $mini_loc, '0');

    chmod($mini_loc, 0666);

    return $mini_loc;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:09:54.110

虽然可以使用 PHP 优化文件，但通过[pngcrush](https://en.wikipedia.org/wiki/Pngcrush)之类的程序运行它是最简单的。

使用 GD，您可以尝试使用[imagepng](http://php.net/imagepng) "quality" 的第三个参数并将其设置为 9（您将其设置为 0 = 无压缩），但使用专门的 PNG 优化器您将获得更多收益。

还要检查这个问题：[PNG优化工具](https://stackoverflow.com/questions/1993678/png-optimisation-tools)

# php - 用于用户登录的 PHP 框架

> ID：14014319
> 
> 赞同：0
> 
> 时间：2012-12-23T20:07:30.520
> 
> 标签：php, codeigniter, frameworks, yii

我以前从未使用过 PHP 框架，我现在正在寻找一个。

问题是我很难决定我应该去哪一个。

就我所见，CodeIgniter 和 Yii 似乎是最好的。

我也听说过一些关于 Laravel 的事情，但我认为它还没有一个很棒的社区。

有人说 CodeIgniter 已经过时，有人说没有。

所以，是的，每个人都在说不同的事情。

使用某些框架的经验丰富的人可以帮助我选择哪个轻巧，快速并且最适合具有用户登录系统的网站（会话，cookie ......）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T00:19:05.297

你应该使用[Yii 框架](http://www.yiiframework.com/)。它具有可以轻松扩展的内置身份验证，我发现它比 Codeigniter 更容易使用。还内置了脚手架生成器和单元测试。

我曾经使用 CodeIngniter，但由于他们的社区不久前走下坡路，而且它并没有真正利用很多 PHP5 功能，所以我环顾四周，发现了 Yii。新的 codeigniter 最近可能会更好。

您还应该检查[Laravel](http://laravel.com/)。我真的很喜欢用它编码，它有一个很棒的社区和大量易于安装的插件。虽然它更多的是“自己做”，但这会给你很大的力量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T11:28:34.443

如果你需要更快，请尝试使用正确扩展的 Yii。我喜欢 Symfony2，但我正在等待下一个 LTS 版本。Yii 稳定，支持到 2015 年 12 月 31 日。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:12:12.317

你测试过[PEAR_Auth](http://pear.php.net/package/Auth/)吗？它是一个灵活的、小型的用户身份验证框架。它支持不同的身份验证后端，如 DB、Session、LDAP 等。

由于它很小且专门用于身份验证，因此它与现有代码或其他框架集成。

与其他 PEAR 包一样，更新很少会在 PEAR_Auth 上进行。它也不符合 E_STRICT。但它至少可以用作自己编码的良好起点，我们教育自己了解这样的框架如何工作。就像我说的，它不大，很容易理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:15:35.237

如果框架是一个选项，我会推荐 使用[codeigniter的](http://ellislab.com/codeigniter)[Ion_Auth](http://jondavidjohn.com/blog/2011/01/scalable-login-system-for-codeigniter-ion_auth)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T13:28:26.567

我认为所有框架都适用于 cookie 和会话。但是当我在不到两个月前处于完全相同的位置时（自 1996 年以来我没有创建网站:) 我决定使用 CodeIgniter，它对我有用，因为它不仅有非常好的文档，还有[phpacademy](http://www.youtube.com/phpacademy)的精彩视频教程（我没有任何关联，但如果没有他们，我将无处可去）。

如果您以前从未使用过 PHP 框架（就像 2 个月前的我一样），您可能很难消化特定的框架逻辑，而是它们之间共享的内容（MVC 模式），因此文档越好，就越容易为你。我也看过 Yii，但它的文档似乎有点稀疏。

关于身份验证，您可能会发现我的[这个答案](https://stackoverflow.com/questions/13999441/codeigniter-authentication-system-that-allows-3rd-party-auth/14003119#14003119)很有帮助（这有点无耻的自我推销:)。

我认为大多数人都会同意“哪个框架”是一个非常主观的问题，您首先应该对自己的选择感到满意。您还可以尝试检查和比较对[google 趋势](http://www.google.com/trends/explore#q=codeigniter%2C%20yii%2C%20cakephp%2C%20pear%20php&cmpt=q)中不同框架的兴趣（CI 正在增长），当您阅读任何意见时，请确保查看日期 - CI 和 Yii，例如，不断发展。

祝你好运，无论你选择什么！

# ruby - 显示按日期分组的对象 - 当我需要一个对象时获取一个哈希数组

> ID：14014321
> 
> 赞同：0
> 
> 时间：2012-12-23T20:07:43.787
> 
> 标签：ruby, ruby-on-rails-3, activerecord, group-by, ruby-on-rails-3.2

我正在尝试收集`Product`按updated_at 分组的所有记录，然后为每个日期呈现带有表格的部分视图。

问题是当我处于部分状态时，我得到的是一个哈希数组而不是一个对象列表。

我的控制器：

```
@products = Product.all.group_by { |product| product.updated_at.to_date} 
```

我的看法`index.html.erb`：

```
<% @products.each do|products_for_one_day| %>
  <%= render :partial => 'product_table', :locals => { :products => products_for_one_day } %>
<% end %> 
```

我的部分`_product_table.html.erb`：

```
<table>
  <tr>
    <th>example</th>
  </tr>

  <% products.each do |product| %> 
    <tr>
      <td><%= product.example %></td>
      . . .
    </tr>
  <% end %>
</table> 
```

当我进入这个视图时，我的`products`变量包含一个数组，其中第一个对象是日期，然后第二个对象是我的产品列表：

```
[Sun, 16 Dec 2012, [#<Product id: 184, example: "FirstItem"> #<Product id: 191, name: "SecondItem">]] 
```

. . . 所以我的第一个`product`只是日期，我无法根据日期呈现表格，然后第二个产品是包含我的（在本例中为 2 个）产品的哈希，无论如何我都无法以我想要的方式迭代，因为它们不是 Product 对象（我可以称之为 product.example ）。

我该如何纠正这个问题，以便此时我可以使用 Product 对象构建一个表，而不必处理这个奇怪的数组哈希对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:15:26.603

尝试像这样迭代：

```
<% @products.each do|date, products_for_one_day| %>
  <% render :partial => 'product_table', :locals => { :products => products_for_one_day } %>
<% end %> 
```

# java - 在该类中更改该类中的字段的正确方法？

> ID：14014322
> 
> 赞同：0
> 
> 时间：2012-12-23T20:07:50.603
> 
> 标签：java, oop, getter-setter

所以我最近学会了如何使用类，但我不确定在该类中更改类中字段的最佳方法是什么？

我的意思是我知道当我在另一个类中更改它时，我会执行类似 example.setX(0) 的操作来更改该类中的 X 值，因为它是一个私有变量。但是，使用该类中的代码更改值的更好方法是什么，我应该只执行 x = 0、setX(0) 还是 this.setX(0)？这样做的更公认的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:11:34.360

如果您想避免调用 setter 的开销，并且您确定 setter 中的“永远”不会比赋值更多，那么可以调用

```
x = 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:09:48.797

```
this.setX(0) 
```

确保包含更改变量所需的额外逻辑（如果设置 x，是否需要检查 y？）。并`this`明确变量在其中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:13:40.753

如果你的类中有一个私有全局变量 x，你可以这样做

```
x = 0; //If you don't have another variable x defined for the method, if you do use

this.x = 0; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:13:56.197

你不需要通过setter来设置它，只需要写x = 0; 您需要 getter 和 setter 来访问其他类的变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T01:51:51.817

典型的方法是在您的班级中使用正常作业：

```
x = 5; 
```

并在课堂外使用 getter/setter。

```
object.setX(5); 
```

# language-agnostic - 如何以可靠的方式测量执行一段代码所花费的时间？

> ID：14014324
> 
> 赞同：3
> 
> 时间：2012-12-23T20:08:08.387
> 
> 标签：language-agnostic, benchmarking, time-measurement

关于如何测量执行时间的问题已经在 SO 上被问过很多次了，例如看[这里](https://stackoverflow.com/questions/313893/how-to-measure-time-taken-by-a-function-to-execute)或[这里](https://stackoverflow.com/questions/7497630/how-to-measure-the-time-that-a-piece-of-code-takes-to-execute)。然而，这些问题主要集中在使用哪些计时功能。

我感兴趣的是如何使结果可重现。例如，由于多任务处理，测试代码的执行可能会被影响结果的某些后台进程中断。为了克服这个问题，我已经看到一些基准测试进行了多次运行并花费了最好的时间（除了在循环中多次运行代码之外）。

关于如何使结果更可靠和可重复，还有其他建议或想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T05:32:02.743

首先，您可能希望将要加速测试的代码与对您不想测试的代码的调用分开。尤其要确保这样的代码不会做文件 IO、显示输出、日志记录、控制台输出等。（当然，除非你测试 IO 代码本身）

您还可以提前加载进行测试运行所需的所有数据，这样就不会测量数据加载。

好的技巧是尽可能少地测试。如果您可以追踪到最有影响的那几行，那么您可以找到一种方法将它们与其余代码分开测试。甚至可能将它们复制/粘贴到专门为此目的设计的新功能中。

如果你真的打算做高清计时，你也可以尝试使用 OS 提供的功能进入实时或高优先级 CPU 模式。

在某些情况下，您可能希望查看生成的低级机器代码，然后使用来自 CPU 制造商（或 VM 实现）的参考数据来计算相关代码需要多少“cpu-ticks”。由于许多 cpu/vm 指令的执行时间取决于管道/操作数/cpu 模型/等，因此即使这种方法也将提供近似值。

因此，最好的建议是正确设置测量的误差范围。通常，当我开始对某些代码进行时间测试时，我个人会考虑这 10%。然后这个值可以（通常）减少。但它永远不会是 0%。因此，当您的程序输出“执行时间：%i ns”时，您可以（并且可能应该）始终打印“+- X ns”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T13:05:37.273

请检查它在 Java 中可能有用的代码

```
package com.test.stackoverflow;

public class Sample {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub
        long startTime = System.currentTimeMillis();

        for(int i=0;i<10000; ++i)
        {
            System.out.println("You ae executng Looop");
        }
        long endTime = System.currentTimeMillis();

        long diffTime = endTime - startTime;

        System.out.println("Start Execution at in Time (Seconds ) "+ startTime * 0.001);

        System.out.println("End Execution at in Time (Seconds ) "+ endTime  * 0.001);

        System.out.println("Difference in Time (Seconds ) "+ diffTime * 0.001);

    }

} 
```

# php - Javascript正则表达式查找PHP对象

> ID：14014326
> 
> 赞同：0
> 
> 时间：2012-12-23T20:08:42.333
> 
> 标签：php, javascript, regex, object

如何在 javascript 中使用正则表达式找到 php 对象属性？

例如，这里有一些 php.ini 文件。

```
 $obj = new stdClass();
 $obj->name = ''; 
```

使用正则表达式，我希望得到`name`.

我想正则表达式会寻找一个`/\$\w+/`变量，后跟`->`，或者可能只有`->`？

正则表达式的目的是扩展一些语法高亮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:22:22.380

`\$[a-zA-Z0-9_]+\s*->\s*([a-zA-Z0-9_]+)\s*=\s*([^;]+);`假设没有引用分号，将起作用；如果您引用了分号，则正则表达式是一个糟糕的选择。第一组是变量名，第二组是赋值。

# php - PHP 文件的 JQuery 自动完成源路径

> ID：14014327
> 
> 赞同：2
> 
> 时间：2012-12-23T20:08:43.283
> 
> 标签：php, jquery, autocomplete

我正在使用调用 php 文件的 jquery 自动完成功能。效果很好。这就是问题所在。

如果我将 PHP 文件放在与我的网页相同的目录或子目录中，效果会很好。像这样：

```
 $(function() {      
        $( "#location" ).autocomplete({
        source: "subdirectory/lookup.php",
        minLength: 2,
        });
    }); 
```

以上没有问题。问题是，我想将lookup.php 存储在名为search 的目录中上一层的不同目录中。

我试过“../search/lookup.php”和“http://www.mydomain.com/search/lookup.php”和一堆不同的组合，都无济于事。

我似乎无法连接到 php 文件，除非它与页面或子目录位于同一目录中。这真的很糟糕，因为我想在整个网站的许多页面的标题中使用它。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T20:21:46.907

您可以重定向到 lookup.php 文件。例如，您将文件redirect.php 放在具有自动完成功能的文件所在的目录中。输入它

```
<?php header('Location: ../search/lookup.php'); ?> 
```

然后把lookup.php放到../search/lookup.php目录下（你知道我的意思，我希望）

不是最好的方法，但应该有效。

# css - moz-placeholder 在 Firefox 中不起作用

> ID：14014329
> 
> 赞同：8
> 
> 时间：2012-12-23T20:09:03.317
> 
> 标签：css

请参阅下面的代码，占位符的 CSS 在 Firefox（最新版本）中不起作用，但在 Chrome 中可以正常工作。如何为 Firefox 修复它？

字段有多种输入颜色，但占位符只有一种颜色，所以我不想在 moz-placeholder 属性中指定任何类名，以便它适用于所有输入字段。

**HTML：**

```
<div class="row">
    <input type="text" placeholder="some text asdf" value="" />
</div> 
```

**CSS：**

```
::-webkit-input-placeholder { color:red; }
::-moz-placeholder { color:red; }
input:-moz-placeholder { color:red; }

.row input[type="text"]{
     color: blue;     
} 
```

**演示：http:** [//jsfiddle.net/C6fjh/](http://jsfiddle.net/C6fjh/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-05-13T09:27:28.607

在某些情况下，与 Chrome 或 IE 相比，Mozilla 中的红色会显示得更浅。在这种情况下，您也需要添加 opacity:1 。

例如

`:-moz-placeholder { color: red; opacity:1;} ::-moz-placeholder { color: red; opacity:1;}`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-23T20:14:25.830

我没用，只是最后一条规则被 Firefox 认为更具体。尝试这个：

```
::-webkit-input-placeholder { color:red; }
.row input[type="text"]::-moz-placeholder { color:red; }
.row input[type="text"]:-moz-placeholder { color:red; }

.row input[type="text"] {
     color: blue;     
} 
```

请参阅[此小提琴](http://jsfiddle.net/C6fjh/2/)以获取工作演示。

我不确定浏览器的差异来自哪里，或者哪个是“正确的”。标签和伪类的[类似实验](http://jsfiddle.net/nDNdg/2/)在FF 和 Chrome 中显示了相同的行为：如果元素的选择器更具体，两者都将忽略伪类颜色（如果你按照我上面建议的方式进行相同的更改，你会得到相同的结果[（预期?)](http://jsfiddle.net/nDNdg/3/) Chrome 和 FF 中的行为）。`a``:hover`

# joomla - Joomla 中的参考 CCK 类型？

> ID：14014340
> 
> 赞同：2
> 
> 时间：2012-12-23T20:10:26.767
> 
> 标签：joomla, joomla2.5, joomla-extensions

使用 Joomla！3.0（或 2.5，无论效果如何），我需要创建一个由三种实体类型组成的系统：

艺术家——姓名、原籍国、社交媒体/网站链接等设置——开始时间、结束时间、描述地点——名称、描述

从层次上看，它看起来像这样：`Venue > Set > Artist`. 一个场地将有多个集合，并且这些集合将有一个或多个艺术家。

我最初想在 Drupal 中执行此操作，它具有诸如[EntityReference](http://www.drupal.org/project/entityreference)之类的模块，可让您引用任意节点。到目前为止，Zoo 和 K2 似乎是 Joomla! 的两个主要内容构建工具包，但是在玩了一段时间之后，似乎两者都没有可以引用其他内容的字段。我错过了什么吗？

我最终会想创建一个布景/艺术家的每日日历，所以我会如何做这件事的想法也会受到赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T09:28:19.703

也许您想念 SEBLOD CCK，就像知道它的 Elin 一样……您可以通过相关文章字段类型链接不同的内容类型，并使用搜索类型连接查询。我们还有一些其他的关系类型。直接联系我们了解更多。我记得 Fabrik 和 Mighty Ressource 有一些想法，但不是为了搜索。K2 和 Zoo 不是最受欢迎的 CCK，只有 K2 才如此。但是 K2 并不是真正的 CCK，更多的是高级内容管理器，它不够灵活，你无法构建真正的应用程序。最好的祝福

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T12:34:34.897

在 FlexiContent`[External link](http://www.flexicontent.org/)`中，您拥有通用模块，您可以在其中按相关、标签、类别等几乎所有内容进行范围（过滤）。适用于 2.5。安装最新的 svn 版本并转到模块，看看这个组件有多强大。在这里您可以看到使用了多少自定义字段`[this site](http://j.mp/RghpCh)`：分页、图片库、相关、查看次数最多。因为它是如此强大，所以第一次可能很难处理。很棒的论坛支持。

**编辑 25-09-2013：** 在我回答后将近 8 个月，该项目已经发展了很多。现在您拥有高级搜索、按字段权限和翻译，现在您拥有一个过滤器模块，您可以在其中选择您想要在项目中搜索的方式。

许多设计调整了前端和后端。现在 2.1 版本即将发布，带来好消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-09T11:36:20.333

Zoo有很多字段类型，其中两个是“相关项目”和“相关类别”。两者都可以关联您的 zoo 应用程序的其他内容。

[http://yootheme.com/zoo/documentation/elements/related-items](http://yootheme.com/zoo/documentation/elements/related-items)

如果这对您来说还不够，Zoolanders 有一个名为“Related Items Pro”（和“Related Category Pro”）的元素。他们可以将您的动物园应用程序的内容与同一网站中的其他应用程序相关联。

[https://www.zoolanders.com/extensions/related-items-pro](https://www.zoolanders.com/extensions/related-items-pro)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-23T21:11:36.867

仅供参考-还有[MintJoomla](http://www.mintjoomla.com)制造的 Cobalt CCK 。**Cobalt v7**分支仅适用于 Joomla 2.5。现在**完全免费**。这包括所有以前的商业附加组件！您会发现内容关系的独特功能，即父/子字段、ReadAlso 字段、类型作为评论等。

[C7 包下载在这里](http://www.mintjoomla.com/download/joomla-25.html)。

注意：Cobalt v8 仅适用于 J!3.x。（主要是免费的，外加一些特殊的商业插件）

# python - Django：使用 limit_choices_to 限制管理菜单中的选择

> ID：14014341
> 
> 赞同：1
> 
> 时间：2012-12-23T20:10:38.267
> 
> 标签：python, django, model

我在 Django 中有一个模型：

```
class Task(models.Model):  
    product = models.ForeignKey(Product)  
    content = models.OneToOneField(ContentDataSet) 
```

如果我只想在标准下拉选择列表中的用户/管理员中 显示尚未分配的选项并且已经分配给此任务选项，我该如何使用`limit_choices_to=`字段 选项？`content``ContentDataSet`

我尝试使用`limit_choices_to = {'task__isnull':True}`，但在这种情况下，我看不到已分配给此任务`content`选项。

`limit_choices_to = models.Q(task__isnull=True) | models.Q(task=self)`不工作，因为`self`没有定义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-11-03T03:39:01.203

这不能用limit_choices_to 来完成。但是您可以使用两种不同的方法，它们都可以正常工作：

1）因为`ForeignKeys`您可以使用`formfield_for_foreignkey`这样覆盖 ModelAdmin 中的查询集：

```
def formfield_for_foreignkey(self, db_field, request, **kwargs):
    if request.user.is_superuser:
        return super(UserOwnerProtectorModelAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs)

    if db_field.name == "task":
        # This next line only shows owned objects
        # but you can write your own query!
        kwargs["queryset"] = db_field.related_model.objects.filter(user=request.user)
    return super().formfield_for_foreignkey(db_field, request, **kwargs) 
```

2）作为第二选择，这里是一个覆盖字段查询集的示例，它可以帮助您处理 OneToOne 字段： [Django ForeignKey limit_choices_to a different ForeignKey id](https://stackoverflow.com/questions/31578559/django-foreignkey-limit-choices-to-a-different-foreignkey-id)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:35:16.933

Limit_choices_to 是一个 Q 对象。在文档中，您有一个对 ForeignKey 进行类似限制的示例：[https ://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.limit_choices_to](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.limit_choices_to)

更多关于查询的信息在这里：[https ://docs.djangoproject.com/en/dev/topics/db/queries/](https://docs.djangoproject.com/en/dev/topics/db/queries/)

# c++ - 在 vs2010 中使用 iostream 时，出现错误 C2039: 'exit' : is not a member of '`global namespace''

> ID：14014348
> 
> 赞同：2
> 
> 时间：2012-12-23T20:11:11.263
> 
> 标签：c++, visual-studio-2010, iostream

这个问题已经困扰我好几个星期了。我正在使用 MS vs2010。

```
#include <iostream>
int main()
{
    std::cout << "Enter two numbers:" << std::endl;
    int v1 = 0, v2 = 0;
    std::cin >> v1 >> v2;
    std::cout << "The sum of " << v1 << " and " << v2
    << " is " << v1 + v2 << std::endl;
    return 0;
} 
```

来自 C++ Primer 的一个简单程序。当我编译它时，我得到以下错误信息：

> 1>e:\program files\microsoft visual studio 10.0\vc\include\cstdlib(24): error C2039: 'exit' : is not a member of '`global namespace''
> 
> 1>e:\program files\microsoft visual studio 10.0\vc\include\cstdlib(24): error C2873: 'exit' : symbol cannot be used in a using-declaration

我试图找到一些解决方案，我得到了这个：

[http://social.msdn.microsoft.com/Forums/nl-NL/Vsexpressvc/thread/31385f37-94b8-4297-b054-7fdbc5b1f51e](http://social.msdn.microsoft.com/Forums/nl-NL/Vsexpressvc/thread/31385f37-94b8-4297-b054-7fdbc5b1f51e)

其中说：

> 找到的解决方案：
> 
> I have researched this issue on the web and it seems like it is something that has been an issue for a lot of people. The solution to this is as simple as removing a comment.
> 
> I looked through the stdlib.h file, and found the the following line was commended out:

```
_CRTIMP __declspec(noreturn) void __cdecl exit(__in int _Code); 
```

> I took out the comment and recompiled it, and now it works.
> 
> I believe in some builds the stdlib.h file will automatically be compiled with that portion of the code commented out. simple uncomment and your code will work.

Apparently some people fixed the problem with this solution. However, I could not even find `_CRTIMP __declspec(noreturn) void __cdecl exit(__in int _Code);` in my stdlib.h.

Anyone knows how to fix this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:05:04.137

> I looked through the stdlib.h file, and found the the following line was commended out:

It should **NOT** be commented out. That part of stdlib.h should look like this:

```
#ifndef _CRT_TERMINATE_DEFINED
#define _CRT_TERMINATE_DEFINED
_CRTIMP __declspec(noreturn) void __cdecl exit(_In_ int _Code);
_CRTIMP __declspec(noreturn) void __cdecl _exit(_In_ int _Code);
_CRTIMP __declspec(noreturn) void __cdecl abort(void);
#endif 
```

It isn't clear how it got to be commented in your version of the file. But it is clear that you don't hesitate to edit compiler header files to get out of a problem. You may have done this before to bypass a problem and not remember it.

In general, this is a Really Really Bad Idea. Microsoft releases service packs and security updates that will update compiler header files. But it will not do so if the file was altered. Which may leave you with a nasty mixed bag of files that are no longer compatible with each other.

You will need to fix the damage done to these files. Pay attention to the modified timestamp of these files to find out which might have been changed. And copy those from a known-good machine of, say, a friend or colleague. Another possible approach (never tried it myself) is to move the altered files somewhere else and run setup again, asking for a repair. Not actually sure if that works, it should. Also re-apply service packs when you do it that way.

# c# - 查询字符串唯一的字符串生成器？

> ID：14014351
> 
> 赞同：7
> 
> 时间：2012-12-23T20:11:26.127
> 
> 标签：c#, asp.net, security, url, query-string

[一旦我问](https://stackoverflow.com/questions/12544006/generating-unique-ids-check-or-not)过：*显然*随机查询字符串/url是如何生成的。

它可以在很多地方找到：

```
http://www.youtube.com/watch?v=IMl7pvaWzh8
                                   ^
                                   |
                                   +---------------- 

http://jsfiddle.net/xeolabs/LSTKM/light/
                              ^
                              |
                              +---------------- 

http://jsbin.com/asapay/1/edit
                   ^
                   |
                   +---------------- 
```

有人告诉我（这似乎是逻辑），当服务器选择一个新的 url 时，它不会检查它是否是免费的（之前没有选择过）

另外，有人告诉我它可能是以下公式的结果：（ `f(n+1) = f(n)+1`所以它根本不是随机的。

所以新的 url 参数是最后生成的 url 参数的结果。

**我的问题 ：**

我在哪里可以找到这样的生成器功能？

*当然，我可以*构建自己的 17=16+1，但我正在寻找类似的东西：

`f(n+1) = f(n)+1`其中有大写，小写，数字的用法。
当然还有*最小*碰撞和零*预测*。

*你知道的，一些专业的东西......*

*我只是好奇 google/youtube/jsbin/jsfiddle 是如何处理每天数百万个请求的。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:35:54.730

大声思考，但您可以预先计算一个巨大的唯一哈希列表并将它们分配给任何新输入。预先计算将确保您可以继续检查碰撞，因为它不需要实时。您可以查看在[这个问题](https://stackoverflow.com/questions/742013/how-to-code-a-url-shortener)中生成随机散列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:38:20.053

继续我的评论，
假设您有几个位置正在接受输入并生成唯一令牌，我说您可以划分范围。例如，假设您在以色列有一个站点，在美国有一个站点，并且您希望两者都生成唯一的令牌（您不希望在这些站点生成的令牌之间有任何重叠），您可以使用唯一的数据库来存储当前代币价值。

(1) 这是情景。db 以值为 1 的令牌开头。
（2）以色列站点要求 db 获取一些新令牌，db 将给它从 1-1000 的范围（不是令牌，而是范围）。这样，以色列站点不必为它收到的每个新请求返回数据库，直到它用完所有这 1000 个令牌。
（3）美国站点进入数据库并获得 1001-2000 范围的令牌。
(4) 在我们的示例中，您有 2 个消费者和 1 个生产者（数据库）。假设是您希望尽可能少地使用您的数据库，以免阻止其他消费者。因此，如果每个生产者需要 1 秒去 db，那么 db 应该给每个消费者多少个 ID。答案是消费者使用的 ID 数量/1 秒 * 消费者数量。这样，消费者就不会陷入僵局，彼此等待数据库空闲。

那么这些生产商是如何利用这个范围的呢？他们可以通过增加一个计数器来为他们从 db 接收到的范围生成 base 72 令牌。为什么基数为 72？因为这为大量数字提供了一个简短的标记。为了得出 72，我在 0-9 键上使用了 az、AZ、0-9，特殊字符：25+25+10+10。你可以超过72。

会话令牌的实现位于：
[https ://github.com/hoytech/Session-Token](https://github.com/hoytech/Session-Token)

还有这个问题可能会有所帮助：
[如何生成随机字母数字字符串？](https://stackoverflow.com/questions/41107/how-to-generate-a-random-alpha-numeric-string-in-java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:34:23.203

这不能完全回答您的具体问题，但如果您需要一个返回唯一且不可预测的字符串的函数，那么有一个：

```
Guid.NewGuid().ToString() 
```

我经常使用它在各种场景中形成唯一的查询字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:32:55.587

一种解决方案（我自己使用过）可能是这样的：

要求：增加序列号的唯一源（如 Oracle 中的序列或 SQL Server 中的自动增量索引等） - 您可以可靠地处理以生成此类增量源的任何内容。

生成每个新 URL（或任何您需要的 URL）的工作流程： 1 - 获取序列的下一个值。2 - 将其转换为[基数 36](http://en.wikipedia.org/wiki/Base_36)数字（您可以通过谷歌搜索它在 C# 中的实现，例如[这个](http://www.codeproject.com/Articles/10619/Base-36-type-for-NET-C)）。3 - 在你的 URL 中使用生成的 base 36 数字（或者你正在做的任何事情，比如修改数据库等）。

关于 36 进制数的注意事项：我们在日常操作中使用十进制系统，由 10 位数字组成。我们在计算机中使用由 16 位数字（0-9 加上 A、B、C、D、E 和 F）产生的十六进制数字。现在也有一个base 36系统，是用36位生成的；0-9 和 AZ 以及所有数字都是字母数字。因此可以在 URL 中轻松使用。来自 Wikipedia 页面的示例：2,821,109,907,456 十进制将是基数 36 的 CRE66I9S。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T20:46:16.043

`System.IO`有一个随机文件名生成器，也许你可以劫持它。

```
string randomString = System.IO.Path.GetFileNameWithoutExtension(System.IO.Path.GetRandomFileName()); 
```

返回类似“jdvpmpre”的东西

您可以将几个组合在一起以使其更加独特，但这将是一个快速简单的解决方案。

# android - maps api2 animateCamera 速度问题

> ID：14014355
> 
> 赞同：11
> 
> 时间：2012-12-23T20:11:46.367
> 
> 标签：android, google-maps-api-2

我正在尝试学习 android，并使用新的 googlemaps v2 api 玩应用程序。

我有几个菜单项，一个缩放到当前位置，一个最终会缩放到另一个位置。第一个（下面代码中的 show_horizo​​n）使地图能够旋转，第二个将地图设置为静态，屏幕顶部为北。

我已将它们都设置为 6 秒长的延迟，但 show_horizo​​n() 似乎忽略了速度设置，而 show_iss() 尊重它。

此外，一旦在旋转模式下，如果我滚动地图，触发器 show_horizo​​n() 它现在将尊重速度设置。

因此，当我从非旋转切换到旋转时，它似乎只会忽略代码，但当我走另一条路时，它会尊重它。我曾尝试在切换时停止监听器，以防它中断相机动画，但它没有任何区别吗？

欢迎任何线索或想法。

谢谢

这是代码。

我有一个传感器监听器像这样获取手机的方位：

```
private SensorEventListener get_bearing = new SensorEventListener() {
    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }
    @Override
    public void onSensorChanged(SensorEvent event) {
      float azimuth = event.values[0];
      set_bearing(azimuth);
    }
  }; 

private void set_bearing(float azimuth) {
    if (!rotate_view) {
        bearing = 0;
    } else {
        if (bearing != Math.round(azimuth)) {
            bearing = Math.round(azimuth);
            update_map();
        }
    }
} 
```

以及将地图更改为旋转或不旋转的几种方法：

```
private void show_horizon() {
    current_pos = new LatLng(gps.getLatitude(), gps.getLongitude());
    rotate_view = true;
    tilt = 30;
    zoom_level = 14;
    stop_listener();
    update_map(6000);
    start_listener();
}

private void show_iss() {
    rotate_view = false;
    bearing = 0;
    tilt = 0;
update_map(6000);       
} 
```

和我更新相机位置的代码：

```
private void update_map() {update_map(100);}   
private void update_map(int speed) {
    if (current_pos != null) {
        CameraPosition cameraPosition = new CameraPosition.Builder()
        .target(current_pos)      
        .zoom(zoom_level)               
        .bearing(bearing)                
        .tilt(tilt)                   
        .build();               
        gmap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition), speed, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-13T04:07:51.803

经过多次试验和错误，这对我有用：

```
 public void openMarker(Marker marker) {

    marker.showInfoWindow();
    CameraUpdate center = CameraUpdateFactory.newLatLng(marker.getPosition());
    mMap.animateCamera(center, 400, null);
} 
```

当然，mMap 是我的 Google 地图对象。

```
mMap = ((SupportMapFragment)(getFragmentManager().findFragmentById(R.id.googleMap))).ge‌​tMap(); 
```

# java - 在 Eclipse AVD 中，我收到“不幸的是，计算器已停止”。API 级别 16

> ID：14014356
> 
> 赞同：0
> 
> 时间：2012-12-23T20:11:46.547
> 
> 标签：java, android, eclipse, avd

我的测试应用程序称为计算器，但我收到“不幸的是，计算器已停止”。AVD 中的错误。我正在使用 API 级别 16 运行我的 Android 虚拟设备。这是我的代码：（就 Eclipse 而言，没有语法错误）

```
MainActivity.java :

    package com.papps.calculator;

    import android.os.Bundle;
    import android.app.Activity;
    import android.view.Menu;
    import android.widget.TextView;
    import android.widget.Button;

    public class MainActivity extends Activity {
    int num1 = 90;
    int num2 = 90;
    int op = 0;
    int ans = 0;

    TextView answer = (TextView) findViewById(R.id.answer);

    Button ButtonEquals = (Button) findViewById(R.id.ButtonEquals);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    //ONE
    public void none() {
        if(num1 == 90) {
            num1 = 1;
        }
        else if(num2 == 90) {
            num2 = 1;
         }
    }
    //TWO
    public void ntwo() {
        if(num1 == 90) {
            num1 = 2;
        }
        else if(num2 == 90) {
            num2 = 2;
         }
    }
    //THREE
    public void nthree() {
        if(num1 == 90) {
            num1 = 3;
        }
        else if(num2 == 90) {
            num2 = 3;
         }
    }
    //FOUR
    public void nfour() {
        if(num1 == 90) {
            num1 = 4;
        }
        else if(num2 == 90) {
            num2 = 4;
         }
    }
    //FIVE
    public void nfive() {
        if(num1 == 90) {
            num1 = 5;
        }
        else if(num2 == 90) {
            num2 = 5;
         }
    }
    //SIX
    public void nsix() {
        if(num1 == 90) {
            num1 = 6;
        }
        else if(num2 == 90) {
            num2 = 6;
         }
    }
    //SEVEN
    public void nseven() {
        if(num1 == 90) {
            num1 = 7;
        }
        else if(num2 == 90) {
            num2 = 7;
         }
    }
    //EIGHT
    public void neight() {
        if(num1 == 90) {
            num1 = 8;
        }
        else if(num2 == 90) {
            num2 = 8;
         }
    }
    //NINE
    public void nnine() {
        if(num1 == 90) {
            num1 = 9;
        }
        else if(num2 == 90) {
            num2 = 9;
         }
    }
    //ZERO
    public void nzero() {
        if(num1 == 90) {
            num1 = 0;
        }
        else if(num2 == 90) {
            num2 = 0;
         }
    }
    //operators

    //MULTIPLY
    public void multiply() {
        op = 1;
    }
    //Divide
    public void divide() {
        op = 2;
    }
    //Add
    public void add() {
        op = 3;
    }
    //Subtract
    public void subtract() {
        op = 4;
    }

    //EQUALS
    //TextView answer = (TextView) findViewById(R.id.answer);
    //Button ButtonEquals = (Button) findViewById(R.id.ButtonEquals);
    public void equals() {
        if(op == 1){
            answer.setText(num1 * num2);
        }
        else if(op == 2) {
            answer.setText(num1 / num2);
        }
        else if(op == 3) {
            answer.setText(num1 + num2);
        }
        else if(op == 4) {
            answer.setText(num1 - num2);
        }
    }
    }

activity_main.xml :

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="97dp"
        android:layout_marginTop="16dp"
        android:text="@string/app_name"
        tools:context=".MainActivity" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1"
        android:layout_marginLeft="14dp"
        android:layout_marginTop="15dp"
        android:text="1"
        android:onClick = "none" />

    <Button
        android:id="@+id/Button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/button1"
        android:layout_alignBottom="@+id/button1"
        android:layout_alignLeft="@+id/textView1"
        android:layout_marginLeft="15dp"
        android:text="2"
        android:onClick = "ntwo" />

    <Button
        android:id="@+id/Button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/Button2"
        android:layout_alignBottom="@+id/Button2"
        android:layout_marginLeft="34dp"
        android:layout_toRightOf="@+id/Button2"
        android:text="3"
        android:onClick = "nthree" />

    <Button
        android:id="@+id/Button4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button1"
        android:layout_below="@+id/button1"
        android:layout_marginTop="36dp"
        android:text="4"
        android:onClick = "nfour" />

    <Button
        android:id="@+id/Button5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/Button4"
        android:layout_alignBottom="@+id/Button4"
        android:layout_alignLeft="@+id/Button2"
        android:text="5"
        android:onClick = "nfive" />

    <Button
        android:id="@+id/Button6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/Button5"
        android:layout_alignBottom="@+id/Button5"
        android:layout_alignLeft="@+id/Button3"
        android:text="6" 
        android:onClick = "nsix" />

    <Button
        android:id="@+id/Button7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/Button4"
        android:layout_centerVertical="true"
        android:text="7" 
        android:onClick = "nseven" />

    <Button
        android:id="@+id/Button8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@+id/Button3"
        android:text="8" 
        android:onClick = "neight" />

    <Button
        android:id="@+id/Button9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/Button6"
        android:layout_centerVertical="true"
        android:text="9"
        android:onClick = "nnine" />

    <Button
        android:id="@+id/Button0"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/Button8"
        android:layout_below="@+id/Button8"
        android:layout_marginTop="29dp"
        android:text="0"
        android:onClick = "nzero" />

    <Button
        android:id="@+id/ButtonM"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:text="X"
        android:onClick = "multiply" />

    <Button
        android:id="@+id/ButtonD"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_toRightOf="@+id/Button7"
        android:text="/"
        android:onClick = "divide" />

    <Button
        android:id="@+id/ButtonS"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_toRightOf="@+id/textView1"
        android:text="-"
        android:onClick = "subtract" />

    <Button
        android:id="@+id/ButtonA"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_marginLeft="14dp"
        android:layout_toRightOf="@+id/ButtonS"
        android:text="+"
        android:onClick = "add" />

    <TextView
        android:id="@+id/answer"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/ButtonD"
        android:layout_marginBottom="24dp"
        android:layout_toRightOf="@+id/ButtonD"
        android:text="Answer"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <Button
        android:id="@+id/ButtonEquals"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/answer"
        android:layout_alignBottom="@+id/answer"
        android:layout_toLeftOf="@+id/Button0"
        android:text="="
        android:onClick = "equals" />

</RelativeLayout> 
```

任何帮助表示赞赏！我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:16:02.170

您的问题很可能出在全局 View 变量上。调整

```
TextView answer = (TextView) findViewById(R.id.answer);

    Button ButtonEquals = (Button) findViewById(R.id.ButtonEquals); 
```

所以它只是

```
TextView answer;
Button ButtonEquals; 
```

然后在 中`onCreate()`，执行以下操作：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    answer = (TextView) findViewById(R.id.answer);
    ButtonEquals = (Button) findViewById(R.id.ButtonEquals);
    } 
```

您的应用程序可能会崩溃，因为您试图在 Activity 显示任何内容之前访问视图。将代码放在 setContentView 之后可以找到视图并`NullPointerException`避免

**还：**

`methodName (View view)`如果它们是从`onClick:`属性引用的，则您的方法必须是

您的大多数方法都需要更改，但我将`ButtonEquals`以此为例。你的 xml 说

```
android:onClick = "equals" 
```

所以你的代码中的方法需要是

```
public void equals (View v) 
```

`View`需要为属性使用的**每个**方法添加参数。`onClick:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:16:56.280

[1/ 您可以通过阅读logcat](http://developer.android.com/tools/help/logcat.html)确切地看到问题所在。可以从 Eclipse 中从 Java 角度或使用命令行查看：

```
adb logcat 
```

*2/ 在setContentView()*调用之后将 *TextView*s 的实例化移动到*onCreate()*方法。

# c# - 在一个按钮单击完成后运行一个线程

> ID：14014360
> 
> 赞同：4
> 
> 时间：2012-12-23T20:13:01.957
> 
> 标签：c#, winforms, multithreading, textbox, buttonclick

我想在一个按钮单击中组合 2 个不同的按钮单击事件。我在这两个按钮单击事件中有两个线程来更新 winform 中的文本框。当我尝试组合这两个按钮时，线程同步运行，但我需要在 thread1 完成后运行 thread2。我怎样才能做到这一点？我尝试做 thread1.start 而不是 thread2.start 但它不起作用，因为所有点击事件都会立即执行。有没有人可以帮助我？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:28:14.573

你可以这样做

```
new Thread(() =>
    {
        Method1();
        Method2();
    }).Start(); 
```

或更好地使用 TPL

```
Task.Factory.StartNew(() => Method1())   
            .ContinueWith(t => Method2()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T20:18:34.773

**.Net 4：** 如果您使用的是 .net 4 或更高版本，请查看 Tasks，尤其是[ContinueWith 方法](http://msdn.microsoft.com/en-us/library/dd270696%28v=vs.100%29.aspx)。这是一种更统一的方法，效果更好。

**.Net 1-3.5：** 如果您已经在自己管理线程，最好的方法可能是只有一个线程。

```
new Thread(DoJob1And2).Start() 
```

其中方法定义为：

```
void DoJob1And2()
{
   try
   {
       Job1();
   }
   finally
   {
       Job2();
   }
}

void Job1()
{
   // Do job 1
}

void Job2()
{
   // Do job 2
} 
```

# mysql - 在单个查询中为每个 DISTINCT 选择几条记录

> ID：14014362
> 
> 赞同：5
> 
> 时间：2012-12-23T20:13:27.333
> 
> 标签：mysql, join, distinct

我需要为每个不同的记录选择几行。尽管我使用的是 MySQL，但几乎就像在这里问的那样[Select first n records for each distinct ID in SQL Server 2008 。](https://stackoverflow.com/questions/3364224/select-first-n-records-for-each-distinct-id-in-sql-server-2008)

在这种情况下，可以通过运行 21 个查询来达到目的：1 个一般查询和 20 个获取子记录，即类似这样的内容：

```
SELECT DISTINCT `user_id`
FROM `posts`
WHERE `deleted` = '0'
ORDER BY `user_id` ASC
LIMIT 20 
```

...选择所有需要的行，然后

```
SELECT *
FROM `posts`
WHERE `deleted` = '0'
AND `user_id` = ?
ORDER BY `id` DESC
LIMIT 5 
```

...在第一个查询选择的每一行的循环中。

基本上，我需要获得每个用户的 5 个帖子。我需要在单个查询中完成此操作。`posts`设置只是例如，我做了这个，希望它更容易理解我需要什么。

我从以下查询开始：

```
SELECT * 
FROM `posts` 
WHERE `user_id` 
IN (
    SELECT DISTINCT `user_id` 
    FROM `posts` 
    ORDER BY `user_id` DESC 
    LIMIT 4
) 
LIMIT 5 
```

但我得到了`#1235 - This version of MySQL doesn't yet support 'LIMIT & IN/ALL/ANY/SOME subquery'`错误。

所以我尝试了[这里](https://stackoverflow.com/a/2856430/722036)`JOIN`建议的想法：

```
SELECT  posts.id,
        posts.user_id,
        NULL
FROM    (
        SELECT  posts.user_id
        FROM    posts
        WHERE   posts.deleted = 0
        LIMIT 20
        ) q
JOIN    posts
ON      posts.user_id = q.user_id 
```

我还按照[这里](https://stackoverflow.com/a/7124492/722036)的建议尝试了几个嵌套查询：

```
SELECT *
FROM posts 
WHERE user_id IN (
      SELECT * FROM (
            SELECT user_id 
            FROM posts 
            LIMIT 20
      ) 
      as t); 
```

以及在 Internet 上找到的其他解决方案。但是它们要么不起作用，要么只是从数据库中选择前 N 行（不管条件如何，并且出于某种原因连接）。试过，，，`LEFT JOIN`甚至`RIGHT JOIN`，`INNER JOIN`但仍然没有成功。

请帮忙。

**更新**忘了提到该表的大小约为 5GB。

**更新** 尝试了子子查询：

```
SELECT * 
FROM `posts` 
WHERE
  `user_id` IN ( SELECT `user_id` FROM (
     SELECT DISTINCT `user_id` 
     FROM `posts` 
    ORDER BY `user_id` DESC 
    LIMIT 4 ) limit_users
  ) 
LIMIT 5 
```

与上面相同，它返回以下内容：

```
+----+---------+------+
| id | user_id | post |
+----+---------+------+
|  1 |       1 |    a |
+----+---------+------+
|  2 |       1 |    b |
+----+---------+------+
|  3 |       1 |    c |
+----+---------+------+
| .. |      .. |   .. | 
```

即同一用户的 5 行（外部`LIMIT`设置为）。奇怪的是，如果我单独运行 sub 和 sub-sub 查询：

```
 SELECT `user_id` FROM (
     SELECT DISTINCT `user_id` 
     FROM `posts` 
    ORDER BY `user_id` DESC 
    LIMIT 4 ) limit_users 
```

我得到了 4 个不同的值：

```
+---------+
| user_id |
+---------+
|       1 |
+---------+
|       2 |
+---------+
|       3 |
+---------+
|       4 |
+---------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:48:19.493

您必须使用变量，对有序查询进行两种不同的计数：一种是针对每个用户的帖子数量，另一种是针对用户：

```
SELECT posts_counts.*
FROM (
  SELECT
    posts.*,
    @post_count:=case when @prec_user_id=user_id then @post_count+1 else 1 end as pc,
    case when @prec_user_id<>user_id then @user_count:=@user_count+1 else @user_count end as uc,
    @prec_user_id:=user_id
  FROM
    posts,
    (select @prec_user_id:=0, @user_count:=0, @post_count:=0) counts
  ORDER BY
    posts.user_id ) posts_counts
WHERE pc<5 and uc<4 
```

**编辑：**您也可以考虑尝试此查询：

```
SELECT * 
FROM `posts` 
WHERE
  `user_id` IN ( SELECT user_id FROM (
     SELECT DISTINCT `user_id` 
     FROM `posts` 
    ORDER BY `user_id` DESC 
    LIMIT 4 ) limit_users
  ) 
LIMIT 5 
```

（这只会从每个选定用户的所有帖子中选择 5 个帖子，所以它仍然不是您需要的，但它使用了一个技巧来在子查询中使用 LIMIT）

**EDIT2：**下一个查询将为 20 个用户中的每个用户限制 5 个帖子：

```
select posts_limited.*
from (
  select
    posts.*,
    @row:=if(@last_user=posts.user_id, @row+1, 1) as row,
   @last_user:=posts.user_id
  from
    posts inner join
    (select user_id from
      (select distinct user_id
       from posts
       order by user_id desc
       LIMIT 20) limit_users
    ) limit_users
    on posts.user_id = limit_users.user_id,
    (select @last_user:=0, @row:=0) r
  ) posts_limited
  where row<=5 
```

# ruby-on-rails - 很抱歉，capistrano deploy 出了点问题

> ID：14014369
> 
> 赞同：1
> 
> 时间：2012-12-23T20:14:42.810
> 
> 标签：ruby-on-rails, deployment, capistrano, unicorn

我正在使用 nginx + unicorn + capistrano 在服务器上部署我的应用程序。我的数据库是 sqlite，因为我只有一张小桌子。我的 deploy.rb 配置在这里[deploy.rb](http://pastebin.com/SX3Q8eHM)

当我进行**cap deploy:setup**然后**cap deploy:cold**应用程序工作正常。当我进行一些更改然后提交并运行 cap deploy 我有

```
**We're sorry, but something went wrong.** 
```

在 production.rb 我有以下错误

```
Processing by DomainsController#index as */*
Completed 500 Internal Server Error in 1ms

ActiveRecord::StatementInvalid (Could not find table 'domains'):
app/controllers/domains_controller.rb:8:in `index' 
```

我不明白为什么我看到这个错误？如何检查我错在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:19:55.500

每次部署都会在您的服务器上创建名为 current 的新目录，并且由于您的数据库不在源代码控制版本系统中（并且不应该），因此每次部署后都会丢失。您需要将 sqlite 数据库放入共享文件夹并在部署中对其进行符号链接。

# java - 在 Spring Container 启动时注册 Jersey REST 服务

> ID：14014370
> 
> 赞同：1
> 
> 时间：2012-12-23T20:14:53.867
> 
> 标签：java, spring, jersey

我需要在运行时将对象注册为 Jersey 服务。我已经通过 Spring applicationContext 尝试过，但它被注册为普通 bean。像这样的东西...

jerseyContainer.register(new Service());

```
@Path("/service")
public class Service{
    @GET
    public Thing get(){ 
        return new Thing();
    }
} 
```

或者在 Spring 容器完成启动之前的某个方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T05:17:19.360

spring-jersey 集成依赖于 servlet

> com.sun.jersey.spi.spring.container.servlet.SpringServlet

在您的 web.xml 中定义

请参考本[教程](http://www.mkyong.com/webservices/jax-rs/jersey-spring-integration-example/)：特别是第 4 点“将 Jersey 与 Spring 集成”
，您将看到如何定义要扫描的包以查找 Jersey 公开的资源类

# javascript - 如何将字符串转换为 Javascript 中的可执行代码行？

> ID：14014371
> 
> 赞同：28
> 
> 时间：2012-12-23T20:15:21.320
> 
> 标签：javascript

我有以下代码

```
console.log("I am");

var x = "console.log('Alive!')"; 
```

现在我只想用来`x`执行分配给它的代码字符串——例如，我什至可能不知道 x 的值，但只是想执行它可能的任何事情——这可能吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-01-20T20:25:59.437

[eval()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval)这会将字符串转换为 javascript 代码。

```
eval("console.log('Alive! Woo!')"); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2018-06-26T16:34:05.493

`eval`并`new Function`让您从字符串中解析和执行 JavaScript 代码。

一般来说，避免从字符串执行代码。并且**永远不要**从字符串是不受信任的输入的字符串中执行代码（例如，如果您从用户 A 获取输入，则永远不要在与用户 B 的会话中使用这些来评估它）。

我在这里看到指向您的答案`eval`。`eval`授予对您的局部变量等代码的访问权限，如果您将其与不受信任的输入一起使用，它会变得*非常*强大且*非常*危险。

在可能的情况下，避免`eval`。在您的情况下，您可以轻松避免它：

例如：

```
console.log("I am");
var x = "console.log('Alive!')";
new Function(x)();
```

该代码创建一个函数，其主体是来自 的文本`x`，然后立即执行该函数。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-12-23T20:17:37.733

您正在寻找的是`eval()`. 通过将字符串传递给此函数，您将把字符串评估为 JavaScript 代码，它将返回字符串中的代码返回的任何返回值。

不过在使用这个功能时要注意。您不想评估任何您不知道可以安全执行的代码。例如，运行用户生成的代码可能会弄乱您正在制作的任何东西。虽然在网站上的 JavaScript 中使用它可能只会导致客户端出现问题，因此可能不会造成太大的安全威胁，但在评估例如服务器端的代码时，您需要非常小心。

正如此处其他帖子中所暗示的那样，如果您控制要运行的源代码，您可能想要创建一个函数而不是评估字符串。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-23T20:16:00.913

您要查找的内容称为*函数*：

```
function x() {
    console.log('Alive!');
} 
```

If`x`已经是一个包含您可以用来执行它的代码的*字符串。*虽然是邪恶的。`eval(x)``eval`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-23T20:18:06.457

```
var x = "console.log('Alive!')";
eval(x) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-28T15:58:54.590

让函数 mathchallenge (num) 将从 1 到 num 的所有数字相加，例如，如果输入为 4，那么您的程序应该返回 10，因为 1+2+3+4=10。对于测试用例，参数 num 将是 1 到 1000 之间的任何数字

# javascript - 在 DOM 与 javascript 变量中缓存对象

> ID：14014373
> 
> 赞同：1
> 
> 时间：2012-12-23T20:15:28.850
> 
> 标签：javascript, json, caching, dom

我最近看了一些前端 js 代码。

(1) 在某些情况下，代码会根据从后端接收到的 JSON 创建一个新的 JavaScript 对象。然后新创建的对象存储在缓存中（比如地图）。这样，对象将被缓存在前端以供以后使用。

(2) 我还看到了新的 JavaScript 对象（`eventObject`此处称为）存储在 DOM 中的实例，如下所示：`$(this).data('eventObject', eventObject);`

以哪种方式存储数据重要吗？我会亲自缓存`eventObject`在 JavaScript 缓存对象中（即制作自己的缓存类或地图）。像这样缓存不是比弄乱 DOM 更简单，然后你必须记住你把什么放在哪里？

在我的搜索中，我查看了[XML DOM 与 Javascript 中的对象](https://stackoverflow.com/questions/5019781/xml-dom-vs-object-in-javascript)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:47:01.810

> 像这样缓存不是比弄乱 DOM 更简单，然后你必须记住你把什么放在哪里？

[jQuery 的`data`方法](http://api.jquery.com/data/)实际上并没有搞乱 DOM，它只是一种通过 DOM 节点引用数据对象的便捷方式。

当然，如果您“*必须记住放置位置*”，则 DOM 引用并不是引用对象的最佳方式。如果一个简单的缓存对象对您来说看起来更干净，它可能会更干净。

# c# - 无法转换类型为“System.IO.BufferedStream”的对象

> ID：14014376
> 
> 赞同：2
> 
> 时间：2012-12-23T20:15:58.053
> 
> 标签：c#, windows-8

我在使用 Windows 8 应用程序并从打开的文件中获取蒸汽时遇到问题。还有其他方法可以在 Windows 8 中读取/写入文件，但为了能够提取标准流，我试图看看是否可以。到目前为止还不好。问题是 System.IO.BufferedStream 不是 Windows 8 应用程序中 System.IO 的一部分。因此下面的代码：

```
 (MemoryStream)(await (await installedLocation.GetFileAsync("SOMEFILE")).OpenStreamForWriteAsync()); 
```

我为精简的代码道歉。上面的代码抛出了提到的异常。问题再次是我无法创建缓冲流。我想知道是否有办法解决这个问题。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:20:13.020

好吧，是的 - 你正在投射到，`MemoryStream`它*不是*`MemoryStream`. `System.IO.BufferedStream`似乎*存在*- 它只是不*公开*；这是一个您不必担心的实现细节。你不能把它转换成一个`MemoryStream`，因为它不是一个。

目前还不清楚你为什么要投到`MemoryStream`，但你应该可以`Stream`改用。如果您*需要*`MemoryStream`，您必须自己创建一个并将数据复制到其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:19:44.333

根据文档，您应该可以只使用返回的`Stream`.

[http://msdn.microsoft.com/en-us/library/hh582147.aspx](http://msdn.microsoft.com/en-us/library/hh582147.aspx)

有理由将它转换为 a`MemoryStream`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:28:25.550

这是我用于在 Windows 8 中读取/写入文件的代码。它有效，我希望它也能帮助你。

```
 // Read from a file line by line
    public async Task ReadFile()
    {
        try
        {
            // get the file
            StorageFile myStorageFile = await localFolder.GetFileAsync("MyDocument.txt");
            var readThis = await FileIO.ReadLinesAsync(myStorageFile);
            foreach (var line in readThis)
            {
                String myStringLine = line;
            }
            Debug.WriteLine("File read successfully.");
        }
        catch(FileNotFoundException)
        {              
        }
    }
    // Write to a file line by line
    public async void SaveFile()
    {
        try
        {
            // set storage file
            StorageFile myStorageFile = await localFolder.CreateFileAsync("MyDocument.txt", CreationCollisionOption.ReplaceExisting);
            List<String> myDataLineList = new List<string>();
            await FileIO.WriteLinesAsync(myStorageFile, myDataLineList);
            Debug.WriteLine("File saved successfully.");
        }
        catch(FileNotFoundException)
        {              
        }
    } 
```

# antlr4 - 在解析器中重新定义令牌类型

> ID：14014386
> 
> 赞同：2
> 
> 时间：2012-12-23T20:16:48.353
> 
> 标签：antlr4

需要为 可能的表单设计语言 实现 COS aka [MUMPS的语法突出显示](http://en.wikipedia.org/wiki/MUMPS)

```
new (new,set,kill)
set kill=new 
```

其中：'new' 和 'set' 是命令，也是变量

```
grammar cos;

Command_KILL            :( ('k'|'K') | ( ('k'|'K')('i'|'I')('l'|'L')('l'|'L') ) ); 
Command_NEW             :( ('n'|'N') | ( ('n'|'N')('e'|'E')('w'|'W') ) ); 
Command_SET             :( ('s'|'S') | ( ('s'|'S')('e'|'E')('t'|'T') ) );

INT : [0-9]+;
ID : [a-zA-Z][a-zA-Z0-9]*;
Space: ' ';
Equal: '=';

newCommand
    :   Command_NEW Space ID
    ;
setCommand
    :   Command_SET Space ID Space*  Equal Space* INT
    ; 
```

我有一个问题，当 ID 像名称作为命令（NEW、SET 等）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T21:35:06.120

根据维基百科页面， MUMPS 没有保留字：

> 保留字：无。由于 MUMPS 通过上下文解释源代码，因此不需要保留字。您可以使用语言命令的名称作为变量。

Lexer 规则之类的`Command_KILL`功能与保留字完全一样：它们旨在确保在`"kill"`遇到输入时不会生成其他标记。所以令牌类型`Command_KILL`总是会在 上产生`"kill"`，即使它是一个标识符。如果需要，您可以保留命令词法分析器规则，但您也必须将它们视为 ID，因为您只是不知道仅`"kill"`基于令牌所指的是什么。

在 ANTLR 中实现 MUMPS 意味着关注令牌使用和上下文而不是令牌类型。考虑这个语法：

```
grammar Example;

document    : (expr (EOL|EOF))+;
expr        : command=ID Space+ value (Space* COMMA Space* value)*  #CallExpr
            | command=ID Space+ name=ID Space* Equal Space* value   #SetExpr
            ;     

value       : ID | INT;

INT         : [0-9]+;
ID          : [a-zA-Z][a-zA-Z0-9]*;
Space       : ' ';
Equal       : '=';
EOL         : [\r\n]+;
COMMA       : ','; 
```

解析器规则`expr`知道`ID`令牌何时是基于整行布局的命令。

*   如果输入标记是`ID ID`，那么输入是 a `CallExpr`：第一个`ID`是命令名称，第二个`ID`是常规标识符。
*   如果输入标记是`ID ID Equal ID`，那么输入是 a `SetExpr`：第一个`ID`是命令（`"set"`或者类似的东西），第二个`ID`是目标标识符，第三个`ID`是源标识符。

这是一个 Java 测试应用程序，后跟一个类似于您的问题中提到的测试用例。

```
import java.util.List;

import org.antlr.v4.runtime.ANTLRInputStream;
import org.antlr.v4.runtime.CommonTokenStream;

public class ExampleTest {

    public static void main(String[] args) {

        ANTLRInputStream input = new ANTLRInputStream(
                "new new, set, kill\nset kill = new");

        ExampleLexer lexer = new ExampleLexer(input);

        ExampleParser parser = new ExampleParser(new CommonTokenStream(lexer));

        parser.addParseListener(new ExampleBaseListener() {
            @Override
            public void exitCallExpr(ExampleParser.CallExprContext ctx) {
                System.out.println("Call:");
                System.out.printf("\tcommand = %s%n", ctx.command.getText());
                List<ExampleParser.ValueContext> values = ctx.value();
                if (values != null) {
                    for (int i = 0, count = values.size(); i < count; ++i) {
                        ExampleParser.ValueContext value = values.get(i);
                        System.out.printf("\targ[%d]  = %s%n", i,
                                value.getText());
                    }
                }
            }

            @Override
            public void exitSetExpr(ExampleParser.SetExprContext ctx) {
                System.out.println("Set:");
                System.out.printf("\tcommand = %s%n", ctx.command.getText());
                System.out.printf("\tname    = %s%n", ctx.name.getText());
                System.out.printf("\tvalue   = %s%n", ctx.value().getText());
            }

        });

        parser.document();
    }
} 
```

### 输入

```
new new, set, kill
set kill = new 
```

### 输出

```
Call:
    command = new
    arg[0]  = new
    arg[1]  = set
    arg[2]  = kill
Set:
    command = set
    name    = kill
    value   = new 
```

由调用代码决定命令在给定上下文中是否有效。由于 MUMPS 对命令和标识符的松散方法，解析器无法合理处理此问题。但这并不像听起来那么糟糕：您将知道哪些命令的功能类似于调用，哪些功能类似于集合，因此您将能够测试来自`Listener`ANTLR 生成的输入。例如，在上面的代码中，很容易测试“set”是否是传递给`exitSetExpr`.

一些 MUMPS 语法可能比这更难处理，但一般方法是相同的：让词法分析器像`ID`s 一样处理命令和标识符，并使用解析器规则来确定 an`ID`是指命令还是基于整行的上下文。

# c# - DataContractSerializer 失败，空数据

> ID：14014397
> 
> 赞同：6
> 
> 时间：2012-12-23T20:18:04.997
> 
> 标签：c#, windows-phone-7, xml-serialization, windows-phone-8, data-serialization

我有一些适用于 RSS 应用程序的 Windows Phone 7 代码：

```
private RSSSettings DeserializeSettings(string data)
    {
        RSSSettings rsssettings;
        try
        {
            var ser = new DataContractSerializer(typeof(RSSSettings));
            using (var sr = new StringReader(data))
            using (var xr = XmlReader.Create(sr))
                rsssettings = (RSSSettings)ser.ReadObject(xr);
        }
        catch (Exception ex)
        {
            ex.ToString();
            rsssettings = new RSSSettings() { Version = -1 };
        }
        return rsssettings;
    } 
```

它在 Windows Phone 7 上完美运行。我将应用程序移植到 Windows Phone 8，应用程序中的其他所有内容都可以正常工作，除了这个片段。

比较 Windows Phone 7 和 8 中发生的情况，WP8 中的“rsssettings”在 WP7 中正确填充时保持为空。这部分代码根本没有任何代码更改。

一切都一样，直到：

```
rsssettings = (RSSSettings)ser.ReadObject(xr); 
```

不调用异常。

任何人都知道如何解决这个令人沮丧的问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-23T22:27:00.247

是的，你不会喜欢这样的。

WP8 上的 DataContractSerializer 要求 XML 元素按字母顺序组织。这样做是因为假设进入 DataContractSerializer 的所有内容都来自另一个 DataContractSerializer。

我希望我是在编造这个，但我不是。来自 MSDN 的[Windows Phone 应用平台兼容性](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206947%28v=vs.105%29.aspx)：

> **DataContractSerializer 类**
> 
> **WP8**行为：XML 元素必须按字母顺序排序。
> 
> **WP7**行为：XML 元素可以是无序的。

在这一点上，您有几种选择：

1.  ̶a̶l̶p̶h̶a̶b̶e̶t̶i̶c̶a̶l̶l̶y̶̶o̶r̶d̶e̶r̶ ̶y̶o̶u̶̶X̶M̶L̶。不，这真的不是一个选择。
2.  由于您似乎正在获取 RSS，因此您可以考虑使用专门为 RSS/Atom 构建的WCF 的*System.ServiceModel.Syndication.SyndicationFeed 。*在Den Delimarsky的这篇[精彩文章中了解更多信息。](http://dotnet.dzone.com/articles/building-rss-reader-windows-0)
3.  如果您使用非 RSS XML，请考虑使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/fa420a9y.aspx)的直接 Xml 序列化。对我来说，这是通过网络进行 XML 序列化和反序列化的最好和最简单的方法。
4.  通过 Quirks Mode 启用从 WP7 到 WP8 的行为变化。这意味着在 WP8 上运行的 WP7 应用程序仍然可以正常运行。如果您的应用程序不能从 WP8 功能集中受益，您可以将整个应用程序保留为 WP7 应用程序。

# java - 设计无日期格式的 SQLite 数据库

> ID：14014399
> 
> 赞同：0
> 
> 时间：2012-12-23T20:18:08.877
> 
> 标签：java, android, database, sqlite, database-design

我正在尝试将 Date 存储在 android mm/dd/yyyy 的 sqlite 数据库中，我已经阅读过[这个](https://stackoverflow.com/questions/1933720/how-do-i-insert-datetime-value-into-a-sqlite-database)

如果我没有会发生什么`HH:mm:ss`（我的应用程序不需要）？
通过拆分数据库来避免数据库的日期格式是业界使用的一种方法吗？前任：

```
Db Columns:
_id INTEGER;
data TEXT;
day INTEGER;
month INTEGER;
year INTEGER; 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T20:19:31.537

您可以以毫秒为单位存储日期。然后在运行时根据用户的语言环境构建适当的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:32:09.137

如果您只想使用少量内存，请考虑将 ddMMyyyy 存储在单个`int`变量中。

在日志输出中易于阅读

```
day+month*100+year*10000 
```

日月年可以通过除法和模运算提取

或为了更快地处理计算机

```
day&0x1F+(month<<5)&0xF+(year<<9) 
```

日、月、年可以通过`>>`and`&`和操作提取

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:58:11.157

出于兼容性原因，我的应用程序将日期存储为字符串，采用 ISO“YYYY-MM-DD”格式。不过这是个特例。在大多数情况下，Sam 就是那个人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:58:23.857

SQLite 的日期函数还可以理解`yyyy-mm-dd`格式的日期字符串。

将日期拆分为三个字段是可能的，但是您将无法轻松地对它们进行计算。

# javascript - 如何每 10 秒重定向一个页面？

> ID：14014401
> 
> 赞同：0
> 
> 时间：2012-12-23T20:18:20.363
> 
> 标签：javascript, html, redirect, iframe, reload

我正在使用以下脚本来刷新我的 iframe。如果刷新失败，它将显示不同的 iframe：

```
<script type=text/javascript>
setInterval(function(){
var rq = new XMLHttpRequest();

rq.open('GET', document.getElementById('tracker').src, true);

rq.onreadystatechange = function() {
    if(rq.readyState === 4) {
        if(rq.status === 200) {
        } else {
    document.write('<iframe src="tracker2.html" style="border:0px #CCD1B9 none;" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="407px" width="417px"></iframe>');
        }
    }
};
rq.send(null);
    document.getElementById("tracker").src+="";
},2000);
</script> 
```

我的问题在下面一行：`} else {`

我想显示不同的 iframe，但要继续重新加载主页。

所以要明确：上面的代码是mainpage.html，如果无法刷新i​​frame tracker.html，它将显示iframe tracker2.html，我希望iframe tracker2.html保持刷新或重定向到mainpage.html X 秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:24:23.290

看起来您应该将 mainpage.html 和 tracker2.html 的逻辑组合到一个自动刷新页面中，但您可能有理由不这样做。

相反，我建议使用元刷新标签来帮助自动刷新页面：

```
<meta content="5; URL=/tracker2.html" http-equiv="Refresh" /> 
```

这将在 5 秒后刷新。

# grails - 尝试将 GPars 与 IntelliJ 和 grails 一起使用

> ID：14014404
> 
> 赞同：2
> 
> 时间：2012-12-23T20:18:50.413
> 
> 标签：grails, groovy, intellij-idea, dependencies, gpars

在 IntelliJ Grails 项目中使用外部 JAR GPars 时遇到了很多麻烦。我认为这是指定依赖项的问题。我正在使用[GPars-1.0.0](http://gpars.codehaus.org/)。我将它保存在 lib 目录中，并使用 IntelliJ GUI--项目结构->模块->添加将其作为依赖项包含在内。 [我同步了](https://stackoverflow.com/questions/2774497/intellij-idea-grails-not-seeing-jar/2774809)。我还尝试[直接添加到 BuildConfig.groovy](http://groovy.dzone.com/articles/concurrency-and-background)：

```
dependencies {
    compile 'org.codehaus.gpars:gpars:1.0.0'
} 
```

打字时我得到代码辅助，它编译。但是当我运行以下命令时：

```
import static groovyx.gpars.*

...

GParsPool.withPool {
     [1, 2, 3, 4, 5].eachParallel { println it }
} 
```

我收到声明“GParsePool.withPool”的 ClassNotFoundException 消息 jsr166y.ForkJoinPool

```
Line | Method 
->>  156 | findClass                 in org.codehaus.groovy.tools.RootLoader
|    306 | loadClass                 in java.lang.ClassLoader
|    128 | loadClass . . . . . . . . in org.codehaus.groovy.tools.RootLoader
|    247 | loadClass                 in java.lang.ClassLoader
|   2427 | privateGetDeclaredMethods in java.lang.Class
|   1791 | getDeclaredMethods        in     ''
|     46 | getLocked . . . . . . . . in org.codehaus.groovy.util.LazyReference
|     33 | get                       in     ''
|     80 | load . . . . . . . . . .  in allison.zipcode.ZipcodeService$$ENsSBrUW
|     30 | load                      in allison.zipcode.CountryController
|    195 | doFilter . . . . . . . .  in grails.plugin.cache.web.filter.PageFragmentCachingFilter
|     63 | doFilter                  in grails.plugin.cache.web.filter.AbstractFilter
|    886 | runTask . . . . . . . . . in java.util.concurrent.ThreadPoolExecutor$Worker
|    908 | run                       in     ''
^    680 | run . . . . . . . . . . . in java.lang.Thread 
```

有任何想法吗？我是否在 BuildConfig 中正确指定了依赖项？我的代码示例可能是错误的，但似乎遵循[此示例](http://gpars.org/1.0.0/guide/guide/dataParallelism.html#dataParallelism_parallelCollections_GParsPool)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:39:42.880

想通了：我没有包括 jsr166y.jar

```
compile "org.codehaus.jsr166-mirror:jsr166y:1.7.0" 
```

# php - 从 ISO-8859-1 到 UTF-8 的 PHP 应用程序编码问题

> ID：14014407
> 
> 赞同：1
> 
> 时间：2012-12-23T20:19:40.960
> 
> 标签：php, encoding, utf-8, character-encoding, iso-8859-1

我正在尝试将 php 应用程序从 ISO-8859-1 编码为 UTF-8。制作了应用程序的测试副本，运行以下 iconv 以递归修改所有文件。

```
find . -type f -print -exec iconv -f iso8859-1 -t utf-8 -o {}.converted {} \; -exec mv {}.converted {} \; 
```

以上并没有真正完成工作。该代码仍然具有如下文本：

```
nÃ£o exibe nenhuma info durante a configuraÃ§Ã£o. serÃ¡ setado adequadadmente 
```

使用测试 php 脚本

```
<?php
$text = "nÃ£o exibe nenhuma info durante a configuraÃ§Ã£o. serÃ¡ setado adequadadmente";

echo 'Original : ', $text, PHP_EOL;
echo 'TRANSLIT : ', iconv("ISO-8859-1", "UTF-8//TRANSLIT", $text), PHP_EOL;
echo 'IGNORE   : ', iconv("ISO-8859-1", "UTF-8//IGNORE", $text), PHP_EOL;
echo 'Plain    : ', iconv("ISO-8859-1", "UTF-8", $text), PHP_EOL;

?> 
```

输出是：

```
Original : nÃ£o exibe nenhuma info durante a configuraÃ§Ã£o. serÃ¡ setado adequadadmente
TRANSLIT : nÃƒÂ£o exibe nenhuma info durante a configuraÃƒÂ§ÃƒÂ£o. serÃƒÂ¡ setado adequadadmente
IGNORE   : nÃƒÂ£o exibe nenhuma info durante a configuraÃƒÂ§ÃƒÂ£o. serÃƒÂ¡ setado adequadadmente
Plain    : nÃƒÂ£o exibe nenhuma info durante a configuraÃƒÂ§ÃƒÂ£o. serÃƒÂ¡ setado adequadadmente 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T06:50:30.000

您的文件很好，并且在 UTF-8 中，您只是在 CP1252/ISO-8859-1 中解释它。您需要向浏览器和文本编辑器声明编码。

```
header("Content-Type: text/html; charset=utf-8"); 
```

在您的文本编辑器中，指定文件为 UTF-8，它将正确显示字符。不要进行任何转换。

# c# - 将标准输入复制到标准输出会导致奇怪的结果

> ID：14014408
> 
> 赞同：3
> 
> 时间：2012-12-23T20:19:41.397
> 
> 标签：c#

我有一个超级简单的程序。我的意图是将标准输入复制到标准输出。这是源代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

namespace LALA
{
    class LALA
    {
        static void Main()
        {
            int bufferSize = 40;
            Console.OpenStandardInput().CopyTo(Console.OpenStandardOutput(), bufferSize);
        }
    }
} 
```

如果我设置`bufferSize`为 40，那么对于任何输入，我只会看到“C on”、“C on s”或“C onsol e”等。如果我设置`bufferSize`为 41，那么一切都很好。

我的问题是我做错了什么，并且意外高于 41 的值有效吗？

为了澄清，这是我输入 asd 时的输出：

```
c:\some_path>ConsoleApplication2.exe
asd
C o n 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T22:54:58.127

惊喜！这似乎是内部缓冲区溢出，我将分享我的发现，尽管它还不是一个真正的证据，它对我来说是有意义的。

Stream类的方法代码为`CopyTo`：（带反射器）

```
public void CopyTo(Stream destination, int bufferSize)
{
    //bunch of non relevant validations...

    this.InternalCopyTo(destination, bufferSize);
} 
```

现在的代码`InternalCopyTo`是：

```
private void InternalCopyTo(Stream destination, int bufferSize)
{
    byte[] array = new byte[bufferSize];
    int count;
    while ((count = this.Read(array, 0, array.Length)) != 0)
    {
        destination.Write(array, 0, count);
    }
} 
```

控制台流实例的类型`__ConsoleStream`（System.IO 中的密封内部类）及其`Read`方法代码：

```
public override int Read([In] [Out] byte[] buffer, int offset, int count)
{
    //bunch of non relevant validations...

    int errorCode = 0;
    int num = __ConsoleStream.ReadFileNative(this._handle, buffer, offset, count, 0, out errorCode);
    if (num == -1)
    {
        __Error.WinIOError(errorCode, string.Empty);
    }
    return num;
} 
```

最后`ReadFileNative`是 __ConsoleStream 的代码：

```
private unsafe static int ReadFileNative(SafeFileHandle hFile, byte[] bytes, int offset, int count, int mustBeZero, out int errorCode)
{
    if (bytes.Length - offset < count)
    {
        throw new IndexOutOfRangeException(Environment.GetResourceString("IndexOutOfRange_IORaceCondition"));
    }
    if (bytes.Length == 0)
    {
        errorCode = 0;
        return 0;
    }
    __ConsoleStream.WaitForAvailableConsoleInput(hFile);
    int result;
    int num;
    fixed (byte* ptr = bytes)
    {
        num = __ConsoleStream.ReadFile(hFile, ptr + (IntPtr)offset / 1, count, out result, Win32Native.NULL);
    }
    if (num != 0)
    {
        errorCode = 0;
        return result;
    }
    errorCode = Marshal.GetLastWin32Error();
    if (errorCode == 109)
    {
        return 0;
    }
    return -1;
} 
```

该`ReadFile`方法是低级调用：

```
[DllImport("kernel32.dll", SetLastError = true)]
private unsafe static extern int ReadFile(SafeFileHandle handle, byte* bytes, int numBytesToRead, out int numBytesRead, IntPtr mustBeZero); 
```

我在这一点上的假设是，在幕后，40 个字节被“保留”到内部数据的某个地方，所以如果缓冲区不超过这个，您将看到保留的数据，在这种情况下，控制台应用程序是进程名称。

当我有更多时间并尝试重现时，我将继续调查此问题，这种情况非常特殊，因为两个流都指向同一个“文件”，因此您可以在阅读时写入它。

# objective-c - 从沙箱中的帮助应用程序中读取 NSUserDefaults

> ID：14014417
> 
> 赞同：4
> 
> 时间：2012-12-23T20:20:26.233
> 
> 标签：objective-c, macos, cocoa, nsuserdefaults, sandbox

我发现了一些有关阅读`NSUserDefaults`另一个应用程序的资源。

[Objective-C NSUserDefaults 缓存阻止另一个应用程序准确读取更改](https://stackoverflow.com/questions/10667848/objective-c-nsuserdefaults-caching-prevents-another-app-from-accurately-reading)

[NSUserDefaults：是否可以从另一个应用程序获取 userDefaults？](https://stackoverflow.com/questions/8939228/nsuserdefaults-is-it-possible-to-get-userdefaults-from-another-app)

显然，这是不可能的。然而问题首先与iOS有关，其次这两个应用程序完全不同。

我有一个**LaunchAtLogin**帮助应用程序。但它也执行其他一些任务。`BOOL`因此，帮助应用程序应始终运行，但仅在设置了 时才启动主应用程序`NSUserDefaults`。

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-24T07:34:37.353

可以使用安全应用程序组在主应用程序和辅助应用程序之间共享首选项，并且`-[NSUserDefaults initWithSuiteName:]`：

### 安全应用程序组

为了让多个应用程序共享一个公共容器，您需要将`com.apple.security.application-groups`权利（在您的主应用程序和辅助应用程序中）设置为一个公共标识符，例如`@"com.company.my-app-suite"`. 有关详细信息，请参阅[将应用程序添加到组](https://developer.apple.com/library/mac/documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW19)。

### 用户默认套件

根据[OS X 10.9 的 Foundation 发行说明](https://developer.apple.com/librarY/mac/releasenotes/Foundation/RN-Foundation/index.html#//apple_ref/doc/uid/TP30000742-TRANSLATED_CHAPTER_965-TRANSLATED_DEST_28)：

> 对于属于安全应用程序组的应用程序，NSUserDefaults“套件”API（-initWithSuiteName:、-addSuiteNamed: 和 -removeSuiteNamed:）将在组中的应用程序共享并存储在组容器中的套件上运行，如果套件标识符是组的标识符。

所以你会想在你的应用程序委托（或类似的）中做这样的事情：

```
- (NSUserDefaults *)sharedUserDefaults {
    static NSUserDefaults *shared = nil;
    if (!shared) {
        shared = [[NSUserDefaults alloc] initWithSuiteName:@"com.company.my-app-suite"];
    }
    return shared;
} 
```

并使用它而不是`[NSUserDefaults standardUserDefaults]`在您的两个应用程序中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-23T20:39:20.867

从 10.7.4 开始，您可以在沙箱中使用应用程序组。组内的所有应用程序共享同一个沙箱。请参阅[应用程序组](http://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW19)以了解如何设置它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:42:02.647

应用程序可以在 iCloud 上共享容器目录。

来自 Apple 关于配置 iCloud 权利的文档：

iCloud Containers 字段标识您的应用程序可以在用户的​​ iCloud 存储中访问的容器目录列表。（此字段对应于 com.apple.developer.ubiquity-container-identifiers 权利。）您添加到此列表的字符串必须对应于您的团队创建的应用程序的捆绑标识符。Xcode 使用当前应用的包标识符来指定第一个字符串；如果您希望多个应用程序共享一个主容器目录，您可以将其更改为不同的包标识符。您还可以为团队的其他应用程序添加额外的捆绑标识符。

# php - 关系型数据库 MYSQL/PHP

> ID：14014420
> 
> 赞同：1
> 
> 时间：2012-12-23T20:20:59.277
> 
> 标签：php, mysql

我正在建立一个分类广告网站，类似于 craigslist。

该网站分为几个部分；即论坛、待售、提供的服务等。

每个部分下有几个[类别]，即论坛[宠物]、论坛[书籍]、出售[易货]、服务[易货]等。（请注意，某些类别仅由其部分唯一标识，例如在“出售”和“服务”两个部分的易货交易和易货交易案例。）

用户将从每个部分中的帖子链接发布到类别。如果适用，用户可以上传照片并为其产品选择某些便利设施。论坛帖子不需要舒适属性，而车辆广告可能。设施包括：汽车广告的自动传输，或房屋租赁的家具。

我试图找出数据库模式的最佳逻辑设置。

目前我有这种基本输入/查询的逻辑结构：

```
SECTIONS TABLE- section_id, section
CATEGORIES TABLE- cat-id, category, section_id(foreign key)
AMENITIES TABLE- amen_id, amenity
PHOTOS TABLE- photos-id, file

POST TABLE- post_id, category, timestamp, description

SECTION_POST TABLE- section_id, post_id
POST_AMENITY TABLE- post_id, amenity_id
POST_PHOTO TABLE- post_id, photo_id 
```

我将 [SECTION_POST] 设为我的主要多对多，因为 [POST] 中的类别必须与该部分相关。我在类别表中将 CATEGORY 与 SECTION 相关联，在我看来，这就像一个添加了类别属性的 M 到 M。这个可以吗？

另外，关于我应该如何考虑这个模式，你有什么其他建议吗？我认为我遇到的问题主要与无知有关，而不是缺乏组织能力。也许你们中的一个人可以教育我或向我推荐一个可以解决我的一般问题的体面链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:29:05.983

你的设计相当标准。以下是一些评论，以及一些需要考虑的事项：

*   对于具有隐含依赖关系的键（例如 SECTION_POST），许多 ORM 库在
    依赖关系和由此产生的连接键方面存在问题。还有密钥分配的问题。由于这两个原因，许多
    人会改为为该表提供自己的独立键（
    可以方便地设为 AUTO_INCREMENT）并将原始 PK 移动到外键。

*   就 SECTION/CATEGORY 而言，只有您可以说概念/实体 SECTION 的重要性，但显而易见的问题是，SECTION 在任何方面与 CATEGORY 有何不同。您可以拥有相同的结构，通过仅使用带有自引用“PARENT_CATEGORY_ID”列的 CATEGORY 来获得更大的灵活性。这将允许您定义类别的树结构，同时，使用 PARENT_CATEGORY_ID 上的 IS NULL 获取顶级类别很简单。

*   我不清楚您打算如何将照片与 POST 相关联，但从设计的角度来看，支持 MM 关系会很好，这样您就可以为单个帖子提供多张照片。

Otherwise, you seem to have a good handle on relational design basics. I do a lot of database design, and prefer to use a commercial erd design tool, but there are some free options like Mysql workbench (assuming you're designing for mysql) that can help you visualize your design, and insure that all the SQL DDL is correct. It's also nice to have documentation for the development phase of your project.

# sh - 我怎样才能让一个shell脚本表明它是成功的？

> ID：14014421
> 
> 赞同：4
> 
> 时间：2012-12-23T20:21:02.867
> 
> 标签：sh

如果我有一个包含以下脚本代码的基本 .sh 文件：

```
#!/bin/sh
rm -rf "MyFolder" 
```

如何使此运行脚本文件向终端显示结果，以指示目录删除是否成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-02-21T14:07:49.157

你真的不需要让它说它是成功的。你可以让它只在错误 ✖ 上说些什么，然后沉默意味着成功 ✔。

这就是 Unix 哲学的运作方式：

> 沉默*规则*，也称为*沉默是黄金*法则，是*Unix 哲学*的重要组成部分，它指出当程序没有什么令人惊讶、有趣或有用的内容时，它应该什么也不说。这意味着表现良好的程序应该将用户的注意力和注意力视为有价值的，从而尽可能不引人注目地执行他们的任务。也就是说，沉默本身就是一种美德。[http://www.linfo.org/rule_of_silence.html](http://www.linfo.org/rule_of_silence.html)

这就是`rm`它本身的行为方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:55:00.983

如果您询问一般情况，如您的问题标题所建议的那样，您可以运行您的脚本`sh -x scriptname`以查看它在做什么。将诊断输出写入脚本本身并使用选项控制它也很常见。

```
#!/bin/sh
verbose=false
case $1 in -v | --verbose )
    verbose=true
    shift ;;
esac

say () {
    $verbose || return
    echo "$0: $@" >&2
}

say "Removing $dir ..."
rm -rf "$dir" || say "Failed." 
```

如果您在没有任何选项的情况下运行此脚本，它将静默运行，就像表现良好的 Unix 实用程序一样。如果您使用该`-v`选项运行它，它将打印一些诊断到标准错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-23T20:28:54.320

```
rm -rf "My Folder" && echo "Done" || echo "Error!" 
```

[您可以在 bash 手册](http://www.gnu.org/software/bash/manual/bashref.html#Lists)中阅读有关创建管道序列的更多信息

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-23T20:41:56.607

在 bash（和其他类似的 shell）中，`?`环境变量为您提供最后执行的命令的退出代码。所以你可以这样做：

```
#!/bin/sh
rm -rf "My Folder"
echo $? 
```

**更新**

如果`rm`命令执行后目录不存在（因为它已被成功删除或因为执行命令时它不存在）脚本将打印 0。如果目录存在（这意味着命令无法删除它）然后脚本将打印除 0 以外的退出代码。如果我理解正确的问题，这正是所要求的行为。如果不是，请纠正我。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-12-23T20:54:16.110

以前的答案是错误的：`rm`当 dir 不存在时，不要以错误代码 > 0 退出。

相反，我建议使用：

```
dir='/path/to/dir'
if [[ -d $dir ]]; then
    rm -rf "$dir"
fi 
```

如果要`rm`返回状态，请删除`-f`标志。

Linux Mint 上的示例（目录不存在）：

```
$ rm -rf /tmp/sdfghjklm
$ echo $?
0

$ rm -r /tmp/sdfghjklm
$ echo $?
1 
```

# objective-c - 用 UIImage 遮罩 UIView 黑白 iOS

> ID：14014422
> 
> 赞同：2
> 
> 时间：2012-12-23T20:21:17.077
> 
> 标签：objective-c, ios, ipad, uiview, uiimage

我正在为 iPad 开发 iOS 应用程序。我想用黑白图像掩盖 UIView 。所以图像的黑色部分是您可以看到的视图。

如果尝试以下不同的代码，但它们不起作用......

```
UIImage *_maskingImage = [UIImage imageNamed:@"ipadmask.jpg"];
CALayer *_maskingLayer = [CALayer layer];
_maskingLayer.frame = vistafunda.bounds;
[_maskingLayer setContents:(id)[_maskingImage CGImage]];
[vistafunda.layer setMask:_maskingLayer];
vistafunda.layer.masksToBounds = YES; 
```

他们的 ipadmask.jpg 是这样的：![在此处输入图像描述](../Images/1ca8714d01756390116d455da4662d7d.png)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:44:14.163

关于 CALayer`mask`属性的苹果文档：

> 一个可选层，其 alpha 通道用作蒙版，以在层的背景和将层的内容与其过滤背景合成的结果之间进行选择。

因此，您应该修复图像的 Alpha 通道。黑色像素应该是不透明的和白色的 - 完全透明。

# javascript - 用于更新内容以避免重复的速率限制 AJAX 请求

> ID：14014432
> 
> 赞同：1
> 
> 时间：2012-12-23T20:22:55.237
> 
> 标签：javascript, jquery, ajax

我试图通过检查用户是否接近底部来使用 AJAX 和 JQuery 动态获取帖子。服务器端在 GAE 上的 python 中。

监听滚动：

```
this.config.window.on('scroll',this.loadContent); 
```

1.检查与底部的距离

2.发送一个带有当前帖子数量的ajax请求，以便检索下10个

3.results.check = true 表示服务器没有更多帖子要发送。

```
 loadContent: function(){
        // 1
        if($(document).height() - $(window).height() - $(window).scrollTop() < 1000) {
            var posts = $('.troll').children('div').length;
            data = 'loadmore=True&offset=' + posts;   //2
            $.ajax({               
                url: '/',
                type: 'POST', 
                data: data,
                dataType: 'json',
                success: function(results){
                    if (results.check === 'true'){  //3 
                        $(window).unbind('scroll');
                        return;
                    }
                    Post.insert10Values(results);
                }
            });
        };
    },

    insert10Values: function(results){
        var update = Handlebars.compile($('#troll10').html()),
            troll10update = update(results);

        $('div.troll').append( troll10update );
    } 
```

这里的问题是，当快速滚动时，两个或多个请求被发送到服务器并且我得到重复的条目。我想对客户端进行速率限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:32:15.773

您的部分问题是滚动事件每秒会触发多次

您可以限制任何函数调用，执行如下操作：

```
var scrollTimer=false;
var delay=500; /* 1/2 second*/
$(window).on('scroll',function(){
   if( scrollTimer){
       clearTimeout( scrollTimer);
   }

   scrollTimer=setTimeout(function(){           
       /* run your code here*/
   }, delay);

}); 
```

至于 ajax，您可以存储最后一次 ajax 调用的时间，并在进行新的 ajax 调用之前根据现在与存储的时间设置最小差异

```
var lastAJAX=Date.now(), AJAXMin=5000;/* 5 seconds*/

function checkAJAXCalls(){
    var now=Date.now(), diff=now-lastAJAX; 
    if( diff >= AJAXMin){
        lastAJAX=now;
         return true;
    }else{
        return false;
    }
} 
```

然后`if(checkAJAXCalls())`在发出请求之前运行。也可以修改概念以`lastAJAX`在成功回调中`$.ajax`更新

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T20:33:38.707

设置标志 loading = false。在发送请求之前，请检查标志。如果为假，则将该标志设置为真并继续请求，否则忽略该事件。当结果到达时，显示它们并将标志设置回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:31:58.313

`jQuery.ajax`有一个方法叫做`beforeSend`. 它在您的 ajax 调用之前执行。您可以使用它来检查是否有任何其他请求正在进行中，如果有则取消呼叫。如果您在`beforeSend`函数中返回 false，则不会触发 ajax 调用，因此您不会有任何重复的内容。

```
$.ajax({               
    url: '/',
    type: 'POST', 
    data: data,
    dataType: 'json',
    beforeSend: function() {
        if (window.nextPageProcess) {
          return false;
        } else {
          window.nextPageProcess = 1;
        }
    },
    success: function(results){
        if (results.check === 'true'){  //3 
            $(window).unbind('scroll');
            return;
        }
        Post.insert10Values(results);
          window.nextPageProcess = 1;
    }
}); 
```

# mysql - 没有年份支持的mysql程序

> ID：14014445
> 
> 赞同：0
> 
> 时间：2012-12-23T20:25:12.600
> 
> 标签：mysql, stored-procedures

我正在使用 MySQL 程序根据两个不同的表来获取商店的营业时间和关闭时间。正常的“shop_hours”定义为开/关时间和星期几（1-7）。为了允许自定义正常的开/关时间，我还有一个名为“shop_hours_special”的表，这是用一年中的某一天列定义的。

如果我运行参数`CALL timesDate('2013-01-02','1', 'false')`，即使商店在这个日期营业，我也会得到 NULL 结果。

如果任何 MySQL 策划者可以给我提示如何使其在当前以外的其他年份工作，我将不胜感激！

```
DELIMITER $$
DROP PROCEDURE IF EXISTS timesDate$$

CREATE PROCEDURE timesDate(IN searchedDate DATE, IN dType TINYINT(3), IN ignoreCurrentTime BOOLEAN)
BEGIN
    DECLARE final_o_time, final_c_time, o_time, c_time, curTime TIME;  
    DECLARE dayYear, dayWeek, curDay INT;
    DECLARE special_exist BOOLEAN;

    SET dayYear = DAYOFYEAR(searchedDate);
    SET dayWeek = WEEKDAY(searchedDate) + 1;
    SET curDay = DAYOFYEAR(NOW());
    SET curTime = TIME(NOW());

    SELECT IF(COUNT(*) > 0, TRUE, FALSE), open_time, close_time INTO special_exist, o_time, c_time
        FROM shop_hours_special
        WHERE day_of_year = dayYear AND `type` = dType;

    IF special_exist THEN
        IF IgnoreCurrentTime THEN
            SET final_o_time = o_time;
            SET final_c_time = c_time;
        ELSEIF dayYear < curDay THEN
            SET final_o_time = NULL;
            SET final_c_time = NULL;
        ELSEIF dayYear = curDay THEN
            IF curTime < o_time THEN
                SET final_o_time = o_time;
                SET final_c_time = c_time;
            ELSEIF curTime < c_time THEN
                SET final_o_time = curTime;
                SET final_c_time = c_time;
            ELSE
                SET final_o_time = NULL;
                SET final_c_time = NULL;
            END IF;
        ELSE
            SET final_o_time = o_time;
            SET final_c_time = c_time;
        END IF;
    ELSE
        SELECT open_time, close_time INTO o_time, c_time
        FROM shop_hours
        WHERE day_of_week = dayWeek AND (open_time != MAKETIME(0,0,0) OR close_time != MAKETIME(0,0,0)) AND `type` = dType;

        IF IgnoreCurrentTime THEN
            SET final_o_time = o_time;
            SET final_c_time = c_time;
        ELSEIF dayYear < curDay THEN
            SET final_o_time = NULL;
            SET final_c_time = NULL;
        ELSEIF dayYear = curDay THEN
            IF curTime < o_time THEN
                SET final_o_time = o_time;
                SET final_c_time = c_time;
            ELSEIF curTime < c_time THEN
                SET final_o_time = curTime;
                SET final_c_time = c_time;
            ELSE
                SET final_o_time = NULL;
                SET final_c_time = NULL;
            END IF;
        ELSE
            SET final_o_time = o_time;
            SET final_c_time = c_time;
        END IF;

    END IF;

    SELECT final_o_time, final_c_time;

END$$
DELIMITER ; 
```

MySQL转储：

```
CREATE TABLE `shop_hours` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `shop_id` int(11) unsigned NOT NULL,
  `type` tinyint(3) NOT NULL DEFAULT '1',
  `day_of_week` int(11) NOT NULL,
  `open_time` time NOT NULL,
  `close_time` time NOT NULL,
  PRIMARY KEY (`id`),
  KEY `shop_id` (`shop_id`),
  CONSTRAINT `shop_hours_ibfk_1` FOREIGN KEY (`shop_id`) REFERENCES `shops` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `shop_hours` (`id`, `shop_id`, `type`, `day_of_week`, `open_time`, `close_time`)
VALUES
    (1,1,1,1,'09:30:00','20:00:00'),
    (2,1,1,2,'09:30:00','20:00:00'),
    (3,1,1,3,'09:30:00','20:00:00'),
    (4,1,1,4,'09:30:00','20:00:00'),
    (5,1,1,5,'09:30:00','20:00:00'),
    (6,1,1,6,'11:00:00','20:00:00'),
    (7,1,1,7,'11:00:00','20:00:00'),
    (8,1,2,1,'11:45:00','12:30:00'),
    (9,1,2,2,'11:45:00','12:30:00'),
    (10,1,2,3,'11:45:00','12:30:00'),
    (11,1,2,4,'11:45:00','12:30:00'),
    (12,1,2,5,'11:45:00','12:30:00'),
    (13,1,2,6,'00:00:00','00:00:00'),
    (14,1,2,7,'00:00:00','00:00:00');

CREATE TABLE `shop_hours_special` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `shop_id` int(11) unsigned NOT NULL,
  `type` tinyint(3) NOT NULL DEFAULT '1',
  `day_of_year` int(11) NOT NULL,
  `open_time` time NOT NULL,
  `close_time` time NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `unique` (`shop_id`,`type`,`day_of_year`),
  KEY `shop_id` (`shop_id`),
  CONSTRAINT `shop_hours_special_ibfk_1` FOREIGN KEY (`shop_id`) REFERENCES `shops` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `shop_hours_special` (`id`, `shop_id`, `type`, `day_of_year`, `open_time`, `close_time`)
VALUES
    (1,1,1,1,'00:00:00','00:00:00'),
    (2,1,1,92,'00:00:00','00:00:00'),
    (3,1,1,96,'00:00:00','00:00:00'),
    (4,1,1,97,'00:00:00','00:00:00'),
    (5,1,1,99,'00:00:00','00:00:00'),
    (6,1,1,100,'00:00:00','00:00:00'),
    (7,1,1,125,'00:00:00','00:00:00'),
    (8,1,1,138,'00:00:00','00:00:00'),
    (9,1,1,148,'00:00:00','00:00:00'),
    (10,1,1,149,'00:00:00','00:00:00'),
    (11,1,2,1,'00:00:00','00:00:00'),
    (12,1,2,92,'00:00:00','00:00:00'),
    (13,1,2,96,'00:00:00','00:00:00'),
    (14,1,2,97,'00:00:00','00:00:00'),
    (15,1,2,99,'00:00:00','00:00:00'),
    (16,1,2,100,'00:00:00','00:00:00'),
    (17,1,2,125,'00:00:00','00:00:00'),
    (18,1,2,138,'00:00:00','00:00:00'),
    (19,1,2,148,'00:00:00','00:00:00'),
    (20,1,2,149,'00:00:00','00:00:00'),
    (21,1,1,358,'11:00:00','15:00:00'),
    (22,1,2,358,'00:00:00','00:00:00'),
    (23,1,1,359,'00:00:00','00:00:00'),
    (24,1,2,359,'00:00:00','00:00:00'),
    (25,1,1,360,'00:00:00','00:00:00'),
    (26,1,2,360,'00:00:00','00:00:00'),
    (27,1,2,361,'00:00:00','00:00:00'),
    (28,1,1,361,'00:00:00','00:00:00'),
    (29,1,1,366,'11:00:00','14:00:00'),
    (30,1,2,366,'00:00:00','00:00:00'),
    (31,1,2,362,'00:00:00','00:00:00'),
    (32,1,2,363,'00:00:00','00:00:00'); 
```

# node.js - 如何从 Redis 保存和检索会话

> ID：14014446
> 
> 赞同：49
> 
> 时间：2012-12-23T20:25:17.673
> 
> 标签：node.js, redis, session-state

我正在尝试将 Redis 会话集成到我用 Node.js 编写的身份验证系统中。

我已经能够成功设置 Redis 服务器`connect-redis`和 Express 服务器。

这是我的设置（只是重要的一点）：

```
var express = require("express");
var RedisStore = require("connect-redis")(express);
var redis = require("redis").createClient();

app.use(express.cookieParser());
app.use(express.session({
    secret: "thisismysecretkey",
    store: new RedisStore({ host: 'localhost', port: 6379, client: redis })
})); 
```

现在...我如何实际创建、读取和销毁会话？我已经阅读了大量关于如何设置的文章`connect-redis`以及关于 SO 的许多问题，但我发誓每篇文章都只停留在配置上，并没有解释如何实际使用它......

我知道这可能非常简单，但请不要投反对票，只需解释一下:)。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-23T20:46:04.657

这应该就是它的全部了。您可以通过 访问路由处理程序中的会话`req.session`。会话会自动创建、保存和销毁。

如果您需要为用户手动创建新会话，请调用`req.session.regenerate()`.

如果需要手动保存，可以调用`req.session.save()`.

如果需要手动销毁，可以调用`req.session.destroy()`.

有关方法和属性的完整列表，请参阅[Connect 文档](http://www.senchalabs.org/connect/session.html)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-29T05:43:48.147

考虑这段代码。

```
var express = require('express');
var redis   = require("redis");
var session = require('express-session');
var redisStore = require('connect-redis')(session);
var bodyParser = require('body-parser');
var client  = redis.createClient();
var app = express();

app.set('views', __dirname + '/views');
app.engine('html', require('ejs').renderFile);

app.use(session({
    secret: 'ssshhhhh',
    // create new redis store.
    store: new redisStore({ host: 'localhost', port: 6379, client: client,ttl :  260}),
    saveUninitialized: false,
    resave: false
}));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({extended: true}));

app.get('/',function(req,res){  
    // create new session object.
    if(req.session.key) {
        // if email key is sent redirect.
        res.redirect('/admin');
    } else {
        // else go to home page.
        res.render('index.html');
    }
});

app.post('/login',function(req,res){
    // when user login set the key to redis.
    req.session.key=req.body.email;
    res.end('done');
});

app.get('/logout',function(req,res){
    req.session.destroy(function(err){
        if(err){
            console.log(err);
        } else {
            res.redirect('/');
        }
    });
});

app.listen(3000,function(){
    console.log("App Started on PORT 3000");
}); 
```

因此，您需要安装**connect-redis**并将您的**express-session** 实例传递给它。

然后在中间件中使用这样的服务器详细信息初始化 redisStore。

```
app.use(session({
    secret: 'ssshhhhh',
    // create new redis store.
    store: new redisStore({ host: 'localhost', port: 6379, client: client,ttl :  260}),
    saveUninitialized: false,
    resave: false
})); 
```

我把ttl设为260，你可以增加。在 TTL 达到其限制后，它会自动删除 redis key。

在路由器中，您可以使用 req.session 变量来设置、编辑或销毁会话。

还有一件事...

如果您想要自定义 cookie，即与您的 Redis 存储中的不同，您可以使用**cookie-parser**来设置 cookie 机密。

希望能帮助到你。

链接：[https ://codeforgeek.com/2015/07/using-redis-to-handle-session-in-node-js/](https://codeforgeek.com/2015/07/using-redis-to-handle-session-in-node-js/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-05T02:00:33.430

您还可以使用 Redis 监控工具实时查看所有操作！当您刷新应用程序时，您将看到数据出现在控制台窗口中。

```
redis-cli monitor 
```

使用 tj/connect-redis 的会话示例输出

```
1538704759.924701 [0 unix:/tmp/redis.sock] "expire" "sess:F9x-YgbgXu1g7RG8tFlkwY3RV0JzHgCh" "3600"
1538704759.131285 [0 unix:/tmp/redis.sock] "get" "sess:F9x-YgbgXu1g7RG8tFlkwY3RV0JzHgCh"
1538704787.179318 [0 unix:/tmp/redis.sock] "set" "sess:Hl3LPbOBdKO44SG4zQHFn2gfdiWTwzWW" "{\"cookie\":{\"originalMaxAge\":3600000,\"expires\":\"2018-10-05T02:59:47.178Z\",\"secure\":true,\"httpOnly\":true,\"domain\":\".indospace.io\",\"path\":\"/\"},\"path\":\"/\",\"userAgent\":{\"family\":\"NewRelicPingerBot\",\"major\":\"1\",\"minor\":\"0\",\"patch\":\"0\",\"device\":{\"family\":\"Other\",\"major\":\"0\",\"minor\":\"0\",\"patch\":\"0\"},\"os\":{\"family\":\"Other\",\"major\":\"0\",\"minor\":\"0\",\"patch\":\"0\"}},\"ip\":\"184.73.237.85\",\"page_not_found_count\":0,\"city\":\"Ashburn\",\"state\":\"VA\",\"city_state\":\"Ashburn, VA\",\"zip\":\"20149\",\"latitude\":39.0481,\"longitude\":-77.4728,\"country\":\"US\"}" "EX" "3599"
1538704787.179318 [0 unix:/tmp/redis.sock] "set" "sess:Hl3LPbOBdKO44SG4zQHFn2gfdiWTwzWW" "{\"cookie\":{\"originalMaxAge\":3600000,\"expires\":\"2018-10-05T02:59:47.178Z\",\"secure\":true,\"httpOnly\":true,\"domain\":\".indospace.io\",\"path\":\"/\"},\"path\":\"/\",\"userAgent\":{\"family\":\"NewRelicPingerBot\",\"major\":\"1\",\"minor\":\"0\",\"patch\":\"0\",\"device\":{\"family\":\"Other\",\"major\":\"0\",\"minor\":\"0\",\"patch\":\"0\"},\"os\":{\"family\":\"Other\",\"major\":\"0\",\"minor\":\"0\",\"patch\":\"0\"}},\"ip\":\"184.73.237.85\",\"page_not_found_count\":0,\"city\":\"Ashburn\",\"state\":\"VA\",\"city_state\":\"Ashburn, VA\",\"zip\":\"20149\",\"latitude\":39.0481,\"longitude\":-77.4728,\"country\":\"US\"}" "EX" "3599" 
```

# ruby-on-rails - RSpec 控制器测试 + OmniAuth = 坏主意？

> ID：14014449
> 
> 赞同：2
> 
> 时间：2012-12-23T20:25:47.687
> 
> 标签：ruby-on-rails, rspec, omniauth

这是我遇到的一个[更具体的问题的广义版本。](https://stackoverflow.com/questions/14013366/rspec-oauth-having-trouble-signing-in-from-within-a-test-omniauth-mock#comment19350754_14013366)基本上，我有一个使用 OmniAuth + rolify 的项目，我正在尝试创建控制器测试（不是集成/功能测试，而是专门测试控制器）。

问题是该控制器具有取决于登录用户类型的条件逻辑。尝试从控制器测试内部通过 OmniAuth 登录模拟用户有点像一场噩梦。

这是因为我是一个不知道该怎么做的菜鸟，还是因为尝试在控制器测试中使用 OmniAuth 模拟只是一个坏主意？

任何提示/指针将不胜感激。我没有使用设计，只是使用 OmniAuth 和 rolify。

# java - 如何从命令行运行 Eclipse 编译的 Java 类？

> ID：14014453
> 
> 赞同：0
> 
> 时间：2012-12-23T20:26:15.273
> 
> 标签：java, eclipse, compiler-errors

我正在编写一个基本的 TCP 聊天程序，其中一个要求是它可以使用以下参数格式从命令行运行：

```
java Server 8888
java Client localhost 8888 
```

这将启动一个在 8888 上侦听的服务器，并等待接受来自客户端的传入连接。然后启动一个客户端并连接到 localhost:8888 的服务器。这些类都可以在 Eclipse 中编译和运行，我已分别将上述变量添加到类的运行配置中。

如果我导航到 CMD 中的文件目录，我可以看到已编译的 .class 文件，但是当我尝试使用以下命令运行服务器时：

```
java Server 8888 
```

我得到错误

```
Error: Could not find or load main class Server 
```

Eclipse>Window>Preferences>Java>Compiler 显示**JDK 1.7**。

从命令行运行 java -version 显示

```
java version "1.7.0_02"
Java(TM) SE Runtime Environment (build 1.7.0_02-b13)
Java HotSpot(TM) 64-Bit Server VM (build 22.0-b10, mixed mode) 
```

我希望能够从单独的提示并行运行这两个类。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:34:30.770

```
java -cp . basicChat.Server 8888 
```

您需要指定完全限定的类名（包括包名）

原因：

类全名（称为完全限定名）不是`Server`，而是`basicChat.Server`。该文件位于名为`basicChat`. 所以java正在寻找一个与包名匹配的目录结构。Server.class 文件位于文件系统中的 basicChat 目录下。

`Server`否则请考虑如果您在不同的包（名称空间）中调用了多个类，我们将如何选择预期的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:33:52.870

你确定在这两个类中你都有`main`方法吗？

```
public static void main(String[] args) { ... } 
```

你的课程有**`public`**修饰符吗？

如果你在一个包中有这个类，例如：`test.Server`你将从这样的`bin`文件夹中运行它：

```
java test.Server 8888 
```

编译这个类：

```
public class Server {
    public static void main(String[] args) {
        System.out.println(Arrays.deepToString(args));
    }
} 
```

并运行：

```
java Server 8888 
```

给出输出：

```
[8888] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:30:20.737

您的 CLASSPATH 不正确。从 bin 目录尝试以下（在 Windows 上）：

```
java -cp .;%CLASSPATH% basicChat.Server 8888 
```

此外，您可以在 Eclipse 中运行您的服务器。为它创建一个运行配置，在参数中指定一个端口。然后您可以在 Eclipse 中启动它，它会在您停止或关闭 Eclipse 时运行。

# c++ - Lib Png：Png24 到 Png32 和反之亦然

> ID：14014454
> 
> 赞同：1
> 
> 时间：2012-12-23T20:26:17.353
> 
> 标签：c++, libpng, png-24

我最近在上一篇文章中解决了位图问题。现在我又回来了另一个图像问题。这次是PNG。

我正在使用 LibPng 来读取和写入 PNG 文件。我有一个包含每个像素的 BGRA 信息的结构。我知道像素以 RGBA 格式正确存储。所以我指定交换 B 和 R。效果很好。我想我以某种方式翻转了图像，但我不太确定。

当我尝试将 24 位 PNG 转换为 32 位 PNG 时，我的问题就出现了，反之亦然。目前，我可以做 24 到 24 和 32 到 32 就好了。

你们能看看我的代码并告诉我在尝试从 24 转换为 32 时我做错了什么吗？

下面的代码适用于将相同的 PNG 加载和写回磁盘。我确保将所有内容都包含在这个文件中，以便你们可以编译它并查看是否有必要。

```
#include <iostream>
#include <vector>
#include <fstream>
#include <stdexcept>
#include "Libraries/LibPng/Include/png.h"

typedef union RGB
{
    uint32_t Color;
    struct
    {
        unsigned char B, G, R, A;
    } RGBA;
} *PRGB;

std::vector<RGB> Pixels;
uint32_t BitsPerPixel, width, height;
int bitdepth, colortype, interlacetype, channels;

void ReadFromStream(png_structp PngPointer, png_bytep Data, png_size_t Length) //For reading using ifstream rather than FILE*
{
    std::ifstream *Stream = (std::ifstream*)png_get_io_ptr(PngPointer);
    Stream->read((char*)Data, Length);
}

void WriteToStream(png_structp PngPointer, png_bytep Data, png_size_t Length)  //For writing using ofstream rather than FILE*
{
    std::ofstream *Stream = (std::ofstream*)png_get_io_ptr(PngPointer);
    Stream->write((char*)Data, Length);
}

void Load(const char* FilePath)
{
    std::fstream hFile(FilePath, std::ios::in | std::ios::binary);
    if (!hFile.is_open()){throw std::invalid_argument("File Not Found.");}

    unsigned char Header[8] = {0};
    hFile.read(reinterpret_cast<char*>(&Header), sizeof(Header));

    if (png_sig_cmp(Header, 0, 8))
    {
        hFile.close();
        throw std::invalid_argument("Error: Invalid File Format. Required: Png.");
    }

    png_structp PngPointer = png_create_read_struct(PNG_LIBPNG_VER_STRING, nullptr, nullptr, nullptr);
    if (!PngPointer)
    {
        hFile.close();
        throw std::runtime_error("Error: Cannot Create Read Structure.");
    }

    png_infop InfoPointer = png_create_info_struct(PngPointer);
    if (!InfoPointer)
    {
        hFile.close();
        png_destroy_read_struct(&PngPointer, nullptr, nullptr);
        throw std::runtime_error("Error: Cannot Create InfoPointer Structure.");
    }

    png_infop EndInfo = png_create_info_struct(PngPointer);
    if (!EndInfo)
    {
        hFile.close();
        png_destroy_read_struct(&PngPointer, &InfoPointer, nullptr);
        throw std::runtime_error("Error: Cannot Create EndInfo Structure.");
    }

    if (setjmp(png_jmpbuf(PngPointer)))
    {
        hFile.close();
        png_destroy_read_struct(&PngPointer, &InfoPointer, nullptr);
        throw std::runtime_error("Error: Cannot Set Jump Pointer.");
    }

    png_set_sig_bytes(PngPointer, sizeof(Header));
    png_set_read_fn(PngPointer, reinterpret_cast<void*>(&hFile), ReadFromStream);
    png_read_info(PngPointer, InfoPointer);

    //This is where I start getting the info and storing it..

    channels = png_get_channels(PngPointer, InfoPointer);
    png_get_IHDR(PngPointer, InfoPointer, &width, &height, &bitdepth, &colortype, &interlacetype, nullptr, nullptr);
    png_set_strip_16(PngPointer);
    png_set_packing(PngPointer);

    switch (colortype)
    {
        case PNG_COLOR_TYPE_GRAY:
        {
            png_set_expand(PngPointer);
            break;
        }

        case PNG_COLOR_TYPE_GRAY_ALPHA:
        {
            png_set_gray_to_rgb(PngPointer);
            break;
        }

        case PNG_COLOR_TYPE_RGB:
        {
            png_set_bgr(PngPointer);
            BitsPerPixel = 24;
            break;
        }

        case PNG_COLOR_TYPE_RGBA:
        {
            png_set_bgr(PngPointer);
            BitsPerPixel = 32;
            break;
        }

        default: png_destroy_read_struct(&PngPointer, &InfoPointer, nullptr); throw std::runtime_error("Error: Png Type not supported."); break;
    }

    //Store the new data.

    png_read_update_info(PngPointer, InfoPointer);
    channels = png_get_channels(PngPointer, InfoPointer);
    png_get_IHDR(PngPointer, InfoPointer, &width, &height, &bitdepth, &colortype, &interlacetype, nullptr, nullptr);

    Pixels.resize(width * height);
    std::vector<unsigned char*> RowPointers(height);
    unsigned char* BuffPos = reinterpret_cast<unsigned char*>(Pixels.data());

    //Set the row pointers to my Pixels vector. This way, the image is stored upright in my vector<BGRA> Pixels.
    //I think this is flipping it for some reason :S

    for (size_t I = 0; I < height; ++I)
    {
        RowPointers[I] = BuffPos + (I * width * ((BitsPerPixel > 24) ? 4 : 3));
    }

    png_read_image(PngPointer, RowPointers.data());                 //Get the pixels as BGRA and store it in my struct vector.
    png_destroy_read_struct(&PngPointer, &InfoPointer, nullptr);
    hFile.close();

    std::cout<<"Loading Parameters..."<<std::endl;
    std::cout<<"Bits:  "<<BitsPerPixel<<std::endl;
    std::cout<<"Depth: "<<bitdepth<<std::endl;
    std::cout<<"CType: "<<colortype<<std::endl;
}

void Save(const char* FilePath)
{
    std::fstream hFile(FilePath, std::ios::out | std::ios::binary);
    if (!hFile.is_open()) {throw std::invalid_argument("Cannot open file for writing.");}

    png_structp PngPointer = png_create_write_struct(PNG_LIBPNG_VER_STRING, nullptr, nullptr, nullptr);
    if (!PngPointer)
    {
        hFile.close();
        throw std::runtime_error("Error: Cannot Create Write Structure.");
    }

    png_infop InfoPointer = png_create_info_struct(PngPointer);
    if (!InfoPointer)
    {
        hFile.close();
        png_destroy_write_struct(&PngPointer, nullptr);
        throw std::runtime_error("Error: Cannot Create InfoPointer Structure.");
    }

    if (setjmp(png_jmpbuf(PngPointer)))
    {
        hFile.close();
        png_destroy_write_struct(&PngPointer, &InfoPointer);
        throw std::runtime_error("Error: Cannot Set Jump Pointer.");
    }

    std::cout<<"\nSaving Parameters..."<<std::endl;
    std::cout<<"Bits:  "<<BitsPerPixel<<std::endl;
    std::cout<<"Depth: "<<bitdepth<<std::endl;
    std::cout<<"CType: "<<colortype<<std::endl;

    //This is where I set all the Information..

    png_set_IHDR (PngPointer, InfoPointer, width, height, bitdepth, BitsPerPixel == 24 ? PNG_COLOR_TYPE_RGB : PNG_COLOR_TYPE_RGBA, PNG_INTERLACE_NONE, PNG_COMPRESSION_TYPE_DEFAULT, PNG_FILTER_TYPE_DEFAULT);
    std::vector<unsigned char*> RowPointers(height);
    unsigned char* BuffPos = reinterpret_cast<unsigned char*>(Pixels.data());

    //Set the Row pointers to my vector<BGRA> Pixels. It should have been stored upright already.
    //I think this flips it upside down :S?

    for (size_t I = 0; I < height; ++I)
    {
        RowPointers[I] = BuffPos + (I * width * ((BitsPerPixel > 24) ? 4 : 3));
    }

    png_set_bgr(PngPointer);        //My struct vector holds BGRA and PNG requires RGBA so swap them..
    png_set_write_fn(PngPointer, reinterpret_cast<void*>(&hFile), WriteToStream, nullptr);
    png_set_rows(PngPointer, InfoPointer, RowPointers.data());
    png_write_png(PngPointer, InfoPointer, PNG_TRANSFORM_IDENTITY, NULL);
    png_destroy_write_struct(&PngPointer, &InfoPointer);
    hFile.close();
}

void SetBitsPerPixel(uint32_t BPP)
{
    BitsPerPixel = BPP;
    bitdepth = (BPP > 24 ? 8 : 6);
    channels = (BPP > 24 ? 4 : 3);
    colortype = (BPP > 24 ? PNG_COLOR_TYPE_RGBA : PNG_COLOR_TYPE_RGB);
}

int main()
{
    Load("C:/Images/Png24.png");
    SetBitsPerPixel(32);
    Save("C:/Images/Output/Png32.png");
} 
```

我加载（使用 MS-Paint 制作的 24 位 PNG）：![在此处输入图像描述](../Images/57224c6c0866934bfe9cb00146b98908.png) 当我将其另存为 24 时，它完美保存。当我尝试将其保存为 32 时，它看起来像：

![在此处输入图像描述](../Images/bb14ac2f17341f189820f41e46508d18.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T01:48:02.217

尝试对您的源代码进行以下修改。**未测试！**
在您的**Load**函数中更改此：

```
 case PNG_COLOR_TYPE_RGB:
    {
        png_set_bgr(PngPointer);
        BitsPerPixel = 24;
        break;
    } 
```

对此：

```
 case PNG_COLOR_TYPE_RGB:
    {
        png_set_filler(PngPointer, 0xFF, PNG_FILLER_AFTER);
        png_set_bgr(PngPointer);
        BitsPerPixel = 32;
        break;
    } 
```

* * *

在您的**加载**和**保存**功能中更改此：

```
for (size_t I = 0; I < height; ++I)
{
    RowPointers[I] = BuffPos + (I * width * ((BitsPerPixel > 24) ? 4 : 3));
} 
```

对此：

```
size_t BytesPerLine = width << 2;
unsigned char *ptr = BuffPos;
for (size_t I = 0; I < height; ++I, ptr += BytesPerLine)
    RowPointers[I] = ptr; 
```

* * *

在您的**保存**功能更改此：

```
png_write_png(PngPointer, InfoPointer, PNG_TRANSFORM_IDENTITY, NULL); 
```

对此：

```
png_write_png(PngPointer, InfoPointer, BitsPerPixel == 24 ? PNG_TRANSFORM_STRIP_FILLER : PNG_TRANSFORM_IDENTITY, NULL); 
```

* * *

并在您的**SetBitsPerPixel**函数中更改此行：

```
bitdepth = (BPP > 24 ? 8 : 6); 
```

对此：

```
bitdepth = (BPP >= 24 ? 8 : 6); 
```

实际上，我不确定您为什么要这样做，因为据我所知，24 和 32 bpp 图像的位深度应*为*8 位。

**注意**：此修改适用于 24 和 32 bpp 图像，因此如果您想使用*索引*或*灰度*图像，您可能需要进行一些额外的修改。关键是您应该始终将像素保存在 BGRA 缓冲区中（无论您加载没有 alpha 通道的索引、灰度或 RGB 图像）。

# android - 隐藏一些孩子的水平滚动视图

> ID：14014459
> 
> 赞同：5
> 
> 时间：2012-12-23T20:27:24.083
> 
> 标签：android, horizontalscrollview

安卓 4.1.0。

我有一个水平滚动视图，在里面 - `LinearLayout`。在 LinearLayout 中，我以编程方式在 fragment 中添加了一些子项`onResume`。在儿童适合视野的情况下，一切都很好。如果子视图不适合视图，则从左侧`HorizontalView`隐藏前**n 个**元素，并为右侧的 n 个元素保留可用空间。

我试图打电话`computeScroll`或`requestLayout`/ `forceLayout`，但它没有帮助。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<HorizontalScrollView
    android:id="@+id/productListScroll"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">

    <LinearLayout
        android:id="@+id/productListLayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_margin="5dp"
        android:orientation="horizontal"
        android:paddingBottom="10dp"
        android:paddingLeft="10dp"
        android:paddingTop="10dp" />
</HorizontalScrollView>
...
</LinearLayout> 
```

和片段中的代码：

```
 public void onResume() {
         super.onResume();
         productsPanel.removeAllViews();
         for (Product product : currentOrder.getProductList()) {
             productsPanel.addView(new ...); //view with calculated height and width
             productsPanel.addView(new ...); //view with fixed width and height = MATCH_PARENT
         }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-11-05T12:59:39.363

```
<HorizontalScrollView 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal">
        <LinearLayout android:id="@+id/top_buttons"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal">
            <!-- Lots of items -->
        </LinearLayout>
    </HorizontalScrollView> 
```

这是问题。如果您设置`android:layout_gravity="center_horizontal"`为内部容器，水平滚动视图会隐藏其子项。链接在[这里](https://code.google.com/p/android/issues/detail?id=20088)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T12:33:42.147

通过设置线性布局解决了这个问题`layout_gravity=left`，`gravity=center`. 我还将视图创建代码移至`onActivityCreated`，但我认为它无助于解决此问题。

# javascript - 显示每个下拉选项的信息

> ID：14014469
> 
> 赞同：0
> 
> 时间：2012-12-23T20:28:31.967
> 
> 标签：javascript, jquery

我有 2 个 jQuery 下拉菜单。第二个下拉列表的内容取决于从第一个下拉列表中选择的值。

代码在此链接[http://jsfiddle.net/5tmwg/](http://jsfiddle.net/5tmwg/)

标头标签中的脚本示例

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script type="text/javascript" defer="defer">
    function cascadeSelect(parent, child){
            var childOptions = child.find('option:not(.static)');
                child.data('options',childOptions);

            parent.change(function(){
                childOptions.remove();
                child
                    .append(child.data('options').filter('.sub_' + this.value))
                    .change();
            })

            childOptions.not('.static, .sub_' + parent.val()).remove();

    }

    $(function(){
        cascadeForm = $('.cascadeTest');
        orgSelect = cascadeForm.find('.orgSelect');
        terrSelect = cascadeForm.find('.terrSelect');
        locSelect = cascadeForm.find('.locSelect');

        cascadeSelect(orgSelect, terrSelect);
        cascadeSelect(terrSelect, locSelect);
    });
</script> 
```

我想要做的是显示一个包含每个选项信息的 div。我缺乏javascript和jQuery的经验，所以请详细解释一下，提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T22:33:15.263

这应该让你开始。

```
<html>
  <head>
    <title></title>
      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
        <script type="text/javascript" defer="defer">
            //Function that handles displaying the details about the organization
            function orgDetails(){
                var org = $("#org").attr("value");//get user selection from form
                var div1 = $("#div1");//the div to display info
               //determine what to display in your div1 
               switch(org)
                {
                case "1":
                  div1.html("this is all about organization 1");//output the info
                  break;
                case "2":
                  div1.html("<p>this is all about organization 2</p>");
                  break;
                case "3":
                  div1.html("<b>this</b> is all about organization 3");
                  break;
                default:
                  div1.html("<font color='red'>Select Organization</font>");
                }
                $("#div2").fadeOut(300);//if territory div is set, hide it
                div1.fadeIn(300);//if div1 has already been hidden, unhide it.
            }

            //Function that handles displaying the details about the territory
            function TerritoryDetails(){
                var terr = $("#terrSelect").attr("value");
                var div = $("#div2");
                div.fadeIn(300);
                $("#div1").slideUp(300);//hide organization (optional)
               switch(terr)
                {
                case "1":
                  div.html("this is all about Territory 1");
                  break;
                case "2":
                  div.html("this is all about Territory 2");
                  break;
                case "3":
                  div.html("this is all about Territory 3");
                  break;
                case "4":
                  div.html("this is all about Territory 4");
                  break;
                case "5":
                  div.html("this is all about Territory 5");
                  break;
                case "6":
                  div.html("this is all about Territory 6");
                  break;
                case "7":
                  div.html("this is all about Territory 7");
                  break;
                default:
                  div.html("Select Territory");
                }
            }

            function cascadeSelect(parent, child){
                    var childOptions = child.find('option:not(.static)');
                        child.data('options',childOptions);

                    parent.change(function(){
                        childOptions.remove();
                        child
                            .append(child.data('options').filter('.sub_' + this.value))
                            .change();
                    })

                    childOptions.not('.static, .sub_' + parent.val()).remove();

            }

            $(function(){
                cascadeForm = $('.cascadeTest');
                orgSelect = cascadeForm.find('.orgSelect');
                terrSelect = cascadeForm.find('.terrSelect');
                locSelect = cascadeForm.find('.locSelect');

                cascadeSelect(orgSelect, terrSelect);
                cascadeSelect(terrSelect, locSelect);
            });
        </script>
    </head>
    <body>
        <form action="#" class="cascadeTest">
            <table>
                <tr>
                    <th>Organization:</th>
                    <td>
                        <!--added an onchange event listener to call our function when the user has selected an option-->
                        <select name="orgSelect" id="org" class="orgSelect" onchange="javascript:orgDetails();">
                            <option value="0">Select a Category</option>
                            <option value="1">Cat1</option>
                            <option value="2">Cat2</option>
                            <option value="3">Cat3</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Territory:</th>
                    <td>
                         <!--added an onchange event listener to call our function when the user has selected an option-->
                        <select name="terrSelect" class="terrSelect" id="terrSelect" onchange="javascript:TerritoryDetails();">
                            <option value="0" class="static">- Select a Product-</option>
                            <option value="1" class="sub_1">Product 1</option>
                            <option value="2" class="sub_1">Product 2</option>
                            <option value="3" class="sub_2">Product 3</option>
                            <option value="4" class="sub_2">Product 4</option>
                            <option value="5" class="sub_3">Product 5</option>
                            <option value="6" class="sub_3">Product 6</option>
                            <option value="7" class="sub_3">Product 7</option>
                        </select>
                    </td>
                </tr>
            </table>
        </form>
                <div id="div1">
                    <p></p>
                </div>
                <div id="div2">
                    <p></p>
                </div>
    </body>
    </html>​​​​​ 
```

# java - android (maven, natty) 的编译速度非常慢

> ID：14014472
> 
> 赞同：2
> 
> 时间：2012-12-23T20:28:48.660
> 
> 标签：java, android, maven, dex, natty

我正在尝试在我的 Android 项目中使用[Natty](http://natty.joestelmach.com/) NLP 库。

我已经使用 Maven 在 IntelliJ 中建立了新的 hello world 项目（如[本文所述](http://4thline.org/articles/Building%20Android%20applications%20with%20Maven%20and%20IntelliJ.html)；刚刚下载了模板）并添加了 Natty 作为依赖项。

```
public void onCreate(Bundle savedInstanceState)
{
    Parser parser = new Parser();
    List<DateGroup> groups = parser.parse("two days after christmas at 19");

    for (DateGroup group: groups) {
        List<Date> dates = group.getDates();
        for (Date date: dates) {
            Log.e("DATE", date.toString());
        }
    }

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
} 
```

一切似乎都很好，它可以在适当的时间内解析日期......但编译需要将近 5 分钟！如果这是编译依赖项的一次性场景，那将是可以的。但是每次我在我的活动课上改变任何东西都需要 5 分钟。这是不可接受的。

IntelliJ 表示它花费最多时间“执行 DEX”。编译输出很多警告信息：

```
Information:Compilation completed successfully with 41 warnings in 4 min 47 sec
Information:0 errors
Information:41 warnings
Warning:Android Dex: [helloworld] warning: Ignoring InnerClasses attribute for an anonymous inner class
Warning:Android Dex: [helloworld] (org.apache.commons.logging.impl.LogFactoryImpl$1) that doesn't come with an
Warning:Android Dex: [helloworld] associated EnclosingMethod attribute. This class was probably produced by a
Warning:Android Dex: [helloworld] compiler that did not target the modern .class file format. The recommended
Warning:Android Dex: [helloworld] solution is to recompile the class from source, using an up-to-date compiler
Warning:Android Dex: [helloworld] and without specifying any "-target" type options. The consequence of ignoring
Warning:Android Dex: [helloworld] this warning is that reflective operations on this class will incorrectly
Warning:Android Dex: [helloworld] indicate that it is *not* an inner class.
Warning:Android Dex: [helloworld] (org.apache.commons.logging.impl.LogFactoryImpl$2) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.impl.LogFactoryImpl$3) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.impl.SimpleLog$1) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.impl.WeakHashtable$1) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$1) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$2) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$3) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$4) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$5) that doesn't come with an
Warning:Android Dex: [helloworld] (org.apache.commons.logging.LogFactory$6) that doesn't come with an
Warning:Android Dex: [helloworld] (antlr.build.ANTLR$1) that doesn't come with an
Warning:Android Dex: [helloworld] (antlr.debug.misc.ASTFrame$1) that doesn't come with an
Warning:Android Dex: [helloworld] (antlr.TokenStreamRewriteEngine$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.AbstractMap$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.AbstractMap$2) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.Collections$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$2) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$3) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$4) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$5) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.Executors$6) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$2) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$3) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$4) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$5) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$6) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.TimeUnit$7) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.helpers.ThreadHelpers$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.helpers.Utils$1) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.helpers.Utils$2) that doesn't come with an
Warning:Android Dex: [helloworld] (edu.emory.mathcs.backport.java.util.concurrent.locks.FIFOCondVar$1) that doesn't come with an 
```

有什么办法可以加快速度吗？也许`android:dex`不必每次都调用？或者也许有一种方法可以“正确地”编译依赖项？

这是我的`pom.xml`文件，如果有帮助的话：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>helloworld</artifactId>
    <version>1.0</version>

    <packaging>apk</packaging>
    <name>HelloWorld</name>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.source>5</maven.compiler.source>
        <maven.compiler.target>5</maven.compiler.target>
    </properties>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>4.2.0</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>com.joestelmach</groupId>
            <artifactId>natty</artifactId>
            <version>0.7</version>
        </dependency>
    </dependencies>

    <build>
        <!-- This should be just the artifact identifier, no version on the APK file,
             because this is what IntelliJ will use by default.
        -->
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>maven-android-plugin</artifactId>
                <version>2.6.0</version>
                <configuration>
                    <sdk>

                        <!-- Don't forget to set your ANDROID_HOME environment variable to your SDK directory! -->
                        <path>${env.ANDROID_HOME}</path>

                        <!-- Platform 8 is Android 2.2 -->
                        <platform>17</platform>

                    </sdk>

                    <!-- All of these go into the /src/main/android/ directory, we don't
                         want to polute the project root directory. -->
                    <androidManifestFile>${project.basedir}/src/main/android/AndroidManifest.xml</androidManifestFile>
                    <resourceDirectory>${project.basedir}/src/main/android/res</resourceDirectory>
                    <assetsDirectory>${project.basedir}/src/main/android/assets</assetsDirectory>
                    <nativeLibrariesDirectory>${project.basedir}/src/main/android/native</nativeLibrariesDirectory>
                    <resourceOverlayDirectory>${project.basedir}/src/main/android/overlay</resourceOverlayDirectory>

                    <!-- Read the Android Maven plugin documentation about these settings -->
                    <deleteConflictingFiles>true</deleteConflictingFiles>
                    <undeployBeforeDeploy>true</undeployBeforeDeploy>

                </configuration>
                <extensions>true</extensions>
            </plugin>
        </plugins>
    </build>

</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T11:03:57.157

尝试使用面向 Java 1.6 的库构建。我有类似的 jsch 问题，它是用 -target 15 (Java 1.5) 构建的，dx 抱怨 InnerClasses 旧格式等。你可以尝试在不指定 -target 选项的情况下重建这个库，javac 应该默认为你当前的 Java版本（可能是 1.6），然后将此库放入您的项目中。我试图搜索 mvn 选项以放入 pom.xml 以在编译时重建 lib，但不幸的是我没有找到任何解决方案。

# javascript - 使窗口加载等待javascript注入的内容

> ID：14014476
> 
> 赞同：0
> 
> 时间：2012-12-23T20:29:01.543
> 
> 标签：javascript, jquery, events, load, window

我已经构建了一个应用程序，可以在文档加载时提取内容，并注意到当页面初始内容加载时，窗口加载似乎触发了。是这样吗？是否有某种布尔魔法我可以投入到窗口加载事件中，让它等到初始内容和新内容完成？

这是我正在使用的

```
$doc.ready(function(){

    /* Pull in conditional content */
});
$win.load(function(){

    /* Fade page in once initial page content
    and conditional content have both loaded */
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T20:41:31.473

> 加载页面初始内容时，似乎会触发窗口加载。是这样吗？

是的，`window.onload`当加载 DOM 和所有资产（图像、CSS）时会触发该事件。

> 是否有某种布尔魔法我可以投入到窗口加载事件中，让它等到初始内容和新内容完成？

不，没有这样的魔法。我建议您从加载动态内容的操作的回调中淡入您的页面。

# php - PHP Mysql更新表中ID的位置和父级

> ID：14014478
> 
> 赞同：2
> 
> 时间：2012-12-23T20:29:14.257
> 
> 标签：php, mysql

请我有一个三列的表：

```
id   (this is the id of my table)
parent  (this is the parent)
position  (and this is the position) 
```

我有这个数组`$_arr['menu']`：

```
array (size=3)
  13 => 
    array (size=1)
      'parent' => string '0' (length=1)   
  14 => 
    array (size=1)  
      'parent' => string '13' (length=2) 
  25 => 
    array (size=1)  
      'parent' => string '0' (length=1) 
```

我想用数组**$_arr['menu']**中的这些值更新 may 表。

我想在一个查询中做类似的事情（也许使用案例）：

```
UPDATE table SET position = 1, parent = 0 WHERE id = 13;

UPDATE table SET position = 2, parent = 13 WHERE id = 14; 

UPDATE table SET position = 3, parent = 0 WHERE id = 25; 
```

请大师们，如何从该数组中获取这些值以及如何进行更新！

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:39:47.270

我不确定我有没有收到你的问题，但我会写下我的片段。（我不太记得php语法，也没有测试过，但我认为它显示了我想说的）

```
try {
    $db->beginTransaction();
    $increment = 0;
    foreach ($arr as $id => $innerArray) {
            $db->query("UPDATE table SET position = ".(++$increment).", parent = ".$innerArray['parent']." WHERE id =".$id);
    }
    $db->commit();
} catch (Exception $e) {
    $db->rollback();
} 
```

# html - 是否仍会下载带有解析为 false 的媒体查询的链接标签？

> ID：14014479
> 
> 赞同：4
> 
> 时间：2012-12-23T20:29:52.743
> 
> 标签：html, css, media-queries

给定以下链接标签：

```
<link rel="stylesheet" href="xlarge.css" media="max-width: 70em" />
<link rel="stylesheet" href="large.css" media="max-width: 60em" />
<link rel="stylesheet" href="medium.css" media="max-width: 50em" />
<link rel="stylesheet" href="small.css" media="max-width: 40em" />
<link rel="stylesheet" href="xsmall.css" media="max-width: 30em" />
<link rel="stylesheet" href="retina.css" media="(-webkit-min-device-pixel-ratio: 2)" /> 
```

在初始加载时，是否所有这六个样式表都已下载，或者只是那些媒体查询已解析为 true 的样式表？例如，如果我在一个支持视网膜的浏览器上计算到中等断点，它会只导致四个 http 请求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:46:21.390

无论媒体查询评估为真还是假，所有样式表都将被下载。即使您拥有的前五个媒体查询（由于表达式周围缺少括号而全部无效`max-width`）也不会阻止浏览器请求这些样式表。（无效的媒体查询只会自动解析为 false。）

在 CSS 中，媒体查询仅控制这些样式表中的 CSS 规则是否应用于您的页面，而不是样式表本身是否被请求。

# javascript - 下拉菜单，添加更多id

> ID：14014480
> 
> 赞同：0
> 
> 时间：2012-12-23T20:30:13.580
> 
> 标签：javascript, html

我复制了这个菜单：

```
http://50.112.96.159/wordpress/html/facebook_dropdown.html 
```

它工作正常，但我有疑问。

我想要多个菜单，例如：

```
<dl style="" class="dropdown">
                   <dt><a id="linkglobal" style="cursor:pointer;"></a></dt>
                    <dd>
                        <ul id="ulglobal">
                            <li><a href="#">Everyone</a></li>
                            <li><a href="#">Friends</a></li>
                            <li><a href="#">Only Me</a></li>
                            <li><a href="#">Customize</a></li>
                      </ul>
                   </dd>
                </dl>

<dl style="" class="dropdown">
                   <dt><a id="linkglobal" style="cursor:pointer;"></a></dt>
                    <dd>
                        <ul id="ulglobal">
                            <li><a href="#">Everyone</a></li>
                            <li><a href="#">Friends</a></li>
                            <li><a href="#">Only Me</a></li>
                            <li><a href="#">Customize</a></li>
                      </ul>
                   </dd>
                </dl> 
```

当我将#id 设置为时`<dt>`，菜单不起作用，我认为是因为 javascript。

有人可以帮我弄这个吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T01:30:09.100

好的-因此，如果您尝试设置两个不同的图像-我假设您正在谈论 privacyOff 和 privacyOn 图像，您需要像其他人建议的那样更改您的 html，首先具有唯一的 id，然后更改您的 css 以提供您想要的图像到那些 ids，比如：

html:

```
`<dt><a id="linkglobal" style="cursor:pointer;"></a>  ...</dt>` 
```

变成

```
`<dt><a id="linkglobalOne" style="cursor:pointer;"></a>  ...</dt>` 
```

和CSS：

```
.dropdown dt a {background:#EEEEEE url(/wordpress/images/privacyOff.png) no-repeat scroll right center;
display:block; width:40px; height:22px; cursor:pointer;} 
```

变成：

```
#linkglobalOne {background:#EEEEEE url(<IMAGE YOU WANT>.png) no-repeat scroll right center;
display:block; width:40px; height:22px; cursor:pointer;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:38:02.567

您提供的示例 URL 包含具有唯一 ID 的 A 和 UL 元素，但您的两个菜单的 ID 相同。浏览器将允许在文档中使用重复的 ID，但出于一些原因应该避免这种情况 - 但其中之一是 JavaScript 将按预期工作（对于多个 ID，无法保证 getElementById() 返回哪个元素）。

# web - 批处理文件使网站在所有浏览器中成为主页

> ID：14014484
> 
> 赞同：1
> 
> 时间：2012-12-23T20:30:32.397
> 
> 标签：web, batch-file

我一直在寻找如何做到这一点，但失败了。

我想要一个批处理文件来同时更改我所有浏览器（IE、Firefox 和 Chrome）的主页可能是什么？

希望能帮上忙，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T07:51:39.187

创建一个批处理文件

注册添加“HKCU\SOFTWARE\MICROSOFT\INTERNET EXPLORER\MAIN ” /V“开始页面” [/D“https://google.com/”/F](https://google.com/)

双击它会在 Internet Explorer 中创建主页

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T06:52:21.647

**在 Internet Explorer 中：**

你可以这样做：

```
REG ADD "HKCU\Software\Microsoft\Internet Explorer\Main" /V "Start Page" /D "http://www.google.com/" /F 
```

**在火狐中：**

FF 使用 JavaScript（您的 FireFox 用户配置文件中的 prefs.js）而不是注册表项。

您需要做的是以编程方式编辑目录 C:\Users\ [USERNAME]\AppData\Roaming\Mozilla\Firefox\Profiles\ [子文件夹] 中的 Firefox 用户配置文件中的 prefs.js 文件

您将需要添加或编辑如下所示的行： user_pref("browser.startup.homepage", "www.google.com"); 作为：

```
@Echo off

taskkill /im firefox.exe* /f

cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default
set ffile=%cd%
echo user_pref("browser.startup.homepage", "https://www.google.com");>>"%ffile%\prefs.js"
set ffile=
cd %windir% 
```

**使用 JavaScript 的另一个选项是：**

您可以通过设置首选项“browser.startup.homepage”来更改 Firefox 主页

通过 JavaScript 在附加组件中执行此操作的最简单方法是：

```
Components.utils.import("resource://gre/modules/Services.jsm");

Services.prefs.setCharPref("browser.startup.homepage", "http://www.google.com"); 
```

**在谷歌浏览器中：**

chrome 设置位于 %USERPROFILE%\Local Settings\Application Data\Google\Chrome\User Data.ChromotingConfig.json 中，并且有点加密。

但是您可以通过将以下 javascript 粘贴到“主页”首选项字段（在您的 Chrome 选项下）来解决问题，并且在单击“主页”按钮时它会按预期工作。

```
javascript:(function(){ window.location.href='http://www.google.com/';})(); 
```

# php - jquery 发布表单

> ID：14014485
> 
> 赞同：0
> 
> 时间：2012-12-23T20:30:51.053
> 
> 标签：php, jquery, jquery-post

我有这个代码用于使用 jquery 发送简单数据，但没有工作，一直重新加载页面并且没有加载我通过邮寄发送的内容

**我的代码是这样的：**

```
<script>
$(document).ready(function() {

    $("#form_order").submit( function () {    
        $.ajax({   
            type: "POST",
            data : $(this).serialize(),
            cache: false,  
            url: "indexer_adm.php?send_order2=ok",   
            success: function(data){
                $("#load_order").html(data);                          
            }   
        });   
        return false;     
    });
</script>

<form name="forma" id="form_order" method="post" action="">
<table width="100%" border="1">
<tr>
<td height="30" align="center" valign="middle">
<select name="select_order">
<option value="articles">Articles</option>
<option value="blogs">Blogs</option>
<option value="products">Products</option>
</select>
<input type="submit" name="Submit" value="Acceder">
<input type="hidden" name="send_order2" value="ok"> 
<input type="hidden" name="action_load" value="<?php echo $_REQUEST['action_load'];?>">
</td>
</tr>
<tr>
<td height="30" align="center" valign="middle">&nbsp;</td>
</tr>
</table>
</form>

<div id="load_order"></div> 
```

在名为 load_order 的 div 中，它必须从表单加载此通过邮寄发送的结果，但是页面重新加载并且不起作用，我多次看到代码但我不明白发生了什么

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:38:36.257

您的代码中存在语法错误，您尚未关闭提交处理程序。

```
$(document).ready(function() {
    $("#form_order").submit( function () {    
        $.ajax({   
            type: "POST",
            data : $(this).serialize(),
            cache: false,  
            url: "indexer_adm.php?send_order2=ok",   
            success: function(data){
                $("#load_order").html(data);                          
            }   
        });   
        return false;     
    }); // <---
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:33:22.640

尝试在块内返回 false `submit`，而不是在`ready`块内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:42:06.087

您可能会遇到语法错误，因为`return false`应该停止刷新表单。我会改用 post 函数：

```
<script>
  $(function() {

    $("#form_order").submit( function () {    
     $.post('indexer_adm.php?send_order2=ok',  $(this).serialize(), function(data) {
        $("#load_order").html(data);  
     });
     return false;   

});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:43:20.677

行 ！！！， 谢谢大家

正确的代码：

```
<script>
$(document).ready(function() {
/*
$("#load_order").show(1000);
$("#load_order").load("<?php print "".$ruta_path_adm."".$ruta_modulos."/mod_order/indexer_adm.php?send_order2=ok";?>");
*/

$("#form_order").submit( function () {    
                        $.ajax({   
                            type: "POST",
                            data : $(this).serialize(),
                            cache: false,  
                            url: "<?php print "".$ruta_path_adm."".$ruta_modulos."/mod_order/indexer_adm.php?send_order2=ok";?>",   
                            success: function(data){
                                $("#load_order").html(data); 

                            }   
                        });   

                        return false; 
                         }); 

});
</script> 
```

谢谢你的帮助，我把脚本弄坏了，没有看到这个，谢谢

# mapreduce - 安排 Amazon 的 Elastic MapReduce 作业的工具/方法

> ID：14014486
> 
> 赞同：3
> 
> 时间：2012-12-23T20:30:51.793
> 
> 标签：mapreduce, hadoop-streaming, elastic-map-reduce, emr

我使用 EMR 创建新实例并处理作业，然后关闭实例。

我的要求是定期安排工作。一种简单的实现方式是使用石英来触发 EMR 作业。但从长远来看，我有兴趣使用开箱即用的 mapreduce 调度解决方案。我的问题是 EMR 或 AWS-SDK 是否提供任何开箱即用的调度功能，我可以使用它来满足我的要求吗？我可以看到 Auto Scaling 中有调度，但我想改为调度 EMR 作业流。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:32:29.297

有[Apache Oozie Workflow Scheduler for Hadoop](http://oozie.apache.org/)可以做到这一点。

> Oozie 是一个用于管理 Apache Hadoop 作业的工作流调度系统。
> 
> Oozie 工作流作业是动作的有向无环图 (DAG)。
> 
> Oozie 协调器作业是由时间（频率）和数据可用性触发的周期性 Oozie 工作流作业。
> 
> Oozie 与 Hadoop 堆栈的其余部分集成，支持开箱即用的多种 Hadoop 作业（例如 Java map-reduce、Streaming map-reduce、Pig、Hive、Sqoop 和 Distcp）以及系统特定作业（例如Java 程序和 shell 脚本）。
> 
> Oozie 是一个可扩展、可靠和可扩展的系统。

这是用于配置 apache oozie 的 Elastic Map Reduce 引导操作的简单示例：[https ://github.com/lila/emr-oozie-sample](https://github.com/lila/emr-oozie-sample)

但是要让您知道 oozie 有点复杂，当且仅当您有很多工作要安排/监控/维护时，那么只有您应该去做，否则如果您说只有 2 或 3 个工作，则`oozie`只需创建一堆工作`cron`定期安排的工作。

您还可以查看和探索[来自 Amazon 的简单工作流程](http://aws.amazon.com/swf/)。

# java - 更改 x 轴的日期时间格式？

> ID：14014487
> 
> 赞同：0
> 
> 时间：2012-12-23T20:31:16.693
> 
> 标签：java, android, teechart

我有`TChart`一个区域系列。区域点映射到日期时间值。如何更改 x 轴上日期标签的格式？

这不起作用：

```
area.add(new DateTime(timestamp), value); // Date value!
...
chart.getAxes().getBottom().getLabels().setDateTimeFormat("MMM 'yy"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T14:29:47.367

这给了我一个 IllegalArgumentException：

```
new DateTime(2012,1,1).toString("MMM 'yy"); 
```

不接受字符串格式参数中的逗号**'**。

正如您可以[在此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)阅读的，单引号用于避免解释。放两个单引号画一个单引号：

```
new DateTime(2012,1,1).toString("MMM ''yy"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T11:42:33.520

您需要像下一行代码一样将区域的 XValues 设置为 DateTime：

```
area.getXvalues().setDateTime(true); 
```

如果添加我的代码行可以帮助您解决问题，请再试一次。

我希望会有所帮助。

谢谢，

# uml - 如何在 Enterprise Architect 中显示关系

> ID：14014494
> 
> 赞同：5
> 
> 时间：2012-12-23T20:32:22.230
> 
> 标签：uml, case, relationship, diagram, enterprise-architect

我使用 Enterprise Architect 创建了一个简单的类图。我不知道该怎么做是让它显示1对1等关系......

看起来很简单，但这个程序根本不是用户友好的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T21:17:31.760

实际上它相当简单——对于类图和对象图，您都可以使用工具箱中的“关联”。然后，如果您双击关联，您将能够在“源角色”和“目标角色”选项卡下输入多重性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-10T07:22:37.240

在关联属性对话框中，转到目标和源角色部分。在那里您会找到要填写的多重性字段。您也可以在图表上的关联末端附近单击鼠标右键，然后从上下文菜单中选择“多重性”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-08T10:08:40.693

当你绘制两个类并在它们之间放置关联连接器时，你应该右键单击关联，你会看到多重性，但你应该在关联线上的任何类附近进行这项工作。

# android - SharedPreferences 不保存/持久化

> ID：14014496
> 
> 赞同：3
> 
> 时间：2012-12-23T20:32:46.600
> 
> 标签：android, sharedpreferences

我不明白为什么我的复选框首选项未保存或未正确读取。我在 AndroidManifest.xml 中有以下代码：

```
<activity android:name=".Preferences" /> 
```

然后在 res/xml/preferences.xml

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen 
    xmlns:android="http://schemas.android.com/apk/res/android"> 
<PreferenceCategory 
    android:title="Preferences">
   <CheckBoxPreference 
       android:title="Always Run"
       android:key="@string/pref_always_run_key" 
       android:summary="Always run it" />
</PreferenceCategory> 
```

在 res/values/strings.xml

```
<string name="pref_always_run_key">always_run_default</string> 
```

然后我有一个 src/com.name/Preferences.java 文件

```
public class Preferences extends PreferenceActivity
{
private static final String LOG_TAG = Preferences.class.getSimpleName() + "_LOG";

@SuppressWarnings("deprecation")
@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.preferences); //5

    //getPreferenceManager().setSharedPreferencesName();

    CheckBoxPreference alwaysRunCheckBox = (CheckBoxPreference)findPreference(getString(R.string.pref_always_run_key));// 8

    alwaysRunCheckBox.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener()
    {

        @Override
        public boolean onPreferenceChange(Preference preference, Object newValue)
        {

            Log.d(LOG_TAG, "User set always run to " + newValue.toString().equals("true"));
            return true;
        }
    });
}
} 
```

然后我在 MainActivity.java 中有一个测试按钮

```
SharedPreferences prefs = MainActivity.this.getSharedPreferences("com.projname.Preferences", Context.MODE_PRIVATE);
            String defaultAlwaysRunKey = MainActivity.this.getResources().getString(R.string.pref_always_run_key);
            Log.d(LOG_TAG, "Always run key is " + defaultAlwaysRunKey);
            boolean run = prefs.getBoolean(defaultAlwaysRunKey, false);
                            Log.d(LOG_TAG, "It contains the key: " + prefs.contains(defaultAlwaysRunKey));
            Log.d(LOG_TAG, "Always run set to " + run);
Log.d(LOG_TAG, "All the preferences saved are: " + prefs.getAll().toString()); 
```

输出总是：

```
10-25 16:15:50.844: D/MainActivity_LOG(1219): Clicked on test...
10-25 16:15:50.844: D/MainActivity_LOG(1219): Always run key is always_run_default
10-25 16:15:50.844: D/MainActivity_LOG(1219): It contains the key: false
10-25 16:15:50.844: D/MainActivity_LOG(1219): Always run set to false
10-25 16:15:50.855: D/MainActivity_LOG(1219): All the preferences saved are: {} 
```

不管复选框是否被选中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:49:28.533

我认为您的问题是您读取的首选项文件不同于您写入的首选项文件。您按名称读取，但写入默认值。

尝试将 MainActivity 分配更改为

```
SharedPreferences prefs =
   PreferenceManager.getDefaultSharedPreferences(MainActivity.this); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-23T20:45:27.300

您忘记使用 SharedPreference 的编辑器并调用`commit();`编辑器对象的方法。

```
CheckBoxPreference alwaysRunCheckBox = (CheckBoxPreference)findPreference(getString(R.string.pref_always_run_key));// 8

    alwaysRunCheckBox.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener()
    {

        @Override
        public boolean onPreferenceChange(Preference preference, Object newValue)
        {

            boolean val = Boolean.parseBoolean(newValue.toString());

            Editor e = preference.getEditor();
            e.putBoolean(getString(R.string.pref_always_run_key), val );
            e.commit();
            Log.d(LOG_TAG, "User set always run to " + String.valueOf(val));

            return true;

        }
    }); 
```

# python - Python：快速下载多个文件

> ID：14014498
> 
> 赞同：3
> 
> 时间：2012-12-23T20:33:07.863
> 
> 标签：python, multithreading, python-2.7, download, urllib

在 Python 中如何快速下载一堆文件？`urllib.urlretrieve()`速度很慢，我不太确定该怎么做。

我有一个包含 15-20 个文件的列表要下载，而且下载一个文件需要很长时间。每个文件大约 2-4 mb。

我以前从来没有这样做过，我不确定我应该从哪里开始。我应该使用线程并一次下载几个吗？或者我应该使用线程来下载每个文件的片段，但一次下载一个文件，还是应该使用线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-10-19T04:20:15.723

尝试使用 python 的 wget 模块。这是一个代码片段。

```
import wget
wget.download(url, out = path) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:35:19.350

> urllib.urlretrieve() 非常慢

真的吗？如果您有 15-20 个文件，每个文件大小为 2-4mb，那么我只需将它们排成一行并下载它们。瓶颈将成为您的服务器和您自己的带宽。所以恕我直言，在这种情况下几乎不值得线程或尝试任何聪明的东西......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:43:53.423

一种解决方案（不是 Python 特定的）是将下载 URL 保存在另一个文件中，然后使用下载管理器程序（例如[wget](http://www.gnu.org/software/wget/)或[aria2](http://aria2.sourceforge.net/) ）下载它们。您可以从 Python 程序调用下载管理器。

但正如@Jon 所提到的，这对于您的情况并不是必需的。`urllib.urlretrieve()`就够了！

另一种选择是使用[Mechanize](http://wwwsearch.sourceforge.net/mechanize/)下载文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T20:39:35.017

[stream.py](https://github.com/aht/stream.py)是一个基于数据流编程思想的并行 python（通过线程或进程）的有点实验性但可爱的 UI：示例中提供了一个 URL-retriever：

*   [https://github.com/aht/stream.py/blob/master/example/retrieve_urls.py](https://github.com/aht/stream.py/blob/master/example/retrieve_urls.py)

因为它很短：

```
#!/usr/bin/env python

"""
Demonstrate the use of a ThreadPool to simultaneously retrieve web pages.
"""

import urllib2
from stream import ThreadPool

URLs = [
    'http://www.cnn.com/',
    'http://www.bbc.co.uk/',
    'http://www.economist.com/',
    'http://nonexistant.website.at.baddomain/',
    'http://slashdot.org/',
    'http://reddit.com/',
    'http://news.ycombinator.com/',
]

def retrieve(urls, timeout=30):
    for url in urls:
        yield url, urllib2.urlopen(url, timeout=timeout).read()

if __name__ == '__main__':
    retrieved = URLs >> ThreadPool(retrieve, poolsize=4)
    for url, content in retrieved:
        print '%r is %d bytes' % (url, len(content))
    for url, exception in retrieved.failure:
        print '%r failed: %s' % (url, exception) 
```

您只需要替换`urllib2.urlopen(url, timeout=timeout).read()`为`urlretrieve...`.

# c# - 在文件中查找特定文本并将其替换

> ID：14014509
> 
> 赞同：0
> 
> 时间：2012-12-23T20:34:38.960
> 
> 标签：c#, wpf, replace

我正在构建一个 WPF 程序，它正在为模拟程序编辑保存文件，以便更容易调整某些参数。该（txt）文件的结构如下所示

```
{Verdieping 1}

A bunch of data

'Max'
15
20
10
]);

More data

{Verdieping 2}

A bunch of data

'Max'
25
10
40
20
]);

More data

{Verdieping 3}

etc. 
```

因为我需要的列表的名称总是'Max'我不能使用`Replace("Old_Value", "New_Value");`所以我需要找到标题{Verdieping 1}然后寻找'Max'并写下值直到它到达*“]）;”*所以我结束用这样的东西：

```
Verdieping_1[0] = 15
Verdieping_1[1] = 20
Verdieping_1[0] = 10

Verdieping_2[0] = 25
Verdieping_2[1] = 10
Verdieping_2[2] = 40
Verdieping_2[3] = 20 
```

然后，当我更改这些值时，我需要将它们写回到正确位置的文件中。现在我正在使用这段代码来读取并最终写入新文件：

```
var Model = System.IO.File.ReadAllText(@"C:\Base_Model.txt");

//format code here...

System.IO.File.WriteAllText(@"C:\New_Model.txt", Model); 
```

有人可以就如何最好地解决这个问题给我一些提示或帮助吗？

**编辑** 这是我要编辑的文件的实际文件结构：

```
{Atom: Verdieping 2}

int015(0, 64, [ 
1
2
3
]);
int015(1, 64, [`ActivityID`
20
21
33
]);
int015(2, 64, [`vtp`
139830296
189540320
169919424
]);
int015(3, 64, [`%`
100
100
100
]);
int015(4, 64, [`Max`
15
5
20
]);
int015(5, 64, [`Fill (1 = fill, 0 = empty)`
1
1
0
]);
SetStatus(0);
int018;

{Atom: Verdieping 2}

int015(0, 64, [ 
1
2
3
]);
int015(1, 64, [`ActivityID`
22
23
24
]);
int015(2, 64, [`vtp`
166058172
165557860
155960564
]);
int015(3, 64, [`%`
100
100
100
]);
int015(4, 64, [`Max`
15
20
10
]);
int015(5, 64, [`Fill (1 = fill, 0 = empty)`
0
1
1
]);
SetStatus(0);
int018; 
```

我之前所说的“Max”实际上被称为：int015(4, 64, [`Max`

正如你所看到的，每个层的名称都是相同的，变量的数量是不同的。

感谢你目前的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:59:26.300

```
var result = Regex.Matches(File.ReadAllText(fileName), @"\[`Max`(.*?)\]", RegexOptions.Singleline)
            .Cast<Match>()
            .Select(m => m.Groups[1].Value.Split(" \t\n\r".ToArray(), StringSplitOptions.RemoveEmptyEntries))
            .ToList();

foreach (var v in result)
{
    Console.WriteLine(String.Join(", ", v));
} 
```

输出：

```
15, 5, 20
15, 20, 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:36:50.053

```
 string LoadedFile = File.ReadAllText(@"C:\Base_Model.txt");
        StringBuilder result = new StringBuilder();
        for (int i = 1; i < Int32.MaxValue; i++)
        {
            Match ma = Regex.Match(LoadedFile, "Verdieping " + i.ToString() + ".+?'Max'.*?([0-9].+?)[]][)];", RegexOptions.Singleline);
            if(!ma.Success)
            {
                break;
            }
            string a = ma.Result("$1");
            MatchCollection mc = Regex.Matches(a, "(\\d+?)\r\n", RegexOptions.Singleline);

            for (int j = 0; j < mc.Count; j++)
            {
                result.AppendLine(String.Format("Verdieping_{0}[{1}] = {2}", i, j, mc[j].Result("$1")));
            }
            result.AppendLine(String.Empty);
        }

        File.WriteAllText(@"C:\New_Model.txt", result.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T22:18:14.593

您可以初始化一个新`List`的，`string`其中将包含所需的输出。然后，读取文件，获取目标部分之间的信息，并将值插入`[`到`]);`of`List`之间`string`。

**例子**

```
static List<string> ReadFile(string Path, string Section)
{
    #region Declare Variables
    string[] Lines = File.ReadAllLines(Path); //Read Path into Lines
    int CurrentValue = 1; //Declare CurrentValue as an Integer of value 1
    List<string> RequiredValues = new List<string>(); //Initialize a new List of string of name RequiredValues
    #endregion
    #region Collect Information
    //Look through the section getting the data between [ and ]);
    for (int i = 0; i < Lines.Length; i++)
    {
        if (Lines[i].StartsWith("{" + Section + "}"))
        {
            i++;
            while (!Lines[i].StartsWith("{") && !Lines[i].EndsWith("}"))
            {
                i++;
                if (Lines.Length > i)
                {
                    if (Lines[i].Contains('['))
                    {
                        while (true)
                        {

                            i++;
                            if (Lines[i].Contains("]);"))
                            {
                                break;
                            }
                            RequiredValues.Add(Section + "[" + CurrentValue.ToString() + "] = " + Lines[i]);
                            CurrentValue++;
                        }
                    }
                    RequiredValues.Add("");
                }
                else
                {
                    break; //Reached the end of the document
                }
            }
        }
    }
    #endregion
    return RequiredValues; //Return RequiredValues
}
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    List<string> Contents = ReadFile(@"C:\Base_Model.txt", "Atom: Verdieping 2");
    foreach (string str in Contents)
    {
        System.Diagnostics.Debug.WriteLine(str); //Write str to the trace listeners
    }
} 
```

^(**样本输入**)

```
{Atom: Verdieping 2}

int015(0, 64, [ 
4
5
6
]);
int015(1, 64, [`ActivityID`
20
21
33
]);
int015(2, 64, [`vtp`
139830296
189540320
169919424
]);
int015(3, 64, [`%`
100
100
100
]);
int015(4, 64, [`Max`
15
5
20
]);
int015(5, 64, [`Fill (1 = fill, 0 = empty)`
1
1
0
]);
SetStatus(0);
int018;

{Atom: Verdieping 1}

int015(0, 64, [ 
1
2
3
]);
int015(1, 64, [`ActivityID`
22
23
24
]);
int015(2, 64, [`vtp`
166058172
165557860
155960564
]);
int015(3, 64, [`%`
100
100
100
]);
int015(4, 64, [`Max`
15
20
10
]);
int015(5, 64, [`Fill (1 = fill, 0 = empty)`
0
1
1
]);
SetStatus(0);
int018; 
```

^(**样本输出**)

以下是从阅读中返回的`Atom: Verdieping 2`

```
Atom: Verdieping 2[1] = 4
Atom: Verdieping 2[2] = 5
Atom: Verdieping 2[3] = 6

Atom: Verdieping 2[4] = 20
Atom: Verdieping 2[5] = 21
Atom: Verdieping 2[6] = 33

Atom: Verdieping 2[7] = 139830296
Atom: Verdieping 2[8] = 189540320
Atom: Verdieping 2[9] = 169919424

Atom: Verdieping 2[10] = 100
Atom: Verdieping 2[11] = 100
Atom: Verdieping 2[12] = 100

Atom: Verdieping 2[13] = 15
Atom: Verdieping 2[14] = 5
Atom: Verdieping 2[15] = 20

Atom: Verdieping 2[16] = 1
Atom: Verdieping 2[17] = 1
Atom: Verdieping 2[18] = 0 
```

以下输出是从阅读中返回的`Atom: Verdieping 1`

```
Atom: Verdieping 1[1] = 1
Atom: Verdieping 1[2] = 2
Atom: Verdieping 1[3] = 3

Atom: Verdieping 1[4] = 22
Atom: Verdieping 1[5] = 23
Atom: Verdieping 1[6] = 24

Atom: Verdieping 1[7] = 166058172
Atom: Verdieping 1[8] = 165557860
Atom: Verdieping 1[9] = 155960564

Atom: Verdieping 1[10] = 100
Atom: Verdieping 1[11] = 100
Atom: Verdieping 1[12] = 100

Atom: Verdieping 1[13] = 15
Atom: Verdieping 1[14] = 20
Atom: Verdieping 1[15] = 10

Atom: Verdieping 1[16] = 0
Atom: Verdieping 1[17] = 1
Atom: Verdieping 1[18] = 1 
```

**注意**：使用此方法，即使您有两个同名的部分，应用程序也只会收集它遇到的第一个部分之间的信息。

谢谢，
我希望你觉得这有帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:11:10.077

也许正则表达式？我做了这个快速的回答，但是不应该复制粘贴；你可以考虑结果。

在这个答案中，我希望您的数组按时间顺序排列，以防止源代码太长太乱。

我为“DataContainer”对象读取的文件看起来与下面的文件相同：

```
{Verdieping 1}

A bunch of data

'Max'
15
20
10
]);

More data

{Verdieping 2}

A bunch of data

'Max'
25
10
40
20
]); 
```

首先我在字符串中找到每个'Max'然后我把下面的所有数据打印出来

用于查找此内容的正则表达式是：`\'Max\'.*?\]\);`

试试这段代码看看结果

```
// fill our container
            string DataContainer = string.Empty;
            using (StreamReader sr = new StreamReader(Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "TestFile.txt"))) {
                DataContainer = sr.ReadToEnd();
            }

            // print data
            Match regMatch = Regex.Match(DataContainer, @"\'Max\'.*?\]\);", RegexOptions.Singleline);
            int verdiepc = 0;
            while (regMatch.Success) {
                string[] Data = regMatch.Value.Replace("\r", "").Split('\n');

                for (int I = 1; I < Data.Length - 1; I++) {
                    Console.WriteLine("Verdieping_{0}[{1}] = {2}"
                        , verdiepc, I, Data[I]);
                }
                Console.Write("\n");

                verdiepc ++;
                regMatch = regMatch.NextMatch();
            }

            // prevent immidiate exit
            Console.ReadKey(); 
```

输出将是：

```
Verdieping_0[1] = 15
Verdieping_0[2] = 20
Verdieping_0[3] = 10

Verdieping_1[1] = 25
Verdieping_2[2] = 10
........ etc.. 
```

我希望你可以使用这个答案。这是如何使用正则表达式解析文件的草图

# jsf - PrimeFaces p:fileUpload 不调用方法

> ID：14014514
> 
> 赞同：2
> 
> 时间：2012-12-23T20:35:14.387
> 
> 标签：jsf, file-upload, primefaces

我正在尝试使用 PrimeFaces `<p:fileUpload>`。[我已经设置好了，与展示示例](http://www.primefaces.org/showcase/ui/fileUploadMultiple.jsf)非常相似，但它不起作用。我从来没有收到成功的消息。我没有得到任何错误或任何东西。

这是我的`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>javax.faces.PROJECT_STAGE</param-name>
        <param-value>Development</param-value>
    </context-param>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
    </servlet-mapping>
    <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
        <init-param>
            <param-name>thresholdSize</param-name>
            <param-value>51200</param-value>
        </init-param>
        <init-param>
            <param-name>uploadDirectory</param-name>
            <param-value>C:\etc</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>faces/index.xhtml</welcome-file>
    </welcome-file-list>
</web-app> 
```

这是视图：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <h:head></h:head>

    <h:form enctype="multipart/form-data">
        <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                      mode="advanced" 
                      update="messages"
                      sizeLimit="100000" 
                      allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>

        <p:growl id="messages" showDetail="true"/>
    </h:form>

</html>

    </h:form>
  </h:body> 
```

这是豆子：

```
package fileUpload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import org.primefaces.event.FileUploadEvent;

@ManagedBean(name = "fileUploadController")
public class fileUploadController {

    private String destination = "c:\test";

    public void upload(FileUploadEvent event) {
        FacesMessage msg = new FacesMessage("Success! ", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        // Do what you want with the file        
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(destination + fileName));

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();

            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
} 
```

我错过了什么？

```
WARNING: PWC4011: Unable to set request character encoding to UTF-8 from context /FileUpload, because request parameters have already been read, or ServletRequest.getReader() has already been called
WARNING: /index.xhtml @15,63 fileUploadListener="#{fileUploadController.handleFileUpload(event)}": Method handleFileUpload not found
javax.el.MethodNotFoundException: /index.xhtml @15,63 fileUploadListener="#{fileUploadController.handleFileUpload(event)}": Method handleFileUpload not found
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:109)
    at org.primefaces.component.fileupload.FileUpload.broadcast(FileUpload.java:279)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:759)
    at javax.faces.component.UIViewRoot.processDecodes(UIViewRoot.java:935)
    at com.sun.faces.lifecycle.ApplyRequestValuesPhase.execute(ApplyRequestValuesPhase.java:78)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:77)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722). 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T21:34:15.120

例外是不言自明的。

> javax.el.MethodNotFoundException: /index.xhtml @15,63 fileUploadListener="#{fileUploadController.handleFileUpload(event)}": 找不到方法句柄文件上传

这种方法确实不存在。而是这个：

```
public void upload(FileUploadEvent event) { 
```

使用`#{fileUploadController.upload}`或将方法重命名为`handleFileUpload`.

# knockout.js - 从 SQL Server Compact 检索 DateTime 值时出现“无效日期”错误

> ID：14014517
> 
> 赞同：3
> 
> 时间：2012-12-23T20:35:30.487
> 
> 标签：knockout.js, sql-server-ce, asp.net-web-api, singlepage, breeze

我在Breeze + Knockout + WebAPI + SQL Server Compact的一个简单项目中遇到了以下问题：

当我添加一个`Breeze`实体（带有`DateTime` `ko.observable`）并将`Manager.SaveChanges()`行正确保存到 SQL Server Compact 中时，该`DateTime`列的格式如下：`23/12/2012 19.56.33`.

当我随后进行`Breeze`查询时，我得到了该行，但`DateTime`无法识别该值：

> *失效日期*

该`date`字段是可观察的，因此我无法调试值/格式，这是一种方法！

在`SaveChanges`它采用这种格式之前：`Sun Dec 23 21:32:05 UTC+0100 2012`

在`SaveChanges`我以这种格式在 SQL Server Compact 表中找到它之后：`23/12/2012 20.32.05`

也许也`Breeze`期望它在UTC ..？

任何帮助是极大的赞赏！

谢谢

**编辑：**

这是从 WebApi BreezeController 返回的 json：

```
[
   {
      "$id":"1",
      "$type":"MvcTask.Models.Task, MvcTask",
      "id":110,
      "text":"aaa",
      "done":false,
      "created":"2012-12-23T19.56.33.950"
   }
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T00:48:10.920

早期版本的微风有这个问题，但应该在以后的版本中修复。您可以尝试当前版本 v.80.1 吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-23T22:24:32.960

您的问题与默认日期格式化程序有关，它没有为您提供您正在寻找的内容。看起来您正在以 UTC 格式接收数据，而您的代码并不期望这样。

看看[JSON 中的 ASP.NET Web API 日期格式没有成功序列化](https://stackoverflow.com/questions/12936614/asp-net-web-api-date-format-in-json-does-not-serialise-successfully)。

他们有类似的问题，但展示了如何自定义序列化程序。我过去做过这种技术，它解决了我的问题

# ruby-on-rails-3 - Passbook IOS6 向 Rails 3.0.3 服务器发送 HTTP DELETE，没有路由匹配

> ID：14014521
> 
> 赞同：0
> 
> 时间：2012-12-23T20:36:33.483
> 
> 标签：ruby-on-rails-3, http, ios6, passbook

当 iOS6 上的 Passbook 向我的服务器发送 HTTP DELETE 路由时，我得到“无路由匹配”。

在 config/routes.rb 中，路由如下所示：

```
delete       "/v1/devices/:device_id/registrations/:pass_type_id/:serial_number" => "registrations#destroy" 
```

当我运行“rake routes”时，我可以看到路线在那里：

```
 DELETE /v1/devices/:device_id/registrations/:pass_type_id/:serial_number(.:format) {:controller=>"registrations", :action=>"destroy"} 
```

但是当路由进入 Rails 3.0.3 开发服务器时

```
Started DELETE "/v1/devices/515a5c955dcdd66f558e1b4041392bf3/registrations/pass.com.myserver.FreeDrink/11" for 192.168.0.22 at 2012-12-23 15:03:25 -0500 
```

导轨服务器说：

```
 ActionController::RoutingError (No route matches "/v1/devices/515a5c955dcdd66f558e1b4041392bf3/registrations/pass.com.myserver.FreeDrink/11"):
actionpack (3.0.3) lib/action_dispatch/middleware/show_exceptions.rb:53:in `call'
railties (3.0.3) lib/rails/rack/logger.rb:13:in `call'
rack (1.2.4) lib/rack/runtime.rb:17:in `call'
activesupport (3.0.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.2.4) lib/rack/lock.rb:11:in `block in call'
<internal:prelude>:10:in `synchronize'
rack (1.2.4) lib/rack/lock.rb:11:in `call'
actionpack (3.0.3) lib/action_dispatch/middleware/static.rb:30:in `call'
railties (3.0.3) lib/rails/application.rb:168:in `call'
railties (3.0.3) lib/rails/application.rb:77:in `method_missing'
railties (3.0.3) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.2.4) lib/rack/content_length.rb:13:in `call'
rack (1.2.4) lib/rack/handler/webrick.rb:52:in `service'
/home/user/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/home/user/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/home/user/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

使用 HTTP GET 和 POST 的所有其他路由都可以正常工作。这是我唯一遇到问题的路线。我知道有些浏览器不发送 HTTP DELETE，只发送 HTTP GET 和 HTTP POST，并且 rails 在标头中放置了一些内容以指示请求是删除，但是发送 HTTP DELETE 请求的是 Passbook，所以我不不知道这是否与问题有关。

我还在 config/routes.rb 中尝试了其他风格的路由，例如：

匹配 "/v1/devices/:device_id/registrations/:pass_type_id/:serial_number" => "registrations#destroy", :via => :delete

我也尝试过使用其他控制器。

任何人都知道为什么当请求是 HTTP DELETE 时 Rails 会说“没有路由匹配”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:34:21.697

[我终于通过使用这篇文章](https://github.com/xtremelabs/xl-passbook-ruby/blob/master/config/routes.rb)中的路线获得了删除路线

```
 delete       "/v1/devices/:device_id/registrations/:pass_type_id/:serial_number" => "users#delete_pass", :constraints => { :pass_type_id => /[^\/]+/ } 
```

其中添加了约束：

```
:constraints => { :pass_type_id => /[^\/]+/ } 
```

# java - GrahicsDevice 和 JOptionPane 问题

> ID：14014523
> 
> 赞同：1
> 
> 时间：2012-12-23T20:36:46.837
> 
> 标签：java, swing, jframe, jpanel, joptionpane

当我单击按钮时，设置为全屏的应用程序将转到任务栏/最小化，因此我需要先在任务栏中单击它，然后才能看到`JOptionPane`我触发的。你认为这有什么问题？我希望它能够顺利运行，而不会被最小化或进入任务栏。

```
public static void main(String[] args) {
        final JFrame frame = new JFrame();
        frame.setTitle("Sample");
        GraphicsDevice device = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
        device.setFullScreenWindow(frame);
        device.setDisplayMode(new DisplayMode(800, 600, 32, 60)); 
        frame.setVisible(true);

        JButton btn = new JButton();
        btn.setText("Btn");
        JPanel panel = new JPanel();

        panel.add(btn);
        frame.add(panel);

        btn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                JOptionPane.showMessageDialog(frame, "Sample");
                throw new UnsupportedOperationException("Not supported yet.");
            }

        });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:30:58.880

我能想到的唯一解决方法是添加一个`WindowAdpater`将`JFrame`覆盖的`windowIconified(..)`。还有一个`boolean`用作程序标志，用于知道窗口何时因`JOptionPane`显示而被图标化。

虽然它真的很hacky，只有在几次屏幕闪烁之后，我们才能看到它们很好地协同工作`JOptionPane`。`JFrame`

这是代码：

```
import java.awt.DisplayMode;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Test {

    private static boolean programmatic = false;

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                final JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setTitle("Sample");
                GraphicsDevice device = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
                device.setFullScreenWindow(frame);
                device.setDisplayMode(new DisplayMode(800, 600, 32, 60));

                frame.addWindowListener(new WindowAdapter() {
                    @Override
                    public void windowIconified(WindowEvent we) {
                        //super.windowIconified(we);
                        if (programmatic) {
                            programmatic = false;
                            frame.setState(JFrame.NORMAL);
                        }
                    }
                });

                JButton btn = new JButton();
                btn.setText("Btn");
                final JPanel panel = new JPanel();

                panel.add(btn);
                frame.add(panel);

                btn.addActionListener(new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent e) {
                        programmatic = true;
                        JOptionPane.showMessageDialog(panel, "Sample");
                    }
                });
                frame.setVisible(true);
            }
        });
    }
} 
```

而且想多了，`JDialog`也再现了结果，我想是因为s和s的[模态](http://docs.oracle.com/javase/tutorial/uiswing/misc/modality.html)。也许使用和设置模态就可以了。`JOptionPane``JDialog``JDialog`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:09:32.697

这里的一种解决方法是使用

```
frame.setExtendedState(JFrame.MAXIMIZED_BOTH); 
```

代替

```
device.setFullScreenWindow(frame); 
```

同样如评论中所述，`setVisible(true)`应在添加所有组件后出现。

# opengl - 在球体上映射纹理的正确方法是什么？

> ID：14014524
> 
> 赞同：1
> 
> 时间：2012-12-23T20:36:59.803
> 
> 标签：opengl, geometry, textures, jogl

我在正确映射球体时遇到问题。我用一张世界地图来显示哪里出了问题。北美从上到下出现在最前面，而南美则颠倒过来，像亚洲这样的大陆甚至都没有出现在地图上。

[![截屏](../Images/b5bcf444ddcdfc93a9d518161d70d888.png)](https://i.stack.imgur.com/kSckD.png)
[（来源：[巨魔.ws](http://i.troll.ws/3aedbe4b.png)）]

下面的代码是球体对象

```
class Shape {

    public void drawSphere(double radius, int slices, int stacks) {
        gl.glEnable(GL_TEXTURE_2D);
        head.bind(gl); //Method that binds the world-map (for testing) texture.
        gl.glBegin(GL_QUADS);
        double stack = (2 * PI) / stacks;
        double slice = (2 * PI) / slices;
        for (double theta = 0; theta < 2 * PI; theta += stack) {
            for (double phi = 0; phi < 2 * PI; phi += slice) {
                Vector p1 = getPoints(phi, theta, radius);
                Vector p2 = getPoints(phi + slice, theta, radius);
                Vector p3 = getPoints(phi + slice, theta + stack, radius);
                Vector p4 = getPoints(phi, theta + stack, radius);
                double s0 = theta / (2 * PI);
                double s1 = (theta + stack) / (2 * PI);
                double t0 = phi / (2 * PI);
                double t1 = (phi + slice) / (2 * PI);

                vectorToNormal(norm(p1));
                gl.glTexCoord2d(s0, t0);
                vectorToVertex(p1);

                vectorToNormal(norm(p2));
                gl.glTexCoord2d(s0, t1);
                vectorToVertex(p2);

                vectorToNormal(norm(p3));
                gl.glTexCoord2d(s1, t1 );
                vectorToVertex(p3);

                vectorToNormal(norm(p4));
                gl.glTexCoord2d(s1, t0);
                vectorToVertex(p4);
            }
        }
        gl.glEnd();
        gl.glDisable(GL_TEXTURE_2D);
    }

    Vector getPoints(double phi, double theta, double radius) {
        double x = radius * cos(theta) * sin(phi);
        double y = radius * sin(theta) * sin(phi);
        double z = radius * cos(phi);
        return new Vector(x, y, z);
    } 
```

我该如何解决？我尝试交换一些坐标和其他东西，但这对我来说更加混乱。

此外，当我将纹理绑定到它时，似乎有一些伪影。那可以修吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:45:35.490

您的两个循环都从 0 变为 2*PI。其中一个应该只有半个圆圈。您已经将球体翻倍，从而产生了狡猾的映射和奇怪的人工制品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T20:56:11.677

感谢 JasonD，这解决了它。

```
for (double theta = 0; theta < 2 * PI; theta += stack) {
    for (double phi = 0; phi < 1 * PI; phi += slice) {
        Vector p1 = getPoints(phi, theta, radius);
        Vector p2 = getPoints(phi + slice, theta, radius);
        Vector p3 = getPoints(phi + slice, theta + stack, radius);
        Vector p4 = getPoints(phi, theta + stack, radius);
        double s0 = theta / (2 * PI);
        double s1 = (theta + stack) / (2 * PI);
        double t0 = phi / (1 * PI);
        double t1 = (phi + slice) / (1 * PI); 
```

# c# - 如何决定使用哪些元素来制作 WPF 应用程序布局？

> ID：14014525
> 
> 赞同：0
> 
> 时间：2012-12-23T20:37:11.097
> 
> 标签：c#, wpf, wpf-controls

我仍在学习 C# & WPF 并尝试制作自己的 Windows 应用程序。对于创建 WPF 应用程序布局的最佳方式的问题，我希望能找到一个简单直接的答案。请看一下图片；我的问题是：

*   在我的情况下，合适的控制容器是什么？我有许多面板和容器选项可以定义我的应用程序布局......但是最好的选择是什么？

*   那个可变部分的最佳选择是什么？页面、窗口、导航窗口？虽然我不想要那部分的任何导航控件

*   按下右侧面板中的任何按钮后，如何使可变部分显示某些页面？如何将该部分与这些可变页面链接？

*   C# WPF 可以帮助我设计应用程序在线/离线工作吗？

![在此处输入图像描述](../Images/db129b84ac0aecb7dd131fbc0a9fdfb1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T23:45:16.483

我建议适合您的情况的布局是使用 Grids 来构建您的面板以获得自动调整中心部分的大小并使用 StackPanels 将按钮分组在一起。

作为一般规则，我建议使用 Grids 和 DockPanels 来构建布局骨架。网格的列和行大小上的 * 选项非常方便，可以提供不会因窗口大小调整而受到影响的布局。

这是您的布局的 WPF 再现的快速预览。

![在此处输入图像描述](../Images/1c307e1a0ab78efe4fc6ab005df3486d.png)

这是我用来获取此布局的 XAML（我删除了按钮）

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="40"/>
        <RowDefinition Height="24"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="24"/>
    </Grid.RowDefinitions>
    <Grid Grid.Row="0" Background="LightPink">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Column="0" Text="Hello World"/>
        <StackPanel Grid.Column="1" Orientation="Horizontal">
            <!-- Top Right Button Panel -->
        </StackPanel>
    </Grid>
    <Grid Grid.Row="1" Background="LightBlue"/>
    <Grid Grid.Row="2" Background="LightGray">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="100"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Column="0" Text="Hello World"/>
        <StackPanel Grid.Column="1" Orientation="Vertical">
            <!-- Left Button Panel -->
        </StackPanel>
    </Grid>
    <Grid Grid.Row="4" Background="LightPink"/>
</Grid> 
```

# android - 如果应用程序可见，则启动活动

> ID：14014526
> 
> 赞同：0
> 
> 时间：2012-12-23T20:37:47.807
> 
> 标签：android, android-intent, android-activity

我正在我的应用程序中实现会话超时。在这里我想做的是当且仅当应用程序可见（即显示）时启动登录活动，否则我不想做任何事情，因为当应用程序再次启动时，它将自动以登录活动本身开始。

```
final List<RunningTaskInfo> tasks = activityManager.getRunningTasks(Integer.MAX_VALUE);

    for (RunningTaskInfo runningTaskInfo : tasks) {
        runningactivities.add(0,runningTaskInfo.topActivity.toString());  
    } 
```

但这对我不起作用，因为它在两种情况下都会启动登录活动..

请帮忙！！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:15:11.393

一种解决方案是在您的活动中使用意图接收器。您可以在一个或多个活动中注册一个接收器，您只希望从中启动新活动。然后您可以使用 sendBroadcast(intent) 启动新活动。您应该在每个活动中注册和取消注册您的接收者，如下所示：

```
@Override
protected void onResume() {
    IntentFilter filter = new IntentFilter(CONSTANT_FOR_INTENT);
    registerReceiver(receiver, filter);
    }

@Override
protected void onDestroy() {
    unregisterReceiver(receiver);
}

private BroadcastReceiver receiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
        //handle the intent here - launch activity, etc
    }
}; 
```

现在您可以使用以下命令启动您的活动：

```
Intent intent=new Intent(CONSTANT_FOR_INTENT);
sendBroadcast(intent); 
```

如果您的活动未运行，您还可以使用 sendOrderedBroadcast 设置优先级并执行其他操作。

# api - 通过 Youtube API 查找视频所在的播放列表

> ID：14014533
> 
> 赞同：4
> 
> 时间：2012-12-23T20:38:40.257
> 
> 标签：api, youtube, playlist

我想知道哪些播放列表包含某个视频。相反很容易：找到播放列表中的视频，但我不希望这样。

我已经可以通过以下途径让 YT 做到这一点，但这既愚蠢又缓慢：

*   从视频数据中获取channelId ( `videos?id=...`)
*   从 channelId ( `playlists?channelId=...`)获取播放列表
*   循环浏览所有播放列表并找到他们所有的视频 ( `playlistItems?playlistId=...`)

就像我说的：愚蠢而缓慢。这些步骤是可能的，因为我只想要视频作者创作的播放列表。（否则我必须下载所有 YT。）

我正在寻找的，有点，是一个 request: `playlists?videoId=...`，但当然不存在。

有比我的 3 个步骤更好的方法吗？

PS。我已经创建[了脚本来使用我的 3 个步骤](http://public.home.hotblocks.nl/yt.js)，但它有很多请求。那和播放列表似乎没有可用的播放列表 ID...我需要浏览器用来显示播放列表 GUI 样式的 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T13:11:54.397

截至目前，Youtube API 不支持这样的调用，在我看来永远不会。这可能是 Youtube 有意隐藏播放列表的决定，即使 YT Analytics API 也没有显示有多少列表使用了您的视频。

看来你这样做的方式是唯一的解决方法 - 如果你只需要一个特定用户的播放列表。

# c - 创建二维结构

> ID：14014537
> 
> 赞同：0
> 
> 时间：2012-12-23T20:39:10.910
> 
> 标签：c, pointers, struct, malloc

我对这段代码有疑问，它编译正常。但它在内存无法写入错误后立即崩溃。

调试器说问题出在 *grid = (grid_t**)malloc(sizeof(grid_t)*GRID_HEIGHT); ，我一定遗漏了一些明显的东西。

我正在尝试创建一个指向 2D 结构的指针。

```
#define GRID_WIDTH 12
#define GRID_HEIGHT 22

typedef struct
{
    int piece;
    int edge;
}grid_t;

grid_t*** grid;

*grid = (grid_t**)malloc(sizeof(grid_t)*GRID_HEIGHT);

for(int i = 0 ; i < GRID_HEIGHT ; i++)
{
    *grid[i] = (grid_t*)malloc(sizeof(grid_t)*GRID_WIDTH);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T20:52:21.250

您取消引用未分配的指针：

```
grid_t*** grid;
*grid = (grid_t**)malloc(sizeof(grid_t)*GRID_HEIGHT); 
```

`grid`当你这样做时没有分配`*grid`，所以它是未定义的行为。

如果要动态分配二维结构体，首先需要`grid_t*`在第一级为指针（ ）分配足够的内存：

```
grid_t** grid;
grid = malloc(sizeof(*grid) * GRID_HEIGHT); 
```

然后您可以使用循环分配每个元素：

```
for(int i = 0 ; i < GRID_HEIGHT ; i++)
{
    grid[i] = malloc(sizeof(**grid) * GRID_WIDTH);
    // ...then you can do grid[i]->piece = 42; etc..
} 
```

现在，据我所知，您甚至可能不需要动态分配。如果您不需要`malloc`，请不要使用它，只需使用好的 ol' 数组即可：

```
grid_t grid[GRID_HEIGHT][GRID_WIDTH]; 
```

# wordpress - 在 Wordpress 中获取帖子的图像

> ID：14014544
> 
> 赞同：1
> 
> 时间：2012-12-23T20:40:12.270
> 
> 标签：wordpress, wordpress-theming

我想在 wordpress 中制作幻灯片，我为它创建了一个类别，现在我想为我的幻灯片获取该类别的图像。这是我的代码的一部分：

```
<div id="slide-show">
   <ul>
        <?php query_posts('cat=1'); while(have_posts()): the_post();?>
        <li>
            <a href="<?php the_permalink();?>">
            <img src="<?php
            $image=wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'thumbnail');
            echo $image[0];?>" alt="<?php the_title();?>" /></a>
        </li>
        <?php endwhile; wp_reset_query();?>
    </ul>
</div> 
```

但它不起作用。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T23:26:44.437

首先，我[再重复一遍](https://stackoverflow.com/a/13978350/1287812)：

> 首先，**不要使用** `query_posts`.
> 请检查：
> 
> *   [什么时候应该使用 WP_Query、query_posts() 和 get_posts()？](https://wordpress.stackexchange.com/q/1753/12615)
> *   [何时使用 WP_query()、query_posts() 和 pre_get_posts](https://wordpress.stackexchange.com/q/50761/12615)

* * *

在这种情况下，我建议构建一个函数来创建所需的输出。你把它放在你的主题`functions.php`文件中。把它放在文件的末尾。如果PHP 文件最后
有任何内容，**请将其删除，这不是必需的，如果***后面*有任何空白，可能会破坏您的网站。`?>`

 ***也就是说，我们的函数将准确打印您想要的 Html，并且在**任何**主题模板文件（`index.php`、`single.php`、`page.php`等）中都像这样调用它。

```
<?php get_gallery(4); ?> 
```

数字 4 是类别 ID。

这是函数，检查代码中的注释：

```
function get_gallery( $id )
{
    // Simple query
    $posts = get_posts( array(
        'category' => $id, 
        'post_status' => 'publish', 
        'post_type' => 'post', 
    ) );

    // Start building the Html code
    $slide_show = '
        <div id="slide-show">
            <ul>';

    // Iterate through the results
    foreach ( $posts as $post )
    {
        // Assign value and test if it exists at the *same time*
        if( $thumb = get_post_thumbnail_id( $post->ID ) )
        {
            $permalink = get_permalink( $post->ID );
            $image = wp_get_attachment_image_src( $thumb );

            // Build the Html elements
            $slide_show .= '
                <li>
                    <a href="' . $permalink . '">
                    <img src="'. $image[0] . '" alt="' . $post->post_title .'" />
                    </a>
                </li>';
        }
    }

    // Finish the Html
    $slide_show .= '
            </ul>
        </div>
    ';

    // Print the Html
    echo $slide_show;
} 
```

**结果：**
[![html输出截图](../Images/56cbc107e8995e5f305162cfbbc07fec.png)](https://i.stack.imgur.com/6PnDT.png)***

# ruby-on-rails - Rails，REST，哪个控制器显示什么？

> ID：14014546
> 
> 赞同：1
> 
> 时间：2012-12-23T20:40:45.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest

我有一个用于管理的控制器`Users`和一个用于`Reservations`.
显示特定用户的所有预订的代码应位于何处？
这是在`User`控制器还是`Reservation`控制器中完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:45:58.713

这取决于。如果您正在处理嵌套资源（换句话说，您希望能够访问类似的东西`/users/4321/reservations`），您应该看看[这个 Railscast](http://railscasts.com/episodes/139-nested-resources)，它在 Rails 2 中已经过时但仍然有用。

您可能想要的是将代码放在操作的`ReservationsController`下方`index`，但这取决于您打算做什么。尽管如此，这样的事情还是有道理的：

```
class ReservationsController < ApplicationController
  def index
    @reservations = Reservations.where(user: params[:user_id])
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:47:42.497

我认为你在这里有点偏离基础......你的模型应该有一个关联；例如：

```
User < ActiveRecord::Base
 has_many :reservations
end 
```

您的 UserController#show 可能是

```
def show
 @user = User.find(params["id")
end 
```

然后视图将具有以下内容：

```
<ul>
    <% @user.reservations.each do |r| %>
    <li><%= r.details =%></li>
    <% end %>
</ul> 
```

该关联将其打开，以便您可以从中调用所需的对象。您可以`@reservation.user.name`在预订视图中轻松显示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:47:43.653

> 显示特定用户的所有预订的代码应位于何处？

这取决于。如果您想在他的详细信息页面 (/users/42) 上显示特定用户的预订，那么 UsersController#show 操作是完全合理的。如果你想创建一个搜索表单，那么它基本上是 ReservationsControler#index 操作的过滤器。

# ruby-on-rails - rspec 不接受自定义 http 标头

> ID：14014552
> 
> 赞同：1
> 
> 时间：2012-12-23T20:41:58.403
> 
> 标签：ruby-on-rails, ruby, rspec

我的规格是这样的：

```
describe SomeController do

    before(:each) do
        @request.env["HTTP_ACCEPT"] = 'application/vnd.apple.mpegurl'
    end

    describe 'GET #index' do
        it "returns response" do
            get 'index', format: :m3u8
            puts response.code # prints 406
            response.should be_success # fails
        end
    end
end 
```

控制器：

```
class SomeController < AuthenticatedController
  def index
    Mime::Type.register "application/vnd.apple.mpegurl", :m3u8
    # do some stuff
    respond_to do |format|
        format.m3u8 { render :m3u8 => @some_variable.html_safe }
    end
end 
```

我缺少什么让它以状态 200 响应？现在，返回的状态是 406。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:46:41.863

放下`@`.

```
before(:each) do
  request.env["HTTP_ACCEPT"] = 'application/vnd.apple.mpegurl'
end 
```

# php - 如何将单选按钮的名称传递给 onclick 事件的 Javascript？

> ID：14014556
> 
> 赞同：1
> 
> 时间：2012-12-23T20:42:19.717
> 
> 标签：php, onclick, radio-button, dom-events, alert

我有一个有 n 行的 html 表。每行都有一个名称和 2 个单选按钮。如果我单击一个单选按钮，我想显示一个说明票数的警报。我应该如何将单选按钮的名称传递给 Javascript，我应该如何进行计数？

这是PHP部分：

```
list($cols,) = $xlsx->dimension();
$var=0;
foreach( $xlsx->rows() as $k => $r) {
    $var++;
    echo '<tr>';
        echo '<td>'.$k.'</td>';
        echo '<td>'.( (isset($r[0])) ? $r[0] : '&nbsp;' ).'</td>';
        echo '<td><Input type = "Radio" Name ="vote'.$var.'" value= "pacada"  onclick = "AddPacada()"></td>';
        echo '<td><Input type = "Radio" Name ="vote'.$var.'" value= "toledo"  onclick = "AddToledo()"></td>';
    echo '</tr>'; 
```

这是Javascript部分：

```
function AddPacada(){
if(document.tally.pacada.checked == true){
    alert("You have clicked on Pacada.");
}
}function AddToledo(){
if(document.tally.toledo.checked == true){
    alert("You have clicked on Toledo.");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:52:43.813

您只需将其作为参数传递：

```
... onclick = "AddPacada(this)" ...
                         ^^^^

/* And in your function: */

function AddPacada(radio) {
    alert(radio.value);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:25:18.130

`onclick`将您的 PHP 代码更改为`onclick=tally(this)`

然后这个 javascript 将提醒当前选择的总数：

```
<script>
  var selections = new Array(); //keep track of the selections
  function tally(e) {
    val  = e.value;
    name = e.name;

    selections[name] = val;  //an associative array or "hash"

    var totals = new Array();
    for (var key in selections) {
      var selection=selections[key];
      if(totals[selection] == undefined) { //set to 1 if not already initialized
        totals[selection] = 1;
      } else {
        totals[selection] += 1;
      }
    }
    alert(val + " has been selected " + totals[val] + " times");
  }

</script> 
```

风格方面，我会尝试发出以下 HTML：

```
<input type="radio" name="var1" value="a" onclick="tally(this)"/>
<input type="radio" name="var1" value="b" onclick="tally(this)"/>

<input type="radio" name="var2" value="a" onclick="tally(this)"/>
<input type="radio" name="var2" value="b" onclick="tally(this)"/> 
```

注意间距和大小写。

# c# - C# 等效于 PrivilegedAction

> ID：14014559
> 
> 赞同：4
> 
> 时间：2012-12-23T20:43:17.670
> 
> 标签：c#, java

什么是 Java 的[PrivilegedAction](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/PrivilegedAction.html)和[PrivilegedExceptionAction](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/PrivilegedExceptionAction.html)类的 C# 等价物？

# ios - 在应用程序徽章中显示当前日期

> ID：14014561
> 
> 赞同：0
> 
> 时间：2012-12-23T20:43:24.140
> 
> 标签：ios, iphone

如何在申请徽章中显示正确的日期。我有这个，但它没有显示正确的日期。

```
application.applicationIconBadgeNumber = NSDayCalendarUnit; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:58:34.727

因此，在您改进了您的问题之后，您似乎希望将当月当天的数字显示为应用程序图标徽章。为此，您必须使用`NSCalendar`和`NSDateComponents`：

```
NSDate *today = [NSDate date];
NSCalendar *cal = [NSCalendar currentCalendar];
NSDateComponents *comp = [cal components:NSDayCalendarUnit fromDate:today];
NSInteger day = [comp day];
[UIApplication sharedApplication].applicationIconBadgeNumber = day; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:51:29.663

是不可能的：这只是一个（如果我没记错的话是肯定的）数字。没有字母、符号、空格……只有一个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:52:40.237

```
NSString *formatString = [NSDateFormatter dateFormatFromTemplate:@"MMM d, yyyy h:mm" options:0 locale:[NSLocale currentLocale]];

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:formatString];

NSString *todayString = [dateFormatter stringFromDate:[NSDate date]];
dateLabel.text = todayString; 
```

输出：2012 年 2 月 11 日下午 5:32:21

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T07:27:13.780

首先，您不能在应用程序徽章图标中显示整个日期。

但是，如果您只想显示日期，请查看以下代码。

```
NSDateComponents *comp = [[NSCalendar currentCalendar] components:NSWeekdayCalendarUnit fromDate:[NSDate date]];

[UIApplication sharedApplication].applicationIconBadgeNumber = [comp weekday]; 
```

干杯。

# asp.net - 从 ASP.Net 以异步方式调用 WCF 会将工作线程返回到 ASP.Net 的线程池？

> ID：14014567
> 
> 赞同：2
> 
> 时间：2012-12-23T20:44:04.563
> 
> 标签：asp.net, wcf, asynchronous

我正在尝试使我的 ASP.Net 网站更具可扩展性，**但不确定接收 Web 请求的 ASP.Net 线程是否在对 WCF 方法的异步调用完成之前返回到线程池，**或者该线程将等待异步调用完成。

对 WCF 方法的异步调用大约需要 20 到 40 秒才能完成。

**编辑 1：**我的代码如下，用于我调用异步 WCF 方法的页面代码隐藏。WCF 方法在 WCF 端是异步的，并且它也在此页面代码隐藏中以异步方式调用。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        using (ABCService.ServiceClient sc = new ABCService.ServiceClient())
        {
           // List<ABCService.Product> products = sc.GetDocSummary("Vend1", null, false);//this is synchronous call from client
          sc.BeginGetProducts("Vend1",GetProductsCallback, sc);//this is asynchronous call from WCF
        }
    }

    protected void GetProductsCallback(IAsyncResult asyncResult)
    {
        List<ABCService.Product> products = ((ABCService.ServiceClient)asyncResult.AsyncState).EndGetProducts(asyncResult); //this will call the WCF EndGetProducts method
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:01:32.467

是的，您的线程将返回到线程池，因为您的请求将在`sc.BeginGetProducts`. 方法`GetProductsCallback`在处理请求时不会有输入。

你应该阅读我对[这个问题](https://stackoverflow.com/questions/10787825/webrequest-async-callback-code-only-gets-call-the-first-time/10804018#10804018)的回答。它类似于您的问题。

简而言之：要实现您想要的，您必须使用异步网页。如果您使用的是 .Net 4.5，您应该阅读[这篇文章](http://www.asp.net/web-forms/tutorials/aspnet-45/using-asynchronous-methods-in-aspnet-45)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:02:37.673

我找到了下面详细解释的答案。

我发现 System.Threading.Thread.CurrentThread.ManagedThreadId 给出的 threadid 对于 'sc.BeginGetProducts' 方法与方法 'GetProductsCallback' 的 threadid 不同。

**因此，似乎可以得出这样的结论：原来的 ASP.Net 工作线程被返回到线程池，并且线程池中的一个新线程被用于回调。**

*但是，即使原始线程返回到线程池，这并不意味着页面将在浏览器端呈现。*只有在回调方法被执行后，页面才会呈现。

我最初认为页面将在进行异步调用之后但在调用回调方法之前呈现在浏览器端，因为在异步 WCF 调用的情况下 UI 不应阻塞。在这里，更合适的说法是“从 ASP.Net 应用程序进行异步 WCF 调用时工作线程（而不是 UI）是非阻塞的”。

**我发现的另一个有趣的特性是，即使页面不是异步的，**即页面指令中的 Async="false"，我仍然看到两个不同的线程 ID 用于回调方法和原始 WCF 调用。因此，我们仍然可以获得在普通非异步页面中使用异步 WCF 方法的非阻塞优势。

# mysql - 在高并行连接上仅选择一个表格行

> ID：14014571
> 
> 赞同：5
> 
> 时间：2012-12-23T20:45:18.087
> 
> 标签：mysql, mysqli, parallel-processing, locking, message-queue

我正在寻找一种为一个线程显式选择一个表行的方法。我写了一个爬虫，它可以处理大约 50 个并行进程。每个进程都必须从表中取出一行并进行处理。

```
CREATE TABLE `crawler_queue` (
 `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
 `url` text NOT NULL,
 `class_id` tinyint(3) unsigned NOT NULL,
 `server_id` tinyint(3) unsigned NOT NULL,
 `proc_id` mediumint(8) unsigned NOT NULL,
 `prio` tinyint(3) unsigned NOT NULL,
 `inserted` int(10) unsigned NOT NULL,
 PRIMARY KEY (`id`),
 KEY `proc_id` (`proc_id`),
 KEY `app_id` (`app_id`),
 KEY `crawler` (`class_id`,`prio`,`proc_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 
```

现在我的流程执行以下操作：

*   启动数据库事务
*   做一个选择`SELECT * FROM crawler_queue WHERE class_id=2 AND prio=20 AND proc_id=0 ORDER BY id LIMIT 1 FOR UPDATE`
*   然后用`UPDATE crawler_queue SET server_id=1,proc_id=1376 WHERE id=23892`
*   提交事务

这应该有助于没有其他进程可以获取尚未处理的行。在精选节目上做解释

```
id  select_type  table          type  possible_keys    key      key_len  ref    rows    Extra
1   SIMPLE       crawler_queue  ref   proc_id,crawler  proc_id  3        const  617609  Using where 
```

但是这些进程似乎会导致并行度过高，因为有时我会在日志中看到两种类型的错误/警告（每 5 分钟左右）：

```
mysqli::query(): (HY000/1205): Lock wait timeout exceeded; try restarting transaction (in /var/www/db.php l
ine 81)

mysqli::query(): (40001/1213): Deadlock found when trying to get lock; try restarting transaction (in /var/www/db.php line 81) 
```

我的问题是：谁能指出我正确的方向来最小化这些锁定问题？（在生产状态下，并行度会比现在高 3-4 倍，所以我假设会有更多的锁定问题）

我修改为按提示`SELECT`使用索引。我现在的问题是 lockwait 超时了（死锁消失了）。`crawler``USE INDEX(crawler)`

`EXPLAIN`现在显示`USE INDEX()`（行数更高，因为表现在包含更多数据）：

```
id  select_type  table          type  possible_keys    key      key_len  ref                rows     Extra
1   SIMPLE       crawler_queue  ref   proc_id,crawler  crawler  5        const,const,const  5472426  Using where 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T20:09:32.550

您的 EXPLAIN 报告显示您仅使用单列索引`proc_id`，并且查询必须检查超过 600K 行。如果优化器选择`crawler`索引可能会更好。

InnoDB 可能会锁定*所有 600K 行*，而不仅仅是与 WHERE 子句中的完整条件匹配的行。InnoDB 锁定所有检查的行以确保并发更改不会以错误的顺序写入 binlog。

解决方案是使用索引来缩小检查行的范围。这可能不仅可以帮助您更快地找到行，还可以避免锁定大范围的行。该`crawler`索引在这里应该有所帮助，但目前尚不清楚为什么不使用该索引。

在优化计划中使用该索引之前，您可能必须`ANALYZE TABLE`确保更新 InnoDB 的表统计信息以了解该索引。`crawler`ANALYZE TABLE 是一种廉价的操作。

另一种选择是使用索引提示：

```
SELECT * FROM crawler_queue USE INDEX(crawler) ... 
```

这告诉优化器使用该索引，并且不考虑该查询的其他索引。我更喜欢避免索引提示，因为优化器通常能够自己做出正确的决定，并且在代码中使用提示意味着我可能会迫使优化器不考虑我将来创建的索引，否则它会选择.

* * *

有了更多解释，现在很明显您将 RDBMS 用作 FIFO。这不是对 RDBMS 的有效使用。有用于此目的的消息队列技术。

也可以看看：

*   [https://stackoverflow.com/a/13851231/20860](https://stackoverflow.com/a/13851231/20860)
*   [数据库作为队列反模式](http://mikehadlow.blogspot.com/2012/04/database-as-queue-anti-pattern.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:11:25.823

据我所知，您面临的问题是两个线程正在争夺表中的同一行，并且它们都不能拥有它。但是数据库没有任何优雅的方式可以说“不，你不能拥有那个，找到另一行”，因此你会得到错误。这称为资源争用。

当您在进行这样的高度并行工作时，减少基于争用的问题的最简单方法之一是通过发明一种方法让所有线程提前知道它们应该处理哪些行来完全消除争用。然后他们可以锁定而不必争用资源，并且您的数据库不必解决争用。

如何最好地做到这一点？通常人们会选择某种线程 ID 方案并使用模算术来确定哪些线程获取哪些行。如果您有 10 个线程，则线程 0 将获得第 0、10、20、30 行等。线程 1 获得 1、11、21、31 等。

一般来说，如果您有 NUM_THREADS 则您的每个线程都会从数据库中选择 THREAD_ID + i*NUM_THREADS 的 ID 并对其进行处理。

我们已经引入了一个问题，即线程可能会停止或死亡，并且您最终可能会在数据库中得到永远不会被触及的行。该问题有多种解决方案，其中之一是在大多数/所有线程完成后运行“清理”，其中所有线程零碎地抓取它们可以抓取的任何行并抓取它们，直到没有未抓取的 URL 离开。你可以变得更复杂，让一些清理线程不断运行，或者让每个线程偶尔执行清理任务，等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:16:28.363

更好的解决方案是进行更新并完全跳过选择。然后您可以使用`last_insert_id()`来获取更新的项目。这应该允许您完全跳过锁定，同时执行更新。一旦记录更新，您就可以开始处理它，因为它永远不会被完全相同的查询再次选择，考虑到并非所有初始条件都匹配了。

我认为这应该可以帮助您减轻与锁定相关的所有问题，并且应该允许您并行运行任意数量的进程。

PS：为了澄清，我说`update ... limit 1`的是确保你只更新一行。

编辑： [解决方案](https://stackoverflow.com/questions/1388025/how-to-get-id-of-the-last-updated-row-in-mysql)

是正确的，如下所示。

# css - 带有 CSS 过渡的滑出式菜单

> ID：14014575
> 
> 赞同：1
> 
> 时间：2012-12-23T20:45:40.450
> 
> 标签：css, transition

我有一个需要一些子菜单的垂直菜单。`ul`我可以通过在我想要扩展的链接中放置一个标签并在悬停时将其绝对定位来完成一个看起来不错的链接，`display:none`当它处于非活动状态时。但我想让它滑出，我没有任何运气这样做。我有这个基本标记：

```
<aside>
  <ul>
    <li><a href="">Link Text</a></li>
    <li class="more">
      <a href="">Base</a>
      <ul>
        <li><a href="Sublink"></a></li>
      </ul>
    </li>
</aisde> 
```

`aside`标签本身就是一个二级导航菜单，主要的在我的标题中。它是`position:fixed`为了在滚动时轻松访问。

里面的`ul`标签`<li class="more">`是绝对定位的，固定在顶部的 -1px 和`width:154px`，并且在悬停时它变成`display:block; left:154px`（当然，它是`display:none`在不活动时）。我尝试过转换`left`属性，但它并没有改变任何东西，它就像我的转换甚至不存在一样。

# android - 在 Android 上模拟触摸屏输入

> ID：14014580
> 
> 赞同：0
> 
> 时间：2012-12-23T20:46:18.940
> 
> 标签：android, touchscreen

我的三星 Galaxy S2 发生了一次非常不幸的事故，屏幕完全破碎（从上到下！- 关在车门里）

我已经下载并运行 Droid@Screen 以确保手机本身没有损坏，并且可以看到屏幕位于图案锁定屏幕上。有没有办法可以模拟来自 PC 的触摸屏输入？

我只需要解锁屏幕，然后就可以使用 Kies Air 删除我所有的照片和视频以及重要文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:22:22.723

> 有没有办法可以模拟来自 PC 的触摸屏输入？

您可以尝试[使用`monkeyrunner`](http://developer.android.com/tools/help/monkeyrunner_concepts.html)，但我不知道这是否可以自动锁屏。

# intellij-idea - 如何在 Pycharm/Intellij Idea 中提交之前运行测试

> ID：14014586
> 
> 赞同：9
> 
> 时间：2012-12-23T20:46:51.940
> 
> 标签：intellij-idea, pycharm, pre-commit-hook

是否可以在 Pycharm/Intellij Idea 中的任何提交之前运行指定的脚本？我想确保测试没有被破坏。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2018-01-10T14:07:35.997

如果您不想购买 TeamCity 许可证，您还可以使用[“切换自动测试”](https://www.jetbrains.com/help/pycharm/test-runner-tab.html)功能，在您更改测试时重新运行测试。

它不会阻止您的提交，但会在您的测试失败时向您发出警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-23T15:23:09.783

我一直在寻找类似的快速解决方案，我在启动项目执行之前集成了测试执行，在**运行/调试配置中添加了一个项目 - 启动之前**

另一个最好的解决方案是集成一个 git hook 客户端，比如[pre-commit](https://github.com/pre-commit/pre-commit)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T21:15:57.237

考虑使用[TeamCity](http://www.jetbrains.com/teamcity/)：

*   [预测试提交：版本控制中没有损坏的代码](http://www.jetbrains.com/teamcity/features/delayed_commit.html)

请注意，它还提供与 IntelliJ IDEA 的集成。

# java - 创建一个线程来重复捕获屏幕

> ID：14014588
> 
> 赞同：0
> 
> 时间：2012-12-23T20:47:03.527
> 
> 标签：java, exception, jframe, bufferedimage

```
package demo;
import java.awt.*;
import java.awt.image.*;
import java.util.*;
import javax.swing.*;

public class ScreenCapturingThread extends Thread{
    public ScreenCapturingThread(Vector<BufferedImage> screenShots,
            int frameRate,
            Icon cursor,
            Rectangle recordingArea){
        this.screenShots = screenShots;
        this.frameRate = frameRate;
        this.cursor = cursor;
        this.recordingArea = recordingArea;

        try{
            bot = new Robot();
        }catch(Exception e){
            System.out.println(e);
        }
        calculateSleepTime();
    }
    @Override
    public void run(){
        while(keepCapturing == true){
            try{
                screenShots.add(takeScreenShot());
                sleep(sleepTime);

                keepCapturing = false; //take only one shot

                System.out.println("here");
                JFrame frame = new JFrame();
                frame.setSize(recordingArea.width,recordingArea.height);
                frame.getGraphics().drawImage(screenShots.firstElement(), 0, 0,frame);
                frame.repaint();
                frame.setVisible(true);

            }catch(InterruptedException e){
                e.printStackTrace();
            }
        }
    }
    public BufferedImage takeScreenShot(){
        p = m.getPointerInfo();
        Point location = p.getLocation();
        image = bot.createScreenCapture(recordingArea);
        if(cursor!=null){
            Graphics g = image.getGraphics();
            g.drawImage(((ImageIcon)cursor).getImage(), location.x,location.y,null);
        }

        return image;
    }
    public void stopIt(){
        keepCapturing = false;
    }
    public void calculateSleepTime(){
        sleepTime = 1/frameRate;
    }

    public static void main(String[] args) {
        Vector<BufferedImage> bufferedImages = new Vector<>(100);
        int frameRate = 10;
        Icon cursor = (Icon) new ImageIcon("src/images/blackCursor.png");
        Rectangle r = new Rectangle(1280,800);
        ScreenCapturingThread sc = new ScreenCapturingThread(bufferedImages,frameRate,cursor,r);

        sc.start();
    }
    Vector<BufferedImage> screenShots;
    int frameRate;
    long sleepTime;
    boolean keepCapturing = true;
    Icon cursor;
    Rectangle recordingArea;
    Robot bot;
    MouseInfo m;
    PointerInfo p;
    BufferedImage image;
} 
```

## 解释

我已经设计了线程来配合我的屏幕录像机，但我决定先对其进行测试。这是它应该做的：

*   通过传递适当的参数创建一个新的线程对象*   只拍摄**一个**屏幕截图（仅在此测试期间），将其存储在矢量中，在`run()`结束之前，将其绘制在 JFrame 上，以便我可以看到捕获的内容。

## 问题

我一直`NullPointerException`在

```
frame.getGraphics().drawImage(screenShots.firstElement(), 0, 0,frame); 
```

我不知道出了什么问题。
如果可以请找出错误？

## 更新：

![在此处输入图像描述](../Images/a06e89f1a13114553830d03d0e3034f8.png) **现在虽然`NullPointerException`消失了，但框架是空白的，而它不应该是**

### 为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:54:59.473

`JFrame`在显示之前不会为您提供任何`Graphics`内容。

如果你想在`JFrame`显示之前绘制，你**永远不应该**这样做：

```
frame.pack();
frame.setSize(recordingArea.width, recordingArea.height);
Graphics g = frame.getContentPane().getGraphics();
g.drawImage(screenShots.firstElement(), 0, 0, frame); 
```

因为正如[Andrew Thompson 所写](http://pscode.org/guifaq.html#2.4)的那样：

> 不要使用 Component.getGraphics()。相反，子类化并覆盖paint() (AWT) 或paintComponent() (Swing) 方法。
> 
> Component.getGraphics() 根本无法工作。Java 使用回调机制来绘制图形。您不应该使用 getGraphics() 将图形信息“推送”到组件中。相反，您应该等到 Java 调用您的 paint()/paintComponent() 方法。那时您应该向组件提供您想要做的图纸。

相反，您最好执行以下操作：

```
BufferedImage img = new BufferedImage(recordingArea.width, recordingArea.height,
                    BufferedImage.TYPE_3BYTE_BGR);
            Graphics g = img.createGraphics();
            g.drawImage(screenShots.firstElement(), 0, 0, frame);
            JLabel l = new JLabel(new ImageIcon(img));
            frame.getContentPane().add(l); 
```

# php - 文件包含在 Yii 中

> ID：14014597
> 
> 赞同：1
> 
> 时间：2012-12-23T20:48:06.647
> 
> 标签：php, yii, solarium

我正在尝试使用日光浴室扩展（php 中 solr 的扩展）扩展我的 yii 应用程序。

但是，扩展库有多个子目录。因此，我必须包含来自特定子目录的文件，如下所示：

```
Yii::import('application.extensions.Library.Solarium.*');
Yii::import('application.extensions.Library.Solarium.Client.*');
Yii::import('application.extensions.Library.Solarium.Client.RequestBuilder.*'); 
```

如果我是否包含所有文件，这将导致丑陋的代码以及不可预测性。尽管我在当前的操作中执行此操作，但我稍后会将其移至配置以进行生产。有没有其他方便的方法来包含目录和子目录中的所有文件？有很多子目录，所以提到每一个都会导致 20-30 行代码。一种选择是将所有库文件放在一个用于生产的目录中。但是我不确定它是否会影响功能（我通常是实现扩展/库的“新手”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:28:18.503

当我向 Yii 添加 3rd 方类时，我将它们放在一个文件夹中 `protected/components/`，例如`/protected/components/solr`.

然后在主配置中，我将以下行添加到**导入**部分：

```
'import' => array(
      'application.components.solr.*',
      ... 
```

但是你需要一个一个地添加每个子文件夹，这是由于性能问题，Yii 的开发人员在一些版本之前删除了递归导入。如果你认为这很糟糕，那么你可以使用**命名空间**来做你想做的事，但你需要 PHP 5.3

# javascript - 在 KineticJS 中使用多边形蒙版/剪辑图像

> ID：14014600
> 
> 赞同：2
> 
> 时间：2012-12-23T20:48:29.063
> 
> 标签：javascript, jquery, html, canvas, kineticjs

是否可以在 KineticJS 中`Image`使用 a来屏蔽/剪辑？`Polygon`

**JSfiddle：http:** [//jsfiddle.net/LNeML/](http://jsfiddle.net/LNeML/)

在 jsfiddle 中，Polygon 应该剪辑 Yoda 的图像。

我在 KineticJS 对象的文档中没有看到任何剪辑功能。我正在寻找一种简单的方法来剪辑图像，类似于 EaselJS：

```
star = new createjs.Shape(); 
star.graphics.beginStroke("#FF0").setStrokeStyle(5).drawPolyStar(0,0,50, 15,5,0.6).closePath();
bitmap.mask = star;
stage.addChild(bitmap); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:59:59.063

好吧，看着你的小提琴，我更新了它：**[FIDDLE](http://jsfiddle.net/Imran_Bughio/LNeML/409/)**

基本上你需要在你的项目中包含更新版本的 kineticJS，你可以这样做：

```
 fillPatternImage: ImageObject 
```

作为多边形属性之一。此 fillPatternImage 适用于任何形状并允许您做您想做的事情，但与 EaselJS 的方式不完全相同，我想说它很容易。

# prolog - 在 prolog 中读取文件并构造事实

> ID：14014602
> 
> 赞同：2
> 
> 时间：2012-12-23T20:48:54.290
> 
> 标签：prolog

我想构建一种机制，根据在 prolog 中导入的 txt 文件构造不同的事实。我已经找到了一些示例，它们直接断言从文件中读取的行，但是我必须在断言发生之前转换数据。

举个例子：

```
man = {m1, m2}.

m1: w1 > w2. 
```

应该读作：

```
man(m1).
man(m2).
prefer(m1, w1, 1).
prefer(m1, w2, 2). 
```

是否可以根据输入的符号构造这些事实？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T21:59:25.187

是的 - 你需要做你会用任何其他语言做的事情。

打开并读取文件，解析内容，然后转换为您可以断言的术语。

幸运的是，您在 prolog 中，因此“解析内容”是语言在早餐时执行的一项任务。

事实证明，我一直在写一个关于如何完成这个确切任务的教程。还没完，网上有

[http://www.pathwayslms.com/swipltuts/dcg/](http://www.pathwayslms.com/swipltuts/dcg/)

如果您的文件很大，请使用教程中描述的方法来阅读它们。否则，只需将文件带入“代码”样式字符串并继续生活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T21:59:43.643

由于示例中提供的数据是有效的 Prolog 语法这一事实，这段代码就可以了

```
load_file_data(File) :-
    open(File, read, Stream),
    repeat,
    read(Stream, Term),
    (   Term = end_of_file
    ->  true
    ;   process(Term),
        fail
    ),
    close(Stream).

process(X = {L}) :-
    forall(arg(_, L, A), (F =.. [X, A], assert(F))).
process(X : A > B) :-
    assert(prefer(X, A, 1)),
    assert(prefer(X, B, 2)). 
```

请注意，运算符 in 的优先级`m1: w1 > w2`不是我们所期望的，但它仍然有效，这要归功于完整的模式匹配。利用

```
?- write_canonical(m1 : w1 > w2).
>(:(m1,w1),w2) 
```

不确定时检查优先级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T20:36:33.523

您可以通过将 DCG 包含在 {} 中来执行任何“正常”序言

some_nonterminal --> "fridge", blanks, [X], { % 你可以在这里放任何普通的 Prolog 代码 assert(fridge_named(X)) }。

这寻找一个像

冰箱 G

并在数据库中声明冰箱命名（0x47）（Ascii G 为 0x47）

# c++ - C++ 错误：未在此范围内声明“点”

> ID：14014603
> 
> 赞同：2
> 
> 时间：2012-12-23T20:49:00.163
> 
> 标签：c++, class, sdl

请帮助解决此错误。我正在使用一个名为 Code::Blocks 的编译器。这是我的代码。

```
#ifndef PROTOTYPES_H_INCLUDED
#define PROTOTYPES_H_INCLUDED

//The headers
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include "SDL/SDL_ttf.h"
#include <string>
#include <fstream>
#include <sstream>

#include "Dot.h"
#include "vars.h"

using namespace std;

bool load_files( Dot &thisDot, Uint32 &bg );

#endif // PROTOTYPES_H_INCLUDED 
```

当我尝试在标头中使用 Dot 参数声明原型时，我收到了这个烦人的错误。s “在这个范围内声明了点”。任何人都可以帮助解决这些错误，他们真的阻碍了我的进步>.<

这是位于同一目录中不同 .cpp 文件中的实际函数（不要担心链接，由编译器负责）：

```
bool load_files( Dot &thisDot, Uint32 &bg ) {
    //Load the dot image
    dot = load_image( "spritesheet.png" );

    //Open font
    font = TTF_OpenFont( "lazy.ttf", 28 );

    //If there was a problem in loading the dot
    if( dot == NULL )
    {
        return false;
    }

    if( font == NULL ) {
        return false;
    }

    //Open a file for reading
    std::ifstream load( "game_save" );

    //If the file loaded
    if( load != NULL )
    {
        //The offset
        int offset;

        //The level name
        std::string level;

        //Set the x offset
        load >> offset;
        thisDot.set_x( offset );

        //Set the y offset
        load >> offset;
        thisDot.set_y( offset );

        //If the x offset is invalid
        if( ( thisDot.get_x() < 0 ) || ( thisDot.get_x() > SCREEN_WIDTH - DOT_WIDTH ) )
        {
            return false;
        }

        //If the y offset is invalid
        if( ( thisDot.get_y() < 0 ) || ( thisDot.get_y() > SCREEN_HEIGHT - DOT_HEIGHT ) )
        {
            return false;
        }

        //Skip past the end of the line
        load.ignore();

        //Get the next line
        getline( load, level );
        load >> DOT_DIRECTION;

        //If an error occurred while trying to read the data
        if( load.fail() == true )
        {
            return false;
        }

        //If the level was white
        if( level == "White Level" )
        {
            //Set the background color
            bg = SDL_MapRGB( screen->format, 0xFF, 0xFF, 0xFF );
        }
        //If the level was red
        else if( level == "Red Level" )
        {
            //Set the background color
            bg = SDL_MapRGB( screen->format, 0xFF, 0x00, 0x00 );
        }
        //If the level was green
        else if( level == "Green Level" )
        {
            //Set the background color
            bg = SDL_MapRGB( screen->format, 0x00, 0xFF, 0x00 );
        }
        //If the level was blue
        else if( level == "Blue Level" )
        {
            //Set the background color
            bg = SDL_MapRGB( screen->format, 0x00, 0x00, 0xFF );
        }

        //Close the file
        load.close();
    }

    //If everything loaded fine
    return true;
} 
```

这是“Dot.h”，它与所有其他文件位于同一目录中：

```
#ifndef DOT_H_INCLUDED
#define DOT_H_INCLUDED

#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include "SDL/SDL_ttf.h"
#include <string>
#include <fstream>
#include <sstream>

#include "vars.h"
#include "prototypes.h"

//The dot
class Dot{
    private:
    //The X and Y offsets of the dot
    int x, y;

    //The velocity of the dot
    int xVel, yVel;

    //Game variables
    int chakra, maxChakra;

    public:
    //Initializes the variables
    Dot();

    //Takes key presses and adjusts the dot's velocity
    void handle_input();

    //Moves the dot
    void move();

    //Shows the dot on the screen
    void show();

    //Set the dot's x/y offsets
    void set_x( int X );
    void set_y( int Y );

    //Get the dot's x/y offsets
    int get_x();
    int get_y();

    //Chakra
    int getChakra();
    int getMaxChakra();
    void setChakra(int amount);
    void useChakra(int amount);
    void gainChakra(int amount);
};

Dot::Dot()
{
    //Initialize the offsets
    x = 0;
    y = 0;

    //Initialize the velocity
    xVel = 0;
    yVel = 0;

    //Initialize chakra
    maxChakra = 300;
    chakra = maxChakra;
}

void Dot::set_x( int X )
{
    x = X;
}

void Dot::set_y( int Y )
{
    y = Y;
}

int Dot::get_x()
{
    return x;
}

int Dot::get_y()
{
    return y;
}

int Dot::getChakra(){
    return chakra;
}

int Dot::getMaxChakra(){
    return maxChakra;
}

void Dot::setChakra(int amount){
    chakra = amount;
    //if (chakra<0) bg = SDL_MapRGB( screen->format, 0xFF, 0x00, 0x00 );
}

void Dot::useChakra(int amount){
    chakra -= amount;
    //if (chakra<0) bg = SDL_MapRGB( screen->format, 0xFF, 0x00, 0x00 );
}

void Dot::gainChakra(int amount){
    chakra += amount;
    if (chakra>maxChakra) chakra = maxChakra;
}

void Dot::handle_input()
{
    //If a key was pressed
    if( event.type == SDL_KEYDOWN)
    {
        //Adjust the velocity
        switch( event.key.keysym.sym )
        {
            case SDLK_UP:
            yVel -= DOT_HEIGHT / 2;
            if(!jutsuActive) DOT_DIRECTION = 0;
            break;

            case SDLK_DOWN:
            yVel += DOT_HEIGHT / 2;
            if(!jutsuActive) DOT_DIRECTION = 2;
            break;

            case SDLK_LEFT:
            xVel -= DOT_WIDTH / 2;
            if(!jutsuActive) DOT_DIRECTION = 3;
            break;

            case SDLK_RIGHT:
            xVel += DOT_WIDTH / 2;
            if(!jutsuActive) DOT_DIRECTION = 1;
            break;
            default: ;
        }
    }
    //If a key was released
    else if( event.type == SDL_KEYUP )
    {
        //Adjust the velocity
        switch( event.key.keysym.sym )
        {
            case SDLK_UP: yVel += DOT_HEIGHT / 2; break;
            case SDLK_DOWN: yVel -= DOT_HEIGHT / 2; break;
            case SDLK_LEFT: xVel += DOT_WIDTH / 2; break;
            case SDLK_RIGHT: xVel -= DOT_WIDTH / 2; break;
            default: ;
        }
    }
}

void Dot::move()
{
    //Move the dot left or right
    x += xVel;

    //If the dot went too far to the left or right
    if( ( x < 0 ) || ( x + DOT_WIDTH > SCREEN_WIDTH ) || jutsuActive )
    {
        //Move back
        x -= xVel;
    }

    //Move the dot up or down
    y += yVel;

    //If the dot went too far up or down
    if( ( y < 0 ) || ( y + DOT_HEIGHT > SCREEN_HEIGHT ) || jutsuActive )
    {
        //Move back
        y -= yVel;
    }
}

void Dot::show()
{
    //Show the dot
    //apply_surface( x, y, dot, screen, &clipsChar[DOT_DIRECTION] );
}

#endif // DOT_H_INCLUDED 
```

如果你能帮我解决这个问题，那就太棒了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T20:50:59.203

你有一个递归包含。prototypes.h 包含 Dot.h，Dot.h 包含prototypes.h。

因为守卫阻止了真正的递归，所以你会得到一个意想不到的包含命令。

因为prototypes.h 实际上不需要类Dot 的定义，所以您可以直接转发声明Dot：

```
#ifndef PROTOTYPES_H_INCLUDED
#define PROTOTYPES_H_INCLUDED

//The headers
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include "SDL/SDL_ttf.h"
#include <string>
#include <fstream>
#include <sstream>

#include "vars.h"

using namespace std;
class Dot;

bool load_files( Dot &thisDot, Uint32 &bg );

#endif // PROTOTYPES_H_INCLUDED 
```

# java - Android Hashmap 无法在 listView 中显示

> ID：14014604
> 
> 赞同：0
> 
> 时间：2012-12-23T20:49:57.520
> 
> 标签：java, android

复制密钥时，我陷入了这个哈希图问题。（安卓）

最初我有一个类似的 xml 文件

```
<many_people>
  <people>
    <id>1</id>
     <name>Johnson</name>
     <tel_num>12345678</tel_num>
  </people>
     .
     .
     .
</many_people> 
```

所以我用hashmap创建了arraylist来存储整个xml

```
for (int i = 0; i < nl.getLength(); i++) {
        map = new HashMap<String, String>();
        Element e = (Element) nl.item(i);
        map.put(KEY_ID, parser.getValue(e, KEY_ID));
        map.put(KEY_NAME, parser.getValue(e, KEY_NAME));
        map.put(KEY_TELNUM, parser.getValue(e, KEY_TELNUM));

        // adding HashList to ArrayList
        peopleList.add(map);
    } 
```

我使用 onItemClickListener 来捕获来自 AutoCompleteTextView 的输入，以便我可以将输入与 xml 进行比较。peopleList 稍后将在 listView 中使用。

例如：输入 - Johnson 与 比较，如果找到，那么我的列表视图将显示 Johnson 的姓名和联系人。问题就在这里，如果我有 2 个约翰逊，listView 只会读取我在 xml 中的第一个约翰逊。我不知道如何将输入与 xml 进行比较。下面是我的代码：

```
for (HashMap<String, String> map : peopleList) {
  if (input.equals(map.get(KEY_NAME))) {
      // At here I created another hashmap with copying the value
      map2.put(KEY_ID, map.get(KEY_ID));
      map2.put(KEY_NAME, map.get(KEY_NAME));
      map2.put(KEY_NAME, map.get(KEY_TELNUM));
      peopleList2.add(map2);
    }
} 
```

我成功地在我的 listView 中显示了第一个数据，但第二个和第三个数据（与 Johnson 同名）失败了。我不确定这是否可行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:47:35.727

在这里：

```
for (HashMap<String, String> map : peopleList) {
  if (input.equals(map.get(KEY_NAME))) {
      // At here I created another hashmap with copying the value
      map2.put(KEY_ID, map.get(KEY_ID));
      map2.put(KEY_NAME, map.get(KEY_NAME));
      map2.put(KEY_NAME, map.get(KEY_TELNUM));
      peopleList2.add(map2);
    }
} 
```

> 在这里，我创建了另一个带有复制值的哈希图

好吧，如果那是您的整个 FOR 循环代码，那么您肯定没有创建*另一个*地图。您只是`map2`一遍又一遍地更新相同的 HashMap ( ) 并将其添加到列表中。由于您使用的是相同的 HashMap，因此您将一遍又一遍地更新同一个对象，以对同一“人”的 N（匹配数）引用结束。

就像迈克尔说的那样，没有理由这样做，你应该创建一个 Person 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:05:05.393

~~如果将两个相同`key`的值放入 a 中`HashMap`，则第一个被第二个覆盖。您需要确保您输入的每个“人”都是唯一的，这样它就不会覆盖以前的人。~~（注意：这是真的，但这不是你的问题）

建议：创建一个`Person`对象，将每个人的数据输入到这个新对象中。然后插入`Person`到您的哈希图中。请记住为您的新对象实现`equals`和`hashCode`函数，以便将其有效地输入到地图中。

编辑：我误读了您的原始代码。还有更糟糕的问题。正如 dmon 所说，你为什么要通过 for 循环为每个循环创建一个新的 hashmap，然后只在其中存储 4ish 的东西？这是非常低效的，您应该一起摆脱哈希图。将`Person`课程存储在您的列表中，而不是每个人的哈希图...

# java - Java 函数作为参数

> ID：14014606
> 
> 赞同：2
> 
> 时间：2012-12-23T20:50:07.380
> 
> 标签：java

我正在尝试将按键事件添加到我的库中，因此是否可以将函数作为参数传递给我的库的一个类，然后当我的库需要触发该函数时？

例子：

```
Library lib = new Library();
lib.myAction(function(){
    // Do some java stuff here
}); 
```

因此，当我的库看到发生某些事情（例如按键）时，它将触发该功能。如果你曾经使用过 JavaScript，你可以做到这一点（在 jQuery 中很常见），我希望使用 Java 也能达到同样的效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-23T20:52:17.073

不，在 Java 中没有直接的等价物。您可以获得的最接近的是拥有一个接口或抽象类，然后使用匿名内部类来实现/扩展它：

```
lib.myAction(new Runnable() {
    @Override public void run() {
        // Do something here
    }
}); 
```

这应该通过 Java 8 的[lambda 表达式支持](http://www.jcp.org/en/jsr/detail?id=335)变得更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:36:58.277

在 Java 中没有简单的方法。但是，您可以将 Method 对象（该方法必须是静态的）传递给您的*myAction*函数并调用其中传递的方法，如下所示：

```
public Object myAction(Method m, Object... args) {
    return m.invoke(args);
} 
```

注意*args*参数是传递方法的参数列表。

例如，假设您在 A 中定义了一个类*A*和一个静态方法*sampleMethod(String s)* 。您可以按如下方式调用您的*myAction方法：*

```
lib.myAction(A.class.getMethod("sampleMethod", String.class), "Value of parameter s"); 
```

如果您的*sampleMethod*是无参数的，那么您可以省略第二个参数：

```
lib.myAction(A.class.getMethod("sampleMethod", String.class)); 
```

# php - SimpleXML 不返回任何内容

> ID：14014619
> 
> 赞同：0
> 
> 时间：2012-12-23T20:52:51.853
> 
> 标签：php, simplexml

这是我要运行的脚本：

```
 <?php
$lat = $_GET[lat];
$long = $_GET[long];
    $mysongs3 = simplexml_load_file('http://local.yahooapis.com/LocalSearchService/V3/localSearch?appid=845e721464167b9976ca031b0c3c66f3cc6563ee&query=restaurant&latitude='.$lat.'&longitude='.$long.'&results=2');
   $lat2 = $mysongs3->Result[0]->Latitude;
   $long2 = $mysongs3->Result[0]->Longitude;
   $mysongs4 = simplexml_load_file('http://www.mapquestapi.com/directions/v1/route?key=Fmjtd%7Cluuan1urn9%2Cb0%3Do5-968206&from='.$lat.', '.$long.'&to='.$lat2.', '.$long2.'&callback=renderNarrative&outFormat=xml');
echo $mysongs4->route[0]->time;
?> 
```

它不回声任何东西。

它使用了 MapQuest 和 Yahoo API（尽管我知道问题出在 MapQuest API 位，因为如果我删除 MapQuest 位并回显它，它就可以工作）。顺便说一句，API 密钥是正确的。

$_GET[lat] 是 33.8524925 和 $_GET[long] 是 -117.73242200000001 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:04:03.943

对 MapquestAPI 的调用确实会返回以下文档：

```
<?xml version = "1.0" encoding = "UTF-8" ?>
<response>
    <info>
        <statusCode>403</statusCode>
        <messages>
            <message/>
        </messages>
        <copyright>
            <imageUrl>http://api.mqcdn.com/res/mqlogo.gif</imageUrl>
            <imageAltText>© 2012 MapQuest, Inc.</imageAltText>
            <text>© 2012 MapQuest, Inc.</text>
        </copyright>
    </info>
    <route/>
</response> 
```

正如你在最后看到的，`<route />`元素是空的。因此

```
echo $mysongs4->route[0]->time; 
```

也是空的。如果情况不同，您将遇到真正的问题。

如果您希望有一些东西，请联系 API 供应商以获取您的支持选项。

此外，我建议您为 URL 创建变量，以便调试您实际请求的 URL。并不是说您在构建 URI 时出错。小心。

* * *

原来这实际上是你的问题。您需要使用正确的 URI 请求 API，否则它不起作用。仔细检查您是否删除了`lat,long`对的任何空格，正确的 URI 必须如下所示：

```
http://www.mapquestapi.com/directions/v1/route?key=Fmjtd%7Cluuan1urn9%2Cb0%3Do5-968206&from=33.8524925,-117.73242200000001&to=33.863084,-117.739601&callback=renderNarrative&outFormat=xml 
```

使用它可以`simplexml_load_file`正常工作，请参见示例：

```
$mapqueryUri = 'http://www.mapquestapi.com/directions/v1/route?key=Fmjtd%7Cluuan1urn9%2Cb0%3Do5-968206' .
               '&from=33.8524925,-117.73242200000001&to=33.863084,-117.739601&callback=renderNarrative' .
               '&outFormat=xml';
$mysongs4    = simplexml_load_file($mapqueryUri);
echo $mysongs4->asXML(); 
```

输出：

```
<?xml version = "1.0" encoding = "UTF-8"?>
<response>
    <info>
        <statusCode>0</statusCode>
        <messages/>
        <copyright>
            <imageUrl>http://api.mqcdn.com/res/mqlogo.gif</imageUrl>
            <imageAltText>© 2012 MapQuest, Inc.</imageAltText>
            <text>© 2012 MapQuest, Inc.</text>
        </copyright>
    </info>
    <route>
        <sessionId>50d7729f-0223-0013-02b7-60f4-d485645ba5f2</sessionId>
        <options>
            <shapeFormat>raw</shapeFormat>
            <generalize>-1.0</generalize>
            <maxLinkId>0</maxLinkId>
            <narrativeType>text</narrativeType>
            <stateBoundaryDisplay>true</stateBoundaryDisplay>
            <countryBoundaryDisplay>true</countryBoundaryDisplay>
            <sideOfStreetDisplay>true</sideOfStreetDisplay>
            <destinationManeuverDisplay>true</destinationManeuverDisplay>
            <avoidTimedConditions>false</avoidTimedConditions>
            <enhancedNarrative>false</enhancedNarrative>
            <returnLinkDirections>false</returnLinkDirections>
            <timeType>0</timeType>
            <routeType>FASTEST</routeType>
            <locale>en_US</locale>
            <unit>M</unit>
            <tryAvoidLinkIds/>
            <mustAvoidLinkIds/>
            <manmaps>true</manmaps>
            <drivingStyle>2</drivingStyle>
            <highwayEfficiency>22.0</highwayEfficiency>
            <useTraffic>false</useTraffic>
        </options>
        <boundingBox>
            <ul>
                <lat>33.863009999999996</lat>
                <lng>-117.741813</lng>
            </ul>
            <lr>
                <lat>33.852661</lat>
                <lng>-117.732475</lng>
            </lr>
        </boundingBox>
        <distance>1.241</distance>
        <time>272</time>
        <realTime>272</realTime>
        <fuelUsed>0.089725</fuelUsed>
        <formattedTime>00:04:32</formattedTime>
        <legs>
            <leg>
                <distance>1.241</distance>
                <time>272</time>
                <formattedTime>00:04:32</formattedTime>
                <index>0</index>
                <maneuvers>
                    <maneuver>
                        <startPoint>
                            <lat>33.8528</lat>
                            <lng>-117.7325</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.155</distance>
                        <time>34</time>
                        <formattedTime>00:00:34</formattedTime>
                        <attributes>0</attributes>
                        <turnType>6</turnType>
                        <direction>7</direction>
                        <narrative>Start out going west on E Marblehead Way toward S Hanlon Way.</narrative>
                        <directionName>West</directionName>
                        <index>0</index>
                        <streets>
                            <street>E Marblehead Way</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_left_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-2,33.852756,-117.732475,0,0|purple-3,33.853279,-117.73499199999999,0,0|&center=33.8530175,-117.7337335&zoom=13&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2931445&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint>
                            <lat>33.8533</lat>
                            <lng>-117.735</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.521</distance>
                        <time>68</time>
                        <formattedTime>00:01:08</formattedTime>
                        <attributes>0</attributes>
                        <turnType>2</turnType>
                        <direction>2</direction>
                        <narrative>Turn right onto S Serrano Ave.</narrative>
                        <directionName>Northwest</directionName>
                        <index>1</index>
                        <streets>
                            <street>S Serrano Ave</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_right_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-3,33.853279,-117.73499199999999,0,0|purple-4,33.860351,-117.737342,0,0|&center=33.856815,-117.736167&zoom=10&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2546696&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint>
                            <lat>33.8604</lat>
                            <lng>-117.7373</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.199</distance>
                        <time>49</time>
                        <formattedTime>00:00:49</formattedTime>
                        <attributes>0</attributes>
                        <turnType>6</turnType>
                        <direction>7</direction>
                        <narrative>Turn left onto Canyon Creek Rd.</narrative>
                        <directionName>West</directionName>
                        <index>2</index>
                        <streets>
                            <street>Canyon Creek Rd</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_left_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-4,33.860351,-117.737342,0,0|purple-5,33.860008,-117.740676,0,0|&center=33.8601795,-117.739009&zoom=13&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2546696&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint>
                            <lat>33.86</lat>
                            <lng>-117.7407</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.163</distance>
                        <time>60</time>
                        <formattedTime>00:01:00</formattedTime>
                        <attributes>0</attributes>
                        <turnType>2</turnType>
                        <direction>1</direction>
                        <narrative>Turn right onto S Glenhurst Dr.</narrative>
                        <directionName>North</directionName>
                        <index>3</index>
                        <streets>
                            <street>S Glenhurst Dr</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_right_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-5,33.860008,-117.740676,0,0|purple-6,33.862079,-117.741706,0,0|&center=33.8610435,-117.74119099999999&zoom=12&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2546696&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint>
                            <lat>33.8621</lat>
                            <lng>-117.7417</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.044</distance>
                        <time>20</time>
                        <formattedTime>00:00:20</formattedTime>
                        <attributes>0</attributes>
                        <turnType>2</turnType>
                        <direction>3</direction>
                        <narrative>Turn right to stay on S Glenhurst Dr.</narrative>
                        <directionName>Northeast</directionName>
                        <index>4</index>
                        <streets>
                            <street>S Glenhurst Dr</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_right_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-6,33.862079,-117.741706,0,0|purple-7,33.862358,-117.74101999999999,0,0|&center=33.8622185,-117.74136299999999&zoom=15&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2546696&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint>
                            <lat>33.8624</lat>
                            <lng>-117.741</lng>
                        </startPoint>
                        <maneuverNotes/>
                        <distance>0.159</distance>
                        <time>41</time>
                        <formattedTime>00:00:41</formattedTime>
                        <attributes>0</attributes>
                        <turnType>2</turnType>
                        <direction>2</direction>
                        <narrative>Turn right onto E Oak Ridge Cir.</narrative>
                        <directionName>Northwest</directionName>
                        <index>5</index>
                        <streets>
                            <street>E Oak Ridge Cir</street>
                        </streets>
                        <signs/>
                        <iconUrl><![CDATA[http://content.mapquest.com/mqsite/turnsigns/rs_right_sm.gif]]></iconUrl>
                        <linkIds/>
                        <mapUrl>
                            <![CDATA[http://www.mapquestapi.com/staticmap/v4/getmap?type=map&size=225,160&pois=purple-7,33.862358,-117.74101999999999,0,0|purple-8,33.863009999999996,-117.739685,0,0|&center=33.862684,-117.7403525&zoom=14&key=Fmjtd|luuan1urn9,b0=o5-968206&rand=2546696&session=50d7729f-0223-0013-02b7-60f4-d485645ba5f2]]>
                        </mapUrl>
                    </maneuver>
                    <maneuver>
                        <startPoint/>
                        <maneuverNotes/>
                        <distance>0.0</distance>
                        <time>0</time>
                        <formattedTime>00:00:00</formattedTime>
                        <attributes>0</attributes>
                        <turnType>-1</turnType>
                        <direction>0</direction>
                        <narrative>8175 E OAK RIDGE CIR is on the right.</narrative>
                        <directionName/>
                        <index>6</index>
                        <streets/>
                        <signs/>
                        <linkIds/>
                        <mapUrl><![CDATA[]]></mapUrl>
                    </maneuver>
                </maneuvers>
                <hasTollRoad>false</hasTollRoad>
                <hasFerry>false</hasFerry>
                <hasHighway>false</hasHighway>
                <hasSeasonalClosure>false</hasSeasonalClosure>
                <hasUnpaved>false</hasUnpaved>
                <hasCountryCross>false</hasCountryCross>
            </leg>
        </legs>
        <hasTollRoad>false</hasTollRoad>
        <hasFerry>false</hasFerry>
        <hasHighway>false</hasHighway>
        <hasSeasonalClosure>false</hasSeasonalClosure>
        <hasUnpaved>false</hasUnpaved>
        <hasCountryCross>false</hasCountryCross>
        <locations>
            <location>
                <street>8250 E Marblehead Way</street>
                <adminArea5 type="City">Anaheim</adminArea5>
                <adminArea3 type="State">CA</adminArea3>
                <adminArea4 type="County">Orange</adminArea4>
                <postalCode>92808</postalCode>
                <adminArea1 type="Country">US</adminArea1>
                <geocodeQuality>ADDRESS</geocodeQuality>
                <geocodeQualityCode>L1AAA</geocodeQualityCode>
                <dragPoint>false</dragPoint>
                <sideOfStreet>L</sideOfStreet>
                <displayLatLng>
                    <latLng>
                        <lat>33.852492</lat>
                        <lng>-117.732422</lng>
                    </latLng>
                </displayLatLng>
                <linkId>24154164</linkId>
                <type>s</type>
                <latLng>
                    <lat>33.852492</lat>
                    <lng>-117.732422</lng>
                </latLng>
            </location>
            <location>
                <street>8175 E Oak Ridge Cir</street>
                <adminArea5 type="City">Anaheim</adminArea5>
                <adminArea3 type="State">CA</adminArea3>
                <adminArea4 type="County">Orange</adminArea4>
                <postalCode>92808</postalCode>
                <adminArea1 type="Country">US</adminArea1>
                <geocodeQuality>ADDRESS</geocodeQuality>
                <geocodeQualityCode>L1AAA</geocodeQualityCode>
                <dragPoint>false</dragPoint>
                <sideOfStreet>R</sideOfStreet>
                <displayLatLng>
                    <latLng>
                        <lat>33.863084</lat>
                        <lng>-117.739601</lng>
                    </latLng>
                </displayLatLng>
                <linkId>24115749</linkId>
                <type>s</type>
                <latLng>
                    <lat>33.863084</lat>
                    <lng>-117.739601</lng>
                </latLng>
            </location>
        </locations>
        <locationSequence>0,1</locationSequence>
        <computedWaypoints/>
    </route>
</response> 
```

# android - 更新小部件的最有效方法是什么？

> ID：14014620
> 
> 赞同：1
> 
> 时间：2012-12-23T20:53:01.353
> 
> 标签：android

我想问，最有效的方法是更新小部件。例如不受`appwidget-provider's` `android:updatePeriodMillis`.

# apache - 连接到家庭网络时，MAMP 虚拟主机不工作

> ID：14014621
> 
> 赞同：1
> 
> 时间：2012-12-23T20:53:05.857
> 
> 标签：apache, mamp, virtualhost, httpd.conf

我在我的笔记本电脑上设置了虚拟主机，我知道它可以正常工作，因为我经常将它们用于工作和学校，但是无论出于何种原因，当我在父母家里连接到他们的家庭网络时，我都会收到 404'd。如果我从网络断开连接，我会得到 Apache 为页面提供的服务。这是我的 httpd.conf 文件内容（仅处理虚拟主机的部分）：

```
NameVirtualHost *
<VirtualHost *>
    DocumentRoot "/Applications/MAMP/htdocs"
    ServerName localhost
</VirtualHost>

<VirtualHost *>
    DocumentRoot "/Users/kyle/Sites/ESA/app/public"
    ServerName esa.loc
    <Directory "/Users/kyle/Sites/ESA/app/public">
        Options Indexes FollowSymLinks
        AllowOverride all
        Order Deny,Allow
        Allow from all
        Allow from 127.0.0.1
    </Directory>
</VirtualHost>

<VirtualHost *>
    DocumentRoot "/Users/kyle/Sites/portfolio-site/public"
    ServerName kyle.loc
    <Directory "/Users/kyle/Sites/portfolio-site/public">
        Options Indexes FollowSymLinks
        AllowOverride all
        Order Deny,Allow
        Allow from all
        Allow from 127.0.0.1
    </Directory>
</VirtualHost> 
```

和我的 /etc/hosts 文件：

```
##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting.  Do not change this entry.
##
127.0.0.1       localhost esa.loc kyle.loc
255.255.255.255 broadcasthost
::1             localhost esa.loc kyle.loc
fe80::1%lo0     localhost esa.loc kyle.loc 
```

如果您需要更多信息，请告诉我，我会尽力提供。谢谢。

编辑：忘了提到我尝试将我的笔记本电脑添加到路由器上的 DMZ 中，但这并没有解决问题。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-06-12T15:46:37.230

确保取消注释该行

# 包括 conf/extra/httpd-vhosts.conf

在你的 apache conf 文件中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T16:11:26.223

我真的不确定，但 Virtualhost 不应该包含一些关于端口的信息吗？某事喜欢：

```
<VirtualHost *:80> 
```

我认为您可以删除这些行，因为在您的情况下它是无用的

```
NameVirtualHost *

Allow from 127.0.0.1 
```

当您在上面的行中使用“allow from all”时，在“Allow”中使用 ip 地址没有任何意义

# assembly - xmm 指令 - 内存源操作数的分段错误

> ID：14014622
> 
> 赞同：2
> 
> 时间：2012-12-23T20:53:08.680
> 
> 标签：assembly, x86, sse, simd, memory-alignment

我正在尝试使用 XMM 寄存器使用 SSE2 指令将 4 个数字添加到汇编语言中的其他 4 个数字。我确实成功了，但我遇到了一些我不明白的事情。如果我以这种方式添加：

```
movdqu xmm0, oword [var1]
movdqu xmm1, oword [var2]
paddd xmm0, xmm1
movdqu oword [var1], xmm0 
```

它工作得很好。

但如果我这样尝试：

```
movdqu xmm0, oword [var1]
paddd xmm0, oword [var2]
movdqu oword [var1], xmm0 
```

它给了我一个分段错误。

第二种方法有什么问题？我正在使用 Nasm、Intel Atom N270、Linux Mint 12 32 位

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T20:59:01.587

在第二个示例`var2`中需要 16 字节对齐，我怀疑情况并非如此。

在第一个示例中，您使用的是未对齐的加载/存储，因此您看不到那里的问题，但`paddd`第二个示例中的指令需要一个 16 字节对齐的内存操作数。

# curl - ASP.NET MVC curl 等价物

> ID：14014623
> 
> 赞同：4
> 
> 时间：2012-12-23T20:53:09.020
> 
> 标签：curl, asp.net-mvc-4

我很难找到这方面的很多细节。我需要使用一个处理信用卡的api，它使用curl。所有文档都在 php 中，虽然我可以使用 php，但我的主站点完全使用 razor 视图引擎在 MVC4 中。我需要将它从 php 转换为 .net 中可用的东西

```
$ curl https://api.stripe.com/v1/customers -u *private key here*: 
       -d "description=Customer for test@example.com" -d "card[number]=4242424242424242" 
       -d "card[exp_month]=12" -d "card[exp_year]=2013" 
```

在此先感谢您的时间

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T22:03:14.800

来自[curl 手册](http://curl.haxx.se/docs/manpage.html)页

*   `-u, --user <user:password>`是用户凭据
*   `-d, --data <data>`是 POST 数据

因此您可以将其“解码”为：

```
using (var wc = new System.Net.WebClient())
{
    // data
    string parameters = string.Concat("description=", description, "&amp;card[number]=" , cardNumber, "&amp;card[exp_month]=", cardExpirationMonth, "&amp;card[exp_year]=", cardExpirationYear),
           url = "https://api.stripe.com/v1/customers;

    // let's fake it and make it was a browser requesting the data
    wc.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");

    // credentials
    wc.Credentials = new System.Net.NetworkCredential("*private key here*", "");

    // make it a POST instead of a GET
    wc.Headers[HttpRequestHeader.ContentType] = "application/x-www-form-urlencoded";

    // send and get answer in a string
    string result = wc.UploadString(url, parameters);
} 
```

* * *

[使用现有答案](https://stackoverflow.com/a/5401597/28004)的 POST 调整进行更新。

# regex - Powershell，使用正则表达式和特殊字符获取子字符串

> ID：14014626
> 
> 赞同：0
> 
> 时间：2012-12-23T20:53:38.557
> 
> 标签：regex, string, powershell

我必须从这一行中提取用户信息

```
"user/data ^`ms\john ^`Lorem Ipsum Lorem ^`Lorem Ipsum Lorem" 
```

模式是信息总是介于`"user/data ^`“和`"^`”之间

预期结果是“ms\john”

这是我的尝试，

```
$line = "user/data ^`ms\john ^`Lorem Ipsum Lorem ^`Lorem Ipsum Lorem"
if ($line -match "user/data(.*)")
{
    write-host "found: $($matches[1])"
} else {
    Write-Host "no found"
} 
```

我不知道如何在正则表达式中添加特殊字符并提取“ms\john”。

欢迎任何意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T22:20:27.243

你也可以试试这个：

```
$line = "user/data ^`ms\john ^`Lorem Ipsum Lorem ^`Lorem Ipsum Lorem"
if ($line -match "user/data\s+\^`?([^\^]+)")
{
    write-host "found: $($matches[1])"
} else {
    Write-Host "no found"
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T07:12:28.420

还有两个选择：

```
PS> $il = "user/data ^`ms\john ^`Lorem Ipsum Lorem ^`Lorem Ipsum Lorem"

PS> $il -replace '^user/data\ \^`([^\^]+)\ \^.+$','$1'
ms\john

PS> [regex]::Matches($il,'user/data\s\^`([^\^]+)\s\^').Groups[1].Value
ms\john 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T20:56:40.260

尝试这个：

```
$line = "user/data ^`ms\john ^`Lorem Ipsum Lorem ^`Lorem Ipsum Lorem"
if ($line -match "(?<=\^)(.[^\^]*)")
{
    write-host "found: $($matches[1])"
} else {
    Write-Host "no found"
} 
```

# java - 使用 Stanford Parser 获得句子的 K 个最佳解析

> ID：14014631
> 
> 赞同：2
> 
> 时间：2012-12-23T20:54:07.293
> 
> 标签：java, parsing, stanford-nlp

我想对一个句子进行 K 次最佳解析，我认为这可以通过 ExhaustivePCFGParser 类来完成，问题是我不知道如何使用这个类，更准确地说，我该如何实例化这个类？（构造函数是： ExhaustivePCFGParser(BinaryGrammar bg, UnaryGrammar ug, Lexicon lex, Options op, Index stateIndex, Index wordIndex, Index tagIndex) ）但我不知道如何适应所有这些参数

有没有更简单的方法来获得 K 最佳解析？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T14:58:41.317

通常，您通过一个“语法”对象来做事，该`LexicalizedParser`对象提供所有这些东西（语法、词典、索引等）。

从命令行，以下将起作用：

```
java -mx500m -cp "*" edu.stanford.nlp.parser.lexparser.LexicalizedParser -printPCFGkBest 20 edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz data/testsent.txt 
```

在 API 级别，您需要获取一个[`LexicalizedParserQuery`](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/parser/lexparser/LexicalizedParserQuery.html)对象。一旦你有一个`LexicalizedParser lp`（如`ParserDemo.java`），你可以执行以下操作：

```
LexicalizedParser lp = ... // Load / train a model
LexicalizedParserQuery lpq = lp.parserQuery();
lpq.parse(sentence);
List<ScoredObject<Tree>> kBest = lpq.getKBestPCFGParses(20); 
```

A[`LexicalizedParserQuery`](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/parser/lexparser/LexicalizedParserQuery.html)有点等同于 java regex `Matcher`。

注意：目前 kBest 解析仅适用于 PCFG 未分解的语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-16T15:22:43.280

假设您希望使用 Python，这是我根据 Christopher Manning 的回答实现的解决方法。CoreNLP 的 Python 包装器没有实现“K-best 解析树”，因此替代方法是使用终端命令

```
java -mx500m -cp "*" edu.stanford.nlp.parser.lexparser.LexicalizedParser -printPCFGkBest 20 edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz data/testsent.txt 
```

请注意，您需要将 Stanford CoreNLP 和所有 JAR 文件下载到一个目录中，以及安装必备的 Python 库（请参阅导入语句）

```
import os
import subprocess
import nltk
from nltk.tree import ParentedTree

ip_sent = "a quick brown fox jumps over the lazy dog."

data_path = "<Your path>/stanford-corenlp-full-2018-10-05/data/testsent.txt" # Change the path of working directory to this data_path
with open(data_path, "w") as file:
    file.write(ip_sent) # Write to the file specified; the text in this file is fed into the LexicalParser

os.chdir("/home/user/Sidney/Vignesh's VQA/SpElementEx/extLib/stanford-corenlp-full-2018-10-05") # Change the working directory to the path where the JAR files are stored
terminal_op = subprocess.check_output('java -mx500m -cp "*" edu.stanford.nlp.parser.lexparser.LexicalizedParser -printPCFGkBest 5 edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz data/testsent.txt', shell = True) # Run the command via the terminal and capture the output in the form of bytecode
op_string = terminal_op.decode('utf-8') # Convert to string object 
parse_set = re.split("# Parse [0-9] with score -[0-9][0-9].[0-9]+\n", op_string) # Split the output based on the specified pattern 
print(parse_set)

# Print the parse trees in a pretty_print format
for i in parse_set:
    parsetree = ParentedTree.fromstring(i)
    print(type(parsetree))
    parsetree.pretty_print() 
```

希望这可以帮助。

# javascript - d3：正确绘制元素但未向 dom 添加新数据

> ID：14014635
> 
> 赞同：1
> 
> 时间：2012-12-23T20:54:31.787
> 
> 标签：javascript, coffeescript, d3.js

使用 d3，我有一些简单的标记，如下所示：

```
<div id="my-log"></div> 
```

我有一个使用 d3 进行渲染的对象。我有许多可以绘制图表和图形的工具，但这个只是打印日志。

这是代码：

```
class Log

  # Run on DOM Ready
  constructor: (selector,data) ->
    @s = selector
    @data = data || this.mockData()
    this.setup()
    this.draw()

  # Append a message onto the end of the log. Optionally shift the first point off.
  pushData: (message, shift = false) ->
    @data.push message
    @data.shift() if shift
    this.update()

  mockData: ->
    [{
      sender: 'tester',
      message: 'foo bar baz'
    }]

  template: (data) ->
    """
    <div class="sender">#{data.sender}</div>
    <div class="message">#{data.message}</div>
    """

  setup: ->
    @container = d3.select(@s).append('ul').attr('class','log')

  draw: ->
    @container.selectAll('li')
      .data( @data )
    .enter().append('li')
      .html (d) => this.template(d)

  update: ->
    @container.selectAll('li')
      .data( @data )
      .html (d) => this.template(d) 
```

为了初始化它，我这样称呼它：

```
jQuery ->
  myLog = new Log 'div#my-log' 
```

这会正确选择 div 并将消息呈现到其中。

但是，如果我尝试在控制台中添加日志消息：

```
log.pushData({sender:'test', message:'foo'}); 
```

...这不会被渲染到 DOM。如果我`log.data`在控制台中调用，我会看到数据在那里，它只是没有进入 DOM。

我一直无法发现我的错误，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:53:07.197

你忘`.enter`了更新

```
update: ->
    @container.selectAll('li')
      .data( @data )
    .enter().append('li')
      .html (d) => this.template(d) 
```

作为注释，您还应该添加一个`.exit`更新

# javascript - 如何让 tinyMCE 伪造文本/html 切换以启用实时更新更改

> ID：14014636
> 
> 赞同：2
> 
> 时间：2012-12-23T20:54:37.607
> 
> 标签：javascript, tinymce, execcommand

下面的代码响应 tinyMCE 编辑器工具栏上的按钮单击，并将 <--nextpage--> 标记添加到插入符号位置的源标记中。

这很好用。

但是，在我单击源视图，然后返回视觉之前，无法判断占位符已插入。

一旦我点击文本视图，然后返回所见即所得，我就可以看到 wordpress 插入的所见即所得占位符图形，以表示内容中的 <--nextpage--> 元素。

我注意到，当我单击“插入更多标签”按钮时，WordPress 编辑器会以某种方式更新 tinyMCE 编辑器视图以显示“更多标签”占位符图形（无需用户切换视图）。

也许有一个 execCommand 我可以在下面的函数中调用来做同样的事情？mceRepaint 没有这样做。

```
(function() {
    tinymce.create('tinymce.plugins.nextpage', {
        init : function(ed, url) {
            ed.addButton('nextpage', {
                title : 'Next Page Button',
                image : url+'/images/btn_nextpage.png',
                onclick : function() {
                    var prompt_text = "<!--nextpage-->";
                    var caret = "caret_pos_holder";
                    var insert = prompt_text + "<span id="+caret+"></span>";
                    ed.execCommand('mceInsertContent', false, insert);
                    ed.selection.select(ed.dom.select('span#caret_pos_holder')[0]); //select the span
                    ed.dom.remove(ed.dom.select('span#caret_pos_holder')[0]); //remove the span
                    ed.execCommand("mceRepaint"); //DOES NOT REFRESH THE LIVE VIEW

                }
            });
        },
        createControl : function(n, cm) {
            return null;
        },
    });
    tinymce.PluginManager.add('nextpage', tinymce.plugins.nextpage);
})(); 
```

更新：我正在尝试使用 Chrome 的开发工具来跟踪单击 WordPress“插入更多标签”按钮时发生的情况，但它没有向我显示任何内容。我希望公开这些信息，以便在单击该按钮以获得所需结果时可以看到引擎盖下发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T22:31:56.230

我可以通过在我的插入语句之后添加这个命令来让它工作：

```
tinymce.activeEditor.setContent(tinymce.activeEditor.getContent()); 
```

（而不是 mceRepaint 语句）

# sql - JOINING 更多表时 SQL "COUNT" 错误结果

> ID：14014637
> 
> 赞同：1
> 
> 时间：2012-12-23T20:54:51.270
> 
> 标签：sql, count, db2, inner-join

我的 SQL 查询有问题

我有

T1：

```
ID    STATUS   REPORTEDBY  
1     CLOSED   USER1
2     CLOSED   USER2
3     NEW      USER1
4     INPRG    USER1
5     CLOSED   USER1 
```

T2：

```
T1ID  STATUS
1     NEW
1     CHECKING
1     CLOSED

2     NEW
2     CHECKING
2     CLOSED

3     NEW

4     CHECKING
4     INPRG 

5     INPRG
5     CLOSED 
```

结果我想得到这个：

```
USER    NumberHasCHECKING  NumberDifferentFromNewChecking  NumberClosed

USER1          2                         3                      2
USER2          1                         1                      1 
```

我想通过 REPORTEDBY 字段作为结果组

1.  T1 中在 T2 中存在 CHECKING 状态的记录数，

2.  来自 T1 的记录数，现在处于与 T1 中的 NEW 或 CHECKING 不同的状态

3.  以及 T1 中当前处于 CLOSED 状态的 T1 中的记录数。

.

```
select reportedby,count (case when T2.status='CHECKING' then 1 end) as NumberHasChecking,
count (case when T2.status not in ('NEW','CHECKING') then 1 end) as NumberDifferentFromNewChecking, 
count (case when T1.status='CLOSED' then 1 end) as  NumberClosed
from t1
inner join t2 on T1.ID=T2.T1ID
group by reportedby 
```

但是在我进行内部连接之后，我在第二列和第三列得到了更好的结果。如何解决这个问题？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:02:54.227

不确定这是否适用于 DB2：

```
Select 
  ReportedBy,
  Count (Case When t2.Status = 'CHECKING' Then 1 End) As NumberHasChecking,
  Count (Distinct Case When t1.Status Not In ('NEW','CHECKING') Then t1.Id End) As NumberDifferentFromNewChecking, 
  Count (Distinct Case When t1.Status = 'CLOSED' Then t1.Id End) As NumberClosed
From
  t1
    Inner Join
  t2
    on t1.Id = t2.t1Id
Group By 
  ReportedBy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:13:13.983

试试这个：

```
select 
    reportedby,
    sum (T2.CheckingState) as NumberHasChecking, 
    count (case when T1.status not in ('NEW','CHECKING') then 1 end) as NumberDifferentFromNewChecking, 
    count (case when T1.status='CLOSED' then 1 end) as NumberClosed 
from
    T1 inner join 
    (
        SELECT 
            T1ID,
            COUNT(CASE WHEN STATUS='NEW'      THEN 1 END) NewState,
            COUNT(CASE WHEN STATUS='CHECKING' THEN 1 END) CheckingState,
            COUNT(CASE WHEN STATUS='CLOSED'   THEN 1 END) ClosedState
        FROM T2
        GROUP BY T1ID
    ) T2 ON T1.ID=T2.T1ID 
group by reportedby 
```

# mysql - 将 MySQL 日期时间转换为时间戳

> ID：14014641
> 
> 赞同：42
> 
> 时间：2012-12-23T20:55:48.370
> 
> 标签：mysql, datetime, timestamp

我正在尝试将日期时间转换为时间戳，但 mysql 给了我警告，而且转换后的值也是错误的。这是SQL查询

```
UPDATE table1 A, table2 B SET B.date_added=UNIX_TIMESTAMP(STR_TO_DATE(A.date_added, '%M %d %Y %h:%i%p')) WHERE A.id=B.id; 
```

**警告**

```
+---------+------+--------------------------------------------------------------------------+
| Level   | Code | Message                                                                  |
+---------+------+--------------------------------------------------------------------------+
| Warning | 1411 | Incorrect datetime value: '2011-06-11 20:29:02' for function str_to_date |
+---------+------+--------------------------------------------------------------------------+ 
```

**结果**

```
+---------------------+---------------------+
| date_added          | date_added          |
+---------------------+---------------------+
| 2012-02-23 06:12:45 | 2012-12-23 19:08:33 |
+---------------------+---------------------+ 
```

我也尝试了以下查询，但它在时间戳字段中显示 0000-00-00 00:00:00。

```
UPDATE table1 A, table2 B SET B.date_added=UNIX_TIMESTAMP(A.date_added) WHERE A.id=B.id; 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2015-01-15T15:05:05.343

`UPDATE table1 A, table2 B SET B.date_added=UNIX_TIMESTAMP(A.date_added) WHERE A.id=B.id;`

`UNIX_TIMESTAMP('2015-01-15 12:00:00');` 足以将 mysql 日期时间转换为时间戳。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-23T21:00:50.633

请试试这个：

```
UPDATE table1 A, table2 B 
SET B.date_added = FROM_UNIXTIME(A.date_added) 
WHERE A.id=B.id 
```

[参考](http://www.epochconverter.com/programming/mysql-from-unixtime.php)。您似乎对格式化日期戳的方式有疑问。另请查看这篇文章：[我应该使用字段“日期时间”还是“时间戳”？](https://stackoverflow.com/questions/409286/datetime-vs-timestamp)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-13T18:37:12.153

On MySQL 5.5 this works fine:

```
UPDATE `some_table`
SET `timestamp_col` = `datetime_col` 
```

with `datetime_col` of [type `DATETIME`](https://dev.mysql.com/doc/refman/5.6/en/datetime.html) and `timestamp_col` of [type `TIMESTAMP`](https://dev.mysql.com/doc/refman/5.6/en/datetime.html).

That is: no needs of explicit type conversion.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-23T21:06:19.897

您正在使用`'%M %d %Y %h:%i%p'`日期格式，但警告显示日期字符串“2011-06-11 20:29:02”，它与该格式不匹配。即，年份在前，时间为 24 小时制。

您可以`'%Y-%M-%d %T'`改用，该格式将匹配数据。

在此处查看有关日期格式代码的更多信息：http: [//dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

# android - 请帮我理解上下文

> ID：14014648
> 
> 赞同：0
> 
> 时间：2012-12-23T20:56:43.737
> 
> 标签：android, android-context

我很难理解上下文的东西是如何工作的。我现在真的不需要这个，但我相信我很快就会需要这个......

**例子**

我制作了一个名为的应用程序`ave`和一个名为的库（本身就是一个应用程序）`xvf`，每个都有几个活动。他们中的大多数人通过 Toast 提供信息，所以我到处都有相同的方法：

```
public void info(String txt) {
    Toast.makeText(getApplicationContext(), txt, Toast.LENGTH_LONG).show();
} 
```

现在我想将该方法作为一个类放入库中，并从应用程序类和库类的任何地方调用它。我**不想**传递上下文，例如`info.show(context, String)`，我希望类`info`在调用上下文时推断上下文的位置。

所以我做了一个名为`info`：

```
package com.floritfoto.apps.xvf;

import android.app.Activity;
import android.content.Context;
import android.widget.Toast;

public class info extends Activity{
    private Context context;

    public info() {
        super();
        context = (Context)getApplicationContext();
    }
    public void show(String txt) {
        Toast.makeText(context, txt, Toast.LENGTH_LONG).show();
    }
} 
```

然后，在调用活动中，我只创建一个 info 实例，然后执行`info.show(String)`. 这行得通。

`extend Activity`问题是，对于我来说，仅仅获得上下文似乎太昂贵了......

哪种是做我想做的事情的正确方法？做一`info(String)`件事会更好……记住，你不能做一个构造函数`info(Context, String)`，那是作弊。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:34:16.617

我想这完全是靠运气。

您无法使用 Activity 实例化*正确的*Activity `new`，您必须让 Android 框架执行此操作。在这种情况下，它正在工作，因为您正在获取*应用程序*上下文，我猜它是由包所有者计算出来的。

实际上，an`Activity`本身就是 a `Context`（它扩展了它），因此您可以`this`在显示 Toast 时使用。如果您尝试在`info`课堂上这样做，我想它会失败。无论如何，就像 Eric 指出的那样，如果您`Context`在库类中需要一个（这不是一个合适的 Activity），您需要将它作为参数传入才能使用它。

# android - Android NDK：错误：必须使用 -std=c++11 或 -std=gnu++11 编译器选项启用

> ID：14014659
> 
> 赞同：11
> 
> 时间：2012-12-23T20:58:42.297
> 
> 标签：android, android-ndk

我正在尝试在我的 android 应用程序中使用一个大型 c++ 库。我正在使用带有 android ndk 插件的 eclipse。当我运行它时，我收到了这个错误信息；

```
This file requires compiler and library support for the ISO C++ 2011 standard.This
support is currently experimental, and must be enabled with the -std=c++11 or
-std=gnu++11 compiler  options. 
```

我该怎么办？如何在 Eclipse 中启用此选项？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-23T21:12:15.090

将“-std=c++11”添加到您`CFLAGS`的`Android.mk`：

```
LOCAL_CFLAGS += -std=c++11 
```

# javascript - 用 Javascript 发送 POST 数据

> ID：14014663
> 
> 赞同：0
> 
> 时间：2012-12-23T20:59:19.030
> 
> 标签：javascript, forms, image-uploading

我正在上传文件，这样用户在选择文件后不需要点击“上传”按钮。它工作正常，但我还需要发送一个额外的参数，因为我根本不使用 Javascript，所以我不知道如何发送它。
的HTML：

```
<form enctype="multipart/form-data" target="_blank" name="send_img" id="send_img" method="post" action="img_upload.php">
    <input type="hidden" id="group_id" name="group_id" value="2" />
    <input type="file" class="hide" id="uploaded_file" name="uploaded_file" onChange="Handlechange();"/>
    <button type="submit" id="btn">Subir fotos!</button>
</form>

<div onclick="HandleBrowseClick();" id="fakeBrowse" >Load a picture</div> 
```

剧本：

```
<script language="JavaScript" type="text/javascript">
function HandleBrowseClick()
{
    var fileinput = document.getElementById("uploaded_file");
    fileinput.click();
}

function Handlechange()
{
    var fileinput = document.getElementById("uploaded_file");
    var textinput = document.getElementById("filename");
    textinput.value = fileinput.value;
}
</script> 
```

我不知道如何发送 group_id 变量（我在一个 php 变量中，所以它可以在任何地方回显，甚至在脚本中）。我尝试了很多方法都没有运气。那么如何在 img_upload.php 中传递和获取该变量？我以为：

`var group_id = document.getElementById("group_id").value;`

会成功的，但我错了：-/

我还发现有趣的是，如果我将表单标签修改`action="img_upload.php?group_id=2"`为`$_GET['group_id'];`

在 img_upload.php 中，我将另一个变量插入到数据库中。因此，如果我能以一种可以将其放入 php 变量的方式获取该变量，那将是非常酷的（我试图在最后一行中尽可能清楚）。
我还将添加我在 Chrome 开发人员工具中获得的内容：

```
Request Payload
------WebKitFormBoundarydOdbB5IQ8RbA8CRR
Content-Disposition: form-data; name="uploaded_file[]"; filename="photo-5.JPG"
Content-Type: image/jpeg

------WebKitFormBoundarydOdbB5IQ8RbA8CRR-- 
```

这就是让我认为问题出在数据发送脚本中的原因

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:06:49.380

当您单击“提交”时，所有输入字段都将使用 HTTP POST 提交到服务器。

在服务器上，您可以使用 (java) 之类的内容来解释请求

```
request.getAttribute('uploaded_file'); 
```

在 PHP 中，这将类似于：

```
$myFile = $_REQUEST['uploaded_file']; 
```

请参阅[PHP 手册](http://php.net/manual/en/reserved.variables.request.php)。

编辑：您的输入标签无效（删除“/”）：

```
<input type="hidden" id="group_id" name="group_id" value="2"> 
```

编辑2：

添加以下内容（作为测试）：

```
<script type="text/javascript">
var el = document.getElementById('send_img');

el.addEventListener('submit', function(){
alert(document.getElementById("group_id").value);
return true;
}, false);
</script> 
```

# database - EntityFramework 代码优先 - 帐户权限问题

> ID：14014664
> 
> 赞同：0
> 
> 时间：2012-12-23T20:59:37.690
> 
> 标签：database, entity-framework, azure, permissions

我开始使用数据库开发（目标是天蓝色，到达那里......）。我按照[本](https://www.windowsazure.com/en-us/develop/net/tutorials/web-site-with-sql-database/)指南开始了 Azure 开发。

我已经成功：

*   在VS2012中创建了一个网站
*   为 .NET 安装了 azure SDK
*   通过 NuGet 安装实体框架 (EF6alpha)
*   写了我的第一个数据库实体。

当我执行“update-database -ProjectName Models”时，我收到了我缺少权限的错误（数据库'master'中的 CREATE DATABASE 权限被拒绝）。

过了一会儿，我读到一个线程，这可能与特权有关。所以我尝试以管理员身份运行VS，瞧，生成了数据库+表。（也许那一点可能会帮助其他人寻找解决此问题的方法）。

但是现在，回到我的开发帐户中，我仍然不允许更新数据库。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:31:22.267

毕竟这并不太难。

*   启动 MS SQL Server Management Studio（以管理员身份）
*   打开你想加入的数据库
*   打开安全地图
*   右键单击用户 => 添加用户。
*   在对话框中，选择 windows 用户并填写登录名。

完毕。

# design-patterns - DI 容器是服务定位器吗？

> ID：14014666
> 
> 赞同：6
> 
> 时间：2012-12-23T20:59:58.903
> 
> 标签：design-patterns, dependency-injection, inversion-of-control

最近我一直在阅读很多关于 IoC、DI 和服务定位器的内容，但一个问题突然出现在我的脑海中。有时 DI 使用容器来调用依赖项，对吗？但是那个容器不是服务定位器吗？

我看不出这两者之间的区别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T09:46:42.660

[是的，在Composition Root](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)之外使用或传递*DI 容器*是*Service Locator*。根据 Mark Seemann 的定义，*组合根*是：

 **> 组合根是模块组合在一起的应用程序中的（最好）唯一位置。

因此，只要您在*该*唯一位置使用*容器，它就不是**Service Locator*。

 **关于*Service Locator*的使用：有时你不能只使用一个*Composition Root*来配置你的应用程序、外部库或框架的一部分。在这种情况下，您可以使用配置为仅创建预定义和有限类型资源的*抽象工厂*而不是*容器。*这是[Mark Seemann 的另一篇文章“模式识别：抽象工厂还是服务定位器？”](http://blog.ploeh.dk/2010/11/01/PatternRecognitionAbstractFactoryOrServiceLocator.aspx)

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T21:05:08.713

容器注册您的依赖项并可以解决它们。另一方面，定位器使用容器来解析服务。

为了能够使用容器，您必须对它有一个引用。另一方面，定位器通常是静态可用的，您不需要对它的引用。

Locator 被认为是一种反模式，因为它可以让您“就地”解决任何依赖关系，这实际上使依赖关系隐含。这意味着类客户端直到它出现在运行时才知道依赖关系。*****

# linux - 系统包括在 ubuntu 上移动，g++ 无法解析 REG_EIP

> ID：14014669
> 
> 赞同：1
> 
> 时间：2012-12-23T21:00:14.043
> 
> 标签：linux, g++, ubuntu-12.04, linux-mint, ubuntu-12.10

此代码始终无法在 ubuntu 12.04、12.10、linux mint 13 和 14 中构建，但它可以在 ubuntu maverick 10.10 上正确编译

```
#include <stdio.h>
#include <signal.h>
#include <stdio.h>
#include <signal.h>
#include <execinfo.h>
#include <stdlib.h>
#include <string.h>

//#define __USE_GNU
//#include <sys/ucontext.h>

#include <ucontext.h>
#ifndef __USE_GNU
#error "__USE_GNU HAS been undefined"
#endif
#include <cxxabi.h>
#include <iostream>

#ifndef _SYS_UCONTEXT_H
#error "sys/context HAS NOT BEEN INCLUDED"
#endif

void print_trace(const char * file, int line) //(FILE *out, const char *file, int line)
{
    const size_t max_depth = 100;
    size_t stack_depth;
    void *stack_addrs[max_depth];
    char **stack_strings;

    stack_depth = backtrace(stack_addrs, max_depth);
    stack_strings = backtrace_symbols(stack_addrs, stack_depth);

    //fprintf(out, "Call stack from %s:%d:\n", file, line);
// demangle output: http://gcc.gnu.org/onlinedocs/libstdc++/manual/ext_demangling.html
    // spec: http://www.ib.cnea.gov.ar/~oop/biblio/libstdc++/namespaceabi.html

    //string binary;
    // Usually e.start=1: we skip the first frame (traced_exception constructor)
    for( size_t i=1; i<stack_depth; ++i ){
        char *line = stack_strings[i];
        char *lb = strchr(line, '(');
        char *plus = 0;
        char *rb = 0;
        char *demangled = 0;
        if( lb != 0 ){
            /* Print out the path to the binary? Seems pointless.
            if( binary != string( line, lb-line ) ){
                binary = string( line, lb-line );
                stream << "in " << binary << ":\n";
            }
            */
            *lb = '\0';
            plus = strchr(lb+1,'+');
            if( plus != 0 ){
                *plus = '\0';
                int status;
                demangled = abi::__cxa_demangle(lb+1, 0, 0, &status);
                /*if( status != 0 ){
                    cerr << "status: "<<status<<"\tstring:"<<lb+1<<endl;
                }*/
                rb = strchr(plus+1, ')');
            }else{
                rb = strchr(lb+1, ')');
            }
            if( rb != 0 ){
                *rb = '\0';
            }
        }
        if( lb == 0 ){
            std::cout << line;
        }else{
            if( plus != 0 ){
                std::cout << "+" << (plus+1);
            }
            if( demangled != 0 ){
                std::cout << '\t' << demangled;
                free(demangled);
            }else if( lb != 0 && rb > lb ){
                std::cout << '\t' << (lb+1) << "()";
            }
        }
        std::cout << '\n';
    }
    free(stack_strings); // malloc()ed by backtrace_symbols
}

void bt_sighandler(int sig, siginfo_t *info,
                   void *secret) {

  printf("<<< SIGNAL HANDLER >>>\n");
  print_trace("none" , 0);
  void *trace[16];
  char **messages = (char **)NULL;
  int i, trace_size = 0;
  ucontext_t *uc = (ucontext_t *)secret;

  /* Do something useful with siginfo_t */
  if (sig == SIGSEGV)
    printf("Got signal %d, faulty address is %p, "
           "from %p\n", sig, info->si_addr, 
           uc->uc_mcontext.gregs[REG_EIP]);
  else
    printf("Got signal %d#92;\n", sig);

  trace_size = backtrace(trace, 16);
  /* overwrite sigaction with caller's address */
  trace[1] = (void *) uc->uc_mcontext.gregs[REG_EIP];

  messages = backtrace_symbols(trace, trace_size);
  /* skip first stack frame (points here) */
  printf("[bt] Execution path:#92;\n");
  for (i=1; i<trace_size; ++i)
  {
    printf("[bt] %s :", messages[i]);
    char syscom[256];
    sprintf(syscom,"addr2line %p -e %s", trace[i] , "executableName" ); //last parameter is the name of this app
    system(syscom);
    printf("\n");
  }
  exit(0);
}

inline void initialise_signal_handlers()
{
    /* Install our signal handler */
    printf(" initialising signal handlers... \n ");
    struct sigaction sa;

    sa.sa_sigaction = bt_sighandler;
    sigemptyset (&sa.sa_mask);
    sa.sa_flags = SA_RESTART | SA_SIGINFO;

    sigaction(SIGSEGV, &sa, NULL);
    sigaction(SIGUSR1, &sa, NULL);
    sigaction(SIGABRT, &sa, NULL);
    sigaction(SIGINT, &sa, NULL);
    sigaction(SIGBUS, &sa, NULL);
    sigaction(SIGSTKFLT, &sa, NULL);
    sigaction(SIGSYS, &sa, NULL);

    printf(" signal handlers initialised successfully \n ");
} 
```

我尝试用

```
g++ -c SignalHandlers.cpp 
SignalHandlers.cpp: In function ‘void bt_sighandler(int, siginfo_t*, void*)’:
SignalHandlers.cpp:146:34: error: ‘REG_EIP’ was not declared in this scope
SignalHandlers.cpp:152:45: error: ‘REG_EIP’ was not declared in this scope 
```

显然，在 Maverick 之后，`/usr/include/sys/` 被移动到`/usr/include/x86_64-linux-gnu/sys`，但 g++ 编译器路径在此移动之后从未更新。（这就是为什么强制更新操作系统从来都不是一个好主意，最好在更新后让尘埃落定，但似乎这一个上的尘埃兔子仍然受到旋风的影响。）

在任何情况下，直接在 ubuntu 12.04 上包含路径也不起作用：

```
$ g++ -I/usr/include/x86_64-linux-gnu/sys -c SignalHandlers.cpp 
In file included from /usr/include/x86_64-linux-gnu/sys/signal.h:1:0,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
..............................................
                 from SignalHandlers.cpp:4:
/usr/include/x86_64-linux-gnu/sys/signal.h:1:20: error: #include nested too deeply
In file included from /usr/include/x86_64-linux-gnu/sys/signal.h:1:0,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
 ..... and a lot more of those
                 from SignalHandlers.cpp:6:
/usr/include/x86_64-linux-gnu/sys/signal.h:1:20: error: #include nested too deeply
In file included from /usr/include/x86_64-linux-gnu/sys/signal.h:1:0,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/signal.h:1,
.... and lots and lots more of those
                 from /usr/include/x86_64-linux-gnu/sys/ucontext.h:23,
                 from SignalHandlers.cpp:14:
/usr/include/x86_64-linux-gnu/sys/signal.h:1:20: error: #include nested too deeply
In file included from /usr/include/x86_64-linux-gnu/sys/unistd.h:1:0,
                 from /usr/include/x86_64-linux-gnu/sys/unistd.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/unistd.h:1,
                 from /usr/include/x86_64-linux-gnu/sys/unistd.h:1,
.... lots and lots of that error
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/gthr-default.h:42,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/gthr.h:170,
                 from /usr/include/c++/4.6/ext/atomicity.h:34,
                 from /usr/include/c++/4.6/bits/ios_base.h:41,
                 from /usr/include/c++/4.6/ios:43,
                 from /usr/include/c++/4.6/ostream:40,
                 from /usr/include/c++/4.6/iostream:40,
                 from SignalHandlers.cpp:19:
/usr/include/x86_64-linux-gnu/sys/unistd.h:1:20: error: #include nested too deeply
In file included from SignalHandlers.cpp:14:0:
/usr/include/x86_64-linux-gnu/sys/ucontext.h:139:5: error: ‘stack_t’ does not name a type
SignalHandlers.cpp:132:29: error: ‘siginfo_t’ has not been declared
SignalHandlers.cpp: In function ‘void bt_sighandler(int, int*, void*)’:
SignalHandlers.cpp:143:14: error: ‘SIGSEGV’ was not declared in this scope
SignalHandlers.cpp:145:36: error: request for member ‘si_addr’ in ‘* info’, which is of non-class type ‘int’
SignalHandlers.cpp:146:34: error: ‘REG_EIP’ was not declared in this scope
SignalHandlers.cpp:152:45: error: ‘REG_EIP’ was not declared in this scope
SignalHandlers.cpp: In function ‘void initialise_signal_handlers()’:
SignalHandlers.cpp:174:22: error: aggregate ‘initialise_signal_handlers()::sigaction sa’ has incomplete type and cannot be defined
SignalHandlers.cpp:177:29: error: ‘sigemptyset’ was not declared in this scope
SignalHandlers.cpp:178:19: error: ‘SA_RESTART’ was not declared in this scope
SignalHandlers.cpp:178:32: error: ‘SA_SIGINFO’ was not declared in this scope
SignalHandlers.cpp:181:15: error: ‘SIGSEGV’ was not declared in this scope
SignalHandlers.cpp:181:33: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:182:15: error: ‘SIGUSR1’ was not declared in this scope
SignalHandlers.cpp:182:33: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:183:15: error: ‘SIGABRT’ was not declared in this scope
SignalHandlers.cpp:183:33: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:184:15: error: ‘SIGINT’ was not declared in this scope
SignalHandlers.cpp:184:32: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:185:15: error: ‘SIGBUS’ was not declared in this scope
SignalHandlers.cpp:185:32: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:186:15: error: ‘SIGSTKFLT’ was not declared in this scope
SignalHandlers.cpp:186:35: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:187:15: error: ‘SIGSYS’ was not declared in this scope
SignalHandlers.cpp:187:32: error: invalid use of incomplete type ‘struct initialise_signal_handlers()::sigaction’
SignalHandlers.cpp:174:12: error: forward declaration of ‘struct initialise_signal_handlers()::sigaction’ 
```

g++ 版本：

```
$ g++ --version
g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T22:04:39.910

当我不在命令行上使用 -I ... 时，我可以重现您的原始问题。让我翻找一下，看看我能想出什么。

编辑：如果您不更改编译器的 -I （不需要它），那么我认为您需要传递 -m32 （编译为 32 位）或将 REG_EIP 更改为 REG_RIP，因为您（我认为）正在为 64 位编译。

像这样的东西会起作用：

```
#ifdef __x86_64__
#define REG_EIP REG_RIP
#endif 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:11:25.447

您正在为 64 位系统构建，所以`REG_EIP`不存在。它被替换为`REG_RIP`。

# c# - TcpClient：在未连接的套接字上不允许该操作。

> ID：14014673
> 
> 赞同：1
> 
> 时间：2012-12-23T21:01:05.523
> 
> 标签：c#, tcpclient, tcplistener

```
public Server()
    {
        this.tcpListener = new TcpListener(IPAddress.Any, 8000);
        this.listenThread = new Thread(new ThreadStart(ListenForClients));
        this.listenThread.Start();
    }

    private void ListenForClients()
    {
        this.tcpListener.Start();
        while (true)
        {
            TcpClient tcpClient = this.tcpListener.AcceptTcpClient();

            Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientCommunication));
            clientThread.Start(tcpClient);
        }
    }

    private void HandleClientCommunication(object client)
    {

        if (client != null)
        {
            TcpClient tcpClient = (TcpClient)client;
            clientList.Add(tcpClient);
        }

        foreach (TcpClient tc in clientList)
        {
            if (tc.Available > 0)
            {
                int dataSize = tc.Available;
                Console.WriteLine("Received data from: " + tc.Client.Handle);

                string text = GetNetworkString(tc.GetStream());

                //transmit
                foreach (TcpClient otherClient in clientList)
                {
                    if (tc.Client.Handle != otherClient.Client.Handle)
                    {
                        // The problem is here:
                        Send(otherClient.GetStream(), text);
                    }
                }
            }
        }

    }

    private void Send(NetworkStream ns, string data)
    {
        try
        {
                byte[] Bdata = Encoding.ASCII.GetBytes(data);
                ns.Write(Bdata, 0, Bdata.Length);
                ns.Flush();
        }
        catch (Exception ex)
        {
            System.Diagnostics.Debug.WriteLine(ex.Message);
        }

    } 
```

我得到“在未连接的套接字上不允许该操作。” 服务器收到TcpClient发来的3-4条消息后报错。客户端一旦连接到服务器，无论服务器是否关闭，它都会保持在线状态。如果服务器处于活动状态，它可以接收来自服务器的消息。如果服务器关闭，客户端不会抛出任何异常，而是等待服务器启动。

# mysql - SQL：检索总和作为子选择非常慢

> ID：14014674
> 
> 赞同：0
> 
> 时间：2012-12-23T21:01:21.593
> 
> 标签：mysql, performance, sum, subquery

我试图在几行中获取一些平均值和一些总和，按一天中的每个小时分组。另外，我想获取一个额外的列，其中我没有得到每个小时的总和（在分组时获取），但是我想在该特定日期之前获取所有行的总和。SQL 语句发布在下面。

我现在的问题是，在 MySQL 数据库上执行超过 25k 行的查询大约需要 8 秒（CPU i5/8GB RAM）。我发现 subselect ( `... AS 'rain_sum'`) 使它非常慢。我现在的问题是：我的思维方式是否过于复杂？有没有更简单的方法来获得我从下面的查询中得到的相同结果？

```
SELECT
    `timestamp_local` AS `date`,
    AVG(`one`) AS `one_avg`,
    AVG(`two`) AS `two_avg`,
    SUM(`three`) AS `three_sum`,
    (SELECT SUM(`b`.`three`)
        FROM `table` AS `b`
        WHERE `b`.`timestamp_local` <= SUBDATE(`a`.`timestamp_local`, INTERVAL -1 SECOND)
        LIMIT 0,1) AS `three_sum`
FROM  `table` AS  `a`
GROUP BY
    HOUR( `a`.`timestamp_local` ),
    DAY( `a`.`timestamp_local` ),
    MONTH( `a`.`timestamp_local` ),
    WEEK( `a`.`timestamp_local` ),
    YEAR( `a`.`timestamp_local` )
ORDER BY `a`.`timestamp_local` DESC
LIMIT 0, 24; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T09:21:37.083

而不是对所有这些领域进行分组，一个更简单（更快）的解决方案（从[这里](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function%5Funix-timestamp)）可能是：

```
GROUP BY UNIX_TIMESTAMP(timestamp_local)/3600 
```

我无法想象您的查询会返回您想要的结果（如果我正确理解您的要求）。我了解您的要求，因为当给定小时没有行时，您想要计算小时 < 该小时的所有行的总和。MySQL 不会选择空分组（对于子查询部分）。

据我所知，在 MySQL 中没有简单有效的方法来执行此操作，我建议创建一个临时表，其中包含您查看的范围内的所有可能的分组值（可能带有循环）。您可能可以提前几年设置此表，并可能根据需要添加行。然后你可以离开加入这张桌子和你的桌子。

如果您使用的是 MSSQL，则可以使用递归 CTE，尽管这可能会非常慢。查看[这个](https://stackoverflow.com/questions/5291054/generating-depth-based-tree-from-hierarchical-data-in-mysql-no-ctes)或谷歌“mysql cte”以获取 MySQL 替代品。使用递归执行此操作的方法是（左）重复连接同一个表，`HOUR = HOUR+1`直到获得非 NULL 值，然后停止。对于其中的每一个，您将向后计算总和。

# c# - 尝试在 C# winRT 中侦听多播组时出现 UnauthorizedAccessException

> ID：14014675
> 
> 赞同：2
> 
> 时间：2012-12-23T21:01:39.790
> 
> 标签：c#, .net, windows-runtime, multicast

我想使用 Windows.Networking.Sockets.DatagramSocket 在我的 winRT 应用程序的端口 50000 上收听多播组 239.192.168.22。这是我的代码片段：

```
class UdpSocketAnstraction : IDisposable
{
    DatagramSocket socket;

    public UdpSocketAnstraction()
    {
        this.socket = new DatagramSocket();
        this.socket.MessageReceived += socket_MessageReceived;
    }

    public async Task Open()
    {
        await this.socket.BindServiceNameAsync("50000");
        this.socket.JoinMulticastGroup(new HostName("239.192.168.22"));
    }
} 
```

JoinMulticastGroup 抛出 UnauthorizedAccessException ，但没有解释原因。

我不知道这个套接字是否使用不当，或者我是否必须在我的窗户上允许某些东西，或者其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:13:43.387

在 Package.appxmanifest 文件中添加“Internet（客户端和服务器）”功能。双击它并转到声明选项卡。

# console - 为控制台编写文本编辑器

> ID：14014677
> 
> 赞同：-1
> 
> 时间：2012-12-23T21:02:19.287
> 
> 标签：console

我希望能够有一个带有抬头显示的编辑区域，就像在 vi 或 emacs 中找到的那样。有图书馆可以让我这样做吗？不需要跨平台支持，只有 Linux 就可以了。我的首选语言是 C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:27:59.343

你可以看看[ncurses](http://en.wikipedia.org/wiki/Ncurses)。

# mysql - mysql - 在 2 个表中的 Id 列和 INSERT 最大值上设置外键约束？

> ID：14014679
> 
> 赞同：0
> 
> 时间：2012-12-23T21:02:52.370
> 
> 标签：mysql, foreign-keys

我正在尝试设置一个约束，以便在向`Item`表中插入一条记录时 - 一条记录被插入到`itemIndustryCodesLookup`分配表中。

这在 MySql (InnoDB) 数据库中是否可行？

我将如何设置它？

例如，这是我希望能够制作的插入物。`itemPrice`可以为空，因为它默认为 0.00，我`itemIndustryCodesLookupId`实际上想成为表中的下一个可用`itemIndustryCodesLookupId`值`itemIndustryCodesLookup`。Column`isEnabled`是一个 Bit 列，默认值为 0。

```
INSERT INTO `nextcart`.`item`
(`itemId`,
`itemName`,
`itemSku`,
`itemPrice`,
`itemIndustryCodesLookupId`,
`isEnabled`)
VALUES
(
NULL,
'Max Extract All-Terrain Carpet Washer',
'F7452900',
NULL,
NULL,
NULL
); 
```

这是我在`Item`桌子上运行的 Alter 语句。

```
ALTER TABLE `item` ADD CONSTRAINT industry_codes_refs FOREIGN KEY (`itemIndustryCodesLookupId`) REFERENCES `itemindustrycodeslookup` (`itemIndustryCodesLookupId`); 
```

这是我得到的错误：错误代码：1048。列“itemIndustryCodesLookupId”不能为空

我想我的另一个问题是，我设置正确吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:14:11.790

1）“我正在尝试设置一个约束，以便在将记录插入项目表时 - 将记录插入到第二个分配表中。

这在 MySql (InnoDB) 数据库中可行吗？”

要实现该功能，您必须使用触发器。

2）您不能使用包含 NULL-s 的列作为告诉您错误的外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:14:26.983

我建议使用[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)。在那里，您可以指定将行插入第一个表后执行的查询

# haskell - 如何实现 index-core 风格的 indexed continuation monad

> ID：14014683
> 
> 赞同：7
> 
> 时间：2012-12-23T21:03:34.820
> 
> 标签：haskell, monads

我最近一直在看（并试图理解）索​​引单子。我想我已经了解了一种索引 monad 的风格，如下所述：[A Neighborhood of Infinity: Beyond Monads](http://blog.sigfpe.com/2009/02/beyond-monads.html)。

但是，我在[index-core](http://hackage.haskell.org/packages/archive/index-core/1.0.1/doc/html/Control-IMonad-Core.html)中发现了一种不同风格的索引 monad ，它的某些部分似乎与这个带有两个索引的索引 monad 绑定相对应，例如类似的绑定运算符[!>=](http://hackage.haskell.org/packages/archive/index-core/1.0.1/doc/html/Control-IMonad-Restrict.html#v%3a-33--62--61-)。虽然它显然对索引有类似的更改，但我不太明白如何使用这些索引，例如，像使用其他样式一样控制延续 monad 中的返回类型。我会对这种索引 monad 风格感兴趣，主要是因为它似乎对 monad 转换器工作得更好——事实上，我还没有看到以另一种风格定义的索引 monad 转换器（索引 monad），只有一个索引转换器常规单子。

我想知道是否有人可以提供一个实现为这种延续 monad 风格的两种结果类型延续 monad 的示例，或者指出使用此模块定义其他使用两个索引的索引 monad 的其他示例（例如例如，状态类型可能改变的状态单子的形式）。我一直在寻找这样的例子，没有太多运气，我自己也没有成功实现它。我觉得这应该很明显，但是我在不同的构造函数中有点束缚。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T14:52:28.800

我是`index-core`包的作者，答案是可以的。这是解决方案：

```
{-# LANGUAGE TypeOperators, RankNTypes #-}

import Control.Category.Index
import Control.IMonad
import Data.Functor.Identity

newtype ICont f a i = ICont { runICont :: (a :-> f) -> f i } 
```

请注意，我使用`f`而不是`r`. s将`r`成为索引。

`IFunctor`和的实现`IMonad`与普通 monad 的实现相同（就像博客文章的版本一样）：

```
instance IFunctor (ICont f) where
    fmapI f m = bindI (returnI . f) m

instance IMonad (ICont f) where
    returnI a = ICont $ \k -> k a
    bindI f m = ICont $ \k -> runICont m $ \a -> runICont (f a) k 
```

诀窍是意识到它会减少到您在博客文章中看到的版本`f = Identity`

```
 (a -> r2) -> r1
~ (a -> Identity r2) -> Identity r1
~ ((a := r2) r2 -> Identity r2) -> Identity r1
~ ((a := r2) :-> Identity) -> Identity r1
~ ICont Identity (a := r2) r1
~ R ICont Identity r1 r2 a 
```

唯一的区别是额外`R`和`Identity`噪音，如果您选择匹配博客文章的版本，您可以将其抽象掉：

```
type ICont' r1 r2 a = ICont Identity (a := r2) r1 
```

这是使用编写的函数的示例`ICont`

```
-- example ~ (String -> Int) -> Char
-- example ~ ((String := Int) Int -> Identity Int) -> Identity Char
example :: ICont' Char Int String
example = ICont $ \k -> Identity $
    case runIdentity (k (V "Hello")) of
        0 -> 'A'
        _ -> 'B' 
```

该`index-core`图书馆的灵感来自 Conor McBride 的论文：[Kleisli Arrows of Outrageous Fortune](https://personal.cis.strath.ac.uk/conor.mcbride/Kleisli.pdf)。请注意，Conor 的方法比博客文章中的方法需要更多的详细信息，但它提供了博客文章中没有的额外功能，主要是能够在索引中存储更强大的信息，从而提供更大的灵活性。

这对您来说意味着，如果您不需要那些额外的功能，那么您可能应该使用您在博客文章中看到的那个。但是，无论您选择什么，我都强烈建议您阅读 Conor 的论文，因为它是一篇非常出色的论文，并展示了 Haskell 类型系统的强大功能。

我没有`index-core`为 . 如果您想查看使用的具体代码`index-core`，只需查看我用来实现带索引的免费 monad 转换器`2.2.0`的包的版本。但是，我不再使用该类型，尽管我仍然维护包。`pipes``index-core``index-core`

如果您还有其他问题，请随时提问！

# iphone - iOS在线高分与cocos2d

> ID：14014687
> 
> 赞同：3
> 
> 时间：2012-12-23T21:04:12.563
> 
> 标签：iphone, ios, cocos2d-iphone, game-center

我有一个简单的游戏，为了保存高分，我想在本地和全球都这样做。我对 Game Center 有所了解，但在进入它之前，我想知道是否还有其他可以运行良好、免费且与 cocos2d 一起使用的服务？

还有一种方法可以在 Game-Center 上保存本地和全球高分吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T03:13:11.467

您可以使用一些全球服务。不幸的是，OpenFeint 上周刚刚关闭，但有一些替代方案可以做到这一点。Crystal、Geosophic 和 Plus+ 都是 Game Center 的可行替代品，它们都有全球排行榜并与 Cocos2d 一起使用。如果您需要帮助决定使用哪一个，请查看此链接[http://www.cocos2d-iphone.org/forum/topic/19753](http://www.cocos2d-iphone.org/forum/topic/19753)他们比较了这些不同服务之间的功能。希望这可以帮助。

# c++ - 重定向标准 I/O：freopen + stdin/stdout vs open + dup2

> ID：14014690
> 
> 赞同：1
> 
> 时间：2012-12-23T21:04:39.900
> 
> 标签：c++, linux, unix, io-redirection

我想将标准输入/标准输出重定向到某个文件。该程序是为 Unix OS 编写的，但我认为使用标准 C/C++ 库而不是 OS 函数是好的。我知道如何使用操作系统功能来做到这一点`dup2()`，`open()`但我阅读了一些使用`reopen()`on`stdin`或`stdout`. 重新打开标准变量会做我想要的吗？它会替换以 0 和 1 文件描述符打开的文件吗？哪种方式更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:22:59.643

由于您正在编写自己的 shell，我将使用 dup2() 和 open() 的较低级别的函数。

标准输入上的 freopen() 将关闭原始标准输入，并在标准输入位置打开您要求的文件 - 所以您现在已经丢失了标准输入。当然，如果您使用 open() 和 dup2() 替换文件句柄 0 或 1，这并没有太大的区别 - 您仍然会丢失原始标准输入，所以只有在分叉后才这样做。

# magento - Magento - 免费送货留言

> ID：14014696
> 
> 赞同：2
> 
> 时间：2012-12-23T21:05:48.573
> 
> 标签：magento, message, shipping

如何在产品列表和产品页面和购物车中显示免费送货消息。只有当产品的价格大于 50 美元时，该消息才会出现在产品列表和产品页面中，如果总价大于 50 美元，则必须出现在购物车中。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T23:40:10.427

您可以下载此扩展[免费送货激励](http://www.magentocommerce.com/magento-connect/creare-free-shipping-incentive.html)并修改/升级/编辑等，按照您想要的方式更改它。

从以下方面获取想法：

1.  [这里](http://www.immense.net/magento-free-shipping-certain-products/)
2.  [这里](http://www.ankitsharma.info/blog/magento-free-shipping-on-specific-category-product)
3.  [这里](http://www.magentocommerce.com/boards/viewthread/40357/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T07:01:48.767

**嗨 Marcelo**，
要在产品详细信息页面上显示免费送货信息：`template/catalog/product/view.phtml`

```
$productprice = echo $_product->getPrice();
if($productprice >= 50)
{
echo 'free shipping is available for this product if cart total is greater than $50';
} 
```

要显示在产品列表页面上，以在产品图片“免费送货”上方添加照片标记。路径：`template/catalog/category/view.phtml`添加与上述类似的条件

购物车总计超过 50 美元可享受免费送货：
转到管理员：

```
System > Configuration > Sales > Shipping Methods 
```

**已启用**：是
**最小购物车总数**：50
希望这对您有所帮助。. .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-27T12:45:14.533

已成功使用上述内容并添加第二条消息以鼓励人们购买最高 50.00 英镑的免费送货服务

```
 <?php if ($_product->getSpecialPrice() > 50.00):
        echo $this->__('With Free UK Shipping');
        endif; ?>

        <?php if ($_product->getSpecialPrice() < 50.00) :
        echo $this->__('Spend £50.00 To Get Free UK Shipping');
        endif; ?> 
```

问题是这些消息仅基于 SpecialPrice 但如果 SpecialPrice 为 null 或 0，我需要它显示基于价格 (RRP) 的消息 不是一个很好的编码器，但可以在一些帮助下做 还希望有声明显示更多需要在免费送货前购买

# php - PHP 在页面上使用 FOREACH div 发送电子邮件？

> ID：14014697
> 
> 赞同：0
> 
> 时间：2012-12-23T21:05:54.147
> 
> 标签：php, jquery, email

我正在做一种联系表单，用户可以根据需要添加任意次数的表单，其中`div`包含 3 个内容：1 个选择框和 2 个文本框。

我想知道如何选择所有框并将其添加到一个不错的 PHP 电子邮件函数中以像这样将其发送干净：

```
Select1
Textbox1
Textbox1-1

select2
textbox2
textbox2-2 
```

有关我如何进行的更多信息，请查看以下内容：

我使用 Jquery 克隆包含 3 个元素的当前框，使用以下行：

```
$('#element_1').clone().attr('id', 'element_' + ++counter).appendTo('.container'); 
```

然后我再次使用 jQuery`.attr()`函数更改此框中的每个元素。每个元素都有自己的 ID，遵循`+1`每个人的简单模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:10:58.600

真正的问题是什么？只要确保所有 div 块都被克隆到`<form></form>`标签中，它们将在表单提交时继续到服务器端。如果您正在为如何处理这些输入字段的问题而苦苦挣扎，请使用 [] 括号作为输入名称，这样它们将作为数组出现在您的脚本中，您可以遍历它们。（例如`input name="name[]"`：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:16:06.213

不要添加计数器。这使得很难在 php 中访问。改为使用数组作为输入名称。

例子：

```
<select name="selectbox[]">
    <option value="1">1</option>
    <option value="2">2</option>
</select>
<input name="textbox[]" />
<input name="textbox2[]" />

<select name="selectbox[]">
    <option value="1">1</option>
    <option value="2">2</option>
</select>
<input name="textbox[]" />
<input name="textbox2[]" /> 
```

php:

```
foreach( $_POST['textbox'] as $i => $textbox ) {
    // use $i as the key to get other inputs

    $textbox2 = $_POST['textbox2'][$i];
    $select = $_POST['selectbox'][$i];

    // 1 entire set of inputs
    echo $select;
    echo "<br />";
    echo $textbox;
    echo "<br />";
    echo $textbox2;
    echo "<br /><br />";
} 
```

# javascript - 使用 Twitter Bootstrap 从 JSON 加载模态内容

> ID：14014699
> 
> 赞同：2
> 
> 时间：2012-12-23T21:06:16.920
> 
> 标签：javascript, json, twitter-bootstrap

有没有办法可以使用来自 JSON 响应的数据加载 Modal？

例如，

这是退出我的应用程序的链接：

```
 <a tabindex="-1" href="/ajax/account/logout" data-toggle="modal" data-target="#ajax" class="modal-link">Sign Out</a> 
```

在正常情况下，响应将是：

```
 {"html":"htmlsource",
  "resultCode":1} 
```

html 包含要放入模式的内容的 HTML，所以我需要做的就是提取 html 数据并将其推送到 div 容器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:11:11.813

当然; 例如，`html()`jQuery 函数会将其参数推入您想要的任何元素中，包括 Modal。在您的情况下，假设“html”项具有您想要放入模态的内容，您会执行类似`$("#id-of-modal").html(response.html)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T23:59:58.757

有了这个：

```
$.getJSON(url).success(function(data) {
   $('#ajax, div').replaceWith(data.html);
   $('#ajax').modal();
}); 
```

# java - 如何确保类型参数仅以协变方式使用？

> ID：14014701
> 
> 赞同：7
> 
> 时间：2012-12-23T21:06:38.447
> 
> 标签：java, unit-testing, generics, static-analysis, covariance

假设我有`Source<T>`一个纯`T`对象生产者的通用接口。作为一个纯粹的生产者是接口契约的一部分。因此[，一个合理的期望](http://java.sun.com/docs/books/effective/generics.pdf)是，无论你用 a`Source<Foo>`做什么，如果你有 a 也应该可以做到`Source<? extends Foo>`。

现在我需要在 的正文中强制执行此限制`Source`，以免有人意外`T`以与该合同相矛盾的方式使用。

**来自 JDK 的示例**

正如@Miserable.Variable 指出的那样*，*`ArrayList<Integer>`并不`ArrayList<? extends Integer>`等同。那是因为它作为泛型类型不是协变的。或者换句话说，不是一个纯粹的生产者；具体来说，该方法**消耗**一个.*`ArrayList``ArrayList<T>``T``ArrayList``add(T)` **`T`***

 ***但是有一些泛型类型是纯粹的生产者，比如`Iterator`or `Iterable`。无论你可以用一个做什么，`Iterator<Integer>`你也可以用一个`Iterator<? extends Integer>`。没有类似`ArrayList.add(T)`in 的方法`Iterator<T>`。

我只是想确保我的界面`Source<T>`是 like`Iterator<T>`而不是 like `ArrayList<T>`。如果将来有人在我的界面中添加了一个`T`消耗方法（如`add(T)`），我希望他们得到一个明确的错误。

**一个更复杂的例子**

简单地禁止类型参数`T`出现在界面中并不是一个完整的解决方案。还应该注意，它`T`可能被用作其他泛型类型的参数。例如，在 中不应允许以下方法`Source<T>`：

```
public void copyTo(List<T> destination); 
```

因为偷偷摸摸的子类可能会尝试从列表中读取，所以它被认为是`T`-consumer；您不能在`Source<? extends Foo>`. 另一方面，应该允许这个：

```
public void copyTo(List<? super T> destination); 
```

（还有另一条规则说方法 in`Source<T>`不能返回 a `List<T>`，但可以返回 a `List<? extends T>`。）

现在，实际的接口可以任意复杂，有很多方法，规则本身也很复杂。很容易犯错。所以我想自动化这个检查。

是否有单元测试技巧、静态分析器、编译器/IDE 插件、注释处理器（例如带有`@Covariant`注释`T`）或任何其他可以为我确保这一点的技术或工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T19:30:05.200

这不是一个答案，但太长了，无法放入评论中。

> 因此，合理的期望是`Source<Foo>`，如果您有 a ，则您可以用 a 做的任何事情也应该可以做`Source<? extends Foo>`

不，这不是一个合理的期望。您链接到整个 pdf 并转到[顶级页面](http://www.oracle.com/technetwork/java/index.html)，因此不清楚您如何确定这是合理的，但通常您不能随意将 a 替换为`Foo<T>`a `Foo<? extends T>`。举个例子，如果你有一个`ArrayList<Integer> a`你可以打电话`a.Add(Interger.valueOf(5))`但你不能这样做如果`a`是 `ArrayList<? extends Integer> a`。

也不清楚什么是`Consumer<T>`和`sendTo`。后者是`Source<T>`>中的方法吗？

如果没有这些澄清，恐怕他的问题是模棱两可的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:47:49.763

好吧，如果您不想在您的界面中使用任何 put() 方法，您所要做的就是不要编写任何方法并在代码中的某处留下对此效果的注释；最好在它周围有很多星号。

老实说，我完全不明白拥有一个特性的用处，它可以让语言有可能阻止类或接口的一些逆变方法。这是程序员的责任，而不是编译器。

这就像您要求提供一种功能，该功能使您有可能阻止添加任何接受整数作为其参数之一或作为其返回值的函数。在我看来，在语言中拥有这样的功能是完全没用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:47:01.300

也许不是您正在寻找的答案，但我想您可以在接口声明中强制执行它。

## 强制逆变使用

```
public interface Consumer<T, S extends T> {
   public void consume(S item);
}

public static class ConsumerImpl<T, S extends T> implements Consumer<T, S> {

   private List<? super S> items = new ArrayList<T>();

   public void consume(S item) {
      this.items.add(item);
   }

} 
```

然后你可以像这样使用它：

```
Consumer<Object, String> consumer = new ConsumerImpl<Object, String>();
consumer.consume("Whatever");
consumer.consume("Another"); 
```

## 强制协变使用

当然，相反的情况也是可能的：

```
public interface Producer<T, S extends T> {
   public T produce();
}

public static class ProducerImpl<T, S extends T> implements Producer<T,S> {

   private Deque<? extends T> items = new ArrayDeque<S>();

   public ProducerImpl(Deque<S> items) {
      this.items = items;
   }

   public T produce() {
      return items.pop();
   }

} 
```

你可以像这样使用它：

```
Deque<Integer> myInts = new ArrayDeque<Integer>();
myInts.push(1);
myInts.push(2);

Producer<Number, Integer> producer = new ProducerImpl<Number, Integer>(myInts);
Number n1 = producer.produce();
Number n2 = producer.produce(); 
```

在这两种情况下，我都强制底层结构要么是逆变的，要么是协变的。***

# django - 传递 request.user 以查看而不更改 url

> ID：14014704
> 
> 赞同：2
> 
> 时间：2012-12-23T21:06:49.647
> 
> 标签：django, django-templates, django-views

我正在尝试编写一个检索当前登录用户信息的视图。

我的视图如下所示，只要我将用户传递到 URL 中的视图，它就可以正常工作。

```
def index(request, username, template="index.html"):

    user = get_object_or_404(User,
                             username__iexact=username)

     expression_qs = Expression.objects.all().order_by('-created')
     album_qs = Album.objects.all().filter(head__isnull=False, is_public=True).order_by('-created')

    user_following = user.relationships.following()

    following_expressions = positive_filter(expression_qs, user_following, 'user')
    following_albums = positive_filter(album_qs, user_following, 'user')
    following_feed = sorted(
        chain(following_albums, following_expressions),
        key=attrgetter('created'), reverse = True)

    return render(request, template, locals()) 
```

但是，由于这是主页的视图，我不希望**修改**URL。我宁愿（在模板或视图中）描述如果用户登录或未登录会发生什么的逻辑（如果他们已登录，则显示活动提要，如果没有，只需返回带有登录的静态页面形式）。

我的问题是，我如何将 request.user （但不通过 url）传递给视图，以便它返回当前用户的查询集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:11:58.537

您实际上不必通过 url 传递任何内容。您可以从 request.user 直接访问已登录的用户。[您可以在此处](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.user)阅读有关此内容的信息。此外，您可以使用 is_authentcated() 方法或 login_required 装饰器检查用户是否登录

```
def ur_view(request):
   #Check if the user is logged in
   if not request.user.is_authenticated():
          #your logic if user not logged in
   else:
        #If the user is logged in 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:10:22.173

你需要[login_required](https://docs.djangoproject.com/en/dev/topics/auth/#the-login-required-decorator)装饰器。

```
@login_required
def index(request, template="index.html"):
    user = request.user # get the currently logged in user 
```

如果用户已登录，他/她可以访问活动提要，否则他们将被重定向到登录页面。这将确保只有经过身份验证的用户才能访问 this `view`。而且您始终可以使用`request.user`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:10:11.720

登录的用户对象也在请求对象中。采用：`request.user`

[在django auth 文档](https://docs.djangoproject.com/en/dev/topics/auth/#s-authentication-in-web-requests)中查看更多信息

# osx-mountain-lion - brew doctor：警告：在 /usr/local/lib 中发现了未酿造的 dylib

> ID：14014712
> 
> 赞同：9
> 
> 时间：2012-12-23T21:09:49.993
> 
> 标签：osx-mountain-lion, homebrew, dylib

跑步

> 冲泡医生

给了我这个：

> 警告：在 /usr/local/lib 中发现了未编译的 dylib。如果您不是故意将它们放在那里，它们可能会在构建 Homebrew 公式时引起问题，并且可能需要删除。
> 
> 意外的dylib：
> 
> /usr/local/lib/libqmi_api.dylib
> 
> /usr/local/lib/libvousb.dylib

有谁知道这些dylibs是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-09T13:09:56.287

如果您仍然需要它们，我认为您应该尝试升级这些库。**我对libusb**也有同样的问题，我通过“酝酿”升级解决了这个问题。

```
brew upgrade libqmi_api
brew upgrade libvousb 
```

有时，brew 无法将 lib 符号链接到 /usr/local。当您已经拥有 lib 的旧符号链接版本时，会发生这种情况。

```
brew link --overwrite libusb 
```

应该做的东西。

这是我的**libusb**库测试用例：

```
$ brew doctor
Warning: Unbrewed dylibs were found in /usr/local/lib.
If you didn't put them there on purpose they could cause problems when
building Homebrew formulae, and may need to be deleted.

Unexpected dylibs:
    /usr/local/lib/libusb-1.0.0.dylib

$ brew upgrade libusb
==> Upgrading 1 outdated package, with result:
libusb 1.0.9
==> Upgrading libusb
==> Downloading http://downloads.sourceforge.net/project/libusb/libusb-1.0/libusb-1.0.9/libusb-1.0.9.tar.bz2
######################################################################## 100,0%
==> ./configure --prefix=/usr/local/Cellar/libusb/1.0.9
==> make install
Warning: Could not link libusb. Unlinking...
Error: The `brew link` step did not complete successfully
The formula built, but is not symlinked into /usr/local
You can try again using `brew link libusb'

Possible conflicting files are:
/usr/local/lib/libusb-1.0.0.dylib
==> Summary
  /usr/local/Cellar/libusb/1.0.9: 11 files, 420K, built in 9 seconds

$ brew link --overwrite libusb
Linking /usr/local/Cellar/libusb/1.0.9... 5 symlinks created

$ brew doctor
Your system is ready to brew.
$ 
```

希望这可以帮助。

# c++ - C++ 中每隔一定分钟调用一次函数的方法

> ID：14014713
> 
> 赞同：2
> 
> 时间：2012-12-23T21:09:55.913
> 
> 标签：c++, timer, function-call

我正在使用 Visual Studio 2012 和 C++，我需要每 5 分钟调用一次函数，我已经设法做到了，但它消耗了我 25% 的 CPU，这远非理想。

代码如下，

```
time_t start;
time_t end;
time(&start);
while (1) {
time(&end);
double dif = difftime (end,start);
if (dif >= 300) { autofunction(); time(&start);} else {} } 
```

有没有更高效的 CPU 方法来每 5 分钟调用一次函数，或者有什么方法可以减慢我的 while 循环？

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:19:10.623

Windows 有 Sleep()，对于每 300 秒发生一次的事情，这非常好。Windows 中也有计时器，它可能需要一个 timerproc 参数，它是一个函数 - 但请注意，这是一个 C 函数，而不是 C++，因此它不能是类成员函数，除非它是静态函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:46:23.490

由于没有人建议，您可以在其中生成一个新`std::thread`的`Sleep`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:42:39.177

你所做的就是[忙着等待](http://en.wikipedia.org/wiki/Busy_waiting)。您不断检查经过的时间，因此耗尽了 CPU 时间。

由于您使用的是 Windows，因此可能会对[使用计时器队列感兴趣。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687003%28v=vs.85%29.aspx)

这将创建一个带有回调函数的计时器。您可以在等待计时器到期的同时做其他工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T22:08:03.650

我认为最好的答案将取决于您正在做的更多细节。如果您只需要大约 5 分钟，也许您可​​以将经过持续时间的计算放在更方便编程的位置，当您检查时，您将在 5 分钟后第一次运行任务。

否则，似乎@BartekBanachewicz 有启动线程的最佳建议，该线程使用`sleep`--- 而不会阻塞您的主线程执行您正在执行的任何操作。只要您的主线程肯定会运行超过 5 分钟，那么总是`join()`在最后或任何时候重新启动线程应该不是问题。

使用线程的好处是不需要任何特定于 Windows 的东西——例如@OlafDietsche 的建议，无论定时器队列是什么。使用 c++0x，线程非常易于使用，请参阅：[http](http://en.cppreference.com/w/cpp/thread/thread) ://en.cppreference.com/w/cpp/thread/thread ；[http://www.justsoftwaresolutions.co.uk/threading/multithreading-in-c++0x-part-1-starting-threads.html](http://www.justsoftwaresolutions.co.uk/threading/multithreading-in-c++0x-part-1-starting-threads.html)

# python - ipython：暂时转到 shell，稍后返回当前 ipython 会话

> ID：14014714
> 
> 赞同：3
> 
> 时间：2012-12-23T21:10:02.100
> 
> 标签：python, windows, ipython

我正在从 Windows 命令行运行 ipython。我想知道 ipython 中是否有一个功能可以让我暂时进入 shell（cmd.exe），然后返回到当前的 ipython 会话。

我知道使用“！” 执行 shell 命令。但这不是我想要的。

人们提出了一个可行的解决方案，所以我[在这里](https://stackoverflow.com/a/14065704/695964)回答了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T09:54:12.973

`!cmd`您可以通过在 iPython 中执行命令来启动新的控制台 shell 。当您退出该控制台时，您将返回到 iPython 提示符。

这类似于使用`!sh`或`!bash`创建子 shell 的 UNIX 技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T06:43:11.110

人们评论并建议了一种可行的方法 - 使用 !cmd 或 !powershell 启动新的命令会话，并通过退出该 shell 返回。

例子：

```
C:\>ipython
Python 2.7.2 (default, Jun 24 2011, 12:22:14) [MSC v.1500 64 bit (AMD64)]
Type "copyright", "credits" or "license" for more information.

IPython 0.13.1 -- An enhanced Interactive Python.
?         -> Introduction and overview of IPython's features.
%quickref -> Quick reference.
help      -> Python's own help system.
object?   -> Details about 'object', use 'object??' for extra details.

In [1]:

In [1]: !cmd
Microsoft Windows [Version 6.2.9200]
(c) 2012 Microsoft Corporation. All rights reserved.

C:\>exit

In [2]: 
```

# jsf-2 - 简单的特立尼达导航

> ID：14014715
> 
> 赞同：0
> 
> 时间：2012-12-23T21:10:02.260
> 
> 标签：jsf-2, myfaces, trinidad

我遵循了 Trinidad 的导航开发指南中的第一个示例，但结果链接始终显示为“#”。我仔细检查了他们的可下载示例，但没有发现任何区别。

**主要.xhtml**

```
<tr:page>
    <f:facet name="menuSwitch">
        <tr:navigationPane hint="button">
            <tr:commandNavigationItem text="Home" action="nav_main" />
            <tr:commandNavigationItem text="About" />
            <tr:commandNavigationItem text="Login" action="nav_login" rendered="#{!loginBean.loginStatus}" />
            <tr:commandNavigationItem text="Logut"
                rendered="#{loginBean.loginStatus}" />
        </tr:navigationPane>
...snip
</tr:page> 
```

**人脸配置.xml**

```
<navigation-rule>
    <navigation-case>
        <from-outcome>nav_main</from-outcome>
        <to-view-id>/main.xhtml</to-view-id>
        <redirect/>
    </navigation-case>
    <navigation-case>
        <from-outcome>nav_login</from-outcome>
        <to-view-id>/login.xhtml</to-view-id>
        <redirect/>
    </navigation-case>
 </navigation-rule> 
```

main.xhtml 和 login.xhtml 都位于 WebContent 中，而不是隐藏在另一个文件夹中。

我读了这个链接： http: [//myfaces.apache.org/trinidad/devguide/navigation.html](http://myfaces.apache.org/trinidad/devguide/navigation.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T03:36:46.777

好的，新手错误。我没有阅读整个 Trinidad 示例代码，并且错过了围绕整个内容的 Form 标签。

```
<tr:page>
        <f:facet name="menuSwitch">
            <tr:form>
            <tr:navigationPane hint="button">
                <tr:commandNavigationItem text="Home" action="navMain" />
                <tr:commandNavigationItem text="About" />
                <tr:commandNavigationItem text="Login" action="navLogin" rendered="#{!loginBean.loginStatus}" />
                <tr:commandNavigationItem text="Logut"
                    rendered="#{loginBean.loginStatus}" />
            </tr:navigationPane>
            </tr:form>
        </f:facet>
...snip
</tr:page> 
```

# javascript - 我应该如何在打开 SimpleModal 对话框的 BackBone.js 视图中取消绑定事件？

> ID：14014718
> 
> 赞同：3
> 
> 时间：2012-12-23T21:10:40.753
> 
> 标签：javascript, backbone.js, simplemodal

每次创建视图并打开对话框时，我都会收到`n`一组事件，其中`n`对话框打开的次数是多少。在下面的示例中，每次单击`fooButton`我都会收到`n`按钮单击事件。我知道我应该取消绑定事件但`this.undelegateEvents()`没有工作。

根据我对 SimpleDialog （和其他对话框小部件的工作方式）的理解，创建对话框时 div 的内容被复制到另一个元素中，这表明我应该能够捕获创建的元素（比如`$dialog = this.$el.modal();`）然后调用取消委托事件。这种方法也行不通。

有任何想法吗？

```
MyDialogView = Backbone.View.extend({
    initialize: function(options){
        this.render();
    },
    render: function() {

        this.$el.empty().append("<button id='fooButton'>Foo</button>");

        this.$el.modal({ "static": true });
    },
    events: {
        "click #fooButton": "fooPressed"
    },
    fooPressed: function() {
        alert("clicked");

        $.modal.close();
    }
});

$(function(){
    $("#openDialog").click(function() {
        new MyDialogView({el: $("#dialog") });
    });
}); 
```

​感谢您的帮助！

**通过切换到 JQuery UI Dialog 解决。请看下面我的回答。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T23:34:25.233

每次实例化视图时，Backbone 都会[`delegateEvents`](http://backbonejs.org/#View-delegateEvents)调用`el`：

> **委托事件** `delegateEvents([events])`
> 
> [...] 默认情况下，**delegateEvents**在视图的构造函数中为您调用，[...]

所以每次你这样做：

```
new MyDialogView({el: $("#dialog") }); 
```

您将 jQuery 附加[`delegate`](http://api.jquery.com/delegate/)到`#dialog`. 你的问题是你自己没有清理，你应该在`delegate`关闭对话框时删除。

您应该[`undelegateEvents`](http://backbonejs.org/#View-undelegateEvents)在关闭对话框时调用：

```
fooPressed: function() {
    alert("clicked");
    this.undelegateEvents();
    $.modal.close();
} 
```

或者，您可以创建一次视图，然后根据需要调用一些方法将其弹出。通过您的设置，您只需一次从中删除`render`呼叫并将视图保存在变量中，然后根据需要进行。`initialize``new MyDialogView(...)``my_dialog_view.render()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:57:09.250

您使用的是哪个版本的 Backbone？从 0.9.9 开始：

> 最重要的是，Backbone 事件有两个新方法：listenTo 和 stopListening。这些是通常的 on 和 off 的控制反转风格，并且可以更容易地清理一个对象在其他对象上侦听的所有事件。当您使用 view.remove() 销毁视图时，这将自动完成。请注意，关于使用垃圾收集语言进行编程的通常规则仍然适用。

我猜想每次打开模式时，关闭按钮都应该调用 view.remove()。从最新版本开始，Backbone 现在应该从视图中取消绑定所有事件，而无需您手动执行。

```
MyDialogView = Backbone.View.extend({
    initialize: function(options){
        this.render();
    },
    render: function() {

        this.$el.empty().append("<button id='fooButton'>Foo</button>");

        this.$el.modal({ "static": true });
    },
    events: {
        "click #fooButton": "fooPressed",
        "click #close": "closeView"
    },
    closeView: {
      this.remove();
      $.modal.close();
    },
    fooPressed: function() {
        alert("clicked");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T04:15:36.357

我的同事 Anton 通过用 JQuery UI Dialog 替换 Simple Modal 找到了一个解决方案，因为它返回一个可以安全地分配给 this.$el 的元素（Simple Modal 不能）。打开时：

```
that.$el = $(that.$el.dialog({
    modal: true,
    resizable: false,
    "beforeClose": function (dialog) {
        that.stopListening();
        that.undelegateEvents();
    }
})); 
```

再次感谢所有试图提供帮助的人，希望这对未来的人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T22:30:22.617

使用jQuery的[`off`](http://api.jquery.com/off/)方法怎么样？

```
unbindEvents : function(){
    this.$el.off();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T22:32:03.927

如果您不会在`MyDialogView`每次`'#openDialog'`单击时创建新实例，而只是渲染现有实例怎么办？

```
MyDialogView = Backbone.View.extend({
    initialize: function(options){
        //this.render(); // don't need to call it here
    }
    // ...
});

$(function(){
    var myDialogView = new MyDialogView({
        el: $("#dialog")[0]
    });
    $("#openDialog").click(function() {
        myDialogView.render();
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-20T07:38:30.150

在错误的范围内使用该问题`this`，因此在这种情况下`this`引用了一个方法而不是视图实例。这是我之前删除视图事件的方法，效果很好。

```
var JobContainerNumberView = Backbone.View.extend({
events: {
        "focusout input.txtNumber": "checkBookingExists"
    },
    checkBookingExists: function() {
        var _this = this;
        var this_input = _this.$('input.txtNumber'); // text box where container is
        var booking_number = this_input.val();
        if ( booking_number != '') {
            $.post('booking/booking_exists', {'booking_number': booking_number},
                function(data,status,xhr) {
                if (data.exists) {
                    alert(data.message);
                    // stop only focusout event for the input
                    $(_this.el).off('focusout', 'input.txtNumber');
                    //remove all events on view
                    //_this.undelegateEvents();
                }
            },'json');
        }
    } 
```

});

# plot - jqPlot 结合气泡图和折线图

> ID：14014719
> 
> 赞同：4
> 
> 时间：2012-12-23T21:10:51.330
> 
> 标签：plot, jqplot

是否可以使用 jqPlot 在同一个图表中**组合气泡图和折线图？**

基于[结合线和条 w/ jqplot](https://stackoverflow.com/questions/10727285/combined-line-and-bar-w-jqplot)的讨论，我创建了一个 jsfiddle，其中包含一个气泡图和一个条形图：http: [//jsfiddle.net/85K6K/6/](http://jsfiddle.net/85K6K/6/)

我无法将条形图转换为线图。这该怎么做 ？

我尝试了（更改，删除）渲染器，但情节变得混乱

这就是我设置系列的方式：

```
var plot2 = $.jqplot('chart', [ p, arr], {
    series: [
        {

                    renderer: $.jqplot.BarRenderer,
                    rendererOptions: {
                        barMargin: 10
                    },
                    pointLabels: {
                        show: true,
                    }
                   //showMarker:false

        },
        {
                renderer: $.jqplot.BubbleRenderer,
                rendererOptions: {
                             bubbleAlpha: 0.6,
                             highlightAlpha: 0.8
                        },
                shadow: true,
                shadowAlpha: 0.05
        }],
    axesDefaults: {
        tickRenderer: $.jqplot.CanvasAxisTickRenderer,
    },
    axes: {
        xaxis: {
            renderer: $.jqplot.CategoryAxisRenderer
        },
        yaxis: {
            autoscale: true
        }
    }
}); 
```

我错过了什么

提前致谢 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-27T11:08:45.050

通过反复试验，我发现您需要将 y 轴的`forceTickAt0`属性设置为**true**。

[http://jsfiddle.net/85K6K/14/](http://jsfiddle.net/85K6K/14/)

这是相关部分：

```
yaxis: {
    autoscale: true,
    renderer: $.jqplot.LinearAxisRenderer,
    rendererOptions: {
        forceTickAt0: true
    }
} 
```

我认为您应该[考虑提交错误](https://bitbucket.org/cleonello/jqplot/issues/new)。他们的数据库中还有[其他](https://bitbucket.org/cleonello/jqplot/issue/663/replot-resetaxes-yaxis-cause-nan-in-y-axis) [关于](https://bitbucket.org/cleonello/jqplot/issue/205/all-0-values-in-yaxis-ticks-causes-nan)Y 轴因 NaN 错误而失败的问题，这似乎是相关的；但我认为您的问题值得单独发布。有了这个问题和 JSFiddle，它应该有足够好的文档供开发人员解决:)

**编辑**：我对您的图表数据知之甚少，无法判断它是否相关，但也许您想使用`sortMergedLabels`CategoryAxisRenderer 的属性，让您的图表看起来[像这样](http://jsfiddle.net/85K6K/15/)？

```
rendererOptions: {
    sortMergedLabels: true
} 
```

# java - 图像被绘制在错误的位置

> ID：14014728
> 
> 赞同：0
> 
> 时间：2012-12-23T21:11:38.590
> 
> 标签：java, jframe, bufferedimage

![在此处输入图像描述](../Images/226199cc272ea80559685cdd25753d8a.png)

这是我的线程的最终输出，它截取屏幕截图并将它们存储在向量中。
`java.awt.Robot`用于截取屏幕截图，这些截图基本上是屏幕的光栅，**不**包含光标位置。作为一种解决方法，我使用`MouseInfo`类来获取`PointerInfo`然后获取`Point`. 然后在该点绘制图像。
如果录制区域设置为全屏分辨率，一切都很酷。但是，如果我更改记录区域，光标会被绘制在错误的位置。
这个黑色光标应该位于 Eclipse IDE 顶部的**Play按钮上。**然而它在错误的位置。

## 如何在正确的位置绘制它？

### 代码：

```
package demo;
import java.awt.*;
import java.awt.image.*;
import java.util.*;
import javax.swing.*;

public class ScreenCapturingThread extends Thread{
    public ScreenCapturingThread(Vector<BufferedImage> screenShots,
            int frameRate,
            Icon cursor,
            Rectangle recordingArea){
        this.screenShots = screenShots;
        this.frameRate = frameRate;
        this.cursor = cursor;
        this.recordingArea = recordingArea;

        try{
            bot = new Robot();
        }catch(Exception e){
            System.out.println(e);
        }
        calculateSleepTime();
    }
    @Override
    public void run(){
        while(keepCapturing == true){
            try{
                screenShots.insertElementAt(takeScreenShot(), 0);
                sleep(sleepTime);

                keepCapturing = false; //take only one shot

                System.out.println("here");
                JFrame frame = new JFrame("blah");
                frame.setVisible(true);
                JLabel label = new JLabel(new ImageIcon(screenShots.firstElement()));
                frame.setSize(recordingArea.width, recordingArea.height);
                frame.add(label);

            }catch(InterruptedException e){
                e.printStackTrace();
            }
        }
    }
    public BufferedImage takeScreenShot(){
        p = m.getPointerInfo();
        Point location = p.getLocation();
        image = bot.createScreenCapture(recordingArea);
        if(cursor!=null){
            Graphics g = image.getGraphics();
            g.drawImage(((ImageIcon)cursor).getImage(), location.x,location.y,null);
        }
        return image;
    }
    public void stopIt(){
        keepCapturing = false;
    }
    public void calculateSleepTime(){
        sleepTime = 1/frameRate;
    }

    public static void main(String[] args) {
        Vector<BufferedImage> bufferedImages = new Vector<>(100);
        int frameRate = 10;
        Icon cursor = (Icon) new ImageIcon("src/images/blackCursor.png");
        Rectangle r = new Rectangle(1280,800);
        r.x = 200;
        r.y = 200;
        ScreenCapturingThread sc = new ScreenCapturingThread(bufferedImages,frameRate,cursor,r);

        sc.start();
    }
    Vector<BufferedImage> screenShots;
    int frameRate;
    long sleepTime;
    boolean keepCapturing = true;
    Icon cursor;
    Rectangle recordingArea;
    Robot bot;
    MouseInfo m;
    PointerInfo p;
    BufferedImage image;
} 
```

如果光标超出记录范围，则不得绘制。我的意思是，你明白了吗？

## 全屏分辨率输出

![在此处输入图像描述](../Images/2e4c1aaf004ee2351f6bc7d4faa2cf7f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:22:07.320

当然，您必须在相对位置绘制光标 - 而不是全局：

```
 p = m.getPointerInfo();
    Point location = p.getLocation(); 
```

为您提供屏幕上的鼠标位置（全局）。图像坐标中的鼠标位置（相对）将类似于：

```
 int x = (int) (p.x - recordingArea.getX()); //for int y similar
    if(x < 0 || y < 0 || y >= maxHeight || x >= maxWidth) { // don't draw cursor } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:33:13.247

您仍然将指针绘制在与运行按钮相同的位置，因为您永远不会检查指针的位置是否在您的录制范围内。此外，您可能希望使用录制范围来缩放指针的位置。

例如，您可以通过执行以下操作来检查指针是从查看矩形向左还是向上（偏移变量基本上是您开始记录时距左侧和顶部的距离）：

```
p = m.getPointerInfo();
Point location = p.getLocation();
image = bot.createScreenCapture(recordingArea);
//Check location here.
if( location.x < recordingArea.x + <<offset x variable>> || 
    location.y < recordingArea.y + <<offset y variable>>){
     //Code to change cursor position to outside of viewing rectangle here.
}
if(cursor!=null){
      Graphics g = image.getGraphics();
      g.drawImage(((ImageIcon)cursor).getImage(), location.x,location.y,null);
} 
```

# javascript - 在 AJAX 请求之外设置变量

> ID：14014735
> 
> 赞同：1
> 
> 时间：2012-12-23T21:12:15.163
> 
> 标签：javascript, jquery

我正在尝试创建一个从页面返回特定字符串的 ajax 函数，然后将其设置在我创建的类中。但是，当我尝试`this.setGlideUser`在 ajax 成功参数中调用时，它告诉我

```
object has no function setUserGlide. 
```

而当我尝试`this.setUserGlide`在成功参数之外调用，然后查看 的值`_glideUser`，`_glideUser`是未定义的。这是我的代码片段。

```
function main()
{
    this.start = true;
}

main.prototype.load = function()
{
    var _glideUser;
    $.ajax(
    {
        url: '/home',
        dataType: 'text',
        success: function(data)
        {
            // Truncated
            _glideUser = unescape(data).match(pattern);
        }
    });
    this.setGlideUser(_glideUser);
    return 1;
}

main.prototype.setGlideUser(user)
{
    return this._glideUser = user;
}

main.prototype.getGlideUser()
{
    return this._glideUser;
}

var _main = new main();
_main.load();
// check that the ajax has completely loaded
_main.getGlideUser(); // returns undefined 
```

我想不出一种方法来`_glideUser`从 Ajax 成功函数的主类中设置变量。我想`_glideUser`在另一个函数中获取值，用它来做事。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:17:21.030

没有`this._glideUser`, 因为对于您的功能来说`_glideUser`是本地的。`load`与其声明`var _glideUser`inside `load`，不如将其设置为构造函数的公共属性：

```
function main()
{
    this.start = true;
    this._glideUser = null;
} 
```

（您的第一次调用`setGlideUser`实际上会创建这样一个属性，但同时拥有这两个属性不会令人困惑吗？）

此外，正如其他人所提到的，您正在尝试`setGlideUser` *在*您的 ajax 操作完成之前。您需要从`success`回调中执行此操作：

```
main.prototype.load = function()
{
    var that = this;
    $.ajax(
    {
        url: '/home',
        dataType: 'text',
        success: function(data)
        {
            that.setGlideUser(unescape(data).match(pattern));
        }
    });
    return 1; // what's the point?
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:20:21.000

我对 jQuery 不太熟悉，但 ajax 请求可能是异步的，因此您必须从 ajax 成功调用内部调用 setGlideUser，只需向您的实例添加一个引用变量并从那里调用它：

```
var self = this;
$.ajax(
{
    url: '/home',
    dataType: 'text',
    success: function(data)
    {
        self.setGlideUser(unescape(data).match(pattern));
    }
}); 
```

给你一个快速提示是，你可以在 js 中使用 getter 和 setter，如下所示：

```
main.prototype.__defineSetter__("glideUser", function(value)
{
    this._glideUser = value;
});

main.prototype.__defineGetter__("glideUser", function()
{
    return this._glideUser;
}); 
```

编辑：实际上，请参阅那些东西的评论

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:19:20.693

`success`在请求返回之前不会调用。它是*异步*的。当数据值可用时，您需要在成功本身内调用该方法。

```
main.prototype.load = function()
{
    var _glideUser, that = this;
    $.ajax(
    {
        url: '/home',
        dataType: 'text',
        success: function(data)
        {
            // Truncated
            var = _glideUser = unescape(data).match(pattern);
            that.setGlideUser(_glideUser);
        }
    });
    // this.setGlideUser(_glideUser); this is incorrect
    return 1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:21:03.373

关键字**this**表示当前范围，在这种（双关语）情况下是 ajax 对象。**您需要通过将我**分配给外部对象中的**this**来引用外部 this对象。

```
main.prototype.load = function()
 {
    var _glideUser;
    var me = this;
    $.ajax(
    {
        url: '/home',
        dataType: 'text',
        success: function(data)
        {
            // Truncated
            _glideUser = unescape(data).match(pattern);
            me.setGlideUser(_glideUser);
        }
    });
    return 1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T21:29:09.680

> 尝试在 ajax 成功参数中调用 this.setGlideUser

那是正确的。但是，success 方法中的[`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)指向 jqXHR 对象而不是您的`main`实例；你需要取消引用它：

```
var that = this;
$.ajax({
    url: '/home',
    dataType: 'text',
    success: function(data) {
        _glideUser = unescape(data).match(pattern);
        that.setGlideUser(_glideUser);
    }
}); 
```

# objective-c - Objective-C 中的 Mime 编码词解析

> ID：14014738
> 
> 赞同：3
> 
> 时间：2012-12-23T21:13:07.217
> 
> 标签：objective-c, ios, macos, email, mime

OS X 或 iOS 是否提供 API 来解析[MIME Encoded-Word](http://en.wikipedia.org/wiki/MIME#Encoded-Word)？这些可爱的字符串：

```
=?iso-8859-1?Q?=A1Hola,_se=F1or!?= 
```

或者，是否有一个已知的开源库可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T02:25:42.383

我接受了@NickolayO. 的[回答，使用](https://stackoverflow.com/a/14014839/143378)[QSStrings](https://github.com/mikeho/QSUtilities)添加了 base-64 支持，并使用`componentsSeparatedByString:`and缩短了代码`stringByReplacingOccurrencesOfString:withString:`。

我已经在[GitHub 上](https://github.com/hpique/NSString-MimeEncodedWord)提供了代码。为方便起见，这是一个片段：

```
@implementation NSString (MimeEncodedWord)

- (BOOL) isMimeEncodedWord
{
    return [self hasPrefix:@"=?"]  && [self hasSuffix:@"?="];
}

+ (NSString*) stringWithMimeEncodedWord:(NSString*)word
{ // Example: =?iso-8859-1?Q?=A1Hola,_se=F1or!?=
    NSArray *components = [word componentsSeparatedByString:@"?"];
    if (components.count < 5) return nil;

    NSString *charset = [components objectAtIndex:1];
    NSStringEncoding encoding = CFStringConvertEncodingToNSStringEncoding(CFStringConvertIANACharSetNameToEncoding((CFStringRef)charset)); // TODO: What happens if the encoding is invalid?

    NSString *encodingType = [components objectAtIndex:2];
    NSString *encodedText = [components objectAtIndex:3];
    if ([encodingType isEqualToString:@"Q"])
    { // quoted-printable
        encodedText = [encodedText stringByReplacingOccurrencesOfString:@"_" withString:@" "];
        encodedText = [encodedText stringByReplacingOccurrencesOfString:@"=" withString:@"%"];
        NSString *decoded = [encodedText stringByReplacingPercentEscapesUsingEncoding:encoding];
        return decoded;
    } else if ([encodingType isEqualToString:@"B"])
    { // base64
        NSData *data = [QSStrings decodeBase64WithString:encodedText];
        NSString *decoded = [[NSString alloc] initWithData:data encoding:encoding];
        return decoded;
    } else {
        NSLog(@"%@ is not a valid encoding (must be Q or B)", encodingType);
        return nil;
    }    
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:28:33.143

这是quoted-printable 版本的代码（Mime Encoded-word 可以是quoted-printable 或base-64 编码）。对于 base64 编码，你应该做类似的事情，用 base64 解码替换引用打印解码。可能这段代码需要一些测试。此外，它仅支持 NSString 的编码。

```
- (NSString*) decodeMimeEncodedWord:(NSString*)word
{
    if (![word hasPrefix:@"=?"] || ![word hasSuffix:@"?="])
        return nil;

    int i = 2;
    while ((i < word.length) && ([word characterAtIndex:i] != (unichar)'?'))
        i++;

    if (i >= word.length - 4)
        return nil;

    NSString *encodingName = [word substringWithRange:NSMakeRange(2, i - 2)];
    NSStringEncoding encoding = CFStringConvertEncodingToNSStringEncoding(CFStringConvertIANACharSetNameToEncoding((CFStringRef)encodingName));
    // warning! can return 'undefined something' if encodingName is invalid or unknown

    NSString *encodedString;

    if ([[word substringWithRange:NSMakeRange(i + 1, 2)] isEqualToString:@"Q?"])
    {
        // quoted-printable
        encodedString = [word substringWithRange:NSMakeRange(i + 3, word.length - i - 5)];
        NSMutableData *binaryString = [[[NSMutableData alloc] initWithLength:encodedString.length] autorelease];
        unsigned char *binaryBytes = (unsigned char*)[binaryString mutableBytes];
        int j = 0;
        char h;     

        for (i = 0; i < encodedString.length; i++)
        {
            unichar ch = [encodedString characterAtIndex:i];
            if (ch == (unichar)'_')
                binaryBytes[j++] = ' ';
            else if (ch == (unichar)'=')
            {
                if (i >= encodedString.length - 2)
                    return nil;

                unsigned char val = 0;

                // high-order hex char
                h = [encodedString characterAtIndex:++i];
                if ((h >= '0') && (h <= '9'))
                    val += ((int)(h - '0')) << 4;
                else if ((h >= 'A') && (h <= 'F'))
                    val += ((int)(h + 10 - 'A')) << 4;
                else
                    return nil;
                // low-order hex char
                h = [encodedString characterAtIndex:++i];
                if ((h >= '0') && (h <= '9'))
                    val += (int)(h - '0');
                else if ((h >= 'A') && (h <= 'F'))
                    val += (int)(h + 10 - 'A');
                else
                    return nil;

                binaryBytes[j++] = val;             
            }
            else if (ch < 256)
                binaryBytes[j++] = ch;
            else
                return nil;
        }

        binaryBytes[++j] = 0;
        [binaryString setLength:j];

        NSString *result = [[NSString alloc] initWithCString:[binaryString mutableBytes] encoding:encoding];        
        // warning! can return 'undefined something' if encoding is invalid or unknown

        return result;
    }
    else if ([[word substringWithRange:NSMakeRange(i + 1, 2)] isEqualToString:@"B?"])
    {
        // base64-encoded       
        return nil;
    }
    else
        return nil;
} 
```

# jquery - 多维数组结构，如 php print_r

> ID：14014739
> 
> 赞同：0
> 
> 时间：2012-12-23T21:13:07.760
> 
> 标签：jquery, ajax, multidimensional-array

我有这样的形式：

```
 <form id="incomes" method="post" action="#">
      <input type="text" name="date[]"/>
      <input type="text" name="income[]"/>
      <input type="text" name="tax[]"/>
      <input type="text" name="social_insurance[]"/>
      <input type="text" name="health_insurance[]"/>
    </form> 
```

我想要做的就是通过 jQuery ajax 将输入发布到 php，结构如下：

```
Array(
    [0] => Array(
        date => 2012-12-10
        income => 1000
        tax => 100
        social_insurance => 50
        health_insurance => 50
    )
    [1] Array(
        date => 2012-12-15
        income => 2000
        tax => 150
        social_insurance => 20
        health_insurance => 50
    )
) 
```

有什么简单的方法可以实现吗？我听说过 serialize() 函数，但这不是我想要的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:17:42.363

我一直自己做，但我在 PHP 端通过数组循环：

```
$newarray = array();
foreach($_POST["date"] AS $i => $date) {
    $newarray[$i]["date"] = $date;
} 
```

等等..

所以你继续通过ajax发送你的数据并在服务器端做所有事情，你可以在处理和输出结果之前对数组进行排序和做任何你需要的事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:22:49.457

使用 jQuery 发送表单数据`serialize()`是发送数据的最简单方法。您需要遍历 php 中的各个字段数组以创建所需的数组结构

```
$('#incomes').submit(function(){

    $.post(url, $(this).seralize(), function(response){
       /*run any  ajax complete code here*/
    }) ;
   /* prevent browser default form submit*/
   return false;

}); 
```

$_POST 看起来像：

```
 array(
      date=> array(),
       income=>array()/* etc*/
  } 
```

PHP 新数组循环可能类似于：

```
$newArray=array();

foreach($_POST as $key=>$value){
    if( !empty( $value) && is_array($value)){
         for( $i=0;$i<count($value);$i++){
              $newArray[$i][$key]=$value[$i];

        }
    }
} 
```

# next - 用于移动到图库-图片-序列中的下一张图片的按钮？

> ID：14014741
> 
> 赞同：0
> 
> 时间：2012-12-23T21:13:20.633
> 
> 标签：next, image

我有 2 个按钮“下一个”和“上一个”，我想浏览我的照片。图片名称存储在 mysql 数据库中，我使用以下 Mysql 代码获取当前图片。

```
"SELECT * FROM pictures WHERE picid = '12'" 
```

所有的图片都可以使用下面的Mysql代码访问（$tag只是一个带字符串的变量）

```
"SELECT * FROM pictures WHERE tag = '$tag'" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:15:54.117

你如何对这些图像进行排序？您始终可以根据他们的顺序选择下一个：

下一张图片（12是当前一张的订单值）

```
'SELECT id FROM pictures WHERE order > 12 LIMIT 1' 
```

# amazon-ec2 - EMR - 使用 Spot 实例的杠杆作用

> ID：14014744
> 
> 赞同：2
> 
> 时间：2012-12-23T21:13:56.563
> 
> 标签：amazon-ec2, mapreduce, elastic-map-reduce, emr

我知道我们可以竞标现货实例并以低于常规实例的价格获得它们，但是对于现货实例，您的实例存在被收回的风险。

我想知道有什么方法可以确保只有在我们的工作完成后才将它们带走？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T21:18:02.417

“确保”它的唯一方法是出价非常非常非常高！

但实际上，如您所知，如果您请求 Spot 实例，请记住，如果当前 Spot 价格超过您的最高出价，则不会预置任何一个实例，或者将其从当前工作流中删除。为了避免完全丢失工作流，可以创建多个实例组，其中该`CORE`组是传统按需系统的较小补充，并且该`TASK`组是现场实例组。在此配置中，该`TASK`组将仅使作业流的映射器阶段受益，因为来自该`TASK`组的工作“移交”给该`CORE`组以进行缩减。

所以说如果你必须运行一个理想情况下需要 40 台从机的作业，那么你可以说 10 台机器（CORE 组）作为传统实例，而其他 30 台作为现场实例（TASK 组）。创建多个实例组的语法如下：

```
elastic-mapreduce --create --alive --plain-output
...
--instance-group master --instance-type m1.small --instance-count 1 \
--instance-group core   --instance-type m1.small --instance-count 10 \
--instance-group task   --instance-type m1.small --instance-count 30 --bid-price 0.018 
```

# listbox - 试图替换无法决定是隐藏还是可见的框架

> ID：14014750
> 
> 赞同：0
> 
> 时间：2012-12-23T21:14:18.990
> 
> 标签：listbox

我有一个框架和一个创建列表框的函数。当我按下一个按钮时，我想隐藏框架并创建一个新框架，并且在这个框架上我还想使用 create_listbox 函数。隐藏框架并创建新框架非常有效。但是，当我尝试在 2:nd 框架上创建列表框时，窗口会变得疯狂并不断调整大小。这是该程序的简化版本。

```
class App(Frame):

def __init__(self, master):
    Frame.__init__(self, master)
    self.grid()
    self.f1 = Frame(self.master)
    self.f1.pack()
    self.f2 = Frame(self.f1)
    self.f2.grid()
    self.create_listbox(self.f1)

def create_listbox(aframe):
    self.listbox = Listbox(aframe)
    self.listbox.pack()

def hide_f2:
    self.f2.grid_forget()
    self.f3 = Frame(self.f1)
    self.create_listbox(self.f1) 
```

首先我认为这可能是因为列表框对象同时属于 f2 和 f3，因此无法决定它应该隐藏还是可见，但现在我不确定了:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T13:21:24.627

我自己找到了答案！显然它是导致问题的根窗口。我刚刚删除了`self.grid()`，一切都恢复正常了。如果有人知道为什么对根窗口进行网格化会导致包网格问题，我将不胜感激：）

# ios - 在 iOS6 中使用 Storyboards，我如何模态连接到另一个视图，但是让那个视图有一个导航栏

> ID：14014754
> 
> 赞同：0
> 
> 时间：2012-12-23T21:14:38.850
> 
> 标签：ios, xcode, ios6

也许导航栏不是最好的术语，但我希望它的顶部有蓝色栏，左上角和右上角分别有“取消”和“完成”按钮（因为这是要做的列表应用程序）。

最好不在代码中，我将如何使我一直拥有这些观点？现在由于它被推送，它现在只是被扔在旧视图之上，无法退出它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:54:04.400

在情节提要中选择呈现的 viewController（segue 的destinationViewController）...

编辑器 -> 嵌入 -> 导航控制器

或者...只需将 UINavigationBar 从 Object Library 拖到 ViewController 上。

然后您可以将 barButtonItems 拖到导航栏上，并将其标识符设置为“取消”和“完成”。将它们作为 IBAction 连接到 ViewController 以完成工作。

# android-layout - 如何使列表水平滚动

> ID：14014755
> 
> 赞同：0
> 
> 时间：2012-12-23T21:14:39.817
> 
> 标签：android-layout, android-contentprovider, android-cursoradapter

我正在使用 CursorAdapter 在我的 ListFragment 中显示来自 ContentProvider 的位图。默认情况下，列表是垂直可滚动的。我怎样才能使它水平滚动而不是垂直滚动，例如在横向布局的情况下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T08:19:54.567

我在这里找到一个可水平滚动的列表[http://www.dev-smart.com/?p=34](http://www.dev-smart.com/?p=34)如果这有帮助，请告诉我...

# asp.net - 在运行时添加和删除列表框项

> ID：14014759
> 
> 赞同：1
> 
> 时间：2012-12-23T21:15:34.090
> 
> 标签：asp.net, vb.net, listbox

我有两个列表框，它们在运行时在网页 Page_Load 事件中填充。我正在使用 Page.IsPostBack 来确保仅在未回发时填充列表。

列表框 A 大约有 150 个项目，列表框 B 为空。我有两个按钮，添加和删除。我选择列表框 A 中的项目并按添加按钮，这些项目将移动到列表框 B。

我在列表框 B 中选择这些项目时遇到问题。如果我将 Autopostback 设置为 TRUE，我将无法选择任何项目。当我选择一个项目时，会发生回发并且我的选择被清除，就好像没有选择任何项目一样，即使我将 Enableviewstate 设置为 TRUE。

如果我将 Autopostback 设置为 FALSE，我可以毫无问题地选择项目，但是当我在服务器端检查这些项目的 Selected 属性时，它们都是 FALSE。

无论自动回发设置为什么，我都可以在服务器端看到填充的项目，只有 selected 属性始终为 false。

所有列表框项目及其值都是唯一的。

有关解决此问题的任何建议？

这是我用来在添加按钮的单击事件中填充列表框 b 的代码：

```
 For i = 0 To (ListboxA.Items.Count - 1)
        If ListboxA.Items.Item(i).Selected = True Then
            ListboxB.Items.Add(ListboxA.Items.Item(i))
        End If
    Next
    For i = 0 To (ListboxB.Items.Count - 1)
        If ListboxA.Items.Contains(ListboxB.Items.Item(i)) Then
            ListboxA.Items.Remove(ListboxB.Items.Item(i))
        End If
        ListboxB.Items.Item(i).Selected = False
    Next 
```

和列表框：

```
 <asp:ListBox ID="ListboxA" runat="server" SelectionMode="Multiple" AutoPostBack="True"></asp:ListBox>
    <asp:ListBox ID="ListboxB" runat="server" SelectionMode="Multiple" AutoPostBack="True"></asp:ListBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T03:26:42.023

选择必须进行，因为您在每次回发时都在执行 listbox.databind() 。仅当它不是回发时才这样做，并且即使在回发之后您的选择仍将保留。

# c - 处理 fscanf()

> ID：14014761
> 
> 赞同：0
> 
> 时间：2012-12-23T21:15:43.477
> 
> 标签：c, arrays, string, data-structures, scanf

我有一个结构简单的文件：
`{number}\#
{some_text_with_lines}
\#`

问题是我想要一个程序读取这个文件中的每个条目。这意味着这种结构不止一次出现。

所以，我的第一个想法是创建一个结构数组，某种`struct my_struct abc[MAX];`. `MAX`是一个预处理器定义。

我希望将`fscanf`{number} 存储为数组的编号，并将 {some_text_with_lines} 存储为结构数组中的字符串。所以每个数组都有自己的字符串。

思路是 fscanf 读取以下格式：`%d#\r\n%s\r\n#r\n`，并使用第一个整数**%d**作为数组的编号。像 &abc[%d] 这样的东西。
虽然我知道它的语法是错误的，但我不知道如何读取这个数字 %d 并将其用作数组的编号。另外，%s 有问题，它没有\0？

所以，我需要一些帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T22:30:32.723

做这样的事情：

```
int index;
char array[1024][1024];               // big array :)

while(fscanf(file, "%d#\r\n", &index) == 1) {
  fscanf(file, "%s\r\n", array[index]);
  int c; 
  while ((c = fgetc(file)) != EOF && c != '\r') { }
  fgetc(file);                          // read '\n'
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T02:50:47.767

此代码有效。它将接受文件中的任意段落列表，并且每个段落中的行集也可以是任意长度。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct data
{
    int     number;
    char  **lines;
    int     num_lines;
    int     max_lines;
};

int main(void)
{
    struct data *info = 0;
    int   num_entries = 0;
    int   max_entries = 0;
    char line[4096];

    while (fgets(line, sizeof(line), stdin) != 0)
    {
        int number;
        char hash;
        if (sscanf(line, "%d%c", &number, &hash) != 2 || hash != '#')
        {
            fprintf(stderr, "Format error (number# expected): %s", line);
            return(1);
        }

        if (max_entries >= num_entries)
        {
            int new_size = (max_entries + 2) * 2;
            struct data *new_info = realloc(info, new_size * sizeof(*new_info));
            if (new_info == 0)
            {
                fprintf(stderr, "Out of memory\n");
                return(1);
            }
            info = new_info;
            max_entries = new_size;
        }

        struct data *curr = &info[num_entries];
        curr->number    = number;
        curr->lines     = 0;
        curr->max_lines = 0;
        curr->num_lines = 0;

        while (fgets(line, sizeof(line), stdin) != 0)
        {
            char *p = strchr(line, '\n');
            if (p == 0)
            {
                fprintf(stderr, "Format error: no newline? (%s)\n", line);
                return(1);
            }
            *p = '\0';
            if (strcmp(line, "#") == 0)
                break;
            if (curr->max_lines >= curr->num_lines)
            {
                int new_size = (curr->max_lines + 2) * 2;
                char **new_lines = realloc(curr->lines, new_size * sizeof(*new_lines));
                if (new_lines == 0)
                {
                    fprintf(stderr, "Out of memory\n");
                    return(1);
                }
                curr->lines = new_lines;
                curr->max_lines = new_size;
            }
            curr->lines[curr->num_lines] = strdup(line);
            if (curr->lines[curr->num_lines] == 0)
            {
                fprintf(stderr, "Out of memory\n");
                return(1);
            }
            curr->num_lines++;
        }

        num_entries++;
    }

    for (int i = 0; i < num_entries; i++)
    {
        printf("%d#\n", info[i].number);
        for (int j = 0; j < info[i].num_lines; j++)
            printf("  %d: %s\n", j, info[i].lines[j]);
    }

    return(0);
} 
```

给定输入文件：

```
13#
Unlucky for some
#
20121221#
The end of the world?
No, it seems that we survived yet another doomsday!
#
18#
More lines,
And more lines still.
The verse is weird.
The terse is worse.
#
19#
As for one,
Then another,
It is still too short
For comfort,
But the fifth line shall trigger
an extra reallocation.
#
20#
All for one,
And one for all!
The Three Musketeers?
Nay, D'Artagnan, the Four Musketeers.
Yahoo! Bing?  Google?
# 
```

它给出了输出：

```
13#
  0: Unlucky for some
20121221#
  0: The end of the world?
  1: No, it seems that we survived yet another doomsday!
18#
  0: More lines,
  1: And more lines still.
  2: The verse is weird.
  3: The terse is worse.
19#
  0: As for one,
  1: Then another,
  2: It is still too short
  3: For comfort,
  4: But the fifth line shall trigger
  5: an extra reallocation.
20#
  0: All for one,
  1: And one for all!
  2: The Three Musketeers?
  3: Nay, D'Artagnan, the Four Musketeers.
  4: Yahoo! Bing?  Google? 
```

毫无疑问，代码还有改进的空间，但它似乎可以工作（尽管它在退出之前不会释放内存）。它假定有一个函数`char *strdup(const char *str)`为给定字符串的副本分配足够的空间。

# jquery - 替代 WebDriver 中的 Selenium.browserbot.getActiveWindow().$

> ID：14014762
> 
> 赞同：0
> 
> 时间：2012-12-23T21:15:46.627
> 
> 标签：jquery, webdriver, selenium-rc

目前我正在使用

```
String jQuery = Selenium.browserbot.getActiveWindow().$ 
```

在 Selenium RC 脚本中获取 jQuery 句柄

现在我正在将我的脚本迁移到 WebDriver。

Webdriver 中 String jQuery = Selenium.browserbot.getActiveWindow().$ 的替代品是什么？

注意 - 我尝试使用 String jQuery = $ 在 Webdriver 中运行脚本但是当我使用 String jQuery = Selenium.browserbot.getActiveWindow().$ 执行与 Selenium RC 完美运行的 javascript 时，它返回 null

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T05:35:44.320

Webdriver 公开了一个名为 getWindowHandle 的函数来获取当前窗口的句柄。您可以将其用作 driver.getWindowHandle

java.lang.String getWindowHandle() ：返回此窗口的不透明句柄，该句柄在此驱动程序实例中唯一标识它。这可用于在以后切换到此窗口

参考这个：[http ://selenium.googlecode.com/svn/trunk/docs/api/java/index.html](http://selenium.googlecode.com/svn/trunk/docs/api/java/index.html)

另外，我认为您需要在 webdriver 中的 javascript 中添加一个 return 语句，而 Selenium 并非如此。

# visual-studio - VS 2012：构建后 xcopy 错误 2

> ID：14014763
> 
> 赞同：20
> 
> 时间：2012-12-23T21:15:46.867
> 
> 标签：visual-studio, msbuild, visual-studio-2012, xcopy, post-build-event

我想让 VS 将它在构建过程之后创建的 .lib 文件复制到特定文件夹。所以我去了项目配置，构建后事件，并输入了以下命令：

```
if exist $(TargetPath)
xcopy "$(TargetPath)" "C:\Users\Incubbus\Documents\Visual Studio 2010\My Libraries\z.lib" /Y 
```

但是，在我单击“构建”后，复制过程并没有失败，而是收到以下错误：

> 错误 MSB3073：命令“如果存在 C:\Users\Incubbus\Documents\Visual Studio 2010\My Libraries\MyNetWorkProject\Debug\IncNetworkLibD.lib xcopy "C:\Users\Incubbus\Documents\Visual Studio 2010\My Libraries\MyNetWorkProject \Debug\IncNetworkLibD.lib" "C:\Users\Incubbus\Documents\Visual Studio 2010\My Libraries\z.lib" /Y
> 
> :VCEnd" 以代码 2 退出。

我也想知道`:VCEnd`错误消息的命令字符串中的<-也许这就是原因？如何解决这个问题？

任何帮助和提示都会被愉快地消耗掉:)...

***部分解决方案：***

**编辑**：看起来**重命名**部分（`Inc.lib`to `z.lib`）很麻烦，当 xcopy 询问这是一个文件还是一个目录时......当我只是将最初命名的文件复制到目录而不是复制重命名时它可以工作

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-24T13:58:26.253

[Xcopy 文档](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/xcopy.mspx?mfr=true)说明如下：

*指定 Destination 是文件还是目录 如果 Destination 不包含现有目录且不以反斜杠 (\) 结尾，则会显示以下消息：*

```
Does destination specify a file name 
or directory name on the target 
(F = file, D = directory)? 
```

*如果您想将一个或多个文件复制到一个文件中，请按 F。如果要将文件复制到目录中，请按 D。*

*您可以通过使用 /i 命令行选项来禁止显示此消息，`xcopy`如果源是多个文件或目录，这会导致假定目标是一个目录。*

你需要相反的，但没有这样的开关。

此处提出了解决方案：[https](https://stackoverflow.com/a/4283533/532647) ://stackoverflow.com/a/4283533/532647 。

建议在`xcopy`命令前加上前缀，它基本上做了以下事情：它在询问时`echo f |`模拟用户按键。`f``xcopy`

所以你的命令应该是这样的：

```
if exist $(TargetPath)
echo f | xcopy "$(TargetPath)" "C:\Users\Incubbus\Documents\Visual Studio 2010\My Libraries\z.lib" /Y 
```

操作员只是将(== )`|`的输出通过管道传输到命令中，并在适当的时候读取它。有关此处输出重定向的更多信息：http: [//ss64.com/nt/syntax-redirection.html](http://ss64.com/nt/syntax-redirection.html)。`echo f``f``xcopy`

**更新：** 正如 Govert[指出的那样](https://stackoverflow.com/questions/14014763/vs-2012-post-build-xcopy-error-2#comment20331272_14022309)，这个 hack 在本地化版本的 Windows 下不起作用。但是，另一个 hack 将起作用：

```
xcopy D:\file.zip c:\renamedFile.zip* 
```

用星号附加目标文件名`*`使 xcopy 不会询问目标是文件还是目录。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-10-08T17:22:32.933

为什么不使用 copy 而不是 xcopy？副本专门用于文件，因此不会造成混淆。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-08T04:15:01.023

您是否尝试将 $(TargetPath) 用引号括起来？一直如此流行的空格字符而不是下划线在所有 MS 产品中往往会在每个角落都搞砸……不知道为什么那些笨蛋继续这样做……

像这样：如果存在 "$(TargetPath)"

# backbone.js - Backbone.js - 创建模型时要绑定的正确事件

> ID：14014768
> 
> 赞同：0
> 
> 时间：2012-12-23T21:16:19.897
> 
> 标签：backbone.js, backbone-events

我有一个 Backbone 视图，它绑定到这样的**笔记集合的****添加**事件（使用 CoffeeScript）：

 **```
 initialize: () ->
      @options.notes.bind('add', @noteAdded) 
```

这里是**noteAdded**方法和**addOneNote**方法，用于将最近创建的笔记添加到 DOM：

```
 addOneNote: (note) =>
      view = new CrmBliss.Views.Consultants.NoteView({model: note})
      @$(".past_notes").prepend view.render().el

    noteAdded: (model, response) =>
      console.debug 'model', model.toJSON()
      @addOneNote(model) 
```

最后，这是我在集合上调用**create方法的方式：**

```
 saveNote: (e) =>
      id = @model.get('id') 
      body = @$('.note-body').val()

      @options.notes.create({ body: body, consultant_id: id }) 
```

我希望**noteAdded**会使用反映数据库中添加内容的模型来调用。模型返回的一些字段不是由客户端插入的，而是由服务器计算的。即，**created_at**和**user_name**是服务器将返回的方法，但客户端在从服务器获取之前并不知道这些方法。

因此，当我尝试渲染以下（生态）模板时：

```
 <div class="note">
      <span class="date"><%= @created_at %></span>
      by
      <span class="taker"><%= @user_name %></span>
      <div class="note_body">
        <%= @body %>
      </div>
    </div> 
```

仅渲染主体（因为用于创建便笺的对象已经具有主体属性）。

如果我将**noteAdded**方法更改为在插入注释之前稍等片刻，它会起作用：

```
 noteAdded: (model, response) =>
    console.debug 'note before', model.toJSON()
    console.debug 'model', model
    attrShow = =>
      console.debug 'after time', model.toJSON()
      @addOneNote(model)
    setTimeout(attrShow, 1000) 
```

这让我觉得我显然绑定到了错误的事件，并且我应该绑定到从服务器加载模型时调用的事件。

我应该绑定哪个事件，当被调用时，它具有正确的（和最终的）模型属性？**

# ios - 将自定义图标字形附加到 NSAttributedString

> ID：14014770
> 
> 赞同：4
> 
> 时间：2012-12-23T21:16:59.463
> 
> 标签：ios, types

我需要将图标嵌入到要绘制到屏幕上的文本字符串中。图标应该像字符串中的任何其他字符一样，并与文本一起流动。这些图标与字符串中的任何其他字符相比都不再具有交互性（即，单击它们不会做任何事情，但您可以在复制/粘贴操作中选择它，尽管当它被粘贴到另一个应用程序时我很好，自定义字形被删除）。

NSAttributedString 附件是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T02:20:55.047

在字符串中嵌入特殊字符与 NSAttributedString 无关，它用于字符串格式化（粗体、斜体等）。由于 NSString 基于 Unicode (UTF-16)，您需要做的就是查找特殊字符的 UTF-16 表示，然后将其直接嵌入到您的字符串文字中。

# asp.net-mvc-3 - 创建动态 Razor HTML

> ID：14014771
> 
> 赞同：0
> 
> 时间：2012-12-23T21:17:16.473
> 
> 标签：asp.net-mvc-3

如何创建动态 Razor 行，例如：

```
@{
    string atr = "MyAttribute";
    string s = "@Html.DisplayFor(modelItem => item.Type.Word." + atr + ")";
} 
```

并使这些线条呈现为剃刀线条？

我试过：

```
@(new HtmlString(s)) 
```

和

```
@Html.Raw(s) 
```

但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:26:23.960

我认为这是可以实现的，但不使用 HtmlHelpers，而是使用直接创建的 html，如下所示：

```
@foreach(var modelItem in Model){
    string atr = "MyAttribute";
    string tag = string.Format(@"<a href=""{0}"">{1}</a>","#",modelItem.Type.Word+atr);
    <text>@tag</text>
} 
```

在尖括号内，您可以执行将导致动态 html 的条件语句

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T19:55:46.730

经过我的研究，我发现这是不可行的。我没有创建动态剃刀线，而是在我创建的 Helpers 目录中创建了一个新的 Helper 类，并定义了一个以所需语言返回 Word 的函数：

```
public abstract class Helper<T> : WebViewPage<T> 
{
    int languageID = Convert.ToInt16(System.Web.HttpContext.Current.Session["Language"]);
    public virtual string getWord (int? id)
    {
        string wantedWord = //operations..;
        return wantedWord;
    }
} 
```

并在 Views 目录中的我的 WebConfig.xml 中定义了 pageBaseType。

```
<pages pageBaseType="MyProject.Helpers.Helper"> 
```

我在我的视图中调用该函数：

```
@getWord(//variables) 
```

# ruby-on-rails - Rails“共享文件”启动应用程序？

> ID：14014773
> 
> 赞同：0
> 
> 时间：2012-12-23T21:17:27.760
> 
> 标签：ruby-on-rails, share, documents

我目前正在开发一个具有名为 Template 的 ActiveRecord 的应用程序。

我希望用户能够

*   “分享”模板，让每个知道链接的人都能看到它们
*   为特定用户提供“查看”或“编辑”权限
*   或仅将模板留给他自己

我相信这个问题应该已经解决了很多次，我想知道是否有人听说过我们可以从什么开始？类似于简单的工作文档共享应用程序？

# struts2 - Struts2 配置 - 一起在 xml 和注释中。可能的？

> ID：14014777
> 
> 赞同：1
> 
> 时间：2012-12-23T21:18:08.583
> 
> 标签：struts2, web-config, annotations

我从未在 Struts2 中使用过注解。

但是现在，在浏览一些休眠注释教程时，我想到了这个问题。是否有可能在 Struts2 中我可以同时使用注释和 xml 来配置我的操作类？即**我是否可以在 struts.xml 中配置我的一些操作类，而其余的使用注释**？

无论如何，当我有机会时，我会尝试编写此代码（现在，使用没有 IDE 且互联网速度慢的系统）。有没有其他人尝试过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T08:02:11.147

是的，伙计，我试过了，效果很好。我在我的 struts 学习任务开始时就完成了它，我尝试在单个项目中做很多事情，我确实在 struts.xml 中配置了一些动作类，其余的使用注释。当你有机会的时候你可以试试，它是 100% 有效的。不用担心 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-23T05:55:19.723

它对我也很好。您必须记住不要`config`为您的`StrutsPrepareAndExecuteFilter`. 相反，请确保 struts.xml 文件位于`/WEB-INF/classes`您的 WAR 目录中。

如果您不小心设置了`config`servlet 过滤器`StrutsPrepareAndExecuteFilter`的参数，您的参数`actionPackages`将被忽略。

# python - 使用 Selenium 从元素中提取“href”

> ID：14014778
> 
> 赞同：1
> 
> 时间：2012-12-23T21:18:12.207
> 
> 标签：python, xpath, selenium

这是我当前的 XPath：

```
//table//tr/td/div/div[1]/div/a/@href 
```

它匹配我正在查看的页面上的十个网址。这种形式有十场比赛`jobs/720800-Associate-Partner-Investment-Consulting-Vancouver-Job-ID-39708.aspx`

我正在尝试使用`selenium.get_text()`拉绳`@href`；但是，我的电话正在拉空白（注意：没有失败，只是拉空白）。我能够成功地在同一页面上的其他元素上提取字符串。

我已经搜索并找不到任何解决我的问题的方法 - 有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-25T04:45:43.257

this might be a bit late, if you are using python selenium (based on your tags) you can do it this way (as v2.44.0) :

```
from selenium import webdriver
# set the driver
driver = webdriver.Firefox()
# get the element
elem = driver.find_element_by_xpath('//table//tr/td/div/div[1]/div/a')
# get the attribute value
link = elem.get_attribute('href') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:24:57.513

如果我理解正确，问题是对于该路径，有`<a href="XXX">`哪些`href`是空的，而其他锚`href`不是空的。你只想得到那些`href`不为空的。那么，使用这个表达式：

```
//table//tr/td/div/div[1]/div/a[@href!=""]/@href 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T04:00:21.280

just Refer to the Anchor tags and don't refer to href attributes. Once we have all elements then perform Get_Attribute() for href element....

```
find_elements_by_xpath("//table//tr/td/div/div[1]/div/a[@href]")
For Loop
print Each_element.Get_Attribute("href") 
```

I hope this helps...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T06:53:10.983

尝试这个

```
get_attribute("//table//tr/td/div/div[1]/div/a@href"); 
```

# c# - 如何将标签添加到 DataGridView 单元格

> ID：14014781
> 
> 赞同：4
> 
> 时间：2012-12-23T21:19:05.837
> 
> 标签：c#, winforms, datagridview

有没有办法在运行时将标签插入 DataGridView 单元格 - 例如，我想在每个单元格的顶角有一个红色的小数字？我是否需要创建一个新的 DataGridViewColumn 类型，或者我可以在填充 DataGridView 时在那里添加一个标签？

**编辑**我现在正尝试按照 Neolisk 的建议使用细胞绘画来做到这一点，但我不确定如何实际显示要显示的标签。我有以下代码，现在我将标签文本添加为​​单元格`Tag`，然后再设置`Value`：

```
private void dgvMonthView_CellPainting(object sender, DataGridViewCellPaintingEventArgs e)
{
    DataGridView dgv = this.dgvMonthView;
    DataGridViewCell cell = dgv[e.ColumnIndex, e.RowIndex];

    Label label = new Label();
    label.Text = cell.Tag.ToString();
    label.Font = new Font("Arial", 5);
    label.ForeColor = System.Drawing.Color.Red;
} 
```

谁能解释我现在如何“附加”`label`到`cell`？

**编辑 2 - 解决方案**我无法完全按照上述方式工作，因此最终将 DataGridViewColumn 和 Cell 子类化并覆盖那里的事件以使用 DrawString 而不是按照 Neolisk 的建议`Paint`添加 Label 存储的任何文本：`Tag`

```
class DataGridViewLabelCell : DataGridViewTextBoxCell
{
    protected override void Paint(Graphics graphics,
                                  Rectangle clipBounds,
                                  Rectangle cellBounds,
                                  int rowIndex,
                                  DataGridViewElementStates cellState,
                                  object value,
                                  object formattedValue,
                                  string errorText,
                                  DataGridViewCellStyle cellStyle,
                                  DataGridViewAdvancedBorderStyle advancedBorderStyle,
                                  DataGridViewPaintParts paintParts)
    {
        // Call the base class method to paint the default cell appearance.
        base.Paint(graphics, clipBounds, cellBounds, rowIndex, cellState,
            value, formattedValue, errorText, cellStyle,
            advancedBorderStyle, paintParts);

        if (base.Tag != null)
        {
            string tag = base.Tag.ToString();
            Point point = new Point(base.ContentBounds.Location.X, base.ContentBounds.Location.Y);
            graphics.DrawString(tag, new Font("Arial", 7.0F), new SolidBrush(Color.Red), cellBounds.X + cellBounds.Width - 15, cellBounds.Y);
        }
    }
}

public class DataGridViewLabelCellColumn : DataGridViewColumn
{
    public DataGridViewLabelCellColumn()
    {
        this.CellTemplate = new DataGridViewLabelCell();
    }
} 
```

实现为：

```
DataGridViewLabelCellColumn col = new DataGridViewLabelCellColumn();
dgv.Columns.Add(col);
col.HeaderText = "Header";
col.Name = "Name"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T17:51:59.590

如果您正在做自定义绘画，您应该使用[Graphics.DrawString](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawstring.aspx)而不是`Label`控制。你`e`是 type `DataGridViewCellPaintingEventArgs`，所以它`Graphics`有财产。这是使用[PaintEventArgs](http://msdn.microsoft.com/en-us/library/76c5db29.aspx)的示例，您的应该类似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T12:58:27.020

[这](http://msdn.microsoft.com/en-us/library/7tas5c80.aspx?PHPSESSID=o1fb21liejulfgrptbmi9dec92)是有关如何在 Winforms DataGridViewCell 中托管控件的 MSDN 教程。

只需按照标签的程序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T13:28:26.687

也许这可以解决你的问题

```
 class LabelColumn : DataGridViewColumn
{
    public LabelColumn()
        : base(new LabelCell())
    {
    }
    public override DataGridViewCell CellTemplate
    {
        get
        {
            return base.CellTemplate;
        }
        set
        {
            if (value != null &&
            !value.GetType().IsAssignableFrom(typeof(LabelCell)))
            {
                throw new InvalidCastException("Must be a CalendarCell");
            }
            base.CellTemplate = value;
        }
    }
}
public class LabelCell : DataGridViewTextBoxCell
{
    public LabelCell()
        : base()
    {
    }
    public override void InitializeEditingControl(int rowIndex, object initialFormattedValue, DataGridViewCellStyle dataGridViewCellStyle)
    {
        base.InitializeEditingControl(rowIndex, initialFormattedValue, dataGridViewCellStyle);
        LabelEditingControl lb = DataGridView.EditingControl as LabelEditingControl;
        if (this.Value == null)
        {
            lb.Value = this.DefaultNewRowValue;
        }
        else
        {
            lb.Value = this.Value;
        }
    }
    public override Type EditType
    {
        get
        {
            // Return the type of the editing control that CalendarCell uses.
            return typeof(LabelEditingControl);
        }
    }

    public override Type ValueType
    {
        get
        {
            // Return the type of the value that CalendarCell contains.

            return typeof(string);
        }
    }
    public override object DefaultNewRowValue
    {
        get
        {
            // Use the "".
            return "";
        }
    }
    class LabelEditingControl : Label, IDataGridViewEditingControl
    {
        DataGridView dataGridView;
        private bool valueChanged = false;
        int rowIndex;
        public Object Value { get; set; }
        public LabelEditingControl()
        {
            this.Enabled = false;
        }
        public object EditingControlFormattedValue
        {
            get
            {
                return this.Value.ToString();
            }
            set
            {
                if (value is String)
                {
                    try
                    {
                        // This will throw an exception of the string is 
                        // null, empty, or not in the format of a date.
                        this.Value = value;
                    }
                    catch
                    {
                        // In the case of an exception, just use the 
                        // default value so we're not left with a null
                        // value.
                        this.Value = "";
                    }
                }
            }
        }
        public object GetEditingControlFormattedValue(DataGridViewDataErrorContexts context)
        {
            return EditingControlFormattedValue;
        }
        public void ApplyCellStyleToEditingControl(
    DataGridViewCellStyle dataGridViewCellStyle)
        {
            this.Font = dataGridViewCellStyle.Font;
            this.ForeColor = dataGridViewCellStyle.ForeColor;
            this.BackColor = dataGridViewCellStyle.BackColor;
        }
        public int EditingControlRowIndex
        {
            get
            {
                return rowIndex;
            }
            set
            {
                rowIndex = value;
            }
        }
        public bool EditingControlWantsInputKey(
   Keys key, bool dataGridViewWantsInputKey)
        {
            // Let the DateTimePicker handle the keys listed.
            switch (key & Keys.KeyCode)
            {
                case Keys.Left:
                case Keys.Up:
                case Keys.Down:
                case Keys.Right:
                case Keys.Home:
                case Keys.End:
                case Keys.PageDown:
                case Keys.PageUp:
                    return true;
                default:
                    return !dataGridViewWantsInputKey;
            }
        }

        // Implements the IDataGridViewEditingControl.PrepareEditingControlForEdit 
        // method.
        public void PrepareEditingControlForEdit(bool selectAll)
        {
            // No preparation needs to be done.
        }
        public bool RepositionEditingControlOnValueChange
        {
            get
            {
                return false;
            }
        }

        // Implements the IDataGridViewEditingControl
        // .EditingControlDataGridView property.
        public DataGridView EditingControlDataGridView
        {
            get
            {
                return dataGridView;
            }
            set
            {
                dataGridView = value;
            }
        }

        // Implements the IDataGridViewEditingControl
        // .EditingControlValueChanged property.
        public bool EditingControlValueChanged
        {
            get
            {
                return valueChanged;
            }
            set
            {
                valueChanged = value;
            }
        }

        // Implements the IDataGridViewEditingControl
        // .EditingPanelCursor property.
        public Cursor EditingPanelCursor
        {
            get
            {
                return base.Cursor;
            }
        }

    }
} 
```

在表单上写下这段代码

```
 LabelColumn clm = new LabelColumn();
        dataGridView1.Columns.Add(clm);
        dataGridView1.Rows.Add(5);
        foreach (DataGridViewRow row in this.dataGridView1.Rows)
        {
            row.Cells[0].Value ="hello"; //or do anything desired
        } 
```

# ios - iPhone/iPad 操作方法

> ID：14014785
> 
> 赞同：-4
> 
> 时间：2012-12-23T21:19:34.293
> 
> 标签：ios, xcode, ipad

作为我之前的问题（http://stackoverflow.com/questions/14006851/universal-app-how-to）的后续，我还有一些问题：

1.  在开发通用应用程序时，我是否让 UI（按钮等）在 iPad 屏幕上看起来更大，或者我可以使用为 iPhone/iPod 触摸屏开发时使用的相同尺寸？向按钮（Glyphish Pro 等）添加图标时，针对 iPad 时是否必须有更大的图标尺寸？我想通过 mini 支持 iPad2（非视网膜和视网膜）。

2.  在创建通用应用程序时，我是否必须用 try...catch 块包围每一段代码以捕获异常？

3.  当用户按下设置按钮时，我希望有一个设置屏幕。我是否总是必须使用 Settings.bundle 或创建我自己的设置 UI，如下所示：http: [//pttrns.com/categories/18-settings](http://pttrns.com/categories/18-settings)？我在我的应用程序中使用 NSUserDefaults 类。我不希望我的设置信息显示在 iPhone/iPad 的全局设置部分。

4.  如果我想在完成我的应用程序并将其发布到应用商店之前更改我的域名怎么办？我看到我提供的域名在 XCode 中被禁用，我无法编辑它。

5.  最后，我想在用户单击按钮时显示多个视图控制器时添加动画。我的应用程序是具有多个视图控制器的单视图应用程序。在 iPad 上加载视图控制器时是否支持动画？

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:24:07.627

1.  ofc 你需要更大的 ipad 视网膜看起来很棒 2 否 3 通常我使用我自己的 4 你必须手动编辑文件，并删除一个属性，之后你可以编辑 5 是

# php - 我应该如何使用媒体捕获 API 处理从 iphone 上传的文件

> ID：14014786
> 
> 赞同：3
> 
> 时间：2012-12-23T21:19:47.697
> 
> 标签：php, iphone, html, image-uploading

这是我尝试使用媒体捕获 API 上传 iPhone 的 html 表单：

```
<form action="processUpTests.php" method="post" name="capture" id="capture" enctype="multipart/form-data">
        <input type="file" accept="image/*" name="ImageFile" id="ImageFile" onchange="javascript:stabEagle();"/>
        <input type="submit" id="SubmitButton" class="hiddenForm" />
    </form> 
```

提交表单是通过这个 stabEagle() 完成的：

```
function stabEagle(){
    $('#SubmitButton').click();
} 
```

这是用于实现目标的 processUpTests.php：

```
if(isset($_POST))
{

    $DestinationDirectory = 'upload/'; //Upload Directory

    // check $_FILES['ImageFile'] array is not empty
    // "is_uploaded_file" Tells whether the file was uploaded via HTTP POST
    if(!isset($_FILES['ImageFile']) || !is_uploaded_file($_FILES['ImageFile']['tmp_name']))
    {
            die('Something went wrong with Upload!'); // output error when above checks fail.
    }

    // Random number for both file, will be added after image name
    $RandomNumber   = rand(0, 9999999999); 

    $ImageType      = $_FILES['ImageFile']['type']; //Obtain file type, returns "image/png", image/jpeg, text/plain etc.

    //Let's use $ImageType variable to check whether uploaded file is supported.
    //We use PHP SWITCH statement to check valid image format, PHP SWITCH is similar to IF/ELSE statements 
    //suitable if we want to compare the a variable with many different values
    switch(strtolower($ImageType))
    {
        case 'image/png':
            $type = "good";
            break;
        case 'image/gif':
            $type = "good";
            break;          
        case 'image/jpeg':
        case 'image/pjpeg':
            $type = "good";
            break;
        default:
            die('Unsupported File!'); //output error and exit
    }

        $target_path = "upload/";

        //naming loop---------------------------------//
        $i = 9; //how many characters
        $prefix =""; //declares prefix var as a string
        $letters = ""; //declares letters var as string
        //execute loop
        for($e = 0; $e < $i; $e++){
            //random letter
            if($odd = $e%2){
            $prefix.= chr(rand(97,122));
            }
            //random number
            $prefix.= rand(0,9);    
        }
        $target_path = $target_path .$prefix. basename( $_FILES['ImageFile']['name']); 

        if(move_uploaded_file($_FILES['ImageFile']['tmp_name'], $target_path)) {
            echo "<img id='userImage' src='".$target_path."' style='max-width:310px'/>";

        } else{
            echo "There was an error uploading the file, please try again!<br/>";
            echo "<pre>".print_r($_FILES)."</pre>";
        } 
```

当我使用我的电脑上传照片时，它可以工作。当我使用我的 iPhone 时它​​不起作用。我有一台装有最新操作系统的 iPhone 5 进行测试。

*   这是我的 iPhone 的功能：

我选择选择文件选项，它会打开菜单以拍照或选择现有图像。我选择拍照选项，我的相机打开并拍照，然后我选择使用选项并提交表单。在 processUpTests.php 上，我收到错误消息“上传文件时出现问题，请重试！”。我正在尝试 print_r $_files 数组，它什么也不输出。似乎没有文件被发送到服务器。此外，没有上传延迟，脚本会立即输出我的错误消息，这让我相信没有文件被发送。

*   其他结论：在我的测试期间，我的一个脚本会上传文件并且它按预期工作，只有一次，然后如果我尝试上传另一个文件，它会简单地跳过上传，并输出我拍摄的第一张图片。脚本与下面的并没有太大的不同。如果我从服务器中删除图像，它会再次工作。自然地，这让我相信我可以上传到服务器上的不同文件夹，将文件复制并重命名到我的上传目录并取消链接原始上传。我错了，没有区别。归结为一件事，我可以使用脚本拍照并上传一次，如果我想上传另一张照片，我必须删除之前的一张。

我不确定这是否对任何人有帮助，但我认为这可能是相关的。再说一次，这可能只是代表我的语法错误。

# java - Jetty 有请求缓存吗？

> ID：14014788
> 
> 赞同：6
> 
> 时间：2012-12-23T21:20:18.800
> 
> 标签：java, intellij-idea, webserver, jetty

我有一些运行几个码头 servlet 并从其他线程向它们发送请求的测试。我经常看到，一旦 servlet 启动，它们甚至在其他线程启动之前就收到有效请求，就好像请求被缓存在某个地方并在码头启动时重新读取一样。可以吗？如果是这样，如何禁用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T10:04:26.593

Jetty 没有请求缓存。

# c# - 如何知道类型参数是否是动态的？

> ID：14014795
> 
> 赞同：4
> 
> 时间：2012-12-23T21:22:03.800
> 
> 标签：c#, generics, dynamic

似乎每次`dynamic`被泛型方法的调用者使用时，实际使用的类型都是简单的`object`. 例如，代码：

```
public static void Main()
{
    Program.DoSomething<int>();
    Program.DoSomething<object>();
    Program.DoSomething<dynamic>();

    Console.WriteLine("Press any key to continue...");
    Console.ReadKey(true);
}

public static T DoSomething<T>() where T : new()
{
    Console.WriteLine(
        "The type is: {0}; equal to object: {1}.",
        typeof(T).FullName,
        typeof(T) == typeof(object));

    dynamic result = new ExpandoObject();
    result.Hello = "Hello";
    result.Number = 123;

    try
    {
        return (T)result;
    }
    catch (Exception)
    {
        Console.WriteLine("Can't cast dynamic to the generic type.");
        return new T();
    }
} 
```

产生：

> 类型为：System.Int32；等于对象：假。
> 无法将动态转换为泛型类型。
> 类型为：System.Object；等于对象：真。
> 类型为：System.Object；等于对象：真。

在泛型方法中，如何确定类型参数是动态的还是普通对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T21:39:18.993

你不能。动态的一切都在旁观者的眼中（意思是：编译器）。它被*实现*为动态的。但是，您可以检查`IDynamicMetaObjectProvider`：如果一个对象实现了它，那么调用者可能正在谈论`dynamic`. 不幸的是，反射也在内部起作用`dynamic`，但根本不会涉及`IDynamicMetaObjectProvider`。

# xslt - XSLT 从 Select 中排除一个特定节点

> ID：14014797
> 
> 赞同：2
> 
> 时间：2012-12-23T21:22:20.017
> 
> 标签：xslt, select, apply-templates

我一直在寻找答案，并尝试*了数百*种排列，但没有任何效果。

我正在尝试处理一个简单 XML 文档的所有节点，除了第一个`<title>`节点。基本上，我正在尝试找到一个 xslt 指令来完成确切的 INVERSE

```
<xsl:apply-templates select="/topic/title"/> 
```

这是我的源 XML：

```
<topic>
    <title>Name of the Document</title>
    <p>Document body</p>
    <topic>
        <title>First Document Subtopic</title>
        <p>Body text for first document subtopic</p>
    </topic>
    <p>Body text continued for document</p>
    <topic>
        <title>Second Document Subtopic</title>
        <p>Body text for document subtopic</p>
        <topic>
            <title>First Document Sub-subtopic</title>
            <p>Body text for first document sub-subtopic</p>
        </topic>
    </topic>
    <p>Body text continued a second time for document</p>
</topic> 
```

这是我的 XSLT（我最初*认为*应该在调用应用模板时使用）：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
    <xsl:output omit-xml-declaration="yes" encoding="UTF-8" method="xml"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
        <BOX>
            <TEXTFLOW>
                <xsl:apply-templates select="*[not(/topic/title)]"/>
            </TEXTFLOW>
        </BOX>
    </xsl:template>

    <xsl:template match="topic">
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="title">
        <PARA STYLE="Title"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="p">
        <PARA STYLE="BodyText"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="text()">
        <FORMAT>
            <xsl:value-of select="."/>
        </FORMAT>
    </xsl:template>
</xsl:stylesheet> 
```

这就是我*想*看到的（注意没有第一`<title>`件事）：

```
<BOX>
    <TEXTFLOW>
        <PARA STYLE="BodyText"/>
        <FORMAT>Document body</FORMAT>
        <PARA STYLE="Title"/>
        <FORMAT>First Document Subtopic</FORMAT>
        <PARA STYLE="BodyText"/>
        <FORMAT>Body text for first document subtopic</FORMAT>
        <PARA STYLE="BodyText"/>
        <FORMAT>Body text continued for document</FORMAT>
        <PARA STYLE="Title"/>
        <FORMAT>Second Document Subtopic</FORMAT>
        <PARA STYLE="BodyText"/>
        <FORMAT>Body text for document subtopic</FORMAT>
        <PARA STYLE="Title"/>
        <FORMAT>First Document Sub-subtopic</FORMAT>
        <PARA STYLE="BodyText"/>
        <FORMAT>Body text for first document sub-subtopic</FORMAT>
        <PARA STYLE="BodyText"/>
        <FORMAT>Body text continued a second time for document</FORMAT>
    </TEXTFLOW>
</BOX> 
```

我可以使用什么选择表达式来完成此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T00:13:23.073

**就这么简单**：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
        <BOX>
            <TEXTFLOW>
                <xsl:apply-templates/>
            </TEXTFLOW>
        </BOX>
    </xsl:template>

    <xsl:template match="/topic/title"/>

    <xsl:template match="title">
        <PARA STYLE="Title"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="p">
        <PARA STYLE="BodyText"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="text()">
        <FORMAT>
            <xsl:value-of select="."/>
        </FORMAT>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<topic>
    <title>Name of the Document</title>
    <p>Document body</p>
    <topic>
        <title>First Document Subtopic</title>
        <p>Body text for first document subtopic</p>
    </topic>
    <p>Body text continued for document</p>
    <topic>
        <title>Second Document Subtopic</title>
        <p>Body text for document subtopic</p>
        <topic>
            <title>First Document Sub-subtopic</title>
            <p>Body text for first document sub-subtopic</p>
        </topic>
    </topic>
    <p>Body text continued a second time for document</p>
</topic> 
```

**产生了想要的正确结果：**

```
<BOX>
   <TEXTFLOW>
      <PARA STYLE="BodyText"/>
      <FORMAT>Document body</FORMAT>
      <PARA STYLE="Title"/>
      <FORMAT>First Document Subtopic</FORMAT>
      <PARA STYLE="BodyText"/>
      <FORMAT>Body text for first document subtopic</FORMAT>
      <PARA STYLE="BodyText"/>
      <FORMAT>Body text continued for document</FORMAT>
      <PARA STYLE="Title"/>
      <FORMAT>Second Document Subtopic</FORMAT>
      <PARA STYLE="BodyText"/>
      <FORMAT>Body text for document subtopic</FORMAT>
      <PARA STYLE="Title"/>
      <FORMAT>First Document Sub-subtopic</FORMAT>
      <PARA STYLE="BodyText"/>
      <FORMAT>Body text for first document sub-subtopic</FORMAT>
      <PARA STYLE="BodyText"/>
      <FORMAT>Body text continued a second time for document</FORMAT>
   </TEXTFLOW>
</BOX> 
```

**说明**：

为了从处理中排除想要的元素，我们使用一个匹配它们并且没有正文的模板：

```
 <xsl:template match="/topic/title"/> 
```

* * *

**二、更新**

不推荐使用以下替代解决方案，因为它是“拉式”的示例，不像上面的“推式”解决方案那样灵活、优雅和可维护，但是 OP 坚持认为他需要这样的劣质解决方案：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
      <BOX>
       <TEXTFLOW>
        <xsl:apply-templates
        select="*/*[not(self::title)]"/>
       </TEXTFLOW>
      </BOX>
    </xsl:template>

    <xsl:template match="title">
        <PARA STYLE="Title"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="p">
        <PARA STYLE="BodyText"/>
        <xsl:apply-templates/>
    </xsl:template>

    <xsl:template match="text()">
        <FORMAT>
            <xsl:value-of select="."/>
        </FORMAT>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于所提供的 XML 文档（如上）时，它会再次产生所需的正确结果**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T00:51:39.357

好吧，你可以在你的根模板中使用这个 XPath：

```
select=".//*[generate-id() != generate-id(/topic/title)]" 
```

您需要将模板更改为`topic`：

```
<xsl:template match="topic" /> 
```

您遇到的问题是因为您当前的选择仅指定应处理的直接子级 - 从根注释（`/`）开始，这实际上只是顶级`topic`元素。上面 XPath 中的`.//*`指定所有后代而不考虑级别，并且谓词显式排除第一个`/topic/title`元素。

您需要确保您的`topic`元素没有处理它们的子元素，因为它们的子元素已经被根模板中的 select 指令处理。

# vb.net - Visual Basic：使用图标保存文件

> ID：14014807
> 
> 赞同：0
> 
> 时间：2012-12-23T21:23:33.227
> 
> 标签：vb.net, visual-studio-2010, visual-studio, visual-studio-2008

我正在创建一个程序，它将自身复制到具有不同名称的桌面。我想给每个文件一个不同的图标。我知道您可以为原始文件分配一个图标，但我希望每个副本都有一个不同的图标。有什么办法可以用代码做到这一点吗？

```
FileCopy(System.Windows.Forms.Application.ExecutablePath, "C:\Users\" & System.Environment.UserName & "\Desktop\bob.exe")
FileCopy(System.Windows.Forms.Application.ExecutablePath, "C:\Users\" & System.Environment.UserName & "\Desktop\tim.exe")
FileCopy(System.Windows.Forms.Application.ExecutablePath, "C:\Users\" & System.Environment.UserName & "\Desktop\jeff.exe") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T00:19:17.650

以不同名称克隆 .exe 程序的技术可能不是一个好主意，例如，如果您更新应用程序，您将拥有一堆未在桌面上更新的不受控制的副本。更不用说在病毒和特洛伊木马流行的今天修改 exes 了……简直太糟糕了。

但是，您可能希望让您的应用程序接受命令行输入，以便您可以使用适当的参数（例如“bob”、“tim”和“jeff”）创建应用程序的快捷方式并设置图标。更安全，更友好。这是创建快捷方式的链接（它在 C# 中，但可以相当容易地转换为 VB）：[http ://www.c-sharpcorner.com/uploadfile/kirtan007/how-to-create-shortcut-of-application-programatically-使用-C-Sharp/](http://www.c-sharpcorner.com/uploadfile/kirtan007/how-to-create-shortcut-of-application-programatically-using-C-Sharp/)。

# html - UITableView 加载本地 HTML

> ID：14014808
> 
> 赞同：0
> 
> 时间：2012-12-23T21:23:36.260
> 
> 标签：html, ios, uitableview

我构建简单的应用程序。我创建了 UITableView 和 DetailViewController。我在标题中创建

```
DetailViewController int *webNumber and UIWebView *webName

DetailViewController.m

switch (webNumber)
{
    case 0:
} 
```

我如何加载本地 HTML？

（我用我的 iPhone 写了这个主题对不起代码）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:39:49.953

我会尝试这样的事情：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"my-local-html-file" ofType:@"html" inDirectory:nil];
NSString *html = [NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil];
[webName loadHTMLString:html baseURL:[[NSBundle mainBundle] resourceURL]]; 
```

[Apple Docs 中有关 loadHTMLString:baseURL 的更多信息](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/loadHTMLString%3abaseURL%3a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T23:27:51.560

只需使用

```
[self.webName loadHTMLString:yourHTMLString baseURL:nil]; 
```

对于本地 HTML。如果要加载 URL，请更改`baseURL:`

# asp.net-mvc - 尝试从 linq 获取列名到 sql 时出现循环引用错误

> ID：14014809
> 
> 赞同：2
> 
> 时间：2012-12-23T21:23:40.563
> 
> 标签：asp.net-mvc, linq-to-sql, asp.net-mvc-4

我正在使用 asp.net mvc 4 在我的控制器中使用以下代码获取 linq to sql 模型的列名：

```
var dataContext = new OrdersDataContext();
var columnNames = dataContext.Mapping.MappingSource
                    .GetModel(typeof(OrdersDataContext))
                    .GetMetaType(typeof(Order))
                    .DataMembers; 
```

我收到以下错误：

```
A circular reference was detected while serializing an object of type
'System.Data.Linq.Mapping.AttributedRootType 
```

这个错误可能来自哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T16:29:52.960

Check your relationships between the tables in the DBML file. You probably have a cycle (circle) between them. Follow the lines.

# c#-4.0 - 如何通过 C# 以编程方式确定站点是否需要身份验证？

> ID：14014811
> 
> 赞同：0
> 
> 时间：2012-12-23T21:23:47.243
> 
> 标签：c#-4.0, authentication, login, artificial-intelligence, server-response

我正在寻求通过 C# 以编程方式确定 [http://about.com之类的网站或](http://about.com)[http://mail.google.com](http://mail.google.com) 之类的页面是否**需要身份验证？**

我在考虑服务器响应 400、401、402 等，但我不太确定。

有人可以指出我正确的方向吗？URL 可以是任意的，也可以是也可能不在 SSL 上，并且可能只有几个页面需要身份验证，而其他页面则不需要。

谢谢

史蒂夫

## 编辑

根据 Will 的建议，我可以改写一下这个问题：在使用 C#创建时，如何确定我们是否**收到了 Web 重定向而不是请求的页面（以及重定向的类型）？**`HttWebRequest`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:28:08.223

最简单的方法是尝试转到您“知道在那里”的页面，看看您是否被重定向到可能碰巧包含“登录”、“登录”等字样的其他地方。

大多数网站只是将您引导至登录页面，而不是向您发送 HTTP 响应。

# ruby-on-rails - 访问视图中的方法类

> ID：14014817
> 
> 赞同：0
> 
> 时间：2012-12-23T21:26:20.963
> 
> 标签：ruby-on-rails, view-helpers

我有生成一些js的类。我应该把这个类放在哪里以及如何在视图中调用它的方法？

```
class Hits
   @@config = Settings.statistic

   class << self
      def js_counter
         if @@config.enable
            ...
         end
      end
   end  
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T22:23:24.033

将它放在 lib 文件夹中并在初始化程序中要求它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:30:05.503

如果需要，将类放入**模型目录。**

在一个视图中：

```
<%= javascript_tag Hits.js_counter.html_escape $>

# if js_counter returns String 
```

# c++ - Int 到字节和向后

> ID：14014820
> 
> 赞同：0
> 
> 时间：2012-12-23T21:26:53.467
> 
> 标签：c++, binary, byte

我以二进制格式将游戏地图保存到文件中。文件的一般结构是：

*   (4byte) 宽度
*   (4byte) 高度
*   宽*高：
    *   (1byte) 平铺
*   宽*高：
    *   (4byte) 数据

为了减小文件的大小，我决定将所有内容保存在字符中，因为我知道我想要读取的数字的确切大小。我做了 2 个函数，getByte 和 makeInt：

```
unsigned char getByte(int src, short int c) //get byte number c from src
{
    return ((char*)(&src))[c];
}

int makeInt(char src[4]) //build int from src
{
    int r=0;
    for (int i=3; i>=0; i--)
        r+=(r<<8)+((unsigned char*)(src))[i];
    return r;
} 
```

以下是我保存和加载地图的方法：

```
void Map::save(const char *fname)
{
    ofstream f;
    f.open(fname,fstream::out | fstream::binary);

    for (int i=3; i>=0; i--)
        f.put(getByte(W,i));
    for (int i=3; i>=0; i--)
        f.put(getByte(H,i));

    for (int i=0; i<W; i++)
        for (int j=0; j<H; j++)
            f.put(tiles[i][j]);

    for (int i=0; i<W; i++)
        for (int j=0; j<H; j++)
            for (int k=3; k>=0; k--)
                f.put(getByte(data[i][j],k));

    f.close();
}

void Map::load(const char *fname)
{
    ifstream f;
    f.open(fname,fstream::in | fstream::binary);

    char bytes[4];

    for (int i=3; i>=0; i--)
        f.get(bytes[i]);    
    W=makeInt(bytes);

    for (int i=3; i>=0; i--)
        f.get(bytes[i]);
    H=makeInt(bytes);

    for (int i=0; i<W; i++)
        for (int j=0; j<H; j++)
            f.get(tiles[i][j]);

    for (int i=0; i<W; i++)
        for (int j=0; j<H; j++)
        {
            for (int k=3; k>=0; k--)
                f.get(bytes[k]);
            data[i][j]=makeInt(bytes);
        }

    f.close();
} 
```

瓷砖（字符）保存和加载良好，一切正常。但是 int 不是。由于奇怪的错误，当我保存 256 时，我加载了 257。而不是预期的 512，我读的是 514。我不想让它变得肮脏（r-=r/256）......我也遇到了一些问题迹象，这可能就是这一切发生的原因。在添加一些无符号强制转换之前，127 之后是 -127、-126、-125 等等。如果这有帮助，这里是地图类：

```
class Map
{
    public:
        int W;
        int H;

        char tiles[MW][MH]; //MW and MH are macros, now they are 64.
        int data[MW][MH];

        void save(const char *fname);
        void load(const char *fname);

    /* moar code */
}; 
```

我通过使用这种模式生成地图来测试它：

```
for (int i=0; i<64; i++)
    for (int j=0; j<64; j++)
        map.data[i][j]=(i*64+j); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:29:45.203

这是不正确的（函数 makeInt(char[4])）：

```
r+=(r<<8)+((unsigned char*)(src))[i]; 
```

你想要`r = r<<8 + ...`。事实上，你不止一次地积累了价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:30:13.143

`r+=(r<<8)+((unsigned char*)(src))[i];`应该`r=(r<<8)+((unsigned char*)(src))[i];`

现在，我普遍关心的是，也许你不应该太担心在这里或那里保存一个字节。如果您真的想节省空间，请使用一些适当的压缩技术 - 霍夫曼编码、字节对或类似的东西。

你确定你使用 f.write() 和 f.read() 节省了任何空间吗 - 我很确定你的代码会简单得多 - 除非你打算将文件存储在一台机器上，否则将它们发送到另一个具有不同字节顺序的，然后将它们加载到那里的代码中，一次存储一个字节需要做很多额外的工作。虽然我确信这是一个很好的学习练习。至少编写一个函数来一次存储一个 int 可能有助于清理代码。

# svn - 如何自动更新 SVN 外部

> ID：14014825
> 
> 赞同：1
> 
> 时间：2012-12-23T21:27:22.760
> 
> 标签：svn, version-control, tortoisesvn, visual-sourcesafe, svn-externals

我们目前使用 VSS 进行源代码控制管理，但我们想转换为其他系统。VSS 支持在不同项目之间共享单个文件。似乎只有在流行的 SCM 系统中（？）SVN 也提供此功能（svn:externals）。其他人仅启用共享文件夹。这就是为什么 SVN 是我们将 repo 转换为的候选者的原因，因为它可能比重新设计 repo 中所有项目的结构以将它们调整为目录共享要容易得多。

但是，SVN 外部必须绑定到指定的文件修订（我不想考虑将外部绑定到头部修订的可能性，因为这样就不可能获得具有足够外部的历史项目版本）。这样，当共享文件被修改时，它不会影响将该文件用作外部文件的任何项目。

因此，当您在其头部版本中下载此类项目之一时，您将不会获得修改后的外部的最新版本。有必要手动修改引用该文件的 externals 属性以更新它。在类似的情况下，VSS 会在获取当前版本中的项目时为您提供其头版本中的所有文件（包括共享文件）。

我想知道如何使 SVN 类似地工作。当我从 repo 获得项目的 head 版本时，我也想在他们的 head 修订中获取所有相关的外部。但我被困住了，不知道如何直接或间接地实现它。

也许一些脚本？但是他们必须做什么，什么时候应该运行？当文件被修改时，他们是否应该更新使用共享文件的项目的所有外部属性？还是应该在下载项目后立即运行它们以更新其外部？

我将非常感谢任何可以引导我找到一个好的解决方案的想法。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:44:03.793

这是您正在寻找的答案：

```
find . -name .svn -execdir svn update -r {2010-08-30} \; 
```

（信用：[https](https://stackoverflow.com/a/3608453/1284631) ://stackoverflow.com/a/3608453/1284631 ）

# iphone - 设置包中的 NSString

> ID：14014826
> 
> 赞同：-3
> 
> 时间：2012-12-23T21:27:30.030
> 
> 标签：iphone, objective-c

我正在尝试在 settings.app 中为我的应用程序实现一个文本字段，并将该值保存为 NSString 以便稍后在我的应用程序中调用。我找不到做这么简单的事情的例子，谷歌调用创建整个数组的所有答案，但我只想保存一个字符串。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:55:39.230

您将需要使用 NSUserDefaults 从设置应用程序中提取任何内容。设置应用程序适用于可以包含数组的 plist。如果要在组中设置项目，则使用数组。

如果您只想在设置应用程序中包含一个字符串，那么您需要将其放入一个数组中，以便设置应用程序可以为其设置一个标识符，您可以在代码中调用该标识符。

您可以单独使用字符串，但它们不会出现在设置应用程序中。

所以最简单的做法是：

![设置列表](../Images/09de19db6d7bb0ecb522b75d232fe9b4.png)

您可以看到设置的根（或本例中的任何 PList）是一个数组，其中包含一个字典。

在其中，您将看到它包含 3 个字符串 - 这些用于：

1）字符串的默认值（这是用户可以更改的

2）关键是您可以在代码中使用它并引用它。

3）第三个是为设置应用程序指定它需要显示的类型。

然后，当这一切都完成后，你可以使用：

```
_buttonSelection = [[NSUserDefaults standardUserDefaults] stringForKey:@"buttonAction01"]; //_buttonSelection is a NSString so that can be anything 
```

这样，用户可以更改该值，您可以将该值用于您的程序。

我知道这并不像您希望的那么简单，但我希望您现在明白为什么它是这样设置的。

祝你好运：-）

# python - 在 LaTeX 中将 HTML img 标签转换为带有标题的图形

> ID：14014827
> 
> 赞同：5
> 
> 时间：2012-12-23T21:27:34.670
> 
> 标签：python, xml, latex, html-parsing, pandoc

我正在编写一个 python 脚本来解析 Wordpress Export XML (wp xml) 的内容以生成 LaTex 文档。到目前为止， wp xml 被解析`lxml.etree`，代码生成一个新的 xml 树，由[texml](http://getfo.org/texml/)处理，然后生成 tex 文件。

目前，我提取每个帖子以及某些元数据（标题、发布日期、标签、内容）。元数据没有问题，但内容部分有点问题。在 wp xml 中，内容作为 CDATA 结构包含在纯 HTML/Wordpress 标记中。要将其转换为乳胶，我选择[pandoc](http://johnmacfarlane.net/pandoc)来解析内容。TeXml 支持内联 LaTeX，因此内容作为纯 LaTeX 添加到树中。

我决定在这种情况下使用 pandoc，因为它已经很好地转换了大多数 html 标签（`a`, `strong`, `em`...），我唯一的问题是它如何处理图像。

我使用子进程与 pandoc 交互：

```
args = ['pandoc', '-f', 'html', '-t', 'latex']
p = Popen(args, stdout=PIPE, stdin=PIPE, stderr=PIPE)
tex_result = p.communicate(input=(my_html_string).encode('utf-8'))[0] 
```

示例帖子可能如下所示

```
<strong>Lorem ipsum dolor</strong>  sit amet, consectetur adipiscing elit.

<a href="http://link_to_source_image.jpg"><img class="alignnone size-medium wp-image-id" title="Title_text" src="http://link_to_scaled_down_version.jpg" alt="Some alt text" width="262" height="300" /></a>

Nam nulla ante, vestibulum a euismod sed, accumsan at magna. Cras non augue risus, vitae gravida quam. 
```

我需要带有嵌入标题的图像，例如

```
\begin{figure}
\includegraphics{link_to_image.jpg}
\label{fig:some_label}
\caption{Some alt text}
\end{figure} 
```

pandoc 似乎将 html`img`标签转换为简单的内联图像，丢弃任何标题或替代文本。

```
\href{http://link\_to\_source\_image.jpg}{\includegraphics{http://link_to_scaled_down_version.jpg}} 
```

我确实窥视了源代码，它看起来`img`只被视为内联元素。（[pandoc 解析函数](https://github.com/jgm/pandoc/blob/master/src/Text/Pandoc/Readers/HTML.hs#L355)）。我不知道 Haskell，所以这就是我走了多远。

但是，如果您将 html 转换为 markdown，它会保留 alt 和标题，结果类似于

```
![Some alt text](http://link_to_scaled_down_version.jpg "Title_text") 
```

使用 Markdown，您可以在生成的 Latex 文档中包含内联图像或图形。如果将此降价转换为乳胶，则结果是

```
\begin{figure}[htbp]
\centering
\includegraphics{http://link_to_scaled_down_version.jpg}
\caption{Some alt text}
\end{figure} 
```

第一个 pandoc 似乎是解析内容的简单解决方案，但我有点卡住，因为 pandoc 也不支持 html 中的内联乳胶，所以我可以首先通过 pandoc 处理所有图像和其余图​​像。

你们对如何（更好地）处理`img`html中的标签以嵌入到带有标题的乳胶中的图形环境中是否有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T22:14:46.173

Pandoc 将*仅*包含图像的段落视为带有标题的图像。这些将变成带有标题的 LaTeX 图形。因此：

```
% pandoc -f html -t latex
<p><img src="myimg.jpg" alt="my text" title="my title"/></p>
^D
\begin{figure}[htbp]
\centering
\includegraphics{myimg.jpg}
\caption{my text}
\end{figure} 
```

这可能会帮助你。

# javascript - 我在哪里可以找到 javascript 核心库？

> ID：14014828
> 
> 赞同：0
> 
> 时间：2012-12-23T21:27:44.273
> 
> 标签：javascript

我知道浏览器都有自己的实现，但是规范在哪里，公共部分是什么，即。数组、字符串、无穷大等

本质上，我试图找出浏览器可以使用哪些变量/部分：位置、导航器、窗口、文档等，并提出了这个问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T21:31:26.057

> 但是规格在哪里，通用部分是什么，即。数组、字符串、无穷大等

[ECMA-262](http://www.ecma-international.org/publications/standards/Ecma-262.htm)

> 本质上，我试图找出浏览器可以使用哪些变量/部分：位置、导航器、窗口、文档等，并提出了这个问题

这些不是 JavaScript 的一部分。有些是由[W3C DOM 规范](http://w3.org/DOM/DOMTR)定义的，有些是[非标准 DOM 0](https://developer.mozilla.org/en-US/docs/Template:DOM0)的一部分，最好通过[MDN](https://developer.mozilla.org/en-US/)引用 (IMO) 。

# python - 在eclipse中通过pydev集成django？

> ID：14014829
> 
> 赞同：10
> 
> 时间：2012-12-23T21:27:44.640
> 
> 标签：python, django, eclipse, pydev

我已经安装了 eclipse indigo 和 pydev 以及 python 32。

我已经配置了我的 python 路径并且可以创建一个“空”的 django 项目：

![在此处输入图像描述](../Images/ebd9f863fb5ed3a6acfe45f660199a15.png)

但是，当我运行右键单击项目并运行 as->pydev: django

我得到：

```
Traceback (most recent call last):
  File "C:\Users\djangoworkspace\test3\src\manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 69, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "C:\Python27\lib\site-packages\django\utils\importlib.py", line 35, in import_module
    __import__(name)
  File "C:\Python27\lib\site-packages\django\core\management\commands\runserver.py", line 8, in <module>
    from django.core.servers.basehttp import AdminMediaHandler, run, WSGIServerException, get_internal_wsgi_application
  File "C:\Python27\lib\site-packages\django\core\servers\basehttp.py", line 26, in <module>
    from django.views import static
  File "C:\Python27\lib\site-packages\django\views\static.py", line 95, in <module>
    template_translatable = ugettext_noop(u"Index of %(directory)s")
  File "C:\Python27\lib\site-packages\django\utils\translation\__init__.py", line 75, in gettext_noop
    return _trans.gettext_noop(message)
  File "C:\Python27\lib\site-packages\django\utils\translation\__init__.py", line 48, in __getattr__
    if settings.USE_I18N:
  File "C:\Python27\lib\site-packages\django\utils\functional.py", line 184, in inner
    self._setup()
  File "C:\Python27\lib\site-packages\django\conf\__init__.py", line 42, in _setup
    self._wrapped = Settings(settings_module)
  File "C:\Python27\lib\site-packages\django\conf\__init__.py", line 95, in __init__
    raise ImportError("Could not import settings '%s' (Is it on sys.path?): %s" % (self.SETTINGS_MODULE, e))
ImportError: Could not import settings 'C:\Python27\Lib\site-packages\django\conf\project_template\settings.py' (Is it on sys.path?): Import by filename is not supported. 
```

知道我需要解决什么问题才能在 Eclipse 中运行 django 项目吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T21:22:21.473

请务必遵循[http://pydev.org/manual_adv_django.html中的这些步骤](http://pydev.org/manual_adv_django.html)

> 1.  该项目必须在 PyDev 中标记为 Django 项目。
>     
>     
> 2.  DJANGO_MANAGE_LOCATION 字符串替换变量必须指向 manage.py 的项目相对位置。
>     
>     
> 3.  DJANGO_SETTINGS_MODULE 字符串替换变量必须包含该项目中设置模块的名称。

DJANGO_SETTINGS_MODULE 实际上是 python 模块名称，而不是特定文件。所以你的 DJANGO_SETTINGS_MODULE 应该是 'project_template.settings'

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-22T13:19:54.987

右键单击项目并选择“Pydev-Django”和以下

1.  'Django manage.py'：这是 manage.py 文件相对于项目根目录的相对路径
2.  'Django 设置模块：' 这是正在使用的设置文件（不包括 .py）的 python 虚线路径，如下所示 [![在此处输入图像描述](../Images/eb57b96cdfb37db4621ad54502de1025.png)](https://i.stack.imgur.com/E0PMX.png)

> 如果您看到如上图所示的消息“Module: xxsetting could be found”，则将此项目添加到 python 路径中，如下所示

右键单击项目并选择 Pydev - PYTHONPATH

[![在此处输入图像描述](../Images/a141f9f66f517dd6286b575987e7117b.png)](https://i.stack.imgur.com/4wGxJ.png)

现在添加了python项目

[![在此处输入图像描述](../Images/8a590f18d38858c3958d606d31580134.png)](https://i.stack.imgur.com/pPojQ.png)

添加python路径到项目设置模块后发现 [![在此处输入图像描述](../Images/3beb8ef7a24a6e2e075baeda23418970.png)](https://i.stack.imgur.com/tl0i3.png)

现在一切都会好的 :) 注意：这是使用 django 1.10 和 pydev 5.2 制作的

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-17T16:21:48.803

*   转到窗口 -> 首选项 -> Pydev -> 解释器 - Python
*   转到字符串替换变量选项卡
*   添加以下 2 个变量：
    *   带有 django/conf/project_template/ 路径的 DJANGO_MANAGE_LOCATION
    *   DJANGO_SETTINGS_MODULE 与 /settings/

# android - Android FasterXML 解析器 - 对 javax.xml.stream.events 包的依赖

> ID：14014838
> 
> 赞同：0
> 
> 时间：2012-12-23T21:28:31.987
> 
> 标签：android, xml-parsing

我正在尝试在我的 android 应用程序中使用 FasterXML (http://wiki.fasterxml.com/) Streaming API。作为解析逻辑的一部分，我需要使用以下类，这些类是我添加到“Android 依赖项”(libs) 中的 stax-api-1.0.1.jar 的一部分。

```
import javax.xml.stream.events.EndElement;
import javax.xml.stream.events.StartElement;
import javax.xml.stream.events.XMLEvent; 
```

我的课程编译得很好，但是当我尝试在模拟器上运行时，它给了我以下错误：

“处理“javax/xml/stream/events/StartElement.class”的问题：

不构建核心库时对核心类（java.* 或 javax.*）的不明智或错误使用。

这通常是由于在使用 IDE（例如 Eclipse）时无意中在应用程序的项目中包含了核心库文件。如果您确定您不是故意定义核心类，那么这是对正在发生的事情的最可能的解释。"

我正在使用 API 8（目标）。是否有解决方法来使用这些 javax 类..？

# iphone - iPhone录音同步协议

> ID：14014840
> 
> 赞同：1
> 
> 时间：2012-12-23T21:28:38.033
> 
> 标签：iphone, ios, bluetooth, synchronization, gamekit

我正在尝试做一个简单的事情。我想让 2 个不同的 iphone 在同一时刻开始播放视频（两个视频必须同步）。两部 iPhone 使用 GameKit 和蓝牙进行通信，它们通过蓝牙发送/接收消息，延迟从 90 毫秒到 500 毫秒不等。
我尝试让它们同时启动（日期和小时），但设备的时间可能不同步。任何人都知道一种好的方法/算法可以使两个设备同时启动一项任务，并且延迟可能更少？我可以使用一些多人视频游戏的算法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:36:56.190

您应该尝试使用现有协议进行同步。以[NTP](http://www.ntp.org/)为例。

# javascript - 替换.click（）上的按钮？

> ID：14014843
> 
> 赞同：0
> 
> 时间：2012-12-23T21:28:59.070
> 
> 标签：javascript, jquery

我试图在 .click() 上相互交换三个按钮：“播放”、“暂停”和“恢复”。第一个按钮交换从#play —> #pause 开始，但之后这个#pause 按钮​​没有响应。

[http://jsfiddle.net/YzVJN/](http://jsfiddle.net/YzVJN/)

任何帮助，将不胜感激！

```
$("#start").click(function() {
    $("#start").replaceWith("<button id=\"pause\">Pause</button>");
});

$("#pause").click(function() {
    $("#pause").replaceWith("<button id=\"resume\">Resume</button>");
});

$("#resume").click(function() {
    $("#resume").replaceWith("<button id=\"pause\">Pause</button>");
});​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:36:55.143

我会简单地更改文本，并可能添加一个`data-`属性来告诉我更多关于当前状态的信息，因为文本在未来的版本中可能会与本​​地化交换。

```
<button class="btn-action" data-action="pause">Pause</button> 
```

进而

```
$(".btn-action").click(function() {
    var currentAction = $(this).data("action"),
        nextAction = "";

    switch (currentAction)
    {
      case "play": nextAction = "pause"; break;
      case "pause": nextAction = "resume"; break;
      case "resume": nextAction = "play"; break;
    }

    $(this).text(nextAction).data("action", nextAction);
}); 
```

当您有本地化设置时，您可以轻松地将其换成`text()`类似的东西

```
$(this).text(actionLocalization[nextAction]) 
```

**当你重复自己时，**总是怀疑自己的代码......****

 *** * *

这是一个简单的例子：http: [//jsbin.com/ehonob/1/edit/](http://jsbin.com/ehonob/1/edit/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T21:33:23.730

首先，您可能不想一直重新创建 DOM 元素。首先将所有内容都放在 HTML 中，然后隐藏并显示您需要的内容。

[http://jsfiddle.net/YzVJN/4/](http://jsfiddle.net/YzVJN/4/)

```
$("#start").click(function() {
    $("#start").hide();
    $("#pause").show();
});

$("#pause").click(function() {
    $("#pause").hide();
    $("#resume").show();
});

$("#resume").click(function() {
    $("#resume").hide();
    $("#pause").show();
});​ 
```

如果您确实想重新创建 DOM 元素，这些元素每次都会是新元素，因此`$("resume")`在第一次运行脚本时选择不会返回任何内容 - 在这种情况下，请按照其他人的建议执行并使用类似`on('click', '#pause', ...)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:32:24.323

您可以使用`on()`事件委托：

```
$("body").on("click", "#start", function() {
    $(this).replaceWith("<button id=\"pause\">Pause</button>");
}).on("click", "#pause", function() {
    $(this).replaceWith("<button id=\"resume\">Resume</button>");
}).on("click", "#resume", function() {
    $(this).replaceWith("<button id=\"pause\">Pause</button>");
});​ 
```

`body`请注意，您可以使用任何其他*静态*父元素代替。

**演示：http:** [//jsfiddle.net/YzVJN/5/](http://jsfiddle.net/YzVJN/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:35:32.283

问题是在您设置绑定时您的元素不存在。

您需要使用“live”、“delegate”或“on”，如下所示：

```
$(document).on("click", "#pause", function() {
    $("#pause").replaceWith("<button id=\"resume\">Resume</button>");
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T21:45:45.273

如果您真的想删除和添加元素，那么可以这样做并每次重新注册处理程序。

```
$("#start").click(function() {
    $("#start").replaceWith("<button id=\"pause\">Pause</button>");
    $("#pause").click(function() {
        replaceWithResume();
    }); 
});

function replaceWithResume(){
    $("#pause").replaceWith("<button id=\"resume\">Resume</button>");
    $("#resume").click( function() { replaceWithPause() } );
}

function replaceWithPause(){
    $("#resume").replaceWith("<button id=\"pause\">Pause</button>");
    $("#pause").click( function() { replaceWithResume() } );
}
​ 
```**

# c - 例如，在 C 中定义变量时，该变量的内存地址存储在哪里？

> ID：14014845
> 
> 赞同：9
> 
> 时间：2012-12-23T21:29:07.397
> 
> 标签：c, memory, binary, computer-science, ram

如果我在 C 中定义一个变量（即 unsigned short int n = 5），则该值以二进制形式存储在用户 RAM 中的某处（在这种情况下，它看起来像 0000 0000 0000 0101）。存储该值的位置也有一个二进制地址。（即，值 5 可以存储在 0010 中，这意味着它在 ram 中同时使用 0010 和 0011，因为它使用 2 个字节）。变量 n 的名称表示存储该值的内存地址。该内存地址存储在哪里？这不会占用更多的内存吗？如果确实如此，那么该地址是否也必须具有地址？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-23T21:33:46.710

变量的内存地址不直接存储在内存中。它是访问变量的代码的一部分。根据具体情况，它可以是偏移量（与已知位置的距离 - 例如局部变量的堆栈指针，对于全局变量，它可能是程序计数器）或绝对地址（仅适用于全局变量）。

如果您想要一个变量来存储变量的地址，那么是的，您也需要该变量的内存。这种类型的变量称为指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:38:23.467

这取决于几个因素，例如分配方法（堆栈或静态），如何访问变量，但让我们假设这段代码：

```
static int n = 5;
printf("%p\n", &n); 
```

在这种情况下，地址`n`被存储在`printf`被调用的代码段中。如果你反汇编代码，你会发现一条`push`指令，将地址压入堆栈，就在调用`printf`. 被推送的地址是`n`（它是被推送的两个地址之一，还有格式字符串）的地址。

正如我上面所说，它并不总是相同的方式。不同的架构和编译标志（例如`-fpic`）可以改变它。
此外，如果变量在堆栈上，或者如果对它的引用不是来自代码，而是来自数据（例如`int n=5; int *p = &n;`），事情就会改变。

# ruby-on-rails - 获取任务ID：@task = Worker.where(:name=>params[:worker_id])

> ID：14014847
> 
> 赞同：0
> 
> 时间：2012-12-23T21:29:23.517
> 
> 标签：ruby-on-rails

我有两个控制器：工人和任务。

这是变量`index of the tasks_controller`：

```
def index
   @task = Worker.where(:name => params[:worker_id])

   respond_to do |format|
        format.html # show.html.erb
        format.json { render json: @worker }
    end
end 
```

这是我的`index.html.erb of Tasks`：

```
<table>
  <% @task.each do |task| %>
    <tr>
      <td><%= task.name %></td>
      <td><%= task.task %></td>
      <td><%= task.done %></td>
      <td><%= link_to 'Edit', edit_worker_task_path(task.name,1) %></td>
    </tr>
  <% end %>
</table> 
```

我必须知道任务的 id 是什么（例如，我设置了“1”）。

![在此处输入图像描述](../Images/4c1e4edeed26bccbef93d3bd8799bf9d.png)

我附上我的`rake routes`命令：

![在此处输入图像描述](../Images/305f25b6fb24801f3f26cac87e5b7bc7.png)

这是我的`edit of the task`（我只是想看看我是否得到相关任务）：

```
<table>
    <% @task.each do |task| %>
    <tr>
        <td><%= task.name %></td>
        <td><%= task.task %></td>
        <td><%= task.done %></td>
    </tr>
    <% end %>
</table> 
```

这是我的`models/worker.rb`：

```
class Worker < ActiveRecord::Base
   attr_accessible :done, :name, :task
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:37:01.113

也许你应该做类似的事情

```
edit_worker_task_path(task, @task) 
```

在阅读您的源代码时，我注意到您有一些奇怪的命名（@task = Worker.where）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:40:56.993

要链接到特定任务的编辑页面，只需这样做：

```
<%= link_to 'Edit', edit_worker_task_path(task) %> 
```

如果这是一个嵌套路由，您可能希望确保有一个 edit_task 路由，以便您可以这样做：

```
<%= link_to 'Edit', edit_task_path(task) %> 
```

但是由于您的 @task 变量实际上是 Worker 模型的集合，因此如果您调用了 edit_task_path(task) 助手，那么您最终会进入编辑任务页面，但它会通过 Worker 的 id。那有意义吗？

**编辑** 经过一番交谈，我们创建了必要的 Task 和 Worker 模型，整理了 migrations 和 routes.rb 文件。然后指着他`new_worker_task_path(worker)`看了一下工人索引页。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T21:57:06.770

您的 link_to 应该像这样使用帮助程序：

```
<%= link_to 'Edit', edit_worker_task_path(id: task.id) %> 
```

另外，我建议您使用 I18n 来本地化您的应用程序。即使你只使用一种语言，也许有一天你会需要第二种（或几种）其他语言。到目前为止，您只能翻译一种语言。

您的 @task 变量应该设置如下（这很奇怪，因为您调用了变量 task 但您调用了 Worker 模型......）：

```
@tasks = Task.where(worker_id: params[:worker_id]) 
```

# python - python on-the-fly md5 作为一个读取流

> ID：14014854
> 
> 赞同：3
> 
> 时间：2012-12-23T21:30:31.230
> 
> 标签：python, python-3.x

python 3是否具有制作过滤流的结构？特别是，我的目标是计算从带有请求的 REST 服务读取的内容的 md5 校验和，而无需制作额外的副本。如果我可以子类化某种过滤器流并将字节推入一个 hashlib 派生的 md5 对象，我会很好。

目前，我的代码包括：

```
shutil.copyfileobj(r.raw, outstream) 
```

其中 'r' 是响应对象。我可以在 r.raw 周围包装一个生成器或一些类似的东西，它将在每个读取的数据缓冲区中调用，以便我可以将它传递给 md5？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-23T21:32:55.667

`requests`支持[以块的形式读取 URL 数据](https://requests.readthedocs.io/en/latest/user/advanced/#streaming-requests)，并且该`hashlib`库允许您以块的形式计算 MD5，因此您已经拥有所需的一切。您可以选择[`.iter_lines()`](https://requests.readthedocs.io/en/latest/api.html#requests.Response.iter_lines)或[`.iter_content()`](https://requests.readthedocs.io/en/latest/api.html#requests.Response.iter_content)：

```
import requests
import hashlib

r = requests.get(url, stream=True)

sig = hashlib.md5()
for line in r.iter_lines():
    sig.update(line)

print(sig.hexdigest()) 
```

如果您*必须*将其视为过滤器，请使用生成器：

```
class MD5TransparentFilter:
    def __init__(self, source):
        self._sig = hashlib.md5()
        self._source = source

    def __iter__(self):
        for line in self._source:
            self._sig.update(line)
            yield line

    def hexdigest(self):
        return self._sig.hexdigest() 
```

然后在您的`.iter_lines()`或`.iter_content()`迭代器上使用它：

```
r = requests.get(url, stream=True)
filtered = MD5TransparentFilter(r.iter_content(1000))

for line in filtered:
    # do something with the line

print(filtered.hexdigest()) 
```

因为`shutil.copyfileobj()`您需要实现`.read()`接口而不是`.__iter__()`，但原理是相同的：

```
class MD5TransparentFile:
    def __init__(self, source):
        self._sig = hashlib.md5()
        self._source = source

    def read(self, buffer):
        # we ignore the buffer size, just use the `.next()` value in the source iterator
        try:
            line = self._source.next()
            self._sig.update(line)
            return line
        except StopIteration:
            return b''

    def hexdigest(self):
        return self._sig.hexdigest() 
```

该类`MD5TransparentFile()`采用您的`.iter_content()`或`.iter_lines()`迭代器，并在每次调用时从该迭代器返回数据，并`.read()`即时计算 MD5。这可以直接用于您的`shutil.copyfileobj()`示例。

# apache - 重写所有以..开头的url，

> ID：14014857
> 
> 赞同：0
> 
> 时间：2012-12-23T21:30:48.703
> 
> 标签：apache, mod-rewrite

我想重写以下网址：

```
 http://localhost/albums/album_name/22 
```

到：

```
http://localhost/album.php?id=22 
```

我只想重写以 /albums/ 开头的网址。我试过这个，但它不起作用。

```
RewriteRule /albums/^[^/]+/([\d]+)$ /album.php?gallery_id=$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:11:25.520

你有一个`^`在错误的位置（我怎么错过了？？？）

```
RewriteRule ^albums/[^/]+/([\d]+)$ /album.php?gallery_id=$1 [L] 
```

# asp.net - 如果语句不起作用？

> ID：14014858
> 
> 赞同：2
> 
> 时间：2012-12-23T21:30:49.190
> 
> 标签：asp.net, vb.net

即使 txtUserName.Text = "Adm_A" 它总是与 else 一起使用，这是为什么呢？

```
If txtUserName.Text Like "Adm_?" Then
            Response.Redirect("AdminLoggedIn.aspx")
        Else
            Response.Redirect("LoggedIn.aspx")
        End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T23:15:36.747

一个简单的控制台应用程序来测试您的问题

```
Sub Main
    Dim test = "Adm_AA"
    CheckLike(test)
    test = "Adm_A"
    CheckLike(test)
    test = "Adm_A "   ' a space after the A'
    CheckLike(test)
End Sub

Sub CheckLike(ByVal toCheck as string)

    If toCheck Like "Adm_?" Then
        Console.WriteLine("Matched")
    Else
        Console.WriteLine("Not Matched")
    End If
End Sub 
```

结果：

```
Not Matched
Matched
Not Matched 
```

所以在你的弦中有些东西并不像你想象的那样。使用调试器并验证 if 语句及其参数。还要注意运行 webapp 的服务器的语言环境和使用的选项比较

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:38:07.947

我相信那是因为问号是一个模式运算符。请检查[http://msdn.microsoft.com/en-us/library/swf8kaxw(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/swf8kaxw(v=vs.71).aspx)

您是否尝试过使用包含而不是喜欢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:52:05.447

你能试试这个吗

如果 txtUserName.Text.Trim() 喜欢 "Adm?" 然后

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:35:22.017

尝试这个：

```
If txtUserName.Text.Trim() Like "Adm_?" Then 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T00:28:45.040

如何检查它是否以“Adm_”字符串开头：

```
If txtUserName.Text.StartsWith("Adm_") Then
        Response.Redirect("AdminLoggedIn.aspx")
    Else
        Response.Redirect("LoggedIn.aspx")
    End If 
```

# jquery - jquery 用动画切换 div

> ID：14014860
> 
> 赞同：0
> 
> 时间：2012-12-23T21:31:01.170
> 
> 标签：jquery, css, animation

我之前问过这个问题并提供了一些代码，但是当我把它放在 div 中时它拒绝工作，因为网站是结构化的，所以我在这里重试。

这是页面的格式。

[http://jsfiddle.net/4FMGG/2/](http://jsfiddle.net/4FMGG/2/)

```
<div style="width:960px;">
    <div style="float:left; width:960px;">
        <a href='#'>Electric</a>
        <a href='#'>Mechanic</a>
    </div>                    
    <div style="width:320px; float:left;">
        <div id='elec'>Box 1a</div>
        <div id='meca'>Box 2a</div> 
    </div>
    <div style="width:320px; float:left;">
       <img src="dial.png" style="margin-top:150px;">
    </div>
    <div style="width:320px; float:right;">
        <div id='meca'>Box 2b</div> 
        <div id='elec'>Box 1b</div>
    </div>
</div>​ 
```

我基本上是想复制[http://mitchell-me.com/](http://mitchell-me.com/)上的服务部分， 稍后我会全部更改，但效果让我很丧。上次给了我两个建议，第一个是 jquery，它在 div 之外运行良好，但由于它必须在 div 中，所以我无法使用它。第二个是该站点正在使用 tweenlite，但这种方法对于这个特殊功能来说似乎有点过分了。

所以基本上我像疯了一样挣扎，真的需要在圣诞节前把网站的这一部分包起来，所以希望在堆栈溢出时能在这里获得一些圣诞节的好运xD

为代码格式道歉，我无法使用此编辑器正确放置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T22:25:28.313

把它搅在一起，让我知道它是否适合你的需要。这是一个小提琴：http: [//jsfiddle.net/4FMGG/6/](http://jsfiddle.net/4FMGG/6/)

css

```
 body{
    text-align:center;
    background:#eee;
}
.container {
    width:400px; margin:100px auto 0;
    text-align:center;
    position:relative;
}
#dial {
    width:210px;position:relative;margin:0 auto;
}
#switch {
    cursor: pointer;
}
#gear {
    position:absolute;
    top:55px;left:55px;
    opacity:0;
}
#bulb {
    position:absolute;
    top:70px;left:83px;
}
#mech1, #mech2, #elec1, #elec2 {
    position:absolute;
    width:100px;
    height:100px;
    background:#fff;
}
#mech1 {
    top:0;right:0;
    display:none;
}
#elec1 {
    top:0;left:0;
}
#mech2 {
    bottom:0;left:0;
    display:none;
}
#elec2 {
    bottom:0;right:0;
} 
```

html

```
<div class="container">
    <div id="dial">
        <img src="http://mitchell-me.com/img/dial.png">
        <div id="bulb">
            <img src="http://mitchell-me.com/img/bulb.png">
        </div>
        <div id="gear">
            <img src="http://mitchell-me.com/img/gear.png">
        </div>
    </div>
    <div id="mech1"></div>
    <div id="mech2"></div>
    <div id="elec1"></div>
    <div id="elec2"></div>
    <div id="switch">
        <a id="one">One</a>
        <a id="two">Two</a>
    </div>
</div> 
```

javascript

必须包括以下库：

//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js

//jqueryrotate.googlecode.com/files/jQueryRotate.2.2.js

```
$("#one").click(function(){
    $('#dial').rotate({
        angle: 100, 
        animateTo:0,
        duration:1000
    });
    $('#bulb').animate({'opacity':1}, 1000);
    $('#gear').animate({'opacity':0}, 1000);
    $('#mech1, #mech2').fadeOut(1000);
    $('#elec1, #elec2').fadeIn(1000);
});  

$("#two").click(function(){
    $('#dial').rotate({
        angle: 0, 
        animateTo:100,
        duration:1000
    });
    $('#bulb').animate({'opacity':0}, 1000);
    $('#gear').animate({'opacity':1}, 1000);
    $('#mech1, #mech2').fadeIn(1000);
    $('#elec1, #elec2').fadeOut(1000);
}); 
```

# javascript - 将图像约束到 KineticJS 中的路径

> ID：14014861
> 
> 赞同：0
> 
> 时间：2012-12-23T21:31:11.530
> 
> 标签：javascript, jquery, html, canvas, kineticjs

是否可以将对象（如 a `Image`）限制为 a 的笔画`Polygon`？

**jsfiddle：http:** [//jsfiddle.net/CZzpZ/](http://jsfiddle.net/CZzpZ/)

在 JSfiddle 中，我希望 Yoda`Image`将其阻力限制在多边形的笔划上`poly`。查看了[Complex Drag Bounds](http://www.html5canvastutorials.com/kineticjs/html5-canvas-drag-and-drop-bounds-tutorial-with-kineticjs/) KineticJS 教程，但没有得到任何关于限制路径的线索，只限制在一个区域内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T23:28:27.757

一种方法是，在 中`dragBoundFunc`，获取 的点`Polygon`，然后应用一些基本的向量数学来找出该位置最接近多边形上的哪个点。

**[演示](http://jsfiddle.net/ZcawG/4/)**

我必须指出，我不喜欢每个可能的可拖动图像，你必须设置一个不同的`dragBoundFunc`，因为它们会有不同的多边形。因此，我创建了一个通用函数`polyStrokeBoundDragFunc`（富有想象力，对吗？）并假设多边形作为参数传递。

所以，`dragBoundFunc`看起来像

```
...

dragBoundFunc: function(pos) {
            return polyStrokeBoundDragFunc(pos, poly, group);
        }
... 
```

此处包含该组是因为我们还需要多边形的组来将位置从绝对位置转换为局部位置。这是必需的，因为如果多边形在一个组中，`polygon.getPoints`将给出局部点。传递给的位置`dragBoundFunc`似乎是绝对的。

现在，问题的肉，仍然很生（因为它是未经优化的肉，你看）！此函数找出每边距给定位置最近的点，然后比较距离。选择与该位置距离最小的一侧。

```
var polyStrokeBoundDragFunc = function(pos, poly, group) {
    //Check if the poly is usable as a polygon
    if(!poly || !poly.getPoints) {
        return pos;
    }

    //Convert the drag position from absolute to local to the group
    //if, of course, there is a group
    if(group && group.getAbsolutePosition) {
        pos.x = pos.x - group.getAbsolutePosition().x;
        pos.y = pos.y - group.getAbsolutePosition().y;
    }

    var newX = pos.x, newY = pos.y,
        diff = 9999;   //A bloated diff, for minimum comparision

    //Get the list of points from the polygon
    var points = poly.getPoints();

    //The algorithm is simple, iterate through the list of points
    //and select a pair which forms a side of the polygon.
    //For this side, pick a main point. Find the direction vector
    //with respect to this main point, and find the position vector
    //from this main point to the drag position.
    //Dot product of position vector and direction vector give us
    //the projection of the point on the current side.
    //A simple bounds checking to ensure that the projection is on
    //the side, then a distance calculation.
    //If the distance found is less than the current minimum difference
    //update diff, newX and newY.   
    for(var i=0; i<points.length; i++) {
        //Get point pair.
        var p1 = points[i];
        var p2 = points[(i+1)%points.length];

        //Find the bounds for checking projection bounds later on        
        var minX = (p1.x < p2.x ? p1.x : p2.x),
            minY = (p1.y < p2.y ? p1.y : p2.y),
            maxX = (p1.x > p2.x ? p1.x : p2.x),
            maxY = (p1.y > p2.y ? p1.y : p2.y);

        //Select p2 as the main point.
        //Find the direction vector and normalize it.       
        var dir = {x: p1.x - p2.x, y: p1.y - p2.y};
        var m = Math.sqrt(dir.x*dir.x + dir.y*dir.y);
        if(m !== 0) {
            dir.x = dir.x/m;
            dir.y = dir.y/m;
        }

        //Find the position vector        
        var pVec = {x: pos.x - p2.x, y: pos.y - p2.y};

        //Dot product        
        var dot = pVec.x * dir.x + pVec.y * dir.y;

        //Find the projection along the current side        
        var p = {x: p2.x + dir.x*dot, y: p2.y + dir.y*dot};       

        //Bounds checking to ensure projection remains
        //between the point pair.       
        if(p.x < minX)
            p.x = minX;
        else if(p.x > maxX)
            p.x = maxX;

        if(p.y < minY)
            p.y = minY;
        else if(p.y > maxY)
            p.y = maxY;

         //Distance calculation.
         //Could have simply used squared distance, but I figured 9999 may
         //not be bloated enough for that.       
         var d = Math.sqrt((p.x-pos.x)*(p.x-pos.x) + (p.y-pos.y)*(p.y-pos.y));

         //Minimum comparision.       
         if(d < diff) {
              diff = d;
              newX = p.x;
              newY = p.y;
         }
    }

    //If in a group's local, convert back to absolute    
    if(group && group.getAbsolutePosition) {
        newX += group.getAbsolutePosition().x;
        newY += group.getAbsolutePosition().y;
    }

    //Return updated drag position.
    return {
        x: newX, 
        y: newY
    }
}; 
```

这似乎可行，但我仍然觉得解决方案有些混乱。可能有更好的方法，我想不出。

# php - xpath查找绝对路径有什么简单的方法吗？

> ID：14014862
> 
> 赞同：2
> 
> 时间：2012-12-23T21:31:12.087
> 
> 标签：php, html, xpath

我试图找到一种方法来为页面上的元素“添加书签”，以便稍后我可以检查它。到目前为止，我所做的一切都让我遇到了一些问题，所以我得出的结论是，找到绝对路径可能是唯一的方法。

我通常是 xpath 或 DOMdocument 的新手，所以我可能命名错误，但是绝对路径我的意思是：

`"/html/body/div[1]/div[1]/div[2]/span[2]"`

假设我使用：

`$element_with_something = $xpath->query('(//*[text()= "something"])');`

这给了我一个元素。现在我的问题是有一种简单的方法可以找到它的绝对路径。如果不。那么我可能不得不在树上递归。

如果是这样，我如何检查元素是否有父元素？

我知道我可以用它`hasChildNodes()`来寻找孩子，但有没有办法找出是否有父母？或任何其他方式来打破它击中树顶的递归？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:39:25.577

您可能正在寻找[`DOMNode::getNodePath()`](http://php.net/domnode.getnodepath). 一个简单的例子：

```
$xml = <<<XML
<blaah1 name="whatever">
    <gender name="male">

        <example1 baseurl="male/86644/">
            <x u="lol.png"/>
            <x u="haha.png"/>
            <x u="name.png"/>
        </example1>

        <example2 baseurl="male/27827/">
            <x u="page.png"/>
            <x u="examp.png"/>
            <x u="bottom.png"/>
        </example2>
    </gender>
</blaah1>
XML;

$doc = new DOMDocument();
$doc->loadXML($xml);
$xp = new DOMXPath($doc);
foreach($xp->query('//node()') as $node ) {

    echo $node->getNodePath(), "\n";

} 
```

它的输出：

```
/blaah1
/blaah1/text()[1]
/blaah1/gender
/blaah1/gender/text()[1]
/blaah1/gender/example1
/blaah1/gender/example1/text()[1]
/blaah1/gender/example1/x[1]
/blaah1/gender/example1/text()[2]
/blaah1/gender/example1/x[2]
/blaah1/gender/example1/text()[3]
/blaah1/gender/example1/x[3]
/blaah1/gender/example1/text()[4]
/blaah1/gender/text()[2]
/blaah1/gender/example2
/blaah1/gender/example2/text()[1]
/blaah1/gender/example2/x[1]
/blaah1/gender/example2/text()[2]
/blaah1/gender/example2/x[2]
/blaah1/gender/example2/text()[3]
/blaah1/gender/example2/x[3]
/blaah1/gender/example2/text()[4]
/blaah1/gender/text()[3]
/blaah1/text()[2] 
```

# unix - ocaml oUnit 和 main ocaml lib 对实现 Unix 做出了不一致的假设

> ID：14014866
> 
> 赞同：2
> 
> 时间：2012-12-23T21:31:27.253
> 
> 标签：unix, linker, ocaml, macports

[对接口（Ocaml）的不一致假设](https://stackoverflow.com/questions/9166489/inconsistent-assumptions-over-interface-ocaml)表明我重建并且我已经尝试过但无济于事。

我使用 mac port 来管理我的大部分开发工具，并且自从升级到 Mac OS 10.8.2 后，ocaml 和 ocaml-ounit 之间的交互似乎很糟糕。

下面是一个非常小的 shell 转储，但问题是

> ```
>  Error: Files /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmxa
>         and /opt/local/lib/ocaml/unix.cmxa
>         make inconsistent assumptions over implementation Unix 
> ```

[并按照http://www.puredarwin.org/developers/macports/port](http://www.puredarwin.org/developers/macports/port)中的描述强制重建似乎无法解决问题：

> 要强制升级（重建），请使用：
> 
> ```
>  port -f upgrade vim 
> ```

下面是我尝试构建本机二进制文件的 shell 转储（`.byte`工作正常，但我即将开始一轮分析并想要分析本机执行）以及我尝试将 mac 端口弯曲到我的意愿。

任何有关如何进一步调查此问题的想法将不胜感激。我宁愿不自己从源代码开始构建 ocaml，因为我希望能够将我的项目分发给同事，只需很少的说明就可以启动和运行他们需要做什么，所以我想尽可能使用 vanilla 包。

> ```
>  > ocaml make.ml PegParserTest.native
>  ocamlbuild \
>          -libs \
>          nums,str,unix,oUnit,graph \
>          -cflags \
>          -g,-w,+a-4,-warn-error,+a-4,-I,/opt/local/lib/ocaml/site-lib/oUnit,-I,/opt/local/lib/ocaml/site-lib/ocamlgraph \
>          -lflags \
>          -g,-I,/opt/local/lib/ocaml/site-lib/oUnit,-I,/opt/local/lib/ocaml/site-lib/ocamlgraph \
>          PegParserTest.native
>  + /opt/local/bin/ocamlopt.opt -g -I /opt/local/lib/ocaml/site-lib/oUnit -I /opt/local/lib/ocaml/site-lib/ocamlgraph nums.cmxa str.cmxa unix.cmxa oUnit.cmxa graph.cmxa BinSearch.cmx ByteInput.cmx ByteOutput.cmx ListUtil.cmx Stringer.cmx Range.cmx Unicode.cmx CaseFold.cmx EditDistance.cmx SourcePosition.cmx Utf8.cmx Grammar.cmx Failures.cmx Opt.cmx StringUtil.cmx Path.cmx UnicodeCategories.cmx UnicodeSeq.cmx GrammarParser.cmx AnnotationChecker.cmx ArrayUtil.cmx BitBucket.cmx CodeUnit.cmx Conv.cmx DefaultProductions.cmx Encodable.cmx Flatten.cmx Trie.cmx FactorLeft.cmx Followers.cmx Inline.cmx PreSimplify.cmx SymmetricBoolMatrix.cmx TailCallOpt.cmx UnionPartition.cmx Simplifier.cmx FileTestSuite.cmx NumberSystem.cmx Regex.cmx PegParser.cmx ScalarCharValue.cmx TestHarnessWrapper.cmx PegParserTest.cmx -o PegParserTest.native
>  File "_none_", line 1:
>  Error: Files /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmxa
>         and /opt/local/lib/ocaml/unix.cmxa
>         make inconsistent assumptions over implementation Unix
>  Command exited with code 2.
>  Compilation unsuccessful after building 154 targets (153 cached) in 00:00:00.
>  
>  > sudo port selfupdate 
>  --->  Updating MacPorts base sources using rsync
>  MacPorts base version 2.1.2 installed,
>  MacPorts base version 2.1.2 downloaded.
>  --->  Updating the ports tree
>  --->  MacPorts base is already the latest version
>  
>  The ports tree has been updated. To upgrade your installed ports, you should run
>    port upgrade outdated
>  
>  > sudo port upgrade outdated
>  --->  Computing dependencies for automake
>  ELIDED
>  --->  Updating database of binaries: 100.0%
>  --->  Scanning binaries for linking errors: 100.0%
>  --->  No broken files found.
>  
>  > port contents ocaml | grep -i unix.cm
>    /opt/local/lib/ocaml/threads/threadUnix.cmi
>    /opt/local/lib/ocaml/threads/threadUnix.cmx
>    /opt/local/lib/ocaml/unix.cma
>    /opt/local/lib/ocaml/unix.cmi
>    /opt/local/lib/ocaml/unix.cmx
>    /opt/local/lib/ocaml/unix.cmxa
>    /opt/local/lib/ocaml/unix.cmxs
>    /opt/local/lib/ocaml/vmthreads/threadUnix.cmi
>    /opt/local/lib/ocaml/vmthreads/unix.cma
>  
>  > port contents ocaml-ounit | egrep '\.cm'
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cma
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmi
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmx
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmxa
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnit.cmxs
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnitDiff.cmi
>    /opt/local/lib/ocaml/site-lib/oUnit/oUnitDiff.cmx
>  
>  > sudo port -f upgrade ocaml-ounit ocaml
>  Password:
>  --->  Scanning binaries for linking errors: 100.0%
>  --->  No broken files found. 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T06:59:02.873

[去核](http://trac.macports.org/wiki/Migration)解决了这个问题：

> # 重新安装端口
> 
> 要重新安装您的端口：
> 
> 1.  保存已安装端口的列表：
>     
>     
>     
>     已安装端口 -qv > myports.txt
>     
>     
> 2.  卸载所有已安装的端口：
>     
>     
>     
>     sudo port -f 卸载已安装
>     
>     
> 3.  清理任何部分完成的构建：
>     
>     
>     
>     sudo 端口全部清除
>     
>     
> 4.  浏览 myports.txt 并一一安装您实际想要使用的端口（而不是那些仅需要作为依赖项的端口），记住指定适当的变体：
>     
>     
>     
>     sudo port install portname +variant1 +variant2 ...</p>
>     
>     
> 
> 请注意，如果您指定了非默认变体，您可能需要以不同于 myports.txt 中记录的字母顺序的顺序安装端口。

# javascript - Javascript onclick对象依赖方法

> ID：14014868
> 
> 赞同：1
> 
> 时间：2012-12-23T21:31:35.260
> 
> 标签：javascript, object, methods, onclick

我得到了一个切换 onclick 功能的图像。调用的函数是对象的方法。我的问题：我不知道对象的名称，所以我怎么能

初始 HTML 代码：

```
<img id="someID" [...] onClick="someObject.aFunction();" /> 
```

想要的结果：

```
<img id="someID" [...] onClick="someObject.otherFunction();" /> 
```

我当前的 Javascript（解决方法）：

```
someClass.prototype.aFunction() = function() {
    button = document.getElementByID('someID');
    button.setAttribute("onclick", button.getAttribute('onclick').split('.')[0]+'.otherFunction()');
} 
```

不是很好，但它暂时有效。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:39:55.370

这是一种可能的解决方案：

```
var el = document.getElementById('someID');
el.onclick = function(){  
     // or some other prop
     if(el.hasBeenClicked)
         function1();
     else
         function2();

     // toggle the selected state
     el.hasBeenClicked= !el.hasBeenClicked;
} 
```

当然，有很多（更好的）解决方案。
如果你使用 jquery，那么代码应该被翻译成类似这样的东西：

```
$('#someID').toggle(function1, function2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:09:06.990

你可以试试这个

```
someObject.doFunction = function() {
    if (this.currentFunction == this.aFunction)
        this.currentFunction = this.otherFunction;
    else
        this.currentFunction = this.aFunction;
    this.currentFunction();
}

function h() { someObject.doFunction()}

var el = document.getElementById('someID');
if (el.attachEvent) {
    el.attachEvent("onclick", h);
} else {
    el.addEventListener("click", h, false); 
} 
```

# php - utf-8 mimeheader, PHP mail() 在“From:”字段中添加@domain

> ID：14014869
> 
> 赞同：2
> 
> 时间：2012-12-23T21:31:48.130
> 
> 标签：php, email, utf-8, email-headers

我使用 PHP 的 mail() 函数发送电子邮件。我需要将 from 字段编码为 UTF-8，因此我设置了这些邮件标头：

```
function mail_headers($from, $contentType = "text/plain") {
    $headers = "From: ".mime_header_encode($from)."\n";
    $headers .= 'Reply-To: '.mime_header_encode($from)."\n";
    $headers .= 'MIME-Version: 1.0' ."\n";
    $headers .= 'Content-Type: '.$contentType.'; charset=utf-8' ."\n";
    $headers .= 'Content-Transfer-Encoding: 8bit'. "\n";

    return $headers;
}

function mime_header_encode($text, $encoding = "utf-8") {
    return "=?$encoding?Q?" . imap_8bit($text) . "?=";
} 
```

它在我的 PC 上运行良好，但在生产服务器上不太好。它不会将编码字符串识别`=?utf-8?Q?Website name <info@myshop.com>?=`为有效的电子邮件，因此它会尝试使其变得更好。服务器最终将发送一封带有这部分标题的电子邮件：

```
From: =?utf-8?Q?Website name <info@myshop.com>,
  ?=@hosting-domain.com 
```

使用此标头，电子邮件收件人会看到另一个奇怪的发件人（逗号后的字符串）。我可以让 PHP 不触摸我的电子邮件字符串吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:04:33.550

php 函数[mb_encode_mimeheader()](http://php.net/manual/de/function.mb-encode-mimeheader.php)旨在根据 php.ini 指令“mbstring.internal_encoding”对 mime 标头进行编码。如果只是使用`mb_encode_mimeheader()`没有帮助，您应该检查该指令的正确设置。

您还应该阅读我链接的网站上的评论。这也可能有帮助。

# java - 权限被拒绝导致“由于 APK 文件无效而导致安装失败”

> ID：14014871
> 
> 赞同：2
> 
> 时间：2012-12-23T21:32:01.920
> 
> 标签：java, android, adb

当我尝试在运行 4.2.1 的 Nexus 4 上运行我的应用程序时，我在 Eclipse 中不断收到此错误：

```
[2012-12-22 19:30:51 - Rhiokai] Installation failed due to invalid APK file!
[2012-12-22 19:30:51 - Rhiokai] Please check logcat output for more details.
[2012-12-22 19:30:51 - Rhiokai] Launch canceled! 
```

我厌倦了通过 adb 推送和安装，但它也不起作用。我发现这是因为 Logcat 中的这条消息：

```
12-22 19:37:29.326: W/zipro(7371): Unable to open zip '/data/local/tmp/Rhiokai.apk': Permission denied
12-22 19:37:29.326: D/asset(7371): failed to open Zip archive '/data/local/tmp/Rhiokai.apk' 
```

有关如何解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-15T07:42:52.043

在我的手机生根后，我开始收到这个错误。

“权限被拒绝”的原因是上传到 /data/local/tmp 的 apk 文件具有 -rw----- 权限并由 root 拥有，并且安装程序进程显然没有读取任何此类文件的权限。

我从来没有找到解决方案，但有一个让我满意的解决方法。我只是将 tmp 目录移动/符号链接到 SD 卡。由于 SD 卡被格式化为 FAT，它没有所有者/权限，并且在那里创建的所有文件始终可供所有人读取。

```
# cd /data/local
# mv tmp tmp-old # (or simply rm -rf tmp)
# mkdir /mnt/sdcard/tmp
# ln -s /mnt/sdcard/tmp ./tmp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T23:44:47.713

烦人的是，关掉手机再打开的古老技巧再次奏效

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-23T21:43:09.143

如果您的设备上已经有应用程序的签名版本且具有相同的包名称，则可能需要在重新安装之前将其卸载（除非您想再次对其进行签名，然后将该签名的应用程序上传到设备）。

# c++ - OpenMP 原子 _mm_add_pd

> ID：14014874
> 
> 赞同：2
> 
> 时间：2012-12-23T21:32:25.837
> 
> 标签：c++, openmp, intrinsics

我正在尝试使用 OpenMP 将已经矢量化的代码与内在函数进行并行化，但问题是我使用一个 XMM 寄存器作为外部“变量”，我会增加每个循环。现在我正在使用该`shared`子句

```
__m128d xmm0 = _mm_setzero_pd();
__declspec(align(16)) double res[2];

#pragma omp parallel for shared(xmm0)
for (int i = 0; i < len; i++)
{
    __m128d xmm7 = ... result of some operations

    xmm0 = _mm_add_pd(xmm0, xmm7);
}

_mm_store_pd(res, xmm0);
double final_result = res[0] + res[1]; 
```

因为`atomic`不支持操作（在VS2010中）

```
__m128d xmm0 = _mm_setzero_pd();
__declspec(align(16)) double res[2];

#pragma omp parallel for
for (int i = 0; i < len; i++)
{
    __m128d xmm7 = ... result of some operations

    #pragma omp atomic
    xmm0 = _mm_add_pd(xmm0, xmm7);
}

_mm_store_pd(res, xmm0);
double final_result = res[0] + res[1]; 
```

有谁知道一个聪明的解决方法？

* * *

编辑：我刚刚也尝试过使用并行模式库：

```
__declspec(align(16)) double res[2];
combinable<__m128d> xmm0_comb([](){return _mm_setzero_pd();});

parallel_for(0, len, 1, [&xmm0_comb, ...](int i)
{
    __m128d xmm7 = ... result of some operations

    __m128d& xmm0 = xmm0_comb.local();
    xmm0 = _mm_add_pd(xmm0, xmm7);
});

__m128d xmm0 = xmm0_comb.combine([](__m128d a, __m128d b){return _mm_add_pd(a, b);});
_mm_store_pd(res, xmm0);
double final_result = res[0] + res[1]; 
```

但结果令人失望。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T22:17:22.927

你以错误的方式解决问题。您应该使用归约而不是原子操作：

这是一个更好的方法：

```
double sum = 0;

#pragma omp parallel for reduction(+:sum)
for (int i = 0; i < len; i++)
{
    __m128d xmm7;// = ... result of some operations

    //  Collapse to a "double".
    _declspec(align(16)) double res[2];
    _mm_store_pd(res, xmm7);

    //  Add to reduction variable.
    sum += res[0] + res[1];
}

double final_result = sum; 
```

归约本质上是一种操作，它使用关联操作（例如`+`.

如果您正在减少，请始终尝试使用实际的减少方法。不要试图用原子操作或关键部分来欺骗它。

这样做的原因是原子/关键部分方法本质上是不可扩展的，因为它们保持长的关键路径数据依赖性。一个适当的减少方法可以减少这个关键路径`log(# of threads)`。

当然，唯一的缺点是它破坏了浮点关联性。如果这很重要，那么您基本上会坚持按顺序总结每次迭代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T22:29:25.253

您正在寻找的是减少。如果您的编译器支持它（gcc 支持），您可以将其作为 omp 减少，或者您可以通过将每个线程的私有 xmm 相加来自己滚动。下面是一个简单的版本：

```
#include <emmintrin.h>
#include <omp.h>
#include <stdio.h>

int main(int argc, char **argv) {

    const int NTHREADS=8;
    const int len=100;

    __m128d xmm0[NTHREADS];
    __m128d xmmreduction = _mm_setzero_pd();
    #pragma omp parallel for num_threads(NTHREADS)
    for (int i=0; i<NTHREADS; i++)
        xmm0[i]= _mm_setzero_pd();

    __attribute((aligned(16))) double res[2];

    #pragma omp parallel num_threads(NTHREADS) reduction(+:xmmreduction)
    {
        int tid = omp_get_thread_num();
        #pragma omp for
        for (int i = 0; i < len; i++)
        {
            double d = (double)i;
            __m128d xmm7 = _mm_set_pd( d, 2.*d );

            xmm0[tid] = _mm_add_pd(xmm0[tid], xmm7);
            xmmreduction = _mm_add_pd(xmmreduction, xmm7);
        }
    }

    for (int i=1; i<NTHREADS; i++)
        xmm0[0] = _mm_add_pd(xmm0[0], xmm0[i]);

    _mm_store_pd(res, xmm0[0]);
    double final_result = res[0] + res[1];

    printf("Expected result   = %f\n", 3.0*(len-1)*(len)/2);
    printf("Calculated result = %lf\n", final_result);

    _mm_store_pd(res, xmmreduction);
    final_result = res[0] + res[1];

    printf("Calculated result (reduction) = %lf\n", final_result);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T23:01:01.167

在回答我问题的人的大力帮助下，我想出了这个：

```
double final_result = 0.0;

#pragma omp parallel reduction(+:final_result)
{
    __declspec(align(16)) double r[2];
    __m128d xmm0 = _mm_setzero_pd();

    #pragma omp for
    for (int i = 0; i < len; i++)
    {
        __m128d xmm7 = ... result of some operations

        xmm0 = _mm_add_pd(xmm0, xmm7);
    }
    _mm_store_pd(r, xmm0);
    final_result += r[0] + r[1];
} 
```

它基本上将崩溃和还原分开，表现非常好。

非常感谢所有帮助过我的人！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T21:45:02.777

我猜您不能将自己的内在函数添加到编译器中，并且 MS 编译器决定跳过内联汇编程序。不确定是否有一个简单的解决方案。

# wordpress - Wordpress paginate_links 不显示帖子总数？

> ID：14014875
> 
> 赞同：1
> 
> 时间：2012-12-23T21:32:45.290
> 
> 标签：wordpress, pagination

我的首页上有两个循环，它们都使用分页 - 我已经设法找到代码来让它工作，粘贴在下面。是否可以让 paginate_links 不显示我的帖子总数？目前它看起来像：**1、2、3...526。接下来**。我更喜欢：**1, 2, 3... Next**。

当前代码：

```
 // Courtesy of Boone Gorges

            $paged1 = isset( $_GET['paged1'] ) ? (int) $_GET['paged1'] : 1;
            $paged2 = isset( $_GET['paged2'] ) ? (int) $_GET['paged2'] : 1;

            // Custom Loop with Pagination 1
            // http://codex.wordpress.org/Class_Reference/WP_Query#Usage
            $args1 = array(
                'paged'          => $paged1, // http://codex.wordpress.org/Class_Reference/WP_Query#Pagination_Parameters
                'posts_per_page' => 1,
                'category_name'  => 'wod'
            );
            $query1 = new WP_Query( $args1 );

            while ( $query1->have_posts() ) : $query1->the_post();
                echo '<h4>';
                the_date();
                echo '</h4>';
                the_content();
                echo '<hr>';
            endwhile;

            // http://codex.wordpress.org/Function_Reference/paginate_links
            $pag_args1 = array(
                'format'   => '?paged1=%#%',
                'current'  => $paged1,
                'total'    => $query1->max_num_pages,
        'show_all' => False,
                'add_args' => array( 'paged2' => $paged2 ),
        'prev_text' => 'Next',  
            'next_text' => 'Prev'
            );
            echo paginate_links( $pag_args1 );
        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-25T08:24:54.253

我刚刚解决了同样的问题。方法如下：

1) 使用数组类型获取分页

```
$pagination = paginate_links(array(
    ....
    'type' => 'array',
)); 
```

2）从数组中删除倒数第二项

```
unset($pagination[sizeof($pagination)-2]); 
```

3）从数组构建列表

```
echo '<ul>';
foreach ($pagination as $pag)
{
  echo '<li>';
  echo $pag;
  echo '</li>';
}
echo '</ul>'; 
```

# jquery - .slideUp() 将鼠标悬停在除特定 div 之外的任何其他内容上时

> ID：14014881
> 
> 赞同：0
> 
> 时间：2012-12-23T21:34:03.780
> 
> 标签：jquery, css, jquery-hover

我目前有这段代码：

```
$(".usericon").hover(function () {
   if ($(".profile").is(":hidden")) {
   $(".profile").slideDown('slow');
   }
   }); 
```

当前正在向下滑动 .profile div，同时将鼠标悬停在 .usericon 上（但仅当它被隐藏时）

我想做的是，当我将鼠标悬停在 .profile 上时，什么也没有发生……但是当我将鼠标悬停在 .profile 以外的任何其他位置时，它会向上滑动。

我将如何实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:40:23.803

为此，您需要在配置文件或用户图标上方时停止鼠标事件冒泡，并在悬停主体时关闭 div。

这是一些示例代码：

```
$(".usericon").mouseover( function (event) {
    event.stopPropagation();
    if ($(".profile").is(":hidden")) {
        $(".profile").slideDown('slow');
    }
});

$('.profile').mouseover( function (event) {
    event.stopPropagation();
});

$('body').mouseover( function () {
    if ($(".profile").not(":hidden")) {
        $(".profile").slideUp('slow');
    }
}); 
```

# ajax - Yii ajaxSubmitButton 更新选项和验证

> ID：14014884
> 
> 赞同：0
> 
> 时间：2012-12-23T21:34:20.317
> 
> 标签：ajax, validation, yii

我有一个带有*validateOnSubmit*选项的活动表单。表单有 ajaxSubmitButton：

```
CHtml::ajaxSubmitButton('Next', '', array('update' => '#answer-form') 
```

问题是，该表单在没有验证结果的情况下更新。做对的最好方法是什么？像这样的东西：

```
CHtml::ajaxSubmitButton('Дальше', '', array('valid' => '#answer-form') 
```

# ios - Ray Wenderlich 的 Mapkit 教程中的 SIGABRT

> ID：14014885
> 
> 赞同：0
> 
> 时间：2012-12-23T21:34:40.270
> 
> 标签：ios, objective-c, iphone, ios6

所以我跟随 Ray Wenderlich 的 Mapkit 教程在[这里](http://www.raywenderlich.com/21365/introduction-to-mapkit-in-ios-6-tutorial)找到。我被困在我应该使用该`plotCrimePositions`方法在地图上绘制犯罪的部分。使用调试器，我已将其范围缩小到我正在创建`NSDictionary* root`但似乎无法找到错误的位置。任何帮助将不胜感激。[这是相关文件的要点。](https://gist.github.com/4366279)

谢谢！

编辑：这是我的控制台日志：

```
2012-12-23 16:31:52.925 MapTutorial[8993:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'data parameter is nil'
*** First throw call stack:
(0x1850012 0x1645e7e 0x184fdeb 0x117a817 0x34697 0x35153 0x1659705 0x590920 0x7ccb24 0x1659705 0x590920 0x5908b8 0x651671 0x651bcf 0x650d38 0x5c033f 0x5c0552 0x59e3aa 0x58fcf8 0x223bdf9 0x223bad0 0x17c5bf5 0x17c5962 0x17f6bb6 0x17f5f44 0x17f5e1b 0x223a7e3 0x223a668 0x58d65c 0x341cd 0x2945)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:43:49.320

你的问题在这里：

```
- (IBAction)refreshTapped:(id)sender{
    //...
    [request startAsynchronous]; //Start the request
    [self plotCrimePositions:request.responseData]; //Assume there's data, 
    //despite the request not even have been given a chance to start
} 
```

因为您假设您`request`将同步执行，然后`plotCrimePositions:`在完成时执行，所以您假设请求获得的数据不为零（显然不是这种情况），这导致 MapKit 翻转。如果您`[self plotCrimePositions:request.responseData];`进入您指定的完成处理程序的范围，它应该像一个魅力一样工作。异步请求是异步的：意味着它们会立即返回，这就是为什么完成块是如此的天赐之物。

# javascript - Javascript - Uncaught SyntaxError: Unexpected token Javascript： jQuery(document).ready(function() { jQuery('#submit').click(function() { jQuery("#LoadingImage").show(); var imgSr 问问题 问问题 2012-12-23T21:34:52.580 5152 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Javascript： jQuery(document).ready(function() { jQuery('#submit').click(function() { jQuery("#LoadingImage").show(); var imgSrc = 'http://foo.com/gen.php?username1=' + jQuery('input[name=username1]').val() + '&username2='+ jQuery('input[name=username2]').val(); jQuery('#imgRESULT').html('![](' + imgSrc + ')'); }); $('#image1').on("load", (function() { $("#LoadingImage").hide(); }); }); 随着html是<div align="center" id="imgRESULT"> 并使用正确的输入等。 但是进入控制台我得到： (Uncaught SyntaxError: Unexpected token <) 我似乎看不到如何让这个脚本工作。有输入吗？ 尝试这个： If txtUserName.Text.Trim() Like "Adm_?" Then javascriptjquery 4 1 回答 1 This answer is useful 3 V--------------extra parenthesis $('#image1').on("load", (function() { $("#LoadingImage").hide(); }); <---extra parenthesis }); 需要是： $('#image1').on("load", function() { $("#LoadingImage").hide(); }); 在函数语句之前有一个额外的括号。还把 jQuery() 换成了 $() 以供外观。 于 2012-12-23T21:39:44.513 回答 Related 1 c++ - 是否有 Windows 提供的函数来获取 C++ 中 Windows Phone 8 上的文件扩展名？ 0 android - 设置 GPS 并等待启用 2 php - 如何使用 mod_rewrite 类似 ln -s Unix 创建虚拟文件夹 3 java - 将 char 数组列存储到字符串中以进行比较 0 java - JDO - Google Web 应用程序中的 java.lang.NoClassDefFoundError 1 apache - RewriteRule 在 httpd.conf 中不起作用 1 javascript - iframe 内容更改后的 jquery 事件 3 javascript - Javascript在选择时将值生成到表单文本框中 4 java - 关于 ActionBarSherlock 将项目导入 Android Studio 的问题 1 objective-c - Obj-C：将属性委托给实例变量？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14014886
> 
> 赞同：0
> 
> 时间：
> 
> 标签：javascript, jquery

Javascript：

```
jQuery(document).ready(function() {
    jQuery('#submit').click(function() {         

        jQuery("#LoadingImage").show();

        var imgSrc = 'http://foo.com/gen.php?username1=' + jQuery('input[name=username1]').val() + '&amp;username2='+ jQuery('input[name=username2]').val();

        jQuery('#imgRESULT').html('<img id="image1" src="' + imgSrc + '" >');
    });

    $('#image1').on("load", (function() {
        $("#LoadingImage").hide();
    });
}); 
```

随着html是

```
<div id="LoadingImage" style="display: none">
<img src.... /></div>​&lt;div align="center" id="imgRESULT"></div> 
```

并使用正确的输入等。

但是进入控制台我得到：

![错误](../Images/fe7719a3864f30d2d56fb979efbbdeb6.png)

(Uncaught SyntaxError: Unexpected token <)

我似乎看不到如何让这个脚本工作。有输入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:39:44.513

```
 V--------------extra parenthesis
$('#image1').on("load", (function() {
    $("#LoadingImage").hide(); }); <---extra parenthesis
}); 
```

需要是：

```
$('#image1').on("load", function() {
    $("#LoadingImage").hide();
}); 
```

在函数语句之前有一个额外的括号。还把 jQuery() 换成了 $() 以供外观。

# php - PHP重定向由于某种原因不起作用

> ID：14014892
> 
> 赞同：0
> 
> 时间：2012-12-23T21:35:46.587
> 
> 标签：php

我试图在数据库中成功更新后立即将此 PHP 页面重定向到另一个页面.. 但是我收到 PHP 的警告并且没有任何反应.. 下面是代码.. 我哪里出错了？

```
<html> <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<link rel="stylesheet" type="text/css" href="css/madscore.css">
</head>
<body>

<?php
require('../database/connect.php');
?>
<?php

$id = $_POST["id"]; 
$value = $_POST["score"];
  database_connect();
$query = "update people set Score= Score +".$value." WHERE ID ='".$id."'";
$result = $connection->query($query);

if($result)
  {
?>
<?php
@header("Location: http://www.europe-zone.com/");
exit();
}

?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T21:37:32.767

您应该在 HTML 页面之前发送标题。将您的重定向代码放在前面

```
<html> <head> 
```

关于[这个](http://php.net/manual/en/function.header.php)：

> 请记住，必须在发送任何实际输出之前调用 header()，无论是通过普通 HTML 标记、文件中的空白行还是从 PHP 发送。使用 include 或 require 函数或其他文件访问函数读取代码并在调用 header() 之前输出空格或空行是一个非常常见的错误。使用单个 PHP/HTML 文件时也存在同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:39:12.083

```
<?php
require('../database/connect.php');

$id = $_POST["id"]; 
$value = $_POST["score"];
  database_connect();
$query = "update people set Score= Score +".$value." WHERE ID ='".$id."'";
$result = $connection->query($query);

if($result)
  {
?>
<?php
@header("Location: http://www.europe-zone.com/");
exit();
}

?>
    <html> <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<link rel="stylesheet" type="text/css" href="css/madscore.css">
</head>
<body>
</body>
</html> 
```

# c# - 在 VS2010 中调试导致性能滞后

> ID：14014893
> 
> 赞同：1
> 
> 时间：2012-12-23T21:35:56.390
> 
> 标签：c#, visual-studio-2010

[VS2010 性能问题](https://stackoverflow.com/questions/4129889/vs2010-performance-differences-when-debugging-profiling)

我在调试时遇到了 Visual Studio 产生延迟的问题。问题发生在我写的游戏中，当你射击时它会产生大约一秒钟的延迟。更奇怪的是，我之前写过这个相同的程序并且不存在滞后，在我的新程序中几乎没有什么改变。

最奇怪的是，当我做一个性能分析时，它突然变得很棒。如果您进入解决方案目录并直接启动调试或发布版本，则同上。有谁知道为什么会这样？在问题解决之前，我无法处理我的游戏。:(

电脑规格：

操作系统：Windows 7 家庭高级版 64 位

CPU：英特尔酷睿 i5 3570K

内存：8.00 GB 双通道 DDR3 @ 665MHz (9-9-9-24)

主板：华擎 H61M-HVS

视觉工作室：

版本：终极 SP1

扩展：Resharper、.Net Demon、VS10X Code Map、FxCopRunner、Indent Guides、Power Commands、Productivity Power Tools。

编辑：这个问题发生在我用来解析 XML 文件的一些代码上。问题是我过度使用了 try-catch 并造成了相当大的延迟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T05:44:28.353

如果您的代码抛出许多被捕获的异常，与 VS2008 (.NET 3.5) 相比，VS2010+ (.NET 4) 的调试速度会非常慢。这是已知问题。

当调试对异常测试很重的单元测试时，这更有可能发生。

# jquery-plugins - 返回顶部链接，动态创建，带滚动

> ID：14014898
> 
> 赞同：0
> 
> 时间：2012-12-23T21:36:51.827
> 
> 标签：jquery-plugins, dynamic, scroll, hyperlink

**概括：**

我需要在每个 <div class="wrapSection"> 之后插入一个“返回顶部”链接。我已经成功使用以下内容：

```
<script>
$('.wrapSection').after('
    <div class="backToTop clearfix">
       <a href="#top" class="up">Back To Top </a>
    </div>
 ');
</script> 
```

但是，我想在单击“返回顶部”时使用平滑滚动。考虑到这一点，我尝试了以下方法：

```
<script>
$('.wrapSection').after('
<div class="backToTop clearfix">
    <a href="javascript:void(0)" onclick="goToByScroll('top')" class="up">
      Back To Top
    </a>
</div>
');
</script> 
```

那是行不通的。作为一个 jQuery 菜鸟，我做了看起来合乎逻辑的事情，这似乎永远不是正确的答案。

**简而言之**

或多或少，我需要在每个 <div class="wrapSection"> 之后动态显示它：

```
<div class="backToTop">
    <a class="top" href="javascript:void(0)" onclick="goToByScroll('top')">
        Back to Top
    </a>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:57:55.430

这是我想出的解决方案：

```
​$(document).ready(function() {
    // Markup to add each time - just give the element a class to attach an event to
    var top_html = '<div class="backToTop"><a href="#" class="top">Back To Top</a></div>';
    $(".wrapSection").after(top_html);

    // Use event delegation (see http://api.jquery.com/on/)
    $("body").on("click", ".top", function(e) {
        e.preventDefault();
        $("html,body").animate({ scrollTop: 0 }, "slow");
    });
});​ 
```

您可以在这里尝试 jsFiddle：http: [//jsfiddle.net/F9pDw/](http://jsfiddle.net/F9pDw/)

# android - Android 构建 JSON 对象

> ID：14014906
> 
> 赞同：0
> 
> 时间：2012-12-23T21:38:06.800
> 
> 标签：android, json

我试图向传递给此函数的 JSONObject 添加一个值。问题是，当我尝试使用密钥添加它时，它不会被包含在内。当我打印出它的字符串表示时，不包括标识符键。

该功能的其余部分正常工作。if 语句被执行并且标识符有一个值。它不为空。我很欣赏任何想法。

```
 public String issueWebRequest(String path, JSONObject array, boolean boolIdentifier){

    HttpClient client = new DefaultHttpClient();
    HttpPost post = new HttpPost(url);

    try {
        if(boolIdentifier){
            array.put("identifier", identifier);
        }
        StringEntity se = new StringEntity(array.toString()); 
```

# git - 重置对先前提交的更改，而不创建新的提交

> ID：14014915
> 
> 赞同：1
> 
> 时间：2012-12-23T21:39:11.733
> 
> 标签：git, github

1.  我提交了我的更改，并开始开发一个新功能。
2.  我意识到我把事情搞砸了
3.  需要恢复到之前的提交。

我做了什么。

```
git add .
git commit -m "Screwed Up"
git branch -m experiment
git checkout 62b5 (SHA1 of previous commit)
git checkout -b master
git branch -D experiment 
```

我认为必须有更好的方法来恢复之前的提交。

当我尝试时`git reset HEAD`，它仍然会显示未提交的更改，而当我这样做时`git status`。

如果有更好的方法来做到这一点，它是什么？还是我应该使用不同的工作流程来避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:42:58.903

您可以`git reset --hard`恢复到之前的提交。

`--hard`将重置索引和工作树。自上次提交以来对工作树中跟踪文件的任何更改都将被丢弃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T22:06:35.323

**`reset --hard`如果可能，不要这样做。如果您有未跟踪或未暂存的更改，则它是可撤消的。**采用

```
git stash -u 
```

为了安全。您将再次获得一个干净的工作目录。如果您错误地丢弃了更改，您始终可以通过 git stash 命令取回它们。

隐藏的更改不会被推高，因此它不会弄乱其他存储库上的任何内容/膨胀其他存储库，但会给您一些安全网。因此，如果您重新克隆，您将丢失您的藏匿处。因此，重新克隆以解决您的 repo 问题也是一个坏主意 - 您还可能丢失您的 rerere 记录、reflog 等。

# url - URL 屏蔽/转发/重定向

> ID：14014920
> 
> 赞同：2
> 
> 时间：2012-12-23T21:39:34.873
> 
> 标签：url, redirect, dns, forwarding, masking

我有一个托管在 000webhost 上的网站，并从 1and1 购买了付费域。1and1 提供使用 HTTP 或帧重定向的 URL 重定向，但我选择将付费域指向 000webhosts 名称服务器。

目前，当我在 (www.paiddomain.co.uk) 中输入付费域时，它会将我指向正确的网站 (www.freedomain.com)。一旦在此页面上，任何被点击的页面都会在地址栏中显示为 www.freedomain.com/link，而我想要它显示为 www.paiddomain.com/link。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:07:04.430

使用 .htaccess 文件中的 RedirectRule ：

示例 - 从 www.freedomain.com/link 重定向到 www.paiddomain.com/link：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !www.freedomain.com/link$ [NC]
RewriteRule ^(.*)$ http://www.paiddomain.com/link/$1 [L,R=301] 
```

[更多信息](https://my.bluehost.com/cgi/help/htaccess_redirect#newsite)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:26:09.810

## 术语

*   源服务器 - 提供原始内容的服务器
*   代理服务器 - 位于客户端和源服务器之间的服务器

在您的情况下，源服务器是 freedomain.com。听起来您选择退出代理服务器，只是让 DNS 指向源服务器。

## 原因

第一个页面加载正常，因为它可以被两个域访问。但是，交付的 HTML 内容具有指向源服务器的绝对链接。因此，当客户端单击它时，它们会被直接带到源服务器。

## 如果没有代理服务器，您有两种选择

1.  获取源服务器以生成指向所需域的绝对链接。
2.  获取源服务器以生成相对链接。

这取决于您的页面是如何生成的（静态 html、drupal、wordpress、自定义应用程序）。但最终效果是您的链接将像这样生成：

```
<a href="http://www.paiddomain.com/link">absolute URL</a> 
```

或像这样：

```
<a href="/link">relative URL</a> 
```

如果您的网站使用 cookie，您还需要为正确的域生成它们。

对于生成绝对 URL 的系统，它们通常会在其配置或数据库中存储“站点 url”、“基本 url”或类似的变量。

## 使用代理服务器

您可以要求您的代理服务器将链接（和 cookie 等）`freedomain.com`从`paiddomain.com`. 这取决于代理服务器，在 apache 中您将使用`ProxyPassReverse`.

1and1 显然不愿意成为您的代理服务器： http: [//faq.1and1.com/domains/domain_admin/domain_dest/3.html](http://faq.1and1.com/domains/domain_admin/domain_dest/3.html) 他们愿意提供框架（可收藏性差），或 HTTP 重定向（更改 URL） .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-23T01:36:22.320

在使用 1and1 提供的帧重定向时，我遇到了同样的问题。我的页面具有指向外部站点的绝对 URL，当单击它们时，它们会在标题栏中加载一个带有我的 1and1 域的空白页面。

Chrome 输出了这个错误：

```
'absolute link to external site' in a frame because it set 'X-Frame-Options' to 'sameorigin'. 
```

结果是，当我单击浏览器试图在添加到我的页面的框架 1and1 中打开它们的链接时。解决方案是将目标属性添加到我的链接并将其设置为 _top。这会导致链接在当前窗口/选项卡中完全打开并忽略框架。

```
<a href="absolute link to external site" target="_top"> </a> 
```

# java - 如何设置“绝对”区域梯度？

> ID：14014925
> 
> 赞同：0
> 
> 时间：2012-12-23T21:40:08.857
> 
> 标签：java, android, teechart

见下图。渐变画错了，垂直的黑线很丑。

1.  如何创建从`min`到的渐变`max`？例如，如果我有一个从 0 到 100 的刻度，我希望我的区域使用这些 0..100 梯度值中的 N 个。
2.  如何去除垂直的黑线？

![渐变不好](../Images/f05b40554bf444ebed4b19945086f2df.png)

**更新：**提供的答案有效，除了我得到这个工件：

![神器](../Images/61f0ff64d4409760fdba86df4336e393.png)

**更新 2：**这仅在使用 ONE 时发生`LinearLayout`，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/chart_layout"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="3dip" >

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

然后`TChart`添加到`chart_layout`. 砰！偏移错误:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T16:11:56.630

> 如何创建从最小到最大的渐变？例如，如果我有一个从 0 到 100 的刻度，我希望我的区域使用这些 0..100 梯度值中的 N 个。
> 
> 我希望渐变从最小值渐变到最大值（在这种情况下为 0 到 100）。所以在上图中，80 处的点将具有第 80 种渐变颜色（几乎是绿色）。50 处的点将具有第 50 种渐变颜色（黄色）。我相信你需要一个新的渐变类型：SYMMETRICRECTGRADIENT

区域系列在下一个之前绘制线段，以及每个线段下方的区域以及这些线段中的每一个。这就是为什么 Area 系列不能绘制均匀渐变的原因。但是，其他版本的 TeeChart 具有 GradientRelative，当它设置为 false 时，它​​会执行您请求的操作。我已将在 Java 版本 (TJ71016477) 中实现此属性（以及相关函数）的可能性添加到愿望清单中。

同时，您可以使用 SeriesBand 工具来执行此操作。这是一个例子：

```
 tChart1.getAspect().setView3D(false);
    tChart1.getLegend().setVisible(false);

    Area area1 = new Area(tChart1.getChart());
    area1.fillSampleValues();
    area1.setOrigin(0);
    area1.setUseOrigin(true);
    area1.getAreaLines().setVisible(false);

    area1.getGradient().setVisible(false);
    area1.setColor(Color.transparent);

    SeriesBand band1 = new SeriesBand(tChart1.getChart());
    band1.setSeries(area1);
    band1.getGradient().setVisible(true);
    band1.getGradient().setDirection(GradientDirection.VERTICAL);
    band1.getGradient().setStartColor(Color.green);
    band1.getGradient().setMiddleColor(Color.yellow);
    band1.getGradient().setUseMiddle(true);
    band1.getGradient().setEndColor(Color.red); 
```

这就是我通过上面的代码得到的：

![使用 SeriesBand 工具显示均匀渐变的区域](../Images/f0f7206f69d265005f2d73b26a2786a8.png)

**更新：**我已经重现了奇怪的工件问题。我已添加到愿望清单以进行进一步调查（TJ71016541）。与此同时，`LinearLayout`只为图表使用一秒钟似乎工作正常。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="3dip" >

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <Spinner
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <LinearLayout 
        android:id="@+id/chart_layout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" />
</LinearLayout> 
```

正如评论中所说，另一种解决方法是隐藏区域线并使 SeriesBand 笔可见：

```
area1.getLinePen().setVisible(false);
band1.getPen().setVisible(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T13:56:12.293

**如何创建从最小到最大的渐变？例如，如果我有一个从 0 到 100 的刻度，我希望我的区域使用这些 0..100 梯度值中的 N 个。**

恐怕不可能根据比例使用 0...100 渐变，因此区域的渐变分布在整个区域中，使用开始、中间和结束颜色来绘制渐变。

**如何去除垂直的黑线？**

要删除垂直黑线，您只需将区域线设置为 false。

我希望会有所帮助。

谢谢，

# java - 我无法在 GUI 上实现图像

> ID：14014930
> 
> 赞同：3
> 
> 时间：2012-12-23T21:41:29.167
> 
> 标签：java, image, swing, user-interface, embedded-resource

我正在使用 eclipse，我想将图像添加到我的 GUI 的标签或徽标上。

我希望它看起来像这样！

![http://imageshack.us/a/img593/4957/skeletancalcimage.png](../Images/aabc2e104df72a335c64a4873b8d339f.png)

我把它上传到网上是因为我没有 10 声望。

（**名称很酷的程序**）是图像

```
 import java.awt.*;
    import javax.swing.*;
    import javax.swing.JFrame;

    public class MainClass extends JFrame{ // super class JFrame

        // Kind of a tutorial for creating GUI's in java
        private JLabel label;
        private JLabel label1;
        private JButton button;
        private JTextField textfeild;
        private ImageIcon image1; // image for my logo

        public MainClass () {
            setLayout (new FlowLayout());

            image1 = new ImageIcon (getClass ().getResource ("logo.gif")); // declares image

            label = new JLabel ("This is the label");
            add (label);

            label1 = new JLabel (image1); // adds image
            add (label1);

            textfeild = new JTextField (15);
            add (textfeild);

            button = new JButton ("Click");
            add (button);

        }

        public static void main(String[] args) {        

            MainClass gui = new MainClass ();

            gui.setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE); // creates window
            gui.setSize (300,300);
            gui.setVisible (true);
            gui.pack ();
            gui.setTitle ("Title");

        }

    } 
```

程序编译但不运行。给我

```
Exception in thread "main" java.lang.NullPointerException
    at javax.swing.ImageIcon.<init>(Unknown Source)
    at JonsCalc.<init>(JonsCalc.java:18)
    at JonsCalc.main(JonsCalc.java:38) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T23:50:42.643

这段代码`getClass().getResource ("logo.gif")`意味着应该从与您的类相同的位置加载图像`MainClass`。检查您的图像是否与 MainClass 在同一个包中。如果您使用 Eclipse，则将图像文件放入包中的`src`文件夹中，它会`bin`自动复制到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T01:47:57.907

我建议您专门为您的图像/图标创建一个包，然后在那里创建一个名为“ImageLoader”或任何您想要的加载器类。然后，您可以使用此代码...

```
new ImageLoader().getClass().getResource("NAME_OF_IMAGE")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T04:15:20.100

右键单击您的班级，然后转到新班级。单击新的源文件夹。最后将您的图像移动到该文件夹​​中。现在您可以使用该代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-17T00:02:26.703

如果您使用的是 Eclipse，请将您的图像复制到您的*包*和项目的*bin*文件夹中。然后只需键入 image1 = new ImageIcon(this.getClass().getResource("filename.filetype"));

# django - Django 模板包含一个模板，其中包含一个来自视图的变量

> ID：14014931
> 
> 赞同：0
> 
> 时间：2012-12-23T21:41:48.597
> 
> 标签：django

我对 Django 模板有疑问。我想创建一个基本 html，我将用它来显示帖子。我从视图中调用一个模板，其中包括一个 html 文件，该文件扩展了基本 html。

> **看法**
> 
> ```
> def main(request):
>     all_posts = News.objects.all()
>     return render_to_response("index.html", {'all_posts': all_posts}) 
> ```
> 
> **模板**——index.html

```
<div id="content">
    {% include 'content.html' with posts=all_posts%}
</div> 
```

> **内容.html**

```
{% extends "content_base.html" %}

{% for post in posts %}
    {% block date_of_post %} {{ post.date }} {% endblock %}
    {% block post_author %} {{ post.author }} {% endblock %}
    {% block post %} {{ post.content }} {% endblock %}
{% endfor %} 
```

> **content_base.html**

```
<div class="post">
    <h2 class="title"><a href="#">{% block blabla %}{% endblock %}</a></h2>
    <p class="meta"><span class="date">{% block date_of_post %}{% endblock %}</span><span class="posted">Posted by <a href="#">{% block post_author %}{% endblock %}</a></span></p>
    <div style="clear: both;">&nbsp;</div>
    <div class="entry">
        <p>
            {% block post %} {% endblock %}
        </p>    
        <p class="links">
            <a href="#" class="more">Read More</a>
            <a href="#" title="b0x" class="comments">Comments</a>
        </p>
    </div>
</div> 
```

但似乎我无法将 *all_posts* 变量传递给**content.html**。这里有什么问题？难道我做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T21:48:38.610

您正在使用具有相同名称的块，因为您在循环中使用它们：

```
{% for post in posts %}
    {% block date_of_post %} {{ post.date }} {% endblock %}
    {% block post_author %} {{ post.author }} {% endblock %}
    {% block post %} {{ post.content }} {% endblock %}
{% endfor %} 
```

你不能那样做。看[这里](https://stackoverflow.com/a/6427336/203535)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T21:56:05.407

您应该将循环移动到`index.html`, 并`content_base.html`直接包含。所以 index.html 变成：

```
<div id="content">
    {% for post in posts %}
        {% include 'content_base.html' %}
    {% endfor %}
</div> 
```

和 content_base.html 是

```
<div class="post">
    <h2 class="title"><a href="#">{{ post.title }}</a></h2>
    <p class="meta"><span class="date">{{ post.date }}</span><span class="posted">Posted by <a href="#">{{{ post.author }}</a></span></p>
    <div style="clear: both;">&nbsp;</div>
    <div class="entry">
        <p>
            {{ post.content }}
        </p>    
        <p class="links">
            <a href="#" class="more">Read More</a>
            <a href="#" title="b0x" class="comments">Comments</a>
        </p>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T21:56:36.223

有时过多的标准化并不是那么好。你可以简单地拥有`index.html`并且你的所有代码都可以去那里（避免不必要的块）。

```
<div id="content">
    {% for post in all_posts %}
        <div class="post">
            <h2 class="title"><a href="#">{{post.title}}</a></h2>
            <p class="meta"><span class="date">{{post.date}}</span><span class="posted">Posted by <a href="#">{{post.post_author}}</a></span></p>
            <div style="clear: both;">&nbsp;</div>
            <div class="entry">
                <p>
                    {{post.content}}
                </p>    
                <p class="links">
                    <a href="#" class="more">Read More</a>
                    <a href="#" title="b0x" class="comments">Comments</a>
                </p>
            </div>
        </div>
    {% endfor %}
</div> 
```

# iphone - 像在模拟器中一样在 iOS 设备上显示触摸

> ID：14014932
> 
> 赞同：1
> 
> 时间：2012-12-23T21:41:56.033
> 
> 标签：iphone, ios, ipad, uikit, ios-simulator

出于制作应用程序演示和演示的目的，我想绘制对应于触摸的圆圈，就像在 iOS 模拟器中一样，但在设备本身上。

理想情况下，这将与其他代码正交。也许是一个绘制圆圈并转发事件的 UIView，但事件转发似乎需要其他视图注意：

[http://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MultitouchEvents/MultitouchEvents.html#//apple_ref/doc/uid/TP40009541-CH3-SW17](http://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MultitouchEvents/MultitouchEvents.html#//apple_ref/doc/uid/TP40009541-CH3-SW17)

有没有一种干净的方法可以做到这一点？

（我不能使用模拟器进行演示，因为我的应用程序使用手势、MIDI 和 OpenGL）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T22:03:11.200

有一个框架调用指尖，可通过 cocoapods 获得。

[http://cocoapods.org/?q=on%3Aios%20fingertips](http://cocoapods.org/?q=on%3Aios%20fingertips)

这将满足您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T22:04:04.923

我认为没有一种干净的方法可以做到这一点。但是，这是我会尝试的：

使用[方法调配](http://cocoadev.com/wiki/MethodSwizzling)通过调配方法来连接到所有视图

```
- touchesBegan:withEvent:
– touchesMoved:withEvent:
– touchesEnded:withEvent: 
```

为`UIView`班级。此外，您可能还需要调配`UIGestureRecognizer`子类的一些方法，因为它们可能会阻止调用上面列出的方法。这样您就可以做自己的事情（例如在屏幕上绘制触摸点），也可以让视图像以前一样处理触摸。

# entity-framework - 基于代理的更改跟踪，POCO 对象中的属性未更新

> ID：14014935
> 
> 赞同：1
> 
> 时间：2012-12-23T21:42:47.653
> 
> 标签：entity-framework, ef-code-first, change-tracking

我在我的 ASP.NET MVC 应用程序中使用 EF5 代码优先和基于代理的更改跟踪。我的一个域类包含一个非常频繁更新的数字属性。出于这个原因，这个属性没有使用框架持久化到数据库中：

```
public virtual int CurrentSessions
{
    get
    {
        return _currentSessions;
    } 

    set
    {
        Interlocked.Exchange(ref _currentSessions, value);
    }
} 
```

我面临的问题是属性的值不会跨会话更新。根据内部逻辑，我的 API 控制器要么增加上述值，要么减少它，如下所示：

```
myObj.CurrentSessions++; 
```

或者

```
myObj.CurrentSessions--; 
```

其中 myObj 是在每个会话中通过 LINQ 从上下文中检索的代理对象：

```
var myObj = objectContext.Instances<myPocoEntity>().FirstOrDefault(cb => cb.SomeProp == someValue); 
```

当我在增加/减少 myObj.CurrentSessions 之后检查它的值时，它确实被更新了，但是在下一个服务器请求时，当 myObj 再次被检索时，CurrentSessions 始终具有其初始值，为零。

如何确保在 POCO 实体中更新属性值而不扫描整个上下文以进行更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:13:34.857

如果我正确理解您的问题，您有单独的 DbContext 对象，当一个对象更新一个对象时，另一个对象在下一次请求数据库中的对象之前不会看到更改？

如果是这样，您可以通过 DbEntityEntry 类重新加载有问题的对象。

然后，您可以使用“Reload()”方法或“GetDatabaseValues()”方法来获取数据库中当前存在的值。

例子）

```
// Reload Usage
context.Entry(entity).Reload();

// GetDatabaseValues Usage
DbPropertyValues propertyValues = context.Entry(entity).GetDatabaseValues();
foreach (DbPropertyValue val in propertyValues)
{
    ...
} 
```

# sql - 递归 SQL 查询 - 在查询中使用查询结果

> ID：14014936
> 
> 赞同：1
> 
> 时间：2012-12-23T21:42:52.637
> 
> 标签：sql, sql-server-2012

我正在运行 SQL Server 2012，这就是我需要的：

```
Row      Field1          Field2
 1         0               1
 2         ?               2
 3         ?               -5 
```

我需要一个会逐行抛出的查询。它应该取 row2,field1 并将其设置为等于 row1,field1+row2,field2

然后它将采用 row3,field1 并将其设置为等于 row2,field1+row3,field2

最初，该表在 Field1 中的值都等于 0，因此当我运行查询时，它总是使用 0 作为 field1 值。

任何帮助，将不胜感激。我在想 CTE 将是要走的路，但我只是不知道该去哪里。

编辑：只是为了澄清一些事情，在我的例子中。最初的输入是

```
Row      Field1          Field2
 1         0               1
 2         0               2
 3         0               -5 
```

所需的输出将是：

```
Row      Field1          Field2
 1         1               1
 2         3               2
 3         -2               -5 
```

我的实际表格有点复杂，但我知道如果我能理解如何通过这个例子来实现它，我可以专门应用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:57:54.983

这是你需要的吗？（例如，当您引用 row2,field1 时，不清楚您的意思是更新前还是更新后的值）

```
CREATE TABLE YourTable
  (
     Row    INT,
     Field1 INT NULL,
     Field2 INT
  )

INSERT INTO YourTable
VALUES      (1,0,1),
            (2,0,2),
            (3,0,-5); 
WITH CTE AS
(
SELECT *,
       SUM(Field2) OVER (ORDER BY Row ROWS UNBOUNDED PRECEDING) AS RunningTotal
FROM  YourTable    
)
UPDATE CTE 
SET Field1 = RunningTotal

SELECT *
FROM YourTable 
```

最后结果

```
Row         Field1      Field2
----------- ----------- -----------
1           1           1
2           3           2
3           -2          -5 
```

或者您的单词问题的另一种（更字面的）解释可能是

```
WITH CTE AS
(
SELECT *,
       LAG(Field2) OVER (ORDER BY Row) AS PrevRowField2
FROM  YourTable    
)
UPDATE CTE 
SET Field1 = PrevRowField2 + Field1
WHERE PrevRowField2 IS NOT NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T21:58:02.340

像这样改编自[TSQL A 递归更新的东西？](https://stackoverflow.com/questions/4324720/tsql-a-recursive-update)

```
With cte As (
  Select
    Row, 
    Field1, 
    Field2
  From
    t
  Where
    Row = 1
  Union All
  Select
    t.Row,
    t.Field2 + c.Field1,
    t.Field2
  From
    t
      Inner Join
    cte c
      On t.Row = c.Row + 1
)
Update
  t
Set
  Field1 = c.Field1
From
  t
    inner join
  cte c
    On t.Row = c.Row 
```

[http://sqlfiddle.com/#!6/cf843/1](http://sqlfiddle.com/#!6/cf843/1)

# c# - C# 创建自定义文件扩展名并向其添加资源

> ID：14014945
> 
> 赞同：-1
> 
> 时间：2012-12-23T21:43:57.943
> 
> 标签：c#, file, compression, customization, extension-methods

您好，我正在制作一个使用不同 .wav 文件的应用程序。

我想要的是将这些 wav 压缩到具有自定义扩展名的 .example 文件中，它们使我的应用程序使用这些 wav

这样做的目的是创建 .wav 包，因此当用户加载 .example 文件时，它将加载文件中压缩的 .wav 文件...

因此，如果我加载文件“pack1.bmkv”，它将像我所说的那样加载用它压缩的 .wav 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T21:56:00.610

如果这真的一定是一个DLL，那么你只需要在VS中新建一个Project，并以正常的方式为其分配资源。

然而，一个更好（并且可能更简单）的方法是使用带有自定义扩展名和可能密码的 ZIP 文件。

# apache - 谷歌分析不计算来自 jmeter 的请求

> ID：14014947
> 
> 赞同：2
> 
> 时间：2012-12-23T21:44:12.753
> 
> 标签：apache, google-analytics, jmeter

我正在使用 jmeter 测试我的网站（称为 google anlytics），我的所有响应都正常，我什至可以看到响应数据，但 google anlytics 没有显示任何内容。
这是否意味着我的请求失败了？

这是测试计划

```
 Test Plan 
   Thread Group
       http header Manager
       http cache manager
       Sample Request to my website
   View Results Tree 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:50:15.543

JMeter 不是浏览器，因此它不会在 html 页面中执行 javascript，通常 google 分析调用是：

*   [http://jmeter.apache.org/](http://jmeter.apache.org/)

所以这不是一个真正的问题。

查看您的测试计划，它包含在负载测试期间不正常的元素，因为它们消耗大量资源，例如查看结果树：

*   [http://jmeter.apache.org/usermanual/best-practices.html](http://jmeter.apache.org/usermanual/best-practices.html) (16.6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:17:35.543

In general it is also considered a poor performance practice to include third party items where you do not have direct written permission to test from the site owners. If you do find an error in Google Analytics just who would you report it to and what would be your reconciliation path to ensure that it is fixed prior to your release?

# php - CakePHP 更改 error.log 或 debug.log 文件名

> ID：14014948
> 
> 赞同：0
> 
> 时间：2012-12-23T21:44:13.257
> 
> 标签：php, cakephp, cakephp-2.0

通过更改[/Cake/Log/Engine/Filelog.php](http://api20.cakephp.org/view_source/file-log#line-58)的写入功能，我可以更改“error.log”和“debug.log”文件名。

有没有办法在不破解 CakePHP 2 核心文件的情况下更改这些文件名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-12T19:39:52.343

从 CakePHP 2.4.0 开始，添加了此功能：http: [//bakery.cakephp.org/articles/markstory/2013/08/30/cakephp_2_4_0_is_ready](http://bakery.cakephp.org/articles/markstory/2013/08/30/cakephp_2_4_0_is_ready)

> FileLogs 现在可以配置最大大小和简单的旋转。

[Filelog](http://api.cakephp.org/2.4/class-FileLog.html)类具有文件大小限制和要旋转的文件数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T22:23:54.210

在您上面的评论中，您说您想要更改这些日志文件的名称的原因是因为有问题的文件没有大小限制。问题是：如果你有一个 2MB 大小的错误日志，那么你显然有更大的鱼要炸。据我所知，如果不破解内核，就无法更改这些文件名。如果您真的担心这两个日志文件的大小，那么您***可以***设置一个 cronjob 每 24 小时检查这两个文件的大小。如果日志文件大小大于您设置的预定限制，您可以向自己发送警报电子邮件。老实说：最好的方法是事先对您的应用程序进行广泛的测试，以便这两个文件中的任何条目都成为一个惊喜而不是例行公事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T12:31:02.230

没有内置配置可以得到你想要的。但是您可以轻松地制作扩展`FileLog`和覆盖相关函数并使用它的自定义记录器类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-16T11:52:57.483

在 cake 3 中，您可以在 /config/app.php 中轻松设置旋转配置

```
'Log' => [
     'error' => [
          'className' => 'Cake\Log\Engine\FileLog',
          'rotate'=>2,
           //other config 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-20T05:43:23.007

在 CakePHP 2 中，您可以在 /app/config/bootstrap.php 中更改相同的配置：

```
CakeLog::config('debug', array(
    'engine' => 'File',
    'types' => array('notice', 'info', 'debug'),
    'file' => 'debug',
));
CakeLog::config('error', array(
    'engine' => 'File',`enter code here`
    'types' => array('warning', 'error', 'critical', 'alert', 'emergency'),
    'file' => 'error',
)); 
```

# kendo-ui - 如何在 Kendo UI TabStrip 中默认预加载所有选项卡

> ID：14014952
> 
> 赞同：0
> 
> 时间：2012-12-23T21:44:35.383
> 
> 标签：kendo-ui

我正在使用 Kendo UI 中的 TabsStrip 控件。

我有两个动态标签。目前，只有第一个选项卡会自动加载，第二个选项卡会在单击时加载。我希望它们都被加载，以便当我单击第二个时，内容已经加载。

我没有找到任何api方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T07:15:13.720

页面加载时应该使用TabStrip的**[reload方法](http://docs.kendoui.com/api/web/tabstrip#reload)**

```
var lastItem = $('#tabstrip .k-item:last');//load just the last
$('#tabstrip').data().kendoTabStrip.reload(lastItem); 
```

或者，您可以遍历所有 $('#tabstrip .k-item') 项目并在最初需要加载所有项目时加载它们。

# python - Kivy：如何更改窗口大小？

> ID：14014955
> 
> 赞同：49
> 
> 时间：2012-12-23T21:45:26.860
> 
> 标签：python, kivy

我开始使用 编写程序[`kivy`](http://kivy.org/#home)，但我在理解它如何处理大小时遇到​​了一些问题。

例如：

```
import kivy
kivy.require('1.5.1')

from kivy.app import App
from kivy.uix.button import Button

class MyApp(App):
    def build(self): return Button(text='Some text')

MyApp().run() 
```

上面的程序有效，但它创建了一个**巨大**的窗口。尝试设置`size=(100, 100)`不会改变任何东西。设置`size_hint=(None, None)`将显示一个大小正确的按钮，但它随机放置在一个*仍然*很大的窗口内。尝试设置大小`MyApp`也不会改变任何东西。

如何创建一个与按钮大小相同的窗口？这应该是一个足够简单的任务，但是查看文档和示例我找不到任何关于此的内容。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2015-05-19T17:21:40.370

目前有两种方式：

*   在创建窗口之前：

    ```
    import kivy
    kivy.require('1.9.0')

    from kivy.config import Config
    Config.set('graphics', 'width', '200')
    Config.set('graphics', 'height', '200') 
    ```

*   创建窗口后动态：

    ```
    from kivy.core.window import Window
    Window.size = (300, 100) 
    ```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2018-08-12T13:06:35.000

用这个：

```
from kivy.core.window import Window
Window.size = (300, 100) 
```

如果你使用

```
from kivy.config import Config
Config.set('graphics', 'width', '200')
Config.set('graphics', 'height', '200')
Config.write() 
```

这将导致默认屏幕尺寸的丢失！默认屏幕尺寸非常有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-12-09T11:56:32.453

我会评论马丁的回答，但我没有声誉。设置配置文件时，请务必“写入”您的更改：

```
from kivy.config import Config
Config.set('graphics', 'width', '200')
Config.set('graphics', 'height', '200')
Config.write() 
```

这就像将信息提交到数据库一样，如果您对此有所了解的话。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-01-03T05:06:32.653

使用`Config.write()`会将您的更改设置为默认设置。如果您不小心运行此程​​序并想要恢复更改，您可以使用`Config.write()`默认值再次运行（因此恢复您的更改），或者您可以使用文本编辑器打开`$HOME/.kivy/config.ini`并编辑它。

# android - Android活动，完成（）会杀死我的倒计时线程吗？

> ID：14014956
> 
> 赞同：1
> 
> 时间：2012-12-23T21:45:40.683
> 
> 标签：android, service, android-activity, lifecycle, countdowntimer

我的活动启动了一个倒计时线程，如果完成，该线程还将尝试更新 UI 线程

活动本身可能会`finish()`在倒计时结束之前完成。如果活动进行，倒数计时器也会消失吗？

如果是这样，我可能需要在服务中运行倒数计时器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:53:48.457

不一定会。只要进程没有被杀死，你的线程就会存在。即使您没有前台活动，该进程也不会立即被操作系统杀死。没有他们只会增加被杀死的可能性。

从您的线程引用 Activity 也可能导致增加应用程序的内存占用，因为您的 Activity 不会被垃圾收集，因为您的线程仍然指向它。在这种情况下，您应该考虑（至少）使用弱引用。

最后，鉴于您的目的是让您的倒计时时间处于活动状态，即使您的应用程序在后台，您应该考虑将其移至服务中。

# git - 我应该为 git user.name 使用什么？

> ID：14014964
> 
> 赞同：11
> 
> 时间：2012-12-23T21:47:00.673
> 
> 标签：git, github

我对 Git 很陌生，以前从未使用过任何 VCS。我刚刚开了一个 GitHub 帐户。我从阅读 GitHub 帮助页面开始。我在本地 Windows 机器上下载并安装了 Git。从那里，我被引导到 Pro Git 书。在初始设置期间，我使用了正确的法定名称。

我最近读了很多关于 Git 和 GitHub 的文章，以至于我不记得我在哪里读到了什么。我以为我在某处（但现在找不到）读到了一些东西，说我应该使用我的 GitHub*用户名*作为我的 Git *user.name*。所以现在我不知道该怎么办。

我读过[这个 Pro Git 页面](http://git-scm.com/book/en/Getting-Started-First-Time-Git-Setup)，上面写着：

> $ git config --global user.name "John Doe"

我读过[这个 GitHub 页面](https://help.github.com/articles/set-up-git)，上面写着：

> $ git config --global user.name "你的名字在这里"

第一个暗示应该使用他们的专有名称，第二个不清楚。不过 GitHub 页面也有以下说法：

> 我们使用电子邮件地址将您的提交与您的 GitHub 帐户相关联。

我从中得到的是，如果我希望我的提交链接到我的 GitHub 帐户，那么*user.email很重要。*由于它没有说明名称，我想也许没关系。

那么我应该为我的 Git *user.name*使用什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-23T21:49:30.500

您可以使用正确的名称、用户名或任何您想要的 user.name 标识符。它将与您的电子邮件地址、提交消息和各种其他详细信息一起记录在每次提交中。而且您对 GitHub 如何使用电子邮件地址是完全正确的。祝你好运！使用 Pro Git，您走在了正确的轨道上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:49:52.103

电子邮件有“user.email”。我两者都用，他们都登录了提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T21:57:51.923

正如该领域所说，将其用作您的名字。您可以在*user.email*设置键中设置您的电子邮件。Github 还使用电子邮件来显示来自 Gravatar 服务的全局头像图像。我更喜欢在全局配置中设置我的全名/电子邮件，但您也可以设置项目特定的配置。默认情况下，您的所有存储库都将使用全局设置（例如“John Doe”），除非您使用本地设置（例如 toxalot）明确覆盖它。

# encoding - 更改文本文件编码不会影响文本

> ID：14014966
> 
> 赞同：0
> 
> 时间：2012-12-23T21:47:55.057
> 
> 标签：encoding, character-encoding, notepad++, notepad

我试图将 ANSI 文件 (àìà ìùîåø) 的编码更改为 UTF8。我设法在传球中做到了这一点。

现在，当我尝试做同样的事情时，编码设置正在改变，但奇怪的字符没有改变，似乎没有任何效果。我尝试过使用notepad++ notepad2 notepad3等任何好的编辑器，但没有成功。我认为问题出在我的机器上。

会是什么呢？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-16T11:44:16.917

如果您有 Microsoft Office 2003 打开 Word 复制文本并选择它，然后转到工具 -> 修复损坏的文本并选择您的语言。这会将文本转换回其原始状态

# c# - 无法检查数组是否为空

> ID：14014969
> 
> 赞同：3
> 
> 时间：2012-12-23T21:48:36.923
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我的 asp.net mvc 应用程序中有以下操作方法：-

```
 public ActionResult CustomersDetails(long[] SelectRight)
        {

            if (SelectRight == null)
            {
                ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists see your system administrator.");
                RedirectToAction("Index");
            }
            else
            {
                var selectedCustomers = new SelectedCustomers
                {
                    Info = SelectRight.Select(GetAccount)
                };

                return View(selectedCustomers);
            }
            return View();
        } 
```

但是如果它`SelectRight Array`是空的，那么它将绕过`if (SelectRight == null)`检查，它将呈现 CustomerDetails 视图并在视图内的以下代码上引发异常

```
@foreach (var item in Model.Info) {
    <tr> 
```

那么我怎样才能使空检查正常工作呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-23T21:53:17.457

您必须**返回**.`RedirectToAction(..)`

```
 public ActionResult CustomersDetails(long[] SelectRight)
 {
      if (SelectRight == null)
      {
           ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists see your system administrator.");
           return RedirectToAction("Index");
      }
      else
      {
           '... 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-23T21:51:33.087

您可以将条件更改为以下条件：

```
...
if (SelectRight == null || SelectRight.Length == 0)
... 
```

那应该有帮助。

**编辑**

关于上面的代码需要注意的重要一点是，在 c# 中，or 运算符`||`是短路的。它看到数组为空（语句为真）并且不尝试评估第二条语句 ( `SelectRight.Length == 0`)，因此不会抛出 NPE。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-23T21:51:39.530

您可以检查它是否不为空，并且长度不为零。

```
if (SelectRight == null || SelectRight.Length == 0) {
    ModelState.AddModelError("", "Unable to save changes...");
    return RedirectToAction("Index");
} 
```

上面的 if 语句将捕获空值和空数组。

# ruby - Ruby Koans about_array_assignment - 非并行与并行分配歧视

> ID：14014971
> 
> 赞同：5
> 
> 时间：2012-12-23T21:48:47.903
> 
> 标签：ruby, arrays

通过 ruby​​koans.com 我在 about_array_assignment.rb 中遇到了这两段代码

你怎么知道第一个是非并行赋值，第二个是一个变量的并行赋值？对我来说，除了命名差异之外，代码看起来几乎相同。

```
 4   def test_non_parallel_assignment
  5     names = ["John", "Smith"]
  6     assert_equal ["John", "Smith"], names
  7   end

 45   def test_parallel_assignment_with_one_variable
 46     first_name, = ["John", "Smith"]
 47     assert_equal 'John', first_name
 48   end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-23T21:53:10.643

在第二个示例中，变量后面有一个逗号。并行赋值通常列出几个逗号分隔的变量，但只允许使用一个变量（但这仍然需要逗号以便将其与常规赋值分开）。

# android - 安卓启动配置

> ID：14014973
> 
> 赞同：1
> 
> 时间：2012-12-23T21:48:53.183
> 
> 标签：android, android-widget

当我运行小部件应用程序时，出现这样的错误：

> 启动配置 CharUtilsPerfRun 引用不存在的项目 BioInfo。

我能为它做些什么？你有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T09:31:31.460

右键单击您的项目。

单击构建路径>>配置构建路径。

进入 Java 构建路径 >> 项目。

从那里删除任何不相关的项目。

然后清理 + 构建您的项目并运行它。

# asp.net - Gridview 显示重复值

> ID：14014980
> 
> 赞同：0
> 
> 时间：2012-12-23T21:49:52.760
> 
> 标签：asp.net, visual-studio-2010, grid

我有一个用户信息表，其中包含

```
First name 
last name
... 
```

当我将数据从源获取到数据集中时。它将网格中的重复值显示为：

```
First Name Last Name .... First Name Last Name.... 
```

代码如下：

实用程序类

```
public DataSet GetMember()
        {

            using (SqlConnection con = new SqlConnection(connectionString))
            {
                using (SqlCommand cnn = new SqlCommand("selectmember", con))
                {
                    cnn.CommandType = CommandType.StoredProcedure;

                    using(DataSet ds=new DataSet())
                    {
                       try
                       {
                        con.Open();
                        cnn.ExecuteNonQuery();
                        SqlDataAdapter da = new SqlDataAdapter(cnn);
                        da.Fill(ds);

                        }

                       catch (Exception e)
                       {
                       }
                       return ds;
                    }
                }
            }
        } 
```

成员.aspx

```
 public void binddata()
        {
            DataSet ds = new DataSet();
            ds = utility.GetMember();
            GdMember.DataSource = ds;
            GdMember.DataBind();
        } 
```

我是否缺少任何代码或我正在做任何错误。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T21:56:57.120

很可能您的网格有明确的列模板，但同时您忘记将 AutoGenerateColumns 设置为 false。因此，第一组列来自模板，第二组是由网格根据数据集的结构自动生成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T00:22:09.853

就像@WiktorZychla 提到的那样，尝试设置`AutoGenerateColumns="false"`

```
<asp:GridView AutoGenerateColumns="false" ...>
</asp:GridView> 
```

# haskell - 两个函子的组合是函子

> ID：14014982
> 
> 赞同：10
> 
> 时间：2012-12-23T21:50:02.277
> 
> 标签：haskell, functor, category-theory

在[之前的回答](https://stackoverflow.com/a/13939606/546084)中，Petr Pudlak`CFunctor`为除从*Hask*到*Hask*的函子之外的函子定义了该类。使用类型族重新编写它，它看起来像

```
class CFunctor f where
  type Dom f :: * -> * -> *               -- domain category
  type Cod f :: * -> * -> *               -- codomain category
  cmap :: Dom f a b -> Cod f (f a) (f b)  -- map morphisms across categories 
```

看起来像的实例，例如

```
instance CFunctor Maybe where
  type Dom Maybe = (->)                   -- domain is Hask
  type Cod Maybe = (->)                   -- codomain is also Hask 
  cmap f = \m -> case m of
                   Nothing -> Nothing
                   Just x  -> Just (f x) 
```

在范畴论中，只要*F : C --> D*是函子且*G : D --> E*是函子，则组合*GF : C --> E*也是函子。

我想用 Haskell 来表达这一点。因为我不会写`instance CFunctor (f . g)`，所以我介绍一个包装类：

```
newtype Wrap g f a = Wrap { unWrap :: g (f a) } 
```

在写这个`CFunctor`实例时，我得到了

```
instance (CFunctor f, CFunctor g, Cod f ~ Dom g) => CFunctor (Wrap g f) where
  type Dom (Wrap g f) = Dom f
  type Cod (Wrap g f) = Cod g
  cmap = undefined 
```

但我无法弄清楚`cmap`应该是什么。有什么建议吗？

**PS**这一切的最终原因是还引入了一个`Adjunction`带有方法的类`unit`and `counit`，然后自动从附属词中派生monad实例。但首先，我需要向编译器展示两个仿函数的组合也是一个仿函数。

我知道我可以`cmap.cmap`在类型的对象上使用`g (f a)`它并且会起作用，但这看起来有点像作弊 - 当然函子只是一个函子，编译器不必知道它实际上是两个的组合其他函子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T00:10:25.493

给定函子`F : C → D`and `G : D → E`，函子组合`G ∘ F : C → E`是类别`C`and之间的对象的映射`E`，这样`(G ∘ F)(X) = G(F(X))`以及态射之间的映射，这样`(G ∘ F)(f) = G(F(f))`。

这表明您的`CFunctor`实例应定义如下：

```
instance (CFunctor f, CFunctor g, Cod f ~ Dom g) => CFunctor (Wrap g f) where
  type Dom (Wrap g f) = Dom f
  type Cod (Wrap g f) = Cod g
  cmap f = cmap (cmap f) 
```

然而，组合`cmap`两次给你`Dom f a b -> Cod g (g (f a)) (g (f b))`，`cmap`在这种情况下有一个 type `Dom f a b -> Cod g (Wrap g f a) (Wrap g f b)`。

我们可以从`g (f a)`to得到，`Wrap g f`反之亦然，但是由于实例声明没有对 的结构做出任何假设`Cod g`，所以我们不走运。

因为我们知道函子是类别之间的映射，我们可以使用事实`Cod g`是 a `Category`（在 Haskell 方面，这需要一个`Category (Cod g)`约束），这给了我们很少的操作：

```
cmap f = lift? unWrap >>> cmap (cmap f) >>> lift? Wrap 
```

然而，这需要一个方便的提升操作符`lift?`，它将函数从一个`Hask`类别提升到另一个`Cod g`类别。写`Cod g`为`(~>)`，类型`lift?`必须是：

```
lift? :: (a -> b) -> (a ~> b)

lift? unWrap  :: Wrap g f a ~> g (f a)
cmap (cmap f) :: g (f a)    ~> g (f b)
lift? Wrap    :: g (f b)    ~> Wrap g f b

lift? unWrap >>> cmap (cmap f) >>> lift? Wrap :: Wrap g f a ~> Wrap g f b 
```

现在，这个起重操作员至少有两种选择：

*   您可以将约束从 扩大`Category (Cod g)`到`Arrow (Cod g)`在这种情况下，起重操作员变为`arr`，
*   `Wrap`或者，正如 Sjoerd Visscher 在评论中提到的那样，您可以在运行时使用and`unWrap`在语义上是这样的事实`id`，在这种情况下使用 of`unsafeCoerce`是合理的。

# cursor - 动态文本字段上的光标无法跟踪

> ID：14014984
> 
> 赞同：0
> 
> 时间：2012-12-23T21:50:15.990
> 
> 标签：cursor, movieclip

我有一个问题，我不知道该怎么做，虽然答案必须很明显..

我有一个movieclip，在movieclip 中有一个动态文本字段。当我的光标在其中时，我想移动移动剪辑，但问题是文本字段的区域不被识别为动画剪辑的一部分，尽管它在其中。这会导致当光标触及文本字段区域时动画剪辑停止。有什么建议么？:(

# java - java.lang.AbstractMethodError: org.apache.xerces.dom.ElementImpl.getTextContent()Ljava/lang/String

> ID：14014989
> 
> 赞同：10
> 
> 时间：2012-12-23T21:52:04.573
> 
> 标签：java, ajax, jsf, jboss, omnifaces

我正在使用 Omnifaces 1.3 + Primefaces 3.4.1 + Jboss 7.1.1 Final 但是当异常通过 ajax 请求来时，我无法重定向`FullAjaxExceptionHandler`我配置的异常。`web.xml`什么都没有发生，只是另一个例外：

```
19:38:05,467 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/taxMileage].[Faces Servlet]] (http--0.0.0.0-8181-4) Servlet.service() for servlet Faces Servlet threw exception: java.lang.AbstractMethodError: org.apache.xerces.dom.ElementImpl.getTextContent()Ljava/lang/String;
    at org.omnifaces.config.WebXml.parseErrorPageLocations(WebXml.java:216) [omnifaces-1.3.jar:1.3]
    at org.omnifaces.config.WebXml.<init>(WebXml.java:84) [omnifaces-1.3.jar:1.3]
    at org.omnifaces.config.WebXml.<clinit>(WebXml.java:53) [omnifaces-1.3.jar:1.3]
    at org.omnifaces.exceptionhandler.FullAjaxExceptionHandler.handleAjaxException(FullAjaxExceptionHandler.java:162) [omnifaces-1.3.jar:1.3]
    at org.omnifaces.exceptionhandler.FullAjaxExceptionHandler.handle(FullAjaxExceptionHandler.java:145) [omnifaces-1.3.jar:1.3]
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) [jsf-impl-2.1.7-jbossorg-2.jar:] 
```

有人可以给我一个提示吗？我被困住了。如果我在没有 ajax 的情况下调用相同的错误，则会正确重定向异常。

我的`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    id="WebApp_ID" version="3.0"
>
    <display-name>taxMileage</display-name>
    <welcome-file-list>
        <welcome-file>/pages/protected/user/dashboard.xhtml</welcome-file>
    </welcome-file-list>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet>
        <servlet-name>InitializeApplication</servlet-name>
        <servlet-class>com.taxMileage.server.util.InitializeApplication</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <context-param>
        <param-name>primefaces.THEME</param-name>
        <param-value>south-street</param-value>
    </context-param>
    <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping>
    <filter>
        <filter-name>facesExceptionFilter</filter-name>
        <filter-class>org.omnifaces.filter.FacesExceptionFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>facesExceptionFilter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping>

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
        <url-pattern>*.jsf</url-pattern>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>javax.ws.rs.core.Application</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>

    <!-- -->

    <!-- Protected area definition -->
    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Restricted Area - ADMIN Only</web-resource-name>
            <url-pattern>/pages/protected/admin/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>ADMIN</role-name>
        </auth-constraint>
    </security-constraint>
    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Restricted Area - USER and ADMIN</web-resource-name>
            <url-pattern>/pages/protected/user/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>USER</role-name>
            <role-name>ADMIN</role-name>
        </auth-constraint>
    </security-constraint>
    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Secured resources</web-resource-name>
            <url-pattern>/rest/*</url-pattern>
        </web-resource-collection>
        <user-data-constraint>
            <transport-guarantee>NONE</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <!-- Login page -->
    <login-config>
        <auth-method>FORM</auth-method>
        <form-login-config>
            <form-login-page>/pages/public/login.xhtml</form-login-page>
            <form-error-page>/pages/public/loginError.xhtml</form-error-page>
        </form-login-config>
    </login-config>

    <!-- System roles -->
    <security-role>
        <role-name>ADMIN</role-name>
    </security-role>
    <security-role>
        <role-name>USER</role-name>
    </security-role>

    <error-page>
        <exception-type>java.lang.RuntimeException</exception-type>
        <location>/pages/error/error1.xhtml</location>
    </error-page>
</web-app> 
```

我的`faces-config.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_1.xsd"
    version="2.1">

    <lifecycle>
        <phase-listener>com.taxMileage.server.util.MultiPageMessagesSupport</phase-listener>
    </lifecycle>

    <factory>
        <exception-handler-factory>org.omnifaces.exceptionhandler.FullAjaxExceptionHandlerFactory</exception-handler-factory>
    </factory>

    <application>
        <resource-bundle>
            <base-name>messages</base-name>
            <var>msgs</var>
        </resource-bundle>
    </application>
</faces-config> 
```

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-24T02:37:20.980

> java.lang.AbstractMethodError: org.apache.xerces.dom.ElementImpl.getTextContent()Ljava/lang/String;

`/WEB-INF/lib`当您的 WAR （甚至 JRE ）中存在 Xerces JAR 文件时，会发生这种情况，该文件的`/lib`版本比 servletcontainer 内部使用的版本旧。显然实现了[Java 1.4.2或更早版本的 JAXP 的旧版本缺少在](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html)[Java 1.5](http://docs.oracle.com/javase/5/docs/api/org/w3c/dom/Node.html#getTextContent%28%29)的 JAXP 中引入的上述方法。

有2个选项：

1.  将 Xerces JAR 文件升级到至少与使用 servletcontainer 的版本匹配的新版本。

2.  从`/WEB-INF/lib`. 他们实际上不属于那里。servletcontainer 带有它自己的 JAXP 实现。你不需要通过 webapp 提供你自己的。

推荐选项 2。使用 Maven 等依赖管理框架时要小心。即使 API 已经是 Java SE 的一部分，一些糟糕的库也会特别包含 JAXP 实现作为传递依赖项。

请注意，具体问题与 OmniFaces 无关。它只是由类路径污染引起的。OmniFaces 使用 JAXP 解析`web.xml`(and `web-fragment.xml`) 并提取错误页面位置。**更新**：自 OmniFaces 2.0 以来，不应再发生此*特定异常，因为它已根据*[问题 90](https://github.com/omnifaces/omnifaces/issues/90)`getTextContent()`将调用替换为`getFirstChild().getNodeValue()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-05T18:01:08.290

我在独立应用程序中遇到了类似的错误（即不使用 Omnifaces 1.3 + Primefaces 3.4.1 + Jboss 7.1.1）。我将以下内容添加到我的 pom.xml 文件中，它为我解决了这个问题。

```
<!-- https://mvnrepository.com/artifact/xerces/xerces -->
<dependency>
    <groupId>xerces</groupId>
    <artifactId>xerces</artifactId>
    <version>2.4.0</version>
</dependency>

<!-- https://mvnrepository.com/artifact/xerces/xercesImpl -->
<dependency>
    <groupId>xerces</groupId>
    <artifactId>xercesImpl</artifactId>
    <version>2.12.0</version>
</dependency> 
```

# c# - WPF 网格上的列边距

> ID：14014995
> 
> 赞同：1
> 
> 时间：2012-12-23T21:52:38.797
> 
> 标签：c#, wpf, xaml, grid

我创建了一个网格。在这个网格上，我有两个带有两个 TextBlock 的列我想在我的列之间插入一个空格，以便在我的 textBlocks 之间留出空间。

这是怎么做的？

这是我的代码：

```
 <ListBox x:Name="ListBoxTiers" HorizontalContentAlignment="Stretch" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0"> 
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                <Grid Margin="10" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />                                           
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" x:Name="TxtBox_CodeTiers" TextWrapping="Wrap" Text="{Binding m_strCode}"  HorizontalAlignment="Stretch" VerticalAlignment="Top" />
                                    <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TxtBox_NomTiers" TextWrapping="Wrap" Text="{Binding m_strNom}"   HorizontalAlignment="Stretch" VerticalAlignment="Top" />
                                </Grid>
                            </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox> 
```

非常感谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:59:32.410

不要使用列，而是在文本框周围设置一个边距。

```
<TextBox Margin="10"> 
```

您可以单独设置每一侧或设置左/右和上/下：

```
<TextBox Margin="10, 3, 7, 0">
<TextBox Margin="10, 5"> 
```

或者将您的 TextBoxes 包装在另一个面板中并在那里设置边距：

```
<Grid Margin="10">
    <TextBox />
    <TextBox />
</Grid> 
```