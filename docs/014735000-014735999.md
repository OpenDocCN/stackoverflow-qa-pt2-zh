# StackOverflow 问答 14735000-14735999

# python - 忽略 subprocess.Popen 的输出

> ID：14735001
> 
> 赞同：11
> 
> 时间：2013-02-06T17:19:07.067
> 
> 标签：python, subprocess

我正在从我的 Python 脚本中调用一个 java 程序，它输出了很多我不想要的无用信息。我已经尝试添加`stdout=None`到 Popen 函数：

```
subprocess.Popen(['java', '-jar', 'foo.jar'], stdout=None) 
```

但它也是一样的。任何的想法？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-06T18:32:50.953

从[3.3 文档](http://docs.python.org/3/library/subprocess.html#frequently-used-arguments)：

> stdin、stdout 和 stderr 分别指定执行程序的标准输入、标准输出和标准错误文件句柄。有效值为 PIPE、DEVNULL、现有文件描述符（正整数）、现有文件对象和无。

所以：

```
subprocess.check_call(['java', '-jar', 'foo.jar'], stdout=subprocess.DEVNULL) 
```

这仅存在于 3.3 及更高版本中。但是文档说：

> DEVNULL 表示将使用特殊文件 os.devnull。

并且`os.devnull`可以追溯到 2.4（之前`subprocess`存在）。因此，您可以手动执行相同的操作：

```
with open(os.devnull, 'w') as devnull:
    subprocess.check_call(['java', '-jar', 'foo.jar'], stdout=devnull) 
```

请注意，如果您正在做一些不适合一行的更复杂的事情，您需要`devnull`在对象的整个生命周期内保持打开状态`Popen`，而不仅仅是它的构造。（也就是说，将整个内容放在`with`语句中。）

重定向到`/dev/null`(POSIX) 或`NUL:`(Windows) 的优点是您不会创建不必要的管道，更重要的是，不会遇到子进程在写入该管道时阻塞的极端情况。

缺点是，理论上，`subprocess`可能在某些平台上`os.devnull`不起作用。如果您只关心 POSIX 和 Windows、PyPy 和 Jython（大多数人）上的 CPython，那么这永远不会成为问题。对于其他情况，请在分发代码之前进行测试。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T17:20:34.493

从[文档](http://docs.python.org/2/library/subprocess.html#frequently-used-arguments)中：

> 使用默认设置`None`，不会发生重定向。

您需要设置`stdout`为`subprocess.PIPE`，然后调用`.communicate()`并忽略捕获的输出。

```
p = subprocess.Popen(['java', '-jar', 'foo.jar'], stdout=subprocess.PIPE)
p.communicate() 
```

虽然我怀疑使用`subprocess.call()`超过您的需求就足够了：

```
subprocess.call(['java', '-jar', 'foo.jar'], stdout=subprocess.PIPE) 
```

# c# - 如何使用 OpenNETCF.IO.Ports 写入 Zebra QL220？

> ID：14735005
> 
> 赞同：1
> 
> 时间：2013-02-06T17:19:22.937
> 
> 标签：c#, serial-port, compact-framework, windows-ce, zebra-printers

下面的“SerialPort”来自 OpenNETCF.IO.Ports。

这个第一次通过/半成熟的猜测对于打印到带式打印机 (Zebra QL220) 是否有意义？也就是说，这是一个不错的起点吗？

```
using (SerialPort serialPort = new SerialPort()) 
{
    string someString = "Bla";
    //serialPort.BaudRate = // I don't know what to put here yet, assuming this is needed
    //serialPort.DataBits = // " "
    //serialPort.Parity = // " "
    //serialPort.StopBits = // " "
    serialPort.PortName = "COM1"; // Is this what it wants?

    serialPort.Open();

    Thread.Sleep(2500); // I don't know why this is needed, or is it?

    serialPort.Write(" ! U1 setvar \"device.languages\" \"line_print\"\r\n");
    serialPort.Write(" ! U SETLP 5 1 46\r\nPAGE-WIDTH 480\r\nSETBOLD 2\r\nPRINT\r\n");          
    serialPort.Write(" ! U1 CENTER\r\n"+someString"\r\n! U1 SETBOLD 0\r\n");
    serialPort.Write(" ! U1 CENTER\r\n");
    serialPort.Write(" ! U1 SETLP 0 2 24");

    serialPort.Close();
} 
```

你可能会说，“你为什么不试试看呢？” 但目前，至少，这是一个漫长的过程，因为我无法在我的 XP Mode VM 中的部署“设备”或模拟器上运行我的应用程序（请参阅[如何从 Visual 中运行我的 Windows CE 项目工作室（2003）？](https://stackoverflow.com/questions/14714163/how-can-i-run-my-windows-ce-project-from-within-visual-studio-2003)如果有兴趣）；我需要做的是将二进制文件复制到手持设备以测试任何修改过的代码；所以，我宁愿在经历那个繁琐的过程之前有点确定它会以某种方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T13:00:42.763

是的，这大致就是您想要做的。您需要检查打印机 docos 以了解所需的通信设置。它通常是 19200,N,8,1。对于某些打印机，您需要调整发送数据的速度。发送数据的速度可能会超过打印机上的串行数据缓冲区。我记得，例如，必须每发送 512 个字节添加一个小延迟，否则打印流的尾端会丢失。虽然不确定打印机型号，所以这只是需要注意的事情。

# c# - 在 biztalk 管道组件中获取模式信息

> ID：14735007
> 
> 赞同：2
> 
> 时间：2013-02-06T17:19:27.570
> 
> 标签：c#, biztalk, biztalk-2010

早上好，我有兴趣编写一个知道它正在解码的文档模式的管道组件。我看到有一个函数可以获取组件内的架构信息：

```
IDocumentSpec spec = pContext.GetDocumentSpecByType("name-of-your-schema"); 
```

您可以访问在管道中分配的文档架构名称吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:09:50.733

您可以像这样从消息的上下文中获取它：

```
private static readonly PropertyBase SchemaStrongNameProperty = new BTS.SchemaStrongName();
private static readonly PropertyBase MessageTypeProperty = new BTS.MessageType();

public IBaseMessage Execute(IPipelineContext pContext, IBaseMessage pInMsg)
{
    // Get by schema strong name (.NET type)
    string schemaStrongName = pInMsg.Context.Read(SchemaStrongNameProperty.Name.Name, SchemaStrongNameProperty.Name.Namespace) as string;
    pContext.GetDocumentSpecByName(schemaStrongName);

    // Get by message type (XML NS#Root Node)
    string messageType = pInMsg.Context.Read(MessageTypeProperty.Name.Name, MessageTypeProperty.Name.Namespace) as string;
    pContext.GetDocumentSpecByType(messageType);

    // Rest of your pipeline component's code...
} 
```

# macos - 将 UNIX 应用程序移植到 MAC OS X

> ID：14735008
> 
> 赞同：0
> 
> 时间：2013-02-06T17:19:27.777
> 
> 标签：macos, unix, porting, kvm, fink

我是从事学术项目的学生 - '**将 KVM 移植到 MAC OS X** '。我收集了很多关于 KVM、MAC OS X 等的文献，但是，我仍然不清楚如何进行。我查看了 Apple 的开发者网站，其中列出了移植过程中要做的一百件事。我不明白为什么 Mac 以 UNIX 为核心，需要对源代码进行大量更改才能使其运行。另外，我听说**Fink**（还有**macports**）是一个工具，使用它我可以将任何 Unix 应用程序移植到 Mac OS X。这是真的吗？我查看了 Fink 的网站，在那里我没有找到任何表明我可以使用 Fink 作为移植工具的详细信息。我所看到的只有**Fink**（还有**macports**) 是一个包管理系统，它有几个 linux 应用程序，并且只能在 Mac 上运行这些应用程序。KVM 不在列表中。所以，我再次感到困惑。请建议我，如何去做？只需一步。苹果社区建议的方式是唯一的方式吗？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:23:16.943

我相信你看错了方向。

[KVM](http://www.linux-kvm.org/page/Main_Page) *不是*应用程序。[QEMU](http://www.qemu.org)是 KVM 的标准用户界面，主要是前端。KVM 的主要部分位于 Linux 内核中。您必须为 OS X 提供等效的内核代码。

这是与应用程序移植完全不同的野兽。在操作系统的内核中没有像 POSIX 这样的标准——甚至不能保证同一内核的不同版本之间的内部接口兼容性。Linux 和 OS X 内核即使在它们的基本设计上也完全不同，因为 OS X 使用基于[Mach 的](http://en.wikipedia.org/wiki/Mach_kernel)内核。

您将必须了解这两个内核的工作原理并找出您需要进行的更改。根据两个内核的不同，您的任务甚至可能相当于完全重新实现 KVM。您还需要具体了解虚拟化是如何在现代 CPU 上实现的，并且很可能不仅仅是关于汇编和各种低级计算机细节的知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:07:47.623

如果您找到具有您正在寻找的功能的东西，它不会是 KVM 的一个端口。

你要抽象的层次在mac上甚至都不存在，底层都是不同的......

（近似）

门楣->
BIOS：引导加载程序：LINUX_KERNEL：初始化

Macintel->
UEFI：MACH_MICROKERNEL：BSD_STUFF：LAUNCHD

两者都是 POSIX，您可能期望更多的基础是相同的，但实际上它们都是不同的......

# gcc - 你如何让 gcc 的 __builtin_frame_address 与 -O2 一起工作？

> ID：14735010
> 
> 赞同：6
> 
> 时间：2013-02-06T17:19:43.810
> 
> 标签：gcc

如果我在没有 -O 参数的情况下编译附加代码，则它可以正常工作。但是，如果我使用 -O2 编译它，则无法在回溯中打印出中间函数。最初，我认为一切都已优化，因此我在每个例程中调用了 printf 以排除这种情况。它仍然具有相同的输出。

预期结果：gcc -rdynamic -g test.c -o test -L/usr/local/lib -lexecinfo

./test
DEPTH=11
./test: f0 (0x40d952)
./test: f1 (0x40da0e)
./test: f2 (0x40da1e)
./test: f3 (0x40da2e)
./test: f4 (0x40da3e)
./test: f5 (0x40da4e)
./test: f6 (0x40da5e)
./test: f7 (0x40da6e)
./test: main (0x40da89)
./test: _start (0x40080e)

意外结果：gcc -O2 -rdynamic -g test.c -o test -L/usr/local/lib -lexecinfo

./test
DEPTH=2
./test: f0 (0x40794b)

```
#include <stdio.h>
#include <dlfcn.h>

#define CALLSTACK_MAXLEN 64

//
// We use this macro instead of a for loop in backtrace() because the 
// documentation says that you have to use a constant, not a variable.
//
#define BT(X) {                                                         \
        case X:                                                         \
                if (!__builtin_frame_address(X)) {                      \
                        return X;                                       \
                }                                                       \
                                                                        \
                trace[X].address = __builtin_return_address(X);         \
                break;                                                  \
}

struct call {
        const void *address;
        const char *function;
        const char *object;
};

struct call trace[CALLSTACK_MAXLEN];

int
backtrace(int depth) {
        int         i;
        Dl_info     dlinfo;

        for (i = 0; i < depth; i++) {
                switch (i) {
                        BT(  0);  
                        BT(  1);
                        BT(  2);
                        BT(  3);
                        BT(  4);
                        BT(  5);
                        BT(  6);
                        BT(  7);
                        BT(  8);
                        BT(  9);
                        BT( 10);
                        BT( 11);
                        BT( 12);
                        BT( 13);
                        BT( 14);
                        BT( 15);
                        BT( 16);
                        BT( 17);
                        BT( 18);
                        BT( 19);
                        default:  return i;
                }

                if (dladdr(trace[i].address, &dlinfo) != 0) {
                        trace[i].function = dlinfo.dli_sname;
                        trace[i].object = dlinfo.dli_fname;
                }
        }

        return i;
}

void
f0() {
        int i;
        int depth;

        depth = backtrace(CALLSTACK_MAXLEN);
        printf("DEPTH=%d\n", depth);

        for (i = 0 ; trace[i].object != NULL; i++) {
                printf("%s: %s (%p)\n", trace[i].object, trace[i].function, trace[i].address);
        }
}

void f1() { f0(); }
void f2() { f1(); }
void f3() { f2(); }
void f4() { f3(); }
void f5() { f4(); }
void f6() { f5(); }
void f7() { f6(); }

int main(int argc, char **argv) {
        f7();
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T06:44:57.763

原因是尾递归优化。即使关闭了内联，尾递归也会将调用更改为跳转，例如

```
f6:
.LFB29:
  .cfi_startproc
  xorl  %eax, %eax
  jmp f5 
```

所以你必须：

1.  排除内联

    ```
    void __attribute__ ((noinline)) f1() { f0(); }
    void __attribute__ ((noinline)) f2() { f1(); }
    void __attribute__ ((noinline)) f3() { f2(); }
    void __attribute__ ((noinline)) f4() { f3(); }
    void __attribute__ ((noinline)) f5() { f4(); }
    void __attribute__ ((noinline)) f6() { f5(); }
    void __attribute__ ((noinline)) f7() { f6(); } 
    ```

2.  使用 -fno-optimize-sibling-calls 编译并保留帧指针

    gcc -O2 -rdynamic -g -o bfa bfa.c -ldl -fno-optimize-sibling-calls -fno-omit-frame-pointer

输出是：

```
$ ./bfa 
DEPTH=10
./bfa: f0 (0x400f23)
./bfa: f1 (0x400f8b)
./bfa: f2 (0x400f9b)
./bfa: f3 (0x400fab)
./bfa: f4 (0x400fbb)
./bfa: f5 (0x400fcb)
./bfa: f6 (0x400fdb)
./bfa: f7 (0x400feb)
./bfa: main (0x400ffb)
/lib/libc.so.6: __libc_start_main (0x7fdfbae51c4d) 
```

如预期的。

# html - 使嵌入的 PDF 大小相对：HTML

> ID：14735011
> 
> 赞同：2
> 
> 时间：2013-02-06T17:19:56.753
> 
> 标签：html, pdf, resize, embed

我目前在我的网站中嵌入了一个 PDF：

```
<body onload="startTime()">
    <div id="resume">
        <embed src="files/Resume.pdf" height="1250" width="975">
    </div>
    <h2 id="resumeNote">*Resume current as of 8/21/12</h2>
</body> 
```

但我注意到大小不是相对的（调整浏览器大小时它不会调整大小）。大多数时候这不是问题，但在调整大小时看起来有点俗气。有没有什么办法解决这一问题？从到目前为止我能够找到的内容来看，除了将 PDF 设置为以固定的高度/宽度显示之外，似乎别无选择。

# jquery - 使用 jQuery 突出显示 div，同时将其他 div 变灰

> ID：14735014
> 
> 赞同：1
> 
> 时间：2013-02-06T17:20:10.020
> 
> 标签：jquery, hover, overlay, mouseover, highlight

我已经解决了这个问题的一半，但已经陷入困境。我相信过去曾提出过类似的问题，但没有我想要的。

我目前在 jsFiddle 上有一些演示代码，可以在这里查看：http: [//jsfiddle.net/WolfHook/jb36D/](http://jsfiddle.net/WolfHook/jb36D/)

HTML

```
<div id="thumbsContainer">
<div class="imageHolder">
    Image in Here...
</div>
<div class="imageHolder">
    Image in Here...
</div>
<div class="imageHolder">
    Image in Here...
</div> 
```

CSS

```
#thumbsContainer {
background:#000;
padding:20px;
overflow:auto;}

.imageHolder {
background:#eee;
float:left;
margin:5px;
width:50px;
height:50px;
padding:5px;
border:1px solid #666;} 
```

jQuery

```
$('#thumbsContainer').children('.imageHolder').hover(function() { $(this).siblings().stop().animate({'opacity':'0.5'}); }, 
function() { $(this).siblings().stop().animate({'opacity':'1'}); }); 
```

所需的效果是让所有 div 正常显示，然后一旦将鼠标悬停在 div 上，其他周围的 div 就会变灰或添加某种叠加层。目的是让您的鼠标指针所在的 div 突出显示。

您可以看到我在 jsFiddle 上的代码实现了这一点，但它对每个 div 应用了不透明度而不是某种覆盖，这就是导致我出现问题的原因，在我当前的项目中，div 位于背景图像上方而不是全黑背景，所以不透明度不会起作用，只会让整个事情看起来很混乱。

理想情况下，我想在未突出显示的 div 上应用 div 覆盖，我可以使用 CSS 设置样式以提供灰色效果。在这个阶段，我完全愿意接受有关如何达到预期效果的建议。

有哪位好心人来帮忙给我指点一下吗？

非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:41:09.760

与其对 imageHolder div 应用不透明度，或者引入一个新的覆盖元素，为什么不对 div 的内容（例如缩略图）应用不透明度呢？imageHolder 的背景颜色将显示出来，提供“变灰”效果的灰色。

新的：

```
$('#thumbsContainer').children('.imageHolder').hover(function() { 
    $(this).siblings().children('img').stop().animate({'opacity':'0.5'}); }, 
    function() { $(this).siblings().children('img').stop().animate({'opacity':'1'});
}); 
```

使用 imageHolders 内的缩略图和所有背景图像更新您的示例：http: [//jsfiddle.net/jb36D/11/](http://jsfiddle.net/jb36D/11/)

# c# - 来自另一个存储过程的存储过程的行数

> ID：14735025
> 
> 赞同：5
> 
> 时间：2013-02-06T17:20:47.147
> 
> 标签：c#, sql, stored-procedures, rowcount, executenonquery

我有各种存储过程。我需要一个存储过程来执行一个存储过程，然后只返回行数（被调用过程返回的行数），我需要在 c# 代码中接收它。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:24:50.837

假设您使用的是 SQL Server（可以从代码片段中获得），也许这样的事情对您有用：

```
exec('exec <your stored procedure goes here>; select @@RowCount') 
```

由于您正在运行 SQL Server，我可以想到一种不一定漂亮的解决方案。

创建一个临时表（如果您有较新版本的 SQL Server，则为表变量）。然后执行：

```
exec(`
declare @t table (
   <columns go here>
);

insert into @t
    exec(''<your exec here>'');

select @rowcount
'); 
```

既然我已经说过了，我会推荐`sp_executesql`. 这是这样的：

```
declare @sql nvarchar(max) = N'exec '+@YOURQUERY + '; set @RowCount = @@RowCount';

exec sp_executesql @sql, N'@RowCount int output', @RowCount = RowCount output; 
```

我昨天大部分时间都在调试一个在插入内调用存储过程时出现的神秘情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-02T16:41:23.147

您可以在您的**子存储过程**中尝试此操作：

```
CREATE PROC PawanXX
(
 @a INT
,@b INT OUTPUT
)
AS
BEGIN

SELECT TOP 2 * FROM X

SET @b = @@ROWCOUNT

RETURN @b

END
GO 
```

我们调用所有其他 sps的主**存储过程**

```
 DECLARE @RC int
 DECLARE @a int
 DECLARE @b int

EXECUTE @RC = [dbo].[PawanXX] 
   @a
  ,@b OUTPUT

SELECT @RC 
```

相同 ProcessName Parent Child 的输出

* * *

ShareDrafts Job12 Job03 ShareDrafts Job13 Job58

（2 行受影响）

* * *

2

（1 行受影响）

# python - 在 Python 中通过 strptime 解析没有前导零的小时数

> ID：14735026
> 
> 赞同：3
> 
> 时间：2013-02-06T17:20:47.567
> 
> 标签：python, time, strptime

假设您有时间采用这种格式：

```
a = [..., 800.0, 830.0, 900.0, 930.0, 1000.0, 1030.0, ...] 
```

问题是缺少几个小时的前导零。例如`00:30`用 表示`30`，`08:00`用 表示，`800.`用`00:00`表示`2400`。是否可以使用方法将此数据解析为`time`对象`strptime`？我尝试使用以下代码

```
hours = [time.strptime(str(int(i)), "%H%M") for i in a] 
```

但得到了

```
ValueError: unconverted data remains: 0 
```

PS我正在使用Python 2.7。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T17:24:29.723

用于`zfill`根据需要添加这些零：

```
hours = [time.strptime(i[:-1].zfill(4), "%H%M") for i in a] 
```

通过使用`i[:-1]`，我们删除了那个讨厌的尾随点，并将在左侧`.zfill(4)`添加足够的`0`字符以使其达到 4 位。

演示：

```
>>> import time
>>> a = ['800.', '830.', '900.', '30.']
>>> [time.strptime(i[:-1].zfill(4), "%H%M") for i in a]
[time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=8, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1), time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=8, tm_min=30, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1), time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=9, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1), time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=0, tm_min=30, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1)] 
```

如果它们是浮点值，请使用它们上的[`format()`函数](http://docs.python.org/2/library/functions.html#format)为您提供零填充值：

```
>>> format(800., '04.0f')
'0800' 
```

所以这样做：

```
hours = [time.strptime(format(i % 2400, '04.0f'), "%H%M") for i in a] 
```

其中`% 2400`将您的值标准化为 0\. 到 2399\. 范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T17:31:49.363

`strptime()`在这种情况下，您可以提取小时、分钟：

```
>>> from datetime import time
>>> a = [800., 830., 900., 930., 1000., 1030., 30., 2400.]
>>> [time(*divmod(int(f) % 2400, 100)) for f in a]
[datetime.time(8, 0), 
 datetime.time(8, 30), 
 datetime.time(9, 0), 
 datetime.time(9, 30),
 datetime.time(10, 0),
 datetime.time(10, 30),
 datetime.time(0, 30),
 datetime.time(0, 0)] 
```

如果您想`strptime()`出于任何原因使用；您可以使用以下方法简明扼要地获得所需的格式`x % y`：

```
>>> ["%04.0f" % (f % 2400) for f in a]
['0800', '0830', '0900', '0930', '1000', '1030', '0030', '0000'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T17:44:17.693

如果那些真的是浮点文字与字符串，你可以这样做：

```
a=[800., 830., 900., 930., 1000., 1030.]
hours=[time.strptime('{:04.0f}'.format(f), '%H%M') for f in a] 
```

如果有的话，那将四舍五入（因此`1033.66666`会`1034`变成`10:34 AM`）

您也可以像这样截断：

```
[800.0, 830.0, 900.0, 930.0, 1000.0, 1030.0, 1033.3333333, 1033.66666]
hours=[time.strptime(str(f).split('.')[0], '%H%M') for f in a] 
```

* * *

*从评论编辑*

如果您的值超出范围，请执行以下操作：

```
a=[800., 830., 900., 930., 1000., 1030., 2400.]
hours=[time.strptime(s,'%H%M') for s in ['{:04.0f}'.format(f) if f <2400 else '0000' for f in a]] 
```

或者，您也可以使您的原始代码以这种方式工作：

```
[time.strptime(i,'%H%M') for i in[str(int(f)) if f<2400 else '0000' for f in a]] 
```

# javascript - 使用 jQuery 从 DOM 中删除 SVG 元素

> ID：14735029
> 
> 赞同：9
> 
> 时间：2013-02-06T17:20:54.100
> 
> 标签：javascript, jquery, html, svg

我正在使用 jQuery 将元素添加到嵌入式 SVG，如下所示：

```
 var rect = SVG('rect');
 $(rect).attr( { x: left,
                 y: top,
                 width: right - left,
                 height: bottom - top,
                 style: style } );
 $(parentElement).append(rect); 
```

例如，parentElement 可以是 $('g:first', svgRoot)，其中 svgRoot 指的是嵌入的 SVG 元素。

```
function SVG(elementName) {
        return document.createElementNS('http://www.w3.org/2000/svg', elementName);
} 
```

这很好用，新矩形显示在浏览器中并添加到 DOM：

![截屏](../Images/8a28b30981bc0b0cfc47b014081f97f8.png)

但是，删除此矩形失败。它仍然显示在浏览器中并存在于 DOM 中：

```
$(rect).remove(); 
```

我也试过

```
rect.parentNode.removeChild(rect); 
```

这会导致错误消息“Uncaught TypeError: Cannot call method 'removeChild' of null”。

你知道我该如何解决吗？在我的项目中无法使用 jQuery SVG 或其他插件/框架。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:27:58.397

我最终使用`group`s 解决了这个问题。

我最终得到了这段代码：

```
var group = getGroupByName(name);
group.parentNode.removeChild(group);

...

function getGroupByName(name) {
    var container = document.getElementById("container");
    var groups = container.getElementsByTagName("g");
    for(var i=0; i<groups.length; i++) {
        if(groups[i].getAttributeNS(null, "name") === name) {
            return groups[i];
        }
    }
    return null;
} 
```

`container`我的主要`SVG`元素在哪里。

这是经过验证的。工作正常。

**编辑**

正如评论中指出的那样。你可以找到[这个有效的小提琴](http://jsfiddle.net/cATqz/)。类似于你的例子。它创建 4 个矩形并删除前 2 个。

如果要删除第一个元素，则必须指定：

```
$("rect").first().remove(); 
```

或者，如果您想对所有矩形做一些事情，您可以使用以下方法来解决这个问题：

```
$("rect").each(function() {
     ... //could remove them here
} 
```

### 编辑 2

根据最后的评论，只要你有对对象的引用，你就可以使用它的变量来删除它。

这个[更新的小提琴](http://jsfiddle.net/cATqz/1/)将向您展示使用`lastRect`您可以删除添加的最后一个矩形。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-13T09:08:44.300

我发现这样做`.find("*")`很有帮助，我猜它会使 DOM 变平，因此忽略了 jQuery 无法处理的任何嵌套复杂性（也许......至少这是我的理论）。

因此，例如，这会删除除 rect、g、svg 元素之外的任何内容。

`$("svg").find("*").not("rect, g").remove();`

[显示 find() 和删除 svg 元素的 jSFiddle](http://jsfiddle.net/alexkey/mc6ux/)

# android - Android ServerSocket EADDRINUSE

> ID：14735032
> 
> 赞同：3
> 
> 时间：2013-02-06T17:21:08.733
> 
> 标签：android, serversocket

我在 Android 上的 TCP 服务器有问题。服务器必须管理来自同一用户的多个传入连接。我收到以下错误：

```
02-06 17:37:44.800: W/System.err(9859): java.net.BindException: bind failed: EADDRINUSE (Address already in use)
02-06 17:37:44.800: W/System.err(9859):     at libcore.io.IoBridge.bind(IoBridge.java:89)
02-06 17:37:44.800: W/System.err(9859):     at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:150)
02-06 17:37:44.800: W/System.err(9859):     at java.net.ServerSocket.bind(ServerSocket.java:318)
02-06 17:37:44.800: W/System.err(9859):     at java.net.ServerSocket.bind(ServerSocket.java:281)
02-06 17:37:44.800: W/System.err(9859):     at sample.services.TCPService$1.run(TCPService.java:84)
02-06 17:37:44.804: W/System.err(9859): Caused by: libcore.io.ErrnoException: bind failed: EADDRINUSE (Address already in use)
02-06 17:37:44.804: W/System.err(9859):     at libcore.io.Posix.bind(Native Method)
02-06 17:37:44.804: W/System.err(9859):     at libcore.io.ForwardingOs.bind(ForwardingOs.java:39)
02-06 17:37:44.804: W/System.err(9859):     at libcore.io.IoBridge.bind(IoBridge.java:87)
02-06 17:37:44.804: W/System.err(9859):     ... 4 more 
```

我添加`setReuseAddress(true)`但没有任何改变。我正在使用的代码如下。哪里错了？谢谢

```
public void onStart(Intent intent, int startid) {
    t = new Thread(){
         public void run() {
             try {
                Log.d("TCP", "Server: Creating server.");
                ServerSocket ss = new ServerSocket();
                ss.setReuseAddress(true);
                ss.bind(new InetSocketAddress(TCPPORT));
                while(true) {
                    //Server is waiting for client here, if needed
                    Log.d("TCP", "Server: Waiting on packet!");
                    Socket s = ss.accept();
                    BufferedReader input = new BufferedReader(new InputStreamReader(s.getInputStream()));
                    String msg = input.readLine();
                    ......
             }
       }
};
t.start();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T07:30:58.357

我解决了！解决方案是必须在 setReuseAddress() 语句之后绑定套接字。

# javascript - 如何调用两个函数：Java 和 Javascript，在 InputText 上有一个 KeyUp 事件

> ID：14735033
> 
> 赞同：0
> 
> 时间：2013-02-06T17:21:11.827
> 
> 标签：javascript, jquery, jsf, primefaces

我如何调用两个函数：Java 和 Javascript，在 InputText 上有一个 KeyUp 事件，我正在使用 Primefaces 组件。像这样的东西：

```
<p:inputText id="aa"
    value="#{bonBonneManagedBean.sel}">
    <p:ajax event="keyup" Onstart="fnc(this)"
    listener="#{bonBonneManagedBean.ajouterSelected(bonBonneManagedBean.sel)}" />
</p:inputText> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:44:30.267

你很近。您在`onstart`属性中只有一个错字。它应该全部小写。

```
<p:ajax event="keyup" onstart="fnc(this)"
    listener="#{bonBonneManagedBean.ajouterSelected(bonBonneManagedBean.sel)}" /> 
```

有关正确的属性名称，请参阅[VDL 文档](http://www.primefaces.org/docs/vdl/3.4/)。

# c++ - 像键盘一样向cpu发送中断吗？

> ID：14735035
> 
> 赞同：3
> 
> 时间：2013-02-06T17:21:18.190
> 
> 标签：c++, c, usb, interrupt

是否可以从用户程序以某种方式模拟硬件中断？这个问题我已经看过很多次了，但总是没有答案。

我想了解低级中断（例如模拟键盘上按键时的情况，以便键盘驱动程序中断中断）。

高级事件和 API 不在范围之内，问题是理论上的而非实际的（以防止“为什么”讨论 :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:40:32.030

是和不是。

在 x86 CPU（例如）上，有一条`int`指令会产生中断。一旦产生中断，CPU 不一定要^(区分)硬件产生的中断和软件产生的中断。例如，在最初的 PC BIOS 中，IBM 选择了一个会导致打印屏幕命令执行的中断。他们选择的中断（中断 5）是当时没有使用的中断，但英特尔曾表示保留供将来使用。英特尔最终确实使用了该中断——在 286 中，他们添加了一条`bound`指令，检查值是否在界限内，如果不在界限内，则生成中断。这`bound`指令基本上从未使用过，因为如果值超出范围，它会生成中断 5。这意味着（如果您正在运行允许它的 MS-DOS 之类的东西）`bound`使用超出范围的值执行指令将打印屏幕。

然而，在现代操作系统上，这通常是不允许的。所有中断的产生和处理都发生在内核中。硬件有 4 级保护（“环”）并支持指定`int`可以执行指令的环。如果您尝试从在 ring 3 运行的代码执行它，它不会直接执行——相反，执行将切换到 OS 内核，它可以按照自己的选择处理它。

这允许（例如）Windows 模拟 MS-DOS，因此 MS-DOS 程序（*确实*使用该`int`指令）可以在虚拟机中执行，具有虚拟化的输入和输出，因此即使他们“认为”他们正在直接工作对于键盘和屏幕硬件，他们实际上是在使用软件提供的模拟。

然而，对于“本机”程序，使用大多数`int`指令（即除了极少数的用于与内核通信的中断之外的任何中断）只会导致程序被关闭。

所以，底线：是的，硬件支持它 - 但硬件也支持禁止它，几乎每个现代操作系统都这样做，至少对于操作系统内核本身之外的大多数代码。

* * *

1.  但是，对于典型的硬件，中断处理程序可以从可编程中断控制器 (PIC) 芯片中读取数据，该芯片将告诉它中断是否来自 PIC（即硬件中断）或不是（软件中断）。大多数硬件还支持至少一些只能由硬件生成的中断，例如 x86 上的 NMI。这些通常保留用于相当狭窄的用途（例如，PC 上的 NMI 通常用于诸如内存奇偶校验错误之类的事情）。

# ruby-on-rails-3 - Rails 未定义方法“to_i”

> ID：14735036
> 
> 赞同：0
> 
> 时间：2013-02-06T17:21:19.550
> 
> 标签：ruby-on-rails-3

当用户创建一个新的 wearquest 时，我想将 wearquest.statuscode_id 设置为 statuscodes 表中的第一个条目。

以下（来自 wearquest.rb）在 Rails 3.1 中工作，但现在我已经升级到 3.2，它不工作。

```
 after_initialize :defaults

      def defaults
        self.statuscode_id ||= Statuscode.first
      end 
```

我明白了

```
undefined method `to_i' for #<Statuscode:0x007fe934b67bd0> 
```

知道为什么这现在不起作用吗？你知道什么会起作用吗？

谢谢！

# c# - 如何从 C# 更新 CRM 2011 工作流插件的 PrimaryEntity？

> ID：14735042
> 
> 赞同：1
> 
> 时间：2013-02-06T17:21:29.487
> 
> 标签：c#, workflow, dynamics-crm-2011

因此，通常在 CRM 插件中，我会使用以下代码访问主要实体：

```
(Entity)context.InputParameters["Target"] 
```

我注意到这仍然适用于工作流的创建上下文；但是，从临时用法来看，我必须使用以下内容：

```
context.PreEntityImages.FirstOrDefault().Value 
```

无论如何，一旦我有了主实体，我就会遇到令人讨厌的问题，即 Context 无法将该值识别为已经存在于上下文中的值。在使用 Update 之前，我曾尝试使用显式 Attach 和 UpdateObject，但是，我收到一个异常，告诉我这个实体已经在另一个对象下的上下文中。

我相信事后看来会很明显。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:14:07.047

我通过将每个修改的实体设置为 context.UpdateObject 然后通过 context.SaveChanges 保存来解决这个问题（这是来自 crmsvcutil 的上下文）

# sql - SQL Server 2008 - 将不同的名称选择到变量中

> ID：14735044
> 
> 赞同：9
> 
> 时间：2013-02-06T17:21:34.043
> 
> 标签：sql, sql-server-2008, email, variables

我需要从 SQL Server 向不断变化的名称列表发送电子邮件。幸运的是，用户将名称更新到 SQL Server 表中，因此它应该始终是最新的。

我已经研究过，并希望用来`sp_SQLNotify`发送电子邮件。（这已经使用实际的名称列表进行设置和测试 - 尚未使用变量）。

无论如何，我需要用要发送到的电子邮件地址列表填充一个变量。

为了做到这一点，我需要相当于：

```
SELECT DISTINCT [Email_Username] + '@my_email_suffix.com; '
INTO @VARIABLE
FROM My_Table

EXEC sp_SQLNotify @Variable 'My Header' 'My wall of text' 
```

这可能吗，我需要遵循的真正语法是什么？

请原谅我的无知，但我在一些语法上很挣扎。

谢谢，克雷格。

# ===== 已更新答案 =====

感谢亚伦。

我使用您的代码作为工作解决方案的基础。

对于将来尝试这样做的任何人，最终结果是：

```
-- Declare variable and populate with initial apostrophe
DECLARE @var VARCHAR(MAX) = '''';

-- Populate variable with all unique email user names
SELECT @var += x.email
FROM 
(
  SELECT DISTINCT [Email_Username] + '@my_email_suffix.com;'  AS email
  FROM dbo.[My_Table]
  WHERE [Email_Username] <> ''
) AS x 

-- Remove final semi-colon
SET @var = left(@var,len(@var)-1)

-- Add final apostrophe
SET @var = @var + ''''

-- Display result
SELECT @VAR; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-06T17:40:49.613

```
DECLARE @var VARCHAR(MAX) = '';

SELECT @var += x.email
FROM 
(
  SELECT DISTINCT (Email_Username + '@my_email_suffix.com;') as email
  FROM dbo.My_Table
) AS x;

SELECT @var; 
```

# matlab - 在 Matlab 中对 .csv 文件使用 textscan

> ID：14735053
> 
> 赞同：2
> 
> 时间：2013-02-06T17:21:51.550
> 
> 标签：matlab

我希望有人可以帮助我使用 textscan（或 Matlab 中的其他功能）读取文件。在线文档和示例对我没有帮助，我想我缺少一些直观的东西:(这是我想要读取的文件的结构：

```
ID,  Date of ID,    C 1-1,  C 1-2,  M R3,   M R4,   Glob ID Settings
TPOL_430_412_10X,   5/5/2011 20:23, 0,  0,  0,  0,  -1, 5.00_5.00_3_300.00_3_0.00
TPOL_430_412_10X,   5/5/2011 20:23, 0,  0,  0,  0,  -1, 5.00_5.00_3_300.00_3_0.00
TPOL_430_412_10X,   5/5/2011 20:23, 0,  0,  1,  0,  1,  5.00_5.00_3_300.00_3_0.00
TPOL_430_412_10X,   5/5/2011 20:23  0,  0,  0,  0,  -1, 5.00_5.00_3_300.00_3_0.00
TPOL_430_412_10X,   5/5/2011 20:23  0,  0,  0,  0,  -1, 5.00_5.00_3_300.00_3_0.00 
```

我的文件是 .csv 文件，所以分隔符是逗号。我一直试图无济于事的是：

```
fmt = [repmat('%s',1,2), repmat('%f',1,5),'%*s %[^\n]'];
fid = fopen('file.csv','rt');
data = textscan(fid, fmt, 'HeaderLines', 1);
fclose(fid); 
```

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:50:21.413

我用这个

```
A = textscan(fid,'%s %s %s %f %f %f %f %f %s', 'HeaderLines', 1); 
```

它应该将您要读取的所有参数拆分为`A`size的单元格`(1,9)`。

希望这可以帮助。

# c# - Entity Framework 5 跟踪更改

> ID：14735056
> 
> 赞同：1
> 
> 时间：2013-02-06T17:21:56.397
> 
> 标签：c#, .net, entity-framework, entity-framework-5

我可以使用 ef 5 跟踪子实体的变化吗？

**例子：**

领域对象：书籍（一对多）页面

```
var oldBook = context.Books.Include("Pages");
context.Entry(oldBook).CurrentValues.SetValues(updatedBook); 
```

此代码将使用 updatedBook 对象的简单属性值更新旧书对象的简单属性。

有什么方法可以跟踪儿童收藏吗？（在这种情况下为页面）。或任何最佳实践如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T22:31:48.197

你的问题有点模棱两可。

> 我可以使用 ef 5 跟踪子实体的变化吗？

当然，除非您使用`IQueryable.AsNoTracking()`or明确禁用更改跟踪，否则`MergeOption.NoTracking`您可以跟踪附加到`DBContext` `ObjectStateManager`.

如果您真的在询问是否有可以执行此操作的功能：

`context.Entry(oldBook).CurrentValues.SetValues(updatedBook);`

然后将整个对象图的当前值（其中 oldbook 是根）设置为 updatedBook 对象图的更新值，不。

您必须循环访问并调用`context.Entry(oldPage).CurrentValues.SetValues(updatedPage)`您希望更新的每个页面。

我认为您处于断开连接的场景中，您不能只是从数据库中提取实体并使用自动更改跟踪并直接在跟踪的实体上设置修改后的值，否则您可以只使用附加到的单个对象图上下文而不是使用两个实例（即旧书、更新书）。

如果您已经有一个分离的修改对象图，您需要使用替代方法来从数据库中检索实体并使用`SetValues()`是将实体附加到修改后的上下文。您仍然需要循环并为对象图中的所有实体执行相同的操作。

```
context.Entry(updatedBook).State = EntityState.Modified;
foreach(var p in updatedBook.Pages) context.Entry(p).State = EntityState.Modified;
context.SaveChanges(); 
```

# monodevelop - 是否有可能为 Monodevelop 提供一个可用的 USB 可启动开发环境

> ID：14735061
> 
> 赞同：0
> 
> 时间：2013-02-06T17:22:24.200
> 
> 标签：monodevelop, linux-mint

是否可以为 Monodevelop 提供一个可启动的开发环境，只需通过可启动的 USB 即可。我计划从 Linuxmint 14.1 (Cinnamon) 的 USB 可启动版本测试 MonoDevelop 中的开发。我还不想在我的 Dev pc 上投资虚拟机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:38:31.063

如果您的笔记本电脑或 PC 上的配置相当不错，并且您的 BIOS 支持从 USB Pen 驱动器启动，那么可以，您可以将 ISO 刻录到 USB Pen 驱动器并开始使用它。您可以无缝打开所有应用程序。例如，您可以使用 Firefox 浏览网页，在终端中传递诸如“apt-get ...”之类的命令等。我最近做了同样的事情，在我的 16GB 笔式驱动器上刻录了 Linux Mint 14.1 ISO。我的机器有以下配置：

(~4GB-RAM + 2.6GHZ-DUAL-CORE-CPU + ~300GB-HDD)

要格式化笔式驱动器，您可以从 linux 终端发出以下命令：

dd if=/home/PATH_TO_ISO/LinuxMint.iso of=/dev/sda bs=1M

将“if=”旁边的路径替换为 ISO 映像的路径，将“of=”旁边的路径替换为 USB pendrive 的设备路径。

我的建议是不要让 LiveOS 持久化。USB Pendrive 足以启动系统并启动它，但如果操作系统开始在其上保存数据，您将受到性能下降的打击。毕竟，USB2 有一些速度限制。相反，我建议您将您的工作（您的单一开发解决方案、项目等）保存在您机器本身的现有 NTFS/EXT4 分区上。这样，您将享受良好的性能，同时还可以从您的笔式驱动器启动。

干杯。

# javascript - 检测 SPAN 何时*再次*可见

> ID：14735065
> 
> 赞同：1
> 
> 时间：2013-02-06T17:22:40.077
> 
> 标签：javascript, events, visibility, html

这可能已经被问过，但我无法找到令人满意的答案。

在我的 HTML 标记中，我有一个带有 onclick 事件的 SPAN 元素，例如

```
<span onclick='loadDiv()'>Text</span> 
```

当用户单击跨度时 - 具有较高 z-index 的 DIV 绝对位于跨度上（类似于对话框窗口）。用户然后在 DIV 内部执行一些操作，并且 DIV 的显示设置为“无”，它变得不可见。

当跨度再次可见时，如何从跨度的角度检测？如何实现类似于`"<span onvisible="somefunction()"....`

谢谢！

**更新：**我需要在纯 JavaSctipt 中实现它，我可以使用的最大值是 MS AJAX 扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:40:21.400

再次修改隐藏div的函数，接受回调。

```
function hideThatDiv(callback){
   //whatever code hides your div
   callback.apply({what you'd like `this` to refer to}, [array, of, args])
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:21:46.013

实际上，解决方案被证明是微不足道的

```
<span onclick='loadDiv(); var i=setInterval(function(){if (xdivDialog.style.display=="none") {clearInterval(i); handleEvent()}},1000)'>Text</span> 
```

基本上，`onClick`如果我启动计时器来定期检查对话框 DIV 是否再次隐藏。一旦检测到这一点，我就会停止计时器并处理该事件。

# django - 我想要一个选择来影响管理员中的两个字段

> ID：14735068
> 
> 赞同：1
> 
> 时间：2013-02-06T17:22:46.140
> 
> 标签：django, subclassing, mezzanine

我正在从 Mezzanine（一个 django 应用程序）中继承一个模型。

在管理员中，我想要一个选择列表。该选择与将在博客文章中显示的固定图像列表中的图像相关联。

因此，管理员从列表中选择后，选项旁边会有一个漂亮的小缩略图。

我已经研究过子类化或扩展 django 字段，但这超出了我的想象（不完全是。）

`FileBrowseField`是我找到的最合适的。

我会考虑提供的任何路径。我喜欢挑战，我有时间。我不希望博客作者上传图片，但图片已经带有选项。

同样，我想在管理页面中包含图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:51:41.437

这将需要 Javascript 以及 Django 的管理系统和模板语言的知识。核心组件是自定义 model.py 的自定义 admin.py、用于选择图像的管理小部件以及最终用户和管理界面的模板更改。可以将图像的静态列表作为[选项](https://docs.djangoproject.com/en/dev/ref/models/fields/#choices)包含在[CharField](https://docs.djangoproject.com/en/dev/ref/models/fields/#charfield)上。如果`choices`键值对的值是图像的 url，那么您可以将其缩略图写入模板。

或者，您可以创建一个与您的博客文章具有[ForeignKey](https://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey)关系的 Image 模型（反之亦然，具体取决于您的目标），并将 FileBrowseField 用作该 Image 上的字段。

# vba - 多个条件的搜索表

> ID：14735070
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:22:52.903
> 
> 标签：vba

```
For Each c1 In ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible)
If cl.Interior.ColorIndex = 16 Then

MsgBox "Error in " & c1.Address
Exit Sub ' To step out after first error
End If
Next
End Sub 
```

我有这个代码可以在我的工作表中搜索颜色索引为 16 的非隐藏单元格。

但是，我想添加第三个标准： `SpecialCells(xlCellTypeBlanks)`

这样消息仅在满足 3 个条件时出现。

感谢您的想法，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:46:30.797

试试这个：`If c1.Interior.ColorIndex = 16 And c1.Value2 = vbNullString Then`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:46:20.133

首先，使用`Option Explicit`！这样您就可以防止混淆`cl`，`c1`就像您在代码中所做的那样！此外，使用缩进使您的代码更易于阅读的最佳实践。

您可以通过以下方式实现您的愿望`Application.Intersect`：

```
选项显式

私有子 FindErrors()
    调暗 c 作为范围
    对于 Application.Intersect( _
        ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible), _
        ActiveSheet.UsedRange.SpecialCells(xlCellTypeBlanks))

        如果 c.Interior.ColorIndex = 16 那么
            c.激活
            MsgBox "Error in " & c.Address
            退出子
        万一
    下一个 c
结束子

```

# java - 将函数应用于 TextView 中的所有字符串

> ID：14735072
> 
> 赞同：0
> 
> 时间：2013-02-06T17:23:00.793
> 
> 标签：java, android, arabic

我有一个连接断开的阿拉伯字母的功能（这个问题只出现在那些没有安装阿拉伯语的手机中）。

我可以成功地使用这个函数来`TextView`应用它：

```
text.setText(ArabicReshaper.shape(whateverstring)); 
```

问题是我的应用程序中有太多字符串。我想知道是否有任何其他方式可以将Shaper函数一次性应用到所有内容，`TextViews`而`Buttons`不是一个一个地手动完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:27:45.283

您可以扩展`TextView`类、覆盖`setText`方法并在您的应用程序中的任何地方使用它而不是常规`TextView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:32:21.577

前任。

```
public class MyTextView extends TextView {
    private CharSequence mText;

    public MyTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public void setText(CharSequence text, BufferType type) {
        super.setText(ArabicReshaper.shape(text), type);
    }

} 
```

# git - git upload-pack：协议错误，预计会得到 sha

> ID：14735075
> 
> 赞同：1
> 
> 时间：2013-02-06T17:23:20.713
> 
> 标签：git

在服务器上 (site@site)

```
> git init --bare 
```

回到我的客户

```
> git remote add origin site@site:/home/git/repos/repo_name/

> git push origin master 

Counting objects: 43, done.
Delta compression using up to 2 threads.
fatal: git upload-pack: protocol error, expected to get sha, not '0000000000000000000000000000000000000000 f9b6ddffc38fe0cfcd0ab311197bb31d1fab4856 refs/heads/master'
Compressing objects: 100% (42/42), done.
error: pack-objects died of signal 13
error: failed to push some refs to 'site@site:/home/git/repos/repo_name/' 
```

不确定是什么导致初始回购推送时出现此错误。我尝试用一​​个文本文件创建一个简单的存储库，并且成功了。我怀疑可能有一个文件导致了错误，但不确定如何追踪它是哪个文件（除了从存储库中删除所有内容并一次将它们添加回来）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:25:15.673

在空仓库上推送新仓库通常需要 -u

```
git push -u origin master 
```

# r - 如何处理包含 NA 的条件 data.frame 下标？

> ID：14735078
> 
> 赞同：4
> 
> 时间：2013-02-06T17:23:27.697
> 
> 标签：r, conditional-statements, missing-data, na

如果条件向量包含 NA，有没有办法获得条件下标？假设我有一个这样的 data.frame

```
dframe <- data.frame(a=c(1,32,4,5,8),b=c(1,2,3,4,5),d=c(NA,5,5,10,9))
dframe[dframe$d > 9,"a"] <- NA 
```

如果不是 dframe$d 中的 NA，这将是直截了当的。我见过像[这里](https://stat.ethz.ch/pipermail/r-help/2008-June/165760.html)`%in%`这样的语法来绕过 NA，但不知道如何根据条件管理它。我可以看到这是一个普遍的问题，因为我不太确定是否要为条件中的缺失值或其他内容获取 NA。但我也有兴趣了解人们如何处理这种情况。

在我的具体情况下，当 NA 在这种情况下被视为 FALSE 时，它只会有所帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T17:33:56.570

您可以将索引限制为非 NA 值

```
dframe[ dframe$d > 9 & !is.na(dframe$d), "a"] <- NA 
```

* * *

**编辑：**这是[R Inferno](https://www.burns-stat.com/pages/Tutor/R_inferno.pdf)的更紧凑的替代方案：

```
dframe[ which(dframe$d > 9), "a"] <- NA 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-06T17:32:36.047

你很亲密。你有条件和`%in%`。只是没有链接。实际上很简单。只需`%in%`与`TRUE`它一起使用就会返回所有其他值，其中 as`NA`将替换为`FALSE`

```
 dframe[(dframe$d > 9) %in% TRUE, "a"] <- NA 
```

# lucene - 如何在 neo4j 中搜索索引节点

> ID：14735081
> 
> 赞同：1
> 
> 时间：2013-02-06T17:23:46.823
> 
> 标签：lucene, neo4j

我正在像这样索引neo4节点

```
BatchInserterIndexProvider indexProvider = new LuceneBatchInserterIndexProvider( db );
logger.info("indexer created :" + indexProvider);
BatchInserterIndex nodeIndexer = indexProvider.nodeIndex( "actors", MapUtil.stringMap("type", "exact"));
nodeIndexer.setCacheCapacity( "name", 100000 );
long indexId = db.createNode(map);
nodeIndexer.add( indexId, map ); 
```

在搜索节点时，我可以用一个键搜索，但我想搜索所有键。

```
List<Node> nodesList = new ArrayList<Node>();
IndexManager manager = graphDatabaseService.index();
org.neo4j.graphdb.index.Index<Node> nodesIndex = manager.forNodes("actors");
IndexHits<Node> nodes = nodesIndex.query("Associate_Name:*" + pattern + "*");
Node aNode = null;
while (nodes.hasNext()) {
    nodesList.add(nodes.next());
}

return nodesList; 
```

我试过了，`IndexHits<Node> nodes = nodesIndex.query("*:*"+pattern+"*");`但这很有效。

任何人都可以告诉我如何使用所有键在 neo4j 中搜索索引节点。

编辑：使用一键 Associate_Name 搜索 --> 如果 Associate_Name 键中存在给定模式，则将返回那些许多节点。

但是我想搜索给定模式是否存在于特定节点的任何键中，对所有节点进行此搜索，哪些节点包含任何应该返回的值的给定模式。

感谢您的建议，但我的要求将满足 OR 像这样

```
nodesIndex.query("kye1:"+pattern1+" OR key2:"+pattern2+" OR key3_part:"+pattern3_part+"* ") 
```

这是搜索节点的好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T05:33:28.047

你是什​​么意思'所有的钥匙'？您的意思是要获取与键关联的所有节点，还是索引中的所有节点？

要搜索与键关联的所有节点：`nodesIndex.query("Associate_Name:*")`

要搜索索引中的所有节点：`nodesIndex.query("*:*")`

# java - 单击 JLabel 打开一个新框架

> ID：14735085
> 
> 赞同：14
> 
> 时间：2013-02-06T17:24:00.430
> 
> 标签：java, swing, frame, jlabel, mouselistener

我正在为我正在编程的游戏设计图形，我想知道是否有一种简单的方法可以在单击 JLabel 时打开框架？

有没有简单的代码？

![在此处输入图像描述](../Images/3a5a1b0e035690a7466cb5a99af41347.png)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-06T17:27:56.960

实现`MouseListener`接口并使用它`mouseClicked`的方法来处理 JLabel 上的点击。

```
label.addMouseListener(new MouseAdapter()  
{  
    public void mouseClicked(MouseEvent e)  
    {  
       // you can open a new frame here as
       // i have assumed you have declared "frame" as instance variable
       frame = new JFrame("new frame");
       frame.setVisible(true);

    }  
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T17:36:28.130

创建一个标签并在其中添加点击事件。

像这样的东西：

```
JLabel click=new JLabel("Click me");

 click.addMouseListener(new MouseAdapter() {
        public void mouseClicked(MouseEvent e) {
           JFrame jf=new JFrame("new one");
        jf.setBackground(Color.BLACK);
        jf.setSize(new Dimension(200,70));
        jf.setVisible(true);
        jf.setDefaultCloseOperation(EXIT_ON_CLOSE);
        }
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:50:25.590

*   不要创建一个新的[JFrame](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)，永远不要创建一堆 JFrame，必须计算 with `OutOfMemoryException`，因为这`Object`永远不会被 GC 处理，

*   让多个视图使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)

*   查看答案[多个 JFrame 的使用，好的/坏的做法？](https://stackoverflow.com/a/9554657/714968)经过`@Andrew Thompson`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T17:30:13.890

你可以这样做：

```
label.addMouseListener(new MouseAdapter()   {   

        public void mouseClicked(MouseEvent e)   
        {   
              JPanel j = new JPanel();
              frame.setContentPane(j);
        }   
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T17:49:30.667

```
1:- Implement your class containing the JLabel with MouseListener interface
2:- add MouseListener to your JLabel 
3:-Override mouseClicked Event in your class
4:- In mouseClicked Even't body add your code to open a new JFrame/Frame . 
```

# c# - 具有延迟加载和多个数据源的 UnitOfWork

> ID：14735086
> 
> 赞同：3
> 
> 时间：2013-02-06T17:24:09.247
> 
> 标签：c#, asp.net-mvc, azure-sql-database, azure-storage

我有跨两个数据存储存储的业务对象。对象的一部分存储在 Azure 表存储中，另一部分存储在 Azure SQL 中。基本上 SQL 部分用于查询，而表存储用于占用大量空间的属性。

大多数时候，只使用对象的 SQL 部分（在 SQL 查询中）。仅当有人明确要求该对象时才需要表存储属性。我想要实现的设计将隐藏业务对象背后有两个数据源的事实，延迟加载存储表属性（因为在执行 SQL 查询时不需要它们）并且仍然使代码可测试。

我当前的设计有一些由工作单元创建的 POCO。我不想创建两个 POCO，一个用于表存储，一个用于 SQL，所以我在考虑以下设计：

```
//Make the properties virtual
public class Customer
{
    public virtual string Name {get;set;} //Stored in SQL
    public virtual string Age {get;set;} //Stored in SQL
    public virtual string Details {get;set;} // This prop is stored in Table Storage
}

//Create a derived internal POCO that can notify when a property is asked
internal class CustomerWithMultipleStorage
{
    public event EventHandler OnDetailsGet;

    public override string Details
    {
         get { if (OnDetailsGet!=null) OnDetailsGet( ... ); /* rest of the code */ }
         set { /* code */ }
    }
} 
```

我所有的数据层代码都可以使用，`CustomerWithMultipleStorage`而 DL 之外的所有“外部”代码都将使用`Customer`，并且不会暴露事件。现在，当工作单元返回 a`Customer`时，它将仅加载 SQL 属性并订阅 Get 事件。如果使用 Customer 的人需要其余属性，则将触发事件并加载表存储属性。

你觉得这个设计怎么样？这是正确的方法吗？你知道这样做的更好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:18:59.053

您*可以*使用`Lazy<T>`依赖注入。请注意，这只是为了给您一些想法。

```
internal class CustomerWithMultipleStorage : Customer
{
    private readonly ISqlDataLayer _sqlDataLayer;
    private readonly ITableStorageDataLayer _tableStorageDataLayer;
    private readonly Lazy<string> _details;
    private string _detailsValue;

    public CustomerWithMultipleStorage(ISqlDataLayer sqlDataLayer, ITableStorageDataLayer tableStorageDataLayer)
    {
        _sqlDataLayer = sqlDataLayer;
        _tableStorageDataLayer = tableStorageDataLayer;

        _details = new Lazy<string>(() => return (string)_tableStorageDataLayer.GetValue<Customer>(this, "Details"));
    }

    public override string Details
    {
         get
         {
            return (_detailsValue ?? (_detailsValue = _details.Value));
         }
         set
         {
            _detailsValue = value;
            _tableStorageDataLayer.SetValue<Customer>(this, _detailsValue);
         }
    }
}

public interface ITableStorageDataLayer
{
    object GetValue<T>(T item, [CallerMemberName] string property = "");
    void SetValue<T>(T item, object value, [CallerMemberName] string property = "");
} 
```

您也可以只使用一个数据层来为每个对象映射数据（稍后我将提供示例）。

# python - TableView 到 PDF（多页）

> ID：14735089
> 
> 赞同：4
> 
> 时间：2013-02-06T17:24:23.893
> 
> 标签：python, pyqt

我在尝试将完整的表格视图从我的 PyQt 应用程序导出到 pdf 时遇到了一个主要障碍。

我已经能够导出某种 pdf，但它们总是被当前的查看区域修剪掉。

我正在寻找一个导出完整表格视图的示例，即使在导出时只有一些可见。

我在这个 tableview 中有一些缩略图，所以我想这将是捕捉可见图像的东西。

这是我到目前为止的代码，它设法导出带有部分 tableview 的 pdf。任何提示将不胜感激！

```
def _print(self,  checked = None):
    if checked == None: return
    fileName = QtGui.QFileDialog.getSaveFileName(self, 'Save File', '', 'PDF Files (*.pdf)')
    if fileName == '': return

    #set up the QPrinter
    p = QtGui.QPrinter(QtGui.QPrinter.HighResolution)
    p.setPaperSize(QtGui.QPrinter.A4)
    p.setOutputFormat(QtGui.QPrinter.PdfFormat)
    p.setOrientation(QtGui.QPrinter.Landscape)
    p.setOutputFileName(fileName)

    #set up the painter
    painter = QtGui.QPainter()
    #Activate the painter to paint on p then give visual conformation that it worked or not.
    #If didn't work return out of method.
    if painter.begin(p) == False:
        msgBox = QtGui.QMessageBox()
        msgBox.setText('An Error occoured while creating PDF')
        msgBox.setInformativeText('Could not save PDF')
        msgBox.setIcon(QtGui.QMessageBox.Critical)
        msgBox.exec_()
        return
    #self.ShotTableView.scale(200, 200);
    #painter.begin(printer)
    print self.ShotTableView.width()
    xscale = (self.ShotTableView.width() / 50);
    yscale = (self.ShotTableView.height() / 50);
    #scale = qMin(xscale, yscale);

    painter.scale(xscale, yscale);
    self.ShotTableView.render(painter)
    painter.end() 
```

# java - 使用对象时受保护的访问

> ID：14735093
> 
> 赞同：1
> 
> 时间：2013-02-06T17:24:35.830
> 
> 标签：java, object, member, protected

我了解受保护的访问意味着可以访问包和任何子类中的成员，而不管包如何。我发现难以理解的是，在子类中，当我创建具有受保护成员的类的对象时，会出现“不可见”错误？下面的代码证明了这一点（这是基于吴一凡回答的扩展版本）。请注意，我在包内外都有相同的代码行。因此我有两个问题：

1.  为什么使用对象会改变一切？
2.  这种对象访问差异不会发生在包内，即参见 A1 类中的 test()。

    ```
    package a;
    public class A{
        protected int a;
    }
    class A1{
        public void test(){
            A ref = new A();
            ref.a=8;    // no issue
        }
    }

    package b;
    public class B extends A{
    }

    package c;
    public class C extends B｛
        public void accessField(){
            a = 2;   //That works.

            A ref = new A();
            ref.a=8;   // not visible!!
        } 
    ```

    }

非常感谢任何帮助...

谢谢，肖恩。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:27:15.800

因为`C`在另一个包中，并且您正在创建一个，`A`而*不是*`A`.

将问题翻转过来：为什么它*应该*是可见的？您已经知道打包规则，并且您已经知道字段访问规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:30:12.297

在最后一种情况下，您正在创建 A 对象的新实例。这与使用子类的实例来访问其父类的成员完全不同。

**当你创建一个子类时，它首先创建一个父类。唯一可以访问父实例中受保护成员的子类是创建父类的子类。**

# javascript - 让 JSON 与 Google Maps API 3 一起工作

> ID：14735097
> 
> 赞同：2
> 
> 时间：2013-02-06T17:24:43.780
> 
> 标签：javascript, json, google-maps, google-maps-api-3

我正在通过 JSON 提取我的标记数据。当我开发我的本地副本时，我将它放在一个 JS 文件中，然后使用它调用它

```
<script src="assets/js/locations.js"></script> 
```

我现在将站点移动到 CMS（ExpressionEngine）上，因为标记数据是动态的，所以我有一个 JS 模板，它现在保存 JSON 数据。

我现在必须将文件包含为**（注意没有文件扩展名）**

```
<script src="http://domain.com/map/locations"></script> 
```

这是我拥有的 JSON 示例。

```
var locations = [

    [2, 51.39006, -0.02976, 'telecommunications', 'Test 2', '<div><img src="http://localhost/map/assets/graphics/info_window/default.jpg" alt="Test 2" width="105" height="70" style="float:right;"> <p>fdgj fdh uhfj bfd nibjdfjb ndfjn fd vfn vbjdc&nbsp; ifs n ei klmvf.cx fi fskn d</p></div>', '<a href="http://www.yahoo.com" target="_blank">Read more</a>' ],   
    [1, 51.51400, -0.12002, 'transport', 'Test map marker', '<div><img src="{image:url:thumb}" alt="Test map marker" width="{image:width:thumb}" height="{image:height:thumb}" style="float:right;"> <p>eubnglrsk nekfldb jndklvcbv jdnfhl kvbmd klbndvl kbjn dkbnm lkd nbmfljeb ygdjfjn</p></div>', '<a href="http://www.google.com" target="_blank">Read more</a>' ]  

]; 
```

这是地图的标记循环

```
var markers = [];

    // Looping through the JSON data
    for (var i = 0; i < locations.length; i++) {

        // Creating a marker and putting it on the map
        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(locations[i][1], locations[i][2]),
            map: map,
            title: locations[i][4],
            icon: iconSrc[locations[i][3]]
        });
        markers.push(marker);

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function() {
                infoWindow.setContent("<div class='cont_box' id='" + locations[i][0] + "'>" + "<h2>" +locations[i][4] + "</h2>" + "<div class='cont'>" + locations[i][5] + "</div><div style='clear:both;'></div><div class='link'>" + locations[i][6] + "</div></div>");
                infoWindow.open(map, marker);
            }
        })(marker, i));

    }// END for loop 
```

显然，当我引用由 CMS 呈现的 JSON 数据时，我得到的错误是 ::

**ReferenceError：未定义位置**

该 URL 是有效的，只是它似乎不像我使用 JS 文件时那样被拉入。

我不知道在地图 JS 代码本身中调用文件是否会更好。

关于如何完成这项工作的任何建议都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:42:35.707

确保在您的 HTML 脚本中，您在获取创建地图的脚本之前获取“locations.js”脚本。使用 firebug 或 chrome 控制台，确保浏览器正确加载了这两个脚本。

查看加载这些脚本的 html 片段会很有帮助。

另外，你的意思是写：

```
<script src="http://domain.com/map/locations.js"></script> 
```

上面而不是：

```
<script src="http://domain.com/map/locations"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T22:01:13.300

我有2个想法。

1.  在你的脚本标签中声明类型（你知道你的整个页面是否是 html5 吗？）：

> ```
> <script type="text/javascript" src="http://domain.com/map/locations"></script> 
> ```

我的另一个想法是在代码中加载您的数据：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://domain.com/map/locations', true);
xhr.onload = function() {load you markers here}
};
xhr.send(); 
```

# c# - 如何使用 HttpWebRequest 类获得真正的多响应

> ID：14735100
> 
> 赞同：0
> 
> 时间：2013-02-06T17:24:50.707
> 
> 标签：c#, sockets, asynchronous, httpwebrequest, webrequest

我在课堂上有一些逻辑问题[`HttpWebRequest`](http://msdn.microsoft.com/ru-ru/library/system.net.httpwebrequest.aspx)。

我使用命名空间中的`HttpWebRequest`类`System.Net`，当我这样做时：

```
while(true)
{
    HttpWebRequest request = WebRequest.Create("http://somesite.com/") as HttpWebRequest;
    HttpWebResponse responce = request.GetResponse() as HttpWebResponse;
} 
```

我以超额一秒的间隔得到一一响应，但我认为我的互联网连接可以更快地工作，因为接收到的数据非常小。然后我试试这个：

```
while(true)
{
    HttpWebRequest request = WebRequest.Create("http://google.com/") as HttpWebRequest;
    HttpWebResponse response = request.BeginGetResponse(EndReceive, obj);
}

internal void EndReceive(IAsyncResult ar)
{
    obj.Response = obj.Request.EndGetResponse(ar) as HttpWebResponse;
} 
```

而且我的速度增加非常小，大约 10-30%，但是我使用异步请求，我发送到服务器 5 请求而不是一个，为什么速度没有增加超过 100%？如果服务器不能同时处理来自一个 ip 的多个请求，那没关系......但是当我使用代码运行 10 个控制台应用程序时：

```
void SendRequest()
{
    HttpWebRequest request = WebRequest.Create("http://google.com/") as HttpWebRequest;
    HttpWebResponse responce = request.BeginGetResponse(EndReceive, obj);
}

void EndReceive(IAsyncResult ar)
{
    obj.Response = obj.Request.EndGetResponse(ar) as HttpWebResponse;
} 
```

我的速度提高了 4-8 倍，是`HttpWebRequest`上课的问题吗？为什么我不能用一个应用程序获得这样的速度，但有很多异步请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:29:04.753

我强烈怀疑您基本上受到内置连接池的限制，这将限制单个进程（或可能是 AppDomain）对给定主机发出的请求数量。如果要更改可以对单个主机发出的并发请求数，请使用[`<connectionManagement>`](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)app.config 中的元素。

顺便说一句`using`，您在使用响应时应该有一个声明，否则您没有正确处理它......这可能会导致连接池本身出现可怕的问题。

# c# - Linq 查询返回正确数量的结果，除第一个之外的所有结果均为空

> ID：14735103
> 
> 赞同：0
> 
> 时间：2013-02-06T17:24:56.943
> 
> 标签：c#, linq, lambda, entity-framework-5

我正在尝试获取`User`使用查找表的列表`ProjectFollower`。这是我正在使用的查询。它返回一个包含 4 个项目的列表。列表中的第一项有一个值，接下来的三个为空。数据库中实际上有 4 个结果。为什么除了第一个空值之外都是空的？

```
 subscribers = project.ProjectFollower.Select(u => u.User).ToList(); 
```

**为清晰而**更新。****

 **ProjectFollower 表有该项目的 4 个条目，具有 4 个不同的 UserID 和相同的 ProjectID。这 4 个用户 ID 对应于现有用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:29:39.057

```
subscribers = project.ProjectFollower
.Where(u => u.User != null)
.Select(u => u.User).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:21:12.527

根据乔恩的评论。问题出在查询上。

我有

```
 var project = db.Projects
                    .Include(i => i.ProjectFollower)
                    .Include(i => i.User)
                    .SingleOrDefault(i => i.ProjectID == project_id); 
```

我把它改成

```
 var project = db.Projects
                    .Include(i => i.ProjectFollower)
                    .Include(i => i.ProjectFollower.Select(v => v.User))
                    .Include(i => i.User)
                    .SingleOrDefault(i => i.ProjectID == project_id); 
```**

# c++ - 如何静音/取消静音 BASS？

> ID：14735111
> 
> 赞同：0
> 
> 时间：2013-02-06T17:25:12.890
> 
> 标签：c++, c, audio, bass

如何**静音**和**取消静音**BASS 播放（**平台无关**）？到目前为止，我在静音前保存当前音量，将音量设置为 0，如果取消静音，则将其重新设置。

**示例：**
[*我的 C++ 类的一部分*]

```
volume_t lastVolume; // 0.0f = silent, 1.0f = max (volume_t = float)

// ...

bool mute(bool mute)
{
    if( mute )
    {
        lastVolume = getVolume(); // Save current volume

        return setVolume(0.0f); // Set volume to silent
    }
    else
    {
        return setVolume(lastVolume); // restore last volume before muting
    }
} 
```

有一个更好的方法吗？在 BASS Api 文档中只有一个*静音*功能：

```
BOOL BASS_WASAPI_SetMute(
    BOOL mute
); 
```

然而，这看起来不错，但不幸的是它是*BASSWASAPI*的一部分（Windows Vista 及更高版本上的 WASAPI I/O - 这不是跨平台的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T18:27:08.610

这是我的解决方案：

```
class PlayerBASS : public virtual AbstractPlayer
{
public:

    // ...

    /**
     * Set volume on current channel.
     * 
     * @param volume      volume (0.0f - 1.0f)
     */
    bool setVolume(volume_t volume)
    {
        return BASS_ChannelSetAttribute(streamHandle, BASS_ATTRIB_VOL, volume);
    }

    /**
     * Get volume on current channel.
     *
     * @return            volume (0.0f - 1.0f)
     */
    volume_t getVolume()
    {
        float value;
        BASS_ChannelGetAttribute(streamHandle, BASS_ATTRIB_VOL, &value);

        return value;
    }

    /**
     * Mute / Unmute the volume on current channel.
     *
     * @return            'true' if successful, 'false' if error
     */
    bool mute(bool mute)
    {    
        if( mute == muted ) // dont mute if already muted (and vice versa)
            return true;

        bool rtn; // returnvalue

        if( mute ) // mute
        {
            lastVolume = getVolume(); // save current volume
            rtn = setVolume(0.0f); // set volume to 0.0f (= mute)
            muted = true; // set mute-state
        }
        else // unmute
        {
            rtn = setVolume(lastVolume); // restore volume
            muted = false; // set mute-state
        }

        return rtn; // returnvalue
    }

    // ...

private:
    // ...
    HSTREAM streamHandle; // Streamhandle
    bool muted; // flag for mute-state ('true': muted, 'false': unmuted) - init with 'false'
    volume_t lastVolume; // lastVolume
}; 
```

**不要**在这里使用`BASS_SetVolume()`/ `BASS_GetVolume()`- 它会设置整个系统的音量！

而已！

# terminology - “SO”和“RO”后缀是否具有标准含义，如“EnvelopeSO”？

> ID：14735122
> 
> 赞同：0
> 
> 时间：2013-02-06T17:25:59.177
> 
> 标签：terminology, abbreviation, acronym

我正在使用通信层，并且有名为“*EnvelopeSO”和“*EnvelopeRO”的对象。

我试图在维基百科、搜索引擎和这里找到它们，但它们很难搜索。

这些后缀经常使用吗？它们代表什么（缩写，首字母缩略词）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T09:02:18.987

这些后缀通常表示对象的作用。

对于打算传输数据的对象，通常会添加**TO**后缀，因此我们有`ServerTO`, `AccountTO`, `UserTO`, `CompanyTO`, `CustomerTO`,`SaleItemTO`等。**TO**是*Transfer Object*的首字母缩写。这种情况的一个变体是**DTO**后缀，它表示*Data Transfer Object*。

对于旨在控制数据库访问的对象，我们有*Data Access Object的***DAO**后缀，所以我们有一个, ,等。*`UserDAO``CustomerDAO``SalesDAO`*

 ***UI**或**GUI**后缀经常用于用户界面对象。这些是*图形用户界面*或简单的*用户界面*的首字母缩写词。

其他常见的用法是**VO**代表*Value Object*和**DO**代表*Domain Object*。

我曾经看到*商业实体的***BE**后缀，*服务定位器*的**SL**和*Page Bean*的**PB**。

 *******虽然这是很多地方的常见做法，但我强烈建议不要这样做。描述性名称通常比隐晦的首字母缩写词后缀（或前缀）好得多，但如果找不到不太长的名称，请使用首字母缩写词。取而代之的是，`CustomerTO`或者`CustomerDTO`您可以将其命名为`Customer`. 而不是`SalesDAO`你可以命名它`SalesPersistence`或`SalesDatabase`. `VendorDSA`这消除了当你得到 a或 a时试图理解后缀应该意味着什么的问题`PersonTF`。

特别是**DTO**、**TO**、**DAO**、**UI**、**GUI**、**VO**和**DO**后缀非常普遍和普遍。其他后缀通常是晦涩的。

对于您的特殊情况，我不知道什么是**SO**和**RO**，除了猜测之外，我无能为力，这再次表明描述性名称比作为后缀的首字母缩略词更好。我最好的选择是**SO**是*Service Object*而**RO**是*Resource Object*。********

# ruby-on-rails - rails：在每个循环中显示唯一记录

> ID：14735125
> 
> 赞同：3
> 
> 时间：2013-02-06T17:26:14.167
> 
> 标签：ruby-on-rails, ruby

我有一个产品展示页面，它在网站上显示所有产品。在这里，我想根据其所有者过滤产品。首先，我使用每个循环在页面上显示所有者名称：

```
<% @products.each do |p| %>
   <%= link_to p.user.profile.first_name, store_index_path %>
<% end %> 
```

但是由于所有者拥有多种产品，因此他的名字会多次显示。如何只显示一次名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:37:36.297

以简单的方式，您可以这样做：

```
<% @products.map(&:user).uniq.each do |u| %>
  <%= link_to u.profile.first_name, store_index_path %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:30:01.753

您可以使用 group_by 创建 User => [Products] 的哈希。然后，您遍历唯一的用户集，显示有关该所有者的信息，然后显示该用户的每个产品。

```
<% products_by_owner = @product.group_by(&:user) %>
<% products_by_owner.keys.each do |user| %>
  <%= link_to p.user.profile.first_name, store_index_path %>
  <% products_by_owner[user].each do |product| %>
    <%= link_to product.name, store_index_path %>
  <% end %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:32:01.890

您可以使用`group_by`以用户作为键和产品数组作为值来创建散列：

```
# Eager loading of users will prevent multiple database hits.
# Using find:
@products = Product.find(:all, :include => :user).group_by(&:user)

# using relations:
@products = Product.where(:some_condition => 'etc').includes(:user).group_by(&:user) 
```

在视图中：

```
<% @products.each do |user, user_products| %>
  <%= link_to p.user.profile.first_name, store_index_path %>
  <% user_products.each do |product| %>
     ...
  <% end %>
<% end %> 
```

# ios - Game Center GKTurnBasedMatch 的 matchData 属性问题

> ID：14735127
> 
> 赞同：11
> 
> 时间：2013-02-06T17:26:17.100
> 
> 标签：ios, objective-c, cocoa, game-center, gamekit

我正在创建一个带有`GKTurnBasedMatch`比赛的游戏中心游戏。我遇到了一个问题，a 上的`readonly` `matchData`属性`GKTurnBasedMatch`似乎没有正确存储在 Game Center 服务器上。

我正在使用[这个 StackOverflow 答案](https://stackoverflow.com/a/4797672/1148702)在 上生成一个 md5 校验和`matchData` `NSData`，无论是在发送到游戏中心服务器还是从游戏中心服务器接收时。

当我使用实例方法发送时，我注意到我的`NSData`游戏数据对象的校验和。`matchData``GKTurnBasedMatch``endTurnWithNextParticipants:turnTimeout:matchData:completionHandler:`

然后对手使用`GKTurnBasedMatch`的类方法检索匹配项`loadMatchesWithCompletionHandler:`，当匹配项到达时（没有错误），我再次记录校验和。

两个校验和不匹配，基于重构的游戏，结果数据显然不完全相同。我已经检查了两个帐户，`matchID`我的对象上的属性`GKTurnBasedMatch`是相同的。

我还进行了以下测试：

```
NSLog(@"matchID: %@ matchData checksum: %@",
                    match.matchID, 
                    [Utilities md5StringFromData:match.matchData]);

// match is a valid `GKTurnBasedMatch` object.
[match endTurnWithNextParticipants: @[ opponent ] // My `GKTurnBasedParticipant` opponent
                       turnTimeout:600
                         matchData:data // This is a valid NSData object
                 completionHandler:^(NSError *error) {
                      if (nil != error) {

                          NSLog(@"%@", error);

                      } else {

NSLog(@"Successfully ended turn.");

[GKTurnBasedMatch loadMatchesWithCompletionHandler:^(NSArray *matches, NSError *error) {

    if (nil != error) {

        NSLog(@"Error getting matches: %@", [error localizedDescription]);

    } else {

        for (GKTurnBasedMatch *match in matches) {

            NSLog(@"matchID: %@ matchData checksum: %@", 
                        match.matchID, 
                        [Utilities md5StringFromData:match.matchData]);

        }

    }
}];

                      }
}]; 
```

在这个示例中，我以数据结束回合并立即从 Game Center 检索匹配，即数据匹配。但是，当我`matchData`从对手的 Game Center 帐户和设备访问时，它们会有所不同。

有人遇到过这样的事情吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T19:27:11.423

[我在Apple 的 Dev Forums](https://devforums.apple.com/message/769035)上发现了解决方案。

事实证明，`loadMatchesWithCompletionHandler:`并不总是抓住最新的`matchData`. 为确保您拥有最新版本，请确保在对象上调用该`loadMatchDataWithCompletionHandler:`方法。`GKTurnBasedMatch`

# facebook - 致命错误：未捕获的 OAuthException：（#5）未经授权的源 IP

> ID：14735128
> 
> 赞同：1
> 
> 时间：2013-02-06T17:26:24.573
> 
> 标签：facebook, facebook-graph-api, ip, facebook-opengraph, facebook-oauth

我已经构建了 facebook 应用程序，但 godaddy 阻止了 IP 地址。请尽快解决。 [https://rite5.com/fbapps/adv/](https://rite5.com/fbapps/adv/) facebook 应用程序网址[https://apps.facebook.com/rite-five/](https://apps.facebook.com/rite-five/) 错误：致命错误：未捕获的 OAuthException：（#5）/home/ 中抛出未经授权的源 IP 地址第 1033 行的 content/68/9400868/html/fbapps/adv/base_facebook.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:34:14.783

这意味着您正在从一个 IP 进行 API 调用，而不是在应用`server whitelist`程序高级设置部分的应用程序设置中配置的 IP。更新此值以反映服务器的实际 IP 地址

# c - C 编程作业帮助：读入并打印格式化

> ID：14735131
> 
> 赞同：0
> 
> 时间：2013-02-06T17:26:27.823
> 
> 标签：c

这是一个 C 作业。我不是要求任何人为我做这件事，我只是碰壁了。明天就要交了，不知道怎么办。我是初学者，我的头开始受伤

编写一个 ANSI C 程序，该程序对文本进行格式化，以便它很好地适合给定数量的列。文本格式化程序必须右对齐输入文本文件，以便右边距对齐在一条直线上，但有一个例外。最后一行没有正确对齐。此外，段落不会合并在一起。输出线之间的间距应均匀分布。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>

#define IN 1
#define OUT 0

/*
   This is the start of the main pgoram which originated from the K & R word  counter...
   we comment to understand each part...
 */
int main()
{
    /*
     * This is the pointer to the file object we will be readin in
     * from...
     */
    FILE           *ptr_file;
    char           *outputbuf;

    /*
     * This variable will hold the maximum width of the line we are to
     * output
     */
    int width;
    char eatspace;
    char  c;    /* We read each character invidually */

    int   state = OUT;

    int   nc = 0;   /* This is the total count of all words in the document */
    int   nl = 0;   /* This is the total count of newlines in the document  */
    int   nw = 0;  
    int   lw = 0;   /* Count the total whitespaces spaces per line */
    int   buff_offset = 0; /* Keep track of how many letters we are into the current output line */

    /* Opens a file stream for the .txt file to be read in */
    ptr_file = fopen("hollo_man.txt", "r");
    if ((fopen("hollo_man.txt", "r")) != NULL) {
        /*
         * This loop reads in one character at a time until the end
         * of file
         */

        /* Read the first line to get the width of the output */
        fscanf (ptr_file, "%i", &width); 
        outputbuf = (char*) malloc(width + 1);
        //fscanf(ptr_file, "%c", &eatspace);

        int prev_char_was_space = 0;

        while ((c = fgetc(ptr_file)) != EOF)
        {
            ++nc;
            if (c == '\n' || strlen(outputbuf) == width) 
            {
                outputbuf[buff_offset] = '\0';      
                ++nl;
                //              printf("Saw a newline, newline count is now: %i\n", nl);
                /* Our buffer needs to be ended since we saw a newline */

                for(int i = 0; i < (width - buff_offset); i++)
                {
                    printf(" ");

                }
                printf("%s\n", outputbuf);

                memset(outputbuf, width, '\0');

                buff_offset = 0; 
                prev_char_was_space = 0;

            }

            /* This more verbose check is to see if there is other whitespace */
            else if (isspace(c)) 
            {

                /* We only store one space between words in the output, this allows us to easily and evenly pad with white space later */
                if (!prev_char_was_space)
                {

                    outputbuf[buff_offset] = c;
                    outputbuf[buff_offset + 1] = '\0';                  
                    buff_offset++;                  

                    lw++;
                    prev_char_was_space = 1;
                }   
            }
            else /* This was not a whitespace character so store it in the current line buffer */
            {

                prev_char_was_space = 0; /* Keep track that we didnt have a whitespace for the next iteration */
                outputbuf[buff_offset] = c;
                buff_offset++;
                ++nw;

            }

        } /* End reading each character */

        /* This line should indeed print output to console for now */
        //fprintf(stderr, "ORIG LINE COUNT: %d\nORIG WORD COUNT: %d\nORIG CHAR COUNT: %d\n", nl, lw, nc);
        /* Close our file and clean up */
        fclose(ptr_file);
    }

    return 0;
} 
```

它所做的只是打印出一个空白行。我想我需要另一个缓冲区，但我真的不知道。我将如何打印它，然后用填充空格均匀地间隔单词？我也不确定如何将每一行打印到指定的宽度。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:06:41.083

双fopen的小问题，应该减少到一个。

您的文件可能具有如下格式：

```
15
The quick
brown 
```

问题是您的逻辑类似于以下内容：

```
/* Opens a file stream for the .txt file to be read in */
ptr_file = fopen("hollo_man.txt", "r");
if (/*the file was opened correctly */) {

        Read 'width' from the first word of the file;
        Create a buffer exactly 'width'+1 in size;

        while(get_a_character != EOF) {
            increment_total_character_count;
            if(character_is_newline)
                increment_newline_count;
                insert a '\0' in the output buffer;
                reset the index we're inserting into the output buffer
                prevCharacterIsSpace = false;
            if(character_is_space)
                if(previous_character_NOT_a_space)
                    put_character_in_output_buffer;
                    increment_word_counter;
                    prevCharacterIsSpace = true;
            else
                prevCharacterIsSpace = true;
                put_character_in_output_buffer;
                increment_nw (never used)
        }

        needed_spaces = (width - nc) % lw;
        printf(" %s", outputbuf); 
```

如果输入文件具有上述格式，并且宽度出现在它自己的行上，那么您正在阅读的字符流如下所示：

```
'15' (read as a unit with the %i)
'\n'
'T'
'h'
...
'w'
'n'
'\n' 
```

您的字符阅读循环将换行符视为第一个字符。它将 null 插入输出缓冲区，将 prevCharacterIsSpace 设置为 false，然后继续。如果你的文件格式与我上面的匹配，你可能想通过在读入 'width' 后立即“吃掉”'\n' 来解决这个问题。

请注意，[isspace](http://www.cplusplus.com/reference/cctype/isspace/)函数对换行返回 true，所以现在换行被放入输出缓冲区的下一个槽中，并且字计数器递增（如果您在程序底部取消注释 printf，您应该会看到该效果） . `if (isspace(c))`修复可能只是为了使`else if (isspace(c))`

另一个问题是您将文件中的每一行都复制到同一个缓冲区中。因此，除了输入的最后一行之外，您无法显示任何内容。您可能需要将打印代码放在`if (c == '\n') {`块内。这将允许您在阅读时打印每一行。

这里的代码都没有处理打印右对齐文本，但一个简单的解决方案是一个小循环：

```
for (i = 0; i < (width - buff_offset); i++)
    printf(" "); 
```

在打印输出之前直接插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:42:54.060

首先不要调用`fopen("hollo_man.txt", "r")`两次，检查你的指针`if`。

那么你应该逐字阅读文件：

```
char words[1024];
char * next_word = words;
while(fscanf(ptr_file, "%s", next_word) { 
```

数一数他们的长度

```
size_t word_length = strlen(next_word);
next_word += word_length + 1; 
```

当你达到必要的宽度时打印它们：

```
total_length +=  word_length;
if (total_length > maxColumns) {
     size_t extra_spaces = total_length - word_length - 2; 
```

这有帮助吗？

这是一个完整的解决方案：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

void justify(FILE* in, FILE * out, int columns) {
    char words[1024];
    char * next_word = words;

    ssize_t total_length = 0;
    size_t num_words = 0;

    while (fscanf(in, "%s", next_word) == 1) {
        size_t word_length = strlen(next_word);
        next_word += word_length + 1;
        num_words++;
        total_length += word_length;

        if (total_length + num_words > columns) {

            size_t spaces_needed = columns - (total_length - word_length);

            int minspoaces = 1;
            if (num_words > 2) // avoids nasty floating point exception if no two words fit on a line
                minspoaces = spaces_needed / (num_words - 2);

            char * word_print = words;

            size_t chars_printed = fprintf(out, "%s",word_print);
            word_print += strlen(word_print) + 1;
            size_t spaces_printed = 0;
            ssize_t words_to_print = num_words - 2;

            fflush(out);

            while (words_to_print > 0) {
                int spaces_to_print = minspoaces;
                if (((spaces_needed - spaces_printed) % words_to_print) * 2 >= words_to_print) // spreads spaces out along the line
                    spaces_to_print++;
                spaces_printed += spaces_to_print;
                words_to_print--;
                chars_printed += fprintf(out, "%*c%s", spaces_to_print, ' ', word_print);
                word_print += strlen(word_print) + 1;
                fflush(out);
            }
            fprintf(out, "\n");

            memmove(words, word_print, (total_length = strlen(word_print)) + 1);
            num_words = 1;
            next_word = words + total_length + 1;
        }

    }

    char * word_print = words;
    while (word_print != next_word) {
        word_print += fprintf(out, "%s ", word_print);
    }

    fprintf(out, "\n");
}

int main(int argc, char ** argv) {

    int columns = atoi(argv[1]);

    FILE * in = stdin;

    if (argc >= 3 && argv[2]) {
        in = fopen(argv[2], "r");
        if (!in) {
            perror("fopen");
            return -1;
        }
    }

    justify(in, stdout, columns);

} 
```

# database - 在数据库中存储一个月中每个日期的数据

> ID：14735132
> 
> 赞同：1
> 
> 时间：2013-02-06T17:26:28.170
> 
> 标签：database, database-design

我正在创建一个程序，除了程序的功能之外，它还提供统计信息。我想添加的一件事是每天的交易数量，然后可能有一个折线图，显示交易如何按天（一个月内），然后按月，然后按年变化。我只是无法真正弄清楚如何将其转换为程序可以提取该数据并将其放入图表的数据库

会是类似的东西还是我缺少什么：？

日表；(AI)id、daynumber、dayofweek、numoftrans 外键：monthnumber、yearnumber

月表

(AI)id, monthnumber, nameofmonth, numoftrans

年表

(AI)id, yearnumber, numberoftrans

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:09:58.747

All you *need* is a table that stores dates and number of transactions.

```
create table transactions_per_day (
  transaction_date date primary key,
  num_transactions integer not null check (num_transactions >= 0)
); 
```

The number of transactions per month and per year can be done in a query with aggregate functions (SUM()) and a WHERE clause. For the total per month . . .

```
select
  extract(year from transaction_date) tr_year, 
  extract(month from transaction_date) tr_month, 
  sum(num_transactions) num_tr
from transactions_per_day
where transaction_date between '2013-01-01' and '2013-12-31'
group by tr_year, tr_month
order by tr_year, tr_month; 
```

It often makes sense to create views for the monthly totals and the annual totals.

```
create view transactions_per_month as
select
  extract(year from transaction_date) tr_year, 
  extract(month from transaction_date) tr_month, 
  sum(num_transactions) num_tr
from transactions_per_day
where transaction_date between '2013-01-01' and '2013-12-31'
group by tr_year, tr_month
order by tr_year, tr_month; 
```

# jquery - 如何让 jQuery 忽略隐藏元素

> ID：14735133
> 
> 赞同：-2
> 
> 时间：2013-02-06T17:26:33.077
> 
> 标签：jquery, html, css, hidden

我知道这很糟糕，因为你们中的大多数人都喜欢在这里看到代码。但是，我正在尝试为我的小型企业制作一个广泛的计算器，但我做错了很多事情。

请不要更正我所有的代码，那将是太多的工作。但我想知道是否有一种方法可以在隐藏元素时不对元素运行 jQuery。

对于每种产品类型和我的代码编写方式，我都有几个计算器，即使它被隐藏，它也只适用于第一个元素 ID。

这是我正在使用的计算器的链接：http: [//www.virtualbookworm.com/productioncalcnew.php](http://www.virtualbookworm.com/productioncalcnew.php)

这是JS： http: [//www.virtualbookworm.com/vbwcalcnew.js](http://www.virtualbookworm.com/vbwcalcnew.js)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T17:27:34.853

如果要选择未隐藏在选择器中的元素，简单的解决方案是使用`:visible`选择器。

例如 ：

```
var inputs = $('input:visible'); 
```

# c++ - Qt QSharedMemory 如何更新共享内存位置

> ID：14735134
> 
> 赞同：2
> 
> 时间：2013-02-06T17:26:33.723
> 
> 标签：c++, qt, shared-libraries, shared-memory, qtembedded

我有一个由 2 个不同的 Qt 应用程序链接的库（ testlib-lib.so ）。我的问题是初始化后无法更新共享内存。

```
void TestLib::createInitialSharedMemory() {

    // Create shared memory
    qDebug() << "Creating new shared memory...";
    sharedAudioMemory.setKey("globalAudioBufferSharedMemory");

    // First, test whether a shared memory segment is already attached to the process.
    // If so, detach it
    if (sharedAudioMemory.isAttached())
    {
        sharedAudioMemory.detach();
    }

    // Try to create memory of our required size
    int sizeOfSharedData = 60 * 8000 * 2; // 60 Seconds x 8 KHz * 2 Bytes ( signed short )
    if ( !sharedAudioMemory.create( sizeOfSharedData ) )
    {
      qDebug() << "ERROR: Failed to Allocate Shared Memory of size: " << sizeOfSharedData;
    }

}

void TestLib::writeToSharedMemory( QString text ) {

    // Create a buffer and data stream and some text to shove in there
    QBuffer buffer;
    buffer.open( QBuffer::ReadWrite );
    QDataStream out( &buffer );
    out << text;
    int size = buffer.size();

    if (!sharedAudioMemory.attach()) {

        // If an attempt of reading from the shared memory before data is written
        qDebug() << "Cannot attach to shared memory to update!";

    }

    // Write into the shared memory
    sharedAudioMemory.lock();
    qDebug() << "Writing data to buffer: " << text;
    char *to = (char*)sharedAudioMemory.data();
    const char *from = buffer.data().data();
    memcpy( to, from, qMin( sharedAudioMemory.size(), size ) );
    sharedAudioMemory.unlock();

} 
```

Qt App A 在它的 main() 中有以下内容：

```
// Create the shared memory and load some data
TestLib loadData;
loadData.createInitialSharedMemory();
loadData.writeToSharedMemory("12345 init shared memory");

// This is the key
QSharedMemory sharedAudioMemory("globalAudioBufferSharedMemory");

// Attempt to attach to shared memory for the audio buffer
if (!sharedAudioMemory.attach()) {

    //If an attempt of reading from the shared memory before data is written
    qDebug() << "ERROR: Failed to attach to shared memory...";
    return -1;

}

// Define a buffer to read the data in
QBuffer buffer;
QDataStream in(&buffer);
QString text;

// Lock the memory and read the data
sharedAudioMemory.lock();
char* pointer = (char*)sharedAudioMemory.constData();
buffer.setData((char*)sharedAudioMemory.constData(), sharedAudioMemory.size()); // Sets the contents of the internal buffer to be the first size bytes of data.
buffer.open(QBuffer::ReadOnly);
in >> text;
sharedAudioMemory.unlock();
sharedAudioMemory.detach(); 
```

Qt App B，尝试通过执行以下操作更新共享内存：

```
void Control::updateText() {

    // Create seed for the random
    // That is needed only once on application startup
    QTime time = QTime::currentTime();
    qsrand((uint)time.msec());

    // Get random value between 0-100
    int randomValue = qrand() % ((1000 + 1) - 2) + 2;

    // Create the shared memory and load some data
    TestLib loadData;
    QString randomText = QString("%1 test asdf %2 test asdf %3 test asdf %4").arg(randomValue).arg(randomValue).arg(randomValue).arg(randomValue);
    loadData.writeToSharedMemory(randomText);

} 
```

将共享内存初始化为“12345 init shared memory”后，我似乎无法更新那里的文本存储。当我在 App B 中调用 updateText() 方法时，会调用库方法 writeToSharedMemory() 并且该方法中的 qDebug() 会打印我希望在共享内存中更新的文本，但是当我在尝试之后调用以下代码时更新共享内存，它总是打印原始初始文本“12345 init shared memory”：

```
// Attempt to attach to shared memory for the audio buffer
if (!sharedAudioMemory.attach()) {

    // If an attempt of reading from the shared memory before data is written
    qDebug() << "ERROR: Failed to attach to shared memory...";

}

// Define a buffer to read the data in
QBuffer buffer;
QDataStream in(&buffer);
QString text;

// Lock the memory and read the data
sharedAudioMemory.lock();
char* pointer = (char*)sharedAudioMemory.constData();
buffer.setData((char*)sharedAudioMemory.constData(), sharedAudioMemory.size()); // Sets the contents of the internal buffer to be the first size bytes of data.
buffer.open(QBuffer::ReadOnly);
in >> text;
sharedAudioMemory.unlock();
sharedAudioMemory.detach();

// Print the data
qDebug() << "SHARED TEXT IS: " << text; 
```

为什么我似乎无法更新共享内存？我究竟做错了什么？谢谢 -

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:20:27.690

我在这里打印出 'errorString()' 后发现了错误：

```
if (!sharedAudioMemory.attach()) {

        // If an attempt of reading from the shared memory before data is written
        qDebug() << "Cannot attach to shared memory to update! ERROR: " << sharedAudioMemory.errorString();

} 
```

没有关联的密钥，因此它没有分离。所以我将此功能更改为：

```
// Assign the key so we can update the data
sharedAudioMemory.setKey("globalAudioBufferSharedMemory");
if (!sharedAudioMemory.attach()) {

    // If an attempt of reading from the shared memory before data is written
    qDebug() << "Cannot attach to shared memory to update! ERROR: " << sharedAudioMemory.errorString();

} 
```

它有效——我可以很好地修改共享内存。

# java - Java，确保用户不在字符串中输入数字

> ID：14735138
> 
> 赞同：2
> 
> 时间：2013-02-06T17:27:04.967
> 
> 标签：java, swing, numbers, pattern-matching, joptionpane

我正在尝试用 Java 创建一个基于文本的游戏，我会询问用户名并将其插入到游戏中。我试图用他们输入的字符串来评估任何数字。即`09452`或`asdf1234`。

这是与问题相关的代码。

```
String name, choiceSelection;
int choice;
name = JOptionPane.showInputDialog(null, "Enter your name!");

//CHECKS IF USER ENTERED LETTERS ONLY
if (Pattern.matches("[0-9]+", name))
{
    throw new NumberFormatException();
} 
else if (Pattern.matches("[a-zA-Z]+", name)) 
{
    if (Pattern.matches("[0-9]+", name))
    {
        throw new NumberFormatException();
    }
} 
```

我试图弄清楚字符串中是否有任何数字，如果是，则抛出一个`NumberFormatException`，以便他们知道他们没有遵循正确的提示。

确保用户不在`name`字符串中输入数字的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:29:32.690

您可以使用更简单的检查：

```
if (!name.replaceAll("[0-9]", "").equals(name)) {
    // name contains digits
} 
```

该[`replaceAll`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)调用从 中删除所有数字`name`。`equals`仅当没有要删除的数字时，检查才会成功。

请注意，`NumberFormatException`在这种情况下抛出会产生误导，因为异常具有非常不同的含义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:45:47.560

首先考虑使用[`JFormattedTextField`](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)或输入验证器来防止用户输入数字。对于一次性项目来说，失去 JOptionPane 的简单性可能不值得，但它为最终用户简化了事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:52:01.957

或者，您根本不允许用户在 .For 中输入任何数值`textField`。为此，您需要创建自定义`PlainDocument`说`NonNumericDocument`并将`Document`JTextField 对象设置为自定义`NonNumericDocument`

```
import java.awt.BorderLayout;
import javax.swing.JFrame;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.text.Document;
import javax.swing.text.PlainDocument;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;

class NonNumericDocument extends PlainDocument 
{
    @Override
    public void insertString(int offs, String str, AttributeSet a) throws BadLocationException 
    {
        if (str == null) 
        {
            return;
        }
        char[] arr = str.toCharArray();
        for (int i = 0; i < arr.length; i++) 
        {
            if (Character.isDigit(arr[i]) || !Character.isLetter(arr[i]))//Checking for Numeric value or any special characters
            {
                return;
            }
        }
        super.insertString(offs, new String(str), a);
    }
}
//How to use NonNumericDocument
class  TextFrame extends JFrame
{
    JTextField tf ;
    public void prepareAndShowGUI()
    {
        tf = new JTextField(30);
        tf.setDocument(new NonNumericDocument());//Set Document here.
        getContentPane().add(tf,BorderLayout.NORTH);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setVisible(true);
    }
    public static void main(String[] args) 
    {
        SwingUtilities.invokeLater ( new Runnable()
        {
            @Override
            public void run()
            {
                TextFrame tFrame = new TextFrame();
                tFrame.prepareAndShowGUI();
            }
        });
    }
} 
```

您可以将它`NonNumericDocument`与代码中的任何 JTextField 一起使用，而无需担心`non-numeric`显式处理字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T18:14:12.917

另一种检查方法是使用`parseInt( String s )`方法：

```
private boolean isNumber( String s ) {
    try {
        Integer.parseInt( s );
    } catch ( Exception e ) {
        return false; // if it is not a number it throws an exception
    }
    return true;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T17:37:44.483

如果你想让用户只输入字母，你可以这样做：

```
if (name.matches("\\p{Alpha}+")) {
    // name contains only letters
} 
```

# java - 加载由 int[][] 中的数字定义的对象，isTopLeft() 不起作用

> ID：14735149
> 
> 赞同：0
> 
> 时间：2013-02-06T17:27:38.107
> 
> 标签：java, arrays

我正在通过每个数字为 10px 的 2d 数组加载游戏地图。下面是一个文件示例：

```
"level_1_1.png", ?600:400?;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; 
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
1,1,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
1,1,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
1,1,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
1,1,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
1,1,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;
0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0;
 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0; 
```

1是平台，2是播放器。我通过检查我是否位于已定义对象的左上角来加载它们（平台为 20x20，因此将是 2x2 正方形）。我通过向后计数行和列并将该数字修改为预期宽度（以数十像素为单位）来做到这一点。

这是 isTopLeft 的代码：

```
 private boolean isTopLeft(int item, int r, int c, String[][] map){
    //width and height measured in # of map "steps" (10px ea)
    int width = 0;
    int height = 0;

    if(item == 0){

    }else if(item == 1){
        width = platformWidth/10;
        height = platformHeight/10;
    }else if(item == 2){
        width = playerWidth/10;
        height = playerHeight/10;
    }else if(item == 3){

    }else if(item == 4){

    }else if(item == 5){

    }else if(item == 6){

    }else if(item == 7){

    }else if(item == 8){

    }else if(item == 9){

    }

    //counts backwards and upwards to see how many blocks of the same type preceed it.
    int curR = r - 1;
    int prevWidthCount = 0;
    int prevHeightCount = 0;
    while(curR >= 0 && map[curR][c] == "" + item){
        curR -= 1;
        prevWidthCount += 1;
    }
    int curC = c - 1;
    while(curC >= 0 && map[r][curC] == "" + item){
        curC -= 1;
        prevHeightCount += 1;
    }

    if(prevWidthCount % width == 0 && prevHeightCount % height == 0){
        return true; 
    }

    return false;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:47:57.647

让我印象深刻的一件事是：

```
while(curR >= 0 && map[curR][c] == "" + item)

while(curC >= 0 && map[r][curC] == "" + item) 
```

您正在使用`==`. 这是一个相对常见的错误，真的很痛苦——你必须用`String.equals()`Java 来比较两个字符串。

# php - PHP 自定义会话管理类

> ID：14735152
> 
> 赞同：0
> 
> 时间：2013-02-06T17:27:48.450
> 
> 标签：php, session, static, try-catch

所以我有一个我正在处理的课程来管理 PHP 会话，这是课程：

```
class SessionManagement {
    public static function sessionStarted() {
        if(session_id() == '') {
            return false;
        } else {
            return true;
        }
    }
    public static function sessionExists($session) {
        if(sessionStarted() == false) {
            session_start();
        }
        if(isset($_SESSION[$session])) {
            return true;
        } else {
            return false;
        }
    }
    public static function setSession($session, $value) {
        if(sessionStarted() != true) {
            session_start();
        }
        $_SESSION[$session] = $value;
        if(sessionExists($session) == false) {
            throw new Exception('Unable to Create Session');
        }
    }
    public static function getSession($session) {
        if(isset($_SESSION[$session])) {
            return $_SESSION[$session];
        } else {
            throw new Exception('Session Does Not Exist');
        }
    }
} 
```

现在尝试这个...

```
try {
    SessionManagement::setSession('Foo', 'Bar');

    echo SessionManagement::sessionStarted();
    echo SessionManagement::getSession('Foo');
    echo SessionManagement::sessionExists('Foo');
} catch(Exception $e) {
    echo $e->getMessage();
} 
```

...不产生任何输出...我不确定我们在哪里打破...非常感谢任何有用的眼睛...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T10:53:40.133

与其他 OO 语言（如 C++）不同，在您的类中 PHP 需要知道调用的静态方法来自*该*对象。对于一个实例化的类，这将是通过`$this`，在你的情况下，静态方法，这是通过`self`：

```
class SessionManagement {
    public static function sessionStarted() {
        if(session_id() == '') {
            return false;
        } else {
            return true;
        }
    }
    public static function sessionExists($session) {
        if(self::sessionStarted() == false) {
            session_start();
        }
        if(isset($_SESSION[$session])) {
            return true;
        } else {
            return false;
        }
    }
    public static function setSession($session, $value) {
        if(self::sessionStarted() != true) {
            session_start();
        }
        $_SESSION[$session] = $value;
        if(self::sessionExists($session) == false) {
            throw new Exception('Unable to Create Session');
        }
    }
    public static function getSession($session) {
        if(isset($_SESSION[$session])) {
            return $_SESSION[$session];
        } else {
            throw new Exception('Session Does Not Exist');
        }
    }
} 
```

预先`self::`对`SessionManagement`静态方法的所有内部调用应该可以解决您的问题。

# php - Android 不会使用 JSON 向 PHP 发送数据

> ID：14735153
> 
> 赞同：1
> 
> 时间：2013-02-06T17:27:47.470
> 
> 标签：php, android, mysql, json, send

我正在尝试创建一个可以使用 JSON 将数据发送到 PHP 服务器的 android 应用程序。我遵循了本指南：[http](http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/) ://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/这是我的 Android 代码：

```
import java.util.ArrayList;
import java.util.List;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class HelloWorldActivity extends Activity {

    JSONParser jsonParser = new JSONParser();
    EditText userName;

    // url to create new product
    private static String url = "http://192.168.1.35/workspace/sosapp/db_connect.php";    

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Edit Text
        userName = (EditText) findViewById(R.id.userName);

        // Send button
        Button sendButton = (Button) findViewById(R.id.sendButton);

        // button click event
        sendButton.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                String name = userName.getText().toString();

                // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("name", name));

                // getting JSON Object
                JSONObject json = jsonParser.makeHttpRequest(url, "POST", params);

            } 
        }); 

    }
} 
```

至于我的 PHP 代码：

```
 function insert($var1) {

    // mysql inserting a new row
    $result = mysql_query("INSERT INTO report (name) VALUES ('$var1')");

    // check if row inserted or not
    if ($result) {
        // successfully inserted into database;
    $msg = "Message received.";
    } else {
    $msg = "Not received.";
    }
return ($msg);
}

if (isset($_POST['name'])) {
   $name = $_POST['name']);
   insert($name);   
} else {
   echo "No input.";
} 
```

我一直没有输入。我运行 android 应用程序（在连接到计算机的手机上），然后刷新 PHP 站点，但一直没有输入。android 应用程序不发送数据。有人可以帮忙吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T19:18:04.277

据我所知，它是本教程的 JSONParser 类。它检查

```
method == "POST" 
```

这是错误的。将此更改为

```
method.equals("POST") 
```

看看它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-05T15:08:59.617

Android Http 仅允许后台运行

```
import java.util.ArrayList;
import java.util.List;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class HelloWorldActivity extends Activity {

    JSONParser jsonParser = new JSONParser();
    EditText userName;

    // url to create new product
    private static String url = "http://192.168.1.35/workspace/sosapp/db_connect.php";    

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Edit Text
        userName = (EditText) findViewById(R.id.userName);

        // Send button
        Button sendButton = (Button) findViewById(R.id.sendButton);

        // button click event
        sendButton.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                String name = userName.getText().toString();

                // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("name", name));

                // getting JSON Object

            Thread httpthread=new Thread(new Runnable() {
            @Override
            public void run() {

          JSONObject json = jsonParser.makeHttpRequest(url, "POST", params);

  runOnUiThread(new Runnable(){
            @Override
             public void run() {
                 // ui working  ex)textview.setText("test");

             }
        });

            }
        });

httpthread.start();
            } 
        }); 

    }
} 
```

# php - 防止 Mp3 播放器（在我们网站的 iFrame 中运行）嵌入到其他地方？

> ID：14735162
> 
> 赞同：1
> 
> 时间：2013-02-06T17:28:11.883
> 
> 标签：php, security, iframe, embed, hotlinking

我们有一个通过 iFrame 运行的 mp3 播放器，这不是我们的选择，而是我们坚持使用它的方式。我们希望防止其他人简单地将 iframe 嵌入他们的网站。

最好的方法是什么？我们正在运行 nginx，所以没有 .htaccess。mp3 播放器由 php 文件组成，我们需要在 iframe 中继续运行它。

无论如何锁定特定的 mp3 播放器 php 文件（在本例中为 html5player.php）只能在我们的服务器或域名上执行？当然有办法在 nginx 中做到这一点？但是当然，如​​果他们嵌入 iFrame，它会认为它正在我们的服务器上运行，不是吗？

我想到的所有解决方案在此过程中都落在了某个地方，因此非常感谢您的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:37:00.650

您可以在 iframe 中检查父窗口的 URL，并检查它是否与您的域匹配......然后相应地显示 mp3 播放器或拒绝访问。

在 iframe 内的 javascript 中使用以下内容：

```
if(top.location.href == "http://mysite.com"){
        //display mp3 player
        } 
//or don't display mp3 player 
```

# linux-kernel - 传递给 put_user() 的指针类型很重要吗？

> ID：14735163
> 
> 赞同：1
> 
> 时间：2013-02-06T17:28:15.643
> 
> 标签：linux-kernel, linux-device-driver

在为连接到旧 PowerPC 的自定义硬件的字符设备驱动程序编写 IOCTL 时，我发现了一个奇怪的问题。这是我的代码的抽象：

```
u32 mydev_data;

...

static long mydev_ioctl(struct file * file, unsigned int cmd, unsigned long arg)
{
    void __user *user_arg = (void __user *)arg;
    long result;

    switch(cmd) {

    case MYDEV_GETDATA:
        result = put_user(mydev_data, user_arg);
        break;

    ...
    }

    return result;
} 
```

现在，这会返回垃圾。但是，当我更换线路时

```
result = put_user(mydev_data, user_arg); 
```

和

```
result = put_user(mydev_data, (unsigned long __user *) user_arg); 
```

问题消失了。

这里发生了什么？由于 user_arg 被标记为 __user *，唯一的区别是 void 与 unsigned long。但我认为指针类型在这里并不重要。显然我错了，但有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:50:48.863

如果您查看`put_user`宏的定义，您会看到它根据大小复制数据，`sizeof(*ptr)`并确定要复制多少字节。`sizeof(void) == 1`, 但`sizeof(unsigned long)`更大。

```
#define __put_user_check(x, ptr, size)                                  \
({                                                                      \
        long __pu_err = -EFAULT;                                        \
        __typeof__(*(ptr)) __user *__pu_addr = (ptr);                   \
        might_sleep();                                                  \
        if (access_ok(VERIFY_WRITE, __pu_addr, size))                   \
                __put_user_size((x), __pu_addr, (size), __pu_err);      \
        __pu_err;                                                       \
})

#define put_user(x, ptr) \
  __put_user_check((__typeof__(*(ptr)))(x), (ptr), sizeof(*(ptr))) 
```

# algorithm - 如果每个点的每个坐标都是有理数，则 O(n) 时间内的凸包

> ID：14735164
> 
> 赞同：2
> 
> 时间：2013-02-06T17:28:17.313
> 
> 标签：algorithm, computational-geometry, convex-hull

> 证明如果每个点的每个坐标都是 p/q 形式的有理数，并且 p 和 q 的值有界，则可以在**O(n)**时间内计算平面中**n**个点的凸包。

 **注意：*这是一个家庭作业问题。我可以通过某种方式避免扫描所有点来考虑使用 Jarvis March。也许这可以通过向固定方向（使用有理条件）投射光线来检查下一个点存在的位置来完成*。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T18:48:53.107

不要使用 Jarvis March，因为它的时间复杂度为`O(nh)`. 在最坏的情况下，`h`可能大到`n`。请注意，这`h`是船体上的点数。

相反，您应该使用[时间](http://en.wikipedia.org/wiki/Graham_scan)复杂度为`O(nlogn)`. 在格雷厄姆扫描算法中，时间复杂度主要由对所有点排序的时间复杂度决定。请注意，基于比较的排序算法的时间复杂度为`O(nlogn)`.

在您的作业问题中，您可以使用[基数排序](http://en.wikipedia.org/wiki/Radix_sort)而不是任何基于比较的排序算法来击败上限，`O(nlogn)`因为假设点的坐标都是有界的。请注意，当要排序的输入是有界基数排序时，可以使用复杂度为`O(n)`.

有关各种凸包算法的比较，请参见[此处。](http://en.wikipedia.org/wiki/Convex_hull_algorithms)**

# jquery-mobile - 无法在页面转换 Jquery Mobile 上清空下拉列表

> ID：14735166
> 
> 赞同：0
> 
> 时间：2013-02-06T17:28:19.637
> 
> 标签：jquery-mobile

我在使用单页方法时遇到问题。当我移动到“过滤器页面”时，我想通过 ajax 填充应用程序列表，我在这里模拟了调用。

```
function populateList()
{
     $('#drpApplication').empty().listview('refresh');
     if (typeof cache["FilterCounter"] == "undefined") {

                    cache["FilterCounter"] = 1;
                }
        var listItem = "<option value=" + '\'' + '1' + '\'' + ">" + 'Name1' + "</option>";
      $('#drpApplication').append(listItem);
            var listItem2 = "<option value=" + '\'' + '2' + '\'' + ">" + 'Name2' + "</option>";
      $('#drpApplication').append(listItem2);
            var listItem3 = "<option value=" + '\'' + '3' + '\'' + ">" + 'Name3' + "</option>";
      $('#drpApplication').append(listItem3);

} 
```

单击应用会将我转到另一个页面，然后当我返回过滤器页面时，应用程序列表会附加一组新数据。尽管我告诉它先清空下拉列表。同样在下拉列表中选择一个应用程序是假设将选择添加到页面上的另一个列表视图

```
 $('#drpApplication').change(function () {

        $("#drpApplication option:selected").each(function () {
            var filterItemId = 'liApplicationName' + cache["FilterCounter"].toString();
            $('#lstApplicationList').append('<li value="' + $(this).val() + '" id="' + filterItemId + '"data-icon="delete"><a onclick="removeFilterItem(\'' + filterItemId + '\')">' + $(this).text() + '</a></li>').listview('refresh');
            cache["FilterCounter"] = cache["FilterCounter"] + 1;
        });

    }).change(); 
```

在后续访问中会发生什么情况，当您从下拉列表中选择一个应用程序时，它会在第二次访问时在列表视图中放置 2 个相同条目，在第 3 次访问页面时每 1 个选项放置 3 个条目，依此类推。

似乎 DOM 正在缓存其内容或其他东西，我无法阻止它？

我为此启动了一个 jfiddle，但我填充列表的功能没有运行。我刚开始使用 jfiddle，所以也许我的模拟设置不正确？

[http://jsfiddle.net/D2gbq/27/](http://jsfiddle.net/D2gbq/27/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T00:47:33.237

看起来您正在清空选择，然后刷新列表视图，然后附加新选项。*附加选项后*，您需要刷新列表视图以使它们出现。

尝试这个：

```
function populateList()
{
  $('#lstApplicationList').empty();
  $('#drpApplication').empty();

  if (typeof cache["FilterCounter"] == "undefined") {
    cache["FilterCounter"] = 1;
  }
    var listItem = "<option value=" + '\'' + '1' + '\'' + ">" + 'Name1' + "</option>";
    $('#drpApplication').append(listItem);

    var listItem2 = "<option value=" + '\'' + '2' + '\'' + ">" + 'Name2' + "</option>";
    $('#drpApplication').append(listItem2);

    var listItem3 = "<option value=" + '\'' + '3' + '\'' + ">" + 'Name3' + "</option>";
    $('#drpApplication').append(listItem3);

    $('#lstApplicationList').listview('refresh');
    $('#drpApplication').listview('refresh');
} 
```

# qtp - QTP点击webbutton关闭对话框

> ID：14735167
> 
> 赞同：0
> 
> 时间：2013-02-06T17:28:21.890
> 
> 标签：qtp

我在一个有弹出窗口的页面上。此弹出窗口中有一个列表。我应该首先在列表中选择一个元素，然后激活一个链接并单击此链接。然后出现另一个弹出窗口。现在，我必须单击新弹出窗口中的一个按钮。QTP 捕获的按钮存储在 Page 对象的正下方。

声明很简单：

```
Browser(Browser).Page(Page).WebButton("Button").Click 
```

但是我的问题是，点击这个WebButton后，新的弹窗消失了，主弹窗列表中选中的值被重置为默认值（未选中）。在调试模式下，没有这个问题......

我尝试了所有解决方案，“ReplayType”仍然使弹出窗口关闭，“DeviceReplay”，GetROProperty返回的“abs_x”和“abs_y”与使用Object Spy捕获的值不同。所以我不能点击正确的位置。

有人可以在这里启发我如何解决这个问题吗？

非常感谢

艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T07:34:21.843

您必须编写描述性程序才能单击该特定弹出窗口上的按钮。窥探按钮并在 qtp 中编写脚本，不要将该对象存储在对象存储库中。

对于按钮，使用 html 标签或名称来识别对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T05:41:06.883

使用这个录制的脚本，Browser(Browser).Page(Page).WebButton("Button").Click

1）。完成录制后，转到 OR 并找到 Unique 属性，比如在录制时间时，QTP 采用了哪些属性，基于你可以做到的（主要是如果你想使用 QTP 识别任何 web 对象，它的**名称/索引**属性值）

2）。最好的事情是需要使用 Objectspy 编写描述性编程

# python - 使用 Python 管理文本和页面

> ID：14735168
> 
> 赞同：0
> 
> 时间：2013-02-06T17:28:25.643
> 
> 标签：python, sorting, text

我的代码使用 Tkinter、Regex 和 datetime 模块从我们的客户那里获取事件报告电子邮件，并按他们的设施 ID（它写在每个报告上）和事件日期对它们进行排序。

它通过要求用户首先选择设施文件（必须以特定方式组织）、事件文件（也具有特定模式，但本质上是从我们的电子邮件中下载到 txt 文件中的一系列电子邮件）来做到这一点客户端），以及要写入的空白文件。

一切正常，但问题是现在，我需要能够每页写**一个事件报告**，而不是有一个连续的文本块。

我不知道该怎么做。办公室中的所有计算机都安装了 MS Word，因此最好直接在 Word 中写入每页一份事件报告，或者找到一种方法来管理最终文本文件中每页的内容。如果您想查看完成整个过程的代码，我在下面发布了一个链接。谢谢！

[https://github.com/hillmandj/sort_bot/blob/master/MedTech.py](https://github.com/hillmandj/sort_bot/blob/master/MedTech.py)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:14:31.283

一种简单的方法是将输出格式化为 HTML。使您的文本文档如下所示：

```
<html>
<head>
<style>
hr {
page-break-before: always;
}
</style>
</head>
<body>
<pre>
report 1 text 
here
</pre>
<hr>
<pre>
report 2 
text here
</pre>
<hr>
<pre>
report 
3 text here
</pre>
</body>
</html> 
```

还要使用`.html`扩展名保存文件。当用户打开文件时，它将在网络浏览器中打开（在大多数计算机上）。每次`<hr>`出现在文件中时，从 Web 浏览器打印都会开始一个新页面。

# java - 正则表达式用空格和双引号在java中标记字符串

> ID：14735171
> 
> 赞同：2
> 
> 时间：2013-02-06T17:28:31.900
> 
> 标签：java, regex

我正在尝试创建一个正则表达式来标记字符串。一个示例字符串是。

```
"hello world" Alexandros Alex "I Am" Something 
```

我需要得到回应：

```
hello world
Alexandros
Alex 
I am
Something 
```

因此，为了清楚起见，使用空格而不是引号内的单词进行标记。如果这是一个简单的正则表达式，请提前抱歉，但我总是与这些作斗争。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:40:18.977

你可以试试：`\b(?:(?<=")[^"]*(?=")|\w+)\b`。这将从匹配项中排除实际报价。

```
import java.util.regex.*;
public class Test {
    public static void main(String...args) {
        String line = "\"hello world\" Alexandros Alex \"I Am\" Something";
        Pattern pattern = Pattern.compile("\\b(?:(?<=\")[^\"]*(?=\")|\\w+)\\b");
        Matcher matcher = pattern.matcher(line);
        while (matcher.find()) {
            System.out.println(matcher.group(0));
        }
    }
} 
```

执行时，您会得到以下输出：

```
$ javac Test.java
$ java Test
hello world
Alexandros
Alex
I Am
Something 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:36:19.920

此正则表达式将匹配引号内的单词或整个字符串：`"[^"]*"|\w*`

您可以使用此正则表达式创建一个匹配器，然后遍历所有匹配项。[你可以在这里](http://www.vogella.com/articles/JavaRegularExpressions/article.html)找到一些示例代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:42:27.467

如果要**拆分**，可以通过检查是否`"`平衡来实现。

现在显然，如果空间之间`""`的数量`"`不会是偶数..这就是下面`regex`要做的

```
\s(?=(?:([^"]*"[^"]*"[^"]*)*|[^"]*)$) 
```

# objective-c - 字符串求值中的布尔公式

> ID：14735172
> 
> 赞同：2
> 
> 时间：2013-02-06T17:28:33.943
> 
> 标签：objective-c

我将公式存储`1 && !0 && (0 || 1)`在`NSString`变量中。我需要将此字符串评估为单个布尔值。有谁知道用于处理此或第 3 方解决方案的内置 obj-c 对象？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:25:13.320

我认为[`[NSPredicate parseWithFormat:]`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSPredicate_Class/Reference/NSPredicate.html#//apple_ref/occ/clm/NSPredicate/predicateWithFormat%3a)并且[`[NSPredicate evaluateWithObject:]`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSPredicate_Class/Reference/NSPredicate.html#//apple_ref/occ/instm/NSPredicate/evaluateWithObject%3a)可以在这里提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:08:52.550

Short of parsing it yourself, you won't be able to evaluate an expression like that in Objective-C during runtime since it is not an interpreted language.

Here are just a few (of many) other resources that pretty much echo this:

*   [eval in Objective-C](https://stackoverflow.com/questions/10158036/eval-in-objective-c)
*   [Is there something like Matlab's eval statement in Objective-C 2.0?](https://stackoverflow.com/questions/1116885/is-there-something-like-matlabs-eval-statement-in-objective-c-2-0)
*   [“eval” for Objective-C code](https://stackoverflow.com/questions/2550897/eval-for-objective-c-code)

[This post](https://stackoverflow.com/questions/9651333/evaluate-math-expression-in-string-nsstring) may get you a step closer to what you are trying to achieve. In any scenario, you will have to parse it yourself.

# mysql - 还有一个“您的 SQL 语法有错误”

> ID：14735173
> 
> 赞同：-3
> 
> 时间：2013-02-06T17:28:36.907
> 
> 标签：mysql

我计算了我的字段，检查了我的类型等。这是多行插入的第一个。为什么不这样：

```
(6972561736,'2013-02-06 04:29:17',85,'CONCORD',1000125,'First Last',92596384,'Airmia',30000166,11000.00,175697113.47,'21656:2,',,,92596384) 
```

适合

```
Table xact    
==========    
refID, date, refTypeID, ownerName1, ownerID1, ownerName2, ownerID2, argName1, argID1, amount, balance, reason, taxReceiverID, taxAmount, charID

----------

refID            int(11) PK    
date             datetime    
refTypeID        bigint(20)    
ownerName1       varchar(45)    
ownerID1         int(11)    
ownerName2       varchar(45)    
ownerID2         int(11)    
argName1         varchar(45)    
argID1           int(11)    
amount           decimal(16,4)    
balance          decimal(16,4)    
reason           varchar(64)    
taxReceiverID    int(11)    
taxAmount        decimal(16,4)    
charID           int(11) 
```

实际错误：

...在第 1 行的 ',92596384),(6972540458, '2013-02-06 04:23:30',34,'Istei Poyri',3018350,'First ' 附近使用的正确语法

6972540458 是下一条记录的开始...

完整的查询是8355个字符，所以我希望我已经给出了足够的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:32:23.537

如果您没有列的数据，则添加`null`（如果允许）或默认值，而不是像

```
,,,92596384)
 ^-----------------here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:31:57.513

如果没有看到完整的错误，我建议用`,,,`值替换`null`：

```
,'21656:2,',null,null,92596384) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:32:07.277

尝试在逗号之间传递`NULL`或空引号`''`而不是空引号。

```
(6972561736,'2013-02-06 04:29:17',85,'CONCORD',1000125,'First Last',92596384,'Airmia',30000166,11000.00,175697113.47,'21656:2,',NULL,NULL,92596384) 
```

**可能是因为在21656:2**之后还有一个逗号。

```
(6972561736,'2013-02-06 04:29:17',85,'CONCORD',1000125,'First Last',92596384,'Airmia',30000166,11000.00,175697113.47,'21656:2',NULL,NULL,NULL,92596384) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:32:35.133

```
check '21656:2' and you had added an extra column 

   (6972561736,'2013-02-06 04:29:17',85,'CONCORD',1000125,'First Last',92596384,'Airmia',30000166,11000.00,175697113.47,'21656:2',,,92596384) 
```

# c# - 在主窗体上定位对话框窗体

> ID：14735175
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:28:49.010
> 
> 标签：c#

我是新用户并使用 Winform。我在主表单应用程序上定位子表单对话框时遇到问题。我想将它移动到主窗体窗口的右下角，但我的代码不起作用。我不明白。请帮我 。

```
 basketForm = new Basket();
        basketForm.Owner = this;
        basketForm.Show();
        Point pt = new Point(0, 0);
        pt.X = this.Right - basketForm.Width;
        pt.Y = this.Bottom - basketForm.Height;
        pt = this.PointToScreen(pt);
        basketForm.Location = pt; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:38:21.513

您需要在显示窗口之前设置点配置。

# html - 如何在不使用完全限定域名的情况下从不安全页面发布到安全服务？

> ID：14735177
> 
> 赞同：0
> 
> 时间：2013-02-06T17:28:55.847
> 
> 标签：html, https

我想在不使用完全限定域名的情况下发布一个位于非安全页面上的表单。

[http://www.domain.com/page.aspx](http://www.domain.com/page.aspx)

发布到同一域上的安全服务

[https://www.domain.com/service.aspx](https://www.domain.com/service.aspx)

我目前正在做这个工作。

```
<form action="https://www.domain.com/service.aspx" id="formId" method="POST"> 
```

主要问题是我们有网站的 QA 版本

[http://qa.domain.com/page.aspx](http://qa.domain.com/page.aspx) [https://qa.domain.com/service.aspx](https://qa.domain.com/service.aspx) 这里的表单看起来像

```
<form action="https://qa.domain.com/service.aspx" id="formId" method="POST"> 
```

并且存在一些发布问题，因为当我们从 qa 发布到 prod 时，我们必须手动更新域名。

我想做的是以某种方式指向

```
<form action="/service.aspx" id="formId" method="POST"> 
```

但使表单使用前缀 https。我们可以在表单中动态编写 URL，但我一直在寻找一种使用 HTML 的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:32:14.580

你不能用 URL 语法来做到这一点。您必须始终在构建相对 URL 时更改的 URL 组件右侧重述任何内容。

您可以通过编程方式生成 URL（最好使用服务器端代码）。

请注意，根据我对这个问题的评论，[您不应该这样做](https://stackoverflow.com/questions/14704304/is-a-post-action-to-a-secure-domain-always-secure/14704335#14704335)。

# javascript - JavaScriptMVC 和 Ruby on Rails 集成在一个应用程序中

> ID：14735179
> 
> 赞同：1
> 
> 时间：2013-02-06T17:28:59.293
> 
> 标签：javascript, ruby-on-rails-3, model-view-controller, javascriptmvc

我在这里搜索过，只找到一个类似的主题没有答案。我参与过几个 JavaScript MVC 项目，并且了解它是如何工作的。我对 Ruby on Rails 不那么精通，但我正在学习。现在我知道我有一些从 JMVC 调用 Ruby 控制器的代码。我的问题是如何用 JMVC 视图替换 Ruby 视图？基本上，我希望调用 JMVC 视图而不是 Ruby 视图。有人做过吗？任何示例代码都会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T14:24:57.397

如果您以通常的方式设置 jsMVC，则可以交换视图/插件，这将调用 ruby​​ 控制器

# jquery - JQuery 空选择器和设置值

> ID：14735181
> 
> 赞同：2
> 
> 时间：2013-02-06T17:29:00.307
> 
> 标签：jquery

如果以下选择器的长度为 0

```
$(".my_class") 
```

我试着做`$(".my_class").attr('value', 'test');`

它不会导致任何错误，但我应该先检查长度吗？什么被认为是最佳实践？

我有一堆可能存在也可能不存在的属性，我想知道是否可以设置一个空的 jquery 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:30:15.153

不，你不应该先测试长度，这和做一样没用

```
if (n>0) {
 for (i=0; i<n; i++) { 
```

事实上，这正是同一件事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:31:37.703

You don't need to test for length or anything first because jQuery returns an empty jQuery wrapped object, which is why you are even still able to run the method `.attr()` and it doesn't blow up on you!

This is definitely one of the many reasons jQuery is so powerful and easy to use for develoeprs.

# algorithm - 这个程序的确切复杂性是多少？

> ID：14735184
> 
> 赞同：1
> 
> 时间：2013-02-06T17:29:06.937
> 
> 标签：algorithm, complexity-theory

有人给我这段代码，我想找到确切的复杂性，或者换句话说，找到一个公式，让特定的 n 知道如何计算 L。

```
L = 0;
for (i = 1; i<n; i++)
    for (j = 1; j<i; j++)
        for (k = j; k<n; k++)
            L++; 
```

我的第一个想法是 (n^3 + n^2)/2，但这是错误的。

例如 n=5 L=20 ；n=10 升=240

感谢：D

编辑：这个问题来自算法基础，第 140 页或 pdf 中的幻灯片 161（这是免费书籍版本） [http://www.freebookspot.es/Comments.aspx?Element_ID=76025](http://www.freebookspot.es/Comments.aspx?Element_ID=76025)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:50:27.020

这是数学，不是编程。

L 等于（S 是 big-sigma，总和）：

```
 n-1   i-1   n-1
   S     S     S    1
   i=1   j=1   k=j

   n-1 i-1
= S   S  (n - j)
  i=1 j=1

   n-1 i-1      n-1 i-1
= S   S  n  -  S   S  j
  i=1 j=1      i=1 j=1 

       n-1          n-1 
= n * S   (i-1) -  S   (i-1)i/2
      i=1          i=1 
```

等等。您需要知道第一个`n`整数的`n(n+1)/2`和是 并且第一个`n`平方和是`n(n+1)(2n+1)/6`。你最终会得到一个三次方程`n`。

感谢 Barmaley 指出我不再是本科生的回答，我不必操纵公式来简化它们。[Wolfram Alpha](https://www.wolframalpha.com/input/?i=sum+%28sum+%28sum+1+for+k+from+j+to+n-1%29+for+j+from+1+to+i-1%29+for+i+from+1+to+n-1&dataset=&asynchronous=false&equal=Submit)会为我做这件事 ;-)

答案是`n(n-1)(n-2)/3`。通常当这些事情很好地分解时，结果证明我可以在早期做出一个关键的洞察力（也许是几何的洞察力），以便在不写太多长表达式的情况下得出答案。这个结果看起来很可疑，就像刻在一个长方体中的金字塔的体积`n`，`n-1`，`n-2`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:58:44.567

首先：复杂性与 n 的具体数量无关。这是关于渐近行为。当有人说算法的复杂度为 O(f(n)) 时，这并不意味着算法严格执行 f(n) 操作。事实上，它可以做`2*f(n)`or`1/2 * f(n)`或`f(n) + sqrt(f(n))`。在谈论复杂性时，人们通常对操作数量随着输入的增长而增长的速度感兴趣。

在您的情况下，您必须编写 3 个嵌套总和（每个循环一个）和内部操作的总和成本（假设它是 1）：

![过程](../Images/474d025a97ad9b16358f05ca939e334d.png)

这是精确的公式（不要相信我 - 检查使用[wolfram|alpha](http://www.wolframalpha.com/input/?i=sum%20%28sum%20%28sum%201%20for%20k%20from%20j%20to%20n%29%20for%20j%20from%201%20to%20i%29%20for%20i%20from%201%20to%20n)），但在复杂性语言中它只是 O(n^3)

**UPD**：请注意，此公式对应于具有条件类型的循环，`less-or-equal`而不仅仅是`less-than`.

# c# - 动作过滤器中的会话变量

> ID：14735185
> 
> 赞同：19
> 
> 时间：2013-02-06T17:29:08.997
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我有一个动作过滤器检查是否`ID`设置了会话变量。出于开发目的，我在检查之前手动设置了这个变量。

```
public class MyActionFilterAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuted(ActionExecutedContext context)
        {

            context.HttpContext.Session.Add("ID", 123123);

            int ID = (int)context.HttpContext.Session.Contents["ID"];
            var rd = context.HttpContext.Request.RequestContext.RouteData;

            TED _db = new TED();

            //if not in DB
            if (_db.Users.Find(ID) == null && rd.GetRequiredString("action") != "NoAccess")
            {
                RouteValueDictionary redirectTargetDictionary = new RouteValueDictionary();
                redirectTargetDictionary.Add("action", "NoAccess");
                redirectTargetDictionary.Add("controller", "Home");
                redirectTargetDictionary.Add("area", "");

                context.Result = new RedirectToRouteResult(redirectTargetDictionary);
            }

            base.OnActionExecuted(context);
        }
    } 
```

据我了解，此代码在任何页面之前运行，`Session["ID"]`始终设置。如果我一直在测试，该站点运行良好，但如果我将其放置一段时间然后尝试继续测试，它似乎会中断。这是我得到的错误：

```
int UserID = (int)Session.Contents["ID"];
System.NullReferenceException: Object reference not set to an instance of an object. 
```

最初我认为会话可能只是到期，但在任何页面加载之前，`Session["ID"]`应该设置。这里有什么问题？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-06T17:39:53.420

你正在实现你的 actionfilter 的 on`OnActionExecuted`方法，该方法在你的 action 方法之后执行

您应该实现该`OnActionExecuting`方法

```
public class MyActionFilterAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuting(ActionExecutingContext context)
        {

            context.HttpContext.Session.Add("ID", 123123);

            int ID = (int)context.HttpContext.Session.Contents["ID"];
            var rd = context.HttpContext.Request.RequestContext.RouteData;

            TED _db = new TED();

            //if not in DB
            if (_db.Users.Find(ID) == null && rd.GetRequiredString("action") != "NoAccess")
            {
                RouteValueDictionary redirectTargetDictionary = new RouteValueDictionary();
                redirectTargetDictionary.Add("action", "NoAccess");
                redirectTargetDictionary.Add("controller", "Home");
                redirectTargetDictionary.Add("area", "");

                context.Result = new RedirectToRouteResult(redirectTargetDictionary);
            }

            base.OnActionExecuting(context);
        }
    } 
```

# reporting-services - 您能否在 SSRS 中为工具提示生成下钻子报表？

> ID：14735187
> 
> 赞同：0
> 
> 时间：2013-02-06T17:29:23.707
> 
> 标签：reporting-services, ssrs-2012

我在互联网上闲逛，很好奇 StackOverflow 上是否有人成功地将 SubReport 绑定到工具提示。我有点在网上听到了多个答案。最常见的断言是你不能，因为工具提示只接受表达式并且不能关联。另一个断言是，您可以添加自定义代码（我只在实验室中完成过），以将其转换为可以使用的表达式。

我希望 SSRS 开箱即用的一件事就是“弹出”钻取报告。由于操作密集，我知道您无法关联大量数据，但对于简单的细节网格，这会很好。

到目前为止，我已经能够设置子报表以钻取到其他页面，或者我找到了一个博客，其中有人设法使用 JavaScript 以设置的窗口大小呈现子报表。我也使用过它：http: [//tavislovell.com/wordpress/how-to-make-ssrs-reports-in-a-performancepoint-dashboard-pop-out-or-open-in-a-new-window -2/](http://tavislovell.com/wordpress/how-to-make-ssrs-reports-in-a-performancepoint-dashboard-pop-out-or-open-in-a-new-window-2/)

问题是我想要在其他一些工具中找到的“悬停”功能。有没有人在可以是动态行的工具提示中成功完成子报表或第二个数据集？我本质上想将鼠标悬停在一个单元格上并获取一个报告以在用户处弹出某些单元格。我再次明白这可能会很激烈，但我会确定它的范围，所以它会是最小的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:27:56.023

正如您所发现的，仅使用 SSRS 执行此操作是一场艰苦的战斗。这有几个原因：很少有报表渲染器可以支持此功能，SSRS 不能很好地支持插入自定义 javascript，潜在的性能问题。&c, &c. 我不认为你会走得很远。

**但**

如果绝对需要此功能，我的建议是使用自定义包装网站：用户将前往自定义网站加载报告。该网站将调用 SSRS 以检索报告。它将扫描生成的 HTML 以查找某些预先确定的特殊字符串：`INSERTREPORTTOOLTIP(CLIENTID=45)`以确定需要生成和插入的“工具提示图表”的位置和内容。

不是胆小的人，如果一切顺利的话，我认为这至少需要 20 个小时的时间。

（另外，真正的“工具提示”实现是依赖于浏览器的，所以你真的需要一个具有可见性的 div 并且可能动态控制位置。）

您是否应该使用 SSRS 或构建自己的“报告”网页取决于您正在利用多少其他 SSRS 功能。

# .htaccess - .htaccess 重写规则在字符串的第一部分后停止读取 url

> ID：14735188
> 
> 赞同：1
> 
> 时间：2013-02-06T17:29:23.527
> 
> 标签：.htaccess, mod-rewrite

感谢您的阅读。

我正在尝试将所有动态类别链接 (/product_list.php?cat_id=xxx) 重写为更“友好”的文本链接。我遇到的问题是子类别：

`RewriteRule Complete-AC-Systems product_list.php?cat_id=2`

效果很好，但是当存在子类别时：

`RewriteRule Complete-AC-Systems__Packaged-Systems product_list.php?cat_id=7`

浏览器在 Complete-AC-Systems 后停止读取并重定向到`product_list.php?cat_id=2`not`cat_id=7`

我们的大多数类别都是 3 级和 4 级，所以这是一个普遍存在的问题。

谢谢你的尽心帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:12:44.370

颠倒规则的顺序如何？即，将最长的匹配放在首位。

# database - 如何在 Prestashop v1.5.3.1 中删除重复的子类别

> ID：14735194
> 
> 赞同：0
> 
> 时间：2013-02-06T17:30:01.807
> 
> 标签：database, themes, prestashop

您好，我在后台手动创建了所有类别和子类别。我在前台的所有类别下都出现了重复的子类别。如何删除 Prestashop v1.5.3.1 中的重复子类别？我查看了 categories.tpl 并没有看到任何需要重复子类别的内容。我还需要查看哪些地方以及需要更改哪些内容以防止重复的子类别显示在前台 Prestashop v1.5.3.1 中？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T06:25:13.083

在 classes/Category.php 中搜索函数 "getSubCategories" 。在那里你将有一个 mysql 查询。它会像

```
$result = Db::getInstance(_PS_USE_SQL_SLAVE_)->executeS('
        SELECT c.*, cl.id_lang, cl.name ... ... 
```

将其更改为

```
$result = Db::getInstance(_PS_USE_SQL_SLAVE_)->executeS('
        SELECT DISTINCT c.*, cl.id_lang, cl.name, 
```

您只需将**DISTINCT放在****SELECT**之后和**c.***之前。

我希望它会奏效。如果没有，请告诉我。

谢谢

# javascript - 通过按键激活 Javascript 函数

> ID：14735197
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:30:05.550
> 
> 标签：javascript, onkeydown

```
 function addone()
    {
            document.getElementById("subtract").disabled=false;
    x += 1;
    document.getElementById("result").innerHTML="Doshi has said OK " + x + " times."
if(x == 1 ){
    document.getElementById("resetall").disabled=false;
    document.getElementById("reset").disabled=false;
    document.getElementById("result").innerHTML="Doshi has said OK " + x + " time."
}
if(x == 0){
    document.getElementById("resetall").disabled=true;
    document.getElementById("reset").disabled=true;
    document.getElementById("result").innerHTML="Doshi has not said OK "
}
    } 
```

当我按下“1”键时，我想启动这个功能。我该怎么做呢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:32:11.003

```
window.onkeypress = function(event) {
   if (event.keyCode == 41) {
      // do a function
   }
} 
```

而不是 onkeypress 你可以看看 onkeydown / onkeyup

字符代码列表：[http ://www.asciitable.com/](http://www.asciitable.com/)

# java - Mysql、Access 和 Oracle 包

> ID：14735208
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:30:37.887
> 
> 标签：java

我开始学习Java。当我学习 PHP 时，我在我的计算机上使用了 EasyPHP WAMP，因此我将 PHP、MYSQL 和 Apache 合二为一。Java、Access 和 Oracle 是否有类似的软件包？

谢谢

约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:45:50.540

以 EasyPHP 为例，我猜`Java`你正在寻找像
**Netbeans**
**Eclipse**
**JDeveloper这样的 IDE**

# .net - Protobuf-net：使用隐藏成员不起作用

> ID：14735209
> 
> 赞同：1
> 
> 时间：2013-02-06T17:30:49.043
> 
> 标签：.net, protocol-buffers, protobuf-net

使用带有隐藏字段的类型会导致“无法确定成员”异常（V2 通过 RuntimeTypeModel 没有任何属性）。

在 MetaType.cs 中删除这一行中的长度检查解决了这个特殊用例的问题。

```
 if(members != null && members.Length == 1) mi = members[0]; 
```

但我担心长度检查是有原因的，所以简单地删除它可能不是一个合适的解决方案。在这种情况下使用`members[0]`是有效的，因为隐藏的基类成员位于数组的末尾。

我的用例的简化示例：

```
public class SharedType
{
    public int Number { get; set; }
}

public class ClientType : SharedType
{
    public new long Number { get; set; }
}

var modelServer = RuntimeTypeModel.Create();
modelServer.Add(typeof(SharedType), false).Add("Number");

var ms = new MemoryStream();
modelServer.Serialize(ms, new SharedType() { Number = 10 });

var modelClient = RuntimeTypeModel.Create();
modelClient.Add(typeof(ClientType), false).Add("Number");

ClientType obj = (ClientType)modelClient.Deserialize(new MemoryStream(ms.ToArray()), null, typeof(ClientType)); 
```

实际上，我会用`int`SharedNestedType 和`long`ClientNestedType 代替。

# .net - 为 StanfordCoreNLP 指定模型的路径

> ID：14735212
> 
> 赞同：3
> 
> 时间：2013-02-06T17:31:17.810
> 
> 标签：.net, ikvm, stanford-nlp

我正在使用使用 IKVM.NET 的 StandordCoreNLP。有没有办法指定解析器模型的路径

```
 var pipeLine = new StanfordCoreNLP(props); 
```

抛出异常：

```
java.lang.RuntimeException: java.io.IOException: Unable to resolve
"edu/stanford/nlp/models/pos-tagger/english-left3words/english-left3words-distsim.tagger"
as either class path, filename or URL 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-24T23:46:18.460

如果您没有在类路径中包含 models.jar，这是完整的属性集。

```
Properties props = new Properties();
String modPath = "<YOUR PATH TO MODELS>/models3.4/edu/stanford/nlp/models/";
props.put("pos.model", modPath + "pos-tagger/english-left3words/english-left3words-distsim.tagger");
props.put("ner.model", modPath + "ner/english.all.3class.distsim.crf.ser.gz");
props.put("parse.model", modPath + "lexparser/englishPCFG.ser.gz");
props.put("annotators", "tokenize, ssplit, pos, lemma, ner, parse, dcoref");
props.put("sutime.binders","0");
props.put("sutime.rules", modPath + "sutime/defs.sutime.txt, " + modPath + "sutime/english.sutime.txt");
props.put("dcoref.demonym", modPath + "dcoref/demonyms.txt");
props.put("dcoref.states", modPath + "dcoref/state-abbreviations.txt");
props.put("dcoref.animate", modPath + "dcoref/animate.unigrams.txt");
props.put("dcoref.inanimate", modPath + "dcoref/inanimate.unigrams.txt");
props.put("dcoref.big.gender.number", modPath + "dcoref/gender.data.gz");
props.put("dcoref.countries", modPath + "dcoref/countries");
props.put("dcoref.states.provinces", modPath + "dcoref/statesandprovinces");
props.put("dcoref.singleton.model", modPath + "dcoref/singleton.predictor.ser"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-29T14:56:42.927

了解您如何定义属性会很有帮助。如果您使用默认属性，您可能只是缺少类路径中的 models.jar（就像3.2 版的[这个](http://search.maven.org/remotecontent?filepath=edu/stanford/nlp/stanford-corenlp/3.2.0/stanford-corenlp-3.2.0-models.jar)）。下载它并确保它被加载。

如果以其他方式配置属性，则字符串中可能会出现语法错误，从而导致 IO 错误。这是我用于加载不同`pos.model`外观的自定义属性：

```
Properties props = new Properties();
// using wsj-bidirectional model
props.put("pos.model", "edu/stanford/nlp/models/pos-tagger/wsj-bidirectional/wsj-0-18-bidirectional-distsim.tagger");
// using standard pipeline
props.put("annotators", "tokenize, ssplit, pos, lemma, parse");
// create pipeline
StanfordCoreNLP pipeline = new StanfordCoreNLP(props); 
```

重要的是要注意路径中没有前导斜杠`/`。

如果这没有帮助，请查看[Galal Aly 的教程](http://www.galalaly.me/index.php/2011/05/tagging-text-with-stanford-pos-tagger-in-java-applications/)，其中标记器是从模型文件中提取并单独加载的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T00:57:42.877

我不知道您是否可以使用 IKVM.NET 从 jar 文件中访问资源，但您当然可以解压缩 jar 文件以获取常规操作系统文件 ( `jar -xf models.jar`) 并将模型作为文件加载。要么你需要镜像 jar 文件的目录结构（使用上面示例的路径，并使用相对路径），要么你需要为 props 文件中的所有模型设置属性，以提供它们可以使用的文件路径成立。参见`pos.model`, `ner.model`,`parse.model`等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-15T22:57:27.137

我遇到过同样的问题。就我而言，我没有使用完整的 .jar 文件，而是提取了 .tagger 文件。我只是在制作这样的属性对象后手动添加了模型：

```
Properties props = new Properties();

**props.put("pos.model", "E:\\Documents\\Dependencies\\english-left3words-distsim.tagger");** 
```

# php - Wordpress 日期格式

> ID：14735214
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:23.050
> 
> 标签：php, wordpress, date-format

是否可以在 Wordpress 的日期格式中使用一些常量字符串？

就像是：

```
year:Y, month:F 
```

这将转化为：

```
year:2012, month:February 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:37:39.260

是的，这是可能的。Wordpress 使用[php: date 函数](http://php.net/manual/en/function.date.php)来格式化日期，因此您可以在博客的常规设置页面上使用以下格式。

要使用常量字符串，您需要转义不应作为日期一部分解析的每个字符：

```
\y\e\a\r: Y, \m\o\n\t\h: F 
```

此格式化字符串将产生“年：2013 年，月：二月”。

另请参阅[有关格式化日期和时间的 Wordpress Codex](http://codex.wordpress.org/Formatting_Date_and_Time)。

# wpf - 通过在 WPF 数据网格或 Xceed 数据网格中拖动来显示行之间的水平线

> ID：14735216
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:26.410
> 
> 标签：wpf, datagrid, xceed

我正在 WPF 中寻找一些可能性，如何通过在 WPF 数据网格或 Xceed 数据网格中拖动来显示行之间的水平线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:37:40.807

您也可以使用这个拖放库：WPF 中的拖放（[I](http://www.codeproject.com/Articles/43614/Drag-and-Drop-in-WPF)和[II](http://www.codeproject.com/Articles/43702/Drag-and-Drop-in-WPF-Part-II)）。你可以看到代码，他们使用装饰器在要放置的元素之间画一条线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T21:37:04.330

我认为你应该设置 RowStyle 属性，然后监听事件`DragEnter`，`DragLeave`例如：

数据网格代码：

`<DataGrid RowStyle="{DynamicResource DataGridRowStyle1}"/>`

`DataGrid`这是已经具有两个触发器（for`DragEnter`和）的 wpf 行样式的副本`DragLeave`：

```
<Style x:Key="DataGridRowStyle1" TargetType="{x:Type DataGridRow}">
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
        <Setter Property="SnapsToDevicePixels" Value="true"/>
        <Setter Property="Validation.ErrorTemplate" Value="{x:Null}"/>
        <Setter Property="ValidationErrorTemplate">
            <Setter.Value>
                <ControlTemplate>
                    <TextBlock Foreground="Red" Margin="2,0,0,0" Text="!" VerticalAlignment="Center"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridRow}">
                    <Border x:Name="DGR_Border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                        <SelectiveScrollingGrid>
                            <SelectiveScrollingGrid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </SelectiveScrollingGrid.ColumnDefinitions>
                            <SelectiveScrollingGrid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </SelectiveScrollingGrid.RowDefinitions>
                            <DataGridCellsPresenter Grid.Column="1" ItemsPanel="{TemplateBinding ItemsPanel}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            <DataGridDetailsPresenter Grid.Column="1" Grid.Row="1" SelectiveScrollingGrid.SelectiveScrollingOrientation="{Binding AreRowDetailsFrozen, ConverterParameter={x:Static SelectiveScrollingOrientation.Vertical}, Converter={x:Static DataGrid.RowDetailsScrollingConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" Visibility="{TemplateBinding DetailsVisibility}"/>
                            <DataGridRowHeader Grid.RowSpan="2" SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical" Visibility="{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.Row}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"/>
                        </SelectiveScrollingGrid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="DragDrop.DragEnter"/>
                        <EventTrigger RoutedEvent="DragDrop.DragLeave"/>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

您唯一需要做的就是添加要显示的 or ，设置`Line`on or ，然后在触发器中更改行的可见性值。希望这个答案可能对您有所帮助，并给您一个使其工作的想法，谢谢...`Rectange``Visibility``Collapsed``Hidden`

# javascript - Javascript 错误 document.myform.mydiv 未定义

> ID：14735218
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:30.650
> 
> 标签：javascript

我有一些 javascript 从 URL 中获取输入，例如...

```
www.mydomain.com/?dropdown=Alpha 
```

然后，这将从位于 myform -> mydiv 的下拉框中预先选择 Alpha

```
function show(choice) {

  var success = -1;
  for (var i=0; i < document.myform.mydiv.length; i++) {
    if (document.myform.mydiv.options[i].text == choice) 
      success = [i];
  }
  document.myform.mydiv.selectedIndex=success;
} 
var choice = (location.href.split("?")[1] || '').split("=")[1]; 
```

除了您访问没有扩展名的 url 之外，一切正常，所以 www.mydomain.com - 然后它会引发以下错误......

```
document.myform.mydiv is undefined 
```

下拉html是...

```
<form name="myform">
  <select name="mydiv">
    <option value="1">Alpha</option>
    <option value="2">Beta</option>
    <option value="3">Gamma</option>
    <option value="4">Delta</option>
  </select>
</form>

 <script>
  show(choice);
  </script> 
```

这是非常不言自明的，我知道这是因为它是未定义的，我的问题是如何添加检查来修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:09:29.120

我认为**你的java脚本函数在表单标签元素实现之前调用**......所以只有这个错误发生......

尝试**从任何一个表单元素事件中调用该函数**...然后它将起作用...

就像下面...

```
<html>
<head>
<script>
var urlpath = "www.mydomain.com/?dropdown=Alpha"
var choice = (urlpath.split("?")[1] || '').split("=")[1];
function show()
{
var success = -1;
  for (var i=0; i < document.myform.mydiv.length; i++) {
    if (document.myform.mydiv.options[i].text== choice) 
      success = i;
  }
  document.myform.mydiv.selectedIndex=success;
}
</script>
</head>
<body>
<form name="myform">
  <select name="mydiv" onchange="show();">

    <option value="2">Beta</option>
    <option value="3">Gamma</option>
    <option value="4">Delta</option>
    <option value="1">Alpha</option>
  </select>
</form>
</body>
</html> 
```

# c# - 根据绑定值更改 CSS 类？

> ID：14735219
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:31.887
> 
> 标签：c#, asp.net

我在网格视图中有一个项目模板：

```
 <asp:TemplateField HeaderText="Name" SortExpression="GroupDescription">
                <ItemTemplate>
                    <asp:Label ID="lblName" CssClass="edit" runat="server" Text='<%# Bind("GroupDescription") %>'></asp:Label>
                     <asp:HiddenField ID="lblHidden" EnableViewState="false" runat="server" />
                </ItemTemplate>

            </asp:TemplateField> 
```

CssClass 是“编辑”。如果 GroupDescription 是默认的，那么应该没有 css 类。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:46:57.733

您可以在转发器的 ItemDataBound 事件中更改类：

```
protected void YourRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
        if (ListItemType.Item == e.Item.ItemType || ListItemType.AlternatingItem == e.Item.ItemType)
        {
          var lbl = (Label)e.Item.FindControl("lblName");
          if(lbl.Text == "something")
            lbl.CssClass = "someCssClass";
        }
} 
```

# javascript - 不能再使用 mongoDB

> ID：14735220
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:33.090
> 
> 标签：javascript, node.js, mongodb, mongoose

我正在使用 mongoose 从 node.js 应用程序访问 Mongodb。但是现在我在玩过它后遇到了这个奇怪的错误。

```
[2013-02-06 18:27:36.060] [ERROR] [default] - { [MongoError: assertion db/../bson/bsonobjiterator.h:67] name: 'MongoError' }
MongoError: assertion db/../bson/bsonobjiterator.h:67
at Object.exports.toError (/Users/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/utils.js:108:11)
at Cursor.toArray (/Users/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:152:37)
at Cursor.nextObject.self.queryRun (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:594:39)
at Cursor.close (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:947:5)
at Cursor.nextObject.commandHandler (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:594:21)
at Db._executeQueryCommand (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/db.js:1692:5)
at g (events.js:192:14)
at EventEmitter.emit (events.js:126:20)
at Server.Base._callHandler (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/connection/base.js:130:25)
at Server.connect.connectionPool.on.server._serverState (/Users/javiermanzanomorilla/Development/workspace/node_modules/mongoose/node_modules/mongodb/lib/mongodb/connection/server.js:517:20) 
```

任何人？它在每个数据库请求上打印

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T09:54:06.027

解决了！猫鼬是一个错误！

# c# - 如何创建具有严格继承检查的自定义 Style Cop 规则？

> ID：14735221
> 
> 赞同：2
> 
> 时间：2013-02-06T17:31:33.183
> 
> 标签：c#, stylecop

我想创建一个 Style Cop 规则，如果一个类*直接*继承自`System.Web.UI.Page`. 我能够获得一个`StyleCop.CSharp.Class`代表我正在查看的任何类的实例，但从那里我有点不知所措。Class 对象（StyleCop 的，而不是 System）有一个`Declaration`属性，可以让我获得声明中的所有内容......其中包括继承的类名。但这并不一定保证唯一性。

检测到这一点很容易：

```
public class Foobar : System.Web.UI.Page {} 
```

但是这样的情况变得很糟糕......

```
using Page = System.Web.UI.Page;
public class Foobar : Page {} 
```

尤其是当您有**其他**具有这样声明的类时

```
using Page = Company.Some.Thing.Page;
public class Foobar : Page {} 
```

如何创建具有严格类型检查的规则，该规则不会被不同命名空间中具有相同名称的类绊倒？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:01:08.247

这是 FxCop 的工作，而不是 Stylecop，因为您对**编译**后的代码感兴趣，而不是**源**代码。

您只需要进行一些反思（实际上是*自省*）来获取继承自的类型列表`System.Web.UI.Page`，然后检查它们`BaseType`是否`System.Web.UI.Page`存在。

这是一个反射的基本示例：

```
 internal class Test2 : Test
    {
    }

    internal class Test : Program
    {
    }

    internal class Program
    {
        private static void Main(string[] args)
        {
            foreach (var type in Assembly.GetExecutingAssembly().GetTypes())
            {
                if (typeof(Program).IsAssignableFrom(type))
                {
                    if (type.BaseType == typeof(Program))
                    {
                        Console.WriteLine("strict inheritance for {0}", type.Name);
                    }
                    else
                    {
                        Console.WriteLine("no strict inheritance for {0}", type.Name);
                    }
                }
            }

            Console.Read();
        }
    } 
```

* * *

```
no strict inheritance for Program
strict inheritance for Test
no strict inheritance for Test2 
```

# javascript - 在此示例中，如何使用 AJAX 动态更改跨度文本？

> ID：14735222
> 
> 赞同：0
> 
> 时间：2013-02-06T17:31:42.243
> 
> 标签：javascript, jquery, ajax

**逻辑演示**（jsFiddle）：**[点击这里！](http://jsfiddle.net/alpha1337/NMDSG/)**

上面链接的演示是我想要达到的结果。*但是，我需要将其翻译为从 XML 变量asize*和*aprice*动态填充此内容。下面是我用于使用 AJAX 级联下拉列表的当前方法。

**XML 数据：**

```
<avar aval="1" asize="Small Flag" aprice="$26.00" atext="Size 0"/> 
```

**JS数据：**

```
if($('#drpType').val() == "1")
  {
    $.ajax({
    type: "GET",
    url: "Flags.xml",
    dataType: "xml",
    success: function(xml) {
    $(xml).find('avar').each(function(){
    $('#drpSize').append($('<option></option>').val($(this).attr('aval')).html($(this).attr('atext')));
        });
    }
  }); 
} 
```

**逻辑（非功能性）：**

```
if($('#drpSize').val() == "1")
  {
    $.ajax({
    type: "GET",
    url: "Flags.xml",
    dataType: "xml",
    success: function(xml) {
    // GET XML Value (asize) & print to <span class="ms"> onChange (#drpSize)
    // GET XML Value (aprice) & print to <span class="mp"> onChange (#drpSize)
    $('#drpSize').change(function (){
    $(xml).find('aval').each(function(){
    if ($(this).val() == "1") {
    $('.ms').text('asize');
    $('.mp').text('aprice');
        });
    }
  }); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:41:43.793

在使用 find 之前，您需要将 xml 解析为可遍历的 xmldoc。

```
var xmlDoc = $.parseXML(xml);
$(xmlDoc).find(... 
```

# objective-c - 为什么在 Xcode 4.6 中将 Objective-C 头文件或代码文件从一个文件夹拖到另一个文件夹会使其变为红色？

> ID：14735223
> 
> 赞同：1
> 
> 时间：2013-02-06T17:31:44.203
> 
> 标签：objective-c, xcode, cocoa, xcode4.6

我有一个 Xcode 4 Objective-C 项目，其中包含大约 150 个 .m 和 .h 文件。项目底层代码在底层磁盘结构中并不总是与 Xcode 项目中显示的文件夹相对应。我明白那部分。

我不明白为什么 Xcode 不会告诉我为什么我可以创建新项目组并将项目移动到它们，没有问题，但是某些现有项目文件夹会导致项目损坏，并且代码会一旦我将某些 .m 文件或 .h 文件移动到不同的组中，就不再构建。当它损坏时，它只会以红色显示文件。这是令人沮丧和困惑的。

在下面的截图中，之前的图像左侧显示了之前的状态，当一切正常时，右侧显示移动到组后的红色（丢失）文件。鉴于组不代表磁盘上的文件夹，我不希望从一个组移动到另一个组会破坏事情。有时会，有时不会。这个特殊的 XCode 问题让我非常不安。

在友好的 Mac 用户界面的过去，您可以点击`⌘`+`I`并获取有关对象属性的一些信息，或者右键单击并通过其上下文菜单获取某物的属性。XCode 项目中的组（文件夹图标）在其上下文（右键菜单）中没有属性项，但这些组显然并不完全相同。这些长相一模一样的群体怎么了？

其次，一个人如何学习如何重新组织磁盘上的文件夹组织和视觉组组织，而不会让你流血和殴打？（XCode 4 是我用过的最难的 IDE 版本，为此，我确信我错过了一些关于处理文件夹和文件等的重要文档。）

![在此处输入图像描述](../Images/3069a474ed97b5f0b0155038d3770100.png)

更新：文件检查器（实用程序菜单中的身份检查器）是这个谜团的关键，但我仍然不知道新用户如何发现这个（除了痛苦的经历）。我也不太明白这一切是关于什么的，路径下拉菜单中有各种选择，没有描述或帮助的空白或非空白值，只是一个神秘的图标和一些真实的名称-disk-folder 或者一个灰色的文本字段，上面写着 None：

![在此处输入图像描述](../Images/211e1b7952769900819db7b8cf0b0a17.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:19:28.137

这种事情不会突然发生。在这种情况下，发生的情况是用户打开了一个 .xcodeproj 并且不知道**Group**可以属于的各种相对或绝对路径选项之间的区别。XCode 中的**Group**始终在 XCode 项目中以完全相同的马尼拉色文件夹图标显示，无论它在其中定义了什么模式或属性。

默认情况下，最简单的情况是您在 XCode 中创建一个新的文件夹 Group 对象，它纯粹是一个装饰性的组织工具，其中没有存储磁盘位置信息。

这不是这些组做的唯一事情，也不是这些组可以使用的唯一“模式”。这些组也可以用来指向某个文件夹并说“这个虚拟文件夹中的东西真的在某个地方否则，要么在此项目的主文件夹下的子目录中，要么甚至在硬盘驱动器的其他位置，以相对路径或绝对路径格式存储”。当这样使用时，这些东西让我想起了桌面上的 Windows“快捷方式”对象，或查找器中的 Mac“别名”对象。

将文件从一个组拖到另一个组不会将其移动到磁盘上的其他文件夹。它只是将对具有特定名称的文件的引用移动到另一个组，这可能意味着在您拖动文件之后，您并没有真正移动它，或者以任何方式复制或重新定位它，**您只是移动了从可以正确解析为真实文件的地方到无法正确解析的地方的别名**。因此，XCode 会帮助您将其变为红色，而不会出现任何有用的错误信息。

你如何解决它？在这种情况下，请转到“实用程序”菜单中的“身份检查器”窗格，然后决定清除我在原始问题中的图片中显示的位置中的虚假值，其中我有“类”。清除无效值并不容易，因为 XCode 要求您基本上找到项目的根文件夹并选择它，这将“清除”文件夹组上的相对或绝对路径属性。

或者，您可以单独保留该文件夹，并且不要在未首先检查它们引用的相对或绝对路径的情况下将文件从 A 组拖到 B 组。

对我来说仍然很可怕的是 XCode 教程告诉你“使用 XCode 来管理项目的内容，不要只是在 XCode 项目目录内的查找器中拖动文件”，这是一个很好的建议，但它让我假设XCode 提供了完整和直观的物理（和虚拟）组文件夹组织工具。它不是。例如，假设您继承了一个项目，该项目具有分散在主 XCode 项目文件夹下的四个物理文件夹中的 .m 和 .h 文件，并且您想要移动这些文件。您必须在 XCode 中以及在终端或 Finder 中执行一系列棘手的事情，以便重新组织您的文件夹。加上在您选择的版本控制工具中移动项目所涉及的复杂性，以及 XCode'

# java - 在 AsyncTask 中查询给出非法状态异常

> ID：14735224
> 
> 赞同：-2
> 
> 时间：2013-02-06T17:31:45.443
> 
> 标签：java, android, html, eclipse

我有这个查询

```
http://mtmis.punjab.gov.pk/Tax Collection/searchNameTemp.jsp?names=%s

 class TrackingNumber extends AsyncTask<String, Void, String> 
 {
        @Override
        protected String doInBackground(String... arg0) 
        {
            String urlString = null;
            try {
                urlString = URLEncoder.encode(String.format(url, search), "utf-8");
            } catch (UnsupportedEncodingException e1) {
                e1.printStackTrace();
            }
            // Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient();
            HttpGet httppost = new HttpGet(urlString);

        try {
            httpclient.getParams().setParameter("http.connection-manager.timeout", 15000); 
            HttpResponse response = httpclient.execute(httppost);

            String html = "";
            InputStream in = response.getEntity().getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(in));
            StringBuilder str = new StringBuilder();
            String line = null;
            while((line = reader.readLine()) != null)
            {
                str.append(line);
            }
            in.close();
            html = str.toString();

            return html;
            } catch (ClientProtocolException es) 
            {   
                Log.e("x" , es.getMessage());
                return "";
            } catch (IOException e) 
            {
                Log.e("aasx" , e.getMessage());
                return "";
            }

        }
        @Override
        protected void onPostExecute(String response) 
        {
                String responseConverted = html2text(response);
                Log.e("tag", responseConverted);

        }
 } 
```

我的错误日志

```
02-06 17:26:35.055: E/AndroidRuntime(1625): FATAL EXCEPTION: AsyncTask #2
02-06 17:26:35.055: E/AndroidRuntime(1625): java.lang.RuntimeException: An error occured while executing doInBackground()
02-06 17:26:35.055: E/AndroidRuntime(1625):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.FutureTask.run(FutureTask.java:239)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.lang.Thread.run(Thread.java:856)
02-06 17:26:35.055: E/AndroidRuntime(1625): Caused by: java.lang.IllegalStateException: Target host must not be null, or set in parameters. scheme=null, host=null, path=http://mtmis.punjab.gov.pk/Tax+Collection/searchNameTemp.jsp?names=j
02-06 17:26:35.055: E/AndroidRuntime(1625):     at org.apache.http.impl.client.DefaultRequestDirector.determineRoute(DefaultRequestDirector.java:591)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:293)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at com.trib.app.mtis.WebClass$TrackingNumber.doInBackground(WebClass.java:72)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at com.trib.app.mtis.WebClass$TrackingNumber.doInBackground(WebClass.java:1)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-06 17:26:35.055: E/AndroidRuntime(1625):     at java.util.concurrent.FutureTask.run(FutureTask.java:234) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:49:03.977

目前您正在编码整个 url，包括 host 。只需将参数而不是 url 编码为：

```
String str_url="http://mtmis.punjab.gov.pk/Tax%20Collection/searchNameTemp.jsp?";
String str_params="names=%s";  //<<< queryString which you want to encode
urlString =str_url+URLEncoder.encode(String.format(str_params, search), "utf-8"); 
```

# java - Java 中的 hashCode() 用途

> ID：14735232
> 
> 赞同：7
> 
> 时间：2013-02-06T17:32:07.047
> 
> 标签：java, hashcode

我读过一本书，它`hashCode()`显示了一个内存区域，它有助于（例如`HashSets`）在内存中定位适当的对象。但是，如果我们不能直接在 Java 中操作内存，那怎么可能呢？没有指针，除此之外，对象被创建并从一个地方移动到另一个地方，而开发人员对此一无所知。

我读到这种认识`hashCode() {return 42;}`是可怕的和可怕的，但是如果我们不能指示 VM 将我们的对象放在哪里，那有什么区别呢？

问题是：`hashCode()`如果我们不能操纵记忆，那么深层次的目的是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T17:34:50.163

> 我在一本书中读到 hashCode() 显示了一个内存区域，它有助于（例如 HashSets）在内存中定位适当的对象。

不，这完全是对`hashCode`. 它用于以有效的方式找到可能相等的对象。它与对象在内存中的位置*无关。*

这个想法是，如果你有类似 a 的东西`HashMap`，你想在查找时快速找到匹配的键。因此，您首先检查请求的键的哈希码，然后您可以使用该哈希码真正有效地找到映射中的所有键。然后，您可以检查每个（并且只有那些）候选键与请求的键是否相等。

有关更多信息，请参阅[有关哈希表的 Wikipedia 文章](http://en.wikipedia.org/wiki/Hash_table)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T17:51:41.063

我喜欢[Jon Skeet 的回答](https://stackoverflow.com/a/14735277/217324)(+1)，但它需要知道哈希表是如何工作的。哈希表是一种数据结构，基本上是一个存储桶数组，它使用键的哈希码来决定将该条目插入哪个存储桶。这样将来检索该键上的任何内容的调用就不必筛选整个存储在hashtable中的事物列表，hashtable可以计算出key的hashcode，然后直接去匹配的bucket中查找。哈希码必须是可以快速计算的东西，并且您希望它是唯一的，但如果不是，那不是灾难，除非在最坏的情况下（您的`return 42;`），这很糟糕，因为一切都以相同的方式结束桶，你又回来筛选一切。

Object#hashCode 的默认值可能基于诸如内存位置之类的东西，只是因为它是一种方便的随机数，但是由于在内存管理期间对象被分流，所以该值被缓存并且没有人关心。由不同对象（如 String 或 BigDecimal）创建的哈希码肯定与内存无关。它只是一个快速生成的数字，您希望它经常是独一无二的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T17:35:05.233

哈希码只是一个“值”。它与“您将它放在内存中的位置”无关，而“MyClass obj = new MyClass()”与“obj”在内存中的位置无关。

那么Java hashCode()到底*是什么？*

这是关于这个主题的一个很好的讨论：

*   [http://www.coderanch.com/t/269570/java-programmer-SCJP/certification/discuss-hashcode-contract](http://www.coderanch.com/t/269570/java-programmer-SCJP/certification/discuss-hashcode-contract)

> K&B 说 hashcode() 合约是：
> 
> 1.  如果两个对象根据 equals(Object) 方法相等，则对两个对象中的每一个调用 hashCode() 方法必须产生相同的整数结果。
>     
>     
> 2.  如果两个对象根据equals(Object)方法不相等，则不需要hashcode()。
>     
>     
> 3.  如果在两个对象上调用 hashcode() 产生不同的整数结果，那么根据 equals(Object)，它们必须是不相等的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T17:35:28.910

哈希码是一个接受对象并输出数值的函数。如果对象不变，则对象的哈希码始终相同。

像哈希图这样需要存储对象的函数，将使用哈希码对其内部数组的大小取模来选择存储对象的“内存位置”（即数组位置）。

在某些情况下可能会发生冲突（两个对象最终具有相同的哈希码，当然，这需要仔细解决）。有关详细信息，我建议阅读 wikipedia [hashmap](http://en.wikipedia.org/wiki/Hashmap) entry

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T17:35:06.483

HashCode 是对象的加密，通过该加密，java 知道例如集合中的两个对象是相同还是不同。（以排序集为例）

我建议你阅读这篇[文章](http://en.wikipedia.org/wiki/Java_hashCode%28%29)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T17:40:28.387

是的，它与内存地址无关，尽管它通常是通过转换对象的内部地址来实现的。[在Object 的 hashCode()](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)方法中找到的以下语句清楚地表明实现并非强制执行此操作。

> 在合理可行的情况下，由 Object 类定义的 hashCode 方法确实为不同的对象返回不同的整数。（这通常通过将对象的内部地址转换为整数来实现，但 JavaTM 编程语言不需要这种实现技术。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-03T10:38:02.790

该`hashCode()`函数接受一个对象并输出一个数值，该数值不必是唯一的。如果对象不变，则对象的哈希码始终相同。

hashCode() 返回的值是对象的哈希码，即**对象的十六进制内存地址**。

根据定义，如果两个对象相等，则它们的哈希码也必须相等。如果重写 equals() 方法，就会改变两个对象相等的方式，并且 Object 的 hashCode() 实现不再有效。因此，如果你重写 equals() 方法，你也必须重写 hashCode() 方法。

有关更多信息，请查看这篇[Java 哈希码文章](https://javatutorial.net/java-hashcode-method-example)。

[![在此处输入图像描述](../Images/4dc6a82e279416c377c1d0539dea6222.png)](https://i.stack.imgur.com/VMX0a.jpg)

# php - 在php和mysql中进行计数时如何有效地查询数据库

> ID：14735234
> 
> 赞同：0
> 
> 时间：2013-02-06T17:32:10.473
> 
> 标签：php, mysql, database

所以我想做的是创建一个我可以运行的函数，它将做各种计数来计算不同的结果

现在在我的脑海中，我想做的是从数据库中的表中选择所有内容，然后使用 php 对其进行排序并从相同的结果中进行各种计数，这样数据库就不会被查询太多，但是我甚至不知道如何开始，甚至不知道这是否可能。

替代方案将只是做我可以做的个别查询，但实际上效率很高，特别是如果我想进行许多不同的计数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T23:44:14.593

$result = mysql_fetch_array(mysql_query('select count(*) as count from pm where ((user1="'.$_SESSION['userid'].'" and user1read="no") or (user2="'.$ _SESSION['userid'].'" and user2read="no")) and id2="1"')); $result = $result['count'];-----这一行分配了 $count 变量，当您将“as count”添加到查询中时，您实际上创建了它。$result=$result['count']; 在查询之后。

# spring - 如果值包含“。”，则 Spring REST @RequestMapping 提取不正确

> ID：14735247
> 
> 赞同：0
> 
> 时间：2013-02-06T17:32:38.603
> 
> 标签：spring, spring-mvc

**问题：**

`http://localhost:8080/site/google.com`参见以下 Spring REST 示例，如果提交了诸如此类的请求，则 Spring 返回“<strong>google”。看起来像春天对待“。” 作为文件扩展名，并提取参数值的一半。

Spring 必须返回“<strong>google.com”。怎么办？

**站点控制器.java**

```
package com.example.web.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping("/site")
public class SiteController {

@RequestMapping(value = "/{domain}", method = RequestMethod.GET)
public String printWelcome(@PathVariable("domain") String domain,
    ModelMap model) {

    model.addAttribute("domain", domain);
    return "domain";

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:47:48.503

我相信您可以在@ResourceMapping 的路径变量中使用正则表达式。例如，你可以做

```
{domain:.[\\S]*} 
```

您可能不得不摆弄一些正则表达式才能使其正确。':' 将路径变量名称与正则表达式分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T13:07:00.023

这很简单，只需在您的参数中添加“:.+”，如下所示：

这里用户名是电子邮件ID

```
@RequestMapping(value = "checkuser/{username:.+}" , method=RequestMethod.GET)
@ResponseBody
boolean getUserName(@PathVariable("username") String userName){ 
    boolean isUserAvailable = userDao.checkAvailable(userName); 
    return isUserAvailable; 
} 
```

我从 URL 传递值，例如：baseurl/checkuser/test@test.com

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T12:46:32.940

只需确保您的 url 以 '/' 结尾并且 SiteController.java chage 注意到..

`change http://xxx/site/google.com to http://xxx/site/google.com/`

# makefile - 解析makefile时g ++的参数顺序被打乱

> ID：14735248
> 
> 赞同：0
> 
> 时间：2013-02-06T17:32:49.507
> 
> 标签：makefile, gnu-make

以下生成文件：

```
#Regular c++ rules
CXX=g++
CXXFLAGS=-Wall -march=native -ffast-math -O3
CXX_OBJECTS=AbsNode.o rle16.o rle8.o

# Link command:
test : $(CXX_OBJECTS)
    $(CXX) $(CXX_OBJECTS) -o test

# Compilation commands: 
$.o : %.cpp
    $(CXX) -c $< $(CXXFLAGS) -o $@ 
```

输出

```
g++ -Wall -march=native -ffast-math -O3 -c -o AbsNode.o AbsNode.cpp
g++ -Wall -march=native -ffast-math -O3 -c -o rle16.o rle16.cpp
g++ -Wall -march=native -ffast-math -O3 -c -o rle8.o rle8.cpp 
```

虽然我期待

```
g++ -c AbsNode.cpp -Wall -march=native -ffast-math -O3  -o AbsNode.o 
g++ -c rle16.cpp -Wall -march=native -ffast-math -O3 -o rle16.o 
g++ -c rle8.cpp -Wall -march=native -ffast-math -O3 -o rle8.o 
```

为什么与makefile中所述的规则相比，g ++的参数顺序切换了？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:36:12.537

```
$.o : %.cpp 
```

您输入了 $ 而不是 %，这变成了非模板规则。然而，make 有一个 C++ 文件的默认规则，而不是你的。参数的顺序匹配这个内部规则。

# php - PHP 需要很长时间才能解析主机名

> ID：14735251
> 
> 赞同：0
> 
> 时间：2013-02-06T17:32:58.727
> 
> 标签：php, dns, resolve, resolver, dig

我们看到一个非常奇怪的问题，PHP 需要很长时间才能解析任何主机名，每 5-10 次尝试随机发生一次。我们使用以下脚本来检查它...

```
<?php

$mtime = microtime();
$mtime = explode(" ",$mtime);
$mtime = $mtime[1] + $mtime[0];
$starttime = $mtime;

$host = "google.com";
echo "looking up ".$host."<br/>";
$ip = gethostbyname($host)
//$ip = rtrim(`/usr/bin/dig $host A +short | /usr/bin/tail -1`);
echo "IP = " . $ip . "<br/>";

$mtime = microtime();
$mtime = explode(" ",$mtime);
$mtime = $mtime[1] + $mtime[0];
$endtime = $mtime;
$totaltime = ($endtime - $starttime);
echo "<br/>Total Time: ".$totaltime." seconds";

?> 
```

查找 google.com 主要需要几毫秒，但每 5-10 次尝试中就有一次需要 10-15 秒！我们看到任何域名都有相同的行为。注释掉的行使用命令行中的 dig 来解决，当使用它时，我们看不到任何问题。这一切都很奇怪，因为他们使用的是同一个解析器。我们已经从命令行运行了这个 PHP 脚本，也将 apache 排除在外 - 结果相同，所以它似乎纯粹是一个 PHP 问题。

PHP 文档说 gethostbyname() 函数最多可能需要 4 秒 - 我们看到的时间比这要长得多。我们实际上并没有使用这个函数——我们遇到的真正问题是由于无法解析主机名而导致 cURL 调用超时。上面的脚本纯粹是为了评估我们是否在 PHP 中有解决问题，我们这样做了！

atm 完全亏损 - 谷歌搜索很少出现。甚至我们可能会在哪里开始调查的指针将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:36:56.500

我将首先查看您的 DNS 正在解析的位置，您的服务器上当前指向的 DNS 是哪里？也许尝试将其更改为公共 DNS 服务器之一（8.8.8.8 或 4.2.2.2），看看您是否遇到相同的问题。

# angularjs - What angularjs expression syntax is this in ng-class

> ID：14735257
> 
> 赞同：41
> 
> 时间：2013-02-06T17:33:23.253
> 
> 标签：angularjs

The [AngularJS Noob Handbook](https://github.com/angular/angular.js/wiki/Noob-Handbook) has some code which reduces class manipulation to a simple expression and binding :

```
<a ng-click="flags.open=!flags.open">...<div ng-class="{active:flags.open}"> 
```

However, what is the expression syntax in ng-class? I understand that a vertical bar (|) would pass through a filter and that a filter can be passed parameters after a colon but the above code is doing something different. If the scope variable on the right evaluates to true then the expression on the left is included otherwise it's dropped.

Is this specific to the ng-class directive? Is there some documentation on [http://docs.angularjs.org](http://docs.angularjs.org) that explains this?

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-02-06T17:35:58.503

This is mentioned briefly (too briefly, in my opinion) in the [`ngClass` documentation](http://docs.angularjs.org/api/ng.directive:ngClass). If you pass an object to `ngClass`, then it will apply each *key* of the object as a class to the element if that key's *value* is true. For example:

```
$scope.first = true
$scope.second = false
$scope.third = true 
```

with

```
<div ng-class="{a: first, b: second, c: third}"></div> 
```

would result in

```
<div class="a c"></div> 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-08-08T13:09:54.880

you've probably also seen something like this:

```
<div ng-class="{true: 'complete'}[item.Id != 0]"></div> 
```

Very rad syntax.

***EDIT:*** What happens here, is that the "`complete`" `class` is added to the element `if(item.Id != 0)`. Alternatively, we could write: `<div ng-class="{false: 'cookieless'}[monsterEatsCookies('Elmo')]`. As its decided by the monsterEatsCookies function, Elmo does not eat cookies so since this function returns `false` the html element gains a class called `cookieless`.

A simple example: `<div ng-class="{false: 'DoubleNegative'}[1 == 0]`. `1 !== 0` which is "`false`" -- the "`DoubleNegative`" class is added to the element.

```
<div ng-class="{  true:   'complete'  } [item.Id != 0]"></div> 
```

`

```
 | |      | |          | | |            |
            | |result| |className | | |            |
            |                     | | |            |
            |       function      | | | condition  | 
```

*Addendum*

Also, I just realized that you can use a variety of different keys to map to your condition. For example:

`ng-class="{ true: 'highlight', undefined: 'mute' }[ item.hasValue ]"`

The `mute` class will be applied if item has no "`hasValue`" property. Furthermore, you can apply a class for any given type or value:

`{'Jonathan Chapman': 'embolden', '[object Object]': 'hide'}[ item.toString() ]`

In the following collection, this would embolden a person's name while hiding items that are objects:

```
[
    'Jonathan Chapman',
    { aka: 'Johnny Applyseed' },
    'Brad Pitt',
    { details: 'Fights Zombies' }
] 
```

With this, you could watch for specific values in any $scope property. I suppose this could come in very handy at times.

Cheers

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-30T09:54:50.290

```
ng-click="flags.open=!flags.open" 
```

switch the value of the `flags.open` to true or false.
And

```
ng-class="{active:flags.open}" 
```

decides whether the class `active` is present or not based on the value of `flags.open`.
Please see the [Fiddle](http://jsfiddle.net/muhammedbasilsk/7RT7b/3/) demonstrating the above example.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-11T06:45:55.350

like this example below :

```
div(ng-class=" condition ? ['class_one', 'class_two'] : ['class_three', 'class_four']") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-04T08:07:25.797

Here's how you can pass expression with filter:

```
 <div ng-class="{ 'customer-page': ('customer' | isRoute), 
  'orders-page': ('orders' | isRoute)  }">....</div> 
```

# html - HTML + CSS：向简单文本添加类/ID

> ID：14735258
> 
> 赞同：9
> 
> 时间：2013-02-06T17:33:30.770
> 
> 标签：html, css

我目前陷入了一个可能非常微不足道的问题：

我有一个带有文本的简单 HTML/CSS 页面：

```
<head></head>
<body>
    This is a Text about Foobar.
</body> 
```

如何在`Text`不破坏格式的情况下为单词分配 CSS-class/id？假设我想向其中添加类`.yellow`，它以黄色背景显示文本。

我想我有一些东西阻碍了我的思维，因为它不会那么困难......但我可以谷歌（主要是琐碎的教程）只在通常的 HTML 元素上使用 CSS，`<p>`或者`<b>`这会破坏我的格式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-06T17:35:40.720

我认为你错过了`<span>`标签。试试这个：

```
<head></head>
<body>
    This is a <span class="yellow">Text</span> about Foobar.
</body> 
```

在 CSS 中：

```
.yellow{
color:yellow;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T17:35:49.073

使用内联元素。跨度是为此目的而构建的。或者，如果您希望在突出显示的部分后面具有语义含义，您可以重新设置样式`<em>`或`<strong>`使用以下内容：

```
strong.highlight{
    font-weight:normal;
    font-style:normal;
    background:yellow;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T17:38:19.700

您只需要将部分包装在一个跨度中，例如：

```
<span>This is a <span class='yellow'>Text</span> about Foobar.</span> 
```

在此处查看工作示例[http://jsfiddle.net/dZZfB/](http://jsfiddle.net/dZZfB/)

希望有帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-27T17:35:24.777

以 HTML 为例：

```
<center><span class="t1">Test1</span></center> 
```

CSS：

```
<style type="text/css">
    .t1 {
        color: white; 
        text-shadow: black 0.1em 0.1em 0.2em;
    }
</style> 
```

# vb.net - 如何在 CheckBox 列上对 WinForms DataGridView 进行排序？

> ID：14735260
> 
> 赞同：0
> 
> 时间：2013-02-06T17:33:44.467
> 
> 标签：vb.net, datagridview, datagridviewcheckboxcell

所以我有一个`DataGridView`自动生成的列，其中一些是复选框列。当我单击复选框列的标题时，它没有排序。我对其进行了研究，结果发现微软没有对复选框列进行自动排序......我认为这很荒谬——对选中/未选中进行排序有多难？

你怎么能得到一个`DataGridView`为你排序的复选框列？

这是我想出的：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-13T10:06:15.360

你也可以简单地这样做：

```
DataGridView.Columns("ColumnOfChoice").SortMode = DataGridViewColumnSortMode.Automatic 
```

适用于 vb.net 4.0

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-24T14:07:15.837

您只需要在表单的代码中添加下一行（在 VB.NET 2013 中测试）

```
Private Sub DataGridView1_ColumnAdded(sender As Object, e As System.Windows.Forms.DataGridViewColumnEventArgs) Handles DataGridView1.ColumnAdded
    If e.Column.GetType Is GetType(DataGridViewCheckBoxColumn) Then
        e.Column.SortMode = DataGridViewColumnSortMode.Automatic
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T17:33:44.467

首先需要挂钩两个事件，列添加事件和列标题点击事件：

```
AddHandler dg.ColumnAdded, AddressOf dgColumnAdded
AddHandler dg.ColumnHeaderMouseClick, AddressOf dgSortColumns 
```

然后，为每个复选框列启用编程排序：

```
Private Sub dgColumnAdded(ByVal sender As Object, _
ByVal e As System.Windows.Forms.DataGridViewColumnEventArgs)
    If e.Column.GetType Is GetType(DataGridViewCheckBoxColumn) Then
        e.Column.SortMode = DataGridViewColumnSortMode.Programmatic
    End If
End Sub 
```

然后，创建一个对复选框列进行排序的处理程序，但对将处理自己的排序的列不执行任何操作：

```
Private Sub dgSortColumns(ByVal sender As Object, _
ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs)
    Dim dg As DataGridView = sender
    Dim c As DataGridViewColumn = dg.Columns(e.ColumnIndex)
    If c.SortMode = DataGridViewColumnSortMode.Programmatic Then
        If dg.SortedColumn IsNot Nothing _
        AndAlso dg.SortedColumn.Name <> c.Name Then
            dg.Sort(c, System.ComponentModel.ListSortDirection.Ascending)
        Else
            Select Case dg.SortOrder
                Case Windows.Forms.SortOrder.None
                    dg.Sort(c, System.ComponentModel.ListSortDirection.Ascending)
                Case Windows.Forms.SortOrder.Ascending
                    dg.Sort(c, System.ComponentModel.ListSortDirection.Descending)
                Case Windows.Forms.SortOrder.Descending
                    dg.Sort(c, System.ComponentModel.ListSortDirection.Ascending)
            End Select
        End If
    End If
End Sub 
```

你去吧！微软真的那么难吗？;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-24T14:16:43.417

我创建了一个可以重复使用的扩展方法，你只需要在表单加载事件期间使用它。

**------ 确保您的 DataSource 是可排序的。------**

如果您将 DataGridView 绑定到一个简单的列表，它不会工作，您需要使用其他东西，我建议您使用[这个 SortableBindingList](http://www.timvw.be/2008/08/02/presenting-the-sortablebindinglistt-take-two/)；您可以将原始 List IEnumerable 直接传递给 SortableBindingList 的构造函数。

加载：

```
private void frmWithTheDataGrid_Load(object sender, EventArgs e)
{
    this.yourDataGridView.SortabilizeMe();
} 
```

然后将其添加到静态类[中以将其用作 ExtensionMethod](http://msdn.microsoft.com/en-us//library/bb383977.aspx) ..

```
public static void SortabilizeMe(this DataGridView dgv)
{
    dgv.ColumnAdded+= delegate(object sender, DataGridViewColumnEventArgs args)
    {
        args.Column.SortMode = DataGridViewColumnSortMode.Programmatic;
    };

    dgv.ColumnHeaderMouseClick += delegate(object sender, DataGridViewCellMouseEventArgs args)
    {
        var col = dgv.Columns[args.ColumnIndex];

        if (dgv.SortedColumn != null && dgv.SortedColumn.Name != col.Name)
        {
            dgv.Sort(row, ListSortDirection.Ascending);
        }
        else
        {
            switch (dgv.SortOrder)
            {
                case SortOrder.None:
                    dgv.Sort(col, ListSortDirection.Ascending);
                    break;
                case SortOrder.Ascending:
                    dgv.Sort(col, ListSortDirection.Descending);
                    break;
                case SortOrder.Descending:
                    dgv.Sort(col, ListSortDirection.Ascending);
                    break;
            }
        }
    };
} 
```

然后魔术就会发生:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-20T03:30:48.447

I'm not sure about VB, but for C# in VS2012 in the designer you can also set the SortMode.

Right-click on the DataGridView and go to "Edit Columns".

There's a drop-down for SortMode with a choice of NotSortable, Automatic, and Programmatic.

It appears that the default for most columns is Automatic, but for checkboxes (boolean) columns the default is NotSortable.

# javascript - jquery remove() 和 detach() 方法

> ID：14735262
> 
> 赞同：-5
> 
> 时间：2013-02-06T17:33:50.677
> 
> 标签：javascript, jquery

我无法区分 jquery remove() 和 detach() 方法，因为它们的作用相同或工作相同，请考虑代码：

```
 <script>
$(document).ready(function(){
$("#btn1").click(function(){
  $("body").append($("#p1").detach());
    });
  $("#btn2").click(function(){
  $("body").append($("#p2").remove());
    });
 $("p").click(function(){
    $(this).animate({fontSize:"+=1px"})
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:36:46.760

从[文档](http://api.jquery.com/detach/)：

> .detach() 方法与 .remove() 方法相同，不同之处在于 .detach() 保留与已删除元素关联的所有 jQuery 数据。当移除的元素稍后要重新插入到 DOM 中时，此方法很有用。

`remove()`完全破坏元素。`detach()`删除元素，保持其数据完整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:38:21.930

该`detach`方法不会删除与元素关联的内部 jQuery 数据（例如事件绑定），因此只有存在任何此类数据时，您才会看到任何差异。

要将文档中的元素从一个位置移动到另一个位置，您不必将其移除或分离，只需将其附加到新位置即可：

```
$("body").append($("#p1")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:38:53.313

您不会看到两者之间的明显差异。这段摘录取自 jQuery 文档：

> .detach() 方法与 .remove() 方法相同，不同之处在于 .detach() 保留与已删除元素关联的所有 jQuery 数据。当移除的元素稍后要重新插入到 DOM 中时，此方法很有用。

请查看每个调用的 API 文档：

[jQuery 删除](http://api.jquery.com/remove/)

[jQuery 分离](http://api.jquery.com/detach/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:48:16.010

正如[文档](http://api.jquery.com/detach/)所解释的，`$.detach()`保留关联的 jQuery 数据，同时`$.remove()`删除该数据。此数据包含绑定事件、动画队列以及您手动添加的任何内容`$.data()`。

在[您的原始示例](http://jsfiddle.net/MattiasBuelens/wmJaV/)中，您应该能够注意到以下场景中的差异：

1.  单击段落。
2.  单击按钮。
3.  再次单击该段落。

对于`#p1`和`#btn1`，第二次单击该段落仍将触发单击处理程序并增加字体大小。这是因为事件处理程序存储在数据中并由`detach()`. 因此，当将它重新附加到 DOM 时，处理程序仍然是绑定的。

`#p2`但是，`#btn2`事件处理程序被删除，并且`remove()`第二次单击该段落不会做任何事情。

`detach()`旁注：当您立即再次将其附加到 DOM 时，您不需要调用。`detach()`如果您想将元素存储在变量中一段时间​​，直到需要重新附加它（使用相同的数据和行为），这可能会很有趣。`remove()`通常用于销毁一个元素，同时清理任何关联的数据。

# c++ - 编译时间优化 - 从发布二进制文件中删除调试打印

> ID：14735265
> 
> 赞同：1
> 
> 时间：2013-02-06T17:33:59.347
> 
> 标签：c++, optimization, logging

这是我的第一篇文章，所以我想和大家一起欢迎。我遇到的问题是编译时的代码优化，更具体地说是删除调试打印。

假设我们有 native`syslog logger`并且我们正在使用以下代码包装它（不使用宏，这是非常重要的注意事项！）：

```
enum severity { info_log, debug_log, warning_log, error_log };
template <severity S>
struct flusher {
  logger* log_;
  flusher(logger* log) : log_(log) {}
  flusher(flusher& rhs) : log_(rhs.log_) {}
  ~flusher() { syslog(S, log_->stream.str()); log_->stream.str(""); }
  operator std::ostream& () { return log_->stream; }
};
#ifdef NDEBUG
template <> struct flusher<debug_log> {
  flusher(logger*) {}
  flusher(flusher&) {}
  ~flusher() {}
  template <typename T> flusher& operator<<(T const&) { return *this; }
};
#endif
struct logger {
  std::ostringstream stream;
  template <severity T>
  flusher<T> operator<<(flusher<T> (*m)(logger&)) { return m(*this); }
};
inline flusher<info_log> info(logger& log) { return flusher<info_log>(&log); }
inline flusher<debug_log> debug(logger& log) { return flusher<debug_log>(&log); }
inline flusher<warning_log> warning(logger& log) { return flusher<warning_log>(&log); }
inline flusher<error_log> error(logger& log) { return flusher<error_log>(&log); } 
```

我认为 flusher 的空实现会鼓励编译器删除这些无用的代码，但是两者都`O2`没有`O3`被删除。

是否有可能引发上述行为？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:56:40.753

我已经成功地完成了你正在尝试的事情，尽管至少有两个不同之处...... 1）我没有使用模板 - 这可能会造成编译器无法优化的复杂性，以及 2）我的日志使用包括宏（见下文）。

此外，您可能已经这样做了，确保所有“空”定义都在记录器的头文件中（因此优化在编译时完成，而不是推迟到链接时）。

```
// use it like this
my_log << "info: " << 5 << endl; 
```

发布定义如下所示：

```
#define my_log if(true);else logger 
```

调试定义如下所示：

```
#define my_log if(false);else logger 
```

请注意，编译器在发布时优化了所有 if(true) 的记录器，并在调试中使用记录器。另请注意，在这两种情况下，完整的 if/else 语法可避免您使用无范围使用的有趣情况，例如

```
if (something)
    my_log << "this" << endl;
else
    somethingelse(); 
```

`somethingelse`没有它会导致`else`my_log 的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:56:20.887

因此，按照评论的代码：

```
inline int f() 
{ 
  std::cout << 1; 
  return 1; 
} 
```

需要做成：

```
inline int f() 
{ 
#ifndef NDEBUG
   std::cout << 1; 
#endif
   return 1; 
} 
```

或类似的东西：

```
#ifndef NDEBUG
static const int debug_enable = 1;
#else
static const int debug_enable = 0;
#endif    

inline int f() 
{ 
   if (debug_enable)
   {
       std::cout << 1; 
   }
   return 1; 
} 
```

您需要以某种方式告诉编译器不需要此代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:05:45.867

您当前的代码不会阻止对 f() 的调用及其可能产生的任何副作用，只会阻止实际打印。这就是为什么宏是解决这个问题的传统方法的原因——它们提供了一个未评估的上下文，您可以在其中检查是否应该在实际打印之前打印该值。

为了在没有宏的情况下实现这一点，需要一些额外的间接方法，例如 std::function、函数指针等。例如，您可以提供一个包含 std::function 的包装类，并专门化您的流运算符来调用 std ::function 在默认情况下，而不是在 NDEBUG 情况下

非常粗略的例子：

```
//Wrapper object for holding std::functions without evaluating
template <typename Func>
struct debug_function_t {
    debug_function_t(Func & f) : f(f) {}
    decltype(f()) operator()() { return f(); }
    std::function<Func> f;
};

//Helper function for type deduction
template <typename Func>
debug_function_t<Func> debug_function(Func & f) { 
    return debug_function_t<Func>(f);
}

struct debug_logger {

    template <typename T>
    debug_logger & operator<<(T & rhs) {}

    template <typename Func> //Doesn't call f(), so it's never evaluated 
    debug_logger & operator<<(debug_function_t<Func> f) { } 

}; 
```

然后在您的客户端代码中

```
int f(){ std::cout << "f()\n"; }
debug_logger log;
log << debug_function(f); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T20:04:12.300

我在一些游戏中使用的技术要求调试打印是一个函数，而不是一个通用表达式。例如：

```
debug_print("this is an error string: %s", function_that_generates_error_string()); 
```

在发布模式下，定义`debug_print`为：

```
#define debug_print sizeof 
```

这将删除`debug_print`并从可执行文件中传递给它的任何表达式。它仍然必须传递有效的表达式，但它们不会在运行时进行评估。

# jquery - 尝试声明新视图对象时“未定义不是函数”

> ID：14735269
> 
> 赞同：0
> 
> 时间：2013-02-06T17:34:18.650
> 
> 标签：jquery, backbone.js, requirejs

我正在从事一个骨干项目，并尝试使用以下行声明一个新视图：

`var tweetCompose = new ComposeTweetView();`

但我得到了错误`Uncaught TypeError: undefined is not a function`

我像这样拉入 ComposeTweetView：

```
define([
  'jquery',
  'underscore',
  'backbone',
  'views/cart/composeTweet'
], function($,_,Backbone,ComposeTweetView){ 
```

composeTweet js 文件看起来像

```
define([
  'jquery',
  'underscore',
  'backbone'

], function($,_,Backbone){

  var composeTweetView = Backbone.View.extend({
    el: '#tweet-compose-popup',
    initialize: function () {

    }
  });
}); 
```

我一直无法找到问题所在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:50:30.207

`return composeTweetView;`关闭 var 后添加到 composeTweet js`composeTweetView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:47:01.280

JavaScript 区分大小写。`composeTweetView`不一样`ComposeTweetView`

# css - Bootstrap css 将容器的一部分隐藏在 navbar navbar-fixed-top 下面

> ID：14735274
> 
> 赞同：131
> 
> 时间：2013-02-06T17:34:39.303
> 
> 标签：css, twitter-bootstrap

我正在使用 Bootstrap 构建一个项目，但我面临的问题很小。我在 Nav-top 下方有一个容器。我的问题是我的容器的某些部分隐藏在 nav-top 标题下方。我不想使用顶部边距容器。请参阅下面的 html，其中我面临这个问题

```
<html>
<head>
<meta name="viewport" content="width=device-width" />
<title>Index</title>
<link rel="stylesheet" href="~/stylesheets/bootstrap.css"/>
<link rel="stylesheet" href="~/stylesheets/bootstrap-responsive.css"/>

</head>
<body>
    <div class="navbar navbar-fixed-top ">
        <div class="navbar-inner">
            <div class="container">
           <button data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar collapsed" type="button">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
                <div class="nav-collapse"><ul class="nav" id="navbar"><li ng-class="{active:section=='plunks'}" class="active"><a href="/plunks/trending"><i class="icon-home"></i>Home</a></li><li><a target="_self" href="/edit/"><i class="icon-calendar"></i>General Election 2014</a></li><li class="divider-vertical">
                    </li><li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">
                        <i class="icon-eye-open">
                        </i>Assembly Elections
                        <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                                <li><a href="#/HTML5Apps">Assembly Elections 2013</a></li>
                        </ul>
                         </li><li class="divider-vertical">
                    </li><li ng-class="{active:section=='tags'}"><a href="/tags"><i class="icon-th"></i>Constituecy</a></li><li ng-class="{active:section=='discuss'}"><a href="/discuss"><i class="icon-time"></i>Election News</a></li><li class="divider-vertical"></li><li><a href="https://github.com/filearts/plunker"><i class="icon-bell"></i>Candidate</a></li></ul></div>
             </div>
         </div>
    </div>
  <div  class="container" >
   <ul class="nav nav-pills">
    <li class="active">
    <a href="#">Popular</a>
    </li>
    <li><a href="#">Trending</a></li>
    <li><a href="#">Latest</a></li>
    </ul>
   </div>

    <script src="~/Scripts/jquery.js"></script>
    <script src="~/Scripts/bootstrap-dropdown.js"></script>
    <script src="~/Scripts/Collapse.js"></script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-02-06T17:42:21.517

这是通过`padding`在`<body>`.

根据[Bootstrap 上的文档`.navbar-fixed-top`](http://getbootstrap.com/components/#navbar-fixed-top)，*尝试您自己的值或使用下面的代码段。*提示：默认情况下，`navbar`为`50px`高。

```
 body {
    padding-top: 70px;
  } 
```

此外，请查看[此示例](http://getbootstrap.com/examples/starter-template/)的源代码并打开[`starter-template.css`](http://getbootstrap.com/examples/starter-template/starter-template.css).

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2015-05-21T01:34:04.893

我猜您遇到的问题与顶部固定**导航栏的动态高度有关。**例如，当用户登录时，您需要显示某种“ *Hello [User Name]* ”，而当名称太宽时，**导航栏**需要使用更高的高度，以便此文本不会与**导航栏**菜单重叠。由于**导航栏**的样式为“*位置：固定*”，因此主体保持在其下方并且其较高的部分被隐藏，因此您需要在每次**导航栏**高度发生变化时“动态”更改顶部的填充，这将发生在以下情况案例场景：

1.  页面已加载/重新加载。
2.  调整浏览器窗口的大小，因为这可能会遇到不同的响应断点。
3.  **导航栏**内容被直接或间接修改，因为这可能会引起高度变化。

这种动态性并没有被常规*CSS覆盖，所以如果用户启用了**JavaScript*，我只能想出一种方法来解决这个问题。请尝试以下*jQuery*代码片段来解决案例场景 1 和 2；**对于案例场景 3，请记住在导航栏**内容发生任何更改后调用函数*onResize() ：*

 **```
var onResize = function() {
  // apply dynamic padding at the top of the body according to the fixed navbar height
  $("body").css("padding-top", $(".navbar-fixed-top").height());
};

// attach the function to the window resize event
$(window).resize(onResize);

// call it also when the page is ready after load or reload
$(function() {
  onResize();
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-08-05T15:14:46.623

只需在固定导航栏之前定义一个空导航栏，它将创建所需的空间。

```
<nav class="navbar navbar-default ">
</nav>
<nav class="navbar  navbar-default navbar-fixed-top ">
     <div class="container-fluid">
// Your menu code 
     </div>
</nav> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-02-06T17:43:53.570

发生这种情况是因为有了`navbar-fixed-top`类，导航栏获得了`position:fixed`. 这反过来将导航栏从文档流中取出，让正文占据导航栏*后面*的空间。

你需要申请`padding-top`或`margin-top`向你的`container`，根据你的要求用价值观`>= 50px`。（或玩弄不同的值）

基本引导**导航栏**的高度约为**`40px`**. 因此，如果您给出一个`padding-top`或`margin-top`一个**`50px`** 或更多，您将始终在*容器和导航栏之间拥有呼吸空间。*

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-11-01T15:05:31.040

我也遇到过这个问题，但没有脚本并且只使用 CSS 解决了它。我首先按照 Bootstrap 网站上描述的 60px 设置为固定菜单推荐 padding-top。然后我添加了三个媒体标签，它们在我的菜单也调整大小的截止点处调整填充大小。

```
<style>      
    body{
        padding-top:60px;
    }
    /* fix padding under menu after resize */
    @media screen and (max-width: 767px) {
        body { padding-top: 60px; }
    }
    @media screen and (min-width:768px) and (max-width: 991px) {
        body { padding-top: 110px; }
    }
    @media screen and (min-width: 992px) {
        body { padding-top: 60px; }
    }
</style> 
```

请注意，当我的菜单宽度在 768 和 991 之间时，我的布局中的菜单徽标加上`<li>`选项会导致菜单换行为两行。因此，我不得不调整 padding-top 以防止菜单覆盖内容，因此为 110px。

希望这可以帮助...

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-02-27T03:12:03.437

我知道这个线程很旧，但我刚刚遇到了这个问题，我通过`page-header`在导航下使用我的页面中的类来修复它。我也使用了`<nav>`标签而不是，`<div>`但我不确定它会呈现任何不同的行为。

将`page-header`用作页面的容器，您不需要弄乱`<body>`，除非您不同意 为您提供的默认空间`page-header`。

```
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

   <div class="container-fluid">
        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Bootstrap</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something else here</a></li>
                                <li role="separator" class="divider"></li>
                                <li class="dropdown-header">Nav header</li>
                                <li><a href="#">Separated link</a></li>
                                <li><a href="#">One more separated link</a></li>
                            </ul>
                        </li>
                </ul>
                <div class="navbar-right">
                </div>
            </div>
        </nav>
    </div>
    <div class="page-header">
        <div class="clearfix">
            <div class="col-md-12">
                <div class="col-md-8 col-sm-6 col-xs-12">
                    <h1>Registration form <br /><small>A Bootstrap template showing a registration form with standard fields</small></h1>
                </div>
            </div>
        </div>
    </div>
        <div class="container">
        <div class="row">
            <form role="form">
                <div class="col-lg-6">
                    <div class="well well-sm"><strong><span class="glyphicon glyphicon-asterisk"></span>Required Field</strong></div>
                    <div class="form-group">
                        <label for="InputName">Enter Name</label>
                        <div class="input-group">
                            <input type="text" class="form-control" name="InputName" id="InputName" placeholder="Enter Name" required>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="InputEmail">Enter Email</label>
                        <div class="input-group">
                            <input type="email" class="form-control" id="InputEmailFirst" name="InputEmail" placeholder="Enter Email" required>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="InputEmail">Confirm Email</label>
                        <div class="input-group">
                            <input type="email" class="form-control" id="InputEmailSecond" name="InputEmail" placeholder="Confirm Email" required>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="InputMessage">Enter Message</label>
                        <div class="input-group">
                            <textarea name="InputMessage" id="InputMessage" class="form-control" rows="5" required></textarea>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
                        </div>
                    </div>
                    <input type="submit" name="submit" id="submit" value="Submit" class="btn btn-info pull-right">
                </div>
            </form>
    </div>
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-03-24T09:40:33.620

如果您使用的是 Bootstrap 5 并希望导航栏位于顶部，请替换`fixed-top`为`sticky-top`.

解决了导航栏下隐藏数据的问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-07-15T12:54:32.350

我用jquery解决了它

```
<script type="text/javascript">
$(document).ready(function(e) {
   var h = $('nav').height() + 20;
   $('body').animate({ paddingTop: h });
});
</script>
```**

# xml - xsl 通过单击链接对 div 进行排序

> ID：14735276
> 
> 赞同：0
> 
> 时间：2013-02-06T17:34:45.533
> 
> 标签：xml, sorting, xslt

我有一个表格（用 xsl 中的 xml 制作），其中每一列都通过单击`<th>`表格的 javascript 进行排序。我也有关于每一行的附加信息的 div。如何在表格排序的同时对 div 进行排序？我的想法是使用 xsl:sort 和`<th>`table 作为某种链接。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T22:42:25.077

不，xsl:sort 可能不会像你想象的那样做……我的建议是使用一些提供数据表的 JavaScript 框架，以及按列排序。让它在 HTML 文件中工作，然后编写 XSLT 以产生该输出。

# android - ViewPagerIndicator 选项卡：文本上方的图标

> ID：14735278
> 
> 赞同：8
> 
> 时间：2013-02-06T17:34:53.120
> 
> 标签：android, icons, viewpagerindicator

我正在使用[ViewPagerIndicator](https://github.com/JakeWharton/Android-ViewPagerIndicator) 并且我想更改选项卡样式，以便我可以在文本上方获取图标，而不是默认设置，它将图标放在左侧，标题放在右侧。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-28T22:20:54.620

图标总是出现在左侧的原因是因为这段代码：

```
if (iconResId != 0) {
     tabView.setCompoundDrawablesWithIntrinsicBounds(iconResId, 0, 0, 0);
} 
```

在发现[`TabPageIndicator.java`](https://github.com/JakeWharton/Android-ViewPagerIndicator/blob/master/library/src/com/viewpagerindicator/TabPageIndicator.java)

这是私有方法 ( `addTab()`) 的一部分，因此在不修改库本身的情况下无法更改。

幸运的是，这并不难做到。确保您已`ViewPagerIndicator`下载源代码，然后打开`TabPageIndicator.java`

如果您想永久更改位置（尽可能永久更改源代码），请更改[setCompoundDrawablesWithIntrinsicBounds()](http://developer.android.com/reference/android/widget/TextView.html#setCompoundDrawablesWithIntrinsicBounds%28int,%20int,%20int,%20int%29)方法`iconResId`中的位置。例如，将图标放在顶部需要是该方法的第二个参数。`iconResId`

```
tabView.setCompoundDrawablesWithIntrinsicBounds(0, iconResId, 0, 0); 
```

如果您需要一些更灵活的东西，我想出了这些`TabPageIndicator.java`应该可以工作的更改（仍在 中）。这些更改已反映[在我的 GitHub 上](https://github.com/andreiciubotariu/Android-ViewPagerIndicator)，因此有一个工作示例。

成员变量：

```
/**
* Constants to improve readability - no magic numbers.
*/
public final static int LOCATION_LEFT =0;
public final static int LOCATION_UP = 1;
public final static int LOCATION_RIGHT = 2;
public final static int LOCATION_BOTTOM =3;

/**
* Stores the location of the tab icon
*/
private int location = LOCATION_LEFT;

/**
* Used to store the icon.
*/
private int [] drawables = new int [4];

/**
 * Holds the value used by setCompoundDrawablesWithIntrinsicBounds used to denote no icon.
 */
private static int NO_ICON = 0; 
```

添加这个方法：

```
public void setTabIconLocation (int newLocation){
    if (location > LOCATION_BOTTOM || location < LOCATION_LEFT)
        throw new IllegalArgumentException ("Invalid location");
    this.location = newLocation;
    for (int x = 0; x < drawables.length;x++){
        drawables [x] = NO_ICON;
    }
} 
```

在`addTab()`, 改变

```
if (iconResId != 0) {
     tabView.setCompoundDrawablesWithIntrinsicBounds(iconResId, 0, 0, 0);
} 
```

至

```
if (iconResId != 0) {
    drawables [location] = iconResId;
    tabView.setCompoundDrawablesWithIntrinsicBounds(drawables[0], drawables[1], drawables[2], drawables[3]);
} 
```

非库实现（取自提供的示例代码）

```
TabPageIndicator indicator = (TabPageIndicator)findViewById(R.id.indicator);
indicator.setTabIconLocation (TabPageIndicator.LOCATION_UP);
indicator.setViewPager(pager); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-28T22:19:34.637

只需修改 ViewPageIndicator 库的源代码中的 1 行即可达到此效果。

要修改的行在方法内部的类中的数字`180`中（至少在今天的代码版本 28/05/2013 上）`TabPageIndicator``addTab`

原始文件是

```
180        tabView.setCompoundDrawablesWithIntrinsicBounds( iconResId, 0, 0, 0 ); 
```

如果您希望图标位于文本之上，则应将其修改为以下内容。

```
180        tabView.setCompoundDrawablesWithIntrinsicBounds( 0, iconResId, 0, 0 ); 
```

这是更改的屏幕截图

![在此处输入图像描述](../Images/aa914ee31e0ac5bbc178b8adea09778b.png)

您现在可能已经猜到了，您可以通过在方法的不同参数中使用 iconResId 将图标放在文本周围的任何位置`setCompoundDrawablesWithIntrinsicBounds`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-09T16:34:14.063

有一种更简洁的方法可以在不修改库的情况下做到这一点。[只需将类TabPageIndicator](https://github.com/JakeWharton/Android-ViewPagerIndicator/blob/master/library/src/com/viewpagerindicator/TabPageIndicator.java)复制并粘贴到您的项目中，然后修改其他答案中指出的行。然后将该类重命名为您喜欢的任何名称，并像使用`TabPageIndicator`.

# permissions - PublicAccess 权限在 Umbraco 6 中不起作用

> ID：14735288
> 
> 赞同：2
> 
> 时间：2013-02-06T17:35:29.283
> 
> 标签：permissions, umbraco

我正在尝试向用户显示一个列出一些文档（节点）的表格。这些文档使用角色权限进行保护（右键单击 > 公共访问 > 角色权限），我只想显示该用户有权访问的文档。

在这里和那里检查之后，我发现没有任何“Node.Permissions”方式，所以你必须通过Access.HasAccess()。

我已经使用了它，并且我已经设置了权限，但是当我使用该方法时，它总是返回 true。我究竟做错了什么？

这是构建节点列表的代码，效果很好：

```
 public static List<Node> GetAllNodeChildrenRecursively(int nodeId, string typeName)
    {
        var node = new Node(nodeId);
        var lstNodes = new List<Node>();
        foreach (Node childNode in node.Children)
        {
                var child = childNode;
                if (child.NodeTypeAlias == typeName)
                {
                    lstNodes.Add(childNode);
                }

                if (child.Children.Count > 0)
                {
                    lstNodes.AddRange(GetAllNodeChildrenRecursively(childNode.Id, typeName));
                }
        }
        return lstNodes;
    } 
```

这是删除我无法访问的代码：

```
 var availableNodes = new List<Node>();
        foreach(Node n in nodes)
        {
            if(Access.HasAccces(n.Id, memberId))
            {
                availableNodes.Add(n);
            }
        }
        return availableNodes; 
```

好吧，Access.HasAccess 总是返回 true，并且我用来测试的成员不是有权访问该节点的 MemberGroup 的一部分。我是否设置了错误的权限或没有正确检查它或什么？

我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T14:21:28.080

据我所知，您应该使用以下方法：

* HasAccess 有几个不同的调用，因此它也可能取决于您的 Umbraco 版本。

```
var availableNodes = new List<Node>();
        try
        {
            //this will throw an argument exception if there is not a current user logged in
            var currentMember = System.Web.Security.Membership.GetUser();

            foreach (Node n in retVal)
            {
                if (Access.HasAccess(n.Id, n.Path, currentMember))
                {
                    availableNodes.Add(n);
                }
            }
        }
        catch(ArgumentException e)
        {
            //do something when there is not a logged in member
        }
        return availableNodes; 
```

# actionscript-3 - 文本字段文本中的影片剪辑

> ID：14735291
> 
> 赞同：1
> 
> 时间：2013-02-06T17:35:35.097
> 
> 标签：actionscript-3, flash, actionscript

我有一个文本字段，我必须在影片剪辑中添加小文本。所以最后变成了。

`text part1`+ `movieclip`+`text Part2`

我想要`text part1`并`text part2`成为单个文本字段。这样当我删除/删除它们之间的电影剪辑时，文本可以是连续的。可以用 Actionscript 3.0 在 Flash 中完成吗？

注意：我不是在谈论影片剪辑中的文本。我希望小电影剪辑适合文本字段。就像可以将图像设置为任何文字处理器程序中的文本一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:48:30.873

`TextField.htmlText`并且`<img src='filename'/>`应该做到这一点，尽管它提供的格式化选项很少。取决于图片的大小，但使用如下：

`textField.htmlText = "Example text" + <img src='pic.jpg'/> + "example text.";`

..将图片插入字符串的中间。

更新：这可用于使用影片剪辑链接标识符插入与文本字段一致的影片剪辑：

`textField.htmlText = "Example text" + <img src='myMC'/> + "example text.";`

更多信息（和示例）[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#htmlText](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#htmlText) [在 TextField 中加载内嵌 MovieClip](https://stackoverflow.com/questions/4766957/load-movieclip-inline-in-textfield)

# c# - 当我使用 StringBuilder.Append 而不是 .AppendLine 时，是否需要添加额外的 .Append(crlf)s？

> ID：14735292
> 
> 赞同：4
> 
> 时间：2013-02-06T17:35:37.307
> 
> 标签：c#, .net, visual-studio, append, stringbuilder

我正在调整我在这里找到的一些代码：http: [//nicholas.piasecki.name/blog/2009/03/sending-raw-epl2-directly-to-a-zebra-lp2844-via-c/#comment-1636](http://nicholas.piasecki.name/blog/2009/03/sending-raw-epl2-directly-to-a-zebra-lp2844-via-c/#comment-1636)，但是在VS 2003/.NET 1.1中，StringBuilder的AppendLine方法不被识别，所以我把它截断为.Append。

我现在需要在每次调用 Append 之后添加 #13#10 左右吗 - 我假设这是 AppendLine 自动执行的操作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T17:37:18.247

是的。

`AppendLine()`将附加其参数，然后是`Environment.Newline`.
如果您不调用`AppendLine()`，则需要自己包含换行符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:43:32.263

是的。不过要小心将其视为 CRLF - 在[内部 StringBuilder 使用 Environment.Newline](http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/ndp/clr/src/BCL/System/Text/StringBuilder@cs/1305376/StringBuilder@cs)因此值得自己使用 Environment.NewLine 以实现交叉兼容性。

```
 [System.Runtime.InteropServices.ComVisible(false)]
    public StringBuilder AppendLine() {
        Contract.Ensures(Contract.Result<stringbuilder>() != null);
        return Append(Environment.NewLine);
    }

    [System.Runtime.InteropServices.ComVisible(false)]
    public StringBuilder AppendLine(string value) {
        Contract.Ensures(Contract.Result<stringbuilder>() != null);
        Append(value);
        return Append(Environment.NewLine);
    } 
```

编辑：除非您因为硬件而特别需要使用 CRLF，否则我猜。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:47:12.580

反编译源码`StringBuilder.AppendLine`

```
/// <summary>
/// Appends the default line terminator to the end of the current <see cref="T:System.Text.StringBuilder"/> object.
/// 
/// </summary>
/// 
/// <returns>
/// A reference to this instance after the append operation has completed.
/// 
/// </returns>
/// <exception cref="T:System.ArgumentOutOfRangeException">Enlarging the value of this instance would exceed <see cref="P:System.Text.StringBuilder.MaxCapacity"/>.
///                 </exception><filterpriority>1</filterpriority>
[ComVisible(false)]
[__DynamicallyInvokable]
public StringBuilder AppendLine()
{
  return this.Append(Environment.NewLine);
} 
```

# python - 检查一个实例是'StringIO'

> ID：14735295
> 
> 赞同：0
> 
> 时间：2013-02-06T17:35:42.667
> 
> 标签：python, stringio

```
>>> import cStringIO
>>> a = cStringIO.StringIO()
>>> type(a)
<type 'cStringIO.StringO'>
>>> isinstance(a, cStringIO.StringO)

Traceback (most recent call last):
  File "<pyshell#223>", line 1, in <module>
    isinstance(a, cStringIO.StringO)
AttributeError: 'module' object has no attribute 'StringO' 
```

我需要将一些数据（类似文件的对象）返回给 wsgi 应用程序。如果该数据还不是 cStringIO 对象（因为我不想再次重新读取内存），那么该数据将被加载到 cStringIO 对象，但是 isinstance(a, cStringIO.StringO) 或 isinstance(a, cStringIO.StringIO) 都抛出一个例外。如何检查实例是否为 cStringIO 对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T17:37:28.987

使用[`cStringIO.InputType`and`cStringIO.OutputType`](http://docs.python.org/2/library/stringio.html#cStringIO.InputType)代替：

```
>>> import cStringIO
>>> s = cStringIO.StringIO('output')
>>> isinstance(s, cStringIO.InputType)
True
>>> s = cStringIO.StringIO()
>>> isinstance(s, cStringIO.OutputType)
True 
```

# mysql - 从 mysql-client 即时运行的慢查询

> ID：14735300
> 
> 赞同：0
> 
> 时间：2013-02-06T17:36:01.940
> 
> 标签：mysql

我在 /var/log/mysql/mysql-slow.log 中记录了一个慢查询，使用 PDO 从 php 运行，当我将它复制粘贴到 mysql-client 中时，即使在重新启动 mysql 后，我也会立即得到答案。你怎么解释？

这是查询：

> 从 some_table u WHERE 中选择 many_fields（u.created_at >= '2011-11-01' AND u.created_at <= '2012-02-01' AND u.valid 为真且 u.test 为 FALSE）；

这是查询的解释：

```
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows  | Extra       |
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+
|  1 | SIMPLE      | u     | ALL  | NULL          | NULL | NULL    | NULL | 86460 | Using where |
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+ 
```

这是运行 php 脚本时 SHOW FULL PROCESSLIST 的输出：

```
+-----+---------+-----------+-----------------------+---------+------+-------+-----------------------+
| Id  | User    | Host      | db                    | Command | Time | State | Info                  |
+-----+---------+-----------+-----------------------+---------+------+-------+-----------------------+
|   9 |some_user| localhost | some_db               | Query   |    0 | NULL  | SHOW FULL PROCESSLIST |
| 187 |some_user| localhost | some_db               | Sleep   |    6 |       | NULL                  |
+-----+---------+-----------+-----------------------+---------+------+-------+-----------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:43:52.390

正如您在回复我的评论时所说，您正在记录不使用索引的查询。此查询未使用索引，因此它会与慢查询一起记录。由于不使用索引而记录的查询在记录时会忽略最短执行时间。

编辑： 中的`Time`列`SHOW FULL PROCESSLIST`显示它处于当前状态的时间，通常设置为`Sleep`查询完成时，因此时间对于计时查询不可靠。要获得更可靠的查询时间，您需要使用分析或其他更直接与查询一起工作的基准测试方法。

# android - 两个具有不同附加功能的活动通知

> ID：14735307
> 
> 赞同：2
> 
> 时间：2013-02-06T17:36:14.890
> 
> 标签：android, android-notifications, android-pendingintent

我需要创建 2 个通知，但如果我最后使用 FLAG_UPDATE_CURRENT 或 FLAG_CANCEL_CURRENT，它们都会获得相同的额外通知，否则使用第一个。

```
NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);

for(int num=1;num<3;num++){
    Intent intent = new Intent(this, ActivityNotification.class); 
    intent .putExtra("reminder_id", num);
    PendingIntent pi = PendingIntent.getActivity(this, num, intent , 0);
    // PendingIntent pi = PendingIntent.getActivity(this, num, intent , PendingIntent.FLAG_UPDATE_CURRENT);
    Notification noti = new Notification.Builder(this)
        .setContentIntent(pi)
        .setContentTitle(title)
        .setContentText(text)
        .setSmallIcon(R.drawable.noti)
        .setWhen(when)
        .setAutoCancel(true)
        .build();
    noti.flags |= Notification.FLAG_AUTO_CANCEL;
    notificationManager.notify(num, noti);          
} 
```

我怎样才能有不同的附加功能？或者一般来说，我的 ActivityNotification 怎么知道是哪个通知调用了它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T00:52:10.137

[如此处](https://stackoverflow.com/a/10538554/281545)所述：

*   选项 #1：在每个 Intent 中放置不同的操作字符串。在您的代码中：

    ```
    intent.putExtra("reminder_id", num);
    intent.setAction("com.yourapplic.intent.action.ACTION_NAME" + num);
    PendingIntent pi = PendingIntent.getActivity(this, num, intent , 0); 
    ```

*   选项 #2：在 getActivity() 调用中使用不同的 requestCode（第二个参数）。这显然不适用于您的情况

# jquery - 在表单中使用 jquery 的困难

> ID：14735314
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:36:42.803
> 
> 标签：jquery, html

我有一个表格，当我提交我的变量值时，我的变量将变为空。知道可能是什么吗？

我的代码：

```
 $('#botaoSalvar').click(function () {
                $('form').trigger('submit');
            });

            $('form').submit(function () {
                if (defaults.tipoAcao == 2) {
                    var retorno = ($('form').serialize());
                } else {
                    var retorno = nomeidRegistro + '=' + idRegistro + '&' + ($(this).serialize());
                }
                debugger
                return retorno; 
```

HTML：

```
<div id="alterarDados" aria-labelledby="ui-id-4" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" style="display: block;" aria-expanded="true" aria-hidden="false"><h3>Alterar Registro</h3>
 <form id="formAlterar" action="/teste/index3" method="post">
    <div id="corpoTabelaAlterar"><tr id="atributo2">
    <td><label for="DescricaoBaseDados">DescricaoBaseDados:</label>
    </td><td><input type=" name=" descricaobasedados"="" value="1">
    </td></tr><tr id="atributo3"><td><label for="NomeBaseDados">NomeBaseDados:</label>
    </td><td><input type=" name=" nomebasedados"="" value="1">
    </td></tr><tr><td><input id="botaoVoltar" type="button" value="Voltar" name="voltar">
    </td><td><input id="botaoSalvar" type="submit" value="Salvar" name="salvar">
    </td></tr></div><table cellpadding="4" cellspacing="1" width="450" id="tabelaAlterar">

    </table>
  </form>
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:00:30.913

您的代码中有一些错误：

```
</td><td><input type=" name=" descricaobasedados"="" value="1">
</td></tr><tr id="atributo3"><td><label for="NomeBaseDados">NomeBaseDados:</label>
</td><td><input type=" name=" nomebasedados"="" value="1"> 
```

您的`type`属性未在上面设置。您在`name`属性的语法中也有错误。它应该遵循类似于以下的格式：

```
<input type="text" name="descricaobasedados" value="1"> 
```

用你正在使用的`type`任何东西替换。`type`

我不知道这是否是您的全部问题，但我相信这肯定是有贡献的。`name`使用该属性发布（提交）表单中的输入。如果属性未正确定义，您可能会收到`null`值。

希望这可以帮助。

# c++ - “munmap_chunk（）：无效指针”错误

> ID：14735319
> 
> 赞同：3
> 
> 时间：2013-02-06T17:36:55.560
> 
> 标签：c++, linux

我在 Linux 中用 Python 和 C++ 编写了一个程序，我用脚本启动了它`./run.sh`。我遇到了这样一个奇怪的现象：

起初，我编译了我的文件，然后执行 ./run.sh --> 一切都很好

*   我重新运行 ./run.sh --> 错误
*   如果我重新编译并重新运行 --> 就可以了。

因此，为了不产生错误，我必须在运行之前重新编译代码。

错误是：`munmap_chunk(): invalid pointer`

我的代码如下：

```
float percentage = 0.0;

for (int i = 0; i < N_cubes; i++) {
    float newPercentage = i * 100.0/N_cubes;

    if ((newPercentage - percentage) >= 10.0) {
        std::cout
            << "Computing Z_CFIE_near chunk. "
            << std::floor(newPercentage)
            <<  " % completed."
            << endl;
        flush(std::cout);
        percentage = newPercentage;
    }

    // computing the local arrays
    int N_RWG_test, N_RWG_src, N_neighbors, N_nodes, S;

    blitz::Array<int, 1> test_RWGsNumbers, src_RWGsNumbers;
    blitz::Array<int, 1> neighbors_cubes;
    blitz::Array<int, 2> localTestSrcRWGNumber_signedTriangles, localTestSrcRWGNumber_nodes;
    blitz::Array<double, 2> nodesCoord;
    blitz::Array<double, 1> rCubeCenter(3);

    compute_cube_local_arrays(
        N_RWG_test,
        N_RWG_src,
        N_neighbors,
        N_nodes,
        S,
        test_RWGsNumbers,
        src_RWGsNumbers,
        neighbors_cubes,
        localTestSrcRWGNumber_signedTriangles,
        localTestSrcRWGNumber_nodes,
        nodesCoord,
        rCubeCenter,
        allCubeIntArrays(i),
        allCubeDoubleArrays(i));

    // computing the Z_CFIE
    blitz::Array<std::complex<double>, 2> Z_CFIE_J(N_RWG_test, N_RWG_src);
    blitz::Array<std::complex<float>, 1> Z_CFIE_J_linear(N_RWG_test * N_RWG_src);
} 
```

据我了解，这个错误是因为在几次循环`Z_CFIE_J`后`Z_CFIE_J_linear`无法释放（局部变量将在每次循环后释放）。

你能给我一些想法来解决这个问题吗？

# reporting-services - SSRS Tablix 插入行键盘快捷键

> ID：14735328
> 
> 赞同：5
> 
> 时间：2013-02-06T17:37:25.870
> 
> 标签：reporting-services, bids, ssrs-tablix

我有几个 SSRS 报告要为需要有表格布局的客户创建。我知道有些人不赞成仅将 Tablix 用于此目的，但尝试对齐矩形和其他控件非常耗时。

其中许多表有超过 50 行（多列），我经常需要执行序列**"右键单击 >> 插入行 >> 下方"**。这是非常重复的，我想知道是否有人知道完成任务的更好方法。

除了谷歌搜索可能的解决方案外，我还试图在 SO 上找到一个类似的问题，但我无法找到有解决方案的确切问题的人。

我尝试过的一个选项是使用 VS2008 选项中的自定义快捷键创建我自己的键盘快捷键。有四个可能的选项没有分配快捷方式：

*   OtherContextMenus.RowColumn.InsertRowAbove
*   OtherContextMenus.RowColumn.InsertRowAbove
*   OtherContextMenus.RowColumn.InsertRowBelow
*   OtherContextMenus.RowColumn.InsertRowBelow

不幸的是，我尝试映射四个命令中的任何一个都没有成功。如果这些是命令，并且有人成功完成了我想要做的事情，请告诉我。如果这些命令不适用于 Tablix 设计器，是否有其他人有适合他们的解决方案？

**编辑：**我将使用此表的主要报告仅填充页面顶部的几个文本框。该表本身不包含任何数据，用于保存学生的成绩。50 多行是已评分的类别，有 12 列代表班级中的学生。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T02:42:34.427

我同意你的基本方法——表格是一种更容易控制布局的方法。

要快速复制行，请右键单击解决方案资源管理器中的报表并选择查看代码。在表中找到要复制的 TablixRow XML 节点，然后根据需要多次复制和粘贴。确保将整个节点从开始标记复制到结束标记。

提示 - 在复制之前使用左侧的展开/折叠切换来折叠源 TablixRow XML 节点 - 有助于避免复制错误。

显然，请确保您备份了您的报告，以防万一您搞砸了！

# r - 更改矢量名称

> ID：14735335
> 
> 赞同：1
> 
> 时间：2013-02-06T17:37:39.683
> 
> 标签：r

为了整理我的数据，我使用了以下功能 -

```
tolower(gsub("\\.","",names(data))) 
```

从长向量名称中删除大写字母和点 (.)，例如`Last.Inquiry.For.Loan`

它工作并回馈：`lastinquiryforloan`。但它没有坚持。当我运行时`summary(data)`，我会看到所有旧的向量名称。如何使这种更改永久化，以便我更轻松地进行分析？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:51:51.530

Arun 是说您从未真正替换过旧名称。尝试

```
names(data) <- tolower(gsub("\\.","",names(data))) 
```

# asp.net - 是否有下划线和其他 js 库的 js intellisense 文件？

> ID：14735350
> 
> 赞同：1
> 
> 时间：2013-02-06T17:38:31.010
> 
> 标签：asp.net, visual-studio, visual-studio-2012, intellisense, vsdoc

有`-intellisense.js`或`-vsdoc.js`文件用于向 Visual Studio 添加完整的 jQuery 和 jQuery Validation intellisense - 即命名空间、函数、参数、返回值、备注等。

*   Underscore有这样的东西吗？您可以通过将库添加到`_references.js`文件中来获得基本的智能感知，但是上面详述的其余部分呢？

*   是否有一个包含所有当前可用智能感知文件的列表？例如，将这些用于：淘汰赛、Google API（如地图和地理定位）、RequireJS、Bootstrap 等会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T17:27:07.007

似乎没有办法做到这一点。

# mysql - 插入当前日期时间

> ID：14735351
> 
> 赞同：0
> 
> 时间：2013-02-06T17:38:37.263
> 
> 标签：mysql, time

我正在尝试将当前日期和时间插入特定列，但我做错了我无法弄清楚的事情。

我试过了：`UPDATE v_extradatacomputers SET LastRun=NOW();`

我也试过`INSERT INTO v_extradatacomputers ( LastRun) VALUE ('NOW());`

当谈到 mySQL 时，我有点菜鸟，所以任何人都可以给我的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:48:57.307

如果您尝试插入当前时间和日期，则需要使用`INSERT`not `UPDATE`。语法是：

```
INSERT INTO tableName (dateTimeColumn) VALUES (NOW()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:40:53.060

在第一次尝试中使用 now() 之间的 ''。

还要检查 now() 值是否设置为 time() 如果单元格设置为整数或 date("Ymd H:i:s") 如果它是 datetime, date("Ymd") 用于日期单元格和任何其他格式检查您是否使用过 varchar。

编辑：顺便说一句，你能用 mysql_error() 知道确切的 SQL 错误是什么吗？

# mysql - MySQL 在选择中找不到视图 *

> ID：14735354
> 
> 赞同：2
> 
> 时间：2013-02-06T17:38:43.970
> 
> 标签：mysql, sql, sql-view

我的数据库中有许多表和几个相互构建的视图。当我尝试像这样查询视图时：

```
select [db].[view].* from [db].[view]; 
```

我收到以下错误`ERROR 1051 (42S02): Unknown table '[view]'`。

`[db]`并且`[view]`是实际数据库和视图名称的占位符。

当我省略`[db]`部分时，一切正常。此外，对于某些视图，它可以使用`[db]`前置，而在其他视图中则不行。

有人知道为什么会发生这种情况或如何避免这种情况吗？

查询是由我使用的抽象层生成的，因此我无法直接控制它们。

编辑：我发现它与 * 选择器有关，因为当我写出所有字段名称时它不会发生。对我来说似乎是一个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:39:25.633

`MySQL`使用反引号分隔符来转义一些保留关键字，而不是 TSQL 使用的括号。

```
SELECT `db`.`view`.* FROM `db`.`view`; 
```

如果您的标识符上有括号

```
SELECT `[db]`.`[view]`.* FROM `[db]`.`[view]` 
```

# mysql - Magento - 在类别的自定义设计中添加一个选项

> ID：14735358
> 
> 赞同：1
> 
> 时间：2013-02-06T17:38:55.033
> 
> 标签：mysql, zend-framework, magento-1.7, php

在`Catalog > Manage Categories` Under`Custom Design`选项卡中，我想在下方添加一个新字段`Apply to Products`。

搜索后我发现了一个 php 文件

```
app\code\core\Mage\Catalog\controllers\CategoryController.php 
```

但我找不到创建这些选项卡的确切位置`Custom Design`以及添加字段的方式。

由于更改管理面板文件不是一个好主意，我需要继承哪个类来创建在编辑类别中添加字段的扩展？

我发现它正在加载字段

```
app\code\core\Mage\Adminhtml\Block\Catalog\Category\Tab\Design.php 
```

并且似乎字段是在数据库中定义的

```
catalog_eav_attribute` table and `eav_attribute table 
```

我在数据库中添加了一个新字段但没有成功。我如何构建这个扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T01:39:48.500

我发现那个toturial。希望这有帮助:)

> [http://www.atwix.com/magento/add-category-attribute/](http://www.atwix.com/magento/add-category-attribute/)

# scala - 尝试针对 Scala 2.9.2 构建和运行 Apache Kafka 0.8 但没有成功

> ID：14735363
> 
> 赞同：4
> 
> 时间：2013-02-06T17:39:04.793
> 
> 标签：scala, apache-kafka

如主题描述中所述，我正在尝试`Kafka 0.8`使用`Scala 2.9.2`.

`0.8`我能够使用( [https://cwiki.apache.org/KAFKA/kafka-08-quick-start.html](https://cwiki.apache.org/KAFKA/kafka-08-quick-start.html) )的快速入门获得一个工作版本，但`Scala 2.8.0`默认情况下它是针对它编译的。

我试图修改步骤

```
./sbt package 
```

到

```
./sbt "++2.9.2 package" 
```

它编译没有错误，但在启动期间它抱怨它找不到主类。

```
/tmp/kafka-8-test/kafka[0.8]$ bin/kafka-server-start.sh onfig/server1.properties
Error: Could not find or load main class kafka.Kafka 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T07:36:03.240

`kafka-run-class.sh`被硬编码为*Scala 2.8.0。*您可以按照 prenomenon 的建议将 2.8.0 更改为 2.9.2。

这对我有用：

*   Linux|Unix

    `sed -i "s/2.8.0/2.9.2/g" bin/kafka-run-class.sh`

*   苹果系统

    `sed -i.bak "s/2.8.0/2.9.2/g" bin/kafka-run-class.sh`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T17:47:10.783

问题是bin/kafka-server-start.sh脚本使用bin/kafka-run-class.sh来执行生成的jar文件。

这个脚本有硬编码的版本，所以你需要像这样自定义它：

```
...
library=$(echo "$ivyPath/org.scala-lang/scala-library/jars/scala-library-2.9.2.jar")
CLASSPATH=$CLASSPATH:$library

compiler=~$(echo "$ivyPath/org.scala-lang/scala-compiler/jars/scala-compiler-2.9.2.jar")
CLASSPATH=$CLASSPATH:$compiler

log4j=$(echo "$ivyPath/log4j/log4j/jars/log4j-1.2.15.jar")
CLASSPATH=$CLASSPATH:$log4j

slf=$(echo "$ivyPath/org.slf4j/slf4j-api/jars/slf4j-api-1.6.4.jar")
CLASSPATH=$CLASSPATH:$slf

zookeeper=$(echo "$ivyPath/org.apache.zookeeper/zookeeper/jars/zookeeper-3.3.4.jar")
CLASSPATH=$CLASSPATH:$zookeeper

jopt=$(echo "$ivyPath/net.sf.jopt-simple/jopt-simple/jars/jopt-simple-3.2.jar")
CLASSPATH=$CLASSPATH:$jopt

for file in $base_dir/core/target/scala-2.9.2/*.jar;
do
  CLASSPATH=$CLASSPATH:$file
done

for file in $base_dir/core/lib/*.jar;
do
  CLASSPATH=$CLASSPATH:$file
done

for file in $base_dir/perf/target/scala-2.9.2/kafka*.jar;
do
  CLASSPATH=$CLASSPATH:$file
done
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-11T17:35:50.017

对于最新版本的 Kafka 0.8.1.1 和 gradlew，“SCALA_VERSION”是脚本中的一个变量。

SCALA_VERSION=2.10.4

但是，在某处出现问题后：

``` ./gradlew -PscalaVersion=2.10.4 jar

```

其中一个文件没有*2.10.4*部分，但只有 2.10 ：

`peter_v@trusty64:~/data/kafka/kafka-0.8.1.1-src$ find . -name '*.jar' ./perf/build/libs/kafka-perf_2.10-0.8.1.1.jar ./clients/build/libs/kafka-clients-0.8.1.1.jar ./system_test/migration_tool_testsuite/0.7/lib/kafka-perf-0.7.0.jar ./system_test/migration_tool_testsuite/0.7/lib/kafka-0.7.0.jar ./system_test/migration_tool_testsuite/0.7/lib/zkclient-0.1.jar ./examples/build/libs/kafka-examples-0.8.1.1.jar ./core/build/libs/kafka_2.10-0.8.1.1.jar ############ 2.10 instead of 2.10.4 ? ./core/build/dependant-libs-2.10.4/snappy-java-1.0.5.jar ./core/build/dependant-libs-2.10.4/metrics-core-2.2.0.jar ./core/build/dependant-libs-2.10.4/zkclient-0.3.jar ./core/build/dependant-libs-2.10.4/log4j-1.2.15.jar ./core/build/dependant-libs-2.10.4/slf4j-api-1.7.2.jar ./core/build/dependant-libs-2.10.4/zookeeper-3.3.4.jar ./core/build/dependant-libs-2.10.4/jopt-simple-3.2.jar ./core/build/dependant-libs-2.10.4/scala-library-2.10.4.jar ./target/scala-2.10/kafka-0-8-1-1-src_2.10-0.1-SNAPSHOT.jar ./lib/apache-rat-0.8.jar ./contrib/hadoop-consumer/lib/piggybank.jar ./contrib/hadoop-consumer/build/libs/kafka-hadoop-consumer-0.8.1.1.jar ./contrib/hadoop-producer/lib/piggybank.jar ./contrib/hadoop-producer/build/libs/kafka-hadoop-producer-0.8.1.1.jar ./contrib/build/libs/contrib-0.8.1.1.jar ./gradle/wrapper/gradle-wrapper.jar`

使用 2.10.4 名称的副本作为解决方法，Kafka 正确启动。

```

cp core/build/libs/kafka_2.10-0.8.1.1.jar core/build/libs/kafka_2.10.4-0.8.1.1.jar ```

# bash - 无法将“python -V”的输出分配给 bash 中的变量

> ID：14735366
> 
> 赞同：2
> 
> 时间：2013-02-06T17:39:18.933
> 
> 标签：bash, shell

我正在编写一个 shell 脚本，在检查系统上的 python 版本后做一些工作。

我做了 a=`python -V` 和 $a 的回声：

```
[root@machine folder]# a=`python -V`
Python 2.3.4
[root@machine folder]# echo $a 
```

什么`echo $a`都不输出

同时我这样做：

```
[root@machine folder]# if grep "2.3.4" `python -V` ; then echo "bad" ; fi
Python 2.3.4 
```

在我按 Enter 后，它只输出 python 的版本，但没有别的。

为什么它会这样？我还有其他方法可以完成相同的任务吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T17:40:52.287

`python -V`似乎在输出`stderr`。如果你跑

```
a=`python -V` 
```

输出出现在控制台上（即它没有被子shell分配拾取）。但是，如果您重定向`stderr`到标准输出，那么

```
a=`python -V 2>&1` 
```

作品

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T09:38:07.067

真的值得通过 Python 询问`sys`吗？

```
 python -c "import sys; print sys.version_info[0:3]"

 (2, 7, 3) 
```

这样一来，除了检查版本之外，还可以检查版本值。

```
pyver=$(python -c "import sys; print sys.version_info[0:3]")
required="(2, 7, 1)"
echo pyver=$pyver

if [[ "$pyver" > "$required" ]] ; then
    echo safe to proceed
else
    echo  require Python version ">" $required got $pyver
fi

required="(3, 0, 0)"
if [[ "$pyver" > "$required" ]] ; then
    echo safe to proceed
else
    echo  require Python version ">" $required got $pyver
fi

#-- use integer values --
echo  Integer version
# Trouble being the output looks odd but allows use of -gt
pyver=$(python -c "import sys; print '%03d%03d%03d' % sys.version_info[0:3]")
required="002007001"
echo pyver=$pyver

if [[ $pyver -gt  $required ]] ; then
    echo safe to proceed
else
    echo  require Python version $required got $pyver
fi

required="003000000"
if [[ $pyver -gt $required ]] ; then
    echo safe to proceed
else
    echo  require Python version $required got $pyver
fi 
```

使用 Python 2.7.3 版在我的系统上输出

```
pyver=(2, 7, 3)
safe to proceed
require Python version > (3, 0, 0) got (2, 7, 3)
Integer version
pyver=002007003
safe to proceed
require Python version 003000000 got 002007003 
```

# java - JaperReport maven Pom.xml 没有创建.jasper 文件

> ID：14735367
> 
> 赞同：0
> 
> 时间：2013-02-06T17:39:22.297
> 
> 标签：java, maven, jasper-reports

我在通过 pom.xml 将 .jrxml 编译为 .jasper 时遇到问题。在给出 mvn clean install、mvn -e compile、mvn eclipse:eclipse 之后，我无法生成 .jasper。下面是我的 pom.xml。我确定我错过了一些东西，但不确定是什么。请帮忙..谢谢提前:) net.sf.jasperreports jasperreports 4.8.0

```
<plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>jasperreports-maven-plugin</artifactId>
                <version>1.0-beta-2</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>compile-reports</goal>
                        </goals>
                        <configuration>
                            <!--  jrxml file  directory-->
                            <sourceDirectory>src\\main\\resources\\reports\\template</sourceDirectory>
                            <sourceFileExt>.jrxml</sourceFileExt>
                            <compiler>net.sf.jasperreports.engine.design.JRJavacCompiler</compiler>
                            <!--  Destination for jasper file -->
                            <outputDirectory>src\\main\\resources\\reports\\jasper</outputDirectory>
                        </configuration>
                    </execution>
                </executions>
                <dependencies>
                    <!-- These plugins are used to specify correct version for jrxml xml validation -->
                    <dependency>
                        <groupId>net.sf.jasperreports</groupId>
                        <artifactId>jasperreports</artifactId>
                        <version>4.8.0</version>
                    </dependency>
                 </dependencies>
            </plugin>
        </plugins>

      </build>

    </profile>
  </profiles> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T19:02:24.727

这是对我有用的片段

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jasperreports-maven-plugin</artifactId>
            <version>1.0-beta-2</version>
            <configuration>
                <sourceDirectory>src/main/webapp/WEB-INF/reports</sourceDirectory>
                <outputDirectory>src/main/webapp/WEB-INF/reports</outputDirectory>
            </configuration>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <goals>
                        <goal>compile-reports</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>jasperreports</groupId>
                    <artifactId>jasperreports</artifactId>
                    <version>3.5.3</version>
                </dependency>
                <dependency>
                    <groupId>log4j</groupId>
                    <artifactId>log4j</artifactId>
                    <version>1.2.16</version>
                </dependency>
            </dependencies>
        </plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:38:07.847

我在 src\main\jasper 中创建了 .jasper -----不是直接在 src\main 中的资源。现在我无法阅读 java 代码。它总是返回 null。请帮忙。我试过：

1) 文件file = new File(ReportConnection.class.getClassLoader().getResource("src/main/jasperreports/sample_Report.jasper").toString());

2)URL 资源 = ClassLoader.getSystemResource("src/main/jasperreports/sample_Report.jasper");

3) FILE_BASE_FOLDER_ON_CLASSPATH = "src//main//jasperreports"; iStream = ReportConnection.class .getClassLoader() .getResourceAsStream(FILE_BASE_FOLDER_ON_CLASSPATH + "sample.jasper");

# php - foreach、JSON 和 PHP

> ID：14735369
> 
> 赞同：0
> 
> 时间：2013-02-06T17:39:27.843
> 
> 标签：php, foreach, getjson

我查看了各种答案，我假设这是由于缺少 foreach 循环，我只收到一个变量。共有 32 个类别，每个类别都有多个链接。

**表结构**：

```
CREATE TABLE `cattb` (
  `catNo` int(11) NOT NULL,
  `catName` varchar(100) NOT NULL,
  PRIMARY KEY  (`catNo`)
) 

CREATE TABLE `linktb` (
  `catId` int(11) NOT NULL,
  `URL` varchar(255) NOT NULL,
  `title` varchar(50) NOT NULL,
  `description` longtext NOT NULL,
  KEY `catId` (`catId`)
) 
```

**SQL查询**：

```
SELECT catId, catName, URL, title, description FROM linktb, cattb WHERE linktb.catId=cattb.catNo 
```

**PHP**：

```
while ($row = mysql_fetch_assoc($result)){ 
    $json['categories'][] = array( 
        "catId"=> $row[catId],
        "catName"=> $row[catName],
        'links' => array( 
            "URL"=> $row[URL],
            "title"=> $row[title],
            "description"=> $row[description]
        )
    ); 
```

**回复：**

```
"categories":[
    {"catId":"1",
    "catName":"Career Resources",
    "links":
        {"URL":"http:\/\/www.designanddesign.com\/jobs.php",
        "title":"Design & Design",
        "description":"World-Wide Job Offers"
        }
    },
    {"catId":"1",
    "catName":"Career Resources",
    "links":
        {"URL":"https:\/\/www.nuans.com\/rts-str\/en\/home-accueil_en.cgi",
        "title":"NUANS Report",
        "description":"Naming A Company (Federal)"
        }
    } 
```

**我想看到的：**

```
{   categories: [
    {   catName: "Career Resources",
        catId: "1",
        links: [
            {URL:"http://www.designanddesign.com/jobs.php",title:"Design & Design",description:"World-Wide Job Offers"},
            {URL:"https://www.ic.gc.ca/app/scr/cc/CorporationsCanada/hm.html?locale=en_CA",title:"Corporations Canada",description:"Incorporating a Business"},
            {URL:"http://lea.verou.me/css3patterns/",title:"CSS3 Patterns",description:"Patterns to use for backgrounds"},
            {URL:"http://webdesignerwall.com/tutorials/cross-browser-css-gradient",title:"CSS Gradients",description:"Cross-browser Compatible"}
            ],
    },
    {   catName: "CSS",
        catId: "2",
        links: [
            {URL:"http://www.designanddesign.com/jobs.php",title:"Design & Design",description:"World-Wide Job Offers"},
            {URL:"https://www.ic.gc.ca/app/scr/cc/CorporationsCanada/hm.html?locale=en_CA",title:"Corporations Canada",description:"Incorporating a Business"},
            {URL:"http://lea.verou.me/css3patterns/",title:"CSS3 Patterns",description:"Patterns to use for backgrounds"},
            {URL:"http://webdesignerwall.com/tutorials/cross-browser-css-gradient",title:"CSS Gradients",description:"Cross-browser Compatible"}
            ],
    } 
```

我将如何为数组编写 for-each 循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:42:03.760

在您的循环中，您将在每次迭代`while`时重置。`$json['categories']`

尝试

```
while ($row = mysql_fetch_assoc($result)){ 
    $json['categories'][] = array( 
        "catId"=> $row[catId],
        "catName"=> $row[catName],
        'links' => array( 
            "URL"=> $row[URL],
            "title"=> $row[title],
            "description"=> $row[description]
        )
    ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T19:29:18.167

通过按 id 对它们进行索引来跟踪您看到的类别。如果您已经看过该类别，请添加到 links 数组。完成后设置 $json['categories'] 。

```
$catRows = array();

while ($row = mysql_fetch_assoc($result)) {
    $id = $row['catId'];
    $links_entry = array(
        'URL' => $row['URL'],
        'title' => $row['title'],
        'description' => $row['description']
    );
    if (!isset($catRows[$id])) {
        $catRows[$id] = array(
            'catId' => $id,
            'catName' => $row['catName'],
            'links' => array($links_entry)
        );
    } else {
        $catRows[$id]['links'][] = $links_entry;
    }
}

$json['categories'] = array_values($catRows); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:04:18.573

对于您的第一个问题，即“获得单一条目”。采用

```
$items = array();   
while ($row = mysql_fetch_assoc($result)){ 
    $json['categories'] = array( 
        "catId"=> $row[catId],
        "catName"=> $row[catName],
        'links' => array( 
            "URL"=> $row[URL],
            "title"=> $row[title],
            "description"=> $row[description]
        )
    );
    $items[] = $json['categories'];
 } 
```

`links`关于您在数组中有单个条目的下一个问题。您当前的架构有问题。我现在看到的方式是，您已经`catName`并且您已经在单个表中获得了有关该 catName 的链接和内容。这太多余了。您可以进一步对其进行规范化，并为 url 链接、标题和描述设置单独的表**cat_meta**，以及为您指出猫的 catId。接下来在选择数据时使用连接。这将从 cat_meta 返回**与**您的查询匹配的整数数组。然后您使用`foreach`并迭代它以形成该`links`数组。

# php - PHP：不正确的 JSON 解码和带斜线 \t \n

> ID：14735371
> 
> 赞同：0
> 
> 时间：2013-02-06T17:39:37.023
> 
> 标签：php, json, stripslashes, magic-quotes-gpc

我认为在我正在工作的服务器中，magic_quotes 处于活动状态，当从 jquery.ajax 接收到 json 时，我会这样做：

```
alcancesP = stripslashes($_POST['alcances']); 
```

在我解码 alcancesP 之后：

```
$dataAlcances = json_decode(alcancesP,true); 
```

但是当我将**$dataAlcances**传递给 foreach 时，'\' 会消失，但 T 和 N 不会。

**这是 alcances 帖子**

```
alcances    [{"marca":"4","marcatxt":"\n\t\tCitrix\t\t\t","producto":"2","productotxt":"Networking","subproducto":"2","subproductotxt":"Netscaler"},{"marca":"8","marcatxt":"\n\t\tCoca Cola Company\t\t\t","producto":"8","productotxt":"Del Valle","subproducto":"5","subproductotxt":"Valle Frut"}] 
```

当我将这些数据保存在表中时，插入如下：

```
nttCitrixttt             |     Networking     |    Netscaler
nttCoca Cola Companyttt  |    Del Valle       |    Valle Frut 
```

我想删除 N 和 T 以正确保存。

不幸的是，我无法访问服务器来修改 php.ini 并禁用魔术引号。

我希望能帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:07:21.817

使用[str_replace](http://php.net/manual/en/function.str-replace.php)

```
$str = str_replace(array('\t','\n'),'',$str); 
```

或[preg_replace](http://php.net/manual/en/function.preg-replace.php)

```
$str = preg_replace('/(\\\\n|\\\\t)/', '', $str); 
```

# javascript - Sencha Touch 2：如何从面板获取 HTML 以及输入值

> ID：14735373
> 
> 赞同：0
> 
> 时间：2013-02-06T17:39:42.047
> 
> 标签：javascript, jquery, extjs, sencha-touch, sencha-touch-2

我想知道如何获取面板的 HTML 以及面板的输入值？我可以得到这样的 HTML：

```
myPanel.getInnerHtmlElement().dom.innerHTML 
```

但这只会给我返回 HTML。例如，如果我在面板中有一些如下所示的 HTML：

```
<input type="text" name="firstname"> 
```

然后在文本框中输入一个名称，它应该会返回如下内容：

```
<input type="text" name="firstname" value="John"> 
```

相反，我回来了：

```
<input type="text" name="firstname"> 
```

有谁知道如何用输入值取回 HTML？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:26:33.827

好吧，如果该面板是 a`Ext.form.Panel`那么您可以使用它来获取所有用户输入的值：

```
myPanel.getValues(); 
```

如果它是一个常规的旧面板，恰好有表单字段（也许你应该重新考虑），那么你可以这样做：

```
var values = {};
Ext.each(myPanel.query('textfield'), function() {
  values[this.getName()] = this.getValue();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-09T15:10:26.833

`Ext.get(html_element_id).setHtml(your_custom_html);`这是用于设置，就像您可以`getHtml`用来获取值一样

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T19:32:11.460

每当值更改时，修改 DOM 上的 value 属性：

```
$("input[type='text']").change(function () {
  $(this).attr('value', $(this).val());
}); 
```

然后在需要时通过以下方式获取 HTML：

```
myPanel.getInnerHtmlElement().dom.innerHTML 
```

# select - 专注于同一类的输入，但一次只影响一个

> ID：14735374
> 
> 赞同：1
> 
> 时间：2013-02-06T17:39:47.633
> 
> 标签：select, input, mootools

当我在具有相同类的输入上单击（焦点）/单击输出（模糊）时，我想执行一个操作，但我单击的输入应该不会受到影响，而不是像我在此处的示例[http://jsfiddle.net中的所有输入/HTZr2/](http://jsfiddle.net/HTZr2/) **点击一个输入，现在所有的描述都显示出来了。我想只显示我单击的输入的描述。

```
<div class="form-wrapper">
    <div class="form-element ">
        <input type="email" name="email" id="email" value="" autofocus="autofocus" tabindex="1">
        <p class="description">First's input description!</p>
    </div>
</div> 
<div class="form-wrapper">
    <div class="form-element ">
        <input type="email" name="email" id="email" value="" autofocus="autofocus" tabindex="1">
        <p class="description">Second's input description!</p>
    </div>
</div>  
<div class="form-wrapper">
    <div class="form-element ">
        <input type="email" name="email" id="email" value="" autofocus="autofocus" tabindex="1">
        <p class="description">Third's input description!</p>
    </div>
</div>
<div class="form-wrapper">
    <div class="form-element ">
        <input type="email" name="email" id="email" value="" autofocus="autofocus" tabindex="1">
        <p class="description">Forth's input description!</p>
    </div>
</div> 
```

和我的 JS：

```
window.addEvent('domready', function() {
  $$('.form-element > input').addEvents({
  focus: function(){ 
      $$('.form-element').addClass('form_element_active')
      },
  blur: function(){
      $$('.form-element').removeClass('form_element_active');
      }    
  }); 
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T23:13:38.440

所以只要得到父 el：

```
$$('.form-element > input').addEvents({
    focus: function () {
        this.getParent('.form-element').addClass('form_element_active')
    },
    blur: function () {
        this.getParent('.form-element').removeClass('form_element_active');
    }
}); 
```

# android - 如何创建受版权保护的 apk 文件？

> ID：14735378
> 
> 赞同：-2
> 
> 时间：2013-02-06T17:39:53.503
> 
> 标签：android, security, apk

当我将 APK 文件发送到某人的电子邮件时，他可以将文件复制一百万次并出售一百万次，但我不希望那样。

如何将保护集成到 Java 文件、manifest.xml 或其他地方，以使程序的副本不起作用？或者我可以为 APK 文件设置一个一次性密码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:46:13.497

你不能。没有办法做到这一点。当您通过电子邮件将 apk 发送给某人时，不需要的分发是您必须承担的风险。

您可以做的最好的事情是每次通过电子邮件将其发送给某人时编译一个单独的 apk，并在其中放入一个唯一的代码。当应用程序首次启动时，让它在在线服务器上注册。如果有人再次尝试注册相同的代码，那么您就知道该 apk 已发送给其他人或安装在多个设备上。在这种情况下，您的服务器可以告诉您的应用程序该特定代码已被使用并拒绝工作。

这种方法的缺点：

1.  您需要为每封单独的电子邮件专门编译一个新的 apk
2.  任何人都可以反编译应用程序并将代码更改为其他代码，然后重新编译并使用它。或者，如果他们愿意，他们可以删除整个检查机制。

简而言之，没有万无一失的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:49:07.647

如果您希望您的用户能够安装应用程序，您没有任何方法可以做到这一点

一种可能的解决方法是测试 DeviceID，并仅在 DeviceID 已获得授权时才允许应用程序继续运行。

显然，您必须在代码中进行管理，如果您需要授权大量设备，这可能会变得非常麻烦。另外我不确定每个设备**都有**一个 DeviceID

请参阅[是否有唯一的 Android 设备 ID？](https://stackoverflow.com/questions/2785485/is-there-a-unique-android-device-id)有关此的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:49:50.050

使用以下选项之一创建一个只需几行额外代码的自定义 APK

如何保持应用程序启动的时间计数，如果超过显示消息并关闭它？

或者，您可以检查代码中的试用天数，在 MainActivity/Base Activity 中检查从现在开始的 5 天，如果超过退出应用程序。

您始终可以将此详细信息保存在应用程序的共享首选项中并与之交叉检查。

# java - 使用 Java 解析 CSS 类文件

> ID：14735380
> 
> 赞同：0
> 
> 时间：2013-02-06T17:40:01.053
> 
> 标签：java, regex

我正在研究涉及类似于 CSS 的文件结构但它与
CSS 有点不同的东西。这是文件的结构

```
 <ELEMENT NAME>{
 Element attributes..1
 Element attributes..2
 Element attributes..3
 } 
```

我写了一个方法来获取元素名称

```
 public String getElementName(File jSfile){
    String elementName=null;
    StringBuffer sb = null;
    try{
    BufferedReader br=new BufferedReader(new FileReader(jSfile));
    String line=null;
    while((line=br.readLine())!=null){
    Pattern element=Pattern.compile("\\<(.+?)\\>",Pattern.DOTALL);
    Matcher match=element.matcher(line);
    match.find();
    return match.group(1);
    }
    }
    catch(Exception e){
    return e.getLocalizedMessage();
    }
    return elementName;

} 
```

并像这样使用它..

```
 public static void main(String arg[]){
 CSSReader cs=new CSSReader();
 File f=new File("C:/Users/foo/bar/cascade.xyz");
 String z=cs.getElementName(f);
 System.out.print(z);
 } 
```

但它总是说`'No match found'`

> 编辑我发现该文件包含超过 1 个具有不同名称的序列。当我删除所有其他的并只保留一个时，代码就可以工作了。

很抱歉在这里是菜鸟.....有人知道我将如何使用多线......非常感谢我哪里错了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:46:20.337

你有 2 个地方可以写`br.readLine()`。第一个在while 条件内，第二个在body 内。所以第一个读取的行永远不会被使用。我怀疑这是包含您要查找的令牌的行。

尝试改变这个：

```
while(br.readLine()!=null){
    String line=br.readLine(); 
```

变成这样：

```
String line = null;
while((line = br.readLine())!=null){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:52:53.550

您可以在 while 循环之前声明您的 String 行，并将您对 while 循环的检查更改为分配，然后检查 null：

```
String line;
while ((line = br.readLine()) != null){
    // Do stuff with line
} 
```

编辑：更新答案以反映更新的问题

要考虑多个元素，您可以更改方法以使用每个匹配的字符串填充列表，而不是返回第一个匹配项。while 循环完成后，返回该列表。

# javascript - 如何区分浏览器的url和iframe？

> ID：14735382
> 
> 赞同：0
> 
> 时间：2013-02-06T17:40:07.093
> 
> 标签：javascript, html, url, iframe

对于特定页面，我想要做的是将整个页面重定向到另一个页面，如果它在浏览器中正常显示，并在另一个页面内的 iframe 中显示时保持不变。基本上我现在正在做的是使用一个简单的 if 子句，如下所示：

```
if (window.location.href=="http://www.XXX.com") {
            window.location = "http://www.YYY.com";
        } 
```

但事实证明，iframe 也会被重定向。无论如何要区分这两种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:43:27.867

你有一个错字

*   `=`已设置
*   `==`是比较

和你的代码

```
if (window.location.href="http://www.XXX.com") {
                        ^ 
```

如果您在 iframe 中并且您在两个不同的域中，则他们无法看到彼此的位置。

如果它们在同一个域中，您可以使用[`window.top`](https://developer.mozilla.org/en-US/docs/DOM/window.top).

# wso2 - WSO2 外部 ldap 不工作

> ID：14735385
> 
> 赞同：1
> 
> 时间：2013-02-06T17:40:17.010
> 
> 标签：wso2, wso2carbon, wso2is

我编辑了 user-mgt.xml 以尝试连接到新安装的 Apache DS LDAP。

我在 apache ds ldap 中创建了一个 ldap 用户人员对象：cn=a​​dmin,ou=users,o=southpark

我试过只读部分：

```
 <UserStoreManager class="org.wso2.carbon.user.core.ldap.ReadOnlyLDAPUserStoreManager">
        <Property name="ReadOnly">true</Property>
        <-Property name="MaxUserNameListLength">100</Property>
        <Property name="ConnectionURL">ldap://localhost:10389</Property>
        <Property name="ConnectionName">cn=admin,ou=users,o=acme</Property>
        <Property name="ConnectionPassword">admin</Property>
        <Property name="UserSearchBase">ou=users,o=acme</Property>
        <Property name="UserNameListFilter">(objectClass=person)</Property>
        <Property name="UserNameAttribute">cn</Property>
        <Property name="ReadLDAPGroups">false</Property>
        <Property name="GroupSearchBase">ou=groups,o=acme</Property>
        <Property name="GroupNameListFilter">(objectClass=groupOfNames)</Property>
        <Property name="GroupNameAttribute">cn</Property>
        <Property name="MembershipAttribute">member</Property>
        <Property name="UserRolesCacheEnabled">true</Property>
        <Property name="ReplaceEscapeCharactersAtUserLogin">true</Property>
        <Property name="maxFailedLoginAttempt">0</Property>
    </UserStoreManager> 
```

...并获得以下堆栈跟踪：

```
[2013-02-06 04:33:23,905]  INFO {org.wso2.carbon.databridge.agent.thrift.internal.AgentDS}
-  Successfully deployed Agent Client
[2013-02-06 04:33:24,896]  WARN {net.sf.ehcache.config.ConfigurationFactory} 
-  No configuration found. Configuring ehcache from ehcache-failsafe.xml  found in the
   classpath: bundleresource://36.fwk1434669784/ehcache-failsafe.xml
[Fatal Error] :106:7: The content of elements must consist of well-formed character data or markup.
[2013-02-06 04:33:24,965] ERROR {org.wso2.carbon.user.core.internal.Activator} -  Cannot start User Manager Core bundle
org.wso2.carbon.user.core.UserStoreException: Error in building Document
        at org.wso2.carbon.user.core.common.DefaultRealmService.getConfigurationElement(DefaultRealmService.java:249)
        ....... 20 more
Caused by: org.xml.sax.SAXParseException; lineNumber: 106; columnNumber: 7; The content of elements must consist of well-formed character data or markup.
        at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
        at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
        at org.wso2.carbon.utils.CarbonUtils.replaceSystemVariablesInXml(CarbonUtils.java:1035)
        ... 21 more 
```

我还尝试了读写外部 ldap 连接：

```
<UserStoreManager class="org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager">
        <Property name="ConnectionURL">ldap://localhost:10389</Property>
        <Property name="ConnectionName">cn=admin,ou=users,o=acme</Property>
        <Property name="ConnectionPassword">admin</Property>
        <Property name="passwordHashMethod">SHA</Property>
        <Property name="UserNameListFilter">(objectClass=person)</Property>
        <Property name="UserEntryObjectClass">inetOrgPerson</Property>
        <Property name="UserSearchBase">ou=users,o=acme</Property>
        <Property name="UserNameSearchFilter">(&amp;(objectClass=person)(uid=?))</Property>
        <Property name="UserNameAttribute">cn</Property>
        <Property name="UsernameJavaRegEx">[a-zA-Z0-9._-|//]{3,30}$</Property>
        <Property name="UsernameJavaScriptRegEx">^[\\S]{3,30}$</Property>
        <Property name="RolenameJavaScriptRegEx">^[\\S]{3,30}$</Property>
        <Property name="RolenameJavaRegEx">[a-zA-Z0-9._-|//]{3,30}$</Property>
        <Property name="PasswordJavaScriptRegEx">^[\\S]{5,30}$</Property>
        <Property name="ReadLDAPGroups">true</Property>
        <Property name="WriteLDAPGroups">true</Property>
        <Property name="EmptyRolesAllowed">false</Property>
        <Property name="GroupSearchBase">ou=groups,o=acme</Property>
        <Property name="GroupNameListFilter">(objectClass=groupOfNames)</Property>
        <Property name="GroupEntryObjectClass">groupOfNames</Property>
        <Property name="GroupNameSearchFilter">(&amp;(objectClass=groupOfNames)(cn=?))</Property>
        <Property name="GroupNameAttribute">cn</Property>
        <Property name="MembershipAttribute">member</Property>
        <Property name="UserRolesCacheEnabled">true</Property>
        <Property name="ReplaceEscapeCharactersAtUserLogin">true</Property>
        <Property name="maxFailedLoginAttempt">0</Property>
    </UserStoreManager> 
```

...并且我在不存在的用户周围遇到以下异常：

```
[2013-02-06 05:36:13,142]  INFO {org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager} -  LDAP connection created successfully in read-write mode
[2013-02-06 05:36:13,175] ERROR {org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager} -  There is no user with the user name: wso2.anonymous.user to be added to this role.
[2013-02-06 05:36:13,176] ERROR {org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager} -  Role: wso2.anonymous.rolecould not be added.
org.wso2.carbon.user.core.UserStoreException: There is no user with the user name: wso2.anonymous.user to be added to this role.
        at org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager.doAddRole(ReadWriteLDAPUserStoreManager.java:1014)
        at org.wso2.carbon.user.core.common.AbstractUserStoreManager.addRole(AbstractUserStoreManager.java:1246)
        at org.wso2.carbon.user.core.ldap.ReadWriteLDAPUserStoreManager.addInitialData(ReadWriteLDAPUserStoreManager.java:1834) 
```

开始担心质量，如果开箱即用的安装不容易相互连接......

感谢您的任何帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T02:50:00.723

它只是一个格式错误的 XML 文件。你错了以下行：

```
<-Property name="MaxUserNameListLength">100</Property> 
```

删除破折号

```
<Property name="MaxUserNameListLength">100</Property> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T19:46:04.233

如果您查看第一个异常 - 这是一个 xml 解析问题。

引起：org.xml.sax.SAXParseException；行号：106；列号：7；元素的内容必须由格式良好的字符数据或标记组成。

请查看错误中给出的行号。

# c++ - 列出使用的库的链接器选项

> ID：14735387
> 
> 赞同：14
> 
> 时间：2013-02-06T17:40:18.310
> 
> 标签：c++, build, linker

我在 Linux 平台上工作并使用 GNU C++ 编译器。我正在尝试解决显示某些符号未定义的链接错误。我可以使用命令行中提供的名称查找库，并查看它们是否包含有问题的符号（使用“nm”实用程序）。

我知道对于编译步骤，我可以使用命令行标志“-H”而不是“-c”来获取编译中#included 的头文件列表。链接器是否有类似的选项？我想如果我能看到链接器用来处理每个“-lmylibrary”标志的文件列表，我可以进一步排除故障。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-06T17:49:15.723

如果您收到未定义的符号错误，则意味着您忘记链接某个库，知道您链接到的库可能没有您想象的那么有用，因为显然这些库中缺少符号，但是您可以使用该`-print-file-name=library`选项找出 gcc 将使用哪个路径来链接库，例如：

```
$ gcc -print-file-name=libc.a
/usr/lib/x86_64-linux-gnu/gcc/x86_64-linux-gnu/4.5.2/../../../libc.a 
```

也传递`--trace`给链接器显示类似的输出

```
gcc -Wl,--trace myprog.c -o myprog -L. -lmylib
-lmylib (./libmylib.a)
-lgcc_s (/usr/lib/x86_64-linux-gnu/gcc/x86_64-linux-gnu/4.5.2/libgcc_s.so)
.... 
```

（请注意，上面`--trace`是*链接器的一个参数，*因此它进入`-Wl`.`gcc`为链接而调用的内容不会发出任何有用的信息`--trace`作为`gcc`其自身的参数）。

您也可以在成功构建程序`ldd` *后*使用来找出使用了哪些动态链接库，其输出如下所示：

```
ldd `which ls`
linux-vdso.so.1 =>  (0x00007fff7ffff000)
libselinux.so.1 => /lib/x86_64-linux-gnu/libselinux.so.1 (0x00007f2e8ea93000)
librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f2e8e88b000)
libacl.so.1 => /lib/x86_64-linux-gnu/libacl.so.1 (0x00007f2e8e682000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f2e8e2ee000)
.... 
```

# php - 带有 SQL 查询的索引页中的字符集

> ID：14735393
> 
> 赞同：0
> 
> 时间：2013-02-06T17:40:31.160
> 
> 标签：php, mysql, utf-8, character

在我的 index.php 中，我有一些用特殊字符编写的固定文本（例如 è à ä ö）。我还有一个查询，其中包含来自数据库的发布文本。此文本也有特殊字符。数据库使用 utf8_unicode_ci 设置。我也试过 utf8_general_ci 和 utf8_bin

如果我放置

```
<meta http-equiv="Content-Type" content="text/html; charset=utf8" /> 
```

在标题上，纯文本显示完美（所以我读了è à ä ö）。另一方面，来自数据库的文本未正确显示（我读过？？？）。

那么如果我放置

```
<meta http-equiv="Content-Type" content="text/html; charset=utf8_unicode_ci" /> 
```

或者

我已经完美地发布了数据库文本，但是 HTML 文档中的纯文本被发布了 qui thos À À À 而不是 specialchars àéè。

我究竟做错了什么？

编辑：

我试过：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf8" /> 
```

然后当我连接到数据库时：

```
$connection->set_charset('utf8'); 
```

结果显示正确。这是一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-06T17:42:07.880

您可以在应该完成工作的数据库文本上使用 utf8_encode() / utf8_decode() ..

# vb.net - 如何将文件的字节转换为字符并在文本框中显示它们？

> ID：14735396
> 
> 赞同：0
> 
> 时间：2013-02-06T17:40:31.747
> 
> 标签：vb.net, byte

我想将红色块中的文本（见下图）导入 vb.net windows 窗体应用程序中的richtextbox（图像取自十六进制编辑器）有没有简单的方法可以做到这一点？

![](../Images/a5d2384ca6c8a58d386d7c80747c9b96.png)

我试图使用谷歌找到我的问题的答案，但我在那里找到的示例要么不起作用，要么解释了如何在 Visual Basic 中制作完整的十六进制编辑器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:47:37.880

如果要使用 ASCII 编码，只需执行以下操作：

```
RichTextBox1.Text = File.ReadAllText(filePath, Encoding.ASCII) 
```

如果您想要另一种编码，只需指定一个不同的编码。例如，对于 UTF8，使用`Encoding.UTF8`.

**边注：**

从技术上讲是正确的，左边的十六进制数字是实际的字节值。右边的文本（在红色框中）不是字节——它是这些字节的 ASCII 表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:43:04.793

如果您知道字符是 ASCII，那么以下应该可以工作。

```
Public Function AsciiByteToChar(ByVal b As Byte) As Char
    Dim barr() As Byte = New Byte() {b}
    Dim carr() As Char = Encoding.ASCII.GetChars(barr)
    Return carr(0)
End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T17:53:08.220

1.  打开一个[`FileStream`](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)文件
2.  `Seek`到你想要的第一个字节
3.  `Read`你想要的长度
4.  使用`Encoding.UTF8`（或您喜欢的其他编码）将字节转换为字符
5.  将 的`Text`属性设置`TextBox`为您的值

    ```
    Public Sub Sample()
        Dim f As New FileStream("filepath")
        f.Seek(byteOffset, SeekOrigin.Begin)

        Dim buffer(byteLength) As Byte
        f.Read(buffer, 0, byteLength)

        Dim chars As String = Encoding.UTF8.GetString(buffer)
        txtBox.Text = chars
     End Sub 
    ```

# jquery - 模拟单击元素的父元素的父元素的兄弟元素

> ID：14735406
> 
> 赞同：0
> 
> 时间：2013-02-06T17:41:29.927
> 
> 标签：jquery, selector, parent, next

我想模拟一个元素的单击，该元素是单击元素的父级的父级的同级元素。即 li 旁边的 li 中的 a.active 在其中。这不起作用：

查询

```
$('li.product').click(function() {
    $('a.active').parent().parent().next().find(a).click();

        }); 
```

HTML

```
<ul>
 <li class="product"><li>
 <li class="product"></li>
 <li class="product"></li>
</ul>

<ul>
    <li id="">
    <div class="page">
    <a class="active" href="javascript:function Z(){Z=""}Z()">1</a>
    </div>
    </li>
    <li id="">
    <div class="page">
    <a class="" href="javascript:function Z(){Z=""}Z()">2</a>
    </div>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:56:06.913

您缺少以下`''`引号`.find()`：

应该是这样的：http: [//jsfiddle.net/SbDKD/](http://jsfiddle.net/SbDKD/)

```
$('a.active').parent().parent().next().find('a').click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:56:45.920

以下对我有用

```
$('li.product a.active').click(function() {
    $(this).parent().parent().next().find('a').click();
    return false;
}); 
```

假设我们有一个像这样的 HTML：

```
<li class="product">
  <div class="page">
     <a class="active" href="javascript:alert('click 1')">1</a>
   </div>
</li>
<li class="product" onclick="alert('tickle')">
    <div class="page">
        <a onclick="alert('tickle me')" href="javascript:alert('click 2');">2</a>
    </div>
</li> 
```

（当然，HTML 中的内联 onclick 处理程序仅用于轻松测试）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:34:38.440

我会将点击监听器放在 a 标签上并使用 .parents() 函数来查找父 li，以便无论您有多深都能找到它。然后在下一个元素中找到 a 。

```
$('a').click(function() {
  $(this).parents('li').next().find('a').trigger('click');

}); 
```

唯一的问题是它们都会触发它们的后续元素。但如果你只有两个，它应该可以工作。

# r - “采样”中的 strata() 返回错误：参数暗示不同的行数

> ID：14735411
> 
> 赞同：2
> 
> 时间：2013-02-06T17:41:48.400
> 
> 标签：r

我有一个看起来像这样的数据框：

```
'data.frame':   1090 obs. of  8 variables:
 $ id            : chr  "INC000000209241" "INC000000218488" "INC000000218982" "INC000000225646" ...
 $ service.type  : chr  "Incident" "Incident" "Incident" "Incident" ...
 $ priority      : chr  "Critical" "Critical" "Critical" "Critical" ... 
```

我将数据排序如下：

```
data <- data[order(data$priority),] 
```

我一直在将优先级更改为因素等，但无论我尝试什么，当我尝试运行以下命令时：

```
s = strata(data,c("priority"),size=c(0,0,1,5)) 
```

我总是收到以下错误：

```
Error in data.frame(..., check.names = FALSE) : 
  arguments imply differing number of rows: 0, 1 
```

我尝试调试该函数，看看我是否能说出为什么会引发此错误（但我无法理解代码）。在执行 strata() 函数的这个阶段引发了错误：

```
debug: r = cbind(r, i) 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:56:43.327

问题在于您试图将某些组的样本量设置为零。相反，在采样之前对原始数据进行子集化。

在这里，我们重现您的问题。

```
library(sampling)
data(swissmunicipalities)
length(table(swissmunicipalities$REG)) # We have seven strata
# [1] 7

# Let's take two from each group
strata(swissmunicipalities, 
       stratanames = c("REG"), 
       size = rep(2, 7), 
       method="srswor")
#      REG ID_unit        Prob Stratum
# 93     4      93 0.011695906       1
# 145    4     145 0.011695906       1
# 2574   1    2574 0.003395586       2
# 2631   1    2631 0.003395586       2
# 826    3     826 0.006230530       3
# 1614   3    1614 0.006230530       3
# 583    2     583 0.002190581       4
# 1017   2    1017 0.002190581       4
# 1297   5    1297 0.004246285       5
# 2535   5    2535 0.004246285       5
# 342    6     342 0.010752688       6
# 347    6     347 0.010752688       6
# 651    7     651 0.008163265       7
# 2471   7    2471 0.008163265       7

# Let's try to drop the first two groups. Oops...
strata(swissmunicipalities, 
       stratanames = c("REG"), 
       size = c(0, 0, 2, 2, 2, 2, 2), 
       method="srswor")
# Error in data.frame(..., check.names = FALSE) : 
#   arguments imply differing number of rows: 0, 1 
```

让我们进行子集化并再试一次。

```
swiss2 <- swissmunicipalities[!swissmunicipalities$REG %in% c(1, 2), ]
table(swiss2$REG)
strata(swiss2, 
       stratanames = c("REG"), 
       size = c(2, 2, 2, 2, 2), 
       method="srswor")
#      REG ID_unit        Prob Stratum
# 58     4      58 0.011695906       1
# 115    4     115 0.011695906       1
# 432    3     432 0.006230530       2
# 986    3     986 0.006230530       2
# 1007   5    1007 0.004246285       3
# 1150   5    1150 0.004246285       3
# 190    6     190 0.010752688       4
# 497    6     497 0.010752688       4
# 1049   7    1049 0.008163265       5
# 1327   7    1327 0.008163265       5 
```

# javascript - spin.js 启动但不会停止

> ID：14735421
> 
> 赞同：2
> 
> 时间：2013-02-06T17:42:09.630
> 
> 标签：javascript

我怎样才能停止旋转？奇怪的事情发生了。这是不起作用的代码：

```
 <body>
<div id="spin">
</div>
<button type="submit" onclick="spin_stop();" id="stop">Stop</button>
<button type="submit" onclick="spin_start();" id="start">Start</button></p>
<script type="text/javascript">
    var target = document.getElementById('spin');
    function spin_stop()      {
        spinner.stop();  
    }
    function spin_start()     {
        var spinner = new Spinner(opts).spin(target);
        spinner.spin(target);  
    }
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:44:20.413

由于您在 spin_start() 的函数范围内定义微调器，因此 spin_stop 中的微调器对象未定义。如果在声明目标的地方声明微调器，则两个函数都可以访问该变量。

# python - ImportError：无法导入名称 CKParser

> ID：14735427
> 
> 赞同：2
> 
> 时间：2013-02-06T17:42:30.783
> 
> 标签：python, python-2.7, flask

`CKParser`我在 Flask 应用程序中编写了一个名为 的类，
但未能成功加载它
**：**

```
/myapp
  __init__.py (blank file)
  server.py
  parser.py 
```

在我的 server.py 中，我写道：

```
from parser import CKParser 
```

后来`server.py`我有：

```
ckparser = CKParser(somdata)
return ckparser.get_ckdata() 
```

在我的`parser.py`我有：

```
class CKParser(object):
    def __init__(self,ckdata):
        self.ckdata = ckdata
    ... 
```

我那里也有一些其他的课程。
当我尝试运行应用程序时，我得到：
`ImportError: cannot import name CKParser`
我可能不完全理解`import`，`from ... import`
我尝试导入`from`myapp.parser。
我尝试导入只是`parser`
我尝试导入只是`CKParser`

我没有选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:48:30.427

Python 有自己的[解析器](http://docs.python.org/2/library/parser.html)模块。我猜这里可能存在名称冲突。您可以将您的 parser.py 重命名为 myparser.py 等，然后将导入调用为：

## `myparser.py`

```
class CKParser(object)
....whatever 
```

## `server.py`

```
from myparser import CKParser 
```

# javascript - 在其余代码之前调用回调函数（Javascript D3）

> ID：14735429
> 
> 赞同：0
> 
> 时间：2013-02-06T17:42:33.077
> 
> 标签：javascript, url, callback, d3.js

基本上我想要做的是从 URL 获取字符串结果。当我在 URL 上使用浏览器时得到的结果可以像字符串“word dog cat dog”一样简单。

我正在尝试使用以下内容：

```
var textwords;
d3.text(myUrl, function(data) {
 textwords = data;
}); 
```

后来在`textwords`以下几行中以某种方式使用，但我当然不能，因为回调函数在所有其他代码之后执行。

`textwords`有什么办法（除了将以下所有代码放在回调函数中）在它获取数据后我可以设法使用吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:09:39.387

不幸的是，简短的回答是否定的。长答案也是否定的，但你可以通过使用[jQuery 的 Deferred](http://api.jquery.com/jQuery.Deferred/)让事情看起来更好一些。[这里](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)有很好的介绍

# javascript - 异步主题范围誓言.JS

> ID：14735433
> 
> 赞同：1
> 
> 时间：2013-02-06T17:42:39.677
> 
> 标签：javascript, node.js, vows

我无法将父`topic`值传递给子`topic`值。代码是异步的，我认为这就是我遇到问题的地方。我希望 JSON 响应的一部分成为下面测试的主题。这是测试的相关部分。

```
{
  "A test":{
    topic: function() {
      request(conf.server + '/categories/' + id, this.callback)
    },
    'should respond with a 200': function(err, res, body) {
      res.statusCode.should.equal(200);
      console.log(JSON.parse(body).title);
    },
    'should have valid JSON in the body': function(err, res, body) {
      (function() {
        JSON.parse(body);
      }).should.not.
      throw();
    },
    'category collection': {
      topic: function(err, res, body) {
        console.log(res.statusCode);
        return JSON.parse(body).categories
      },
      'should have a length greater than 0': function(topic) {
        topic.length.should.be.above(0);
      }
    }
  }
} 
```

`console.log(res.statusCode)`产生 undefined 并尝试登录`topic`“应该有一个大于 0 的长度”产生`[SyntaxError: Unexpected token u]`。

我可以这样做吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-17T10:41:44.443

我对此做了一个快速测试，似乎当第一个参数即 err 为空时，它没有传递给子上下文。所有其他参数都被传递。这是我的代码：

```
module.exports = ( function() {
var vows = require('vows'), assert = require('assert'), suite;
suite = vows.describe('Vows test');
suite.addBatch({
    'Parent context ' : {
        topic : function() {
            this.callback(null, "first", "second");
        },
        'err should be null' : function(err, first, second) {
            assert.isNull(err);
            assert.isNotNull(first);
            assert.isNotNull(second);
        },
        'subcontext: ' : {
            topic : function(err, first, second) {
                console.log('Err: ' + err + ', first: ' + first + ', second: ' + second);
                this.callback(null, "firstChild");
            },
            'Error should be null' : function(err, firstChild) {
                assert.isNull(err);
                assert.isNotNull(firstChild);
            }
        }
    }
});

suite.run();
}()); 
```

结果是`Err: first, first: second, second: undefined ✓ OK » 2 honored`。

但是当我传递错误的东西时，甚至不会打印日志和子上下文错误。

我不知道确切的原因。我会检查誓言代码，如果我发现任何东西就会回来。希望这对您有所帮助。

# c# - 我的 ASP.NET C# 脚本的格式可以吗？

> ID：14735437
> 
> 赞同：0
> 
> 时间：2013-02-06T17:42:51.047
> 
> 标签：c#, asp.net, format

C# 的新手我正在一个名为“PageFlex”的程序的结构中工作，该程序的所有结构都放在下面的代码中。我在此处发布此内容的主要原因是确保我正确格式化了我的脚本。如果这看起来格式正确，请告诉我。还有像 jsfiddle.net 这样的网站可以用于 C# 吗？

```
<script language="C#" runat="server">

string GetUserID(Pageflex.Ur.Storefront.Data.StorefrontAPI isini)
{
    return isini.GetValue("SystemProperty", "LoggedOnUserID", null);
}

int GetShoppingCartCount()
{

    Pageflex.Ur.Storefront.Data.StorefrontAPI isini =
       new Pageflex.Ur.Storefront.Data.StorefrontAPI();
    string userID = GetUserID(isini);
    string[] docsInCart = isini.GetListValue("UserListProperty", "DocumentsInShoppingCart", userID);
    return (docsInCart != null) ? docsInCart.Length : 0;
}
int GetShoppingCartTotal()
{
    Pageflex.Ur.Storefront.Data.StorefrontAPI isini =
    new Pageflex.Ur.Storefront.Data.StorefrontAPI();
    string userID = GetUserID(isini);
    string[] docsTotalPrice = isini.GetListValue("DocumentProperty", "DocumentPrice", userID);
     return (docsTotalPrice != null) ? docsTotalPrice.Length : 0;
}
void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        int documentPrice = GetShoppingCartTotal();
        priceCart.Text = shoppingPrice.ToString();

        int shoppingCount = GetShoppingCartCount();
        numCart.Text = shoppingCount.ToString();
        ItemOrItems.Text = (shoppingCount == 1) ? "item" : "items";
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:47:52.857

事情在我看来是正确的。您可能需要将您的方法声明为公开的：

```
 public int GetShoppingCartTotal()
 {
 // logic
 } 
```

但是，当您的代码处于页面级别时，您可能不必这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T11:27:28.387

关于

> 还有像 jsfiddle.net 这样的网站可以用于 C# 吗？

你总是可以尝试[Ideone](http://ideone.com/)（虽然它不完全像 jsfiddle），它支持很多不同的语言，包括 C#（Mono）。

# jquery - 如何在非 IE 浏览器（如 Firefox）的 html 标记上正确应用 IE 条件？

> ID：14735439
> 
> 赞同：0
> 
> 时间：2013-02-06T17:42:54.477
> 
> 标签：jquery, html, css, internet-explorer

我正在尝试将此处推荐的技术应用于 jQuery 中的 IE 检测：

[https://stackoverflow.com/a/3165521/1093087](https://stackoverflow.com/a/3165521/1093087)

我不清楚的是如何`html`为非 IE 浏览器设置标签。

这是我目前在我的模板中的内容：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head> 
```

这是我应该替换它的：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!--[if lt IE 8><html class="lt-ie8"><![endif]-->
<!--[if IE 8]><html class="ie8"><![endif]-->
<!--[if gt IE 8]><!--><html><!--<![endif]-->
  <head> 
```

`html`如果我这样做，IE 会被两个标签混淆吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:49:16.447

试试这个：

```
<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6" lang="en-US" 
                        xmlns="http://www.w3.org/1999/xhtml"
                        > <![endif]-->
<!--[if IE 7 ]>    <html class="ie7" lang="en-US" 
                        xmlns="http://www.w3.org/1999/xhtml"
                        > <![endif]-->
<!--[if IE 8 ]>    <html class="ie8" lang="en-US" 
                        xmlns="http://www.w3.org/1999/xhtml"
                        > <![endif]-->
<!--[if IE 9 ]>    <html class="ie9" lang="en-US" 
                        xmlns="http://www.w3.org/1999/xhtml"
                        > <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html xmlns="http://www.w3.org/1999/xhtml">
<!--<![endif]--> 
```

您将拥有每个实例的 CSS 来自定义内容。

# java - 尝试绘制图像时未知来源

> ID：14735440
> 
> 赞同：0
> 
> 时间：2013-02-06T17:42:58.210
> 
> 标签：java, image, swing, packaging

我试着画一些东西到`JGlassPane`. 对于像矩形这样的基本形状，它可以完美地工作。但是当我尝试绘制图像时，它总是向我显示未知来源的错误。我不知道这意味着什么，但我尝试了一切来修复它：尝试了相对/绝对路径，将图像添加为源，将其添加到构建路径，但没有任何效果。

```
package soft;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
public class MapObjects 
{
    private int TypObjektu;//1-osoba,2-vozidlo,3-budova,4-custom
    private float []GPSpos;
    private String nazov;
    private String popis;
    private int userId;
    private int priority;
    private BufferedImage ikona;

    public MapObjects(String nazov,String popis,int typ)
    {
        nazov=this.nazov;
        popis=this.popis;
        TypObjektu=typ;
        File file=new File("D:/workspace/sources/iconPerson.jpg");
        try {
            ikona = ImageIO.read(file);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    public Image getImage()
    {
        return ikona;
    }
    public void setAsPerson()
    {
        TypObjektu=1;
    }
    public void setAsCar()
    {
        TypObjektu=2;
    }
    public void setAsBuilding()
    {
        TypObjektu=3;
    }
    public void setAsCustom()
    {
        TypObjektu=4;
    }

} 
```

错误信息：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at soft.MapDrawer.paintComponent(MapDrawer.java:34)
    at soft.MapDrawer.<init>(MapDrawer.java:22)
    at gui.MainWindow.paint(MainWindow.java:189)
    at gui.MainWindow$2.actionPerformed(MainWindow.java:146)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$200(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

MapDrawer 类

```
package soft;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Line2D;

import javax.swing.JInternalFrame;
import javax.swing.JPanel;

public class MapDrawer extends JPanel
{
     Graphics testGrafika;
     DrawerThread drawingThread;
     MapObjects objekt;

    public MapDrawer(JPanel drawPanel)
    {
        drawPanel.add(this);
        testGrafika=drawPanel.getGraphics();    
        paintComponent(testGrafika);
        objekt=new MapObjects("tada","dada",1);
        drawingThread=new DrawerThread();
        drawingThread.start();

    }

    @Override
    public void paintComponent(Graphics g)
    {
        super.paintComponents(g);
        this.setBackground(Color.WHITE);
        g.drawImage(objekt.getImage(), 50, 50, null);
    }

    public Graphics getGraphics()
    {
        return testGrafika;

    }

    public class DrawerThread extends Thread implements Runnable
    {

        @Override
        public void run()
        {
            while(true)
            {
                paintComponent(testGrafika);
                try {
                    DrawerThread.sleep(30);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:08:52.807

Your painting code is completely wrong. You almost never call paintComponent directly, and certainly not in this situation. Your Graphics object is likely null because you're getting it by calling `getGraphics()` on a component, something you shouldn't be doing since this object won't persist. You will want to read the painting tutorials to see how to do this correctly as much needs to be changed. Recommendations include:

*   Drawing in the paintComponent method
*   But not calling it directly
*   Using a Swing Timer for your timer loop rather than a while code.
*   Using repaint() to suggest to the JVM to repaint the component.

Again, the tutorials, which you can find with Google, will explain all of this and more.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T18:09:18.420

*   不要使用[GlassPane 进行密集绘画](https://stackoverflow.com/questions/8715807/layering-multiple-glasspanes-in-a-root-container)

*   不要使用[JViewport 进行密集绘画](https://stackoverflow.com/questions/8614972/passing-current-date)

*   图标的透明度可能存在问题

*   Icon / ImageIcon 而不是，放到 Jlabel

*   使用[基于 JXLayer(Java6) 的 JLayer (Java7)](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html)

*   对于此处发布的代码，不可能暗示一些切割器，发布[SSCCE](http://sscce.org/)，简短，可运行，可编译，改用 Java 内置图标（来自`JOptionPane`fe）

# tsql - 计算两行之间的时间差

> ID：14735441
> 
> 赞同：1
> 
> 时间：2013-02-06T17:42:59.190
> 
> 标签：tsql, datediff

我有一个包含字段用户名和 lastUpdateDateTime 的表。如果用户在此表中输入了多个条目，我想看看第一个条目和最后一个条目之间的区别是什么，以分钟和秒为单位。我想我可能会使用函数 DATEDIFF 但我的数据库没有开始日期和结束日期作为两个单独的字段。我应该使用游标来循环按用户名排序的结果吗？

不知道该怎么做。

这是最新的...

```
SELECT username,  
DATEDIFF(ss, MinDate, MaxDate) Assessment_Timespan,
AssessmentDate
FROM
(
SELECT storeID, username,
MIN(lastUpdateDateTime) MinDate,
MAX(lastUpdateDateTime) MaxDate, 
CONVERT(VARCHAR(50), LastUpdateDateTime, 101) AS AssessmentDate
FROM Assessment
GROUP BY username, storeID, CONVERT(VARCHAR(50), LastUpdateDateTime, 101)
) src 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:50:19.157

你可以使用这样的东西。它得到了每个 的`min`和`max`值`username`。一旦你有了它，你就可以将[`DateDiff()`](http://msdn.microsoft.com/en-us/library/ms189794.aspx)函数应用到它：

```
select username,  
  datediff(ss, MinDate, MaxDate) DiffInSeconds
from
(
  select username,
    min(lastUpdateDateTime) MinDate,
    max(lastUpdateDateTime) MaxDate
  from yourtable
  group by username
) src 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/3d16c/4)

这会给您以秒为单位的差异，然后您可以以您需要的任何方式对其进行格式化。

# python - Python Web 应用程序国际化

> ID：14735443
> 
> 赞同：0
> 
> 时间：2013-02-06T17:43:13.853
> 
> 标签：python, internationalization, bottle

我正在编写一个小型 python web 应用程序（个人 KB 管理主要用于学习），具有良好的`bottle.py`微框架，但一个问题让我大吃一惊：

在 Web 应用程序中提供内部化的最佳方式是什么？我应该使用python`gettext`还是其他东西，我应该写一个完整的模板`{{translatethis}}`还是有更优雅的方法？

我应该直接从 python 处理翻译还是使用一些 JS 魔法来即时重新翻译模板？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:14:10.937

您可以将每个翻译保存在单独的文件中，如下所示：

英文.txt

```
greeting hi
name bob 
```

阿拉伯语.txt

```
greeting اهلاً
name بوب 
```

然后，通过迭代和拆分每一行，将所需的翻译加载到字典中。在这个例子中，加载 english.txt 应该返回类似`translation = {'greeting': 'hi', 'name': 'bob'}`. 然后通过调用使用这个字典渲染一个模板`template('{{greeting}} {{name}}!', translation)`。`dir="rtl"`如果您使用从右到左的语言，还记得在 HTML 中进行设置。

# delphi - 水晶报表 ActiveX 查看器

> ID：14735444
> 
> 赞同：0
> 
> 时间：2013-02-06T17:43:23.513
> 
> 标签：delphi, crystal-reports, activex, report

使用 Crystal Reports ActiveX 查看器（本例中使用 Delphi XE3）时，如何指定要查看的报表文件？CR 控件中没有可用于输入报表名称或位置的属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:23:21.927

ActiveXViewer*可以*与 Delphi XE3 一起使用。这是一个示例：

```
unit crystalreports;

interface

uses Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,       
Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.OleCtrls,      
ActiveX, ComObj, Data.DB, Data.Win.ADODB, CrystalActiveXReportViewerLib11_TLB;

type 
TReportForm = class(TForm)
 CrystalReportsViewer: TCrystalActiveXReportViewer; 
 PreviewButton: TButton; 
 procedure PreviewButtonClick(Sender: TObject); 
 private { Private declarations } 
 public { Public declarations } 
 end;

 var ReportForm : TReportForm;

 implementation

 {$R *.dfm}

 procedure TReportForm.PreviewButtonClick(Sender: TObject); 
    var CReport, CRApp : variant; 
    i :integer; 

begin 
CRApp := CreateOleObject('CrystalRuntime.Application'); 
CReport := CRApp.OpenReport('C:\Crystal Reports Test\companydatasheet.rpt',0 ); 
for i := 1 to CReport.Database.Tables.Count do 
begin 
    CReport.Database.Tables[1].ConnectionProperties.Item['User ID'] := 'sa';  
    CReport.Database.Tables[1].ConnectionProperties.Item['Password'] := 'secret'; 
end; 
CReport.RecordSelectionFormula := '{member.member_no} = "101"';        
CrystalReportsViewer.Align := alClient; 
CrystalReportsViewer.ReportSource := CReport; 
ReportForm.WindowState := wsMaximized; 
PreviewButton.Visible := False; 
CrystalReportsViewer.ViewReport; 
CrystalReportsViewer.Show; PreviewButton.Visible := True; 
end;

end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:49:15.617

Crystal Reports XI ActiveX 查看器不起作用。我猜你正试图用它来使 Crystal Reports 与 Delphi 一起工作。它没有。它甚至在其他任何地方都不起作用。最新安装的 Crystal Reports XI 甚至没有附带 ActiveX 版本，只有 .net 版本。

仍然有安装程序（或在您的本地网络上）包含此 ActiveX 控件，但 CR XI 论坛讨论（现在由 SAP 管理的水晶报告）指出 ActiveX 控件在近十年前已被弃用，最后没有功能5 年，并从 2 年前的最新安装程序中完全删除。

# networking - 软件定义网络和 OpenFlow

> ID：14735450
> 
> 赞同：6
> 
> 时间：2013-02-06T17:43:52.933
> 
> 标签：networking, openflow

我正在尝试深入研究这些新概念，SDN 和 OpenFlow。我不清楚的一件事是，传统路由（OSPF、BGP 等）在 SDN 中是如何完成的，或者它完全消失了，取而代之的是一些轻量级机制？

我将不胜感激任何提示，链接以更好地理解这一点。谢谢！

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:51:43.057

在 SDN 世界中，控制器在每个路由器和交换机中设置数据平面，以确保以某种理想的方式转发流。需要为控制器提供做出这些路由决策的逻辑。如果您想使用 OSPF 等传统机制，您可以在控制器上安装类似 RouteFlow 的东西（[https://sites.google.com/site/routeflow/](https://sites.google.com/site/routeflow/)）。或者，尽管您可能决定使用其他一些更相关或更理想的机制。SDN 开辟了一个充满可能性的新世界。

例如，假设您在两个位置之间有两条路线。一条路由运行起来非常昂贵，但延迟也很低，并且可以更快地获得流量。另一条路线更长，延迟更高，但运行起来非常便宜。您可能决定要通过一条路径而不是另一条路径来路由特定的流量。例如。你的老板的流量走的是快路线（所以他不会一直打你），但你的同事的流量走的是慢路线（毕竟他确实偷了你留在桌子上的饼干！）。或者，您的电子邮件流量采用较慢的路线，而您的交易/实时应用程序流量采用较快的路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T23:08:44.050

使用SDN，每个交换机/路由器基本上都变成了一个“哑”设备，只做它被告知要做的事情。集中式 SDN 服务器将拥有整个网络所需的所有信息，以便能够为所有涉及的交换机/路由器确定和配置所需的路由/交换表。

因此，我猜你的问题的答案是传统的动态路由不会在SDN中完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-06T12:08:10.497

在 SDN 中，控制器用于为 openflow 交换机（哑）提供功能。

考虑这两部分，

1)**控制器：**这些是在任何设备上运行的程序，其逻辑可能是 l2/l3，并根据控制器中定义的算法使开关连接到它。市场上有一些控制器 API，如 POX、NOX、PYRETIC、FLOODLIGHT 等不同语言，您可以实现这些 API 来编写自己的控制器。

2)**开关：**控制器控制开关。美好的！但是怎么做？必须有一些协议用来提供它们之间的通信，这就是我们所说的 OpenFlow 协议。控制器使用控制器的 API 和 openFlow API 来实现 OSPF/BGP 等功能。

**最后，这是想象中的结构。**

控制器（在某些 IP 上说 192.168.56.101）为 openflow 交换机提供 OSPF/防火墙/URL 过滤或任何功能>> OpenFlow 交换机或用于主机连接的交换机（哑）>> 然后有/是主机：如果您使用 mininet 模拟器，它们通常是基于 linux 的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-07T02:38:15.257

关于资源部分，

我不是说广告或背书，但 Nick Feamster（来自佐治亚理工学院）一直在 coursera 上提供 SDN 课程。内容相当整齐。此外，搜索由 Nick 和许多来自 SDN 空间的知名人士进行的采访，谈论各种问题。

PS：我不是这样做广告的，我参加了课程，对SDN有了很清楚的了解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T21:15:02.223

路由确实发生在 SDN 中，但它集中在所谓的控制器上。大多数传统路由协议很重，只是因为需要跨网络基础设施同步路由表的分布式数据库。使用 SDN，路由过程变成了一个处理集中式数据库的简单应用程序。然后控制器将路由表传输到网络设备......

# php - 尝试使用从文本框 PHP 输入的值更新数据库

> ID：14735460
> 
> 赞同：-2
> 
> 时间：2013-02-06T17:44:25.197
> 
> 标签：php, mysql

我想要做的是获取在文本框中输入的值，然后将该值插入数据库

此代码似乎正在工作，但它只会将选择的值更改为 0

```
 <?php

 $q1 = $_POST['q1'] ;
$q2 = $_POST['q2'] ;
$q3 = $_POST['q3'] ;
$q4 = $_POST['q4'] ;

$qe = $_POST['qe'] ;

$LT1 = $_POST['LT1'] ;
$LT2 = $_POST['LT2'] ; 

$THW = $_POST['THW'] ;
$TSW = $_POST['TSW'] ;

$Ct = $_POST['Ct'] ;
$Pj = $_POST['Pj'] ; 
```

$insert = mysql_query("更新成绩 SET HQ1 = ' . $q1 . ' WHERE ID='4011909'");

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:45:25.913

删除查询中的连接符号

```
$insert = mysql_query("UPDATE grades SET HQ1 = '$q1' WHERE ID='4011909'"); 
```

# haskell - 如何将类型构造函数限制为返回 Ord 类型？

> ID：14735463
> 
> 赞同：6
> 
> 时间：2013-02-06T17:44:42.827
> 
> 标签：haskell, type-kinds

假设我有一个树的实现：

```
data Tree a children = EmptyTree | Tree a (children (Tree a children)) 
```

是否可以限制`children`返回`Ord`类型？

类似于：

```
data (Ord children *) => Tree a children = EmptyTree | Tree a (children (Tree a children)) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T18:14:39.797

我至少可以想到两种方法：

## 1\. GADT

例如看[这里](http://www.haskell.org/haskellwiki/GADTs_for_dummies)。

```
{-# LANGUAGE GADTs #-}

data Tree a children where
    Empty :: Tree a children
    Tree :: Ord (children a) => a -> children (Tree a children) -> Tree a children 
```

现在你可以这样做：

```
ghci> let t = Tree 1 [Tree 2 [], Empty]
ghci> :t t
t :: Tree Integer [] 
```

## 2\. 智能构造函数

您可以将常规数据类型与具有受限类型签名的智能构造函数一起使用：

```
{-# LANGUAGE FlexibleContexts #-}

data Tree a children = Empty | Tree a (children (Tree a children))

empty :: Tree a children
empty = Empty

tree :: Ord (children a) => a -> children (Tree a children) -> Tree a children
tree val rest = Tree val rest 
```

你现在可以这样做：

```
ghci> let t = tree 1 [tree 2 [], empty]
ghci> :t t
t :: Tree Integer [] 
```

但如果您尝试添加不可订购的类型：

```
ghci> let t = tree (+1) []
<interactive>:69:9:
    No instance for (Ord (a0 -> a0))
      arising from a use of `tree'
    Possible fix: add an instance declaration for (Ord (a0 -> a0))
    In the expression: tree (+ 1) []
    In an equation for `t': t = tree (+ 1) [] 
```

# python - Django 与 Gunicorn 不同的部署方式

> ID：14735464
> 
> 赞同：6
> 
> 时间：2013-02-06T17:44:43.433
> 
> 标签：python, django, nginx, gunicorn

我一直在阅读有关使用 gunicorn 部署 Django 的文章，我想尝试一下。

我发现了至少 3 种使用 gunicorn 和 django 运行服务器的方法：

1.  `gunicorn [OPTIONS] [APP_MODULE] # tested locally and worked fine`
2.  `python managy.py run_gunicorn # also works fine locally`
3.  `gunicorn_django [OPTIONS] [SETTINGS_PATH] # I have an error due to apps/ location`

我目前有 Apache 和 nginx（服务静态文件）在生产中，工作正常但有点慢，想试试 Gunicorn。前 2 个选项在 nginx 提供静态文件时在本地运行良好。

我想知道一些事情：

1.  以上任何选项有什么区别？
2.  `PRODUCTION`在环境中运行的正确指令是什么？

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T23:29:05.400

`gunicorn_django [OPTIONS] myproject`如果您使用，请使用`myproject.settings`

# javascript - MongoDB中的Map Reduce：未定义不是一个函数

> ID：14735467
> 
> 赞同：1
> 
> 时间：2013-02-06T17:44:50.100
> 
> 标签：javascript, node.js, mongodb

我必须使用`mapReduce`一个项目，我开始遵循[文档](http://docs.mongodb.org/manual/applications/map-reduce/)。

我按照页面中的[第一个](http://docs.mongodb.org/manual/applications/map-reduce/#return-the-total-price-per-customer-id)示例创建了一个[测试项目。](https://github.com/IonicaBizau/mongodb-map-reduce/blob/cde57ea8d4ea72661e35319ea5fb65d5552b2e9f/server.js)

我创建了一个名为`test`Mongo 的数据库，并将示例中的对象插入到 collection 中`col_one`：

```
{
     _id: ObjectId("50a8240b927d5d8b5891743c"),
     cust_id: "abc123",
     ord_date: new Date("Oct 04, 2012"),
     status: 'A',
     price: 250,
     items: [ { sku: "mmm", qty: 5, price: 2.5 },
              { sku: "nnn", qty: 5, price: 2.5 } ]
} 
```

我的代码很简单（例如示例）：

```
// MongoDB part
// Create server

var mapFunction1 = function() {
   emit(this.cust_id, this.price);
};

var reduceFunction1 = function(keyCustId, valuesPrices) {
   return Array.sum(valuesPrices);
};

collection.mapReduce(
   mapFunction1,
   reduceFunction1,
   { out: "col_two" }
);

// Print items from col_two 
```

这会引发此错误：

```
.../node_modules/mongodb/lib/mongodb/connection/server.js:524
        throw err;
              ^ TypeError: undefined is not a function 
```

如果我改成这个，这个错误就会消失。

```
collection.mapReduce(
   mapFunction1,
   reduceFunction1,
   { out: "col_two" },
   function() {
       // Print items from col_two
   }
); 
```

为什么错误会消失？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:13:23.863

您遇到的问题是 shell 中使用的 API 与本机 node.js 驱动程序之间的主要区别之一：shell 是同步的，而 node.js 驱动程序是异步的。

由于 node.js 驱动程序是异步的，因此您必须按照[文档](http://mongodb.github.com/node-mongodb-native/api-generated/collection.html#mapreduce)`mapReduce`中的说明为调用提供回调参数，以便您可以接收结果。

# python - 在 Python 中避免 Mersenne Twister 的精确重复

> ID：14735468
> 
> 赞同：1
> 
> 时间：2013-02-06T17:44:50.770
> 
> 标签：python, random, seeding, mersenne-twister

众所周知，Python 使用 Mersenne Twister (MT) 算法来处理其随机数。然而，尽管周期很长（~2^19937），但众所周知，当您对大于 2080 个元素的序列进行洗牌时（因为 !2081 > 2^19937），您无法达到每个随机排列。当我处理排列和统计属性对我来说很重要时，我试图找出将 Python 生成器与额外的随机源混合或重新播种以避免重复的最佳方法。

目前，我的概念是使用系统随机数生成器（SystemRandom）为MT生成器添加一个外部随机源。我可以想到两种方法来做到这一点：

1.  将 SystemRandom 随机数与 MT 随机数异或
2.  使用 SystemRandom 重新播种 MT

第一种方法由硬件随机数生成器以某种频率使用，以减少它们的偏差趋势。但是，它的效率非常低。在 Windows XP 机器上，SystemRandom 比标准 Python 随机函数慢 50 倍。当您的大部分功能都涉及改组时，这对性能造成了巨大的影响。鉴于此，使用 SystemRandom 重新播种 MT 应该会更加有效。

但是，这种方法也存在两个问题。首先，在运行期间重新播种 MT 可能会破坏其统计特性。我相当肯定，如果 MT 运行的时间足够长，这应该不是问题，因为每次运行的 MT 值都应该是格式正确的（无论起点如何）。然而，它确实表明在 MT 重新播种之间有一个相当长的时期是优选的。其次，有一个问题是什么是触发重新播种的最有效方法。处理此问题的最简单方法是使用计数器。然而，更有效的方法可能是可能的。

那么，关于这一点有三个问题：

1.  有没有人读过任何关于在每 N 个样本后用随机值重新播种 MT 会改变其理想的统计特性的内容？
2.  有没有人知道比增加计数器来触发重新播种更有效的方法？
3.  最后，如果有人知道解决这个问题的一般更好的方法，我会全力以赴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:53:52.290

重新播种不会帮助你。它只会跳入（非常非常）长的 MT 序列的其他地方。你确定洗牌你的数据会给你一个有偏见的结果吗？因为在宇宙的生命周期中，你永远不会有足够的时间来生成所有可能的序列。因此，即使您知道某些序列可能永远无法生成，但这并不意味着生成的序列会有偏差。我想你最好的选择就是简单地使用 shuffle 命令。

* * *

如果您查看[numpy.random.shuffle 源代码](https://github.com/numpy/numpy/blob/master/numpy/random/mtrand/mtrand.pyx)（第 4376 行），这里基本上是使用的算法（为了清楚起见，我对其进行了简化）：

```
i = len(x) - 1
while i > 0:
    j = randint(0, i)
    x[i], x[j] = x[j], x[i]
    i = i - 1 
```

换句话说，从末尾开始，它将值与数组中在它之前随机获取的随机值交换，直到所有值都被交换。最终状态不仅取决于随机生成器，还取决于数组的初始状态。这意味着理论上，如果您执行足够的洗牌，您应该能够访问所有排列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-22T00:30:25.050

I realise this was more than a year ago, but in case you glance back, there's an easy solution: Just grab a new value from SystemRandom to XOR with the output from the MT RNG *every kth time, for some sufficiently large k,* instead of every time. E.g. if SystemRandom is 50 times slower and you set k = 5000, your new combined RNG should only be ~1% slower, and (assuming that SystemRandom is "really" random) any permutation can be reached in every run involving more than 5000 RNG calls.

# python - 使用嵌套循环的 Windchill 表

> ID：14735469
> 
> 赞同：1
> 
> 时间：2013-02-06T17:45:00.230
> 
> 标签：python, python-2.7, nested-loops

我正在编写一个程序，它使用 windchill 索引打印一个表格。每个 Windchill 值都应足以对应相应的行和列。

```
def main():    
    windSpeed = 0
    temp = 0
    windChill = 35.74 + (0.6215 * temp) - 35.75 * (windSpeed ** 0.16) \
            + 0.4275 * temp * (windSpeed ** 0.16)

    # table frame, temps
    for temp in range(-20, 70, 10):
        print 2 * " ", temp, 
    print "\n", " " * 2, "-" * 51    

    #table frame, speeds
    for windSpeed in range (0, 35, 5):
        print windSpeed

main() 
```

这会产生：

```
 -20    -10    0    10    20    30    40    50    60 
  ---------------------------------------------------
0
5
10
15
20
25
30 
```

显然，困难的部分是实际打印 Windchill 值。我一直在玩代码，它只打印出第一个 Windchill 值，其系数值为 0 和 0，这些值是在程序开始时定义的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:56:30.057

您需要遍历温度和风速的所有值，每次都重新计算风寒。一个很好的方法可能是将 windChill 重新定义为一个函数。要使表格以正确的间距打印，您可以使用 [字符串格式](http://docs.python.org/2/library/string.html#string-formatting)。

```
def main():    
    def wind_chill(temp, wind_speed):
        return 35.74 + (0.6215 * temp) - 35.75 * (wind_speed ** 0.16) \
            + 0.4275 * temp * (wind_speed ** 0.16)

    heading = '  '
    for temp in range(-20, 70, 10):
        heading += "{:>7d}".format(temp)
    print heading + "\n   " + "-" * 62    
    for wind_speed in range (0, 35, 5):
        output_line = "{:>2d}".format(wind_speed)
        for temp in range(-20, 70, 10):
            output_line += "{:>7.1f}".format(wind_chill(temp, wind_speed))
        print output_line

main() 
```

或者，首先将所有数据设置在二维数组（列表列表）中，然后使用单个长格式字符串将其打印出来。（这用于`sum`将列表列表扁平化为一个长序列。）

```
def main():    
    temps = range(-20, 70, 10)
    winds = range(0, 35, 5)
    chill = [[w] + [35.74 + .6215 * t - 35.75 * w**.16 + .4275 * t * w**.16 
                   for t in temps] for w in winds]
    rows = len(winds)
    cols = len(temps)
    print ('  ' + '{:7d}' * cols + '\n  ' + '-' * cols * 7
           + ('\n{:2d}' + '{:7.1f}' * cols) * rows).format(*sum(chill, temps)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T19:29:24.953

由于不可能返回并更改之后已经打印的行，因此您需要在打印出表格的每一行的同时计算风寒。与其为每行中出现的每个温度和风速组合重复冗长的表达式，不如创建一个单独的函数来计算它们的值，然后用（它的短得多的）名称重复调用它。

内置的字符串方法`format()`使得以所需方式显示所有正在计算的数据变得相对简单——因此花时间了解它的工作原理将是一项非常值得的尝试。

这是执行此操作的代码，它也尝试遵循 [PEP 8 - Style Guide for Python Code](https://www.python.org/dev/peps/pep-0008/)。

```
def wind_chill(temp, wind_speed):
    """ Compute wind chill given temperature and wind speed if the
        temperature is 50 degrees Fahrenheit or less and the wind speed is
        above 3 mph, otherwise return 'nan' (not-a-number) because it's an
        undefined quantity in those situations.
    """
    return (35.74 + (0.6215 * temp) - 35.75 * (wind_speed ** 0.16)
            + 0.4275 * temp * (wind_speed ** 0.16)
                if temp <= 50 and wind_speed > 3 else
            float('nan'))

def main():
    # print table header
    temps = xrange(-20, 70, 10)
    num_temps = len(temps)
    data = [" "] + [temp for temp in temps]
    print ("{:3s}" + num_temps * " {:5d}").format(*data)
    data = [" "] + num_temps * [5 * "-"]
    print ("{:3s}" + num_temps * " {:5s}").format(*data)

    # print table rows
    row_format_string = "{:3d}" + num_temps * " {:5.1F}"
    for wind_speed in xrange(0, 35, 5):
        data = [wind_speed] + [wind_chill(temp, wind_speed) for temp in temps]
        print row_format_string.format(*data)

main() 
```

输出：

```
 -20   -10     0    10    20    30    40    50    60
    ----- ----- ----- ----- ----- ----- ----- ----- -----
  0   NAN   NAN   NAN   NAN   NAN   NAN   NAN   NAN   NAN
  5 -34.0 -22.3 -10.5   1.2  13.0  24.7  36.5  48.2   NAN
 10 -40.7 -28.3 -15.9  -3.5   8.9  21.2  33.6  46.0   NAN
 15 -45.0 -32.2 -19.4  -6.6   6.2  19.0  31.8  44.6   NAN
 20 -48.2 -35.1 -22.0  -8.9   4.2  17.4  30.5  43.6   NAN
 25 -50.8 -37.5 -24.1 -10.7   2.6  16.0  29.4  42.8   NAN
 30 -53.0 -39.4 -25.9 -12.3   1.3  14.9  28.5  42.0   NAN 
```

# sql - 将单个数据行导出到多个 CSV 行的 SQL 查询

> ID：14735473
> 
> 赞同：0
> 
> 时间：2013-02-06T17:45:32.110
> 
> 标签：sql, sql-server-2008-r2, export-to-csv

我们正在尝试自动化一些步骤，我需要设置一个查询来按计划转储数据。我遇到的问题是从 SQL 表中获取单行数据并将其转储到多行数据中。SQL 表用于零件订购单，具有最多可输入 10 个零件的字段 (Part01 - Part10) 和每个零件的数量字段 (Qty01-Qty10)。和大多数订单一样，我们不会在每个订单上使用全部 10 行，所以在导出时，我们还需要测试 part 字段 (PartXX<>'') 中是否有数据，以便只为实际有的行生成行数据。表中还有一些字段需要填充到每个输出行中，即使它没有更改。第一个“行”的查询是直截了当的，但我的障碍是“IF/THEN”

我正在寻找的输出是这样的：

```
Ticket# CustID Account Line ShipAttn ShipAdd ShipCity ShipState ShipZip 部件数量
123456 Cust01 987465 1 Joe Smith 地址 AnyTown IL 01234 Key 2
123456 Cust01 987456 2 Joe Smith 地址 AnyTown IL 01234 锁 2
```

任何方向表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:19:06.820

不知道您的确切架构，您可能会尝试这样的事情来取消您的记录：

```
;with cte as (
    -- Select for each Part/Qty:
    select Ticket#, CustID, Account, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part01 as Part, Qty01 as Qty, 1 as Line
    from Orders
    where Part01 is not null and Qty01 is not null
    union all
    select Ticket#, CustID, Account, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part02 as Part, Qty02 as Qty, 2 as Line -- 02!
    from Orders
    where Part02 is not null and Qty02 is not null -- 02!
    union all
    select Ticket#, CustID, Account, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part03 as Part, Qty03 as Qty, 3 as Line -- 03!
    from Orders
    where Part03 is not null and Qty03 is not null -- 03!
    --union all...keep going with 04 - 10
)
select Ticket#, CustID, Account
    , row_number() over (partition by Ticket# order by Line) as Line
    , ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part, Qty
from cte
order by Ticket#, Line 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:19:55.037

您正在寻找的是**数据透视**表（或“交叉表”）。每个 RDBMS 都有自己的解决方案，您没有提供自己的解决方案。确切的语法还取决于您的 RDBMS。

**标准 SQL**查询可能如下所示：

```
SELECT Ticket#, CustID, Account, 1 AS Line, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part01 AS Part, Qty01 AS Qty
FROM   tbl
WHERE  Part01 IS NOT NULL

UNION ALL
SELECT Ticket#, CustID, Account, 2 AS Line, ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part02 AS Part, Qty02 AS Qty
FROM   tbl
WHERE  Part02 IS NOT NULL

UNION ALL ...

ORDER BY Ticket#, CustID, Account, Line 
```

`ORDER BY`应用于完整的结果，而不仅仅是查询的最后一段。因此，您不需要子选择或 CTE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T21:01:36.403

上述两种解决方案都需要联合，因为您使用的是 SQL Server 2008 R2，您可能想要使用 UnPivot 的内置功能......它仍然未经测试，但它应该可以工作。

它基于描述的解决方案：http: [//mangalpardeshi.blogspot.com/2009/04/unpivot-multiple-columns.html](http://mangalpardeshi.blogspot.com/2009/04/unpivot-multiple-columns.html)

```
SELECT Ticket#, CustID, Account
    , row_number() over (partition by Ticket# order by Parts) as Line
    , ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip, Part, Qty 
FROM 
( 
SELECT Ticket#, CustID, Account , ShipAttn, ShipAdd, ShipCity, ShipState, ShipZip,
       Part01, Part02, Part03, Part04, Part05, Part06, Part07, Part08, Part09, Part10,
       Qty01, Qty02, Qty03, Qty04, Qty05, Qty06, Qty07, Qty08, Qty09, Qty10
FROM Suppliers 
) Main
UNPIVOT 
( 
Part FOR Parts IN (Part01, Part02, Part03, Part04, Part05, Part06, Part07, Part08, Part09, Part10) 
) P

UNPIVOT 
( 
Qty For Qtys IN (Qty01, Qty02, Qty03, Qty04, Qty05, Qty06, Qty07, Qty08, Qty09, Qty10) 
) Q

WHERE RIGHT(Parts,2) =  RIGHT(Qtys,2) 
```

# html - 如何在 iframe 中获取 div？

> ID：14735476
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:45:42.077
> 
> 标签：html, iframe

好的，所以我有一个 iframe，但我只想要一个特定的 div。我无法编辑原始页面。

我如何得到那个div？我试图环顾四周，似乎没有什么令人满意的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:47:53.947

使用您的服务器作为代理来获取和提取您想要的 HTML 部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:48:25.733

如果您有所需的 div 的 ID，则可以执行 javascript 或 jquery 搜索以从 html 代码中提取 div 并显示它。这不需要 iframe（iframe 在框中显示整个 html 文档）。

# c# - 从存储过程中获取返回值

> ID：14735477
> 
> 赞同：52
> 
> 时间：2013-02-06T17:45:42.357
> 
> 标签：c#, stored-procedures, ef-code-first, entity-framework-5, return-value

我正在使用 Entity Framework 5 和 Code First 方法。我需要从存储过程中读取返回值；我已经在读取输出参数和发送输入参数，但我不知道如何读取返回值。

可能吗？

这是我用来调用存储过程的代码：

```
var outParam = new SqlParameter();
outParam.ParameterName = "@StatusLog";
outParam.SqlDbType = SqlDbType.NVarChar;
outParam.Size = 4000;
outParam.Direction = ParameterDirection.Output;

var code = new SqlParameter();
code.ParameterName = "@Code";
code.Direction = ParameterDirection.Input;
code.SqlDbType = SqlDbType.VarChar;
code.Size = 20;
code.Value = "123";

var data = _context.Database.SqlQuery<Item>("exec spItemData @Code, @StatusLog OUT", code, outParam);

var result = data.FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-06T17:45:42.357

我找到了！我可以使用必须以这种方式使用的输出参数来读取返回值：

```
// define a new output parameter
var returnCode = new SqlParameter();
returnCode.ParameterName = "@ReturnCode";
returnCode.SqlDbType = SqlDbType.Int;
returnCode.Direction = ParameterDirection.Output;

// assign the return code to the new output parameter and pass it to the sp
var data = _context.Database.SqlQuery<Item>("exec @ReturnCode = spItemData @Code, @StatusLog OUT", returnCode, code, outParam); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2015-10-21T15:50:58.220

Daniele 提供的解决方案对我不起作用，直到我发现[Diego Vega](https://stackoverflow.com/users/393050/divega)[的这篇博](http://blogs.msdn.com/b/diego/archive/2012/01/10/how-to-execute-stored-procedures-sqlquery-in-the-dbcontext-api.aspx)文，它解释说：

> 您需要先阅读整个结果，然后才能访问输出参数的值 (...) 这只是存储过程的工作方式，并非特定于此 EF 功能。

另外，在我的情况下，我没有返回实体，我只需要执行存储过程，所以我替换`Item`为`object`in `_context.Database.SqlQuery<object>`。

这是示例代码：

```
var code = new SqlParameter("@Code", 1);

var returnCode = new SqlParameter("@ReturnCode", SqlDbType.Int);
returnCode.Direction = ParameterDirection.Output;

var outParam = new SqlParameter("@StatusLog", SqlDbType.Int);
outParam.Direction = ParameterDirection.Output;

var sql = "exec @ReturnCode = spSomeRoutine @Code, @StatusLog OUT";
var data = _context.Database.SqlQuery<object>(sql, returnCode, code, outParam);

// Read the results so that the output variables are accessible
var item = data.FirstOrDefault();

var returnCodeValue = (int)returnCode.Value;
var outParamValue = (int)outParam.Value; 
```

这是一个示例存储过程：

```
CREATE PROCEDURE [dbo].[spSomeRoutine]
    @Code Int,
    @StatusLog INT OUTPUT
AS
BEGIN
    SET @StatusLog = 5
    RETURN 10
END 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-03-01T06:50:16.510

在存储过程没有输出参数的情况下，我执行以下操作，有效地制作了一些返回 select 语句的 Sql；

```
var data = context.Database.SqlQuery<int>(@"declare @num int
exec  @num = myStoredProcThatReturnsInt 
select @num");

var result = data.First(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-18T15:33:30.490

您可以将存储过程添加为 EF 函数，然后从上下文中直接调用它。

请参阅[http://www.entityframeworktutorial.net/EntityFramework4.3/execute-stored-procedure-using-dbcontext.aspx](http://www.entityframeworktutorial.net/EntityFramework4.3/execute-stored-procedure-using-dbcontext.aspx)

了解更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-20T18:14:14.493

对于使用 EDMX 文件的任何人，您可以添加代码生成项，然后使用以下 t4 代码替换 .Context.tt。它将使用以下方法创建所有代码来映射您的存储过程：

```
var returnCode = new SqlParameter("@ReturnCode", SqlDbType.Int);
returnCode.Direction = ParameterDirection.Output;
var sql = "exec @ReturnCode = spSomeRoutine @Code, @StatusLog OUT";
var data = _context.Database.SqlQuery<object>(sql, returnCode, code, outParam); 
```

当有结果集时它将使用 SqlQuery<>，没有结果集时将使用 ExecuteSqlCommand，但在这两种情况下，out SqlParameter localSqlExecReturnValue 将包含来自存储过程调用的 int 返回代码。这可以与其他生成器一起使用，它只会为存储过程调用生成额外的代码。

**存储过程.Context.tt：**

```
<#@ template language="C#" debug="false" hostspecific="true"#>
<#@ include file="EF6.Utility.CS.ttinclude"#><#@
 output extension=".cs"#><#

const string inputFile = @"CDMSAccountingModel.edmx";
var textTransform = DynamicTextTransformation.Create(this);
var code = new CodeGenerationTools(this);
var ef = new MetadataTools(this);
var typeMapper = new TypeMapper(code, ef, textTransform.Errors);
var loader = new EdmMetadataLoader(textTransform.Host, textTransform.Errors);
var itemCollection = loader.CreateEdmItemCollection(inputFile);
var modelNamespace = loader.GetModelNamespace(inputFile);
var codeStringGenerator = new CodeStringGenerator(code, typeMapper, ef);

var container = itemCollection.OfType<EntityContainer>().FirstOrDefault();
if (container == null)
{
    return string.Empty;
}
#>
//------------------------------------------------------------------------------
// <auto-generated>
// <#=CodeGenerationTools.GetResourceString("Template_GeneratedCodeCommentLine1")#>
//
// <#=CodeGenerationTools.GetResourceString("Template_GeneratedCodeCommentLine2")#>
// <#=CodeGenerationTools.GetResourceString("Template_GeneratedCodeCommentLine3")#>
// </auto-generated>
//------------------------------------------------------------------------------

<#

var codeNamespace = code.VsNamespaceSuggestion();
if (!String.IsNullOrEmpty(codeNamespace))
{
#>
namespace <#=code.EscapeNamespace(codeNamespace)#>
{
<#
    PushIndent("    ");
}

#>
using System;
using System.Data.Entity;
using System.Data.Entity.Infrastructure;
<#
if (container.FunctionImports.Any())
{
#>
using System.Data.Entity.Core.Objects;
using System.Linq;
<#
}
#>

<#=Accessibility.ForType(container)#> partial class <#=code.Escape(container)#> : DbContext
{

<#
foreach (var entitySet in container.BaseEntitySets.OfType<EntitySet>())
{
    // Note: the DbSet members are defined below such that the getter and
    // setter always have the same accessibility as the DbSet definition
    if (Accessibility.ForReadOnlyProperty(entitySet) != "public")
    {
#>
        <#=codeStringGenerator.DbSetInitializer(entitySet)#>
<#
    }
}
#>

<#
    foreach (var edmFunction in container.FunctionImports)
    {
        WriteFunctionImport(typeMapper, codeStringGenerator, edmFunction, modelNamespace, includeMergeOption: false);
    }
#>
}
<#

if (!String.IsNullOrEmpty(codeNamespace))
{
    PopIndent();
#>
}
<#
}
#>
<#+

private void WriteFunctionImport(TypeMapper typeMapper, CodeStringGenerator codeStringGenerator, EdmFunction edmFunction, string modelNamespace, bool includeMergeOption)
{
    if (typeMapper.IsComposable(edmFunction))
    {
#>

    [DbFunction("<#=edmFunction.NamespaceName#>", "<#=edmFunction.Name#>")]
    <#=codeStringGenerator.ComposableFunctionMethod(edmFunction, modelNamespace)#>
    {
<#+
        codeStringGenerator.WriteFunctionParameters(edmFunction, WriteFunctionParameter );
#>
        <#=codeStringGenerator.ComposableCreateQuery(edmFunction, modelNamespace)#>
    }
<#+
    }
    else
    {
#>

    <#=codeStringGenerator.FunctionMethod(edmFunction, modelNamespace, includeMergeOption)#>
    {
<#+
        codeStringGenerator.WriteFunctionParameters(edmFunction, WriteFunctionParameter);
#>
        localSqlExecReturnValue = new System.Data.SqlClient.SqlParameter("@localExecReturnValue",System.Data.SqlDbType.Int);
        localSqlExecReturnValue.Direction = System.Data.ParameterDirection.Output;

        <#=codeStringGenerator.ExecuteFunction(edmFunction, modelNamespace, includeMergeOption)#>
    }
<#+
        if (typeMapper.GenerateMergeOptionFunction(edmFunction, includeMergeOption))
        {
            WriteFunctionImport(typeMapper, codeStringGenerator, edmFunction, modelNamespace, includeMergeOption: true);
        }
    }
}

public void WriteFunctionParameter(string name, string isNotNull, string notNullInit, string nullInit)
{
#>
        var <#=name#> = <#=isNotNull#> ?
            <#=notNullInit#> :
            <#=nullInit#>;

<#+
}

public const string TemplateId = "CSharp_DbContext_Context_EF6";

public class CodeStringGenerator
{
    private readonly CodeGenerationTools _code;
    private readonly TypeMapper _typeMapper;
    private readonly MetadataTools _ef;

    public CodeStringGenerator(CodeGenerationTools code, TypeMapper typeMapper, MetadataTools ef)
    {
        ArgumentNotNull(code, "code");
        ArgumentNotNull(typeMapper, "typeMapper");
        ArgumentNotNull(ef, "ef");

        _code = code;
        _typeMapper = typeMapper;
        _ef = ef;
    }

    public string Property(EdmProperty edmProperty)
    {
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} {1} {2} {{ {3}get; {4}set; }}",
            Accessibility.ForProperty(edmProperty),
            _typeMapper.GetTypeName(edmProperty.TypeUsage),
            _code.Escape(edmProperty),
            _code.SpaceAfter(Accessibility.ForGetter(edmProperty)),
            _code.SpaceAfter(Accessibility.ForSetter(edmProperty)));
    }

    public string NavigationProperty(NavigationProperty navProp)
    {
        var endType = _typeMapper.GetTypeName(navProp.ToEndMember.GetEntityType());
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} {1} {2} {{ {3}get; {4}set; }}",
            AccessibilityAndVirtual(Accessibility.ForNavigationProperty(navProp)),
            navProp.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many ? ("ICollection<" + endType + ">") : endType,
            _code.Escape(navProp),
            _code.SpaceAfter(Accessibility.ForGetter(navProp)),
            _code.SpaceAfter(Accessibility.ForSetter(navProp)));
    }

    public string AccessibilityAndVirtual(string accessibility)
    {
        return accessibility + (accessibility != "private" ? " virtual" : "");
    }

    public string EntityClassOpening(EntityType entity)
    {
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} {1}partial class {2}{3}",
            Accessibility.ForType(entity),
            _code.SpaceAfter(_code.AbstractOption(entity)),
            _code.Escape(entity),
            _code.StringBefore(" : ", _typeMapper.GetTypeName(entity.BaseType)));
    }

    public string EnumOpening(SimpleType enumType)
    {
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} enum {1} : {2}",
            Accessibility.ForType(enumType),
            _code.Escape(enumType),
            _code.Escape(_typeMapper.UnderlyingClrType(enumType)));
        }

    public void WriteFunctionParameters(EdmFunction edmFunction, Action<string, string, string, string> writeParameter)
    {
        var parameters = FunctionImportParameter.Create(edmFunction.Parameters, _code, _ef);
        foreach (var parameter in parameters.Where(p => p.NeedsLocalVariable))
        {
            var isNotNull = parameter.IsNullableOfT ? parameter.FunctionParameterName + ".HasValue" : parameter.FunctionParameterName + " != null";
            var notNullInit = "new System.Data.SqlClient.SqlParameter(\"@" + parameter.EsqlParameterName + "\", " + parameter.FunctionParameterName + ")";
            var nullInit = "new System.Data.SqlClient.SqlParameter(\"@" + parameter.EsqlParameterName + "\", SqlHelper.GetDbType(typeof(" + TypeMapper.FixNamespaces(parameter.RawClrTypeName) + ")))";
            writeParameter(parameter.LocalVariableName, isNotNull, notNullInit, nullInit);
        }
    }

    public string ComposableFunctionMethod(EdmFunction edmFunction, string modelNamespace)
    {
        var parameters = _typeMapper.GetParameters(edmFunction);

        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} IQueryable<{1}> {2}({3})",
            AccessibilityAndVirtual(Accessibility.ForMethod(edmFunction)),
            _typeMapper.GetTypeName(_typeMapper.GetReturnType(edmFunction), modelNamespace),
            _code.Escape(edmFunction),
            string.Join(", ", parameters.Select(p => TypeMapper.FixNamespaces(p.FunctionParameterType) + " " + p.FunctionParameterName).ToArray()));
    }

    public string ComposableCreateQuery(EdmFunction edmFunction, string modelNamespace)
    {
        var parameters = _typeMapper.GetParameters(edmFunction);

        return string.Format(
            CultureInfo.InvariantCulture,
            "return ((IObjectContextAdapter)this).ObjectContext.CreateQuery<{0}>(\"[{1}].[{2}]({3})\"{4});",
            _typeMapper.GetTypeName(_typeMapper.GetReturnType(edmFunction), modelNamespace),
            edmFunction.NamespaceName,
            edmFunction.Name,
            string.Join(", ", parameters.Select(p => "@" + p.EsqlParameterName).ToArray()),
            _code.StringBefore(", ", string.Join(", ", parameters.Select(p => p.ExecuteParameterName).ToArray())));
    }

    public string FunctionMethod(EdmFunction edmFunction, string modelNamespace, bool includeMergeOption)
    {
        var parameters = _typeMapper.GetParameters(edmFunction);
        var returnType = _typeMapper.GetReturnType(edmFunction);

        var paramList = String.Join(", ", parameters.Select(p => TypeMapper.FixNamespaces(p.FunctionParameterType) + " " + p.FunctionParameterName).ToArray());
        paramList = String.Join(",", paramList, " out System.Data.SqlClient.SqlParameter localSqlExecReturnValue").Trim().TrimStart(',');
        paramList = paramList.Replace("ObjectParameter", "System.Data.SqlClient.SqlParameter");
        if (includeMergeOption)
        {
            paramList = _code.StringAfter(paramList, ", ") + "MergeOption mergeOption";
        }

        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} {1} {2}({3})",
            AccessibilityAndVirtual(Accessibility.ForMethod(edmFunction)),
            returnType == null ? "int" : "System.Collections.Generic.List<" + _typeMapper.GetTypeName(returnType, modelNamespace) + ">",
            _code.Escape(edmFunction),
            paramList);
    }

    public string ExecuteFunction(EdmFunction edmFunction, string modelNamespace, bool includeMergeOption)
    {
        var parameters = _typeMapper.GetParameters(edmFunction);
        var returnType = _typeMapper.GetReturnType(edmFunction);

        var callParams =  String.Join(", ", parameters.Select(p => p.ExecuteParameterName).ToArray());
        callParams = _code.StringBefore(", ", String.Join(",", "localSqlExecReturnValue", callParams)).TrimEnd(',').Trim();

        var inSqlParams = String.Join(", ", parameters.Where(p => p.NeedsLocalVariable).Select(p => "@" + p.Source.Name).ToArray());
        var outSqlParams = String.Join(", ", parameters.Where(p => !p.NeedsLocalVariable).Select(p => "@" + p.Source.Name + " OUTPUT").ToArray());
        var sqlParams = "";
        if (inSqlParams.Count() > 0)
        {
            sqlParams = String.Join(", ", sqlParams, inSqlParams);
        }
        if (outSqlParams.Count() > 0)
        {
            sqlParams = String.Join(", ", sqlParams, outSqlParams);
        }
        sqlParams = sqlParams.Trim().Trim(',').Trim();
        if (includeMergeOption)
        {
            callParams = ", mergeOption" + callParams;
        }
        var retstring = string.Format(
            CultureInfo.InvariantCulture,
            "var results = {3}{0}(\"EXEC @localExecReturnValue = {1} {4}\"{2});",
            returnType == null ? "" : "<" + _typeMapper.GetTypeName(returnType, modelNamespace) + ">",
            edmFunction.Name,
            callParams,returnType != null ? "this.Database.SqlQuery" : "this.Database.ExecuteSqlCommand", sqlParams);
        retstring += Environment.NewLine;
        retstring += returnType != null ? "\t\treturn results.ToList();" : "\t\treturn results;";
        //retstring += Environment.NewLine + "\t\tlocalExecReturnValue = (int)localSqlExecReturnValue.Value;" ;
        //retstring += Environment.NewLine + "\t\treturn results;";
        return retstring;
    }

    public string DbSet(EntitySet entitySet)
    {
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} virtual DbSet<{1}> {2} {{ get; set; }}",
            Accessibility.ForReadOnlyProperty(entitySet),
            _typeMapper.GetTypeName(entitySet.ElementType),
            _code.Escape(entitySet));
    }

    public string DbSetInitializer(EntitySet entitySet)
    {
        return string.Format(
            CultureInfo.InvariantCulture,
            "{0} = Set<{1}>();",
            _code.Escape(entitySet),
            _typeMapper.GetTypeName(entitySet.ElementType));
    }

    public string UsingDirectives(bool inHeader, bool includeCollections = true)
    {
        return inHeader == string.IsNullOrEmpty(_code.VsNamespaceSuggestion())
            ? string.Format(
                CultureInfo.InvariantCulture,
                "{0}using System;{1}" +
                "{2}",
                inHeader ? Environment.NewLine : "",
                includeCollections ? (Environment.NewLine + "using System.Collections.Generic;") : "",
                inHeader ? "" : Environment.NewLine)
            : "";
    }
}

public class TypeMapper
{
    private const string ExternalTypeNameAttributeName = @"http://schemas.microsoft.com/ado/2006/04/codegeneration:ExternalTypeName";

    private readonly System.Collections.IList _errors;
    private readonly CodeGenerationTools _code;
    private readonly MetadataTools _ef;

    public static string FixNamespaces(string typeName)
    {
        return typeName.Replace("System.Data.Spatial.", "System.Data.Entity.Spatial.");
    }

    public TypeMapper(CodeGenerationTools code, MetadataTools ef, System.Collections.IList errors)
    {
        ArgumentNotNull(code, "code");
        ArgumentNotNull(ef, "ef");
        ArgumentNotNull(errors, "errors");

        _code = code;
        _ef = ef;
        _errors = errors;
    }

    public string GetTypeName(TypeUsage typeUsage)
    {
        return typeUsage == null ? null : GetTypeName(typeUsage.EdmType, _ef.IsNullable(typeUsage), modelNamespace: null);
    }

    public string GetTypeName(EdmType edmType)
    {
        return GetTypeName(edmType, isNullable: null, modelNamespace: null);
    }

    public string GetTypeName(TypeUsage typeUsage, string modelNamespace)
    {
        return typeUsage == null ? null : GetTypeName(typeUsage.EdmType, _ef.IsNullable(typeUsage), modelNamespace);
    }

    public string GetTypeName(EdmType edmType, string modelNamespace)
    {
        return GetTypeName(edmType, isNullable: null, modelNamespace: modelNamespace);
    }

    public string GetTypeName(EdmType edmType, bool? isNullable, string modelNamespace)
    {
        if (edmType == null)
        {
            return null;
        }

        var collectionType = edmType as CollectionType;
        if (collectionType != null)
        {
            return String.Format(CultureInfo.InvariantCulture, "ICollection<{0}>", GetTypeName(collectionType.TypeUsage, modelNamespace));
        }

        var typeName = _code.Escape(edmType.MetadataProperties
                                .Where(p => p.Name == ExternalTypeNameAttributeName)
                                .Select(p => (string)p.Value)
                                .FirstOrDefault())
            ?? (modelNamespace != null && edmType.NamespaceName != modelNamespace ?
                _code.CreateFullName(_code.EscapeNamespace(edmType.NamespaceName), _code.Escape(edmType)) :
                _code.Escape(edmType));

        if (edmType is StructuralType)
        {
            return typeName;
        }

        if (edmType is SimpleType)
        {
            var clrType = UnderlyingClrType(edmType);
            if (!IsEnumType(edmType))
            {
                typeName = _code.Escape(clrType);
            }

            typeName = FixNamespaces(typeName);

            return clrType.IsValueType && isNullable == true ?
                String.Format(CultureInfo.InvariantCulture, "Nullable<{0}>", typeName) :
                typeName;
        }

        throw new ArgumentException("edmType");
    }

    public Type UnderlyingClrType(EdmType edmType)
    {
        ArgumentNotNull(edmType, "edmType");

        var primitiveType = edmType as PrimitiveType;
        if (primitiveType != null)
        {
            return primitiveType.ClrEquivalentType;
        }

        if (IsEnumType(edmType))
        {
            return GetEnumUnderlyingType(edmType).ClrEquivalentType;
        }

        return typeof(object);
    }

    public object GetEnumMemberValue(MetadataItem enumMember)
    {
        ArgumentNotNull(enumMember, "enumMember");

        var valueProperty = enumMember.GetType().GetProperty("Value");
        return valueProperty == null ? null : valueProperty.GetValue(enumMember, null);
    }

    public string GetEnumMemberName(MetadataItem enumMember)
    {
        ArgumentNotNull(enumMember, "enumMember");

        var nameProperty = enumMember.GetType().GetProperty("Name");
        return nameProperty == null ? null : (string)nameProperty.GetValue(enumMember, null);
    }

    public System.Collections.IEnumerable GetEnumMembers(EdmType enumType)
    {
        ArgumentNotNull(enumType, "enumType");

        var membersProperty = enumType.GetType().GetProperty("Members");
        return membersProperty != null 
            ? (System.Collections.IEnumerable)membersProperty.GetValue(enumType, null)
            : Enumerable.Empty<MetadataItem>();
    }

    public bool EnumIsFlags(EdmType enumType)
    {
        ArgumentNotNull(enumType, "enumType");

        var isFlagsProperty = enumType.GetType().GetProperty("IsFlags");
        return isFlagsProperty != null && (bool)isFlagsProperty.GetValue(enumType, null);
    }

    public bool IsEnumType(GlobalItem edmType)
    {
        ArgumentNotNull(edmType, "edmType");

        return edmType.GetType().Name == "EnumType";
    }

    public PrimitiveType GetEnumUnderlyingType(EdmType enumType)
    {
        ArgumentNotNull(enumType, "enumType");

        return (PrimitiveType)enumType.GetType().GetProperty("UnderlyingType").GetValue(enumType, null);
    }

    public string CreateLiteral(object value)
    {
        if (value == null || value.GetType() != typeof(TimeSpan))
        {
            return _code.CreateLiteral(value);
        }

        return string.Format(CultureInfo.InvariantCulture, "new TimeSpan({0})", ((TimeSpan)value).Ticks);
    }

    public bool VerifyCaseInsensitiveTypeUniqueness(IEnumerable<string> types, string sourceFile)
    {
        ArgumentNotNull(types, "types");
        ArgumentNotNull(sourceFile, "sourceFile");

        var hash = new HashSet<string>(StringComparer.InvariantCultureIgnoreCase);
        if (types.Any(item => !hash.Add(item)))
        {
            _errors.Add(
                new CompilerError(sourceFile, -1, -1, "6023",
                    String.Format(CultureInfo.CurrentCulture, CodeGenerationTools.GetResourceString("Template_CaseInsensitiveTypeConflict"))));
            return false;
        }
        return true;
    }

    public IEnumerable<SimpleType> GetEnumItemsToGenerate(IEnumerable<GlobalItem> itemCollection)
    {
        return GetItemsToGenerate<SimpleType>(itemCollection)
            .Where(e => IsEnumType(e));
    }

    public IEnumerable<T> GetItemsToGenerate<T>(IEnumerable<GlobalItem> itemCollection) where T: EdmType
    {
        return itemCollection
            .OfType<T>()
            .Where(i => !i.MetadataProperties.Any(p => p.Name == ExternalTypeNameAttributeName))
            .OrderBy(i => i.Name);
    }

    public IEnumerable<string> GetAllGlobalItems(IEnumerable<GlobalItem> itemCollection)
    {
        return itemCollection
            .Where(i => i is EntityType || i is ComplexType || i is EntityContainer || IsEnumType(i))
            .Select(g => GetGlobalItemName(g));
    }

    public string GetGlobalItemName(GlobalItem item)
    {
        if (item is EdmType)
        {
            return ((EdmType)item).Name;
        }
        else
        {
            return ((EntityContainer)item).Name;
        }
    }

    public IEnumerable<EdmProperty> GetSimpleProperties(EntityType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is SimpleType && p.DeclaringType == type);
    }

    public IEnumerable<EdmProperty> GetSimpleProperties(ComplexType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is SimpleType && p.DeclaringType == type);
    }

    public IEnumerable<EdmProperty> GetComplexProperties(EntityType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is ComplexType && p.DeclaringType == type);
    }

    public IEnumerable<EdmProperty> GetComplexProperties(ComplexType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is ComplexType && p.DeclaringType == type);
    }

    public IEnumerable<EdmProperty> GetPropertiesWithDefaultValues(EntityType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is SimpleType && p.DeclaringType == type && p.DefaultValue != null);
    }

    public IEnumerable<EdmProperty> GetPropertiesWithDefaultValues(ComplexType type)
    {
        return type.Properties.Where(p => p.TypeUsage.EdmType is SimpleType && p.DeclaringType == type && p.DefaultValue != null);
    }

    public IEnumerable<NavigationProperty> GetNavigationProperties(EntityType type)
    {
        return type.NavigationProperties.Where(np => np.DeclaringType == type);
    }

    public IEnumerable<NavigationProperty> GetCollectionNavigationProperties(EntityType type)
    {
        return type.NavigationProperties.Where(np => np.DeclaringType == type && np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many);
    }

    public FunctionParameter GetReturnParameter(EdmFunction edmFunction)
    {
        ArgumentNotNull(edmFunction, "edmFunction");

        var returnParamsProperty = edmFunction.GetType().GetProperty("ReturnParameters");
        return returnParamsProperty == null
            ? edmFunction.ReturnParameter
            : ((IEnumerable<FunctionParameter>)returnParamsProperty.GetValue(edmFunction, null)).FirstOrDefault();
    }

    public bool IsComposable(EdmFunction edmFunction)
    {
        ArgumentNotNull(edmFunction, "edmFunction");

        var isComposableProperty = edmFunction.GetType().GetProperty("IsComposableAttribute");
        return isComposableProperty != null && (bool)isComposableProperty.GetValue(edmFunction, null);
    }

    public IEnumerable<FunctionImportParameter> GetParameters(EdmFunction edmFunction)
    {
        return FunctionImportParameter.Create(edmFunction.Parameters, _code, _ef);
    }

    public TypeUsage GetReturnType(EdmFunction edmFunction)
    {
        var returnParam = GetReturnParameter(edmFunction);
        return returnParam == null ? null : _ef.GetElementType(returnParam.TypeUsage);
    }

    public bool GenerateMergeOptionFunction(EdmFunction edmFunction, bool includeMergeOption)
    {
        var returnType = GetReturnType(edmFunction);
        return !includeMergeOption && returnType != null && returnType.EdmType.BuiltInTypeKind == BuiltInTypeKind.EntityType;
    }
}

public static void ArgumentNotNull<T>(T arg, string name) where T : class
{
    if (arg == null)
    {
        throw new ArgumentNullException(name);
    }
}
#> 
```

# jsf - 有没有办法指定 ApplicationScoped 托管 bean 的初始化顺序？

> ID：14735481
> 
> 赞同：1
> 
> 时间：2013-02-06T17:45:48.683
> 
> 标签：jsf, jsf-2, tomcat7, managed-bean

我想知道，因为我遇到了`ApplicationScoped`托管 bean 和一个类的特殊行为

```
static {
    //some code that accesses an application bean
} 
```

其中扩展`ApplicationScoped`bean的部分

我将 JSF 2.1.17 与 Tomcat 7 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:57:21.517

这首先是糟糕的设计。应用程序范围的 bean 不是静态的，它们只是应用程序范围的。

将一个注入`@ManagedProperty`另一个，然后执行该工作`@PostConstruct`。

# java - 是否有与 GetCompressedFileSize 等效的 Java？

> ID：14735485
> 
> 赞同：2
> 
> 时间：2013-02-06T17:46:01.833
> 
> 标签：java, filesize, sparse-file, on-disk, compressed-files

我希望获得 Java 中稀疏文件的准确（即磁盘上的实际大小，而不是包含所有 0 的正常大小）测量值。

在 Windows 上的 C++ 中，人们会使用[`GetCompressedFileSize`](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getcompressedfilesizew). 我还没有遇到过如何在 Java 中做到这一点？

如果没有直接的等价物，我将如何测量稀疏文件中的数据，而不是包括所有零的大小？

为了澄清起见，我希望在 Linux 操作系统和 Windows 上运行稀疏文件测量，但是我不介意编写两个单独的应用程序！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:58:00.353

如果你是单独在 Windows 上做的，你可以用 Java Native Interface 来写

```
class NativeInterface{
   public static native long GetCompressedFileSize(String filename);
} 
```

在 C/C++ 文件中：

```
extern "C"
JNIEXPORT jlong JNICALL Java_NativeInterface_GetCompressedFileSize
  (JNIEnv *env, jobject obj, jstring javaString)
{
    const char *nativeString = env->GetStringUTFChars(javaString, 0);

    char buffer[512];
    strcpy(buffer, nativeString);
    env->ReleaseStringUTFChars(javaString, nativeString);
    return (jlong) GetCompressedFileSize(buffer, NULL);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-28T12:39:21.423

如果您想要一个纯 Java 解决方案，您可以尝试[jnr-posix](https://github.com/jnr/jnr-posix/)。这是一个[示例实现](https://stackoverflow.com/a/38045730/995714)

```
import jnr.posix.*;

final POSIX p = POSIXFactory.getPOSIX();
final int S_BLKSIZE = 512; // from sys/stat.h
final FileStat stat = p.stat("/path/to/file");
final long bytes = stat.blocks() * S_BLKSIZE; 
```

但是目前该功能[不适用于 Windows](https://github.com/jnr/jnr-posix/issues/120)。在修复之前，您必须使用特定于平台的代码，如下所示

*   在 Linux 上使用[`stat64`](https://linux.die.net/man/2/stat64)系统调用

    > st_blocks 字段表示分配给文件的块数，以 512 字节为单位。（当文件有洞时，这可能小于 st_size/512。）

    *   您也可以运行该[`stat`](https://linux.die.net/man/1/stat)命令。可以在字段中看到分配的块数，或使用格式说明符`Blocks`打印`%b`
    *   或使用[`du`命令](https://linux.die.net/man/1/du)（不带`--apparent-size`选项）

        > **--表观尺寸**
        > 
        > *   打印外观尺寸，而不是磁盘使用情况；尽管表观大小通常较小，但由于（“稀疏”）文件中的漏洞、内部碎片、间接块等原因，它可能会更大

*   在 Windows 上，您可以调用[`GetCompressedFileSize`](https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getcompressedfilesizea)API

    *   或者，您也可以`fsutil file layout`使用管理员权限运行以获取有关文件的详细信息。找到`$DATA`流。

        *   如果您看到*居民 | 在这样的标志中没有分配集群*，那么它是一个常驻文件，磁盘上的大小将为 0。

            ```
            PS C:\Users>  fsutil file layout .\desktop.ini

            ********* File 0x000800000003dbde *********
            File reference number   : 0x000800000003dbde
            File attributes         : 0x00000026: Hidden | System | Archive
            File entry flags        : 0x00000000
            Link (ParentID: Name)   : 0x001f0000000238c8: HLINK Name   : \Users\desktop.ini
            ...
            Stream                  : 0x080  ::$DATA
                Attributes          : 0x00000000: *NONE*
                Flags               : 0x0000000c: Resident | No clusters allocated
                Size                : 174
                Allocated Size      : 176 
            ```

        *   如果您没有看到 resident 标志，请检查*Allocated Size*字段，它是文件在磁盘上的大小

            ```
            PS D:\>  fsutil file layout .\nonresident.txt

            ********* File 0x000400000000084e *********
            File reference number   : 0x000400000000084e
            File attributes         : 0x00000020: Archive
            File entry flags        : 0x00000000
            Link (ParentID: Name)   : 0x0005000000000005: HLINK Name   : \nonresident.txt
            ...
            Stream                  : 0x080  ::$DATA
                Attributes          : 0x00000000: *NONE*
                Flags               : 0x00000000: *NONE*
                Size                : 1,520
                Allocated Size      : 4,096
                Extents             : 1 Extents
                                    : 1: VCN: 0 Clusters: 1 LCN: 1,497,204 
            ```

有关更多信息，您可以阅读以下问题

*   [如何查询“磁盘大小”文件信息？](https://stackoverflow.com/q/9903679/995714)
*   [获取磁盘上文件的大小](https://stackoverflow.com/q/3750590/995714)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:10:07.867

由于给出了 windows 的答案。我将尝试为 Linux 提供。

我不确定，但我认为它会成功（C++）：

```
#include <linux/fs.h>
ioctl(file, BLKGETSIZE64, &file_size_in_bytes); 
```

这可以按照@Aniket 答案 (JNI) 中描述的相同方式加载

# javascript - 在Javascript（Node.js）中对具有分层组的多维对象进行排序

> ID：14735487
> 
> 赞同：2
> 
> 时间：2013-02-06T17:46:09.457
> 
> 标签：javascript, node.js, sorting, reference, pass-by-reference

我有一个分层对象，我通过遍历父母并对孩子进行排序来对孩子进行排序。这行得通。但是现在，我需要选择性地打破层次结构并创建新的虚拟约束。

为了说明这一点，让我们举一个男人的例子，他有*x 个*妻子。每个妻子，他都有*y*个孩子。我可以为每个妻子或每个男人的妻子排序。

```
Man01   Wife01a     Kid01aA
                    Kid01aB
        Wife01b     Kid01bC
                    Kid01bD
Man02   Wife02c     Kid02cE
                    Kid02cF
        Wife02d     Kid02dG
                    Kid02dH 
```

让我们给他们起个名字：

```
Murphy  Winnie  Kurt
                Kara
        Wendy   Klaus
                Klea
Marley  Wonda   Kasper
                Kyra
        Wilma   Kevin
                Karla 
```

并考虑在他们的父母中按字母顺序对它们进行排序：

```
Marley  Wilma   Karla
                Kevin
        Wonda   Kasper
                Kyra
Murphy  Wendy   Klaus
                Klea
        Winnie  Kara
                Kurt 
```

但是现在，我们希望能够对属于男人的孩子、一般的妻子或一般的孩子进行排序？

```
Marley  Wilma   Karla
        Wonda   Kasper
        Wilma   Kevin
        Wonda   Kyra
Murphy  Winnie  Kara
        Wendy   Klaus
        Wendy   Klea
        Winnie  Kurt 
```

这是一个极其简化的虚构对象。实际上，我不是按字母顺序排序，而是对许多属性进行多列排序。

可以将结果输出到表格中，但处理本身已经占用了大量时间和内存。我不想让这进一步复杂化。

如果这没有问题，我只需将对象展平为数组中的表格，将每个多列排序链接到超级多列排序，然后从最近的共同祖先开始重新组合，该共同祖先通过循环保持不变。

但我试图以更有效的方式解决这个问题，而不是将对象转换为完整的表数组。

*   我该如何解决这个问题？实际上循环遍历它们中的每一个两次？
    *   对于这种我还不知道的排序，也许有一个“众所周知的”解决方案？
    *   也许可以使用所有“虚拟”父母的引用创建类似表的记录，然后将这些引用分组回层次结构而不循环它们？

这是我所指的对象类型的一个示例：`Object`我的意思是，字面意思是`{}`，尽管当对象具有多个成员时，它包含`[]`对象数组。`{}`

```
{
    "men"   : [
        {
            "name"  : "Murphy",
            // a lot of properties
            "wifes" : [
                {
                    "name"  : "Winnie",
                    // a lot of properties
                    "kids"  : [
                        {
                            "name"  : "Kurt",
                            // a lot of properties
                        }, {}, {} // etc...
                    ]
                }, {}, {} // etc...
            ]
        }, {}, {} // etc...
    ]
} 
```

请注意，在这种情况下，我的示例是错误的，因为 Man、Wife 和 Kid 都是人类。但实际上有不同的对象具有不同的属性。假设有多个宇宙，我应该选择宇宙、行星、土壤或其他东西。;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:32:46.820

> 我们希望能够对属于一个男人的孩子进行分类

然后我会这样安排它们：

```
Marley  Karla   Wilma   
        Kasper  Wonda
        Kevin   Wilma
        Kyra    Wonda
Murphy  Kara    Winnie
        Klaus   Wendy
        Klea    Wendy
        Kurt    Winnie 
```

当然，由于每个孩子只有一个母亲，因此没有太大差异，但对于您的实际数据，这可能会有所不同。

然而，您现在已经可以看到，您只需要对每个`kids`人的每个数组进行排序。

因此，一般来说，您应该先进行分组，然后再对组进行排序——有点像[桶排序](http://en.wikipedia.org/wiki/Bucket_sort)，而不是展平为一个大的表数组，多列排序，然后重新分组结果。

```
var men = data["men"];
men.forEach(function (man) {
    var kids = {};
    var wifes = man["wifes"];
    for (var i=0; i<wifes.length; i++) {
        var wkids = wifes[i]["kids"];
        for (j=0; j<wkids.length; j++) {
            var id = wkids[j]["name"];
            if (id in kids) {
                kids[id].mothers.push(wifes[i]);
            else {
                kids[id] = wkids[i];
                kids[id].mothers = [ wifes[i] ];
            }
        }
    }
    // if the id is the sort criteria:
    man["kids"] = Object.keys(kids).sort().map(function(id) {
        return kids[id];
    });
    // else build the array first and then sort it:
    // man["kids"] = Object.values(kids).sort(function(kida, kidb) {
    //    <some kid comparison>
    // });

    // you might integrate this loop in the above, but it's independent:
    man["kids"].forEach(function(kid) {
        kid["mothers"].sort( /* some mother comparison */ );
    })
});
// now every man has a sorted "kids" array with each kid having a sorted "mothers" array 
```

# ruby-on-rails - 使用带有 devise_invitable 的 rails 接受邀请后登录用户

> ID：14735489
> 
> 赞同：0
> 
> 时间：2013-02-06T17:46:14.660
> 
> 标签：ruby-on-rails, login, devise, devise-invitable

我将 devise_invitable 与 Rails 一起使用，需要一些帮助。我想让用户在接受邀请后登录。这是我的邀请控制器

```
class InvitationsController < Devise::InvitationsController
  def update
    if User.accept_invitation!(user_params)
      # log in user here
      redirect_to dashboard_show_path, notice: t('invitaion.accepted')
    else
      redirect_to root_path, error: t('invitation.not_accepted')
    end
  end

  private
  def user_params
    params.require(:user).permit(:invitation_token, :password, :password_confirmation)
  end
end 
```

您可以在代码中看到注释

```
# log in user here 
```

在这里，我想登录接受邀请的用户。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:51:43.310

您正在寻找的方法是`sign_in`，试试这个：

```
def update
  if User.accept_invitation!(user_params)
    sign_in(params[:user])
    redirect_to dashboard_show_path, notice: t('invitaion.accepted')
  else
    redirect_to root_path, error: t('invitation.not_accepted')
  end
end 
```

但是我应该注意，默认情况下，devise_invitable 会在用户接受邀请后登录用户。[请参阅此处](https://github.com/scambra/devise_invitable/blob/master/app/controllers/devise/invitations_controller.rb#L37)的默认更新操作，如果您希望使用默认功能，只需调用该`super`方法或根本不实现更新操作。

# tfs - Team Build 无法将诊断活动日志复制到放置位置

> ID：14735496
> 
> 赞同：1
> 
> 时间：2013-02-06T17:46:32.137
> 
> 标签：tfs, tfsbuild

我正在尝试配置 Team Foundation Server Express 的新安装。我遇到的问题是，当我运行输出到放置文件夹的构建时，我得到了错误

> 将诊断活动日志复制到放置位置时出错。详细信息：拒绝访问路径“\\c$\drops\Test Application\Test Application_20130206.9\Logs”。

如果我禁用放置文件夹，构建运行良好。

放置文件夹与 TFS 位于同一台计算机上。我已将该文件夹的完全控制权授予 NETWORK SERVICE 帐户。是否有任何其他帐户需要访问此文件夹或我需要采取任何其他步骤才能允许丢弃？

谢谢！

# java - AVRO avdl 文件生成

> ID：14735498
> 
> 赞同：3
> 
> 时间：2013-02-06T17:46:43.850
> 
> 标签：java, hadoop, avro

我将 Person 记录定义为 Avro IDL ( *person.avdl* )：

```
@namespace("net.tzolov.avro.extend")
protocol PersonProtocol {
    record Person {
        string firstName;
        string lastName;
    }     
} 
```

我正在生成 java 文件，所以这个正在生成 PersonProtocol.java 和 Person.java。PersonProtocol.java 是空文件，有没有办法可以排除生成此文件...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-08T12:49:30.757

您不能排除此文件的生成，因为 Avro IDL 定义了一个**协议（**[在此处](http://avro.apache.org/docs/1.4.0/idl.html)查看更多信息）。

您的*PersonProtocol.java*是空的，因为您不使用提供 Avro IDL 语言的 RPC。

例如：

```
@namespace("net.tzolov.avro.extend")
protocol PersonProtocol {
 record Person {
    string firstName;
    string lastName;
 }

 string printMessage(string theMessage);    
} 
```

通过使用代码生成，您将获得定义 RPC 方法的特定行：

```
void printMessage(java.lang.CharSequence theMessage, org.apache.avro.ipc.Callback<java.lang.CharSequence> callback) throws java.io.IOException; 
```

如果你只是想存储数据，你应该使用 avro schema (avsc)。

# java - 我应该使用什么作为 Java 中同步语句的锁定对象

> ID：14735500
> 
> 赞同：4
> 
> 时间：2013-02-06T17:46:45.960
> 
> 标签：java, object, synchronization

谁能解释这些例子之间有什么区别？

**示例#1。**

```
public class Main {

    private Object lock = new Object();
    private MyClass myClass = new MyClass();

    public void testMethod() {
        // TODO Auto-generated method stub
        synchronized (myClass) {
            // TODO: modify myClass variable
        }
    }

} 
```

**示例#2。**

```
package com.test;

public class Main {

    private MyClass myClass = new MyClass();
    private Object lock = new Object();

    public void testMethod() {
        // TODO Auto-generated method stub

        synchronized (lock) {
            // TODO: modify myClass variable
        }
    }

} 
```

如果在修改变量时需要注意同步，我应该使用什么作为监视器锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:54:43.117

假设这`Main`不是“泄漏抽象”，这里是第一个和第二个示例之间的最小差异。

使用 an`Object`而不是其他类可能会更好，因为`Object`实例没有字段，因此更小。`Object`-as-lock 习惯用法清楚地表明该变量`lock`仅用作锁。

话虽如此，锁定一个其他任何人都看不到的对象具有明显的优势。在（例如）`Main`上同步的方法的问题是其他不相关的代码也可能出于不相关的目的而在其上同步。通过在专用（私有）锁定对象上同步，您可以避免这种可能性。`Main``this`

* * *

回应评论：

> 这两种情况有很大的不同。首先，您要锁定要操作的对象。在第二个中，您锁定了一些与被操作对象没有明显关系的其他对象。第二种情况占用更多空间，因为您必须分配（否则未使用的）对象，而不是使用您正在保护的已经存在的实例。

我认为您做出了一个错误的假设——这`MyClass`是需要保护的数据结构。事实上，问题并没有这么说。事实上，这个例子的写法意味着锁的目的是保护整个`Main`类......而不仅仅是它的一部分状态。在这种情况下，有一个明显的联系......

唯一最好锁定的`MyClass`情况是，如果`Main`是一个泄漏的抽象，它允许其他代码获取它的`myClass`引用。那将是糟糕的设计，尤其是在多线程应用程序中。

根据修订历史，我很确定这不是 OP 的意图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T17:57:58.850

更改对象的变量时，语句同步很有用。

您正在更改变量，`myClass`因此您想锁定`myClass`对象。如果要更改某些内容，`lock`则要锁定`lock`对象。

在示例 #2 中，您正在修改`myClass`但锁定`lock`对象，这是无意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:49:58.297

在第一种情况下，您锁定了仅在此方法中已知的对象，因此其他人不太可能使用相同的对象来锁定，因此这种锁定几乎没有用。第二种变体对我来说更有意义。

同时，myClass 变量也只有在这个方法中是已知的，所以其他线程不太可能访问它，所以这里可能根本不需要锁。需要更完整的例子才能说得更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T17:57:05.347

不同之处在于锁的类别及其范围——这两个主题与同步几乎是正交的

*   不同类的对象可能有不同的大小

*   不同范围的对象可能在不同的上下文中可用

基本上两者在同步方面的行为相同

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T18:08:11.773

通常，您希望锁定您正在操作的数据的“根”对象。例如，如果您要从对象 A 中的字段中减去一个值并将该值添加到对象 B，您需要锁定一些在 A 和 B 之间以某种方式通用（至少按照惯例）的对象，可能是“所有者”两者的对象。这是因为您正在执行锁定以维持单独数据之间的一致性“契约”——锁定的对象必须是通用的，并且在概念上包含必须保持一致的整个数据集。

当然，最简单的情况是当您在同一个对象中修改字段 A 和字段 B 时，在这种情况下锁定该对象是显而易见的选择。

不太明显的是当您处理属于单个类的静态数据时。在这种情况下，您通常希望锁定课程。

在 Java 中很少需要单独的“监视器”对象（仅作为可锁定实体创建），但可能适用于两个并行数组的元素，您希望在其中保持两个数组的元素 N 之间的一致性. 在这种情况下，类似第三个监视器对象数组可能是合适的。

（请注意，这只是制定一些规则的“快速技巧”。人们可能会遇到许多微妙之处，尤其是在尝试允许最大程度地并发访问大量访问的数据时。但这种情况在外部很少见高性能计算。）

无论您选择什么，选择在所有对受保护数据的引用中*保持一致至关重要。*当引用/修改相同的数据时，您不想在一种情况下锁定对象 A 而在另一种情况下锁定对象 B。（并且请不要陷入认为您可以锁定 A 类的任意实例并且会以某种方式锁定 A 类的另一个实例的陷阱。这是一个经典的初学者错误。）

在上面的示例中，您通常希望锁定创建的对象，假设您确保的一致性是该对象的内部。但请注意，在这个特定示例中，除非 MyClass 的构造函数以某种方式让对象地址“逃逸”，否则根本不需要锁定，因为另一个线程无法获取新对象的地址。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T17:57:47.187

这两个例子都不是很好的同步实践。`lock Object`应该`MyClass`作为私有字段放置。

# ruby-on-rails-3 - 测试电子邮件在黄瓜中发送

> ID：14735501
> 
> 赞同：5
> 
> 时间：2013-02-06T17:46:54.357
> 
> 标签：ruby-on-rails-3, email, cucumber, actionmailer

我在 Cucumber 中有一个分配给我的故事列表，其中一个是“然后用户应该收到一封确认电子邮件”。我认为测试用户是否收到它超出了应用程序的能力，但我如何测试一封电子邮件是否刚刚发送？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T00:50:22.150

您可以使用此步骤定义：

```
Then "the user should receive a confirmation email" do
  # this will get the first email, so we can check the email headers and body.
  email = ActionMailer::Base.deliveries.first
  email.from.should == "admin@example.com"
  email.to.should == @user.email
  email.body.should include("some key word or something....")
end 
```

使用 Rails 3.2 测试

[资源](http://davidangga.wordpress.com/2010/02/01/testing-action-mailer-with-cucumber/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-15T10:13:48.980

[email_spec](https://github.com/bmabey/email-spec) + [action_mailer_cache_delivery](https://github.com/p0deje/action_mailer_cache_delivery) gems 是你这样做的朋友

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T08:37:43.217

检查[造船厂/水豚电子邮件](https://github.com/dockyard/capybara-email)gem：

```
feature 'Emailer' do
  background do
    # will clear the message queue
    clear_emails
    visit email_trigger_path
    # Will find an email sent to test@example.com
    # and set `current_email`
    open_email('test@example.com')
  end

  scenario 'following a link' do
    current_email.click_link 'your profile'
    expect(page).to have_content 'Profile page'
  end

  scenario 'testing for content' do
    expect(current_email).to have_content 'Hello Joe!'
  end

  scenario 'testing for a custom header' do
    expect(current_email.headers).to include 'header-key'
  end

  scenario 'testing for a custom header value' do
    expect(current_email.header('header-key')).to eq 'header_value'
  end

  scenario 'view the email body in your browser' do
    # the `launchy` gem is required
    current_email.save_and_open
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T18:24:52.707

我建议您`last_response`在某些操作发生后进行验证，例如用户单击按钮或类似的操作。

或者，如果您在执行某项操作后更新记录，请检查`updated_at`属性以查看它是否已更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-06T12:14:39.573

另一种选择是[PutsBox](http://putsbox.com)。您可以发送电子邮件到whatever-you-want@putsbox.com，等待几秒钟（SMTP 内容不是即时的），然后通过[http://preview.putsbox.com/p/whatever-you-检查您的电子邮件想要/最后](http://preview.putsbox.com/p/whatever-you-want/last)。

这个[帖子教程](http://www.pablocantero.com/blog/2015/08/05/test-emails-with-automated-testing-tools/)有一些例子。

# excel - 向下拖动并更改公式的值

> ID：14735502
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:46:54.817
> 
> 标签：excel, drag, excel-formula

我有这个公式：

**=IF(INDIRECT("summary!a2")="","",INDIRECT("summary!a2"))**

.. 这将检索摘要表中 a2 单元格的值。

我想知道的是我可以在这个公式上做什么以允许值 a2 更改为 a3/a4/a5 等。当向下拖动工作表时。

有人可以在这里给我一个提示吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:54:55.417

尝试：`=IF(INDIRECT("summary!a"&ROW(A2))="","",INDIRECT("summary!a"&ROW(A2)))`- 适用于下拉）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:36:10.477

如果您使用 CELL 功能，您还可以向下拖动，例如

`=INDIRECT("Sheet2!"&CELL("address",A1))`

# webforms - 使用“Tab”或“Enter”从 Ajax AutoCompleteExtender 获取值

> ID：14735506
> 
> 赞同：3
> 
> 时间：2013-02-06T17:47:10.017
> 
> 标签：webforms, ajaxcontroltoolkit, asp.net-4.0, autocompleteextender

我有一个设置，用户可以在其中将邮政编码输入到 ASP.NET`TextBox`控件中，并且我有一个`AutoCompleteExtender`来自 Ajax Control Toolkit 的附加到该文本框。它从 ASPX 页面上的静态页面方法获取数据。

当用户开始输入瑞士邮政编码时，例如`3`，然后稍等片刻，就会出现一个匹配的邮政编码列表 - 类似于：

```
3000 - Bern
3001 - Bern 
```

等等。奇迹般有效。

选择显示的选项之一的*正常*方法是将鼠标指针移动到列表并选择您想要的，单击它或按`Enter`，然后将邮政编码放入该文本框（然后将城市名称放入第二个文本框）给它）。

现在，我从项目经理那里得到了一些额外的要求：

1.  我们希望能够在`Enter` **不**进入选项列表的情况下直接按下以选择一个 - 他只想将显示的第一个（或经常：唯一）条目放入这两个文本框...

2.  我们希望能够输入一个有效的 4 位邮政编码，然后只需按下`Tab`并移出邮政编码的文本框，并选择并“选择”具有该邮政编码的第一个（可能是唯一的）条目（并填充进入两个文本框）。

对我来说似乎是一项艰巨的任务（我*根本不是*一个伟大的 Javascript 大师......） - 有什么想法吗？

这是我的 ASP.NET 页面（在标准 ASP.NET 4.0 webforms 示例应用程序中 - 带有母版页；*脚本已简化；实际上，我`3001 - Bern`在破折号处拆分文本并将第一部分粘贴到 zip代码和第二部分进入城市文本框*）：

```
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <script type="text/javascript">
        function IAmSelected(source, eventArgs) {
            $get('tbxCity').value = eventArgs.get_value();
        }
    </script>
    <asp:ScriptManager runat="server" EnablePageMethods="True" />

    <asp:Literal runat="server" ID="litPrompt" Text="Please enter zip code: " />
    <asp:TextBox runat="server" ID="tbxZipcode" MaxLength="10" />
    <act:AutoCompleteExtender runat="server" ID="acZipCode" TargetControlID="tbxZipcode" MinimumPrefixLength="1" 
                              CompletionInterval="25" ServiceMethod="GetMatchingZipCodes" CompletionSetCount="15"
                              OnClientItemSelected="IAmSelected" />
    <asp:TextBox runat="server" ID="tbxCity" MaxLength="50"  />
</asp:Content> 
```

和我的代码隐藏（*这也被简化了 - 当然，实际上，我从实体框架数据模型中获取这些数据*）：

```
[WebMethod]
[ScriptMethod]
public static string[] GetMatchingZipCodes(string prefixText, int count)
{
   return new string[] { "3000 - Bern", "3001 - Bern", "4000 - Basel", "6000 - Lucerne", "6001 - Lucerne" };
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T09:28:28.897

检查`FirstRowSelected`AutoCompleteExtender 的属性。从您的要求看来，这正是您所需要的。

# bash - 以块而不是逐行读取文件？

> ID：14735510
> 
> 赞同：1
> 
> 时间：2013-02-06T17:47:15.057
> 
> 标签：bash

我有一个如下所示的文本文件：

```
[1] Header information Timestamp Text begins
Text continues
Text continues
Text continues

[2] Header information Timestamp Text begins
Text continues
Text continues

[3] Header information Timestamp Text begins
Text continues
Text continues
Text continues 
```

我想读入该文件，并单独处理每个条目（它们在 1 到 20 或 30 行之间）。

有没有办法使用空行作为分隔符来循环文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:51:22.013

答案是肯定的！

`awk -vRS="" '...'`将空白行视为行拆分器。

以你的例子和测试：

```
kent$  cat b.txt
[1] Header information Timestamp Text begins
Text continues
Text continues
Text continues

[2] Header information Timestamp Text begins
Text continues
Text continues

[3] Header information Timestamp Text begins
Text continues
Text continues
Text continues

kent$  awk -vRS="" '{print "==== new block here ===="}1' b.txt  
==== new block here ====
[1] Header information Timestamp Text begins
Text continues
Text continues
Text continues
==== new block here ====
[2] Header information Timestamp Text begins
Text continues
Text continues
==== new block here ====
[3] Header information Timestamp Text begins
Text continues
Text continues
Text continues 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:24:35.347

这是一个纯粹的`bash`解决方案：

```
{
    read -r block    # First line only
    while read -r; do
        if [[ $REPLY =~ ^$ ]]; then
            # Do what you like with the contents 
            # $block here, then ...
            block=""
        else
            block+="$REPLY"
        fi
    done
 } < file.txt 
```

# linux - 使用前一个 grep 的结果进行 grepping

> ID：14735511
> 
> 赞同：21
> 
> 时间：2013-02-06T17:47:19.503
> 
> 标签：linux, grep

有没有办法根据前一个 grep 的结果执行 grep，而不仅仅是将多个 grep 相互传递。例如，假设我有以下日志文​​件输出：

```
ID 1000 xyz occured
ID 1001 misc content
ID 1000 misc content
ID 1000 status code: 26348931276572174
ID 1000 misc content
ID 1001 misc content 
```

首先，我想 grep 整个日志文件文件，看看是否存在“xyz 发生”。如果是，我想获取该事件的 ID 号，并通过 grep 遍历文件中具有该 ID 号的所有行来查找状态代码。

我想象我可以使用 xargs 或类似的东西，但我似乎无法让它工作。

```
grep "xyz occured" file.log | awk '{ print $2 }' | xargs grep "status code" | awk '{print $NF}' 
```

关于如何实际执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-09-08T14:54:19.997

A general answer for grep-ing the grep-ed output:

```
grep 'patten1' *.txt | grep 'pattern2' 
```

notice that the second grep is not pointing at a file.

More about cool grep stuff [here](http://www.thegeekstuff.com/2011/10/grep-or-and-not-operators/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-06T17:57:47.623

您快到了。但是，虽然 xargs 有时可以用来做你想做的事（取决于下一个命令如何接受它的参数），但你实际上并没有使用它来 grep 你刚刚提取的 ID。您需要做的是获取第一个 grep 的输出（包含 ID 代码）并在下一个 grep 的表达式中使用它。就像是：

```
grep "^ID `grep 'xyz occured' file.log | awk '{print $2}'` status code" file.log 
```

显然，另一种选择是编写一个脚本一次性完成此操作，a-la Ed 的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T17:57:04.947

**Grep 上一次 Grep 的结果：**

鉴于此文件内容：

```
ID 1000 xyz occured
ID 1001 misc content
ID 1000 misc content
ID 1000 status code: 26348931276572174
ID 1000 misc content
ID 1001 misc content 
```

这个命令：

```
grep "xyz" file.log | awk '{ print $2 }' > f.log; grep `cat f.log` file.log; 
```

返回这个：

```
ID 1000 xyz occured
ID 1000 misc content
ID 1000 status code: 26348931276572174
ID 1000 misc content 
```

它在 file.log 中查找“xyz”，将结果放在 f.log 中。然后在 file.log 中用 greps 查找该 ID。如果外部 grep 返回多个 ID 号，则内部 grep 将仅搜索第一个 ID 号并在其他 ID 号上出错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-12T04:04:18.963

还有一种方式

```
for x in `grep "xyz occured" file.log | cut -d\  -f2`
do
  grep $x file.log
done 
```

我喜欢这种方法的一点是，如果您愿意，您可以将每个状态代码的输出写入文件。

```
grep $x file.log >> /var/tmp/$x.out 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T17:51:52.777

只需使用 awk：

```
awk '{info[$2] = info[$2] $0 ORS} /xyz occured/{ids[$2]} END{ for (id in ids) printf "%s",info[id]}' file.log 
```

或者：

```
awk '/status code/{code[$2]=$NF} /xyz occured/{ids[$2]} END{ for (id in ids) print code[id]}' file.log 
```

取决于您真正想要输出的内容。您问题中的一些预期输出会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-20T11:55:23.180

这都是关于在缩小的搜索范围内检索文件。在您的情况下，搜索范围由文件内容确定。

我在通过许多搜索（将过滤器应用于以前的 grep 结果）缩小搜索范围时更经常地发现了这个问题。

**试图找到一般答案**：

1) 使用第一个 grep 的结果生成一个列表：

```
grep pattern | awk -F':' '{print $1}' 
```

2）第二个 grep 进入像[这里这样的文件列表](https://unix.stackexchange.com/questions/178857/grep-files-from-list)

```
xargs grep -i pattern 
```

3) 应用此级联过滤器，您只需添加 awk 即可仅获取文件名并将`xargs`文件名传递给 `grep -i`

例如：

```
grep 'pattern1' | awk -F':' '{print $1}' | xargs grep -i 'pattern2' 
```

# visual-studio-2010 - Visual Studio 2010 和 Clickonce：旧的 .NET 和 office 先决条件

> ID：14735513
> 
> 赞同：1
> 
> 时间：2013-02-06T17:47:25.907
> 
> 标签：visual-studio-2010, deployment, ms-office, clickonce

我目前正在用 Visual Basic 准备一个应用程序，主要针对安装了 .NET 2 和 office 2003 的系统。

此外，由于系统是公司系统，它们需要管理权限，所以我想到了一个不需要安装任何东西（或注册）的应用程序。

该应用程序使用外部 ocx、axwebbrowser ocx 和 excel 互操作。

第一个问题是因为用户无法运行应用程序，因为它崩溃了，似乎是因为在他的系统上找不到 ahdocvw.dll。有没有办法安装例如包含 axwebbrowser 系统 xomponent 的重新分发包？至少将其附加到 clickonce 设置中。

其次，如果用户没有所需的框架，我想在 Clickonce 先决条件框上添加 .NET 2 和 Office 2003 的选项。目前，VS 2010 仅提供 .NET 3.5+ 和 Office Pia 2007....你能建议我如何进行吗？

# c# - 防止对非托管代码中使用的托管引用进行垃圾收集

> ID：14735520
> 
> 赞同：10
> 
> 时间：2013-02-06T17:47:54.113
> 
> 标签：c#, garbage-collection, c++-cli, wrapper

我的 C# 应用程序使用封装的 C++ 代码进行计算。

C++ 头文件：

```
__declspec(dllexport) void SetVolume(BYTE* data, unsigned int width); 
```

C++/CLI 包装器：

```
void SetVolume(array<Byte>^ data, UInt32 width) 
{
    cli::pin_ptr<BYTE> pdata = &data[0];
    pal->SetVolume(pdata, width); 
} 
```

C＃ ：

```
public startCalc()
{
    byte[] voxelArr = File.ReadAllBytes("Filtered.rec");
    palw.SetVolume(voxelArr, 490);
    //GC.KeepAlive(voxelArr); makes no sense
} 
```

C++`SetVolume`函数启动**异步**计算。`voxelArr`不再从托管端引用，并且被垃圾收集。

`voxelArr`在非托管代码完成工作而不声明为全局变量之前，如何防止此引用的垃圾收集？创建数组的副本不是一种选择，因为确实有很多数据。里面的主动等待`startCalc()`也不好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-06T17:50:33.873

您可以使用手动固定阵列，这样 GC 就不会移动或清理它。[`GCHandle.Alloc`](http://msdn.microsoft.com/en-us/library/1246yz8f.aspx)`(voxelArr,`[`GCHandleType.Pinned`](http://msdn.microsoft.com/en-us/library/83y4ak54.aspx)`)`

然后，当您知道方法已完成时，您必须[释放](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.free.aspx)句柄，这需要某种形式的回调才能完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:15:50.667

您当前方法的另一种选择：

考虑再次使数组全局化，在开始时创建并固定一次，然后在需要时重用它。像这些一样大的对象不应该一时兴起，[将它们汇集起来](http://en.wikipedia.org/wiki/Object_pool_pattern)。仅当您需要使用更大尺寸重新创建它时才取消固定并释放它

将对象存储在全局池中将防止它被垃圾收集。严格来说，您不必担心固定这么大的对象，但这样做是为了保持一致性

# java - 当我想要简单的持久性时，是否需要从 2.6 降级到 EhCache 2.5？

> ID：14735521
> 
> 赞同：1
> 
> 时间：2013-02-06T17:47:56.327
> 
> 标签：java, caching, ehcache

我有 EhCache 2.6。现在我想启用持久性（例如重新启动后重用缓存）。但我注意到我不能使用 2.6 - 见[这里](http://ehcache.org/documentation/configuration/fast-restart#compatibility-with-previous-versions)

所以我需要兵马俑的“分布式”持久性（不是我们希望保持简单的选项）或使用企业版。为了使用简单的持久性，我真的需要降级到 2.5 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:51:19.370

您的问题有点令人困惑，但链接很清楚旧行为仍然可用。

> 但是，升级后，不必添加子元素。在 Ehcache 2.6 中，来自先前 Ehcache 版本的磁盘持久性配置元素将继续具有相同的功能，只要未指定子元素。

# ios - 我可以在包中嵌入自定义字体并从 ios 框架访问它吗？

> ID：14735522
> 
> 赞同：29
> 
> 时间：2013-02-06T17:47:58.480
> 
> 标签：ios, objective-c, frameworks, bundle

我正在创建一个带有用于打包资源（笔尖、图像、字体）的**包的 ios****框架**，并且我正在尝试在包中嵌入**自定义字体**，但我无法从框架中加载它，这可能吗？

 ****1）我可以用这个本地化字体文件： `objc NSString *fontPath = [[NSBundle frameworkBundle] pathForResource:@"MyCustomFont" ofType:@"ttf"];` 2）但我无法在我的字体列表中获取它： `objc NSArray * array = [UIFont familyNames];` 我将我的字体名称包含在包的 plist 中，并带有“应用程序提供的字体”，但没有成功，也在app info plist，将其包含在框架资源中但没有成功。

我可以从包中加载笔尖和图像（通过以包名称为前缀），但不能加载字体。任何想法 ？

**编辑：**我看到以下帖子：[我可以在 iPhone 应用程序中嵌入自定义字体吗？](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application)，但问题只是“我可以在 iPhone 应用程序中嵌入自定义字体吗？” 不是“我可以在外部框架/包中嵌入自定义字体吗？” 它还引用了一个有趣的动态加载，但它使用的是私有 api，这对于框架来说不是可用的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-11-22T18:47:08.340

斯威夫特 3：

首先，不要从 main 访问带有附加路径组件的框架包......从它的标识符实例化它。您可以像这样获取字体 URL：

```
static func fontsURLs() -> [URL] {
    let bundle = Bundle(identifier: "com.company.project.framework")!
    let fileNames = ["Roboto-Bold", "Roboto-Italic", "Roboto-Regular"]
    return fileNames.map({ bundle.url(forResource: $0, withExtension: "ttf")! })
} 
```

而且我发现有`UIFont`注册字体的扩展名很好：

```
public extension UIFont {
    public static func register(from url: URL) throws {
        guard let fontDataProvider = CGDataProvider(url: url as CFURL) else {
            throw SVError.internal("Could not create font data provider for \(url).")
        }
        let font = CGFont(fontDataProvider)
        var error: Unmanaged<CFError>?
        guard CTFontManagerRegisterGraphicsFont(font, &error) else {
            throw error!.takeUnretainedValue()
        }
    }
} 
```

现在享受注册：

```
do {
    try fontsURLs().forEach({ try UIFont.register(from: $0) })
} catch {
    print(error)
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-19T20:56:10.460

这是一种新方法，可让您动态加载字体而无需将它们放入 Info.plist： http: [//www.marco.org/2012/12/21/ios-dynamic-font-loading](http://www.marco.org/2012/12/21/ios-dynamic-font-loading)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-03-20T10:35:11.260

这是我根据“David M”提供的解决方案为我的 fmk 实现它的方式。此解决方案不需要在 plist 中添加对字体的引用。

1）加载字体的类

```
- (void) loadMyCustomFont{
    NSString *fontPath = [[NSBundle frameworkBundle] pathForResource:@"MyFontFileNameWithoutExtension" ofType:@"ttf"];
    NSData *inData = [NSData dataWithContentsOfFile:fontPath];
    CFErrorRef error;
    CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)inData);
    CGFontRef font = CGFontCreateWithDataProvider(provider);
    if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
        CFStringRef errorDescription = CFErrorCopyDescription(error);
        NSLog(@"Failed to load font: %@", errorDescription);
        CFRelease(errorDescription);
    }
    CFRelease(font);
    CFRelease(provider);
} 
```

2) NSBundle 上的类别以访问我的包

```
+ (NSBundle *)frameworkBundle {
    static NSBundle* frameworkBundle = nil;
    static dispatch_once_t predicate;
    dispatch_once(&predicate, ^{
        NSString* mainBundlePath = [[NSBundle mainBundle] resourcePath];
        NSString* frameworkBundlePath = [mainBundlePath stringByAppendingPathComponent:@"MyBundleName.bundle"];
        frameworkBundle = [NSBundle bundleWithPath:frameworkBundlePath];
    });
    return frameworkBundle;
} 
```

注意：需要在你的项目中集成 CoreText

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-10-16T16:53:21.853

迅速，我使用下面的代码：

```
public class func loadMyCustomFont(name:String) -> Bool{
  let fontPath = self.frameworkBundle().pathForResource(name, ofType: "ttf")!
  let inData = NSData(contentsOfFile:fontPath)
  var error: Unmanaged<CFError>?
  let provider = CGDataProviderCreateWithCFData(inData)
  if let font = CGFontCreateWithDataProvider(provider) {
     CTFontManagerRegisterGraphicsFont(font, &error)
     if error != nil {
       print(error) //Or logged it
       return false
     }

      }
       return true
   } 
```

frameworkBundle 方法：

```
class func frameworkBundle() -> NSBundle{
       var bundle = NSBundle()
       var predicate = dispatch_once_t()
       dispatch_once(&predicate) {
          let mainBundlePath = NSBundle.mainBundle().bundlePath
          let frameworkBundlePath = mainBundlePath.stringByAppendingString("/myFramework.framework/")
          bundle = NSBundle(path: frameworkBundlePath)!
       }
       return bundle
 } 
```

调用示例：（在我的情况下，我在**Fonts**文件夹中添加了所有字体）

```
YouClassName.loadMyCustomFont("Fonts/Roboto-Regular") 
```

**欢迎您的指正和评论！**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-16T15:18:23.647

如果您在文件/包中有字体，则可以使用此扩展名。

```
public extension UIFont {

    static func register(from url: URL) throws {
        if !FileManager.default.fileExists(atPath: url.path) {
            throw VError.incorrectFont
        }

        var error: Unmanaged<CFError>?

        guard CTFontManagerRegisterFontsForURL(url as CFURL, .process, &error) else {
            throw error!.takeUnretainedValue()
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-18T13:48:36.887

为 Swift 4/5 更新并更改为抛出错误而不是返回 Bool。

```
enum FontLoadingError: Error {
    case fileNotFound
    case unreadableFontData
}

func loadCustomFont(name: String) throws {
    guard let fontURL = frameworkBundle.url(forResource: name, withExtension: "ttf") else {
        throw FontLoadingError.fileNotFound
    }

    guard
        let provider = CGDataProvider(url: fontURL as CFURL),
        let font = CGFont(provider)
    else {
        throw FontLoadingError.unreadableFontData
    }

    var cfError: Unmanaged<CFError>?
    CTFontManagerRegisterGraphicsFont(font, &cfError)

    if let error = cfError as? Error {
        throw error
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-17T18:05:20.097

@Ali-ABBAS 答案的 Swift 3 版本，也更新为向上包装选项，而不是强制展开。

```
fileprivate func loadCustomFont(name:String) -> Bool{

    guard let fontPath = frameworkBundle.path(forResource: name, ofType: "ttf") else {
        return false
    }

    guard let inData = NSData(contentsOfFile:fontPath) else {
        return false
    }

    guard let provider = CGDataProvider(data: inData) else {
        return false
    }

    let font = CGFont(provider)
    var error: Unmanaged<CFError>?
    CTFontManagerRegisterGraphicsFont(font, &error)
    guard error == nil else {
        print(error) //Or logged it
        return false
    }

    return true
} 
```****

# spam - 垃圾邮件档案中垃圾邮件的文本分析

> ID：14735524
> 
> 赞同：0
> 
> 时间：2013-02-06T17:48:07.087
> 
> 标签：spam, spam-prevention, text-analysis

我尝试使用概率方法实现反垃圾邮件引擎。第一步是分析和研究垃圾邮件中单词的类型及其频率。所以我用Java写了一个非常简单的程序来过滤垃圾邮件中的单词。我使用 "split("\W")" （\W 表示空格）将整个文本文件分成几行和几行。

我下载了垃圾邮件档案，并认为我可以使用此应用程序轻松分析或扫描这些 txt 文件。但是很快，我就遇到了一个大问题！文本文件包含 HTML 标签、链接、电子邮件标题、等等等等……

现在我想知道如何解决这个问题？我应该使用 html 解析器还是加强分析这些文件的逻辑？

答案主要看我在实施阶段会不会遇到同样的问题？当前的垃圾邮件过滤器有什么作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-28T02:22:18.243

邮件信封是标准的，虽然是电子邮件的不可见部分。如果没有这些标头，邮件将无法到达您的手中。当标准库完成这项工作时，无需自己编写解析逻辑。

```
from email import message_from_string
mailfd = open("mfile_path_to_message").read()
message = message_from_string(mailfd)
print message.get("from") 
```

如果您的邮件是 unix mbox 格式，[邮箱](https://docs.python.org/2/library/mailbox.html)库会很有帮助。对于解析 HTML 等富文本，[BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/bs4/doc/)是更好的选择。

# php - 如何使用 Zend Framework 使用 DATE_FORMAT 编写此查询？

> ID：14735531
> 
> 赞同：0
> 
> 时间：2013-02-06T17:48:35.480
> 
> 标签：php, zend-framework, zend-db-table

基本上，我想要一个新闻页面，其中包含基于月份和年份的侧列中的存档列表。例如 2012 年 6 月。该表名为“新闻”，包含 news_id、news_title、news_entry、updated、created 列。更新和创建的是时间戳。现在我正在使用普通的php，如下所示：

```
mysql_select_db($database_admin_conn, $admin_conn);
$query_getArchives = "SELECT DISTINCT DATE_FORMAT (news.updated, '%M %Y') AS archive, DATE_FORMAT (news.updated, '%Y-%m') AS link FROM news ORDER BY news.updated DESC";
$getArchives = mysql_query($query_getArchives, $admin_conn) or die(mysql_error());
$row_getArchives = mysql_fetch_assoc($getArchives);
$totalRows_getArchives = mysql_num_rows($getArchives); 
```

显示档案栏的代码如下：

```
<h3>News Archives</h3>
<ul>
<?php do { ?>
<li class="seperator
<?php echo (isset($_GET['archive']) && $_GET['archive'] == $row_getArchives['link'] ? 'currentItem' : '') ?>">
<a href="news.php?archive=<?php echo $row_getArchives['link']; ?>"><?php echo $row_getArchives['archive']; ?></a>
</li>
<?php } while ($row_getArchives = mysql_fetch_assoc($getArchives)); ?>
</ul> 
```

如何在 Zend Framework 的第一个代码块中实现 select 语句，以达到与当前代码输出相同的结果？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:28:02.987

首先将表类创建到*/models/DbTable/Archive.php*或使用 zf 命令工具。

```
class Application_Model_DbTable_Archive extends Zend_Db_Table_Abstract
{
    protected $_name = 'news'; // actual table name here
} 
```

然后使用下面的代码

```
$table = new Application_Model_DbTable_Archive();

$select = $table->getAdapter()->select()
            ->from(array('news' => $table->info(Zend_Db_Table::NAME)), 
                array(
                    'archive'=>new Zend_Db_Expr('DISTINCT DATE_FORMAT (news.updated, \'%M %Y\')'), 
                    'link'=>new Zend_Db_Expr('DISTINCT DATE_FORMAT (news.updated, \'%Y-%m\')')))
            ->order('news.updated DESC');
// then use $select
$row_getArchives = $table->fetchAll($select);
$totalRows_getArchives  = $row_getArchives ->count(); 
```

和视图

```
foreach($row_getArchives as $row){
    echo $row->link;
} 
```

* * *

如果你不想使用表类，试试这个：

```
$adapter = Zend_Db_Table::getDefaultAdapter();
$select = $adapter->select()
        ->from(array('news' => 'news'), 
            array(
                'archive'=>new Zend_Db_Expr('DISTINCT DATE_FORMAT (news.updated, \'%M %Y\')'), 
                'link'=>new Zend_Db_Expr('DISTINCT DATE_FORMAT (news.updated, \'%Y-%m\')')))
        ->order('news.updated DESC');
// then use $select
$row_getArchives = $adapter->fetchAll($select);
$totalRows_getArchives  = count($row_getArchives); 
```

和视图

```
foreach($row_getArchives as $row){
    echo $row['link'];
} 
```

# java - Xtend/Xpand find and replace (rule)

> ID：14735533
> 
> 赞同：0
> 
> 时间：2013-02-06T17:48:36.833
> 
> 标签：java, loops, xtext, xtend, xpand

Is it possible set a rule that will allow an Xpand method to output a specified string of text depending on the input. For example:

```
«FOR a:e.attributes»
 Type = «a.eClass.name»
 Value = «a.name.toFirstUpper»

«ENDFOR» 
```

The above code may output:

```
Type = StringAttribute
Value = String1

Type = IntegerAttribute
Value = 123 
```

How would I make this output:

```
Type = String
Value = String1

Type = int
Value = 123 
```

I know this can be done with if statements but I would like to be able it to be more or less automatic. It would be a waste to have to specify such rules every time I need to output these details in the same file. Could someone show me what kind of code I could use to achieve this? Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:42:39.400

I suggest that you create a reusable [Xtend](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.xpand.doc/help/ch01s05.html) helper

```
toSimpleName(String inp):
    switch (inp) {
        case "StringAttribute"  : "String"
        case "IntegerAttribute" : "int"
        // ...more cases here...
        default                 : inp
    }
; 
```

and then call it from your Xpand template like this:

```
«FOR a:e.attributes»
 Type = «a.eClass.name.toSimpleName()»
 Value = «a.name.toFirstUpper»

«ENDFOR» 
```

# c# - 我无法让 TcpClient 连接到另一台主机上的 TcpListener

> ID：14735538
> 
> 赞同：2
> 
> 时间：2013-02-06T17:48:59.493
> 
> 标签：c#, tcp, tcpclient, tcplistener

我有一个简单的客户端和服务器应用程序，它们使用 TcpClient 和 TcpListener 通过 TCP/IP 相互通信。如果我在 IP 地址为 192.168.10.150 的同一台计算机上同时运行服务器和客户端，它们可以正常通信。但是，如果我将客户端移动到家庭网络上的另一台计算机，它就无法再连接到服务器（它仍在 192.168.10.150 上运行）。从客户端计算机，我可以 ping 192.168.10.150。我已关闭两台计算机上的 Windows 防火墙。我正在使用端口 2244，我认为它没有被其他东西使用。两台计算机都连接到同一个无线路由器。但是客户端中的这行代码：

```
TcpClient client = new TcpClient("192.168.10.150", 2244); 
```

引发以下异常：

> 连接尝试失败，因为连接的一方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 192.168.10.150:2244

两台计算机都运行 XP。任何想法我如何让这些连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T09:47:24.960

感谢您的回复。看来你们中的一些人是正确的，网络流量被路由器停止了。我用一个开关把两台电脑连接起来，他们就可以说话了。不幸的是，我无法成功配置路由器以允许流量，但没关系，因为我现在只能使用交换机。

# ios - 在 iPhone 模拟器中，有没有办法将联系人设置为所有者？

> ID：14735539
> 
> 赞同：4
> 
> 时间：2013-02-06T17:49:02.490
> 
> 标签：ios, ios-simulator, addressbook

我正在做一些地址簿测试，我正在寻找一种方法来测试某人是否是设备所有者。取而代之的是，为了在模拟器上进行测试，我实际上必须在地址簿中有设备所有者。

您可以将联系人添加到模拟器通讯录中，但我找不到将联系人设为所有者的方法。如何在 iPhone 模拟器中设置设备所有者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T18:48:12.133

无法在模拟器上更改所有者，因为它是邮件、联系人和日历的一项功能，在模拟器上不可用。您通常会转到设置>[常规>Siri 或邮件、联系人、日历]>我的信息，然后从那里选择一个联系人。

![Siri 设置](../Images/83f3b4d478cd7235336e5bffe552007c.png)

![邮件设置](../Images/a320e6d5fb1af5e82268146d8e312912.png) 更改所有者说明： [https ://discussions.apple.com/thread/3997414?start=0&tstart=0](https://discussions.apple.com/thread/3997414?start=0&tstart=0)

# java - 线程游戏循环中的图形渲染。更改数组上的数据

> ID：14735541
> 
> 赞同：0
> 
> 时间：2013-02-06T17:49:06.927
> 
> 标签：java, android, multithreading

我有两个名为 2D int 数组的对象：originalMap 和rendMap，它们包含对应于益智游戏地图的数字。从线程类中，我从类调用 Puzzle.java 中获取映射数组并对其进行修改。

```
 int [][] rendedMap = Puzzle.getRendedMap().getMap();
   int [][] originalMap = Puzzle.getMapObj().getMap(); 
```

这是我的线程循环：

drawPuzzle（画布，*地图*）；获取画布和数组并绘制地图。

```
 while(running){
            if(!holder.getSurface().isValid())
                continue;

                    canvas = holder.lockCanvas();

                    if(runSolution && movements.size()>0){                      
                        executeSolution();
                        drawPuzzle(canvas, rendedMap);
                        if(finished){//checks if the execution finished
                            runSolution=false;
                        }
                    if(message.equals("No more actions") ||
                                    message.equals("Out of bounds, try again!")){
                            System.out.println(message);
                            drawPuzzle(canvas, originalMap);
                    }
                    }else{
                        drawPuzzle(canvas, originalMap);
                    }

                    drawMovements(canvas);
                    holder.unlockCanvasAndPost(canvas); 
    }
} 
```

这是我修改数组的方法：

```
public void executeSolution(){

    numOfPlanets = 2;

    for(int x=0;x<rendedMap.length-1; x++){
        for(int y=0;y<rendedMap[x].length-1; y++){
            //Checks where the robot is and saves its initial position 
            if(rendedMap[x][y]>=7 && rendedMap[x][y]<=9){
                initX=x; initY=y; initial=true;
                System.out.println("Initial X: "+initX +" Y: "+initY );
                direction = rendedMap[x][rendedMap[x].length-1];
                System.out.println("Direction: "+direction );
            }
        }//end inner for
    }//end for

    if(movements.size()>0){
        for(int i=0; i<movements.size();i++){

            if(movements.get(i).getColour().equals("none")){
                if(movements.get(i).getMotion().equals("straight")){
                    if(direction==RIGHT){
                        if(rendedMap[initX][initY+1]==0){
                            finished=true;
                            message = "Out of bounds, try again!";
                            return;
                        }else{
                            rendedMap[initX][initY+1]= rendedMap[initX][initY+1]+6;
                            rendedMap[initX][initY]=rendedMap[initX][initY]-6;
                        }
                    }   
                }//action if
            }//color if 
        }//movements for loop

        if(numOfPlanets > 0 ){
            finished = true;

            message ="No more actions";
        }
    }//movements if statement
} 
```

我的问题是，当我出于某种原因渲染 renderMap 数组时 originalMap 也会发生变化，而当我试图拉回 originalMap 时，它不会变回来。我什至将它们打印出来并逐行检查，它们是相同的。

任何提示可能导致这种情况？我花了几天的时间来弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:56:48.397

```
if(direction==RIGHT) {
    if(rendedMap[initX][initY+1]==0) {
        finished=true;
        message = "Out of bounds, try again!";
        return;
    } else {
        rendedMap[initX][initY+1]= rendedMap[initX][initY+1]+6;
        rendedMap[initX][initY]=rendedMap[initX][initY]-6;
    }
} 
```

检查您的`rendedMap`数组是否已初始化，因为这通常会导致上下文错误，尤其是在 android IDE 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:19:32.160

```
if(!holder.getSurface().isValid())
                continue;

                    canvas = holder.lockCanvas();

                    if(runSolution && movements.size()>0){                      
                        executeSolution();
                        drawPuzzle(canvas, rendedMap);
                        if(finished){//checks if the execution finished
                            runSolution=false;
                        }
                    if(message.equals("No more actions") ||
                                    message.equals("Out of bounds, try again!")){
                            System.out.println(message);
                            drawPuzzle(canvas, originalMap);
                    }
                    }else{
                        drawPuzzle(canvas, originalMap);
                    }

                    drawMovements(canvas); 
```

回想一下您的 drawPuzzle 在表面视图被锁定之前，因为 else 导致它可能无法在该上下文循环中执行，正如我之前所说的那样，这是我们组织应用程序常见的问题

希望这可以帮助！犹豫是否寻求更多帮助

对不起英语我是印度人

# selenium - Selenium IDE - 在单击 Ajax 按钮后断言 JavaScript 重定向有效

> ID：14735552
> 
> 赞同：0
> 
> 时间：2013-02-06T17:49:44.497
> 
> 标签：selenium, selenium-ide

我有一个执行 Ajax 请求的按钮，然后它成功地重定向到另一个页面。

如何`assert`成功到达重定向页面？

我有一个`clickAndWait`按钮。但在那之后..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T02:57:22.743

您可以使用 verifyTextPresent 命令验证重定向页面中的唯一标签或文本。通过这种方式，您可以修复您已成功到达重定向页面。

试试这样

```
 command : verifyTextPresent                               

 Target  : some unique text in the redirected page. 
```

我认为您的问题可以通过此解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:21:35.040

IDE 有很多`assert`命令。您可以使用其中任何一种，并且可以实现测试范围（此处页面是否导航）。

**例子：**

```
 command :  assertTitle  
 Target :  check the title of the page. 
```

在上面他使用`verifyTextPresent`它将检查页面中是否存在文本的天气，它将继续下一步。如果您使用`assert`命令，它将在通过断言步骤时继续下一步。否则失败。

你要记住一件事，硒不会等待`Ajax`加载，它会等待`Page loading`. 因此，您必须`Wait`显式地输入命令来完成 Ajax 加载。

将代码转换`assertions`为. 您可以在 IDE的选项卡中看到该选项。`selenese``preferred language and testing framework``Option`

有关[SIDE 中 AssertCommands 的更多信息](http://qualitytrainings.com/?q=node/33#c111)

# html - 如何在父容器缩小时使用 CSS 包装一个 div

> ID：14735553
> 
> 赞同：0
> 
> 时间：2013-02-06T17:49:48.937
> 
> 标签：html, css

我有一个我无法弄清楚的 CSS 问题。这是标记。

```
<!doctype html>

<html>
    <head>
        <meta charset="UTF-8" />
        <style type="text/css">
            .container { position: relative; background-color: purple; padding: 0; margin: 0; }
            .first { float: left; width: 10%; min-width: 100px; background-color: yellow; }
            .second { float: left; width: 10%; min-width: 100px; background-color: orange; }
            .third { float: left; width: 80%; background-color: lime; }
            .clear { clear: both; }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="first">first</div>
            <div class="second">second</div>
            <div class="third">third</div>
            <div class="clear"></div>
        </div>
    </body>
</hmtl> 
```

我遇到的问题是，当我缩小浏览器窗口时，我想包装第三个 div，但是一旦它换行到新行，它就会完全展开（100%）。我已经接近了，但是当第三个 div 包装时，80% 的属性会启动并且不允许它完全扩展。[我有一个小提琴准备在这里调整。](http://jsfiddle.net/Halcyon/HU7r9/1/)下面是可视化问题的图像。您可以在第二张图片中看到，在进行换行时第三个 div 没有 100% 展开。

![在此处输入图像描述](../Images/74e2b9bbeeee955d8296567ea4afe909.png)

![在此处输入图像描述](../Images/1bcd8577daf66b6ae7064ce12663f1a0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:01:57.017

.first 和 .second 类中的属性 min-width 是问题

如果你删除它，有另一种行为

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:56:04.957

抱歉，没有纯 CSS 解决方案。使用 jQuery...

您想将事件附加到 window.resize。注意 window.resize 会不断刷新，因此需要一些额外的功能来等待调整大小保持恒定半秒，然后再触发您的方法。

标记

```
<div>
    <div id="firstcont" style="float:left; display:inline-block;">
        <select></select>
        <select></select>
    </div>
    <div id="secondcont" style="margin-left:80px;">
        <input id="note" style="width: 99%;" /><br />
    </div>

</div> 
```

Javascript：

```
$(window).resize(function() {

    //wait a half second for a consant resize reading before executing
    waitForFinalEvent(function(){

        var $textbox = $("#note");
        var textboxwidth = $textbox.width();

        //alert(textboxwidth);

        if(textboxwidth < 400)
        {
            //alert("resizing");
            $('#firstcont').css('float', 'none');
            $('#secondcont').css("margin-left", "0px");
        }
        else
        {
            $('#firstcont').css('float', 'left');
            $('#secondcont').css("margin-left", "80px");
        }
    }, 500, "some unique string");
});

var waitForFinalEvent = (function () {
  var timers = {};
  return function (callback, ms, uniqueId) {
    if (!uniqueId) {
      uniqueId = "Don't call this twice without a uniqueId";
    }
    if (timers[uniqueId]) {
      clearTimeout (timers[uniqueId]);
    }
    timers[uniqueId] = setTimeout(callback, ms);
  };
})(); 
```

在此处查看 JSFiddle：http: [//jsfiddle.net/eastonharvey/Nsgf8/2/](http://jsfiddle.net/eastonharvey/Nsgf8/2/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T17:55:29.213

试试这个，
这是小提琴[链接](http://jsfiddle.net/2ETAS/)

```
 .container {
    position: relative;
    background-color: purple;
    padding: 0;
    margin: 0;
    min-width: 400px;
}
.first {
    float: left;
    width: 10%;

    background-color: yellow;
}
.second {
    float: left;
    width: 10%;

    background-color: orange;
}
.third {
    float: left;
    width: 80%;
    background-color: lime;
}
.clear {
    clear: both;
} 
```

# coffeescript - 意外的令牌非法 .. 某处

> ID：14735557
> 
> 赞同：2
> 
> 时间：2013-02-06T17:49:58.653
> 
> 标签：coffeescript

```
addToBasket = (id, qty) ->
    if $.cookie('basket')?
        # Basket exists
        basket = $.parseJSON($.cookie('basket'))
        basket.push( { 'id': id, 'qty': qty } )
        $.cookie('basket', JSON.stringify(basket))
    else
        # Basket doesn't exist
        alert 'Creating basket'
        basket = JSON.parse([{'id': id, 'qty': qty}])
        $.cookie('basket', JSON.stringify(basket)) 
```

我在扯我的头发；我无法运行（编译后的等效）函数，总是得到非法令牌错误。我已经检查了流氓、隐形字符，除了 CR/LF 之外什么都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:27:35.427

您正在调用`JSON.parse`一个数组，由于浏览器实现它的方式，这显然是语法错误而不是正常异常。您实际上是在这样做：

```
JSON.parse([{id: 123}].toString()) 
```

这与以下内容相同：

```
JSON.parse('[object Object]') 
```

这是非法的 JSON，因此是错误的。

# css - 如何在 twitter bootstrap 中的流动行上进行填充

> ID：14735562
> 
> 赞同：7
> 
> 时间：2013-02-06T17:50:16.370
> 
> 标签：css, html, twitter-bootstrap

```
<div class="internal-wrapper row-fluid">
        <div class="Header span12"> 
                <div class="HeaderTitle span6"></div>
                <div class="span6"></div>
        </div>
</div> 
```

现在，当我在内部包装器上进行填充时，我希望填充会影响整个网格！在里面。但是发生了溢出（我认为，正确的填充不起作用）

```
.internal-wrapper {
     padding-left: 30px;
     padding-right: 30px;
} 
```

![在此处输入图像描述](../Images/cc2e21072e67a515f571e1ca03e511b9.png)

下面的蓝色条代表`Header`班级。绿色框，代表填充！所以，它发生在左边而不是右边

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-06T18:09:13.063

`.row-fluid`是 100% 宽度。因为它使用边框布局，所以您放置的任何填充都会添加到 100%。请参阅[http://paulirish.com/2012/box-sizing-border-box-ftw/](http://paulirish.com/2012/box-sizing-border-box-ftw/)。但是，将其设置为使用内容框模型可能会导致 Bootstrap 中的其他问题。

如何修复它 - 添加一个带有填充的内部元素。

```
<div class="row-fluid">
  <div style="padding-left: 30px; padding-right: 30px;">
     ...
  </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:59:14.867

我无法从您的帖子中看到（或辨别）出了什么问题，但这是我的猜测：通过在 Bootstrap 大小的元素上放置填充，您已经改变了它的宽度。尝试将边距放在 .Header 上。

如果这没有帮助，请创建一个演示：http: [//jsfiddle.net/](http://jsfiddle.net/)

# html - CSS双边框（2种颜色）不使用轮廓？

> ID：14735569
> 
> 赞同：17
> 
> 时间：2013-02-06T17:50:31.280
> 
> 标签：html, css, border, pseudo-element

我想知道你们认为在 div 周围获得 2 种颜色的双边框的最简单方法是什么？我尝试同时使用边框和轮廓，它在 Firefox 中工作，但轮廓在 IE 中似乎不起作用，这是一个问题。有什么好的方法可以解决这个问题吗？

这就是我所拥有的，但大纲不适用于 IE：outline: 2px solid #36F; 边框：2px 实心#390；

谢谢。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-06T18:05:42.973

您可以使用伪元素添加多个边框，然后将它们放置在原始边框周围。没有额外的标记。跨浏览器兼容，自 CSS 2.1 以来就已经存在。我在 jsfiddle 上为您提供了一个演示......请注意，边框颜色之间的间距是用于示例的。您可以通过更改绝对定位中的像素数来关闭它。

```
.border
{
    border:2px solid #36F; 
    position:relative;
    z-index:10
}

.border:before 
{
    content:"";
    display:block;
    position:absolute;
    z-index:-1;
    top:2px;
    left:2px;
    right:2px;
    bottom:2px;
    border:2px solid #36F
} 
```

[http://jsfiddle.net/fvHJq/1/](http://jsfiddle.net/fvHJq/1/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-08-18T14:07:59.427

使用框阴影作为第二个边框。

```
div.double-border {
    border: 1px solid #fff;
    -webkit-box-shadow: 0px 0px 0px 1px #000;
    -moz-box-shadow: 0px 0px 0px 1px #000;
    box-shadow: 0px 0px 0px 1px #000;
} 
```

在这种情况下， box-shadow 不会像 outline 一样忽略border-radius 属性

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:52:39.343

一个非常简单的解决方案，如果没有其他方法，您可以将其用作后备方案，即使用两个 div。你的主 div，然后是一个空的，只是包装它，你可以用它来设置第二个边框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-06T16:26:22.640

这个问题迟到了，但我觉得我应该在某个地方记录一下。您可以在 Less 或 Stylus 之类的东西中创建可扩展的功能，这将创建任意数量的边框（此处为 Stylus）：

```
abs(n)
    if n < 0
        (-1*n)
    else
        n

horizBorder(n, backgroundColor)
    $shadow = 0 0 0 0 transparent
    $sign = (n/abs(n))
    for $i in ($sign..n)
        /* offset-x | offset-y | blur-radius | spread-radius | color */
        $shadow = $shadow, 0 (2*$i - $sign)px 0 0 #000, 0 (2*$i)px 0 0 backgroundColor
    return $shadow 
```

然后，

```
$background: #FFF // my background was white in this case and I wanted alternating black/white borders

.border-bottom
    box-shadow: horizBorder(5, $background)
.border-top
    box-shadow: horizBorder(-5, $background)
.border-top-and-bottom
    box-shadow: horizBorder(5, $background), horizBorder(-5, $background) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-25T15:42:33.197

使用 box-shadow，您可以实现任意数量的不同颜色边框。例如：

```
#mydiv{
  height: 60px;
  width: 60px;
  box-shadow: inset 0 0 0 5px #00ff00, inset 0 0 0 10px #0000ff;
}

<div id="mydiv">&nbsp;</div> 
```

[https://jsfiddle.net/aruanoc/g5e5pzny](https://jsfiddle.net/aruanoc/g5e5pzny)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-15T22:52:08.667

一个小技巧；）

```
box-shadow: 
0 0 0 2px #000,
0 0 0 3px #000,
0 0 0 9px #fff,
0 0 0 10px #fff,
0 0 0 16px #000,
0 0 0 18px #000; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-16T07:41:27.133

```
.border{
  width: 200px;
  height: 200px;
  background: #f06d06;
  position: relative;
  border: 5px solid blue;  
  margin: 20px;
}
.border:after {
  content: '';
  position: absolute;
  top: -15px;
  left: -15px;
  right: -15px;
  bottom: -15px;
  background: green;
  z-index: -1;
}
```

```
<div class="border">

</div>
```

使用类名来`.border`给定单个边框的值。然后如果您在代码示例示例上方有第二个边框，则`border:2px solid #000`您想要另一个边框尝试给定值`.border:after`

# java - Java 文本文件 I/O 位置

> ID：14735575
> 
> 赞同：1
> 
> 时间：2013-02-06T17:51:00.403
> 
> 标签：java, file, io

我查看了其他关于 Java 在何处查找文件的线程，但我仍然感到困惑。

我有一个程序，在 Eclipse (Juno) 中作为 java 项目创建。我没有对其他任何东西进行任何修改，现在只有一个主类。

当程序运行时，它需要三个输入：一个数字和两个字符串。第一个字符串是它必须从中读取输入的文件的名称，第二个是它必须将输出放入的文件。

如果我为输入字符串传入“input.txt”，并且有一个名为 input.txt 的文件，那么 Java 应该在哪里找到它？我试过把它放在 src、bin 和项目根目录中。目前，我正在尝试按如下方式访问该文件：

```
File input = new File(args[1]); 
```

其中 args[1] 是开始时传递给程序的第一个字符串。当我这样做时，我得到一个错误“java.io.FileNotFoundException：input.txt（系统找不到指定的文件）”

我应该把文件放在哪里以便 Java 可以找到它？

以下是相关代码：

```
public class main {

public static int runs;
public static File input;
public static File output;

public static String line1;
public static String line2;
public static String line3;
public static String reactions;

/**
 * @param args 
 */
public static void main(String[] args){

    if(args.length != 3)
        System.out.println("Please provide 3 arguments.");

    runs = Integer.parseInt(args[0]);
    File input = new File(args[1]);
    File output = new File(args[2]);

    System.out.println(runs);
    System.out.println(input);

    try {
        Scanner sc = new Scanner(input); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:56:10.703

对于这样的问题，请尝试使用 getAbsolutePath() 方法：

```
File input = new File(args[1]);
System.out.println(input.getAbsolutePath()); 
```

这向您显示文件对象认为文件在哪里。那是您应该放置文件的位置......或者可能相应地修改输入参数，以便程序在您希望文件所在的位置查找文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:53:10.760

您只需将该输入文件放在项目的根文件夹中。

**更新 ：**

当您使用扫描仪获取用户输入时。然后隐藏您用于 args 的代码，即命令行参数。

```
Scanner sc = new Scanner(input);
runs = sc.nextInt(); // This will store your input line  
in = sc.next(); // This will store your input file name 
out = sc.next();  // This will store your output file name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:53:26.917

`/`如果文件名不是绝对的（在 *nix 和Windows 上不以开头`C:\`），则在当前工作目录中查找。Java 程序可以使用`System.getProperty ("user.dir")`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:54:17.480

在 Eclipse 中，您应该为运行配置显式设置执行目录。

*默认*使用的目录可能取决于项目配置、打包、输出目录等，因此最好 (a) 使用绝对路径（例如，以 a`c:\`或`/`等开头）或 (b) 在运行配置中设置它.

# c - SPOJ：参赛者之日

> ID：14735579
> 
> 赞同：0
> 
> 时间：2013-02-06T17:51:13.557
> 
> 标签：c, algorithm

我正在努力解决问题[SPOJ](http://www.spoj.com/problems/NICEDAY/)上的竞争对手的日子。我尝试了以下方法：

我正在寻找最好的初始球员，所以最初排名第一的球员是最好的球员。在此之后，我遍历所有玩家，并为他们每个人尝试查看是否有任何当前最好的玩家比这更好，如果是，那么这不是很好的丢弃它（因为存在比这更好的玩家），否则我将其添加到最佳播放器列表中。最后我会输出最佳玩家的数量。

```
 for(i=0; i<num; i++)
    {
        for(j=0; j<ctr; j++)
        {               
            // i is already in best
            if(i == best_n[j])
                break;                        
            if((elmts[i].a < elmts[best_n[j]].a) ||
                    (elmts[i].b < elmts[best_n[j]].b) ||
                    (elmts[i].c < elmts[best_n[j]].c))
            {
                continue;
            }
            else
            {
                break;
            }
        }
        if(j>=ctr)
        {
            best_n[ctr] = i;
            ctr ++;
        }
    } 
```

num 是玩家人数，而 ctr 是迄今为止最好的玩家人数。但我得到一个错误的答案。我尝试再次运行一个循环，以验证是否有任何玩家比其他玩家更差，但这也会导致错误的答案。另外我认为我的方法效率不高，在最坏的情况下会是 n^2。你能帮我弄清楚我的错误吗，我该如何改进它以提高效率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:35:16.793

一个问题是您的算法需要删除`best_n`当前优于的所有元素。

考虑：

```
1 5 5 // inserted into best at start
5 1 1 // inserted into best at start
3 4 4 // not worse than any of the above, insert into best
4 3 3 // not worse than any of the above, insert into best
2 2 2 // better than 3 4 4 and 4 3 3 
```

（伪）代码看起来像：（如果每次比赛中电流都更好，我们必须用电流替换另一个）

```
// define '<' as 'better than'
if (not best[j] < elmts[i])
  if (elmts[i] < best[j])
    remove best[j]
    ctr--
  continue
else break 
```

**有效的解决方案：**

`O(n^2)` is likely too slow. [Here](http://apps.topcoder.com/forums/?module=Thread&threadID=575041&messageID=801760&mc=15&view=tree#801760) is a high-level overview of an efficient solution. [Here](https://github.com/zobayer1/SPOJ/blob/master/NICEDAY.cpp) is C++ code which presumably works.

# javascript - Jquery .html 方法在 Android 上挂起

> ID：14735583
> 
> 赞同：1
> 
> 时间：2013-02-06T17:51:22.480
> 
> 标签：javascript, android, jquery, ajax, mobile

我很难在 Android 应用程序上实现 Ajax 导航。它在桌面和 iPhone 上就像一个魅力，但在 Android 上却失败了。这是当前的实现：

```
function ajaxnav(href, params, meth){
    if(typeof params === "undefined"){
        params = {}
    }
    if(typeof meth === "undefined"){
        meth = "get"
    }
    $(".loading").show();
    $.ajax({
        url: href,
        type: meth,
        data: params,
        success: function(data, textStatus, jqXhr){
            $(".round").html(data)
        $(".loading").hide();
            $(".inner-content a").each(function(i){
            ajaxlinkbuilder($(this));
        })
        ajaxnavchange = true;
        History.pushState(null, "AppName", href);
        if(isAndroid()) myScroll.refresh();
        },
        error: function(data, textStatus, jqXhr){
            window.location = href;
        }
    })
    return false;
} 
```

即使我把它也行不通

```
 $(".loading").hide();
            $(".inner-content a").each(function(i){
                ajaxlinkbuilder($(this));
            })
            ajaxnavchange = true;
            History.pushState(null, "AppName", href);
            if(isAndroid()) myScroll.refresh(); 
```

块内`promise().done()`。它只是在执行期间坚持`.html()`。我试图等待看看它是否只是由于各种原因而减速，但我已经等了 10 分钟，它甚至没有在之后调用第一行 - `$(".loading").hide()`。

有什么想法吗？

# android - 访问调用者对象的 JNI 过时本地引用错误

> ID：14735585
> 
> 赞同：1
> 
> 时间：2013-02-06T17:51:32.257
> 
> 标签：android, android-ndk, java-native-interface

我无法摆脱此错误消息

> JNI 错误（应用程序错误）：访问过时的本地引用 0x...（索引...）

我试图从本机访问`isInterrupted()`JNI 调用程序类的方法，它是一个 Java 线程。线程循环完全是原生的，产生其他 pthread 并持有互斥锁。我需要一种主要Android活动的方法来通知线程它应该`interrupt()`在第一个安全时刻由Java停止。

该场景非常简单明了，两行之间没有其他任何事情发生：

```
public class MyThread extends Thread {
  public native static int native_world_entry();
  public void run() {
    native_world_entry();
  }
  static {
   System.loadLibrary("mylib");
  }
} 
```

本机代码如下：

```
jint Java_..._1entry(JNIEnv* env, jobject thiz) {
  //jobject jj = (*env)->NewGlobalRef(env, thiz);
  jclass sclass = (*env)->FindClass(env, "java/lang/Thread");
  jmethodID inted = (*env)->GetMethodID(env, sclass, "isInterrupted", "()Z");
  LOGI("Checking");
  jboolean status = (*env)->CallBooleanMethod(env, thiz, inted);
  ...
} 
```

一切都很好，直到`CallBooleanMethod()`之前的调用成功并显示“正在检查”。我尝试添加注释行并`CallBooleanMethod()`相应地更改 's 参数，但错误是相同的。

除了错误之外，我不明白在这种情况下需要全局引用的原因。感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T08:52:17.693

我认为这是因为 native_world_entry 是静态的。所以这不是 MyThread istance。它是 MyThread 类实例。向 native_world_entry 方法添加额外的参数以显式传递线程处理程序，例如 native_world_entry(this)。

PS您也可以使用 Thread.currentThread() 来获取当前线程。

# c - 在没有 C 库的情况下创建和调整动态数组的大小？

> ID：14735586
> 
> 赞同：3
> 
> 时间：2013-02-06T17:51:34.750
> 
> 标签：c, arrays, dynamic, malloc

有没有办法在 C 中实际创建动态数组而不必使用标准库？

`Malloc`需要`stdlib.h`库，我不允许在我的项目中使用它。

如果有人有任何想法，请分享？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T18:16:32.973

`malloc`不仅仅是一个库，它是您与操作系统交互的方式，为正在运行的进程请求更多内存*。*好吧，您可以要求更多内存并自己管理空闲/占用的内存，但这在许多层面上都是错误的。

但是，我倾向于相信您的项目将在某种没有操作系统的平台上运行，是吗？¹在这种情况下，更快的解决方案是首先在一个大的全局数组中静态分配一些内存，每次需要内存时，您都会要求负责这个大数组的管理器。

让我举个例子，为了简单起见，它会很小而且不是很实用，但它是一个非常好的快速入门。

```
typedef char bool;

#define BLOCK_SIZE 1024 //Each allocation must have in max 1kb
#define MAX_DATA 1024*1024*10  //Our program statically allocates 10MB
#define BLOCKS (MAX_DATA/BLOCK_SIZE)

typedef char Scott_Block[BLOCK_SIZE];

Scott_Block Scott_memory[BLOCKS];
bool Scott_used_memory[BLOCKS];

void* Scott_malloc(unsigned size) {
    if( size > BLOCK_SIZE )
        return NULL;
    unsigned int i;
    for(i=0;i<BLOCKS;++i) {
        if( Scott_used_memory[i] == 0 ) {
            Scott_used_memory[i] = 1;
            return Scott_memory[i];
        }
    }
    return NULL;
}

void Scott_free(void* ptr) {
    unsigned int pos = ((char*)(ptr)-Scott_memory[0])/BLOCK_SIZE;
    printf("Pos %d\n",pos);
    Scott_used_memory[pos] = 0;
} 
```

我编写了这段代码来展示如何模拟内存管理器。让我指出一些可以对其进行的改进。

首先，Scott_used_memory 可以是*位图*而不是`bool`数组。其次，它不会分配大于 BLOCK_SIZE 的内存，它应该搜索连续的块以创建更大的块。`void*`但是为此，您需要更多的控制数据来判断分配的块占用了多少。第三，空闲内存的搜索方式（线性）非常慢，通常块创建一个空闲块的链接列表。

但是，就像我说的，这是一个很好的快速开始。根据您的需要，这可能会很好地满足它。

¹如果没有，那么您绝对**没有理由**不使用 malloc。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T18:29:51.477

那么为什么不这个程序（C99）

```
#include <stdio.h>

int main(int argc, char *argv[])
{
   int sizet, i;
   printf("Enter size:");
   scanf("%d",&sizet);
   int array[sizet];
   for(i = 0; i < sizet; i++){ 
     array[i] = i;
   }
   for(i = 0; i < sizet; i++){
     printf("%d", array[i]);
   }
   return 0;
} 
```

如同一位老板！:-)

# ruby - 为什么这个 button_to 在 Rails 3.2.11 中渲染不正确？

> ID：14735591
> 
> 赞同：1
> 
> 时间：2013-02-06T17:51:50.133
> 
> 标签：ruby, ajax, ruby-on-rails-3

我在 Rails 3.2.11 中工作，我无法弄清楚为什么这个按钮不会按照 API 文档呈现。具体来说，我无法正确呈现 data-remote 属性。我的代码中有错误吗？

现在这段代码：

```
<%= button_to "Test", :action => "test", :remote => true, :form_class => "test_button" %> 
```

产生这个 HTML：

```
<form action="/cloud_status/test?form_class=test_button&remote=true" class="button_to" method="post"> 
```

根据[API 规范](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to)，它应该呈现这个：

```
<form action="/cloud_status/test" class="test_button" remote="true" method="post"> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:57:57.163

我相信文档在某些示例中实际上是不正确的。获得您正在寻找的输出的方法是：

```
<%= button_to "Test", { :action => "test" }, { :remote => true, :form_class => "test_button" } %> 
```

`:remote`and`:form_class`应该是散列的一部分，散列`html_options`是`button_to`方法的第三个参数。

第二个参数可以是 a`String`或`Hash`。当它是 a`String`时，它被视为一个 URL，而当它`Hash`被传递给它`url_for`以构建适当的 URL 时。

# android - 滑动后变量值不递增

> ID：14735595
> 
> 赞同：-2
> 
> 时间：2013-02-06T17:51:58.157
> 
> 标签：android, android-activity, android-viewpager, fragment, slide

我已经建立了一个幻灯片。我有一个 ViewPage 活动，每次我向左或向右滑动时都会调用一个片段。我的问题是：我有一个变量 int，它在初始状态下的值为 6（week_of_year）。当我向右滑动时调用一个新片段并且变量不是我想要的增量。该变量仅在第二张幻灯片中增加。
例如： 6 -> 6 -> 7 -> 8 而不是 6 -> 7 -> 8 -> 而且我不知道为什么会发生这种情况。

这是我的代码：
**ViewPage Activity**

```
protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_screen_slide);
/**
 * Instantiate a ViewPager and a PagerAdapter
 */
    date = Calendar.getInstance();
    mPager = (ViewPager)findViewById(R.id.pager);
    mPagerAdapter = new ScreenSlidePagerAdapter(getSupportFragmentManager());
    mPager.setAdapter(mPagerAdapter);

    mPager.setOnPageChangeListener(new OnPageChangeListener() { 
        @Override
        public void onPageSelected(int arg0) {
            if(itemOld < arg0){//right
                auxFront = auxFront + 1;
                oldStartWeek = oldStartWeek + auxFront; 
                auxFront=0;
            }
            else if(itemOld > arg0){//left
                auxBack = auxBack - 1;
                oldStartWeek = oldStartWeek + auxBack; 
                auxBack=0;
            }

        }

        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {    
        }

        @Override
        public void onPageScrollStateChanged(int arg0) {
        }
    });

}

@Override
public void onBackPressed(){
    if(mPager.getCurrentItem()==0){
        super.onBackPressed();
    }else{
        mPager.setCurrentItem(mPager.getCurrentItem()-1);
    }
} 

/**
 * A simple pager adapter that represents 5 ScreenSlidePageFragment objects, in sequence
 */

private class ScreenSlidePagerAdapter extends FragmentStatePagerAdapter{
    public ScreenSlidePagerAdapter(FragmentManager fm){
        super(fm);
    }

    @Override
    public ScreenSlidePageFragment getItem(int position) {
        /**
         * Pass values from ViewPage activity to Fragment
         */
        ScreenSlidePageFragment f = new ScreenSlidePageFragment();
        Bundle args = new Bundle();
        if(position == 0){
            oldStartWeek = date.get(Calendar.WEEK_OF_YEAR);
            args.putInt("START_WEEK", oldStartWeek);
            f.setArguments(args);
            return f;

        }
        else if(position != 0){
            args.putInt("START_WEEK", oldStartWeek);
            f.setArguments(args);
            itemOld = mPager.getCurrentItem();
            return f;
        }
        return f;
} 

    @Override
    public int getCount() {
        return  NUM_PAGES;
     }
  }

    } 
```

**在每张幻灯片中调用的片段**-------------------------------------------------------- -

```
 public class ScreenSlidePageFragment extends Fragment implements
        AdapterView.OnItemClickListener {
               public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        Toast.makeText(getActivity(), "week....." +getArguments().getInt("START_WEEK"), Toast.LENGTH_LONG).show();  //show the correct value

headerWeek.setText(" Week Number:    "+getArguments().getInt("START_WEEK",0));  //But is not change corretly in the text view  ????? 
```

感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:27:58.670

要查看为什么会在您的 ViewPager 中发生这种情况，您可以记录每个片段的 onCreate、onPause、onResume 等方法。发生的情况是前两个片段实际上是在大约同一时间创建的。所以第二个片段是在它实际显示在 ViewPager 中之前创建的，所以当用户滚动到第二个片段时，那里通常会有旧数据。

我对此的解决方案有点老套。请注意，当用户在场时，您可以做任何您需要更新视图的操作，而不是 displayDialog()。

```
 @Override
public void onResume() {
    super.onResume();
    fragmentActive = true;
    if (userVisible()){
        displayDialog();
    }
    else{
        recursiveWait();
    }
}

private void recursiveWait(){
    new WaitAndDoXTask(1000, new DoXListener() {

        @Override
        public void doX() {
            Log.d(TAG, "doX");
            if (userVisible()){
                displayDialog();
            }
            else if (fragmentActive){
                recursiveWait();
            }
        }
    }).execute();   
}

private boolean userVisible(){
    boolean vis = getUserVisibleHint();
    Log.d(TAG, "user visible = " + vis);
    return vis;
}

@Override
public void onPause() {
    super.onPause();
    Log.d(TAG, "onPause");
    fragmentActive = false;
} 
```

这是 WaitAndDoXTask：

```
public class WaitAndDoXTask extends AsyncTask<Void, Void, Void>{

DoXListener mListener;
private int mTimeToWait;

/** This class will wait for the set time then do what is put into the listener.
 * 
 * 
 * Run like this:
 * new WaitAndDoXTask(1000, new DoXListener() {
 *  
 *  @Override
 *  public void doX() {
 *      // TODO Auto-generated method stub
 *      
 *  }
 * }).execute();
 **/
public WaitAndDoXTask(int timeToWait, DoXListener listener){
    super();
    mTimeToWait = timeToWait;
    mListener = listener;
}

public interface DoXListener{
    public void doX();
}

@Override
protected Void doInBackground(Void... params) {
    try {
        Thread.sleep(mTimeToWait);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    return null;
}

@Override
protected void onPostExecute(Void result) {
    if (mListener!=null){
        mListener.doX();
    }
} 
```

}

或者，如果您可以使用一些适配器设置您的片段并通过 onDataSetChanged 获得通知，这可能会更好。

# http-headers - 忽略 CORS 设置，未写入 Access-Control-Allow-* 标头

> ID：14735596
> 
> 赞同：4
> 
> 时间：2013-02-06T17:51:59.487
> 
> 标签：http-headers, servicestack, cors

在测试 ServiceStack 时遇到了著名的`Access-Control-Allow-Origin`问题后，我对[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)进行了大量阅读以更好地理解问题。我也遇到了[这个非常有用的 SO question](https://stackoverflow.com/questions/8211930/servicestack-rest-api-and-cors)。

但是，那里的解决方案对我不起作用。我尝试包含`CorsFeature`插件并手动设置端点配置，但是在尝试了两种方式后，我发现从服务器返回的响应标头不包含我的任何`Access-Control-Allow-*`标头，因此问题仍然存在。

我尝试了另一种最终对我有用的解决方案（通过一些与此处无关的其他问题）。我在我的服务的 web.config 中添加了以下内容：

```
<system.webServer>
  [...snip...]
  <httpProtocol>
    <customHeaders>
      <clear />
      <add name="Access-Control-Allow-Origin" value="*" />
      <add name="Access-Control-Allow-Headers" value="Content-Type" />
      <add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS" />
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

*（其他读者请注意，这只适用于 IIS7+。请参阅[http://enable-cors.org/](http://enable-cors.org/)了解有关在其他服务器上启用 CORS 的更多信息）*

**我的问题是**：为什么我能够使用这个 web.config 方法编写我的标头，而不是使用 ServiceStack 的内置 CORS 支持？是否有我在某处缺少的配置设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T20:07:26.077

我正在查看更多[@mythz](https://stackoverflow.com/users/85785/mythz)的 SO 答案并遇到了[这个](https://stackoverflow.com/questions/13741397/servicestack-cors-feature)。由于我（还）不完全理解的原因，添加该请求过滤器（以及 CorsFeature 插件）允许一切按预期工作。我的预检 OPTIONS 请求没有错误，我的 GET 和 POST 也没有任何来源错误。

所以，简而言之，我的最终解决方案是将该帖子中的 mythz 答案中的代码复制到我的`AppHost.Configure()`中，并**删除我的 web.config 自定义标头**。（在我从 web.config 中删除我的自定义标头之前，我实际上将我的标头加倍了！）

# javascript - 使用 for loop totalSum Javascript 向一个变量添加值

> ID：14735598
> 
> 赞同：0
> 
> 时间：2013-02-06T17:52:05.937
> 
> 标签：javascript

我有一些随机分配给变量的值。现在我想将每个值相加以获得总和，但循环不会将它们加在一起。

当我控制台记录它时，索引变量起作用。但不是当前值和指数值的总和。有小费吗 ？

这是循环 // indexValue 是我从数组中获得的值//

```
 var indexValue = index;  // Random number from 1 - 10
    var totalSum = 0;

   for(var x = 0; x <indexValue; x++){

   var currentValue = index[x];
   totalSum += currentValue;
    }

    console.log(totalSum); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:54:00.420

我假设因为您引用`index[x]`的`index`是一个数组。如果是这样，您将错误的值分配给`indexValue`. 试试这个：

```
var indexValue = index.length; 
```

这样做是将数组的长度分配给变量`indexValue`。现在`for`循环将从 0 运行到 n，其中 n 是数组的长度。

这应该为您提供所需的值。

希望这可以帮助。

**编辑：**

下面是我使用您的示例创建的 jsFiddle 的链接，并解释了代码：

[jsFiddle](http://jsfiddle.net/fhU67/)

```
var index = [1,2,3,4,5];  

var indexValue = index.length;  // It's imperative that this is an array
var totalSum = 0;

for(var x = 0; x <indexValue; x++){
    totalSum += index[x];
}

alert(totalSum); 
```

上面的代码是您发布的内容的修改版本。当前值不需要并且已被删除。在这种情况下，我创建了一个数组并将值存储在 index.html 中。计算长度，并将值相加。

为了方便测试，我改成`console.log(totalSum);`了`alert(totalSum);`. 它将产生相同的值。

只是一个参考说明`console.log`。一些浏览器（主要是 IE）在没有页面刷新的情况下不会自动将调试器附加到进程，将会出现`console`错误`undefined`。这是一个快速解决方案：

```
if(window.console && window.console.log) {
    console.log(totalSum);
} 
```

这将检查 (a) 控制台对象是否附加到全局窗口对象，以及 (b) 控制台的日志对象是否附加到控制台对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:55:02.627

你可能想要这样的东西：

```
var sum = 0;
for (var i=0; i < index.length; i++) {
    sum += index[i];
}
console.log(sum); 
```

# php - PHP：如何将 jpeg 转换为 png 然后 zip（不制作副本）

> ID：14735600
> 
> 赞同：1
> 
> 时间：2013-02-06T17:52:16.800
> 
> 标签：php

所以我想做的是： - 给定一个图像 url - > 将图像转换为 png - 压缩结果 png

我有以下代码成功地进行了转换和压缩（稍后我将对其进行扩展以测试扩展以自动转换格式）：

```
$file = "../assets/test.jpg";
$img = imagecreatefromjpeg($file);
imagePng($img, "files/temp.png" );
$zip->addFile( "files/temp.png", "test.png" ); 
```

我想知道的是，是否可以在压缩之前不创建图像副本来执行此操作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:57:14.717

见[`ZipArchive::addFromString()`](http://www.php.net/manual/en/ziparchive.addfromstring.php)。

```
$file = "../assets/test.jpg";

// capture output into the internal buffer
ob_start();

$img = imagecreatefromjpeg($file);
imagepng($img);

// get contents from the buffer
$contents = ob_get_clean();

$zip = new ZipArchive();
$zip->open('archive.zip', ZipArchive::CREATE);

// and put them in the zip file...
$zip->addFromString('name_in_the_zip.png', $contents); 
```

# php - 查询匹配多个关键字并显示结果？

> ID：14735602
> 
> 赞同：0
> 
> 时间：2013-02-06T17:52:27.123
> 
> 标签：php, mysql, sql, search

我有一个名为 cakes 的表，其中包含以下列：id、title、description、keywords。我还有一个名为keywords 的表，其中cakes 是父表。关键字表包含两列：id 和关键字。我需要编写以下两个查询：

1.  如果一个人输入巧克力、榛子、草莓等成分（可以是用逗号分隔的任意数量的关键字），我需要该查询来搜索包含所有关键字的蛋糕并显示结果。仅显示包含所有关键字的蛋糕。如果没有蛋糕匹配，我需要一条消息说没有找到。

2.  我在搜索框上有一个标签，上面写着，查找类似的蛋糕。如果有人输入 Vanilla Raspberry 或 example，则查询需要在数据库中找到蛋糕，并将其关键字与其他蛋糕的关键字匹配并显示结果。仅显示具有相同关键字且至少三个关键字相同的蛋糕。

不知道如何编写这些查询。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:53:43.637

```
SELECT CakeID, CakeName
FROM TableName
WHERE IngredientName IN ('chocolate', 'hazelnut', 'strawberry' )
GROUP BY CakeID, CakeName
HAVING COUNT(*) = 3 
```

或者如果没有对每个蛋糕的成分强制执行唯一性，请使用`DISTINCT`

```
SELECT CakeID, CakeName
FROM TableName
WHERE IngredientName IN ('chocolate', 'hazelnut', 'strawberry' )
GROUP BY CakeID, CakeName
HAVING COUNT(DISTINCT IngredientName) = 3 
```

*   [关系划分的SQL](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)

# javascript - Javascript - 闭包 - 语法 - 公共成员

> ID：14735603
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:52:30.430
> 
> 标签：javascript, performance, methods, closures

我已经阅读了很多关于闭包和原型的文章......但我仍然有一些问题。我从这篇文章开始：http: [//blogs.msdn.com/b/kristoffer/archive/2007/02/13/javascript-prototype-versus-closure-execution-speed.aspx](http://blogs.msdn.com/b/kristoffer/archive/2007/02/13/javascript-prototype-versus-closure-execution-speed.aspx)

我的问题是要公开公共方法：

这个方法是：

```
// Closure implementation
function Pixel(x, y){
  this.x = x;
  this.y = y;
  this.getX = function(){
    return this.x;
  }
  this.getY = function(){
    return this.y;
  }
  this.setX = function(value){
    this.x = value;
  }
  this.setY = function(value){
    this.y = value;
  }
} 
```

与此不同：

```
// Closure implementation
function Pixel(x, y){
  this.x = x;
  this.y = y;
    return {
        getX : function(){
            return this.x;
          },
        getY : function(){
            return this.y;
          },
        setX : function(value){
            this.x = value;
          },
        setY : function(value){
            this.y = value;
          }
    }
} 
```

哪一个是最好的？为什么？

最后一个问题：从上面的基准测试来看，有没有办法使用闭包来获得与原型相似的性能？

发送

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:54:39.020

那么没有“更好”的实现。

第二个选项将产生错误，因为您不能对其调用 new 因此`this`将引用窗口（或定义/调用函数时您所在的任何范围），所以不要使用它

第二个选项可以像这样使用闭包：

```
function Pixel(x, y){
  this.x = x;
  this.y = y;
  var that = this;
    return {
        getX : function(){
            return that.x;
          },
        getY : function(){
            return that.y;
          },
        setX : function(value){
            that.x = value;
          },
        setY : function(value){
            that.y = value;
          }
    }
} 
```

但这开始变得非常丑陋，与隐私问题不兼容，`prototype`并且在我看来过于重视隐私问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:10:31.013

有很多话要说。首先，这种`get`/`set`机制在 Javascript 中很少适用。这个 Java 结构必须确保所有对数据的访问都是通过公共方法而不是通过私有属性。Javascript 世界根本不在乎。

但是，假设您确实想要 Pixel 对象，并且想要封装它们`x`和`y`数据，例如公开以下两个函数：

```
toString(); // String (a representation of this Pixel)
offset(deltaX, deltaY); // Pixel (a new Pixel shifted by deltas from this one) 
```

然后你可以这样做：

```
var PixelA = function(x, y) {
    this.x = x; this.y = y;
    this.toString = function() {
        return "(" + this.x + ", " + this.y + ")";
    };
    this.offset = function(deltaX, deltaY) {
        return new PixelA(this.x + deltaX, this.y + deltaY);
    };
}; 
```

或者你可以这样做：

```
var PixelB = function(x, y) {
    this.toString = function() {
        return "(" + x + ", " + y + ")";
    };
    this.offset = function(deltaX, deltaY) {
        return new PixelB(x + deltaX, y + deltaY);
    };
}; 
```

或者你可以这样做：

```
var PixelC = function(x, y) {
    this.x = x; this.y = y;
}
PixelC.prototype.toString = function() {
    return "(" + this.x + ", " + this.y + ")";
};
PixelC.prototype.offset = function(deltaX, deltaY) {
    return new PixelC(this.x + deltaX, this.y + deltaY);
}; 
```

（**注意**：所有内容均未经测试。）

`PixelA`相当幼稚。我们的数据没有被封装；任何人都可以直接访问或改变我们的内部`x`和`y`属性。而且它是内存密集型的；PixelA 的每个实例都有自己的`toString`和`offset`函数副本。

`PixelB`解决第一个问题。内部数据存储在构造函数生成的闭包中。`toString`and函数可以访问这些`offset`变量，但外部无法直接看到它们。但它并不能缓解第二个问题。

`PixelC`解决第二个问题。由于`toString`和`offset`函数存储在原型中，因此实例不会被它们的重复副本乱扔。但是`x`和`y`属性再次公开，第一个问题又回来了。

我不知道选项 D。我相信您需要在封装内部状态和让原型函数访问该状态之间做出选择。您可以通过许多不同的语法扭曲来尝试解决此问题；但没有一个真正解决这个根本问题。您可以在任一方向执行某些优化，但问题是根本性的。

我很想被证明是错误的。

至于性能问题：基于闭包的构造不可能都像基于原型的构造一样快。想想在基于闭包的版本中为每个实例分配所有这些属性必须完成的所有工作，这些工作根本不需要在基于原型的版本中完成。现在，基于闭包的属性访问可能会更快......

# ruby-on-rails - 在不使用查询字符串的情况下重定向到不同的操作

> ID：14735605
> 
> 赞同：1
> 
> 时间：2013-02-06T17:52:34.447
> 
> 标签：ruby-on-rails, ruby

我正在尝试找出执行以下操作的最佳方法（我能想到几种方法，但我想知道处理它的最佳方法是什么）：

* * *

用户正在整理货物，然后单击“发送”链接，该链接将他发送到该`/shipments/:id/confirm`页面。该`confirm`操作检查用户是否完成了`ShippingAddress`; 如果没有，它会将他发送到`ShippingAddress#new`. （如果他这样做了，它会渲染`confirm`页面。

我希望用户能够完成`ShippingAddress#new`页面，提交它，然后被重定向回`/shipments/:id/confirm`. 我怎样才能做到这一点？如何在不执行类似操作的情况下将其传递`:id`到页面？或者这是最好的方法吗？`ShippingAddress#new``redirect_to new_shipping_address_path(shipment_id: @shipment.id)``Shipment#confirm`

* * *

```
class ShipmentsController < ApplicationController
  def confirm
    @shipment = Shipment.where(id: params[:id]).first

    unless current_user.has_a_shipping_address?
        # Trying to avoid having a query string, but right now would do the below:
        #   in reality, there's a bit more logic in my controller, handling the cases
        #   where i should redirect to the CardProfiles instead, or where I don't pass the
        #   shipment_id, and instead use the default shipment.
        redirect_to new_shipping_address_path(shipment_id: @shipment.id)
    end
  end
end

class ShippingAddressesController < ApplicationController
  def new
    @shipment = Shipment.where(id: params[:shipment_id]).first
  end

  def create
    @shipment = Shipment.where(id: params[:shipment_id]).first

    redirect_to confirm_shipment_path(@shipment)
  end
end 
```

* * *

【其实在收货地址之后还有一个`CardProfiles#new`页面需要填写】。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:09:28.420

尝试调用 render 而不是 redirect_to，并将 id 设置为实例变量。调整视图逻辑以提取该实例变量（如果存在）。

```
@shipment_id = @shipment.id
render new_shipping_address_path 
```

在视图中

```
<%= form_for @shipment_address do |f| %>
  <% if @shipment_id %>
    <%= hidden_field_tag :shipment_id, @shipment_id %>
  <% end %> 
```

我不完全了解您的视图逻辑，但举个例子。

# java - 为什么不能直接在java中转换类型？

> ID：14735606
> 
> 赞同：4
> 
> 时间：2013-02-06T17:52:37.397
> 
> 标签：java, android

在下面的代码片段中，为什么第 1 行和第 2 行会很好，而第 3 行会导致编译错误？前两行在功能上不等同于第三行吗？

```
Loader loader = getLoaderManager().getLoader(0);
PatientLoader patientLoader = (PatientLoader) loader;
patientLoader = (PatientLoader) getLoaderManager().getLoader(0); // ERROR! 
```

抛出这个：

```
java: somepath/Patient.java:99: inconvertible types
found   : android.content.Loader<java.lang.Object>
required: com.example.package.PatientLoader 
```

`PatientLoader`间接延伸`Loader<>`。

我来自 C# 背景，在 C# 中这不是问题，所以我可能遗漏了一些关于 Java 类型系统的内容。

`PatientLoader`延伸`AsyncTaskLoader<Cursor>`。任何熟悉 Android SDK 的人都会知道`AsyncTaskLoader<>`extends `Loader<>`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T18:18:07.807

它与括号的位置无关。这个问题与泛型有关：

例如编译失败：

```
Loader<Object> loader = getLoaderManager().getLoader(0);
PatientLoader ch = (PatientLoader)loader; // Will show compile error (Cannot cast from Loader<Object> to PatienLoader) 
```

但这会编译得很好：

```
Loader<?> loader = getLoaderManager().getLoader(0);
PatientLoader ch = (PatientLoader)loader; // Compiles fine. 
```

区别在于 <Object> 泛型与 <?> 泛型声明。

问题是 getLoader(int) 被定义为返回 Loader<D>。这意味着下面语句中的“getLoaderManager().getLoader()”被解释为 Loader<Object> 而不是 Loader<?>。

```
PatientLoader ch = (PatientLoader)getLoaderManager().getLoader(0); // Compile error. 
```

我认为这是 SDK 中的一个“错误”。方法 getLoader(int) 应该被定义为返回 Loader<?> 而不是 Loader<D>。

# sql - SQL 在查询中遇到多个计数问题

> ID：14735609
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:52:42.160
> 
> 标签：sql, postgresql

我已经提供了带有模式和示例数据的 sql fiddle。

[http://sqlfiddle.com/#!2/e9d22/7/0](http://sqlfiddle.com/#!2/e9d22/7/0)

如果我想知道泰国有多少个省和多少个城市。

```
Country Name | No. Provinces | No. Cities
  Thailand   |   77          |  1234 
```

我猜它需要使用多个 COUNT(*) 但我不知道如何使用它。

有人知道请提出解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:57:07.837

您需要使用`GROUP BY`和`COUNT`：

```
SELECT c.name, count(distinct p.id) provincecoutn, count(distinct city.id) citycount
FROM country c
  LEFT JOIN province p on c.id = p.country_id
  LEFT JOIN City on p.id = city.province_id
GROUP BY c.name 
```

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:58:10.093

试试这个：

```
SELECT
    C.Name, COUNT(DISTINCT P.Id) NoProvance, COUNT(CC.Id) NoCities
FROM country C
    JOIN province P
        ON C.Id = P.COUNTRY_ID
    JOIN city CC
        ON P.Id = CC.province_id
WHERE C.Name = 'Thailand'
GROUP BY C.Name 
```

**[SQL 小提琴演示](http://sqlfiddle.com/#!2/e9d22/16/0)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:43:02.557

在加入省份*之前*计算每个省份的城市可能更快：

```
SELECT c.name          AS "Country Name"
      ,count(p.id)     AS "No. Provinces"
      ,sum(ci.city_ct) AS "No. Cities" 
FROM   country       c
LEFT   JOIN province p ON p.country_id = c.id
LEFT   JOIN (
   SELECT province_id, count(*) AS city_ct FROM city GROUP BY 1
   ) ci ON ci.province_id = p.id
GROUP  BY 1 
```

[-> 用于 PostgreSQL 的 sqlfiddle](http://sqlfiddle.com/#!12/1ab81/1) (!)

# ios - 自定义 UITableView 部分标题，奇怪的行为

> ID：14735617
> 
> 赞同：0
> 
> 时间：2013-02-06T17:53:16.457
> 
> 标签：ios, objective-c, uitableview

我正在为 UITableView 中的部分标题使用自定义标题视图。这里有几个 dataSource 方法：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    SBTableViewHeader *header = [[SBTableViewHeader alloc] init];
    header.titleLabel.text = self.earnings;
    header.subtitleLabel.text = @"You have earned $23 today.";
    return header;
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    return 90;
} 
```

我知道我的标题视图应该是 90 点高，但是我得到了 90 点的标题视图加上另外 90 个空白点，它们覆盖了一些单元格。总共 180 个，在 Photoshop 中测量。

帮助！

更多信息：SBTableViewHeader 是 UIView 子类，使用 .xib。那里没什么特别的。文件的所有者设置为 SBTableViewHeader，其他所有内容似乎都已正确连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:05:04.657

*（来自评论：）*

您必须使用`initWithFrame`而不是`init`创建具有正确大小的视图。

`heightForHeaderInSection:`（和类似`heightForRowAtIndexPath`的）表视图仅用于计算标题和单元格位置、滚动指示器的大小等。

数据源（或委托）方法必须返回正确大小的单元格/视图，否则它们将与其他项目重叠。

# jquery - 如何使用带有 FixedColumns 和 TableTools 的 dataTables 在打印视图上查看固定列

> ID：14735629
> 
> 赞同：4
> 
> 时间：2013-02-06T17:53:53.403
> 
> 标签：jquery, datatables, tabletools

我正在使用带有 FixedColumns 和 TableTools 附加功能的 DataTables。

当我单击“打印”按钮查看打印预览时，未显示固定列，但 PDF 和 Excel 函数会打印所有列。

在这里您可以看到一个实时示例： http: [//live.datatables.net/epuxem/9](http://live.datatables.net/epuxem/9) （打印按钮是在实时示例中标记为“Imprimir”的按钮）

如何在打印视图中查看整个表格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T16:49:22.237

您可以在标题中添加一个单独的样式表，专门用于打印视图。在此样式表中，您可以将样式添加到数据表以显示列的固定行，以及您希望包含的任何其他打印视图相关样式。

添加到您的标题：

```
<link rel="stylesheet" type="text/css"href="/projName/css/print.css" media="print"> 
```

print.css 示例将行添加到数据表：

```
#tableId .tdClassNameForLeftBorder {
   border-left: 1px solid #D3D3D3;
} 
```

# c++ - 哪个标准措辞告诉我们 ref-to-const 临时生命周期延长只能“工作一次”？

> ID：14735630
> 
> 赞同：20
> 
> 时间：2013-02-06T17:53:56.087
> 
> 标签：c++

我在聊天中看到了以下示例：

```
#include <iostream>
struct foo { ~foo() { std::cout << "destroying!\n"; } };
const foo& func(const foo& a, const foo&) { return a; }

int main()
{
  foo x;
  const foo& y = func(foo(), x);
  std::cout << "main\n";
} 
```

[输出](http://ideone.com/TebAdJ)：

```
destroying!
main
destroying! 
```

它似乎表明`foo`临时的生命周期没有扩展到整个`main`，即使它被绑定到`const`该范围内的 ref-to- 。

那么，可以推测，延长寿命只能“工作一次”；也就是说，它在`func`' 的参数被初始化时应用，但不通过连续绑定传递。

我的解释正确吗？如果是这样（并且如果任何单独的段落直接适用）定义这种行为的标准措辞是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T17:53:56.087

你几乎是对的。这种行为实际上来自函数调用，而不是因为任何类型的“只工作一次”规则。

这是整个生命周期延长“功能”的措辞，相关规则以粗体强调：

> `[C++11: 12.2/5]:` *[..]*引用绑定到的临时对象或引用绑定到的子对象的完整对象的临时对象在引用的生命周期内持续存在，**除了**：
> 
> *   *[..]*
> *   **临时绑定到函数调用 (5.2.2) 中的引用参数将持续存在，直到包含调用的完整表达式完成。**
> *   *[..]*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-06T21:12:13.450

这是两个问题报告的主题，[http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1299](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1299)和[http://www.open-std.org/jtc1/sc22/ wg21/docs/cwg_active.html#1568](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1568)。

以前的问题报告，我是报告者，旨在涵盖所有这些引用绑定到临时对象的情况，但不打算延长生命周期。问题正文中的描述仅提到纯右值与临时表达式混淆（实际上决定了它们评估的生命周期是否延长）。但是左值和 xvalues 在标准中同样与这些混淆。发生这种情况的一个例子`static_cast`是问题编号#1568（其中“临时变量”的使用进一步混淆了问题）。

其实这个：

> 临时绑定到函数调用 (5.2.2) 中的引用参数将持续存在，直到包含调用的完整表达式完成。

与同一段落中的其他规则相矛盾。因为临时绑定到函数调用中的引用参数和本地自动引用变量*。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T17:58:09.900

这里适用的规则是常识。该标准措辞不佳，实际上确实保证了这一点。但是没有实用的方法来实现它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-29T18:09:28.193

可能我有点慢，但对我来说，通过阅读其他答案并不清楚这个问题的解决方案是什么。因此我修改了显示的代码并想为其他人总结一下：答案是，如果你访问，你会得到**未定义的行为**`y`！

运行此代码：

```
struct foo {
    int id;
    foo(int id) : id(id) { std::cout << "ctor " << id << std::endl; };
    ~foo() { std::cout << "dtor " << id << std::endl; }
};
const foo& func(const foo& a, const foo&) { return a; }

int main(int argc, char** argv) {
    foo x(1);
    const foo& y = func(foo(2), x);
    std::cout << "main " << y.id << std::endl;
    return 0;
} 
```

我的输出是：

```
ctor 1
ctor 2
dtor 2
main 2
dtor 1 
```

但这条线`main 2`是**未定义的行为**。

# c - 在 C 预处理器中是否可以进行部分宏应用程序/柯里化？

> ID：14735631
> 
> 赞同：3
> 
> 时间：2013-02-06T17:53:56.510
> 
> 标签：c, c-preprocessor, currying, partial-application

作为问题的一个例子，有没有办法`partialconcat`在下面的代码中实现宏？

```
#define apply(f, x) f(x)

apply(partialconcat(he),llo) //should produce hello 
```

编辑：

这是另一个示例，给定一个可变参数宏（请参阅[this answer](https://stackoverflow.com/a/14735113/864340) to another question`FOR_EACH`中的示例实现）。

假设我想在多个对象上调用一个成员，可能在另一个宏中用于更大的目的。我想要一个行为如下的宏 callMember：

```
FOR_EACH(callMember(someMemberFunction), a, b, c); 
```

生产

```
a.someMemberFunction(); b.someMemberFunction(); c.someMemberFunction(); 
```

这需要`callMember(someMember)`产生一个行为类似的宏

```
#define callMember_someMember(o) o.someMember() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-11T00:24:25.700

您可以使用 Vesa Karvonen 令人难以置信的“秩序”语言/库通过预处理器获得所需的*结果：* [http ://rosettacode.org/wiki/Order](http://rosettacode.org/wiki/Order)

*这是通过在预处理器本身之上*实现完整的第二种高级语言来实现的，支持诸如柯里化和一流的宏等。虽然它非常繁重，但重要的 Order 代码需要很长时间才能编译，因为 CPP 的设计目的不是以这种方式使用，而且大多数 C 编译器都无法处理它。它也非常脆弱：输入代码中的错误往往会产生难以理解的乱码输出。

但是，是的，它可以完成，并且在一次预处理程序中完成。它比您预期的要复杂得多*。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-17T08:17:25.780

使用高阶宏：

```
#define OBJECT_LIST(V) \
    V(a) \
    V(b) \
    V(c)

#define MEMBER_CALL(X) \
    X.some_func();

OBJECT_LIST(MEMBER_CALL) 
```

**输出**

```
$ g++ -E main.cc
# 1 "main.cc"
# 1 "<command-line>"
# 1 "/usr/include/stdc-predef.h" 1 3 4
# 1 "<command-line>" 2
# 1 "main.cc"
# 10 "main.cc"
a.some_func(); b.some_func(); c.some_func(); 
```

由于它是一个编译时循环，因此很难进行柯里化。该`OBJECT_LIST`宏定义了允许此列表的每个用户柯里化的参数数量。（默认）函数调用参数是定义的一部分。您可以自由选择不使用默认提供的参数或自己使用常量值。我无法找到减少预处理器中参数数量的适当方法。这一事实限制了该技术的普遍性。

```
#define OBJECT_LIST(V) \
    V(a, 1,2,3) \
    V(b, 4,5,6)

#define MEMBER_CALL(X, A1, A2, A3) \
    X.somefunc(A1, A2, A3);

#define CURRY_CALL(X, A1, A2, A3) \
    X.somefunc(A1, 2, 2);

#define NO_CURRY_CALL(X, A1, A2, A3) \
    X.xomefunc(A1);

OBJECT_LIST(MEMBER_CALL)
OBJECT_LIST(CURRY_CALL)
OBJECT_LIST(NO_CURRY_CALL) 
```

**输出：**

```
# 1 "main2.cc"
# 1 "<command-line>"
# 1 "/usr/include/stdc-predef.h" 1 3 4
# 1 "<command-line>" 2
# 1 "main2.cc"
# 12 "main2.cc"
a.somefunc(1, 2, 3); b.somefunc(4, 5, 6);
a.somefunc(1, 2, 2); b.somefunc(4, 2, 2);
a.somefunc(1); b.somefunc(4); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T18:01:27.140

C 预处理器“只是”一个简单的文本处理器。特别是，一个宏不能定义另一个宏；您不能`#define`从宏的扩展中创建一个。

我认为这意味着您问题的最后两行：

> 这需要`callMember(someMember)`产生一个行为类似的宏
> 
> `#define callMember_someMember(o) o.someMember()`

使用 C 预处理器的单个应用程序是无法实现的（并且，在一般情况下，您需要应用预处理器任意次数，具体取决于宏的定义方式）。

# ruby-on-rails - 将文件夹添加到资产管道路径？

> ID：14735635
> 
> 赞同：18
> 
> 时间：2013-02-06T17:54:00.730
> 
> 标签：ruby-on-rails, asset-pipeline

我们有一个我最近从 Rails 3.0 更新到 Rails 3.2 的 Rails 应用程序。此应用程序为多个客户提供服务。为了为每个客户定制它，我们有目录`app/themes`。里面有子模块。每个子模块都包含`locales/en.yml`、`views/layouts`、`views/controller_name`等内容。我们使用`prepend_view_path`来添加主题视图，并使用`I18n.load_path`来添加语言环境。我们正在考虑使用资产管道，这样我们就可以将所有客户端材料组合保留在公共目录之外，并将其包含在每个主题中。

有没有一种方法可以动态地告诉 Rails 加载我想要的主题/主题名称/资产文件夹？我们使用设置逻辑来设置哪个主题处于活动状态。因此，如果我将主题设置为“google”，`ApplicationController`则从路径加载文件：

```
app/themes/google/locales/*.yml
app/themes/google/views 
```

我想做的是拥有清单文件，

```
app/themes/google/assets/stylesheets/application.css 
```

易于访问布局，就像您在`app/views/layouts`文件中一样：

```
= stylesheet_link_tag "application" 
```

有没有办法我可以做到这一点？还是我们需要手动将资产移动到实际资产目录中？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-06T20:54:28.400

能够在application.rb中做到这一点：

```
require "#{Rails.root}/app/models/settings.rb"
config.assets.paths << "#{Rails.root}/app/themes/#{Settings.theme}/assets/stylesheets"
config.assets.paths << "#{Rails.root}/app/themes/#{Settings.theme}/assets/images"
config.assets.paths << "#{Rails.root}/app/themes/#{Settings.theme}/assets/javascripts" 
```

# python - 同一个类的类继承

> ID：14735636
> 
> 赞同：2
> 
> 时间：2013-02-06T17:54:00.387
> 
> 标签：python, class, inheritance, magic-methods

我对 python 2.7 非常陌生，并且已经为此寻找答案几个小时，所以我想我会在溢出时问我的第一个问题。我希望有一天能为社区增加一些东西，而不是一直潜伏>.<

我正在创建一个项目管理工具，您可以在其中定义一个**项目**下的 nessicary**基本任务**以及从基本任务继承的可能的其他**子任务。**我正在考虑最大的灵活性，最好在**Project Class**下创建一个通用的**Task** Class 。当用户想要创建子任务时，它继承自基本任务。我想为基本任务分配一个小时值，如果没有子任务是用户定义的，如果有子任务是由所有子任务定义的小时数之和定义的。

 ******到目前为止，这就是我所拥有的......：

```
class Task(self, superOBJ):
    #Define Tasks That Conform To SOW Here
    def __init__(self,cls,title):
        self.title=title
        self.description=""
        self.hours=None
    def Hours(self):
        if #NO SUBTASKS
            return self.hours
        else:
            return #SUM OF SUBTASKHOURS

    def SetHours(self,super,hours):
        self.hours=hours 
```

这就是我卡住的地方我有一些想法，但没有深入了解它们

所以我的问题是什么是处理继承的“好”方法？有没有什么神奇的方法可以帮上忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:10:19.360

看来您是在建议每个子任务应该是从`Task`. 如果是这样，我建议避免这种方法。您尝试创建的内容可以通过`Task`实例树轻松建模，其中每个任务对象都包含一个子任务（子任务）列表（可能为空）。然后，您可以通过递归遍历子任务列表来计算任务所需的时间，以累积特定任务下叶节点中的时间（即，`else`您的方法中的子句`Hours`）。

在某些时候，您可能有充分的理由定义派生自的新任务类别，`Task`但只有当它们具有与如何计算它们的时间有关的某种特殊行为时才应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:24:06.957

*为 方便 起见*, 我 将 为 你 的 "**基本 任务**"`Task`和*任务 的 基 类命名 类 .* `BaseTask`

```
class BaseTask(object):
    '''change object to BaseProject whenever you figure out what your `Project`
    class should be, or if you need it at all'''

    def __init__(self, title):
        self.title = title
        self.description=""

class Task(BaseTask):
    def __init__(self, title):
        super(Task, self).__init__(title)
        self.subtasks = []
        self.default_hours = 1

    @property
    def hours(self):
        if len(self.subtasks) < 1:
            return self.default_hours
        return sum(subtask.hours for subtask in self.subtasks)

class SubTask(BaseTask):
    def __init__(self, title):
        super(SubTask, self).__init__(title)
        self.hours = 0 
```

这基本上就是它应该的样子。您可以根据自己的喜好进行任何更改。*通常，您应该了解继承*和*组合*之间的区别。在这里，`Task`和`SubTask`都继承自`BaseTask`，但是`Task`由许多s*组成*`SubTask`******

# .net - Fluent NHibernate 有很多带有 Reference Composite Key

> ID：14735638
> 
> 赞同：0
> 
> 时间：2013-02-06T17:54:11.813
> 
> 标签：.net, fluent-nhibernate

我在这个问题上浪了很久。所以问题是 Fluent 在创建 DB shema 时生成错误：外键 (FK6FF7FBACF647ABE5:CheckListToAttributeLinkItem [ProductUID])) 的列数必须与引用的主键 (ProductAttributeLink [ProductUID, AttributeEntityUID]) 的列数相同。
这是我的实体。我按原样显示在那里（没有简称 Equals(object obj) 和 GetHashCode() 方法）首先：该实体将 Product 与其参数（属性）连接起来。所以这是一个多对多的“中间”表：

```
public class ProductAttributeLink
{
    public virtual Product Product { get; set; }
    public virtual AttributeEntity AttributeEntity { get; set; }
} 
```

第二：这个实体是继承者

```
public class CheckListProductAttributeLinkValue : ProductAttributeLink
{
    protected IList<CheckListToAttributeLinkItem> _values = new List<CheckListToAttributeLinkItem>();
    public virtual IEnumerable<CheckListToAttributeLinkItem> Values
    {
        get { return _values; }
    }
} 
```

第三：这个实体是属性项

```
public class AttributeEntityValueListItem
{
    public virtual Guid UID { get; set; }
    public virtual string Item { get; set; }
    public virtual AttributeEntity AttributeEntity { get; set; }
} 
```

我需要这个实体和以前的实体（CheckListProductAttributeLinkValue 和 AttributeEntityValueListItem）的多对多。所以我创建了“中间”实体

```
public class CheckListToAttributeLinkItem
{
    public virtual CheckListProductAttributeLinkValue CheckListProductAttributeLinkValue { get; set; }
    public virtual AttributeEntityValueListItem AttributeEntityValueListItem { get; set; }
} 
```

映射：

```
public class ProductAttributeLinkMap : ClassMap<ProductAttributeLink>
{
    public ProductAttributeLinkMap()
    { 
        CompositeId()
            .KeyReference(x => x.Product, "ProductUID")
            .KeyReference(x => x.AttributeEntity, "AttributeEntityUID");

        DiscriminateSubClassesOnColumn("ClassType").Not.Nullable();
    }
}

public class CheckListProductAttributeLinkValueMap :   SubclassMap<CheckListProductAttributeLinkValue>
{
    public CheckListProductAttributeLinkValueMap()
    {
        DiscriminatorValue(@"CheckLiskValue");
        HasMany(x => x.Values)
            .Access.CamelCaseField(Prefix.Underscore)
            .KeyColumns.Add("ProductUID")
            .KeyColumns.Add("AttributeEntityUID")
            .Inverse()
            .Cascade.All();
    }
}

public class CheckListToAttributeLinkItemMap : ClassMap<CheckListToAttributeLinkItem>
{
    public CheckListToAttributeLinkItemMap()
    {
        CompositeId()
            .KeyReference(x => x.CheckLinkProductAttributeLinkValue, "ProductUID", "AttributeEntityUID")
            .KeyReference(x => x.AttributeEntityValueListItem, "AttributeEntityValueListItemUID");
    }
}
public class AttributeEntityValueListItemMap : ClassMap<AttributeEntityValueListItem>
{
    public AttributeEntityValueListItemMap()
    {
        Id(x => x.UID).GeneratedBy.Guid();
        Map(x => x.Item);
        References(x => x.AttributeEntity);
    }
} 
```

# ajax - 使用 verifyclient 解决对 cfc 方法的 ajax 调用的 Coldfusion J2EE 会话

> ID：14735644
> 
> 赞同：1
> 
> 时间：2013-02-06T17:54:33.497
> 
> 标签：ajax, coldfusion, remote-access

我目前正在使用 CF 会话管理，并且一直在研究如何过渡到使用 J2EE 会话管理。在我尝试这样做时，向 CF cfc 远程方法发出的 ajax 请求（当 CFsession 管理设置为使用 J2EE 会话时）未能通过 verifyclient 授权。下面的代码在会话管理使用 CF 会话管理时有效。

我的假设是 _cf_clientid 不再是传递给远程方法的正确值 - 因为它是使用 cfid 和 cftoken 生成的。

如何成功实现 J2EE 会话管理并通过 verifyclient 使用远程 cfc 方法？还是不能做？使用 CF 标签 cfajaxproxy 不是一个选项。

下面的示例代码演示了如何使用 jQuery ajax 通过 verifyclient='true' 调用远程 cfc 方法，即使 CF 文档表明需要使用 cfajaxproxy。不是这种情况。（感谢 Ray Camden 和 DWMommy。）这让我相信，在使用 J2EE 会话时，也可能有一种解决方法来实现类似的方法来验证客户端。

提前致谢！

```
<script src="/plugins/jquery-1.7.2.min.js" type="text/javascript" language="Javascript"></script>
<cfajaximport />
<script>
$(function() {
            $.ajax({
                url: 'test.cfc',    
                type: 'get',
                dataType: 'json',
                data: {
                    method: 'sayHello',
                    yourname: 'Foo'
                    ,_cf_clientid: _cf_clientid
                },
                success: displaySearchResults
            });
});
</script>
<script>
    function displaySearchResults(res){
        $('#searchResults').html( res );
    }
</script>
<div id="searchResults"></div> 
```

测试.cfc

```
component{
    remote any function sayHello ( string yourname = 'anonymous') 
        returnformat='JSON' verifyclient='true'{
        return 'Hello ' & arguments.yourname;
    }
} 
```

# windows-phone-7 - Windows Phone 后台传输策略传输限制

> ID：14735650
> 
> 赞同：2
> 
> 时间：2013-02-06T17:55:04.343
> 
> 标签：windows-phone-7, background-transfer

在[Windows Phone 的后台文件传输中，](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202955%28v=vs.105%29.aspx)它说：

> 限制
> 
> 每个应用程序队列中的最大未完成请求数（包括活动和待处理请求）：25

但似乎限制是5。（根据我的调试和谷歌搜索）

这个操作系统版本在 7.1 和 8.0 之间有区别吗？

如果不同的版本有不同的限制，是否可以在不硬编码的情况下获得最大限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T15:08:57.450

你可以在这里阅读它

[Windows Phone 的后台文件传输](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202955%28v=vs.105%29.aspx)

# ios - SVGKit，如何获取所有图层

> ID：14735652
> 
> 赞同：1
> 
> 时间：2013-02-06T17:55:07.440
> 
> 标签：ios, svg

在使用 SVGKit 时，我或多或少地找到了自己的方法，使用如下代码：

```
CALayer *layer;
layer=[svgView.document layerWithIdentifier:@"path1730"]; 
```

但这是我知道要查看的图层的标识符的时候。有没有办法让我获得文档中所有标识符（层）的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:21:11.583

您将引用`svgView.document.layerTree`，这是子层的根。您需要递归地遍历子层以捕获所有子层。或者，如果您正在使用单个`SVGPathView`，您可以使用它的`enumerateChildLayersUsingBlock:`方法并向其传递一个块，该块将在视图中的每个子层上运行。

# c++ - 如何使用 ODBC (C++) 从 MS SQL 获取 nvarchar 作为字符串？

> ID：14735665
> 
> 赞同：0
> 
> 时间：2013-02-06T17:56:12.150
> 
> 标签：c++, string, odbc, nvarchar, sqlbindparameter

我试图从我的 SQL 数据库中提取一个字符串，但由于某种原因，我的参数是错误的，我不知道为什么。这是我的代码：

```
SQLHENV environHandle;
SQLHDBC connectHandle;
SQLHSTMT statement;
SQLCHAR* connectString = "MY_CONNECTION_STRING";
string path;
int jobID;  
SQLINTEGER pathstrlen = SQL_NTS;

SQLAllocHandle(SQL_HANDLE_ENV, SQL_NULL_HANDLE, &environHandle);
SQLSetEnvAttr(environHandle, SQL_ATTR_ODBC_VERSION, (SQLPOINTER)SQL_OV_ODBC3, SQL_IS_INTEGER);
SQLAllocHandle(SQL_HANDLE_DBC, environHandle, &connectHandle);
SQLDriverConnect(connectHandle, NULL, connectString, SQL_NTS, NULL, 1024, NULL, SQL_DRIVER_NOPROMPT);
SQLAllocHandle(SQL_HANDLE_STMT, connectHandle, &statement);

//THIS IS THE BINDPARAMETER WITH THE ISSUE...
SQLBindParameter(statement, 1, SQL_PARAM_OUTPUT, SQL_C_CHAR, SQL_VARCHAR, 400, 0, (SQLPOINTER)path.c_str(), path.length(), &pathstrlen);

SQLBindParameter(statement, 2, SQL_PARAM_OUTPUT, SQL_INTEGER, SQL_INTEGER, 10, 0, &jobID, 0, &pathstrlen);

SQLExecDirect(statement, (SQLCHAR*)"{CALL SP(?,?)}", SQL_NTS); 
```

它运行良好，但不会得到我请求的字符串信息，而第二个参数（获取整数）工作正常。我已经尝试将 ParameterType 更改为多个不同的东西，但我要么收到错误提示（例如，不推荐使用 SQL_LONGVARCHAR）。

在 SQL 中，我试图获取的数据如下：

```
@Path nvarchar(4000) OUT
set @Path = 'test' 
```

提前感谢任何可以阐明这一点的人。我整天都在拔头发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:23:53.833

ODBC 支持[Unicode 参数类型](http://msdn.microsoft.com/en-us/library/windows/desktop/ms714651%28v=vs.85%29.aspx)，因此分别使用`SQL_C_WCHAR`and`SQL_WVARCHAR`代替`SQL_C_CHAR`and `SQL_VARCHAR`。

你还有另外两个问题。

首先，您将 ANSI`string`作为参数传递。如果您使用的是 Unicode，则需要使用宽字符串 -`wstring`代替。

其次，您没有将有效的缓冲区传递给`SQLBindParameter`. [string.c_str()](http://www.cplusplus.com/reference/string/string/c_str/)返回的值是`const char*`一个只读缓冲区。将 hat 传递给需要可写缓冲区的函数是无效的 - 这样做会损坏您的字符串。但是，您不会在您的案例中看到任何损坏，因为您对`path.length()`WILL 的调用将返回零，因此`SQLBindParameter`永远不会返回任何数据。

您将需要声明`WCHAR`数组缓冲区并将其传递`SQLBindParameter`给它将为其提供有效缓冲区以将数据写入其中。`wstring`然后，如果您在 C++ 对象中需要它，您可以将该缓冲区传输到 a 。

所以是这样的：

```
WCHAR path[401];  // 401 - width of you column + 1 for the null terminator
SQLBindParameter(statement, 1, SQL_PARAM_OUTPUT, SQL_C_WCHAR, SQL_WVARCHAR, 400, 0,     (SQLPOINTER)path, sizeof(path), &pathstrlen); 
```

**编辑**

从查看[ODBC 数据转换表](http://msdn.microsoft.com/en-us/library/windows/desktop/ms716298%28v=vs.85%29.aspx)看来，如果您不想在应用程序中处理 Unicode 字符串，您应该能够让 ODBC 将该数据从 Unicode 转换为 ANSI。

```
char path[401];  // 401 - width of you column + 1 for the null terminator
SQLBindParameter(statement, 1, SQL_PARAM_OUTPUT, SQL_C_WCHAR, SQL_WVARCHAR, 400, 0,     (SQLPOINTER)path, sizeof(path), &pathstrlen); 
```

# php - Codeigniter 中的“gd-jpeg，libjpeg：可恢复错误：JPEG 文件过早结束”

> ID：14735666
> 
> 赞同：7
> 
> 时间：2013-02-06T17:56:19.160
> 
> 标签：php, codeigniter

我正在使用 CodeIgniter 并尝试创建图像缩略图。我在某些情况下是成功的，但在某些情况下却失败了。我收到以下错误 -

```
<< A PHP Error was encountered
Severity: Notice

Message: imagecreatefromjpeg(): gd-jpeg, libjpeg: recoverable error: Premature end of JPEG file

Filename: libraries/Image_lib.php

Line Number: 1155 >> 
```

我在“image_lib”库加载后使用了这个代码。

```
ini_set('gd.jpeg_ignore_warning', 1); 
```

任何解决方案？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:21:33.057

问题是该功能没有开启[错误抑制](http://php.net/manual/en/language.operators.errorcontrol.php)`imagecreatefromjpeg`

最好的选择是扩展基础库并重载`image_create_gd`方法

创建一个新文件`./application/libraries/MY_Image_lib.php`

```
<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

Class MY_Image_lib extends CI_Image_Lib {

function image_create_gd($path = '', $image_type = '')
{
    if ($path == '')
        $path = $this->full_src_path;

    if ($image_type == '')
        $image_type = $this->image_type;

    switch ($image_type)
    {
        case     1 :
                    if ( ! function_exists('imagecreatefromgif'))
                    {
                        $this->set_error(array('imglib_unsupported_imagecreate', 'imglib_gif_not_supported'));
                        return FALSE;
                    }

                    return @imagecreatefromgif($path);
            break;
        case 2 :
                    if ( ! function_exists('imagecreatefromjpeg'))
                    {
                        $this->set_error(array('imglib_unsupported_imagecreate', 'imglib_jpg_not_supported'));
                        return FALSE;
                    }

                    return @imagecreatefromjpeg($path);
            break;
        case 3 :
                    if ( ! function_exists('imagecreatefrompng'))
                    {
                        $this->set_error(array('imglib_unsupported_imagecreate', 'imglib_png_not_supported'));
                        return FALSE;
                    }

                    return @imagecreatefrompng($path);
            break;

    }

    $this->set_error(array('imglib_unsupported_imagecreate'));
    return FALSE;
}

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-30T13:38:13.227

尝试添加 @imagecreatefromjpeg($img) 而不是 imagecreatefromjpeg($img)

这里@是错误抑制器

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-08T17:47:37.747

我遇到了完全相同的问题。**在使用函数imagecreatefromjpeg()**进一步对图像进行后处理之前，我首先将图像数据存储在本地硬盘上。

在某些时候，本地存储的图像在存储过程中以及被**imagecreatefromjpeg($imagePath) 调用时被损坏；**PHP 警告： ***imagecreatefromjpeg(): gd-jpeg, libjpeg: 可恢复错误：JPEG 文件过早结束。***出现。

因此，为了解决 PHP 警告并弥补损坏的图像，我在 PHP 手册（[http://php.net/manual/en/function.imagecreatefromjpeg.php](http://php.net/manual/en/function.imagecreatefromjpeg.php)）中使用了明确定义的解决方案，请参阅函数**LoadJpeg($imgname )**

为了防止进一步的失败，我首先关注提供给**imagecreatefromjpeg()**函数的数据不完整的原因。就我而言，是网络洪水问题导致某些图像到达损坏。

长话短说，在尝试扩展基础库等之前，您可能需要检查到底提供了哪些内容到**imagecreatefromjpeg()函数中。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-10T22:13:32.933

当我收到此错误时，我检查了我的 JPG 文件是否已损坏。考虑检查你的。

# c - 为什么以下内容只包含 str-3

> ID：14735674
> 
> 赞同：0
> 
> 时间：2013-02-06T17:56:55.183
> 
> 标签：c

以下输出是“str-3”，但我希望它是“str-2,str-3”

如果我将 snprintf 更改为 sprintf 那么这将按我的预期工作；snprintf 和 sprintf 的行为不应该相同吗？

```
int main (int argc, char **argv)
{
    char str[64];

    str[0] = '\0';

    snprintf(str, 64, "%s%s,", str, "str-2");
    snprintf(str, 64, "%s%s,", str, "str-3");

    printf("%s\n",str);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T18:01:38.653

`snprintf`C 标准 (C99, 7.19.6.5) 中的描述说：

> 如果复制发生在重叠的对象之间，则行为未定义。

这就是这里发生的事情，因为`str`它被用作输入和输出。

同样的限制适用于`sprintf`. 它碰巧对你有用的事实只是一个意外，就像未定义的行为一样。

# mysql - 我可以在同一个mysql数据库中有希腊语、英语和汉语吗？

> ID：14735678
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:05.643
> 
> 标签：mysql, character-encoding

我有一个客户要求开发一个英文、希腊文和中文网站。虽然我确定 utf8_general_ci 可以用于希腊语和英语，但我不确定它是否适用于中文。

所以问题是：我可以对中文使用 utf8_general_ci 编码，还是我必须使用不同的编码制作单独的一组表？

问候，佐兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:05:03.360

`UTF-8`几乎支持所有语言，但更准确地说，它几乎支持所有脚本。它适用于英语、希腊语和中文。您可能需要在某些时候转换编码，因为有些东西对东方语言使用不同的编码，但只要它获得的所有内容都在`UTF-8`.

# java - Java：类型不匹配无法从元素类型 Object 转换为 MethodNode

> ID：14735684
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:16.290
> 
> 标签：java, java-bytecode-asm

您好，我在这段代码中有问题，这真的很困扰我，因为我不知道如何解决它，如果你们能帮助我，那就太好了！

```
public void execute(final String name, final ClassNode cn) {
    Updater.getInstance().getClasses().set("Animable", cn);
    addProcessor(new AddInterfaceProcessor(this, cn.name, ACCESSOR_DESC + "Animable"));
    for (final MethodNode mn : cn.methods) {
        if ((mn.access & (Opcodes.ACC_ABSTRACT | Opcodes.ACC_STATIC | Opcodes.ACC_NATIVE)) != 0 || !mn.desc.equals("()Z")) {
            continue;
        }
        final RIS ris = new RIS(mn);
        FieldInsnNode fin;
        for (int i = 0; i < 4; i++) {
            if ((fin = ris.next(FieldInsnNode.class, Opcodes.GETFIELD)) == null) {
                continue;
            }
            addProcessor(new AddGetterProcessor(this, "get" + ((i & 1) != 0 ? "Max" : "Min") + (char) (Math.max(0, Math.min(1, i - 1)) + 88), fin.desc, cn.name, fin.name, fin.desc, false));
        }
        break;
    }
} 
```

问题出在这部分：

```
for (final MethodNode mn : cn.methods) {
        if ((mn.access & (Opcodes.ACC_ABSTRACT | Opcodes.ACC_STATIC | Opcodes.ACC_NATIVE)) != 0 || !mn.desc.equals("()Z")) {
            continue;
        } 
```

我如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:05:19.313

的类型`cn.methods`必须是`Object[]`或`Iterable<Object>`。

您将不得不使用：

```
for (final Object obj : cn.methods) {
  MethodNode mn = (MethodNode)obj; 
```

或者修复`cn.methods`更具体的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:02:59.253

```
Objects mn and cn needs to be Initialized before u use in . 

for (final MethodNode mn : cn.methods) {
        if ((mn.access & (Opcodes.ACC_ABSTRACT | Opcodes.ACC_STATIC | Opcodes.ACC_NATIVE)) != 0 || !mn.desc.equals("()Z")) {
            continue;
        } 
```

# android - Android SDK - 列出蓝牙配置文件

> ID：14735686
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:23.360
> 
> 标签：android, testing, bluetooth, hid, profiles

在 Android 中，有没有办法列出蓝牙配置文件，甚至可以通过编码或至少在终端模拟器中查询它们？

我想要这样，因为大多数制造商不知道或不指定支持哪些配置文件，并且我想知道（未经测试）许多不同的设备，如果它们可以与 HID 配置文件连接。即使制造商声称支持，用户也可以安装不支持的自定义 ROM，反之亦然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T04:21:32.460

如果它是一部手机并支持 bluez，您可以使用“sdptool 浏览本地”进行检查

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T18:43:15.573

Not aware of anything in code that can get the list of supported profile, But if it is a Bluetooth device then it needs to have be Qualified and the Qualification information in [https://www.bluetooth.org/tpg/listings.cfm](https://www.bluetooth.org/tpg/listings.cfm) should show the device and list the profiles it supports. if a user modifies the ROM or anything like that then it cannot be called Bluetooth (since it voilates the Qualification sanctity)

# jquery - 您如何继续触发由另一个按钮触发的事件。

> ID：14735688
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:27.390
> 
> 标签：jquery, events, event-propagation

所以我有多个提交按钮。

```
 <input type="submit" id="addItem" value="Add Item" action="/addItem.php"/>
    <input type="submit" id="removeItem" value="Remove Item" action="/removeItem.php/>

    <input type="button" id="continue" value="Continue" style="display:none;/> 
```

比我有一个 jquery 事件

```
$("#addItem").click(function(event) {
     event.stopPropgation();

     $("#continue").show();
 }); 
```

现在，当我单击继续时，我希望能够继续触发说 addItem... （我可以在该页面上有更多按钮，但我不能使用 $(this).closest("form") 因为我这样做了不知道按下了哪个项目。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:17:11.557

您可以使用 jquery 来更改表单操作。允许您`submit`根据您的添加/删除切换按钮有所不同。

```
var myFormAction = "";

$("#addItem").click(function(event) {
     event.stopPropgation();

     myFormAction = "/addItem.php";

     $("#continue").show();
 });

$("#removeItem").click(function(event) {
     event.stopPropgation();

      myFormAction = "/removeItem.php";

     $("#continue").show();
 });

$("#continue").click(function(event) {
     //Open Dialog
 }); 
```

# r - 根据大多数非零数据按天对数据帧进行子集

> ID：14735689
> 
> 赞同：1
> 
> 时间：2013-02-06T17:57:39.057
> 
> 标签：r

我有一个示例数据框：

```
a <- c(1:6)
b <- c("05/12/2012 05:00","05/12/2012 06:00","06/12/2012 05:00",
   "06/12/2012 06:00", "07/12/2012 09:00","07/12/2012 07:00")
c <-c("0","0","0","1","1","1")
df1 <- data.frame(a,b,c,stringsAsFactors = FALSE) 
```

首先，我想确保 R 识别日期和时间格式，所以我使用了：

```
df1$b <- strptime(df1$b, "%d/%m/%Y %H:%M") 
```

然而，这不可能是正确的，因为 R 总是在我尝试查看新数据帧时中止我的会话。

假设这得到解决，我想根据数据框中包含“C”中不为零的最多数据的任何一天来获取数据的子集。在上面的例子中，我应该在 2012 年 12 月 7 日留下两个数据点。

我还有一个额外的相关问题。
如果我想在一天中的某个时间段（比如 07:00 和 08:00 之间）留下具有最​​多非零值的数据子集，我将如何去做？

对上述问题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:08:47.450

同意杰克。听起来像是 R 的损坏安装。首先要尝试的是删除`.Rdata`保存前一个会话结果的文件。它们在 Mac 和 Windows 中都是隐藏的，因此除非您“显示”“点文件”（系统文件），否则操作系统文件管理器（Finder.app 和 Windows 资源管理器）将不会显示它们。如何查找和删除该文件是特定于操作系统的任务。它将在您的工作目录中，您需要在 R 之外进行删除，因为一旦 R 启动，它将锁定对它的访问。也有可能获得损坏的`.history`文件，但根据我的经验，这通常不是问题的根源。

如果这不成功，您可能需要重新安装 R。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T02:51:00.250

好吧，好消息是我有一个答案给你，坏消息是你有更多的问题要问自己。首先是坏消息：您需要考虑如何处理具有相同数量的“c”非零值的多天。我不会在这个答案中解决这个问题。

现在好消息：这真的很简单。

**第 1 步**：首先，让我们重新格式化您的数据框。由于我们要更改几个变量的数据类型（b 为日期时间，c 为数字），我们需要创建一个新的数据框或重新校准旧的数据框。我更喜欢保留原件并创建一个新的，如下所示：

```
a <- df1$a
b <- strptime(df1$b, "%d/%m/%Y %H:%M")
c <- as.numeric(df1$c)
hour <- as.numeric(format(b, "%H"))
date <- format(b, "%x")

df2 <- data.frame(a, b, c, hour, date)

#   a                   b c hour      date
# 1 1 2012-12-05 05:00:00 0    5 12/5/2012
# 2 2 2012-12-05 06:00:00 0    6 12/5/2012
# 3 3 2012-12-06 05:00:00 0    5 12/6/2012
# 4 4 2012-12-06 06:00:00 1    6 12/6/2012
# 5 5 2012-12-07 09:00:00 1    9 12/7/2012
# 6 6 2012-12-07 07:00:00 1    7 12/7/2012 
```

请注意，我还添加了“小时”和“日期”变量。这是为了使我们的数据易于按这些字段排序，以供我们以后的聚合功能使用。

**第 2 步**：现在，让我们计算每天 06:00 到 08:00 之间有多少个非零值。由于我们使用的是“小时”值，这意味着“6”和“7”的值（代表 06:00 - 07:59）。

```
library(plyr)
df2 <- ddply(df2[df2$hour %in% 6:7,], .(date), mutate, non_zero=sum(c))

#   a                   b c hour      date non_zero
# 1 2 2012-12-05 06:00:00 0    6 12/5/2012        0
# 2 4 2012-12-06 06:00:00 1    6 12/6/2012        1
# 3 6 2012-12-07 07:00:00 1    7 12/7/2012        1 
```

'plyr' 包非常适合这样的事情。“ddply”包专门将数据帧作为输入和输出（因此称为“dd”），而“mutate”函数允许我们在添加额外列的同时保留所有数据。在这种情况下，我们想要 'c' 中的每一天的总和`.(date)`。在 data 参数中按小时对我们的数据进行子集处理`df2[df2$hour %in% 6:7,]`，它表示向我们显示小时值在集合 {6,7} 中的行。

**第 3 步**：最后一步是按非零值的最大数量对数据进行子集化。我们可以删除我们使用的额外列并回到我们原来的三列。

```
subset_df <- df2[df2$non_zero==max(df2$non_zero),1:3]

#   a                   b c
# 2 4 2012-12-06 06:00:00 1
# 3 6 2012-12-07 07:00:00 1 
```

祝你好运！

**更新**：应 OP 的要求，我正在编写一个新的“ddply”函数，该函数还将包含一个用于绘图的时间列。

```
df2 <- ddply(df2[df2$hour %in% 6:7,], .(date), mutate, non_zero=sum(c), plot_time=as.numeric(format(b, "%H")) + as.numeric(format(b, "%M")) / 60)
subset_df <- df2[df2$non_zero==max(df2$non_zero),c("a","b","c","plot_time")] 
```

我们需要将时间分解为一个连续变量，所以我选择了小时。以时间格式保留任何数据将需要我们稍后处理一些东西，并且使用字符串格式（如“hh：mm”）将限制您可以在其上使用的函数类型。连续数字是最灵活的，所以这里我们得到小时数`as.numeric(format(b, "%H"))`并将其添加到分钟数除以 60`as.numeric(format(b, "%M")) / 60`以将分钟转换为小时单位。另外，由于我们要处理更多的列，我已经切换了最后的子集语句来命名我们想要的列，而不是引用数字。一旦我处理了非连续顺序的列，我发现使用名称更容易调试。

# wordpress - 是否可以使用 wordpress API 将个性化自定义（数据库）数据添加到帖子中

> ID：14735696
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:53.933
> 
> 标签：wordpress, api

好的，那么我该如何简单而甜美地表达它。这是一个wordpress问题

```
 $post = array(
            'post_type'     => $type,
            'post_title'    => $title,
            'post_content'  => $content,
            'post_status'   => $status,
            'post_name' => $slug
        );
        wp_insert_post($post); 
```

上面的代码创建了一个帖子，但我希望我的帖子能够保存我自己选择的自定义键 => 值，而不是简单的 html“内容”。

我正在从外部 RSS 提要中提取多个信息值（标题、类别、摘要、缩略图 URL）。目前，我只是将其格式化为 html 并将其全部作为“内容”添加到页面中，而我更希望能够按原样存储这些信息，以便可以相对于'post' 它被附加到并稍后修改，一时兴起。

```
i.e $page = get_page_by_title('title');
    $summary = $page('summary); 
```

我想用自己的自定义值（标题、类别、摘要、拇指、网址）创建几个“帖子”。

我还想在一个“页面”上显示所有这些“帖子”，但这是另一个问题。

可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:05:18.910

您可以使用[add_post_meta](http://codex.wordpress.org/Function_Reference/add_post_meta)函数以及 的返回值`wp_insert_post`将自定义数据作为自定义字段插入。

```
 $post = array(
        'post_type'     => $type,
        'post_title'    => $title,
        'post_content'  => $content,
        'post_status'   => $status,
        'post_name' => $slug
    );
    $post_id = wp_insert_post($post);
    add_post_meta($post_id, "title", "Behind Foo Bars"); 
```

然后您可以使用[get_post_meta检索它](http://codex.wordpress.org/Function_Reference/get_post_meta)

```
get_post_meta($post_id, "title"); 
```

# sql - 用于数据库间连接的数据库工具

> ID：14735697
> 
> 赞同：0
> 
> 时间：2013-02-06T17:57:55.750
> 
> 标签：sql, sql-server, database

有人可以推荐一个数据库工具吗？我正在进行企业集成，特别是从 SQL Server 和 MySQL dbs 中进行选择。我想将 SQL Server 中的表与 MySQL 中的表连接起来进行比较和测试。如果可能的话可移植，我在运行它的机器上没有管理员。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:04:44.483

不确定 MySQL 方面，但只要您有可以连接到这两个实例的驱动程序，您就可以使用 SSIS（SQL 2005+）或 DTS（早于 SQL 2005）来执行此操作。您可以编写一个包，该包将从两个服务器中引入数据集并将结果存储在任何地方（db、平面文件等）。

您还可以编写一个 powershell 脚本来查询实例（假设您的计算机上安装了 SQL Server 和 MySQL 的驱动程序/客户端）。

# ios - 将 .dylib 或 .la 文件导入 iOS 项目

> ID：14735705
> 
> 赞同：0
> 
> 时间：2013-02-06T17:58:04.880
> 
> 标签：ios, xcode, compilation, cross-compiling, unixodbc

在阅读[了 Tristan 的这篇很棒的帖子后](https://stackoverflow.com/questions/11424846/cross-compiling-freetds-to-iphone)，他编译了 FreeTDS 以在 iOS 中使用，我尝试编译[UnixODBC](http://www.unixodbc.org/)以在 iOS 中使用。我能够编译它，这很棒。

但是，当我编译 FreeTDS 时，我有一个**.a**文件，我可以轻松地将它带入 XCode（以及一些**.h**文件）。这一次，编译器没有生成**.a**文件。相反，它生成了一个**.la**和一个**.dylib**文件。到目前为止，我还无法在我的 iOS 项目中使用这些文件。

如果我能完成以下任何一项，我认为我的问题将得到解决：
    1\. 重新编译 UnixODBC 以使其生成**.a**文件，或
    2\. 将**.la**或**.dylib**转换为**.a**文件，或
    3\. 将**.la**或**.dylib**导入我的项目，因此我可以像使用**.a**文件一样使用它。

到目前为止，我对如何做这些事情一无所知（或者是否有可能）。有人可以帮我吗？

谢谢！

-抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:23:31.880

`.dylib`文件是动态链接的库，而`.a`文件是静态链接的（只需谷歌这两个表达式）。`.la`文件现在无关紧要，它们不是必需的，它们不包含任何代码，

如果`configure`UnixODBC 的脚本支持它，您可以指定`--enable-static --disable-shared`选项以启用构建 .a 存档而不是 dylib。如果配置脚本不接受这些标志，那么您可以继续编译源文件（它将由配置完成），然后使用生成的 dylib 代替生成的 dylib，使用`ar`命令将`.o`目标文件放在一起形成静态存档。

# javascript - 浏览器窗口之间是否可以进行基于事件的通信？

> ID：14735706
> 
> 赞同：2
> 
> 时间：2013-02-06T17:58:06.657
> 
> 标签：javascript, jquery, local-storage

浏览器选项卡/窗口之间是否可以进行*基于事件的通信？*

我知道（至少在理论上）可以使用*local storage*。您能否提供这样做的代码的小示例？只需在一个选项卡中发送事件，然后在另一个选项卡中接收它。

是否有任何库/jquery-plugins 可以做到这一点？

（我知道我可以使用 cookie 在同一浏览器的窗口/选项卡之间进行通信；但这不是我需要的；我更喜欢基于事件的方法，我不想每毫秒重新检查 cookie 的状态）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T22:09:36.550

Localstorage 具有您可以订阅以同步其他页面的事件。

注意：如果您在窗口 A 中更新某个键的值，则该事件*不会*在窗口 A 中触发。它将在窗口 B 和 C 中触发。

这是一个演示： [http ://html5demos.com/storage-events](http://html5demos.com/storage-events)

在多个选项卡中打开此页面。更改输入上的值并查看它在 div 中的反映。

这是Javascript的代码：

```
var dataInput = document.getElementById('data'),
output = document.getElementById('fromEvent');

// handle updates to the storage-event-test  key in other windows
addEvent(window, 'storage', function (event) {
  if (event.key == 'storage-event-test') {
    output.innerHTML = event.newValue;
  }
});

// Update the storage-event-test key when the value on the input is changed
addEvent(dataInput, 'keyup', function () {
  localStorage.setItem('storage-event-test', this.value);
}); 
```

标记：

```
<div>
      <p>Your test data: <input type="text" name="data" value="" placeholder="change me" id="data" /> <small>(this is only echoed on <em>other</em> windows)</small></p>
      <p id="fromEvent">Waiting for data via <code>storage</code> event...</p>
</div> 
```

HTML 5 规范讨论了事件中传递的所有信息：

```
[Constructor(DOMString type, optional StorageEventInit eventInitDict)]
interface StorageEvent : Event {
  readonly attribute DOMString key;
  readonly attribute DOMString? oldValue;
  readonly attribute DOMString? newValue;
  readonly attribute DOMString url;
  readonly attribute Storage? storageArea;
};

dictionary StorageEventInit : EventInit {
  DOMString key;
  DOMString? oldValue;
  DOMString? newValue;
  DOMString url;
  Storage? storageArea;
}; 
```

来自： [http ://www.w3.org/TR/webstorage/#the-storage-event](http://www.w3.org/TR/webstorage/#the-storage-event)

使用此事件，您可以使其他页面在本地存储中的特定键更新时做出反应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T21:20:09.683

给[SignalRamp](https://github.com/TimHeckel/SignalRamp)一个机会。

您可以将任何可绑定的类名称附加到元素，以在 UI 中同步相应的 mousedown、mouseup、hover（mouseover、mouseout）或单击事件。

# .net - 如何通过 DragandDrop 只知道接口传递对象？

> ID：14735713
> 
> 赞同：0
> 
> 时间：2013-02-06T17:58:23.817
> 
> 标签：.net, vb.net, drag-and-drop

有很多对象 实现一个界面 只知道用户界面如何通过 DragandDrop 传递对象？

```
Public Class test_1
    Implements I_NAME
    Public Property Name As String Implements I_NAME.Name
End Class

Public Class WPF_TEST

Private Sub txt_drop_source_MouseDown(sender As Object, e As MouseButtonEventArgs) Handles      txt_drop_source.MouseDown
    Dim obj As New test_1
    DragDrop.DoDragDrop(Me, obj, DragDropEffects.All)
End Sub

Private Sub txt_drop_DragEnter(sender As Object, e As DragEventArgs) Handles txt_drop.DragEnter
    If e.Data.GetDataPresent(GetType(I_NAME)) Then
        e.Effects = DragDropEffects.All
    End If
End Sub

Private Sub txt_drop_Drop(sender As Object, e As DragEventArgs) Handles txt_drop.Drop
    Dim obj As Object = e.Data.GetData(GetType(I_NAME))
    If IsNothing(obj) = False Then
        MsgBox(obj.ToString)
    End If
End Sub 
```

结束类

# javascript - 从自定义播放器中提取 YouTube 标题

> ID：14735715
> 
> 赞同：1
> 
> 时间：2013-02-06T17:58:31.663
> 
> 标签：javascript, youtube

我正在构建一个自定义 YouTube 播放器以在网站上嵌入视频源。我是新手，我在网上搜索时运气不佳。

使用教程中的有用代码片段，我创建了一个主视频播放器和一个缩略图轮播，供用户单击以将该视频加载到播放器中。但是，唯一缺少的是我希望当前选择的视频的标题出现在 iframe 标记下方。对此有什么帮助吗？或者有人能指出我正确的方向吗？

这是我的脚本：

```
<script>
(function() {
    function createPlayer(jqe, video, options) {
        var ifr = $('iframe', jqe);
        if (ifr.length === 0) {
            ifr = $('<iframe scrolling="no">');
            ifr.addClass('player');
        }
        var src = 'http://www.youtube.com/embed/' + video.id;
        if (options.playopts) {
            src += '?';
            for (var k in options.playopts) {
                src+= k + '=' + options.playopts[k] + '&';
            }  
            src += '_a=b';
        }
        ifr.attr('src', src);
        jqe.append(ifr);  
    }

    function createCarousel(jqe, videos, options) {
        var car = $('div.carousel', jqe);
        if (car.length === 0) {
            car = $('<div>');
            car.addClass('carousel');
            jqe.append(car);

        }
        $.each(videos, function(i,video) {
            options.thumbnail(car, video, options); 
        });
    }

    function createThumbnail(jqe, video, options) {
        var imgurl = video.thumbnails[0].url;
        var img = $('img[src="' + imgurl + '"]');
        if (img.length !== 0) return;
        img = $('<img>');    
        img.addClass('thumbnail');
        jqe.append(img);
        img.attr('src', imgurl);
        img.attr('title', video.title);
        img.click(function() {
            options.player(options.maindiv, video, $.extend(true,{},options,{playopts:{autoplay:1}}));
        });
    }

    var defoptions = {
        autoplay: false,
        user: null,
        player: createPlayer,
        carousel: createCarousel,
        thumbnail: createThumbnail,
        loaded: function() {},
        playopts: {
            autoplay: 0,
            egm: 1,
            autohide: 1,
            fs: 1,
            showinfo: 0
        }
    };

    $.fn.extend({
        youTubeChannel: function(options) {
            var md = $(this);
            md.addClass('youtube');
            var allopts = $.extend(true, {}, defoptions, options);
            allopts.maindiv = md;
            $.getJSON('http://gdata.youtube.com/feeds/users/' + allopts.user + '/uploads?alt=json-in-script&format=5&callback=?', null, function(data) {
                var feed = data.feed;
                var videos = [];
                $.each(feed.entry, function(i, entry) {
                    var video = {
                        title: entry.title.$t,
                        id: entry.id.$t.match('[^/]*$'),
                        thumbnails: entry.media$group.media$thumbnail
                    };
                    videos.push(video);
                });
                allopts.allvideos = videos;
                allopts.carousel(md, videos, allopts);
                allopts.player(md, videos[0], allopts);
                allopts.loaded(videos, allopts);
            });
        } 
    });

})();

$(function() {
    $('#player').youTubeChannel({user:'oklahomadaily'});
});

</script> 
```

这是我的 HTML：

```
<div class="video">
    <div class="boxTitle">Featured videos</div>
    <div id="player"></div>
    <div id="title"><p class="multimedia">Could not find a description...</p></div>
</div> 
```

感谢您的耐心和帮助。

# jsf - 如何维护 ajax 调用的参数？

> ID：14735726
> 
> 赞同：2
> 
> 时间：2013-02-06T17:59:07.623
> 
> 标签：jsf, primefaces

每当我进行 ajax 调用时，我的 URL 参数都会过期。我所做的解决方法是在每个按钮内传递一个参数请求，例如：

```
<p:commandLink value="Submit" actionListener="#{mybean.dosomething}">
   <f:param name="foo" value="#{mybean.bar}"/>
</p:commandLink> 
```

但是，在某些情况下，我无法执行上述解决方法。例如，当我使用 primefaces rowEditEvent 时：

```
<p:ajax event="rowEditCancel" listener="#{mybean.onCancel}"/> 
```

当我进行此 ajax 调用时，该参数过期，并在调用之前导致错误，`#{mybean.onCance}`因为我正在从 URL 中的参数读取数据表的数据。

那么当我进行这样的 ajax 调用时，如何维护参数值呢？

PS：mybean 是 ViewScoped

**问题扩展：**

已经解决了`<o:form>`部分问题，但现在我无法在表格内发送参数以在表格内进行动态图像流。请参阅以下内容：

```
<p:dataTable value="#{mybean.data}" var="var">
    <p:column headerText="Thumbnail">
        <p:graphicImage value="#{streamer.thumbnail}">
            <f:param name="id" value="#{var.id}"/>
        </p:graphicImage>
    </p:column>
</p:dataTable> 
```

Streamer Bean (RequestScoped):

```
 public StreamedContent getThumbnail() throws IOException {
      FacesContext context = FacesContext.getCurrentInstance();
      if (context.getRenderResponse()) {
          return new DefaultStreamedContent();
      }
      else {
         String string = context.getExternalContext().getRequestParameterMap().get("id");
        Long id = Long.parseLong(idString);
        MyImage img = (MyImage) service.find(MyImage.class, id);//get resource
        StreamedContent sc = new DefaultStreamedContent(img.getInputStream(), "image/jpg", img.getName());
        return sc;
        }
 } 
```

这里`string`始终为空且未传递参数导致错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:24:06.767

将其注册为`<f:viewParam>`

```
<f:viewParam name="foo" value="#{mybean.bar}" /> 
```

而不是`<h:form>`, 使用[OmniFaces](http://omnifaces.org) （它在幕后使用自定义[`<o:form>`](http://showcase.omnifaces.org/components/form)实现，该实现自动收集所有视图参数并将它们附加到用作表单操作 URL 的方法的结果）：`includeViewParams="true"``ViewHandler``getActionURL()`

```
<o:form includeViewParams="true">
    ...
</o:form> 
```

`<f:param>`这样，所有视图参数都包含在表单的操作 URL 中，因此将以通常的方式作为请求参数结束，而无需在内部`<p:ajax>`(and )摆弄和毫无头绪`<f:ajax>`。

# border - 边界半径未显示

> ID：14735727
> 
> 赞同：1
> 
> 时间：2013-02-06T17:59:07.767
> 
> 标签：border, css

[http://thc-cup.ucoz.com/forum/2-1-1](http://thc-cup.ucoz.com/forum/2-1-1)

可以看到，左边在内容背景和边框处有一个半径，但左边没有！在添加到 div 样式后，我设法得到了左边的那个： display:inline-block; 但这会弄乱盒子并将其移动到左块下方。由于这是一个论坛（我的链接），我无法编辑 html，但我可以编辑论坛的 CSS。

以下是这些块的样式：

```
.postTdInfo { //Left block
    display: inline-block;
    margin: 0px 0px 0px 35px;
    padding: 1px;
    border: 1px solid #cfcfcf;
    background: #e0e0e0;
    border-radius: 5px;
}
.posttdMessage { //Right block
    margin: 0px 0px 0px 0px;
    padding: 25px;
    border: 1px solid #cfcfcf;
    background: #e0e0e0;
    border-radius: 25px; 
```

我整天都在寻找解决方案，但似乎找不到。有没有办法改变 CSS 以使块接受边框半径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:27:01.790

**编辑：我的第一个答案没有解决问题。**

问题是您正在处理一个`td`元素，该元素的`display`属性默认设置为`table`. 要么添加`display: block;`到`.posttdMessage`，或者，如果这导致问题，`<div>`直接在表格单元格内添加另一个元素，并使用圆角边框设置样式。

# raphael - 拉斐尔移动套装

> ID：14735731
> 
> 赞同：1
> 
> 时间：2013-02-06T17:59:22.593
> 
> 标签：raphael

我使用两个矩形制作烛台并制作一组。然后我制作了 100 个烛台，然后将其设为一组。当我尝试移动所有 100 根烛台时，它们要么都移动到一个坐标，要么都正确移动，但所有烛台都移动到了蜡烛的边缘。

我怎样才能移动整个集合，但保留烛台的内部变换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T20:21:52.080

可以分别使用“...Tx,y”和“Tx,y...”的形式将变换“附加”或“预先附加”到一组 Raphael 对象。在您的示例中，前置可能会更实用，因为您希望视图框中的集合的绝对移动发生在基于每个元素分配的任何其他转换之前。

你应该能够做到这一点或类似的事情：

```
var shift_x = 100, shift_y = 50;
set.attr( { transform: "T" + shift_x + "," + shift_y + "..." } ); 
```

[您会在该函数的正式文档中](http://raphaeljs.com/reference.html#Element.transform)注意到一些关于转换前置/附加的省略注释，遗憾的是，它还有很多不足之处。

# wcf - 通过 SOAP Web 服务传输 LARGE 数据包的最佳方式

> ID：14735732
> 
> 赞同：0
> 
> 时间：2013-02-06T17:59:26.203
> 
> 标签：wcf, soap, asmx

我们正在使用 .NET 3.5 应用程序，该应用程序正在快速接近旧状态。我们有一个现有的 SOAP 服务，它从我们的数据库中读取记录并将它们保存到第三方 MS SQL 数据库中，以单个批次发送所有数据行。

这一直运作良好，但最近我们接收了一个比以往任何时候都大得多的客户，而且他们正在传输更大的批次，以至于他们已经开始失败。我们已经提高了 IIS 中的超时和最大内存大小，并在 web.config 中最大化了 maxRequestLength，但我们仍然遇到了大小问题。

所以，我知道从长远来看，我们应该考虑从 SOAP 转移到 WCF，并且计划正在制定中。但与此同时，我们需要对这个新客户进行短期修复。当然，为了让业务和销售人员满意，我们需要它很快。

我想知道最佳实践方法可能是什么。最初我在想这样的事情，但我可能在盒子里想得太多了：

1.  建立一个我们不想一次尝试同步所有记录的基准标记。

2.  在尝试保存数据之前，请对照该基准检查记录数

3.  如果它高于它，则将传输分解为低于该基准的部分。SELECT TOP 10000 * FROM table WHERE sent = false 等，如果基准是 10000。那么一旦提交，这些记录的更新发送为 true。重复。

4.  显然，这会减慢进程，所以为了处理用户体验，我们可能想要折腾一个状态栏，以便他们可以看到进度。

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T21:07:48.567

除了 John 的评论之外，您还应该考虑是否以最佳方式解决问题。

看起来您正在通过调用 Web 服务来触发 2 个数据库之间的单向同步。这种方法会导致您遇到的超时和内存问题。

如果您的目标是进行单向同步，您可以使用免费的框架，例如 Microsoft 的同步框架：http: [//msdn.microsoft.com/en-US/sync](http://msdn.microsoft.com/en-US/sync)

# java - 在 Kindle KDK 中设计 UI（扩展 java.awt）

> ID：14735734
> 
> 赞同：2
> 
> 时间：2013-02-06T17:59:39.947
> 
> 标签：java, android-layout, awt, kindle, kindle-kdk

我有一些 Android 开发经验，现在我决定学习一些新的东西 - 为 Kindle 开发（不是基于 Android 的 Kindle Fire）。

Amazon 提供[KDK](http://kdk-javadocs.s3.amazonaws.com/1.3/index.html) + [Personal Basis Profile 1.1.2 (JSR 217)](http://docs.oracle.com/javame/config/cdc/ref-impl/pbp1.1.2/jsr217/index.html)作为平台。

我的问题是，如何设计 UI。我对awt没有任何经验（只是在java swing中做了一些应用程序），但这似乎不是一个大问题，因为它很简单......主要问题是'替换'android's `ListView`。

我尝试使用名为`KPages`. `KLabel`但是，除了页面模型之外，我无法放入任何其他内容...

```
 PageProvider pp = PageProviders.createKBoxLayoutProvider(KBoxLayout.PAGE_AXIS);
    final KPages pages = new KPages(pp);

    for (int i = 0; i < 40; i++) {
        final KPanel listItem = new KPanel();
        // listItem.add(new KLabelMultiline("label numero " + i + " is not very good, because it will be displayed over more than one line and 'pages' won't be able to deal with it"));
        listItem.add(new KLabel("label numero " + i + " is very good, because it won't be displayed over more than one line and 'pages' will be able to deal with it"));
        listItem.add(new KButton("read"));
        listItem.add(new KButton("edit"));
        pages.addItem(listItem);
    }

    context.getRootContainer().add(pages); 
```

上面的示例代码显示了我列出一些项目的努力。`KPages`只有在添加`KLabel`using时才能正常工作`pages.addItem()`。仅插入`KLabelMultiline`会导致分页功能发挥作用（而不是显示标签 0-12，而是在单行中“显示”0-26，但 kindle 的屏幕仅显示 14-26）。尝试插入`KPanel`带有标签和 2 个按钮的整体会导致列出标签，然后为每个项目列出一个空行，没有任何按钮...显示相同`KPanel`的外部页面工作正常 - 我可以看到标签和两个按钮...

我几乎可以肯定遗漏了一些东西是我的错，但是由于 KDK 上可用的信息很少，我无法找到它......有人可以帮我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:14:57.647

尝试覆盖对构造函数的`getPreferredSize`、`getMinimumSize`和`getMaximumSize`调用`KPanel`。设置`width`并设置`height`为您的屏幕尺寸。

```
final KPanel listItem = new KPanel() {
  public Dimension getPreferredSize() {
    return new Dimension(width, height);
  }
  public Dimension getMinimumSize() {
    return new Dimension(width, height);
  }
  public Dimension getMaximumSize() {
    return new Dimension(width, height);
  }
}; 
```

# php - 为什么 ' 和 " 在 php 中表现不同

> ID：14735740
> 
> 赞同：-3
> 
> 时间：2013-02-06T17:59:59.120
> 
> 标签：php, echo

```
echo '\n....'.$_SESSION['count'].' rows inserted.........................\n';
no new line using this

echo "\n....".$_SESSION['count']." rows inserted.........................\n";
gives new line with this 
```

为什么'和'表现不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:00:41.213

`'`用于文字。`"`用于解析文本。

请参阅[PHP 手册字符串](http://php.net/manual/en/language.types.string.php)

> 与双引号和heredoc 语法不同，特殊字符的变量和转义序列**在出现在单引号字符串中时不会被扩展。**

# java - 如何为 RESTful 后端使用 OAuth 安全性

> ID：14735742
> 
> 赞同：0
> 
> 时间：2013-02-06T18:00:03.953
> 
> 标签：java, rest, oauth

我有一个使用 REST 请求调用访问的 REST 后端。这个后端有一个瘦客户端前端和一个使用 REST api 的插件。

目前，安全性是使用 HTTP 基本身份验证实现的。

现在我想实现 oauth 作为安全机制。我已阅读有关 oauth 的所有内容，但找不到使用 oauth 保护 RESTful 后端的工作示例。

请任何人指导我如何在我的应用程序中实现 oauth 安全性？

# .net - 将行颜色绑定到 MVVM 中的属性（取决于行中的数据）

> ID：14735744
> 
> 赞同：1
> 
> 时间：2013-02-06T18:00:17.373
> 
> 标签：.net, wpf, silverlight, mvvm, datagrid

我有一个who绑定到我`datagrid`的.`itemsSource``Customer``ViewModel`

每个`Customer`对象都有一个布尔属性`IsComplete`（不是数据网格中的可见列）。`IsComplete`如果为假，如何将整行染成红色？

我是 MVVM 概念的新手，所以我仍然无法理解它。到目前为止，我看到的示例似乎并未根据单个属性的内容为整行着色。

如果需要的话，我愿意重构。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:03:14.953

我会尝试为此使用[RowStyleSelector](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.rowstyleselector.aspx)。它允许您定义不同的行样式，并根据该行中的数据每行选择一个。

本质上，您定义了一个继承`StyleSelector`并覆盖该`SelectStyle`方法的类。这就是您放置逻辑以根据行数据选择样式的地方 -`item`包含行数据：

```
public class MyStyleSelector : StyleSelector
{
    public override Style SelectStyle(object item, DependencyObject container)
    {
        if (item is Customer)
        {
            return ((Customer)item).IsComplete ? 
                App.Current.Resources["RedRowStyle"] :
                App.Current.Resources["NormalRowStyle"]
        }
        return base.SelectStyle(item, container);
    }
} 
```

将资源添加到应用程序的资源字典中：

```
<Application.Resources>
    <Style TargetType="DataGridRow" x:Key="NormalRowStyle">
    </Style>
    <Style TargetType="DataGridRow" BasedOn="{StaticResource NormalRowStyle}" x:Key="RedRowStyle">
        <Setter Property="Background" Value="Red" />
    </Style>
</Application.Resources> 
```

然后，您通过静态资源引用选择器，例如：

```
<Window>
    <Window.Resources>
        <local:MyStyleSelector x:Key="MyStyleSelector" />
    </Window.Resources>

    <DataGrid RowStyleSelector="{StaticResource MyStyleSelector}">
        <!-- ... -->
    </DataGrid>
</Window> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:09:25.907

在 MVVM 样式中，创建一个 CustomerViewModel 并定义属性 CustomerColor（与 IsComplete 属性值相关）。

试试这个：

```
<DataGrid>
    <DataGrid.RowStyle>
        <Style TargetType="DataGridRow">
            <Setter Property="Background">
               <Setter.Value>
                   <SolidColorBrush Color="{Binding CustomerColor}"/>
              </Setter.Value>
            </Setter>
        </Style>
    </DataGrid.RowStyle>
</DataGrid> 
```

# javascript - Bootstrap Responsive Collapsed Submenu has fixed height on first collapse

> ID：14735747
> 
> 赞同：7
> 
> 时间：2013-02-06T18:00:37.640
> 
> 标签：javascript, css, twitter-bootstrap

This problem can be exhibited in all (that I know of) Twitter Bootstrap versions. So, I have a navbar and when the screen is smaller, it becomes a collapsable tray. This behaviour can be seen on the bootstrap demo site. I also have submenus, which appear collapsed on the initial navbar expansion. The problem is, on the first collapse, the collapsable gets an explicit height set. If you close and expand again, the collapsable gets a `height:auto;`

So, when I click a submenu item, the dropdown is expanded, but it overflows due to the height being explicitly set.

My attempted solution was adding:

```
$(function() {
  $('.nav-collapse').on({
    shown: function() {
      $(this).css('height', 'auto');
    },

    hidden: function() {
      $(this).css('height', '0px');
    }
  });
}); 
```

This doesn't seem to affect it at all, I've deleted that code and it still has the same effect. If a JS Fiddle would help, I'd be happy to provide one, but you can see all of this on the Bootstrap demo site.

Thanks in advance, Charles.

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-06T22:45:44.517

It bothered me a little, and after some searching, I found that the problem can be solved by adding the `.collapse` class to the `.nav-collapse` element.

[Working demo (jsfiddle)](http://jsfiddle.net/Sherbrow/nczJF/52/)

One of those time when we just say *Meh.. I should have followed the doc to the letter* (see [`Responsive navbar`](http://twitter.github.com/bootstrap/components.html#navbar)):

```
<div class="nav-collapse collapse">
    <!-- .nav, .navbar-search, .navbar-form, etc -->
</div> 
```

* * *

For posterity :

Found out thanks to this issue : [https://github.com/twitter/bootstrap/issues/3788](https://github.com/twitter/bootstrap/issues/3788)

I'm not sure if it really is related, but my debugging showed the problem on the first transition height resetting anyway ([source](https://github.com/twitter/bootstrap/blob/v2.2.2/js/bootstrap-collapse.js#L70)) :

```
$.support.transition && this.$element[dimension](this.$element[0][scroll]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:09:32.823

Bootstrap is setting the element style height to 280px on initialization of the collapse element.

I added this JQuery line in my ready() function right after my call to .collapse()

```
$("#avail_detail").collapse();
$("#avail_detail").css("height","auto"); 
```

And, now things behave as I expect.

# jena - 使用 Jena 在 protege 中添加 DataProperty

> ID：14735749
> 
> 赞同：1
> 
> 时间：2013-02-06T18:00:42.803
> 
> 标签：jena

任何人都知道如何在 Jena 的 protege 中添加数据属性。我可以轻松地添加对象属性，但对于数据属性不知何故不起作用，而不是在数据属性断言中添加属性，而是添加注释。也许我的代码有问题？

代码

```
 OntModel model = ModelFactory.createOntologyModel(OntModelSpec.OWL_MEM_MICRO_RULE_INF, null);

            String NS = "http://www.semanticweb.org/thato/ontologies/2012/10/9/thesis_ontology#";
            model.read(in, null);
            in.close();

            OntClass ApplicationModel = model.getOntClass(NS + "ApplicationModel");

            Individual AM20 = model.createIndividual(NS + xmlDoc.getDocumentElement().getAttribute("guid")+ theAttribute.getNodeValue(), ApplicationModel);

            Individual dom = model.getIndividual(NS + domainElement.getAttribute(attrDomain));
            Individual pha = model.getIndividual(NS + neededString.trim());
            Individual lev =  model.getIndividual(NS + lodElement.getAttribute(attrLOD));
            Individual typ = model.getIndividual(NS + theAttrType.getNodeValue());

            Property urlAdd =  model.createProperty(NS + "http://xxxxx.com");

            // Create Object Property
            ObjectProperty domain = model.createObjectProperty(NS +"hasDomain");
            ObjectProperty fase = model.createObjectProperty(NS +"hasPhase");
            ObjectProperty lod = model.createObjectProperty(NS +"hasLevelOfDetail");
            ObjectProperty type = model.createObjectProperty(NS +"hasType");

            model.add(AM20, domain, dom);
            model.add(AM20, fase, pha);
            model.add(AM20, lod, lev);
            model.add(AM20, type, typ);

            // Create Data Property
            DatatypeProperty url = model.createDatatypeProperty(NS + "hasURL");

            model.add(AM20, url, urlAdd );

            PrintStream p= new PrintStream("./src/thesis_ontology.owl");
            model.write(p, "RDF/XML-ABBREV", null);
            p.close(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:46:50.380

我想我发现了问题。希望有一天它可以帮助某人：D

代码应该是这样的

```
 OntClass ApplicationModel = model.getOntClass(NS + "ApplicationModel");

            Individual AM20 = model.createIndividual(NS + xmlDoc.getDocumentElement().getAttribute("guid")+ theAttribute.getNodeValue(), ApplicationModel);

            Individual dom = model.getIndividual(NS + domainElement.getAttribute(attrDomain));
            Individual pha = model.getIndividual(NS + neededString.trim());
            Individual lev =  model.getIndividual(NS + lodElement.getAttribute(attrLOD));
            Individual typ = model.getIndividual(NS + theAttrType.getNodeValue());

            // Create Object Property
            ObjectProperty domain = model.createObjectProperty(NS +"hasDomain");
            ObjectProperty fase = model.createObjectProperty(NS +"hasPhase");
            ObjectProperty lod = model.createObjectProperty(NS +"hasLevelOfDetail");
            ObjectProperty type = model.createObjectProperty(NS +"hasType");

            model.add(AM20, domain, dom);
            model.add(AM20, fase, pha);
            model.add(AM20, lod, lev);
            model.add(AM20, type, typ);

            // Create Data Property
            DatatypeProperty url = model.createDatatypeProperty(NS + "hasURL");

            model.add(AM20, url, "http://..."); 
```

# .net - 如何使用对称密钥配置 Microsoft JWT？

> ID：14735753
> 
> 赞同：17
> 
> 时间：2013-02-06T18:00:52.380
> 
> 标签：.net, wif, jwt

我正在尝试将我的 ASP.NET 应用程序配置为接受使用对称密钥签名的 JSON Web 令牌 (JWT)。STS 无法为此使用证书，因此我们正在使用它们的对称密钥支持。

最后，我使用的是[Microsoft 的 JWT Developer Preview](http://blogs.msdn.com/b/vbertocci/archive/2012/11/20/introducing-the-developer-preview-of-the-json-web-token-handler-for-the-microsoft-net-framework-4-5.aspx)。不幸的是，我还没有看到任何关于如何将其与对称密钥一起使用的示例。在使用各种工具进行了一些挖掘之后，我发现`NamedKeyIssuerTokenResolver`并发现我*可以*将其配置为使用对称密钥。例如：

```
<securityTokenHandlers>
  <add type="Microsoft.IdentityModel.Tokens.JWT.JWTSecurityTokenHandler,Microsoft.IdentityModel.Tokens.JWT" />
  <securityTokenHandlerConfiguration>
    <certificateValidation certificateValidationMode="PeerTrust" />
    <issuerTokenResolver
      type="Microsoft.IdentityModel.Tokens.JWT.NamedKeyIssuerTokenResolver,
        Microsoft.IdentityModel.Tokens.JWT">
      <securityKey
          symmetricKey="+zqf97FD/xyzzyplugh42ploverFeeFieFoeFooxqjE="
             name="https://localhost/TestRelyingParty" />
    </issuerTokenResolver>
  </securityTokenHandlerConfiguration>
</securityTokenHandlers> 
```

我不完全确定我应该在那里使用什么`name`。应该是受众Uri，还是发行者Uri？无论如何，我知道如果我不包含 a `name`，我的程序启动时会出现异常，因为该`securityKey`元素需要该属性。

不管怎样，这仍然不能解决问题。对 STS 进行身份验证后，出现以下异常：

```
[SecurityTokenValidationException: JWT10310: Unable to validate signature. validationParameters.SigningTokenResolver type: 'Microsoft.IdentityModel.Tokens.JWT.NamedKeyIssuerTokenResolver', was unable to resolve key to a token.
The SecurityKeyIdentifier is: 
'SecurityKeyIdentifier
    (
    IsReadOnly = False,
    Count = 1,
    Clause[0] = Microsoft.IdentityModel.Tokens.JWT.NamedKeyIdentifierClause
    )
'. validationParameters.SigningToken was null.]
   Microsoft.IdentityModel.Tokens.JWT.JWTSecurityTokenHandler.ValidateSignature(JWTSecurityToken jwt, TokenValidationParameters validationParameters) +2111
   Microsoft.IdentityModel.Tokens.JWT.JWTSecurityTokenHandler.ValidateToken(JWTSecurityToken jwt, TokenValidationParameters validationParameters) +138
   Microsoft.IdentityModel.Tokens.JWT.JWTSecurityTokenHandler.ValidateToken(SecurityToken token) +599
   System.IdentityModel.Tokens.SecurityTokenHandlerCollection.ValidateToken(SecurityToken token) +135
   System.IdentityModel.Services.TokenReceiver.AuthenticateToken(SecurityToken token, Boolean ensureBearerToken, String endpointUri) +117
   System.IdentityModel.Services.WSFederationAuthenticationModule.SignInWithResponseMessage(HttpRequestBase request) +698
   System.IdentityModel.Services.WSFederationAuthenticationModule.OnAuthenticateRequest(Object sender, EventArgs args) +123924
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +165 
```

我是否缺少其他一些配置步骤？我在`name`属性中放错东西了吗？或者这是 JWT 开发者预览版中的一个已知错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-12T17:08:10.043

## 2014 年 2 月 13 日更新：

正如@leastprivilege 在下面指出的那样，使用 JWT 的 RTM 版本要容易得多。我强烈建议您忽略这一点，并使用他在[http://leastprivilege.com/2013/07/16/identityserver-using-ws-federation-with-jwt-tokens-and-symmetric-signatures/](http://leastprivilege.com/2013/07/16/identityserver-using-ws-federation-with-jwt-tokens-and-symmetric-signatures/)提供的示例。

请注意，下面的原始答案适用于 Beta 版 Microsoft.IdentityModel.Tokens.JWT。升级到发布版本 System.IdentityModel.Tokens.Jwt 只需要多做一点工作。见下文。

主要问题是该方法`JWTSecurityTokenHandler.ValidateToken(token)`没有完全填充`TokenValidationParameters`它传递给`JWTSecurityTokenHandler.ValidateToken(token, validationParameters)`. 特别是，它不会填充`SigningToken`成员或`ValidIssuers`（或`ValidIssuer`）。

有趣的是，我在原始问题中显示的配置实际上是由令牌解析器加载的，并且在运行时可用，如下面的代码所示。

不过，我不知道如何在配置文件中指定有效的颁发者字符串。我强烈怀疑有一个地方可以放置这些信息，但我还没有弄清楚它属于哪里。

我的问题的解决方案是创建一个从`JWTSecurityTokenHandler`. 重写`ValidateToken(token, validationParameters)`让我有机会设置我需要的那些参数，然后调用基类的`ValidateToken`方法。

```
public class CustomJwtSecurityTokenHandler: JWTSecurityTokenHandler
{
    // Override ValidateSignature so that it gets the SigningToken from the configuration if it doesn't exist in
    // the validationParameters object.
    private const string KeyName = "https://localhost/TestRelyingParty";
    private const string ValidIssuerString = "https://mySTSname/trust";
    public override ClaimsPrincipal ValidateToken(JWTSecurityToken jwt, TokenValidationParameters validationParameters)
    {
        // set up valid issuers
        if ((validationParameters.ValidIssuer == null) &&
            (validationParameters.ValidIssuers == null || !validationParameters.ValidIssuers.Any()))
        {
            validationParameters.ValidIssuers = new List<string> {ValidIssuerString};
        }
        // and signing token.
        if (validationParameters.SigningToken == null)
        {
            var resolver = (NamedKeyIssuerTokenResolver)this.Configuration.IssuerTokenResolver;
            if (resolver.SecurityKeys != null)
            {
                List<SecurityKey> skeys;
                if (resolver.SecurityKeys.TryGetValue(KeyName, out skeys))
                {
                    var tok = new NamedKeySecurityToken(KeyName, skeys);
                    validationParameters.SigningToken = tok;
                }
            }
        }
        return base.ValidateToken(jwt, validationParameters);
    }
} 
```

在我的 Web.config 中，我只需要更改安全令牌处理程序：

```
 <securityTokenHandlers>
    <!--<add type="Microsoft.IdentityModel.Tokens.JWT.JWTSecurityTokenHandler,Microsoft.IdentityModel.Tokens.JWT" />-->
    <!-- replaces the default JWTSecurityTokenHandler -->
    <add type="TestRelyingParty.CustomJwtSecurityTokenHandler,TestRelyingParty" /> 
```

没有什么比花三四天时间研究一个用几十行代码解决的问题更合适的了。. .

## 新版本的补充

2013 年 6 月，微软正式发布了他们的 JWT。他们将命名空间更改为 System.IdentityModel.Tokens.Jwt。升级到那个之后，上面的解决方案停止工作。为了让它工作，我必须将以下内容添加到我的`CustomJwtSecurityTokenHandler`. 这是对现有代码的补充。

```
public override ClaimsPrincipal ValidateToken(JwtSecurityToken jwt)
{
    var vparms = new TokenValidationParameters
        {
            AllowedAudiences = Configuration.AudienceRestriction.AllowedAudienceUris.Select(s => s.ToString())
        };
    return ValidateToken(jwt, vparms);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-12T14:30:52.290

下面是一个使用 .Net 4.5 的库的使用示例，它发出并验证使用基于对称密钥的 HMAC SHA256 签名的 JWT（全部在代码中且没有 WIF）：

```
string jwtIssuer = "MyIssuer";
string jwtAudience = "MyAudience";

// Generate symmetric key for HMAC-SHA256 signature
RNGCryptoServiceProvider cryptoProvider = new RNGCryptoServiceProvider();
byte[] keyForHmacSha256 = new byte[64];
cryptoProvider.GetNonZeroBytes(keyForHmacSha256);

///////////////////////////////////////////////////////////////////
// Create signing credentials for the signed JWT.
// This object is used to cryptographically sign the JWT by the issuer.
SigningCredentials sc = new SigningCredentials(
                                new InMemorySymmetricSecurityKey(keyForHmacSha256),
                                "http://www.w3.org/2001/04/xmldsig-more#hmac-sha256",
                                "http://www.w3.org/2001/04/xmlenc#sha256");

///////////////////////////////////////////////////////////////////
// Create token validation parameters for the signed JWT
// This object will be used to verify the cryptographic signature of the received JWT
TokenValidationParameters validationParams =
    new TokenValidationParameters()
    {
        AllowedAudience = s_jwtAudience,
        ValidIssuer = s_jwtIssuer,
        ValidateExpiration = true,
        ValidateNotBefore = true,
        ValidateIssuer = true,
        ValidateSignature = true,
        SigningToken = new BinarySecretSecurityToken(keyForHmacSha256),
    };

///////////////////////////////////////////////////////////////////
// Create JWT handler
// This object is used to write/sign/decode/validate JWTs
JWTSecurityTokenHandler jwtHandler = new JWTSecurityTokenHandler();

// Create a simple JWT claim set
IList<Claim> payloadClaims = new List<Claim>() { new Claim("clm1", "clm1 value"), };

// Create a JWT with signing credentials and lifetime of 12 hours
JWTSecurityToken jwt =
    new JWTSecurityToken(jwtIssuer, jwtAudience, payloadClaims, sc, DateTime.UtcNow, DateTime.UtcNow.AddHours(12.0));

// Serialize the JWT
// This is how our JWT looks on the wire: <Base64UrlEncoded header>.<Base64UrlEncoded body>.<signature>
string jwtOnTheWire = jwtHandler.WriteToken(jwt);

// Validate the token signature (we provide the shared symmetric key in `validationParams`)
// This will throw if the signature does not validate
jwtHandler.ValidateToken(jwtOnTheWire, validationParams);

// Parse JWT from the Base64UrlEncoded wire form (<Base64UrlEncoded header>.<Base64UrlEncoded body>.<signature>)
JWTSecurityToken parsedJwt = jwtHandler.ReadToken(jwtOnTheWire) as JWTSecurityToken; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-08T07:51:25.003

吉姆，

感谢您试用预览版，很抱歉您遇到了一些不明显的问题 :-(。

诞生于`NamedKeyIssuerTokenResolver`两个想法：

1.  需要关联一个密钥以检查作为共享秘密的签名；
2.  可以同时使用多个有效密钥。

它旨在与`NamedKeySecurityToken`具有名称和许多键的 一起使用。`NKITR`可以返回 a `NKST`，这简化了在使用多个密钥时检查签名的过程。

的一个目标`NKITR`是提供 JWT`iss`声明（在标头中）和密钥之间的映射。当检查签名时，`JWTHandler`检查：

1.  `TokenValidationParamerter.SigningToken`，如果发现使用它；
2.  `SecurityKeyIdentifier`从`JWT.Header.SigningKeyIdentifier`（目前仅支持 x5t）获得的A被发送到当前`INR`；
3.  A`NamedKeyIdentifierClause`从 中创建`Jwt.Issuer`并发送到当前`INR`.

由于 a`SecurityToken`可以包含多个密钥，每个按顺序用于检查签名，第一个成功停止并且`JWT.SigningToken`将包含`SecurityToken`验证签名的那个。

吉姆和威利，

很抱歉与`ValidateToken(SecurityToken)`重载方法混淆。参数从 移动`Configuration`到`ValidationParameters`，但不是像这样的属性`ValidIssuer`只有一个项目，而是

```
IssuerNameRegistry -> VP.IssuerNameRegistry
IssuerTokenResolver -> VP.SigningTokenResolver
AllowedAudienceUris -> VP.AllowedAudiences
CertificateValidator -> VP.CertificateValidator
SaveBootStrapContext -> VP.SaveBootStrapContext 
```

布伦特

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-09T14:51:29.797

AFAIK，JWtSecurityTokenHandler 尚未准备好从配置文件中使用。Vittorio Bertocci 给出的示例也是一个“代码示例”。在那里，他使用附加的 tokenValidationParameters 参数显式调用重载的 ValidateToken，该参数包含进行验证所需的所有内容（如对称密钥）。
不幸的是，正常的 Wif 管道不会调用该重载（它仅使用令牌作为参数调用 ValidateToken）我决定继承 jwtsecurity 令牌处理程序，重写 LoadCustomConfiguration 以手动加载创建 tokenValidationParemeter 对象所需的内容（我有为此创建一些配置对象）。然后我重写了 validateToken 以使用附加参数显式调用重载（我可以使用从配置中读取的参数动态创建）。所有这些都非常麻烦，但这是利用 tokenValidationparameters 功能的唯一方法。（但我当然可能错了）

```
 <issuerTokenResolver type="Microsoft.IdentityModel.Tokens.JWT.NamedKeyIssuerTokenResolver, Microsoft.IdentityModel.Tokens.JWT">
    <securityKey symmetricKey="01234567890123456789012345678901" name="MyIssuer"/>
  </issuerTokenResolver>
  <securityTokenHandlers> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-16T07:34:12.667

以下是它如何与 JWT 处理程序的 RTM 版本一起使用：http: [//leastprivilege.com/2013/07/16/identityserver-using-ws-federation-with-jwt-tokens-and-symmetric-signatures/](http://leastprivilege.com/2013/07/16/identityserver-using-ws-federation-with-jwt-tokens-and-symmetric-signatures/)

# jquery - 使用带有 struts2 jquery 的两个自动竞争者

> ID：14735754
> 
> 赞同：0
> 
> 时间：2013-02-06T18:00:54.943
> 
> 标签：jquery, autocomplete, struts2, struts2-jquery

我需要解决一个简单的用例如下

有一个包含两个自动完成器的表单：

1.  选择城市
2.  选择该城市的区域

当我们选择一个特定城市时，我想在区域自动完成器中加载该城市的区域。

```
 $.subscribe('citySelectTopic', function(event, data) {
        var ui = event.originalEvent.ui;
        var message = ui.item.value;
        if(ui.item.key) {
            message = '( '+ ui.item.key +' ) '+message;
        }
        alert(message); // ? What more to write here?
    });

<s:url var="remoteurl123" action="loadCity" namespace="/"/>

<sj:autocompleter id="cityAutocompleter" dataType="json" href="%{remoteurl123}"
    loadMinimumCount="3" list="cities" listKey="id" 
    listValue="name" onSelectTopics="citySelectTopic"/>

<sj:autocompleter id="areaAutocompleter" list="cities" 
    listKey="id" listValue="name" reloadTopics="citySelectTopic" /> 
```

我的 loadCity 操作返回输入名称的所有城市的列表 - 现在 onselectTopics 执行以下操作但不知道如何

1.  OnSelectTopics - 加载所选城市的所有区域 - 需要传递城市 ID

2.  OnSuccess of #1 - 显示在 #areaAutocompleter 中返回的所有区域的列表

有人可以帮我这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:16:45.053

您可以使用路径 Ajax -> Form -> Ajax Select (double select) 在展示中查看示例

[http://struts.jgeppert.com/struts2-jquery-showcase/index.action](http://struts.jgeppert.com/struts2-jquery-showcase/index.action)

或下载展示包并检查源代码。

# css - 无法在 css 中居中元素

> ID：14735761
> 
> 赞同：-1
> 
> 时间：2013-02-06T18:01:34.367
> 
> 标签：css, html, margin

我下载了一个模板并对其进行了编辑。现在我想将`one_third`元素居中，但是

```
margin-left: auto;
margin-right: auto; 
```

不起作用。

[这](http://jsfiddle.net/6hKCJ/)是 jsfiddle 中的模板。

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:33:46.203

为了工作`margin-left:auto;`，`margin-right:auto;`元素需要有一个宽度。所以尝试类似：

```
margin-left: auto;
margin-right: auto;
width: 600px; 
```

**更新：**

由于您似乎一直在更改示例，因此对如何`display`和`margins`工作有一个非常基本的了解：

要将任何框置于另一个框的中心，您需要做两件事：

a) 给外盒一个宽度（否则内盒不知道要靠什么居中

b) 内盒需要有`margin: 0 auto`（这个同`margin-left: auto; margin-right: auto;`）

此外，两个框都需要是块级元素（即 have `display: block`， NOT `display: inline;`）

所以放在一起它会看起来像这样：

HTML：

```
<section id="outer">
    <section id="inner"></section>
</section> 
```

CSS：

```
#outer {
    width: 600px;
    display: block;
    border: 1px solid red;
}
#inner {
    margin-left: auto;
    margin-right: auto;
    width: 200px;
    height: 200px;
    border: 1px solid green;
} 
```

这将为您提供一个 200 像素 x 200 像素的绿色框，中心位于宽度为 600 像素的红色框内。

现在，如果你想在绿色框中并排两个元素，你可以在那里添加你的内联元素，即

```
<section id="outer">
    <section id="inner">
        <article>Hi</article>
        <article>Hi agian!</article>
    </section>
</section>

#outer {
    width: 600px;
    display: block;
    border: 1px solid red;
}
#inner {
    margin-left: auto;
    margin-right: auto;
    width: 200px;
    height: 200px;
    border: 1px solid green;
}
#inner article {
    display: inline;
} 
```

# javascript - 使用 jQuery 将 HTML 页面动态加载到 div 中

> ID：14735762
> 
> 赞同：16
> 
> 时间：2013-02-06T18:01:34.877
> 
> 标签：javascript, jquery, html, css

我正在尝试这样做，所以当我单击 HTML 页面中的链接时，它会使用 jQuery 将请求的页面动态加载到 div 中。

我怎样才能做到这一点？

```
<html>
<head>
<script type="text/javascript">
    // what can I do for load any url clicked?
</script>
</head>
<body>
<div id="content"></div>

<a href="page1.html">Page 1</a><br />
<a href="page2.html">Page 2</a><br />
<a href="page3.html">Page 3</a><br />
<a href="page4.html">Page 4</a><br />
<a href="page5.html">Page 5</a><br />
<a href="page6.html">Page 6</a><br />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-07T02:18:06.433

有一个名为[pjax](https://github.com/defunkt/jquery-pjax)的 jQuery 插件，它说：“它是带有真正永久链接、页面标题和完全降级的工作返回按钮的 ajax。”

该插件使用 HTML5 pushState 和 AJAX 来动态更改页面而无需完全加载。如果不支持 pushState，PJAX 会执行完整的页面加载，以确保向后兼容。

pjax 所做的是它侦听指定的页面元素，例如`<a>`. 然后，当`<a href=""></a>`调用该元素时，将使用`X-PJAX`标题或指定的片段获取目标页面。

例子：

```
<script type="text/javascript">
  $(document).pjax('a', '#pjax-container');
</script> 
```

将此代码放在页眉中将侦听文档中的所有链接并设置您从新页面获取并在当前页面上替换的元素。

（意思是你想用远程页面替换`#pjax-container`当前页面）`#pjax-container`

当`<a>`被调用时，它将获取带有请求标头的链接，`X-PJAX`并在结果中查找 的内容`#pjax-container`。如果结果为`#pjax-container`，则当前页面上的容器将被替换为新结果。

```
<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="jquery.min.js"></script>
  <script type="text/javascript" src="jquery.pjax.js"></script> 
  <script type="text/javascript">
    $(document).pjax('a', '#pjax-container');
  </script> 
</head>
<body>
  <h1>My Site</h1>
  <div class="container" id="pjax-container">
    Go to <a href="/page2">next page</a>.
  </div>
</body>
</html> 
```

如果`#pjax-container`不是在响应中找到的第一个元素，PJAX 将无法识别内容并在请求的链接上执行完整页面加载。要解决此问题，需要将服务器后端代码设置为仅发送`#pjax-container`。

示例服务器端代码`page2`：

```
//if header X-PJAX == true in request headers, send
<div class="container" id="pjax-container">
  Go to <a href="/page1">next page</a>.
</div>
//else send full page 
```

如果您无法更改服务器端代码，那么片段选项是一种替代方法。

```
$(document).pjax('a', '#pjax-container', { 
  fragment: '#pjax-container' 
}); 
```

请注意，这`fragment`是一个较旧的 pjax 选项，并且似乎获取请求元素的子元素。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T18:14:39.900

JQuery 加载有效，但它会从源页面中删除 javascript 和其他元素。这是有道理的，因为您可能不想在页面上引入错误的脚本。我认为这是一个限制，因为您正在制作整个页面而不仅仅是源页面上的 div，您可能不想使用它。（我不确定css，但我认为它也会被剥离）

在此示例中，如果您在源页面的主体周围放置一个标签，它将抓取标签之间的任何内容，并且不会删除任何内容。我用 和 包裹我的源页面。

此解决方案将抓取上述分隔符之间的所有内容。我觉得这是一个比简单负载更强大的解决方案。

```
 var content = $('.contentDiv');
    content.load(urlAddress, function (response, status, xhr) {
        var fullPageTextAsString = response;
        var pageTextBetweenDelimiters = fullPageTextAsString.substring(fullPageTextAsString.indexOf("<jqueryloadmarkerstart />"), fullPageTextAsString.indexOf("<jqueryloadmarkerend />"));
        content.html(pageTextBetweenDelimiters);
    }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-06T18:04:53.533

试试这个：

```
$(document).ready(function(){
  $('a').click(function(e){
     e.preventDefault();
     $("#content").load($(this).attr('href'));
  });
}); 
```

并确保首先调用这个库：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js">
</script> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-06T18:12:54.810

我认为这会做到：

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){

         $(".divlink").click(function(){
         $("#content").attr("src" , $(this).attr("ref"));

});

});
</script>
</head>
<body>
<iframe id="content"></iframe>

<a href="#" ref="page1.html" class="divlink" >Page 1</a><br />
<a href="#" ref="page2.html" class="divlink" >Page 2</a><br />
<a href="#" ref="page3.html" class="divlink" >Page 3</a><br />
<a href="#" ref="page4.html" class="divlink" >Page 4</a><br />
<a href="#" ref="page5.html" class="divlink" >Page 5</a><br />
<a href="#" ref="page6.html" class="divlink" >Page 6</a><br />
</body>
</html> 
```

顺便说一句，如果你可以避免使用 Jquery，你可以只使用元素的`target`属性：`<a>`

```
<html>
<body>
<iframe id="content" name="content"></iframe>

<a href="page1.html" target="content" >Page 1</a><br />
<a href="page2.html" target="content" >Page 2</a><br />
<a href="page3.html" target="content" >Page 3</a><br />
<a href="page4.html" target="content" >Page 4</a><br />
<a href="page5.html" target="content" >Page 5</a><br />
<a href="page6.html" target="content" >Page 6</a><br />
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-06T18:03:24.453

我认为您正在寻找[Jquery Load](http://api.jquery.com/load/)功能。如果您愿意，您只需将该函数与绑定到 a 标签或按钮的 onclick 函数一起使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-03T17:54:39.253

您可以使用 jQuery 的 getJSON() 或 Load()；使用后者，您可以引用现有的 html 文件。有关详细信息，请参阅[http://www.codeproject.com/Articles/661782/Three-Ways-to-Dynamically-Load-HTML-Content-into-a](http://www.codeproject.com/Articles/661782/Three-Ways-to-Dynamically-Load-HTML-Content-into-a)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-03T16:07:20.267

您可以通过**选项**

通过一些修改试试这个

```
<div trbidi="on">
<script type="text/javascript">
function MostrarVideo(idYouTube)
{
var contenedor = document.getElementById('divInnerVideo');
if(idYouTube == '')
{contenedor.innerHTML = '';
} else{
var url = idYouTube;
contenedor.innerHTML = '<iframe width="560" height="315" src="https://www.youtube.com/embed/'+ url +'" frameborder="0" allowfullscreen></iframe>';
}
}
</script>

<select onchange="MostrarVideo(this.value);">
<option selected disabled>please selected </option>
<option value="qycqF1CWcXg">test1</option>
<option value="hniPHaBgvWk">test2</option>
<option value="bOQA33VNo7w">test3</option>
</select>
<div id="divInnerVideo">
</div> 
```

**如果你想在id="divInnerVideo"**中放置一个默认页面

 **例子：

```
<div id="divInnerVideo">
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/pES8SezkV8w?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
</div> 
```**

# ios - mergeChangesFromContextDidSaveNotification 会触发 fetchedResultsController 的 objectsChanged: 委托方法吗？

> ID：14735764
> 
> 赞同：1
> 
> 时间：2013-02-06T18:01:40.627
> 
> 标签：ios, core-data, nsfetchedresultscontroller, nsnotifications

我有一个设置，在后台线程中，我将新对象保存在 managedObjectContext A 中，在 TableViewController 中，我收听`NSManagedObjectContextDidSaveNotification`并处理这样的通知：

```
- (void) refreshData:(NSNotification *)notif {
   assert([[self fetchedResultsController] managedObjectContext] == self.managedObjectContext);
   if ([notif object] != self.managedObjectContext) {
       [self.managedObjectContext mergeChangesFromContextDidSaveNotification:notif];
   }
} 
```

`self.managedObjectContext`是 MOC B，连接到与 MOC A 相同的 NSPersistentStoreCoordinator（线程限制模式 1）。

TableViewController 是`NSFetchedResultsController`从 MOC B 读取数据的委托。

我找到了委托方法`controller:didChangeObject:atIndexPath:forChangeType:newIndexPath:`，并且`controllerDidChangeContent:`在收到 MOC A 的通知后没有被调用。

我是否必须重新获取 MOC B 的 fetchedResultsController 中的数据才能看到 MOC A 中添加的新对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T12:40:14.567

开发者，

当然，您已经设置了获取结果控制器委托？不这样做，什么都不能被调用。

安德鲁

# git - 如何让 git 识别自定义命令的文件夹？

> ID：14735765
> 
> 赞同：0
> 
> 时间：2013-02-06T18:01:45.800
> 
> 标签：git, msysgit

我有一个自定义 git 命令（特别是 git-tfs - 我不想通过 Chocolatey 安装）我想在单独的文件夹（C:\Program Files (x86)\Git\extensions\GitTfs）中有这个自定义命令。我知道我可以将这个文件夹添加到系统路径中，但我想将 git 设置隔离到 git 文件夹中。

我试图设置 git --exec-path：

```
git --exec-path="c:\Program Files (x86)\Git/libexec/git-core;c:\Program Files (x86)\Git/extensions/GitTfs" 
```

和

```
git --exec-path="/c/Program Files (x86)/Git/libexec/git-core:/c/Program Files (x86)/Git/extensions/GitTfs" 
```

但我得到：`usage: git....`。

我可以添加多个文件夹`git --exec-path`吗？（或者以任何其他方式将我的自定义 git 命令放在单独的文件夹中。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:33:24.630

我认为您只能指定一个目录。您也许可以改用别名（未经测试）：

```
git config --global alias.tfs '!c:\Program Files (x86)\Git/extensions/GitTfs/git-tfs' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-24T16:04:07.227

@chepner 的答案在概念上是正确的，但路径必须是可执行文件。所以正确的语法是：

```
git config --global alias.tfs !'C:\Program Files (x86)\Git\extensions\GitTfs\git-tfs.exe' 
```

# php - 使用while循环的php代码出错？

> ID：14735767
> 
> 赞同：0
> 
> 时间：2013-02-06T18:02:04.690
> 
> 标签：php, while-loop

我确定我犯了一个令人尴尬的错误，但我无法发现它。我有以下 php 代码，据我所知应该可以工作。`$minute[19]`但是，例如，当我打印时，我会在浏览器中收到一条通知，指出索引未定义。

顺便说一句，唯一公认的索引似乎是`[0]`.

```
$getdata = mysql_query("SELECT * FROM visitors ORDER BY ID DESC LIMIT 20");

$datetime = array();
$time = array();
$parsed = array();
$hour = array();
$minute = array();
$second = array();

$result = mysql_fetch_assoc($getdata);

$i = 0;

while($result = mysql_fetch_assoc($getdata))
{
    $datetime[$i] = $result['datetime'];
    $time[$i]= $datetime[$i];
    $parsed[$i] = date_parse($time[$i]);
    $hour[$i] = $parsed[$i]['hour'];
    $minute[$i] = $parsed[$i]['minute'];
    $second[$i] = $parsed[$i]['second'];
}
$i++; 
```

例如

```
print_r($minute[19]); // this isn't working 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:04:50.880

您需要将增量移动到循环中：

```
$getdata = mysql_query("SELECT * FROM visitors ORDER BY ID DESC LIMIT 20");

$datetime = array();
$time = array();
$parsed = array();
$hour = array();
$minute = array();
$second = array();

$i = 0;

while($result = mysql_fetch_assoc($getdata))
{
    $datetime[$i] = $result['datetime'];
    $time[$i]= $datetime[$i];
    $parsed[$i] = date_parse($time[$i]);
    $hour[$i] = $parsed[$i]['hour'];
    $minute[$i] = $parsed[$i]['minute'];
    $second[$i] = $parsed[$i]['second'];
    $i++;
} 
```

您也可以完全不使用该变量...例如：

```
$getdata = mysql_query("SELECT * FROM visitors ORDER BY ID DESC LIMIT 20");

$hour = array();
$minute = array();
$second = array();

while($result = mysql_fetch_assoc($getdata))
{
    $parsed = date_parse($result['datetime']);
    $hour[] = $parsed['hour'];
    $minute[] = $parsed['minute'];
    $second[] = $parsed['second'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:05:40.670

您有两个地方可以获取结果。您的示例第 10 行中的一个：

```
$result = mysql_fetch_assoc($getdata); 
```

第 14 行中的一个：

```
while($result = mysql_fetch_assoc($getdata)) 
```

在第 10 行提取的第一条记录在 while 循环开始时被新的提取覆盖。因此，您收到的记录似乎比预期的要少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:04:15.463

您应该添加 $i++; 进入循环而不是它之外:) 但是我不建议使用这种方法，也许你应该解释为什么你需要从这样的数组中取出某些键，然后人们可以更好地帮助你。

# google-search-console - 搜索结果 - 搜索“xzy”时显示“xyz”

> ID：14735773
> 
> 赞同：-2
> 
> 时间：2013-02-06T18:02:42.853
> 
> 标签：google-search-console

我有一个新网站[http://www.xzy.com](http://www.xzy.com)。当我用关键字在google上搜索时`xzy`，搜索结果中会显示另一个发音相似的网站，而我的网站会显示在“Search instead for”部分。如何在 google 上显示正确的结果？

编辑：在我的网站上工作了大约 2 个月后，我发现尽管与 XYZ 竞争激烈，但谷歌已经开始将“XZY”识别为新词。现在而不是显示“搜索而不是”谷歌正在显示正确的正常结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T01:52:01.827

在您的网站更受欢迎之前，Google 会一直认为“thotlabs”是“thorlabs”的错误输入。当您的网站被充分搜索时，Google 会将这两种拼写都识别为可接受的拼写，并且不会推荐其他拼写。

[同时，在Google 网站管理员工具](https://www.google.com/webmasters/tools)上注册您的网站，以便 Google 更加了解您的网站，并且您可以查看有关 Google 如何为您的网站编制索引的数据。

# python - 防止 Django 1.4.3 中 post_save 的重复信号

> ID：14735774
> 
> 赞同：2
> 
> 时间：2013-02-06T18:02:45.507
> 
> 标签：python, django, duplicates

我正在尝试编写一些代码，每次用户修改模型对象时都会发送一封电子邮件。目前，我正在努力让 models.py 中的一种方法接收 post_save 信号。我意识到 post_save 信号通常被发送两次是众所周知的事实，因此，解决方法是利用 dispatch_uid 参数。我已经这样做了，但出于某种奇怪的原因，我继续收到两个信号。这是我的应用程序的 model.py 文件中的代码。

```
from django.db import models
from django.db.models.signals import post_save

def send_email(sender, **kwargs):
      print "Signal sent." #just a placeholder

post_save.connect(send_email, dispatch_uid="unique_identifier")

class Library_Associates (models.Model):
      first_name = models.CharField(max_length = 200)
      last_name = models.CharField(max_length = 200)

  department_choices = (
        ('ENG', 'Engineering'),
        ('ART', 'Arts and Sciences'),
        ('AFM', 'Accounting and Financial Managment'),
        ('MAT', 'Mathematics'),
  )

  department = models.CharField(max_length = 3, choices = department_choices, default = 'ENG')

  pub_date = models.DateTimeField ('date published')

  def __unicode__(self):
        return self.first_name

  class Meta:
        verbose_name_plural = 'Library Associates'

class Info_Desk_Staff (models.Model):
      first_name = models.CharField(max_length=50)
      last_name = models.CharField(max_length=50)
      salary = models.IntegerField()
      hours_worked = models.IntegerField()

      def __unicode__(self):
            return self.first_name

      class Meta:
            verbose_name_plural = 'Info Desk Staff' 
```

我已经多次重新启动服务器，重置/删除了应用程序的所有数据，但我仍然继续收到两个信号。我的代码有什么本质上的问题吗？任何建议或见解将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:23:58.610

您的问题来自这样一个事实，即每次您通过管理界面修改对象时，管理应用程序都会创建[django.contrib.admin.models.LogEntry](https://github.com/django/django/blob/master/django/contrib/admin/models.py#L23)代表所做更改的实例。

因为您正在收听所有对象的 post_save，所以您的侦听器被调用了两次 - 一次用于您的模型，第二次用于 LogEntry 模型。

可能的解决方案列表包括：

1.  [使用post_save](https://docs.djangoproject.com/en/dev/ref/signals/#post-save)方法中的*sender*参数为您的每个模型分别注册您的侦听器（例如，以某种方式选择您的模型并循环执行） 。

    ```
    for model in get_models():
        post_save.connect(send_email, sender = model, dispatch_uid='unique_identifier') 
    ```

2.  检查发送到监听器的*发送*者是否不是 django.contrib.admin.models.LogEntry 的实例

    ```
    from django.contrib.admin.models import LogEntry
    ...

    def send_email(sender, **kwargs):
        if isinstance(sender, LogEntry):
            return 
    ```

3.  为您的模型提供一个通用的超类，并将其用于在侦听器中进行测试

    ```
    class MyModel(models.Model):
        pass

    class Library_Associates (MyModel):
        ...
    class Info_Desk_Staff (MyModel):
        ...

    def send_email(sender, **kwargs):
        if not isinstance(sender, MyModel):
            return 
    ```

# python - 如何从互联网上随机抽取样本？

> ID：14735777
> 
> 赞同：5
> 
> 时间：2013-02-06T18:03:14.277
> 
> 标签：python, random-sample

我正在尝试获取互联网页面的随机样本，我不想出于各种原因放弃谷歌搜索结果。这是我尝试过的方法；

```
import socket
from random import randint

def doesitserveawebpage(ip):
    ip=str(ip)
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((ip, 80))
        s.shutdown(2)
        return True
    except:
        return False

def givemerandomwebsite():
    adrformat = "%d.%d.%d.%d"
    while True:
        adr = adrformat % tuple(randint(0,255) for _ in range(4))
        try:
            print "Tring %s" % adr
            name = socket.gethostbyaddr(adr)
            if (doesitserveawebpage(adr)):
                return name
            else:
                continue
        except socket.herror:
            continue 
```

好吧，它不起作用。首先，它工作得太慢了。其次，它给了我不提供网页的地址。无论如何我可以使这段代码更好，还是你会建议另一种方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:38:58.493

假设大多数 HTTP 服务器运行在具有域名的主机上（例如不仅仅是一个 IP 地址），您可以通过进行 DNS 查找来进一步验证您的随机 IP 地址，例如 dig。

此外，您不应允许您的算法创建属于私有 IP 范围的随机 IP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:22:05.267

出色地...

1.  您的代码运行缓慢，因为它会阻止执行，直到 (a) 查找主机 (b) 您可以建立连接或更糟糕的是您的连接超时，这可能需要一段时间。

2.  您的代码提供不提供网页服务的主机名有几个可能的原因： (a) 使用端口 80 提供网页服务只是一种约定。我可以在服务器的 80 端口上提供任何我想要的东西。(b) 顶级域可以配置为不提供任何服务。例如，只有子域或某些 URL 会产生有效的 http 响应。(c) 我不知道的其他几个原因。

要解决 1\. 你必须异步。[这](https://stackoverflow.com/questions/1205863/how-can-i-get-non-blocking-socket-connects)会有所帮助。

我认为，2.无法解决。如果可以的话，[网络的大小估计](http://www.worldwidewebsize.com)会更加可靠。

关于更好的策略，对您问题的评论仍然适用。

此外，可能存在仅分配给它们的 IPv6 地址的 Web 服务器，因此您的示例以另一种方式倾斜。这在今天没有太大的实际意义，但现在情况正在迅速变化。

# asp.net - 允许匿名访问 MVC4 操作

> ID：14735787
> 
> 赞同：2
> 
> 时间：2013-02-06T18:03:54.737
> 
> 标签：asp.net, asp.net-mvc-4

我正在尝试允许匿名访问我网站的根目录。如果我向 site.com/home 发出请求，它允许匿名访问。但是，如果我请求 site.com/，我会看到一个登录页面。到目前为止，我已经完成了以下工作：

在 web.config 中，我为所有用户授权了“主页”：

```
 <location path="Home">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location> 
```

在 FilterConfig.cs 中，我添加了以下 AuthorizeAttribute：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
        filters.Add(new System.Web.Mvc.AuthorizeAttribute());
    } 
```

我的主页索引控制器操作如下所示：

```
 [AllowAnonymous]
    public ActionResult Index()
    {
        return View();
    } 
```

我的路线如下所示：

```
 routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            name: "Zoom",
            url: "zoom/{id}",
            defaults: new { controller = "Zoom", action = "Index" }
        );

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

这是通过路线完成的吗？我完全错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:07:24.460

You have to implement the logic in the Attribute code to filter it. In other words, you have to check and see if the method/class is annotated with the attribute and then skip authorization if it is (or handle accordingly for your scenario).

Here's an example:

```
 /// <summary>
    /// This class is used to ensure that a user has been authenticated before allowing a given method
    /// to be called.
    /// </summary>
    /// <remarks>
    /// This class extends the <see cref="AuthorizeAttribute"/> class.
    /// </remarks>
    public sealed class LoginAuthorize : AuthorizeAttribute
    {
        /// <summary>
        /// The logger used for logging.
        /// </summary>
        private static readonly ILog Logger = LogManager.GetLogger(typeof(LoginAuthorize));

        /// <summary>
        /// Handles the authentication check to ensure user has been authenticated before allowing a method
        /// to be called.
        /// </summary>
        /// <param name="filterContext">The authorization context object.</param>
        public override void OnAuthorization(AuthorizationContext filterContext)
        {
            DateTime methodEntryTime = DateTime.Now;
            Helper.LogMethodEntry(Logger, MethodBase.GetCurrentMethod(), filterContext);

            try
            {
                // determine if the called method has the AllowAnonymousAttribute, which means we can skip
                // authorization
                bool skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true)
                || filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true);

                if (!skipAuthorization)
                {
                    base.OnAuthorization(filterContext);

                    // make sure required session data is still present
                    if (string.IsNullOrWhiteSpace(filterContext.HttpContext.Session[Helper.ROLE_NAME] as string))
                    {
                        HandleUnauthorizedRequest(filterContext);
                    }
                }

                Helper.LogMethodExit(Logger, MethodBase.GetCurrentMethod(), methodEntryTime);
            }
            catch (Exception e)
            {
                Helper.LogException(Logger, MethodBase.GetCurrentMethod(), e);
                throw;
            }
        }

        /// <summary>
        /// Handles unauthorized requests. Redirects user to login page.
        /// </summary>
        /// <param name="filterContext">The authorization context object.</param>
        protected override void HandleUnauthorizedRequest(AuthorizationContext filterContext)
        {
            DateTime methodEntryTime = DateTime.Now;
            Helper.LogMethodEntry(Logger, MethodBase.GetCurrentMethod(), filterContext);

            try
            {
                base.HandleUnauthorizedRequest(filterContext);

                // redirect user to login page
                filterContext.Result = new RedirectResult("~/Login");

                Helper.LogMethodExit(Logger, MethodBase.GetCurrentMethod(), methodEntryTime);
            }
            catch (Exception e)
            {
                Helper.LogException(Logger, MethodBase.GetCurrentMethod(), e);
                throw;
            }
        }
    }
} 
```

Then, in `Global.asax` you would add this `LoginAuthorize` class, like this:

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new LoginAuthorize());
    filters.Add(new HandleErrorAttribute());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T21:17:13.007

首先，您不应该在 web.config 中使用 Webforms 授权方式。先摆脱那个。其次，通过将 Authorize 属性添加为全局过滤器，您基本上将 Authorize 属性应用于所有控制器和操作，这真的是您想要的吗？装饰动作方法或完整控制器更为常见。如果控制器具有授权属性，您仍然可以通过添加 AllowAnonymous 属性来允许操作方法的匿名访问，就像您已经做的那样。

使用这种方法应该可以正常工作，路线看起来不错。

# vba - Excel 2010 VBA，使用 vlookup 循环

> ID：14735788
> 
> 赞同：0
> 
> 时间：2013-02-06T18:04:05.043
> 
> 标签：vba, vlookup

我在 Excel 2010 VBA 中使用 vlookup 时遇到问题

我想遍历空白列中的每个单元格，并从数据源的相邻列中查找一个值。我想循环执行此操作。我看过很多论坛，可以让它正常工作。

这是我的代码示例

```
Sheets("NPT(hrs)").Activate
Dim NumberRows As Integer
NumberRows = Range("a:a").Find("*", Range("A1"), SearchDirection:=xlPrevious).Row
NumberRows = NumberRows

ActiveCell.Offset(2, 69).Activate
For RowNum = 1 To NumberRows
    If Len(Range("BQ1").Offset(RowNum, 0)) = 0 Then

        ActiveCell.Value = Application.WorksheetFunction.VLookup(Cells(RowNum, 68), "Equipment!A:K", 7, False)

        ActiveCell.Offset(1, 0).Activate
    '' This approach never workedXXX
    'v = WorksheetFunction.VLookup(Cells(RowNum, 68), "Equipment!A:K", 7, False)
           ' ActiveSheet.Cells(RowNum , 69).Formula = "=VLOOKUP(Cells(RowNum,68) ,Equipment!A:K,7,false)"
    'ActiveCell.Text = "v"

    'MsgBox "fin work?"
End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:33:39.463

Here is a quick code block that I wrote to replicate what I think you're trying to get at.

I created some sample data. The lookup on the right has unit prices and on the left you have a table with some entries missing in the 'total price' column.

![Excel screenshot of sample data](../Images/6f710e9c70b7b49d87e3c0ff6e94939b.png)

The code block below loops through the cells in column C and runs a vlookup each time it finds a blank cell.

```
Sub FillInBlanks()

  Dim rng As Range
  Set rng = ActiveSheet.Range("C2:C21")

  For Each cell In rng
    If IsEmpty(cell) Then
        cell.FormulaR1C1 = "=VLOOKUP(RC[-2],R1C7:R11C8,2,FALSE)*RC[-1]"
    End If
  Next cell

End Sub 
```

Running this macro should give you this

![Excel output](../Images/498133fc7b2e9b4cb11f006cabf6eceb.png)

# ruby - 使用 activerecord-mysql-adapter 安装 Redmine

> ID：14735794
> 
> 赞同：0
> 
> 时间：2013-02-06T18:04:22.833
> 
> 标签：ruby, linux, installation, redmine, gemfile

我正在使用 Ruby 版本：1.8.7 和 Gem 版本：1.8.25 的 CentOS 6.3 Linux 服务器

我正在尝试运行命令：`ruby script/rails server webrick -e production`

它吐出这个错误：

```
=> Booting WEBrick
=> Rails 3.2.8 application starting in production on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/usr/lib64/ruby/gems/1.8/gems/bundler-1.2.3/lib/bundler/rubygems_integration.rb:157:in `gem': Please install the mysql adapter: `gem install activerecord-mysql-adapter` (can't activate mysql (~> 2.8.1), already activated mysql-2.9.0\. Make sure all dependencies are added to Gemfile.) (LoadError)
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/mysql_adapter.rb:5
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:50:in `resolve_hash_connection'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:41:in `resolve_string_connection'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:25:in `spec'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:129:in `establish_connection'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/railtie.rb:82
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `instance_eval'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:43:in `run_load_hooks'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:42:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/base.rb:721
    from /var/www/redmine/lib/plugins/acts_as_activity_provider/init.rb:2
    from /var/www/redmine/config/initializers/00-core_plugins.rb:12
    from /var/www/redmine/config/initializers/00-core_plugins.rb:2:in `each'
    from /var/www/redmine/config/initializers/00-core_plugins.rb:2
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:588
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:587:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:587
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `run_initializers'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `send'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /var/www/redmine/config/environment.rb:14
    from /var/www/redmine/config.ru:4:in `require'
    from /var/www/redmine/config.ru:4
    from /usr/lib64/ruby/gems/1.8/gems/rack-1.4.0/lib/rack/builder.rb:51:in `instance_eval'
    from /usr/lib64/ruby/gems/1.8/gems/rack-1.4.0/lib/rack/builder.rb:51:in `initialize'
    from /var/www/redmine/config.ru:1:in `new'
    from /var/www/redmine/config.ru:1 
```

这是我的 Gemfile：

```
 source 'http://rubygems.org'

gem 'rails', '3.2.8'
gem "jquery-rails", "~> 2.0.2"
gem "i18n", "~> 0.6.0"
gem "coderay", "~> 1.0.6"
gem "fastercsv", "~> 1.5.0", :platforms => [:mri_18, :mingw_18, :jruby]
gem "builder", "3.0.0"
gem "rake", "0.8.7"
gem "rack", "1.4.0"
gem "rubytree", "0.5.2", :require => "tree"
gem "RedCloth", "~>4.2.3", :require => "redcloth" # for CodeRay
gem "mysql", "2.9.0"

# Optional gem for LDAP authentication
group :ldap do
  gem "net-ldap", "~> 0.3.1"
end

# Optional gem for OpenID authentication
group :openid do
  gem "ruby-openid", "~> 2.1.4", :require => "openid"
  gem "rack-openid"
end

# Optional gem for exporting the gantt to a PNG file, not supported with jruby
platforms :mri, :mingw do
  group :rmagick do
    # RMagick 2 supports ruby 1.9
    # RMagick 1 would be fine for ruby 1.8 but Bundler does not support
    # different requirements for the same gem on different platforms
    gem "rmagick", ">= 2.0.0"
  end
end

# Database gems
platforms :mri, :mingw do
  group :postgresql do
    gem "pg", ">= 0.11.0"
  end

  group :sqlite do
    gem "sqlite3"
  end
end

platforms :mri_18, :mingw_18 do
  group :mysql do
    gem "mysql", "2.9.0"
  end
end

platforms :mri_19, :mingw_19 do
  group :mysql do
    gem "mysql2", "~> 0.3.11"
  end
end

platforms :jruby do
  gem "jruby-openssl"

  group :mysql do
    gem "activerecord-jdbcmysql-adapter"
  end

  group :postgresql do
    gem "activerecord-jdbcpostgresql-adapter"
  end

  group :sqlite do
    gem "activerecord-jdbcsqlite3-adapter"
  end
end

group :development do
  gem "rdoc", ">= 2.4.2"
  gem "yard"
end

group :test do
  gem "shoulda", "~> 2.11"
  # Shoulda does not work nice on Ruby 1.9.3 and seems to need test-unit explicitely.
  gem "test-unit", :platforms => [:mri_19]
  gem "mocha", "0.12.3"
end

local_gemfile = File.join(File.dirname(__FILE__), "Gemfile.local")
if File.exists?(local_gemfile)
  puts "Loading Gemfile.local ..." if $DEBUG # `ruby -d` or `bundle -v`
  instance_eval File.read(local_gemfile)
end

# Load plugins' Gemfiles
Dir.glob File.expand_path("../plugins/*/Gemfile", __FILE__) do |file|
  puts "Loading #{file} ..." if $DEBUG # `ruby -d` or `bundle -v`
  instance_eval File.read(file)
end 
```

我已经安装了 activerecord-mysql-adapter - 它没有错误......

我试图更改 Gemfile 以匹配它吐出的错误，即 (~> 2.8.1) 版本，但这也不起作用......

任何帮助将不胜感激...

更新！！

我卸载了 MySQL 2.9.0 并安装了 MySQL 2.8.1 并更改了我的 Gemfile 以反映正确的版本，但现在我收到了这个错误：

```
=> Booting WEBrick
=> Rails 3.2.8 application starting in production on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `query': Mysql::Error: Table 'redmine.users' doesn't exist: SHOW FULL FIELDS FROM `users` (ActiveRecord::StatementInvalid)
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `execute'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `log'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `execute'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/mysql_adapter.rb:324:in `execute_and_free'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:426:in `columns'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/schema_cache.rb:12:in `initialize'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `call'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `default'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `[]'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `columns'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:237:in `columns_hash'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:19:in `descends_from_active_record?'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:25:in `finder_needs_type_condition?'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/base.rb:455:in `relation'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/scoping/named.rb:37:in `scoped'
    from /usr/lib64/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/querying.rb:9:in `order'
    from /var/www/redmine/app/models/group.rb:32
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'
    from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:439:in `eager_load!'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:438:in `eager_load!'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/finisher.rb:53
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `run_initializers'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `send'
    from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /var/www/redmine/config/environment.rb:14
    from /var/www/redmine/config.ru:4:in `require'
    from /var/www/redmine/config.ru:4
    from /usr/lib64/ruby/gems/1.8/gems/rack-1.4.0/lib/rack/builder.rb:51:in `instance_eval'
    from /usr/lib64/ruby/gems/1.8/gems/rack-1.4.0/lib/rack/builder.rb:51:in `initialize'
    from /var/www/redmine/config.ru:1:in `new'
    from /var/www/redmine/config.ru:1 
```

编辑：我想通了......我需要运行命令：`RAILS_ENV=production bundle exec rake db:migrate`

哦！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:18:40.967

尝试

```
bundle exec ruby script/rails server webrick -e production 
```

另外，你为什么使用脚本/rails？这应该有效：

```
 bundle exec rails server webrick -e production 
```

高温高压

# machine-learning - 神经网络 - 更新权重矩阵 - 反向传播算法

> ID：14735801
> 
> 赞同：1
> 
> 时间：2013-02-06T18:05:02.633
> 
> 标签：machine-learning, neural-network

我正在 使用图 31 算法在 Andrew Ng 教授的讲座或[this的帮助下实现神经网络。](http://calypso.inesc-id.pt/docs/NN1.pdf)

我想我理解前向传播和后向传播很好，但在每次迭代后更新权重（theta）感到困惑。

Q1。何时以及如何更新权重 (theta) 矩阵 - theta1、theta2？

Q2。大三角洲有什么用？[已解决，谢谢@xhudik]

Q3。我们是否必须添加+1（输入和隐藏层中的偏置单元？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T09:06:50.740

Q1：由@nikie 解释（荣誉）

Q2：Andrew NG 的演讲很棒。但是，您指向的是高级并且想要了解详细信息。这个怎么样：http: [//galaxy.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html](http://galaxy.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html)它通过有用的图形为您提供更多细节

# ios - iOS 中的交互式视频：是否可以通过点击视频中的离散部分来触发代码中的特定操作？

> ID：14735808
> 
> 赞同：2
> 
> 时间：2013-02-06T18:05:16.630
> 
> 标签：ios, animation, video-streaming, http-live-streaming

我问这个是因为我在任何地方都找不到答案，至少使用我能想到的关键字。我发现的最相关的问题/答案是：（[在 iPad 中创建交互式视频 - 产品演示应用程序](https://stackoverflow.com/questions/7033674/create-interactive-videos-in-ipad-an-app-for-product-demo)）。用户 Jano 回复：

> 为 iOS 创建交互式视频的最简单方法是使用 Apple 的 HTTP Live Streaming 技术。您必须创建视频、嵌入元数据、使用 MPMoviePlayerController 或 AVPlayerItem 播放它，然后显示可点击区域以响应元数据通知。
> 
> 元数据应包含您正在跟踪的元素的坐标，例如：一件衣服和产品的标识符。您使用可单击的子视图覆盖此信息，该子视图显示有关产品的更多信息。在 iTunes 中有几个这种类型的应用程序，这里是一个。
> 
> 一旦你获得了一个工作产品和数周的视频，最困难的部分就是在较少的人际交互的情况下执行运动跟踪。一种方法是使用 Adob​​e After Effects，另一种方法是基于 OpenCV 编写您自己的解决方案。

我发现的有关这项技术的示例 ( [http://vimeo.com/16455248](http://vimeo.com/16455248) ) 显示了当视频到达嵌入的元标记时自动添加 NSButtons。我的客户想要一个在特定时间暂停的人体互动视频（可能使用元标签），并对用户点击视频中的元素做出反应（例如：想象胃里有一颗药丸；点击这个药丸后它会触发另一个预以对用户不透明的方式呈现的视频）。我曾想过使用 Cocos2D 或 Open GL ES 制作动画，但我缺乏掌握这些技术的人。

我不太明白上面引用中的“运动跟踪”参考。Jano 提到了 Adob​​e After Effects 和 OpenCV。这种运动跟踪就像一个“UIGestureRecognizer”？它是否跟踪视频本身的部分内容或用户发起的动作，如点击？

我希望我已经以最清晰的形式公开了这个问题。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-01T01:32:29.173

这个问题已经有一年了，但我可以让你深入了解 After Effects 问题。AE 有一个功能，您可以在视频帧中定义一个区域，软件将在时间轴上跟踪该区域，并以特定间隔记录坐标。例如，在一个人骑山地自行车的视频中，您可以选择他们头盔周围的一个区域，AE 将在整个时间轴上记录头盔的坐标。

由于 Flash 最有可能是交互式视频的目标，因此典型的工作流程会将这些坐标数据编码为 Flash 视频作为提示点事件（这是我个人体验过的唯一方法）。根据一些谷歌搜索，数据存储在关键帧中，可以使用脚本提取。

更多信息：[http ://helpx.adobe.com/after-effects/using/tracking-stabilizing-motion-cs5.html](http://helpx.adobe.com/after-effects/using/tracking-stabilizing-motion-cs5.html)

这是[提取数据的手动方法](http://blog.grifo.tv/2010/08/12/motion-tracking/)：

> 在时间线面板中选择素材并按 U 键，所有跟踪点关键帧都会显示出来。神奇的是，选择每个轨迹点的 Feature Center 属性并复制它（Mac 为 Cmd+C，PC 为 Ctrl+C）
> 
> 现在打开任何文本编辑器，例如 TextMate 或记事本并粘贴数据（Mac 为 Cmd+V，PC 为 Ctrl+V）

# html - IE9 中缩放图像地图的工具提示

> ID：14735811
> 
> 赞同：1
> 
> 时间：2013-02-06T18:05:25.237
> 
> 标签：html, css, zooming

为什么在 IE9`alt`中，当我使用缩放时，不会出现在图像地图的定义区域：

```
<style type="text/css">
  #wrap {zoom:50%; -moz-transform:scale(50%); -webkit-transform:scale(50%) }
</style>

<div id="wrap">
  <img src="http://www.content.onemexico.net/rosa.jpg" width="640" height="640" usemap="#theMap">
  <map name="theMap">
    <area shape="rect" coords="240,240,400,400" href="#" alt="RosesByAlt" title="RosesByTitle">
  </map>
</div> 
```

IE9 是否有任何解决方案，在缩放图像的定义可点击区域上显示文本（`alt`或）？`title`

# android - android可绘制选择自定义

> ID：14735812
> 
> 赞同：-1
> 
> 时间：2013-02-06T18:05:28.373
> 
> 标签：android, android-drawable

为了更好地解释：例如，我有两种语言可用。这就是为什么我会有英语图像和俄语图像。我在一个可绘制的 xml 文件中引用了它们。

```
<selector xmlns:android="http://schemas.android.com/apk/res/android" >

<item android:drawable="@drawable/image_eng"></item>
<item android:drawable="@drawable/image_ru"></item>

</selector> 
```

我应该使用什么类型的可绘制 xml 文件？如何设置和检测状态并切换图像？基本上它就像`android:state_`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:08:56.760

If I understand correctly, you want to use one image when the phone is in English, and the other when the phone is in Russian. You should use the language modifiers on the drawable folder, not in the drawable name.

So, you would have a folder named drawable-en, which would contain your image for English (drawable-en/image.png, for example). Then, have another folder named drawable-ru which contains your Russian version of the image, but it must have the same name (drawable-ru/image.png).

Then, in your layout XML (or wherever you're referencing the drawable) just reference @drawable/image ... Android will automatically choose the appropriate image.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:12:02.043

请阅读[Android 资源本地化](http://developer.android.com/guide/topics/resources/localization.html)的工作原理。

您不必为此使用选择器，也不必强制执行任何操作。

只需将您的图像文件放在以下文件夹中：

*   res/drawable-en
*   res/drawable-ru

在您的代码中，您可以使用：

```
Drawable draw = getResources().getDrawable(R.drawable.image); 
```

该应用程序将根据手机的语言选择合适的

# c# - 使用 AjaxControlToolKit Gravatar 控件时出现 NullReferenceException

> ID：14735813
> 
> 赞同：0
> 
> 时间：2013-02-06T18:05:31.123
> 
> 标签：c#, asp.net, ajax, ajaxcontroltoolkit, nullreferenceexception

每当我尝试在其中一个页面中添加 AjaxControlToolKit 的 Gravatar 控件时，都会出现以下错误：

![在此处输入图像描述](../Images/c9f743a89a0a3fa6bebdeeaae752c155.png)

我在页面顶部添加了库作为

```
<%@ Register assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" tagprefix="asp" %> 
```

并控制为

```
<asp:Gravatar ID="Gravatar1" runat="server" Height="168px" Width="168px" /> 
```

Gravatar 控件在我网站的其他旧 ASP.NET 页面中运行良好。但是当我尝试在新页面中添加它时，它会出现上述异常。请告诉我为什么会发生异常以及如何解决？还有为什么在源错误中[没有相关的源代码行]？另请注意，我无法从工具箱将 gravatar 控件拖到此页面上。我必须编写上面的代码来添加控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:35:26.653

你需要设置头像的`Email`属性。

```
<%@ Register assembly="AjaxControlToolkit" 
  namespace="AjaxControlToolkit" tagprefix="act" %>

<act:Gravatar ID="Gravatar1" runat="server" Email="someone@somewhere.org" 
  Height="168px" Width="168px" /> 
```

**更新**

我刚刚看了一下`Gravatar.GetHash`方法。它的第一行是`Email = Email.ToLower();`. 如果电子邮件为空，这将引发空异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T07:32:44.097

如果您将电子邮件 ID 作为会话变量传递，请使用此

> Email='<%=email)%>' 其中“email”是您的会话变量。

否则，您只需将电子邮件 ID 放入电子邮件属性。就是这样 ！

# javascript - jQuery to top 函数不允许滚动

> ID：14735818
> 
> 赞同：0
> 
> 时间：2013-02-06T18:05:47.760
> 
> 标签：javascript, jquery

我正在创建 magento 商店，我想在用户滚动窗口后使 toTop 按钮可用。

我在下面粘贴了我的代码，它工作正常，但是在窗口位于顶部之后，我不能再移动它了，它被卡住了。

```
jQuery(window).scroll(function() {
    var top = jQuery(window).scrollTop();

    if (top > 77) {
    jQuery(function() {
        jQuery('img.arrowup').fadeIn();
        jQuery('div.header_bg').show();
        jQuery('div.mainmenu').addClass('stick');
        jQuery('body div.header-container').next().addClass('pad');
        jQuery("img.arrowup").on('click', function(e) {
        e.preventDefault();
        jQuery('body,html').animate({scrollTop:10},800);
    });
    })} else {
        jQuery('div.header_bg').hide();
        jQuery('img.arrowup').fadeOut();
        jQuery('body div.header-container').next().removeClass('pad');
        jQuery('div.mainmenu').removeClass('stick');
    }

}); 
```

==============================

感谢大家的帮助，这是带有标头和 toTop 动画的工作解决方案:)

```
 var scrollDiv=jQuery(this);
    jQuery(window).scroll(function(){  
        if(jQuery(window).scrollTop()<="77"){
            jQuery("img.arrowup").fadeOut("slow");
            jQuery('div.header_bg').hide();
            jQuery('div.mainmenu').removeClass('stick');
        } else {
            jQuery("img.arrowup").fadeIn("slow");
            jQuery('div.header_bg').show();
            jQuery('div.mainmenu').addClass('stick');
        }
    });
    jQuery("img.arrowup").click(function(){
        jQuery("html, body").animate({scrollTop:0},"slow");
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:25:07.233

[我建议先阅读这个答案](https://stackoverflow.com/questions/11971475/setting-css-value-limits-of-the-window-scrolling-animation/11971912#11971912)，以了解为什么动画会产生冲突取决于滚动值，而不是尝试一下：

```
$(document).ready(function() {
   $(window).scroll(function() {
      var scrollVal = $(this).scrollTop(); // use this instead of window

      if ( scrollVal >= 0 &&  scrollVal < 77 ) {
         //do something without animations
         $('div.header_bg').hide();
         $('div.mainmenu').removeClass('stick');

      } else if ( scrollVal === 77 ){
         //i didn't try this before but it may work,
         //since value equals 77 once, it may not create animation conflicts
         $('img.arrowup').fadeIn();

      } else if ( scrollVal > 77 ) {
         //do something without animations
         $('div.header_bg').show();
         $('div.mainmenu').addClass('stick');
      }
  });
}); 
```

# php - 致命错误：运行 Magento 的专用服务器内存不足

> ID：14735819
> 
> 赞同：2
> 
> 时间：2013-02-06T18:05:49.430
> 
> 标签：php, magento, memory-leaks, dedicated-server

我在具有 4 Gb ram 和 2 * Pentium(R) Dual-Core CPU E5400 @ 2.70GHz 的 DS 上运行 Magento

我已将 php 内存限制从 64M - 1GB 调整，但在管理区域示例中不断出现内存错误

```
`Fatal error: Out of memory (allocated 48496640) (tried to allocate 189475 bytes)
 in  /home/accountname/public_html/shoponline/magento/app/code/core/Mage/Core/Block/Abstract.php on line 888` 
```

所以有问题，因为它只分配了 46M（如果我有这个权利..？）

这条线变了……

该网站仍在测试中，所以它没有任何繁忙的流量，所以我很困惑可能是什么问题......

我正在使用 APC 和内存缓存

任何一般性的想法都会有所帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:58:39.680

好的，在阅读了一些论坛之后，我认为我通过使用 WHM 控制面板中的 RlimitMem 功能提高了性能 - 这会计算要求限制并将其添加到 httpd.conf 文件中，如下所示：

设置后，后台管理区域快了 80%...！

![WHM 面板截图](../Images/95da19c6d666481e1eee8bea345d22f3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:26:09.387

你在哪里更改了内存限制？它似乎没有生效。

我假设你编辑了 php.ini。

您也可以尝试添加...

```
php_value memory_limit 512M 
```

到您的 .htaccess 文件，看看是否有效。

# python - 如何检查一个字符串是否是其他字符串的串联，并在python中的每个字符串之间插入一个字符

> ID：14735820
> 
> 赞同：1
> 
> 时间：2013-02-06T18:05:49.627
> 
> 标签：python

我正在尝试检查用户输入的字符串是否包含在其他字符串的列表中以及这些字符串的任何排列中，以“*”分隔。

换句话说，这是我到目前为止的代码：

```
user_string=raw_input("Please supply a string")

viable_entries=['this', 'that', 'something else']

if user_string in viable_entries:
    print "here I'd move on with my script" 
```

如果 user_string = "something else*this" 或 "this*that" 等，我还想打印“在这里我将继续使用我的脚本”。

有没有一种简单的pythonic方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T18:11:43.930

您可以拆分输入并使用`set.issubset`：

```
if set(user_string.split('*')).issubset(viable_entries):
     ... 
```

请注意，`True`即使条目重复（`"this*this"`），这也会给出。如果您想防止用户提供重复的条目，您可以使用`len(set)`：

```
entries = user_string.split('*')
if set(entries).issubset(viable_entries) and len(set(entries)) == len(entries):
     ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:18:52.047

ecatmur 的解决方案更好，但“蛮力”方法是生成一组可行的条目并在此基础上进行检查。改编自[itertools](http://docs.python.org/2/library/itertools.html#itertools.combinations)页面：

```
def powerset(iterable):
    "powerset([1,2,3]) --> () (1,) (2,) (3,) (1,2) (1,3) (2,3) (2,1) (3,1) (3,2) (1,2,3)..."
    s = list(iterable)
    return chain.from_iterable(permutations(s, r) for r in range(len(s)+1)) 
```

之后，`"*".join(X) for X in powerset(viable_entries)`会给你你的名单来匹配。

# jquery - 需要让我的 jquery 网站在 iPhone 上滚动（滑动）吗？

> ID：14735823
> 
> 赞同：-2
> 
> 时间：2013-02-06T18:05:58.450
> 
> 标签：jquery, iphone, html, scroll, swipe

我有一个大问题，我制作的网站适用于台式电脑，但不适用于手机（触摸屏）和 iPhone 和 iPad。在该站点中，我在向上/向下方向上滚动鼠标滚轮，并且在所有四个方向（左/右/上/下）上都有按键，如何使滑动命令也在这里工作？

我有类似[http://socketstudios.com/](http://socketstudios.com/)的网站！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:10:59.670

您可以使用此插件绑定滑动事件： http: [//labs.skinkers.com/touchSwipe/](http://labs.skinkers.com/touchSwipe/)

示例： http: [//labs.skinkers.com/touchSwipe/demo/Basic_swipe.html](http://labs.skinkers.com/touchSwipe/demo/Basic_swipe.html) 示例代码：

```
$("#test").swipe( {
    //Generic swipe handler for all directions
    swipeLeft:function(event, direction, distance, duration, fingerCount) {
       alert("Swiped 50px left")
    },
    threshold:50
  }); 
```

上面的代码不会直接移动你的页面！在那里你可以使用该物业`swipeStatus`

```
$("#test4").swipe( { swipeStatus:swipe2, allowPageScroll:"vertical"} ); 
```

尝试这个：

```
$("body").swipe( {
 swipeUp:function(event, direction, distance, duration, fingerCount) {
       scroll_up();
    },
    swipeDown:function(event, direction, distance, duration, fingerCount) {
       scroll_down();
    },
    swipeLeft:function(event, direction, distance, duration, fingerCount) {
       scroll_left();
    },
    swipeRight:function(event, direction, distance, duration, fingerCount) {
       scroll_right();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:21:04.570

您可能想查看为此类功能构建的 JQuery Mobile 事件。

例如： [http ://stephband.info/jquery.event.swipe/](http://stephband.info/jquery.event.swipe/)

# mongodb - mongodb：如何为饼图建模（整体到小部分的集合）

> ID：14735834
> 
> 赞同：0
> 
> 时间：2013-02-06T18:07:01.117
> 
> 标签：mongodb, mongoose, data-modeling

## 问题

我需要将定义为“整体”的文档建模为一个小的、固定的“部分”集合，其中整体及其部分都是可查询的。

切片馅饼是我需要的模型的一个很好的例子。进一步描述域：

*   pie:slice 具有 1:many (1-10) 的关系。每个切片只属于一个饼，每个饼有1-10个切片。
*   对于此示例，假设饼图在创建时被切片，并且切片的数量*没有变化*。
*   馅饼*总是*用它的切片来查询。相反不一定正确，但查询的切片将需要访问有关饼图的元数据
*   例如，假设“权重”是切片的唯一属性。所有切片共享的元数据远大于每个切片的元数据。所有切片都有相同的面包师、馅料、外壳、厨房等。*不必*将所有数据复制到每个切片将是理想的。
*   切片和饼图都必须能够通过整个饼图的属性或切片的属性有效地查询和排序。例子：
    *   找到所有正好有 2 个切片的馅饼
    *   查找所有切片重量 > 10 盎司的馅饼
    *   查找类型为“cherry”的所有切片
    *   找出所有馅饼中最重的 5 个切片

* * *

## 问题：

鉴于以上几点，一个模型 a`pie`和它`slices`如何有效地查询（如果可能的话，有效地存储）？

如果这很明显，请回答。继续阅读我迄今为止尝试过的两种方法，以及为什么它们都不令人满意。

* * *

## 我试过的：

**1.嵌入**

在整体中嵌入部分[似乎是自然的选择](http://docs.mongodb.org/manual/core/data-modeling/#embedding)。

```
Pie {
  type: String, // `type` and other shared attrs are defined on Pie
  slices: [{
    _id: ObjectId
    weight: Number
  }]
} 
```

有了这个，我可以按类型、重量、切片重量查询馅饼，我可以通过`aggregate`、`unzip`和查询单个樱桃馅饼切片`project`。

**问题**在于如何对单个切片进行**排序和查询。**例如，如果我需要从*所有*饼图中检索 5 个最重的切片（如上述问题中所述）。我这可能与聚合有关，我不知道如何。

* * *

**2\. 单独收藏**

在放弃我的第一个模式后，我回到使用两个单独的集合，并通过参考 id 加入：

```
Pie {
  type: String // `type` and other shared attrs are defined on Pie ...
}

Slice {
  pie_id: ObjectId,
  type: String, // ... and duplicated to all slices
  weight: Number
} 
```

这解决了我的查询问题，但引入了更多。这里只是`type`重复。在我的实际应用程序中，情况要糟糕得多，以至于我的模拟`Slice`可能是 90% 的重复数据。

另一个问题是，现在每当我想查询饼图时，我都必须再次查询所有切片。此外，制作馅饼不再是原子操作，而是一批单独的插入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T22:28:45.880

你有没有看过这个：[http](http://docs.mongodb.org/manual/tutorial/model-tree-structures/) ://docs.mongodb.org/manual/tutorial/model-tree-structures/ 特别是“带有子引用的模型树结构”似乎正是你想要的。您只能将最特定于切片文档中特定切片的数据（例如切片权重）存储在 Pie 文档中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T22:54:50.630

您可以使用如下结构：

```
{
    "_id" : ObjectId("5112d747819e326e6c37e1e3"),
    "pie" : {
        "type" : "cherry",
        "weight" : 500,
        "slices" : [
            {
                "slice_id" : ObjectId("5112d747819e326e6c37e1e1"),
                "type" : "square",
                "weight" : 75
            },
            {
                "slice_id" : ObjectId("5112d747819e326e6c37e1e2"),
                "type" : "triangle",
                "weight" : 75
            }
        ]
    }
} 
```

然后你可以使用 $unwind 和 $sort 像：

```
db.q14735834.aggregate({$unwind: "$pie.slices"}, {$sort: {"pie.slices.weight":-1}}, {$limit:10}) 
```

并进一步组合 $group 和其他聚合框架运算符来操作数据。

除了 [Alptigin Jalayr] 引用的教程之外，聚合框架文档可能有用：[http ://docs.mongodb.org/manual/applications/aggregation/](http://docs.mongodb.org/manual/applications/aggregation/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-16T01:14:13.137

我选择的答案，虽然可能不是唯一或最好的答案，是对关系双方的数据进行非规范化。

从本质上讲，`slices`它们完全嵌入在`pie`文档中，***并且***切片存在于它们自己的集合中，并带有重复的`pie`元数据。这样可以独立查询饼图及其切片，无需任何二次查询。

2路复制存储是否有效？可能不是，但是存储在这里也不是问题。

这是否会使更新文档变得更加复杂和多重操作？是的，但是更新将远远少于读取，在这种情况下读取更为重要。

# c# - C# 匿名类和列表 I want to access the Structures returned by a function in a List. I am not able to do it as it is causing Compiler errors. public class StructTypeA { public string sString1; public string 问问题 问问题 2013-02-06T18:07:17.810 332 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I want to access the Structures returned by a function in a List. I am not able to do it as it is causing Compiler errors. public class StructTypeA { public string sString1; public string sString2; } public class StructTypeB { public int iNum1; public int iNum2; } public List myFunction () { StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); var response = new List { new {oStructA = myStructA} , new {oStructB = myStructB } }; return response; } public void myCallerFunction() { var retVal = myFunction (); //This does not work, it generates a compile error // 'object' does not contain a definition for 'oStructA' and no extension method 'oStructA' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?) var myStr = retVal[0].oStructA.sString1; //How can I access the structures. } I want to access the structures oStructA and oStructB, Please tell me what the exact syntax should be. Use str_replace $str = str_replace(array('\t','\n'),'',$str); Or preg_replace $str = preg_replace('/(\\\\n|\\\\t)/', '', $str); c#structure 4 7 回答 7 This answer is useful 4 您将返回 a List，因此retVal[0]将是 type object，它没有oStructA成员。 您正在创建一个List包含匿名类型实例的 。在创建类型的范围之外，您将无法按名称访问这些成员。 您必须为列表创建一个命名类型： class MyType { public StructTypeA oStructA { get; set; } public StructTypeB oStructB { get; set; } } 然后对您的方法进行编码以返回一个List<mytype>. 创建这种类型的实例就像创建匿名类型的实例一样。使用您的代码示例，只需在new之后添加类型名称： var response = new List { new MyType {oStructA = myStructA} , new Mytype {oStructB = myStructB } }; 或者你可以使用一个Tuple，并返回一个列表。 或者，正如其他人所说，使用dynamic. 不过，我一般不建议这样做。命名类型可能是最好的方法。 于 2013-02-06T18:17:39.503 回答 This answer is useful 2 请object在不需要时停止使用类型和匿名类型。 C# 是一种类型安全的语言，这是发生在你身上的最好的事情，所以请Tuple<t1, t2="">尽可能使用类型以外的类型（例如） object。 public List<tuple<structtypea, structtypeb="">> myFunction() { StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); return new List<tuple<structtypea, structtypeb="">> { new Tuple<structtypea, structtypeb="">(myStructA, myStructB) }; } public void myCallerFunction() { var retVal = myFunction(); var oStructA = retVal[0].Item1; } 于 2013-02-06T18:14:20.363 回答 This answer is useful 1 我认为OP对待做这样的事情： public class StructTypeA { public string sString1; public string sString2; } public class StructTypeB { public int iNum1; public int iNum2; } public static List myFunction () { StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); var response = new List { myStructA , myStructB }; return response; } public static void Main() { var retVal = myFunction (); //This does not work, it generates a compile error // 'object' does not contain a definition for 'oStructA' and no extension method 'oStructA' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?) var myStr1 = ((StructTypeA)retVal[0]).sString1; var myStr2 = ((StructTypeB)retVal[1]).iNum1; //How can I access the structures. } 显然，@Jim Mischel 的建议非常正确。 于 2013-02-06T18:28:39.830 回答 This answer is useful 1 我想不出你想要这样做的实际原因，但是...... public List <dynamic>myFunction () { StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); var response = new List <dynamic>{ new {oStructA = myStructA} , new {oStructB = myStructB } }; return response; } 当您创建匿名对象列表时，应该这样做。类型的使用dynamic可能会有所帮助。 于 2013-02-06T18:11:44.647 回答 This answer is useful 0 您设置分组的方式不是列表，而是元组： StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); var response = new List { new {oStructA = myStructA} , new {oStructB = myStructB } }; 列表是一行中的许多项目。你有两个并排的项目。你可以这样做 List items = new List items.Add(myStructA); items.Add(myStructB); 现在这两个项目都在一个列表中。但是拥有一个List总是错误的。 但是，您可以将这两个项目放入一个元组中，如下所示： Tuple <stucttypea, structtypeb="">resultSet = new Tuple<stucttypea, structtypeb="">(myStructA, myStructB); 而只是返回它。 于 2013-02-06T18:11:57.930 回答 This answer is useful 0 您使用匿名对象作为列表中的项目。匿名对象被设计为在单个方法的范围内使用，而不是暴露给其他方法。这样做是可能的，但很困难并且会产生很多问题。 从根本上看来，您要做的只是从您的方法中返回两个对象。您遇到了只能返回一个对象的事实，因此您正试图解决这个问题。您的直觉是将这些项目放入列表并返回。您进一步决定将对象放入匿名对象中，然后再将它们放入列表中。为了使用更标准的编码约定来解决这个问题，我们需要退出。首先，您不应该List在这种情况下使用 a 。 您想创建一些可以保留这两个对象的类型；它应该有两个属性，每个对象一个。如果你愿意，你可以自己制作，如果有一个逻辑“类型”代表这两种结构。如果这真的没有意义，并且您认为在这种情况下不值得付出努力，您可以使用现有的通用持有者，称为Tuple. public Tuple <structtypea, structtypeb="">myFunction() { StructTypeA myStructA = new StructTypeA(); StructTypeB myStructB = new StructTypeB(); return Tuple.Create(myStructA , myStructB); } 现在从调用者的角度来看，我们知道我们得到了一个Tuple有两个项目的 a，第一个是 type StructTypeA，第二个是 type StructTypeB。 var returnValues = myFunction(); var myStr = returnValues.Item1.sString1 于 2013-02-06T18:23:55.003 回答 This answer is useful -2 var structA = retVal.OfType<structtypea>().First(); var myStr = structA.sString1; 记得包括一个 using System.Linq; 于 2013-02-06T18:11:56.410 回答 Related 1 github - Jenkins-github 存储库错误（Windows） 1 javascript - 如何保存在 JSON 文件中 1 c# - 第一次机会异常访问路径被拒绝 (UnauthorizedAccessException) 1 c# - 尝试通过 SQL 从另一个表获取 ID 插入访问数据库 2 c++ - 如何在对象容器中搜索数据成员值？ 3 php - 不从链接将数据插入数据库 1 string - Matlab 函数 - 如何使用字符串输入访问结构？ 1 xsd - 参考 XML 模式扩展 2 javascript - 将多条数据传递给 JQuery 对象 1 ios - JSON AFNetworking iOS 6 查看值是否为“on” Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14735836
> 
> 赞同：2
> 
> 时间：
> 
> 标签：c#, structure

I want to access the Structures returned by a function in a List. I am not able to do it as it is causing Compiler errors.

```
public class StructTypeA
{
        public string sString1;
        public string sString2;
}
public class StructTypeB
{
        public int iNum1;
        public int iNum2;
}

public List<object> myFunction ()
{

        StructTypeA myStructA = new StructTypeA();
        StructTypeB myStructB = new StructTypeB();

        var response = new List<object> { new {oStructA = myStructA} , new {oStructB = myStructB } };

            return response;
}

public void myCallerFunction()
{
    var retVal = myFunction ();

//This does not work, it generates a compile error
// 'object' does not contain a definition for 'oStructA' and no extension method 'oStructA' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?)
    var myStr = retVal[0].oStructA.sString1;

//How can I access the structures.
} 
```

I want to access the structures oStructA and oStructB, Please tell me what the exact syntax should be.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:17:39.503

您将返回 a `List<object>`，因此`retVal[0]`将是 type `object`，它没有`oStructA`成员。

您正在创建一个`List`包含匿名类型实例的 。在创建类型的范围之外，您将无法按名称访问这些成员。

您必须为列表创建一个命名类型：

```
class MyType
{
    public StructTypeA oStructA { get; set; }
    public StructTypeB oStructB { get; set; }
} 
```

然后对您的方法进行编码以返回一个`List<MyType>`.

创建这种类型的实例就像创建匿名类型的实例一样。使用您的代码示例，只需在**new**之后添加类型名称：

```
var response = new List<object> { new MyType {oStructA = myStructA} , new Mytype {oStructB = myStructB } }; 
```

或者你可以使用一个[Tuple](http://msdn.microsoft.com/en-us/library/dd268536.aspx)，并返回一个列表。

或者，正如其他人所说，使用`dynamic`. 不过，我一般不建议这样做。命名类型可能是最好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T18:14:20.363

**请`object`在不需要时停止使用类型和匿名类型**。

C# 是一种类型安全的语言，这是发生在你身上的最好的事情，所以**请**`Tuple<T1, T2>`尽可能使用类型以外的类型（例如） `object`。

```
public List<Tuple<StructTypeA, StructTypeB>> myFunction()
{
    StructTypeA myStructA = new StructTypeA();
    StructTypeB myStructB = new StructTypeB();

    return new List<Tuple<StructTypeA, StructTypeB>> 
    {
        new Tuple<StructTypeA, StructTypeB>(myStructA, myStructB) 
    };
}

public void myCallerFunction()
{
    var retVal = myFunction();
    var oStructA = retVal[0].Item1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T18:28:39.830

我认为OP对待做这样的事情：

```
public class StructTypeA
{
        public string sString1;
        public string sString2;
}
public class StructTypeB
{
        public int iNum1;
        public int iNum2;
}

public static List<object> myFunction ()
{

        StructTypeA myStructA = new StructTypeA();
        StructTypeB myStructB = new StructTypeB();

        var response = new List<object> { myStructA , myStructB };

            return response;
}

public static void Main()
{
    var retVal = myFunction ();

//This does not work, it generates a compile error
// 'object' does not contain a definition for 'oStructA' and no extension method 'oStructA' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?)

    var myStr1 = ((StructTypeA)retVal[0]).sString1;
    var myStr2 = ((StructTypeB)retVal[1]).iNum1;

//How can I access the structures.
} 
```

***显然，@Jim Mischel 的建议非常正确。***

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T18:11:44.647

我想不出你想要这样做的实际原因，但是......

```
public List<dynamic> myFunction ()
{

        StructTypeA myStructA = new StructTypeA();
        StructTypeB myStructB = new StructTypeB();

        var response = new List<dynamic> { new {oStructA = myStructA} , new {oStructB = myStructB } };

            return response;
} 
```

当您创建匿名对象列表时，应该这样做。类型的使用`dynamic`可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T18:11:57.930

您设置分组的方式不是列表，而是元组：

```
StructTypeA myStructA = new StructTypeA();
StructTypeB myStructB = new StructTypeB();

var response = new List<object> { new {oStructA = myStructA} , new {oStructB = myStructB } }; 
```

列表是一行中的许多项目。你有两个并排的项目。你可以这样做

```
List<Object> items = new List<Object>
items.Add(myStructA);
items.Add(myStructB); 
```

现在这两个项目都在一个列表中。但是拥有一个`List<Object>`总是***错误***的。

但是，您可以将这两个项目放入一个元组中，如下所示：

```
Tuple<StuctTypeA, StructTypeB> resultSet = 
     new Tuple<StuctTypeA, StructTypeB>(myStructA, myStructB); 
```

而只是返回它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T18:23:55.003

您使用匿名对象作为列表中的项目。匿名对象被设计为在单个方法的范围内使用，而不是暴露给其他方法。这样做是*可能的*，但很困难并且会产生*很多*问题。

从根本上看来，您要做的只是从您的方法中返回两个对象。您遇到了只能返回一个对象的事实，因此您正试图解决这个问题。您的直觉是将这些项目放入列表并返回。您进一步决定将对象放入匿名对象中，然后再将它们放入列表中。*为了使用更标准的编码约定来解决这个问题，我们*需要退出。首先，您不应该`List`在这种情况下使用 a 。

您想创建一些可以保留这两个对象的类型；它应该有两个属性，每个对象一个。如果你愿意，你可以自己制作，如果有一个逻辑“类型”代表这两种结构。如果这真的没有意义，并且您认为在这种情况下不值得付出努力，您可以使用现有的通用持有者，称为`Tuple`.

```
public Tuple<StructTypeA, StructTypeB> myFunction()
{
    StructTypeA myStructA = new StructTypeA();
    StructTypeB myStructB = new StructTypeB();

    return Tuple.Create(myStructA , myStructB);
} 
```

现在从调用者的角度来看，我们知道我们得到了一个`Tuple`有两个项目的 a，第一个是 type `StructTypeA`，第二个是 type `StructTypeB`。

```
var returnValues = myFunction();
var myStr = returnValues.Item1.sString1 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-02-06T18:11:56.410

```
var structA = retVal.OfType<StructTypeA>().First();
var myStr = structA.sString1; 
```

记得包括一个

```
using System.Linq; 
```</structtypea></structtypea,></stucttypea,></stucttypea,></dynamic></dynamic></structtypea,></tuple<structtypea,></tuple<structtypea,></t1,></mytype>

# php - PHP: Out of memory error after setting memory limit to -1

> ID：14735841
> 
> 赞同：0
> 
> 时间：2013-02-06T18:07:26.330
> 
> 标签：php, mysql, memory-management, memory-limit

I have a script in which I am fetching 725000 records at once and looping through to create array elements. Initially it says memory exhausted. Then, in my script I added-

```
ini_set('memory_limit', '-1'); 
```

After this, it throwing error-

```
Out of memory (allocated 1585446912) (tried to allocate 52 bytes) 
```

Any suggestion?

# html - hide an image for iphone screen

> ID：14735842
> 
> 赞同：-1
> 
> 时间：2013-02-06T18:07:27.783
> 
> 标签：html, css, media-queries

Using media queries i am trying to hide a image of cube for desktop and then replace it with another iphone image for the cube.... i am able to hide the desktop image for iphone but the iphone image is not appearing..... how to fix the issue.....

[http://jsfiddle.net/QYvrt/27/](http://jsfiddle.net/QYvrt/27/)

[http://jsfiddle.net/QYvrt/27/embedded/result/](http://jsfiddle.net/QYvrt/27/embedded/result/)

providing my code below

```
<div class="desktopContactImage" data-caption="&lt;a style='margin-left: 92px; font-size: 18px; color: grey;' href='http://www.w3schools.com/' &gt;Create&lt;/a&gt; &lt;div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;View/Edit&lt;/a&gt; &lt;/div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;Labels&lt;/a&gt;" data-image="http://www.defie.co/designerImages/inventoryControl.png">desktopImage</div>

 <div class="iphoneContactImage" data-caption="&lt;a style='margin-left: 92px; font-size: 18px; color: grey;' href='http://www.w3schools.com/' &gt;Create&lt;/a&gt; &lt;div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;View/Edit&lt;/a&gt; &lt;/div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;Labels&lt;/a&gt;" data-image="http://intra.defie.co/images/cubes/demoImage.png">iphoneImage</div>

@media (max-width: 767px) {

#rightSlider{
    border: 1px solid red;
}

#rightSlider{
            display:none !important;
          }
#rightSlider{ 
            display:inherit !important;
          }

.desktopContactImage{

            display:none !important;
          }

.iphoneContactImage{
            display:inherit !important;
            border: 1px solid red;
          }

}

#slidenav{
            display:none !important;
          }
#slidenav{ 
            display:inherit !important;
          }

}

@media (min-width: 768px) and (max-width: 979px) {

#rightSlider{
    border: 1px solid green;
}

}

/* Demo styling */
#rightSlider{
        display: none;
      }
#slidenav{
        display: none;
      }

     .iphoneContactImage{
        display: none;
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T02:50:57.893

而不是使用 display:inherit !important 来取消隐藏您可能想要尝试的元素

```
.iphoneContactImage{
  display:block;
  border: 1px solid red;
} 
```

如果这不起作用，您可以尝试这里提到的更多技术：[显示器上的转换：属性](https://stackoverflow.com/questions/3331353/transitions-on-the-display-property)

# android - Android parameterized view in xml

> ID：14735844
> 
> 赞同：1
> 
> 时间：2013-02-06T18:07:35.310
> 
> 标签：android, android-layout, parameterized

I've looking for a way to declare a parameterized view with in a layout. For example if I have a class `NumericTextView<T> extends TextView` I want to be able to declare it in an xml layout. The following doesn't seem like it will work because of the way the layout is parsed.

```
<NumbericTextView<Integer>/> 
```

But could I potentially have something like this?

```
<NumbericTextView type:Integer/> 
```

If that still won't work is there anything wrong with using some custom `FrameLayout` that switches on a parameter to add the correct `NumbericTextView<T>` child?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:11:03.267

您需要执行以下操作：

```
<com.my.ui.NumericTextView
    android:id="@+id/MyTextView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

看到[android自定义文本视图不能添加到布局文件中](https://stackoverflow.com/questions/4397205/android-custom-text-view-can-not-be-added-in-layout-file)

这用于自定义属性： http: [//prasanta-paul.blogspot.com/2010/05/android-custom-textview.html](http://prasanta-paul.blogspot.com/2010/05/android-custom-textview.html)

# php - Getting distance from Google Maps from a series of stops using ColdFusion

> ID：14735846
> 
> 赞同：0
> 
> 时间：2013-02-06T18:07:46.257
> 
> 标签：php, google-maps, coldfusion

My client makes deliveries and needs to record the mileage driven between each stop as well as a total miles for the day. The route is known ahead of time. The addresses are also known so I am able to obtain the lat/long of the addresses for Google maps. I'd like to get the distance for each leg and record them in the database for end of year reporting as well as a grand total of miles driven for the year (the grand total is the easy part so that doesn't really need to be addressed).

1) Is this possible with the current Google Maps API? I have the Google map key.
2) If yes, do you have a link to a demo that I can look at?

I'm coding this in ColdFusion but would be open to reverse engineering a PHP page.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T20:13:24.580

这是可能的，您必须请求[DirectionsService](https://developers.google.com/maps/documentation/javascript/directions)。服务响应将包含每个步骤的距离（[示例](https://developers.google.com/maps/documentation/directions/#JSON)），您只需要从响应中获取所需的数据。

注意：您最多只能请求具有 8 个航点的路线，当您的路线包含更多航点时，您必须拆分路线。

# javascript - Show/Hide multiple Divs with changing classes for trigger

> ID：14735847
> 
> 赞同：1
> 
> 时间：2013-02-06T18:07:50.793
> 
> 标签：javascript, jquery, html, toggle

I don´t work much with javascript and I googled a lot the last few hours to figure out my problem. I guess I just don´t know the right words to search for.

This is what I want to achieve. A list of Links with a small arrow next to it. When you click on a link, a hidden div is shown and the arrow should move down to show that the text is "open". When I click on another text, the arrow should move up again and the div should be hidden. The other div would open accordingly. But the code is still a bit buggy. When I click on a link it gets the class "expanded" - but this class is not being automatically removed when I click on another item.

Here is my code so far... It doesnt work at all on jsfiddle, don´t know why [http://jsfiddle.net/DvH75/](http://jsfiddle.net/DvH75/)

```
var _hidediv = null
   function showdiv(id) {
   if(_hidediv)
      _hidediv();
   var div = document.getElementById(id);
   div.style.display = 'block';
    $(".toggle").on("click", function(){
        $(this).toggleClass("expanded");
      });
   _hidediv = function () { div.style.display = 'none'; };
   } 
```

And this is an example of what I want to archieve. The only difference is that I want an open item to close once another is opened: [https://www.facebook.com/help/473865172623776/](https://www.facebook.com/help/473865172623776/)

I hope you understand my question and can help me Thank you very much!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:29:34.377

我想这就是你要找的。只需隐藏所有包含的 div 并显示当前的。您不需要跟踪最后一个。

```
$(function() {
$(".fade_text .toggle").on("click", function (e) {
    e.preventDefault();
    $(".fade_text div").hide();
    $(".fade_text .toggle").removeClass("expanded");
    $(this).addClass("expanded").next("div").show();
});
}); 
```

小提琴：http: [//jsfiddle.net/4JFcK/4/](http://jsfiddle.net/4JFcK/4/)

编辑：还可以在单​​击时删除所有展开的锚点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:11:30.440

您的 toggleClass() 调用正在将类添加到单击的类中，但我没有看到您删除了前一个单击的类。我会做的是这样的：

```
$('.expanded').each(function() {
    $(this).removeClass('expanded');
}); 
```

**编辑：工作示例**

我在 jsFiddle 上花了一些时间，得到了[这个工作示例](http://jsfiddle.net/7pXpK/)（警告，jsFiddler 在 IE8 中似乎不起作用，所以使用 FireFox 或 Chrome 来查看示例）。

首先，我删除了*'display: none;* ' 来自 main.css 中的**UL.fade_text li div**样式，因为不再需要它。

接下来，我为所有 *div*s 添加了类标记。我本可以做点别的，但这是一个简单粗暴的例子。

最后，我重新编写了 JS，使其更加 jQuery 风格。我创建了一个函数，该函数将根据它是否找到一个带有类切换的锚标记来显示或隐藏 div，该类切换也扩展了类。然后，我再次使用 jQuery 为所有锚标记添加了一个单击事件处理程序，该处理程序调用 showHideDivs() 函数。我还在 $(document).ready() 中添加了对 showHideDivs() 的调用，以便正确设置初始状态。

这是新的 JS 代码。可能会稍微优化一下，但它的工作方式与我预期的一样：

```
$(document).ready(function () {
    function showHideDivs() {
        $('.showHideDiv').each(function () {
            if ($(this).prevAll('a.toggle:first').hasClass('expanded')) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    }

    $('a.toggle').click(function () {
        var addExpanded = !$(this).hasClass('expanded');
        $('a.toggle').removeClass('expanded');
        if(addExpanded) {
            $(this).addClass('expanded');
        }
        showHideDivs();
    });

    showHideDivs();
}); 
```

我认为这种方法的好处是，对于那些 JS 有问题或只是关闭 JS 的浏览器，它会优雅地降级。最终结果是这些人会看到所有 div 标签都展开了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:17:58.300

使用 jsFiddle 中的 HTML，下面的 jQuery 应该可以按预期工作：

```
$('a.toggle').on('click', function(e) {
    e.preventDefault();
    $(this).toggleClass('expanded').next('div').toggleClass('open');
}); 
```

只要您`.open`在 CSS 中声明该类：

```
ul.fade_text li div.open { display: block; } 
```

更新小提琴：http: [//jsfiddle.net/DvH75/3/](http://jsfiddle.net/DvH75/3/)

此外，您不需要`onclick="showdiv('astro-1'); return false;"`在`<a>`标签上使用不显眼的脚本。

# mysql - Join all rows from two different tables MySQL

> ID：14735851
> 
> 赞同：0
> 
> 时间：2013-02-06T18:08:15.717
> 
> 标签：mysql, join, union

I've been trying to join all the rows from two different tables. I've tried UNION and LEFT JOIN.

Right now I've just been using two separate queries and had one display after the other. I would like to merge the two queries to display at the same time.

table 1 is called 'approves' and table 2 is called 'comments'.

> approves
> - id
> - postID
> - postUserID
> - userID
> 
> comments
> - id
> - postID
> - postUserID
> - userID
> - comment
> - date

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T18:24:31.257

这是一个 UNION 的例子

```
select id, postID, postUserID, userID, comment, date from comments
union
select id, postID, postUserID, userID, null, null from approves 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:10:28.727

你能插入你正在使用的 SQL 吗？联合将合并两个表，连接将依次从表中获取所有行并合并所有关联的行。JOIN 默认为内连接。UNION 实际上将合并来自两个表的结果。如果您想要 a 中的所有行以及表 b 中的相应注释，则使用左连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:16:22.313

根据您的表格，您可以`JOIN`使用以下表格：

```
select *
from approves a
inner join comments c
    on a.userid = c.userid
    and a.postid = c.postid 
```

我猜您将需要基于`postid`和连接多个列上的表`userid`。

我使用了`INNER JOIN`将返回两个表之间的所有匹配行。如果您只想返回`approves`表中的那些记录，那么您可以使用`LEFT JOIN`. 如果您在学习连接语法方面需要帮助，这里有一个[关于连接的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

您可以使用 a`UNION`但必须为每个表选择所需的列，因为 a 的每个查询中的列数`UNION`必须相等。所以`UNION`会是：

```
select id, postid, postUserId, userId, null as comment, null as date, 'approves' as Src
from approves 
union all
select id, postid, postUserId, userId, comment, date, 'comments' as src
from comments 
```

请注意，我包含了一个名为的附加列`src`，可用于确定数据来自哪个表。

# sql - Joining job column and Dname column from emp table and dept table

> ID：14735853
> 
> 赞同：0
> 
> 时间：2013-02-06T18:08:28.540
> 
> 标签：sql, oracle10g

```
SELECT ENAME, EMP.JOB,DEPT.DNAME
FROM EMP, DEPT
WHERE EMP.JOB=DEPT.DNAME; 
```

This is giving the output as "no rows selected".

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T05:41:22.827

假设这`EMP.JOB=DEPT.DNAME`是正确的（我无法想象），您的查询实际上是正确的，您可以像这样加入：

```
SELECT ENAME, EMP.JOB,DEPT.DNAME
FROM EMP inner join DEPT
ON EMP.JOB=DEPT.DNAME; 
```

但这不会提供比您的查询更多的结果，我想问题是您令人困惑的列，通常引用是通过 id 列完成的。

`EMP.JOB`例如，可能是*开发人员*或*程序员*的想法将匹配例如`DEPT.DNAME`在这种情况下将是*开发部门*的想法有点奇怪，我想你再看看你的表是如何相互连接的。

从您的数据库生成可视化图表可能会有所帮助，请查看此线程以获取更多信息：[Tools to generate a database diagram/ER diagram from existing Oracle database?](https://stackoverflow.com/questions/2091599/tools-to-generate-a-database-diagram-er-diagram-from-existing-oracle-database)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T18:13:17.400

我不确定你想要什么 - 工作永远不会等于部门名称......这是正确的 join -copy/paste 运行并查看结果：

```
SELECT d.deptno, ENAME, JOB, DNAME 
  FROM scott.EMP e, scott.DEPT d
 WHERE e.deptno = d.deptno
ORDER BY d.deptno
/ 
```

仅供参考：EMP.JOB=DEPT.DNAME 永远不会像原始问题/查询中那样正确。

# jquery - String manipulation in jquery using regex

> ID：14735854
> 
> 赞同：-1
> 
> 时间：2013-02-06T18:08:29.180
> 
> 标签：jquery, html, regex, performance

I want to extract the url to download a file when user clicks on the image. the url of the image contains the url of the document as `/Image/_Z_/Catalog_doc.jpg`

Then user clicks I call a jQuery function `fetchAndOpen(this)`

In this method I would like to build proper file url i.e. : `/Docs/Catalog.doc`

So basically my issue is image extension (.jpg or .png or any other) second thing I want to remove `/_Z_/` (this is hard coded predefined) and the last thing I want to replace `_` with `.` with the document extension.

Is there any regex or some simple solution of jQuery that can help me i know this can be easily done in javascript with `substring` and `lastIndexOf` methods but i expecting some thing with jquery / regex or other jquery based way out.

INPUT: /Image/*Z*/Catalog_doc.jpg -> OUTPUT: /Docs/Catalog.doc

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:54:19.873

给定输入：/Image/ *Z* /Catalog_doc.jpg 预期输出：/Docs/Catalog.doc

我只是将这个过程分解为多个步骤，以展示从你拥有的东西到你想要的东西的转变。如果您愿意，您可以在正则表达式中执行此操作，但此过程很容易绘制出来，并且考虑到它不会作为一个耗时的过程发生，您无需担心执行多个步骤的性能。

[http://jsfiddle.net/cgEt3/](http://jsfiddle.net/cgEt3/)

```
var input = '/Image/_Z_/Catalog_doc.jpg';
var output = input.split('/');
output = output[output.length-1]; // get the last part, now output is Catalog_doc.jpg
var ext = output.lastIndexOf('.');
output = output.substring(0, ext); // now just 'catalog_doc';
ext = output.lastIndexOf('_');
output = output.substring(0, ext) + '.' + output.substring(ext+1); // now 'catalog.doc';
output = '/Docs/' + output;

document.write(output); 
```

# objective-c - 将 setSuppressesIncrementalRendering 属性添加到 UIWebView

> ID：14735861
> 
> 赞同：0
> 
> 时间：2013-02-06T18:08:54.617
> 
> 标签：objective-c, properties, uiwebview

试图用一个非常简单的 UIWebView iPhone 应用程序让我的脚湿透。我在 ViewController.m 中有以下代码：

```
UIWebView *webView = [[UIWebView alloc] initWithFrame:self.view.frame];
NSString *urlAddress = @"https://mysite.com/";

NSURL *url = [NSURL URLWithString:urlAddress];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[webView loadRequest:request];
[self.view addSubview:webView];
[super viewDidLoad]; 
```

我想将 setSuppressesIncrementalRendering 属性添加到此 UIWebView 但我是 Objective C 的新手。任何指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:22:59.670

简单地

```
[webView setSuppressesIncrementalRendering:YES]; 
```

# algorithm - Find near duplicate binary files (.lib,.bin)

> ID：14735862
> 
> 赞同：0
> 
> 时间：2013-02-06T18:08:55.683
> 
> 标签：algorithm, gcc, compiler-construction, diff, decompiling

Scenario is: Though the source-code doesn't change, I'm seeing that the the compiled lib/bin files are having difference though It's compiled by same compiler and with same dependencies.

Since it's not a text file, I'm deprived of ideas, as we cannot use levenshtein distance, or pattern matching.

Another idea would be if, I'm able to add some salt to the source files, so that It is detectable in the compiled binaries?

Any ideas would be great, Since I have a huge no.of libs, I'm afraid it would be practically impossible for a Machine learning to be put in place.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:14:56.867

用于`objdump`转储两个二进制文件并使用文本比较工具比较结果。我不知道您需要检查哪些部分，但我猜想更改（因此不应包括在内）的部分是：.gnu.hash、.gnu_debuglink。

```
$ objdump -h /bin/sh

/bin/sh:     file format elf64-x86-64

Sections:
Idx Name          Size      VMA               LMA               File off  Algn
  0 .interp       0000001c  0000000000400238  0000000000400238  00000238  2**0
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  1 .note.ABI-tag 00000020  0000000000400254  0000000000400254  00000254  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  2 .note.gnu.build-id 00000024  0000000000400274  0000000000400274  00000274  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  3 .gnu.hash     000036f8  0000000000400298  0000000000400298  00000298  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  4 .dynsym       0000cbd0  0000000000403990  0000000000403990  00003990  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  5 .dynstr       000083cf  0000000000410560  0000000000410560  00010560  2**0
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  6 .gnu.version  000010fc  0000000000418930  0000000000418930  00018930  2**1
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  7 .gnu.version_r 000000b0  0000000000419a30  0000000000419a30  00019a30  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  8 .rela.dyn     000000c0  0000000000419ae0  0000000000419ae0  00019ae0  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  9 .rela.plt     000012f0  0000000000419ba0  0000000000419ba0  00019ba0  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
 10 .init         00000018  000000000041ae90  000000000041ae90  0001ae90  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
 11 .plt          00000cb0  000000000041aeb0  000000000041aeb0  0001aeb0  2**4
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
 12 .text         0008f088  000000000041bb60  000000000041bb60  0001bb60  2**4
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
 13 .fini         0000000e  00000000004aabe8  00000000004aabe8  000aabe8  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
 14 .rodata       0001d790  00000000004aac00  00000000004aac00  000aac00  2**5
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
 15 .eh_frame_hdr 00003cdc  00000000004c8390  00000000004c8390  000c8390  2**2
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
 16 .eh_frame     00013a0c  00000000004cc070  00000000004cc070  000cc070  2**3
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
 17 .ctors        00000010  00000000006dfe08  00000000006dfe08  000dfe08  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 18 .dtors        00000010  00000000006dfe18  00000000006dfe18  000dfe18  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 19 .jcr          00000008  00000000006dfe28  00000000006dfe28  000dfe28  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 20 .dynamic      000001b0  00000000006dfe30  00000000006dfe30  000dfe30  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 21 .got          00000008  00000000006dffe0  00000000006dffe0  000dffe0  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 22 .got.plt      00000668  00000000006dffe8  00000000006dffe8  000dffe8  2**3
                  CONTENTS, ALLOC, LOAD, DATA
 23 .data         00008430  00000000006e0660  00000000006e0660  000e0660  2**5
                  CONTENTS, ALLOC, LOAD, DATA
 24 .bss          00005b88  00000000006e8aa0  00000000006e8aa0  000e8a90  2**5
                  ALLOC
 25 .gnu_debuglink 0000000c  0000000000000000  0000000000000000  000e8a90  2**0
                  CONTENTS, READONLY 
```

# windows - WMI - two way authentication

> ID：14735864
> 
> 赞同：2
> 
> 时间：2013-02-06T18:08:57.480
> 
> 标签：windows, security, authentication, wmi, wbem

I've been unable to find this information on MSDN. How can I implement two-way authentication for WMI (or, if that is not possible, using Windows' implementation of WBEM?).

What I want to accomplish is for the client to authenticate the server, and the server authenticate the client via certificate exchange, irregardless of the user credentials.

# java - 为什么克隆数组这么慢？

> ID：14735869
> 
> 赞同：7
> 
> 时间：2013-02-06T18:09:17.937
> 
> 标签：java, performance, clone

本次测试

```
 for (;;) {
            int[] a = new int[10];
            System.gc();
            long t0 = System.currentTimeMillis();
            for (int i = 0; i < 1000000; i++) {
//              int[] b =  a.clone();
                int[] b =  Arrays.copyOf(a, a.length);
            }
            System.out.println(System.currentTimeMillis() - t0);
        } 
```

显示 Arrays.copyOf 约 50 毫秒，克隆约 160 毫秒。克隆是一种特殊的原生复制方法，为什么这么慢？

我在我的 HotSpot Client JVM 1.7.0_11-b21 上运行了测试。请注意，当数组大小增加时，clone 和 copyOf 之间的差异就会消失。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T18:23:46.593

我在我的系统上运行了你的代码：它们之间几乎没有区别。两者的时钟都在大约 30 毫秒。我的测试是在 OpenJDK 7 上进行的。

为了确认我也通过 Caliper 运行它，并使用更大的数组来强调实际的复制性能：

```
public class Performance extends SimpleBenchmark {
  final int[] source = new int[1000];

  public int timeClone(int reps) {
    int sum = 0;
    for (int i = reps; i > 0; i--)
      sum += source.clone().length;
    return sum;
  }

  public int timeCopyOf(int reps) {
    int sum = 0;
    for (int i = reps; i > 0; i--)
      sum += Arrays.copyOf(source,source.length).length;
    return sum;
  }
  public static void main(String... args) {
    Runner.main(Performance.class, args);
  }
} 
```

结果：

```
 0% Scenario{vm=java, trial=0, benchmark=Clone} 2141.70 ns; σ=5416.80 ns @ 10 trials
50% Scenario{vm=java, trial=0, benchmark=CopyOf} 2168.38 ns; σ=1545.85 ns @ 10 trials

benchmark   us linear runtime
    Clone 2.14 =============================
   CopyOf 2.17 ==============================

vm: java
trial: 0 
```

根据请求，这里的数组大小为 10：

```
 0% Scenario{vm=java, trial=0, benchmark=Clone} 30.07 ns; σ=2.12 ns @ 10 trials
50% Scenario{vm=java, trial=0, benchmark=CopyOf} 29.34 ns; σ=161.38 ns @ 10 trials

benchmark   ns linear runtime
    Clone 30.1 ==============================
   CopyOf 29.3 ============================= 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T05:12:12.843

我找到了一篇很好的文章，解释了为什么克隆在这里很慢[http://www.javaspecialists.eu/archive/Issue124.html](http://www.javaspecialists.eu/archive/Issue124.html)。简而言之，这是因为 int[].clone 仅使用 Object.clone 并且此方法在复制数组之前进行了两次检查：

1.检查实例是普通对象还是数组。

2.检查数组是基元还是对象。

我将这些检查添加到 Arrays.copyOf 测试

```
 for (int i = 0; i < 1000000; i++) {
            Class cls = a.getClass();
            if (cls.isArray() && !cls.getComponentType().isAssignableFrom(Object.class)) {
                int[] b = Arrays.copyOf(a, a.length);
            }
        } 
```

并且测试表明 clone 和 Arrays.copyOf 之间没有区别。如果它是阵列克隆的专用版本，将会很快。

# android - Android ToggleButton 自定义样式未应用

> ID：14735870
> 
> 赞同：2
> 
> 时间：2013-02-06T18:09:17.847
> 
> 标签：android, android-listview, android-button

我按照[这个示例](http://www.mokasocial.com/2011/07/sexily-styled-toggle-buttons-for-android/)将一些自定义主题应用于我的切换按钮，但是当我运行我的应用程序时，我看到了通用的 android 切换图标 - 我想我在这里或那里缺少一个设置，并且可以使用一组额外的眼睛。

我有一个用于的布局`ListView`，我正在尝试将自定义可绘制对象用于选中/未选中状态，默认情况下每个切换状态都设置为 CHECKED：

```
<ToggleButton
        android:id="@+id/profile_item_value_text"
        style="@style/ProfileTagTheme"
        android:layout_width="0px"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:textSize="16dp"
        android:textColor="@color/black"
        android:layout_gravity="center"
        android:gravity="center_vertical|center_horizontal"
        android:checked="true" /> 
```

这是我的`styles`文件中的内容`ProfileTagTheme`：

```
<style name="Widget.Button.Toggle" parent="android:Widget">
    <item name="android:background">@drawable/profile_btn_toggle_bg</item>
    <item name="android:disabledAlpha">@android:attr/disabledAlpha</item>
</style>
<style name="ProfileTagTheme" parent="android:Theme.Black">
    <item name="android:buttonStyleToggle">@style/Widget.Button.Toggle</item>
</style> 
```

反过来，`profile_btn_toggle_bg.xml`生活在我的主`drawable`目录中：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@android:id/background" android:drawable="@android:color/transparent"/>
    <item android:id="@android:id/toggle" android:drawable="@drawable/profile_btn_toggle"/>
</layer-list> 
```

其中引用`profile_btn_toggle`，就在它旁边：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_checked="true" android:drawable="@drawable/tag_active" /> <!-- pressed -->
    <item android:drawable="@drawable/tag" /> <!-- default/unchecked -->
</selector> 
```

我已经验证了自定义图像存在于 drawables 目录中，所以显然要么我误解了样式级联的方式，要么我在这种风格的疯狂中缺少参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T21:22:28.510

所以看来我唯一真正的问题是在我的实现中缺少这个`android:background`元素；`ToggleButton`所以对上面代码的唯一更改是添加该元素，例如

```
<ToggleButton
        android:id="@+id/profile_item_value_text"
        style="@style/ProfileTagTheme"
        android:background="@drawable/profile_btn_toggle_bg"
        android:layout_width="0px"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:textSize="16dp"
        android:textColor="@color/black"
        android:layout_gravity="center"
        android:gravity="center_vertical|center_horizontal"
        android:checked="true"
        android:onClick="onToggleClicked" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:20:54.057

我在我的一些应用程序中做了类似的事情。请记住，这是一种完全不同的样式方法，可能/可能不适用于您的情况。通过设置背景，我可以为我的切换按钮设置我想要的图像：

```
<ToggleButton
    android:id="@+id/tb_useNotificationShortcuts"
    android:layout_width="100dp"
    android:layout_height="25dp"
    android:layout_gravity="center"
    android:background="@drawable/togglebutton"
    android:tag="21" />

<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

   <item android:drawable="@drawable/custom_toggle_on" android:state_checked="true"/>
   <!-- pressed -->
   <item android:drawable="@drawable/custom_toggle_off"/>
   <!-- default/unchecked -->

</selector> 
```

custom_toggle_on 和 custom_toggle_off 是我的图像，这些也可能是您的图层列表。

# c# - 在aspx后面的代码中调用函数？

> ID：14735885
> 
> 赞同：1
> 
> 时间：2013-02-06T18:09:58.543
> 
> 标签：c#, asp.net

我有这个：

```
<ItemTemplate>
    <asp:CheckBox ID="cbRemove" runat="server" 
        Visible='<%# (string)Eval("GroupDescription") != "Default" %>' />
</ItemTemplate> 
```

唯一的问题是，它可能不是“默认”。有没有一种方法可以在我的代码中调用像 GetDefaultName 这样的函数来从数据库中获取它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:33:22.717

它会帮助你...

```
(string)Eval("GroupDescription") != "Default" ? GetDefaultName() : "Default" 
```

在你的类文件写入函数中，如下所示..

```
protected string GetDefaultName()
{
    return "Your Default Name";
} 
```

但我不**明白你为什么将它传递给 Visible Property....？**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T18:22:30.840

在您的标记中，调用这样的服务器端函数：

```
Visible = '<%# GenerateVisibility()  %>' 
```

在你后面的代码中，创建一个这样的函数：

```
protected bool GenerateVisilbity()
{
//other code here if needed... such as your GetDefaultName()
//do your logic and decide whether or not to return a "true" or "false" boolean

//sample return value below
return Eval("GetDefaultName");//must return boolean value

} 
```

*编辑以返回布尔值，早些时候我从我的打开项目中获取它，正在使用它来返回自定义 javascript 函数作为字符串以绑定到客户端事件...

# database - 在 11g R2 之后支持 Oracle Streams

> ID：14735890
> 
> 赞同：1
> 
> 时间：2013-02-06T18:10:09.350
> 
> 标签：database, oracle, replication, deprecated, oracle12c

我正在寻找有关 Oracle 未来 Streams（一种数据复制技术）计划的信息。在未来的版本中会继续支持吗？

现在我只有这个简短的参考：

[Oracle Base Oracle 12C 文章](http://www.oracle-base.com/articles/12c/articles-12c.php)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:19:54.340

听起来您在询问 Oracle 的[GoldenGate 方向声明](http://www.oracle.com/technetwork/middleware/goldengate/overview/statement-of-direction-gg-132120.pdf)。具体来说，关于 Streams 未来的部分

> Oracle Streams 将继续受支持，但不会增强以支持未来版本中的任何新数据库特性。这意味着 Streams 将在未来的版本中继续完全支持它今天 (11.2) 所支持的内容。这也意味着 Streams 将不支持任何新的数据库特性、数据类型或功能。想要利用新数据类型和特性的客户需要获得 Oracle GoldenGate 许可。

# mysql - SQL 查询不工作查询

> ID：14735897
> 
> 赞同：0
> 
> 时间：2013-02-06T18:10:28.517
> 
> 标签：mysql, sql

有人知道问题出在哪里吗？它一定只是逗号或拼写错误，但我正在看这 5 行 2 小时，但仍然看不到它，也许有人可以很快看到它。

错误 SQL 查询：

```
INSERT INTO SalesOrder
(

Customer, ContactName, Phone, Email, BillingAddress1, BillingAddress2, BillingCity, BillingState, BillingCountry, BillingPostalCode, BillingAddressRemarks, ShipToCompanyName, ShippingAddress1, ShippingAddress2, ShippingCity, ShippingState, ShippingCountry, ShippingPostalCode, ShippingAddressRemarks, CurrencyCode, ExchangeRate, PricingScheme, PaymentTerms, TaxingScheme, Tax1Rate, Tax2Rate, CalculateTax2OnTax1, Tax1Name, Tax2Name, TaxOnShipping, Custom1, Custom2, Custom3, ItemName, ItemDescription, ItemQuantity, ItemQuantityUoM, ItemUnitPrice, ItemDiscount, ItemSubtotal, ItemTaxCode
) VALUES (
'Yu',  'Yau ',  '01224 580318',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',  'GBP',  '1',  '',  '',  '', 0, 0,  'FALSE',  '',  '',  'FALSE',  '',  '',  '',  'Vg0003',  'Apple Green', 2,  'box',  '15.5',  '0%';

MySQL said: 

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Customer,ContactName,Phone,Email,BillingAddress1,BillingAddress2,BillingCity,Bil' at line 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T18:12:43.280

缺少右括号：

```
VALUES ( ... ) ;
            ^^^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:14:54.117

可能是因为您在值之后错过了右括号。它应该正确地采用以下形式：

```
$sql = mysql_query("INSERT INTO table () VALUES ()"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:39:40.547

此评论位于答案框中，因此它会显示得更好。另外两个答案是正确的。

如果您像这样键入查询，则此类问题的发生频率将降低：

```
insert into yourtable 
(f1
, f2
, f3
-- etc
, f10
)
values
(v1
, v2
, v3
-- etc
, v10
) 
```

它使您的所有括号都可见。您不太可能有额外的逗号。此外，在开发查询时，如果遇到困难，更容易注释掉字段和值集。

# iphone - SBSettings 切换没有反应

> ID：14735901
> 
> 赞同：2
> 
> 时间：2013-02-06T18:10:49.157
> 
> 标签：iphone, ios, toggle, jailbreak

在看到切换后，我编写了一个小切换来启用和禁用振动，它只会在静音模式下停用振动。为此，我在 plist 文件中更改了布尔值，效果很好。我什至可以在 Settings.app 中看到结果。但我的问题是，它会像什么都没发生一样振动。我如何告诉 iPhone，plist 文件中的某些内容发生了变化，但没有重新启动？

请帮我。

ps：当您想查看我的代码时，我已将重要部分复制并粘贴在这里：

```
void setState(BOOL enable) // required; called when user presses toggle button
{
    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.apple.springboard.plist"];

    if (enable) // toggle is disabled, so enable it
    {
        [dict setObject:[NSNumber numberWithBool:YES] forKey:@"ring-vibrate"];
        [dict setObject:[NSNumber numberWithBool:YES] forKey:@"silent-vibrate"];
        AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);
    }
    else // toggle is enabled, so disable it
    {
        [dict setObject:[NSNumber numberWithBool:NO] forKey:@"ring-vibrate"];
        [dict setObject:[NSNumber numberWithBool:NO] forKey:@"silent-vibrate"];
    }

    [dict writeToFile:@"/var/mobile/Library/Preferences/com.apple.springboard.plist" atomically:YES];

    isToggleEnabled = enable; // for getStateFast() use
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T22:05:55.227

行。我有问题。我忘了推送通知

```
notify_post("com.apple.springboard.ring-vibrate.changed"); 
```

可以使用终端中的“notificationWatcher”命令检查此通知。

# php - 如何从最新的三行中随机获取？

> ID：14735909
> 
> 赞同：1
> 
> 时间：2013-02-06T18:11:22.190
> 
> 标签：php

我想知道如何从表中的最新三行中挑选一个。

我有这个：

```
"SELECT * FROM blog_content ORDER BY id DESC LIMIT 0,3" 
```

我想：将结果保存在一个数组中并随机 0-2 并从数组中选择，但这不起作用，因为有很多行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:15:50.077

如果我理解正确，您想从最新的 3 中随机选择一个。尝试子查询：

```
SELECT * FROM (SELECT * FROM blog_content ORDER BY id DESC LIMIT 0,3) t ORDER BY RAND() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T18:15:52.680

```
SELECT * FROM
    (SELECT * FROM blog_content ORDER BY id DESC LIMIT 0,3) last_three
ORDER BY RAND() LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T18:23:32.223

`SELECT * FROM (SELECT * FROM blog_content ORDER BY id DESC LIMIT 0,3) AS recentBlogs ORDER BY RAND() LIMIT 1`

为我工作。

# c# - 命名管道在写入时挂起

> ID：14735913
> 
> 赞同：4
> 
> 时间：2013-02-06T18:11:35.927
> 
> 标签：c#, pipe, named-pipes

我正在制作一个多客户端命名管道服务器。客户端正确连接到服务器，但是每当我尝试通过服务器或客户端写入管道时，代码都会挂在 write 方法上。为什么写方法卡住了？

服务器代码：

```
public void ListenForConnections()
{
    Thread startListening = new Thread(AcceptConnections);
    startListening.Start(PipeName);
}

public static void AcceptConnections(object ServerPipeName)
{
    while (true)
    {
        try
        {
            NamedPipeServerStream pipeServer = 
                 new NamedPipeServerStream(ServerPipeName.ToString(),
                                           PipeDirection.InOut, 
                                           NamedPipeServerStream.MaxAllowedServerInstances,
                                           PipeTransmissionMode.Message);

            pipeServer.WaitForConnection();
            pipeServer.ReadMode = PipeTransmissionMode.Message;
            //A client has connected
            Pipes.Add(pipeServer);
            index++;

            Thread Poll = new Thread(PollPipe);
            Poll.Start(pipeServer);
            }
            catch (Exception ex)
            {
                return;
            }
        }
    }

    public static void PollPipe(Object Pipe)
    {
        byte[] bytes = new byte[1024];
        NamedPipeServerStream PipeStream = (NamedPipeServerStream)Pipe;
        MemoryStream ms = new MemoryStream();
        do 
        {
            ms.Write(bytes, 0, PipeStream.Read(bytes, 0, bytes.Length));
        } while (!PipeStream.IsMessageComplete);   
    }

    public void BroadcastObject(GlassSquidObject obj)
    {
        long length = 0;
        byte[] bytes;

        SoapFormatter formatter = new SoapFormatter();

        using (MemoryStream ws = new MemoryStream())
        {
            formatter.Serialize(ws, obj);
            length = ws.Length;
            bytes = ws.GetBuffer();
        }

        for (int i = 0; i < Pipes.Count; i++)
        {
            Pipes[i].Write(bytes, 0, bytes.Length);
        }
    }
} 
```

这是我的客户的代码：

```
public bool ConnectToPipe()
{
    if (String.IsNullOrWhiteSpace(PipeName))
        return false;

    PipeClient = new NamedPipeClientStream(Address, PipeName, PipeDirection.InOut);

    try
    {
        PipeClient.Connect(5000);

        Thread readThread = new Thread(PollPipe);
        readThread.Start(PipeClient);
    }
    catch (Exception ex)
    {
        return false;
    }

    return true;
}

public bool WriteObject(GlassSquidObject obj)
{
    long length = 0;
    byte[] bytes;

    try
    {
        SoapFormatter formatter = new SoapFormatter();

        using (MemoryStream ws = new MemoryStream())
        {
            formatter.Serialize(ws, obj);
            length = ws.Length;
            bytes = ws.GetBuffer();
        }

        PipeClient.Write(bytes, 0, bytes.Length);
    }
    catch (Exception ex)
    {
        return false;
    }

    return true;
}

public static void PollPipe(Object Pipe)
{
    byte[] bytes = new byte[1024];
    NamedPipeClientStream PipeStream = (NamedPipeClientStream)Pipe;
    PipeStream.ReadMode = PipeTransmissionMode.Message;
    MemoryStream ms = new MemoryStream();
    do
    {
        ms.Write(bytes, 0, PipeStream.Read(bytes, 0, bytes.Length));
    } while (!PipeStream.IsMessageComplete);     
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T19:03:31.290

我仍然不确定写入在等待什么，但我找到了解决问题的方法/解决方法。通过将 NamedPipe 构造函数中的 PipeOptions 设置为异步，读/写成功完成！

# ios - cellForRowAtIndexPath 的问题

> ID：14735914
> 
> 赞同：0
> 
> 时间：2013-02-06T18:11:41.933
> 
> 标签：ios, uitableview

我对这种方法有疑问`UITableView`：

`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`

在模拟器中，仅当新单元格出现在 中时才会调用此方法`UITableView`，但在设备上会为每个单元格调用（在将单元格添加到表格后）。我在表格视图中使用来自网络的图像，它们仅在当前单元格出现时才开始加载。在模拟器中一切正常，但在设备上图像开始同时加载，因为`cellForRowAtIndexPath`每个单元格都被调用。麻烦在哪里？也许我不明白如何`cellForRowAtIndexPath`工作？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{    
    static NSString *tableCellIdentifier = @"CustomeCell";
    CMCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:tableCellIdentifier];

    NSMutableDictionary *currentThread = [currentThreadsData objectAtIndex:indexPath.row];

    if (!cell)
    {
        if ([currentThread objectForKey:THREADNAME]) {
            cell = [[CMCustomCell alloc] initWithName:YES reuseIdentifier:tableCellIdentifier];
            cell.nameLabel.text = [currentThread objectForKey:THREADNAME];
        } else {
            cell = [[CMCustomCell alloc] initWithName:NO reuseIdentifier:tableCellIdentifier];
        }
    }

    /*HERE IS INITIALIZATION OF CELL`S FIELDS*/

    if (![currentThread objectForKey:@"thumbnailimg"]) {
        [cell.imageLoadingRoller startAnimating];
        CMImageLoader *imgLoader = [[CMImageLoader alloc] initWithDelegate:self];
        [imgLoader loadImageFrom:[currentThread objectForKey:THUMBNAIL] tag:indexPath.row];
    } else {     
        [cell.imageLoadingRoller stopAnimating];
        cell.thumbnailImageView.image = [currentThread objectForKey:@"thumbnailimg"];
        cell.thumbnailImageView.hidden = NO;
    }

    return cell;
} 
```

这样我在表格中添加新单元格：

```
for (int i = 0; i < tllAmount; ++i) {
        [currentThreadsData addObject:[threads objectAtIndex:i]];
    }

    [self.loadingRoller stopAnimating];

    NSMutableArray *tempData = [[NSMutableArray alloc] init];
    for (int i = 0; i < tllAmount; ++i) {
        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:i inSection:0];
        [tempData addObject:indexPath];
    }

    [threadsTable beginUpdates];    
    [threadsTable insertRowsAtIndexPaths:tempData withRowAnimation:UITableViewRowAnimationTop];
    [threadsTable endUpdates]; 
```

# c++ - 如何从现有列表中使用前 n-5 个元素创建新列表？

> ID：14735927
> 
> 赞同：3
> 
> 时间：2013-02-06T18:12:09.407
> 
> 标签：c++, stl

如何从现有的 std::list 创建新的 std::list 并获取前 n-5 个元素？n 是现有列表（列表）的大小

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T18:15:08.317

```
std::list<T> newlist(oldlist.begin(), std::prev(oldlist.end(), 5)); 
```

其中`T`是旧列表的值类型。

`std::prev`在 C++11 中是新的，但如果你没有它，你可以使用它`std::advance`：

```
std::list<T>::const_iterator end = oldlist.end();
std::advance(end, -5);
std::list<T> newlist(oldlist.begin(), end); 
```

无论哪种方式，您都有责任确保`oldlist.size() >= 5`. 也不`std::prev`适合`std::advance`你。

# php - ENUM 复选框更新数据库

> ID：14735929
> 
> 赞同：1
> 
> 时间：2013-02-06T18:12:15.803
> 
> 标签：php, mysql, sql

我在一个名为 IsFlagged 的​​表中有一个字段设置为 ENUM，其值为“0”、“1”。我想要它，以便如果选中 HTML 表单上的复选框，它会使用数字 1 更新 IsFlagged 字段以反映这一点。我如何以最简单的方式进行操作，我需要在表单/PHP 中添加什么？ENUM 是最好的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:16:53.620

一个简单的谷歌搜索无法回答这个问题？

之前已经回答过了...

[使用复选框 php mysql 更新数据库](https://stackoverflow.com/questions/12049189/update-database-with-checkbox-php-mysql)

无论如何更具体地说 - 因为您不希望通过使用复选框来回发送请求到数据库，因为传输成本很高......无论您正在从事什么项目，如果它正在跨越web 是通过 Internet 不断地来回发送到 mySQL 数据库的大量开销，我可能会通过选中和取消选中该框一百次来溢出 sql 缓冲区。

这表明用户和开发人员需要进一步验证，确保用户在回发到数据库之前需要该选择。

我的建议是在表单底部添加一个按钮，用于提交查询的选中或未选中部分。

在这种情况下，您将接受检查作为 BOOLEAN 运算符作为 PHP 中 SQL 准备语句的参数...您在关注吗？

要回答 php 表单 - 是的，如果您使用的是 php，您将需要它

例如

```
 <form method="post">
    <input type="checkbox" name="param[]" value="black" />
    <input type="submit" value="Submit" />
    </form> 
```

# c# - 使用 C# 计算输入/输出数据的总时间

> ID：14735931
> 
> 赞同：-6
> 
> 时间：2013-02-06T18:12:19.327
> 
> 标签：c#

如何编写 C# 代码来计算 Office 中的总 InTime，并在特定日期为特定人员提供多个进出时间。我有一个用于选择人名的下拉菜单和一个用于选择我需要获取的日期的日历员工的总 InTime。

数据如下面的 excel 表 xyz 中给出：

```
 **Date          Event Description   Item Description**
12/21/2012 1:51 Exit granted    Ban Swapnil
12/21/2012 2:45 Entry granted   Ban Swapnil
12/21/2012 8:12 Exit granted    Ban Swapnil
12/25/2012 22:44    Entry granted   Ban Swapnil
12/26/2012 0:59 Exit granted    Ban Swapnil
12/26/2012 1:34 Entry granted   Ban Swapnil
12/26/2012 8:15 Exit granted    Ban Swapnil
12/26/2012 22:05    Entry granted   Ban Swapnil
12/26/2012 23:46    Exit granted    Ban Swapnil
12/21/2012 1:24 Exit granted    Bandel Ashish Chander
12/21/2012 15:23    Entry granted   Bandel Ashish Chander
12/21/2012 15:34    Exit granted    Bandel Ashish Chander
12/21/2012 15:51    Entry granted   Bandel Ashish Chander
12/21/2012 16:06    Exit granted    Bandel Ashish Chander
12/21/2012 16:29    Entry granted   Bandel Ashish Chander
12/21/2012 17:56    Exit granted    Bandel Ashish Chander
12/21/2012 18:32    Entry granted   Bandel Ashish Chander
12/21/2012 19:03    Exit granted    Bandel Ashish Chander
12/21/2012 19:37    Entry granted   Bandel Ashish Chander
12/21/2012 21:40    Exit granted    Bandel Ashish Chander
12/21/2012 21:50    Entry granted   Bandel Ashish Chander
12/21/2012 23:01    Exit granted    Bandel Ashish Chander
12/24/2012 13:39    Entry granted   Bandel Ashish Chander
12/24/2012 13:41    Exit granted    Bandel Ashish Chander
12/24/2012 14:52    Entry granted   Bandel Ashish Chander
12/24/2012 15:54    Exit granted    Bandel Ashish Chander
12/24/2012 16:41    Entry granted   Bandel Ashish Chander
12/24/2012 18:31    Exit granted    Bandel Ashish Chander
12/24/2012 22:07    Entry granted   Bandel Ashish Chander
12/24/2012 23:00    Exit granted    Bandel Ashish Chander
12/25/2012 14:00    Entry granted   Bandel Ashish Chander
12/25/2012 14:02    Exit granted    Bandel Ashish Chander
12/25/2012 14:48    Entry granted   Bandel Ashish Chander
12/25/2012 18:45    Exit granted    Bandel Ashish Chander
12/26/2012 13:14    Entry granted   Bandel Ashish Chander
12/26/2012 13:29    Exit granted    Bandel Ashish Chander
12/26/2012 14:33    Entry granted   Bandel Ashish Chander
12/26/2012 17:45    Exit granted    Bandel Ashish Chander 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:17:53.977

这很简单。你可能只是没有考虑清楚。您可以将两个日期之间的差异作为[TimeSpan](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)。这意味着您可以执行`date1 - date2`并获得一个 TimeSpan 结构，该结构将为您提供小时/分钟/秒数。

现在，假设您有一组给定用户**的****进出**时间，您需要一个包含一**对进出时间**的列表。[2 元组](http://msdn.microsoft.com/en-us/library/dd268536.aspx)非常适合这项工作，因此您将拥有一个 2 元组列表。

给定输入/输出时间对的地图，您可以汇总 TimeSpan。这是一个例子：

*（请注意，您的数据对我来说没有意义，但如果您可以从您的数据生成以下列表，那么您的问题陈述就解决了。）*

```
List<Tuple<DateTime,DateTime>> lstForOnePerson = ..
int totalHours = 0;
foreach(var tup in lstForOnePerson)
{
 //this is assuming the first item in the tuple is IN time and the second is OUT
 TimeSpan tm = tup.Item2 - tup.Item1;
 totalHours += tm.TotalHours;
} 
```

# facebook - Facebook 书签的 redirect_uri 是什么？

> ID：14735932
> 
> 赞同：2
> 
> 时间：2013-02-06T18:12:29.847
> 
> 标签：facebook, facebook-graph-api, authentication

在 ipad 上，当在 safari 中使用 Facebook 时，会有用于移动 Web 版本的应用程序的书签。网址如下所示：

apps.facebook.comm/namespace/?ref=bookmarks&code=abc..&fb_source=bookmark_apps&count=0&fb_bmpos=2_0

为了从端点/oauth/access_token 交换令牌代码，我需要redirect_uri。它是什么？

我已经尝试了查询字符串参数的所有可能组合，甚至将其排除在外，并且响应始终是 redirect_uri 不正确。

# jsf - 如何在 ADF 输入组件的 autoSubmit 属性中使用 EL

> ID：14735933
> 
> 赞同：0
> 
> 时间：2013-02-06T18:12:31.433
> 
> 标签：jsf, el, oracle-adf

`autoSubmit`是否可以在ADF 输入组件的属性中包含 EL 表达式？就像是：

```
autoSubmit="#{bindings.sampleAttribute.inputValue == null ? true : false}" 
```

这似乎对我不起作用。如果我将`autoSubmit`属性设置为 litderal 值而不是 EL 表达式，则它确实有效，例如：

```
autoSubmit="true" 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:11:10.087

你能解释一下你的用例吗？自动提交基本上意味着您正在缩短 JSF 生命周期。我不确定你什么时候希望它以某些东西为条件。[http://docs.oracle.com/cd/E16162_01/web.1112/e16182/adf_lifecycle.htm#ADFFD22893](http://docs.oracle.com/cd/E16162_01/web.1112/e16182/adf_lifecycle.htm#ADFFD22893)

# c - for Code::Blocks 中单个文件的 c99 模式

> ID：14735937
> 
> 赞同：1
> 
> 时间：2013-02-06T18:12:44.043
> 
> 标签：c, codeblocks, c99

我在编译我正在处理的一些代码时遇到问题。我最近决定学习 C，以便更好地理解低级语言。我试图创建一个 for 循环，但它返回的错误是我无法在没有`c99 mode`. 我进入`Settings>Compiler>Other Settings`并添加了`-std=c99`，但它仍然无法正常工作。该文件不在项目中，因为我将制作许多文件，每个文件都有一个 main，编译器阻止我为 main 的多个声明执行这些操作。我也知道可以在数组外声明，但我更想弄清楚如何解决这个问题。我正在使用`Code::Blocks 12.11`. 谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:28:12.807

转到 Project->Properties->Build Targets->Build Options->Compiler Settings->Other Options 并添加`-std=c99`到当前配置（调试或发布）

![在此处输入图像描述](../Images/c314ac8ceeda3d8ee1d44b026e9ccfae.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T21:05:03.250

我相信我找到了解决方案，它似乎正在工作。我在对话框中添加了直接在“其他设置”菜单中的行，而不是“其他设置”中“高级设置”菜单下的命令行对话框。它现在似乎工作正常。感谢您的建议，我以后会使用它！

# jquery - 查找/替换 AJAX 响应中的一些链接

> ID：14735941
> 
> 赞同：1
> 
> 时间：2013-02-06T18:12:58.577
> 
> 标签：jquery, replace, qtip

当用户将鼠标悬停在网站上的词汇表上时，我正在使用 qTip 来 AJAX 一些内容。有时 AJAX 响应包含指向站点上其他文件的相对链接。问题是 AJAX 响应中的链接尝试从用户所在的当前页面解析，而不是从调用内容的页面。

### 例子

用户在页面上`<site>/topics/flying/missTheGround.html`。用户将鼠标悬停在一个术语表上，然后进行 AJAX 调用并从`<site>/glossary.html`. AJAX 响应具有指向站点中另一个文件的相对链接，例如`topics/swimming/drownLess.html`. 单击 AJAX 响应中的链接时，它会尝试从当前页面解析，从而导致：`<site>/topics/flying/topics/swimming/drownLess.html`.

如何修改 AJAX 响应？我需要修改两件事：

1.  响应中的本地锚链接需要将用户从当前页面重定向到词汇表页面（指向正确的目标）。
    *   查找以“#”开头的 href 并附加一个字符串，将本地目标链接更改为指向`<site>/glossary.html#<whatever the link target was>`.
2.  响应中的相对链接需要将用户从当前页面重定向到链接页面的正确位置。
    *   查找以“主题”开头的 href 并附加一个将目标更改为绝对的字符串（从根）`<site>/topics/running/goFast.html`

我的 AJAX 代码：

```
content: {
    text: 'Loading...',
    ajax: {
        url: '<local file> #' + $(this).text().toLowerCase(),
        success: function (elems) {
            if (elems.length) {
                this.set('content.text', elems);
                var $elems = $(elems);
            } else {
                this.destroy();
            }
        }
    }
}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T22:30:14.733

您可以按如下方式进行两次替换。

替换词汇表：

```
var glossaryUrl = "<mysite>/glossary.html";
$(elems).find('a[href^="#"]').each(function(i, link) {
    var originalLink = $(link).attr('href');
    $(link).attr('href', glossaryUrl + originalLink);
}); 
```

主题是否替换：

```
var topicsUrl = "<mysite>/";    // The trailing forward slash is important
$(elems).find('a[href^="topics"]').each(function(i, link) { 
    var originalLink = $(link).attr('href');
    $(link).attr('href', topicsUrl + originalLink);
}); 
```

# python - 在python中获取url的内容

> ID：14735952
> 
> 赞同：1
> 
> 时间：2013-02-06T18:14:02.937
> 
> 标签：python, urllib2

```
import urllib2
response = urllib2.urlopen('http://api.xyz.com')
html = response.read() 
```

在[http://api.xyz.com](http://api.xyz.com)

```
{
  "responseHeader":{
    "status":0,
    "QTime":18,
    "params":{
      "indent":"on",
      "q":"",
      "wt":"json",}},
  "response":{"numFound":7984,"start":0,"maxScore":1.0,"docs":[
      {
       "id":"21",
       "first_name":"anurag"
      },
      {
       "id":"31",
       "first_name":"abhishek"
      }
    ]
} 
```

问题是：这个 url 将返回 json 输出。我想读取那个 json 文件，但它显示错误：字符串索引必须是整数，而不是 str。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:16:15.447

[`json`您需要使用库](http://docs.python.org/2/library/json.html)（包含在 Python 中）将 JSON 响应转换为 python 结构：

```
import json

import urllib2
response = urllib2.urlopen('http://api.xyz.com')
data = json.load(response)  # note, no `.read()`, the library handles that

print data['response'] 
```

# awk - awk 2 文件查找和更新最小/最大值

> ID：14735956
> 
> 赞同：0
> 
> 时间：2013-02-06T18:14:16.617
> 
> 标签：awk, max, min

这是我[原来的问题](https://stackoverflow.com/questions/14731235/awk-compare-2-files-find-min-max-and-store-it?rq=1)的第二部分。

File_1 每秒轮询一次， $2 一直在变化：

```
0 0.00
1 0.00
2 0.00
3 0.00
4 0.00
5 0.00
6 0.00
7 0.00
8 -40.00
9 -20.00
10 -10.00
11 10.00
12 30.00
13 20.00
14 10.00
15 20.00
16 10.00
17 -10.00
18 -10.00
19 -10.00
20 -10.00
21 -10.00
22 10.00
23 0.00

```

File_2 是我要存储 min ($1) 和 max ($2) 值并更新它们的地方。原始 File_2 为空：

```
0 0.0000 0.0000
1 0.0000 0.0000
2 0.0000 0.0000
3 0.0000 0.0000
4 0.0000 0.0000
5 0.0000 0.0000
6 0.0000 0.0000
7 0.0000 0.0000
8 0.0000 0.0000
9 0.0000 0.0000
10 0.0000 0.0000
11 0.0000 0.0000
12 0.0000 0.0000
13 0.0000 0.0000
14 0.0000 0.0000
15 0.0000 0.0000
16 0.0000 0.0000
17 0.0000 0.0000
18 0.0000 0.0000
19 0.0000 0.0000
20 0.0000 0.0000
21 0.0000 0.0000
22 0.0000 0.0000
23 0.0000 0.0000

```

我想将绝对最小值和最大值存储在 File_2 中，如果新轮询的 File_1 $1 包含更高/更低的值，则更新它们。这意味着必须使用 File_2 $1 和 $2 检查 File_1 $1，如果 File_1 $1 低于 File_2 $1 或高于 File_2 $2，则必须更新 File_2 $1 或 File_2 $2。所有文件都已排序。

解释：

这将是一个射频噪声分析仪。每条线都是一个子通道，其中每秒测量和读取入口 RF 噪声的上升或下降（存储在 File_1 中）。目标是在测量期间为每个子通道（每条线）获取绝对最小值和最大值（或者换句话说，噪声变化）并将其存储在 File_2 中以供进一步研究。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:03:46.033

我得到了它的使用`paste`和`AWK`组合。这是行：

```
paste File_1 File_2 | awk '{min = $4; if ($2 < $4){min = $2;} max = $5; if ($2 > $5){max = $2;}print $1"\t"min"\t"max;}' - 
```

您可以将输出重定向到要保存的任何位置。请参阅下面的说明。

这是输出：

```
0   0.0000  0.0000
1   0.0000  0.0000
2   0.0000  0.0000
3   0.0000  0.0000
4   0.0000  0.0000
5   0.0000  0.0000
6   0.0000  0.0000
7   0.0000  0.0000
8   -40.00  0.0000
9   -20.00  0.0000
10  -10.00  0.0000
11  0.0000  10.00
12  0.0000  30.00
13  0.0000  20.00
14  0.0000  10.00
15  0.0000  20.00
16  0.0000  10.00
17  -10.00  0.0000
18  -10.00  0.0000
19  -10.00  0.0000
20  -10.00  0.0000
21  -10.00  0.0000
22  0.0000  10.00
23  0.0000  0.0000 
```

解释：

首先，使用`paste`我得到“两个文件合一”，然后我只检查最小值和最大值（`AWK`代码中的 if 语句），然后打印每一行的最终结果。

PS：`paste File_1 File_2`如果您不知道它是如何工作的，请尝试。

# objective-c - 到 TableViewController 的 NSNotification 不起作用

> ID：14735960
> 
> 赞同：0
> 
> 时间：2013-02-06T18:14:21.610
> 
> 标签：objective-c, ios6, uitabbarcontroller, uitableview, nsnotificationcenter

我有一个带有 2 个选项卡的选项卡控制器 - A 和 B。选项卡 A 是常规 UIViewController，选项卡 B 是 TableViewController。我正在尝试从选项卡 A 发布 NSNotification 并接收相同内容并在选项卡 B 的表中显示数据。

我从选项卡 A 发布通知如下：

```
//"itemAddedToCartDictionary" is the object that I am sending with notification

[[NSNotificationCenter defaultCenter] postNotificationName:@"ItemAddedToCart" object:nil userInfo:itemAddedToCartDictionary]; 
```

在我的选项卡 B(TableViewController) 中，我试图接收上述通知更新 NSMutableArray 属性。该属性声明如下：

选项卡 B - .h 文件：

```
@property (nonatomic,strong) NSMutableArray *cart; 
```

选项卡 B - .m 文件：

```
//providing manual setter method for 'items' hence not using @synthesize
- (void)setCart:(NSMutableArray *)cart{
    _cart = cart;
    [self.tableView reloadData];
} 
```

现在，我在 AwakeFromNib 中放置了用于接收通知的代码（在选项卡 B 中），如下所示：

```
- (void)awakeFromNib{
  [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(addCurrentItemToCartFromNotification:) name:@"ItemAddedToCart" object:nil];
 } 
```

该代码在收到更新我的属性的通知后调用方法“addCurrentItemToCartFromNotification”：

```
 - (void)addCurrentItemToCartFromNotification:(NSNotification *)notification{

 NSDictionary *currentItem = [notification.userInfo objectForKey:@"CART_ITEM_INFORMATION"];

if (!self.cart){
    NSLog(@"self.cart == nil");
    self.cart = [[NSMutableArray alloc] init];
}else{
    NSLog(@"self.cart != nil");
}

[self.cart addObject:currentItem];

} 
```

现在这是我面临的问题：

在选项卡 A 中发布通知后，选项卡 B(TableViewController) 不显示任何数据，即使我已在收到通知的上述方法中更新了我的属性。我的 TableView 数据源方法如下：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
  return [self.cart count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"itemInCart";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

NSDictionary *cartItem = [self.cart objectAtIndex:indexPath.row];
cell.textLabel.text = [cartItem objectForKey:@"ITEM_NAME"];

return cell;
} 
```

所以基本上，我正在从数据源方法访问我的 TableViewController 的属性（我从通知接收和更新）并且它没有返回数据。

您能否让我知道我在这里缺少的地方和内容。

谢谢，迈克

**编辑：根据@Joel、@martin、@mkirci 的回复**

将重新加载数据添加到我的“addCurrentItemToCartFromNotification”（收到通知时调用的方法）有帮助。我现在能够在我的选项卡 B（TableViewController）上看到收到通知的项目。

现在这是正在发生的事情：

每当收到通知时，NSMutableArray 属性都会返回为 nil。因此，每次收到通知时，都会为 NSMutableArray 属性（在 addCurrentItemToCartFromNotification 上）发生分配初始化 - （而不仅仅是第一次）。因此，不是用从通知接收到的对象递增数组，而是每次都重新创建数组，并且只添加来自当前通知的对象。

请您对这种情况有所了解。感谢您的所有回复。

谢谢，迈克

**编辑2**

更新了为 initwithnibname 截取的代码，以获取@Joel 的建议

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil{
if (!self.cart){
    NSLog(@"self.cart == nil");
    self.cart = [[NSMutableArray alloc] init];
}else{
    NSLog(@"self.cart != nil");
}
return self;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:24:17.120

我看到几个问题。首先，当您将对象添加到数据数组时，不会调用您的自定义设置器。它只会在您创建 NSArray 本身时调用，而不是从数组中添加或删除条目。所以你应该废弃你的自定义设置器并在你的 addCurrentItemToCartFromNotification 通知中调用 reloadData 。

此外，您应该在 viewDidLoad 中添加观察者并在 viewDidUnload 中删除它，而不是 awakeFromNib（在某些情况下不调用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:21:25.043

添加项目后，您不会重新加载表格。

该表仅在创建和设置数组后重新加载，您还需要在添加项目时进行更新。

# android - AdView 显示添加时活动消失

> ID：14735963
> 
> 赞同：2
> 
> 时间：2013-02-06T18:14:35.523
> 
> 标签：android, admob

我（第一次）在我的活动课程中使用 AdMob com.google.ads.AdView 标记。问题是当我打开活动时，我的文本视图和活动图像在 AdView 显示添加之后显示 1.2 秒，我的活动 TextView 和 ImageView 变为空白。我尝试以两种方式包含添加，但两者都显示添加和消失活动。

**使用 XML 的 AdView：**

```
 **activity.xml**

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/result_Activity_Layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/love_result_background" >

    <TableRow
        android:id="@+id/mainLayout1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <com.google.ads.AdView
            android:id="@+id/adView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            ads:adSize="BANNER"
            ads:adUnitId="a1s310e4e43247c"
            ads:loadAdOnCreate="true" />
    </TableRow>

    <ScrollView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="5dp" >

        <TableLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:stretchColumns="*"
            tools:context=".MyActivity" >

            <TableRow
                android:id="@+id/tableRow1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >

                <TextView
                    android:id="@+id/TextViewFirstName"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:paddingLeft="10dp"
                    android:paddingRight="10dp"
                    android:paddingTop="10dp"
                    android:shadowColor="@color/name_Shadow"
                    android:shadowDx="2"
                    android:shadowDy="2"
                    android:shadowRadius="4"
                    android:text="@string/my_name"
                    android:textColor="@color/name_Text"
                    android:textSize="20sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/TextViewFirstNameScore"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:paddingLeft="10dp"
                    android:paddingRight="10dp"
                    android:paddingTop="10dp"
                    android:shadowColor="@color/score_Shadow"
                    android:text="@string/result"
                    android:textColor="@color/score_Text"
                    android:textSize="26sp"
                    android:textStyle="bold" />
            </TableRow>
        </TableLayout>
    </ScrollView>

</LinearLayout>
                                 **activity.java**

// AdMobWidget in onCreate()
        myAdView = (AdView)findViewById(R.id.adView);
        myAdView.loadAd(new AdRequest()); 
```

**AdView 使用 Activity ：** 我`<com.google.ads.AdView />`在此方法中从 activity.xml 中删除

**活动.java** *

```
// following code use in onCreate() method
    myAdView = new AdView(this, AdSize.BANNER, "a1s310e4e43247c");

    LinearLayout rootView = (LinearLayout)this.findViewById(R.id.result_Activity_Layout);
    LinearLayout.LayoutParams layoutParams = new LayoutParams(480, 75);
    rootView.addView(myAdView, 0, layoutParams);        

    AdRequest re = new AdRequest();
    re.setGender(AdRequest.Gender.UNKNOWN);
    myAdView.loadAd(re); 
```

*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:07:05.223

我只是`android:orientation="vertical"`在我的线性布局中包含以下行，我的 Add 开始工作。yappiiii .... 几个小时后我得到了那个解决方案

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/linearLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
     > 
```

我发现该`android:padding="5dp"`标签不应在 AdView 的主布局中使用，否则会出现以下错误。 `Not enough space to show ad! Wants: 480, 75, Has: 320, 52`

Leo Landau 感谢您的帮助 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:52:24.780

在我看来，您可能正在尝试加载广告两次。我建议从 java 中删除所有 AdView 引用。您无需致电：

```
myAdView = (AdView)findViewById(R.id.adView);
myAdView.loadAd(new AdRequest()); 
```

因为你已经`ads:loadAdOnCreate="true"`在 XML 中设置了。

**另一个建议**：

尝试从 XML 和 Java 中删除 AdView 内容，以查看 Activity 是否以这种方式正确显示。

# angularjs - 使用服务方法写入所选范围变量

> ID：14735964
> 
> 赞同：0
> 
> 时间：2013-02-06T18:14:36.023
> 
> 标签：angularjs

如果 'User' 是一项服务，而 'User.get' 是一种执行请求的方法。

```
<button class="btn" ng-click="User.get(users,'id,uname,email,pw')">
<p>{{users}}</p> 
```

如何使用该代码示例将请求数据分配给范围变量“用户”？我喜欢这种代码风格，但我不知道如何实现它。有任何想法吗？

服务提供者的例子：

```
angular.module('User',[]).
provider('User', function() {
    var path = 'user.php';
    this.$get = function($http) {
        var r = {};
        r.get = function(variable,fields){
            $http.get(path+'?fields='+fields).
            success(function(data){
                //variable = data;
            });
        }
        return r;
    };
    this.setPath = function(p){path = p;};
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T18:51:42.850

使用控制器并为其`ng-click`内部编写处理程序。这是一个例子：

控制器：

```
function Ctrl($scope) { 
    $scope.getUsers = function (fields) {
        $scope.users = User.get(fields);
    }
} 
```

HTML：

```
<div ng-controller="Ctrl">
    <button class="btn" ng-click="getUsers('id,uname,email,pw')">
    <p>{{users}}</p>
</div> 
```

另一种方法是将`this`引用（范围）和属性名称（'users'）传递给服务：

```
<button class="btn" ng-click="User.get(this, 'users', 'id,uname,email,pw')"> 
```

然后在`User`服务上，得到结果后，做这样的事情：

```
r.get = function(scope, prop, fields){
        $http.get(path+'?fields='+fields).
        success(function(data){
            scope[prop] = data;
        });
} 
```

其中`scope`=*这个*和`prop`= '用户'。

恕我直言，第一种方法是最好的，第二种方法听起来有点笨拙。

# blogger - 如何更改评论字段中的占位符？

> ID：14735969
> 
> 赞同：1
> 
> 时间：2013-02-06T18:14:52.750
> 
> 标签：blogger, placeholder

Blogger 评论框中的默认占位符是一个非常难看的“在此处输入您的评论...” 我想更改文本并对其进行一些样式以匹配我的博客。

但是，我不知道该怎么做。这些是 HTML 列出“comment-holder”的仅有的两个地方：

> var render = function() { if (window.goog && window.goog.comments) { var holder = document.getElementById('comment-holder'); window.goog.comments.render（持有者，提供者）；
> 
> div class='comments-content'> b:if cond='data:post.embedCommentForm'> /b:if> div id='comment-holder'> data:post.commentHtml/> /div>

我对 CSS 和 HTML 还很陌生，所以请对我温柔一点。如果您需要我提供更多信息，请告诉我它是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:29:09.890

评论表单位于`iframe`用户域之外，因此我认为无法更改评论表单。

# actionscript-3 - Loader Complete 事件不适用于浏览器 (AS3)

> ID：14735975
> 
> 赞同：0
> 
> 时间：2013-02-06T18:15:13.213
> 
> 标签：actionscript-3, flash, flash-cs5

我试图在影片剪辑中加载图像并更改其大小，如下所示：

```
 var loader:Loader = new Loader();

    public function setProfilePicture(url:String){
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplte);
        loader.load(new URLRequest(url));
        addChild(loader);
    }

    protected function onComplte(event:Event):void
    {
        EventDispatcher(event.target).removeEventListener(event.type, arguments.callee);
        var image:DisplayObject = (event.target as LoaderInfo).content;
        image.width = 132;
        image.height = 132;

    } 
```

上面的代码在我使用 adobe flash CS5 执行时运行良好，但是当我尝试使用浏览器（例如 Chrome）打开它时，图像的大小不会更改为 132x132。我试图将 addChild(loader) 放在 onComplete 函数中，但是这次当我用浏览器打开它时，甚至不会加载图像，而用 adobe flash CS5 执行时仍然像以前一样。

我的建议是，当我们用浏览器打开它时，onComplete 的功能不起作用，但是为什么？？？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T12:13:59.747

试试这个技巧：

```
protected function onComplte( event:Event ):void {
    EventDispatcher( event.target ).removeEventListener( event.type, arguments.callee );

    var loaderInfo:LoaderInfo = LoaderInfo( event.target );
    loaderInfo.loader.scaleX = 132 / loaderInfo.width;
    loaderInfo.loader.scaleY = 132 / loaderInfo.height;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:38:39.003

检查此链接：[actionscript3（flash）不要在 chrome 中从用户文件中加载图像](https://stackoverflow.com/questions/13830763/actionscript3-flash-dont-load-images-form-user-file-in-chrome/13833522#13833522)

验证它是否可以在除 chrome 之外的其他浏览器中运行。这很可能是chrome中的胡椒粉问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T00:57:38.403

我玩过你的 onComplte 函数，不知何故无法从那里访问 LoaderInfo 的 content 属性。如果一切都失败了，图像的大小仍然可以通过缩放加载器从 setProfilePicture 中控制：

```
public function setProfilePicture(url:String){
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplte);
    loader.load(new URLRequest(url));
    loader.scaleX = 10; ////
    loader.scaleY = 10; ////
    addChild(loader);
} 
```

# c++ - 使用 const 引用模拟只读公共类成员

> ID：14735977
> 
> 赞同：2
> 
> 时间：2013-02-06T18:15:19.190
> 
> 标签：c++

当我遇到以下主题时，我正在对“C++ 中的只读公共类成员”进行一些谷歌搜索`public const references to private members`：

```
class Planet
{
private:
    int64_t mass_;
public:
    Planet(int64_t mass);

    const int64_t & Mass = mass_;    // I'm using C++11
}; 
```

由于语法糖，我比内联 const getter 函数更喜欢这个概念：你可以编写`myPlanet.Mass`而不是看起来很冗长的`myPlanet.GetMass()`. 但是，我发现这是以一个额外的引用变量的内存为代价的。我无法理解的是为什么编译器不优化此引用使用的空间，因为它指向的对象永远不会改变，并且指向的对象在编译时是已知的（感谢新的 c++11 语法）。我用 gcc 尝试了各种优化设置，但无济于事。

所以我有两个疑问：

1.  编译器没有优化引用是否有任何原因？
2.  有没有办法强制编译器进行这种优化？也许使用一些非标准`__attribute__`或新的 C++11`[[attribute]]`或其他东西？

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T08:42:39.580

编译器只做他们作者的优化

1.  想过和
2.  被认为实际上有用，值得努力实施它们。

您的方法很不寻常，可能不是 1，也绝对不是 2。Getter 更灵活，没有任何空间成本，如果直接在类中定义它们，所有 C++ 编译器都可以内联它们（在某些情况下它们不会）不是，就像你想保持共享库 ABI 兼容性，但你有完全的控制权）。

# qt - 如何在 QTextEdit 中获取 QTextCursor（不是 .position()）的 x 和 y 位置？

> ID：14735982
> 
> 赞同：2
> 
> 时间：2013-02-06T18:15:46.443
> 
> 标签：qt

例如，我想要一个带有变量列表的弹出窗口，就像代码编辑器中经常出现的那样。为此，我需要知道 QTextEdit 中 QTextCursor 的 x 和 y 位置。但唯一看起来合理的函数是 int QTextCursor::verticalMovementX () const。为什么没有 QTextCursor::horisontalMovementX()？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:19:30.157

我想你要找的是`QTextEdit::cursorRect()`

# jquery - 如何忽略列内数据 - 数据表？

> ID：14735990
> 
> 赞同：0
> 
> 时间：2013-02-06T18:16:09.153
> 
> 标签：jquery, datatables

我有一个函数可以打开一个 excel 应用程序并用数据表中存在的数据填充 excel。一切正常，直到数据包含`<td>`在其中，在这种情况下，数据没有以正确的格式写入（因为它假设`<td>`列数据中的存在是数据表列）。

这是我用来创建excel文档的功能。

```
$(dTable.fnSettings().aoData).each(function () {
$(this.nTr).each(function (c) {
var nTds = $('td', this);
for (var j = 0; j < nTds.length; j++) {
excel.ActiveSheet.Cells(i + 3, j + 1).Value = $(nTds[j]).text();
};
i = i + 1;
}); 
```

有没有办法只获取`<TD>`数据表列而不获取其他 td？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:04:59.957

尝试：

```
dTable.$("tr").each(function(i, data){
    $(data).find("td").each(function(j, innerData){
        excel.ActiveSheet.Cells(i + 3, j + 1).Value = $(innerData).text();
    });
}); 
```

或者

```
dTable.$("tr").each(function(i, data){
    $(data).children().each(function(j, innerData){
        excel.ActiveSheet.Cells(i + 3, j + 1).Value = $(innerData).text();
    });
}); 
```

# c++ - 在 Python 中将浮点数组转换为 numpy 数组

> ID：14735995
> 
> 赞同：1
> 
> 时间：2013-02-06T18:16:28.233
> 
> 标签：c++, python, arrays, numpy, floating-point

我有一个用 Python 语言导入的 C++ 库。这个库有一个方法可以返回一个 float32 二维矩阵（指针），但我之前使用了一个 numpy 数组来表示这个矩阵。现在我有了这个用 C++ 制作的矩阵，我不能正确使用 numpy 库的方法。那么有什么方法可以将在 C++ 中分配的这个矩阵导入到一个 numpy 对象中？

提前致谢。

# coderush - CodeRush 在“Introduce Local”期间缩进属性初始值设定项

> ID：14735996
> 
> 赞同：1
> 
> 时间：2013-02-06T18:16:30.653
> 
> 标签：coderush

当我使用“Introduce Local”重构时，CodeRush 会更改我的代码的缩进。例如，之前：

```
 DoSomething(new MyObject
        {
            PropertyA = "A",
            PropertyB = 2,
            PropertyC = true
        }); 
```

后：

```
 MyObject newMyObject = new MyObject
                    {
                        PropertyA = "A",
                        PropertyB = 2,
                        PropertyC = true
                    };
        DoSomething(newMyObject); 
```

我想要的是：

```
 MyObject newMyObject = new MyObject
        {
            PropertyA = "A",
            PropertyB = 2,
            PropertyC = true
        };
        DoSomething(newMyObject); 
```

我希望 CodeRush 尊重我的格式。至少，我应该能够告诉它我更喜欢如何缩进我的初始化程序。有什么选择可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:21:10.783

是的，在 CodeRush 选项对话框（DevExpress | 选项...）中，导航到编辑器 | 代码格式部分并调整所需的设置。查找“数组、对象和集合初始化程序”选项。这些选项可以在缩进、换行和换行/对齐选项页面上找到。

您可能还想使用“常规选项”页面上的选项来保留现有格式。