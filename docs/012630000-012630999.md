# StackOverflow 问答 12630000-12630999

# ruby-on-rails - 电子邮件在生产中不起作用？

> ID：12630001
> 
> 赞同：0
> 
> 时间：2012-09-27T21:04:14.380
> 
> 标签：ruby-on-rails, ruby, email, heroku, smtp

我以前看过这个问题，但有不同的问题。我关注[了 http://railscasts.com/episodes/61-sending-email-revised](http://railscasts.com/episodes/61-sending-email-revised)。它在开发中有效，但我不明白为什么它在生产中无效。任何的想法？我正在部署heroku。

```
 config.action_mailer.smtp_settings = {
    address: "smtp.gmail.com",
    port: 587,
    domain: "mlpinit.com",
    authentication: "plain",
    enable_starttls_auto: true,
    user_name: ENV["GMAIL_USERNAME"],
    password: ENV["GMAIL_PASSWORD"]
  } 
```

**[编辑]**

百万美元

```
heroku logs
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/persistence.rb:84:in `save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:241:in `block in save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:241:in `block (2 levels) in save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:208:in `transaction'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/mail-2.4.4/lib/mail/network/delivery_methods/smtp.rb:145:in `block in deliver!'
2012-09-27T20:59:25+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/net/smtp.rb:526:in `start'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/mail-2.4.4/lib/mail/network/delivery_methods/smtp.rb:144:in `deliver!'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/app/controllers/devise/registrations_controller.rb:15:in `create'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/base.rb:167:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_create_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_save_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications.rb:123:in `block in instrument'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/base.rb:121:in `process'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:66:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rescue.rb:29:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/engine.rb:479:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/application.rb:220:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:30:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:35:in `block in call'
2012-09-27T20:59:25+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'
2012-09-27T20:59:25+00:00 app[web.1]: 
2012-09-27T20:59:25+00:00 app[web.1]: 
2012-09-27T20:59:25+00:00 app[web.1]: cache: [POST /users] invalidate, pass
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `_run__1589555729654806650__call__1942553407593038289__callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:35:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/head.rb:14:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/logger.rb:26:in `call_app'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/logger.rb:16:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/request_id.rb:22:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/flash.rb:242:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/cookies.rb:338:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/query_cache.rb:64:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/static.rb:53:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:143:in `pass'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:155:in `invalidate'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/
1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:71:in `call!'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/rack/log_tailer.rb:14:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
2012-09-27T20:59:25+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:420:in `_run__4395379426680443846__create__1942553407593038289__callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/callbacks.rb:264:in `block in create_or_update'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/callbacks.rb:264:in `create_or_update'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:447:in `_run__1974915937284874341__process_action__151418621781748778__callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/callbacks.rb:17:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications.rb:123:in `instrument'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/attribute_methods/dirty.rb:22:in `save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:405:in `__run_callback'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:414:in `_run__4395379426680443846__save__1942553407593038289__callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/validations.rb:50:in `save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/abstract_controller/rendering.rb:45:in `process'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/transactions.rb:240:in `save'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal/rendering.rb:10:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.1/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.1/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal.rb:203:in `dispatch'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_controller/metal.rb:246:in `block in action'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:66:in `dispatch'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/mapper.rb:40:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.1/lib/action_dispatch/routing/route_set.rb:589:in `call'
2012-09-27T20:59:25+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `catch'
2012-09-27T21:21:20+00:00 heroku[router]: GET trackit.mlpinit.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=5ms status=200 bytes=0
2012-09-27T21:21:20+00:00 heroku[nginx]: 71.206.13.38 - - [27/Sep/2012:21:21:20 +0000] "GET /favicon.ico HTTP/1.1" 304 0 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1" trackit.mlpinit.com
2012-09-27T21:21:20+00:00 app[web.1]: cache: [GET /favicon.ico] miss 
```

**[编辑2]**

发现这个错误

```
(Missing host to link to! Please provide the :host parameter, set default_url_options[:host], or set :only_path to true) 
```

我添加了 `config.action_mailer.default_url_options = { :host => 'trackit-mlpinit.herokuapp.com' }`

这是我现在得到的错误。

**[编辑3]**

```
Net::SMTPAuthenticationError (530-5.5.1 Authentication Required. Learn more at
2012-09-27T22:25:45+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/net/smtp.rb:954:in `check_response'
2012-09-27T22:25:45+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/net/smtp.rb:923:in `getok'
2012-09-27T22:25:45+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/net/smtp.rb:838:in `mailfrom'
2012-09-27T22:25:45+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/net/smtp.rb:665:in `send_message'
2012-09-27T22:25:45+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/mail-2.4.4/lib/mail/network/delivery_methods/smtp.rb:145:in `block in deliver!' 
```

**[EDIT4]**原来我必须将我的 ENV 变量导出到 heroku。

[https://devcenter.heroku.com/articles/config-vars#setting-up-config-vars-for-a-deployed-application](https://devcenter.heroku.com/articles/config-vars#setting-up-config-vars-for-a-deployed-application)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:10:28.407

您尚未`:host`为解析`link_to`邮件模板中的所有方法设置变量。将其设置为您的应用程序域，一切都会好起来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:25:41.583

在您的 config/environments/production.rb （假设您在生产中）中设置主机，如下所示：

```
config.action_mailer.default_url_options = { host: 'mlpinit.com' } 
```

# wcf - 这种 WCF 序列化方法合理吗？

> ID：12630003
> 
> 赞同：0
> 
> 时间：2012-09-27T21:04:20.603
> 
> 标签：wcf, serialization, deserialization

我正在考虑使用 WCF 来执行客户端/服务器、UI/数据库层，我的想法是我将使用 WCF 服务来读取 DataRow，填充类的属性，然后将其返回给 UI 客户端（这是Windows 端到端）。

我从 DLL 中的一个类开始，并在 UI 和服务器之间共享 DLL。服务器读取 DataRow，并且类知道如何从 DataRow 中填充自己。该类具有带有私有支持变量的公共属性，但是当从 DataRow 填充时，该类直接写入支持变量。然后将类的实例传回 UI。

UI 反序列化类。该类具有公共属性，并且设置器都执行 INotifyPropertyChanged 内容以支持绑定。到目前为止，还没有正常。

我从 [DataContract] 和 [DataMember] 属性开始，但注意到当我的对象实例在 UI 上被反序列化时，它会调用该类实例的公共属性设置器 - 这反过来会触发“已更改” ' 每个属性的事件。

为了解决这个问题，我读到我可以使用 IXmlSerializer。所以我删除了属性，并支持 IXmlSerializer 接口，使用 ReadXml() 方法直接写入公共属性后面的支持变量。

这一切都很好（除了现在必须有一个无参数的构造函数），但这合理吗？这是事情应该如何运作的吗？

我是否应该有一个共享类，它从 UI 知道 INotifyPropertyChanged 并且从服务器端知道如何从 DataRow 构造自己。我应该把所有这些逻辑放在其他地方，并使用 XSD 定义类吗？

问题是我可能可以解决我遇到的问题（比如如何反序列化可为空的类型），但我不确定是否有更好的方法。除了 Windows 到 Windows WCF 通信之外，我没有可预见的需要支持任何东西，所以我实际上并不关心 XML 的样子（或者它是否存在）。

指针将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:11:19.197

一种可能的解决方案是在服务器端维护合同（将通过 [DataContract]、[DataMember] 序列化）和客户端的实体。任何给定的服务方法都会返回合同，但您不会直接调用服务。相反，在中间放置一个代理。代理将调​​用服务方法，从合约转换为实体，然后返回实体。

这样，您的前端只关心它的实体（因为它只与代理对话 - 从不直接与服务对话）并且根本不必担心合同。而且您不必自己做时髦的序列化工作:)

# java - Java 7 Diamond 运算符上的编译错误：ArrayList<>();

> ID：12630006
> 
> 赞同：2
> 
> 时间：2012-09-27T21:04:27.230
> 
> 标签：java, eclipse, diamond-operator

我有这行代码：

```
List<IObserver<?>> observers = new ArrayList<>(); 
```

并得到以下 3 个错误：

```
Cannot instantiate the type ArrayList<?>
Syntax error on token "<", ? expected after this token
Type mismatch: cannot convert from ArrayList<?> to List<IObserver<?>> 
```

我正在使用 Eclipse 3.7，我安装了 JDK 7 update 5，并且项目设置为使用构建路径中的 JRE 系统库[JavaSE1.7]。

传入`IObserver<?>`右侧的编译很好，但我必须使用菱形运算符。

我认为这是一个配置问题，但我无法弄清楚我错过了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T21:40:01.597

代码应该可以工作：正确使用了菱形运算符。我建议您安装更新版本的 Eclipse（Indigo 或 Juno），并将编译器合规级别设置为 1.7。

这是一个简单的工作示例（此处发明了 IObserver）。打印到控制台：“我们是 2”

```
package it.ant.test;

import java.util.ArrayList;
import java.util.List;

public class Test {
    public static void main(String[] args) {
        List<IObserver<?>> observers = new ArrayList<>();
        IObserver<String> stringObserver = new Observer<>();
        IObserver<Integer> integerObserver = new Observer<>();
        stringObserver.addObserved("we are ");
        integerObserver.addObserved(2);

        observers.add(stringObserver);
        observers.add(integerObserver);

        for (IObserver<?> o : observers) {
            System.out.print(o.getObserved());
        }

    }
}

interface IObserver<T> {    
    void addObserved(T t);
    T getObserved();
}

class Observer<T> implements IObserver<T> { 
    private T observed;

    @Override
    public void addObserved(T observed) {
        this.observed = observed;

    }

    @Override
    public T getObserved() {
        return observed;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T21:07:51.823

只有当您`wildcard`的 LHS 中没有泛型类型时，菱形运算符才会起作用。

```
List<IObserver<?>> observers = new ArrayList<>(); 
```

在这段代码中，Compiler 看到 LHS ，并且满意它可以`List`是`IObserver`..`anytype`

但是，在运行时，您需要拥有 this 的实际类型`anytype`。

如果您没有`Wildcard`在 LHS 上使用它，它会起作用。实际上您上面的代码等效于（如果我们将其视为 Java 7 之前的代码）：-

```
List<IObserver<?>> observers = new ArrayList<IObserver<?>>(); 
```

由于 RHS 泛型类型是从 LHS 推断出来的。现在你看到问题了吗？你在 RHS 上没有什么`Concrete Type`可做`object`的`IObserver`..

# c# - 在 C# 中查找数字字符的数值

> ID：12630007
> 
> 赞同：6
> 
> 时间：2012-09-27T21:04:29.120
> 
> 标签：c#, parsing, numbers, char

Unicode 字符中有多个表示数字的范围，对于这些范围`char.IsDigit`返回`true`. 例如：

```
bool b1 = char.IsDigit('\uFF12');    // full-width '2' -> true
bool b2 = char.IsDigit('\u0665');    // true
bool b3 = char.IsDigit('5');         // true 
```

我正在寻找一种方法来获得这些字符的数字等价物。请注意，`int.Parse(...)`它不起作用，因为它期望输入字符在基本 unicode 范围内（'0' .. '9'）。

这相当于 Java 的`Character.digit(...)`行为。

由于 .NET 框架的`char.IsDigit`方法可以正确识别数字等字符，因此我希望它也具有此功能，但我找不到任何东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T21:05:53.333

你试过[`Char.GetNumericValue`](http://msdn.microsoft.com/en-us/library/e7k33ktz.aspx)吗？（我只是启动我的 Windows 笔记本电脑来检查 :)

编辑：刚刚尝试过 - 看起来它有效：

```
Console.WriteLine(char.GetNumericValue('\uFF12'));  // 2
Console.WriteLine(char.GetNumericValue('\u0665'));  // 5
Console.WriteLine(char.GetNumericValue('5'));       // 5 
```

请注意，这*不仅*包括数字 - 它是任何数字字符。但是，`IsDigit` *仅*适用于数字。例如：

```
// U+00BD is the Unicode "vulgar fraction one half" character
Console.WriteLine(char.IsDigit('\u00bd'));         // False
Console.WriteLine(char.GetNumericValue('\u00bd')); // 0.5 
```

# json - 访问数据库时groovy项目零错误

> ID：12630010
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:04:58.013
> 
> 标签：json, rest, groovy, project

我安装了零项目并与员工一起从存储库创建了项目。它适用于这部分：

```
URL employeeURL = new URL(getAbsoluteUri("/resources/employees"));
employees = zero.json.Json.decode(employeeURL); 
```

但是当我把它改成

```
URL temasUrl      = new URL(getAbsolureUri("/resources/teams"));
URL teams = zero.json.Json.decode(teamsURL); 
```

尽管可以通过浏览器访问资源，但出现错误这是错误

```
groovy.lang.MissingMethodException:No signature of method: charts.getAbsolureUri() is applicable for argument types: (java.lang.String) values: [/resources/teams] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:19:48.407

`getAbsolureUri()`在第二个片段中看起来它应该`getAbsoluteUri()`基于第一个片段。

# android - 使用robotium时如何解决eclipse上的问题？

> ID：12630012
> 
> 赞同：1
> 
> 时间：2012-09-27T21:05:05.907
> 
> 标签：android, eclipse, robotium

我有时会下载回 eclipse helios 并安装 ADT。我在 Android 下获得了 Android Project 选项。![在此处输入图像描述](../Images/33128d8d62566499873e6a50ba18f190.png)

在我的系统再次崩溃后，我正在下载相同的 eclipse 并安装了 ADT，但没有获得与我之前获得的相同选项（附上截图）..而且更早我必须创建包，但这次自动包被创建。

![在此处输入图像描述](../Images/448ced06f0665e36a9f5092153e87ab2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T01:25:57.730

我以前也看到过这个。

“Android 项目”和“Android 应用程序项目”相同。

我使用最新的“ADT 20.0.3 插件（2012 年 8 月）”。

![在此处输入图像描述](../Images/9d04bdd4978b22f1d43c43800eefde8a.png)

我尝试使用选项“Android Application Project”创建一个 Android 项目，它对我有用。

我希望这对你有用。谢谢。

注意：仅供参考，我使用“Android Test Project” for robots来测试其他android项目。

# javascript - 什么是在目标空白顶部添加自定义标题的最佳方法

> ID：12630014
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:05:17.593
> 
> 标签：javascript, jquery, html, jquery-ui

我正在像这样打开一个新窗口

```
<a href="mysite.com"  target="_blank">open window</a> 
```

但在新窗口中，我想在顶部显示我公司的标题和徽标。怎么可能做到。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:08:28.173

最好打开一个新页面，其中包含您的标题和您尝试显示的网站的 iFrame。

# joomla - 用于部署和自动归档 Joomla 扩展的工具

> ID：12630015
> 
> 赞同：0
> 
> 时间：2012-09-27T21:05:20.463
> 
> 标签：joomla

我编写了一些 Joomla 2.5 扩展，并在 Perl 中编写了一些脚本，它可以做 3 件事：

*   将文件部署到 Joomla 安装，
*   从Joomla安装中的所有文件夹中收集扩展文件到一个文件夹
*   归档文件到 zip

我把它放在这里：http: [//sourceforge.net/projects/joomlamake/](http://sourceforge.net/projects/joomlamake/)

现在我只是想知道是否已经存在一些可以执行此任务的东西？我的意思是，是否有一些工具可以自动安装扩展程序或从 Joomla 文件夹中提取扩展程序到 zip？

谢谢你的前面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:33:40.410

有[AkeebaBackup](https://www.akeebabackup.com/products/akeeba-backup.html "Akeeba 备份")，一个灵活的备份系统来处理 Joomla 备份。如果您只想从扩展名中选择特定文件进行备份，您可以使用*文件和目录排除的不同配置文件*

# ios - glReadPixels 在 iOS6 设备上返回空缓冲区

> ID：12630016
> 
> 赞同：1
> 
> 时间：2012-09-27T21:05:42.477
> 
> 标签：ios, opengl-es, ios6

> **可能重复：**
> [为什么 glReadPixels() 在 iOS 6.0 中的此代码中失败？](https://stackoverflow.com/questions/12528365/why-is-glreadpixels-failing-in-this-code-in-ios-6-0)

以下行在 iOS 6 模拟器上运行良好，但在 iOS 6 设备上不起作用。有什么问题？如何解决这个问题？非常感谢。

```
glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, buffer); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T21:34:20.617

将 YES 设置为 EAGLLayer 的 kEAGLDrawablePropertyRetainedBacking 属性解决了该问题。

# scala - Scala - 初始化 REPL 环境

> ID：12630018
> 
> 赞同：6
> 
> 时间：2012-09-27T21:05:47.513
> 
> 标签：scala, embed, bind, read-eval-print-loop

-你好。我想将带有*初始化环境*的 Scala REPL 嵌入到我的应用程序中。我看过`IMain`课程，似乎我可以通过它的实例来做到这一点。创建实例，然后将其存储到`intp`public var in `process()`of 中`ILoop`。

如何在之前绑定一些名称和/或添加一些导入`process()`（例如在 REPL 之前）？

以下代码在第 3 行失败，因为`intp`尚未创建（=> NPE）：

```
 val x = 3
    val interp = new ILoop
    interp.bind("x", x) // -> interp.intp.bind("x", x)
    val settings = new Settings
    settings.usejavacp.value = true
    interp.process(settings) 
```

谢谢-。

更新：不幸的是，重写`createInterpreter()`不起作用：

```
 val x = 3
    val interp = new ILoop {
        override def createInterpreter() {
            super.createInterpreter()
            intp.bind("x", x) // -> interp.intp.bind("x", x)
        }
    }
    val settings = new Settings
    settings.usejavacp.value = true
    interp.process(settings) 
```

解释器卡在输入上（看起来像死锁，只发生在上面的代码中）：

```
x: Int = 3
Failed to created JLineReader: java.lang.NoClassDefFoundError: scala/tools/jline/console/completer/Completer
Falling back to SimpleReader.
Welcome to Scala version 2.9.2 (OpenJDK 64-Bit Server VM, Java 1.7.0_06-icedtea).
Type in expressions to have them evaluated.
Type :help for more information.

scala> println
<infinite_sleep> 
```

感谢 dvigal 的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T23:08:25.790

有一个名为[scala-ssh-shell](https://github.com/peak6/scala-ssh-shell)的 github 项目可以做你想做的事，或者至少让你更接近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T03:52:19.140

-嗨，对不起，我不是 Scala REPL 黑客，但我认为您可以执行以下操作：

```
class YourILoop(in0: Option[BufferedReader], protected override val out: JPrintWriter)         
    extends ILoop(in0, out) {
    override def createInterpreter() {
       if (addedClasspath != "")
          settings.classpath append addedClasspath

          intp = new ILoopInterpreter
          val x = 3;
          intp.bind("x", x)
    }
}
object Run {
    def errorFn(str: String): Boolean = {
      Console.err println str
      false
    }

    def process(args: Array[String]): Boolean = {
        val command = new GenericRunnerCommand(args.toList, (x: String) => errorFn(x))
        import command.{ settings, howToRun, thingToRun }
        new YourILoop process settings
    }
    def main(args: Array[String]) {
        process(args)  
    }
} 
```

# algorithm - 最小瓷砖订购

> ID：12630020
> 
> 赞同：4
> 
> 时间：2012-09-27T21:05:51.073
> 
> 标签：algorithm, permutation, combinatorics, sparse-matrix

## 最小化瓷砖重新排序问题：

假设我有以下对称的 9x9 矩阵，N 个粒子之间的 N^2 相互作用：

```
(1,2) (2,9) (4,5) (4,6) (5,8) (7,8), 
```

这些是对称的相互作用，因此它隐含地暗示存在：

```
(2,1) (9,2) (5,4) (6,4) (8,5) (8,7), 
```

在我的问题中，假设它们以矩阵形式排列，其中仅显示上三角形：

```
t       0     1     2     (tiles)
  #   1 2 3 4 5 6 7 8 9   
  1 [ 0 1 0 0 0 0 0 0 0 ]
0 2 [ x 0 0 0 0 0 0 0 1 ]
  3 [ x x 0 0 0 0 0 0 0 ]
  4 [ x x x 0 1 1 0 0 0 ] 
1 5 [ x x x x 0 0 0 1 0 ]
  6 [ x x x x x 0 0 0 0 ]
  7 [ x x x x x x 0 1 0 ]
2 8 [ x x x x x x x 0 0 ]
  9 [ x x x x x x x x 0 ] (x's denote symmetric pair) 
```

我有一些在 3x3 瓦片中计算的操作，并且任何包含至少一个 1 的 3x3 都必须完全计算。上面的例子至少需要 5 个图块：(0,0), (0,2), (1,1), (1,2), (2,2)

但是，如果我通过排列输入来交换第 3 列和第 9 列（以及自对称矩阵以来的行）：

```
t       0     1     2
  #   1 2 9 4 5 6 7 8 3 
  1 [ 0 1 0 0 0 0 0 0 0 ]
0 2 [ x 0 1 0 0 0 0 0 0 ]
  9 [ x x 0 0 0 0 0 0 0 ]
  4 [ x x x 0 1 1 0 0 0 ] 
1 5 [ x x x x 0 0 0 1 0 ]
  6 [ x x x x x 0 0 0 0 ]
  7 [ x x x x x x 0 1 0 ]
2 8 [ x x x x x x x 0 0 ]
  3 [ x x x x x x x x 0 ] (x's denote symmetric pair) 
```

现在我只需要计算 4 个图块：(0,0)、(1,1)、(1,2)、(2,2)。

一般问题：

给定一个 NxN 稀疏矩阵，找到一个重新排序以最小化必须计算的 TxT 瓦片的数量。假设 N 是 T 的倍数。通过尝试 N 可以找到最优但不可行的解决方案！输入排序的排列。

对于启发式方法，我尝试了带宽最小化例程（例如 Reverse CutHill McKee）、Tim Davis 的 AMD 例程，但到目前为止都无济于事。我不认为对角化是正确的方法。

这是一个示例起始矩阵：

[http://proteneer.com/misc/out2.dat](http://proteneer.com/misc/out2.dat)

希尔伯特曲线： ![希尔伯特曲线](../Images/44da86f1067bf75e5dbeadc1be090188.png)

RCM： ![RCM](../Images/fee51f31c208700a558529f84c206855.png)

莫顿曲线： ![莫顿曲线](../Images/47b1f81056a60b377a55540fbbf0c726.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T08:51:53.660

您可以尝试几个众所周知的选项（其中一些您有，但仍然）：

*   [（反向）Cuthill-McKee](http://en.wikipedia.org/wiki/Cuthill%E2%80%93McKee_algorithm)减少了矩阵带宽，使条目靠近对角线。
*   [Approximage 最小度数](http://www.cise.ufl.edu/research/sparse/amd/)- 一种轻量级的减少填充的重新排序。
*   [稀疏 LU/LL' 分解（ METIS](http://glaros.dtc.umn.edu/gkhome/views/metis)，[SCOTCH](http://www.labri.fr/perso/pelegrin/scotch/) ）的填充减少重新排序- 计算量很大。
*   空间填充曲线重新排序（[这些行](http://en.wikipedia.org/wiki/Space-filling_curve)中的内容）
*   用于 2D 的四叉树或用于 3D 问题的八叉树 - 您将粒子分配给四边形/八分圆，然后根据四边形/八分圆 id 对它们进行编号，在某种意义上类似于空间填充曲线。
*   [Self Avoiding Walk](http://en.wikipedia.org/wiki/Self-avoiding_walk)用于结构化网格以遍历网格点，以便所有点仅访问一次
*   在稀疏矩阵向量乘法的背景下，已经进行了大量关于阻塞稀疏矩阵条目的研究。许多研究人员试图为此目的找到良好的重新排序（我没有关于该主题的完美概述，但请看一下例如[这篇论文](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CB4QFjAA&url=http%3A%2F%2Fwww.sandia.gov%2F~apinar%2Fpapers%2FSC99.pdf&ei=kpdlUMG9MaTO4QSimYHYBg&usg=AFQjCNHc2sywnUJ3C07B3tJJ_cy6LiVt5A&sig2=pdfw0_yXrIN1ENUDsyt8dQ&cad=rja)）

所有这些都倾向于在您的矩阵中找到结构，并且在某种意义上将非零条目分组。既然你说你处理粒子，这意味着你的连接图在某种意义上是“局部的”，因为粒子相互作用的空间局部性。在这种情况下，这些方法应该很有用。

当然，它们并没有提供问题的确切解决方案 :) 但是它们通常用于这种情况，因为它们在实践中产生了非常好的重新排序。我想知道你说你尝试的方法失败了是什么意思？您希望找到最佳解决方案吗？当然，与随机矩阵排序相比，它们改善了这种情况。

**编辑**让我简单地看几张照片。我创建了一个由 20 节点砖元素组成的 3D 结构化笛卡尔网格。我匹配了网格的大小，使其与您的相似（约 1000 个节点）。此外，每行非零条目的数量并不太远（在我的情况下为 51-81，在您的情况下为 59-81，但是两者的分布**非常**不同）下图显示了非周期性网格的 RCM 和 METIS 重新排序（左），对于具有完整 xyz 周期性的网格（右）：![RCM 重新排序](../Images/b8e0483046a0d1a19f64c60d9c56e813.png)

下图显示了使用 METIS 和填充减少重新排序重新排序的相同矩阵

![梅蒂斯重新排序](../Images/a060bd90f0f2d160e897c9eadf640d7d.png)

区别是惊人的——周期性的不良影响是显而易见的。现在你的矩阵用 RCM 和 METIS 重新排序

![在此处输入图像描述](../Images/525cfca80a7b86bbaf33b8c754240688.png)

哇。你有问题 :) 首先，我认为你的 rcm 有问题，因为我的看起来不一样；）另外，我确信你不能得出任何关于基于这个特定矩阵的重新排序的一般性和有意义的结论。这是因为您的系统尺寸**非常**小（大约小于 10x10x10 点），并且您的粒子之间似乎有相对长程的相互作用。因此，在如此小的系统中引入周期性对重新排序的不良影响比我在结构化案例中看到的要大得多。

我会通过关闭周期性来开始搜索良好的重新排序。一旦你有一个令你满意的重新排序，就引入定期交互。*在您展示的系统中，除了*周期性之外几乎什么都没有：因为它非常小，而且您的交互范围相当长，至少与我的网格相比。在更大的系统中，周期性对模型中心的影响较小。

较小，但仍为负数。也许你可以改变你对周期性的方法？与其在矩阵中显式包含周期性连接，不如在没有这些的情况下构造和重新排序矩阵，并引入将周期性粒子绑定在一起的显式方程，例如：

```
V_particle1 = V_particle100 
```

或者换句话说

```
V_particle1 - V_particle100 = 0 
```

并将这些方程式添加到矩阵的末尾。这种方法称为拉格朗日乘数。这是它在我的系统中的查找方式

![在此处输入图像描述](../Images/1c07dd658f26d730cb654c5f1851640d.png)

您保持非周期性系统的重新排序，并且周期性连接位于矩阵末尾的块中。当然，您可以将其用于任何其他重新排序。

下一个想法是您从重新排序的非周期性系统开始，并通过将周期性节点添加到它们映射到的行中来明确消除周期性节点的矩阵行。当然，您还应该消除这些列。

您是否可以使用这些取决于您对矩阵的操作。例如，拉格朗日乘数在对角线上引入 0 - 并非所有求解器都这样..

无论如何，这是一项非常有趣的研究。我认为由于您的问题的具体情况（据我了解 - 在 3D 中不规则放置的粒子，具有相当长的相互作用）使得矩阵条目分组变得非常困难。但我很好奇你最终会做什么。请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T12:31:37.660

您可以寻找像 kd-tree、R-tree、四叉树或空间填充曲线这样的数据结构。尤其是空间填充曲线可以提供帮助，因为它可以减少维度并重新排列图块，从而可以向网格添加一些新信息。使用 9x9 网格，查看 peano 曲线可能会很好。z 阶莫顿曲线更适合 2 个网格的功率。

# javascript - 骨干模型创建 | 概念理解

> ID：12630025
> 
> 赞同：0
> 
> 时间：2012-09-27T21:06:07.937
> 
> 标签：javascript, backbone.js

谁能解释一下如何在 Backbone 中创建模型？您传入一个对象，但您可以像使用函数对象一样使用 new。

这使我相信 Backbone 以某种方式将对象文字附加到函数对象，而这是您无法做到的`new {key1:value1, key2,value2}`

**来自骨干网的示例**

```
var Sidebar = Backbone.Model.extend({
  promptColor: function() {
    var cssColor = prompt("Please enter a CSS color:");
    this.set({color: cssColor});
  }
});

window.sidebar = new Sidebar;

sidebar.on('change:color', function(model, color) {
  $('#sidebar').css({background: color});
});

sidebar.set({color: 'white'});

sidebar.promptColor(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T15:55:58.317

这与 JavaScript 中对象系统的工作方式以及[`constructor`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/constructor)对象的 a 和[`new`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/new)的概念有关。

如果您定义具有某些属性的对象：

```
var myobj = {
    foo: 'bar'
} 
```

然后尝试去做`new myobj`你会得到一个`myobj`不是函数的错误。

但是，假设我们定义了一个函数，它将一些传入的值设置为`this`属性：

```
var myobj = function(foo){
    this.foo = foo || "bar";
} 
```

让我们尝试做一个`new`例子：

```
var m = new myobj()
m.foo
> bar
var m2 = new myobj('baz');
m2.foo
> baz 
```

这是因为 JavaScript 中的函数只是函数类型的对象：

```
typeof myobj
> "function"
typeof myobj.prototype
> "object" 
```

现在，如果您查看[Backbone 源代码](https://github.com/documentcloud/backbone/blob/master/backbone.js)（特别是第 184 行），您将看到：

```
 var Model = Backbone.Model = function(attributes, options) { 
```

那行是说模型实际上是一个可以接受两个参数的函数，`attributes`并且`options`.

这就是允许您创建此`new`副本的原因。

# html - 带有 html5 标签的所见即所得编辑器

> ID：12630030
> 
> 赞同：1
> 
> 时间：2012-09-27T21:06:45.407
> 
> 标签：html, html5-video, wysiwyg, html5-audio

我正在尝试为我的网站找到一些好的所见即所得编辑器，它支持 和 等`<audio>`标签`<video>`。到目前为止，我发现只有一个可以添加来自 youtube 和 vimeo 的嵌入视频。有没有开箱即用的标签支持这些标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T11:48:12.790

我发现[Mercury WYSIWYG 工具](http://jejacks0n.github.com/mercury/)对 HTML5 和 CSS3 很有用，它似乎可以满足您的要求。

# google-apps-script - “google.script.run.function”没有从 htmlservice 传递值

> ID：12630040
> 
> 赞同：0
> 
> 时间：2012-09-27T21:07:21.417
> 
> 标签：google-apps-script

我了解[问题 1660](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1660)已被标记为已修复，但我似乎无法获取从我的 htmlservice 表单传递到我的 google 应用程序脚本的任何参数。这是我尝试过的：

```
<my html file>
<form id="myForm">
  <input name="aField" id="aField">
  <input type="button" id="submit" value="submit" onclick = "sendData()">
</form>

<script>
function sendData() {
   google.script.run.processForm(document.getElementById("myForm"));
}
</script>
</my html file>

<google apps script>
   function processForm(value) {
      var range = SpreadsheetApp.openById("1234").getRangeByName("testRnage");
      range.setValue(value.aField);
    }
   </google apps script> 
```

使用

`<input type="button" id="submit" value="submit" onclick = "google.script.run.processForm(this.parentNode)">`也不起作用。

这两种方法都会导致以下浏览器错误：**“未捕获的 ScriptError：TypeError：无法调用 null 的方法“setValue”。”**

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:41:19.200

我一直在成功地做到这一点：

```
var invoice = new Object();

invoice.customerCode = selectedCustomer.value;
invoice.discount = document.getElementById('discount').value;
invoice.items = blah, blah, blah . . . 

var jsonInvoice = JSON.stringify(invoice);

google.script.run.recordInvoice(jsonInvoice); 
```

...在服务器上...

```
function recordInvoice(jsonInvoice) {
    var theInvoice = eval("(" + jsonInvoice + ")");
    var cust = theInvoice.customerCode; 
```

如果这似乎不完整，请随时要求详细说明。

# c# - 锁定未处理的异常处理程序是否安全？

> ID：12630042
> 
> 赞同：2
> 
> 时间：2012-09-27T21:07:24.753
> 
> 标签：c#, multithreading, exception-handling, deadlock

鉴于：

*   在终结器中获取锁可能会导致死锁
*   终结器可以抛出异常

在未处理的异常处理程序中锁定是否安全，或者下面的代码会导致死锁？

```
static void Main(string[] args)
{
     AppDomain.CurrentDomain.UnhandledException += 
         new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
     //do other stuff
}

private static object loggingLock = new object();

static void CurrentDomain_UnhandledException(
    object sender, 
    UnhandledExceptionEventArgs e)
{
    lock (loggingLock)
    {
        //log the exception
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:43:45.653

> 鉴于：
> 
> *   在终结器中获取锁可能会导致死锁
> *   终结器可以抛出异常

**编辑**原来，终结器中抛出的异常根据定义是致命的：

> [doc：](http://msdn.microsoft.com/en-us/library/system.object.finalize(v=VS.100).aspx)如果 Finalize 或 Finalize 的覆盖引发异常，并且运行时不是由覆盖默认策略的应用程序托管，则运行时终止进程并且不执行任何活动的 try-finally 块或终结器。如果终结器无法释放或销毁资源，此行为可确保进程完整性。
> 
> ^(另请参阅[c# 终结器抛出异常？](https://stackoverflow.com/questions/2692004/c-sharp-finalizer-throwing-exception/2692106#2692106))

**注意**：即使异常可能源自函数内部，但这并不意味着它将在该函数的上下文中处理。事实上，堆栈会被展开：

> [doc：](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx) *只有在未找到适用的异常处理程序的情况下解开线程的整个堆栈时才未处理异常，因此可以引发事件的第一个位置是在线程发起的应用程序域中。*

* * *

我不明白为什么锁定不安全。（通常的警告将适用：在持有锁时不要进行阻塞操作......）。

但是，您可能需要在此处对可重入和无限递归三思而后行：

*   ***记录时***如何响应错误？锁将*根据定义*获得，因为线程已经持有它。但是日志记录代码是可重入的吗？即：调用另一个*日志*操作会扰乱正在进行（失败/失败）操作的状态吗？甚至可以进行日志记录吗？

    --> 如果不允许重入（或需要特殊操作（例如，在其他地方登录），即使获得锁，您也需要显式的“inLoggingOperation”标志，因为锁不会阻止单线程重入

*   次要观点：如果您的日志记录不是完全防异常的，那么当您已经在 CurrentDomain.UnhandledException 中时，您可能会遇到麻烦（AFAICT[文档没有描述](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)在事件处理程序中引发异常时会发生什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:43:19.460

好吧，我做了一些搜索，我从 MSDN 中找到了这个：

形式的锁定语句

```
lock (x) ... 
```

其中`x`是引用类型的表达式，精确地等价于

```
System.Threading.Monitor.Enter(x);
try {
   ...
}
finally {
   System.Threading.Monitor.Exit(x);
} 
```

除了`x`只评估一次。

在持有互斥锁的同时，在同一个执行线程中执行的代码也可以获得和释放锁。但是，在释放锁之前，其他线程中执行的代码将无法获得锁。

[8.12 锁语句](http://msdn.microsoft.com/en-us/library/aa664735%28v=vs.71%29.aspx)

`finally`因此，如果由于该语句而从锁内抛出异常，则锁将被释放。

有了这些信息，我 95% 确信你不会因为尝试从你的`CurrentDomain_UnhandledException`方法中锁定而死锁。如果有人知道，我很乐意从他们那里得到（参考也很好）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T05:20:34.683

为了后代......一些测试代码：

```
class Program
{
    static AutoResetEvent e1 = new AutoResetEvent(false);
    static AutoResetEvent e2 = new AutoResetEvent(false);
    private static object lockObject = new object();

    private static void threadProc()
    {
        lock (lockObject)
        {
            e1.Set();
            e2.WaitOne();
            Console.WriteLine("got event");
        }
    }

    private static int finalized = 0;

    public class finalizerTest
    {

        ~finalizerTest()
        {
            try
            {
                throw new NullReferenceException();
            }
            finally
            {
                Interlocked.Increment(ref finalized);
            }
        }
    }

    static void Main(string[] args)
    {
        ThreadPool.QueueUserWorkItem((a) => threadProc());
        e1.WaitOne();
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        {
            finalizerTest f = new finalizerTest();
        }

        //uncommenting this will cause logging to happen as expected
        /*
        while (finalized == 0)
        {
            GC.Collect();
            GC.WaitForPendingFinalizers();
        }
         */

    }

    static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        Console.WriteLine("in handler -- pre lock");
        e2.Set();

        lock (lockObject)
        {
            Console.WriteLine("in handler");
        }
    }
} 
```

发生的情况是，如果 finalizerTest 因为应用程序离开 main 而最终确定，则输出将显示：

```
in handler -- pre lock 
```

但是，如果由于 GC.Collect/WaitForPending 终结器而将其终结，则显示为：

```
in handler -- pre lock
got event
in handler 
```

这意味着在应用程序关闭时从终结器抛出异常的特定情况下，您可能无法获得锁定，但在这种情况下，应用程序和终结队列已经遇到严重问题并且锁定不会让它变得更糟。

在所有其他测试中，我可以认为一切都按预期发生，`threadProc`唤醒并发生日志记录。

# php - PHP - 手动设置然后回显 $_GET 数据

> ID：12630048
> 
> 赞同：0
> 
> 时间：2012-09-27T21:07:45.610
> 
> 标签：php, if-statement

例如，我将如何获取带有一些 $_GET 数据的 url，例如[http://www.website.com/something?food=steak](http://www.website.com/something?food=steak)

那么我将如何输出牛排？我目前的情况是，我正在尝试使用 Header 函数重定向到我拥有它的页面，以便如果 $_GET["duplicate"] 等于 1，则回显这个，否则，什么也不回显。但它没有获取 $_GET 数据我可以告诉我做了一个 var_dump($_GET);

```
<?PHP if ($_GET["duplicate"] == 1 )
    {
        echo "<h1>Username Taken!</h1>";
    }
        else
    {
        echo "";
    }
    ?> 
```

以上是使用网址[http://something.com/register?duplicate=1](http://something.com/register?duplicate=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:10:03.643

它只是一个变量，将其视为一个变量：

```
echo $_GET['food']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:13:24.347

问号之后的所有内容都以全局数组 $_GET 的形式提供。

```
$a=$_GET["food"];
echo $a; 
```

如果 url 有`?food=steak&color=red;`

```
$a=$_GET["food"];
$b=$_GET["color"]; 
```

不止一个是可能的。同时搜索 $_POST。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:35:30.400

好的，所以我想出了我的问题。我有一个 $_GET 变量，它获取页面的末尾并将其声明为页面的“p”。我需要执行以下操作才能使其正常工作。

*   ?p=createuser&duplicate=1

# android - Android 地图 api 找不到 com.google.settings

> ID：12630052
> 
> 赞同：3
> 
> 时间：2012-09-27T21:08:00.660
> 
> 标签：android, android-emulator

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.mapsandgps"
android:versionCode="1"
android:versionName="1.0" >
<uses-permission android:name="android.permission.INTERNET"></uses-permission>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission>
<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <uses-library android:name="com.google.android.maps"/>
    <activity
        android:name=".Maps"
        android:label="@string/title_activity_maps" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

**我还添加了 android api 密钥，但是当程序运行时出现错误**

446) 09-27 21:03:48.576: E/AndroidRuntime(215): 在 android.view.LayoutInflater.createView(LayoutInflater.java:500) 09-27 21:03:48.576: E/AndroidRuntime(215): 。 .. 20 more 09-27 21:03:48.576: E/AndroidRuntime(215): Caused by: java.lang.IllegalArgumentException: 你需要为每个 MapView 指定一个 API Key。有关详细信息，请参阅 MapView 文档。09-27 21:03:48.576: E/AndroidRuntime(215): 在 com.google.android.maps.MapView.(MapView.java:273) 09-27 21:03:48.576: E/AndroidRuntime(215):在 com.google.android.maps.MapView.(MapView.java:254) 09-27 21:03:48.576: E/AndroidRuntime(215): ... 24 更多 09-27 21:03:48.786: E/ dalvikvm(215)：无法打开堆栈跟踪文件“/data/anr/traces.txt”：权限被拒绝 E/AndroidRuntime(215): ... 20 more 09-27 21:03:48.576: E/AndroidRuntime(215): Caused by: java.lang.IllegalArgumentException: 您需要为每个 MapView 指定一个 API Key。有关详细信息，请参阅 MapView 文档。09-27 21:03:48.576: E/AndroidRuntime(215): 在 com.google.android.maps.MapView.(MapView.java:273) 09-27 21:03:48.576: E/AndroidRuntime(215):在 com.google.android.maps.MapView.(MapView.java:254) 09-27 21:03:48.576: E/AndroidRuntime(215): ... 24 更多 09-27 21:03:48.786: E/ dalvikvm(215)：无法打开堆栈跟踪文件“/data/anr/traces.txt”：权限被拒绝 E/AndroidRuntime(215): ... 20 more 09-27 21:03:48.576: E/AndroidRuntime(215): Caused by: java.lang.IllegalArgumentException: 您需要为每个 MapView 指定一个 API Key。有关详细信息，请参阅 MapView 文档。09-27 21:03:48.576: E/AndroidRuntime(215): 在 com.google.android.maps.MapView.(MapView.java:273) 09-27 21:03:48.576: E/AndroidRuntime(215):在 com.google.android.maps.MapView.(MapView.java:254) 09-27 21:03:48.576: E/AndroidRuntime(215): ... 24 更多 09-27 21:03:48.786: E/ dalvikvm(215)：无法打开堆栈跟踪文件“/data/anr/traces.txt”：权限被拒绝

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:59:16.870

您可能正在尝试在虚拟机上以错误版本的目标 API 运行应用程序：

![虚拟机定义](../Images/15b4f252730652bc69201841c2665866.png)

选择名称开头显示“Google API”的目标版本 -

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-23T20:27:36.207

您的清单中缺少一些东西：

1) 谷歌地图所需的权限（in `<manifest>`）：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/> 
```

2）元数据，最后一个元素`<application>`（即活动和服务之后）：

```
<meta-data
    android:name="com.google.android.gms.version"
    android:value="@integer/google_play_services_version" />

<meta-data
    android:name="com.google.android.maps.v2.API_KEY"
    android:value="your_api_key_goes_here" /> 
```

有关进一步说明，请参阅[本文档](https://developers.google.com/maps/documentation/android/start#add_the_google_play_services_version_to_your_apps_manifest)。

# c# - pdf填充模板表格转换为Excel或CSV？

> ID：12630053
> 
> 赞同：0
> 
> 时间：2012-09-27T21:08:12.863
> 
> 标签：c#, excel, pdf, livecycle

我们有一堆由用户填写的 PDF 表单（这个模板是在 Adob​​e LiveCycle Designer 中制作的）。用户在 PDF 文件中输入数据。现在我已经转换成 CSV 或 Excel 文件。

怎么做？有什么可用的工具吗？任何.net代码都可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:31:30.617

[http://www.pdftoexcelonline.com/](http://www.pdftoexcelonline.com/) <-- 这是一个工具，但要回答你的问题，这里是另一个类似的帖子：

[https://stackoverflow.com/questions/704287/converting-pdf-to-excel](https://stackoverflow.com/questions/704287/converting-pdf-to-excel)

# java - 这个 JSON 的数据结构是什么？

> ID：12630054
> 
> 赞同：3
> 
> 时间：2012-09-27T21:08:16.237
> 
> 标签：java, json, gson

我正在尝试使用 Gson 将 Json 解析为 Java，但是当我使用 fromJson() 时，我总是得到 null。谁能帮我解释一下这个数据结构？谢谢！

```
{
"d": {
    "results": [
        {
            "__metadata": {
                "uri": "https://api.datamarket.azure.com/Data.ashx/Bing/SearchWeb/v1/Web?Query='bill'gates'&$skip=0&$top=1",
                "type": "WebResult"
            },
            "ID": "9bd0942f-fe5b-44fc-8343-ef85e5b93a7e",
            "Title": "The Official Site of Bill Gates - The Gates Notes",
            "Description": "In the space between business and goverment, even a small investment can make a big impact on the lives of those in need.",
            "DisplayUrl": "www.thegatesnotes.com",
            "Url": "http://www.thegatesnotes.com/"
        },
        {
            "__metadata": {
                "uri": "https://api.datamarket.azure.com/Data.ashx/Bing/SearchWeb/v1/Web?Query='bill'gates'&$skip=1&$top=1",
                "type": "WebResult"
            },
            "ID": "fdf0d3b9-b29f-43ef-b5ba-6bb4b1b04458",
            "Title": "Bill Gates - Wikipedia, the free encyclopedia",
            "Description": "William Henry \"Bill\" Gates III (born October 28, 1955) is an American business magnate and philanthropist. Gates is the former chief executive and current chairman of ...",
            "DisplayUrl": "en.wikipedia.org/wiki/Bill_Gates",
            "Url": "http://en.wikipedia.org/wiki/Bill_Gates"
        }
    ],
    "__next": "https://api.datamarket.azure.com/Data.ashx/Bing/SearchWeb/v1/Web?Query='bill'gates'&$skip=10&$top=10"
} 
```

}

我认为数据结构应该是这样的，但它不起作用。

```
public class d {
  public result[] results;
  public String __next;}

public class result {
  public information[] infolist;}

public class information {
  public  __metadata metadata;
  public String ID;
  public String Title;
  public String Description;
  public String DisplayUrl;
  public String Url;}

public class __metadata {
   public String uri;
   public String type;} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:12:40.343

你的`Information`课是问题所在。将`Information`东西放入`Result`并`infolist`从中取出`Result`。此外，元数据的字段名称是`__metadata`. 这不是类名。最后，您缺少一个要包装`d`为字段的类。

```
public class DataContainer {
    public Data d;
}

public class Data {
    public Result[] results;
    public String __next;
}

public class Result {
    public Metadata __metadata;
    public String ID;
    public String Title;
    public String Description;
    public String DisplayUrl;
    public String Url;
}

public class Metadata {
    public String uri;
    public String type;
} 
```

您确实应该对类名使用通用约定。Gson 不会阻止您使用自己的名字来上课。它只需要控制字段的名称。

反序列化：

```
String json = ... ;
DataContainer myDataContainer = new Gson().fromJson(JSONString , DataContainer.class);
Result[] myResult = myDataContainer.d.results; 
```

试试看，看看是否有效。

以下是在为 Gson 编写类结构时应如何解释 JSON：

*   开口`{`表示一个对象，因此这将是一个新类（如果它们具有相同的字段，则为现有类）
*   A`"this":`表示它所在的对象的字段，并且该字段的名称必须与字符串中的文本相同。
*   开口`[`表示数组、a`List`或 a `Set`(`Result[] results`也可以是`List<Result> results`)

# matlab - MATLAB 视频捕获和图像处理，无需 Image Acquisition Toolbox

> ID：12630060
> 
> 赞同：1
> 
> 时间：2012-09-27T21:08:58.280
> 
> 标签：matlab

我想在 MATLAB 中捕获实时视频并从中获取图片帧，然后进行图像处理以识别环境中的某些颜色

我没有图像采集工具箱，我只有图像处理工具箱。我知道的方法使用图像采集工具箱功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T04:48:47.713

试试这些 fex 选项：

1.  [简单的摄像机帧采集器工具包](http://www.mathworks.com/matlabcentral/fileexchange/35554-simple-video-camera-frame-grabber-toolkit)
2.  [VCAPG2](http://www.mathworks.com/matlabcentral/fileexchange/2939-vcapg2)
3.  [MATLAB 的视频适配器设备（网络摄像头）设置](http://www.mathworks.com/matlabcentral/fileexchange/24891-image-aquisition)

# android - 简单的安卓问题

> ID：12630064
> 
> 赞同：0
> 
> 时间：2012-09-27T21:09:21.463
> 
> 标签：android

所以我一直在寻找 android 教程、帮助问题等。我不断遇到我难以理解的问题或教程。

这是我的问题：

1.  当我在可视化设计器中创建项目时，将在 .xml 中创建一段代码。如何获取该项目的 ID 以便稍后在 .java 文件中使用它？

2.  假设单击按钮时如何添加回调？

* * *

这是我到目前为止所拥有的：

.java

```
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.widget.Button;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void Button_click_callback() // Where to add the callback in the .xml?
    {
        // How to get button ID and change the text of it? 
            //Knowing this will help me A LOT!
    }
} 
```

.xml

```
<Button
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentLeft="true"
android:layout_alignParentTop="true"
android:layout_marginLeft="79dp"
android:layout_marginTop="32dp"
android:text="Button" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:16:47.920

> 当我在可视化设计器中创建项目时，将在 .xml 中创建一段代码。如何获取该项目的 ID 以便稍后在 .java 文件中使用它？

第 1 步：确保您在设计器中为小部件分配了一个 ID（在上面的 XML 中，您将看到它`android:id="@+id/button1`）

第 2 步：在 Java 中，您可以通过`findViewById(R.id.button1)`在某个适当的时间调用（例如，从`Activity`，在您调用 之后的某个时间`setContentView()`）来获取该小部件的 Java 对象。

> 假设单击按钮时如何添加回调？

通常，对此有一个 setter 方法，例如`setOnClickListener()`您可以调用`Button`您检索到的`findViewById()`.

在活动托管的小部件上的单击事件的特定情况下，`android:onClick`您还可以在 XML 中拥有一个属性，该属性提供您的方法的名称，`Activity`当您单击小部件时将调用该方法，而不必使用二传手。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T21:16:42.657

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button button1 = (Button)findViewById(R.id.button1);
    button1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // Do something in response to button click
        }
    });
} 
```

所有这些都在 Android 开发者网站上得到了广泛的记录。你应该在他们那里寻找这些基本的东西。

[http://developer.android.com/guide/topics/ui/controls/button.html](http://developer.android.com/guide/topics/ui/controls/button.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-18T12:31:24.157

1.  您可以使用 findViewById 从 Java 中的 XML 获取视图 id，确保您应该在视图中声明 id，否则可能会导致导致应用程序强制关闭的异常
2.  如果你想用 xml 而不是以编程方式回调，你可以在布局 XML 中的视图上声明 android:onClick 属性

例如，在您的情况下，您需要添加 android:onClick="Button_click_callback" 在您的

```
<Button
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentLeft="true"
android:layout_alignParentTop="true"
android:layout_marginLeft="79dp"
android:layout_marginTop="32dp"
android:text="Button" 
android:onClick="Button_click_callback"/> 
```

然后你可以使用 Button_click_callback 方法在你的活动中回调

```
public void Button_click_callback()
{
} 
```

如果您想使用 java 以编程方式回调，首先您可以使用 findViewById 获取视图，然后您可以将点击侦听器添加到该视图

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-27T12:41:48.577

您需要使用 onClickListener 并覆盖 onClick 方法。

```
btn.setOnClickListener.(new View.OnClickListener(){

     @Override
      public void onClick(View v) {
        //TO DO
    }

}); 
```

OnClickListener 是一个接口。这就是您需要覆盖 OnClick 方法的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-09T13:35:43.143

```
//in oncreate method of activity 

//take button id like that
Button button1 = (Button)findViewById(R.id.button1);

//then implement on click listener for  performing action on button

button1.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // Do something in response to button click
    }
});
}

//you can also implements onclicklistener in activity.its interface; 

public class MainActivity extends Activity implements View.OnClickListener

//then generate method 
public void onClick(View view) {

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-27T10:19:12.890

```
public class MainActivity extends Activity {
    private Button button1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        button1 = findViewById(R.id.button1);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void Button_click_callback() {
        button1.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // Do something in response to button click
                Log.e("click", "-------------button click");
            }

        });
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-27T10:23:24.207

这两个代码片段是相同的，只是以两种不同的方式实现。

**代码实现**

```
Button btn = (Button) findViewById(R.id.mybutton);

btn.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        myFancyMethod(v);
    }
});

// some more code

public void myFancyMethod(View v) {
    // does something very interesting
} 
```

上面是一个`OnClickListener`. 这就是 XML 实现。

**XML 实现**

```
<?xml version="1.0" encoding="utf-8"?>
<!-- layout elements -->
<Button android:id="@+id/mybutton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Click me!"
    android:onClick="myFancyMethod" /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-16T10:59:52.083

1) 首先查看您的 XML 文件。在代码中它显示 android:id="@+id/button1.

你可以用你自己的名字编辑它。你可以做同样的事情来改变它，尽管 GUI 出现在你的设计的右侧。

您可以使用*findViewById(R.id.your id name) 获取您的 ID；*功能。

例如：我的按钮 ID 是*btn1*。在我的代码中，我可以通过获取它的 ID 来使用该按钮，如下所示：

```
Button btn1=findViewById(R.id.btn1); 
```

2）您可以在创建之前创建的Button后回调如下；

```
btn1.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // Create your code
    }
});
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-05-12T05:20:39.983

对于回调 - 需要在调用设备中注册 android 组件。组件的 id 在 xmls 中必须是唯一的。使用唯一 id 可以动态更改组件或可以使用回调。

# java - 更改 proMIDI 库上的 MIDI 通道

> ID：12630065
> 
> 赞同：0
> 
> 时间：2012-09-27T21:09:22.063
> 
> 标签：java, processing, midi, channel

我在[处理库上使用](http://processing.org/)[promidi](http://creativecomputing.cc/p5libs/promidi/)，我从我的代码发送midi注释，但所有注释都在通道1上，我想发送到其他频道我没有找到如何制作这个，有人知道方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:15:19.267

[ProgramChange](http://creativecomputing.cc/p5libs/promidi/programchange_class_programchange.htm)怎么样？

```
midiOut.sendProgramChange(new ProgramChange(0,myNumber)); 
```

# ios - ACAccountStore 错误 6 (ACErrorAccountNotFound) 和 8

> ID：12630066
> 
> 赞同：10
> 
> 时间：2012-09-27T21:09:25.233
> 
> 标签：ios, ios6

我正在尝试使用以下代码从 ACAccountStore 获取帐户：

```
- (void) facebookLoginOnSuccess: (void (^)(void)) successBlock onError:(void(^)(NSError *error))errorBlock{

    self.facebookPermissions = @[
        @"offline_access",
        @"publish_stream",
        @"user_birthday",
        @"user_location",
        @"email"
    ];

    NSDictionary *options = @{
        @"ACFacebookAppIDKey": [[NSBundle mainBundle] objectForInfoDictionaryKey:@"FacebookAppID"],
        @"ACFacebookAppVersionKey": @"1.0",
        @"ACFacebookPermissionsKey": self.facebookPermissions,
        @"ACFacebookPermissionGroupKey": @"write"
    };

    [self accountLoginFor:ACAccountTypeIdentifierFacebook withOptions:options OnSuccess:successBlock onError:errorBlock];

}

- (void) accountLoginFor: (NSString *) accountTypeID withOptions: (NSDictionary *) options OnSuccess: (void (^)(void)) successBlock onError:(void(^)(NSError *error))errorBlock{

    ACAccountStore *accountStore = [[ACAccountStore alloc] init];
    ACAccountType *accountType = [accountStore accountTypeWithAccountTypeIdentifier:accountTypeID];

    [accountStore requestAccessToAccountsWithType:accountType
                                          options:options
                                       completion:^(BOOL granted, NSError *error){
        if (granted){
            NSArray *accountsArray = [accountStore accountsWithAccountType:accountType];
            NSLog(@"%@",accountsArray);
        }
        else {
            NSLog(@"Error accessing account: %@", [error localizedDescription]);
        }
    }];

} 
```

但我收到了这个错误：

```
Error Domain=com.apple.accounts Code=6 "The operation couldn't be completed. (com.apple.accounts error 6.)" 
```

而且我找不到任何相关的东西，只是这个[问题](https://stackoverflow.com/questions/11437250/acaccountstore-error-5)。有什么想法可能是错的吗？

**更新**

我在 Apple Developer Docs 上找到了这个。

> **账户框架**
> 
> 当请求访问 Facebook 帐户时，您的选项字典中唯一需要的键是 ACFacebookAppIdKey。**ACFacebookPermissionGroupKey 和 ACFacebookAppVersionKey 现已过时。**
> 
> 如果您在 ACFacebookPermissionsKey 下请求写入权限，**例如 publish_stream**，则必须为 ACFacebookAudienceKey 提供一个值，该值可以是**ACFacebookAudienceEveryone**、**ACFacebookAudienceFriends**或**ACFacebookAudienceOnlyMe 之一**。

所以我改变了我的选择：

```
 NSDictionary *options = @{
        @"ACFacebookAppIDKey": [[NSBundle mainBundle] objectForInfoDictionaryKey:@"FacebookAppID"],
        @"ACFacebookPermissionsKey": self.facebookPermissions,
        @"ACFacebookAudienceKey": ACFacebookAudienceFriends
    }; 
```

但我遇到了同样的错误。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-16T10:31:44.367

好的，如果您没有在 iOS 6 的设置中设置帐户，则会引发错误代码**6**。如果用户只是拒绝权限，则会引发错误代码**7**。在案例 6 中，我建议您要求用户首先在“设置”中设置她的帐户。

```
NSDictionary *options = @{
ACFacebookAppIdKey: @"1234567890",
ACFacebookPermissionsKey: @[@"publish_stream"],
ACFacebookAudienceKey: ACFacebookAudienceFriends
};

[self.accountStore requestAccessToAccountsWithType:facebookAccountType options:options completion:^(BOOL granted, NSError *error)
{
    if (granted)
    {
        NSArray *accounts = [self.accountStore accountsWithAccountType:facebookAccountType];

        if([accounts count]>0)
            self.facebookAccount = [accounts lastObject];
    }
    else
    {
        dispatch_async(dispatch_get_main_queue(), ^{

            // Fail gracefully...
            NSLog(@"%@",error.description);
            if([error code]== ACErrorAccountNotFound)
                [self throwAlertWithTitle:@"Error" message:@"Account not found. Please setup your account in settings app."];
            else
                [self throwAlertWithTitle:@"Error" message:@"Account access denied."];

        });
    }
}]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-05T19:41:21.520

jAmi has the right idea, but I don't like the idea of the magic numbers in the code. There is an enum that has the numbers built into it (ACErrorCode).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T20:56:37.050

我自己的解决方案是使用[Facebook SDK](https://developers.facebook.com/docs/reference/iossdk/)而不是直接尝试使用 lib，现在它正在工作。

# javascript - 8 在 javascript 比较中不是“8”

> ID：12630071
> 
> 赞同：0
> 
> 时间：2012-09-27T21:10:10.303
> 
> 标签：javascript

我有一个值为“8”的隐藏字段，我从我的 asp.net mvc 控制器返回 json 数据，其中 templateId 的值为 8。

“8”不是 8。那很好，但我如何比较这两个值？

![在此处输入图像描述](../Images/0f77ed3ae96b02dcf9141fd342e1677e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:12:08.947

在 JavaScript 中，您可以将两个变量与类型检查或不进行类型检查进行比较

例如

```
 8 == '8' //true /* dont check type*/
 8=== '8'   //false /* check type*/ 
```

比较时不需要类型检查。所以你的代码可以正常工作。

既然你说你的代码不起作用。$("#TemplateId").text() 的值为'8'（显示在控制台中）。唯一可能的问题是 response.templateId 不等于 8。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T21:12:10.233

你试过`parseInt($('#TemplateId').text())`吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T21:12:05.927

您可以将[parseInt()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)应用于从 text() 返回的字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T21:13:03.223

您始终可以使用“parseInt(str, 10)”将“8”解析为整数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T22:14:14.360

而不是写：

```
if( response.templateId == $('#TemplateId').val())
{
    // never hit here
} 
```

我这样做了，它奏效了：

```
var selectedTemplateId = $('#TemplateId').val();
if (response.templateId == selectedTemplateId)
{
   // it works
} 
```

我也做了一个通用测试：8 和“8”是一样的：

```
if( 8 == "8")
{
    // always hit here
} 
```

# outlook - Outlook VSTO - 根据用户确定正确的“电子邮件”签名

> ID：12630073
> 
> 赞同：0
> 
> 时间：2012-09-27T21:10:29.820
> 
> 标签：outlook, vsto

我正在使用 VSTO 编写 Outlook 2010 加载项，其中一部分将自动将正确的电子邮件签名添加到新的 AppointmentItem。我遇到的问题是如何确定哪个签名是正确的。例如，我在 Outlook 中设置了 2 个电子邮件签名，它们根据我的电子邮件来自哪个地址制定了使用规则。如何访问这些规则？

我的问题不在于[找到签名文件](https://stackoverflow.com/questions/6442747/add-the-default-outlook-signature-in-the-email-generated)，而在于根据用户的设置应用正确的规则。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:25:45.337

您可以使用以下代码访问规则。您可以遍历它们并获取规则类型和操作

app 是 Outlook.Application 的当前实例

```
Outlook.Rules rules= app.Session.DefaultStore.GetRules();
foreach (Outlook.Rule r in rules)
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:35:52.777

我最终通过创建一个字典对象来解决这个问题，其中键是电子邮件地址，值是文件路径：

```
private Dictionary<string, string> signatureDictionary()
        {
            string sigDataDir = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + @"\Microsoft\Signatures";
            Dictionary<string, string> returnValue = new Dictionary<string,string>();
            Microsoft.Win32.RegistryKey key = Microsoft.Win32.Registry.CurrentUser.OpenSubKey(@"Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676", false);
            string[] str = key.GetSubKeyNames();
            foreach (string s in str)
            {
                Microsoft.Win32.RegistryKey subKey = key.OpenSubKey(s, false);
                if (subKey.GetValue("New Signature") != null)
                {
                    returnValue.Add(System.Text.Encoding.Unicode.GetString(subKey.GetValue("Account Name") as 
                        Byte[],0,(subKey.GetValue("Account Name") as Byte[]).Length - 2)
                        , Path.Combine(sigDataDir,System.Text.Encoding.Unicode.GetString(
                        subKey.GetValue("New Signature") as Byte[], 0, (subKey.GetValue("New Signature") as
                        Byte[]).Length - 2) + @".rtf"));
                }
            }
            key.Close();
            return returnValue;
        } 
```

[这个](https://stackoverflow.com/a/10952503/493055 "这个答案")对类似问题的回答最初为我指明了正确的方向，并发现只有在为该帐户设置了签名时才会填充“新签名”密钥。毫无疑问，在某些情况下这不起作用，但它可以解决我当前的问题。由于我在 VSTO 中编辑电子邮件时使用 WordEditor，因此我在此功能中使用 RTF 文件，但同一目录中也有 .HTM 和 .TXT 文件，因此您可以根据需要使用它们。

# c# - 下载文件

> ID：12630075
> 
> 赞同：0
> 
> 时间：2012-09-27T21:10:36.087
> 
> 标签：c#, winforms, download

我使用以下代码从 C# windows 应用程序中的特定 url 下载文件。

```
private void button1_Click(object sender, EventArgs e)
{
    string url = @"DOWNLOADLINK";
    WebClient web = new WebClient();
    web.DownloadFileCompleted += new AsyncCompletedEventHandler(web_DownloadFileCompleted);
    web.DownloadFile(new Uri(url), @"F:\a");
}

void web_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e)
{
    MessageBox.Show("The file has been downloaded");
} 
```

但是这条线有一个错误：`web.DownloadFile(new Uri(url), @"F:\a");`

它说 ：

> WebClient 请求期间发生异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:15:43.993

如果您使用`DownloadFile`而不是`DownloadFileAsync`.

更新：从聊天中发现，OP 希望文件系统上的文件名反映 URL 末尾指定的文件名。这是解决方案：

```
private void button1_Click(object sender, EventArgs e)
{
    Uri uri = new Uri("http://www.yourserver/path/to/yourfile.zip");
    string filename = Path.GetFileName(uri.LocalPath);

    WebClient web = new WebClient();
    web.DownloadFile(new Uri(url), Path.Combine(@"f:\", filename));
} 
```

# java - 在java中读取属性文件

> ID：12630078
> 
> 赞同：0
> 
> 时间：2012-09-27T21:10:41.180
> 
> 标签：java, properties

如何提供属性文件的绝对路径。

```
autoamtion_environment_properties = new Properties();
InputStream iStream = Thread.currentThread().getContextClassLoader().getResourceAsStream(("C:\\automation_environment.properties")); 
```

这是给一个`null pointer exception`.

如果我在项目根文件夹中有这个文件，它可以工作，但我需要从外部访问它。知道需要做什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:12:18.233

该文件必须位于 CLASSPATH 中才能正常工作。您的 IDE 文件为您解决了困难，但是当您没有拐杖时，您需要知道自己在做什么。在 CLASSPATH 中包含 .properties 文件所在的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:16:58.493

如果您知道文件的完整路径，则可以使用 FileInputStream 类

```
InputStream iStream = new FileInputStream(new File("C:\\automation_environment.properties")); 
```

否则，请参考这个答案[https://stackoverflow.com/a/676273/176569](https://stackoverflow.com/a/676273/176569)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:13:26.630

为什么不使用 FileInputStream 而不是那些疯狂的 Thread 东西呢？

```
InputStream in = new FileInputStream(new File("C:\\automation_environment.properties")); 
```

[http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T21:20:12.230

我会尝试将 \ 设置为 / 而不是： `InputStream iStream = Thread.currentThread().getContextClassLoader().getResourceAsStream(("C:/automation_environment.properties"));`

# iphone - iOS - 从块中返回一个变量

> ID：12630088
> 
> 赞同：3
> 
> 时间：2012-09-27T21:11:41.550
> 
> 标签：iphone, objective-c, ios, alassetslibrary

我有一个`iOS`从数据源方法中提取图像的项目。我希望能够从中提取图像`assets library`（下面的代码块就可以了）。

但是，我需要此`dataSource`方法返回 a `UIImage`，但是当我使用资产库方法获取图像时，图像会在结果块中返回。简单地放入`return image`结果块显然是行不通的。

有谁知道如何让该方法`UIImage`从结果块内部返回 a ？我已经看到了其他几个关于在块内返回图像的 SO 问题，但据说它们调用了另一种方法。我 - 不幸的是 - 不能这样做，因为这个方法是一个[nimbus](http://nimbuskit.info)数据源方法，它必须返回一个 UIImage。

任何帮助或建议将不胜感激！下面的代码：

```
- (UIImage *)photoAlbumScrollView: (NIPhotoAlbumScrollView *)photoAlbumScrollView
                     photoAtIndex: (NSInteger)photoIndex
                        photoSize: (NIPhotoScrollViewPhotoSize *)photoSize
                        isLoading: (BOOL *)isLoading
          originalPhotoDimensions: (CGSize *)originalPhotoDimensions {

    __block UIImage *image = nil;
    ALAssetsLibrary* assetslibrary = [[ALAssetsLibrary alloc] init];
    [assetslibrary assetForURL:[_photos objectAtIndex:photoIndex]
                   resultBlock:^(ALAsset *asset){
                       ALAssetRepresentation *rep = [asset defaultRepresentation];
                       CGImageRef imageRef = [rep fullScreenImage];
                       if (imageRef) {
                           image = [UIImage imageWithCGImage:imageRef];

                       }

                   }
                  failureBlock:^(NSError *error) {
                      //return nil;
                  }];

    return image;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T23:41:43.033

您应该为每个图像创建一个数组。首次调用此数据源方法时，数组中将没有该索引的图像。启动资产调用，然后返回占位符图像。当块返回时，将占位符图像替换为块中返回的资产图像。您可能需要使用 GCD 在主队列上执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:22:22.263

所以我想我有办法解决你的问题。这个想法是利用 dispatch_group，因为你可以在一个调度组上等待——它为你提供了一种阻塞线程直到发生某些事情的方法。它可能要求您的数据源操作不使用主线程，但您将不得不使用它。让我们假设实现 photoAlbumScrollView 的对象称为“obj”。

*   obj 创建一个串行调度队列（称为队列）
*   数据源发送 [obj photoAlbumScrollView] 消息
*   photoAlbumScrollView 做了它现在所做的，但在返回之前等待队列
*   最后一个块解除阻塞队列，让组完成

编码：

```
__block UIImage *image = nil;
ALAssetsLibrary* assetslibrary = [[ALAssetsLibrary alloc] init];

dispatch_queue_t queue = dispatch_queue_create("com.myApp.assetFetch", DISPATCH_QUEUE_SERIAL);

[assetslibrary assetForURL:[_photos objectAtIndex:photoIndex]
               resultBlock:^(ALAsset *asset){
                   ALAssetRepresentation *rep = [asset defaultRepresentation];
                   CGImageRef imageRef = [rep fullScreenImage];
                   if (imageRef) {
                       image = [UIImage imageWithCGImage:imageRef];
                   }
                   dispatch_resume(queue);
               }
              failureBlock:^(NSError *error) {
                   dispatch_resume(queue);
              }];
dispatch_suspend(queue);
dispatch_sync(queue, ^{ NSLog(@"UNSUSPEND!"); }); // ultimately a block with just a ';' in it
dispatch_release(queue);

return image; 
```

我显然没有对此进行测试，但是它或接近它的东西应该可以工作，再次假设您可以在线程上而不是在 mainThread 上进行此操作。

# java - 在 Java 中将 Windows-1252 转换为 UTF-16

> ID：12630089
> 
> 赞同：3
> 
> 时间：2012-09-27T21:11:50.573
> 
> 标签：java, eclipse, apache-flex

我正在尝试将所有 Windows 特殊字符转换为它们的 Unicode 等效字符。我们有一个 Flex 应用程序，用户在其中保存一些富文本，然后通过 Java 电子邮件程序将其通过电子邮件发送给他们的收件人。但是，我们不断遇到 Word 的特殊字符，这些字符仅在电子邮件中显示为 ?。

到目前为止我已经尝试过

```
 private String replaceWordChars(String text_in) {
    String s = text_in;

    // smart single quotes and apostrophe
    s = s.replaceAll("[\\u2018|\\u2019|\\u201A]", "\'");
    // smart double quotes
    s = s.replaceAll("[\\u201C|\\u201D|\\u201E]", "\"");
    // ellipsis
    s = s.replaceAll("\\u2026", "...");
    // dashes
    s = s.replaceAll("[\\u2013|\\u2014]", "-");
    // circumflex
    s = s.replaceAll("\\u02C6", "^");
    // open angle bracket
    s = s.replaceAll("\\u2039", "<");
    // close angle bracket
    s = s.replaceAll("\\u203A", ">");
    // spaces
    s = s.replaceAll("[\\u02DC|\\u00A0]", " ");

    return s; 
```

哪个有效，但我不想将所有 Windows-1252 字符手动编码为等效的 UTF-16（假设这是默认的 Java 字符集）

然而，我们的用户不断从 Microsoft Word 中发现更多 Java 无法处理的字符。于是找了又找，找到了这个例子

```
private String replaceWordChars(String text_in) {
    String s = text_in;
    try {
        byte[] b = s.getBytes("Cp1252");
        byte[] encoded = new String(b, "Cp1252").getBytes("UTF-16");
        s = new String(encoded, "UTF-16");

    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return s; 
```

但是当我在 Eclipse 调试器中看到编码发生时，什么都没有改变。

必须有一个简单的解决方案来处理微软可爱的 Java 编码。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:45:38.547

您可以尝试使用`java.nio.charset.Charset`：

```
final Charset windowsCharset = Charset.forName("windows-1252");
final Charset utfCharset = Charset.forName("UTF-16");
final CharBuffer windowsEncoded = windowsCharset.decode(ByteBuffer.wrap(new byte[] {(byte) 0x91}));
final byte[] utfEncoded = utfCharset.encode(windowsEncoded).array();
System.out.println(new String(utfEncoded, utfCharset.displayName())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T21:22:26.957

使用以下步骤：

1.  使用源文件的编码创建一个`InputStreamReader`(Windows-1252)
2.  `OutputStreamWriter`使用目标文件的编码 (UTF-16)创建一个
3.  将从阅读器读取的信息复制到作者。您可以使用`BufferedReader`和`BufferedWriter`逐行编写内容。

因此，您的代码可能如下所示：

```
public void reencode(InputStream source, OutputStream dest,
        String sourceEncoding, String destEncoding)
        throws IOException {
    BufferedReader reader = new BufferedReader(new InputStreamReader(source, sourceEncoding));
    BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(dest, destEncoding));
    String in;
    while ((in = reader.readLine()) != null) {
        writer.write(in);
        writer.newLine();
    }
} 
```

当然，这不包括 try/catch 内容并将其委托给调用者。

如果您只是想将内容作为各种字符串获取，则可以将其替换为`writer`并`StringWriter`返回其`toString`值。然后你不需要目标流或编码，只需要一个转储字符的地方：

```
public String decode(InputStream source, String sourceEncoding)
        throws IOException {
    BufferedReader reader = new BufferedReader(new InputStreamReader(source, sourceEncoding));
    StringWriter writer = new StringWriter();
    String in;
    while ((in = reader.readLine()) != null) {
        writer.write(in);
        writer.write('\n'); // Java newline should be fine, test this just in case
    }
    return writer.toString();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:30:44.183

到目前为止，我测试过的所有东西似乎都有效的是：

```
private String replaceWordChars(String text_in) {
    String s = text_in;

    final Charset windowsCharset = Charset.forName("windows-1252");
    final Charset utfCharset     = Charset.forName("UTF-16");

    byte[] incomingBytes = s.getBytes();
    final CharBuffer windowsEncoded = 
        windowsCharset.decode(ByteBuffer.wrap(incomingBytes)); 

    final byte[] utfEncoded = utfCharset.encode(windowsEncoded).array();
    s = new String(utfEncoded);

    return s;
} 
```

# zend-framework - 更改某些前缀的 Zend 自动加载路径

> ID：12630093
> 
> 赞同：1
> 
> 时间：2012-09-27T21:12:00.593
> 
> 标签：zend-framework, path, namespaces, autoload

我将写一个简单的例子来展示我需要什么，因为经过 3 个小时的研究，我没有设法找到与此类似的东西。

我的所有课程都以`Project_`. 例如。`Project_BaseController`是基本控制器类。

`BaseController.php`位于（即 中的`/www/Core/`路径之一`set_include_path`），但自动加载器在 中搜索它`/www/Core/Project/`。

我想`/www/Core/`为每个以开头的类设置路径`Project_`（之后它应该在命名后找到文件，例如`Project_User => /www/Core/User.php`：）

也许`Zend_Loader_Autoloader_Resource`是我需要的？

我对此表示怀疑，因为它是针对资源而不是全局配置的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T09:01:15.530

您为类命名的方法违反了 ZF 采用的 PSR-0 原则。你会更容易遵循 PSR-0。在这种情况下，您唯一要做的就是将您的 Project_ 类重新定位到 Project 目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T09:17:37.810

[此答案](https://stackoverflow.com/questions/10159281/integrating-phpthumb-in-zend-framework?lq=1)中使用的方法可能会有所帮助。一个定制的自动装载机似乎是去这里的方式。——</p>

将以下行添加到 application.ini

```
autoloadernamespaces[] = "App_" 
```

如果你保留你的库文件，调整它以匹配，我把我的保留在`library/App`.

在 App/Loader/Autoloader/Project.php 中创建您的自动加载器，如下所示：-

```
class App_Loader_Autoloader_Project implements Zend_Loader_Autoloader_Interface
{
    public function autoload($class)
    {
        $project = explode('_', $class);
        if ($project[0] != 'Project'){
            return false;
        }
        $project[0] = '/www/core';
        require_once implode('/', $project) . '.php'
        return $class;
    }
} 
```

在引导程序中初始化自动加载器：-

```
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap 
{
    protected function _initAutoloading() {
        $autoloader = Zend_Loader_Autoloader::getInstance();
        $autoloader->pushAutoloader(new App_Loader_Autoloader_Project());
    }
} 
```

显然，我没有与您匹配的环境，因此无法对此进行测试。但是，我已经根据我自己对自动加载器的使用对其进行了调整，因此它应该可以在没有太多调整的情况下工作。

[由于David Weinraub 发布](https://stackoverflow.com/a/8820536/212940)的答案，我最初遇到了这种技术，并且从那以后发现它非常有用。

说了这么多，[akond 的回答](https://stackoverflow.com/a/12636825/212940)是很好的建议，将是首选；与框架合作，而不是反对它。如果这不是您的选择，我会提供此答案。

# html - 固定顶部菜单栏重叠内联超链接跳转

> ID：12630098
> 
> 赞同：1
> 
> 时间：2012-09-27T21:12:20.323
> 
> 标签：html, css, hyperlink, anchor, css-position

我的网站顶部有一个固定的菜单栏。我有一个具有内联链接的页面，方法是向 URL 添加一个哈希标记，使其跳转到该特定元素。问题是它跳转到的元素被这个固定的菜单栏隐藏了。有没有办法将跳跃向下移动一点？这是一个例子：

[例子](http://fiddle.jshell.net/cblaze22/dezaH/8/show/light)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:21:55.197

遗憾的是，您不能通过 html 做到这一点，您需要一些 JS，甚至 CSS，具体取决于您的代码。您可以在 jsfiddle.net 上发布示例吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T23:18:52.200

作为一种解决方法，在其下方添加另一个（隐藏的）元素并简单地链接到该元素：

```
<a href="#element1-target">click me</a>

<!-- further down the page is the content -->
<div id="#element1">Here is what users will be reading!</div>
<div id="#element1-target"
      style="visibility:hidden;{make this lower down below the actual text}"></div> 
```

* * *

不过，我唯一的问题是，如果您的标题栏阻止了页面“跳转”到的文本，您是否不希望页面链接到*高于*目标的链接？

* * *

鉴于您的问题含糊不清，而且我认为您的示例没有说明您的问题是什么，这*应该*做（*我认为*）您正在尝试做的事情。

:)

# python - python pydev错误

> ID：12630107
> 
> 赞同：0
> 
> 时间：2012-09-27T21:12:58.627
> 
> 标签：python, pydev

每当我启动 pydev/eclipse 并尝试运行 .py 文件时，我都会遇到错误：

```
An internal error occurred during: 
"Launching PhD mainWorking.py".
java.lang.NullPointerException 
```

当我`OK`再次按下并运行时，一切正常。该错误不是很令人不安，但有一些问题。我试图找到什么，但它对我来说毫无意义。

任何人都有类似的问题或知道问题的根源在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T18:38:54.690

对我来说似乎是一个错误......你的错误日志中有一些条目吗？（有关如何获取错误日志内容的详细信息，请参见： [http ://www.pydev.org/faq.html#PyDevFAQ-HowdoIReportaBUG%3F）](http://www.pydev.org/faq.html#PyDevFAQ-HowdoIReportaBUG%3F)

# wpf - WPF 模板绑定 Path.Fill

> ID：12630115
> 
> 赞同：0
> 
> 时间：2012-09-27T21:13:16.673
> 
> 标签：wpf, styles, controltemplate

我有以下风格：

```
<Style x:Key="WindowButtonTriggers" TargetType="Button">            
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{StaticResource MainColorBrush}" />
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" Value="{StaticResource MainColorBrush}" />
            </Trigger>
        </Style.Triggers>
    </Style>
    <Style x:Key="MinimizeButton" TargetType="Button" BasedOn="{StaticResource WindowButtonTriggers}">
        <Setter Property="Background" Value="{StaticResource WhiteBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Canvas x:Name="appbar_minus" Width="48" Height="48" Clip="F1 M 0,0L 48,0L 48,48L 0,48L 0,0" Background="Transparent" UseLayoutRounding="False">
                        <Rectangle Width="24" Height="4" Canvas.Left="12" Canvas.Top="24" Stretch="Fill" Fill="{TemplateBinding Background}" />
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>                        
    </Style>
    <Style x:Key="CloseButton" TargetType="Button" BasedOn="{StaticResource WindowButtonTriggers}">
        <Setter Property="Background" Value="{StaticResource WhiteBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Canvas x:Name="appbar_close" Width="48" Height="48" Clip="F1 M 0,0L 48,0L 48,48L 0,48L 0,0" Background="Transparent">
                        <Path Width="20" Height="20" Canvas.Left="14" Canvas.Top="14" Stretch="Fill" Fill="{TemplateBinding Background}" Data="F1 M 17,14L 24,21L 30.9999,14.0001L 33.9999,17.0001L 27,24L 33.9999,31L 31,34L 24,27L 17,34L 14,31L 21,24L 14,17L 17,14 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

当我创建一个样式为“MinimizeButton”的按钮时，它工作正常（当鼠标悬停在按钮颜色发生变化时）但是当我创建一个样式为“CloseButton”的按钮时它不起作用，我不明白为什么它们几乎是相同的风格。

任何帮助是极大的赞赏

*编辑*

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="100"/>
    </Grid.ColumnDefinitions>
    <my:Menu Grid.Column="0" BorderThickness="0,0,1,0" BorderBrush="#FF777777"/>
    <WrapPanel Grid.Column="1" VerticalAlignment="Center" Margin="4,0,0,0">
        <Button Style="{StaticResource MinimizeButton}" />            
        <Button Style="{StaticResource CloseButton}" Command="Close" />      
    </WrapPanel>
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:34:04.280

它不起作用的原因是未定义关闭命令和 CanExcecute，然后将按钮上的 IsEnabled 属性设置为 false。[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.input.applicationcommands.close.aspx)指出

> 任何给定对象上的命令都不一定有实现；在许多情况下，命令的实现是应用程序编写者的责任。

[Here](http://www.codeproject.com/Articles/238657/How-to-use-Commands-in-WPF) is a good article on Code Project to get you started on working with WPF Commands.

# eclipse-plugin - 如何获取版权信息以显示在我的 Eclipse RCP 应用程序的“关于”对话框中

> ID：12630124
> 
> 赞同：2
> 
> 时间：2012-09-27T21:13:44.547
> 
> 标签：eclipse-plugin, eclipse-rcp

我正在使用显示 Eclipse About 对话框的 Eclipse 的 IWorkbenchAction。

当我在 RCP 应用程序中使用该操作时，“关于”对话框成功显示。

但是，当我认为继续单击“安装详细信息”按钮时，我会看到一个带有选项卡的对话框。我导航到“已安装的软件”选项卡，并查看我的 RCP 产品的名称及其版本和 ID。我在表格中选择了这个项目，然后继续单击“属性”按钮。

到达这里后，我会看到一个类似于 Eclipse 的 Preference 对话框的对话框。它在左侧有三个项目可供选择...版权、一般信息和许可协议。

我已成功将我的许可信息添加到我的 .product 文件中，以便在单击“许可协议”时显示它，但是...

当我单击此对话框左侧列表中的“版权”项时，我找不到应该将版权信息放在哪里才能显示它。

我在哪里添加此信息以便它显示在此处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T02:36:01.783

此信息来自 p2 `IInstallableUnit`。你在用 p2 构建你的插件吗？如果您实施 p2 更新，您应该能够看到此信息。p2 build 将从 feature.xml 复制此信息。

我正在解决这个问题： **“当我单击此对话框左侧列表中的“版权”项时，我找不到应该将版权信息放在哪里才能显示它的位置”**

当您使用 tycho 构建时，您应该从功能组中获取此版权信息。

对于产品，没有版权信息，只有许可证信息。你把版权信息放在 feature.xml

# c# - 对象初始化不适合我

> ID：12630125
> 
> 赞同：4
> 
> 时间：2012-09-27T21:13:54.227
> 
> 标签：c#, syntax, object-initializers, collection-initializer

我在这里想念什么？我希望以下内容可以正常工作：

```
public class ProposalFileInfo
{
    public int FileId { get; set; }
    public bool IsSupportDocument { get; set; }
}

// ...

var attachments = new List<ProposalFileInfo>();

attachments.Add(new ProposalFileInfo { 1, false });
attachments.Add(new ProposalFileInfo { 2, false });
attachments.Add(new ProposalFileInfo { 3, false }); 
```

`{`相反，我在最后三行中的每一行的字符处都出现错误：

> 无法使用集合初始化程序初始化类型“xxx.yyy.ProposalFileInfo”，因为它没有实现“System.Collections.IEnumerable”

我没有使用[*对象*初始化程序](http://msdn.microsoft.com/en-us/library/bb384062.aspx)吗？为什么它假设一个集合初始化器？（我使用的是 Visual Studio 2012。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T21:14:59.433

要使用*对象*初始化器，您必须指定要设置的属性：

```
attachments.Add(new ProposalFileInfo { FileId = 1, IsSupportDocument = false }); 
```

因此，将您的整个初始化转换为集合初始化器，我们最终得到：

```
var attachments = new List<ProposalFileInfo>
{
    new ProposalFileInfo { FileId = 1, IsSupportDocument = false },
    new ProposalFileInfo { FileId = 2, IsSupportDocument = false },
    new ProposalFileInfo { FileId = 3, IsSupportDocument = false },
}; 
```

但是，您可以通过简单地添加一个构造函数来简化您的代码`ProposalFileInfo`：

```
public ProposalFileInfo(int fileId, bool isSupportDocument)
{
    FileId = fileId;
    IsSupportDocument = isSupportDocument;
} 
```

那么你的初始化可以是：

```
var attachments = new List<ProposalFileInfo>
{
    new ProposalFileInfo(1, false),
    new ProposalFileInfo(2, false),
    new ProposalFileInfo(3, false)
}; 
```

如果您想指定每个参数的含义（或其中一些），并且您使用的是 C# 4，则可以使用命名参数，例如

```
 new ProposalFileInfo(1, isSupportDocument: false), 
```

# json - 带有 HttpClient 但未知 JSON 响应的 REST api

> ID：12630127
> 
> 赞同：1
> 
> 时间：2012-09-27T21:13:56.440
> 
> 标签：json, dotnet-httpclient

我正在使用 WebApi httpclient 构建一个 .net api 库以用于 REST Web 服务。

其余服务返回 JSON。

我遇到的问题是，对于一个请求，我可能会得到不同的 JSON 格式。

如果查询成功，我会返回一个 JSON 数组，我已经创建了一个强大的 c# 类型来保存它。

使用 ReadAsAsync<T> 方法将其从内容中取出。

如果请求中有错误的 api 键或发生其他错误，则其余服务会返回一个 JSON 对象，其中包含一些属性，例如 status=error 和解释消息等。

然后我不能只使用 ReadAsAsync< T > 方法，因为我不知道返回的是什么格式。我对 JSON linq 库了解不多，但有没有办法可以将 JSON 响应放入某个 JSON 持有者对象中，然后检查其中是否存在 status=error，然后对我的强类型使用正确的反序列化。

我似乎能够将它存储在 JRaw 对象中，但不知道从这里去哪里。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T06:06:13.183

> 如果请求中有错误的 api 键或发生其他错误，则其余服务会返回一个 JSON 对象，其中包含一些属性，例如 status=error 和解释消息等。

在这种情况下，返回的状态码不会成功。您可以检查状态代码，然后适当地反序列化您的响应内容：

```
 if (httpResponseMessage.IsSuccessStatusCode)
        {
           // Deserialize your JSON array
        }
        else
        {
           // Deserialize the error
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T07:05:36.113

在这种情况下，您可以使用错误处理

```
try
{
      //Deserialize your JSON Array..this will throw an exception in case of type mismatch
}
catch(Exception e)
{
     //Deserialize your JSON object which will give you Error code or message
} 
```

# mysql - MySQL 动态枢轴

> ID：12630128
> 
> 赞同：5
> 
> 时间：2012-09-27T21:13:59.240
> 
> 标签：mysql, sql, pivot, dynamic-pivot

我有一张这样的产品零件表：

**部分**

```
part_id      part_type      product_id
--------------------------------------
1            A              1
2            B              1
3            A              2
4            B              2
5            A              3
6            B              3 
```

我想要一个返回这样的表的查询：

```
product_id      part_A_id      part_B_id
----------------------------------------
1               1              2
2               3              4
3               5              6 
```

在其实际实施中将有数百万个产品部件

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T21:30:26.950

不幸的是，MySQL 没有`PIVOT`函数，但您可以使用聚合函数和`CASE`语句对其进行建模。对于动态版本，您将需要使用准备好的语句：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(case when part_type = ''',
      part_type,
      ''' then part_id end) AS part_',
      part_type, '_id'
    )
  ) INTO @sql
FROM
  parts;
SET @sql = CONCAT('SELECT product_id, ', @sql, ' 
                  FROM parts 
                   GROUP BY product_id');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b9d59/2)

如果您只有几列，那么您可以使用静态版本：

```
select product_id,
  max(case when part_type ='A' then part_id end) as Part_A_Id,
  max(case when part_type ='B' then part_id end) as Part_B_Id
from parts
group by product_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:31:42.100

SQL Server 有一个 PIVOT 关键字，但对于 MySQL，您将需要使用大量 CASE/IF 语句或大量 JOIN。

[这](https://stackoverflow.com/questions/6605604/mysql-pivot-query-results-with-group-by)是关于如何做到这一点的前一篇文章。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-27T21:27:17.350

只需引用它两次 - （你在这里真的没有太多问题）

```
select a.product_id, a.part_id "part_a_id", b.part_id "part_b_id"
from parts a, parts b
where a.product_id = b.product_id 
```

# objective-c - 当 cell.textLabel.text 等于来自在线 plist 的键时，应用程序崩溃

> ID：12630130
> 
> 赞同：0
> 
> 时间：2012-09-27T21:14:25.817
> 
> 标签：objective-c, uitableview, crash, main, textlabel

我知道以前曾发布过这样的问题，但我试图获得特定于我的代码的直接答案。我看过另一篇文章，并按照它到达了这个阶段。

我的日志中有`(null) libc++abi.dylib: terminate called throwing an exception`一行。我已经将其追溯到这行代码：

```
normalCell.textLabel.text = [[displayArray objectAtIndex:indexPath.row] objectForKey:@"name"]; 
```

这是在我的`cellForRowAtIndexPath`方法中，其中包含以下代码：

```
static NSString *normalCellIdentifier = @"normalCell";
static NSString *topRowCellIdentifier = @"topRowCell";

UITableViewCell *normalCell = [tableView dequeueReusableCellWithIdentifier:normalCellIdentifier];
if (normalCell == nil)
{
    normalCell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:normalCellIdentifier];
}

UITableViewCell *topRowCell = [tableView dequeueReusableCellWithIdentifier:topRowCellIdentifier];
if (topRowCell == nil)
{
    topRowCell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:topRowCellIdentifier];
}

// Configure the cell...
if (searchBar.selectedScopeButtonIndex != 0)
{
    normalCell.textLabel.text = [[displayArray objectAtIndex:indexPath.row] objectForKey:@"name"];
}

if (segmentedControl.selectedSegmentIndex == 0)
{
    if (indexPath.section == 0)
    {
        [self makeButtonsForTableView:tableView atIndexPath:indexPath withTableViewCell:topRowCell];

        [topRowCell addSubview:button1];
        [topRowCell addSubview:button2];

        topRowCell.selectionStyle = UITableViewCellSelectionStyleNone;
        return topRowCell;            
    }
    else
    {
        return normalCell;
    }
}
else
{
    return normalCell;
} 
```

有我所有的`makeButtonsForTableView`按钮代码，但这不是问题，因为我已经从代码中删除了它，问题仍然存在，所以我不需要包含它。

其`displayArray`内容取决于 on `selectedSegmentIndex`a`UISegmentedControl`和 on a`UISearchBar`的选定范围。

它从我的网站域的导入中获取其值的每个数组是： modsArray itemsArray serversArray pluginsArray newItemsArray newBlocksArray newMobsArray

谢谢你提供的所有帮助。

-- 编辑 22:40GMT - 27/09/2012 --

所以我记录了`displayArray`应用程序加载时的内容，这就是日志

```
2012-09-27 22:39:56.539 AppName[22949:11303] (
)
2012-09-27 22:39:56.675 AppName[22949:11303] (
) 
```

-- 编辑 23:13GMT - 27/09/2012 --

有趣的是，当我更改选项卡并返回时，日志更改如下：

```
2012-09-27 23:13:14.074 MinePedia[23853:11303] DisplayArray Count: 0
2012-09-27 23:13:14.074 MinePedia[23853:11303] IndexPath Row: 0
2012-09-27 23:13:14.355 MinePedia[23853:11303] DisplayArray Count: 0
2012-09-27 23:13:14.355 MinePedia[23853:11303] IndexPath Row: 1 
```

对此

```
2012-09-27 23:13:14.074 MinePedia[23853:11303] DisplayArray Count: 1
2012-09-27 23:13:14.074 MinePedia[23853:11303] IndexPath Row: 1
2012-09-27 23:13:14.355 MinePedia[23853:11303] DisplayArray Count: 1
2012-09-27 23:13:14.355 MinePedia[23853:11303] IndexPath Row: 0 
```

有谁知道这是什么意思？

-- 编辑 23:42 - 27/09/2012 --

好的，这是一个与以前不同的问题，它现在不会崩溃，所以这已经解决了，谢谢 Mayur，但是现在在启动时，直到顶部的选项卡被更改，范围和表视图保持索引路径大于计数。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:45:28.977

保持如下：

```
normalCell.textLabel.text = [NSString stringWithFormat:@"%@",[[displayArray objectAtIndex:indexPath.row] objectForKey:@"name"]]; 
```

这样，即使出现空值也不会崩溃。

此外，始终检查数组是否已填满，然后才访问列表，就像这样。

```
if (searchBar.selectedScopeButtonIndex != 0)
{
    if(indexPath.row < [displayArray count])
    {
         normalCell.textLabel.text = [NSString stringWithFormat:@"%@",[[displayArray objectAtIndex:indexPath.row] objectForKey:@"name"]];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:07:46.033

根据您在评论中的更新，您`displayArray`在调用它时没有任何元素`objectAtIndex:`。这会导致异常。您需要确保您`tableView:numberOfRowsInSection:`为此部分返回的行数等于`displayArray`' 计数。

# go - 在 RPC 调用中确定请求者的 IP 地址

> ID：12630133
> 
> 赞同：1
> 
> 时间：2012-09-27T21:14:42.130
> 
> 标签：go, rpc

在使用标准功能的 Go 中`net/rpc`，我想确定入站 RPC 请求来自哪个 IP 地址。底层`http`功能似乎在`http.Request`对象中提供了这一点，但我看不到任何从默认 RPC 处理程序（使用设置`rpc.HandleHTTP`）中获取的方法。

是否有一些隐藏的机制来获取底层`http.Request`，或者我必须做一些更有趣的事情来设置不同的 HTTP 响应器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:51:35.253

据我所知，不可能从默认服务器的某个地方获取地址。

调用请求接收函数的[服务调用方法](http://golang.org/src/pkg/net/rpc/server.go#L346)不提供对存储在编解码器中的远程数据的任何访问。

如果 http 处理程序可以注册两次（[他们不能](http://play.golang.org/p/xQiIwf60Aw)），您可能已经覆盖`DefaultRPCPath`了 HTTP 处理程序设置的[`HandleHTTP`](http://golang.org/src/pkg/net/rpc/server.go#L650). 但这在[今天根本不可能](http://golang.org/src/pkg/net/http/server.go#L956)。

你可以做的，不用大惊小怪，就是在默认服务器的基础上，用你自己的`ServeHTTP`方法构建一个 RPC 服务器：

```
import (
    "log"
    "net"
    "net/http"
    "net/rpc"
)

type myRPCServer struct {
   *rpc.Server
}

func (r *myRPCServer) ServeHTTP(w http.ResponseWriter, req *http.Request) {
   log.Println(req.RemoteAddr)
   r.Server.ServeHTTP(w, req)
}

func (r *myRPCServer) HandleHTTP(rpcPath, debugPath string) {
    http.Handle(rpcPath, r)
}

func main() {
    srv := &myRPCServer{rpc.NewServer()}
    srv.HandleHTTP(rpc.DefaultRPCPath, rpc.DefaultDebugPath)

    // ...http listen code...
} 
```

当然，这样做的缺点是你不能再使用`rpc.Register`了。你必须写`srv.Register`。

**编辑：**我忘了你也需要自己写`HandleHTTP`。这样做的原因是，如果您嵌入 RPC 服务器并编写`srv.HandleHTTP`它，则会在嵌入实例上调用它，将嵌入实例传递给`http.Handle()`，而忽略您自己的`ServeHTTP`. 这有一个缺点，您将无法使用调试路径调试 RPC 服务器，因为服务器`HandleHTTP`使用您无法访问的[私有调试处理程序](http://golang.org/src/pkg/net/rpc/server.go#L644)( )。`rpc.debugHTTP`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T01:47:38.557

该`net/rpc`包的抽象级别比 tcp 或 http 更高。由于它可以使用多个编解码器，因此提供一种获取入站 rpc 的 IP 地址的方法是没有意义的。从理论上讲，有人可以实现一个在 unix 套接字上进行通信的代码，或者使用无线电发射器。

如果您想访问传输层的细节，您将不得不在堆栈中删除一个级别并使用`net`or`net/http`目录来创建您的 rpc 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-01T13:21:01.223

您也可以使用[https://github.com/valyala/gorpc](https://github.com/valyala/gorpc)而不是 net/rpc，它将客户端地址传递给 RPC 服务器处理程序 -有关详细信息，请参阅[http://godoc.org/github.com/valyala/gorpc#HandlerFunc](http://godoc.org/github.com/valyala/gorpc#HandlerFunc) .

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-08T06:11:17.763

似乎目前没有办法在 rpc 函数中执行此操作。有关更多信息，请参阅此[链接](https://github.com/golang/go/issues/4584)

这是一个总结。

问：

> 现在RemoteAddr() 方法只能在客户端拨号到服务器时在net.Conn 上调用来获取RPC 客户端的地址，但是假设您的服务器连接了多个客户端并且每个客户端都在调用一个RPC 导出方法。有没有办法实现从 RPC 方法内部获取调用者远程地址的方法？
> 
> func (t *Type) Method(args *Args, reply *string) error {
> //类似于
> *reply = Caller.RemoteAddr().String()
> // 现在谁调用了这个方法？
> 返回零
> }

A：

> 我很怀疑。这需要 API 更改（不一定是向后不兼容的，但仍然需要重新设计）来提供此功能。

# php - PHP在线程之间共享静态内存

> ID：12630136
> 
> 赞同：0
> 
> 时间：2012-09-27T21:14:49.173
> 
> 标签：php

我有一个 CLI 脚本，它将大约 1GB 的数据（从数据库）加载到内存中，然后它将用于只读。我想运行该脚本的 6 个实例（同时使用 6 个内核），但每次运行该脚本时，它都会占用另外 1GB 的内存。我想 fork() 并让孩子们使用相同的共享内存进行只读。拥有 16GB 的内存，我可以使用它们自己的内存分配来运行它们。但最终需求会增长到超出我的分配范围。

那么，是否有可能创建一个“静态”数组、fork 并允许子进程使用共享内存进行处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:24:08.020

尝试`shmop_*()`诸如`shmop_open()`...之类的功能

# jquery - 如何禁用砌体的“响应”部分？

> ID：12630139
> 
> 赞同：1
> 
> 时间：2012-09-27T21:15:07.363
> 
> 标签：jquery, jquery-masonry

我的内容 div 有固定宽度（填充不同大小的图像），我不希望图像根据浏览器重新调整大小或重新组织。如何禁用砌体的响应性部分？

我正在使用砌体，因为它可以在我的 div 中完美地调整我的图像大小，但我只需要删除它的响应部分。

我已经删除了 css 中的所有“最大宽度”代码（负责调整图像大小），但主要问题是当我将浏览器调整为较小的尺寸。我不知道这是因为 jquery 文件还是在我的 css 中？

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T11:24:05.037

> [http://masonry.desandro.com/docs/options.html](http://masonry.desandro.com/docs/options.html)
> 
> 可调整大小
> 
> 调整浏览器窗口大小时触发布局逻辑。

您需要将 isResizable 设置为 false

```
$('#container').masonry({
  isResizable: false,
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-08T08:01:24.610

您需要使用所需屏幕的宽度（ mobile = 640 ）调用 masonry js

```
if ($(window).width() > 640) {
            $('.grid').masonry({
              // options
              itemSelector: '.grid-item',
              columnWidth: 0
            });
        } 
```

# jquery - nestedSortable 连接可排序

> ID：12630140
> 
> 赞同：1
> 
> 时间：2012-09-27T21:15:13.813
> 
> 标签：jquery, list, nested, jquery-ui-sortable, nested-sortable

是否可以连接两个嵌套的可排序列表？

我尝试过的一些事情。

第一个列表是可排序列表，第二个是嵌套排序列表，只要未将嵌套排序列表设置为与可排序列表连接，我就可以将项目拖到嵌套列表中。如果我将 nestedSortable 列表设置为与可排序列表连接，则 nestedSortable 列表将停止工作。

第二。如果两个列表都设置为 nestedSortable，则一旦您尝试拖动项目，浏览器就会崩溃。

我希望能够将项目从nestedSortable 列表拖到可排序列表或使用两个nestedSortable 列表。

这可能吗？谢谢

这是示例代码：

```
(function() {
        $( ".sortablelistone" ).sortable({
            connectWith: ".sortable"
        }).disableSelection();
    });

$(function() {
        $( ".sortablelisttwo" ).nestedSortable({
            connectWith: ".sortable"
        }).disableSelection();
    });

<ol class="sortablelistone sortable">
<li>Link One</li>
<li>Link Two</li>
</ol>

<ol class="sortablelisttwo sortable">
<li>Link One</li>
<li>Link Two</li>
</ol> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T18:56:27.550

是的，可以使用*nestedSortable*插件连接 2 个列表。尝试这样的事情：

```
(function() {
      $( ".sortablelistone, .sortablelisttwo" ).nestedSortable({
            connectWith: ".sortable"
            /* other settings */
      }).disableSelection();
}); 
```

# php - 防止插入页面的 DOM 元素的样式

> ID：12630147
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:15:56.137
> 
> 标签：php, jquery, css

我创建了一个将 DOM 元素直接插入页面的浏览器扩展，并且我想防止它们被页面中已有的任何继承的 CSS 设置样式。目前，我将我的 css 调用附加到头部以引入我自己的样式。到目前为止，我的计划是使用晦涩的类/id 名称并创建非常具体的规则。在某些情况下，我不得不使用！important。我觉得我把我的道德扔出了门！

关于如何有效地防止继承样式并允许浏览器有效地呈现我的代码的任何想法？

关于如何使用 iframe 来做到这一点的任何想法？我在后端运行 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T01:36:31.620

您无法阻止级联样式表的级联位，但您可以定义所有样式，因此没有任何东西可以继承。

一种快速的方法是按照您的需要设置它们的样式，然后使用 webkit 的开发人员工具（或 firebug）来查看元素的计算样式。

然后，您可以将所有计算的样式复制到您的样式表中。确保使用唯一的 ID，这样它们就不会与页面上的任何内容重叠，并且样式将非常具体。添加`!important` *......正如我所说的那样......*以防止某些奇怪的特定样式表重叠并确保您的样式表调用被添加到 HEAD 的末尾或将其插入到正文末尾的样式块中以确保它不能被覆盖。

# objective-c - 这种插入/编辑 Core Data 嵌套对象的方法是最有效的吗？

> ID：12630149
> 
> 赞同：1
> 
> 时间：2012-09-27T21:16:11.717
> 
> 标签：objective-c, core-data

我有以下核心数据模型（例如简化）：

```
Person
  ->Address
    City
      >Region
        RegionName
      >Country
        CountryName 
```

当一个新的人被创建时

```
NSManagedObjectModel *objectModel=[[AppCoreData sharedInstance]objectModel];
NSEntityDescription *entity=[[objectModel entitiesByName] valueForKey:@"Beverage"];
Person *person=(Person*)[[NSManagedObject alloc]initWithEntity:entity insertIntoManagedObjectContext:nil]; 
```

Person 实体是在不插入对象上下文的情况下创建的，因此在必要时很容易放弃插入。

然后用户可以选择数据库中可能存在或不存在的区域。执行搜索以查看 Region 是否存在

```
 NSEntityDescription *entityDescription=[NSEntityDescription entityForName:@"Region" inManagedObjectContext:self.objectContext];
  NSFetchRequest *request = [[NSFetchRequest alloc] init];
  [request setEntity:entityDescription];
  request.returnsObjectsAsFaults=NO;
  NSPredicate *predicate=[NSPredicate predicateWithFormat:@"id == %@",region.id];
  [request setPredicate:predicate];

  NSError *error=nil;
  NSArray *array= [self.objectContext executeFetchRequest:request error:&error];

  if ([array count] == 1) {
    //use existing object
    person.region=(Region*)[array objectAtIndex:0];
  } else {
    //create new object
    NSEntityDescription *entity=[[objectModel entitiesByName] valueForKey:@"Region"];
    self.collectionItem.beverage.region=(Region*)[[NSManagedObject alloc]initWithEntity:entity insertIntoManagedObjectContext:nil];
    person.region.id=[NSNumber numberWithInt:[regionID intValue]];
    person.region.regionName=regionName;
  } 
```

最后，如果用户没有放弃插入，则将人对象插入到对象上下文中并保存

```
[self.objectContext insertObject:self.collectionItem]; 
```

处理嵌套对象（例如，区域可能存在或不存在于核心数据中的嵌套核心数据对象）的最佳方法是什么？示例或参考表示赞赏。

# computer-architecture - 多个内核可以同时读取同一个 RAM 位置吗？

> ID：12630151
> 
> 赞同：5
> 
> 时间：2012-09-27T21:16:30.320
> 
> 标签：computer-architecture

多个内核可以同时读取同一个 RAM 位置吗？我特别对 x86 架构 CPU 感兴趣。同一个 CPU 上两个不同内核的内部缓存是否可以同时从同一个 RAM 位置填充？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T21:26:11.937

简而言之，它们可以独立读取并且缓存将被独立填充，尽管该位置可以预加载到共享的 L3 缓存中。不能保证同步到精确的刻度，但内存状态对应用程序是一致且透明的。Ulrich Drepper 有一篇关于记忆的优秀文章，必读： http: [//lwn.net/Articles/250967/](http://lwn.net/Articles/250967/)

# iphone - 我可以使用企业许可证将应用程序的测试版部署到客户端吗？

> ID：12630152
> 
> 赞同：0
> 
> 时间：2012-09-27T21:16:33.723
> 
> 标签：iphone, ios

这个问题与 iOS 开发者企业计划有关我们的客户希望在发布之前在他们的手机上查看应用程序。我们可以从我们公司购买企业许可证，然后使用它来部署应用程序吗？对于企业帐户，Apple 谈论内部部署。这可能是一个法律问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:18:40.627

您可以只使用 Ad-hock 部署，它仅限于 100 台设备。企业对于您正在寻找的东西来说太过分了，并且获得企业许可证是一个相当耗时的过程。

# iphone - iPhone浏览器上的背景不重复

> ID：12630154
> 
> 赞同：1
> 
> 时间：2012-09-27T21:16:42.840
> 
> 标签：iphone, css, html, mobile-safari, background-image

所以有一点浏览器兼容性问题，但仅限于 iPhone 和 iPad Safari 浏览器:(

***网址：*** [http ://s433108212.onlinehome.us](http://s433108212.onlinehome.us)

我的客户希望标题中的空间背景延伸到我为标题设置的 1000 像素区域之外。所以我的解决方案是创建另一个 100% 带有背景的包装器：repeat-x 平铺空间的图像。

好吧，它适用于 PC 和 Mac 上的每个浏览器，除了 iPhone 和 iPad，这真的让我感到困惑，因为它看起来像在下面的屏幕截图中，space_stretch_bg 包装器中的平铺背景图像是**1)**推到左侧和**2 )**不平铺**3)**你在它上面的 1000px 固定横幅后面看到白色：/

![在此处输入图像描述](../Images/cd60b3d1b8f6cc26757f7ae8dd134056.png) ![在此处输入图像描述](../Images/253c251a2a1a5057bc342abe18b0dbb5.png)

还有其他人遇到这个吗？

CSS：

```
body { 
    width: 100%; margin: 0 auto;
    background-image:url('../img/clouds.jpg');
    background-repeat:repeat; 
}
.wrapper_bg {
    position: absolute; 
    width: 100%; height: 350px; 
    background-image:url('../img/bg_tile.gif'); 
    background-repeat:repeat-x; 
}
.space_stretch_bg { 
    position: absolute; 
    top: 100px; width: 100%; height: 250px; 
    background-image:url('../img/space_banner_big.jpg'); 
    background-repeat:repeat-x; background-position:center; 
}
.container1000 { 
    position: relative; 
    width: 1000px; top: -100px; 
    margin:auto; 
}
#content_container { 
    position: absolute; 
    overflow: hidden; 
    top: 350px; padding: 20px; 
    background: #fff 
} 
```

缩短的 HTML：

```
<body>

<div class="wrapper_bg">
<div class="space_stretch_bg">
<div class="container1000">

    <!-- nav_bar -->

    <div id="banner">
        <a href="http://s433108212.onlinehome.us/index.php" title="Athena's Web">
            <div class="logo">
                <h1>Athena's Web</h1>
                <h2>Carpe Noctem</h2>
                <img src="http://s433108212.onlinehome.us/img/athenas_web_logo_no_text.png" alt="Athena's Web Carpe Noctem"/>
            </div>
         </a>

        <div id="social_media">

            <!-- social_icons -->

        </div><!-- social_media -->

        </div><!-- banner -->
        <!-- End Header --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:37:51.033

首先：这是因为 wrapper_bg 背景变小了。它在 space_stretch_bg 后面。给 wrapper_bg`min-width: 1000px`因为你的 content_container 是 1000px。

如果您将浏览器缩小，您也可以在 PC 浏览器上看到空白区域。

# iphone - UIImagePicker 允许编辑卡在中心

> ID：12630155
> 
> 赞同：46
> 
> 时间：2012-09-27T21:16:43.413
> 
> 标签：iphone, ios, uiimagepickercontroller

我有一个 UIImagePicker，它非常适合一种 UIImagePickerControllerSourceTypePhotoLibrary，但是当我使用 UIImagePickerControllerSourceTypeCamera 时，编辑框无法从图像的中心移动。因此，如果图像的高度大于宽度，则用户无法将编辑框移动到图像的顶部正方形。

有谁知道为什么会这样？仅当源来自相机而不是库时才会发生。

编辑：一些代码！！！

```
if (actionSheet.tag == 2) {
    if (buttonIndex == 0) { // Camera
        // Check for camera
        if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera] == YES) {
            // Create image picker controller
            UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

            // Set source to the camera
            imagePicker.sourceType =  UIImagePickerControllerSourceTypeCamera;
            imagePicker.allowsEditing = YES;

            // Delegate is self
            imagePicker.delegate = self;

            // Show image picker
            [self presentViewController:imagePicker 
                               animated:YES 
                             completion:^(void) {
                             }];
        }
    }
    else if (buttonIndex == 1) { // Photo Library
        if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary] == YES) {
            // Create image picker controller
            UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

            // Set source to the camera
            imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
            imagePicker.allowsEditing = YES;

            // Delegate is self
            imagePicker.delegate = self;

            // Show image picker
            [self presentViewController:imagePicker 
                               animated:YES 

                          completion:^(void) {
                                 }];
            }
} 
```

如您所见，我将它们显示为完全相同，但相机编辑的行为与照片库编辑不同。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-10-31T20:41:25.630

看起来这种行为只是iOS 6中的一个错误......基本上你不能移动编辑框，除非你放大一点，否则它总是弹回中间。希望他们能尽快解决这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-03-24T10:00:04.707

谢谢[你](https://stackoverflow.com/users/3282496/yycking)。此[扩展程序](https://stackoverflow.com/a/53440254/7760418)有效。除了我在里面添加了方法调用，`viewDidLayoutSubviews`这样我每次想要打开图像选择器时都不必调用它。

这是完整的扩展

```
extension UIImagePickerController {
    open override var childForStatusBarHidden: UIViewController? {
        return nil
    }

    open override var prefersStatusBarHidden: Bool {
        return true
    }

    open override func viewDidLayoutSubviews() {
        super.viewDidLayoutSubviews()
        fixCannotMoveEditingBox()
    }

    func fixCannotMoveEditingBox() {
            if let cropView = cropView,
               let scrollView = scrollView,
               scrollView.contentOffset.y == 0 {

                var top: CGFloat = 0.0
                if #available(iOS 11.0, *) {
                    top = cropView.frame.minY + self.view.safeAreaInsets.top
                } else {
                    // Fallback on earlier versions
                    top = cropView.frame.minY
                }
                let bottom = scrollView.frame.height - cropView.frame.height - top
                scrollView.contentInset = UIEdgeInsets(top: top, left: 0, bottom: bottom, right: 0)

                var offset: CGFloat = 0
                if scrollView.contentSize.height > scrollView.contentSize.width {
                    offset = 0.5 * (scrollView.contentSize.height - scrollView.contentSize.width)
                }
                scrollView.contentOffset = CGPoint(x: 0, y: -top + offset)
            }

            DispatchQueue.main.asyncAfter(deadline: .now() + 0.1) { [weak self] in
                self?.fixCannotMoveEditingBox()
            }
        }

        var cropView: UIView? {
            return findCropView(from: self.view)
        }

        var scrollView: UIScrollView? {
            return findScrollView(from: self.view)
        }

        func findCropView(from view: UIView) -> UIView? {
            let width = UIScreen.main.bounds.width
            let size = view.bounds.size
            if width == size.height, width == size.height {
                return view
            }
            for view in view.subviews {
                if let cropView = findCropView(from: view) {
                    return cropView
                }
            }
            return nil
        }

        func findScrollView(from view: UIView) -> UIScrollView? {
            if let scrollView = view as? UIScrollView {
                return scrollView
            }
            for view in view.subviews {
                if let scrollView = findScrollView(from: view) {
                    return scrollView
                }
            }
            return nil
        }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-23T03:16:55.223

**愚蠢的答案**
重置滚动视图的内容插入

```
extension UIImagePickerController {
    func fixCannotMoveEditingBox() {
        if let cropView = cropView,
           let scrollView = scrollView,
           scrollView.contentOffset.y == 0 {

            let top = cropView.frame.minY + self.view.safeAreaInsets.top
            let bottom = scrollView.frame.height - cropView.frame.height - top
            scrollView.contentInset = UIEdgeInsets(top: top, left: 0, bottom: bottom, right: 0)

            var offset: CGFloat = 0
            if scrollView.contentSize.height > scrollView.contentSize.width {
                offset = 0.5 * (scrollView.contentSize.height - scrollView.contentSize.width)
            }
            scrollView.contentOffset = CGPoint(x: 0, y: -top + offset)
        }

        DispatchQueue.main.asyncAfter(deadline: .now() + 0.1) { [weak self] in
            self?.fixCannotMoveEditingBox()
        }
    }

    var cropView: UIView? {
        return findCropView(from: self.view)
    }

    var scrollView: UIScrollView? {
        return findScrollView(from: self.view)
    }

    func findCropView(from view: UIView) -> UIView? {
        let width = UIScreen.main.bounds.width
        let size = view.bounds.size
        if width == size.height, width == size.height {
            return view
        }
        for view in view.subviews {
            if let cropView = findCropView(from: view) {
                return cropView
            }
        }
        return nil
    }

    func findScrollView(from view: UIView) -> UIScrollView? {
        if let scrollView = view as? UIScrollView {
            return scrollView
        }
        for view in view.subviews {
            if let scrollView = findScrollView(from: view) {
                return scrollView
            }
        }
        return nil
    }
} 
```

然后调用它

```
imagePickercontroller.fixCannotMoveEditingBox() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:08:40.477

这是 Image Picker Controller 的默认行为，您无法更改它。唯一的其他选择是创建自己的裁剪实用程序。查看下面的链接以获取示例：

[https://github.com/ardalahmet/SSPhotoCropperViewController](https://github.com/ardalahmet/SSPhotoCropperViewController)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-01T06:57:39.380

我知道，这不是一个好的解决方案，但它确实有效。

我在iOS8+iPhone5、iOS9+iPhone6sPlus、iOS10+iPhone6、iOS10+iPhone6sPlus上进行了测试。

**注意**：`PLImageScrollView`并且`PLCropOverlayCropView`是**未记录**的类。

```
- (void)showImagePickerControllerWithSourceType:(UIImagePickerControllerSourceType)sourceType {
    UIImagePickerController *imagePickerController = [UIImagePickerController new];
    imagePickerController.sourceType = sourceType;
    imagePickerController.mediaTypes = @[(NSString *)kUTTypeImage];
    imagePickerController.allowsEditing = YES;
    imagePickerController.delegate = self;
    [self presentViewController:imagePickerController animated:YES completion:^{
        [self fxxxImagePickerController:imagePickerController];
    }];
}

- (void)fxxxImagePickerController:(UIImagePickerController *)imagePickerController {
    if (!imagePickerController
        || !imagePickerController.allowsEditing
        || imagePickerController.sourceType != UIImagePickerControllerSourceTypeCamera) {
        return;
    }

    // !!!: UNDOCUMENTED CLASS
    Class ScrollViewClass = NSClassFromString(@"PLImageScrollView");
    Class CropViewClass = NSClassFromString(@"PLCropOverlayCropView");

    [imagePickerController.view eachSubview:^BOOL(UIView *subview, NSInteger depth) {
        if ([subview isKindOfClass:CropViewClass]) {
            // 0\. crop rect position
            subview.frame = subview.superview.bounds;
        }
        else if ([subview isKindOfClass:[UIScrollView class]]
            && [subview isKindOfClass:ScrollViewClass]) {
            BOOL isNewImageScrollView = !self->_imageScrollView;
            self->_imageScrollView = (UIScrollView *)subview;
            // 1\. enable scrolling
            CGSize size = self->_imageScrollView.frame.size;
            CGFloat inset = ABS(size.width - size.height) / 2;
            self->_imageScrollView.contentInset = UIEdgeInsetsMake(inset, 0, inset, 0);
            // 2\. centering image by default
            if (isNewImageScrollView) {
                CGSize contentSize = self->_imageScrollView.contentSize;
                if (contentSize.height > contentSize.width) {
                    CGFloat offset = round((contentSize.height - contentSize.width) / 2 - inset);
                    self->_imageScrollView.contentOffset = CGPointMake(self->_imageScrollView.contentOffset.x, offset);
                }
            }
        }
        return YES;
    }];

    // prevent re-layout, maybe not necessary
    @weakify(self, imagePickerController);
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
        @strongify(self, imagePickerController);
        [self fxxxImagePickerController:imagePickerController];
    });
} 
```

* * *

**编辑**：该`eachSubview:`方法遍历所有子视图树。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-20T08:13:50.760

如果您在 info.plist 中将“查看基于控制器的状态栏外观”设置为 NO 并将状态栏外观设置为浅色，请使用

```
 UIApplication.shared.statusBarStyle = .lightContent 
```

或使用任何其他方法，然后只需在呈现图像选择器之前将样式设置为 .default 即可。例如：

```
imagePicker.allowsEditing = true
imagePicker.sourceType = .photoLibrary
UIApplication.shared.statusBarStyle = .default
present(imagePicker, animated: true, completion: nil) 
```

根据您的需要将源类型更改为*photoLibrary 或相机*，并在您的**didFinishPickingMediaWithInfo**的完成块中将以下内容添加到完成块中。

```
func imagePickerController(_ picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any]) {
    //let pickedImage = info[UIImagePickerControllerOriginalImage] as? UIImage

    var pickedImage : UIImage?
    if let img = info[UIImagePickerControllerEditedImage] as? UIImage
    {
        pickedImage = img

    }
    else if let img = info[UIImagePickerControllerOriginalImage] as? UIImage
    {
        pickedImage = img
    }
    dismiss(animated: true, completion: {
        UIApplication.shared.statusBarStyle         = .lightContent
    })} 
```

显然这是相同的解决方法。希望这会有所帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-04-18T14:27:06.750

解决它的一种解决方法是在 info.plist 中添加一个条目，并将“**基于控制器的状态栏外观**”设置为 NO

# twitter-bootstrap - 如何在 Twitter Bootstrap 模式中启用转义键关闭功能？

> ID：12630156
> 
> 赞同：137
> 
> 时间：2012-09-27T21:16:43.750
> 
> 标签：twitter-bootstrap

我按照[他们的主文档页面上的 Twitter Bootstrap 模态](http://twitter.github.com/bootstrap/)
说明进行了操作，并使用了`data-keyboard="true"`提到的语法，但转义键不会关闭模态窗口。
还有什么我想念的吗？

代码：

```
<a href="#my-modal" data-keyboard="true" data-toggle="modal">Open Modal</a>

<div class='modal fade hide' id='my-modal'>
  <div class='modal-body'>
    <div>Test</div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：321
> 
> 时间：2012-09-27T21:48:43.390

看起来这是如何绑定 keyup 事件的问题。

您可以将`tabindex`属性添加到模态以解决此问题：

```
tabindex="-1" 
```

所以你的完整代码应该是这样的：

```
<a href="#my-modal" data-keyboard="true" data-toggle="modal">Open Modal</a>

<div class='modal fade hide' id='my-modal' tabindex='-1'>
    <div class='modal-body'>
    <div>Test</div>
    </div>
</div> 
```

有关更多信息，您可以[在 github 上查看有关此问题的讨论](https://github.com/twbs/bootstrap/issues/4663)

（更新到新 TWBS 存储库的链接）

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-10-05T23:11:49.143

另外，如果您通过 javascript 调用，请使用以下命令：

```
$('#myModal').modal({keyboard: true}) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-01-25T07:09:53.113

将`tabindex="-1"`属性添加到模态 div

```
<div id="myModal" class="modal fade" role="dialog" tabindex="-1">

</div> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-21T18:46:42.460

在角度我使用这样的：

```
var modalInstance = $modal.open({                        
 keyboard: false,
 backdrop: 'static',
 templateUrl: 'app/dashboard/view/currentlyIneligibleView.html',
 controller: 'currentlyIneligibleCtrl',
 resolve: {
     data: function () { return param; }
    }
}); 
```

*   背景：'static' => 点击外部时停止关闭
*   键盘：false => 使用转义按钮停止关闭

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-11T10:35:49.350

让模态= []

```
 $(document).keyup(function(e) {
            if((e.key=='Escape' || e.key=='Esc' || e.keyCode==27) && modals.length) {
                $(".modal[modal='" + modals.pop() + "']").modal('hide')
            }
        })

        $(".modal").on("shown.bs.modal", e => {
            const id = modals.length
            modals.push(id)
            $(e.target).attr("modal", id)
        }) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-01-10T03:59:59.890

# 引导程序 3

在 HTML 中，只需设置`data-backdrop`为 static 和`data-keyboard`false

## 例子 ：

```
<button type="button" data-toggle="modal" data-target="#myModal" data-backdrop="static" data-keyboard="false">Launch modal</button> 
```

或者

```
$('#myModal').modal({
  backdrop: 'static',
  keyboard: false
}) 
```

## 现场测试：

[https://jsfiddle.net/sztx8qtz/](https://jsfiddle.net/sztx8qtz/)

了解更多：[http ://budiirawan.com/prevent-bootstrap-modal-closing/](http://budiirawan.com/prevent-bootstrap-modal-closing/)

# ios - iOS：在范围内时自动重新建立蓝牙 BLE 连接

> ID：12630162
> 
> 赞同：5
> 
> 时间：2012-09-27T21:17:05.877
> 
> 标签：ios, bluetooth, core-bluetooth, bluetooth-lowenergy

是否可以“配对”蓝牙 BLE 设备，以便它们在范围内时自动连接？（即，iPhone 应用程序建立了与蓝牙设备的连接，从那时起，如果在范围内，iPhone 会自动重新连接到设备，即使应用程序在几天内没有打开并且完全关闭）。

重新连接后，设备可以使用事件后台提示用户打开应用程序或以其他方式与可能有后台的应用程序交互（如此[处](http://lists.apple.com/archives/bluetooth-dev/2011/Dec/msg00007.html)所述）。

有趣的是，我使用了蓝牙键盘，当回到范围内时，它会自动重新连接到我的笔记本电脑。这些不一定是 BLE 设备，这在 BLE 领域是可能的吗？

如果 iPhone 是服务器而不是设备，这可能吗？如果这是在 MFI 程序下使用传统蓝牙完成的呢？

[此处和 Apple Bluetooth-dev 邮件列表](https://lists.apple.com/mailman/listinfo/bluetooth-dev)中有许多相关评论，但没有任何内容可以为我清除。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T12:19:22.230

我在 Bluetooth-dev 上发布了我的问题，我将这里的回复留待后验： http: [//lists.apple.com/archives/bluetooth-dev/2012/Sep/msg00117.html](http://lists.apple.com/archives/bluetooth-dev/2012/Sep/msg00117.html)

# python - 如何编写一个函数将列表中的元素拆分为python中的字符串

> ID：12630164
> 
> 赞同：-5
> 
> 时间：2012-09-27T21:17:14.863
> 
> 标签：python, list, function

如何创建一个将列表拆分为每个变量的函数

例如：如果每个列表都有“n”个元素

```
mylist = [var,var1,var2,var3]
anotherlist = [var,var1,var2,var4,var5] 
```

--> 结果

创建一个函数来拆分这些变量列表

```
split(mylist) --> 
x = var
x1 = var1
x2 = var2
: 
xn = varn 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:58:48.827

首先，在我看来，问题是关于动态分配变量。其次，这是一个坏主意。您应该改用字典。不过，这里有一个你不应该做的例子，但它似乎回答了你的问题。

```
In [196]: def assign_variables(mylist):
     ...:     for idx,item in enumerate(mylist):
     ...:         var='x'+str(idx)
     ...:         globals()[var]=item
     ...:         

In [197]: mylist=['var','var1','var2','var3']

In [198]: assign_variables(mylist)

In [199]: x1
Out[199]: 'var1'

In [200]: x2
Out[200]: 'var2' 
```

使用 dict 你可以这样尝试：

```
>>> def var_dict(mylist):
...     d={}
...     for idx,item in enumerate(mylist):
...         var='x'+str(idx)
...         d[var]=item
...     return d
... 
>>> mylist=['var','var1','var2','var3']
>>> mydict=var_dict(mylist)
>>> mydict
{'x0': 'var', 'x1': 'var1', 'x2': 'var2', 'x3': 'var3'}
>>> mydict['x1']
'var1'
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:24:21.903

我不太明白你的问题，但你的意思是这样的：

```
def print_var(variable_list):
    for i, element in enumerate(variable_list):
        print 'x' + str(i) + ' = ' + element

mylist = ['var','var1','var2','var3']
anotherlist = ['var','var1','var2','var4','var5']
print_var(mylist)
print_var(anotherlist) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T21:25:08.763

这是可能的，就像在“可行”中一样——但它不太可能对任何事情有用。如果您的列表的长度一开始是未知的，那么如果您不知道代码中可能值的范围，那么使用名为“x”的变量会有多好。

Python 作为一门语言，其设计目的是让您拥有具有已知名称的变量——您遇到的任何动态数据都应保存在动态数据结构中，例如字典，或者，因为在这种情况下，您拥有的唯一标识符是索引，列表本身。

换句话说，你最好：

```
mylist = [var,var1,var2,var3]
mylist[0]
mylist[1]
... 
```

比你要求的 - 因为你可以检查 mylist 的长度，或者简单地用 for 语句循环它的元素。

也就是说，重要的是要记住 Python 确实具有 assignemtn 解包功能，因此如果您的列表具有已知长度，您可以简单地执行以下操作：

```
mylist = [var1, var2, var3, var4]
x1, x2, x3, x4 = mylist 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T21:26:01.013

因为你的问题很模糊。我正在应用我从中可以理解的内容，即您想将另一个列表中的变量分配给 mylist 中的名称。在这种情况下，您将需要使用这样的字典。

```
mydict = {}
for i in xrange(len(mylist)):
    mydict[mylist[i]] = anotherlist[i] 
```

然后，您可以自由地将`mydict`与`mylist`作为键的值一起使用。

# c# - MemoryCache AbsoluteExpiration 行为奇怪

> ID：12630168
> 
> 赞同：41
> 
> 时间：2012-09-27T21:17:42.330
> 
> 标签：c#, .net, memorycache

我正在尝试使用`MemoryCache`.net 4.5 中的 a 来跟踪并自动更新各种项目，但似乎无论我设置什么，`AbsoluteExpiration`它总是只会在 15 秒或更长时间内过期。

我希望缓存项每 5 秒过期一次，但它总是在至少 15 秒后过期，如果我将过期时间移出，它最终会是 15 秒 + 我的刷新间隔，但绝不会少于 15 秒.

是否有一些我没有看到的内部计时器分辨率？我查看了一些反映的`System.Runtime.Caching.MemoryCache`代码，但没有什么特别突出的，而且我无法在互联网上找到其他有此问题的人。

我在下面有一个非常基本的例子来说明这个问题。

我想要的是`CacheEntryUpdate`每 5 秒左右被击中一次并用新数据更新，但是，正如我所说，它只会在 15 秒内被击中。

```
static MemoryCache MemCache;
static int RefreshInterval = 5000;

protected void Page_Load(object sender, EventArgs e)
{
    if (MemCache == null)
        MemCache = new MemoryCache("MemCache");

    if (!MemCache.Contains("cacheItem"))
    {
        var cacheObj = new object();
        var policy = new CacheItemPolicy
        {
            UpdateCallback = new CacheEntryUpdateCallback(CacheEntryUpdate),
            AbsoluteExpiration = DateTimeOffset.UtcNow.AddMilliseconds(RefreshInterval)
        };
        var cacheItem = new CacheItem("cacheItem", cacheObj);
        MemCache.Set("cacheItem", cacheItem, policy);
    }
}

private void CacheEntryUpdate(CacheEntryUpdateArguments args)
{
    var cacheItem = MemCache.GetCacheItem(args.Key);
    var cacheObj = cacheItem.Value;

    cacheItem.Value = cacheObj;
    args.UpdatedCacheItem = cacheItem;
    var policy = new CacheItemPolicy
    {
        UpdateCallback = new CacheEntryUpdateCallback(CacheEntryUpdate),
        AbsoluteExpiration = DateTimeOffset.UtcNow.AddMilliseconds(RefreshInterval)
    };
    args.UpdatedCacheItemPolicy = policy;
} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-28T18:27:08.397

我已经想通了。在 System.Runtime.Caching.CacheExpires 上有一个`internal static readonly TimeSpan`名为 _tsPerBucket 的硬编码为 20 秒。

显然，这个字段是在内部计时器上使用的，它运行并检查缓存项是否过期。

我正在通过使用反射覆盖该值并清除默认 MemoryCache 实例以重置所有内容来解决此问题。它似乎有效，即使它是一个巨大的黑客。

这是更新的代码：

```
static MemoryCache MemCache;
static int RefreshInterval = 1000;

protected void Page_Load(object sender, EventArgs e)
{
    if (MemCache == null)
    {
        const string assembly = "System.Runtime.Caching, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
        var type = Type.GetType("System.Runtime.Caching.CacheExpires, " + assembly, true, true);
        var field = type.GetField("_tsPerBucket", BindingFlags.Static | BindingFlags.NonPublic);
        field.SetValue(null, TimeSpan.FromSeconds(1));

        type = typeof(MemoryCache);
        field = type.GetField("s_defaultCache", BindingFlags.Static | BindingFlags.NonPublic);
        field.SetValue(null, null);

        MemCache = new MemoryCache("MemCache");
    }

    if (!MemCache.Contains("cacheItem"))
    {
        var cacheObj = new object();
        var policy = new CacheItemPolicy
        {
            UpdateCallback = new CacheEntryUpdateCallback(CacheEntryUpdate),
            AbsoluteExpiration = DateTimeOffset.UtcNow.AddMilliseconds(RefreshInterval)
        };
        var cacheItem = new CacheItem("cacheItem", cacheObj);
        MemCache.Set("cacheItem", cacheItem, policy);
    }
}

private void CacheEntryUpdate(CacheEntryUpdateArguments args)
{
    var cacheItem = MemCache.GetCacheItem(args.Key);
    var cacheObj = cacheItem.Value;

    cacheItem.Value = cacheObj;
    args.UpdatedCacheItem = cacheItem;
    var policy = new CacheItemPolicy
    {
        UpdateCallback = new CacheEntryUpdateCallback(CacheEntryUpdate),
        AbsoluteExpiration = DateTimeOffset.UtcNow.AddMilliseconds(RefreshInterval)
    };
    args.UpdatedCacheItemPolicy = policy;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-02-27T11:26:03.883

您愿意/能够从旧的 System.Runtime.Caching 更改为新的[Microsft.Extensions.Caching](https://www.nuget.org/packages/Microsoft.Extensions.Caching.Memory)吗？1.x 版支持 netstandard 1.3 和 net451。如果是这样，那么改进的 API 将支持您描述的使用，而无需使用反射。

MemoryCacheOptions 对象有一个属性 ExpirationScanFrequency 允许您控制缓存清理的扫描频率，请参阅[https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.memory.memorycacheoptions.expirationscanfrequency ?view=aspnetcore-2.0](https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.memory.memorycacheoptions.expirationscanfrequency?view=aspnetcore-2.0)

请注意，不再基于计时器到期（这是性能设计决定），因此现在内存压力或为缓存项目调用基于 Get() 的方法之一现在是到期的触发器。但是，您可以使用取消令牌强制基于时间的到期，请参阅此 SO 答案以获取示例[https://stackoverflow.com/a/47949111/3140853](https://stackoverflow.com/a/47949111/3140853)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-17T19:19:05.077

对于 MatteoSp - 配置中的 pollingInterval 或构造函数中的 NameValueCollection 是不同的计时器。这是一个间隔，调用时将使用其他两个配置属性来确定内存是否处于需要使用 Trim 方法删除条目的级别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-25T08:20:55.373

基于@Jared 回答的更新版本。Insread 修改默认的 MemoryCache 实例，这里新建一个。

```
class FastExpiringCache
{
    public static MemoryCache Default { get; } = Create();

    private static MemoryCache Create()
    {
        MemoryCache instance = null;
        Assembly assembly = typeof(CacheItemPolicy).Assembly;
        Type type = assembly.GetType("System.Runtime.Caching.CacheExpires");
        if( type != null)
        {
            FieldInfo field = type.GetField("_tsPerBucket", BindingFlags.Static | BindingFlags.NonPublic);
            if(field != null && field.FieldType == typeof(TimeSpan))
            {
                TimeSpan originalValue = (TimeSpan)field.GetValue(null);
                field.SetValue(null, TimeSpan.FromSeconds(3));
                instance = new MemoryCache("FastExpiringCache");
                field.SetValue(null, originalValue); // reset to original value
            }
        }
        return instance ?? new MemoryCache("FastExpiringCache");
    }
} 
```

# javascript - 强制带标签的有向图

> ID：12630170
> 
> 赞同：3
> 
> 时间：2012-09-27T21:17:47.067
> 
> 标签：javascript, d3.js, data-visualization, graph-visualization

我对 D3.js 相当陌生，并试图理解为什么我的[这个示例](http://bl.ocks.org/2879486)版本不起作用。我也用[这个例子](http://bl.ocks.org/950642)作为参考。

据我所知，问题出在我的`tick`功能上；当我注释掉它时，svg 对象被写入文档，但是没有 svg 被写入。

这是我的代码：

```
// CSS 样式
    。关联 {
        中风：#ccc；
    }
    .node {
        指针事件：无；
        字体：10px 无衬线；
    }
// 结束 CSS 样式

// 在正文中开始 JS
// 数据集
var 数据节点 =
[
    {id: "N1", name: "First 1", type: "Type 1"},
    {id：“N2”，名称：“节点 2”，类型：“类型 3”}，
    {id：“N3”，名称：“节点 3”，类型：“类型 4”}
];

var 数据链接 =
[
    {sourceId：“N1”，linkName：“关系1”，targetId：“N2”}，
    {sourceId：“N3”，linkName：“关系2”，targetId：“N1”}，
    {sourceId：“N2”，linkName：“关系 3”，targetId：“N1”}
];

变量 w = 960;
变量 h = 500;
变量节点；
变种链接；
变种根；

var svg = d3.select("body")
            .append("svg")
            .attr("宽度",w)
            .attr("高度",h);

var node_hash = [];
var type_hash = [];

nodeSet.forEach(函数(d,i){
    节点哈希[d.id] = d;
    type_hash[d.type] = d.type;
});

linkSet.forEach(函数(d,i){
    d.source = node_hash[d.sourceId];
    d.target = node_hash[d.sourceId];
});

var force = d3.layout.force()
              .charge(-1000)
              .nodes（数据节点）
              .links（数据链接）
              .size([w,h])
              .linkDistance(100)
              .on（“滴答声”，滴答声）
              。开始（）;

var links = svg.selectAll(".glink")
                .data(froce.links())
                。进入（）
                .append("g")
                .attr("类","gLink")
                .append("行")
                .attr("类","链接")
                .style("中风","#ccc");

var node = svg.selectAll(".node")
                .data(froce.nodes())
                。进入（）
                .append("g")
                .attr("类","节点")
                .call(force.drag);

节点
    .append("圆")
    .attr("x", 函数(d){
        返回 dx；
    })
    .attr("y",函数(d){
        返回 dy;
    })
    .attr("r", 10)
    .style ("填充","白色")
    .style("笔画宽度",2)
    .style("中风", "黑色")
    .call(force.drag);

功能滴答（）{
    链接
        .attr("x1",函数(d){
            返回d.source.x；
        })
        .attr("y1",function(){
            返回d.source.y；
        })
        .attr("x2",函数{
            返回 d.target.x;
        })
        .attr("y2",函数{
            返回 d.target.y;
        });

    node.attr("变换",function(d){
        返回 "翻译("+d.x+","+d.y+")";
    });

};
// 在正文中结束 JS

```

任何帮助，将不胜感激。

# objective-c - ObjC：如何编译包含依赖第三方库的可选类的静态库

> ID：12630171
> 
> 赞同：7
> 
> 时间：2012-09-27T21:18:06.550
> 
> 标签：objective-c, linker, static-libraries, static-linking

我正在尝试找到打包包含可选类（例如 ClassA）的静态库（我们称之为 Lib1）的最佳方法，该类本身需要第二个静态库（Lib2）。换句话说，只有在项目代码中引用了 ClassA 时才需要 Lib2。事情似乎工作正常，除非在不使用 ClassA（因此不包括 Lib2）的项目中使用 Lib1，但需要 -ObjC 链接器标志（因为其他项目依赖项，而不是我的）。

我试图为以下三种情况提出一个简单的解决方案：
1）项目包含我的静态库，不使用可选类，不指定 -ObjC 标志
2）项目包含我的静态库，不使用可选类，但需要 -ObjC 标志
3) 项目包括我的静态库 + 第二个静态库，并且确实使用可选类（此时我们不关心 -ObjC 标志）

是否有一个链接器标志可以将我的可选类从最终项目应用程序中剥离出来，以便它不需要第二个静态库？我想我的其他选择是发布我的静态库的多个版本，一个包含选项类（标准选择），一个不包含选项类（替代，用于具有 -ObjC 要求的项目），或者可能提供一个存根文件，提供第二个静态库所需的所有类的空实现？这似乎是静态库世界中的一个常见问题......这种情况有最佳实践吗？

谢谢！

* * *

# 解决方案：

1) 建议我的 -ObjC 用户改用 -force_load。（感谢 Rob！）
2）对于不能做 1 的用户，我将有一个不包括 ClassA 的替代版本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T21:25:48.717

最佳实践始终是最终二进制链接所有所需的静态库。您永远不应该将一个静态库捆绑到另一个静态库中。您绝对不应该将众所周知的（即开源）静态库捆绑到您发布的静态库中。这会给最终消费者带来令人难以置信的头痛，因为他们最终可能会使用相同代码的多个版本。追踪可能由此产生的错误非常困难。如果他们幸运的话，他们只会得到令人困惑的编译器错误。如果他们不走运，他们的代码将以不可预测的方式运行并随机崩溃。

单独发布所有静态库。告诉您的客户他们需要为各种配置链接哪些。试图避免这种情况只会让他们的生活变得困难。

其他一些可能有用的讨论：

*   [重复符号错误：SBJsonParser.o？](https://stackoverflow.com/questions/11603551/duplicate-symbol-error-sbjsonparser-o/11603829#11603829)（客户遇到供应商对他这样做的示例）
*   [链接静态库，共享另一个静态库](https://stackoverflow.com/questions/11750390/linking-static-libraries-that-share-another-static-library/11765890#11765890)
*   [为什么 iOS 框架依赖项在应用程序项目中不需要显式链接到静态库项目或框架项目？](https://stackoverflow.com/questions/10385331/why-dont-ios-framework-dependencies-need-to-be-explicitly-linked-to-a-static-li/10385392#10385392)

* * *

-ObjC 标志应该完全防止自动剥离`ClassA`，无论是否使用（有关更多详细信息，请参见[TN1490](http://developer.apple.com/library/mac/#qa/qa1490/_index.html)）。

如果`ClassA`除非在某些情况下从未使用过并且您想节省空间，那么您可能应该移动`ClassA`到它自己的静态库中。或用于`#ifdef`有条件地编译它。

或者，您可以删除该`-ObjC`标志并用于`-force_load`单独加载任何仅类别的编译单元（这是`-ObjC`用于解决的问题）。

# javascript - 模板中带有脚本标记的 IE 错误

> ID：12630173
> 
> 赞同：0
> 
> 时间：2012-09-27T21:18:27.087
> 
> 标签：javascript, jquery, backbone.js, handlebars.js, mustache

我的 Handlebar/Mustache 模板中有以下脚本标签：

```
<script type="text/javascript">
        $(function() {
            $(".enable-checkbox").click(function(e) {
                if ($(this).parent().attr("for") == "Webpage") {
                    $('#Webpage').attr("value", $(this).is(":checked")); // Set true/false.                    
                }                    
                if ($(this).parent().attr("for") == "Unsubscribe") {
                    $('#Unsubscribe').attr("value", $(this).is(":checked"));
                }
            });
        });
    </script> 
```

这在 Chrome 和 FF 中完美运行。但是，在 IE 上 - 我收到一个错误：

```
Error: Could not complete the operation due to error 80020101. 
```

经过一番研究，我发现上述错误是由于我的模板的脚本标签造成的。如果我删除脚本标签，它可以在 IE 中使用。

任何人都可以提出一种方法来让它在 IE 中工作吗？

PS：将脚本标签的内容移动到加载此脚本的外部/主页中不是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:09:26.313

您可以直接在 JavaScript 中创建模板（无需脚本标签）

```
App.templates = {

    template1: "{{#stooges}}" +
               "<b>{{name}}</b>" +
               "{{/stooges}}",

    template2: "{{#shows}}" +
               "<b>{{title}}</b>" +
               "{{/shows}}"

}; 
```

并像这样引用您的模板：

```
var output = Mustache.render(App.templates.template1, view); 
```

# php - 经过时间考验的受限 PHP 应用程序

> ID：12630175
> 
> 赞同：0
> 
> 时间：2012-09-27T21:18:42.813
> 
> 标签：php, mysql, windows, apache, time-trial

我有一个 PHP 应用程序，它将与 Apache、Mysql 和 PHP 一起打包并安装在内部 Windows 网络上。我希望能够创建应用程序的时间试用，以便它在设定的时间段（例如 30 天）后过期。我已经经历了几个场景，但没有提出任何具体的建议，因为我在一段时间内尝试限制访问的任何操作都可能被任何了解 PHP 的人规避，因为他们可以访问所有源代码。

我的解决方案是与应用程序一起分发一个密钥，该密钥在安装后第一次运行时传递给远程服务器。密钥、日期和 IP 地址保存在远程服务器上的数据库中。在此之后，每次访问应用程序时，它都会连接到远程服务器并比较密钥、IP 地址和日期。如果 IP 地址和密钥与存储的内容匹配并且日期差小于 30 天，则应用程序将运行，否则将无法运行。

这就是我想出的全部。谁能建议在本地安装的 Web 应用程序上创建 30 天试用的另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T00:37:51.183

`expire-in`ionCube 可以加密 PHP 文件，并使用开关使它们在设定的时间段内过期：

[http://www.ioncube.com](http://www.ioncube.com)

# ios - 由于未捕获的异常'NSInternalInconsistencyException'而终止应用程序，原因：'无法在包中加载NIB：'NSBundle

> ID：12630177
> 
> 赞同：2
> 
> 时间：2012-09-27T21:18:55.487
> 
> 标签：ios

ios编程新手。当我运行模拟器时，出现此错误。

> 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在包中加载 NIB：“NSBundle（已加载）”，名称为“cusCell”

这是我收到错误的那一行

```
static NSString *CellIdentifier = @"cusCell";
customCell *cell = (customCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
{
    ==>    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"cusCell" owner:self options:nil];
    cell = [nib objectAtIndex:0];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T06:42:00.467

有时，当您直接重命名某些文件时会出现此错误，而 XCode 无法理解它。只需从您的项目中删除文件的引用（右键单击 - 删除和“删除引用”），然后将文件再次拖放到您的项目中。它对我有用。

# php - 为 Joomla 安装 php 和 mysql - 无法通过安装

> ID：12630182
> 
> 赞同：0
> 
> 时间：2012-09-27T21:19:15.453
> 
> 标签：php, mysql, joomla, installation

尝试安装 Joomla 2.5.7 但我无法通过安装前检查，因为它说：`Database support: No`

我在 Linux 机器上手动安装了 mysql (5.5.24) 和 php (5.3.15)（我不想使用 LAMPP）。我之前已经这样做了几次，并检查了我的其他工作机器在包和 php.ini 文件方面的所有内容。我也可以正常访问mysql。

关于我可以尝试什么的任何建议？有没有办法找出它失败的检查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:22:01.563

大多数 CMS 都带有一个 sql 数据库设置文件。这些文件必须添加到您的 mysql 数据中。或者必须手动创建表和用户。你做过这个吗？？如果没有，请查看手册了解详细信息。

[http://linuxinternetworks.com/how-to-install-joomla-in-linux/](http://linuxinternetworks.com/how-to-install-joomla-in-linux/)

评论一下，试过了，我也在看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T02:44:10.030

啊！我确实错过了一个包裹。一个非常重要的：`php-mysql`。不要忘记重新启动 Web 服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T11:17:59.147

Joomla 通过测试每种类型的连接来检查支持哪些数据库。一个可能的问题是您设置东西的方式安装过程的所有者没有使用数据库的权限。

哎呀抱歉我没看到你卖了

# git - Capistrano 和 Git。如何更新生产但不删除某些文件？

> ID：12630183
> 
> 赞同：0
> 
> 时间：2012-09-27T21:19:15.883
> 
> 标签：git, deployment, capistrano

在每次 deploy:update 生产服务器丢失文件时，不在 git 存储库中的文件，例如用户文件、缓存等。

:deploy_via 设置为 :remote_cache

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T22:31:21.707

我确实通过将文件移动到其他目录（系统/共享）并创建一个符号链接来解决这个问题。

# php - 通过文件使用 IP 块计数器 - PHP

> ID：12630187
> 
> 赞同：-3
> 
> 时间：2012-09-27T21:19:38.427
> 
> 标签：php

我试图为我的页面的访问编写一个计数器，它每天只计算每个 IP 一次。我转录了一个找到的代码来了解它是如何工作的，并在以后实现一些其他功能。不幸的是，我的新代码不起作用。

我从中制作的代码：

```
<?php
$timeReset = 86400; //24h
$ipPath = "ipsafe.txt";
$countPath = "counts.txt";
$timePath = "time.txt";

$ip = $REMOTE_ADDR;
$time = time();
$resetTime = $time+$timeReset;

$timeFile = fopen($timePath, "r+");
$timeData = fread($timeFile, filesize($timePath));
//if resetTime is passed -> Reset
if($time >= $timeData) {
    //clear ipSafe
    $ipFile1 = fopen($ipPath, "w+"); 
    fclose($ipFile);
    //set new resetTime
    rewind($timeData);
    fwrite ($timeData, $resetTime);
}
fclose($timeFile);

//creat IP-List
$ipData = file($ipPath);
while (list ($line_num, $line) = each ($ipData)) {
    $digits = explode(",",$line);
}
//if IP was not saved in last timeframe
if(!in_array($ip, $digits))
{
    //write new IP
    $ipFile2=fopen($ipPath, "a+");
    @flock($ipFile1,2);
    fwrite($ipFile2, "$ip".",");
    @flock($ipFile1,3);
    fclose($ipFile2);
    //increment counter
    $countFile = fopen($countPath,"r+");
    $countData = fread($countFile, filesize($countPath);
    rewind($countFile);
    $countData++;
    fwrite($countFile, $countData);
    fclose($countFile);
}
?> 
```

有以下问题：

*   我的代码有什么问题？

*   flock 用于管理对文件的访问，但是为什么我要为同一个文件使用不同的名称呢？

感谢您的建议。

**编辑：**

很抱歉在解释问题时如此不具体。集成调试器后，我将“REMOTE_ADDR”更改为“$_SERVER['REMOTE_ADDR']”，因此修复了 1 个错误。现在我遇到了以下问题：

```
Warning: fopen(time.txt): failed to open stream: No such file or directory in .../counter.php on line 15 
```

但是该文件与 counter.php 位于同一目录中-当然 fread 和 filesize 也失败了

```
Warning: fopen(ipsafe.txt): failed to open stream: Permission denied in .../counter.php on line 20 
```

该文件尚不存在，但我认为“fopen($ipPath, "w+");" 如果它不存在则创建它。

```
Fatal error: Call to undefined function fb() in .../counter.php on line 26 
```

不是“fb($timeFile);” 将值发送到 firePHP？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:58:46.537

不进行完整的代码审查（这将导致几乎完全重写您的代码），我建议您更改以下内容以解决您列出的问题：

以下行使用`$REMOTE_ADDR`未定义的 。

```
$ip = $REMOTE_ADDR; 
```

您很可能打算使用`$_SERVER['REMOTE_ADDR']`（您已通过编辑确认），因此该行应为：

```
$ip = $_SERVER['REMOTE_ADDR']; 
```

您声明您在尝试打开`time.txt`文件时收到错误消息：“没有这样的文件或目录”。您还说该文件与`counter.php`- 存在于同一目录中，但您仍然收到此错误。这可能意味着两件事之一；首先，文件不存在，你错了；第二，您的 counter.php 文件与执行它的任何脚本位于不同的目录中 - 这意味着该`time.txt`文件需要位于执行脚本的目录中。我会为此推荐两件事。

首先，如果文件确实存在，请为其使用绝对路径：

```
$timePath = '/path/to/your/files/time.txt'; 
```

第二，验证文件是否存在（在代码中），如果不存在，则创建它。`fopen()`with `r`/ `r+`flags如果文件不存在，*则不会*创建文件，因此需要手动进行。尝试将代码更改为以下内容：

```
if (!file_exists($timePath)) touch($timePath);
$timeFile = fopen($timePath, 'r+');
if ($timeFile) {
    // the rest of your code
} 
```

您说打开`ipsafe.txt`文件时收到错误消息：“权限被拒绝”。这是一个有趣的；虽然行号与您的示例代码不匹配，但我相信这些是有问题的行：

```
//clear ipSafe
$ipFile1 = fopen($ipPath, "w+"); 
fclose($ipFile); 
```

第一个问题是您永远不会`$ipFile1`在代码中使用（除了错误地锁定/解锁它；有关该信息，请参见下文）。第二个是你打电话`fclose($ipFile);`。没有句柄命名`$ipFile`！您可以删除这些代码行！

您尝试`rewind`使用文件中的文件指针`time.txt`写入新时间，但是，您使用的是从文件中读取的值`$timeData`- 而不是文件本身`$timeFile`。将这些行更新为以下内容：

```
rewind($timeFile);
fwrite($timeFile, $resetTime); 
```

您再次读取文件`ipsafe.txt`以查看完整的 IP 地址列表 - 如果当前用户的 IP 不在其中，则添加它。这可能是一个逻辑问题，但您*只*检查文件最后一行的 IP 地址 - 但您仍会遍历项目的每一行。根据代码中的注释：`//if IP was not saved in last timeframe`，我将假设这是您打算做的 - 但以防万一 - 我建议将`if`出现在循环下方的完整 -statement 块移动到循环内部。

这是有趣的块：

```
//write new IP
$ipFile2=fopen($ipPath, "a+");
@flock($ipFile1,2);
fwrite($ipFile2, "$ip".",");
@flock($ipFile1,3);
fclose($ipFile2); 
```

您将文件打开到`$ipFile2`( **2** )，然后锁定一个完全不同的文件`$ipFile1`( **1** )，写入**2**，解锁**1**，然后关闭**2**。我认为您的意图是锁定/解锁**2**，这在这里非常有意义，因此我建议您更改`$ipFile1`为`$ipFile2`这些行。

那应该（可能）做到这一点。毕竟，代码应该类似于：

```
<?php
$timeReset = 86400; //24h
$ipPath = "ipsafe.txt";
$countPath = "counts.txt";
$timePath = "time.txt";

$ip = $_SERVER['REMOTE_ADDR'];
$time = time();
$resetTime = $time+$timeReset;

if (!file_exists($timePath)) touch($timePath);
$timeFile = fopen($timePath, "r+");
if ($timeFile) {
    $timeData = fread($timeFile, filesize($timePath));
    //if resetTime is passed -> Reset
    if($time >= $timeData) {
        //set new resetTime
        rewind($timeFile);
        fwrite ($timeFile, $resetTime);
    }
    fclose($timeFile);

    //creat IP-List
    $ipData = file($ipPath);
    while (list ($line_num, $line) = each ($ipData)) {
        $digits = explode(",",$line);
    }
    //if IP was not saved in last timeframe
    if(!in_array($ip, $digits)) {
        //write new IP
        $ipFile2=fopen($ipPath, "a+");
        @flock($ipFile2, LOCK_EX);
        fwrite($ipFile2, "$ip".",");
        @flock($ipFile2, LOCK_UN);
        fclose($ipFile2);
        //increment counter
        if (!file_exists($countPath)) touch($countPath);
        $countFile = fopen($countPath,"r+");
        if ($countFile) {
            $countData = fread($countFile, filesize($countPath);
            if (empty($countData)) $countData = 0; // initialize the counter to '0' if it hasn't been set
            rewind($countFile);
            $countData++;
            fwrite($countFile, $countData);
            fclose($countFile);
        }
    }
}
?> 
```

`$resetTime`现在，关于您的变量，我还有一个额外的逻辑问题。理想情况下，增加一天是给给定时间戳增加 24 小时（24 小时 = 86400 秒）。但是，夏令时将打破这一点。而不是执行以下操作：

```
$resetTime = time() + 86400; 
```

尝试走不同的路线（如果您对此感到担心，那就是）：

```
$resetTime = strtotime('+1 day'); 
```

# drop-down-menu - 允许点击 twitter bootstrap 下拉切换链接？

> ID：12630188
> 
> 赞同：68
> 
> 时间：2012-09-27T21:19:42.840
> 
> 标签：drop-down-menu, hyperlink, twitter-bootstrap

我们已经设置了 twitter 引导下拉菜单以在悬停时工作（而不是单击 [是的，我们知道触摸设备上没有悬停]）。但是我们希望能够在单击主链接时使其工作。

默认情况下，twitter bootstrap 会阻止它，那么我们如何重新启用它呢？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-09-29T14:19:59.853

只需在锚上添加**disabled**作为类：

```
<a class="dropdown-toggle disabled" href="http://google.com">
    Dropdown <b class="caret"></b></a> 
```

所以所有这些都是这样的：

```
<ul class="nav">
    <li class="dropdown">
        <a class="dropdown-toggle disabled" href="http://google.com">
            Dropdown <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li><a href="#">Link 1</a></li>
            <li><a href="#">Link 2</a></li>
        </ul>
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-01-22T22:41:57.680

由于没有真正有效的答案（选择的答案禁用下拉菜单），或者使用 javascript 覆盖，所以这里是。

这是所有 html 和 css 修复（使用两个`<a>`标签）：

```
<ul class="nav">
 <li class="dropdown dropdown-li">
    <a class="dropdown-link" href="http://google.com">Dropdown</a>
    <a class="dropdown-caret dropdown-toggle"><b class="caret"></b></a>
    <ul class="dropdown-menu">
        <li><a href="#">Link 1</a></li>
        <li><a href="#">Link 2</a></li>
    </ul>
 </li>
</ul> 
```

现在这是您需要的 CSS。

```
.dropdown-li {
    display:inline-block !important;
}
.dropdown-link {
    display:inline-block !important; 
    padding-right:4px !important;
}
.dropdown-caret {
    display:inline-block !important; 
    padding-left:4px !important;
} 
```

假设您希望两个`<a>`标签在悬停任一标签时突出显示，您还需要覆盖引导程序，您可以使用以下方法：

```
.nav > li:hover {
    background-color: #f67a47; /*hover background color*/
}
.nav > li:hover > a {
    color: white; /*hover text color*/
}
.nav > li:hover > ul > a {
    color: black; /*dropdown item text color*/
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-07-04T21:40:25.960

对于那些抱怨“子菜单不下拉”的人，我以这种方式解决了它，这对我来说看起来很干净：

1) 除了你的

```
<a class="dropdown-toggle disabled" href="http://google.com">
     Dropdown <b class="caret"></b>
</a> 
```

放一个新的

```
<a class="dropdown-toggle"><b class="caret"></b></a> 
```

并删除`<b class="caret"></b>`标签，所以它看起来像

```
<a class="dropdown-toggle disabled" href="http://google.com">
Dropdown</a><a class="dropdown-toggle"><b class="caret"></b></a> 
```

2) 使用以下 css 规则为它们设置样式：

```
.caret1 {
    position: absolute !important; top: 0; right: 0;
}

.dropdown-toggle.disabled {
    padding-right: 40px;
} 
```

.caret1 类中的样式用于将其绝对定位在您的`li`, 在右上角。

第二种样式是在下拉列表的右侧添加一些填充以放置插入符号，以防止菜单项的文本重叠。

现在你有一个很好的响应式菜单项，它在桌面和移动版本中看起来都很不错，并且它既可点击又可下拉，具体取决于你是点击文本还是插入符号。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-01-28T21:31:06.993

我不确定使顶级锚元素成为可点击锚的问题，但这是使桌面视图具有悬停效果和保持其可点击性的移动视图的最简单解决方案。

```
// Medium screens and up only
@media only screen and (min-width: $screen-md-min) {
    // Enable menu hover for bootstrap
    // dropdown menus
    .dropdown:hover .dropdown-menu {
        display: block;
    }
} 
```

这样，移动菜单仍然可以正常运行，而桌面菜单将在悬停而不是单击时展开。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-02T17:57:50.030

另一种解决方案是从锚点中删除“下拉切换”类。此点击后将不再触发 dropwon.js，因此您可能希望子菜单在悬停时显示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-29T08:38:49.427

您可以使用 javascript 代码段

```
$(function()
{
    // Enable drop menu clicks
    $(".nav li > a").off();
}); 
```

这将取消绑定单击事件，防止 url 更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-10T20:28:13.740

这是一个根据屏幕宽度从数据悬停切换到数据切换的小技巧：

```
/**
 * Bootstrap nav menu hack
 */
$(window).on('load', function () {
    // On page load
    if ($(window).width() < 768) {
        $('.navbar-nav > li > .dropdown-toggle').removeAttr('data-hover').attr('data-toggle', 'dropdown');
    }

    // On window resize
    $(window).resize(function () {
        if ($(window).width() < 768) {
            $('.navbar-nav > li > .dropdown-toggle').removeAttr('data-hover').attr('data-toggle', 'dropdown');
        } else {
            $('.navbar-nav > li > .dropdown-toggle').removeAttr('data-toggle').attr('data-hover', 'dropdown');
        }
    });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-25T15:52:23.933

这可以通过添加两个链接来更简单地完成，一个带有文本和 href，一个带有下拉列表和插入符号：

```
<a href="{{route('posts.index')}}">Posts</a>
<a href="{{route('posts.index')}}" class="dropdown-toggle" data-toggle="dropdown" role="link" aria-haspopup="true" aria- expanded="false"></a>
<ul class="dropdown-menu navbar-inverse bg-inverse">
    <li><a href="{{route('posts.create')}}">Create</a></li>
</ul> 
```

现在您单击插入符号作为下拉菜单和链接作为链接。不需要css或js。我使用**Bootstrap 4 4.0.0-alpha.6**，不需要定义插入符号，它看起来没有 html。

# mysql - 将 sqlite 表导入 mySQL 数据库

> ID：12630193
> 
> 赞同：0
> 
> 时间：2012-09-27T21:20:12.737
> 
> 标签：mysql, database, sqlite

我正在尝试将数据从 sqlite 中的表导入到 mysql 表中：

U 将 sqlite 表导出为 csv 文件。将 csv 文件导入 mysql 表时，出现以下错误：

```
#1366 - Incorrect integer value: 'IDAPPRECIATIONL' for column 'idAppreciation' at row 1 
```

`IDAPPRECIATION`是 sqlite 数据库的列，idAppreciation 是 mysql 表的列，它们都是自增的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:10:30.823

CSV 文件中的第一行可能是 sqlite 表中的列名。不带列名导出或删除第一行。或者在导入期间，如果您可以选择跳过第一行。

# salesforce - Salesforce.com 的 Winter '13 版本是否更改/中断了 Set.contains() 方法？

> ID：12630197
> 
> 赞同：2
> 
> 时间：2012-09-27T21:20:30.657
> 
> 标签：salesforce, apex-code

我们将沙箱升级到 Winter '13，但我们的生产环境仍在旧版本上。以下代码在我们的沙箱上打印“false”，但在生产环境中打印“true”。我似乎在网上找不到提到这一点，但看起来它们的工作方式不同！

```
Set<Id> x = new Set<Id>{
     '012A0000000qv2wIAA'
    ,'012A0000000qv2xIAA'
    ,'012A0000000qv2yIAA'
    ,'012A0000000qv2zIAA'
};

System.debug(x.contains('012A0000000qv2z')); 
```

请注意，Set 包含 18 个字符的 ID，我们询问它是否 .contains() 一个 15 个字符的 ID。我不介意它以一种或另一种方式工作。只是奇怪的是它的行为不同。

* * *

编辑：刚刚注意到，如果我将字符串显式转换为 ID，则行为在不同环境中变得一致：

```
System.debug(x.contains((Id)('012A0000000qv2z'))); 
```

那么也许 Apex 改变了新版本中的类型提升规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:07:31.957

我看了一下这个。这是对 Apex 中 Set 的新实现中的类型操作逻辑的无意更改（新的 impl 支持用户定义的类型，万岁！）。我已经提交了一个错误，我们将在未来的补丁中解决这个问题（我不能就何时做出承诺）。感谢您指出这个问题并给出如此简洁的重现。

格雷格费

# javascript - 如何使 document.write 从左上角写入？

> ID：12630198
> 
> 赞同：0
> 
> 时间：2012-09-27T21:20:30.127
> 
> 标签：javascript, html, css, twig

这是我的模板文件：

```
{% extends '::base.html.twig' %}

{% block title %}Quote Metadata{% endblock %}

{% block css_js %}
    <link href="{{ asset('bundles/acmequotes/css/bootstrap.css') }}" type="text/css" rel="stylesheet" /> 
{% endblock %}

{% block body %}
    <div class="metadata"> 
    <script>
        var obj = {{ data|raw }};
        document.write(JSON.stringify(obj, null, 4));
    </script>
    </div>

{% endblock %} 
```

和**base.html.twig**：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>{% block title %}Welcome!{% endblock %}</title>
        {% block css_js %}{% endblock %}
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
    </head>
    <body>
        {% block body %}{% endblock %}
    </body>
</html> 
```

这是在我的 CSS 中：

```
.metadata {
        white-space: pre-wrap; 
} 
```

这是我得到的 html，当我从浏览器中看到我的页面代码时：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Quote Metadata</title>
            <link href="/my-quotes/web/bundles/acmequotes/css/bootstrap.css" type="text/css" rel="stylesheet" /> 
        <link rel="icon" type="image/x-icon" href="/my-quotes/web/favicon.ico" />
    </head>
    <body>
    <div class="metadata"> 
    <script>
        var obj = {"hello":"world", "Test":["hello"]};
        document.write(JSON.stringify(obj, null, 4));   
    </script>
    </div>
</body>
</html> 
```

这是输出：[http ://s18.postimage.org/ebcuii3i1/hello.jpg](http://s18.postimage.org/ebcuii3i1/hello.jpg)

我要更改的是第一个`" { "`显示在左上角，而不是按原样显示 - 有点下，有点在右边。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:25:21.967

你为什么使用 document.write？您正在使用标签和缩进引入额外的空白字符。

```
<div id="output" class="metadata"></div>
<script>
    var obj = {"hello":"world", "Test":["hello"]};
    document.getElementById("output").innerHTML = JSON.stringify(obj, null, 4);   
</script> 
```

另外你为什么不使用pre？

埃里克

# c# - Mvc ActionResult 没有在 Post 请求中传回对象

> ID：12630203
> 
> 赞同：0
> 
> 时间：2012-09-27T21:21:10.030
> 
> 标签：c#, asp.net-mvc, model-view-controller

传回表单时，我的电阻器工作得很好，但是我构建的电阻器没有传回任何东西。我不确定我在做什么与 Visual Studio 提供的注册页面不同。它调用正确的 http post 方法，但传递的值为 null。谢谢你的帮助。我只是希望该模型回发到控制器操作结果。

控制器

```
[HttpGet]
        public ActionResult Support()
        {
            ViewBag.Message = "Your app description page.";

            return View();
        }
          [AllowAnonymous]
        [HttpPost, ValidateSpamPrevention]
        public ActionResult Support(QuickEmailModel email)
        {
            if (ModelState.IsValid)
            {
                 return View("thankyou", email);
            }
            return View(email);

        } 
```

模型

```
public class QuickEmailModel
{
    [DataType(DataType.EmailAddress)]
    [EmailAddress]
    public string Email { get; set; }

    [Required]
    public string Subject { get; set; }

    [Required]
    [DataType(DataType.MultilineText)]
    public string Description { get; set; }

    [Display(Name = "Company (Optional):")]
    public string Company { get; set; }
} 
```

}

视图顶部

```
@using PoliteCaptcha
@model Models.QuickEmailModel
@{
    ViewBag.Title = "Support";
} 
```

表格所在的底部

```
 @using (Html.BeginForm())
                {
                    @Html.ValidationSummary()
                    <div class="control-group">
                        <label class="control-label">
                            @Html.LabelFor(x => x.Company, "Company (Optional):", new { @class = "control-label" })</label>
                        <div class="controls">
                            @Html.TextBoxFor(x => x.Company, new { @class = "span4" })
                        </div>
                    </div>
                    <div class="control-group">
                        @Html.LabelFor(x => x.Email, "Email:", new { @class = "control-label" })
                        <div class="controls">
                            @Html.TextBoxFor(x => x.Email, new { @Class = "span4" })
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            @Html.LabelFor(x => x.Subject, "Subject:", new { @class = "control-label" })</label>
                        <div class="controls">
                            @Html.TextBoxFor(x => x.Subject, new { @class = "span4" })
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            @Html.LabelFor(x => x.Subject, "Description:", new { @class = "control-label" })</label>
                        <div class="controls">
                            @Html.TextAreaFor(x => x.Description, new { @class = "span4", @rows = "6", id = "txtDescription" })
                        </div>
                    </div>
                    @Html.SpamPreventionFields()
                    <input type="submit" class="btn btn-success" id="btnSubmit" value="Submit" style="margin-right: 15em;
                        float: right;" />
                } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:01:33.470

我认为问题在于您的参数名称与您的字段名称之一（电子邮件）相同。将方法参数名称重命名为模型（或电子邮件以外的其他名称）。

我认为正在发生的事情是 MVC 模型绑定器看到一个名为“email”的发布值，它试图将其分配给同名的参数，但由于它不是一个字符串，所以它不能这样做。因此它分配一个空值。

此外，模型绑定不区分大小写，因此电子邮件和电子邮件是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:46:01.680

问题是模型映射器无法将表单名称/值对从 POST 请求映射到 QuickEmailModel 对象的实例，而只是忽略它们。检查在 Firebug 或其他工具中发送的 POST 请求，名称/值对的名称是什么？

您可能应该像这样更改您的视图：

```
@{ var email = ....; }

<label class="control-label">
    @Html.LabelFor(x => email.Company, "Company (Optional):", new { @class = "control-label" })
</label>
<div class="controls">
    @Html.TextBoxFor(x => email.Company, new { @class = "span4" })
</div> 
```

因为您的 POST 操作参数的名称是“电子邮件”。我认为这应该强制表单参数名称为“email.Company”等。如果不是，请尝试其他变体

```
@Html.TextBox("email.Company", model.Company) 
```

# javascript - Angularjs通过字符串名称将提供程序注入模块工厂函数以进行缩小

> ID：12630204
> 
> 赞同：20
> 
> 时间：2012-09-27T21:21:27.833
> 
> 标签：javascript, angularjs

我有以下代码：

```
appModule = angular.module('appModule', []);

appModule.factory('sharedApplication', function($rootScope, $http) {
  var sharedApp;
  sharedApp = {};
  sharedApp.currentView = "home-section";
  sharedApp.pastEvents = null;
  $http.get('api/highlights').success(function(response) {
    return sharedApp.pastEvents = response.data;
  });
  return sharedApp;
}); 
```

在我尝试缩小我的 javascript 然后我得到之前，这段代码可以正常工作并且符合预期

```
 Error: Unknown provider: eProvider <- e 
```

这是因为我的工厂函数中的 $http 参数已重命名为 'e' 以用于缩小目的。那么如何手动通知 appModule 注入什么名称以避免缩小破坏我的代码呢？

提前致谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-27T21:56:30.590

尝试

```
appModule.factory('sharedApplication', ['$rootScope','$http',function($rootScope, $http) {

}]); 
```

问候

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-09T20:43:42.213

[ng-annotate](https://github.com/olov/ng-annotate)也是一个很好的库，可以自动注入所需的依赖项。你应该检查一下。

代码示例：

```
/* ngInject */
appModule.factory('sharedApplication', function($rootScope, $http) {
  var sharedApp;
  sharedApp = {};
  sharedApp.currentView = "home-section";
  sharedApp.pastEvents = null;
  $http.get('api/highlights').success(function(response) {
    return sharedApp.pastEvents = response.data;
  });
  return sharedApp;
}); 
```

然后你不必写：

```
appModule.factory('sharedApplication', ['$rootScope','$http', 
function($rootScope, $http) {
 var sharedApp;
 sharedApp = {};
 sharedApp.currentView = "home-section";
 sharedApp.pastEvents = null;
 $http.get('api/highlights').success(function(response) {
 return sharedApp.pastEvents = response.data;
});

return sharedApp;
}]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-03T05:35:35.357

更优雅、更易于阅读的方法：

```
appModule.factory('myFactory', myFactory);

myFactory.$inject = ['$rootScope','$http'];
function myFactory($rootScope, $http) {
    ...
} 
```

# c# - 如何在 C# Windows Store 应用程序中获取新的默认 WebProxy 对象？

> ID：12630205
> 
> 赞同：8
> 
> 时间：2012-09-27T21:21:27.240
> 
> 标签：c#, windows-8, windows-runtime, webproxy

我的问题来自我在公司网络上发现的一个问题。我正在使用 Windows 8 进行开发，因此在我的情况下，IE10 设置为自动检测代理设置。

在我的 C# 应用程序中，我使用 System.Net.Http.HttpClient。我发现如果我脱机、发出失败的请求然后重新联机，整个过程的默认 IWebProxy 对象将变得不可用。提出失败的请求很重要，否则没有问题。这是我如何处理这个脆弱的代理对象的示例。

```
var defaultHandler = new HttpClientHandler();
var fragileProxy = defaultHandler.Proxy;
var httpClient = new HttpClient(defaultHandler); 
```

经过一些实验，我发现我可以通过调用 System.Net.WebProxy.GetDefaultProxy(); 来获得一个工作代理；

然后我实现了一个 NetworkChangAwareProxy : IWebProxy。没错，就是我的 IWebProxy 的代理。在内部，它只是在 NetworkChange.NetworkAddressChanged 时获取一个新的 WebProxy.GetDefaultProxy()。

当应用程序启动并且问题消失时，我将其连接起来。

```
WebRequest.DefaultWebProxy =  new NetworkChangeAwareProxy(); 
```

希望有人会告诉我有更好的方法来解决这个问题。我的具体问题是关于应用商店风格的应用程序。（地铁应用）

System.Net.WebProxy.GetDefaultProxy() 不可用，并且 System.Net.HttpWebRequest.DefaultWebProxy 只是在离线和回来后返回相同的失效代理。

如何在 C# Windows Store 应用程序中获取新 IWebProxy 对象的句柄？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T16:54:38.050

System.Net.WebProxy.GetDefaultProxy() 至少从 .net 3 开始已被弃用，请改用 System.Net.WebRequest.GetSystemWebProxy()。对于 WinRT，他们删除了许多不推荐使用的方法。

请参阅[http://msdn.microsoft.com/en-us/library/system.net.webproxy.getdefaultproxy.aspx](http://msdn.microsoft.com/en-us/library/system.net.webproxy.getdefaultproxy.aspx) 和[http://msdn.microsoft.com/en-us/library/system.net.webrequest.getsystemwebproxy .aspx](http://msdn.microsoft.com/en-us/library/system.net.webrequest.getsystemwebproxy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T19:45:04.197

您可以使用网络请求来获取代理：

```
var req = WebRequest.Create(@"api/stat/stats/");
req.Proxy = WebRequest.GetSystemWebProxy();
req.Timeout = 10000;
req.Method = "GET"; 
```

# html - 如何使用 Perl Text-MediawikiFormat 将 mediawiki 转换为 xhtml？

> ID：12630206
> 
> 赞同：2
> 
> 时间：2012-09-27T21:21:28.343
> 
> 标签：html, perl, converter, mediawiki, wikitext

在 Ubuntu 平台上，我安装了漂亮的小 perl 脚本

```
libtext-mediawikiformat-perl - Convert Mediawiki markup into other text formats 
```

[在 cpan](http://search.cpan.org/~dprice/Text-MediawikiFormat-0.05/lib/Text/MediawikiFormat.pm)上可用。我不熟悉 perl，也不知道如何使用这个库来编写一个将 mediawiki 文件转换为 html 文件的 perl 脚本。例如，我只想有一个可以运行的脚本，例如

```
./my_convert_script input.wiki > output.html 
```

（也许还指定基本 url 等），但不知道从哪里开始。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T00:57:39.863

我相信@amon 是正确的，我在问题中引用的 perl 库不是我提出的任务的正确工具。

我最终使用[mediawiki API和 action="parse" 使用 mediawiki 引擎转换为 HTML，结果证明它比我尝试](http://www.openwetware.org/api.php)[在列表中提出的](http://www.mediawiki.org/wiki/Alternative_parsers)任何替代解析器更可靠。（然后我使用 pandoc 将我的 html 转换为 markdown。） mediawiki API 也处理类别和其他元数据的提取，我只需将基本 url 附加到内部图像和页面链接。

给定页面标题和基本 url，我最终将其编写为 R 函数。

```
wiki_parse <- function(page, baseurl, format="json", ...){
  require(httr)
  action = "parse"
  addr <- paste(baseurl, "/api.php?format=", format, "&action=", action, "&page=", page, sep="")
  config <- c(add_headers("User-Agent" = "rwiki"), ...)
  out <- GET(addr, config=config)
  parsed_content(out)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:05:40.117

Perl 库`Text::MediawikiFormat`并不是真正为独立使用而设计的，而是作为更大应用程序中的格式化引擎。

[CPAN](http://search.cpan.org/~dprice/Text-MediawikiFormat-v1.0/lib/Text/MediawikiFormat.pm)的文档确实展示了如何使用这个库的方法，并且确实注意到其他模块可能为一次性转换提供更好的支持。

你可以试试这个（未经测试的）单线

```
perl -MText::MediawikiFormat -e'$/=undef; print Text::MediawikiFormat::format(<>)' input.wiki >output.html 
```

尽管这违背了该模块的全部要点（和定制能力）。

我确信有人已经想出了一个更好的方法来转换单个 MediaWiki 文件，所以这里是mediawiki 网站上[的替代 MediaWiki 处理器列表。](http://www.mediawiki.org/wiki/Alternative_parsers)这个[SO question](https://stackoverflow.com/q/9343931/1521179)也可以提供帮助。

其他标记语言，例如[Markdown](http://daringfireball.net/projects/markdown/)为单文件转换提供了更好的支持。Markdown 特别适合技术文档和反映电子邮件约定。（此外，它在本网站上使用。）

* * *

Ubuntu 存储库中的`libfoo-bar-perl`软件包是预编译的 Perl 模块。通常，这些将通过`cpan`或安装`cpanm`。虽然其中一些库确实包含脚本，但大多数不包含，也不意味着作为独立应用程序。

# c - 修改栈上的返回地址

> ID：12630213
> 
> 赞同：7
> 
> 时间：2012-09-27T21:22:32.370
> 
> 标签：c, assembly, stack, buffer-overflow

我查看了缓冲区溢出漏洞的基础知识，并试图了解堆栈是如何工作的。为此，我想编写一个简单的程序，将返回地址的地址更改为某个值。任何人都可以帮我弄清楚基指针的大小以从第一个参数中获取偏移量吗？

```
void foo(void)
{
    char ret;
    char *ptr;

    ptr = &ret; //add some offset value here 
    *ptr = 0x00;
}

int main(int argc, char **argv)
{
    foo();

    return 1;
} 
```

生成的汇编代码如下所示：

```
 .file   "test.c"
    .text
    .globl  foo 
    .type   foo, @function
foo:
.LFB0:
    .cfi_startproc
    pushq   %rbp
    .cfi_def_cfa_offset 16
    .cfi_offset 6, -16 
    movq    %rsp, %rbp
    .cfi_def_cfa_register 6
    leaq    -9(%rbp), %rax
    movq    %rax, -8(%rbp)
    movq    -8(%rbp), %rax
    movb    $0, (%rax)
    popq    %rbp
    .cfi_def_cfa 7, 8
    ret 
    .cfi_endproc
.LFE0:
    .size   foo, .-foo
    .globl  main
    .type   main, @function
main:
.LFB1:
    .cfi_startproc
    pushq   %rbp
    .cfi_def_cfa_offset 16
    .cfi_offset 6, -16 
    movq    %rsp, %rbp
    .cfi_def_cfa_register 6
    subq    $16, %rsp
    movl    %edi, -4(%rbp)
    movq    %rsi, -16(%rbp)
    call    foo 
    movl    $1, %eax
    leave
    .cfi_def_cfa 7, 8
    ret 
    .cfi_endproc
.LFE1:
    .size   main, .-main
    .ident  "GCC: (GNU) 4.7.1 20120721 (prerelease)"
    .section    .note.GNU-stack,"",@progbits 
```

foo 帧段的相关部分应如下所示：

[char ret] [基指针] [返回地址]

我有第一个的位置，它的大小只有 1 个字节。[它是否仅比基本指针更远 1 个字节或http://insecure.org/stf/smashstack.html](http://insecure.org/stf/smashstack.html)中提到的单词大小？我如何知道基指针的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:47:05.377

您将无法在 vanilla C 中执行此操作，您无法控制编译器如何布置堆栈帧。

在 x86-64 中，返回地址应为`%rbp + 8`. 您可以使用一些内联程序集来获得它（gcc 语法）：

```
uint64_t returnaddr;
asm("mov 8(%%rbp),%0" : "=r"(returnaddr) : : ); 
```

同样设置它。

即使这样也有点粗略，因为您不知道编译器是否会设置`%rbp`。YMMV。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:43:42.267

您的基指针很可能只是一个指针，因此它的大小为 sizeof(int*)。`ret`但是在您的变量和基指针之间还有另一个值。我会假设它的值是一个寄存器（eax？）。如果您想要一个无限循环，这将导致类似以下内容：

```
void foo(void)
{
    char ret;
    char *ptr;

    ptr = (char*)(&ret) + (sizeof(ret)  + 2*sizeof(int*)) ;
    *(int*)ptr -= 0x0c;
} 
```

假设它具有指针的大小（对于其他指令集可能不同）而修改的返回目标。通过递减它，返回目标被设置为调用点之前的一个点`foo`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:45:31.090

看来您使用的是 64 位架构，因为 RBP 和 RSP 寄存器是 64 位长的。如果您声明`ptr`为`char*`，则必须将其递增 8 次才能在堆栈中移动。相反，您可以将其声明为`uint64_t *`. 这种数据类型通常在`<stdint.h>`.

但是，堆栈帧定义取决于目标体系结构，甚至取决于编译器行为和优化。不过，如果您正在尝试，那很好。

# linux-kernel - 上下文切换内部

> ID：12630214
> 
> 赞同：76
> 
> 时间：2012-09-27T21:22:35.510
> 
> 标签：linux-kernel, kernel, scheduler, context-switch

我想在这个问题的帮助下学习并填补我的知识空白。

因此，用户正在运行一个线程（内核级），它现在调用`yield`（我认为是系统调用）。调度程序现在必须将当前线程的上下文保存在 TCB 中（存储在内核中的某处）并选择另一个线程来运行并加载其上下文并跳转到其`CS:EIP`. 为了缩小范围，我正在研究运行在 x86 架构之上的 Linux。现在，我想进入细节：

所以，首先我们有一个系统调用：

1) 包装函数`yield`将系统调用参数压入堆栈。推送返回地址并使用推送到某个寄存器（例如`EAX`）的系统调用号引发中断。

2）中断将CPU模式从用户更改为内核，并跳转到中断向量表，然后从那里跳转到内核中的实际系统调用。

3）我猜调度程序现在被调用，现在它必须将当前状态保存在 TCB 中。这是我的困境。因为，调度程序将使用内核堆栈而不是用户堆栈来执行其操作（这意味着必须更改`SS`和`SP`）它如何在不修改进程中任何寄存器的情况下存储用户状态。我在论坛上读到有用于保存状态的特殊硬件指令，但是调度程序如何访问它们以及谁运行这些指令以及何时运行？

4) 调度程序现在将状态存储到 TCB 并加载另一个 TCB。

5) 当调度器运行原始线程时，控制返回到包装函数，该函数清除堆栈并恢复线程。

附带问题：调度程序是否作为仅内核线程运行（即只能运行内核代码的线程）？每个内核线程或每个进程是否有单独的内核堆栈？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-10-03T05:20:31.167

在高层次上，有两种不同的机制需要理解。第一个是内核进入/退出机制：这会将单个正在运行的线程从运行用户模式代码切换到在该线程的上下文中运行内核代码，然后再返回。第二个是上下文切换机制本身，它在内核模式下从运行在一个线程的上下文中切换到另一个线程。

因此，当线程 A 调用`sched_yield()`并被线程 B 替换时，会发生以下情况：

1.  线程A进入内核，从用户态切换到内核态；
2.  内核上下文中的线程 A 切换到内核中的线程 B；
3.  线程 B 退出内核，从内核模式切换回用户模式。

每个用户线程都有一个用户模式堆栈和一个内核模式堆栈。当一个线程进入内核时，用户态栈`SS:ESP`（由 CPU 自己完成。剩余的寄存器值和标志随后也被保存到内核堆栈中。`CS:EIP``int $80`

当线程从内核返回到用户模式时，寄存器值和标志从内核模式堆栈中弹出，然后用户模式堆栈和指令指针值从内核模式堆栈上保存的值中恢复。

当线程上下文切换时，它会调用调度程序（调度程序不会作为单独的线程运行 - 它始终在当前线程的上下文中运行）。调度程序代码选择下一个要运行的进程，并调用该`switch_to()`函数。这个函数本质上只是切换内核堆栈——它将堆栈指针的当前值保存到当前线程的 TCB 中（`struct task_struct`在 Linux 中调用），并从 TCB 中为下一个线程加载先前保存的堆栈指针。此时，它还保存和恢复内核通常不使用的其他一些线程状态——比如浮点/SSE 寄存器。如果被切换的线程不共享相同的虚拟内存空间（即它们在不同的进程中），页表也会被切换。

所以你可以看到线程的核心用户模式状态在上下文切换时没有保存和恢复——当你进入和离开内核时它被保存和恢复到线程的内核堆栈。上下文切换代码不必担心破坏用户模式寄存器值 - 到那时，这些值已经安全地保存在内核堆栈中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-28T13:33:27.433

您在第 2 步中错过的是堆栈从线程的用户级堆栈（您在其中推送 args）切换到线程的受保护级堆栈。被系统调用中断的线程的当前上下文实际上保存在这个受保护的堆栈上。在 ISR 内部，就在进入内核之前，这个受保护的堆栈再次切换*到*您正在谈论的内核堆栈。一旦进入内核，诸如调度程序函数之类的内核函数最终会使用内核堆栈。稍后，一个线程被调度程序选中，系统返回到 ISR，它从内核堆栈切换回新选出的（如果没有更高优先级的线程处于活动状态，则为前者）线程的受保护级别堆栈，最终包含新的线程上下文。因此，上下文通过代码自动从该堆栈中恢复（取决于底层架构）。最后，一条特殊指令恢复栈指针和指令指针等最新的敏感寄存器。回到用户态...

总而言之，一个线程（通常）有两个堆栈，而内核本身也有一个。内核堆栈在每个内核进入结束时被擦除。有趣的是，从 2.6 开始，内核本身被线程化以进行一些处理，因此内核线程在通用内核堆栈旁边有自己的受保护级别堆栈。

一些资源：

*   *3.3.3***理解Linux内核**的进程切换，O'Reilly
*   ***英特尔手册 3A（系统编程）的**5.12.1*异常或中断处理程序*。章节编号可能因版本而异，因此查找“在传输到中断和异常处理例程中的堆栈使用”应该会让您找到一个好的。*

 *希望这有帮助！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-10-25T11:59:26.150

内核本身根本没有堆栈。过程也是如此。它也没有堆栈。线程只是被视为执行单元的系统公民。因此，只能调度线程，并且只有线程具有堆栈。但是有一点是内核模式代码大量利用的——系统每时每刻都在当前活动线程的上下文中工作。由于这个内核本身可以重用当前活动堆栈的堆栈。请注意，它们中只有一个可以同时执行内核代码或用户代码。因此，当内核被调用时，它只是重用线程堆栈并执行清理，然后将控制权返回给线程中被中断的活动。同样的机制也适用于中断处理程序。信号处理程序利用相同的机制。

线程栈又分为两个独立的部分，一个叫做用户栈（因为它在线程在用户态执行时使用），第二个叫做内核栈（因为它在线程在内核态执行时使用） . 一旦线程越过用户模式和内核模式之间的边界，CPU 会自动将其从一个堆栈切换到另一个堆栈。内核和 CPU 以不同的方式跟踪这两个堆栈。对于内核堆栈，CPU 会永久记住指向该线程的内核堆栈顶部的指针。这很容易，因为这个地址对于线程来说是恒定的。每次线程进入内核时，它都会发现空的内核堆栈，并且每次返回用户模式时，它都会清理内核堆栈。同时，当线程在内核模式下运行时，CPU 不会记住指向用户堆栈顶部的指针。相反，在进入内核期间，CPU 在内核堆栈顶部创建特殊的“中断”堆栈帧，并将用户模式堆栈指针的值存储在该帧中。当线程退出内核时，CPU 在清理之前立即从先前创建的“中断”堆栈帧中恢复 ESP 的值。（在旧版 x86 上，一对指令 int/iret 句柄进入和退出内核模式）

在进入内核模式期间，在 CPU 将创建“中断”堆栈帧后，内核立即将其余 CPU 寄存器的内容推送到内核堆栈。请注意，它仅保存那些可由内核代码使用的寄存器的值。例如，内核不会仅仅因为它永远不会触及它们而保存 SSE 寄存器的内容。同样，在要求 CPU 将控制权返回给用户模式之前，内核将先前保存的内容弹出回寄存器。

请注意，在 Windows 和 Linux 等系统中，存在系统线程的概念（通常称为内核线程，我知道这很容易混淆）。系统线程是一种特殊的线程，因为它们只在内核模式下执行，因此没有堆栈的用户部分。内核将它们用于辅助的内务处理任务。

线程切换仅在内核模式下执行。这意味着传出和传入的线程都在内核模式下运行，都使用自己的内核堆栈，并且都具有内核堆栈具有“中断”帧，其中指针指向用户堆栈的顶部。线程切换的关键点是内核线程栈之间的切换，简单如下：

```
pushad; // save context of outgoing thread on the top of the kernel stack of outgoing thread
; here kernel uses kernel stack of outgoing thread
mov [TCB_of_outgoing_thread], ESP;
mov  ESP , [TCB_of_incoming_thread]    
; here kernel uses kernel stack of incoming thread
popad; // save context of incoming thread from the top of the kernel stack of incoming thread 
```

请注意，内核中只有一个函数执行线程切换。因此，每次内核切换堆栈时，它都可以在堆栈顶部找到传入线程的上下文。只是因为每次在堆栈切换之前，内核都会将传出线程的上下文推送到其堆栈中。

另请注意，每次在堆栈切换之后和返回用户模式之前，内核都会通过内核堆栈顶部的新值重新加载 CPU 的思想。这样做可以确保当新的活动线程将来尝试进入内核时，它会被 CPU 切换到自己的内核堆栈。

另请注意，在线程切换期间并非所有寄存器都保存在堆栈中，一些寄存器如 FPU/MMX/SSE 保存在传出线程的 TCB 中的专用区域中。内核在这里采用不同的策略有两个原因。首先，并非系统中的每个线程都使用它们。为每个线程将它们的内容推送到堆栈并从堆栈中弹出它是低效的。第二个是“快速”保存和加载其内容的特殊说明。而且这些指令不使用堆栈。

另请注意，实际上线程堆栈的内核部分具有固定大小，并作为 TCB 的一部分分配。（适用于 Linux，我也相信适用于 Windows）*

# jquery - highstock 和 json 遇到问题

> ID：12630215
> 
> 赞同：0
> 
> 时间：2012-09-27T21:22:39.360
> 
> 标签：jquery, json, getjson, jsfiddle

这是我目前在 jsfiddle 中的代码

[http://jsfiddle.net/syleron/5MyXp/](http://jsfiddle.net/syleron/5MyXp/)

如果有人可以帮助我用正确的数据实际显示图表，那就太棒了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T23:16:10.170

男生！你的小提琴有很多问题。第一个，正如 Mark 指出的那样，您在 Mootools 中链接，而不是 jQuery。然后，一旦解决了这个问题，AJAX 调用就会失败，因为它是一个跨域请求，正如 Mark 还指出的那样。

为了让您的小提琴正常工作，我直接从您的源获取 JSON 数据，并将其放入变量中以避免跨域请求。但它仍然没有工作！

事实证明，问题在于您的数据有下降的时间，显然 Highstock 无法处理。当时的解决方案很简单。在您填充系列的循环中，而不是计数：

```
for (i = 0; i < dataLength; i++) { 
```

我只是将其更改为倒数：

```
for (i = dataLength-1; i > 0; i--) { 
```

这解决了问题。这是一个有效的 jsFiddle：http: [//jsfiddle.net/gV9xC/](http://jsfiddle.net/gV9xC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:43:22.557

您正在发出跨域请求，以允许您需要通过提供回调将请求作为 jsonp 发出。

添加`&callback=?`到您的网址的末尾。但是，这不会修复您的 jsfiddle 演示，因为您需要使用 jsfiddle 模拟 ajax 请求。他们有一个 API 文档。

# java - Netbeans 7.2 无法在 OS X 上打开

> ID：12630218
> 
> 赞同：3
> 
> 时间：2012-09-27T21:22:43.477
> 
> 标签：java, osx-lion, netbeans-7

我在运行 JDK 7 的 OSX Mountain Lion 上安装了 Netbeans。一切正常。然后我的机器无缘无故崩溃了。在此之后，我再也无法打开 Netbeans。

如果我尝试从命令行启动 Netbeans：

```
/Applications/NetBeans/NetBeans 7.2.app/Contents/MacOS/netbeans 
```

然后它工作正常。从那里我可以选择 Netbeans > About 并确认我的 userdir 和 cachedir 是：

```
User directory: /Users/<user>/Library/Application Support/NetBeans/7.2
Cache directory: /Users/<user>/Library/Caches/NetBeans/7.2 
```

所以，我删除了这些目录并再次尝试，但是，我只能通过命令行启动 netbeans。

想法赞赏...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T16:24:17.213

在我看来，这根本不是 NetBeans 问题，而是捆绑包的问题，​​以至于 OS X 没有按应有的方式启动应用程序。

为了验证，我会尝试*从命令行通过 Finder*打开 NetBeans ：

`open -a "NetBeans 7.2.app"`

此命令将要求系统启动器打开应用程序，就像您单击了图标一样。在你的情况下，它可能不会打开。如果这是真的，那么您知道不是您的终端*环境*中允许 NetBeans 启动。

我将采取的下一步是查看包内容：检查`/Applications/NetBeans/NetBeans 7.2.app/Contents/Info.plist`任何似乎有问题的东西 - 这个文件是 OS X 查找的信息存储，以查看如何启动包、它的图标是什么等。 . - 特别是，我认为您应该查看该`CFBundleExecutable`值以查看用于启动应用程序的命令。如果不是`netbeans`，您已经发现了一个可能有问题的重要提示：设置了捆绑包，以便启动器应该运行`bundle_dir.app/Contents/{platform}/{CFBundleExecutable_value}`。查看 CFBundleExecutable 应该会告诉您是否还有其他脚本用于启动应用程序，而不仅仅是 running `netbeans`。

从这一点开始，您将不得不做更多的挖掘工作，但希望这些信息足以让您开始跟踪应用程序是如何从 OS X 启动器启动的。有关更多信息和更好的参考，请查看[此链接](https://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html)，这是 Apple 的`Info.plist`.

最后，您应该注意所有应用程序的启动信息都被大量缓存；我听说如果您对 Info.plist 进行更改，您必须重命名应用程序包并将其重新命名，以便启动器拾取更改。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:25:29.780

这是一个想法：使用 Eclipse >=)

..但严重的是，Netbeans 的元数据/缓存数据文件中的某些内容已损坏。您清除了其中的几个，但其他地方可能还有其他。

尝试将快捷方式中的启动命令与您在控制台中输入的内容进行比较。他们是一样的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T21:27:33.357

要找到根本原因，我会检查 NetBeans 日志，详细信息请参见[此处](http://wiki.netbeans.org/FaqLogMessagesFile)

> /Users/yourname/Library/Application Support/NetBeans/7.2/var/log/messages.log

* * *

如果这没有帮助，我会将您的项目存档并在您的计算机上安装干净的 NetBeans，然后将存档的项目重新导入 NetBeans。

# ant - 蚂蚁宏定义中的错误

> ID：12630219
> 
> 赞同：1
> 
> 时间：2012-09-27T21:22:50.213
> 
> 标签：ant

我在以下 ant 宏定义定义中有一个错误：

```
 <macrodef name="xxx" description="does xxx">
    <attribute name="attr1" default=""/>
    <sequential>
      <echo message="doing yyy"/>
      <echo message="@{attr1}" file="${builddir}/zzz.xml"/>
      <taskdef name="xmltask" classname="com.oopsconsultancy.xmltask.ant.XmlTask"/>
      <xmltask report="true" source="${builddir}/zzz.xml">
        <call path="spuds" target="process-spuds">
          <param name="spud-kicker" path="@count"/>
        </call>
      </xmltask>
    </sequential>
  </macrodef> 
```

当它试图在 xmltask 中调用调用的目标时，我得到一个空指针异常。

我究竟做错了什么？

文件 zzz.xml 包含（假定）格式良好的 xml。它包含一个名为“spuds”的顶级标签，其中包含一个名为 count 的属性。我想在 spuds 标签上调用 spud-kicker ant 目标并将 count 属性的值传递给该任务。

# html - 子 div 放置在带有图像的父 div 的顶部

> ID：12630220
> 
> 赞同：0
> 
> 时间：2012-09-27T21:22:53.543
> 
> 标签：html, css

我正在尝试将子 div 放在其父 div 的顶部（包括其内容）

```
<div id="footer">
  <div id="footer-container">
    <div id="icon"></div>                    
  </div>    
</div>​

#footer {
    height:50px;
    border-top:3px #666 solid;
    margin-top:50px;
}

#footer-container {
    height: 30px;
    width: 300px;
    margin-left: auto;
    margin-right: auto;
    margin-top: -15px;   
}

#icon {
    height:30px;
    width:30px;
    background-color:#666;

}​ 
```

现在，如果内容`<div id="icon">`是文本，它可以工作，但如果你在 div 中放置背景图像，它不会。有什么办法可以使这项工作？这也许可以更好地解释它 [http://jsfiddle.net/4QxL7/](http://jsfiddle.net/4QxL7/)

编辑道歉。它一直在工作。我将PNG用于中间有“空白”的图像，这使得父div中的边框（相同颜色）看起来像是越过了孩子的顶部，实际上它是落后。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:36:48.817

我刚刚尝试了两种方法，它们都使用了我网站上的超大图像......

```
<div id="footer">
        <div id="footer-container">
            <div id="icon"><img src="image url here" width=30 height=30/></div>                    
        </div>    
    </div>​ 
```

[http://jsfiddle.net/ZkxSM/](http://jsfiddle.net/ZkxSM/)

和

```
#icon {
    height:30px;
    width:30px;
    background-color:#666; /*unnecessary now probably...*/
    background:url('image url here');
}​ 
```

[http://jsfiddle.net/b6QyX/](http://jsfiddle.net/b6QyX/)（图像需要事先调整大小才能正常工作……或者可以在 div 的 html 中设置宽度和高度）

您的jsfiddle实际上没有任何问题..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:45:21.380

道歉。它一直在工作。我对中间有“空白”的图像使用PNG，这使得父div中的边框（颜色相同）看起来像是越过了孩子的顶部，实际上它是落后。

谢谢你的帮助

# css - IE8 修复 background-size 属性？视网膜图像

> ID：12630221
> 
> 赞同：14
> 
> 时间：2012-09-27T21:22:58.937
> 
> 标签：css, internet-explorer-8, background, retina-display

我正在为 Retina 图像使用以下 CSS，它在 FF、Chrome、Safari 中完美运行，但在 IE 中却**不行。**

IE 是否有使用 background-size 的修复 - 如果是这样，我如何使用我当前的代码来实现它？

**CSS：**

```
.arrow-big-right {
    display: block;
    width: 42px;
    height: 48px;
    margin-bottom: 1.8em;
    background-image: url(arrow-big-right.png);
    background-repeat: no-repeat;
    background-size: 42px 48px;
} 
```

**HTML**

```
<div class="arrow-big-right"></div> 
```

有人可以解释我如何为 IE 解决这个问题吗？

非常感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-27T21:31:21.477

IE8 及以下版本根本[不支持`background-size`](http://caniuse.com/#search=background-size)，因此您要么必须使用自 IE5.5 起就支持的[AlphaImageLoader 过滤器：](http://msdn.microsoft.com/en-us/library/ms532969%28v=vs.85%29.aspx)

```
.arrow-big-right {
    display: block;
    width: 42px;
    height: 48px;
    margin-bottom: 1.8em;
    background-image: url(arrow-big-right.png);
    background-repeat: no-repeat;
    background-size: 42px 48px;
    filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src='arrow-big-right.png', sizingMethod='scale');
    -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader( src='arrow-big-right.png', sizingMethod='scale')";
} 
```

或者使用某种[通过 CSS 定位 IE 版本](https://github.com/h5bp/html5-boilerplate/blob/ce7c3c5c1595ddc42ca3b961179a0cf85aa714be/index.html#L2)的方法，为 IE8 及以下用户的背景应用替代方案。

同样值得注意的是，[正如马特麦克唐纳所指出的](https://stackoverflow.com/questions/12630221/ie8-fix-for-background-size-property-retina-image/12630314?#comment-23024739)，由于使用这种技术，您可能会看到两张图像。这是由于 IE 过滤器在标准背景图像之外添加了背景图像，而不是替换标准背景图像。[要解决此问题，请使用您喜欢的方法（这是我个人最喜欢的方法](http://www.paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)）通过 css 定位 IE ，并删除`background-image`IE8 及以下版本的标准。

使用 Paul Irish[博客文章](http://www.paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)中的第一种技术来执行此操作，您可以使用以下内容：

```
.arrow-big-right {
    display: block;
    width: 42px;
    height: 48px;
    margin-bottom: 1.8em;
    background-image: url(arrow-big-right.png);
    background-repeat: no-repeat;
    background-size: 42px 48px;
    filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src='arrow-big-right.png', sizingMethod='scale');
    -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader( src='arrow-big-right.png', sizingMethod='scale')";
}

.ie6 .arrow-big-right, 
.ie7 .arrow-big-right, 
.ie8 .arrow-big-right {
    background-image: none;
} 
```

# python - 使用 Python 和 Flask 返回 API 错误消息

> ID：12630224
> 
> 赞同：52
> 
> 时间：2012-09-27T21:23:07.937
> 
> 标签：python, api, error-handling, flask

我正在使用 Python 和 Flask 设计一个 RESTful API。正如预期的那样，如果一切顺利，API 需要接收 API 请求并返回数据，但在出现错误的情况下，它需要软失败并返回正确的错误。当出现错误时，我通常会引发异常，但在这种情况下，我需要将错误消息返回给用户（try-catch 块？）。

我目前处理错误的方式是让我的函数返回数据和错误，并检查每个级别的数据，最后将数据或错误返回给 API 函数的调用者。

这样做的问题是，当有多个级别的函数调用时，它会变得很麻烦，需要我的函数多次传递数据和错误，并且每次都执行检查。

有一个更好的方法吗？我可以进行哪些改进以使错误传播更加简单和优雅？

这是我当前返回错误的方式示例：

```
def get_data()
    data1, error = get_some_data() # function not shown
    if data1 is None:
         return None, "could not retrieve data1"
    data2, error = get_some_other_data() # function not shown
    if data2 is None:
         return None, "could not retrieve data2"
    return (data1, data2), None

@app.route("/api/method", methods=['GET'])
def method():
    data, error = get_data()
    if data is None:
        if error is None:
            error = "unknown error"
        return json.dumps({ "error": error }), 500
    return json.dumps({ "data": data }), 200 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-27T21:43:55.687

您可以使用[`abort(http_code)`](http://flask.pocoo.org/docs/api/#flask.abort)向客户端返回适当的 http 代码或仅引发非 http 异常。并使用`@app.errorhandler()`装饰器为 http 错误和任意异常提供自定义处理程序。您还可以在准备好处理异常的地方使用普通的 try/except 块。Python 不是 Go，你可以使用异常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-21T07:02:12.577

也许[Flask API](http://www.flaskapi.org/)更适合您的需求，因为它是专为 RESTful API 设计的。

它比 Flask 有更好的异常处理，见：[http ://www.flaskapi.org/api-guide/exceptions/](http://www.flaskapi.org/api-guide/exceptions/)

# clojure - 将数据传递给黑色视图 - Clojure

> ID：12630226
> 
> 赞同：4
> 
> 时间：2012-09-27T21:23:39.357
> 
> 标签：clojure, compojure, noir

我正在与[Noir](http://www.webnoir.org/)合作，但我不知道如何将信息传递给`views`. 现在我有一个`ref`在`proj.core/my-ref`工作线程中更新的其中。我需要`ref`从`defpage`位于创建的视图中访问 的值`proj.views.my-view`。

分享这个的惯用方式是`ref`什么？我正在考虑以某种方式将其传递给闭包，但我不知道这将如何与 noir 拉入视图的方式一起工作

### IE

```
(noir.server/load-views-ns 'proj.views) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T12:11:57.570

将 ref 移动到它自己的命名空间，然后在 proj.views 中只需要 proj.core，例如：

```
(ns proj.views
 (:require proj.model))

(defpage "/foo" [] (@proj.model/my-ref) 
```

# asp.net - 在中继器内打开/关闭数据库连接

> ID：12630227
> 
> 赞同：0
> 
> 时间：2012-09-27T21:23:45.337
> 
> 标签：asp.net, vb.net, repeater

我有一个中继器，它在每次迭代中从多个表中获取数据。现在我一进入 OnItemDataBound 事件就打开连接并在事件完成之前关闭它。这意味着在我的情况下，连接打开和关闭超过 1000 次。这是正确的方法吗？还有其他方法吗？

我的代码基本上是这样的

```
 Protected Sub myRepeater_OnItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs)
    Try
        mycon.open()
        Dim RowView As DataRowView = e.Item.DataItem

        //fetch data from 5 different tables using the data from the datasource (dataset)

        mycon.close()
    Catch ex As Exception

    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:28:48.217

实际上，在尽可能小的范围内立即打开/关闭连接是一种很好的做法，因为在使用连接池时不会阻塞物理连接。当您关闭它时，您只是使连接可用。

但除此之外，您为什么要使用在转发器已经数据绑定**之后**`ItemDataBound`引发的连接？应该包含您需要的所有内容。如果您想要子控件，例如 DropDownLists 或嵌套中继器，是的，这是正确的方法（那么，您最好将其封装在方法中）。**[`DataItem`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeateritem.dataitem.aspx)`DataBind`**

 **你应该使用[`using-statement`](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)dispose(close) 连接：

```
Dim rowView As DataRowView = e.Item.DataItem
Dim someDropDown = DirectCast(e.Row.FindControl("DropDownList1"), DropDownList)
Using myCon = New SqlConnection(connectionString)
    Try
        mycon.Open()
        'databind the dropdown...'
    Catch ex As Exception
        'log exception'
    End Try
End Using 
```**

# c++ - 同时在 Visual Studio 中使用 .c 和 .cpp 文件

> ID：12630228
> 
> 赞同：3
> 
> 时间：2012-09-27T21:24:05.913
> 
> 标签：c++, c, visual-studio-2010, compilation, compiler-errors

试图弄清楚如何让使用 C 和 C++ 文件的应用程序进行编译。不是整个代码，但足以理解：

主.cpp：

```
#include <windows.h>
#include <stdio.h>
#include <string.h>
#include "one.h"
#include "two.h"

int __stdcall WinMain(HINSTANCE hInst, HINSTANCE hInst2, LPSTR lpCmdLine, int nShowCmd) {
    FunctionOne();
    FunctionTwo();
} 
```

一个.cpp：

```
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <gdiplus.h>
#include <gdiplusflat.h>
using namespace Gdiplus;
using namespace Gdiplus::DllExports;

int FunctionOne() {
} 
```

二.c

```
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>

int FunctionTwo() {
} 
```

头文件仅包含这些函数的定义。

现在，如果我用**main.cpp**编译它，我会得到 FunctionTwo 的“未解析的外部符号”。如果我用**main.c**编译它，我会为 FunctionOne 得到同样的结果。这甚至可能吗？如果可以，我将如何设置项目以正确编译（Visual Studio 2010）？

如果我根据 main 的扩展名注释掉备用函数，它编译得很好。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T21:30:42.053

问题是`two.h`，几乎可以肯定它不是为了让 C++ 编译器正确编译 C 函数原型而编写的。您需要利用预定义的 __cplusplus 宏，如下所示：

二.h：

```
#ifdef __cplusplus
extern "C" {
#endif

int FunctionTwo();
// etc...

#ifdef __cplusplus
}
#endif 
```

可爱的宏汤；）如果头文件是预烘焙的并且之前从未见过 C++ 编译器，那么在您的 .cpp 源代码文件中执行此操作：

```
#include <windows.h>
#include <stdio.h>
#include <string.h>
#include "one.h"
extern "C" {
#include "two.h"
} 
```

如果头文件包含 C++ 声明，一些程序员将其命名为 .hpp，如果它们包含 C 声明，则将其命名为 .h。这是我个人喜欢的一个很好的做法。Boost团队也是如此。否则，它并没有让世界着火。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:25:44.477

C++ 进行名称修改以支持函数重载，而 C 不这样做。您必须标记您的功能`extern "C"`以防止名称损坏。

```
// main.cpp

extern "C" int FunctionTwo();

.. the rest ..

// two.c

extern "C" int FunctionTwo() {
    // stuff
} 
```

有关混合 C 和 C++ 的更多信息，请参阅[http://www.parashift.com/c++-faq/mixing-c-and-cpp.html](http://www.parashift.com/c++-faq/mixing-c-and-cpp.html)。

# debugging - Nusphere PhpEd 调试器（使用 CodeIgniter）问题

> ID：12630230
> 
> 赞同：0
> 
> 时间：2012-09-27T21:24:13.823
> 
> 标签：debugging, phped

我正在为我的 CodeIgniter 项目使用 Nusphere PHPED。我正在尝试使用调试器，它首先给我带来了问题，我不得不更改 php.ini 以使其启动调试会话。现在，我从 index.php 启动调试器，它看起来像是启动了，但是每次我做某事（比如单击锚点或其他东西）时，它都会带我回到 index.php 并且必须在它之前再次开始初始化所有内容跳转到特定任务。在日志中它说会话结束并且它“无法导航到 URL localhost/project/profile”（其中 project 是我的项目，profile 是我用锚定位的控制器）

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:17:29.083

您可以使用带有已安装 DBG 调试器工具栏的外部浏览器，如 IE、FF 或 Chrome。用于 IE 的一个随 PhpED 一起提供和安装，FF 和 Chrome 的栏在他们的论坛上免费提供。使用调试器工具栏，您可以从正确的位置触发调试器。

# javascript - CORS 和 Access-Control-Allow-Headers 是如何工作的？

> ID：12630231
> 
> 赞同：69
> 
> 时间：2012-09-27T21:24:14.113
> 
> 标签：javascript, jquery, cors

我正在尝试将 CORS 请求从 domain.com 发送到 a.domain.com。

我的 javascript 看起来像这样

```
$('#fileupload').fileupload({
  xhrFields: {
    withCredentials: true
  },
  dataType: 'json',
  url: $('#fileupload').data('path'),
  singleFileUploads: true,
  add: function(e, data){
    data.submit();
  }
}); 
```

起初我看到 OPTIONS 路由被这样调用：

```
Request URL: https://a.domain.com/some/route
Request Method:OPTIONS
Status Code:200 OK 
```

**选项请求：**

```
Access-Control-Request-Headers:origin, content-type, accept
Access-Control-Request-Method:POST
Host:a.domain.com
Origin:http://domain.com:3000
Referer:http://domain.com:3000/home 
```

**选项响应**

```
Access-Control-Allow-Credentials:true
Access-Control-Allow-Methods:POST
Access-Control-Allow-Origin:http://domain.com:3000
Connection:keep-alive
Content-Length:0
Content-Type:text/html;charset=utf-8 
```

该请求返回了 200 个类似声明。在我的服务器上，我的方法与`POST`方法相同，这就是我在`OPTIONS`

```
Request URL:https://a.domain.com/some/route 
```

**发布请求**

```
Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryjwr5Pk7WBcfzMdbO
Origin:http://domain.com:3000
Referer:http://domain.com:3000/home 
```

并且`POST`请求被取消/失败。

我的问题是，我是否也需要在 POST 控制器上拥有 access-control-allow-origin ？

我有一个用于授权的 cookie，`.domain.com`该 cookie 的域在请求中发送过一次，现在没有发送。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-09-28T01:31:40.893

是的，您需要在 OPTIONS 响应和 POST 响应上都有标头`Access-Control-Allow-Origin: http://domain.com:3000`或。`Access-Control-Allow-Origin: *`您还应该`Access-Control-Allow-Credentials: true`在 POST 响应中包含标头。

您的 OPTIONS 响应还应包含`Access-Control-Allow-Headers: origin, content-type, accept`与请求的标头匹配的标头。

# recursion - 带有除 *,/,+,- 以外的运算符的 RPN

> ID：12630232
> 
> 赞同：1
> 
> 时间：2012-09-27T21:24:15.290
> 
> 标签：recursion, postfix-notation

我有一堂课叫`Node`.

```
public Node
{
    public int data;
    public Node primaryNext;
    public Node secondaryNext;
} 
```

我有一个`Node root = null;`And 当从输入中接收到第一个值时，它会运行类似这样的东西。

```
root = new Node;
root.data = /*input*/ ;
root.primaryNext = null;
root.secondaryNext = null; 
```

下一步是`Node`在列表的末尾添加一个新的，通过在逐级填充“指针”树时指向`root.primaryNext`或指向`root.secondaryNext`一个新的。`Node`所以我需要做这样的事情：

[这个想法的 GIF。](http://imgur.com/X2Igg)

我认为这可以通过使用递归方法应用于每个节点级别的 ||、&&、|、& 运算符来完成。所以：

*   如何像 RPN 一样在 C# 中操作？
*   如果可以，最好的方法是什么？我非常了解递归，但我可能不会做最好的方法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:16:04.117

建议：

将单个节点推送到堆栈上的一个命令。

另一个从堆栈中取出两个最顶层节点的命令，将它们组合并将结果推回堆栈。

# javascript - 液体背景

> ID：12630237
> 
> 赞同：0
> 
> 时间：2012-09-27T21:24:34.690
> 
> 标签：javascript, image, layout, background

我想在我的网站上有一个流动的背景，比如你可以在这个网站上看到的： [http ://www.baliilmare.com/](http://www.baliilmare.com/)

我过去曾经使用 FLASH 和 actionscript 3 完成它，但它看起来确实过时了作为一个选项

而 max-width 100% CSS 技巧并没有给出相同的结果。

我实际上想从这个网站上获取 Javascript，但在 javascript 方面真的很菜鸟，需要一个 tut 或者可能有人指向正确的 JS/Jquery（我看到源代码中使用了不同的 .js 文件）然后我可以用谷歌搜索它看看它是如何工作的......

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:30:11.617

您可能可以将背景图像加载到您的身体标签中：

```
body { background-image: url(/images/thisbackground.jpg); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:30:22.227

使用 Firefox 或 Chrome 并右键单击->检查元素。这是查看网站背后发生的事情的最快方式。

他们正在使用图像作为封面。

HTML：

```
<div class="coverImg" style="background-image: url(urltoimage); height: 456px; ">
</div> 
```

CSS：

```
.coverImg {
-webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2);
-moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2);
box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2);
position: relative;
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover;
background-repeat: no-repeat;
background-position: center center;
background-attachment: fixed;
} 
```

# c++ - c++11为std::deque或std::list移动 插入

> ID：12630241
> 
> 赞同：9
> 
> 时间：2012-09-27T21:25:07.797
> 
> 标签：c++, c++11, rvalue-reference, move-semantics

我相当了解右值引用是如何工作的，但我不确定它们如何与 STL 中的迭代器一起工作。这是我想要的东西：

```
void insertList(std::list<int>& L, std::list<int>&& R, std::list<int>::iterator insertPoint)
{
    L.insert(insertPoint, R.begin(), R.end()); // want to use move semantics
} 
```

现在我知道 std::list 有一个拼接方法。但我想知道这是否可行。它也适用于双端队列吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T21:40:09.820

`splice`和*移动*容器的内容是不同的操作。在这种情况下`splice`（不能用 来完成`deque`）整个节点从一个容器转移到另一个容器。节点将不再位于原始容器中，并且该操作不会执行任何分配。

使用类似于您所说的算法但使用*移动*迭代器*移动*内容的替代方法：

 *```
L.insert(insertPoint, 
         std::make_move_iterator(R.begin()), 
         std::make_move_iterator(R.end())); 
```

这对两者都有效`list`，`deque`但语义不同。插入新列表将需要分配`std::distance(R.begin(),R.end())`节点，其内容将通过从原始容器移动来填充。这降低了创建新节点的成本，但仍然需要分配它们。请注意，旧列表仍将包含所有节点，尽管它们将是*空*的，因为数据内容已被移动。

在`std::list`您应该喜欢的情况下`splice`，但这在其他容器上不可用。对于其他容器，您将使用上述方法，其中必须承担构建容器数据结构的成本，尽管可以避免创建存储数据的成本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-27T21:26:48.810

你想要[`std::make_move_iterator()`](http://en.cppreference.com/w/cpp/iterator/make_move_iterator)：

```
L.insert(
    insertPoint,
    std::make_move_iterator(R.begin()),
    std::make_move_iterator(R.end())
); 
```*

# ios - 带有块崩溃的 iOS 按钮目标操作

> ID：12630243
> 
> 赞同：0
> 
> 时间：2012-09-27T21:25:11.260
> 
> 标签：ios, crash, uibutton, action, block

我正在实现 UIButtons，并在其上设置了块操作，以方便和加快集成速度。我以前用过这种方法，现在不久，并没有什么问题。然而，现在我面临一个整合的问题......

[https://gist.github.com/2468899](https://gist.github.com/2468899)

...进入我的应用程序现在会在启动时崩溃。我收到的错误如下...

```
2012-09-27 22:18:47.459 flink[12174:907] -[UIButton setAction:withBlock:]: unrecognized selector sent to instance 0x1e8ae610
2012-09-27 22:18:47.460 flink[12174:907] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIButton setAction:withBlock:]: unrecognized selector sent to instance 0x1e8ae610'
*** First throw call stack:
(0x3885a3e7 0x333bf963 0x3885df31 0x3885c64d 0x387b4208 0xea477 0xff6af 0x36b92cb1 0x3882f8f7 0x3882f15d 0x3882df2f 0x387a123d 0x387a10c9 0x3868c33b 0x34014289 0xe7b8f 0xe7b30)
libc++abi.dylib: terminate called throwing an exception 
```

...我以前从未见过这个问题，但奇怪的是它在没有任何交互的情况下立即崩溃。

先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T01:55:26.000

您必须确保将类别的实现文件添加到您的目标。在 Xcode 中，转到 File Inspector 并确保选中目标的 Target Membership 复选框。

# ios - 有没有在 iOS 应用程序中覆盖 DNS 的好方法？

> ID：12630244
> 
> 赞同：1
> 
> 时间：2012-09-27T21:25:12.730
> 
> 标签：ios, xcode, dns, ip

基本上，我想为 URL 创建一个虚假的 DNS 条目，并强制该 URL 解析为特定的 IP。有没有办法在iOS中做到这一点不会让应用程序被拒绝？我似乎无法找到一种方法来做到这一点（仍然在第一方）。谁能指出我正确的方向（类参考、第三方框架等）？如果没有，是否有我忽略的规则/政策/其他东西使它不可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:45:50.133

您不能在 iOS 应用程序级别正式执行此操作，因为 DNS 是由操作系统设置的，并且由于 iOS 沙盒，您无法修改条目。这意味着如果您正在创建一个您将提交到 Apple App Store 的应用程序，这是不可能的。你可以在你自己的应用程序中构建一些东西，如果你有一些浏览器，你拦截 URL 并重定向它，但当然这将在你的应用程序中是本地的，而不是当用户使用 Mobile Safari 或 Chrome 等时。

如果您正在为越狱设备创建应用程序，您可以修改`/etc/hosts`文件并在此处添加您的条目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-29T05:19:54.147

一个简单
的解决方案：假设你想 GET `http://httpbin.org/get`，
你不想使用 domian，但使用 ip address `54.175.219.8`，
你可以发出请求，设置`http://54.175.219.8/get`为`path`，并添加一个新的 http 头：{“host”：“ httpbin.org"}。

通用解决方案：
实现自己的 NSURLProtocol，如[https://github.com/mattt/NSEtcHosts](https://github.com/mattt/NSEtcHosts)

# maven - 我可以简单地将子回购从一个帐户复制到另一个帐户吗？

> ID：12630251
> 
> 赞同：1
> 
> 时间：2012-09-27T21:25:43.823
> 
> 标签：maven, offline, repository

假设，如果我有一个无法访问 Internet 的用户帐户（例如，出于安全原因，开发人员被困在地堡内的桌面上），我可以简单地将一些子存储库直接复制到用户的*~/. m2/存储库/*目录？

例如，我可以简单地采用最新的，比如说：

```
~/.m2/repository/net/sf/trove4j 
```

来自一个系统的目录并手动将其复制到没有 Internet 访问权限的用户的*~/.m2/repository/中？*

那行得通吗？我在两个*find ~/.m2之间做了一个快速的**比较*（一个之前和一个在可以访问 Internet 的机器上使用 Maven 添加*trove4j*之后），看起来这就是所需要的。

 **但是有什么问题吗？我应该担心什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:41:31.507

AFAIK，这应该是安全的。我知道我们过去已经使用开发人员机器完成了它，并且我们没有发现任何问题。Maven 使用 repo 中的文件和文件夹名称来表示工件 id、组 id 等，而不是在某处使用一些 xml 文件来保存这些信息。（出于其他原因，在 repo*中*使用了授予的 XML 文件。）

查看这个问题[maven artifact repository directory structure specs](https://stackoverflow.com/questions/8381280/maven-artifact-repository-directory-structure-specs)，特别[是 repo layout doc](https://cwiki.apache.org/confluence/display/MAVENOLD/Repository+Layout+-+Final)，了解有关 repo 布局如何工作的更多信息。**

# c++ - const string a = "tmp" vs const string& a = "tmp"

> ID：12630259
> 
> 赞同：2
> 
> 时间：2012-09-27T21:26:27.827
> 
> 标签：c++, string, optimization

我与我的一位同事就此进行了讨论。并且想知道更多人对哪个“可以”更优化的意见？PS：如果代码只是一个 hello world 程序，-O3 会产生相同的代码，但我们说的是这个代码段位于大型项目中间的场景。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:29:29.707

背景将是决定性的重要因素。你的分析器可能会告诉你不要出汗。

在这种情况下，`std::string`无论如何都必须构造一个新的，并且“对生命周期延长的临时值的常量引用”实际上只会导致编译器更多的工作（发出等效/相同的代码）。

我会选择清晰：

### 代码意图，而不是方法

所以

```
std::string tmp("Hello"); 
```

或者

```
std::string tmp = "Hello"; 
```

会充分表达意图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T21:50:07.373

编译器可能会生成相同的代码，但使用引用会误导普通读者。考虑一下，不是用文字初始化它，而是使用函数的返回：

```
std::string f();

std::string const & r = f(); // [1] 
```

标记为 [1] 的行似乎只是在创建对在其他地方管理的对象的引用（低成本操作）。代码的读者将试图弄清楚被引用的字符串是否可以在外部更改，或者即使它可能被破坏而留下一个悬空的引用。他们将不得不去查看文档`f()`并发现它实际上是一个临时的，然后回到原始代码并弄清楚这只是一些程序员在玩聪明的把戏。

另一方面`std::string s = f();`，意图更加清晰：无论`f()`代表什么，其副本都将保留在本地上下文中。对象不会在外部发生变化，并且生命周期正是它定义的范围。

请注意，在这两种情况下，行为实际上是相同的，但在一种情况下，对于不经意的读者来说是显而易见的，而在另一种情况下，读者必须弄清楚。我会在所有可能的情况下使用本地对象，并将生命周期延长限制在值不会削减它的少数情况下（在现实生活中我只需要一次）。

# javascript - Ember.js 在管理视图集（和模型）方面是否有意见？

> ID：12630260
> 
> 赞同：2
> 
> 时间：2012-09-27T21:26:30.763
> 
> 标签：javascript, ember.js

我希望根据用户交互对每个视图发生的情况进行一些精细控制。此外，每个视图发生的情况还取决于其他视图当前正在做什么，因此需要将所有视图保存在一个数组中。根据我在网上找到的简单示例，控制器似乎旨在管理模型集？目前，我通过有一个“viewController”来将这个概念扩展到视图。尽管我不太确定，但这个解决方案对我来说并不令人震惊。

但请注意，这似乎是一个非常笼统的问题，因为没有一个正确答案，而且每种情况下正确的答案都不同。然而，记住 Ember 的自以为是的方式，我只是问制作 Ember 的人是否有一种我尚未知道的特定方式，并构建 Ember 以使这种“一种方式”具有最多的功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T02:11:27.177

Ember 应用程序中控制器的主要职责是将数据呈现给视图以进行渲染。

管理动态视图集合的一个很好的解决方案是子类化`Ember.ContainerView`并让它更新它的`childViews`属性以响应控制器上的属性变化。您可以查看源代码`Ember.CollectionView`作为示例。

我做了一个演讲，其中我列出了 Ember 应用程序中各种对象类的职责以及它们如何协同工作。你可以在这里查看：[http ://www.lukemelia.com/blog/archives/2012/08/23/architecting-ember-js-apps/](http://www.lukemelia.com/blog/archives/2012/08/23/architecting-ember-js-apps/)

# iphone - ios如何访问和修改来自不同类的变量？

> ID：12630263
> 
> 赞同：0
> 
> 时间：2012-09-27T21:26:58.967
> 
> 标签：iphone, ios, properties, uiviewcontroller

我有以下内容：

```
Class 1:

.h file:
@interface class1 : UIViewController

@property (assign,nonatomic) int number;

.m file:

- (void)viewDidLoad
{
    [super viewDidLoad];
number=1;
}

Class2:

.h file:
@interface class2 : UIView{
    class1 *Controller;
}

@property (retain,nonatomic) class1 *controller; 
```

但是如果从第二类中的任何地方访问 number 变量，则值为 0 任何人都知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:30:52.067

课程是否已经打开并保留在某处（即您的导航堆栈）？如果是这样，您就可以安全地访问和修改变量，因为它们已经被初始化。如果不是，那可能就是您返回 0 的原因。

另一种方法是创建和维护一个数据单例，所有视图控制器都可以轻松地从中提取数据，然后您可以引用该数据单例来修改和更改值。

假设视图控制器已经初始化并处于活动状态，您可以执行以下操作：

```
MyViewController *vc = [[MyViewController alloc] init];
[vc setValue:@"100"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T04:52:49.570

您可以使用 appDelegate 方法从其他类访问变量，

例子，

在你的 class2: .m 文件中

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{

    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        appDelegate = (AppDelegate *)[UIApplication sharedApplication].delegate;
        Controller = appDelegate.viewControllerClass1;
    }
    return self;
} 
```

在 AppDelegate 类中，.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.
    self.viewControllerClass1 = [[[Class1 alloc] init] autorelease];
    NavigationController=[[UINavigationController alloc]initWithRootViewController:self.viewControllerClass1];

 [self.window makeKeyAndVisible];
    return YES;
} 
```

# powershell - Powershell 2.0 最大参数数

> ID：12630264
> 
> 赞同：4
> 
> 时间：2012-09-27T21:27:15.323
> 
> 标签：powershell, batch-file, powershell-2.0

从命令行或批处理文件调用时，Powershell V2.0 脚本将接受的最大参数数是多少？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T23:04:38.057

理论上的最大值为 2 GB 的参数。:-) 这是因为函数映射到对象数组 ( `$args`) 中的未映射参数和 .NET 2.0/4.0（安装了 4.5）中的数组可以索引到 Int32.MaxValue。据我了解，实际限制略低于实际类型。FWIW 我可以在 PowerShell 中创建一个大小为 128MB 的对象数组。我认为对参数数量的更现实限制是对命令行长度的限制。在某个时间点 cmd.exe 的[最大行长度为 8191](http://support.microsoft.com/kb/830473)。我不确定 PowerShell 的最大值是多少，但我猜它类似于 cmd.exe 的最大值。此外，如果需要启动外部进程，那么这些 shell 会通过[CreateProcess API，它有 32,767 个字符的限制](http://blogs.msdn.com/b/oldnewthing/archive/2003/12/10/56028.aspx)用于传递给进程的命令行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:22:22.530

我不知道有任何限制，您打算使用多少个？

# sql - 有没有办法重新启动游标？甲骨文

> ID：12630266
> 
> 赞同：0
> 
> 时间：2012-09-27T21:27:21.523
> 
> 标签：sql, oracle

我正在尝试做一些事情，例如：

```
for(int i = 0; i<10; i++)
{
    for(int j = 0; j<10; j++)
    {
        Blah;
    }
}

//As you can see each time that there is a different i, j starts at 0 again. 
```

在 Oracle 中使用游标。但如果我是正确的，在我从游标中获取所有行之后，它不会重新启动。有没有办法做到这一点？

这是我的sql：

```
CREATE OR REPLACE PROCEDURE SSACHDEV.SyncTeleappWithClientinfo
as
teleCase NUMBER;

CURSOR TeleAppCursor
is
    Select 
        distinct(casenbr)
    from TeleApp;

CURSOR ClientInfoCursor
is
    Select casenbr 
    from clientinfo 
    where trim(cashwithappyn) is null;

BEGIN

    open TeleAppCursor;
    open ClientInfoCursor;

    LOOP
        fetch TeleAppCursor into teleCase;
        EXIT when TeleAppCursor%NOTFOUND;

        LOOP
            fetch ClientInfoCursor into clientCase;
            EXIT when ClientInfoCursor%NOTFOUND;
                if clientCase = teleCase then

                    update ClientInfo 
                    set cashwithappyn = (select cashwithappyn from teleapp where casenbr = clientCase) 
                    where casenbr = clientCase;

                    break;
                end if;
        END LOOP;
    END LOOP;

END; 
```

我确实在网上查过，但在这方面找不到任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:15:20.017

您可以使用表变量来存储 sql 语句的结果，然后在表上循环任意次数，而不是重新启动游标。

这是使用 SQL Fiddle 示例数据的示例。

```
DECLARE 
    CURSOR c1 IS 
      SELECT id, 
             TYPE, 
             details 
      FROM   supportcontacts; 

    TYPE contactrec 
      IS TABLE OF c1%ROWTYPE INDEX BY BINARY_INTEGER; 

    acontact    c1%ROWTYPE; 
    contactlist CONTACTREC; 
    counter     INTEGER; 
BEGIN 
    counter := 0; 

    OPEN c1; 

    LOOP 
        FETCH c1 INTO acontact; 

        IF c1%FOUND THEN 
          counter := counter + 1; 
        END IF; 

        Contactlist(counter) := acontact; 

        IF c1%NOTFOUND THEN 
          EXIT; 
        END IF; 
    END LOOP; 

    CLOSE c1; 

    FOR i IN 1..5 LOOP 
        FOR j IN 1..counter LOOP 
            dbms_output.Put_line(Contactlist(j).type  || ' ' || Contactlist(j).details); 
        END LOOP; 
    END LOOP; 
END; 

/ 
```

哪个输出

```
Email admin@sqlfiddle.com
Twitter @sqlfiddle
Email admin@sqlfiddle.com
Twitter @sqlfiddle
Email admin@sqlfiddle.com
Twitter @sqlfiddle
Email admin@sqlfiddle.com
Twitter @sqlfiddle
Email admin@sqlfiddle.com
Twitter @sqlfiddle 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!4/ee7da/1624)，但我不知道如何查看 dbms_output 的输出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:29:09.800

您根本不需要第二个游标，只需使用 Oracle 中的 set 操作来更新相应的记录，而无需自己手动搜索：

```
DECLARE
    v_teleCase      TeleApp.teleCase%TYPE;
    v_cashwithappyn TeleApp.cashwithappyn%TYPE

    CURSOR TeleAppCursor
    is
        Select 
            distinct casenbr, cashwithappyn
        from TeleApp;

BEGIN

    open TeleAppCursor;

    LOOP
        fetch TeleAppCursor into v_teleCase, v_cashwithappyn;
        EXIT when TeleAppCursor%NOTFOUND;

        UPDATE ClientInfo
        SET cashwithappyn = v_cashwithappyn
        WHERE casenbr = v_teleCase
        AND trim(cashwithappyn) is null;

    END LOOP;

END; 
```

最好不要有与列同名的变量。

# google-chrome-extension - Chrome 扩展程序升级使扩展程序没有 javascript 文件

> ID：12630268
> 
> 赞同：1
> 
> 时间：2012-09-27T21:27:29.520
> 
> 标签：google-chrome-extension, upgrade, chrome-web-store

我在 Chrome Webstore 中有一个扩展程序，有大约 400 000 个用户。从几个月前开始，我收到了一些用户的电子邮件，他们的扩展程序已停止为他们工作。他们基本上只是在弹出和选项页面中看到 HTML 页面。没有任何 JavaScript 动态添加的内容。在一位用户进行了一些有用的调试后，JavaScript 文件似乎消失了。他给我发了以下截图：

![在此处输入图像描述](../Images/ea5db9ba546c4311e0c18921c8be54fb.png)

所以似乎发生的是 JS 文件变得无法访问或消失。我的猜测是，当升级发生时会发生这种情况。在最近的更新中，我没有移动或更改任何文件的名称。根本没有发生大的变化。

我已经通过发送有关如何在硬盘驱动器上找到扩展名的说明并附加扩展文件来解决这个问题，因此他们必须手动自己修补扩展名。这总是有效的。现在今天，在一个小时内收到 4 封同样问题的电子邮件后，我受够了。

一位用户让她的所有分机同时停止工作。我的猜测是这个问题是罪魁祸首。我将补丁发送给她至少解决了我的扩展问题。

所以我对stackoverflow的问题是：有没有其他人经历过这个？这似乎是 Chrome 的一个非常严重的问题。它开始出现在 Chrome 20 左右，并且仍然出现在 22 中。我的清单版本早于几天前 1。

有问题的扩展：[http](http://chrome.google.com/webstore/detail/pnjaodmkngahhkoihejjehlcdlnohgmp?hl=en) ://chrome.google.com/webstore/detail/pnjaodmkngahhkoihejjehlcdlnohgmp?hl=en 。

# cordova - PhoneGap 2.1 的 iOS 条码扫描器？

> ID：12630275
> 
> 赞同：0
> 
> 时间：2012-09-27T21:28:13.807
> 
> 标签：cordova, phonegap-plugins

我知道 PhoneGap 2.0 及以下 ( [https://github.com/phonegap/phonegap-plugins/tree/master/iOS/BarcodeScanner](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/BarcodeScanner) ) 的 BarcodeScanner 插件，但有人看过一个版本（或修改后的版本我链接到的）与 iOS 的 PhoneGap 2.1 兼容？我试图对将其移植到 2.1 所需的代码进行更改（在此处讨论：http: [//docs.phonegap.com/en/2.1.0/guide_plugin-development_ios_index.md.html#Developing%20a %20Plugin%20on%20iOS_plugin_signatures](http://docs.phonegap.com/en/2.1.0/guide_plugin-development_ios_index.md.html#Developing%20a%20Plugin%20on%20iOS_plugin_signatures)）但无法使其正常工作。

建议或链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T05:37:25.867

你可以试试[这个](http://www.mobiledevelopersolutions.com/home/start/twominutetutorials/tmt3p2)模块或库。

这适用于我的 iOS，这也有一个例子。

# ios - 我的自定义导航栏后退按钮 Xcode 的问题

> ID：12630276
> 
> 赞同：0
> 
> 时间：2012-09-27T21:28:17.813
> 
> 标签：ios

我正在使用故事板在 Xcode 4.3.2 中工作。我通过单击要创建转场的按钮并控制+单击+拖动连接到下一个视图控制器，在两个视图之间创建了转场。当然，这会在下一个视图控制器的导航栏中创建一个自动/默认后退按钮。我想要做的是自定义这个后退按钮的外观。所以，我在网上看了一圈，发现了这段代码：

```
self.navigationItem.hidesBackButton = YES;
UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(0, 4, 40, 40)];
[button setImage:[UIImage imageNamed:@"homeButton.png"] forState:UIControlStateNormal];
[button addTarget:self action:@selector(backAction) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *back = [[UIBarButtonItem alloc] initWithCustomView:button];
self.navigationItem.leftBarButtonItem = back; 
```

更改按钮的外观效果很好，但现在的问题是，当我单击该按钮时，Xcode 会抛出错误：“无法识别的错误已发送到实例......”

谁能帮我弄清楚现在如何为我的自定义后退按钮添加适当的功能？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:33:21.440

你实现了这个方法`- (void)backAction`吗？

为了使后退按钮与导航控制器一样，一个可能的实现可能如下所示：

```
- (void)backAction {
    [self.navigationController popViewControllerAnimated:YES];
} 
```

这可能需要根据您的应用程序设置以及按下按钮时您希望它执行的操作进行调整，但这应该是一个很好的起点

# matlab - 在 Matlab 64 位中打开声音控制 (OSC)

> ID：12630278
> 
> 赞同：2
> 
> 时间：2012-09-27T21:28:20.373
> 
> 标签：matlab, kinect, osc

我一直在使用 oscmex (http://sourceforge.net/projects/oscmex/) 通过 OSCeleton (https://github.com/Sensebloom/OSCeleton) 从 Kinect 接收 Matlab r2007b 中的开放声音控制消息一段时间了. 它在装有 Matlab 32 位的 Windows XP 计算机上工作。

我现在正试图让它在没有运气的 Windows 7 计算机上工作。我安装了 32 位版本的 Matlab 并添加了 .dll 二进制文件，但我只能收到空的 OSC 数据包。我搜索了高低的论坛，但没有找到解决方案。我知道 OSC 消息是从 Kinect 流式传输的，因为 OSCeleton 可以看到校准姿势，并且我可以看到 GlovePIE (https://sites.google.com/site/carlkenner/glovepie) 中的变量值发生变化。

那么，我的问题是，有没有更简单的方法在 Matlab 中接收 OSC 消息？我找到了发送 OSC 消息的脚本（http://www.mathworks.com/matlabcentral/fileexchange/31400-send-open-sound-control-osc-messages），但还没有找到可以接收的脚本。关于为什么 osc .dll 文件在 64 位系统上运行的 32 位版本的 Matlab 上不起作用的任何建议？针对 64 位 Matlab 编译 oscmex 源代码是否可行，有人可以帮我这样做吗？OSC 客户端 (OSCeleton) 和 OSC 服务器 (Matlab) 之间显然存在断开连接，但我无法弄清楚它是什么。

提前致谢！

马特

# c++ - C++ 中的多线程 Web 服务器

> ID：12630280
> 
> 赞同：0
> 
> 时间：2012-09-27T21:28:30.963
> 
> 标签：c++, c, sockets

我想在 C++ 中做一个带有调度和同步的多线程 Web 服务器。这是一个分配问题，我不是在问代码。我已经完成了服务器中的套接字连接，但我不知道如何继续。我只是想要一些提示或为程序流。

这是我的几个问题

1）我已经完成了socket accept（）。所以当新连接到来时，我必须fork（）然后关闭子进程的连接。对吗？

2）我必须如何确保程序与运行这么多线程的同步？

3) 我必须有 2 个线程池。1 个工作池，另外 2,1 个，每个用于接受连接并将请求插入就绪队列。如何做到这一点？

我不是在问代码。我只需要一些提示和指导。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:12:20.113

非常有趣的课程作业，如果您了解这一点，很多概念就会变得清晰，即并发及其主要用例之一，即网络！

我自己使用以下文章快速总结了我在 Linux 中的网络并发选项

[http://m.linuxjournal.com/content/three-ways-web-server-concurrency?page=0,0](http://m.linuxjournal.com/content/three-ways-web-server-concurrency?page=0,0)

本文对您需要的概念进行了非常高级的介绍，例如分叉进程的写入时复制，因此在某些情况下，单独的地址空间否定同步，一旦您阅读了本文，您将遇到更具体的问题从本文中的代码开始动手吧。

# eclipse - Google App Engine Eclipse 启动本地主机多个应用程序冲突？

> ID：12630282
> 
> 赞同：0
> 
> 时间：2012-09-27T21:28:41.133
> 
> 标签：eclipse, google-app-engine, pydev

我在 Eclipse 4.2（Windows 7）中通过 pydev 创建了两个 GAE 项目，第一个项目在运行 localhost:8080 时没有问题，但是当我创建第二个项目时，我复制了本地运行的运行配置并更改了项目名称到新的。但是-当我运行该配置时，初始 HelloWorld 项目显示在我的浏览器中，我尝试完全删除第一个项目，但随后它只是解释它无法在旧目录中找到 app.yaml（因为旧目录不在它所在的位置）。

很明显，我在启动过程中缺少一些设置根路径的设置。运行配置是一个 PyDeb Google App Run，主模块指向

```
C:\program files (x86)\google\google_appengine\dev_appserver.py 
```

论据是

```
${project_loc}\src 
```

其他一切都在默认设置上。

任何帮助都将不胜感激，因为每次小的调试迭代都推送到谷歌（这对两者都很好）让我有点发疯。

谢谢！

*编辑：忘了提及我已经尝试删除所有运行配置并重新制作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:10:16.187

您是否尝试过 Run as : PyDev Google App Engine Run 来创建新的运行配置？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T11:35:32.180

原来我只是有点傻。在 Eclipse 中，在开始第二个项目之前，我没有正确关闭第一个项目的 LocalHost（不确定那里的正确术语）。要修复，我需要进入 Eclipse 控制台窗口，然后选择“显示选定的控制台”并选择我想要停止的项目并点击全部停止按钮。然后它运行良好。

希望这对将来的某人有所帮助，就像我一样坚定“这不是我的错”。

干杯。

# c++ - C++ 任意函数反序列化

> ID：12630285
> 
> 赞同：0
> 
> 时间：2012-09-27T21:28:48.313
> 
> 标签：c++, function, templates, io, deserialization

**问题**

假设有一组不同的函数。每个函数都可能是某个对象的成员函数，并且可以采用任意数量的参数。为简单起见，我们假设每个函数的参数不超过 8 个`int`，`double`或`std::string`类型。例如：

```
class MyClass{
public:
  void DoA(int i);
  void DoB(double d, int i);
};

class YourClass{
public:
  void DoC(std::string s);
  void DoD(int i1, int i2, int i3);
}; 
```

让我们假设有一个文件包含一系列关于函数的记录。每条记录都包含要调用的函数的名称、其参数值和指向成员函数对象的指针。我需要一种方法来从文件中读取所有这些数据并使用正确的参数以正确的顺序执行函数。

例如，对函数的名称进行硬编码是可以的，但是向库中添加新函数应该尽可能简单。

**动机**

这是我正在尝试创建的 roguelike 游戏项目的一部分，特别是保存/加载游戏系统。一旦玩家尝试保存他的游戏，还必须保存所有尚未发生的事件，并且下次玩家加载游戏事件时应该正确加载和安排。由于 roguelike 显然需要很大的空间来扩展，所以我不想对函数类型做任何假设。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:54:21.893

这是一个想法：

```
class Foo
{
    void f1_impl(double, char, int);
    void f2_impl(int, int);

    void func1(std::string s)
    {
        double d;
        char   c;
        int    i;

        std::tie(d, c, i) = parse<double, char, int>(std::move(s));

        f1_impl(d, c, i);
   }

   void func2(std::string s)
   {
        // similarly
   }
};

std::unordered_map<std::string, void (Foo::*)(std::string)> const functions
{  { "function1", &Foo::func1 },
   { "function2", &Foo::func2 },
}; 
```

输入文件：

```
function1 1.250000,'a',2815
function2 12,-80
function2 99,111 
```

解析：

```
Foo x;

for (std::string line; std::getline(inputfile, line); )
{
    std::string f, a;

    if (!(std::istringstream(line) >> f >> a)) { /* error */ }

    (x.*functions[f])(a);
} 
```

# php - 使用下拉菜单查询数据库并在不离开页面的情况下返回结果

> ID：12630288
> 
> 赞同：0
> 
> 时间：2012-09-27T21:29:10.913
> 
> 标签：php, jquery, mysql, html

我有一个包含一些 PHP 的页面，如下所示：

```
<table>
    <thead>
        <tr>
            <th class="wheniwant">Date</th>
            <th class="wheniwant">Income Amount</th>
            <th class="wheniwant">Expense Amount</th>
        </tr>
    </thead>

    <?php
    //DB CONNECTION

    $varDatePaid = ""; $varIncomePaid =""; $varExpensePaid = "";

    $sql = mysql_query( 
        "
            SELECT DATE_FORMAT(`date_paid`, '%Y-%m') `date_paid`,
            SUM(CASE WHEN `categoryType` = 'Income' THEN `amount_paid` END) `IncomeAmount`,
            SUM(CASE WHEN `categoryType` = 'Expense' THEN `amount_paid` END) `ExpenseAmount`
            FROM `accounting`
            GROUP BY DATE_FORMAT(`date_paid`, '%Y-%m')
        "
     );

    while($row = mysql_fetch_array($sql))
        {
            $varDatePaid = $row['date_paid'];
            $varIncomePaid = $row['IncomeAmount'];
            $varExpensePaid = $row['ExpenseAmount'];                        
    ?>

    <tr>
        <td><?php echo $varDatePaid; ?></td>
        <td><?php echo $varIncomePaid; ?></td>
        <td><?php echo $varExpensePaid; ?></td>
        </tr>

    <?php   

        }
    ?>
</table> 
```

这将返回一个类似的表：

![截屏](../Images/b5e83d6bc5a3ad6a1adefb9a21f5e5bc.png)

然后我想添加一些东西：

```
$sql_query = "SELECT id, DATE_FORMAT(`date_paid`, '%Y') AS year FROM accounting GROUP BY year ORDER BY year DESC";

$result = mysql_query($sql_query) or die(mysql_error());
while ($row = mysql_fetch_array($result)){
echo '<option value='. $row['year'] . '>'. $row['year'] . '</option>'; 
```

创建某种过滤器以将结果限制在特定年份。如何在不离开页面的情况下执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T00:00:27.890

好的，所以你会想在[这里](http://w3schools.com/ajax/default.asp)阅读 AJAX 。这不是很困难，在大多数情况下，您可以直接从该站点复制代码。或者，根据您拥有的数据量以及如果您真的不想学习新东西，您可以在页面加载时加载整个数据集，然后在填写表格后使用 JS 来挑选您想要的部分。我建议使用 AJAX 路由。

其他人提到了一些关于外部 PHP 脚本的事情，我猜这是可能的，但我不确定它是如何工作的。我假设您必须在第一页上使用 JS 来制作一个说明您想要的 cookie，然后打开一个新选项卡或窗口，在其中执行查询并将值存储为 cookie 或会话变量，然后使用 JS查询完成后关闭该窗口，然后再次使用 JS 将查询结果放回页面上。我想这会奏效，但这似乎不是最有效的方法。

# jquery - 鼠标移动 jQuery 后没有触发 MouseUp

> ID：12630290
> 
> 赞同：2
> 
> 时间：2012-09-27T21:29:25.393
> 
> 标签：jquery, mouseup

我在这里看到了一系列此类问题，并尝试将它们作为修复程序来实施，但似乎没有一个能够修复。

我在这里有一个小提琴设置[http://jsfiddle.net/OwenMelbz/RjYnM/](http://jsfiddle.net/OwenMelbz/RjYnM/)

问题是，一旦您拖动了该框，您必须在它似乎注册 mouseup 事件之前单击。

这是js（抱歉有很多）

```
$(function() {
var pageID = document.location.pathname;
var defaultMarkup = document.documentElement.innerHTML;

$('.feedback-menu').attr('data-pageId', pageID);

$('.feedback-tab').click(function() {
    var state = $(this).attr('data-state');

    if (state == "closed") {
        $(this).attr('data-state', 'open');
        $('.feedback-menu').animate({
            'right': '-1px'
        });
        $('.feedback-tab').animate({
            'right': '100px'
        });
    }
    else {
        $(this).attr('data-state', 'closed');
        $('.feedback-menu').animate({
            'right': '-102px'
        });
        $('.feedback-tab').animate({
            'right': '-1px'
        });
    }
});

$('body').append("<div class='feedback-overlay' style='display:none;'></div>");

$('.feedback-btn').live('click', function() {
    setupCanvas();
});

var setupCanvas = function() {
    var overlayMarkup = "<div class='feedback-overlay'></div>";
    var docHeight = $(document).outerHeight();
    var docWidth = $(document).outerWidth();

    $('.feedback-overlay').css({
        'width': docWidth,
        'height': docHeight,
        'display': 'block'
    });

};

var startDrawing = function() {
    initDraw();
};

window.bugID = 0;
window.canvas = $('.feedback-overlay');

canvas.live('mousedown', function(e) {

    if(e.target != this){ return true; }

    bugID++;

    window.click_y = e.pageY;
    window.click_x = e.pageX;

    canvas.append('<div class="selection-box" id="bugID-' + bugID + '"></div>');

    window.bugBox = $('#bugID-' + bugID);

    bugBox.css({
        'top': click_y,
        'left': click_x,
        'width': 0,
        'height': 0
    });

    canvas.mousemove(function(e) {

        var move_x = e.pageX,
            move_y = e.pageY,
            width = Math.abs(move_x - click_x)-10,
            height = Math.abs(move_y - click_y)-10;

        bugBox.css({
            'width': width,
            'height': height
        });
        if (move_x < click_x) { //mouse moving left instead of right
            bugBox.css({
                'left': click_x - width
            });
        }
        if (move_y < click_y) { //mouse moving up instead of down
            bugBox.css({
                'top': click_y - height
            });
        }
        return false;
    });

    canvas.one('mouseup', function(e) {

        bugBox.draggable().resizable();
        if (bugBox.width() < 50 || bugBox.height() < 50) {
            bugBox.remove();
        }
        $().unbind();
        });

        return false;
}); 
```

});​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:55:53.787

尝试`$(this).unbind();`在鼠标向上方法中使用：

```
canvas.one('mouseup', function(e) {
    console.log("a");
    bugBox.draggable().resizable();
    if (bugBox.width() < 50 || bugBox.height() < 50) {
        bugBox.remove();
    }
    $(this).unbind();
    }); 
```

更新小提琴：http: [//jsfiddle.net/johnkoer/RjYnM/5/](http://jsfiddle.net/johnkoer/RjYnM/5/)

PS：不推荐使用 Live，因此您应该继续使用[on](http://api.jquery.com/on/)

# sql - 需要在查询中计数

> ID：12630291
> 
> 赞同：0
> 
> 时间：2012-09-27T21:29:28.593
> 
> 标签：sql, sql-server

在此处的 sp 中，我试图计算有多少记录符合标准，以便我可以在应用程序的磁贴中显示为总数。但是我没有成功，你能告诉我如何计算以及放在哪里。

```
(
  @P_FACILITY_KEY_CSV VARCHAR(MAX)
, @DATEFROM DATETIME 
, @DATETHRU DATETIME
, @P_TOTALS NUMERIC(1, 0)
)
AS
BEGIN
          DECLARE @DFACKEY CHAR(4)
          DECLARE @IRENEWALLCYCLEPERIOD NUMERIC
          SET @IRENEWALLCYCLEPERIOD = OGEN.READ_PARAM(349, @P_FACILITY_KEY_CSV, '') 
          EXEC OGEN.GET_CODE_FACILITY @P_FACILITY_KEY_CSV, 'OGEN.GEN_M_DOCTOR_MAST', 'BASE', @DFACKEY OUTPUT;

     IF @P_TOTALS = 1 BEGIN

         SELECT P.NURSING_UNIT,
                ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) DUE_DATE,
                CONVERT(NUMERIC, ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) - GETDATE()) REMAINING
              FROM OGEN.GEN_M_PATIENT_MAST P
              LEFT OUTER JOIN OGEN.GEN_M_DOCTOR_MAST D ON P.PRIMARY_DOCTOR_KEY = D.DOCTOR_KEY AND D.FACILITY_KEY = @DFACKEY
              LEFT OUTER JOIN OPTC.ORD_D_SCHEDULED_RECERTS SR ON P.PAT_NUMBER = - SR.PAT_NUMBER
              LEFT OUTER JOIN OGEN.GEN_M_USER U ON U.USER_ID = SR.RECERT_BY
              WHERE P.FACILITY_KEY IN(SELECT VALUE FROM OGEN.COMMA_TO_TABLE(@P_FACILITY_KEY_CSV)) 
              AND DISCHARGE_DATE IS NULL
              AND ( ( (@DATEFROM > 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) >= @DATEFROM) )
                    OR
                    (@DATEFROM = 0) )
              AND ( ( (@DATETHRU > 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) <= @DATETHRU) )
                    OR
                   ( @DATETHRU = 0) )

              ORDER BY REMAINING;

     END ELSE BEGIN

          SELECT P.*, D.DR_FULL_NAME PRIMARY_DOCTOR_NAME,
                 SR.RECERT_DATE, SR.RECERT_BY, U.USER_NAME,
                 ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) DUE_DATE,
                 CONVERT(NUMERIC, ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) - GETDATE()) REMAINING                           
          FROM OGEN.GEN_M_PATIENT_MAST P
          LEFT OUTER JOIN OGEN.GEN_M_DOCTOR_MAST D ON P.PRIMARY_DOCTOR_KEY = D.DOCTOR_KEY AND D.FACILITY_KEY = @DFACKEY
          LEFT OUTER JOIN OPTC.ORD_D_SCHEDULED_RECERTS SR ON P.PAT_NUMBER = - SR.PAT_NUMBER
          LEFT OUTER JOIN OGEN.GEN_M_USER U ON U.USER_ID = SR.RECERT_BY
          WHERE P.FACILITY_KEY IN(SELECT VALUE FROM OGEN.COMMA_TO_TABLE(@P_FACILITY_KEY_CSV)) 
          AND DISCHARGE_DATE IS NULL
          AND ( ( (@DATEFROM > 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) >= @DATEFROM) )
                OR
                (@DATEFROM = 0) )
          AND ( ( (@DATETHRU > 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) <= @DATETHRU) )
                OR
               ( @DATETHRU = 0) )
          ORDER BY DUE_DATE
    END   
END 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:33:00.803

您是否只想在查询中添加一个作为返回的所有记录的 COUNT 的附加列？

```
SELECT COUNT(1) OVER () Total,
       .. <all your other columns> .. 
```

或者，如果您可以将其作为 SP 返回值返回，则

```
RETURN @@ROWCOUNT 
```

最后，假设您显示的内容（IF/SELECTs）是您的 SP 的结尾。

# matlab - MATLAB：不使用现有函数的 10 倍交叉验证

> ID：12630293
> 
> 赞同：3
> 
> 时间：2012-09-27T21:29:31.693
> 
> 标签：matlab, machine-learning, cross-validation

我有一个矩阵（我猜在 MatLab 中你称之为结构）或数据结构：

```
 data: [150x4 double]
labels: [150x1 double] 
```

这是我的 matrix.data 看起来假设我确实使用矩阵名称加载了我的文件：

```
5.1000    3.5000    1.4000    0.2000
4.9000    3.0000    1.4000    0.2000
4.7000    3.2000    1.3000    0.2000
4.6000    3.1000    1.5000    0.2000
5.0000    3.6000    1.4000    0.2000
5.4000    3.9000    1.7000    0.4000
4.6000    3.4000    1.4000    0.3000
5.0000    3.4000    1.5000    0.2000
4.4000    2.9000    1.4000    0.2000
4.9000    3.1000    1.5000    0.1000
5.4000    3.7000    1.5000    0.2000
4.8000    3.4000    1.6000    0.2000
4.8000    3.0000    1.4000    0.1000
4.3000    3.0000    1.1000    0.1000
5.8000    4.0000    1.2000    0.2000
5.7000    4.4000    1.5000    0.4000
5.4000    3.9000    1.3000    0.4000
5.1000    3.5000    1.4000    0.3000
5.7000    3.8000    1.7000    0.3000
5.1000    3.8000    1.5000    0.3000 
```

这是我的 matrix.labels 看起来像

```
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1 
```

我正在尝试在不使用 MatLab 中的任何现有函数的情况下创建 10 个交叉折叠验证，并且由于我对 MatLab 的了解非常有限，因此我无法从我所拥有的东西中继续前进。任何帮助都会很棒。

这是我到目前为止所拥有的，我相信这可能不是 matlab 的方式，但我对 matlab 很陌生。

```
function[output] = fisher(dataFile, number_of_folds)
    data = load(dataFile);
    %create random permutation indx
    idx = randperm(150);
    output = data.data(idx(1:15),:);
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T22:41:35.957

这是我对这个交叉验证的看法。我使用 magic(10) 创建虚拟数据，也随机创建标签。想法如下，我们获取数据和标签并将它们与随机列组合。考虑遵循虚拟代码。

```
>> data = magic(4)

data =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

>> dataRowNumber = size(data,1)

dataRowNumber =

     4

>> randomColumn = rand(dataRowNumber,1)

randomColumn =

    0.8147
    0.9058
    0.1270
    0.9134

>> X = [ randomColumn data]

X =

    0.8147   16.0000    2.0000    3.0000   13.0000
    0.9058    5.0000   11.0000   10.0000    8.0000
    0.1270    9.0000    7.0000    6.0000   12.0000
    0.9134    4.0000   14.0000   15.0000    1.0000 
```

如果我们根据第 1 列对 X 进行排序，我们会随机对数据进行排序。这将为我们提供交叉验证随机性。然后接下来就是根据交叉验证百分比来划分 X。在一个案例中完成这一点很容易。让我们考虑 %75% 是训练用例，%25% 是测试用例。我们这里的大小是 4，然后 3/4 = %75 和 1/4 是 %25。

```
testDataset = X(1,:)
trainDataset = X(2:4,:) 
```

但是对于 N 个交叉折叠来说，要做到这一点有点困难。因为我们需要做 N 次。为此需要for循环。对于 5 个交叉折叠。我得到，在第一个 f

1.  1st fold : 1 2 for test, 3:10 for train
2.  第二折：3 4 用于测试，1 2 5:10 用于火车
3.  第三折：5 6 用于测试，1:4 7:10 用于火车
4.  4th fold : 7 8 for test, 1:6 9:10 for train
5.  5th fold : 9 10 for test, 1:8 for train

以下代码是此过程的示例：

```
data = magic(10);
dataRowNumber = size(data,1);
labels= rand(dataRowNumber,1) > 0.5;
randomColumn = rand(dataRowNumber,1);

X = [ randomColumn data labels];

SortedData = sort(X,1);

crossValidationFolds = 5;
numberOfRowsPerFold = dataRowNumber / crossValidationFolds;

crossValidationTrainData = [];
crossValidationTestData = [];
for startOfRow = 1:numberOfRowsPerFold:dataRowNumber
    testRows = startOfRow:startOfRow+numberOfRowsPerFold-1;
    if (startOfRow == 1)
        trainRows = [max(testRows)+1:dataRowNumber];
        else
        trainRows = [1:startOfRow-1 max(testRows)+1:dataRowNumber];
    end
    crossValidationTrainData = [crossValidationTrainData ; SortedData(trainRows ,:)];
    crossValidationTestData = [crossValidationTestData ;SortedData(testRows ,:)];

end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T21:58:09.227

哈哈哈不好意思，没办法。我现在没有 MATLAB，所以无法检查代码是否有错误。但这是一般的想法：

1.  生成 k（在您的情况下为 10）子样本
    1.  从 1 开始两个计数器并预分配新矩阵：`index = 1; subsample = 1; newmat = zeros("150","6")`< 150 是样本数，6 = 4 个宽数据 + 1 个宽标签 + 1 我们稍后会使用
    2.  当您仍有数据时：`while ( length(labels) > 0 )`
    3.  在剩余数据量内生成一个随机数：`randNum = randi(length(labels))`? 我认为这是一个从 1 到标签数组大小的随机整数（它可能是 0，请检查文档 - 如果是，请做简单的数学运算使其 1 < rand < 长度）
    4.  将该行添加到带有标签的新数据集中：`newmat(index,:) = [data(randNum,:) labels(randNum) subsample]`< 最后一列是 1-10 的子样本编号
    5.  从数据和标签中删除行：`data(randNum,:) = []; same for labels`<注意这将从矩阵中物理删除一行，这就是为什么我们必须使用while循环并检查长度> 0而不是for循环和简单索引的原因
    6.  增量计数器：`index = index + 1; subsample = subsample + 1;`
    7.  如果 subsample = 11，则再次将其设为 1。

最后，您应该有一个看起来几乎与原始数据完全相同的大型数据矩阵，但随机分配了“折叠标签”。

1.  循环所有这些以及您的执行代码 k (10) 次。

编辑：以更易于访问的方式放置代码。注意它仍然是伪代码并且不完整！另外，您应该注意，这根本不是最有效的方法，但如果您不能使用 matlab 函数，也应该不会太糟糕。

```
for k = 1:10

index = 1; subsample = 1; newmat = zeros("150","6");
while ( length(labels) > 0 )
    randNum = randi(length(labels));
    newmat(index,:) = [data(randNum,:) labels(randNum) subsample];
    data(randNum,:) = []; same for labels
    index = index + 1; subsample = subsample + 1;
    if ( subsample == 11 )
        subsample = 1;
    end
end

% newmat is complete, now run code here using the sampled data 
%(ie pick a random number from 1:10 and use that as your validation fold. the rest for training

end 
```

* * *

编辑答案＃2：

好的另一种方法是创建一个与您的数据集一样长的向量

```
foldLabels = zeros("150",1); 
```

然后，循环那么长（150），将标签分配给随机索引！

```
foldL = 1;
numAssigned = 0;
while ( numAssigned < 150 )
    idx = randi(150);
    % no need to reassign a given label, so check if is still 0
    if ( foldLabels(idx) == 0 )
        foldLabels(idx) = foldL;
        numAssigned++; % not matlab code, just got lazy. you get it
        foldL++;
        if ( foldL > 10 )
            foldL = 1;
        end
    end
end 
```

* * *

编辑答案#2.5

```
foldLabels = zeros("150",1);
for i = 1:150
    notChosenLabels = [notChosenLabels i];
end
foldL = 1;
numAssigned = 0;
while ( length(notChosenLabels) > 0 )
    labIdx = randi(length(notChosenLabels));
    idx = notChosenLabels(labIdx);
    foldLabels(idx) = foldL;
    numAssigned++; % not matlab code, just got lazy. you get it
    foldL++;
    if ( foldL > 10 )
        foldL = 1;
    end
    notChosenLabels(labIdx) = [];
end 
```

* * *

编辑兰德珀姆

使用 randperm 生成索引

```
idxs = randperm(150); 
```

现在只需分配

```
foldLabels = zeros(150,1);
for i = 1:150
    foldLabels(idxs(i)) = sampleLabel;
    sampleLabel = sampleLabel + 1;
    if ( sampleLabel > 10 )
       sampleLabel = 1;
    end
end 
```

# imageview - 调整图像大小以适合父节点

> ID：12630296
> 
> 赞同：40
> 
> 时间：2012-09-27T21:30:00.757
> 
> 标签：imageview, javafx-2, scaling

如何在 ImageView 中获取图像以自动调整大小以使其始终适合父节点？

这是一个小代码示例：

```
@Override
public void start(Stage stage) throws Exception {
    BorderPane pane = new BorderPane();
    ImageView img = new ImageView("http://...");

    //didn't work for me:
    //img.fitWidthProperty().bind(new SimpleDoubleProperty(stage.getWidth())); 

    pane.setCenter(img);

    Scene scene = new Scene(pane);
    stage.setScene(scene);
    stage.show();
} 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-09-28T07:07:56.910

```
@Override
public void start(Stage stage) throws Exception {
    BorderPane pane = new BorderPane();
    ImageView img = new ImageView("http://...");

    img.fitWidthProperty().bind(stage.widthProperty()); 

    pane.setCenter(img);

    Scene scene = new Scene(pane);
    stage.setScene(scene);
    stage.show();
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-02-04T13:23:25.347

这是比绑定宽度属性更好的解决方案（更好，因为通常在将子项绑定到其容器时，可能无法使容器更小。在其他情况下，容器甚至可能会自动开始增长）。

下面的解决方案依赖于覆盖 ImageView，以便我们可以让它表现为“可调整大小”，然后提供最小、首选和最大宽度/高度的实现。同样重要的是实际实现 resize() 调用。

```
class WrappedImageView extends ImageView
{
    WrappedImageView()
    {
        setPreserveRatio(false);
    }

    @Override
    public double minWidth(double height)
    {
        return 40;
    }

    @Override
    public double prefWidth(double height)
    {
        Image I=getImage();
        if (I==null) return minWidth(height);
        return I.getWidth();
    }

    @Override
    public double maxWidth(double height)
    {
        return 16384;
    }

    @Override
    public double minHeight(double width)
    {
        return 40;
    }

    @Override
    public double prefHeight(double width)
    {
        Image I=getImage();
        if (I==null) return minHeight(width);
        return I.getHeight();
    }

    @Override
    public double maxHeight(double width)
    {
        return 16384;
    }

    @Override
    public boolean isResizable()
    {
        return true;
    }

    @Override
    public void resize(double width, double height)
    {
        setFitWidth(width);
        setFitHeight(height);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-16T15:13:55.583

使用 ScrollPane 或简单的 Pane 来解决这个问题：示例：

```
 img_view1.fitWidthProperty().bind(scrollpane_imageview1.widthProperty()); 
 img_view1.fitHeightProperty().bind(scrollpane_imageview1.heightProperty()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-24T18:50:01.533

如果您希望 ImageView 适合 Windows 框架，请使用以下代码行： **imageView.fitWidthProperty().bind(scene.widthProperty())。**

请注意，我使用的是场景的 widthProperty 而不是舞台。例子：

```
import java.io.FileNotFoundException;
import javafx.application.Application;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.image.ImageView;
import javafx.stage.Stage;

public class MapViewer extends Application {

    public static void main(String[] args) {
        Application.launch(args);
    }

    @Override
    public void start(Stage primaryStage) throws FileNotFoundException {
        String strTitle = "Titulo de la Ventana";
        int w_width = 800;
        int w_height = 412;
        primaryStage.setTitle(strTitle);
        primaryStage.setWidth(w_width);
        primaryStage.setHeight(w_height);

        Group root = new Group();
        Scene scene = new Scene(root);

        final ImageView imv = new ImageView("file:C:/Users/utp/Documents/1.2008.png");
        imv.fitWidthProperty().bind(scene.widthProperty());
        imv.setPreserveRatio(true);

        root.getChildren().add(imv);
        primaryStage.setScene(scene);
        primaryStage.show();

    }

} 
```

舞台（primaryStage）的宽高比应该与图像（1.2008.png）的宽高比相似

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-23T07:46:35.720

这是一种计算宽度的方法，用于去除滚动条的宽度。

第一的：
`myImageView.setPreserveRatio(true);`

监控滚动条宽度变化：

```
scrollPane.widthProperty().addListener((observable, oldValue, newValue) -> {
            myImageView.setFitWidth(newValue.doubleValue() - (oldValue.doubleValue() - scrollPane.getViewportBounds().getWidth()));
        }); 
```

滚动条宽度：
`oldValue.doubleValue() - scrollPane.getViewportBounds().getWidth()`

如何设置初始宽度？
后`primaryStage.show();`

`myImageView.setFitWidth(scrollPane.getViewportBounds().getWidth());`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-17T23:59:06.080

填充父级宽高比，这解决了父级高度和宽度不像图像那样处于适当比例时的问题。

```
Image image = new Image(getClass().getResource(%path%).toString());
double ratio = image.getWidth() / image.getHeight();
double width = stage.getScene().getWidth();

ImageView imageView.setImage(image);
imageView.setFitWidth(width);
imageView.setFitHeight(width/ratio);
imageView.setPreserveRatio(true); 
```

# c# - 如何检查字符串是否包含字符串数组中的字符串

> ID：12630305
> 
> 赞同：1
> 
> 时间：2012-09-27T21:30:48.560
> 
> 标签：c#, linq

**编辑：**顺序可能会改变，如您在下面的示例中所见，两个字符串具有相同的名称但顺序不同....

检查两个字符串数组是否匹配后，你会怎么做？

下面的代码返回 true 但实际上它应该返回 false 因为我在`_check`

我想要实现的是检查两个字符串数组是否具有相同数量的字符串。

```
string _exists  = "Adults,Men,Women,Boys";
string  _check = "Men,Women,Boys,Adults,fail";

if (_exists.All(s => _check.Contains(s))) //tried Equal 
{
  return true;
}
else
{
  return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:38:14.130

```
string _exists  = "Adults,Men,Women,Boys";
string  _check = "Men,Women,Boys,Adults,fail";

bool b = _exists.Split(',').OrderBy(s=>s)
                .SequenceEqual(_check.Split(',').OrderBy(s=>s)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T21:36:51.120

这些不是字符串数组，而是两个字符串。
因此，您实际上需要在检查内容相等性之前将它们拆分为子字符串。

你可以这样做：

```
string _exists = "Adults,Men,Women,Boys";
string _check = "Men,Women,Boys,Adults,fail";

var checks = _check.Split(',');
var exists = _exists.Split(',');

bool stringsEqual = checks.OrderBy(x => x).SequenceEqual(exists.OrderBy(x => x)); 
```

为了加快一些特殊情况，您可以在调用 LINQ 代码之前检查长度（在长度不同的情况下避免两个 OrderBy）。此外，为了节省内存，您可以在拆分数组上使用就地排序，即：

```
string _exists = "Adults,Men,Women,Boys";
string _check = "Men,Women,Boys,Adults,fail";

var checks = _check.Split(',');
var exists = _exists.Split(',');

if(checks.Length != exists.Length)
    return false;

Array.Sort(checks);
Array.Sort(exists);

if (checks.SequenceEqual(exists))
    return true;
return false; 
```

显然，这些优化仅在您的字符串非常长时才有用，否则您可以简单地使用 LINQ 单线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:42:10.167

首先，您需要拆分字符串以获取数组并对它们进行排序

```
var ary1 = _existing.Split(',').Trim().OrderBy(x => x);
var ary2 = _check.Split(',').Trim().OrderBy(x => x); 
```

现在您可以使用“SequenceEquals”来比较 Enumerables

```
var result = ary1.SequenceEquals(ary2); 
```

SeqenceEquals 比较位置和值，因此如果您还想检测位置变化，请移除 OrderBy。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T21:33:24.653

尝试

```
return (_exists.Length == _check.Length); 
```

这将检查字符串数组的长度是否相同，但不一定是相同的值。

如果要比较数组以查看它们是否完全相同，则需要先执行上述操作，然后很可能将数组按 AZ 顺序排序，然后比较每个元素

注意：这是不必要的...

```
if (_exists.All(s => _check.Contains(s))) //tried Equal 
{
  return true;
}
else
{
  return false;
} 
```

......你可以这样做，它更优雅......

```
return (_exists.All(s => _check.Contains(s))); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T21:39:40.883

如果您只想计算字符串，请尝试：

```
bool sameAmountOfStrings = _exists.Count(c => c.Equals(',')) == _check.Count(c => c.Equals(,)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T21:36:51.347

如果你想查看用逗号分隔的子字符串的数量是否相同，那么使用这个。

```
public bool StringsHaveSameNumberOfSubstring(string _exists, string _check)
{
     return (_exists.Split(',').Length == _check.Split(',').Length);
} 
```

这是我从你的问题中了解到的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T21:36:52.013

将字符串拆分为两个列表，然后使用 Linq to Objects 进行比较

```
string _exists  = "Adults,Men,Women,Boys";
string  _check = "Men,Women,Boys,Adults,fail";

List<string> exists = new List<string>(_exists.Split(new char[] { ',' }));
List<string> check = new List<string>(_check.Split(new char[] { ',' }));

foreach(string toCheck in check){
if(exists.Contains(toCheck)){
  //do things
}
} 
```

# ffmpeg - ffmpeg 无法识别的选项'segment_list_flags'

> ID：12630307
> 
> 赞同：3
> 
> 时间：2012-09-27T21:30:53.850
> 
> 标签：ffmpeg, streaming, segment

这是我第一次在这里发布问题，所以请耐心等待。我正在使用 Ubuntu 12.04 和 ffmpeg 版本 0.11.2，我正在尝试从 /dev/video0 捕获视频，对视频进行分段，然后创建一个列出所有分段的 m3u8 列表文件。根据[http://ffmpeg.org/ffmpeg.html#Synopsis](http://ffmpeg.org/ffmpeg.html#Synopsis)上的 ffmpeg 文档，ffmpeg 在创建像“-segment_list_flags”和“-segment_list_type”这样的列表文件时支持某些选项。但是，当我尝试在我的脚本中实现这些时，我只是收到一个错误消息：“无法识别的选项'segment_list_flags'”或“无法识别的选项'segment_list_type'”。我输入的实际命令如下所示：

```
 ffmpeg -f video4linux2 -s wvga -t ${CAPTURE_DURATION} -i "/dev/video0" \ 
  -vcodec ${VID_CODEC} -b:v 96k -flags +loop -cmp +chroma \
  -partitions +parti4x4+partp8x8+partb8x8 -subq 5 -trellis 1 -refs 1 -coder 0 \
  -me_range 16 -keyint_min 25 -sc_threshold 40 -map 0 -flags -global_header \
  -i_qfactor 0.71 -bt 200k -maxrate 96k -bufsize 96k -rc_eq 'blurCplx^(1-qComp)' \
  -qcomp 0.6 -qmin 10 -qmax 51 -qdiff 4 -level 30 -aspect 320:240 -g 30 \
  -async 2 -preset fast -crf 22 -threads 0 -sameq -f segment -segment_time ${SEG_TIME} \
  -segment_list ${LOCATE}${OUTPUT}_first.m3u8 -segment_list_flags +live \
  -segment_list_size ${SEG_LIST_SIZE} -segment_format ${SEG_FORMAT} -acodec libmp3lame \
  -ar 4800 -ab 64k -y "${LOCATE}${OUTPUT}%01d.${EXTENSION}" 
```

在我的脚本的其他部分，我显然已经定义了您看到的那些变量，并且它们都工作正常。我应该提一下，在我尝试实现 -segment_list_flags 选项之前，它确实输出了一个列表文件，但它不是 Http Live Streaming 所需的合法 .m3u8 列表文件。它只是按顺序列出了我告诉它创建的不同的 ${LOCATE}${OUPUT} 段。

我在终端中的命令的完整输出是这样的：

```
ffmpeg version 0.11.2 Copyright (c) 2000-2012 the FFmpeg developers
  built on Sep 27 2012 13:32:44 with gcc 4.6.3
  configuration: --enable-gpl --enable-gray --enable-runtime-cpudetect --enable-bzlib --enable-gnutls --enable-libass --enable-libcelt --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libcdio --enable-libdc1394 --enable-libfaac --enable-libfreetype --enable-libgsm --enable-libmodplug --enable-libmp3lame --enable-libnut --enable-libopenjpeg --enable-libpulse --enable-librtmp --enable-libschroedinger --enable-libspeex --enable-libtheora --enable-libv4l2 --enable-libvo-aacenc --enable-libvo-amrwbenc --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libxvid --enable-openal --enable-openssl --enable-zlib --enable-nonfree --enable-version3 --enable-x11grab

  libavutil      51\. 54.100 / 51\. 54.100
  libavcodec     54\. 23.100 / 54\. 23.100
  libavformat    54\.  6.100 / 54\.  6.100
  libavdevice    54\.  0.100 / 54\.  0.100
  libavfilter     2\. 77.100 /  2\. 77.100
  libswscale      2\.  1.100 /  2\.  1.100
  libswresample   0\. 15.100 /  0\. 15.100
  libpostproc    52\.  0.100 / 52\.  0.100

[video4linux2,v4l2 @ 0x30e1e80] The V4L2 driver changed the video from 852x480 to 640x480
[video4linux2,v4l2 @ 0x30e1e80] Estimating duration from bitrate, this may be inaccurate
Input #0, video4linux2,v4l2, from '/dev/video0':
  Duration: N/A, start: 10590.729975, bitrate: 110592 kb/s
    Stream #0:0: Video: rawvideo (I420 / 0x30323449), yuv420p, 640x480, 110592 kb/s, 30 tbr, 1000k tbn, 30 tbc
Unrecognized option 'segment_list_flags'
Failed to set value '+live' for option 'segment_list_flags' 
```

如果有人知道它为什么给我这个错误，如果你能帮忙，我真的很感激。也许我没有从 ./configure 启用某些选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:53:16.337

在线文档是从 FFmpeg git-master 生成的。因此，如果您使用的不是最新代码，那么您必须参考`ffmpeg -h`或`man ffmpeg`获取特定 ffmpeg 版本的文档。这就是为什么建议一般用户使用 git-master 而不是发行版的原因之一。这些发行版主要针对有强迫使用“发行版”的发行版。该`segment_list_flags`选项是[在不到 3 周前添加的](http://git.videolan.org/?p=ffmpeg.git;a=commit;h=00d516454c77a77d11c97099cba069030d82a7cb)，可能没有向后移植到 0.11.2。

对您的命令的一些建议：

*   不要使用`-sameq`. 请参阅[sameq 并不意味着“相同的质量”](https://superuser.com/a/478550/110524)。

*   不建议声明每个单独的 libx264 选项，并且已被该`-preset`选项折旧。此外，由于您已经在使用预设，因此额外声明这些可能导致损坏的选项是没有意义的。请参阅[FFmpeg 和 x264 编码指南](https://ffmpeg.org/trac/ffmpeg/wiki/x264EncodingGuide)。

*   FFmpeg 使用问题更适合于 superuser.com。

# drupal - Drupal 商务产品目录

> ID：12630310
> 
> 赞同：0
> 
> 时间：2012-09-27T21:31:08.860
> 
> 标签：drupal, drupal-7, taxonomy, drupal-taxonomy, drupal-commerce

我想创建一个产品目录页面，其中有两个部分，一侧将包含所有产品，另一侧将有过滤器来选择附加了特定分类术语的产品。

有什么办法可以实现这一点....我正在将drupal 7与drupal commerce一起使用

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T09:09:35.973

这与 Drupal 商务无关。

可以使用[视图](http://drupal.org/project/views)模块轻松完成。

1.  您可以创建一个页面显示，设置您要显示的所有字段。
2.  创建一个上下文过滤器，该过滤器将根据 url 中的分类术语进行过滤。
3.  创建您希望向用户显示的所有过滤器。
4.  确保选中“向用户公开”复选框以使其对最终用户可见。

你已准备好出发。如果您特别希望将过滤器与目录并排放置，请选择使用公开过滤器选项创建块的选项。然后相应地放置块[在您的块列表页面上可用]。

# jquery - jquery - 在 mouseenter 和 mouseleave 上切换脱节的 div？

> ID：12630312
> 
> 赞同：0
> 
> 时间：2012-09-27T21:31:14.707
> 
> 标签：jquery, mouseenter, mouseleave

我已经尝试搜索类似的问题并将这些回答用于我的情况，但要么我做错了（可能......），要么这不是我所需要的？

本质上，当悬停在#b-hover-nav 上时，我试图切换 .block-5。但是，我希望 .block-5 保持打开状态，以便用户可以阅读/与其中的链接进行交互......示例中的其他链接也是如此......

我已经发布在 jsfiddle (http://jsfiddle.net/9fcFv/) 上，但我也将其包括在下面：

```
#content {
     width: 400px;
    height: 400px;
}
span.button-hover-nav {
 display: block;
 clear: both;  
  width: 200px;    
    margin-bottom: 20px;
}
.left {
      width: 200px;
      float: left;
}
.block-5 {
     display: none;
    width: 200px;
    float: right;
}
.block-5 a {
     color: blue;
}
.block-6 {
     display: none;
    width: 200px;
    float: right;
}
.block-6 a {
     color: green;
}

​
<div class="body">
 <span class="button-hover-nav" id="b-hover-nav">Hover Me</span>
</div>

<div class="block-5">
<h1>Please stay open unless I leave...</h1>
<a link="#">Click Me</a>
</div>

//Totally does not work:
// Bind the mouse over /out to the first DIV.
            $('#b-hover-nav').live('mouseenter', function() {
        $('.block-5').show();
    }).live('mouseleave', function() {
        t = setTimeOut(function() {
            $('.block-5').hide();
        }, 100);
    });

    $('.block-5').live('mouseenter', function() {
        if(t) {
            clearTimeout(t);
            t=null;
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:50:49.663

您遇到的问题是由于在按钮上的 mouseout 事件触发之前用户没有时间将鼠标移到对象上。你需要给他们一点时间用鼠标到达那里。

另外，我更喜欢 jQuery 的内置悬停方法。但是如果你愿意，你可以使用绑定。

[JSFiddle](http://jsfiddle.net/9fcFv/9/)

```
var timer1,timer2;
var delay=1000;
$("#b-hover-nav").hover(function() {
    clearTimeout(timer1);
    $('.block-6').hide();
    $('.block-5').show();
}, function() {
    timer1= setTimeout(function() {
        $('.block-5').hide();
    }, delay);
});

$("#c-hover-nav").hover(function() {
    clearTimeout(timer2);
    $('.block-5').hide();
    $('.block-6').show();
}, function() {
    timer2= setTimeout(function() {
        $('.block-6').hide();
    }, delay);
});

$(".block-6").hover(function() {
    clearTimeout(timer2);
}, function() {
    timer2= setTimeout(function() {
        $('.block-6').hide();
    }, delay);
});

$(".block-5").hover(function() {
    clearTimeout(timer1);
}, function() {
    timer1= setTimeout(function() {
        $('.block-5').hide();
    }, 2000);
}); 
```

​</p>

# javascript - 为什么 url 加载不出来

> ID：12630318
> 
> 赞同：0
> 
> 时间：2012-09-27T21:31:31.137
> 
> 标签：javascript, jquery, html, jquery-ui

我有代码

```
<span id="urlWindow"  style="float:right;" value="http://www.mysite.com">Open Url</span> 
```

sizeUrl 的值为[http://www.mysite.com](http://www.mysite.com)

但以下代码未加载

```
var sizeUrl = $('#urlWindow').attr('value');

    newWindow.document.write(
        '<html>' +
            '<iframe src=" + sizeUrl + " width="100%" height="100%">'+

        '</iframe>' +

         '</html>' 
```

就像这个一样

```
 var sizeUrl = $('#urlWindow').attr('value');

            newWindow.document.write(
                '<html>' +
                    '<iframe src=" http://www.mysite.com "  width="100%" height="100%">'+

                '</iframe>' +

                 '</html>' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:33:44.610

```
'<iframe src="' + sizeUrl + '" width="100%" height="100%">' 
```

您没有破坏字符串以包含您的变量。

# modal-dialog - 模态窗口/对话框中的 JavaFX KeyEvent 处理

> ID：12630324
> 
> 赞同：0
> 
> 时间：2012-09-27T21:31:55.547
> 
> 标签：modal-dialog, javafx-2, keyevent

我试图让我的对话框接受`<Enter>`defaultButton 并`<ESC>`执行 cancelButton。

我有一些这样的代码：

```
dialog1 = new Stage(StageStyle.UNDECORATED);
dialog1.initModality(Modality.WINDOW_MODAL);
dialog1.initOwner(primaryStage);
dialog1.setScene(
  new Scene(
    HBoxBuilder.create().styleClass("modal-dialog").children(
      LabelBuilder.create().text("Tells user what to do...").build(),
      ButtonBuilder.create().text("Next step").defaultButton(true).onAction(new EventHandler<ActionEvent>() {
        @Override public void handle(ActionEvent actionEvent) {
          // take action and close the dialog1.
          // do "OK" actions here...
          dialog1.close();
        }
      }).build(),
      ButtonBuilder.create().text("Cancel").cancelButton(true).onAction(new EventHandler<ActionEvent>() {
        @Override public void handle(ActionEvent actionEvent) {
          // abort action and close dialog1.
          // do "CANCEL" actions here...
          dialog1.close();
        }
      }).build()
    ).build()
    , Color.TRANSPARENT
  )
);
dialog1.getScene().getStylesheets().add(getClass().getResource("ModalDialog.css").toExternalForm()); 
```

我想添加如下内容来处理键盘。*像这样简单*的事情可能吗？

```
.onAction(new EventHandler<KeyEvent>() {
  @Override public void handle(KeyEvent t) {
    if (t.getCode() == KeyCode.ENTER) {
      // do "OK" actions here
      dialog1.close();                    
    } else {
      // do "CANCEL" actions here
      dialog1.close();                    
    }
  }
}).build() 
```

我的问题是，我四处寻找一个“节点”来挂这个处理程序，但似乎找不到。像`TextInputBuilder`，或类似的东西。我也不知道语法的确切格式，即使 a`TextInputBuilder`是要创建的正确节点，所以如果你能告诉我调用应该采用的确切形式，那就太好了。

我猜是这样的：

```
dialog1.setScene(
  new Scene(
    HBoxBuilder.create().styleClass("modal-dialog").children(
      TextInputFieldBuilder.onAction(new EventHandler<KeyEvent>() {
        @Override public void handle(KeyEvent t) {
          if (t.getCode() == KeyCode.ENTER) {
            // do "OK" actions here
            dialog1.close();                    
          } else {
            // do "CANCEL" actions here
            dialog1.close();                    
          }
        }
      }).build(),
      LabelBuilder.create().text("Tells user what to do...").build(),
      // [ ... ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:12:54.610

> 我试图让我的对话框接受`<Enter>`defaultButton 并`<ESC>`执行 cancelButton。

这是[defaultButton](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Button.html#defaultButtonProperty)和[cancelButton](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Button.html#cancelButtonProperty)的默认行为，因此通常不需要额外的代码来执行此操作。

* * *

如果在不太可能发生的情况下，场景中的某些其他控件正在消耗或按下，并且您真的想要覆盖它：

1.  在场景中添加一个[过滤器](http://docs.oracle.com/javafx/2/api/javafx/scene/Scene.html#addEventFilter%28javafx.event.EventType,%20javafx.event.EventHandler%29)来捕获相关的[KeyEvent](http://docs.oracle.com/javafx/2/api/javafx/scene/input/KeyEvent.html)。
2.  收到后在相应按钮上调用[fire事件。](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ButtonBase.html#fire%28%29)
3.  [在通过调用 fire 处理事件后使用](http://docs.oracle.com/javafx/2/api/javafx/event/Event.html#consume%28%29)它，这样事件就不会被路由到按钮处理程序，从而导致事件可能被处理两次。

不要在已经为按钮定义的键事件处理程序中复制 ok/cancel 和对话框关闭的代码。

# bash - Bash：无法在 IF-THEN-ELSE-FI 中启动后台进程

> ID：12630325
> 
> 赞同：0
> 
> 时间：2012-09-27T21:32:01.960
> 
> 标签：bash, if-statement, background-process

我正在尝试创建一个简单的 bash 脚本，该脚本将从命令行启动应用程序并将 STDOUT 和 STDERR 输出重定向到 /dev/null。我还想包含在脚本失败时提供反馈的功能。

该脚本几乎可以工作，但我无法让应用程序在后台启动。我尝试过使用 nohup、disown、将 if 语句包装在 "(if...fi)&" 中、将 else 语句包装在 "{... ;}&" 中，但我尝试过的一切要么引入了新问题或根本没有工作。

有什么建议么？

这是我正在做的基本版本：

```
#!/bin/bash
read -p "Enter program name: " APP
if 
  $APP 2>&1 | grep -q "command not found"
then
  echo "That didn't work."
else
  $APP >/dev/null 2>&1 &  
fi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:40:12.707

好吧，您要启动应用程序两次，我认为第一个是挂起的应用程序，当您通过管道将其输出到 grep 来检查它是否存在时。您可能想做这样的事情[Check if a program exists from a Bash script](https://stackoverflow.com/questions/592620/check-if-a-program-exists-from-a-bash-script)先检查它是否存在，而不是启动应用程序。

# prolog - Prolog：访问从父规则读取

> ID：12630326
> 
> 赞同：3
> 
> 时间：2012-09-27T21:32:07.623
> 
> 标签：prolog

我想要一个在 SWI-Prolog 中读取用户输入数据的特定规则，例如：

```
process( ... ) :-
    % do_stuff
    read_values( ... ),
    % do_more_stuff with X and Y here.

read_values( ... ) :-
    write('Please enter X: '),        
    read(X),
    write('Please enter Y: '),        
    read(Y). 
```

那可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:40:03.433

好吧，您已经有了解决方案：

```
process :-
    % do_stuff
    read_values(A, B),
    % do_more_stuff with X and Y here
    atom_concat(A, B, C),
    writeln(C).

read_values(X, Y) :-
    write('Please enter X: '),        
    read(X),
    write('Please enter Y: '),        
    read(Y). 
```

示例运行：

```
?- process.
Please enter X: a.
Please enter Y: b.
ab
true. 
```

# c# - C# - 如果不支持 Windows Media Player，则会出错

> ID：12630327
> 
> 赞同：1
> 
> 时间：2012-09-27T21:32:15.657
> 
> 标签：c#, windows, media-player, wmp

我在我的 c# 项目中使用 Windows 媒体播放器（Interop.WMPLib.dll 和 AxInterop.WMPLib.dll）从服务器流式传输 mp3。唯一的问题是，如果 pc 上不支持 windows 媒体播放器（未安装或其他），我的应用程序只会给出一个错误（没有例外，只是一个“windows-error”）并且不会启动。

那么，是否可以检查是否支持 windows 媒体播放器？仅检查操作系统是否受支持可能无济于事。

是否有比使用 WMP 更好的流式传输 mp3 的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:36:05.253

查看键`HKLM\Software\Microsoft\Active Setup\Installed Components\{22d6f312-b0f6-11d0-94ab-0080c74c7e95}`OR下的 IsInstalled 值`HKLM\Software\Microsoft\MediaPlayer\`。如果已安装，则为 1。

或者如果您不想依赖 WMP，请尝试使用第三方播放器。VLC 还支持许多编解码器。

[http://wiki.videolan.org/.Net_Interface_to_VLC](http://wiki.videolan.org/.Net_Interface_to_VLC)
[http://vlcdotnet.codeplex.com/](http://vlcdotnet.codeplex.com/)
[http://www.codeproject.com/Articles/109639/nVLC](http://www.codeproject.com/Articles/109639/nVLC)
[http://sourceforge.net/projects/libvlcnet/](http://sourceforge.net/projects/libvlcnet/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T13:03:09.180

I would like to extend this question one leve higher and solve absence of media player programatically because its unnecessary part of my solution. If interested please check [https://stackoverflow.com/questions/17103532/optional-use-of-embed-wmp-on-windows-server](https://stackoverflow.com/questions/17103532/optional-use-of-embed-wmp-on-windows-server)

# javascript - jquery e.preventDefault 停止循环

> ID：12630328
> 
> 赞同：0
> 
> 时间：2012-09-27T21:32:17.683
> 
> 标签：javascript, jquery, html, css, events

我对以下代码有疑问：

```
function KeyCheck(e) {

            // ... Some Code

    for (var i = 0; i < length; i++) { 
        width = elements[i].offsetWidth;

        if(width > 245) {
            e.preventDefault();
        }
    }   
} 
```

如您所见，我有一个循环，我只希望小于 245px 的元素使事件起作用，而大于 245px 的元素则不起作用。

问题 - 当 if '遇到' 一个宽度小于 245px 的元素时，它会停止循环，我认为它也会退出函数......

我该怎么做才能继续循环，只有宽度小于 245px 的元素才能使事件正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:37:56.127

代码原样将继续循环直到循环结束，除非`preventDefault`未定义`e`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:02:29.187

这是你想要做的吗？： http: [//jsfiddle.net/D2xhz/](http://jsfiddle.net/D2xhz/)

```
$("input").keydown(function(e){
    if ($(this).width() > 245)
        e.preventDefault();
});​ 
```

底部的两个输入不能输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:03:19.497

e.preventDefault(); 应该使用事件回调函数来保留你的默认事件，即表单提交。

在你的情况下，你应该为 div small 145px 执行一些操作

# mysql - MySQL - 优化孤立记录梳理

> ID：12630329
> 
> 赞同：0
> 
> 时间：2012-09-27T21:32:18.983
> 
> 标签：mysql, stored-procedures, while-loop, delete-row

所以这是我的问题，我写了一个存储过程来完成以下任务。在表格中`events`，有些活动可能存在于不再存在的场所。并非所有事件都与场地相关联，但那些在场地 id 字段中具有整数值的事件，否则为 NULL（或可能为零，但已考虑在内）。场地会定期从我们的系统中删除，当发生这种情况时，不可能在该确切时间删除与该场地相关的所有事件。相反，稍后会定期运行一个任务，该任务会删除具有不再引用场所表中现有记录的场所 id 的每个事件。我为此编写了一个存储过程，它似乎可以工作。

这是存储过程：

```
DROP PROCEDURE IF EXISTS delete_synced_events_orphans;
DELIMITER $$
CREATE PROCEDURE delete_synced_events_orphans()
BEGIN 

    DECLARE event_count int(11) DEFAULT 0;
    DECLARE active_event_id int(11) DEFAULT 0;
    DECLARE active_venue_id int(11) DEFAULT 0;
    DECLARE event_to_delete_id int(11) DEFAULT NULL;

    CREATE TEMPORARY TABLE IF NOT EXISTS possible_events_to_delete (
        event_id int(11) NOT NULL,
        venue_id_temp int(11) NOT NULL
    ) engine = memory;

    # create an "array" which is a table that holds the events that might need deleting
    INSERT INTO possible_events_to_delete (event_id, venue_id_temp) SELECT `events`.`id`, `events`.`venue_id` FROM `events` WHERE `events`.`venue_id` IS NOT NULL AND `events`.`venue_id` <> 0;
    SELECT COUNT(*) INTO `event_count` FROM `possible_events_to_delete` WHERE 1;

    detector_loop: WHILE `event_count` > 0 DO
        SELECT event_id INTO active_event_id FROM possible_events_to_delete WHERE 1 LIMIT 1;
        SELECT venue_id_temp INTO active_venue_id FROM possible_events_to_delete WHERE 1 LIMIT 1;

        # this figures out if there are events that need to be deleted
        SELECT `events`.`id` INTO event_to_delete_id FROM `events`, `venues` WHERE `events`.`venue_id` <> `venues`.`id` AND `events`.`id` = active_event_id AND `events`.`venue_id` = active_venue_id;

        #if no record meets that query, the active event is safe to delete
        IF (event_to_delete_id <> 0 AND event_to_delete_id IS NOT NULL) THEN
            DELETE FROM `events` WHERE `events`.`id` = event_to_delete_id;
            #INSERT INTO test_table (event_id_test, venue_id_temp_test) SELECT `events`.`id`, `events`.`venue_id` FROM `events` WHERE `events`.`id` =  event_to_delete_id;
        END IF;

        DELETE FROM possible_events_to_delete WHERE `event_id` = active_event_id AND `venue_id_temp` = active_venue_id;
        SET `event_count` = `event_count` - 1;

    END WHILE;

END $$
DELIMITER ; 
```

这是有问题的两个表的表结构：

```
CREATE TABLE IF NOT EXISTS events (
    id int(11) NOT NULL,
    event_time timestamp NOT NULL,
    venue_id_temp int(11) NOT NULL
);

CREATE TABLE IF NOT EXISTS venues (
    event_id int(11) NOT NULL,
    venue_id_temp int(11) NOT NULL
); 
```

存储过程按编写的方式工作，但我想知道如何使它运行得更好。似乎它做了很多额外的处理来实现它的目标。是否有更好的方法可以查询手头的数据，或者是否有其他更有用的命令和关键字我可以使用但我不知道，这将使我能够更好地完成这项任务（更少的行更少的计算）。我仍在学习如何使用存储过程，所以我尽可能实用地使用它们来完成任务，我想了解如何进行这个特定的查询，以更好地利用 MySQL 中的全部功能来发挥它的优势。谢谢各位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T16:07:24.723

一切都简单得多：

```
DROP PROCEDURE IF EXISTS delete_synced_events_orphans;
DELIMITER $$
CREATE PROCEDURE delete_synced_events_orphans()
BEGIN 

  DELETE
    FROM `events`
    WHERE `venue_id` IS NOT NULL AND `venue_id` <> 0
      AND `venue_id` NOT IN (SELECT `id` FROM `venues`)
  ;

END $$
DELIMITER ; 
```

而已。:)

你思考命令式的，试图告诉 MySQL*如何*完成你的任务。但是 SQL 是一种声明性语言，旨在说明*要做*什么。

# javascript - 用javascript查找和替换多个单词

> ID：12630333
> 
> 赞同：-2
> 
> 时间：2012-09-27T21:32:51.927
> 
> 标签：javascript, jquery

我正在寻找一种使用 javascript 在句子中查找和替换多个单词的方法。理想情况下，我想取一个句子并替换该句子中的多个单词，即

文字**WORD 1**文字 | 文字**WORD 2**文字

如何用独立的不同单词替换 WORD1 和 WORD2？

IE

WORD1= 新词-1

WORD2= 新词 2

这是代码：

[js小提琴代码点击这里](http://jsfiddle.net/yaaf8/)

为了更进一步，我想从 excel 表中提取新单词值，用要替换的新单词运行一个循环，并将新句子的输出全部放在一页上。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:37:36.063

我修改了你的[jsfiddle](http://jsfiddle.net/yaaf8/1/)。在替换中，您可以将函数作为第二个参数传递。在函数内部，您可以决定特定单词的替换值。

```
var visitorName = "new word 1";
var myOldString = "Hello word1! I hope you enjoy your stay word2.";
var myNewString = myOldString.replace(/word1|word2/g, function(w){

        switch(w){
           case 'word1':
                 return visitorName ;

              case 'word2':
                   return 'new word 1';
          }

    }); 
```

# mysql - MySQL：生成汇总列而不折叠任何行

> ID：12630340
> 
> 赞同：3
> 
> 时间：2012-09-27T21:33:28.433
> 
> 标签：mysql, sql

假设我有一个这样的 SQL 表：

```
UniqueID  Word
1         apple
2         orange
3         banana
4         apple 
```

我想将哈希键创建为整数。该整数应该映射到特定的单词。为了使键具有某种意义，我希望该数字是单词第一次出现的 UniqueID。这意味着我想生成这样的表：

```
Unique ID  Word    WordHash
1          apple   1
2          orange  2
3          banana  3
4          apple   1 
```

我尝试使用 group by 语句以及 min(unique id)，但这摆脱了最后一个苹果行。我想保留那一排。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:36:59.700

```
SELECT t.UniqueID, t.Word, q.MinID AS WordHash
    FROM YourTable t
        INNER JOIN (SELECT Word, MIN(UniqueID) AS MinID
                        FROM YourTable
                        GROUP BY Word) q
            ON t.Word = q.Word 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:46:46.250

如果您想在原始表中创建新列，而不仅仅是获取结果集：

```
update 
    t 
    inner join (
        select Word, min(UniqueID) as id
        from t
        group by Word
    ) s on t.Word = s.Word    
set t.WordHash = s.id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T21:55:22.517

您需要执行以下查询

```
ALTER TABLE <table_name> ADD COLUMN `WordHash` INT NULL AFTER `Word`;

UPDATE <table_name> t INNER JOIN 
    (SELECT `word`, MIN(uniqueId) AS MinID FROM <table_name> GROUP BY `word`) q 
     ON t.word = q.word 
     SET WordHash = q.MinID; 
```

希望能帮助到你...

# javascript - 使用 input type="submit" 更改内容

> ID：12630342
> 
> 赞同：0
> 
> 时间：2012-09-27T21:33:30.117
> 
> 标签：javascript, html, submit

好的，我很确定我在这里遗漏了一些非常明显的东西，但到目前为止我找不到合适的解决方案。我想做的很简单：让用户在表单中写一些东西，让他提交表单，然后将该输入写入同一页面上的文本区域。

这是我的代码：

```
<html><head></head>
<body>
<form name='registration'>
<label for="input">Input:</label>
<input type="text" id="input"/>
<input type="submit" id="submit" value="Submit" onclick="execute()"/>
</form>

<div id="results">
<span>Result</span>
<span><textarea cols="30" rows="5" id="resulttext" readonly="readonly"></textarea> </span>
</div>

<script>
function execute()
{
    var result = document.getElementById("input").value

    document.getElementById("resulttext").value=result;
}
</script>

</body>
</html> 
```

现在，如果我在表单中输入一些内容会发生什么，textarea 会在恢复为不显示任何内容之前短暂显示我的输入。我的猜测是 textarea 字段仅在 execute() 函数期间更改。

当我更改`input type="submit"`为 a时，`<button>`一切都按预期工作，但我很确定我不应该那样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:36:08.840

您需要取消提交按钮的默认事件，否则它只会提交表单（在这种情况下，本质上是重新加载页面，因为没有带有名称的表单元素）。添加`return false;`之后`execute()`（`;`在两部分之间添加一个）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:39:39.337

因为你的按钮是 type `submit`，所以它会在执行`execute()`方法后提交你的表单。您可以将按钮类型更改为`type="button"`，您将不会有此提交行为。

[http://jsfiddle.net/PCCbh/](http://jsfiddle.net/PCCbh/)

注意 -`<button>`在这种情况下使用是可以的。它本质上与`<input type="button"`.

# php - 递归创建树数组时出错

> ID：12630343
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:33:37.703
> 
> 标签：php, recursion, tree

我试图递归地创建一个树数组，但它向我显示了一个冗余错误，代码是

```
private function printChildQuestions($parentid, $level=0) {
    $categorias = Categoria::model()->findAll("id_pai =".$parentid );

        foreach($categorias as $c){

            $space = str_repeat(' -&nbsp &nbsp ', $level);

            $flag=0;
            foreach($c->produtos as $p){

                $GLOBALS['children'][] = array("data" => $p->nome,"metadata" => array( "id" => $p->id ) );

                $flag=1;    
            }
            if($flag == 1){
                $GLOBALS['arvore'][] = array("data" => $c->nome,"metadata" => array( "id" => $c->id ) ,"children" => $GLOBALS['children'] );
            }

            $GLOBALS['arvore'][] = array("data" => $c->nome,"metadata" => array( "id" => $c->id ) );

            unset($GLOBALS['children']);
            $this->printChildQuestions($c->id,$level+1);
        }

} 
```

函数的调用是 $this->printChildQuestions(0);

它返回我这些值：

```
produtos       ---- ok 
  produto1     ---- ok 
produtos       ---- wrong line , repeated 1st line
subprodutos    ---- ok
  produto 2    ---- ok
subprodutos    ---- wrong line , repeated 4th line
subsubprodutos ---- ok
  produr 3     ---- ok
  produto 3.2  ---- ok
subsubprodutos ---- wrong line, repeated 7th line
produtos3.1    ---- ok
produto 2.2    ---- ok
produtos1.2    ---- ok 
```

正确的是

```
produtos       ---- ok 
  produto1     ---- ok 
subprodutos    ---- ok
  produto 2    ---- ok
subsubprodutos ---- ok
  produr 3     ---- ok
  produto 3.2  ---- ok
produtos3.1    ---- ok
produto 2.2    ---- ok
produtos1.2    ---- ok 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:41:18.753

如果在第一层（第 0 级）中你重复了第一行，那就`$categorias = Categoria::model()->findAll("id_pai =".$parentid );`应该归咎于第一行。对于 parentid = 0 它给你重复。

# c# - 在C#中搜索字符串中每个单词的前几个字符

> ID：12630347
> 
> 赞同：2
> 
> 时间：2012-09-27T21:33:47.150
> 
> 标签：c#, wordsearch

我是编程语言的新手。我有一个要求，我必须根据搜索字符串返回记录。

例如，取以下三个记录和一个搜索字符串“Cal”：

1.  加州大学

2.  帕斯卡学院

3.  加州大学

我试过`String.Contains`了，但是三个都被退回了。如果我使用`String.StartsWith`，我只会得到记录#3。我的要求是在结果中返回#1 和#3。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:37:26.650

如果您使用的是 .NET 3.5 或更高版本，我建议您使用[LINQ](http://msdn.microsoft.com/en-us/library/bb397926.aspx) [扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。签出[`String.Split`](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)和[`Enumerable.Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)。就像是：

```
string myString = "University of California";
bool included = myString.Split(' ').Any(w => w.StartsWith("Cal")); 
```

`Split`除以`myString`空格字符并返回一个字符串数组。`Any`在数组上工作，如果任何字符串以 . 开头，则返回 true `"Cal"`。

如果您不想或不能使用`Any`，则必须手动遍历单词。

```
string myString = "University of California";
bool included = false;

foreach (string word in myString.Split(' '))
{
    if (word.StartsWith("Cal"))
    {
        included = true;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T21:45:59.470

为了简单起见，我喜欢这个：

```
if(str.StartsWith("Cal") || str.Contains(" Cal")){
    //do something
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T21:36:30.613

你可以试试：

```
foreach(var str in stringInQuestion.Split(' '))
{
  if(str.StartsWith("Cal"))
   {
      //do something
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T21:46:28.260

您可以使用正则表达式来查找匹配项。这是一个例子

```
 //array of strings to check
    String[] strs = {"University of California", "Pascal Institute", "California University"};
    //create the regular expression to look for 
    Regex regex = new Regex(@"Cal\w*");
    //create a list to hold the matches
    List<String> myMatches = new List<String>();
    //loop through the strings
    foreach (String s in strs)
    {   //check for a match
        if (regex.Match(s).Success)
        {   //add to the list
            myMatches.Add(s);
        }
    }

    //loop through the list and present the matches one at a time in a message box
    foreach (String matchItem in myMatches)
    {
            MessageBox.Show(matchItem + " was a match");
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T23:05:41.327

```
 string univOfCal = "University of California";
        string pascalInst = "Pascal Institute";
        string calUniv = "California University";

        string[] arrayofStrings = new string[] 
        {
        univOfCal, pascalInst, calUniv
        };

        string wordToMatch = "Cal";
        foreach (string i in arrayofStrings)
        {

            if (i.Contains(wordToMatch)){

             Console.Write(i + "\n");
            }
        }
        Console.ReadLine();
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T23:12:24.910

```
var strings = new List<string> { "University of California", "Pascal Institute", "California University" };
var matches = strings.Where(s => s.Split(' ').Any(x => x.StartsWith("Cal")));

foreach (var match in matches)
{
    Console.WriteLine(match);
} 
```

输出：

```
University of California
California University 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T23:15:03.593

这实际上是正则表达式的一个很好的用例。

```
string[] words = 
{ 
    "University of California",
    "Pascal Institute",
    "California University"
}

var expr = @"\bcal";
var opts = RegexOptions.IgnoreCase;
var matches = words.Where(x => 
    Regex.IsMatch(x, expr, opts)).ToArray(); 
```

"\b" 匹配任何单词边界（标点符号、空格等）。

# powershell - 远程锁定工作站不起作用，为什么？

> ID：12630348
> 
> 赞同：1
> 
> 时间：2012-09-27T21:33:56.010
> 
> 标签：powershell, powershell-2.0

大约一年前，我发现了[这个 PowerShell 脚本](http://gallery.technet.microsoft.com/scriptcenter/cfbc642e-9a1e-4739-9ac5-9f462343a2f7)：

```
Function Lock-Workstation 
{ 
param( 
$Computername, 
$Credential 
) 
    if(!(get-module taskscheduler)){Import-Module TaskScheduler} 
    New-task -ComputerName $Computername -credential:$Credential |  
    Add-TaskTrigger -In (New-TimeSpan -Seconds 30) | 
    Add-TaskAction -Script ` 
    {  
    $signature = @"  
    [DllImport("user32.dll", SetLastError = true)]  
    public static extern bool LockWorkStation();  
"@  
    $LockWorkStation = Add-Type -memberDefinition $signature ` 
                                -name "Win32LockWorkStation" ` 
                                -namespace Win32Functions ` 
                                -passthru  
    $LockWorkStation::LockWorkStation() | Out-Null 
    } | Register-ScheduledTask TestTask -ComputerName $Computername ` 
                                        -credential:$Credential 
} 
```

我无法让它工作。我收到各种奇怪的错误。它以关于无法找到终止“@”的错误开始，一旦我得到修复，它就会开始在 TaskScheduler 模块中抛出错误，特别是它无法加载类型 [__ComObject] （在几个 TaskScheduler脚本，我找不到任何文档）。

我试图让这个在 PowerShell v2 中工作。

有人有什么想法吗？

编辑1：

所以我做了一些更多的测试，它似乎在技术上是有效的（TaskScheduler 模块中有一个错字导致它完全失败），但是尽管任务被安排在远程工作站上，但它的执行任务失败，有点。尽管拥有当前登录用户的凭据，但任务通常会“运行”但没有结果。

编辑2：否决票？真的吗？我遇到了问题，我已经描述了我遇到的错误，而不是提供建议您否决了这个问题？这是什么，Reddit？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:28:07.023

目前无法测试您的代码，但您可能希望使用更简单的方法（未测试）：

```
... | Add-TaskAction -Script { rundll32.exe user32.dll,LockWorkStation } 
```

# c# - 检查事件的来源

> ID：12630351
> 
> 赞同：1
> 
> 时间：2012-09-27T21:34:08.967
> 
> 标签：c#, event-handling, .net-2.0

我有一个将事件发送到 UI 的外部设备，并据此更改 UI。我也可以更改 UI 可以将数据发送回设备。问题是当设备发送更新时，我需要以编程方式更改组合框的索引，但是当我这样做时，SelectedIndexChanged 事件会触发。我只希望当我从 UI 本身更改 ComboBox 时触发该事件，而不是以编程方式。

**编辑**

```
 if (index > 0 && index < cboHeatPoints.Items.Count)
            {
                //cboHeatPoints.SelectedIndex = index;
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:51:12.350

使用[`SelectionChangeCommitted`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectionchangecommitted.aspx)而不是`SelectedIndexChanged`.

# javascript - 如果小于父容器，则将所有图像居中

> ID：12630353
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:34:16.197
> 
> 标签：javascript, jquery, html, css, smooth-scrolling

如果我有足够的图像，我的代码可以正常工作：它可以滚动并且一切都很好。

但是，如果图像的组合宽度小于父 div 的宽度，则它不会滚动（如预期的那样），但所有图像都向左对齐。

如何使它们与中心对齐？

我很确定这很容易，但我找不到解决方案。

如果有人可以提供帮助，我将不胜感激。

谢谢凯

它适用于这个插件：[http ://www.smoothdivscroll.com/](http://www.smoothdivscroll.com/)

我的 CSS 看起来像这样

```
#makeMeScrollable
    {
        width:100%;
        height: 55px;
        position: relative;
        margin: 20px 0; 
    }
#makeMeScrollable div.scrollableArea img, #makeMeScrollable div.scrollableArea a
{
position: relative;
float: left;
margin: 0 10px;
padding: 0;

filter: url(stylesheets/filters.svg#grayscale); /* Firefox 3.5+ */ 
filter: gray; /* IE6-9 */ 
-webkit-filter: grayscale(1); /* Google Chrome & Safari 6+ */

/* If you don't want the images in the scroller to be selectable, try the following
    block of code. It's just a nice feature that prevent the images from
    accidentally becoming selected/inverted when the user interacts with the scroller. */
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-o-user-select: none;
user-select: none;
}
#makeMeScrollable div.scrollableArea img:hover, #makeMeScrollable div.scrollableArea a:hover
{
filter: none; 
-webkit-filter: grayscale(0); 
} 
```

html是：

```
<div id = "makeMeScrollable">
            <img src = "images/test.png"
               id = "1" />

            <img src = "images/test2.png"
               id = "2" />
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:51:18.843

尝试`margin:auto`您的图像，因为这将使块级元素居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:12:03.643

尝试这个

```
<div style="display:table-cell; vertical-align:middle; text-align:center">
<img src="img.png">
</div> 
```

# ruby-on-rails - Rails：使用什么列类型来保存上传的图像？

> ID：12630358
> 
> 赞同：3
> 
> 时间：2012-09-27T21:34:37.247
> 
> 标签：ruby-on-rails

这是我的第一个 Rails 项目。我对如何将图像文件保存在数据库中感到有些困惑，因为它们占用了大量空间。我的网站将成为人们上传大量图片的地方。在创建图片表的迁移中，我会将图像文件名保存为字符串吗？还有人有关于在哪里保存图像（资产、公共等）的提示吗？

对不起，我只是一个菜鸟，寻求一点指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:41:52.370

您应该考虑将图像存储在 Amazon 的 S3（或类似的替代方案）而不是数据库上。您可以使用像[回形针](https://github.com/thoughtbot/paperclip)这样的 gem来帮助您上传到远程存储服务器。

但是，如果您确实想将二进制图像数据存储在数据库中，那么您可能希望使用“blob”作为列数据类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:20:13.107

您也可以使用[carrierwave](https://github.com/jnicklas/carrierwave)。只需创建一个字符串列并在其上安装一个上传器。

Blob 只应在特殊情况下使用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:47:38.397

您将图像保存为服务器或云上的存储系统上的文件。然后，您在表中创建一条记录及其路径。

不要为 byte\BOLB 存储图像字节。

# ios - iOS 6：如何将某些视图限制为纵向并允许其他视图旋转？

> ID：12630359
> 
> 赞同：100
> 
> 时间：2012-09-27T21:34:45.140
> 
> 标签：ios, iphone, ios6, autorotate

我有一个 iPhone 应用程序，它使用 a`UINavigationController`来呈现向下钻取界面：首先是一个视图，然后是另一个视图，最多四层深度。我希望将前三个视图限制为纵向，并且只允许最后一个视图旋转到横向。当从第四个视图返回到第三个视图并且第四个视图处于横向时，我希望所有内容都旋转回纵向。

在 iOS 5`shouldAutorotateToInterfaceOrientation:`中，我只是在每个视图控制器中定义为允许的方向返回 YES。一切都如上所述，包括从视图控制器 #4 返回到 #3 时，即使设备处于横向状态，也可以返回纵向。

在 iOS 6 中，所有视图控制器都旋转为横向，破坏了那些不应该这样做的。iOS 6 发行说明说

> 更多的责任正在转移到应用程序和应用程序委托身上。现在，iOS 容器（例如`UINavigationController`）不会咨询它们的子容器来确定它们是否应该自动旋转。[...] 每当设备旋转或视图控制器以全屏模式呈现样式呈现时，系统都会向最顶层的全屏视图控制器（通常是根视图控制器）询问其支持的界面方向。此外，仅当此视图控制器从其`shouldAutorotate`方法返回 YES 时才会检索支持的方向。`supportedInterfaceOrientationsForWindow:`[...] 系统通过将应用程序的方法返回的值与`supportedInterfaceOrientations`最顶层全屏控制器的方法返回的值相交来确定是否支持方向。

所以我进行了子类化`UINavigationController`，给了我`MainNavigationController`一个布尔属性`landscapeOK`并用它来返回允许的方向`supportedInterfaceOrientations`。然后在我的每个视图控制器的`viewWillAppear:`方法中，我都有这样的一行

```
 [(MainNavigationController*)[self navigationController] setLandscapeOK:YES]; 
```

告诉我`MainNavigationController`想要的行为。

**问题来了：**如果我现在以纵向模式导航到我的第四个视图并将手机翻过来，它会旋转到横向。现在我按下后退按钮返回到我的第三个视图，该视图应该只用于纵向。但它不会旋转回来。我如何让它做到这一点？

我试过了

```
 [[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait] 
```

在`viewWillAppear`我的第三个视图控制器的方法中，但它什么也没做。这是错误的调用方法还是错误的调用位置，或者我应该以完全不同的方式实现整个事情？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-10-26T16:25:18.563

我遇到了同样的问题，并找到了适合我的解决方案。为了使它工作，在你的 UINavigationController中实现是不够*的。*`- (NSUInteger)supportedInterfaceOrientations`您还需要在控制器#3 中实现此方法，这是弹出控制器#4 后第一个仅显示纵向的方法。所以，我的 UINavigationController 中有以下代码：

```
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    if (self.isLandscapeOK) {
        // for iPhone, you could also return UIInterfaceOrientationMaskAllButUpsideDown
        return UIInterfaceOrientationMaskAll;
    }
    return UIInterfaceOrientationMaskPortrait;
} 
```

在视图控制器 #3 中，添加以下内容：

```
- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
} 
```

您不需要向视图控制器#1、#2 和#4 添加任何内容。这对我有用，我希望它会帮助你。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-11-02T11:52:45.647

添加一个**自定义导航控制器**

覆盖其中的这些方法：

```
-(BOOL)shouldAutorotate
{
    return [[self.viewControllers lastObject] shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [[self.viewControllers lastObject] preferredInterfaceOrientationForPresentation];
} 
```

现在在 plist 中添加所有方向

![在此处输入图像描述](../Images/5084f07b5a11cbf44b338115a0f20afe.png)

在视图控制器中只添加所需的：

```
-(BOOL)shouldAutorotate
{
    return YES;
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
} 
```

这些方法覆盖导航控制器方法

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-22T16:53:06.183

在查看了关于 SO 的无数类似问题中的每个答案之后，没有一个答案对我有用，但它们确实给了我一些想法。这是我最终解决问题的方法：

首先，确保项目目标中支持的界面方向包含旋转视图所需的所有方向。

![在此处输入图像描述](../Images/f0c2f337c7b52fb0142972b978f352e3.png)

接下来，创建一个类别`UINavigationController`（因为 Apple 说不要对其进行子类化）：

```
@implementation UINavigationController (iOS6AutorotationFix)

-(BOOL)shouldAutorotate {
    return [self.topViewController shouldAutorotate];
}

@end 
```

将该类别和您希望能够旋转的视图控制器（我将称之为`RotatingViewController`）导入您的最高级别视图控制器，该控制器应包含您的导航控制器。在该视图控制器中，实现`shouldAutorotate`如下。请注意，这不应与您要旋转的视图控制器相同。

```
-(BOOL)shouldAutorotate {

    BOOL shouldRotate = NO;

    if ([navigationController.topViewController isMemberOfClass:[RotatingViewController class]] ) {
        shouldRotate = [navigationController.topViewController shouldAutorotate];
    }

    return shouldRotate;
} 
```

最后，在您的,中`RotatingViewController`实现如下：`shouldAutorotate``supportedInterfaceOrientations`

```
-(BOOL)shouldAutorotate {
    // Preparations to rotate view go here
    return YES;
}

-(NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskAllButUpsideDown; // or however you want to rotate
} 
```

您需要这样做的原因是因为 iOS 6 将旋转控制权交给了根视图控制器，而不是顶视图控制器。如果您希望单个视图的旋转行为与堆栈中的其他视图不同，则需要在根视图控制器中为其编写特定案例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-25T15:48:49.487

我没有足够的声誉来评论@Brian 的答案，所以我会在这里添加我的注释。

Brian 提到 iOS6 为 rootViewController 提供了旋转控制 - 这不仅可以是上面提到的 UINavigationController，还可以是 UITabBarController，它是为我设计的。我的结构如下所示：

*   UITabBarController
    *   UINavigationController
        *   UIViewControllers ...
    *   UINavigationController
        *   UIViewControllers ...

所以我首先在自定义 UITabBarController 中添加方法，然后在自定义 UINavigationController 中，最后在特定 UIViewController 中添加方法。

来自 UITabBarController 和 UINavigationController 的示例：

```
- (BOOL)shouldAutorotate {
    return [self.viewControllers.lastObject shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations {
    return [self.viewControllers.lastObject supportedInterfaceOrientations];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation {
    return [self.viewControllers.lastObject shouldAutorotateToInterfaceOrientation:toInterfaceOrientation];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation {
    return [self.viewControllers.lastObject preferredInterfaceOrientationForPresentation];
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-29T11:13:02.857

我想对我自己的问题给出部分答案。我发现在`viewWillAppear`我的第三个方法中使用的以下代码行`UIViewController`可以工作：

```
[[UIDevice currentDevice] 
      performSelector:NSSelectorFromString(@"setOrientation:") 
           withObject:(id)UIInterfaceOrientationPortrait]; 
```

但我真的不喜欢这个解决方案。它使用一种技巧来分配只读属性，根据 Apple 文档，该属性表示设备的**物理**方向。这就像告诉 iPhone 跳转到用户手中的正确方向。

我很想把它留在我的应用程序中，因为它很简单。但这感觉不对，所以我想把这个问题留给一个干净的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-22T13:04:35.900

这是我在 ios 6.0 中用于方向支持的

```
-(BOOL)shouldAutorotate{
    return YES;
}  

 - (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskAll;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{  
  return UIInterfaceOrientationPortrait;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-20T07:44:49.163

因为这是一个高度关注的线程。我想我会添加我认为最简单的答案。这适用于 ios8 及更高版本

```
-(BOOL)shouldAutorotate
{
    return YES;
} 
```

和

```
-(UIInterfaceOrientationMask)supportedInterfaceOrientations{
return UIInterfaceOrientationMaskPortrait;
} 
```

而已。享受！

哦，我的 ViewController 嵌入在导航控制器中，我不需要以任何方式对其进行子类化或配置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-01T02:46:28.817

这可能不适用于所有人，但对我来说非常有用。而不是实施...

```
[(MainNavigationController*)[self navigationController] setLandscapeOK:YES]; 
```

在我所有控制器的 viewWillAppear 中，我决定通过覆盖[UINavigationControllerDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationControllerDelegate_Protocol/Reference/Reference.html)方法将这个过程集中在我的 UINavigationController 子类中`navigationController:willShowViewController:animated:`

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {

    self.previousVCLandscapeOK = self.isLandscapeOK; // Store the current VC's orientation preference before pushing on the new VC so we can set this again from within the custom "back" method
    self.isLandscapeOK = NO; // Set NO as default for all VC's
    if ([viewController isKindOfClass:[YourViewController class]]) {
        self.isLandscapeOK = YES;
    }
} 
```

我发现从导航堆栈中弹出 VC 时不会调用此委托方法。这对我来说不是问题，因为我正在处理 UINavigationController 子类中的后退功能，这样我就可以为特定的 VC 设置正确的导航栏按钮和操作，就像这样......

```
if ([viewController isKindOfClass:[ShareViewController class]]) {

    UIButton* backButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 57, 30)];
    [backButton setImage:[UIImage imageNamed:@"back-arrow"] forState:UIControlStateNormal];
    [backButton addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
    UIBarButtonItem* backButtonItem = [[UIBarButtonItem alloc] initWithCustomView:backButton];
    viewController.navigationItem.leftBarButtonItem = backButtonItem;

    UIImageView* shareTitle = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"share-title"]];
    [shareTitle setContentMode:UIViewContentModeScaleAspectFit];
    [shareTitle setFrame:CGRectMake(0, 0, shareTitle.frame.size.width - 10, shareTitle.frame.size.height - 10)];
    viewController.navigationItem.titleView = shareTitle;

} else if(...) {
    ...
} 
```

这是我`back`处理将 VC 从堆栈中弹出并设置适当的旋转首选项的方法...

```
- (void)back {
    self.isLandscapeOK = self.previousVCLandscapeOK;
    self.previousVCLandscapeOK = NO;
    [self popViewControllerAnimated:YES];
} 
```

所以，正如你所看到的，基本上所有正在发生的事情是我首先为我设置两个属性......

```
@property (nonatomic) BOOL isLandscapeOK;
@property (nonatomic) BOOL previousVCLandscapeOK; 
```

其中`navigationController:willShowViewController:animated:`将确定即将呈现的 VC 中支持的方向。弹出 VC 时，我的自定义“返回”方法被调用，然后我将 isLandscapeOK 设置为通过 previousVCLandscapeOK 值存储的内容。

正如我所说，这可能不适用于每个人，但它对我来说非常有用，而且我不必担心向我的每个视图控制器添加代码，我能够将它全部集中在 UINavigationController 子类中。

希望这对我有帮助。谢谢，杰里米。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-02T22:08:45.630

转到您的 Info.plist 文件并进行更改![在此处输入图像描述](../Images/ca7467aa90ef55a04de44bde78f0ddfb.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-24T02:20:13.010

我想让我的所有 VC 都锁定为纵向，除了一个。这对我有用。

1.  在 plist 文件中添加对所有方向的支持。
2.  在根视图控制器中，检测窗口顶部的视图控制器类型，并在**supportedInterfaceOrientations**方法中相应地设置应用程序的方向。例如，我需要我的应用程序仅在 webview 位于堆栈顶部时旋转。这是我在 rootVC 中添加的内容：

    ```
    -(NSUInteger)supportedInterfaceOrientations
    {
        UIViewController *topMostViewController = [[Utils getAppDelegate] appNavigationController].topViewController;
        if ([topMostViewController isKindOfClass:[SVWebViewController class]]) {
            return UIInterfaceOrientationMaskAllButUpsideDown;
        }
        return UIInterfaceOrientationMaskPortrait;
    } 
    ```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-23T10:45:56.223

您只想强制 iOS 6 应用程序肖像，然后您可以添加到以下方法的 UIViewController 子类

```
- (BOOL)shouldAutorotate {
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        return YES;
    } else {
        return NO;
    }
}

- (NSUInteger)supportedInterfaceOrientations {
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        return UIInterfaceOrientationMaskAll;
    } else {
        return UIInterfaceOrientationMaskPortrait;
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-07-10T16:17:52.873

我没有足够的声誉来回答@micmdk 回复下的@Ram S 问题，所以我将在此处添加我的注释。

当您使用**UITabbarController**时，尝试将*@micmdk*代码中的 self.viewControllers.lastObject 更改为*self.selectedViewController* ，如下所示：

```
- (BOOL)shouldAutorotate {
    return [self.selectedViewController shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations {
    return [self.selectedViewController supportedInterfaceOrientations];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation {
    return [self.selectedViewController shouldAutorotateToInterfaceOrientation:toInterfaceOrientation];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation {
    return [self.selectedViewController preferredInterfaceOrientationForPresentation];
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-08-26T05:57:31.917

我已经解决了同样的问题。

如果您使用`UINavigationController`来推送视图控制器，则必须设置以下方法。

```
extension UINavigationController{

    override open var shouldAutorotate: Bool {

        if topViewController != nil && (topViewController?.isKind(of: LogInViewController.self))!
        {
            return true
        }
        return false
    }

    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {

        if topViewController != nil && (topViewController?.isKind(of: LogInViewController.self))!
        {
            return .portrait
        }
        return .landscapeRight

    }
    override open var preferredInterfaceOrientationForPresentation: UIInterfaceOrientation {

        if topViewController != nil && (topViewController?.isKind(of: LogInViewController.self))!
        {
            return .portrait
        }
        return .landscapeRight
    }
} 
```

代替你想显示的`LoginViewController`使用。`UIViewController`就我而言，我想`LoginViewController`在模式中显示`Portrait`其他模式。`ViewControllers``landscape`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-07T13:31:19.630

您可以在您的所有视图控制器类中实现和覆盖 shouldAutorotate() 和 supportedInterfaceOrientations var，这些类应该以与应用程序的 PLIST 中定义的方向不同的方向呈现。

但是，在一个重要的用户界面中，您可能会遇到将其添加到数十个类中的问题，并且您不想将所有这些类都设为支持它的几个常见的子类（MyBaseTableViewController、MyBaseNavigationController 和 MyBaseTabBarController）。

由于您不能直接覆盖 UIViewController 上的这些方法/变量，因此您可以在其子类上执行此操作，这些子类通常是您的基类，如 UITableViewController、UINavigationController 和 UITabBarController。

因此，您可以实现一些扩展并仍然设置 MyPreciousViewController 以与所有其他人（如 Swift 4 代码片段）不同的方向显示：

```
extension UITableViewController {
    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {

    if let last = self.navigationController?.childViewControllers.last,
        last != self {
            return last.supportedInterfaceOrientations
    } else {
        return [.portrait]
    }
    }
}

extension MyPreciousViewController {
    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {

    return [.portrait,.landscape]
    }
}

extension UINavigationController {
    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {

        return [.portrait]
    }
}

extension UITabBarController {
    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {

        return [.portrait]
    }
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2012-10-10T19:14:57.003

Please use the following method to solve this issue

```
- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
} 
```

return only the orientation you want!!!

# scala - 需要一些帮助来帮助类型推断引擎

> ID：12630363
> 
> 赞同：0
> 
> 时间：2012-09-27T21:35:17.463
> 
> 标签：scala, types

我无法理解在 scala 中将类型信息放在何处以及如何放置。在这里，我创建了几个`Actor`s 序列，但我不输入它们。即使我必须这样做，我也不知道会`map`产生哪种类型的序列来为它们提供正确的类型。

然后当编译器因为我试图 sum `Any`s 而对我大喊大叫时，我不知道从哪里开始填补空白。

这是我的代码，我尝试将其最小化，同时仍然提供必要的信息。

```
object Actors {
    def main(args: Array[String]) {
        val array = randomArray(5)
        val master = new Master(array, 5)
        master.start
    }

    def randomArray(length: Int): Array[Int] = {
        val generator = new Random
        new Array[Int](length) map((_:Int) => generator nextInt)
    }
}

class Master(array: Array[Int], slavesNumber: Int) extends Actor {
    def act () {
        val slaves = (1 to slavesNumber).map(_ => new Slave)
        slaves.foreach(s => s.start)
        val futures = slaves.map(s => s !! Work(array))
        val results = awaitAll(3000, futures:_*)
        val res2 = results.flatMap(x => x)
        println((0 /: res2)(_+_))
    }
}

class Slave() extends Actor {
    def act () {
        Actor.loop {
            receive {
                case Work(slice) =>
                    reply((slice :\ 0)(_+_))
            }
        }
    }
} 
```

我也很感激关于这个问题的全面文档的一些好的指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T12:12:05.640

在演员之间传递的对象没有类型，演员必须自己过滤对象——就像你在`Slave`演员中所做的那样。如您所见，`!!`定义为

```
def !!(msg: Any): Future[Any] 
```

所以返回的没有类型信息`Future`。可能最简单的解决方案是`var res2 ..`用

```
val res2 = results collect {case Some(y:Int) => y} 
```

这会过滤掉那些`Some`类型为 的结果`Int`。

# git - 基础应用程序的 Github 工作流程

> ID：12630376
> 
> 赞同：0
> 
> 时间：2012-09-27T21:36:21.097
> 
> 标签：git, github, workflow, repository

我在 Github 中有一个基础应用程序仓库。我即将向我的帐户添加一个将使用基本应用程序的新存储库......尽管我希望能够在每次更新基本应用程序时将来自基本应用程序的更新合并到新存储库。这个工作流程是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T23:11:58.910

这就是我处理 mvc 框架、网站编程和 mvc 框架所需的网站配置的方式。它可以帮助我将存储库分开，这样我就可以轻松地对每个存储库进行更改并跟踪。在这种情况下，mvc 框架是我的基础应用程序。请注意使用符号链接指向其他文件夹。

程序示例方法：

```
mkdir app_name
cd app_name
git clone git@github.com:username/my_mvc.git mvc
git clone git@github.com:username/app_name_src.git src
git clone git@github.com:username/app_name_config.git config
cd mvc/
ln -s ../config/ config
ln -s ../src/ src 
```

示例完成的目录结构：

```
app_name/
  mvc/
    .git/
    .htaccess
    index.php
    libs/
     - view.php
     - session.php
     - model.php
     - database.php
     - controller.php
     - bootstrap.php
    config->../config
    src->../src
  src/
    .git/
    views/
     - index/
       - index.php
     - header.php
     - footer.php
    public/
     - javascript/
     - images/
     - css/
    models/
     - convertor_model.php
    controllers/
     - index.php
     - error.php
     - convertor.php
  config/
     .git/
     - database.php
     - paths.php 
```

# sql - T-SQL 查找特定值在范围内的时间长度

> ID：12630378
> 
> 赞同：1
> 
> 时间：2012-09-27T21:36:29.960
> 
> 标签：sql, sql-server, tsql

我在 SQL Server 中有一个表，对于`r`time的每一行`t`，我想为where`t + i`的某些函数找到第一个表。`r``abs(f(r, t + i) - f(r, t)) > epsilon`

我可以想象用两个游标来做这件事，但这似乎效率很低。

那里有任何 T-SQL 大师有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:50:47.477

我不是相关子查询的忠实粉丝。但是，在这种情况下它似乎很有用。以下代码根据您的条件返回给定行之后第一行的最小“序列号”：

```
with t as (
    select t.*, f(r, t) as fval, row_number() over (order by <ordering>) as seqnum
    from table t
)
select t.*,
       (select min(t2.seqnum)
        from t t2
        where t2.seqnum > t.seqnum and
              abs(t2.fval - t.fval) > <epsilon>
       ) as next_seqnum
from t 
```

要完成这项工作，您需要指定`<ordering>`和`<epsilon>`。是你如何知道行的顺序（`t`如果我不得不猜测的话，这将是一个很好的猜测）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:53:39.917

```
select a.t, b.t  --- and what other columns you need
from tbl a -- implicitly each row of table
cross apply (
    select top(1) * -- the first, going upwards along b.t
    from tbl b
    where a.t < b.t -- look for records with later t than the source row
      and <here's your function between a row and b row>
    order by b.t asc
) x 
```

# scheme - 计划作业

> ID：12630379
> 
> 赞同：1
> 
> 时间：2012-09-27T21:36:41.333
> 
> 标签：scheme, racket

在我正在学习的一门课程中，我们最近不得不学习编程语言 Scheme。我得到了所有的基础知识，这几乎就是我们所经历的一切。我只是在学习以 Scheme 所包含的不同方式思考问题时遇到了困难。

我被分配了一个任务，真的不知道如何开始。我已经在这里坐了几个小时试图弄清楚如何开始，但我有点难过。作为记录，我不是要求解决这个问题的代码，而是更多的一些想法让我走上正轨。

无论如何，这是任务的要点......

我们得到一个代表选民投票的十个数字的列表。数字是 -1、0 或 1。然后我们会得到一份候选人列表，其中包含一个候选人的姓名，然后是与该候选人的选票相对应的十个数字。这些数字也是 -1 0 和 1。

举个例子。

```
'(0 0 0 -1 -1 1 0 1 0 -1)
'(Adams 0 1 -1 0 1 1 0 -1 -1 0 0) 
```

我们被要求实现一个名为 best_candidates 的函数，该函数将接收一个数字列表（选民）和一个候选人列表。然后我们必须将选民的选票与每个候选人的名单进行比较，并返回一个投票最多的名单。

到目前为止，我已经想出了一些事情。我只是对如何检查值并保留选民姓名感到困惑？我想我仍然停留在思考 C/Java 并且这让这变得非常困难。

有什么建议可以帮助我入门吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:55:37.237

我认为这是一个标准搜索问题，您正在寻找差异*最小*的项目（即“最常见的”）。

也就是说，给定项目**x_0**、**x_1**、 ...、**x_n**的列表，我认为您想编写一个函数来计算一组相应的分歧数字**d_0**、**d_1**、 ...、**d_n**。

一旦你可以计算出这些**d_i**分歧数，找出哪一个（或几个！）最小：这些对应于最大一致。

如果你能做到这一点，那么对应的**x_i**就是你想要收集的列表项。

上面的描述与编程语言无关。如果您更熟悉另一种语言，请先用该语言编写代码！您应该对问题获得足够的信心和理解，以使额外的工作变得有价值。至少，您将拥有另一个实现，您可以使用它来测试您的 Scheme 实现，以确保您获得*同意*。

# wordpress - 将页面链接到自定义帖子类型

> ID：12630381
> 
> 赞同：0
> 
> 时间：2012-09-27T21:36:42.880
> 
> 标签：wordpress, custom-post-type

我有一个**WooCommerce**网站，它有一个名为“产品”的自定义帖子类型。

每个产品都与我在一组页面中详述的一种或多种技术相关联。总共有 8 页，每种技术一页。这些页面可在网站上的“技术”菜单中访问。

我希望能够链接产品和技术，以便我可以在产品页面上调用链接页面。我将有一个技术部分，我将在其中列出技术、关键图像和摘录。问题是，每种产品都使用不同的技术。

我所设想的解决方案是将页面链接到产品的一种方式，就像我链接类别一样。然后在产品页面上，我可以获得该产品的附加页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T17:54:25.273

我发现了一个非常有用的插件，叫做“高级自定义字段”（[http://www.advancedcustomfields.com/](http://www.advancedcustomfields.com/)），它允许这样做。使用此插件，您可以在帖子和其他帖子/页面之间创建关系。

![在此处输入图像描述](../Images/d7a51e931d272c6135d4ad69e7093d93.png)

然后在您的帖子中，您可以调用相关的帖子对象并从中提取您喜欢的所有信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:46:56.920

根据我从您的问题中了解到的情况，答案可在[Wordpress codex](http://codex.wordpress.org/Function_Reference/wp_list_pages)中找到。如果不是这种情况，您可能必须更好地提出您的问题。

从 codex 的那一页，你可以找到这样简单的一行：

```
 <?php wp_list_pages('post_type=yourcustomtype&title_li='); ?> 
```

# asp.net - Window.Open 没有弹出窗口阻止程序

> ID：12630383
> 
> 赞同：0
> 
> 时间：2012-09-27T21:36:48.637
> 
> 标签：asp.net, jquery, popup-blocker

我想在用户离开选项卡或关闭浏览器时打开一个弹出窗口，我的可用选项是 window.open，但是这样，它会要求弹出窗口阻止程序，如果未启用，我尝试了所有可能的方法来忽略弹出窗口-阻止程序但徒劳无功，我尝试了onunload，onbeforeunload，但它不起作用，我还尝试使用模式对话框，在选项卡/浏览器之前，我在onbeforeunload事件中使用它，但它显示浏览器警报消息，我不想要，**我的简单要求是，我需要一个弹出窗口（如果可能的话）或模式对话框，关闭选项卡/浏览器，但应该忽略弹出窗口阻止程序**，我想对于模态对话框，我不需要担心弹出窗口阻止程序，因为那不会是新窗口，而是当用户关闭选项卡/浏览器时我将如何处理它。如果上述任何选项都不可能，任何人都可以帮助我提供任何其他可能的替代方案或有用的文章。

**`Edited Question`**
我使用了下面的脚本，我可以在点击链接时打开一个新的弹出窗口，而不会干扰弹出窗口阻止程序

```
$('a[href=http://www.google.com]').click(function(){
    window.open(this.href);
    return false;
  }); 
```

那么为什么它不可能为闭幕事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:46:56.563

你不能——因为弹出窗口阻止程序就是这样做的：它们阻止弹出窗口（即`window.open`对链接的调用或调用`target="_blank"`），除非它直接响应用户鼠标操作。

在浏览器窗口关闭时打开弹出窗口是 2000 年代初期“pop-under”广告的常见策略，它激怒了用户，这就是为什么 Firefox 和 IE6 的弹出窗口阻止程序会阻止它们，除非你要求用户在您的网站上禁用他们的弹出窗口阻止程序（我想您会发现他们中的大多数人都不知道如何做到这一点）。

你到底想完成什么？您希望用户看到的弹出窗口的内容是什么？您还尝试了哪些其他方法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:59:58.167

如果打开弹出窗口的 javascript 代码是在用户的直接操作（如单击、按键、拖动等）上执行的，则弹出窗口阻止程序不会阻止弹出窗口的打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:08:54.297

[与您之前的问题](https://stackoverflow.com/questions/12626051/opening-popup-from-asp-net-website-without-popup-blocker-catching-it/12626481#12626481)完全相同....

我也会在这里发布我的答案......

弹出窗口阻止程序旨在防止这种行为。

我建议使用模态窗口而不是实际的浏览器窗口。我不认为这些被阻止是因为它们是在页面本身中打开的。

至于事件......你可以做类似......

```
window.onbeforeunload = function whatever() {
       //Do code here for your modal to show up.
 } 
```

如果您只是想发出警告或您可以做的事情

```
window.onbeforeunload = function showWarning() {
       returnString = 'Whatever you want your message to be....';
       return returnString;
 } 
```

通过在 onbeforeunload 语句中返回某些内容，它将显示一个包含您的消息的确认框。

# sql - NVARCHAR TO DATETIME 转换

> ID：12630385
> 
> 赞同：0
> 
> 时间：2012-09-27T21:36:50.290
> 
> 标签：sql, sql-server, sql-server-2008

我有一个参数，它的值`14-Sep-2012 15:47:27`是我想用它更新`2012-08-10 05:00:00.000`格式的表列。

需要什么查询'

```
@UpdateTime = '14-Sep-2012 15:47:27'

Update tbl 
Set Datetimecol = CONVERT(datetime,@UpdateTime,110) ?? 
```

我正在使用 SQL Server 2008。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:48:25.807

对于已编辑的问题，您只需删除`110`规范。您显示的格式确实没有规范，但 SQL Server 的英文安装会转换它。

例如

```
declare @UpdateTime datetime = '14-Sep-2012 15:47:27'
select CONVERT(datetime,@UpdateTime)

-- result
September, 14 2012 15:47:27 
```

* * *

假设您的月份部分至少有 3 个字符长，例如 Mar、Marc、March、Sept，您可以使用以下命令将非常糟糕的文本日期时间转换为正常的 3 字符月份格式

```
declare @updatetime nvarchar(20) = '18-Sept-2012'
declare @fixedtime nvarchar(20)
set @fixedtime = stuff(@updatetime,1,charindex('-',@updatetime),'')
set @fixedtime = Left(@updatetime,charindex('-',@updatetime))
               + stuff(@fixedtime,4,len(@fixedtime)-8,'')

-- @fixedtime contains `18-Sep-2012`

Update tbl 
Set Datetimecol = @fixedtime 
```

是的，我故意在更新语句中省略了 CAST/CONVERT。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T23:38:38.827

只要您的语言设置始终是英语并且您的区域设置不改变，这是另一种方法（以及各种可能格式的示例数据）：

```
DECLARE @x TABLE(y NVARCHAR(15));

INSERT @x VALUES('18-Sept-2012'),('9-May-2012'),('19-Oct-2012'),('04-March-2012');

SELECT z, CONVERT(DATETIME,z) FROM
(
  SELECT SUBSTRING(y,s+1,3) + ' ' + LEFT(y,s-1) + ', ' + RIGHT(y,4) FROM
  (
    SELECT y, CHARINDEX('-',y) FROM @x
  ) AS y(y,s)
) AS z(z); 
```

结果：

```
Sep 18, 2012   2012-09-18 00:00:00.000
May 9, 2012    2012-05-09 00:00:00.000
Oct 19, 2012   2012-10-19 00:00:00.000
Mar 04, 2012   2012-03-04 00:00:00.000 
```

您可以对变量使用相同的计算：

```
DECLARE 
  @y NVARCHAR(15) = N'18-Sept-2012',
  @z DATETIME;

SELECT @z = CONVERT(DATETIME,z) FROM
(
  SELECT SUBSTRING(y,s+1,3) + ' ' + LEFT(y,s-1) + ', ' + RIGHT(y,4) FROM
  (
    SELECT @y, CHARINDEX('-',@y)
  ) AS y(y,s)
) AS z(z);

SELECT @z;
-- UPDATE ... 
```

（现在试一试，`SET LANGUAGE FRENCH;`看看这一切都到了，嗯，某个地方。）

出于这个原因，我强烈建议您停止使用该`nvarchar`类型存储/传递日期。我们有强类型的日期/时间类型是有原因的。当您需要传递字符串文字时，您应该使用不易出现语言、区域和日期格式设置差异的明确标准格式。在这种情况下，正确的格式应该是`YYYYMMDD`：

```
20120918 
```

有关详细信息，请参阅：

*   [要改掉的坏习惯：错误处理日期/范围查询](https://sqlblog.org/2009/10/16/bad-habits-to-kick-mis-handling-date-range-queries)

# javascript - 延迟后 JQuery 淡入

> ID：12630389
> 
> 赞同：2
> 
> 时间：2012-09-27T21:36:50.463
> 
> 标签：javascript, jquery, html, delay, fadein

我试图让我的主徽标图像在一定延迟后淡入（使用 Jquery）。

该脚本实际上工作正常，除了当您第一次加载页面时，整个页面都属于`style="display:none"`

我只希望徽标`display:none`不是整个页面。有什么我想念的吗？一些我没有关闭的标签？这是链接：[我的网站](http://madeclothiers.com/) 这是代码 [Javascript]：

```
`<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
        $('#logo').delay(1500).fadeIn(1500);
});
</script> 
```

这是HTML：

```
<img src="img/made_clothes2.png" class="clothingLogo" id="logo" style="display:none;" />
<center><ul class="social">
    <li><a href="http://www.facebook.com/madeclothiers"><img src="img/facebook.png" class="social"></a></li>
    <li><a href="http://www.twitter.com/madeclothiers"><img src="img/twitter.png" class="social"></a></li>
    <li><a href="http://www.madeclothiers.tumblr.com/"><img src="img/tumblr.png" class="social"></a></li>
    <li><a href="http://web.stagram.com/n/madeclothiers"><img src="img/instagram.png" class="social"></a></li>
</ul></center> 
```

就目前而言，当页面加载时没有显示直到 delay.fadeIn() 被执行......我希望加载其他“社交”图像并且 #logo 独立加载 [使用 delay.fadeIn( )]。

谢谢，[编辑：我修复了 img 标签和 ul 标签，但仍然没有继续加载图像“社交”图像]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:17:08.103

更新的答案，一个真正有效的答案将您的 jquery 脚本修改为以下

```
$(document).ready(function() {
        $('#logo').css({ opacity: 1});
}); 
```

将此添加到您的CSS

```
.clothingLogo {
    opacity: 0.001;
    transition: opacity 1.5s 1.5s;
    -moz-transition: opacity 1.5s 1.5s;
    -webkit-transition: opacity 1.5s 1.5s;
    -o-transition: opacity 1.5s 1.5s;
    -ms-transition: opacity 1.5s 1.5s;
    -khtml-transition: opacity 1.5s 1.5s;
} 
```

从图像中删除所有样式

```
<img src="img/made_clothes2.png" class="clothingLogo" id="logo" /> 
```

测试了 Firefox 和 chrome，如果你愿意，你可以找到其他方式来表达古董 ie 版本的不透明度......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T21:41:51.860

没有`</img>`标签。让它`<img src="img/made_clothes2.png" class="clothingLogo" id="logo" style="display:none;" />`。

浏览器可能会对此感到窒息，因此不会显示其他任何内容。

我发现了你的问题。在您设置的样式表中：

```
ul.social{
  list-style-type: none;
  margin-top: -12%;   // <- problem is here
  text-aling: center;
} 
```

何时`#form`隐藏，`ul.social`位于页面顶部。它`margin-top: -12%`比**可见区域高出 12%** ......

PS：将啤酒和蛋糕送到我家并验证您的 HTML！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T21:46:25.467

只是一个想法，但我建议您在 css 中为该徽标图像设置宽度和高度，并尝试使用`opacity: 0.001`而不是`display: none`它的样式，您可能会发现它效果更好，因为图像在浏览器点击 img 标签的那一刻得到下载请求，而不是当 jquery 开始切换不透明度时

```
<img src="img/made_clothes2.png" class="clothingLogo" id="logo" style="opacity: 0.001; width: 1024px; height: 768px;" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T21:47:26.367

实际上`img`标签应该如下

```
<img src="img/made_clothes2.png" class="clothingLogo" id="logo" style="display:none;" /> 
```

你可以改用下面的javascript

```
<script type="text/javascript">
    $(document).ready(function() {
        setTimeout(function(){
            $('#logo').fadeIn(1500);
        }, 1500);
    });
</script> 
```

而且您的`<ul>`标签也应该有一个结束标签，例如`</ul>`并用于`css/style`居中`ul`而不是使用 deprecated `<center>`。

# powershell - Get-WmiObject : RPC 服务器不可用。（HRESULT 异常：0x80070 6BA

> ID：12630392
> 
> 赞同：0
> 
> 时间：2012-09-27T21:37:11.407
> 
> 标签：powershell, wmi, rpc

我有一个简单的脚本，它将连接到域中的所有服务器，并为每台服务器上运行的所有服务构建一个表。但是，当我尝试自动化脚本以获取 foreach 循环中的所有服务器时，我收到一个 RPC 错误。如果 $name 变量被替换为服务器 DNS 名称，一切都会按预期工作。我检查了我的系统 (win7) 和服务器 (2000 - 2008R2) 上的防火墙和 DCOM 服务，这些都已正确启用或禁用。所以，我在想剧本中的某些东西坏了。我仍在学习 powershell，所以任何提示都值得赞赏。

这是到目前为止的脚本。$servernames = get-adobject -Filter 'ObjectClass -eq "Computer" ' -Searchbase "OU=Servers,DC=E,DC=BENEFIS,DC=ORG"

```
 foreach ($name in $servernames) {
        Get-WMIObject win32_service -computername $name -Property      SystemName,Name,StartName,StartMode | 
        Format-table SystemName, Name, Startname >c:\serverservices.txt } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:43:25.330

您返回的每个对象都有一个 name 属性，因此您需要将其值传递给 ComputerName 参数。此外，要使用`Get-ADComputer`cmdlet 获取计算机对象，您还需要在导出到文件时指定 Append 开关，否则内容将被覆盖，最终您将看到的只是最后一台计算机的输出。

```
$servernames = Get-ADComputer -SearchBase "OU=Servers,DC=E,DC=BENEFIS,DC=ORG" -Filter *

foreach ($name in $servernames) 
{
        Get-WMIObject win32_service -computername $name.Name -Property SystemName,Name,StartName,StartMode |
        Format-table SystemName, Name, Startname | Out-File c:\serverservices.txt -Append
} 
```

# iphone - LocalStorage 在 iPad 和 iPhone 上不起作用

> ID：12630396
> 
> 赞同：13
> 
> 时间：2012-09-27T21:37:35.313
> 
> 标签：iphone, ios, ipad, html, local-storage

我在 iPad 和 iPhone 上遇到了 HTML5 LocalStorage 问题。我开发了一个 HTML5/CSS3/JavaScript (jQuery/jQuery Mobile) 网站，我正在尝试将几条数据存储到 LocalStorage（只是几个小字符串）。

当我通过简单地打开 Safari 并输入 URL 导航到 iPad 或 iPhone 上的网站时，我收到来自 Moderizr 的通知，指出不支持 localstorage，因此我的值不会保存在设备上。

但是，如果我使用保存到主屏幕选项，在主屏幕上保存一个图标/指向我的移动网站的链接，关闭“常规”Safari，然后使用主屏幕图标打开应用程序，Moderizr 会告诉我本地存储可用，并且我的值按预期写入和读取。

所以，我很困惑。为什么将链接保存到主屏幕后它可以工作，但如果我直接在 Safari 中键入 URL 则它不起作用？我是否缺少一些技巧来使其在两种情况下都起作用？

我已经尝试过 iOS 5.1.1 和 6。而且，我的设置是基本默认值。

谢谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-01T13:40:25.903

在经历了许多头痛之后，我想我明白了。HTML5 本地存储和隐私浏览不能混用。我在（在 Safari 设置中）进行了私人浏览，这似乎阻止了本地存储。实际上，一个异常被抛出但被浏览器吞噬（？？？）。一旦我关闭私人浏览，一切似乎都正常。

# facebook-fql - FQL 中 CONTAINS() 的文档？

> ID：12630401
> 
> 赞同：2
> 
> 时间：2012-09-27T21:38:20.237
> 
> 标签：facebook-fql, contains

最近在 Facebook.SO 上[发布了](http://facebook.stackoverflow.com/questions/8271546/facebook-fql-javascript-result-set)[几个](http://facebook.stackoverflow.com/questions/4380391/search-for-people-by-name-in-fql) [问题](http://facebook.stackoverflow.com/questions/10587789/fql-search-for-non-friend-people-and-sort-by-mutual-friends) ，使用该子句。它似乎像 Graph API 搜索功能一样工作，AND 用作索引字段。对于 FQL 开发人员来说，一切都很棒。`CONTAINS()``WHERE`

```
SELECT name,
       username,
       type
FROM   profile
WHERE  CONTAINS("Facebook") 
```

但是，该`CONTAINS`函数的唯一官方提及出现在[Unified_thread](https://developers.facebook.com/docs/reference/fql/unified_thread/)文档中。顺便提到了它，作为搜索消息中包含的文本的一种方式。它也出现在这个[fbrell 代码示例中](http://www.fbrell.com/hidden/whitepages)。

但`Contains`似乎不是一个简单的搜索。例如，这个查询：

```
SELECT name
FROM   user
WHERE  CONTAINS("Joe Biden") 
```

返回“Joe Biden”以及“Joseph Biden”和“Biden Joe”。但它也返回“Joe Scardino”、“Lindsay Noyan”和“Mehmad Moha”等。这些人与美国副总裁有什么关系？他们不是我的朋友，所以我永远不会知道。

似乎还可以传递`CONTAINS`一个字段进行搜索，但是将我的第一个查询的结尾更改为 `CONTAINS("Facebook", name) 会返回一个 OAuth 错误：

```
 (#615) 'name' is not a valid search field for the profile table. 
```

在我不那么严格的测试中，我还没有找到不返回此错误的字段/表格组合。

那么这个神秘功能是什么？它是如何工作的？它可以让我们做迄今为止在 FQL 中不可能完成的事情，比如遍历数组和过滤存储在字符串中的数据吗？

这里的答案会很好，但是在官方开发人员文档站点上的 FQL 函数和方法参考页面上的描述会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:48:38.543

我认为这里没有什么好的答案，但我可以为返回不相关姓名的问题提供一种解决方法——我怀疑这是因为人们公开发布了关于乔·拜登的帖子，喜欢他等等。如果您执行以下操作：

```
SELECT name
FROM   user
WHERE  CONTAINS("Joe Biden")
AND    strpos(lower(name),lower("Joe Biden")) >=0 
```

您将得到一个只包含正确名称的结果集——尽管它消除了返回 Joseph Biden 等的优势。

我个人的痛点是 CONTAINS() 似乎适用于配置文件表上的部分字符串（例如“Joe Bide”），但不适用于用户表。非常令人沮丧。

# java - 在 Servlet 中创建接口对象（需要说明）？

> ID：12630403
> 
> 赞同：0
> 
> 时间：2012-09-27T21:38:38.210
> 
> 标签：java, jakarta-ee, servlets, interface, polymorphism

我对 Servlet 中的概念接口感到困惑。我想确保我了解我在做什么。因此，任何解释都将不胜感激。

```
public class Testing implements Servlet 
{
    public void init(ServletConfig arg0) throws ServletException
   {
       /* getting some values from web.xml } */
   }

} 
```

(i) init 将被 tomcat 调用 (ii) ServletConfig 是一个接口，如何创建接口对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:42:12.100

您不能直接实例化接口。一个类必须**实现**该接口。然后，您可以实例化该类。

有关更多信息和示例，请查看：[http ://docs.oracle.com/javase/tutorial/java/IandI/usinginterface.html](http://docs.oracle.com/javase/tutorial/java/IandI/usinginterface.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:42:34.547

`arg0`可能是一个引用，`ServletConfig`但它指向一个实现`ServletConfig`..的类的对象

例如：-

```
public interface A {
}

public class B implements A {
}

public class C {
    public static void main(String args[]) {
        A obj = new B();
    }
} 
```

假设这里`interface A`是`ServletConfig`，并且`class B`是实现的类`ServletConfig`..现在您可以将`obj`which 的类型`A`和指向类的对象传递`B`给任何方法..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:49:38.960

你不能*实例化一个接口*，但你可以实例化一个实现该接口的类。如您所说，该*init() 方法*由*tomcat（Web 服务器/Servlet 或 JSP 容器）调用。*

*ServletConfig 接口在**您的 servlet 实例化*期间使用。它有*getInitParameters(string)、getServletName()*等方法。你可以看看[这里](http://docs.oracle.com/javaee/1.2.1/api/javax/servlet/ServletConfig.html)。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-28T08:06:29.977

I think the answer 3 take a example is not correct, why don't you use extend keywrod in interface ? tomcat server is implimenting servelt specification container .so the ServletConfig also is implimented

# c# - IPC - 消息队列

> ID：12630412
> 
> 赞同：2
> 
> 时间：2012-09-27T21:39:40.723
> 
> 标签：c#, .net, message-queue, named-pipes

假设我有一个简单的calculator.exe 应用程序。我启动了它的 2 个实例（ Cal_1 ， Cal_2 ）。我希望 Cal_1 向 Cal_2 发送消息。我在想使用消息队列是一个不错的选择，有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T23:02:38.393

我建议在请求-回复或发布-订阅模式下使用[ZeroMQ消息传递框架。](http://zguide.zeromq.org/page%3aall)它易于使用，并且通过 NuGet具有[C#绑定。](http://www.zeromq.org/bindings%3aclr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:49:03.183

您是说要在您编写的两个应用程序之间，还是在您无法控制的两个现有应用程序之间发送命令？如果是后者，那么我不知道该告诉你什么，除了在 Windows API 中绑定消息或使用 UI 自动化框架。

如果这两个应用程序是您编写的应用程序，则可以将 .NET Remoting 与 IPC 通道一起使用。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/vstudio/kwdt6w2k (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/kwdt6w2k(v=vs.100).aspx)

# android - Android 4.1.1 中的 NETWORK_PROVIDER 行为是否发生了变化？

> ID：12630413
> 
> 赞同：7
> 
> 时间：2012-09-27T21:39:46.383
> 
> 标签：android, location

我有一个现有的经过良好测试的应用程序，它使用`GPS_PROVIDER`和`NETWORK_PROVIDER`具有相同的`LocationListener`.

`LocationManager`报告 GPS、网络和被动位置提供程序可用并已启用。

我最近将我的 Galaxy Nexus 升级到 4.1.1，现在`NETWORK_PROVIDER`不提供任何位置更改。使用运行 4.0.4 的 Galaxy S III 进行测试可以按照我的习惯进行，即使 WiFi 已关闭，网络位置也会更新。当 WiFi 关闭时，我得到了手机信号塔的位置。

在这里与同事交谈，我不能排除某种巧合的硬件故障或某种我没有发现的默认设置更改。我已经仔细检查了整个设置，似乎一切都设置正确。

WiFi 开启，Cell 网络开启，GPS 开启，网络服务全部开启。我的办公桌上没有 GPS 信号，因此当网络位置无法提供结果时很容易注意到。

还有其他人在使用 Verizon Galaxy Nexus + 4.1.1 或 4.1.1 以及任何手机时遇到类似问题吗？

另外一个问题是，谷歌地图正在寻找我的位置，但我`PASSIVE_PROVIDER`也没有生成位置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T14:24:52.763

Android 的行为在`NETWORK_PROVIDER`.

我不知道出了什么问题或为什么，但我移除/更换了 Galaxy Nexus 上的电池和 SIM 卡，网络提供商似乎提供了正确的结果。

给我的教训？即使您确定网络提供商可用、已启用并已连接，也不要假设您会向您的听众报告您的位置。

`LocationListener`就我而言，如果我没有报告任何位置，我需要添加另一项检查以确保我不会继续运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T06:18:36.583

我读过有人关于这个问题的假设。它是“在某些设备中，如果请求后没有更新，则网络提供商不会给予回调”。

考虑这种可能性。

就我而言，我`getLastKnownLocation()`在开始当前位置跟踪之前使用 a 。在[本文](http://android-developers.blogspot.kr/2011/06/deep-dive-into-location.html)中尝试`ctrl`+ 。`f` `getLastKnownLocation`

# asp.net-mvc - jquery 对话框中隐藏字段的值未传递给 asp.net mvc 控制器操作

> ID：12630414
> 
> 赞同：0
> 
> 时间：2012-09-27T21:39:46.703
> 
> 标签：asp.net-mvc

这是我的 CreateUnit.cshtml，我在其中将 templateId 设置为 ID 为“TemplateId”的隐藏输入字段。当我确认对话框时，将执行 asp.net mvc 控制器“UnitController”及其操作方法“Create”，这应该通过 UnitViewModel。在 UnitViewModel 中，模型绑定器已将 name 属性设置为我输入的值。但是隐藏字段中的 templateId 丢失了。

为什么这个？

```
@model ITMS.Web.Models.UnitViewModel

@*Remote Validation*@
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

<script type="text/javascript">

    $(document).ready(function () {
        var templateId = $('#MyDialog').data('templateIdKey');
        $('#TemplateId').text(templateId);       
    }); 

</script>

@using (Html.BeginForm("Create", "Unit"))
{ 
     @Html.ValidationSummary(false)
    <p class="editor-label">@Html.LabelFor(model => model.Name)</p>
    <p class="editor-field">@Html.EditorFor(model => model.Name)</p>
    <p class="editor-field">@Html.ValidationMessageFor(model => model.Name)</p> 

    @Html.HiddenFor(x => x.TemplateId)      
}

[HttpPost]
public ActionResult Create(UnitViewModel unitViewModel)
{
    if (ModelState.IsValid && !_dataProvider.UnitExists(unitViewModel.Name, unitViewModel.TemplateId))
    {
        Unit unit = Mapper.Map<UnitViewModel, Unit>(unitViewModel);
        _dataProvider.AddUnit(unit);
        return new JsonNetResult(new { success = true });
    }
    ModelState.AddModelError("Name", "This name already exists.");
    return PartialView(unitViewModel);
}

 public class UnitViewModel
    {
        [Required(ErrorMessage = "Name must not be empty.")]
        [StringLength(30, ErrorMessage = "Enter max. 30 chars for a name.")]
        [Remote("UnitExists", "Unit", ErrorMessage = "This name already exists.",AdditionalFields="TemplateId")]
        [JsonProperty("title")]
        public string Name { get; set; }  

        public Nullable<int> ParentId { get; set; }

        [HiddenInput(DisplayValue = false)]
        public int TemplateId { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:46:59.700

**代替：**

$('#TemplateId').text(templateId);

**我写了这个，现在 TemplateId 与表单一起发送**:)

$("[name='TemplateId']").val(templateId);

对我来说很愚蠢，输入字段没有文字...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:19:55.613

而不是`@Html.HiddenFor(x => x.TemplateId)`在您看来，`@Html.EditorFor(x => x.TemplateId)`而是使用。HTML 将呈现为隐藏的输入字段。

# c# - 数据访问模式类似于存储库但不完全

> ID：12630418
> 
> 赞同：2
> 
> 时间：2012-09-27T21:40:04.553
> 
> 标签：c#, asp.net, design-patterns, repository-pattern, data-access-layer

我正在开发一个带有保存数据的系统的项目，并且我正在考虑使用数据访问方法来获取数据，以便将其交给我在事物表示方面的组件。我认为这是一个 N 层架构。这是我的想法：

> 表示层（WebForms 和用户控件）
> 
> ```
>  \/ 
> ```
> 
> 数据访问层（这是我的问题所在）
> 
> ```
>  \/ 
> ```
> 
> 业务对象（系统中每个实体的 C# 类）
> 
> ```
>  \/ 
> ```
> 
> 用于从数据库获取数据的现有 API（MS SQL 驱动）

在我的 DAL 中，我想使用系统中的特定 API 机制来获取业务对象，以便将它们传递给我的演示组件。我知道我创建各种实用程序存储库类以“获取一堆 X 业务对象”的存储库模式。例如，假设我有一个名为 的业务对象`Article`，我可以有一个`ArticleRepository`，我的“文章列表页面”将调用该存储库并为我获取`Article`. 这很好，但对我来说在 DAL 上可能有点矫枉过正。有没有做其他事情的名字，比如`static GetAll()`在我的业务对象上拥有一个方法？所以不是：

```
var repo = new ArticleRepository();
IEnumerable<Article> articles = repo.GetAll(); 
```

我在想这样简单的事情：

```
IEnumerable<Article> articles = Article.GetAll(); 
```

其中的`Article`类既是我的业务对象，具有相关的属性甚至是辅助方法，也有一个`static GetAll()`方法。这种方法有名称吗？创建这个精简的伪存储库是一个坏主意吗？

我问这一切是因为简单地说，我将有很多存储库类来执行此操作，因为我有很多业务对象，所有这些都具有从系统中获取它们的唯一查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:36:52.263

不知道您的架构的名称，但恕我直言，DAL 应该负责持久性，从而直接处理 DB API。

根据我的经验，没有理由认为一些好的做法是矫枉过正的 :) 使用 EF 的通用存储库实现起来非常简单，并且会让您在未来微笑。

# google-maps - 一起处理标记单击和双击 googlemaps

> ID：12630422
> 
> 赞同：1
> 
> 时间：2012-09-27T21:40:13.547
> 
> 标签：google-maps, google-maps-api-3

我有以下问题。在我的谷歌地图应用程序上，我需要区分标记上的单击和双击。

因此，当我创建标记时，我创建了两个侦听器：

```
google.maps.event.addListener(markerTMP, 'click', (function(routeID) {
                return function() {
                    console.log('click '+routeID);
                }
            })(pointRoute));

google.maps.event.addListener(markerTMP, 'dblclick', (function(routeID) {
                return function() {
                    p('double click '+routeID);
                }
            })(pointRoute)); 
```

问题是当我使用双击时，也使用了单击。我的想法如何处理这个问题：点击时 - 创建超时，双击时 - 删除它。

但是有正常的方法来处理这个吗？我无法在 API 参考中找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-10T16:32:56.547

这是我的解决方法。它使用全局变量来跨两个函数工作。不是最有说服力的，但很有效。

```
 google.maps.event.addListener(marker, 'click', function() {
                    x = 0
                    update_timeout = setTimeout(function(){
                        if (x == 0) {
                            // do something ;
                        };
                    }, 300);   
                });

                google.maps.event.addListener(marker, 'dblclick', function() {
                    x=1
                    // do something ;
                }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:49:03.627

API 中没有“官方”的方式来处理这个问题。创建超时似乎是[公认的方法](https://stackoverflow.com/questions/5329136/handling-click-events-in-google-maps-js-api-v3-while-ignoring-double-clicks)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:49:32.190

尝试使用单击事件和右键单击事件，而不是单击和 dblclick。

# java - EclipseRCP - 最后添加一个常量值的数据绑定文本

> ID：12630423
> 
> 赞同：0
> 
> 时间：2012-09-27T21:40:13.020
> 
> 标签：java, data-binding, eclipse-rcp

我有一个范围为 0 - 100 的简单刻度。我通过 将它绑定到标签上`WindowsBuilder`。我希望文本在刻度上显示数值，然后显示数值`%`。我该怎么做呢？

源代码由`Windows Builder`

```
 protected DataBindingContext initDataBindings() {
    DataBindingContext bindingContext = new DataBindingContext();
    //
    IObservableValue observeTextLblPercentObserveWidget = WidgetProperties.text().observe(lblPercent);
    IObservableValue observeSelectionScaleObserveWidget = WidgetProperties.selection().observe(scale);
    bindingContext.bindValue(observeTextLblPercentObserveWidget, observeSelectionScaleObserveWidget, null, null);
    //
    return bindingContext;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:39:40.220

我不知道你在WindowsBuilder中怎么做，但你需要添加org.eclipse.core.databinding.conversion.IConverter。

实际上，我认为您需要两个转换器（从模型到附加“%”的文本，一个用于反向转换以解析用户输入）和一个验证器。

# ios - UIView 中心 X UIImageView

> ID：12630425
> 
> 赞同：1
> 
> 时间：2012-09-27T21:40:23.497
> 
> 标签：ios

在一个 UIVIew 中，我有 5 个图标（UIImageView）。我显示/隐藏图标。没关系。但我想如果我隐藏 2 个图标，其余的未隐藏（或未删除）显示视图中心。

如果显示全部：

[http://sherad.info/elotte.jpg](http://sherad.info/elotte.jpg)

我从视图 2 图标中删除（我尝试设置隐藏但效果相同）

[分享 removeFromSuperview]; [sms removeFromSuperview];

在这之后：

[http://sherad.info/utana.jpg](http://sherad.info/utana.jpg)

我希望 3 图标显示在视图中心。所以以某种方式重新排列 UIView 中的图标。我怎么能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T00:01:30.650

我会假设图标后面的黑色区域是 UIView 并且图标已添加到静态位置？相反，如果您创建了第二个透明的 UIView 会怎样。确定要显示的图标并将它们添加到第二个视图中。它会从第二个视图开始，其大小与第一个视图完全相同，但是一旦您想显示更少，请从第二个视图中删除所有图标

```
for (yourIcon *icon in [secondView subviews]) {
    [icon removeFromSuperview];
} 
```

将第二个视图的框架重置为您想要的长度并重新添加图标，然后将其放在第一个视图的中心

```
secondView.center = firstView.center; 
```

要么做

```
[secondView setNeedsDisplay] 
```

如果您之前将其删除（我认为没有必要），则将其重新添加为 firstView 的子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:58:51.077

子视图应该根据有多少其他图标来相对于彼此定位。每次发生添加或删除图标的事件时，您都应该调用一些布局代码来使图标自行定位。

删除视图应该让超级视图计算添加的子视图，根据屏幕宽度除以计数创建新的 x 坐标，然后设置所有子视图的帧。

可能有一种方法可以使用自动布局来做到这一点，但我不熟悉这些方法。

# c# - 如何在 c# 中将默认值设置为 propertyygrid 的大小类型属性？

> ID：12630429
> 
> 赞同：3
> 
> 时间：2012-09-27T21:40:47.067
> 
> 标签：c#, propertygrid

我有一个propertygrid，myclass 是它的objectsource。在我的课堂上，我从 Size 类型中定义了一项。如何在项目属性中设置默认值？

请看我的代码：

```
[CategoryAttribute("Information"), DefaultValue(Size(0, 0))]
public Size AndaazehPixel { get; set; } 
```

我的错误：“System.Drawing.Size”是“类型”，但用作“变量”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T21:43:50.740

试试这样：

```
[DefaultValue(typeof(Size), "0, 0")]
public Size AndaazehPixel { get; set; } 
```

# node.js - 无法删除文件，我没有得到详细的 ENOENT

> ID：12630434
> 
> 赞同：3
> 
> 时间：2012-09-27T21:41:06.667
> 
> 标签：node.js, fs

我正在尝试完成一个简单的任务，删除文件。该错误确实没有告诉我为什么它不能删除该文件。关于它可能是什么以及我将来如何找到更多详细错误的任何想法？

**我的代码：**

```
var fs = require('fs');

fs.unlink('/file/path.jpg', function(err){
    if (err) throw err;
}); 
```

**我的错误：**

```
DEBUG: 

DEBUG: /Users/vartanarabyan/Development/NodeJS/orcha/routes/document.js:67

DEBUG:              if (err) throw err;

DEBUG:                    ^

DEBUG: Error: ENOENT, unlink '/Users/vartanarabyan/Development/NodeJS/orcha/public/uploads/5d78abfefd5ff47398103ada55d9be47'

DEBUG: Program node app exited with code 1 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T21:42:37.877

`ENOENT`意味着`No such file or directory`。您正在尝试删除一个不存在的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T02:36:42.720

好的，通过使用 fs.unlinkSync(path) 解决了问题

# c# - 日历事件插入失败“需要登录”C#/REST

> ID：12630441
> 
> 赞同：2
> 
> 时间：2012-09-27T21:42:00.150
> 
> 标签：c#, events, calendar, oauth-2.0

我创建了一个 Web 应用程序，旨在让人们有机会与我安排约会，我使用业务逻辑来验证时间是否有效。我将所有约会都保留在 Google 日历上。于是我就去 Google API Console 创建了 Web Application Project。我得到了我的 client_id 和秘密。我能够很好地检索访问令牌。我什至有刷新令牌和构建逻辑来自动刷新访问令牌并且工作正常。我使用这个令牌来检索日历事件列表并且工作正常。然后，我使用令牌插入新的日历事件，但出现错误。首先是代码：

```
 public CalendarEvent InsertCalendarEvent(CalendarEditArgs args)
 {
 string url = "https://www.googleapis.com/calendar/v3/calendars/" + HttpUtility.UrlEncode(args.CalendarId) + "/events?&key=" + args.APIKey;

 Web.SetUpPost(url, null, true, JsonConvert.SerializeObject(args.Event), null, null, new { Name = "Authorization", Value = "Bearer " + args.AccessToken }, new { Name = "X-JavaScript-User-Agent", Value = "Easy SPS" });
 string response = null;

 try
 {
 response = Web.GetResponse(); 
 return JsonConvert.DeserializeObject<CalendarEvent>(response);
 }
 catch(WebException e)
 {
 response = new StreamReader(e.Response.GetResponseStream()).ReadToEnd();
 throw new Exception(response, e);
 }

 }

 public void SetUpPost(string url, string parameters, bool json, string body, string clientKey, string clientSecret, params object[] data)
 {
 if (body != null && parameters != null)
 throw new InvalidOperationException("You cannot submit a request body and parameters at the same time.");
 request =  WebRequest.Create(url) as HttpWebRequest;

 if (!json)
 {
 request.ContentType = "application/x-www-form-urlencoded";
 }
 else
 {
 request.ContentType = "application/json";
 }
 request.Headers.Add("Accept-Charset", "utf-8");
 request.Method = "POST";
 request.Referer = "https://www.easy-sps.com";
 request.KeepAlive = true;
 byte[] bytes = null;
 if (body != null || parameters != null)
 {
 bytes = System.Text.Encoding.ASCII.GetBytes(body == null ? parameters : body);
 request.ContentLength = bytes.Length;
 System.IO.Stream os = request.GetRequestStream();
 os.Write(bytes, 0, bytes.Length); //Push it out there
 os.Close();
 }
 else
 {
 request.ContentLength = 0;

 }

 if (data != null)
 {
 foreach (var dataObject in data)
 {
 PropertyInfo prop = dataObject.GetType().GetProperties()[0];
 PropertyInfo prop2 = dataObject.GetType().GetProperties()[1];
 request.Headers.Add(prop.GetValue(dataObject, null).ToString(), prop2.GetValue(dataObject, null).ToString());
 }
 }

 }
 }

The error I get:

 {
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "required",
    "message": "Login Required",
    "locationType": "header",
    "location": "Authorization"
   }
  ],
  "code": 401,
  "message": "Login Required"
 }
} 
```

几个注意事项我实际上并没有使用客户端密钥和客户端密钥，因为它们用于获取令牌而不是使用它。要检索令牌，我确实必须通过离线访问登录到谷歌（我知道这有效，因为谷歌表示即使我不在线，我也会授予对日历的访问权限）。我去了谷歌游乐场，在那里我可以让它工作，但不是在这里。我试图找出我发布的内容和发布的内容之间的区别，但我找不到任何东西。任何帮助将不胜感激。一个多星期以来一直坚持零进度，而且我们知道谷歌不直接支持它的开发人员，只是通过它的论坛，我根本无法在那些论坛中找到我还没有尝试过的东西的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:50:38.207

Google 提供了一个围绕日历 api 的 .Net 包装器。请参阅[.NET 客户端库开发人员指南。](https://developers.google.com/gdata/client-cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:26:55.113

我通过将访问令牌放在 url“access_token=”中解决了我的问题。为什么它在 URL 中有效但在标题中无效，这超出了我的理解。

# javascript - 在谷歌地图中， 如何为自定义标记图像指定多个点击区域？

> ID：12630448
> 
> 赞同：0
> 
> 时间：2012-09-27T21:42:22.177
> 
> 标签：javascript, google-maps-api-3, google-maps-markers

假设我有一个带有自定义圆形图像的地图标记，该图像有两半，一种是黑色，另一种是白色。

是否可以在单击左半部分时指定某个动作，而在单击右半部分时指定不同的动作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:43:29.667

我认为这是可能的，但你必须基本上用一侧的 div 和另一侧的 div 覆盖你的标记。（基本上将你的标记减半）

[Google Maps JavaScript V3 Api 将 div 放在标记上](https://stackoverflow.com/questions/9433058/google-maps-javascript-v3-api-place-div-on-marker)

然后为左右 div 的每个 div 添加一个 onclick 事件，并执行您的点击逻辑事件/例程。

综上所述，我认为使用信息窗口中的一些投票按钮可能更容易完成您尝试完成的工作。

[https://groups.google.com/forum/?fromgroups=#!topic/google-maps-js-api-v3/0Wc_wAQVHGk](https://groups.google.com/forum/?fromgroups=#!topic/google-maps-js-api-v3/0Wc_wAQVHGk)

# actionscript-3 - 找不到 Flash Builder (Flex) Air Project mx.* 库 swc 类 mx.logging.targets::LineFormattedTarget

> ID：12630450
> 
> 赞同：0
> 
> 时间：2012-09-27T21:42:23.543
> 
> 标签：actionscript-3, flash, flash-builder, swc

我项目中的一个队友添加了一个 swc，其中包含一些 mx 日志记录类，现在我的项目无法编译。错误：

```
Class mx.logging.targets::LineFormattedTarget could not be found. 
```

我在最新的 Flash Builder 4.6 上，全新安装。我注意到当我转到项目 > 属性 > Actionscript 编译器然后选择库时，没有像以前那样选择 MX 的选项。任何人都知道如何解决这个问题。我认为 swc 背后的想法是它们是独立的，不需要我添加额外的导入。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:25:57.680

是的，很奇怪......所以在讨论了上面一点之后，我整理了一个示例项目，它可以很好地针对我正在使用的 4.6.0 SDK 编译，我可以在我的 framework.swc 中看到 LineFormattedTarget 类，当我在左侧导航器中的库：

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx"
                       creationComplete="windowedapplication1_creationCompleteHandler(event)">
    <fx:Script>
        <![CDATA[
            import mx.core.mx_internal;
            import mx.events.FlexEvent;
            import mx.logging.targets.LineFormattedTarget;

            protected function windowedapplication1_creationCompleteHandler(event:FlexEvent):void
            {
                var test:LineFormattedTarget = new LineFormattedTarget();
            }

        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

</s:WindowedApplication> 
```

我会检查以确保它在 4.6 引用的库中显示 framework.swc，如果 swc 不存在，请尝试删除框架并将其重新添加到库路径中，如果失败并显示相同的结果，我会查看拉下SDK新鲜。

# c++ - 将可变参数包中的值加载到临时数组中

> ID：12630455
> 
> 赞同：0
> 
> 时间：2012-09-27T21:42:45.827
> 
> 标签：c++, c++11, variadic-templates

这个令人遗憾的冗长示例是我正在尝试编写的一段真实代码的精简版。它有两个问题。首先，正如所写，它不能编译：错误是

```
error: cannot bind ‘std::string’ lvalue to ‘std::string&&’
error:   initializing argument 3 of ‘void pack_arg(datum*, size_t, std::string&&)’ 
```

并且由对 的调用触发`shut_the_door`。`&&`如果我在 的相关重载中取出`pack_arg`，那么它会编译，但生成的代码似乎不必要地复制了两个字符串。其次，我需要确保数组`d`持有指针的所有临时字符串在调用`vprocess`. 现在，生成的代码似乎在调用之前就破坏了它们。

只要我有机会`process`通过可重载的函数调用运行每个参数，我愿意考虑对数组的填充方式进行相当彻底的更改，而独立于所有其他此类参数。（特别是，我怀疑如果我可以在联合中使用临时初始化引用的特殊规则会使问题 2 消失`std::string&`，但由于`datum`数组的每个成员都是通过赋值而不是初始化填充的，所以目前不会工作，我不知道如何通过初始化填充它而不会丢失对 的调用`pack_arg`，这在更大的上下文中是必要的。）

**编辑：**使用`std::forward`between `pack_args`and`pack_arg`似乎没有帮助；我得到完全相同的错误消息。

```
#include <string>
#include <stddef.h>
using std::string;

union datum
{
  const string* s;
  int i;
};

inline void
pack_arg(datum* d, size_t n, int t)
{
  d[n].i = t;
}

inline void
pack_arg(datum* d, size_t n, string && t)
{
  d[n].s = &t;
}

inline void
pack_args(datum*, size_t)
{
}

template <typename X, typename... XS> inline void
pack_args(datum* d, ::size_t n, X&& x, XS&&... xs)
{
  pack_arg(d, n, x);
  pack_args(d, n+1, xs...);
}

extern void vprocess(datum*, size_t);

template <typename... XS> inline void
process(XS&&... xs)
{
  size_t n = sizeof...(xs);
  datum d[n];
  pack_args(d, 0, xs...);
  vprocess(d, n);
}

extern string shut_the_door();

void
demo()
{
  process(1, 2, "buckle my shoe", 3, 4, shut_the_door());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:03:01.900

Luc 带来了一个非常有趣的观点（我简要浏览了代码，只阅读了签名）：

如果您要将指向 的指针存储`std::string`在容器中，那么您的代码*必须*确保参数**不是**右值，因为这将在函数调用完成后留下一个悬空指针。

我对你的代码思考得越多，我就越相信整个事情只是一个坏主意。如果没有每个元素是什么的标签，您就无法知道数组的哪个元素是什么类型。对象的生命周期将很难维护（`std::string`特别是对于 s ......）也许你应该重新考虑设计。

* * *

您遇到了新的 C++11 语法的一个有趣的怪癖。这两个声明中的双与号 ( `&&`) 的含义并不相同：

```
inline void
pack_arg(datum* d, size_t n, string && t);         // [1]
template <typename X, typename... XS> inline void
pack_args(datum* d, ::size_t n, X&& x, XS&&... xs) // [2] 
```

在 [1] 中，类型参数`string&&`将仅绑定到允许区分临时（或`std::move`d 对象）和左值的右值。*右值引用*的行为类似于函数内部的左值。在 [2] 中，因为您在模板中并且`X`是推断类型，所以应用了一组不同的规则，`X&&`并将根据参数解析为左值引用或右值引用。

在您的情况下，参数实际上是临时的，因此`X&&`将被映射到`std::string&&`，但在函数内部它被视为左值，无法绑定。您可以通过添加来解决此问题`std::forward`：

```
template <typename X, typename... XS> inline void
pack_args(datum* d, ::size_t n, X&& x, XS&&... xs)
{
  pack_arg(d, n, std::forward(x));
  pack_args(d, n+1, std::forward(xs)...);
} 
```

模板将`std::forward`根据参数本身是左值还是右值引用来生成左值或右值引用。

# objective-c - NSString 赋值，需要释放吗？

> ID：12630457
> 
> 赞同：1
> 
> 时间：2012-09-27T21:42:58.340
> 
> 标签：objective-c

如果我的班级中有这样的财产：\

```
@interface Test

NSString *str;

@end 
```

在我的.m init 中：

```
str = @"Test"; 
```

我需要在类 dealloc 中手动释放它吗？

这种呢？

```
NSString *myStr = [NSString stringWithFormat:@"%@", someString]; 
```

我也需要释放它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:47:54.300

你真的应该只使用 ARC，但要回答你的具体问题，不：你不需要发布那些。你只释放你“拥有”的东西，你只拥有从包含 [ `new`, `alloc`, `retain`, `copy`] 之一的方法中获得的东西。

也就是说，由于您不拥有这些字符串，因此如果您需要保留（或复制）它们，则应该保留它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:44:54.530

如果您在项目中使用 ARC（自动引用计数），则不必发布。ARC 已为 iOS 5+ 启用，因此如果您的目标是 iOS 5 或更高版本，则无需发布任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T21:48:04.363

两种构造¹创建自动释放的字符串。您需要`retain`它们（明确地或通过分配给保留属性），否则一旦调用自动释放² ，您最终将得到悬空引用。一旦你调用了`retain`一个对象，释放它就成为你的责任。

使用 s 的更稳健的方法`NSString`是使用`copy`属性，而不是保留它们。这样做可以避免在您验证其内容后 `NSMutableString`传递给您的方法的方法发生突变时出现的问题。`init`

* * *

¹我假设您询问的是 Objective C 工具的 pre-ARC 版本；否则，您将无法调用`retain`或`release`显式调用。

²这通常发生在您退出方法后的某个时间，并且控制权会返回给运行循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T21:55:18.890

如果您不确定是否使用 ARC，请尝试释放/保留。如果它显示一条警告说您无法释放/保留，则 ARC 已启用，否则已禁用，您必须保留和释放。

# python - Python 深拉链

> ID：12630462
> 
> 赞同：3
> 
> 时间：2012-09-27T21:43:43.103
> 
> 标签：python, functional-programming

我正在尝试编写像 zip 这样的函数。我不擅长解释我的意思，所以我只会展示我正在尝试做的事情的“代码”。

```
a = [1,2,3,[4,5]]
b = a[:]
zip(a, b) == [(1,1), (2,2), (3,3), ([4,5],[4,5])]
myzip(a, b) == [(1,1), (2,2), (3,3), [(4,4), (5,5)]] 
```

我是如此坚持这一点，它甚至不好笑。我正在尝试使用递归 lambda 以简单的函数式方式编写它，以使我的代码更漂亮。我想要这样的 myzip，因为我想将它的输出与我编写的另一个函数一起使用，该函数将函数映射到树

```
def tree_map(func, tree):
    return map(lambda x: func(x) if not isinstance(x, list) else tree_map(func, x), 
               tree) 
```

我一直在尝试用 zip 做类似的事情，但我似乎无法理解它。有人对我如何编写 myzip 有任何想法吗？

编辑：看看tree_map！是不是很漂亮！至少我是这么认为的，但我的母语是 Scheme :P，而且，我希望 myzip 尽可能深入。基本上，我希望 myzip 保留我通过它的树的结构。此外，myzip 只会处理形状相同的树。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T21:51:59.787

我认为以下应该有效：

```
import collections

def myzip(*args):
    if all(isinstance(arg, collections.Iterable) for arg in args):
        return [myzip(*vals) for vals in zip(*args)]
    return args 
```

结果：

```
>>> a = [1,2,3,[4,[5,6]]]
>>> b = [1,2,3,[4,[5,6]]]
>>> myzip(a, b)
[(1, 1), (2, 2), (3, 3), [(4, 4), [(5, 5), (6, 6)]]] 
```

请注意，我在类型检查中使用[`collections.Iterable`](http://docs.python.org/library/collections.html#collections.Iterable)而不是，`list`以便行为更像`zip()`元组和其他可迭代对象。

# ruby-on-rails - 遇到异常：# 回溯：

> ID：12630465
> 
> 赞同：3
> 
> 时间：2012-09-27T21:43:54.097
> 
> 标签：ruby-on-rails, railstutorial.org

我正在学习 Ruby on Rails 教程。在第 5 章中，我遇到了另一个我无法弄清楚也找不到解决方案的障碍。

一方面，我的主页消失了，我不知道为什么。也就是说，由于某种原因，无法访问它。

当我运行测试时。我得到以下回复：

**遇到异常：RuntimeError：应用程序已被初始化。回溯：**

有人可以帮忙吗？

* * *

这是回溯（带有一些有用的格式以便于查看）：

```
/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/application.rb:135:in `initialize!'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'

/Users/tomgalpin/rails_projects/sample_app/config/environment.rb:5:in `<top (required)>'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'

/Users/tomgalpin/rails_projects/sample_app/spec/spec_helper.rb:3:in `<top (required)>'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `block in load'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:11:in `block in run'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/forker.rb:21:in `block in initialize'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/forker.rb:18:in `fork'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/forker.rb:18:in `initialize'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `new'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `run'

/Users/tomgalpin/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork/server.rb:48:in `run'

/Users/tomgalpin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1548:in `perform_without_block'

/Users/tomgalpin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1508:in `perform'

/Users/tomgalpin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1586:in `block (2 levels) in main_loop'

/Users/tomgalpin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1582:in `loop'

/Users/tomgalpin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1582:in `block in main_loop' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T07:04:00.167

这为我解决了这个问题：

```
bundle exec spork --bootstrap 
```

# excel - 如何在 Excel 2010 的下拉列表中创建复选框？

> ID：12630467
> 
> 赞同：0
> 
> 时间：2012-09-27T21:44:16.403
> 
> 标签：excel, drop-down-menu, checkbox

有没有办法可以在 Excel 2010 中创建一个带有复选框的下拉列表，以便我可以从下拉列表中选择多个项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:57:11.687

使其成为一个列表框并将 MultiSelect 参数设置为 fmMultiSelectExtended 或 fmMultiSelectMulti。它不会是下拉菜单，但它是您最好的选择。

# sql - 具有多个不同 COUNT 和 WHERE 子句的 Microsoft SQL

> ID：12630471
> 
> 赞同：1
> 
> 时间：2012-09-27T21:44:49.343
> 
> 标签：sql

我在 Microsoft SQL Server 中有一个数据，格式如下：

```
id1 id2 month   quantA  quantB  
1   10  1   5   15  
1   10  1   10  20  
1   10  2   5   10  
1   10  2   10  NULL  
1   11  1   NULL    NULL  
1   11  2   5   NULL  
1   11  2   10  5  
2   10  1   10  20  
2   10  1   5   NULL  
2   11  2   NULL    NULL 
```

我需要构建一个按以下列分组`id1`的表：`month`

```
id1  
month  
var1 = count how many *distinct* id2 by month and id1 for which quantA!=Null  
var2 = count how many *distinct* id2 by month and id1 for which quantB!=Null 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:58:06.833

您可以基本上按照您的编写方式构建查询：

```
select id1, month,
       count(distinct case when quantA is not null then id2 end) as var1,
       count(distinct case when quantB is not null then id2 end) as var2
from t
group by id1, month 
```

`COUNT DISTINCT`计数时忽略 NULL。

# sdl - C - SDL_image -> 从自定义资源文件加载图像

> ID：12630473
> 
> 赞同：0
> 
> 时间：2012-09-27T21:44:51.083
> 
> 标签：sdl, jpeg, sdl-image

我正在尝试从自定义资源文件中获取 SDL_Surface*。这个自定义资源文件，是用这个代码得到的； [http://content.gpwiki.org/index.php/C:Custom_Resource_Files](http://content.gpwiki.org/index.php/C:Custom_Resource_Files)

我打包了一个文件夹，其中包含一个位图、一个 jpeg 和一个 WAV 声音。

我有一个函数返回一个缓冲区，然后通过这个缓冲区，我可以使用 SDL_Rworps* 加载一个表面。

**当我尝试使用 SDL 获取我的 BMP 图像时，它工作正常。**

但我的问题是使用 sdl_image 来获得与 JPG 和 PNG 相同的效果。

这是一些代码；

**该函数读取资源文件 (*resourcefilename) ，并搜索我们想要获取的文件 (*resourcename)。最后一个 int 参数是处理文件大小的指针**

```
char *GetBufferFromResource(char *resourcefilename, char *resourcename, int *filesize)
{
    //Try to open the resource file in question
    int fd = open(resourcefilename, O_RDONLY);
    if (fd < 0){perror("Error opening resource file");  exit(1);}
    //Make sure we're at the beginning of the file
    lseek(fd, 0, SEEK_SET);
    //Read the first INT, which will tell us how many files are in this resource
    int numfiles;
    read(fd, &numfiles, sizeof(int));
    //Get the pointers to the stored files
    int *filestart = (int *) malloc(sizeof(int) * numfiles);    // this is probably wrong in the zip
    read(fd, filestart, sizeof(int) * numfiles);

    //Loop through the files, looking for the file in question
    int filenamesize;
    char *buffer;
    int i;
    for(i=0;i<numfiles;i++)
    {
        char *filename;
        //Seek to the location
        lseek(fd, filestart[i], SEEK_SET);
        //Get the filesize value
        read(fd, filesize, sizeof(int));
        //Get the size of the filename string
        read(fd, &filenamesize, sizeof(int));
        //Size the buffer and read the filename
        filename = (char *) malloc(filenamesize + 1);
        read(fd, filename, filenamesize);
        //Remember to terminate the string properly!
        filename[filenamesize] = '\0';
        //Compare to the string we're looking for
        if (strcmp(filename, resourcename) == 0)
        {
            //Get the contents of the file
            buffer = (char *) malloc(*filesize);
            read(fd, buffer, *filesize);
            free(filename);
            break;
        }
        //Free the filename buffer
        free(filename);
    }

    //Release memory
    free(filestart);
    //Close the resource file!
    close(fd);
    //Did we find the file within the resource that we were looking for?
    if (buffer == NULL)
    {
        printf("Unable to find '%s' in the resource file!\n", resourcename);
        exit(1);
    }

    //Return the buffer
    return buffer;
} 
```

**现在这是我的函数返回一个 SDL_Surface* （对于 BMP ）注意这个函数使用 SDL_Image "IMG_LoadBMP_RW()"**

```
SDL_Surface *LoadBMP(char *resourcefilename, char *imagefilename){

   //Get the image's buffer and size from the resource file
    int filesize = 0;
    char *buffer = GetBufferFromResource(resourcefilename, imagefilename, &filesize);

    //Load the buffer into a surface using RWops
   SDL_RWops *rw = SDL_RWFromMem(buffer, filesize);
   if(IMG_isBMP(rw))
      printf("This is a BMP file.\n");
   else
      printf("This is not a BMP file, or BMP support is not available.\n");

    SDL_Surface *temp = IMG_LoadBMP_RW(rw);
   free(buffer);
    //Return our loaded image
    printf("IMG size: %d x %d\n", temp->w, temp->h);
    SDL_Surface *image;
    image = SDL_DisplayFormat(temp);
   SDL_FreeSurface(temp);
    return image;
} 
```

但是当我尝试使用为 JPG 修改的相同功能时，我进入了我的标准输出：

*这不是 JPG 文件，或者 JPG 支持不可用。*

我请求您的帮助，如果有人需要，我可以上传整个源代码，或者至少是带有资源文件的简化版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T12:40:36.837

我最近遵循了相同的[SDL 自定义资源教程](http://content.gpwiki.org/index.php/C%3aCustom_Resource_Files)，扩展了它的功能以允许将资源文件解包为原始文件格式。我认为我遇到了与您有关的问题，并且可能会提供对该问题的更多见解。

该代码可以很好地打包和解包教程地址的特定文件类型，即 BMP 和 WAV。它还可以毫无问题地打包和解压缩 OGG 文件。但是，该过程会去除所有换行格式的 TXT 文件。并且在打包/解包过程中的某个地方 PNG 文件已完全损坏。我没有尝试过使用 JPG，但它们可能会遭受与 PNG 相同的命运，如果在打包过程中发生这种情况，那么这可以解释为什么您的 JPG 无法使用 SDL_Rwops 加载。

今晚我将使用 JPG 进行测试，并通过校验和运行前后文件，看看是否有任何差异。

# sql-server-2008 - SQL Server 2008 中具有最大距离语法的全文附近

> ID：12630475
> 
> 赞同：1
> 
> 时间：2012-09-27T21:44:55.030
> 
> 标签：sql-server-2008, tsql, full-text-search

我正在尝试使用具有最大距离的近邻术语编写全文搜索。

据我所知的语法...

```
 <custom_proximity_term> ::= 
  NEAR ( 
     {
        { <simple_term> | <prefix_term> } [ ,…n ]
     |
        ( { <simple_term> | <prefix_term> } [ ,…n ] ) 
      [, <maximum_distance> [, <match_order> ] ]
     }
       ) 

      <maximum_distance> ::= { integer | MAX }
      <match_order> ::= { TRUE | FALSE } 
```

...我应该可以这样使用`NEAR`：

```
'NEAR(term1,term2,5)' 
```

或者

```
'NEAR((term1,term2),5)' 
```

但是总是抛出语法错误。

```
Syntax error near '(' in the full-text search condition 'NEAR((term1, term2), 4, TRUE)'. 
```

即使我尝试从微软示例复制确切的搜索，它也会引发错误：

```
USE AdventureWorks2012
GO

SELECT DocumentNode, Title, DocumentSummary
FROM Production.Document AS DocTable 
INNER JOIN CONTAINSTABLE(Production.Document, Document,
  'NEAR(bracket, reflector)' ) /* doesn't like this */ AS KEY_TBL
  ON DocTable.DocumentNode = KEY_TBL.[KEY]
WHERE KEY_TBL.RANK > 50
ORDER BY KEY_TBL.RANK DESC
GO

Syntax error near '(' in the full-text search condition 'NEAR(bracket, reflector)'. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:58:07.537

对于 SQL 2012(Denali) - 语法可能有点混乱，但如果您仔细查看语法，当使用 maximum_distance 或 match_order 时，术语（简单/前缀）必须用额外的括号括起来。

因此，要进行简单的 NEAR 搜索，您将使用 -

```
SELECT * FROM CONTAINSTABLE(Production.Document, Document, 'NEAR(bracket, reflector)') 
```

并限制您将使用的距离和/或匹配顺序 -

```
SELECT * FROM CONTAINSTABLE(Production.Document, Document, 'NEAR((bracket, reflector), 1, TRUE)') 
```

我**刚刚注意到**SQL2008 标记。'NEAR'在该版本中的[处理方式不同。](http://msdn.microsoft.com/en-us/library/ms189760%28v=sql.100%29.aspx)您可能想要使用的是“term1 NEAR term2”。

# iphone - 为什么应用程序的图标在 iCloud 设置中显示为空白？

> ID：12630481
> 
> 赞同：6
> 
> 时间：2012-09-27T21:45:31.870
> 
> 标签：iphone, objective-c, ios, bundle, icloud

我目前正在为我的应用程序添加 iCloud 支持，但我注意到在 iCloud -> 管理存储设置中我的应用程序的图标丢失了。我在“资源”文件夹的 xcode 项目中添加了 Icon-Small.png/Icon-Small-50.png 以及它们的 @2x 版本，然后在 Info.plist 中添加了它们的名称，但它仍然显示为白色。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:53:12.790

您是否构建了应用程序，编译它，并在稍后添加图标？这通常是缓存问题。解决此问题的最佳方法是从您的设备上卸载该应用程序并进行干净的构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:56:25.483

一旦您出现在“设置”中，就像为您的设备注册推送通知一样，就会发生一些缓存。您应该尝试重置所有设置并重新安装。此外，如果它是物理设备，而不是模拟器，请尝试删除应用程序，将日期提前一天，重新安装，它应该绕过该缓存。

# java - Java - 用字节索引数组

> ID：12630482
> 
> 赞同：1
> 
> 时间：2012-09-27T21:45:33.700
> 
> 标签：java, arrays, byte

是否可以基于字节索引 Java 数组？

即类似的东西

```
array[byte b] = x; 
```

我有一个性能非常关键的应用程序，它从文件中读取 b（在上面的代码中），我不希望将其转换为 int 的开销。实现这一目标的最佳方法是什么？使用这种索引方法而不是 int 是否会导致性能下降？

非常感谢，

弗罗斯科伊。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T21:48:59.057

“将其转换为 int”没有任何开销。在 Java 字节码级别，所有`byte`s 都已经`int`是 s。

无论如何，进行数组索引将自动向上转换为`int`无论如何。这些都不会提高性能，而且许多会降低性能。只需使用`int`.

[JVM 规范，第 2.11.1 节](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.11.1)：

> 请注意，表 2.2 中的大多数指令没有整数类型 byte、char 和 short 的形式。没有布尔类型的形式。编译器使用 Java 虚拟机指令对 byte 和 short 类型的文字值的负载进行编码，这些指令在编译时或运行时将这些值符号扩展为 int 类型的值。boolean 和 char 类型的文字值的加载使用在编译时或运行时将文字零扩展为 int 类型的值的指令进行编码。同样，从 boolean、byte、short 和 char 类型的值数组加载是使用 Java 虚拟机指令编码的，这些指令将值符号扩展或零扩展为 int 类型的值。因此，对实际类型 boolean、byte、char 和 short 的值的大多数操作都可以由对计算类型 int 的值进行操作的指令正确执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T21:48:50.860

由于 java 中的所有整数类型都已签名，因此您必须屏蔽掉 b 值的 8 位，前提是您确实希望从文件中读取大于 0x7F 的值：

```
byte b;
byte a[256];
a [b & 0xFF] = x; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T21:48:37.607

不; [数组索引是非负整数 (JLS 10.4)](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.4-120)，但字节索引将被提升。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T21:49:32.403

不，没有性能下降，因为在您读取字节的那一刻，您有时会将其存储在[CPU 寄存器中。](http://en.wikipedia.org/wiki/Processor_register)这些寄存器始终与[WORDs](http://en.wikipedia.org/wiki/Word_%28data_type%29)一起使用，这意味着字节始终“转换”为 int （或 long，如果您在 64 位机器上）。

因此，只需像这样读取您的字节：

```
int b = (in.readByte() & 0xFF); 
```

如果您的应用程序对性能至关重要，那么您应该在其他地方进行优化。

# java - 如何从 iDevice 读取/写入文件？

> ID：12630483
> 
> 赞同：0
> 
> 时间：2012-09-27T21:45:33.207
> 
> 标签：java, file, mp3, ipod

是否有适用于 iOS 设备（即 iPod/iPad/iPhone）的简单库？

我需要做的具体事情是将 mp3 文件传输到连接的 iPod，如果有人有代码片段或其他东西的话。我看不到使用文件系统执行此操作的方法，因为我看不到如何在其中找到我的 iPod。我在想我可能需要以某种方式将它用作媒体设备？

谢谢！:)

PS：我能找到[libipod](http://libipod.sourceforge.net/)，但这是为 c++ 编写的，我不想使用 JNI

# mysql - MySQL选择连接多对多表加上IN和NOT IN

> ID：12630487
> 
> 赞同：3
> 
> 时间：2012-09-27T21:45:54.057
> 
> 标签：mysql, join, exists

我有 3 个表：产品、标签和 products_tags（产品和标签之间的多对多）。在我的架构中，一个产品可以有零到多个标签，一个标签可以有零到多个产品。现在我想选择具有特定标签但没有特定标签的产品。

产品表：

> idproducts / 名称
> 
> 1 / 三星银河
> 
> 2/三星note1
> 
> 3/三星note2
> 
> 4 / iphone 4gs

标签表：

> 身份证/字
> 
> 1 / 三星
> 
> 2 / 银河
> 
> 3/注1
> 
> 4 /注2
> 
> 5 / iphone
> 
> 6 / 4克
> 
> 7个/苹果

Products_Tags表：

> 产品/标签
> 
> 1 / 1
> 
> 1 / 2
> 
> 2 / 1
> 
> 2 / 3
> 
> 3 / 1
> 
> 3 / 4
> 
> 4 / 5
> 
> 4 / 6

我有下面的查询，但它为我提供了带有我**不**想要的标签的产品，因为它们有一些其他标签，并且作为连接的结果，它们出现在结果集中。

> SELECT * FR0M 产品 AS p
> 
> ```
> JOIN products_tags AS pt ON pt.product = p.idproducts
> 
> JOIN tags AS t ON t.idtags = pt.tag
> 
> WHERE t.word IN ('samsung', 'mobile')
> 
> AND t.word NOT IN ('note1', 'note2') 
> ```

如果我想要三星 Galaxy，并且我定义了像“三星”这样的标签，而没有“note1”和“note2”。对此的查询是什么？

PS 我想也许应该使用 EXISTS 或 NOT EXISTS，但我只是无法弄清楚我应该如何使用它们。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:35:06.767

您的查询不起作用，因为连接选择了所有带有标签 samsung 的元素，包括`samsung note 1`and `samsung note 2`。您可以使用`group_concat`对所有标签名称进行分组，然后使用`like`或对它们进行过滤`Regexp`，如下所示：

```
select *, GROUP_CONCAT(t.word) tagname from products as p
  inner JOIN products_tags AS pt ON pt.products = p.productid
  inner Join tags t on t.idtags = pt.tags 
group by p.productid
having tagname not REGEXP 'note1|note2' 
   and tagname REGEXP 'samsung|mobile' 
```

一些重要资源：

*   [Group_Concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)
*   [正则表达式](http://dev.mysql.com/doc/refman/5.0/en/regexp.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:19:47.400

您想要所有带有 samsung 或 mobile 标签但没有 note 1 或 note2 标签的产品吗？

```
SELECT * FR0M products AS p

JOIN products_tags AS pt ON pt.product = p.idproducts

JOIN tags AS tp ON tp.idtags = pt.tag and (tp.word = 'samsung' or tp.word = 'mobile')

JOIN tags AS tn ON tn.idtags = pt.tag and tn.word <> 'note1' and tn.word <> 'note2' 
```

将是一种方式。

您的尝试不起作用，因为任何满足 in 子句的行都不可能满足 not in one。三星和手机都不是note1或note2

上面进行了一次连接以获取三星或移动设备，然后再次连接到标签表（使用不同的别名）以获取所有没有 note1 或 note2 标签的人。

# iframe - 从 prettyPhoto iframe 刷新父页面

> ID：12630495
> 
> 赞同：0
> 
> 时间：2012-09-27T21:46:35.467
> 
> 标签：iframe, prettyphoto

我有一个调用 iframe 模式窗口的父页面，如下所示：

```
<script type="text/javascript" charset="utf-8">
                            $(document).ready(function(){
                                $("a[rel^='prettyPhoto']").prettyPhoto();
                            });

</script> 
```

当 iframe 关闭时，我希望父页面刷新。

我需要向 iframe 添加什么代码？我需要先在父页面上创建回调函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-28T20:44:35.363

我通过回调做到了：

```
<script type="text/javascript" charset="utf-8">
  $(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto(
    {
     modal: true, /*So it can be closed only with the button*/
     callback: function(){
       document.location.reload(true);
    }                       
   })
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T22:55:10.983

如果您仔细查看源代码，prettyphoto 会将 iframe 包装在包含所有按钮的 div 中。iframe 的唯一部分是实际内容。关闭按钮包含在父页面中。您将需要添加一个事件处理程序来`.pp_close`单击事件。

```
<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
  $("a[rel^='prettyPhoto']").prettyPhoto();
  $(".pp_close").click(function () {
    document.location.reload(true);
  });
});
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-10T08:17:25.103

```
<script>
    $(document).ready(function(){
        window.parent.refreshPage();
        window.parent.$.prettyPhoto.close();
    });
</script> 
```

在你打开 iframe 的页面上有这个

```
window.refreshPage = function(){
    setTimeout(function() {
        window.location.reload();
    }, 500);
}; 
```

# actionscript-3 - AS3，Flash - 在类中调用函数？

> ID：12630496
> 
> 赞同：0
> 
> 时间：2012-09-27T21:46:44.763
> 
> 标签：actionscript-3, flash

我正在尝试调用在类中设置的函数..

我怎么能这么叫？

这是我的来源，我想从这个类之外调用“processLogin”。链接到来源： http: [//pastebin.com/aFygyXKZ](http://pastebin.com/aFygyXKZ)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:52:24.417

您可以创建类 main 的新实例。

尝试

```
var m:main = new main();
m.processLogin(); 
```

此外，AS3 最佳实践规定类应以大写字母开头。

您还应该为不需要时间线功能的 DisplayObject 类扩展 Sprite 而不是 MovieClip。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T23:05:14.667

如果你知道你的应用程序中只会有一个 main 类的实例，你可以做的是：

1.  将 main 类实现为[单例类](http://gskinner.com/blog/archives/2006/07/as3_singletons.html)`main.getInstance().processLogin`，在这种情况下，您可以使用或访问 processLogin 方法
2.  只需向包含主类实例的主类添加一个公共静态变量。在这种情况下，您的代码将类似于：

    ```
    package actions {
    import flash.display.MovieClip;
    import flash.events.*;
    import flash.net.*;
    import flash.text.*;

    public static var instance:main;

    public function main(){
    instance = this;
    }

    //The rest of your main class code...
    } 
    ```

    这样，您可以使用`main.instance.processLogin()`.

但是，如果您的应用程序设置为可能有多个主类的实例，那么最好的方法是实例化 main 并使用该实例，如 fa 建议的那样。

# php - FTP文件夹文件从一个目录复制到另一个目录

> ID：12630507
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:47:12.637
> 
> 标签：php, web

我正在尝试将在我的名为“upload”的目录中名为 image (5).jpg 的上传文件复制到另一个名为“images”的目录中。这是我的代码。

```
<?php
       copy(upload/image (5).jpg, images/);

 ?> 
```

我这样做对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:06:26.423

首先，您的图像文件名很糟糕，请不要在文件名中使用空格。也不要在文件名中使用括号。谷歌应用引擎等一些系统很容易将其标记为无效文件名并忽略它。

然后稍微调整一下你的代码行，如下所示：

```
$old_file = 'upload/image_5.jpg';
$new_file = 'images/image_5.jpg';

$copied = copy(old_file, $new_file);

if ($copied) {
   print "file " . $old_file . " is copied to " . $new_file;
} else {
   print "error"; 
} 
```

如果遇到错误，可能文件路径配置不正确。您对该特定目录等没有写入权限。

# spring - 如何使 CDI bean 延迟初始化？

> ID：12630508
> 
> 赞同：6
> 
> 时间：2012-09-27T21:47:13.273
> 
> 标签：spring, cdi, lazy-initialization

我正在使用 CDI 1.0 的 Weld 实现，但我找不到如何让 bean 像在 Spring 中一样懒惰（使用`@Lazy`或`lazy-init`在 XML 中）。有没有办法告诉 CDI`Injector`在启动时不要初始化 bean？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T11:36:10.467

请参阅我的答案： http: [//www.adam-bien.com/roller/abien/entry/lazy_injection_with_javax_inject](http://www.adam-bien.com/roller/abien/entry/lazy_injection_with_javax_inject)

使用

```
 @Inject
Instance<MyObject> object; 
```

bean 仅在需要时才初始化……这不是您想要的吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-27T22:35:47.073

不，这在 CDI 中是不可能的。您可以获得的最接近的事情是创建一个新的 InjectionPoint（使用扩展）实现，该实现提供代理，并且代理将在第一次方法调用时初始化所有内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-09T09:13:37.450

如果您要注入的 bean 在正常范围内（@SessionScoped、@RequestScoped 等），它将被延迟实例化。您在客户端 bean 中得到的是一个代理，它直到您第一次调用代理上的方法时才指向具体实例。

正如其他人已经指出的那样，`@Inject Instance<MyBean> myBeanInstance;`也可以用于建立显式延迟实例化。

# c - 指针操作期间的段错误

> ID：12630513
> 
> 赞同：0
> 
> 时间：2012-09-27T21:47:32.550
> 
> 标签：c, pointers, struct, segmentation-fault, malloc

我在 C 中有以下结构。

```
struct a {
    long state;
    long uid;
    long w, x, y, z, xx, yy, zz, xxx, yyy, zzz;
    char comm[64];
}; 
```

然后我做`malloc`如下。

```
buf = malloc (100 * sizeof(struct a)); 
```

但是，当我尝试按如下方式访问各个结构时，会出现段错误。

```
for (i = 0; i < 100; ++i) {
    tmp = buf + (i * sizeof(struct a));
    printf ("\t>%d>%ld,%ld\n", i, tmp->state, tmp->uid);
} 
```

在前 10 个条目后，我遇到了段错误。我不知道为什么会这样。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T21:49:37.653

如果 buf 是指向结构 a 的指针，则指针数学应该是：

```
tmp = buf + i; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T21:50:15.123

这一行是错误的：

```
tmp = buf + (i * sizeof(struct a)); 
```

您不需要乘以`i`数组中每个元素的大小，这是根据`buf`.

你实际上在做的是

```
tmp = &buf[i * sizeof(struct a)]; 
```

当你真正想做的是

```
tmp = &buf[i]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T21:50:58.953

编译器已经`sizeof()`在指针算术期间处理了进程。因此，

```
ptr + i; 
```

是相同的

```
&ptr[i]; 
```

使用是**错误的**

```
ptr + (i * sizeof(some_type)); 
```

# jboss - 在jboss中使用带有struts 2的注释找不到动作

> ID：12630514
> 
> 赞同：1
> 
> 时间：2012-09-27T21:47:36.217
> 
> 标签：jboss, struts2, annotations, action, convention

该应用程序使用 Jboss 并且有一个包含 war 文件和 jar 文件的 ear 文件。战争占据了我们所有的网页。我注释的动作类在耳朵里的 jar 文件中。从我的谷歌搜索中，我已经使用以下常量设置了我的 struts.xml 文件：

```
<constant name="struts.convention.action.fileProtocols" value="ear,jar,vfsfile,vfszip" />
<constant name="struts.convention.action.disableJarScanning" value="false"/>
<constant name="struts.convention.action.includeJars" value=".*/lightspeed.*?jar(!/)?,.*/lightspeed*?jar(!/)?,.*lightspeed.*?jar(!/)?,.*lightspeed*?jar(!/)?" /> 
```

Jboss 容器启动正常，但我的操作未加载。我已经下载了约定插件的源代码，以查看它用于查找操作类的内容，并且它似乎只在扫描时查看操作类的 war 文件。有没有办法让它在扫描带注释的动作类时查看包含动作类的 jar 文件？

文件结构：
-application.ear
  |--application.war
  |--aplication_logic_actions.jar *<--- 这包含被注释的动作类*

我已经调试了约定插件的代码，这就是我看到我的问题的地方。在*PackageBasedActionConfigBuilder*类和*buildUrlSet()*方法中，它具有以下代码行：

```
UrlSet urlSet = new UrlSet(classLoaderInterface, this.fileProtocols); 
```

在这段代码之后，我得到了大约 200 + url。然后它通过以下代码：

```
if (excludeParentClassLoader) { 
```

这个条件块删除了我所有的 url，因为我猜它们都来自 jboss，并且我将*excludeParentClassLoader*设置为 true。然后它会点击以下代码：

```
urlSet = urlSet.includeClassesUrl(classLoaderInterface); 
```

在此之后，我的 urlset 中有一个 url：

> file:/C:/evolution/trunk/powersports/jboss/server/dms/deploy/http-invoker.sar/invoker.war=file:/C:/evolution/trunk/powersports/jboss/server/dms/deploy/ http-invoker.sar/invoker.war

现在它终于到达了包含 jar 正则表达式的部分

```
List<URL> rawIncludedUrls = urlSet.getUrls();
Set<URL> includeUrls = new HashSet<URL>();
boolean[] patternUsed = new boolean[includeJars.length];

for (URL url : rawIncludedUrls) { 
```

因为 urlset 中有 1 个 url 而我的 jar 不在那里，所以它找不到它们。在运行正则表达式比较代码之前，如何让我的 url 显示在该 url 集中，我一定还缺少其他东西，我只是不知道那是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T05:03:02.257

不确定我认为您需要在 Jboss 的 struts.xml 文件中包含哪些内容

```
<constant name="struts.convention.exclude.parentClassLoader" value="true" /> 
```

有关详细信息，请参阅插件页面[ConventionPlugin-JBoss](http://struts.apache.org/2.x/docs/convention-plugin.html#ConventionPlugin-JBoss)。

默认情况下，Convention 插件不会扫描 jar 文件中的操作。对于要扫描的 jar，其 URL 需要与 struts.convention.action.includeJars 中的至少一个正则表达式匹配

您的 struts.xml 中已经包含包含 jar 的列表。Convention 插件将根据 jar 的 URL 而不是文件名评估正则表达式。

# javascript - 全球曝光 | jQuery 与 Backbone

> ID：12630518
> 
> 赞同：4
> 
> 时间：2012-09-27T21:47:52.187
> 
> 标签：javascript, jquery, backbone.js

Backbone 暴露在前 50 行左右的代码中。

JQuery 在最后 50 行代码左右。

为什么有区别？

这只是随机的开发人员选择吗？或者有没有我在这里看不到的目的。

[Github 骨干网](https://github.com/documentcloud/backbone/blob/master/backbone.js#L1424)

```
Backbone = root.Backbone = {}; // line 33 
```

[jQuery 最新](http://code.jquery.com/jquery-latest.js)

```
window.jQuery = window.$ = jQuery; // near bottom..can someone post github link 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:54:15.603

Backbone 似乎使用对象原型设计并在之后应用特性/功能。

jQuery 似乎创建了一个闭包并稍后将其公开给全局范围，因为在 noConflict-Mode 中可能不公开“$”而只公开“jQuery”。这似乎也确保了“就绪”事件在定义所有操作之前不会过早运行，因为 JS 的回调可能会有一些棘手的竞争条件......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:01:15.250

基于部署上下文的开发人员选择。

*   Backbone（尤其是 Underscore）是作为一个更通用的 JavaScript 库编写的，它被设计为可选地可用于服务器端（Node.js）或浏览器外部使用。因此，它在其中工作的上下文更具可变性，并且它与该上下文的连接更易于与 common.js 和 require.js 等内容一起使用。因此，早期关注的是周围环境，而不是库本身的可用性，特别是因为 Backbone 用于命名空间通常会更加定义和定制的环境（包括开发人员将更积极参与的富浏览器应用程序）在这些担忧中）。

*   jQuery 的设计意图是在 Web 浏览器中使用。因此上下文是固定的，jQuery 可以在命名空间内构建库。jQuery 的重点然后切换到在特定位置（如`$`or `jQuery`）易于使用和易于使用，同时允许避免经常污染的浏览器环境中的冲突：最初是在混乱中提供生命线，而不是适应更大的结构化环境（正如它如何成为插件的守护者而不是促进更高的模块化所证明的那样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T23:40:57.707

好问题。Backbone 可以在服务器端或客户端工作。jQuery 可以在必须存在全局窗口对象的 DOM 环境中工作。在像 Node 这样的服务器端环境中，全局对象被称为`global`.

你很接近，但设置它的 Backbone 源代码中的实际部分实际上是前 2 行和最后一行：

```
(function(){
  var root = this;

  ...
}).call(this); 
```

像大多数框架一样，Backbone 从一个匿名函数开始来封装其设置，但在这种情况下，它在全局范围的上下文中调用该方法，该范围`this`解析为`window`Web 客户端和`global`类似节点的服务器端。

请注意，jQuery 可能不会做这样的事情，因为它依赖于许多 DOM 方法，例如`document.getElementById`. 但是，可以在服务器端创建一个虚拟 DOM 环境来加载 jQuery。请参阅[JSDOM 之](https://github.com/tmpvar/jsdom)类的项目。

以下是我发表的演讲幻灯片，其中涵盖了这个确切的主题： [https ://speakerdeck.com/krunkosaurus/deep-dive-into-backbone-dot-js-internals-plus-underscore-dot-js](https://speakerdeck.com/krunkosaurus/deep-dive-into-backbone-dot-js-internals-plus-underscore-dot-js)

# r - 从两列映射中对多对多关系进行分组

> ID：12630521
> 
> 赞同：4
> 
> 时间：2012-09-27T21:48:05.157
> 
> 标签：r, data.table

我有一个 SQL 表，可以映射作者和书籍。我想将链接的作者和书籍（由同一作者撰写的书籍，以及共同撰写书籍的作者）分组在一起，并确定这些组有多大。例如，如果 JK Rowling 与 Junot Diaz 合着，Junot Diaz 与 Zadie Smith 合着一本书，那么我希望所有三位作者都在同一个组中。

这是一个玩具数据集（h/t Matthew Dowle），其中包含我正在谈论的一些关系：

```
set.seed(1)
authors <- replicate(100,sample(1:3,1))
book_id <- rep(1:100,times=authors)
author_id <- c(lapply(authors,sample,x=1:100,replace=FALSE),recursive=TRUE)
aubk <- data.table(author_id = author_id,book_id = book_id)
aubk[order(book_id,author_id),] 
```

在这里可以看到作者 27 和 36 共同编写了书 2，因此他们应该在同一组中。63 位作者和 3 位作者 100 位相同；和 D、F 和 L 为 4。依此类推。

除了 for 循环之外，我想不出一个好方法，它（你可以猜到）很慢。我尝试了一些`data.table`以避免不必要的复制。有更好的方法吗？

```
aubk$group <- integer(dim(aubk)[1])
library(data.table)
aubk <- data.table(aubk)
#system.time({
for (x in 1:dim(aubk)[1]) {
    if(identical(x,1)) {
        value <- 1L
    } else {
        sb <- aubk[1:(x-1),]
        index <- match(aubk[x,author_id],sb[,author_id])
        if (identical(index,NA_integer_)) {
            index <- match(aubk[x,book_id],sb[,book_id])
            if (identical(index,NA_integer_)) {
                value <- x
            } else {
                value <- aubk[index,group]
            }
        } else {
            value <- aubk[index,group]
        }
    }
    aubk[x,group:=value]
}
#}) 
```

**编辑：**正如@Josh O'Brien 和@thelatemail 所提到的，我的问题也可以表述为从每条边都是一行的两列列表中寻找图的连通分量，两列是连接的节点.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T05:50:21.947

将 500K 节点转换为邻接矩阵对我的计算机内存来说太多了，所以我无法使用`igraph`. 该`RBGL`软件包未针对 R 版本 2.15.1 进行更新，因此也已发布。

在编写了很多似乎不起作用的愚蠢代码之后，我认为以下内容让我得到了正确的答案。

```
aubk[,grp := author_id]
num.grp.old <- aubk[,length(unique(grp))]
iterations <- 0
repeat {
    aubk[,grp := min(grp),by=author_id]
    aubk[,grp := min(grp), by=book_id]
    num.grp.new <- aubk[,length(unique(grp))] 
    if(num.grp.new == num.grp.old) {break}
    num.grp.old <- num.grp.new
    iterations <- iterations + 1
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:01:45.193

这是我对 Josh O'Brien 在评论中链接的一个老问题的回答重新散列（[确定链接在一起的链接剧集组](https://stackoverflow.com/questions/12135971/identify-groups-of-linked-episodes-which-chain-together)）。这个答案使用`igraph`图书馆。

```
# Dummy data that might be easier to interpret to show it worked
# Authors 1,2 and 3,4 should group. author 5 is a group to themselves
aubk <- data.frame(author_id=c(1,2,3,4,5),book_id=c(1,1,2,2,5))

# identify authors with a bit of leading text to prevent clashes 
# with the book ids
aubk$author_id2 <- paste0("au",aubk$author_id)

library(igraph)
#create a graph - this needs to be matrix input
au_graph <- graph.edgelist(as.matrix(aubk[c("author_id2","book_id")]))
# get the ids of the authors
result <- data.frame(author_id=names(au_graph[1]),stringsAsFactors=FALSE)
# get the corresponding group membership of the authors
result$group <- clusters(au_graph)$membership

# subset to only the authors data
result <- result[substr(result$author_id,1,2)=="au",]
# make the author_id variable numeric again
result$author_id <- as.numeric(substr(result$author_id,3,nchar(result$author_id)))

> result
  author_id group
1         1     1
3         2     1
4         3     2
6         4     2
7         5     3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T00:15:15.750

几个建议

```
aubk[,list(author_list = list(sort(author_id))), by = book_id] 
```

将给出作者组列表

以下将为每组作者创建一个唯一标识符，然后返回一个列表

*   书籍数量
*   图书ID列表
*   book_ids 的唯一标识符
*   作者数量

对于每个独特的作者组

```
aubk[, list(author_list = list(sort(author_id)), 
            group_id = paste0(sort(author_id), collapse=','), 
            n_authors = .N),by =  book_id][,
        list(n_books = .N, 
             n_authors = unique(n_authors), 
             book_list = list(book_id), 
             book_ids = paste0(book_id, collapse = ', ')) ,by = group_id] 
```

如果作者顺序很重要，只需删除和`sort`的定义`author_list``group_id`

## 编辑

注意到上述内容虽然有用，但并未进行适当的分组

也许以下将

```
# the unique groups of authors by book
unique_authors <- aubk[, list(sort(author_id)), by = book_id]
# some helper functions
# a filter function that allows arguments to be passed
.Filter <- function (f, x,...) 
{
  ind <- as.logical(sapply(x, f,...))
  x[!is.na(ind) & ind]
}

# any(x in y)?
`%%in%%` <- function(x,table){any(unlist(x) %in% table)}
# function to filter a list and return the unique elements from 
# flattened values
FilterList <- function(.list, table) {
  unique(unlist(.Filter(`%%in%%`, .list, table =table)))
}

# all the authors
all_authors <- unique(unlist(unique_authors))
# with names!
setattr(all_authors, 'names', all_authors)
# get for each author, the authors with whom they have
# collaborated in at least 1 book
lapply(all_authors, FilterList, .list = unique_authors) 
```

# java - 如何通过 JMX 计算 PS Old Gen 上的垃圾收集计数？

> ID：12630524
> 
> 赞同：2
> 
> 时间：2012-09-27T21:48:20.117
> 
> 标签：java, memory-management, garbage-collection

我正在尝试通过 JMX 将老一代的收集计数远程检索到另一个应用程序。我最初的方法是检查 MemoryPool 和 GarbageCollector 对象。我看到在 MemoryPool -> PS Old Gen -> MemoryManagerNames 下我有：

1.  PS MarkSweep

现在，我可以看看 GarbageCollector -> PS MarkSweep -> CollectionCount。但是，PS Eden Space 内存池注册了相同的算法：

1.  PS MarkSweep
2.  PS清除

必须有一种方法可以获取特定于一个池的信息。VisualGC有一个知道的方法：

![视觉gc](../Images/1b19174b934106e47e6c6c0ee93b8b2b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T06:19:10.883

简单地说 - 垃圾收集始终是 JVM 范围的（不是特定于内存池的）。虽然一些算法（例如年轻收集 - PS Scavenge）可能只处理一个池，而其他算法（PS Mark Sweet）正在处理整个堆（eden + old space + perm space）。

所以没有针对伊甸园空间的特定计数 PS Mark Sweep，只有在 JVM 中执行的 PS Mark Sweep 总数。

您在 VisualConsole 中看到的数字与您在 GarbageCollector -> PS MarkSweep -> CollectionCount MBean 中看到的相同。

# oracle - Oracle 导入问题

> ID：12630526
> 
> 赞同：0
> 
> 时间：2012-09-27T21:48:28.740
> 
> 标签：oracle, import, oracle10g, oracle-apex

有人可以帮我解决这个 oracle 导入错误吗？

我已将会话记录粘贴到[http://dpaste.com/807025/](http://dpaste.com/807025/)

如果您查看我的第一次尝试，则没有任何错误，但没有导入任何内容。

如果您查看我的第一次尝试，我必须指定表的名称，然后我得到错误。

问题 ：

1.  是否必须指定要导入的表？导出实用程序不应该只导入转储文件中存在的所有表吗？

2.  如何解决导入中的错误？我有 6.75 GB 可用磁盘空间，但仍然出现此错误。

请指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T02:18:00.250

您应该尝试的第一件事是使用 SYSTEM 用户而不是 LOCALDB 用户进行导入。这将允许`imp`根据需要创建用户和模式对象。但是，这实际上可能无法消除您的错误，它可能只会导致出现不同的错误。

您的导入文件包含每个对象的所有内部 Oracle 规范数据，包括表空间规范。如果您的 XE 数据库的配置方式与您要从中导出的数据库不同，您将遇到一些其他设置问题。

鉴于未知数的数量，您最好先尝试做一些小而简单的事情，然后再尝试实现您的全部目标。例如，以 身份登录您的 XE 数据库`SYSTEM`，创建`WMOS`用户并授予他们基础知识，然后用于`IMP`导入单个小表。一旦你得到一个简单的基本案例工作，你应该能够扩大到你的完整导入。

另一项观察：您使用的是老式`IMP`工具而不是`IMPDP`，这对您施加了一些限制。如果您可以访问主数据库并且可以使用 运行导出`EXPDP`，您*可能会*发现情况更好。

对于它的价值，[dba.stackexchange.com](https://dba.stackexchange.com/)充满了 DBA，并且对这些类型的问题的知识比 SO 上通常介绍的要深入得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T23:48:25.290

从脚本中使用的数据库名称来看，您使用的 Oracle XE 对它将为用户数据创建和使用的存储量有大小限制。Oracle XE 10g 的用户数据限制为 4GB，Oracle XE 11g 的用户数据限制为 11GB。这意味着错误中显示的 create 语句可能会超出限制，因为它以大约 3.4GB 的存储空间启动表。

```
STORAGE(INITIAL 3409969152 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:42:47.310

为了解决这个问题，我终于在我的表空间中添加了一个额外的数据文件，并且导入工作正常。感谢大家的反馈。它帮助我找到了解决方案。

# scala - Scala var/val 局部变量最佳实践

> ID：12630528
> 
> 赞同：2
> 
> 时间：2012-09-27T21:48:33.893
> 
> 标签：scala

我需要在地图中累积结果。在意识到我没有正确使用它们之前，我已经尝试使用 、 和 来执行此`.map`操作`.reduceLeft`。`.foldLeft(init(m))`呼叫需要最新的`expression`地图才能获得正确的答案。

我最终得到了这个，它有效，但我觉得有一个`var`在循环中更新的 Map 有点脏。从 Scala 最佳实践的角度来看，这是否可以接受？有什么好的方法可以更惯用地重写它吗？

```
val acc = "some key name"
val id = "some other key name"
val myColl = List(1, 2, 3, 4, 5)

// oversimplification (these things actually do work and access other keys in the map)
def expression(m:Map[String, Int]) = (m(acc)) + (m(id))
def init(m:Map[String, Any]) = 0

// can this be made better?
def compute(m: Map[String, Int]) = {
  var initMap = m + (acc -> init(m))
  for(k <- myColl) {
    initMap = initMap + (id -> k)
    val exp = expression(initMap)
    initMap = initMap + (acc -> exp)
  }
  initMap(acc)
}

compute(Map()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:43:53.663

我不确定这是否更清洁，但它会避免使用 var：

```
def compute(m:Map[String, Int]) = {
  val initMap = myColl.foldLeft(m + (acc -> init(m)))( (e, k) => 
    e + (id -> k) + (acc -> expression(e + (id -> k))))
  initMap(acc)
} 
```

应该返回相同的结果

# c++ - 使用 boost::property_tree 为我的代码输入文件格式

> ID：12630532
> 
> 赞同：0
> 
> 时间：2012-09-27T21:48:48.277
> 
> 标签：c++, boost, boost-propertytree

我正在考虑为我的代码创建一个输入/日志文件，主要用于两个目的。

1) 能够记录代码运行时使用的所有关键参数，以便将来我可以在需要时重现相同的结果。2）能够启动/恢复代码，无需硬编码代码中的参数。

我对仅使用标头的方法感兴趣，因此我可以简单地将头文件与我的代码一起携带，因此我已经变成了 boost.property_tree。从文档来看，它似乎可以达到目的。我的问题是哪种文件格式最能满足我的需求？我需要一些东西：

1) 易于人类阅读/编辑 2) 可以支持嵌套部分 3) 可以支持评论

默认情况下，我已经转向 xml，但考虑到 boost.property_tree 的解析功能，我不确定这是不是最好的选择。例如，我希望能够解析如下内容：

```
<Grid Type = "AMR">
    <Domain> -1.0 1.0 -1.0 1.0 </Domain>
    <Levels> 10 5 </Levels>
    <Path> /path/to/data.bin </Path>
</Grid> 
```

我希望能够正确且分别地读取`Type`属性以及`Domain`、`Levels`和`Path`部分（例如`Domain`，有 4 个单独的浮点对应于矩形的边缘）。我的代码如下所示：

```
using boost::property_tree::ptree;
ptree pt;

double x = pt.get<double>("Grid.Domain");

std::cout << x << std::endl; 
```

但我不断得到`conversion of data to type "d" failed`。我应该如何解决它？另外，xml 是我拥有的最佳选择还是应该考虑更改为另一种格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:06:26.143

好的，我想我找到了一种处理多个值的方法。一种方法是阅读整个内容`std::string`，然后使用`std::istringstream`您可以非常轻松地将每个部分分开。像这样的东西：

```
std::istringstream iss(pt.get<std::string>("Grid.Domain"));
double xmin, xmax, ymin, ymax;
iss >> xmin >> xmax >> ymin >> ymax; 
```

效果很好。但是我不知道获得`Type`财产的方法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T00:03:16.470

boost::property_tree 还支持 JSON 的序列化/反序列化。JSON 允许使用数组，因此很容易为一个部分存储多个值。您甚至可以将结构存储在 JSON 中（如果您想从程序中持久保存对象的状态，这可能会很方便）。

**重要警告**：boost::property_tree 在内部将值视为字符串，因此，如果您想要可以在程序外部读取的有效 JSON，您将无法直接从使用 boost::property_tree 创建的 JSON 中读取数值而不执行一些操作某种演员表（取决于阅读代码）。

如果在持久文件中保留数值类型对您很重要，我会检查[JSONCpp](http://jsoncpp.sourceforge.net/)。我自己用过它，它很容易启动和运行，而且非常轻巧。

JSONCpp 也支持注释。从 SourceForge 页面：

> 注意：JSON 中曾经支持注释，但为了可移植性而将其删除（Python 不支持类似 C 的注释）。由于注释在配置/输入文件中很有用，因此保留了此功能。

# android - 尝试在 Android 上的 WebView 中显示 ½ 并显示 Ȃ½

> ID：12630542
> 
> 赞同：0
> 
> 时间：2012-09-27T21:49:34.643
> 
> 标签：android, unicode, utf-8, webview

我有一个 WebView，我正在从数据库中加载一个字符串。在那个字符串中有一个 ½ 字符，当我在我的设备上查看它时，它显示为 Ȃ½。我尝试使用 utf-8 和 unicode。我还尝试使用 Java 字符串替换搜索 Ȃ 并将其替换为“”，但它没有用。

```
String description = "½";
WebView webview = (WebView) findViewById(R.id.webview);
webview.loadData(description, "text/html", "utf-8"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:02:00.107

提供给 loadData() 的字符串是通过“数据：URL”加载的，因此需要进行[URL 编码](http://developer.android.com/reference/java/net/URLEncoder.html)

*信用：[这](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/2v9YlQWGvuY)是通过[马特墨菲（CommonsGuy）](https://stackoverflow.com/users/115145/commonsware)。*

# c - C：使用令牌粘贴扩展宏

> ID：12630548
> 
> 赞同：17
> 
> 时间：2012-09-27T21:50:07.643
> 
> 标签：c, macros

所以这是我创建的一些宏：

```
#define MODULE_NAME moduleName
#define MODULE_STRUCT MODULE_NAME ## _struct
#define MODULE_FUNCTION(name) MODULE_NAME ## _ ## name 
```

在这些定义之后，我希望发生以下扩展：

```
MODULE_STRUCT   -->   moduleName_struct
MODULE_FUNCTION(functionName)    -->    moduleName_functionName 
```

但是，当我添加令牌粘贴运算符时， MODULE_NAME 在 MODULE_FUNCTION 和 MODULE_STRUCT 中的扩展不再发生......当将它们粘贴在一起时，似乎将 MODULE_NAME 视为文字字符串。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-27T21:52:35.703

在 C 中，标记粘贴运算符的操作数`##`不展开。

您需要第二级间接来获得扩展。

```
#define CAT(x, y) CAT_(x, y)
#define CAT_(x, y) x ## y 
```

# python - Python：获取给定类别的多个随机行

> ID：12630557
> 
> 赞同：0
> 
> 时间：2012-09-27T21:50:57.467
> 
> 标签：python, random, line, categories

我是一名 Python 初学者，正在尝试为给定类别获取多个随机行。原始文件有三列，但我感兴趣的只是这些类别之一。文件（csv）如下所示：

```
 No,Size,Name
   10,1346,Cat
   24,423,Dog
   289,590,Cat
   12,302,Dog
   351,33,Cat
   51,812,Dog
   91,778,Cat
   1193,465,Cat
   44,178,Dog 
```

没有一行是相同的，我想为每个“名称”随机获取 3 行。这是我到目前为止所拥有的：

```
import random

with open('C:\Users\Owl\file.csv') as f:
    lines = f.readlines()[1:] #Skip heading

for line in lines:
    try:
        name = line[2]
    except:
        continue

for name in lines:
    for lines in random.sample(lines,3):
        print lines

f.close() 
```

但我得到这样的东西：

```
 12,302,Dog
   1193,465,Cat
   10,1346,Cat
   2
   3
   D 
```

而不是这样的：

```
 1193,465,Cat
   10,1346,Cat
   91,778,Cat
   51,812,Dog
   44,178,Dog
   12,302,Dog 
```

在我现在得到的输出中，我没有按“名称”获取行，并且在此之后只是字母/数字。然后，我得到“ValueError：样本大于总体”并终止（实际文件比此处的示例大得多）。

另外，如果可能的话，是否有一种简单的方法可以在输出中按“名称”进行排序？

我已经为此苦苦挣扎了几个小时，在互联网上查找它，但未能解决......有人可以帮助我吗？谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:02:59.323

[`itertools.groupby()`](http://docs.python.org/py3k/library/itertools.html#itertools.groupby)通过使用和[模块](http://docs.python.org/py3k/library/csv.html)[，`csv`](http://docs.python.org/py3k/library/csv.html)您可以更轻松地做到这一点。我们首先制作 a`csv.DictReader`以便我们轻松访问值，然后按`"Name"`列对列表进行排序和分组，然后选择值。

```
import itertools
import csv
import operator
import random

with open("test.csv") as file:
    data = csv.DictReader(file)
    key = operator.itemgetter("Name")
    for name, items in itertools.groupby(sorted(data, key=key), key):
        print(name+":", random.sample(list(items), 3)) 
```

这给了我们：

```
Cat: [{'Size': '33', 'Name': 'Cat', 'No': '351'}, {'Size': '590', 'Name': 'Cat', 'No': '289'}, {'Size': '465', 'Name': 'Cat', 'No': '1193'}]
Dog: [{'Size': '178', 'Name': 'Dog', 'No': '44'}, {'Size': '812', 'Name': 'Dog', 'No': '51'}, {'Size': '302', 'Name': 'Dog', 'No': '12'}] 
```

如果您想制作字典列表，只需简单的[列表推导](http://www.youtube.com/watch?v=t85uBptTDYY&list=UUAuqj5Bs5mTTl1mIVDmuAlw&index=1&feature=plcp)即可轻松完成：

```
[[item["No"], item["Size"], item["Name"]] for item in items] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:02:27.457

你覆盖了很多变量：

*   `name`你的第一个从未`for line in lines`使用过。
*   你循环`for name in lines`，然后不要使用`name`而是开始第二个循环`for lines in random.sample(lines, 3)`：你只是在混淆 Python：现在是什么`lines`？..的一个随机元素，`lines`然后，你返回循环这个新元素。您可以尝试以下方法：

    ```
    for name in lines:
        for row in random.sample(lines, 3):
            ... 
    ```

这会有所帮助，但不是很多：您仍在循环播放原始文件。

我建议你开始建立一个字典来存储每个行的列表`name`

```
names = defaultdict(list)
for line in lines:
    fields = line.split()
    names[fields[2]].append(line) 
```

然后，对于每`name`一个`names`，取一个随机样本作为`random.sample(names[name], 3)`

# ruby-on-rails - 提高此服务器代码查找域的性能？

> ID：12630561
> 
> 赞同：2
> 
> 时间：2012-09-27T21:51:15.070
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, performance, optimization

我们使用 Ruby 来检查域的可用性，但代码运行缓慢。我们在请求之间缓存 Whois 对象会提高性能，但 SO 上的其他帖子表明这只会略微提高性能，如果有的话。

代码是如此简单。我们不确定是否可以进行其他改进，或者我们是否因为 Whois 对象而陷入了缓慢的查找。

bulk_check方法接受要**查找**的域数组。其他一切都是不言自明的。

我们在 Rails 3 上。

有什么建议么？

谢谢！

```
def bulk_check
    domains = params[:domains] || '[]'
    callback = params[:callback] || ''      
    results = []
    threads = []

    # String -> Array
    domains = ActiveSupport::JSON.decode domains

    # Iterate over each domain and spawn new thread to check domain status
    domains.each do |d|
      threads << Thread.new(d) { |my_domain|
        Thread.current['domain'] = my_domain
        Thread.current['status'] = get_domain_status my_domain
      }
    end

    # Wait for threads to finish and update results array
    threads.each do |t| 
        t.join
        results.push [ t['domain'], t['status'] ]
    end

    # Render results
    respond_to do |type|
        type.json { render :json => { :results => results }.to_json, :callback => callback }
    end
end

def get_domain_status domain
    begin
        # Create Whois object
        whois = Whois::Client.new

        # Query Whois for domain data
        result = whois.query domain

        # Prep JSON response
        status = result.available? ? 'available' : 'taken'
    rescue Exception => e
        puts "Exception in parsing '#{domain}' status: #{e.message}"
        status = 'error'
    end

    # Return status
    return status
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T23:01:29.180

由于这并不是真正的 CPU 密集型操作，而是“网络密集型”——考虑使用 Ruby 线程或纤程同时检查多个域。

例如，赛璐珞 gem 让它变得简单易用：[https ://github.com/celluoid/celluoid/](https://github.com/celluloid/celluloid/)

# java - JFileChooser 和 .txt 文件解析问题

> ID：12630563
> 
> 赞同：0
> 
> 时间：2012-09-27T21:51:25.873
> 
> 标签：java, regex, string, file-io, jfilechooser

我无法解决 CCE。此分配要求用户在运行时打开一个 .txt 文件，然后让编译器对特定的正则表达式进行后台解析以确定它们是否匹配（例如，ACC 或 REJ），但问题是用户必须使用 JFileChooser 打开文件。在发布之前我已经做了很多阅读和研究，问题似乎是 JFileChooser，据我所知，它使用 java.io.File 本身，似乎只允许 Scanner 在这种情况下解析 .txt 文件的输入。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/io/class-use/File.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/class-use/File.html)

因此，当我仅使用 Scanner 读取文件中的所有文本行时，它“编译”但所有控制台输出显示为“null null null null null”（例如，如果有五行文本文件）。为方便起见，以下是一个可以接受的 .txt 文件示例（或 ACC，简称 ACC）：**编辑**此示例应将每个规则打印在单独的行上

S:AB A:0A A:e B:1B B:e

我已经提供了我的源代码。请注意，charSequences 只是 Scanner/BR 必须解析的可行正则表达式。此外，如果任何给定的行被拒绝（REJ，简写），我们需要提醒用户然后立即终止。显然我并不像我想的那样理解这些类......也许我需要使用一些东西像 FileReader 一样，我一开始就离基地很远，但我对 Java IO 的一般复杂性感到非常沮丧。这太令人沮丧了，因为我投入了所有这些工作和努力，却很少有任何东西可以展示。

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException; 
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Reader;
import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

public class Simplified 
{

public Simplified() throws Exception
{   
    readLines();
}

public void readLines() throws Exception
{

    //MUST prompt user to use JFileChooser
    JFileChooser ranFi = new JFileChooser();
    //approve condition
    if(ranFi.showOpenDialog(null)==JFileChooser.APPROVE_OPTION)
    {
        //get selected file 
        Comparable<File> file = ranFi.getSelectedFile();
        //create a bufferedReader for the file 
        //BufferedReader br = new BufferedReader((Reader) file);
        BufferedReader br = null;

        //create local String object the refer to file's current line 
        String currentLine;

        /**************************
         * Length(LHS,RHS) = 1,1
         * --CharSequence compilations
         * ******************************
         */
        //ACC
        CharSequence fp100 = "[S][:][A-Ze0-1]";
        //ACC iff is NOT the very first line of text file 
        CharSequence fp101 = "[A-Z&&[^S]][:][A-Ze0-1]";

        /**************************
         * Length(LHS,RHS) = 1,2
         * --CharSequence compilations
         * ******************************
         */
        //ACC 
        CharSequence fp200 = "[S][:][A-Z0-1][A-Z0-1]";
        //ACC iff is NOT the very first line of text file 
        CharSequence fp201 = "[A-Z&&[^S]][:][A-Z0-1][A-Z0-1]";

        /**************************
         * Length(LHS,RHS) = 1,3 
         * --CharSequence compilations
         * ******************************
         */
        //ACC 
        CharSequence fp300 = "[S][:][A-Z0-1][A-Z0-1][A-Z0-1]";
        //ACC iff is NOT the very first line of text file 
        CharSequence fp301 = "[A-Z&&[^S]][:][A-Z0-1][A-Z0-1][A-Z0-1]";

        /**
         * Length(LHS,RHS) = 1,4 
         * --CharSequence compilations
         * ******************************
         */

        //REJ
        CharSequence fp400 = "[.][.][.][.][.][.]";

        //create a Scanner for the file 
        Scanner text = new Scanner((Readable) file);

        try
        {
            br = new BufferedReader((Reader) file);
            //while there are still lines to be read in the file 
            //where currentLine = present line of the bufferedReader
            while((currentLine = br.readLine()) != null)
            {

                //while the scanner still has lines to read in the file 
                while(text.hasNext())
                {

                //to remove trailing whitespace in the file, starting
                //@ the first line in the text file...
                String trimStartLine = currentLine.trim();

                //ALL feasible ACC permutations for starting line 
                if(trimStartLine.contains(fp100)||trimStartLine.contains(fp200)||trimStartLine.contains(fp300))
                {
                    System.out.println("first line valid...");

                }
                //ALL feasible REJ permutations for starting line
                else if(!trimStartLine.contains(fp100)||!trimStartLine.contains(fp200)||!trimStartLine.contains(fp300))
                {
                    System.out.println("invalid first line..." +
                            "...terminating");
                    System.exit(0);
                }

                //once again removing trailing whitespace in the file,
                //this time trimming the whitespace in the second line
                //of the file, provided that iff the first line of the
                //file was valid to begin with...
                String trim2ndLine = currentLine.trim();

                //permutations have now increased to 6 since "[S]" isn't
                //technically required for ANY line other than the first line 
                if(trim2ndLine.contains(fp100)||trim2ndLine.contains(fp101)||trim2ndLine.contains(fp200)||
                        trim2ndLine.contains(fp201)||trim2ndLine.contains(fp300)||trim2ndLine.contains(fp301))
                {
                    System.out.println("2nd line valid...");

                    //only included two line checks for now...
                    //as of now if the first two lines are valid
                    //then print out the remaining lines in the
                    //file...
                    System.out.println(text.nextLine());

                }
                else if(!trim2ndLine.contains(fp100)||!trim2ndLine.contains(fp101)||!trim2ndLine.contains(fp200)||
                        !trim2ndLine.contains(fp201)||!trim2ndLine.contains(fp300)||!trim2ndLine.contains(fp301))
                {
                    System.out.println("invalid 2nd line..." +
                            "...terminating");
                    System.exit(0);
                }
                else
                {
                    System.out.println("no file was selected");
                }

            }//end of inner while
            }//end of outer while 
        }//end of try
                catch (Exception ex)
                {
                    System.out.println(ex.getMessage());
                }   
                finally
                {   
                    try
                    {   //close text while lines remain,
                        //valid or not...
                        if(br != null && text != null){
                            br.close();
                            text.close();
                        }
                    }
                    catch (Exception ex)
                    {
                    }
                }//end of finally 
        System.out.println("end of file successfully reached...");
    }//end of approve option
}//end of method 

public static void main(String[] args) throws    Exception
{
    Simplified mn = new Simplified();
    mn.readLines();
}//end of main

}//end of Simplified.java 
```

底线是，无论源代码中的位置或我的 Scanner 和 BufferedReader 对象的类型转换，我总是得到一个 CCE。任何帮助都将是巨大的。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:57:40.887

1.  `JFileChooser.getSelectedFile`返回 a `File`，我不知道您为什么要尝试将其包装在 a `Comparable<File>`for?? 文件本身实现`Comparable`.
2.  `Scanner`将接受 a`File`作为输入。虽然我对`Scanner`API 没有经验，但我认为您不需要`BufferedReader`，只需`Scanner`使用 a`File`作为它的源来创建就足以让您运行。

他是一个快速测试，你可以试试。

1.  为您自己创建一个包含您需要测试的内容的简单文本文件。
2.  创建一个`Class`只有一个`public static void main(String args[]) {...}`方法的简单对象。

在`main`方法中尝试类似...

```
Scanner scanner = new Scanner(new File("path/to/text/file/text.txt"));
while (scanner.hasNext()) {
    System.out.println(scanner.next());
} 
```

从那里开始添加您的解析逻辑。

# r - 使用 r 中的 ggdendro 向 ggplot 中的树状图添加标签

> ID：12630565
> 
> 赞同：1
> 
> 时间：2012-09-27T21:51:43.143
> 
> 标签：r, ggplot2, dendrogram, hclust

如何将标签添加到 ggdendro 图？我通过阅读 ?dendro_data 意识到我应该使用调用“标签”，但找不到实际实现的示例。任何人都可以演示如何将叶子标签添加到下面的示例中。谢谢

```
require(ggplot2)

hc <- hclust(dist(USArrests), "ave")
dhc <- as.dendrogram(hc,hang=0.1)
ddata <- dendro_data(dhc, type="rectangle")
ggplot(segment(ddata)) + geom_segment(aes(x=x, y=y, xend=xend, yend=yend)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T03:02:28.627

您可以通过调用来添加叶子标签，`geom_text()`使用由 生成的数据框`label(ddata)`。我还使用这样扩展了绘图范围，`scale_y_continuous`因此标签没有截止。

```
p <- ggplot(segment(ddata)) + geom_segment(aes(x=x, y=y, xend=xend, yend=yend))
p + geom_text(aes(x = x, y = y, label = label, angle = -90, hjust = 0), data= label(ddata)) +
  scale_y_continuous(expand = c(0.3, 0)) 
```

但是，`ggdendrogram()`除非您不喜欢这些标签的显示方式，否则最好使用它：

```
ggdendrogram(ddata) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-28T20:39:53.347

通过应用以下内容，我无需大量工作即可在 ggdendro 中绘制悬挂树状图。您只需要构建一个包含叶子位置的标签数据框。这是通过过滤掉点以只取整数来完成的。

```
# tree is a an extracted dendro_data() object.
label_data <- bind_cols(filter(segment(tree), x == xend & x%%1 == 0), label(tree))

ggplot() + 
geom_segment(data=segment(tree), aes(x=x, y=y, xend=xend, yend=yend)) +
geom_text(data=label_data, aes(x=xend, y=yend, label=label, hjust=0, color = LT), size=2) +
coord_flip() + 
scale_y_reverse(expand=c(0.2, 0)) +
theme_bw() +
theme(panel.border = element_blank(),
      panel.grid.major = element_blank(), 
      panel.grid.minor = element_blank(),
      axis.line = element_blank(),
      axis.title = element_blank(),
      axis.text = element_blank(),
      axis.ticks = element_blank(),
      legend.position = "None") 
```

# c# - 从左到右解析阿拉伯语/ RTL 文本

> ID：12630566
> 
> 赞同：7
> 
> 时间：2012-09-27T21:51:47.097
> 
> 标签：c#, string, unicode, right-to-left

假设我有一个 RTL 语言的字符串，例如阿拉伯语，其中包含一些英语：

`string s = "Test:لطيفة;اليوم;a;b"`

注意字符串中有分号。当我使用 Split 命令`string[] spl = s.Split(';');`时，一些字符串以相反的顺序保存。这就是发生的事情：

‏‏‏‏ spl[0] = "‏Test:لطيفة"
spl[1] = "‏"اليوم
spl[2] = ‏"a"
spl[3] = ‏"b"

以上与原版相比，是乱七八糟的。相反，我希望得到这个：

‏‏spl[0] = ‏"Test:اليوم"
spl[1] = "‏لطيفة"
spl[2] = ‏"a"
spl[3] = ‏"b"

我准备编写自己的拆分函数。但是，字符串中的字符也以相反的顺序解析，所以我回到第一方。我只想浏览屏幕上显示的每个字符。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-01T22:29:07.287

正如您的字符串当前所显示的那样，单词 لطيفة 存储在单词 اليوم 之前；اليوم“首先”显示（即更靠左）的事实只是Unicode双向算法在显示文本时的（正确）结果。

即：您以 ("Test:لطيفة;اليوم;a;b") 开头的字符串是用户输入“Test:”，然后是 لطيفة，然后是“;”，然后是 اليوم，然后是“;a;”的结果。乙”。因此，C# 拆分它的方式实际上反映了创建字符串的方式。只是它的创建方式并没有体现在字符串的显示上，因为两个连续的阿拉伯语单词在显示时被视为一个单元。

如果您希望字符串以从左到右的顺序显示阿拉伯语单词，中间有分号，同时也以相同的顺序存储单词，那么您应该在后面加上一个从左到右的标记 (U+200E)分号。这将有效地将每个阿拉伯语单词划分为自己的单元，然后双向算法将分别处理每个单词。

例如，以下代码以与您使用的字符串相同的字符串开头（添加了一个从左到右的标记），但它会根据您期望的方式将其拆分（即, spl[0] = ‏"Test:اليوم", 和 spl[1] = "‏لطيفة"):

```
static void Main(string[] args) {
    string s = "Test:اليوم;\u200Eلطيفة;a;b";
    string[] spl = s.Split(';');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T11:25:48.817

您还可以使用 Microsoft 的 Uniscribe 库。ScriptItemize 方法将为您提供字符簇、它们在原始字符串中的起始索引和 RTL 顺序。使用此信息，您可以找到仅包含阿拉伯语的连续聚类。将它们拆分为';' 并扭转方向会给你你所需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:07:14.567

它们的字符串没有颠倒，但实际上以正确的顺序拆分。RTL 语言在显示时是 RTL，但在内存中它们像英语一样保持“从左到右”。我将尝试演示，这有点困难，因为我没有安装阿拉伯语键盘。

你的字符串是`s = "Arbi/Arbi, Alarbia"`. s[0] 是 A（阿拉伯语 A'in），s[1] 是 R，依此类推。s[4] 是 /，s[9] 是 , 。因此，在拆分时，您会在第一部分获得 s[0:8]，在第二部分获得 s[10:]。

这是处理 RTL 字符串的正确方法。如果你想要反转，你需要自己反转数组。

请记住，在 RTL 和 LTR 之间切换是最令人沮丧的任务之一。您*不知道*要花多长时间弄清楚如何处理 RTL 字符串中的数字或英文单词。您可以做的最好的事情是完全避免该问题，并尝试让 Excel 将字符串显示为 RTL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:04:20.480

它看起来（根据 Reflector）在`Split`内部使用`Substring`并且使用内部函数，该函数只是从左到右复制字母，而不考虑文化。正因为如此，我看不出有任何办法只是反转`Split`返回的数组。

# android - 添加一个片段作为 ListView 标头

> ID：12630567
> 
> 赞同：5
> 
> 时间：2012-09-27T21:51:47.600
> 
> 标签：android, android-listview, android-fragments, android-support-library

我的目标是 API 15 和最低 8 的 android 应用程序。所以我使用支持库来管理片段。我有一组在应用程序的几个部分中使用的片段。

现在，在一个活动中，我在布局中有一个 ListView：

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/listOfEvents"
    android:layout_width="match_parent" android:layout_height="match_parent">
</ListView> 
```

我想在 ListView 标头中添加我的一个片段。我试过这个：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.event_open);

    listOfEvents = (ListView) findViewById(R.id.listOfEvents);

            Fragment fragment = new SortingStandardFragment();
            getSupportFragmentManager()
              .beginTransaction()
                  .add(fragment, null)
              .commit();

            View fragmentView = fragment.getView(); // problem: fragment is null!
            listOfEvents.addHeaderView(fragmentView);
    } 
```

但是我收到一个错误，因为 fragment.getView() 返回 null （api 参考文档说我必须在 add 调用中放置一个 GroupView Id，但是我应该将 GroupView 放在布局中的哪个位置？还有另一种方法可以达到目的吗？ ?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-30T21:22:11.980

我通过创建一个新布局来解决这个问题，该布局仅包含列表标题中我需要的片段：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment
        android:id="@+id/myFragmentEmbedded"
        android:name=".SortingStandardFragment"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

并在活动代码中：

```
LayoutInflater inflater = getLayoutInflater();
header = inflater.inflate(R.layout.myLayout, null);
listOfEvents.addHeaderView(header);

SortingStandardFragmenttitleFragment = (SortingStandardFragment) 
     getSupportFragmentManager()
          .findFragmentById(R.id.myFragmentEmbedded); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-05T20:10:56.903

我想要一个版本，而不必求助于另一个 xml 文件，所以这里是：

```
Fragment fragment = ...
FrameLayout v = new FrameLayout(getActivity());
v.setId(42);
listView.addHeaderView(v, null, false);
FragmentManager fm = getActivity().getSupportFragmentManager();
fm.beginTransaction().add(v.getId(), fragment).commit(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-13T16:40:11.280

如果有人好奇为什么他的第一次尝试失败了：

*   生命周期事件发布到 UI 线程
*   `Fragment.onCreateView`是一个生命周期事件
*   `Activity.onCreate`是一个生命周期事件
*   `.getView()`返回创建的视图`Fragment.onCreateView`
*   `commit`发布生命周期事件

结论：`commit`从返回后的下一个循环中可以看到结果`onCreate`。

阅读文档后，可以尝试强制`commit`立即使用。`getSupportFragmentManager().executePendingTransactions()`

# kml - Google 地球 kml 刷新导致地标的描述气泡关闭

> ID：12630571
> 
> 赞同：1
> 
> 时间：2012-09-27T21:52:08.103
> 
> 标签：kml, google-earth

我的 KML 文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.1">
    <Document>
      <NetworkLink>
        <Link>
          <href>http://localhost/test.php</href>
          <refreshMode>onInterval</refreshMode>
          <refreshInterval>1</refreshInterval>
        </Link>
      </NetworkLink>
    </Document>
</kml> 
```

localhost/test.php 返回：

```
<Document>
  <Placemark>
    <name>Testing</name>
    <description>
      Test
    </description>
    <Point>
      <altitudeMode>absolute</altitudeMode>
      <coordinates>0,0,0</coordinates>
    </Point>
  </Placemark>
</Document> 
```

当您单击图标时，它会打开显示“测试”的气球，然后一秒钟后，当刷新 kml 时，气球会关闭，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T17:54:23.317

为了让气球打开，只需`<open>1</open>`在地标上添加一个标签

```
<Document>
  <Placemark>
    <name>Testing</name>
    <open>1</open>
    <description>
      Test
    </description>
    <Point>
      <altitudeMode>absolute</altitudeMode>
      <coordinates>0,0,0</coordinates>
    </Point>
  </Placemark>
</Document> 
```

但是，这意味着刷新链接时地标将始终处于打开状态（气球显示）。

如果您想刷新 kml 并使气球根据当前状态打开或关闭，那么您需要查看[UPDATE](https://developers.google.com/kml/documentation/kmlreference#update)命令，并使用它仅更新当前加载的 KML 的某些部分，而不是替换（重新加载) 整个 KML。

所以它真的归结为，你为什么首先刷新 KML？

编辑：回答评论中的问题

使用该`CHANGE`功能`UPDATE`

```
<Update> 
    <targetHref>http://www.domain.com/file.kml</targetHref> 
    <Change> 
      <Point targetId="point123"> 
        <coordinates>-95.48,40.43,0</coordinates>
      </Point> 
    </Change> 
  </Update> 
```

`id`这将改变地标的坐标，其中一个`point123`被加载到提到的 kml 中`targetHref`（通过 a 加载`NetworkLink`）

# msdeploy - MSDeploy 3.0 委托部署

> ID：12630572
> 
> 赞同：1
> 
> 时间：2012-09-27T21:52:14.250
> 
> 标签：msdeploy, unauthorized

我一直在尝试`MSDeploy 2.1`通过不是域管理员成员且不是实际本地服务器管理员的用户将项目部署到生产环境 - 无济于事。我发现几篇文章表明 MSDeploy 1、2.0 和 2.1 存在一个错误，导致无法在 MSDeploy 中实际使用委托部署结构。

**有谁知道 MSDeploy 3.0 是否解决了这个问题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:07:06.177

如果通过“委派部署”您指的是允许非管理员部署的 IIS 委派功能，那么，是的，MSDeploy 3 支持这些。我们在内部使用它们，所以我可以确认它有效。

# android - 在自定义 FrameLayout 中旋转多个 ImageView

> ID：12630575
> 
> 赞同：0
> 
> 时间：2012-09-27T21:52:34.713
> 
> 标签：android, android-layout, android-ui, ontouchlistener, android-framelayout

我创建了自定义 FrameLayout。我添加了 1 个主圈和 5 个围绕主圈的另一个圈。我想围绕主圆圈旋转圆圈。

```
public class Circles extends FrameLayout{
ImageView mMainCircle;
ImageView mCircle0;
ImageView mCircle1;
ImageView mCircle2;
ImageView mCircle3;
ImageView mCircle4;    

public Circles(Context context) {
    super(context, null, 0);
    init();
}

public Circles(Context context, AttributeSet attrs) {
    super(context, attrs, 0);
    init();
}

public Circles(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    init();
}

public void init(){
    // set positions, onClick and add
    Cicle.setOnClickListener(mOnClickListener);
    this.addView(mMainCircle);
    this.addView(Circle0);
    this.addView(Circle1);
    this.addView(Circle2);
    this.addView(Circle3);
    this.addView(Circle4);

    }
} 
```

我怎样才能围绕主圈旋转所有圈。我尝试了所有 circleX 的 setOnTouchListener ，但它不起作用。

```
CircleX.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                switch (event.getAction()) {
                case MotionEvent.ACTION_DOWN:

                    break;
                case MotionEvent.ACTION_MOVE:

                    break;
                case MotionEvent.ACTION_UP:

                    break;
                default:
                    break;
                }
                return false;
            }
        }); 
```

如果可能的话，我需要一个代码或示例:)

THX 套件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-07T05:58:37.890

```
 private float angle = 0f;
    private float theta_old = 0f;
    private RotaryKnobListener listener;
    public interface RotaryKnobListener {
    public void onKnobChanged(int arg);
    }

    public void setKnobListener(RotaryKnobListener l) {
    listener = l;
    }

    private float getTheta(float x, float y) {
    float sx = x - (obj.getWidth() / 2.0f);
    float sy = y - (obj.getHeight() / 2.0f);

    float length = (float) Math.sqrt(sx * sx + sy * sy);
    float nx = sx / length;
    float ny = sy / length;
    float theta = (float) Math.atan2(ny, nx);

    final float rad2deg = (float) (180.0 / Math.PI);
    float thetaDeg = theta * rad2deg;

    return (thetaDeg < 0) ? thetaDeg + 360.0f : thetaDeg;
    }

    public void setRotateListener() {
    mRotateImage.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            float x = event.getX(0);
            float y = event.getY(0);
            float theta = getTheta(x, y);

            switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_POINTER_DOWN:
                theta_old = theta;
                break;
            case MotionEvent.ACTION_MOVE:
                float delta_theta = theta - theta_old;
                theta_old = theta;
                int direction = (delta_theta > 0) ? 1 : -1;
                angle += 3 * direction;

                Log.d("Tag", "rotate angle : " + obj.getHeight());
                obj.setRotation(angle);
                notifyListener(direction);
                break;
            }
            return true;
        }
    });
}

private void notifyListener(int arg) {
    if (null != listener)
        listener.onKnobChanged(arg);
} 
```

# ios - MonoDevelop / XCode 构建成功。构建失败。无效数据

> ID：12630577
> 
> 赞同：3
> 
> 时间：2012-09-27T21:52:35.350
> 
> 标签：ios, xamarin.ios, monodevelop, xcode4.5

我刚刚更新了 Xcode 以用于 iOS 6，出于某种原因，当我构建并尝试在调试 iPhone 模式下部署时，我得到：

```
Build successful.
Build failed. Invalid data 
```

如果我在 iPhone 应用程序/iOS 目标中取出我的 Bundle Identifier，它会给我这个错误：

构建成功。项目未指定捆绑标识符。生成“com.company.app”以匹配配置文件。构建失败。无效数据

我正在使用 Xcode 4.5 和 MonoDevelop 3.0.3.4 和 MonoTouch 5.3.4。

我在包标识符或下划线中没有任何空格。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T21:56:55.550

MonoTouch 5.3.x 和 MonoDevelop 3.0.3.x对于 Xcode 4.5来说有点太*旧了。*

Xcode 4.5 将其中一些文件的`Info.plist`格式从 XML 更改为二进制，并且工具需要一些更新才能使用它们。

MonoTouch 5.4（和 6.0）和 MonoDevelop 3.0.4.x**将**与 Xcode 4.5 一起使用。

# ruby-on-rails - Rails 应用程序在 Heroku 上停止

> ID：12630580
> 
> 赞同：0
> 
> 时间：2012-09-27T21:52:42.360
> 
> 标签：ruby-on-rails, plugins, heroku

> **可能重复：**
> [消除 Rails 2.3 风格的插件和弃用警告](https://stackoverflow.com/questions/9027403/eliminating-rails-2-3-style-plugins-and-deprecation-warnings)

我对 Heroku (keilmiller.herokuapp.com) 上的 rails 3.2.8 应用程序有疑问。

`pg`，`thin`并且`foreman`在我的 gemfile 中用于生产。

我正在使用雪松堆栈。我将我的新应用程序推到了 heroku 上`--force`。我跑去`heroku pg:reset SHARED_DATABASE`清除我的旧数据库。Running`heroku run rake db:migrate`或任何其他 rake 命令会产生错误。

*弃用警告：您在供应商/插件中有 Rails 2.3 风格的插件！*

我没有任何 Rails 插件。我知道我过去遇到过这样的问题，但我猜 Heroku 将支持更改为堆栈溢出。我不能再用 Heroku 查看我的旧票了。任何帮助将非常感激。

为什么我的应用程序停止了？

编辑：我刚刚从 heroku 中删除了我的应用程序，并使用 cedar 堆栈创建了另一个应用程序。新的开始。将我的本地应用程序推送到 heroku。尝试查看页面时出现应用程序错误，尝试运行`heroku run rake`命令时仍然出现插件错误。

编辑：我认为可能与 ruby​​ 版本存在某种不兼容。日志文件有目录`from /app/vendor/bundle/ruby/1.9.1`但`heroku run "ruby -v"`产生 1.9.2。我更新了我的 gemfile 以包含 ruby​​ 1.9.3 并推送到 heroku。Heroku 确实像我的本地环境一样运行 1.9.3，但它输出的日志仍然相同。

编辑：我再次清除了数据库，重新启动了 heroku 应用程序，并获得了一个新日志。

编辑：我的载波初始化程序有问题。固定的。推。发布新日志。`/app/app/helpers/application_helper.rb:2:in`': uninitialized constant FoundationRailsHelper::FlashHelper (NameError) `Something is going on I think with this statement in my application helper`include FoundationRailsHelper::FlashHelper` 使用[https://github.com/sgruhier/foundation_rails_helper](https://github.com/sgruhier/foundation_rails_helper)它在开发模式下完美运行。

当前日志 -+-+-+-+-+-+-+-+-+-+

```
$ heroku logs
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/app/helpers/application_helper.rb:1:in `<top (required)>'
2012-09-28T00:18:17+00:00 app[web.1]: /app/app/helpers/application_helper.rb:2:in `<module:ApplicationHelper>': uninitialized constant FoundationRailsHelper::FlashHelper (NameError)
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:135:in `block in modules_for_helpers'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:131:in `modules_for_helpers'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/helpers.rb:92:in `modules_for_helpers'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:131:in `map!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `block in inherited'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:159:in `default_helper_module!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:95:in `helper'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `class_eval'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `inherited'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/hide_actions.rb:32:in `inherited'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/params_wrapper.rb:135:in `inherited'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/railties/routes_helpers.rb:7:in `block (2 levels) in with'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/railties/paths.rb:7:in `block (2 levels) in with'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/app/controllers/application_controller.rb:1:in `<top (required)>'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-09-28T00:18:17+00:00 app[web.1]:   from config.ru:3:in `require'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-09-28T00:18:17+00:00 app[web.1]:   from config.ru:3:in `block in <main>'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-09-28T00:18:17+00:00 app[web.1]:   from config.ru:1:in `<main>'
2012-09-28T00:18:17+00:00 app[web.1]:   from config.ru:1:in `new'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `eval'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `load'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:181:in `load_rackup_config'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:71:in `start'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/bin/thin:6:in `<top (required)>'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-09-28T00:18:17+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>'
2012-09-28T00:18:18+00:00 heroku[web.1]: Process exited with status 1
2012-09-28T00:18:18+00:00 heroku[web.1]: State changed from starting to crashed
2012-09-28T00:22:06+00:00 heroku[web.1]: State changed from crashed to starting
2012-09-28T00:22:09+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -R config.ru -e production -p 3734`
2012-09-28T00:22:14+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-09-28T00:22:14+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-09-28T00:22:14+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-09-28T00:22:16+00:00 app[web.1]: /app/app/helpers/application_helper.rb:2:in `<module:ApplicationHelper>': uninitialized constant FoundationRailsHelper::FlashHelper (NameError)
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/app/helpers/application_helper.rb:1:in `<top (required)>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:131:in `modules_for_helpers'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:135:in `block in modules_for_helpers'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `class_eval'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:95:in `helper'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `block in inherited'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:159:in `default_helper_module!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:22:in `inherited'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/helpers.rb:92:in `modules_for_helpers'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/helpers.rb:131:in `map!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/hide_actions.rb:32:in `inherited'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/app/controllers/application_controller.rb:1:in `<top (required)>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/railties/paths.rb:7:in `block (2 levels) in with'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_controller/metal/params_wrapper.rb:135:in `inherited'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/abstract_controller/railties/routes_helpers.rb:7:in `block (2 levels) in with'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-09-28T00:22:16+00:00 app[web.1]:   from config.ru:3:in `block in <main>'
2012-09-28T00:22:16+00:00 app[web.1]:   from config.ru:3:in `require'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:181:in `load_rackup_config'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:71:in `start'
2012-09-28T00:22:16+00:00 app[web.1]:   from config.ru:1:in `new'
2012-09-28T00:22:16+00:00 app[web.1]:   from config.ru:1:in `<main>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `load'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/bin/thin:6:in `<top (required)>'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `eval'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'
2012-09-28T00:22:16+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'
2012-09-28T00:22:17+00:00 heroku[web.1]: Process exited with status 1
2012-09-28T00:22:17+00:00 heroku[web.1]: State changed from starting to crashed
2012-09-28T00:27:50+00:00 heroku[web.1]: State changed from crashed to starting
2012-09-28T00:27:53+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -R config.ru -e production -p 55735` 
```

**回答**

由于某种原因，该线程已关闭。我真的不喜欢堆栈溢出。无论如何，“答案”应该是将宝石移出资产组。我不假思索地把它放在那里。解决了这个问题。现在我知道，如果有关于未初始化或丢失的警告，请检查 gem 是否包含在生产中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:17:45.043

[这个答案](https://stackoverflow.com/a/9042604/492404)肯定完全解决了您最初关于 Heroku 部署的弃用警告的问题。基本上，只需忽略这些，直到 Heroku 决定开始更新它们。

如果您在本地构建中没有收到这些警告，那么它们只是 Heroku 正在使用的旧插件。

# c++ - 头文件/cpp文件

> ID：12630582
> 
> 赞同：0
> 
> 时间：2012-09-27T21:53:08.977
> 
> 标签：c++, header

我找不到头文件的用途。为什么我们需要它？C# 中没有标头，您只需编写“使用”即可。

另外，头文件和cpp文件有什么区别？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:07:52.150

回答“头文件的目的是什么”部分，没有人谈论过，将方法定义与实际实现分开允许编译器在对方法的实现进行更改时不重新编译项目中的所有文件.

这是因为调用它的文件仍然以相同的方式调用它（这在标头中定义），并且如果实现更改（在 cpp 文件中），编译器只会编译更改的文件并再次进行链接从而在处理大型项目时节省大量时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:57:34.917

请查看以下[文章](http://blogs.msdn.com/b/ericlippert/archive/2010/02/04/how-many-passes.aspx)，该文章解释了 c# 编译器的工作原理以及它为什么不需要标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:01:22.943

AFAIK没有区别。您始终可以编写完全没有标题的代码：

**a.cpp**

```
class A {
public:
   void foo();
};

void A::foo() {} 
```

**b.cpp**

```
class A {
public:
   void foo();
};

int main() { A a; a.foo(); } 
```

* * *

然而，将头文件用于公共定义更容易、方便且产生更少的错误，否则必须将其写入每个翻译单元 (.cpp)：

**啊**

```
class A {
public:
   void foo();
}; 
```

**a.cpp**

```
#include "a.h"
void A::foo() {} 
```

**b.cpp**

```
#include "a.h"

int main() { A a; a.foo(); } 
```

当然，您只编译 .cpp 文件。但是，标题有“预编译”。

* * *

为什么 C# 不需要标头？我的看法完全不同。在 C# 中，您只有标头，并且`using`仅相当于 C++ `include`。但这只是我个人的看法:D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:21:20.927

您需要更好地了解 .NET、C# 和 IL。它不像“使用”指令那么简单。IL 充满了循环依赖问题，据我所知，微软正在尝试一些巧妙的技巧来解决循环依赖问题，但没有一个是完美的。

也许当你毕业到大项目时，你会遇到循环依赖问题。到那时，只要记住 CPP/HPP 的区别有助于避免循环依赖......

# apache-pig - Load multiple files in pig

> ID：12630584
> 
> 赞同：2
> 
> 时间：2012-09-27T21:53:17.347
> 
> 标签：apache-pig

I am new to pig.

In pig, I want to load multiple files with timestamps at their names.

If I load files between 2012/02/12 to 2012/02/19, the following works

```
$START = "12"
$END = "19"
raw_data = load '/table/status/2012/02/{$START,$END}' using Loader() 
```

Suppose the start date is 2011/12/29 and end date is 2012/01/04, how do I change the line of code?

Thanks for any help!

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T08:28:18.937

The range you need can be loaded by using the following globs:

```
raw_data = load '/table/status/{2011/12/{29,3{0,1}},2012/01/0[1-4]}' using Loader() 
```

Note, that Pig uses Hadoop's globbing so what you can use depends on the version of the underlying HDFS. This works under 0.20.

If a more complex range is needed then this way of directory enumeration might be a bit *inflexible*. Therefore consider using a shell script to gather the directories you need as suggested [here](https://stackoverflow.com/questions/3515481/pig-latin-load-multiple-files-from-a-date-range-part-of-the-directory-structur)

# c - 尝试使用 malloc 为自定义结构分配内存时出错

> ID：12630586
> 
> 赞同：0
> 
> 时间：2012-09-27T21:53:23.503
> 
> 标签：c, memory-management, malloc

我正在尝试为我的 c 程序中的自定义堆栈分配一些动态内存。但是，我在 malloc 调用期间收到错误 0xC0000005：访问冲突写入位置 0x00000014。

这是我的结构定义和调用 malloc 的函数：

```
#include <stdio.h>
#include <stdlib.h>

#define EMPTY -1;

typedef enum boolean_tag { TRUE, FALSE } Boolean;
typedef enum direction_tag { ACROSS, DOWN } AnswerDirection;    /*The direction of an answer in the crossword*/

typedef struct answer_tag {
    /*A single 'Answer' is a single node making up a linked list*/
    int answerNumber;
    AnswerDirection direction;
    char *answerString;         /*The answer's value in chars*/
    struct answer_tag *nextAnswer;      /*Points to the next answer in the linked list*/
} Answer;

typedef struct space_tag {
    /*A single space inside of a board*/
    int numberOfCurrentAnswers; /*How many Answers currently cross through the space*/
    char value;
    int x;
    int y;
    struct space_tag *behindSpace;
    struct space_tag *nextSpace;
} Space;

    void InitAnswers(Answer *);
    Space *InitCrossword();
    Space *InitSpace();
    void ProgramClosingCleaning(Space *);

main(){
Space *board;
board = InitCrossword();
ProgramClosingCleaning(board);
}

void InitAnswers(Answer *answerKey){

}

Space *InitCrossword(){
int xLimit, yLimit;         /*Limits set*/
int xTraverse, yTraverse;   /*Coordinate variables to use in traversing*/
Space *currentSpace = NULL;
Space *nextSpace;           
printf("Please enter the size of the board: x y\n");
scanf("%d %d", &xLimit, &yLimit);
for (xTraverse = 0; xTraverse < xLimit; xTraverse++){
    for (yTraverse = 0; yTraverse < yLimit; yTraverse++){
        nextSpace = InitSpace();
        nextSpace->x = xTraverse;
        nextSpace->y = yTraverse;
        nextSpace->numberOfCurrentAnswers = 0;
        nextSpace->value = EMPTY;
        nextSpace->behindSpace = currentSpace;
        currentSpace->nextSpace = nextSpace;
        currentSpace = nextSpace;
    }
}
while (currentSpace->behindSpace != NULL)
    currentSpace = currentSpace->behindSpace;
return currentSpace;
}

Space *InitSpace(){
return (Space *) malloc(sizeof(Space));
}

void ProgramClosingCleaning(Space *currentSpace){
Space *nextSpace;
while (currentSpace != NULL){
    nextSpace = currentSpace->nextSpace;
    free(currentSpace);
    }
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:02:00.720

我看到发布的代码有两个问题（编译器应该发出警告）：

*   的隐式声明，`Init()`这`InitSpace()`意味着它们的返回类型为`int`
*   `Init()`不返回值。

* * *

问题是`InitCrossword()`函数中的这一行：

```
currentSpace->nextSpace = nextSpace; 
```

在循环的第一次迭代中`for`为`currentSpace`NULL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T21:59:47.553

我很确定您使用的语法会创建带有类型的结构，`space_tag`并且`Space`实际上是一个变量（请参阅[http://www.cplusplus.com/doc/tutorial/structures/](http://www.cplusplus.com/doc/tutorial/structures/)）。

试试这个代码：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct Space {
    int numberOfCurrentAnswers;
    char value;
    int x;
    int y;
    struct Space *lastSpace;
    struct Space *nextSpace;
};

main(){
    struct Space *space;
    space = Init();
}

Space *Init(){
    struct Space *nextSpace;
    nextSpace = InitSpace();
}

Space *InitSpace(){
    return (Space *) malloc(sizeof(Space));
} 
```

根据发布的示例代码进行编辑

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:01:56.007

您缺少中的返回功能`Init();`

# python - Python处理sql记录

> ID：12630587
> 
> 赞同：0
> 
> 时间：2012-09-27T21:53:26.563
> 
> 标签：python, database, cx-oracle

这就是我在 Python 中处理来自数据库的记录的方式

代码.py

```
conn = cx_Oracle.connect('pass the connection string')
cursor = conn.cursor()
sql = "select * from emp table"
cursor.execute(sql)
result =cursor.fetchall()

for row in result:
     name = row[0]
     age  = row[1] 
```

问题：有没有办法直接获取列名，而不是硬编码为 row[0],row[1]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:57:16.110

有`cursor`一个`.description`属性；这是一个元组序列。每个元组描述结果中的一列，它的第一个值是名称。

您可以使用它来构造每一行的字典：

```
for x in result:
    row = { d[0].lower(): col for (d, col) in zip(cursor.description, x) }
    name = row['name']
    age = row['age'] 
```

该属性在[Python DB API 2.0](http://www.python.org/dev/peps/pep-0249/)`.description`中有更详细的描述。

# regex - REGEX 强制大写语法

> ID：12630588
> 
> 赞同：2
> 
> 时间：2012-09-27T21:53:29.817
> 
> 标签：regex, forms, passwords

我正在使用 jquery 的验证器插件来验证我的注册表单。我为密码验证制定了一个自定义规则。我使它必须遵循以下规则：
1）必须至少包含 8 个字符
2）必须包含至少 1 个数字
3）必须包含至少 1 个符号
4）必须包含至少 1 个大写字母

这是我的代码：[小提琴](http://jsfiddle.net/UcKW8/4/)

包括这个表达式：

```
/^(?=.*[\W])(?=.*[\d])(?=.*[A-Z]).{8,}$/i 
```

除了最后一个之外，这几乎强制了上述 4 个策略，它不强制必须至少有 1 个大写字母。我不知道为什么，我搜索了所有正则表达式文档以确保我的语法正确。甚至这个唯一的工具也告诉我我是对的：[红宝石](http://rubular.com/r/ps9kwazOKa)

任何想法为什么它不能正常工作？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T21:55:49.733

正`i`则表达式末尾的 使其不区分大小写。因此，您指定的每个大写字母也将匹配相应的小写字母。删除它`i`，它应该可以工作。

# php - 将 Access-Control-Allow-Origin 添加到 PHP 中的标头

> ID：12630589
> 
> 赞同：14
> 
> 时间：2012-09-27T21:53:33.033
> 
> 标签：php, curl, http-headers, cors

我正在尝试解决对 WebGL 应用程序的 CORS 限制。我有一个解析 URL 并返回图像的 Web 服务。由于此 Web 服务未启用 CORS，因此我无法将返回的图像用作纹理。

我打算：

1.  编写一个 PHP 脚本来处理图像请求
2.  图像请求将通过查询字符串作为 url 参数发送

PHP 脚本将：

1.  使用查询字符串 url 调用 Web 服务
2.  获取图像响应（Web 服务返回内容类型：图像响应）
3.  将 CORS 标头 (Add Access-Control-Allow-Origin) 添加到响应中
4.  将响应发送到浏览器

我尝试使用包括 CURL、HTTPResponse、plain var_dump 等在内的各种技术来实现这一点，但在每种技术中都陷入了困境。

所以我有两个问题：

1.  方法是否足够好？
2.  考虑到这种方法已经足够好了：

我在 CURL 方面取得了最大的进步。我可以通过以下方式获取图像标题和数据：

```
$ch = curl_init();
$url = $_GET["url"];
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type:image/jpeg'));

//Execute request 
    $response = curl_exec($ch);

//get the default response headers 
    $headers = curl_getinfo($ch);

//close connection 
    curl_close($ch); 
```

但这实际上并没有改变将响应内容类型设置为 image/jpeg。它将标头 + 响应转储为内容类型 text/html 的新响应，并在浏览器中显示标头和图像 BLOB 数据。

如何让它以我想要的格式发送响应？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-16T22:58:10.020

结果证明，最简单的方法就是答案。只需在发送响应之前插入标题。

```
 $ch = curl_init();
    $url = $_GET["url"];
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, false);

//Execute request 
    $response = curl_exec($ch);

//get the default response headers 
    header('Content-Type: image/jpeg');
    header("Access-Control-Allow-Origin: *");

//close connection 
    curl_close($ch);
    flush(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-08T11:38:55.977

确保 Apache（如果您使用的是 Apache）在使用所有带有标题的东西之前加载了**mod_headers 。**

（以下提示适用于 Ubuntu，不知道其他发行版）

你可以检查加载的模块列表

```
apache2ctl -M 
```

启用 mod_headers 你可以使用

```
a2enmod headers 
```

当然，在 Apache 中进行任何更改后，您必须重新启动它：

```
/etc/init.d/apache2 restart 
```

在此之后尝试将此行添加到您的 .htaccess，或者当然使用 php 标头

```
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
</IfModule> 
```

PHP：

```
header("Access-Control-Allow-Origin: *"); 
```

# c# - 如何在 .NET 中为 Facebook 获取页面 url/路径的句柄？

> ID：12630592
> 
> 赞同：0
> 
> 时间：2012-09-27T21:53:45.420
> 
> 标签：c#, .net, facebook

我必须在我的程序中放置三个不同页面的 Facebook 代码（videoWall.aspx、videoWallDetail.aspx 和 get-involved.aspx）。在头部，我将放置代码并根据需要使用`if`语句进行更改，检查页面以查看应该使用哪些代码。

如何获取页面 url 或路径或任何我可以用来获取唯一页面的内容？

这是我的代码：

```
// if(page = videoWall.aspx)
        <meta property="og:title" content="Faces of Metastatic Breast Cancer (MBC) Video Wall" />
        <meta property="og:type" content="cause" />
        <meta property="og:image" content="http://www.facesofmbc.org/images/MBC_Logo.png"/>
        <meta property="og:url" content="http://bit.ly/rkRwzx" />
        <meta property="og:site_name" content="Faces of Metastatic Breast Cancer (MBC)" />
        <meta property="og:description" content="I just viewed the new Faces of Metastatic Breast Cancer (MBC) video wall. For each view, comment or share of the video wall during October, Genentech will donate $1 to MBC initiatives. Watch TODAY!" />
        <meta property="fb:admins" content="653936690"/> 
```

显然我知道`if`不会那样工作，但这只是我想要做的一个例子，然后重复其他两个实例。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T16:11:48.100

Page.Request.Url.ToString() 将向您显示条目网址...

您可以使用

Page.Request.Url.ToString().Split('?')[0] 仅查看页面...

# macos - G++ 与 libpng 的链接

> ID：12630593
> 
> 赞同：1
> 
> 时间：2012-09-27T21:53:50.777
> 
> 标签：macos, g++, macports, libpng

我正在尝试使用 C++ 进行一些图像处理。我目前正在使用 OS X 10.7 并仅使用 makefile 和终端编写我的代码。我已经使用 macports 安装了 libpng，但我仍然无法与它链接。

```
g++ main.cpp -llibpng -O2 -o ImageManipulator

g++ main.cpp -lpng -O2 -o ImageManipulator 
```

两者都失败了：

```
ld: library not found for -lpng 
```

和

```
ld: library not found for -llibpng 
```

有人知道如何在 OS X 上为此调用 g++ 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T21:57:16.980

我不认为 macports 确实将其 lib 目录添加到 gcc 搜索的默认路径中。尝试

```
g++ main.cpp -L/opt/local/lib -lpng -O2 -o ImageManipulator 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T21:57:09.910

使用 -L/path/to/library_directory 让 g++ 知道在哪里可以找到 libpng（我忘记了 mac 端口安装库的位置）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T16:47:24.390

尝试安装 gem (Mac OSX / Homebrew) 时遇到此错误。通过运行修复`brew update && brew install libpng && brew link libpng --force`

# python - 无法生成执行文件的正确路径 - python

> ID：12630594
> 
> 赞同：-1
> 
> 时间：2012-09-27T21:53:53.520
> 
> 标签：python, path

我正在尝试从 python 运行 ventrilo 并加入一个频道，

```
 path= 'ventrilo://91.227.221.73:3824/servername=vGames&serverpassword=9929&channelname=CS.vGames.co.il GatherBot -2-/.Team-A&channelpassword=57'

    os.startfile(path) 
```

我进入腹腔的实际路径是：`CS.vGames.co.il GatherBot`，因为通道`-2-/.Team-A`丢失。

我知道这是可以做到的，因为当我从 IRC 客户端执行此操作时，它可以工作。在我的 IRC clinet 中，我使用`%20`空间来使其工作。

在 python 中，我尝试了我在互联网上可以找到的所有内容。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:36:30.823

这里的正确答案是使用 . 构建 URL 的查询字符串部分`urllib.urlencode`。例如：

```
qparams = {
  'servername': 'vGames', 
  'serverpassword': '9929', 
  'channelname': 'CS.vGames.co.il GatherBot -2-/.Team-',
  'channelpassword': '57' }
path = 'ventrilo://91.227.221.73:3824/' + urllib.urlencode(qparams) 
```

如果您从其他地方获得了硬编码的查询字符串，则可以`urllib.quote`在其上使用：

```
qstring = 'servername=vGames&serverpassword=9929&channelname=CS.vGames.co.il GatherBot -2-/.Team-A&channelpassword=57'
path = 'ventrilo://91.227.221.73:3824/' + urllib.quote(qstring) 
```

或者，如果您从其他地方获得了完整的硬编码 URL，则该 URL 应该已经正确编码（使用“%20”表示“”等）。如果您手动编写 URL，您始终可以手动对其进行编码，只需用 %20 替换空格，然后对您注意到的任何其他内容进行编码，直到它起作用……但这通常不是一个很好的工作方式，除了非常快速和肮脏的黑客攻击在口译员周围。

您可以尝试以下操作：使用`urlparse.urlparse`它，然后`encode`使用`quote`查询字符串部分并将其重新组合在一起。但是不能保证它会做正确的事情。你给它垃圾，它不一定知道它是什么垃圾。例如，频道名称中有一个未编码的“/”，所以谁知道它`urlparse`会做什么。更不用说你甚至没有'？引入查询字符串。

因此，您可能需要一些自定义代码来解决该问题。

但最好的解决方案是退后一步：无论 URL 来自何处，都一定有人知道什么是路径、什么是查询字符串以及如何连接查询参数等等；捕获当时的知识并将其传递下去，并以正确的方式做事`urllib.urlencode`。

# asp.net-mvc - Nuget Wifi.Swt SwtSecurityTokenHandler - 我要在身份验证标头中添加什么来获得身份验证？

> ID：12630600
> 
> 赞同：0
> 
> 时间：2012-09-27T21:55:06.247
> 
> 标签：asp.net-mvc, azure, swt, wif, acs

在启用了 WIF 的 Azure 上运行 MVC 4 站点并使用 Wif.SWT dll 使用来自 acs 的 swt 令牌。

```
<microsoft.identityModel>
<service saveBootstrapTokens="true">
  <audienceUris>
    <!--<add value="http://traffictheory.cloudapp.net/" />-->
    <add value="" />
  </audienceUris>
  <issuerNameRegistry type="Microsoft.IdentityModel.Swt.SwtIssuerNameRegistry, Wif.Swt">
    <trustedIssuers>
      <add thumbprint="033F53598E4ED92E51C07238E36BBFF4E67ABAD2" name="https://traffictheory.accesscontrol.windows.net/" />
    </trustedIssuers>
  </issuerNameRegistry>
  <claimsAuthenticationManager type="S_Innovations.TrafficTheory.Web.Security.TrafficTheoryClaimsAuthenticationManager, S-Innovations.TrafficTheory.Web.Security" />
  <federatedAuthentication>
    <cookieHandler requireSsl="false" />
    <wsFederation passiveRedirectEnabled="true" issuer="https://traffictheory.accesscontrol.windows.net/v2/wsfederation" realm="/" reply="/" requireHttps="false" />
  </federatedAuthentication>
  <certificateValidation certificateValidationMode="None" />
  <securityTokenHandlers>
        <add type="Microsoft.IdentityModel.Swt.SwtSecurityTokenHandler, Wif.Swt" />
    </securityTokenHandlers>
    <issuerTokenResolver type="Microsoft.IdentityModel.Swt.SwtIssuerTokenResolver, Wif.Swt" />
  <!--<serviceCertificate>
    <certificateReference findValue="‎417DE8DCA4326B845C189BDE0990673433435524" storeLocation="LocalMachine" storeName="My" x509FindType="FindByThumbprint" />
  </serviceCertificate>-->    
</service> 
```

返回给我的客户的令牌来自

```
var token = HttpContext.Current.User.BootstrapToken(); 
```

它看起来像我可以告诉的 htmlencoded 查询字符串或名称值集合。

我试过了：（客户端是 Windows 8 商店应用程序上的 httpClient）

```
client.DefaultRequestHeaders.Authorization =
                new AuthenticationHeaderValue("Bearer", token);

client.DefaultRequestHeaders.Authorization =
                new AuthenticationHeaderValue("Bearer", System.Net.WebUtility.HtmlDecode(token));

Add("Authorization", string.Format("WRAP access_token=\"{0}\"", token)) 
```

我没有想法。

webapi 站点不对请求进行身份验证。FederatedAuthentication.WSFederationAuthenticationModule.AuthorizationFailed 正在触发。

这就是令牌包含的内容。

```
http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=HM81Sv2xnRD6P%2bm2W2T%2feBAfAhH2ZTMMxSBBOQ1Rxqs%3d&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=uri%3aWindowsLiveID&Audience=http%3a%2f%2f77.75.160.102%3a48451%2f&ExpiresOn=1348778300&Issuer=https%3a%2f%2ftraffictheory.accesscontrol.windows.net%2f&HMACSHA256=C7D9CvmEeGy1xHXFV3WqPn7L9Zm%2bwoXt8Z8IUf0tgmI%3d 
```

这就是我在我的客户身上所拥有的：

```
http://77.55.160.102:48451/api/federation/end?acsToken=http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=HM81Sv2xnRD6P%2bm2W2T%2feBAfAhH2ZTMMxSBBOQ1Rxqs%3d&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=uri%3aWindowsLiveID&Audience=http%3a%2f%2f77.75.160.102%3a48451%2f&ExpiresOn=1348787731&Issuer=https%3a%2f%2ftraffictheory.accesscontrol.windows.net%2f&HMACSHA256=xZT%2blbcV9WSPaJQ2XdEP5gkNJi6ZIp%2fxGveDAllXU7w%3d 
```

这是 ACS 返回给 mvc 控制器的内容：

```
wa=wsignin1.0&wresult=%3Ct%3ARequestSecurityTokenResponse+xmlns%3At%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2005%2F02%2Ftrust%22%3E%3Ct%3ALifetime%3E%3Cwsu%3ACreated+xmlns%3Awsu%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-utility-1.0.xsd%22%3E2012-09-27T23%3A08%3A11.285Z%3C%2Fwsu%3ACreated%3E%3Cwsu%3AExpires+xmlns%3Awsu%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-utility-1.0.xsd%22%3E2012-09-27T23%3A18%3A11.285Z%3C%2Fwsu%3AExpires%3E%3C%2Ft%3ALifetime%3E%3Cwsp%3AAppliesTo+xmlns%3Awsp%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2004%2F09%2Fpolicy%22%3E%3CEndpointReference+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2005%2F08%2Faddressing%22%3E%3CAddress%3Ehttp%3A%2F%2F77.75.160.102%3A48451%2F%3C%2FAddress%3E%3C%2FEndpointReference%3E%3C%2Fwsp%3AAppliesTo%3E%3Ct%3ARequestedSecurityToken%3E%3Cwsse%3ABinarySecurityToken+wsu%3AId%3D%22uuid%3Acb218b5b-62df-47bc-85d4-0d765c13db39%22+ValueType%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2009%2F11%2Fswt-token-profile-1.0%22+EncodingType%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-soap-message-security-1.0%23Base64Binary%22+xmlns%3Awsu%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-utility-1.0.xsd%22+xmlns%3Awsse%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-secext-1.0.xsd%22%3EaHR0cCUzYSUyZiUyZnNjaGVtYXMueG1sc29hcC5vcmclMmZ3cyUyZjIwMDUlMmYwNSUyZmlkZW50aXR5JTJmY2xhaW1zJTJmbmFtZWlkZW50aWZpZXI9SE04MVN2MnhuUkQ2UCUyYm0yVzJUJTJmZUJBZkFoSDJaVE1NeFNCQk9RMVJ4cXMlM2QmaHR0cCUzYSUyZiUyZnNjaGVtYXMubWljcm9zb2Z0LmNvbSUyZmFjY2Vzc2NvbnRyb2xzZXJ2aWNlJTJmMjAxMCUyZjA3JTJmY2xhaW1zJTJmaWRlbnRpdHlwcm92aWRlcj11cmklM2FXaW5kb3dzTGl2ZUlEJkF1ZGllbmNlPWh0dHAlM2ElMmYlMmY3Ny43NS4xNjAuMTAyJTNhNDg0NTElMmYmRXhwaXJlc09uPTEzNDg3ODc4OTEmSXNzdWVyPWh0dHBzJTNhJTJmJTJmdHJhZmZpY3RoZW9yeS5hY2Nlc3Njb250cm9sLndpbmRvd3MubmV0JTJmJkhNQUNTSEEyNTY9OXB6Uk00UmxsSDZUU091dlNkYktpb0x2UjQzZlhIaTB6OWEzQVZ0dXNHcyUzZA%3D%3D%3C%2Fwsse%3ABinarySecurityToken%3E%3C%2Ft%3ARequestedSecurityToken%3E%3Ct%3ATokenType%3Ehttp%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2009%2F11%2Fswt-token-profile-1.0%3C%2Ft%3ATokenType%3E%3Ct%3ARequestType%3Ehttp%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2005%2F02%2Ftrust%2FIssue%3C%2Ft%3ARequestType%3E%3Ct%3AKeyType%3Ehttp%3A%2F%2Fschemas.xmlsoap.org%2Fws%2F2005%2F05%2Fidentity%2FNoProofKey%3C%2Ft%3AKeyType%3E%3C%2Ft%3ARequestSecurityTokenResponse%3E 
```

**更新解决方案**simpel 令牌的身份验证部分。

公共静态类 WebApiConfig { 公共静态无效注册（HttpConfiguration 配置） { GlobalConfiguration.Configuration.MessageHandlers.Add(new OAuthAuthenticationHandler()); // GlobalConfiguration.Configuration.MessageHandlers.Add(new TokenValidationHandler());

```
 config.Routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional }
    );
} 
```

}

```
 /// <summary>
    /// Authenticates the ongoing request using Windows Identity Foundation and 
    /// SimpleWebToken (wif.swf). Grabs the token from the header and performs the authentication.
    /// </summary>
public class OAuthAuthenticationHandler : MessageProcessingHandler
{
    ServiceConfiguration _serviceConfiguration;

    public ServiceConfiguration ServiceConfiguration
    {
        get
        {
            if (_serviceConfiguration == null)
                _serviceConfiguration = new ServiceConfiguration();

            if (!_serviceConfiguration.IsInitialized)
                _serviceConfiguration.Initialize();

            return _serviceConfiguration;
        }
    }

    protected override HttpRequestMessage ProcessRequest(HttpRequestMessage request, CancellationToken cancellationToken)
    {
        try
        {
            var token = ExtractTokenFromHeader(request);

            if (token != null)
            {
                var identities = ServiceConfiguration.SecurityTokenHandlers.ValidateToken(token);
                var principal = ClaimsPrincipal.CreateFromIdentities(identities);

               // request.SetUserPrincipal(principal);
                Thread.CurrentPrincipal = principal;
                HttpContext.Current.User = principal;
            }
        }
        catch (InvalidSecurityTokenException)
        {
            throw new HttpException((int)System.Net.HttpStatusCode.Unauthorized, "The authorization header was invalid");
        }

        return request;
    }

    protected override HttpResponseMessage ProcessResponse(HttpResponseMessage response, CancellationToken cancellationToken)
    {
        return response;
    }

    static SimpleWebToken ExtractTokenFromHeader(HttpRequestMessage request)
    {
        var authorizationHeader = request.Headers.Authorization;

        if (authorizationHeader != null && authorizationHeader.Scheme == "OAuth")
            return new SimpleWebToken(authorizationHeader.Parameter);

        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T05:26:09.970

WIF SWT 包不处理带有 Authorization 标头的请求，它只会配置 SWT 处理程序以用于`WSFederationAuthenticationModule`理解 WS-Federation 协议的处理程序。`wresult`WS-Fed 协议期望从HTTP POST的参数中获取令牌。这将有一个以元素`wresult`开头的 XML 。`<RequestSecurityTokenResponseCollection>`在该元素中，您将找到经过 base64 编码的 SWT 安全令牌。NuGet 包的令牌处理程序将对其进行解码和验证，并将其转换为`ClaimsPrincipal`. 您还可以使用该`BootstrapToken`方法访问该令牌。

就是说，对于 Web API，您应该使用 a`DelegatingHandler`而不是 WSFederation 模块来处理身份验证，因为协议不同（POST 与带有标头的 GET）。

看看这个： [https ://github.com/wadewegner/ValidateACSTokenWebAPI/blob/master/WebAPI/TokenValidationHandler.cs](https://github.com/wadewegner/ValidateACSTokenWebAPI/blob/master/WebAPI/TokenValidationHandler.cs)

**编辑**：原始问题有一个替代实现，但它的方法大致相同。

# complexity-theory - 确定给定代码段最坏情况下的时间复杂度

> ID：12630605
> 
> 赞同：0
> 
> 时间：2012-09-27T21:55:40.587
> 
> 标签：complexity-theory

确定最坏情况下的时间复杂度。（显示计算）

```
 int i = 1;
  int j = 4;
  while (i<(n*n)&& j<(n*n*n*n)){
    if (i%3 == 0) i+=3; 
    else i+=4;

    if (j%2 == 0) j*=4;
    else j*=2;          
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:14:37.693

在最坏的情况下，这将在 i 达到 n^2 或 j 达到 n^4 的任何一端运行。变量 i 线性增加，j 每次迭代都呈指数增加。j 每次迭代只是变成 4 的不同幂。

我将在 n^2/3 次迭代后达到 n^2，即 O(n^2)。j 将在 log_4 n^4 次迭代后达到 n^4（其中 log_4 是对数基数 4）。

所以问题是 n^2 或 log(n^4) 哪个更大，答案是响亮的 n^2。

因此这个算法是 O(n^2)

# java - InputStream.skip() 何时跳过少于预期的字节？

> ID：12630606
> 
> 赞同：4
> 
> 时间：2012-09-27T21:55:44.203
> 
> 标签：java, file, io, inputstream, seek

在我的记录器代码中，我使用[FileInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html)来读取日志文件。存储最后从日志文件“byteOffset”读取的文件中的字节数。每当读者必须阅读它会做的日志`FileInputStream.skip(byteOffset)`并从那里读取。在这种情况下，我从[`InputStream.skip()`](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#skip%28long%29)文档中找到了以下声明。

> 跳过并丢弃此输入流中的 n 字节数据。**由于各种原因，skip 方法最终可能会跳过一些较小的字节数**，可能是 0。这可能是由多种条件中的任何一种造成的；在跳过 n 个字节之前到达文件末尾只是一种可能性。

除了文档中提到的内容之外，由于其他原因，实际跳过的数据会与输入有所不同吗？我只是想确定在我的日志阅读器代码中我需要为所有情况做好准备。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:16:56.993

这取决于实施。也许它是一个缓冲流，它只从支持流中读取了 100 个字节，检索更多字节需要更多时间。

（我不认为将那部分放入规范中是一个*好的*`InputStream`决定，但现在不可能改变。）

# ada - Ada：包不允许有body

> ID：12630609
> 
> 赞同：5
> 
> 时间：2012-09-27T21:55:58.473
> 
> 标签：ada, gnat

使用 GNAT 编译器，当我尝试编译或检查以下文件的语义时，我得到了一些错误的变体`package "Foo" does not allow a body`。我是这门语言的新手，在 Internet 上的任何地方都找不到这个看似基本问题的答案。请指教。

**foo.ads**

```
package Foo is
   type Shape_Enum is (Circle, Triangle, Rectangle);
end Foo; 
```

**foo.adb**

```
package body Foo is
   procedure Foo is
      MyShape : Shape_Enum;
   begin
      MyShape := Rectangle;
   end Foo;   
end Foo; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T22:16:17.307

仅当规范包含*需要*主体的内容时，才允许包具有主体。（这避免了可选主体可能意外地被排除在构建之外的问题。）

您在包体 ( `Foo.Foo`) 中有一个过程，但无法调用它。

如果添加声明：

```
procedure Foo; 
```

根据规范，这应该 (a) 修复错误，并且 (b) 允许程序包的客户端调用该过程。或者，`pragma Elaborate_Body;`如果您不希望该过程对客户可见，则可以使用它来要求它具有主体。

顺便说一句，与包含它的包同名的过程并没有什么特别之处（不像在 C++ 中，这样的函数是包含类的构造函数）。使用不同的名称可能会更清楚。

请参阅 Ada 参考手册的第 7.2 节（我使用的是 2012 标准的最新草案）：

> package_body 应是先前 package_declaration 或 generic_package_declaration 的完成。库 package_declaration 或库 generic_package_declaration 除非需要主体，否则不应有主体；`pragma Elaborate_Body`可以用来要求 library_unit_declaration 有一个主体（见 10.2.1），如果它不需要一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T02:24:57.410

您还可以通过添加以下内容将函数声明为私有：

```
private
    procedure Foo; 
```

到规范。这将防止它在包装外使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:39:36.050

显然，Ada 需要您明确地强制使用`pragma elaborate_body`. 我在这里找到了答案：

[http://objectmix.com/ada/338459-erreur-de-compilation.html#post1225079](http://objectmix.com/ada/338459-erreur-de-compilation.html#post1225079)（感谢上帝，我会说法语）：

**原来的**

> entier_paquetage.adb:4:01: 这个包的规范不允许一个正文
> 
> Si la spec ne demande pas un corps, le corps n'est pas autorisé。在 peut forcer un corps en mettant “pragma expand_body;” 丹斯拉规格。

**英语**

> 如果规范不要求（或要求）主体，则主体将不会被授权。我们可以通过输入“pragma expand_body;”来强制一个body；

# ios - 在 iOS6 之前使用 ARC 时是否仍需要“dealloc”和“viewDidUnload”方法？

> ID：12630611
> 
> 赞同：6
> 
> 时间：2012-09-27T21:56:29.240
> 
> 标签：ios, automatic-ref-counting, xcode4.5

我是一个大型团队的一员，负责处理 iOS 遗留代码，目标 iOS 环境为 4.3 及更高版本。我见过其他开发人员签入派生自`NSObject`但没有`dealloc`方法的类。我也见过`UIViewController`不包含`viewDidUnload`方法的后代。当我询问这段代码时，通常的回答是“别担心，ARC 现在会处理这个问题。”

我知道`viewDidUnload`当iOS遇到内存不足的情况时调用它，目的是通过释放可以通过调用重新创建的对象来释放内存`viewDidLoad`，并且`dealloc`当对象的保留计数达到零时调用。对于 UIViewController 对象和后代，这可能意味着之前可能会或可能不会调用“viewDidUnload” `dealloc`。

所以这是我的问题：在 iOS 6 之前的 iOS 版本上使用 ARC 时是否仍然需要方法`dealloc`？`viewDidUnload`

如果答案是“**是！** ”那么我将需要充分的理由和/或文件来进行论证。

期待您的回复。（感谢汤米帮助我加强了我的问题。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-27T22:03:10.403

`viewDidUnload` [已弃用](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/viewDidUnload)。因此，无论 ARC 是什么，您不仅不需要而且不应该使用。声明的理由是视图不再因内存不足警告而被清除（大概是因为它们现在对总数的贡献太小，不值得响应性打击）；`viewDidLoad`如果部分理由是很多人认为他们可以释放内部创建的所有资源`viewDidUnload`并且仅此一项就可以防止泄漏，我不会感到惊讶。这不是真的，因为`viewDidUnload`仅当视图**因内存不足警告而**被卸载时才调用。在正常的生命周期中不会调用它。

根据[ARC 的新规则](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)：

> 如果您需要管理资源而不是释放实例变量，您可以实现一个 dealloc 方法。您不必（实际上您不能）释放实例变量

编辑：特别评论4.3+...

ARC 不会`viewDidUnload`为您实现一个版本。`viewDidLoad`/循环的要点`viewDidUnload`是，如果您`retain`出于任何原因进入视图层次结构的任何部分，那么您将导致它不会在内存不足警告时自动释放，但这样做不会给您带来任何好处，因为只要接下来加载视图，您保留的任何内容都将被新副本替换。因此，如果您无论如何`strong` `IBOutlet`都拥有位于下面层次结构中的视图，`self.view`那么理想情况下，您会在`viewDidUnload`. 即使您有`weak`引用，这也是防止自己继承任何悬空指针的好地方。

从 iOS 5 开始，您可以拥有自归零弱引用，因此`viewDidUnload`如果您支持 5+，则使用这些而不是实现将是可行的方法。对于 4.3，如果您使用强引用并省略`viewDidUnload`，您最终可能会像 Apple 所希望的那样彻底阻止对低内存警告的响应，但您不会泄漏内存。如果您使用弱引用，那么在您可能没有视图的时候（即，任何时候您没有显示但视图之前已加载 - 设置器）时，您需要小心不要引用任何这些对象在控制器上同时调整视图但受另一个视图影响的控制器是一个经典示例；例如，如果您通过键值观察来更新字段）。

您可以使用模拟器的“模拟内存警告”在一定程度上测试和调试这些东西。

`dealloc`无论 iOS 版本如何，ARC 提供的都是相同的。但是它只涵盖了 Objective-C 对象。当他们说您不能释放实例变量时，他们的意思是字面意义上的`release`向他们发送消息。假设您有 Core Foundation 对象或执行了纯 C 内存分配，那么您将希望实现一个`dealloc`处理所有这些对象的方法。

显然 Instruments 和 Leaks 工具是测试和调试该区域的方法；任何时候内存泄漏都要小心检查创建该内存的对象类型是否也被泄漏。直接对象可以很好，但如果它没有`dealloc`因为其他人泄漏它，它的分配将出现在泄漏列表中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T22:01:35.017

`viewDidUnload`现在已弃用并且不再被系统调用（从 iOS 6 开始）。它从来没有像苹果希望的那样有用，而且麻烦多于它的价值。这与 ARC 无关。

`dealloc`在 ARC 下通常不需要，但在需要非 ARC 资源管理的情况下仍然是必需的。例如，如果您需要使用`free()`，或者以其他方式释放资源。这也是一个将自己作为观察者或代表移除的好地方。但是现在很多类都不需要`dealloc`.

# c++ - C++ 对 40 字节数组执行 bit_count 和 AND 操作的快速高效方法

> ID：12630614
> 
> 赞同：1
> 
> 时间：2012-09-27T21:56:42.930
> 
> 标签：c++, bytearray, bit-manipulation, bitcount

在我的项目中，我需要 AND 两个大小为 40 字节（320 位）的二进制数组，然后计算 C++ 中的设置位计数。我找到了一些算法来做到这一点，但我想知道在 c++ 中实现它的最快方法是什么。我的意思是什么 c++ 数据类型是合适的？（unsinged char*,unsigned int 32,u_int64,...）。我知道许多算法与 32 位整数兼容，尽管我的数组大小是 40 字节。

这个链接中描述的算法怎么样： [快速位计数技术](http://bajeed.blogspot.com/2008/09/bit-counting-techniques.html)哪个更快？

是 const 类型更好还是没有区别？

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T22:07:19.183

> 我的意思是什么 c++ 数据类型是合适的？

`std::bitset<320>`.

您提出的任何算法都应该在速度和便利性上与这个算法进行比较：

```
std::bitset<320> first;
std::bitset<320> other;

// twiddle bits here ...

std::bitset<320> and_result(first & other);
std::size_t number_of_bits(and_result.count()); 
```

如果替代方案没有明显更快，只需使用上述代码。它将清楚地表达您的意图，并将避免以后的维护问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T22:07:23.033

这是一个版本，它一次通过 4 个字节的数组，需要 10 次迭代：

```
uint32_t *arr1_int = (uint32_t*) arr1;
uint32_t *arr2_int = (uint32_t*) arr2;
int i;
int bits_set = 0;

for (i = 0; i < 10; i++) {
    uint32_t v = arr1_int[i] & arr2_int[i];

    /* http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel */
    v = v - ((v >> 1) & 0x55555555);                   
    v = (v & 0x33333333) + ((v >> 2) & 0x33333333);    
    bits_set += ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24;
} 
```

使用现代 CPU，使用编译器内在函数，您可以更快地做到这一点。例如在带有 Visual C++ 的 64 位 CPU 上：

```
#include <intrin.h>

__int64 *arr1_int = (__int64*) arr1;
__int64 *arr2_int = (__int64*) arr2;
int bits_set = 0;

/* 40 / 8 bytes == 5 iterations */
bits_set += __popcnt64(*arr1_int++ & *arr2_int++);
bits_set += __popcnt64(*arr1_int++ & *arr2_int++);
bits_set += __popcnt64(*arr1_int++ & *arr2_int++);
bits_set += __popcnt64(*arr1_int++ & *arr2_int++);
bits_set += __popcnt64(*arr1_int++ & *arr2_int++); 
```

但这一切都考虑到了性能，如果你只是想要一些可读的代码，肯定会符合 Rob 的建议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T22:08:03.910

像这样简单的东西应该足够快：

```
const uint8_t LUT[256] = { 0, 1, 1, 2, ..., 8 }; // pop count LUT for bytes

int count_bits(const uint8_t *a1, const uint8_t *a2, int n)
{
    int count = 0;

    for (int i = 0; i < n; ++i)
    {
        count += LUT[a1[i] & a2[i]];
    }
    return count;
} 
```

每个字节有 3 次加载和 2 次 ALU 操作，即 40 字节用例的 120 次加载和 80 次 ALU 操作。

试一试，分析它，如果它不够快，那么您可以查看可能更快的更复杂的解决方案。

# python - Celery - 我如何让工人在运行 X 个任务后退出？

> ID：12630615
> 
> 赞同：2
> 
> 时间：2012-09-27T21:56:52.633
> 
> 标签：python, celery

我想让一个工人运行 X 个任务，然后退出。我找不到办法做到这一点。我该怎么做呢？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:06:13.343

[`CELERYD_MAX_TASKS_PER_CHILD`](http://docs.celeryproject.org/en/latest/configuration.html#std%3asetting-CELERYD_MAX_TASKS_PER_CHILD)：

> 池工作进程在被新进程替换之前可以执行的最大任务数。默认为无限制。

# magento - 如何使用谷歌产品搜索/谷歌购物设置谷歌分析？

> ID：12630626
> 
> 赞同：0
> 
> 时间：2012-09-27T21:57:20.987
> 
> 标签：magento, google-analytics, google-ads-api

我已经在谷歌产品广告上运行了，我可以在 adwords 仪表板中看到一些展示和链接。

但是，我在 Google 分析的广告选项卡上看不到任何内容

我用这个方法 [http://blog.firstdigital.co.nz/how-to-track-google-shopping-traffic-reliably/](http://blog.firstdigital.co.nz/how-to-track-google-shopping-traffic-reliably/)

但是，当我生成提要时，我会生成这样的网址： [http ://www.theprinterdepo.com/lexmark-fuser-for-c920-40x1056&utm_source=google&utm_medium=shop&utm_campaign=feed](http://www.theprinterdepo.com/lexmark-fuser-for-c920-40x1056&utm_source=google&utm_medium=shop&utm_campaign=feed)

当我尝试它时，它直接进入magento主页

但我想知道是否有更好的经过验证的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:23:29.410

您正在不正确地构建 URL。它需要看起来像这样。

```
http://www.theprinterdepo.com/lexmark-fuser-for-c920-40x1056?utm_source=google&utm_medium=shop&utm_campaign=feed 
```

你需要有吗？在产品的 URI 之后。我通常会向我的客户推荐此链接，它会为您构建 URL。 [http://support.google.com/analytics/bin/answer.py?hl=en&answer=1033867](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1033867)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T14:13:37.377

正如vern在第一个参数之前的url中所说，你需要一个“？”

```
http://www.theprinterdepo.com/lexmark-fuser-for-c920-40x1056?utm_source=google&utm_medium=shop&utm_campaign=feed

```

谷歌分析现在也将自动跟踪广告词标签中的谷歌购物。进入您的 adwords 帐户，查看哪个广告系列有您的产品列表广告。您会在相同的广告系列名称下找到 Google 分析跟踪。

如果您将 Ga 跟踪添加到您的网址，那么您将在您的 Google 分析中复制信息，并且您将计算两次指标。

# javascript - {"error":{"message":"服务需要 JSON-RPC","code":0,"origin":2},"id":null}

> ID：12630627
> 
> 赞同：0
> 
> 时间：2012-09-27T21:57:24.900
> 
> 标签：javascript, jquery, json-rpc

我是 json RPC 的新手。当我键入提供在浏览器中调用方法的服务的 url 时，我收到以下消息：

> {"error":{"message":"服务需要 JSON-RPC","code":0,"origin":2},"id":null}

谁能向我解释这条消息是什么以及我为什么会收到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:46:31.320

JSON RPC 期望客户端使用 HTTP POST 命令和 post 数据中的过程参数向服务器发送参数。当您在浏览器中键入 URL 时，它会发送一个 HTTP GET 命令，该命令不发送任何参数。

RPC 旨在供应用程序使用，而不是直接供最终用户使用。有关它的更多详细信息，请参见[http://json-rpc.org/](http://json-rpc.org/)。

# php - SWF上传拖放

> ID：12630630
> 
> 赞同：0
> 
> 时间：2012-09-27T21:57:49.963
> 
> 标签：php, javascript, jquery, dropbox, swfupload

我目前正在我正在处理的项目中实现 swfupload，我最初开始使用新的 HTML5 文件 API，但决定更改为 swfupload，因为 Dropbox 网络应用程序使用 swfupload 直接从网站执行上传。

Dropbox 网络应用支持使用 swfupload 进行拖放，有人知道 Dropbox 是如何做到这一点的吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:03:27.093

我将实现两个代码路径

*   一种用于支持使用其文件 api 的浏览器的 XMLHttpRequest2（易于实现 DnD 支持）
*   如果使用 swfupload 的 XMLHttpRequest2 不可用（IE），则作为后备

我不知道 Dropbox 是否支持 IE 中的 DnD 上传，但我猜不会。

# concrete5 - 我已将我的 Concrete5 站点升级到 5.6.0，但出现“致命错误，无法打开 /concrete/models/json.php”

> ID：12630635
> 
> 赞同：0
> 
> 时间：2012-09-27T21:58:14.073
> 
> 标签：concrete5

将我的网站升级到 5.6.0 之后，我收到以下错误：

```
Fatal error: require_once() [function.require]: Failed opening required '/concrete/models/json.php' in /concrete/core/libraries/loader.php on line 40 
```

我怎样才能解决这个问题？

* * *

这个问题最终成为了 TweetCrete 包，它已经更新了，但现在已经远远落后了。考虑更新到现代concrete5！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:58:14.073

问题是[*Jereme 的 TweetCrete*](http://www.concrete5.org/marketplace/addons/tweetcrete/)。
使用以下文件，覆盖并删除`loader::model('json')`

*   packages/jereme_tweetcrete/libraries/twitteroauth/twitteroauth.php 第 3 行
*   packages/jereme_tweetcrete/models/tweetcrete_hash_tag.php 第 4 行

* * *

编辑：此软件包最终已更新，不再需要此修改。

# oauth - OAuth1a DNOA 和令牌的流程

> ID：12630636
> 
> 赞同：0
> 
> 时间：2012-09-27T21:58:15.437
> 
> 标签：oauth, asp.net-mvc-4, asp.net-web-api, dotnetopenauth

我们正在使用 DNOA 的 .Net MVC4 WebApi 应用程序和使用 Spring Security 的 Java 应用程序之间实现一个简单的 2 腿 OAuth1a 对话。在实现 Delegating MessageHandler 以验证传入请求时，DNOA 似乎坚持在请求中包含令牌。Spring 实现不需要令牌。我的感觉是 .Net 实现在某些方面是不正确的。

这是处理程序，如果我使用令牌发送它，这将起作用。

```
TokenManager tokenManager = new TokenManager();
var requestW = new HttpRequestWrapper(HttpContext.Current.Request);
var sp = new ServiceProvider(Constants.SelfDescription, tokenManager, new NonceStore());
try
{
     var auth = sp.ReadProtectedResourceAuthorization(requestW);
     if (auth != null)
     {
            //verfy etc etc
     }
 catch(Exception)
 { //return UnAuthorized response }
 return base.SendAsync(request, cancellationToken);
} 
```

在这段代码中，我在 ReadProtectedResourceAuthorization 调用中遇到一个异常，它说它收到了一个 UnauthorizedRequest。那么这个流程应该是什么样的呢？我看到的大部分内容都表明这种类型的流程不需要令牌，但 DNOA 似乎坚持这样做。任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T21:57:56.290

听起来您要尝试做的[实际上是 0-legged OAuth](http://blog.nerdbank.net/2011/06/what-is-2-legged-oauth.html)（无论如何，按照我的术语，因为您尝试做的事情中没有原始的 3 个 OAuth 分支）。至少我从您的描述中了解到，您的访问令牌和访问令牌秘密是空的，您拥有的只是消费者密钥和秘密。

如果我没记错的话，DNOA 不支持空访问令牌（因为 OAuth 1 规范中不允许这样做）。

您可以尝试的可能替代方案：

1.  使用非空（但如果需要，可能仍是硬编码）访问令牌和访问令牌密码。
2.  改为使用基于 HTTPS 的基本身份验证，使用您的使用者密钥和使用者密码作为用户名和密码。
3.  使用另一个 OAuth 1 服务提供者库。

# php - php-cli：加载共享库时出错

> ID：12630641
> 
> 赞同：0
> 
> 时间：2012-09-27T21:58:37.563
> 
> 标签：php, command-line-interface

我将 ubuntu 服务器升级到 12.04.1 版本。从那时起 php 不再从 cli 工作。我做了apt-get update / upgrade，删除了php-cli，重新安装了它。没有成功。错误消息是：php：加载共享库时出错：libmysqlclient.so.16：无法打开共享对象文件：没有这样的文件或目录

我在服务器上没有找到 libmysqlclient.so.16 但 libmysqlclient.so.18 。

我怎样才能告诉 php-cli 使用较新的版本？

# c# - 如何获取基于单击 WebMatrix 剃须刀分配的 C# 变量？

> ID：12630646
> 
> 赞同：1
> 
> 时间：2012-09-27T21:59:08.883
> 
> 标签：c#, database, razor, webmatrix

我无法解决我目前的情况：

我需要为 C# 变量分配一个动态值，因为 C# 是查询我的数据库的内容。

该值必须与他们选择（点击等）的 sql 查询条目的主键 ID 匹配。

我永远不知道根据他们的搜索会有多少条目（或哪些条目）。

至此，他们把自己的搜索条件放到了一个表格里，动态查询数据库，结果逐行显示。

现在，我需要一个按钮（或某种用户选择的界面），它可以告诉我他们选择编辑哪个条目，然后将数据库中该条目的值带到“查看和编辑”页面。

我可以做所有这些，除了，当 C# 在用户可以提供任何输入时已经完成呈现页面时，我如何知道他们单击（或以其他方式选择）哪个条目？JavaScript 不能查询数据库，这怎么可能呢？请记住，我知道 jQuery，但不知道任何 AJAX。

我正在使用 WebMatrix C# razor、html、css、JavaScript、SQL Server Compact 和 jQuery（我确定是标准 WebMatrix 设置）。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:59:36.723

好的，正如 GmG 所评论的那样，webGrid 旨在帮助解决这个问题，但是，如果您不想使用该答案并构建自己的答案，那么我发现这对我来说非常有效（对于我的具体情况甚至更好） ：

在 @foreach(var row in db.Query("queryString")) 循环中，我（在汇总信息中）添加了一个表单，以便找到的每个条目都有自己的表单。在表单中，我只放置了一个提交按钮和一个隐藏的输入文本元素，在“name”属性中设置了任何给定的指定名称（即，name="inputName"）。这个隐藏元素的值是@row.EntryID（即value="@row.EntryID"），它会用在数据库中找到的条目的唯一主键来绘制这个字段的值。在该页面中将表单操作设置为另一个文件（即 action="/somefile.cshtml"），我只是从隐藏的输入文本字段中提取了 EntryID（即 var someVariable = Request.Form["inputName"]; ）。

我希望这可以帮助任何想要在不使用 WebGrid 帮助器的情况下执行类似功能的人（尽管您可能想要这样做，我的意思是这就是它的用途）。然而，对于像我这样的一些人，我们可能知道如何以这种方式更好地控制它（因为我们可能不知道杰克关于帮助程序以及如何调整其中所需的微小配置来以这种方式显示、样式和控制 Web 界面我们想）。

无论如何，再次希望这对某人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-09T15:59:57.827

已经很晚了，但它可能会帮助其他人：

示例

```
 @foreach(var row in sCustomersHO){
                <tr>
                    <td><a href="~/Admin/ManageCustomersCH?id=@row.CustId">@row.Account</a></td>
                    <td>@row.CustomerName</td>
                    <td>@row.RepName</td>
                    <td>@row.CustomerTypeDescription</td>
                    <td>@row.StopStatus</td>
                    <td><a href="~/Admin/DeleteCustomerHO?id=@row.CustId">Delete</a></td>
                </tr>
            } 
```

网格示例：

```
 @gAllReports.GetHtml(
            tableStyle: "grid",
            headerStyle: "head",
            alternatingRowStyle: "alt",
            columns: gAllReports.Columns(
                gAllReports.Column("Name"),
                gAllReports.Column("Description", format: @<textarea disabled>@item.Description</textarea>),
                gAllReports.Column("Action", format: @<form method="post">@AntiForgery.GetHtml()<input type="hidden" id="UserId" name="UserId" value="@UserId" /><input type="hidden" id="ReportId" name="ReportId" value="@item.ReportId" /><button type="submit" name="action" value="add">Add</button></form>)
            )
        ) 
```

# c# - 如何在 Windows Phone 7 中访问 selectedListBoxItem 中的基础类属性？

> ID：12630648
> 
> 赞同：0
> 
> 时间：2012-09-27T21:59:17.220
> 
> 标签：c#, windows-phone-7

我有一个`ListPicker (items=Week1,Week2)`允许我在另一个列表中的 2 个列表之间切换`ListBox`：

```
< toolkit:ListPicker x:Name="LP1"
                     Margin="12,8,12,0"
                     Grid.Row="1" 
                     VerticalAlignment="Top"
                     SelectedIndex="1"
                     SelectionChanged="WeekSelectionChanged"
                     ItemsSource="{Binding WeekSelection}" /> 
```

`WeekSelectionChanged`方法的逻辑`ListPicker`很简单：

```
if(this.LP1.SelectedIndex == 0) 
    this.ListBox1.ItemsSource = Week1; 
else if (this.LP1.SelectedIndex == 1) 
    this.ListBox1.ItemsSource = Week2; 
```

列表是这样组成的（重复第 2 周列表）：

```
ObservableCollection<TB> Week1 = new ObservableCollection<TB>(); 
Week1.Add(new TB() { F_Name = "Day 1", F_Color = "Yellow" }); 
Week1.Add(new TB() { F_Name = "Day 2", F_Color = "Yellow" }); 
this.ListBox1.ItemsSource = Week1; 
```

TB类是：

```
public class TB 
{
    public string F_Name { get; set; }
    public string F_Color { get; set; }     
} 
```

当我“长按”一个列表项时，前景色变为灰色。但是当我在列表之间切换时，更改不会“保存”，而是显示原始的黄色。`F_Color`我想通过更改所选特定列表项的值来保留这些更改。

如何访问底层`TB`类及其属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:51:01.010

您必须在代码隐藏中或通过 Visual Studio 或 Blend 中的事件面板订阅列表控件的 SelectionChanged 事件。在此事件的处理程序中，您会将所选项目转换为其实际类型：TB。然后你可以读/写它的属性，并且应该看到列表项中反映的变化。像这样的东西：

```
namespace PhoneApp1
{
    public partial class MainPage : PhoneApplicationPage
    {
        ListBox mylistbox;
        // Constructor
        public MainPage()
        {
            InitializeComponent();

            // here, for illustration purposes,  I have declared and instantiated a listbox in the code-behind, 
            // normally the declaration and initialization is done by auto-generated code, 
            // when you have dropped the list into your GUI via the designer...
            // although the actual adding of items is either populated in code-behind 
            // or is accomplished by binding to a source in the designer.
            this.mylistbox = new ListBox();

            // add some items...
            TB[] tbs = new TB[] { new TB(), new TB(), new TB() };
            this.mylistbox.ItemsSource = tbs;

            // subscribe to the SelectionChanged event...
            this.mylistbox.SelectionChanged += new SelectionChangedEventHandler(mylistbox_SelectionChanged);
        }

        // respond to the SelectionChanged event...
        void mylistbox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            TB tb = this.mylistbox.SelectedItem as TB;
            if (tb == null) { return; }

            // the 'as' operator allows for a safe way of testing what we are using before we use it...
            // we passed the validation, so now we can do what we like with the type...
            // the selected TB item is being operated upon here, but that does not stop it from being an item in the list.
            // this means whatever we 'do' to it here, is actually 'doing' it to the selected item in the list.
            tb.F_Color = "Yellow";
        }
    }

    public class TB
    {
        public string F_Name { get; set; }
        public string F_Color { get; set; }
    }  

} 
```

**编辑：** 这是上述代码的修订版，针对触发“Hold”事件时所选项目变为空的事实量身定制：

```
namespace PhoneApp1
{
public partial class MainPage : PhoneApplicationPage
{
    private TB currentItem;

    ListBox mylistbox;

    // Constructor
    public MainPage()
    {
        InitializeComponent();

        // here, for illustration purposes,  I have declared and instantiated a listbox in the code-behind, 
        // normally the declaration and initialization is done by auto-generated code, 
        // when you have dropped the list into your GUI via the designer...
        // although the actual adding of items is either populated in code-behind 
        // or is accomplished by binding to a source in the designer.
        this.mylistbox = new ListBox();

        this.currentItem = null;

        // add some items...
        TB[] tbs = new TB[] { new TB(), new TB(), new TB() };
        this.mylistbox.ItemsSource = tbs;

        // subscribe to the SelectionChanged event...
        this.mylistbox.SelectionChanged += new SelectionChangedEventHandler(mylistbox_SelectionChanged);

        this.mylistbox.Hold += new EventHandler<GestureEventArgs>(mylistbox_Hold);
    }

    void mylistbox_Hold(object sender, GestureEventArgs e)
    {
        if (this.currentItem == null) { return; }
        this.currentItem.F_Color = "Yellow";
    }

    // respond to the SelectionChanged event...
    void mylistbox_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        this.currentItem = ((ListBox)sender).SelectedItem as TB;;
    }
}

public class TB
{
    public string F_Name { get; set; }
    public string F_Color { get; set; }
} 
```

}

# ipad - 带有 iPad 的 Admob PhoneGap 插件

> ID：12630655
> 
> 赞同：0
> 
> 时间：2012-09-27T21:59:43.937
> 
> 标签：ipad, cordova, admob, phonegap-plugins

我正在使用这个在 iOS 上运行[的 Phonegap 的 Admob 插件，](https://github.com/smithimage/phonegap-plugins/tree/master/iPhone/AdMob)如下所示：

```
window.plugins.AdMob.createBanner({"siteId":"my-site-id"});
window.plugins.AdMob.loadBanner();
// move banner to make it appear
window.plugins.AdMob.moveBanner({"positionX":0,"positionY":410}); 
```

对于`my-site-id`作为我的 iPhone Admob 站点 ID 的 iPhone 应用程序，它运行良好。问题是，当将此代码用于 iPad 添加时`my-site-id`，我的 IPAD Admob 站点 ID 不会显示。我的猜测是它与横幅大小有关，但我不知道如何解决它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T16:03:13.983

您可能想查看更新的[AdMob 插件](https://github.com/rajpara11/phonegap-plugins/tree/master/iOS/AdMobPlugin)，您可以在其中明确传递 adSize。您正在查看的插件示例看起来像是硬编码为仅适用于 320x50 广告，这是您在 iPhone 上看到的，而不是在 iPad 上看到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T07:19:34.717

我 eventyallu 做了一些编码，并想分享以便其他人知道。在我的 .js 文件中，我确定了设备屏幕尺寸，据此，我传递了 wnated 添加尺寸。插件最初不支持这一点，所以我做了以下支持：在插件 .js 文件中，我添加了另一个正在传输的参数（除了帐户 ID），即添加大小，然后在插件 .h 文件中，我创建了一个保存设备 ID 的新变量，并根据它在 .m 文件中选择要呈现的所需添加大小。如果有人需要，我也会发布实际代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-14T13:47:42.473

在 IPAD 中显示横幅，横幅大小为 IPAD_PORTRAIT

```
admob.showBanner(admob.BannerSize.IPAD_PORTRAIT,admob.Position.TOP_APP);//show banner at the top of app 
```

根据设备选择横幅尺寸。

```
BannerSize: {
BANNER: {width:320,height:50},
IAB_MRECT:{width:300,height:250},
IAB_BANNER: {width:468,height:60},
IAB_LEADERBOARD: {width:728,height:90},
SMART_BANNER: {width:-1,height:-2},
IAB_WIDE_SKYSCRAPER: {width:160,height:600},
IPHONE_LANDSCAPE: {width:480,height:32},
IPAD_PORTRAIT: {width:769,height:90},
IPAD_LANDSCAPE: {width:1024,height:90}
} 
```

# ios - 使用 iOS UIWebView 时的 Rails 布局（application.html.erb）逻辑

> ID：12630661
> 
> 赞同：1
> 
> 时间：2012-09-27T22:00:17.457
> 
> 标签：ios, ruby-on-rails, uiwebview

我正在尝试确定是否可以检测到请求何时来自 iOS UIWebView，并在这种情况下返回自定义布局。

这是场景。目前我有一个完全在 Rails 中构建的移动 web 视图，它看起来像这样：

![在此处输入图像描述](../Images/e8d0bff17933d61e5331c58455673404.png)

这在浏览器中加载并且工作正常。现在，我正在开发一个内置于 Xcode 中的 iOS 应用程序，它将本机代码与 UIWebViews 混合在一起。我在这一点上所做的是本地构建红色导航栏。我希望网站的其余部分（所有白色背景）加载到 UIWebView 中。

理想情况下，我会通过检测请求是否来自 iOS 应用程序来做到这一点。如果是这种情况，布局将*不*包括红色导航栏（因为它已经在本地处理）。如果请求来自浏览器，则布局将包括红色导航栏。

我已经四处搜索，但找不到任何关于此的内容。有谁知道如何把这样的东西拉下来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:06:43.307

`[request setValue:@"true" forHTTPHeaderField:@"My-iOSApp"]`您可以通过执行a将自定义标头添加到您的本机 iOS 应用程序 URL 调用`NSMutableURLRequest`（这可能会有所不同，具体取决于您在 iOS 应用程序中用于 HTTP 网络的系统）

然后用于`request.headers`获取 Rails 中的标头并检查它们以查看`My-iOSApp`密钥是否在标头中。如果是，则仅渲染底部主体布局，否则使用导航栏渲染整个内容

# shopify - 如何通过 API 创建和激活客户？

> ID：12630664
> 
> 赞同：0
> 
> 时间：2012-09-27T22:00:47.293
> 
> 标签：shopify

据我了解，通过 Shopify API 创建客户会使他们处于“已禁用”状态，直到他们通过 UI 被邀请。我已经看到一些使用 mechanize 的黑客攻击，但是真的没有办法通过 API 正确地做到这一点吗？

它需要 9,000 次点击才能激活 3,000 名客户。哎哟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:58:37.453

或者.. 一个使用 Mechanize 的小脚本。它是为了完成 9000 次点击而设计的。计算机非常擅长将平凡的任务自动化。您也可以使用 Selenium 和 Javascript。如果您使用的是 API，那么自动化按钮点击可能会在比您想象的更少的代码中触手可及。

# java - java中数据发送缓冲区的一般实现是什么？

> ID：12630668
> 
> 赞同：3
> 
> 时间：2012-09-27T22:01:23.523
> 
> 标签：java, buffer

我正在设计一个以固定间隔发送文本的应用程序。在此间隔期间，应用程序正在收集数据并将其临时存储在缓冲区中，然后再将其发送出去（并清除数据库的内容）。

我尽量不将它们存储在内存中。

目前我正在考虑使用 H2 嵌入式数据库。

我们通常在 Java 中用于缓冲区实现的是什么？纯文本文件？日志文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T01:20:28.277

阅读您的评论后，我认为您的问题的实现可能是：

创建一个事务服务，在其中收集所有必要的信息，将其存储在 StringBuilder 中，发送信息并最终清除数据库中的内容，如果出现任何问题，您的数据库将保留信息，换句话说，这是一项可靠的服务。

如果您使用多个线程来恢复信息，请记住 StringBuilder 是不同步的，因此如果您的解决方案有多个线程在 StringBuilder 上工作，请不要忘记在内部同步您的类或使用 StringBuffer（请记住，这是线程安全的，但速度较慢）。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T23:40:19.843

内存缓冲区与否还取决于您的应用程序需求。例如，如果您的应用程序必须可靠并在发生导致崩溃的问题时管理恢复，则更好的方法是使用文件，如果某些数据尚未处理，您可以恢复。

对于这种需求，还有[MOM](http://en.wikipedia.org/wiki/Message-oriented_middleware)（面向消息的中间件）选项，该解决方案提供了包括可靠性在内的许多优点。但是如果您不需要可靠性并且只存在一些数据交换，则无需使用MOM。

# java - 如何获得禁止（）的“原因”？

> ID：12630672
> 
> 赞同：0
> 
> 时间：2012-09-27T22:01:34.563
> 
> 标签：java, playframework-1.x

我正在设计我的 403 页面，但我似乎无法获得我在各种禁止页面上填充的“原因”字符串，以便对手头的问题给出更相关的响应。如果我在模板中键入 ${response.reason}，整个页面将被替换为仅响应的文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T06:48:07.560

在代码中，您似乎可以通过以下方式在模板中获取此值

```
${result.getMessage()} 
```

结果是从 RuntimeException 继承的 Forbidden 对象，并且您提供的描述作为异常消息传递给基类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T23:48:52.837

您不想再提供“禁止”的理由。从安全的角度来看，用户尝试了未经授权的操作，而您要做的最后一件事就是告诉他们到底出了什么问题（未知用户、无效密码等）。如果你这样做，你就是在泄露可以帮助用户渗透你系统的信息。

例如，如果您区分未知用户和无效密码，您就放弃了用户标识是否存在。

# java - zeromq 向全网广播

> ID：12630676
> 
> 赞同：5
> 
> 时间：2012-09-27T22:01:58.353
> 
> 标签：java, broadcast, zeromq

我是 ZeroMQ 的新手（并且通常使用套接字进行编程），但我正在尝试（在 Java 中）在 ZeroMQ 中实现对等模型。我想要的是当一个节点上线时，它会向整个网络广播“我在这里，你可以通过这个地址联系我：...”消息。

我在想，如果网络上出现 2 个或更多节点，它们将能够找到彼此而无需通过已知端点。

有人对我如何实现这一目标有任何想法吗？ZeroMQ 甚至可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T13:21:02.067

你所要求的不能用 zmq 完成。没有任何机制（没有已知和已定义的端点）可以让您“知道”发布者何时上线及其消息已准备好订阅。

[话虽如此，使用XPub 和 XSub](http://zguide.zeromq.org/page%3aall#The-Dynamic-Discovery-Problem)路由器（需要已知的端点）来设置这种类型的东西是非常简单的。您还可以创建自己的“端点”，所有客户端都使用 REQ/REP 套接字连接到该端点。这将允许您拥有一个中心（本质上是[目录服务](http://www.zeromq.org/whitepapers%3abrokerless#toc3)），然后您可以连接点对点订阅/发布连接（这将使您的网络重复保持在最低水平）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-29T18:59:19.587

您可能希望使用 UDP 这样做：

1.  所有节点都为新人监听一个固定的 UDP 端口
2.  当一个新节点出现时，它会向网络发送一条 UDP 消息（或广播，如果可用），所有其他节点都会收到它，因此知道它的存在
3.  您现在可以使用固定端点（即 zmq）来进行通信。

您可能想查看一个 C 示例 [https://github.com/stanwu/udp-broadcast](https://github.com/stanwu/udp-broadcast)

*   如果你有三台 IP 为 192.168.1.10/11/12 的机器
*   在 192.168.1.10 和 192.168.1.11 上启动 ./udpServer
*   在 192.168.1.12 上运行 ./udpClient 192.168.1.0 I-AM-HERE-192.168.1.12-PORT-7777
*   现在 192.168.1.10/11 知道 192.168.1.12 上有一个新人在 7777 上运行一些监听器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-11T08:41:49.290

我在 LAN 上的现有系统中使用 UDP。它运作良好。您必须注意的唯一问题是 UDP 数据包不能保证传送。他们实际上会迷路，因此您需要考虑重复广播。您还会收到数据包碎片，因此请确保消息很小，但您只需发送足够的信息即可为 ZMQ、TCP 或`RabbitMQ`其他任何东西建立连接。其他潜在问题是防火墙和 VPN。

# ajax - Ajax 选项卡数据绑定

> ID：12630679
> 
> 赞同：0
> 
> 时间：2012-09-27T22:02:00.620
> 
> 标签：ajax, datatable

鉴于我在页面加载时没有查询结果，如何通过单击按钮将数据表绑定到 Ajax 选项卡？

更新

我发现将数据绑定到 Ajax 选项卡中的网格视图非常容易。当然，您需要在 asp 页面和 web.config 文件中声明的脚本管理器 ajax 引用。您还需要将 ajax css 样式添加到现有样式表中。我尝试使用单独的，但没有用。

ASP HTML

```
<AjaxToolkit:TabContainer ID="TabContainer1" runat="server" ActiveTabIndex="0" 
                            Visible="false" ScrollBars="Both"
                            CssClass="Tab2" Width="1326px" Height="464px" >

<AjaxToolkit:TabPanel ID="TabPanel1" runat="server" HeaderText="Empty" Enabled="true"    ScrollBars="Both" CssClass="Tab2">

<ContentTemplate>
<div style="overflow:auto;width:1287px; height: 418px;">
 <font color="white" size="1" face="Verdana">

 <asp:GridView ID="SalesOrderView1"     runat="server" BackColor="White"   BorderColor="#DEDFDE"visible="False"BorderStyle="None"      BorderWidth="1px" 
 CellPadding="4" ForeColor="Black" 
 GridLines="Vertical"     HorizontalAlign="Center">
 <AlternatingRowStyle      BackColor="White" />
 <FooterStyle BackColor="#CCCC99" />
 <HeaderStyle BackColor="#6B696B" Font-Bold="True" ForeColor="White" />
 <PagerStyle BackColor="#F7F7DE"    ForeColor="Black" HorizontalAlign="Right" />
 <RowStyle BackColor="#F7F7DE" />
 <SelectedRowStyle BackColor="#CE5D5A" Font-Bold="True" ForeColor="White" />
 <SortedAscendingCellStyle BackColor="#FBFBF2" />
 <SortedAscendingHeaderStyle BackColor="#848384" />
 <SortedDescendingCellStyle BackColor="#EAEAD3" />
  <SortedDescendingHeaderStyle BackColor="#575357" />
 </asp:GridView>
  </div>
  </font>
 </ContentTemplate>
   </AjaxToolkit:TabPanel>
      <AjaxToolkit:TabPanel ID="TabPanel2" runat="server" HeaderText="Empty" ScrollBars="Both" CssClass="Tab2">
 <ContentTemplate >
 </AjaxToolkit:TabContainer> 
```

在单击按钮事件上将数据绑定到 gridview 的 C# 代码。

```
 SalesOrderView1.Visible = true;
                        TabPanel1.Visible = true;
                        TabPanel1.HeaderText = Order_List[multi_order_count]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:05:37.013

您可以使用以下内容

```
$('.datatable').bind('click', function() {
  //logic
}); 
```

# php - PHP数组不断添加单独的键值而不是添加到现有键

> ID：12630681
> 
> 赞同：-2
> 
> 时间：2012-09-27T22:02:24.130
> 
> 标签：php, arrays, foreach

我正在尝试订购我的阵列。我的第一个数组将具有值字符串值，其中很少有相同的值现在我想知道每个值有多少，并将其添加到新数组中作为键和值它现在出现在第一个数组中的次数我得到这样做，但我得到了一个错误。

最后一个条目而不是被反击会被额外添加。

我尝试了 while/for/foereach 相同的结果。

代码：

```
<?php
 function add_fit($fitting)
   {
        // Save raw fit
        $eft = $fitting;

        // Clean for import
        $fit = trim($fitting);
        $lines = explode("\n", $fit);
        $lines = array_filter($lines, 'trim');

        // Split first line for name and type
        $details = str_replace('[', '', $lines[0]);
        $details = str_replace(']', '', $details);
        $split_details = explode(', ', $details);

        $ship = $split_details[0];
        $name = $split_details[1];

        foreach ($lines as $line => $module) {
            if(strstr($module, '[empty '))
            {
                unset($lines[$line]);
            }
        }

        $all = array();
        foreach ($lines as $index => $segment) {
            array_push($all, $segment);
        }

        $modules = array();
        for($i = 1; $i < count($all); $i++)
        {
            if(isset($modules[$all[$i]]))
            {
                $modules[$all[$i]] = $modules[$all[$i]]+1;
            } else {
                $modules[$all[$i]] = 1;
            }
        }

        var_dump($modules);

   }

/*
The $fitting is as follows:

[Thrasher, Buffer Thrasher]
Gyrostabilizer II
Gyrostabilizer II

Small F-S9 Regolith Shield Induction
Small F-S9 Regolith Shield Induction
1MN MicroWarpdrive I

280mm Howitzer Artillery II
280mm Howitzer Artillery II
280mm Howitzer Artillery II
280mm Howitzer Artillery II
280mm Howitzer Artillery II
280mm Howitzer Artillery II
280mm Howitzer Artillery II
[empty high slot]

Small Ancillary Current Router I
Small Ancillary Current Router I
Small Ancillary Current Router I

And the method returns:
  'Gyrostabilizer II'                    => int 2
  'Small F-S9 Regolith Shield Induction' => int 2
  '1MN MicroWarpdrive I'                 => int 1
  '280mm Howitzer Artillery II'          => int 7
  'Small Ancillary Current Router I'     => int 2
  'Small Ancillary Current Router I'     => int 1

While it should return:
  'Gyrostabilizer II'                    => int 2
  'Small F-S9 Regolith Shield Induction' => int 2
  '1MN MicroWarpdrive I'                 => int 1
  '280mm Howitzer Artillery II'          => int 7
  'Small Ancillary Current Router I'     => int 3   <-- Like this
*/

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:36:38.430

您的输入中必须有一些非打印字符，因为哈希不能具有具有多个值的相同键（这是您的输出显示的 - 的两个键`Small Ancillary Current Router I`，它们必须不同，因为它们具有不同的值......）

什么是`var_dump(array_keys($modules))`节目？

解决方案是更好地清理您的输入 - 看起来您可能应该在您的清理部分添加一些内容。. . 也许[像这样剥离 UTF](http://kzar.co.uk/blog/view/strip-unicode-utf-php)，或者如果这是您输入的最后一行，则可能有一个 EOF 字符。. .

编辑：根据您的评论，`var_dump`输出为：

```
5 => string 'Small Ancillary Current Router I' (length=33) 
6 => string 'Small Ancillary Current Router I' (length=32) 
```

请注意，一个是 33，另一个是 32，这意味着非打印字符会导致差异。[此处描述了](https://stackoverflow.com/questions/1176904/php-how-to-remove-all-non-printable-characters-in-a-string)一种删除所有非打印字符的霰弹枪方法。要在您的代码中实现：

```
 $all = array();
    foreach ($lines as $segment) {
        $all[] = preg_replace('/[\x00-\x1F\x80-\xFF]/', '', $segment);
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-27T22:29:06.137

您可能应该使用`array_key_exists()`而不是 isset。原因可以在[this SO question中看到](https://stackoverflow.com/questions/3210935/difference-between-isset-and-array-key-exists)

无论哪种方式，您都有一些空格导致问题。尝试在以下行中添加修剪，它应该可以工作：

```
foreach ($lines as $index => $segment) { 
    array_push($all, $segment); 
} 
```

改成：

```
foreach ($lines as $index => $segment) { 
    array_push($all, trim($segment)); 
} 
```

顺便说一句：o7 安全飞行 ;-)

**更新：**继承人我用于测试的代码：

```
<!DOCTYPE html>
<html>

<head>
</head>
<body>
<?php 

$whatever = "[Thrasher, Buffer Thrasher] 
Gyrostabilizer II 
Gyrostabilizer II 

Small F-S9 Regolith Shield Induction 
Small F-S9 Regolith Shield Induction 
1MN MicroWarpdrive I 

280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
280mm Howitzer Artillery II 
[empty high slot] 

Small Ancillary Current Router I 
Small Ancillary Current Router I 
Small Ancillary Current Router I";

echo '<pre>';
print_r(add_fit($whatever));
echo '</pre>';

 function add_fit($fitting) 
   { 
        // Save raw fit 
        $eft = $fitting; 

        // Clean for import 
        $fit = trim($fitting); 
        $lines = explode("\n", $fit); 
        $lines = array_filter($lines, 'trim'); 

        // Split first line for name and type 
        $details = str_replace('[', '', $lines[0]); 
        $details = str_replace(']', '', $details); 
        $split_details = explode(', ', $details); 

        $ship = $split_details[0]; 
        $name = $split_details[1]; 

        foreach ($lines as $line => $module) { 
            if(strstr($module, '[empty ')) 
            { 
                unset($lines[$line]); 
            } 
        } 

        $all = array(); 
        foreach ($lines as $index => $segment) { 
            array_push($all, trim($segment)); 
        } 

        $modules = array(); 
        for($i = 1; $i < count($all); $i++) 
        { 
            if(isset($modules[$all[$i]])) 
            { 
                $modules[$all[$i]] = $modules[$all[$i]]+1; 
            } else { 
                $modules[$all[$i]] = 1; 
            } 
        } 

        return $modules; 

   } 

?>
</body>
</html> 
```

# r - 数据可视化的问题

> ID：12630684
> 
> 赞同：2
> 
> 时间：2012-09-27T22:02:53.600
> 
> 标签：r, visualization, data-visualization

当我运行以下 R 代码来可视化伊利诺伊州的人口密度时，地图的底部被从图中切掉/裁剪。我不知道为什么会这样，因为我在其他州没有问题。

除此之外，如您所见，整个地块都向上移动。这是因为数据中的经度和纬度值不相等吗？

```
 # query map and plot
 library(ggmap)
 library(ggplot2)

 # State of Illinois
 illinois <- get_map(location = "illinois ", 
            source = "stamen", zoom = 7, maptype = "toner")
 il <- ggmap(illinois) + geom_point(data=il_pop, 
        aes(x=INTPTLON, y=INTPTLAT, size=TOTPOP, colour="areaname", alpha=0.1), 
        colour="gold2") + scale_size(range=c(0,10)) 
 il <- il + opts(legend.position="none")
 il 
```

![在此处输入图像描述](../Images/4905f9f259db2c106c48cf8dc57443cc.png) **编辑**：这是缩放 = 6 的输出。这对我来说太缩小了，当我缩小时，点的位置看起来更糟。有没有办法让我的缩放保持在 7 并获得一个矩形地图？

另外，这是我使用的数据：

```
 ZCTA3 ZCTA5         AREANAME INTPTLAT  INTPTLON TOTPOP POPPERSQM
1      600 60002          ANTIOCH 42.46617 -88.09995  19350     575.3
2      600 60004 ARLINGTON HEIGHT 42.10843 -87.97724  53118    4721.8
3      600 60005 ARLINGTON HEIGHT 42.06933 -87.98465  28884    4465.5
4      600 60007 ELK GROVE VILLAG 42.00598 -87.99847  35281    2265.9
5      600 60008  ROLLING MEADOWS 42.07506 -88.02509  23406    3267.3
6      600 60010       BARRINGTON 42.16079 -88.15231  40110     565.7
7      600 60012     CRYSTAL LAKE 42.26564 -88.31664  10087     486.3
8      600 60013             CARY 42.21752 -88.24339  24079    1556.7
9      600 60014     CRYSTAL LAKE 42.22662 -88.33067  44525    1998.7
10     600 60015        DEERFIELD 42.16933 -87.86557  27291    2174.9 
```

![在此处输入图像描述](../Images/bb251f9accba991cf71bf3a2cf7209c2.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T22:34:36.323

在您请求的缩放级别，即地图的范围。它位于皮奥里亚附近（显然）。在`zoom=6`处，你得到你展示的程度。在`zoom=7`处，您将获得更大的地理区域（当然，细节更少）。由于您的人口已经用 lat/long 编码，您可以使用它的范围（可能带有一些填充）来创建一个 lat/long 边界框并将其`location`用于`get_map`.

# android - 绘制实心方形按钮并为其添加自定义字体

> ID：12630690
> 
> 赞同：0
> 
> 时间：2012-09-27T22:03:31.713
> 
> 标签：android, button

我想知道最好的方法是制作一个实心方形按钮并为其添加自定义字体。我正在考虑一个处理绘图的单独类（某些宽度=高度取决于屏幕的宽度）。我唯一想知道的是：如何使它成为带有文本的按钮？我是否在我的 xml 中放置一个按钮，是否可以用我自己绘制的按钮方块替换它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T02:31:31.130

If you want to custom original button, you can add image as your button background via `android:background`. About custom font, You get button in activity and set custom `Typeface`.Put your font in `assets` folder.

```
Button txt = (Button) findViewById(R.id.button);  
Typeface font = Typeface.createFromAsset(getAssets(), "1543Humane_jenson_bold.TTF");  
txt.setTypeface(font); 
```

If you want to use this kind of button manytime you can create a custom button class similar to this

**CustomButton**

```
package com.example;

import android.content.Context;
import android.content.res.TypedArray;
import android.graphics.Typeface;
import android.util.AttributeSet;
import android.util.Log;
import android.widget.Button;

public class CustomButton extends Button {
        private static final String TAG = "TextView";

        public CustomButton (Context context) {
            super(context);
        }

        public CustomButton (Context context, AttributeSet attrs) {
            super(context, attrs);
            setCustomFont(context, attrs);
        }

        public CustomButton (Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);
            setCustomFont(context, attrs);
        }

        private void setCustomFont(Context ctx, AttributeSet attrs) {
            TypedArray a = ctx.obtainStyledAttributes(attrs, R.styleable.CustomButton);
            String customFont = a.getString(R.styleable.TextViewPlus_customFont);
            setCustomFont(ctx, customFont);
            a.recycle();
        }

        public boolean setCustomFont(Context ctx, String asset) {
            Typeface tf = null;
            try {
            tf = Typeface.createFromAsset(ctx.getAssets(), asset);  
            } catch (Exception e) {
                Log.e(TAG, "Could not get typeface: "+e.getMessage());
                return false;
            }

        setTypeface(tf);  
        return true;
        }

} 
```

**attrs.xml:** (in res/values)

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="CustomButton ">
        <attr name="customFont" format="string"/>
    </declare-styleable>
</resources> 
```

**main.xml:**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:foo="http://schemas.android.com/apk/res/com.example"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <com.example.CustomButton 
        android:id="@+id/button"
        android:layout_height="match_parent"
        android:layout_width="match_parent"
        android:text="@string/showingOffTheNewTypeface"
        foo:customFont="custom.ttf">
    </com.example.CustomButton >
</LinearLayout> 
```

Typeface class using HashMap to avoid memory problem. Change the `tf = Typeface.createFromAsset(ctx.getAssets(), asset);` in `setCustomFont` with `tf= Typefaces.get(mContext, "cutomefont");`

```
 public class Typefaces{

private static final Hashtable<String, Typeface> cache = new Hashtable<String, Typeface>();

    public static Typeface get(Context c, String name){
        synchronized(cache){
            if(!cache.containsKey(name)){
                Typeface t = Typeface.createFromAsset(
                        c.getAssets(), 
                        String.format("fonts/%s.OTF", name)
                    );
                cache.put(name, t);
            }
            return cache.get(name);
        }
    }

} 
```

[Another tut](http://vimaltuts.com/android-tutorial-for-beginners/android-custom-button) in Internet

# grails - grails 中的数据绑定异常

> ID：12630692
> 
> 赞同：1
> 
> 时间：2012-09-27T22:03:48.993
> 
> 标签：grails

在 grails 中，我试图将数据绑定到命令对象，但是我遇到了一个奇怪的问题，即字符串后缀会自动（无声地）从数字中删除。例如：

```
class MyCommand {
    int myInt
}
def test = {
    def cmd = new MyCommand()
    def myMap = [myInt:"123asdf"]
    bindData(cmd, myMap)
    boolean errors = cmd.hasErrors()
    render errors
} 
```

这将呈现 false 并且 myInt 将设置为 123。但是，如果我尝试将 myInt 设置为“asdf123” cmd.hasErrors() 将返回 true。

为什么会发生这种情况？是否有不同的方法将数据绑定到将处理此问题的对象。这篇文章中讨论了同样的问题，但没有提供任何解决方案：http: [//grails.1312388.n4.nabble.com/Data-binding-with-numbers-is-this-expected-td2073860.html](http://grails.1312388.n4.nabble.com/Data-binding-with-numbers-is-this-expected-td2073860.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T04:02:15.800

我不确定这是您想要的答案，但是，我认为这就是您所需要的。我对此做了很多研究，在我看来，数据绑定并不总是（提示永远）返回表单，即用户在处理无效数字时输入的确切数据。经过大量研究，我对您的建议是使用 try catch 将文本转换为整数，如果失败，请将其设置为 null。然后将参数传递回视图。如果值为空，则从参数中获取值。

# google-maps - 在哪里/如何从 Google Maps API 获取多边形数据？

> ID：12630696
> 
> 赞同：2
> 
> 时间：2012-09-27T22:04:24.100
> 
> 标签：google-maps, google-maps-api-3

我真的很想简短地回答这个问题，所以..我想知道谷歌地图是否拥有详细信息，在这种情况下，我需要城市内特定自治市的多边形**（坐标数组） （即****Envigado**在*麦德林*市, Co)

有没有办法获得这种类型的数据？

编辑：我不确定谷歌地图是否显示了我需要的多边形地理特征类型，如答案中所述，可能不是，但一个简单的查询显示了一些有趣的东西：

![Envigado 可能的多边形](../Images/83119c3ac01de42de372584d15812e6e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T09:44:10.693

除了通过调用反向地理编码器（不返回多边形，仅返回该位置的信息）外，地图图块上的边界（当前）无法通过 Google Maps API 获得。Natural Earth 数据集包含国家和州边界，但不包含您要查找的详细程度。

您可以请求添加该功能（我没有看到现有请求，但您应该在添加之前检查）：

[http://code.google.com/p/gmaps-api-issues/issues/list](http://code.google.com/p/gmaps-api-issues/issues/list)

我认为这是您正在寻找的功能请求：

[https://code.google.com/p/gmaps-api-issues/issues/detail?id=109](https://code.google.com/p/gmaps-api-issues/issues/detail?id=109)

# javascript - 通过 Sharepoint 发送到 Outlook 的电子邮件中未显示换行符

> ID：12630698
> 
> 赞同：2
> 
> 时间：2012-09-27T22:04:43.253
> 
> 标签：javascript, sharepoint, outlook

我正在尝试设置一个临时的 Sharepoint 页面，该页面提供一个表单，用户可以在其中输入一些文本并将其通过电子邮件发送出去。因此，我有一个包含表单和提交按钮的页面，该按钮调用一些 JS 将输入的文本放入 Sharepoint 的 SOAP 请求中，该请求将其添加到列表中，然后发送包含该信息的电子邮件。到目前为止一切顺利，而且非常无痛。

我遇到的问题是 Outlook 会忽略作为输入文本一部分的任何换行符。它们不会被任何东西删除，因为我可以使用“查看源代码”选项并在记事本中正常查看它们。我认为这是因为 Outlook 试图将消息显示为 HTML 并且不知道如何处理它们。通常情况下，我只是放入一些 JS 来替换`\r\n`with`<br />`标签的所有实例，但将其放入 SOAP 请求只会导致标签后面的任何内容在添加到 Sharepoint 列表之前被切断。

我尝试过的其他事情是

*   在每个新行的开头添加一对空格（无变化）
*   `\r\n`为每个换行符添加了第二组（没有变化）
*   `\r\n`替换了with的所有实例`%0D%0A`（显示为文本）
*   将所有实例替换为`\r\n`（`\par`实际使用`\\par`，以转义第一个反斜杠）。（显示为文本）
*   附加`\t`到`\r\n`. （没变）
*   前置'.' 的所有实例`\r\n`。（显示句点，但不显示换行符）

我正在使用 Outlook 2007、Sharepoint 2007 和 Internet Explorer 8。

我已阅读以下问题：

*   [javascript 电子邮件换行符](https://stackoverflow.com/questions/9739354/javascript-email-linebreaks)
*   [如何格式化电子邮件中的字符串以便 Outlook 打印换行符？](https://stackoverflow.com/questions/136052/how-do-i-format-a-string-in-an-email-so-outlook-will-print-the-line-breaks)
*   [如何在Javascript中换行](https://stackoverflow.com/questions/4768118/how-to-break-line-in-javascript)
*   [Outlook 自动清理我的换行符并搞砸了我的电子邮件格式](https://stackoverflow.com/questions/247546/outlook-autocleaning-my-line-breaks-and-screwing-up-my-email-format)

这是我用来编辑文本以及创建和发布 SOAP 请求的 JS 函数。当前设置为在每个换行符之前放置句点：

```
 function createAndPostSOAP(siteURL, listName)
    {
        var moreText = $("#MoreText")[0].innerText;

        var linebreakCount = moreText.match(/\r\n/g);

        moreText= "  " + moreText;
        for (var count = linebreakCount.length; count >= 0; count--)
        {
            moreText = moreText.replace("\r\n", ".[replace]");
        }

        while(moreText.indexOf("[replace]") != -1)
        {
            moreText = moreText.replace("[replace]", "\r\n");
        }

        var batch = 
            "<Batch OnError='Continue'> \
                    <Method ID='1' Cmd='New'> \
                        <Field Name='Text'>" + $("Text")[0].value + "</Field> \
                        <Field Name='MoreText'>" + moreText + "</Field> \
                    </Method> \
             </Batch>";

         var soapEnv =
                "<?xml version='1.0' encoding='utf-8'?> \
            <soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' \
                xmlns:xsd='http://www.w3.org/2001/XMLSchema' \
                xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'> \
               <soap:Body> \
                <UpdateListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'> \
                  <listName>" + listName + "</listName> \
                  <updates> \
                    " + batch + "</updates> \
                </UpdateListItems> \
              </soap:Body> \
            </soap:Envelope>";

        $.ajax({
        url: siteURL + "/_vti_bin/lists.asmx",
        beforeSend: function(xhr) {
            xhr.setRequestHeader    ("SOAPAction", "http://schemas.microsoft.com/sharepoint/soap/UpdateListItems");
        },
        type: "POST",
        dataType: "xml",
        data: soapEnv,
        contentType: "text/xml; charset=utf-8"
        }); 
    window.location='starting_page.htm';
    } 
```

我主要从 Javascript 端对此进行攻击，因为我知道这比 Sharepoint 更好，但是在 Sharepoint 2007 中有没有办法让脚本`<br />`在数据已经添加到列后将换行符更改为？还是我在 Javascript 中遗漏了一个角度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T12:43:27.870

您需要对代码中的所有 HTML 标记进行编码。意义为

```
&amp; → & (ampersand)
&lt; → < (less-than sign)
&gt; → > (greater-than sign)
&quot; → " (quotation mark)
&apos; → ' (apostrophe) 
```

试试下面的代码：

```
String Input = "adding this text <br/> this in next line <>";
String Output = Server.HtmlEncode(Input);
// 
```

> 如果需要

```
Output = Output.Replace("\r\n", "<br />"); 
```

# css - 是否可以防止单个容器在移动设备上扩展？

> ID：12630708
> 
> 赞同：0
> 
> 时间：2012-09-27T22:05:55.733
> 
> 标签：css, mobile

我想要实现的是：

让整个页面缩小，除了导航容器。我重写了它的一些 CSS 规则，使其在智能手机上更易于访问，但问题是它使用了很多图像，我需要以原始尺寸显示这些图像（1 图像像素 = 1 设备屏幕像素）。

有什么技术可以实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:43:32.480

我没有上下文，所以它更难，但也许你可以用 JavaScript 和 CSS 实现它，这样：

### 1）检测设备宽度，并将其与文档宽度进行比较

要检索文档宽度，您可以使用我在某处找到的这个片段：

```
var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName('body')[0];
var width = w.innerWidth||e.clientWidth||g.clientWidth; 
```

然后通过将其除以得到比率`screen.width`：

```
var ratio = width / screen.width; 
```

* * *

因此，假设设备宽度为 320 像素（iPhone 肖像），页面为 980 像素（通常的 iPhone 渲染）。

980 / 320 = 3.0625。

* * *

### 2）将您的内容缩放/缩放到该比例

您可以使用[CSS 转换来做到这一点](http://www.w3schools.com/css3/css3_2dtransforms.asp)

```
-ms-transform: scale(3.0625);
-webkit-transform: scale(3.0625);
-o-transform: scale(3.0625);
-moz-transform: scale(3.0625);
transform: scale(3.0625); 
```

或使用现代浏览器和 IE的[CSS 缩放：](http://www.fix-css.com/2011/05/css-zoom/)

```
zoom:3.0625; 
```

或者使用[jQuery UI Effects](http://jqueryui.com/demos/effect/)，或者使用[jQuery Transit](http://ricostacruz.com/jquery.transit/)，或者使用[HTML5 画布比例](http://www.w3schools.com/html5/canvas_scale.asp)（如果你的目标是画布），或者使用纯 JavaScript：

```
document.getElementById("idOfTheContent").style.width = document.getElementById("idOfTheContent").style.width * 3.0625;
document.getElementById("idOfTheContent").style.height = document.getElementById("idOfTheContent").style.height * 3.0625; 
```

或使用....任何您可以找到的缩放/缩放方法。

在任何情况下，我都不确定比例的精度（实际处理了逗号后的位数，但我认为即使将其舍入为整数也可以）以及它将如何呈现。

让我知道它是否有效:-)

# z3 - 用户理论插件的前端？

> ID：12630709
> 
> 赞同：1
> 
> 时间：2012-09-27T22:05:57.687
> 
> 标签：z3

是否可以使用 smt-lib 或类似的 C/C++ API 来解析用户理论插件的输入？例如，在示例用户理论“test_user_theory.c”中，如何在输入文件中声明一个字符串变量和一个常量字符串（不将其分解为位向量）？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:43:18.867

函数`z3_parse_smtlib_string`, `z3_parse_smtlib_file`,允许用户将任意符号与给定的排序和声明绑定`z3_parse_smtlib2_string`。`z3_parse_smtlib2_file`因此，您可以将有限数量的符号与您的理论插件中定义的声明连接起来。这不是一个完美的解决方案，因为一些理论定义了任意数量的函数/常量声明和排序。例如，算术理论定义了符号：`0`、`1`、`2`等。数组理论定义了“无限”数量的排序。

请注意，理论插件 API 现在已过时。Z3 源代码现已可用，Z3 定理证明器的扩展可以直接在实际代码库中实现。Z3 源代码可在[http://z3.codeplex.com](http://z3.codeplex.com)获得。我计划在未来的版本中删除理论插件 API。

# jquery - Nivo Slider Jquery 插件 - 图像自动调整大小

> ID：12630713
> 
> 赞同：6
> 
> 时间：2012-09-27T22:06:14.350
> 
> 标签：jquery, html, css, slider, nivo-slider

**问题：**

我怎样才能让我的照片不被炸毁？为什么我看不到整个图像？

**解释：**

我将 Nivo Slider Jquery 插件放在我的网页上，效果很好！问题是当我放入图像时，图像尺寸不正确。图像模糊，滑块未显示整个图像。我查看了 CSS，它对我来说看起来不错。这是我的*HTML*代码：

```
 <div class="theme-bar slider-wrapper">
            <div id="slider" class="nivoSlider theme-bar">
                <a href="#"><img src="images/slide1.jpg" alt="" /></a>
                <img src="images/slide2.jpg" alt="" />
                <img src="images/slide3.jpg" alt="" />
                <img src="images/slide4.jpg" alt="" />
            </div>
       </div> 
```

这是我的 CSS（我有两个 CSS 文件链接到此页面***nivo-slider.css***和***bar.css***用于 Nivo Slider 主题）。

***nivo-slider.css***：

```
 .nivoSlider {
    position:relative;
    width:100%;
    height:auto;
    overflow: hidden;
}
.nivoSlider img {
    position:absolute;
    top:0px;
    left:0px;
    max-width: none;
}
.nivo-main-image {
    display: block !important;
    position: relative !important; 
    width: 100% !important;
}

/* If an image is wrapped in a link */
.nivoSlider a.nivo-imageLink {
    position:absolute;
    top:0px;
    left:0px;
    width:100%;
    height:100%;
    border:0;
    padding:0;
    margin:0;
    z-index:6;
    display:none;
}
/* The slices and boxes in the Slider */
.nivo-slice {
    display:block;
    position:absolute;
    z-index:5;
    height:100%;
    top:0;
}
.nivo-box {
    display:block;
    position:absolute;
    z-index:5;
    overflow:hidden;
}
.nivo-box img { display:block; }

/* Caption styles */
.nivo-caption {
    position:absolute;
    left:0px;
    bottom:0px;
    background:#000;
    color:#fff;
    width:100%;
    z-index:8;
    padding: 5px 10px;
    opacity: 0.8;
    overflow: hidden;
    display: none;
    -moz-opacity: 0.8;
    filter:alpha(opacity=8);
    -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
    -moz-box-sizing: border-box;    /* Firefox, other Gecko */
    box-sizing: border-box;         /* Opera/IE 8+ */
}
.nivo-caption p {
    padding:5px;
    margin:0;
}
.nivo-caption a {
    display:inline !important;
}
.nivo-html-caption {
    display:none;
}
/* Direction nav styles (e.g. Next & Prev) */
.nivo-directionNav a {
    position:absolute;
    top:45%;
    z-index:9;
    cursor:pointer;
}
.nivo-prevNav {
    left:0px;
}
.nivo-nextNav {
    right:0px;
}
/* Control nav styles (e.g. 1,2,3...) */
.nivo-controlNav {
     position: absolute;
    left: 0;
    bottom: -41px;
    z-index: 10;
    width: 100%;
    height: 30px;
    text-align: center;
    padding: 5px 0;
    border-top: 1px solid #333;
    background: #333;
    background: -moz-linear-gradient(top,  #565656 0%, #333333 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#565656), color-stop(100%,#333333)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #565656 0%,#333333 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #565656 0%,#333333 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #565656 0%,#333333 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #565656 0%,#333333 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#565656', endColorstr='#333333',GradientType=0 ); /* IE6-9 */
    opacity: 0.5;
    -webkit-transition: all 200ms ease-in-out;
    -moz-transition: all 200ms ease-in-out;
    -o-transition: all 200ms ease-in-out;
    transition: all 200ms ease-in-out;
}
.theme-bar .nivo-controlNav {
    bottom: 0;
    opacity: 1;
}
.nivo-controlNav a {
    display:inline-block;
    width:22px;
    height:22px;
    background:url(bullets.png) no-repeat;
    text-indent:-9999px;
    border:0;
    margin: 5px 2px 0 2px;
    cursor: pointer;
}
.nivo-controlNav a.active {
    background-position:0 -22px;
} 
```

这是另一个 CSS 文件。***bar.css***：

```
 .theme-bar.slider-wrapper {
    position: relative;
    border: 1px solid #333;
    overflow: hidden;
}
.theme-bar .nivoSlider {
    position:relative;
    background:#fafafa url(loading.gif) no-repeat 50% 50%;
}
.theme-bar .nivoSlider img {
    position:absolute;
    top:0px;
    left:0px;
    display:none;
}
.theme-bar .nivoSlider a {
    border:0;
    display:block;
}

.theme-bar .nivo-controlNav {
    position: absolute;
    left: 0;
    bottom: -41px;
    z-index: 10;
    width: 100%;
    height: 30px;
    text-align: center;
    padding: 5px 0;
    border-top: 1px solid #333;
    background: #333;
    background: -moz-linear-gradient(top,  #565656 0%, #333333 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#565656), color-stop(100%,#333333)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #565656 0%,#333333 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #565656 0%,#333333 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #565656 0%,#333333 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #565656 0%,#333333 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#565656', endColorstr='#333333',GradientType=0 ); /* IE6-9 */
    opacity: 0.5;
    -webkit-transition: all 200ms ease-in-out;
    -moz-transition: all 200ms ease-in-out;
    -o-transition: all 200ms ease-in-out;
    transition: all 200ms ease-in-out;
}
.theme-bar:hover .nivo-controlNav {
    bottom: 0;
    opacity: 1;
}
.theme-bar .nivo-controlNav a {
    display:inline-block;
    width:22px;
    height:22px;
    background:url(bullets.png) no-repeat;
    text-indent:-9999px;
    border:0;
    margin: 5px 2px 0 2px;
}
.theme-bar .nivo-controlNav a.active {
    background-position:0 -22px;
}

.theme-bar .nivo-directionNav a {
    display:block;
    border:0;
    color: #fff;
    text-transform: uppercase;
    top: auto;
    bottom: 10px;
    z-index: 11;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
    opacity: 0.5;
    -webkit-transition: all 200ms ease-in-out;
    -moz-transition: all 200ms ease-in-out;
    -o-transition: all 200ms ease-in-out;
    transition: all 200ms ease-in-out;
}
.theme-bar a.nivo-nextNav { right: -50px; }
.theme-bar a.nivo-prevNav { left: -50px; }
.theme-bar:hover a.nivo-nextNav { 
    right: 15px; 
    opacity: 1;
}
.theme-bar:hover a.nivo-prevNav { 
    left: 15px; 
    opacity: 1;
}
.theme-bar .nivo-directionNav a:hover { color: #ddd; }

.theme-bar .nivo-caption {
    font-family: Helvetica, Arial, sans-serif;
    -webkit-transition: all 200ms ease-in-out;
    -moz-transition: all 200ms ease-in-out;
    -o-transition: all 200ms ease-in-out;
    transition: all 200ms ease-in-out;
}
.theme-bar:hover .nivo-caption {
    bottom: 41px;
}
.theme-bar .nivo-caption a {
    color:#fff;
    border-bottom:1px dotted #fff;
}
.theme-bar .nivo-caption a:hover {
    color:#fff;
}

.theme-bar .nivo-controlNav.nivo-thumbs-enabled {
    width: 100%;
}
.theme-bar .nivo-controlNav.nivo-thumbs-enabled a {
    width: auto;
    height: auto;
    background: none;
    margin-bottom: 5px;
}
.theme-bar .nivo-controlNav.nivo-thumbs-enabled img {
    display: block;
    width: 120px;
    height: auto;
} 
```

这是我使用的脚本。它是 Nivo Slider Jquery 插件附带的默认脚本，除了我稍微弄乱了设置。我只会向您展示我编辑的脚本，因为我限制为 30000 个字符：

```
 //Default settings
    $.fn.nivoSlider.defaults = {
        effect: 'fade',
        slices: 15,
        boxCols: 8,
        boxRows: 4,
        animSpeed: 550,
        pauseTime: 3500,
        startSlide: 0,
        directionNav: false,
        controlNav: true,
        controlNavThumbs: false,
        pauseOnHover: true,
        manualAdvance: false,
        prevText: 'Prev',
        nextText: 'Next',
        randomStart: false,
        beforeChange: function(){},
        afterChange: function(){},
        slideshowEnd: function(){},
        lastSlide: function(){},
        afterLoad: function(){}
    };

    $.fn._reverse = [].reverse;

})(jQuery); 
```

同样，问题只是图像看起来被炸毁了，而您看不到所有图像。我尝试将*.nivoSlider*类的宽度设置为图像的确切宽度，但它仍然无法正常工作。我在这里先向您的帮助表示感谢！是的，我确实使用以下代码激活了 Jquery：

```
<script type="text/javascript">
$(window).load(function() {
    $('#slider').nivoSlider();
});
</script> 
```

***评论：*** 图像的大小是我想要的。我认为它包裹滑块的 div 有问题。我只是不明白为什么图像是这样的。通常 Nivo Slider 会调整自身大小以适应图像，但它会调整我的图像大小以适应它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T01:42:05.553

您应该在将图像显示给用户之前调整其大小。如果图像已经在服务器上，如果它是 Linux 服务器，您可能可以使用[ImageMagik 的 mogrify cammond 。](http://www.imagemagick.org/www/mogrify.html)

# ruby-on-rails - Resque-ui 导致错误消息“尝试使用来自子进程的连接”重做

> ID：12630714
> 
> 赞同：0
> 
> 时间：2012-09-27T22:06:17.330
> 
> 标签：ruby-on-rails, resque

我正在使用 Resque 1.22.0，Resque-status 0.3.3 并且一切正常。如果我包含了rescue-ui gem，我会得到错误（来自队列）：

```
failed: #<Redis::InheritedError: Tried to use a connection from a child process without reconnecting. You need to reconnect to Redis after forking.> 
```

从 rake 任务代码中删除 resque-ui 并将其留在前台可以正常工作。有谁知道如何解决这个问题：非常烦人......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-25T07:54:33.040

尝试识别 resque 进程 ID，将其杀死并重新启动 resque 服务器。

此外，您可以尝试以下

```
Redis.current.client.reconnect
$redis = Redis.current 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T16:46:55.027

那是一段时间以来resque中的大问题之一看看这里看看[这里](https://github.com/defunkt/resque/issues/587)

`fork`退出时类似于mysql连接消失的问题

它关闭了所有它的连接只是这里的区别是它而不是`mysql`它`redis`

所以情况是这样的

```
#### Resque main worker
redis = Redis.new 
while(true) do 

#### Parent redis connection
redis.blpop(* queue_name)
#### redis queue are polled and message are consumed

#### Resque internally fork to performer the task 

fork {
  #### This fork used the redis connection from the main worker
  #### On exit the fork close the redis connection 
  ##### Perform the background task
}
end

## On Main Worker when the the resque try to use the same connection that was closed it raise the above error 
```

如何解决这个问题

有多种方法可以解决这个问题

a) 更新 resque （花了一段时间，但现在补丁更新是 resque ）看[这里](https://github.com/defunkt/resque/blob/master/lib/resque/worker.rb#L149)

b）如果您没有查看更新，那么您可以使用类似这样的 resque_hooks 来实现此目的

```
Resque.after_fork do 
  Resque.redis.client.reconnect
end 
```

c) 升级 Redis 服务器：- 这完全可以确定，但我注意到 Redis 2.4.6 不确定版本，虽然重新连接是通过 redis 内部实现的（不确定它是 redis 还是 redis 客户端，但认为重新连接是肯定的隐式发生）

希望这有帮助

# css - IE 打印不正确

> ID：12630718
> 
> 赞同：1
> 
> 时间：2012-09-27T22:06:26.783
> 
> 标签：css, internet-explorer, printing

有谁知道为什么 IE (8,9 Tested) 拒绝打印这张优惠券的右侧？（在红色背景上）左侧（电话号码）打印正常。

其他浏览器（chrome、FF）可以打印整个文档。

[http://www.weekend.co.il/templatesfiles/coupons/coupon.aspx?id=20483%20&resttype=19&coupontype=2](http://www.weekend.co.il/templatesfiles/coupons/coupon.aspx?id=20483%20&resttype=19&coupontype=2)

要查看错误，您可以打印到文件/或左键单击 >> 打印预览..

谢谢！

阿里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:13:58.337

IE 默认没有设置打印背景图片。

```
Goto Print Preview
Click the gears icon.
Tick the box - Print Background Colors and Images. 
```

![在此处输入图像描述](../Images/1f873d2d1c2573a302026b259ac879e2.png)

**这是我的打印尝试。**

![在此处输入图像描述](../Images/9a272c68bb36d8e0d3a03a99eb0e6391.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T23:45:34.410

找到了 ！需要指定背景图片如下：

```
 .background 
 {   
  display: list-item;   
  list-style-image: url(yourbackgroundimage.gif);   
  list-style-position: inside; 
 } 
```

感谢 DahlinDev [https://stackoverflow.com/a/1218059/422827](https://stackoverflow.com/a/1218059/422827)

# javascript - 是否有可以获取标准 lex 文件并在 JavaScript 中生成词法分析器的词法分析器生成器？

> ID：12630719
> 
> 赞同：0
> 
> 时间：2012-09-27T22:06:30.887
> 
> 标签：javascript, lex, lexer

我正在玩 CodeMirror，这是一个用 JavaScript 编写的基于浏览器的编辑器。它有一个可插入的语法高亮组件。我希望能够为任意语言获取标准 lex 文件，并在 JavaScript 中生成可以插入 CodeMirror 的词法分析器。有没有这样的词法分析器生成器可用？

# unit-testing - 单元测试：做最少的测试是否有效？

> ID：12630720
> 
> 赞同：1
> 
> 时间：2012-09-27T22:06:34.147
> 
> 标签：unit-testing, mockito

我有一个关于单元测试的基本问题。我在我的代码中发现了一个崩溃，我写了一个测试来重现这个错误。然后我修复了这个错误并验证它通过了测试。我的问题是，我是否采取了最好的方法。这是一个简化的示例：

```
public class ClassC
{
    private int internalFlag;

    void all(Dependency dep1, Dependency dep2, Dependency dep3, Dependency dep4)
    {
        a(dep1);
        b(dep2)
        c(dep3)
        d(dep4)
        e();
        f();
    }

    void e()
    {
        if (some logic based on dep3)
        {
            internalFlag = 2;
        }
    }

    void f()
    {
        if (internalFlag == 2)
        {
            Log("All is well");
        }
        else
        {
            Log("Crash occurs")
        }
    }
} 
```

在上面的示例中，我有一个名为“all”的方法，它调用方法 a、b、c、d、e、f。现在，我在“f”中发现了崩溃，因为“internalVar”不是预期值。这个“internalVar”是在“e”中设置的，但是正如你所看到的，如果条件为假，“e”不会将 internalFalg 设置为任何东西。所以错误在 e 中。

我能够编写测试来隔离错误。然后我修复了这个bug，发现测试过去了。太好了，但为了做到这一点，我必须这样做：

```
void testAll()
{
    mockDep1 = mock(dep1);
    mockDep2 = mock(dep2);
    mockDep3 = mock(dep3);
    mockDep4 = mock(dep4);

    all(mockDep1, mockDep2, mockDep3, mockDep4);
} 
```

现在，在这个例子中，我制作 mockDep1..4 的部分非常简单，但实际上是很长很费力的代码。我的问题是，仅仅做最少的调用来重现崩溃是否有效：

```
void testCrash()
{
   mockDep3 = mock(dep3);
   c(mockDep3)    
   e()
   f();
} 
```

这将是我重现和测试崩溃所需要做的所有事情，除了它不完全是在调用每个方法的实际方法“all”中调用代码的方式。似乎为每个错误一遍又一遍地编写 testAll 包括所有模拟有点乏味。但话又说回来，这就是实际方法“all”的工作方式。那么，即使在调用完整方法的情况下，隔离并不完全是它的工作方式，隔离 bug 是否更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:25:41.553

从您的示例中不清楚的是哪些方法是公共的，哪些是私有的（或受保护的或包私有的）。如果唯一的公共方法是被调用的方法`all`，那么只要有可能，这就是您的测试应该调用的方法，除非您正在测试真正包含在其中一种方法中的复杂逻辑。

当你选择编写哪些测试时，你应该真正关注这个类的契约是什么。你的应用程序的其余部分希望这个类提供什么功能？将您的测试方法基于该功能是什么；不是你碰巧写了哪些方法。

此外，如果 Dependency 类的唯一目的是支持 ClassC 的功能，那么您可以考虑一起编写 SUT 是这个 ClassC 和 Dependency 的测试（有些人称这些为“集成测试”，有些人称它们为“单元测试，其中单元由两个类组成”）。

在您的特定情况下，您的类似乎提供了跨方法划分的功能。所以测试功能 - 并测试可能导致功能以不同方式工作的不同场景。不要测试单个方法。特别是，您将有许多`all`在各种场景中调用该方法的测试；其中一些会导致错误发生（至少在您修复错误之前），而另一些则不会。

最后，为了帮助您在测试功能和场景方面进行思考，我认为您应该根据正在执行的功能和场景来命名您的测试方法，而不是根据被调用的方法。特别是，我认为`testAll`（实际上，任何由`test`后跟方法名称组成的名称）对于测试方法来说都是一个糟糕的名称。但也许这是改天要考虑的事情。

# objective-c - 子类化 CCSprite 的优势

> ID：12630721
> 
> 赞同：1
> 
> 时间：2012-09-27T22:06:42.160
> 
> 标签：objective-c, ios, cocos2d-iphone, subclass

我想了解更多关于对 CCSprite 进行子类化以及仅在初始化时创建 CCSprite 的优势。

iOS 开发和 Cocos2d 的新手。

我的游戏在初始化时创建了几个 CCSprite，并在触摸/拖动/碰撞时克隆了其中一些

也在寻找子类化的植入

更新：

此外，我的 Sprite 有一个文本标签以及一个音频文件和一个图像文件，它们与每个 sprite 略有不同。示例所有精灵具有相同的图像，但文本和音频不同。并且在碰撞时图像文件可能会改变

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:32:50.973

当你应该继承 CCSprite 时：

*   几乎从不
*   *仅*当您必须更改精灵的显示方式时（自定义绘制）

精灵是 Cocoa 术语中的“视图”。所有其他节点也是如此。问题是，Sprite 是在屏幕上渲染纹理的对象。如果您想更改 Sprite 的绘制方式，则子类化是有意义的，可能通过将两个纹理混合为一个，但通过运行不同的着色器代码，通过添加自定义 OpenGL 绘图来添加遮罩功能。

如果不清楚，请再次询问相同的问题，但关于不同的视图类：

```
"What's the advantage of subclassing UIButton? When does it make sense?" 
```

**答：仅当您需要更改按钮的显示方式时。**

您不会继承 UIButton 以使其在屏幕上移动或使其在文本字段上执行操作。这就是视图控制器的工作。视图控制器允许您按原样使用视图，没有子类化。你想要的是一个视图控制器，而不是 CCSprite 的子类。它已经做得太频繁了。

长话短说：

**仅当您无法通过其公共接口使其执行预期任务时才将 CCSprite （等）子类化。**

更改位置、旋转、缩放、纹理、精灵框架等都是您可以从外部类（控制器）更改的属性。动画精灵也是如此，无论是使用 CCAnimation 还是运行动作。

如果您使用 MVC 设计中惯用的控制器对象，您几乎不需要继承 CCSprite 或任何其他节点类。更重要的是，使用 userObject 属性，您可以将控制器对象与节点一起存储，因此当节点被释放时它会被释放。

当然，这两种方法都有效，最后只能归结为一个人想要使用最佳实践还是不良实践。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:21:17.743

通常，标准做法是继承 CCNode 并在初始化期间向其添加 CCSprite。基本上它归结为如果您实际上是在向基本精灵类添加功能，您将在所有精灵上重用，或者如果您只是创建一个具有健康和法力或其他东西的 Player 对象。在这个问题中有一些非常好的信息。

[我应该继承 CCSprite、CCNode 还是 NSObject？](https://stackoverflow.com/questions/7085130/should-i-subclass-ccsprite-ccnode-or-nsobject)

至于创建大量精灵并克隆它们，您应该看看**CCSpriteBatchNode**。批处理节点将在一次绘制调用中绘制所有具有相同纹理的精灵，这确实有助于提高性能。您也可以使用纹理图集将许多精灵的纹理组合成一个纹理并批处理整个事物。有一些很棒的工具可以提供这个功能，我强烈推荐[Texture Packer](http://texturepacker.com)或者这个。

如果您像您说的那样创建大量精灵，Texture Packer 也非常适合减少内存使用。所有纹理都以二维的幂存储在内存中，因此如果您有一个 130x130 的精灵，它实际上作为 256x256 未压缩图像存储在内存中。这会给应用程序增加大量内存。Texture Packer 通过将所有图像存储在一个二次方纹理中来避免这个问题，cocos2d 然后可以只提取每个精灵所需的部分。

有关所有这些的更多信息以及有关 Texture Packer 和批处理节点的精彩教程在这里：

[http://www.raywenderlich.com/2361/how-to-create-and-optimize-sprite-sheets-in-cocos2d-with-texture-packer-and-pixel-formats](http://www.raywenderlich.com/2361/how-to-create-and-optimize-sprite-sheets-in-cocos2d-with-texture-packer-and-pixel-formats)

# java - 字符串索引超出范围：-1；子字符串问题

> ID：12630723
> 
> 赞同：0
> 
> 时间：2012-09-27T22:06:47.840
> 
> 标签：java, string, exception

我正在为类编写一个程序，它计算字符串中的单词，如果输入的字符串超过 3 个单词，则再次打印句子，但每个单词都在自己的行上。

所以我试图用`\n`. 当我输入一个超过 3 个单词的句子时，我得到：

```
Exception in thread "main" java.lang.StringIndexOutOfBoundsException: String index out of range: -1
        at java.lang.String.substring(String.java:1937)
        at lab3.main(lab3.java:32) 
```

这是我的代码：

```
import java.util.Scanner;

public class lab3 {

public static void main(String [] args) {

    Scanner scan = new Scanner (System.in);

    int wordCount = 1;
    char aChar;

    System.out.println("Enter a sentence.");

    String sentence = scan.nextLine();
    int charCount = sentence.length();

    for (int i=0; i < sentence.length(); i++){
            if (sentence.charAt(i) != ' '){

                    continue;
            } else {
                    wordCount++;
                    }
            }

    System.out.println("Number of words = " + wordCount);

            if (wordCount >= 4){
            for (int i = 0; i <= charCount; i++){
                    int space = sentence.indexOf(" ");
                    int endSpace = space + 1;
                    sentence = sentence.substring(0, space) 
                            + "\n"
                            + sentence.substring(endSpace, sentence.length());
                    }
                    System.out.println(sentence);

            } else {
            System.out.println(sentence);

            }

    }
} 
```

问题似乎来自第 31 行的 for 循环，但我不明白当我输入一个超过 3 个单词的句子时它是如何返回 -1 的。我是否使用错误的子字符串？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:11:21.317

您需要检查`space`此处的索引。如果未找到搜索字符串，`String.indexOf()`将返回。`-1`

```
int space = sentence.indexOf(" ");
int endSpace = space + 1;
if (space != -1) {
    sentence = sentence.substring(0, space) + "\n"
            + sentence.substring(endSpace, sentence.length());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:26:17.867

如果你想保留你的代码，那么你必须在执行**sentence.index(" ")**时进行检查，如果它返回 -1。如果它返回你的循环突破如下。然而，这不是一种好的编码风格。我宁愿使用正则表达式或 String API 中的其他更简单的方法。

```
 if (wordCount >= 4){
            for (int i = 0; i <charCount-3; i++){
                    int space = sentence.indexOf(" ");
                    if(space==-1){// check if space is -1
                        break;
                    }   
                    System.out.println(i+ " " + space);
                    int endSpace = space + 1;
                    sentence = sentence.substring(0, space)
                            + "\n"
                         + sentence.substring(endSpace, sentence.length()-1);
                    }
                    System.out.println(sentence); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:13:41.983

*   我自己，我会使用`String#split(...)`方法，只需几行代码就可以解决这个问题。
*   但是如果你必须这样做，不要`for`循环或循环 charCount 次数，因为 charCount 是字符串的大小，你当然不想循环这么多次。这没有任何意义。相反，您想要循环空格数，而不是字符数，这让我想到了下一个建议：
*   使用`while`循环，而不是`for`循环和循环，直到`indexOf(...)`方法返回 -1。换句话说，让 Java 努力找出 String 何时用完空格，而不是你猜的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T01:03:09.033

我的解决方案不检查实际上不是单词的单词，

```
import java.util.Scanner;

public class SentenceWordCount {
    Scanner s = new Scanner (System.in);
    int wordCount;

    public SentenceWordCount() {
        System.out.println("Enter a sentence");

        String sentenceEntered = s.nextLine();
        String[] brokenSentence = sentenceEntered.split(" ");

        wordCount = brokenSentence.length;

        if(wordCount > 3){
        for(String s : brokenSentence){
                System.out.println(s);
            }
        }

        System.out.println("Number of words equals : " + wordCount);
    }
} 
```

干杯，

杰米

# mongodb - 删除并重新创建索引后，Elasticsearch 不会自动提取现有的 mongoDB 数据

> ID：12630724
> 
> 赞同：1
> 
> 时间：2012-09-27T22:06:47.810
> 
> 标签：mongodb, elasticsearch

抱歉，如果我问了一个愚蠢的问题，但我无法找出解决方案。我将数据存储在 mongodb 中，并且使用 richardwilly 的插件将集合映射到 es 索引。但是，我的一些索引搞砸了（由于不是我期望看到的所有数据都在 es 中（它仍在 mongodb 中））。我尝试在虚拟数据上创建一个虚拟索引，我希望在重新索引后，我现在可以在 es 中看到这些数据。

问题似乎是 mongo 河在 oplog 上运行，在我删除索引后，在插入下一个第一个新文档后，我想在 mongodb 中查看其他数千个文档，现在在 es 中自动可见。但是，我只看到删除并重新创建索引后插入的文档。其他 1000 个文档在 mongo 中仍然可见，但在 es 中不可见。

我做了一个小实验，发现如果我真的重新插入了 500 个文档，它们就会在 elasticsearch 中可见（如果索引正确允许它们全部插入）。您能否告诉我，在我重新创建索引后，如何使 mongodb 中的数据在 es 中可见，而无需删除并重新插入，因为我不能这样做。我是否需要重播 oplog 或者是否有另一种方法可以建议，这样我就可以将这些数据放入 es 而无需删除和重新插入？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T06:53:03.577

正如您所说，MongoDB 河使用 Mongo 的 oplog 工作，这意味着您只能将文档更改索引到 Elastic 中。（对 Mongo 索引的更改与 oplog 无关）为了索引在您的第一个 oplog 条目之前创建的文档，您需要找到另一种方法。

如果您不想删除+重新插入，您可以对现有文档执行批量更新。

或者，您可以实现一个工具，在 Elastic 中查找第一个文档，查询 Mongo 以查找任何较早的文档并索引缺失的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T21:09:54.823

在回答我自己的问题时，我得到了 elasticsearch 社区的帮助。如果您删除河流并创建一条新河流，那么您映射到的集合中的所有数据都应该在弹性搜索索引中可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T23:38:02.557

如果重新创建河流不起作用，则有几种选择。

1.  配置并启动副本集后，使用 mongodump/mongorestore 重新加载数据库。因为河流使用 oplog，所以当您创建河流时，如果新河流要知道数据存在并且应该被索引，则数据需要通过 oplog。（这在开发环境中可能更容易做到。）

2.  另一种似乎可行的方法是通过 rails 控制台触摸所有对象。同样，确保您的副本集已经在运行：

    ```
    $ bundle exec rails c
    1.9.1 :001 > Person.all.each do |person|
    1.9.1 :002 >     person.save()
    1.9.1 :003?>   end 
    ```

# unix - 在unix中显示时间？

> ID：12630725
> 
> 赞同：0
> 
> 时间：2012-09-27T22:06:54.560
> 
> 标签：unix, time

有没有办法在 UNIX 或 Mac OS X 中的每个命令行之前显示时间戳？

这是显示的内容：

```
[projects]$ make 
```

这大致是我想要的：

```
(1/13/2012 12:46.34) [projects]$ make 
```

编辑：这是我从'echo $PS1'得到的：

```
[\u@\h \W]\$ 
```

我想要同样的功能，但有一个时间戳。我对 PS1 变量及其语法不太熟悉，但是当我尝试输入 echo 吐出的内容 + 日期时，一切都搞砸了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:13:56.963

这取决于你的外壳。如果您使用 bash：

```
export PS1='\D{%D %H:%M.%S} [\W]\$ ' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:12:22.033

`date`使用命令设置您的 PS1 变量。

```
export PS1=$(date):$PWD $ 
```

PS1 通常设置在您的`.basrc`文件中，或者`.profile`您可以在您的主目录中找到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:08:43.063

使用`date`命令。

> date - 打印或设置系统日期和时间

[http://linux.about.com/od/commands/l/blcmdl1_date.htm](http://linux.about.com/od/commands/l/blcmdl1_date.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:12:42.460

在 bash 中，您可以键入

```
PS1="($(date +'%Y-%m-%d %H:%M:%S')) [\W]\$ " 
```

然后按回车。如果您喜欢它的外观，请将该行放在`~/.bashrc`文件末尾。

# android - 如何从 ListFragment 中删除透明度

> ID：12630727
> 
> 赞同：0
> 
> 时间：2012-09-27T22:06:58.200
> 
> 标签：android, android-listfragment

我有一个扩展 ListFragment 的片段，它在运行时添加到 FrameLayout。FrameLayout 已经包含一个 ImageView。

在运行时添加 ListFragment 时，我可以看到背景，我只想要纯色。

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<FrameLayout android:id="@+id/list_fragment" 
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <ImageView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:src="@drawable/icon"
        android:tileMode="repeat" />

</FrameLayout> 
```

我尝试了以下方法，但这只会在我滚动时变黑：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    getListView().setCacheColorHint(R.color.list_background);
    super.onActivityCreated(savedInstanceState);
} 
```

在 R.color.list_background 中是：

```
<color name="list_background">#e2f4c7</color> 
```

**见下面的截图：**

![在此处输入图像描述](../Images/30bbad0eedf3413ae43e1686263ac055.png)

**这是我的自定义适配器**

```
public class DailyFlightsAdapter extends ArrayAdapter<DailyFlightVO> {

Context context; 
int layoutResourceId;    
ArrayList<DailyFlightVO> data = null;

public DailyFlightsAdapter(Context context, int layoutResourceId, ArrayList<DailyFlightVO> dailyFlights) {
    super(context, layoutResourceId, dailyFlights);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = dailyFlights;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    FlightHolder holder = null;

    if(row == null){
        LayoutInflater inflator = ((Activity)context).getLayoutInflater();
        row = inflator.inflate(layoutResourceId, parent, false);

        holder = new FlightHolder();
        holder.distance = (TextView)row.findViewById(R.id.distance);
        holder.pilot = (TextView)row.findViewById(R.id.pilot);

        row.setTag(holder);
    }else{
        holder = (FlightHolder)row.getTag();
    }

    DailyFlightVO vo = data.get(position);
    holder.distance.setText(vo.getDistance());
    holder.pilot.setText(vo.getPilot());

    return row;
}

static class FlightHolder{
    TextView distance;
    TextView pilot;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:50:46.533

而不是`getListView().setCacheColorHint(R.color.list_background);`尝试以下操作：

```
getListView().setBackgroundColor(getResources().getColor(R.color.list_background)); 
```

另请参阅[setBackgroundColor](http://developer.android.com/reference/android/view/View.html#setBackgroundColor%28int%29)和 [getColor](http://developer.android.com/reference/android/content/res/Resources.html#getColor%28int%29)的文档。您必须在`getColor`此处使用，因为您需要将资源 ID 转换为真实颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:54:09.533

您需要为您的`ListView`项目设置背景。

# java - Fault Tolerance based Approaches to avoid java.lang.OutOfMemoryError

> ID：12630730
> 
> 赞同：1
> 
> 时间：2012-09-27T22:07:12.083
> 
> 标签：java, memory-management, out-of-memory, fault-tolerance

Many a carefully crafted piece of Java code has been laid to waste by java.lang.OutOfMemoryError. There seems to be no relief from it, even production class code gets downed by it.

The question I wish to ask is: are there good programming/architecture practices where you can avoid hitting this error.

So the tools at a Java programmers disposal seem to be:

1.  java.lang.Runtime.addShutdownHook(Thread hook) -- shutdown hooks allow for a graceful fall.
2.  java.lang.Runtime.freeMemory() -- allows us to check the memory available to the VM

So the thought I had is: could one write factory methods which before the creation of objects check if the system has adequate memory left before attempting to allocate memory? For example in C, the malloc would fail and you would know that you had run out of memory, not an ideal situation but you wouldn't just drop dead from an java.lang.OutOfMemoryError aneurism.

A suggested approach is to do better memory management or plug memory leaks or simply allocate more memory -- I do agree these are valuable points but lets look at the following scenarios:

1.  I'm running on an Amazon micro instance
2.  I can allocate very little memory to my VM say 400M
3.  My Java process processes jobs in a multi-threaded fashion, each thread consumes a variable amount of memory depending on the parameters of the computational task
4.  Let's assume that my process has no memory leaks
5.  Now if I keep feeding it jobs before they are complete it will eventually die of memory starvation
6.  If I set -Xmx too high -- I'll get swapping and possibly thrashing on the OS
7.  If I set an upper concurrently limit -- that might not be optimal as I could be limiting the accepting of a job which could be executed with the available RAM or worse accept a job that requires a LOT of memory and end up hitting java.lang.OutOfMemoryError anyway. X. Hope that helps explain the motivation of the question -- I think the standard responses are not mutually exclusive to seeking a fault tolerant approach to the problem.

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:24:04.987

We handled JVM memory more as a tuning parameter, than as something to manage actively with the application. We have a MemoryInfo class (which wraps several of the Runtime memory info methods).

While application is running, we track free memory in the application as:

```
 Runtime.getMaxMemory() - Runtime.getTotalMemory() + Runtime.getFreeMemory(); 
```

Max memory is the -Xmx jvm arg, total memory is what JVM has already allocated to the application heap, and free memory is how much of the allocated heap memory still available. (If your -Xms parameter is the same as your -Xmx parameter, then `getFreeMemory()` is all you need to check).

If we get above 70% memory usage, we send alerts to our monitoring system. At that point we make a decision whether we can limp through the rest of the day, or whether adjust the -Xmx parameter and restart. Although this seems a bit messy, in practice, once we have tuned a system, we *never* run into memory problems after that. (Once you get above 90% max memory used, the JVM will GC extremely frequently to try to prevent running out of memory).

I think the approach of managing memory with every construction is draconion, but if you need absolute control, then maybe it makes sense. Another approach is to make sure that any memory caches you use have an LRU or Expiration and reload mechanism, so you can better limit the number objects preserved in memory.

That said, our approach is to keep as much as possible in memory, and just allocate plenty of RAM. Our big systems have 28G RAM allocated (we use betwen 40-60% of that on average).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:51:50.970

OK, so the solution, as I have previously suggested, is to require less memory. There's no point in running an unlimited amount of threads because your process gets multiple requests. Limit the number of threads in each process, and handle at most that number of requests concurrently. The rest of the requests will simply wait.

Since you don't have an unlimited number of cores, too many threads are a bad idea, anyway.

# php - 如何避免在嵌套循环中执行 mysql 查询？

> ID：12630734
> 
> 赞同：1
> 
> 时间：2012-09-27T22:07:20.240
> 
> 标签：php, mysql

我被分配的任务有点问题。

我有这个旧的 phpmynewsletter 数据库（MySQL 后端）。

基本上所有电子邮件都保存在具有以下结构的表中：

```
 email   varchar(255)
    list_id int(11)
    hash    varchar(255)
    disclaimer1 tinyint(1)
    disclaimer2 tinyint(1)
    gender  char(1)
    dob date
    region  varchar(50) 
```

因此，同一封电子邮件可以在表格中多次出现，即订阅不同的时事通讯（由**list_id**标识）

我需要做的是更新记录，以便特定**list_id的字段****disclaimer1**、**disclaimer2**、**gender**、**dob**和**region**对于使用其他 list_id 注册的同一**电子邮件是相同的。**

 ****例如：

```
 email: email1(at)gmail.com
    list_id: 1
    disclaimer1: 0
    disclaimer2: 0
    gender: M
    dob: 1975-05-02
    region: Portugal 
```

和

```
 email: email2(at)gmail.com
    list_id: 33
    disclaimer1: 1
    disclaimer2: 0
    gender: M
    dob: 1975-05-02
    region: Portugal 
```

如何使用 list_id 1 的记录中的正确值更新 list_id 33 的记录？

我正在使用 PHP，我认为在循环中运行更新查询是不好的做法。该表有大约 610000 条记录。

希望有人能给我一些关于如何完成这项任务的见解。

谢谢，马里奥

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:28:56.003

@bigman 您发布的内容似乎是正确的，但我想问题是如何使用相同的电子邮件更改类似于 list_id: 1 的所有其他数据。

```
UPDATE my_table t,
 (
    SELECT
        email,
        disclaimer1,
        disclaimer2,
        gender,
        dob,
        region
    FROM
        my_table
    WHERE
        list_id = 1
) t1
SET 
 t.disclaimer1 = t1.disclaimer1,
 t.gender = t1.gender,
 t.dob = t1.dob,
 t.region = t1.region
WHERE
   t.email = t1.email 
```

我想这应该适用于所有具有 list_id: 1 电子邮件地址的条目。****

# php - Javascript Facebook Api 登录并关闭弹出窗口刷新父页面

> ID：12630739
> 
> 赞同：0
> 
> 时间：2012-09-27T22:07:43.487
> 
> 标签：php, javascript, facebook, facebook-javascript-sdk

我想让我的 facebook api 登录弹出窗口在用户登录后关闭，在用户单击带有 facebook 图像的登录后，弹出窗口成功打开，在用户登录弹出窗口后，弹出窗口仍然存在并重定向到我成功登录的网站但是，我希望在用户成功登录后关闭弹出窗口，并将父登录页面重定向到主页。

谢谢你，

这是我所做的：

Javascript 的：

```
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
FB.init({
    appId      : '<?php echo $_setting['facebook_api']; ?>',
    channelUrl : '//<?php echo $website; ?>/channel.html',
    status     : true,
    cookie     : true,
    xfbml      : true
});
 };

    (function(d) {
var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
js = d.createElement('script'); js.id = id; js.async = true;
js.src = "//connect.facebook.net/en_US/all.js";
d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
    </script>
<script type="text/javascript">

function popup(url)
{

 var width  = 600;
 var height = 400;
 var left   = (screen.width  - width)/2;
 var top    = (screen.height - height)/2;
 var params = 'width='+width+', height='+height;

 params += ', top='+top+', left='+left;
 params += ', directories=no';
 params += ', location=no';
 params += ', menubar=no';
 params += ', resizable=no';
 params += ', scrollbars=no';
 params += ', status=no';
 params += ', toolbar=no';

 newwin=window.open(url,'FB', params);
 opener.location.reload();
 if (window.focus) {newwin.focus()}

 return false;

 }

 </script> 
```

用户登录部分：

```
<a href="javascript:void(0)"
onclick="popup('https://www.facebook.com/dialog/oauth?client_id=<?php echo $_setting['facebook_api']; ?>
&redirect_uri=<?php echo urlencode($website."/index.php"); ?>
&cancel_url=<?php echo urlencode($website."/register"); ?>
&scope=email')">
<img src="<?php echo $website; ?>/images/fb.png" /></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:50:42.127

只需输出“window.parent.location ="www.pageafterlogin"; window.close();” 在子窗口中对我不起作用。我不得不使用间隔来检查子窗口（弹出窗口）是否已关闭。

这是我为使其工作而编写的函数（我的登录按钮是一个锚点，其类设置为“facebook_connect”）：

```
$(document).ready(function() {
    initFacebookConnect();
});

var fbTimer, fbChildWindow;
function fbPolling() {
    if(fbChildWindow && fbChildWindow.closed) {
        // The popup has been closed, stop the timer and reload window.
        clearInterval(fbTimer);
        window.location.href = window.location.href;
    }
}
function initFacebookConnect() {
    $('a.facebook_connect').click(function(event) {
        event.preventDefault();

        var url = $(this).attr('href');
        fbChildWindow = window.open(url, 'Facebook', 'status=1, resizable=0');
        fbTimer = setInterval('fbPolling()', 1000);
    });
} 
```

在 Facebook 重定向到的页面（redirect_uri 页面）内，我写道：

```
<script>window.close();</script> 
```

我希望这对某人有用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:19:17.190

您需要登录才能重定向到页面将运行 window.close() 并使用 window.parent 将主页页面重定向到您想要的页面

尝试将代码添加到登录重定向到的页面（在弹出窗口内） window.parent.location ="www.pageafterlogin"; 窗口.close();

我目前是用我的手机写的，所以有点难，但这应该可以解决问题。如果没有，我明天会尝试重写它。

# r - garchFit 错误：solve.default(fit$hessian) 中的错误：系统在计算上是奇异的：倒数条件数 = 9.58802e-18

> ID：12630750
> 
> 赞同：2
> 
> 时间：2012-09-27T22:08:45.060
> 
> 标签：r, error-handling

我正在使用 R 来拟合 AR-GARCH 模型并得到以下错误。有没有办法解决它？

```
fit1=garchFit(~ arma(1,0)+garch(2,1), data = M1[,1], cond.dist = "sstd", trace = FALSE)
Error in solve.default(fit$hessian) : 
  system is computationally singular: reciprocal condition number = 9.58802e-18 
```

# javascript - 具有完整录制功能的 javascript 富文本编辑器

> ID：12630751
> 
> 赞同：0
> 
> 时间：2012-09-27T22:08:49.680
> 
> 标签：javascript, html, rich-text-editor

我想创建富文本编辑器，该编辑器能够捕获有关文档修改的所有可能事件，然后重放捕获的事件序列以重建同一文档。

基本上我想记录对文档所做的每一个更改并记录所有的增量我希望能够“重放”这些更改以获得相同的文档。

我已经尝试过 YUI 编辑器 tinyMCE，但我缺少实际重建同一文档的能力。有没有具有这种功能的现有解决方案？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-27T22:16:24.617

[试试](http://www.webspellchecker.net/v3/samples/scayt_ckeditor_plugin.html)ckeditor.com，他们的 API 和功能是所有富编辑器中最好的

# couchdb - 使用 CouchDB 和 elasticsearch 进行不同的选择

> ID：12630753
> 
> 赞同：1
> 
> 时间：2012-09-27T22:08:56.030
> 
> 标签：couchdb, elasticsearch

我有这个 CouchDB/ [elasticsearch](http://www.elasticsearch.org/)设置。CouchDB 作为存储，elasticsearch 用于搜索。

我需要执行这个查询，

```
select distinct name from table 
```

在这个*“表”中*

```
[
  {name:'david' ... more data},
  {name:'david' ... more data},
  {name:'alex' ... more data}
  {name:'alex' ... more data}
] 
```

得到这个：

```
 ['david', 'alex'] 
```

或这个：

```
 [
      {name:'david'},
      {name:'alex'}
  ] 
```

或以任何形式，但不同查询的结果。

使用 CouchDB 可以通过以下方式完成：

```
// map
function(doc) {
    emit(doc.name);
}

// reduce
function(keys, values) {
   return null;
} 
```

但我想使用elasticsearch来做到这一点。网上有一些资料，但不是很清楚。

有人能指出我正确的方向来实现我想要的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T02:28:56.323

您可以在字段上使用[术语 Facet 查询](http://www.elasticsearch.org/guide/reference/api/search/facets/terms-facet.html)`name`来做到这一点。

# amazon-web-services - 在 SQS 中查找某些消息

> ID：12630756
> 
> 赞同：29
> 
> 时间：2012-09-27T22:09:25.357
> 
> 标签：amazon-web-services, amazon-sqs

我知道 SQS 不是为此而构建的，但我很好奇是否可以在队列中找到符合某些标准的消息？

我可以循环拉取消息，在消息正文中搜索某种模式（甚至无需反序列化它们），然后过滤我需要的消息。但随后可能会以无限循环结束——当我到达队列末尾时，我读到的第一条消息将返回到队列中......

可以扩展消息的可见性，但是我如何确切知道扫描整个队列需要多长时间，以及应该扩展可见性多长时间？如果我在那里确实有一万条消息怎么办？

这里有什么解决方法吗？我需要扫描队列中的一些消息，然后删除那些...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-05T08:33:20.370

简短的回答：没有。

队列是为诸如任务之类的事情而设计的。机器从队列中抓取一个新任务（即消息），执行该任务，然后删除该任务。

如果您尝试搜索消息以过滤它们，我不禁想知道您是否使用了错误的工具来完成这项工作……</p>

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-04-04T06:39:29.623

我不认为简短或冗长的答案是“否”。

这是两个“是”的对位解决方案。

1.  遍历Queue，维护访问列表
2.  使用企业集成模式（消息路由）根据标准将消息拆分为下游

**1.遍历Queue，维护访问列表**

考虑一个有`N`消息的队列的情况，没有消息被添加或删除。如果没有其他信息（例如，如果您知道有多少消息应该符合您的条件），您需要遍历所有`N`消息。

这里的关键点是知道您何时遍历了所有`N`消息。这里有一些问题。

1.  要准确了解，您必须在将消息添加到队列时对其进行跟踪
2.  大致了解一下，可以得到`ApproximateNumberOfMessages`队列的属性
3.  或者你可以在一个循环中接收消息，维护一个访问列表，并假设你最终会从你的队列被分片的每个服务器中采样和耗尽消息

为了维护访问列表，当您接收消息并评估您的匹配标准时，您可以存储`message_id`所有访问消息的列表。

消息 ID*几乎*是唯一的。看到这个线程

[https://forums.aws.amazon.com/message.jspa?messageID=76119](https://forums.aws.amazon.com/message.jspa?messageID=76119)

如果您选择 (3)，您将无法确定需要多少次迭代才能耗尽队列。但是，如果您无限期地执行此操作，则只要 SQS 分片服务器上的加权随机分布为它们提供所有非零概率，就可以保证使队列充满。

**2\. 使用企业集成模式（消息路由）根据标准将消息拆分为下游**

如果您可以控制您的消息传递体系结构，您可以使用消息路由器作为“前端”消息处理器，根据标准将消息分派给不同的接收者。

具体来说，您将使用基于内容的路由器：

[http://www.enterpriseintegrationpatterns.com/patterns/messaging/ContentBasedRouter.html](http://www.enterpriseintegrationpatterns.com/patterns/messaging/ContentBasedRouter.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-04-06T17:00:11.313

我们有类似的要求，最终得到了本“动手”教程中描述的架构：[过滤发布到主题的消息](https://aws.amazon.com/getting-started/hands-on/filter-messages-published-to-topics/)。

本质上，不是将事件/消息发布到 SQS 队列，而是将它们发布到 SNS 主题，每个消费者将拥有自己的订阅该主题的 SQS 队列。然后，您可以使用[SNS 订阅过滤器](https://docs.aws.amazon.com/sns/latest/dg/sns-subscription-filter-policies.html)来确保只有相关消息排入每个消费者的队列。

这会产生额外的基础设施开销，但它作为我们的解决方案效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-15T17:22:13.287

即使在请求特定属性时，对于不包含该属性的消息，该值只会设置为 null，您仍然可以使用某种方式进行过滤。那些没有按照您想要的方式设置属性的人可以将其可见性设置为 1 然后释放，因此它们将保留在队列中。将提供一种粗略的方式来进行优先级排队，尽管您可以根据消息内容轻松地做同样的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-03T14:40:13.783

用不同的案例进行了测试。这没用。答案是不

**测试数据**

```
public void fillQueueWithMessages(){

  MessageAttributeValue value1 = new MessageAttributeValue();
  value1.setDataType("String");
  value1.setStringValue("1");

  SendMessageRequest send_msg_request = new SendMessageRequest()
      .withQueueUrl(env.getProperty("cloud.aws.sqs.readyForTranslation.url"))
      .withMessageBody("test1").addMessageAttributesEntry(value1.getStringValue(), value1);
  amazonSqs.sendMessage(send_msg_request);

  MessageAttributeValue value2 = new MessageAttributeValue();
  value2.setDataType("String");
  value2.setStringValue("2");

  SendMessageRequest send_msg_request2 = new SendMessageRequest()
      .withQueueUrl(env.getProperty("cloud.aws.sqs.readyForTranslation.url"))
      .withMessageBody("test2").addMessageAttributesEntry(value2.getStringValue(), value2);
  amazonSqs.sendMessage(send_msg_request2);

  SendMessageRequest send_msg_request3 = new SendMessageRequest()
      .withQueueUrl(env.getProperty("cloud.aws.sqs.readyForTranslation.url"))
      .withMessageBody("test3").addMessageAttributesEntry(value1.getStringValue(), value1);
  amazonSqs.sendMessage(send_msg_request3);

} 
```

**测试**

```
public void shouldPollMessagesBasedOnMessageAttribute() throws InterruptedException {

ReceiveMessageRequest request =
    new ReceiveMessageRequest(env.getProperty("cloud.aws.sqs.readyForTranslation.url"));
request.setMaxNumberOfMessages(3);
request.setWaitTimeSeconds(20);
request.withMessageAttributeNames("1");

List<Message> messages = new ArrayList<Message>();

messages = amazonSqs.receiveMessage(request).getMessages();

assertEquals(2, messages.size());
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-12T15:58:09.283

对于完全控制一切的谦逊的开发工程师：

(1) 快速关闭消费者，因此消息被捕获到队列中。

(2) 关闭源。

(3) 读取所有 SQS 队列以查找您的消息，同时复制到“临时”队列。

(4) 将所有“临时”队列复制回 SQS 队列。谷歌它有很多工具。

(5)重启源和消费者。

如果您事先想到，另一种方法是使用 SNS 或其他东西复制到辅助“devops”队列，并在需要查找消息时通读该队列。您可以将“devops”队列的保留期设置得较短，以使其大小保持合理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-29T20:57:30.790

好的，这个问题永远是老生常谈了，doron-BGU bgu'声称属性如他所描述的那样工作也是如此。

我有几个“生产者”将相同的 JSON 发送到我的 SQS 中，我的“消费者”必须根据它们的来源、移动客户端、MVC 客户端或其他内部桌面应用程序与他们共舞。

我真的很想测试doron-BGU bgu的理论真的很糟糕。但为了务实，我的单个消费者对来自队列的这些消息执行明显不同的处理，只是检查每个消费者在 JSON 中的一个值，我强迫生产者填写定义消息源的值。苹果在这里，橘子在那边。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-04T07:33:25.330

老话题，但可能会有所帮助您可以将 FIFO 与 GroupId 一起用于 [帮助我的消息线程的小列表](https://stackoverflow.com/a/62189050/13678017)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-13T15:42:25.473

如果您有一个相当小的消息过滤器列表，您可以为每个模式创建一个单独的队列。

例如，如果您的过滤对象是“颜色”，并且您知道值只有红色、蓝色和绿色，您可以为每种颜色创建一个队列。这样你就不需要过滤——只需从适当的队列中提取。显然，如果可以有 1000 种颜色，那么这种方法是不切实际的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-05-24T03:45:29.083

让我们通过一些示例来理解这一点，因此创建 10 条消息并发送它

```
// Send a message
for (int i = 0; i < 10; i++) {
    System.out.println("Sending a message to MyQueue.\n");
    Map<String, MessageAttributeValue> messageAttributes = new HashMap<>();
    // extra code

    String sdate;
    Format formatter;
    Date date = new Date();

    // 2012-12-01
    formatter = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
    sdate = formatter.format(date);
    System.out.println(sdate);

    messageAttributes.put("Datestamp"+i, new MessageAttributeValue().withDataType("String").withStringValue(sdate));

    Map<String, MessageAttributeValue> messageAttributes1 = new HashMap<>();
    messageAttributes1.put("attributeName", new MessageAttributeValue().withDataType("String").withStringValue(sdate));
    SendMessageRequest request = new SendMessageRequest();
    request.withMessageBody("A test message body."+sdate);
    request.withQueueUrl(myQueueUrl);
    request.withMessageAttributes(messageAttributes);
    sqs.sendMessage(request);
} 
```

现在，即使您有 10 条带有 datetimestamp1 到 datetimestamp10
属性的消息过滤也不起作用

让我们尝试使用一些 myTag 属性进行过滤

```
ReceiveMessageRequest receiveMessageRequest = new ReceiveMessageRequest(myQueueUrl);

//ReceiveMessageRequest receiveRequest = new ReceiveMessageRequest(queueUrl);

receiveMessageRequest.withMaxNumberOfMessages(10);
receiveMessageRequest.withMessageAttributeNames("myTag");
List<Message> messages = sqs.receiveMessage(receiveMessageRequest).getMessages(); 
```

它提供 10 条消息，并且 myTag 值为 null

message.getMessageAttributes().get("Datestamp") 为空 message.getMessageAttributes().get("myTag") 为空

因此，我们无法使用消息属性进行过滤，就好像找不到该键一样。没有消息属性或所有消息属性相同。

这么长的答案是NOOOOO

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2016-04-02T21:24:53.210

这其实不全是真的，

实际上，您可以使用消息属性技巧“有点”过滤队列中的消息。

每条消息都可以包含您可以在创建消息时添加的属性（您需要为每个属性提供 3 项内容：名称、类型、值）。

稍后，当您创建新的 ReceiveMessageRequest 对象时，您可以使用“withMessageAttributeNames”来指定一个属性，实际发生的是您的队列被过滤为包含该特定属性的消息。

例如：

```
String queueUrl = sqs.getQueueUrl("myQueue").getQueueUrl();

ReceiveMessageRequest receiveRequest = new ReceiveMessageRequest(queueUrl);

receiveRequest.withMaxNumberOfMessages(10);
receiveRequest.withMessageAttributeNames("myTag"); 
```

如果您的队列包含 5 条消息，但只有 1 条具有“myTag”属性，则只会返回该特定消息。

这对我来说是压倒性的，因为这在[ReceiveMessageRequest](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/sqs/model/ReceiveMessageRequest.html#withMessageAttributeNames(java.util.Collection)) API中没有提到

所以基本上你所要做的就是给每条消息一个唯一的属性（请注意属性限制：`The message attribute name can contain the following characters: A-Z, a-z, 0-9, underscore (_), hyphen (-), and period (.). The name must not start or end with a period, and it should not have successive periods. The name is case sensitive and must be unique among all attribute names for the message. The name can be up to 256 characters long. The name cannot start with "AWS." or "Amazon." (or any variations in casing)`

# javascript - 如何在没有 fbml 的情况下隐藏内容直到用户喜欢您的页面？

> ID：12630758
> 
> 赞同：-1
> 
> 时间：2012-09-27T22:09:27.083
> 
> 标签：javascript, html, facebook, facebook-graph-api

> **可能重复：**
> [如何使用 Facebook 的 API 检查用户是否喜欢我的 Facebook 页面或 URL](https://stackoverflow.com/questions/5093398/how-to-check-if-a-user-likes-my-facebook-page-or-url-using-facebooks-api)

仅当用户是粉丝或喜欢我的页面而不使用 fbml 时，我如何才能显示或显示信息。我那里有一些旧代码。

就像是：

```
<fb:visible-to-connection>
    Show content to the user
    <fb:else>
        <div style="position:absolute; top:0; left:0;">
               Like the page inorder to view the content.
        </div>
    </fb:else>
</fb:visible-to-connection> 
```

但是 fbml 已被弃用，我需要通过 javascript 进行此操作，而无需使用与服务器相关的代码，如 php 或 aspx。

谢谢你的帮助。

并原谅我糟糕的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:12:44.827

将处理程序函数附加到 facebook，例如按钮单击事件，以显示数据。

但是如果没有实际检查 facebook 服务器，您无法确定，因此用户总是可以通过调用显示信息的 javascript 函数来伪造它，而您不会检查用户是否行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T00:48:10.247

Facebook 上详细说明了如何仅使用 Javascript 来完成此操作[如何检查用户是否喜欢页面并显示内容？](https://stackoverflow.com/questions/6246449/facebook-how-to-check-if-user-has-liked-page-and-show-content)

# xml - 一个 xml 元素（带子元素）到许多表行

> ID：12630764
> 
> 赞同：0
> 
> 时间：2012-09-27T22:10:46.067
> 
> 标签：xml, sql-server-2000

我需要将下面的 XML 结构变成下面的表结构（在 SQL Server 2000 中）

```
<family>
  <parent>
    <id>1</id>
    <child>test1</child>
    <child>test2</child>
  </parent>
  <parent>
    <id>2</id>
    <child>test3</child>
    <child>test4</child>
  </parent>
</family> 
```

表中样本数据：

```
parent_id child
1         test1
1         test2
2         test3
2         test4 
```

询问：

```
SELECT Child FROM 
  OPENXML (@hdoc, 'family/parent/child') 
    WITH(Child nvarchar(256) '.') 
```

给出结果：

```
test1
test2
test3
test4 
```

查询 #2：

```
SELECT ParentID, Child FROM 
  OPENXML (@hdoc, 'family/parent') 
    WITH(
      Child nvarchar(256) 'child/.',
      ParentID int 'id/.'
    ) 
```

给出结果：

```
1 test1
2 test3 
```

如何同时获得父母 ID 和所有孩子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:30:13.483

```
SELECT ParentID, Child FROM 
  OPENXML (@hdoc, 'family/parent/child') 
    WITH(
      Child nvarchar(256) '.',
      ParentID int '../id'
    ) 
```

# r - 构建 R 包

> ID：12630770
> 
> 赞同：2
> 
> 时间：2012-09-27T22:11:25.667
> 
> 标签：r, packages

我目前正在构建一个 R 包。

我希望提供示例数据。我知道 package.skeleton() 创建的数据目录以及如何加载数据集等。

问题是，我设计了读取文件作为输入的函数——原因是那些使用我的包的人通常会加载大型数据集。因此，我的函数逐行读取文件。

我在让我的包通过检查阶段时遇到问题，因为我不清楚如何让我的函数读取示例数据文件，而不是先加载它们，然后将结果表/数据框作为参数传递。

我希望这很清楚。

提前致谢！

### 编辑### 回复评论

我的函数将文件作为参数，即

```
example <- function(test_file){

test <- readLines(testFile)

....Do something to each line ...

} 
```

我不清楚如何使用我的 R 文档代码将文件而不是数据框传递给我的函数。

我在文档中的测试代码如下

```
\examples{
library(new_package)
tester <- test(testfile=somefile)
} 
```

这无法执行，因为看起来 R 期待一个数据结构，如：

```
data(somedataset)
testet <- example(somedataset) 
```

该错误是由于 R CMD 检查过程无法定位和读取我的文件造成的。有没有一种方法可以构造我的包，以便函数的参数是文件而不是数据结构，如果是这样，我如何在文档中的示例代码中将这些文件作为参数传递。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:58:47.253

这个示例函数怎么样：

```
#' Example function
#' @param test_file file path
#' @examples \dontrun{
#' example(system.file('example_data.txt', package='package_name'))
#' }
example <- function(test_file) {
    test <- readLines(testFile)
    # whatever you wish to do
} 
```

**详细说明：**

*   将示例数据集从`data`dir （如果我是对的，它将保存要在没有自定义函数的情况下加载的数据集）到 eg`inst`目录，这最终会将您的示例文件放在已安装包的目录中，
*   `system.file`在文档中引用演示文件，
*   并指定示例`\dontrun`以消除由自动运行但仍显示在文档中引起的任何警告（尽管如果上述情况正常，则不需要后者恕我直言）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:57:38.987

我理解您对大数据的困境（我是一名处理同样问题的生物学家），所以我建议不要运行该示例。这将允许您通过检查，但您还应该添加一个小注释（作为注释或函数文档中的其他地方），说明为什么这些不是直接运行的示例。

```
\examples{
\dontrun{
# Throw in your examples here
 }
} 
```

这应该允许您通过检查（至少解决这个问题）并使您的包可安装。

# azure - 我的 cspack 命令应该是什么来打包 azure 项目

> ID：12630771
> 
> 赞同：2
> 
> 时间：2012-09-27T22:11:33.907
> 
> 标签：azure

我尝试了很多不同的方法，请帮助。

我的目录结构如下：

```
trunk/Portal/MYAPPLICATION.Cloud    (cloud project)
trunk/Portal/Portal/MYAPPLICATION.Portal    (web app) 
```

我的服务定义：

```
<?xml version="1.0" encoding="utf-8"?>
<ServiceDefinition name="MYAPPLICATION.Cloud" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition" schemaVersion="2012-05.1.7">
<WebRole name="MYAPPLICATION.Portal" enableNativeCodeExecution="true">
<ConfigurationSettings>
  <Setting name="DiagnosticsConnectionString" />
  <Setting name="DataConnectionString" />
  <Setting name="BaseUrl" />
  <Setting name="DatabaseConnectionString" />
  <Setting name="Environment" />
</ConfigurationSettings>
    <Bindings>
      <Binding name="HttpIn" endpointName="HttpIn" />
    </Bindings>
  </Site>
</Sites>
<Endpoints>
  <InputEndpoint name="HttpIn" protocol="http" port="80" />
</Endpoints>
<Imports>
  <Import moduleName="RemoteAccess" />
  <Import moduleName="RemoteForwarder" />
</Imports>
</WebRole>
</ServiceDefinition> 
```

我从代码中调用 cspack 作为构建服务器上构建过程的一部分。

```
 csPackProcess.StartInfo = new ProcessStartInfo
        {
            FileName = @"C:\Program Files\Microsoft SDKs\Windows Azure\.NET SDK\2012-06\bin\cspack.exe",
            Arguments = sb.ToString()
        }; 
```

那么具体来说，我的论点应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:22:06.697

您应该在**trunk/Portal**文件夹中运行以下命令：

```
cspack MYAPPLICATION.Cloud\ServiceDefinition.csdef /out:MYAPPLICATION.cspkg /role:MYAPPLICATION.Portal;Portal\MYAPPLICATION.Portal /sites:MYAPPLICATION.Portal;Web;C:\trunk\Portal\Portal\MYAPPLICATION.Portal 
```

更多信息：http: [//msdn.microsoft.com/en-us/library/windowsazure/gg432988.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg432988.aspx)

# scripting - (DOORS/DXL) 是否可以以编程方式编辑/修改对象文本/对象标题？

> ID：12630772
> 
> 赞同：1
> 
> 时间：2012-09-27T22:11:36.853
> 
> 标签：scripting, ibm-doors

是否可以以编程方式编辑/修改对象文本/对象标题？

如果是这样，你怎么做？我可以通过编程很好地编辑我的其他属性。我可以在 DOOR 中很好地编辑对象文本，但不能通过 DXL，

它说“无权修改属性“对象文本””

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:28:10.767

听起来您可能有权限问题，但如果不是这种情况，您的代码应该如下所示：

```
Object o = current
o."Object Text" = "This is my test text" 
```

这对任何属性都是一样的。如果这对您不起作用，请尽可能多地发布您的代码，以便我们查看可能出现的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T12:12:27.720

我从来没有声明过这样的东西 const Module currentModule = current

相反，我只是继续使用关键字“current”来引用我当前的模块。

在使用 currentModule 变量而不是“current”之后，它解决了我的问题。

# python - 用空格替换字母

> ID：12630773
> 
> 赞同：0
> 
> 时间：2012-09-27T22:11:38.820
> 
> 标签：python

我已经完成了这段代码，但我无法将字母“t”——小写和大写——替换为空格。我的代码格式应该相同，但我只需要帮助用空格替换“t”。例如，“The book on the table thttg”应该看起来像“he book on heable h g”。因此，几乎应该隐藏“t”。

```
def remoeT(aStr):
    userInput = ""
    while True:
        string = raw_input("Enter a word/sentence you want to process:")
        if string == "Quit":
            return userInput

        userInput = userInput + string
        if aStr != False:
            while "t" in userInput:
                index = userInput.find("t")
                userInput = userInput[:index] + userInput[index+1:]
        while "T" in userInput:
            index = userInput.find("T")
            userInput = userInput[:index] + userInput[index+1:] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T22:15:11.240

要将所有出现的`t`and替换`T`为 string 中的空格`input`，请使用以下命令：

```
input = input.replace('t', ' ').replace('T', ' ') 
```

或者使用正则表达式：

```
import re
input = re.sub('[tT]', ' ', input) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T22:14:27.793

为什么不简单地使用[替换](http://docs.python.org/library/stdtypes.html?highlight=replace#str.replace)功能？

```
s = 'The book on the table thttg it Tops! Truely'
s.replace('t', ' ').replace('T', ' ') 
```

产量：

```
' he book on  he  able  h  g i   ops!  ruely' 
```

可能不如使用正则表达式好，但可以使用。

然而，这似乎比正则表达式方法快得多（感谢@JoranBeasley 激励基准测试）：

```
timeit -n 100000 re.sub('[tT]', ' ', s)
100000 loops, best of 3: 3.76 us per loop

timeit -n 100000 s.replace('t', ' ').replace('T', ' ')
100000 loops, best of 3: 546 ns per loop 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T22:14:01.757

使用正则表达式：

```
>>> import re
>>> st = "this is a sample input with a capital T too."
>>> re.sub('[tT]', ' ', st)
' his is a sample inpu  wi h a capi al    oo.' 
```

另外，不要将变量命名为“字符串”；有一个“字符串”类会隐藏。

# android - 新手android编程编译错误

> ID：12630774
> 
> 赞同：1
> 
> 时间：2012-09-27T22:11:39.570
> 
> 标签：android, opengl-es

我正在尝试在这里编译和运行 OpenGL 示例代码：

[http://developer.android.com/training/graphics/opengl/environment.html](http://developer.android.com/training/graphics/opengl/environment.html)

我将项目导入 Eclipse，但是在尝试编译时，我得到了这个和其他类似的错误。

```
Multiple markers at this line
- The method onSurfaceCreated(GL10, EGLConfig) of type MyGLRenderer must override a superclass 
 method
- implements android.opengl.GLSurfaceView.Renderer.onSurfaceCreated 
```

有谁知道我做错了什么？谢谢鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:14:48.627

这源于`@Override`注释。确保您的编译器设置为 Java 1.6。假设您正确实现了方法签名，编译器合规性可能是一个问题。无论如何您都可以删除注释，但如果您没有正确实现签名，它将不会按预期调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:19:46.640

我猜你的java编译器设置为1.5。转到项目首选项并检查编译器。如果是这种情况，请将其更改为 1.6，它应该可以解决问题。如果这不起作用，请发布该方法的代码，我们会看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T23:39:51.133

您必须更改项目 ITSELF 的编译器设置 - 而不仅仅是转到“首选项 - 编译器”。

右键单击您的项目，选择项目属性，然后将编译器合规级别更改为 1.6。

我知道这是一个老问题，但由于很多人可能有这个问题，我想发布一个更准确的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-24T05:28:27.493

您可能会遇到此错误的另一个原因 - 确保您使用正确的类导入`EGLConfig`- Android Studio 为我提供了两个我想要的库的选择，`javax.microedition.khronos.egl.EGLConfig`或者`android.opengl.EGLConfig`. 我选择了第二个，这导致了这个错误。选择第一个修复它。

看到[这个链接](https://stackoverflow.com/questions/18553920/implementing-glsurfaceview-renderer-issues)

# graphics - 在 SlimDX 和 DX9 中，某些类末尾的后缀“Ex”是什么意思？

> ID：12630775
> 
> 赞同：1
> 
> 时间：2012-09-27T22:11:39.867
> 
> 标签：graphics, direct3d, slimdx

我注意到在 SlimDX.Direct3D9 命名空间中有很多具有两个不同版本的类和方法。一个版本有一个 Ex 后缀。我认为 DX9 API 也是如此。

例如：

SlimDX.Direct3D9.Device

SlimDX.Direct3D9.DeviceEx

SlimDX.Direct3D9.DisplayMode

SlimDX.Direct3D9.DisplayModeEx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T00:23:39.923

DirectX9Ex 主要是对 DirectX9 的改进，只为 Windows Vista 和更高版本添加了新功能（最值得注意的是共享资源的能力）。

每个之间有一些不兼容，例如在创建资源时，您必须小心选择哪个池（Pool.Managed 与 Device 一起工作，但您需要 Pool.Default 与 DeviceEx ）

如果您需要跨进程共享纹理，DeviceEx 是您唯一的选择，否则标准 Device 就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:13:56.947

**Ex** -tended 是我一直在脑海中阅读它的方式（尽管它可能是错误的）。

C 没有重载，因此如果更新 API 以考虑最初未考虑的额外内容，例如新的选项字段，请输入`FooEx`. （同样的推理也适用于新类型，即使重载不适用。）

虽然其他语言*确实*有重载，但包装器可能会保留`Ex`约定以更好地反映底层源 API，包括对类型使用“注释”。

此命名约定在大部分 Win-C/Microsoft API中一直使用，但*如果*`Foo2`是约定，则可能是。

# eclipse - 如何让 Eclipse（使用 PyDev）停止打开文件的并行版本？

> ID：12630779
> 
> 赞同：0
> 
> 时间：2012-09-27T22:12:10.003
> 
> 标签：eclipse, pydev

我设法很好地设置了我的 Eclipse/PyDev 环境：我可以在代码编辑器中按住 CTRL+单击（或 F3）一个变量/函数，然后让 Eclipse 将我带到该引用的定义。这很好，但有一个问题。

我想我一定是在我的设置中做错了什么，因为如果我打开了文件 A，并且我 CTRL+单击/F3 文件 B 中指向 A 的引用，Eclipse 不会显示（已经打开的）选项卡一个; 它打开了一个新标签......也是A。

（当然，当我没有注意到发生了什么并最终在一个窗口中进行了一些编辑时，它会导致 Eclipse 对另一个窗口感到不安，因为它现在已经过时了。）

有谁知道我如何错误配置 Eclipse/PyDev 来实现这一点……更重要的是，我该如何解决？

PS我正在使用virtualenv来包装我的整个实例（之前应该提到过，因为它可能是相关的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T18:41:48.197

似乎 PyDev 正在从外部解析某些文件（就好像它是在外部源文件夹或 python 解释器下配置的一样）。

这是一个公共项目，所以我可以看看它（比如在 github 上？）。此外，这种情况总是发生还是仅在某些特定用例上发生？

# asp.net-mvc - 为 ASP.NET MVC 在加载时隐藏的正确方法

> ID：12630787
> 
> 赞同：1
> 
> 时间：2012-09-27T22:12:57.633
> 
> 标签：asp.net-mvc, html, razor

所以我有一个表格，有两个输入，“免费”和“价格”。免费是一个复选框，如果选中该框，则不应显示价格框，如果未选中则应显示价格框。

我可以在页面加载后轻松挂钩 onChecked 并打开和关闭可见性，但问题是预加载什么是最佳做法。

据我所知，这里有三个主要解决方案：-

1.  设置内联样式以根据起始模型设置可见性，即 @(model.Free?"hidden":"visibile") 这似乎是一种不好的做法，因为 CSS 不应该与结构分离，这有点将两者混合一点。

2.  设置一个 jQuery 处理程序以在加载时触发以检查复选框状态，这种方法的问题是在它触发之前有几秒钟，所以你会得到一个“闪烁”

3.  我还缺少其他一些东西...

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:15:58.517

1.

大多数 css 样式最好分离到外部样式表中，但对于简单`style="display:none;"`的内联样式就可以了。

此外，从 MVC4 开始，如果变量为 null，Razor 将不会呈现该属性。

```
@{
    var displayIt = Model.Free ? "display:none;" : null;
}
<div style="@displayIt">
    The above style attribute will not be rendered when displayIt is null
    (in MVC4)
</div> 
```

# mongodb - Mongoose / MongoDB - 附加到文档对象数组的简单示例，具有预定义的模式

> ID：12630788
> 
> 赞同：6
> 
> 时间：2012-09-27T22:13:08.240
> 
> 标签：mongodb, mongoose, database-schema

为简单起见，假设这些是我的集合模式：

```
var MessageDeliverySchema = new Schema({
    from   : { type : String },
    to     : { type : String },
    status : { type : String }
});

var Messages = mongoose.model('messages',
new Schema({
    id              : ObjectId,
    user            : { type:String },
    'sent-messages' : [MessageDeliverySchema]
})); 
```

因此集合*Messages*中的每个文档可能有 4/5由 MessageDeliverySchema 定义的已*发送消息。*

我想要做的是有一个*sent-messages*数组，所以每次收到送达收据时，我都会更新*Messages*并附加另一条已发送的消息。

我试过的：

```
var delivered = {
from: 'foo',
to: 'bar',
status: 'delivered'
};

Message.update({_id: '5064aae4154cb34d14000001' },
        {$pushAll: { 'sent-messages' : delivered }} , {upsert:true}, function(err, data) { 

});

Message.update({_id: '5064aae4154cb34d14000001' },
         {$push: { 'sent-messages' : delivered }},{upsert:true}, function(err, data) { 
}); 
```

$pushAll 和 $push 不会将新对象附加到*sent-messages*，而是覆盖现有消息。

我想看到的是一组已发送的消息，例如：

```
{
    'sent-messages': [
        {
            from: 'foo',
            to: 'bar',
            status: 'delivered'
        },
        {
            from: 'pippo',
            to: 'pippo',
            status: 'delivered'
        },
        {
            from: 'paul',
            to: 'smith',
            status: 'undelivered'
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T09:05:02.290

我得到的错误是：'不能将 $push/$pushAll 修饰符应用于非数组'。

我在文档中添加了一个对象，如下所示：

```
 Message.update({_id: '5064aae4154cb34d14000001' },
           { 'sent-messages' : delivered }, function(err, data) { 
    }); 
```

然后尝试执行 $push，这给了我上述错误。

所以我删除了文档并使用了 $push ，它达到了预期的效果。

作为参考，这是附加到现有文档的正确方法，以及我的问题的答案：

```
Message.update({_id: '5064aae4154cb34d14000001' },
         {$push: { 'sent-messages' : delivered }},{upsert:true}, function(err, data) { 
}); 
```

# sql - SQL 仅在特定行上连接表

> ID：12630802
> 
> 赞同：2
> 
> 时间：2012-09-27T22:14:01.813
> 
> 标签：sql

我正在寻找关于如何做到这一点的心态的一般回应......我有一个表，其中有一列充满了可能的参数，一列充满了可能的值。我想将某种类型的所有参数连接到另一个表以进一步描述这些特定行，但不将该表连接到不包含特定值的所有其他行。它看起来像这样：

```
Parameters  Values   Mammal
   a          1         
   b          3
   d         cat      Yes
   c          4
   d         dog      Yes
   e          3
   d         fish      No
   f          2 
```

我尝试了多种使用 Case 的方法，但是表格变得非常奇怪，并且根据表格的长度重复连接表格。有什么建议么？

第二个表有两列，它在自己的动物列上连接到**参数 = "d"**的值列。当参数等于其他任何值时，它根本不会出现。任何建议将不胜感激！（如果您需要知道，我正在使用缓存 SQL。不过，我更愿意对技术进行一般性解释，它会更有帮助。）

编辑：对不起，这将是两个单独的表：

```
 Table 1:                                   Table 2:

Parameters  Values                           Animal      Mammal
    a        1                                 cat         yes
    b        3                                 dog         yes
    d        cat                              snake        no
    c        4                                fish         no
    d        dog                               rat         yes
    e        3                               hamster       yes
    d        fish
    f        2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T10:11:23.217

听起来您当前的查询正在使用`INNER JOIN`仅包含两个表中匹配的记录。您需要使用`LEFT JOIN`将产生所有记录`table1`和匹配记录的`table2`. 如果没有匹配，`table1`那么缺失的一方将等于 null：

```
select t1.parameters,
  t1.value,
  case when t2.mammal is null then '' else t2.mammal end Mammal
from table1 t1
left join table2 t2
  on t1.value = t2.animal 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/49f0a/3)

如果您需要帮助学习`JOIN`语法，有一篇很棒的文章：

[SQL 连接的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T10:28:21.110

两种选择。

首先使用子查询：

```
select [parameters], [values], 
    (select mammal from t2 where t2.animal = t1.[values]) as mammal
from t1 
```

其次使用左连接。

```
select [parameters], [values], t2.mammal
from t1
left join t2 on t1.[values] = t2.animal 
```

另一个答案使用左连接，但跳过另一个答案提供的空替换。

请注意，这仅在 MS SQL Server (T-SQL) 上进行了测试。

# jquery - 隐藏/取消隐藏 DIV 时是否可以使用 Jquery Mobile 数据转换效果

> ID：12630804
> 
> 赞同：2
> 
> 时间：2012-09-27T22:14:10.053
> 
> 标签：jquery, jquery-mobile

我有一个 Jquery Mobile 页面，页面拆分。左侧有列表视图，右侧将在单击左侧列表视图时显示详细信息。基本上，点击时，我正在隐藏/取消隐藏 DIV。它工作正常，但我想知道我是否可以在这样做时使用 Jquery Mobile 数据转换。这是示例代码

```
 <div id="left-side">
    <ul data-role="listview"  id="name1" data-theme="d" data-filter="false" data-inset="false" >
    <li data-icon="false" id="K1"><a href="#"   data-transition="slide"> Show A </a></li>
    <li data-icon="false" id="K2"><a href="#"   data-transition="slide"> Show B</a></li>
</ul>
 </div>
 <div id="right-side">
 <div id="A"> Showing DIV A </div>
 <div id="B" style="display:none">Showing DIV B </div>
  </div>

<script>    
 $('li#K1').live('click', function() {
    $("div#A").show();
    $("div#B").hide();
});

 $('li#K2').live('click', function() {
    $("div#A").hide();
    $("div#B").Show();

   }); 
```

# jquery - 输入字段时弹出建议列表

> ID：12630805
> 
> 赞同：1
> 
> 时间：2012-09-27T22:14:10.957
> 
> 标签：jquery, autocomplete

我做了一个带有自动建议的字段。我将 minLength 设置为 0；

当我输入文本字段时，我需要按一个非字符键（即向下箭头键）来获取未过滤的完整选项列表。

当我不按键输入字段时，我想要这种行为。我在 onFocus() 事件中尝试了以下操作：

```
 $('myinput').autocomplete( "search" ); 
```

但这只是行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T11:23:19.667

我过去曾这样做过。

[jsFiddle](http://jsfiddle.net/TheJoeFletch/D9XwN/)

```
$("input").autocomplete({
    minLength:0,
    source: ["one","two","three"]
    }).on("focus", function () { $(this).autocomplete("search"); });​ 
```

# r - 在非常大的数据集上执行 PCA 的最佳工具或包是什么？

> ID：12630807
> 
> 赞同：3
> 
> 时间：2012-09-27T22:14:14.187
> 
> 标签：r, pca, large-data

这似乎与此 URL 中提出的类似问题（[在非常大的稀疏矩阵上应用 PCA](https://stackoverflow.com/questions/10718455/apply-pca-on-very-large-sparse-matrix)）。

但我仍然无法得到我需要帮助的答案。我正在尝试为大约 700 个样本（列）和 > 4,00,000 个基因座（行）的非常大的数据集执行 PCA。我希望在 中绘制“样本”，`biplot`因此想考虑所有 4,00,000 个轨迹来计算主成分。

我确实尝试过使用`princomp()`，但我收到以下错误消息，

```
Error in princomp.default(transposed.data, cor = TRUE) : 
'`princomp`' can only be used with more units than variables 
```

我在论坛上查了一下，发现在单位比变量少的情况下，最好使用`prcomp()`than `princomp()`，所以我也尝试过，但我再次收到以下错误，

```
Error in cor(transposed.data) : allocMatrix: too many elements specified 
```

所以我想知道你们中是否有人可以建议我任何其他可能最适合我非常大的数据的好选择。我是统计学的初学者，但我确实读过 PCA 的工作原理。我想知道是否有任何其他易于使用的 R 包或工具来执行此操作？

# php - 使用 PHP 在亚马逊上查找价格的最佳方法

> ID：12630812
> 
> 赞同：1
> 
> 时间：2012-09-27T22:14:38.457
> 
> 标签：php, amazon

从亚马逊 ASIN 开始，仅查找当前价格的最优雅方式是什么？我确实有一个员工的 ID，所以我可以使用广告 API。假设我将使用香草 PHP。

谢谢。

# c++ - 如何不在项目文件之一中添加预编译头文件

> ID：12630814
> 
> 赞同：2
> 
> 时间：2012-09-27T22:14:58.787
> 
> 标签：c++, c

我遇到了这个问题，通常你们都会问我为什么，所以我先解释一下，这样你就可以回答我了，我正在研究一个至少有 500.000 行的源，但现在是我的一个源（.cpp ) 我刚刚创建的文件不能添加预编译头文件，即“StdAfx.h”，在这种情况下，我**不能**编辑项目预编译头文件设置，显然如果我尝试编译我的项目而不在新文件中包含 stdafx 我'会被C1010砸碎，我试过的是这个

StdAfx.h：

```
#ifndef __ABC123
//do all your includes
#endif 
```

我的文件.cpp：

```
#define __ABC123
#include "StdAfx.h"
#undef __ABC123 
```

虽然这不起作用，但 stdafx.h 仍然包含这些文件。为什么我不能在此 .cpp 文件中包含 stdafx.h 是因为 stdafx 上的某些包含与此 cpp 的包含有大量冲突。我无法修改 stdafx 包含的内容，因为有数千个其他文件使用它，如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:53:35.010

不可能的。你把自己画到了这里的一个角落。让我解释一下。

PCH 旨在用于*整个*项目。每个翻译单元都应包括 PCH。

此行为可以被覆盖，但只能通过相关翻译单元的项目设置。您已经说过，您不能编辑项目设置，从而消除了您唯一的逃生途径。

如果您真的需要这个并且没有出路，我会考虑采取诸如将非 PCH 代码移动到自己的项目中这样的激烈步骤。

# html - Facebook 之类的弹出对话框被截断到按钮的宽度

> ID：12630819
> 
> 赞同：4
> 
> 时间：2012-09-27T22:15:22.170
> 
> 标签：html, css, facebook, facebook-like

在这里查看我的博客：

[http://www.brixwork.com/realtors/blog/seo/best-time-to-post-on-facebook-or-twitter-and-email/](http://www.brixwork.com/realtors/blog/seo/best-time-to-post-on-facebook-or-twitter-and-email/)

当您尝试单击“LIKE”按钮时，弹出窗口出现在正确的高度，但宽度限制为按钮的宽度。

这是我的 CSS 代码：

```
.blog_social_media {
    float: right;
    border-left: 1px dotted #666;
    margin-bottom: 10px;
    margin-left: 10px;
    padding-top: 10px;
    overflow: visible;
}

.blog_social_media div {
    position:relative;
    display:block;
    float:left;
}

iframe.fb_ltr {
    width: 300px !important;
}

.blog_twitter_button {
    width: 55px;
    height: 62px;
    margin: 0px 0px 10px 10px;
}

.blog_facebook_button {
    width: 50px;
    height: 63px;
    overflow: visible !important;
    margin: 0px 0px 10px 10px;
}

.blog_googleplus_button {
    width: 50px;
    height: 64px;
    margin: 0px 0px 10px 10px;
} 
```

这是HTML代码：

```
<div class="blog_social_media" style="width:65px; height:auto;">
    <div class="blog_twitter_button">
        <a href="http://twitter.com/share" class="twitter-share-button" data-count="vertical" data-via="brixwork" data-related="sonikastudios">Tweet</a>
        <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    </div>
    <div class="blog_facebook_button">
        <div class="fb-like" data-href="http://www.brixwork.com/realtors/blog/seo/three-reasons-to-claim-your-place-on-google-places/" data-send="false" data-layout="box_count" data-width="50" data-show-faces="false" data-font="lucida grande">
        </div>
    </div>
    <div class="blog_googleplus_button">
        <!-- Place this tag where you want the +1 button to render -->
        <g:plusone size="tall"></g:plusone>

        <!-- Place this render call where appropriate -->
        <script type="text/javascript">
            (function() {
                var po = document.createElement('script'); 
                po.type = 'text/javascript'; 
                po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(po, s);
            })();
        </script>
    </div>                  
</div> 
```

我有溢出：可见；设置在我所有包含 facebook 气球的元素上。相同的 CSS 逻辑在 Google+ 弹出式对话框中运行良好，只是 Facebook 令人窒息。我能解决什么问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-07T08:30:59.650

```
.fb_edge_widget_with_comment span
{overflow:visible !important; width:450px !important; margin-right:-375px;} 
```

把它放在你的css中，它会将弹出窗口的大小设置为其*未声明*的大小，并通过负边距减少超宽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T09:42:29.340

好像有问题：

```
<div class="blog_facebook_button">
    <div class="fb-like" data-href="http://www.brixwork.com/realtors/blog/seo/three-reasons-to-claim-your-place-on-google-places/" data-send="false" data-layout="box_count" data-width="50" data-show-faces="false" data-font="lucida grande">
    </div>
</div> 
```

attr data-width="50" 需要为 data-width="250" 然后你需要添加

```
.blog_facebook_button { position: relative; }
.fb-like { position: absolute; top: 0; left: 0; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-12T01:29:42.460

这对我有用。

```
.fb-like span {
  overflow:visible !important; width:450px !important; margin-right:-400px;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-14T12:17:47.000

看起来像 div.fb-like -> span 正在切断它尝试 CSS：

```
div.fb-like span {
    width: 450px;
    overflow: visible;
} 
```

# jsoup - 尝试使用 jsoup 登录

> ID：12630820
> 
> 赞同：0
> 
> 时间：2012-09-27T22:15:28.877
> 
> 标签：jsoup, http-authentication

我登录到该网站（我知道，因为代码的结果显示我在：“Dilema Veche Contul meu Logout Întreb?ri frecvente ...等）但我无法浏览登录网站的链接，好像没有保留cookies什么的。有什么建议吗？谢谢。

公共类艺术 { 公共静态无效主（最终字符串 [] args）抛出 IOException {

```
Response res = Jsoup.connect("http://pay.dilemaveche.ro/autentificare/?redirect=http%3A%2F%2Fdilemaveche.ro%2F%2F&return=true").data("username", "myusername", "password", "mypassword").method(Method.POST).execute();

Map <String, String> cookies = res.cookies();
Document doc = Jsoup.connect("http://pay.dilemaveche.ro/autentificare/?redirect=http%3A%2F%2Fdilemaveche.ro%2F%2F&return=true").cookies(cookies).get();
Elements bck = doc.select("li.first").select("a[href]:contains(Dilema Veche)");
String str = bck.attr("abs:href");
Document doc0 = Jsoup.connect(str).cookies(cookies).get();
System.out.println(doc.text());
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T04:33:13.073

登录一个网站需要很多步骤，这取决于网站如何处理 cookie。现在大部分大网站都在使用自定义cookie策略，Jsoup cookie的handler非常通用。我不认为 JSoup 是一个好的选择，但是当你有 cookie 时，你可以使用 JSoup 来解析 HTML。我建议您应该尝试使用 HttpClient 或 URLConnection，尤其是[HttpClient](http://www.innovation.ch/java/HTTPClient/urlcon_vs_httpclient.html)。祝你好运！

# asp.net - ASP.NET Web API 中的授权：返回特定于授权用户的数据

> ID：12630821
> 
> 赞同：0
> 
> 时间：2012-09-27T22:15:28.767
> 
> 标签：asp.net, .net, web-services, rest

假设我使用[此处](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/)描述的自定义过滤器属性实现了基于令牌的授权。

我们还假设，我有一个返回任务的控制器：

```
public IEnumerable<Task> Get()
{
    // return tasks for authorized user
} 
```

现在，我将如何只为授权用户返回任务？将用户 ID 作为查询参数传递不是一种选择 - 禁止请求其他用户的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:35:41.747

您可以从您的操作过滤器中丰富 HttpRouteData 并在控制器操作中读取它。actionContext.ControllerContext.RouteData.Values.Add("UserId", someVaue);

您还可以使用 System.Runtime.Remoting.Messaging.CallContext 类（ GetData 和 SetData ）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T03:48:17.113

在您链接到的示例代码中，他们正在加密令牌中的用户名。在过滤器中，他们从 http 标头中获取此令牌，将其解密回用户名，并根据 AuthorizedUserRepository 查询它。

```
AuthorizedUserRepository.GetUsers().First(x => x.Name == RSAClass.Decrypt(token)); 
```

您当然可以使用用户 ID 而不是名称，并使用真实的存储库而不是这个示例库。您可以在控制器操作或构造函数中重新执行所有这些操作，也可以将其传递给路由数据或某些 ThreadStatic 属性。如果您想真正花哨，您可以实现基于声明的安全性并在当前线程的主体上设置声明。真的，你如何传递它并不重要。

最终，您只需在查询或 linq 语句的 where 子句中使用此值来过滤到您希望允许用户访问的数据。

# c# - 使用 .Net 4.5 异步功能进行套接字编程

> ID：12630827
> 
> 赞同：42
> 
> 时间：2012-09-27T22:16:07.007
> 
> 标签：c#, sockets, .net-4.5

我以前使用过`BeginAccept()`and `BeginRead()`，但在 Visual Studio 2012 中，我想在我的套接字服务器程序中使用新的异步 ( `async`, ) 功能。`await`

如何完成`AcceptAsync`和`ReceiveAsync`功能？

```
using System.Net;
using System.Net.Sockets;

namespace OfficialServer.Core.Server
{
    public abstract class CoreServer
    {
        private const int ListenLength = 500;
        private const int ReceiveTimeOut = 30000;
        private const int SendTimeOut = 30000;
        private readonly Socket _socket;

        protected CoreServer(int port, string ip = "0.0.0.0")
        {
            _socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            _socket.Bind(new IPEndPoint(IPAddress.Parse(ip), port));
            _socket.Listen(ListenLength);
            _socket.ReceiveTimeout = ReceiveTimeOut;
            _socket.SendTimeout = SendTimeOut;
            _socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.KeepAlive, true);
            _socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.DontLinger, true);
        }

        public void Start()
        {    
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-09-27T23:21:08.453

...因为您如此坚定，所以我整理了一个非常简单的示例，说明如何编写回显服务器以助您上路。收到的任何内容都会回显给客户端。服务器将保持运行 60 秒。尝试在 localhost 端口 6666 上远程登录它。花点时间了解这里到底发生了什么。

```
void Main()
{
    CancellationTokenSource cts = new CancellationTokenSource();
    TcpListener listener = new TcpListener(IPAddress.Any, 6666);
    try
    {
        listener.Start();
        //just fire and forget. We break from the "forgotten" async loops
        //in AcceptClientsAsync using a CancellationToken from `cts`
        AcceptClientsAsync(listener, cts.Token);
        Thread.Sleep(60000); //block here to hold open the server
    }
    finally
    {
        cts.Cancel();
        listener.Stop();
    }
}

async Task AcceptClientsAsync(TcpListener listener, CancellationToken ct)
{
    var clientCounter = 0;
    while (!ct.IsCancellationRequested)
    {
        TcpClient client = await listener.AcceptTcpClientAsync()
                                            .ConfigureAwait(false);
        clientCounter++;
        //once again, just fire and forget, and use the CancellationToken
        //to signal to the "forgotten" async invocation.
        EchoAsync(client, clientCounter, ct);
    }

}
async Task EchoAsync(TcpClient client,
                     int clientIndex,
                     CancellationToken ct)
{
    Console.WriteLine("New client ({0}) connected", clientIndex);
    using (client)
    {
        var buf = new byte[4096];
        var stream = client.GetStream();
        while (!ct.IsCancellationRequested)
        {
            //under some circumstances, it's not possible to detect
            //a client disconnecting if there's no data being sent
            //so it's a good idea to give them a timeout to ensure that 
            //we clean them up.
            var timeoutTask = Task.Delay(TimeSpan.FromSeconds(15));
            var amountReadTask = stream.ReadAsync(buf, 0, buf.Length, ct);
            var completedTask = await Task.WhenAny(timeoutTask, amountReadTask)
                                          .ConfigureAwait(false);
            if (completedTask == timeoutTask)
            {
                var msg = Encoding.ASCII.GetBytes("Client timed out");
                await stream.WriteAsync(msg, 0, msg.Length);
                break;
            }
            //now we know that the amountTask is complete so
            //we can ask for its Result without blocking
            var amountRead = amountReadTask.Result;
            if (amountRead == 0) break; //end of stream.
            await stream.WriteAsync(buf, 0, amountRead, ct)
                        .ConfigureAwait(false);
        }
    }
    Console.WriteLine("Client ({0}) disconnected", clientIndex);
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-27T22:33:31.687

您可以使用将/对`TaskFactory.FromAsync`包装成-ready 操作。`Begin``End``async`

Stephen Toub 在他的博客上有一个[awaitable`Socket`](https://devblogs.microsoft.com/pfxteam/awaiting-socket-operations/)，它包含了更高效的`*Async`端点。我建议将它与[TPL 数据流](http://msdn.microsoft.com/en-us/devlabs/gg585582.aspx)结合起来创建一个完全`async`兼容的`Socket`组件。

# ios - iOS 中委托的后台请求

> ID：12630830
> 
> 赞同：1
> 
> 时间：2012-09-27T22:16:28.303
> 
> 标签：ios

在我的应用程序中，我在后台与代表一起上传图像（到 AWS S3 服务器）。我不想等到它到达委托回调方法。所以 1 秒后，我使用 [popToViewController:myPreviosuScreenController] 返回到上一个屏幕。

问题是当请求完成时它找不到代表。并抛出错误。如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:19:34.997

使请求的委托成为一个在弹出视图控制器时不会被释放的对象。

# regex - 如何在标量变量中搜索模式并在匹配前后添加一些内容？

> ID：12630838
> 
> 赞同：0
> 
> 时间：2012-09-27T22:16:58.070
> 
> 标签：regex, perl

这是我的标量：

```
my $var = "foo1"; 
```

这是我试图做的：

```
$var =~ s/[0-9]/_[0-9]/; 
```

结果：

```
foo_[0-9] 
```

预期结果：

```
foo_1 
```

如果您能回答`foo`在比赛后查找和添加下划线，以及`1`在之前查找和添加下划线，那就太好了。

```
$var = s/foo/something/ 
```

和

```
$var = s/[0-9]/something/ 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T22:18:43.480

捕获您要插入的内容，然后插入您捕获的内容：

```
s/([0-9])/_$1/; 
```

或使用前瞻：

```
s/(?=[0-9])/_/; 
```

根据要求，也匹配的解决方案`foo`：

```
s/(foo)([0-9])/$1_$2/;

s/foo\K([0-9])/_$1/;

s/foo\K(?=[0-9])/_/; 
```

请注意，捕获会减慢匹配速度。

# javascript - 如何传递 javascript 对象而不是手动输入图像名称

> ID：12630839
> 
> 赞同：1
> 
> 时间：2012-09-27T22:17:01.767
> 
> 标签：javascript, jquery

我正在使用[CrossSlide jQuery 插件](http://tobia.github.com/CrossSlide/)，文档显示以下代码：

```
<script>
  $(function() {
    $('#slideshow').crossSlide({
      sleep: 2,
      fade: 1
    }, [
      { src: 'picture1.jpg' },
      { src: 'picture2.jpg' },
      { src: 'picture3.jpg' },
      { src: 'picture4.jpg' }
    ])
  });
</script> 
```

我想要做的是传入一个具有 src 属性的对象数组，而不是手动传入图片。我已经能够创建一个对象，但我不确定是否有办法做到这一点。

Javascript 是否提供任何方法/方式来获取对象并拥有它，可能在运行时，扩展等？

如果您认为我应该研究另一个插件，我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:52:30.297

如果我正确理解了您的问题，其他人说这令人困惑，那么您希望动态创建具有属性`Array`的对象。`src`我假设您将这些图像存储在数据库中，并且想要一种动态获取它们并将它们添加到幻灯片放映的方法。一种方法是这样的：

```
var data = [];

function buildImagesArray(array) {
  // get the images you want from somewhere, like a database perhaps?
  var images = methodToGoGetImages();
  // iterate over the images
  images.forEach(function (img) {
    // create new objects with a src property
    var imageObj = {};
    // add the path of the image as the value of the src property
    imageObj.src = img.url;

    // push this object into the data Array
    array.push(imageObj);
  };

}

buildImagesArray(data);

$(function() {
  $('#slideshow').crossSlide({
    sleep: 2,
    fade: 1
   }, data)
}); 
```

为简洁起见，我留下了一些实现细节，但希望你能明白。

# php - 为什么在使用命名空间时必须包含 PHP 文件？

> ID：12630840
> 
> 赞同：7
> 
> 时间：2012-09-27T22:17:02.580
> 
> 标签：php, class, namespaces

假设我已经声明了一个这样的命名空间：

```
<?php
// File kitchen.php
namespace Kitchen;
?> 
```

为什么我仍然必须将该文件包含在我想使用 kitchen.php 的所有其他文件中
PHP 不知道 kitchen.php 位于 Kitchen 命名空间中吗？

感谢您的回答。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T23:04:52.550

命名空间使为项目中的任何类创建自动加载器变得非常容易，因为您可以直接在调用中包含类的路径。

一个伪代码命名空间示例。

```
<?php 
// Simple auto loader translate \rooms\classname() to ./rooms/classname.php
spl_autoload_register(function($class) {
    $class = str_replace('\\', '/', $class);
    require_once('./' . $class . '.php');
});

// An example class that will load a new room class
class rooms {
    function report()
    {
        echo '<pre>' . print_r($this, true) . '</pre>';
    }

    function add_room($type)
    {
        $class = "\\rooms\\" . $type;
        $this->{$type}  = new $class();
    }
}

$rooms = new rooms();
//Add some rooms/classes
$rooms->add_room('bedroom');
$rooms->add_room('bathroom');
$rooms->add_room('kitchen'); 
```

然后在您的 ./rooms/ 文件夹中，您有 3 个文件： `bedroom.php` `bathroom.php` `kitchen.php`

```
<?php 
namespace rooms;

class kitchen {
    function __construct()
    {
        $this->type = 'Kitchen';
    }
    //Do something
}
?> 
```

然后报告 classes 加载了哪些类

```
<?php
$rooms->report();
/*
rooms Object
(
    [bedroom] => rooms\bedroom Object
        (
            [type] => Bedroom
        )

    [bathroom] => rooms\bathroom Object
        (
            [type] => Bathroom
        )

    [kitchen] => rooms\kitchen Object
        (
            [type] => Kitchen
        )

)
*/
?> 
```

希望能帮助到你

# javascript - 这些列如何在没有 javascript 的情况下更改其配置

> ID：12630841
> 
> 赞同：0
> 
> 时间：2012-09-27T22:17:03.110
> 
> 标签：javascript, jquery, html, css

[当我注意到这个网站](http://jordanyoung.com/)时，我正在四处寻找一种根据屏幕大小来安排不同内容的方法。相当漂亮的网站了。当我更改浏览器的大小时，列配置会更改吗？当我缩小到最小尺寸或在手机上访问它时，顶部的大图像完全消失，只留下小图标。我已经关闭了javascript，这仍然会发生。此外，它适用于我的 ie8，所以我猜它不是 HTML5 的。它是如何完成的？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:18:46.443

这个效果不是由 Javascript 完成的，而是由[CSS @media queries](http://www.w3.org/TR/css3-mediaqueries/)完成的。[CSS Tricks 的 Chris Coyier](http://css-tricks.com/css-media-queries/)对@media 查询进行了很好的介绍

简单地说，它允许您根据一些布尔表达式指定样式表的范围（例如检查窗口宽度是否是您看到的示例中使用的特定宽度），然后应用特定样式，从而使其成为响应式设计

# java - 可通过公共方法访问的私有成员

> ID：12630845
> 
> 赞同：3
> 
> 时间：2012-09-27T22:17:13.117
> 
> 标签：java, oop, inheritance

private 修饰符指定该成员只能在其自己的类中访问。但是我是否能够使用从基类继承的公共方法来访问它。有人可以解释我为什么吗？这是否意味着 Child 类的对象包含一个名为 b 的成员？

这是代码：

```
package a;

public class Base {
    private int b;

    public int getB() {
        return b;
    }

    public void exposeB() {
        System.out.println(getB());
    }

    public Base(int b) {
        this.b = b;

    }
}

package b;

public class Child extends Base {

    Child(int b) {
        super(b);
    }

    public static void main(String args[]) {
        Child b = new Child(2);
        // Prints  2
        System.out.println("Accessing private base variable" + b.getB());
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T22:38:33.507

您没有直接访问超类中的私有变量。您正在实施**封装**的概念。您正在使用**公共 getter 方法（在本例中为 getB()）**使您的私有数据被其他类访问。因此，您可以通过公共 getter 访问私有变量 b，但您永远不能直接从另一个/子类访问**b**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T22:25:59.910

在 class`Base`中，该字段`b`是私有的，但`getB()`也是公共的，因此*任何人*都可以调用该方法。

您*可以*预期编译失败的情况如下：

```
System.out.println( "Accessing private base variable" + b.b ); 
```

（除非该行是从其`Base`自身的方法中调用的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T22:26:39.937

您将无法`b` *直接*访问，`Child`因为它是`private`. 但是，您可以使用基类的`getB`方法`public`（因此可以在任何地方调用）。

要*仅*允许扩展包中的类和其他类访问该字段，您可以将其声明为`protected`.

* * *

```
class A {
    private int n;
    public A(int n) { this.n = n; }
    public int n() { return n; }
}

class B extends A {
    public B(int n) { super(n); }
    public void print() { System.out.println(n); }  // oops! n is private
} 
```

* * *

```
class A {
    protected int n;
    public A(int n) { this.n = n; }
    public int n() { return n; }
}

class B extends A {
    public B(int n) { super(n); }
    public void print() { System.out.println(n); }  // ok
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:21:16.260

private 修饰符意味着您不能在类之外引用该字段。但是，因为 getB() 是公共的，所以您可以引用该方法。getB() 方法可以引用私有 b 字段，因为它在类内部，因此可以访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T22:26:27.587

私有变量意味着您不能直接从其类中访问该变量....声明该变量私有意味着您不能这样做

Myclass.myprivate 变量 = 3

这将引发编译错误，抱怨 myprivatevariable 在外部不可见

但是，正如您所做的那样……将内部方法声明为 getter 或 setter、public，您就允许用户仅通过该方法间接访问该变量……这始终是首选方法。

# java - 是否可以让 Eclipse 在运行时跳转到控制台，尤其是在有输入时？另外，我可以隐藏工具栏吗？

> ID：12630849
> 
> 赞同：1
> 
> 时间：2012-09-27T22:17:55.263
> 
> 标签：java, eclipse

在我的旧 IDE 中，如果我运行一个 Java 文件并且控制台请求输入，它会将我的文本光标跳转到它，这样我就可以在不移动鼠标的情况下进行输入。Eclipse 似乎没有这样做。我能做到吗？

另外，如何隐藏工具栏？我更喜欢键盘快捷键，所以它只会让我的视野变得混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T00:58:49.520

要隐藏工具栏，您可以访问此处：[http](http://code.google.com/p/eclipse-hide-toolbar/) ://code.google.com/p/eclipse-hide-toolbar/ 获取每次启动 Eclipse 时隐藏工具栏的插件。

我认为没有办法让您的光标像您描述的那样跳转到输入，但是当您考虑到普通用户每天点击和移动鼠标数千次时，这是一个小问题，更不用说活跃的程序员了。

但我可能错了。

# ruby-on-rails - 作为可标记在数据库中创建重复的行

> ID：12630861
> 
> 赞同：2
> 
> 时间：2012-09-27T22:19:12.690
> 
> 标签：ruby-on-rails, ruby, acts-as-taggable-on

我在 Rails 应用程序中使用acts-as-taggable-on，每次创建新照片（例如）时，我都会在“标记”表中得到重复的行。

我的模型类看起来像：

```
class User < ActiveRecord::Base
  acts_as_tagger
  ...
end 
```

和

```
class Photo < ActiveRecord::Base
   acts_as_taggable_on :tags
   ...
end 
```

并在我的 photos_controller 的创建操作中

```
def create
  @user = current_user
  ... 
  @user.tag(@photo, :with => params[:photo][:tag_list], :on => :tags)
  ...
end 
```

奇怪的是，我在 'taggings' 表中得到重复的行，其中第一行的 'tagger_id' 和 'tagger_type' 设置为 NULL，而重复的行具有正确的值。

我的 Gemfile 看起来像这样

```
gem 'rails', '3.2.8'
gem 'acts-as-taggable-on', '~> 2.3.1' 
```

有没有人见过这种行为？这是我的配置问题吗？

更新：查看控制台，我可以清楚地看到正在执行的两个事务，第一个事务是这样的：

```
SQL (0.6ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", 
"taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ?, ?, ?)
[["context", "tags"], ["created_at", Thu, 27 Sep 2012 21:49:22 UTC +00:00], ["tag_id",
 12], ["taggable_id", 10], ["taggable_type", "Photo"], 
["tagger_id", nil], ["tagger_type", nil]] 
```

很明显，tagger_id 和tagger_type 都设置为null。

这是一个完整的控制台输出，我已将各行分开以帮助阅读它。您会注意到两个单独的事务，在第一个事务中插入了 NULL 值，而在第二个事务结束时，您将看到正确的事务。

在 2012-09-28 07:39:58 +0200 开始 POST "/photo" for 127.0.0.1 由 PhotoController#create 作为 HTML 参数处理：{"utf8"=>"✓", "authenticity_token"=>"IOmnfDpU7V7vYw3h6RXXzXPsXf/ B0fcVihXhb+S8JHU=", "photo"=>{"url"=>"www.another.com/photo.jpg", "title"=>"Another", "tag_list"=>"a_tag", "description" =>"", "private"=>"0"}, "commit"=>"添加照片"} 重定向到[http://www.somedomain.com:3000/users/christiangiacomi](http://www.somedomain.com:3000/users/christiangiacomi)

完成 302 Found in 414ms (ActiveRecord: 20.5ms)

用户负载 (0.3ms) SELECT "users".* FROM "users" WHERE "users"."username" = 'christiangiacomi' LIMIT 1 ActsAsTaggableOn::Tag Load (0.2ms) SELECT "tags".* FROM "tags" INNER在“tags”中加入“taggings”。“id”=“taggings”。“tag_id”其中“taggings”。“taggable_id”为空且“taggings”。“taggable_type”='照片'和（taggings.context = 'tags ' AND taggings.tagger_id 为 NULL)

(0.1ms) 开始交易

SQL (6.2ms) INSERT INTO "photos" ("created_at", "description", "favorite", "private", "title", "updated_at", "url", "user_id") VALUES (?, ?, ? , ?, ?, ?, ?, ?) [["created_at", Fri, 28 Sep 2012 05:39:59 UTC +00:00], ["description", ""], ["favorite", false] , ["private", false], ["title", "Another"], ["updated_at", Fri, 28 Sep 2012 05:39:59 UTC +00:00], ["url", "http:// /www.another.com/photo.jpg"], ["user_id", 1]]

ActsAsTaggableOn::Tag Load (3.2ms) SELECT "tags".* FROM "tags" WHERE (lower(name) = 'a_tag') ActsAsTaggableOn::Tag Exists (0.1ms) SELECT 1 AS one FROM "tags" WHERE "tags "."name" = 'a_tag' 限制 1

SQL (0.2ms) INSERT INTO "tags" ("name") VALUES (?) [["name", "a_tag"]]

ActsAsTaggableOn::Tag Load (0.1ms) SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 13 AND "taggings"."taggable_type" = 'Photo' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)

ActsAsTaggableOn::Tagging Exists (0.2ms) SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 16 AND "taggings"."taggable_type" = 'Photo' AND "taggings"."taggable_id" = 13 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL）限制 1

SQL (0.7ms) INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ? , ?, ?) [["context", "tags"], ["created_at", Fri, 28 Sep 2012 05:39:59 UTC +00:00], ["tag_id", 16], ["taggable_id" , 13], ["taggable_type", "Photo"], ["tagger_id", nil], ["tagger_type", nil]]

(4.1ms) 提交事务

(0.1ms) 开始交易

ActsAsTaggableOn::Tag Load (0.2ms) SELECT "tags".* FROM "tags" WHERE (lower(name) = 'a_tag')

ActsAsTaggableOn::Tag Load (0.2ms) SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 13 AND "taggings"."taggable_type" = 'Photo' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)

CACHE (0.0ms) SELECT "tags".* FROM "tags" WHERE (lower(name) = 'a_tag')

ActsAsTaggableOn::Tag Load (0.2ms) SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 13 AND "taggings"."taggable_type" = 'Photo' AND (taggings.context = 'tags' AND taggings.tagger_id = 1 AND taggings.tagger_type = 'User')

ActsAsTaggableOn::Tagging Exists (0.4ms) SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 16 AND "taggings"."taggable_type" = 'Photo' AND "taggings"."taggable_id" = 13 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" = 1 AND "taggings"."tagger_type" = 'User') 限制 1

SQL (0.5ms) INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ? , ?, ?) [["context", "tags"], ["created_at", Fri, 28 Sep 2012 05:39:59 UTC +00:00], ["tag_id", 16], ["taggable_id" , 13], ["taggable_type", "Photo"], ["tagger_id", 1], ["tagger_type", "User"]]

(2.4ms) 提交事务

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:25:38.063

好的，这真的很奇怪，但我已经想出了如何避免这个问题。

我做的第一件事是创建一个尖峰解决方案来测试acts_as_taggable_on，这似乎有效。它由两个模型类组成，仅此而已……当我通过 rails 控制台对其进行测试时，它就起作用了。

所以我添加了一个表格，就像我在我的 rails 应用程序中一样，并再次对其进行了测试......

我有一个类似这样的表格：

```
 <div>
      <%= form_for @photo, :html => { :class => "dialog" } do |f| %>

      ...

      <%= f.label :title%>
      <%= f.text_field :title, :class => "wide" %>

      <%= f.label 'Tags' %>
      <%= f.text_field :tag_list, :value => @tags %>

      ...

      <%= f.submit button_text(@photo), :class => "btn btn-large btn-primary" %>
      <%= f.submit "Cancel", :class => "btn btn-large"  %>
   </div> 
```

当我实现它并对其进行测试时，我得到了一个“无法批量分配：tag_list”

我阅读了 Rails 3.2.3 中关于批量分配的更改，并决定不损害安全性。

所以我添加到我的照片模型类

```
 attr_accessible :tag_list 
```

这解决了错误但是当我测试它时我发现现在出现的重复行！所以现在这个错误是可重现的！

我通过更改表单来解决它，这样我就不会将表单绑定到 Photo 模型对象。

像这样：

```
<div>
   <%= form_tag({:controller => "photos", :action => "create"}, :method => "post", :class => "dialog") do %>

   ...

   <%= label_tag :title, 'Title'%>
   <%= text_field_tag :title, nil, :class => "wide" %>

   <%= label_tag :tag_list, 'Tags'%>
   <%= text_field_tag :tag_list, nil, :class => "wide" %>

   ...

   <%= submit_tag('Add', :class => "btn btn-large btn-primary") %>
   <%= submit_tag("Cancel", :class => "btn btn-large")  %>
</div> 
```

我还删除了 attr_accessible :tag_list 并修改了控制器以接受表单中的不同值。

```
@photo = current_user.photos.build(:title => params[:title],
                                   ...
                                   )
@user.tag(@photo, :with => params[:tag_list], :on => :tags) 
```

这解决了问题！

我现在将尝试调查究竟为什么会发生这种情况！:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-29T10:17:54.383

我知道这个问题已经有五年的历史了，但这仍然发生在 Rails 5.1 中`acts-as-taggable 4.0`，我只是想向遇到这个问题的人展示它是如何解决的。

这是一个非常简单的修复，在控制器中的强大参数中，您只需添加`tag_list: []`而不是`:tag_list`像这样：

```
def photo_params
  params.require(:photo).permit(:title, tag_list: [])
end 
```

`Taggings`这会阻止在数据库中创建重复和空白，您可以使用 a`form_for`而不是 a`form_tag`

```
<%= form_for @photo do |f| %>
  <%= f.text_field :title %>
  <%= f.text_field :tag_list %>
  <%= f.submit %>
<% end %> 
```

# java - Jtable/JScrollPanel 不会刷新（更新数据）

> ID：12630862
> 
> 赞同：3
> 
> 时间：2012-09-27T22:19:14.900
> 
> 标签：java, swing, jtable, jscrollpane, tablemodel

我已经设置了一个`JTable`分页 - 效果很好，但是我在将数据更新到表时遇到了问题。table.repaint() 不起作用。这是我正在使用的代码。提前致谢！

```
String[][] data = new String[100][4];

 String[] columnNames = new String[]{
         "IP", "PC_NAME", "ttl", "db"}; 
```

构造函数：

```
gui(){
    JTable table =  new JTable(data, columnNames);
    JScrollPane scrollPane = new JScrollPane(table);
    JButton next = new JButton("next");
    JButton prev = new JButton("prev");
    next.addActionListener(this);
    prev.addActionListener(this);
    JPanel panel = new JPanel(new BorderLayout());
    JPanel buttonPanel = new JPanel();
    buttonPanel.add(prev);
    buttonPanel.add(next);
    panel.add(buttonPanel, BorderLayout.SOUTH);
    panel.add(table.getTableHeader(), BorderLayout.PAGE_START);
    panel.add(scrollPane, BorderLayout.CENTER);
    getContentPane().add(panel);} 
```

动作监听器：

```
public void actionPerformed(ActionEvent e) {
 if (e.getActionCommand() == "next") {
     Rectangle rect = scrollPane.getVisibleRect();
     JScrollBar  bar = scrollPane.getVerticalScrollBar();
     int blockIncr = scrollPane.getViewport().getViewRect().height;
     bar.setValue(bar.getValue() + blockIncr);
     scrollPane.scrollRectToVisible(rect);
 }
 if (e.getActionCommand() == "prev") {
     Rectangle rect = scrollPane.getVisibleRect();
     JScrollBar  bar = scrollPane.getVerticalScrollBar();
     int blockIncr = scrollPane.getViewport().getViewRect().height;
     bar.setValue(bar.getValue() - blockIncr);
     scrollPane.scrollRectToVisible(rect);
 }} 
```

这是将数据存储到数组中的函数：

```
int i=0;
public void WriteMonitorData (String IP, String PC_NAME, String ttl, String gw)
{
    data[i][0]=IP;
    data[i][1]=PC_NAME;
    data[i][2]=ttl;
    data[i][3]=gw;
    i++;
    table.repaint();
    scrollPane.repaint();

} 
```

**编辑1：**

我尝试使用 DefaultTableModel 仍然没有运气。这是我用于更新表的代码。构造函数代码没有改变。宣言：

```
private static final long serialVersionUID = 1L;
 String[][] data = new String[100][4];

 String[] columnNames = new String[]{
         "IP", "PC_NAME", "ttl", "db"};

            DefaultTableModel model = new DefaultTableModel(data,columnNames);
    JTable table =  new JTable(model);
    JScrollPane scrollPane = new JScrollPane(table); 
```

这是更新表的函数：

```
 public void WriteMonitorData (String IP, String PC_NAME, String ttl, String gw)
{

    System.out.println(IP);
    model.setValueAt(IP, i, 0);
    model.setValueAt(PC_NAME, i, 1);
    model.setValueAt(ttl, i, 2);
    model.setValueAt(gw, i, 3);
    i++;
    model.fireTableDataChanged();
    table.repaint();
    scrollPane.repaint();

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:25:37.850

您的问题是您将字符串与`==`. 请改用该`equals(...)`方法。

*   `==`比较两个变量是否引用同一个对象——你不关心的东西。因此，两个 String 变量可以包含相同的单词，但此操作不认为它们相等。
*   `equals(...)`or方法检查两个 String 变量是否以`equalsIgnoreCase(...)`相同的顺序保存相同的字符，并且您**确实**关心。

所以不是：

```
if (e.getActionCommand() == "next") {
  //  ...
} 
```

反而：

```
if ("next".equals(e.getActionCommand())) {
  //  ...
} 
```

或者如果您不关心大小写：

```
if ("next".equalsIgnoreCase(e.getActionCommand())) {
  //  ...
} 
```

**编辑 1**
接下来，一旦您的 JTable 保存了数据，更改数据可能对 JTable 没有影响。所以在这里你改变数据数组：

```
int i=0;
public void WriteMonitorData (String IP, String PC_NAME, String ttl, String gw)
{
    data[i][0]=IP;
    data[i][1]=PC_NAME;
    data[i][2]=ttl;
    data[i][3]=gw;
    i++;
    table.repaint();
    scrollPane.repaint();

} 
```

但是这个数组已经被传递到 JTable 中，现在是它的模型的一部分，并且很可能已经变成了一个 Vector。

要查看 JTable 数据表示的变化，您必须更改表的***model***保存的数据。我建议您使用 DefaultTableModel 将数据保存在 JTable 中，然后在上面的方法（应以小写字母开头）中更改模型保存的数据。

此外，无论您的`if`块是否有效，都不要`==`用来比较字符串，因为如果不是现在，很快就会咬到您。

# jdbc - ClassNotFoundException：“sun.jdbc.odbc.JdbcOdbcDriver”

> ID：12630866
> 
> 赞同：0
> 
> 时间：2012-09-27T22:19:33.547
> 
> 标签：jdbc

我花了几个小时试图找到这个。很多人都报告了这个错误，但最终找到了解决方案。但是，这些解决方案都不适合我。

我正在使用 Eclipse 开发 Java 应用程序。这是一个代码片段：

```
import java.sql.*

Class.forName("sun.jdbc.odbc.JdbcOdbcDriver"); 
```

Eclipse 立即发现错误：`Unhandled exception type: ClassNotFoundException`.

项目属性指示构建路径包括 JRE 系统库 (jre7)。

在 Eclipse 中，我可以看到 JRE7 包含 sun.jdbc.odbc.JdbcOdbcDriver.class

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T11:27:03.573

[Class.forName()](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#forName%28java.lang.String%29)声明它抛出 ClassNotFoundException。这是一个检查异常。所以你必须抓住它，或者声明你的方法也抛出它。

[通过阅读Java 教程](http://docs.oracle.com/javase/tutorial/essential/exceptions/)了解异常处理。这是每个 Java 开发人员都必须知道的基本知识。

一旦你掌握了异常，请学习 JDBC。多年来，不应再使用 JDBC-ODBC 驱动程序。现在每个数据库都有一个本地 JDBC 驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T16:38:35.713

“现在每个数据库都有一个本地 JDBC 驱动程序。”

我希望这是真的——但是有些小众数据库系统却没有。特别是在我的工作中，我们被一个数据库系统困住了，它是我们运行业务所需的更大软件的一部分，并且无法轻易替换。它没有 JDBC 驱动程序，数据库系统的开发人员明确表示创建一个不是他们的目标。

您可能有充分的理由不喜欢 JDBC-ODBC 驱动程序，但在某些情况下它是唯一的选择。

# objective-c - 为什么我需要一个类扩展来将方法设为私有？

> ID：12630867
> 
> 赞同：1
> 
> 时间：2012-09-27T22:19:33.983
> 
> 标签：objective-c, ios

我一直在阅读有关此内容的一些信息，但我不明白为什么人们添加类扩展以使方法私有。

将它从头文件中删除就足够了吗？在我看来已经足够了，但我可能遗漏了更重要的一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:39:08.177

简短的回答：现在（我认为从 Xcode 4.4 开始），你没有。原因：您不需要转发声明方法。把你的私有方法放在你的 .m 文件中，你就完成了。

以前（Xcode 4.3 和更早版本），您必须先转发声明您的方法，然后才能调用它们。因为你已经在 .h 文件中声明了这个类，你不能在 .m 文件中再次声明它，所以类扩展是向已经声明的类添加方法的方法。

**编辑：**正如上面（和下面）提到的@Yar，.m 文件中未声明的私有方法对该类的子类不可见，这意味着该子类不可能调用或覆盖该方法。尽管如此，我还是倾向于不去声明它，除非/直到你最终得到一个需要覆盖或调用它的子类。对我来说，这种情况很少发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:36:09.490

将它从头文件中删除就足够了，但是您的子类也不知道它在那里。这意味着如果您尝试调用这些私有方法，则会出现编译器错误。这就是为什么您使用作为类扩展名的外部文件，并且所有子类都**在 .m 文件中导入该扩展名的原因。**

显然，这种情况并不理想，因为每个类至少需要三个文件，但 Objective-C 的乐趣在于制作大量文件，而不用担心它。如果你害怕制作文件，你最终会得到大类，[这是一种反模式](http://en.wikipedia.org/wiki/God_object)。

一个问题是命名类扩展文件，因为它是一个没有，嗯，类别的类别。我一直在使用像 Blah4Subclasses 这样的方案，这可能是你得到的最糟糕的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:57:55.613

类延续与访问无关，翻译。objc 语言没有指定方法的访问权限。所以它是一个相对较弱的私人。人们最终依赖的是在他们的实现文件中隐藏方法声明的能力。

要带走的重要一点是，类延续通常只对您的类可见（因为它通常放在`*.m`文件中）。这种模式*降低*`@implementation`了使用私有方法的可能性，因为它对客户端或编译器不可见（在典型结构中包含类的翻译除外）。

还要注意，类延续有很多能力——所以它是一个方便的地方来存储你的私人`@interface`；属性，ivars，方法。

最后，这也是早期的一种习惯，因为它是一种更频繁的必需品。不久前，添加了声明，因此编译器知道对象响应了特定的选择器，以及该选择器的签名。因为如今 clang 解析了整个 @implementation 块，许多人发现他们不需要类延续中的声明，因为编译器可以匹配 @implementation 中看到的方法，而不管声明的顺序如何。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:29:53.360

您可以在 .h 文件中添加 @private。

# iphone - Restkit 内存不足警告

> ID：12630871
> 
> 赞同：0
> 
> 时间：2012-09-27T22:19:50.753
> 
> 标签：iphone, objective-c, ios, core-data, restkit

自从最近几个月以来，我一直在使用 restkit 进行一个项目，我真的很喜欢它处理复杂操作（如获取 json 和保存到本地持久存储）所具有的魔力。尽管它对我很有帮助，但我一直在经历偶尔的崩溃，原因是内存不足警告。除了它正在做的所有复杂操作之外，我觉得它使用了巨大的内存。即使我禁用缓存策略和 inmemorycache 使用，它也会消耗大量内存。有没有人遇到过与restkit类似的问题。我相信你们中的一些人在为 iPhone 使用大型库时遇到过这个问题。有没有办法删除或最小化映射和其他东西的内存使用。

任何形式的解决方案将不胜感激。我急切地等待任何有用的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:25:31.450

您是否在处理非常大的对象，例如 NSData 或类似的东西？必要时使用 ARC 和 @autorelease？

也许您隐含地保留了许多指针引用，而内存不足以处理。如果您发布一段代码，我们可以为您提供更多帮助。

# javascript - 获取 X/Y 坐标以在具有软边缘的三角形上移动的函数

> ID：12630873
> 
> 赞同：5
> 
> 时间：2012-09-27T20:52:05.247
> 
> 标签：javascript, graphics, geometry

我想在 javascript 中制作一个对象在路径上移动的动画。为此，我需要一个函数来返回给定时间路径上的 X/Y 坐标。路径应该是一个带有软边的三角形。

在动画开始时，它应该软移动到三角形路径中 - 但我可以在不同的函数中解决这个问题.. 对我来说更重要的是可以返回三角形移动的 X/Y 坐标的函数。

然后动画应该在三角形路径上无限循环。

![动画路径](../Images/a06374fe4fb0ab7c8110ea37ecd2eb02.png)

是否有（在线）工具可以为此类动画创建坐标？

有人可以帮我完成这个功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:19:25.807

我推荐类似[sqrt(x²+y²)=2.5+sin(atan2(y,x)*3)/5](http://www.wolframalpha.com/input/?i=plot+sqrt%28x%5E2%2By%5E2%29%3D2.5%2Bsin%28atan2%28y%2Cx%29%2a3%29%2F5) - polar: [ρ(θ)=2.5+sin(3θ)/5 之类](http://www.wolframalpha.com/input/?i=polar+plot+%CF%81%28%CE%B8%29+%3D+2.5+%2B+0.2+%2a+sin+%28%CE%B8+%2a+3%29)的东西。这是一个简单的极坐标系，并在一个圆上添加一个压缩正弦波（每圈 3 个周期）：

```
θ(t) = t // angle
ρ(t) = 2.5 + 0.2 * sin (t * 3) // radius
// of course, you can play with the parameters :-) 
```

您可以轻松地[将这些极坐标转换为笛卡尔坐标](http://en.wikipedia.org/wiki/Polar_coordinate_system#Converting_between_polar_and_Cartesian_coordinates)。

一开始的动画，从中心移动到路径，当然需要一个额外的功能。然而，它可以用相同的机制来完成——省略圆圈部分：[ρ(θ)=2.5*sin(3θ)](http://www.wolframalpha.com/input/?i=polar+plot+%CF%81%28%CE%B8%29+%3D+2.5++%2a+sin+%28%CE%B8+%2a+3%29+for+%CE%B8+from+0+to+pi%2F6)

# java - 如何使用 Java 对 URL 进行编码

> ID：12630874
> 
> 赞同：0
> 
> 时间：2012-09-27T22:19:59.740
> 
> 标签：java

给定一个像这样的 URL，

[http://www.example.com/](http://www.example.com/some)一些目录/一些文件

你如何编码这个 URL？浏览器会自动对其进行编码。在 Java 中，我找不到现成的函数。我怀疑应该有这样的功能，因为这通常是需要的。

当我尝试使用带有单个字符串的构造函数来使用 URI 类并解析 URL 的组件（例如权限、路径等）时，它会给出错误，因为它需要一个编码的 URL。

你知道一个现成的函数会产生吗，例如在这种情况下：

[http://www.example.com/some%20directory/some%20file](http://www.example.com/some%20directory/some%20file)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T22:46:06.570

尝试这个：

```
final URL url = new URL("http://www.example.com/some directory/some file");
final URI uri = new URI(url.getProtocol(), url.getHost(), url.getPath(), null);

System.out.println(uri.toASCIIString()); 
```

# vba - Word vba document.readonly 状态错误地返回 false

> ID：12630878
> 
> 赞同：1
> 
> 时间：2012-09-27T22:20:09.597
> 
> 标签：vba, excel, ms-word

我有一个 excel 项目，它检查 word 文档是否有更改的修改日期，如果更改，它会打开该文档并将文本从 word 表单字段导入到 excel 中。

excel中打开并导入word文档的例程如下：

```
Sub CopyFromWord(pFile as String,aFile as string)

Dim wdApp As Object

On Error Resume Next
Set wdApp = GetObject(, "Word.Application")
If Err.Number <> 0 Then
    Set wdApp = CreateObject("Word.Application")
Else 'word is already running
End If
On Error Goto 0

Set wdDoc = wdApp.Documents.Open(Filename:="" & pFile & "", ReadOnly:=True)
wdApp.Visible = False
   For Each c In wdDoc.bookmarks
    'removed code that copies values from word doc fields to excel sheet
   Next c
wdApp.Activedocument.Close SaveChanges:=False

End Sub 
```

Word 文档最初都是同一个文件的副本。该文件有几千个副本，但每个副本都位于自己的文件夹中，并具有唯一的名称。

用户找到他们需要的文件夹并在其中打开 word 文档。它打开一个用户表单，然后使用用户表单的输入填充文档中的表单域。然后命令按钮保存并退出表单。

因为欢迎消息/用户表单会在文档打开时自动加载，所以我将以下代码添加到文档的打开事件中：

```
Sub Document_Open()

If ThisDocument.ReadOnly = True then Exit Sub

msgbox "Welcome " & Environ$("Username") & ". Click OK to begin."
Userform1.show

End sub 
```

这确保了当 excel 项目循环遍历所有文件时，如果它发现一个文件已更改，它需要打开文件（只读），以便它可以导入数据而不会被用户表单/欢迎消息中断，关闭它并携带在搜索循环所有文件检查更改的修改日期。

它应该持续运行，但是，大约 20% 的时间，一个文档将仅通过 excel 代码打开，但会显示 word 文档中的欢迎消息框，表明 thisdocument.readonly 错误地返回了 false。如果我在这种情况下调试 word 文档，然后执行

```
? thisdocument.readonly 
```

我得到一个“错误”的结果。但是，即使是 word 文档的标题栏也以“（只读）”结尾，所以它显然已经以只读方式打开，因此 readonly 应该返回 True。

它不是特定于任何文档，如果我尝试重复打开它们，它似乎在下一轮工作（因为它正确注册了一个只读并在消息框代码之前退出子）。我找不到任何类型的图案，也无法在网上找到任何信息，我已经搜索了好几个星期了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T23:30:42.630

可能不被认为是答案，但按照蒂姆威廉的建议，我设法把它放在一起，完全解决了我的问题。起初我很挣扎，因为我试图过早设置属性。完整代码如下：

```
 Sub CopyFromWord(pFile as String)

 Dim wdApp As Object

 On Error Resume Next
 Set wdApp = GetObject(, "Word.Application")
 If Err.Number <> 0 Then
 Set wdApp = CreateObject("Word.Application")
 Else 'word is already running
 End If
 On Error Goto 0

'save current setting
secAutomation = wrdApp.Application.AutomationSecurity

'set Word to disable macros when a document is opened via vb:
wrdApp.Application.AutomationSecurity = msoAutomationSecurityForceDisable
'(without using wrdApp prefix it would only apply to the code's App i.e. Excel)

Set wdDoc = wdApp.Documents.Open(Filename:="" & pFile & "", ReadOnly:=True)
wdApp.Visible = False
For Each c In wdDoc.bookmarks
'removed code that copies values from word doc fields to excel sheet
Next c

'restore original setting before closing
wrdApp.Application.AutomationSecurity = secAutomation

wdApp.Activedocument.Close SaveChanges:=False

End Sub 
```

非常感谢 Tim Williams 的链接，以及在该链接内容中提供代码的人。这是一个很大的帮助，非常感谢。

# actionscript-3 - AS3，Flash - 跟踪页面？

> ID：12630883
> 
> 赞同：0
> 
> 时间：2012-09-27T22:20:47.077
> 
> 标签：actionscript-3, flash

是否有可能以某种方式检查查看此 Flash 的页面？

想看看我的 Flash 游戏是从 Facebook、Kongregate 还是在我自己的网站上玩的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:55:00.487

尝试通过`ExternalInterface`类调用 Javascript：

```
var url:String = ExternalInterface.call('window.location.href.toString'); 
```

# java - url 模式语法（java servlet）

> ID：12630884
> 
> 赞同：1
> 
> 时间：2012-09-27T22:21:07.690
> 
> 标签：java, servlets, url-pattern

我想做这样的事情：

> localhost:7001/servlet/character?name=zombies

我试过这样做：

```
<servlet-mapping>
    <servlet-name>zombies</servlet-name>
    <url-pattern>/character?name=zombies</url-pattern>
</servlet-mapping> 
```

但它不起作用并且给我未找到的错误。关于如何做的任何建议或解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:24:48.757

您的`?name=zombies`url-pattern 部分不应在`web.xml`. 它是一个查询参数，实际上并不是 servlet 安装点的一部分。您需要`name`通过`request.getParameter("name")`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T05:55:02.853

如果您想将参数传递给您的 servlet，请这样做

```
<servlet>
    <servlet-name>zombies</servlet-name>
    <servlet-class>com.ZombiesDemo</servlet-class>

    <init-param>
        <param-name>name</param-name>
        <param-value>zombies</param-value>
    </init-param>
</servlet>

<servlet-mapping>
    <servlet-name>zombies</servlet-name>
    <url-pattern>/character</url-pattern>
</servlet-mapping> 
```

这可以在 ZombiesDemo.java servlet 中检索为

```
public void init(ServletConfig servletConfig) throws ServletException{
  String name = servletConfig.getInitParameter("name");
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:33:39.080

您正在尝试将**查询字符串**附加到后面的内容**？**与您的**URL 模式**。URL 模式旨在映射您的 servlet 类。如果您可以在地址栏中传递查询字符串。

# c - 哈希表在服务器仍在运行时立即变为空

> ID：12630885
> 
> 赞同：0
> 
> 时间：2012-09-27T22:21:11.667
> 
> 标签：c, hashtable

我有一个小的 TCP 连接，我试图发送一个从哈希表中提取的 char 数组。我可以成功地将一个字符串添加到哈希表中，键是客户端的 IP 地址，但是当我尝试获取键的值时，它将整个表注册为 NULL。

这是文件：

```
void HandleTCPClient(int clntSocket, char *client_ip, HASHTBL *hashtable)
{
    ...
    ...
    if (strcmp(cmd, "addfile") == 0)
    {
        char arr[1000];
        add = hashtbl_get(hashtable, (char *)client_ip);

        if (add != NULL)
        {
            memcpy(fls, add, strlen(add));
            hashtbl_insert(hashtable, client_ip, fls);
        }
        else
        {
            hashtbl_insert(hashtable, client_ip, fls);
            printf("insert done\n");
        }
        printf("%s\n", hashtbl_get(hashtable, (char *)client_ip));
    }

    else if (strcmp(cmd, "listfiles") == 0)
    {
        char list[1000];
        char *test;

        printf("before getting from hashtable");

        test = hashtbl_get(hashtable, (char *)client_ip);

        printf("%s\n", test);
    } 
```

我调用来获取值的函数`hashtbl_get`具有标题：

```
void *hashtbl_get(HASHTBL *hashtbl, const char *key); 
```

所以我`(char *)`在传递它时将client_ip转换为a。

`fls`是一个小字符数组

功能在`hashtbl_get`这里：

```
void *hashtbl_get(HASHTBL *hashtbl, const char *key)
{
struct hashnode_s *node;
hash_size hash=hashtbl->hashfunc(key)%hashtbl->size;

node=hashtbl->nodes[hash];
while(node) {
    if(!strcmp(node->key, key)) return node->data;
    node=node->next;
}

return NULL;
} 
```

问题是，当我运行我的服务器并调用`addfile`它添加到哈希表的命令时，但是当我调用`listfiles`它时，它的行为就好像哈希表现在是空的。知道是什么原因造成的吗？

# javascript - 抓取 javascript 生成的网页数据

> ID：12630891
> 
> 赞同：6
> 
> 时间：2012-09-27T22:21:52.123
> 
> 标签：javascript, php, html-parsing, domdocument

我的问题是：如何从这个网站[http://vtis.vn/index.aspx](http://vtis.vn/index.aspx)抓取数据但是直到你点击例如“Danh sách chậm”时才会显示数据。我已经非常努力和仔细地尝试过，当您单击“Danh sách chậm”时，这是触发一些 javascript 函数的 onclick 事件，其中一个 js 函数是从服务器获取数据并将其插入标签/占位符并在此时您可以使用 Firefox 之类的工具来检查数据，是的，数据会在网页上显示给用户/查看者。再说一遍，我们如何以编程方式废弃这些数据？

我写了一个报废功能，但它当然没有得到我想要的数据，因为在我点击按钮“Danh sách chậm”之前数据不可用

```
<?php
$Page = file_get_contents('http://vtis.vn/index.aspx');
$dom_document = new DOMDocument();
$dom_document->loadHTML($Page);
$dom_xpath_admin = new DOMXpath($dom_document_admin);
$elements = $dom_xpath->query("*//td[@class='IconMenuColumn']");
foreach ($elements as $element) {
    $nodes = $element->childNodes;
    foreach ($nodes as $node) {
        echo mb_convert_encoding($node->c14n(), 'iso-8859-1', mb_detect_encoding($content, 'UTF-8', true));
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T16:58:11.147

您需要查看[PhantomJS](http://phantomjs.org/)。

从他们的网站：

> PhantomJS 是一个带有 JavaScript API 的无头 WebKit。它具有对各种 Web 标准的快速和原生支持：DOM 处理、CSS 选择器、JSON、Canvas 和 SVG。

使用 API，您可以编写“浏览器”脚本以与该页面交互并抓取您需要的数据。然后你可以用它做任何你需要的事情；如有必要，包括将其传递给 PHP 脚本。

* * *

话虽如此，如果可能的话，尽量不要“抓取”数据。如果页面正在进行 ajax 调用，也许您可​​以使用 API？如果没有，也许你可以说服他们做一个。这当然比屏幕抓取更容易且更易于维护。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-02T06:20:14.040

首先，您需要[PhantomJS](https://github.com/ariya/phantomjs)。Linux 上建议的安装方法：

```
wget https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2
tar xvf phantomjs-2.1.1-linux-x86_64.tar.bz2
cp phantomjs-2.1.1-linux-x86_64/bin/phantomjs /usr/local/bin 
```

其次，您需要[php-phantomjs 包](https://github.com/jonnnnyw/php-phantomjs)。假设您已经安装了[Composer](https://get-composer.org)：

```
composer require jonnyw/php-phantomjs 
```

或按照[此处的安装文档](http://jonnnnyw.github.io/php-phantomjs/4.0/2-installation/)进行操作。

第三，将包加载到您的脚本中，而不是`file_get_contents`，您将通过 PhantomJS 加载页面

```
<?php
require ('vendor/autoload.php');

$client = Client::getInstance();
$client->getEngine()->setPath('/usr/local/bin/phantomjs');
$client = Client::getInstance();
$request  = $client->getMessageFactory()->createRequest();
$response = $client->getMessageFactory()->createResponse();

$request->setMethod('GET');
$request->setUrl('https://www.your_page_embeded_ajax_request');

$client->send($request, $response);

if($response->getStatus() === 200) {
    echo "Do something here";
} 
```

# java - 将元素插入数组索引超出范围java

> ID：12630892
> 
> 赞同：2
> 
> 时间：2012-09-27T22:21:55.147
> 
> 标签：java, arrays, exception, insert

我制作了一个名为 NumList 的 ADT，并在 NumArrayList 类中实现了它

在实现的方法中，有一个 insert(int i, double value)，其中 value 被插入到 array[i] 中。

int numItems 是跟踪我的数组元素的计数器。

```
public void insert(int i, double value)
{
    if (numItems >= items.length)
    {
        double[] tempItems = new double [items.length * 2];
        for(int j =0 ; j < items.length; j++ )
        {
            tempItems[j] = items[j];

        }

        tempItems[items.length] = value;
        items = tempItems;

    }

    else
    {
        if (i > numItems)
        {
            items[numItems] = value;
        }

        else 
        {
            for (int k = i; k < numItems; k++)
            {
                items[k+1] = items[k];
            }

            items[i] = value;
        }
    }

    numItems++;
} 
```

是我的方法，看起来很简单。

```
public static void main (String[] args)
{
    NumArrayList test;
    test = new NumArrayList();

    //System.out.println("this is how many initial items the initialized array has.");
    //System.out.println(test.items);
    test.insert(1, 0.1);
    System.out.println("have tried to insert value 0.1 @ position 1, that is the second element in array.");
    test.print(); 
```

是我的测试代码区，内置在同一个类中。

我收到一个错误，编译器声称我在第 47 行或在

```
tempItems[items.length] = value; 
```

我相信它试图告诉我我的项目初​​始化是错误的，

```
private double[] items;
private int numItems;

public NumArrayList()
{
    items = new double[0];
    numItems = 0;
} 
```

但是初始化已经被一个比我好得多的程序员批准了，这些错误让我无处可去。也许我应该研究程序的哪一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:30:25.450

您的初始化肯定是错误的。什么是合理的默认尺寸？对于 ArrayList，答案是 10。你可以随心所欲，但不能为零！如果将大小为 0 的数组的长度加倍，则新数组的长度仍为 0。

```
int capacity; //stores the size of the array (items available)
int numItems; //stores how many items are actually stored in the array.

public NumArrayList()  {
    items = new double[10];
    numItems = 0;
    capacity = 10;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:28:07.357

您必须记住，数组始终以索引 0 而不是 1 开头。因此，如果您的数组大小为 10，则最大索引为 9 而不是 10。

```
tempItems[0] = first element;
tempItems[1] = second element; 
```

等等等等

假设你有 10 个元素，你的第十个元素将在 tempItems[9] 中。尝试访问 tempItems[10] 将引发您看到的异常。基本上，如果您正在寻找最后一个索引，您想要这样做：

```
tempItems[items.length-1] = value; 
```

编辑：忘记这个。您在初始化时将数组索引加倍。参考上面Thorn的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:31:08.003

改变这个

```
 tempItems[items.length] = value; 
```

至

```
 tempItems[items.length-1] = value; 
```

数组索引从 0 开始，如果您的数组长度为 5，则最后一个索引为 4

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:32:20.990

一旦将位置分配给数组，可以说`items = new double[0];`您无法更改数组的大小。如果数组初始化为 0，这意味着你有一个无用的数组。您添加到其中的任何内容都会引发 Array index out of bounds 异常。

要走的路是使用集合，特别是[列表](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/List.html)接口。

```
List myList = new List(); //Create an empty list
myList.add(item); //adds item to List 
```

还有其他 List 的实现，如[ArrayList](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/ArrayList.html)、[LinkedList](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/LinkedList.html)等...可以更好地满足您的需求。

# c# - 带有 iSCSI 驱动器的 DriveInfo

> ID：12630900
> 
> 赞同：2
> 
> 时间：2012-09-27T22:22:44.293
> 
> 标签：c#, iscsi, driveinfo

我一直在计划编写一些代码来检查连接到服务器的大量磁盘上的可用空间，这些磁盘使用 iSCSI 挂载。

有人警告说“轮询死挂载上的可用空间会导致很长的超时”。

我的问题基本上是这样的：使用 DiskInfo 类时是否如此，是否有更好的选择来确定以这种方式安装的磁盘上的可用空间，至少“更好”，因为它不会长时间挂起并以可预测的方式做出反应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:27:30.180

可能不是因为延迟是由 Windows 的 IO 子系统引起的。但是您可以`DiskInfo`在第二个线程中自由使用该类 - 这样您的 UI 就不会被阻塞。

# php - 如何将音频文件与 PHP 结合起来？

> ID：12630901
> 
> 赞同：2
> 
> 时间：2012-09-27T22:22:45.607
> 
> 标签：php, audio, pear

我想创建一个基本的语音软件，其中的 PHP 程序结合了一些现成的声音（例如`the`, `cat`, `sat`, `on`, `the`, `mat`），然后允许用户下载完成的文件（然后，按照上面的例子，会说`the cat sat on the mat`）。

我考虑过的几个选项：

*   某种 PHP 或 PEAR 库（如果可能，请不要使用 PEAR）
*   使用二进制安全读取功能从所有音频文件中读取，然后手动组合它们

有没有我错过的？还是我还没有涵盖正确的选项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T22:35:55.477

如果您真的需要使用本机 PHP 来执行此操作，那么您可能不走运。

我不知道您的确切需求，但我会支持使用由您的 PHP 代码驱动的专用库（例如[SoX](http://sox.sourceforge.net/)`exec()` ）的想法。

此外，假设您正在编写一个 Web 应用程序，预计处理时间会足够长，以至于您必须管理正在运行的异步声音生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T07:07:50.297

使用 SoX，它工作正常：

```
$ sox read.wav the.wav internet.wav read-the-internet.mp3 
```

您可能需要该`libsox-fmt-all`软件包来支持您的文件类型。

# javascript - 使用必需和可选参数构建对象

> ID：12630906
> 
> 赞同：0
> 
> 时间：2012-09-27T22:23:12.793
> 
> 标签：javascript, jquery, jqgrid

我正在尝试创建一个网格构建器对象。这个网格构建器有一个方法 buildGrid，我设计它是为了期望一个对象为网格定义一堆参数：

```
buildOrdersGrid: function () {
    var ordersGrid = buildGrid({
        gridElementID: 'OrdersGrid',
        gridPagerElementID: 'OrdersGridPager',
        colNames: ['Order ID', 'Project Subcode', 'Incident Number', 'Cost Center', 'Name', 'Customer'],
        colModel: [
            { name: 'ID', hidden: true },
            { name: 'ProjectSubcode' },
            { name: 'IncidentNumber' },
            { name: 'CostCenter' },
            { name: 'Name' },
            { name: 'Customer' }
        ],
        defaultCaption:'Orders: no filter applied',
    });
    return ordersGrid;
}

function buildGrid(data) {
    var grid = $('#' + data.gridElementID);
    var gridPager = $('#' + data.gridPagerElementID);

    grid.jqGrid({
        datatype: 'local',
        colNames: data.colNames,
        colModel: data.colModel,
        gridview: true,
        height: 'auto',
        pager: gridPager,
        viewrecords: true,
        multiselect: true,
        defaultCaption: data.defaultCaption,
        caption: data.defaultCaption,
        shrinkToFit: false
    });

    return grid;
} 
```

类似的东西，但它确实是新代码，因此对如何改进的建议持开放态度。

现在，我想扩展这个 buildGrid 方法，使其可以采用非预定义属性并将它们提供给 jqGrid。就像是：

```
buildTaskGrid: function () {
    var tasksGrid = buildGrid({
        gridElementID: 'TasksGrid',
        gridPagerElementID: 'TasksGridPager',
        colNames: ['Order', 'Task ID', 'Task #', 'Type', 'Status', 'Assignee', 'Current Location', 'Dest Location', 'Change No', 'Net Patched', 'SAN Patched'],
        colModel: [
            { name: 'Order' },
            { name: 'TaskID', hidden: true },
            { name: 'TaskNo' },
            { name: 'Type' },
            { name: 'Status' },
            { name: 'Assignee' },
            { name: 'CurrentLocation' },
            { name: 'DestLocation' },
            { name: 'ChangeNo' },
            { name: 'NetPatched' },
            { name: 'SANPatched' }
        ],
        defaultCaption:'Tasks: no filter applied',
        //Decorate with task-specific properties.
        grouping: true,
        groupingView: {
            groupField: ['Order'],
            groupColumnShow: [false]
        },
        ondblClickRow: function (rowid) {
            $(this).trigger('taskDoubleClicked', selector.getRowData(rowid));
        } 
    });

    return tasksGrid;
} 
```

我不确定我应该如何最好地“找到”意料之外的属性并将它们提供给网格。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:28:02.997

我想你可以使用这个[http://api.jquery.com/jQuery.extend/](http://api.jquery.com/jQuery.extend/)

# android - 仪表板模式在专辑方向上无法正确显示

> ID：12630907
> 
> 赞同：0
> 
> 时间：2012-09-27T22:23:13.080
> 
> 标签：android, user-interface, dashboard

我正在尝试实现 DashboardLayout （[模式 3](http://android-developers.blogspot.com/2010/05/twitter-for-android-closer-look-at.html)）。方向为纵向时一切正常： ![在此处输入图像描述](../Images/f95777c830f4af204e212544b0a54f24.png)

但是当应用程序的方向更改为专辑时，它看起来像： ![在此处输入图像描述](../Images/17800ec9a4f408acc066cabd0e2e8fc6.png)

这里是[DashboardLayout.java的源代码](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/ui/widget/DashboardLayout.java?r=27a82ff10b436da5914a3961df245ff8f66b6252)

活动布局文件如示例：

```
<?xml version="1.0" encoding="utf-8"?>
<com.example.ui.DashboardLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/dashboard_layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/white" >

    <Button
        android:id="@+id/posts"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/ic_db_posts"
        android:onClick="onClick"
        android:text="posts" />

    ***and four same buttons***

</com.example.ui.DashboardLayout> 
```

`style/DashboardButton`：

```
<style name="DashboardButton">
        <item name="android:layout_width">wrap_content</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:gravity">center_horizontal</item>
        <item name="android:layout_gravity">center_vertical</item>
        <item name="android:background">@drawable/db_buttons</item>
        <item name="android:textStyle">bold</item>
        <item name="android:textSize">16sp</item>
        <item name="android:textColor">#000000</item>
    </style> 
```

仅用于按钮按下状态的背景：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >

    <item 
        android:state_pressed="true"
        android:drawable="@drawable/db_button_bd_pressed" />

</selector> 
```

按下：

```
<?xml version="1.0" encoding="utf-8"?>
<shape 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">

    <padding 
        android:left="10dp"
        android:top="20dp"
        android:right="10dp"
        android:bottom="20dp" />

    <corners android:radius="10dp" />

    <solid android:color="#a6cee1" />

</shape> 
```

问题出在哪里？请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:31:54.083

如果按钮数量是偶数，仪表板布局才有效。你有一个奇数，只需插入一个额外的按钮：

```
android:background="@null" or "#ffffffff"//transparent 
```

所以它会像一个额外的按钮一样处理它，但它是透明的。

# amazon-web-services - 如何使用 Boto 获取亚马逊价格？

> ID：12630908
> 
> 赞同：0
> 
> 时间：2012-09-27T22:23:19.753
> 
> 标签：amazon-web-services, tornado, boto

似乎[Boto](https://github.com/boto/boto)是[Python 的官方 Amazon API 模块](http://aws.amazon.com/articles/3998?_encoding=UTF8&jiveRedirect=1)，而[这个是 Tornado 的](https://github.com/thisismess/botornado)，所以这是我的问题：

*   它是否提供分页（仅请求 10 个产品，因为亚马逊每页提供 10 个产品，那么我只想获得第一页......），那么如何（示例代码？）
*   然后如何解析产品解析，我使用了[python-amazon-simple-product-api](https://github.com/yoavaviram/python-amazon-simple-product-api)但遗憾的是它不提供分页，所以所有的报价都在不断迭代。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T17:48:24.433

通常，分页由请求 api 的客户端执行。要在 boto 中执行此操作，您需要削减系统。例如，假设您使用 get_all_instances def 通过 boto 调用 AWS；您需要以某种方式存储这些内容，然后跟踪已显示哪些服务器，哪些未显示。据我所知，boto 没有大多数开发人员习惯于 MySQL 的 LIMIT 功能。就个人而言，我扫描所有实例并将它们存储在 mongo 中，如下所示：

```
for r in conn.get_all_instances():        # loop through all reservations
   groups = [g.name for g in r.groups]    # get a list of groups for this reservation
   for x in r.instances:                  # loop through all instances with-in reservation
      groups = ','.join(groups)         # join the groups into a comma separated list 
      name = x.tags.get('Name','');       # get instance name from the 'Name' tag

      new_record = { "tagname":name, "ip_address":x.private_ip_address, 
                      "external_ip_nat":x.ip_address, "type":x.instance_type,
                      "state":x.state, "base_image":x.image_id, "placement":x.placement, 
                      "public_ec2_dns":x.public_dns_name,
                      "launch_time":x.launch_time, "parent": ObjectId(account['_id'])}
      new_record['groups'] = groups
      systems_coll.update({'_id':x.id},{"$set":new_record},upsert=True)
      error = db.error()
      if error != None:
           print "err:%s:" % str(error) 
```

您也可以将它们包装在 try/catch 块中。由你决定。一旦你把它们从博托中取出，做切割工作应该是微不足道的。

——杰斯

# html - Heigher 然后页面 div 保持顶部顶部/中心

> ID：12630910
> 
> 赞同：0
> 
> 时间：2012-09-27T22:23:34.460
> 
> 标签：html, css

我有一个 ajax 页面，它像一个灯箱一样加载在内容之上（一个包含很多产品的页面，比如说 height=3000px）

该ajax页面具有动态高度，有时是500px，有时是2000px。

单击产品（加载 ajax 页面）：如果我使用 position:absolute 并单击页面末尾某处的产品，我无法真正看到 ajax 页面，因为太远了。如果我使用 position:fixed ajax 页面保持在顶部（与我所处的位置无关）但是如果 ajax 页面具有更大的高度然后浏览器高度我无法看到超出浏览器高度的 ajax 页面内容： (

希望这是有道理的......

当您单击图像时，Pinterest 如何加载内容是我想要的。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:45:21.173

酷，我已经做到了。

我不得不使用：

```
#ajax { display:none; position: fixed; width: 100%; overflow-x:auto; overflow-y:scroll; z-index: 999999; top:0; left:0; right:0; bottom:0;  } 
```

并调用ajax：

```
$(".product-list .quickview a").click(function(){
  $(this).closest("body").find("#ajax").load("ajax/product.html").show();
  $(this).closest("body").find(".whitebg").removeClass("hide");
  $(this).closest("body").css({ "overflow" : "hidden"});
}) 
```

# google-apps-script - Spreadsheet.show（HtmlOutput）之后如何取消显示（）？

> ID：12630912
> 
> 赞同：0
> 
> 时间：2012-09-27T22:23:37.447
> 
> 标签：google-apps-script, google-sheets, google-spreadsheet-api

我有这个工作非常好：

```
var theForm = HtmlService.createTemplateFromFile('aForm').evaluate();
var theSpreadsheet = SpreadsheetApp.getActiveSpreadsheet();

theSpreadsheet.show(theForm); 
```

当用户提交数据时，我想关闭“theForm”。电子表格上是否有类似 unShow() 或 hide() 方法的东西？HtmlOutput 上的harikiri() 方法？

理想情况下，我想要一个 reShow() 命令来保存提交的数据，刷新电子表格并再次调用 show()。

我发现没有办法做这些事情，所以我只是禁用了提交按钮。啊!

任何建议都非常感谢。

*更新（2012/08/28）：* 我应该提到我正在调用与最初打开的“theForm”相同的代码，从 HTML 表单，使用这个调用......

```
google.script.run.recordTheForm(jsonTheForm); 
```

我是否正确地假设了 google.script.run。*** () 调用不知道之前设置的任何变量值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T13:56:51.923

HtmlService 没有 app.close() 的等价物......这是一个疏忽，不是设计使然，我们将修复它。

编辑：从客户端 JavaScript 代码中（不是来自服务器`app.close()`，而是在 HtmlService 代码本身），您现在可以调用`google.script.host.closeDialog()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T05:24:25.400

调用这个：

```
theForm.close();
SpreadsheetApp.flush();
theSpreadsheet.show(theForm); 
```

祝你好运，

托马斯·范拉图姆

# python - 跨 python 进程共享模块

> ID：12630913
> 
> 赞同：6
> 
> 时间：2012-09-27T22:23:57.673
> 
> 标签：python, shared-libraries

我们正在编写一个内存紧张的系统。有多个 python 进程将导入同一组类。如果进程加载了无数个类并且每个进程消耗了几百兆，那么 10 个进程和我正在运行 gigs。有没有办法跨 python 进程“共享”类导入？

概括：

```
import classA # Process 1 : loads classA in memory
import classA # Process 2 : reuses what was loaded previously by Process 1 
```

PS：我想要实现的是你会用`.so`C/C++ 中的模块做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T02:16:39.750

如果您的操作系统支持高效的写时复制 fork（很多都支持），那么至少可以节省一点内存。只需`import`在父级中创建所有内容，然后`fork()`创建所有子级。

请注意，如果您有许多小对象，则不会保存任何内容，因为需要写入对象的引用计数。但是，您可以使用属性字典等大型静态结构节省大量成本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:27:59.317

我不相信这在 python 的设计中是可能的。如果这很重要，您可能希望使用线程而不是单独的进程。此外，如果您仅通过导入几个模块来运行 100 Megs，那么您可能在模块中做错了（似乎要使用相当多的内存）。

如果您绝对必须导入所有内容，不能减少内存使用并且不能使用线程，那么一种可能性是将大内存代码移动到用 C/C++ 编写的 python 扩展中。然后，这将允许您跨进程共享您的 python 扩展所在的共享库的公共段。它还可能在一定程度上减少内存占用。

PS在python中，您实际上是在导入模块，而不是类。类似于在 C/C++ 中包含头文件而不是类的方式。

# eclipse - 为什么 super 在我的项目中被删除了？

> ID：12630915
> 
> 赞同：0
> 
> 时间：2012-09-27T22:24:14.310
> 
> 标签：eclipse, robotium

我正在使用以下代码：

为什么super被淘汰了？？

![在此处输入图像描述](../Images/a4c2c9ea1fc4d77e46dac53bf8cd0e9a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:24:57.913

这意味着该方法已[弃用](http://en.wikipedia.org/wiki/Deprecation)。在这种情况下，开发人员已弃用采用这些参数的构造函数。

简而言之，弃用意味着您正在使用的库的开发人员已表示将来不会继续支持该特定方法。在*大多数*情况下，该方法仍将按预期工作，但在库的未来版本中可能不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T01:14:11.567

我也面临同样的问题

我使用下面的步骤来解决这个问题。

[1](https://i.stack.imgur.com/NXuSZ.jpg)从您的项目中删除所有 robotsium 包引用。

[2] 请尝试添加robotium 包，如下图所示。- 只需在您的包中添加“lib”文件夹，然后在此文件夹中添加 robots-solo-3.4.1.jar 文件。

![添加robotium包的不同方法](../Images/a41b376a2d79ffb5465a9caf0f2adc10.png)

[3] Eclipse 编辑器中“项目”工具栏选项中的“清理”代码。然后在 Eclipse 中查看您的代码，这对我有用。

[4] 如果可能的话，然后使用 eclipse 最新版本来运行你的项目。

我希望这能帮到您。

# java - 通过泽西岛发布 JSON

> ID：12630917
> 
> 赞同：0
> 
> 时间：2012-09-27T22:24:24.757
> 
> 标签：java, web-services, rest, jersey, jaxb2

我有这个代码

```
 ClientConfig config = new DefaultClientConfig();
    Client client = Client.create(config);
    client.addFilter(new HTTPBasicAuthFilter(adminUser, adminPass));
    client.addFilter(new LoggingFilter(System.out));

    WebResource service = client.resource(baseURL);
    ClientResponse clientResponse = service.path("api")
            .path("v1")
            .path("shoppers")
            .path(orderId)
            .path("status.json").accept(MediaType.APPLICATION_JSON).post(ClientResponse.class, request); 
```

每当我尝试发布类似的 JSON 请求时，我都会收到`HTTP 415`错误响应。稍微深入研究一下这个问题就会发现 JERSEY 没有正确编组我的对象。通过添加`LoggingFilter`，我可以看到在请求正文中，`JAXBObject`被沼泽化为`XML`而不是`JSON`。

这是 JERSEY 的已知行为吗？我应该在这里做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:33:14.200

您可能需要调用[`type()`](http://jersey.java.net/nonav/apidocs/1.5/jersey/com/sun/jersey/api/client/PartialRequestBuilder.html#type%28javax.ws.rs.core.MediaType%29)您的请求来设置内容类型（我假设 Jersey 对此做了一些聪明的事情）：

```
.path("status.json")
.type(MediaType.APPLICATION_JSON) // <-- This line
.accept(MediaType.APPLICATION_JSON)
.post(ClientResponse.class, request); 
```

[其他资源](https://stackoverflow.com/questions/2121390/how-to-generate-json-from-a-jersey-resource)表明您可能需要手动执行此操作[`ObjectMapper`](http://jackson.codehaus.org/1.7.9/javadoc/org/codehaus/jackson/map/ObjectMapper.html)：

```
ObjectMapper mapper = new ObjectMapper();
String jsonStr = mapper.writeValueAsString(jsonObj); 
```

# javascript - 使用 Chrome 的 window.open 中的行为变化

> ID：12630920
> 
> 赞同：2
> 
> 时间：2012-09-27T22:24:36.447
> 
> 标签：javascript, google-chrome, bookmarklet

我有以下书签，可以打开 SMF 论坛的“未读主题”页面中显示的所有帖子（原件是单行）：

```
javascript:(function(){
  var topics = new Array();
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (links[i].href.indexOf('#new') != -1)
      topics.push(links[i].href);
  }
  for (var i = 0; i < topics.length; i++) {
    window.open(topics[i]);
  }
})(); 
```

它曾经工作正常：我打开带有链接的页面，单击书签，所有主题都将在新标签中打开。

在上次 Chrome 更新（我当前的版本是 22.0.1229.79 m，Windows 7 x64）之后，情况发生了变化。当我单击它时，第一个主题会在新选项卡中打开，但其他主题会在弹出窗口中打开（我必须第一次授权它们）。

我的问题是：

1.  如何解决此问题并恢复旧行为？
2.  是什么导致了这种变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T12:53:57.663

试试这个 hack 作为解决方法。为我工作。

```
javascript:(function(){
  var topics = new Array();
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (links[i].href.indexOf('#new') != -1)
      topics.push(links[i].href);
  }
  for (var i = 0; i < topics.length; i++) {
    setTimeout(function(){ window.open(topics[i]) }, 500); // ADDED setTimeout
  }
})(); 
```

您可能需要修改 Chrome 的弹出框设置。如果 chrome 阻止弹出窗口，URL 栏的右上角会出现一个小图标。

您也可以直接在此处编辑它们：chrome://chrome/settings/contentExceptions#popups

我能够以这种方式打开至少 30 个选项卡，但似乎可以通过这种方式打开的选项卡数量受到限制。玩弄超时可能会有所帮助。或者您可以打开 30 个，然后再次单击以再打开 30 个，等等 - 显然，只需对代码进行少量更改。“30”只是一个例子。尝试找到一个最佳数字。

值得注意的是，当我修改弹出窗口阻止程序设置并使用没有 setTimeout 的代码时，发生的情况是打开了 2 个选项卡，然后打开了大量新窗口。我认为这是错误。在这种情况下，我看不出有任何可能的理由从选项卡更改为窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T19:21:14.930

[在后台打开一个新标签？](https://stackoverflow.com/questions/10812628/open-a-new-tab-in-the-background)可能会有所帮助：那里的答案建议使用`document.createEvent`然后`initMouseEvent`模拟 ctrl-click - 或 OS X 上的 meta-click。

# iphone - 如何防止在没有我的客户端应用程序的情况下连接到服务器？

> ID：12630923
> 
> 赞同：0
> 
> 时间：2012-09-27T22:25:03.290
> 
> 标签：iphone, security, encryption, client-server

一个客户要求我为其 iPhone 应用程序做一个后端服务器，并且只希望购买该应用程序的用户能够调用该服务器。问题是他不想在应用程序中添加登录系统，所以在我看来，没有完全安全的方法可以防止没有他的应用程序的人调用服务器。无论如何，即使不能完全防止，也足以使没有应用程序的服务器难以访问。

实现这一目标的最佳方法是什么？同样，我不需要完全保护连接，没有敏感信息的传输，我只是想让那些想要在不支付应用程序的情况下利用服务器的人让事情变得更复杂一些。

似乎最简单的想法是使用存储在客户端中并为服务器所知的密钥加密数据，以便仅通过反编译代码并找到密钥才能解密消息（当然，您可以放置​​一个密钥而不是密钥键列表，每 6/12/24 小时更改一次）。

这可能是一个合理的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T01:36:16.117

SSL 连接不足以阻止其他人获取请求的 URL？或者甚至更好地使用带有基本身份验证的 SSL 连接？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:33:41.517

这永远不可能。欢迎来到客户端-服务器架构的本质。你永远不能相信客户。只要确保您公开的功能是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T01:14:40.553

好吧，如果它是付费应用程序，您可以免费发布该应用程序，并锁定所有功能，直到用户进行应用程序内购买，然后您可以验证服务器上的收据，从而证明该设备是 iOS 设备？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T01:23:03.287

在客户端和服务器之间共享密钥似乎是一个不错的方法。但不要仅依赖于存储的密钥，而是尝试将它们与唯一标识符（例如[UUID](https://github.com/blackpixel/BPXLUUIDHandler) ）结合起来，并将其与组合密钥和 UUID 本身一起发送到服务器。

此时用户 UUID 将是他的标识符（用户名），组合键将是他的令牌（密码）。这将是一个类似登录的机制。

# jquery - 没有类名的 jQuery Masonry Child 选择器

> ID：12630925
> 
> 赞同：0
> 
> 时间：2012-09-27T22:25:18.563
> 
> 标签：jquery, html, html-lists, jquery-masonry

我对砌体有问题。

这是我需要应用砌体的地方。

```
<ul class="text">
  <li> 
       <ul>
            <li> <!--Trying to apply masonry only  here-->
               <ul>
                  <li></li><!--Not here-->
               </ul>     
             </li>
            <li> <!--Trying to apply masonry only here-->
               <ul>
                  <li></li> <!--Not here-->
               </ul>     
             </li>
        </ul> 
   </li>
</ul> 
```

仅在第二个 ul 的 li 标签上应用砌体。如果我不为每个 li 标签添加一个类，砌体将无法正常工作，因为它还会在下一个 ul >li 中添加它。如果我像这样为每个 li 添加一个类，我可以让它工作，但是用 php 做有点复杂。

```
<ul class="text">
      <li> 
           <ul>
                <li class="class"> <!--Trying to apply masonry only  here-->
                   <ul>
                      <li></li><!--Not here-->
                   </ul>     
                 </li>
                <li class="class"> <!--Trying to apply masonry only here-->
                   <ul>
                      <li></li> <!--Not here-->
                   </ul>     
                 </li>
            </ul> 
       </li>
    </ul> 
```

使用这个：

```
 $("ul.text > li > ul").masonry({
                itemSelector : '.class'
            }); 
```

但我不想添加一个类。我尝试了类似的方法，但它一直将砌体应用于所有 li 标签。

```
 $("ul.text> li > ul").masonry({
        itemSelector : 'li'
    }); 
```

有没有办法在不申请课程的情况下做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:38:46.143

尝试

```
itemselector : 'ul.text> li > ul > li' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:36:05.770

来自文档

> 将项目元素过滤到选择器。如果未设置，Masonry 默认使用容器的子元素。
> 
> 建议避免 Masonry 在其布局逻辑中使用任何其他隐藏元素。

所以我认为你应该删除`itemSelector : 'li'`根据文档它是正确的

# android - SharedPreferences 未更新

> ID：12630926
> 
> 赞同：11
> 
> 时间：2012-09-27T22:25:23.390
> 
> 标签：android, sharedpreferences

我有一个奇怪的问题，其中 SharedPreferences 在返回应用程序时没有更新。这是场景：

我有两个使用相同共享偏好的项目。项目 1 和项目 2。它们是独立但相关的应用程序。它们使用相同的密钥进行签名，并使用 sharedUserId 来共享信息。

Project1 打开 Project2。

Project2 检索 SharedPreferences 文件并通过此方法写入它：

```
Context prefsContext = c.createPackageContext(packageNameOfProject1, Context.CONTEXT_IGNORE_SECURITY);
SharedPreferences prefs = prefsContext.getSharedPreferences(fileName, Context.MODE_PRIVATE);
SharedPreferences.editor editor = prefs.edit();
editor.putBool("bool1", value1);
editor.putBool("bool2", value2);
...
editor.putBool("boolN", valueN);
editor.apply(); 
```

完成后，我通过调用返回 Project1 `finish()`。

Project1 然后像这样读取数据：

```
SharedPreferences prefs = getSharedPreferences(getPreferencesFileName(), Context.MODE_PRIVATE);
Boolean value1 = prefs.getBoolean(fileName, false);
Boolean value2 = prefs.getBoolean(fileName, false);
...
Boolean valueN = prefs.getBoolean(fileName, false);
Map<String, ?> mappings = prefs.getAll();
Set<String> keys = mappings.keySet();
for(String key : keys) {
  log.d(TAG, "_____");
  log.d(TAG, "Key = " + key);
  log.d(TAG, "Value = " + mappings.get(key));
} 
```

问题是 Project1 中的值未更新。我可以根据最后的日志判断该文件甚至没有生成映射。但是，我可以验证 xml 是否正在更新。如果我强制停止应用程序然后重新启动它，所有映射都在 Project1 中。所有的值都是正确的。但是，当用户离开 Project2 时，我需要更新它们。我觉得我在这里缺少一些东西，但无法发现它。

我能找到的关于这个主题的唯一事情是：

[SharedPreferences.Editor 在初始提交后未更新](https://stackoverflow.com/questions/9050810/sharedpreferences-editor-not-being-updated-after-initial-commit)

[SharedPreferences 值未更新](https://stackoverflow.com/questions/10186215/sharedpreferences-value-is-not-updated)

这些没有帮助，因为我已经在这样做了。

我在两个清单中都设置了 WRITE_EXTERNAL_STORAGE。文件名是相同的（否则当我重新进入应用程序时将无法读取文件）。

编辑：

我应该注意到，我确实尝试过这样做，`editor.commit()`而不是`editor.apply()`像我认为的那样面临比赛条件。问题仍然存在。我在想，出于某种原因，使用 Project1 中对 SharedPreference 的旧引用而不是新引用，即使我每次都延迟加载它。

编辑2：

好的，进一步测试看看 id 发生了什么。我决定尝试相反的方向。

在 Project1 我做：

```
Float testFloat (float) Math.random();
Log.d("TEST_FLOAT", "Project1: TEST_FLOAT = " + testFloat);
prefs.edit().putFloat("TEST_FLOAT", testFloat).commit(); 
```

在 Project2 我做：

```
Log.d("TEST_FLOAT", "Project2: TEST_FLOAT = " + prefs.getFloat("TEST_FLOAT", 0.0f)); 
```

然后我像这样在两者之间来回切换：`Project1->Project2->Project1->Project2->Project1->Project2`这是 logcat 结果：

```
Project1: TEST_FLOAT = 0.30341884
Project2: TEST_FLOAT = 0.30341884
Project1: TEST_FLOAT = 0.89398974
Project2: TEST_FLOAT = 0.30341884
Project1: TEST_FLOAT = 0.81929415
Project2: TEST_FLOAT = 0.30341884 
```

换句话说，它正在读取和写入同一个文件。但是，它保留了它在项目中首次打开时的映射。即使我关闭了项目，映射仍然存在，直到应用程序被强制停止。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-28T17:12:28.877

编辑：即使它推荐了一种已被弃用的方法，我仍然对此答案表示赞同。如果您需要通过多进程获得一致的数据，那么您需要使用 SharedPreferences 以外的其他东西，例如由文件系统或数据库支持的 ContentProvider。

[https://developer.android.com/reference/android/content/Context#MODE_MULTI_PROCESS](https://developer.android.com/reference/android/content/Context#MODE_MULTI_PROCESS)

* * *

最终答案：

代替

`getSharedPreferences(fileName, Context.MODE_PRIVATE);`

和

`getSharedPreferences(fileName, Context.MODE_MULTI_PROCESS);`

根据文件：

> Context.MODE_MULTI_PROCESS
> 
> SharedPreferences 加载标志：设置后，即使在此过程中已经加载了共享首选项实例，也会检查磁盘上的文件是否有修改。在应用程序有多个进程的情况下，有时需要这种行为，所有进程都写入同一个 SharedPreferences 文件。但是，通常在进程之间存在更好的通信形式。
> 
> 这是 Gingerbread (Android 2.3) 中和之前的遗留（但未记录）行为，并且在针对此类版本时隐含此标志。对于面向高于 Android 2.3（Gingerbread）的 SDK 版本的应用程序，如果需要，必须显式设置此标志。

我知道这有一个简单的疏忽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T23:56:18.597

从 SharedPreferences 文档中，方法“apply()”异步（延迟）写入文件，方法“commit()”将信息同步（立即）写入文件。

同样从文档中，他们说在使用上述任何方法时，您无需担心活动生命周期，因为它们确保“apply()”写入在状态更改之前完成，如果它们正在运行相同的系统进程。

但是，由于您使用的是两个不同的项目，它们在两个不同的进程中运行，您不能确定项目 2 上的“apply()”是否会在项目 1 上的“onResume()”开始之前结束。

我建议您尝试“commit()”而不是“apply()”来强制同步写入。如果这不能解决问题，您可以在读取项目 1 中的首选项之前添加几秒钟的延迟，以检查问题是否与此延迟写入有关。

--已编辑--

要调试问题，让我们执行以下操作：

1-在 Eclipse 中选择/添加视图“文件资源管理器”并导航到目录：

/data/data/[你的包名]/shared_prefs

您的包名称应该类似于“com.myproject.shared”

2-选择带有您保存的首选项的文件，然后按“下载到 PC”按钮。

3-检查文件内容是否符合您的期望。

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T22:50:37.023

尝试调用`editor.commit();`而不是`editor.apply();`. 通常他们应该这样做，但我注意到有时会有一些奇怪的行为。

# java - Android / Java：long得到负数而不超过max_value

> ID：12630927
> 
> 赞同：9
> 
> 时间：2012-09-27T22:25:27.570
> 
> 标签：java, android, long-integer

我正在尝试在我的 android 应用程序中做一些基本的计算，以将一个`Date.getTime()`值与一些计算的东西进行比较。

我在数据库查询期间所做的计算是：

```
long minus = pauseDays * 24 * 60 * 60 * 1000; 
```

所以基本上我计算`pauseDays`. 如果`pauseDays`变大（我说的是 90 天左右），就会发生一些奇怪的事情。计算结果为负数。

奇怪的是，结果应该是`7776000000`，所以它应该比 小得多`Long.MAX_VALUE`。谁能向我解释为什么我在这里得到一个负数？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-27T22:29:05.300

原因可能是因为`pauseDays`是一个`int`类型，对吧？然后你将它乘以另一串`int`s，*然后*将其转换为`long`.

考虑[一下](http://ideone.com/wQO4H)：

```
public class Main {
  public static void main(String[] args) {
    int pauseDays = 90;
    long minus = pauseDays * 24 * 60 * 60 * 1000;
    System.out.println(minus);

    long pauseDaysL = 90L;
    long minusL = pauseDaysL * 24L * 60L * 60L * 1000L;
    System.out.println(minusL);
  }
} 
```

这个的输出是：

```
-813934592
7776000000 
```

请注意，第一个`long minus`使用整数来生成其值。第二个`long minusL`使用所有长整数值。

# html - HTML 将字段集/标签相邻放置

> ID：12630933
> 
> 赞同：0
> 
> 时间：2012-09-27T22:25:39.037
> 
> 标签：html, css, label, inline, fieldset

所以我有两个字段集，包裹在一个标签中，我想彼此相邻显示。这是我的代码：[小提琴](http://jsfiddle.net/5brSk/2/)

因此，分别包含输入框和指令的两个字段集应该并排出现。我应该在我的代码中更改/添加什么以使其正常工作？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:29:28.827

拥有字段集`float: left;`将正常工作。

看看这个：http: [//jsfiddle.net/5brSk/2/](http://jsfiddle.net/5brSk/2/)

您必须确保您的 2 个字段集的容器足够大以将两个字段集彼此相邻放置，否则它将（再次）损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:36:25.620

如果您希望两个字段集并排，您可以使用表结构

```
<label>
  <table>
    <tr>
      <td>
        //field set 1
      </td>
      <td>
        //field set 2
      </td>
    </tr>
  </table>
</label> 
```

最后添加一些CSS来修复它。从技术上讲，不需要标签标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:52:33.620

将字段集设置为`display: inline-block;`( [http://jsfiddle.net/5brSk/16/](http://jsfiddle.net/5brSk/16/) ) 以并排获取它们，并且不要使用标签作为父级 - 使用它的表单或 div / span。不过，还有[无数其他](http://validator.w3.org/check?uri=http://fiddle.jshell.net/5brSk/2/show/&charset=%28detect%20automatically%29&doctype=Inline&group=0)事情会使您的代码无效（重复的 ID 等）

# javascript - iPhone / iPad 在页面上的 Javascript 滚动后禁用与链接的交互

> ID：12630937
> 
> 赞同：1
> 
> 时间：2012-09-27T22:26:02.047
> 
> 标签：javascript, iphone, css, ipad

我正在使用 Javascript 在我的固定标题中有一个链接，将视图向下滚动到页面上的某个位置。基本上只是一个动画卷轴。

当页面加载时，一切都很好，链接向下滚动页面。从那时起，标题中的按钮在用户手动滚动页面之前不起作用，即使是很小的滚动量。用户移动内容后，所有按钮都会再次起作用。

在使用 IE9、Chrome、FF、Safari 和 Opera 的 Windows 7 上按预期工作；在三星 GT-I9000 Android 2.6.32.9 上失败；在装有 iOS 5.1.1 的 iPad 和 iPhone 上失败。

有任何想法吗？谢谢。

# android - 设备位置验证

> ID：12630939
> 
> 赞同：0
> 
> 时间：2012-09-27T22:26:18.910
> 
> 标签：android, ios, location

我将如何验证/跟踪 5' 精度内的设备位置？我听说有人使用手机信号塔/gps 组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:30:08.743

据我所知，获得 5 英尺准确度数字的唯一方法是使用 GPS，然后它仍然并不总是那么准确，具体取决于您对卫星的定位（清晰的天空视野）有多好。

蜂窝塔 / Wifi 三角测量方法仅用于加快定位速度，并且很少（如果有的话）比卫星定位方法更准确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T23:54:40.810

获得这种精度的唯一方法是使用 WAAS。据我所知，目前还没有可以接收 WAAS 校正的 Android 手机。如果这是针对特定受控情况，您可以使用带有 WAAS 的蓝牙 gps 接收器，并且只能在 WAAS 支持的位置使用。但是，如果这是为了更广泛的部署，那么我认为你不走运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:32:06.017

GPS是要走的路。手机信号塔不会削减它。在 Android（我相信 iOS）中，除了实际位置之外，系统还会为您提供准确的读数。您可以使用此值来确定您收到的值是否应该上传到您的服务器。请记住，使用 GPS 非常耗电，并且无法保证准确度有多好。根据条件，您可能无法达到 5' 精度。

正如@CommonsWare 指出的那样，5' 无论如何都是不现实的，尽管你可以接近。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T23:28:16.103

正如 CommonsWare 所说，在消费级设备中，您不会获得 10 米的精度。即使在开阔的天空中，大气特征也每时每刻都在变化，这足以改变 GPS 读数。

但是，如果您可以获得以下所有内容，则理论上可以提高准确性：

1-有一些固定已知位置的固定 GPS 接收站测量当前 GPS 信号偏差。您需要有一个离您很近的人，并且可以实时访问数据。

2-您需要对手机 GPS 接收器具有低级别访问权限才能读取从卫星接收到的未处理数据。这会因设备而异，据我所知，没有供应商提供这种访问权限。

3-Finnaly，您需要进行所有计算以确定您的位置，应用从上述第 1 点得到的偏差。

祝你好运。

# asp.net - 使用 SQL 查询信息填充 ReportViewer1 上的新图表

> ID：12630951
> 
> 赞同：0
> 
> 时间：2012-09-27T22:27:44.687
> 
> 标签：asp.net, sql, vb.net, sql-server-2008, charts

我对asp.net中的图表完全陌生，所以请耐心等待，我已经阅读了多个关于如何将数据绑定到图表的网页，但我仍然无法显示任何内容。

我知道这可能不是这个问题的第一个实例，但我无法解决这个问题来挽救我的生命。我希望稍微轻推一下，在此之后我将不再需要有关此主题的任何帮助。

假设我有一个下拉列表，这个下拉列表中有两个项目。在 Dropdown_IndexChange 上，它将更改位于 ReportViewer 中的 chart1 的数据源（数据库将是本地的）。

索引 0 使用 SQL 命令创建条形图：“SELECT [SWversion:], [Batt_Wifi:], [Batt_Standby:], [Batt_OnCall:] FROM Amaze”

其中 SWVersion 是系列的名称，其他 3 个是数据。

索引 1 使用 sql 命令创建折线图：“SELECT [SWversion:], [Wifi_Pref_IC:], [Wifi_Pref_NC:], [Wifi_Only_IC:], [Wifi_Only_NC:] FROM Amaze”

SWVersion 在这里也以同样的方式工作。

如何让这些图表显示出来，以及如何将 SWVersion 名称附加到该系列。

我正在尝试使用的代码是这样的：

```
 Chart1.DataSource = Nothing
    Chart1.Visible = True
    Dim newsqlcommand As String = "SELECT [Batt_Wifi:], [Batt_Standby:], [Batt_OnCall:] FROM Amaze"
    Using con As New System.Data.SqlClient.SqlConnection(connexstring)
        con.Open()      
        Dim myCommand = New SqlDataAdapter(newsqlcommand, con)
        Dim ds = New DataSet()
        myCommand.Fill(ds)
        Chart1.DataSource = myCommand
        con.Close()
        con.Dispose()
    End Using
    Chart1.DataBind() 
```

我知道这只是 SQL 命令之一，但我仍在试图弄清楚它是如何工作的。我没有收到错误，但是有了这个我什至无法绘制图表。

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:34:54.990

像往常一样，我让这一切变得更加困难，那是必须的。

解决这个问题的最简单方法就是将已经填充到 GridView 中的信息绘制成图表。

因此，无论您的 gridviews 是否与您的数据库相关联，这都无关紧要，只需调用一个 sub 或一个函数，用已经查询的信息填充图表。

小菜一碟。

扎克

# .net - CouchBase 使用 .NET 客户端获取数据库中的所有键和值

> ID：12630952
> 
> 赞同：2
> 
> 时间：2012-09-27T22:27:52.273
> 
> 标签：.net, client, key, couchbase

我刚刚安装了 CouchBase 1.8 并正在使用 .NET 客户端与之交互。我想知道是否有任何方法可以获取存储在存储桶中的所有键（和值）。即使它不是一个 .NET 解决方案，只要它可以工作就可以了。

谢谢五

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:18:01.157

我建议使用 Couchbase Server 2.0 Beta - [http://www.couchbase.com/couchbase-server/beta](http://www.couchbase.com/couchbase-server/beta)。使用该版本，您将能够使用视图来获取存储桶中的所有文档。

```
function (doc, meta)
{
   emit(meta.id, null);
} 
```

然后使用 .NET 1.2 Beta 客户端，您将能够迭代所有文档（或使用 Web 控制台查看视图的结果）。

编辑以包含 .NET 示例：

使用上面的 JavaScript Map 函数创建视图后，您将按如下方式使用 .NET 客户端（假设您创建了一个名为“utils”的设计文档和一个名为“all_keys”的视图：

```
var view = client.GetView("utils", "all_keys");
foreach(var row in view)
{
    Console.WriteLine("Current ID: " + row.ItemId);
} 
```

或者：

```
var keys = view.Select(row => row.ItemId); //get an IEnumerable<string> of IDs
foreach(var key in keys)
{
    Console.WriteLine("Current ID: " + key);
} 
```

有关 .NET 客户端和视图的更多信息，请访问[http://blog.couchbase.com/strongly-typed-views-net-client-library](http://blog.couchbase.com/strongly-typed-views-net-client-library)。

--jz

# spss - 在spss中合并文件

> ID：12630955
> 
> 赞同：0
> 
> 时间：2012-09-27T22:28:01.207
> 
> 标签：spss

在spss中合并文件

嗨，我在合并文件时遇到问题。这是我需要做的：我从 ArcMap（GIS 程序）中的 7000 个案例中选择了 200 个案例。在这个过程中，我丢失了一些案例的可变信息。

现在我想将变量返回到我较小的数据集中，并且我使用`data-> merge files > add variables`, 和 ID 作为匹配项`match cases on > keyvariables in sorted files > both files provide cases`。

这给出了所有 7000 个案例的数据集，只有第一个表中已经存在的变量没有添加到合并的数据集中。我也尝试了所有不同的选择，但它们都没有给我想要的结果。这将是添加过程中丢失的变量的 200 个案例。

因此，简而言之，如何在没有来自 A 的额外案例的情况下将变量 A（数据集）的信息合并/替换为变量 B（数据集）（仅 7000 个中选定的 200 个案例的信息）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T07:47:22.837

失控：在缩减的 DataSet 中创建一个值为 1 的新变量。匹配文件。按新变量排序。删除此变量不具有值 1 的所有个案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:22:10.630

我不明白你为什么选择这两个文件提供案例。您希望将 7000 例文件用作键控表，使用 ID 作为键，并将其与提供所有案例的 200 例文件匹配。假设您从所需的大文件中选择了所有变量，这应该会为您提供所需的结果。

# jquery - 如何将 jQuery 延迟对象与 jQuery UI 选项卡一起使用？

> ID：12630963
> 
> 赞同：0
> 
> 时间：2012-09-27T22:28:31.967
> 
> 标签：jquery, jquery-ui-tabs, jquery-deferred

我在将 jQuery 延迟对象与 jQuery UI 选项卡集成时遇到了一些问题。

基本上，我想实现这样的目标：

```
(function($) {
   var tabs;

   function func1 () {
      return $.get(url, function() {
         // ajax call 1
      });
   };

   function loadTabs() {
     return tabs = $('.tabs').tabs({
        ajaxOptions: {
            beforeSend: function(jQXHR, settings) {
                // load spinner image
            },
            complete: function(jqXHR, settings) {
                // destroy spinner image
            }
        }
    })
   };

   $.when(func1(), loadTabs()).then(function() {
      tabs.bind('tabsload', function(event, currentTab) {
         // do something
      }
   });
})(jQuery); 
```

基本上，我认为我不会从选项卡实例化中获得延迟对象。我已经读到升级到 jQuery 1.9 UI 候选版本可能会公开一个 API 来获取延迟对象，但我似乎无法找到该功能的文档。

编辑：我对这个实现的总体目标是在接收到 func1() 和 loadTabs() 的结果时显示我的加载微调器图标。一旦这两个过程完成，我想隐藏/销毁微调器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:48:21.047

为什么不这样做：

```
function myTabs() {
    loadSpinner();
    $.ajax(url, { data: data})
       .done(loadTabsFunction)
       .always(killSpinner)
    ;
}

function loadTabsFunction(response) { }

function loadSpinner() { }

function killSpinner() { }

myTabs(); 
```

# javascript - 为什么这不起作用？jQuery

> ID：12630965
> 
> 赞同：2
> 
> 时间：2012-09-27T22:28:43.470
> 
> 标签：javascript, jquery, jquery-animate, settimeout

单击“#drop a”时，它应该在功能之间切换。这是怎么回事？

```
$(document).ready(function() {
    $('#drop a').toggle(function() {
        $('body').animate({'margin-top': '300px'}, 600);
        setTimeout(function() {
            $('#drop a').css('background-position', '-40px 0px');
        }, 1000);
    }, function() {
        $('body').animate('margin-top': '80px'}, 600);
    });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T22:30:56.643

似乎您忘记了起始括号：

```
// ---------------v
$('body').animate({'margin-top': '80px'}, 600); 
```

这肯定会导致致命错误。

# php - PHP Regex 仅允许具有特定长度的数字

> ID：12630968
> 
> 赞同：0
> 
> 时间：2012-09-27T22:28:58.093
> 
> 标签：php, regex

我正在尝试创建一个 preg_match 测试以仅允许数字。绝对不能使用 is_numeric 或任何变体。

这是否尽可能安全？

```
/^\d*$/ 
```

此外，我将如何设置最小最大范围，例如检查数字在 6 到 10 位之间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:33:33.053

嗯，是的，这很安全。正则表达式正是这样做的……只允许数字。

要指定一定数量，语法如下：

```
/^\d{6,10}$/ 
```

但是，由于这是一个**非常**基本的问题，您可能应该查看[此站点](http://www.regular-expressions.info)。

# c++ - 使用 CMake 为 iOS 编译

> ID：12630970
> 
> 赞同：23
> 
> 时间：2012-09-27T22:29:05.030
> 
> 标签：c++, ios, compilation, cmake, arm

我使用 CMake 作为我的构建工具编译了一个 C++ 静态库，我想将它链接到我的 iOS 应用程序。
我在 Xcode 中创建了一个简单的“空”应用程序，并将名为 libengine.a 的库链接到它。
我试图编译我的 iOS 项目，链接器给了我这个警告：

```
ignoring file /Users/.../build/engine/libengine.a, 
file was built for archive which is not the architecture being linked (i386):
/Users/.../build/engine/libengine.a 
```

据我了解，我需要为 ARM 处理器编译我的库。问题是我不知道怎么做。
我认为 CMake 真的缺乏好的教程。
无论如何，我的 CMake 脚本附在下面。

任何帮助将不胜感激。
谢谢，塔尔。

这是我的主要 CMake 脚本：

```
cmake_minimum_required(VERSION 2.8)

project(movie-night)

if (DEFINED PLATFORM)
    include(toolchains/ios.cmake)
endif()

add_definitions(-Wall)

set(DEBUG)

if (DEFINED DEBUG)
    add_definitions(-g)
endif()

if (DEFINED RELEASE)
    add_definitions(-O3)
endif()

add_subdirectory(engine)
add_subdirectory(ui)

add_subdirectory(test) 
```

这是我的工具链/ios.cmake 文件：

```
set(CMAKE_SYSTEM_NAME Darwin)
set(CMAKE_SYSTEM_PROCESSOR arm) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-27T23:17:38.173

只需使用此工具链文件：[http](http://code.google.com/p/ios-cmake/) ://code.google.com/p/ios-cmake/并将其用作

```
cmake -DCMAKE_TOOLCHAIN_FILE=path_to_your_toolchain_file 
```

然后，在`CMakeLists.txt`：

```
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -arch armv7")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -arch armv7") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2020-04-20T07:57:10.537

通过遵循[cmake-toolchains](https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html#cross-compiling-for-ios-tvos-or-watchos)文档，我如下所示：

```
cmake -G Xcode -B build \
    -DCMAKE_SYSTEM_NAME=iOS \
    -DCMAKE_Swift_COMPILER_FORCED=true \
    -DCMAKE_OSX_DEPLOYMENT_TARGET=11.0 
```

*注意：*以 iOS 为目标时，该分配`CMAKE_OSX_DEPLOYMENT_TARGET=11.0`不是错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-04-05T12:27:55.417

我使用 iOS CMake 工具链的更新版本已经有一段时间了：[https ://github.com/leetal/ios-cmake](https://github.com/leetal/ios-cmake)

这将创建一个 Xcode 项目，如果需要，您可以将其拖到现有的 iOS 项目中。

我写了一篇包含更多详细信息的博客文章：[https ://blog.tomtasche.at/2019/05/how-to-include-cmake-project-in-xcode.html](https://blog.tomtasche.at/2019/05/how-to-include-cmake-project-in-xcode.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-27T22:10:29.620

iOS.cmake 的第二个版本位于：

[https://ceres-solver.googlesource.com](https://ceres-solver.googlesource.com)

注意：您可能会发现这两个版本的 iOS.cmake 都只会构建您项目的 x86 版本。CMake 现在将 CMAKE_OSX_SYSROOT 设置为您系统上可用的（最新）Mac OS X SDK。您可以通过修改您的 iOS.cmake 副本以始终设置 CMAKE_OSX_SYSROOT 来解决此问题。您可以通过注释掉您的 iOS.cmake 副本中的几行来做到这一点：

```
# -- Under CMake 3.4.2, CMAKE_OSX_SYSROOT is automatically defined to point to the latest Mac OS X SDK. --
# -- So, the iOS SDK is never found.  Grab the correct CMAKE_OS_SYSROOT and ignore any prior setting.   --

# If user did not specify the SDK root to use, then query xcodebuild for it.
# if (NOT CMAKE_OSX_SYSROOT)
  execute_process(COMMAND xcodebuild -version -sdk ${XCODE_IOS_PLATFORM} Path
    OUTPUT_VARIABLE CMAKE_OSX_SYSROOT
    ERROR_QUIET
    OUTPUT_STRIP_TRAILING_WHITESPACE)
  message (STATUS "Using SDK: ${CMAKE_OSX_SYSROOT} for platform: ${IOS_PLATFORM}")
  message (STATUS "be sure the previous line points to the correct SDK")
# endif ( ) 
```

# android - ListView 搜索无法识别符号后的单词

> ID：12630976
> 
> 赞同：0
> 
> 时间：2012-09-27T22:29:36.830
> 
> 标签：android, listview, search

我有一个问题。我的一些字符串条目有括号 [即。鲍勃（罗伯特）]。如果我要搜索“罗伯特”，则找不到。有什么我可以做的，添加或更改以允许它在括号、括号、破折号后等中找到单词。

我的代码如下。这来自 androidhive 教程[http://www.androidhive.info/2012/09/android-adding-search-functionality-to-listview/](http://www.androidhive.info/2012/09/android-adding-search-functionality-to-listview/)。我已经为我的目的修改了代码，但我正在显示 androidhive 代码。如何让搜索看到括号中的单词或其他符号？

```
package com.androidhive.androidlistviewwithsearch; 

import java.util.ArrayList; 
import java.util.HashMap; 

import android.app.Activity; 
import android.os.Bundle; 
import android.text.Editable; 
import android.text.TextWatcher; 
import android.widget.ArrayAdapter; 
import android.widget.EditText; 
import android.widget.ListView; 

public class MainActivity extends Activity { 

    // List view 
    private ListView lv; 

    // Listview Adapter 
    ArrayAdapter<String> adapter; 

    // Search EditText 
    EditText inputSearch; 

    // ArrayList for Listview 
    ArrayList<HashMap<String, String>> productList; 

    @Override
    public void onCreate(Bundle savedInstanceState) { 
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.activity_main); 

        // Listview Data 
        String products[] = {"Dell Inspiron", "HTC One X", "HTC Wildfire S", "HTC Sense", "HTC Sensation XE", 
                                "iPhone 4S", "Samsung Galaxy Note 800", 
                                "Samsung Galaxy S3", "MacBook Air", "Mac Mini", "MacBook Pro"}; 

        lv = (ListView) findViewById(R.id.list_view); 
        inputSearch = (EditText) findViewById(R.id.inputSearch); 

        // Adding items to listview 
        adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.product_name, products); 
        lv.setAdapter(adapter); 

        /** 
         * Enabling Search Filter 
         * */
        inputSearch.addTextChangedListener(new TextWatcher() { 

            @Override
            public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) { 
                // When user changed the Text 
                MainActivity.this.adapter.getFilter().filter(cs); 
            } 

            @Override
            public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, 
                    int arg3) { 
                // TODO Auto-generated method stub 

            } 

            @Override
            public void afterTextChanged(Editable arg0) { 
                // TODO Auto-generated method stub 
            } 
        }); 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-08-25T09:46:25.670

可以像这样实现具有默认适配器的自定义过滤器：

```
final ArrayAdapter<Brand>[] itemsAdapter = new ArrayAdapter[]{new ArrayAdapter<Brand>(WatchoutKPIActivity.this, android.R.layout.simple_list_item_1, brands)};
            listView.setAdapter(itemsAdapter[0]);
            EditText searchText = myDialog.findViewById(R.id.search_text);
            searchText.addTextChangedListener(new TextWatcher() {

                public void onTextChanged(CharSequence arg0, int arg1, int arg2,
                                          int arg3) {

                }

                public void beforeTextChanged(CharSequence arg0, int arg1,
                                              int arg2, int arg3) {

                }

                public void afterTextChanged(Editable arg0) {
                    itemsAdapter[0] =
                            new ArrayAdapter<Brand>(WatchoutKPIActivity.this, android.R.layout.simple_list_item_1, filterBrand(arg0.toString(),brands, itemsAdapter[0]));
                    listView.setAdapter(itemsAdapter[0]);

                }
            }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:40:45.697

我现在明白了。问题是提供的默认过滤器是`ArrayFilter`（您可以在[此处](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/ArrayAdapter.java#ArrayAdapter.ArrayFilter)查看代码）。此类假定您需要前缀搜索，因此您永远不会匹配文本开头之后的任何内容；"ob" 不会匹配 "Bob"。获得您想要的行为的唯一方法是扩展您`ArrayAdapter`以提供您自己的`getFilter()`方法实现并返回与您想要的文本匹配的新自定义过滤器。

# java - 我可以创建一个游戏！框架项目并使用现有的 Java 代码？

> ID：12630978
> 
> 赞同：3
> 
> 时间：2012-09-27T22:29:48.587
> 
> 标签：java, playframework

我目前在一个已经有一些纯 Java 代码库的项目中，我们需要开发一个新的 Web 应用程序，它将利用这个纯 Java 代码。

我们已经有了用于数据库访问、一些业务规则等的代码。我真的只想将 Play 用于 Web 开发部分，不想使用 Play 方法对模型进行全新的实现。

在寻找 Java Web 框架时，我的想法是找到可以嵌入到项目中的东西，在我的应用程序中启动服务器（如 Jetty 或其他东西），然后它会处理 Web 部件。但是阅读 Play 的文档我只能找到有关如何运行 Play 的示例，而不是如何将其嵌入到某个项目中。

我想知道的是：我可以将 Play 应用程序嵌入到另一个应用程序中吗？如果没有，我如何在 Play 中使用我已经开发的纯 Java 代码！项目？

感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T13:21:30.560

将您现有的代码作为 Jar 文件提供并从您的 Play 应用程序中调用它。

如果您的应用程序太大/无论出于何种原因无法完成，请在您的应用程序中创建一些 API，Play 可以连接（通过 Web 服务等）并使用它。

我不建议将 Play 嵌入其中，不是因为它无法完成（我相信它可以）而是会很混乱，并且将不同的关注点（网络/无论您的应用程序做什么）分开可能是个好主意更容易维护/升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-03T08:00:58.020

如果你的代码库很小，你可以试试这个解决方案：
把你的代码放到 app/ 文件夹下（应该是 play 生成的）。
此处解释了第 3 方 jars 添加：[http ://www.playframework.com/documentation/2.0.4/SBTDependencies](http://www.playframework.com/documentation/2.0.4/SBTDependencies)

# php - 我使用 curl 概念抓取了数千个电视节目链接 [az]

> ID：12630980
> 
> 赞同：-2
> 
> 时间：2012-09-27T22:29:54.687
> 
> 标签：php

当我运行 curl 数据值被抓取但不完全时，它出现
如下错误。

致命错误：第 70 行的 C:\xampp\htdocs\projectname\includes\simple_html_dom.php 中超过了 30 秒的最大执行时间

**我试过这个但没有用。我想增加最大执行时间** ini_set("memory_limit","34M");

如果有人帮助，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:37:59.477

另一种选择是将您的 PHP 编写为独立程序。许多托管服务允许您将其作为`cron`作业运行，这不受 Web 服务器运行的脚本的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:33:40.643

看看这里[http://php.net/manual/en/function.set-time-limit.php](http://php.net/manual/en/function.set-time-limit.php) 你要找的是`set_time_limit(0);`

# android - 将 GSON 与 Rotten Tomatoes API (Android) 一起使用的问题

> ID：12630986
> 
> 赞同：2
> 
> 时间：2012-09-27T22:30:34.090
> 
> 标签：android, json, gson, rotten-tomatoes

我正在尝试使用 Android 中的 GSON 解析来自烂番茄 API 的 JSON 数据。我可以解析其中的一些，但我似乎在处理基本结果对象中的数组时遇到了问题。

这是我的“MovieObject”类：

```
package ---;

import com.google.gson.annotations.SerializedName;

import java.util.List;

public class MovieObject {

public List<Rating> ratings; //You are a problem

    @SerializedName("id")
    public String id;

    @SerializedName("title")
    public String title;

    @SerializedName("year")
    public int year;

    @SerializedName("mpaa_rating")
    public String mpaaRating;

    @SerializedName("runtime")
    public int runtime;

    @SerializedName("critics_consensus")
    public String criticsConsensu;

    @SerializedName("synopsis")
    public String synopsis;

    @SerializedName("studio")
    public String studio;
} 
```

我可以成功提取诸如`title`，`id`但`year`无法访问我的 Rating 类（`public List<Rating> ratings`）中的字段

这是评级类：

```
package ---

import com.google.gson.annotations.SerializedName;

public class Rating {

    @SerializedName("critics_rating")
    public String criticsRating;

    @SerializedName("critics_score")
    public int criticsScore;

    @SerializedName("audience_rating")
    public String audienceRating;

    @SerializedName("audience_score")
    public int audienceScore;
} 
```

以下是与我如何尝试获取数据相关的活动的一些摘录。在大多数情况下，哪个有效。

```
InputStream source = retrieveStream(url);

        Gson gson = new Gson();

        Reader reader = new InputStreamReader(source);

        MovieObject mObject = gson.fromJson(reader, MovieObject.class); //Expected BEGIN_ARRAY but was BEGIN_OBJECT instead. Something to do with the Rating object I believe.

        Toast.makeText(this, mObject.title, Toast.LENGTH_SHORT).show();
        Toast.makeText(this, mObject.synopsis,Toast.LENGTH_SHORT).show(); 
```

当我尝试做这样的事情时，问题就出现了：

```
List<Rating> ratings = mObject.ratings;
for (Rating rating : ratings) {
    Toast.makeText(this, rating.criticsScore,Toast.LENGTH_SHORT).show();
} 
```

显示的错误是：

> 预期为 BEGIN_ARRAY，但在第 28 行第 362 列为 BEGIN_OBJECT

如果我注释掉`MovieObject`我声明 Ratings 变量的部分......一切正常。所以这似乎是问题所在。但我不知道如何解决这个问题。只进行原生 Android JSON 解析而不是尝试使用 GSON 会更容易吗？还是惹杰克逊？

作为参考，这里是烂番茄响应的 api 查看器：http://jsonviewer.stack.hu/#http: //api.rottentomatoes.com/api/public/v1.0/movies/770672122.json? [apikey =vg2cj5tgqmbkkxz2vgyxqyh9](http://jsonviewer.stack.hu/#http://api.rottentomatoes.com/api/public/v1.0/movies/770672122.json?apikey=vg2cj5tgqmbkkxz2vgyxqyh9)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T22:52:22.793

好吧，那是因为 rating 字段不是数组：

```
"ratings": {
    "critics_rating": "Certified Fresh",
    "critics_score": 99,
    "audience_rating": "Upright",
    "audience_score": 91
  }, 
```

它是一个对象。因此，只需将其声明为`public Ratings ratings;`

`abridged_directors`，例如，是一个列表：

```
"abridged_directors": [
    {
      "name": "Lee Unkrich"
    }
  ], 
```

# java - 找到接口 com.google.gwt.core.ext.typeinfo.JClassType，但预期类

> ID：12630987
> 
> 赞同：1
> 
> 时间：2012-09-27T22:30:40.463
> 
> 标签：java, gwt, maven, maven-plugin

我正在尝试使用带有 gwt-maven-plugin 的 Maven 运行遗留项目。我有以下错误

> 找到接口 com.google.gwt.core.ext.typeinfo.JClassType，但预期类

它与 GWT 2.4.0 连接。有一些关于降级 GWT 或重新编译 gwtp 的答案，但我不明白。

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>gwt-maven-plugin</artifactId>
    <version>2.4.0</version>
    <executions>
        <execution>
            <goals>
                <goal>compile</goal>
                <goal>i18n</goal>
            </goals>
        </execution>
    </executions>

    <configuration>
        <runTarget>someTarget.html</runTarget>
        <hostedWebapp>${webappDir}</hostedWebapp>
        <i18nMessagesBundle>org.I18nMsg</i18nMessagesBundle>
    </configuration>
</plugin>

<pluginManagement>
    <plugins>
        <pluginExecution>
            <pluginExecutionFilter>
                <groupId>
                    org.codehaus.mojo
                </groupId>
                <artifactId>
                gwt-maven-plugin
                </artifactId>
                <versionRange>
                [2.4.0,)
                </versionRange>
                <goals>
                    <goal>i18n</goal>
                </goals>
            </pluginExecutionFilter>
            <action>
                <execute></execute>
            </action>
            </pluginExecution>
        </pluginExecutions>
.... 
```

错误：

```
[INFO]    Scanning for additional dependencies: jar:file:/C:/Users/xxx/.m2/repository/com/extjs/gxt/2.2.0/gxt-2.2.0.jar!/com/extjs/gxt/ui/client/core/El.java
[INFO]       Computing all possible rebind results for 'com.extjs.gxt.ui.client.core.impl.ComputedStyleImpl'
[INFO]          Rebinding com.extjs.gxt.ui.client.core.impl.ComputedStyleImpl
[INFO]             Could not find an exact match rule. Using 'closest' rule <replace-with class='com.extjs.gxt.ui.client.core.impl.ComputedStyleImplIE'/> based on fall back values. You may need to implement a specific binding in case the fall back behavior does not replace the missing binding
[INFO]          Rebinding com.extjs.gxt.ui.client.core.impl.ComputedStyleImpl
[INFO]             Could not find an exact match rule. Using 'closest' rule <replace-with class='com.extjs.gxt.ui.client.core.impl.ComputedStyleImplIE'/> based on fall back values. You may need to implement a specific binding in case the fall back behavior does not replace the missing binding
[INFO]    [ERROR] Errors in 'jar:file:/C:/Users/xxx/.m2/repository/com/extjs/gxt/2.2.0/gxt-2.2.0.jar!/com/extjs/gxt/ui/client/data/BeanModelLookup.java'
[INFO]       [ERROR]  Internal compiler error
[INFO] java.lang.IncompatibleClassChangeError: Found interface com.google.gwt.core.ext.typeinfo.JClassType, but class was expected 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T23:42:03.507

GWT 在过去一两年中对其 API 进行了几次重大更改，而您正在遇到一个围绕 GWT 2.2 进行的更改。您使用的 GXT 版本是 GWT 2.2 发布之前的版本，因此无法自动兼容所有未来版本...

你有几个选择——最干净的就是迁移到更新版本的 GXT——更新的 2.2.x 版本中有三个不同的 jar，你需要 -22 版本，因为它与 GWT 2.2.0 兼容并继续前进（撰写本文时为 2.5.0-rc1）。

如果您无法更新到较新的 GXT 版本，请考虑针对您的 GWT 版本重新编译 GXT。只有少数类需要重新编译，主要是`com.extjs.gxt.ui.rebind`.

如果这是一个全新的项目，请考虑 GXT 3 - 比 2.x 系列更好地利用 GWT 最佳实践、更好的性能和更定期的更新。

# python - 当键是由字符串表示的分数时，如何按值对字典进行排序？

> ID：12630988
> 
> 赞同：2
> 
> 时间：2012-09-27T22:30:39.780
> 
> 标签：python, dictionary

我需要对字典进行排序，其中键是由字符串表示的分数，需要按其数值排序：

IE：

```
exp_time = {"2":10, "1/2":5:, "2.5":11, "1/200":9, "15":3, "1/30":6} 
```

结果应该是这样的（降序）：

```
15
2.5
2
1/2
1/30
1/200 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T22:34:28.377

```
>>> import fractions
>>> exp_time = {"2":10, "1/2":5, "2.5":11, "1/200":9, "15":3, "1/30":6}
>>> sorted(exp_time, key=fractions.Fraction, reverse=True)
['15', '2.5', '2', '1/2', '1/30', '1/200'] 
```

# javascript - 根据数据选择元素

> ID：12630990
> 
> 赞同：1
> 
> 时间：2012-09-27T22:30:48.210
> 
> 标签：javascript, d3.js

我需要根据数据的内容选择一个特定的元素。

假设我有一个包含两个单元格的表格，红色和蓝色。我有一堆表格的数据`["Red", "Blue", "Blue", ... ]`

我的问题是如何根据匹配数据的数量修改适当的单元格。例如，如果有 5 个蓝色和 3 个红色，则蓝色单元格的背景为 #00f，不透明度为 50%，而红色单元格的背景为 #f00，不透明度为 30%。

到目前为止，我只看到`selectAll("p")`了通过过滤修改集合中的所有元素（例如 ）甚至一个小节的功能。

有没有办法根据数据选择特定元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T05:24:35.323

如果可能的话，我会使用 d3 来构建表格：http: [//jsfiddle.net/ztGE9/2/](http://jsfiddle.net/ztGE9/2/)

```
var data = [["Red","Blue","Blue"], ["Red"], ["Blue"], ["Red", "Blue"], ["Red", "Blue", "Red"], ["Red","Red","Red","Red","Blue"]];

var table = d3.select("#container").append("table"),
    tbody = table.append("tbody");

var rows = tbody.selectAll("tr")
                .data(data)
                .enter().append("tr");

var cells = rows.selectAll("td")
    .data(function (row) {
        var tally = {Red:0,Blue:0};
        row.forEach(function(item) {
            tally[item]++;
        });
        return ["rgba(255,0,0,"+ tally["Red"]*0.1 +")",
                "rgba(0,0,255,"+ tally["Blue"]*0.1 +")"];
    })
    .enter()
    .append("td")
    .text("foo")
    .style("background-color", function(d) {
        console.log(d);
        return d;
    }); 
```

如果您的 HTML 已经在其中编码了表格，那么您可以获取每个文本的文本`td`并使用正则表达式来计算事物——无需根据数据本身来选择事物。见这里：http: [//jsfiddle.net/aKtct/](http://jsfiddle.net/aKtct/)。

```
var tds = document.getElementsByTagName("td"),
    forEach = Array.prototype.forEach;

forEach.call(tds, function (td) {
    var redMatch = td.textContent.match(/Red/g),
        redCt = redMatch && redMatch.length || 0,
        blueMatch = td.textContent.match(/Blue/g),
        blueCt = blueMatch && blueMatch.length || 0;
    var rgba = redCt ? "rgba(255,0,0," + 0.1 * redCt + ");" :
                       "rgba(0,0,255," + 0.1 * blueCt + ");";
    td.style.cssText += "background-color:" + rgba;
}) 
```

如果您*真的*想根据数据选择元素，请使用[自定义数据属性](http://html5doctor.com/html5-custom-data-attributes/)和属性选择器，例如`$("#td[data-something='RedRedRedBlue']")`.

# html - 将链接 div 移到 h1 旁边，标语 p 上方

> ID：12630996
> 
> 赞同：0
> 
> 时间：2012-09-27T22:31:08.943
> 
> 标签：html, css, web

我有一个包含 CSS 媒体查询的页面，我被要求这样做：

移动布局： ![移动布局](../Images/0c88cb38666240adf1ed14e1963bd116.png)

桌面布局： ![桌面布局](../Images/e0ab4d7f4f711af9f9c72c0fd981c696.png)

现在，HTML 代码是这样放置的：

```
<div id="content">
  <h1>the title</h1>
  <p>this is the tagline of the site</p>
  <ul>
    <li>link 1</li>
    <li>link 2</li>
    <li>link 3</li>
  </ul>
</div> 
```

我在尝试实现桌面布局时遇到了很大的问题。我尝试用 包装`<h1>`并设置它`<p>`的`<div>`样式`float: left`，但它看起来不像要求的那样（标语更宽）。我也尝试`position: absolute`了`<ul>`，但看起来也没有按照要求（使`#content`更宽不是一个选项）。

您有什么建议可以在不使用 javascript 的情况下实现这一目标吗？

**更新：**

我已将代码上传到[我的 Koding](http://noquierouser-prime.koding.com/h1tagline/index.html)，因此您可以看到我实际在做什么。[这是 CSS](http://noquierouser-prime.koding.com/h1tagline/styles.css)。我也在使用[normalize.css](http://necolas.github.com/normalize.css/)。

我现在遇到的问题是不同的浏览器显示什么： ![浏览器显示什么](../Images/2b7ba426e864cbcc685489b90e1ee784.png)

我认为问题可能在于浏览器如何计算标语的宽度，但是您可以尝试使用代码，如果您使标语的文本更短，它看起来更像是 Opera 的渲染。

我是否偶然发现了一个错误，或者我在我的 CSS 中犯了一些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:43:40.137

`float: left`在`<h1>`和 中使用`<p>`。不在`<ul>`. 之后，将`<p>`宽度设置为 100% 并将上边距设置为`<ul>`.

为了让所有`<li>`并排，您将它们设置为`display: inline`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T22:32:30.883

确保`ul`有足够的空间将`li`' 放在一起。

```
width: 1million px; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T22:55:27.423

不是很优雅，但你可以尝试这样的事情......

**CSS**

```
h1, ul, li {
    float: left;
}
h1 {
    height: 48px;
}
p {
    position: absolute;
    margin-top: 48px;
}
ul {
    padding-top: 12px;
} 
```

**[jsFiddle](http://jsfiddle.net/jTych/)**

# php - PHP 表单 -- 检查文件是否已附加

> ID：12630999
> 
> 赞同：0
> 
> 时间：2012-09-27T22:31:24.700
> 
> 标签：php, forms, validation, contact-form

我有一个 php 联系表单，该表单当前验证附件的文件类型和文件大小，*但*我还需要它来检查用户是否完全忘记附加图像（即，照片附件应该是“必填字段”并抛出'如果有，请附上照片信息）。

有问题的表格：

[http://www.cucinadellanonna.com/nominate-form.php](http://www.cucinadellanonna.com/nominate-form.php)

这是检查附件的代码部分......我尝试添加一些东西，但无济于事，所以我只是在黑暗中刺伤。

```
//file upload validation

     if(!empty($this->fileupload_fields))
    {
     if(!$this->ValidateFileUploads())
     {
        $ret = false;
     }
    }
    return $ret;
}

function ValidateFileType($field_name,$valid_filetypes)
{
    $ret=true;
    $info = pathinfo($_FILES[$field_name]['name']);
    $extn = $info['extension'];
    $extn = strtolower($extn);

    $arr_valid_filetypes= explode(',',$valid_filetypes);
    if(!in_array($extn,$arr_valid_filetypes))
    {
        $this->add_error("Valid file types are: $valid_filetypes");
        $ret=false;
    }
    return $ret;
}

function ValidateFileSize($field_name,$max_size)
{
    $size_of_uploaded_file = 
            $_FILES[$field_name]["size"]/1024;//size in KBs
    if($size_of_uploaded_file > $max_size)
    {
        $this->add_error("The file is too big. File size should be less than $max_size KB");
        return false;
    }
    return true;
}

function IsFileUploaded($field_name)
{
    if(empty($_FILES[$field_name]['name']))
    {
        return false;
    }
    if(!is_uploaded_file($_FILES[$field_name]['tmp_name']))
    {
        return false;
    }
    return true;
}
function ValidateFileUploads()
{
    $ret=true;
    foreach($this->fileupload_fields as $upld_field)
    {
        $field_name = $upld_field["name"];

        $valid_filetypes = $upld_field["file_types"];

        if(!$this->IsFileUploaded($field_name))
        {
            continue;
        }

        if($_FILES[$field_name]["error"] != 0)
        {
            $this->add_error("Error in file upload; Error code:".$_FILES[$field_name]["error"]);
            $ret=false;
        }

        if(!empty($valid_filetypes) &&
         !$this->ValidateFileType($field_name,$valid_filetypes))
        {
            $ret=false;
        }

        if(!empty($upld_field["maxsize"]) &&
        $upld_field["maxsize"]>0)
        {
            if(!$this->ValidateFileSize($field_name,$upld_field["maxsize"]))
            {
                $ret=false;
            }
        }

    }
    return $ret;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T23:12:56.450

如果没有文件上传，以下语句将返回 0：

```
count($_FILES); 
```

您可以在 if 语句中使用它来确定是否保留了文件以准备移动和重命名。

```
function IsFileUploaded($field_name)
{
    if(count($_FILES) > 0)
    {
        if(empty($_FILES[$field_name]['name']))
        {
            return false;
        }
        if(!is_uploaded_file($_FILES[$field_name]['tmp_name']))
        {
            return false;
        }
        return true;
    }
    else
    {
        return false;
    }
} 
```