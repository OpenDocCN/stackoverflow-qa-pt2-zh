# StackOverflow 问答 13954000-13954999

# iphone - 从另一个选项卡重新加载 UITableView

> ID：13954003
> 
> 赞同：3
> 
> 时间：2012-12-19T13:59:34.257
> 
> 标签：iphone, objective-c, uitableview, ios5

我在尝试重新`UITableView`加载从 XML 源加载的单元格数据时遇到问题。

这是场景。应用程序包含选项卡，其中一个有一个表格视图，它从 XML 文件中获取数据并且工作正常，但问题是当我想更改提要类别并从另一个选项卡更改 XML 时，我可以刷新当前的表格视图. 为了在我使用的标签之间切换

```
self.tabBarController.selectedIndex = 1; 
```

并将类别提要传递给我要加载的另一个选项卡

```
xmlParser = [[XMLParser alloc] loadXMLByURL:categories]; 
```

它仍然加载相同的旧提要，而不是已通过的新提要。我检查过`NSLog`，提要值正确传递，但切换后不会加载。

我还尝试`[self.tableView reloadData];`从当前选项卡和类别选项卡中进行，但它也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:03:44.553

您可以使用 NSNotifications 从您的其他选项卡发送通知，并在您的 tableview 中有一个响应该通知的 oberver。

例子

（选项卡调用 tableview 的重新加载）每当您想重新加载数据时放置此代码，因此当按下按钮或下载完成等时。

```
NSNotification * notification = [NSNotification notificationWithName:@"updateTable" object:nil];
[[NSNotificationCenter defaultCenter] postNotification:notification]; 
```

在 UITableViewController / 带有 UITableView 的类中，执行以下操作。

在您的 viewDidLoad 添加：

```
[[NSNotificationCenter defaultCenter] addObserver:self  selector:@selector(updateTableView) name:@"backtolist" object:nil]; 
```

然后添加函数updateTableView

```
- (void) updateTableView: (NSNotification*) note
{
    //Do whatever needs to be done to load new data before reloading the tableview
    [_tableView reloadData];
} 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:33:35.610

Ophychius 使用通知的建议是正确的。我假设您在 XML 完成加载后更新了表格视图的所有数据源。这也假设您使用的是动态单元格。在加载 XML 的类中，在新 XML 完成加载时发布通知。

```
 [[NSNotificationCenter defaultCenter] postNotificationName:@"XMLLoaded" object:nil]; 
```

在表视图类中，注册为您从 XML 类发布的通知的观察者。

```
 [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(reloadTable:) name:@"XMLLoaded" object:nil]; 
```

如您所见，当收到此通知时，它会调用选择器。要么调用构建表的方法，要么创建另一个简单的方法来调用 reloadData。

```
-(void)reloadTable:(NSNotification *)notif
{
    NSLog(@"In ReloadTable method. Recieved notification: %@", notif);

    [self.tableView reloadData];
} 
```

最后（正如莱昂纳多在下面指出的），在您的 viewDidUnload（或 ios6 的 dealloc）方法中，删除该类作为该通知的观察者。

```
- (void)viewDidUnload
{
    [super viewDidUnload];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:31:03.903

我只是猜测，没有看到其余的代码。

我想你的表视图有一个 NSArray 数据源，你确定你的数组数据源也更新了吗？您的 xml 解析器或控制器是否将这些数据传输到 NSArray ？

因为如果您调用 reloadData 它只会重新获取相同的数组。如果它没有更新，你会得到旧数据。

# svm - 如何设置 LIBSVM Matlab 接口？

> ID：13954007
> 
> 赞同：5
> 
> 时间：2012-12-19T13:59:54.727
> 
> 标签：svm, matlab, libsvm

我在将 LibSVM 实现到 MATLAB 时遇到问题。我正在使用 MATLAB R2009a（我也有最新版本，R2012b，但我不使用那个）我将 LibSVM 包 libsvm-3.14 下载到我的 Windows 7 PC 上，其中 MATLAB 和 OCTAVE 接口结合在一起。

我提取了我下载的文件夹。在下面，您可以看到文件夹中包含的内容的打印屏幕。![在此处输入图像描述](../Images/588e7aaab5cb9fe716330f5a3ca3125a.png)

我应该把我的 libsvm-3.14 提取文件夹放在哪里？我应该把它放在安装在目录中的 MATLAB 的“bin”文件夹下吗？

> C:\Program Files\MATLAB\R2009a\bin

我这样做了，然而，它没有成功。如果您清楚地帮助我，我将不胜感激。我只是看了README文件，但看不懂，网上也没有其他说明。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:23:50.190

目前，将该文件夹放在哪里并不重要。您必须从提取的 libsvm 包的*matlab子文件夹中的源代码编译 Matlab-MEX 文件。*

下面，我将调用libsvm-3.14（例如：C:\libsvm-3.14）解压的文件夹ROOT（所以下面用C:\libsvm-3.14替换ROOT）。

因此，启动 Matlab，然后在其命令提示符下键入：

```
cd ROOT
cd matlab
make 
```

现在，在 ROOT/matlab 文件夹中，您应该已经获得了两个 MEX 文件（扩展名为 .mexw32 或 .mexw64）。这些是您将从现在开始使用的文件。您可以丢弃其余的，除了那些文件（也许还有其他一些生成的库）。

根据 Makefile（即 ROOT/matlab/make.m），MEX 文件称为 svmtrain 和 svmpredic（+ 扩展名）。

因此，下一步是在您的 Matlab/toolbox 文件夹下创建一个名为 libsvm/ 的子文件夹，复制其中的两个 MEX 文件，然后将该 libsvm/ 文件夹添加到 Matlab 路径（不是您系统的路径，而是您的Matlab 安装）。

然后，通过键入：

```
svmtrain 
```

和

```
svmpredict 
```

你应该有这两个功能的帮助（使用）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T08:27:52.577

在@axeoth 的帮助下，这是解决方案。我按照提取的 libsvm 包的 matlab 子文件夹中的说明文件进行操作。我下载并安装了 Microsoft Visual Studio 2010 并在 MATLAB 的命令窗口上编写了“mex -setup”来为 mex 选择合适的编译器（我在 32 位 PC 中使用 MATLAB R2012b，所以我在此链接中找到了支持的编译器[http:// www.mathworks.com/support/compilers/R2012b/win64.html](http://www.mathworks.com/support/compilers/R2012b/win64.html)）之后，我按照@axeoth的指示进行操作。我将文件夹的名称更改为 ROOT 并将其移至 Documents/MATLAB。我启动了 MATLAB 并在命令窗口上，我在下面“一个一个”地写了这些

> >> cd C:\Users\HUstat\Documents\MATLAB\ROOT\matlab
> >> cd matlab
> >> make

然后我复制了在 ROOT/matlab 子文件夹中获得的所有内容。我在 MATLAB/toolbox 文件夹下创建了一个名为 libsvm 的新文件夹，并将所有内容粘贴在那里。然后，我使用 MATLAB R2012b 上的“设置路径”按钮将该 libsvm/ 文件夹添加到 Matlab 路径中。之后我写了“svmtrain”和“svmpredict”，所以我得到了这两个命令的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-29T08:47:07.740

对于那些有重大编译器问题的人，我想我会留下一些关于安装编译器主题的额外信息。这是一个令人沮丧的问题，我最终联系了 MATLAB 寻求帮助。我会在上面的帖子中发表评论，但我没有足够的“代表”所以这里是：

我无法通过 Microsoft Visual Studio 2010 或其他方式安装 Microsoft Windows SDK 7.1。我发现这是因为我安装了某个版本的 Microsoft Visual （版本 10.0.04 ......对我来说是问题的原因）。解决方法是卸载 Visual，独立安装 SDK 7.1，然后重新安装 Visual。该过程更详细地写在下面的链接中：

[http://www.mathworks.com/matlabcentral/answers/95039-why-does-the-sdk-7-1-installation-fail-with-an-installation-failed-message-on-my-windows-system](http://www.mathworks.com/matlabcentral/answers/95039-why-does-the-sdk-7-1-installation-fail-with-an-installation-failed-message-on-my-windows-system)

也可能是您安装了编译器，但直到 MATLAB“找到”它才被识别。重新安装后发生在我身上。要检查您是否拥有正确的编译器并“找到”它，请运行 mex.getCompilerConfigurations('Any','Installed') 以获取完整列表。然后使用 SDK 7.1 执行 mex -setup，选择 C/C++ 版本而不是 FORTRAN。

我知道这个问题已经得到解答，但希望这可以帮助遇到我同样困境的人。

# android - 使用OpenCV从帧中提取像素向量？

> ID：13954008
> 
> 赞同：0
> 
> 时间：2012-12-19T13:59:55.597
> 
> 标签：android, image-processing, opencv, pixels

我实际上是在 android 上的一个项目中工作，我想在其中提取一些特定的像素值（根据条件，使用阈值方法，我已将一些像素设置为某个值，而将所有其他像素设置为零）我想在向量中提取所有这些不同于零的值。我将使用所选像素的这个向量来做一些操作（例如平均值），OpenCV 中是否有一种方法可以帮助我做到这一点？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:36:26.300

我不知道这样的功能，但实际上实现它并不难（c++）：

```
//'in' should be CV_8UC3
vector<int>& getNonZero(const Mat& in)
{
    //get size of result vector
    //this is all non-zero pixels:
    int count = countNonZero(in);
    vector<int>& result(count);
    int k = 0;

    for (int r = 0; r < in.rows; ++r)
    {
        for (int c = 0; c < in.cols; ++c)
        {
          if (in.at<int>(r, c))
          {
              result[k++] = in.at<int>(r, c);
          }
        }
    }

    return result;
} 
```

而且许多 OpenCV 函数都有`InputArray mask`参数，所以使用它！例如：

[`void meanStdDev(InputArray src, OutputArray mean, OutputArray stddev, InputArray mask=noArray())`](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#void%20meanStdDev%28InputArray%20src,%20OutputArray%20mean,%20OutputArray%20stddev,%20InputArray%20mask%29)

# c# - WPF DynamicDataDisplay 模板轴标签，带有基于值的图标图像

> ID：13954016
> 
> 赞同：3
> 
> 时间：2012-12-19T14:00:22.130
> 
> 标签：c#, wpf, xaml

在为 WPF 搜索开放图表库时，我找到了[DynamicDataDisplay](http://dynamicdatadisplay.codeplex.com)库。

但是，我找不到一种方法（可能是由于文档不佳）根据值格式化它们包含图像的轴标签。

为什么我需要这个？

我目前正在编写一个跟踪游戏市场价格的工具（GW2）。

这些价格显示为黄金、白银和铜，我根据铜值获得价格，我希望垂直轴显示价格。

所以希望有人知道一种方法来模板化 D3 的轴标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:39:15.707

感谢 Mikhail Brinchuk 为我指明了正确的方向。这是我想出的解决方案：

```
<Window x:Class="ChartTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d3="http://research.microsoft.com/DynamicDataDisplay/1.0"
    xmlns:chart="clr-namespace:ChartTest.Chart"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <chart:MoneyLabelProvider x:Key="MoneyLabelProvider"></chart:MoneyLabelProvider>
</Window.Resources>
<Grid>
    <d3:ChartPlotter x:Name="Plotter">
        <d3:ChartPlotter.VerticalAxis>
            <d3:VerticalIntegerAxis x:Name="Axis" LabelProvider="{StaticResource MoneyLabelProvider}">
            </d3:VerticalIntegerAxis>
         </d3:ChartPlotter.VerticalAxis>

        <d3:ChartPlotter.HorizontalAxis>
            <d3:HorizontalDateTimeAxis x:Name="DateTimeAxis">
            </d3:HorizontalDateTimeAxis>
        </d3:ChartPlotter.HorizontalAxis>
    </d3:ChartPlotter>
</Grid> 
```

```
public class MoneyLabelProvider : GenericLabelProvider<int>
{
    public override System.Windows.UIElement[] CreateLabels(Microsoft.Research.DynamicDataDisplay.Charts.ITicksInfo<int> ticksInfo)
    {
        var customElements = new UIElement[ticksInfo.Ticks.Length];

        for (int i = 0; i < customElements.Length; i++)
        {
            var mv = new MoneyView(); // View provides the money style format
            var money = new Money(0, 0, ticksInfo.Ticks[i]); // Data class provides the calculation
            mv.DataContext = money; // Bind the data to the view

            customElements[i] = mv;
        }

        return customElements;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:23:33.380

Axis 包含一个 LabelProvider 属性。您可以创建自定义标签提供程序，并在重写方法 CreateLabels 中创建您需要的所有控件。

# iphone - 由于 Iphone 中的“应用程序因信号 9 异常退出”或“应用程序因信号 11 异常退出：分段错误”而导致应用程序崩溃

> ID：13954018
> 
> 赞同：2
> 
> 时间：2012-12-19T14:00:29.730
> 
> 标签：iphone, ios, segmentation-fault, sdwebimage

在我的 iPhone 应用程序中，我使用了大量图像并加载到 tableview 中。我正在使用 SDWebimage。滚动时出现“应用程序异常退出，信号 9”或“信号 11：分段错误”。如何解决此问题。请帮忙！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-02T10:33:16.223

iOS 看门狗正在扼杀你的应用程序。此机制会在某些条件下终止您的应用程序，包括：

*   **可用内存变得太低**

*   您的应用程序在关键部分花费的时间太长，例如启动时间

欲了解更多信息，请阅读：

[https://developer.apple.com/library/ios/qa/qa1693/_index.html](https://developer.apple.com/library/ios/qa/qa1693/_index.html)

[http://www.raywenderlich.com/23704/demystifying-ios-application-crash-logs](http://www.raywenderlich.com/23704/demystifying-ios-application-crash-logs)

引用第二个链接：

> 什么会生成崩溃日志？
> 
> 有两种主要情况会导致崩溃日志： 您的应用违反了操作系统政策。您的应用程序中存在错误。iOS 政策违规包括启动、恢复、暂停和退出时的看门狗超时；用户强制退出；**和低内存** **终止**。让我们更详细地讨论这些......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:06:14.147

看门狗会杀了你，因为你消耗了太多的内存。尝试处理 didReceiveMemory 警告

```
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
} 
```

# sencha-touch-2 - 在 Sencha Touch 2 中使用 NavigationView

> ID：13954019
> 
> 赞同：0
> 
> 时间：2012-12-19T14:00:29.997
> 
> 标签：sencha-touch-2, sencha-touch-2.1

我正在尝试使用 Sencha Touch 2 并遇到了 NavigationView 的问题，因为它不起作用......每次我尝试推送视图时都会收到错误`Uncaught TypeError: Cannot call method 'apply' of undefined`，我不知道为什么......

如果我在导航视图的配置部分初始化第一个视图，它工作正常，但如果我尝试将完全相同的视图推送到 NavigationView 中，我会收到错误...

这是我的视图和控制器的一些代码：

控制器：

```
Ext.define('svmobile.controller.MyController', {
    extend: 'Ext.app.Controller',
    alias: 'widget.mycontroller',

    config: {
        refs: {
            mainView:   'main',
        }
    },

    launch: function() {
        this.callParent(arguments);
        Ext.Viewport.add(Ext.create('svmobile.view.Main'));
        this.getMainView().getNavigationBar().add(
            {
                xtype: 'navbutton',
                align: 'right'
            }
        );

        this.getMainView().push(       //This is not working
            {
                xtype: 'hostspie'
            }
        );
    },
... 
```

导航视图：

```
Ext.define('svmobile.view.Main', {
    extend: 'Ext.navigation.View',
    xtype: 'main',
    alias: 'widget.main',

    config: {
        items: {               //This way it works
            xtype: 'hostspie'
        }
    }
}); 
```

要推送的视图：

```
Ext.define('modules.nagios.view.HostsPie', {
    extend: 'Ext.Panel',
    alias: 'widget.hostspie',

    requires: [
        ...
    ],

    config: {
        layout: 'fit',
        title: 'Dashboard',

        items: [
            {
                xtype: 'polar',
                ...
            }
        ]
    }
}); 
```

任何想法为什么它不能正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:58:41.170

感谢您的建议。最后我得到了它。是按钮的实现导致了问题。现在可以了，谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T10:14:57.803

您是否尝试定义

```
Ext.define('modules.nagios.view.HostsPie', {
extend: 'Ext.Panel',
alias: 'widget.hostspie',

xtype: 'hostspie', 
```

?

# git - git如何克隆和跟踪所有分支

> ID：13954021
> 
> 赞同：0
> 
> 时间：2012-12-19T14:00:35.627
> 
> 标签：git, git-clone

> **可能重复：**
> [是否可以从远程位置克隆 git config？](https://stackoverflow.com/questions/6547933/is-it-possible-to-clone-git-config-from-remote-location)

如标题所示，如何克隆存储库并立即自动跟踪所有远程分支？

当我克隆远程仓库时，它只跟踪`origin/master`，然后我需要手动跟踪其他远程分支。有没有办法自动做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:11:45.047

不太明白这个问题，但是...

克隆时，您确实可以访问所有分支，它们都在原点。

看一个`git checkout other_branch_name`

如果这些分支随后在服务器上得到更新，您只需要`git fetch`获取所有最新版本以及已添加的任何新分支。

git fetch 只会将它们放在 origin/ 中。它们不会被合并到您当前的分支中，除非您执行 a `git merge`（或 a`git pull`其中执行`fetch`AND a `merge`- 但我现在主要避免这样做，因为如果您失去对什么是什么的关注，这是非常危险的）。

# sql - 如何对 ListView 列进行排序（来自 SQL 表的数据）

> ID：13954022
> 
> 赞同：0
> 
> 时间：2012-12-19T14:00:40.717
> 
> 标签：sql, vb.net, listview, sorting

从数据库表中检索数据时，如何通过单击列标题对数据进行排序？

有没有一种简单的方法，或者我需要响应标题的“点击”事件以在我的查询中调用“ORDER BY”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:21:11.020

我通过以下链接弄清楚了：

*   [如何：对 ListView 项进行排序 (MSDN)](http://msdn.microsoft.com/en-us/library/ms229643%28v=vs.80%29.aspx)

在第三步，我没有手动添加我的项目，但它仍然有效。

# c# - 如何更新由另一个组合框触发的组合框中的值？

> ID：13954023
> 
> 赞同：2
> 
> 时间：2012-12-19T14:00:46.653
> 
> 标签：c#, winforms, combobox

我在一个表单中有 2 个组合框。

当combobox2 中的列表更新时，我希望combobox1 中的选定值发生变化。

例如：ComboBox1 包含移动公司的名称，ComboBox2 包含该公司所有手机的列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:11:42.197

假设您有一个将手机型号与其制造商相关联的字典：

```
Dictionary<string, string[]> brandsAndModels = new Dictionary<string, string[]>();

public void Form_Load(object sender, EventArgs e)
{
    brandsAndModels["Samsung"] = new string[] { "Galaxy S", "Galaxy SII", "Galaxy SIII" };
    brandsAndModels["HTC"] = new string[] { "Hero", "Desire HD" };
} 
```

您可以获得要在左侧组合框中显示的项目：

```
foreach (string brand in brandsAndModels.Keys)
    comboBox1.Items.Add(brand); 
```

您只需执行一次，例如在表单的`Load`事件中。注意：`brandsAndModels`字典必须是实例变量，而不是局部变量，因为我们稍后需要访问它。

然后，您必须为该事件分配一个事件处理程序`SelectedIndexChanged`，在其中将第二个组合框中的项目替换为所选品牌的数组中的项目：

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    comboBox2.Items.Clear();

    if (comboBox1.SelectedIndex > -1)
    {
        string brand = brandsAndModels.Keys.ElementAt(comboBox1.SelectedIndex);
        comboBox2.Items.AddRange(brandsAndModels[brand]);
    }
} 
```

如果所有这些都来自数据库，那么使用数据绑定会更好，如我在评论中链接到您的问题的问题的答案中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:03:23.127

您必须处理`SelectedIndexChanged`组合框的事件才能实现

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T15:02:19.687

当您看起来很新时，我将逐步向您解释。

1.  右键单击 ComboBox1 并选择属性。
2.  这将打开属性面板。
3.  从属性面板顶部选择事件按钮。
4.  将显示与组合框相关的所有事件列表。
5.  从此列表中双击 SelectedIndexChanged。
6.  private void comboBox1_SelectedIndexChanged(object sender, EventArgs e) {} 将被创建

您可以在此之后使用以下代码。

```
Dictionary<string, string[]> models = new Dictionary<string, string[]>();
public Form1()
{
    InitializeComponent();

    //initializing combobox1
    comboBox1.Items.Add("Select Company");
    comboBox1.Items.Add("HTC");
    comboBox1.Items.Add("Nokia");
    comboBox1.Items.Add("Sony");

    //select the selected index of combobox1
    comboBox1.SelectedIndex = 0;

    //initializing model list for each brand
    models["Sony"] = new string[] { "Xperia S", "Xperia U", "Xperia P" };
    models["HTC"] = new string[] { "WildFire", "Desire HD" };
    models["Nokia"] = new string[] { "N97", "N97 Mini" };
}

private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    comboBox2.Items.Clear();

    if (comboBox1.SelectedIndex > -1)
    {
        string brand = comboBox1.SelectedItem.ToString();
        if(brand != "" && comboBox1.SelectedIndex > 0)
            foreach (string model in models[brand])
                comboBox2.Items.Add(model);
    }
} 
```

# javascript - 访问 javascript 对象中的属性的奇怪行为

> ID：13954025
> 
> 赞同：10
> 
> 时间：2012-12-19T14:00:56.607
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-autocomplete

我正在尝试访问对象中的值：

```
<input type="text" name="address-search" 
       placeholder="43 Roxling Drive Boston, MA" 
       class="ui-autocomplete-input ui-corner-all" autocomplete="off">

select: function( event, ui ) {
    console.log(ui);
    $('input[name="address-search"]').val(ui.item.label);
} 
```

这是`console.log`调用的结果：

![在此处输入图像描述](../Images/35b14b0bca4ec545cd3d1f47af34a512.png)

这是奇怪的一点：

如果`console.log(ui.item.label)`我得到：`Boston, Massachusetts, United States`。

如果我打电话`$('input[name="address-search"]').val(ui.item.label);`，我只会得到`Boston`. 任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:07:35.340

来自 jQuery UI 自动完成文档：

> **选择**
> 
> 当从菜单中选择一个项目时触发。默认操作是将文本字段的值替换为所选项目的值。取消此事件可防止值被更新。[...]

这里会发生什么：您将输入中的值替换为“自动完成”小部件 - 但随后小部件会自行替换它。) 添加`return false;`到您的功能以使其工作。

作为旁注，您不必再次查找该元素的 DOM：

```
this.value = ui.item.label; 
```

...应该做的伎俩。)

# nuget - Kendo UI 服务器端包装器

> ID：13954030
> 
> 赞同：3
> 
> 时间：2012-12-19T14:01:13.893
> 
> 标签：nuget, kendo-ui, nuget-package

Kendo UI 服务器端包装器是否有 nuget 包？我知道有一个安装 jquery + 所有 kendo js 文件的 nuget 包，但它不包括我关心的 kendo.mvc.dll。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:52:48.930

Telerik 不打算为 Kendo UI 服务器端包装器创建 Nuget 包。以下是 2012 年 7 月的讨论主题：

[http://www.kendoui.c​​om/forums/mvc/general-discussions/nuget-install-for-kendoui-mvc.aspx](http://www.kendoui.com/forums/mvc/general-discussions/nuget-install-for-kendoui-mvc.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T08:09:34.583

一旦我们实现了一个自托管的 nuget 服务，我们 (Telerik) 就可以为 ASP.NET MVC 的 Kendo UI 创建一个 Nuget 包。这是许可证验证所必需的，因为 ASP.NET MVC 的 Kendo UI 是商业产品。总之，这并非完全不可能，但需要一些基础设施的改变。仍然没有明确的截止日期。

# apk - 从 html 文件创建 .APK 文件

> ID：13954031
> 
> 赞同：0
> 
> 时间：2012-12-19T14:01:13.813
> 
> 标签：apk

我想要一些脚本或 dll，这些脚本或 dll 可以让我从我编写的软件中创建一个 .apk 文件。

所以基本上我的软件创建了一个网站。在我的程序中，我想调用一个 dll 或一些脚本，以便将该站点转换为 apk。我需要将参数传递给它

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:07:59.560

我认为你应该看看[Phonegap 的网站](http://phonegap.com "电话间隙")并设置 android 开发环境来创建 android 应用程序 apk 文件。Phonegap 帮助您轻松地在 html 中创建 android 应用程序。在那里，您可以使用 iframe 将网站转换为基于 phonegap 的 android 应用程序。

# python - Tornado MySQLDB SSL 连接

> ID：13954037
> 
> 赞同：2
> 
> 时间：2012-12-19T14:01:47.420
> 
> 标签：python, ssl, tornado, mysql-python

我正在使用龙卷风并使用 MySQLDB 连接到 MySQL。如何使用 SSL 连接到 MySQL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T05:26:51.470

如果 MySQL 服务器与 Web 服务器位于同一主机上，那么您实际上不需要这样做，因为流量不会离开该框。如果您愿意，可以使用 ssh 隧道来加密流量。像下面这样的东西应该可以解决问题：

```
$ ssh <mysql_port>:localhost:<mysql_port> user@mysqlserver.host 
```

这将创建一个从您的 MySQL 服务器到 Web 服务器的隧道。然后，您可以连接到`localhost:port`而不是`mysqlserver.host:port`.

# mongodb - MongoDB - 如何在集合和嵌入文档中找到等于

> ID：13954040
> 
> 赞同：2
> 
> 时间：2012-12-19T14:01:51.883
> 
> 标签：mongodb

大师 - 我陷入了一种情况，我无法弄清楚如何从以下集合“配偶”中查询，该集合嵌入了文档“姓氏”并检查与该文档的“姓氏”是否相等：

```
{
  "_id" : ObjectId("50bd2bb4fcfc6066b7ef090d"),
  "name" : "Gwendolyn",
  "surname" : "Davis",
  "birthyear" : 1978,
  "spouse" : {
    "name" : "Dennis",
    "surname" : "Evans",
    "birthyear" : 1969
  }, 
```

我需要查询：

> 输出所有具有相同姓氏的配偶的数据（如果其中一个配偶的姓氏没有指定，假设它与另一个配偶的名字一致）

我试过这样的事情：

> db.task.find（{“姓氏”：{“配偶姓氏”：1}}）

但它失败了）

请指导我如何实现任何示例/示例？基于此将非常有帮助:-)

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:13:46.557

你有三个选择。

1.  使用`$where`修饰符：

    `db.task.find({$where: 'this.spouse.surname === this.surname'})`

2.  更新所有文件并添加特殊标志。之后，您将能够通过此标志查询文档。这样会更快`$where`，但需要更改您的数据。

3.  使用[MapReduce](http://docs.mongodb.org/manual/applications/map-reduce/)。这很复杂，但它几乎可以让你做任何事情。

# r - 获取与上月末的差额

> ID：13954041
> 
> 赞同：4
> 
> 时间：2012-12-19T14:01:54.193
> 
> 标签：r, data.table

每天 (TRADEDATE) 我有一个由 BOOK 和 COMMODITY 唯一标识的条目。每个条目都有一个每日变化的现值 (PV)。我想得到一个列，其中包含 PV 与上个月最后一个日历日的差异。我通过循环解决了它，但我想知道是否有人可以提出更优雅（更快的解决方案）：

```
library(data.table)

bwTab
COMMODITY       BOOK   TRADEDATE PV Desired Column
   1:      CASH HS_OPT_GEN 2012-09-30 66669.68  NA
   2:      CASH HS_OPT_GEN 2012-10-01 76333.83  9664.15
   3:      CASH HS_OPT_GEN 2012-10-02 76333.83  9664.15
   4:      CASH HS_OPT_GEN 2012-10-03 76333.83  9664.15
   5:      CASH HS_OPT_GEN 2012-10-04 76333.83  9664.15
  ---     
3050:       OIL HO_OIL_FIN 2012-09-30 21330.55  NA
  ---     
3066:       OIL HO_OIL_FIN 2012-10-26 42661.28  21330.73
3067:       OIL HO_OIL_FIN 2012-10-27 21330.69  0.14
3068:       OIL HO_OIL_FIN 2012-10-28 21330.68  0.13
3069:       OIL HO_OIL_FIN 2012-10-29 21330.78  0.23

# Here is my solution

# Define a function for last day of previous month
pme <- function(date) {as.Date(paste("01",month(date),year(date),sep="."),"%d.%m.%Y")-1}

difftopme <- function(a) {

if (nrow(bwTab[COMMODITY==a[,COMMODITY] & BOOK==a[,BOOK] & TRADEDATE==pme(a[,STICHTAG]),])==0) {NA} else {
    a[,PV]-bwTab[COMMODITY==a[,COMMODITY] & BOOK==a[,BOOK] & TRADEDATE==pme(a[,TRADEDATE]),PV] }
}

for (i in 1:nrow(bwTab)){a <- difftopme(bwTab[i,]) ; if (i==1){diffPVme <- a} else {diffPVme <- c(a,diffPVme)}}

#########################
dput(bwTab[1000:1010,])
structure(list(COMMODITY = c("ELEC", "ELEC", "ELEC", "ELEC", 
"ELEC", "ELEC", "ELEC", "ELEC", "ELEC", "ELEC", "ELEC"), BOOK = c("HS_OUK_MKT", 
"HS_OUK_MKT", "HS_OUK_MKT", "HS_OUK_MKT", "HS_OUV_EVO", "HS_OUV_EVO", 
"HS_OUV_EVO", "HS_OUV_EVO", "HS_OUV_EVO", "HS_OUV_EVO", "HS_OUV_EVO"
), STICHTAG = structure(c(1353798000, 1353970800, 1354057200, 
1354143600, 1348956000, 1349042400, 1349128800, 1349215200, 1349301600, 
1349388000, 1349474400), class = c("POSIXct", "POSIXt"), tzone = ""), 
    BROKERAGE = c(123406.66, 61791.17, 62229.17, 62492.57, 0, 
    0, 0, 0, 0, 0, 0), DV = c(72873524.86, 38096138.75, 38283589.07, 
    38236199.05, 23171721.81, 23178889.59, 23187553.93, 23187426.98, 
    23173154.67, 23149439.13, 23149469.88), REALIZED = c(47002372.1, 
    23501186.05, 23501186.05, 23501186.05, 22961528, 22961528, 
    22961528, 22961528, 22961528, 22961528, 22961528), PV = c(25871152.76, 
    14594952.7, 14782403.02, 14735013, 210193.81, 217361.59, 
    226025.93, 225898.98, 211626.67, 187911.13, 187941.88), PV_ND = c(25973196.64, 
    14654807.46, 14843080.44, 14795220.35, 210222.01, 217386.44, 
    226048.76, 225920.76, 211641.41, 187919.95, 187949.85), BROKER_R = c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0), CREDIT_R = c(0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0), STRUCTURE_R = c(0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0), BROKER_UR_D = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ), CREDIT_UR_D = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), STRUCTURE_UR_D = c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0), BROKER_UN_UND = c(0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0), CREDIT_UN_UND = c(0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0), STRUCTURE_UN_UND = c(0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0)), .Names = c("COMMODITY", "BOOK", "STICHTAG", 
"BROKERAGE", "DV", "REALIZED", "PV", "PV_ND", "BROKER_R", "CREDIT_R", 
"STRUCTURE_R", "BROKER_UR_D", "CREDIT_UR_D", "STRUCTURE_UR_D", 
"BROKER_UN_UND", "CREDIT_UN_UND", "STRUCTURE_UN_UND"), sorted = c("COMMODITY", 
"BOOK", "STICHTAG"), class = c("data.table", "data.frame"), row.names = c(NA, 
-11L), .internal.selfref = <pointer: 0x014024a0>) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:25:16.847

```
# the zoo library has a year-month class,
# which makes it easy to find the month's end
library(zoo)

# just use the first eight records of mtcars as an example
x <- mtcars[ 1:8 , ]

# as an example,
# stick a bunch of dates onto the x data frame
x$TRADEDATE <- 
    c( '2012-10-31' , '2012-11-17' , '2012-11-30' , '2012-12-15' , '2012-12-13' , '2012-12-15' , '2012-08-31' , '2012-09-22' )

# calculate each date's end-of-month of the previous month
# just subtract by 1/12th to get this!
month.ends <- 
    as.Date( 
        as.yearmon( 
            x$TRADEDATE 
        ) - 1/12 , 
        # frac = 1 indicates "the end of this period" --
        # frac = 0 would be the start.
        frac = 1 
    )

# isolate the rows that exactly match the month end date for each given date
month.end.rows <- 
    # convert the rows to an integer vector
    as.integer( 
        # figure out which rows contain the `month.ends` for every record in the data table
        lapply( 
            # run each value in `month.ends` through..
            month.ends , 
            # this new simple which( x == y ) function
            function( x , y ) which( x == y ) , 
            # where `y` is the full contents of the TRADEDATE column of your data frame
            as.Date( x$TRADEDATE ) 
        ) 
    )

# note that month.end.rows' length == nrow( x )
stopifnot( length( month.end.rows ) == nrow( x ) )

# now just subtract something from the same variable using its respective month end date
x[ , "desired.column" ] <- x[ , "carb" ] - x[ month.end.rows , "carb" ] 
```

# php - 复杂的多维循环成表

> ID：13954043
> 
> 赞同：2
> 
> 时间：2012-12-19T14:02:24.413
> 
> 标签：php, codeigniter, multidimensional-array

我在从复杂循环中填充表时遇到问题。

该表由 7 天日历表组成，每天应包含其下的日事件。

```
Array
(
    [2012-12-16] => Array
        (
        )

    [2012-12-17] => Array
        (
            [0] => Array
                (
                    [date] => 2012-12-17
                    [time_booked] => 00:09:00
                    [time_start] => 00:00:00
                    [time_end] => 00:00:00
                    [name] => maha mostafa elrashed
                    [first_name] => marwan
                    [title] => root cannal
                )

            [1] => Array
                (
                    [date] => 2012-12-17
                    [time_booked] => 09:00:00
                    [time_start] => 00:00:00
                    [time_end] => 00:00:00
                    [name] => demo demo eldemo
                    [first_name] => marwan
                    [title] => ultrasound
                )

        )

    [2012-12-18] => Array
        (
            [0] => Array
                (
                    [date] => 2012-12-18
                    [time_booked] => 09:00:00
                    [time_start] => 00:00:00
                    [time_end] => 00:00:00
                    [name] => demo demo eldemo
                    [first_name] => marwan
                    [title] => root cannal
                )

        )

    [2012-12-19] => Array
        (
        )

    [2012-12-20] => Array
        (
        )

    [2012-12-21] => Array
        (
        )

    [2012-12-22] => Array
        (
        )

) 
```

我想将这个数组示例转换为表格。目前我发现最简单的方法是将每天打印**为 ul 并浮动离开它们**，但我真正想要的是用它们制作一个表格，以便将来能够使用 jQuery 对该表格进行排序。

```
foreach($ztable as $t){
    echo"\n<ul style='float:left;width:140px'>";
    foreach($t as $r){
        echo "<li class='{$r['first_name']}'>{$r['name']}</li>";
    }
        echo "</ul>\n";
} 
```

有什么建议么？顺便说一句，我正在使用 Codeigniter 2

编辑：

![上表来自建议的答案，下一张是我想要的](../Images/8b9ab70a3e1b2a2fff223ba5a33f1f48.png)

上表来自建议的答案，下一张是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:17:10.833

你的问题很模糊。您是说您想构建一个`<ul>`，同时拥有工作代码，而您实际上想要构建一个表。唔。

以下是你可以做一张桌子的方法：

```
// list of fields that will be rows
$fields = array(
    'date' => 'Date', 
    'time_booked' => 'Time of booking', 
    'time_start' => 'Start time',
    'time_end' => 'End time',
    'name' => 'Name',
    'first_name' => 'First name',
    'title' => 'Title'
    );

// echo table header
echo '<table border="1"><tr><th>Day</th>';
foreach ($fields as $field)
{
    echo '<th>' . $field . '</th>';
}
echo '</tr>';

// echo table rows
foreach($ztable as $day => $data)
{
    echo '<tr><td>' . $day . '</td>';
    // if some field is not present for current day, we show '-'
    foreach ($fields as $field_name => $field)
    {
        echo '<td>' . (isset($data[$field_name]) ? $data[$field_name] : '-') . '</td>';
    }
    echo '</tr>';
}
echo '</table>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:53:16.130

既然你添加了一张你想要的图片，我把一些看起来很粗糙的代码放在一起得到结果：

```
//provided $a is the array
//table header with dates
echo "<table class='table table-bordered'>";
echo "<tr>";

foreach($a as $date => $data){
    echo "<th>$date</th>";
}

echo "</tr>";

//table row for appointment dates
echo "<tr>";

foreach($a as $k=>$v){

    //if the array value isn't empty, we have data
    if(! empty($v)){

        echo "<td>";
        echo "<ul>";

        //loop through the array to get all the names
        foreach($v as $k => $v){

            echo "<li>".$v['name']."</li>";

        }
        echo "</ul>";
        echo "</td>";

    }else{
            //there was no data for the date; empty td
        echo "<td></td>";

    }

}

echo "</tr></table>"; 
```

应该足以让你走上正轨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:34:32.117

我认为您的数组格式不正确。请尝试这种格式。

```
Array('2012-12-16' => Array(),
            '2012-12-17' => Array
                (
                '0' => Array
                    (
                    'date' => '2012-12-17',
                    'time_booked' => '00:09:00',
                    'time_start' => '00:00:00',
                    'time_end' => '00:00:00',
                    'name' => 'maha mostafa elrashed',
                    'first_name' => 'marwan',
                    'title' => 'root cannal'
                ),
                '1' => Array
                    (
                    'date' => '2012-12-17',
                    'time_booked' => '09:00:00',
                    'time_start' => '00:00:00',
                    'time_end' => '00:00:00',
                    'name' => 'demo demo eldemo',
                    'first_name' => 'marwan',
                    'title' => 'ultrasound'
                )
            ),
            '2012-12-18' => Array
                (
                '0' => Array
                    (
                    'date' => '2012-12-18',
                    'time_booked' => '09:00:00',
                    'time_start' => '00:00:00',
                    'time_end' => '00:00:00',
                    'name' => 'demo demo eldemo',
                    'first_name' => 'marwan',
                    'title' => 'root cannal'
                )
            ),
            '2012 - 12 - 19' => Array
            (
            ),
            '2012 - 12 - 20' => Array
            (
            ),
            '2012 - 12 - 21' => Array
            (
            ),
            '2012 - 12 - 22' => Array
            (
            )
        ); 
```

# android - 隐藏来电显示 Android

> ID：13954046
> 
> 赞同：0
> 
> 时间：2012-12-19T14:02:35.203
> 
> 标签：android, android-layout, android-intent

我正在开发需要从我的程序中隐藏拨出呼叫者 ID 的应用程序。android 具有内置功能隐藏呼叫者 ID，但它对于某些区域不起作用（已禁用）。我可以以编程方式隐藏拨出呼叫者 ID 吗？或者我可以覆盖android调用屏幕，这样用户就看不到我在给谁打电话？非常感谢等待回答。. .

# android - Jenkins Maven 使用多配置构建

> ID：13954047
> 
> 赞同：2
> 
> 时间：2012-12-19T14:02:49.510
> 
> 标签：android, maven, configuration, android-emulator, jenkins

我正在工作中设置一个 CI 服务器（一切都是第一次）并且有一个问题。

所以，我的 Maven 工作很好，构建和执行我的测试。

但是我希望使用 Multi Configuration 来创建多个模拟器来运行我的测试。

有人可以明确地告诉我我是否可以这样做吗？这里的文档[https://wiki.jenkins-ci.org/display/JENKINS/Android+Emulator+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Android+Emulator+Plugin)似乎与我看到的一些评论相矛盾。

我不能成为唯一想以这种方式使用 Maven 和 Jenkins 的人，所以有什么变通方法吗？与此同时，我将为每个模拟器创建许多工作并错开他们的夜间构建，但是这感觉非常草率，我可以看到它很快变得难以管理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T17:20:45.463

多配置作业像任何其他作业一样运行，
尽管它可能对插件有一些有限的支持。

如果 Maven 插件有问题，请在实际开始构建之前通过“执行 Shell”块运行它
- 正如[*Christopher*](https://stackoverflow.com/users/234938/christopher)所提到的。

请注意，它将为所有配置运行完全相同的脚本，
除了每个配置将具有不同的参数。

# android - 在 WebView 中拦截 POST 请求

> ID：13954049
> 
> 赞同：34
> 
> 时间：2012-12-19T14:03:00.990
> 
> 标签：android, post, webview, request

我正在开发一个过滤请求（带有白名单）并使用自定义的 Android 应用程序`SSLSocketFactory`。为此，我开发了一个自定义`WebViewClient`并覆盖了该`shouldInterceptRequest`方法。我可以过滤并使用我`SocketFactory`的 GET 请求，但我无法拦截 POST 请求。

那么，有没有办法拦截 POST 请求`WebView`？

这是 shouldInterceptRequest 方法的代码：

```
public final WebResourceResponse shouldInterceptRequest(WebView view, String urlStr) {
    URI uri = URI.create(urlStr);
    String scheme = uri.getScheme();
    // If scheme not http(s), let the default webview manage it
    if(!"http".equals(scheme) && !"https".equals(scheme)) {
        return null;
    }
    URL url = uri.toURL();

    if(doCancelRequest(url)) {
        // Empty response
        Log.d(TAG, "URL filtered: " + url);
        return new WebResourceResponse("text/plain", "UTF-8", new EmptyInputStream());

    } else {
        Log.d(TAG, "URL: " + url);

        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestProperty("User-Agent", mSettings.getUserAgentString());

        // Configure connections
        configureConnection(conn);

        String mimeType = conn.getContentType();
        String encoding = conn.getContentEncoding();

        if(mimeType != null && mimeType.contains(CONTENT_TYPE_SPLIT)) {
            String[] split = mimeType.split(CONTENT_TYPE_SPLIT);
            mimeType = split[0];

            Matcher matcher = CONTENT_TYPE_PATTERN.matcher(split[1]);
            if(matcher.find()) {
                encoding = matcher.group(1);
            }
        }

        InputStream is = conn.getInputStream();
        return new WebResourceResponse(mimeType, encoding, is);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-08-12T23:58:07.170

几天前我也面临同样的问题。

所以我建立了一个解决它的库：

[https://github.com/KonstantinSchubert/request_data_webviewclient](https://github.com/KonstantinSchubert/request_data_webviewclient)

它是一个带有自定义 WebResourceRequest 的 WebViewClient，其中包含 XMLHttpRequest 请求的 POST/PUT/... 负载。

它只适用于这些——不适用于表单和其他类型的请求源。

hack 基本上是通过将脚本注入到拦截 XMLHttpRequest 调用的 HTML 中来工作的。它记录 post/put/... 内容并将其发送到`android.webkit.JavascriptInterface`. 在那里，请求被隐藏起来，直到`shouldInterceptRequest`Android 调用该方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T20:56:17.890

使用 GET 而不是 POST。

已知问题： [http ://code.google.com/p/android/issues/detail?id=9122](http://code.google.com/p/android/issues/detail?id=9122)

在这里也得到了回答： [Android - 如何在 API 级别 4 的 android WebViewClient 中拦截表单 POST](https://stackoverflow.com/questions/3664440/android-how-to-intercept-a-form-post-in-android-webviewclient-on-api-level-4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-30T22:07:08.713

有一个更简单的解决方案：在 ajax 调用中通过 GET 发送参数，并在 shouldInterceptRequest 中将它们转换为 POST

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-15T05:53:39.820

我在上面的线程 [http://code.google.com/p/android/issues/detail?id=9122上有我的答案之一](http://code.google.com/p/android/issues/detail?id=9122)

请参阅[评论#31](http://code.google.com/p/android/issues/detail?id=9122#c31)

我看到的解决方案的一些注意事项是：

1.  依赖于 xmlhttprequest 原型，它对不同的 webkits 有不同的实现。
2.  在 URL 中为 post 请求发送数据时的安全问题。但我想你可以通过一些加密机制来解决这个问题。
3.  如果您发布大数据，某些浏览器的 URL 长度问题

除此之外，我发现[这个 github repo](https://github.com/KeejOow/android-post-webview)似乎以另一种 hacky 方式解决了这个问题。我查看了代码，但没有时间实现和测试它。但值得一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-15T11:29:49.853

我发现最简单的方法是使用带有 Javascript 接口的[JQuery Ajax 事件处理程序。](https://api.jquery.com/category/ajax/global-ajax-event-handlers/)

您必须设置 Javascript 接口，但是一旦您设置它与您感兴趣的处理程序的签名相匹配。

要获取有效负载，只需找到有效负载变量名称并将其放在界面中即可。

这是Javascript：

```
 $( document ).ajaxSend(function( event, request, settings ) {
      var eventJSON= JSON.stringify(event);
      var requestJSON = JSON.stringify(request);
      var settingsJSON = JSON.stringify(settings);
      var payloadJSON = JSON.stringify(payload);

      myJSInterface.passData(eventJSON,requestJSON,settingsJSON,payloadJSON);       
 }); 
```

这是 Kotlin 类

```
 class yourJSInterface() {
      lateinit var event: String
      lateinit var request: String
      lateinit var settings: String
      lateinit var payload: String

      @JavascriptInterface
      fun passData(eventJSON:String, responseJSON:String, settingsJSON:String,payloadJSON:String){
           event = eventJSON
           response= responseJSON
           settings= settingsJSON
           payload= payloadJSON
      }
 } 
```

WebViewClient 的 onPageStarted 覆盖中的注册

```
 webView.addJavascriptInterface(yourJSInterface,"myJSInterface") 
```

最后在 OnPageFinished 覆盖中将 JS 注入 WebView

```
 webView.evaluateJavascript("javascript:" + getString(R.string.js_from_above),null) 
```

我在 onPageStarted 中注册了界面，否则 onPageFinished 中的 javascript 文件将无法识别您的界面。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-08-12T02:27:02.287

您可以在提交之前获取输入值
[https://github.com/henrychuangtw/WebView-Javascript-Inject](https://github.com/henrychuangtw/WebView-Javascript-Inject)

第 1 步：创建一个由 javascript 调用的类

```
class MyJavaScriptInterface
{
    @JavascriptInterface
    public void processHTML(String html)
    {
        //called by javascript
    }
} 
```

第二步：注册javascript接口

```
webview1.getSettings().setJavaScriptEnabled(true);
webview1.addJavascriptInterface(new MyJavaScriptInterface(), "MYOBJECT"); 
```

第 3 步：将 javascript 注入页面

```
webview1.setWebViewClient(new WebViewClient() {
    @Override
    public void onPageFinished(WebView view, String url) {
        super.onPageFinished(view, url);

        StringBuilder sb = new StringBuilder();
        sb.append("document.getElementsByTagName('form')[0].onsubmit = function () {");
        sb.append("var objPWD, objAccount;var str = '';");
        sb.append("var inputs = document.getElementsByTagName('input');");
        sb.append("for (var i = 0; i < inputs.length; i++) {");
        sb.append("if (inputs[i].type.toLowerCase() === 'password') {objPWD = inputs[i];}");
        sb.append("else if (inputs[i].name.toLowerCase() === 'email') {objAccount = inputs[i];}");
        sb.append("}");
        sb.append("if (objAccount != null) {str += objAccount.value;}");
        sb.append("if (objPWD != null) { str += ' , ' + objPWD.value;}");
        sb.append("window.MYOBJECT.processHTML(str);");
        sb.append("return true;");
        sb.append("};");

        view.loadUrl("javascript:" + sb.toString());
    }

}); 
```

# ruby-on-rails - 根据当前 Rails.env 配置变量

> ID：13954050
> 
> 赞同：4
> 
> 时间：2012-12-19T14:03:10.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3

配置不同变量的最简单方法是什么（例如，我在标签 link_to 中有变量，取决于当前的 Rails.env）？

```
<%
    if Rails.env == 'development'
        domain = 'somedomain.me'
    elsif Rails.env == 'staging'
        domain = 'example.com'
    end 
    %>
    <%= link_to 'Back', root_url(:subdomain => 'www', :domain => domain), :class=>"btn btn-primary"%> 
```

我想将此 if - elsif 语句移动到其他地方，或者如果存在任何“配置文件”，甚至将其删除

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:19:59.847

有一个很棒的宝石，叫做`rails_config`：[github repo](https://github.com/railsjedi/rails_config)

但是如果你只想配置这个并且只有这个变量，你可以在 rails 已经拥有的环境配置文件中创建一个常量。

就像是：

在您的 config/environments/production.rb

```
# production.rb
Rails.configuration.my_awesome_changing_domain = "somedomain.me" 
```

在你的 config/environments/development.rb

```
# development.rb
Rails.configuration.my_awesome_changing_domain = "stackoverflow.com" 
```

在你的 config/environments/staging.rb

```
# staging.rb
Rails.configuration.my_awesome_changing_domain = "news.ycombinator.com" 
```

在此线程的另一个答案中讨论了其他方法： [https ://stackoverflow.com/a/5053882](https://stackoverflow.com/a/5053882)

最好的祝福

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:37:17.493

这是一篇关于在 Rails 上设置变量的好博文：[http ://railsapps.github.com/rails-environment-variables.html](http://railsapps.github.com/rails-environment-variables.html)

# css - 更改图像比例点

> ID：13954058
> 
> 赞同：2
> 
> 时间：2012-12-19T14:03:31.473
> 
> 标签：css

我有一个最大宽度百分比的图像。

```
img {
     max-width: 150%;
} 
```

当我调整浏览器窗口的大小时，图像会从左上角缩放。

有没有办法改变图像缩放的点？

例如这个例子：

[http://jsfiddle.net/dbVcy/](http://jsfiddle.net/dbVcy/)

是否可以从女性的脸部而不是左上角缩放图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:06:17.070

您可以定位到角落，例如右下角。

我更新了你的小提琴 - 在这里：http: [//jsfiddle.net/dbVcy/1/](http://jsfiddle.net/dbVcy/1/)

本质上，将 CSS 更改为

```
img {
     max-width: 100%;
    position:absolute;
    bottom:0px;
    right:0px;
} 
```

要从图像中的某个点获取它，您必须在调整浏览器大小时使用 JQuery 操作底部和右侧（或顶部和左侧） - 它应该给它一种在您的情况下被脸部调整大小的错觉。

​</p>

# javascript - 多选jQuery

> ID：13954063
> 
> 赞同：-1
> 
> 时间：2012-12-19T14:03:44.197
> 
> 标签：javascript, jquery, html

我是 jQuery 的新手。我不得不在我的 jQuery 页面的一个字段中使用多选。我选择数据并处理并将其存储在数据库中。到目前为止，我不想通过 jQuery 代码。我需要在条目页面中选择的值需要反映在编辑页面中。我需要知道该怎么做。

```
<SELECT id="s1" multiple="multiple" name="PLTF_MAP" class="input-box">
    <%  
       try{
           //getting values and names from database                         
           out.println("<option    value="+ temp.getCode()+ ">"+temp.getDesc()+ "</option>");
       }
       }catch(Exception exe){
           exe.printStackTrace();
       }            
    %>
</SELECT> 
```

下面的屏幕截图：平台是我的字段，在编辑页面中，我需要检查所有选定的字段。

![在此处输入图像描述](../Images/f66b910abcc017c2b0f4fb5f14ead533.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:44:10.230

从 select 调用的 val 函数将返回一个数组，如果它是一个倍数：

```
$('select#s1').val(); 
```

在这个小提琴中：http: [//jsfiddle.net/mdPQw/1/](http://jsfiddle.net/mdPQw/1/)

你可以找到两个例子：

1.  首先从yuor select的选定值中创建一个选择。
2.  第二个在第三个多选中选择第一个多选的选定项。

# entity-framework - 涉及复杂对象的实体框架的 Linq 表达式构建

> ID：13954070
> 
> 赞同：3
> 
> 时间：2012-12-19T14:04:06.590
> 
> 标签：entity-framework, lambda, linq-to-entities, expression

我正在使用 Entity Framework 版本 4。我需要将一个大型（约 100 万条记录）SQL Server 表与从 Web 服务返回的较长（约 2000 个）复杂对象数组进行比较。需要比较五个不同的属性来确定复杂对象的实例是否已经在数据库中。

我创建了一个函数，它返回用于 .Where 和 .Any 方法的表达式。它看起来像这样（其中 A 是复杂对象，tblA 是 EF 类）：

```
function Expression<tblA, bool> GetSearchPredicate(A a)
{
    return ta => ta.Field1.Equals(a.Field1) 
        && ta.Field2.Equals(a.Field2)
        && ta.Field3.Equals(a.Field3)
        && ta.Field4.Equals(a.Field4)
        && ta.Field5.Equals(a.Field5);
} 
```

这行得通。我可以通过这样做来比较 A 的所有 2000 个实例：

```
IEnumerable<A> objects = [web service call]; 
var result = objects.Select(a => !db.tblA.Any(GetSearchPredicate(a))); 
```

这也有效。但它很慢。因此，我研究了构建一个实用方法，该方法可以构建一个表达式，该表达式可以直接通过 EF 传输到数据库。

我使用[这个问题](https://stackoverflow.com/questions/374267/contains-workaround-using-linq-to-entities)中的代码作为构建该实用程序方法的基础。该问题中的示例显示将单个属性与一系列常量进行比较，而我的版本必须将多个属性与多个常量进行比较。我的最大努力如下：

```
 public static IQueryable<TEntity> WhereIn<TEntity>
       (
        this ObjectQuery<TEntity> query,
        IEnumerable<Expression<Func<TEntity, bool>>> predicates
       )
    {
        if (predicates == null) throw new ArgumentNullException("predicates");

        IEnumerable<ParameterExpression> p = predicates.Select(pred => pred.Parameters.Single()).ToArray();

        IEnumerable<Expression> equals = predicates.Select(value =>
            (Expression)value.Body);

        Expression bigEqual = equals.Aggregate((accumulate, equal) =>
            Expression.Or(accumulate, equal));

        var result1 = Expression.Lambda<Func<TEntity, bool>>(bigEqual, p.First());
        var result = query.Where(result1);
        return result;
    } 
```

这将像这样调用：

```
IEnumerable<A> objects = [web service call]; 
var result = db.tblA.WhereIn(objects.Select(a => GetSearchPredicate(a))); 
```

我得到的是一条消息，说“ta”（TEntity 对象的占位符）未绑定。我认为这是因为我`predicates`组合了多个表达式（变量），并且可能抛出了这条消息，因为我只是从第一个`predicates`IEnumerable 传递参数。但即使`predicates`是一个表达式，也会发生这种情况。

我有理由确定，基于我链接到的方法，我可以构建一个表达式，将五个属性中的每一个与一个常量（`A.Field1`through的值`A.Field5`）进行比较，而不是传入`predicates`已经将它们组装成一系列的参数表达式。但我宁愿不这样做，因为这需要我的方法知道它正在使用类型`A`和`tblA`，这与通用和通用目的相反。（它也很复杂和混乱。）

我希望我所展示的示例能够解释我想要做什么。它可以以通用方式完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:56:13.863

您需要将谓词正文中的参数替换为单个参数。像这样的东西应该工作：

```
public static Expression<Func<T, bool>> BuildOr<T>(
   IEnumerable<Expression<Func<T, bool>>> predicates)
{
    Expression body = null;
    ParameterExpression p = null;
    Expression<Func<T, bool>> first = null;

    foreach (Expression<Func<T, bool>> item in predicates)
    {
        if (first == null)
        {
            first = item;
        }
        else
        {
            if (body == null)
            {
                body = first.Body;
                p = first.Parameters[0];
            }

            var toReplace = item.Parameters[0];
            var itemBody = ReplacementVisitor.Transform(item, toReplace, p);
            body = Expression.OrElse(body, itemBody);
        }
    }

    if (first == null) 
    {
       throw new ArgumentException("Sequence contains no elements.", "predicates");
    }

    return (body == null) ? first : Expression.Lambda<Func<T, bool>>(body, p);
}

private sealed class ReplacementVisitor : ExpressionVisitor
{
    private IList<ParameterExpression> SourceParameters { get; set; }
    private Expression ToFind { get; set; }
    private Expression ReplaceWith { get; set; }

    public static Expression Transform(
       LambdaExpression source, 
       Expression toFind, 
       Expression replaceWith)
    {
        var visitor = new ReplacementVisitor
        {
            SourceParameters = source.Parameters,
            ToFind = toFind,
            ReplaceWith = replaceWith,
        };

        return visitor.Visit(source.Body);
    }

    private Expression ReplaceNode(Expression node)
    {
        return (node == ToFind) ? ReplaceWith : node;
    }

    protected override Expression VisitConstant(ConstantExpression node)
    {
        return ReplaceNode(node);
    }

    protected override Expression VisitBinary(BinaryExpression node)
    {
        var result = ReplaceNode(node);
        if (result == node) result = base.VisitBinary(node);
        return result;
    }

    protected override Expression VisitParameter(ParameterExpression node)
    {
        if (SourceParameters.Contains(node)) return ReplaceNode(node);
        return SourceParameters.FirstOrDefault(p => p.Name == node.Name) ?? node;
    }
} 
```

你的`WhereIn`方法然后变成：

```
public static IQueryable<TEntity> WhereIn<TEntity>(
   this ObjectQuery<TEntity> query, 
   IEnumerable<Expression<Func<TEntity, bool>>> predicates)
{
    if (predicates == null) throw new ArgumentNullException("predicates");

    var predicate = BuildOr(predicates);
    return query.Where(predicate);
} 
```

# joomla - Joomla：扩展更新：更改表架构（删除列）

> ID：13954074
> 
> 赞同：2
> 
> 时间：2012-12-19T14:04:17.857
> 
> 标签：joomla, joomla2.5, joomla-extensions

我开发了一个 Joomla 扩展，在最新版本中，需要从属于我的插件的表中删除一列。

据我所知，[只有当它存在时才能删除 Mysql 中的列](https://stackoverflow.com/questions/173814/mysql-alter-syntax-to-drop-a-column-if-it-exists)。因此，我目前看到的唯一可能性是使用自定义 php 升级代码，如此[处所示](http://docs.joomla.org/Manifest_files#SQL)。

但是这个问题对我来说似乎很常见，以至于我怀疑这是一个更简单的解决方案？是否有一种简单的方法（通过 Joomla 提供）仅在从特定扩展版本更新时执行模式更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:43:09.727

检查[使用 Joomla 管理组件更新](http://docs.joomla.org/Managing_Component_Updates_with_Joomla!1.6_-_Part_4)；从 Joomla 1.6 开始，有一种定义的方式来执行特定的 SQL 指令以从一个版本升级到另一个版本。基本上，对于每个版本，都必须在特定的文件结构中创建一个 SQL 文件（即使它是空的或只包含注释）。链接的文章解释了细节。

# c# - 每 n 毫秒执行 x 个动作

> ID：13954076
> 
> 赞同：2
> 
> 时间：2012-12-19T14:04:19.017
> 
> 标签：c#, multithreading, action

我有一个程序让用户创建几个函数，一旦他创建了所有函数，我每 x 毫秒运行一次。换句话说，我有类似的东西：

```
// functionsToExecute is of type = List<Action>
// x = some integer
while(true){

   foreach(Action action in functionsToExecute)
   {
       action();
   }

   Thread.Sleep(x);
} 
```

现在我想让用户决定每个函数等待多长时间。例如，如果用户创建了 2 个函数，他可能希望第一个函数每 500 毫秒运行一次，下一个每 1500 毫秒运行一次。我正在考虑为这种情况创建两个线程，然后具有相同的实现。**但是如果用户创建了 50 个函数呢？我需要50个线程！**

**简而言之**，我想每 n 毫秒执行 x 次动作……创建这种算法的最佳方法是什么？例如，如果我有 3 个动作，我希望每 200 毫秒执行第一个动作，每 500 毫秒执行下一个动作，每 1000 毫秒执行最后一个动作。

也许我需要类似于`SetTimout`javascript 中的函数的东西

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:19:25.083

如果您使用的是 .NET 4.5 并且您的代码对时间要求不高，那么您可以使用 Task Parallel Library 轻松做到这一点：

```
static Task Repeat (List<Action> actions, CancellationToken token, int delay)
{
    var tasks = new List<Task> ();
    var cts = CancellationTokenSource.CreateLinkedTokenSource (token);

    foreach (var action in actions) {
        var task = Task.Factory.StartNew (async () => {
            while (true) {
                cts.Token.ThrowIfCancellationRequested ();
                await Task.Delay (delay, cts.Token).ConfigureAwait (false);
                action ();
            }
        });
        tasks.Add (task);
    }

    return Task.WhenAll (tasks);
} 
```

Ideally, you should also make your actions async to properly support cancellation.

The .NET runtime automatically takes care of thread scheduling, but there's no guarantee that your action will be executed after *exactly* the requested timeout. It will be executed after at least that time has elapsed and there's an idle thread available.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:10:18.157

我会考虑使用[`ThreadPool`](http://msdn.microsoft.com/en-us/library/system.threading.threadpool%28v=vs.100%29.aspx)（[演练](http://msdn.microsoft.com/en-us/library/3dasc8as%28v=vs.100%29.aspx)）。创建每个要处理的线程，并根据他们正在寻找的超时重复它。[`ManualResetEvent`](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent%28v=vs.100%29.aspx)当您需要线程停止时，您还可以存储for 。

# extjs - 当我右键单击它时，extjs+link 保持悬停状态。如何作废

> ID：13954077
> 
> 赞同：0
> 
> 时间：2012-12-19T14:04:21.540
> 
> 标签：extjs

我在我的 Extjs 应用程序中使用链接，我面临悬停状态的问题。

当我右键单击任何链接时，它会显示悬停状态，直到我单击外部。一旦我在外面点击它就正常了。

我想将鼠标从该链接移开后立即显示正常状态。

这是我的CSS。

```
.linkbold{
    color:#0080cc;
    font-family:Tahoma;
    font-size:11px;
    text-decoration:none;
    font-weight:bold !important;
}
a.linkbold:link, a.linkbold:visited{
    color:#0080cc;
    font-family:Tahoma;
    font-size:11px;
    text-decoration:none;
    background-color: #red;
    font-weight:bold !important;
    display:block;
}
a.linkbold:hover{
    color:#000000;
    font-family:Tahoma;
    font-size:11px;
    text-decoration:none;
    font-weight:bold !important;
}
a.linkbold:active{
    color:#000000;
    font-family:Tahoma;
    font-size:11px;
    text-decoration:underline !important;
    font-weight:bold !important;
    display:block;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T07:05:32.147

我已更改**a.linkbold:active**颜色并删除活动状态下的下划线。活动状态的颜色变为正常。

# servlets - Servlet：在 doGet() 方法中重定向到索引与显示视图的正确方法

> ID：13954079
> 
> 赞同：1
> 
> 时间：2012-12-19T14:04:33.757
> 
> 标签：servlets

鉴于此`doGet`实现：

```
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    if (request.getParameterMap().isEmpty()) {

        // DAO initialized in init() method
        Collection<User> users = resource.getUsers();

        if (users != null){

            HttpSession session = request.getSession();
            session.setAttribute("users", users);

        }

        request.getRequestDispatcher("/WEB-INF/users/index.jsp").forward(request, response);

    }

    else {

        String name = request.getParameter("name");

        // DAO initialized in init() method
        User user = resource.getUser(name);

        if (user == null){
            request.setAttribute("message", "Unknown user: " + name);
            request.getRequestDispatcher("/WEB-INF/errors/404.jsp").forward(request, response);
        }

        else {

            HttpSession session = request.getSession();
            session.setAttribute("user", user);

            request.getRequestDispatcher("/WEB-INF/users/show.jsp").forward(request, response);

        }

    }

} 
```

问题：

1.  是`request.getParameterMap().isEmpty()`测试参数是否存在的首选方法吗？
2.  有没有办法从 Servlet 的上下文或注释中推断出视图的位置（/WEB-INF/users/）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:40:38.283

> *是`request.getParameterMap().isEmpty()`测试参数是否存在的首选方法吗？*

是的。但这不是*您特定情况*的正确解决方案。如果最终用户提供了一个名称不是 的任意参数，您的代码将失败`name`，从而导致参数映射不为空，从而输入需要该`name`参数的块。您应该真正明确地检查请求参数`name`本身。

```
String name = request.getParameter("name");

if (name == null) {
    Collection<User> users = resource.getUsers();
    // ...
}
else {
    User user = resource.getUser(name);
    // ...
} 
```

* * *

> *有没有办法`/WEB-INF/users/`从 Servlet 的上下文或注释中推断出视图的位置（）？*

使用 MVC 框架（推荐）或[自制](https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications/)框架（不推荐，除非 100% 内部/私人/爱好，因此用于纯粹的学习目的）。

# javascript - 带有凭据的跨域 jQuery ajax 调用

> ID：13954080
> 
> 赞同：17
> 
> 时间：2012-12-19T14:04:33.710
> 
> 标签：javascript, jquery, certificate, cross-domain

我已按照以下步骤操作：

1.  让服务器允许跨域调用（包含所有标头和内容*）*
2.  使用一些跨域调用测试服务器*这有效*
3.  让服务器强制证书 *这行得通*
4.  使用浏览器转到服务器上的文件，选择正确的证书并查看该文件*仍然有效*
    **现在我们进入了不错的部分**
5.  将跨域调用与证书结合**<-这不起作用**

**问题**

我正在从浏览器获取证书请求，但是当我选择与使用浏览器时相同的证书时，会进行调用，但会收到 403 Forbidden。

**代码**

```
$.ajax({
     type: "POST",
     xhrFields: {withCredentials: true},
     dataType: "xml",
     contentType: "text/xml; charset=\"utf-8\"",
     url: "https://www.myOtherServer.com/testfile.asp",
}); 
```

有任何想法吗？

**编辑**

和`Access-Control-Allow-Credentials: true`已`Access-Control-Allow-Origin`正确配置。

**附加信息**

我开始认为它与内容类型有关。当我将其更改`"text/html"`为时出现`415`错误，但我确实需要发送 xml，因为它是一个 SOAP 服务器。

**响应标头**

```
Access-Control-Allow-Cred...    true
Access-Control-Allow-Head...    Content-Type, Origin, Man, Messagetype, Soapaction, X-Test-Header
Access-Control-Allow-Meth...    GET,POST,HEAD,DELETE,PUT,OPTIONS
Access-Control-Allow-Orig...    https://www.mywebsite.com
Access-Control-Max-Age  1800
Cache-Control   private
Content-Length  5561
Content-Type    text/html; charset=utf-8
Date    Wed, 19 Dec 2012 15:06:46 GMT
Server  Microsoft-IIS/7.5
X-Powered-By    ASP.NET 
```

**请求标头**

```
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language nl,en-us;q=0.7,en;q=0.3
Access-Control-Request-He...    content-type
Access-Control-Request-Me...    POST
Cache-Control   no-cache
Connection  keep-alive
Host    myhoast.com
Origin  https://www.mywebsite.com
Pragma  no-cache
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T14:34:41.120

我最好的猜测是，这不是您的 Javascript 的问题，而是您的 CORS 配置的问题。您是否使用标头设置了服务器`Access-Control-Allow-Credentials: true`？[http://www.w3.org/TR/cors/#access-control-allow-credentials-response-header](http://www.w3.org/TR/cors/#access-control-allow-credentials-response-header)

另请注意，即使设置了 allow-credentials 标头，如果`Access-Control-Allow-Origin`是 *，浏览器也不会允许响应凭据请求，根据这些文档：[https ://developer.mozilla.org/en-US/docs/HTTP/ Access_control_CORS?redirectlocale=en-US&redirectslug=HTTP_access_control#Requests_with_credentials](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS?redirectlocale=en-US&redirectslug=HTTP_access_control#Requests_with_credentials)。

编辑：由于 OP 正确设置了 CORS 标头，因此问题似乎是服务器拒绝带有 403 状态代码的 OPTIONS 请求。OPTIONS 请求（称为“预检请求”）在某些跨域请求（例如具有 application/xml 内容类型的 POST）之前发送，以允许服务器通知浏览器允许哪些类型的请求。由于浏览器没有看到它期望从 OPTIONS 请求中得到的 200 响应，因此它不会触发实际的 POST 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-28T17:18:13.690

基本上我们只需要在 htaccess 上写

```
Header set Access-Control-Allow-Origin “*” 
```

但是当我们需要 cookie 等时，我们必须在您的 ajax 代码和 htaccess 上添加脚本

~~我在我的博客blog.imammubin.com/cross-domain-xhr/2014/05/28/~~上写了关于跨域 XHR 的文章（**编辑**：站点不再存在）

希望这有帮助..

# php - 尝试使用 PHP 从 MySQL 数据库获取数据时不显示 HighCharts 饼图 X 轴值

> ID：13954081
> 
> 赞同：0
> 
> 时间：2012-12-19T14:04:35.837
> 
> 标签：php, mysql, html, extjs4, highcharts

我被困在从 mysql 数据库到 HighCharts 的数据连接中

*highchart.js*代码如下

```
 <script type="text/javascript">
    $(function () {
        var chart;
        $(document).ready(function() {
            chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'container5',
                    plotBackgroundColor: null,
                    plotBorderWidth: 2,
                    plotShadow: false
                },
                title: {
                    text: '<p><?php echo $chart5; ?></p>'
                },
                // tooltip: {
                    // pointFormat: '{series.name}: <b>{point.percentage}%</b>',
                    // percentageDecimals: 1
                // },
               plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: false
                        },
                        showInLegend: true
                    }
                },

                    xAxis: {
             categories: [<?php echo "'".implode("','",$data)."'"; ?>]
          },
          series: [{
           type: 'pie',
             data: [<?php echo implode(",",$data1);  ?>] 

                }]
            });
        });

    });

        </script> 
```

和我的*database.php*：

```
 $data = array();
        $sql = "SELECT x_axis FROM licence_chart ";
         $result9 = mysql_query($sql);
                $data9 = array();
                while ($row = mysql_fetch_array($result9)) {
                   $data9 = $row['x_axis'];
                   $data[] = $data9;
                }

        $data1 = array();
        $sql = "SELECT y_axis FROM licence_chart ";
         $result10 = mysql_query($sql);
                $data10 = array();
                while ($row = mysql_fetch_array($result10)) {
                   $data10 = $row['y_axis'];
                   $data1[] = $data10;
                }

                echo "'".join("','",$data)."'";
                echo join(",",$data1); 
```

当我在 localhost 中运行此代码时，饼图`x-axies` 会显示，但未显示值，但值显示正确，`Slice`但`y-axies`值显示正确，

在`licence_chart`表中这样的表数据中`x_axies`，`y_axies`是列

```
x_axies{crome,opera,ie,firefox,safari}
y_axies{0.12,0.23,23.2,56.2,2} 
```

我想在`highchart.js`文件中的`data[]` 数据会像这样

> `['safari',10],` `['firefox',1.5],`['即'，0.5]

所以我在文件中做错了什么请告诉我并更正我的代码`database.php`。`highchatr.js`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:04:17.903

上述问题的正确答案，我正在使用它并获得上述格式

```
<php
    $sql = "SELECT x_axis,y_axis FROM licence_chart ";
    $result9 = mysql_query($sql);
    $data9 = array();
    while ($row = mysql_fetch_array($result9)) 
        {
            $data9 = "'".$row['x_axis']."'".",".$row['y_axis'];
            $data[] = $data9;
        }   
    for($ii=0;$ii<count($data);$ii++)
        {
            echo "[".$data[$ii]."]," ;  
        }   
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T06:14:31.127

> ```
> <?php 
> ```
> 
> `// Set the JSON header` `header("Content-type: text/json");` `// The x value is the current JavaScript time, which is the Unix time multiplied by 1000.` `$x = time() * 1000;` `// The y value is a random number` `$y = rand(0, 100);` `// Create a PHP array and echo it as JSON` `$ret = array($x, $y);` `echo json_encode($ret);` `?>`

这是来自 HIGHCHARTS 安装说明的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T17:15:13.410

就像错误所说： [http ://www.highcharts.com/errors/14](http://www.highcharts.com/errors/14)

> Highcharts 错误 #14 字符串值发送到 series.data，预期数字
> 
> 如果您将字符串作为数据点传递，就会发生这种情况，例如在这样的设置中：
> 
> 系列：[{数据：[“3”，“5”，“1”，“6”]}]
> 
> Highcharts 期望数据值是数字。最常见的原因是数据是从 CSV 或 XML 源解析的，而实现者忘记对解析的值运行 parseFloat。
> 
> 出于性能原因，不执行内部类型转换，并且只检查第一个值（从 2.3 开始）。

你的问题是你的`echo join($data1, "','");`。yAxis 值不能是字符串。看起来你只是得到一个巨大的字符串：

```
'Safari','Opera','Firefox','IE','Chrome','Others10','6','40.5','20','10.6','0.5 
```

通过执行此连接操作，您将在 yAxis 数字周围添加单引号。简单地说：

```
echo join($data1, ","); 
```

这应该可以解决您的部分问题。如果您阅读了错误页面，您会看到这一点 - 不是敲你，但 HighCharts 有非常棒的文档和错误报告。

为了以正确的形式获得它，您还需要使用 [name, yValue] 制作不同的系列元素。你所拥有的只是 [name, name, name,...., yVal, yVal, yVal..] 的字符串。

如何解析？真的取决于你。但是为什么不直接做一个`SELECT '[''' + x_axis + '',' + CONVERT(VARCHAR(10), y_axis) + ']' FROM licence_chart`然后做一个这样的连接：

```
echo join($data1, ","); 
```

这应该会给你（不确定关于用数字进行文本连接的 mySQL 语法，所以我把它留给你。这是在 MS SQL 中）：

```
['Safari', 6], ['Opera', 40.5], ['Firefox', 20], ['IE', 10.6], ['Chrome', 0.5], ['Others10', <some number...looks like it got cut off in your question>] 
```

# sql-server-2008 - ROW_NUMBER() 替代

> ID：13954082
> 
> 赞同：1
> 
> 时间：2012-12-19T14:04:39.717
> 
> 标签：sql-server-2008

我有一张表，其中包含：

```
ID      ID_TYPE
---------------   
 1        0
 2        1
 3        1 
```

现在我想在执行时获取当前记录号：

```
SELECT ID
FROM IDTable
WHERE ID_TYPE = 1 
```

我不想使用`ROW_NUMBER() OVER (ORDER BY [ID] desc)`，因为使用较大的表时它非常慢。

我的选择是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T14:45:32.820

尝试

```
select ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) as number from IDTable WHERE ID_TYPE = 1 
```

# facebook-c#-sdk - 分享到朋友墙的特定链接

> ID：13954090
> 
> 赞同：1
> 
> 时间：2012-12-19T14:04:54.113
> 
> 标签：facebook-c#-sdk, share

使用 facebook c# sdk，我可以分享到我的墙的链接。

但是当我尝试在我朋友的墙上这样做时遇到问题，它显示为我的朋友分享链接，任何想法为什么会发生这种情况？

当我准备帖子时，我会填写以下字段：

来自：我的 Facebook 客户 ID 和姓名

链接：我分享的链接

将其发布到地址：friends_id/feed

这是代码示例

```
 JavaScriptSerializer sr = new JavaScriptSerializer();
  Dictionary<string, object> result = new Dictionary<string, object>
                                            {{"link", "{some http address here}"}, 
                                            {"from", sr.Serialize(GetFrom())}};

    FacebookClient fbClient = new FacebookClient(accessToken);

    fbClient.PostCompleted += FbClientPostCompleted;

    fbClient.PostTaskAsync("/{ID of my friend}/feed", parameters); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T06:09:31.940

您需要使用用户的访问令牌，而不是应用程序访问令牌。之后，假设您具有正确的发布权限，它应该可以正常工作。

# express - 重定向 Express js 管道 (req.pipe) res 正确

> ID：13954094
> 
> 赞同：2
> 
> 时间：2012-12-19T14:05:13.733
> 
> 标签：express

可能我做错了什么，但是：

在我的浏览器中，我有一个代码

```
window.location = '/some/url' 
```

或带有 href="/some url" 的元素

在节点（express.js）中，我有以下路由处理程序：

```
app.get('/some/url', function(req, res){
    res.redirect('http://www.google.com')
}); 
```

页面内容加载有奇怪的缺陷谷歌页面。并且地址栏没有改变（http://localhost:3000/some/url）。

我正在使用 req.pipe(request(host + req.url)).pipe(res) 通过中间服务器发出请求，似乎管道 res 没有正确重定向。任何想法如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T12:05:12.757

我需要为 reqest.js 使用 {followRedirect: false} 选项

# android - android获取录制的视频/音频的路径

> ID：13954096
> 
> 赞同：1
> 
> 时间：2012-12-19T14:05:30.863
> 
> 标签：android, android-mediarecorder

我让用户通过执行以下操作录制视频/音频：

```
Intent videoIntent = new Intent(MediaStore.ACTION_VIDEO_CAPTURE);
        startActivityForResult(videoIntent, VIDEO_REQUEST);
         //pretty the same thing for audio 
```

我不确定在 onActivityResult() 方法中如何获取录制文件的 Uri，然后将其转换为 /mnt/sdcard/DCIM/Camera/1231.avi 等绝对路径

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:23:07.660

试试我的程序，您将在其中了解如何获取路径。链接如下：- [Imp Link](https://stackoverflow.com/questions/12099579/android-could-not-play-mp4-video-with-videoview/13456942#13456942)。

# php - 使用 imagick 类导致“未收到数据”

> ID：13954098
> 
> 赞同：2
> 
> 时间：2012-12-19T14:05:40.900
> 
> 标签：php, imagick

我有一个简单的问题，我开始使用 imagick 并使用命令行参数确实有效，但尝试执行以下操作：

```
<?php
header("Content-type: image/jpeg");
$image = new Imagick(); 
$image->readImage("meiwen.jpg");
$image->blurImage(5,3);
echo $image;
?> 
```

导致在 httpd.exe 中使用未处理的 win 32 异常调用 Visual Studio 调试器，如果我单击“否”或“继续”浏览器，Chrome 会返回：“未收到数据无法加载网页，因为服务器没有发送数据。以下是一些建议：稍后重新加载此网页。错误 324 (net::ERR_EMPTY_RESPONSE)：服务器关闭连接，没有发送任何数据。为什么会这样？有没有办法来解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:12:07.410

你有安装 ImageMagick 吗？它不是默认包。

我从未使用过它，但听起来跑步可能会有点痛苦。这似乎是如何做到这一点的一个不错的概述：http: [//alexdespaindev.blogspot.com/2012/02/wamp-server-and-imagemagick.html](http://alexdespaindev.blogspot.com/2012/02/wamp-server-and-imagemagick.html)

# iphone - 比较两个字符串并删除共同元素

> ID：13954102
> 
> 赞同：2
> 
> 时间：2012-12-19T14:05:56.813
> 
> 标签：iphone, objective-c, ios

我有两个逗号分隔`NSString`的 & 我只想从第一个字符串中删除相似的字符。

```
ex. str1 = 0,1,2,3
    str2 = 1,2.
    output -> str1 = 0,3 and str2 = 1,2. 
```

我有一个选择，即在数组中用逗号分隔值分隔两个字符串。但它需要两个`NSArray`& 应用`loop`然后删除共同的元素，但这是一个非常繁琐的工作。所以我想要一些简单而适当的解决方案来避免循环。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T14:16:39.817

试试这个：

不需要循环！！！

您已获得所有必需的 API。

```
NSString *str1=@"0,1,2,3";
NSString *str2=@"1,2";

NSMutableArray *arr1=[[NSMutableArray alloc]initWithArray:[str1 componentsSeparatedByString:@","]];

[arr1 removeObjectsInArray:[str2 componentsSeparatedByString:@","]];
NSLog(@"arr1 %@",arr1);
/*
NSMutableString *finalString=[NSMutableString new];

for (NSInteger i=0; i<[arr1 count]; i++) {
    NSString *str=[arr1 objectAtIndex:i];

    [finalString appendString:str];
    if (i!=[arr1 count]-1) {
      [finalString appendString:@","];  
    }
}
*/
NSString *finalString=[arr1 componentsJoinedByString:@","];
NSLog(@"finalString %@",finalString); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:12:54.737

类似的东西？

```
 NSString *string = @"0,1,2,3";
 NSPredicate *predicate = [NSPredicate predicateWithFormat:@"self like '1' OR self like '2'"];
 NSLog(@"%@",[[string componentsSeparatedByString:@","] filteredArrayUsingPredicate:predicate]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:15:07.007

```
 id str1=@"aa,ab,ac,cd,ce,cf";
    id str2=@"aa,ac,cd,cf";
    //no ab and no ce

    id cmps1 = [str1 componentsSeparatedByString:@","];
    id cmps2 = [str2 componentsSeparatedByString:@","];        

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"NOT SELF IN %@", cmps2];
    NSArray *final = [cmps1 filteredArrayUsingPredicate:predicate]; 
    id str = [final componentsJoinedByString:@","];
    NSLog(@"%@", str); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:15:50.387

我能想到的唯一解决方案是：

```
NSMutableArray* arr1 = [str1 componentsSeparatedByString:@","] mutableCopy];
NSArray* arr2 = [str2 componentsSeparatedByString:@","];
for (NSString* str in arr2) {
  [arr1 removeObject:str];
}
NSString* newString1 = [arr1 componentsJoinedByString:@","]; 
```

这是你试过的吗？如果“str1”看起来像“1,1,2,2,2”，那么您可能需要做更多的工作来消除重复项。但基本上就是这样。

# javascript - 在输入中使用的语法

> ID：13954104
> 
> 赞同：2
> 
> 时间：2012-12-19T14:05:58.687
> 
> 标签：javascript, asp.net-mvc

我有错误`='@`

> 未终止的字符串常量

```
<input class="blue" type="button" onclick="location.href='@(Url.Action("Index", "Home", Model.RouteData))';" value="Index"/> 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:08:33.637

```
<input class="blue" type="button" onclick="location.href='@(Url.Action(\"Index\", \"Home\", Model.RouteData))';" value="Index"/> 
```

这应该有效。但是你真的应该限制内联 CSS/JS 的使用。

像这样的东西应该更好。

HTML

```
<input id="button" class="blue" type="button" value="Index"/> 
```

JS

```
document.getElementById("button").onclick= function(){
   location.href='@(Url.Action("Index", "Home", Model.RouteData))';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:15:54.933

字符串常量必须用一对引号括起来。

试试这个-

```
<input class="blue" type="button" onclick="location.href='@(Url.Action('"Index"', '"Home"', Model.RouteData))';" value="Index"/> 
```

# javascript - Javascript方法没有返回值

> ID：13954107
> 
> 赞同：-2
> 
> 时间：2012-12-19T14:06:15.257
> 
> 标签：javascript, object

> **可能重复：**
> [如何返回 AJAX 响应文本？](https://stackoverflow.com/questions/1225667/how-to-return-ajax-response-text)
> [变量未返回 JQuery](https://stackoverflow.com/questions/12475269/variable-doesnt-get-returned-jquery)
> [AJAX 未更新变量](https://stackoverflow.com/questions/13883813/ajax-not-updating-variable)

我对此代码有疑问：

```
/**
 * facebook Object*/
var fbObject = new Object();

/**
 * Function to get login status
 * @returns boolean Logged in status
 * */
fbObject.getLoginStatus = function() {
    FB.getLoginStatus(function(response) {
        if (response.status == 'connected') {
              console.log('logged in');
              return true;
            } else {
              console.log('not logged in');
              return false;
            }
    });
}

var status = fbObject.getLoginStatus();

    alert('Status: '+ status); 
```

我的问题是 getLoginStatus 方法没有返回值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:08:27.020

该方法是异步的，您以同步方式使用它。在回调函数中返回值是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:09:45.380

该函数是异步的，

我要做的是在实际回调中运行“回调代码”：

```
 fbObject.getLoginStatus = function() {
    FB.getLoginStatus(function(response) {
        if (response.status == 'connected') {
              console.log('logged in');
              alert('Status: '+ true);
            } else {
              console.log('not logged in');
              alert('Status: '+ false);
            }
    });
} 
```

或将回调传递给函数，或停止，直到函数返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:08:07.210

你需要一个**回调**

Ajax 请求不返回任何内容，它们是***异步***的。

* * *

尝试这个：

```
var status = function(s){
    alert('Status: '+ s);
};

/**
 * Function to get login status
 * @returns boolean Logged in status
 * */
fbObject.getLoginStatus = function() {
    FB.getLoginStatus(function(response) {
        if (response.status == 'connected') {
           console.log('logged in');
           status(true);
         } else {
           console.log('not logged in');
           status(false);
         }
    });
} 
```

# java - XSLT 2.0 - 遍历 Java 对象列表

> ID：13954110
> 
> 赞同：0
> 
> 时间：2012-12-19T14:06:49.097
> 
> 标签：java, xslt, xslt-2.0

我有一个 XSL，它旨在创建 XML 的副本，但在 XML 中的某些元素中添加了一些属性。XSL 调用一个 Java 函数，该函数返回 CInfo 类型的对象列表 (java.util.List)，该类型*当前*是一个非常简单的类，定义如下：

```
public class CInfo {
    public int getNewVal() {
        return 12345;
    }
} 
```

我现在面临 XSL 中以下代码段的问题：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0"
    xmlns:list="java.util.List"
    xmlns:saxon="http://saxon.sf.net/"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    ...
    ...>

...
<xsl:variable name="infoList"
    select="up:computeUpdates($updator)"/>

<xsl:for-each select="$infoList">
    <xsl:variable name="cinfo" select="."/>
    <xsl:variable name="newVal" select="ci:getNewVal($cinfo)"/>
...
...
</xsl:for-each> 
```

*我验证的computeUpdates()*确实被 XSL 调用，它返回一个列表，其中只包含一个 CInfo 类型的实例。问题发生在*xsl:for-each*，它给出以下错误：

```
Error on line 89
  XPTY0019: Required item type of first operand of '/' is node(); supplied value has item
  type java:com.mproj.mpkg.CInfo
  at xsl:for-each (#76)
     processing "com.mproj.mpkg.."
  at xsl:apply-templates (#48) 
```

不知何故，XSL 似乎无法遍历*infoList*。奇怪的是，我正在处理的代码库中现有的 XSL 具有非常相似*的 for-each*并且能够迭代另一个类的 Java 对象列表（尽管类似于 CInfo）并且似乎没有给出任何问题。我错过了什么吗？使 XSLT 迭代 Java 对象列表的标准过程是什么？有什么可以帮助我的例子吗？我尝试在网上搜索此类循环的示例以及上述问题的可能解决方案，但到目前为止还没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:29:04.580

您还没有向我们展示错误出现的第 89 行。我的猜测是它可能包含表单的表达式

$信息列表/XXXXX

这是失败的，因为（如错误消息所述）“/”的 lh 操作数必须是节点序列。

# delphi - dcc32 警告 UnloadProcs.pas(59): W1035 函数“GetType”的返回值可能未定义

> ID：13954116
> 
> 赞同：1
> 
> 时间：2012-12-19T14:07:24.540
> 
> 标签：delphi, function, build, warnings, delphi-xe2

有一个数据类型

```
type
TDataTypeId = (DataTypeId_String, DataTypeId_SmallInt, DataTypeId_Integer, DataTypeId_Word,
               DataTypeId_Boolean, DataTypeId_Float, DataTypeId_Currency,
               DataTypeId_BCD, DataTypeId_FmtBCD, DataTypeId_Date,
               DataTypeId_Time, DataTypeId_DateTime, DataTypeId_TimeStamp,
               DataTypeId_Bytes, DataTypeId_VarBytes, DataTypeId_Blob,
               DataTypeId_Memo, DataTypeId_Graphic, DataTypeId_fmtMemo,
               DataTypeId_FixedChar, DataTypeId_WideChar, DataTypeId_LargeInt,
               DataTypeId_Array, DataTypeId_FixedWideChar, DataTypeId_WideMemo); 
```

有一个函数接受包含此类型值之一的行，返回此值

```
Function GetType(str: string): TDataTypeId;
var
typeidx: TDataTypeId;
typestr: string;
begin
for typeidx := Low(TDataTypeID) to High(TDataTypeID) do
 begin
  typestr:=GetEnumName(TypeInfo(TDataTypeId),Ord(typeidx));
  typestr:=Copy(typestr, 12, length(typestr)-11);
  //Memo.Lines.Add(typestr+'\n');
  if (AnsiCompareStr(str, typestr)=0) then
     Result:=typeidx
 end;
 end; 
```

结果，有一个程序集

```
[dcc32 Warning] UnloadProcs.pas(59): W1035 Return value of function 'GetType' might be undefined 
```

如何转换没有出现警告的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:14:25.250

编译器警告是准确的。如果 if 语句永远不会计算为`True`，因为没有找到匹配项，则循环不会分配给 Result。然后函数退出而不赋值。

您的选择：

1.  在循环完成后，为 分配一个值`Result`，表示未找到匹配项。
2.  在循环完成后引发异常。

我还建议您`exit`在分配`Result`. 当您找到答案时，没有必要继续循环。

我可能会这样写这个函数：

```
Function GetType(str: string): TDataTypeId;
var
  typestr: string;
begin
  for Result := low(Result) to high(Result) do
  begin
    typestr := GetEnumName(TypeInfo(TDataTypeId),Ord(typeidx));
    typestr := Copy(typestr, 12, length(typestr)-11);
    if AnsiSameStr(str, typestr) then
      exit;
  end;
  raise EEnumNotFound.CreateFmt('Enum not found: %s', [str]);
end; 
```

注意`Result`变量作为循环变量的使用。这是惯用的，并且有利于减少您声明的局部变量的数量。

我同意您可以使用 更有效地解决您的问题`GetEnumValue`，但我想向您展示如何以惯用的方式处理编译器警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:25:54.697

关于`result`在这样的循环中使用的一般方式，以下是您可以如何编写函数的方法：

```
Function GetType(const str: string): TDataTypeId;
var
typestr: string;
begin
 for result := Low(TDataTypeID) to High(TDataTypeID) do
 begin
  typestr:=GetEnumName(TypeInfo(TDataTypeId),Ord(result));
  typestr:=Copy(typestr, 12, length(typestr)-11);
  //Memo.Lines.Add(typestr+'\n');
  if (AnsiCompareStr(str, typestr)=0) then
     exit; // if found, returns result value
 end;
 result := DataTypeId_String; // returns STRING type by default
end; 
```

这是您可以在循环范围之外使用循环变量的唯一情况之一。生成的代码正确且经过优化。

我想你应该更好地定义一个专门的`TDataTypeId`项目，`DataTypeId_Unknown`或者如果找不到它就引发一个异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:21:25.830

其他人已经解释了警告，但例程的更好实施是这样的：

```
uses
  TypInfo, ConvUtils;

Function GetType(str: string): TDataTypeId;
var idx: Integer;
begin
  idx := GetEnumValue(TypeInfo(TDataTypeId), 'DataTypeId_'+str);
  if(idx <> -1)then Result := TDataTypeId(idx)
  else RaiseConversionError('Unknown typeID name: '+str);
end; 
```

即无需遍历所有枚举值并将它们作为字符串进行比较，`GetEnumValue`而是使用该函数。

# java - 在 Java Web 服务上记录事件

> ID：13954119
> 
> 赞同：2
> 
> 时间：2012-12-19T14:07:35.737
> 
> 标签：java, mysql, log4j, tomcat7

我目前正在开发一个在 Apache Tomcat 7 上运行的 Java Web 应用程序。由于我想将一些信息记录到数据库中，我使用以下配置文件信息来启动我的 Logger：

```
log4j.rootLogger = DEBUG, DB
log4j.appender.DB=org.apache.log4j.jdbc.JDBCAppender
log4j.appender.DB.URL=jdbc:mysql://localhost:3306/cap_recommender_log
log4j.appender.DB.driver=com.mysql.jdbc.Driver
log4j.appender.DB.user=log_user
log4j.appender.DB.password=some_password
log4j.appender.DB.sql=INSERT INTO notify_service_log(date, logger, level, message) VALUES('%d{YYYY-MM-dd}','%C','%p','%m')
log4j.appender.DB.layout=org.apache.log4j.PatternLayout 
```

另外，notify_service_log 表如下：

```
CREATE TABLE `notify_service_log` ( 
    `date` date NOT NULL,
    `logger` varchar(256) NOT NULL,
    `level` varchar(10) NOT NULL,
    `message` text NOT NULL,
    KEY `index_level` (`level`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

最后，web服务代码如下：

```
package com.imis.cap.service.notify;

import com.imis.cap.module.etl.EtlModuleClient;
import gr.aia.cap.eventbroker.v1.ArrayOfServiceMessage;
import gr.aia.cap.eventbroker.v1.BooleanResponse;
import gr.aia.cap.eventbroker.v1.ServiceMessage;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.jws.WebService;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import javax.sql.DataSource;
import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;

@WebService(serviceName = "NotifyService", portName = "HttpBinding_NotifyService", endpointInterface = "gr.aia.cap.eventbroker.v1.NotifyService", targetNamespace = "http://www.aia.gr/cap/eventbroker/v1/", wsdlLocation = "WEB-INF/wsdl/NotifyService/NotifyService.wsdl")
public class NotifyService {

    private String username;

    private String password;

    private String log_properties_file;

    private DataSource registration_db;

    private static org.apache.log4j.Logger notifyServiceLogger = 
        Logger.getLogger(NotifyService.class);

    public NotifyService() {
        Context context;
        try {
            context = (Context) new InitialContext().lookup("java:comp/env");
            this.username = (String) context.lookup("CAP_RECOMMENDER_UNAME");
            this.password = (String) context.lookup("CAP_RECOMMENDER_PASS");
            this.registration_db = (DataSource) context.lookup("jdbc/cap_registration_db");
            this.log_properties_file = (String) context.lookup("NOTIFY_SERVICE_LOG_PROPERTIES_FILE");
        }catch(NamingException e) {
            System.err.println(e.getMessage());
            notifyServiceLogger.error("NotifyService: NamingException occured during construction. Message: " +
                e.getMessage());
        }
        PropertyConfigurator.configure(this.log_properties_file);
        notifyServiceLogger.info("NotifyService: Object constructor completed successfully.");
   }

   public gr.aia.cap.eventbroker.v1.BooleanResponse notify(gr.aia.cap.eventbroker.v1.NotifyRequest request) throws ParseException {
    ArrayOfServiceMessage arrayOfServiceMsg = new ArrayOfServiceMessage();
    ServiceMessage msg = new ServiceMessage();
    BooleanResponse response = new BooleanResponse();
    EventTypeReader eventType = new EventTypeReader(request);
    String regCode = request.getRegistrationCode();
    String dbRegCode = "";
        **notifyServiceLogger.info("NotifyService.notify(): Called with reg-code: " + request.getRegistrationCode() + ".");**

    /**Some more code**/
    return new BooleanResponse(); //Sample response
    }
} 
```

执行通知过程调用的客户端代码如下：

```
package notifyclient;

import gr.aia.cap.eventbroker.v1.ArrayOfAttribute;
import gr.aia.cap.eventbroker.v1.BooleanResponse;
import gr.aia.cap.eventbroker.v1.EventType;
import gr.aia.cap.eventbroker.v1.NotifyRequest;

public class NotifyClient {

    public static void main(String[] args) {
        NotifyRequest request = new NotifyRequest();
        request.setRegistrationCode("blasdadasd");
        request.setAttributes(new ArrayOfAttribute());
        request.setEventType(EventType.USER);
        BooleanResponse response = notify(request);
        System.out.println("Output: " + response.getErrors().getServiceMessage().toString());
    }

    public static gr.aia.cap.eventbroker.v1.BooleanResponse notify(gr.aia.cap.eventbroker.v1.NotifyRequest request) {
        gr.aia.cap.eventbroker.v1.NotifyService_Service service = new gr.aia.cap.eventbroker.v1.NotifyService_Service();
        gr.aia.cap.eventbroker.v1.NotifyService port = service.getHttpBindingNotifyService();
        return port.notify(request);
    }
} 
```

我必须在这一点上通知您，执行 Web 服务调用所需的类是由 Netbeans 7.2 自动生成的。

问题在于构造函数的消息被记录到数据库中，但通知函数中的信息消息从未被记录。为什么会这样？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T12:59:40.920

如评论`PropertyConfigurator.configure(this.log_properties_file);`所述，在方法中记录器调用上方的行中添加`notify()`解决了该问题。

# css - Rails 邮件样式

> ID：13954121
> 
> 赞同：3
> 
> 时间：2012-12-19T14:07:39.303
> 
> 标签：css, ruby-on-rails, haml, sass, actionmailer

为什么我在我的邮件中收到默认样式的邮件？在代码中我对其进行了一些样式设置，但为什么在 gmail 上我看到默认布局？我的代码是这样的：

```
!!!
%html
  %head
    %meta{:content => "text/html; charset=utf-8", "http-equiv" => "Content-Type"}
      %title Покупка автозапчастей
      :css
        body, td { background-color:#cecece; color:#000000; font-size:14px; font-family:Verdana,Helvetica,Arial; }
        .blue { background-color: blue; height:2px; color: white; }
        .notice {margin: 10px auto;  background-color: #fbb752;  border: 1px solid #cecece; }
  %body
    .blue
      %h3
        Новый заказ
      %b
        Внимание, недавно на сайте сформирован новый заказ!
        = @order.id
    .notice
      %table
        %tr
          %th
            id клиента
          %th
            Улица
          %th
            Здание
          %th
            Общая сумма
          %th
            Статус
          %th
            Открыт
        %tr
          %td
            = @order.user.id
            = @order.user.email
          %td
            %b
              = @order.street
          %td
            = @order.building
          %td
            %b
              = @order.totalcost
          %td
            %b
              = @order.orderstatus.name
          %td
            = @order.created_at
      %br/
      %table
        %tr
          %th
            Артикул
          %th
            Цена
          %th
            Количество      
        - @order.line_items.each do |l|
          %tr{ :class => cycle("zebra-stripe zebra-grey zebra1", "zebra-stripe zebra-grey zebra2")}      
            %td
              = l.description
            %td
              = l.price
            %td
              = l.quantity 
```

那么如何让我的邮件程序像我的代码一样在我的电子邮件服务 (gmail) 上发送良好的样式字母？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:09:15.740

`<style>`Gmail 会从 HTML 电子邮件中删除所有标签。

如果您希望您的样式出现在 Gmail 中，则需要使用内联样式属性。

# function - 如何获得 30 秒的延迟

> ID：13954122
> 
> 赞同：0
> 
> 时间：2012-12-19T14:07:41.003
> 
> 标签：function, vba, time

我想在 vba 中产生 30 秒的延迟。我不能使用“计时器”，因为我的应用程序将在一夜之间运行到第二天早上。（计时器将生成直到午夜经过的秒数（以分数表示）。除了 Timer 和 Application.WaitNow() 之外，还有其他方法可以实现这一点。
我尝试使用以下代码，但它抛出代码执行已被中断错误。

```
Function Wait()

Dim StartSecond
Dim EndSecond

StartSecond = Second(Now)
'Sheets("SampleOutputEx").Range("M2") = StartSecond

EndSecond = (StartSecond + 30) Mod 60                             
While Second(Now) <> EndSecond
  DoEvents
Wend

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:13:12.090

试试这个

```
Declare Sub Sleep Lib "kernel32" Alias "Sleep" _
(ByVal dwMilliseconds As Long) 
```

每当你想睡觉时调用这个函数

```
Function Wait(Seconds as integer)

  Sleep Seconds*1000

End Function 
```

你也可以使用

```
expression.OnTime(When, Name, Tolerance) 
```

并通过在当前时间上增加 30 秒来设置下一次执行的时间。

[这篇](http://vbadud.blogspot.in/2008/03/sleep-function-in-excel-vba.html)文章有更好的解释

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T07:10:19.857

开始了。从来没有想过答案会很简单。

```
Function Wait()
Dim StartSecond As Single
Dim EndSecond
StartSecond = Now

EndSecond = DateAdd("s", 30, Now)

While Now < EndSecond
DoEvents
Wend

End Function 
```

这对我来说很好。对此的任何评论都非常感谢。

# iphone - 如何保存 UIView 上存在的不同 UIImageView 的状态？

> ID：13954130
> 
> 赞同：0
> 
> 时间：2012-12-19T14:08:07.153
> 
> 标签：iphone, objective-c, ios6

我有不同的图像，`UIView`并且我创建了一个子类，`UIImageView`从中我可以执行旋转、放大、缩小、翻转等操作。我能够成功地做到这一点，但问题是，如果我已经缩放`UIImageView`然后我执行翻转操作，那么翻转操作不适用于缩放图像，而是对我在开始时拥有的初始图像进行操作。

有人对国家储蓄有一些想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:49:22.403

您可以将内容的当前状态保存`UIView`到`UIImage`

```
UIGraphicsBeginImageContext(size);
[yourImageView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

您可以将此图像设置为您的图像视图并翻转它，如果您需要能够撤消您需要在每个阶段保存上下文的操作，但是如果图像相对较大，这可能会导致内存问题。

我希望这能帮到您。但是，如果这个想法不能满足您的需求，您可以尝试用更多细节来描述它。

# c# - 用于无线电网络的 TCP

> ID：13954131
> 
> 赞同：1
> 
> 时间：2012-12-19T14:08:09.760
> 
> 标签：c#, tcp, radio

> **可能重复：**
> [如何在 C# 中配置套接字连接超时](https://stackoverflow.com/questions/1062035/how-to-config-socket-connect-timeout-in-c-sharp)

我有一个无线电网络，用于连接大约 20 个节点。我正在使用 TCP，但问题是在收到 ack 之前 TCP 重新发送它的数据包。网络有大约 10 到 30 秒的确认延迟。我的应用程序要求是可靠的通信我不能使用 UDP，建议我为延迟和非常慢的网络使用柚木 TCP 的方法。

# mysql - 如何组合三个不同的查询

> ID：13954134
> 
> 赞同：1
> 
> 时间：2012-12-19T14:08:16.377
> 
> 标签：mysql, sql

我有三个疑问：

```
SELECT EVENT_TITLE, ORIG_START_DT FROM EVENT_MAIN WHERE USERID='4' AND EVENT_STATUS='P'
SELECT GREET_TITLE, BROADCAST_SCH_DT FROM GREET_MAIN WHERE USERID='4' AND GREET_STATUS='P'
SELECT POLL_TITLE,CREATE_DTTM FROM POLL_MAIN WHERE USERID='4' AND POLL_STATUS='P' 
```

如何将这三个查询组合成一个查询以获得这样的结果。

对于相同状态的每个 USERID，表可能包含不止一行。

```
EVENT_TITLE | ORIG_START_DT | GREET_TITLE | BROADCAST_SCH_DT | POLL_TITLE | CREATE_DTTM 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:10:00.803

使用`UNION`（隐式不同）或`UNION ALL`类似：

```
SELECT 
  EVENT_TITLE "Title", 
  ORIG_START_DT "DT"
FROM EVENT_MAIN WHERE USERID='4' AND EVENT_STATUS = 'P'
UNION ALL
SELECT 
  GREET_TITLE, 
  BROADCAST_SCH_DT 
FROM GREET_MAIN WHERE USERID='4' AND GREET_STATUS = 'P'
UNION ALL
SELECT 
  POLL_TITLE,
  CREATE_DTTM 
FROM POLL_MAIN  WHERE USERID='4' AND POLL_STATUS   = 'P'; 
```

* * *

## 更新

如果要从表单中的这三个查询中获取数据：

```
EVENT_TITLE | ORIG_START_DT | GREET_TITLE | BROADCAST_SCH_DT | POLL_TITLE | CREATE_DTTM 
```

你可以这样做：

```
SELECT  
  EVENT_TITLE , 
  ORIG_START_DT ,
  GREET_TITLE, 
  BROADCAST_SCH_DT,
  POLL_TITLE,
  CREATE_DTTM
FROM
(
  SELECT * 
  FROM EVENT_MAIN
  WHERE USERID='4' AND EVENT_STATUS = 'P'
) t1
INNER JOIN
(
  SELECT *
  FROM GREET_MAIN
  WHERE USERID='4' AND GREET_STATUS = 'P'
) t2
INNER JOIN 
(
  SELECT * 
  FROM POLL_MAIN
  WHERE USERID='4' AND POLL_STATUS = 'P'
) t3 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!2/bf08a/9)

这会给你类似的东西：

```
| EVENT_TITLE | ORIG_START_DT | GREET_TITLE | BROADCAST_SCH_DT | POLL_TITLE | CREATE_DTTM |
-------------------------------------------------------------------------------------------
|      Title4 |           O44 |        DTdd |              O44 |    ddsfTdd |         O44 |
|      Title4 |           O33 |        DTdd |              O44 |    ddsfTdd |         O44 |
........ 
```

**请注意：**据我所知，这种查询将交叉连接三个表，因为我没有指定`JOIN`条件，因为您没有在问题中确定。如果三个表之间存在任何关系，请`JOIN`使用该`ON`子句指定条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:23:39.003

要在一行上获得结果，您需要使用连接：

```
SELECT EVENT_TITLE, ORIG_START_DT, GREET_TITLE, BROADCAST_SCH_DT, POLL_TITLE,CREATE_DTTM
FROM EVENT_MAIN em join
     GREET_MAIN gm
     on em.userid = gm.userid join
     POLL_MAIN pm
     on em.userid = pm.userid
WHERE em.EVENT_STATUS='P' and
      gm.GREET_STATUS='P' and
      pm.POLL_STATUS='P' and
      em.USERID = '4' 
```

当您想要查看更多用户而不是仅 1 个时，这也使您更容易。

# javascript - 获取 Gmail 邮件

> ID：13954137
> 
> 赞同：0
> 
> 时间：2012-12-19T14:08:24.970
> 
> 标签：javascript, gmail, google-apps-script

我有一个代码可以获取 Gmail 中的电子邮件正文

但是正文带有“HTML标签”，我如何过滤掉这些“标签”？

例子：

身体：

```
<span><span style="font-weight:bold" dir="ltr">eu</span>: 
<a href="http://neuhaus.com.br" target="_blank">neuhaus.com.br</a>
D6477233ACC7C56D</span><br> 
```

我需要过滤的身体：

欧盟：neuhaus.com.br D6477233ACC7C56D

代码：

```
function processPending() {  
  var label_pending = GmailApp.getUserLabelByName('Teste');  
  var label_done = GmailApp.getUserLabelByName('TesteDone');  
  var sheet = SpreadsheetApp.getActiveSheet();

  var rowstart = (sheet.getLastRow() + 1)

  var threads = label_pending.getThreads();  

  for (var t in threads) {  
    var thread = threads[t];  

    var message = thread.getMessages()[0];

    var messbody = message.getBody();

    thread.removeLabel(label_pending);  
    thread.addLabel(label_done);

    sheet.getRange(rowstart, getColIndexByName('Conteúdo')).setValue(messbody);
    rowstart++;
  }
  return 0;
}  

function getColIndexByName(colName) {
  var sheet = SpreadsheetApp.getActiveSheet();
  var numColumns = sheet.getLastColumn();
  var row = sheet.getRange(1, 1, 1, numColumns).getValues();
  for (i in row[0]) {
    var name = row[0][i];
    if (name == colName) {
      return parseInt(i) + 1;
    }
  }
  return -1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:27:01.460

使用[`textContent`](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)DOM 元素的属性。它的 HTML 标签被剥离了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:22:47.083

如果允许使用 jQuery，您应该检查[$.text()](http://api.jquery.com/text/)函数。

```
var text = $('<div>Text 1<b>Bold Text</b> Text 2</div>').text();
// stores 'Text 1 Bold Text Text 2' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:20:54.647

您可以尝试使用正则表达式来剥离标签

```
var stripped = messbody.replace(/(\<[^>]+\>)+/g,' '); 
```

这有时会出现问题，因此您应该小心，但是对于您列出的示例这样的简单 HTML，这将起作用。

# visual-studio-lightswitch - 如何更改灯光开关发布位置？

> ID：13954138
> 
> 赞同：0
> 
> 时间：2012-12-19T14:08:25.433
> 
> 标签：visual-studio-lightswitch

基本上，我已经在 Web 服务器（即 www.firstsite.com）上部署了 Lightswitch 桌面应用程序，现在我必须将应用程序移动到具有另一个地址的另一台服务器（即 www.secondsite.com）。

如何更改发布位置，使已安装的客户端自动检测地址更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T14:43:15.270

只需再次*发布*应用程序（到与第一次不同的文件夹），并在*发布向导*中输入新站点的信息。

# jsf-2 - Ajax 请求不更新 bean

> ID：13954147
> 
> 赞同：0
> 
> 时间：2012-12-19T14:08:45.607
> 
> 标签：jsf-2, primefaces

我有以下片段（里面`h:body->h:form`，`h:head`已使用）：

```
<p:dataTable id="items" value="#{faNav.faRequest.items}" var="_item" emptyMessage="#{dict['web.faRequest.noItems']}">
    <p:column>
        <h:inputText id="newItemName" value="#{_item.name}" rendered="#{_item.name eq null}"/>
    </p:column>
    <p:column>
-->         <p:spinner id="newItemQuantity" value="#{_item.quantity}"/>
    </p:column>
    <p:column>
        <p:commandButton value="Añadir" update="items" actionListener="#{faNav.addItem}" rendered="#{_item.name eq null}"/> 
    </p:column>
</p:dataTable> 
```

以及bean中的功能：

```
public void addItem(ActionEvent actionEvent) {
    System.out.println("Añadiendo");
    this.faRequest.getItems().add(new RequestItem());       
} 
```

现在，我使用调试器检查函数内部的值。在那里，`name`属性已使用表单中的值更新，但`quantity`整数没有。该属性是名称，因为如果我为数量设置一个默认的非零值，表单会正确显示它。

我在 JBoss 7.1 上使用 Primefaces 3.4.2

我错过了什么？提前致谢。

更新：从 切换`<p:spinner>`到`<h:inputText>`根本没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T14:22:22.907

好的，我明白了，primefaces 没有问题，但`rendered`属性：

我得到的较小的 SSCCE 是

index3.xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org /TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head/>
<h:body>
<h:form>
    <h:column>
        <h:inputText id="newItemName" value="#{faNav.item.name}"/>
    </h:column>
    <h:column>
        <h:inputText id="newItemQuantity" value="#{faNav.item.quantity}" rendered="#{faNav.item.name eq null}"/>
    </h:column>
    <h:column>
        <h:commandButton value="Añadir" actionListener="#{faNav.setItem}" rendered="#{!faNav.item.containsData}"/> 
    </h:column>
</h:form>
</h:body>
</html> 
```

固定资产导航.java

```
@ManagedBean(name="faNav")
@ViewScoped
public class FixedAssetNav implements Serializable {

RequestItem item = new RequestItem();

public RequestItem getItem() {
    return this.item;
}

public void setItem(RequestItem item) {
    this.item = item;
}

public void setItem(ActionEvent actionEvent) {
    this.item.setContainsData(true);
    System.out.println("Setting " + this.item.getName() + " " + this.item.getQuantity());
}
} 
```

`RequestItem`只是一个具有两个字符串属性（`name`和`quantity`）和一个布尔属性（）的普通bean `containsData`。

我发现通过更改 .xhtml 中字段的顺序（移到`newItemQuantity`前面`newItemName`）确实解决了这个问题。此外，删除`rendered`属性`newItemQuantity`或将表达式更改为`true`did 也有效）。

我的猜测是，在应用值时，过程是：

1）检查是否`newItemName`被渲染。2) 如果是，`name`则更新属性。3) 检查是否`newItemQuantity`已渲染 4) 如果是，`quantity`则更新属性。

**但是第3步在更新模型后**检查了表达式（`faNav.item.name eq null`），所以突然为假，跳过第4步。

 **解决这个问题的一种更方便的方法是检查属性的相位：

```
 <h:inputText id="newItemQuantity" value="#{faNav.item.quantity}" rendered="#{(faNav.item.name eq null) || (facesContext.currentPhaseId.ordinal ne 6)}"/> 
```**

# javascript - 节点中的 req.body 是什么？

> ID：13954152
> 
> 赞同：3
> 
> 时间：2012-12-19T14:09:02.040
> 
> 标签：javascript, node.js, express

我正在学习 nodejs 和 express，在学习期间我不了解各种用途，`req`例如：

```
var id = req.params.id;
var wine = req.body; 
```

我认为我的`req`对象正在访问`body, params.id`，但我不明白这是如何工作的以及我应该期待什么结果。谁能以更简单的逐步方式解释此代码，以便我理解它？

以下是使用上述内容的一些示例代码：

```
 exports.addDoctor = function(req,res){
        var doctor = req.body;
        console.log(doctor);
            db.collection('doctors',function(err,collection){
            collection.insert(doctor,{safe:true},function(err,result){
                if (err) {
                    res.send({'error':'An error is occured'});
                } else {
                    console.log('Success: ' + JSON.stringify(result[0]));
                    res.send(result[0]);
                }
            });
        });
    } 
```

在上面的例子中`console.log(doctor)`只返回`{}`. 为什么会这样，是因为我错过了代码中特别涉及“req”的其他内容吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:11:19.327

`req`是请求对象。它记录在这里：[http ://expressjs.com/api.html#req.params](http://expressjs.com/api.html#req.params)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:19:08.550

req is an object containing information about the HTTP request that raised the event. There is a simular Question ([node.js what is res and req in expressjs?](https://stackoverflow.com/questions/4696283/node-js-what-is-res-and-req-in-expressjs)), have a look at the answers there.

# java - 避免使用 equals 和 hashcode 将重复项添加到 List

> ID：13954160
> 
> 赞同：-2
> 
> 时间：2012-12-19T14:09:50.597
> 
> 标签：java

我有两个对象，分别是 Employee 和 Person。他们都有名字和姓氏。如果 Person 和 Employee 的 firstName、lastName 已添加到列表中，我不想将对象（Employee 或 Person）添加到列表中。

使用equals和hashcode来做到这一点......

编辑：我不能使用 Set 或任何其他集合，必须使用 equals 和 hashcode 来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:21:41.157

对于 equals/hashcode 示例，您可以查看此[问题](https://stackoverflow.com/questions/2066917/overriding-equals-hashcode-in-sub-classes-considering-super-fields)。至于添加到 List，有两种选择：

1.  每次在向其添加元素之前，检查 List 是否包含使用[List.contains 方法的对象](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#contains%28java.lang.Object%29)
2.  使用[LinkedHashSet](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashSet.html)，它将保存添加元素的顺序，然后返回`new ArrayList<Employee>(employeeLinkedHashSet);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:15:28.277

由于您想将 and 的身份结合起来`Employee`，`Person`因此这不能轻易实现，除非您准备好

1.  有`Employee extends Person`和
2.  `Employees`只要它们等于s，就都等于`Person`s，而不管它们可能具有的任何其他属性。

如果这些约束对您来说是可以接受的，那么只需实施`Person#equals`并`Person#hashCode`涉及`firstName`并`lastName`使用 a`Set`来消除重复项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:15:52.393

使用[set](/questions/tagged/set "显示标记为“设置”的问题") [接口](/questions/tagged/interface "显示标记为“界面”的问题")避免重复[在 Java API Doc 中阅读更多内容](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:16:04.887

1.  实现一个`List`包装现有`List`实现的`ArrayList`
2.  将所有方法调用委托给包装列表
3.  实施`add`并且`addAll`如果它们已经在列表中，则它们不会添加这些值。

请注意，此实现与`List`接口不一致，因为用户希望调用`add` *真正*将对象添加到集合中（大小增加一）。

最好使用`Set`实现（避免重复但不保留插入顺序）或在添加*之前*检查重复：

```
 List<Person> persons = getPersonsFromSomewhere();
 Person person = getAPersonThatShallBeAddedIfNotDuplicate();
 if (!persons.contains(person)) {
    persons.add(person);
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T14:17:02.637

使用 a`Set`而不是列表。如果您需要一个列表，您可以调用`Set.toArray()`并将其传递给`List`构造函数。

你有 Employee 和 Person 类实现吗`Comparable<T>`？让 Employee 成为 Person 的子类可能会使这更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T14:18:37.090

如果您有一些应该是唯一的字段，我怀疑您应该使用地图。您可以使用作为复合键的自定义类，也可以使用分隔符将字符串组合成单个字符串。

```
Map<String, Employee> employeeMap = ....

String fullname = employee.firstName + "~" + employee.lastName;
Employee employee = employeeMap.get(fullname);
if (employee == null) {
   // not in the map so add it.
   employeeMap.put(fullname, employee);
} else {
   // employee is already in the collection.
   // alter it or produce a warning
} 
```

注意： String 已经有`equals`和`hashCode`方法，所以你不需要添加它们。

# windows-phone-7 - WP8 设备/模拟器上的 WP7.1 应用程序 - mscorlib.ni.dll 中发生“System.FormatException”

> ID：13954165
> 
> 赞同：0
> 
> 时间：2012-12-19T14:10:11.433
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone, windows-phone-8

我为 WP7.1 构建的应用程序（Silverlight 和 C#）在 7.1 设备上运行良好，但在 WP8 设备上运行良好，因此该应用程序已从 Marketplace 中删除（该应用程序在 Marketplace 中并被许多用户使用，直到 WP8释放）。

我尝试在模拟器中调试问题。我在 WP8 模拟器中运行了 7.1 版本的应用程序。在其中一行代码中，我将字符串转换为 double as

```
double osVer = Convert.ToDouble("8.0.9903"); 
```

这条线抛出

> 在 mscorlib.ni.dll 中发生了“System.FormatException”类型的异常，并且在托管/本机边界之前未处理

我不知道是什么`mscorlib.ni.dll`以及如何进一步进行。有没有人有任何想法？**注意：**该应用在 WP7.1 上运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:03:19.787

> 在其中一行代码中，我将字符串转换为“double osVer = Convert.ToDouble("8.0.9903");"。

8.0.9903 不是有效的双精度数，因为它有两个小数点。

**更新**：如果看到这种情况，WP7 和 WP8 都会抛出异常，因此看起来您在 WP8 上的应用正在从某个地方获取不同格式的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:38:24.887

`Convert.ToDouble`将使用当前的文化。因此，如果应用程序使用具有差异小数分隔符的区域性执行，则会引发 FormatException。

在大多数情况下，您需要在调用时明确提供一种文化`Convert.ToDouble`：

```
Convert.ToDouble("8.0", CultureInfo.InvariantCulture); 
```

# javascript - 为什么此地图代码不起作用？

> ID：13954167
> 
> 赞同：-2
> 
> 时间：2012-12-19T14:10:16.123
> 
> 标签：javascript, html, google-maps

我有所有的位置和和弦。这一定是我在代码中做错了什么。有人看出有什么不对吗？基本上我正在尝试用多个图钉制作一张地图，但我不太确定是什么导致这个图不起作用。

```
<!DOCTYPE html>
<html> 
<head> 
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
  <title>Google Maps Multiple Markers</title> 
  <script src="http://maps.google.com/maps/api/js?sensor=false" 
          type="text/javascript"></script>
</head> 
<body>
  <div id="map" style="width: 500px; height: 400px;"></div>

  <script type="text/javascript">
    var locations = [
      ['Kapten Nemo', 57.707957,11.934296, 4],
      ['Slimfood', 57.712283,11.944914, 5],
      ['L's Kitchen', 57.707126,11.939796, 3],
      ['Bombay Bistro', 57.708316,11.937755, 2],
      ['Mimolett', 57.712283,11.944914, 1]
    ];

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 10,
      center: new google.maps.LatLng(57.72, 11.94),
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    for (i = 0; i < locations.length; i++) {  
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][1], locations[i][2]),
        map: map
      });

      google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          infowindow.setContent(locations[i][0]);
          infowindow.open(map, marker);
        }
      })(marker, i));
    }
  </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:22:11.407

是的，事实证明 L's Kitchen 中的撇号是问题所在。

```
...
['L\'s Kitchen', 57.707126,11.939796, 3],
... 
```

这是在[http://jsfiddle.net/Morlock0821/NGmLY/](http://jsfiddle.net/Morlock0821/NGmLY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:25:30.017

改变

```
 ['L's Kitchen', 57.707126,11.939796, 3], 
```

到

```
 ["L's Kitchen", 57.707126,11.939796, 3], 
```

# algorithm - 强制 chrome 对 array#sort 使用合并排序或快速排序

> ID：13954169
> 
> 赞同：2
> 
> 时间：2012-12-19T14:10:19.557
> 
> 标签：algorithm, google-chrome, sorting

[正如这里](http://blog.rodneyrehm.de/archives/14-Sorting-Were-Doing-It-Wrong.html)所指出的，对于> 22 个元素的数组，chrome 的默认排序是不稳定的。有没有办法强制 chrome 使用稳定的排序算法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:24:18.880

Array#sort 中的稳定排序？不，您不能指定要使用的算法（标准没有说明任何内容）。因此，您可以编写自己的`sort`函数或扩展密钥：

> 不稳定的排序算法可以专门实现稳定。这样做的一种方法是人为地扩展键比较，以便使用原始数据顺序中条目的顺序作为决胜局来决定具有其他相同键的两个对象之间的比较

# javascript - 在调用 FB.init() 之前调用 FB.getLoginStatus()。如何使用 Facebook API？

> ID：13954170
> 
> 赞同：5
> 
> 时间：2012-12-19T14:10:23.617
> 
> 标签：javascript, facebook

我使用这段代码来准备 FaceBook API 的使用：

```
(function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
} (document, 'script', 'facebook-jssdk')); 
```

但是，在文档加载时，我收到以下错误：

```
FB.getLoginStatus() called before calling FB.init(). 
```

我不明白这个消息。我搜索了这个问题并找到了一些论坛主题，但不幸的是它们根本没有帮助。我决定在这里发布一个关于这个问题的问题，因为我无法解决它，因为我对 Facebook API 不熟悉。抱歉，如果我的问题对任何人来说都太简单了，并提前感谢您的任何回答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T05:22:42.147

我有相同的 Facebook 日志

```
 ***FB.getLoginStatus() called before calling FB.init().*** 
```

文件加载时。我发现`#xfbml=1`最后

```
js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1"; 
```

犯这个错误。删除后`#xfbml=1`就好了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:36:14.243

```
window.fbAsyncInit = function () {
    // init the FB JS SDK
    FB.init({
        appId: MS.FBAppID, // App ID from the App Dashboard
        //channelUrl: '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File for x-domain communication
        status: true, // check the login status upon init?
        cookie: true, // set sessions cookies to allow your server to access the session?
        xfbml: true  // parse XFBML tags on this page?
    });

    // Additional initialization code such as adding Event Listeners goes here

};

// Load the SDK's source Asynchronously
// Note that the debug version is being actively developed and might 
// contain some type checks that are overly strict. 
// Please report such bugs using the bugs tool.
(function (d, debug) {
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) { return; }
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
} (document, /*debug*/false)); 
```

我必须使用为此应用程序创建的 Facebook AppID 作为 AppID，并且我必须确保正确定义了域。

# jquery - 始终使用 jQuery 将单页站点与特定点对齐

> ID：13954171
> 
> 赞同：0
> 
> 时间：2012-12-19T14:10:29.623
> 
> 标签：jquery, html, css, jquery-mobile

我想知道是否有人遇到过，或者知道从哪里开始编写一个 jQuery 脚本，当您滚动过去某个点时，它总是会跳转到网站上的某个特定点。例如，以这个网站[http://www.bettondesignwork.co.uk/sierragrande](http://www.bettondesignwork.co.uk/sierragrande)为例，它是一个由 4 个全尺寸 div 组成的单页网站，您可以导航到或滚动浏览，但是当您滚动时，它的底部div 和另一个的顶部都可见，脚本会将最可见的 div 对齐到页面的中心？

我知道这有点啰嗦，但我的 jQuery 知识相当有限，不知道我将如何开始这个。如果有人有任何线索，我很想听听你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:21:09.893

jQM 中内置了一个漂亮的解决方案。因为您不能在 jQM 中使用锚链接（除非您使用 data-ajax="false" 但这是另一个问题）jQM 开发人员构建了内部功能来模拟这一点：

```
 $('a.anchor-class').live('click', function(ev) {
     var target = $( $(this).attr('href') ).get(0).offsetTop;
     $.mobile.silentScroll(target);
     return false;
 }); 
```

更多信息可以在这里找到：http: [//jquerymobile.com/demos/1.0/docs/api/methods.html](http://jquerymobile.com/demos/1.0/docs/api/methods.html)

当然，使用顶级示例来创建您自己的逻辑。

您应该使用 scrollstart scrollend 事件来查找您的当前位置，将其与您的 div 集合相匹配，并在需要时滚动到想要的位置。

# database - 关于 Hadoop DFS 和 MapReduce 的一些疑惑

> ID：13954176
> 
> 赞同：0
> 
> 时间：2012-12-19T14:10:55.800
> 
> 标签：database, algorithm, hadoop, mapreduce

1.  HDFS 将数据存储在 64MB/128MB 的块中，并以这些块大小在任务节点之间复制数据。这些块存储在节点的硬盘中。如果我在此声明中错了，请纠正我。

2.  该块是完全加载到 RAM 中还是需要逐行流式传输？还是两者都有可能？

3.  假设我有一个 1GB 的 CSV 文件，我想在该文件上执行一些不独立于该 CSV 文件中的每一行的计算。我的意思是计算需要处理 10 个连续的行。例如：计算行 1:10，然后是 2:11，然后是 3:12 等等。我有什么选择？将这个 1 GB 多行数据转换为单行数据，然后将其作为单个矩阵加载是一个好主意（我想如果计算复杂，在整个 64MB/128MB 块上计算，这会溢出 RAM）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:33:21.133

1）你是对的（块大小是可配置的，但我将简要介绍一下 Hadoop 架构。Hadoop 有一个主/从架构，有两个守护进程组：NameNode/DataNode/SecondaryNameNode (SNN) 和 JobTracker/TaskTracker。NameNode 是负责跟踪数据文件如何分解为文件块以及它们驻留在哪些数据节点中。NameNodes 通常不兼作 DataNodes。DataNodes 将 HDFS 块读取和写入本地文件系统（磁盘）并与其他 DataNodes 通信SNN 是一个与 NameNode 通信的辅助守护进程，用于在单点故障 NameNode 出现故障的情况下最大限度地减少停机时间和数据丢失。JobTracker master 确定代码的执行计划，TaskTracker slave 执行 JobTracker 分配的各个任务。

2) NameNode 跟踪 RAM 中的所有数据节点命名空间。数据加载到 HDFS 后，会从磁盘流式传输以进行处理（HDFS 针对顺序数据访问进行了优化）流式传输仅受存储数据的驱动器的最大 I/O 速率限制。请参阅此 Cloudera 帖子以了解最佳 HDFS 块大小[http://blog.cloudera.com/blog/2009/02/the-small-files-problem/](http://blog.cloudera.com/blog/2009/02/the-small-files-problem/)

3）你能再描述一下你的用例吗？您可能必须定义自己的 InputSplits，这可能会相当参与（参见：http: [//developer.yahoo.com/hadoop/tutorial/module4.html](http://developer.yahoo.com/hadoop/tutorial/module4.html)）。如果您可以控制数据集，则可以对其进行预处理。或者，如果您可以控制文件大小，您可以将文件以块的形式写入，比如说 62MB，块大小为 64MB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:25:36.197

1）数据沿数据节点复制。在大多数配置中，您希望您的任务节点也是数据节点。是的，它是物理存储的。

2）如果您使用标准阅读器，则 Hadoop 用户在输入拆分和“流式传输”数据上逐行“流式传输”数据。还有其他阅读器，您也可以实现自己的阅读器

3）如果你想处理一个文件的 10 行，有几种方法可以做到这一点。一种是将您的文件设置为不可分割的。然后保证整个 CSV 由一个映射器处理。您可以自己拆分文件以让很多映射器工作。我能想到的其他方法要复杂得多，或者在块边界上存在问题。我认为加载整个文件不是最好的主意，当您的 .csv 将来变得更大时，您的方法必须失败。

如果您的工作是仅地图工作，您可以添加一个 reduce 阶段并为这 10 行计算一个特殊键（例如，它们与一个特殊问题等相关）并在您的 reducer 中获取所有相关的行。不幸的是，我对你的工作了解得不够具体

如果您是 hadoop 新手，该[链接](http://developer.yahoo.com/hadoop/tutorial/)可能会帮助您进入它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:40:26.470

回答 3):

如果您不介意丢失 10 行集合中的一小部分，一个非常简单且快速的解决方案是围绕[LineReader](http://hadoop.apache.org/docs/r0.20.1/api/org/apache/hadoop/util/LineReader.html)构建一些代码- 当映射器第一次请求键/值对时，您的版本LineReader 读取 10 行，对于所有后续调用，您逐行读取。这只需要几行额外的代码。

# asp.net-mvc - 带有单选按钮的 ASP.Net MVC3 ViewModel 不起作用

> ID：13954177
> 
> 赞同：10
> 
> 时间：2012-12-19T14:10:58.593
> 
> 标签：asp.net-mvc, asp.net-mvc-3

这是我用单选按钮和复选框绑定的 ViewModel 类

```
public class MyListViewModel
{
    public bool Isselected { get; set; }
    public Int32 ID { get; set; }      
    public string EmpName { get; set; }

} 
```

**问题：** ***对于控制器类中的复选框，如果选择，我可以看到绑定模型的 IsSelected 属性为真。但在单选按钮的情况下，它总是显示为假。任何帮助表示赞赏***

**复选框**

剃刀代码

```
 @Html.CheckBox(myListObj.Isselected.ToString(), myListObj.Isselected, 
  new { id = myListObj.Isselected.ToString() }) 
```

生成的 HTML

```
 <input type="checkbox" value="true" name="myListObj[0].Isselected" id="22">
 <input type="hidden" value="false" name="myListObj[0].Isselected"> 
```

**单选按钮**

剃刀：

```
 @Html.RadioButton(myListObj.Isselected.ToString(), myListObj.ID, 
 myListObj.Isselected, new { id = myListObj.Isselected.ToString() }) 
```

html:

```
<input type="radio" value="6"
 name="myListObj[0].Isselected" id="myListObj[0].Isselected"> 
```

这里可能是什么问题？

```
Edited: 
What could be the code for binding a model with multiselect radio button. 
I mean user can select more than one Employee from a list. 
I want to know what are the employees selected with the help of Model Binding 
class with the property IsSelected. Please suggest me the possible way. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T19:34:07.157

单选按钮的`value`属性是发送到服务器的内容，因此在这种情况下，`6`正在发送值，但服务器无法`6`插入`Isselected`b/c`Isselected`类型`boolean`。

您需要将 html 更改为此

```
@Html.RadioButton(myListObj.Isselected.ToString(), true, myListObj.Isselected, new { id = myListObj.Isselected.ToString() }) 
```

Note how I changed `myListObj.ID` to just `true`. This says to the browser "if the user selects this radio button, send the value `true` to the server".

Alternatively, you could change `Isselected` to a `double?` and continue using the `ID` value. This way, if the radio button is not selected, the server will see `null`; if it is selected, the server will see `6`.

# sql - 这个 SQL 查询有什么作用？请解释

> ID：13954179
> 
> 赞同：5
> 
> 时间：2012-12-19T14:11:01.870
> 
> 标签：sql

这个查询是什么意思？

```
@numberx = @numberx -1
UPDATE  th
SET     @numberX= numberY= @numberX + 1
FROM    Table1 th
INNER JOIN Table2 td ON th.Id = td.idth
WHERE   td.anything = @anything 
```

在第 3 行，什么是“双重平等”？UPDATE 上的“来自”和“内部”是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:13:23.263

这是一个多表更新，用于为每一行分配连续的数字，`Table1`其中对应的行`Table2`具有特定的列值`anything`。

对于每个匹配的行，它将列设置`numberY`为 的值`@numberX + 1`。它还将该值重新分配回`@numberX`，这会导致`@numberX`每行递增。

这被称为“古怪更新”。这是一种未记录且无法保证生成运行总计的方法。在 2012 年`SUM() OVER (ORDER BY ...)`应改为使用。

# sql-server - 如何在跨数据库中找到外键？

> ID：13954181
> 
> 赞同：-1
> 
> 时间：2012-12-19T14:11:14.300
> 
> 标签：sql-server, tsql

我有 3 个不同的数据库，我正在编写一些存储过程。是否可以在具有数据库名称的跨数据库中找到外键？
例如：

> ForeignKey -- 表名 -- 列名 -- 引用表名 -- 引用列名 -- 引用数据库名

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:15:16.980

FK 关系不能也不存在跨数据库边界。显然，您可能在单独的数据库中拥有相关数据，但除了手动搜索之外，没有其他工具/方法可以找到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:16:11.813

要获取所有外键，

```
select t.name as TableWithForeignKey, fk.constraint_column_id as FK_PartNo , c.name as ForeignKeyColumn 
    from sys.foreign_key_columns as fk
    inner join sys.tables as t on fk.parent_object_id = t.object_id
    inner join sys.columns as c on fk.parent_object_id = c.object_id and fk.parent_column_id = c.column_id
    where fk.referenced_object_id = (select object_id from sys.tables where name = 'TableOthersForeignKeyInto')
    order by TableWithForeignKey, FK_PartNo 
```

在这里，您只需要更改数据库名称。参考：[获取外键](https://stackoverflow.com/questions/483193/how-can-i-list-all-foreign-keys-referencing-a-given-table-in-sql-server-2005)

# java - 为什么我的 Pentaho 服务器在 Linux 上运行缓慢？

> ID：13954186
> 
> 赞同：1
> 
> 时间：2012-12-19T14:11:34.243
> 
> 标签：java, linux, memory, pentaho, pentaho-design-studio

我正在使用 Pentaho 4.8，这是我的配置`start-pentaho.sh`

```
export CATALINA_OPTS="-Xms256m -Xmx1024m -XX:MaxPermSize=256m -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000" 
```

谁能解释一下这些参数是什么意思？？？

```
-Xms256m 
-Xmx1024m 
-XX:MaxPermSize=256m 
```

我没有找到任何特殊原因，为什么我的 Linux 机器上的服务器响应非常慢。我认为可能在这里增加大小可能会有所帮助，但是在我了解参数之前我不想更改，如果有人对提高我的服务器速度有任何建议，请帮助我

# java - 在 Java Instrumentation Agent 库中重新转换本机方法

> ID：13954192
> 
> 赞同：2
> 
> 时间：2012-12-19T14:11:47.500
> 
> 标签：java, java-native-interface, instrumentation, native-methods, javaagents

我正在尝试编写一个通过附加 api 动态加载的 Java 代理库，以重新转换一些方法（那些出现在某些线程的堆栈跟踪中的方法）以记录方法的进入/退出。然后通过自定义导出方法进入/退出信息`MBean`。

到目前为止，只要检测方法不是本地的，我当前的“原型”就可以工作。

根据[java.lang.instrument.Instrumentation#setNativeMethodPrefix()](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html#setNativeMethodPrefix%28java.lang.instrument.ClassFileTransformer,%20java.lang.String%29)的文档，java 代理应该可以用非本地存根方法替换本地方法，并在其名称中添加另一个带有该前缀的本地方法，然后绑定到原始本机方法的本机代码。

但是，在实施此操作时，我收到此错误：

```
java.lang.UnsupportedOperationException: class redefinition failed: attempted to add a method 
```

这是正确的，因为我添加了新的本机方法。

只有用非本地方法替换本地方法才有效，但是我不能将调用委托回原始本地方法。在另一个类中定义本机方法也不起作用，因为本机方法是通过类名和方法名查找的，没有`nativeMethodClassSuffix`或类似的。在另一个新的类加载器中定义另一个同名的类是可行的，我认为可以通过一些间接方式将调用委托给新类，但是一个本机库只能链接到由只有一个类加载的本机方法类加载器，所以我不会正确链接本机方法。

我在这里有什么明显的遗漏吗？我的代码有点长，无法在此处发布，如果有人认为它有帮助，我可以尝试构建一个小型示例 java 代理来显示问题并在此处链接到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:27:22.420

> 我在这里有什么明显的遗漏吗？我的代码有点长，无法在此处发布，如果有人认为它有帮助，我可以尝试构建一个小型示例 java 代理来显示问题并在此处链接到它。

不，如果您屏蔽了本机方法，则不再有任何方法可以从 JNI 调用它。您需要使用本机代码调用该方法。（我不知道那是什么，但如果不可能，我会感到惊讶）

另一种选择是更改对本机方法的所有引用，而不是将其屏蔽掉。这样，您仍然可以在选择时调用原始方法。

# process - VHDL中的过程是可重入的吗？

> ID：13954193
> 
> 赞同：18
> 
> 时间：2012-12-19T14:11:54.083
> 
> 标签：process, delay, vhdl, reentrancy

一个进程是否可以连续运行两次或多次`VHDL`？

如果在进程的顺序执行未完成时发生另一个事件（在敏感信号列表上）会发生什么？

有可能还是我`VHDL`为流程考虑的模型完全错误？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-12-19T16:15:43.387

进程运行时不会发生任何事件！

当一个进程被事件唤醒时，它会运行到完成（“结束进程”）或明确的“等待”语句，然后进入睡眠状态。从理论上讲，这需要零时间。这意味着如果您的流程中有循环，它们将有效地完全展开，并且当您合成时，您将生成足够的硬件来并行运行每个迭代。此外，任何过程、函数等都需要零时间——除非它们包含明确的“等待”语句（在这种情况下，进程在“等待”处暂停，就好像该过程已被内联）。

在整个过程中，所有信号都具有它们在进程唤醒时最初具有的值，并且任何信号分配都被存储起来，以便以后发生。（变量立即更新；过程中的后续语句会看到新值）。

当进程挂起时（在“等待”或“结束进程”），在所有其他进程也挂起之前什么都不会发生。（但请记住，它们都需要零时间！）。如果一个进程在“结束进程”处挂起，它将在其敏感度列表唤醒它时从头开始重新启动。如果它在明确的“等待”处暂停，则“等待”将指定一个事件或未来时间，这将在“等待”之后重新启动它。（注意：1：不要在同一过程中混合敏感列表和等待样式！2：等待直到某些事件是可合成的（尽管某些工具可能会反对）；等待一段时间只是模拟）

然后执行所有信号分配。由于所有进程都处于休眠状态，这消除了所有竞争条件和计时危险。其中一些分配（例如时钟的“1”）将导致事件被安排在对它们敏感的进程上。

完成所有信号分配后，时间向前移动一个无限短的滴答声（称为增量周期），然后唤醒所有具有预定事件的进程。

这一直持续到出现一个增量周期，其中没有安排新事件，最后模拟可以前进一个实时步长。

因此

```
process(clk)
begin
if rising_edge(clk) then
   A <= B;
   B <= A;
end if;
end process; 
```

在 VHDL 中是无危险的。

如果您需要使用 Verilog，请注意其中一些情况会有所不同，并且您不能依赖模拟结果中相同级别的可预测性。

* * *

当然，在综合中，我们会生成需要一些实时执行此过程的硬件。然而，综合和后端工具（布局和布线）保证要么忠实地遵循这个模型，要么失败并报告失败的原因。例如，他们会将所有实际延迟相加并验证总和是否小于您指定的时钟周期。（除非您将时钟速度设置得太高！）。

所以结果是，只要工具报告成功（并且您正确设置了时钟速度等时序约束），您就可以假装上述“零时间”模型是正确的，并且真实的硬件行为将与模拟相匹配。保证，排除工具错误！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T16:18:55.147

在开始使用 VHDL（或任何其他 HDL）时，丢弃所有顺序代码的概念非常重要，而是专注于通过硬件的数据流。在硬件中，一切本质上都是并行的（一切同时发生），但使用不断变化的数据（输入信号）来计算不断变化的结果（输出信号）！

无需深入探讨变量、等待命令等更高级的主题，进程中的所有内容都会同时发生。如果在同一个进程中发生冲突（多次写入同一个信号），则进程中的最后一条语句获胜，这通常是 VHDL 中“顺序”代码混淆的原因。

这是由于将值分配给信号的方式。给信号赋值时，信号的值不会立即改变！相反，分配的值会被记住，并将在以后作为实际信号值提交（为下一个增量周期做准备，这实际上是下一个时间段）。

由于下一个增量周期将在前一个增量周期的所有进程都完成之前开始，因此信号值仅在没有进程运行时才会改变。一旦所有信号都改变了，下一个增量周期就开始了，任何对改变的信号敏感的过程都将被执行。

如果一个进程对它也写入的信号敏感，那么您就有所谓的组合循环，例如，输出馈送输入的门。这（几乎）总是电路中的错误，通常会导致模拟器进入无限增量循环循环。

这就是我现在要写的全部内容，因为在我写这篇文章时，Brian Drummond 的答案刚刚弹出，但请随时发表评论，我会添加更多细节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-09T12:05:08.070

一旦一个进程开始运行（由于一个事件），它会在任何其他事件被允许触发其他任何事件之前运行到完成。

# oracle - 如何让 OCI 库在带有 R Oracle 的红帽机器上工作？

> ID：13954195
> 
> 赞同：5
> 
> 时间：2012-12-19T14:11:55.350
> 
> 标签：oracle, r, redhat, oracle-call-interface, rstudio-server

我需要让 OCI 库在我的 rhel 6.3 机器上运行，并且在找不到 OCI 头文件时遇到了一些问题。我已经安装（使用 yum install）

oracle-instantclient11.2-basic-11.2.0.3.0-1.x86_64.rpm

因为[这个官方页面](http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html)是我运行 OCI 所需要的。为了测试整个事情，我安装了 sqplus64，它在我设置`export LD_LIBRARY_PATH=/usr/lib/oracle/11.2/client64/lib`. 不幸的是，设置后找不到头文件`LD_LIBRARY_PATH`。实际上我并不感到惊讶，因为`include`这些 oracle 路径中的任何一个都没有目录。

所以问题是：我从哪里得到这些丢失的头文件？他们真的已经在那里而且我可以找到他们吗？

顺便说一句：我正在做这整个练习，因为我想在我的 R Studio 服务器上使用 ROracle，而这个 R 包依赖于 OCI 库。一旦我回到 R 领域，这条路对我来说就变得不那么颠簸了。

编辑：[这个文档](http://switch.dl.sourceforge.net/project/orclib/OCILIB%20Guides/ocilib-3.5.0-user-guide.pdf)帮助我更进一步。但是，我想我现在在“/usr/include/oracle/11.2/client64”中找到了一些头文件。**但是我必须将哪个变量设置到这个位置？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T09:50:37.160

女士们先生们，解决方案是：

```
$ ./configure --with-oracle-headers-path=/usr/include/oracle/11.2/client64/ --with-oracle-lib-path=/usr/lib/oracle/11.2/client64/lib/

$ make
$ make install 
```

至少这编译没有错误。现在让我们转向 R 包本身：

```
$ export LD_LIBRARY_PATH=/usr/lib/oracle/11.2/client64/lib:$LD_LIBRARY_PATH
$ R CMD INSTALL ROracle_1.1-7.tar.gz 
```

详细信息可以在[这里](http://cran.r-project.org/web/packages/ROracle/INSTALL)找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-11T15:14:30.630

1.  在[Oracle Instant Client 网站](http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html)上下载`oracle-instantclient`和`oracle-instantclient-devel` `rpm`
2.  使用 yum 安装它们`--nogpgcheck`（感谢[这个答案](https://ask.fedoraproject.org/en/question/31116/how-do-i-install-unsigned-packages-using-yum/?answer=31119#post-id-31119)）：

```
yum install --nogpgcheck oracle-instantclient12.1-basic-12.1.0.2.0-1.x86_64.rpm oracle-instantclient12.1-devel-12.1.0.2.0-1.x86_64.rpm 
```

3.  `LD_LIBRARY_PATH`现在通过定义,`OCI_LIB`和`OCI_INC`环境变量来安装 ROracle （如[文档](https://cran.r-project.org/web/packages/ROracle/INSTALL)中所说）：

```
LD_LIBRARY_PATH=/usr/lib/oracle/12.1/client64/lib:$LD_LIBRARY_PATH OCI_LIB=/usr/lib/oracle/12.1/client64/lib OCI_INC=/usr/include/oracle/12.1/client64 R -e 'install.packages("ROracle", repos="http://cloud.r-project.org");' 
```

# jquery - 如何在 jquery 可嵌套中包含图像

> ID：13954197
> 
> 赞同：0
> 
> 时间：2012-12-19T14:12:03.317
> 
> 标签：jquery, treeview

如何在展开/折叠按钮而不是（+/-）中包含 jquery.nestable 中的图像？

[https://github.com/dbushell/Nestable](https://github.com/dbushell/Nestable)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:19:37.857

快速浏览一下演示，使用[Firebug](https://getfirebug.com/)来检查 CSS，您可以编辑这部分 CSS 来操作 (+/-) 按钮的外观：

```
.dd-item > button:before {
    content: '+';
    /* ... */
}

.dd-item > button[data-action="collapse"]:before {
    content: "-";
} 
```

# jquery - 使用 HTML 帮助器在 cshtml 中引用 jQuery

> ID：13954198
> 
> 赞同：3
> 
> 时间：2012-12-19T14:12:11.943
> 
> 标签：jquery, model-view-controller, html-helper, global-asax

我通常使用以下方法引用 jQuery：

```
<script src='@(Url.Content("~/JavaScript/jquery.maskedinput-1.2.2.js"))' type="text/javascript"></script> 
```

我在许多页面中引用了相同的 Jquery。对静态内容（名称或版本号）的任何更改都需要更新所有视图以吸收更改。为了解决这个问题，我尝试在 Global.asax 中为 Jquery 文件创建路由，如下所示

```
routes.MapRoute("jquery.maskedinput.js", "Javascript/jquery.maskedinput-1.2.2.js"); 
```

我尝试使用如下所示的 Html Helper 在 cshtml 中调用它

```
 <script src='@Html.RouteLink("maskedinput","jquery.maskedinput.js") ' type="text/javascript"></script> 
```

我知道 RouteLink 返回一个 Anchor 标记，因此未正确设置 Source 以供 Jquery 加载。

要求：

1.  是否有任何其他 Html 助手只能返回虚拟路径（或）
2.  我需要使用名称而不是路径来引用 Jquery。该路径应在全局某处声明，以便全局文件中的单个更改可以解决该目的。

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:43:42.407

我使用这种方法来查看我`BundleCollection`的[问题](https://stackoverflow.com/questions/11104879/mvc4-bundling-strongly-typed-bundles)，但即使没有它，这仍然有效。`System.Web.Optimization`

```
namespace PROJECT.Classes
{
    public class JSBundles
    {
        public static string Test = "/scripts/test.js";
    } 
```

然后像这样使用它：

```
<script src='@(JSBundles.Test)' type="text/javascript"></script> 
```

呈现

```
<script src='/scripts/test.js' type="text/javascript"></script> 
```

请注意，这需要在您的视图中`PROJECT.Classes`或您放置它的任何位置引用。我已经在我`web.config`的视图文件夹中进行了该设置。

```
....
<add namespace="PROJECT.Classes" />
      </namespaces>
    </pages>
  </system.web.webPages.razor> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:17:58.103

您可以使用流行且很棒的 RequireJS 来使用 javascript 注入 jquery（和任何其他 js 依赖项），而不是手动提供它们

[http://requirejs.org/docs/jquery.html](http://requirejs.org/docs/jquery.html)提供设置和使用说明

# google-chrome - Chrome 扩展程序：重新激活扩展程序后 background.js 不起作用

> ID：13954199
> 
> 赞同：2
> 
> 时间：2012-12-19T14:12:13.417
> 
> 标签：google-chrome, google-chrome-extension

我的 chrome 扩展程序在我第一次安装时运行良好。但是当我停用它并再次激活它时，我的 background.js 不起作用。background.js 必须在扩展激活时开始工作。为什么当我重新激活扩展程序时它不开始工作？

**背景.js**

```
function checkOrder()
{
   //some logic...
   setTimeout(checkOrder,1000);
}

setTimeout(checkOrder,1000); 
```

**清单.json**

```
...
  "background": {
    "scripts": ["background.js"]
  },
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:06:37.753

您的代码对我有用，我不确定缺少什么！

***清单.json***

```
{
"name":"Time out",
"description":"This demonstrates time out",
"version":"1",
"manifest_version":2,
"background":{
    "scripts":["background.js"]
}
} 
```

***背景.js***

```
function checkOrder()
{
   console.log("Called..");
   setTimeout(checkOrder,1000);
}
setTimeout(checkOrder,1000); 
```

究竟是什么不起作用，函数调用没有发生吗？

# awk - awk 替换模式

> ID：13954212
> 
> 赞同：4
> 
> 时间：2012-12-19T14:13:10.373
> 
> 标签：awk

我有两个示例文件：

文件1：

```
Bolek
jeden(wzór1)
Lolek
dwa(wzór2)
trzy(wzór3) 
```

文件2：

```
czerwony
zielony
niebieski 
```

我尝试了命令：

```
awk '{while(getline a < "file2"); sub(/wzór1/, a); print }' file1
Bolek
jeden(niebieski)
Lolek
dwa(wzór2)
trzy(wzór3) 
```

我想`wzór1`在“file2”的内容上替换“file1”。我想打印：

```
Bolek
jeden(czerwony
zielony
niebieski)
Lolek
dwa(wzór2)
trzy(wzór3) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T14:20:30.183

单程：

```
$ awk -v val="$(<file2)" '{sub(/wzór1/,val);}1' file1
Bolek
jeden(czerwony
zielony
niebieski)
Lolek
dwa(wzór2)
trzy(wzór3) 
```

file2 的内容被读入变量“ `cont`”。这个变量被传递给`awk`wzor1，所有出现的 wzor1 都被变量内容替换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:31:40.453

```
awk 'NR==FNR{r=r s $0; s=ORS; next} {sub(/wzór1/,r)} 1' file2 file1 
```

假设您在 UNIX 上，这是迄今为止发布的 2 个解决方案中的方法之间的区别，请注意“file2”末尾的空行：

```
$ cat file2
czerwony
zielony
niebieski

$ awk 'NR==FNR{r=r s $0; s=ORS; next} {sub(/wzr1/,r)} 1' file2 file1
Bolek
jeden(czerwony
zielony
niebieski
)                   <--- note the empty line is reproduced
Lolek
dwa(wzr2)
trzy(wzr3)
$ awk -v val="$(<file2)" '{sub(/wzr1/,val);}1' file1
Bolek
jeden(czerwony
zielony
niebieski)          <--- note the empty line has been removed
Lolek
dwa(wzr2)
trzy(wzr3) 
```

如果您不在 UNIX 上，那么我认为 shell 解决方案将是 N/A 。

# warnings - GCC 警告选项的用例 -Wno-sign-compare、-Wno-type-limits 和 -Wno-logical-op

> ID：13954216
> 
> 赞同：0
> 
> 时间：2012-12-19T14:13:16.433
> 
> 标签：warnings, mingw, gcc-warning

我正在为使用 MinGW 构建的项目决定编译器设置。GCC 似乎有一组非常庞大的选项来控制警告。

但我不明白的是，为什么提供一个选项来禁用一些关键且几乎不会造成任何滋扰的警告。

**-Wno-sign-compare：**禁用警告，当有符号值和无符号值之间的比较在有符号值转换为无符号时会产生错误结果时发出警告。

**-Wno-type-limits：**由于数据类型的范围有限，如果比较始终为真或始终为假，则禁用警告，但不警告常量表达式

**-Wno-logical-op：**禁用警告表达式中逻辑运算符的可疑使用的警告。这包括在可能需要按位运算符的上下文中使用逻辑运算符

对我来说，这些确实是有效的警告，我想不出可以禁用它们的用例。如果我能得到一些这样的警告不严重的用例并且修复它们进行代码更改很困难，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T11:24:51.900

从几天前开始，我就完全同意了。但是，至少对于 -Wno-type-limits 我现在知道一个用例：

如果您检查枚举的值是否真的在有效范围内，有时会出现这样的结构：

```
 /* Check if the Input Error is within range */
  if ((ErrorId >= (CS_ErrHdl_ErrorId_t)0) && (ErrorId < CS_ErrHdl_ErrId_EndOfList))
  {
    ...
  } 
```

where`CS_ErrHdl_ErrorId_t`是枚举类型并且`ErrorId`属于该枚举类型。

作为标准枚举（没有给出明确的值）总是以 0 开头，总是有警告：

由于数据类型的范围有限，比较总是正确的 [-Wtype-limits]

在这种特殊情况下，它有助于关闭该警告，因为它会污染所有编译器输出。

（当然有人可能会争论这种比较是否有用。但是，它经常被使用。）

干杯，菲利克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-13T17:30:05.440

我有一个`clock_t`未签名的环境（ARM mbed OS）。但是 C 标准库说`clock()`应该在失败时返回 -1，所以我检查了 then 的性质：`if(clock() < 0)`. 这会抛出 -Wtype-limits 因为`clock()`不能返回负整数。

对我来说更改代码以匹配不合格环境可能很容易，但由于没有负面影响，我宁愿编写正确的可移植代码并在此环境中禁用警告。

# python - 如何在 Python 中加入混合列表（数组）（其中包含整数）？

> ID：13954222
> 
> 赞同：11
> 
> 时间：2012-12-19T14:13:28.933
> 
> 标签：python

我有一个混合列表（数组）

```
a = ["x", "2", "y"]
b = ["x", 2, "y"]
print ":".join(a)
print ":".join(b) 
```

第一个连接有效，但第二个连接抛出 TypeError 异常

我想出了这个，但这是 Python 解决方案吗？

```
print ":".join(map(str, b)) 
```

最后顺便说一句，我只想将此字符串写入文件，所以如果有特定的解决方案，我也会很感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T14:15:12.627

您的解决方案运行良好，可能是对中小型列表执行此操作的最快方法之一，但它会创建一个不必要的列表（在 python2.x 中）。通常这不是问题，但在少数情况下，根据 object `b`，这可能是一个问题。另一个在 python2 和 python 3 中是惰性的是：

```
':'.join(str(x) for x in b) 
```

python 2.7.3 的一些时间安排：

```
$ python -m timeit -s 'b = ["x", 2, "y"]' '":".join(map(str,b))'
1000000 loops, best of 3: 1.66 usec per loop
$python -m timeit -s 'b = ["x", 2, "y"]' '":".join([str(x) for x in b])'
1000000 loops, best of 3: 1.49 usec per loop
$ python -m timeit -s 'b = ["x", 2, "y"]' '":".join(str(x) for x in b)'
100000 loops, best of 3: 3.26 usec per loop
$python -m timeit -s 'from itertools import imap; b = ["x", 2, "y"]' '":".join(imap(str,b))'
100000 loops, best of 3: 2.83 usec per loop 
```

python3.2的一些时间安排：

```
$ python3 -m timeit -s 'b = ["x", 2, "y"]' '":".join(map(str,b))'
100000 loops, best of 3: 2.6 usec per loop
$ python3 -m timeit -s 'b = ["x", 2, "y"]' '":".join([str(x) for x in b])'
100000 loops, best of 3: 2.08 usec per loop
$ python3 -m timeit -s 'b = ["x", 2, "y"]' '":".join(str(x) for x in b)'
100000 loops, best of 3: 3.39 usec per loop 
```

请注意，如果您让循环变得更大，则差异变得不那么重要：

python2.7.3：

```
$ python -m timeit -s 'b = list(range(10000))' '":".join(str(x) for x in b)'
100 loops, best of 3: 4.83 msec per loop
$ python -m timeit -s 'b = list(range(10000))' '":".join([str(x) for x in b])'
100 loops, best of 3: 4.33 msec per loop
$ python -m timeit -s 'b = list(range(10000))' '":".join(map(str,b))'
100 loops, best of 3: 3.29 msec per loop 
```

蟒蛇3.2.0

```
$ python3 -m timeit -s 'b = list(range(10000))' '":".join(str(x) for x in b)'
100 loops, best of 3: 6.42 msec per loop
$ python3 -m timeit -s 'b = list(range(10000))' '":".join([str(x) for x in b])'
100 loops, best of 3: 5.51 msec per loop
$ python3 -m timeit -s 'b = list(range(10000))' '":".join(map(str,b))'
100 loops, best of 3: 4.55 msec per loop 
```

*所有时间都在我的 MacbookPro、OS-X 10.5.8 intel core2duo 上完成......

笔记，

*   python2.x 在所有情况下都比 python3.x 快（对我来说）
*   列表理解对于您的示例列表来说是最快的，但`map`对于更大的列表来说更快。 `map`对于小列表可能会更慢，因为您需要查找函数，而列表理解不能被“隐藏”，因此不需要执行查找。*巨大*的列表可能还有另一个转折点，其中构建中间列表所需的时间变得很重要。
*   生成器表达式总是最慢的（但在这两种情况下都是懒惰的）

# excel - 在excel中绘制动态图

> ID：13954227
> 
> 赞同：0
> 
> 时间：2012-12-19T14:13:55.190
> 
> 标签：excel

我有以下数据

```
Name Date      Number_of_apples
-------------------------------
abc  1-1-2012  5
abc  2-1-2012  3
xyz  1-1-2012  4
xyz  2-1-2012  2
xyz  3-1-2012  6 
```

我想在 excel 中绘制一个代表上述数据的二维折线图。

图表应包含`Date`在 X 轴和`Number of apples`Y 轴中。

name 的示例图`abc`：

![在此处输入图像描述](../Images/7ef4de2d60eb0c91cc66ba91694b7ea4.png)

**根据名称的选择，图表应更新以表示该名称的数据。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:25:17.793

这对我有用。一些注意事项：

1.  这段代码需要放在一个`Worksheet`模块中
2.  要更新图表，只需单击`name`列中的名称，例如“xyz”、“abc”等。
3.  如果没有图表，它会先创建一个，然后再更新同一个图表

这是代码：

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Not Intersect(Target, Range("A:A")) Is Nothing Then
        UpdateChart Target
    End If
End Sub

Sub UpdateChart(name As Range)
    Dim startRow As Integer, lastRow As Integer
    Dim namerng As Range, data As Range, applechart As ChartObject

    Set namerng = Range("A1:A" & Range("A1").End(xlDown).Row)

    startRow = WorksheetFunction.Match(name.Value, namerng, 0)
    lastRow = startRow + WorksheetFunction.CountIf(namerng, name.Value) - 1

    On Error Resume Next
    Set applechart = ActiveSheet.ChartObjects("AppleChart")
    Set data = Range("B" & startRow & ":C" & lastRow)

    If Not applechart Is Nothing Then
        applechart.Activate
        ActiveChart.SetSourceData Source:=data
    Else
        ActiveSheet.Shapes.AddChart.Select
        ActiveSheet.ChartObjects(1).name = "AppleChart"
        ActiveChart.ChartType = xlLine
        ActiveChart.SetSourceData Source:=data
    End If
End Sub 
```

**编辑：如何在 Excel 中设置**

1.  在 Excel 中按`ALT`+ `F11`。这将打开 VBA 编辑器
2.  在左侧项目窗口中单击保存数据的工作表，例如 Sheet1
3.  在左侧下拉列表中选择`Worksheet`
4.  在右侧下拉列表中选择`SelectionChange`
5.  剪切并粘贴代码

注意 - 我假设您的数据从 A 列开始。如果不是，您需要自己修改代码中的列引用

# xcode - 发现 Xcode 4.5.2 错误但 Build 标记为 Succeeded

> ID：13954229
> 
> 赞同：29
> 
> 时间：2012-12-19T14:13:58.903
> 
> 标签：xcode, build, compiler-errors

这个问题与这个问题非常相似：[Xcode 4 Preview 4 显示“Build Succeeded”但有错误](https://stackoverflow.com/questions/4360558/xcode-4-preview-4-displays-build-succeeded-but-with-errors)

链接上提出的不同解决方案不起作用。我尝试使用产品清理，删除派生数据，重新启动 XCode 和 Mac，但问题仍然出现。

似乎所有错误都链接到项目的预编译头文件：虽然 PCH 工作正常并且本身没有错误，但报告的错误看起来像是找不到此特定文件的 pch。有时，在构建过程中，错误会随机出现和消失。有人对此有想法吗？

![在此处输入图像描述](../Images/710049be52df4b1fec9d061d64646672.png)

该错误仅出现在编辑器中打开的文件中。如果我在 xcode 中关闭文件但保持项目打开，则根本不会报告任何错误。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-05-03T16:22:14.927

清洁、关闭、重新启动 - 没有一个对我有用。

对有问题的 pch 文件进行简单的触摸/编辑即可解决该问题。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-01-08T21:02:31.513

您是否尝试过清理构建文件夹？

在 XCode 中，打开 Product 菜单，然后按住选项。Clean 应更改为 Clean Build Folder。

编辑：

您也可以按`⌘</kbd> + `⌥</kbd> + `⇧</kbd> + `K````

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-21T04:30:50.433

我遇到了同样的问题，两种清洁方式都没有帮助。我还尝试删除构建文件夹，重新启动 xcode 等，对我来说，最终解决问题的是删除错误引用的文件并重新添加它们。

此外，我事后调查了错误，问题似乎是 XCode 的“显示实时问题”功能。（这可以在首选项中取消选中，这也解决了这个问题，但作为一个解决方案并不令人满意，因为我已经成长为享受 xcode 的实时代码感。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-20T04:41:37.920

清理产品文件夹并重新启动对我没有帮助。我在删除 DerivedData 文件夹后开始看到这个。我能够通过以下方式“修复”：

1.  干净的构建。
2.  档案
3.  建造

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-21T13:49:05.113

我不确定向 pch 添加定义是否会如您所想。尝试创建一个常量标头并在那里添加您的定义。然后你可以在你的 pch 文件中包含 import 语句，它应该可以这样工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-18T11:15:11.690

```
Go to xcode install folder like below. 
```

/用户/vinod/库/开发人员/Xcode

步骤 1 退出 xcode

Step-2 删除 DerivedData 文件夹

第 3 步现在打开项目并清理它，所有问题都已解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-22T21:00:30.623

添加我的两分钱：我的解决方案是稍微更改 pch 文件中的导入顺序。

也许这与简单地编辑文件有关，但我试图“触摸”它并进行编辑，而唯一能解决问题的“事情”是将一些导入移到其他导入之前。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-02T06:58:54.690

1.  删除派生数据
2.  清洁项目
3.  退出 Xcode 并重新打开它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-16T08:00:56.143

从 .pch 文件中删除最后一个#import，构建应用程序然后将其放回并再次构建它对我来说是诀窍。

如果您仍然看到错误，那么您可以对最后两个导入、最后三个导入等重复此步骤。

# maven - Maven 程序集插件：包含来自模块的配置文件

> ID：13954231
> 
> 赞同：1
> 
> 时间：2012-12-19T14:14:06.400
> 
> 标签：maven, maven-3, maven-assembly-plugin

这是我的项目结构：

```
myapp-parent
  moduleMain
      src/main/java   ---> main class (it loads a spring context)
      src/main/config ---> main config files
  module1
      src/main/java   ---> specific code of the module
      src/main/config ---> specific config files of the module 
```

我正在使用程序集和 appassembler maven 插件进行分发。这是程序集描述符：

```
<assembly>
<id>archive</id>
<formats>
    <format>zip</format>
    <format>tar.gz</format>
</formats>

    <fileSets>
   <fileSet>
        <directory>${project.build.directory}/generated-resources/appassembler/jsw/myProject/bin</directory>
        <outputDirectory>bin</outputDirectory>
        <includes>
            <include>**</include>
        </includes>
        <useDefaultExcludes>true</useDefaultExcludes>
        <fileMode>0755</fileMode>
        <directoryMode>0755</directoryMode>
    </fileSet>

    <fileSet>
        <directory>src/main/config</directory>
        <outputDirectory>conf</outputDirectory>
    </fileSet>

    <fileSet>
        <directory>${project.build.directory}/generated-resources/appassembler/jsw/myProject/conf</directory>
        <outputDirectory>conf</outputDirectory>
    </fileSet>

    <fileSet>
        <directory>${project.build.directory}/generated-resources/appassembler/jsw/myProject/lib</directory>
        <outputDirectory>lib</outputDirectory>
    </fileSet>
 </fileSets> 
</assembly> 
```

因此，我得到了一个包含配置文件夹（'conf'）的分发包。**问题是该目录中的配置文件来自 mainModule，我想从 module1 获取配置文件也将位于同一位置。**

```
myProject.tar.gz
    bin
    lib
    logs
    conf --> Here we have config files from modeuleMain & module1 
```

任何的想法？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:07:46.940

您可能需要检查`<moduleSet/>`程序集描述符中的配置，尤其是`<sources/>`小节：[ModuleSet Source-Inclusion Example](http://maven.apache.org/plugins/maven-assembly-plugin/examples/multimodule/module-source-inclusion-simple.html "ModuleSet 源包含示例")。

**注意：**这只会让您**自己**获得解决方案的一部分！问题是程序集插件的 moduleSets 函数最初设计用于仅对当前项目的子模块（创建程序集的模块）进行操作。为了解决这个问题，我们在程序集插件的 2.2 版中或附近引入了一个新配置，称为**`<useAllReactorProjects/>`**. 将此标志设置为`true`，使当前构建中的所有模块都可用于程序集。

如果您在 moduleSet 中启用此功能，您应该能够包含来自 module1 的配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:02:08.757

您是否探索过组装插件的多模块支持？

[http://maven.apache.org/plugins/maven-assembly-plugin/examples/multimodule/index.html](http://maven.apache.org/plugins/maven-assembly-plugin/examples/multimodule/index.html)

# asp.net-mvc-3 - 在 MVC3 和 C# 中发送响应之前检测断开的连接

> ID：13954234
> 
> 赞同：1
> 
> 时间：2012-12-19T14:14:10.523
> 
> 标签：asp.net-mvc-3

我有一个 MVC3 应用程序，它处理传入的请求，更新数据库，并在需要时向请求者发送包含更多命令的响应。

MVC 应用程序在发送响应之前可以花费多长时间存在时间限制，因此应用程序执行以下操作：

1.  获取请求内容并将其存储在中间数据库中，以便稍后在单独的服务中进行处理。
2.  检查数据库中的传出响应对象（只是纯文本行），如果存在，则将它们添加到响应中并将它们标记为在数据库中发送。
3.  在正文中发送带有和传出响应对象的响应。

这一切都很好，除了对象被标记为已发送的事实，即使响应从未到达请求者，例如如果它在服务器处理期间断开连接。

那么，本质上，有没有什么方法可以让我在将更改提交到数据库并发回响应之前检查请求者的连接状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:18:55.973

你能做一些尝试和捕捉之类的事情吗？

```
try
{
   //Sends the response with and outgoing response objects in the body.
   //mark it as sent
}
catch
{
   //dont do anything as the "object" wont have been set a "sent" its gonna try the next time?
} 
```

您也可以在发送/标记为已发送之前检查连接状态

# c++ - 设置 SSL 连接并发送 GET 信息

> ID：13954236
> 
> 赞同：2
> 
> 时间：2012-12-19T14:14:18.670
> 
> 标签：c++, c, networking, ssl, get

如果这是正确的部分，则不是 100%，但我认为是这样，因为这是一个关于如何编程的问题。

在学习了计算机网络课程之后，我有了一些我想尝试的东西的想法。其中之一是自动登录到本地托管在我们的“路由器”上的网页。

所以该站点是本地的，比如说 192.168.150.1 - 单击“免费登录”链接会使用一个伪帐户登录您，我们将其称为 Alice（我们的 IP 地址为 192.168.150.74 .. 所以如果您点击您将发送 GET 请求的链接，例如：

```
192.168.0.1/login?dst=&username=T-Alice 
```

现在我用wireshark检查数据包流并且它被加密了——这是数据包流：

```
No.     Time        Source                Destination           Protocol Info
      1 0.000000    192.168.150.74        192.168.150.1         TCP      50704 > https [SYN] Seq=0 Win=14600 Len=0 MSS=1460 SACK_PERM=1 TSV=37133 TSER=0 WS=7
      2 0.001304    192.168.150.1         192.168.150.74        TCP      https > 50704 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460 SACK_PERM=1 TSV=17344316 TSER=37133 WS=1
      3 0.001372    192.168.150.74        192.168.150.1         TCP      50704 > https [ACK] Seq=1 Ack=1 Win=14720 Len=0 TSV=37133 TSER=17344316
      4 0.001969    192.168.150.74        192.168.150.1         TLSv1    Client Hello
      5 0.003568    192.168.150.1         192.168.150.74        TCP      https > 50704 [ACK] Seq=1 Ack=406 Win=6864 Len=0 TSV=17344316 TSER=37133
      6 0.010537    192.168.150.1         192.168.150.74        TLSv1    Server Hello, Certificate, Server Hello Done
      7 0.010587    192.168.150.74        192.168.150.1         TCP      50704 > https [ACK] Seq=406 Ack=1132 Win=16896 Len=0 TSV=37134 TSER=17344316
      8 0.013352    192.168.150.74        192.168.150.1         TLSv1    Client Key Exchange, Change Cipher Spec, Encrypted Handshake Message
      9 0.051304    192.168.150.1         192.168.150.74        TCP      https > 50704 [ACK] Seq=1132 Ack=732 Win=7936 Len=0 TSV=17344321 TSER=37134
     10 0.269299    192.168.150.1         192.168.150.74        TLSv1    Change Cipher Spec, Encrypted Handshake Message
     11 0.270405    192.168.150.74        192.168.150.1         TLSv1    Application Data
     12 0.271888    192.168.150.1         192.168.150.74        TCP      https > 50704 [ACK] Seq=1191 Ack=1377 Win=9226 Len=0 TSV=17344343 TSER=37160
     13 0.288841    192.168.150.1         192.168.150.74        TLSv1    Application Data, Application Data
     14 0.328065    192.168.150.74        192.168.150.1         TCP      50704 > https [ACK] Seq=1377 Ack=2625 Win=19840 Len=0 TSV=37166 TSER=17344344 
```

现在我想问（并做..）是：

是否可以制作一个程序（最好用 C 或 C++，但 lang 并不重要，除非其中一些有更好的库 ..）为我建立这个安全连接，所以我可以将该 GET 信息设置为路由器并登录？或者在代码中有更简单的方法来做到这一点？我可以让程序“访问”192.168.150.1 并将数据包创建和 SSL 留给内核吗？(--> 即使我认为 SSL 必须由应用程序本身处理..)

欢迎 Windows 和 unix 解决方案/指导。我想为两者做这个。

抱歉，如果这“令人困惑”，我试图尽可能清楚地提出问题：p - 所以我希望在将 GET 信息发送到路由器方面得到一些帮助，就好像我手动访问了该页面并单击了链接一样.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:27:53.233

如果您真的想自己处理 HTTP 编程（发送 GET 命令等），也许是出于学习目的，但有一些东西会为您处理 SSL/TLS，您可以使用类似于`stunnel`该服务器的东西，并使用您的自己的应用程序连接隧道的本地端。

通常，更好的选择是使用也支持 SSL/TLS 的 HTTP 库。Libcurl 就是一个很好的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:31:37.660

当然有可能，您只需要实现以下序列：

1.  创建到 HTTPS 服务器的 SSL 连接
2.  发送 HTTP GET 请求
3.  读取服务器的响应
4.  解析 HTTP 响应中的 HTML 内容

有很多使用 openssl 从服务器请求 HTTP 页面的示例，我通过在 Google 上搜索“openssl https 示例”找到了[这个](http://www.chesterproductions.net.nz/blogs/it/c/an-ssl-client-using-openssl/245/)。在我看来，真正的挑战是解析已经在[stackoverflow](https://stackoverflow.com/questions/489522/library-recommendation-c-html-parser)上讨论过的 HTML 内容。

我建议你在用 C++ 实现它之前使用 Python 尝试这个，祝你好运！

# http - 自定义登录页面的正确 http 状态代码是什么？

> ID：13954237
> 
> 赞同：2
> 
> 时间：2012-12-19T14:14:22.850
> 
> 标签：http, login, http-status-codes

我的网站上有限制页面，例如 URL [http://example.com/some-private-article.html](http://example.com/some-private-article.html)，它显示了一个登录页面，您必须在其中输入您的凭据才能查看该页面。

信息并没有消失，它在那里，但访问它被拒绝。

我会给出一个 401 响应，但是没有 http auth / digest 而规范说它是必需的，登录过程是用 php 在服务器端处理的。

这种页面的正确 HTTP 状态代码是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:33:49.007

我会这样做：

1.  将未经授权的用户重定向到登录页面（具有**不同的**url）。
2.  在您的私人文章 url 上 200 OK 对于有权访问的授权用户。
3.  对于无权访问的授权用户，则为 403。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-07T18:51:33.257

根据[HTTP 状态代码规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，如果用户还没有访问权限（未登录或没有所需的权限）并且必须通过表单登录到网页，我应该使用 403 或 404 作为自定义登录页面，外部客户端必须通过发送带有凭据的 POST 请求（通过 HTTPS 连接）登录，然后使用会话密钥存储 cookie，这将允许他们在重新加载页面后查看受限内容。

另一方面，如果我想通过 GET 类型请求使登录页面对脚本可用，或者对不一定有 cookie 的客户端可用，或者可以通过[https://username 之类的 URL 登录： password@example.com/some-private-article.html](https://username:password@example.com/some-private-article.html)然后我必须使用 HTTP 身份验证并且无法选择登录弹出窗口在浏览器中的外观，在这种情况下使用 401 HTTP 是合适的状态码。

我希望我做对了，如果没有，请纠正我。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T14:17:39.953

您绝对应该查看此[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，它定义了每个响应代码及其含义。

出于您的目的，尽管我可能会建议使用 401 - Unauthorized。

* * *

编辑：重新考虑，如果您正在执行表单样式身份验证，那么当您自己进行身份验证时，302 - Found 或 307 - 临时重定向到登录页面可能是一个明智的响应。

# php - 如何在新窗口弹出窗口中打开 php 插件内的此链接

> ID：13954241
> 
> 赞同：-3
> 
> 时间：2012-12-19T14:14:40.117
> 
> 标签：php, wordpress, plugins, popup, window

我有这个 pinterest 代码，我想在弹出窗口中打开它：

```
<a target="_blank" href="http://pinterest.com/pin/create/button/?url='.get_permalink().'&media='.wp_get_attachment_url( get_post_thumbnail_id() ).'&description='.get_the_title(  $post->ID ).'" class="sharebtn_pinterest" count-layout="horizontal"></a>'; 
```

这是我正在编辑的 WordPress 插件。

**编辑：**这是我想要工作但没有弹出窗口的代码

```
 {
    echo '<div class="bla"> 
    <a onClick="MyWindow=window.open("http://pinterest.com/pin/create/button/?url='.get_permalink().'&media='.wp_get_attachment_url( get_post_thumbnail_id() ).'&description='.get_the_title(  $post->ID ).',"MyWindow","width=600,height=500") class="sharebtn_pinterest" "/></a></div>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:23:54.060

一些要添加的javascript：

```
<script language="javascript" type="text/javascript">
<!--
function popitup(url) {
    newwindow=window.open(url,'name','height=200,width=150');
    if (window.focus) {newwindow.focus()}
    return false;
}

// -->
</script> 
```

将您的链接编辑为：

```
<a onclick="return popitup("http://pinterest.com/pin/create/button/?url='.get_permalink().'&media='.wp_get_attachment_url( get_post_thumbnail_id() ).'&description='.get_the_title(  $post->ID ).'")"
    >Link to popup</a> 
```

[从这里](http://www.quirksmode.org/js/popup.html)复制。第一个结果。您是否先尝试在 Google 上搜索此内容？

# python - 将带有可选参数的选项添加到 mercurial 扩展中的命令

> ID：13954242
> 
> 赞同：1
> 
> 时间：2012-12-19T14:14:42.970
> 
> 标签：python, mercurial, mercurial-extension

我想为 mercurial 命令 hg incomming 和特定行为添加一个选项。这是我所做的：

```
entry = extensions.wrapcommand(commands.table, 'incoming', specific_behavior)
entry[1].append(('', 'newopt', '', _('NEW OPT HELP STRING'), _('OPTION_ARGUMENT'))) 
```

目前 OPTION_ARGUMENT 是必需的，但我希望它是可选的。任何的想法 ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:10:10.393

看起来唯一允许的默认值是`None`,`True`或`False`。因此，如果您设置默认值`''`，则必须传入一个值，该值将作为字符串传递给您的函数。

[http://hg.intevation.org/mercurial/crew/file/tip/mercurial/fancyopts.py#l85](http://hg.intevation.org/mercurial/crew/file/tip/mercurial/fancyopts.py#l85)

# java - ListFragment 的活动

> ID：13954243
> 
> 赞同：1
> 
> 时间：2012-12-19T14:14:48.650
> 
> 标签：java, android, android-activity, fragment

我们在 2.2 api 中开发了很多以前的应用程序，其中我们创建了很多活动并将 TabActivity 用于选项卡。

现在，当我们在 JellyBean 版本中运行当前应用程序时，应用程序运行时选项卡没有显示，这表明 Tabactivity 在我们的源代码中已弃用。

我还阅读了向后兼容性 v4 并遵循示例 [http://wptrafficanalyzer.in/blog/creating-navigation-tabs-using-tabhost-and-fragments-in-android/](http://wptrafficanalyzer.in/blog/creating-navigation-tabs-using-tabhost-and-fragments-in-android/)

结论：对于 Tabs 定义 FragmentActity 需要 ListFragment，但在我们的例子中我们有 Activity，所以有什么解决方案我们不必更改我们的旧源只需尝试将 Activity 转换为 listfragment。

```
 tabHost = (TabHost) findViewById(android.R.id.tabhost);
    tabHost.setup();

    tabIntent = new Intent(this, CatalogNavigationActivity.class);
    productsTextView = new TextView(this);
    productsTextView.setGravity(Gravity.CENTER);
    productsTextView.setText(R.string.products);
    productsTextView.setSingleLine(true);
    productsTextView.setTextAppearance(this,R.style.TabText);
    tabSpec = tabHost.newTabSpec("products").setIndicator(productsTextView).setContent(tabIntent);
    tabHost.addTab(tabSpec); 
```

提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:14:52.810

您不需要 ListFragment，您可以使用 Fragment。看看[这个来自谷歌的例子](http://developer.android.com/training/implementing-navigation/index.html)，它会对你有所帮助。

# java - 如何在java中运行JavaScript方法？（我需要创建程序来下载大约10k首曲目）

> ID：13954250
> 
> 赞同：5
> 
> 时间：2012-12-19T14:15:18.160
> 
> 标签：java, javascript, download

几天后“Wirtualna Polska SA”关闭了“mp3.wp.pl”服务，所以我决定从那里下载一些音乐并保存在我的硬盘上。它大约有 150k（我不需要所有 btw.）文件，所以我自己这样做会浪费时间。我创建了一个程序，它可以下载特定类型的所有 id 并将其保存到 *.txt 文件夹中。要从网站下载音乐，我需要使用他们网站 download_utId('id') 中的 javascript 方法，其中 id 是 *.txt 文件中的一个整数

1.  我可以在java中运行这个方法（download_utId）吗？
2.  您将如何优化我的代码？
3.  还有其他建议吗？

4.（编辑。）如何用自己的名字保存文件？当您要下载“http://mp3.wp.pl/i/sciagnij?id=666&jakosc=hifi&streaming=0”时，该文件的默认名称为“Dub_Brother-Dance_Mission”

```

`import java.io.*;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;

public class Test {

    public static int numberOfPages = 1;

    public ArrayList<String> downloadPage(String page, String findAString, String endString){
        ArrayList<String> listOfIDs = new ArrayList<String>();
        URL url;
        InputStream is = null;
        DataInputStream dis;
        String line;

        try {
            url = new URL(page);
            is = url.openStream();  // throws an IOException
            dis = new DataInputStream(new BufferedInputStream(is));

            while ((line = dis.readLine()) != null) {
                if(line.contains("Liczba znalezionych utworów:")){
                    numberOfPages = numberOfPages(new Integer(line.substring(line.indexOf("<b>") + 3, line.lastIndexOf("</b>. Po"))));
                }
                if(line.contains(findAString)){
                    listOfIDs.add((line.substring(line.indexOf(findAString)+15, line.lastIndexOf(endString))));
                }
            }
        } catch (MalformedURLException mue) {
            mue.printStackTrace();
        } catch (IOException ioe) {
            ioe.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException ioe) {
                // nothing to see here
            }
        }
        return listOfIDs;
    }

    public int numberOfPages(int numberOfSongs){
        return numberOfSongs - numberOfSongs/10*10 >= 5 ? numberOfSongs/10+1 : numberOfSongs/10;
    }

    public void addToFile(){
        ArrayList<String> hehe = new ArrayList<String>();
        for(int i = 0; i < numberOfPages; i++){
            String link = "http://mp3.wp.pl/p/strefa/utwory/E9,nazwa," + i + "0,+0,+0,+0.html";
            hehe.addAll(downloadPage(link, "download_utId('", "'"));
            System.out.print(link);
        }
        FileWriter writer = null;
        try {
            writer = new FileWriter("c:/output.txt");
            for(String str: hehe) {
                writer.write(str + " ");
            }
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args){
        Test t = new Test();
        t.addToFile();
    }
}` 

            回答 #1

赞同：1

时间：2012-12-19T14:42:44.183

有一个很好的工具[Rhino Utilities](http://en.wikipedia.org/wiki/Rhino_%28JavaScript_engine%29)不确定它是否可以安装，但它很容易使用。

```

# php - 将代码（PHP/HTML/SQL）放入数据库的利弊？

> ID：13954255
> 
> 赞同：2
> 
> 时间：2012-12-19T14:15:32.157
> 
> 标签：php, database-design, maintenance

我想把它做成wiki，但我太陌生了。好吧，这是场景：

我的公司有一个“框架”，允许使用它来相当快地建立一个站点。“框架”在很大程度上依赖于数据库，它将在数据库中检索各种 HTML、PHP、Javascript 并将其输出。例如：

```
/**
 *  create_product.php
 *
 */
$page_id = 104;
include(output.php);

/**
 *  output.php
 *
 */
SELECT output FROM table_with_outputs where id = $page_id; 
```

实际情况要复杂一些，但想法就在那里。我发现很难维护这样的代码，因为几乎所有内容都存储在数据库中。我不能简单地找到一个 .php 页面来调试它。当我们说它很难维护时，我的上级认为它很灵活，可以更轻松地添加/编辑 UI 元素。除了难以维持之外，还有什么相反的论点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:28:01.680

一方面，这不是更灵活，因为 HTML/PHP/JavaScript 文件可以更容易地添加到文件系统而不是数据库。使用文件系统是

*   更安全
*   快点
*   更轻松
*   需要更少的工具（根本不需要工具）
*   更容易备份和恢复

为此使用数据库很糟糕，因为（我猜与之前的列表相反）：

*   它使调试变得更加困难
*   显着降低数据库的性能
*   违反关注点分离原则
*   使部署变得更加困难
*   需要额外的部署工具和该工具的维护

它增加了总拥有成本。

# architecture - 处理完所有数据后触发作业

> ID：13954256
> 
> 赞同：1
> 
> 时间：2012-12-19T14:15:35.873
> 
> 标签：architecture

所以我们有一些系统（大约 6 个）将信息作为文件输出到我们的 FTP，一旦收到文件，它就会立即处理，输出存储在数据库中，源文件被删除。另一个应用程序需要每晚运行一个特定的作业，但是，只有在源系统中的所有文件都已处理后，它才应该启动该作业。所以解决这个问题的方法是轮询数据库以查看文件是否已被处理，一旦我们知道一切都完成了，我们就会触发工作。

我的问题是，有没有更好的方法来做到这一点？也许是基于消息的方法？我正在寻找的方法不仅适用于这个系统，一旦来自源系统的数据到达，更多的系统还需要触发作业，所以我正在寻找一个可扩展的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T10:20:32.657

一个可能的解决方案是将 jour nightly 作业的触发器放入每个数据库导入/文件处理的数据库导入逻辑中。

您的夜间工作需要检查导入的完整性，即所有文件都正确导入。

有了这个，您将不再需要轮询，而是为每个导入的文件调用完整性检查。

注意竞态条件，确保两个并行完成的导入不会同时触发夜间作业。

# html - CSS 宽度限制

> ID：13954265
> 
> 赞同：1
> 
> 时间：2012-12-19T14:15:56.910
> 
> 标签：html, css

我怎样才能让 h3 标签看起来像这样？

![在此处输入图像描述](../Images/2dd5c8a8821140e604fa6503bb3f53da.png)

我尝试应用宽度和最大宽度 css 规则（例如宽度：120 像素；或 150 像素），但单词彼此相邻。

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:21:52.803

做到这一点的方法之一：

```
h3{
 text-transform:uppercase;
 background:green;
 color:white;   
 float:left;
 text-align:center;
 width:100px;
}​ 
```

[http://jsfiddle.net/fgu6W/](http://jsfiddle.net/fgu6W/)

估计不止几个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:17:42.403

```
<h3> SELL <br> ANYWHERE </h3> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:17:47.203

您需要提供更多 HTML/CSS 代码以获得更好的答案，但根据提供的信息，我认为您可能需要将`h3`标签设置为`display: block`

在此示例中，我不需要将 display 设置为`block`，它可以正常工作：http: [//jsfiddle.net/vwwZs/](http://jsfiddle.net/vwwZs/)

因此，也许您应用了其他一些冲突的 CSS。

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T14:18:27.640

```
<h3 style="text-align:center;">
SELL
<br>
ANYWHERE
</h3> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T14:20:04.070

`text-align:center`与固定宽度结合使用：http : [//jsfiddle.net/wQUyR/](http://jsfiddle.net/wQUyR/)

```
h3 {
    background:blue;
    display:block;
    width:70px;
    text-align:center;
}​ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-19T14:20:06.710

像这样：

```
<h3 style="width:120px;text-align:center;text-transform:uppercase;">Sell Anywhere</h3> 
```

没有内联样式：

```
<h3 class="sell-anywhere">Sell Anywhere</h3>

h3.sell-anywhere
{
   width: 120px;
   text-alignment:center;
   text-transform:uppercase;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-19T14:20:38.943

请参阅[jsfiddle](http://jsfiddle.net/P6f4Z/3/)，如果您提供代码，那就太好了。

```
<h3 style="width:100px;text-align:center;color:white;background:black"> SELL ANYWHERE </h3>​ 
```

# html - HTML_purifier 从图像中剥离显示：没有 CSS，即使 CSS.AllowTricky 设置为 True？

> ID：13954267
> 
> 赞同：2
> 
> 时间：2012-12-19T14:16:06.917
> 
> 标签：html, css, htmlpurifier, stripping

这个标题可能有点混乱，所以让我详细说明。

我正在使用 HTML_purifier 来清理用户输入，尽管在这种情况下，唯一将使用它的用户将是我自己（它在受密码保护的文件夹中）。长话短说，我希望能够将图像标记代码添加到 Web 表单中，然后在它发送的页面上也使用代码来显示所述图像。

但是我需要在图像标签上添加 css 属性，其中之一是

```
display:block 
```

无论如何，默认情况下 HTML_purifier 会删除它，[这里](http://htmlpurifier.org/live/configdoc/plain.html#CSS.AllowTricky)详细说明是因为 CSS.allowTricky 选项。据我了解，如果您将 CSS.allowTricky 选项设置为 True，那么它应该允许

```
display:block 
```

然而，在这样做之后它仍然删除它，只是想知道是否有人这样做过，因为我在网上找不到太多关于它的文档？它不会在系统日志中产生任何错误，所以我假设它是正确的实现，但没有按预期工作。

我现在的代码。

```
include('HTMLPurifier.standalone.php');
$config = HTMLPurifier_Config::createDefault();
$config->set('CSS.AllowTricky', true); 
```

***** 更新*** *****

 **代码应该将配置对象（代码已经设置）传递给 html 净化器对象。放在一起它应该看起来像这样。

```
include('HTMLPurifier.standalone.php');
$config = HTMLPurifier_Config::createDefault();
$config->set('CSS.AllowTricky', true);
$purifier = new HTMLPurifier($config); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T04:26:15.707

[http://htmlpurifier.org/phorum/read.php?3,6724](http://htmlpurifier.org/phorum/read.php?3,6724)的副本（解决方案是将配置对象传递给 HTML Purifier 对象，以便实际应用配置。）**

# objective-c - “applicationDidBecomeActive”时帧发生变化

> ID：13954269
> 
> 赞同：3
> 
> 时间：2012-12-19T14:16:13.180
> 
> 标签：objective-c

当应用程序连接到服务器时，我会出现一条小消息。它在应用程序启动时运行良好，以及应用程序需要显示此消息的其余时间，但如果我让应用程序休眠，我将其置于后台，然后将其唤醒，消息再次出现，但整个框架向上移动，请参见屏幕截图。第一个是在启动后，底部的消息出现并且正确地消失，并且视图恢复到过去的样子，完美。

![在此处输入图像描述](../Images/b255150632636b9f1714f6978bada07c.png)

但是第二个屏幕截图是让应用程序进入后台，然后在“”上唤醒它的结果，`applicationDidBecomeActive`我有一个方法需要连接到服务器，因此必须出现小视图。问题是窗口或`navigation controller`状态栏后面向上移动。并留下那个空白

![应用程序从启动](../Images/4a038c67413badb119d08dfabe147141.png)

这是我用来缩短导航视图并添加该消息视图并使其再次变长的代码。

```
- (void)addMessageView:(NSString *)message{
UIWindow *window = [UIApplication sharedApplication].keyWindow;
if(![window viewWithTag:3]){//Si no hay un messageView no lo meto.
    [window addSubview:messageView];
    CGRect frameWindow = window.frame;
    int heightMessage = 50;
    messageView.frame = CGRectMake(0, frameWindow.size.height, 320, heightMessage);

    UINavigationController *nav = window.rootViewController;

    //Pillo el UILabel y lo seteo
    UILabel *label = (UILabel *)[messageView viewWithTag:1];
    label.text = message;
    CGSize maximumLabelSize = CGSizeMake(296,9999);
    CGSize sizeMsg = [label.text sizeWithFont:label.font constrainedToSize:maximumLabelSize lineBreakMode:label.lineBreakMode];
    UIActivityIndicatorView *activity = (UIActivityIndicatorView *)[messageView viewWithTag:2];
    int xLabel = (320 - (sizeMsg.width + activity.frame.size.width + 5))/2;

    CGRect frameActivity = activity.frame;
    activity.frame = CGRectMake(xLabel, 13, frameActivity.size.width, frameActivity.size.height);
    label.frame = CGRectMake(xLabel + activity.frame.size.width + 5, 15, sizeMsg.width, sizeMsg.height);

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    nav.view.frame = CGRectMake(frameWindow.origin.x, frameWindow.origin.y, frameWindow.size.width, frameWindow.size.height - heightMessage);
    messageView.frame = CGRectMake(0, frameWindow.size.height - heightMessage, 320, heightMessage);

    [UIView commitAnimations];

}
} 
```

并且还把它放回以前的位置： - (void)hideMessageView{

```
UIWindow *window = [UIApplication sharedApplication].keyWindow;
UINavigationController *nav = window.rootViewController;
CGRect frameWindow = window.frame;
if([window viewWithTag:3]){//Si no hay un messageView no lo meto.
    [UIView animateWithDuration:0.3
                     animations:^{
                         nav.view.frame = CGRectMake(frameWindow.origin.x, frameWindow.origin.y, frameWindow.size.width, frameWindow.size.height);
                         messageView.frame = CGRectMake(0, frameWindow.size.height +5 , 320, 0);
                     }
                     completion:^(BOOL finished){
                         [messageView removeFromSuperview];

                     }];
}
NSLog(@"Tam Window: %@ y nav %@", frameWindow, nav.view.frame);
} 
```

让我知道你的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T15:36:27.173

尝试禁用***Autolayout***，我的 UI 也有同样的问题。

# web-services - 使用 URI 存储与远程对象的关联

> ID：13954270
> 
> 赞同：1
> 
> 时间：2012-12-19T14:16:14.823
> 
> 标签：web-services, rest, distributed-computing, distributed-system

在开发新应用程序时，我遇到了一个对我来说新的场景。我们的身份系统是一个独立的应用程序，它自己的数据存储只能通过 REST API 访问。这是我们正在推进的主题，独立的应用程序通过 API 相互通信。

我的新应用程序中的某些实体与 IDM 应用程序上的身份实体具有自然关联。我可以存储对该实体 ID 的引用，该引用通过其 API 报告给我的应用程序。我认为将完整的 URL 存储在我可以获取实体的位置会更好。

有人对走哪条路有建议吗？

MyEntity - 用户：IDM 颁发的 ID

或者

MyEntity - 用户：[https](https://idm-server.com/users/) ://idm-server.com/users/ {id}

提前致谢

# notepad++ - 将单行复制到多行

> ID：13954271
> 
> 赞同：2
> 
> 时间：2012-12-19T14:16:18.570
> 
> 标签：notepad++, string-matching

**文本文件具有以下内容：**

```
copy bundles\track_australia\part_054\snds.bundle
 bundles\track_italy\part_052\snds.bundle
 bundles\track_singapore\part_052\snds.bundle
copy bundles\track_abudhabi\part_054\snds.bundles.bundle
 bundles\track_belgium\part_025\snds.bundle
 bundles\track_britain\part_057\snds.bundle
 bundles\track_japan\part_053\snds.bundle
 bundles\track_usa\part_053\snds.bundle 
```

**我需要将第一行（以“copy”开头的行）与其余行合并。生成的结果应如下所示：**

```
copy bundles\track_abudhabi\part_054\snds.bundle
copy bundles\track_abudhabi\part_054\snds.bundle bundles\track_belgium\part_025\snds.bundle
copy bundles\track_abudhabi\part_054\snds.bundle bundles\track_britain\part_057\snds.bundle
copy bundles\track_abudhabi\part_054\snds.bundle bundles\track_japan\part_053\snds.bundle
copy bundles\track_abudhabi\part_054\snds.bundle bundles\track_usa\part_053\snds.bundle
copy bundles\track_abudhabi\part_055\snds.bundle
copy bundles\track_abudhabi\part_055\snds.bundle bundles\track_belgium\part_026\snds.bundle
copy bundles\track_abudhabi\part_055\snds.bundle bundles\track_britain\part_058\snds.bundle
copy bundles\track_abudhabi\part_055\snds.bundle bundles\track_japan\part_054\snds.bundle
copy bundles\track_abudhabi\part_055\snds.bundle bundles\track_usa\part_054\snds.bundle 
```

***我有成千上万条这样的行。请帮我。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:23:57.350

基本上你想删除任何换行符，除非它后面跟着“复制”。

像这样的东西应该适用于您的搜索模式：

`\R(?!copy)`

（您需要在搜索和替换对话框中启用正则表达式和多行）。

`(?!...)`是一个负前瞻。这意味着“一个不跟随单词副本的换行符”。

然后只需用空格替换它（因为您希望在一行的最后一个单词和下一行的第一个单词之间有空格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:48:12.213

使用 notepad++ 宏如下：

1.  将光标设置在文件末尾
2.  从*Marco*菜单按*开始录制*
3.  打开搜索对话框并输入`"\r\ncopy "`（确保搜索模式为*Extended*且*Direction*为*Up*）并点击*Find Next*
4.  复制整行（可能使用*Home* --> *Shift + End*然后复制）
5.  打开替换对话框（*Ctrl + H*）并替换`"\r\n bundles"`为`"\r\n"`+ 复制的行 + `" bundles"`，取消选中*Wrap around*，将*Direction*设置为*Down*并点击*Replace All*
6.  点击*Home*开始排队
7.  *从*Marco*菜单*停止录制**
**   *根据需要从宏*菜单重新运行宏*

# java - 检票口：使用 setResponsePage 重定向到检票口页面

> ID：13954273
> 
> 赞同：3
> 
> 时间：2012-12-19T14:16:19.007
> 
> 标签：java, redirect, wicket

我有一个检票口页面，其中有一个链接**ADD PRODUCT**。单击链接后，将打开一个模式窗口，其中包含产品信息。

ProductAddPanel.java

```
public class ProductAddPanel extends Panel {

private InlineFrame uploadIFrame = null;
private ModalWindow window;
private Merchant merchant;
private Page redirectPage;
private List<Component> refreshables;

public ProductAddPanel(String id,final Merchant mct,ModalWindow window,List<Component> refreshables,Page p) {
    super(id);
    this.window = window;
    merchant = mct;
    redirectPage = p;
    this.refreshables = refreshables;
    setOutputMarkupId(true);
}

@Override
protected void onBeforeRender() {
    super.onBeforeRender();
    if (uploadIFrame == null) {
        // the iframe should be attached to a page to be able to get its pagemap,
        // that's why i'm adding it in onBeforRender
        addUploadIFrame();
    }
}

//    Create the iframe containing the upload widget
private void addUploadIFrame() {
    IPageLink iFrameLink = new IPageLink() {
        @Override
        public Page getPage() {
            return new UploadIFrame(window,merchant,redirectPage,refreshables) {
                @Override
                protected String getOnUploadedCallback() {
                    return "onUpload_" + ProductAddPanel.this.getMarkupId();
                }

            };
        }
        @Override
        public Class<UploadIFrame> getPageIdentity() {
            return UploadIFrame.class;
        }
    };
    uploadIFrame = new InlineFrame("upload", iFrameLink);
    add(uploadIFrame);
} 
```

}

ProductAddPanel.html

```
<wicket:panel>
<iframe wicket:id="upload" frameborder="0"style="height: 600px; width:    475px;overflow: hidden"></iframe>
</wicket:panel> 
```

我正在使用 iframe 上传图像。我在我的 ProductPanel.html 中添加了一个 iframe。因为无法使用 ajax submit 上传文件。

上传Iframe.java

```
protected void onSubmit(AjaxRequestTarget target, Form<?> form) {
                DynamicImage imageEntry = new DynamicImage();

                if(uploadField.getFileUpload() != null && uploadField.getFileUpload().getClientFileName() != null){
                    FileUpload upload = uploadField.getFileUpload();
                    String ct = upload.getContentType();

                    if (!imgctypes.containsKey(ct)) {
                        hasError = true;
                    }

                    if(upload.getSize() > maximagesize){
                        hasError = true;
                    }

                    if(hasError == false){
                        System.out.println("######################## Image can be uploaded ################");
                        imageEntry.setContentType(upload.getContentType());
                        imageEntry.setImageName(upload.getClientFileName());
                        imageEntry.setImageSize(upload.getSize());
                        if(imageEntry != null){
                            try {
                                save(imageEntry,upload.getInputStream());
                            } catch (IOException e) {
                                e.printStackTrace();
                            }
                        }
                    }else{
                        target.appendJavaScript("$().toastmessage('showNoticeToast','Please select a valid image!!')");
                        System.out.println("#################### Error in image uploading ###################");
                    }
                }else{
                    System.out.println("########################### Image not Selected #####################");
                }

                MerchantProduct mp =new MerchantProduct();
                Product p = new Product();
                Date d=new Date();
                try { 

                    p.setProductImage(imageEntry.getImageName());
                    mp.setProduct(p);

                    Ebean.save(mp);

                } catch (Exception e) {
                    e.printStackTrace();
                }

                for(Component r: refreshables){
                    target.add(r);
                }

                window.close(target);
                setResponsePage(MerchantProductPage.class);
            }

public void save(DynamicImage imageEntry, InputStream imageStream) throws IOException{
    //Read the image data
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    copy(imageStream,baos);
    baos.close();
    byte [] imageData = baos.toByteArray();
    baos = null;

    //Get the image suffix
    String suffix = null;
    if("image/gif".equalsIgnoreCase(imageEntry.getContentType())){
        suffix = ".gif";
    }else if ("image/jpeg".equalsIgnoreCase(imageEntry.getContentType())) {
        suffix = ".jpeg";
    } else if ("image/png".equalsIgnoreCase(imageEntry.getContentType())) {
        suffix = ".png";
    }

    // Create a unique name for the file in the image directory and
    // write the image data into it.
    File newFile = createImageFile(suffix);
    OutputStream outStream = new FileOutputStream(newFile);
    outStream.write(imageData);
    outStream.close();
    imageEntry.setImageName(newFile.getAbsolutePath());

    }

    //copy data from src to dst
    private void copy(InputStream source, OutputStream destination) throws IOException{
        try {
                // Transfer bytes from source to destination
                byte[] buf = new byte[1024];
                int len;
                while ((len = source.read(buf)) > 0) {
                    destination.write(buf, 0, len);
                }
                source.close();
                destination.close();
                if (logger.isDebugEnabled()) {
                    logger.debug("Copying image...");
                }
            } catch (IOException ioe) {
                logger.error(ioe);
                throw ioe;
            }
        }

    private File createImageFile(String suffix){
        UUID uuid = UUID.randomUUID();
        File file  = new File(imageDir,uuid.toString() + suffix);
        if(logger.isDebugEnabled()){
            logger.debug("File "+ file.getAbsolutePath() + "created.");
        }
        return file;
    }
} 
```

}

我正在使用 setResonsePage() 重定向到存在“添加产品”链接的初始页面。这样我就可以获得包含新产品信息的刷新页面。

我的问题是模式窗口没有在 window.close() 上关闭，并且在该窗口内我正在刷新页面。

我的要求是模态窗口应该关闭并刷新页面。我在 setResponsePage() 中传递 Parentpage.class。

任何帮助和建议表示赞赏！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T04:51:26.370

在打开模式窗口的 ParentPage.class 中，我调用了 setWindowClosedCallback() 方法，在该方法中我将 getPage() 添加到目标，以便在模式窗口关闭时页面将刷新。这是相同的代码

```
modalDialog.setWindowClosedCallback(new ModalWindow.WindowClosedCallback() 
   { 
           private static final long serialVersionUID = 1L; 

           @Override 
           public void onClose(AjaxRequestTarget target) 
           { 
               target.addComponent(getPage()); 
           } 
   }); 
```

# html - 文本的 HTML 和 css 位置无法更改

> ID：13954274
> 
> 赞同：2
> 
> 时间：2012-12-19T14:16:37.090
> 
> 标签：html, css, text

我是来自比利时的学生。我正在创建我的投资组合网站，但遇到了一个无法修复的错误。我的老师建议我在这里发布一个问题寻求帮助。

正如您在屏幕截图中看到的，粗体文本表现得很奇怪。它应该像下面的文本部分一样。有没有什么办法解决这一问题？

[http://imgur.com/aYiYu](http://imgur.com/aYiYu)

**HTML**

```
<div id="content">
<div class = "intro" id="introtext">
<h2 id="h2intro">My name is not Joren and I am a <span class="cyan">designer</span>      from Belgium. </h2>
<h3 class="h3intro">I am passionate about making very <span class="cyan">simple and clean</span> designs that are easy on the eye and very simple to use.</h3>
</div><!--end intro--> 
```

**CSS**

```
.cyan
{
    color:#00d1e0;
}

#h2intro
{
    font-weight: bold;

}

.h3intro
{
    color: #463E3F;
} 
```

提前致谢！

净连

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:23:39.423

我认为您需要将 h2 和 h3 的默认字体大小更改为相同的大小。尝试

```
 h2, h3 {
      font-size:14px; 
}

 #h2intro {
     font-weight: bold;

 }

 .h3intro {
     color: #463E3F; } 
```

我相信您已将默认样式设置为 H2 和 H3。这就是您看到填充和大小差异的原因。如果您不想影响其他 h2 和 h3 标签，您还可以在 #h2intro 和 .h3intro 中设置大小。

**在回复评论时，请在样式表底部使用以下样式。**

```
#introtext h2.h2intro  
{ 
    font-size: 14px; 
    font-weight: bold;
    margin: 0px;
    padding: 0px; 
 } 

#introtext h3.h3intro 
{  
   font-size: 14px; 
   margin: 0px;
   padding: 0px;
   color: #463E3F; 
} 
```

# java - java中的伪代码？

> ID：13954276
> 
> 赞同：0
> 
> 时间：2012-12-19T14:16:40.150
> 
> 标签：java, pseudocode

```
 String s = ""; 

    myf = new Finch();
    do
    {
        //Run the menu until quit or cancel is selected
        s = FinchMenu();
        //menu 1
        if (s.equals("Back and forward")) RunAccelerationTest(s);
    } 
```

你如何将这样的东西转换为伪代码？例如

```
String s = ""; 
```

它的伪代码会是这样的吗？

```
Set s to "" 
```

这对我来说似乎是错误的。

请问有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T14:26:01.520

我认为伪代码没有预定义的语法。只需遵循两条规则：

*   它应该是具有通用编程结构的简单英语。

*   它应该是通用的，而不是特定于任何语言。

以下应该适合：

```
Step 1: Initialize an empty string. (say str)

Step 2: Construct a new 'Finch' object.

Step 3: BEGIN LOOP

            Fetch 'FinchMenu' from 'Finch' object.

            assign 'FinchMenu' to 'str'

            IF 'FinchMenu' is "Back and forward"

                Call 'RunAccelerationTest' method with 'str' as argument.

            END IF

        END LOOP 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:20:26.070

伪代码只是一种非语言特定的人类可读的演练，无论您尝试做什么。

您可以编写`set s to ""`或什`make s an empty string`至或任何其他内容来描述此步骤正在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:26:30.890

一般来说（这完全是我使用伪代码的方式，而不是按照规则设置的任何东西）我使用伪代码来摆脱任何样板文件或语法正确。

例如，假设我有以下 Java 代码...

```
import java.io.*;
class FileRead 
{
 public static void main(String args[])
  {
  try{
  // Open the file that is the first 
  // command line parameter
  FileInputStream fstream = new FileInputStream("textfile.txt");
  // Get the object of DataInputStream
  DataInputStream in = new DataInputStream(fstream);
  BufferedReader br = new BufferedReader(new InputStreamReader(in));
  String strLine;
  //Read File Line By Line
  while ((strLine = br.readLine()) != null)   {
  // Print the content on the console
  System.out.println (strLine);
  }
  //Close the input stream
  in.close();
    }catch (Exception e){//Catch exception if any
  System.err.println("Error: " + e.getMessage());
  }
  }
} 
```

我对伪代码的解释类似于......

```
main() {
FileInputStream fstream = new FileInputStream(fileLocation);
BufferedReader br = BufferedReader(.....fstream);
String str;
while(br.readline!=empty, str=br.readline) {
  System.out(str);
}
} 
```

现在，除了我之外，这段代码可能对任何人都没有用——但我知道我可以快速查看它，看看它是什么，并在必要时编写它。在会议等中快速记笔记很有用，如果我想编写快速的伪代码，我不会考虑异常处理之类的事情。

# c# - 将 c# 代码评估为 aspx 文件中的字符串

> ID：13954277
> 
> 赞同：19
> 
> 时间：2012-12-19T14:16:40.920
> 
> 标签：c#, string

我有这个问题：从数据库中，保存了一个字符串，其中包含混合了 C# 代码的 HTML。我希望我可以在我的页面 .aspx 上正确运行这两个代码。

例如在我的 .aspx 中：

```
<div><%= Model.repo.getCode() %></div> 
```

getCode() 方法给了我这个：

```
<div id="secondDiv"><p><%= Model.Person.Name %></p></div> 
```

所以我希望最终的 html 文件看起来像：

```
<div><div id="secondDiv"><p>Jhon</p></div></div> 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:22:42.293

可能有直接的方法来绑定这样的值，但是如果你可以将*String.Formatable*存储到数据库中，那么绑定所需的数据就很容易了。

使用[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)你可以实现，

从 Model.repo.getCode() 返回的字符串（**见花括号**）

```
 "<div id="secondDiv"><p>{0}</p></div>"; 
```

在 ASP 代码中，

```
 <div><%= string.format(Model.repo.getCode(),Model.Person.Name) %></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:40:17.990

看看这个项目，因为它帮助我解决了类似的问题：[https](https://github.com/formosatek/dotliquid) ://github.com/formosatek/dotliquid基本上你可以将任何对象绑定到模板，并且该模板可以调用对象的属性，甚至使用条件逻辑和循环。

# junit - 我们是否应该定义我们的接口以使其更具可测试性？

> ID：13954282
> 
> 赞同：4
> 
> 时间：2012-12-19T14:17:03.327
> 
> 标签：junit, tdd

例如，片段 A

```
String readSource(String file); 
```

片段 B

```
String readSource(InputStream in); 
```

所以如果我们将接口定义为A，那么我们只能创建一个文件，只是为了测试。但是一段时间后管理测试文件会变得相当困难。所以使用B接口，会使测试更容易。我只需要创建一个假的`InputStream`，然后检查该方法是否返回我们想要的结果。但是我们必须`IOException`在每次调用这个方法之前处理好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:20:58.413

如果您遵循 TDD，那么我会说采用更可测试的方法，但这确实是个人喜好问题。快速思考……使用代码片段 B 时，代码是否易于使用/维护？如果是这样，那么就没有缺点，这绝对是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T14:42:36.650

如果`readSource()`做的不仅仅是返回文件的内容，我肯定会选择解决方案 B。

除了更好的可测试性之外，引入一个新的抽象概念`InputStream`（从它（单一责任原则）。

# jasper-reports - 如何在条形图上显示工具提示/值？

> ID：13954286
> 
> 赞同：2
> 
> 时间：2012-12-19T14:17:14.377
> 
> 标签：jasper-reports, ireport, bar-chart

我正在使用*iReport 4.7 Community Edition*来制作报告。我正在使用*Chrome*浏览器以 HTML 格式查看它。

我将 3D 条形图放在摘要带中，并希望在其尖端（即顶部）显示值。所以我通过以下方式：

1)`show Labels`在 `show Legends`3D 条形图属性中进行检查。

2）右键单击图表>图表详细信息>详细信息>类别详细信息>通过选择类别，修改>项目超链接>工具提示>工具提示表达式> `$F{dayname(ServiceDate)}.toString()`，`$F{dayname(ServiceDate)}`字段名称在哪里

即使，它没有显示任何东西。

社区版中没有这个设施吗？我应该为此嵌入任何其他*.jar*文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-30T05:49:51.890

创建jar文件添加这一行

**CategoryPlot categoryPlot = (CategoryPlot)jfreeChart.getPlot(); categoryPlot.getRenderer().setBasePositiveItemLabelPosition(new ItemLabelPosition(ItemLabelAnchor.OUTSIDE12, TextAnchor.BOTTOM_CENTER));**

在 ireport 中将此 jar 添加为自定义程序类

# java - 如何计算 JTree 中的节点数？

> ID：13954290
> 
> 赞同：2
> 
> 时间：2012-12-19T14:17:30.067
> 
> 标签：java, swing, tree, jtree

我正在使用[JIDE 的 CheckBoxTree](http://www.jidesoft.com/javadoc/com/jidesoft/swing/CheckBoxTree.html)来显示一个嵌套的复选框树，如下例所示：

![示例图像](../Images/138b5205123aa741219637fb9eb5ea2b.png)

我想知道树模型包含多少个节点。

如果我调用方法[tree.getModel().getChildCount(rootNode)](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/tree/TreeModel.html#getChildCount%28java.lang.Object%29)，我只会得到直接子代的数量（例如，在这种情况下为 12 个），而不是进一步嵌套的任何子代的数量（20+）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:21:35.957

递归：

```
public int getNumberOfNodes(TreeModel model)  
{  
    return getNumberOfNodes(model, model.getRoot());  
}  

private int getNumberOfNodes(TreeModel model, Object node)  
{  
    int count = 1;
    int nChildren = model.getChildcount(node);  
    for (int i = 0; i < nChildren; i++)  
    {  
        count += getNumberOfNodes(model, model.getChild(node, i));  
    }  
    return count;  
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:21:41.673

`getChild()`使用该方法自己遍历树。

[http://en.wikipedia.org/wiki/Tree_traversal](http://en.wikipedia.org/wiki/Tree_traversal)

# jquery - 如何从变量中获取滑块最小值、最大值。

> ID：13954296
> 
> 赞同：4
> 
> 时间：2012-12-19T14:17:38.607
> 
> 标签：jquery, variables, slider, minmax

如何从变量中获取最小、最大滑块值。

当我尝试滑动时，滑块设置为最大值并停止工作。

如果我在数字中输入最小值和最大值，它就可以正常工作。

这是一个显示问题的小提琴：

```
<INPUT TYPE="text" CLASS="slidervalue">
<DIV CLASS="slider"></DIV>

<INPUT CLASS="getmin" TYPE="text" VALUE="1">
<INPUT CLASS="getmax" TYPE="text" VALUE="10"> 

             var getmin = $('.getmin').val();
             var getmax = $('.getmax').val();

           $(".slider").slider({

                    range: "max",
                    min: getmin,
                    max: getmax,
                    value: 2,
                    slide: function( event, ui ) {
                        $( ".slidervalue" ).val( ui.value );
                    }       

            }); 
```

[http://jsfiddle.net/gk3dG/1/](http://jsfiddle.net/gk3dG/1/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:21:44.760

jQueryUI 滑块需要 int 值，而不是字符串值。 `val()`返回字符串。

如果你这样做，它可以解决你的问题......

```
var getmin = parseInt($('.getmin').val(), 10);
var getmax = parseInt($('.getmax').val(), 10); 
```

请参阅[更新的 js 小提琴...](http://jsfiddle.net/gk3dG/2/)

你还必须处理 NaN 值，所以你也可以这样做......

```
var getmin = parseInt($('.getmin').val(), 10);
var getmax = parseInt($('.getmax').val(), 10);

if (isNaN(getmin)) getmin = 1;
if (isNaN(getmax)) getmax = 10; 
```

（假设 1 和 10 是您的默认值）。

# c++ - 控制台关闭过程关闭

> ID：13954299
> 
> 赞同：3
> 
> 时间：2012-12-19T14:17:47.903
> 
> 标签：c++

我将一个DLL注入一个进程，在该进程的入口点我产生一个新线程并分配一个控制台，我将所有std重定向到控制台，当我关闭控制台窗口时，整个进程关闭，有没有办法这样它就不会关闭进程？这是我的代码：

入口点：

```
#pragma region EntryPoint
BOOL APIENTRY DllMain(HANDLE hModule, DWORD ul_reason_for_call, LPVOID lpReserved)
{
    switch (ul_reason_for_call)
    {
        case DLL_PROCESS_ATTACH:
            {
                DWORD threadId;
                hProcess = GetCurrentProcess();
                hThread = CreateThread( NULL, 0, Attach, 0, 0, &threadId);
            } break;
        case DLL_PROCESS_DETACH:
            CloseHandle(hThread);
        break;
    }
    return TRUE;
}
#pragma endregion EntryPoint 
```

附：

```
DWORD WINAPI Attach(LPVOID args)
{
    RedirectIOToConsole();
} 
```

这是控制台代码：

```
#include "hFatboy.h"

#ifndef _USE_OLD_IOSTREAMS
using namespace std;
#endif

static const WORD MAX_CONSOLE_LINES = 500;
extern HANDLE hProcess;

byte *readMemory(DWORD address, int length)
{
    byte *buffer = new byte[length];
    SIZE_T bytesRead;
    if (ReadProcessMemory(hProcess, (void *)address, buffer, length, &bytesRead))
        return buffer;

    return NULL;
}
void RedirectIOToConsole()
{
    int hConHandle;
    long lStdHandle;

    CONSOLE_SCREEN_BUFFER_INFO coninfo;
    FILE *fp;

    AllocConsole();
    GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &coninfo);
    coninfo.dwSize.Y = MAX_CONSOLE_LINES;
    SetConsoleScreenBufferSize(GetStdHandle(STD_OUTPUT_HANDLE), coninfo.dwSize);

    lStdHandle = (long)GetStdHandle(STD_OUTPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);

    fp = _fdopen( hConHandle, "w" );

    *stdout = *fp;

    setvbuf( stdout, NULL, _IONBF, 0 );

    lStdHandle = (long)GetStdHandle(STD_INPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);

    fp = _fdopen( hConHandle, "r" );

    *stdin = *fp;

    setvbuf( stdin, NULL, _IONBF, 0 );

    lStdHandle = (long)GetStdHandle(STD_ERROR_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);

    fp = _fdopen( hConHandle, "w" );

    *stderr = *fp;

    setvbuf( stderr, NULL, _IONBF, 0 );

    ios::sync_with_stdio();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:00:50.950

你可以尝试注册一个`HandlerRoutine`。[`SetConsoleCtrlHandler`](http://msdn.microsoft.com/fr-fr/library/windows/desktop/ms686016%28v=vs.85%29.aspx)然后，您将能够拦截关闭事件`CTRL_CLOSE_EVENT`并避免调用`ExitProcess`.

# lisp - 如何编写一个clisp可执行文件？

> ID：13954300
> 
> 赞同：3
> 
> 时间：2012-12-19T14:17:47.110
> 
> 标签：lisp, common-lisp, clisp

> **可能重复：**
> [Lisp 可执行文件](https://stackoverflow.com/questions/25046/lisp-executable)

刚开始使用 Clisp，我面临的最大问题是很少有教程可以解释如何编写 clisp 文件。大多数教程都是关于在命令行中使用它。

我没有使用 Emacs。我在 Ubuntu 上使用 Clisp + Sublime。因此，我应该怎么做才能编写一个 lisp 代码文件并执行它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:27:54.730

请参阅 CLISP 文档如何保存可执行文件：

[http://clisp.org/impnotes/image.html](http://clisp.org/impnotes/image.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:24:54.857

最常见的方法是使用 Slime 加载文件。我强烈建议您开始使用它。

如果您绝对不想这样做，您可以按照[Clisp 文档所述](http://www.gnu.org/software/clisp/impnotes/clisp.html#opt-exec-file)使用该`--lisp-file`选项。

# hibernate - Hibernate 异常：org.hibernate.hql.internal.ast.QuerySyntaxException，同时从表中检索记录

> ID：13954307
> 
> 赞同：5
> 
> 时间：2012-12-19T14:18:00.397
> 
> 标签：hibernate, hql

在 Hibernate 4.0 中，我想使用从表中检索记录，`session.createQuery("from dbemployee").list();` 但 Hibernate 显示异常：

> 休眠异常：org.hibernate.hql.internal.ast.QuerySyntaxException：dbemployee 未映射 [来自 dbemployee]**

我的 POJO 类是 Employee

```
public class Employee implements Serializable {

private static final long serialVersionUID = 1L;
private String empId;
private String empName;
private long empSalary;

public Employee() {
    super();
}

// getters and setters 
```

}

我`dbemployee`在 Oracle 11g 中的表是：

```
dbemployee:
EMPID varchar2(20)
EMPNAME varchar2(20)
EMPSALARY number(11); 
```

Employee.hbm.xml 是

```
<hibernate-mapping>
  <class name="beanclass.Employee" table="dbemployee">

  <id name="empId" type="java.lang.String" column="EMPID">
  <generator class="assigned"></generator>
   </id>
   <property name="empName"  column="EMPNAME"  type="java.lang.String"/>
   <property  name="empSalary" column="EMPSALARY" type="java.lang.Long" />
  </class>

  </hibernate-mapping> 
```

请帮助解决此异常。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:25:47.383

您的查询应该是：

```
 session.createQuery("from Employee").list(); 
```

您必须在查询中使用类名，而不是表名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:31:42.620

将您的查询设为

```
 session.createQuery("from Employee").list(); 
```

或者

```
session.createQuery("from beanclass.Employee").list(); 
```

在像 Hibernate 和 JPA 这样的 ORM 中，当不处理原生查询时，您应该在查询中使用对象/类名称。

# django - 自定义身份验证后端。姜戈

> ID：13954309
> 
> 赞同：15
> 
> 时间：2012-12-19T14:18:08.800
> 
> 标签：django

我想创建一个身份验证后端，允许用户仅使用他们的电子邮件（无用户名，无密码）登录。

这是我尝试过的。

后端.py：

```
from django.conf import settings
from django.contrib.auth.models import User

class EmailAuthBackend(object):    
    def authenticate(self, username=None, password=None):
        try:
            user = User.objects.get(email=username)
            if user:
                return user
        except User.DoesNotExist:
            return None 
```

设置.py：

```
 AUTHENTICATION_BACKENDS = (
       'path_to.backends.EmailAuthBackend',
       'django.contrib.auth.backends.ModelBackend',
      ) 
```

html:

```
 <form  method="post" action="{% url myproject.views.test %}">
    {% csrf_token %}

        <input type="text" name="email" value=""/>

    <button type="submit">Valider</button>

    </form> 
```

看法：

```
 def test(request):
    email = ''
    if 'email' in request.POST:
        email = request.POST.get('email')
        if not User.objects.filter(email=email):
            User.objects.create(email=email)
        user = authenticate(username=email)
        if user is not None:
            if user.is_active:
                auth_login(request, user)
    return HttpResponseRedirect(reverse('home')) 
```

它不起作用，用户未通过身份验证。当我转到 /admin 时，我也遇到了这个错误：

```
 AttributeError at /admin/logout/
    'EmailAuthBackend' object has no attribute 'get_user' 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-19T14:20:54.403

对于 Django 中的每个自定义后端，您需要指定`get_user`函数。请参阅[文档](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#writing-an-authentication-backend)。该`get_user`实现可以简单地使用现有的用户表，就像你一样：

```
def get_user(self, user_id):
   try:
      return User.objects.get(pk=user_id)
   except User.DoesNotExist:
      return None 
```

这是必需的原因是您需要通过其主键从不同来源获取用户的情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-11-10T20:32:59.057

虽然[Bartek](https://stackoverflow.com/users/95509/bartek)的[答案](https://stackoverflow.com/a/13954358/11573842)是正确的，但我将提供一个示例，说明通过继承`ModelBackend`.

```
from django.contrib.auth.backends import ModelBackend

class EmailAuthBackend(ModelBackend):
    def authenticate(self, username=None, password=None, **kwargs):
        try:
            user = User.objects.get(email=username)
            if user.check_password(password):
                return user
        except ObjectDoesNotExist:
            # Run the default password hasher once to reduce the timing
            # difference between an existing and a non-existing user (#20760).
            User().set_password(password) 
```

`get_user`已经由 实现，并且`ModelBackend`您将获得许可方法。

# css - SASS：phpsass为什么要去掉css属性-webkit-box？

> ID：13954315
> 
> 赞同：0
> 
> 时间：2012-12-19T14:18:45.163
> 
> 标签：css, sass

我在我的网络项目中使用 PHPSASS。运行整个过程后，我注意到它删除`display:-webkit-box`了我的 css 中的所有出现。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:35:30.510

问题不在于值（-webkit-box），而是因为它前面缺少空格！请参阅：[CSS 生成器 SASS 是否需要拒绝诸如 margin:10px 之类的行？（冒号后没有空格）](https://stackoverflow.com/questions/3040817/is-there-a-reason-why-sass-a-css-generator-needs-to-reject-lines-such-as-margi?rq=1)

# mysql - 将行值扩展到单个行

> ID：13954316
> 
> 赞同：5
> 
> 时间：2012-12-19T14:18:50.210
> 
> 标签：mysql, sql, join

我需要一些有关 SQL 查询的帮助。我知道这应该重新设计，但这是我在更大的系统上做的一个小修复:(。

系统有一个名为 sales 的表，其中包含已售出的零件。

```
id  | date   | idpart
1   |unixtime|   227
2   |unixtime|   256 
```

等等..

在包含订单内容的 Orderdetails 表中，零件按 id 列出，并带有客户订购的唯一零件的数量。

```
id |idpart | amount
1  | 255   | 4
2  | 265   | 2 
```

现在，我的问题是我必须运行一个查询来填充销售表，但是将 idpart 添加为新行，该部分与按顺序的数量值相同的次数。我需要的结果是：

```
id  | date   | idpart
1   |unixtime|   227
2   |unixtime|   256 

3   |unixtime|   255
4   |unixtime|   255
5   |unixtime|   255
6   |unixtime|   255
7   |unixtime|   265
8   |unixtime|   265 
```

有没有人可以在这个问题上给我一些帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:10:27.857

如果您有一个带有数字的表格，这很容易。你可以这样做：

```
select id, date, idpart
from sales
union all
select id, date, idpart
from orders o cross
     numbers n
     on n.number <= o.amount 
```

这是假设`date`来自订单表。

现在，您只需要生成数字表。这是 MySQL 的一个痛点。也许您有另一个可以使用的表，例如日历表。否则，您可以通过插入具有自动增量列的表来创建一个。

在其他数据库中，您可以使用该`row_number()`函数动态创建这样的表。但是 MySQL 不支持这个。

# php - 您可以操作存储在 aws S3 上的图像吗？

> ID：13954317
> 
> 赞同：0
> 
> 时间：2012-12-19T14:18:50.890
> 
> 标签：php, amazon-s3, imagemagick

我目前的流程：我有一个文件上传器，可以让用户上传图片。图片上传到我的服务器。然后我的服务器会创建 10 个缩略图。然后将这些图像发送到 S3。这显然不是最快的解决方案，这导致了我的问题：更好的解决方案是将文件直接上传到 S3（我知道这是可能的）......然后从那里创建缩略图......是否有可能在 S3 中存储的图像上创建缩略图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-04T08:17:43.160

2 年后.... Lambda 来了！

来自官方页面[Lambda](http://aws.amazon.com/es/lambda/)

> “您可以触发 AWS Lambda 函数以在将图像上传到 Amazon S3 时自动创建缩略图”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:22:12.080

最简洁的答案是不'。把 S3 看成是某个大冰箱：你当然可以在里面放一些食物，然后再把它拿走，但在那个冰箱里做饭会感觉有点奇怪。)

# javascript - 在表格内显示多对多关系的额外字段

> ID：13954318
> 
> 赞同：5
> 
> 时间：2012-12-19T14:18:51.810
> 
> 标签：javascript, jsp, datatable, many-to-many, jstl

我一直在寻找一段时间，但没有找到任何解决方案来执行以下操作。

我正在尝试显示一个包含比方说用户列表的表格。显示来自用户的字段并不是什么大问题，但关联字段更复杂。假设我有以下表格：User、Post 和 UserPosts，在 UserPosts 中我们有一个标志 main 来指示给定的帖子是否是用户的主要位置。

在我的数据表中，我必须显示用户的信息，这意味着用户表中的字段+他/她的主要帖子。

到目前为止，我有这样的事情：

```
<table> 
    <thead> 
    <tr> 
        <th>name</th> 
        <th>FrstName</th>
        <th>Age</th> 
        <th>Main position</th>
        <th>Action</th> 
    </tr> 
        <tbody> 
           <c:forEach items="${listUsers}" var="user" varStatus="status">
            <tr>
                <td><c:out value="${user.name}" /></td> 
                <td><c:out value="${user.firstName}" /></td>
                <td><c:out value="${user.age}" /></td> 
                <td><c:out value="Position here" /></td> 
                <td>
                Delete
                <a href="/myAppli/user/${user.idUser}">Update</a>
                </td> 
            </tr> 
            </c:forEach>
        </tbody> 
</thead> 
```

我认为对于位置，我将不得不从给定列中给定用户的数据库主要位置检索，但是如何设置这个值（javascript，ajax？）

我是不是想错了，我应该改用关联类吗？我的意思是，检索 main field = true 的所有 UserPosts？然后迭代 userPosts 而不是用户，在这种情况下，我将有这样的事情：

```
<c:forEach items="${listUserPosts}" var="userPost" varStatus="status">
        <tr>
            <td><c:out value="${userPost.user.name}" /></td> 
            <td><c:out value="${userPost.user.firstName}" /></td>
            <td><c:out value="${userPost.user.age}" /></td> 
            <td><c:out value="${userPost.post.postName}" /></td> 
            <td>
            Delete
            <a href="/myAppli/user/${userPost.user.idUser}">Update</a>
            </td> 
        </tr> 
</c:forEach> 
```

我觉得很奇怪，也许我错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T00:19:57.960

如果我正确理解了您的数据布局，您将得到如下信息：

[![数据结构](../Images/88a44183bda7929ff1b4dc7e7c0bf110.png)](https://i.stack.imgur.com/0Lz1z.png)

如果是这种情况，您可以像这样构造您的 User 对象：

```
public class User {
  private int id;
  private String name;
  private String firstName;
  private int age;
  private Position mainPosition;
} 
```

并且您的查询只需要对标记为“main”的 UserPosition 进行左连接。然后，该 UserPosition 将加入正确的位置。然后您的 JSP 只需要检查您的 Position 对象是否为空。

```
<c:forEach items="${listUsers}" var="user" varStatus="status">
  <tr>
    <td><c:out value="${user.name}" /></td> 
    <td><c:out value="${user.firstName}" /></td>
    <td><c:out value="${user.age}" /></td> 
    <td>
      <c:if test="empty ${user.position}">
        No main position
      </c:if>
      <c:if test="not empty ${user.position}">
        <c:out value="${user.position.title}" />
      </c:if>
    </td> 
    <td>
      Delete
      <a href="/myAppli/user/${user.idUser}">Update</a>
    </td> 
  </tr> 
</c:forEach> 
```

# java - 向上转换为对象的 ArrayList，然后向下转换为自定义 ArrayList 的成本

> ID：13954325
> 
> 赞同：7
> 
> 时间：2012-12-19T14:19:23.993
> 
> 标签：java, object, arraylist, downcast, upcasting

我有一种情况，我从数据库中获取数据，我想将它向上转换到`ArrayList of objects`然后向下转换到不同的自定义 ArrayList ie`List<User>`等`List<Groups>`。

我的问题是向上转换为对象，然后向下转换为 ArrayList，成本是多少，它是有效的还是好的做法。

**已编辑**

我不想像等那样获取数据，`List<User>, List<Groups>`我想`ArrayList<objetcs>`一次获取数据，然后根据我的需要，我将向下转换数据到`ArrayList<User>,` `ArrayList<Groups>`稍后。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:22:46.877

“向下转换”不是一个好主意，因为您不需要使用任何 ArrayList 特定方法。你应该能够使用`List`每一件事。ArrayList 提供的唯一不在 List 中的公共方法是`ensureCapacity`（它不像看起来那么有用）并且`trimToSize`很少有用。

在成本方面，这取决于你是否有可能失败。如果您不抛出异常，典型的类型检查可能需要大约 40 纳秒。Upcast 应该被 JIT 优化掉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:22:15.690

如果数据库实际上没有返回 a `ArrayList`，则强制转换不会为您转换它——相反，您会`ClassCastException`在运行时看到 a 。相反，您应该实例化一个您想要使用的类型的新集合，并`addAll(Collection c)`在从数据库返回的集合上调用它的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T14:28:16.750

如果您以 开头，`ArrayList<Object>`则将其转换`ArrayList`为**不是向上**转换：它只是将参数化类型转换为其原始对应物。此外，转换`ArrayList`为`ArrayList<String>`也不**是 downcast**：它是**未经检查的**转换为参数化类型。两者都只是**编译器工件**，**没有运行时等效项**。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-20T06:35:51.597

如果从那时起您是`getting/saving` 不同的表，`database`则为每个`table`首先创建`table`具有完整映射的类`table`。然后在**(Insert,update,delete,select)**的函数中使用相应的表类对象传递数据。并按原样使用。为此，您必须创建不同的函数来**获取或保存**数据到表中。但这是完成这项任务的最有效方式。有关向上转换/向下转换的更多信息，请参见[此处的链接](http://forum.codecall.net/topic/50451-upcasting-downcasting/#axzz2FVaJIIvA)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T14:25:04.793

性能方面的“成本”几乎为零（唯一的成本是在向下转换的运行时检查中）。

强制转换不会改变列表本身，只会改变引用的类型。

您以什么形式（数据类型）获取“来自数据库的数据”？如果您希望能够从例如 JDBC ResultSet 转换为 List，那么这不适用于强制转换 - 您实际上需要遍历 ResultSet 以获取数据。

# sass - 指南针和 sass：可以自动导入所有部分吗？

> ID：13954330
> 
> 赞同：11
> 
> 时间：2012-12-19T14:19:47.650
> 
> 标签：sass, compass-sass

在 compass/sass 设置中，理想情况下我想将每个 .scss 文件编译成一个大的`style.css`. 看例如[这里](https://stackoverflow.com/questions/5688291/how-to-merge-css-files-with-sass-or-other-tool)，似乎我唯一的选择是从一个主文件中制作`_partials.scss` 和制作。`@import "these";`这似乎是双重工作，因为每次我将 .scss 文件移动到子文件夹时，我都必须更新引用的导入路径。

我的问题是：是否可以使用 compass 而不是只监视一个文件夹并始终将所有部分编译成一个单一的目标输出文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-21T04:44:27.683

使用[Sass 通配符插件](https://github.com/chriseppstein/sass-globbing)。

这样您就可以导入整个文件夹：

```
@import "library/partials/*" 
```

部分将在导入之前按字母顺序排序。

# doctrine-orm - 如何用多个连接编写这个学说查询？

> ID：13954332
> 
> 赞同：0
> 
> 时间：2012-12-19T14:19:51.793
> 
> 标签：doctrine-orm, doctrine, query-builder, doctrine-query

我有一个实体 Person (p)，它与与实体 NotificationType 相关的实体 Notifications 相关。

*   有些人收到了类型 1 的通知 (notification_type_id = 1)。
*   有些已收到通知，但不是类型 1
*   有些根本没有收到消息。

在全球范围内，我想检索那些尚未收到类型 1 消息的人。

我写了这个查询：

```
$qb = $this->createQueryBuilder('p')
        ->leftJoin('p.notifications', 'n')
        ->leftJoin('p.notification_type', 'nt')
        ->addSelect(array('p','n','nt'))
        ->where('nt.id NOT IN (1)')
        ->orderBy('p.name', 'ASC');
return $qb->getQuery()->getResult(); 
```

但是通过这个查询，我只得到那些收到通知但不是类型 1 的人，我没有得到那些根本没有收到通知的人。

我怎样才能纠正我的查询以获得那些？

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:03:30.310

NOT IN 带有空值（对于没有消息的连接）不会像您期望的那样解析。eq 或 ne 也是如此。

尝试：

```
$qb = $this->createQueryBuilder('p');
$results = $qb->leftJoin('p.notifications', 'n')
              ->leftJoin('p.notification_type', 'nt')
              ->addSelect(array('p','n','nt'))
              ->where('nt.id !=1')
              ->orWhere('nt.id IS NULL')
              ->orderBy('p.name', 'ASC');
return $qb->getQuery()->getResult(); 
```

您也可以将这些作为加入条件，请参阅[13.2.5。](http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html#the-expr-class)教义代码[的 Expr 类](http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html#the-expr-class)

顺便说一句，您可能不需要 select，因为您可以通过实体中的 getter 以编程方式访问这些值。

# objective-c - iMac - 缺少 x86 版本的 GameKit

> ID：13954333
> 
> 赞同：4
> 
> 时间：2012-12-19T14:19:59.253
> 
> 标签：objective-c, macos, gamekit, monomac, xamarin.mac

如果我运行这个命令：

`file /System/Library/Frameworks/GameKit.framework/GameKit`

我得到：

`/System/Library/Frameworks/GameKit.framework/GameKit: Mach-O 64-bit dynamically linked shared library x86_64`

这相当于我的 iMac（一个全新的）缺少 x86 版本的 GameKit。所以我的 x86 Mac 应用程序（它是一个 C# Xamarin.Mac 应用程序）在引用 GameKit 时崩溃。

有谁知道这是否会成为未来 Mac 的持续问题？或者这是我的机器上缺少的Apple错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:46:50.630

**一切都指向 Apple 在某个时候弃用 32 位（架构 i386）代码。**这是因为他们利用从 32 位代码切换到 64 位代码的优势来为 Objective-C 运行时添加功能，使 64 位运行时功能更加丰富。

我对此没有任何确认，但从 PowerPC 转换的处理方式以及 64 位代码如何弃用大量古老技术来看，这可能并不遥远。

虽然我的机器上确实有 32 位 GameKit，但如果 OS X 的未来版本可能不包含 32 位代码，我一点也不感到惊讶。由于所有包含 GameKit 的 Mac 都必须能够运行 64 位代码（Mountain Lion 的要求），**我能给出的最佳建议是添加 64 位版本的应用程序**。我不知道 MonoMac 是否支持 64 位代码，但这是你应该去的方向。

我怀疑操作系统更新（例如即将推出的 10.8.3）可能会安装恰好包含 32 位代码的 GameKit 版本。或者它可能会为我们其他人删除 32 位代码。但我绝对*不会指望 Apple 维护或向 32 位代码添加新功能*，正是因为所谓的 32 位 Objective-C*无法*支持他们喜欢的许多功能（例如 ARC 或合成 ivars）在不破坏二进制兼容性的情况下运行时。

# javascript - 未捕获的 SyntaxError：意外的数字

> ID：13954340
> 
> 赞同：0
> 
> 时间：2012-12-19T14:20:11.243
> 
> 标签：javascript, jquery

这段代码有什么问题：

```
var car;
if($('input:radio[name=fahrzeug]:checked').val() == "Lamborghini Gallardo GT3") {
    car = 389;
}elseif($('input:radio[name=fahrzeug]:checked').val() == "Ferrari 430 Scuderia"){
    car = 349;
}else{
    car = 0;
} 
```

因为我收到此错误： Uncaught SyntaxError: **Unexpected number**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:21:04.567

JavaScript中没有`elseif`关键字。改为使用`else if`。

**参考：**

*   [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/if...else](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/if...else)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:22:00.637

这就是问题所在：

```
elseif 
```

那应该是：

```
else if 
```

# jquery - 内容上下边缘的透明度渐变

> ID：13954342
> 
> 赞同：5
> 
> 时间：2012-12-19T14:20:13.650
> 
> 标签：jquery, css, transparency, gradient

我目前正在处理一个页面，它几乎完成了。但有一件事让我很困扰。我有一个带有滚动条和大量文字和图片的内容 div (670x400px)。当我滚动时，有时文本被切成两半，在边缘有一行半个字母。我附上了我的意思的图片。

[http://imageshack.us/photo/my-images/195/unbenannt1fll.jpg/](http://imageshack.us/photo/my-images/195/unbenannt1fll.jpg/)

我现在想做的是让边缘淡出。我想到了一些想法，例如在此处放置白色渐变或透明度或带有 jquery 的东西，并搜索了几个单词，但我没有找到任何有用的东西，而且我自己也想不出一些东西。我希望你能理解我的问题并帮助我。

编辑：

我添加了一张我想要创建的（photoshopped）图片。

[http://imageshack.us/photo/my-images/339/unbenannt1qo.jpg/](http://imageshack.us/photo/my-images/339/unbenannt1qo.jpg/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:35:15.980

为格式化道歉，但这里是从白色到透明的背景渐变的相关 css。那应该做你需要的。

**编辑**

`:before`通过使用绝对定位在包含 div 中的伪元素，可以在不添加第二个元素的情况下执行此操作。这在 IE7 中不起作用。[这是](http://jsfiddle.net/4gS7C/)一个要演示的小提琴

```
.gradient{
    position:relative;
}

.gradient:before{
position:absolute;
content: " ";
top:0;
width:100%;
height:20px;
z-index:1;
background: -moz-linear-gradient(top,  rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,1)), color-stop(100%,rgba(255,255,255,0))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* IE10+ */
background: linear-gradient(to bottom,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffffff',GradientType=0 ); /* IE6-9 */

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:46:04.703

您可以使用 css3 渐变轻松做到这一点（以及 IE 6-9 的过滤器后备）

活生生的例子：

[http://jsfiddle.net/kdQ4y/](http://jsfiddle.net/kdQ4y/)或[http://jsfiddle.net/kdQ4y/1/](http://jsfiddle.net/kdQ4y/1/)

[使用http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)生成的渐变代码

html结构

```
<div class="wrap">
   <div class="top"></div>
   <div class="content">Content here</div>
   <div class="bottom"></div>
</div> 
```

css（并非全部都是必需的）

```
.wrap{
    margin:40px;
    position:relative;
    padding:10px;
}

.content{
    height:100px;
    overflow-y:scroll;
}​

.top,.bottom {
    height:40px;
    width:100%;
    position:absolute;
    left:0;
    z-index:10;
}

.top{
    top:0;
    background: -moz-linear-gradient(top,  rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,1)), color-stop(100%,rgba(255,255,255,0))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* IE10+ */
background: linear-gradient(to bottom,  rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffffff',GradientType=0 ); /* IE6-9 */

}

.bottom {
    bottom:0;
background: -moz-linear-gradient(top,  rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0)), color-stop(100%,rgba(255,255,255,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* IE10+ */
background: linear-gradient(to bottom,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00ffffff', endColorstr='#ffffff',GradientType=0 ); /* IE6-9 */

} 
```

# jquery - Firefox 17.0.1 未收到 http 响应

> ID：13954343
> 
> 赞同：1
> 
> 时间：2012-12-19T14:20:18.780
> 
> 标签：jquery, ajax, firefox, servlets, httpresponse

我正在开发一个网站，该网站使用 jQuery 1.8.0 向 Java servlet 发出经典的 ajax 请求（确切地说，是一个 Struts 1 操作）。我应该收到 json，它是用 Jackson 创建的。

大多数时候，一切正常，但有时，Firefox 17 似乎没有收到响应并挂起，直到我使用 Windows 的任务管理器结束其进程。我可以在 Firebug 中看到请求已发送，并且在 OC4J 的日志中我的服务器已被调用并已发送响应，但未收到任何响应。即使超时，jQuery ajax 错误方法也不会被调用，并且 Firefox 会保持完全阻塞。

我尝试在禁用插件的情况下重新启动 Firefox，但仍然是同样的问题。

最奇怪的是，这个问题不会发生，IE 和 Chrome 都没有。

除非被要求，否则我不会发布任何代码，因为我的代码非常经典。

你们中是否有人已经面临这个问题？或者也许有一个线索？

谢谢。

编辑

我的代码是异步的，所以 Firefox 不应该这样挂，我不明白。

代码，如要求：

Javascript

```
$.ajax({
    type : 'POST',
    url : 'calculate.do?action=career',
    timeout: 40000,
    data : {
    "data": JSON.stringify(obj)
    },
    success: function(json){
        // do stuff with json, like setting some field's values
    },
    error: function(xhr, ajaxOptions, thrownError){
        // error message somewhere in the page
    }
); 
```

支柱动作：

```
 private static final String A_JSON_STRING = "{\"msg\" : \"success\", "
         + "\"code\" : \"0\"}";

    public ActionForward career(final ActionMapping mapping,
        final ActionForm form, final HttpServletRequest request,
        final HttpServletResponse response) throws Exception {

        PrintWriter writer = null;
        writer = response.getWriter();
        String json = request.getParameter("data");

        // do stuff with json then send a response 

        response.setContentType("application/json");
        writer.write(A_JSON_STRING);

        writer.flush();
        writer.close();

        // struts should return an action forward but as it's an ajax call,
        // there's no need to
        return null;

} 
```

为了清楚起见，我跳过了 try/catch/finally，但它存在于我的代码中。

**编辑 2：**我最终切换到 Firefox 18（测试版），现在一切似乎都很好......

# c# - 在 Datagrid-WPF 中垂直显示水平表

> ID：13954344
> 
> 赞同：9
> 
> 时间：2012-12-19T14:20:20.230
> 
> 标签：c#, sql-server, wpf, wpfdatagrid

我有一个从数据库中显示的表。我想显示水平标题列-> 垂直

我的表结构是

```
 Server|Role|Status|Date 
```

但我想显示为

```
 Server
  Role
  Status
  Date 
```

我尝试翻转数据集，并尝试构建它。最初构建是成功的，但我无法查看我的数据网格上的任何数据。请帮忙，有没有其他方法可以解决这个问题？

这是我的代码片段

```
SqlConnection con;
SqlDataAdapter da = null;
DataSet ds = null;

private void Page_Loaded(object sender, RoutedEventArgs e)
{
    try
    {
       da = new SqlDataAdapter("Select * from [ServerDB_Test].[dbo].[ServerStatus] ", con);
       ds = new DataSet();
       foreach (DataTable dt in my_DataSet.Tables)
       {
            DataTable table = new DataTable();

            for (int i = 0; i <= dt.Rows.Count; i++)
            {
                table.Columns.Add(Convert.ToString(i));  }
                DataRow r;
                for (int k = 0; k < dt.Columns.Count; k++)
                { 
                    r = table.NewRow();
                    r[0] = dt.Columns[k].ToString();
                    for (int j = 1; j <= dt.Rows.Count; j++)
                    {  
                        r[j] = dt.Rows[j - 1][k]; 
                    }
                    table.Rows.Add(r);
                }
            ds.Tables.Add(table);
        }
        da.Fill(ds);
        dataGrid1.ItemsSource = ds.Tables[1].DefaultView;
   }
   catch (Exception ex)
   {
       Console.WriteLine(ex.Message);
   }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-20T13:27:14.527

起初我尝试使用数据透视表在我的数据库中旋转我的表，但无法成功..

然后我发现设置 datagrid.layouttransform 和一个 datagrid.Cellstyle 来旋转表格的视图。

```
 <DataGrid.LayoutTransform>
             <TransformGroup>
                 <RotateTransform Angle="90"/>
                  <MatrixTransform Matrix="-1,0,0,1,0,0"/>
              </TransformGroup>
           </DataGrid.LayoutTransform>
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="{x:Type DataGridColumnHeader}" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                    <Setter Property="LayoutTransform">
                        <Setter.Value>
                            <TransformGroup>
                                <RotateTransform Angle="-90"/>
                                <ScaleTransform ScaleX="1" ScaleY="-1" />
                            </TransformGroup>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.ColumnHeaderStyle>
           <DataGrid.CellStyle>
                <Style  TargetType="DataGridCell">
                    <Setter Property="LayoutTransform">
                        <Setter.Value>
                            <TransformGroup>
                                <RotateTransform Angle="-90"/>
                                <ScaleTransform ScaleX="1" ScaleY="-1" />
                            </TransformGroup>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.CellStyle> 
```

并相应地设置列的高度和宽度，它工作正常。谢谢 ！

# magento - 如何使用自定义 Magento 模块的安装脚本创建文件夹？

> ID：13954345
> 
> 赞同：1
> 
> 时间：2012-12-19T14:20:21.693
> 
> 标签：magento

我正在开发一个扩展，可以通过将扩展文件夹复制到 Magento 文件夹来安装它。此扩展包括 Magento 媒体文件夹中的一个文件夹，该文件夹应可由 Magento 写入。由于可以使用与运行 Magento 的权限不同的权限来复制文件夹，因此我正在寻找在安装脚本中创建此文件夹的方法。

在脚本中运行此代码以进行 sql 或实体设置对我来说似乎是一种不好的做法。Magento 有什么方法可以在适当的设置脚本中执行此类任务，还是应该让我的完美主义者闭嘴，只需将代码放入 sql 设置脚本中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-12T07:57:52.543

如果您想在 magento 中为自定义扩展创建一个文件夹，请使用此代码。

```
 $customDir = Mage::getBaseDir('media').DS.'foldername';
    $ioFile = new Varien_Io_File();
    $ioFile->checkAndCreateFolder($customDir); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:45:49.637

您可以使用 Varien_Io_File::checkAndCreateFolder() 来检查和创建目录，而不是在安装脚本中，而是在文件夹的实际使用位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:31:43.297

我认为在安装脚本中创建这些文件夹不是 Magento 风格的。将它们与您的扩展一起打包并让用户将它们放在正确的位置更合乎逻辑。恕我直言。

为确保权限，您可以在代码中对其进行测试，如果不正确则生成错误消息，并确保在手册中向用户提及。

# c# - 使用 C# 对象创建 JSON

> ID：13954348
> 
> 赞同：8
> 
> 时间：2012-12-19T14:20:25.283
> 
> 标签：c#, asp.net-mvc, json

我正在尝试创建以下 JSON 数据：

```
{
'chart.labels': ['Bob','Lucy','Gary','Hoolio'],
'chart.tooltips': ['Bob did well',
               'Lucy had her best result',
               'Gary - not so good',
               'Hoolio had a good start'
              ]
} 
```

我正在使用 C# 并尝试创建一个对象以执行此操作.....类似于：

```
public class chart{
 public string[] chart.labels {get;set;}
 public string[] chart.tooltips {get;set;}
} 
```

但显然我不能有包含空格的属性。

我该怎么做呢？

**更新：**

使用 JamieC 的回答可以完美地完成以下工作

```
public virtual ActionResult CompanyStatus()
    {
        var labelList = new List<string>() { "Bob", "Lucy", "Gary", "Hoolio" };
        var tooltipsList = new List<string>() { "Bob did well", "Lucy had her best result", "Gary - not so good", "Hoolio had a good start" };

        var cData = new chartData()
        {
            Labels = labelList.ToArray(),
            Tooltips = tooltipsList.ToArray()
        };

        var serializer = new DataContractJsonSerializer(cData.GetType());
        String output;
        using (var ms = new MemoryStream())
        {
            serializer.WriteObject(ms, cData);
            output = Encoding.Default.GetString(ms.ToArray());
        } 

        return this.Content(output);
    }

    [DataContract]
    public class chartData
    {
        [DataMember(Name = "chart.labels")]
        public string[] Labels { get; set; }

        [DataMember(Name = "chart.tooltips")]
        public string[] Tooltips { get; set; }

    }
} 
```

产生：

```
{"chart.labels":["Bob","Lucy","Gary","Hoolio"],"chart.tooltips":["Bob did well","Lucy had her best result","Gary - not so good","Hoolio had a good start"]} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T14:24:07.387

执行此操作的常用方法是使用 a`DataContractJsonSerializer`将您的对象转换为 Json，并使用`DataMember`属性来注释要用于属性的名称：

```
[DataContract]
public class ChartModel{
 [DataMember(Name = "chart.labels")]
 public string[] Labels {get;set;}
 [DataMember(Name = "chart.tooltips")]
 public string[] Tooltips {get;set;}
} 
```

我个人用我自己的`ActionResult`来封装MVC中的序列化：

```
public class JsonDataContractResult : ActionResult
{
    public JsonDataContractResult(Object data)
    {
        this.Data = data;
    }

    protected JsonDataContractResult()
    {

    }

    public Object Data { get; private set; }

    public override void ExecuteResult(ControllerContext context)
    {
        Guard.ArgumentNotNull(context, "context");

        var serializer = new DataContractJsonSerializer(this.Data.GetType());
        String output; 
        using (var ms = new MemoryStream())
        {
            serializer.WriteObject(ms, this.Data);
            output = Encoding.Default.GetString(ms.ToArray());
        } 
        context.HttpContext.Response.ContentType = "application/json";
        context.HttpContext.Response.Write(output);
    }        
} 
```

并从基本控制器中的辅助方法返回：

```
public abstract class MyBaseController: Controller
{

    protected JsonDataContractResult JsonContract(Object data)
    {
        return new JsonDataContractResult(data);
    }

} 
```

然后我的控制器变得非常简单：

```
public class SomeController: MyBaseController
{
    public ActionResult SomeAction()
    { 
        var model = new ChartModel()
                   { 
                       Labels = ..., 
                       Tooltips = ... 
                   };
        return JsonContract(model);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:23:16.033

你可以使用 JSON.NET 库，你可以从[这里下载](http://james.newtonking.com/pages/json-net.aspx)

它有这个特点：

> 属性属性名称自定义

这个问题将帮助您：

[Json.Net：用于自定义命名的 JsonSerializer-Attribute](https://stackoverflow.com/questions/6860602/json-net-jsonserializer-attribute-for-custom-naming)

你可以使用**DataContractJsonSerializer**它提供了这个功能，但**JavaScriptSerializer**没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T08:30:03.727

对于 MVC 项目`Newtonsoft.Json`库可用。（您必须手动将其包含在其他项目中）

所以给`JsonProperty`模型，像这样......

```
public class ChartModel{
    [JsonProperty("chart.labels")]
    public string[] Labels {get;set;}
    [JsonProperty("chart.tooltips")]
    public string[] Tooltips {get;set;}
} 
```

并使用`Newtonsoft.Json.JsonConvert.SerializeObject(object);`or`Json.Encode(object)`转换为 JSON。

# android - Android：如何将额外的字符串传递给电子邮件？

> ID：13954349
> 
> 赞同：0
> 
> 时间：2012-12-19T14:20:25.557
> 
> 标签：android, android-intent, email

![询问](../Images/967af4498de24c034f18928d542dbce3.png)

在这里，用户必须输入他/她的姓名、年龄和信息。它必须打开 Gmail 应用程序，显示输入的姓名/年龄/信息。它只显示消息。剩下的细节我不明白。

```
String s1= name.getText().toString();
   String s2= age.getText().toString();
   String s3= msg.getText().toString();
   Intent email = new Intent(Intent.ACTION_SEND);
   email.putExtra(Intent.EXTRA_EMAIL,
   new String[] { "abc@gmail.com" });
   email.putExtra(Intent.EXTRA_SUBJECT,"hiiiii");
   email.putExtra("Name", s1);
   email.putExtra("Age", s2);
   email.putExtra(Intent.EXTRA_TEXT, s3);
   email.setType("message/rfc822");
   startActivity(Intent.createChooser(email,"Choose an Email client :")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:25:36.010

Gmail 不接受姓名和年龄字段。

如果您想将它们附加到您的消息正文中，您可以将它们附加到`s4msg`字符串并将它们作为消息一起传递。

```
s4msg = s1name + "\n" + s2age + "\n" + s4msg   
email.putExtra(Intent.EXTRA_TEXT, s4msg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:26:16.637

在打开邮件应用程序之前，您需要格式化邮件正文。就像是：

```
String messageTemplate = "Hi %1$s\nThis is your message: %2$s";
String mailBody = String.format( messageTemplate, name.getText().toString(), msg.getText().toString() );

Intent email = new Intent(Intent.ACTION_SEND);
email.putExtra(Intent.EXTRA_EMAIL, new String[] { "abc@gmail.com" });
email.putExtra(Intent.EXTRA_SUBJECT,"hiiiii");
email.putExtra(Intent.EXTRA_TEXT, mailBody);
email.setType("message/rfc822");
startActivity(Intent.createChooser(email,"Choose an Email client :")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:25:37.167

那是因为 EMAIL 类型没有名称或年龄的概念。电子邮件仅包含收件人、发件人、消息和主题。您必须连接您的姓名和年龄数据并将其放在主题或消息中。像这样的东西会起作用：

```
String s1= name.getText().toString();
String s2= age.getText().toString();
String s3= msg.getText().toString();
Intent email = new Intent(Intent.ACTION_SEND);
email.putExtra(Intent.EXTRA_EMAIL,
new String[] { "abc@gmail.com" });
email.putExtra(Intent.EXTRA_SUBJECT,"hiiiii");
email.putExtra("Name", s1);
email.putExtra("Age", s2);
nameAgeStr = "Name: " + s1 + " Age: " + s2 + ".\n";
email.putExtra(Intent.EXTRA_TEXT,nameAgeStr + s3);
email.setType("message/rfc822");
startActivity(Intent.createChooser(email,"Choose an Email client :")); 
```

这会将姓名和年龄放在电子邮件正文（消息）的一行中。

# visual-studio-2010 - Visual Studio 项目模板和资源文件

> ID：13954355
> 
> 赞同：1
> 
> 时间：2012-12-19T14:20:42.997
> 
> 标签：visual-studio-2010, visual-studio-templates

我正在尝试为创建多个文件的 Visual Studio 创建自定义项模板。其中两个文件是`Resource.resx`文件和相应的“Resource.Designer.cs”文件。

我已经设法将它们显示为父子文件，并在文件中使用此声明`.vstemplate`：

```
<ProjectItem ItemType="EmbeddedResource" TargetFileName="$fileinputname$Resources.resx" ReplaceParameters="true">Resources.resx</ProjectItem>
<ProjectItem TargetFileName="$fileinputname$Resources.resx\$fileinputname$Resources.Designer.cs" ReplaceParameters="true">Resources.Designer.cs</ProjectItem> 
```

这也被声明`Resource.resx`为嵌入式资源。

我现在遇到的问题是，在使用此模板创建项目后，该`Resource.resx`文件不用`Resources.Designer.cs`作文件后面的代码。一旦我在`Resource.resx`文件中添加一个新的资源字符串，它就会创建一个新`Resources1.Designer.cs`文件，Visual Studio 从那时起将其用作代码。

我检查了`.csproj`Visual Studio 创建新的代码隐藏文件之前和之后对文件所做的更改，我发现主要原因是因为没有文件`<LastGenOutput>`条目`Resource.resx`。

是否有某种方法可以`<LastGenOutput>`通过声明`.vstemplate`或任何其他方式将`.resx`文件与其代码隐藏文件连接起来，而无需手动执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T10:56:34.653

[应该使用 C# 项目文件 (.csproj) 中的DependendUpon](http://msdn.microsoft.com/en-us/library/bb629388.aspx)标记声明父子关系，如下所示：

```
<Project ...>
   ...
    <ItemGroup>
      ...
        <EmbeddedResource Include="Resources.resx">
           ...
        </EmbeddedResource>
        <Compile Include="Resources.Designer.cs">
            <DependentUpon>Resources.resx</DependentUpon>
            ...
        </Compile>
        ...
    </ItemGroup>
 </Project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:13:54.747

由于 Visual Studio 中已包含此模板，因此您需要此模板的原因还不是很清楚。您可以使用 Project + Add New Item + General + Resources File 选择它。

如果您想自定义它，那么您最好的选择是从现有的开始。导航到 C:\Program Files (x86)\Microsoft Visual Studio xx\Common7\IDE\ItemTemplatesCache\CSharp\General\1033\Resource.zip 其中 xx 是 VS 版本号，如果不使用 1033 可能会有所不同VS的英文版。

我将只发布您在那里找到的 .vstemplate 文件，请务必复制/粘贴该文件以自行开始：

```
<?xml version="1.0" encoding="utf-8"?>
<VSTemplate Version="3.0.0" Type="Item" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005">
  <TemplateData>
    <Name Package="{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}" ID="2390" />
    <Description Package="{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}" ID="2391" />
    <Icon Package="{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}" ID="4565" />
    <TemplateID>Microsoft.CSharp.Resource</TemplateID>
    <ProjectType>CSharp</ProjectType>
    <RequiredFrameworkVersion>2.0</RequiredFrameworkVersion>
    <NumberOfParentCategoriesToRollUp>1</NumberOfParentCategoriesToRollUp>
    <DefaultName>Resource.resx</DefaultName>
  </TemplateData>
  <TemplateContent>
    <ProjectItem>Resource.resx</ProjectItem>
    <CustomParameters>
      <CustomParameter Name="$itemproperties$" Value="CustomTool" />
      <CustomParameter Name="$CustomTool$" Value="ResXFileCodeGenerator" />
    </CustomParameters>
  </TemplateContent>
  <WizardExtension>
    <Assembly>Microsoft.VisualStudio.Editors, Version=9.0.0.0, Culture=Neutral, PublicKeyToken=b03f5f7f11d50a3a</Assembly>
    <FullClassName>Microsoft.VisualStudio.Editors.ResourceEditor.ResxItemWizard</FullClassName>
  </WizardExtension>
</VSTemplate> 
```

如果要添加更多文件，请添加更多`<ProjectItem>`元素。

# mysql - MySQL - WHERE IN 将列表放入字段

> ID：13954356
> 
> 赞同：3
> 
> 时间：2012-12-19T14:20:43.920
> 
> 标签：mysql, sql, select, sql-like, find-in-set

我有一个具有此值的字段（“角色”）

```
 roles
row_1: 1,2,3,5
row_2: 2,13 
```

我这样做：

```
SELECT * FROM bloques WHERE 2 IN (roles) 
```

并且只找到 row_2，因为它从 2 开始

LIKE 选项不起作用，因为如果我找到 1

```
SELECT * FROM bloques WHERE roles LIKE '%1%' 
```

，它给了我两行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:28:27.393

[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)函数可以帮助您：

```
SELECT FIND_IN_SET('b','a,b,c,d'); 
```

对于您的代码：

```
SELECT * FROM bloques WHERE FIND_IN_SET(2,roles); 
```

另外，我建议您将架构移至[1NF](http://en.wikipedia.org/wiki/First_normal_form)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:28:03.623

你能用正则表达式吗？[http://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

否则，您可以在行的开头和结尾添加逗号。

```
select * from mytable where ',' + roles + ',' like '%,2,%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:30:25.027

```
SELECT 
  * 
FROM 
  bloques 
WHERE 
  roles LIKE '%,2,%' 
  OR roles LIKE '2,%' 
  OR roles LIKE '%,2' 
```

第一种情况将为您提供 2 位于集合中间的所有情况，第二种情况是 2 开始集合，第三种情况是 2 结束集合。这可能是非常低效的，但它应该工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:30:33.447

使用[**FIND_IN_SET()**](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_find-in-set)函数

尝试这个：

```
SELECT * FROM bloques WHERE FIND_IN_SET(1, roles); 
```

**或者**

```
SELECT * FROM bloques 
WHERE CONCAT(',', roles, ',') LIKE '%,1,%'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T14:30:46.043

您可以在此处使用此正则表达式：

```
SELECT * FROM bloques 
  WHERE roles REGEXP '[[:<:]]2[[:>:]]'; 
```

...或者，在更一般的情况下：

```
SELECT * FROM bloques 
  WHERE roles REGEXP CONCAT('[[:<:]]', :your_value, '[[:>:]]'); 
```

您需要使用这些看起来很奇怪的东西，因为它们匹配单词边界 - 防止匹配 '2' 出现在 '23' 和 '32'。)

问题是查询只是使用非规范化字段引起的麻烦的开始。我建议使用 SET 类型（如果选项数量有限且很少），或者更好的是，使用联结表来存储 mn 关系。

# google-app-engine - 谷歌应用引擎，模板：实体键变成了类似 url 编码的字符串

> ID：13954360
> 
> 赞同：1
> 
> 时间：2012-12-19T14:20:55.207
> 
> 标签：google-app-engine, templates

我试图将元组列表传递给模板系统，包括实体键。但是，传递给模板的键看起来像是一个 url 编码的字符串。如何解决问题？谢谢。

看法：

```
items = []
for i in range(50):
  if prod[i]:
      items.append((prod[i].name, prod[i].key, someList[i]))
  else
      items.append((None, None, otherList[i])) 
```

html模板：

```
{% for item in items %}
   ...
   <img src="/image?entity_id={{item.1}}" />
   ...
{% endfor %} 
```

图像请求中的实体键结果如下：

**/GET /image?entity_id=%3Cbound%20method%20Product.key%20of%20%3Cmodel.Product%20object%20at%200xad63f2c%3E%3E HTTP/1.1" 404 -**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:29:25.547

由于您使用的是原始 db 库而不是 ndb。`key`是一种方法 - 正如您从值中看到的那样，它表示“绑定方法 Product.key ...”。你需要调用它：

```
items.append((prod[i].name, prod[i].key(), someList[i])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:49:29.540

我建议在您的 URL 中使用 NDB API 提供的 url 安全编码字符串，因为它比原始密钥更优雅。

因此，您可以通过以下方式创建它：

```
items.append((prod[i].name, prod[i].key.urlsafe(), someList[i])) 
```

在您的处理程序中，您可以根据编码的 urlsafe 字符串将 Key 重构为：

```
my_key = ndb.Key(urlsafe=your_encoded_string) 
```

有关更多信息，您可以查看[NDB Key 类](https://developers.google.com/appengine/docs/python/ndb/keyclass)。

# iphone - 使用目标 c 中的块声明 iVar

> ID：13954365
> 
> 赞同：3
> 
> 时间：2012-12-19T14:21:07.997
> 
> 标签：iphone

我是块新手。我想创建一个 iVar NSMutableArray，我可以在块方法中访问它。有人可以告诉我如何使用 _block 关键字声明它吗？

```
@interface ViewController : UIViewController
{
    __block NSMutableArray *array;
}
@property (nonatomic, weak) NSMutableArray *array; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:33:31.387

您无需`__block`在 iVar 前面设置 。

根据：http: [//developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/bxVariables.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/bxVariables.html)

> 复制块时，它会创建对块内使用的对象变量的强引用。如果在方法的实现中使用块：
> 
> *   如果通过引用访问实例变量，则会对 self 进行强引用；
> *   如果您按值访问实例变量，则会对该变量进行强引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:01:53.030

您通常不应该从除`init`and之外的任何地方访问 ivars `dealloc`。所以几乎没有理由直接从块内访问 ivar。相反，在拥有 ivar 的对象上使用访问器（通常`self`）。

对于多线程块，这看起来像这样：

```
__weak id weakself = self;
[obj doSomethingWithBlock:^{
   id strongself = weakself;
   strongself.array = nil; // Can't safely read from the array here without more code.
}]; 
```

如果这不是多线程操作，那么您可以这样做：

```
__weak id weakself = self;
[obj doSomethingWithBlock:^{
   NSLog(@"%@", weakself.array[0]);
}]; 
```

如果没有保留循环的危险（因为该块立即在该线程上执行），您可以更简单地执行此操作：

```
[obj doSomethingWithBlock:^{
   NSLog(@"%@", self.array[0]);
}]; 
```

# javascript - jQuery：将所有 ready() 规则应用于新元素的技巧或最佳实践（不讨论 live() 或 on()）

> ID：13954368
> 
> 赞同：2
> 
> 时间：2012-12-19T14:21:12.787
> 
> 标签：javascript, jquery, ajax, asp.net-mvc-3

我在 jQuery`ready()`函数上有一些标准插件绑定，适用于所有新请求。现在，随着我们向应用程序添加越来越多的 ajax，这些新元素被留在了初始绑定之后。

示例规则：

```
$(function () {
    $('.date').datepicker({ showOn: 'button', buttonImage: "cal.gif" })
               .blur(function (e) {
                   $(this).val(formatFecha($(this).val()));
               })
    $('.ui-datepicker-trigger').attr("tabindex", "-1");
    $(".decimalnumber").numpadDecSeparator({ separator: "," })
                   .numeric(",")
                   .focus(function () { if ($(this).val() == '0,00' || $(this).val() == '0') $(this).val(''); });
    $(".integernumber").numeric().focus(function () { if ($(this).val() == '0') $(this).val(''); });
    $(".spinner").spinner({ min: 0, max: 10000000 });
    $(".jbtn").button();

    ....... 
```

我**不是**在谈论`live()`绑定事件的函数，因为这不是事件。

因为我认为这是相当普遍的，所以我想知道你们是如何做到的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:23:52.773

将这些函数放在它们自己的单独函数中。`document.ready`在您需要重新加载内容的任何其他时间调用 THAT 函数。

```
function initialize() {
    // do stuff;
}

$(document).ready(function() {
    initialize();
});

$.ajax({
    // url, data, etc.
    success: function() {
        initialize();
    }
}); 
```

请注意，某些插件（例如更改 DOM 的幻灯片）可能需要您`destroy`在重新初始化它们之前调用方法或选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:32:01.140

我使用一个名为[TerrificJS](http://terrifically.org)的 javascript 库。它使我可以轻松地使用 ajax 加载 html 并按时初始化与之配套的 javascript。但这并不是那么简单。TerrificJS 依赖于命名约定。

假设 ajax 返回以下 html：

```
<div class="mod modMyInteractiveModule">Cool stuff, buttons etc here</div> 
```

然后我有一个辅助函数，它扫描**ajax 成功**返回的 html并挑选出所有带有 css 类**mod**和**modX**的元素。帮助程序检查是否有一个名为**X**的 javascript 类，或者继续使用上面的示例**MyInteractiveModule**。

```
Tc.Module.MyInterActiveModule = function () {
    // Bindings go here
} 
```

即使您不想使用 TerrificJS 并实施自己的解决方案，我也希望我能有所启发。可以在[http://terrifically.org/api/sandbox/](http://terrifically.org/api/sandbox/)下**动态添加新小部件**下找到 TerrificJS 示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:24:39.283

我会移动 init() 函数中指定的所有代码，并在 document.ready 和 ajax 成功/失败时调用它，这取决于我想要做什么

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T15:02:26.147

我最终使用了@Blazemonger 代码的精炼版本：

您只需要按照约定为新元素添加一个类名。

```
 function initialize(parent) {
        $(parent + ' .date').datepicker({ showOn: 'button'})
        $(parent + ' .autocomplete').each(function (i, el) {
            addbuttonautocomplete(el);
        });

        ....
        // remove the class to avoid double initialization
        $(".newelements").removeClass('newelements');
    }

    $(document).ready(function() {
        initialize('body');
    });

    $.ajax({
        // url, data, etc.
        success: function() {
            initialize('.newelements');
        }
    }); 
```

概念证明：http: [//jsbin.com/ireguj](http://jsbin.com/ireguj)

# ipad - iPad 1/2 Mobile Safari 中的 iframe 不显示整个 pdf 文件

> ID：13954370
> 
> 赞同：3
> 
> 时间：2012-12-19T14:21:15.713
> 
> 标签：ipad, pdf, mobile, iframe, safari

我遇到了一个非常奇怪的问题。我正在尝试使用 iframe 显示 pdf 文件。由 1-2 页组成的小文档可以正确显示。但是，当涉及包含例如 5 个“重”页面的文档时，iframe 不会显示整个文档 - 文档被裁剪，因此仅显示大约 2-3 页。

下面是我的代码。如您所见，它非常简单。

```
<html>
<head>
    <title>Testing iFrames on iPad</title>
</head>
<body>
    <iframe id="iframe" name="iframe" height="100%" width="100%" scrolling="no" src="https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariWebContent/SafariWebContent.pdf" />
</body> 
```

谁能帮我找出这种奇怪行为的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:34:43.660

据我了解，iframe 的高度是造成页面切断的原因，因为您实际上是在滚动框架，而不是框架内的 pdf（即，将高度设置为“400%”可能会给您提供所需的空间，但是它很草率）。
该解决方案使用 JavaScript 来滚动 pdf 内容本身，并且可能会有所帮助： [如何在移动 safari 中正确显示 iFrame](https://stackoverflow.com/questions/5267996/how-to-properly-display-an-iframe-in-mobile-safari)

# iphone - 如何对 NSUndoManager+UITextInput 的击键进行分组

> ID：13954372
> 
> 赞同：2
> 
> 时间：2012-12-19T14:21:19.683
> 
> 标签：iphone, objective-c, ios, uitextinput

我有一个实现 UITextInput 的视图，并添加了对撤消的支持。现在，每个单独的击键或退格键都被记录为可撤消的事件。

我知道我可以对事件进行分组，并且可以在第一次击键时打开一个撤消组。但是我该去哪里关闭这个小组呢？如果当用户摇动设备时该组是打开的，我会得到一个例外。撤消时，您不能有一个打开的组。

我会以某种方式需要在 NSUndoManager 实例显示操作菜单之前关闭打开的组。

我是否需要继承 NSUndoManager 才能做到这一点？或者有人知道如何在操作之前及时关闭输入撤消组吗？

注意：第一响应者在显示撤消操作时不会辞职。

实际上，在我看来，普通文本输入会以某种方式打开打字组，因为如果您取消撤消/重做警报，那么您可以继续打字，所有这些击键随后都可以一起撤消。

我想我不明白何时分组操作以及是否以及何时需要关闭一个组。

更新：我发现以下工作正常：我创建了一个 NSUndoManager 的子类，它跟踪打开组的数量。在 -undo 我正在关闭所有打开的组以避免异常，然后调用`[super undo]`

```
#import "DTUndoManager.h"

@implementation DTUndoManager
{
    NSUInteger _numberOfOpenGroups;
}

- (void)beginUndoGrouping
{
    _numberOfOpenGroups++;

    [super beginUndoGrouping];
}

- (void)endUndoGrouping
{
    _numberOfOpenGroups--;

    [super endUndoGrouping];
}

- (void)closeAllOpenGroups
{
    while (_numberOfOpenGroups>0)
    {
        [self endUndoGrouping];
    }
}

- (void)undo
{
    [self closeAllOpenGroups];

    [super undo];
}

#pragma mark - Properties

@synthesize numberOfOpenGroups = _numberOfOpenGroups;

@end 
```

每当一个新操作开始时，比如更改段落样式，我都会调用`[self.undoManager closeAllOpenGroups]`这会导致关闭输入的撤消组。

在`-deleteBackward:`and`-insertText:`方法中，我知道需要启动一个新的打字块：

```
- (void)insertText:(NSString *)text
{
    DTUndoManager *undoManager = (DTUndoManager *)self.undoManager;
    if (!undoManager.numberOfOpenGroups)
    {
        [self.undoManager beginUndoGrouping];
    } 
```

现在这不是太多额外的代码，但我希望不必使用我自己的 DTUndoManager 子类......所以我愿意接受建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T11:19:52.020

我的解决方案包含在问题的更新中。

# xml - WSO2 esb 对复杂服务的建议 - 验证当前方法

> ID：13954374
> 
> 赞同：1
> 
> 时间：2012-12-19T14:21:25.643
> 
> 标签：xml, web-services, wso2, wso2esb, synapse

任何人都可以验证这种方法吗？我对 ESB 很陌生，所以在我看来，最好的方法似乎是一个非常复杂的流程。我正在使用 WSO2 ESB（Apache Synapse）。

用例：

1.  用简单的两列读入 cvs 文件。
2.  对于每一行，取其中一个值并传递给查找服务 (ldap) 以检索更多数据
3.  从检索到的数据中获取一个值（对于每一行）并查找到另一个 Web 服务
4.  将所有行合并为一条消息，然后将生成的消息提交到外部 Web 服务

到目前为止的想法是 1) 使用 vfs 和 smooks 来解析 csv。这似乎很简单，我已经到了可以在迭代调解器中创建单独的 xml 消息来处理每一行的地步。然后对于 2) 将每一行传递给自定义调解器以进行 ldap 查找。对于 3) 获取该结果并使用其中一个元素传递给调出调解器，该调停器获取返回值（基本上是进行枚举查找）然后 4) 不知道还没有那么远。

到目前为止，3 的解决方案看起来非常复杂。Callout 调解器期待一条消息，该消息是完整的 Web 服务消息，它与 xml 行的外观完全不同。我可以使用 xslt 将其转换为 web 服务的正确输入，但结果是完整的 ws 响应 - 我可以使用属性中介获得我感兴趣的值，但不知道如何将其插入回消息中。

总而言之，这似乎不太适合 esb，但直觉上似乎是我应该这样做的方式。我当然可以只用 Java 写这一切，但很多位似乎都在 esb 中。

那么，有什么建议吗？真的很高兴继续研究细节，但如果它是错误的，那就不是了。

谢谢康拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:20:15.760

对于 3) 您可以使用[payloadfactory 调解](http://docs.wso2.org/wiki/pages/viewpage.action?pageId=14287837)器来创建一个自定义的有效负载来发送。我认为相同的调解员将有助于再次创建响应。

# git - 如何使用分支名称显示 git log

> ID：13954376
> 
> 赞同：24
> 
> 时间：2012-12-19T14:21:28.920
> 
> 标签：git, git-branch, git-log

我尝试`git log`使用`--decorate`和`--source`选项。`2f3cb60`但是还是获取不到commit的 分支名 `d7e7776`，为什么？

```
#git log 2f3cb60 --graph  --decorate --source --all --oneline
...
* | | | 1920ad5 refs/heads/gpio support gpio lib
| |/ /
|/| |
* | | 2f3cb60   2f3cb60 fix
* | | d7e7776   2f3cb60 fix
| |/
|/|
* | aa4dcfb     refs/remotes/origin/httpd support
* | cfc839d     refs/remotes/origin/httpd add folder 
```

如何显示带有分支名称的 git log？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-19T15:40:24.320

```
$ git log --graph --decorate --oneline
* 1f3e836 (HEAD, origin/v2, v2) Change scripts to new format.
*   34d458f (origin/master, master) Merge branch 'new-shell'
|\  
| * 995ece7 (origin/new-shell) Fix index.html and add script pushing.
| * fe0615f New shell hello-world.
|/  
* fe1b1c0 Progress.
... 
```

`git log --graph --decorate --oneline`应该向您显示具有名称的提交的名称。**并非每个提交都与分支名称相关联。**

请记住，分支名称只是指向特定提交的指针。每个提交都有一个父提交，因此一个提交可能是十几个独立分支历史的一部分。

*   您可以通过 . 查看哪些分支包含提交`git branch --contains <ref>`。
*   如果您只需要某种符号名称来跟踪提交，请使用`git name-rev <ref>`.
*   如果您需要包含提交的所有分支的 shell-scriptable ( ["plumbing" ) 列表，请尝试以下操作：](http://git-scm.com/book/ch9-1.html)

    ```
    commit=$(git rev-parse <ref>) # expands hash if needed
    for branch in $(git for-each-ref --format "%(refname)" refs/heads); do
      if git rev-list "$branch" | fgrep -q "$commit"; then
        echo "$branch"
      fi
    done 
    ```

另请参阅：[SO：查找提交来自哪个分支](https://stackoverflow.com/questions/2706797/git-finding-what-branch-a-commit-came-from)

# html - 如何使用代码 206 从 Grails 流式传输音频文件？

> ID：13954383
> 
> 赞同：11
> 
> 时间：2012-12-19T14:21:46.630
> 
> 标签：html, http, grails, audio-streaming, http-response-codes

我正在尝试通过以下方式使用 HTML5 功能流式传输音频/wav：

```
<audio type="audio/wav" src="/sound/10/audio/full" sound-id="10" version="full" controls="">
</audio> 
```

这在 Chrome 上运行良好，除了不可能重播或重新定位 currentTime 属性：

```
var audioElement = $('audio').get(0)
audioElement.currentTime
> 1.2479820251464844
audioElement.currentTime = 0
audioElement.currentTime
> 1.2479820251464844 
```

我使用以下代码从 Grails 控制器提供音频文件：

```
 def audio() {
    File file = soundService.getAudio(...)
    response.setContentType('audio/wav')
    response.setContentLength (file.bytes.length)
    response.setHeader("Content-disposition", "attachment;filename=${file.getName()}")
    response.outputStream << file.newInputStream() // Performing a binary stream copy
    response.status = 206

    return false
} 
```

从 Chrome 的以下输出中可以看出，Grails 似乎返回了 HTTP 响应 200 而不是 206（部分内容）：

```
Request URL:http://localhost:8080/sound/10/audio/full
Request Method:GET
Status Code:200 OK
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:identity;q=1, *;q=0
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Cookie:JSESSIONID=9395D8FFF34B7455F937190F521AA1BC
Host:localhost:8080
Range:bytes=0-3189
Referer:http://localhost:8080/cms/sound/10/edit
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.11 (KHTML, like Gecko)                 Chrome/23.0.1271.97 Safari/537.11
Response Headersview source
Content-disposition:attachment;filename=full.wav
Content-Length:3190
Content-Type:audio/wav
Date:Wed, 19 Dec 2012 13:58:44 GMT
Server:Apache-Coyote/1.1 
```

知道可能出了什么问题吗？

谢谢，阿米特。

# 添加：

将控制器逻辑更改为：

```
response.status = 206
response.setContentType(version.mime)
response.setContentLength (file.bytes.length)
response.setHeader("Content-disposition", "attachment;filename=${file.getName()}")
response.outputStream << file.newInputStream() // Performing a binary stream copy 
```

确实有助于返回 HTTP-206（部分内容），但是 Chrome 和 Firefox 都不会播放音频文件（再次提到 Chrome 在获得带有 200 的文件时确实播放了......）

![Chrome 的网络控制台截图](../Images/b732408a0f39afb4c58f1c4b5b3b6445.png)

带有以下响应信息：

```
 Request URL:http://localhost:8080/sound/10/audio/full
 Request Headersview source
 Accept-Encoding:identity;q=1, *;q=0
 Range:bytes=0-
 Referer:http://localhost:8080/cms/sound/10/edit
 User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T07:08:10.433

您可能想尝试：

```
response.reset();
response.setStatus(206);
response.setHeader("Accept-Ranges", "bytes");
response.setHeader("Content-length", Integer.toString(length + 1));
response.setHeader("Content-range", "bytes " + start.toString() + "-" + end.toString() + "/" + Long.toString(f.size()));
response.setContentType(...); 
```

并且这种类型的输出只有在客户特别要求一个范围时才应该完成。您可以使用以下方法进行检查：

```
String range = request.getHeader("range"); 
```

如果范围不为空，那么您必须解析开始和结束字节请求的范围。请注意，您可以将“0-”作为范围在某些情况下，您会看到“0-1”作为请求，以查看您的服务是否知道如何处理范围请求。

# r - 从函数中设置全局变量

> ID：13954386
> 
> 赞同：1
> 
> 时间：2012-12-19T14:21:55.143
> 
> 标签：r

我有以下功能：

```
s_c <- function(n, t){
    r_num <- runif(1,min=0,max=1)
    use <- sample(s[,1],1)
    use2 <- subset(s,s[,1]==use,2)
    use2 <- as.numeric(use2)
    ne_s <- sample(subset(s,s[,2]!=use2,2),1)

    Return(use) 
    if (t>50 & r_num<0.5){
        ne_s
    }
        else 
           0  
} 
```

我实际上想在函数外部的命令中使用函数中创建的变量，所以我想在能够引用函数外部变量的意义上“返回”

问题2：

例如，如果我想在 if 语句中进行赋值怎么办

```
 if (t>50 & r_num<0.5){
        s[,4]=use
    } 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:33:27.533

马修提到的“列表”解决方案：

......

```
list(variable1 = VarInFunction,
     variable2 = VarInFunction2) 
```

像这样，当你运行你的函数时，你可以存储它的结果。

```
Result <- s_c(10,1) 
```

然后，您可以具体询问结果，例如：

```
Result$variable1
Result$variable2 
```

请注意，`VarInFunction`它是在函数中调用的变量，并被重命名为`variable1`（或任何您想要的），并存储在`Result`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:27:14.493

尽管您可能应该将这两个值作为列表返回，但您可以很容易地影响父级的环境。

替换这个：

```
Return(use) 
```

有了这个：

```
use <<- use 
```

对于您的编辑，您可以使用以下语法：

```
s[,4] <<- use 
```

注意：“父环境”不是调用函数的环境。它是定义函数的环境。正是出于这个原因，R 中的函数被称为闭包。明确地：

```
s_c <- function() {
  use <<- 1
}

f <- function() {
  use <- 0
  s_c()
  return(use)
} 
```

`f()`将返回 0。 `s_c()`正在修改不同的`use`变量（在不同的环境中）。

# https - 如何避免在 IE9 的 HTTPS 站点上“显示所有内容”消息？

> ID：13954390
> 
> 赞同：2
> 
> 时间：2012-12-19T14:22:04.543
> 
> 标签：https, show

我们有一个 HTTPS 站点，它从我们的另一个站点（即 HTTP）打开一个页面。

在 IE (9) 中，我们在页面底部收到消息：“仅显示安全内容。有什么风险？[显示所有内容]”。

单击按钮时，它会关闭打开的灯箱式控件并返回到它所覆盖的页面。

有谁知道如何避免这种情况？

在 HTTP 站点的页面中，这里的一个人的想法是在 On_Load 的末尾添加以下内容以关闭跨站点脚本保护： this.Response.Headers.Add("X-XSS-Protection", "0 ");

这两个站点都是 C# / ASP.NET 4.0。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:27:02.013

将 url 添加到您信任的站点，如果您不通过 h​​ttps 发送所有数据，这是唯一的方法。Internet 选项 -> 安全 -> 受信任的站点 -> 站点。
如果这是公司范围内需要做的事情，我建议通过组策略推出规则。

或者，允许在其他站点上使用 https 访问控件（如果可以）并引用它 - 警告将消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-06T21:38:41.410

此处启用的真正设置是为您想要的站点区域“显示混合内容”。如果站点在您的 Intranet 上，则在安全设置中选择 Intranet 区域，然后选择自定义级别。如果它是一个 Internet 站点，您可以去那里并转到自定义级别。

在那里，您应该看到“显示混合内容”设置，只需选择“启用”，然后选择“确定”即可退出对话框。

**参考：** [https ://www.mydigitallife.net/how-to-disable-only-secure-content-is-displayed-in-ie-always-show-all-mixed-content/](https://www.mydigitallife.net/how-to-disable-only-secure-content-is-displayed-in-ie-always-show-all-mixed-content/)

# java - log4j 日志未写入文件的问题

> ID：13954394
> 
> 赞同：3
> 
> 时间：2012-12-19T14:22:13.560
> 
> 标签：java, jakarta-ee, logging, log4j

有谁知道为什么这个日志没有写入文件。它写入标准输出两次，但不写入文件：

另外，我尝试删除“Stdout”附加程序，然后我根本没有得到任何日志记录。

```
package org.berlin.wicket;
import org.apache.log4j.Logger;
private static final Logger LOG = Logger.getLogger(QuickstartPage.class);
LOG.info("Loading constructor"); 
```

> log4j.rootLogger=调试，标准输出，mainAppender
> 
> log4j.appender.Stdout=org.apache.log4j.ConsoleAppender log4j.appender.Stdout.layout=org.apache.log4j.PatternLayout
> 
> log4j.appender.Stdout.layout.conversionPattern=%-5p - %-26.26c{1} - %m\n
> 
> log4j.appender.mainAppender=org.apache.log4j.DailyRollingFileAppender
> 
> log4j.appender.mainAppender.file=logs/core.log
> 
> log4j.appender.mainAppender.datePattern='.'yyyy-MM-dd
> 
> log4j.appender.mainAppender.append=true
> 
> log4j.appender.mainAppender.layout=org.apache.log4j.PatternLayout
> 
> log4j.appender.mainAppender.layout.ConversionPattern=[%d{MM/dd/yyyy HH:mm:ss.SSS}] [%C{1}.%M():%L] [%t] [%p ] - %m%n
> 
> log4j.logger.org.berlin=调试，标准输出，mainAppender

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:59:30.893

您有两个使用相同附加程序（Stdout）的记录器，因此您会在控制台上看到两次条目。

正如其他人所提到的，这些属性区分大小写，因此您的文件附加程序配置不正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:45:06.877

和属性`File`区分`Append`大小写。

`log4j.appender.mainAppender.File=someFileName.log log4j.appender.mainAppender.Append=true`

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-12-19T14:24:54.670

您应该创建一个 FileHandler 实例，将日志写入名为 myfile.log 的文件。

```
FileHandler fileHandler = new FileHandler("myfile.log", true);        
logger.addHandler(fileHandler); 
```

# oracle - 在sql中选择空值

> ID：13954396
> 
> 赞同：0
> 
> 时间：2012-12-19T14:22:32.513
> 
> 标签：oracle, plsql, null

我有两张桌子

1.  xx_new.xx_online_registrations@appsread.prd.com oreg
2.  m_warranty_sku MSK

在 oreg 表中，我有一些字段 ora_warranty_id 的空值，但在 MSK 表中我没有空值，所以当我加入这两个表时，oreg 的空值列被过滤，有没有办法我也可以捕获该数据. 我正在做下面的 qry 但不确定这是否正确。

```
select *
from
    (
    select 
   oreg.ora_warranty_id,
   mdh.warranty_sku_num
    from
     mdhdba.m_warranty_sku mdh
         , xx_new.xx_online_registrations@appsread.prd.com oreg
    where
   mdh.warranty_sku_num= oreg.ora_warranty_id(+) -----ora_warranty_id from  xx_new.xx_online_registration table
   )
where ora_warranty_id is  null -- oreg.ora_warranty_id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:28:17.800

希望这可以帮助，

```
 select *
from
    (
    select 
   oreg.ora_warranty_id,
   mdh.warranty_sku_num
    from
     mdhdba.m_warranty_sku mdh
         , xx_new.xx_online_registrations@appsread.prd.com oreg
    where
   oreg.ora_warranty_id = mdh.warranty_sku_num(+) -----ora_warranty_id from  xx_new.xx_online_registration table
   )
where ora_warranty_id is  null -- oreg.ora_warranty_id 
```

# visual-studio - Visual Studio - 优化 - 删除未使用的函数

> ID：13954408
> 
> 赞同：2
> 
> 时间：2012-12-19T14:23:18.407
> 
> 标签：visual-studio, assembly

我在 Visual Studio 2012 上使用 /opt:ref /VERBOSE 选项，除了激活“整个程序优化 - >使用链接时间代码生成”。/opt:ref 应该删除未使用的函数，尽管我的印象是指定“使用链接时间代码生成”应该默认删除未使用的函数。

在我的测试程序中，我使用了一个我希望从最终可执行文件中删除的测试函数，并且 VS 输出似乎证实了这一点：

```
Discarded "int __cdecl testMe(int)" (?testMe@@YAHH@Z) from Test.obj 
```

但是查看使用 /FAs 生成的 *.asm 文件，我可以看到列出的函数：

```
; Function compile flags: /Ogtp
; File c:\users\g.m\documents\visual studio 2012\projects\Test.cpp
;   COMDAT ?testMe@@YAHH@Z
_TEXT   SEGMENT
?testMe@@YAHH@Z PROC                    ; testMe, COMDAT
 ... 
```

那么，它是否从最终图像中删除？

**编辑：**

要优化的琐碎代码

```
static int testMe(int i)
{
    return i + 1;
}

int main()
{
  auto res = testMe(0);
} 
```

我发现非常可疑的是，即使功能是“静态的”，它仍然出现在 *.asm 文件中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:09:26.673

这里似乎发生的是，编译器在生成程序集时还没有完全优化函数（尽管您没有发布完整列表，也没有发布原始函数，所以很难确定），但是链接器能够看到它未被引用，并已将其丢弃。

链接发生在程序集生成之后，因此链接器所做的任何事情都不会由中间程序集输出指示。

您只能通过查看最终的可执行文件才能确定，但​​我怀疑链接器说的是实话，并且已经删除了您的函数。

更新：

在本地测试您的代码证实了我的怀疑。编译器不会优化死代码，但链接器会优化。

# vb.net - 水晶报表无法连接数据库

> ID：13954412
> 
> 赞同：0
> 
> 时间：2012-12-19T14:23:38.907
> 
> 标签：vb.net, visual-studio-2010, crystal-reports, database-connection

我正在使用 Visual Studio 在 VB.net 中创建一个程序，并且某些表单使用 Crystal Reports 来显示 PDF 报告，但我遇到了数据库连接问题。VB.net 代码可以毫无问题地访问数据库，但是当表单显示报告时，它会要求我输入用户名和密码，如果我编写它们，则无法连接。应用程序和报表共享同一个数据库，我使用相同的数据进行连接，但 Crystal Reports 失败。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:43:54.493

这是我拥有的一个片段（在 C# 中，但应该让您了解我是如何做到的）：

```
 CrystalReportSource CrystalReportSource1 = new CrystalReportSource();
    CrystalReportViewer CrystalReportViewer1 = new CrystalReportViewer();

    CrystalReportViewer1.ReportSource = CrystalReportSource1;
    CrystalReportViewer1.EnableParameterPrompt = false;
    CrystalReportSource1.Report.FileName = "Report3.rpt";
    CrystalReportSource1.EnableCaching = false;

    CrystalReportSource1.ReportDocument.SetParameterValue(0, ponumber);
    CrystalReportSource1.ReportDocument.SetParameterValue(1, receiptno);

    TableLogOnInfo logOnInfo = new TableLogOnInfo();

    logOnInfo.ConnectionInfo.ServerName = ConfigurationManager.AppSettings["WarehouseReportServerName"];
    logOnInfo.ConnectionInfo.DatabaseName = ConfigurationManager.AppSettings["WarehouseReportDatabaseName"];
    logOnInfo.ConnectionInfo.UserID = ConfigurationManager.AppSettings["WarehouseReportUserID"];
    logOnInfo.ConnectionInfo.Password = ConfigurationManager.AppSettings["WarehouseReportPassword"];

    TableLogOnInfos infos = new TableLogOnInfos();
    infos.Add(logOnInfo);
    CrystalReportViewer1.LogOnInfo = infos;

    maindiv.Controls.Add(CrystalReportSource1);
    maindiv.Controls.Add(CrystalReportViewer1);

    CrystalReportViewer1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:46:50.977

尽管您说您正在使用设计器，但我会发布一些对我有用的代码，也许它会对您有所帮助：

```
 Dim cryRpt As New ReportDocument
       Dim strReportPath As String = 'The Path of the rpt file
       cryRpt.Load(strReportPath)
       cryRpt.SetDataSource(Me.crData) 'crData is a datatable with data for the report

       crvReport.ReportSource = cryRpt 'crvReport is the CrystalReportViewer in my form 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-14T19:51:38.160

在“SetDataSource”中设置时检查数据中是否存在所有字段

# java - 无法使用java连接云上的mongo

> ID：13954420
> 
> 赞同：1
> 
> 时间：2012-12-19T14:23:52.513
> 
> 标签：java, mongodb, cloud, jelastic

我在jelastic上部署了我的java web应用程序。我在jelastic上为glassfish和mongodb创建了一个节点。我无法连接到部署在代码上的数据库。

我使用以下方式连接到数据库-

```
 Mongo mongo = new Mongo("http://arpitsolanki.jelastic.servint.net/", 27017); 
```

但它会引发数字格式异常

```
 java.lang.NumberFormatException: For input string: "//arpitsolanki.jelastic.servint.net/" 
```

连接数据库的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-19T05:56:01.703

我已经使用 Mongo Client 进行连接，它对我来说很好用

```
// import com.mongodb.MongoClient;
// import com.mongodb.DBObject;

   MongoClient mongoClient = new MongoClient("URL", PORT);
   DB db = mongoClient.getDB("dbName");
   boolean auth = db.authenticate("username", password.toCharArray()); 
```

# arrays - Matlab中字符串的动态格式化

> ID：13954424
> 
> 赞同：5
> 
> 时间：2012-12-19T14:24:05.940
> 
> 标签：arrays, matlab, printf

我正在尝试编写一个 Matlab 程序，该程序从用户那里获取要显示的行数的输入，并相应地打印如下内容：

```
1
2 2
3 3 3 
```

.. 很快

现在我可以使用两个 for 循环来获得这个输出，但是是否可以用一个 for 循环来做同样的事情？具体来说，我想知道是否有一种方法可以将 for 循环的迭代值传递给 sprintf/fprintf 语句，以类似于 '%3d' 的方式格式化字符串，以便 sprintf/fprintf 语句知道每行要打印多少个变量。希望那不是太混乱。

谢谢！

山塔努。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:45:44.817

您可以简单地创建一个数组，每次传递到适当的大小，如下所示：

```
fid=1; % Will print out to the stdout, but can replace this with the folder to write to
for x=1:3
   stuff=zeros(x,1)+x;
   fprintf(fid,'%s ',stuff)
   fprintf(fid,'\n');
end 
```

请注意，如果将数组传递给`fprintf`语句，它将简单地重复它，直到数组完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:47:52.953

尝试`sprintf`功能，[这里](http://www.weizmann.ac.il/matlab/techdoc/ref/sprintf.html)是文档。比你做的事情：

```
sprintf('something %[flag][width].[precision][conversion] %...', arg1, ...) 
```

对于整数小数，你可以这样做：

```
sprintf('%d', integer) 
```

# android - 如何使用android创建圆形图像？

> ID：13954428
> 
> 赞同：4
> 
> 时间：2012-12-19T14:24:24.887
> 
> 标签：android

我有四张图像。

在这里，我附上了一张示例图片。

![在此处输入图像描述](../Images/109c7a63eb40d90397f2f05dc06ff831.png)

如何使用这些类型的图像创建圆形图像？

哪种布局最适合为 android 创建 UI？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:37:58.780

are you talking about something like this.. [http://www.baijs.nl/tinycircleslider/](http://www.baijs.nl/tinycircleslider/)

And for designing the UI for Android is depends on our requirement.it means whether you want to design something looks like rows and columns then GridLayout and tableLayout will be better,depends on requirement and look the layout will changes once try it your self and choose the best suited for your applicaiton.All the best Mate

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:40:14.150

在相对布局中添加四个图像视图，其属性为 ParentTop、ParentRight、ParentBottom 和 ParentLeft。每个图像都是带有透明额外区域的矩形。我可以理解在第一次尝试时很难想象。

现在来点击区域。所以关于忽略透明区域点击的运行时决定将是正确的。

更棘手的方法是管理所有侦听器的标志，如果两个侦听器调用其透明区域。

# ruby-on-rails-3 - 是否可以在 current_user 上调用 (:subdomain => false )？

> ID：13954429
> 
> 赞同：0
> 
> 时间：2012-12-19T14:24:26.847
> 
> 标签：ruby-on-rails-3, routing, subdomain

在我的标题中，我有这个：

```
<%= link_to "My profile", current_user %> 
```

反正有没有调用 (:subdomain => false) 或类似的东西，所以它会在子域中转义？我正在使用设计。

它在这些情况下完美运行：

```
<%= link_to 'About', about_url(:subdomain => false) %> 
```

但是因为它没有“_path”或“_url”，所以我不断收到“错误数量的参数 1 for 0”错误。

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:14:25.720

您可以`link_to`使用`user_url(current_user)`助手而不是`current_user`快捷方式进行调用。

我想这会起作用：

`<%= link_to "My profile", user_url(current_user, :subdomain => false) %>`.

# java - 我正在使用 URL 来获取适用于 Android 的 Google 地图的位置搜索 - URL 类型来自 API v2 或 v3

> ID：13954432
> 
> 赞同：1
> 
> 时间：2012-12-19T14:24:41.570
> 
> 标签：java, json, google-maps, url, android-2.3-gingerbread

我正在使用 Google Maps API 级别 10 开发 2.3.3。

我使用下面的代码来获取 USER 输入的位置。

我使用的 URL 属于 Google MAPs API v2 或 v3。

```
public static JSONObject getLocationInfo(String address)
{
    HttpGet httpGet = new HttpGet("http://maps.google.com/maps/api/geocode/json?address="
                                  + address
                                  + "ka&sensor=false");
    HttpClient client = new DefaultHttpClient();
    HttpResponse response;
    StringBuilder stringBuilder = new StringBuilder();

    try
    {
        response = client.execute(httpGet);
        HttpEntity entity = response.getEntity();
        InputStream stream = entity.getContent();
        int b;
        while ((b = stream.read()) != -1)
        {
            stringBuilder.append((char) b);
        }
    }
    catch (ClientProtocolException e)
    {
    }
    catch (IOException e)
    {
    }

    JSONObject jsonObject = new JSONObject();
    try
    {
        jsonObject = new JSONObject(stringBuilder.toString());
    }
    catch (JSONException e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return jsonObject;
} 
```

执行此操作后，另一个方法将该 JSONObject 转换为 GeoPoint。

```
public static GeoPoint getGeoPoint(JSONObject jsonObject)
{
    Double lon = new Double(0);
    Double lat = new Double(0);

    try
    {
        lon = ((JSONArray)jsonObject.get("results")).getJSONObject(0)
              .getJSONObject("geometry").getJSONObject("location")
              .getDouble("lng");

        lat = ((JSONArray)jsonObject.get("results")).getJSONObject(0)
              .getJSONObject("geometry").getJSONObject("location")
              .getDouble("lat");
    }
    catch (JSONException e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return new GeoPoint((int) (lat * 1E6), (int) (lon * 1E6));
} 
```

使用上面的代码 - 我无法通过 PIN 码搜索获得位置。如何通过 PIN 码搜索获得位置？

# java - 为什么读取用户输入的内容后套接字不关闭？

> ID：13954439
> 
> 赞同：0
> 
> 时间：2012-12-19T14:25:11.533
> 
> 标签：java, multithreading, sockets

我在聊天应用程序的服务器中使用以下代码，其中我为每个客户端使用单独的线程。 **代码：**

```
public void run()
{
String msg;
InputStreamReader isReader = new InputStreamReader(sock.getInputStream())
BufferReader r= new BufferedReader(isReader);
int i=0,j=0;
System.out.print("entered run again"+i++);
try{
             while((msg=r.readLine())!=null)
    {
        System.out.println("readed"+msg );

            spreadMsg(msg);

    }

    }catch(Exception e){e.printStackTrace();}

 }

} 
```

为什么 while 循环 **"while((msg=r.readLine())!=null)"**表现为无限循环，为什么它在读取我输入的唯一行后没有返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:31:49.070

在客户端关闭套接字之前，返回的流`Socket.getInputStream()`不会返回 null。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:42:31.290

> 为什么 while 循环 "while((msg=r.readLine())!=null)" 表现为无限循环，为什么它在读取我输入的唯一行后没有返回。

另一端没有关闭连接，所以读者不知道你只会发送一行。

如果您想假设只发送一行，您可以自己关闭连接而不是循环。

# math - 在 equirectangular 纹理上将屏幕点转换为点

> ID：13954441
> 
> 赞同：1
> 
> 时间：2012-12-19T14:25:16.917
> 
> 标签：math, 3d, three.js

我有一个应用到球体内部的全景图的 equirectangular 纹理。摄像头放置在球体的中心，用户可以通过单击并拖动鼠标来旋转摄像头以环顾四周。但是，当用户单击而不拖动时，我希望能够将屏幕坐标转换为纹理上的坐标。给定用户单击的世界坐标位置，我可以确定纹理上的位置，但查看 Three.js 文档我无法辨别我将如何处理这个问题。

最终，问题是我将如何构建一个射线查询来获取来自给定屏幕点的射线与纹理球体之间的交点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:10:17.187

在three.js 示例目录中有很多这样的示例。例如，[http](http://mrdoob.github.com/three.js/examples/canvas_interactive_cubes.html) ://mrdoob.github.com/three.js/examples/canvas_interactive_cubes.html 。

你想用谷歌搜索的模式是这样的：

```
var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );

projector.unprojectVector( vector, camera );

var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );

var intersects = ray.intersectObjects( objects );
if ( intersects.length > 0 ) {
    console.log( intersects[ 0 ].point );
} 
```

如果画布是完整的浏览器，这将起作用。另外，`objects`是一个数组。

三.js r.53

# jquery - 使用 jQuery 的 prop 方法时，如何使用 Capybara 测试表单元素是否被禁用？

> ID：13954443
> 
> 赞同：7
> 
> 时间：2012-12-19T14:25:17.087
> 
> 标签：jquery, ruby, ruby-on-rails-3, capybara, testunit

在我的 Rails 3 应用程序中，我一直在使用 jQuery 的 attr() 方法来执行以下操作：

```
$('#application_dust_type_id').attr('disabled', 'disabled'); 
```

我会使用 Test/Unit、capybara 和 capybara-webkit 来测试：

```
assert page.has_selector? 'select[id=application_dust_type_id][disabled=disabled]' 
```

现在，我正在尝试切换到使用 prop 方法，正如 jQuery 建议的那样：

```
$('#application_dust_type_id').prop('disabled', true) 
```

但是现在上面的断言失败了，即使 javascript 在浏览器中仍然可以正常工作。

如何使用水豚基于元素的属性（而不是属性）做出断言？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:27:51.083

尝试只检查属性的存在，`disabled`因为这是禁用输入真正需要的全部：

```
assert page.has_selector? 'select[id=application_dust_type_id][disabled]' 
```

请注意，`disabled`属性的值是没有实际意义的。您可以设置`disabled="false"`or`disabled="foobar"`并且该元素将被呈现为禁用。

# eclipse - Eclipse 在更正 HTML 代码的缩进期间将标签的每个属性设置在新行中 - 如何停止它？

> ID：13954444
> 
> 赞同：2
> 
> 时间：2012-12-19T14:25:23.760
> 
> 标签：eclipse

Eclipse 在更正 HTML 代码的缩进（格式化活动元素 [CTRL + I]）期间将标签的每个属性设置在新行上 - 如何停止它？

在首选项中“在新行上拆分多个属性”未选中

# java - Eclipse - 将排除的 java 文件返回到构建路径

> ID：13954446
> 
> 赞同：2
> 
> 时间：2012-12-19T14:25:30.500
> 
> 标签：java, eclipse, classpath, buildpath

通过***右键单击文件 > 构建路径 > 排除从******构建路径***中排除java 文件后，我想将此文件返回到构建路径。

 *我得到的唯一方法是编辑`.classpath`文件并从属性中省略所需的文件`excluding`，然后进行刷新。

还有其他更好的方法吗？

我使用**版本：Indigo Service Release 2**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:27:03.390

您可以右键单击项目并使用菜单选项：

```
Build Path->Configure Build Path->[Source Tab] 
```

从“排除”部分选择排除的文件，然后单击*删除*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:56:09.017

右键单击您的项目并选择`Buildpath -> Configure Buildpath`并选择`Source`选项卡。打开包含排除文件的源文件夹，在它下面，您应该在排除区域中看到被排除的文件，只需使用`Remove`选项将其删除。看图片![在此处输入图像描述](../Images/3b1bba7c77d4a8114a779d1a8bcde801.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:57:17.333

您可以在项目的构建路径选项中删除排除条目。

```
Project -> Properties -> Java Build Path -> Source 
```*

# java - 以并发方式逐行处理文件

> ID：13954452
> 
> 赞同：6
> 
> 时间：2012-12-19T14:25:44.227
> 
> 标签：java, concurrency, java.util.concurrent

现在我正在从事有关数据格式转换的工作。有一个大文件，比如 10GB，我目前实现的解决方案是逐行读取这个文件，转换每一行的格式，然后输出到一个输出文件。我发现转换过程是一个瓶颈。所以我试图以并发的方式做到这一点。

每一行都是一个完整的单元，与其他行无关。有些行可能会被丢弃，因为该行中的某些特定值不符合需求。

现在我有两个计划：

1.  一个线程从输入文件中逐行读取数据，然后将行放入队列，几个线程从队列中获取行，转换格式，然后将行放入输出队列，最后一个输出线程从输出队列中读取行并写入输出文件。

2.  几个线程当前从输入文件的不同部分读取数据，然后处理该行并通过输出队列或文件锁输出到文件。

你们能给我一些建议吗？对此，我真的非常感激。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:28:33.390

我会选择第一个选项...从小块文件中读取数据通常比一次读取整个文件要慢（取决于文件缓存/缓冲/预读等）。

您可能还需要考虑一种创建输出文件的方法（从不同进程获取所有行，如果需要，可能按正确的顺序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:37:27.863

Solution 1 makes sense.

This would also map nicely and simply to Java's [Executor framework](http://docs.oracle.com/javase/tutorial/essential/concurrency/executors.html). Your main thread reads lines and submits each line to an Executor or ExecutorService.

It gets more complicated if you must keep order intact, though.

# java - while(rs.next()) 是否比一系列 rs.absolute() 快

> ID：13954465
> 
> 赞同：9
> 
> 时间：2012-12-19T14:26:20.610
> 
> 标签：java, jdbc, benchmarking

假设有一个`ResultSet rs`with`n`对象。

这段代码：

```
while(rs.next()) {
   // do something on rs
} 
```

在算法上等于此代码（即两者都给出相同的结果）：

```
for(i=1; i<=n; i++) {
   rs.absolute(i)
   // do something on rs
} 
```

但这在通篇上是等价的吗？第一个更快吗？或者，对于给定`i`的 rs.next() 只是`rs.absolute(i+1)`?

最好的问候 MC

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T14:31:27.010

`rs.next`需要一种更简单的数据库游标 ( `FORWARD_ONLY`)，`rs.absolute`因此在大多数情况下，您将降低性能/资源效率`rs.absolute`。在某些情况下，无论如何都没有对`FORWARD_ONLY`游标进行优化，您可能会获得相同的性能。

一些驱动程序甚至可能允许`absolute`调用`FORWARD_ONLY`，验证请求的记录是下一个记录，但其他驱动程序可能再次抛出异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:33:45.997

前者`rs.next()`可能更快，尽管它取决于底层实现，实际上由于内部优化，您可能会获得相同的性能。

驾驶员在这样做时可能没有考虑当前位置`rs.absolute()`，它可能有一点点开销，而`rs.next()`只是向前移动。

因此，如果您需要遍历所有结果，只需使用`rs.next()`，如果您需要跳到特定结果，请使用`rs.absolute()`.

请记住，结果集实际上通常由数据库远程处理（除非它是 a `CachedResultSet`），因此来回处理可能比您想象的要多。

# ruby-on-rails - 使用数组的简单路由

> ID：13954466
> 
> 赞同：2
> 
> 时间：2012-12-19T14:26:24.983
> 
> 标签：ruby-on-rails, rails-routing

因此，如果我想要一个编辑链接，我可以执行以下任一操作：

```
link_to 'Edit', edit_user_task_path(@user, @task)
link_to 'Edit', [:edit, @user, @task] 
```

但是，如果我想删除一个，我必须这样做：

```
link_to 'Delete', [@user, @task], method: :delete 
```

是否可以让rails理解以下内容？

```
link_to 'Delete', [:delete, @user, @task] 
```

似乎它试图去“delete_user_task_path”，是否有一个较短的删除形式，就像有编辑一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:33:50.450

您必须了解的是 link_to 方法的数组参数不会触及请求方法（据我所知）。

因此，您的建议实际上会向 /user/:id/delete 之类的东西发出 GET 请求。

你可以用类似的东西来实现这一点

```
resources :user do
  get :delete, on: :member
end 
```

但这不是很 RESTful，我不会推荐它。

# c++ - 图像不失真后如何找到特征的新位置？

> ID：13954467
> 
> 赞同：4
> 
> 时间：2012-12-19T14:26:24.133
> 
> 标签：c++, opencv, camera

我有一个带有圆圈的图像，我使用 openCV 方法来检测它并在图像被校正和不失真之前在图像上显示它的边缘和中心。

我使用 OpenCV 中的 InitUndistortRectifyMap 校正图像并使其不失真。重新映射后，由于视角的变化，图像发生了翘曲，圆圈呈椭圆形。中心的位置坐标也明显改变。

校正后无法进行圆检测步骤，因为由于视角变化，这会产生不准确的结果。

我的问题是，如何在图像未失真和校正后找到中心的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:58:06.743

有一个[undistortPoints](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#undistortpoints)函数可以转换 Point2f 或 Point2d 的向量。

# oracle - 将字符串与触发器中的列连接起来

> ID：13954471
> 
> 赞同：1
> 
> 时间：2012-12-19T14:26:34.680
> 
> 标签：oracle, triggers

我有一个名为 TBL_CAS 的表。其中，FLD_ID 作为自增列，另一列称为 FLD_CAS_CODE。现在我需要将`CAS-`前缀添加到 FLD_ID 并插入到 FLD_CAS_CODE。我需要在触发器中执行此操作。我尝试使用下面的代码，但是没有插入数据，这是什么问题？

```
CREATE OR REPLACE TRIGGER TBL_CAS_TRG
BEFORE  INSERT ON TBL_CAS
FOR EACH ROW
BEGIN
:NEW.FLD_CAS_CODE := TO_CHAR ('CAS')||'-'||:NEW.FLD_ID;
END; 
```

我的意思是`"cas-"+"fld_id"="cas-fld_id"'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:36:17.047

您不需要将 TO_CHAR() 放在已经是字符数据类型的东西周围。但是您应该转换数字标识符（而不是依赖隐式转换）：

```
:NEW.FLD_CAS_CODE := 'CAS-'||TRIM(TO_CHAR (:NEW.FLD_ID)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:34:31.260

哪个部分不完全工作？因为你的触发器似乎工作得很好。

```
SQL> create table TBL_CAS( FLD_ID number, FLD_CAS_CODE varchar2(20));

Table created.

SQL> CREATE OR REPLACE TRIGGER TBL_CAS_TRG
  2  BEFORE  INSERT ON TBL_CAS
  3  FOR EACH ROW
  4  BEGIN
  5  :NEW.FLD_CAS_CODE := TO_CHAR ('CAS')||'-'||:NEW.FLD_ID;
  6  END;
  7  /

Trigger created.

SQL> insert into TBL_CAS (fld_id) values (1001);

1 row created.

SQL> select * From TBL_CAS;

    FLD_ID FLD_CAS_CODE
---------- --------------------
      1001 CAS-1001

SQL> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-05T13:56:40.437

这也可以正常工作：

```
CREATE OR REPLACE TRIGGER  TBL_AREA_CODES_TRG 
BEFORE  INSERT ON   TBL_AREA_CODES
FOR EACH ROW
BEGIN
  :NEW.OBRM_AREA_CODE :=  :NEW.STATE_CODE ||'-'||:NEW.DIST_CODE ||'-'||:NEW.CITY_CODE ||'-'||:NEW.AREA_CODE ;
END; 
```

# c# - 在在线用户上方的聊天窗口中实现 facebook 类型通知

> ID：13954477
> 
> 赞同：-3
> 
> 时间：2012-12-19T14:27:03.120
> 
> 标签：c#, asp.net, sql-server-2008

我的网站（asp.net C#）中有一个管理部分，用户应该在其中收到有关 Db 上发生的各种操作（如插入更新等）的通知。

我想在特定用户执行添加新数据之类的操作时收到通知。

如何在 SQL Server 2008 中实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:31:34.150

在 SQL 中，您可以拥有在更改时运行的触发器，但在此之外，您正在查看轮询（使用服务或网站本身缓存最后一条记录的索引并查看是否已插入另一个 id）。

一些如何存储表的“最后插入的 id”然后检查（假设一个 INT 键）：

```
SELECT *
FROM   table
WHERE  id > @LastObservedIndex; 
```

这将返回您上次检查时的任何新条目。然后，当然，如果找到新条目，您将需要更新缓存的 id，以便下一次调用检查更多新条目。

不过，我确实建议您将此作为服务或计划任务；也就是说，您不希望每个管理员在每次访问页面时都进行查询检查新条目。然后，您可以将事件存储在消息队列中，并在用户访问页面时将新通知转储（或使用 AJAX 进行轮询）。

或者，如果您正在处理所有 CRUD 操作（您的站点正在进行任何和所有更新，并且不与其他一些外部进程一起工作），您可以将日志记录/跟踪代码放在您的存储库中。例如：

```
public class MessageRepository : IMessageRepository<Message>
{
  //
  // ...
  //

  void Add(Message message)
  {
    //
    // add to database code
    //

    // some logging utility that's tracking transactions against specific
    // database elements and reporting them back to some notification log
    // that can then be output to the admin
    this.LogTransaction<Message>(message, TransactionType.Create); 
  }
} 
```

但是，这当然也有其自身的开销。

# hibernate - 如何通过 Hibernate 中子项的 ID-s 删除项？

> ID：13954478
> 
> 赞同：8
> 
> 时间：2012-12-19T14:27:04.217
> 
> 标签：hibernate, jpa, jpql

我正在尝试编写一个 JPQL 查询，该查询将删除所有通过ID `PlaylistItem`引用特定`ArtContent`-s 的 -s 。`ArtContent`

我试过这个：

```
public int deleteItemsByContentIds(Long[] contentIds) {
    EntityManager em = getEntityManager();
    int result = em.createQuery(
    "delete from PlaylistItem where artContent.id in (:idsArray) ")
    .setParameter("idsArray", contentIds).executeUpdate();

    return result;
} 
```

但它会引发异常：

```
Servlet.service() for servlet RemoveContentServlet threw exception: 
javax.ejb.EJBException: java.lang.IllegalArgumentException: 
Encountered array-valued parameter binding, but was expecting [java.lang.Long] 
```

这是可以理解的，因为没有`setParameter`将数组作为参数的方法。那么解决此类问题的最佳方法是什么？

简化的类定义：

```
@Entity
public class PlaylistItem implements Serializable {

@Id
@GeneratedValue
private Long id;

private int position;

@ManyToOne(optional = false)
@JoinColumn(name = "PLAYLIST_ID")
private Playlist playlist;

@ManyToOne(optional = false)
@JoinColumn(name = "ART_CONTENT_ID")
private ArtContent artContent;

... 
```

}

```
@Entity
public class ArtContent implements Serializable {

@Id
@GeneratedValue
private Long id;
...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T15:06:01.483

您可以继续使用`.setParameter`，但您需要使值扩展集合（如 ArrayList），而不是使用数组类型。也许只是更改为：

```
public int deleteItemsByContentIds(Long[] contentIds) {
    EntityManager em = getEntityManager();
    int result = em.createQuery(
    "delete from PlaylistItem where artContent.id in (:idsArray) ")
    .setParameter("idsArray", Arrays.asList(contentIds)).executeUpdate();

    return result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:00:56.740

试试`setParameterList`吧。

编辑：

抱歉，对于 JPA，将其转换为 Collection ( `Arrays.asList(arrayOfLongs)`) 并使用`setParameter`.

编辑2：被打败了！

# datetime - 无法在 Gnuplot 中使用日期/时间字段绘制烛台数据

> ID：13954480
> 
> 赞同：3
> 
> 时间：2012-12-19T14:27:14.450
> 
> 标签：datetime, gnuplot, candlestick-chart

说这令人沮丧是客气的。我的示例数据如下所示：

```
2012-04-30 20:00,1.32412,1.32412,1.32376,1.3239
2012-04-30 20:15,1.3239,1.32416,1.32378,1.32388
2012-04-30 20:30,1.32388,1.3241,1.32388,1.324
2012-04-30 20:45,1.324,1.32405,1.32385,1.32385
... 
```

字段在哪里：

```
Date/Time,Open,High,Low,Close 
```

我的 Gnuplot 脚本很简单：

```
set xdata time
set timefmt "%y-%m-%d %H:%M"
set format x "%m/%d\n%H:%M"
set xrange ["2012-05-01 00:00":"2012-05-01 08:00"]
set yrange [*:*]
set grid
set key left
set datafile separator ","
plot 'data.csv' using 1:2:4:3:5 notitle with candlesticks 
```

如您所见，我正在调整列数据以匹配烛台图预期的顺序。我的数据范围从 2012 年 4 月 30 日到 2012 年 5 月 31 日，所以我只是尝试绘制 8 小时的数据开始。我试图将 xrange 设置为`[*:*]`，但这只会导致事情变得更糟。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:00:33.747

所以问题出在该`timefmt`部分。由于我使用的是 4 位数年份，因此我需要使用`%Y`而不是`%y`，即大小写很重要。希望这将为遇到这种奇怪情况的其他人澄清问题。

# android - 账户认证服务未注册

> ID：13954485
> 
> 赞同：3
> 
> 时间：2012-12-19T14:27:27.290
> 
> 标签：android

我有以下帐户身份验证类

```
public class AppAuthenticator extends AbstractAccountAuthenticator {

private Context mContext;

public AppAuthenticator(Context context) {
    super(context);
    mContext = context;
}

//This is used by the login activity when the guy logs in after starting the app
public Bundle addAccount(AccountAuthenticatorResponse response, String accountType, String authTokenType, 
        String[] requiredFeatures, Bundle options)
        throws NetworkErrorException {
        //...Code Here...
    }

} 
```

和

```
public class AuthenticationService extends Service {

private static AppAuthenticator sAuthenticator = null;

public AuthenticationService() {
    super();
}

@Override
public IBinder onBind(Intent intent) {
    IBinder res = null;
    if (intent.getAction().equals(android.accounts.AccountManager.ACTION_AUTHENTICATOR_INTENT))
        res = getAuthenticator().getIBinder();
    return res;
}

private AppAuthenticator getAuthenticator() {
    if (sAuthenticator == null)
        sAuthenticator = new AppAuthenticator(this);
    return sAuthenticator;
}
} 
```

和清单：xml/authenticator.xml

```
<account-authenticator 
    xmlns:android="http://schems.android.com/apk/res/android"
    android:accountType="@string/account_type" 
    android:label="@string/app_name" 
    android:icon="@drawable/benchcap" /> 
```

androidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.app.app"
    android:versionCode="1"
    android:versionName="1.0" >

<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.MANAGE_ACCOUNTS" />
<uses-permission android:name="android.permission.AUTHENTICATE_ACCOUNTS" />

<application
    android:name="com.app.app.AppApplication"
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <service android:name=".AuthenticationService"
        android:exported="true" android:process=":auth">
        <intent-filter>
            <action android:name="android.accounts.AccountAuthenticator" />
        </intent-filter>

        <meta-data
            android:name="android.accounts.AccountAuthenticator"
            android:resource="@xml/authenticator" />
    </service>
</application> 
```

`@string/app_name="App"`和_`@string/account_type="com.app.app"`

所以问题是安装应用程序时我得到

```
"Unable to load service info ResolveInfo{40f00c40 com.app.app.AuthenticationService p=0 m=0x108000}
 Loaded meta-data for 0 account types, 0 accounts in 4ms(wall) 2ms(cpu)" 
```

并且我尝试添加帐户我得到 SecurityException "Caller UID is different than the authenticationator UID" （这里描述：[SecurityException: caller uid XXXX is different than the authenticationator's uid](https://stackoverflow.com/questions/3774282/securityexception-caller-uid-xxxx-is-different-than-the-authenticators-uid)）。这是有道理的，因为该服务未注册。

系统提供的信息仅此而已。

需要添加什么才能正确注册身份验证服务？

# git - 重置远程跟踪分支

> ID：13954486
> 
> 赞同：11
> 
> 时间：2012-12-19T14:27:28.207
> 
> 标签：git

如何将远程跟踪分支的分支指针重置为其先前的提交之一，所以看起来我没有拉（类似于本地分支的硬重置）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T14:31:26.387

您可以使用以下命令设置对任何其他提交的引用：

```
git update-ref refs/remotes/origin/master <commit-sha1 or tag> 
```

这将使远程分支`origin/master`指向您指定的提交。

# c++ - 在父窗口所在的屏幕上显示子窗口

> ID：13954488
> 
> 赞同：2
> 
> 时间：2012-12-19T14:27:32.793
> 
> 标签：c++, mfc, childwindow

C++ 我有一个可以从主窗口启动的模态子窗口。该应用程序在 Citrix 服务器上运行，当用户使用双显示器时，她可以将子窗口拖到辅助显示器上，Windows 会以某种方式保存这个位置。当她移动到具有单个显示器的工作站时，她抱怨应用程序冻结，而实际上子窗口不在屏幕上，并且可以通过一些组合键将其带到主显示器。有没有办法以编程方式强制子窗口始终在父窗口所在的屏幕上打开？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:34:07.920

您可以尝试调用[`CWnd::CenterWindow`](http://msdn.microsoft.com/en-us/library/1a3x359y%28v=vs.80%29.aspx)which 只会将窗口定位在主监视器的中心（通常在父窗口上方）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T18:49:57.230

您应该覆盖[PreCreateWindow并修改](http://msdn.microsoft.com/en-us/library/4yc5skce.aspx "CWnd::PreCreateWindow")[CREATESTRUCT](http://msdn.microsoft.com/en-us/library/9930zz74.aspx "创造结构")中的相应条目以强制窗口进入可见区域。可以在[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162827.aspx "在多个显示器上定位对象")（“在多个显示监视器上定位对象”）中找到定位窗口的指南。

# javascript - 如何使用 d3.js 创建水平图例

> ID：13954489
> 
> 赞同：5
> 
> 时间：2012-12-19T14:27:32.530
> 
> 标签：javascript, d3.js

我一直在尝试使用 d3.js 为我的图表创建一个水平图例。我一直在努力使用动态标签使 x 轴间距正确。

问题是标签的宽度不一致，这是一个[完整的例子](http://bl.ocks.org/4336932)，这是我计算 x 位置的函数：

```
function legendXPosition(data, position, avgFontWidth){
    if(position == 0){
        return 0;
    } else {
        var xPostiion = 0;
        for(i = 0; i < position; i++){
            xPostiion += (data[i].length * avgFontWidth);
        }
        return xPostiion;
    }
} 
```

有人对如何改善这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T15:33:52.897

我建议参考这个问题：[SVG get text element width](https://stackoverflow.com/questions/1636842/svg-text-element-width)

像你现在一样渲染第一个图例条目。存储此条目，或分配 ID，以便您可以通过选择查找它们。

渲染后续条目时，获取前一个“文本”元素和 x 偏移量。使用前一个文本元素的确切宽度计算新的图例条目偏移量

```
var myNewXOffset = myPreviousXOffset + myPreviousText.getBBox().width 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-08T18:45:32.327

修改代码以获得以下结果 [![在此处输入图像描述](../Images/c13180a2fe95ca1f79ca0d420817f30f.png)](https://i.stack.imgur.com/j52JE.png) 标签宽度不一致的原因是由于两个因素。它们都与您计算 x 位置的函数有关：

1) avgFontWidth 参数

它应该更小。`15`您在[示例](http://bl.ocks.org/martinffx/4336932)中为其分配了 的值，但实际的 averageFontWidth 比 小得多`15`，它介于`5`to之间`7`。您的图例标签之间的额外空间来自这个不准确的平均字体宽度值。

你`avgFontWidth`的只是一个平均值。实际上，字体宽度会发生变化。例如，下`r`图中的 比`P`. [![在此处输入图像描述](../Images/70ea333b75f3ae5e8d48b0a4e88ccb6c.png)](https://i.stack.imgur.com/Xhnhx.png) 因此，五个字母的单词`rrrrr`可能比`PPPPP`以某种方式设置字体系列时要短得多。总之，您不应使用`avgFontWidth`. 您应该 按照**cmonkey 的**建议使用**[SVG 获取文本元素宽度](https://stackoverflow.com/questions/1636842/svg-get-text-element-width)**

 **2）上面公式的逻辑是`xPostiion += (data[i].length * avgFontWidth)` 要计算文字的长度，但是标签的宽度也要加上，`xPostiion`应该是

`xPostiion += (data[i].length * avgFontWidth) + widthOftheLabel`

修改后的代码：

```
<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis text {
  padding-top: 5px;
  text-anchor: "right";
}

.line {
  fill: none;
  stroke-width: 1.5px;
}

.y.axis line,
.y.axis path {
  stroke-dasharray: 2,2;
}
</style>
<body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.js"></script>
<script type="text/javascript" src="javascripts/psgam-d3-graphs.js"></script>
<script type="text/javascript"> 
  function drawlinegraph(data, startDateString, endDateString, maxValue, minValue, colour,
                       divID, labels) {
    var m = {top: 60, right: 0, bottom: 35, left: 80},
        w = 770 - m.left - m.right,
        h = 180 - m.top - m.bottom,
        dateFormat = "%Y-%m-%d";

    labels = ["ada", "adas", "asdasdasd", "sd"];

    var parseDate = d3.time.format(dateFormat).parse;

    var startDate = parseDate(startDateString);
    var endDate = parseDate(endDateString);

    // Define the x scale
    var x = d3.time.scale()
            .domain([startDate, endDate])
            .range([0, w]);

    // Format x-axis labels
    x.tickFormat(d3.time.format(dateFormat));

    // Define the y scale
    var y = d3.scale.linear()
            .domain([minValue, maxValue])
            .range([h, 0]);

    var graph = d3.select(divID).append("svg:svg")
            .attr("width", w + m.right + m.left)
            .attr("height", h + m.top + m.bottom)
          .append("svg:g")
            .attr("transform", "translate(" + m.left + "," + m.top + ")");

    // create x-axis
    var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom")
            .ticks(4)
            .tickSize(-h)
            .tickFormat(d3.time.format("%Y/%m"));

    // Add the x-axis.
    graph.append("svg:g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + h + ")")
        .call(xAxis);

    // Overide the default behaviour of d3 axis labels
    d3.selectAll(".x.axis g text")[0].forEach(function(e) {
        e.attributes[0].value = 8; // y
    });

    // create y-axis
    var yAxisLeft = d3.svg.axis()
            .scale(y)
            .ticks(12)
            .orient("left")
            .tickSize(-w);

    // Add the y-axis to the left
    graph.append("svg:g")
        .attr("class", "y axis")
        .attr("transform", "translate(0,0)")
        .call(yAxisLeft);

    var i = 0;
    $.each(data, function(key, value) {
        value.forEach(function(d) {
            d.date = parseDate(d.date);
        });

        var line = d3.svg.line()
                .x(function(d) { return x(d.date); })
                .y(function(d) { return y(d.value); });
        graph.append("path")
            .datum(value)
            .attr("d", line)
            .attr("class", "line")
            .attr("stroke", colour[i]);
        i++;
    });

    var legend = graph.append("g")
            .attr("class", "legend")
            .attr("height", 100)
            .attr("width", 100)
        .attr('transform', 'translate(-5,' + (h + 35) + ')');

    legend.selectAll('rect')
        .data(labels)
      .enter()
      .append("rect")
          .attr("x", function(d, i){
              var xPost = legendXPosition(labels, i, 6);
              return xPost;
          })
      .attr("y", -6)
          .attr("width", 20)
          .attr("height", 5)
          .style("fill", function(d, i) {
              var color = colour[i];
              return color;
          });

    legend.selectAll('text')
      .data(labels)
      .enter()
      .append("text")
          .attr("x", function(d, i){
              var xPost = legendXPositionText(labels, i, 22, 6);
              return xPost;
          })
      .attr("y", -1)
          .text(function(d) {
              return d;
          });
  };

  function legendXPositionText(data, position, textOffset, avgFontWidth){
    return legendXPosition(data, position, avgFontWidth) + textOffset;
  }

  function legendXPosition(data, position, avgFontWidth){
    if(position == 0){
        return 0;
    } else {
        var xPostiion = 0;
        for(i = 0; i < position; i++){
            xPostiion += (data[i].length * avgFontWidth + 40);
        }
        return xPostiion;
    }
  }

  var benchmark_line_graph_colours = ["#524364", "#937ab1", "#ab5b02", "#faa757"],
    benchmark_line_graph_data = {"Beassa ALBI TR ZAR":[{"date":"2012-08-31","value":101.1},{"date":"2012-09-28","value":101.89},{"date":"2012-10-31","value":101.09}],"FTSE/JSE All Share TR ZAR":[{"date":"2012-08-31","value":99.72},{"date":"2012-09-28","value":101.24},{"date":"2012-10-31","value":105.29}],"STeFI Composite ZAR":[{"date":"2012-08-31","value":100.23},{"date":"2012-09-28","value":100.52},{"date":"2012-10-31","value":100.77}],"portfolio":[{"date":"2012-08-31","value":101.55},{"date":"2012-09-28","value":101.15},{"date":"2012-10-31","value":102.08}]};
  drawlinegraph(benchmark_line_graph_data,
    "2012-08-31",
    "2012-10-31",
    105.84700000000001,
    99.163, benchmark_line_graph_colours,
    "body");
</script> 
```**

# mysql - 具有可变列数的数据集的 MySQL 数据库设计

> ID：13954491
> 
> 赞同：2
> 
> 时间：2012-12-19T14:27:36.773
> 
> 标签：mysql

我拥有的是大约 130GB 的数千种金融工具订单簿的时变状态数据。

我拥有的 csv 文件在订单簿状态的每次更改中都包含一行（由于执行的交易、插入的订单等）。状态被描述为：一般订单信息的几个字段（例如工具的isin代码），有关状态变化的一些信息字段（例如orderType，时间），最后是当前状态的买入和卖出水平。卖出和买入订单最多有 20 个级别（买入级别 1 代表最佳买入价，卖出级别 1 代表最佳卖出价等），每个级别包含 3 个字段（价格、总成交量和订单金额）。最后，对于买方和卖方，还有 3 个超过 20 级别的聚合数据字段。这相当于每个州最多 21*2*3 = 126 个级别数据字段。

问题在于，由于几乎不存在接近 20 个级别的任何地方，因此为每个级别保留字段似乎没有意义。例如，我会有一行有 3 个买入级别，其余字段为空。另一方面，同一订单簿在片刻后可能有 7 个买入级别。

我肯定会将一般订单信息规范化到它自己的表中，但我不知道如何有效地处理级别。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:37:28.323

我不得不在某个时间点准确地处理这种数据结构。一个重要的问题是如何使用数据。如果您只是在任何给定时间寻找最佳出价和要价，那么水平并没有太大区别。如果您正在分析市场深度，那么水平可能很重要。

对于您正在使用的数据量，索引和分区等其他考虑因素可能更为重要。如果特定查询所需的数据适合内存，那么整个表有多大并不重要。

我的建议是将不同级别保持在同一记录中。然后，您可以使用页面压缩（取决于您的存储引擎）来消除为空值保留的大部分空间。SQL Server 会自动执行此操作，因此将级别放在单个记录中是很容易的。

如果页面压缩不起作用，一个折衷的解决方案是存储固定数量的级别。通常会填充五个级别，因此您不会遇到在空白字段上浪费空间的问题。而且，这个级别的数量可能足以满足几乎所有的使用。

# javascript - 在已重定向的弹出窗口中调度的 Javascript 事件

> ID：13954497
> 
> 赞同：5
> 
> 时间：2012-12-19T14:27:54.387
> 
> 标签：javascript, asp.net, popup, dom-events, custom-events

我有一个页面 A 会打开一个到 B 的弹出窗口。页面 B 在完成一些工作后，总是重定向到弹出窗口中的另一个页面 C。然后页面 C 调度一个事件来向页面 A 发送一些数据，但是页面 A 没有引用页面 C 来注册事件处理程序。我尝试的代码有点像这样：

页面A：

```
function handler(e) {
    alert(e.detail.message);
}
var popup = window.open('/PageB.aspx');
popup.addEventListener("dispatch", handler, false); 
```

页面B：

```
location.href = "PageC.aspx"; 
```

页面C：

```
var event = new CustomEvent(
        "dispatch",
        {
            detail: {
                message: "Test"
            },
            bubbles: true,
            cancelable: true
        }
    );

window.dispatchEvent(event); 
```

但这不起作用，因为当我重定向时，PageA 错过了对 PageC 的引用。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:49:28.983

如果页面 C 与页面 A 在同一个域中，请尝试

```
window.opener.dispatchEvent(event); 
```

如果没有，您需要使用 postMessage 代替，这意味着您必须将事件序列化为字符串并在页面 A 上侦听消息。

# django-signals - Django Signals 更新不同的模型

> ID：13954499
> 
> 赞同：1
> 
> 时间：2012-12-19T14:28:02.393
> 
> 标签：django-signals, django-1.4

假设我有两个模型：

```
class Product(models.Model):
    product = model.CharField()
    quantity = model.IntegerField()

class sale(models.Model)
    product = models.ManyToManyField(Product)
    number_sold = model. IntegerField() 
```

进行销售时，我希望更新产品数量。信号是解决此问题的最佳方式吗？

我正在考虑在创建或更新对象时让销售承认 post_save 信号。如果更新，我必须知道旧值和新值才能正确调整数量。产品表必须监听此信号。

我还在考虑让产品表在更新数量后发送自定义信号。如果数量 < 0 项目在延期交货，否则“成功”。

我是 django 和信号的新手，但这是信号的适当用途还是更好的方法？我已经阅读了文档，观看了有关信号的 pycon 视频，并阅读了一些示例。我还没有看到以这种方式使用的信号，但我想不出任何其他方式来完成这项任务。

这就是我最终实现目标的方式，我很想知道这是否是正确的方法。对于与以下代码不匹配的模型，我深表歉意，我简化了模型以使其更容易。

```
@receiver(pre_save, sender=Customer_Order_Products)
    def update_quantity(sender, **kwargs):
        obj = kwargs['instance']
        updated_product = Inventory.objects.get(title = obj.product_id)
        if not obj.id:
            updated_product.quantity -= obj.quantity
        else:
            updated_product.quantity -= (obj.quantity - Customer_Order_Products.objects.get(id = obj.id).quantity)
        Inventory.save(updated_product) 
```

# bash - bash 脚本为 LDAP 提取域名

> ID：13954501
> 
> 赞同：4
> 
> 时间：2012-12-19T14:28:03.613
> 
> 标签：bash

我目前正在编写一个要求用户输入域名的脚本。此域名用于填充 LDAP 的 hqbase 变量。例如，如果用户输入“example.com”，我必须在一侧剪切域名并`example`在另一侧剪切“com”。

我找到了这个例子：

```
echo http://example.com/index.php | awk -F/ '{print $3}' 
```

但是如何`example`从`com`（任何“。”）中拆分出来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:32:00.787

你想`.`作为你的分隔符：

```
# Using cut
$ echo "domain.com" | cut -d. -f1
domain

$ echo "domain.com" | cut -d. -f2
com

# Using awk                                                                     
$ echo "domain.com" | awk -F. '{print $1}'
domain

$ echo "domain.com" | awk -F. '{print $2}'
com

# Save values                                                                   
$ first=$(echo "domain.com" | cut -d. -f1)
$ second=$(echo "domain.com" | cut -d. -f1) 
```

# java - 连续调用多个对象是否会影响性能？

> ID：13954503
> 
> 赞同：5
> 
> 时间：2012-12-19T14:28:08.050
> 
> 标签：java, performance

呼叫 A：

```
double Value = Object.Object.Object.Object.DoubleValue; 
```

呼叫乙：

```
double Value : Object.DoubleValue; 
```

如果这是在 for 循环中并被多次调用，那么在对象中调用对象是否会造成性能损失，或者是否值得注意？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:32:01.630

可读性适用于程序员，优化适用于编译器（老实说，还有 jit 优化）。

**做任何你团队中的标准并且更具可读性**。

如果您在执行此操作后怀疑存在一些性能问题 - 使用分析器检查是否确实如此，并进行相应的调整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:32:32.313

> 不值得一提吗？

它可能会花费你几十纳秒（这对你来说很重要吗？）JIT 相当擅长优化/缓存参考查找，因此将它们放在局部变量中不太可能更快。即，即使它很重要，你也不太可能做一些简单的事情。

# entity-framework - System.OutOfMemoryException 使用实体框架？

> ID：13954504
> 
> 赞同：9
> 
> 时间：2012-12-19T14:28:09.853
> 
> 标签：entity-framework, entity-framework-4.1

我正在尝试使用实体框架保存数十万条记录。保存数十万条记录后，我收到以下错误：

:System.OutOfMemoryException

我的代码

```
 foreach (BibContent objbibcontents in lstBibContent)
        {
            db.BibContents.AddObject(objbibcontents);
            c = c + 1;
            if (c == 1000)
            {
                db.SaveChanges();
                c = 0;
            }
        } 
```

我注意到保存 1000 条记录后，我的数据库没有覆盖另外 1000 条记录。它将它们添加到我的 dbcontext 中。

我在 1000 条记录后创建了一个新实例，但我的数据库仍然有前一个对象的数据。查看我的代码

```
 foreach (var objbibcontents in lstBibContent)
            {
                vibrantEntities db1 = new vibrantEntities(szConStr);
                lstBibCon.Add(objbibcontents);
                // db.BibContents.AddObject(objbibcontents);
                c = c + 1;
                if (c == 1000)
                {
                    foreach (BibContent bibobject in lstBibCon)
                    {
                        db1.BibContents.AddObject(bibobject);
                    }
                    lstBibCon.Clear();
                    db1.SaveChanges();
                    c = 0;
                    flag = 1;
                }
            } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T10:44:32.933

您要保存多少个对象，单个对象有多大？DbContext 包含对您通过`AddObject`调用添加的所有对象的引用。调用`SaveChanges`不会清除其内部数据结构，因此如果您为 1M 对象调用代码，您将在内存中拥有 1M 对象并且它们将完全处于活动状态，因为它们的 GC 根对象将是仍在运行代码范围内的上下文实例.

如果您想避免内存问题，您应该为每 1000 条记录（甚至每条记录）使用一个新的上下文实例。运行 1000 条记录和运行单条记录之间的唯一区别`SaveChanges`是自动涉及的事务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T10:22:18.457

我在网上搜索，最后我找到了解决我问题的好方法。

[在实体框架中插入的最快方式](https://stackoverflow.com/questions/5940225/fastest-way-of-inserting-in-entity-framework)

# sql - 需要一些关于优化此查询的想法

> ID：13954505
> 
> 赞同：0
> 
> 时间：2012-12-19T14:28:11.940
> 
> 标签：sql, sql-server, database, sql-server-2008

我有下面的查询，我正在寻找优化它的方法（等使其更高效和更快）。有没有人有任何想法？

```
SELECT s.oem_id, s.name, SUM(u.minimum_gfs) AS minimum_gfs, sum(u.minimum_ofs) AS    
   minimum_ofs, sum(u.minimum_wq) AS minimum_wq
FROM nmp_building_reqs AS s
   LEFT OUTER JOIN nmp_building_util AS u
ON u.oem_id = s.oem_id
GROUP BY s.oem_id, s.name 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:32:47.027

唯一明显的事情是确保 oem_id 被索引以使连接更快。

但是，我怀疑您可以在加入之前进行聚合，然后引入名称。这是假设 oem_id 只有一个与之关联的名称。查询如下所示：

```
SELECT s.oem_id, s.name, u.minimum_gfs, u.minimum_ofs, u.minimum_wq
FROM nmp_building_reqs s left outer join
     (select u.oem_id, SUM(u.minimum_gfs) AS minimum_gfs,
             sum(u.minimum_ofs) AS minimum_ofs, sum(u.minimum_wq) AS minimum_wq
      from nmp_building_util u
      group by u.oem_id
     ) u
     ON u.oem_id = s.oem_id 
```

# bash - 比较执行日志忽略执行时间

> ID：13954509
> 
> 赞同：3
> 
> 时间：2012-12-19T14:28:26.633
> 
> 标签：bash, sed, diff

我是 linux SO 和 bash 命令的新手，我认为有更多经验的人可以帮助我。我想将 2 个不同的文本文件与执行日志进行比较，但有些行（不是全部）以这样的时间标记开头：

```
12345 ps line 1 content 
23456 ps line 2 content 
line 3 content 
345 ps line 4 content 
```

这些标记在每个日志中都有不同的值，但是，在那个比较中，我不关心它们，我只想比较行内容并忽略它们。我可以使用“sed”命令生成没有该令牌的新文件，然后对它们进行比较，但我假装重复这样做，如果我只使用一个命令或一个 sh 文件，可以节省一些时间。我尝试将“sed”和“diff”结合使用，但没有成功。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:35:03.000

您可以使用以下 sed one liner 删除文件开头的数字：

```
sed 's/^[0-9]* ps//g' file1 
```

要区分两个这样的文件（更少的时间戳），您可以使用[进程替换](http://tldp.org/LDP/abs/html/process-sub.html)。

```
diff <(sed 's/^[0-9]* ps//g' file1) <(sed 's/^[0-9]* ps//g' file2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:24:17.413

未经测试，因为您没有显示 2 个输入文件和预期的输出，但根据您的描述，我认为这可以满足您的要求：

```
awk '
   { sub(/^[[:digit:]]+[[:space:]]*/,"") }
   NR==FNR { file1[FNR] = $0; next }
   { print ($0 == file1[FNR] ? "==" : "!="), $0 }
' file1 file2 
```

如果不这样做，请发布一些小样本输入和预期输出。

# iphone - 从 NSMutableArray 下载时“for”循环崩溃

> ID：13954513
> 
> 赞同：8
> 
> 时间：2012-12-19T14:28:38.177
> 
> 标签：iphone, objective-c, ios, cocoa-touch, nsurlconnection

我的`NSMutableArray`. 我有这个简洁的代码用于下载文件并显示文件的数据以`UITextView`用于测试目的。没有`for`循环，一切都很好。给我问题的代码在这个函数中：

```
- (void)complexDownload {
    int i;
    for (i=0; i < downloadArray.count; i++) {
        if (isBusy == NO) {
            [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];
            downloadURL = [downloadArray objectAtIndex:i];
            NSLog(@"URL is %@", downloadURL);
            NSLog(@"Downloading object at index %i", i);
            NSURL *url = downloadURL;
            NSURLRequest *theRequest=[NSURLRequest requestWithURL:url
                                                      cachePolicy:NSURLRequestUseProtocolCachePolicy
                                                  timeoutInterval:60.0];

            NSURLConnection *theConnection = [NSURLConnection connectionWithRequest:theRequest delegate:self];

                if (theConnection) {
                    self.downloadData = [NSMutableData data];
                    isBusy = YES;
                    NSLog(@"Busy value in download cycle equals %i, downloading", isBusy);
                } else {
                    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
                    NSLog(@"Connection failed");
                    isBusy = NO;
                }
        }
    }
} 
```

我首先认为问题可能出在 中`isBusy` `BOOL`，但即使没有`if`条件，应用程序也会崩溃。除了这个，编译器没有给我任何错误： [这是大屏幕截图的链接](http://img69.imageshack.us/img69/7913/20121219064023pm.png)。

其余功能如下：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [downloadData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSString *dataString = [[NSString alloc] initWithData:downloadData encoding:NSASCIIStringEncoding];
    self.dataTextView.text = dataString;
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    NSLog(@"Download finished!");
    isBusy = NO;
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    NSLog(@"%@", error);
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
} 
```

所有 NSLogged 值都很好，数组有链接，所有链接都是正确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T15:05:56.113

我的猜测是，在某些时候要么`downloadArray[i]`在某个时候损坏，要么它不是 NSUrl。`CFURLCopyAbsoluteURL()`代码在调用 from中崩溃`[NSURLRequest requestWithURL...]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:13:23.553

您使用异步 api [initWithRequest:delegate:并尝试使用](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/occ/instm/NSURLConnection/initWithRequest%3adelegate%3a)*isBusy*标志使其同步。这种方法一开始是非常错误的，NSURLConnection 类足够聪明，如果使用得当就不需要使用任意标志。您应该认真重新考虑使用 NSOperations 或 GCD。如果你打算做更复杂的连接编程，也许你应该考虑使用像 RestKit 这样的第三方框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T15:23:36.083

摆脱 for 循环和 isBusy 指示器。始终只处理第一个或最后`complexDownload`一个（更合适的）对象，然后将其从数组中删除。再次`connectionDidFinish`调用。`complexDownload`为此使用`performSelector`。等待时间甚至可能是 0.0f。通过这样做，您`downloadArray`将充当某种队列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T15:24:55.907

我认为这是 [NSURLRequest requestWithURL:url 中的 url-object 的问题 没有必要将 URL 复制到额外的对象中。尝试这个：

```
NSLog(@"URL is %@", [downloadArray objectAtIndex:i]);
NSLog(@"Downloading object at index %i", i);
NSURL *url = [downloadArray objectAtIndex:i]; 
```

（或在downloadURL之前添加self.）

如果您的 downloadArray 包含 NSStrings：

```
NSURL *url = [NSURL URLWithString:[downloadArray objectAtIndex:i]]; 
```

我建议使用外部框架，如 [ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/

# xslt - XSL 分组和子分组

> ID：13954514
> 
> 赞同：1
> 
> 时间：2012-12-19T14:28:39.363
> 
> 标签：xslt, xslt-1.0

我在 Muenchian grouping [XSLT 1.0 Group By](https://stackoverflow.com/questions/1903906/xslt-1-0-group-by)上找到了这篇文章，并完成了我想做的事情，但我不知道如何对我的子节点进行分组。

我的 XML 看起来有点像这样：

```
<NewDataSet>
   <Vehicle>
     <ManufacturerId>53</ManufacturerId>
     <ManufacturerName>VAUXHALL</ManufacturerName>
     <Model>Corsa</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>53</ManufacturerId>
     <ManufacturerName>VAUXHALL</ManufacturerName>
     <Model>Astra</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>53</ManufacturerId>
     <ManufacturerName>VAUXHALL</ManufacturerName>
     <Model>Corsa</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>54</ManufacturerId>
     <ManufacturerName>FORD</ManufacturerName>
     <Model>KA</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>54</ManufacturerId>
     <ManufacturerName>FORD</ManufacturerName>
     <Model>Focus</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>54</ManufacturerId>
     <ManufacturerName>FORD</ManufacturerName>
     <Model>KA</Model>
   </vehicle>
   <Vehicle>
     <ManufacturerId>55</ManufacturerId>
     <ManufacturerName>CITROEN</ManufacturerName>
     <Model>C4</Model>
   </vehicle>
<NewDataSet> 
```

这是我到目前为止的代码

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="html" omit-xml-declaration="yes" />
   <xsl:key name="groups" match="/NewDataSet/Vehicle" use="ManufacturerName" />
   <xsl:template match="/NewDataSet">
      <xsl:apply-templates select="Vehicle[generate-id() = generate-id(key('groups', ManufacturerName)[1])]"/>
   </xsl:template>
   <xsl:template match="Vehicle">
     <div class="makeLnk">
     <a href="/stocklist/?ManufacturerId={ManufacturerId}"><xsl:value-of select="ManufacturerName"/></a>
    <xsl:for-each select="key('groups', ManufacturerName)">
      <div class="modelLnk"><xsl:value-of select="Model"/></div>
    </xsl:for-each>
    </div>
   </xsl:template>
</xsl:stylesheet> 
```

这将制造商名称组合在一起并列出所有模型。但我现在也想对模型进行分组，从而删除重复的名称。但无法解决语法。

将不胜感激任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:49:31.513

使用由 的`ManufacturerName`和`Vehicle`的值组成的第二个键`Model`：

```
<xsl:key name="model" match="Vehicle/Model" use="concat(../ManufacturerName, '|', .)"/> 
```

然后替换

```
 <xsl:template match="Vehicle">
     <div class="makeLnk">
     <a href="/stocklist/?ManufacturerId={ManufacturerId}"><xsl:value-of select="ManufacturerName"/></a>
    <xsl:for-each select="key('groups', ManufacturerName)">
      <div class="modelLnk"><xsl:value-of select="Model"/></div>
    </xsl:for-each>
    </div>
   </xsl:template> 
```

和

```
 <xsl:template match="Vehicle">
     <div class="makeLnk">
     <a href="/stocklist/?ManufacturerId={ManufacturerId}"><xsl:value-of select="ManufacturerName"/></a>
    <xsl:for-each select="key('groups', ManufacturerName)/Model[generate-id() = 
  generate-id(key('model', concat(../ManufacturerName, '|', .))[1])]">
      <div class="modelLnk"><xsl:value-of select="."/></div>
    </xsl:for-each>
    </div>
   </xsl:template> 
```

# php - 显示与 wordpress 中的页面类别类似的类别的帖子

> ID：13954515
> 
> 赞同：1
> 
> 时间：2012-12-19T14:28:41.783
> 
> 标签：php, wordpress

我想显示与页面类别相似的帖子。这是我的代码（只是重要的 php 部分，而不是 html）？怎么了？

```
<?php $pages = get_pages(array('child_of' => 13)); ?> 
    <?php foreach ($pages as $page): ?>
        <?php echo $page->post_title; ?>
        <?php echo $page->post_excerpt; ?>
        <?php echo $page->post_content; ?>
            <?php $categories = get_the_category($page->ID);?>
                <?php query_posts('post_type=projekt&category_name=$categories&showposts=1');?>
                    <?php while (have_posts()) : the_post(); ?> 
                        <?php the_title(); ?></a>
    <?php endforeach; ?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:32:17.470

尝试

```
<?php $pages = get_pages(array('child_of' => 13)); 
foreach ($pages as $page) {
    echo $page->post_title;
    echo $page->post_excerpt;
    echo $page->post_content;
    $categories = get_the_category($page->ID);
    query_posts('post_type=projekt&category_name='.$categories.'&showposts=1');
    while (have_posts()) : the_post(); ?>
        <a><?php the_title(); ?></a>
<?php endwhile;
endforeach; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:32:34.133

未经测试，此行看起来不正确：

```
<?php query_posts('post_type=projekt&category_name=$categories&showposts=1');?> 
```

由于单引号，该`$categories`变量被逐字解释

```
<?php query_posts('post_type=projekt&category_name=' . $categories . '&showposts=1');?> 
```

# c++ - 在函数调用之前使用 (void)

> ID：13954517
> 
> 赞同：34
> 
> 时间：2012-12-19T14:28:50.733
> 
> 标签：c++, c

> **可能重复：**
> [将未使用的返回值转换为 void](https://stackoverflow.com/questions/689677/casting-unused-return-values-to-void)

`(void)`例如，函数调用之前的目的是什么

```
(void)func1(); 
```

我认为这与简单地调用相同`func1();`

因此，`(void)`调用只是为了让其他程序员知道返回类型将被忽略，例如`func1()`返回类型是否为`int`，或者编译器是否可能对函数执行一些优化？也许它背后还有另一个原因——它甚至是合法的 C++，还是它是在某些遗留代码中看到的 C 的残余。

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-19T14:30:39.360

如果使用属性声明某些函数，它可以防止警告：“如果返回值未使用/检查则警告”

可能是警告的副本[：忽略“scanf”的返回值，用属性 warn_unused_result 声明](https://stackoverflow.com/questions/7271939/declared-with-attribute-warn-unused-result)

查看 gcc 的文档：[http](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html) ://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html (warn_unused_result) 了解更多详情

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-12-19T14:38:21.830

在一种情况下，强制转换为 void 可以产生语义效果：如果值是逗号运算符的操作数并覆盖逗号运算符，则强制转换为 void 将抑制它：

```
struct S {
  int operator,(int) { return 0; }
};
std::cout << (S(), 42) << '\n';           // prints '0'
std::cout << ((void) S(), 42) << '\n';    // prints '42' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-19T14:32:13.893

这意味着很少。它显式地将行转换为 void 表达式，这是一个仅用于其副作用并且其值被丢弃的表达式。所以线条

```
func1(); 
```

和

```
(void)func1(); 
```

会做同样的事情。如果编译器知道未使用表达式的值，则可以执行一些优化，但编译器很可能可以在有或没有显式 (void) 的情况下计算出来。

它可以用作一种文档形式，程序员试图表明他们没有使用表达式的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-19T14:45:06.003

另一个奇怪的用途是允许将未知返回类型的函数`,`作为序列运算符与运算符相邻使用。即，`decltype( f(), g() )`技术，您想说“`f`可以使用`()`, as can进行操作`g`，并且我希望这种类型成为`g()`返回的类型”。但是，如果`f()`返回一个`operator,`重载的类型，结果将是意料之外的。

所以你这样做，并在调用之前`decltype( void(f()), g() )`丢弃返回值，这样你就可以保证获得内置的序列运算符而不是一些未知的覆盖类型。`f()``operator,`

# php - 传递数组（）而不是对象给出：尝试获取非对象的属性

> ID：13954526
> 
> 赞同：0
> 
> 时间：2012-12-19T14:29:48.820
> 
> 标签：php, arrays, object

使用 PHP 5.3.3 和 Drupal 7.17，我创建了一个简短的自定义 PHP 脚本，我想在其中调用 Drupal 的函数——它又需要一个具有`pass`属性的对象：

```
function user_check_password($password, $account) {
  if (substr($account->pass, 0, 2) == 'U$') {
    $stored_hash = substr($account->pass, 1);
    $password = md5($password);
  }
  .....
} 
```

因此，在我的脚本中，我尝试“即时”创建这样一个对象：

```
<?php

require_once('/path/to/drupal/includes/password.inc');
........
$sth = $db->prepare(SQL);
$sth->execute(array($username));
if ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
        if (user_check_password($password, array('pass' => $row['pass']))) {
                header('Content-Type: application/json; charset=utf-8');
                print json_encode($row);
        }
} 
```

然而，这给了我一个错误：`Trying to get property of non-object`

这可能意味着：PHP 不接受我的数组，它想要一个对象。

我怎样才能“即时”创建一个匿名对象，然后让它开心呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:40:53.153

你得到一个错误，因为`Array`不是`Object`. 如果您不想手动创建对象（如@adityamenon 的回答），那么您可以简单地将数组转换为对象：

```
user_check_password($password, (object)array('pass' => $row['pass'])) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:35:52.167

要制作新的“匿名”对象，请使用 stdClass。

`$new_object = new stdClass;`

在您的代码中：

```
<?php

require_once('/path/to/drupal/includes/password.inc');
........
$sth = $db->prepare(SQL);
$sth->execute(array($username));
if ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
$new_object = new stdClass;
$new_object->pass = $row['pass'];
        if (user_check_password($password, $new_object)) {
                header('Content-Type: application/json; charset=utf-8');
                print json_encode($row);
        }
} 
```

# padrino - 如何在使用 slim 的中间人中使用 content_for 和 yield_content

> ID：13954529
> 
> 赞同：0
> 
> 时间：2012-12-19T14:30:00.490
> 
> 标签：padrino, slim, middleman

我试过在 content_for 前面加上 =、== 或 - 没有运气:)

index.slim

```
- content_for(:senarios) do
  h1 Some content 
```

布局.slim

```
== yield_content(:senarios) 
```

希望有人得到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T09:18:31.510

该示例应该可以正常工作。

您使用 捕获内容`content_for`并将其插入到布局文件中`yield_content`。如果需要，您可以省略括号。

如果您使用标准 Slim 设置，则需要两个等号。否则输出将被转义，您将看到`<h1>Some content</h1>`而不是`Some content`在渲染的输出中。

我也将它与 Middleman 和 Slim 一起使用。没有问题。您能否提供更多代码、错误等？

唯一看起来可疑的是文件名**index.slim**。它应该是**index.html.slim**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T03:14:34.410

我遇到了同样的问题，并解决了。

你应该改变

```
- content_for(:eyecatch) do 
```

至

```
= content_for(:eyecatch) do 
```

嵌套的 html 属性不应再重复。

# c# - Mono 中带有子目录的 EnumerateFiles

> ID：13954530
> 
> 赞同：0
> 
> 时间：2012-12-19T14:30:04.640
> 
> 标签：c#, mono, monodevelop

我正在 linux ubuntu 上尝试 Mono。文件枚举不适用于子目录。如果我使用 GetFiles() 它将起作用。我使用控制台来获取文件的输出，所以我不会得到枚举输出：

```
 [Test]
        public void NotImportentTest ()
        {
            Directory.CreateDirectory("test");
                        Directory.CreateDirectory("test/dings");
            File.Create("test/dings/hallo").Close();
            var curdir = Directory.GetCurrentDirectory();
            var searchdir = new DirectoryInfo(curdir + "/test");
            var files = searchdir.EnumerateFiles("*",SearchOption.AllDirectories);
            foreach (var file in files)
            {
                Console.WriteLine("Enumerate:{0} in {1}\r\n", file, curdir);
            }
            foreach (var file in searchdir.GetFiles("*",SearchOption.AllDirectories))
            {
                Console.WriteLine("GetFiles:{0} in {1}\r\n", file, curdir);
            }
        } 
```

# javascript - 如果失败，则跳过规范中的后续 Mocha 测试

> ID：13954531
> 
> 赞同：62
> 
> 时间：2012-12-19T14:30:04.280
> 
> 标签：javascript, node.js, mocha.js

`it`如果其中一个失败，我找不到如何阻止某些部分运行的方法

我正在使用`mocha-as-promised`，所以代码看起来可能与往常不同

```
describe("remote promises", function() {
  describe("browsing", function() {
    describe("getting page", function() {
      it("should navigate to test page and check title", function() {
        this.timeout(TIMEOUT);
        return browser.get("http://admc.io/wd/test-pages/guinea-pig.html").then(function() {
          return browser.title();
        }).then(function(title) {
          return assert.ok(~title.indexOf("I am a page title - Sauce Labs"), "Wrong title!");
        });
      })
      it("submit element should be clicked1", function() {
        this.timeout(TIMEOUT);
        return browser.elementById("submit").then(function(el) {
          return browser.clickElement(el);
        }).then(function() {
            return browser["eval"]("window.location.href");
          }).then(function(location) {
            assert.ok(~location.indexOf("http://"), "Wrong location!");
          });
      })
    });
    describe("clicking submit", function() {
      it("submit element should be clicked2", function() {
        this.timeout(TIMEOUT);
        return browser.elementById("submit").then(function(el) {
          return browser.clickElement(el);
        }).then(function() {
            return browser["eval"]("window.location.href");
          }).then(function(location) {
            assert.ok(~location.indexOf("http://"), "Wrong location!");
          });
      });
    });

  });
}); 
```

我希望如果`should navigate to test page and check title`失败则 `submit element should be clicked1`应该跳过

编辑：似乎我只是让我的测试错了，在删除问题之前会等待一段时间

**编辑：**

正如我在评论中回复的那样——我已经在 mocha google 群组中收到了这个答案，但是还有一些我没有提到的其他限制——我正在使用 grunt-simple-mocha 并且当我检查代码时——当我没有保释选项时将选项传递给 mocha 构造函数

我找不到从命令行传递给套件实例的选项的位置，而我看到的唯一行是

```
suite.bail(this.bail()); 
```

这对我来说看起来很奇怪

我想我会在 mocha github 页面上打开问题，也许他们稍后会通过保释设置扩展传递的选项，或者只是解释我做错了什么以及如何以其他方式解决我的问题

**编辑：现在，根据[https://github.com/visionmedia/mocha/commit/f0b441ceef4998e570a794dcff951bf2330eb0c5](https://github.com/visionmedia/mocha/commit/f0b441ceef4998e570a794dcff951bf2330eb0c5) 最新的 Mocha 有保释选项。感谢作者！**

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-12-19T19:43:12.667

摩卡支持第一次测试失败后退出，这是你想要的吗？

来自`mocha --help`：

```
-b, --bail                      bail after first test failure 
```

# c# - 我们如何在 .net 中自动运行测试方法？

> ID：13954534
> 
> 赞同：8
> 
> 时间：2012-12-19T14:30:12.667
> 
> 标签：c#, asp.net

我需要一次自动运行所有测试方法。我在单独的文件中编写了单独的测试方法。有没有办法一次自动运行所有测试方法。如果有请建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:44:47.993

连续测试： [http](http://continuoustests.com/) ://continuoustests.com/是一个免费的自动化测试运行程序，支持 .NET 和 Mono 平台。我认为它没有命令行版本。

Gallio [http://www.gallio.org/](http://www.gallio.org/) 有一个命令行运行器和一个 GUI 运行器 (Icarus)。我使用它，但我不确定它是否会进行自动或连续测试运行

NCrunch [http://www.ncrunch.net/](http://www.ncrunch.net/) 也是一个在 Visual Studio 中工作的自动化测试运行器。它曾经是免费的，但现在是付费软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:34:05.080

如果你使用 NUnit，你可以使用 NUnit GUI。另一个主要与框架无关的选项是[TestDriven.Net](http://testdriven.net/)。

# c++ - C++ Windows CreateChildProcess - 隐藏/不显示子进程的控制台窗口

> ID：13954537
> 
> 赞同：2
> 
> 时间：2012-12-19T14:30:25.150
> 
> 标签：c++, windows, process, console

我需要为我的主进程创建一个子进程作为套接字侦听器/服务器，并使用此调用来实现目标：

```
bSuccess = CreateProcessA(NULL, 
            cmdLineArgs,   // command line 
            NULL,          // process security attributes 
            NULL,          // primary thread security attributes 
            TRUE,          // handles are inherited 
            HIGH_PRIORITY_CLASS,             // creation flags 
            NULL,          // use parent's environment 
            NULL,          // use parent's current directory 
            &siStartInfo,  // STARTUPINFO pointer 
            &piProcInfo);  // receives PROCESS_INFORMATION 
```

谁能说明需要做什么才能使子进程的窗口不显示？每次主要的中央进程创建一个子进程时，都不希望有一个可见的进程窗口。

**稍后编辑**我使用：

```
HWND hWnd = GetConsoleWindow();
if (hWnd != 0) 
{       
    ShowWindow( hWnd, SW_HIDE);
} 
```

在子进程的主要功能中，但这并不是最好的解决方案，因为窗口仍然会显示几分之一秒。如果一个有几个子进程，每个子进程都有自己的窗口冒泡到屏幕上，它仍然不优雅。是否需要为编译器设置任何标志以生成“无控制台”输出？

我正在使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:44:04.037

该[`CREATE_NO_WINDOW`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684863%28v=vs.85%29.aspx)标志仅用于此目的。

您可以`dwCreationFlags`像这样将它添加到位掩码中：

```
bSuccess = CreateProcessA(NULL, 
            cmdLineArgs,   // command line 
            NULL,          // process security attributes 
            NULL,          // primary thread security attributes 
            TRUE,          // handles are inherited 
            HIGH_PRIORITY_CLASS | CREATE_NO_WINDOW,  // creation flags 
            NULL,          // use parent's environment 
            NULL,          // use parent's current directory 
            &siStartInfo,  // STARTUPINFO pointer 
            &piProcInfo);  // receives PROCESS_INFORMATION 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:44:34.083

您必须使用`STARTUPINFO`作为参数提供的结构`CreateProcess`。

```
STARTUPINFO StartInfo= {sizeof(StartInfo)};
StartInfo.dwFlags= STARTF_USESHOWWINDOW;
StartInfo.wShowWindow= SW_HIDE; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:45:44.033

```
siStartInfo.dwFlags &= STARTF_USESHOWWINDOW;
siStartInfo.wShowWindow = SW_HIDE; 
```

应该这样做

另请查看[http://msdn.microsoft.com/en-us/library/windows/desktop/ms686331(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686331(v=vs.85).aspx)

# openstack-nova - Nova 启动错误 Devstack

> ID：13954539
> 
> 赞同：1
> 
> 时间：2012-12-19T14:30:30.317
> 
> 标签：openstack-nova

我上传了一张图片到glance，一个vhd格式的Ubuntu服务器12.04，当我尝试用nova boot启动那个图片时，我收到了这个：

```
+--------------------------------------+------------ ---------------+
| 物业 | 价值 |
+--------------------------------------+------------ ---------------+
| 操作系统-DCF：磁盘配置 | 手册 |
| OS-EXT-SRV-ATTR:主机 | 无 |
| OS-EXT-SRV-ATTR:hypervisor_hostname | 无 |
| OS-EXT-SRV-ATTR:instance_name | 实例-00000004 |
| OS-EXT-STS:power_state | 0 |
| OS-EXT-STS:task_state | 调度 |
| OS-EXT-STS:vm_state | 建设|
| 访问IPv4 | |
| 访问IPv6 | |
| 管理员通行证 | PK2mwUZ7SJEH |
| 配置驱动器 | |
| 创建 | 2012-12-19T17:21:48Z |
| 风味 | m1.tiny |
| 主机 ID | |
| 编号 | 716c9276-648c-4f90-9e67-43b8f41feb91 |
| 图片 | Ubuntu |
| 键名 | 键1 |
| 元数据 | {} |
| 姓名 | 虚拟机1 |
| 进展 | 0 |
| 安全组 | [{u'name': u'default'}] |
| 状态 | 建立 |
| 租户 ID | 73e54a9f1ddc46fa9bd0a99d5e2a1cda |
| 更新 | 2012-12-19T17:21:54Z |
| 用户 ID | dc9c0376d5604467b3898082fd270b1c |
+--------------------------------------+------------ ---------------+
ubuntu@ubuntu:~/vmware-tools-distrib$ cd /
ubuntu@ubuntu:/$ cd /home/ubuntu/devstack/
ubuntu@ubuntu:~/devstack$ nova 列表
+----------------------------------------+------+--- -----+----------+
| 身份证 | 姓名 | 状态 | 网络 |
+----------------------------------------+------+--- -----+----------+
| 716c9276-648c-4f90-9e67-43b8f41feb91 | 虚拟机1 | 错误 | |
| 77aa0d77-2dae-4d18-a827-f08d0fb2f71a | 虚拟机1 | 错误 | |
+----------------------------------------+------+--- -----+----------+

```

那么，可能是什么问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T06:03:49.243

如果日志文件中没有明显的信息，您可以访问数据库以获取详细原因，查询 nova.instance_faults 表将为您提供有关此实例为何变为错误状态的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T08:35:19.613

查看 nova-network.log 是否有与 dhcpbridge 文件相关的错误，将该行添加到 nova.conf

dhcpbridge = /usr/bin/nova-dhcpbridge

提示：如果有已构建的镜像（nova 列表）删除它，然后重新启动所有 nova-* 服务

# php - php mail() 打破了 650 字符长的 Url

> ID：13954542
> 
> 赞同：8
> 
> 时间：2012-12-19T14:30:34.743
> 
> 标签：php, email

我使用 php 邮件功能发送包含许多参数的链接。编码后的 url 可以是 650 或更多字符长，因为它包含用于重新填充表单的变量。

当我单击电子邮件中的链接时，它会损坏，因为在 URL 的某处插入了一个空格。

这是我的 sendMail 功能：

```
 protected function sendEmail($to, $subject, $body) {
        $headers  = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=iso-8859-1' . '\r\n';
        $headers .= 'From: Sales Order From <sales@imninjas.com>' . '\r\n';
        $headers .= 'X-Mailer: PHP/' . phpversion() . '\r\n';

        $body = '<html><body style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;">'.$body.'</body></html>';

        return mail($to, $subject, $body, $headers);
    } 
```

这是我调用 sendMail 的代码。它的'$salesUrl = $this->getSalesFormUrl();' 那是 650 多个字符的 url 塞满了编码参数。

```
 function emailRep() {
        $params = $this->getParamaterArray();
        $shortUrl = $this->getShortUrl();
        $salesUrl = $this->getSalesFormUrl();

        $mailSubject = "Return to the sales order form for ".$params['clientName']." at ".$params['company'].".";

        $mailBody = "The following information is from an order created on, ".date("l, F j, Y \a\t g:i a").",<br/><br/>";
        $mailBody .= "Customer Contact Information:<br/>";
        $mailBody .= "Name: ".$params['clientName'] params['company']."<br/>";
        $mailBody .= "Shortened Url to Send to the Customer:<br/>";
        $mailBody .= ($shortUrl) ? "<a href='".$shortUrl."'>".$shortUrl."</a><br/><br/>" : "There was an error shortening your url.<br/><br/>";
        $mailBody .= "The URL back to the sales form: For sales rep use only, <strong>Do not give to the customer</strong>.:<br/>";
        $mailBody .= "<span style='font-style: italic;'>Some email clients add special characters to long urls. If the link does not work then copy and paste it into your browser.</span><br/>";
        $mailBody .= "<a href='".$salesUrl."'>".$salesUrl."</a><br/><br/>";

        return ($this->sendEmail($params['repEmail'], $mailSubject, $mailBody));
    } 
```

这是我在电子邮件中收到的 URL，您会注意到 URL 中间的空格“...BhsNKq Jsd_x4...”。即使我发送完全相同的 url，每次都会在不同的地方发生这种情况。为了证明这一点，我在 emailRep 方法中对这个 url 进行了硬编码，没有空格，并多次发送。空间四处移动。

```
http://example.com/admin/index.php?fdJdj9QgFAbgXzPcNJ3AAdbxgotxdk28cNRMjPESW9yihVbKxHR_vaeU7TSZxqSfHDhPX9Jg-lPneu1H9cFHE7yJxUcdfpto_XNxtv6XHkgw_Vk7oy7aFRdnYzONPDltWxV01Zi23glqnU-z91XnpvrnpvNGSXYo4Q0t6UEKUmUp9Sh28JC7Va01Pmaibcc83M8dpCzzKYn5H_rX_BhsNKq Jsd_x4w7e4zHqputSWdc1Uwzezt2LS5xGQJHKxlF98qbzUZMhauxw_k5ebK8YPwDFr776GEb11WPzGtfhjIFE68zL9H2l3FOCFXea5qkHUmO9pCihThlegDLAHamuIeCmTiXSGv8cm_TorL-6q8NnYuvp6nEfpntthgrvx3enkhWP-FJ0P4vYYAvyJ45pbR9slaw9pbPLsnu4d9nNZSuXJZdll2WXJRc2XKYgu0zRvcwuqBSVwuzylQu4ILugxOJCciG7kF1Qx8vjZl5Y8sIqL59dRu9dfnP5yuXJ5dnl2eXJ3crLl7x8lVeoFJWKe1co_uoK_B1eXZFckV2RXaG-fHvazCuWvGKVV84u23DlzZUrVyZXZldmVyZ3K69c8so57z8 
```

这是我在通过电子邮件发送之前用于对 url 参数进行编码/解码的代码。

```
class UrlEncoder {
    function compressUrl($url) {
        return rtrim(strtr(base64_encode(gzdeflate($url, 9)), '+/', '-_'), '=');
    }

    function uncompressUrl($url) {
        $startParams = strrpos($url, "?");

        if($startParams) {
            $paramaterString = substr($url, $startParams);
            $host = substr($url, 0, strrpos($url, "?"));
            $uncompressedParamaters = gzinflate(base64_decode(strtr($paramaterString, '-_', '+/')));
            return $host."?".$uncompressedParamaters;
        } else {
            return NULL;
        }
    }
} 
```

如何防止这个空间？我知道我可以用 bit.ly 之类的东西缩短 URL，但它是一个内部工具。我觉得必须有一种方法可以阻止插入空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T04:12:22.303

谁在他们的头脑中使用 650 个字符长的查询字符串？

我的建议是保存查询字符串服务器端。将其放入带有`AUTO_INCREMENT`字段的数据库中，然后您可以获得它的ID。然后，您可以将 URL 发送为`http://example.com/?email_key=ID_GOES_HERE`更短的 URL。然后只需从数据库中查找查询字符串。

完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:08:24.923

我有你需要的东西，[http://www.9lessons.info/2009/01/split-url-from-sentence-using-php.html](http://www.9lessons.info/2009/01/split-url-from-sentence-using-php.html)。使用 API 创建 tinyurl 链接，数据库中没有任何内容 :)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-20T01:45:37.110

好的，我有同样的问题。我的解决方案是我自己的链接缩小...在数据库中创建新表，其中包含几行，旧脚本中的几行代码以及用于重定向的新页面...这是最短的解释，如果您需要帮助，请询问： )

编辑：

```
 function emailRep() {
    $params = $this->getParamaterArray();
    $shortUrl = $this->getShortUrl();
    $salesUrl = $this->getSalesFormUrl();
/***********************************************************************************/   
    $arr = str_split('QWERTYUIOPLKJHGFDSAZXCVBNM123456789qwertyuioplkjhgfdsazxcvbnm'); // get all the characters into an array
    shuffle($arr); // randomize the array
    $arr = array_slice($arr, 0, 6); // get the first six (random) characters out
    $short = implode('', $arr); // smush them back into a string
    mysql_query("INSERT INTO shortlinks VALUES(NULL, '$salesUrl', '$short')");
/*******************************************************************************************/

    $mailSubject = "Return to the sales order form for ".$params['clientName']." at ".$params['company'].".";

    $mailBody = "The following information is from an order created on, ".date("l, F j, Y \a\t g:i a").",<br/><br/>";
    $mailBody .= "Customer Contact Information:<br/>";
    $mailBody .= "Name: ".$params['clientName'] params['company']."<br/>";
    $mailBody .= "Shortened Url to Send to the Customer:<br/>";
    $mailBody .= ($shortUrl) ? "<a href='".$shortUrl."'>".$shortUrl."</a><br/><br/>" : "There was an error shortening your url.<br/><br/>";
    $mailBody .= "The URL back to the sales form: For sales rep use only, <strong>Do not give to the customer</strong>.:<br/>";
    $mailBody .= "<span style='font-style: italic;'>Some email clients add special characters to long urls. If the link does not work then copy and paste it into your browser.</span><br/>";
    $mailBody .= "<a href='".$short."'>".$short."</a><br/><br/>"; // Rename $salesUrl to $short

    return ($this->sendEmail($params['repEmail'], $mailSubject, $mailBody));
} 
```

并重定向页面：

```
$token=$_GET['token']; // like http://example.com/out.php?token=ahgByT or make it cleaner with htaccess
$qry=mysql_query("SELECT * FROM links WHERE short='$token'");
$arr=mysql_fetch_array($qry);
$out=$arr['long_link'];
header("Location: ".$out);
?> 
```

# c# - 如何遍历两个日期范围并在 ASP.NET 日历中显示？

> ID：13954544
> 
> 赞同：0
> 
> 时间：2012-12-19T14:30:36.197
> 
> 标签：c#, asp.net, calendar

我正在尝试创建一个选择`DateFrom`和`DateTo`

`DateFrom`我需要从to遍历`DateTo`并在日历中显示所有这些日期，到目前为止我的代码只选择`DateFrom`and`DateTo`并将它们作为标签显示在日历中：

```
protected void Calendar1_DayRender(object sender, DayRenderEventArgs e)
{
    foreach (DataRow dr in ds.Tables[0].Rows)
    {
        DateTime df = (DateTime)dr.Field<DateTime?>("DateFrom");
        DateTime dt = (DateTime)dr.Field<DateTime?>("DateTo");

        if (e.Day.Date == dt.Date)
        {
            Label lbl = new Label();
            lbl.BackColor = System.Drawing.Color.Gray;
            lbl.Text = "Booked From";
            e.Cell.Controls.Add(lbl);
         }

        if (e.Day.Date == df.Date)
        {
            Label lbl = new Label();
            lbl.BackColor = System.Drawing.Color.Gray;
            lbl.Text = "Booked To";
            e.Cell.Controls.Add(lbl);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:36:00.950

这是一个简单的解决方案。

```
DateTime temp = df;

while (temp < dateTo)
{
   temp = temp.AddDays(1);
   // do something with inbetween date here...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:40:11.733

不改变你的代码太多我会这样做：

```
protected void Calendar1_DayRender(object sender, DayRenderEventArgs e)
{
  foreach (DataRow dr in ds.Tables[0].Rows)
  {
    DateTime df = (DateTime)dr.Field<DateTime?>("DateFrom");
    DateTime dt = (DateTime)dr.Field<DateTime?>("DateTo");

    if (e.Day.Date == dt.Date)
    {
        Label lbl = new Label();
        lbl.BackColor = System.Drawing.Color.Gray;
        lbl.Text = "Booked From";
        e.Cell.Controls.Add(lbl);
     }

    if (e.Day.Date == df.Date)
    {
        Label lbl = new Label();
        lbl.BackColor = System.Drawing.Color.Gray;
        lbl.Text = "Booked To";
        e.Cell.Controls.Add(lbl);
    }

    //Added Code
    if(e.Day.Date > df.Date && e.Day.Date < dt.Date)
    {
        Label lbl = new Label();
        lbl.BackColor = System.Drawing.Color.Gray;
        lbl.Text = "Day inbetween";
        e.Cell.Controls.Add(lbl);
    }
} 
```

# .net - C# 集合的最大容量在哪里 定义？

> ID：13954546
> 
> 赞同：11
> 
> 时间：2012-12-19T14:30:44.117
> 
> 标签：.net, collections

我尝试向一个Collection中添加大量元素，这些元素每个简单的数据传输对象都有五个基本数据类型的属性，没什么特别的。

在循环中添加新条目时，我总是得到 OutOfMemoryException。有趣的是，在尝试添加第 8388608 个元素（即 8*1024*1024）时，我总是遇到异常。因此，我假设在此类集合中允许的容量（元素数量）方面存在内置限制，但我找不到任何有关它的信息。

这个限制真的存在吗？我在哪里可以找到这个记录？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-19T14:49:39.220

这是一个 OutOfMemoryException，所以这里讨论的不是集合的大小或容量：它是应用程序中的内存使用。诀窍是您不必用尽机器甚至进程中的内存来获取此异常。

我认为正在发生的是你正在填满大对象堆。随着收藏的增长，他们需要在后台添加存储以容纳新项目。一旦分配了新的存储并复制了项目，旧的存储就会被释放并且应该可以进行垃圾回收。

问题是，一旦超过一定大小（过去是 85000 字节，但现在可能不同），垃圾收集器 (GC) 就会使用称为大对象堆 (LOH) 的东西来跟踪您的内存。当 GC 从 LOH 中释放内存时（这种情况开始时很少发生），内存将返回到您的操作系统并可供其他进程使用，但该内存中的*虚拟地址空间*仍将在您自己的进程中使用. 你的程序的地址表中会有一个巨大的漏洞，因为这个漏洞在大对象堆上，它永远不会被压缩或回收。

您在 2 的精确幂中看到此异常的原因是大多数 .Net 集合使用加倍算法来向集合添加存储。它总是会在需要再次加倍的地方抛出，因为在那之前，RAM 已经被分配了。

因此，一个快速的解决方案是利用大多数 .Net 集合中很少使用的功能。如果您查看构造函数重载，大多数集合类型都会有一个允许您在初始构造期间设置容量。此容量不是硬性限制——它只是一个起点——但它在少数情况下很有用，包括当你的集合会变得非常大时。您可以将初始容量设置为淫秽的东西……希望足够大以容纳所有物品，或者至少只需要“加倍”一次或两次。

您可以通过在控制台应用程序中运行以下代码来看到这种效果：

```
var x = new List<int>();
for (long y = 0; y < long.MaxValue; y++)
    x.Add(0); 
```

在我的系统上，这会在 134217728 个项目之后引发 OutOfMemory 异常。134217728 * 每个 int 4 个字节仅（并且确切地说）512MB 的 RAM。它不应该抛出，因为这是该过程中唯一具有任何实际大小的东西，但无论如何它都会因为地址空间丢失给旧版本的集合。

现在让我们更改代码以设置容量，如下所示：

```
var x = new List<int>(134217728 * 2);
for (long y = 0; y < long.MaxValue; y++)
    x.Add(0); 
```

现在我的系统在抛出时一直到 268435456 个项目（1GB 的 RAM），因为它不能将 1GB 翻倍，这要归功于进程使用的其他 ram 吃掉了 2GB 虚拟地址表限制的一部分（即：循环计数器以及来自集合对象和进程本身的任何开销）。

我无法解释的是它不允许我使用 3 作为乘数，即使那只是（！）1.5GB。一个使用不同乘数的小实验试图找出我能得到多大，结果表明这个数字并不一致。在某一时刻，我能够达到 2.6 以上，但后来不得不回落到 2.4 以下。有新发现，我猜。

如果此解决方案确实为您提供了足够的空间，您还[可以使用一个技巧来获得 3GB 的虚拟地址空间](https://stackoverflow.com/questions/464458/how-do-i-create-a-32-bit-net-application-to-use-3-gb-ram)，或者您可以强制您的应用程序编译为 x64 而不是 x86 或 AnyCPU。如果您使用的是基于 2.0 运行时的框架版本（通过 .Net 3.5 的任何版本），您可能会尝试更新到 .Net 4.0 或更高版本，据报道这会更好一些。如果做不到这一点，您将不得不完全重写您如何处理数据，这可能涉及将其保存在磁盘上，并且一次只在内存中保存一个项目或项目的小样本（缓存）。我真的推荐最后一个选项，因为其他任何东西最终都可能会意外再次中断（如果你的数据集一开始就这么大，它也可能会增长）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:34:55.503

在此处查看 Marc 的答案[List<T> 中的最大项目是什么？](https://stackoverflow.com/questions/2009217/whats-the-max-items-in-a-listt).

您可能确实对当前进程有一个 OutOfMemoryException。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T14:33:38.093

`OutOfMemoryException`并不意味着您已经达到了集合中元素数量的硬性限制，这意味着您已经达到了*当前进程中可以保存在内存中的*数据量的硬性限制。

根据可用内存、当前使用的内存等，它会因机器而异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:35:19.960

限制是您可以为集合类设置的容量，很可能`int.MaxValue`是`2147483647`（在您的情况下肯定是）。但是，当您用完内存时，无论您是否达到该硬限制，都会出现 OOM 异常。

# jruby - 设置 jruby min 运行时发生了什么？

> ID：13954548
> 
> 赞同：0
> 
> 时间：2012-12-19T14:30:45.993
> 
> 标签：jruby, tomcat6, warbler

我现在在 Jruby on Rails 上挣扎。我们之前没有配置最小/最大 jruby 运行时，门户运行良好。

这几天，我发现设置这些配置会提高我们门户的性能，所以我决定这样配置：

```
config.webxml.jruby.min.runtimes = 2
config.webxml.jruby.max.runtimes = 4 
```

但是，我设置后我们的门户无法启动，日志继续抛出java类找不到错误：

```
INFO: Info: received max runtimes = 4
Dec 19, 2012 1:57:18 PM org.apache.catalina.core.ApplicationContext log
INFO: Info: received min runtimes = 2
Dec 19, 2012 1:57:18 PM org.apache.catalina.core.ApplicationContext log
INFO: Info: received max runtimes = 4
Dec 19, 2012 1:57:18 PM org.apache.catalina.core.ApplicationContext log
INFO: An exception happened during JRuby-Rack startup
cannot link Java class com.portal.util.selector.SelectorUtil, probable missing dependency: Could not initialize class com.portal.util.selector.SelectorUtil
--- System
jruby 1.6.1 (ruby-1.8.7-p330) (2011-04-12 85838f6) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_35) [linux-amd64-java]
Time: Wed Dec 19 13:57:18 +0000 2012
Server: Apache Tomcat/6.0.35
jruby.home: file:/var/tomcat/webapps/ROOT/WEB-INF/lib/jruby-stdlib-1.6.1.jar!/META-INF/jruby.home 
```

当我们设置这个最小/最大 jruby 运行时有什么区别？任何人都可以让我摆脱这一切吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:53:47.833

[jruby线程安全比较](http://jrubytips.com/posts/3-enable-threadsafe-for-rails)

在配置/warbler.rb

```
config.webxml.jruby.min.runtimes = 1
config.webxml.jruby.max.runtimes = 1 
```

并在 config/environments/production.rb

```
config.threadsafe! 
```

# image - Wordpress media_sideload_image - 下载 http://placekitten.com/100/100?

> ID：13954550
> 
> 赞同：4
> 
> 时间：2012-12-19T14:30:50.457
> 
> 标签：image, wordpress, url-rewriting, download, media

**media_sideload_image**

WordPress 有一个名为[media_sideload_image](http://codex.wordpress.org/Function_Reference/media_sideload_image)的函数。它用于上传图像并将其附加到媒体库。

***我接受这样的图片网址：***

h**p://s.wordpress.org/style/images/wp-header-logo.png

**重写的 URL**

网络上的一些 URL 被重写，例如：

[http://placekitten.com/100/100](http://placekitten.com/100/100)

**错误信息：**

"*抱歉，出于安全原因，不允许使用此文件类型。* "

文件类型是正确的 JPG 文件，但缺少文件扩展名。

**在我的情况下，添加额外的 MIME 类型不起作用**

我试过这个功能，但它对我没有帮助，因为它是未设置的文件扩展名。

```
add_filter('upload_mimes', 'add_custom_upload_mimes');
function add_custom_upload_mimes($existing_mimes){
    $existing_mimes['jpeg'] = 'image/jpeg';
    return $existing_mimes;
} 
```

**问题**

如何上传带有 media_sideload_image 或类似名称的 URL h**p://placekitten.com/100/100 以将图像附加到媒体库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-11-19T20:24:33.670

我昨天读了你的问题，当我需要这个解决方案时。我会在 24 小时后找到答案。

这是完整的解决方案

```
require_once(ABSPATH . 'wp-admin/includes/media.php');
require_once(ABSPATH . 'wp-admin/includes/file.php');
require_once(ABSPATH . 'wp-admin/includes/image.php');

$image_url = "http://domain.com/blog/23092839823";
$image_tmp = download_url($image_url);

    if( is_wp_error( $image_tmp ) ){
        echo "<br> Image Download Fail:";
    }else {
        $image_size = filesize($image_tmp);
        $image_name = basename($image_url) . ".jpg"; // .jpg optional

        //Download complete now upload in your project
        $file = array(
           'name' => $image_name, // ex: wp-header-logo.png
           'type' => 'image/jpg',
           'tmp_name' => $image_tmp,
           'error' => 0,
           'size' => $image_size
        );

        //This image/file will show on media page...
        $thumb_id = media_handle_sideload( $file, $post_id, $desc);
        set_post_thumbnail($post_id, $thumb_id); //optional

        echo "<br> Image Save ";
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T04:07:44.833

深入研究核心，您似乎需要该`unfiltered_upload`功能才能上传没有扩展名的文件：

```
if ( ( !$type || !$ext ) && !current_user_can( 'unfiltered_upload' ) )
    return $upload_error_handler( $file, __( 'Sorry, this file type is not permitted for security reasons.' )); 
```

根据[角色和能力文档](http://codex.wordpress.org/Roles_and_Capabilities)：

> 默认情况下，此功能不适用于任何角色（包括超级管理员）。需要通过定义以下常量来启用该功能：

```
define( 'ALLOW_UNFILTERED_UPLOADS', true ); 
```

> 定义此常量后，单个站点安装上的所有角色都将获得 unfiltered_upload 功能，但只有超级管理员将获得多站点安装上的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-18T12:24:55.717

今天我遇到了同样的问题，并想出了一个有点肮脏但成功的解决方法。事实证明，media_sideload_image 只检查 .jpg（或任何图像）在 url 中的扩展名，所以如果你将它添加到链接的末尾，它应该可以工作。

所以你只需要在 url 的末尾添加一些不会改变输出的东西，例如：

```
http://placekitten.com/100/100?name=image.jpg 
```

我不能说它一直有效，但它在这里有效（已测试）。:)

# magento - 如何在 Magento 中删除特定于登录用户的欢迎消息？

> ID：13954553
> 
> 赞同：1
> 
> 时间：2012-12-19T14:31:12.813
> 
> 标签：magento, header, magento-1.7

我只想显示“欢迎光临！” 一直以来，用于注销和登录的用户。

现在，当用户登录时，它会说“欢迎，名字姓氏！”。此外，当登录并显示此欢迎消息时，会显示另一个链接，“（不是名字姓氏？）”

我想从标题中删除这两件事。

我去了**/app/code/core/Mage/Page/Block/Html/Header.php**并在文件的最后更改了这段代码：

```
public function getWelcome()
{
    if (empty($this->_data['welcome'])) {
        if (Mage::isInstalled() && Mage::getSingleton('customer/session')->isLoggedIn()) {
            $this->_data['welcome'] = Mage::getStoreConfig('design/header/welcome');
        } else {
            $this->_data['welcome'] = Mage::getStoreConfig('design/header/welcome');
        }
    }

    return $this->_data['welcome'];
} 
```

将其更改为：

```
public function getWelcome()
{
    if (empty($this->_data['welcome'])) {
        $this->_data['welcome'] = Mage::getStoreConfig('design/header/welcome');
    }
    return $this->_data['welcome'];
} 
```

我认为这可以解决问题，并且在用户登录时确实如此。但我认为当用户在登录时勾选“记住我 []”时，这会导致消息显示“欢迎，名字姓氏！” 仍然出现。

我现在很茫然，我不知道如何防止这个“欢迎登录用户”和“不是这个用户？” 消息消失 - 我只想要正常的“欢迎来到商店！” **始终**显示的消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:52:58.340

您可以通过以下方式完成此操作：

1）使用CSS隐藏它

在 /skin/frontend/default/[theme]/css/styles.css 中搜索类“.header .welcome-msg”（或添加到文件末尾）

```
.header .welcome-msg {
   display:none;
} 
```

2）从模板文件中删除代码

在 \app\design\frontend\default[主题]\template\page\html\header.phtml

消除

```
<p class="welcome-msg"><?php echo $this->getWelcome()?></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-06T17:03:35.970

另一种方法是查看您的模板文件并将其删除。

在我的模板 app/design/frontend/default/theme/template/page/html/header.phtml 中有以下代码：

```
<div class="block-welcome-header">
 <h2 class="welcome-msg"><?php echo $this->getWelcome() ?> <?php echo $this->getAdditionalHtml() ?></h2>
 <div class="clear"></div>
</div> 
```

要删除“不是名字，姓氏”，我刚刚删除了对 getAdditionalHtml(); 的调用。

```
<div class="block-welcome-header">
   <h2 class="welcome-msg"><?php echo $this->getWelcome() ?> <?php //echo $this->getAdditionalHtml() ?></h2>
   <div class="clear"></div>
</div> 
```

# javascript - 将下一个和上一个按钮添加到 jquery Roundabout

> ID：13954557
> 
> 赞同：0
> 
> 时间：2012-12-19T14:31:25.117
> 
> 标签：javascript, jquery, button

我正在使用 jQuery Roundabout (http://fredhq.com/projects/roundabout/) 来旋转 3 个图像。我不知道如何添加“下一个”和“上一个”按钮来帮助用户旋转图像。目前，如果用户单击图像本身，我将其设置为自动旋转或滑动到下一张图像。但是，我还想添加这些按钮作为辅助导航方式的功能。现有代码中是否有某些内容需要更改才能使其正常工作，还是需要单独的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:53:15.880

得到一个按钮，`next`在你的回旋处给它一个 then 类，设置为下一个按钮的选项。

```
<script>
   $(document).ready(function() {
      $('ul').roundabout({
         btnNext: ".next"
      });
   });
</script> 
```

同样的`btnPrev`

[http://fredhq.com/projects/roundabout/#/api](http://fredhq.com/projects/roundabout/#/api)

# system.reactive - Observable.FromEvent，无法正确获取签名

> ID：13954561
> 
> 赞同：1
> 
> 时间：2012-12-19T14:31:32.983
> 
> 标签：system.reactive

我正在尝试从以下事件创建一个 IObservable：

```
public delegate bool Handle<in T>(T obj, Foo foo);

 event Handle<Bar> Finance; 
```

关于如何正确创建可观察对象的任何建议？

注意，Foo 和 Bar 都不是基于 EventArgs

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:44:45.733

您可以尝试以下方法：

```
public class Test
{
    public delegate void Handle<in T>(T obj, Foo foo);

    public event Handle<Bar> Finance;
}

public static class TestEx
{
    static IObservable<Tuple<Bar, Foo>> WhenFinanceChanged(this Test t)
    {
        return Observable.Create<Tuple<Bar, Foo>>(observer =>
        {
            Test.Handle<Bar> handler = (obj, foo) => observer.OnNext(Tuple.Create<Bar, Foo>(obj, foo));
            t.Finance += handler;
            return Disposable.Create(() => t.Finance -= handler);
        });
    }
} 
```

# javascript - jQuery自动调整下拉宽度

> ID：13954566
> 
> 赞同：1
> 
> 时间：2012-12-19T14:31:38.283
> 
> 标签：javascript, jquery, drop-down-menu, selection, option

因此，我正在通过 jQuery 更新下拉列表中项目的文本。因此，当我单击保存时，它会抓取所选项目并将文本更改为新值。当新值比以前的文本长时，下拉菜单的宽度会正确增加以适应更长的文本。但是，如果所选项目在下拉列表中具有最长的文本并且新值现在更短，则下拉列表的宽度保持不变，而不是减小。那么，有没有办法让它自动调整为下拉列表中最长的文本？

只是为了进一步解释，这里有一个例子：

下拉列表加载为：

```
|Test Item 1     |
|Test Item 222222|
|Test Item 33    | 
```

“测试项目 222222”被保存为“测试项目”，我希望下拉列表看起来像：

```
|Test Item 1 |
|Test Item   |
|Test Item 33| 
```

*编辑 - 添加代码*

```
if ($("input[class~='ButtonPressed']").val() == "Save") {
    // Save the selected item in the dropdown
    var index = $("#Select").get(0).selectedIndex;
    $("#Select option:eq(" + index + ")").text($("#Name").val());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:35:53.210

没有任何 html 或 css 并没有太大帮助，但我建议那些具有文本的元素将显示为块或内联块元素，并且父（容器）元素不会被限制为特定宽度，这样他们可以自动更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:40:42.043

遍历所有选项并计算其文本的宽度。然后你可以采用最宽和最宽的下拉菜单。

你可以使用这个 jQuery 插件来计算文本宽度：

```
$.fn.textWidth = function(){
  var html_org = $(this).html();
  var html_calc = '<span>' + html_org + '</span>';
  $(this).html(html_calc);
  var width = $(this).find('span:first').width();
  $(this).html(html_org);
  return width;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:52:19.617

我已经使用 JSFiddle 尝试过这个，看起来你可能有一些样式应用于你的下拉列表（？）。

看看这个：http: [//jsfiddle.net/XQfmL/](http://jsfiddle.net/XQfmL/)

这是我在 JSFiddle 中使用的代码。

```
<select id="s" size="3">
<option value="aaaaaaaaaaaaaaaaaaaaaa" selected="true">aaaaaaaaaaaaaaaaaaaaaa</option>
<option value="aaa">aaa</option>
<option value="aaaa">aaaa</option>
</select>​
<script>
    //FOR YUI
    YUI().use("node", function(Y){
        var nodes = Y.all("#s option");
        Y.later(2000, nodes.item(0), function(){
            nodes.item(0).set("value","a");
            nodes.item(0).setHTML("a");    
        });
    });

    //FOR JQUERY
    setTimeout(function(){
        $("#s option").eq(0).val("a").html("a");
    }, 2000);​
</script> 
```

2 秒后它会更新，下拉菜单会自动更新它的宽度。

# ruby - FactoryGirl 和 Rails 3.2 错误

> ID：13954570
> 
> 赞同：1
> 
> 时间：2012-12-19T14:31:44.337
> 
> 标签：ruby, ruby-on-rails-3, factory-bot

我在 factory.rb 中有这个：

```
FactoryGirl.create :user do |user|
  user.name "test"
  user.age "40"
end 
```

这在我的测试文件中：

```
require 'spec_helper'

describe "FirstTests" do
    it "creates a user" do
     user=Factory(:user)
    end
end 
```

像往常一样没有任何效果。有人可以解释我为什么会得到这个吗？

```
/usr/local/rvm/gems/ruby-1.9.3-p194/gems/factory_girl-4.1.0/lib/factory_girl/registry.rb:24:in `find': Factory not registered: user (ArgumentError) 
```

一切都在那里。为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:36:23.423

您正在使用`create`而不是`define`

```
FactoryGirl.define do
  factory :user do
    name "test"
    age "40"
  end
end 
```

而`Factory(:user)`不是`FactoryGirl.create(:user)`, 或者更简单`create(:user)`

[https://github.com/thoughtbot/factory_girl/wiki/Usage](https://github.com/thoughtbot/factory_girl/wiki/Usage)

# javascript - jQuery colorbox：如何防止加载指示器小框出现在主要颜色框内容之前？

> ID：13954576
> 
> 赞同：16
> 
> 时间：2012-12-19T14:31:54.450
> 
> 标签：javascript, jquery, colorbox

我正在使用 jQuery colorbox 加载登录表单（通过 ajax）。然而，这个小盒子会显示几秒钟，然后它会淡入我要加载的实际内容。因此，在观察了网站上的几个[颜色框示例](http://www.jacklmoore.com/colorbox/example1/)后，我有点确定这个小框应该是一个预加载框。有什么办法可以让这个框完全不显示？

我尝试过一些愚蠢的事情，比如调整 CSS 和设置`display: none`所有加载项，但它不起作用。

![在此处输入图像描述](../Images/8fd9250502ad6ac388f6b4041e7ecde9.png)

**我想避免任何 CSS hack 并通过修改 javascript 来解决这个问题。** 理想情况下，加载框永远不会出现，因为我不会将颜色框用于任何需要很长时间才能加载的内容。

使用我修改后的颜色框 javascript 和 CSS 在 jsfiddle 上重新创建了问题。ajax 内容不会在那里加载，但我想摆脱的小盒子仍然出现：http: [//jsfiddle.net/hPEXf/](http://jsfiddle.net/hPEXf/)

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T20:16:00.347

正如@op1ekun 所说`ColorBox`，有两个事件对您的情况很有用。

> `onOpen`-> 在 ColorBox 开始打开之前触发的回调。
> 
> `onComplete`-> 显示加载内容后立即触发的回调。

似乎只是使用`display:none`或`$("#colorbox").hide()`不工作来隐藏灯箱。所以我过去常常`opacity`在加载内容时隐藏灯箱。[我已经通过分叉你的http://jsfiddle.net/fDd6v/2/](http://jsfiddle.net/fDd6v/2/)设置了一个 jsfiddle，它在行动中证明了这一点。这是已经使用的代码：

```
$(function(){
    $("#awesome-link").colorbox({
        onOpen: function(){
            $("#colorbox").css("opacity", 0);
        },
        onComplete: function(){
            $("#colorbox").css("opacity", 1);
        }
    });
}); 
```

*   Refrence: [ColorBox - 一个 jQuery 灯箱事件/回调文档](http://www.jacklmoore.com/colorbox#setting-onopen)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:40:57.153

我在 CSS 中更改了以下内容 -

```
#colorbox{border: 1px solid #ebebeb;}    
#cboxContent{background:#fff; overflow:hidden;padding: 20px;} 
```

对此——

```
#colorbox{border: 0px solid #ebebeb;}
#cboxContent{background:#fff; overflow:hidden;padding: 0px; margin: 0px;} 
```

并且该框被隐藏，直到它展开以显示内容。不过，我不确定这是否会损害您的整体风格。您应该能够操纵表单的边距，以便在其周围留出空白。

[http://jsfiddle.net/hPEXf/1/](http://jsfiddle.net/hPEXf/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T19:31:43.300

几天前我在使用 ColorBox，所以我相信我对这个话题很新鲜。您是否考虑过使用内置回调？

具体`onOpen`和`onComplete`？

如果我们使用 Jay 提到的填充解决方案，您可以`0`在 中设置填充`onOpen`并将其设置回`onComplete`.

这似乎是一个干净的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-30T07:37:29.543

我和我一起工作

```
$(function(){
    $("#awesome-link").colorbox({
        onOpen: function(){
            $("#colorbox").css("opacity", 0);
        },
        onComplete: function(){
            $("#colorbox").css("opacity", 1);
        }
    });
}); 
```

`color-box`但是当我使用颜色框的`transition:"fade"`属性时，它会变成黑色淡入淡出然后打开。

现在我改变我的代码`jquery.colorbox.js`

`colorbox js`注释或删除文件中的以下代码

```
 /*var initialWidth = setSize(settings.get('initialWidth'), 'x');
                var initialHeight = setSize(settings.get('initialHeight'), 'y');
                var maxWidth = settings.get('maxWidth');
                var maxHeight = settings.get('maxHeight');

                settings.w = (maxWidth !== false ? Math.min(initialWidth, setSize(maxWidth, 'x')) : initialWidth) - loadedWidth - interfaceWidth;
                settings.h = (maxHeight !== false ? Math.min(initialHeight, setSize(maxHeight, 'y')) : initialHeight) - loadedHeight - interfaceHeight;

                $loaded.css({width:'', height:settings.h});
                */

                /*$loadingOverlay = $([$tag(div, "LoadingOverlay")[0],$tag(div,"LoadingGraphic")[0]]);  */                                                                

                 $slideshow = $tag('button', "Slideshow")/*,
                 $loadingOverlay*/

                 /*  clearTimeout(loadingTimer);
                 $loadingOverlay.hide();*/

                 /* loadingTimer = setTimeout(function () {
                 $loadingOverlay.show();
                  }, 100);*/ 
```

并更改以下代码

```
 overlay.css({
                    opacity: opacity === opacity ? opacity : '',
                    cursor: settings.get('overlayClose') ? 'pointer' : '',
                    visibility: 'visible'
              }).show(500); 
```

到，

```
 setTimeout(function(){     
                 $overlay.css({
                       opacity: opacity === opacity ? opacity : '',
                       cursor: settings.get('overlayClose') ? 'pointer' : '',
                       visibility: 'visible'
                  }).fadeIn(500);
      }, 600); 
```

现在它工作顺利。

# delphi - SerialForms.pas(17)：W1010 方法“创建”隐藏基本类型“TComponent”的虚拟方法

> ID：13954582
> 
> 赞同：4
> 
> 时间：2012-12-19T14:32:01.427
> 
> 标签：delphi, build, constructor, warnings, delphi-xe2

我创建了一个类

```
 FormInfo = class (TComponent)
  private
    FLeftValue : Integer;
    FTopValue : Integer;
    FHeightValue : Integer;
    FWidthValue : Integer;
  public
    constructor Create(
      AOwner : TComponent;
      leftvalue : integer;
      topvalue : integer;
      heightvalue : integer;
      widthvalue : integer);
  protected
    procedure GetChildren(Proc: TGetChildProc; Root: TComponent); override;
    function  GetChildOwner: TComponent; override;
    //procedure SetParentComponent(Value : TComponent); override;
  published
    property LeftValue : Integer read FLeftValue write FLeftValue;
    property TopValue : Integer read FTopValue write FTopValue;
    property HeightValue : Integer read FHeightValue write FHeightValue;
    property WidthValue : Integer read FWidthValue write FWidthValue;
  end; 
```

进一步用于表单序列化。Create 方法具有以下实现

```
constructor FormInfo.Create(AOwner: TComponent; leftvalue, topvalue, heightvalue,
  widthvalue: integer);
begin
  inherited Create(AOwner);

  FLeftValue := leftvalue;
  FTopValue := topvalue;
  FHeightValue := heightvalue;
  FWidthValue := widthvalue;
end; 
```

由于组装，我收到警告

```
[dcc32 Warning] SerialForms.pas(17): W1010 Method 'Create' hides virtual method of base type 'TComponent' 
```

在不丢失应用程序功能的情况下消除此警告需要做什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:39:34.003

Use the `reintroduce` reserved word to indicate the compiler you want to intentionally hide the base class constructor in your class:

```
TMyClass = class (TComponent)
public
  constructor Create(AOwner: TComponent; MyParam: Integer; Other: Boolean); reintroduce; 
```

That way, no warning is shown.

That said, you have to re-think hiding the TComponent.Create constructor. It is a bad idea since the default TComponent.Constructor is called by Delphi to create your component instances at run-time when added to forms/data modules at design time.

TComponent makes the constructor virtual to allow you execute custom code during that process, but you have to stick with the Create firm passing you only the owner, and let the streaming mechanism to deal with the stored values for properties after the creation is complete.

Your component have to support being "unconfigured" if that's the case, or setup default values for it's properties in this *universal* constructor.

You can provide more constructors, with different names, to allow you create instances at run-time from code passing values for the different properties for your convenience.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-02T22:42:16.040

如果您为构造函数使用不同的名称，它可能会更好 - 并且更具可读性，例如

```
constructor FormInfo.CreateWithSize(AOwner: TComponent; leftvalue, topvalue, heightvalue, widthvalue: integer); 
```

# pthreads - 避免分析 pthread 函数

> ID：13954584
> 
> 赞同：1
> 
> 时间：2012-12-19T14:32:10.793
> 
> 标签：pthreads

我正在分析一个使用 pthread 库的多线程应用程序，以获取有关其执行次数最多的基本块 (BBL) 的信息。我遇到的问题是有很多块属于`__pthread_mutex_lock`function，它们不仅在TOP 100执行次数最多的BBL中，而且在TOP 10中。这真的很烦人，因为我对属于pthread库的BBL不感兴趣功能。

我的导师和我猜测忙等待是否与此有关，因为在 MPI 中有一些方法可以将锁的行为从忙等待模式更改为阻塞模式，因此在分析应用程序时，这类 pthread 函数不会出现那么多，甚至没有进入前 10 名。我从未与 MPI 合作过，如果我说的不是很准确，请原谅。

我想在这里问的是，是否有人知道对 pthreads 执行类似操作的方法。更改应用程序的代码不是一种选择，但如果有一个编译旋钮来编译应用程序，来自 -lpthread 的 appart 可以改变它的行为而不是从它的库中获取这么多 BBL，那就太好了。

感谢您的时间。

# php - 以程序方式评估 DateTime::diff 对象

> ID：13954589
> 
> 赞同：2
> 
> 时间：2012-12-19T14:32:27.267
> 
> 标签：php, datetime

我有一个倒计时功能，它（部分）返回“剩余时间”直到给定的日期/时间。该值作为 DateInterval 对象返回，并使用 diff 方法计算。

```
//calculate countdown time
$time_diff = $countdown->diff($current); 
```

鉴于 $time_diff 是 DateInterval 对象，我该怎么做？

```
if ($time_diff > 60) {

    //do stuff

} 
```

我知道上面的代码不起作用，但是我如何/应该评估等效条件（“此 DateInterval 对象中还剩 60 多秒”）？

问题是脚本*用于*将“剩余时间”作为 Unix 时间戳整数返回，并且我系统中的大量脚本以更程序化的方式使用该函数。

提前感谢您提供任何有用的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:41:36.127

您可以从对象中获取单个值：

```
if ($time_diff->s > 60) {

    //do stuff

} 
```

有关属性的完整列表，请参阅[DateInterval 类结构](http://php.net/manual/en/class.dateinterval.php)。但是，我认为您需要查看对象上的每个值（天、分钟、年等），如果您希望总秒数过去，则将它们全部加起来 - 当然在您的用例中（倒数计时器）它可能永远不会超过几秒钟的差异，因此可能没有必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:39:09.417

使用[格式（）](http://php.net/manual/pl/datetime.format.php)。

```
echo $time_diff->format('%R%a days'); //'days' here, you need to change as you want 
```

另见[差异](http://php.net/manual/pl/datetime.diff.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:51:01.213

因为不可能在 DateInterval 对象上使用 format() 方法来直接获取以秒为单位的剩余时间*总量*，所以我最终在我的函数中添加了一个帮助器，以将“剩余时间”作为 Unix 时间戳返回DateInterval 对象。

```
//calculate unix timetamps
$current_ts = time();
$countdown_ts = $countdown->getTimestamp();
$timestamp_diff = ($current_ts < $countdown_ts) ? ($countdown_ts - $current_ts) : 0; 
```

希望这对其他人有用。

PS。Stackoverflow 很棒。

# ios - 使用drawRect延迟加载UIView：绘图

> ID：13954590
> 
> 赞同：0
> 
> 时间：2012-12-19T14:32:30.047
> 
> 标签：ios, uiview, uiscrollview, uikit, lazy-loading

我有一个大的 UIScrollView 和将近 40 个大的 (1000x700) UIViews 放在上面。这些视图中的每一个都有几个带有自定义绘图的子视图。我应该如何延迟加载那些大视图？我查了几种延迟加载的解决方案，但都是指 UIImage 加载，在 UIView 放置后使用 posibility 加载 UIImage。但在我的情况下，即使将大 UIView 添加为子视图也会导致滞后。有什么方法可以让滚动快速并同时延迟加载内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:38:37.843

我会使用 UITableView 而不是 UIScrollView，然后通过 UITableViewDataSource [cellForRowAtIndexPath 添加您的自定义视图：](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDataSource/tableView%3acellForRowAtIndexPath%3a)延迟加载会自然而然地发生。

# ruby-on-rails - 将 activemerchant 与 PayPal Payments Advanced 结合使用

> ID：13954600
> 
> 赞同：0
> 
> 时间：2012-12-19T14:33:03.860
> 
> 标签：ruby-on-rails, paypal, activemerchant

我有一个基于 Rails 2.3.14 和 Ruby 1.8.7 的托管网站。为了获取送货信息以便计算运费，我提供了送货地址表格，然后使用信用卡处理器来处理实际的信用卡输入和授权。PayPal 的 Payments Advanced 正是我想要的。我真的很想使用 activemerchant gem，但我找不到有关使用哪个特定网关或如何使用的信息。github 上有一个 active_merchant 讨论，上面写着“这几乎是 Payflow Link 的抄本”，但我无法将其转换为有用的示例，因为我找到的每个示例都传递了 CC 信息。任何人都可以指出或提供这种使用 activemerchant 的例子吗？

-拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T19:06:17.330

Payments Advanced 基本上是 PayFlow Link，但它使用 PayPal 作为您的商家处理器，而不是第 3 方商家帐户。

因此，您将使用与 PayFlow 链接相同的步骤，并进行一些小的更改。您可以在[此处获取有关 Payments Advanced 的所有信息](https://www.x.com/developers/paypal/development-and-integration-guides#ppa)。

不过，我不知道已经为它开发了任何特定的宝石。

# php - 使用 Youtube API v3 和 PHP 上传文件

> ID：13954601
> 
> 赞同：1
> 
> 时间：2012-12-19T14:33:12.650
> 
> 标签：php, file-upload, youtube-api

我正在尝试使用新的 api v3 将文件上传到 youtube。这就是我要做的...

```
public function upload(){

    if(isset($_FILES['userfile'])) {

        $snippet = new Google_VideoSnippet();

        $snippet->setTitle("Test v3");
        $snippet->setDescription("First upload using api v3");
        $snippet->setTags(array("api","v3"));

        $video = new Google_Video();
        $video->setSnippet($snippet);

            $response = $this->googleapi->youtube->videos->insert(
                "status,snippet",
                $video,
                array('data' => $_FILES['userfile']['tmp_name'])
                );

            var_dump($response);

  }else{
    $this->load->view('youtube');
  }
} 
```

响应为空，因为`io/Google_REST.php`抛出

> 第 70 行的“未定义索引：错误”

这是在 内`decodeHttpResponse()`，

但是，来自实际响应的转储`Google_Client::$io->makeRequest()`返回以下内容...

```
object(Google_HttpRequest)#31 (10) { ["batchHeaders":"Google_HttpRequest":private]=>  
array(4) { ["Content-Type"]=>  string(16) "application/http" ["Content-Transfer-Encoding"]=>
string(6) "binary" ["MIME-Version"]=>  string(3) "1.0" ["Content-Length"]=>  string(0) "" }
["url":protected]=>  string(197) "https://www.googleapis.com/upload/youtube
/v3/videos?part=status%2Csnippet&uploadType=multipart&
key=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" 
["requestMethod":protected]=>  string(4) "POST" ["requestHeaders":protected]=>  
array(3) { ["content-type"]=>  string(37) "multipart/related; boundary=131050532"
["authorization"]=>  string(64) "BearerXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
["content-length"]=> int(254) } ["postBody":protected]=>  string(254) 
"--131050532 Content-Type: application/json; charset=UTF-8 {"snippet":{"tags": 
["api","v3"],"title":"Test v3","description":"First upload using api v3"}} --131050532  
Content-Type: Content-Transfer-Encoding: base64 c2FtcGxlLm1wNA== --131050532--"  
["userAgent":protected]=>  string(44) "Youtube test app google-api-php-client/0.6.0"  
["responseHttpCode":protected]=>  int(500) ["responseHeaders":protected]=>  array(7) {  
["server"]=>  string(61) "HTTP Upload Server Built on Dec 12 2012 15:53:08 (1355356388)"  
["content-type"]=>  string(16) "application/json" ["date"]=>  string(29) "Wed, 19 Dec 2012  
13:03:00 GMT" ["pragma"]=>  string(8) "no-cache" ["expires"]=>  string(29) "Fri, 01 Jan 1990 
00:00:00 GMT" ["cache-control"]=>  string(35) "no-cache, no-store, must-revalidate" ["content-
length"]=>  string(2) "52" } ["responseBody":protected]=>  string(52) "{ "error": { "code": 500, 
"message": null } } " ["accessKey"]=>  NULL } 
```

任何帮助推进这将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-23T20:55:01.833

阅读“这是实际工作！”之间的示例。和“结束工作！”：

```
<?php
@session_start();

if(!isset($_SESSION['google']))
    $_SESSION['google'] = array('state'=> null, 'token'=> null);

#include core google
set_include_path(get_include_path() . PATH_SEPARATOR . '/Google');
require_once  'Google/autoload.php';

$redirectUri = 'http://127.0.0.1/myPathWork/index.php';

##set client:
$client = new Google_Client();
$client->setApplicationName('myAppName');
$client->setClientId('myClientId');
$client->setClientSecret('myClientSecret');
$client->setRedirectUri($redirectUri);
$client->setAccessType('offline');
#important! scopes 
$client->setScopes(array(
                    'https://www.googleapis.com/auth/youtube', 
                    'https://www.googleapis.com/auth/youtubepartner',
                    'https://www.googleapis.com/auth/youtube.upload', 
                )); 

if(isset($_GET['code'])){

    if (strval($_SESSION['google']['state']) !== strval($_GET['state']))
      exit('The session state did not match.');

    $client->authenticate($_GET['code']);
    $_SESSION['google']['token'] = $client->getAccessToken();
    header('location:'. $redirectUri);  
}

if(isset($_SESSION['google']['token']))
    $client->setAccessToken($_SESSION['google']['token']); # este es el key

if ($client->getAccessToken()){
    try {
        #this is the work in action!
        $youtube = new Google_Service_YouTube($client);
        $client->setDefer(true);

        $snippet = new Google_Service_YouTube_VideoSnippet();
        $snippet->setTitle('My Video title');
        $snippet->setDescription('My Video Description');
        $snippet->setTags(array('video upload','youtube v3', 'etc..'));
        $snippet->setCategoryId(22); # view: https://developers.google.com/youtube/v3/docs/videoCategories/list

        $status = new Google_Service_YouTube_VideoStatus();
        $status->setPrivacyStatus('private'); #private, public, unlisted
        $video = new Google_Service_YouTube_Video();
        $video->setSnippet($snippet);
        $video->setStatus($status);
        $chunkSizeBytes = 1 * 1024 * 1024;
        $client->setDefer(true);
        $insertRequest = $youtube->videos->insert("status,snippet", $video);
        $media = new Google_Http_MediaFileUpload($client,$insertRequest,'video/*', null,true,$chunkSizeBytes);

        #file location:
        $media->setFileSize(filesize('/var/www/my/path/video.mp4'));

        #Read the media file and upload it chunk by chunk.
        $status = false;
        $handle = fopen('/var/www/my/path/video.mp4', 'rb');

        while (!$status && !feof($handle)){
          $chunk = fread($handle, $chunkSizeBytes);
          $status = $media->nextChunk($chunk);
          fclose($handle);

           if ($status->status['uploadStatus'] == 'uploaded')
              echo "ok, " . $status['snippet']['title'] . ' - '. $status['id'] . "<hr>";
           else
            echo "error: " . $status['snippet']['title'] . ' - ' . $status['id'] . "<hr>";

            #show more print_r($status['snippet']);
        }

      $client->setDefer(false);
      #end Work!  
    }
    catch (Google_ServiceException $e) {
      exit('Error:' . htmlspecialchars($e->getMessage()));
    }
    catch (Google_Exception $e) {
      exit('Error:' . htmlspecialchars($e->getMessage())); 
    }
    $_SESSION['google']['token'] = $client->getAccessToken();
}
else{
     #GET NEW TOKEN
    $state = mt_rand();
    $client->setState($state);
    $_SESSION['google']['state'] = $state;
    $authUrl = $client->createAuthUrl();    
    header('location:' . $authUrl);
} 
```

# django - Django prefetch_related 和多对多对多关系

> ID：13954602
> 
> 赞同：0
> 
> 时间：2012-12-19T14:33:21.370
> 
> 标签：django, django-models, django-permissions

我有这些模型：

```
class Permission(models.Model):

    name = models.CharField(u'Name', max_length=100)
    codename = models.CharField(u'Code name', max_length=100)

class Role(models.Model):

    name = models.CharField(u'Name', max_length=80)
    organization = models.ForeignKey(Organization)
    permissions = models.ManyToManyField(Permission, blank=True)

class UserProfileManager(models.Manager):

    def get_query_set(self):
        return super(UserProfileManager, self).get_query_set().select_related(
            'user', 'organization'
        )

class UserProfile(models.Model):

    user = models.OneToOneField(User)

    organization = models.ForeignKey(Organization, blank=True)
    roles = models.ManyToManyField(Role, blank=True)
    permissions = models.ManyToManyField(Permission, blank=True)

    objects = UserProfileManager() 
```

我想读取最多 2 个 SELECTS 的所有用户权限（'permissions' 和 'roles__permissions'）。

如果我尝试添加`prefetch_related('permissions', 'roles__permissions')`到 UserProfileManager 我得到 3 个选择（用于权限、角色和角色__权限）

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:19:41.773

阅读这个问题：[A left outer reverse select_related in Django?](https://stackoverflow.com/questions/2975558/a-left-outer-reverse-select-related-in-django)

当时，Django 没有`prefetch_related()`，所以我通过查询最孩子的模型并重新组合结果来解决它，或者使用`{% regroup %}`模板标签，或者在视图中，使用 dicts。

在多对多的情况下，最子级的表是`through`：

```
# one way of optimizing: building a dict accessable by id
# beware to do this in really large tables
permissions = dict([(p.id, p) for p in Permission.objects.all()])

permission_roles = Role.permissions.through.select_related('role').all()
for permission_role in permission_roles:
    # permission_role is an object that associates a role with a permission
    # note that we haven't selected "permission", but permission_id is available:
    role = permission_role.role
    permission = permissions[permission_role.permission_id] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:55:08.620

这些是我的一些辅助功能：

```
class UserProfile(models.Model):

    def get_permissions_user(self):
        if not hasattr(self, '_perm_user_cache'):
            perms = self.permissions.select_related()
            self._perm_user_cache = set([u'%s' % (p.codename) for p in perms])

        return self._perm_user_cache

    def get_permissions_group(self):
        if not hasattr(self, '_perm_group_cache'):
            perms = Permission.objects.filter(role__userprofile = self)
            self._perm_group_cache = set([u'%s' % (p.codename) for p in perms])

        return self._perm_group_cache

    def get_permissions(self):
        if not hasattr(self, '_perm_cache'):
            self._perm_cache = set()
            self._perm_cache.update(self.get_permissions_user())
            self._perm_cache.update(self.get_permissions_group())

        return self._perm_cache 
```

# .net - 如何在 MS Chart 中显示上标文本？

> ID：13954603
> 
> 赞同：1
> 
> 时间：2012-12-19T14:33:22.490
> 
> 标签：.net, c#-4.0, mschart, superscript

我正在我的应用程序中使用`System.Web.UI.DataVisualization.Charting`. 我需要某些文本元素（例如图例）来包含上标文本。

我怎样才能做到这一点？

到目前为止，我已经尝试使用 HTML 标签，但它无法识别它们 - 标签按原样显示。我也找不到任何`bool`允许 HTML 格式字符串的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T18:42:38.170

不幸的是，没有任何内置功能。
唯一的方法是处理 PostPaint 事件并使用一些支持复杂格式的渲染器绘制自己的文本。

例如，您可以使用能够在 Graphics 对象上绘制 html 的[HtmlRenderer 。](http://htmlrenderer.codeplex.com/)

这是一个使用示例：

```
public Form1()
{
    InitializeComponent();

    // subrscribe PostPaint event
    this.chart1.PostPaint += new EventHandler<ChartPaintEventArgs>(chart1_PostPaint);

    // fill the chart with fake data
    var values = Enumerable.Range(0, 10).Select(x => new { X = x, Y = x }).ToList();
    this.chart1.Series.Clear();
    this.chart1.DataSource = values;
    // series name will be replaced
    var series = this.chart1.Series.Add("SERIES NAME"); 
    series.XValueMember = "X";
    series.YValueMembers = "Y";
}

void chart1_PostPaint(object sender, ChartPaintEventArgs e)
{
    var cell = e.ChartElement as LegendCell;
    if (cell != null && cell.CellType == LegendCellType.Text)
    {
        // get coordinate of cell rectangle
        var rect = e.ChartGraphics.GetAbsoluteRectangle(e.Position.ToRectangleF());
        var topLeftCorner = new PointF(rect.Left, rect.Top);
        var size = new SizeF(rect.Width, rect.Height);

        // clear the original text by coloring the rectangle (yellow just to highlight it...)
        e.ChartGraphics.Graphics.FillRectangle(Brushes.Yellow, rect);

        // prepare html text (font family and size copied from Form.Font)
        string html = string.Format(System.Globalization.CultureInfo.InvariantCulture,
            "<div style=\"font-family:{0}; font-size:{1}pt;\">Series <sup>AAA</sup></div>",
            this.Font.FontFamily.Name,
            this.Font.SizeInPoints);

        // call html renderer
        HtmlRenderer.HtmlRender.Render(e.ChartGraphics.Graphics, html, topLeftCorner, size);
    }
} 
```

这是结果的快照：

![在此处输入图像描述](../Images/ad59635fe892c0e2f65e206a658f6ed6.png)

# android - Android：什么时候应该使用 Handler()，什么时候应该使用 Thread？

> ID：13954611
> 
> 赞同：142
> 
> 时间：2012-12-19T14:33:45.953
> 
> 标签：android, multithreading, android-handler

当我需要*异步*运行某些东西时，例如**长时间运行的任务**或使用网络的逻辑，或者出于任何原因，启动一个**新线程**并运行它可以正常工作。创建一个**处理**程序并运行它也可以。有什么不同？我应该什么时候使用每一个？使用 a`Handler`而不是 a的优点/原因是`Thread`什么？

PS。- 为了这个问题，让我们忽略`AsyncTask`. -`Handler().postDelayed`用例对我来说很清楚，为了这个问题，让我们假设我需要立即开始任务。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2012-12-19T14:40:47.817

如果您正在做的任何事情都是“沉重的”，那么您应该在线程中进行。如果您没有在自己的线程中明确启动它，那么它将在主 (UI) 线程上运行，这可能会导致用户界面抖动或响应缓慢。

有趣的是，当您使用线程时，通常还可以使用 Handler 作为您正在启动的工作线程和主线程之间的通信手段。

典型的 Thread/Handler 交互可能如下所示：

```
Handler h = new Handler(){
    @Override
    public void handleMessage(Message msg){
        if(msg.what == 0){
            updateUI();
        }else{
            showErrorDialog();
        }
    }
};

Thread t = new Thread() {
    @Override
    public void run(){
        doSomeWork();
        if(succeed){
            //we can't update the UI from here so we'll signal our handler and it will do it for us.
            h.sendEmptyMessage(0);
        }else{
            h.sendEmptyMessage(1);
        }
    }   
}; 
```

但总的来说，当你在做一些可能长时间运行或非常密集的工作（即任何网络、文件 IO、繁重的算术等）时，你应该使用线程。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2012-12-19T14:48:20.187

Handler 和 Thread 真的是两个不同的东西。

必须创建一个线程来执行长时间运行的作业。

Handler 是在 2 个线程之间进行通信的非常方便的对象（例如：后台线程需要更新 UI。您可以使用 Handler 将一些 Runnable 从后台线程发布到 UI 线程）。

因此，您无法在 Handler 或 Thread 之间进行选择。使用线程做繁重的工作！（如果你的后台线程会触发一些工作在另一个线程中完成，你可以使用处理程序 - 大多数时候是 UI 线程）

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2015-08-03T04:02:32.120

`Handler`和`Thread`是两个不同的东西，但它们并不相互矛盾。您可以同时拥有 a`Handler`和 a `Thread`，实际上每个都`Handler`必须在 a 中运行`Thread`。

有关更多详细信息，您可能需要[查看这篇文章](http://pierrchen.blogspot.com.au/2015/08/android-concurrent-programming-looper.html)。

[![在此处输入图像描述](../Images/861506b2315a2908eb520e202f523b5b.png)](https://i.stack.imgur.com/9XADO.png)

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-12-19T14:40:58.480

A`Handler`在同一个线程上运行`Thread`， a`Thread`在不同的线程上运行。

*如果您需要在同一个线程上运行某些东西*，通常是一个 GUI 元素或类似的东西，请使用处理程序。

*如果您想让主线程自由地做其他事情，请使用线程*。将其用于需要大量时间的任何事情。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-03-17T15:30:27.897

处理程序是后台和 UI 线程之间最好的通信方式。通常处理程序与线程的消息队列相关联，它们用于发送消息并可以运行到消息。

**采用：**

**线程：**在独立（后台）线程中执行任务而不是 UI 线程。（有助于解除对 UI 线程的阻塞）

**Handler**用于在 UI 和 Background 线程之间进行通信。

看看这篇[文章](https://blog.mindorks.com/android-core-looper-handler-and-handlerthread-bd54d69fe91a)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-19T14:41:46.807

> 如果需要从新的线程更新用户界面，则需要与用户界面线程同步。
> 
> 您可以为此使用 android.os.Handler 类或 AsyncTasks 类。
> 
> Handler 类可以更新用户界面。处理程序提供用于接收 Message 或 Runnable 类的实例的方法。
> 
> 您的线程可以通过 sendMessage(Message msg) 方法或 sendEmptyMessage() 方法发布消息。

[...](http://www.vogella.com/articles/AndroidPerformance/article.html)更多关于线程等的信息（包括不同线程和同步机制的教程以及何时使用什么）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-28T13:07:46.773

> 使用处理程序而不是线程的优点/原因是什么？

[处理](https://developer.android.com/reference/android/os/Handler.html)程序允许您发送和处理`Runnable`与线程关联的消息和对象`MessageQueue`。每个`Handler`实例都与单个线程和该线程的消息队列相关联。

当您创建一个 new`Handler`时，它会绑定到创建它的线程的线程/消息队列——从那时起，它会将消息和可运行对象传递到该消息队列并在它们从消息队列中出来时执行它们.

Handler有两个主要用途：

1.  安排消息和*Runnables*在未来某个时间点执行
2.  将要在与您自己的线程不同的线程上执行的操作*排入队列。*

如果你使用 java 线程，你必须自己处理一些事情——与主线程同步、取消线程等。

这个单线程不会创建线程池，除非你使用`ThreadPoolExecutor`或`ExecutorService`API。

（从您对 Blackbelt 答案的评论中获取此查询）

> 为什么不使用执行器？即使我确实想使用 Handler 来做到这一点，怎么办？

参考：[线程性能文章](https://developer.android.com/topic/performance/threads.html)

某些类型的工作可以简化为高度并行的分布式任务。由于这会创建大量的工作包，`AsyncTask`并且`HandlerThread`不是合适的类。的单线程特性`AsyncTask`会将所有线程池工作变成一个线性系统。`HandlerThread`另一方面，使用该类将需要程序员手动管理一组线程之间的负载平衡。

[ThreadPoolExecutor](https://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html)是一个帮助类，使这个过程更容易。此类管理一组线程的创建，设置它们的优先级，并管理工作在这些线程之间的分配方式。随着工作负载的增加或减少，该类会启动或销毁更多线程以适应工作负载。

```
 BlockingQueue workQueue= new LinkedBlockingQueue<Runnable>(100); // Work pool size
 ThreadPoolExecutor executor = new ThreadPoolExecutor(
            Runtime.getRuntime().availableProcessors(),       // Initial pool size
            Runtime.getRuntime().availableProcessors(),       // Max pool size
            1, // KEEP_ALIVE_TIME
            TimeUnit.SECONDS, //  KEEP_ALIVE_TIME_UNIT
            workQueue); 
```

您可以参考这篇关于[create-threadpool](https://developer.android.com/training/multiple-threads/create-threadpool.html)的开发者指南文章了解更多详细信息。

查看这篇文章以了解`Handler`运行多个 Runnable 实例的用法。在这种情况下，所有`Runnable`任务都将在单个线程中运行。

[Android：线程中的吐司](https://stackoverflow.com/questions/3134683/android-toast-in-a-thread/45922317#45922317)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-19T14:43:27.187

`Handler`可以结合使用`Thread`以创建队列机制。您可以使用`handler`发布内容`Thread` `Looper`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-23T02:13:31.187

如果您只需要在主线程之外单独执行一次任务，请使用 Thread. 如果您想重复执行任务，那么 android 提供了一种方法来保持线程处于活动状态并接收消息或 Runnable 对象以使用 MessageQueue 中的 Looper 处理它们。

# c# - 如何将 IntPtr 设置为布尔值

> ID：13954614
> 
> 赞同：5
> 
> 时间：2012-12-19T14:33:51.540
> 
> 标签：c#, pinvoke, marshalling

对于这样编组的函数：

```
/*************************************************
*  DWORD WINAPI WlanHostedNetworkSetProperty(
*      _In_        HANDLE hClientHandle,
*      _In_        _WLAN_HOSTED_NETWORK_OPCODE OpCode,
*      _In_        DWORD dwDataSize,
*      _In_        PVOID pvData,
*      _Out_opt_   P_WLAN_HOSTED_NETWORK_REASON pFailReason,
*      _Reserved_  PVOID pvReserved
*  );
*************************************************/
[DllImport("Wlanapi.dll", SetLastError = true)]
public static extern UInt32 WlanHostedNetworkSetProperty(
    [In] IntPtr hClientHandle,
    [In] _WLAN_HOSTED_NETWORK_OPCODE OpCode,
    [In] UInt32 dwDataSize,
    [In] IntPtr pvData,
    [Out] out _WLAN_HOSTED_NETWORK_REASON pFailReason,
    [In, Out] IntPtr pvReserved
); 
```

微软文档说，当我通过

```
_WLAN_HOSTED_NETWORK_OPCODE._WLAN_HOSTED_NETWORK_OPCODE_enable 
```

作为**OpCode的参数，** **pvData**的值应该是一个指向布尔值的指针。
[这是该函数的文档，](http://msdn.microsoft.com/en-us/library/windows/desktop/dd439495%28v=vs.85%29.aspx)
但我不知道如何让 IntPtr 指向布尔值？
是否应该以与我将指向结构的指针作为**pvData**传递时类似的方式完成：

```
int size = Marshal.SizeOf(settings); //*settings* is a struct with some data
IntPtr pSettings = Marshal.AllocHGlobal(size);
Marshal.StructureToPtr(settings, pSettings, true);

/* use the IntPtr */

Marshal.FreeHGlobal(pSettings); 
```

但相反，我编组布尔值？或者有没有更简单的方法？

感谢所有可爱的人的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:44:38.857

Win32 BOOL 是 DWORD。您可以将 pvData 定义为`ref UInt32`或`ref Int32`针对这种情况。或者将 pvData 保留为 IntPtr，使用 分配非托管内存`Marshal.AllocHGLobal(Marshal.SizeOf(Int32))`，并使用 填充此内存`Marshal.WriteInt32`。

```
int size = Marshal.SizeOf(Int32);
IntPtr pBool = Marshal.AllocHGlobal(size);
Marshal.WriteInt32(pBool, 0, 1); // 最后一个参数 0 (FALSE), 1 (TRUE)

/* 使用 IntPtr */

Marshal.FreeHGlobal(pBool);

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-19T15:51:55.120

哦，是的，有一个更简单的方法。这可以在 C# 中非常优雅地完成，因为它支持方法重载。C 中不存在的功能，因此需要 PVOID 参数类型。您可以简单地将参数声明为`ref bool`. 编组器将在调用本机函数之前为 BOOL 创建存储，并将指针传递给它。将结果转换并复制回调用后传递的 bool 变量。

如果您对该函数有其他需要不同数据类型的调用，则只需重复声明即可。这一次指定，比如说，`ref uint`如果你应该传递一个指向 DWORD 的指针。等等。C# 编译器的方法重载解析功能可确保使用正确的 pinvoke 声明。

# c# - c#、java和objective c的跨平台校验和

> ID：13954615
> 
> 赞同：0
> 
> 时间：2012-12-19T14:33:56.640
> 
> 标签：c#, java, objective-c

我正在寻找一个校验和代码/库，它将在 .net 、 android 和 ios 中给我相同的结果。

现在尝试从网络实现算法或使用不同的库来提供相同的结果失败了

有人有什么有用的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:39:41.227

checksum building is language agnostic.

md5 will be md5

sha512 will be sha512

=> dont look for a 'cross-platform' lib

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:35:41.380

鉴于构建校验和的简单性（如果它不必是安全的），我会自己用所有三种语言编写。

可能正是这种想法使得很难找到恰好产生相同结果的三个实现。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:48:58.027

You could try java.util.zip.CRC32

# android - Android长时间运行的音频采样器

> ID：13954620
> 
> 赞同：0
> 
> 时间：2012-12-19T14:34:20.357
> 
> 标签：android, audio, record, sampling

我想从我的安卓设备的麦克风中采样大约 3 秒的声音。我必须使用的采样率为 48kHz，采用 16 位 pcm 编码。我使用以下代码：

```
AudioRecord recorder = new AudioRecord(AudioSource.MIC, 48000, AudioFormat.CHANNEL_IN_MONO,
                    AudioFormat.ENCODING_PCM_16BIT, bufferSize); 

            if (recorder.getRecordingState() == android.media.AudioRecord.RECORDSTATE_STOPPED)
                recorder.startRecording(); 
            recorder.read(dataBuffer, 0, bufferSize); 
```

现在，我认为在不使用 AudioRecord.getMinBufferSize 的情况下为 AudioRecorder 构造函数提供更大的缓冲区大小可以解决问题。（48000*3=144400 个样本）但是 read() 方法只填充缓冲区直到位置 4096，而不是整个缓冲区。为什么？

我怎样才能做我想做的事？

# internet-explorer - Jquery 发布到另一台服务器在 Internet Explorer 中不起作用

> ID：13954624
> 
> 赞同：0
> 
> 时间：2012-12-19T14:34:38.683
> 
> 标签：internet-explorer, google-chrome, post

我需要从我的 Intranet 的服务器向我的外部网页的服务器发送一个 post 请求。使用 jquery .post 方法我已经能够在 chrome 中做到这一点，但它在 IE 中不起作用。通过研究和测试，我将问题隔离为我将帖子发送到另一台服务器上的页面。有什么办法可以在 IE 中解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:43:07.547

是的，你绝对可以做到。

现代浏览器限制跨域ajax，因为它是一个很大的安全风险。但是有一些方法可以做到这一点。

首先，将包含 ajax 请求的 .js 文件放在要发布数据的服务器上

接下来，将文件包含在您当前的站点中 - 即您要发布的站点，但不要将文件保留在同一域中，而是将其从域链接到您要发布的位置。

使用 js 文件中的代码发出 ajax 请求，您就可以开始了。

*   故事的本质是，为了确保网页将数据发布到该页面所在的域拥有或控制该域的地方，设置了这样的限制。

另一种方法是通过这些指令明确允许跨域ajax，如[this](https://stackoverflow.com/questions/6871021/how-to-enable-cross-domain-request-on-the-server) answer中所述

```
Access-Control-Allow-Origin: http://yourdomain-you-are-connecting-from.com/
on target server 
```

在 php 中：

```
 header("Access-Control-Allow-Origin: http://yourdomain-you-are-connecting-from.com/"); 
```

并在您的 .htacess 文件中添加

```
Header set Access-Control-Allow-Origin: http://yourdomain-you-are-connecting-from.com/ 
```

# java - Creating two Dimensional array with existing arrays in java

> ID：13954627
> 
> 赞同：5
> 
> 时间：2012-12-19T14:34:45.627
> 
> 标签：java, arrays, codenameone

I have four arrays of strings and I would like to create a two dimensional array of 3 columns and dynamic rows.

the arrays are like:

```
String[] first_name;
String[] last_name;
String[] unit;
String[] phone_number;

Object[][] obj = new Object[first_name.length()][3] 
```

My problem is how do I achieve something like this:

```
obj = {first_name[index] + " " + last_name[index], unit[index], phone_number[index]} 
```

Please help out!!!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:43:46.203

I am assuming that by *dynamic rows* you mean that it depends on the number of elements in the `first_name` array.

So you could simply iterate:

```
String[][]obj = new String[first_name.length][3];

for (int i = 0; i < first_name.length; i++)
{
  obj[i][0] = first_name[i] + " " + last_name[i];
  obj[i][1] = unit[i];
  obj[i][2] = phone_number[i];
} 
```

**However**, this approach is not very good. You should consider creating an object for example named `Employee` which as the 3 fields, and then you just have an array of `Employee`

For example:

```
public class Employee
{
  String name;
  String unit;
  String phoneNumber;

  public Employee(String name, String unit, String phoneNumber)
  {
     //... rest of constructor to copy the fields
  }

  //... setters and getters
} 
```

And then you just have:

```
Employee[] employees = new Employee[first_name.length];

for (int i = 0; i < first_name.length; i++)
{
   employees[i] = new Employee(first_name[i] + " " + last_name[i], unit[i], phone_number[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:43:36.673

Would this help?

```
int len = first_name.lenghth();
String[][] arr2d = new String[len][3];
for (int i=0; i < len; i++) {
    arr2d[i][0] = first_name[i] + " " + last_name[i];
    arr2d[i][1] = unit[i];
    arr2d[i][2] = phone_number[i];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:44:46.950

```
String[] first_name = new String[length];
        String[] last_name = new String[length];//length means your length of string
        String[] unit = new String[length];
        String[] phone_number = new String[length];

        Object[][] obj = new Object[first_name.length][3];

        for(int index =0;index<first_name.length;index++){

            obj[index][0] = first_name[index] + " " + last_name[index];
            obj[index][1] = unit[index];
            obj[index][2] = phone_number[index];

        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T14:47:06.073

this could be what you are looking for: (Assume that the four arrays have same length)

```
String[][] result = new String[first_name.length][3]; 
        for(int i =0; i<first_name.length;i++){
            result[i][0]=first_name[i]+" "+last_name[i];
            result[i][1]=unit[i];
            result[i][2]=phone_number[i];
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T16:38:36.240

There are a couple of ways to make 3-D arrays.

I would avoid Object[][], I never like the handling or performance.

Since a 3-D array is just an array of arrays, an easy approach would to use the List data structure. List[] or List> should do the trick. This way you have all the built-ins of a Collection object plus you can also Apache commons, lambdaJ or Guava on top of it.

If you are dead set on using primitive arrays then you could also make a regular 2-D array, [], that can act like a 3-D array, [][].

Here is simple wrapper method I made around a basic array that will function the same as 3-D array.

```
public class MyThreeDArray{
    int MAX_ROW;
    int MAX_COL;
    int[] arr;

    public MyThreeDArray(final int MAX_ROW, final int MAX_COL){
        this.MAX_ROW = MAX_ROW;
        this.MAX_COL = MAX_COL;
        arr = new int[MAX_ROW * MAX_COL];
    }

    private int findIndex(int row, int col) throws IllegalArgumentException{
        if(row < 0 && row >= MAX_ROW ){
            throw new IllegalArgumentException("Invaild row value");
        }

        if(col < 0 && col >= MAX_COL ){
            throw new IllegalArgumentException("Invaild col value");
        }
        return ( row * MAX_COL + col );
    }

    public int get(int row, int col){
        return arr[findIndex(row, col)];
    }

    public void set(int row, int col, int value){
        arr[findIndex(row, col)] = value;
    }
} 
```

Also keep in mind I never tested any of this.

So if you did this with Strings then row 0 might contain the first name values, ... and row 4 could have the unit values.

To retrieve person A's data with this wrapper could make a call similar to this:

```
 String firstName = myWrapper.get(0,0);
    String lastName = myWrapper.get(0,1);
    String phone = myWrapper.get(0,2);
    String unit = myWrapper.get(0,3); 
```

And person B's data would be stored in the second row.

But why try to combine arrays together? You could easy make a POJO called person

```
public class Person{
    String firstName;
    String lastName;
    String phone;
    String unit;

public Person(){}
//ToDo: Getters and Setters
} 
```

This way could just easily add validation and clearly call a specific person without any trouble.

```
 Person[] customers = new Person[5]; 
```

or better yet

```
 List<Person> customers = new ArrayList<Person>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T14:37:34.690

You could create a [List](http://docs.oracle.com/javase/6/docs/api/java/util/List.html) of 1D arrays: `List<String []> arrayList = new ...` Then you can do `arrayList.add(first_name);`

# c# - 尝试从没有权限的位置添加文件时如何处理 UnauthorizedAccessException

> ID：13954630
> 
> 赞同：13
> 
> 时间：2012-12-19T14:35:00.180
> 
> 标签：c#

我正在尝试以这种方式从文件夹中获取所有文件：

```
try
{
    string[] files = Directory.GetFiles(folderBrowserDialog1.SelectedPath, "*.*", SearchOption.AllDirectories);
}
catch (UnauthorizedAccessException)
{
    throw;
} 
```

如果我的根文件夹包含用户无权访问的文件夹，`UnauthorizedAccessException`则会被捕获并且我的数组为空并且所有递归都失败了。

我该如何处理这种情况并确保我的代码在未经许可的情况下忽略位置，但从具有权限的位置添加文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-19T14:42:45.697

请参阅其他帖子上的[SafeFileEnumerator](https://stackoverflow.com/questions/9746538/fastest-safest-file-finding-parsing)。我过去成功地使用了 SafeFileEnumerator 代码。当您根本无法访问单个文件时，它可以防止丢失整个枚举，因此您仍然可以遍历您可以访问的文件。

编辑：我拥有的版本与我链接的版本略有不同，所以让我分享一下我拥有的版本。

```
public static class SafeFileEnumerator
{
    public static IEnumerable<string> EnumerateDirectories(string parentDirectory, string searchPattern, SearchOption searchOpt)
    {
        try
        {
            var directories = Enumerable.Empty<string>();
            if (searchOpt == SearchOption.AllDirectories)
            {
                directories = Directory.EnumerateDirectories(parentDirectory)
                    .SelectMany(x => EnumerateDirectories(x, searchPattern, searchOpt));
            }
            return directories.Concat(Directory.EnumerateDirectories(parentDirectory, searchPattern));
        }
        catch (UnauthorizedAccessException ex)
        {
            return Enumerable.Empty<string>();
        }
    }

    public static IEnumerable<string> EnumerateFiles(string path, string searchPattern, SearchOption searchOpt)
    {
        try
        {
            var dirFiles = Enumerable.Empty<string>();
            if (searchOpt == SearchOption.AllDirectories)
            {
                dirFiles = Directory.EnumerateDirectories(path)
                                    .SelectMany(x => EnumerateFiles(x, searchPattern, searchOpt));
            }
            return dirFiles.Concat(Directory.EnumerateFiles(path, searchPattern));
        }
        catch (UnauthorizedAccessException ex)
        {
            return Enumerable.Empty<string>();
        }
    }
} 
```

示例用法：

```
foreach(string fileName in SafeFileEnumerator.EnumerateFiles(folderPath, "*" + extension, SearchOption.AllDirectories))
{
    //Do something with filename, store into an array or whatever you want to do.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T15:50:37.627

您可以使用 FileSystemInfo 对象和递归来完成此操作：

```
static List<string> files = new List<string>();

static void MyMethod() {
    DirectoryInfo dir = new DirectoryInfo(folderBrowserDialog1.SelectedPath);
    ProcessFolder(dir.GetFileSystemInfos());
}

static void ProcessFolder(IEnumerable<FileSystemInfo> fsi) {
    foreach (FileSystemInfo info in fsi) {

        // We skip reparse points 
        if ((info.Attributes & FileAttributes.ReparsePoint) == FileAttributes.ReparsePoint) {
            Debug.WriteLine("Skipping reparse point '{0}'", info.FullName);
            return;
        }

        if ((info.Attributes & FileAttributes.Directory) == FileAttributes.Directory) {
            // If our FileSystemInfo object is a directory, we call this method again on the
            // new directory.
            try {
                DirectoryInfo dirInfo = (DirectoryInfo)info;
                ProcessFolder(dirInfo.GetFileSystemInfos());
            }
            catch (Exception ex) {
                // Skipping any errors
                // Really, we should catch each type of Exception - 
                // this will catch -any- exception that occurs, 
                // which may not be the behavior we want.
                Debug.WriteLine("{0}", ex.Message);
                break;
            }
        } else {
            // If our FileSystemInfo object isn't a directory, we cast it as a FileInfo object, 
            // make sure it's not null, and add it to the list.
            var file = info as FileInfo;
            if (file != null) {
                files.Add(file.FullName);
            }
        }
    }
} 
```

`MyMethod`获取您选择的路径并使用它创建一个`DirectoryInfo`对象，然后调用该`GetFileSystemInfos()`方法并将其传递给该`ProcessFolder`方法。

该`ProcessFolder`方法查看每个`FileSystemInfo`对象，跳过[重解析点](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365503%28v=vs.85%29.aspx "更多关于重解析点")，如果`FileSystemInfo`对象是目录，则`ProcessFolder`再次调用该方法 - 否则，它将`FileSystemInfo`对象转换为`FileInfo`对象，确保它不为空，然后将文件名添加到列表中。

更多阅读：

*   [文件系统信息类](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.aspx)
*   [DirectoryInfo 类](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)
*   [文件信息类](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)

# graphite - 无法使用 Cubism.js 找到 Graphite 指标

> ID：13954632
> 
> 赞同：3
> 
> 时间：2012-12-19T14:35:04.327
> 
> 标签：graphite, cubism.js

以下命令按预期返回指标：

curl " [http://graphite.metrics:8080/metrics/find?format=completer&query=server](http://graphite.metrics:8080/metrics/find?format=completer&query=server) *.cache"

```
{"metrics": [
  {"is_leaf": "1", "path": "server1200.cache", "name": "cache"},
  {"is_leaf": "1", "path": "server1201.cache", "name": "cache"},
  {"is_leaf": "1", "path": "server1202.cache", "name": "cache"},
  {"is_leaf": "1", "path": "server1203.cache", "name": "cache"}, 
  {"is_leaf": "1", "path": "server1205.cache", "name": "cache"}
 ]
} 
```

如果我使用 Cubism.js 尝试相同的查询，我会得到“无法找到指标”：

```
var context = cubism.context()
                    .serverDelay(60 * 1000) 
                    .step(60 * 1000)
                    .size(1440); 

var graphite = context.graphite("http://graphite.metrics:8080");  
graphite.find("metricXX*", function(error, results){
  alert(error);
}); 
```

如果 Cubism.js 在内部执行相同的请求，为什么找不到指标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T15:22:41.357

毕竟这不是 Cubism.js 的错误。实际上，这是一个跨站点 HTTP 请求。

我在 Chrome 中启用了 Web Developer Extension 并注意到以下消息：

> Access-Control-Allow-Origin 不允许来源

并修复了在 Node.js 中添加以下代码：

```
var server = http.createServer(function (req, res) {

  res.setHeader("Access-Control-Allow-Origin", "*");
  res.setHeader("Access-Control-Allow-Headers", "X-Requested-With");

  proxy.proxyRequest(req, res);
}); 
```

# file - 在 Perl 中，如何避免多次打开文件

> ID：13954641
> 
> 赞同：8
> 
> 时间：2012-12-19T14:35:47.203
> 
> 标签：file, loops, perl

我需要从一个文件中读取，遍历它并将该行写入另一个文件。当行数达到阈值时，关闭输出文件句柄并打开一个新句柄。

每次从输入文件句柄中读取一行时，如何避免打开和关闭输出文件句柄，如下所示？

```
use autodie qw(:all);

my $tot       = 0;
my $postfix   = 'A';
my $threshold = 100;

open my $fip, '<', 'input.txt';
LINE: while (my $line = <$fip>) {
    my $tot += substr( $line, 10, 5 );       
    open my $fop, '>>', 'output_' . $postfix; 
    if ( $tot < $threshold ) {
        print {$fop} $line;
    }
    else {
        $tot = 0;
        $postfix++;
        redo LINE;
    }
    close $fop;
}
close $fip; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T14:39:20.130

仅在更改时重新打开文件`$postfix`。此外，您可以变得更简单一些。

```
use warnings;
use strict;
use autodie qw(:all);

my $tot       = 0;
my $postfix   = 'A';
my $threshold = 100;

open my $fop, '>>', 'output_' . $postfix; 
open my $fip, '<', 'input.txt';
while (my $line = <$fip>) {
    $tot += substr( $line, 10, 5 );       

    if ($tot >= $threshold) {
        $tot = 0;
        $postfix++;
        close $fop;
        open $fop, '>>', 'output_' . $postfix; 
    }
    print {$fop} $line;
}
close $fip;
close $fop; 
```

# tridion-2011 - 在负载均衡场景中使用代理数据库的 Tridion 部署程序配置

> ID：13954645
> 
> 赞同：2
> 
> 时间：2012-12-19T14:36:01.803
> 
> 标签：tridion-2011, tridion-content-delivery

我目前正在将应用程序升级到 Tridion 2011。

我们有两个负载平衡的网络服务器和一个托管代理数据库的数据库服务器。所有内容都存储在代理数据库中，所有页面都本地部署在网络服务器上（Tridion 部署程序安装在网络服务器上）。

因为代理会将内容和元数据写入共享数据库，所以当我们部署到两个网络服务器时会出现错误，因为它们都会尝试存储内容。我知道有几种方法可以解决这个问题..

1.  部署到将内容写入 Broker DB 的一个网络服务器，并使用 ftp 同步将页面和目录复制到第二个网络服务器。
2.  部署到一个网络服务器，让代理将文件写入共享网络磁盘，并将两个网络服务器都指向共享网络磁盘，而不是将文件存储在本地。
3.  部署到两个网络服务器并让它们在单独的数据库上工作。

我想知道 Tridion 2011 是否具有更高级的代理功能来启用我发布到两个网络服务器的场景，但只有一个网络服务器实际将内容*写入*数据库（但都是*读取*），所以我可以使用 1 个代理数据库代替2。

我希望这更清楚一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:55:08.077

Tridion 不是集群服务器，因此无法为您管理高可用性要求。您应该看到与 Tridion 分开的集群，然后思考，如果没有 Tridion，我将如何解决这个问题。

如果您将 Web/应用程序服务器设置为具有某种形式的同步的高可用性（对于文件系统和代理数据库），那么 Tridion 可以只发布到其中一个节点（从技术上讲，它甚至可以在负载均衡器后面）。

如果您不考虑集群软件并且想要一个“穷人”集群，那么您应该使用自己的部署程序和自己的数据库来设置您的 Web/应用程序服务器。然后 Tridion 可以发布到两个节点，所有节点都会自动同步（只要两个节点都在线）。

# java - 如何在android中将日历对象从一个活动发送到另一个活动？

> ID：13954647
> 
> 赞同：5
> 
> 时间：2012-12-19T14:36:13.447
> 
> 标签：java, android

我有一个日历对象，其中包含用户手动存储的一些日期和时间。我希望这个对象可以在下一个活动中使用。

我该怎么做？使用 Parcelable 的 putextra 方法存在差异。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T14:49:55.970

[日历](https://developer.android.com/reference/java/util/Calendar.html)没有实现 Parcelable。

但是，它看起来确实实现了 Serializable，因此您可以将其序列化为字符串并将其作为 Extra 传递给您的其他活动。

您拥有的另一个选项是使用`cal.getTimeInMillis()`它将为您提供一个`long`您可以作为额外内容添加到您的意图的选项。然后你可以把它从另一边拉出来，创建一个新的 Calendar 对象并立即调用`setTimeInMillis()`它，这样它就会被设置为与旧活动中的 Calendar 对象相同的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-10-13T01:05:43.303

cal.getTimeInMillis() 是对的一半。仅 getTimeInMillis() 的问题是您丢失了时区信息。因此，UTC 中的日历变量将在读取该值时转换为本地时区，可能会更改实际日期。

我不知道我是否有完美的答案，但我以毫秒为单位保存了时间和时区 ID，因此我可以在另一侧完全重新创建日历对象。

```
public void writeToParcel(Parcel out, int flags) {
    out.writeLong(mycal.getTimeInMillis());
    out.writeString(mycal.getTimeZone().getID());
}

private MyClassObject(Parcel in) {

    long milliseconds = in.readLong();
    String timezone_id = in.readString();

    mycal = new GregorianCalendar(TimeZone.getTimeZone(timezone_id));
    mycal.setTimeInMillis(milliseconds);

} 
```

out.writeSerializable(); 是一种选择，但我读到它很慢并且表现不佳，所以我选择避免它。

# jquery - 使用 JQuery 选择页面上的最后一个链接

> ID：13954650
> 
> 赞同：0
> 
> 时间：2012-12-19T14:36:24.317
> 
> 标签：jquery, css

我有一个在页脚中有一些链接的 HTML 页面。我需要通过 JQuery 动态更改应用于这些链接的类。例如，我需要将链接类设置为名为“footerToggled”的类。

```
...

<footer>
  <div>  
    <nav>
      <ul>
        <a href="/Site/">Home</a> 
        <a href="/Site/Contact">Contact Us</a> 
        <a href="/Site/About">About Us</a> 
      </ul>
    </nav>
  </div>
</footer> 
```

如何设置应用于我的 pag VIA JQuery 页脚中导航元素内的锚标记的 CSS 类？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:38:44.160

```
$('footer div nav ul a').addClass('footerToggled'); 
```

[http://jsfiddle.net/RQLyh/1/](http://jsfiddle.net/RQLyh/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:37:48.263

```
$('footer nav a').addClass('footerToggled' ) 
```

但是你应该在你的标记中使用类/id，并且顺便使用一个有效的——你需要`<ul>`用`<li>`s 填充你的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:57:50.220

由于您需要***选择页面上的最后一个链接*** 才能使用[.last()](http://api.jquery.com/last/)

要添加一个`css`类，请使用[.addClass()](http://api.jquery.com/addClass/)

所以举个例子

```
$('footer nav a').last().addClass('footerToggled'); 
```

如果您需要设置所有`<a>`in 页脚的样式

```
$('footer a').addClass('footerToggled') 
```

# excel - 将工作簿中的 Excel 工作表另存为 .csv 后，无法返回 .xlsm

> ID：13954651
> 
> 赞同：4
> 
> 时间：2012-12-19T14:36:24.203
> 
> 标签：excel, vba

我有一个包含多张工作表的工作簿。我按下一个（功能区）按钮，一个子例程将多张工作表保存为 .csv，输出一些 java 代码，然后返回。问题是：一旦返回，工作簿已转换为 .csv 文件（最后保存的文件），无法进行进一步的 .xlsm 操作。

我该如何解决？

修正案：

与Java或shell无关。每当我这样做时：

```
Sheets("someSheet").SaveAs Filename:=someName, FileFormat:=xlCSV 
```

这会将整个工作簿更改为 someSheet.csv。然后，工作簿的行为变得奇怪。我无法在不更改所有内容的情况下保存为 .csv。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T18:27:52.823

使用`SaveCopyAs`.

它使您的原始工作簿保持原样并保存一份副本。需要 2007 或更高版本，但既然您提到了应该没问题的功能区按钮。从链接：

```
ActiveWorkbook.SaveCopyAs "C:\TEMP\XXXX.XLS" 
```

[http://msdn.microsoft.com/en-us/library/office/bb178003(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/office/bb178003(v=office.12).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T17:28:11.853

在 Excel 中，该`Save As`操作使用新名称和格式/样式创建工作簿的新副本，然后关闭旧副本。

.csv 文件不支持宏，因此您的工作簿的行为符合设计。

为了在执行 后返回到原始工作簿`Save As`，您需要重新打开原始工作簿，然后关闭新的 .csv 工作簿。

否则，您可以想出一种自定义`Export`方法，将每张工作表上的数据导出到 .csv 文件，但这似乎不必要地复杂。

# java - Eclipse AVD not displaying

> ID：13954653
> 
> 赞同：1
> 
> 时间：2012-12-19T14:36:26.420
> 
> 标签：java, android, eclipse, avd

I'm trying to run through the hello world example for android development. I'm at the point where i click the AVD Manager on the toolbar to choose my device. The first time i clicked it, it came up and displayed but froze when i tried to save a device with my settings. After that, i will click the AVD Manager button and absoultely nothing happens. Does anyone know where i can look to see if eclipse is throwing error code or why this is occuring? I ran it from command line with success, though it was quite slow:

C:\Android_Development\adt-bundle-windows\sdk\tools>android list targets

## Available Android targets:

id: 1 or "android-17" Name: Android 4.2 Type: Platform API level: 17 Revision: 1 Skins: HVGA, QVGA, WQVGA400, WQVGA432, WSVGA, WVGA800 (default), WVGA854, WXGA720, WXGA800, WXGA800-7in ABIs : armeabi-v7a

I'm running Win7 x64 Eclipse 3.8, ADT v21.0.0, java 1.6 (I believe / i can't find which one the hello world is trying to use).

I'm at a loss at why the AVD is not displaying. I can see in the memory manager at the bottom left of eclipse that the memory used increases by 1M every time i click the button, so something is happening...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:00:39.593

嗨，伙计，首先检查您的系统配置是否支持模拟器，因为更高级别的 API 需要可支持的 PC 配置。可能是您的配置不支持 API 级别 17 的某些功能。一旦检查使用较低级别的 API 运行然后你可能会有一些想法。所有最好的伙伴。

# python - 编程实践：一个函数对另一个函数的依赖

> ID：13954654
> 
> 赞同：0
> 
> 时间：2012-12-19T14:36:27.123
> 
> 标签：python

我正在尝试改进我的程序，使其符合良好的编程实践。因此，我正在寻找有关我编写某些东西的方式是否是一种好方法的建议。

我有一个名为 dbfunctions.py 的模块，我在其中定义了：

```
dbparams = {
    'dbname': 'qualitysimparams',
    'tablename': 'qualityparams',
    'tablecols': ('numpeople', 'numreviews', 'prophunters', 
                  'utility_funcform', 'goods'
    ) 
```

和一个功能：

```
def obtainid_ifrecord(dbname, tablename, tablecols, values):
    '''Checks if there already exists a record with given <values>. 
    If so, returns the id of that record, otherwise returns zero.'''
    con, c = connecttodb()
    q1 = "use {0}".format(dbname)
    c.execute(q1)
    q2p1 = "select id from {0} ".format(tablename)
    q2p2 = "where " + " = %s and ".join(tablecols) + " = %s"
    q2 = q2p1 + q2p2    
    c.execute(q2, values)
    res = c.fetchall()
    c.close()
    con.close()
    if res:
        return res[-1][0]
    else:
        return 0 
```

除了上述两个之外，还有其他函数和变量，但与本文无关。

在另一个文件中，我有一个功能：

```
def checkif_paramcomboexists(numpeople, numreviews, prophunters, 
                             utility_funcform, goods):
    '''Check in the database if the simulation has been run with the 
    specified parameters. If so return the id of that run.
    '''
    goodsjson = sjson.dumps(goods)

    # paramvalues: in same order as listed in dbf.dbparams['tablecols']
    paramvalues = (numpeople, numreviews, prophunters, 
                   utility_funcform, goodsjson)

    id = dbf.obtainid_ifrecord(dbf.dbparams['dbname'],
                               dbf.dbparams['tablename'], 
                               dbf.dbparams['tablecols'],
                               paramvalues)
    return id 
```

在我看来， `paramvalues`在函数中的变量中硬编码变量名称`checkif_paramcomboexists`并不是一个好习惯。如果稍后我出于任何原因更改 dbfunctions.dbparams['tablecols'] 中的变量顺序，`checkif_paramcomboexists`函数将失败（并且可能会根据数据类型静默失败）。解决此问题的一种方法是定义：

```
paramvalues = [eval(x) for x in dbf.dbparams['tablecols']] 
```

但是我听说通常使用它是一种不好的做法`eval`（尽管我不知道为什么以及何时可以使用它）。我的问题是：

(i) 就我所关心的问题而言，我编写此代码的方式可以吗？我认为答案是否定的，但只是想在这里与专家核实一下。(ii) 使用`eval`我所指出的可接受的解决方案吗？(iii) 如果对 (ii) 的回答是“否”，有什么替代方案？

感谢您阅读本文。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:43:23.913

这种情况确实需要一个对象。您在 2 个地方复制了关于特定数据库表的本质上的实例信息，因此将这两个函数用于具有属性的某种数据库表接口对象的方法中是有意义的`tablecols`，然后`self.tablecols`在这两种方法中使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T15:38:55.207

你说的硬编码不是很好，[绝对远离`eval`](https://stackoverflow.com/questions/1832940/is-using-eval-in-python-a-bad-practice). 如果您不想使用[`*args`or`**kwargs`](http://www.saltycrane.com/blog/2008/01/how-to-use-args-and-kwargs-in-python/)（顺便说一句，这是更好的选择），您可以使用该[`inspect`](http://docs.python.org/2/library/inspect.html)模块来做您想做的事情。

```
import inspect, collections
def checkif_paramcomboexists(numpeople, numreviews, prophunters, 
                             utility_funcform, goods):

    ...

    temp = inspect.getargvalues(inspect.currentframe())
    args = temp[0]
    valuedict = temp[-1]
    ordered_args_dict = collections.OrderedDict(sorted(valuedict.items(), key=lambda x: args.index(x[0])))
    paramvalues = ordered_args_dict.values()

    ... 
```

基本上，这里发生的事情是为`inspect.getargvalues(inspect.currentframe())`您提供一个对象，其中第一项是参数名称的正确排序列表，最后一项是参数名称和值的字典。然后，我们通过从字典中获取参数名称/值映射并根据列表顺序对其进行排序来创建一个有序字典。

你最终得到的是一个`OrderedDict`具有所有参数及其值的参数，而且它们的顺序也正确。这样，您仍然可以选择按名称（例如，`ordered_args_dict['numpeople']`）来引用它们，但是如果您仍然可以按照您想要的顺序获取所有值`ordered_args_dict.values()`，这将为您提供您正在寻找的输出`paramvalues`：正确排序参数列表，无论名称是什么。

# regex - 用引号将每个匹配的单词括起来

> ID：13954655
> 
> 赞同：1
> 
> 时间：2012-12-19T14:36:35.280
> 
> 标签：regex, notepad++

我在 Notepad++ 中有几行看起来与此类似

```
A8s KQo QTs A9s A9s AJo AJo 99  KQo A5s 
```

我想做的是将每个单词用引号引起来，后面可以用逗号。

我试过匹配`[A-Za-z\d]{2-3}`，但我没有得到任何匹配。

期望的结果：

```
 "A8s", "KQo",  "QTs",  //etc... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:39:26.633

因为在量词中，你需要一个逗号，而不是破折号：

```
[A-Za-z\d]{2,3}
            ^ 
```

否则，您实际上是在匹配 characters `{2-3}`，因此您当前的正则表达式将匹配如下内容：

```
A{2-3} 
```

您可能希望将其包装在捕获组中，如下所示：

```
([A-Za-z\d]{2,3}) 
```

然后将其替换为对捕获的内容的引用，但用引号括起来，类似于：

```
"$1", 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T14:41:47.747

nickb 说的是真的，但您可能需要考虑添加单词边界：

```
\b[A-Za-z0-9]{2,3}\b 
```

否则如果你的输入有更长的词，太喜欢

```
A8s KQo ABCD 1234 
```

你会得到类似的结果

```
"A8s" "KQo" "ABC"D "123"4 
```

单词边界确保您只能匹配整个单词。

# unicode - \n\n\ to break lines in unicode

> ID：13954656
> 
> 赞同：-1
> 
> 时间：2012-12-19T14:36:51.037
> 
> 标签：unicode

I'm using unicode to parse from pyton ,and I'm using \n\n\ to break lines

the parsing is working ok,as I see that the result is with correct breaks lines,

but still in the final html I get the is no line breaking

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:27:01.900

要在 HTML 中创建换行符，请使用`<br>`标记。

# jquery - 在服务器中创建文件后使用 jQuery 下载文件

> ID：13954657
> 
> 赞同：4
> 
> 时间：2012-12-19T14:37:14.233
> 
> 标签：jquery, asp.net, ajax, download

当我单击客户端上的按钮时，我想使用 AJAX 在服务器端调用公共静态 Web 方法。静态方法将创建适当的文件。创建文件后，我需要将其下载到客户端桌面。我找到了[John Culvinar 的 jquery 文件下载插件](http://johnculviner.com/post/2012/03/22/Ajax-like-feature-rich-file-downloads-with-jQuery-File-Download.aspx)，但到目前为止还没有实现它。我知道使用这个插件还需要写一个cookie，这样它就知道下载完成了。我在哪里把这段代码放在服务器端？创建文件后？如果有人可以在这种情况下向我展示一个示例，我会很高兴，也许在[jsfiddle.net](http://www.jsfiddle.net)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:34:19.430

我建议用隐藏的 iframe 替换您的 ajax 请求，然后当您的服务器返回所述文件时，它会自动要求用户下载它。

```
//name of iframe
var strName = ("uploader" + (new Date()).getTime());
// the iframe
var jFrame = $( "<iframe name=\"" + strName + "\" src=\"about:blank\" />" ).css( "display", "none" );

jFrame.load(function( objEvent ){     
    // at this point the user should have been asked to download a file.

    // Remove the iFrame from the document.
    // Because FireFox has some issues with
    // "Infinite thinking", let's put a small
    // delay on the frame removal.
    setTimeout(function(){
        jFrame.remove();
    },100);
});

var form = $('<form>').attr( "action", "upload_act.cfm" )
    .attr( "method", "post" )
    .attr( "enctype", "multipart/form-data" )
    .attr( "encoding", "multipart/form-data" )
    .attr( "target", strName );

form.append('<input type="hidden" name="somename">').val("someval");

$( "body:first" ).append( jFrame, form ); 
```

（以上代码原改编自[http://www.bennadel.com/blog/1244-ColdFusion-jQuery-And-AJAX-File-Upload-Demo.htm](http://www.bennadel.com/blog/1244-ColdFusion-jQuery-And-AJAX-File-Upload-Demo.htm)）

另一种方法是使其成为一个两步过程。第 1 步生成文件并返回一个 url，第 2 步用户单击下载（这将是指向所述 url 的锚标记）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:45:08.090

如果您想使用 jquery 插件来增强用户体验，则无法从服务器启动下载。在这种情况下，最好的办法是在服务器上生成文件并让该方法返回文件的路径。然后只需 dl 使用插件。

例子：

```
$('#btnID').click(function(){
$.ajax({
        type: "POST",
        url: "/your_webmethod_url",
        data: "{'webmethodParam1':'val1','webmethodParam2':'val2'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: fileGenerated,
        error: fileNotGenerated
    });
});

function fileGenerated(data, textStatus, jqXHR){
  //this is the success callback method.  start download automatically using the plugin
  $.fileDownload(data.d); //returned data from webmethod goes in data.d
}
function fileNotGenerated(jqXHR, textStatus, errorThrown){
  //this is the error callback method.  do something to handle the error
  alert(errorThrown);
} 
```

# django - 为什么这个 django formset 没有被提交？

> ID：13954660
> 
> 赞同：0
> 
> 时间：2012-12-19T14:37:23.790
> 
> 标签：django, submit, formset

我有一个表单集如下：

```
EduFormSet = formset_factory(forms.CandidateDegreeForm, can_delete=True)
edu_formset = EduFormSet(prefix='candidate_degree') 
```

在模板中，我正在执行以下操作：

```
{% if edu_formset %}
{% for form in edu_formset %}
    <div class="formset-form" style="visibility: visible;">
        <form id="{{ form.prefix }}" method="POST" action="/degree/add/">
            <h4>Some Heading Here</h4>
            {% csrf_token %}
            {% for field in form %}
                {% include "form_field.html" %}
            {% endfor %}
        </form>
        <script type="text/javascript">
            jQuery(document).ready ( function(){
                jQuery('{{ form.prefix }}').validationEngine();
            });
        </script>
        <div class="clearfix"></div>
    </div>
{% endfor %}
{{ edu_formset.management_form }}
    <div class="button-container right">
        <input class="button" type="submit" value="submit" />
    </div>
{% endif %} 
```

我不知道为什么，但是当我点击提交按钮时什么都没有发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:41:46.233

您的提交按钮不在表单内，因此单击不会触发该操作！

以下是[文档](https://docs.djangoproject.com/en/dev/topics/forms/formsets/#using-more-than-one-formset-in-a-view)向您展示呈现表单集的方式：

```
<form method="post" action="">
    <!-- Notice how the formset (below) and thus its submit button
         is INSIDE the form (above) -->
    {{ formset.management_form }}
    <table>
        {% for form in formset %}
        {{ form }}
        {% endfor %}
    </table>
</form> 
```

您尝试使用`form.prefix`for创建多个表单`id`。这可以工作，但每个表单都必须使用自己的提交按钮呈现。表单集旨在将多种表单合并为一个，并通过所述前缀保证值名称的唯一性。它们将包含在单个表单中并共享任何提交触发器。

# php - 我可以在继续之前等待 PHP 中的 js 进程吗？

> ID：13954663
> 
> 赞同：0
> 
> 时间：2012-12-19T14:37:34.853
> 
> 标签：php, javascript, jquery

我有一个用于注册用户的 PHP 脚本，但在此过程中，我试图调用 Google GEOCoding javascript 方法来返回客户端 lat/lng 并将其记录到数据库，然后再继续我的 PHP 注册过程。

可以这样做还是有更好的方法？

我当前的代码如下所示：

```
private function process() {

    $this->validate();
    $this->register();

    // execute javascript here to record lat/lng coordinates to the DB. 

    $this->goHome();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:48:13.547

你不需要javascript。Google 地理编码 API 是一项网络服务。在 PHP 中，只需执行 a并使用[此处](https://developers.google.com/maps/documentation/geocoding/#GeocodingRequests)[`file_get_contents()`](http://php.net/manual/en/function.file-get-contents.php)所述的正确 url 格式发出请求。然后，您需要通过 PHP 的.[`json_decode()`](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:41:44.737

您不能只在 PHP 脚本中运行 JavaScript。PHP 在服务器上执行，而 JavaScript 在客户端的浏览器中执行。您应该修改您的注册表单，以便在提交表单之前调用 JavaScript，并且您应该传递用户的纬度/经度作为注册的额外数据。然后，当您的 PHP 注册运行时，您将可以访问这些数据。

~~一个更好的主意是找到一个 PHP 库来进行地理编码。~~ 请参阅乔纳森 M 的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:41:34.467

Javascript 是客户端脚本语言 Php 是服务器端

这使您无法按照您想象的方式进行操作。

看看 GeoIP [http://php.net/manual/en/book.geoip.php](http://php.net/manual/en/book.geoip.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:42:41.633

您通常只处理脚本中的一个请求，而您询问的内容至少需要两个：在第一个用户会要求您的服务器做出一些响应，您将能够将您的 JS 发送给他，在第二个请求中他会提交运行该 JS 的结果。

您可以通过某种方式保存“等待响应的状态”，并在地理响应到来时进行处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T14:48:55.480

我认为解决您的问题的最简单方法是使用 2 个 AJAX 调用和一个函数： - 第一个调用 PHP 脚本来进行验证/注册 - 完成后运行客户端 JS 脚本来进行地理编码 - 有另一个 AJAX调用以使用地理编码结果更新数据库

您应该能够以这种方式解决您的问题。如果你使用像 jQuery 这样的库，它很容易进行 AJAX 调用，你甚至可以使用延迟对象，我认为这可以帮助你链接你的调用[http://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T14:50:38.890

在 PHP 中使用 Web API 而不是在服务器端进行 GeoIP 查找。

例如： http: [//www.maxmind.com/en/web_services](http://www.maxmind.com/en/web_services)

他们在这里有一个 PHP 示例（我不会那样调用 web 服务，但它可以工作）： [http ://dev.maxmind.com/geoip/web-services#PHP-11](http://dev.maxmind.com/geoip/web-services#PHP-11)

```
private function process() {

    $this->validate();
    // Do a call to the webservice here with PHP, update user data with the response.
    $this->register();

    $this->goHome();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-19T14:52:35.603

有几种方法可以解决它。

最好的方法是在您的 PHP 中进行地理缓存调用，而不是全部使用 javascript。PHP 有几种从代码发出 HTTP 请求的方法，这些方法将返回您可以在脚本中使用的结果。我个人喜欢 cURL： http: [//php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)。另请参阅 Jonathan M 较早的回复，相同的想法但使用 file_get_contents()。

另一种（更骇人听闻的）方法是使对 Google Geocoding API 的 javascript 调用同步（jquery.ajax() 中的 async=false），并让它通过 ajax 调用上的回调执行您对注册 php 页面的请求。（ajax 上的“成功”属性。）这意味着在地理编码查找完成之前不会调用您的注册页面。这是一个有效的问题，您是否希望根据 ajax 请求的完成来使您的注册成功/失败，但如果您这样做，这将起作用。在此处查看有关 jquery 中同步 ajax 请求的信息：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/). 不过，这确实不是最好的方法。地理编码查找确实是注册的一部分，您要做的最后一件事是让您的 php 注册依赖于不可靠的前端行为。

# sms - sms notification for gmail email message

> ID：13954665
> 
> 赞同：1
> 
> 时间：2012-12-19T14:37:47.640
> 
> 标签：sms, gmail

I am trying to get SMS notification through my phone, whenever I will get email in my gmail account. Is it possible? If so please guide me step by step. Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:41:54.430

你应该试试 ifttt.com。

您的一种选择可能是：[https ://ifttt.com/recipes/11930](https://ifttt.com/recipes/11930)

# c# - Server code that listens for both socket udp and http connections

> ID：13954667
> 
> 赞同：3
> 
> 时间：2012-12-19T14:37:50.330
> 
> 标签：c#, java, apache-flex, blazeds

I am developing a game in Flex.
There are both AIR and Web versions of this game. AIR app would connect to a server using a UDP socket on a port. The purpose of the Web version is to allow users to play when they are at work, or on a computer behind some firewall/proxy that blocks some ports. So the web would connect to a server using http connection on port 80.

The server code answering the http connections would be a java servlet that uses BlazeDS. But if any of you find it more easier to explain for a C# server code(webservices or whatever), it would be ok . The server code answering the UDP requests would be a simple class listening for socket connections.

My problem is I don't know how to put UDP and http code together. If there are 5 AIR clients, and 5 Web clients, they all need to meet in the server in some common collection variable, so that I can update all clients with latest info. Who is going to instantiate the class that listens for sockets? And when?

So to summarize:
1\. Do I need a dedicated server to achieve what I want?
2\. Who will instantiate the udp handling class and when?
3\. Is it even possible to keep the udp handling class and the servlet for http connections together? If there would not be http, I wouldn't even need tomcat. But http and udp code need to stay together, so that I can update the players collection. Is it possible to instantiate the UDP handling class and tell it to listen for socket when the servlet is deployed on the server...or something like that?

Any advices are more then welcome.
Thanks in advance,
Miha

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T10:33:24.553

> http 和 udp 代码需要保持在一起

不，他们没有。它们是游戏数据的传输机制，因此它们应该是透明的。您的 UDP 和 HTTP 服务器应该连接到您的游戏后端，具体方式取决于您。它可以在内存中，直接从您的后端代码使用 HTTP 和 UDP（套接字）模块，或者它可以使用某种服务（因此您可以让其他通道与同一后端通信）。

此游戏后端不直接连接到用户，而只与 UDP 和 HTTP 模块对话。

然后从这个后端处理从 HTTP 和 UDP 收到的消息，并通过同一通道发送响应。

例子：

1.  AIR-client 1 向 UDP 服务器发送一个有效的登录消息。
2.  UDP 服务器将登录消息转发到游戏后端。
3.  游戏后端向 UDP 服务器返回成功结果消息
4.  UDP 服务器将结果消息转发给 AIR-client 1。

示例 2：

1.  现在，恰好已经登录的 HTTP 客户端 1 请求所有当前登录的用户。它通过 HTTP 向 HTTP 服务器请求。
2.  HTTP 服务器将此请求转发到游戏后端。
3.  游戏后端向 HTTP 服务器返回信息
4.  HTTP 服务器向客户端返回响应。

# java - 为方法调用调整 Builder 模式

> ID：13954672
> 
> 赞同：7
> 
> 时间：2012-12-19T14:38:01.157
> 
> 标签：java, design-patterns, methods, builder, effective-java

这是试图理解第 40 项的一部分：从 Effective Java 2nd Edition**仔细设计方法签名。**

提高方法签名可读性的建议之一是针对四个或更少的参数。建议使用多种技术管理较长的参数列表，其中一种技术如下：

> 第三种结合前两种技术的技术是将 Builder 模式（第 2 项）从对象构造调整到方法调用。如果您有一个带有许多参数的方法，特别是如果其中一些参数是可选的，那么定义一个表示所有参数的对象并允许客户端对该对象进行多次“setter”调用会很有好处，每个它设置一个参数或一个小的相关组。一旦设置了所需的参数，客户端就会调用对象的“执行”方法，该方法对参数进行任何最终有效性检查并执行实际计算。

我熟悉 Builder 模式，因为它用于对象构造，但不确定我是否正确理解如何使其适应方法调用。

到目前为止，这是我所拥有的：（
我试图改进该方法的方法调用`move`）

```
public class Space {

    public static class Builder {
        // Required parameters
        private final int x;
        private final int y;
        private final int z;

        // optional params
        private long time = 0;

        public Builder(int x, int y, int z) {
            this.x = x;
            this.y = y;
            this.z = z;
        }

        public Builder time(long val) {
            time = val;
            return this;
        }

        public void move() {
            if (x == 0 || y == 0 || z == 0) {
                throw new IllegalArgumentException("Cannot move to the centre of the universe");
            }

            // Do the actual work here
        }
    }

//  public void move(int x, int y, int z, long time) {
//      // Do the work here
//  }

    public static void main(String[] args) {
        new Builder(1, 1, -1).time(1234).move();
    }
} 
```

我对 Joshua Bloch 建议的解释是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T00:34:26.167

在我看来，您的构建器类与父类相关联（例如与[非静态内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)），并且客户端会像这样使用它：

```
Space space = new Space();
...
Space.MoveBuilder moveBuilder = space.new MoveBuilder(1, 1, -1);
moveBuilder.setTime(1234);
moveBuilder.execute(); 
```

它可以通过使用流利的构建器和工厂方法进一步简化：

```
space.startMove(1, 1, -1).withTime(1234).endMove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T01:42:35.970

我已经使用在要实例化的类中定义的接口对 Builder 模式进行了具体化。

有关此内容和相关“双向构建器”的更多信息，请参见此处：[http ://www.javaworld.com/javaworld/jw-01-2004/jw-0102-toolbox.html?page=3](http://www.javaworld.com/javaworld/jw-01-2004/jw-0102-toolbox.html?page=3)

我会做类似以下的事情；虽然这对于 3 个必填字段来说可能是多余的，但它对于构造更大的对象同时考虑每个必填字段非常有帮助。

```
public Class Space
{    
    public interface Builder
    {
        public Space build();
        public int x();
        public int y();
        public int z();
    }

    // Build a complete Space object accounting for every field. 
    public Space(Space.Builder spaceBuilder)
    {
        this.x = spaceBuilder.x();
        this.y = spaceBuilder.y();
        this.z = spaceBuilder.z();
        this.time = builder.time();
    }

    // Might not be necessar if you update time when you update x, y, and z
     public Builder time(long val)
     {
            time = val;
            return this;
     }

     public void move()
     {
        // ...
     }

    public static void main(String[] args)
    {
        new Builder()
        {   
            @Override
            public Space build(){ return new Space(this);}

            @Override
            public int x(){ return 1;}

            @Override
            public int y{ return 1;}

            @Override int z{ return -1;}
        }.build().time(1234).move();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-12T12:18:12.117

我创建了[Java 方法调用构建器](https://github.com/tomasbjerre/java-method-invocation-builder)，它在编译时生成调用方法的构建器。它还增加了对 Java 中方法参数的默认值的支持。

它可以用于类或接口。通过向类型添加`@GenerateMethodInvocationBuilder`和`@Default`注释。

```
@GenerateMethodInvocationBuilder
public interface BitBucketServerService {
 @GET("/rest/api/1.0/projects/{projectkey}/repos/{repositoryslug}/pull-requests?direction={direction}&at={at}&state={state}&order={order}&withattributes={withattributes}&withproperties={withproperties}")
 Call<BitbucketServerResponse<BitBucketServerPullRequest>> pullRequests(//
   @Default("PROJ") @Query("projectkey") String projectKey,//
   @Default("REPO") @Query("repositoryslug") String repositoryslug,//
   @Default("INCOMING") @Query("direction") String direction,//
   @Default("23") @Query("at") String at,//
   @Default("OPEN") @Query("state") String state,//
   @Default("NEWEST") @Query("order") String order,//
   @Default("true") @Query("withattributes") String withattributes,//
   @Default("true") @Query("withproperties") String withproperties);
} 
```

然后，编译代码时将生成一个构建器，您可以使用默认参数调用它：

```
BitBucketServerServicePullRequestsBuilder.pullRequests()
 .invoke(bitBucketServerService); 
```

或设置您喜欢的任何参数：

```
BitBucketServerServicePullRequestsBuilder.pullRequests()
 .withAt("24")
 .invoke(bitBucketServerService); 
```

更多关于 GitHub：[https ://github.com/tomasbjerre/java-method-invocation-builder](https://github.com/tomasbjerre/java-method-invocation-builder)

# javascript - Changing the node value using javascript on xforms:submit event does not reflect into the model instance

> ID：13954673
> 
> 赞同：1
> 
> 时间：2012-12-19T14:38:09.280
> 
> 标签：javascript, orbeon, xforms

xforms:submit event is raised before the submission happens and any changes to node values before submission can be achieved.

I have tried doing this, i could see the value is getting changed on the browser, but the saved node still have the old data. Any idea on this.

```
<xforms:submission id="save-instance" ref="instance('form-instance')" 
    action="{instance('temp-instance')/submit-url}" method="post" validate="false" replace="none">

    <xforms:action ev:observer="save-instance" ev:event="xforms-submit">
        <xforms:message level="modal" value="'About to Submit'" />
        <xxforms:script>
            ORBEON.xforms.Document.setValue("location-of-dda-id-a", 'Test3');
        </xxforms:script>
    </xforms:action>

    <xforms:action ev:observer="save-instance" ev:event="xforms-submit-done">
        <xforms:message level="modal" ref="instance('metaData')/save-success-msg" />
    </xforms:action>
    <xforms:message ev:event="xforms-submit-error" level="modal" ref="instance('metaData')/save-error-msg" />
</xforms:submission> 
```

And the id `location-of-dda-id-a` is the id given for an input field.

Basically, i wanted to replace the special characters that are copied and pasted from MS documents. Below is the Js function that can achieve this.

```
var specialChars = [/\u0011/g, /\u0012/g, /\u0013/g, /\u0014/g, /\u0016/g, /\u2018/g, /\u2019/g, /\u201c/g, /\u201d/g, /\u2026/g, /\u2013/g, /\u2219/g, /\u2022/g,/\u00BF/g];
var specialCharsReplacement = ["", "", "", "", "", "'", "'", "\"", "\"", "...","-","-","-","?"];

function replaceSpecialChars(formName) 
{
    for(i = 0; i < formName.elements.length; i++) 
    {
        if (formName.elements[i].type == 'textarea' || formName.elements[i].type=='text')
        {        
            var commentText = formName.elements[i].value;
            if(commentText != 0) 
            {          
                for(j = 0; j < specialChars.length; j++) 
                {
                    commentText = commentText.replace(specialChars[j], specialCharsReplacement[j]);
                }               
                formName.elements[i].value = commentText;
            }
        }
    }

} 
```

And the line

```
formName.elements[i].value = commentText; 
```

should be replaced with

```
ORBEON.xforms.Document.setValue(formName.elements[i].id.split("\$")[0], commentText); 
```

But it is not working.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T18:30:02.980

这是一个棘手的问题：您可以正确地说`xforms-submit`操作在提交完成之前运行，但这发生在服务器上，并且在服务器`xxforms:script`上执行其他所有操作之后运行在浏览器上。所以在使用的时候需要注意一些`xxforms:script`。

在这种情况下，最好使用 an`xforms:setvalue`而不是`xxforms:script`设置值。（一般来说，最好离开`xxforms:script`XForms 中无法完成的事情。）

# java - Java 小程序在 Azure 中不起作用

> ID：13954674
> 
> 赞同：7
> 
> 时间：2012-12-19T14:38:10.527
> 
> 标签：java, azure, applet, azure-web-roles, japplet

我构建了一个简单的 Java 小程序，可以在本地完美运行。当我将我的网站上传到 Azure（作为云服务）时，它会显示一个**灰色框**。

我尝试过 Win XP、Win 7、JRE 6、JRE 7 和不同的浏览器。Java 控制台不显示任何消息。

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:46:26.250

您是否检查过该小程序是否是从 Azure 网站下载的？

最好的方法是在 Chrome 中使用网络控制台或在 Firefox 中使用 Firebug，然后查看所有请求和服务器响应。如果任何资源出现问题，该项目将变为红色。您将能够检查响应错误代码。

Azure IIS 上的文件类型配置可能存在一个小问题，因此您的小程序不由服务器提供服务。

为了更改 Azure IIS，您可能需要添加配置更改，如下所示：

```
<configuration>
    <system.webServer>
        <staticContent>
            <remove fileExtension=".class" />
            <mimeMap fileExtension=".class" mimeType="application/x-java-applet" />
        </staticContent>
    </system.webServer>
</configuration> 
```

**编辑**

我检查了您提供的 URL，发现您正在尝试使用小程序标记属性和 JNLP 参数部署 Java 插件小程序。

我看到JNLP路径设置如下：（`jnlp_href: basePath + "launch.jnlp"`是`basePath`）`"/Content/WorldWindApplet/dist/"`。

但我无法`launch.jnlp`从以下路径加载：`/Content/WorldWindApplet/dist/launch.jnlp`.

请检查 launch.jnlp 是否位于`/Content/WorldWindApplet/dist/`. 如果存在，则尝试将 JNPL 映射添加到 IIS。

代码片段如下：

```
<configuration>
    <system.webServer>
        <staticContent>
            <remove fileExtension=".jnlp" />
            <mimeMap fileExtension=".jnlp" mimeType="application/x-java-jnlp-file" />
        </staticContent>
    </system.webServer>
</configuration> 
```

# excel - loading csv "Could not find installable ISAM"

> ID：13954677
> 
> 赞同：2
> 
> 时间：2012-12-19T14:38:17.673
> 
> 标签：excel, vba, csv, oledb

Im building a program in Excel VBA to automate a process and I require data stored in a csv file to be imported. So, I'm trying to use a query table to import specific columns in a csv file.

Im using ADO to interface with the csv file using the Jet Provider OLE DB. In the connection string I have specified the provider, data source, and extended properties. Im using windows xp and office 2003, so my Excel version is 8.0\. I specified the provider as Microsoft.Jet.OLEDB.4.0\. My code is pasted below. When the code executes I get the error "Could not find installable ISAM" at the last line that I included in the below code. I cant find anything wrong with the syntax so I was wondering if this error could be because I dont have the correct version of Jet installed? Please see code below. Thanks

```
Sub Excel_QueryTable()

Dim oCn As ADODB.Connection
Dim oRS As ADODB.Recordset
Dim ConnString As String
Dim SQL As String

Dim qt As QueryTable

ConnString = "Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=C:\testfile.csv;" & _
    "Extended Properties=Excel 8.0;HDR=Yes; FMT=Delimited; IMEX=1"","

Set oCn = New ADODB.Connection
oCn.ConnectionString = ConnString
oCn.Open 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:52:57.237

尝试这个：

```
ConnString = "Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=C:\directory\where\csv\file\is\;" & _
    "Extended Properties=""text;HDR=Yes;FMT=Delimited""" 
```

我认为您不想使用“Excel 8.0”部分，但实际上并没有连接到 Excel 工作表；您正在连接到一个文本文件。另外，你有多余的空格，而且连接字符串对这些真的很挑剔，所以我删除了它们。

请注意，您可以在此处设置分隔符：

```
HKLM\SOFTWARE\Microsoft\Jet\4.0\Engines\Text\Format 
```

我的目前是`CSVDelimited`；其他选项是`TabDelimited`和`Delimited(;)`

我在以下位置找到了此信息： http: [//www.connectionstrings.com/textfile](http://www.connectionstrings.com/textfile)

**- 编辑 -**

您实际上不是指向特定的 .csv 文件，而是将数据源指向*目标目录*。请注意我上面在连接字符串中所做的更改：文件名已被删除，路径现在以`\`.

为了使用这种类型的数据源，您实际上需要教驱动程序如何布置文件。您可以[通过使用 schema.ini 文件来](http://msdn.microsoft.com/en-us/library/ms709353.aspx)做到这一点。

您可以通过以下两种方式之一创建 .ini 文件：

*   在记事本中手动编辑文件，使用上面的链接提供用法。
*   使用 ODBC 数据源管理器中内置的工具。

为了使用该工具，您需要实际执行创建数据源的步骤。您实际上并不需要数据源，但据我所知，这是访问 create schema.ini 创建工具的唯一方法。

到那里：

*   转到 ODBC 控制面板。
*   添加新的 DSN，输入：Microsoft Text Driver (*.txt, *.csv)，点击 Finish
*   在“ODBC 文本设置”上，取消选中`Use Current Directory`并选择文件所在的目录。
*   单击选项按钮，然后单击`Define Format`按钮。
*   单击您要使用的文件，然后单击“猜测”开始，然后根据需要细化数据类型。
*   完成后，单击“确定”，您应该`schema.ini`会在 .csv 文件所在的目录中看到一个文件。在记事本中打开它，并确保它看起来正确。

上面的连接字符串现在应该可以正常工作了，只使用 csv 所在的目录，而不是 .csv 的完整路径。

# powershell - Powershell Invoke-sqlcmd keeping connection open and trying to reuse it

> ID：13954678
> 
> 赞同：5
> 
> 时间：2012-12-19T14:38:17.620
> 
> 标签：powershell, sql-server-2008-r2

I have a Powershell script that uses `invoke-sqlcmd` to apply scripts to a series of development databases. I loop through a list of scripts and compare it to the current release level of the database and then apply the required scripts to get the DB to the release level it needs to be at. Certain databases are reference databases and are in a READ_ONLY state. I connect to those database run an alter DB script setting them to READ_WRITE apply the script then change the back to READ_ONLY. Overall the script works well, the issue is it looks like when PowerShell first opens a connection to the database and applies the first script and then goes to alter the DB back to READ_ONLY the database has objects locked. I've traced it back to the previous connection and a Shared_Transaction_Workspace lock (sys.dm_tran_locks) for what looks to be the previous powershell connection. Why is this connection still open after the `invoke-sqlcmd` has completed and is there anything I can do about it? Can I force `invoke-sqlcmd` to use a new connection for each invocation of the cmdlet?

I have tried a messy fix killing the offending connection and then retrying the connection but I think there is something better.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2018-06-28T19:50:40.460

我一直这样做，它似乎工作：

```
[System.Data.SqlClient.SqlConnection]::ClearAllPools() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-16T22:35:11.877

好吧，我知道这是一个非常古老的帖子，微软的人告诉他们解决了这个问题（正如大卫布拉班特提到的文章所说），但也许我不是最幸运的人，必须采取一种解决方法才能让它发生.

即使运行 Microsoft SQL Server 2012 (SP1) - 11.0.3128.0 (X64) 我也遇到了同样的问题，经过一些研究后，我找到了一种从 Invoke-Sqlcmd 获取一些参数作为输出的方法，这样我就可以获得当前的会话 ID使用来自 SQL Server 的内置 @@SPID 全局变量的用户进程并与 ADO.NET 建立连接以执行 KILL 子句以关闭打开的连接。

# 所以让我们来看看在我的案例中应用的解决方法

```
#Invoke the Invoke-Sqlcmd to execute an script from a file
Invoke-Sqlcmd -Server "[SERVER_NAME]" -Database [DATABASE_NAME] -Username [USER] -Password [PASSWORD] -InputFile [DOT_SQL_FILE_PATH]
#Invoke the Invoke-Sqlcmd to execute a inline SQL statement to get the SessionID as a Powershell variable
$SQLSession = Invoke-Sqlcmd -Server "[SERVER_NAME]" -Database [DATABASE_NAME] -Username [USER] -Password [PASSWORD] -query "select @@spid as SessionID"
# Build query to execute KILL clause
$DbQuery = "KILL " + $SQLSession.SessionID;

# Create SQL connection with ADO.NET
$DbConnection = New-Object System.Data.SqlClient.SqlConnection
$DbConnectionString = "Server = [SERVER_NAME]; Database = [DATABASE_NAME]; User ID=[USER]; Password=[PASSWORD];"
$DbConnection.ConnectionString = $DbConnectionString
$DbConnection.Open()

# Create SQL command for KILL clause
$DbCommand = New-Object System.Data.SQLClient.SQLCommand  
$DbCommand.Connection = $DbConnection 
$DbCommand.CommandText = $DbQuery 

# Execute KILL clause
$DbCommand.ExecuteNonQuery()

# Close connection
$DbConnection.Close() 
```

我希望它有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-14T19:40:52.710

即使我使用的是最新版本的 SSMS（版本 16.5.3 - Build 13.0.16106.4），我仍然遇到这个问题。我还没有弄清楚强制关闭连接的“正确”方法是什么，但我有一个简单的解决方法，可以为我解决问题。如果您只需要从数据库中获取连接，您可以执行以下操作：

1.  运行正常命令

    ```
    Invoke-Sqlcmd -ServerInstance "SOME_SERVER" -Database "SOME_DB" ... 
    ```

2.  当您准备好从数据库中消除连接时：

    ```
    Invoke-Sqlcmd -ServerInstance "SOME_SERVER" -Database "SOME_DB" -Query "use [master];" 
    ```

这会将连接切换到主连接，从而将其从感兴趣的数据库中删除。如果您绝对需要关闭连接，我认为您需要求助于 SqlClient 等。

# javascript - 是否可以使用 javascript 撤销对移动文件系统的访问？

> ID：13954681
> 
> 赞同：0
> 
> 时间：2012-12-19T14:38:20.617
> 
> 标签：javascript, mobile, filesystems, capture

我想阻止用户访问他们自己的文件系统，即。移动设备上的相机胶卷和视频。迫使他们捕捉现场媒体。这可能吗？如果是这样，我将如何实施？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:41:22.857

在支持 HTML5 的设备上，您可以使用（如果支持）`userMedia`API。

这是[一个很好的教程](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)，可以帮助您入门。

基本上，你可以这样做：

```
<input type="file" accept="image/*;capture=camera"> <!-- Submit a new photo -->
<input type="file" accept="video/*;capture=camcorder"> <!-- Submit a new video -->
<input type="file" accept="audio/*;capture=microphone"> <!-- Submit a new audio track using the microphone --> 
```

就像我说的，这只有**在受支持**的情况下才有效。目前，即使是 iOS6 下的设备也*部分*支持该`userMedia`API。

如果您的设备支持 API，但不支持`accept="image/*;capture=camera" ...`等等，您可以编写自己的按钮来做同样的事情。

```
<input type="button" id="newStream" value="Click me!">
<script>
    // Following code adapted from the tutorial, not tested
    document.getElementById('newStream').addEventListener('click', function(event){
        // Not showing vendor prefixes or code that works cross-browser.
        navigator.getUserMedia({video: true}, function(stream){
            // Do something with stream or window.URL.createObjectURL(stream);
            alert('Success!');
        }, function(){ alert('Failed!'); });
    });
</script> 
```

# jqgrid - jqGrid displaying different sizes although code is similar

> ID：13954683
> 
> 赞同：0
> 
> 时间：2012-12-19T14:38:25.743
> 
> 标签：jqgrid, width

I am working on a jqGrid for two different but similar searches on a site. The idea is to have two different divs on a popup window. One that has search fields and the other that displays the results. The functionality is fine, but the aesthetics are bugging me a little bit. For one thing the grid comes up as a different size in one. I use very similar code for both pop up windows however...

```
<div>
    <div id="searchPatient" class="float-left">

        <ul>
            <li><a href="#searchByMRN">Search By MRN</a></li>
            <li><a href="#searchByDemographics">Search By Demo</a></li>
            @*<li><a href="#retTable">Return Table</a></li>*@
        </ul>
        @Html.Partial("_SearchByMRN")
        @Html.Partial("_SearchByDemographic")
        @*@Html.Partial("_RetTable")*@
    </div>
    <div class="content-wrapper clear-fix float-left" style="height: 1px; padding: 10px;">
        Search For Patient Return Results
        <table id="list" class="scroll"></table>
    </div>    
    <div id="resultDiv" style="float: right; clear:both">
    </div>
</div>

$(document).ready(function () {
    $("#list").jqGrid({
        shrinkToFit: false,
        autowidth: true,
        datatype: 'jsonstring',
        mtype: 'POST',
        colNames: [
                    'Last Name',
                    'First Name',
                    'DOB',
                    'Gender',
                    'EMPIID',
                    'MedipacId',
                    'EPCID'
                    ],
        colModel: [
                    { name: 'Last_Name', width: 115, align: 'left' },
                    { name: 'First_Name', width: 115, align: 'left' },
                    { name: 'DOB', width: 115, align: 'left' },
                    { name: 'GENDER', width: 115, align: 'left' },
                    { name: 'EMPIID', width: 115, align: 'left' },
                    { name: 'medipacId', width: 145, align: 'left' },
                    { name: 'EPCID', width: 145, align: 'left' }
                ],
                ...//unnecessary settings and what-not
)};
)}; 
```

That code sets up this window...

![enter image description here](../Images/84092c75f790e5a4a3d9964a8ab2d635.png)

```
<div>
    <div id="searchEncounter" class="float-left">
    @using (Html.BeginForm("searchEncounterByCriteria", "SearchEncounter", new { popId = popId }, FormMethod.Post, new { id = "SearchPatID" })) {    
            <ul>
                <li>First Name</li>@Html.TextBox("fNameTB", null, new { id = "fNameTB" })
                <li>Last Name</li>@Html.TextBox("lNameTB", null, new { id = "lNameTB" })
                <li>MRN</li>@Html.TextBox("MRN", null, new { id = "MRN" })
                <li>Hospital Fin</li>@Html.TextBox("HospFin", null, new { id = "HospFin" })
            </ul>
        <br />
        <p><input id="sPat" type="submit" value="search For This Patient" class="button" style="float: left; width:auto"/></p>    
    }
    </div>
    <div class="content-wrapper clear-fix float-left"  style="height: 1px; padding: 10px;">
        Search For Encounter Return Results
        <table id="list" class="scroll"></table>
    </div>
    <div id="resultDivSE" style="float: right; clear:both">
    </div>
</div>

    $(document).ready(function () {
        $("#list").jqGrid({
                        shrinkToFit: false,
                        autowidth: true,
                        datatype: 'jsonstring',
                        mtype: 'POST',
                        colNames: [
                                   'MRN',
                                   'Hospital Fin',
                                   'First Name',
                                   'Last Name',
                                   'Date of birth',
                                   'Completed Pathway',
                                   'Completed Pathway Reason',
                                   'PCP Appointment',
                                   'Specialist Appointment',
                                   'Admit Date'
                                   ],
                        colModel: [
                                   { name: 'MRN', width: 125, align: 'left' },
                                   { name: 'Hospital_Fin', width: 145, align: 'left' },
                                   { name: 'First_Name', width: 115, align: 'left' },
                                   { name: 'Last_Name', width: 115, align: 'left' },
                                   { name: 'Date_of_birth', width: 145, align: 'left' },
                                   { name: 'Completed_Pathway', width: 125, align: 'left' },
                                   { name: 'Completed_Pathway_Reason', width: 165, align: 'left' },
                                   { name: 'PCP_Appointment', width: 115, align: 'left' },
                                   { name: 'Specialist_Appointment', width: 125, align: 'left' },
                                   { name: 'Admit_Date', width: 185, align: 'left' }],
                                   ...//superfluous settings that have nothing to do with Grid...
)};
)}; 
```

That code sets up this window...

Now when debugging using chrome I find out that the widths are being set. How they are doing it I don't know. I do know that the element.style {} is being set to

```
element.style {
width: 870px;
} 
```

In the second case... And in the first case it is being set too...

```
element.style {
width: 340px;
} 
```

The actual code says

```
<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_list" dir="ltr" style="width: 870px;"> 
```

in the second case and

```
<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_list" dir="ltr" style="width: 340px;"> 
```

In the first case.
I am not sure why this is occuring and how to change it? What is determining how the width is being set? Any ideas or advice on how to set widths more consistently? I want the first grid to be as wide as the second one.

Thanks ![enter image description here](../Images/ecbec81a9babc8014a0c2aba0eaabff5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:51:57.187

如果您将两个网格的 div 设置为`autowidth: true`，则网格应扩展为父元素的宽度。在这种情况下，如果两个网格的父元素相同，则网格的宽度应该相同。

另一个混乱的选择是你可以在第一个网格中指定你的列宽度加起来等于第二个网格的宽度。

作为参考，您可以检查 [http://www.trirand.com/jqgridwiki/doku.php?id=wiki:options上的 autowidth 属性](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:options)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:51:08.523

尝试完全删除`searchPatient`和`searchEncounter`div，看看是否有变化。如果是，它们内部的一些差异会影响包含结果网格的兄弟 div。

# java - 从 Mule 中的 VM 队列中读取以在 EmailingService 中发送电子邮件

> ID：13954694
> 
> 赞同：1
> 
> 时间：2012-12-19T14:39:12.010
> 
> 标签：java, web-services, jakarta-ee, queue, mule

我正在开发一个宁静的网络服务，该网络服务的目的是根据传入的请求发送电子邮件。

我们决定使用 Mule 来实现这一点。我们在 mule 中定义了一个流，它接受请求（POST），然后将其写入队列。然后会有另一个流从这个队列中读取，然后使用 sendmail 或任何其他 java 邮件 api 发送消息。

我负责创建一个从队列中读取然后发送电子邮件的流。下面是将消息写入队列的 mule_config.xml 流程：

```
 <!-- This is the persistent VM connector -->
   <vm:connector name="mailQueueConnector" queueTimeout="1000">
         <vm:queue-profile>
        <file-queue-store />
         </vm:queue-profile>
   </vm:connector>

    <flow name="MailService">
        <https:inbound-endpoint address="https://localhost:71234/message/email"
            method="POST"
            exchange-pattern="request-response"
            contentType="application/xml"/>

        <vm:outbound-endpoint path="mailQueue" connector-ref="mailQueueConnector">
            <message-property-filter pattern="http.status=200" />
            <logger message="INTO mailQueue" level="INFO"/>
        </vm:outbound-endpoint>
        <response>
            <message-property-filter pattern="http.status=200" />
            <script:transformer>
                <script:script engine="groovy">
                    <script:text>
                        import groovy.xml.*
                        def writer = new StringWriter()
                        def xml = new MarkupBuilder(writer)
                        xml.ApiMessage {
                            returnCode("200")
                            reason("Queued Succesfully!!!")
                        }
                        return writer.toString()
                    </script:text>
                </script:script>
            </script:transformer>
        </response>
    </flow> 
```

从上面我可以看到，命中入站端点“https://localhost:71234/message/email”的 POST 电子邮件请求被写入队列“mailQueue”。但是对于我的任务，我如何阅读队列中的电子邮件并将其序列化为电子邮件对象，以便我可以在 java 中编写代码来发送该电子邮件？我假设我必须为此编写一个新流程。我对吗？任何人都可以在这里为我指出正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:12:58.013

使用以下命令创建新流程：

*   A`vm:inbound-endpoint`消耗`mailQueue`路径。
*   可选的变压器来准备邮件正文。
*   `smtp:outbound-endpoint`发送电子邮件消息的一个，使用 MEL 表达式来表示其不同的属性（收件人、主题...）。

编辑 - OP 现在希望可以通过 HTTP 从外部和内部访问流。添加了一个复合源来做到这一点：

```
<flow name="emailer">
    <composite-source>
        <https:inbound-endpoint address="localhost:71234/message/sendEmail"
            method="POST" exchange-pattern="request-response"
            contentType="application/xml" />
        <vm:inbound-endpoint path="mailQueue"
            connector-ref="mailQueueConnector">
    </composite-source>
    <!-- Add transformers here if needed -->
    <smtp:outbound-endpoint ... />
</flow> 
```

# c# - 应如何配置 windbg 以解决 Microsoft 报告（在 Visual Studio 2008 中创建）

> ID：13954703
> 
> 赞同：3
> 
> 时间：2012-12-19T14:39:47.810
> 
> 标签：c#, visual-studio-2008, windbg

我在 Visual Studio 的输出窗口中有一个生成错误的报告。

在调用 ReportViewer 的实例之前，我尝试将 windbg 挂接到其中，这样我就可以检查数据的存储区域，尤其是数据源中的列名称与记录集中返回的数据。

我已经加载了额外的部分，如下所示：

```
.load C:\debug\psscor2\psscor2\amd64\psscor2.dll
.load C:\debug\psscor2\psscor2\amd64\wow64exts.dll 
```

我还设置了符号的路径。

当以这种方式设置 windbg 时，如何定位感兴趣的 ReportViewer 线程并查看其结构和数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T16:53:24.850

您问的是一个非常笼统的问题，因此很难给出具体的答案，但这里有几点可以帮助您入门。

如果这是一个 32 位进程，您应该获取 32 位版本的 Windows 调试工具并改用它。

此外，如果您将 psscor2.dll 放在 sos.dll 旁边（即在 .NET 框架路径中），您可以这样做

```
.loadby psscor2 mscorwks 
```

（如果您使用的是 .NET 4 或更高版本，请替换`mscorwks`为）。`clr`

这将从与 mscorwks.dll 相同的位置获取 psscor2。（此外，psscor 目前不适用于 .NET 4.5，因此在这种情况下，您需要改用 sos.dll）。

为了检查对象，您需要在堆上定位它们。该`!dumpheap -stat`命令将为您提供整个堆的概览。您可以使用`!dumpheap -mt <MT of type>`转储特定类型的对象。`!name2ee`您可以使用命令找到给定类型的 MT 。

一旦你在堆上获得了单个对象的位置，你可以使用`!do`(DumpObject) 命令来检查这些。

# visual-studio-2010 - 表名“tblStudent”无效。表名为空或空；或表名包含关键字 SET、FMTONLY 和 OFF

> ID：13954706
> 
> 赞同：0
> 
> 时间：2012-12-19T14:39:59.733
> 
> 标签：visual-studio-2010, wcf, sql-server-2008-r2, sql-server-ce

我正在使用 VS2010、SQL Server CE、SQL Server 2008 R2、WCF。

我创建了一个示例，`*.sdf`使用 WCF 将 125 个表从本地文件同步到服务器数据库。

如果 WCF 托管在我的本地计算机上，它工作正常，但是当我将它托管在远程服务器上时，它会引发以下错误：

> *表名“tblStudent”无效。这可能是由以下一个或多个问题引起的： 无法找到指定 SyncTable 的 SyncAdapter；表名为空或空；或表名包含关键字 SET、FMTONLY 和 OFF。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:57:13.697

我猜当 WCF 托管在另一台计算机上时，您没有连接到正确的 SQL Server CE 实例。您的连接字符串是什么，您确定要访问 Windows CE 的远程实例并且该实例接受外部连接吗？

# javascript - Firefox 中的 event.srcElement.sourceIndex 和 document.all[ ]

> ID：13954711
> 
> 赞同：0
> 
> 时间：2012-12-19T14:40:14.330
> 
> 标签：javascript, jquery

我正在尝试使遗留系统也可以在 Firefox 上运行。它只适用于IE，所以我在这里问你event.srcElement.sourceIndex如何在FF上工作？我知道 FF 中的 event.srcElement 是 event.target，但在目标中我没有 sourceIndex 属性。我还需要将 window.document.all[ ] 替换为适用于 FF 的内容。实际代码如下：

```
var index = event.srcElement.sourceIndex;
window.document.getElementById('txtElementId').value = window.document.all[index - 1].id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-08-25T10:44:22.420

我知道这是一个老问题，但我最近遇到了一个类似的问题，在那里我找到了一个解决方案，所以我想我会在这里发布它以备不时之需。

```
var index = Array.from(document.all).indexOf(event.srcElement);
window.document.getElementById('txtElementId').value = document.all[index - 1].id; 
```

document.all 结合 indexOf 的性能可能会很慢，但就我而言，我没有注意到任何严重的性能问题。这是您应该注意的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:22:33.500

不要依赖仅存在于特定浏览器上的功能。这就是为什么使用 jQuery 很好，它的目标是它给你的任何属性。如果它仅存在于 Firefox 中，请尝试找到另一个要使用的属性，该属性存在于所有浏览器中，而不是依赖 FF 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:09:16.563

假设你的元素有 id，你可以使用 jQuery 做这样的事情

```
$('#id').index('*') 
```

如果他们不这样做，您可以临时添加一个类/ID，并在完成后删除

```
$(event.srcElement).attr('id','myId');
console.log($('#myId').index('*'));
$('#myId').attr('id',''); 
```

# php - PHP静态函数创建并返回一个对象或创建一个对象，并在其上调用一个函数

> ID：13954713
> 
> 赞同：0
> 
> 时间：2012-12-19T14:40:21.367
> 
> 标签：php

请问这种方法

```
 foreach($data as &$d)
       $obj[]=ClassName::createObject($data); 
```

或者

```
 foreach($data as &$d){
       $obj[] = new ClassName;
       $obj[end($obj)]->loadData($data);
     } 
```

-

```
 class ClassName{
        public static function createObject($data){
              $obj = new ClassName;
              //do stuff with $data
              return $obj;
        }

        public function loadData($data){
              //do stuff with $data;

        }

     } 
```

::createObject 方法使代码阅读起来不那么痛苦，而第二种方法不必返回巨大的对象。我不确定如何用 PHP 之类的语言处理变量，所以性能上有很大差异吗？哪种方法最好使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:44:50.693

首先看起来还可以。在这种情况下，您不需要`$d`通过引用传递。也许你想要`ClassName::createObject($d)`。我仍然会将其重构为：

```
foreach($data as $d) {
   $obj[]=new ClassName($d);
} 
```

这只是丑陋，不是出于性能原因：

```
foreach($data as &$d){
   $obj[] = new ClassName;
   $obj[end($obj)]->loadData($data);
 } 
```

相反，您可以这样做：

```
foreach($data as &$d){
   $object = new ClassName;
   $object->loadData($d);
   $obj[] = $object;
 } 
```

如果数据对对象至关重要 - 从构造中设置它。如果数据是可选的，那么该`loadData`方法是有意义的。但是，如果您想将构造逻辑移动到静态方法 - 这是没有意义的。没有性能优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:44:40.770

静态方法没有任何优势。作为静态的工厂方法在功能上与 new 关键字（也是静态的）相同。你建议它保存一行代码，但如果你总是需要在构造对象后调用 ->loadData() ，那么你应该将数据传递给构造函数：

```
$obj = new ClassName($data); 
```

在这种情况下使用静态方法调用并不能解决任何问题，只会增加复杂性/膨胀。

# java - 使用服务器“不兼容的魔法值 1013478509”启动 java 小程序失败

> ID：13954714
> 
> 赞同：3
> 
> 时间：2012-12-19T14:40:21.500
> 
> 标签：java, applet, servlet-3.0

我的小程序有问题。我有一个学校项目，我应该在其中制作一个乒乓球在线游戏。它离线运行良好，但是当我尝试从服务器加载它时，我只得到一个带有红色文本的空框架。当我单击文本时，我收到消息：

> 不兼容的魔法值 1013478509

我正在使用 jetty-all-8.1.8.v20121106.jar 和 servlet-api-3.0.jar

启动服务器的类如下所示：

```
public class TheServer extends HttpServlet {
    private static final long serialVersionUID = 1L; 
    private Scanner sc;
    private String webSite;
    private PrintWriter out;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.setContentType("text/html; charset=UTF-8");
        resp.setStatus(HttpServletResponse.SC_OK);
        out = resp.getWriter();

        sc = new Scanner(new File("F:\\Users\\Johan\\Workspace Kurs 5\\PongOnline\\bin\\pong.html"));
        webSite = "";
        while(sc.hasNext())
            webSite += sc.nextLine();
        sc.close();

        out.println(webSite);
        System.out.println(webSite);
    }

    public static void main(String...args) throws Exception {
        ServletContextHandler context = new ServletContextHandler( ServletContextHandler.SESSIONS);
        context.addServlet(TheServer.class, "/");

        Server server = new Server(666);
        server.setHandler(context);
        server.start();
        server.join();
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T14:45:38.170

有效 Java 类的神奇值是`0xCAFEBABE`（的十六进制值`3405691582`），即前 4 个字节。但是你得到`0x3C68746D`（的十六进制值） ，`1013478509`它又代表 ASCII 字符`<`,`h`和. 要自己查看，请运行以下代码：`t``m`

```
int magic = 1013478509;
ByteBuffer b = ByteBuffer.allocate(4);
b.putInt(magic);
System.out.println(new String(b.array())); 
```

这与网站提供的小程序相结合表明它是一个`<html>`标签的开始，而这反过来又表明它是一个 HTML 文档。

因此，对 applet 的 HTTP 请求显然*实际上*返回了一个 HTML 文档。当您将浏览器地址栏中的当前请求 URI 更改为指向小程序的 URL 时，您应该能够自己看到它。然后，您将看到浏览器在尝试下载小程序时*实际检索到的内容。*也许它是一个 HTML 页面风格的简单 HTTP 404 错误文档。

要修复它，只需确保`<applet>`or`<object>`标记中的 URL 正确。它与您在浏览器地址栏中看到的当前请求 URL 相关。servlet 的工作方式很奇怪。您正在从部署文件夹外部流式传输 HTML 文件。这表明小程序也在部署文件夹之外，因此根本无法通过有效的 URL 访问。您应该将 HTML 页面和小程序都放在 web 内容文件夹中。这样你就不再需要那个servlet了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:43:52.257

这意味着您有一个`.class`扩展名为不是类的文件。所有课程都必须以幻数开头`0xCAFEBABE`

“类”的前四个字节读取

```
System.out.println(new String(BigInteger.valueOf(1013478509).toByteArray())); 
```

印刷

```
<htm 
```

所以我怀疑这是一个 HTML 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T14:44:44.567

根据 [Java 语言规范](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html)，正确的`.class`文件以*幻数*开头：

> 魔术项提供标识类文件格式的魔术数字；它的值是 0xCAFEBABE。

如果您`.class`使用十六进制编辑器打开任何已编译的文件并检查其第一个字节，它们应该是`0xCAFEBABE`. `1013478509`在 ASCII 中转换为`<htm`.

确保您已在服务器上正确编译了该类。正如 BalusC 在他的回答中已经指出的那样，更有可能的是，确保 URL 是正确的。`<htm`您获得的... 字节可能是服务器提供的 HTML 错误文档。

# c# - 泛型、可空、类型推断和函数签名冲突

> ID：13954717
> 
> 赞同：5
> 
> 时间：2012-12-19T14:40:44.207
> 
> 标签：c#, generics, asynchronous, nullable, method-signature

我有这个代码：

```
public async static Task<T?> RequestValue1<T>(Command requestCommand)
                    where T : struct 
{
    // Whatever
}

public async static Task<T> RequestValue2<T>(Command requestCommand)
                    where T : class 
{
    // Whatever
} 
```

我想为我的两种方法使用相同的名称。**这甚至可能吗？**

*我的问题：*

*   我必须编写两种不同的方法，因为返回类型（如果请求失败，我希望它为 null，如果请求成功，我希望它为值），即`Nullable<T>`if`T`是值类型，`T`if的实例`T`是引用类型。
*   `async`不允许引用/输出，因此如果没有 type 的方法参数`T`，则不会推断，并且我的两个方法不能具有相同的名称（签名冲突，因为如果不推断`T`，通用约束不适用于签名冲突解决）`T`

目前这段代码有效，但我不喜欢“RequestValue1”和“RequestValue2”之间的这个奇怪的函数调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:53:35.937

您可以创建自己的`Option`类型并使用它来指示是否返回值：

```
public async static Task<Option<T>> RequestValue<T>(Command requestCommand) {
  ...
} 
```

**更新**：该`Option<T>`类型的目的是替换`null`s 和`Nullable<T>`s，但如果您仍想使用它们，可以使用这些扩展方法来弥补差距：

```
public static class OptionExtensions {
  public static T? GetNullableValue<T>(this Option<T> option) where T : struct {
    return option.HasValue ? (T?)option.Value : null;
  }
  public static T GetValueOrNull<T>(this Option<T> option) where T : class {
    return option.HasValue ? option.Value : null;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:01:40.177

您可以删除约束，并让调用者将`Nullable<T>`类型传递给您的方法（即 call`RequestValue<int?>(cmd)`而不是`RequestValue<int>(cmd)`）。您可以在运行时确保可空性，如下所示：

```
public async static Task<T> RequestValue<T>(object arg) {
    var t = typeof (T);
    if (!t.IsClass && (!t.IsGenericType || t.GetGenericTypeDefinition() != typeof(Nullable<>))) {
        throw new ArgumentException("T");
    }
    // Whatever
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:29:38.927

一个可以有方法签名，如：

```
 static void test1<T>(Nullable<T> param) where T:struct;
    static void test1<T>(T param) where T:class; 
```

没有冲突。尝试传递不可为空的结构类型将失败，但编译器在给定可空类型或类类型的参数的情况下选择重载没有问题。

您的情况有点不同，因为您没有传递特定类型的参数；你只是想传递类型本身。如果没有该类型的实际参数，编译器将无法确定 a`Nullable<T>`比另一种更适合一种方法。我的倾向是提供一种方法，该方法使用结果的无效性以外的其他方式来指示成功或失败。正常`Try`模式如下所示：

```
static bool RequestValue1<T>(Command requestCommand, out Task<T> Result); 
```

我不是特别喜欢这种模式，因为不可能`Result`协变或参与类型推断。另一种选择是：

```
static Task<T> RequestValue1<T>(Command requestCommand, out bool Success); 
```

这样的形式在协方差方面没有问题。另一种形式是：

```
static Task<T> RequestValue1<T>(Command requestCommand, out ResultStatus Status); 
```

其中 ResultStatus 将是一个类型，其`Succeeded`方法`True`在成功的情况下返回，但可能有其他成员解释在失败的情况下出了什么问题。如果它是一个不可变的抽象类型，它定义了一个单例`Success`实例以供在事情工作时使用，那么它可以在将来扩展以在事情不工作时提供任意级别的细节，而不会在它们工作时造成任何 GC 压力。

不幸的是，即使是`out`参数类型不依赖的形式`T`也不能在某些情况下使用。为此，可以定义一个结构类型`CommandResult<T>`，它将 a`T`与成功指示符组合在一起，其方式在概念上类似于但对其参数类型`Nullable<T>`没有烦人的约束。`struct`成功指示符可以是`bool`，也可以是如上所述的状态指示符。

# c# - 多个按钮按下

> ID：13954721
> 
> 赞同：-5
> 
> 时间：2012-12-19T14:40:52.990
> 
> 标签：c#, button

我有 4 个可见性设置为 false 的标签和一个按钮。每次单击按钮时，我都希望它显示不同的标签。有人可以告诉我这个的代码吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T14:44:45.220

A`Queue`是为这项任务量身定做的。

```
private Queue<Label> queue = new Queue<Label>();
//add labels to queue in constructor

private void button1_Click(object sender, EventArgs e)
{
    queue.Peek().Visible = false; //hide label at the start of the queue
    queue.Enqueue(queue.Dequeue()); //move the first item to the end
    queue.Peek().Visible = true; //show the label at the start of the queue
} 
```

# git - 使用 GIT GUI 从 Reset Master 克隆

> ID：13954726
> 
> 赞同：1
> 
> 时间：2012-12-19T14:41:08.663
> 
> 标签：git

我想将主分支重置为以前的提交，这样如果有人使用 GUI（并且只使用 GUI），他们可以进行简单的克隆以获取重置版本。我做了一个“可视化大师的历史”然后右键单击我想要重置的提交。然后我可以单击“将主分支重置到此处”，然后可以通过这种方式获得此提交。但是当有人刚刚启动 GIT GUI 并执行“克隆现有存储库”时，我希望显示此版本，而不是随后的提交。

推理：我有一些 SW 质量人员，他们有一个书面的 SOP，说要以这种方式做事，如果可能的话，我想保持它。

那么我能做些什么来使这个版本成为通过 GUI “克隆”的版本而不废弃我的后续提交？

编辑：我怀疑，最好的方法是从我以前的工作版本（我正在尝试重置的版本）分支，直到我确定在我的分支上所做的更改已准备好提交回我的主人分支。在分支合并回我的主控之前，通过 GUI 进行的克隆只会提取主控版本。对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:31:31.257

如果您重置了分支，则需要强制推送它，以便其他人看到相同的历史记录。
请参阅“ [Eclipse 上的 EGit：如何 git push --force？](https://stackoverflow.com/a/12302449/6309) ”（使用包含选项“强制更新”的[推送参考规范）](http://wiki.eclipse.org/EGit/User_Guide#Push_Ref_Specifications)

这将适用于第一次克隆您的 repo 的其他用户：他们将在您重置分支时看到您的分支。

但这意味着已经克隆了您的仓库并将从中获取的其他用户必须将他们自己的本地分支重置为他们已经获取的分支。

# javascript - 外部脚本语法错误

> ID：13954727
> 
> 赞同：1
> 
> 时间：2012-12-19T14:41:13.723
> 
> 标签：javascript, html, api

我正在 IE 8 中测试一个网站，我收到以下错误消息：

```
Message: Syntax error
Line: 1
Char: 1
Code: 0
URI: http://maps.googleapis.com/maps/api/js?key=xxxxxxxxxxxxxx&sensor=false 
```

它像这样添加到标题中：

```
<script src="http://maps.googleapis.com/maps/api/js?key=xxxxxxxxxxxxxx&sensor=false"></script> 
```

有人知道可能出了什么问题吗？

![从控制台](../Images/c1e8d6659bac5895ce27ebb652b31d50.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:21:08.810

转到[https://code.google.com/apis/console/](https://code.google.com/apis/console/)并确保您有权在您正在处理的域上使用该 API 密钥（可能没有，因为您在本地工作）。如果您的密钥未显示“允许任何引用者”，则您在本地工作时可能必须使用不同的 api 密钥，然后您可以在部署到实时服务器时限制引用者。

# http - AngularJs 和 iTunes

> ID：13954729
> 
> 赞同：1
> 
> 时间：2012-12-19T14:41:19.667
> 
> 标签：http, get, angularjs, itunes

我只是想使用 angularjs http 对 itunes 搜索 api 进行基本调用。

```
$http.jsonp("http://itunes.apple.com/search", {params:{"term":"jack+johnson"}})
                .success(function (data, status, headers, config) {
                    console.log("is scope : " + data);
                }).error(function (data, status, headers, config) {
                    console.log("error" + status);
                }); 
```

请求做得很好（状态：200），我可以看到 json 被检索，这是一个摘录：

```
{
 "resultCount":50,
 "results": [
{"wrapperType":"track", "kind":"song", "artistId":909253, "collectionId":120954021,                 "trackId":120954025, "artistName":"Jack Johnson", "collectionName":"Sing-a-Longs and Lullabies     for the Film Curious George", "trackName":"Upside Down", "collectionCensoredName":"Sing-a-    Longs and Lullabies for the Film Curious George", "trackCensoredName":"Upside Down",     "artistViewUrl":"https://itunes.apple.com/us/artist/jack-johnson/id909253?uo=4",     "collectionViewUrl":"https://itunes.apple.com/us/album/upside-down/id120954021?    i=120954025&uo=4", "trackViewUrl":"https://itunes.apple.com/us/album/upside-down/id120954021?    i=120954025&uo=4",  .... 
```

但是我在 json 结果的第一行（“resultCount”：50）有一个 js 错误：“Uncaught SyntaxError: Unexpected token:”。

我尝试使用 transformResponse 但错误发生在之前。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:57:05.843

您忘记添加回调函数 ( `JSON_CALLBACK`)：

```
app.controller('Ctrl', function($scope, $http) {
    $http.jsonp("http://itunes.apple.com/search", {
        params: {
            "callback": "JSON_CALLBACK",
            "term": "jack+johnson"
        }
    }).success(function(data, status, headers, config) {
        console.log("is scope : " + data);
    }).error(function(data, status, headers, config) {
        console.log("error" + data);
    });
});​ 
```

从 angularjs $http.jsonp[文档](http://docs.angularjs.org/api/ng.%24http#jsonp)：

> url - {string} - 指定请求目的地的相对或绝对 URL。**应包含 JSON_CALLBACK 字符串。**

# javascript - 如何/何时/何处包含外部 javascript

> ID：13954734
> 
> 赞同：15
> 
> 时间：2012-12-19T14:41:26.703
> 
> 标签：javascript, jquery, architecture

我正在寻找一些关于保存我的 JavaScript (jQuery) 函数的最佳方式的建议。

我正在 MVC/razor 中开发，因此有一个布局页面。我在这里包含了我的 jQuery 库和一个外部 JavaScript 文件，因此它在每个页面中都可用。

这工作得很好，但我现在非常清楚我正在向每个页面添加近 300 行 JS 的事实，其中可能有一半用于这些页面中的任何一个。

一个函数不在外部文件中，而是位于 HTML 中，因为我需要使用我的剃刀代码中设置的变量。

我对这种安排有几个问题：

*   使用 razor 设置的变量时，将 JS 放在 HTML 中通常可以接受吗？似乎没有一种将变量传递到外部 js 文件的干净方法
*   我是否应该将我的函数拆分为单独的 JS 文件，并只包含站点中每个页面所需的内容？
*   如果我要将它们拆分为多个文件，那将如何与 jQuery 一起使用`(document).ready`？如果要使用我包含的所有 JavaScript，我是否需要使用它？

我敢肯定，这将更多的是一个意见问题，而不是一个黑白的答案，但我想在继续之前考虑我所有的选择。尽管它可以正常工作，但我不禁觉得有更好/更清洁的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T14:45:56.200

请记住，一旦用户登陆您的主页并加载 javascript 文件，它将被缓存在他们的浏览器中，因此后续页面将不会再次下载 Javascript。

我肯定会将 js 分开，您可以在每个页面上都有一个片段来初始化该特定视图所需的 JS。在需要运行 JS 的视图中放入类似下面的内容

```
$(document).ready(function() {
    mysite.mypage();
}); 
```

然后可以在外部JS文件中定义函数mysite.mypage()。300 行并不是世界末日，我会说担心优化可能还为时过早。

您总是可以考虑缩小该 JS 文件以减小大小。一个快速简便的方法是在这里：

[http://www.minifyjavascript.com/](http://www.minifyjavascript.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:57:27.433

你听说过 require.js 吗？[http://requirejs.org/](http://requirejs.org/) 我觉得它真的很有用。

它是一个模块加载器，因此您可以将所有 JS 代码拆分为单独的文件，并仅在每个页面上加载您需要的文件。

我不知道将变量传递给外部 JS 文件，我认为它不可能/“正确”的方式。

你可以把每个外部的JS文件做成一个接受和返回参数的函数。然后在你需要使用的页面中： - 包含文件依赖 - 调用函数

这就是我所做的，似乎是你的第二个建议。

对于 $(document.ready) 问题，这完全取决于您。您不必使用它，但它对某些事情很有用，请查看此概述： [http](http://docs.jquery.com/Tutorials:Introducing_) ://docs.jquery.com/Tutorials:Introducing_ $(document).ready()

# xml - vbscript 选择子节点

> ID：13954735
> 
> 赞同：2
> 
> 时间：2012-12-19T14:41:31.253
> 
> 标签：xml, loops, vbscript

我有以下 XML，`gXML`从一个页面传递到另一个发送电子邮件的页面。

```
<root>
   <Lease>
       <row hello="none@nowhere.com">
       <row hello="none@nowhere.com">
       <row hello="none@nowhere.com">
       <row hello="none@nowhere.com">
   </Lease>
</root> 
```

我希望能够向每一行发送一封电子邮件，我希望它是这样的：

```
for (each row){
    blah blah blah (send email function)
} 
```

如何在 XML 中选择行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:00:19.157

如果您使用的是 VBScript，我假设您可以访问 System.Xml。

看看这个页面：http: [//msdn.microsoft.com/en-us/library/system.xml.xmlnode.childnodes.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.childnodes.aspx)

并在 Google 上进行更多研究，特别是使用 System.Xml.XPath。那里有很多例子。

这是我在用于测试的控制台应用程序中编写的测试方法。它是用 C# 编写的，但这个想法应该会有所帮助：

```
 private static void ExtractUserNodeFromUsersXml()
    {
        XmlDocument xmlDoc = new XmlDocument();

        string xml = @"<data xmlns=''><users><user id='33' culture='en-gb' />
<user id='38 culture='en-gb' />
<user id='285'culture='en-gb' /></users></data>";

        xmlDoc.LoadXml(xml);

        string userid = "38";

        XPathNavigator nav = xmlDoc.CreateNavigator();

        XPathNodeIterator userNodes = nav.Select("data/users/user[@id='" + userGuid + "']");

        while (userNodes.MoveNext())
        {
            if (userNodes.Current is IHasXmlNode)
            {
                XmlNode node = ((IHasXmlNode)userNodes.Current).GetNode();

                if (node != null)
                {
                    string culture = node.Attributes.GetNamedItem("culture").Value;

                    Console.WriteLine(node.OuterXml);
                    Console.WriteLine("Culture is " + culture);
                }
            }
        }

        Console.WriteLine();
        Console.WriteLine("******");
        Console.WriteLine();

        Console.WriteLine(xmlDoc.OuterXml);
    } 
```

对于您需要的东西，这可能有点矫枉过正，但如果您在网上查看并使用此代码进行操作，那么它会有所帮助。事实上，我现在将为您的 XML 更改此方法。

使用您的 XML 将 XPathNavigator 更改为这个。

```
XPathNodeIterator emailNodes = nav.Select("root/Lease/row"); 
```

确保您的 XML 有效并记住“xpath”区分大小写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T15:12:18.060

VBScript 版本（最好与[Docs](http://msdn.microsoft.com/en-us/library/windows/desktop/ms763742%28v=vs.85%29.aspx)一起使用）：

```
 ' Assuming you have a string in gXML, I fake it here, please
  ' note the closing of the row nodes!
  Dim gXML : gXML = Join(Array( _
       "<root>" _
     , " <Lease>" _
     , "  <row hello=""none@nowhere.com""/>" _
     , "  <row hello=""none@nowhere.com""/>" _
     , "  <row hello=""none@nowhere.com""/>" _
     , "  <row hello=""none@nowhere.com""/>" _
     , " </Lease>" _
     , "</root>" _
  ), "")
  Dim oXML : Set oXML = CreateObject("Msxml2.DOMDocument")
  oXML.loadXml gXML
  If 0 = oXML.ParseError Then
     Dim ndlRow : Set ndlRow = oXML.selectNodes("/root/Lease/row")
     If 0 < ndlRow.length Then
        Dim nRow
        For nRow = 0 To (ndlRow.length - 1)
            WScript.Echo nRow, "send mail to", ndlRow(nRow).getAttribute("hello")
        Next
     Else
        WScript.Echo "no rows found"
     End If
  Else
     WScript.Echo oXML.parseError.reason
  End If 
```

输出：

```
0 send mail to none@nowhere.com
1 send mail to none@nowhere.com
2 send mail to none@nowhere.com
3 send mail to none@nowhere.com 
```

而不是计数循环

```
For nRow = 0 To (ndlRow.length - 1)
    WScript.Echo nRow, "send mail to", ndlRow(nRow).getAttribute("hello")
Next 
```

您可以使用 For Each 循环：

```
Dim ndRow
For Each ndRow In ndlRow
    WScript.Echo "send mail to", ndRow.getAttribute("hello")
Next 
```

# qooxdoo - QooxDoo：表单元素中的“自动完成”是否有任何贡献

> ID：13954739
> 
> 赞同：0
> 
> 时间：2012-12-19T14:41:38.800
> 
> 标签：qooxdoo

我是 QooDoo 的新手，现在我正在用 QooxDoo 和 PHP 开发一个 Web 应用程序，这个应用程序有多种形式。

如果 qooxdoo 在其表单元素（如 TextField、ComboBox、SelectBox 等）中具有“自动完成”功能，它将非常有用。

在 qooxdoo 中是否有任何可用于实现自动完成的库？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T08:27:34.437

qooxdoo 框架和 qooxdoo 贡献不提供这样的功能。但是使用组合框和数据绑定为您提供了很好的工具来自己实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T09:16:30.617

链接到 ComboTable [http://demo.qooxdoo.org/contrib/demobrowser/#ComboTable~trunk%2Fdefault%2F1.4.2%2Findex.html](http://demo.qooxdoo.org/contrib/demobrowser/#ComboTable~trunk%2Fdefault%2F1.4.2%2Findex.html)

..................................................... .....................................

# php - 在mysql搜索中禁用空值

> ID：13954747
> 
> 赞同：1
> 
> 时间：2012-12-19T14:41:58.260
> 
> 标签：php, mysql, null

我的数据库表有很多列。我想根据多列进行搜索。有时它可能不是某些列的值。sql查询中的这些字段如何失效？谢谢你。

例如：

```
$C1=$_POST[c1];

$C2=$_POST[c2];

SELECT * FROM mytable WHERE column1='$c1' AND column2='$c2' 
```

我想如果 C2 为空，请从 sql 查询中禁用它。

一种方法是：

```
if(!$_POST[C2]){
   SELECT * FROM mytable WHERE column1='$c1'
} 
```

...

我想通过 sql 查询来做，因为我的表有很多列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:51:11.307

首先，你永远不应该这样编写带有变量的查询。了解[PDO](http://www.php.net/pdo) / [mysqli](http://www.php.net/mysqli)和[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)。

其次，数组的键引用应该是字符串或整数；该表达式`$_POST[c1]`很可能会导致通知和隐式转换为字符串。最好写`$_POST['c1']`。

第三，为了回答您的问题，您可以使用`isset()`and`strlen()`来确定一个值是否为“空”，即空字符串。

```
$params = array($_POST['c1']); // you should also check whether $_POST['c1'] is defined too
$sql = 'SELECT * FROM `table_name` WHERE column1 = ?';
if (isset($_POST['c2']) && strlen($_POST['c2'])) {
    $sql .= ' AND column2 = ?';
    $params[] = $_POST['c2'];
}

$stmt = $db->prepare($sql);
$stmt->execute($params); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:52:17.807

通过遍历 POST 值来构建条件数组，如果相应的 POST 参数不为空，则添加一个条件：

```
$conditions = array();
foreach ($_POST as $key => $value) {
  if (!empty($value)) {
    $conditions[] =
      $dbcolumn[$key] . " = '" . mysql_real_escape_string($value) . "'";
  }
} 
```

您将需要一个将`$dbcolumn`POST 变量与数据库列匹配的数组（或者您必须提供一些其他方式在两者之间进行转换）。

现在为给定条件创建一个 SQL 查询：

```
$query = 'SELECT * FROM mytable';
if (!empty($conditions)) {
  $query .= ' WHERE '  . join(' AND ', $conditions);
} 
```

请注意，提供[mysql_real_escape_string()](http://www.php.net/manual/en/function.mysql-real-escape-string.php)的扩展已被弃用。您可能应该使用其他一些扩展来与 MySQL 服务器通信，而不必使用其他扩展的 repsective 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:49:08.673

不推荐此代码，但如果您真的想在 MySQL 上执行此代码，您可以使用 LIKE 语法，如下所示：

```
SELECT * FROM mytable WHERE column1="$c1" AND column2="$c2%" 
```

在 $c2 之前或之后添加 % 字符

请不要这样做！

# ruby-on-rails - 冒号 (:) 在语言环境 YAML 文件中给出加载错误

> ID：13954751
> 
> 赞同：5
> 
> 时间：2012-12-19T14:42:13.427
> 
> 标签：ruby-on-rails, ruby, internationalization, yaml

我在`en:`语言环境中有一个字符串

```
display_device: to play : get player 
```

冒号给我的错误是

> 无法从 C:/Documents and Settings/rajg/discoveryaws/branches/internationalization/config/locales/en.yml 加载翻译，预计它会返回哈希，但不会

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T14:47:11.740

如果你用引号括起来，你可以在你的字符串中转义冒号（和其他“重要”字符）：

```
display_device: "to play : get player" 
```

# ruby-on-rails - 表单完成时如何触发“完成”属性？

> ID：13954752
> 
> 赞同：2
> 
> 时间：2012-12-19T14:42:14.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个由很长的表格填充的 rails 模型（使用 wicked-wizard gem 拆分）。

有一些验证，但我允许在大多数字段中留空。

如果模型已保存但某些字段保持空白（例如记住用户填写表单），我需要采取某些操作，如果表单 100% 完成，我需要采取一些其他操作（例如向用户发送电子邮件让他知道表格是完整的）。

我的想法是触发一个虚拟属性，例如 :complete 如果我的模型中没有空白字段，但我不确定如何以及在哪里执行此操作。

有什么提示吗？

========================== 编辑

感谢@Kzu 的建议，我发现这可以在我的向导控制器上工作（但也可以在对象控制器本身上工作）

```
 def update
    @customer = current_user.customer
    params[:customer][:complete] =  @customer.attributes.select{|key,value| value.nil? or !value.present? }.any?  ? false : true
    @customer.attributes = params[:customer]
    render_wizard @customer
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:53:58.583

例如，您可以为此表单使用 ActiveRecord 回调和*完整的布尔字段。*

```
before_save :check_if_complete
def check_if_complete
    # self.attributes returns a hash including the attribute name as key and its value as value
    completion = self.attributes.select{|key,value| value.nil? or value.blank?} ? false : true
    self.complete = completion
end 
```

此解决方案可以工作，但要注意数据库中的不同属性类型。

# asp.net-mvc-3 - 在 MVC3 中的控制器动作之间共享模型对象

> ID：13954753
> 
> 赞同：1
> 
> 时间：2012-12-19T14:42:15.300
> 
> 标签：asp.net-mvc-3

我在控制器中有两个动作。一个显示文件上传表单，另一个显示上传结果。我创建了一个名为 FileInfo 的 POCO，即

```
public class FileInfo
    {
        public string Name { get; set; }
        public int Length { get; set; }
        public string FileType { get; set; }
        public string ErrorMessage { get; set; }

    } 
```

当我提交表单时，Upload 操作会创建并填充 FileInfo 对象，然后重定向到名为 results 的第二个操作。我希望能够在结果操作中使用相同的文件信息对象。

我可以使用 TemPData[] 解决这个问题，但它是有限的，因为它只保存单个请求的对象数据。我认为必须有更好的方法在控制器操作之间共享对象。感谢任何帮助！

// 上传动作

```
 List<FileInfo> fileInfo= new List<FileInfo>();
//populate  the fileInfo object using fi.Add()

if ((status.ToString() == "OK"))
             {
                 TempData["Info"] = fileInfo;
                 return RedirectToAction("Results");

             }
             else
             {
                 return RedirectToAction("Index");
             } 
```

//结果动作。

```
public ActionResult Results()
        {
            List<FileInfo> fi = TempData["Info"] as List<FileInfo>;
            if (fi != null)
            {
                return View(fi);
            }
            else
            {
                return View("Index");
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:21:39.227

如果您需要一些东西比后续请求更长时间，您必须将其放入`Session`或放入持久存储（例如数据库）中。

# iphone - MPMoviePlayer 控制器不播放视频

> ID：13954761
> 
> 赞同：0
> 
> 时间：2012-12-19T14:42:44.097
> 
> 标签：iphone, ios, ios6, mpmovieplayercontroller

我正在开发一个需要使用 Xcode 4.5.2 和 iOS 6.0 播放视频的应用程序。

我正在使用 MPMoviePlayerController 播放视频。我已经按照 [这个教程](http://mobile.tutsplus.com/tutorials/iphone/mediaplayer-framework_mpmovieplayercontroller_ios4/)。但是，我仍然无法在模拟器中播放视频。

这是我的代码：

```
- (IBAction)playVideo:(id)sender {
 NSString *filepath   =   [[NSBundle mainBundle] pathForResource:@"Movie-1" ofType:@"mp4"];
 NSURL    *fileURL    =   [NSURL fileURLWithPath:filepath];
 MPMoviePlayerController *moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL];
 moviePlayerController.shouldAutoplay =YES ;
 moviePlayerController.controlStyle = MPMovieControlStyleDefault ;
 moviePlayerController.scalingMode = MPMovieScalingModeFill ;
 [moviePlayerController.view setFrame:CGRectMake(0, 0, 360, 200)];
 [self.view addSubview:moviePlayerController.view];
 [[NSNotificationCenter defaultCenter] addObserver:self
                                          selector:@selector(moviePlaybackComplete:)
                                             name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayerController];
[moviePlayerController play ] ;

}

- (void)moviePlaybackComplete:(NSNotification *)notification
{
    MPMoviePlayerController *moviePlayerController = [notification object];
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:moviePlayerController];

    [moviePlayerController.view removeFromSuperview];
} 
```

我已经看过很多 SO 问题，但没有一个能解决我的问题。我还尝试创建一个**containerView**并将我的添加`MPMoviePlayerController`到我的**containerView 中**。我没有让它工作。

我也尝试过`MPMoviePlayerViewController`，到目前为止我能够让它工作。另一个问题，我不能`setFrame`。`MPMoviePlayerViewController`但是，我想将 setFrame 设置为我的视频播放器。它的大小不可能是全屏的。因为，我需要在我的视频播放器下方显示一些按钮。

你们知道我该怎么做吗？

编辑：控制台输出

```
2012-12-19 16:29:21.554 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:21.555 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:21.565 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:27.230 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:27.231 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:27.241 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:27.706 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:27.707 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:27.718 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:27.919 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:27.920 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:27.930 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:28.077 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:28.077 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:28.088 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:28.219 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:28.220 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:28.230 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:28.368 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:28.368 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:28.382 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:28.511 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:28.512 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:28.521 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-12-19 16:29:28.692 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-12-19 16:29:28.692 Coverzzz[4952:c07] [MPAVController] Autoplay: Disabling autoplay
2012-12-19 16:29:28.702 Coverzzz[4952:c07] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:10:10.120

我终于完成了这项工作。iOS 5.0 之后，`MPMoviePlayerController`需要声明为属性。因此，我将其添加为属性并且它起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:49:45.550

你能试试这个代码：

```
MPMoviePlayerViewController *mp = [[MPMoviePlayerViewController alloc] initWithContentURL:_urlToLoad];
[self presentModalViewController:mp animated:YES]; 
```

代替 ：

```
[self.view addSubview:moviePlayerController.view]; 
```

希望这会有所帮助。干杯。

# django - 在 django 中获取继承的模板

> ID：13954762
> 
> 赞同：-1
> 
> 时间：2012-12-19T14:42:44.870
> 
> 标签：django, django-templates

有没有办法获取从基本模板继承的所有模板的列表？例如：我们有基本模板文件：

```
base.html 
```

我们有从基础继承的模板

```
inherited0.html
{% extends 'base.html' %}
inherited1.html
{% extends 'base.html' %}
inherited2.html
{% extends 'base.html' %} 
```

我们是否有任何未记录的功能来获取此模板的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T17:03:07.490

您可以使用基本文件夹中的 find 和 grep 命令：

```
find . -name "*.html" -print | xargs grep "extends 'base.html'" 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T08:58:59.720

似乎缺少这样做的方法。所以这个问题的解决方案是在模板文件字符串中搜索“{% extends 'base.html' %}”。

# ios - iphone的事件自动进入睡眠状态

> ID：13954766
> 
> 赞同：6
> 
> 时间：2012-12-19T14:43:10.040
> 
> 标签：ios, events, sleep

当任何 iOS 应用程序正在运行时，当 iphone**自动**进入睡眠模式时，哪个 iOS 事件会被调用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T14:57:19.293

```
- (void)applicationWillResignActive:(UIApplication *)application 
```

# c# - rdlc 报告中的计算

> ID：13954769
> 
> 赞同：0
> 
> 时间：2012-12-19T14:43:18.747
> 
> 标签：c#, visual-studio-2010, reporting

使用 VS 2010 win 表单项目。我有一个工作单输入屏幕的 winform。工作订单表单的底部是一些计算文本框，这些文本框是根据类中的函数计算得出的。

我创建了一个 rdlc 报告来打印工单，但现在我需要使用这些函数来表示计算工单、税收、费用等的总和。

我可以通过将函数作为变量传递来使用它们吗？将这些函数结果写入报告的最佳方法是什么？

瑞安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:26:35.597

为什么不只将函数计算的值传递给 RDLC 文件？您可以使用`Report Parameters`将值传递给文件。

[报告参数类](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportparameter%28v=vs.100%29.aspx)

在这里[你可以找到](http://www.gotreportviewer.com/localmodeparameters/index.html)一个使用它们的小例子

顺便说一句，代码将如下所示：

```
//Click to generate the report
ReportParameter p1 = new ReportParameter("NameOfFirstParameter", valueReturningFromYourFunction);
ReportParameter p2 = new ReportParameter("NameOfSecondParameter", valueReturningFromYourFunction);
localReport.SetParameters(p1);
localReport.SetParameters(p2);
localReport.Render(...); 
```

# solr - 带前缀的 SOLR 复制字段

> ID：13954778
> 
> 赞同：1
> 
> 时间：2012-12-19T14:44:06.657
> 
> 标签：solr, lucene

是否可以为复制字段值添加前缀？

所以我有不同类型的实体，我想将它们的 id 复制到一个字段中，以便将其用作唯一键。但信息来自数据库，因此不同实体的键可能相同。

我想要做的是将“company_id”复制为“company”+_databaseId，将 entityt_id 复制为“entity”+_databaseId

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:19:48.070

如果您使用 DIH 将数据加载到 Solr，则可以使用[ScriptTransformer](http://wiki.apache.org/solr/DataImportHandler#ScriptTransformer)

```
<script><![CDATA[
    function addFields(row)    {
        var databaseId = row.get('databaseId');
        row.put(databaseId_'company'+, "value");
        return row;
    } 
]]></script> 
```

并定义一个动态字段：-

```
<dynamicField name="*_company" type="string" indexed="true" stored="true"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:30:25.903

[CopyField](http://wiki.apache.org/solr/SchemaXml#Copy_Fields)只是一个命令，用于将一个字段复制到另一个字段。您不能向 copyField 添加前缀。您可以通过使用动态字段来解决您的问题。您可以将字段定义为：

```
<dynamicField name="*_company" type="string" indexed="true" stored="true"/>
<dynamicField name="*_entity" type="string" indexed="true" stored="true"/>
<field name="database_ids" type="string" indexed="true" stored="true"/> 
```

将 copyFields 定义为：

```
<copyField source="*_company" dest="database_ids"/>
<copyField source="*_entity" dest="database_ids"/> 
```

当您从*公司*表中获取项目时，将其索引为`company_id_company`，当您从*实体*表中获取项目时，将其索引为`entity_id_entity`字段。然后所有的 id 将被复制到 database_ids 字段。

# ruby-on-rails - 我想使用引导复选框

> ID：13954783
> 
> 赞同：0
> 
> 时间：2012-12-19T14:44:18.650
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我想使用[Bootstrap](http://twitter.github.io/bootstrap/)复选框。

```
<div class="btn-group" data-toggle="buttons-checkbox">
  <button type="button" class="btn btn-primary">Left</button>
  <button type="button" class="btn btn-primary">Middle</button>
  <button type="button" class="btn btn-primary">Right</button>
</div> 
```

如何将它集成到[Rails](http://rubyonrails.org/)应用程序中？

我想以一种形式使用它们。具体来说，如何发送和捕获选定的数据？

**更新**：

我知道如何在 Rails 中使用复选框。我不明白如何[通过 bootstrap 设置他们的风格](http://twitter.github.com/bootstrap/javascript.html#buttons)。

复选框是 -`<input type="checkbox">Simple</input>`

引导复选框是`<button type="button" class="btn btn-primary">Bootstrap</button>`

**更新 2**：

例如，请参阅[我](https://stackoverflow.com/questions/13949250/bootstrap-radoibuttons-in-rails)关于单选按钮的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:53:40.670

例如，您可以像这样删除一个项目：

```
<p>Delete item <%= asset.check_box :_destroy %></p> 
```

或者，如果您使用 simple_form gem，则更容易，例如，如果您的模型中有一个布尔属性，则默认复选框是：

```
<%= f.input :agreement %> 
```

或者你可以强制这样的复选框：

```
<%= f.foobar, :as => :check_boxes %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:52:36.427

考虑使用[bootstrap-rails](https://github.com/anjlab/bootstrap-rails)将引导 css 和 javascript 库合并到您的应用程序中。rails bootstrap 有多种风格，但我个人使用这个，因为它是用 SASS 编写的（与 Rails 一起使用比 LESS 更常用）。

您在处理此问题时遇到了一些问题，因为您似乎有三个选项，并且我假设应该选择其中一个（我建议使用`select`标签）并且您使用的是按钮而不是复选框...但是要集成将复选框添加到您的应用程序中，rails 确实提供了一种方法，a 中的示例`form_for`如下：

```
- form_for @something_with_a_postion do |something|     
  = something.label 'Left'
  = something.check_box 'position', 'left', {class: 'whatever_classes_for_bootstrap_needed'}
  = something.label 'Middle'
  = something.check_box 'position', 'middle', {class: 'whatever_classes_for_bootstrap_needed'}
  = something.label 'Right'
  = something.check_box 'position', 'right', {class: 'whatever_classes_for_bootstrap_needed'} 
```

您可以在此处`form_for`和`check_box` [此处](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-check_box)找到更多信息。

我也请你参考[这个问题](https://stackoverflow.com/questions/4425176/in-rails-how-to-handle-multiple-checked-checkboxes-just-split-on-the-or)。同样，[这](http://railscasts.com/episodes/17-habtm-checkboxes)是一个与复选框有关的 RailsCast。

# algorithm - 自动获取术语列表，导入 Windows 搜索功能（用于内容），并导出结果列表。（汽车信息技术？）

> ID：13954785
> 
> 赞同：1
> 
> 时间：2012-12-19T14:44:19.867
> 
> 标签：algorithm, search, full-text-search, autoit, windows-search

我的下一个重大挑战是编写一个脚本（我假设它会在 AutoIT 中，我没有什么经验）来自动化 Windows 搜索功能。

最终目标是从 .txt 文件中获取搜索词列表（每行一个字符串），并在计算机上每个文档的内容中搜索所述搜索词（一次一个）。

我可以手动实现 - 打开按内容搜索功能，索引所有附加驱动器上的所有文件，逐个搜索术语，然后突出显示全部 > shift-click > 复制为路径 > 粘贴到记事本中，然后另存为[搜索词].txt。

但是，我需要自动化整个过程。我知道我可能需要为要与它一起使用的每个 Windows 版本（XP、Vista、7、8）编写一个单独的脚本。

这是一项很容易完成的任务，还是需要大量的编程时间？谁能指出我正确的方向？感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:10:30.773

好吧，假设您的查询文本文件足够大，并且您不想为每个查询实际迭代整个文件系统，那么您正在描述一个经典的[**信息检索**](http://en.wikipedia.org/wiki/Information_retrieval)问题。

1.  索引文件系统中的数据（这是一个只进行一次的预处理）
2.  对于每个查询 - 在索引中搜索它，并获取相关文档。

信息检索领域是一个巨大的研究领域，我真的不鼓励您尝试从头开始实施它。

我确实鼓励使用已经为您开发和测试过的内置库。例如，在 java 中，一个流行的选择是[lucene——](http://lucene.apache.org/core/)它被广泛用于到处搜索。

如果你不熟悉 java，我也知道这个库的 python ( [pylucene](https://lucene.apache.org/pylucene/) ) 和 .NET ( [lucene.NET](http://incubator.apache.org/projects/lucene.net.html) ) 绑定。

* * *

要了解有关信息检索的更多信息，我推荐 Manning 的[信息检索简介](http://nlp.stanford.edu/IR-book/)

# gcc - 使用 GCC 的 -Wpointer-arith

> ID：13954788
> 
> 赞同：8
> 
> 时间：2012-12-19T14:44:24.953
> 
> 标签：gcc, warnings, gcc-warning

GCC 文档说

**-Wpointer-arith** 警告任何取决于函数类型或“void”的“大小”。GNU C 将这些类型的大小分配为 1，以方便使用 'void *' 指针和函数指针进行计算。在 C++ 中，当算术运算涉及“NULL”时也会发出警告。

但是我想不出一个有用的用例，而不是造成麻烦。有什么例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T18:22:34.773

根据 C 标准，所有这些操作都是未定义的。此警告有助于指出代码可能在 GCC 下工作但在其他编译器下会失败的情况。

# java - “for”循环中的复杂更新规则

> ID：13954789
> 
> 赞同：9
> 
> 时间：2012-12-19T14:44:32.460
> 
> 标签：java, for-loop, while-loop

我正在尝试编写以下“while”循环：

```
int x = N-1, y = 0;

while ( y < M ) {

    /* Some work */

    if ( x > 0 )
        x--;
    else 
        y++;

} 
```

作为“for”循环。这是我**失败**的尝试：

```
for ( int x = N-1, y = 0 ; y < M ; ((x>0)?x--:y++) ) {
    /* Some work */
} 
```

这无法编译，因为正如编译器所说，更新规则不是语句。

您是否看到任何将上面的“while”循环自然地编写为“for”循环的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-19T14:46:41.900

您可以随时将更新规则留空

```
for ( int x = N-1, y = 0 ; y < M ; ) {

 if ( x > 0 )
        x--;
    else 
        y++;

} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-19T14:49:53.310

结合条件。

```
 for(int x = N-1, y = 0; y < M ; y += (x > 0)?0:1, x += (x > 0)?-1:0) 
```

我怀疑这应该是两个循环调用一个通用方法。

```
 for(int x = N - 1; x >= 0; x--)
     someMethod(x, 0);
 for(int y = 0; y < M; y++)
     someMethod(0, y); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:58:28.973

做

```
/* Some work */ 
```

包括变量 x 和 y？如果没有，有一种更简单的方法来编写循环的逻辑。目前，您的循环从 N-1 计数到零 (x)，然后从零计数到 M-1 (y)。整个循环运行 (M+N)-1 次。

通过组合初始条件，您可以编写：

```
for (int x = 1; x < M+N; x++) {
    /* Some work */
} 
```

并完全取消 y 变量。

如果您需要将 x 和 y 变量保留为这些值，只需使用第三个变量：

```
for (int z = 1; z < M+N; z++) {
    /* Some work */
    (x>0)?x--:y++;
} 
```

希望这可以帮助！

杰克

# php - 处理后从 php 文件中获取 HTML 内容

> ID：13954791
> 
> 赞同：5
> 
> 时间：2012-12-19T14:44:37.187
> 
> 标签：php, html

我想以 HTML 格式获取 php 文件的内容。我将它用作 HTML 电子邮件模板，但它需要使用我的数据库中的动态数据进行填充。

我试过了

```
file_get_contents('/emails/orderconfirm.php'); 
```

但所做的只是在服务器将 php 代码处理为 HTML 之前将其返回。

我想这真的很容易吗？任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:51:57.213

为了执行你的特定代码`emails/orderconfirm.php`，你需要[包含](http://php.net/include)它的内容。

包含的内容将被编译和渲染。
但是，您需要获取内容，只要您`echo`

这样，您需要使用[ob_start()](http://php.net/ob_start)库。

这是一个用法示例：

```
ob_start(); //Init the output buffering
include('emails/orderconfirm.php'); //Include (and compiles) the given file
$emailContent = ob_get_clean(); //Get the buffer and erase it 
```

编译后的内容现在存储在您的`$emailContent`变量中，您可以按照自己的方式使用它。

```
$email->body = $emailContent; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:47:19.553

```
ob_start();
require 'emails/orderconfirm.php';
$email = ob_get_clean(); 
```

[http://php.net/ob_start](http://php.net/ob_start)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:47:16.630

您已关闭，请插入完整的 URL

```
file_get_contents('http://example.com/emails/orderconfirm.php'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:48:50.330

尝试访问完整的 http 地址，例如：

```
file_get_contents('http://mydomain.com/emails/orderconfirm.php'); 
```

# c# - 在我清除错误之前，errorprovider 不会让我退出表单

> ID：13954799
> 
> 赞同：1
> 
> 时间：2012-12-19T14:44:46.733
> 
> 标签：c#, winforms

为什么当我第一次来到我的窗口时，它是一个用户控件和组合框设置为空白的表单。我可以毫无问题地单击取消并关闭窗口。但是，如果我触摸组合框，然后将其留空并尝试单击取消，取消事件不会触发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-22T18:19:13.607

你真正需要的是

```
 e.Cancel = False; 
```

在您的 FormClosing 事件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T21:31:29.270

我不得不使用 container.AutoValidate = .EnableAllowFocusChange

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-03T09:39:43.463

罗德的回答导致了解决方案。如果表单（错误提供者的容器）`AutoValidate`-property 设置为`EnableAllowFoucsChange`，则处理按钮事件，`Click`现在可以在 -Event 中检查表单是否包含无效子项：

```
Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
    If Not ValidateChildren() Then Exit Sub
End sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T11:06:59.777

我有同样的问题，但后来我解决了

*   将按钮的 CausesValidation 属性设置为 False。
*   重新设置窗体上的所有控件。
*   关闭表格。

    ```
    while (Controls.Count > 0)
          {
              Controls[0].Dispose();
          }
          this.Close(); 
    ```

我将此代码添加到 Button_Click() 事件以及 From_Closing 事件中。问候， Kshitij Thube

# sql - SQL Server：获取过去 30 周的每周平均值

> ID：13954803
> 
> 赞同：4
> 
> 时间：2012-12-19T14:44:56.483
> 
> 标签：sql, sql-server-2008

我试图弄清楚如何`CHECK_AMOUNT`在 SQL Server 2008 中获得过去/过去 30 周的每周平均值。

我尝试过这样的事情（见下文），但我认为这是几个月而不是几周。

```
SELECT TOP 30
    AVG(CHECK_AMOUNT) AS W2 
FROM 
    CHECKS 
WHERE 
    NOT UNT='256' 
GROUP BY 
    YEAR(DATE_GIVEN), MONTH(DATE_GIVEN) 
```

谁能告诉我如何使这成为可能，

谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:48:20.503

只需使用比较日期的 where 子句：

```
 select AVG(CHECK_AMOUNT)
  from CHECKS
  WHERE NOT UNT='256' and DATEDIFF(d, Date_Given, getdate()) <= 30*7 
```

对不起; 我误读了这个问题。你想要每周的平均值。您的原始查询非常接近

```
 select DATEDIFF(d, Date_Given, getdate())/7 as weeks_ago, AVG(CHECK_AMOUNT)
  from CHECKS
  WHERE NOT UNT='256' and DATEDIFF(d, Date_Given, getdate()) <= 30*7
  group by DATEDIFF(d, Date_Given, getdate())/7 
```

我将保留该`where`子句用于选择——而不是使用`top 30`——以防有几周没有检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T14:48:04.780

您可以尝试将其添加到 group by 子句中吗？

```
datepart(week, DATE_GIVEN) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T14:49:48.553

尝试使用 Datepart

```
SELECT TOP 30  AVG(CHECK_AMOUNT) AS W2 FROM CHECKS WHERE NOT UNT='256' GROUP BY Datepart(week,DATE_GIVEN) 
```

# android - 评分栏有问题

> ID：13954808
> 
> 赞同：2
> 
> 时间：2012-12-19T14:45:21.990
> 
> 标签：android, ratingbar

我在玩评分栏。我遵循自定义评分栏的[一个很好的教程](http://kozyr.zydako.net/2010/05/23/pretty-ratingbar/)。

我面临一些问题：

*   本教程使用一张图片作为评分栏，但我不想使用任何图片作为评分栏。我需要使用 android 评分栏小部件。

*   当我使用 Android Rating 小部件时`style="?android:attr/ratingBarStyleSmall">`，无论我们设置 android:numStars="5" 与否，它都显示过大或过小（当我使用时）有超过 10 颗星。

*   好的。假设我为此使用任何图像，但是当我设置 rating = 2.5 时图像仍然没有改变我使用这种方法 `ratingBar.setRating(Float.parseFloat("2.0"))`；。

在这里，我使用此评分栏的图像
![但无论您是否分配值都不会改变。](../Images/f6ed8caa41e76a9d7cbaca1415a82fbf.png)

我的代码与上面给出的链接相同。

您能否通过使用我可以使用只有 5 星的小型评级栏小部件给我一些参考？
我不想使用任何我只想使用 android 评级小部件的图像。
我从过去的 5 个小时就被困在这里。
任何帮助表示赞赏。

# .net - 您可以依赖哪些 Windows 环境变量？

> ID：13954810
> 
> 赞同：1
> 
> 时间：2012-12-19T14:45:36.310
> 
> 标签：.net, windows, environment-variables, system-variable

我正在编写一个需要使用存储一些临时文件的应用程序（我正在通过环境变量找到临时位置）。

我知道环境变量是可变的，这意味着它们可能存在也可能不存在，但是有没有比其他人更安全的环境变量？

例如，我可以`APPDATA`在 Windows 7 上使用，但我相信它不一定在 Windows XP 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:30:29.733

我建议您使用 .NET API 可以提供的一些支持，而不是直接使用环境。临时文件有两个功能：

1.  [`Path.GetTempPath()`](http://msdn.microsoft.com/en-us/library/system.io.path.gettemppath.aspx)返回当前用户临时文件夹的路径。

2.  [`Path.GetTempFileName()`](http://msdn.microsoft.com/en-us/library/system.io.path.gettempfilename.aspx)在用户的临时文件夹中创建一个具有唯一名称的空文件。

临时文件夹实际上是通过使用[Windows GetTempPath 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364992%28v=vs.85%29.aspx)使用环境找到的。通常该文件夹将是`C:\Users\UserName\AppData\Local\Temp`.

如果您想要一个特定于应用程序的文件夹供您自己使用，您可以使用一个特殊文件夹：

```
const String CompanyName = "Acme Industries";
const String ApplicationName = "FooBar";
var subfolderName = Path.Combine(CompanyName, ApplicationName);
var folderName = Path.Combine(
  Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData),
  subfolderName
);
Directory.CreateDirectory(folderName); 
```

通常，创建的文件夹名称为`C:\Users\UserName\AppData\Acme Industries\FooBar`. 您的应用程序可以免费使用此文件夹，并且不会遇到“只读”问题。

依靠标准 API 可以让您的应用程序在不同版本的 Windows 和不同环境（例如终端服务器）上可靠地运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:54:13.130

我强烈建议不要将环境变量用于您的目的。

如果您确实觉得必须使用环境变量，我建议您在可能需要使用的主机上手动定义这些变量。

不同的主机可能有相同的环境变量指向具有不同安全设置和不同目的的其他文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:00:26.303

您可以使用 %temp% 或以下代码作为文件路径：

```
string fileName = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + ".FileExtension"; 
```

或者

```
string fileName = System.IO.Path.GetTempPath() + "FileName.FileExtension"; 
```

或尝试创建临时文件的链接： [http ://www.daveoncsharp.com/2009/09/how-to-use-temporary-files-in-csharp/](http://www.daveoncsharp.com/2009/09/how-to-use-temporary-files-in-csharp/)

# windows - Fiddler2 加快客户端和 WebServer 之间的文件复制（通过 HTTPS）

> ID：13954818
> 
> 赞同：1
> 
> 时间：2012-12-19T14:46:03.023
> 
> 标签：windows, https, fiddler

我试图安装`Fiddler2`以捕获一些 HTTPS 流量，以解决客户端（Windows 7）到 Web 服务器（Windows 2008 R2）之间文件上传速度缓慢的问题。

我注意到的一件奇怪的事情是，在我启动并运行提琴手后，文件上传过程变得非常快。可能是因为提琴手开始充当代理服务器并使用端口 8888？

为什么我开始使用`Fiddler2`上传过程会加快速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:34:54.400

这是 WebDav 请求吗？还是通过传统的 HTML 表单上传文件？

**对于 WebDAV：**

[这很可能是由于 Microsoft WebDAV 实现中的一个错误，他们浪费了大量时间试图通过 WPAD](http://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol)一遍又一遍地“自动检测”您的代理服务器。在没有此类代理服务器的环境中，这可能会非常慢。

Fiddler 在启动时缓存一次代理检测的结果并将自己设置为系统代理，从而防止 WebDAV 堆栈一遍又一遍地错误地重新运行 WPAD 算法。

**对于 HTML 表单：**

通常，这意味着客户端的缓冲区大小选择不当（IE6 有这个问题），因此客户端没有很好地利用网络。Fiddler 使用更好的缓冲区大小（32k 或 64k，IIRC），因此可以更好地利用网络，减少传输时间。大多数现代浏览器使用选择的缓冲区大小来优化性能。

# sql - oracle 11g XE 中的 AS 子句

> ID：13954824
> 
> 赞同：1
> 
> 时间：2012-12-19T14:46:33.897
> 
> 标签：sql, oracle

表：主键已突出显示

1.  客户（**customer_id**，f_name，l_name，tel_no，addr，nic，city）
2.  产品（**product_id**，名称，描述，价格，sales_tax）
3.  分支（**branch_id**，名称，电话号码，地址，城市）
4.  订单（**order_id**，customer_id，order_date，branch_id）
5.  order_product( **order_id,product_id** ,数量)

这是我的查询的一个非常简化的版本：

```
SELECT customer_id, SUM(quantity) AS avg_quantity
FROM orders,order_product
WHERE orders.order_id = order_product.order_id
GROUP BY customer_id
HAVING SUM(quantity) > (SELECT AVG(no_quantity)
FROM(
  SELECT customer_id, SUM(quantity) AS no_quantity
  FROM orders,order_product
  WHERE orders.order_id = order_product.order_id
  GROUP BY customer_id)) 
```

我有 2 个子查询，我想在查询执行时临时存储结果集。我见过这样做的 SQL 示例：

```
(SELECT * FROM orders WHERE branch_id = 4) AS tempone 
```

我想存储结果集，这样我就可以在子查询的上层使用它。上面的查询不在 oracle sql developer 中运行。

```
ERROR : ORA-00933: SQL command not properly ended
00933\. 00000 -  "SQL command not properly ended" 
```

我不想使用临时表。我已经尝试过 WITH AS 子句，查询执行时间太长，超过 20 分钟。我不知道为什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:57:12.310

您应该能够通过以下方式简化此操作：

```
select customer_id, avg_quantity
  from (select customer_id,
               sum(quantity) as avg_quantity,
               avg(sum(quantity)) over () global_avg_quantity
          from orders,
               order_product
         where orders.order_id = order_product.order_id
         group by customer_id)
 where avg_quantity > global_avg_quantity; 
```

但我看到你把`SUM(quantity) AS avg_quantity` 数量的总和=平均值？

# c# - GC.Collect() 和完成

> ID：13954829
> 
> 赞同：45
> 
> 时间：2012-12-19T14:46:52.120
> 
> 标签：c#, .net, garbage-collection, finalizer

好的，众所周知，当 GC 将`Finalize`对象识别为垃圾时，它会隐式调用对象上的方法。但是如果我做 a 会发生什么`GC.Collect()`？终结器是否仍在执行？也许是个愚蠢的问题，但有人问我这个问题，我回答“是”，然后我想：“*这完全正确吗？* ”

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-12-19T15:03:45.163

> 好的，众所周知，当 GC 将对象识别为垃圾时，它会隐式调用对象的 Finalize 方法。

不不不。那是*未知*的，因为为了成为*知识*，陈述必须是*真实的*。这种说法是*错误*的。**垃圾收集器在跟踪时不会运行终结器**，无论它是自行运行还是您调用`Collect`. **终结器线程在跟踪收集器找到垃圾后运行终结器，***并且*这与对`Collect`. （如果它发生了，它可能不会发生，正如另一个答案指出的那样。）也就是说，你不能依赖在控制返回之前执行的终结器线程`Collect`。

这是它如何工作的过度简化的草图：

*   当收集发生时，垃圾收集器跟踪线程跟踪根——已知的活动对象，以及它们引用的每个对象，等等——以确定死对象。
*   具有挂起终结器的“死”对象被移动到终结器队列中。**终结器队列是一个 root**。因此，那些“死”的物体实际上*还活着*。
*   终结器线程（通常是与 GC 跟踪线程不同的线程）最终运行并清空终结器队列。然后这些对象真正死了，并在跟踪线程的*下一个集合中收集。*（当然，由于他们刚刚在第一个系列中幸存下来，他们可能处于更高的一代。）

正如我所说，这过于简单化了。终结器队列如何工作的确切细节比这要复杂一些。但它已经足够传达这个想法了。这里的实际结果是*你不能假设调用`Collect`也运行 finalizers*，因为它没有。让我再重复一遍：**垃圾收集器的跟踪部分*不*运行终结**器，而`Collect`只运行收集机制的跟踪部分。

如果您想保证所有终结器都已运行，请`WaitForPendingFinalizers`在调用后调用恰当命名的方法。`Collect`这将暂停当前线程，直到终结器线程开始清空队列。而且，如果您想确保这些最终对象的内存被回收，那么您将不得不*再次*`Collect`调用。

 *当然，不言而喻，您应该只出于调试和测试目的而这样做。千万不要在没有非常*非常*好的理由的情况下在生产代码中做这种废话。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-19T14:56:25.697

实际上答案是“这取决于”。实际上有一个专用线程执行所有终结器。这意味着调用`GC.Collect`只触发了这个过程，所有终结器的执行都将被异步调用。

如果您想等到所有终结器都被调用，您可以使用以下技巧：

```
GC.Collect();
// Waiting till finilizer thread will call all finalizers
GC.WaitForPendingFinalizers(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-19T14:55:22.833

是的，但不是马上。此摘录来自[垃圾收集：Microsoft .NET Framework 中的自动内存管理（MSDN 杂志）](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx) (*)

> “当应用程序创建一个新对象时，new 操作符从堆中分配内存。如果对象的类型包含一个 Finalize 方法，那么一个指向该对象的指针被放置在终结队列中。终结队列是一个内部数据结构受控由垃圾收集器。队列中的每个条目都指向一个对象，该对象应该在对象的内存被回收之前调用其 Finalize 方法。
> 
> 当 GC 发生时……垃圾收集器扫描终结队列以寻找指向这些对象的指针。当找到一个指针时，该指针将从终结队列中删除并附加到 freachable 队列（发音为“F-reachable”）。freachable 队列是由垃圾收集器控制的另一个内部数据结构。freachable 队列中的每个指针都标识了一个准备好调用其 Finalize 方法的对象。
> 
> 有一个专门用于调用 Finalize 方法的特殊运行时线程。当 freachable 队列为空时（通常是这种情况），该线程休眠。但是当条目出现时，该线程唤醒，从队列中删除每个条目，并调用每个对象的 Finalize 方法。因此，您不应在 Finalize 方法中执行任何对正在执行代码的线程做出任何假设的代码。例如，避免在 Finalize 方法中访问线程本地存储。”

(*) 从 2000 年 11 月开始，事情可能会发生变化。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-19T14:57:58.940

当垃圾被收集时（无论是响应内存压力还是`GC.Collect()`），需要终结的对象被放入终结队列。

除非您调用`GC.WaitForPendingFinalizers()`，否则终结器可能会在垃圾收集完成后很长一段时间内继续在后台执行。

* * *

顺便说一句，不能保证最终会被调用*。*从[MSDN](http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx) ...

> 在以下异常情况下，Finalize 方法可能不会运行完成或根本不会运行：
> 
> *   另一个终结器无限期地阻塞（进入一个无限循环，试图获得一个它永远无法获得的锁，等等）。因为运行时会尝试运行终结器以完成，所以如果终结器无限期地阻塞，则可能不会调用其他终结器。
> *   该进程在没有给运行时清理机会的情况下终止。在这种情况下，运行时的第一个进程终止通知是 DLL_PROCESS_DETACH 通知。
> 
> 只有在可终结对象的数量继续减少时，运行时才会在关闭期间继续终结对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-31T22:54:14.273

这里还有几点值得说明。

终结器是 .net 对象可以释放非托管资源的最后一点。仅当您未正确处置实例时才执行终结器。**理想情况下，终结器在许多情况下都不应该被执行。**因为正确的 dispose 实现应该[抑制 finalization](https://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize(v=vs.110).aspx)。

[这是正确 IDispoable Implementation 的示例](https://stackoverflow.com/a/31016954/591656)。

如果您调用任何一次性对象的 Dispose 方法，它应该清除所有引用并抑制终结。如果有任何不太好的开发人员忘记调用 Dispose 方法，Finalizer 就是救命稻草。*

# .net - 有没有办法强制所有网络请求通过代理？

> ID：13954833
> 
> 赞同：0
> 
> 时间：2012-12-19T14:47:12.970
> 
> 标签：.net, networking, powershell, configuration, proxy

我在办公室工作，必须使用 http 代理才能访问互联网。

是否有任何 $PSvariable 或环境变量会告诉 powershell 在请求外部资源时使用 http 代理？（就像 linux 中的 http_proxy env var : )`http_proxy=http://username:password@host:port/
export http_proxy`

我知道我可以为 webclient 做

```
$proxy = [System.Net.WebRequest]::GetSystemWebProxy()
$proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials
$web = New-Object System.Net.WebClient
$web.proxy = $proxy 
```

, 为 pssessions 做

```
$PSSessionOption = New-PSSessionOption -ProxyAccessType IEConfig -ProxyAuthentication Negotiate -ProxyCredential Domain\User 
```

但有时我找不到任何解决方案，例如如何`update-help |save-help` 通过代理使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T11:36:47.240

PowerShell（以及 Windows 上的大多数其他东西）将使用 Internet Explorer 中配置的代理设置。正确设置它应该可以工作；您可能需要使用 IE 访问一些站点，以确保处理任何身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T17:51:08.320

回答是因为我没有足够的声誉来发表评论。

如果您使用代理配置文件，而不是直接设置代理设置，这将不起作用。事实上，即使直接指定代理，我也无法让它工作。

我看到的唯一解决方案来自 Ravikanth Chaganti

[Save-Help 困境和解决方案](http://www.ravichaganti.com/blog/?p=2501)

有一个 MS Connect 请求修复此问题： [MS Connect](http://connect.microsoft.com/PowerShell/feedback/details/730195/save-help-failure-unable-to-connect-to-help-content-error-while-connected-to-internet-via-corporate-proxy-server)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-04T08:59:12.163

```
I use the following script for Update-Help for Computers behind a proxy with authentication:
# -------------------------------
#Requires -RunAsAdministrator
$wc = New-Object System.Net.WebClient
$proxyUserName  = Read-Host -Prompt "Proxy User Name"
$proxySecPasswd = Read-Host -Prompt "Password für $proxyUserName"  -AsSecureString
$credentials = New-Object System.Management.Automation.PSCredential($proxyUserName, $proxySecPasswd)
$wc.Proxy.Credentials = $credentials
Update-Help -UICulture 'en-US'
# ------------------------------- 
```

# entity-framework - EntityFramework 5 和存储库

> ID：13954839
> 
> 赞同：0
> 
> 时间：2012-12-19T14:47:25.060
> 
> 标签：entity-framework, repository

我正在学习 EF 5，并试图了解将存储库从主窗口（加载点）传递到视图模型的原因。

我读过最好的使用方法`context`是通过`block`这样的使用：

```
 // within CompanyViewModel
        using (var _context = new MyEntities())
        {
            var _query = from co in _context.Companies
                         select co;
            this.AllCompanies = new ObservableCollection<Models.Company>(_query);

        } 
```

`MyEntities`VS在EDMX文件中创建的对象在哪里。

所以我的问题是，如果我可以简单地从 ViewModel 调用 MyEntities，为什么我要将存储库（对 的引用`MyEntities`）传递给每个 ViewModel？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:00:31.190

因为它通过将与数据库交互的代码与驱动应用程序客户端部分的代码分开，从而使您的代码在本质上更具可测试性。

有关存储库模式及其一般用途的更多说明，请参阅[此处](http://www.remondo.net/repository-pattern-example-csharp/)和[此处](http://www.codeproject.com/Articles/363501/Repository-pattern-with-Entity-Framework-Code-Firs)的帖子。

# python - 如何将 LF 转换为 CRLF？

> ID：13954840
> 
> 赞同：10
> 
> 时间：2012-12-19T14:47:26.227
> 
> 标签：python, unix

我在网上找到了大部分英文单词的列表，但换行符是 unix 风格的（以 Unicode 编码：UTF-8）。我在这个网站上找到了它：http: [//dreamsteep.com/projects/the-english-open-word-list.html](http://dreamsteep.com/projects/the-english-open-word-list.html)

如何将换行符转换为 CRLF，以便可以遍历它们？我将在其中使用它们的程序会遍历文件中的每一行，因此单词必须每行一个。

这是文件的一部分：`bitbackbitebackbiterbackbitersbackbitesbackbitingbackbittenbackboard`

它应该是：

```
bit
backbite
backbiter
backbiters
backbites
backbiting
backbitten
backboard 
```

如何将我的文件转换为这种类型？注意：它是 26 个文件（每个字母一个），总共 80,000 个单词左右（所以程序应该非常快）。

我不知道从哪里开始，因为我从未使用过 unicode。提前致谢！

`rU`用作参数（如建议的那样），在我的代码中使用：

```
with open(my_file_name, 'rU') as my_file:
    for line in my_file:
        new_words.append(str(line))
my_file.close() 
```

我收到此错误：

```
Traceback (most recent call last):
  File "<pyshell#5>", line 1, in <module>
    addWords('B Words')
  File "D:\my_stuff\Google Drive\documents\SCHOOL\Programming\Python\Programming Class\hangman.py", line 138, in addWords
    for line in my_file:
  File "C:\Python3.3\lib\encodings\cp1252.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
UnicodeDecodeError: 'charmap' codec can't decode byte 0x8d in position 7488: character maps to <undefined> 
```

谁能帮我这个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-19T14:53:16.380

而不是转换，您应该能够使用 Python 的[通用换行支持](http://docs.python.org/2/glossary.html#term-universal-newlines)打开文件：

```
f = open('words.txt', 'rU') 
```

（注意`U`.）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-19T14:51:57.387

您可以使用字符串的替换方法。像

```
txt.replace('\n', '\r\n') 
```

编辑：
在你的情况下：

```
with open('input.txt') as inp, open('output.txt', 'w') as out:
    txt = inp.read()
    txt = txt.replace('\n', '\r\n')
    out.write(txt) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T22:30:49.727

您无需转换文件中的行尾即可对其进行迭代。正如 NPE 所建议的，只需使用[python 的通用换行符模式](http://docs.python.org/3/library/functions.html#open "python的通用换行模式")。

发生 UnicodeDecodeError 是因为您正在处理的文件被编码为 UTF-8 并且当您尝试将内容从字节解码为字符串时，通过`str(line)`，Python 正在使用`cp1252`编码将从文件读取的字节转换为 Python 3 字符串（即一系列 unicode 代码点）。但是，这些文件中的某些字节无法使用`cp1252`编码解码并导致 UnicodeDecodeError。

如果您更改`str(line)`为，`line.decode('utf-8')`您应该不再收到 UnicodeDecodeError。查看[文本与。数据而不是 Unicode Vs。8-bit](http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit) writeup 了解更多细节。

最后，您可能还会发现Joel Spolsky[的《每个软件开发人员绝对、肯定必须了解 Unicode 和字符集（没有借口！）的绝对最小值》很有用。](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-13T04:19:16.917

您可以使用 cereja 包

`pip install cereja==1.2.0`

`import cereja cereja.lf_to_crlf(dir_or_file_path)`

或者

`cereja.lf_to_crlf(dir_or_file_path, ext_in=[“.py”,”.csv”])`

您可以替换任何标准。查看文件工具模块

# python - 忽略大小写的字符串排序列表

> ID：13954841
> 
> 赞同：33
> 
> 时间：2012-12-19T14:47:35.297
> 
> 标签：python, sorting, lexicographic, lexicographic-ordering

我有一个列表，其中包含代表动物名称的字符串。我需要对列表进行排序。如果我使用`sorted(list)`，它将首先以大写字符串给出列表输出，然后是小写。

但我需要以下输出。

输入：

```
var = ['ant','bat','cat','Bat','Lion','Goat','Cat','Ant'] 
```

输出：

```
['ant', 'Ant', 'bat', 'Bat', 'cat', 'Cat', 'Goat', 'Lion'] 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-19T14:48:18.243

`sort()`方法和函数`sorted()`接受一个关键参数：

```
var.sort(key=lambda v: v.upper()) 
```

`key`为每个值调用in 命名的函数，排序时使用返回值，不影响实际值：

```
>>> var=['ant','bat','cat','Bat','Lion','Goat','Cat','Ant']
>>> sorted(var, key=lambda v: v.upper())
['ant', 'Ant', 'bat', 'Bat', 'cat', 'Cat', 'Goat', 'Lion'] 
```

要排序`Ant`before `ant`，您必须在键中包含更多信息，以便其他相等的值按给定顺序排序：

```
>>> sorted(var, key=lambda v: (v.upper(), v[0].islower()))
['Ant', 'ant', 'Bat', 'bat', 'Cat', 'cat', 'Goat', 'Lion'] 
```

更复杂的密钥生成`('ANT', False)`for`Ant`和`('ANT', True)`for `ant`; `True`排在后面`False`，因此大写的单词排在其等效的小写字母之前。

有关更多信息，请参阅[Python 排序 HOWTO](http://wiki.python.org/moin/HowTo/Sorting)。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-05-20T17:53:54.617

Python 3 的新答案，我想补充两点：

1.  用于[`str.casefold`](https://docs.python.org/3/library/stdtypes.html#str.casefold)不区分大小写的比较。
2.  直接使用该方法，而不是在 lambda 内部。

那是：

```
var = ['ant','bat','cat','Bat','Lion','Goat','Cat','Ant']

var.sort(key=str.casefold) 
```

（就地排序）现在：

```
>>> var
['ant', 'Ant', 'bat', 'Bat', 'cat', 'Cat', 'Goat', 'Lion'] 
```

或者，要返回一个新列表，请使用`sorted`

```
>>> var = ['ant','bat','cat','Bat','Lion','Goat','Cat','Ant']
>>> sorted(var, key=str.casefold)
['ant', 'Ant', 'bat', 'Bat', 'cat', 'Cat', 'Goat', 'Lion'] 
```

为什么这与`str.lower`or不同`str.upper`？[根据文档：](https://docs.python.org/library/stdtypes.html#str.casefold)

> 大小写折叠类似于小写，但更具侵略性，因为它旨在删除字符串中的所有大小写区别。例如，德语小写字母`'ß'`等价于`"ss"`. 由于它已经是小写字母，`str.lower()`因此不会对`'ß'`; `casefold()`将其转换为`"ss"`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-09-13T12:15:58.730

我需要添加另一个答案，因为接受的答案和较新的版本都*缺少一个重要的东西*：

这里提出的不区分大小写的排序在“相等”键的排序中*是不稳定的！*

这意味着：当您想要排序混合大小写字符串时，您会得到一个正确排序的列表，但不确定“AbC”是在“aBc”之前还是之后。这甚至可能在同一程序的运行之间有所不同。

为了始终使用稳定的默认字符串顺序获得相同的输出，我使用以下函数：

```
sorted(var, key=lambda v: (v.casefold(), v)) 
```

这样，当 casefold 版本不提供要排序的差异时，原始键始终作为后备排序附加。

# html - 屏幕亮度 可用于移动浏览器？

> ID：13954842
> 
> 赞同：2
> 
> 时间：2012-12-19T14:47:37.883
> 
> 标签：html, dom, browser, mobile-browser

浏览器是否可以使用设备的亮度级别？

我发现了这个 - [http://mzl.la/SSBobX](http://mzl.la/SSBobX) - 但我不确定这篇文章是否有效，因为我在屏幕对象或它所指的设置中找不到任何东西。

是否有跨浏览器的实现？

# neo4j - 您如何使用 RDBMS 实现图形数据库级别的性能？

> ID：13954845
> 
> 赞同：0
> 
> 时间：2012-12-19T14:47:47.393
> 
> 标签：neo4j, rdbms, graph-databases

我们有一个存储在关系数据模型中的数据模型，该模型实际上看起来像一个图。表的数量很少，但表很大，而且我们执行的查询类型通常有 5 个连接级别深。如果将此数据存储在图形数据库中，那将是最高效的，但我们没有该选项。如何使用 RDBMS 实现图形数据库级别的性能？您可以在数据库之上添加哪些工具，例如缓存、搜索索引、使用 OLAP 服务器，在这种情况下可以为您提供接近图形数据库性能的任何东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:44:37.503

> 如何使用 RDBMS 实现图形数据库级别的性能？

你没有，至少不是以同样的方式。两种系统都有其优点和缺点，试图将一个应用于另一个通常会导致一团糟。如果您在使用 RDBMS 时遇到困难，请为 RDBMS 设计数据模型。

> 您可以在数据库之上添加哪些工具，例如缓存、搜索索引、使用 OLAP 服务器，在这种情况下可以为您提供接近图形数据库性能的任何东西？

这取决于您的数据模型，也许您可​​以详细说明为什么不能使用图形数据库？可以让两者并排运行吗？

# java - Looping Algorithm

> ID：13954848
> 
> 赞同：8
> 
> 时间：2012-12-19T14:47:54.577
> 
> 标签：java, algorithm

How do I make this:

```
*******
-*****-
--***--
---*---
--***--
-*****-
******* 
```

The following is my code that I have written to try to accomplish the above, but it is not working as expected:

```
 public static void stars(/*int jmlBaris*/) {
    for ( int i = 7; i >= 1; i-=2) {
        for (int j = 1; j <= i; j++) {

            System.out.print("*");
        }
        System.out.println("");
    }

    for (int i = 1; i <= 7; i+=2) {
        for (int j = 1; j <= i; j++){
            System.out.print("*");
            }
        System.out.println("");
    }
}
public static void main(String[] args) {
    stars();
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T15:04:07.897

This is how I might write it.

```
// three loops
public static void stars(int size) {
    for (int y = 0; y < size; y++) {
        for (int i = 0; i < y && i < size - y - 1; i++)
            System.out.print(' ');
        for (int i = Math.min(y, size - y - 1); i < Math.max(y + 1, size - y); i++)
            System.out.print('*');
        System.out.println();
    }
} 
```

or

```
// two loops
public static void stars(int size) {
    for (int y = 0; y < size; y++) {
        for (int x = 0; x < size; x++)
            System.out.print(
                    (x >= y && x < size - y) ||
                            (x >= size - y - 1 && x <= y) ? '*' : ' ');
        System.out.println();
    }
} 
```

or

```
// one loop
public static void stars(int size) {
    for (int i = 0; i < size * size; i++) {
        int y = i / size, x = i % size;
        System.out.print(
                (x >= y && x < size - y) ||
                        (x >= size - y - 1 && x <= y) ? '*' : ' ');
        if (x == size - 1)
            System.out.println();
    }
} 
```

Note: Whether this uses one, two or three loops, the time complexity is O(N^2). A simple way to determine this is the number of stars produced is O(N^2) no matter how it is done.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:54:42.733

I would do something like this with substrings.

```
String a = "*******";  //7 stars
String blank = "        "; //7 spaces
int j = 7;
for (int i = 0; i < 7; i++) {
    if (i > j){
        System.out.print(blank.substring(0,i));
        System.out.println(a.substring(i,j));
        }
    else{
        System.out.print(blank.substring(0,j));
        System.out.println(a.substring(j,i));
        }
    j--;
}
System.out.println(a); 
```

**Previous edit wouldn't have worked. Changes made.

This works.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T14:50:47.557

Try something like this code I compiled on IDEOne (it seems to work, though): [http://ideone.com/9xZ1YB](http://ideone.com/9xZ1YB)

```
class Main
{
    public static void main(String[] args)
    {
        stars();
    }

    static void stars()
    {
        final int MAX_WIDTH = 7;

        for (int i = 0; i < 7; ++i)
        {
            int width;

            if (i < 3) width = MAX_WIDTH - i * 2;
            else if (i > 3) width = (i - 3) * 2 + 1;
            else width = 1;

            // Before spaces

            for (int j = 0; j < (MAX_WIDTH - width) / 2; ++j)
            {
                System.out.print(" ");
            }

            // Stars

            for (int j = 0; j < width; ++j)
            {
                System.out.print("*");
            }

            // After spaces

            for (int j = 0; j < (MAX_WIDTH - width) / 2; ++j)
            {
                System.out.print(" ");
            }

            System.out.println();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T16:41:07.473

For a beginner in algorithms I would recommend you to break down the structure in sub-parts and then try to solve the pattern.

For this specific pattern it could be broken down into several triangles. Each triangle is then solved by different `for` loops as shown in the image below.

![dividing the pattern into substructures](../Images/4fa6cfb722b568568e5d14d7393f91c4.png)

```
public static void printPattern(int num) {
    // this loop generates first 4 lines
    for (int i = 0; i < num / 2 + 1; i++) {
        // draws the red triangle of '-'
        for (int j = 0; j < i; j++) {
            System.out.print("-");
        }
        // draws the green triangle of '*'
        for (int j = i; j < num / 2 + 1; j++) {
            System.out.print("*");
        }
        // draws the blue triangle of '*'
        for (int j = i + 1; j < num / 2 + 1; j++) {
            System.out.print("*");
        }
        // draws the orange triangle of '-'
        for (int j = 0; j < i; j++) {
            System.out.print("-");
        }
        System.out.println();
    }

    /* this loop generates last 3 lines */
    for (int i = 0; i < num / 2; i++) {
        // draws the green triangle of '-'
        for (int j = i + 1; j < num / 2; j++) {
            System.out.print("-");
        }
        // draws the red triangle of '*'
        for (int j = 0; j < i + 2; j++) {
            System.out.print("*");
        }
        // draws the orange triangle of '*'
        for (int j = 0; j < i + 1; j++) {
            System.out.print("*");
        }
        // draws the blue triangle of '-'
        for (int j = i + 1; j < num / 2; j++) {
            System.out.print("-");
        }
        System.out.println();
    }
} 
```

Using similar technique you could generate any pattern.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T14:59:30.347

If I understood you right, your problem is to print indent in lines 2-7.

Imagine same problem with asterisk symbol replaced by 'x' and whitespace replaced by '-'. Then you need to draw

```
xxxxxxx
-xxxxx-
--xxx--
---x---
--xxx--
-xxxxx-
xxxxxxx 
```

That means you should output 0, 1, 2 space(s) before asterisks in first, second, thrid strings respectively. I let details for you to figure them out.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T15:12:58.793

```
 public static void stars(/*int jmlBaris*/){
    String starstr = "*";
    String blank = "_";
    int spaceBlank;;
    for(int i=7; i>=1;i-=2){
        spaceBlank = (7-i)*.5;
        String starrep = StringUtils.repeat(starstr, i);
        String blankrep = StrinUtils.repeat(blank, spacesBlank);
        system.out.println(blankrep + starrep + blankrep);
    }
    for(int j=3 j<=7; j+=2){
        spaceBlank = (7-j)*.5;
        starrep = StringUtils.repeat(starstr, j);
         String blankrep = StrinUtils.repeat(blank, spacesBlank);
        system.out.println(blankrep + starrep  + blankrep);
    }
}    
public static void main(String[] args){
    stars();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-19T15:38:17.330

You have little missing to put space on your code. I don't care about right space, who can see that? But left space is very important!!

Try this:

```
public static void stars(/*int jmlBaris*/) {
    for ( int i = 7; i >= 1; i-=2) {
        for (int k = 0; k < ((7-i) / 2); k++){ /* Missing Here */
            System.out.print(" "); /* Missing Here */
        } /* Missing Here */

        for (int j = 1; j <= i; j++) {
            System.out.print("*");
        }

        System.out.println("");
    }

    for (int i = 1; i <= 7; i+=2) {
        for (int k = 0; k < ((7-i) / 2); k++){ /* Missing Here */
            System.out.print(" "); /* Missing Here */
        } /* Missing Here */

        for (int j = 1; j <= i; j++){
            System.out.print("*");
        }

        System.out.println("");
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-19T16:47:53.703

```
 int N = 7;
    for (int y=0; y<N; y++)
    {
        for (int x=0; x<N; x++)
            System.out.print( (y-x)*(N-y-x-1)<=0 ? '*' : '-');
        System.out.println();
    } 
```

or, more symmetrically,

```
 int n = 3;
    for (int y=-n; y<=n; y++)
    {
        for (int x=-n; x<=n; x++)
            System.out.print( y*y>=x*x ? '*' : '-');
        System.out.println();
    } 
```

# image - 将图像/纹理映射到预定义的不平整表面（带褶皱的 T 恤、杯子等）

> ID：13954851
> 
> 赞同：3
> 
> 时间：2012-12-19T14:48:04.597
> 
> 标签：image, image-processing, graphics, 3d, textures

基本上我试图实现这一点：将任意图像强加到预定义的不平整表面。（见下面的例子）。

![任何图像](../Images/6545fc46687827474aca90c2f5926931.png)-->![在此处输入图像描述](../Images/03e41a3371fe21190364eccbbeee4688.png)

我在图像处理或 3D 算法方面没有太多经验，所以这是迄今为止我能想到的最好的方法：

1.  预定义一组坐标（假设我们有一个 10x10 的网格，我们有 100 个以 (0,0)、(0,10)、(0,20) 等开头的坐标。将有 9x9 = 81网格。
2.  记录 T 恤图像上每个单独坐标的转换，例如 (0,0) 变为 (51,31)，(0, 10) 变为 (51, 35) 等。
3.  将原始图像三角化为 81x2=162 个三角形（每个网格有 2 个三角形）。根据步骤 2 中得到的坐标变换对图像的每个三角形进行变换，并将其绘制在 t 恤图像上。

我遇到的问题/疑问：

1.  我不知道如何平滑每个三角形，以使 T 恤上的图像看起来不破旧。
2.  有更好的方法吗？在继续实施之前，我想确保我没有在这里重新发明轮子。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T17:10:33.430

这称为*数字图像变形*。1990 年代有一个[流行的图形文本](https://rads.stackoverflow.com/amzn/click/com/0818689447)（可能来自某人的论文）。您还可以从 Dobb 博士的日记中找到[一篇关于它的文章。](http://www.drdobbs.com/an-algorithm-for-efficient-image-warping/184401431)

你的过程基本上是正确的。如果您逐个像素地工作，而不是尝试使用三角形，您将避免您面临的一些问题。扫描目标位图中的像素，并根据您所在的单元格应用局部变换以确定源位图中相应像素的坐标。复制那个像素。

为了获得更平滑的结果，您可以在浮点中进行坐标转换，并使用[双线性插值之类的方法对源图像中的像素值进行插值](http://en.wikipedia.org/wiki/Bilinear_interpolation)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T15:31:51.063

这并不是真正的问题解决方案，它只是一种解决方法：

如果您有代表 T 恤的 3D 模型。您可以使用 directX\OpenGL 并将您的图像作为 T 恤的纹理。然后你可以要求它从任何角度渲染你想要的图片。

# python - Python unicode 规范化：将 u'\xb4' 转换为 u' \u0301' 是否正确

> ID：13954852
> 
> 赞同：8
> 
> 时间：2012-12-19T14:48:07.917
> 
> 标签：python, unicode

查看以下代码段：

```
>>> import unicodedata
>>> from unicodedata import normalize, name

>>> normalize('NFKD', u'\xb4')
u' \u0301'

>>> normalize('NFKD', u'a\xb4a')
u'a \u0301a'

>>> normalize('NFKC', u'a\xb4a')
u'a \u0301a'

>>> name(u'\xb4'), name(u'\u0301')
('ACUTE ACCENT', 'COMBINING ACUTE ACCENT') 
```

我试图了解要翻译的行为`u'\xb4'`是否`u' \u0301'`正确。为什么它用空格填充组合的尖锐重音？为什么它要翻译 u`\xb4`呢？

在[文件格式](http://www.fileformat.info/info/unicode/char/b4/index.htm)中，我们看到`ACUTE ACCENT`曾经被称为`SPACING ACUTE`. 我想，这只是意味着光标应该移动而不是等待输入以下字符。

UPD：如果有人感兴趣，这里是一个列表，如果 NFKC 规范化后的 unicode 字符在开头有空格：http: [//pastebin.com/Z99r5AK9](http://pastebin.com/Z99r5AK9)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T14:51:05.950

重音字符是空格和组合重音字符的组合，如 Unicode 标准中所指定：

```
>>> import unicodedata
>>> unicodedata.decomposition(u'\xb4')
'<compat> 0020 0301' 
```

该`\u00B4`字符的历史有些模糊，但 Unicode 标准已决定将其视为空格 + 重音符号，尽管它*经常*被用作变音符号，请参阅[此讨论](http://www.unicode.org/mail-arch/unicode-ml/y2010-m09/0067.html)。

您也许可以[`\u02CA`](http://www.fileformat.info/info/unicode/char/02ca/index.htm)用作替代方案；它不被视为空格，并且没有指定分解。相反，它被限定为字母，因此您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:56:00.943

查看[Unicode Collat​​ion Algorithm](http://www.unicode.org/reports/tr10/tr10-26.html)文档。特别要注意的是

> 兼容性规范化 (NFKC) 将独立重音折叠为空格 + 组合重音的组合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T14:58:41.013

在 NFKD 中，重音字符以“拆分”方式存储：首先是要重音的字符，然后是组合重音：`u' \u0301'`

在 NFKC 中，重音字符以“组合”方式存储：有一个专用的 Unicode 代码点：`u'\xb4'`，它是`u'\u00b4'`.

它们都只代表重音，可以看作是空格字符上的重音。

# php - 使用循环打印时如何在 DIV 上应用边距？

> ID：13954853
> 
> 赞同：3
> 
> 时间：2012-12-19T14:48:08.840
> 
> 标签：php, html, css

这是我的代码：

```
<?php 
     $qr = mysql_query("SELECT * FROM products");
     while($res = mysql_fetch_array($qr)):
?>

<div class="box">
    <p><?php echo $res[1]; ?></p>
    <img src="<?php echo $res[3]; ?>" width="100" /><br />
    <a href="<?php echo $res[4]; ?>">View Data Sheet</a>            
</div>

<?php 
    endwhile; 
?> 
```

我想要这样的获取记录的输出[http://jsfiddle.net/CqYhE/3/](http://jsfiddle.net/CqYhE/3/)

请帮助我，如何在使用 php 循环打印时仅在每行的中心 div 上应用 10px 的边距（左右）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:26:08.080

**这是您的解决方案：**

*这将适用于**N**个部门。*

```
<?php 
    $qr = mysql_query("SELECT * FROM products");

    $count = 1;
    $margin='';

    while($res = mysql_fetch_array($qr)):
        $count == 2 ? $margin='style="margin:0px 10px;"' : $margin = '';
        $count == 3 ? $count = 1 : $count++;
?>    

    <div class="box" <?php echo $margin; ?>>
        <p><?php echo $res[1]; ?></p>
        <img src="<?php echo $res[3]; ?>" width="100" /><br />
        <a href="<?php echo $res[4]; ?>">View Data Sheet</a>            
    </div>

<?php 
    endwhile; 
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:36:30.350

这最好通过 CSS 解决方案来实现。如果您忘记了左边距而只应用了右边距，则可以将其从最后一个孩子中删除。更少的 CSS 行数因此性能更好。

```
.box{
    float: left;
    width:245px;
    height:200px;
    background-color:#0CC;
    margin: 0 20px 10px 0;
}
.box:last-child {
    margin-right: 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T14:55:12.507

使用 CSS`:first-child`和`:last-child`选择器

```
#container .box{
    float: left;
    width:245px;
    height:200px;
    background-color:#0CC;
    margin-bottom:10px;
    margin-left:10px;
    margin-right:10px;
}
#container .box:first-child,
#container .box:last-child { margin-left:0px; margin-right:0px;} 
```

如果您有多个行，则需要更改 html 以使其变得容易：请参阅此**[演示](http://jsbin.com/owokov/1)**

# php - KineticJS - 文本度量 - 如何获取文本基线的位置？

> ID：13954862
> 
> 赞同：1
> 
> 时间：2012-12-19T14:48:25.633
> 
> 标签：php, html, canvas, fpdf, kineticjs

我`KineticJS`使用可拖动的 Kinetic.text 来定位文本，然后`PDF`根据屏幕上文本的高度和宽度导出到。

我使用的 pdf 导出器 ( `fpdf`) 从基线测量文本，但 Kinetic 似乎从顶部测量。

知道如何改变它的测量位置或获得动力学或 FPDF 的差异值吗？

# sql-server - SQL Server 内部联接冲突列

> ID：13954864
> 
> 赞同：1
> 
> 时间：2012-12-19T14:48:33.530
> 
> 标签：sql-server, asp-classic

我正在修复另一个已停止工作的开发人员编写的旧经典 ASP 站点中的错误。下面的 SQL 命令用于调用数据库中的数据来创建表：

```
SELECT * 
FROM tblPropertyInfo 
INNER JOIN tblUsers on p_CustomerID = u_ID 
WHERE 
    p_Paid = 0 OR p_Enabled = 0 AND p_CustomerID <> 4 
ORDER BY " & orderby 
```

问题是两者都`tblPropertyInfo`包含`tblUsers`一个列`p_Type`。在`tblPropertyInfo`, 中`p_Type`存储它是什么类型的属性，这是我们要在表中显示的值，但是我怀疑这被表中的大部分 NULL 值覆盖，`p_Type`因此`tblUsers`返回表中的空单元格。

我不想开始使用表结构，因为它们在整个站点中都使用，如果我在一个地方更改它，将会找到对它的每一个引用并全部更新它们。

有没有办法可以指定从哪个表中提取列？

当前使用以下方法调用值：

```
<%=rsProperty("p_Type")%> 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:50:06.377

尝试：

```
<%=rsProperty("tblUsers.p_Type")%> 
```

如果这不起作用，您可以修改查询以仅返回一种类型（以及您可能想要的任何其他列）：

```
SELECT  tblUsers.p_Type
,       ... other columns here ...
FROM tblPropertyInfo 
INNER JOIN tblUsers on p_CustomerID = u_ID 
WHERE 
    p_Paid = 0 OR p_Enabled = 0 AND p_CustomerID <> 4 
ORDER BY " & orderby 
```

如果您想继续使用`*`，可以使用别名：

```
SELECT  tblUsers.p_Type as TheType
,       * 
```

您可以参考如下：

```
<%=rsProperty("TheType")%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T14:53:57.160

您可以限定您想要的值来自哪些表格：

```
SELECT tblPropertyInfo.* FROM tblPropertyInfo INNER JOIN tblUsers on p_CustomerID = u_ID WHERE p_Paid = 0 OR p_Enabled = 0 AND p_CustomerID <> 4 
```

以上将从 tblPropertyInfo 中选择所有内容，但不会从 tblUsers 中选择任何内容

或者列出您实际想要返回的属性（显然要放入真实的列名！）

```
SELECT tblPropertyInfo.Id, tblUsers.p_Type, tblPropertyInfo.SomethingElse FROM tblPropertyInfo INNER JOIN tblUsers on p_CustomerID = u_ID WHERE p_Paid = 0 OR p_Enabled = 0 AND p_CustomerID <> 4 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T14:56:07.263

您可以为这些列设置别名 - 最好是因为消除了潜在的错误。

```
SELECT *, tbl_Users.p_Type AS users_type, tbl_PropertyInfo.p_type AS property_type FROM ... 
```

当然，您可以使用别名访问这些字段。

# wpf - 默认按钮上的 WPF 按钮内容 VerticalAlignment

> ID：13954867
> 
> 赞同：3
> 
> 时间：2012-12-19T14:48:42.633
> 
> 标签：wpf, xaml, expression-blend

我无法在默认按钮上垂直居中文本（未使用样式或模板）

我看到了像这样的线程

[WPF 按钮中的文本内容未垂直居中](https://stackoverflow.com/questions/3839618/text-content-in-a-wpf-button-not-being-centred-vertically)

^^ 我没有在按钮 1 中设置任何文字高度。

不确定是什么导致了这种行为，以及当本地化出现时如何有效地摆脱它。

我知道我可以设置一个 -ve 边距来精确对齐文本，但这可能会导致另一种语言的错误。这是基于默认字体系列表达式混合的一些限制吗？

对此的任何帮助都会很棒。似乎微不足道，但似乎无法为导致这种行为的原因找到一个体面的解释。

Xaml 代码如下：

```
<Window x:Class="TestButton.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Button Content="ButtonFFAH" HorizontalAlignment="Left" VerticalAlignment="Top" Width="75" VerticalContentAlignment="Center"/>
  <Button Content="ButtonAH" HorizontalAlignment="Left" VerticalAlignment="Top" Width="75"
                Margin="80,0,0,0" Height="15.627"  VerticalContentAlignment="Center"/>        
</Grid> 
```

![输出](../Images/8ab9725edfe31497c5af22e2890b6a19.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T15:08:18.560

它是如何在内部工作的。如果您想要更多控制，只需使用更多可自定义的内容填充按钮内容，而不仅仅是一个字符串。像这样：

```
<Button HorizontalAlignment="Left" VerticalAlignment="Top" Width="75"
        Margin="80,0,0,0" Height="15.627"  VerticalContentAlignment="Center">
     <TextBlock VerticalAlignment="Center">ButtonAH</TextBlock>
</Button> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:36:41.120

明显的垂直错位是由于各种重音符号或其他变音符号增加了总字体高度。尽管实际的 Button 内容可能不包含此类字符，但垂直对齐必须考虑到这一点，以确保与具有相同“外部”对齐方式的其他 Button 的公共基线对齐，例如在同一 Grid 行中。

# .net - 在 azure 模拟器上运行 mvc 网站

> ID：13954870
> 
> 赞同：2
> 
> 时间：2012-12-19T14:48:58.397
> 
> 标签：.net, asp.net-mvc, visual-studio, azure, azure-web-roles

我在视觉工作室本地运行一个网站。已安装 Azure sdk 和模拟器。由于某种原因，它在本地 iis 下运行，而不是使用 azure 模拟器。

我怎样才能让它与模拟器一起运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:11:15.503

是的。您只需**选择您的 Azure 角色项目作为默认项目**，如下所示。

**步骤1 ：**

![在此处输入图像描述](../Images/51f715cd8a79d110dcce298fa74c5acc.png)

**第2步**

![在此处输入图像描述](../Images/ca1dd763ac0ed76e30644d83914ab82b.png)

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:10:58.747

确保您的云项目，而不是 mvc 项目，是启动项目。这应该然后在模拟器中运行该站点。

# php - 打开没有重定向的 PHP 页面？

> ID：13954872
> 
> 赞同：3
> 
> 时间：2012-12-19T14:49:05.480
> 
> 标签：php, curl, module, whmcs

我一直在为我们的计费系统编写一个模块，它工作得很好。不幸的是，API 缺少我需要立即终止服务的功能，这让我只能选择直接调用 URL...

[http://www.website.com/billing/admin/clientsservices.php?userid=69264&id=68405&modop=terminate](http://www.website.com/billing/admin/clientsservices.php?userid=69264&id=68405&modop=terminate)

由于模块需要在不重定向到该 URL 的情况下继续运行，我如何从我的 PHP 脚本中执行它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:55:47.133

你可以简单地使用 file_get_contents();

```
<?php
file_get_contents('http://www.website.com/billing/admin/clientsservices.php?userid=69264&id=68405&modop=terminate');
?> 
```

它会被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:57:42.767

为什么不直接使用 curl 将数据 POST 到 URL 而不是使用 GET？

[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

# haskell - 为什么数据类型虽然是 show 类的成员却不能序列化？

> ID：13954878
> 
> 赞同：3
> 
> 时间：2012-12-19T14:49:16.087
> 
> 标签：haskell

```
data Mine = Firstname String
          | Lastname String
          deriving (Show, Serialize) 
```

这不会编译并给出错误

```
Not in scope: type constructor or class `Serialize' 
```

为什么这不被视为 Serialize 类的成员，尽管它是 Show 类的成员。我认为 Show 类的所有成员都应该毫无问题地序列化？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T14:57:29.100

该错误表示`Serialize`类型类不在范围内。您需要导入定义类型类的包才能使用它。你可能想要：

```
import Data.Serialize 
```

从[麦片](http://hackage.haskell.org/packages/archive/cereal/latest/doc/html/Data-Serialize.html#t%3aSerialize)包装。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T16:48:59.190

如果您确实想为您的类自动派生 Serialize，您可以这样做：

```
{-# LANGUAGE DeriveGeneric #-}

import Data.Serialize (Serialize)
import GHC.Generics (Generic)

data Mine = Firstname String
          | Lastname String
          deriving (Show, Generic)

instance Serialize Mine 
```

# mysql - Mysql - 仅选择列具有唯一值的行

> ID：13954879
> 
> 赞同：2
> 
> 时间：2012-12-19T14:49:16.807
> 
> 标签：mysql, select, group-by

我发现的最接近我正在寻找的东西是，所以我将使用它作为示例

[MySQL：选择除列之外只有唯一值的行](https://stackoverflow.com/questions/13606846/mysql-select-rows-that-have-only-unique-values-except-for-a-column)

给定这个数据集

```
+----+--------------+-------------+------+------+-------+-----+
| ID | SATELLITE_ID | ATT_TYPE_ID | TIME | ROLL | PITCH | YAW |
+----+--------------+-------------+------+------+-------+-----+
|  1 |            1 |           1 | 2012 |  1.0 |   2.0 | 1.3 |
+----+--------------+-------------+------+------+-------+-----+
|  2 |            1 |           1 | 2012 |  1.0 |   2.0 | 1.3 |
+----+--------------+-------------+------+------+-------+-----+
|  3 |            1 |           1 | 2011 |  1.0 |   2.0 | 1.3 |
+----+--------------+-------------+------+------+-------+-----+ 
```

我只想返回

```
+----+--------------+-------------+------+------+-------+-----+
| ID | SATELLITE_ID | ATT_TYPE_ID | TIME | ROLL | PITCH | YAW |
+----+--------------+-------------+------+------+-------+-----+
|  3 |            1 |           1 | 2011 |  1.0 |   2.0 | 1.3 |
+----+--------------+-------------+------+------+-------+-----+ 
```

因为它是唯一唯一的行

这可以用mysql吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T14:52:36.223

```
SELECT 
    ID, 
    SATTELLITE_ID, 
    ATT_TYPE_ID, 
    TIME, 
    ROLL, 
    PITCH, 
    YAW 
FROM Table 
GROUP BY 
    SATTELLITE_ID, 
    ATT_TYPE_ID, 
    TIME, 
    ROLL, 
    PITCH, 
    YAW 
HAVING COUNT(*) = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:52:16.613

`group by`与_`having count(*) = 1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:55:11.470

尝试这个：

```
SELECT * FROM temptbl 
GROUP BY satellite_id, att_type_id, time, roll, pitch, yaw 
HAVING COUNT(*) = 1; 
```

# internet-explorer-9 - IE 使用函数调用运行得更快？

> ID：13954881
> 
> 赞同：7
> 
> 时间：2012-12-19T14:49:23.417
> 
> 标签：internet-explorer-9, function-calls, performance

寻找优化我的代码的方法，我偶然发现了[这个 jsPerf 测试](http://jsperf.com/function-calls-vs-inline/2)。除了重申我对函数调用缓慢的概念之外，没有任何期待，我在 IE 9 上的结果真的让我陷入了一个循环。利用函数调用的代码*更快*，但仅在这一浏览器上。我多次运行它，结果相同。我看不到测试设置不正确。什么可能导致这种奇怪的结果？

我的用户代理`Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0`在 Windows Server 2008 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-13T19:33:46.037

**免责声明：**我是[jsPerf.com](http://jsperf.com/)的创建者。

* * *

您的第一个测试如下：

```
var i = 0;
for (i = 0; i < 1000; i++) {
  test()
} 
```

为什么要在其中包含`for`循环？它只会扭曲结果。jsPerf 会自动重复测试代码，直到它执行了足够的测试以达到统计上显着的结果。理想情况下，jsPerf 测试尽可能紧凑，并且只测试您真正想要测试的内容。在这种情况下，您根本对`for`循环性能不感兴趣——您只想知道内联代码是否比调用函数更快。

如果您对创建健壮的 jsPerf 测试用例的其他技巧感兴趣，[请查看我的 #jsconfeu2011 演示文稿](http://blip.tv/jsconfeu/mathias-bynens-using-jsperf-correctly-5681343)。

注意：我并不是说冗余`for`循环是您看到此结果的原因。这可能是一个因素，但可能还有其他因素会进一步扭曲结果。[这可能是 IE9 的“死代码删除”功能发挥作用。](http://mathiasbynens.be/notes/javascript-benchmarking#browser-bugs-and-features)

无论如何，我已经分叉了你的 jsPerf 测试，删除了循环，并使变量成为全局变量，以避免死代码消除优化。[http://jsperf.com/function-calls-vs-inline/3](http://jsperf.com/function-calls-vs-inline/3)你能在 IE9 中测试这个吗？目前我手边没有 IE9 虚拟机。

# nhibernate - NHibernate 动态更新的缺点？

> ID：13954882
> 
> 赞同：16
> 
> 时间：2012-12-19T14:49:26.830
> 
> 标签：nhibernate, nhibernate-mapping

是否有理由不使用`dynamic-insert`/`dynamic-update`用于 NHibernate？我问的唯一原因是它似乎是我希望将其作为默认启用的东西，而不是我必须配置的东西。

使用这些动态属性时有什么需要注意的问题吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-19T15:11:08.513

对于某些实体，您可能会通过动态更新创建无效状态。假设您有一个`Class`带有属性的`Boolean`属性`A`和一个逻辑依赖的`Integer`属性`B`。如果 Property`A`是`True`，那么 Property`B`只能是负数，如果 Property`A`是`False`，那么 Property`B`只能是正数。

假设两个用户都在给定的时间跨度内与此类的一个实例进行交互。首先，用户 Alice 和 Bob 都从数据库中实现了这个类，初始值为`A`= True 和`B`= -50

```
Database   Alice       Bob
A: True    A: True     A: True
B: -50     B: -50      B: -50
VALID      VALID       VALID 
```

用户 Alice 更改`A`为125`False`和`B`125，并将其提交到数据库。现在我们有这种情况：

```
Database   Alice       Bob
A: False   A: False    A: True
B: 125     B: 125      B: -50
VALID      VALID       VALID 
```

用户 Bob 没有更改`A`，而是更改`B`为 -75，然后将其提交到数据库。如果动态更新开启，NHibernate 会看到 Bob 仅更改`B`为 -75，并发出仅编辑 的值的动态更新`B`。如果您在服务器上进行了 SQL 验证以防止`B`出现负数，除非`A`为真，那么您会在此处收到 SQL 错误，但假设您尚未在 SQL 表上重现所有业务逻辑。这是结果数据：

```
Database   Alice       Bob
A: False   A: False    A: True
B: -75     B: 125      B: -75
INVALID    VALID       VALID 
```

Alice 和 Bob 都有有效的状态，但数据库现在处于无效状态！用户 Charlie 出现并尝试实现此记录：

```
Database   Alice       Bob       Charlie
A: False   A: False    A: True   A: False
B: -75     B: 125      B: -75    B: -75 
INVALID    VALID       VALID     INVALID 
```

当 NHibernate 尝试设置类的新实例的 B 属性时，Charlie 可能会从您的应用程序中收到验证错误。

因此，当您具有逻辑相关属性时，您必须制定一些策略来避免这种情况。一种可能性是简单地启用`select-before-update`该实体。这可能会导致一些额外的数据库调用和稍慢的性能。另一个是在 NHibernate 中使用版本控制，这意味着当 Bob 尝试保存他的记录时，NHibernate 的插入查询不会触发任何写入并抛出过时数据异常（可以优雅地处理）。您也可以在数据库中编写类的逻辑要求，但是您必须谨慎确保数据库和程序随着时间的推移都具有相同的编码要求，并且您将有多个地方当需求发生变化时进行更改，这并不总是值得的开销。

所以简而言之，在许多情况下，开发人员必须仔细处理动态更新的细节，这就是默认情况下不启用的原因。打开它时，请考虑对实体的部分更新是否会导致问题，如果是，请使用我推荐的一种缓解策略来防止该问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T15:38:30.690

动态插入和更新有轻微的性能成本，因为 NHibernate 每次都必须构造 SQL 而不是缓存它。我不知道数据库方面是否有成本。动态插入和更新对于故障排除和分析非常方便。如果我能够衡量一个有意义的性能影响，我会在开发中打开它并在生产中关闭它。

您可能会遇到侦听器和拦截器的问题，请参阅[此问题](https://stackoverflow.com/questions/4383420/nhibernate-preupdate-event-listener-not-persisting-changes)。

我在我的 NHibernate 应用程序中打开了它，没有任何问题。我的回答是否定的，没有充分的理由不使用它。

# android - Android XML 颜色显示为灰色？

> ID：13954894
> 
> 赞同：1
> 
> 时间：2012-12-19T14:49:52.533
> 
> 标签：android, colors

我正在尝试将 Paint.setColor() 与 res/values/colors.xml 中的颜色一起使用，但它不断出现“灰色”。如果我改用字符串文字并使用 Paint.parseColor() 它会正确显示。这是怎么回事？

onDraw()

```
p.setColor (Color.parseColor ("#82ef82")); // <- this works
p.setColor (R.color.PeaGreen); // <- this is gray 
```

颜色.xml

```
<color name="PeaGreen">#82ef82</color> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T14:53:08.773

`R.color.PeaGreen`不是颜色，它是颜色资源的资源 ID。但由于颜色由整数表示，资源 ID 也是如此，因此它不会引发任何警告或错误。您需要做一些工作才能从资源 ID 中获取实际颜色：

```
p.setColor(context.getResources().getColor(R.color.PeaGreen)); 
```

[Color](http://developer.android.com/reference/android/graphics/Color.html)类中还定义了一些颜色常量，您可以像这样使用它们：

```
p.setColor(Color.RED); 
```

# css - Iconfont的字形没有出现在浏览器中

> ID：13954899
> 
> 赞同：0
> 
> 时间：2012-12-19T14:49:59.217
> 
> 标签：css, icons, typography

我按照本教程使用inkscape创建了一个iconfont：[http ://www.webdesignerdepot.com/2012/01/how-to-make-your-own-icon-webfont/](http://www.webdesignerdepot.com/2012/01/how-to-make-your-own-icon-webfont/)

它运作良好，但我的一个字形没有出现在网站上。我可以在任何程序中编写该字形，但在浏览器中看不到它。该网站是：[http](http://www.goldentree.de/wordpress/) ://www.goldentree.de/wordpress/您可以在左侧“Article Test X”的 h2 中找到字形。缺失的字形是小 f，应该看起来像一个 facebook 图标。例如，如果您将其粘贴到记事本中，您可以复制它并出现 f。我不确定这个问题是否属于这里，但问题只出现在浏览器中，所以我猜它确实存在。

# android - 将视频发布到 youtube

> ID：13954901
> 
> 赞同：0
> 
> 时间：2012-12-19T14:50:01.373
> 
> 标签：android, youtube

在我们的应用程序中，我们希望在不使用 SHARE 键的情况下直接将视频文件上传到 youtube。

到目前为止，我找到了对此的参考： [http ://code.google.com/p/ytd-android/](http://code.google.com/p/ytd-android/)

但是当我尝试上传视频时收到此错误： [http ://code.google.com/p/ytd-android/issues/detail?id=13](http://code.google.com/p/ytd-android/issues/detail?id=13)

我还能尝试什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T12:22:15.867

您可以通过在您的 Youtube 帐户中创建一个频道（用于在此项目中静态登录的频道）轻松解决此问题。参考：[年初至今的项目](http://code.google.com/p/ytd-android/issues/detail?id=2)

# c++ - 返回常量 char 指针会产生错误

> ID：13954905
> 
> 赞同：1
> 
> 时间：2012-12-19T14:50:20.193
> 
> 标签：c++, function, pointers, return, constants

我是 C++ 新手，还没有完全掌握所有概念，所以我很困惑为什么这个函数不起作用。我目前不在家，所以我还不能发布编译器错误，我一回到家就会这样做。

这是功能。

```
const char * ConvertToChar(std::string input1, std::string input2) {
    // Create a string that you want converted
    std::stringstream ss;
    // Streams the two strings together
    ss << input1 << input2;
    // outputs it into a string
    std::string msg = ss.str();
    //Creating the character the string will go in; be sure it is large enough so you don't overflow the array
    cont char * cstr[80];
    //Copies the string into the char array. Thus allowing it to be used elsewhere.
    strcpy(cstr, msg.c_str());

    return * cstr;
} 
```

它将两个字符串连接并转换在一起以返回一个 const char *。那是因为我想使用它的函数需要传递一个 const char 指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T14:51:56.760

该代码返回一个指向本地（堆栈）变量的指针。当调用者获得此指针时，该局部变量不再存在。这通常称为悬空引用。

如果要转换`std::string`为 c 样式的字符串，请使用[`std::string::c_str()`](http://en.cppreference.com/w/cpp/string/basic_string/c_str).

因此，要连接两个字符串并获得一个 c 风格的字符串，请执行以下操作：

```
std::string input1 = ...;
std::string input2 = ...;

// concatenate
std::string s = input1 + input2;

// get a c-style string
char const* cstr = s.c_str(); 
// cstr becomes invalid when s is changed or destroyed 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:04:38.520

在不知道错误是什么的情况下，很难说，但是这一行：

```
const char* cstr[80]; 
```

似乎错了：它创建了一个包含 80 个指针的数组；当它隐式转换为指针时，类型将为`char const**`，当它作为参数传递给 时应该会出错`strcpy`，并且return语句中的取消引用与您编写的相同`cstr[0]`，并返回数组中的第一个指针——由于数组的内容从未被初始化，这是未定义的行为。

在你继续之前，你必须定义函数应该返回什么——不仅是它的类型，还有指向的内存将驻留的位置。对此有三种可能的解决方案：

对缓冲区使用本地静态：

这种解决方案在早期的 C 中经常使用，并且仍然存在于 C 库中的许多函数中。它有两个主要缺陷：1）连续调用会覆盖结果，因此客户端代码必须在再次调用该函数之前制作自己的副本，以及 2）它不是线程安全的。（第二个问题可以通过使用线程本地存储来避免。）在像你这样的情况下，它还存在缓冲区必须足够大以容纳数据的问题，这可能需要动态分配，这增加了复杂性。

返回指向动态分配内存的指针：

这在理论上很有效，但需要客户端代码来释放内存。这必须严格记录，并且极易出错。

要求客户端代码提供缓冲区：

这可能是现代代码中最好的解决方案，但这确实意味着您需要额外的地址参数和缓冲区长度。

除此之外：`std::ostringstream` 如果您所做的只是连接，则无需使用；只需添加两个字符串。无论您使用什么解决方案，都要验证结果是否合适。

# git - Git、Git-Submodule 和 SVN 服务器的故事

> ID：13954907
> 
> 赞同：4
> 
> 时间：2012-12-19T14:50:33.500
> 
> 标签：git, git-svn, git-submodules

首先，我想向您展示我的项目设置，我有两个项目

*   项目 X：使用 git svn clone从**远程 svn 服务器克隆**
*   项目 y：位于**GitHub**

项目 X 引用项目 y 作为 git 子模块：

```
-- Project X
  -- src/
    -- myCode1/
    -- *Project y Submodule*
    -- myCode2/
  -- .git/
  -- ... 
```

现在我想用[git svn dcommit](http://www.kernel.org/pub/software/scm/git/docs/git-svn.html)将本地完成的提交“推送”到远程 svn 服务器。
谁能向我解释该项目结构的正确工作流程？

* * *

如果我想从我运行的 svn 服务器更新我的本地 git repo`git svn rebase`并获得以下信息：

> 错误：以下未跟踪的工作树文件将被结帐覆盖

Git 列出了子模块的所有文件，但我已经在本地仓库中跟踪了子模块。
有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:51:34.973

根据我的经验，git-svn 不适用于 Git 子模块，主要是因为它向 SVN 发送更改的方式：如果你稍微调试一下，你会发现它会将 delta 发送到 SVN（所以像子模块这样的纯 Git 概念未翻译），然后获取刚刚发送的修订版（因此此修订版不包含子模块），并且毕竟用获取的版本替换刚刚发送的提交（因此在最好的情况下，子模块将在此过程中丢失，尽管根据我的经验它只是早些时候失败了）。因此，如果您可以只拥有一个未跟踪的目录“Project y Submodule”并手动管理它，而不是作为子模块。

或者，您可以尝试[将 SubGit](http://subgit.com/eap)作为 git-svn 替代品。自 2.0 EAP 起，它允许为远程 SVN 存储库创建 Git 镜像。

```
$ subgit configure --svn-url http://svnhost/svnpath/projectX projectX.git
$ #adjust projectX.git/subgit/{config,authors.txt,passwd} and, if possible, enable rev-propchange-hook in SVN repository
$ subgit install projectX.git 
```

之后，您可以克隆 projectX.git 并像使用通常的 Git 存储库一样使用它，同步将自动执行。因此，在安装后，您将*Project y Submodule*添加为 projectX.git 的普通 Git 子模块。

```
$ git submodule add git://github.com/.../projectY.git projectY
$ git commit -m "Added projectY as submodule"
$ git push 
```

唯一要做的就是确保SVN中没有具有该名称的文件或目录，否则它将覆盖子模块。

# uiviewcontroller - viewController 在用于 UINavigationController 时从 [tabBarController viewControllers] 数组中移除

> ID：13954909
> 
> 赞同：1
> 
> 时间：2012-12-19T14:50:38.617
> 
> 标签：uiviewcontroller, uinavigationcontroller

我有一个带有 5 个 ViewControllers 的 TabBar。我正在使用该 tabBarController 数组来填充 SideBarMenu，就像在 Facebook 应用程序中一样。

当我使用 viewController 设置为 UINavigationController 的 RootViewController 时，此 viewController 将从数组 [self.tabBarController viewControllers] 中删除。

为什么会发生这种情况，我该如何防止这种情况发生？

```
return [[UINavigationController alloc] initWithRootViewController:
[[self.tabBarController viewControllers] objectAtIndex:0]]; 
```

objectIndex 0 处的 viewController 被删除，并且 [self.tabbarcontroller viewControllers] 仅返回 4 个 viewController。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:57:45.433

UIViewController 只能有一个父级。当您将视图控制器从选项卡栏添加到导航控制器时，导航控制器会将视图控制器与其先前的父级分离并将其附加到自身。有关为什么会发生这种情况的更多信息，请阅读[UIViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)文档的实现容器视图控制器部分。

# python - Python：如何对数组 X 进行排序但将相同的相对排序传递给 Y？

> ID：13954912
> 
> 赞同：3
> 
> 时间：2012-12-19T14:50:52.713
> 
> 标签：python, sorting

例如

```
X=[5,6,2,3,1]
Y=[7,2,3,4,6] 
```

我对 X 进行排序：

```
X=[1,2,3,5,6] 
```

但我希望对 Y 应用相同的相对排序，以便数字保持与以前相同的相对位置：

```
Y=[6,3,4,7,2] 
```

我希望这是有道理的！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T14:52:41.260

通常，您为此做一个`zip`-`sort``unzip`

```
>>> X = [5,6,2,3,1]
>>> Y = [7,2,3,4,6] 
```

现在将它们排序在一起：

```
>>> sorted(zip(X,Y))
[(1, 6), (2, 3), (3, 4), (5, 7), (6, 2)] 
```

`zip(*...)`将其与“解压缩”（ ）配对

```
>>> zip(*sorted(zip(X,Y)))
[(1, 2, 3, 5, 6), (6, 3, 4, 7, 2)] 
```

你可以解包：

```
>>> X,Y = zip(*sorted(zip(X,Y)))
>>> X
(1, 2, 3, 5, 6)
>>> Y
(6, 3, 4, 7, 2) 
```

现在你有`tuple`代替`list`对象，但如果你真的需要，你可以将它转换回来。

* * *

正如评论中所指出的，这确实引入了对排序中第二个列表的非常轻微的依赖：考虑列表：

```
X = [1,1,5,7] #sorted already
Y = [2,1,4,6] #Not already sorted. 
```

使用我上面的“食谱”，在一天结束时，你会得到：

```
X = (1,1,5,7)
Y = (1,2,4,6) 
```

这可能是出乎意料的。要解决此问题，您可以将`key`参数传递给`sorted`：

```
from operator import itemgetter
X,Y = zip(*sorted(zip(X,Y),key=itemgetter(0))) 
```

演示：

```
>>> X
[1, 1, 5, 7]
>>> Y
[2, 1, 4, 6]
>>> XX,YY = zip(*sorted(zip(X,Y)))
>>> XX
(1, 1, 5, 7)
>>> YY
(1, 2, 4, 6)
>>> from operator import itemgetter
>>> XX,YY = zip(*sorted(zip(X,Y),key=itemgetter(0)))
>>> XX
(1, 1, 5, 7)
>>> YY
(2, 1, 4, 6) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T14:57:52.717

另一个想法：

```
>>> d = dict(zip(Y, X))
>>> sorted(Y, key=d.get)
[6, 3, 4, 7, 2] 
```

您只需`X`在排序时使用相应的值作为键`Y`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T15:04:08.143

这是一种即使有重复项目也能保持顺序的方法：

```
def argsort(seq):
    '''
    >>> seq = [1,3,0,4,2]
    >>> index = argsort(seq)
    [2, 0, 4, 1, 3]

    Given seq and the index, you can construct the sorted seq:
    >>> sorted_seq = [seq[x] for x in index]
    >>> assert sorted_seq == sorted(seq)

    Given the sorted seq and the index, you can reconstruct seq:
    >>> assert [sorted_seq[x] for x in argsort(index)] == seq
    '''
    return sorted(range(len(seq)), key=seq.__getitem__)

X = (1,1,5,7)
Y = (1,2,4,6)
index = argsort(X)
print([Y[i] for i in index]) 
```

产量

```
[1, 2, 4, 6] 
```

* * *

关于速度，`using_argsort`似乎比`using_zip`or更快`using_dict`：

```
def using_argsort():
    index = argsort(X)
    return [X[i] for i in index], [Y[i] for i in index]

def using_zip():
    return zip(*sorted(zip(X,Y), key = operator.itemgetter(0)))

def using_dict():
    d = dict(zip(Y,X))
    return sorted(X), sorted(Y, key = d.get)

X = [5,6,2,3,1]*1000
Y = [7,2,3,4,6]*1000

In [18]: %timeit using_argsort()
1000 loops, best of 3: 1.55 ms per loop

In [19]: %timeit using_zip()
1000 loops, best of 3: 1.65 ms per loop

In [21]: %timeit using_dict()
100 loops, best of 3: 2 ms per loop 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:57:32.670

我假设 x 和 y 具有相同数量的元素。对 x 进行排序时，每次交换两个值时，例如 x.swap(i,j)，也会执行 y.swap(i,j)。顺便说一句，我不知道 python 所以这不是 python 语法。

# android - 使用 onListItemClick 启动新活动时如何收集对象信息

> ID：13954913
> 
> 赞同：0
> 
> 时间：2012-12-19T14:50:53.313
> 
> 标签：android, sqlite, android-activity

**我有这个事件处理程序：**

```
@Override
        protected void onListItemClick(ListView l, View v, int position, long id) {
         // TODO Auto-generated method stub
         //super.onListItemClick(l, v, position, id);
         String selection = l.getItemAtPosition(position).toString();

         Intent myIntent = new Intent(MainActivity.this, sondaggioActivity.class);
         MainActivity.this.startActivity(myIntent);
         //Toast.makeText(this, selection, Toast.LENGTH_LONG).show();
        } 
```

点击的项目是listview rappresentation：

```
public class categorie {
      private long id;
      private String nome;
      private long preferita;

      public long getId() {
        return id;
      }

      public void setId(long id) {
        this.id = id;
      }

      public String getNome() {
        return nome;
      }

      public void setNome(String nome) {
        this.nome = nome;
      }

      public long getPreferita() {
        return preferita;
    }

    public void setPreferita(long preferita) {
        this.preferita = preferita;
    }

    // Will be used by the ArrayAdapter in the ListView
      @Override
      public String toString() {
        return nome;
      }
    } 
```

我列出它们：

```
datasource = new pollDataSource(this);
        datasource.open();

        Cursor values = datasource.getAllCategorie();

        String[] categorieColumns =
            {
                MySQLiteHelper.COLUMN_NOME   // Contract class constant containing the word column name

            };

            int[] mWordListItems = { R.id.categoria_label };

        SimpleCursorAdapter adapter = new SimpleCursorAdapter(
                getApplicationContext(),               // The application's Context object
                R.layout.single_list_item,             // A layout in XML for one row in the ListView
                values,                                // The result from the query
                categorieColumns,                      // A string array of column names in the cursor
                mWordListItems,                        // An integer array of view IDs in the row layout
                0);                                    // Flags (usually none are needed)

        setListAdapter(adapter); 
```

在新活动中，我想在数据库中的给定类别（我点击的那个）中收集一些“问题”......我如何将点击的类别传递给新活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:12:27.033

你知道意图吗？您可以将简单的原语、字符串和更多内容放入将启动下一个活动的意图中。它与键值关系（如`HashMap`. 这是一个简单的例子。

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    int selection = position;
    Intent myIntent = new Intent(MainActivity.this, sondaggioActivity.class);
    myIntent.putExtra("SELECTION", selection); // <--- put the value (KEY, VALUE)
    MainActivity.this.startActivity(myIntent);
} 
```

然后在您的新活动中：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    int category = getIntent().getExtras().getInt("SELECTION"); // <-- get the value, with the same  KEY
    switch (category) {
    case 1:
        // do something
        break;
    case 2:
        // do something else
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:16:02.887

你可能想要这个：

```
Cursor data = (Cursor)l.getItemAtPosition(position);
String cat = data.getString(cursor.getIndexColumn(MySQLiteHelper.COLUMN_NOME));
Intent myIntent = new Intent(MainActivity.this, sondaggioActivity.class);
myIntent.putExtra("categorieName", cat);
MainActivity.this.startActivity(myIntent); 
```

然后在`sondaggioActivity`活动中，您可以使用它`getIntent()`来获取`Intent`启动活动并检索类别名称。

# opencv - OpenNI 和 OpenCV

> ID：13954914
> 
> 赞同：2
> 
> 时间：2012-12-19T14:50:55.077
> 
> 标签：opencv, openni, simple-openni

我正在使用 OpenNI 和 OpenCv 2.4 和 Kinect 实现手指检测算法。问题是我不知道如何开始，我找到了一段代码并试图运行它。但问题是 imgproc_c.h 有很多错误，如（未声明的 CvMoments、CvDistanceFunction）和许多其他此类错误。

我检查并确定了头文件，我什至将它与imgproc_c.h的在线代码进行了比较，它完全一样。

我感觉 openCV 2.4 在我的情况下无法正常运行，有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:31:56.670

如果你不知道从哪里开始，我建议你开始阅读 Ballard 和 Brown 的“计算机视觉”，虽然古老但很黄金，它是免费的：http: [//homepages.inf.ed.ac.uk/rbf/BOOKS/BANDB/带b.htm](http://homepages.inf.ed.ac.uk/rbf/BOOKS/BANDB/bandb.htm)

我可以向您保证，有几种方法可以进行手指检测，但从来没有一种非常简单。

# google-drive-api - 文档转换后的回调

> ID：13954915
> 
> 赞同：0
> 
> 时间：2012-12-19T14:51:01.277
> 
> 标签：google-drive-api

通过 SDK 将文档上传到 google drive 时，可以对其进行[转换和 ocr](https://developers.google.com/drive/v2/reference/files/insert)。

两个问题：

*   是否有任何回调让我们知道转换已完成？

*   有没有办法只从转换后的文档中检索文本？

    （我的意思是不下载文档，直接获取文本）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:31:52.100

[您可以使用Groupdocs 转换应用程序](http://groupdocs.com/apps/conversion)轻松转换多种文档格式

我希望它有所帮助。

# php - 循环中的字母顺序

> ID：13954916
> 
> 赞同：1
> 
> 时间：2012-12-19T14:51:02.223
> 
> 标签：php

我有这个代码：

```
<?php
if ($handle = opendir('.')) {
while (false !== ($file = readdir($handle)))
{
    if ($file != "." && $file != ".." && strtolower(substr($file, strrpos($file, '.') + 1)) == 'html')
    {   

        $patterns = array();
        $patterns[0] = '/_/';
        $patterns[1] = '/.html/';
        $patterns[2] = '/index/';
        $replacements = array();
        $replacements[2] = ' ';
        $replacements[1] = '';
        $replacements[0] = 'Strona główna';
        $wynik = preg_replace($patterns, $replacements, $file);

        $newVariable = str_replace("_", " ", $file);  
        $thelist .= '<li><a href="'.$file.'">'.ucfirst($wynik).'</a></li>';
    }
}
closedir($handle);
}
?>
<P>List of files:</p>
<P><?=$thelist?></p> 
```

有没有办法按字母顺序显示文件列表？现在脚本列出了它所在目录中的 html 文件。如何修改我可以手动设置要读取的目录的脚本？

//按字母顺序编码：

```
<?php
if ($handle = opendir('.')) {
$files = glob("*");
foreach ($files as $file)    // replace `while` with `foreach`
{
if ($file != "." && $file != ".." && strtolower(substr($file, strrpos($file, '.') + 1)) == 'html')
    {   

        $patterns = array();
        $patterns[0] = '/_/';
        $patterns[1] = '/.html/';
        $patterns[2] = '/index/';
        $replacements = array();
        $replacements[2] = ' ';
        $replacements[1] = '';
        $replacements[0] = 'Strona główna';
        $wynik = preg_replace($patterns, $replacements, $file);

        $newVariable = str_replace("_", " ", $file);  
        $thelist .= '<li><a href="'.$file.'" target="_blank">'.ucfirst($wynik).'</a></li>';
    }

}

closedir($handle);
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:54:17.907

尝试使用[`sort(...)`](http://php.net/manual/en/function.sort.php)对数组进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:55:34.607

您可以使用[`glob()`](http://php.net/manual/en/function.glob.php)而不是`opendir()`. Glob 将对文件进行排序，除非被告知不要这样做。

```
$files = glob("*");
foreach ($files as $file)    // replace `while` with `foreach`
{
  // the rest of your code

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T14:57:38.770

我会将文件信息添加到数组中，对数组进行排序，然后使用包含格式的循环回显信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T15:05:15.060

您可以使用`SplHeap`

```
foreach(new AlphabeticDir(__DIR__) as $file)
{
    //Play Some Ball
    echo $file->getPathName(),PHP_EOL;
} 
```

班级

```
class AlphabeticDir extends SplHeap
{
    public function __construct($path)
    {
        $files  = new FilesystemIterator($path, FilesystemIterator::SKIP_DOTS);
        foreach ($files as $file) {
            $this->insert($file);
        }
    }
    public function compare($b,$a)
    {
        return strcmp($a->getRealpath(), $b->getRealpath());
    }
} 
```

# android - Android Spinner 尺寸非常大

> ID：13954917
> 
> 赞同：9
> 
> 时间：2012-12-19T14:51:05.710
> 
> 标签：android, size, spinner, android-holo-everywhere

我试图在我的应用程序中获得一个 ICS 微调器，并玩了几个小时，最后我使用 HoloEverywhere 来获得它，它正在工作，但我有一个设计问题，是微调器没有包裹它我在 xml 中设置的内容，默认情况下如下所示：

![在此处输入图像描述](../Images/312f3c07fcd95e4462a54c9143d788ca.png)

真的，我用谷歌搜索了几个小时，我发现的只是如何调整微调器项目而不是视图本身的大小，这意味着我希望将微调器调整为选定的项目大小，如下所示：

[![](../Images/61b10e5079fb08a9f5679c2bfff3721c.png)](https://i.stack.imgur.com/evcyo.png)

这是我的 XML：

```
<RelativeLayout 
android:layout_width="match_parent"
android:layout_height="40dp"
android:orientation="horizontal" >

<org.holoeverywhere.widget.Spinner
    android:id="@+id/spnCities"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"
    android:layout_marginRight="10dp"
    />

<TextView
    android:id="@+id/tvCities"
    android:layout_width="70dp"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_centerVertical="true"
    android:layout_marginLeft="10dp"
    android:text="@string/city"
    android:textAppearance="?android:attr/textAppearanceSmall" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T08:11:52.650

Spinner 的项目具有最大宽度，但最多是父宽度（在 layout_width = wrap_content 上）。您可以在 org.holoeverywhere.widget 包中创建 CustomSpinner 类并覆盖方法 measureContentWidth：

```
@Override
int measureContentWidth(SpinnerAdapter adapter, Drawable background) {
    if (adapter == null) {
        return 0;
    }
    View view = adapter.getView(getSelectedItemPosition(), null, this);
    if (view.getLayoutParams() == null) {
        view.setLayoutParams(new ViewGroup.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,
                ViewGroup.LayoutParams.WRAP_CONTENT));
    }
    view.measure(MeasureSpec.makeMeasureSpec(0,
            MeasureSpec.UNSPECIFIED), MeasureSpec.makeMeasureSpec(0,
            MeasureSpec.UNSPECIFIED));
    int width = view.getMeasuredWidth();
    if (background != null) {
        Rect mTempRect = new Rect();
        background.getPadding(mTempRect);
        width += mTempRect.left + mTempRect.right;
    }
    return width;
} 
```

# java - @NamedQuery 优于 @NamedNativeQuery

> ID：13954924
> 
> 赞同：26
> 
> 时间：2012-12-19T14:51:31.210
> 
> 标签：java, hibernate, annotations, hql

`@NamedQuery`在休眠中使用over有什么好处，`@NamedNativeQuery`反之亦然。我无法发现确切的区别或我们应该在哪种情况下`@NamedQuery`使用`@NamedNativeQuery`

提前致谢。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-19T14:54:21.080

`@NamedNativeQuery`让您编写命名 SQL 查询，同时`@NamedQuery`让您编写命名 HQL 查询（或 JPQL）。

一般来说，您应该更喜欢编写 HQL 查询，因为这样您就可以让 Hibernate 处理将 HQL 转换为各种 SQL 方言的复杂性。当您选择切换 DBMS 提供程序时，这将使您的工作变得更加简单。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-19T14:59:35.773

在考虑性能时，您必须了解引擎盖下发生的事情。

您可能已经使用简单的 JDBC 进行了编程，因此您知道如何将查询传递给驱动程序并发送到数据库。使用 HQL 或 JPA-QL 时，首先必须将查询解析为数据库可以理解的 SQL 语言。在这种情况下，我们有一个额外的解析步骤。请注意，本地 SQL 查询，包括存储过程调用，持久性框架仍然负责将 JDBC 结果集映射到持久性对象的图形。

例如，如果您想包含一个原生 SQL 提示来指示数据库管理系统查询优化器，您需要自己编写 SQL。HQL 和 JPA-QL 没有关键字。

将本机 SQL 放入映射元数据的缺点是失去了数据库可移植性，因为您的映射以及您的应用程序仅适用于特定数据库。但通常这是一个小问题，因为您可能没有创建一个必须在每个数据库上工作的框架。

当您想要落后于查询的性能时，您确实必须查阅数据库并查看执行计划 - DBA 可以准确地告诉您什么是好的，什么可以优化。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-19T14:54:17.450

`@NamedQuery`应使用查询语言（HQL 或持久性查询语言）构建。 `@NamedNativeQuery`应使用本机 SQL 构建。

# android - 在单个进程中使用 AsyncTask（或 Timer），还是在单独的进程中使用 Service 更好？

> ID：13954926
> 
> 赞同：4
> 
> 时间：2012-12-19T14:51:40.910
> 
> 标签：android

我刚刚阅读了[Android Architecture Tutorial: Developing an App with a Background Service (using IPC)](http://mindtherobot.com/blog/37/android-architecture-tutorial-developing-an-app-with-a-background-service-using-ipc/)。基本上是

1.  让服务在单独的进程中运行。
2.  服务中将发生重复的计时器事件。
3.  在计时器事件处理程序中，它将执行网络以检索推文，并通知所有附加到它的侦听器。侦听器通过 IPC 附加到它。

我可以看到这种方法有两个主要特点。

1.  推文检索操作在单独的进程中运行。
2.  它总是运行，即使主要活动已经退出。

但是，如果“**它总是运行**”不是我的要求。当我退出主要活动时，我希望一切都停止。

1.  `AsyncTask`如果我在我的主要活动中使用(Or `Timer`) 来执行推文检索操作会更好吗？一切都将在单个进程中运行。不再使用`Service`.
2.  使用 AsyncTask（或 Timer），似乎更简单。我们不再需要处理 IPC。
3.  或者，使用`Service`方法可能会更好？我是否错过了服务提供的一些好东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T14:58:00.667

使用服务是一种更好的方法，因为它允许您执行独立于应用程序流的轮询。

由于这是一项不需要用户交互的任务，并且必须在后台完成，而不会干扰应用程序的主 UI 以及用户在做什么，因此服务是其实现的理想候选者。

可以将服务与应用程序绑定，这样当主应用程序终止时，它也会关闭服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:02:17.040

首先你必须知道，服务不是线程。如果一个活动绑定了一个Service并作为一个Deamon运行，但是一个异步任务是另一个线程。

**异步任务**是为做一些不应该在 UI 线程上运行的工作而设计的（例如处理一些更大的计算）

**服务**被设计为在后台永久运行。如果您想永久检查新推文，即使您的活动已停止或暂停，您也应该使用服务，它会检查自己的线程以获取新数据。

**TimerTask**是在自己的线程上运行的老式 Java 风格的实现。你可以使用它们来处理一些数据，但是你会在操作 UI 时遇到一些问题。如果您想在propper“AndroidWay”上使用它，请使用处理程序而不是TimerTask。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T15:03:41.690

我认为 a`TimerTask`可以设置为以给定的时间间隔执行和重复，`Timer`s 在单独的线程上运行，因此所有这些工作都将在后台进行，而不会干扰 UI。您可以轻松地在应用程序`TimerTask`完成时触发更新，并在需要时更新 UI。

当您退出应用程序时，这是一个简单的案例，调用`cancel()`您的`Timer`并清除所有任务`purge()`。

很好很容易，而且你不需要实现 IPC，这可能非常繁琐。

**编辑**

使用`AsyncTask`你可以做几乎完全相同的事情，但你必须手动安排下一次运行。我过去使用过这两种解决方案，发现它们的效果同样好，所以这完全取决于您的偏好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T15:21:25.260

首先，我知道您正在学习的教程......我自己在尝试学习 IPC 时遵循了该教程。您需要知道的一件事是，Android 文档明确表示，

> 注意：仅当您允许来自不同应用程序的客户端访问您的 IPC 服务并希望在您的服务中处理多线程时，才需要使用 AIDL。

如果可能的话，您应该只[绑定到服务。](http://developer.android.com/guide/components/bound-services.html#Binder)

此外，您必须考虑，您真的需要服务吗？考虑到 Android Twitter 应用程序甚至不会根据需要为您刷新推文。轮询可能是电池密集型的，因此您必须考虑这是否真的有必要。

另外，你会使用来自多个活动的这些推文吗？如果是这样，最好不要在多个地方复制代码。因此，在这种情况下，您可能确实需要服务。

除此之外，我建议您从简单的开始（带有计时器的异步任务来更新它），如果您认为需要它，请移至服务。

# uri - 发帖时 URI 太长

> ID：13954927
> 
> 赞同：4
> 
> 时间：2012-12-19T14:51:43.967
> 
> 标签：uri, runtime-error, restsharp

在添加我得到的参数后，我正在使用 RestClient 和 RestRequest 发出请求

错误：

```
Invalid URI: The URI string is too long. 
```

我假设这与未正确发布数据有关，这是我的代码：

```
RestClient client = new RestClient();
client.BaseUrl = "URL";
client.Authenticator =
    new HttpBasicAuthenticator("api",
            "KEY");
RestRequest restRequest = new RestRequest(Method.POST);
restRequest.AddParameter("domain",
            "DOMAIN", ParameterType.UrlSegment);
restRequest.Resource = "{domain}/messages";
restRequest.AddParameter("from", (string) sender["alias"] + "<email>");
restRequest.AddParameter("to", (string)recipient["alias"] + "<" + (string)recipient["email"] + ">");
restRequest.AddParameter("subject", subject);
restRequest.AddParameter("html", body);              
var result = client.Execute(restRequest);
if (result.StatusCode != System.Net.HttpStatusCode.OK)
{
     throw new Exception(result.ErrorMessage,new Exception(result.StatusCode + " - " + result.StatusDescription));
} 
```

body 参数可能很长，因为它是 HTML 电子邮件。是什么导致了上述错误？

这是代码使用较短主体发出的请求，以便它确实发送 [http://pastebin.com/HgbBHVpC](http://pastebin.com/HgbBHVpC)

完整的堆栈跟踪，包括尝试发送[http://pastebin.com/dRhXire6的消息](http://pastebin.com/dRhXire6)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:59:11.623

[http://msdn.microsoft.com/en-us/library/z6c2z492.aspx](http://msdn.microsoft.com/en-us/library/z6c2z492.aspx)

查看它说的文档 uriString 的长度超过 65519 个字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T04:09:09.203

看起来像 RestSharp 的一个已知功能：

[https://groups.google.com/forum/?fromgroups#!topic/restsharp/9b5bpK3gt9g](https://groups.google.com/forum/?fromgroups#!topic/restsharp/9b5bpK3gt9g)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:28:23.247

可能是`request.AddParameter(contentTyp, ContentItself, ParameterType.RequestBody);` 或`request.AddBody`。还可以尝试使用 fiddler 之类的东西来检查您发送的实际请求（url\body）。

# ruby-on-rails-3 - 没有找到omniauth 开发者策略的路径

> ID：13954948
> 
> 赞同：3
> 
> 时间：2012-12-19T14:52:39.717
> 
> 标签：ruby-on-rails-3, omniauth

我刚刚更新了 Omniauth`0.2.6`以`1.1.1`使用开发者策略。我已经将我的登录链接指向`/auth/developer`环境是开发环境还是`/auth/facebook`生产环境。

Facebook 的策略仍然有效。使用开发者策略时，链接会转到内置的 Omniauth 登录页面，但在单击登录时返回 404。此模型不使用 Devise。

**路由文件**

```
get "/auth/:provider/callback" => "sessions#create"
.
.
.
get '*a', :to => 'errors#routing' 
```

**Omniauth 初始化程序**

```
Rails.application.config.middleware.use OmniAuth::Builder do
  provider :facebook, [etc.]
  provider :developer if Rails.env.development?
end 
```

**日志**

```
Started GET "/auth/developer" for 127.0.0.1 at 2012-12-19 16:23:04 +0200
Started POST "/auth/developer/callback" for 127.0.0.1 at 2012-12-19 16:23:10 +0200
ActionController::RoutingError (No route matches "/auth/developer/callback") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-12T06:09:33.650

今天在一个新的 rails 4 应用程序中遇到了这个问题，我目前正在使用这条路线作为解决方法：

```
match '/auth/:provider/callback', to: "sessions#create", via: [:get, :post] 
```

# c++ - 如果虚拟表是在编译时创建的，那为什么我们称它为运行时多态呢？

> ID：13954950
> 
> 赞同：8
> 
> 时间：2012-12-19T14:52:45.993
> 
> 标签：c++

由于虚拟表是在编译时创建的，那么为什么我们将其称为 c++ 中的运行时多态性呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T14:53:47.647

因为查找发生在运行时。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-19T15:01:23.930

在典型的实现中，每个类都有一个虚拟表，它在编译时是已知的。

在运行时，类型指针`BaseClass *`可能指向类型为 的对象`BaseClass`，或者指向类型为 的对象的基类子对象`DerivedClass`，其中`BaseClass`是 的基类`DerivedClass`。这同样适用于引用。

在前一种情况下，会在 的 vtable 中查找虚拟调用`BaseClass`。在后一种情况下，虚拟调用会在 的 vtable 中查找`DerivedClass`。由于调用站点不“知道”调用哪个函数，直到调用在运行时实际执行，这称为动态或运行时多态性。

同样在一个典型的实现中，它找出要使用哪个 vtable 的方式是具有一个或多个虚函数的类型的对象包含一个“隐藏的”附加字段，该字段指向其完整类型的 vtable。那是为了简单的继承。多重继承和虚拟继承增加了复杂性，但原理相同，对象提供了指向应使用的任何 vtable 的指针。

将此与非虚拟调用进行比较，其中编译器不需要使用任何 vtable 或知道完整对象的类型。它根据指针或引用的类型选择函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T15:02:16.523

虚拟表无关紧要。C++ 中的运行时多态性意味着：

```
struct B {
    virtual void f() { std::cout << "In B\n"; }
};

struct D1 : B {
    virtual void f() { std::cout << "In D1\n"; }
};

struct D2 : b {
    virtual void f() { std::cout << "In D2\n"; }
};

B *bp = new B;
bp->f();   // calls B::f
B *bp1 = new D1;
bp1->f();  // calls D1::f
B *bp2 = new D2;
bp2->f();  // calls D2::f 
```

即使所有三个指针都有 type `B*`，调用的行为`f()`取决于指针指向的对象的运行时类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T15:14:29.853

正如您所说，每个类的虚函数表（和其他多态信息）是在编译时生成的。

每个对象都包含一个指向其动态类型的正确表的指针。该指针在创建对象时在运行时初始化，并在运行时用于选择要调用的正确虚函数。这就是为什么它被称为运行时多态性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T14:54:31.860

虚拟表在编译期间创建，但在运行时使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-19T15:30:15.927

[虚拟表](http://en.m.wikipedia.org/wiki/Virtual_method_table)是C++ 和其他一些 OO 语言中类类型的*运行时表示*的一个元素。它用于虚拟方法调用的动态调度。换句话说，它是 C++ 动态多态特性的一个*实现细节*。

构建此表的时间与调度方案无关，调度方案定义了多态性是静态的还是动态的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-19T15:01:21.467

为此，您必须简要了解什么是运行时多态性以及它是如何工作的。

如果您有这样的类层次结构：

```
class Animal
{
    ...
    virtual void sayHello() {
        cout << "hello" << endl;
    }
};

class Dog : public Animal
{
    ...
    /*virtual*/ void sayHello() {
        cout << "woof!" << endl;
    }
}; 
```

并调用`Dog`实例上的方法，您希望能够调用 的（虚拟）覆盖方法`Dog`，而不是`Animal`。我想你知道我们为什么要这样做，所以我不想进一步解释。

但是我们怎么能在运行时知道 an`Animal*`实际上是 a`Dog*`呢？问题是，我们不必知道*它*是什么，我们只需要知道要调用*哪些函数*，或者更好地说，要调用哪个函数*指针*。虚函数的所有函数指针都存储在每个类的虚表中。*您可以将其想象为根据实际类*调用哪个代码来调用哪个虚函数的“指南” 。

这个虚拟表是在编译期间创建的（编译器将“指南”写入可执行文件），每个实例都指向一个可用的虚拟表。因此，如果您说它`Dog *dog = new Dog`指向 Dog 的虚拟表。类似的调用编译为对尚未指定的类中`dog->sayHello()`的虚拟函数的虚拟调用...`sayHello`

然后，**在运行时**， like 调用`dog->sayHello()`将首先查找存储在对象中的具体虚拟表（代码不知道它是 Dog，只知道它是 Animal）并找到方法的函数指针`Dog::sayHello()`。

为了回答您的问题，这种机制称为**运行时多态性**，因为我们可以调用*重载 this 指针的*方法（这意味着它们重载了您调用它们的对象的类型），而*决策是在运行时做出的*。您可以调用对应的*编译时多态性*，其中编译器可以知道对象的具体类型，例如在`Dog dog; dog.sayHello()`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-26T15:49:18.137

虽然 v-table 确实是在编译时创建的，但是当编译以下代码时，编译器不知道将调用哪个函数：

```
struct A {
    virtual void f() { cout << "A::f" << endl;}
};
struct B : public A {
    void f() { cout << "B::f" << endl;}
};
int main() {
    A* b = new B();
    b->f(); // prints "B::f", chosen at runtime
} 
```

因此，尽管对象在编译时和运行时之间没有变化，但方法 B::f 仅在运行时被选择，因为编译器不知道对象的动态类型（这决定了调用哪个方法）。

# oracle-apex - 通过 APEX 表单提交将数据从辅助表检索到主表

> ID：13954952
> 
> 赞同：1
> 
> 时间：2012-12-19T14:52:55.067
> 
> 标签：oracle-apex

感谢您提供的任何帮助。

我正在使用**Apex 4.2**，并且在表格 ( ) 上有一个表格，其中`FC_PRIMARY`包含以下列（如下）。当用户为带有 的字段输入数据时`*`，我想从另一个表 ( `FC_JOB`) 返回数据，并在他们点击“插入”按钮后将其填充到主表中。关于如何利用表单项选项或流程来使用 SQL 查询获得此结果的任何想法？

例如，

当用户在字段中输入数据时`JOB__ROLE*`，我想创建一个流程，而不是在提交表单时，根据该字段`APEX`从表中提取数据并匹配表中的该作业角色。被拉过来的值将进入`FC_JOB``JOB__ROLE*``FC_JOB``FC_PRIMARY TABLE>>C3 COLUMN`

```
FC_JOB table

ID  JOB__CODE1  JOB_DESCRIPTION1
1   IT            IT
2   HR             Human Resources

ID
REGION*
COUNTRY_DESCRIPTION*
BUSINESS_LINE*
CUSTOMER_NAME*
JOB__ROLE*
CURRENCY*
EMPLOYEE_STATUS*
COMMENTS*
C1
ENTITY
**C3****
ACCOUNT
JAN*
FEB*
MAR*
APR*
MAY*
JUN*
JUL*
AUG*
SEP*
OCT*
NOV*
DEC* 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T06:48:55.733

一种可能的解决方案：

1.  将 JOB_ROLE 项目类型更改为选择列表。对于值查询列表，您可以使用`select JOB__DESCRIPTION1, JOB__CODE1 from FC_JOB`
2.  如果它不存在，则创建一个名为 C3 的新隐藏项。对于 Source type，选择**database column**，然后输入相关的列名。
3.  提交后创建一个新的 pl/sql 进程。确保它发生在任何自动行处理之前。编写一个简单的语句，从 FC_JOB 中选择相关数据并将其存储在隐藏项 C3 中，使用 where 子句中的项 JOB__ROLE。

# git - 如何使用 git 确定特定分支的点（原点//????）

> ID：13954956
> 
> 赞同：2
> 
> 时间：2012-12-19T14:53:02.383
> 
> 标签：git, git-branch, git-remote

在一些开发分支上我需要使用 origin/master 在其他我需要使用 origin/dev。我想使用一些脚本来进一步自动化我的工作，并且我想知道如何确定要使用的原始字符串，而不必将其作为参数传递或将其设置为环境变量。

使用 'git remote show origin' 给了我一堆输出，其中包含我需要的信息。它说：

为“git pull”配置的本地分支：mybranch 与远程开发合并

有什么方法可以做到这一点，而不必解析“git remote show origin”的所有输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:57:41.453

在下面的示例中，我设置了一个本地分支`develop`，跟踪`develop`远程分支`origin`。

最简单的方法是使用`git config`：

```
$ git config branch.develop.remote
origin 
```

在水下，它在`.git/config`. 例如

```
[branch "develop"]
    remote = origin
    merge = refs/heads/develop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:00:35.320

`git branch -vv`将为您提供本地分支的列表：名称、当前提交 sha，然后在方括号中是他们正在跟踪的远程分支的名称（如果有）。您应该能够轻松地使用它来找出您需要的东西。请注意，活动（当前已签出）分支用前导星号 (*) 突出显示。

您还可以使用`git branch -vv --list <pattern>`where <pattern%gt;来限制列表。将是您要查询的分支名称（例如`git branch -vv --list issue12`，仅获取分支“issue12”的信息）

# c# - 如何使用 c# 将 JQgrid 数据导出到 Excel？

> ID：13954966
> 
> 赞同：5
> 
> 时间：2012-12-19T14:53:17.267
> 
> 标签：c#, asp.net, excel, jqgrid, openxml

我对此进行了一些研究，但大多数解决方案都是针对 MVC 的。我只是使用 Asp.net 3.5 我如何在按钮单击时实现这一点。我是否应该包含任何库或其他任何内容。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:50:08.000

[我在答案](https://stackoverflow.com/a/9349688/315935)中发布的代码实际上可以在用 C# 编写的任何 ASP.NET 代码中进行任何修改而无需任何修改。助手类`DataForExcel`（见文件`DataForExcel.cs`）有构造函数

```
public DataForExcel(string[] headers, List<string[]> data, string sheetName) 
```

或者更“高级”的版本

```
public DataForExcel(string[] headers, DataType[] colunmTypes,
                    List<string[]> data, string sheetName) 
```

允许指定哪些列具有数字数据类型。参数`List<string[]> data`是需要导出到 Excel 中的数据。该参数`string[] headers`指定输出第一行的数据。

该类`DataForExcel`只有一个公共方法

```
public void CreateXlsxAndFillData(Stream stream) 
```

填充`stream`生成的 .XLSX Excel 文件的二进制表示。

要从您的 ASP.NET 方法（例如 ASHX 处理程序）返回二进制数据，您只需执行`ExecuteResult`与我的回答几乎相同的操作：

*   创建内存流`using (var stream = new MemoryStream()) {...}`
*   创建`DataForExcel`导出到 Excel 所需的对象`var dataExcel = new DataForExcel (new []{"Id", "Votes", "Title"}, "Questions.xlsx", "Name or Sheet");`
*   `response.AddHeader ("content-disposition", "attachment; filename=Questions.xlsx");`
*   `response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";`
*   `response.ContentEncoding = Encoding.UTF8;`
*   `stream.WriteTo (response.OutputStream);`
*   `response.Flush();`

就是这样。

**更新**：我修改了之前发布的代码，以非常简单的方式从网格中创建 Excel 文件（.xlsx 格式）。如果您使用[OpenXML SDK 2.0](http://www.microsoft.com/en-us/download/details.aspx?id=5124)，那么您可以使用 .NET 3.5。[OpenXML SDK 2.5](http://www.microsoft.com/en-us/download/details.aspx?id=30425)需要 .NET 4.0 或更高版本。

建议的代码允许将`string[][]`数据转换为二进制 Excel 数据并将结果写入 Stream。您可以`MemoryStream`像我之前描述的那样使用从任何 ASP.NET 应用程序返回 Excel。

建议的代码包含`ExportToExcel`带有一个公共静态方法的静态类`FillSpreadsheetDocument`，可以通过以下方式使用

```
var data = new[] {
    new [] {"Tom",       "30", "x", "",  "1974-06-16"},
    new [] {"Margarita", "34", "x", "x", "1978-10-02"},
    new [] {"Bob",       "7",  "",  "",  "2005-06-26"},
    new [] {"Oleg",      "48", "x", "x", "1964-09-11"},
    new [] {"Frank",     "29", "",  "x", "1983-01-28"}
};
using (var stream = new FileStream("Test.xlsx", FileMode.Create)) {
    ExportToExcel.FillSpreadsheetDocument(stream,
        new[] {
            new ColumnModel { Type = DataType.String, Alignment = HorizontalAlignment.Left, Header = "Name" },
            new ColumnModel { Type = DataType.Integer, Header = "Age" },
            new ColumnModel { Type = DataType.String, Header = "Is Married", Alignment = HorizontalAlignment.Center, IsRotatedHeader = true },
            new ColumnModel { Type = DataType.String, Header = "Has Children", Alignment = HorizontalAlignment.Center, IsRotatedHeader = true },
            new ColumnModel { Type = DataType.Date, Header = "Birthday", Alignment = HorizontalAlignment.Left }
        },
        data,
        "Friends");
} 
```

它产生`"Test.xlsx"`一张看起来像的“朋友”

![在此处输入图像描述](../Images/5bd3fb1bb73f5638584b76d17f489828.png)

不会设置列的宽度，但是通过两次单击（全选并在列之间双击），用户可以将列的宽度设置为最佳宽度，就像上面的构建一样。所有单元格都有格式化数据（没有“通用”格式）。我使用整数、日期和纯字符串。可以轻松创建具有居中对齐或右对齐文本的列。

您可以轻松修改代码，以便使用更多不同的文本格式。这只是一个示例如何生成带有格式化单元格的真实 Excel 文档。

**您可以从[此处](http://www.ok-soft-gmbh.com/jqGrid/ExportToExcel.zip)下载正在运行的 Visual Studio 2008 项目。**您将在下面找到演示的源代码：

```
using System;
using System.Collections.Generic;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;
using System.Text;
using System.IO;
using System.Globalization;

namespace ExportToExcel {
    public enum ExcelCellDataType {
        String,
        Integer,
        Date
    }
    public enum HorizontalAlignment {
        Left,
        Center,
        Right
    }
    public class ColumnModel {
        public ExcelCellDataType Type { set; get; }
        public HorizontalAlignment Alignment { set; get; }
        public string Header { set; get; }
        public bool IsRotatedHeader { set; get; }
    }
    public enum OutputCellFormat: uint {
        Text,
        Integer,
        Date,
        TextHeader,
        TextHeaderRotated,
        TextCenter,
        TextRight
    }

    public static class ExportToExcel {
        private static StringBuilder ConvertIntToColumnHeader (uint iCol) {
            var sb = new StringBuilder();

            while (iCol > 0) {
                if (iCol <= 'Z' - 'A') // iCol=0 -> 'A', 25 -> 'Z'
                    break;
                sb.Append(ConvertIntToColumnHeader(iCol / ('Z' - 'A' + 1) - 1));
                iCol = iCol % ('Z' - 'A' + 1);
            }
            sb.Append((char)('A' + iCol));

            return sb;
        }

        private static string GetCellReference (uint iRow, uint iCol) {
            return ConvertIntToColumnHeader(iCol).Append(iRow).ToString();
        }

        private static Row CreateColumnHeaderRow (uint iRow, IList<ColumnModel> colunmModels) {
            var r = new Row { RowIndex = iRow };

            for (var iCol = 0; iCol < colunmModels.Count; iCol++) {
                var styleIndex = colunmModels[iCol].IsRotatedHeader
                                     ? (UInt32Value)(uint)(OutputCellFormat.TextHeaderRotated + 1)
                                     : (UInt32Value)(uint)(OutputCellFormat.TextHeader + 1);
                r.Append(new OpenXmlElement[] {
                    // create Cell with InlineString as a child, which has Text as a child
                    new Cell(new InlineString(new Text { Text = colunmModels[iCol].Header })) {
                        DataType = CellValues.InlineString,
                        StyleIndex = styleIndex,
                        CellReference = GetCellReference(iRow, (uint)iCol)
                    }
                });
            }

            return r;
        }

        private static UInt32Value GetStyleIndexFromColumnModel (ColumnModel colunmModel) {
            switch (colunmModel.Type) {
                case ExcelCellDataType.Integer:
                    return (uint)(OutputCellFormat.Integer) + 1;
                case ExcelCellDataType.Date:
                    return (uint)(OutputCellFormat.Date) + 1;
            }

            switch (colunmModel.Alignment) {
                case HorizontalAlignment.Center:
                    return (uint)(OutputCellFormat.TextCenter) + 1;
                case HorizontalAlignment.Right:
                    return (uint)(OutputCellFormat.TextRight) + 1;
                default:
                    return (uint)(OutputCellFormat.Text) + 1;
            }
        }

        private static string ConvertDateToString (string date) {
            DateTime dt;
            string text = date; // default results of conversion
            if (DateTime.TryParse(date, out dt))
                text = dt.ToOADate().ToString(CultureInfo.InvariantCulture);
            return text;
        }

        private static Row CreateRow (UInt32 iRow, IList<string> data, IList<ColumnModel> colunmModels, IDictionary<string, int> sharedStrings) {
            var r = new Row { RowIndex = iRow };
            for (var iCol = 0; iCol < data.Count; iCol++) {
                var styleIndex = (uint)(OutputCellFormat.Text) + 1;
                string text = data[iCol] ?? String.Empty;
                if (colunmModels != null && iCol < colunmModels.Count) {
                    styleIndex = GetStyleIndexFromColumnModel(colunmModels[iCol]);
                    switch (colunmModels[iCol].Type) {
                        case ExcelCellDataType.Integer:
                            r.Append(new OpenXmlElement[] {
                                // create Cell with CellValue as a child, which has Text as a child
                                new Cell(new CellValue { Text = text }) {
                                    StyleIndex = styleIndex,
                                    CellReference = GetCellReference(iRow, (uint)iCol)
                                }
                            });
                            continue;
                        case ExcelCellDataType.Date:
                            r.Append(new OpenXmlElement[] {
                                // create Cell with CellValue as a child, which has Text as a child
                                new Cell(new CellValue { Text = ConvertDateToString(text) }) {
                                    StyleIndex = styleIndex,
                                    CellReference = GetCellReference(iRow, (uint)iCol)
                                }
                            });
                            continue;
                    }
                }

                // default format is text
                if (String.IsNullOrEmpty(text) || !sharedStrings.ContainsKey(text)) {
                    // create Cell with InlineString as a child, which has Text as a child
                    r.Append(new OpenXmlElement[] {
                        new Cell(new InlineString(new Text { Text = text })) {
                            DataType = CellValues.InlineString,
                            StyleIndex = styleIndex,
                            CellReference = GetCellReference(iRow, (uint)iCol)
                        }
                    });
                } else {
                    r.Append(new OpenXmlElement[] {
                        // create Cell with CellValue as a child, which has Text as a child
                        new Cell(new CellValue { Text = sharedStrings[text].ToString(CultureInfo.InvariantCulture) }) {
                            DataType = CellValues.SharedString,
                            StyleIndex = styleIndex,
                            CellReference = GetCellReference(iRow, (uint)iCol)
                        }
                    });
                }
            }

            return r;
        }

        private static void FillSpreadsheetDocument (SpreadsheetDocument spreadsheetDocument, IList<ColumnModel> columnModels, IList<string[]> data, string sheetName) {
            if (columnModels == null)
                throw new ArgumentNullException("columnModels");
            if (data == null)
                throw new ArgumentNullException("data");

            // add empty workbook and worksheet to the SpreadsheetDocument
            var workbookPart = spreadsheetDocument.AddWorkbookPart();
            var worksheetPart = workbookPart.AddNewPart<WorksheetPart>();
            var workbookStylesPart = workbookPart.AddNewPart<WorkbookStylesPart>();

            // create styles for the header and columns
            workbookStylesPart.Stylesheet = new Stylesheet(
                new Fonts(
                // Index 0 - The default font.
                    new Font(
                        new FontSize { Val = 11 },
                        new Color { Rgb = new HexBinaryValue { Value = "00000000" } },
                        new FontName { Val = "Calibri" }
                    ),
                // Index 1 - The bold font.
                    new Font(
                        new Bold(),
                        new FontSize { Val = 11 },
                        new Color { Rgb = new HexBinaryValue { Value = "00000000" } },
                        new FontName { Val = "Calibri" }
                    )
                ),
                new Fills(
                // Index 0 - required, reserved by Excel - no pattern
                    new Fill(new PatternFill { PatternType = PatternValues.None }),
                // Index 1 - required, reserved by Excel - fill of gray 125
                    new Fill(new PatternFill { PatternType = PatternValues.Gray125 }),
                // Index 2 - no pattern text on gray background
                    new Fill(new PatternFill {
                        PatternType = PatternValues.Solid,
                        BackgroundColor = new BackgroundColor { Indexed = 64U },
                        ForegroundColor = new ForegroundColor { Rgb = "FFD9D9D9" }
                    })
                ),
                new Borders(
                // Index 0 - The default border.
                    new Border(
                        new LeftBorder(),
                        new RightBorder(),
                        new TopBorder(),
                        new BottomBorder(),
                        new DiagonalBorder()
                    ),
                // Index 1 - Applies a Left, Right, Top, Bottom border to a cell
                    new Border(
                        new LeftBorder(new Color { Auto = true }) { Style = BorderStyleValues.Thin },
                        new RightBorder(new Color { Auto = true }) { Style = BorderStyleValues.Thin },
                        new TopBorder(new Color { Auto = true }) { Style = BorderStyleValues.Thin },
                        new BottomBorder(new Color { Auto = true }) { Style = BorderStyleValues.Thin },
                        new DiagonalBorder()
                    )
                ),
                new CellFormats(
                // Index 0 - The default cell style.  If a cell does not have a style iCol applied it will use this style combination instead
                    new CellFormat {
                        NumberFormatId = (UInt32Value)0U,
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)0U
                    },
                // Index 1 - Alignment Left, Text
                    new CellFormat(new Alignment { Horizontal = HorizontalAlignmentValues.Left }) {
                        NumberFormatId = (UInt32Value)49U, // "@" - text format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true,
                        ApplyAlignment = true
                    },
                // Index 2 - Interger Number
                    new CellFormat {
                        NumberFormatId = (UInt32Value)1U, // "0" - integer format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true
                    },
                // Index 3 - Interger Date
                    new CellFormat {
                        NumberFormatId = (UInt32Value)14U, // "14" - date format mm-dd-yy - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true
                    },
                // Index 4 - Text for headers
                    new CellFormat(new Alignment {
                        Vertical = VerticalAlignmentValues.Center,
                        Horizontal = HorizontalAlignmentValues.Center
                    }) {
                        NumberFormatId = (UInt32Value)49U, // "@" - text format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)1U,
                        FillId = (UInt32Value)2U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true,
                        ApplyAlignment = true
                    },
                // Index 5 - Text for headers rotated
                    new CellFormat(new Alignment {
                        Horizontal = HorizontalAlignmentValues.Center,
                        TextRotation = (UInt32Value)90U
                    }) {
                        NumberFormatId = (UInt32Value)49U, // "@" - text format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)1U,
                        FillId = (UInt32Value)2U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true,
                        ApplyAlignment = true
                    },
                // Index 6 - Alignment Center, Text
                    new CellFormat(new Alignment { Horizontal = HorizontalAlignmentValues.Center }) {
                        NumberFormatId = (UInt32Value)49U, // "@" - text format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true,
                        ApplyAlignment = true
                    },
                // Index 7 - Alignment Right, Text
                    new CellFormat(new Alignment { Horizontal = HorizontalAlignmentValues.Right }) {
                        NumberFormatId = (UInt32Value)49U, // "@" - text format - see http://msdn.microsoft.com/en-us/library/documentformat.openxml.spreadsheet.numberingformat.aspx
                        FontId = (UInt32Value)0U,
                        FillId = (UInt32Value)0U,
                        BorderId = (UInt32Value)1U,
                        ApplyNumberFormat = true,
                        ApplyAlignment = true
                    }
                )
            );
            workbookStylesPart.Stylesheet.Save();

            // create and fill SheetData
            var sheetData = new SheetData();

            // first row is the header
            uint iRow = 1;
            sheetData.AppendChild(CreateColumnHeaderRow(iRow++, columnModels));

            //iRow++; // skip one row for the filter
            // first of all collect all different strings
            var sst = new SharedStringTable();
            var sharedStrings = new SortedDictionary<string, int>();
            foreach (var dataRow in data)
                for (var iCol = 0; iCol < dataRow.Length; iCol++)
                    if (iCol >= columnModels.Count || columnModels[iCol].Type != ExcelCellDataType.Integer) {
                        string text = (columnModels[iCol].Type == ExcelCellDataType.Date
                                          ? dataRow[iCol]
                                          : ConvertDateToString(dataRow[iCol])) ?? String.Empty;
                        if (!String.IsNullOrEmpty(text) && !sharedStrings.ContainsKey(text)) {
                            sst.AppendChild(new SharedStringItem(new Text(text)));
                            sharedStrings.Add(text, sharedStrings.Count);
                        }
                    }

            var shareStringPart = workbookPart.AddNewPart<SharedStringTablePart>();
            shareStringPart.SharedStringTable = sst;

            shareStringPart.SharedStringTable.Save();

            foreach (var dataRow in data)
                sheetData.AppendChild(CreateRow(iRow++, dataRow, columnModels, sharedStrings));

            // add sheet data to Worksheet
            worksheetPart.Worksheet = new Worksheet(sheetData);
            worksheetPart.Worksheet.Save();

            // fill workbook with the Worksheet
            spreadsheetDocument.WorkbookPart.Workbook = new Workbook(
                    new FileVersion { ApplicationName = "Microsoft Office Excel" },
                    new Sheets(new Sheet {
                        Name = sheetName,
                        SheetId = (UInt32Value)1U,
                        Id = workbookPart.GetIdOfPart(worksheetPart) // generate the id for sheet
                    })
                );
            spreadsheetDocument.WorkbookPart.Workbook.Save();
            spreadsheetDocument.Close();
        }

        public static void FillSpreadsheetDocument (Stream stream, IList<ColumnModel> columnModels, IList<string[]> data, string sheetName) {
            using (var spreadsheetDocument = SpreadsheetDocument.Create(stream, SpreadsheetDocumentType.Workbook)) {
                FillSpreadsheetDocument(spreadsheetDocument, columnModels, data, sheetName);
            }
        }
    }

    class Program {
        static void Main () {
            var data = new[] {
                new [] {"Tom",       "30", "x", null,  "1974-06-16"},
                new [] {"Margarita", "34", "x",  "x",          null},
                new [] {"Bob",       "7",  "",    "",  "2005-06-26"},
                new [] {"Oleg",      null, "x",   "x", "1964-09-11"},
                new [] {"Frank",     "29", "",    "x", "1983-01-28"}
            };
            using (var stream = new FileStream("Test.xlsx", FileMode.Create)) {
                ExportToExcel.FillSpreadsheetDocument(stream,
                    new[] {
                        new ColumnModel { Type = ExcelCellDataType.String, Alignment = HorizontalAlignment.Left, Header = "Name" },
                        new ColumnModel { Type = ExcelCellDataType.Integer, Header = "Age" },
                        new ColumnModel { Type = ExcelCellDataType.String, Header = "Is Married", Alignment = HorizontalAlignment.Center, IsRotatedHeader = true },
                        new ColumnModel { Type = ExcelCellDataType.String, Header = "Has Children", Alignment = HorizontalAlignment.Center, IsRotatedHeader = true },
                        new ColumnModel { Type = ExcelCellDataType.Date, Header = "Birthday", Alignment = HorizontalAlignment.Left }
                    },
                    data,
                    "Friends");
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:20:57.910

[php + jqgrid + 导出到excel](https://stackoverflow.com/questions/2188762/php-jqgrid-export-to-excel)

虽然这是一个 PHP 解决方案，但如果有帮助的话，它的核心似乎在 Javascript 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T22:51:33.640

您可以使用 Office XML 格式 (http://en.wikipedia.org/wiki/Microsoft_Office_XML_formats)。唯一的缺点是输出将是 XML 文件而不是二进制文件。但是，它的打开方式和行为方式与常规 .xls 文件完全相同。

我之前的做法是对Excel进行逆向工程，以我需要的格式，然后将其保存为.xml格式，在Notepad++中打开，找出页眉、表格（从网格转换而来），最后是页脚

例子：

标头（可以硬编码）

```
<?xml version="1.0"?>
            <?mso-application progid="Excel.Sheet"?>
            <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
             xmlns:o="urn:schemas-microsoft-com:office:office"
             xmlns:x="urn:schemas-microsoft-com:office:excel"
             xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
             xmlns:html="http://www.w3.org/TR/REC-html40">
             <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
              <Author>phpGrid.com</Author>
              <Created></Created>
              <LastSaved></LastSaved>
              <Version></Version>
             </DocumentProperties>
             <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
                <WindowHeight>768</WindowHeight>
                <WindowWidth>1024</WindowWidth>
                <WindowTopX>0</WindowTopX>
                <WindowTopY>0</WindowTopY>
                <ProtectStructure>False</ProtectStructure>
                <ProtectWindows>False</ProtectWindows>
            </ExcelWorkbook>
            <Styles>
                <Style ss:ID="Default" ss:Name="Normal">
                    <Alignment ss:Vertical="Bottom" />
                    <Borders/>
                    <Font ss:FontName="Arial" ss:Size="8" />
                    <Interior/>
                    <NumberFormat />
                    <Protection />
                </Style>
                <Style ss:ID="sHyperlink" ss:Name="Hyperlink">
                    <Font ss:Color="#0000FF" ss:Underline="Single" />
                </Style>
                <Style ss:ID="sDate">
                    <NumberFormat ss:Format="Short Date"/>
                </Style>
                <Style ss:ID="sNumber">
                    <NumberFormat/>
                </Style>                
                <Style ss:ID="sHeader">
                    <Font ss:Family="Arial" ss:Bold="1" />
                </Style>
                <Style ss:ID="sDecimal">
                    <NumberFormat ss:Format="Fixed"/>
                </Style>
            </Styles><Worksheet ss:Name="Sheet1"> 
```

body（这个是datagrid转换出来的表格，需要动态生成）

```
<Table ss:ExpandedColumnCount="7" 
              ss:ExpandedRowCount="328" x:FullColumns="1"
              x:FullRows="1"><Row><Cell ss:StyleID="sHeader"><Data ss:Type="String">Order No.</Data></Cell><Cell ss:StyleID="sHeader"><Data ss:Type="String">Order Date</Data></Cell><Cell ss:StyleID="sHeader"><Data ss:Type="String">Shipped Date</Data></Cell><Cell ss:StyleID="sHeader"><Data ss:Type="String">status</Data></Cell><Cell ss:StyleID="sHeader"><Data ss:Type="String">comments</Data></Cell><Cell ss:StyleID="sHeader"><Data ss:Type="String">Customer No.</Data></Cell></Row>
<Row><Cell ss:StyleID="sNumber"><Data ss:Type="Number">0</Data></Cell><Cell><Data ss:Type="String">2010-08-20 00:00:00</Data></Cell><Cell><Data ss:Type="String"></Data></Cell><Cell><Data ss:Type="String">Open</Data></Cell><Cell><Data ss:Type="String">foo</Data></Cell><Cell ss:StyleID="sNumber"><Data ss:Type="Number">123456</Data></Cell></Row>
<Row><Cell ss:StyleID="sNumber"><Data ss:Type="Number">10100</Data></Cell><Cell><Data ss:Type="String">2003-01-06 00:00:00</Data></Cell><Cell><Data ss:Type="String">2003-01-10 00:00:00</Data></Cell><Cell><Data ss:Type="String">Shipped</Data></Cell><Cell><Data ss:Type="String">foo</Data></Cell><Cell ss:StyleID="sNumber"><Data ss:Type="Number">363</Data></Cell></Row>
<Row><Cell ss:StyleID="sNumber"><Data ss:Type="Number">10101</Data></Cell><Cell><Data ss:Type="String">2003-01-18 00:00:00</Data></Cell><Cell><Data ss:Type="String">2003-01-22 00:00:00</Data></Cell><Cell><Data ss:Type="String">Shipped</Data></Cell><Cell><Data ss:Type="String">Check on availability.</Data></Cell><Cell ss:StyleID="sNumber"><Data ss:Type="Number">128</Data></Cell></Row></Table> 
```

页脚（可以硬编码）

```
<WorksheetOptions 
              xmlns="urn:schemas-microsoft-com:office:excel">
                <Print>
                    <ValidPrinterInfo />
                    <HorizontalResolution>800</HorizontalResolution>
                    <VerticalResolution>0</VerticalResolution>
                </Print>
                <Selected />
                <Panes>
                    <Pane>
                        <Number>3</Number>
                        <ActiveRow>1</ActiveRow>
                    </Pane>
                </Panes>
                <ProtectObjects>False</ProtectObjects>
                <ProtectScenarios>False</ProtectScenarios>
            </WorksheetOptions>
        </Worksheet>
        </Workbook> 
```

您可以简单地对页眉和页脚 XML 进行硬编码，只会动态生成正文。如果您需要对齐和其他所需的样式。再次尝试相同的“逆向”工程方法并找出需要添加到 XML 中的内容。

我发现这种方式的一个优点是您不需要依赖 API，因为实际上所有内容都可以混合成一个字符串。它也适用于不同的编程语言。可能不如 API 灵活或强大，但对于 datagrid，只有表、行和列就足够了。至少对我来说。

# javascript - jQuery追加onclick函数

> ID：13954971
> 
> 赞同：10
> 
> 时间：2012-12-19T14:53:41.617
> 
> 标签：javascript, jquery

我整天都被这个问题困住了！基本上，我有这个数组：

```
var category = {
    id_1:[
          {id:"1_1", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"8,50", link:""},
          {id:"1_2", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"7,00", link:""},
          {id:"1_3", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"7,00", link:""},
          {id:"1_4", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"19,00", link:""},
          {id:"1_5", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"10,00", link:""},
          {id:"1_6", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"8,50", link:""},
          {id:"1_7", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"12,00", link:""},
          {id:"1_8", img:"img/prodotti-categorie/test.jpeg", titolo:"Name", prezzo:"7.50", link:""}],
    id_2:[... 
```

然后我得到这样的值：

```
for(var i=0, l=Object.keys(category["id_"+(cat_id)]).length; i<l; i++) {
        var img = category["id_"+(cat_id)][i]["img"];
        var title = category["id_"+(cat_id)][i]["titolo"];
        var price = category["id_"+(cat_id)][i]["prezzo"];

        $('#content').append('<div class="category-list item-'+ cat_id + '_' + i +'"><img src="' + img + '"><p>' + title +'</p><p>€' + price + '</p></div>');

       //From here begins my problem:
       //When i search fot the class added before and try to append or do anything else, variable i is always 8!
        $('.item-' + cat_id + '_' + i).click(function(){
             app.renderPageProductView(cat_id, i);
        });
    }; 
```

我需要在每个`<div>`元素上附加一个类，例如`class="item-1_1"`点击函数`app.renderPageProductView(1,1);`

有人有解决方案吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T14:58:33.203

让我们让您更轻松。

它们**都**使用相同的类：`.category-list`，因此将类别添加为数据元素（`data-cat='foo'`和`data-id='bar'`）

然后你可以这样做：

```
$(document).on('click','.category-list', function(){
     var data = $(this).data();

     app.renderPageProductView(data.cat, data.id);
}); 
```

你可以做这样的事情来设置它：

```
for(id in category){
   for(var i = 0; i < category[id].length; ++i){
        var img = category[id][i]["img"];
        var title = category[id][i]["titolo"];
        var price = category[id][i]["prezzo"];

        $('#content').append('<div class="category-list" data-id="'+ i +'" data-cat="'+ id +'"><img src="' + img + '"><p>' + title +'</p><p>€' + price + '</p></div>');
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:02:49.657

尝试将索引存储到数据属性中。在您的循环完成后执行点击，所以我将是最大值。

试试这个代码：

```
 $('#content').append('<div data-index="' + i + '" class="category-list item-'+ cat_id + '_' + i +'"><img src="' + img + '"><p>' + title +'</p><p>€' + price + '</p></div>');

   //From here begins my problem:
   //When i search fot the class added before and try to append or do anything else, variable i is always 8!
    $('.category-list').click(function(){
         app.renderPageProductView(cat_id, parseInt($(this).attr('data-index'), 10));
    }); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T14:57:19.397

毕竟，你不能这样做：

```
$(".item-1_1").off('click').on('click', function () {
   app.renderPageProductView(1,1);
}); 
```

# solr - 解决波动问题

> ID：13954976
> 
> 赞同：2
> 
> 时间：2012-12-19T14:54:04.007
> 
> 标签：solr, schema, case, wildcard, punctuation

我有一个包含

```
... ung eignen sich auch Computer-Rechtschreibprogramme.   Deutsch Erweiterte ... 
```

我已经这样配置了

```
 <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
        <analyzer>
            <tokenizer class="solr.WhitespaceTokenizerFactory" />
            <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" />
            <filter class="solr.WordDelimiterFilterFactory" 
                    generateWordParts="1" generateNumberParts="0" catenateWords="1"
                    catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"
                    splitOnNumerics="0" stemEnglishPossessive="0"/>
            <filter class="solr.LowerCaseFilterFactory" />
            <filter class="solr.TrimFilterFactory" />   
            <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
            <filter class="solr.ReversedWildcardFilterFactory" />
            <filter class="solr.LengthFilterFactory" min="1" max="100" />
            <filter class="solr.PatternReplaceFilterFactory" pattern="[\p{Punct}]" replacement="" replace="all"/>
        </analyzer>
    </fieldType> 
```

但

```
q=volltext:Rechtschreibprogramm*
q=volltext:*Rechtschreibprogramm* 
```

没有结果，为什么？

```
q=volltext:*echtschreibprogramm* 
```

找到文档

我正在使用 solr 1.4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:18:21.600

我已经安装了 Solr 1.4 并索引了您询问的数据。问题在[此处](https://issues.apache.org/jira/browse/SOLR-2438)描述。通配符查询是区分大小写的，不会被分析。这就是为什么当你用大写的“R”搜索时没有找到任何结果的原因。它在 Solr 3.6 上得到解决。您可以使用小写字母发送通配符查询，它将返回您预期的结果。

# c# - 为什么 ObjectDataSource 没有发送正确的参数值？

> ID：13954977
> 
> 赞同：5
> 
> 时间：2012-12-19T14:54:08.703
> 
> 标签：c#, asp.net

我有一个 ObjectDataSource，我试图在其中传递一些参数。

```
GridDataSource.SelectMethod = "GetAllCountries";
GridDataSource.SelectParameters.Add("PageSize", pageSize.ToString());
GridDataSource.SelectParameters.Add("OrderBy", orderBy);
GridDataSource.SelectParameters.Add("StartIndex", startIndex.ToString()); 
```

我的方法在 App_Code/DAL/CountriesDB.CS

```
public  List<Countries> GetAllCountries(int PageSize,string OrderBy,int StartIndex)
{
..........
} 
```

当我调试它时，在 GetAllCountries 方法 PageSize=-1;OrderBy="",StartIndex=0 被传递...这是怎么回事？

thnx提前...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T15:02:54.840

处理`Selecting`事件`GridDataSource`并在那里输入您的参数。

```
protected void GridDataSource_Selecting(object sender, ObjectDataSourceSelectingEventArgs e)
{    
    GridDataSource.SelectMethod = "GetAllCountries";            
    e.InputParameters.Clear();
    e.InputParameters.Add("PageSize", pageSize.ToString());
    e.InputParameters.Add("OrderBy", orderBy);
    e.InputParameters.Add("StartIndex", startIndex.ToString());         
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:58:01.440

你可以试试这样：

```
GridDataSource.SelectMethod = "GetAllCountries";
 Parameter p1 = new Parameter("PageSize",TypeCode.Int32);
 Parameter p2 = new Parameter("OrderBy",TypeCode.String);
 Parameter p3 = new Parameter("StartIndex",TypeCode.Int32);
 GridDataSource.SelectParameters.Add(p1);
 GridDataSource.SelectParameters.Add(p2);
 GridDataSource.SelectParameters.Add(p3); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:00:30.420

我通常订阅[`ObjectDataSource`'s`Selecting`事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)，我可以在其中修改[ObjectDataSourceMethodEventArgs](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.aspx)`InputParmeters`中的集合：[`e`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.aspx)

```
e.InputParameters["PageSize"] = pageSize; // pageSize is an int in your select method
e.InputParameters["OrderBy"] = orderBy;
e.InputParameters["StartIndex"] = startIndex; // startindex is an int too 
```

此外，参数值不必是字符串。它们应该匹配 select 方法的参数类型。

select 方法必须在代码中指定（就像您在问题中所做的那样）：

```
GridDataSource.SelectMethod = "GetAllCountries"; // code 
```

...或在标记中：

```
<asp:ObjectDataSource ... SelectMethod="GetAllCountries" /> // markup 
```

# jquery - 根据点击位置重新定位 div

> ID：13954984
> 
> 赞同：8
> 
> 时间：2012-12-19T14:54:22.277
> 
> 标签：jquery, html

我有一个页面，其中包含多个相同的隐藏表单，每个表单都包含在一个单独的隐藏 DIV 中，如下所示：

HTML：

```
<div class="product-intro-text">Some text....
    <div class="rfq-button"><a class="advantage-button" id="Adapters" href="#">Request a Quote</a></div>
    <div class="inline-rfq">
            <form class="contact" name="contact" action="#" method="post">...</form>
    </div>
</div>
<div class="h-sep"></div>
<div class="product-intro-text">Some text....
    <div class="rfq-button"><a class="advantage-button" id="Auger&nbsp;Equipment" href="#">Request a Quote</a></div>
    <div class="inline-rfq">
            <form class="contact" name="contact" action="#" method="post">...</form>
    </div>
</div> 
```

我如何重新定位 .inline-RFQ DIV 以显示在单击的相应 .rfq 按钮下方，而不是拥有所有这些相同的隐藏 DIV？这是针对移动网站的，因此解决方案必须适合移动设备。

我已经在整个页面的其余部分使用 JS/JQuery，这里是显示隐藏 DIV 的 JS：

```
 jQuery(document).ready(function($){
/* toggle form */
$(".rfq-button").on("click", function(){
    $(this).next().slideToggle();
    $(".inline-rfq").next().toggleClass("display");
});
}); 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:07:34.537

这是一个小提琴： http: [//jsfiddle.net/psyon001/ejdgX/](http://jsfiddle.net/psyon001/ejdgX/) 您可能想要添加的一件事是在新部分下显示时重置表单状态。

```
jQuery(document).ready(function($) { /* toggle form */
    $(".rfq-button").on("click", function() {
        var $thisParent = $(this).closest('.product-intro-text'),
            $form = $(".inline-rfq");
        if ($thisParent.find('.inline-rfq').length) {
            $form.slideToggle();
        } else {
            $form.slideUp(function() {
                $form.appendTo($thisParent).slideDown();
            });
        }
    });
});​ 
```

# c++ - Xcode/Clang 幻数？

> ID：13954987
> 
> 赞同：2
> 
> 时间：2012-12-19T14:54:37.627
> 
> 标签：c++, xcode, macos, clang, magic-numbers

我正在使用带有 Clang 作为编译器的 Xcode，当在地址为`0xCDCDCDCD`. 我还看到一些变量设置为`0xABABABAB`左右。我环顾四周，注意到这些值在 Visual Studio 中用作幻数，以帮助了解问题所在。但是我找不到 Xcode 使用的幻数列表（或 Clang，不确定它是来自编译器还是 IDE 的机制）。有谁知道我在哪里可以找到一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:08:22.223

我不知道任何全面的列表，这似乎是您正在搜索的内容，但`0xCDCDCDCD`通常在您使用 Debug 构建分配内存块时由 C 运行时使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:50:19.797

我不知道任何这样的列表，除了[维基百科的“魔法调试值”列表](http://en.wikipedia.org/wiki/Magic_number_%28programming%29#Magic_debug_values)，它列出了调试中使用的各种幻数。

* * *

正如 Mike 上面所说，很有可能在调试版本中将指针初始化为无效的内存地址，以便更容易捕获潜在的与指针相关的错误。

这是一个编译器或运行时功能，但它们被初始化的确切值并不重要，因为该功能可以使指针调试更简单。这`EXC_BAD_ADDRESS`只是尝试对未分配的内存执行操作的结果，实际上是预期的行为。

这些数字在 Visual Studio 中被用作幻数可能正是因为它们可用于在运行已编译的程序时定位未初始化的指针。

# .net - 程序可以通过设置和重置背景色属性来泄漏内存吗？

> ID：13954988
> 
> 赞同：2
> 
> 时间：2012-12-19T14:54:41.620
> 
> 标签：.net, memory-leaks, serial-port, label, delphi-prism

由于我在我的 winform 上找不到任何控件可用作我的串行通信发送和接收的 LED 指示灯，因此我从标签创建了我自己的用户定义指示灯。它基本上设置和重置标签的颜色，从黑色到石灰用于接收，从黑色到红色用于重复传输。它的类如下。但是，我的 .NET 程序似乎运行了几个小时并完全崩溃。当我查看崩溃错误的详细信息时，Windows 将其报告为**clr20r3 error**。当我在 fedora linux 下编写和开发程序时，我遇到了类似的问题。我在表单上的串行通信指示器不知何故导致内存泄漏并使程序崩溃，当它被删除时，它工作得完美无缺。

那么，你会在几秒钟内重复设置和重置标签的背景色而导致内存泄漏吗？

```
namespace SerialLED;

interface

uses
  System.Collections.Generic,
  System.Windows.Forms,
  System.Drawing.*,
  System.Text;

type

  TheLED = public class(Label)
  private
  protected
  public
    constructor;
  end;

  TSerialIndicator = public class
  private
    method TxTimerEvent(Sender:System.Object; e:System.EventArgs);
    method RxTimerEvent(Sender:System.Object; e:System.EventArgs);
  public
    Txlight:TheLED;
    Rxlight:TheLED;
    TxTimer:System.Timers.Timer;
    RxTimer:System.Timers.Timer;
    constructor(mform:Form);
    method Transmit;
    method Receive;
  end;

implementation

method TSerialIndicator.Transmit;
begin
  TxLight.BackColor := Color.Red;
  if TxTimer.Enabled = false then
     TxTimer.Enabled:=true;
end;

method TSerialIndicator.Receive;
begin
  RxLight.BackColor := Color.Lime;

  if RxTimer.Enabled=false then
    RxTimer.Enabled:=true;
end;

method TSerialIndicator.RxTimerEvent(Sender:System.Object; e:System.EventArgs);
begin
    RxLight.BackColor := Color.Black;
    RxTimer.Enabled:=false;
end;

method TSerialIndicator.TxTimerEvent(Sender:System.Object; e:System.EventArgs);
begin
    TxLight.BackColor := Color.Black;
    TxTimer.Enabled:=false;
end;

constructor TSerialIndicator(mform:Form);
begin
    RxLight := new TheLED;
    TxLight := new TheLED;

    TxLight.AutoSize := false;
    RxLight.AutoSize := false;

    TxLight.BorderStyle := BorderStyle.Fixed3D;
    RxLight.BorderStyle := BorderStyle.Fixed3D;

    TxLight.Location := new point(52,163);
    RxLight.Location := new point(82,163);

    TxLight.Width := 20;
    TxLight.Height := 20;
    RxLight.Width :=20;
    RxLight.Height := 20;

    mform.Controls.Add(RxLight);
    mform.Controls.Add(TxLight);

    RxTimer := new System.Timers.Timer;
    TxTimer := new System.Timers.Timer;
    RxTimer.Interval:=50;
    TxTimer.Interval:=50;
    RxTimer.Enabled:=false;
    TxTimer.Enabled:=false;
    RxTimer.Elapsed += new System.Timers.ElapsedEventHandler(@RxTimerEvent);
    TxTimer.Elapsed += new System.Timers.ElapsedEventHandler(@TxTimerEvent);

    RxLight.BackColor := Color.Black;
    TxLight.BackColor := Color.Black;
end;

constructor TheLED;
begin
  self.DoubleBuffered:=true;
end; 
```

这是它在winform上的样子： ![在此处输入图像描述](../Images/056921a512489159508a905d40974ea5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T14:06:50.623

由于没有人愿意回答并且我已经解决了我的问题，所以我将自己回答这个问题。

是的，这可能会导致我所经历的内存泄漏，这取决于您如何为控件设置背景色。如果您的控件没有放在 winform 上，那么在短时间内设置和重置背景色可能会导致内存泄漏，正如 Hans Passant 所说。所以，我听从了他的建议。

基本上我把我的控制权放在winform上，从我的线程中，我设置和重置背景色。到目前为止，它已经奏效了。在过去的 5 天里，我一直在不间断地运行我的程序，它没有崩溃或失去控制。

# jquery - jQuery 可折叠面板

> ID：13954991
> 
> 赞同：-1
> 
> 时间：2012-12-19T14:54:59.277
> 
> 标签：jquery, asp.net

ASP.Net，2.0 VS2005，.Net 2.0 jQuery 1.8.3，jQuery UI 1.9.2

我的表单上有两个面板（稍后会出现更多），可以根据用户的要求打开或关闭。

我正在使用 jQuery '.slideToggle' 方法。

这是我的标记

```
<div class="trigger0">Collapsible Header 1 - Click to toggle</div>
            <div class="panel0">
                content 1
            </div>
           <div class="trigger1">Collapsible Header 2 - Click to toggle</div>
            <div class="panel1">
                content 2
            </div> 
```

以下工作正常

```
$(document).ready(function() {
        $(".trigger0").click(function(){
            $(".panel0").slideToggle("medium");
        });
        $(".trigger1").click(function() {
            $('.panel1').slideToggle("medium");
        });
    }); 
```

但这不是

```
$(document).ready(function() {
        for (var vReportSectionCount = 0; vReportSectionCount < 2; vReportSectionCount++)
        {
            $(".trigger" + vReportSectionCount).click(function(){
                $(".panel" + vReportSectionCount).slideToggle("medium");
            });
        }
    }); 
```

由于我还不知道最终会存在多少个面板，所以我不想为每个面板写一个新行。有人可以向我解释原因并提出更好的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T15:09:13.547

这可能是你正在寻找的东西吗？这使您可以将类命名为类而不是 ID

HTML

```
<div class="trigger">Collapsible Header 1 - Click to toggle</div>
<div class="panel">
    content 1
</div>

<div class="trigger">Collapsible Header 2 - Click to toggle</div>
<div class="panel">
    content 2
</div> 
```

Javascript

```
$(document).ready(function() {
    $(".trigger").click(function(){
        $(this).next(".panel").slideToggle("medium");
    });
}); 
```

你可以在这里看到一个演示：http: [//jsfiddle.net/LkTf8/1/](http://jsfiddle.net/LkTf8/1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T15:09:44.473

尝试[jQuery UI Tabs](http://jqueryui.com/tabs/)和[jQuery UI Accordion](http://jqueryui.com/accordion/)不要做已经做过的工作人员 :)

# ios - iOS OpenGL ES 屏幕旋转，而后台应用程序栏可见

> ID：13954994
> 
> 赞同：7
> 
> 时间：2012-12-19T14:55:11.610
> 
> 标签：ios, ipad, glkit, screen-rotation

我的应用程序用于`GLKit`渲染 3D 场景`OpenGL ES`。

一切正常，除了一件事。当我在 iPad 中启动我的应用程序并显示背景应用程序栏（单击两次“主页”按钮）然后更改设备的方向时，场景更新错误（最后渲染的图像被简单地拉伸以填充新矩形）。

我找到了原因。当后台应用程序栏出现时，`GLKViewController's` `paused`设置为`YES`自动（应用程序委托接收`-applicationWillResignActive:`）并且在此栏关闭之前不会进行渲染。

我在 Apple 指南（[iOS 的 OpenGL ES 编程指南/实现多任务感知 OpenGL ES 应用程序](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/ImplementingaMultitasking-awareOpenGLESApplication/ImplementingaMultitasking-awareOpenGLESApplication.html)）中发现，在收到`-applicationWillResignActive:`应用程序后应该停止 GL 渲染或将被终止。所以看起来一切都很好，除了旋转后渲染不好:)

我检查了一些 OpenGL 游戏。当此栏显示时，它们也变得“暂停”，但以某种方式正确更新了设备旋转时暂停的场景。他们如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T10:39:56.743

tl; dr：可能您只需将`GLKView`'s设置`contentMode`为`UIViewContentModeRedraw`

首先，我认为您的应用程序实际上并没有进入后台，我认为它只是变得不活动。`applicationWillResignActive`和`applicationDidEnterBackground`委托方法的区别。假设应用程序仅处于非活动状态，请使用以下内容，以防它实际上被置于后台，请参见下文。

苹果文档说您应该在`applicationWillResignActive`被调用时“降低 OpenGL ES 帧速率”，而不是不允许 OpenGL ES 调用，这仅在应用程序进入后台后发生。

这意味着`GLKit`'s `GLKView`/`GLKViewController`在这方面可能有点过分热心。要修复它，您需要确保：

1.  的`GLKView`设置`contentMode`为`UIViewContentModeRedraw`
2.  即使应用程序处于非活动状态但框架已更改， ' 方法也会绘制框架，但在`GLKView`应用`drawRect`程序**处于后台时不****绘制**框架（即使用 OpenGL ES 调用）。

 **但是，我的假设是，`drawRect`当应用程序在后台时，甚至不会调用该方法，因此您可能不必担心`glkView:drawInRect`委托方法中的 OpenGL ES 调用。但是，在您的情况下未调用此函数的原因是视图不会失效。未失效的原因有两个：

1.  周期性地使视图无效的主框架循环`GLKViewController`被`paused`属性暂停。
2.  这`GLKView` `contentMode`可能是默认的“UIViewContetModeScaleToFill”

由于该`GLKView` `drawRect`方法可能甚至没有查看`paused`属性，因此仅更改`contentMode`可能就足够了。

* * *

如果应用程序确实进入后台，我会提出以下解决方案。由于在后台运行时不允许使用 OpenGL ES 调用，因此解决方案非常简单：

在进入后台之前，做所有你需要做的 OpenGL ES 调用来支持你想要的东西。

也就是说，`applicationWillResignActive`执行以下操作：

1.  暂停你的游戏循环（通过设置`GLKViewController`'s完成`paused`）
2.  暂停渲染循环（通过设置`GLKViewController`'s完成`paused`）
3.  获取当前方向状态的当前帧缓冲区
4.  使用对应于旋转方向状态的帧缓冲区和视口再次渲染当前游戏状态并获取该帧缓冲区

此外，您需要将`GLKView`'s`contentMode`设置为，`UIViewContentModeRedraw`以便`drawRect`在视图的框架因方向更改而更改后实际调用该方法。

最后在`GLKView`'s`drawRect`方法中，您需要检查是否`paused`正常进行渲染，在这种`YES`情况`NO`下，获取保存的帧缓冲区之一并通过常规调用将其绘制到视图中。`NO``YES``applicationWillResignActive``UIKit`

我不确定这个 hackish 解决方案与 集成的效果如何`GLKit`，您可能需要一些子类化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T09:04:54.653

实现委托方法（如果你还没有这样做的话）

`-(void)applicationWillEnterForeground`并`GLKViewController`从那里取消暂停。

根据我从您的问题中了解到的情况，您可以暂停游戏，但也可以在此方法中调整 glView 的大小，但是如果没有看到任何代码，也很难真正看到发生了什么。**

# wsdl - 带有 WSDL 消息的 tibco 数据格式

> ID：13954996
> 
> 赞同：2
> 
> 时间：2012-12-19T14:55:19.900
> 
> 标签：wsdl, tibco

我正在使用 TIBCO 设计器。我在创建使用数据格式（Parse Palette）中定义的类型的 WSDL 消息时遇到了一些问题。

当我尝试验证我的 WSDL 消息时，我收到此异常：“错误：未解决对元素“{http://www.tibco.com/ns/no_namespace_schema_location/Data Format.sharedparse}Rows”的引用。”

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T11:35:38.403

不要使用数据格式来定义您的类型。数据格式用于读取文本文件。相反，请使用 Schema（XML Tools Palette）定义您的类型。

# python - 多处理？多线程？水池？队列？蛮力

> ID：13954999
> 
> 赞同：2
> 
> 时间：2012-12-19T14:55:26.410
> 
> 标签：python, multithreading, hash, multiprocessing, pool

这是一个常识性问题，很快就会变成一个项目。我有一个脚本试图用已知的盐来暴力破解 sha1。无论如何，在这个应用中盐是已知的。无论如何，脚本工作正常，它是一个 python 脚本。当我运行它时，它会超过我可用的 16 个核心。我也想利用所有 16 个核心进行蛮力攻击！我对脚本进行了一些处理，并且能够在这里使用一个示例来利用多个内核，但它们并没有被完全使用。

[http://forum.openopt.org/viewtopic.php?id=51](http://forum.openopt.org/viewtopic.php?id=51)

这个parrelization东西对我来说很新，我不知道如何在python中处理它（更不用说任何脚本语言了）。

TL；DR，在 python 中，利用所有可用于对哈希（例如 MD5）进行暴力破解的核心的最佳方法是什么？

基本上我现在拥有的是这个......（注意释义的代码）

```
from multiprocessing imports Pools

def prog()
    generate hash_attempt
    compare it to target
jobs = []
po = Pool()
for stuff in things:
    po.apply_sync(prog()) 
```

这可行，但就像我想我说的那样，它并没有充分利用所有核心，然后有时它只是随机杀死。它只会停止执行，我调用脚本的终端将返回到它的提示符，在它上面，它会说，“Killed”。奇怪的东西。

万分感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T15:00:17.893

由于全局解释器锁，您无法有效地将 Python 线程用于 CPU 密集型工作。在这种情况下，您将不得不使用`multiprocessing`. `multiprocessing`由于通信开销，子进程可能无法 100% 地运行给定的 CPU 内核。为了最大限度地减少通信开销，请将工作分配给大块而不是小块的子进程。