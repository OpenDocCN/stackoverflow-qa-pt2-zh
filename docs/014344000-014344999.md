# StackOverflow 问答 14344000-14344999

# php - 匹配（a(n) 的一部分）由两个星号括起来的字母数字单词

> ID：14344002
> 
> 赞同：0
> 
> 时间：2013-01-15T18:06:37.287
> 
> 标签：php, regex

我正在寻找一个完成以下任务的正则表达式：

```
 **Only single**, alphanumeric p**art**s of **words** enclosed by two asterisks should be matched.**** 
```

从这个字符串中，“art”和“words”应该被过滤掉。

到目前为止，我已经得到了`\*{2}(\w+)`，但我一直在试图弄清楚如何处理结束的星号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:11:43.250

你可以试试这个`\*{2}([A-Za-z0-9]+)\*{2}`

```
\*     <- An asterisk (escaped as * is already a symbol)
{2}    <- Repeated twice
(      <- Start of a capturing group
  [A-Za-z0-9]    <- An alphanum (careful with \w, it's the equivalent of [a-zA-Z0-9_] not [a-zA-Z0-9])
  +              <- Repeated at least once
)      <- End of the capturing group
\*     <- An asterisk (again)
{2}    <- Repeated twice 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:12:18.933

这个怎么样？

[`\*{2}([a-zA-Z0-9]+)\*{2}`](http://regex101.com/r/eI1bU1)

![在此处输入图像描述](../Images/5dbd588101315bdbe41e198e627a7f14.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:12:02.080

```
preg_match_all('~(?<=\*\*)[a-z\d]+(?=\*\*)~i', $string, $matches); 
```

在这里查看它的实际操作：[http ://codepad.viper-7.com/OJHzEs](http://codepad.viper-7.com/OJHzEs)

* * *

这里有一个详细的解释：

![在此处输入图像描述](../Images/326c2e65fa12cdbfe682a9445eb5ac82.png)

# actionscript-3 - 带有 Adob e Air 的 ActionScript AirPlay 服务器

> ID：14344003
> 
> 赞同：3
> 
> 时间：2013-01-15T18:06:42.380
> 
> 标签：actionscript-3, air, rtsp, airplay

使用 ActionScript 3 创建作为 Adob​​e AIR 应用程序运行的跨平台服务器是否可行，可以通过支持 AirPlay 的设备播放音频？

我想编写一个在 PC、Mac 和移动设备上运行的 AIR 应用程序，允许用户通过 Apple TV 等 AirPlay 设备播放本地存储的音乐。我是 ActionScript 的新手，所以一直在寻找 AirPlay 示例来帮助我，但它们看起来很薄弱。

我找到了这个[非官方的 AirPlay 协议规范](http://nto.github.com/AirPlay.html)，但找不到任何 ActionScript 示例来帮助 RTSP，这对我来说也是新的。（我还没有做过任何套接字编程。）在我投入大量时间进行该项目之前，我想确认它是可能的。我不介意自下而上地投入工作来编写它，但事实上似乎没有其他人已经这样做了，甚至没有人问过它，这有点令人担忧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:06:52.670

几年前我为大学创建了一个这样的应用程序。我记得那段时间是不可能的。我必须创建一个 hack 以使其有点像你所说的那样工作。如果你愿意，我可以让你把我的 flex 项目发给你。该代码可能会有所帮助。

# java - Java中有哪些不同的jar文件，以及如何将它们导入Eclipse？

> ID：14344009
> 
> 赞同：2
> 
> 时间：2013-01-15T18:07:03.863
> 
> 标签：java, jar, apache-commons-io

我刚刚下载了commons-io-2.4-bin.zip，我要导入org.apache.commons.io.FileUtils；我打算在eclipse中添加jar（项目->属性->库->添加外部jar）。我知道 -javadoc.jar 必须包含 commons-io 库的文档，并且 -sources.java 必须包含源文件。但我仍然对我在做什么有疑问。

1.  我是否在 Eclipse 中包含 jar 文件的最佳方式
2.  -tests.jar 和 -test-sources.jar 文件是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:09:03.983

1.  您应该将`.jar`没有任何后缀的文件添加到构建路径。

2.  那些包含单元测试（和单元测试的源代码）

# php - 从mysql数据库中获取页面记录的问题

> ID：14344011
> 
> 赞同：0
> 
> 时间：2013-01-15T18:07:09.553
> 
> 标签：php, mysql

我`<p>good video"<strong>good</strong>"</p>`在数据库（mysql）中有记录。但是，如果我试图从数据库中获取记录到我的网页（基于 php）。它正在显示，但该单词`good` 以普通字体显示，而不是粗体。我的代码是这样的：

```
$gallerycontent = mysql_fetch_array(mysql_query("SELECT content FROM cms WHERE cms_id=27"));
echo $gallerycontent['content']; 
```

请帮助我如何解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:11:50.470

您已经将其设置为 string `"<strong>good</strong>"`。删除这样的引号：

```
<p>good video<strong>good</strong></p> 
```

然后它会很好用，或者你可以删除这样的引号：

```
$gallerycontent['content'] = str_replace(""", '', $gallerycontent['content']);
echo $gallerycontent['content']; 
```

输出将是：

> 好视频**好**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:12:14.643

首先确保`strong`标签出现在渲染的源代码中。

如果它们在那里，那么您可能需要设置 css 样式以使它们显得粗体。

```
strong {
   font-weight: bold;
} 
```

# ruby - 模式匹配时 =~ 和 match() 有什么区别？

> ID：14344016
> 
> 赞同：12
> 
> 时间：2013-01-15T18:07:19.860
> 
> 标签：ruby, regex, ruby-1.9.3

我正在使用`Ruby 1.9.3`. 我在玩一些模式，发现了一些有趣的东西：

示例 1：

```
irb(main):001:0> /hay/ =~  'haystack'
=> 0
irb(main):003:0> /st/ =~ 'haystack'
=> 3 
```

示例 2：

```
irb(main):002:0> /hay/.match('haystack')
=> #<MatchData "hay">
irb(main):004:0> /st/.match('haystack')
=> #<MatchData "st"> 
```

`=~`返回其第一个匹配的第一个位置，而`match`返回模式。除此之外，`=~`和之间有什么区别`match()`吗？

***执行时间差*** ***（根据@Casper）***

```
irb(main):005:0> quickbm(10000000) { "foobar" =~ /foo/ }
Rehearsal ------------------------------------
   8.530000   0.000000   8.530000 (  8.528367)
--------------------------- total: 8.530000sec

       user     system      total        real
   8.450000   0.000000   8.450000 (  8.451939)
=> nil

irb(main):006:0> quickbm(10000000) { "foobar".match(/foo/) }
Rehearsal ------------------------------------
  15.360000   0.000000  15.360000 ( 15.363360)
-------------------------- total: 15.360000sec

       user     system      total        real
  15.240000   0.010000  15.250000 ( 15.250471)
=> nil 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T18:21:44.290

首先确保您使用了正确的运算符：`=~`是正确的，`~=`不是。

运算符`=~`返回第一个匹配项的索引（`nil`如果不匹配）并将 存储`MatchData`在全局变量`$~`中。命名的捕获组分配给 上的散列`$~`，并且当`RegExp`是运算符左侧的文字时，也分配给具有这些名称的局部变量。

```
>> str = "Here is a string"
>> re = /(?<vowel>[aeiou])/    # Contains capture group named "vowel"
>> str =~ re
=> 1
>> $~
=> #<MatchData "e" vowel:"e">
>> $~[:vowel]    # Accessible using symbol...
=> "e"
>> $~["vowel"]    # ...or string
=> "e"
>> /(?<s_word>\ss\w*)/ =~ str
=> 9
>> s_word # This was assigned to a local variable
=> " string" 
```

该方法`match`返回`MatchData`自身（再次，`nil`如果不匹配）。在这种情况下，方法调用两侧的命名捕获组被分配给返回的`MatchData`.

```
>> m = str.match re
=> #<MatchData "e" vowel:"e">
>> m[:vowel]
=> "e" 
```

有关详细信息，请参阅[http://www.ruby-doc.org/core-1.9.3/Regexp.html](http://www.ruby-doc.org/core-1.9.3/Regexp.html)（以及关于`MatchData`和的部分`String`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T18:22:13.313

~~当您有一个不修改状态的方法时，重要的是返回值。那么除了颜色之外，红色和蓝色还有什么区别？我的观点是，这是一个奇怪的问题，你似乎已经知道答案了。~~（@sawa 让我直奔这里）

`nil`但话虽如此，当正则表达式不匹配时，这两种方法都会返回（一个虚假值）。而且，这两种方法在匹配时都会返回一个真值。`=~`返回一个整数，表示匹配的第一个字符，即使是`0`, 因为`0`在 Ruby 中是真值。 `match`返回一个包含非常详细的匹配数据的对象，当您需要大量关于匹配的信息时，这很方便。

`=~`通常在条件句中使用，当您只关心*是否*匹配时：

```
do_stuff if "foobar" =~ /foo/
do_stuff if "foobar".match(/foo/) # same effect, but probably slower and harder to read 
```

`match`当您需要有关匹配内容的详细信息时，通常使用：

```
 name = "name:bob".match(/^name:(\w+)$/)[1]
 puts name #=> 'bob' 
```

# google-app-engine - GAE 与实例同步数据

> ID：14344022
> 
> 赞同：0
> 
> 时间：2013-01-15T18:07:39.053
> 
> 标签：google-app-engine, synchronization, instance

如果我有这样的课程：

```
public class Example
{
    ArrayList<String> vector;

    public Example singleton = new Example();

    private Example()
    {
        //Read data from BD and fill the vector. Example vector:  ["foo","voo","faa","vuu","vee"]
    }   

    public synchronized removeElement()
    {
        vector.remove(0);
    }

    public synchronized changeElement()
    {
        vector.set(0,"fii");
    }
} 
```

如果有多个实例在运行，其中一个执行了方法`removeElement`，那么另一个实例的值会发生什么？如果其中一个执行该方法`changeElement`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T19:19:01.490

GAE 可以有多个并行运行的 JVM 实例，因此更新内存中的值将仅在该实例上可见。

您应该使用共享数据存储：memcache（免费、快速但易失）或数据存储（昂贵、较慢但一致）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T19:03:13.963

App Engine 实例在单独的 JVM 上运行，因此它们每个都将在内存中具有单独的“向量”实例。要在这些之间同步状态，您需要使用共享状态服务，例如数据存储或内存缓存。

# r - R 从零还是从一开始？

> ID：14344025
> 
> 赞同：5
> 
> 时间：2013-01-15T18:07:47.823
> 
> 标签：r, indexing

我们在 R 中有以下代码（已经剥离到骨骼进行调试）

```
tgtStart = 29593
for (i in tgtStart:tgtStart)
{
    PricerData[i, 1] = 111
}
print(PricerData[29592,1]) 
```

PricerData 是一个远远超出 29593 的矩阵，并且预先填充了 NA。

我不明白的是 PricerData[29592, 1] 将更改为 111，此代码打印 111，而不是我们预期的 NA。

只是为了让它更详细一点，我今天结束的代码是：

```
tgtStart = 29593
for (i in tgtStart:tgtStart)
{
    print(PricerData[i,1])
    print(PricerData[i-1,1])

    PricerData[i, 1] = 111

    print(PricerData[i,1])
    print(PricerData[i-1,1])
}
print(PricerData[29592,1]) 
```

它将打印：

```
[1] NA
[1] NA
[1] 111
[1] NA
[1] 111 
```

到最后一切如预期，为什么哦为什么我们开始之前的元素改变了？为什么不在循环中，只有在 for 循环关闭之后（哦，如果我们将 29593 更改为 29596，一切都按预期工作，我不明白。）。

另外，我不编写 R 代码，通常我在做 C++，我理解 R 是基于它的向量的，但请不要介意涵盖真正的基础知识。我们使用 R 版本 2.4.1.5, x64

编辑：好的，很明显我从我们的代码中删减了太多，所以对你来说问题就解决了，这是完整的功能，供参考，我不明白上面给出的输出

```
LoadPricer <- function(instrument, colo, simDate, sliceSize, startTime, endTime, pricerName, pricerSettings, returnEmptyMatrixIfFileNotFound = FALSE)
{

  fileName <- paste ( simulatorOutputBasePath, instrument, '\\', colo, '\\', format(simDate, '%Y%m%d'), '\\', sliceSize, '\\P#', pricerName, '#', pricerSettings, '.csv', sep='')   
    firstSliceRequest = GetSlicesSinceMidnight(startTime, sliceSize)
    lastSliceRequest = GetSlicesSinceMidnight(endTime, sliceSize)

    PricerData = as.matrix(matrix(NA, nrow=(lastSliceRequest - firstSliceRequest + 1), ncol = 1))

    if (file.exists(fileName))
    {
        # Load entire file
        AllData = as.data.frame(read.csv(fileName, header = TRUE, colClasses=c("customTimeFormat","numeric")))

        if (dim(AllData)[1] > 0)
        {
            firstSliceData = GetSlicesSinceMidnight(as.POSIXlt(AllData[1,1]), sliceSize)
            lastSliceData = GetSlicesSinceMidnight(as.POSIXlt(AllData[nrow(AllData),1]), sliceSize)

        if ( firstSliceData <= lastSliceRequest & lastSliceData >= firstSliceRequest )
            {
                tgtStart = max(1, firstSliceData - firstSliceRequest + 1)
                tgtEnd = min(lastSliceRequest - firstSliceRequest + 1, lastSliceData - firstSliceRequest + 1)
                srcStart = max(1, firstSliceRequest - firstSliceData + 1)
                srcEnd = min(lastSliceData - firstSliceData + 1, srcStart + tgtEnd - tgtStart)

        #PricerData[as.integer(tgtStart):as.integer(tgtEnd),1] = AllData[as.integer(srcStart):as.integer(srcEnd),2]
        for (i in tgtStart:tgtStart)
        {
          PricerData[i, 1] = 111# as.matrix(AllData[srcStart+i-tgtStart , 2])
        }
            }
        }
    }
    else
    {
        if (returnEmptyMatrixIfFileNotFound) PricerData = matrix(NA, nrow=0, ncol=2)
        print(paste('WARNING: Unable to load Pricer! File:', fileName))
    }

    return (PricerData)
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T18:15:04.747

基于一个

```
> PricerData <- matrix(NA, 30000, ncol=1)
> tgtStart <- 29593
> for (i in tgtStart:tgtStart) PricerData[i, 1] <- 111
> print(PricerData[29592, 1])
[1] NA
> print(PricerData[29593, 1])
[1] 111 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:18:25.630

但是你从 tgtStart=29593 开始

所以它将执行 i= 29593，因此它将替换 PricerData[29593, 1] = 111，而不是 PricerData[29592, 1]

```
> tgtStart = 29593
> for (i in tgtStart:tgtStart)
> {
>  PricerData[i, 1] = 111
> }
> print(PricerData[29592,1])
[1] NA
> print(PricerData[29593,1])
[1] 111 
```

# c# - “System.Net.HttpWebRequest”不包含“GetRequestStream”的定义

> ID：14344029
> 
> 赞同：10
> 
> 时间：2013-01-15T18:07:54.793
> 
> 标签：c#, windows-phone-8

我是 C# 和 Windows 手机的新手，我正在尝试制作一个执行 JSON 请求的小应用程序。我正在关注这篇文章中的示例[https://stackoverflow.com/a/4988809/702638](https://stackoverflow.com/a/4988809/702638)

我目前的代码是这样的：

```
public string login()
{
    var httpWebRequest = (HttpWebRequest)WebRequest.Create(MY_URL);
    httpWebRequest.ContentType = "text/plain"; 
    httpWebRequest.Method      = "POST";

    using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))
    {
       string text = MY_JSON_STRING;
       streamWriter.Write(text);
    }
} 
```

但由于某种原因，Visual Studio 会`GetRequestStream()`出现错误消息：

> 错误 CS1061：“System.Net.HttpWebRequest”不包含“GetRequestStream”的定义，并且找不到接受“System.Net.HttpWebRequest”类型的第一个参数的扩展方法“GetRequestStream”（您是否缺少 using 指令或装配参考？）

关于为什么会发生这种情况的任何想法？我已经导入了`System.Net`包。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T18:14:20.583

*HttpWebRequest*在 WP8中没有*GetRequestStream*或*GetRequestStreamAsync 。*您最好的选择是创建一个任务并等待它，如下所示：

```
using (var stream = await Task.Factory.FromAsync<Stream>(request.BeginGetRequestStream, request.EndGetRequestStream, null))
{
    // ...
} 
```

编辑：正如您提到的，您是 C# 新手，您需要让您的登录方法异步才能使用 await 关键字：

```
public async Task<string> LoginAsync()
{
    // ...
} 
```

调用者登录时需要在调用时使用 await 关键字：

```
string result = await foo.LoginAsync(); 
```

这是关于这个主题的一个很好的入门：http: [//msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)

# python - 获取 2to3 以使用空格而不是制表符

> ID：14344032
> 
> 赞同：1
> 
> 时间：2013-01-15T18:08:00.440
> 
> 标签：python, python-2to3

我曾经`2to3`转换 python 模块的文件夹。一切都很顺利，但是当我去运行其中一些时，它给了我一个关于空格和制表符的错误。我的理论：当`2to3`更改一行时，它使用制表符而不是空格，这与其他未更改的行不同。我想知道是否有办法改变这一点。

错误是：

```
TabError: inconsistent use of tabs and spaces in indentation 
```

代码片段很难显示，因为显示的选项卡相当于 4 个空格，但我检查并发生了这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-11-25T22:56:27.080

`2to3`不应该用制表符替换空格，所以我猜你会得到一个`TabError`，因为那些已经存在于代码和 python 3 中的制表符不允许在单个文件中混合制表符和空格，而这在 python 2 中很好。

这可以使用`reindent.py`python 附带的脚本修复，可以在 linux 系统下找到，`/usr/lib/python2.7/Tools/scripts/reindent.py`也可以选择使用 pip by 安装`pip install reindent`。那么用空格替换制表符的命令是：

```
reindent.py file.py 
```

# css - CSS 背景过渡 - 渐变

> ID：14344034
> 
> 赞同：3
> 
> 时间：2013-01-15T18:08:05.407
> 
> 标签：css, css-transitions, background-color

我一生都无法弄清楚为什么转换属性在我的 CSS 中不起作用。这是代码：

```
#header #menu-top-nav ul li a {
    -webkit-transition: background-color 10s;
    -moz-transition: background-color 10s;
    -ms-transition: background-color 10s;
    -o-transition: background-color 10s;
    transition: background-color 10s;
}
#header #menu-top-nav ul li a:hover {
    background: #dddddd; /* Old browsers */
    background: -moz-linear-gradient(top,  #dddddd 0%, #d3d3d3 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#dddddd), color-stop(100%,#d3d3d3)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #dddddd 0%,#d3d3d3 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #dddddd 0%,#d3d3d3 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #dddddd 0%,#d3d3d3 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #dddddd 0%,#d3d3d3 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#dddddd', endColorstr='#d3d3d3',GradientType=0 ); /* IE6-9 */
} 
```

标签背景在悬停之前在`a`技术上是透明的（尽管`ul`它包含在其中具有背景渐变）。但即使我为`a`标签分配了背景颜色或渐变，过渡仍然不起作用。我尝试将转换代码放入`a:hover`样式中；我尝试将变量更改为`background`和更改但`background-image`没有成功。

我的 CSS 中有更多样式，但我一直在 Chrome 中调试，找不到任何冲突的罪魁祸首。我应该提一下，transition 属性在任何浏览器中都不起作用。

谁能帮我摆脱看似简单的果酱？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:15:49.430

渐变是背景图像而不是背景颜色。所以背景颜色的过渡不会对渐变产生影响。

目前还不支持背景图像的过渡。

# python - gis.db 未定义 DJANGO_SETTINGS_MODULE

> ID：14344048
> 
> 赞同：6
> 
> 时间：2013-01-15T18:08:44.997
> 
> 标签：python, geodjango

当我使用

```
from django.contrib.gis.db import models 
```

我得到错误：

```
Traceback (most recent call last):
  File "<pyshell#0>", line 1, in <module>
    from django.contrib.gis.db import models
  File "C:\Python27\lib\site-packages\django\contrib\gis\db\models\__init__.py"
, line     2, in <module>
    from django.db.models import *
 File "C:\Python27\lib\site-packages\django\db\__init__.py", line 11, in <module>
   if DEFAULT_DB_ALIAS not in settings.DATABASES: 
  File "C:\Python27\lib\site-packages\django\utils\functional.py", line 184,
 in inner
   self._setup()
  File "C:\Python27\lib\site-packages\django\conf\__init__.py", line 40,
 in _setup
     raise ImportError("Settings cannot be imported, because environment 
variable %s 
is    undefined." % ENVIRONMENT_VARIABLE)
ImportError: Settings cannot be imported, because environment variable   
DJANGO_SETTINGS_MODULE is undefined. 
```

如何解决？

使用时

```
from django.db import models 
```

django 工作没有问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:53:17.627

有两种方法可以解决此问题：

1.  您需要添加一个[`settings`](https://docs.djangoproject.com/en/dev/topics/settings/#designating-the-settings)模块并设置`DJANGO_SETTINGS_MODULE`为指向它，或者
2.  用于[`settings.configure`](https://docs.djangoproject.com/en/dev/topics/settings/#using-settings-without-setting-django-settings-module)绕过`DJANGO_SETTINGS_MODULE`env 变量。

第二种选择可以很好地使用部分内容，`django`而无需实际设置项目所需的所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T16:56:53.157

`gis.db` **在您的问题**中不是必需的。****

 **两个导入命令之间的区别仅在于上下文以及运行它们的方式，因为在导入除了导入一些空文件之外的任何内容`django.contrib.gis.db.models`之前不会做任何事情。`django.db.models``__init__.py`

如何在正确的环境中测试任何东西的最简单方法是通过管理命令，例如

```
$ python manage.py shell
# now you are sure that django.conf settings have been imported
>>> from django.contrib.gis.db import models
>>> from django.db import models
# Both will equally succeed (or maybe fail for another reason) 
```

（一个类似的问题[Django 文档：Models; error from line 1 of code](https://stackoverflow.com/q/10309295/448474)）**

# php - 循环中断PHP时的Wordpress自定义帖子类型

> ID：14344056
> 
> 赞同：0
> 
> 时间：2013-01-15T18:09:26.040
> 
> 标签：php, wordpress, while-loop, custom-post-type

我的 While 循环正在破坏网站上我的 PHP 的其余部分。我也使用高级自定义字段作为参考。下面我放了我的代码，它正在工作，但再次破坏了网站的其余部分（和或低于此的任何内容）。

任何建议感谢您长期以来的帮助！

 `````
<?php 
    $query = array( 'post_type' => 'slides', 'orderby' => 'ASC' );
    $loop = new WP_Query($query);
    while ( $loop->have_posts() ) : $loop->the_post();

        $title = get_the_title();
        $image_object = get_field('slides');
        $alt = $image_object['title'];
        $sizes = $image_object['sizes'];
        $image = $sizes['slider'];

        echo '<div>';
        echo '<div class="slide">';
        echo '<img src="' . $image . '" alt="' . $alt . '" />';
        echo '</div>';
        echo '</div>';
    endwhile;
?> 
````  `* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:13:47.517

尝试在自定义循环之后添加[wp_reset_query() ：](http://codex.wordpress.org/Function_Reference/wp_reset_query)

```
<?php 
    $query = array( 'post_type' => 'slides', 'orderby' => 'ASC' );
    $loop = new WP_Query($query);
    while ( $loop->have_posts() ) : $loop->the_post();

        $title = get_the_title();
        $image_object = get_field('slides');
        $alt = $image_object['title'];
        $sizes = $image_object['sizes'];
        $image = $sizes['slider'];

        echo '<div>';
        echo '<div class="slide">';
        echo '<img src="' . $image . '" alt="' . $alt . '" />';
        echo '</div>';
        echo '</div>';
    endwhile;
    wp_reset_query();
?> 
`````

# java - 在测试中不使用 @Transactional 从 HibernateTemplate 迁移到 SessionFactory

> ID：14344058
> 
> 赞同：3
> 
> 时间：2013-01-15T18:09:40.337
> 
> 标签：java, spring, hibernate, transactions, integration-testing

我正在努力使用 Spring 3 迁移到 Hibernate 4，这意味着我不能再使用 Spring 的 HibernateTemplate。重构代码很容易（在使用会话的地方用 sessionFactory.getCurrentSession() 替换回调），但我的单元测试遇到了问题。特别是，我希望对我的 DAO 进行完全实时的集成测试——不使用 @Transactional。

但是，由于 HibernateTemplate 不再提供在会话未打开时打开会话的方法，因此我得到“没有为当前线程找到会话”。当我运行测试时，因为 sessionFactory.getCurrentSession() 如果会话未打开，则不会打开会话。

有没有办法解决这个问题来复制 HibernateTemplate 给我的东西，而无需在我的测试中使用 @Transactional？似乎它应该是可能的，但我只能在我用 @Transactional 注释测试类时让测试工作（因为它确实打开了一个会话）。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-16T12:20:00.480

如果你使用 Junit 测试它非常简单。

在您的测试类中，您必须加载 Spring 上下文：

```
@BeforeClass
public static void createApplicationContext(){      
    try {           
         applicationContext = new ClassPathXmlApplicationContext(
                new String[] {"applicationContext.xml"});           
         yourDao = (YourDao)applicationContext.getBean("YourDao");           
    } catch (Exception e) {
        Assert.assertNull(e);
    }
} 
```

然后您可以使用`yourDao`和编写测试逻辑。

# sqlite - 更新 VS2012 项目后无法编译，SQLite 未安装错误

> ID：14344059
> 
> 赞同：2
> 
> 时间：2013-01-15T18:09:48.020
> 
> 标签：sqlite, visual-studio-2012, versioning

今天早上我启动 Visual Studio 时，它通知我要安装几个更新：VS 反馈工具和 SQLite。我安装了两者，并重新启动了 VS 2012。

但是在编译我的项目的过程中发生了一件“有趣”的事情：在我的项目中仍然引用“SQLite for Windows Runtime 3.7.14.1”时，我收到一条错误消息，表明没有安装 SQLite 3.7.14.1。好的，所以我从引用中删除了它，并添加了对“SQLite for Windows Runtime 3.7.15.1”的引用

然而，在那之后我仍然得到同样的错误消息。什么？？？所以我删除了 3.7.15.1，不添加任何引用，现在我的项目编译了。但是我的项目确实使用了 SQLite——这是怎么回事？

在我的参考管理器列表中，提供了三个“SQLite for Windows Runtime”版本：

```
3.7.14.1
3.7.15
-and
3.7.15.1 
```

用文斯·隆巴迪 (Vince Lombardi) 的不朽话语来说，“这里到底发生了什么？！？”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T17:14:15.900

问题是安装的最新 SQLite 版本是 3.7.15.2，而我试图引用 3.7.15.1，它不再存在于我的机器上。一旦我从参考的“扩展”选项卡中获得了最新版本（而不是尝试从“最近”选项卡中选择倒数第二个版本），它编译得很好。

# python - 多个轴的单个图例

> ID：14344063
> 
> 赞同：31
> 
> 时间：2013-01-15T18:09:54.290
> 
> 标签：python, matplotlib

我有以下示例代码：

```
fig1.suptitle('Test')
ax1 = fig1.add_subplot(221)
ax1.plot(x,y1,color='b',label='aVal')
ax2 = ax1.twinx()
ax2.plot(x,y2,color='g',label='bVal')
ax2.grid( ls='--', color='black')
legend([ax1,ax2], loc=2) 
```

子图在同一个子图上有两个不同比例的轴，我只想要两个轴的一个图例。我尝试了上面的代码，但它不起作用，只能从 ax2 生成详细信息。有任何想法吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-01-15T18:14:10.223

我认为这是一个可行的解决方案！还有比这更好的方法吗？

```
fig1.suptitle('Test')
ax1 = fig1.add_subplot(221)
ax1.plot(x,y1,color='b',label='aVal')
ax2 = ax1.twinx()
ax2.plot(x,y2,color='g',label='bVal')
ax2.grid( ls='--', color='black')
h1, l1 = ax1.get_legend_handles_labels()
h2, l2 = ax2.get_legend_handles_labels()
ax1.legend(h1+h2, l1+l2, loc=2) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-12-08T02:55:28.133

这确实是一篇旧帖子，但我想我找到了一种更简单的方法，可以进行更多控制。

这是python3.5上的（matplotlib。**版本**'1.5.3'）：

```
import matplotlib.pyplot as plt
fig, ax1 = plt.subplots()
plt.suptitle('Test')
ax2 = ax1.twinx()
a, =  ax1.plot([1, 2, 3], [4, 5, 6], color= 'blue', label= 'plt1')
b, = ax2.plot([7, 8, 9],[10, 11, 12], color= 'green', label= 'plt2')
p = [a, b]
ax1.legend(p, [p_.get_label() for p_ in p],
           loc= 'upper center', fontsize= 'small') 
```

[![显示（）](../Images/daf37054b2879b7ce9a8563ab2fb9457.png)](https://i.stack.imgur.com/54mld.png)

# prolog - 在 prolog 控制台中编写元素

> ID：14344068
> 
> 赞同：2
> 
> 时间：2013-01-15T18:10:04.450
> 
> 标签：prolog, dcg

在序言中，我必须这样做：

```
 ************************
    *                      *
    *      ##########      *
    *      # button #      *
    *      ##########      *
    *                      *
    ************************ 
```

用户给出窗口的宽度和高度（用*创建），以及按钮的坐标、宽度、高度和文本（用#创建）。这个“窗口”是在 prolog 控制台中编写的。我在编写窗口本身时没有问题，但我不知道如何处理其中的某些内容。任何人都可以帮助我，我的意思不是为我写它，但即使是小的指南也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:20:51.693

在 DCG 的帮助下将其编写为干净的语法。

这是一个开始。[更多细节，在这里](https://stackoverflow.com/a/8269897/772868)。

```
:- use_module(library(double_quotes)).
:- set_prolog_flag(double_quotes,chars).

newline --> "\n".

pre --> "# ".

post --> " #".

button -->
   pre,
   "button",
   post. 
```

现在您可以在顶层查询它：

```
?- phrase(button, Xs).
Xs = "# button #". 
```

你可以直接打印出来：

```
?- phrase(button, Xs), atom_chars(A, Xs), write(A). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T01:11:07.293

查看 format/2，它的工作方式类似于 C++ 中的 printf

# jquery - jQuery，悬停一个有序的颜色数组，然后在单击时设置悬停颜色

> ID：14344072
> 
> 赞同：1
> 
> 时间：2013-01-15T18:10:20.583
> 
> 标签：jquery, arrays, menu, click, hover

我遇到了垂直菜单的问题，它是悬停动作。我的客户要求悬停颜色从一组 5 种颜色中依次更改。

我的问题的一个例子就[在这个小提琴](http://jsfiddle.net/mdfq7/)（和下面）中，我的脚本在很大程度上受到了之前一个名为[Keep :hover color on mouse click via Jquery](https://stackoverflow.com/questions/9406988/keep-hover-color-on-mouse-click-via-jquery)的stackoverflow问题的影响。

我想要发生的是，每次悬停时，颜色都会通过数组发生变化。一旦用户单击其中一个链接，该链接将更改为显示其悬停颜色（如活动状态），但仅在单击另一个链接之前，该链接将成为其自己的颜色（切换活动状态到新链接）。如果活动颜色与悬停颜色相同，那就太好了，但这不是必需的。

HTML 和 CSS 都是标准的，我的脚本如下：

```
 jQuery(document).ready(function($) {

    var colors = ["#737b35","#f57b20","#cbb778","#717174","#3a6f8f"];  

    $("#menu-sidebar-menu li a").each(function(i){

        $(this).click(function() {
            $("#menu-sidebar-menu li a").each(function(i,elem) { // clear the style first
                 $(elem).removeClass("clicked");
           });//so only ONE element is coloured SELECTED
           $(this).addClass("clicked");//add the "selected" colour
        });

        $(this).hover(
            function() {
                if(!$(this).hasClass("clicked")) {
        $("#menu-sidebar-menu li a").css('background', '');
                    $(this).css('background', colors[i % colors.length]);
                }
            }, 
            function(){
                if(!$(this).hasClass("clicked")) {
                    $(this).css('background', '');
                } 
            }
        );

    });

    }); 
```

正如我现在所拥有的，悬停动作是完美的。但是，一旦单击 2 个或更多链接，背景颜色就会保留，并且不会按照我需要的方式从链接切换到链接。

我正在尝试掌握 jQuery，但我没有人可以问愚蠢的问题，所以我非常感谢任何和所有的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:28:26.407

```
 $("#menu-sidebar-menu li a")
    .click(function () {
      $("#menu-sidebar-menu li a").removeClass("clicked").not(this).css('background', '');
      $(this).addClass("clicked");
    })
    .hover(
      function () {
        if (!$(this).hasClass("clicked"))
          $(this).css('background', colors[$(this).index("#menu-sidebar-menu li a") % colors.length]);
      },
      function () {
        if (!$(this).hasClass("clicked"))
          $(this).css('background', '');
      }
    ); 
```

[***演示***](http://jsfiddle.net/Lhq9M/)

# php - 如何在单击菜单选项时显示特定类别的帖子？

> ID：14344077
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:10:29.563
> 
> 标签：php, mysql

我有两张桌子，`Post`和`Category`。

**邮政**

```
 pid   title    result    content      cid   
   1    Option1    Opt      content1      2   
   2    Option2    Opt      content2      2   
   3    Option3    Opt      content3      3 
```

**类别**

```
 cid  cname   
   1     Cat 1    
   2     Cat 2    
   3     Cat 3 
```

这是我的**insert.php**。

```
mysql_connect('localhost','root','');

mysql_select_db("database") or die("Unable to select database");

$title=$_POST['post_title'];
$result=$_POST['post_result'];
$content=$_POST['post_content'];
$sid=$_POST['cid'];
$date=$_POST['date'];

$insertquery="INSERT INTO review (post_title,post_result,post_content,cid,date)
          VALUES('$title','$result','$content',$sid,NOW())";

$result=mysql_query($insertquery);

if(! $result )
{
  die('Could not enter data: ' . mysql_error());
}
else {

        echo "Entered data successfully\n";
        header('Location:home.php');
    } 
```

这是我的**cat.php**，它显示特定类别的帖子。

```
$link = mysql_connect("localhost","root","");
mysql_select_db("database");

$query="SELECT * FROM category WHERE cid='$cid'";

 $result = mysql_query($query) or die("Query to get data failed with error:  ".mysql_error());

while($row = mysql_num_rows($result)) { 
echo    //details goes here

} 
```

这是我在主页上的类别菜单列表。

```
<ul>            
<li><a class="my-button" href="#">Cat 1</a></li>
<li><a class="my-button" href="#">Cat 2</a></li>
<li><a class="my-button" href="#">Cat 3</a></li>
</ul> 
```

这是 javascript。

```
<script>
$(document).ready(function() {
$('body').on('click', '.my-button', function() {

   $("#display").load("cat.php");

   });
});
</script> 
```

一切都被正确地插入到数据库中。但我无法在点击时显示特定类别的帖子。

我已经给出了完整的代码。我想要的是，当我在主页上单击 Cat 1 或 Cat 2 或 Cat 3 时，我需要在`#display`div 中显示所选类别的 post 表中的所有数据。

我收到一条错误消息：

> cid 是未定义的变量

请帮我找到正确的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:16:14.730

那是因为查看查询中使用的脚本`$cid`未在任何地方定义。感谢至少 ahving 错误报告。下次您真的应该阅读并理解您收到的错误消息，因为这通常会告诉您确切的问题是什么。

另外，你真的需要看看学习 mysqli 或 PDO。已`mysql_*`弃用，不应再使用。您还存在严重的 SQL 注入漏洞，因此您应该阅读如何处理该漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:24:02.997

我认为你走错了路。您没有向 cat.php 发送任何数据，因此 $cid 未定义。将类别 ID 发送到 load.php 以获取有效结果。就像是

```
$("#display").load("cat.php",{cid: yourvalue}); 
```

# ssl-certificate - 无法让 Google 地球插件加载需要证书的地面叠 加层？

> ID：14344084
> 
> 赞同：1
> 
> 时间：2013-01-15T18:10:48.573
> 
> 标签：ssl-certificate, google-earth-plugin

使用插件版本 6.2.2.x 我似乎无法加载需要证书才能访问的地面覆盖。如下代码片段会导致插件向用户请求证书，但它似乎忽略了它，因为插件没有获得覆盖并显示丢失的覆盖红色 X。

```
 this.groundOverlay = this.earth.createGroundOverlay('');
   this.overlayImg = this.earth.createIcon('');
   this.viewBb = this.earth.getView().getViewportGlobeBounds();

   this.overlayImg.setHref('https://host:port/wms?...');
   this.groundOverlay.setIcon(this.overlayImg);
   this.groundOverlay.setLatLonBox(this.viewBb);
   this.earth.getFeatures().appendChild(this.groundOverlay); 
```

有谁知道这是否应该/不应该工作？我已经阅读了有关 GE 胖客户端的证书问题，但对插件一无所知。

# ios - 使用 nsoperation 时出现核心数据错误

> ID：14344085
> 
> 赞同：0
> 
> 时间：2013-01-15T18:10:51.127
> 
> 标签：ios, core-data, nsinvocationoperation

我在一个并发的方法中使用了一些核心数据实体（它在一个`NSInocationOperation`对象中）......我收到了这个错误：

```
CoreData: error: NULL _cd_rawData but the object is not being turned into a fault 
```

如何避免这种情况？该方法只是对核心数据值进行一些计算，没有添加新实体，没有删除实体，也没有修改任何实体......

# menuitem - 使用 dojo mvc 重复创建 dojo MenuItems

> ID：14344093
> 
> 赞同：1
> 
> 时间：2013-01-15T18:11:09.643
> 
> 标签：menuitem, dojo

我正在尝试`DropDownButton`使用 a创建一个 dijit`DropDownMenu`并使用 dojo mvc 使用菜单项填充它。这是可能的还是我需要手动创建/删除`MenuItems`？我已经尝试了以下，但`DropDownMenu`没有得到填充。

```
<div data-dojo-attach-point="person_select_btn" data-dojo-type="dijit/form/DropDownButton">
    <div data-dojo-attach-point="person_list_drop_menu" data-dojo-type="dijit/DropDownMenu">
        <div data-dojo-type="dojox/mvc/Repeat" 
             data-dojo-props="exprchar: '#' children: at(this.personListModel, 'model')">
            <div data-dojo-type="dijit/MenuItem"
                 data-dojo-props="label: at('rel:#{this.index}','personName')">
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T06:04:08.937

引入的 Dojo 1.8[`dojox/mvc/WidgetList`](http://dojotoolkit.org/reference-guide/1.8/dojox/mvc/WidgetList.html)有效地取代了`dojox/mvc/Repeat`. 有一种方法可以使用 来创建重复的菜单项`dojox/mvc/WidgetList`，例如（将 /path/to/dojotoolkit 替换为您环境中 Dojo Toolkit 的路径）：

```
<!DOCTYPE html>
<html>
    <head>
        <link id="themeStyles" rel="stylesheet" href="/path/to/dojotoolkit/dijit/themes/claro/claro.css"/>
        <link rel="stylesheet" href="/path/to/dojotoolkit/dijit/themes/claro/document.css"/>
        <script type="text/javascript" src="/path/to/dojotoolkit/dojo/dojo.js" data-dojo-config="parseOnLoad: 0, isDebug: 1, async: 1, mvc: {debugBindings: 1}"></script>
        <script type="text/javascript">
            require([
                "dojo/parser",
                "dijit/Menu",
                "dijit/MenuItem",
                "dojox/mvc/getStateful",
                "dojo/domReady!"
            ], function(parser, Menu, MenuItem, getStateful){
                menuTemplateString = Menu.prototype.templateString; // So that dijit/Menu and dojox/mvc/WidgetList mix can refer to dijit/Menu's original templateString

                windowContextMenuData = getStateful([
                    {label: "Item One", onClick: function(){ alert("Hello world One"); }},
                    {label: "Item Two", onClick: function(){ alert("Hello world Two"); }},
                    {label: "Item Three", onClick: function(){ alert("Hello world Three"); }},
                    {label: "Item Four", onClick: function(){ alert("Hello world Four"); }},
                    {label: "Item Five", onClick: function(){ alert("Hello world Five"); }},
                    {label: "Item Six", onClick: function(){ alert("Hello world Six"); }},
                    {label: "Item Seven", onClick: function(){ alert("Hello world Seven"); }},
                    {label: "Item Eight", onClick: function(){ alert("Hello world Eight"); }},
                    {label: "Item Nine", onClick: function(){ alert("Hello world Nine"); }},
                    {label: "Item Ten", onClick: function(){ alert("Hello world Ten"); }}
                ]);

                parser.parse();
            });
        </script>
    </head>
    <body class="claro" role="main">
        <script type="dojo/require">at: "dojox/mvc/at"</script>
        <div id="windowContextMenu"
         data-dojo-type="dijit/Menu"
         data-dojo-mixins="dojox/mvc/WidgetList"
         data-dojo-props='contextMenuForWindow: true, style: "display: none;", children: windowContextMenuData, templateString: menuTemplateString'
         data-mvc-child-type="dijit/MenuItem"
         data-mvc-child-props='"*": at(this.target, "*")'>
        </div>
    </body>
</html> 
```

不过，上述方法不适用于不同类型的菜单（如`CheckedMenuItem`）。即将发布的 Dojo 将解决这个问题： http: [//trac.dojotoolkit.org/changeset/30158/dojo](http://trac.dojotoolkit.org/changeset/30158/dojo)

# numpy - 任意轮廓的平滑样条表示，f(length) --> x,y

> ID：14344099
> 
> 赞同：16
> 
> 时间：2013-01-15T18:11:30.200
> 
> 标签：numpy, scipy, curve-fitting, bezier, spline

假设我有一组沿轮廓标记点的 x,y 坐标。有没有一种方法可以构建轮廓的样条表示，我可以在沿其长度的特定位置评估并恢复插值的 x,y 坐标？

X 和 Y 值之间通常没有 1:1 的对应关系，因此单变量样条曲线对我没有好处。双变量样条曲线很好，但据我所知，所有用于评估双变量样条曲线的函数都`scipy.interpolate`取 x,y 值并返回 z，而我需要给出 z 并返​​回 x,y（因为 x,y 是一条线，每个 z 映射到一个唯一的 x,y)。

这是我想做的事情的草图：

```
import numpy as np
from matplotlib.pyplot import plot

# x,y coordinates of contour points, not monotonically increasing
x = np.array([ 2.,  1.,  1.,  2.,  2.,  4.,  4.,  3.])
y = np.array([ 1.,  2.,  3.,  4.,  2.,  3.,  2.,  1.])

# f: X --> Y might not be a 1:1 correspondence
plot(x,y,'-o')

# get the cumulative distance along the contour
dist = [0]
for ii in xrange(x.size-1):
    dist.append(np.sqrt((x[ii+1]-x[ii])**2 + (y[ii+1]-y[ii])**2))
d = np.array(dist)

# build a spline representation of the contour
spl = ContourSpline(x,y,d)

# resample it at smaller distance intervals
interp_d = np.linspace(d[0],d[-1],1000)
interp_x,interp_y = spl(interp_d) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-15T22:42:28.830

您想使用参数样条曲线，而不是`y`从`x`值进行插值，而是设置一个新参数 ，并从 的值和 的值进行`t`插值，对两者都使用单变量样条曲线。您如何为每个点分配值会影响结果，并且正如您的问题所建议的那样，使用距离可能是一个好主意：`y``x``t``t`

```
from __future__ import division
import numpy as np
import matplotlib.pyplot as plt
import scipy.interpolate

x = np.array([ 2.,  1.,  1.,  2.,  2.,  4.,  4.,  3.])
y = np.array([ 1.,  2.,  3.,  4.,  2.,  3.,  2.,  1.])
plt.plot(x,y, label='poly')

t = np.arange(x.shape[0], dtype=float)
t /= t[-1]
nt = np.linspace(0, 1, 100)
x1 = scipy.interpolate.spline(t, x, nt)
y1 = scipy.interpolate.spline(t, y, nt)
plt.plot(x1, y1, label='range_spline')

t = np.zeros(x.shape)
t[1:] = np.sqrt((x[1:] - x[:-1])**2 + (y[1:] - y[:-1])**2)
t = np.cumsum(t)
t /= t[-1]
x2 = scipy.interpolate.spline(t, x, nt)
y2 = scipy.interpolate.spline(t, y, nt)
plt.plot(x2, y2, label='dist_spline')

plt.legend(loc='best')
plt.show() 
```

![在此处输入图像描述](../Images/9f48abcb36754fb959260926bfd396f9.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-10T08:11:35.653

这是使用[splprep](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.splprep.html)和[splev](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.splev.html)的示例：

```
import numpy as np
import scipy.interpolate
from matplotlib.pyplot import plot

# x,y coordinates of contour points, not monotonically increasing
x = np.array([2.,  1.,  1.,  2.,  2.,  4.,  4.,  3.])
y = np.array([1.,  2.,  3.,  4.,  2.,  3.,  2.,  1.])

# f: X --> Y might not be a 1:1 correspondence
plot(x, y, '-o')

# get the cumulative distance along the contour
dist = np.sqrt((x[:-1] - x[1:])**2 + (y[:-1] - y[1:])**2)
dist_along = np.concatenate(([0], dist.cumsum()))

# build a spline representation of the contour
spline, u = scipy.interpolate.splprep([x, y], u=dist_along, s=0)

# resample it at smaller distance intervals
interp_d = np.linspace(dist_along[0], dist_along[-1], 50)
interp_x, interp_y = scipy.interpolate.splev(interp_d, spline)
plot(interp_x, interp_y, '-o') 
```

[![参数样条示例](../Images/15d63cd0013e69adfb3801d9d889f775.png)](https://i.stack.imgur.com/YPpze.png)

# android - Proguard 和 Scoreloop

> ID：14344100
> 
> 赞同：2
> 
> 时间：2013-01-15T18:11:40.160
> 
> 标签：android, proguard, scoreloop

我正在尝试在我的 Android 项目上使用 Proguard，并在运行时在 Scoreloop（版本 3.0.3）库上不断收到相同的错误...

我在 project.properties 文件中定义了 proguard 配置文件，如下所示：

```
proguard.config=${sdk.dir}/tools/proguard/proguard-android-optimize.txt:proguard-project.txt
proguard.enabled=true 
```

这是我的 proguard-project.txt 文件（包含所有内容，以防我在某处做错了什么......）：

```
# ####### #
# Project #
# ####### #
-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference

# ##### #
# AdMob #
# ##### #
-keep public class com.google.ads.** {*;}
-keep public class com.google.gson.** {*;}

# #### #
# ACRA #
# #### #
# we need line numbers in our stack traces otherwise they are pretty useless
-renamesourcefileattribute SourceFile
-keepattributes SourceFile,LineNumberTable

# ACRA needs "annotations" so add this... 
-keepattributes *Annotation*

# keep this class so that logging will show 'ACRA' and not a obfuscated name like 'a'.
# Note: if you are removing log messages elsewhere in this file then this isn't necessary
-keep class org.acra.ACRA {*;}

# keep this around for some enums and classes that ACRA needs
-keep class org.acra.ReportingInteractionMode {*;}
#-keep class org.acra.ReportField {*;}
-keepnames class org.acra.ReportField {*;}

# keep this otherwise it is removed by ProGuard
-keep public class org.acra.ErrorReporter {
    public void addCustomData(java.lang.String,java.lang.String);
}
-keep public class org.acra.ErrorReporter {
    public org.acra.ErrorReporter$ReportsSenderWorker handleSilentException(java.lang.Throwable);
}

# ######### #
# Scoreloop #
# ######### #
-dontwarn com.scoreloop.client.android.core.paymentprovider.**
-keep class com.scoreloop.client.android.core.paymentprovider.fortumo.FortumoPaymentProviderController {*;}
-keep class com.scoreloop.client.android.core.paymentprovider.fortumo.FortumoPaymentProvider {*;}
-keep class com.scoreloop.client.android.core.paymentprovider.paypalx.PayPalXPaymentProviderController {*;}
-dontwarn com.scoreloop.client.android.core.ui.WebViewDialog
-keep class com.scoreloop.client.android.core.ui.WebViewDialog {*;}
-keep class com.facebook.android.** {*;}

# ############## #
# In-App Billing #
# ############## #
# -keep class com.android.vending.billing.**

# ####### #
# OrmLite #
# ####### #
# OrmLite uses reflection
-keep class com.j256.**
-keepclassmembers class com.j256.** { *; }
-keep enum com.j256.**
-keepclassmembers enum com.j256.** { *; }
-keep interface com.j256.**
-keepclassmembers interface com.j256.** { *; } 
```

我在运行时收到此错误：

```
Caused by: java.lang.IllegalArgumentException: java.lang.NoSuchMethodException: <init> [class com.scoreloop.client.android.core.b.aw]
    at com.scoreloop.client.android.core.b.j.a(SourceFile:692)
    at com.scoreloop.client.android.core.b.j.<init>(SourceFile:368)
    at com.sofresh.games.megaflux.MegaFluxApplication.onCreate(SourceFile:106)
    at com.sofresh.games.megaflux.MegaFluxApplication_.onCreate(SourceFile:19)
    at android.app.Instrumentation.callApplicationOnCreate(Instrumentation.java:1000)
    at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4391)
    ... 10 more
 Caused by: java.lang.NoSuchMethodException: <init> [class com.scoreloop.client.android.core.b.aw]
    at java.lang.Class.getConstructorOrMethod(Class.java:460)
    at java.lang.Class.getConstructor(Class.java:431)
    at com.scoreloop.client.android.core.b.j.a(SourceFile:684) 
```

从文件 mapping.txt 中，我发现了关于有问题的类和调用：

```
com.scoreloop.client.android.core.model.Client -> com.scoreloop.client.android.core.b.j:
    java.util.Map a -> a
    com.scoreloop.client.android.core.model.ClientObserver b -> b
    com.scoreloop.client.android.core.model.Session c -> c
    103:104:boolean a(java.util.Properties,java.lang.String,boolean) -> a
    155:178:java.util.Properties a(android.content.Context) -> a
    182:185:void a(java.util.Properties,java.lang.String) -> a
    188:194:void a(java.util.Properties,java.lang.String,java.lang.String) -> a
    198:232:void a(android.content.Context,java.lang.String) -> a
    380:387:void a(java.util.Properties) -> a
    638:640:int b(java.util.Properties,java.lang.String) -> b
    684:692:void a(java.lang.Class) -> a
    708:711:void a$2a1b557e(com.scoreloop.client.android.core.model.Session) -> a
    715:718:boolean a(com.scoreloop.client.android.core.model.Session) -> b
    722:723:void b(android.content.Context) -> b
[...]
com.scoreloop.client.android.core.model.Session -> com.scoreloop.client.android.core.b.aw:
[...] 
```

所以我以为报错说找不到Client接受Session的构造函数。我尝试将以下内容添加到我的 proguard conf 中：

```
-keep class com.scoreloop.client.android.core.model.** {*;}
-keepclassmembers class com.scoreloop.client.android.core.model.** 
```

没有运气，现在我收到了这个错误：

```
Caused by: java.lang.IllegalArgumentException: java.lang.NoSuchMethodException: <init> [class com.scoreloop.client.android.core.model.Session]
    at com.scoreloop.client.android.core.model.Client.a(SourceFile:692)
    at com.scoreloop.client.android.core.model.Client.a(SourceFile:605)
    at com.scoreloop.client.android.core.model.Client.<init>(SourceFile:368)
    at com.blabla.MyApplication.onCreate(SourceFile:106)
    at com.blabla.MyApplication_.onCreate(SourceFile:19)
    at android.app.Instrumentation.callApplicationOnCreate(Instrumentation.java:1000)
    at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4391)
    ... 10 more
 Caused by: java.lang.NoSuchMethodException: <init> [class com.scoreloop.client.android.core.model.Session]
    at java.lang.Class.getConstructorOrMethod(Class.java:460)
    at java.lang.Class.getConstructor(Class.java:431)
    at com.scoreloop.client.android.core.model.Client.a(SourceFile:684) 
```

现在我对接下来要尝试什么有点迷失了......关于这个错误的任何想法和启示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:35:37.913

在收到 Scoreloop 支持的响应和我这边的一些测试后，这里是 Scoreloop 的 ProGuard 配置：

```
# ######### #
# Scoreloop #
# ######### #
-dontwarn com.scoreloop.client.android.core.paymentprovider.**
-keep class com.scoreloop.client.android.core.paymentprovider.fortumo.FortumoPaymentProviderController {*;}
-keep class com.scoreloop.client.android.core.paymentprovider.fortumo.FortumoPaymentProvider {*;}
-keep class com.scoreloop.client.android.core.paymentprovider.paypalx.PayPalXPaymentProviderController {*;}
-dontwarn com.scoreloop.client.android.core.ui.WebViewDialog
-keep class com.scoreloop.client.android.core.ui.WebViewDialog {*;}
-keep class com.facebook.android.** {*;}
-keep class com.scoreloop.client.android.core.** { *; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T01:45:54.617

该代码执行反射并且找不到构造函数，因此您确实必须确保它被保留。您的 -keep 选项保留指定包及其子包中的所有类/字段/方法：

```
-keep class com.scoreloop.client.android.core.model.** {*;} 
```

然而，代码可能试图在这个包之外找到一个类的构造函数——不幸的是堆栈跟踪没有告诉。您必须弄清楚这是哪个类（或一组类），然后保留其构造函数。

请注意，您的 -keepclassmembers 选项不会做任何事情（因为它没有指定任何类成员），但这不是必需的。

# javascript - HTML5/Javascript - 我的简单画布动画不起作用

> ID：14344107
> 
> 赞同：0
> 
> 时间：2013-01-15T18:11:57.330
> 
> 标签：javascript, html5-canvas

我认为这将是一种会有很多教程的东西，但是我发现的每一个都过于复杂、模糊或使用了尚未广泛支持的功能。所以，我决定自己尝试一下。我的代码如下。

```
function drawStuff(){
var x = document.getElementById("myCanvas");
var canvas = x.getContext('2d');

var i;

function animate(){
    canvas.clearRect(0,0,500,500);
    canvas.fillStyle="red";
    canvas.fillRect(0,i,50,50);
    i++;
}

    windows.setInterval(animate(), 125);
}
window.addEventListener("load", drawStuff, false); 
```

为什么这不起作用？我是否误解了 setInterval 的作用？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:19:26.567

请将值设置为变量 i

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:22:47.560

有一个错字，您引用`windows`而不是`window`，并且提供的参数应该是对您要运行的函数的引用，所以它应该是`animate`而不是`animate()`立即调用 animate 函数。

这两个改变应该是：

```
window.setInterval(animate, 125); 
```

# javascript - Javascript 在 IE8 中不起作用

> ID：14344108
> 
> 赞同：2
> 
> 时间：2013-01-15T18:12:00.313
> 
> 标签：javascript, internet-explorer-8, toggle

以下 Javascript 在 IE8 中无法运行，但在 FF、Safari、IE9 和 Chrome 中运行良好。我承认自己是 Javascript 的菜鸟，我花了 2 天时间寻找没有运气的解决方案。IE8 不喜欢切换功能或隐藏。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<style type="text/css">
.hide {
    display: none;
}
</style>

<script type="text/javascript">
function toggleField(evt) {
            evt = (evt) ? evt : event;
            var target = (evt.target) ? evt.target : evt.srcElement;
            var block = document.getElementById("specialty");
            if (target.id == "fieldFlag1") {
                block.style.display = "block";
            } else {
                block.style.display = "none";
            }
        }
</script>

</head>

<body>

<div id="profession">       

             Field of professional work (as applicable):
            <select size="1" name="profession">
                <option>-- Choose One --</option>
                <option value="Architecture">Architecture</option>
                <option value="FineArts">Arts, Fine</option>
                <option value="PerformingArts">Arts, Performing</option>
                <option value="Business">Business</option>
                <option value="Consulting">Consulting</option>
                <option value="Counseling">Counseling</option>
                <option value="Dentistry">Dentistry</option>
                <option value="Education">Education</option>
                <option value="Engineering">Engineering</option>
                <option value="Environment">Environment</option>
                <option value="Finance">Finance</option>
                <option value="Government">Government</option>
                <option value="Healthcare—NonMedical">Healthcare&#8212;Non&#160;Medical</option>
                <option value="HigherEducation">Higher&#160;Education</option>
                <option value="InformationTechnology">Information&#160;Technology</option>
                <option value="Law">Law</option>
                <option value="Marketing">Marketing</option>
                <option value="Media/Communications">Media/Communications</option>
                <option value="Medicine">Medicine</option>
                <option value="Military">Military</option>
                <option value="Music">Music</option>
                <option value="NonProfit">Non&#160;Profit</option>
                <option value="Nursing" id="fieldFlag1" onclick="toggleField(event)">Nursing</option>
                <option value="PublicService">Public&#160;Service</option>
                <option value="Science/Research">Science/Research</option>
                <option value="SocialServices">Social&#160;Services</option>
                <option value="Sports">Sports</option>
                <option value="Trade/Craft">Trade/Craft</option>
              </select>
    </div>

  <div id="specialty" class="hide">
       Choose Specialty:
        <select name="Specialty" size="1">
<option value="nursing">Nursing</option>
<option value="nurse Practitioner Unspecified">Nurse‌·Practitioner‌·Unspecified</option>
<option value="nurse inactive">Nurse‌·Inactive</option>
<option value="womens health">Womens‌·Health</option>
<option value="administration">Administration</option>
<option value="hospital">Hospital</option>
<option value="critical care">Critical‌·Care</option>
<option value="home health">Home‌·Health</option>
<option value="surgical">Surgical</option>
<option value="clinical Research">Clinical‌·Research</option>
<option value="family health">Family‌·Health</option>
<option value="acute care nursing">Acute‌·Care‌·Nursing</option>
<option value="community Health Nursing">Community‌·Health‌·Nursing</option>
<option value="emergency nursing">Emergency‌·Nursing</option>
<option value="nurse practitioner: adult health">Nurse‌·Practitioner:‌·Adult‌·Health</option>
<option value="nurse practitioner: pediatrics">Nurse‌·Practitioner:‌·Pediatrics</option>
<option value="nurse practitioner: neonatal">Nurse‌·Practitioner:‌·Neonatal</option>
<option value="nurse practitioner: acute care">Nurse‌·Practitioner:‌·Acute‌·Care</option>
<option value="nurse practitioner: family">Nurse‌·Practitioner:‌·Family</option>
<option value="nurse practitioner: gerontology">Nurse‌·Practitioner:‌·Gerontology</option>
<option value="nurse practitioner: women's health">Nurse‌·Practitioner:‌·Women's‌·Health</option>

</select>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:23:23.263

在您的第一次选择更改

```
var e = document.getElementById("your First Select");
var valueOption= e.options[e.selectedIndex].value;
var block = document.getElementById("specialty");

if (valueOption == "Nursing")
      block.style.display = "block";
} else {
      block.style.display = "none";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:17:26.337

为了使您的代码在 IE8 中工作，您需要更改：

```
var target = (evt.target) ? evt.target : evt.srcElement; 
```

和：

```
var target = (evt.currentTarget) ? evt.currentTarget : event.srcElement; 
```

原因是 Internet Explorer 9.0 之前的版本不以标准方式处理事件。

每当触发一个事件时，一个名为的全局变量`event`在任何地方都可用。它被称为事件对象。

您可以查看此 URL 以获取更多详细信息：

[http://msdn.microsoft.com/en-us/library/ie/ms535863%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms535863%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:20:40.930

```
function toggleField(target) {            
            var block = document.getElementById("specialty");
            if (target.options[target.selectedIndex].value == "Nursing") {
                block.style.display = "block";
            } else {
                block.style.display = "none";
            }
        } 
```

并且在 HTML 中（而不是使用`onchange`事件`select`而不是`option`'s `onclick`）：

```
<select size="1" name="profession" onchange="toggleField(this)"> 
```

where`this`指向一个被改变的元素。只是为了不写所有这些

```
evt = (evt) ? evt : event;
var target = (evt.target) ? evt.target : evt.srcElement; 
```

`onclick`关于选项 - 我认为它根本不应该可用。

**UPD：** [这](https://stackoverflow.com/a/10058960/1558311)是一个答案，您可以在其中找到不支持 onclick 事件的浏览器列表`<option>`

# java - 将一个对象分配给其他对象的内存使用

> ID：14344113
> 
> 赞同：0
> 
> 时间：2013-01-15T18:12:14.330
> 
> 标签：java, memory

我有一个将 BufferedImage 作为其字段之一的类。如果我在创建 n 次我的类对象时使用相同的 BufferedImage 对象，它将与创建 n 个 BufferedImage 对象或仅一个对象相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:15:55.383

从技术上讲，您的对象具有对 BufferedImage的*引用。*它里面没有 BufferedImage，如果这个引用被复制 1000 倍或设置为 null 都没有关系，对象将使用相同的空间量并且 BufferedImage 也将是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:16:22.593

我将只是一个。它的引用将被复制到每个对象中，因此消耗将是 n * 引用指针的大小（即 32 位 JVM 为 32 位，64 位 JVM 为 64 位，尽管有些实现即使在 64 位 JVM 上也使用 32 位）。

# ruby-on-rails - 如何使用 gmaps4rails 中的两个不同标记区分当前位置和附近位置

> ID：14344115
> 
> 赞同：1
> 
> 时间：2013-01-15T18:12:14.300
> 
> 标签：ruby-on-rails, gmaps4rails

我正在使用 gmaps4rails 在我的应用程序中显示 gmaps.iam 获得正确的地图点但我无法区分我的地图中的当前位置和 nerby 位置。我的想法是对两个位置使用不同的标记我按照以下方式进行但它没有为我工作

**我的控制器**

```
def profile

   @googlemaplocation=Location.find_by_id("#{params[:clinic_id]}")

    @json1 = @googlemaplocation.to_gmaps4rails do |locations, marker|

  marker.picture({
                  :picture => "http://www.google.com/mapfiles/dd-start.png",
                  :width   => 32,
                  :height  => 32
                 })
  end

    @neargooglemaplocation=@googlemaplocation.nearbys(10)
    @json2= @neargooglemaplocation.to_gmaps4rails do |locations, marker|

  marker.picture({
                  :picture => "http://www.google.com/mapfiles/dd-start.png",
                  :width   => 32,
                  :height  => 32
                 })
  end

    @json = (JSON.parse(@json1) + JSON.parse(@json2)).to_json

  end 
```

**我的观点**

```
<%= gmaps(:markers => { :data => @json } ) %> 
```

如果我想在同一张地图上显示两个不同的标记怎么办

感谢和问候哈里·克里希纳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T14:12:01.237

正如apneadiving 所说，您可以使用不同的图像。例如 ：

```
def profile

   @googlemaplocation=Location.find_by_id("#{params[:clinic_id]}")

    @json1 = @googlemaplocation.to_gmaps4rails do |locations, marker|

  marker.picture({
                  :picture => "http://www.google.com/intl/en_us/mapfiles/ms/micons/red-dot.png",
                  :width   => 32,
                  :height  => 32
                 })
  end

    @neargooglemaplocation=@googlemaplocation.nearbys(10)
    @json2= @neargooglemaplocation.to_gmaps4rails do |locations, marker|

  marker.picture({
                  :picture => "http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png",
                  :width   => 32,
                  :height  => 32
                 })
  end

    @json = (JSON.parse(@json1) + JSON.parse(@json2)).to_json

  end 
```

顺便说一句：谢谢，我正在寻找一种在我的应用程序中为附近位置添加标记的方法:)

问候。

# mysql - mySQL 多列

> ID：14344119
> 
> 赞同：2
> 
> 时间：2013-01-15T18:12:37.527
> 
> 标签：mysql, sql

我正在寻找一个输出两个表的列的查询。我可能正在寻找加入，但如果我加入左表或右表，则可能不会返回值。我曾想过使用 UNION 关键字，但它会将列重命名为一个名称。然后不知道哪一栏有什么。

我希望我的查询选择两个表中的列，但不在乎任何一个表中是否存在与用户名匹配的内容，或者两者都不存在。我只是希望所有没有值的列都在那里。

```
SELECT *
FROM client_table
JOIN staff_table 
ON client_table.username = staff_table.username
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
OR staff_table " . mysql_real_escape_string($gotMyUser) . " LIMIT 1 
```

更新：

这是查询的输出

```
Array
(
//FIRST TABLE
[client_id] => 332058
[username] => jake
[firstname] => jake
[lastname] => ****
[email] => *****
[phone] => 
[phone_ext] => 
[mobile] => 
[department] => 
[is_active] => 1
[default_site] => 0
[google] => 

//SECOND TABLE
[staff_id] => 
[group_id] => 
[dept_id] => 
[passwd] => 
[signature] => 
[isactive] => 
[isadmin] => 
[isvisible] => 
[onvacation] => 
[daylight_saving] => 
[append_signature] => 
[change_passwd] => 
[timezone_offset] => 
[max_page_size] => 
[auto_refresh_rate] => 
[created] => 
[lastlogin] => 
[updated] => 
```

)

这正是我想要的，因为我想知道用户是否有员工 ID 或客户 ID，但取决于我执行的连接（左右或完整），它可能不会返回任何结果。我希望每次执行查询时结果都包含所有这些列，然后进行测试：

```
if($array['client_id']){
//do stuff with client
}

else if($array['staff_id']){
//do stuff with staff
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:18:11.150

正如 Julius Davies 所建议的那样，这个`FULL OUTER JOIN`概念正是您所需要的。但是，由于他们在 MySQL 中没有这些，因此您`LEFT JOIN`需要`UNION`使用`RIGHT JOIN`.

**示例**（请注意，它是在 2 个块中重复的相同查询，一个使用右外连接，另一个使用左外连接）：

```
SELECT *
FROM client_table
LEFT OUTER JOIN staff_table 
ON client_table.username = staff_table.username
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
OR staff_table " . mysql_real_escape_string($gotMyUser) . " 

UNION

SELECT *
FROM client_table
RIGHT OUTER JOIN staff_table 
ON client_table.username = staff_table.username
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
OR staff_table " . mysql_real_escape_string($gotMyUser) . " 
```

看到这个[问题](https://stackoverflow.com/questions/4796872/full-outer-join-in-mysql)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:53:23.203

我认为您想要一个`union all`，但您必须正确获取列名：

```
SELECT 'client_table' as table_name, 
       client_id, username, firstname, lastname,  email, phone, phone_ext,mobile,department,is_active,default_site, google,
       NULL as staff_id, NULL as group_id, NULL as dept_id, NULL as passwd, NULL as signature, NULL as isactive, NULL as isadmin, NULL as isvisible, NULL as onvacation, NULL as daylight_saving,
       NULL as append_signature, NULL as change_passwd, NULL as timezone_offset, NULL as max_page_size, NULL as auto_refresh_rate, NULL as created, NULL as lastlogin, NULL as updated
FROM client_table
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
UNION all
select 'staff_table' as table_name,
       NULL as client_id, NULL as username, NULL as firstname, NULL as lastname,  NULL as email,
       NULL as phone, NULL as phone_ext, NULL as mobile, NULL as department, NULL as is_active, NULL as default_site, NULL as google,
       staff_id, group_id, dept_id, passwd, signature, isactive, isadmin, isvisible, onvacation, daylight_saving,
       append_signature, change_passwd, timezone_offset, max_page_size, auto_refresh_rate, created, lastlogin, updated
from staff_table 
where staff_table.username = " . mysql_real_escape_string($gotMyUser) . " 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:15:30.050

尝试将“JOIN”更改为“FULL OUTER JOIN”

[http://en.wikipedia.org/wiki/Join_%28SQL%29#Full_outer_join](http://en.wikipedia.org/wiki/Join_%28SQL%29#Full_outer_join)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T18:17:53.433

试试这个，mysql没有做全外连接的选项，所以你可以做左右连接的联合

```
SELECT *
FROM client_table
LEFT OUTER JOIN staff_table 
ON client_table.username = staff_table.username
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
OR staff_table " . mysql_real_escape_string($gotMyUser) . "
UNION
SELECT *
FROM client_table
RIGHT OUTER JOIN staff_table 
ON client_table.username = staff_table.username
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
OR staff_table " . mysql_real_escape_string($gotMyUser) . " 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T18:21:55.200

我认为您要做的是知道记录来自哪个表。如果您发布一些示例数据和您期望的结果，将会有所帮助。

如果我是正确的，并假设 client_table 和 staff_table 具有相同的结构，您可以执行以下操作：

```
SELECT 'client_table' as table_name, client_table.*
FROM client_table
WHERE client_table.username = " . mysql_real_escape_string($gotMyUser) . " 
UNION
select 'staff_table' as table_name, staff_table.*
from staff_table 
where staff_table.username = " . mysql_real_escape_string($gotMyUser) . " 
```

通过添加 table_name，您可以知道数据的来源。

# c# - 将内容绑定到其他类的属性

> ID：14344121
> 
> 赞同：0
> 
> 时间：2013-01-15T18:12:56.797
> 
> 标签：c#, wpf

我正在尝试将`Content`简单标签的属性绑定到其他类的属性。我已经尝试了各种方法，但还没有奏效。

这是源类 (MainWindow.xaml.cs) 中的属性：

```
 public String FileTitle
    {
        get
        {
            return this.GetValue(FiletitleProperty) as string;
        }
        set
        {
            this.SetValue(FiletitleProperty, value);
        }
    }

    public DependencyProperty FiletitleProperty;

    public MainWindow()
    {           

        FiletitleProperty = DependencyProperty.Register("FileTitle", typeof(String), typeof(MainWindow));
        ...
    } 
```

在我的目标类中，我有一个名为源类的对象`CallbackObject`（命名不是很合适）

这是我的绑定 xaml 代码：

```
<Label x:Name="lblFiletitle" Content="{Binding Source=CallbackObject, Path=FileTitle}" Margin="10,213,10,0" Height="35" VerticalAlignment="Top" FontSize="16" Padding="0,5,5,5" /> 
```

甚至可以这样做，还是我必须让它变得更复杂和不优雅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:47:22.403

如果`CallbackObject`在尝试后面的代码中：

```
<Label Content="{Binding RelativeSource={RelativeSource AncestorLevel=1, AncestorType=UserControl,Mode=FindAncestor}, Path=CallbackObject.FileTitle}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:38:50.167

如果您的标签放置在 UserControl 或 Page 内，则您不能直接绑定到另一个对象（无论是 Window 还是其他）中的属性，除非在您的 - 比如说 - UserControl 中创建该对象的实例或引用。层次结构中的父元素（XAML 中的最顶层元素）定义子元素的 DataContext 范围。它们只能绑定到该范围内的事物。

有一些解决方法：

1.  您可以相对轻松地调用静态属性，然后调用像“{x:Static local:StaticClass.StaticProperty}”这样的绑定。

2.  您可以在 UserControl（在 XAML 中或在代码后面）中创建引用对象的实例，并将 UserControl 的 DataContext 设置为自身。引用的对象必须在具有公共 get 和 set（如果需要）访问器的公共属性中公开。如果您实现 INotifyPropertyChanged （无论您喜欢哪个），则不需要依赖属性。

3.  如果您想从不同的 Window 或不同的 ViewModel 获取数据，有很多方法可以做到。在这里发布太长（而且太“可用”），快速搜索会给你很多结果。

在你的情况下，我猜你的应用程序中只有一个 MainWindow，所以也许你可以创建一个静态属性来返回当前的 MainWindow 实例，然后从任何地方绑定到它的任何属性。

您的 MainWindow.xaml.cs 中的此代码

```
 private static MainWindow_instance;
    public static MainWindow Instance
    {
        get
        {
            if (_instance == null)
                _instance = new MainWindow();
            else
                _instance = this;

            return _instance;
        }
    } 
```

警告：这在某些情况下对我有用，但我从未将它用于 MainWindow，我不确定这是最佳实践。不过，它有效。

希望这会有所帮助，问候！

# android - 以编程方式添加的 tableRow 不在 TableLayout 中显示

> ID：14344124
> 
> 赞同：3
> 
> 时间：2013-01-15T18:13:07.060
> 
> 标签：android, tablelayout, tablerow

我在 xml 中创建了一个 TableLayout。现在我想在我的活动的 onCreate() 中以编程方式添加一个表格行。方法 fillTable 应该可以完成这项工作，但 TableRow 没有显示在表格中。

这是我的代码：

在活动中：

```
 public void fillTable() {
    t1 = (TableLayout) findViewById(R.id.tabelle);
    TableRow tr = new TableRow(this);
    tr.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.FILL_PARENT,
            TableRow.LayoutParams.FILL_PARENT));

    TextView rang = new TextView(this);
    TextView mannschaftsname = new TextView(this);
    TextView spiele = new TextView(this);
    TextView siege = new TextView(this);
    TextView unentschieden = new TextView(this);
    TextView niederlagen = new TextView(this);
    TextView tore = new TextView(this);
    TextView doppelpunkt = new TextView(this);
    TextView gegentore = new TextView(this);
    TextView differenz = new TextView(this);
    TextView punkte = new TextView(this);

    rang.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    rang.setGravity(Gravity.CENTER_HORIZONTAL);
    rang.setPadding(1, 1, 1, 1);
    rang.setText("0");
    rang.setTextColor(R.color.white);

    mannschaftsname.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    mannschaftsname.setGravity(Gravity.CENTER_HORIZONTAL);
    mannschaftsname.setPadding(1, 1, 1, 1);
    mannschaftsname.setText("TEST");
    mannschaftsname.setTextColor(R.color.white);

    spiele.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    spiele.setGravity(Gravity.CENTER_HORIZONTAL);
    spiele.setPadding(1, 1, 1, 1);
    spiele.setText("0");
    spiele.setTextColor(R.color.white);

    siege.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    siege.setGravity(Gravity.CENTER_HORIZONTAL);
    siege.setPadding(1, 1, 1, 1);
    siege.setText("0");
    siege.setTextColor(R.color.white);

    unentschieden.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    unentschieden.setGravity(Gravity.CENTER_HORIZONTAL);
    unentschieden.setPadding(1, 1, 1, 1);
    unentschieden.setText("0");
    unentschieden.setTextColor(R.color.white);

    niederlagen.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    niederlagen.setGravity(Gravity.CENTER_HORIZONTAL);
    niederlagen.setPadding(1, 1, 1, 1);
    niederlagen.setText("0");
    niederlagen.setTextColor(R.color.white);

    tore.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    tore.setGravity(Gravity.CENTER_HORIZONTAL);
    tore.setPadding(1, 1, 1, 1);
    tore.setText("0");
    tore.setTextColor(R.color.white);

    doppelpunkt.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    doppelpunkt.setGravity(Gravity.CENTER_HORIZONTAL);
    doppelpunkt.setPadding(1, 1, 1, 1);
    doppelpunkt.setText(":");
    doppelpunkt.setTextColor(R.color.white);

    gegentore.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    gegentore.setGravity(Gravity.CENTER_HORIZONTAL);
    gegentore.setPadding(1, 1, 1, 1);
    gegentore.setText("0");
    gegentore.setTextColor(R.color.white);

    differenz.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    differenz.setGravity(Gravity.CENTER_HORIZONTAL);
    differenz.setPadding(1, 1, 1, 1);
    differenz.setText("0");
    differenz.setTextColor(R.color.white);

    punkte.setLayoutParams(new TableRow.LayoutParams(
            TableRow.LayoutParams.WRAP_CONTENT,
            TableRow.LayoutParams.WRAP_CONTENT));
    punkte.setGravity(Gravity.CENTER_HORIZONTAL);
    punkte.setPadding(1, 1, 1, 1);
    punkte.setText("0");
    punkte.setTextColor(R.color.white);

    tr.addView(rang);
    tr.addView(mannschaftsname);
    tr.addView(spiele);
    tr.addView(siege);
    tr.addView(unentschieden);
    tr.addView(niederlagen);
    tr.addView(tore);
    tr.addView(doppelpunkt);
    tr.addView(gegentore);
    tr.addView(differenz);
    tr.addView(punkte);

    t1.addView(tr, new TableRow.LayoutParams(
            TableRow.LayoutParams.FILL_PARENT,
            TableRow.LayoutParams.WRAP_CONTENT));
} 
```

show_table.xml：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/tabelle"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/black"
android:stretchColumns="1" >

<TableRow
    android:id="@+id/tablle_tableRow1"
    android:gravity="center_horizontal" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_span="9"
        android:text="Liganame"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/white" />
</TableRow>

<TableRow
    android:id="@+id/tabelle_tableRow2"
    android:layout_margin="5dp"
    android:gravity="center_horizontal"
    android:padding="1dp" >

    <TextView
        android:id="@+id/textView_rang"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="right"
        android:padding="1dp"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_mannschaft"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_spiele"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="Sp."
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_siege"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="S"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_unentschieden"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="U"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_niederlagen"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="right"
        android:padding="1dp"
        android:text="N"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_tore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_span="3"
        android:gravity="right"
        android:padding="1dp"
        android:text="Tore"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_differenz"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="Diff."
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/textView_punkte"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="Pkt."
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/white" />
</TableRow>

<TableRow
    android:id="@+id/tabelle_tableRow3"
    android:gravity="center_horizontal" >

    <TextView
        android:id="@+id/rang"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:padding="1dp"
        android:text="0"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/mannschaft"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:padding="1dp"
        android:text="BBBBBBBBBB"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/spiele"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:padding="1dp"
        android:text="99"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/siege"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="99"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/unentschieden"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="99"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/niederlagen"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="99"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/tore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="999"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/doppelpunkt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text=":"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/gegentore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="999"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/differenz"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="999"
        android:textColor="@color/white" />

    <TextView
        android:id="@+id/punkte"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="right"
        android:padding="1dp"
        android:text="999"
        android:textColor="@color/white" />
</TableRow> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T07:51:25.250

```
 rang.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    mannschaftsname.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    spiele.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    siege.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    unentschieden.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    niederlagen.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    tore.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    doppelpunkt.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    gegentore.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    differenz.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT));
    punkte.setLayoutParams(new TableRow.LayoutParams(
        TableRow.LayoutParams.WRAP_CONTENT,
        TableRow.LayoutParams.WRAP_CONTENT)); 
```

删除上面提到的代码行，我在执行此操作时也遇到了问题，然后我删除了这些行和动态显示的表格......

这应该有效。

# c# - 如何使用正则表达式替换匹配项，前提是它前面没有给定字符？

> ID：14344129
> 
> 赞同：3
> 
> 时间：2013-01-15T18:13:16.873
> 
> 标签：c#, .net, regex

我有一个 foreach 语句，它正在搜索 a 中的字符串值`List<string>`。如果正在读取的当前行包含字符串，我想替换它，但有一些警告。

```
foreach (string shorthandValue in shorthandFound)
{
    if (currentLine.Contains(shorthandValue))
    {
        // This method creates the new string that will replace the old one.
        string replaceText = CreateReplaceString(shorthandValue);
        string pattern = @"(?<!_)" + shorthandValue;
        Regex.Replace(currentLine, pattern, replaceText);
        // currentline is the line being read by the StreamReader.
     }
} 
```

`shorthandValue`如果前面有下划线字符 ( `"_"`) ，我试图让系统忽略该字符串。否则，我希望它被替换（即使它位于行首）。

我做错了什么？

**更新**

这大部分工作正常：

```
Regex.Replace(currentFile, "[^_]" + Regex.Escape(shorthandValue), replaceText); 
```

但是，虽然它确实忽略了下划线，但它会删除 shorthandValue 字符串之前的任何空格。因此，如果行读取“这是一个 test123。”，并且“test123”被替换，我最终得到这个结果：

“这是一个快捷方式的价值。”

为什么要删除空间？

**再次更新**

我将正则表达式改回我的`(?<!_)`，它保留了空格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:23:25.167

你的正则表达式是正确的。问题是 Regex.Replace 返回一个新字符串。

您忽略了返回的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:21:45.593

您的正则表达式看起来是正确的，因为您修复了代码以实际保存字符串（[@jameskyburz](https://stackoverflow.com/a/14344301/7116)的帽子提示），因此您仍应确保将`shorthandValue`其视为文字。要完成此用途[`Regex.Escape`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)：

```
var pattern = String.Format(@"(?<!_){0}", Regex.Escape(shorthandValue)) 
```

# c - 将char数组转换为字符串使用C

> ID：14344130
> 
> 赞同：11
> 
> 时间：2013-01-15T18:13:17.577
> 
> 标签：c, arrays

我需要将 char 数组转换为字符串。像这样的东西：

```
char array[20];
char string[100];

array[0]='1';
array[1]='7';
array[2]='8';
array[3]='.';
array[4]='9';
... 
```

我想得到类似的东西：

```
char string[0]= array // where it was stored 178.9 ....in position [0] 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-15T18:19:53.467

你说你有这个：

```
char array[20]; char string[100];
array[0]='1'; 
array[1]='7'; 
array[2]='8'; 
array[3]='.'; 
array[4]='9'; 
```

你想要这个：

```
string[0]= "178.9"; // where it was stored 178.9 ....in position [0] 
```

你不能这样。一个 char 包含 1 个字符。就是这样。C 中的“字符串”是一个字符数组，后跟一个标记字符（NULL 终止符）。

现在，如果您想复制前 x 个字符，`array`您`string`可以使用`memcpy()`：

```
memcpy(string, array, x);
string[x] = '\0'; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T18:16:33.667

假设`array`是一个不以 结尾的字符数组`\0`，您将要使用`strncpy`：

```
char * strncpy(char * destination, const char * source, size_t num); 
```

像这样：

```
strncpy(string, array, 20);
string[20] = '\0' 
```

然后`string`将是一个空终止的 C 字符串，根据需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T18:18:33.620

您可以使用`strcpy`，但请记住以`'\0'`

```
char array[20]; char string[100];

array[0]='1'; array[1]='7'; array[2]='8'; array[3]='.'; array[4]='9'; array[5]='\0';
strcpy(string, array);
printf("%s\n", string); 
```

# cakephp - 计算每种产品的订购次数

> ID：14344133
> 
> 赞同：1
> 
> 时间：2013-01-15T18:13:20.273
> 
> 标签：cakephp, cakephp-2.1

数据库中的每个`Order`都有一个`product_id`. `Product`每个订单只有一个。

从 中`ProductsController`，我想显示所有产品，并在每个产品旁边显示订购了多少次。我将需要包含一个条件以排除任何具有`deleted = 0`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T08:27:19.690

我也会使用[counterCache](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#countercache-cache-your-count)

将 order_count 字段添加到您的 Product 表并修改 Order 模型

```
class Order extends AppModel {
    public $belongsTo = array(
        'Product' => array(
            'counterCache' => true,
            'counterScope' => array('Product.deleted' => 0)
        )
    );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T23:32:23.597

此查询应返回您需要的结果。根据需要调整条件、附加字段等。

```
$data = $this->Order->find('all',array( 
   'fields'=>array(
       'COUNT(Product.id)as Count',
       'Product.id','Product.name'
   ), 
   'group'=>array(
       'Product.id'
   ), 
   'contain'=>'Product' 
)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:28:28.277

一个简单`find('count')`的就足够了（此查找操作的详细信息在[Cookbook](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#find-count)中）：

```
// Get a list of all the active products
$products = $this->Product->find('list', array(
    'conditions' => array('Product.deleted' => 0)
));

// Loop over the products
foreach($products as $product_id => $product) {
    $count = $this->Product->Order->find('count', array(
        'conditions' => array('Order.product_id' => $product_id)
    ));
    echo "There were " . $count . " orders for " . $product;
} 
```

正如 Mark 所建议的那样， a`GROUP BY`也应该做到这一点，并通过仅使用一个 find 来简化过程。

```
$count = $this->Product->Order->find('count', array(
    'conditions' => array(
        'Order.product_id' => $product_id,
        'Product.deleted' => 0
    ),
    'group' => array('Order.product_id')
)); 
```

# asp.net-mvc - Visual Studio 2012 错误“无法写入输出文件 '....some.dll'

> ID：14344136
> 
> 赞同：1
> 
> 时间：2013-01-15T18:13:33.923
> 
> 标签：asp.net-mvc, visual-studio, iis-express

在调试我的 MVC4 应用程序时，使用 Visual Studio 2012 中的本地 IIS Express，每次我得到

```
Description:
Could not write to output file '...\obj\Debug\some...dll'
The process cannot access the file because it is being used by another process

File: CSC 
```

我总是必须从系统托盘关闭/杀死 IIS - 然后它会构建并运行。

这太烦人了——这个问题有没有好的解决方案？

我看了[http://www.csharp411.com/run-asp-net-and-iis-on-windows-vista-and-7-home-premium/](http://www.csharp411.com/run-asp-net-and-iis-on-windows-vista-and-7-home-premium/)指的是 IIS 和 inetmgr.exe - 我找不到对于 IIS-Express！

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T12:27:21.843

不确定是否是同一个问题，但可能与此问题有关： [Visual Studio 无法写入输出文件'...\obj\Debug\Foo.Bar.dll"](https://stackoverflow.com/questions/12301625/visual-studio-2010-could-not-write-to-output-file-obj-debug-foo-bar-dll)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:19:37.117

在 Windows 上，您不能打开已经在其他地方打开以供读取的文件进行写入（除非先前打开文件的程序特别允许 - 内核不会对正在运行的文件执行此操作）。但是，您可以重命名正在使用的文件，因此您可以将以下内容添加为 MSVC 中的预构建事件：

```
ren ...\obj\Debug\some...dll ...\obj\Debug\some...dll.bak 
```

根据需要替换路径。不确定你的 IIS 是否会接受它。

# scala - spring-data-neo4j - 创建名称为“neo4jTemplate”的 bean 时出错

> ID：14344142
> 
> 赞同：0
> 
> 时间：2013-01-15T18:13:54.260
> 
> 标签：scala, neo4j, spring-data-neo4j

我正在尝试将 neo4j 与 spring-data 和 scala 一起使用，但我遇到了这个异常：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'neo4jTemplate': Invocation of init method failed; nested exception is java.lang.NoSuchMethodError:scala.collection.JavaConverters$.mapAsScalaMapConverter(Ljava/util/Map;)Lscala/collection/JavaConverters$AsScala; 
```

目前，我不确定如何“注入”JavaConverters ...

有任何想法吗？

更新：

我试图简单地将导入放在 Test 类中：

导入 scala.collection.JavaConverters._

但是没用，完整代码如下：

WordsTest.scala

```
package com.dimeder.llull.security

import org.junit.runner.RunWith
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner
import org.springframework.test.context.ContextConfiguration
import org.junit.Test
import org.slf4j.LoggerFactory
import org.springframework.transaction.annotation.Transactional
import org.springframework.beans.factory.annotation.Autowired
import org.springframework.data.neo4j.support.Neo4jTemplate
import com.dimeder.llull.models.Word
import scala.collection.JavaConverters._

@RunWith(classOf[SpringJUnit4ClassRunner])
@ContextConfiguration(Array("classpath:applicationContext-test.xml"))
class WordsTest {
         val logger = LoggerFactory.getLogger(classOf[WordsTest])

  @Autowired
  var template:Neo4jTemplate = _

  @Test
  @Transactional
  def speak(){
      val word:Word = new Word
    word.text="sustancia"
    template.save(word)
    val backWord:Word = template.findOne(word.id,classOf[Word])
    logger.info(word.text.equalsIgnoreCase(backWord.text).toString)
  }
} 
```

applicationContext-test.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:oxm="http://www.springframework.org/schema/oxm"
       xmlns:jaxws="http://cxf.apache.org/jaxws"
       xmlns:http-conf="http://cxf.apache.org/transports/http/configuration"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:task="http://www.springframework.org/schema/task"
       xmlns:neo4j="http://www.springframework.org/schema/data/neo4j"

       xsi:schemaLocation="http://www.springframework.org/schema/mvc
         http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
         http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context-3.0.xsd
         http://www.springframework.org/schema/util
         http://www.springframework.org/schema/util/spring-util-3.0.xsd
         http://www.springframework.org/schema/aop
         http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
         http://www.springframework.org/schema/task
         http://www.springframework.org/schema/task/spring-task-3.0.xsd
         http://www.springframework.org/schema/data/neo4j
         http://www.springframework.org/schema/data/neo4j/spring-neo4j-2.0.xsd
        ">

    <context:spring-configured/>
    <context:annotation-config/>

    <mvc:annotation-driven/>
    <context:component-scan base-package="java.llull."/>

    <neo4j:config storeDirectory="data/graph.db"/>
    <neo4j:repositories base-package="java.llull.repositories"/>

</beans> 
```

**更新：**

我解决了！

问题是 scala 版本，我使用的是 2.10，但它必须是 2.9.2

# jsf-2 - 未输入时，货币转换器可以忽略 $ 符号吗

> ID：14344144
> 
> 赞同：3
> 
> 时间：2013-01-15T18:14:02.050
> 
> 标签：jsf-2, primefaces, converter

在数据表中，我必须将输入验证为货币。当我删除 $ 符号后输入值时，输入组件会抛出错误。

```
 <p:column>
        <f:facet name="header">
            <p:outputLabel value="REC REVENUE" />
        </f:facet>
        <p:inputText id="RERVN" styleClass="RERVN"
       value="#{segmentSetup.userSegmentTypesMap['RERVN'].segmentValues[rank].rangeMinValue}"
   disabled="#{!segmentSetup.userSegmentTypesMap['RERVN'].selected  ||    (rank==fn:length(segmentSetup.ranks)) }"
validator="#{segmentSetup.validateRanges}">
            <f:convertNumber maxFractionDigits="2" minFractionDigits="0" currencySymbol="$" type="currency" />
        </p:inputText>
        <p:message for="RERVN" />
    </p:column> 
```

当我输入一个不带美元符号的值时，我会收到此验证错误。

### tabView:segmentRangeTable:0:GRRVN: '45' 无法理解为货币值。示例：99.99 美元

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:31:29.037

将`$`输入与输入分开并使用普通数字转换器。

```
$<p:inputText ...>
    <f:convertNumber maxFractionDigits="2" minFractionDigits="0" />
</p:inputText> 
```

如有必要，您可以使用 CSS 将 $ 视觉重新定位到输入元素中。这是一个纯 HTML/CSS 的启动示例：

```
<div class="currency"><span>$</span><input /></div> 
```

和

```
.currency span { position: absolute; margin: 5px 2px; }
.currency input { padding-left: 5px; } 
```

# objective-c - Xcode setDateFormat：错误的年份

> ID：14344147
> 
> 赞同：0
> 
> 时间：2013-01-15T18:14:13.763
> 
> 标签：objective-c, nsdateformatter, date-format, ekevent

我通过使用 EKEvent 通过我的应用程序将事件添加到日历中发现了这个问题。

由于我没有找到任何资源，我想知道您是否听说过。

我有一个旧应用程序（开发的 IOS 5）以这种日期格式成功使用了 EKEvent

**@"yyyy/MM/dd:HH:mm"**

现在我必须实现一个新应用程序，并且我尝试使用旧代码，但我发现通过使用该日期格式，我的应用程序在 2014 年注册了该事件！日期是正确的，但显然不是年份。

我通过将日期格式更改为

**@"dd.MM.yyyy HH:mm"**

你知道为什么吗？？你有想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:22:03.527

当您使用大 Y 符号“Y”时，通常会发生此错误，而小“y”是正确的。您确定在代码中使用了小“y”吗？

小“y”是正确的，请再次检查。

# java - 如何在java中创建现有对象的数据类型列表

> ID：14344154
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:14:31.093
> 
> 标签：java, generics, object, types

好吧，这个问题说明了一切。这是我想要的一个例子

```
String s = new String();
List<s.type> ls = new ArrayList<s.type>(); 
```

类似的东西，或任何优雅的方式来实现这一点，请不要使用多个 if 条件或条件逻辑，因为可能存在无限的数据类型，我在这里仅使用字符串作为示例，它可以是任何东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:36:22.767

如果您想获取 s 的运行时类型并在泛型中使用它，这是不可能的。Java 中的泛型仅在编译时用于类型检查和类型推断。`List<String>`泛型的信息在运行时被擦除，所以运行时无法分辨和之间的区别`List<Integer>`。

如果你只是想用 s 的编译时已知类型创建一个泛型，那么它没有意义，因为你已经知道 s 的类型并且你可以为它写一个类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:48:09.687

如果我理解正确，您想知道运行时（*现有*）中实例（*对象）的类（**类型*） ，但正如 Petr 解释的那样，这与泛型无关。

 **```
public class Types {    
 public static void main(String[] args) {
     String s = "";
     Runtime r = Runtime.getRuntime();
     Types t = new Types();

     List<Class> types = new LinkedList<Class>();         
     types.add(Integer.class);
     types.add(t.getClass());
     types.add(r.getClass());
     types.add(s.getClass());

     for (Class type :types) {
         System.out.println(type.getSimpleName());
     }         
 }    
} 
```

输出：

```
Integer
Types
Runtime
String 
```

但是，很少需要这种方法，因此请重新考虑是否有更简单的解决方案来解决您的问题。如果你仍然想这样处理它：

*   [什么是反射，它为什么有用？](https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful)
*   [官方教程](http://docs.oracle.com/javase/tutorial/reflect/index.html)

编辑：

您的问题的另一种解释导致动态通用列表作为答案：

```
public static <T> List<T> createListOfType() {
    return new ArrayList<T>();
}

public static void main(String[] args) {
    List<String> a = createListOfType();    
    List<Integer> b = createListOfType();
    a.add("");
    b.add(2);
    a.add(2); // remove this line to compile
    b.add(""); // remove this line to compile       
} 
```**

# actionscript-3 - AS3 如何让 URLRequest 以设定的时间间隔重复操作

> ID：14344157
> 
> 赞同：1
> 
> 时间：2013-01-15T18:14:50.317
> 
> 标签：actionscript-3, air, flash-cs5

我正在运行下面的 AS3 以将“.txt”文件加载到内置于 Flash CS5 中的 Adob​​e Air 桌面应用程序留言板。我设置了一个计时器来运行并重复该过程，基本上是再次运行代码并触发 NotificationType.Critical。即使没有加载新文件。

如何使 URLRequest 重复，假设每 120000 毫秒查找新文件？如果文件是新的，则加载文件并通知用户，如果文件不是新的，则忽略？

```
var loader:URLLoader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(event:Event):void {
    var loadedText:URLLoader = URLLoader(event.target);
    if(myText_txt.htmlText!=loadedText.data){
        myText_txt.htmlText = loadedText.data;
        mainWindow.notifyUser(NotificationType.CRITICAL) 
    } else {
        //do nothing
    }
} 
```

感谢 AS3 的新手

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T18:33:20.100

```
var myInterval:uint  = setInterval (loadUrl, 120000);
var loader:URLLoader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(event:Event):void {
  var loadedText:URLLoader = URLLoader(event.target);
    if(myText_txt.htmlText!=loadedText.data){
       myText_txt.htmlText = loadedText.data;
       mainWindow.notifyUser(NotificationType.CRITICAL) 
    }else {
      //do nothing
    }
}

function loadUrl():void {
        loader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);
} 
```

# python - Python中CWD和导入搜索路径的区别？

> ID：14344159
> 
> 赞同：1
> 
> 时间：2013-01-15T18:15:02.440
> 
> 标签：python, path, cwd

我对Python中CWD和导入路径之间的区别有点困惑。

据我了解：

```
C:\temp> python C:\...\PyTools\ex.py 
```

脚本文件位于 C:...\PP4E\Tools\ 中，但脚本处理位于 C:\temp 中的文件？还是我误会了什么？

基本上我有一个从某个目录运行的脚本，我需要它来处理另一个目录中的文件。

```
C:\temp> python C:\...\PyTools\find.py *.py C:\...\Directory 
```

再次据我了解，该脚本可以访问 PyTools 目录中的文件并处理 \Directory 中的文件。但是 CWD 仍然是 \temp?

那么 \temp 是否添加到 python 路径中？CWD 是否曾经被添加到 python 路径中？我有点困惑，如果有人可以向我解释这一点，我将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:47:25.633

Python 的搜索路径——它在其中查找以`import`语句命名的模块——包括`PYTHONPATH`环境变量的内容、 的值`sys.path`以及运行脚本所在的目录。默认情况下，您当前的工作目录 ( `cwd`) 绝不是 Python 搜索路径的一部分。

当你`cwd`开始你的 Python 脚本时，你的脚本就是`cwd`你的；这意味着文件操作，例如`open()`，将引用您当前目录中的文件，而没有任何路径限定符。例如，如果您在 中`c:\temp`，并且您运行 Python 脚本，并且您的脚本执行此操作...

```
fd = open('myfile.txt') 
```

...然后你会打开`c:\temp\myfile.txt`。

如果要打开另一个目录中的文件，可以提供以下路径的完整路径`open`：

```
fd = open('c:\\anotherdir\\myfile.txt') 
```

或者你可以调用`os.chdir()`你的代码：

```
os.chdir('c:\\anotherdir')
fd = open('myfile.txt') 
```

# c# - Windows RT 应用程序中的图像闪烁

> ID：14344161
> 
> 赞同：2
> 
> 时间：2013-01-15T18:15:06.213
> 
> 标签：c#, .net, windows-8, windows-runtime, winrt-xaml

我有一个 Windows RT 应用程序，我在其中以编程方式更改`Image`组件中的位图。`XAML`除了我们在图像更改时看到的闪烁之外，一切都适用于下面的代码。

我应该改变什么来摆脱闪烁？

`XAML`：

```
<Page
x:Class="iSurfBrainViewProto01.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:iSurfBrainViewProto01"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d">
<Grid HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0">
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="8*"/>
        <ColumnDefinition Width="1*"/>
        <ColumnDefinition Width="4*" />
    </Grid.ColumnDefinitions>
    <Grid HorizontalAlignment="Center" VerticalAlignment="Top"
                                                         Margin="20,20,0,20">
        <Grid.RowDefinitions>
            <RowDefinition Height="8*"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid HorizontalAlignment="Left" Height="768" 
              VerticalAlignment="Top" Width="768">
            <Image x:Name="image1" Source="BrainImg/axis/ax-128.jpg"/>
            <Image x:Name="image2" Source="BrainImg/axis/ax-128.png"/>
        </Grid>
        <Slider HorizontalAlignment="Left" VerticalAlignment="Top" 
               Width="768" Grid.Row="1" Maximum="255" Value="128" 
               x:Name="slider1"  ValueChanged="Slider_ValueChanged_1"/>
    </Grid>
    <Grid HorizontalAlignment="Left" VerticalAlignment="Top" 
                        Grid.Column="1" Margin="0,10"  MinHeight="768">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Button HorizontalAlignment="Left" VerticalAlignment="Top" Width="85" 
          Height="100" BorderThickness="0">
            <Image Source="ax-1.jpg" />
        </Button>
        <Button HorizontalAlignment="Center" VerticalAlignment="Top" 
             Grid.Row="1" Width="85" Height="100" BorderThickness="0">
            <Image Source="ax-2.jpg" />
        </Button>
        <Button HorizontalAlignment="Right" VerticalAlignment="Top" 
             Grid.Row="2" Width="85" Height="100" BorderThickness="0">
            <Image Source="ax-3.jpg" />
        </Button>
        <Button HorizontalAlignment="Left" VerticalAlignment="Top" 
             Grid.Row="3" Width="85" Height="100" BorderThickness="0">
            <Image Source="ax-4.jpg" />
        </Button>
        <Button HorizontalAlignment="Center" VerticalAlignment="Top" 
             Grid.Row="4" Width="85" Height="100" BorderThickness="0">
            <Image Source="ax-5.jpg" />
        </Button>
        <Button HorizontalAlignment="Right" VerticalAlignment="Top" 
             Grid.Row="5" Width="85" Height="100" BorderThickness="0">
            <Image Source="ax-6.jpg" />
        </Button>
    </Grid>
    <Grid HorizontalAlignment="Left" VerticalAlignment="Top" 
         Grid.Column="2" Margin="10,10,0,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="1*" />
            <RowDefinition Height="7*"/>
        </Grid.RowDefinitions>
        <TextBlock Text="Structure Selected: This Struct" 
         HorizontalAlignment="Left" MinHeight="50" FontSize="26" />
        <WebView Source="http://www.mywebsite.com" 
         HorizontalAlignment="Left" 
         Grid.Row="1" MinWidth ="500" MinHeight="760" />
    </Grid>
</Grid>
</Page> 
```

代码：

```
namespace Test01
{
public sealed partial class MainPage : Page
{
    int currentSlice = 128;
    String axis = "ax-";
    public MainPage()
    {
        this.InitializeComponent();
    }

    public void displayImages()
    {
        BitmapImage bitmapImage = image1.Source as BitmapImage;
        bitmapImage.UriSource = null;
        image1.Source = null;

        BitmapImage bitmapImage2 = image2.Source as BitmapImage;
        bitmapImage2.UriSource = null;
        image2.Source = null;
        Uri image1Uri = new Uri(this.BaseUri,
           "BrainImg/axis/" + axis + currentSlice + ".jpg");
        image1.Source = new BitmapImage(image1Uri);
        image2.Source = new BitmapImage(new Uri(this.BaseUri,
           "BrainImg/aseg/" + axis + currentSlice + ".png"));
    }

    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
    }

    private void Slider_ValueChanged_1(object sender, 
                               RangeBaseValueChangedEventArgs e)
    {
        if (slider1 != null) {
            currentSlice = (int) slider1.Value;
            displayImages();
        }
    }
 }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T12:08:49.833

我找到了解决方案。

```
IRandomAccessStream stream = await storageFile.OpenAsync(FileAccessMode.Read);
BitmapImage bitmapImage = new BitmapImage();

if (await bitmapImage.SetSourceAsync(stream))
{
    image1.source = bitmapImage;
} 
```

这样就没有闪烁了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:36:20.507

我看到的第一件事是，您在将图像源设置为新值之前不必要地将其设置为 null，尽管实际上这可能无关紧要。问题是下载/解码图像需要一些时间。因此，您应该在开始使用它们之前预加载所有图像（这可能会占用太多内存，因此不可行），或者使用两个图像控件代替一个，并将它们用作一种交换链，其中您有一个可见图像和一个隐藏的，当您想要切换显示的图像时 - 更新隐藏图像的源，并且仅在加载位图后切换图像的可见性。这可能并不简单，因为在托管图像控件可见之前 BitmapImage 可能不会开始加载，因此您可能需要将不透明度设置为 0。01 而不是完全隐藏它或尝试使其可见然后立即不可见，直到加载位图。如果位图已加载 - 它的 PixelWidth 将 > 0。

# c - 当客户端断开连接时 C 服务器停止响应

> ID：14344162
> 
> 赞同：0
> 
> 时间：2013-01-15T18:15:06.820
> 
> 标签：c, sockets, pthreads

我使用 pthreads 编写了一个相当简单的 C 聊天服务器。服务器正常工作，客户端使用 telnet 连接到它，然后客户端可以相互通信。每个客户端都在自己的线程中启动。当任何客户端想要断开连接时，就会出现问题。即使我关闭客户端套接字并完成它的线程（它确实如此，或者至少 gdb 是这样说的），这种干扰以某种方式关闭了服务器端的所有通信，即使其他线程仍在运行。在此之后，客户端无法相互通信，从而使服务器变得毫无用处。我不知道如何解决这个问题，我请求你的帮助。谢谢你。

这是我的代码。我包含完整代码，因为我不确定我的错误在哪里

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h> 
#include <string.h> 
#include <errno.h>  
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <pthread.h>

int user[30];     // sockets of connected users
char names[30][20];
int user_count=0; // number of active connections
int listen_sock;  // main socket, recieves connections
char buffer[500];
pthread_t *thready[30];
pthread_mutex_t mutex;

struct arg_struct {
    int arg1;
    int arg2;
};

void sending(char *text, int i) {
  char buffer2[504];
  strcpy(buffer2, "\r\0");
  strcat(buffer2, text);
  strcat(buffer2, "\r\0");
  write(user[i], buffer2, strlen(buffer2));
}

void welcome(int id) {
  int len;
  int sock;
  char name[20];
  pthread_mutex_lock(&mutex);
  sock = user[id];

  write(sock,"\rEnter your name: ", 18);
  // Read returns number of characters recieved
  len = read(sock,name,20);
  // Add zero to the end of string (read doesnt do it)
  name[len]='\0';

  while (name[len] < 32) 
  { 
    name[len]='\0';
    len--;
  }

//  snprintf(buffer,"Welcome %s!\n",name);
  write(sock, "Welcome\r\n", 7);
  strcpy(names[id], name);
  sending(buffer,id);
  pthread_mutex_unlock(&mutex);
}

void echo(char *text) {
  int i; 
  for (i=0; i<user_count; i++) {
    sending(text, i);
  }
}

void disconnect(int id) {
  int i;
  char deadname[20];

  strcpy(deadname,names[id]);
  sending("You have been disconnected\n",id);
  shutdown(user[id], SHUT_RDWR);
  close(user[id]);
  for (i=id; i<user_count-1; i++) { 
    user[i]=user[i+1];
    strcpy(names[i],names[i+1]);
  }
  user_count--;
  sprintf(buffer,"%s has disconnected\n",deadname);
  echo(buffer);
}

void finish() {
  echo("Shuting down, disconnecting everyone!\n");
  while (user_count > 0) disconnect(user_count-1);
  shutdown(listen_sock, SHUT_RDWR);
  close(listen_sock);
  pthread_mutex_destroy(&mutex);
  exit(0);
}

void getcomm(char *inpstr, char *comm) { /* First letter from inpstr goes to comm,
                                            and is removed from inpstr */
  int wpos=0,leng;                      /* Splits first word from the rest of the sentence */
  char *zal;

  zal=inpstr;
  leng=strlen(zal);

  while (*inpstr>32 && wpos<14) {
    *comm=*inpstr++;
    comm++;
    wpos++;
  }
  inpstr=(char *)memmove(zal,inpstr+1,leng);
  *comm='\0';
}

void input(int id) {

}

void* communication(void* par){
    int sock = ((int*)par)[0];
    int id = ((int*)par)[1];
    free((int*)par);
    welcome(id);
    while(1){
      char line[500];
      char command[20];
      char name2[16];
      int len,sock;

      // 1\. read line from user
      len=read(user[id],line,499);
      pthread_mutex_lock(&mutex);
      line[len]='\0';
      if (len == 0) {  // User has terminated the connection
        continue;
      }

      while (line[len] < 32) { // Remove special chars
        line[len]='\0';
        len--;
      }

      // 2\. Get first word
      getcomm(line,command);

      // 3\. Recognise command and execute it
      len=strlen(command);
      if (strncmp(command,"quit",4) == 0) {
        disconnect(id);
        pthread_exit(NULL);
      }
      else if (!strncmp(command,"tell",len)) {
        getcomm(line,name2);
        sprintf(buffer,"%s tells %s: %s\n", names[id], name2, line);
        echo(buffer);
      }
      else if (!strncmp(command,"shut",len)) {
        finish();
      }
      // 4\. Unknown command
      else {
        sprintf(buffer,"%s tells %s %s\n", names[id], command, line);
        echo(buffer);
      }
      pthread_mutex_unlock(&mutex);
    }
}

int main( int argc, char *argv[] ) {
  int pid;
  struct sockaddr_in bind_addr;
  struct sockaddr_in acc_addr;
  int size, user_id, i, sel,on;
  int port_number;
  char * eptr = NULL;
  fd_set readmask;
  pthread_mutexattr_t attr;
  pthread_mutexattr_init(&attr);
  pthread_mutex_init(&mutex, NULL);

  listen_sock = socket(AF_INET, SOCK_STREAM, 0);
  if (listen_sock==-1) {
    perror("socket()");
    pthread_mutex_destroy(&mutex);
    exit(-1);
  }
  on = 1;
  if (argc == 1){
    perror("Please specify port number");
    pthread_mutex_destroy(&mutex);
    //exit(0);
  } 
  if (argc == 2){
    port_number = (int) strtol(argv[1], &eptr, 10);
    if (*eptr != '\0'){
      perror("Invalid Port Number!");
        pthread_mutex_destroy(&mutex);
      exit(-1);
    }
  }
  port_number = 7501;

  bind_addr.sin_family = AF_INET;
  bind_addr.sin_addr.s_addr = INADDR_ANY;
  bind_addr.sin_port = htons(port_number);
  size=sizeof(struct sockaddr_in);
  setsockopt(listen_sock, SOL_SOCKET, SO_REUSEADDR, (char *)&on, sizeof(on));

  if (bind(listen_sock, (struct sockaddr *)&bind_addr, size)==-1) {
    perror("bind()");
    pthread_mutex_destroy(&mutex);
    exit(-1);
  }

  listen(listen_sock, 10);

  while(1) {
      FD_ZERO(&readmask);
      FD_SET(listen_sock, &readmask);
      if (FD_ISSET(listen_sock, &readmask)) {
          user_id = user_count++;
          int * soc = (int*)malloc(2*sizeof(int));

          soc[0] = accept(listen_sock,(struct sockaddr *)&acc_addr, &size);
          soc[1] = user_id;
          pthread_mutex_lock(&mutex);
          user[user_id] = soc[0];

          pthread_mutex_unlock(&mutex);

          if( ( pthread_create( &thready[user_id], NULL, communication, (void*)soc ) ) < 0)
                {
                    perror("could not create thread");
                    return 1;
                } 
            echo(buffer);
          continue;
    }
  }

  pthread_mutex_destroy(&mutex);
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:39:49.943

在调用 pthread_exit() 之前，您似乎没有解锁互斥锁。这应该会阻塞所有其他通信线程。

另外，您是否错过了 FD_SET() 之后的 select() 调用？

# ruby-on-rails-3 - 删除 has_man 的关联：通过

> ID：14344163
> 
> 赞同：1
> 
> 时间：2013-01-15T18:15:10.433
> 
> 标签：ruby-on-rails-3

在 has_many :through 关系中，是否有一种简单的方法可以删除关联？

如果我有模型：

交易.rb

```
class Deal < ActiveRecord::Base
  has_many :deal_events
  has_many :events, :through => :deal_events
end 
```

事件.rb

```
class Event < ActiveRecord::Base
  has_many :deal_events
  has_many :deals, :through => :deal_events
end 
```

交易事件.rb

```
class DealEvent < ActiveRecord::Base
  belongs_to :deal
  belongs_to :event
end 
```

在控制台中：

```
deal = Deal.first
event = Event.first
deal.events << event 
```

我知道如果我想破坏交易和事件的关联，我知道我可以调用

```
deal.events.destroy(event)
event.deals.destroy(deal) 
```

但是 deal.deal_events 和 event.deal_events 仍然包含 deal_event.. 是否有更简洁的方法来执行此操作并完全删除关系并让事件保留在 Event.all 中，而交易保留在 Deal.all 中？谢谢

## 更新

Rails 控制台愚弄了我..

在我这样做之后

```
deals.events << event 
```

Rails 没有输入查询，因为 event.deal_events 的查询已经执行，所以这个..

```
1.9.3-p327 :020 > event.deal_events
 => [] 
```

正在发生，但是当我退出并再次进入 rails 控制台时，查询被执行..

```
1.9.3-p327 :001 > event.deal_events
  DealEvent Load (0.9ms)  SELECT "deal_events".* FROM "deal_events" WHERE "deal_events"."event_id" = 1
 => [#<DealEvent id: 2, deal_id: 1, event_id: 1, created_at: "2013-01-15 21:37:24", updated_at: "2013-01-15 21:37:24">, #<DealEvent id: 3, deal_id: 1, event_id: 1, created_at: "2013-01-15 21:37:38", updated_at: "2013-01-15 21:37:38">] 
```

我会将@ChapleyWatson 标记为答案，因为它为我指明了正确的方向

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:57:46.473

在您的父模型中

```
before_destroy :clear_my_association

# model stuff

private

  def clear_my_association

    self.my_association_model.clear

  end 
```

# java - 使用 java 集合的报告

> ID：14344166
> 
> 赞同：0
> 
> 时间：2013-01-15T18:15:28.460
> 
> 标签：java, collections, report

我正在尝试创建一份每日报告，该报告应显示用户每天创建的任务。

它应该像这样显示

```
 01 jan   02 jan 03 jan ..... total

 user1   3        5     10           18
 user2   5        6      9           20
 .
 .
 .
 total   8        11     19          38

I have got my sql query written which returns me list of records

select count(fe.id) , u.username as username, Date(fe.created_at) as createdAt 
from tasks t inner join users u on t.user_id = u.id
group by createdAt,username 
```

它返回我的数据，如

```
 3   Mark    2012-10-01
    2   John    2012-10-02
    3   Sam     2012-10-02
    1   Gary    2012-10-03
    1   John    2012-10-03
    3   harry   2012-10-03
    4   Sam     2012-10-03
    1   John    2012-10-04
    7   Gary    2012-10-04
    4   Sam     2012-10-04 
```

我将这些记录作为列表获取。那么在上述报告中显示它们的最佳方式是什么。这些数据是否足以在上述报告表单中显示并将列表分为用户或日期。或者，如果我们有任何工具可用于显示此类报告。

请让我知道是否需要其他任何内容。

# javascript - 使用 JSP 或 javascript 自定义谷歌浏览器中文本框的自动填充

> ID：14344169
> 
> 赞同：0
> 
> 时间：2013-01-15T18:15:42.830
> 
> 标签：javascript, jsp, servlets

我有一个文本框，用于输入安全问题的答案。当我再次返回该页面时，谷歌浏览器或其他此类浏览器的自动填充功能会提示我之前对该文本框的输入，我想禁用它。我想使用 JSP 或 javascript 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:24:08.147

如果您使用的是 HTML5 并且这是在 a 中`<form>`，您可以查找`autocomplete="off"`整个`<form>`或特定的属性`<input />`。它将禁用现代浏览器填写信息。

# android - Android：批量插入，当 InsertHelper 被弃用时

> ID：14344172
> 
> 赞同：18
> 
> 时间：2013-01-15T18:15:49.783
> 
> 标签：android, sqlite, android-contentprovider, bulkinsert, android-sqlite

有很多答案和教程使用[InsertHelper](http://developer.android.com/reference/android/database/DatabaseUtils.InsertHelper.html)在 SQLiteDatabase 中进行快速批量插入。
但是从 API 17 开始不推荐使用[InsertHelper](http://developer.android.com/reference/android/database/DatabaseUtils.InsertHelper.html)。

现在在 Android SQLite 中批量插入大量数据的最快方法是什么？

到目前为止，我最担心的是[SQLiteStatement](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html)使用起来不太舒服，其中 InsertHelper 具有绑定列和绑定值，这有点微不足道。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-15T19:00:36.283

SQLiteStatement 也有绑定方法，它扩展[了 SQLiteProgram](http://developer.android.com/reference/android/database/sqlite/SQLiteProgram.html)。

只需在事务中运行它：

```
 final SQLiteDatabase db = mOpenHelper.getWritableDatabase();
    final SQLiteStatement statement = db.compileStatement(INSERT_QUERY);
    db.beginTransaction();
    try {
        for(MyBean bean : list){
            statement.clearBindings();
            statement.bindString(1, bean.getName());
            // rest of bindings
            statement.execute(); //or executeInsert() if id is needed
        }
        db.setTransactionSuccessful();
    } finally {
        db.endTransaction();
    } 
```

* * *

**编辑**

[我在SQLiteQueryBuilder](https://developer.android.com/reference/android/database/sqlite/SQLiteQueryBuilder.html)中找不到好的解决方案，但它很简单：

```
final static String INSERT_QUERY = createInsert(DbSchema.TABLE_NAME, new String[]{DbSchema.NAME, DbSchema.TITLE, DbSchema.PHONE});

static public String createInsert(final String tableName, final String[] columnNames) {
    if (tableName == null || columnNames == null || columnNames.length == 0) {
        throw new IllegalArgumentException();
    }
    final StringBuilder s = new StringBuilder();
    s.append("INSERT INTO ").append(tableName).append(" (");
    for (String column : columnNames) {
        s.append(column).append(" ,");
    }
    int length = s.length();
    s.delete(length - 2, length);
    s.append(") VALUES( ");
    for (int i = 0; i < columnNames.length; i++) {
        s.append(" ? ,");
    }
    length = s.length();
    s.delete(length - 2, length);
    s.append(")");
    return s.toString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:29:56.783

我建议你看看 google [IO app](http://code.google.com/p/iosched/source/browse/#git/android/src/com/google/android/apps/iosched/provider)特别是[provider](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/provider/ScheduleProvider.java)，这就是 google 开发人员这样做的方式，所以你可以确定**这**是正确的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T17:12:34.810

我遇到了同样的问题，找不到 SQLiteStatement 如何轻松替换 DatabaseUtils.InsertHelper，因为您需要手动构建 SQL 查询。

我最终使用了可以轻松替换现有代码的**SQLiteDatabase.insertOrThrow 。**我有时只需要添加一个空列 hack 来处理我插入空 ContentValues 的情况。

是的，该语句没有编译为以后重用，但是手动构建一个 INSERT 查询并绑定所有参数太痛苦了。如果您修改代码，我很想知道这对大型批量插入数据集（仅不推荐使用 InsertHelper）的性能有多大影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T13:18:03.927

我刚刚备份了默认类，只保留了与 InsertHelper 相关的代码，请查看[此要点](https://gist.github.com/RomainPiel/5310244)。

我很确定这已被弃用以清理 SDK utils 类。我的课剩下的只是使用非弃用的东西。

# c - 结构中的无符号数据类型

> ID：14344174
> 
> 赞同：1
> 
> 时间：2013-01-15T18:16:02.373
> 
> 标签：c, structure

> **可能重复：**
> [这个 C++ 代码是什么意思？](https://stackoverflow.com/questions/1604968/what-does-this-c-code-mean)
> [“无符号温度：3”是什么意思？](https://stackoverflow.com/questions/2950029/what-does-unsigned-temp3-mean)

我最近看到了一个小的 c 程序。在那个程序中，结构是以这种我无法理解的方式声明的。

```
struct
{
mynode *node;
unsigned vleft :1; 
unsigned vright :1; 
}save[100]; 
```

这里的节点是指向其他结构的指针。

有人可以解释一下**unsigned vleft :1; 无符号 vright :1;** 是？而且我找不到分配给 vleft 和 vright 的任何数据类型。这是什么原因？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:19:20.717

此处假定的默认类型是`unsigned int`，当您指定时，编译器会假定为`unsigned`.

位域语法`unsigned vleft : 1`指定数据域的位宽，在这种情况下，这意味着它是一个位标志（可以是`0`或`1`）。这用于将结构的许多字段打包成更少的位（当您不需要浪费时，例如在这种情况下，一个整体`char`或`int`仅用于存储一个标志）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:18:48.670

`int`数据类型是隐含的，部分`:1`表示这些成员只是 1 位值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:21:36.123

`vleft`并且`vright`只能保存 1 位`int`数据（即`0`或`1`）。

`unsigined`是 的缩写形式`unsigned int`。下面是一些 C 数据类型的缩写形式。

```
short = short int = signed short = signed short int
unsigned short = unsigned short int
int = signed int
unsigned = unsigned int
long = long int = signed long = signed long int
unsigned long = unsigned long int
long long = long long int = signed long long = signed long long int
unsigned long = unsigned long int 
```

# html - 即使屏幕太小，td 宽度也是固定的

> ID：14344177
> 
> 赞同：1
> 
> 时间：2013-01-15T18:16:19.630
> 
> 标签：html, css, html-table

`<td>`我不知道我会有多少。我只知道即使表格对于屏幕来说太大，我也希望它们的宽度固定。

目前，只要我的表格到达屏幕右侧，就会忽略以下宽度。

```
<table>
  <tr>
    <td width="260" style="width: 260px;">Text only</td>
    <td width="260" style="width: 260px;">Text only</td>
    <td><img src="img/image.jpg" width="400"/></td>
    <td><img src="img/image.jpg" width="400"/></td>
    <td width="260" style="width: 260px;">Text only</td>
  </tr>
</table> 
```

问题是：`<td>`with `<img>`inside 是 400 像素，这正是我想要的，但是`<td>`如果表格比屏幕宽，只有内部文本的 s 会缩小尺寸。

我的目标是让访问者从左到右滚动，而不是通常的向上/向下滚动

编辑：我的 IMG 的宽度也事先不知道。并且字符串是在 HTML 中提供的，所以我必须提取`width="400"`，我宁愿不

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:05:05.840

检查此代码：

```
<table border="1">
    <tr>
        <td width="260"><span style="width: inherit; display: block;">Text only</span></td>
        <td width="260"><span style="width: inherit; display: block;">Text only</span></td>
        <td><img src="img/image.jpg" width="800"/></td>
        <td><img src="img/image.jpg" width="800"/></td>
        <td width="260"><span style="width: inherit; display: block;">Text only</span></td>
    </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:14:51.330

如果您可以为您的表格提出一个合理的最大宽度，您可以将其包装在一个设置为该宽度的 div 中。这将允许表格展开（单元格将根据需要调整大小）并且页面将显示水平滚动条。缺点是如果您的表格比最大宽度窄得多，页面将滚动到表格末尾之外的右侧。

```
<div style="width:5000px;">
  <table>...</table>
</div> 
```

# wordpress - 如何调用 Wordpress 3.5 图库图片以便重新排序？

> ID：14344178
> 
> 赞同：0
> 
> 时间：2013-01-15T18:16:21.783
> 
> 标签：wordpress, gallery, wordpress-3.5

我有几个使用 Wordpress 作为 CMS 的网站。两者都有使用下面的代码自定义呈现的画廊。

```
<?php
$the_cat = get_the_category();
$category_name = $the_cat[0]->cat_name;
$category_description = $the_cat[0]->category_description;
$category_link = get_category_link( $the_cat[0]->cat_ID );
$url = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );

echo '<div class="titleblock-2"><p>';
echo customTitle(50);
echo '</p></div>';

$attachments = get_posts(array
    (
    'post_type' => 'attachment',
    'numberposts' => -1,
    'post_status' => 'published',
    'post_parent' => $post->ID,
    'orderby' => 'menu_order',
    'order' => ''
    )
);

if ( $attachments ) {
    echo '<div id="singlegallery">';
    foreach ( $attachments as $attachment ) {
        $attachment_page = get_attachment_link( $attachment->ID ); 
        echo '<div class="big-thumb"><div class="gallery-icon"><a href="';
        echo wp_get_attachment_url( $attachment->ID );
        echo '">';

        $myimage = preg_replace( '/(width|height)=\"\d*\"\s/', "", wp_get_attachment_image($attachment->ID, medium) ); echo $myimage; 

        echo '</a></div></div>';
        }
    echo '</div>';
    } 

?> 
```

我的问题是 Wordpress 3.5 似乎没有像以前那样处理以前上传到帖子的图像，尽管代码生成了一个画廊，但图像无法在 WP 管理界面中重新排序。

我已经看到它表明附件不再像以前那样工作，并且还有另一种方法可以使用如下代码调用图像：

```
$post_content = $post->post_content;
preg_match('/\[gallery.*ids=.(.*).\]/', $post_content, $ids);
$array_id = explode(",", $ids[1]); 
```

有人可以帮助解释如何应用吗？从头开始重新创建每个画廊的“解决方案”在这里根本不是一个选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:33:48.257

正如我在[这里](https://stackoverflow.com/questions/14277794/wordpress-3-5-own-gallery-with-included-images-doesnt-work)提到的，您只需扩展您的`if ( $attachments )`子句：

```
<?php
$the_cat = get_the_category();
$category_name = $the_cat[0]->cat_name;
$category_description = $the_cat[0]->category_description;
$category_link = get_category_link( $the_cat[0]->cat_ID );
$url = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );

echo '<div class="titleblock-2"><p>';
echo customTitle(50);
echo '</p></div>';

$attachments = get_posts(array
    (
    'post_type' => 'attachment',
    'numberposts' => -1,
    'post_status' => 'published',
    'post_parent' => $post->ID,
    'orderby' => 'menu_order',
    'order' => ''
    )
);

if ( $attachments ) {
    echo '<div id="singlegallery">';
    foreach ( $attachments as $attachment ) {
        $attachment_page = get_attachment_link( $attachment->ID ); 
        echo '<div class="big-thumb"><div class="gallery-icon"><a href="';
        echo wp_get_attachment_url( $attachment->ID );
        echo '">';

        $myimage = preg_replace( '/(width|height)=\"\d*\"\s/', "", wp_get_attachment_image($attachment->ID, medium) ); echo $myimage; 

        echo '</a></div></div>';
        }
    echo '</div>';
} else {   
    $post_content = $post->post_content;
    preg_match('/\[gallery.*ids=.(.*).\]/', $post_content, $ids);
    $attachment_ids = explode(",", $ids[1]);
    foreach ($attachment_ids as $attachment_id) {

        // here you can use your old code for printing images, but use "$attachment_id" instead of "$attachment->ID"
    }   
} 

?> 
```

# forms - 在 Google Docs Forms 中，如何将多项选择答案“其他”更改为其他内容？

> ID：14344189
> 
> 赞同：4
> 
> 时间：2013-01-15T18:17:26.040
> 
> 标签：forms, google-docs, survey

我正在尝试在 Google 表单中创建一项调查，并希望创建一个多项选择题，其中一个答案是“不可接受（请发表评论）”。我希望允许此人在选择此多项选择答案后添加一些文本。

在 Google 表单中创建此多项选择问题时，它似乎有一个带有文本框的“其他”选项，但它不允许我将默认文本“其他”更改为其他内容。有谁知道是否可以更改默认文本“其他”？或者有没有其他方法可以做到这一点？谢谢。

![在此处输入图像描述](../Images/d8a83a7d1dfb9ab441ab38347737cf87.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:23:47.007

AFAIK 您无法更改多项选择中最后一个选项的默认文本。

一种解决方法是保留显示*不可接受的选项（请发表评论）*

然后，您将在此（自由文本）之后添加第二个问题：

*如果您标记为“不可接受”，请评论原因：（*或类似的内容）

PS - 在这种情况下，“其他”选项是单行文本输入字段，**而不是**显示带有滚动条以获得更长答案的文本的较大框。不是多行输入字段的评论框会阻止用户轻松查看较长的答案，因此解决方法实际上可能是首选解决方案。

# google-places-api - 存储 Google Places API 数据 - 是否允许？

> ID：14344191
> 
> 赞同：7
> 
> 时间：2013-01-15T18:17:27.210
> 
> 标签：google-places-api

我正在创建一个网站，该网站本质上是属于特定类别的美国企业的目录。为了填充数据库，我使用 Google Places API 来收集符合我的条件的企业名称和地址列表。

我可以无限期地存储这些数据吗？我找不到任何明确禁止存储 Places API 数据的文档，但我知道其他 API 对您可以保留数据的时间有限制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T18:36:37.613

根据使用条款，这是不允许的。使用 Google Places API 的应用程序必须遵守[此处](https://developers.google.com/places/documentation/#Requirements)所述的 Google Maps/Google Earth API 服务条款：

> 所有使用 Google Places 或 Google Places Autocomplete API 的应用程序都必须遵守开发者政策和 Google Maps/Google Earth API 服务条款中描述的要求。Google Places API 和 Google Places Autocomplete API 共享使用配额，如使用限制文档中所述。

[Google 地图/Google Earth API 服务条款第 10.1.3 (b) 节](https://developers.google.com/maps/terms#section_10_1_3)不允许出于临时缓存以外的目的存储内容：

> 您不得预取、缓存或存储任何内容，除非您可以存储：(i) 有限数量的内容，以提高 Maps API 实施的性能，前提是您临时这样做（在任何情况下都不得超过 30 个日历日）、安全且不允许在服务之外使用内容的方式；(ii) Maps API 文档明确允许您存储的任何内容标识符或密钥。例如，您不得使用内容创建独立的“地点”数据库或其他本地列表信息。

所以不，你不能无限期地存储这些数据。

# r - 将文本表达式添加到 xy 绘图，自动定位

> ID：14344193
> 
> 赞同：0
> 
> 时间：2013-01-15T18:17:34.717
> 
> 标签：r

siAll，这是对昨天的 muy 问题的跟进。下面我尝试添加一个链接

[先前的问题](https://stackoverflow.com/questions/14329626/using-dataframe-column-names-as-chart-label-in-apply)

最新的代码是：

```
mypanel <- function(x,y,...) {
  panel.xyplot(x, y, ...)
  panel.grid(x=-1, y=-1)
  panel.lmline(x,y,col="red",lwd=1,lty=1)
  panel.text(200,20,bquote(rho == .(correls[x])),cex=.8, font = 2,col="black")
} 

correls <- as.vector(cor(x=mtcars[,2:3],y=mtcars[,1]))
correls<- round(coeff,3)
names(correls)<-names(mtcars[,2:3])

data <- mtcars[,2:3]
charts <- lapply(names(data), function(x) { xyplot (mtcars[,1] ~ mtcars[,x], 
                                                    panel=mypanel,ylab="MPG", xlab=x)}) 
```

该代码需要 datset mtcars 和 lattice ，我认为它可能也需要 LtticeExtra 。

如您所见，我计算了相关系数并希望将它们添加到图表中。添加了文本 gest 但有两个问题：

1.  correls[x] 部分没有按我的意愿进行评估，我得到了一个 NA（虽然它在控制台中自行工作，但我总是检查它以查找错误）。我似乎不知道如何解决这个问题，即使是指针也会有所帮助，我很乐意做腿部工作
2.  在某些图表中，坐标不起作用，因为这是在 lapply 中运行的，这意味着有些是不可见的。在这种情况下，不是第一个图表，是第二个图表）。可以自动定位吗？Agin 只是一个指向要查找或使用的内容的指针表示赞赏

再次感谢

马里奥

更新，面板编号建议的解决方案不起作用，每个图表都是由 lapply 单独创建的，所以它总是 1，所以我没有得到我需要的东西。我修改了代码以尝试处理放置和起始坐标。但是，它并不总是显示，并且由于某种原因它还显示了 correl 中的错误元素，以查看需要使用图表[1](https://stackoverflow.com/questions/14329626/using-dataframe-column-names-as-chart-label-in-apply)等手动打印图表。

这是最新的代码

```
mypanel <- function(x,y,...) {
  panel.xyplot(x, y, ...)
  panel.grid(x=-1, y=-1)
  panel.lmline(x,y,col="red",lwd=1,lty=1)
  panel.text(xmax[x],ymax,bquote(rho == .(correls[x])),pos=4,cex=1, font = 2,col="black")
} 

correls <- as.vector(cor(x=mtcars[,2:10],y=mtcars[,1]))
correls<- round(correls,3)
names(correls)<-names(mtcars[,2:10])
xmax <-sapply(mtcars[,2:10],max)
names(xmax) <- names(mtcars[,2:10])
xmax<-floor(xmax)
ymax <- floor(max(mtcars[,1]))

data <- mtcars[,2:10]
charts <- lapply(names(data), function(x) { xyplot (mtcars[,1] ~ mtcars[,x], 
                                                    panel=mypanel,ylab="MPG", xlab=x,
                                                    xlim=c(0,ceiling(max(mtcars[,x])))
                                                  ,ylim=c(0,ceiling(max(mtcars[,1]))))}) 
```

再次感谢您的任何指点

马里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T04:13:26.293

我终于解决了它，我使用了我找到的函数 multiplot 和 ggplot2，主要是因为它对我来说更有意义（它的语法）并且因为我喜欢它的图表的外观。

这是整个代码，包括我在“Cookbook for R”中找到的 multiplot 函数（非常感谢）。

这可以进一步改进，因为现在我需要重命名用作我的数据的数据集。我意识到我可以将所有这些都包含在一个函数中，但是现在这对我来说并没有太大的麻烦。

我希望这可以帮助别人。

最后，我想说我对文本位置不太满意，理想情况下它会寻找空白空间，但我想这不会那么容易。如果有人知道如何随意分享。

```
#You need to create an object called my data with your data.frame
#the process will create charts of correlations for the first column versus all others
#and then arrange them in a lattice patter.
#It uses the multiplot function that I found as well as ggplot2

mydata<-mtcars

library(ggplot2)
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  require(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }

  if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}

mychart <- function(x) {
  c <- round(cor(mydata[,1],mydata[x]),3)
  xmax <-ceiling(max(mydata[,x]))
  xmin <- floor(min(mydata[,x]))
  xpos = floor(max(mydata[,x])*(8/10))
  ypos = floor(max(mydata[,1])*(8/10))
  t = paste("rho ==",c,sep="")
  t1 <- annotate("text",x=xpos,y=ypos,label=t,parse=TRUE,color="red")
  p <- qplot(mydata[,x],mydata[,1],xlab=x,ylab=names(mydata)[1],color=I("blue"))
  s <- stat_smooth(aes(x=mydata[,x],y=mydata[,1]),method="lm",color="red",se=FALSE)
  a <- annotate("text",x=xpos,y=ypos,label=t,parse=TRUE,color="red")
  p<- p+s+a+xlim(xmin,xmax)

}

charts <- NULL
l1 <- NULL
for (i in 2:(length(mydata))) {
  charts[[i]]<- mychart(names(mydata)[i])
}

numcols <- ceiling(sqrt(length(mydata)-1))

multiplot(plotlist=charts[2:length(mydata)],cols=numcols) 
```

# sql-server-2008 - 从 UDF 内的查询中排除 WHERE 子句的一部分

> ID：14344194
> 
> 赞同：0
> 
> 时间：2013-01-15T18:17:46.877
> 
> 标签：sql-server-2008, full-text-search, user-defined-functions

我需要对 SQL Server 2008 R2 数据库中 1 到 3 个字段中的子字符串执行全文搜索。仅必须搜索具有非空搜索词的字段。我使用实体框架，搜索是更大的 LINQ 查询的一部分，所以它必须在表值函数中完成才能组合。因此，不可能有动态 SQL。到目前为止，我提出了以下 UDF：

```
CREATE FUNCTION [dbo].[SearchPublications] 
(
@version int,
@comment nvarchar(4000),
@description nvarchar(4000),
@tags nvarchar(4000)
)
RETURNS 
@Table_Var TABLE 
(
[ID] [int] NOT NULL,
[IDPublicationType] [int] NOT NULL,
[IDCover] [int] NULL,
[IDSmallCover] [int] NULL,
[IDContent] [int] NOT NULL,
[Cost] [decimal](10, 2) NOT NULL,
[Language] [smallint] NOT NULL,
[Flags] [tinyint] NOT NULL,
[Year] [smallint] NOT NULL,
[Guid] [nvarchar](255) NOT NULL,
[Key] [nvarchar](25) NOT NULL,
[CTime] [datetime] NOT NULL
)
AS
BEGIN
declare @commentParam nvarchar(4000), @descriptionParam nvarchar(4000), @tagsParam nvarchar(4000), @guid nvarchar(32) = 'E442FB8EA8624E289BD13753480AFA8B'
select @commentParam = isnull('"' + @comment + '*"', @guid)
select @descriptionParam = isnull('"' + @description + '*"', @guid)
select @tagsParam = isnull('"' + @tags + '*"', @guid)

insert @Table_Var
select *
from Publications
where (@commentParam = @guid or exists (select
1 from PublicationFields
where IDPublication = Publications.ID and IDField = 3 and IDVersion = @version and
contains(LongValue, @commentParam)
))
and (@descriptionParam = @guid or exists (select
1 from PublicationFields
where IDPublication = Publications.ID and IDField = 4 and IDVersion = @version and
contains(LongValue, @descriptionParam)
))
and (@tagsParam = @guid or exists (select
1 from PublicationFields
where IDPublication = Publications.ID and IDField = 5 and IDVersion = @version and
contains(LongValue, @tagsParam))
)
RETURN 
END 
```

但是，使用`@param = @guid or...`构造从搜索中排除空参数会导致查询计划非常不理想，并且搜索最多需要 10 秒才能完成。没有上述结构的相同搜索几乎立即返回，但在这种情况下，我不能使用可变数量的搜索词。当动态 SQL 不可行时，是否有更优化的方法从查询中排除 WHERE 子句的一部分？我想避免为 3 个搜索参数的每个组合编写单独的 TVF。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:22:56.600

回答我自己的问题：解决方案是编写一个只搜索一个指定字段的函数

```
CREATE FUNCTION [dbo].[SearchPublications]
(   
    @version int,
    @field int,
    @search nvarchar(4000)
)
RETURNS TABLE 
AS
RETURN 
(
    select Publications.*
    from Publications, PublicationFields
    where IDPublication = Publications.ID and IDField = @field and IDVersion = @version and
    contains(LongValue, @search)
) 
```

然后使用 Intersect 方法在 LINQ 查询中根据需要组合尽可能多的调用：

```
if (query == null)
{
     query = provider.SearchPublications(search.IDVersion, id, string.Format("\"{0}*\"", value));
}
else
{
     query = query.Intersect(provider.SearchPublications(search.IDVersion, id, string.Format("\"{0}*\"", value)));
} 
```

# package - 下载完整的nuget包，以便我可以复制到另一台机器？

> ID：14344195
> 
> 赞同：0
> 
> 时间：2013-01-15T18:17:47.507
> 
> 标签：package, build-process, nuget, nuget-package, nuget-server

## 背景

我在一个使用间接 Internet 访问（通过 VM）来确保安全的计算环境中。

我有以下机器：

*   桌面——我开发的机器；不能访问网络。
*   构建服务器——托管本地 nuget 提要。也无法上网。
*   Internet VM -- 可以访问 Internet 的 VM。文件可以复制到我的桌面。

## 问题

有什么办法可以做到以下几点：

*   **在我的 Internet VM 上，直接从 Internet 下载一个 nuget 包文件夹**
    *   这是关键，也是我似乎无法完成的步骤。
*   将此文件夹复制到我的构建服务器的 nuget 目录
*   使用来自我的开发机器的构建服务器的提要来引用包。

我现在可以复制该文件夹，但只能从我的开发环境中复制，这需要我在我的开发环境中使用 nuget 来下载包——我不能这样做，因为开发环境没有互联网。

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T00:21:28.733

您可以尝试使用 Nuget.Core API 编写脚本。这样做的快速步骤是： 1\. 创建一个项目并在其中安装 Nuget.Core nuget 包。2\. 这将添加对 Nuget.Core 程序集的引用。3\. 编写一个快速方法，从指定的提要下载包：

```
 static string feedUrl = "https://nuget.org/api/v2";
     string packagedir = string.Empty;
     PackageManager manager = null;

        IPackageRepository repo = PackageRepositoryFactory.Default.CreateRepository(feedUrl) as IPackageRepository;
        packagedir = Path.Combine(xxx);
        manager = new PackageManager(repo, packagedir);
       manager.InstallPackage(packageId); 
```

这不需要在您的 Internet VM 上进行任何安装，除了 .Net45

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T21:21:39.070

您可以使用[NuGet 包资源管理器](http://nuget.codeplex.com/releases)下载主要 NuGet 源的包，以便将它们复制过来。

或者，您可以在 Internet VM 上安装[ProGet](http://inedo.com/proget)实例，在默认提要上启用包缓存，然后搜索/浏览包并在其概述页面上选择“拉到 ProGet”以将其放入提要的存储位置。您可以在存储包的源管理页面上验证，然后将它们复制到您想要的任何位置。

如果您可以通过 UNC 路径（例如`\\build-server\c$\ci-tool\nuget-packages`）从 Internet 虚拟机访问您的构建服务器，您可以将其设置为提要存储位置，然后在您将包拉到 ProGet 时，它会自动在您的构建工具的私有 NuGet 中可用喂养。

# javascript - 动画完成选项不起作用？

> ID：14344197
> 
> 赞同：1
> 
> 时间：2013-01-15T18:17:56.270
> 
> 标签：javascript, jquery, slider, slideshow

我不确定我做错了什么，因为一切似乎都很好，除了`animationComplete()`我什至无法运行简单警报的选项。我实际上想使用此选项在一个循环后停止我的幻灯片放映（然后在第一帧上完成），但在我能做到这一点之前，我需要`animationComplete()`工作。这是我尝试发出一个根本不返回任何东西的警报：

```
$('.slides_container').after('<div id="slides-nav" class="pagination">').cycle({
    animationComplete: function(current) {
        alert('alerted');
    },
    fx: 'scrollLeft',
    pause: true,
    pager: '#slides-nav'
}); 
```

在一天结束时，我希望循环一次旋转，然后在第一张幻灯片上暂停。我只是想这是我遇到的第一个障碍，所以在我弄清楚我做错了什么之前，我不能超越这一点。

当这一切都说完了，我希望完成和[这个人一样的事情。](https://stackoverflow.com/questions/8317206/how-to-stop-jquery-slides-in-a-certain-point/8319079#8319079)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:36:35.300

也许只是这样：

```
$('.slides_container').after('<div id="slides-nav" class="pagination">').cycle({
    autostopCount: $('img',this).length+1,
    fx: 'scrollLeft',
    pause: true,
    pager: '#slides-nav'
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:44:43.487

嗯，如果我是对的，我认为您混淆了两个插件，每个插件都有不同的使用回调的方式，您使用的是循环 jquery 插件和 animationComplete 属于 slidejs 所以尝试使用'after'而不是animationComplete，试试这个：

```
$('.slides_container').after('<div id="slides-nav" class="pagination">').cycle({
    fx: 'scrollLeft',
    pause: true,
    pager: '#slides-nav',
    after: alert('alerted')
}); 
```

# iphone - 将 BadgeLabel 设置为动态的问题

> ID：14344198
> 
> 赞同：0
> 
> 时间：2013-01-15T18:17:57.583
> 
> 标签：iphone, ios, objective-c, xcode, cocoa-touch

我有两个按钮，每个按钮的左侧都有一个徽章标签，但我希望这些徽章标签的大小是动态的，我现在该怎么做是这样的 ![当我启动应用程序时](../Images/c414c43cdbf82b1862c1c8c42001da9c.png)

当我启动应用程序时

但是当我向上滚动孔单元时，它应该是这样的![应该如何](../Images/9cb56f34bc21b22c395db11d27abb03b.png)

使用 iPhone sdk 6.0：

```
#import <QuartzCore/QuartzCore.h>

 #import "JSMBadgeLabel.h"

 @interface JSMBadgeLabel ()

 -(void) setup;
 @end

 @implementation JSMBadgeLabel

 @synthesize targetUIView = _targetUIView;

 -(void) setup{
    self.layer.cornerRadius = self.font.pointSize *0.8;

 }

 -(void)awakeFromNib
 {
    [self setup];
 }

 -(void)setText:(NSString *)text{
    [super setText:text];

    CGSize size = [text sizeWithFont:self.font];
    self.frame = CGRectMake(self.frame.origin.x ,self.frame.origin.y,size.width + self.font.pointSize *0.8,size.height);
    CGRect badgeFrame = self.frame;
    CGRect targetFrame = self.targetUIView.frame;

    self.frame = CGRectMake(targetFrame.origin.x+targetFrame.size.width- badgeFrame.size.width/2,targetFrame.origin.y-badgeFrame.size.height/2,badgeFrame.size.width,badgeFrame.size.height);}@end
-(void) updateAsBadge:(NSString*)newText {
    self.text = newText;
    [self sizeToFit];
    const int padding = 1;
    self.frame = CGRectMake(self.superview.bounds.size.width - self.bounds.size.width-padding, padding, self.bounds.size.width, self.bounds.size.height);
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:28:46.553

您可以尝试`-sizeToFit`，它应该可以正常工作，我要添加的一件事是手动为空文本值设置框架。另一件事是您可以使用`superview`属性更好地更新标签位置，这是草稿（不是覆盖`-setText:`）

```
-(void) updateAsBadge:(NSString*)newText {
  self.text = newText;
  [self sizeToFit];
  const int padding = 1;
  self.frame = CGRectMake(self.superview.width - self.width-padding, padding, self.width, self.height);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T11:09:05.630

我自己找到了一些解决方案，我现在在 TablViewController 中包含了这个徽章

```
cell.thingsBadge.text =[NSString stringWithFormat:@"%d",city.unterort.count];
CGSize size1 = [cell.villagesBadge.text sizeWithFont:cell.villagesBadge.font];
CGRect newFrame1 = CGRectMake(cell.villagesBadge.frame.origin.x+(cell.villagesBadge.frame.size.width - (size1.width+4)), cell.villagesBadge.frame.origin.y, size1.width+4, cell.thingsBadge.frame.size.height);
cell.thingsBadge.layer.cornerRadius = cell.villagesBadge.font.pointSize *0.8;
cell.thingsBadge.frame = newFrame1;
[cell.thingsBadge setNeedsDisplay]; 
```

# c++ - c ++“系统”调用不返回正确的退出代码

> ID：14344199
> 
> 赞同：2
> 
> 时间：2013-01-15T18:18:03.090
> 
> 标签：c++, python, system-calls, exit-code

我有以下 C++ 代码

```
...
int res = system("python myscript.py");
if(res != 0){
    cerr << "Exit code was:" << res << endl;
} 
```

python脚本文件以

```
print "This will exit with code 0"
sys.exit(0) 
```

如果我直接运行 python 脚本，我会得到正确的退出代码 (0)。但是，如果我通过 c++ 应用程序运行它，res 为 -1，即使正确打印了“This will exit with code 0”行。

奇怪的是，如果我将调用移到 C++ 应用程序执行的开头，系统调用返回的退出代码是正确的。

什么会导致它在此过程中变得“错误”？

编辑：

在围绕该问题添加一些调试“cout”信息后......它消失了。看起来我有一个Heisenbug。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:25:10.670

你确定脚本正在运行吗？

尝试

```
...
int res = system("/usr/bin/python /path/to/myscript.py");
if(res != 0){
    cerr << "Exit code was:" << res << endl;
} 
```

# php - json_encode 正在切断一些字符

> ID：14344202
> 
> 赞同：0
> 
> 时间：2013-01-15T18:18:13.103
> 
> 标签：php, json

我有一个简单的数组，我从一些 mysql 结果在 php 中创建。

数组中的数据示例如下，来自数组的 var_dump。

```
array(1) {
  [0]=>
  array(8) {
    ["value1a"]=>
    string(2) "26"
    ["value3a"]=>
    string(136) "Curriculum includes NCLEX prep work throughout all degree courses—preparing you to pass the NCLEX-RN exam and become a registered nurse."
    ["value3b"]=>
    string(223) "$150 course fee includes: textbooks, ebooks and CDs, three sets of scrubs, all lab fees, stethoscope, bandage scissors, pen light, and your NCLEX application fee"
    ["soc_code"]=>
    string(10) "29-1141.00"
    ["soc_title"]=>
    string(17) "Registered"
    ["job_growth"]=>
    string(2) "30"
    ["salary"]=>
    string(5) "65950"
    ["program_name"]=>
    string(20) "Professional"
  }
} 
```

当我对数组进行 json_encode 时，例如`json_encode($results)`Everything 工作得很好，但我的 value3a 值在 1 个字后被切断。其余的值都是它们应该包含的 value3b，它和 value3a 一样长。

这是我回显时的示例结果`json_encode($results)`

`[{"value1a":"26","value3a":"Curriculum","value3b":"$150 course fee includes: textbooks, ebooks and CDs...etc`

任何帮助将不胜感激，因为我不确定是什么原因造成的。我试图从 value3a 的值中删除第一个单词，然后它仍然只列出一个单词，现在是第二个单词。

这是我为查看数据所做的工作，因此我知道数组在编码之前没有被更改。

```
echo "<pre>";
var_dump($results);
echo "</pre>";
echo json_encode($results); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:13:58.017

由于 Pekka 的评论，这是一个错误的间距字符，已修复。

# django - Django 1.4 中的原子数据库操作

> ID：14344204
> 
> 赞同：0
> 
> 时间：2013-01-15T18:18:17.203
> 
> 标签：django, django-models, atomic, django-postgresql

这个问题类似于[Django 中的原子操作？](https://stackoverflow.com/questions/280075/atomic-operations-in-django)但是对于 Django 1.4。我想知道是否有办法做到这一点*而不*诉诸“原始 SQL”。我的设置和他的有点不同，所以我会解释一下。

我有一个*User*的记录和一个名为*UserRecords*的通用表。这是*UserRecord*的定义。

```
class UserRecord (models.Model):
    """
    User record model for :class:`User` users to keep
    aux data like services connected, latest stats, and other accounts.
    """

    def __unicode__ (self):
        return u"{0}.{1}.{2}.{3}".format(self.user, self.parent, self.key, self.value)

    def update_maybe_save (self, val):
        if self.value != val:
            self.value = val
            self.save()

    #: :class`User` who owns this record
    user = models.ForeignKey("User")
    parent = models.CharField(max_length=255, blank=True, null=True, db_index=True)
    key = models.CharField(max_length=255, db_index=True)
    value = models.TextField(blank=True, null=True) 
```

如您所见，这是一个非常通用的 k/v 存储表，具有可选的*parent*属性，可用于将记录分组在一起并优化某些搜索。在这种情况下，当我们想为用户添加几个别名时，它非常有用。

```
# Inside the User model
def add_alias (self, name):
    try:
        UserRecord.objects.get(user=self, parent="alias", key=name, value=self.username)
    except UserRecord.DoesNotExist:
        UserRecord(user=self, parent="alias", key=name, value=self.username).save() 
```

这为我们设置了一个竞争条件，如果用户输入相同的别名两次，它可能会创建两个相同的记录。然后每个`UserRecord.objects.get`调用都失败了，因为有两个，我收到一封 Django 错误电子邮件，我手动去修复数据库。

我在文档中找不到任何允许我以原子方式创建内容的内容。除了另一个问题中提到的原始 sql 之外，还有什么想法吗？

# java - 如何将距离（英里）转换为度数？

> ID：14344207
> 
> 赞同：1
> 
> 时间：2013-01-15T18:18:26.413
> 
> 标签：java, geometry, gis

我正在开发一个带有空间数据的应用程序。在这里，我需要找到从质心到一点的距离。可以知道如何在Java中将英里转换为度数吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-15T18:27:51.523

**最终编辑**：查看[大圆距离](http://en.wikipedia.org/wiki/Great-circle_distance)和[测地线](http://en.wikipedia.org/wiki/Geodesic)，以发现您在这个问题中真正提出的问题的复杂性。诚然，这完全出于我对数学的熟悉程度。

[出于历史原因留下原始建议。虽然碎片可能对您有所帮助，但它们不会直接回答您的问题。]

有关此问题的答案，请参阅[https://stackoverflow.com/a/1253545/1964221](https://stackoverflow.com/a/1253545/1964221)。

> 纬度：1 度 = 110.54 公里
> 
> 经度：1 度 = 111.320*cos（纬度）公里

换个方向，我想知道我们是否可以这样做（我的代数生锈了）：

纬度：1 公里 = 1 度/110.54 公里
经度：1 公里 = 1 度/（111.320*cos（纬度）公里）

**应用**

你的距离总是严格的东西向还是南北向？如果是这样，您应该可以说：

```
Integer latTraveledMiles = 100;
Double latTraveledKM = 100 * 0.621371;
Double latTraveledDeg = (1 / 110.54) * latTraveledKM; 
```

或者

```
Double currentLat = 74.0064;
Integer longTraveledMiles = 100;
Double longTraveledKM = 100 * 0.621371;
Double longTraveledDeg = (1 / (111.320 * Math.cos(currentLat))) * longTraveledKM; 
```

很有可能，您需要知道南北和东西方向的距离（并将其带入“不直截了当”的领域）。您可以查看[勾股定理](http://en.wikipedia.org/wiki/Pythagorean_theorem)。您知道“长边”的三角形（c^2），可以计算经度（a^2）和纬度（b^2）。

您应该能够应用我之前的部分代码片段来计算出
c = sqrt(a^2 + b^2)。

祝你好运。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T19:21:22.507

如果这真的是一个直截了当的问题，我们应该忽略纬度和经度，只看两点的半径之间的角度，使得它们之间的距离，沿着包含这两个点的大圆，是 m 英里。

为了让它保持直截了当，我们应该假设地球是球形的，因此答案与位置无关。我使用的平均半径为 3,958.761 英里。

1 弧度是 3,958.761 英里长的线的角度，因此 m 英里长的线的角度是 m/3,958.761 弧度。如果您想要以度为单位的角度，请使用 Math.toDegrees。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T18:22:58.813

用度数表示距离是不正确的方法，因为距离度数在地球上的所有位置上并不相等，并且纬度和经度的表示方式不同。

示例：赤道上的 1° 经度约为 70 英里，而在北极附近则为几英尺。

纬度不会在地球表面发生变化，但是不沿着子午线或平行线的距离呢？你会代表哪些措施？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-18T11:29:33.350

dwight-degroff 的回答很好（谢谢，它帮助了我），但包含一个错误类型，这当然是非常不重要的。如果您想更正确（例如，您正在准备基于来自源的具有许多小数位的外部数据的测试），那么它应该是

> 纬度：1 公里 = 1 度/110.574 公里

代替：

> 纬度：1 公里 = 1 度/110.54 公里

因此对于纬度，它是：

```
 Integer latTraveledMiles = 100;
    Double latTraveledKM = 100 * 0.621371;
    Double latTraveledDeg = (1 / 110.574) * latTraveledKM; 
```

实际上，对于经度，它是 111.319 而不是 111.320，所以：

```
 Double currentLat = 74.0064;
    Integer longTraveledMiles = 100;
    Double longTraveledKM = 100 * 0.621371;
    Double longTraveledDeg = (1 / (111.319 * Math.cos(currentLat))) * longTraveledKM; 
```

但是，这两种修正都可以忽略不计。

# c# - 如何创建 PKCS12 自签名 SSL 证书

> ID：14344208
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:18:28.520
> 
> 标签：c#, ssl-certificate, pkcs#12

我怎样才能创建这个文件？

如果此功能没有内置到 Windows 中，我更愿意使用 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:48:48.347

`openssl`会为你做的。看看这个常见问题解答[https://devcenter.heroku.com/articles/ssl-certificate-self](https://devcenter.heroku.com/articles/ssl-certificate-self)

# flash - 是否可以在 Flash Builder 中从多个浏览器进行测试？

> ID：14344211
> 
> 赞同：3
> 
> 时间：2013-01-15T18:18:36.613
> 
> 标签：flash, flash-builder

在进行重大（甚至微小）更改之后，我想在多个浏览器中进行测试，以确保我没有破坏任何东西。现在，要在 Flash Builder 中切换浏览器，我的工作流程如下所示：

*   点击“Windows”、“首选项”
*   导航到“常规”、“Web 浏览器”
*   选择一个网络浏览器，点击确定
*   打游戏

理想情况下，我希望它看起来像这样

*   下拉“播放”按钮，选择正确的浏览器配置。

但是，我不知道如何在不使用讨厌的批处理文件的情况下执行此 Flash Builder。

有没有办法内置做到这一点？似乎在多个浏览器中进行测试将是一个非常普遍的问题，所以我很难相信它没有内置任何东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-24T07:13:33.490

有一种方法可以设置 Eclipse 来执行此操作。

在 Eclipse（又名 Flash Builder）中

1) 选择`Run External Tools`图标（带有红色小工具箱的绿色箭头）或`Run`菜单 -> `External Tools`。

2) 选择`External Tools Configuration`。

3) 在`Location`标题下选择`Browse File System`按钮并浏览到您要使用的浏览器的可执行文件。

4）在`Arguments:`标题下`http://localhost:8080/${project_name}/index.html`准确添加。该变量将允许您保持配置通用并适用于任何项目。

5）我建议你给它起个名字，比如“Chrome - 当前项目 index.html”

6) 对您要测试的所有浏览器重复此过程。

要使用它，只需选择您从`Run External Tools`. （请注意，您需要`Run`第一次从配置中获取它才能显示在下拉列表中）

注意：我已经确认这在 Flash Builder 的 Flash 透视图中可用。

[在AVAJAVA Web Tutorials](http://www.avajava.com/tutorials/lessons/how-do-i-open-a-browser-window-via-eclipse.html)上有一个关于这个过程的完整描述和图片 。

* * *

或者，您可以使用[Selenium WebDriver](http://www.seleniumhq.org/projects/webdriver/)打开多个浏览器。使用 Selenium 还具有额外的好处，即允许您设置 UI 的单元测试（我在这里松散地使用这个术语）。（虽然我不确定最后一部分是否适用于 Flash/Flex）

这里有几个链接描述了这种情况。

[居住质量检查博客](http://abodeqa.wordpress.com/tag/how-to-execute-selenium-webdriver-test-cases-parallel-in-multiple-browser-using-testng-parameter-annotation/)

[针对多个浏览器运行 selenium webdriver 测试用例](https://stackoverflow.com/questions/16076971/running-selenium-webdriver-test-cases-against-multiple-browsers)

[使用 Selenium “自动”在不同的浏览器上运行 JUnit 测试](https://stackoverflow.com/questions/8010506/running-junit-tests-on-different-browsers-using-selenium-automatically)

# android - 当我在模拟器中启动 android 项目时，我收到“不幸的是 Myapp 已停止工作”

> ID：14344212
> 
> 赞同：0
> 
> 时间：2013-01-15T18:18:37.037
> 
> 标签：android, xml

我是 android 项目开发的初学者。我已经开始使用我在网上找到的教程开发一个基本的应用程序。我正在使用 eclipse。运行我的项目时没有错误。单击模拟器上的应用程序后，我立即收到此错误。在我使用的 rd xml 和 java 编码之后：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/tvDisplay"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="@string/result"
    android:textSize="30sp" />

<Button
    android:id="@+id/a"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="@string/add"
    android:textSize="20sp" />

<Button
    android:id="@+id/s"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="@string/sub"
    android:textSize="20sp" /></LinearLayout> 
```

爪哇：

```
package com.app.myapp;
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.widget.Button;
import android.widget.TextView; 
```

公共类 MainActivity 扩展 Activity {

```
int count;
Button add,sub;
TextView disp;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.linear);
    count=0;
    add=(Button) findViewById(R.id.a);
    sub=(Button) findViewById(R.id.s);
    disp=(Button) findViewById(R.id.tvDisplay);
    add.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            count=count+1;
            disp.setText("Result is " + count);

        }
    });
    sub.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            count=count-1;
            disp.setText("Result is " + count);
        }
    });
}
} 
```

请提出解决方案，然后我应该继续我的项目开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:21:30.633

```
TextView disp;
disp=(Button) findViewById(R.id.tvDisplay); 
```

您已将“disp”声明为 TextView；但是在代码中，您将其转换为 Button。像这样将演员更改为 TextView ：

disp=(TextView) findViewById(R.id.tvDisplay);

# ios - ColorWithPatternImage 和约束

> ID：14344213
> 
> 赞同：0
> 
> 时间：2013-01-15T18:18:37.943
> 
> 标签：ios, objective-c

我有一张图片需要平铺作为 UIView 的背景：

```
UIView *buttonView = [UIView new];
[buttonView setTranslatesAutoresizingMaskIntoConstraints:NO];
[buttonView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:[buttonBar(100)]" options:0 metrics:nil views:NSDictionaryOfVariableBindings(buttonView)]];
[buttonView setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"bottomBar-bg-100.png"]]]; 
```

图像是 200x200，但我需要它是 100。如果我将图像添加为：

```
imageView.image = [UIImage imageWithName:@"bottomBar-bg-100.png"] 
```

它将被压缩到 100。但是当我使用该`colorWithPatternImage:`方法时，它不会将 200 高的图像压缩为 100 高。

约束和使用约束是否存在一些愚蠢之处`colorWithPatternImage:`，或者这就是它的`colorWithPatternImage:`工作原理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:22:07.980

你知道`resizableImageWithCapInsets:resizingMode:`吗？这是将图像转换为可以拉伸或平铺为可用尺寸的最佳方式。

# php - PHP 数组到 JSON 对象 - 如何操作？

> ID：14344216
> 
> 赞同：0
> 
> 时间：2013-01-15T18:18:52.137
> 
> 标签：php, javascript, ajax, json

我有一个 ajax 应用程序。它基本上将图像上传到一个文件夹，然后 PHP 抓取它们并将它们放入一个数组中。从那里它被 json_encoded 并通过 echo 发送回来。`alert(responseText)`给我json版本。在我将一个变量设置为 后`json.parse()`，`console.log()`它作为一个数组出来很好。该数组看起来基本上是这样的：

```
1 IMAGE1.jpg
2 IMAGE2.jpg
3 IMAGE3.jpg
4 IMAGE4.jpg
5 IMAGE5.jpg 
```

等等

我知道它现在位于 javascript/json 对象中。不幸的是，我找不到有关操纵此对象以获取所有图像名称和最后一个数组类型的任何信息，这是上传的真正成功或失败。任何人都可以向我指出一些文档或一种方法来操纵它并将信息外推到一个数组中。最后，我试图动态显示这些图像，但我假设通过上传它们并不都具有相同的名称。

所以我希望抓取所有 .jpg/.png./gif 等文件并抓取这些文件名，然后使用循环`innerHTML`创建一堆具有正确文件名的标签。`<img>`同样，处理数组中的最后一部分，它只是说明上传是否完全成功的文本。

我不应该使用 JSON 吗？我的代码如下。

**PHP**

```
$dirhandler = opendir(UPLOAD_DIR);
//create handler to directory

//read all the files from directory
$nofiles=0;
while ($file = readdir($dirhandler)) {
    //if $file isn't this directory or its parent
    //echo "FILE SYSTEM: " . $file . "<br/>";
    //add to the $files array
    if ($file != '.' && $file != '..') {
        $nofiles++;
        $files[$nofiles]=$file;
    } //end of if loop
} //end of while loop
//json_encode($files);
if (!$success) { 
    $nofiles++;
    $files[$nofiles] = "Unable to upload file";
    exit;
} else {
    $nofiles++;
    $files[$nofiles] = "File Upload Successfully";
}
echo json_encode($files); 
```

**JAVASCRIPT**

```
 if (xhr.readyState === 4 && xhr.status === 200) {
            progressBar.value="100";
            progressText = "Upload Complete!";
            progressStatus.innerHTML = progressText;
            var imageNames = JSON.parse(xhr.responseText);
            alert(imageNames);
        } else if (xhr.readyState === 0 || xhr.readyState === 1) {
            progressBar.value = "25";
            progressText = "Starting Upload..";
            progressStatus.innerHTML = progressText;
        } else if (xhr.readyState === 2) {
            progressBar.value = "50";
            progressText = "Almost Done...";
            progressStatus.innerHTML = progressText;
        } else if (xhr.readyState === 3) {
            progressBar.value = "75";
            progressText = "So Close!";
            progressStatus.innerHTML = progressText;
        } else if (xhr.status === 404 || xhr.status === 500) {
            alert("Your Upload Request failed.");
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:23:16.133

`imageNames`是一个没什么特别的对象——像使用任何普通的 javascript 对象一样使用它。例如：`imageNames[2]`会给你第二个图像名称。

`json_encode()`但是，如果您生成一个可以理解为实际 JS 数组的数组，您的生活将会轻松得多。在您的 PHP 中，为每个图像包含一个条目，而不是使用显式索引：

```
$files = array();
$entries = scandir(UPLOAD_DIR);
foreach ($entries as $entry) {
    if (is_file(UPLOAD_DIR.'/'.$entry)) {
        $files[] = $entry;
    }
}
if (!$files) {
    // signal an error with an actual HTTP error code!
    header('Content-Type: application/json', false, 500);
    echo json_encode(array('error'=>'upload failed'));
} else {
    header('Content-Type: application/json');
    echo json_encode($files);
} 
```

但是，我怀疑您应该在处理文件时收集文件名。使用带有输入元素的上传表单，例如`<input type="file" name="images[]">`，然后使用以下内容上传到脚本：

```
function process_uploaded_files($files, $destdir, $nametmpl) {
    $moved = array();
    foreach ($files['error'] as $key => $error) {
        $newname = FALSE;
        if ($error===UPLOAD_ERR_OK) {
            $source = $files['tmp_name'][$key];
            $destname = sprintf($nametmpl, $key);
            $dest = "{$destdir}/{$destname}";
            if (move_uploaded_file($source, $dest)) {
                // success!
                $newname = $destname;
            }
        }
        $moved[$key] = $newname;
    }
    return $moved;
}

function filename_to_url($filename) {
    // or whatever
    return ($filename) ? '/images/'.$filename : $filename;
}    

$uploaded_files = process_uploaded_files($_FILES['images'], UPLOAD_DIR, 'Image%03d');

// you should always return URLs of resources (not bare filenames) to be RESTful
$new_urls = array_map('filename_to_url', $uploaded_files);
header('Content-Type: application/json');
echo json_encode($new_urls); 
```

# php - magento 删除其他图片

> ID：14344218
> 
> 赞同：0
> 
> 时间：2013-01-15T18:19:01.823
> 
> 标签：php, magento

```
<?php
require 'app/Mage.php';
Mage::app();
$products = Mage::getModel('catalog/product')->getCollection()
                                        ->addAttributeToSelect('id')
                                        ->addAttributeToSelect('image')
                                        ->addAttributeToSelect('small_image')
                                        ->addAttributeToSelect('thumbnail_image');
foreach ($products as $product) {
  if (!$product->hasImage()) continue;
  if (!$product->hasSmallImage()) $product->setSmallImage($product->getImage());
  if (!$product->hasThumbnail()) $product->setThumbnail($product->getImage());
  $product->save();
} 
```

我试图弄清楚如何使用此代码删除其他图像，但我在网上的任何地方都看不到指南:(我使用此代码将小缩略图设置为基本图像，现在我被困在尝试删除重复的附加图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:23:19.430

这是我的 C# 版本使用soap 执行此操作的方法……您可能想知道我是如何做到这一点的……阅读整篇文章。

```
private void RemoveImagesFromProduct()
        {
            try
            {    
                List<catalogProductImageEntity> imageList = this.mageObject.catalogProductAttributeMediaList(this.VendorProductId, null, "sku").ToList();

                // execute the soap call to remove each one
                foreach (catalogProductImageEntity catProdImg in imageList)
                {
                    this.mageObject.catalogProductAttributeMediaRemove(this.VendorProductId, catProdImg.file, "sku");
                }
            }
            catch (Exception exception)
            {
                this.SetProgressErrUpdate("Remove Image Handler Error");
                this.SetProgressErrUpdate(exception.Message);
            }
        } 
```

在确定了soap调用指向的位置之后，我发现Core Magento中使用了这些方法：

(app/code/core/Mage/Catalog/Model/Product/Attribute/Media/Api.php)

```
 public function items($productId, $store = null, $identifierType = null)
     {
         $product = $this->_initProduct($productId, $store, $identifierType);

         $gallery = $this->_getGalleryAttribute($product);

         $galleryData = $product->getData(self::ATTRIBUTE_CODE);

         if (!isset($galleryData['images']) || !is_array($galleryData['images'])) {
             return array();
         }

         $result = array();

         foreach ($galleryData['images'] as &$image) {
             $result[] = $this->_imageToArray($image, $product);
         }

         return $result;
     }

     public function remove($productId, $file, $identifierType = null)
         {
             $product = $this->_initProduct($productId, null, $identifierType);

             $gallery = $this->_getGalleryAttribute($product);

             if (!$gallery->getBackend()->getImage($product, $file)) {
                 $this->_fault('not_exists');
             }

             $gallery->getBackend()->removeImage($product, $file);

             try {
                 $product->save();
             } catch (Mage_Core_Exception $e) {
                 $this->_fault('not_removed', $e->getMessage());
             }

             return true;
         } 
```

在这一点上，我知道删除图像必须做的一切，只是现在必须编写一个独立的函数。

```
// Set the product ID here, or load a collection and foreach it and use $product->getId()
        $prodId = 4967;
        // Reload here. Collections in magento are just unpredictable sometimes!
        $loadedProduct = Mage::getModel('catalog/product')->load($prodId);

        $attributes = $loadedProduct->getTypeInstance(true)->getSetAttributes($loadedProduct);

        if (isset($attributes['media_gallery'])) {
                // From this point forward, the gallery is represented by $attributes
                $gallery = $attributes['media_gallery'];
                $galleryData = $loadedProduct->getData('media_gallery');

                if (!isset($galleryData['images']) || !is_array($galleryData['images'])) {
                        die('no images for this product');
                }

                $result = array();
                foreach ($galleryData['images'] as &$image) {
                        $data = array(
                            'file'      => $image['file'],
                            'label'     => $image['label'],
                            'position'  => $image['position'],
                            'exclude'   => $image['disabled'],
                            'url'       => Mage::getSingleton('catalog/product_media_config')->getMediaUrl($image['file']),
                            'types'     => array()
                        );

                        foreach ($loadedProduct->getMediaAttributes() as $attribute) {
                            if ($loadedProduct->getData($attribute->getAttributeCode()) == $image['file']) {
                                $data['types'][] = $attribute->getAttributeCode();
                                }
                        }

                        $result[] = $data;
                }

                // At this point all the media info will be displayed for the product
                // From this point forward you just need to call the same parts of the remove soap api call
                foreach ($result as $galleryResult) {
                        // if the image exists, delete it.
                        if($gallery->getBackend()->getImage($loadedProduct, $galleryResult['file'])) {
                                $gallery->getBackend()->removeImage($loadedProduct, $galleryResult['file']);
                        }
                }
        } 
```

# c# - WP7BarcodeManager.LastCaptureResults 不起作用

> ID：14344219
> 
> 赞同：1
> 
> 时间：2013-01-15T18:19:04.180
> 
> 标签：c#, windows-phone-7, barcode

我有使用该`WP7BarcodeManager.GetReader().decode(...)`功能读取条形码的 WP7 页面。成功扫描后，我想以这种方式在矩形（rScanner）上显示扫描的条形码：

```
private ImageBrush lastScan = new ImageBrush();

...

lastScan.ImageSource = WP7BarcodeManager.LastCaptureResults.BarcodeImage;
rScanner.Fill = lastScan; 
```

不显示图像（也没有引发异常）

# javascript - Webkit translateY + textarea 错误

> ID：14344223
> 
> 赞同：0
> 
> 时间：2013-01-15T18:19:23.310
> 
> 标签：javascript, html, css, webkit

仅限 Webkit。让我们假设我们有一个带有`translateY`css 属性的容器。此容器包含 textarea 元素。在这种情况下，textarea 行为是不正确的。当您尝试输入多于 textarea 行属性的行时，自动滚动将不起作用，直到 textarea 内的文本高度不大于`textarea height` `+` `translateY * -1`.

[请在此处查看示例。](http://jsfiddle.net/vpetrychuk/mT7Lp/)

任何想法如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:05:14.787

是 webkit 错误，必须报告谷歌以便他们修复它。试试这个看看它是否适合你：http: [//jsfiddle.net/mT7Lp/1/](http://jsfiddle.net/mT7Lp/1/)

而不是使用`translate`，使用位置`relative`并将顶部设置为 -pixel

# ruby-on-rails - 设计登录失败消息

> ID：14344228
> 
> 赞同：3
> 
> 时间：2013-01-15T18:19:50.823
> 
> 标签：ruby-on-rails, login, devise

我按照这个问题[在登录失败后设计重定向](https://stackoverflow.com/questions/5832631/devise-redirect-after-login-fail)并且效果很好，但是我收到一个通知，告诉我我需要登录才能继续，并且我需要的消息是密码或电子邮件无效。所以我在 CustomFailure 中添加了 flash 通知，如下所示：

```
 class CustomFailure < Devise::FailureApp
  def redirect_url
    root_path
  end

  def respond
    if http_auth?
      http_auth
    else
      flash[:error] = I18n.t(:invalid, :scope => [ :devise, :failure ])
      redirect
    end
  end
end 
```

现在它向我显示了两个消息，无效密码和未经身份验证，我怎样才能消除未经身份验证的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:14:58.460

Devise 没有设置`flash[:error]`，但是`flash[:alert]`当登录失败时，尝试在你的应用程序中设置它。

您也可以只覆盖该方法[`Devise::FailureApp#i18n_message`](https://github.com/plataformatec/devise/blob/master/lib/devise/failure_app.rb)并让它返回您选择的消息：

```
class CustomFailure < Devise::FailureApp
  def redirect_url
    root_path
  end

  def i18n_message
    "Hello World" # you might go for something more elaborate here
  end
end 
```

# sql - 在 Oracle 11g 中使用 SQL plus 中的 sql 脚本

> ID：14344232
> 
> 赞同：0
> 
> 时间：2013-01-15T18:19:57.240
> 
> 标签：sql, oracle

我想将一个 sql 脚本文件导入 SQL Plus。我找到了一个示例并尝试像这样进行操作：

```
SQL>START z:myscript.sql 
```

但它没有用。SQL Plus 窗口只显示“35”并突出显示光标，表示我可以继续输入 (???)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:17:53.227

每个创建代码对象的语句（例如 CREATE PROCEDURE、CREATE FUNCTION、CREATE PACKAGE、CREATE TYPE）都需要在其后有一个斜杠（“/”）才能执行。普通的 SQL 语句如果以分号结束就会执行，但是由于 PL/SQL 代码的行总是以分号结束，因此不能将其用作代码对象执行的指示符。

从您自己的跟进来看，听起来您在脚本中有多个这样的语句，并且在最后一个之后才输入斜线。这会导致 SQLPlus 尝试将脚本的整个文本作为单个语句执行，这很可能会失败。

你想要这样的东西：

```
CREATE TYPE my_type_1
  ... your code here ...
/

CREATE TYPE my_type_2
  ... your code here ...
/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:25:52.223

您是否在提示中尝试过@filename，例如

```
 >@runscript.sql 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:32:33.083

在命令行中，键入

```
 SQLPLUS username/password@TNSNAME @myscript.sql 
```

这将使用指定的用户名和密码连接到 TNSNAME 并执行 myscript.sql 文件。如果脚本名称包含空格，则脚本名称可以用双引号引起来。

# sass - 在 localhost 上使用 Compass sprite 生成

> ID：14344238
> 
> 赞同：1
> 
> 时间：2013-01-15T18:20:17.340
> 
> 标签：sass, compass-sass, sprite

我在 Windows 8 上的本地计算机上工作。我使用 XAMPP。

我正在尝试生成一个精灵并在我的 Compass & Sass 项目中使用它。精灵生成成功，我可以在我的图像文件夹中看到它，但是在尝试使用精灵时，我收到精灵的 404 错误。

它一直试图从 localhost 获取图像。`http://localhost/images/cb-s2d817fe88b.png`例如。

但我的项目位于.这`http://localhost/projects`是我的 config.rb

```
http_path = "/"
css_dir = "css"
sass_dir = "sass"
images_dir = "images"
javascripts_dir = "js" 
```

这是我的 SCSS 的一个例子：

@import "../images/cb/*.png";

```
.logo {
    @include cb-sprite('logo');
} 
```

如何成功引用精灵？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:48:04.913

尝试更改指南针根目录`http_path`中的`.config-rb`文件以反映精灵文件夹的路径：

`http_path = "/projects/"`

如果这不起作用，`../images/`请从您的导入语句中删除。指南针应该已经在查看设置为的任何目录`images_dir`

注意：如果您正在“监视”一个指南针文件夹，您必须启动和停止它才能反映此更改。

最终，最好的解决方案是为您的项目配置一个虚拟主机和域（这样文件将能够是相对于 root`/`的），但这应该是一个快速修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-01T01:58:19.860

我遇到了同样的问题，问题是您的配置文件在您对其进行更改后没有被刷新。您可以在终端或命令行界面上执行此操作

只需 cd 到项目文件夹，然后执行“compass config --force”，它应该用更改覆盖您当前的配置文件，并且应该修复它。

我也意识到这个问题几年前就已经开放了，所以如果已经找到答案，我深表歉意。

谢谢

# javascript - 使用 ColdFusion 和 JavaScript DYMO SDK 创建条码标签

> ID：14344240
> 
> 赞同：2
> 
> 时间：2013-01-15T18:20:20.663
> 
> 标签：javascript, coldfusion

我正在尝试使用 DYMO SDK 将条形码打印到包裹标签上。我希望能够在不使用 DYMO 软件的情况下创建条形码对象。我正在 ColdFusion 中编写此代码。现在我有一些代码可以将条形码生成为 HTML 并将其显示在网页上。但是，当我使用 DYMO SDK 中的 JavaScript 打印标签时，它会错误地打印条形码，条形码的值只是“未知”。无论如何，希望有人有使用这个库的经验。这是我用来打印标签的 JavaScript：

```
// prints the label
printButton.onclick = function () {
    try {
        // open label
        var labelXml = '<?xml version="1.0" encoding="utf-8"?>\
<DieCutLabel Version="8.0" Units="twips">\
<PaperOrientation>Landscape</PaperOrientation>\
<Id>Address</Id>\
<PaperName>30252 Address</PaperName>\
<DrawCommands/>\
<ObjectInfo>\
<BarcodeObject>\
<Name>Barcode</Name>\
<ForeColor Alpha="255" Red="0" Green="0" Blue="0" />\
<BackColor Alpha="0" Red="255" Green="255" Blue="255" />\
<LinkedObjectName>BarcodeText</LinkedObjectName>\
<Rotation>Rotation0</Rotation>\
<IsMirrored>False</IsMirrored>\
<IsVariable>True</IsVariable>\
<Text>BARCODE</Text>\
<Type>Code39</Type>\
<Size>Medium</Size>\
<TextPosition>Bottom</TextPosition>\
<TextFont Family="Arial" Size="8" Bold="False" Italic="False" Underline="False" Strikeout="False" />\
<CheckSumFont Family="Arial" Size="8" Bold="False" Italic="False" Underline="False" Strikeout="False" />\
<TextEmbedding>None</TextEmbedding>\
<ECLevel>0</ECLevel>\
<HorizontalAlignment>Center</HorizontalAlignment>\
<QuietZonesPadding Left="0" Top="0" Right="0" Bottom="0" />\
</BarcodeObject>\
<Bounds X="332" Y="150" Width="4455" Height="1260" />\
</ObjectInfo>\
</DieCutLabel>';
        var label = dymo.label.framework.openLabelXml(labelXml);

        // set label text
        label.setObjectText("Barcode", textTextArea.value); 
```

这是我用来生成条形码的代码：

```
<cfoutput>
<!---span style="#Attributes.TextFontTop#">#Attributes.TextTop#</span--->
<div>
<cfloop index="i" from="1" to="#len(Attributes.InputValue)#"> 
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],1,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: black; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],6,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: white; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],2,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: black; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],7,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: white; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],3,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: black; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],8,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: white; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],4,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: black; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],9,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: white; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:#val(mid(code39[asc(mid(Attributes.InputValue,i,1))],5,1)*(Attributes.BarWidth)+(Attributes.BarWidth/2))#px solid; border-color: black; height: #Attributes.BarHeight#px;margin-bottom:#Attributes.MarginBottom#px;margin-top:#Attributes.MarginTop#px;"></span>
    <span style="border-right:2px solid; border-color: white; height: 50px;margin-bottom:2px;margin-top:2px;"></span>   <!--- space between individual codes --->
</cfloop>
</div>
<span style="#Attributes.TextFontBottom#">#Attributes.TextBottom#</span> 
```

这是我用来显示它的测试 HTML：

```
<div id="textTextArea">
   <CF_barcode39 InputValue="ABCDEFGHIJ" BarWidth="2" BarHeight="50"                                         TextTop="BarWidth=2 BarHeight=50" TextBottom="ABCDEFGHIJ">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:24:28.297

我的服务器生成用于生产入场券的条形码。我强烈推荐[http://cfbarbecue.riaforge.org/](http://cfbarbecue.riaforge.org/)。按照 install.txt 文件上的说明进行操作，但基本上，您将一些文件复制到 ColdFusion 目录下的 lib 文件夹中。这是我用来生成条形码的代码示例。

```
<cfset bbq = createObject("component", "CFBarbecue").init() />
<cfset barcode = bbq.createImage( type="#var.barcodetype#", data="#session.cart.checkOut[i].BARCODE#", checkDigit=false, barWidth="1", barHeight="30", drawLabel="FALSE") /> 
```

我已经有一段时间没有安装它了，但我认为你不需要做任何映射。

# clearcase - 在 ClearCase 活动中查找移动的文件

> ID：14344243
> 
> 赞同：1
> 
> 时间：2013-01-15T18:20:36.423
> 
> 标签：clearcase, cleartool

我正在编写一个脚本，将我工作场所的项目从 ClearCase 转换为 Mercurial + Jira。我在移动文件时遇到问题。我正在使用“lsact -long”来更改活动中的文件。问题是，例如，当一个目录被重命名时，更改仅在其父目录中很明显，并且它与“描述”一起列出，如下所示：

> 添加了目录元素“new_name”。未编目的目录元素“old_name

问题是，它没有明确指定目录已移动，因此可能有人删除了旧目录并创建了新目录。

我如何知道文件是否在目录变更集中移动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:04:30.763

对于任何向 Mercurial 或 Git 的迁移，我从不关心这些信息。

我只需从 ClearCase 中选择一个一致的修订（UCM 基线或完整标签），并将其添加到存储库（Hg 或 git）。
我在修改之后重复过程修改。

Hg 或 Git 会自动检测重命名（文件或目录）。

换句话说，任何由 VCS 记录的元数据都不会在 Git 或 Mercurial 中进行翻译。
关于重命名，这些 DVCS 将分析它们各自的修订并推断出重命名，如果您要求他们，*在*导入所有内容后，并在使用您的存储库（[`git diff -M`](https://stackoverflow.com/a/7941544/6309)例如，或`hg log --follow`.

话虽如此，如果您想告诉 Hg 元素已移动（如“[如何在 Mercurial 中重命名目录并继续跟踪所有文件更改](https://stackoverflow.com/q/3535676/6309)”），您可以检查（如果尚未修剪）该事件的历史记录父目录，或“ `new_name`”之一：

```
cleartool lshist -long ... 
```

这些事件可能记录了重命名或移动操作。

# apache - apache重启后mod_rewrite规则失败

> ID：14344244
> 
> 赞同：0
> 
> 时间：2013-01-15T18:20:40.210
> 
> 标签：apache, magento, mod-rewrite, redirect, seo

我有以下重写规则，但每次我重新启动 Apache 时，它​​们都会阻止 apache 重新启动和失败。

一个错误是...

> `Starting httpd: Syntax error on line 82 of /var/www/vhosts/current_release/url-rewrite-maps/catchall.txt: RewriteRule: cannot compile regular expression '^/ProductDetails\.aspx\?PromotionID\(.*)\&id\(.*)$' [FAILED]`

```
RewriteRule ^/ProductSearch\.aspx\?Ntt\=(.*)\&N\=(.*)$ catalogsearch/result/?q=$2 [R=302,L,NC]  
#old search redirect to search

RewriteRule ^/ProductSearch\.aspx\?viewall\=1\&N\=(.*)$ productsearch.aspx?N=$1 [R=302,NC]  
#viewall with N parameter to another redirect rule for URL with N= value only

RewriteRule ^/ProductSearch\.aspx\?(Ne|No)\=(.*)\&N\=(.*)$ productsearch.aspx?N=$3 [R=302,NC]  
#url with Ne OR No param and N= to productsearch.aspx redirect on URLs with N= only

RewriteRule ^/ProductDetails\.aspx\?PromotionID\=(.*)\&id\=(.*)$ productdetails.aspx?id=$2 [R=302,NC]  
#should pass the PID into the ID= and redirect from there

RewriteRule ^/ProductDetails\.aspx\?id\=(.*)\&RSSLINK\=(.*) productdetails.aspx?id=$1 [R=302, NC] 
```

谢谢，

布拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T02:15:06.513

这是因为您尝试做的事情是无效的。您不能通过正则表达式匹配模式访问查询字符串——它是不允许的。您必须使用重写条件来获取查询字符串，例如：

```
RewriteCond %{QUERY_STRING}          PromotionID=(.*?)&id=(.*) [NC]
RewriteRule ^/ProductDetails\.aspx$  productdetails.aspx?id=%2 [R=302,NC,L] 
```

您可以创建一个梯子，并在底部放置一个包罗万象

```
RewriteCond %{ENV:REDIRECT_STATUS}   ^$
RewriteRule ^                        /catchall.txt [L] 
```

这将对任何与之前的规则不匹配的请求进行内部重定向到您的全部捕获。条件是停止无限重定向循环。

# wix - 我可以使用 Wix 为主要升级制作补丁吗？

> ID：14344247
> 
> 赞同：0
> 
> 时间：2013-01-15T18:20:42.590
> 
> 标签：wix, windows-installer

我希望开始使用现有产品的补丁。目前产品 ID 是自动生成的。浏览了一些在线资源后，我不清楚我是否可以开始使用补丁。

1.  由于现有版本的产品 ID 未知（因为它是自动生成的） - 我想我别无选择，只能让我的下一次升级成为重大升级？

2.  我是否认为将重大升级作为补丁进行是不明智的？[这](http://msdn.microsoft.com/en-us/library/aa370579%28VS.85%29.aspx)意味着您可以对补丁进行重大升级，[但这](http://wix.sourceforge.net/manual-wix3/patch_restrictions.htm)似乎意味着这是一个坏主意，尽管我不确定为什么。

假设我的下一次升级必须是重大升级，并且重大升级不应该是补丁，这是我最好的行动方案（因为我希望将来能够使用补丁）以使下一次升级成为更改产品 ID 的重大升级到一个已知的常数（直到下一个大的变化）并在那之后使用补丁？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:57:22.360

Windows Installer 支持主要升级补丁，这里有一个讨论：

[主要升级补丁](http://blogs.msdn.com/b/heaths/archive/2005/08/22/454552.aspx)

但是，WiX 不支持它：

[补丁限制](http://wix.sourceforge.net/manual-wix3/patch_restrictions.htm)

也许doco是旧的。对于 WiX-Users 邮件列表来说，这将是一个很好的问题。我进行了一些搜索，但找不到任何谈论这些问题的主题。我不熟悉，因为这不是我曾经想使用的策略。

# javascript - 如何更改弹出窗口的位置

> ID：14344248
> 
> 赞同：1
> 
> 时间：2013-01-15T18:20:44.053
> 
> 标签：javascript, html

我的应用程序打开了一个弹出窗口，如下所示：

```
function newPopup(url, windowName) {
    window.open(url,windowName,'height=768,width=1366,left=10,top=10,titlebar=no,toolbar=no,menubar=no,location=no,directories=no,status=no');
}
<a href="JavaScript:newPopup('lobby.do', 'lobby');">Enter Lobby</a> 
```

在该弹出窗口中，我希望用户能够通过单击链接来移动该弹出窗口的位置：

```
<a href="game.do">New Game</a> 
```

但是，在弹出窗口中单击此链接时，弹出窗口会自动关闭，并且不会发生重定向。我尝试添加一个 onClick 并使用 javaScript:window.location，但得到了相同的结果。知道是什么原因造成的吗？我已经在 Chrome 和 Firefox 中进行了测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:33:28.253

只需将`target`链接的 设置为弹出窗口的名称。

```
<a href="game.do" target="lobby">New Game</a> 
```

或者保存从返回的值`window.open`并设置它的`.location`.

```
function newPopup(url, windowName) {
    return window.open(url,windowName,'height=768,width=1366,left=10,top=10,titlebar=no,toolbar=no,menubar=no,location=no,directories=no,status=no');
}

<a onclick="window.lobby=newPopup('lobby.do', 'lobby'); return false;" href="#">Enter Lobby</a>
<a href="window.lobby.location='game.do'; return false;" href="#">New Game</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:35:43.700

在新窗口中打开它需要做的是在这样的链接`target_blank`末尾添加：`html`

```
<a href="http://link-to-your-game" target="_blank">Enter Lobby</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:36:15.507

为什么不使用ajax：

`<a onclick="ajaxcall_to_newpage()"> click here to update the content </a>`

以及您的 ajax 函数从服务器请求新内容并将其呈现为 html：

```
..
}).done(function(data){
   $('#your_div_of_pop_up').text(data);
}); 
```

工作完成了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:24:55.157

如果我理解正确，您需要为弹出窗口命名。然后您可以引用该弹出窗口来更改它的内容。

你只需要一点`JavaScript`

```
function createPopup(url) {
    newwindow=window.open(url,'testWindow','height=800,width=600');
    if (window.focus) {newwindow.focus()}
    return false;
} 
```

可以这样使用：

```
<a href="#" onclick="createPopup('http://www.google.com')" target="mine">use google</a>
<a href="#" onclick="createPopup('http://www.stackoverflow.com')" target="mine">use stackoverflow</a> 
```

因此，您可以从*主窗口控制弹出窗口。*

# android - Android 嵌套标签导航 4.2

> ID：14344251
> 
> 赞同：0
> 
> 时间：2013-01-15T18:21:02.020
> 
> 标签：android, tabs

我正在为我的主页导航使用一个 ActionBar，其中包含四个选项卡，指向我的应用程序中的不同区域。

其中一个区域是地图部分，其中应包含两个子选项卡以显示从 SQLite 数据库填充的项目列表。

所以基本上，我想从我的页面片段中实现嵌套导航。我到目前为止的代码是：

```
 //MainActivity.java

            ActionBar actionBar = getActionBar();
    actionBar.setDisplayShowTitleEnabled(true);

    actionBar.setCustomView(R.layout.rowlayout);

    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    LayoutInflater inflater = (LayoutInflater)         this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    RelativeLayout layoutView = (RelativeLayout)inflater.inflate(R.layout.action_bar_tab,   null);
    TextView tabText = (TextView) layoutView.findViewById(R.id.tabText);
    ImageView tabImage = (ImageView) layoutView.findViewById(R.id.tabImage);

    String dayOneName = getResources().getString(R.string.day_one);
    Tab tab = actionBar.newTab();
    tab.setIcon(R.drawable.cal);
    TabListener<AgendaMain> dayOne = new TabListener<AgendaMain>(this,
            dayOneName, AgendaMain.class);
    tab.setTabListener(dayOne); 
    // set custom view
    tabText.setText(dayOneName);
    tabImage.setImageResource(R.drawable.cal);
    tab.setCustomView(layoutView);
    actionBar.addTab(tab);

    // Plus three more navigation tabs

  private class TabListener<T extends Fragment> implements
    ActionBar.TabListener {

    private Fragment mFragment;
    private final Activity mActivity;
    private final String mTag;
    private final Class<T> mClass;

    public TabListener(Activity activity, String tag, Class<T> clz) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
    }

    @Override
    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        // Check if the fragment is already initialized
        if (mFragment == null) {
            // If not, instantiate and add it to the activity
            mFragment = Fragment.instantiate(mActivity, mClass.getName());
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            // If it exists, simply attach it in order to show it
            ft.attach(mFragment);
        }
    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            // Detach the fragment, because another one is being attached
            ft.detach(mFragment);
        }
    }
    @Override
    public void onTabReselected(Tab tab, android.app.FragmentTransaction ft) {
        // User selected the already selected tab. Usually do nothing.
    }
} 
```

上面的选项卡链接到片段，我想在其中添加两个新选项卡，两个选项卡都显示一个 ListFragment。

我尝试从[这里](http://developer.android.com/reference/android/support/v4/app/FragmentTabHost.html)实现 FragmentTabHost ，但在 android.support.v4.app 和 MainActivity.java 的 TabListener 之间遇到问题。到目前为止，所有代码都在工作，只是试图将选项卡添加到片段中！

如果有人可以建议/展示实现这一点的最佳方法，将不胜感激（：到目前为止，我只设法显示静态内容，这不好！（如果需要，我将发布更多代码，我对此表示怀疑）会有所帮助，因为我没有运气！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:36:34.197

TabHost 是一个不推荐使用的解决方案，而是使用 ViewPager，可以在此处找到带有 FragmentPagerAdapter 或 FragmentStatePagerAdapter 实现示例：

[http://developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)
[http://storkme.org/2011/12/tabs-done-right-viewpager-and-fragments/](http://storkme.org/2011/12/tabs-done-right-viewpager-and-fragments/)
[http:// /droidapp.co.uk/2012/05/25/android-dev-actionbarsherlock-tabs-viewpager/](http://droidapp.co.uk/2012/05/25/android-dev-actionbarsherlock-tabs-viewpager/)

# javascript - AJAX 发布后出错

> ID：14344252
> 
> 赞同：1
> 
> 时间：2013-01-15T18:21:03.340
> 
> 标签：javascript, php, jquery, ajax, http-post

我已经制作了其中几个文件，它们都是彼此重复的，只有目的地、触发器，当然变量也发生了变化，因此它们不会相互交互，其他文件可以完美地工作并毫无问题地发布数据，但是这个给我带来了我遇到的问题搜索谷歌不止一次，我只是找不到解决方案，所以我希望有人可以在这里帮助我。

发生了什么：当我单击保存按钮时，它会触发 jquery 将 ajax 发布到 php 文件。php 错误日志说它是一个未定义的索引：

> [Tue Jan 15 18:39:25 2013] [error] [client] PHP Notice: Undefined index: edit_username in

**jQuery**

```
 $(document).ready(function()
{
        $('#hk_save').click(function(e)
    {
        e.preventDefault();
        var formData3 = $('#master_lid').serialize();
        submitdata(formData3);

    });
}); 

function submitdata(formData3) {

    $.ajax({    
        type: 'POST',
        url: 'inc/system/save_lid.php',     
        data: formData3,
        dataType: 'json',
        cache: false,
        async:false,
        timeout: 7000,
        success: function(data) {           

            alert(data.msg);

        }
    }); 
}; 
```

**php**

```
include("./global2.php");
$error_message  = "";

//Sanitize incoming data and store in variable
$username       = trim(stripslashes(htmlspecialchars($_REQUEST['edit_username'])));
$mail       = trim(stripslashes(htmlspecialchars($_REQUEST['edit_mail'])));

if(!empty($username))
{

    $query = mysql_query("UPDATE users SET mail = '".$mail."'WHERE username = '".$username."' ");

$result ='Gebruiker "'.$username.'" is met success gewijzigd.';
}
else
{
    $result = "Ow nee!, er heeft zich een error voorgedaan!";
}

            $return['msg'] = $result; 
            echo json_encode($return);
    exit; 
```

是的，我已经检查了拼写错误等字段，并且知道它们是正确的。

# ruby-on-rails-3 - 上面的 ROR 代码是如何变成 HTML 代码的？

> ID：14344254
> 
> 赞同：-2
> 
> 时间：2013-01-15T18:21:25.740
> 
> 标签：ruby-on-rails-3

```
<div class="row">
<div class="span6 offset3">
<%= form_for(:session, url: sessions_path) do |f| %>

  <%= f.label :email %>
  <%= f.text_field :email %>

  <%= f.label :password %>
  <%= f.password_field :password %>

  <%= f.submit "Sign in", class: "btn btn-large btn-primary" %>
<% end %>

<p>New user? <%= link_to "Sign up now!", signup_path %></p> 
```

上面的 Rails 代码是如何变成下面的 HTML 代码的？

```
<form accept-charset="UTF-8" action="/sessions" method="post">
  <div>
    <label for="session_email">Email</label>
    <input id="session_email" name="session[email]" size="30" type="text" />
  </div>
  <div>
    <label for="session_password">Password</label>
    <input id="session_password" name="session[password]" size="30" 
           type="password" />
  </div>
  <input class="btn btn-large btn-primary" name="commit" type="submit" 
       value="Sign in" />
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:27:14.083

看看[Rails 表单助手](http://guides.rubyonrails.org/form_helpers.html)。

# gwt - GWT - 动态页面大小

> ID：14344264
> 
> 赞同：0
> 
> 时间：2013-01-15T18:21:52.253
> 
> 标签：gwt

我正在探索一些常见问题的可能解决方案（欢迎您的意见）。为了清楚起见，我已经简化了问题。

假设我有一个显示多个矩形框的小部件。每个盒子都有相同的静态宽度和高度。有很多超过 1000 个的盒子，这个数字会随着时间的推移而增长。

我正在考虑使用分页来显示框。我想**避免使用滚动条**。因此，我想根据页面大小动态更改每个页面上显示的框数。

解决这个问题的最好方法是什么，起初我想如果容器小部件实现`RequiresResize` [我应该能够捕获小部件的尺寸](https://stackoverflow.com/questions/14331259/gwt-resizable-composite)。但我认为我需要让每个父小部件也实现`RequiresResize`and `ProvidesResize`.

有没有更好的办法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T21:27:20.573

在 vanilla GWT 项目中，最简单的方法是使用布局面板类 - 这些使用您提到的`RequiresResize`和接口。`ProvidesResize`最好的开始方法不是使用`RootPanel`，而是使用`RootLayoutPanel`. 此替代起点包装单个`RootPanel`实例，并通过调用`RequiresResize.onResize`它是否存在来将其大小调整为可用的浏览器空间。

然后，您的小部件树的其余部分（添加到父级的子级等）也应该使用这些接口来声明它们需要调整大小信息。很有可能您实际上不会构建任何不构建的小部件，而是将现有的小部件（使用 UiBinder 或 Composite）包装到新的小部件中 - 诀窍在于您正在制作一个新的小部件，并且通过默认一个不实现`ProvidesResize`or `RequiresResize`。构建应用程序时的两个基本解决方案：

*   实现这两个接口。然后，在您的`onResize()`方法中，调用`onResize()`需要知道其大小已更改的顶级小部件。这允许更多的控制，但需要更明确的代码来调整大小。最简单的方法是扩展`ResizeComposite`而不是`Composite`. 或者，

*   不要扩展 Widget（即不要扩展`Composite`/ `ResizeComposite`/etc），而是实现`IsWidget`. 这将让您避免向树中添加新`Widget`类型，而只需将您正在使用的所有小部件分组到碰巧构建和设置它们的类型中。这是我的首选 - 它看起来不像一个小部件，通常更容易模拟，等等。现在你需要有一个`asWidget()`方法来返回你的小部件结构的基础 - 添加到任何东西都会直接与之对话（并且直接调用它`onResize()`），让您忽略他们需要如何交互的细节。这是我的首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:21:12.430

这要简单得多：

```
Window.addResizeHandler(new ResizeHandler() {

    @Override
    public void onResize(ResizeEvent event) {
        resize();
    }

});

private void resize() {
        // Measure your widget
        // Decide how many squares to display
} 
```

当您的视图首次加载时，您将需要调用 resize()，然后任何窗口调整大小都会触发此方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T20:30:09.993

如果您想要调整事件大小，您只需要实现 RequiresResize 并维护 Provides/RequiresResize 链。但是在您的情况下，您只想知道窗口或容器的大小，而不是 resize 事件（至少，这是我从您的问题中推断出来的）。

在这种情况下，您可以在决定分页之前使用容器小部件的 getOffsetWidth() 和 getOffsetHeight() 方法（请参阅[http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt /user/client/ui/UIObject.html#getOffsetHeight()](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/user/client/ui/UIObject.html#getOffsetHeight%28%29)）。

另一方面，如果您需要在窗口大小更改时重新布局，那么您必须按照您的说法使用 Provides/RequireResize。如果您不想保持完整的层次结构，只需在根布局面板中放置一个隐藏的 LayoutPanel 并将调整大小事件路由到您想要的任何内容。不是一个非常干净的解决方案，而是一个解决方案......

# ruby - 正则表达式匹配 Ruby 中已知字符串后的 1-3 位数

> ID：14344275
> 
> 赞同：4
> 
> 时间：2013-01-15T18:22:19.687
> 
> 标签：ruby, regex, string, numbers

我需要匹配以下字符串中的数字。它们可能是其中包含其他数字的较长字符串的一部分，因此我特别想匹配**紧跟在文本“错误代码”后面的空格之后出现的数字**：

```
Error Code 0  # Match = 0
Error Code 45 # Match = 45
Error Code 190 # Match = 190 
```

也可以：

```
Some Words 12 Error Code 67 Some Words 77 # Match = 67 
```

我正在使用`someString.match(regEx)[0]`，但我无法正确使用正则表达式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-15T18:24:36.897

```
/(?:Error Code )[0-9]+/ 
```

这使用了一个非捕获组（并非在所有正则表达式实现中都可用。）它会说，嘿，字符串最好有这个短语，但我不希望这个短语成为我匹配的一部分，只是后面的数字。

如果您只想匹配 1 到 3 位数字：

```
/(?:Error Code )[0-9]{1,3}/ 
```

使用 Ruby，您的正则表达式应该会遇到很少的限制。除了条件之外，Ruby 的正则表达式并没有什么不能做的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-15T18:50:02.323

给定字符串“错误代码 190”，这将返回“190”，而不是像此处提供的其他正则表达式示例那样返回“错误代码”。

```
(?<=Error Code.*)[0-9] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T18:41:54.313

我会使用以下正则表达式：

```
/Error\sCode\s\d{1,3}/ 
```

或者，使用命名组：

```
/Error\sCode\s(?<error_code>\d{1,3})/ 
```

最后一个将捕获命名组下的错误代码，即数字。请注意，`\s`匹配空格，但除非指定 x 标志，否则它是不必要的。您可以像这样访问比赛捕获：

```
str = "Error Code 0\nError Code 45\nError Code 190"
error_codes = str.lines.map{|l|l.match(regex)[:error_code]}
#=> ["0", "45", "190"] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-12T14:37:13.683

您可以使用此正则表达式：仅数字，从 1 计数到 3：

```
regexp = "^\\d{1,3}$" 
```

# apache-flex - 与 Flex4 的深度链接

> ID：14344276
> 
> 赞同：1
> 
> 时间：2013-01-15T18:22:21.403
> 
> 标签：apache-flex, flex4, struts, deep-linking

我正在向混合`Flex4/Struts`应用程序添加深度链接。

`Flex4`1）关于深度链接有什么新东西吗？如果我没记错的话，标准`Flex3`的深度链接很麻烦，而且并不总是适用于所有平台上的所有浏览器。还是这样吗？那么`SWFAddress`仍然是大多数人用于 DL 的那个吗？

2）我可以避免使用`"#"`时使用`SWFAddress`吗？这对我使用“？”非常有用。因为我可能需要将它与`Struts`.

3）如果我需要通过从 Flex 到的链接传递参数，`Struts`反之亦然，这是否可能？比如说，我需要转发到特定选项卡并在该页面上填充一些值（并可选择提交）。至少可以`Flex-to-Flex`以防万一吗？

任何代码示例？

请指教。

# php - PHP将单个文本框的值放入数组中

> ID：14344278
> 
> 赞同：0
> 
> 时间：2013-01-15T18:22:27.597
> 
> 标签：php, arrays, textbox

所以我有这个“表格”和一个包含文章的数据库。我想要做的是：我有一个名为“inputaddtobill”的文本框，当焦点被释放时，一个按钮被自动按下。

现在在文本框中，应该放置条形码。那些条形码指的是文章名称。每当我在文本框中输入条形码时，应显示相应的文章，当我放入下一个条形码时，应显示 2 篇文章

这是我的html

```
<html>
<head>
<title>Verkoop</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="../js/artverklostfoc.js"></script>
<link rel="icon" href="../img/favicon.png">
<link rel="stylesheet" href="../css/style.css"/>
</head>
<body>
<form method="post" action="kassaverkoop.php?a=b" name="frmkassaverkoop">
<input type='text' onBlur='lostFocus()' name='inputaddtobill' class='inputaddtobill'>
<input type='submit' value='toevoegen' name='butaddtobill' id='butaddtobill' />
</form>
</body>
</html> 
```

这是我的 php

```
<?php
include "connect_to_mysql.php";
if(isset($_GET['a']) && $_GET['a'] == 'b')
{
    $input = array($_POST['inputaddtobill']);
    $queryart = mysql_query("SELECT * FROM tbl_artikel WHERE FLD_Barcode IN ($input)");

    while ($row = mysql_fetch_array($queryart))
    {
        echo $row['FLD_Artikel'];
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:30:19.787

您的代码将不起作用。

```
$input = array($_POST[...']); 
```

在索引 0 处创建一个具有单个值的数组 - 来自 $_POST 的值。

然后，您可以直接在查询中使用 $input。这意味着您在字符串上下文中使用数组，这意味着您实际上会将单词插入`Array`到查询字符串中并最终得到

```
SELECT ... WHERE FLD_Barcode IN (Array) 
```

另外，请注意，即使这可行，您也将直接将用户提供的数据插入到查询字符串中，从而使您容易受到[SQL 注入攻击](http://bobby-tables.com)。

# excel - 宏的溢出错误以提出列项的所有可能组合

> ID：14344280
> 
> 赞同：1
> 
> 时间：2013-01-15T18:22:31.073
> 
> 标签：excel, vba, combinations

所以我有这个宏，它遍历 7 列并返回 7 个其他列，其中包含前 7 列的每个组合。

我遇到的错误是我使用上限来获取列表中的项目数。我不知道为什么，但是当我在一列中只有一项时出现溢出错误。我认为 VBA 不是做到这一点的最佳方法，但我们对数据的其余工作都是在 excel 中完成的，因此保持它关闭更容易。

它在这一行溢出 Set out1 = Range("K2", Range("Q2").Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4) * UBound(c5) * UBound( c6) * UBound(c7)))

我在 StackOverflow 上找到了相同组合问题的递归解决方案，但是当一列只有 1 个项目时，它会遇到同样的问题。我应该做一个if案例吗？我认为它必须是没有计算出上限的东西。这是代码。

```
Sub Final()

Dim c1() As Variant
Dim c2() As Variant
Dim c3() As Variant
Dim c4() As Variant
Dim c5() As Variant
Dim c6() As Variant
Dim c7() As Variant
Dim out() As Variant
Dim j, k, l, m, n, o, p, q As Long

Dim col1 As Range
Dim col2 As Range
Dim col3 As Range
Dim col4 As Range
Dim col5 As Range
Dim col6 As Range
Dim col7 As Range
Dim out1 As Range

Set col1 = Range("A2", Range("A2").End(xlDown))
Set col2 = Range("B2", Range("B2").End(xlDown))
Set col3 = Range("C2", Range("C2").End(xlDown))
Set col4 = Range("D2", Range("D2").End(xlDown))
Set col5 = Range("E2", Range("E2").End(xlDown))
Set col6 = Range("F2", Range("F2").End(xlDown))
Set col7 = Range("G2", Range("G2").End(xlDown))

c1 = col1
c2 = col2
c3 = col3
c4 = col4
c5 = col5
c6 = col6
c7 = col7

Set out1 = Range("K2", Range("Q2").Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4) * UBound(c5) * UBound(c6) * UBound(c7)))
out = out1

j = 1
k = 1
l = 1
m = 1
n = 1
o = 1
p = 1
q = 1

Do While j <= UBound(c1)
    Do While k <= UBound(c2)
        Do While l <= UBound(c3)
            Do While m <= UBound(c4)
                Do While n <= UBound(c5)
                    Do While o <= UBound(c6)
                        Do While p <= UBound(c7)
                            out(q, 1) = c1(j, 1)
                            out(q, 2) = c2(k, 1)
                            out(q, 3) = c3(l, 1)
                            out(q, 4) = c4(m, 1)
                            out(q, 5) = c5(n, 1)
                            out(q, 6) = c6(o, 1)
                            out(q, 7) = c7(p, 1)
                            q = q + 1
                            p = p + 1
                        Loop
                        p = 1
                        o = o + 1
                    Loop
                    o = 1
                    n = n + 1
                Loop
                n = 1
                m = m + 1
            Loop
            m = 1
            l = l + 1
        Loop
        l = 1
        k = k + 1
    Loop
    k = 1
    j = j + 1
Loop

out1.Value = out 
```

谢谢你的帮助。而且我知道这不是最好的代码，但它可以工作。

**解决方案**

```
 Set col1 = Range(Range("A2"), Range("A" & Rows.Count).End(xlUp))
Set col2 = Range(Range("B2"), Range("B" & Rows.Count).End(xlUp))
Set col3 = Range(Range("C2"), Range("C" & Rows.Count).End(xlUp))
Set col4 = Range(Range("D2"), Range("D" & Rows.Count).End(xlUp))
Set col5 = Range(Range("E2"), Range("E" & Rows.Count).End(xlUp))
Set col6 = Range(Range("F2"), Range("F" & Rows.Count).End(xlUp))
Set col7 = Range(Range("G2"), Range("G" & Rows.Count).End(xlUp))

If col1.Cells.Count = 1 Then
    ReDim c1(1 To 1, 1 To 1)
    c1(1, 1) = col1.Value
Else
    c1 = Range(Range("A2"), Range("A" & Rows.Count).End(xlUp))
End If
If col2.Cells.Count = 1 Then
    ReDim c2(1 To 1, 1 To 1)
    c2(1, 1) = col1.Value
Else
    c2 = Range(Range("B2"), Range("B" & Rows.Count).End(xlUp))
End If
    If col3.Cells.Count = 1 Then
    ReDim c3(1 To 1, 1 To 1)
    c3(1, 1) = col3.Value
Else
    c3 = Range(Range("C2"), Range("C" & Rows.Count).End(xlUp))
End If
If col4.Cells.Count = 1 Then
    ReDim c4(1 To 1, 1 To 1)
    c4(1, 1) = col4.Value
Else
    c4 = Range(Range("D2"), Range("D" & Rows.Count).End(xlUp))
End If
    If col5.Cells.Count = 1 Then
    ReDim c5(1 To 1, 1 To 1)
    c5(1, 1) = col5.Value
Else
c5 = Range(Range("E2"), Range("E" & Rows.Count).End(xlUp))
End If
If col6.Cells.Count = 1 Then
    ReDim c6(1 To 1, 1 To 1)
    c6(1, 1) = col6.Value
Else
    c6 = Range(Range("F2"), Range("F" & Rows.Count).End(xlUp))
End If
If col7.Cells.Count = 1 Then
    ReDim c7(1 To 1, 1 To 1)
    c7(1, 1) = col7.Value
Else
    c7 = Range(Range("G2"), Range("G" & Rows.Count).End(xlUp))
End If 
```

这将数组重新设置为 1 乘 1，因此它们匹配 1 个单元格的范围。现在适用于 1 件以上的物品。感谢大家的帮助。

# android - 按姓氏和名字搜索android联系人并获取raw_id

> ID：14344281
> 
> 赞同：0
> 
> 时间：2013-01-15T18:22:32.683
> 
> 标签：android

我尝试同步 android 联系人。我想使用名字和姓氏来识别联系人并使用 raw_id 更新它，但我不知道如何搜索姓氏和姓氏。我查看了示例文件，但只有用于搜索（和同步）raw_id 的描述！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:35:04.183

作为单独字段的“家庭”名称不是联系人表的一部分。

Contacts 表中的行由提供程序自动生成。通常，一个联系人行聚合 ContactsContract.RawContacts 中的一个或多个原始联系人。每个原始联系人都有一个包含姓氏的 StructuredName 行。

要执行您描述的搜索，请在 FAMILY_NAME 和 GIVEN_NAME 上搜索 ContactsContract.CommonDataKinds.StructuredName。提供一个包含 LOOKUP_KEY 的投影，它是您想要的 ContactsContract.Contacts 行的“永久”链接。

唉，这仅基于文档。LOOKUP_KEY*应该*是对 StructuredName 的查询可用的列的一部分，但我已经看到文档与实现不匹配的其他情况。显然，开发人员有时会包含一个已实现的列名列表，但实际上似乎并没有实现返回它们。

此外，原始响应使用了 getContentResolver()。请尽可能使用 CursorLoader。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:54:34.667

只需使用查询命令的选择参数。

```
Cursor cursor = Cursor cursor = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI,null, ContactsContract.Contacts.DISPLAY_NAME + "=" + familyName, null, null); 
```

然后遍历您的光标并查找 id：

```
String id = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts._ID)); 
```

您还可以创建一个完整的 DataSource 类并使调用更容易。

# sql - MS SQL：自动增加的密钥冲突

> ID：14344286
> 
> 赞同：4
> 
> 时间：2013-01-15T18:22:52.173
> 
> 标签：sql, sql-server

> **可能重复：**
> [获取插入行标识的最佳方法？](https://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row)

假设有一个大型 Web 应用程序，例如具有许多在线用户的社交网络。

用户不断向某个表插入新行。此应用程序在每次插入后都需要新行的**ID ，并且此****ID**是自动增加的`int`列。

获取最后一个 raw 的 ID 是由 SQL`SELECT IDENT_CURRENT()`作为一个单独的函数调用通过 Web 应用程序为每个用户完成的。

如果多个用户同时插入行，它是否正常工作并返回正确的**ID ？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:37:59.990

另一个存档版本...

```
Insert Atab (na,nu)
OUTPUT INSERTED.id  
values('Text','Add') 
```

> 从受 INSERT、UPDATE、DELETE 或 MERGE 语句影响的每一行返回信息或表达式。这些结果可以返回到处理应用程序，以用于诸如确认消息、归档和其他此类应用程序要求之类的事情。结果也可以插入到表或表变量中。此外，您可以在嵌套的 INSERT、UPDATE、DELETE 或 MERGE 语句中捕获 OUTPUT 子句的结果，并将这些结果插入到目标表或视图中。

[参考](http://msdn.microsoft.com/en-us/library/ms177564%28SQL.105%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T20:19:53.570

我们公司的某个人使用了 ident_current，他应该使用 scope_identity（现在应该使用 OUTPUT）。碰巧应用程序正在插入一条记录，同时正在运行数百万条记录的数据导入。在随后的记录导入中，错误的 ID 附加到了子记录，导致数据完整性问题需要很长时间才能解决。在任何情况下都不应使用 ident_current 来获取刚刚插入的值。它是数据完整性问题的**保证**。

如果您使用的 SQL Server 版本具有可用的 OUTPUT，则这是首选技术。OUTPUT 不仅会为您提供刚刚插入的 id，而且还可以为您提供其他插入的值，以便您可以更轻松地获取多个记录插入的值以及单个记录您还可以使用它来找出删除的内容或更新。所以它是一个非常有价值的工具。基本上，您使用所需的列设置表变量，然后在 INSERT、UPDATE 或 DELETE 中使用 OUTPUT 子句，然后您可以使用表变量来获取其他处理步骤所需的信息。一些示例可以查看您可以在插入语句中对输出执行哪些操作：

```
DECLARE @MyTableVar table( MyID int,
                           MyName varchar(50));

INSERT MyTable1 (MYName)
    OUTPUT INSERTED.MyID, INSERTED.MyName
        INTO @MyTableVar
VALUES ('test');

--Display the result set of the table variable.
SELECT MyID, MyName FROM @MyTableVar;
--Display the result set of the table.
Insert into table2 (MyID,test2, test2)
SELECT MyID, 'mttest1', 'mytest2'  FROM @MyTableVar;

Insert into table2 (MyID,field1, InsertedDate)
SELECT MyID, s.Field1, getdate()  FROM @MyTableVar t
join stagingtable s on t.MyName =  s.MyName 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T18:28:08.407

您可能想改用 SCOPE_IDENTITY() 。以下是@@IDENTITY、IDENT_CURRENT() 和 SCOPE_IDENTITY 之间差异的细分（从[这里](http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/)窃取）：

> SELECT @@IDENTITY 它返回在连接上产生的最后一个 IDENTITY 值，而不管产生该值的表，也不管产生该值的语句的范围。@@IDENTITY 将返回在当前会话中输入到表中的最后一个标识值。虽然@@IDENTITY 仅限于当前会话，但它不限于当前范围。如果您在一个表上有一个触发器导致在另一个表中创建一个身份，您将获得最后创建的身份，即使它是创建它的触发器。
> 
> SELECT SCOPE_IDENTITY() 它返回连接上和同一范围内的语句生成的最后一个 IDENTITY 值，而不管生成该值的表。SCOPE_IDENTITY() 与@@IDENTITY 一样，将返回在当前会话中创建的最后一个身份值，但它也会将其限制在您当前的范围内。换句话说，它将返回您显式创建的最后一个身份值，而不是由触发器或用户定义的函数创建的任何身份。
> 
> SELECT IDENT_CURRENT('tablename') 它返回表中生成的最后一个 IDENTITY 值，与创建该值的连接无关，也与生成该值的语句的范围无关。IDENT_CURRENT 不受范围和会话限制；它仅限于指定的表。IDENT_CURRENT 返回为任何会话和任何范围内的特定表生成的标识值。

如您所见，SCOPE_IDENTITY() 将通过范围内的语句返回当前连接生成的最后一个 ID。根据您的要求，这听起来会更好地满足您的需求。

# jquery - Fancybox 不适用于 jQuery v1.9.0 [ f.browser 未定义 / 无法读取属性 'msie' ]

> ID：14344289
> 
> 赞同：103
> 
> 时间：2013-01-15T18:23:02.577
> 
> 标签：jquery, fancybox, fancybox-2

Fancybox 与新的 jQuery v1.9.0 不同。

**它同时影响 Fancybox v1.3.4 及更低版本 - 和 - v2.1.3 及更低版本。**

显示的错误是：

v1.3.4：

```
Timestamp: 15/01/2013 10:03:28 AM
Error: TypeError: b.browser is undefined
Source File: ...fancybox/jquery.fancybox-1.3.4.pack.js
Line: 18 
```

...其他错误

```
Uncaught TypeError: Cannot read property 'msie' of undefined jquery.fancybox-1.3.4.pack.js:18
Uncaught TypeError: Object [object Object] has no method 'fancybox' 
```

在 v2.1.3 中：

```
Timestamp: 15/01/2013 10:09:58 AM
Error: TypeError: $.browser is undefined
Source File: h.../fancybox2.1.3/jquery.fancybox.js
Line: 139 
```

如果您使用它来调用 jQuery ：

```
<script src="http://code.jquery.com/jquery-latest.js"></script> 
```

...**您现有的任何幻想盒实现都将失败！**

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2013-01-15T18:23:02.577

似乎这里报告的 jQuery 中存在一个错误：**[http](http://bugs.jquery.com/ticket/13183)** ://bugs.jquery.com/ticket/13183，它破坏了 Fancybox 脚本。

另请查看**[https://github.com/fancyapps/fancyBox/issues/485](https://github.com/fancyapps/fancyBox/issues/485)**以供进一步参考。

作为一种解决方法，在修复 jQuery 错误或修补 Fancybox 时回滚到**[jQuery v1.8.3 。](http://code.jquery.com/jquery-1.8.3.js)**

* * *

**更新**（2013 年 1 月 16 日）：Fancybox **[v2.1.4](http://www.fancyapps.com/fancybox/#license)**已经发布，现在它可以与 jQuery v1.9.0 一起正常工作。

~~对于fancybox v1.3.4-您仍然需要回滚到**[jQuery v1.8.3](http://code.jquery.com/jquery-1.8.3.js)**或应用@Manu的回答所指出的**[迁移脚本。](http://code.jquery.com/jquery-migrate-1.0.0.js)**~~

* * *

**更新**（2013 年 1 月 17 日）：**Fancybox v1.3.4**用户的解决方法：

修补**[fancybox js 文件](http://fancybox.net/js/fancybox-1.3.4/jquery.fancybox-1.3.4.js)**，使其与 jQuery v1.9.0 一起工作，如下所示：

1.  使用 text/html 编辑器打开*jquery.fancybox-1.3.4.js*文件（完整版，**而不是打包版）。**
2.  在第 29 行附近找到它说：

    ```
    isIE6 = $.browser.msie && $.browser.version < 7 && !window.XMLHttpRequest, 
    ```

    并将其替换为（**2013**年 3 月 19 日编辑：更准确的过滤器）：

    ```
    isIE6 = navigator.userAgent.match(/msie [6]/i) && !window.XMLHttpRequest, 
    ```

    **更新**（2013 年 3 月 19 日）：也替换`$.browser.msie`为`navigator.userAgent.match(/msie [6]/i)`第 615 行左右（和/或替换所有`$.browser.msie`实例，如果有的话），谢谢[joofow](https://stackoverflow.com/users/2073656/joofow) ...就是这样！

**[或者从这里](http://www.picssel.com/playground/jquery/fancybox/jquery.fancybox-1.3.4_patch.zip)**下载已经打过补丁的版本（2013 年 3 月 19 日更新......感谢[fairylee](https://stackoverflow.com/users/1189971/fairylee)指出额外的右括号）

**注意**：这是一个非官方的补丁，Fancybox 的作者不支持它，但它可以按原样工作。您可以自行承担使用它的风险；）

或者，您可能宁愿回滚到**[jQuery v1.8.3](http://code.jquery.com/jquery-1.8.3.js)**或应用@Manu的回答所指出的**[迁移脚本。](http://code.jquery.com/jquery-migrate-1.0.0.js)**

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-01-16T10:04:50.693

嗨，这是由于新版本的 jQuery => 1.9.0

您可以查看更新： [http ://blog.jquery.com/2013/01/15/jquery-1-9-final-jquery-2-0-beta-migrate-final-released/](http://blog.jquery.com/2013/01/15/jquery-1-9-final-jquery-2-0-beta-migrate-final-released/)

jQuery.Browser 已弃用。您可以通过添加迁移脚本来保持最新版本：http: [//code.jquery.com/jquery-migrate-1.0.0.js](http://code.jquery.com/jquery-migrate-1.0.0.js)

代替 ：

```
<script src="http://code.jquery.com/jquery-latest.js"></script> 
```

经过 ：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.0.0.js"></script> 
```

在您的页面及其工作中。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-03-22T22:40:45.630

全局事件也被弃用。

这是一个补丁，它修复了浏览器和事件问题：

```
--- jquery.fancybox-1.3.4.js.orig   2010-11-11 23:31:54.000000000 +0100
+++ jquery.fancybox-1.3.4.js    2013-03-22 23:25:29.996796800 +0100
@@ -26,7 +26,9 @@

        titleHeight = 0, titleStr = '', start_pos, final_pos, busy = false, fx = $.extend($('<div/>')[0], { prop: 0 }),

-       isIE6 = $.browser.msie && $.browser.version < 7 && !window.XMLHttpRequest,
+       isIE = !+"\v1",
+       
+       isIE6 = isIE && window.XMLHttpRequest === undefined,

        /*
         * Private methods 
@@ -322,7 +324,7 @@
            loading.hide();

            if (wrap.is(":visible") && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
-               $.event.trigger('fancybox-cancel');
+               $('.fancybox-inline-tmp').trigger('fancybox-cancel');

                busy = false;
                return;
@@ -389,7 +391,7 @@
                        content.html( tmp.contents() ).fadeTo(currentOpts.changeFade, 1, _finish);
                    };

-                   $.event.trigger('fancybox-change');
+                   $('.fancybox-inline-tmp').trigger('fancybox-change');

                    content
                        .empty()
@@ -612,7 +614,7 @@
            }

            if (currentOpts.type == 'iframe') {
-               $('<iframe id="fancybox-frame" name="fancybox-frame' + new Date().getTime() + '" frameborder="0" hspace="0" ' + ($.browser.msie ? 'allowtransparency="true""' : '') + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content);
+               $('<iframe id="fancybox-frame" name="fancybox-frame' + new Date().getTime() + '" frameborder="0" hspace="0" ' + (isIE ? 'allowtransparency="true""' : '') + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content);
            }

            wrap.show();
@@ -912,7 +914,7 @@

        busy = true;

-       $.event.trigger('fancybox-cancel');
+       $('.fancybox-inline-tmp').trigger('fancybox-cancel');

        _abort();

@@ -957,7 +959,7 @@
            title.empty().hide();
            wrap.hide();

-           $.event.trigger('fancybox-cleanup');
+           $('.fancybox-inline-tmp, select:not(#fancybox-tmp select)').trigger('fancybox-cleanup');

            content.empty(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-12-13T04:34:01.360

如果有人仍然需要使用 jQuery 3.0+ 来支持旧版 fancybox，您还需要进行一些其他更改：

**.unbind() 已弃用**

将所有实例替换`.unbind`为`.off`

**.removeAttribute() 不是函数**

将第 580-581 行更改为使用 jQuery `.removeAttr()`：

旧代码：

```
580: content[0].style.removeAttribute('filter');
581: wrap[0].style.removeAttribute('filter'); 
```

新代码：

```
580: content.removeAttr('filter');
581: wrap.removeAttr('filter'); 
```

这与上面提到的其他补丁相结合解决了我的兼容性问题。

# django - Django：类别列表 - 视图

> ID：14344291
> 
> 赞同：0
> 
> 时间：2013-01-15T18:23:05.910
> 
> 标签：django, django-generic-views

我在models.py中有模型：

```
class Category(models.Model):
    name = models.CharField('Nazwa Kategorii', max_length=100)
    slug = models.SlugField('Odnośnik', unique=True, max_length=100)
    icon = models.ImageField('Ikonka Kategorii', upload_to='icons',
                              blank=True)
    class Meta:
        verbose_name = "Kategoria"
        verbose_name_plural = "Kategorie"

    def __unicode__(self):
        return self.name 
```

我想查看所有类别的列表：views.py

```
class CategoryList(generic.ListView):
    model = models.Category
    context_object_name = 'category_list'
category_list = CategoryList.as_view() 
```

在 base.html 我有：

```
{% for entry in category_list %}
<li><a href="#">{{ entry.name }} </a></li>
{% endfor %} 
```

但它不会返回任何类别。我想念什么？我想添加带有类别列表的基本模板菜单..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:55:15.953

您不应期望为 base.html 设置**category_list上下文变量。**CategoryList 类视图默认使用模板'< app_name >/category_list.html'。您可以通过为此视图设置**template_names属性来更改此设置。**

如果您希望在所有模板中都可以访问“category_list”上下文变量（考虑到您尝试在 base.html 中使用，这是可能的），您需要定义[上下文处理器](https://docs.djangoproject.com/en/dev/ref/templates/api/#writing-your-own-context-processors)并将此变量添加到上下文中。

您需要的上下文处理器可能如下所示：

```
def menu_processor(request):
    return {
        'category_list': Category.objects.all() 
    } 
```

一旦你在代码中的某个地方定义了这个函数（在相关应用程序中放入 context_processors.py 是一个很好的做法），你需要在 TEMPLATE_PROCESSORS 设置变量中注册它（参见上面的 django 文档链接以供参考）。

这里要提到的最后一件事是您应该考虑缓存查询结果，因为此代码将在每个请求上执行。

# context-free-grammar - 为什么这不是CFG？

> ID：14344294
> 
> 赞同：0
> 
> 时间：2013-01-15T18:23:11.910
> 
> 标签：context-free-grammar, automata, pushdown-automaton

虽然这是对此的重复，[但](https://stackoverflow.com/questions/7615112/why-is-this-not-context-free-grammer)我是在设计 PDA 方面进行讨论。

现在，我知道我错了，因为这是一个广为人知的例子，但我在下面的 PDA 设计中哪里出错了？

我想接受语言`{a^n b^n c^n: n>=0}`

`1`每次遇到一个`a`, 弹出一个 for`b`并弹出一个 for时，我都会在堆栈上压入两个，`c`并检查我是否有一个空堆栈。我将转换函数（最小）定义为：

`(q0, a, Z) = (q0, 11Z)`
`(q0, a, 1) = (q0, 111)`
`(q0, b, 1) = (q1, delta)`
`(q1, c, 1) = (q2, delta)`
`(q2, delta, Z) = (q-Final, Z) (epsilon move)`

`Z is empty stack`

这个PDA不接受这样的语言吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:26:15.580

您的 PDA 接受以下语言：

```
{a^n b^i c^j; n >= 0 and i + j = 2n} 
```

这`{a^n b^n c^n: n>=0}`与上述语言的子集不同，特别是当`i = n`和`j = n`。

# javascript - 如何显示用户在上一页选择的位置的谷歌地图（例如：佐治亚州亚特兰大）

> ID：14344295
> 
> 赞同：0
> 
> 时间：2013-01-15T18:23:11.433
> 
> 标签：javascript, google-maps

请参阅下面设置为纬度和经度的简单谷歌地图示例。此代码可以用于此目的，但需要用户选择的城市、州的 php echo 来代替 Lat Long 显示。任何人都可以概述使其执行的代码吗？希望与 Google Maps API v3 兼容。非常感谢。

```
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
    <script type="text/javascript"

      src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&sensor=SET_TO_TRUE_OR_FALSE">
    </script>

    <script type="text/javascript">
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);
      }
    </script>

  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
  </body>
</html> 
```

过去，我使用以下代码来显示城市、州：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=true&amp;key=BQIAAAAmGS6pKWpRUcdw4oR9pzpvBQzjcAJnzRmzqULnEw6fdi4mPoYnxR1kxeM4lTW9o75OG9vfiUP8DKkig" type="text/javascript"></script>    
    <script type="text/javascript">
    var map = null;
    var geocoder = null;
    function initialize() {
      if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById("map_canvas"));
        map.setMapType(G_HYBRID_MAP);
        disableDefaultUI: true;
        map.enableScrollWheelZoom();
        geocoder = new GClientGeocoder();
      }
        showAddress("<?php echo $_SESSION['city_name']; ?>");
    }
    function showAddress(address) {
      if (geocoder) {
        geocoder.getLatLng(
          address,
          function(point) {
            if (!point) {
            //alert(address + " not found");
            } else {
            map.setCenter(point, 13);
            map.setZoom(13);
            }
          }
        );
      }
    }
</script>

</head>

<body onload="initialize()" onunload="GUnload()"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:55:35.860

代码从[geocode-with-google-maps-api-v3](http://tech.cibul.net/geocode-with-google-maps-api-v3/)复制并重新组织，使其看起来像您的旧代码。

```
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0; padding: 0 }
        #map_canvas { height: 100% }
    </style>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY&sensor=false"></script>
    <script type="text/javascript">
        var geocoder;
        var map;
        var marker;

        function initialize() {
            var latlng = new google.maps.LatLng(-34.397, 150.644);
            var mapOptions = {
                zoom: 8,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
            geocoder = new google.maps.Geocoder();
            marker = new google.maps.Marker({
                map: map,
                draggable: true
            });

            showAddress('Ljubljana');
        }

        function showAddress(address) {
            geocoder.geocode({'address': address}, function(results, status) {
                if (status != google.maps.GeocoderStatus.OK) {
                    return;
                }
                if (results.length > 1) {
                    alert('Multiple addresses found; showing first one ...');
                }
                $.each(results, function(i, item) {
                    var location = new google.maps.LatLng(item.geometry.location.lat(), item.geometry.location.lng());
                    marker.setPosition(location);
                    map.setCenter(location);
                    return false;
                });
            });
        }
    </script>
</head>
<body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html> 
```

# ios - IOS：Sqlite。快速查找记录

> ID：14344300
> 
> 赞同：3
> 
> 时间：2013-01-15T18:23:23.447
> 
> 标签：ios, objective-c, sql, xcode, sqlite

我正在构建一个拼字游戏，并且正在根据 wordDictionary 验证单词。

在我的第一次尝试中，我将字典加载到一个数组中并进行了二进制搜索以进行验证。

现在我改用 sqlite，所以我不必将整个 dict 保存在内存中，并减少加载时间。

我有两个挑战：

1.  查询数据库以查看其中是否存在单词的最有效方法是什么？

2.  我如何为一组字母找到所有可能的单词...当我将 wordDictionary 放在一个数组中时，我可以遍历整个内容并验证每个单词。查询每一行（约 700,000 行）并使用 sqlite 进行验证会非常慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:23:45.093

“明显”的解决方案是建立一个索引。但是，如果您在内存中的二进制搜索不起作用，我不太确定索引是否能解决问题。它将占用大约相同数量的内存。

如果您可以搜索可能的匹配项，一次从外部内存中获取少量，然后快速进行比较，那不是很好吗？

这可以通过数据库实现。这个想法是创建一个“哈希”函数。具有相同哈希值的所有内容都将存储在单词表中。然后将其提取到内存中进行搜索。

一旦获得具有相同哈希的单词集，您就可以自己进行搜索，或者这可能有效：

```
select word
from (select word
      from words
      where hash(word) = hash(YOURWORD)
     ) t
where t.word = YOURWORD 
```

关键是先“欺骗” SQL 编译器使用哈希索引，然后再进行比较。

一个非常简单的散列函数可能是前五个字母。因此，像“间谍”这样的词只有一个条目。但是，像“multi”这样的词会有很多。您的单词表将有两列，“word”和“hash”。然后，您将在 hash 上有一个索引。. . 为了获得最佳性能，请按哈希对单词表进行排序。对单词列表进行排序后，所有匹配的单词很有可能会在一页或两页上，从而最大限度地减少外部 I/O。

不幸的是，SQLite 没有任何内置的散列函数。您可以通过将字符串中的字符值成对相加来自己构建一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:08:31.557

我已经在回答你之前的问题了。我不是数据库专家，我对字母算法如何工作有一些想法。

1.  您将只使用数据库来加快搜索速度，即减少结果数量，然后您将检查内存中的数据库结果。

2.  对于数据库中的每个单词，您还将保存一个哈希。该哈希将是一个数字或一个字符串。

3.  如果您有一组字母，例如 {a, b, b, c, x, t, u, v}，您将计算一组可以从字母创建的散列，并且对于每个可能的散列，您将询问所有结果的数据库。

4.  测试结果是否仅包含您的集合中的字母（我们已经在您的上一个问题中讨论过）。

一些可能的哈希函数：

1.  没有重复的有序元音，例如 hash(transformers) = "aeo"。从上面的集合中，您将获得可能的哈希“”、“a”、“u”、“au”、“ua”。请注意，很少有没有元音的单词，所以 "" 请求不应该造成问题。

2.  带有重复的有序元音，例如 hash(request) = "ee"。从集合 {w, h, y, a, a, x, e} 你会得到散列 "", "a", "e", "y", "aa", "ae", "ay", "ea ”、“ey”、“ya”、“ye”、“aae”、“aay”。一般来说 - 更多的请求，更少的结果。

3.  没有重复的有序字母，例如 hash(transfomers) = "aefmnorst"。如果`N`是字母的数量，我们忽略长度<2的单词，你最多需要（如果没有字母重复）`(N 3) + (N 4) + (N 5) + .... + (N N)`，如果`N`是20，那就是几千个或请求......让我们忽略这个想法。

4.  ASCII 字母的位掩码（忽略任何非 ASCII 字母）。位置 0 的位表示单词包含“a”，位置 1 包含“b”等。如果我们为字母创建相同的位掩码，我们可以选择单词，例如`(wordMask & ~lettersMask) == 0`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T01:56:34.210

对于第二个问题，每个单词添加一个按字母顺序排列的第二列。然后对可用的图块进行排序并搜索该列。这将为您提供用于搜索的所有图块的所有可能单词。

不幸的是，它不适用于某些瓷砖。为此，您必须一次消除一个图块并重新进行搜索。

# ember.js - 绑定第一个 arraycontroller 对象

> ID：14344304
> 
> 赞同：1
> 
> 时间：2013-01-15T18:23:33.290
> 
> 标签：ember.js

我需要将属性绑定到 arraycontroller 的第一个元素类似的东西：

firstEltBinding: 'myArrayController.elementAt(0)'

怎么做 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:25:30.017

你可以做：

```
firstElementBinding: 'myArrayController.firstObject' 
```

# c# - 在 C# 中构造类/结构的最佳方法

> ID：14344305
> 
> 赞同：6
> 
> 时间：2013-01-15T18:23:36.117
> 
> 标签：c#, class, networking, struct

我一直在研究旨在以 C 语言实现并分别以 C 风格定义的网络协议规范，例如：

```
struct some_header {
  uint8_t version;
  uint8_t type;
  uint16_t length;
  uint32_t id; /
};

struct some_struct {
  struct some_header header;
  uint8_t field1; 
  uint8_t pad[3]; /* Pad to 32 bits */
  uint32_t field2;
}; 
```

规范中定义了大约数百个类似“some_struct”的结构。

现在的目标是复制 C# 中的定义并围绕这些结构增加一些功能。

假设将它们表示为对象会很好，那么在 C# 中使用什么来表示上面示例中的结构的最佳原语是什么？

1.  使用 unsafe 子句复制类似 C 的定义，然后在每个结构周围使用类包装器

2.  使用 StructLayout 属性来指导托管结构内的布局，并为每个此类结构使用包装类

3.  使用成熟的课程，并且只使用内存或网络流进行有线表示

除了托管 c++ 之外，还有其他想法吗？

其次，显然任务本身是非常劳动密集型的，并且在列出的任何情况下都容易出错。是否有任何自动化可以帮助将 C 标头转换为上述解决方案之一？请问有人可以推荐一个吗？

**UPD。**

一些图纸可以更好地描述问题。

(BoxA) --- 通过 TCP/IP 运行的有线协议 --- (BoxB)

假设 BoxA 运行一些用纯 C 编写的代码，BoxB 应该运行用 C# 编写的代码。

有线协议代表了这个庞大的规范，它有 100 多种结构来通信 BoxA 和 BoxB。如果协议是用 Google Protocol Buffers 或 Apache Thrift 定义的，那可能会容易得多，但不幸的是，我正在处理按原样定义的标准。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:31:52.687

恕我直言，最好手动转换它们，如下所示：

```
[StructLayout(LayoutKind.Sequential, Pack=1)]
public struct Header
{
    public Byte version;
    public Byte type;
    public UInt16 length;
    public UInt32 id;
}

[StructLayout(LayoutKind.Sequential, Pack=1)]
public struct Struct
{
    public Header header;
    public Byte field1;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst=3)]
    public Byte[] pad;
    public UInt32 field2;
} 
```

将来您可能不得不将它们与本机函数一起使用......所以最好将它们保留为结构并直接在您的 .NET 代码中使用它们。[如果您必须将它们作为本机方法的参数传递或将结果 IntPtrs 转换回它们（ Marshal.PtrToStructure](http://msdn.microsoft.com/en-us/library/4ca6d5z7.aspx)），它们将非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:42:02.970

> 是否有任何自动化可以帮助将 C 标头转换为上述解决方案之一？

使用 C 预处理器获取一个大文件，然后使用脚本剪切结构定义，然后应用搜索和替换来转换类型并添加属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T20:56:46.393

关于自动化问题，我刚刚找到了从 c-header 生成 PInvoke 样式代码的优秀工具

[http://clrinterop.codeplex.com/releases/view/14120#ReviewsAnchor](http://clrinterop.codeplex.com/releases/view/14120#ReviewsAnchor)

具体来说，需要在命令行使用以下工具

sigimp /lang:cs "路径到 c 头"

下面是生成的代码示例：

```
[System.Runtime.InteropServices.StructLayoutAttribute(System.Runtime.InteropServices.LayoutKind.Sequential)]
public struct some_header {

/// uint8_t->unsigned char
public byte version;

/// uint8_t->unsigned char
public byte type;

/// uint16_t->unsigned int
public uint length;

/// uint32_t->unsigned int
public uint id;
}

[System.Runtime.InteropServices.StructLayoutAttribute(System.Runtime.InteropServices.LayoutKind.Sequential, CharSet=System.Runtime.InteropServices.CharSet.Ansi)]
public some_struct {

public some_header header;

/// uint64_t->unsigned int
public uint xxx;

/// uint32_t->unsigned int
public uint xxx2;

/// uint8_t->unsigned char
public byte xxx3;

/// uint8_t->unsigned char
public byte xxx4;

/// uint8_t[2]
[System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst=2)]
public string pad;

/// uint32_t->unsigned int
public uint xxx5;

/// uint32_t->unsigned int
public uint xxx6;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T20:36:28.503

我的倾向是使用封装字节数组引用和索引的类型，然后有方法读取或写入下一个字节/字/长字/任何内容。从字节流转换为结构类型的代码如下所示：

```
myReader = new ByteArrayReader(myArr);
myHead.version = myReader.getByte();
myHead.type; = myReader.getByte();
myHead.length = myReader.getUInt16();
myHead.id = myReader.getUInt32(); 
```

在这种情况下，我假设`myHead`将是具有上述公共字段的透明结构。我不建议将标头类型设为类，除非实例实际上要“做”某事。使阅读器类型成为结构可能会提高性能，但在某些情况下可能会导致令人惊讶的语义。框架中最接近的等价物是`List<T>.Enumerator`，这是出于性能原因的结构。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-15T18:30:18.063

虽然 C# 有`Struct`，但最好的办法是使用`Class`. 您可以将类用作数据容器，查看贫血域模式，或者您可以在其中包含实现，例如验证和业务逻辑。请参阅：域驱动。

在处理您的领域模型时，请确保接受[SOLID 原则](http://www.firatatagun.com/solid-principles/)。

此外，根据您的领域模型，您当然可以利用抽象、继承等。

哦。保持简单和直观。

# mysql - 如何获取刚刚插入的记录ID（mysql）？

> ID：14344308
> 
> 赞同：1
> 
> 时间：2013-01-15T18:23:50.293
> 
> 标签：mysql

如何获取刚刚插入的记录ID（mysql）？我将添加到查询中：

```
INSERT INTO `osoby` (`imie`,`nazwisko`)
VALUES ('wartość','wartość2') 
```

? 谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:26:33.757

要获取最后插入的 id，请使用

```
SELECT LAST_INSERT_ID() 
```

请参阅[文档](http://dev.mysql.com/doc/refman/5.0/en/getting-unique-id.html)

# logging - 带有专用错误日志文件的 PHP-FPM

> ID：14344316
> 
> 赞同：6
> 
> 时间：2013-01-15T18:24:28.503
> 
> 标签：logging, php

我已经建立了一个 Apache2/PHP-FPM 站点，并希望将 PHP-FPM 的错误记录到它自己的错误日志文件中。但是，使用当前配置，错误将按以下格式记录到 /var/log/php5-fpm.log：

```
WARNING: [pool www] child 22926 said into stderr: "NOTICE: PHP message: PHP Parse error:  syntax error, unexpected 'if' (T_IF) in /var/www/site.com/error.php on line 1" 
```

在我的 /etc/php5/fpm/pool.d/www.conf 我有以下选项：

```
php_admin_value[error_log] = /var/log/fpm-php.www.log
php_admin_flag[log_errors] = on
catch_workers_output = yes 
```

当我禁用`catch_workers_output`时，错误记录完全停止。但是，在 phpinfo() 输出中，它显示了我在配置中指定的日志文件。

为什么 PHP5-FPM 不尊重这个日志文件。有没有办法让 fpm 池的错误记录在单独的文件中？

我的php版本：

```
# php5-fpm  -v
PHP 5.4.9-4~precise+1 (fpm-fcgi) (built: Nov 30 2012 10:48:01) 
```

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T17:46:02.167

您将在主 FPM 配置中找到 error_log = /var/log/php-fpm.log。根据您的示例，您将在池配置中进行设置，该配置仅适用于该特定池/域。

# javascript - 我可以在客户端 javascript 中收到有关 cookie 更改的通知吗

> ID：14344319
> 
> 赞同：34
> 
> 时间：2013-01-15T18:24:38.703
> 
> 标签：javascript, cookies

我可以在客户端javascript中以某种方式跟踪对cookies（对于我的域）的更改吗？例如，如果 cookie 被更改、删除或添加时调用的函数

按优先顺序

*   标准跨浏览器
*   跨浏览器
*   特定浏览器
*   扩展/插件

为什么？因为我在窗口/选项卡＃1中依赖的cookie可以在窗口/选项卡＃2中更改。

我发现 chrome 允许在 cookie 更改时通知扩展。但那是我最不喜欢的选择

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-15T18:47:08.200

一种选择是编写一个定期检查 cookie 是否有更改的函数：

```
var checkCookie = function() {

    var lastCookie = document.cookie; // 'static' memory between function calls

    return function() {

        var currentCookie = document.cookie;

        if (currentCookie != lastCookie) {

            // something useful like parse cookie, run a callback fn, etc.

            lastCookie = currentCookie; // store latest cookie

        }
    };
}();

window.setInterval(checkCookie, 100); // run every 100 ms 
```

*   这个例子使用了一个持久内存的闭包。外部函数立即执行，返回内部函数，并创建一个私有作用域。
*   [window.setInterval](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-09-18T09:24:07.993

**方法 1：定期轮询**

轮询`document.cookie`

```
function listenCookieChange(callback, interval = 1000) {
  let lastCookie = document.cookie;
  setInterval(()=> {
    let cookie = document.cookie;
    if (cookie !== lastCookie) {
      try {
        callback({oldValue: lastCookie, newValue: cookie});
      } finally {
        lastCookie = cookie;
      }
    }
  }, interval);
} 
```

用法

```
listenCookieChange(({oldValue, newValue})=> {
  console.log(`Cookie changed from "${oldValue}" to "${newValue}"`);
}, 1000);

document.cookie = 'a=1'; 
```

**方法二：API拦截**

截距`document.cookie`

```
(()=> {
  let lastCookie = document.cookie;
  // rename document.cookie to document._cookie, and redefine document.cookie
  const expando = '_cookie';
  let nativeCookieDesc = Object.getOwnPropertyDescriptor(Document.prototype, 'cookie');
  Object.defineProperty(Document.prototype, expando, nativeCookieDesc);
  Object.defineProperty(Document.prototype, 'cookie', {
    enumerable: true,
    configurable: true,
    get() {
      return this[expando];
    },
    set(value) {
      this[expando] = value;
      // check cookie change
      let cookie = this[expando];
      if (cookie !== lastCookie) {
        try {
          // dispatch cookie-change messages to other same-origin tabs/frames
          let detail = {oldValue: lastCookie, newValue: cookie};
          this.dispatchEvent(new CustomEvent('cookiechange', {
            detail: detail
          }));
          channel.postMessage(detail);
        } finally {
          lastCookie = cookie;
        }
      }
    }
  });
  // listen cookie-change messages from other same-origin tabs/frames
  const channel = new BroadcastChannel('cookie-channel');
  channel.onmessage = (e)=> {
    lastCookie = e.data.newValue;
    document.dispatchEvent(new CustomEvent('cookiechange', {
      detail: e.data
    }));
  };
})(); 
```

**用法**

```
document.addEventListener('cookiechange', ({detail: {oldValue, newValue}})=> {
  console.log(`Cookie changed from "${oldValue}" to "${newValue}"`);
});

document.cookie = 'a=1'; 
```

**笔记**

1.  不适用于 IE
2.  需要 Safari 的 BroadcastChannel polyfill

### 结论

```
| Metric \ Method  | Periodic Polling            | API Interception |
| ---------------- | --------------------------- | ---------------- |
| delay            | depends on polling interval | instant          |
| scope            | same-domain                 | same-origin      | 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-08-08T20:26:06.280

我觉得我的方法更好。我编写了一个自定义事件来检测 cookie 何时出现：

```
const cookieEvent = new CustomEvent("cookieChanged", {
  bubbles: true,
  detail: {
    cookieValue: document.cookie,
    checkChange: () => {
      if (cookieEvent.detail.cookieValue != document.cookie) {
        cookieEvent.detail.cookieValue = document.cookie;
        return 1;
      } else {
        return 0;
      }
    },
    listenCheckChange: () => {
      setInterval(function () {
        if (cookieEvent.detail.checkChange() == 1) {
          cookieEvent.detail.changed = true;
          //fire the event
          cookieEvent.target.dispatchEvent(cookieEvent);
        } else {
          cookieEvent.detail.changed = false;
        }
      }, 1000);
    },
    changed: false
  }
});

/*FIRE cookieEvent EVENT WHEN THE PAGE IS LOADED TO
 CHECK IF USER CHANGED THE COOKIE VALUE */

document.addEventListener("DOMContentLoaded", function (e) {
  e.target.dispatchEvent(cookieEvent);
});

document.addEventListener("cookieChanged", function (e) {
  e.detail.listenCheckChange();
  if(e.detail.changed === true ){
    /*YOUR CODE HERE FOR DO SOMETHING 
      WHEN USER CHANGED THE COOKIE VALUE */
  }
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-05-27T08:22:25.257

如果操作 cookie 的代码是您的，您可以使用 `localStorage`事件跟踪更改。例如，您可以在 localStorage 上存储垃圾以触发其他选项卡上的事件。

例如

```
var checkCookie = function() {

var lastCookies = document.cookie.split( ';' ).map( function( x ) { return x.trim().split( /(=)/ ); } ).reduce( function( a, b ) { 
        a[ b[ 0 ] ] = a[ b[ 0 ] ] ? a[ b[ 0 ] ] + ', ' + b.slice( 2 ).join( '' ) :  
        b.slice( 2 ).join( '' ); return a; }, {} );

return function() {

    var currentCookies =  document.cookie.split( ';' ).map( function( x ) { return x.trim().split( /(=)/ ); } ).reduce( function( a, b ) { 
        a[ b[ 0 ] ] = a[ b[ 0 ] ] ? a[ b[ 0 ] ] + ', ' + b.slice( 2 ).join( '' ) :  
        b.slice( 2 ).join( '' ); return a; }, {} );

    for(cookie in currentCookies) {
        if  ( currentCookies[cookie] != lastCookies[cookie] ) {
            console.log("--------")
            console.log(cookie+"="+lastCookies[cookie])
            console.log(cookie+"="+currentCookies[cookie])
        }

    }
    lastCookies = currentCookies;

};
}();
 $(window).on("storage",checkCookie); // via jQuery. can be used also with VanillaJS

// on the function changed the cookies

document.cookie = ....
window.localStorage["1"] = new Date().getTime(); // this will trigger the "storage" event in the other tabs. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-21T12:33:57.037

略微改进（显示每个更改的 cookie 的 console.log）：

```
var checkCookie = function() {

var lastCookies = document.cookie.split( ';' ).map( function( x ) { return x.trim().split( /(=)/ ); } ).reduce( function( a, b ) { 
        a[ b[ 0 ] ] = a[ b[ 0 ] ] ? a[ b[ 0 ] ] + ', ' + b.slice( 2 ).join( '' ) :  
        b.slice( 2 ).join( '' ); return a; }, {} );

return function() {

    var currentCookies =  document.cookie.split( ';' ).map( function( x ) { return x.trim().split( /(=)/ ); } ).reduce( function( a, b ) { 
        a[ b[ 0 ] ] = a[ b[ 0 ] ] ? a[ b[ 0 ] ] + ', ' + b.slice( 2 ).join( '' ) :  
        b.slice( 2 ).join( '' ); return a; }, {} );

    for(cookie in currentCookies) {
        if  ( currentCookies[cookie] != lastCookies[cookie] ) {
            console.log("--------")
            console.log(cookie+"="+lastCookies[cookie])
            console.log(cookie+"="+currentCookies[cookie])
        }

    }
    lastCookies = currentCookies;

};
}();

window.setInterval(checkCookie, 100); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-19T06:31:17.310

我们可以使用[`CookieStore`](https://developer.mozilla.org/en-US/docs/Web/API/CookieStore)API：

```
cookieStore.addEventListener('change', ({changed}) => {
    for (const {name, value} of changed) {
        console.log(`${name} was set to ${value}`);
    }
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-08T08:18:32.130

如果你想使用新的[CookieStore](https://developer.mozilla.org/en-US/docs/Web/API/CookieStore)并希望得到所有浏览器的支持，你可以安装一个（推测的）polyfill，如下所示：[https ://github.com/markcellus/cookie-store](https://github.com/markcellus/cookie-store)

# python - 解释不熟悉的python语法——返回列表

> ID：14344323
> 
> 赞同：2
> 
> 时间：2013-01-15T18:24:50.400
> 
> 标签：python

我完全理解这个表达式的右侧在做什么。但它又变成了什么？换句话说，左边在做什么？

```
[records, remainder] = ''.join([remainder, tmp]).rsplit(NEWLINE,1) 
```

我不熟悉那种语法。

`remainder`在此行上方定义为空字符串：

```
remainder = '' 
```

但未`records`在函数的任何地方定义。

从上下文来看，它应该是积累流媒体内容，但我不明白如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:28:55.767

`records`正在获取 的`rsplit`返回值的第一个元素。`remainder`正在服用第二个。

```
% python
Python 2.7 (r27:82500, Sep 16 2010, 18:02:00) 
[GCC 4.5.1 20100907 (Red Hat 4.5.1-3)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> foo = [3, 9]
>>> [records, remainder] = foo
>>> records
3
>>> remainder
9
>>> foo = [3, 9, 10]
>>> [records, remainder] = foo
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: too many values to unpack 
```

你实际上不需要方括号`[records, remainder]`，但它们是风格的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:35:26.383

它首先[将](http://docs.python.org/2/library/stdtypes.html#str.join)的内容`remainder`与`tmp`使用空字符串作为连接符的内容连接起来。

```
''.join([...]) 
```

然后它从右边[拆分](http://docs.python.org/2/library/stdtypes.html#str.rsplit)`NEWLINE`这个连接，使用as splitter 并且只进行一次拆分，也就是说，它返回两个值，一个从开始到第一次出现，`NEWLINE`另一个从那里到结束。

```
.rsplit(NEWLINE, 1) 
```

最后，它使用[tuple unpacking](http://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)分配第一个值`records`和第二个值。`remainder`

```
a, b = (c, d) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:31:01.173

不确定流媒体内容，但自己尝试一下很容易：

```
>>> a = 'abc'
>>> b = '\ndef\nghi'
>>> c = (a + b).rsplit('\n', 1)
#['abc\ndef', 'ghi'] 
```

然后它使用解包来分配两个变量（应该写成）：

```
fst, snd = c 
```

（`[]`'s 是多余的）

# java - 迭代集合时检查可空性

> ID：14344326
> 
> 赞同：2
> 
> 时间：2013-01-15T18:25:02.527
> 
> 标签：java, coding-style

哪个更好？

```
List list = ... //get list from somewhere

for (int i=0; list != null && i < list.size(); i++){
    // ...
} 
```

或者？

```
List list = ... //get list from somewhere

if (list != null){
    for (int i = 0; i < list.size(); i++){
        // ...
    }
} 
```

我从这里得到了这个想法：[Scala 还是 Java？探索神话和事实](http://www.infoq.com/articles/scala-java-myths-facts)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:29:35.927

*更好*是什么意思？更易读的代码，还是更高效的代码？无论如何，我不喜欢你的两个建议中的任何一个。

当我必须使用一个方法，它返回 a `List`，但可能返回`null`（我不能更改该方法的源代码以返回一个空`List`），这就是我所做的：

```
List list = ... // get list from somewhere
if (list == null) {
    list = Collections.emptyList();
}
for (int i = 0; i < list.size(); i++) {
    // ...
} 
```

恕我直言，这在可读性、性能方面获胜，并避免了我们代码的深度嵌套。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:31:19.133

将空检查留在循环之外。

尽管您可以通过将一行合并到循环终止条件中来保存它，但没有人会这样做，因为您会失去清晰度：

**您应该只在循环代码部分中包含与迭代相关的代码！**

这是一个基本的良好编码风格指南。

此外，合并检查也可能稍微慢一些，因为即使列表为空，您也必须启动循环并执行初始化代码。

最后，如果你想重构使用方便的 foreach 语法，你不能合并空检查：

```
List<T> list;
if (list != null) {
    for (T t : list) {
        // ...
    }
{ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T19:41:27.327

你的建议都没有效率。我会建议类似于下面的代码（为什么每次都进行不必要的方法调用 list.size() ）：-

```
List list = ... //get list from somewhere

int size = (list==null ? 0 : list.size());

for (int i = 0; i < size; i++){
    // ...
} 
```

这样代码既可读又高效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T18:28:25.750

第二个......在第一种方法中，每次循环都会发生不必要的空检查

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T18:28:19.110

在性能上也是一样的。对于可读性问题，我更喜欢第二个。它对我来说更具可读性和清洁性。

# .net - Flourinefx：找不到名称合适的方法

> ID：14344333
> 
> 赞同：5
> 
> 时间：2013-01-15T18:25:23.167
> 
> 标签：.net, apache-flex, flourinefx

重新安装计算机后，我遇到了一个旧的完美运行的 Florinefx 应用程序的问题。

对于某些函数调用（我认为那些包含自定义对象的函数），我得到：

```
2013-01-15 19:03:53,616 [27] ERROR FluorineFx.MethodHandler - Could not find a suitable method with name GetTodayView
2013-01-15 19:03:53,616 [27] ERROR FluorineFx.MethodHandler - Displaying verbose logging information
2013-01-15 19:03:53,616 [27] ERROR FluorineFx.MethodHandler - Checking GetTodayView(query(Query))
2013-01-15 19:03:53,616 [27] ERROR FluorineFx.MethodHandler - query(Query) did not match value "Offerta.DAL.Queries.Query" (Query)
2013-01-15 19:03:53,633 [27] ERROR FluorineFx.Messaging.Endpoints.Filter.ProcessFilter - Could not find a suitable method with name GetTodayView
FluorineFx.Exceptions.FluorineException: Could not find a suitable method with name GetTodayView
   at FluorineFx.MethodHandler.GetMethod(Type type, String methodName, IList arguments, Boolean exactMatch, Boolean throwException, Boolean traceError)
   at FluorineFx.MethodHandler.GetMethod(Type type, String methodName, IList arguments, Boolean exactMatch, Boolean throwException)
   at FluorineFx.MethodHandler.GetMethod(Type type, String methodName, IList arguments, Boolean exactMatch)
   at FluorineFx.MethodHandler.GetMethod(Type type, String methodName, IList arguments)
   at FluorineFx.Messaging.Endpoints.Filter.ProcessFilter.Invoke(AMFContext context) 
```

以前有人见过这种行为吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T15:00:25.363

这是 FlourineFX 和线程的罕见问题。阅读以下博客文章：http: [//jdecuyper.github.com/blog/FluorineFx-Could-Not-Find-A-Suitable-Method.html](http://jdecuyper.github.com/blog/FluorineFx-Could-Not-Find-A-Suitable-Method.html)

# javascript - 从 Ajax 返回返回整个 html 结构

> ID：14344337
> 
> 赞同：1
> 
> 时间：2013-01-15T18:25:30.570
> 
> 标签：javascript, ajax, jquery

嗨，我刚刚学习使用 jQuery/ajax。我似乎遇到了一些问题。当我尝试发布一些表单数据时，我从服务器返回我的整个 html 结构和我返回的数据。

这是我的html：

```
 ....
   <form id="submitData" method="post" action="">
        <div>
            <label for="FirstName">First Name:</label>
            <input type="text" id="FirstName" name="FirstName"/><span class="error">*</span>
        </div>
        ........
        <div id="textearea">
            <label for="Message">Message:</label>
            <textarea name="Message"></textarea><span class="error">*</span>
        </div>
        <input type="submit" id="submit" name="submit" value="Submit"/>
    </form>
    ..... 
```

这是我的 php 代码：

```
<?php
      if(isset($_POST['data'])){
          $jsonData = json_encode($_POST['data']);

          return $jsonData;
      }
   ?> 
```

这是我的 jQuery 代码：

```
$(document).on('submit' , 'form#submitData' , function(e){

     var formData = $(this).serializeArray();
     console.log(formData);

     $.ajax({
         url:'index.php',
         type:'POST',
         datatype:'json',
         data: { data : formData},
         success : function(data){
             for(var i = 0; i < data.length; i++){
                 console.log(data);

             }
         },
         error : function(s , i , error){
             console.log(error);
         }
     })
     e.preventDefault();
 }); 
```

我尝试循环访问数据，但我似乎从 html 结构中取回了字母。我还应该提到，表单的 html 是使用 jquery load() 加载到页面中的。

我怎样才能让它只返回编码数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:29:33.303

从单独的 PHP 页面获取它：

```
$(document).on('submit' , 'form#submitData' , function(e){

     var formData = $(this).serializeArray();
     console.log(formData);

     $.ajax({
         // change here
         url:'ajax.php',
         type:'POST',
         datatype:'json',
         data: { data : formData},
         success : function(data){
             for(var i = 0; i < data.length; i++){
                 console.log(data);

             }
         },
         error : function(s , i , error){
             console.log(error);
         }
     })
     e.preventDefault();
 }); 
```

并将您的 PHP 代码放在那里。

# arrays - 如何在 Haskell 中使用 DiffArray？如何使这个代码更严格？

> ID：14344338
> 
> 赞同：2
> 
> 时间：2013-01-15T18:25:36.130
> 
> 标签：arrays, haskell, module, strict

我尝试使用 Data.Array [代码](http://liveworkspace.org/code/1tt53n%2411) 没关系，但速度很慢。

然后使用 Data.Array.Diff
[代码](http://liveworkspace.org/code/1tt53n%2424)

> 找不到模块“Data.Array.Diff”

如果我使用 Data.Array.Unboxed，则找不到 DiffArray 或 DiffUArray 构造函数。

如何使用 DiffArray 和 DiffUArray？

DiffUArray 比 DiffArray 更优化性能？

我怎样才能使代码不那么懒惰（更严格）？

我不想使用 IOArray 或 STArray，因为学习。如果存在，我应该只使用 IArray 和其他一些非单子数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:36:36.047

使用[向量](http://www.haskell.org/haskellwiki/Numeric_Haskell%3a_A_Vector_Tutorial)怎么样？

DiffArray 已过时。

# backbone.js - Backbone.js：如何为具有两种表示的实体建模

> ID：14344340
> 
> 赞同：0
> 
> 时间：2013-01-15T18:25:46.097
> 
> 标签：backbone.js, backbone-views

我是backbone.js 的新手，所以请耐心等待。我想找出对以下模型进行建模的最佳方案：

我有一个“汽车”项目，它有两个应该链接到同一个“汽车”对象的演示文稿。第一个表示是显示实际汽车的汽车 div（例如，带有绿色轮子的红色汽车）。第二个表示是汽车的创建/编辑对话框，用户可以在其中更改汽车的属性。

我需要为这个场景创建两个 View 和一个 ViewController，我需要两个 ViewController，还是应该只有一个 View 和一个 Controller 以及两个单独的渲染方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:52:55.903

主干中没有 ViewController。你会想要：

*   汽车的一个`Backbone.Model`子类
*   `Backbone.View`汽车只读视图的一个子类和一个模板
*   `Backbone.View`创建/编辑对话框的一个子类和一个模板

# sql - SQL 包含不适用于带有前面 * 的全文索引

> ID：14344343
> 
> 赞同：1
> 
> 时间：2013-01-15T18:25:54.273
> 
> 标签：sql, sql-server-2008, full-text-search, fulltext-index, full-text-catalog

```
select top 10 * from table where contains(*,'"abc*"') 
```

工作并返回 6 行

abcdef

A B C D

A B C D

abcde

ABCDEFGH

ABCDEFG

```
select top 10 * from table where contains(*,'"*bc*"') 
```

返回未找到记录。

有谁知道我怎样才能让 '" *** *bc* *** "' 函数工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:44:22.747

领先的通配符搜索将排除使用任何索引...包括全文索引。

所以`"*bc*"`与全文索引不兼容......以及非全文搜索，例如`LIKE '%bc%'`将导致全表扫描。

相关问题：

[SQL Server 全文搜索前导通配符](https://stackoverflow.com/questions/2664387/sql-server-full-text-search-leading-wildcard)

[如何让领先的通配符全文搜索在 SQL Server 中工作？](https://stackoverflow.com/questions/3400/how-do-you-get-leading-wildcard-full-text-searches-to-work-in-sql-server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:41:38.780

尝试

```
select top 10 * from table where contains(*,'%bc%') 
```

或者

```
select op 10 * from table where COLUMN_NAME LIKE '%bc%' 
```

# verification - systemverilog中结构、包和类的区别

> ID：14344345
> 
> 赞同：0
> 
> 时间：2013-01-15T18:25:58.483
> 
> 标签：verification, system-verilog

class 和 struct 之间的区别很简单，但是 package 在整个方案中的位置。我看到的大多数包都从库文件中导入，并在目录中包含其他 sv 文件。更具体地说，什么时候包通常用于最佳编码方案，如果没有在该级别添加特定变量，使用头文件是否是更好的做法？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:11:35.100

包提供了一个编译范围，可以在其中进行类型、类、函数、任务和其他声明。然后可以在其他范围（其他包或顶级编译单元范围）中导入包。

我认为包很像 C++ 中的命名空间。它们提供了一个以“打包”方式编译代码的区域，然后可以在其他地方导入和使用。

包是包含直接在包文件中的声明，还是来自包含在包声明中的头文件，这只是一个偏好问题。

以下两个是等价的：

```
// File my_pkg.sv
package my_pkg;
    class my_class;
    endclass
endpackage 
```

--

```
// File my_class.sv
class my_class;
endclass

// File my_pkg.sv
package my_pkg;
    `include "my_class.sv"
endpackage 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T13:09:24.583

包，如 C++ 命名空间，可用于避免变量名冲突。

```
package a_pkg;
int value = 100;
class a_class;
  task print;
    $display ("value is %d", value);
  endtask
endclass
endpackage

package b_pkg;
int value = 200;
class b_class;
  task print;
    $display ("value is %d", value);
  endtask
endclass
endpackage

package c_pkg;
import a_pkg::value;
class c_class;
  task print;
    $display ("value is %d", value);
  endtask
endclass
endpackage 
```

这里两个类引用它们自己包的全局变量，都命名为“值”。第三类选择使用前一个包中的全局变量，使用“import”。

如果没有包，情况将是这样的：

```
int value = 100;
class a_class;
  task print;
    $display ("value is %d", value);
  endtask
endclass

// int value = 100; // can't do... compilation error
class b_class;
  task print; // prints 100
    $display ("value is %d", value);
  endtask
endclass

class c_class;
  task print;
    $display ("value is %d", value);
  endtask
endclass
endpackage 
```

另请注意，将`struct`s 视为有点像标量或数组变量。一个`class`变量只包含一个引用，并且`new`需要一个调用来创建一个`class`对象。但是`struct`像数组变量这样的变量*直接*保存值。这些也可用于可综合的 RTL 代码。

请注意，无法实例化包，并且包中声明的任何内容只有一个实例。它们可以看作是 RTL 中顶级模块的 TB 等价物，即未实例化的模块。

# javascript - Facebook登录弹出窗口未在移动浏览器上关闭

> ID：14344347
> 
> 赞同：1
> 
> 时间：2013-01-15T18:26:03.037
> 
> 标签：javascript, facebook, login, sdk

当我使用 JS SDK 并在我的移动 chrome 浏览器上调用登录操作时，它会在新窗口中打开登录对话框，但是当我进行身份验证时，页面只是变为空白并且不会关闭弹出窗口或返回到我的网站。当我手动关闭选项卡并返回我的网站并刷新时，我已登录。

难道我做错了什么？

频道文件是正确的，正在运行媒体寺庙 http 连接。

提前致谢，高性能计算

# exception - 在 Tomcat 7 中使用不同的 ROOT 应用程序时，JNDI 资源不可用

> ID：14344348
> 
> 赞同：0
> 
> 时间：2013-01-15T18:26:02.697
> 
> 标签：exception, tomcat, jndi, configuration-files, windows-server-2008-r2

我终于在tomcat上制作了我的应用程序，问题是：

[JNDI JDBC 资源的第一个问题](https://stackoverflow.com/questions/14318423/window-2008-tomcat-7-ms-sql-server-2008r2-jndi-jdbc-driver-not-recognized)

现在我有另一个问题：

我已经更改了 Tomcat 中的默认 ROOT 应用程序：

[%CATALINA_HOME%\conf\server.xml]

```
 <Host name="localhost"  appBase="webapps" unpackWARs="true" autoDeploy="true">
       <Context path="" docBase="MY_APP" reloadable="true" debug="0" cookies="false"></Context>
    <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"       prefix="localhost_access_log." suffix=".txt" pattern="%h %l %u %t &quot;%r&quot; %s %b" />
  </Host> 
```

然后，重新启动tomcat后，我尝试访问：它工作正常！

后来我发布了一个新版本的MY_APP。我部署了它，我又遇到了原来的问题： [原来的问题](https://stackoverflow.com/questions/14318423/window-2008-tomcat-7-ms-sql-server-2008r2-jndi-jdbc-driver-not-recognized)

我检查了所有的配置文件，一切似乎都很好，所以我尝试访问：`http://localhost/MY_APP`它工作正常！但是通过访问的问题 `http://localhost/`仍然存在......

我已经从“webapps”目录中删除了所有其他应用程序。现在 webapps 只包含 MY_APP。通过访问

*   `http://localhost/MY_APP`--> 有效！
*   `http://localhost/`--> JNDI JDBC 资源异常

你能告诉我我做错了什么吗？我找不到任何解释...

操作系统：Windows 2008 R2 Standart SP1 JVM：JDK 1.7u10 TOMCAT：apache-tomcat-7.0.34

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:37:39.730

由于您将`<Context>`元素包含在`server.xml`.

首先，停止这样做：删除`<Context>`from `server.xml`。

接下来，将您的 WAR 文件重命名为`ROOT.war`（请注意，这是区分大小写的，即使在通常忽略 NTFS 之类的文件系统上也是如此）并将其放入`%CATALINA_BASE%/webapps`（无论如何，这可能就是它所在的位置）。

你的 webapp 应该包含一个`META-INF/context.xml`文件，该文件是你的`<Context>`元素应该去的地方，包括任何`<Resource>`作为子元素的元素。这就是您设置 JNDI 引用的地方。

正确部署后，您的 web 应用程序应作为默认/ROOT 上下文工作，而 JNDI 工作正常。

# magento - Magento 媒体网址在子商店中中断

> ID：14344349
> 
> 赞同：0
> 
> 时间：2013-01-15T18:26:12.307
> 
> 标签：magento, path, http-status-code-404, magento-1.7

有点问题。最近将我的 magento (1.7) 商店迁移到新主机 - 设置没有变化，与 php 版本相同 - 只需拿起和放下。一切都很顺利，网站运行良好，除了一个问题。

有主商店[http://www.seacadetshipsstore.com/magento/](http://www.seacadetshipsstore.com/magento/)，然后有一个子商店[http://www.seacadetshipsstore.com/magento/gearlocker/](http://www.seacadetshipsstore.com/magento/gearlocker/)。子商店似乎无法访问任何媒体，我相信我知道为什么。

这是 /magento/ 的示例脚本调用：

```
http://www.seacadetshipsstore.com/magento/js/scriptaculous/builder.js 
```

这是 /magento/gearlocker/ 的相同脚本调用：

```
http://www.seacadetshipsstore.com/magento/gearlocker/js/scriptaculous/builder.js 
```

这些文件被绝对调用，所以我知道这不是相对路径问题。从来源：

```
<script type="text/javascript" src="http://www.seacadetshipsstore.com/magento/gearlocker/js/scriptaculous/builder.js"></script> 
```

在原来的主机上很好，但是当我们迁移时，一切都开始崩溃了。有没有人遇到过这种问题？我希望这只是一个配置问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T21:05:07.300

事实证明，非常简单的解决方案。

罪魁祸首是 core_config_data 中的误导性路径 - web/unsecure/base_url 在需要 /magento/ 时被设置为 /magento/gearlocker/。愚蠢的错误！

# python - 在为函数构建字典时，我的代码会自动执行该函数。我怎样才能阻止这个？

> ID：14344351
> 
> 赞同：1
> 
> 时间：2013-01-15T18:26:14.037
> 
> 标签：python, dictionary, python-3.x

相对较新的python。现在我遇到了以下问题，我设置了一个字典，这样当我给出某个输入时，它会执行定义的函数，但即使我将输入设置为不执行该函数，它仍然会执行。这基本上是代码的样子。

```
options = []

def function0(str): print(str,"0")

str = "blahblahblah"

operations = {0:function0(str)}

for i in range(len(options)): operations[options[i]] 
```

此代码仍在打印出 function0 输出。我还得出结论，它在我设置字典“操作”后立即执行该功能。为什么会这样，我怎样才能让它不呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:40:55.553

代码被执行是因为你**调用**了函数：计算结果为with作为参数`function0(str)`的返回值。`function0``str`

如果您只想将函数对象放在 dict 中以供进一步使用，请执行

```
operations = {0: function0} 
```

* * *

一些旁注：

1.  不要`str`用作变量名。`str`是一个内置类型，你不应该用你的变量来隐藏这个名字。
2.  使用 an 循环以`int`将其用作索引是非pythonic。另请注意，您没有调用代码中的函数。您的循环应如下所示：

    ```
    for op_index in operations:
         operations[op_index](mystr) 
    ```

    或者：

    ```
    for op in operations.values():
        op(mystr) 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:40:52.470

这将在您在控制台中键入代码时发生，因为每一行都会立即进行评估。

你可能打算做的是：

```
operations = {0:function0}
for i in options:
    operations[i](str) 
```

请注意，在运行序列时不需要显式计数器。所以你不需要这个`range(len(options))`部分。

# node.js - TypeError: 对象函数 app(req, res){ app.handle(req, res); } 没有方法“注册”

> ID：14344354
> 
> 赞同：5
> 
> 时间：2013-01-15T18:26:23.977
> 
> 标签：node.js, express

尝试在 nodejs 中使用把手，我收到此错误“TypeError: Object function app(req, res){ app.handle(req, res); } has no method 'register'”。下面是nodejs的代码。相同的代码似乎对其他人有用，因为它几乎是[NodeJS + Express + Handlebars 的复制粘贴 - 无法找到视图 "index.html"](https://stackoverflow.com/questions/8814437/nodejs-express-handlebars-failed-to-locate-view-index-html)。PS我是nodejs的新手，并试图感受它，并且已经习惯了车把。

```
//Load Modules
var express = require('express');
var handlebars = require('handlebars');

var app = express();

// Configuration
app.configure( function() {
    app.register('.html', handlebars);
    app.set('views', __dirname + '/');
    app.set('view engine', 'handlebars');
    app.set("view options", { layout: false });    
});

// Routes
app.get('/:first/:last', function(req, res) {
    var data = {title:req.param.first + " " + req.param.last};
    res.render("template/profilecard.html", data);
});

app.listen(3000);

console.log("NodeJS Server Started"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T20:16:48.390

Express 3.0 将 app.register 更改为 app.engine。 [迁移到 Express.js 3.0](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)

> 一些模板引擎不遵循这个约定，创建了 consolidate.js 库来映射所有节点流行的模板引擎以遵循这个约定，从而允许它们在 Express 中无缝工作。

npm 安装合并

尝试以下操作：

```
var engines = require('consolidate');

app.configure( function() {

    app.set('views', __dirname + '/');
    app.set('view engine', 'handlebars');
    app.set("view options", { layout: false }); 
    app.engine('.html', engines.handlebars);
}); 
```

# ruby-on-rails - Rails 验证单选按钮虚拟属性值是否为假

> ID：14344355
> 
> 赞同：2
> 
> 时间：2013-01-15T18:26:26.513
> 
> 标签：ruby-on-rails, validation, model

我现在的模型是这样的：

```
class Order < ActiveRecord::Base
  attr_accessible :**** :phone_number, :receiver, :shipping_id, :street, :totalcost, :user_id, :zip, :use_user_data
  attr_accessor :use_user_data
  validates :city, :presence => {:message =>  I18n.t(:city_not_chosen)}
  validates :zip, :presence => {:message =>  I18n.t(:zip_not_chosen)}
  validates :street, :presence => {:message =>  I18n.t(:street__not_chosen)}
  validates :building, :presence => {:message =>  I18n.t(:building_not_chosen)}
  validates :phone_number, :presence => {:message =>  I18n.t(:phone_number_not_chosen)}
  validates :receiver, :presence => {:message =>  I18n.t(:receiver_not_chosen)}
end 
```

如您所见，我在模型中设置了一些非数据库字段（use_user_data）的字段...

但是怎么办，如果 :use_user_data 是假的，好的和正确的验证，但是当真时没有验证？

在这里，我想这样做：

```
 if !:use_user_data
    validates :city, :presence => {:message =>  I18n.t(:city_not_chosen)}
    validates :zip, :presence => {:message =>  I18n.t(:zip_not_chosen)}
    validates :street, :presence => {:message =>  I18n.t(:street__not_chosen)}
    validates :building, :presence => {:message =>  I18n.t(:building_not_chosen)}
    validates :phone_number, :presence => {:message =>  I18n.t(:phone_number_not_chosen)}
    valida 
```

形式

```
= form_for @order do |f|
  %div
    = f.label :use_user_data , "Использовать данные вашего профиля*: "
    = label :use_user_data , "Да"
    = f.radio_button :use_user_data, true, :required => true, :id => "use_user_data", :checked => true
    = label :use_user_data , "Нет"
    = f.radio_button :use_user_data, false, :required => true, :id => "dont_use_user_data" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:30:31.257

您可以将条件验证与选项`:if`或`:unless`. 例子：

```
validates :city, :presence => {:message =>  I18n.t(:city_not_chosen)}, :unless => :use_user_data 
```

查看[Rails Guide on Validation](http://guides.rubyonrails.org/active_record_validations_callbacks.html#conditional-validation) for 其他 sytntaxes，最后一个可能最适合您的情况：

```
with_options :unless => :use_user_data do |order|
  order.validates :city, :presence => {:message =>  I18n.t(:city_not_chosen)}
  order.validates :zip, :presence => {:message =>  I18n.t(:zip_not_chosen)}
  order.validates :street, :presence => {:message =>  I18n.t(:street__not_chosen)}
  # ...
end 
```

# javascript - 从嵌套的 javascript 对象中删除属性的最佳方法是什么？

> ID：14344356
> 
> 赞同：7
> 
> 时间：2013-01-15T18:26:33.320
> 
> 标签：javascript, json, recursion, javascript-objects

我有一个如下的树对象，如果它是空的，我正在尝试删除 items 数组属性。我不确定执行此操作的最佳方法？

我正在考虑遍历密钥，检查属性，然后使用删除`delete myJSONObject[prop]`...欢迎任何想法/想法？

```
[{
    text: "TreeRoot",
    items: [{
        text: "Subgroup1",
        items: []
    }, {
        text: "Subgroup2",
        items: []
    }, {
        text: "Subgroup3",
        items: [],
        items: [{
            text: "subgroup5",
            items: [{
                text: "subgroup6",
                items: [{
                    text: "subgroup7",
                    items: [{
                        text: "subgroup8",
                        items: []
                    }]
                }]
            }]
        }]
    }]
}] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-07-14T02:57:56.597

这应该可以完成工作（**ES5**）：

```
function removeEmpty(obj) {
  Object.keys(obj).forEach(function(key) {
    (key === 'items' && obj[key].length === 0) && delete obj[key] ||
    (obj[key] && typeof obj[key] === 'object') && removeEmpty(obj[key])
  });
  return obj;
}; 
```

[JSBIN](https://jsbin.com/huxeti/edit?html,js,console)

在**ES6**中相同：

```
const removeEmpty = (obj) => {
  Object.keys(obj).forEach(key =>
    (key === 'items' && obj[key].length === 0) && delete obj[key] ||
    (obj[key] && typeof obj[key] === 'object') && removeEmpty(obj[key])
  );
  return obj;
}; 
```

[JSBIN](https://jsbin.com/fesoko/edit?html,js,console)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:30:54.393

您可以使用递归算法，在每个步骤中删除`items`数组并返回，或递归处理数组的每个单独对象。

我也会尝试在服务器端执行此操作。它将节省大量复杂性、内存和处理时间。通常有一些方法可以从 JSON 编码的字符串中“排除”空数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-07T03:19:26.390

这个老问题已经被提出来了，我认为现代 JS 与递归配合得很好，可以产生一个简单的答案，以不可变的方式做到这一点：

```
const removeEmptyItems = (xs) =>
   xs .map (({items = [], ... rest}) => ({
    ... rest, 
    ... (items .length ? {items: removeEmptyItems(items)} : {})
  }))

const tree = [{text: "TreeRoot", items: [{text: "Subgroup1", items: []}, {text: "Subgroup2", items: []}, {text: "Subgroup3",items: [{text: "subgroup5", items: [{text: "subgroup6", items: [{text: "subgroup7", items: [{text: "subgroup8", items: []}]}]}]}]}]}]

console .log (removeEmptyItems (tree))
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

这个函数简单地映射数组，保留每个对象的其余部分，并为其`items`属性，当它为空时跳过它，当它不是时重复。

我不得不说，当第一次问这个问题时，这个答案看起来很陌生！现在它只是普通的JS！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-27T06:52:35.543

这是使用[对象扫描的解决方案](https://github.com/blackflux/object-scan)

```
// const objectScan = require('object-scan');

const data = [{ text: 'TreeRoot', items: [{ text: 'Subgroup1', items: [] }, { text: 'Subgroup2', items: [] }, { text: 'Subgroup3', items: [{ text: 'subgroup5', items: [{ text: 'subgroup6', items: [{ text: 'subgroup7', items: [{ text: 'subgroup8', items: [] }] }] }] }] }] }];

const modify = (obj) => objectScan(['**.items'], {
  rtn: 'count',
  filterFn: ({ value, parent, property }) => {
    if (Array.isArray(value) && value.length === 0) {
      delete parent[property];
      return true;
    }
    return false;
  }
})(obj);

console.log(modify(data)); // returns number of deletions
// => 3
console.log(data);
// => [ { text: 'TreeRoot', items: [ { text: 'Subgroup1' }, { text: 'Subgroup2' }, { text: 'Subgroup3', items: [ { text: 'subgroup5', items: [ { text: 'subgroup6', items: [ { text: 'subgroup7', items: [ { text: 'subgroup8' } ] } ] } ] } ] } ] } ]
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

```
<script src="https://bundle.run/object-scan@13.7.1"></script>
```

*免责声明*：我是[对象扫描的作者](https://www.npmjs.com/package/object-scan)

# c++ - c++ - 抛出自定义空指针异常

> ID：14344360
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:27:12.637
> 
> 标签：c++, exception, exception-handling, this

有没有一种简单的方法可以在 C++ 中引发自定义空指针异常？我的想法是重新定义`this`指针，但它有3个问题：

1.  不使用`this`会引发标准访问冲突异常
2.  每次使用时都会检查指针
3.  Visual Studio 将此显示为`InteliSense`错误（可编译）（不知道其他编译器做了什么）

    ```
    #include <iostream>
    #define this (this != nullptr ? (*this) : throw "NullPointerException")

    class Obj
    {
    public:
        int x;
        void Add(const Obj& obj)
        {
            this.x += obj.x; // throws "NullPointerException"
                    //x = obj.x;  // throws Access Violation Exception
        }
    };

    void main()
    {
        Obj *o = new Obj();
        Obj *o2 = nullptr;
        try
        {
            (*o2).Add(*o);
        }
        catch (char *exception)
        {
            std::cout << exception;
        }
        getchar();
    } 
    ```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T18:32:30.733

由于`this`can never, ever be ，编译器可以自由地`nullptr`对待. 你试图做的事情根本没有意义。您不能使用异常来捕获未定义的行为。唯一的方法是通过未定义的行为。`this != nullptr``true``this``nullptr`

```
Obj *o2 = nullptr;
try
{
    (*o2).Add(*o);
} 
```

取消引用 a`nullptr`是未定义的行为 (8.3.2)。这是试图使用异常来捕获未定义的行为。从根本上说，你不能在 C++ 中做到这一点。

由于一个明显的原因，这是未定义的，请考虑：

```
class Foo
{
   public:
   Foo { ; }
   virtual void func() = 0;
};

class Bar : public Foo
{
   public:
   Bar() { ; }
   virtual void func() { some_code() }
};

class Baz : public foo
{
    public:
    Baz() { ; }
    virtual void func() { some_other_code(); }
}

...

Foo * j = nullptr;
j->func(); // Uh oh, which func? 
```

# umbraco - umbraco 中存储的成员属性在哪里

> ID：14344364
> 
> 赞同：6
> 
> 时间：2013-01-15T18:27:18.113
> 
> 标签：umbraco

我正在尝试从数据库中导出成员属性，例如名字、姓氏，但我似乎找不到它。我看到有一个带有正确列的 loginUser 表，但它似乎只包含 5 个条目，而不是我在管理界面中看到的完整人员列表。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-30T20:11:58.570

道格拉斯是对的，访问会员提供商可能更容易。

但是我最近在做一个项目，我们需要对一个相当大的会员群做一些查询，并且会员 API 太慢，所以我们做了以下视图。希望有帮助：

```
SELECT        MEMBTYPEID.text AS MemberType, MEMBLST.nodeId, MEMBTYPES.Name AS MemberField, MEMBTYPES.Alias AS MemberFieldAlias, MEMB.LoginName, 
                         (CASE WHEN MEMBDATA.[dataInt] IS NOT NULL THEN CONVERT(NVARCHAR(500), MEMBDATA.[dataInt]) ELSE MEMBDATA.[dataNvarchar] END) 
                         AS MemberData
FROM            dbo.umbracoNode AS MEMBTYPEID INNER JOIN
                         dbo.cmsContent AS MEMBLST ON MEMBLST.contentType = MEMBTYPEID.id INNER JOIN
                         dbo.cmsPropertyType AS MEMBTYPES ON MEMBTYPES.contentTypeId = MEMBLST.contentType INNER JOIN
                         dbo.cmsPropertyData AS MEMBDATA ON MEMBDATA.contentNodeId = MEMBLST.nodeId AND MEMBDATA.propertytypeid = MEMBTYPES.id INNER JOIN
                         dbo.cmsMember AS MEMB ON MEMB.nodeId = MEMBLST.nodeId
WHERE        (MEMBTYPEID.nodeObjectType = '9b5416fb-e72f-45a9-a07b-5a9a2709ce43') 
```

“where”子句只是将节点过滤为 Member 类型（我不知道这个 GUID 是否对于所有实现都是常量，请先检查）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-15T19:49:55.063

成员属性存储在`cmsPropertyData`表中。将`contentNodeId`对应于成员的 id。

使用 api 导出数据可能更容易。Umbraco 使用标准的 ASP.NET Membership Provider 模型。有关更多详细信息，请参阅[会员提供者](http://our.umbraco.org/wiki/how-tos/membership-providers)。

# excel - 编辑多个 Excel 工作簿

> ID：14344367
> 
> 赞同：0
> 
> 时间：2013-01-15T18:27:46.250
> 
> 标签：excel, excel-2007

我有 50 个 Excel 工作簿 (Excel 2007) 已发送给员工。问题是我忘记“解锁”所有单元格上的某些单元格，这使得它们在工作表受到保护时无法编辑。我不能因为超出这个问题范围的原因要求工作人员解锁牢房。

现在所有工作簿都已通过电子邮件发送给我。

我怎样才能 - 取消保护每张纸（受密码保护）并解锁所需的单元格而无需执行 50 次？有没有不写VBA的办法？

MC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T01:00:29.550

共识似乎是答案是“使用 VBA”和“否”。

# php - 从 MySQL 结果自动更新列

> ID：14344370
> 
> 赞同：0
> 
> 时间：2013-01-15T18:27:56.740
> 
> 标签：php, mysql

我有一个用于创建视图的 sql 查询。是否有可能在该查询运行时，它会更新表中的相应字段并分配用户？

例如：我的查询，会给我这个视图：

```
 dealID |  removalnotes  | rolloverenabled   | rateplanchanges
   1      |  Yes           | Yes               | NULL
   2      | Null           | Null              | NULL
   3      | Null           | Yes               | NULL
   4      | Null           | Yes               | Yes 
```

这是我的查询：

```
SELECT dealID, removalnotes, rolloverenabled , rateplanchanged
FROM invoice_payment
WHERE removalnotes IS NULL OR removalnotes <> 'Yes' 
OR rolloverenabled IS NULL OR rolloverenabled <> 'Yes' 
OR rateplanchanged IS NULL OR rateplanchanged <> 'Yes'
GROUP BY dealID 
```

我可以在那里添加一个自动执行此操作的子查询吗？如果可以的话，我到底在哪里放置或如何放置子查询？

```
UPDATE invoice_payment SET
user = 'User1'
WHERE dealID = dealID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:38:14.247

试试这个，

```
 UPDATE 
              invoice_payment AS ip
            CROSS JOIN (
              SELECT dealID, removalnotes, rolloverenabled , rateplanchanged
            FROM invoice_payment
            WHERE removalnotes IS NULL OR removalnotes <> 'Yes' 
            OR rolloverenabled IS NULL OR rolloverenabled <> 'Yes' 
            OR rateplanchanged IS NULL OR rateplanchanged <> 'Yes'
            GROUP BY dealID

            ) AS sq
            SET 
              ip.user = 'User1' 
            WHERE ip.dealID = dealID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:50:56.210

您可以添加一个触发器，也许可以使用它来解决。 [http://dev.mysql.com/doc/refman/5.0/es/triggers.html](http://dev.mysql.com/doc/refman/5.0/es/triggers.html)

# java - 如何将 java.sql.Date 转换为 dd/MM/yyyy 格式的 java.util.Date？

> ID：14344373
> 
> 赞同：0
> 
> 时间：2013-01-15T18:28:17.317
> 
> 标签：java, date, java.util.date

我通过使用以下代码将 util 日期转换为 sql 日期来将日期存储到数据库

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");  
sdf.setLenient(false);
java.sql.Date dobSQLDate = null;
Date date = null;
if(!("").equals(userDob)){date = sdf.parse(userDob);dobSQLDate = new java.sql.Date(date.getTime());} 
```

现在我想在我的页面上以 dd/mm/yyyy 格式显示这个日期......我该如何转换它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:30:08.920

您可以`format`在 SimpleDateFormat 对象上使用该方法。它接受一个 java.util.Date 对象并返回一个基于指定格式字符串格式化的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T15:28:13.963

日期没有您可以设置的“格式”——它们只是一个瞬间。

如果要以某种格式显示日期，则必须使用以下代码将日期呈现为字符串：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");  
String dateString = sdf.format(date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T11:57:06.667

你可以使用***DateFormatUtils***

```
//Formats you dateto a specific pattern
 DateFormatUtils.format(yourDate, "dd/MM/yyyy"); 
```

# javascript - 使用 Javascript 将 onclick 函数添加到带有 this 参数的 href

> ID：14344375
> 
> 赞同：0
> 
> 时间：2013-01-15T18:28:18.673
> 
> 标签：javascript, onclick, this, add

我有一个这样的href

```
<a title="my title text" id="6" href="#" class="someclass" onclick="deleteRows(this.parentNode.parentNode)">X</a> 
```

现在我想添加一个新的完全相同的href，但我不知道如何使用'this'参数添加onclick。

尝试了这两个，但没有一个有效。

```
var a = document.createElement('a'); // create DIV element
    a.onclick = function() {
        (a.parentNode.parentNode);
    }; 
```

和

```
var a = document.createElement('a'); // create DIV element
    a.onclick = function() {
        (this.parentNode.parentNode);
    }; 
```

搜索谷歌，但没有找到任何东西。我应该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:35:18.053

您忘记`deleteRows`在事件侦听器内部调用：

```
var a = document.createElement('a');
a.onclick = function() {
    deleteRows(this.parentNode.parentNode);
}; 
```

# perl - 在 Windows 上构建 TAP::Formatter::HTML 时遇到问题

> ID：14344390
> 
> 赞同：5
> 
> 时间：2013-01-15T18:29:11.073
> 
> 标签：perl, cpan, tap, tap-harness

我的`cpan`[`TAP::Formatter::HTML`](https://metacpan.org/module/TAP%3a%3aFormatter%3a%3aHTML)安装挂起，`01_basic.t`我不知道为什么：

```
 CPAN.pm: Going to build S/SP/SPURKIS/TAP-Formatter-HTML-0.09.tar.gz

# running Build.PL --installdirs site
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Created MYMETA.yml and MYMETA.json
Creating new 'Build' script for 'TAP-Formatter-HTML' version '0.09'
C:\Perl\bin\perl.exe Build --makefile_env_macros 1
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Building TAP-Formatter-HTML
  SPURKIS/TAP-Formatter-HTML-0.09.tar.gz
  C:\Perl\site\bin\dmake.exe -- OK
CPAN: YAML::XS loaded ok (v0.35)
Running make test
C:\Perl\bin\perl.exe Build --makefile_env_macros 1 test
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
Set up gcc environment - 3.4.5 (mingw-vista special r3)
t\01_basic.t ............... 1/? Caught SIGINT. Trying to quit ...
Terminating on signal SIGINT(2)
Terminating on signal SIGINT(2)
Terminate batch job (Y/N)? Y 
```

为了更好地理解这个问题的根本原因，我修改了测试以包含一些`print`s 并独立运行它：

```
use strict;
use warnings;

$|++;

use lib 'lib';
use lib 't/lib';
use feature 'say';

use Test::More 'no_plan';
use FileTempTFH;
use File::Basename qw( basename );

use TAP::Harness;
use_ok( 'TAP::Formatter::HTML' );

my $stdout_fh      = FileTempTFH->new;
say "Defined FileTempTFH object";

my $stdout_orig_fh = IO::File->new_from_fd( fileno(STDOUT), 'w' )
  or die "Error opening STDOUT for writing: $!";
say "Defined IO::File object";

STDOUT->fdopen( fileno($stdout_fh), 'w' )
  or die "Error redirecting STDOUT: $!";
say "Opened STDOUT";

my @tests = glob( 't/data/*.pl' );
say "Tests defined : @tests";

my $h = TAP::Harness->new({ merge => 1,
                            formatter_class => 'TAP::Formatter::HTML' });
$h->runtests(@tests);
say "Tests run";

STDOUT->fdopen( fileno($stdout_orig_fh), 'w' )
  or die "Error resetting STDOUT: $!";

my $stdout = $stdout_fh->get_all_output || '';
isnt( $stdout, '', 'captured test output to stdout' );

foreach my $file (@tests) {
    my $test = basename( $file );
    $test    =~ s/\.pl$//;
    ok( $stdout =~ qr|$test|, "output contains test '$test'" );
} 
```

这也挂起：

```
C:\Perl\cpan\sources\authors\id\S\SP\SPURKIS\TAP-Formatter-HTML-0.09>perl t\01_basic.t
ok 1 - use TAP::Formatter::HTML;
Defined FileTempTFH object
Defined IO::File object 
```

似乎挂起的语句是`STDOUT->fdopen( fileno($stdout_fh), 'w' )`。

为什么会发生这种情况，我怎样才能让模块安装在我的设置中？

* * *

*PS*，内容`FileTempTFH`：

```
package FileTempTFH;

use strict;
use warnings;

use Fcntl qw( SEEK_SET );

use base qw( File::Temp );

sub get_all_output {
    my $self = shift;
    $self->seek( 0, SEEK_SET );
    my $html;
    {
    local $/ = undef;
    $html = <$self>;
    }
    return $html;
}

1; 
```

我的`perl -V`详细信息：

```
Set up gcc environment - 3.4.5 (mingw-vista special r3) Summary of my perl5 (revision 5 version 14 subversion 2) configuration:

  Platform:
    osname=MSWin32, osvers=5.2, archname=MSWin32-x86-multi-thread
    uname=''
    config_args='undef'
    hint=recommended, useposix=true, d_sigaction=undef
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=undef, use64bitall=undef, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef   Compiler:
    cc='C:/Perl/site/bin/gcc.exe', ccflags ='-DNDEBUG -DWIN32 -D_CONSOLE -DNO_STRICT -DPERL_TEXTMODE_SCRIPTS -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTE XT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -D_USE_32BIT_TIME_T -DHASATTRIBUTE -fno-strict-aliasing -mms-bitfields',
    optimize='-O2',
    cppflags='-DWIN32'
    ccversion='', gccversion='3.4.5 (mingw-vista special r3)', gccosandvers=''
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=undef, longlongsize=8, d_longdbl=define, longdblsize=8
    ivtype='long', ivsize=4, nvtype='double', nvsize=8, Off_t='__int64', lseeksize=8
    alignbytes=8, prototype=define   Linker and Libraries:
    ld='C:\Perl\site\bin\g++.exe', ldflags ='-L"C:\Perl\lib\CORE"'
    libpth=\lib
    libs=-lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion
-lodbc32 -lodbccp32 -lcomctl32 -lmsvcrt
    perllibs=-lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lvers ion -lodbc32 -lodbccp32 -lcomctl32 -lmsvcrt
    libc=msvcrt.lib, so=dll, useshrplib=true, libperl=perl514.lib
    gnulibc_version=''   Dynamic Linking:
    dlsrc=dl_win32.xs, dlext=dll, d_dlsymun=undef, ccdlflags=' '
    cccdlflags=' ', lddlflags='-mdll -L"C:\Perl\lib\CORE"'

Characteristics of this binary (from libperl):   Compile-time options: MULTIPLICITY PERL_DONT_CREATE_GVSV
                        PERL_IMPLICIT_CONTEXT PERL_IMPLICIT_SYS
                        PERL_MALLOC_WRAP PERL_PRESERVE_IVUV PL_OP_SLAB_ALLOC
                        USE_ITHREADS USE_LARGE_FILES USE_PERLIO USE_PERL_ATOF
                        USE_SITECUSTOMIZE   Locally applied patches:
        ActivePerl Build 1402 [295342]   Built under MSWin32   Compiled at Oct  7 2011 15:49:44   @INC:
    C:/Perl/site/lib
    C:/Perl/lib
    . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:10:24.547

尝试一个较新的，从 RT 票它似乎在当前版本中得到解决：

“我已经在 v0.11 中解决了这个问题。”

因为只有测试失败，你可以强制安装它。测试：

[http://howto.eyeoncomputers.com/programming/cpan-force-install/](http://howto.eyeoncomputers.com/programming/cpan-force-install/)

```
fforce install TAP::Formatter::HTML 
```

或者使用 cpanm

```
cpanm --notest TAP::Formatter::HTML 
```

问候，

# android - 可在 Android 中绘制具有完美圆形的圆形

> ID：14344397
> 
> 赞同：0
> 
> 时间：2013-01-15T18:29:24.127
> 
> 标签：android

> **可能重复：**
> [如何在 android xml 可绘制文件中定义圆形？](https://stackoverflow.com/questions/3185103/how-to-define-a-circle-shape-in-an-android-xml-drawable-file)

我在我的项目中使用圆形可绘制对象。我正在从我的填充圆形类设置背景颜色。问题是圆形不是完美的圆形。它是矩形椭圆形。请帮我解决这个问题。这是我对 circle 的drawbale。

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="oval" >
    <solid android:color="@color/transparent"/>
    <gradient 
        android:angle="270"/>

</shape> 
```

我还尝试了drawable。它给了我完美的圆形，但是当我将描边颜色设置为透明或删除它时，它又变成了矩形椭圆形。这是其他可绘制对象：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item android:state_enabled="true">
        <shape android:shape="oval" >
            <stroke
                android:width="2dp"
                android:color="@color/black" />

            <solid android:color="@color/transparent" />

            <padding
                android:bottom="2dp"
                android:left="10dp"
                android:right="10dp"
                android:top="2dp" />

            <corners
                android:bottomLeftRadius="65dp"
                android:bottomRightRadius="65dp"
                android:topLeftRadius="65dp"
                android:topRightRadius="65dp" />
        </shape>
    </item>

</layer-list> 
```

# networking - 包IP识别生成

> ID：14344398
> 
> 赞同：2
> 
> 时间：2013-01-15T18:29:24.240
> 
> 标签：networking, operating-system, ip, packet, tcp-ip

我正在研究 IP 数据包结构，我想知道操作系统如何生成 IP 标识号。我确信不同的平台会有不同的算法。

如果有人能指出一些可靠的参考资料以了解细节，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:50:04.677

如果您想知道操作系统是如何实现的，只需查看几个可用的免费操作系统之一的源代码。在这种情况下，您要查找的代码位于 Linux 的[__ip_select_ident](http://lxr.free-electrons.com/source/net/ipv4/route.c#L491)函数中。

看起来它保留了一些每个对等点（每个目标地址）的状态信息（基本上是一个计数器），但它也有一个备用算法，以防查找此状态信息失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:39:54.253

我相信为 IP Frag Id 选择一个随机数可以减少欺骗攻击的脆弱性。但我想事情没那么简单

几个参考： [唯一标识要求](http://www.ietf.org/rfc/rfc791.txt)、[高数据速率问题](https://www.rfc-editor.org/rfc/rfc4963)和[漏洞问题](http://static.usenix.org/event/woot/tech/final_files/Gilad.pdf)

# .net - 如何使用包含逗号的 FileVersion 创建 Windows 可执行文件

> ID：14344410
> 
> 赞同：0
> 
> 时间：2013-01-15T18:30:08.467
> 
> 标签：.net, version, versioning, executable

.NET 中有没有办法创建 FileVersion 值有逗号的可执行文件？

例如：4,4,3

我想要逗号而不是点作为分隔符。我该怎么做？

或者，是否有任何可用的资源黑客工具允许这样做？我尝试了 ResourceHacker，但它将逗号转换为点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:34:54.870

根据 MSDN，FileVersion 字段存储为 64 位整数，因此您在演示文稿中使用点还是逗号取决于您 - 或者显示信息的任何工具。看到这个： http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa381058 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381058(v=vs.85).aspx)

编辑：澄清一下，没有办法用逗号存储版本，因为它不是作为字符串存储的，只是四个单独的整数拼凑在一起作为一个 64 位整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:35:08.397

不。

您无法更改它们的存储方式，但您可以存储在您自己的应用程序中可视化它们的方式。

# java - Neo4J IN 运算符

> ID：14344412
> 
> 赞同：3
> 
> 时间：2013-01-15T18:30:09.827
> 
> 标签：java, neo4j

我在使用嵌入式 Java API 的 Cypher 查询中使用 IN 运算符时遇到问题。您似乎无法将 IN 运算符与`start`子句中检索到的实体以外的标识符一起使用。

例如，这是我的查询：

```
start n=node(someLongNodeId) 
match n--m 
where m.gnid? IN [\"someStringId\",\"otherStringId\"] 
return m 
```

我可以在过滤 的属性时使用 IN 运算符`n`，但是当我执行上述查询并尝试调用返回的 from`hasNext()`时，它会失败并出现以下异常：`Iterator``columnAs("m")`

```
Exception in thread "main" java.lang.RuntimeException
    at org.neo4j.cypher.internal.pipes.matching.MiniMap.newWith(ExpanderStep.scala:172)
    at org.neo4j.cypher.internal.pipes.matching.MiniMap.newWith(ExpanderStep.scala:155)
    at org.neo4j.cypher.internal.commands.InCollection$$anonfun$isMatch$1.apply(InCollection.scala:39)
    at org.neo4j.cypher.internal.commands.InCollection$$anonfun$isMatch$1.apply(InCollection.scala:38)
    at scala.collection.LinearSeqOptimized$class.exists(LinearSeqOptimized.scala:79)
    at scala.collection.immutable.List.exists(List.scala:45)
    at org.neo4j.cypher.internal.commands.AnyInCollection$$anonfun$seqMethod$2.apply(InCollection.scala:71)
    at org.neo4j.cypher.internal.commands.AnyInCollection$$anonfun$seqMethod$2.apply(InCollection.scala:71)
    at org.neo4j.cypher.internal.commands.InCollection.isMatch(InCollection.scala:38)
    at org.neo4j.cypher.internal.commands.And.isMatch(Predicate.scala:83)
    at org.neo4j.cypher.internal.pipes.matching.FilteringIterable$FilteringIterator.spoolToNextInLine(FilteringIterable.scala:55)
    at org.neo4j.cypher.internal.pipes.matching.FilteringIterable$FilteringIterator.<init>(FilteringIterable.scala:34)
    at org.neo4j.cypher.internal.pipes.matching.FilteringIterable.iterator(FilteringIterable.scala:72)
    at org.neo4j.cypher.internal.pipes.matching.FilteringIterable.iterator(FilteringIterable.scala:27)
    at scala.collection.JavaConversions$IterableWrapperTrait$class.iterator(JavaConversions.scala:557)
    at scala.collection.JavaConversions$IterableWrapper.iterator(JavaConversions.scala:583)
    at scala.collection.JavaConversions$IterableWrapper.iterator(JavaConversions.scala:583)
    at org.neo4j.kernel.impl.traversal.TraversalBranchWithState.expandRelationshipsWithoutChecks(TraversalBranchWithState.java:70)
    at org.neo4j.kernel.impl.traversal.TraversalBranchImpl.expandRelationships(TraversalBranchImpl.java:104)
    at org.neo4j.kernel.impl.traversal.StartNodeTraversalBranch.next(StartNodeTraversalBranch.java:47)
    at org.neo4j.kernel.impl.traversal.AsOneStartBranch.next(AsOneStartBranch.java:100)
    at org.neo4j.kernel.PreorderDepthFirstSelector.next(PreorderDepthFirstSelector.java:52)
    at org.neo4j.kernel.impl.traversal.TraverserIterator.fetchNextOrNull(TraverserIterator.java:65)
    at org.neo4j.kernel.impl.traversal.TraverserIterator.fetchNextOrNull(TraverserIterator.java:34)
    at org.neo4j.helpers.collection.PrefetchingIterator.hasNext(PrefetchingIterator.java:55)
    at scala.collection.JavaConversions$JIteratorWrapper.hasNext(JavaConversions.scala:574)
    at scala.collection.Iterator$$anon$21.hasNext(Iterator.scala:371)
    at scala.collection.Iterator$$anon$21.hasNext(Iterator.scala:371)
    at scala.collection.Iterator$$anon$22.hasNext(Iterator.scala:388)
    at scala.collection.Iterator$$anon$19.hasNext(Iterator.scala:334)
    at scala.collection.Iterator$$anon$19.hasNext(Iterator.scala:334)
    at org.neo4j.cypher.PipeExecutionResult.hasNext(PipeExecutionResult.scala:138)
    at scala.collection.Iterator$$anon$19.hasNext(Iterator.scala:334)
    at scala.collection.Iterator$$anon$19.hasNext(Iterator.scala:334)
    at scala.collection.JavaConversions$IteratorWrapper.hasNext(JavaConversions.scala:562)
    at com.awesomecompany.data.neo.NeoTestDriver.performBidirectionalQuery(NeoTestDriver.java:122)
    at com.awesomecompany.data.neo.NeoTestDriver.main(NeoTestDriver.java:44) 
```

我的假设是否正确，即您不能`n`在我的示例之外的其他东西上使用 IN 运算符？这是一个错误，还是设计使然？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T19:24:31.217

我想回答我自己的问题，以防其他人有类似的问题。参考上面的示例，我想解决几件事：

根据neo4j Google Group 论坛中的[讨论](https://groups.google.com/forum/?fromgroups=#!searchin/neo4j/in%2420operator/neo4j/neBGEq_WG8E/dIElWgE19kUJ)

*   我将 HAS() 函数添加到 WHERE 子句
*   我还更改了数组值以使用单引号 ( `'`) 而不是之前的双引号

所以我的新示例查询如下所示：

```
start n=node(someLongNodeId) 
match n--m 
where HAS(m.gnid) AND m.gnid IN ['someStringId','otherStringId'] 
return m 
```

这按预期工作。

进行上述编辑后，我将查询转换为使用参数（如果 JDBC 教会了我任何东西，那么这是执行此类查询的正确方法）。该查询如下所示：

```
start n=node({nodeId}) 
match n--m 
where HAS(m.gnid) AND m.gnid IN {otherIds}
return m 
```

这也正常工作。

IN 操作符目前没有很好的文档记录，这是可以理解的，因为它对于 neo4j 项目来说是相当新的，但我想确保这个问题得到解答，以防其他人遇到类似的问题。

# ios - UI 元素坐标到 UI 元素属性

> ID：14344416
> 
> 赞同：0
> 
> 时间：2013-01-15T18:30:20.243
> 
> 标签：ios

有人可以帮助我如何从给定的 X、Y 坐标中检索 iOS UI 元素属性吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:32:48.263

通常，您 `- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event` 需要[`UIView`](https://developer.apple.com/library/IOS/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html). 如果您`x, y`在窗口坐标中，则可以使用窗口的视图：

UIView *view = [myWindow.rootViewController.view hitTest:CGPointMake(x, y) withEvent:nil];

这将使`view`该位置的视图层次结构中最远的元素。您需要确保您的坐标在元素的空间中。

`- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event`如果您怀疑该元素，您可能也会喜欢。

# c - 将指向函数的指针作为参数传递给具有多个参数的其他函数

> ID：14344423
> 
> 赞同：0
> 
> 时间：2013-01-15T18:31:08.430
> 
> 标签：c, function, pointers, syntax

我想知道如何将指向函数的指针作为参数传递给另一个函数，只有我希望传递的函数有多个参数。例如，我的主要功能：

```
void main_func(float **D, float **w , int n, Pointer_to_func) 
```

我要传递的功能：

```
float func(int x_1, int y_1, int x_2, int y_2 ,int q) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:35:25.627

```
typedef float (*func_t)(int x_1, int y_1, int x_2, int y_2 ,int q);
void main_func(float **D, float **w , int n, func_t callback) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:42:11.020

或者没有 typedef（为了完整起见，您通常确实需要 typedef）：

```
void main_func(float **D, float **w , int n, float (*callback)(int, int, int, int, int)); 
```

# javascript - 这是默认对话框 jquery 显示

> ID：14344424
> 
> 赞同：0
> 
> 时间：2013-01-15T18:31:13.583
> 
> 标签：javascript, jquery, jquery-ui

在更改为显示后，我需要返回 Jquery 对话框的默认值：“慢”。

我有一个正常的对话框：

```
$( ".selector" ).dialog(); 
```

在对话生效后发生的变化：

```
$( ".selector" ).dialog({ show: "slow" }); 
```

我需要把它的默认值。什么是效果“无”？

我试试这个，但它对我不起作用：

```
$( ".selector" ).dialog({ show: "" }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:35:20.323

从[对话框的 API 文档](http://api.jqueryui.com/dialog/#option-show)：

> **`show`**
> 
> **类型**：数字或字符串或对象
> 
> **默认**：`null`

例如，

```
$( ".selector" ).dialog({ show: null }); 
```

您可能想检查[创建后如何更改 jQuery UI 小部件的选项？](https://stackoverflow.com/q/7997561/417685)以避免每次都重新初始化它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:37:16.570

它应该像下面，

```
$( ".selector" ).dialog( "option", "show", null ); 
```

**演示： http:** [//jsfiddle.net/pWbbh/](http://jsfiddle.net/pWbbh/)（`autoOpen`带有`slow`.. 的对话框关闭对话框并点击打开按钮以查看它立即打开。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:43:02.040

这是怎么做的：

```
$( ".selector" ).dialog({ show: false }); 
```

使用 false 而不是将其留空。试用垃圾箱：http: [//jsbin.com/awozor/1/edit](http://jsbin.com/awozor/1/edit)

# sql-server-2008 - 与 SQL Server 2008 中的 STContains 类似的功能

> ID：14344425
> 
> 赞同：1
> 
> 时间：2013-01-15T18:31:16.730
> 
> 标签：sql-server-2008, sql-server-2012

由于名为 STContains 的地理空间函数仅在 SQL Server 2012 中可用，我可以使用什么类似的函数在 SQL Sever 2008 中获得相同或相似的结果？

STIntersects 是可行的选择吗？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:10:07.193

`STContains` **在SQL** Server 2008 中可用。

```
DECLARE @s0 AS GEOMETRY = 'POLYGON((4 4, 7 4, 7 7, 4 7 ,4 4))'
DECLARE @s1 AS GEOMETRY = 'POLYGON((5 4.2, 6 4.2, 6 5, 5 5, 5 4.2))'

SELECT *
 FROM (
    SELECT @s0 AS 'Geo', 'S0' as 'Labels'
    UNION ALL   SELECT @s1, 'S1'
 ) AS A
 WHERE A.Geo.STContains(@S1) = 1 
```

[请参阅 SQL-Fiddle-Demo。](http://sqlfiddle.com/#!3/d41d8/7762/0)

# java - Java while 循环中未调用 Repaint()

> ID：14344431
> 
> 赞同：1
> 
> 时间：2013-01-15T18:31:28.637
> 
> 标签：java, swing, animation, awt

我正在尝试在 Java 中创建一个简单的动画，该动画显示一个蓝色球在 500 x 500 窗口中水平移动。球应该以 1px/30ms 的速率移动。问题是，仅在 while 循环退出时才绘制窗口，而不是在我想要的 while 循环的每次迭代期间绘制窗口。这导致蓝色球被涂在其最终位置。你能告诉我我在这里做错了什么吗？我还尝试使用 paintComponent() 方法在 EDT 上执行此代码并得到相同的结果。此外，正如其他帖子所建议的那样，我在使用 EDT 和 paintComponent() 方法时使用 paintImmediately(0, 0, getWidth(), getHeight()) 而不是 repaint() 得到了相同的结果。我正在尝试在不使用计时器的情况下完成所有这些工作。

```
import javax.swing.*;
import java.awt.*;

class AnimationFrame extends JPanel {

    int ovalX = 50;
    long animDuration = 5000;
    long currentTime = System.nanoTime() / 1000000;
    long startTime = currentTime;
    long elapsedTime = currentTime - startTime;

    public AnimationFrame() {
        setPreferredSize(new Dimension(500, 500));
        runAnimation();
    }

    public void runAnimation() {
        while (elapsedTime < animDuration) {
            currentTime = System.nanoTime() / 1000000;
            elapsedTime = currentTime - startTime;
            System.out.println(elapsedTime);
            ovalX = ovalX + 1;
            try {
                Thread.sleep(30);
            }
            catch (Exception e) {
            }
            repaint();
        }
    }

    public void paint(Graphics g) {
        Rectangle clip = g.getClipBounds();
        g.setColor(Color.BLACK);
        g.fillRect(clip.x, clip.y, clip.width, clip.height);
        g.setColor(Color.BLUE);
        g.fillOval(ovalX, 250, 70, 70);
    }

    public static void main(String[] args) {
        createAndShowGUI();
    }

    public static void createAndShowGUI() {
        JFrame mainFrame = new JFrame();
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        mainFrame.add(new AnimationFrame());
        mainFrame.pack();
        mainFrame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:53:47.650

我查看了您的代码并注意到您正在调用从“AnimationFrame”的构造函数中运行动画的方法，该构造函数正在添加到“mainFrame”中。

这样做的问题是您试图在对象完成构建之前制作动画，必须在将其添加到 mainFrame 之前完成动画，而 mainFrame 尚未使其在屏幕上可见。

我对您的代码进行了以下更改，现在我看到一个蓝色的球在框架上移动。

```
import javax.swing.*;
import java.awt.*;

class AnimationFrame extends JPanel {

    int ovalX = 50;
    long animDuration = 5000;
    long currentTime = System.nanoTime() / 1000000;
    long startTime = currentTime;
    long elapsedTime = currentTime - startTime;

    public AnimationFrame() {
        setPreferredSize(new Dimension(500, 500));
        //i removed the call to runAnimation from here

    }

    public void runAnimation() {
        while (elapsedTime < animDuration) {
            currentTime = System.nanoTime() / 1000000;
            elapsedTime = currentTime - startTime;
            System.out.println(elapsedTime);
            ovalX = ovalX + 1;
            try {
                Thread.sleep(30);
            }
            catch (Exception e) {
            }
            repaint();
        }
    }

    @Override
    public void paint(Graphics g) {
        Rectangle clip = g.getClipBounds();
        g.setColor(Color.BLACK);
        g.fillRect(clip.x, clip.y, clip.width, clip.height);
        g.setColor(Color.BLUE);
        g.fillOval(ovalX, 250, 70, 70);
    }

    public static void main(String[] args) {
        createAndShowGUI();
    }

    public static void createAndShowGUI() {
        JFrame mainFrame = new JFrame();
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        AnimationFrame animationPanel = new AnimationFrame();
        mainFrame.add(animationPanel);
        mainFrame.pack();
        mainFrame.setVisible(true);
        //I made the call to runAnimation here now
        //after the containing frame is visible.
        animationPanel.runAnimation();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:36:26.523

您需要在单独的线程中执行循环。请参阅本教程[- http://101.lv/learn/Java/ch10.htm](http://101.lv/learn/Java/ch10.htm)

# php - 数据库中的mysql修剪列

> ID：14344432
> 
> 赞同：0
> 
> 时间：2013-01-15T18:31:31.780
> 
> 标签：php, mysql, codeigniter, trim

```
UPDATE mytable SET mycolumn= LTRIM(RTRIM(mycolumn)); 
```

我用它来从前导和尾随空格中修剪整列，但我想要的是

```
|ID|Name      |
|1 |demo 6    |
|2 |demo3 500 | 
```

我想要的是通过删除这个int来修剪最后一个char是int的NAME。

输出

```
|ID|Name      |
|1 |demo      |
|2 |demo      | 
```

单独使用mysql可以吗？或者我需要使用 php 来更新表？

注意：此表包含大约 20K 行

编辑：好的 php 它是，

```
$s='';
foreach($q as $row){
$d=$row->name;
while(is_numeric(substr($d,-1))){$d=rtrim($d, '0123456789');}
if(is_numeric(substr($row->name,-1)))
$s.="update name_list set name='".$d."' where id='{$row->id}';\n";
}
echo "count:".count(explode('\n',$s))."<br/><pre>$s</pre>"; 
```

如果我尝试一一运行它们，它就会耗尽..

有没有更好的方法来修补更新行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:39:29.047

不幸的是，MySQL 目前（5.5）没有正则表达式版本的`REPLACE()`. 在 MySQL 中这样做虽然是首选且速度更快的 IMO，但如果没有[UDF](http://dev.mysql.com/doc/refman/5.1/en/adding-udf.html)或多个嵌套调用`REPLACE()`......</p>

```
RTRIM(REPLACE(REPLACE(..., '8', ''). '9', '')) 
```

**注意：**以上将替换所有数字。不只是那些*右边*。留给未来的读者，但不适用于 OP。

因此，PHP 是您唯一的选择。借自**马克 B**：

```
// loop over all rows
$no_ending_digits = rtrim($field, '0123456789');
// update row 
```

# javascript - 如何将网站宽度从标准尺寸更改为宽屏？

> ID：14344435
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:31:37.733
> 
> 标签：javascript, html, css

我知道您可以设置您选择供用户查看的标准像素大小，但是许多网站如何创建“浮动”屏幕调整？我猜它会检测阅读器的屏幕尺寸，然后进行调整。如何才能做到这一点？信息：我有标准的盒子尺寸，我想为“更宽”的笔记本电脑屏幕进行可变调整......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:34:56.643

有几种方法可以做到这一点，但最基本和最简单的方法是使用百分比作为宽度。像这样，然后对嵌套元素使用相对百分比。

```
body {
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:43:45.150

正如 Dustin 建议的那样，如果您希望元素的宽度与可用显示相关，您可以在 CSS 中使用百分比指定宽度。如果您希望元素“浮动”（在中间），并保持相对于显示器的宽度，您可以尝试以下 CSS（其中 myDiv 是您想要遵循此行为的 a 的 id）：

```
div#myDiv {
    width:                  75%;
    margin-left:            auto;
    margin-right:           auto;
} 
```

# ios - iOS：invocationWithMethodSignature 方法签名参数问题

> ID：14344438
> 
> 赞同：2
> 
> 时间：2013-01-15T18:31:45.247
> 
> 标签：ios

我正在开发一个应用程序，我使用 NSInvocation 处理 NSTimer，如下面的代码。我收到以下代码的 Sigbart 错误`*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[NSInvocation invocationWithMethodSignature:]: method signature argument cannot be nil' *** First throw call stack`

我正在尝试识别此崩溃，但无法得到它。有人可以帮我解决这个问题吗？

代码：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveImageToPhotoAlbum) name:kImageCapturedSuccessfully object:nil];

    NSInvocation *myInvocation = [NSInvocation invocationWithMethodSignature:[self methodSignatureForSelector:@selector(capturePicture:)]];
    [myInvocation setSelector:@selector(capturePicture:)];
    [myInvocation setTarget:self];
    [myInvocation retainArguments];

    [NSTimer scheduledTimerWithTimeInterval:5.0 invocation:myInvocation repeats:NO];

   -(void) capturePicture :(id) sender
{
    NSLog(@"capTureAutoPicture:Scanning image at interval");

    // Get all cameras in the application and find the frontal camera.
    AVCaptureDevice *backCamera;
    NSArray *allCameras = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];

    // Find the back camera.
    for ( int i = 0; i < allCameras.count; i++ ) {
        AVCaptureDevice *camera = [allCameras objectAtIndex:i];

        if ( camera.position == AVCaptureDevicePositionBack ) {
            backCamera = camera;
        }
    }

    // If we did not find the camera then do not take picture.
    if ( backCamera != nil ) {
        // Start the process of getting a picture.
        AVCaptureSession *session = [[AVCaptureSession alloc] init];

        // Setup instance of input with back camera and add to session.
        NSError *error;
        AVCaptureDeviceInput *input =
        [AVCaptureDeviceInput deviceInputWithDevice:backCamera error:&error];

        if ( !error && [session canAddInput:input] ) {
            // Add frontal camera to this session.
            [session addInput:input];

            // We need to capture still image.
            AVCaptureStillImageOutput *output = [[AVCaptureStillImageOutput alloc] init];

            // Captured image. settings.
            [output setOutputSettings:
             [[NSDictionary alloc] initWithObjectsAndKeys:AVVideoCodecJPEG,AVVideoCodecKey,nil]];

            if ( [session canAddOutput:output] ) 
            {

                [session addOutput:output];

                AVCaptureConnection *videoConnection = nil;
                for (AVCaptureConnection *connection in output.connections) {
                    for (AVCaptureInputPort *port in [connection inputPorts]) {
                        if ( [[port mediaType] isEqual:AVMediaTypeVideo] ) 
                        {
                            videoConnection = connection;
                            break;
                        }
                    }
                    if (videoConnection) 
                    { 
                        break; 
                    }
                }

                // Finally take the picture
                if ( videoConnection ) 
                {
                    [session startRunning];

                    [output captureStillImageAsynchronouslyFromConnection:videoConnection completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) 
                     {
                         if (imageDataSampleBuffer != NULL) 
                         {
                             NSData *imageData = [AVCaptureStillImageOutput 
                                                  jpegStillImageNSDataRepresentation:imageDataSampleBuffer];
                             UIImage *photo = [[UIImage alloc] initWithData:imageData];

                             //UIImageWriteToSavedPhotosAlbum(photo, nil, nil, nil);
                             [photo release];

                             [[NSNotificationCenter defaultCenter] postNotificationName:kImageCapturedSuccessfully object:nil];

                             [session stopRunning];

                         }

                     }];

                }
            }
            [output release];
        }
    }
}
- (void)saveImageToPhotoAlbum
{
    UIImageWriteToSavedPhotosAlbum([self stillImage], self, @selector(image:didFinishSavingWithError:contextInfo:), nil);

    [self dismissModalViewControllerAnimated:YES];
} 
```

更新代码：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveImageToPhotoAlbum) name:kImageCapturedSuccessfully object:nil];

    /*NSInvocation *myInvocation = [NSInvocation invocationWithMethodSignature:[self methodSignatureForSelector:@selector(capTureAutoPicture)]];
    [myInvocation setSelector:@selector(capTureAutoPicture)];
    [myInvocation setTarget:self];
    [NSTimer scheduledTimerWithTimeInterval:5.0 invocation:myInvocation repeats:NO];*/

    [NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(capTureAutoPicture:) userInfo:nil repeats:NO]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:31:09.093

抛出的异常很清楚，参数不能为零。

以下是 NSInvocation 的工作示例：

```
NSMethodSignature *methodSignature = [[_filter class] instanceMethodSignatureForSelector:@selector()];
NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:methodSignature];
[invocation setTarget:_filter];
[invocation setSelector:selector];
[invocation setArgument:&value atIndex:2];
[invocation invoke]; 
```

我还建议您看一下[这个问题的答案，它](https://stackoverflow.com/questions/313400/nsinvocation-for-dummies)很好地解释了 NSInvocation 的工作原理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T05:27:57.467

我修好了它。问题是，我没有添加“didFinishSavingWithError”而是调用它。添加此定义后，它起作用了。

# asp.net - 母版页不能在单页上工作，但只能在 IE 中工作

> ID：14344439
> 
> 赞同：0
> 
> 时间：2013-01-15T18:31:45.757
> 
> 标签：asp.net, internet-explorer, master-pages

因此，我最近发布了我的数字作品集（asp c# web 应用程序），并意识到母版页在我网站的“作品集”页面上无法正常工作，并且只有在 IE 中查看时才能正常工作。Chrome、firefox 和 safari 以及 IE 中的所有其他页面都可以正常工作。

不知道为什么它不起作用，我检查了语法但找不到原因。有人有什么想法吗？

投资组合.aspx

```
<%@ Page Language="C#" AutoEventWireup="true" MasterPageFile="~/MasterPage.master" CodeBehind="Portfolio.aspx.cs" Inherits="PortfolioApplication.Portfolio" %>

<asp:Content runat="server" ID="HeaderContent" ContentPlaceHolderID="HeadContent" >
    <link rel="Stylesheet" href="Styles/portfolioLayout.css" type="text/css"/>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="Scripts/js-image-slider.js"></script>
    <script type="text/javascript" src="Scripts/popup.js"></script>

    <script type="text/javascript">
        function populateSlider(sliderNum) {
            //Note: If the slider container has been set as invisible(e.g. display:none;), make sure set it visible before reload the imageSlider
            setSliderMarkup(sliderNum);
            imageSlider.reload();
        }
        function setSliderMarkup(sliderNum) {
            var sliderFrame = document.getElementById("popUp");

            switch (sliderNum) {
                case 1:
                    sliderFrame.innerHTML = '<div id="slider">' +
                        '<img src="Pictures/Projects/VacationWidget/vacationSlider1.jpg" width="989px" height="691" />' +
                        '<img src="Pictures/Projects/VacationWidget/vacationSlider2.jpg" width="989px" height="691" />' +
                        '</div>';
                    break;
                case 2:
                    sliderFrame.innerHTML = '<div id="slider"><img src="Pictures/Projects/FlashPortfolio/portfolioSlider1.jpg" />' +
                        '<img src="Pictures/Projects/FlashPortfolio/portfolioSlider2.jpg" />' +
                        '<img src="Pictures/Projects/FlashPortfolio/portfolioSlider3.jpg" />' +
                        '<img src="Pictures/Projects/FlashPortfolio/portfolioSlider4.jpg" />' +
                        '</div>';
                    break;
                case 3:
                    sliderFrame.innerHTML = '<div id="slider"><img src="Pictures/Projects/A1Auto/upholsterySlider1.jpg" />' +
                        '<img src="Pictures/Projects/A1Auto/upholsterySlider2.jpg" />' +
                        '<img src="Pictures/Projects/A1Auto/upholsterySlider3.jpg" />' +
                        '<img src="Pictures/Projects/A1Auto/upholsterySlider4.jpg" />' +
                        '</div>';
                    break;
                case 4:
                    sliderFrame.innerHTML = '<div id="slider"><img src="Pictures/Projects/Renatus/renatusSlider1.jpg" />' +
                        '<img src="Pictures/Projects/Renatus/renatusSlider2.jpg" />' +
                        '<img src="Pictures/Projects/Renatus/renatusSlider3.jpg" />' +
                            '</div>';
                    break;
                default:
            }
        }
    </script>
</asp:Content>

<asp:Content runat="server" ID="MainContent" ContentPlaceHolderID="MainContent">
    <div class ="content">
        <h1>My Recent Projects!</h1>
        <div id="project1" class="project">
            <asp:ImageButton runat="server" ImageUrl="Pictures/Projects/VacationWidget/VacationWidget.png" CssClass="projectImage" OnClientClick="populateSlider(1); return false" />
            <div id="project1Content" class="projectContent">
                <h1>Vacation Widget</h1>
                <p>Posted on: Saturday, October 28th, 2012</p>
                <h2>Description</h2>
                <p>This vacation widget... </p>
            </div>
        </div>                
        <div id="project2" class="projectOther">
            <asp:ImageButton runat="server" ImageUrl="Pictures/Projects/FlashPortfolio/FlashPortfolio1.png" CssClass="projectImage" OnClientClick="populateSlider(2); return false" />
            <div id="Div2" class="projectContent">
                <h1>Flash Portfolio</h1>
                <p>Posted on: Saturday, October 28th, 2012</p>
                <h2>Description</h2>
                <p>This project was designed...</p>
            </div>
        </div>
        <div id="project3" class="project">
            <asp:ImageButton ID="ImageButton1" runat="server" ImageUrl="Pictures/Projects/A1Auto/Upholstry.png" CssClass="projectImage" OnClientClick="populateSlider(3); return false" />
            <div id="Div3" class="projectContent">
                <h1>A1-Auto Upholstery</h1>
                <p>Posted on: Saturday, October 28th, 2012</p>
                <h2>Description</h2>
                <p>Recently modified with a few JavaScript touch ups...</p>
            </div>
        </div>
        <div id="project4" class="projectOther">
            <asp:ImageButton ID="ImageButton2" runat="server" ImageUrl="Pictures/Projects/Renatus/bestTravel.jpg" CssClass="projectImage" OnClientClick="populateSlider(4); return false" />
            <div id="Div4" class="projectContent">
                <h1>Renatus Travel Desktop Application</h1>
                <p>Posted on: Saturday, October 28th, 2012</p>
                <h2>Description</h2>
                <p>Best Travel is a fictional company...</p>
            </div>
        </div>
        <div class="imageViewerPopup" id="popUp" style="color:blue; width:691px" /> 
    </div>
    <div id="fade"></div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:25:41.607

您的投资组合页面上有多个 HTML 和 CSS 验证错误。

当您从 ID 为“background”的 div 元素中删除“width: 2200px”时，Internet Explorer 8 中的特定问题消失了，我看不出这个宽度是必需的，但我也鼓励您查看验证问题（请参阅[HTML 验证结果](http://validator.w3.org/check?uri=http%3A%2F%2Ftroyloberger.cloudapp.net%2FPortfolio.aspx&charset=%28detect+automatically%29&doctype=Inline&group=0)和[CSS 验证结果](http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Ftroyloberger.cloudapp.net%2FPortfolio.aspx&profile=css3&usermedium=all&warning=1&vextwarning=&lang=en)）同时修复问题。

我还建议您用更多语义超链接替换导航菜单中的输入按钮 - 这些将更易于访问并解决页面 URL 直到单击导航菜单按钮后第二次回发才更新的问题（为什么会这样正在发生，查看页面生命周期和事件处理，事件在 C# 代码中触发的顺序）。

# c# - 从 Excel API C# 获取单元格值

> ID：14344442
> 
> 赞同：2
> 
> 时间：2013-01-15T18:31:53.723
> 
> 标签：c#, api, excel, vba

我有一个为 Excel 制作的功能区以及一个用作加载项核心的 cs 文件。单击 CustomRibbon 上的按钮时，我想解析其中一行的数据值。

```
 private void button1_Click(object sender, RibbonControlEventArgs e)
    {
        Console.WriteLine(Globals.ThisAddIn.Application.Cells[0, 0]);

    } 
```

但这给了我一个错误

> HRESULT 异常：0x800A03EC

我想做的就是能够解析工作表上单元格中的数据并将数据写入工作表。即使在我启动程序时：

```
 sheet.Cells[0,0]= "hello"; 
```

它也给了我一个错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T19:27:51.027

引用 Excel 工作表中单元格的“最低”适用索引是 [1,1]，它对应于 A 列，单元格 1。我看到你试图引用 0,0，它超出了桌子。

尽管 C# 通常使用从零开始的表索引，但 Excel Interop 的程序员似乎遵循了不同的方法。那或者他们想要保持他们的约定统一，因为 Excel 表中的第一行以 1 开头，而不是 0。我不是 Excel 爱好者，但这是我最好的猜测。

编辑：根据 Siddharth 的请求，这是一个将 DataGridView 控件的内容复制到 Excel 工作表的示例。请注意，这只是演示基本功能，并不是完整的示例或最佳实践：

```
#using Microsoft.Office.Interop;

Excel.Application xlApp;
Excel.Workbook xlWorkBook;
Excel.Worksheet xlWorkSheet;

xlApp = new Excel.ApplicationClass();
xlWorkBook = xlApp.Workbooks.Add(1);
xlWorkSheet = Excel.Worksheet xlWorkBook.ActiveSheet;

// Notice the index starting at [1,1] (row,column)
for (int i=1; i<DataGridView.Columns.Count+1; i++)
    xlWorkSheet.Cells[1, i] = DataGridView.Columns[i - 1].HeaderText;

for each(DataGridViewRow row in DataGridView.Rows)
{
    for each (DataGridViewColumn column in DataGridView.Columns)
    {
        xlWorkSheet.Cells[row.Index+2,column.Index+1] = DataGridView.Rows[row.Index].Cells[column.Index].Value;
    }
} 
```

注意索引之间的差异。此示例首先从 DataGridView 复制标题，然后偏移 Excel 工作表中的位置以复制其余数据，因为列标题不计为 DataGrid 中的可索引单元格。这可能也适用于 DataTables。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T18:57:28.577

尝试使用单元格的**Value2**字段。

```
sheet.Cells[1,1].Value2 = "hello"; 
```

也在这一行

```
Console.WriteLine(Globals.ThisAddIn.Application.Cells[1, 1]); 
```

“单元格”字段是工作表的属性。您不能在 Excel 应用程序上使用它；您需要先创建或打开***Workbook***，然后再创建或使用现有的***Worksheet***。

***编辑***：忘记了 Excel 范围是 1 索引而不是 0 索引。

# c - 在 Windows 的套接字上使用 fprintf

> ID：14344445
> 
> 赞同：2
> 
> 时间：2013-01-15T18:32:07.530
> 
> 标签：c, sockets, winapi, winsock, msvcrt

我正在尝试在 Windows 上的套接字上使用 fprintf。许多在线示例都是[UNIX 示例](https://stackoverflow.com/questions/8776103/how-to-redirect-fprintf-output-to-c-socket)。Windows 的等效代码是我在这里询问的内容。

最终，我想这样做：

```
fprintf(file_handle_to_socket, "hello world\r\n"); 
```

我不想使用 WriteFile、snprintf 或其他任何东西。只是 fprintf()。

或多或少显示这些步骤的伪代码会有所帮助。

这是我到目前为止所拥有的：

```
unsigned short port = enter_port;

int result = 0;
WSADATA wsaData;
result = WSAStartup(MAKEWORD(2, 2), &wsaData);

struct sockaddr_in local;
memset(&local, 0, sizeof(struct sockaddr_in));

local.sin_port = htons(port);
local.sin_family = AF_INET;
local.sin_addr.s_addr = htonl(INADDR_ANY);

int sock = socket(AF_INET, SOCK_STREAM, 0);
if(sock == INVALID_SOCKET)
{
    fprintf(stdout,"invalid socket: error code %d\n", WSAGetLastError());
}

result = bind(sock, (struct sockaddr*)&local, sizeof(struct sockaddr_in));
if(result == SOCKET_ERROR)
{
    fprintf(stdout,"bind() failed: error code %d\n", WSAGetLastError());
}

result = listen(sock, 5);

struct sockaddr peer;
memset(&peer, 0, sizeof(struct sockaddr));

SOCKET client = 0;
int size = sizeof(struct sockaddr);
client = accept(sock, &peer, &size);

int OSFileHandle = _open_osfhandle(client, _O_APPEND);
FILE * file_handle_to_socket = fdopen(OSFileHandle, "w+");

fprintf(file_handle_to_socket, "Hello World\r\n");

// hoping this helps -- it doesn't
fflush(file_handle_to_socket);

fclose(file_handle_to_socket);
closesocket(client);

// this throws an exception
WSACleanup(); 
```

当我运行它时，另一端没有任何结果（使用腻子），并且在 WSACleanup(); 处出现异常；WSACleanup 的例外是`An invalid handle was specified`.

**更新**通过更仔细地[阅读这篇文章](https://stackoverflow.com/questions/8776103/how-to-redirect-fprintf-output-to-c-socket)，我发现了一个强有力的领先优势。如果我更换：

```
fprintf(file_handle_to_socket, "Hello World\r\n"); 
```

和

```
fprintfsock(client, "Hello World\r\n"); 
```

有用。

不过，这仍然不是我问题的完整答案。我正在寻找直接使用 fprintf() 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T19:01:22.273

A socket is not a file handle, so you cannot use `_open_osfhandle()` to wrap it. That is why `fprintf()` is not working. `fprintfsock()` is specifically designed to work with a socket directly. It is merely a wrapper that formats the data into a local buffer and then uses the socket API `send()` function to send it. If you really want to use `fprintf()` with a socket, you will have to `#undef fprintf` and then `#define fprintf()` to re-map it to `fprintfsock()` (which will only work if you are using a compiler that supports variadic macros). Otherwise, just use `fprintfsock()` directly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-31T13:02:42.657

[我对使用 mingw 的套接字上](https://stackoverflow.com/a/24374843/3102264)的客户端部分 fprintf 也有类似的担忧，您应该尝试以非重叠模式创建套接字：

```
int sock = WSASocket(AF_INET, SOCK_STREAM, 0, NULL, 0, 0); 
```

# git - 我应该更喜欢 git merge 还是 git merge --squash

> ID：14344446
> 
> 赞同：1
> 
> 时间：2013-01-15T18:32:14.737
> 
> 标签：git

我一直在来回走动，不能完全决定哪个工作流程更好。我是否更喜欢压缩合并到 master 中的分支？或者我应该合并它们。

我喜欢 merge -squash 并且一直在使用它。

合并 --squash 的优点：

1.  更清洁的历史。
2.  更容易使用对分。

有什么理由我不应该使用 merge --squash 而是使用普通的旧合并？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:27:37.890

当您想要保留所有间歇性提交时，快进合并很有用，例如当分支尝试一些可能不起作用的事情时。丢弃临时分支比重置工作分支更容易。但是，当实验工作时，最好将提交快速转发到工作分支，将其保留为保留实验时的状态。

我没有理由不将工作提交压缩成一个包含所有更改的消息的综合提交。正如您所指出的，这使历史记录保持干净且更易于使用。从我所见，这是保持树清洁的首选方法。

`git merge --squash`与一个父级进行提交，因此它不显示与正在合并的父级的连接。

```
-A---------C  <-- `git merge --squash`
  \
   *--*--B 
```

另一种选择是使用`git merge --no-ff`（不快进）强制合并提交。这个提交将有父母双方。优点是保持树干净，同时在需要时仍具有详细的提交历史记录。

```
-A---------C  <-- `git merge --no-ff`
  \       /
   *--*--B 
```

两个`C`提交是相同的，当你想保留时选择后者`B`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T19:47:14.453

这取决于。

挤压会丢失信息，是否挤压取决于该信息是否重要。对于在六个月或六年后试图弄清楚为什么一行代码是这样的人来说很重要。这取决于分支中的内容、更改的数量、更改的大小以及日志消息的质量。

一个简单的经验法则？考虑壁球的结果并问自己“如果我在 master 上编码，我会这样做吗？” 如果答案是肯定的，那么 diff 和 log 一起将允许人们在未来弄清楚为什么一行代码发生了变化，然后压缩合并。

如果答案是否定的，这将不是一个可以接受的对 master 的提交，有太多变化或太多交织在一起的变化，那么不要挤压它。合并它，也许在考虑是否可以将分支中的任何提交压缩在一起之后。

至于挤压是“更干净”和“更容易平分”......我觉得这只是表面上的。如果你把书架上的所有书页都拿出来缝成一个巨大的封面，这样你现在只需要担心一本书就可以了。如果它们是一堆各自独立的小说，那就无济于事了。如果它们是年度会议报告，最好将它们捆绑在一起。

从某种意义上说，平分更容易，因为您不太可能有破坏构建的提交，但是如果您的平分落在一个巨大的变化上，人们仍然不得不对可能有原因的大量可能性感到困惑问题，它使平分线的工作更加困难。

使用与提交到 master 时相同的标准来决定是否压缩合并，这样就可以了。

# linux - 如何递归 chmod 目录名称中包含空格字符

> ID：14344454
> 
> 赞同：0
> 
> 时间：2013-01-15T18:32:38.040
> 
> 标签：linux, command-line, chmod

```
find . -type d | xargs chmod 770 
```

不起作用，给出“没有这样的文件或目录”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:35:04.337

如果您只想进行递归，请使用`-R`.

```
chmod -R 770 dir_path 
```

这是你想要的吗：

```
find . -type d | xargs -I {} chmod -R 770 "{}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:35:42.077

您想使用`print0`选项`find`来处理文件名中的空格

```
find . -type d -print0 | xargs chmod 770 
```

为什么不只使用`-R`选项：

```
chmod -R 770 dir 
```

# html - 页面元素在视口之外被截断

> ID：14344459
> 
> 赞同：0
> 
> 时间：2013-01-15T18:33:04.603
> 
> 标签：html, css

我正在处理的网页有问题，我觉得很难描述。当在一个小的浏览器窗口中查看时，页面会在水平滚动到浏览器视口之外的内容时被切断。是什么导致了这个问题？如何修复？提前致谢。

这是我在野外发现的问题的一个示例：

![Fedora CSS](../Images/8cb8e0136a3f5b8e0418a612de4a27e5.png)

请注意，我不会使用媒体查询来实现此页面的响应式设计。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:36:52.987

很有可能你已经设置了一些东西`width: 100%`，但是你没有`min-width`在 body 上设置，这会导致 100% 宽的元素只和窗口一样宽。

尝试这样的事情：

```
body {
  min-width: 960px;
} 
```

或者无论页面的最小宽度是多少。

# c++ - 扫描双精度的快速方法 - c++

> ID：14344461
> 
> 赞同：0
> 
> 时间：2013-01-15T18:33:12.263
> 
> 标签：c++, c, performance, double, micro-optimization

我正在尝试优化我对一个需要快速双重扫描的问题的解决方案。我试图实现一个从标准输入读取双精度的函数，但我失败了。有人可以给我一些简单的代码来有效地实现这一点吗？提前致谢。

**注意**这里是我的尝试，它似乎有一些问题：

```
#include <stdio.h>
#include <stdlib.h>

inline double getDouble(FILE *f = stdin) {
    char tmp[20], ch;
    bool seen = false;
    double sign = 1.0;
    short index = 0;

    while((ch = getc(stdin)) != EOF) {
        if(ch == '-') {
            sign = -1.0;
            continue;
        }
        if(ch == ' ' || ch == '\n') {
            if(seen) break;
        } else {
            seen = true;
            tmp[index++] = ch;
        }
    }
    return sign * (double)atof(tmp);
}

int main() {
    int n;
    scanf("%d", &n);

    double *d = new double[n];

    for(int i=0; i<n; ++i) {
        d[i] = getDouble();
    }

    for(int i=0; i<n; ++i) {
        printf("%.5lf\n", d[i]);
    }

    return 0;
} 
```

**输入：**

```
16
-2 -1 -4 -5
1 1 1 1
1.233 -435 -2.44
3
2 3 42 4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:14:46.610

```
#include <stdio.h>
#include <stdlib.h>

inline double getDouble(FILE *f = stdin) {
    double d;
    scanf("%lf", &d);
    return d;
}

int main() {
    int n;
    scanf("%d", &n);

    double *d = new double[n];

    for(int i=0; i<n; ++i) {
        d[i] = getDouble();
    }

    for(int i=0; i<n; ++i) {
        printf("%.5lf\n", d[i]);
    }

    return 0;
} 
```

编辑：它确实可以更快一些，我估计以下速度是 2 到 3 倍，它会通过你的输入，但需要一些假设，在测试样本之外不能保证:)

```
inline double getDouble(FILE *f = stdin) {
    char ch;
    bool seen = false;
    bool sign = false;
    char values[10];
    double result =0.;
    bool beforeDot = true;
    int beforeLength = 0;
    double multiplier;

    while((ch = getc(stdin)) != EOF) {
        if(ch == '-') {
            sign = true;
            continue;
        }
        if(ch == ' ' || ch == '\n') {
            if(seen) break;
            continue;
        }
        if(ch == '.') {
            beforeDot = false;
            multiplier = 1.;
            while(beforeLength) {
                result += (double)(values[--beforeLength] - '0') * multiplier;
                multiplier *= 10.;
            }
            multiplier = 10.;
        }
        else {
            if(!beforeDot)
            {
                result += double(ch - '0') / multiplier;
                multiplier *= 10.;
            } else {
                values[beforeLength++] = ch;
            }
            seen = true;
        }
    }
    if(beforeDot) {
        multiplier = 1;
        while(beforeLength) {
            result += (double)(values[--beforeLength] - '0') * multiplier;
            multiplier *= 10.;
        }
    }

    if(sign) result *= -1.;

    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:53:51.533

我的第一个测试是：

```
inline double getDouble(std::istream& in = std::cin)
{
     double value;
     if (!(in >> value)) {throw "Error";}
     return value;
} 
```

如果这还不够快（只有那时），我会尝试：

```
inline double getDouble(FILE *f = stdin)
{
    double value;
    if ((scanf(f, "%e", &value) != 1) { throw "Error";}
    return value;
} 
```

如果这还不够快（只有那时），我会尝试：
而且我怀疑这会比 scanf() 更快，因为人们有很多时间来优化它

```
inline double getDouble(FILE *f = stdin)
{
     int c;

     // Ignore leading white space
     while((c = getc(f) != EOF) && std::is_space(c)) {/*Loop*/}

     // Only dealing with reals that look like this:
     // [+|-]?[0-9]+(.[0-9]*)?
     // or
     // [+|-]?([0-9]*)?.[0-9]+

     // Deal with sign
     c=getc(f);
     char sign = 1;
     if ((c == '-') || (c == '+'))
     {
         if (c == '-') { sign = -1;}
         c=getc(f);
     }

     int  top
     int  bot;
     // See if next character is a '.'
     if (c == '.')
     {
         top = 0;
         bot = readDigits(f, c, true);
     }
     else
     {
         top = readDigits(f, c, true);
         bot = 0;
         if (c == '.')
         {
             c = getc(f);
             bot = readDigits(f, c, false);
         }
     }
     //put back the last unused character
     putc(c, f);

     // calculate the result.
     double result = sign * (top*1.0 + (bot*1.0/getSizeofBot(bot)));
     return result;
}
int readDigits(FILE* f, int& c, bool digitRequired)
{
     // c contains the first character.
     // It should contain the last character read on exit.

     // If digitRequired is true it is an exception to not 
     // find a digit, Other wise it is OK.
     if ((digitRequired) && !std::is_digit(c))
     {    throw "Error";
     }
     // Read an integer and return its value.
     int value = 0;

     while(std::is_digit(c))
     {
         value = value * 10 + (c - '0');
         c = getc(f);
     }
     return value;
} 
```

# c# - 使用 GDI+ 绘制多个移动对象

> ID：14344463
> 
> 赞同：1
> 
> 时间：2013-01-15T18:33:24.047
> 
> 标签：c#, winforms, gdi+

我在 PictureBox Image 画布上绘制了一些形状，但我遇到了一个问题，我需要同时在画布周围为它们设置动画。

因为我需要更新画布上形状的位置，这意味着我需要清除画布并重新绘制所有内容，这显然会在更新时产生闪烁效果。

我有什么选择来解决这个问题？我发现移动它们的唯一方法是让形状“跟踪”，这不是我想要的。

这里有一些代码来解释我的困境：

```
Form_Load:
      OriginalImage = pictureBox1.Image;

Timer_Tick:
    pictureBox1.Image = OriginalImage;
    Image canvas = (Image)pictureBox1.Image.Clone();
    Graphics g = Graphics.FromImage(canvas);
    g.DrawRectangle(newPosition);

Timer2_Tick:
    // This will clear the canvas and only draw the ellipse, which means I can't get both shapes on at the same time.
    pictureBox1.Image = OriginalImage;
    Image canvas = (Image)pictureBox1.Image.Clone();
    Graphics g = Graphics.FromImage(canvas);
    g.FillEllipse(newPosition);
    pictureBox1.Image = 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:48:51.243

跟踪所有形状位置（我假设您已经是）并使用图片框的`Paint`事件。

然后做这样的事情：

```
 private void pictureBox1_Paint(object sender, PaintEventArgs e)
    {
        e.Graphics.DrawRectangle(your_rectangle);
        e.Graphics.DrawEllipse(your_ellipse);
    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        pictureBox1.Invalidate();
    } 
```

每次重新绘制图片框时，它都会在相关位置绘制矩形和椭圆。要使图片框更新（重绘），您可以在计时器中使用 .Invalidate() 方法，因此每次计时器触发它都会更新您的图片框。将计时器间隔设置为您希望图像更新的频率。

您也不需要每次都绘制图片框的图像，只需在表单加载事件中设置一次即可。

```
 private void Form1_Load(object sender, EventArgs e)
    {
        pictureBox1.Image = myImage;
    } 
```

A`PictureBox`按照标准是双缓冲的，所以你不应该闪烁。

# c# - 添加/删除示例的 MVVM 设计

> ID：14344466
> 
> 赞同：1
> 
> 时间：2013-01-15T18:33:32.450
> 
> 标签：c#, wpf, mvvm

我在 MVVM 模式上遇到的一件事是当我尝试实现额外的 Windows 时。当我创建一个额外的 Window 和 ViewModel 以配合那个将服务于特定目的的 Window 时，我的设计似乎迷失了。

以我有一个非常简单的应用程序为例。这是我可以添加/删除/恢复的人员列表。我的初始设计是从 ViewModel 处理删除/恢复，但添加时我必须向用户请求信息。鉴于此，我创建了一个新的 Window 和 ViewModel (AddWindow/AddViewModel)。在这一点上，我迷路了。我已经阅读了有关创建控制器以在它们之间进行通信的信息，但我什至不确定这是否有意义。

在 AddWindow 上，用户可以填写两个字段（名字/姓氏），然后单击添加（或取消），在这种情况下，需要将数据传递回 ViewModel，以便可以将其添加到集合中它已更新（AddWindow 也必须关闭）。

我怎样才能以更好的方式思考这个问题，我可以在这里做些什么来解决这样一个简单的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:55:27.967

> 我怎样才能以更好的方式思考这个问题，我可以在这里做些什么来解决这样一个简单的问题？

尽量保持简单。不要不必要地添加视图/视图模型组合。在您的情况下，如果可能，请将 Add 功能放在现有视图中。也许您可以将您的视图/视图模型重命名为更通用的名称，例如“ManageThisView”/“ManageThisViewModel”？现在你有一个堆栈来管理一组相关的功能。

通过切换控件的可见性或使用节省空间的控件，尝试在您的视图上发挥创意。只要视图是直观的，用户可能更喜欢它而不是需要大量表单导航的方案。

我并不是建议您创建包含太多内容的“超级”视图/视图模型，而是考虑对相关功能进行分组并简化您拥有的类的数量。

有时间创建更多类并使用 Prism 等框架，但您的似乎不是一个好的候选者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:56:27.750

创建一个新类 ApplicationModel 来保存所有用户数据。您的“主”视图模型应该创建它，然后将它保存在一个属性中。您的视图需要绑定到模型中数据的完整路径：

```
<DataGrid ItemsSource="{Binding Path=Model.ListOfThingsToDo, Mode=OneWay}" ... /> 
```

在新 ViewModel 的构造函数中，您将该模型作为参数提供。这样，您的所有 ViewModel 将共享相同的模型，并且新的 ViewModel 可以修改/查看与您的“主” ViewModel 相同的数据。

```
/// <summary>
/// ViewModel for the Main Window
/// </summary>
class MainViewModel
{
    public ApplicationModel Model { get; set; }

    public MainViewModel()
    {
        Model = new ApplicationModel();
        Model.ListOfThingsToDo.Add("Clean the yard");
        Model.ListOfThingsToDo.Add("Walk dog");
    }

    // Some method that will be called when you want to open another window
    public void OpenTheWindow()
    {
        var modalViewModel = new NewTaskViewModel(Model);
        // Create an instance of your new Window and show it. 
        var win = new NewTaskWindow(modalViewModel);
        win.ShowDialog();
    }
}

/// <summary>
/// Model to hold the data
/// </summary>
class ApplicationModel
{
    public ObservableCollection<string> ListOfThingsToDo { get; set; }
    public ApplicationModel()
    {
        ListOfThingsToDo = new ObservableCollection<string>();
    }
}

/// <summary>
/// ViewModel to handle adding new things to do
/// </summary>
class NewTaskViewModel
{
    public ApplicationModel Model { get; set; }

    public NewTaskViewModel(ApplicationModel model)
    {
        Model = model;
    }

    // Add methods here that will be called to add tasks to the Model.ListOfThingsToDo
    public void AddTask()
    {
        Model.ListOfThingsToDo.Add("the new task to do");
    }
} 
```

# c - 如何纠正从客户端读取数据的套接字编程错误？

> ID：14344468
> 
> 赞同：-4
> 
> 时间：2013-01-15T18:33:34.757
> 
> 标签：c, sockets

以下*c socket编程代码*一直在循环，无需等待从文件描述符中获取数据。这是服务器端套接字编程的一部分。它不等待接受来自客户端的请求。请帮忙。

代码：

```
while(1){  
  bzero(buffer,256);
  read(newsockfd,buffer,256);  
  printf("%s",buffer);  
  if(n<0){
    printf("reading client message failed\n");    
    return 0;
  }  
  printf("success\n");  

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:10:04.217

您没有将返回值分配`read()`给您的`n`变量，但您希望`n`以某种方式知道何时`read()`失败。修复该分配，然后还修复您的循环逻辑以仅输出实际读取的字节，例如：

```
while(1){  
  memset(buffer,0,256);
  printf("sssssssss\n");  
  n = read(newsockfd,buffer,256);
  if(n<0){
    // if your sockeet is non-blocking then uncomment this code...
    /*
    if ((errno == EAGAIN) || (errno == EWOULDBLOCK)){
        fd_set rfd;
        FD_ZERO(&rfd);
        FD_SET(newsockfd, &rfd);

        struct timeval timeout;
        timeout.tv_sec = 5;
        timeout.tv_usec = 0;

        if (select(newsockfd+1, &rfd, NULL, NULL, &timeout) > 0){
            continue;
        }
    }
    */
    printf("reading client message failed\n");    
    return 0;
  }  
  if(n==0){
      break;
  }  
  printf("%.*s\n",n,buffer);  
  printf("succcccccccccccccc\n");  
} 
```

# python - 在mysql中定期向表中添加数据

> ID：14344473
> 
> 赞同：1
> 
> 时间：2013-01-15T18:33:58.313
> 
> 标签：python, mysql, django

我有包含重复字段的收入表。现在，如果用户将recurrence_type 选择为“Monthly”或“Daily”，那么我必须将行添加到“daily”或“monthly”收入表中。Mysql 中是否有任何方法可以定期将数据添加到表中？我正在使用 Django 框架来开发 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:41:40.850

据我所知，MySQL 中没有这样的功能。即使 MySQL 可以做到，这也不应该是它的工作。这些功能应该是您应用程序中业务逻辑的一部分。

正常的方法是在服务器中设置 cron 作业。cron 作业会在您设置的时间唤醒，然后调用您的 python 脚本或 SQL 来完成添加数据的工作。而且脚本比直接 SQL 要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-25T09:28:19.957

使用 django-celery 包并在其中创建作业以定期更新数据

# python - 解析之前的python csv模块条线

> ID：14344474
> 
> 赞同：0
> 
> 时间：2013-01-15T18:33:58.833
> 
> 标签：python, csv, python-2.7

我有一个纯文本文件：

```
 2 jordyt
    2 dawder
    2 LOL12345
    2 2251084185
    2 123456789
    2 123456
    1 warcraft
    1 tripp88 
```

通过`python's csv`模块解析后，我有：

```
with open(filename,'r') as csvfile:
    reader = csv.reader(csvfile,delimiter=' ')
    for row in reader:
        print row

['', '', '', '', '', '', '2', 'jordyt']
['', '', '', '', '', '', '2', 'dawder']
['', '', '', '', '', '', '2', 'LOL12345']
['', '', '', '', '', '', '2', '2251084185']
['', '', '', '', '', '', '2', '123456789']
['', '', '', '', '', '', '2', '123456']
['', '', '', '', '', '', '1', 'warcraft']
['', '', '', '', '', '', '1', 'tripp88'] 
```

编辑1：

我期望这样的输出：

```
['2', 'jordyt']
['2', 'dawder']
['2', 'LOL12345']
.
.
. 
```

我可以使用自定义预处理器解决此问题。但是，那些文件太大了，读两遍也不好。

我的问题是：我怎样才能告诉 csv 模块在解析之前去掉这些行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:42:44.670

一种选择是提供[`skipinitialspace`](http://docs.python.org/2/library/csv.html#csv.Dialect.skipinitialspace)参数：

```
with open(filename,'r') as csvfile:
    reader = csv.reader(csvfile,delimiter=' ',skipinitialspace=True)
    for row in reader:
        print row 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T18:38:16.087

如果您的分隔符是空格，那么我很想不使用 CSV 模块（如果您知道没有带空格的引用字段）：

这很好地利用了连续分隔符的性质`split()`或`split(None)`处理连续分隔符。

```
with open(filename,'r') as csvfile:
    for row in csvfile:
        print row.split() 
```

或者，如果您需要处理它并使用 CSV 模块，只需在您的输入文件上创建一个生成器并将其传递给阅读器）：

```
with open(filename,'r') as csvfile:
    stripped = (row.strip() for row in csvfile)
    reader = csv.reader(stripped,delimiter=' ')
    for row in reader:
        print row 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:47:33.683

我质疑你在这种情况下对 csv 的使用，因为 split() 会做你想做的事。

```
with open(filename, 'r') as csvfile:
    for row in csvfile:
        words = row.split()
        print words 
```

打印（用于您的数据）：

```
['2', 'jordyt']
['2', 'dawder']
['2', 'LOL12345']
['2', '2251084185']
['2', '123456789']
['2', '123456']
['1', 'warcraft']
['1', 'tripp88'] 
```

# xcode - 未找到体系结构 i386 的符号？

> ID：14344475
> 
> 赞同：0
> 
> 时间：2013-01-15T18:34:05.610
> 
> 标签：xcode, xcode4

我正在尝试实现具有多个标记的地图。但是我被这个错误所困扰。

架构 i386 的未定义符号：

```
 "_xmlFreeDoc", referenced from:

      +[MTDXMLElement nodesForXPathQuery:onXML:namespacePrefix:namespaceURI:] in MTDirectionsKit(MTDXMLElement.o)

  "_xmlReadMemory", referenced from:

      +[MTDXMLElement nodesForXPathQuery:onXML:namespacePrefix:namespaceURI:] in MTDirectionsKit(MTDXMLElement.o)
  "_xmlXPathEvalExpression", referenced from:

      +[MTDXMLElement mtd_nodesForXPathQuery:namespacePrefix:namespaceURI:libXMLDoc:] in MTDirectionsKit(MTDXMLElement.o)

  "_xmlXPathFreeContext", referenced from:

      +[MTDXMLElement mtd_nodesForXPathQuery:namespacePrefix:namespaceURI:libXMLDoc:] in MTDirectionsKit(MTDXMLElement.o)
  "_xmlXPathFreeObject", referenced from:

      +[MTDXMLElement mtd_nodesForXPathQuery:namespacePrefix:namespaceURI:libXMLDoc:] in MTDirectionsKit(MTDXMLElement.o)
  "_xmlXPathNewContext", referenced from:

      +[MTDXMLElement mtd_nodesForXPathQuery:namespacePrefix:namespaceURI:libXMLDoc:] in MTDirectionsKit(MTDXMLElement.o)
  "_xmlXPathRegisterNs", referenced from:

      +[MTDXMLElement mtd_nodesForXPathQuery:namespacePrefix:namespaceURI:libXMLDoc:] in MTDirectionsKit(MTDXMLElement.o)
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有人可以通过“未找到架构 i386 的符号”来解释我的意思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:30:49.820

您的库 MTDirectionsKit 不支持模拟器。根据您获得库的位置，您必须将其重新构建为通用库，或者包含（并正确配置您的构建设置）模拟器（调试模拟器）的静态库。

Xcode 4 停止构建静态通用库。因此，根据开发人员的不同，它们不是作为一个构建，而是 4 个独立的库。您可以将它们捆绑到 1 中，但您需要添加构建脚本来处理它。

# python - 如何在 python 中从 HTML 页面中剥离整个 HTML、CSS 和 JS 代码或标签

> ID：14344476
> 
> 赞同：0
> 
> 时间：2013-01-15T18:34:07.457
> 
> 标签：python, regex, html-parsing, beautifulsoup

> **可能重复：**
> [BeautifulSoup Grab Visible Webpage Text](https://stackoverflow.com/questions/1936466/beautifulsoup-grab-visible-webpage-text)
> [使用 Python抓取网页](https://stackoverflow.com/questions/2081586/web-scraping-with-python)

假设我是一个非常复杂的 HTML 页面，中间包含常用的 HTML 标签、CSS 和 JS。我们可能会看到所有最坏的情况。

我想要的只是剥离所有上述标签/代码并返回“文本”。

简单来说：

```
<html><body>Text</body></html> 
```

这可能包含 JS、CSS 等等等。

我正在尝试使用 BeautifulSoup，但它没有从代码中删除 JS.. 现在，我正在考虑使用 Regex.. 但不知道该怎么做

**编辑1**

这是我在一个简单的引导 html 页面上的尝试...

```
from bs4 import BeautifulSoup as bs
import requests

bs( requests.get(MY-URL).text ).get_text() 
```

$ 返回文本

```
html
Home
Le styles
body {
        padding-top: 10%;
        padding-left: 30%;
      }
HTML5 shim, for IE6-8 support of HTML5 elements
[if lt IE 9]>
      <script src="http://htm...html5.js"></script>
    <![endif]
Home | Under Construction
Sample Page 1
The app
might
face some ........
Firefox
. Ple..
/container
var _gaq = _gaq || [];

  _gaq.push(['_trackPageview']);

  (function() {
    var ga = do...............
  })(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:52:03.637

Django 使用这个函数从文本中去除标签：

```
def strip_tags(value):
    """Returns the given HTML with all tags stripped."""
    return re.sub(r'<[^>]*?>', '', force_unicode(value)) 
```

（你不需要 force_unicode 部分）

# c# - 两相类型推理混淆

> ID：14344478
> 
> 赞同：3
> 
> 时间：2013-01-15T18:34:16.297
> 
> 标签：c#, generics

我正在深入阅读 C#，对亲爱的作者解释的 2 阶段类型推理规则感到困惑。

考虑代码：

```
static void PrintConvertedValue<TInput,TOutput> (TInput input, Converter<TInput,TOutput> converter) 
{ Console.WriteLine(converter(input)); } 
... 
PrintConvertedValue("I'm a string", x => x.Length); 
```

之后，他解释了使用两阶段推理算法进行推理的过程。

> 1.第一阶段开始。
> 
> 2 **、第一个参数是TInput类型，第一个参数是字符串类型。我们推断必须存在从字符串到 TInput 的隐式转换。**
> 
> 3.第二个参数是Converter类型，第二个参数是一个隐式类型的lambda表达式。没有进行推理——我们没有足够的信息。
> 
> 4.第二阶段开始。
> 
> 5.**`TInput`不依赖任何不固定的类型参数，所以固定为字符串。**
> 
> 6.第二个参数现在有一个固定的输入类型，但一个不固定的输出类型。我们可以认为它是`(string x) => x.Length`并推断返回类型为 int。因此，必须进行从 int 到 的隐式转换`TOutput`。
> 
> 7.第二阶段重复。
> 
> 8.`TOutput`不依赖任何不固定的东西，所以它固定为int。9现在没有不固定的类型参数，所以推断成功

我对第 2 步和第 5 步感到非常困惑。在第 2 步中，编译器如何进行这样的推断？我的意思是世界转换是如何进入现场的？转换发生 BTW 类型而不是 BTW 类型参数和类型，不是吗？

第 5 步完全让我无法理解，任何人都可以向我展示一个类型参数可以依赖于其他类型参数的简化示例，请解释作者试图暗示什么？

我敢于潜入 C# 规范，但似乎聪明的人为非常相似的聪明人做了它，而不是像我这样的猴子:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:38:24.490

转换发生在*values*上，我们能够使用字符串值作为类型参数的参数来调用该方法，这`TInput`意味着必须进行从`string`to的转换`TInput`。如果`TInput`被推断为 be `int`，那么我们将调用一个需要 a 的方法`int`，但给它 a `string`- 这显然是无效的。

请注意，对于一个更简单的示例，只需将其更改为：

```
void Foo<T>(T input) { } 
```

调用：

```
Foo("Hello"); 
```

必须进行从`string`to的转换`T`才能使调用有效，并且由于没有关于 的*其他*信息`T`，我们推断它`T`就是`string`.

在一个稍微复杂一点的例子中，你可以有：

```
public void Bar<T>(T x, T y) {}

Foo("Hello", new object()); 
```

在这里，我们推断：

*   必须有从`string`到的转换`T`
*   必须有从`object`到的转换`T`

...所以我们推断那`T`是`object`。

至于类型参数依赖，来自 C# 5 规范的第 7.5.2.5 节：

> 一个非固定类型变量 Xi 直接依赖于一个非固定类型变量 Xj，如果对于某个具有类型 Tk 的参数 Ek，Xj 出现在一个类型为 Tk 的 Ek 的输入类型中，并且 Xi 出现在一个类型为 Tk 的 Ek 的输出类型中。
> 
> 如果 Xj 直接依赖于 Xi，或者 Xi 直接依赖于 Xk 而 Xk 依赖于 Xj，则 Xj 依赖于 Xi。因此，“取决于”是“直接取决于”的传递闭包但不是自反闭包。

例如：

```
public void Foo<T1, T2>(T1 value, Func<T1, T2> func) 
```

和：

```
Foo("foo", x => x.Length); 
```

这里`T2`取决于`T1`- 一旦我们推断`T1`，我们就可以推断`T2`。

# excel - Excel用连续x轴绘制时间序列频率

> ID：14344482
> 
> 赞同：9
> 
> 时间：2013-01-15T18:34:53.893
> 
> 标签：excel, plot, time-series

我想绘制类似于下面的时间序列频率数据。我尝试了许多类型的图表，但它们都将时间（即 08:00）完全放在数据系列列下，我也尝试输入 8-9 、 9-10、 10-11 ...但这看起来很糟糕，因为时间系列需要是连续的。我希望将 8:00 和 18:00 作为起点和终点，数据系列应高于区间，介于 8-9-10-11 等之间。有什么建议吗？

```
08:00:00 - 09:00:00     12
09:00:00 - 10:00:00     11
10:00:00 - 11:00:00     13
11:00:00 - 12:00:00     12 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T21:33:07.720

您可以按照您想要的方式在 Excel 中获得良好的时间序列图，但您必须处理一些怪癖。

1.  请务必选择“散点图”（带有线选项）。如果您的时间戳不统一，则需要这样做，并将相应地缩放 X 轴。

2.  在您的数据中，您需要添加一个带有中点的列。这是我对您的示例数据所做的。（此技巧可确保数据绘制在中点，如您所愿。） ![在此处输入图像描述](../Images/7b5e6313651f101ac10faa1ce195f536.png)

3.  您可以使用此菜单格式化 x 轴选项。（**图表->设计->布局**） ![在此处输入图像描述](../Images/1eeb9371bb568802a723f1a9a7fbebc2.png)

4.  选择“轴”并转到主水平轴，然后选择“**更多主水平轴选项**”

5.  设置您想要的选项。（固定起点和终点。） ![在此处输入图像描述](../Images/644c0263a44a23272c179b68d384f174.png)

6.  您将获得如下图所示的图表。 ![在此处输入图像描述](../Images/de98d559a4fad441df149ae84cf92287.png)

然后，您可以调整许多选项，更好地标记轴等，但这应该可以帮助您入门。

希望这可以帮助您继续前进。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-05T23:19:48.717

我想用我在[Excel 博客](http://blogs.office.com/b/microsoft-excel/archive/2007/12/17/intraday-time-series-charts.aspx)上找到的一些提示来赞美[Ram Narasimhan的回答](https://stackoverflow.com/a/14368250/2078851)

非均匀分布的数据可以在excel中绘制

*   XY（散点图）
*   带有日期轴的线性图
    *   这些不考虑时间，只考虑几天。
    *   这种方法非常麻烦，因为它需要将您的时间单位转换为天、月或年……然后更改轴标签……不推荐

就像 Ram Narasimhan 建议的那样，要使点居中，您需要中间点，但您不需要移动到数字格式，您可以保持时间格式。

1-将中心点添加到您的数据系列

```
+---------------+-------+------+
|    Time       | Time  | Freq |
+---------------+-------+------+
| 08:00 - 09:00 | 08:30 |  12  |
| 09:00 - 10:00 | 09:30 |  13  |
| 10:00 - 11:00 | 10:30 |  10  |
| 13:00 - 14:00 | 13:30 |   5  |
| 14:00 - 15:00 | 14:30 |  14  |
+---------------+-------+------+ 
```

2- 创建散点图

3- Excel 允许您为轴选项指定时间值。时间值是一天 24 小时的每 1 分之一。因此，如果我们想要 08:00 到 15:00，那么我们将 Axis 选项设置为：

*   最小值：修复：0.33333
*   最大值：修复：0.625
*   主要单位：修正：0.041667

![线散点图](../Images/722c5dd15e03845453fe679078e984e2.png)

* * *

替代显示：

## 使点变成列：

为了能够将这些点表示为条形而不仅仅是点，我们需要绘制不相交的线。这是获取此类图表的一种方法。

1-您将需要添加几行我们画线并分离数据

```
+-------+------+
| Time  | Freq |
+-------+------+
| 08:30 |   0  |
| 08:30 |  12  |
|       |      |
| 09:30 |   0  |
| 09:30 |  13  |
|       |      |
| 10:30 |   0  |
| 10:30 |  10  |
|       |      |
| 13:30 |   0  |
| 13:30 |   5  |
|       |      |
| 14:30 |   0  |
| 14:30 |  14  |
+-------+------+ 
```

2- 绘制带有线条的 XY（散点图）图。

3- 现在您可以调整数据系列，使其线条更粗、没有标记等。以获得具有非均匀分布数据的条形/柱形图表。

![条线散点图](../Images/8370199765e50f9a01c09fb64ccf204b.png)

# c - 怎么说c编译器它们是十六进制值

> ID：14344487
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:34:59.040
> 
> 标签：c

我正在尝试编写校验和评估器。我写了下面的代码；

```
0xFF -
    (  (
        0x10 + 0x01 +0x00+  0x13+  0xa2+ 0x00+ 0x40+  0x4a+
            0xfd + 0x15 + 0xff + 0xfe+ 0x00+ 0x08 +
                ( 1 + 30 ) +
                ( 2 + 30 )
           )
   & 0xFF
 ) 
```

见 (1 + 30) 和 (2 + 30) 行，它们被转换为十六进制值，但在加法时它们被转换，结果不是预期的。有什么办法可以说 (1 + 30) 是我的 c 编译器兄弟的十六进制值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:37:30.883

如果您希望编译器`30`用作十六进制值，请使用`0x`. 喜欢`(0x1 + 0x30) + (0x2 + 0x30)`

`int a`- 这里`a`可以存储`+2^31`to的值`-(2^31-1)`，它的范围不是`0`to `9`。`a`始终以二进制格式存储值。我们可以以任何格式打印它，例如十进制、十六进制或八进制。`printf("%d, %x, %o", a, a, a);`

因此，如果您想使用变量`a`代替`30`. 像下面这样使用。

```
int a = 0x30; //or int a = 48; 48 is the decimal representation of 0x30
....
(0x1 + a)
.... 
```

不要与十六进制值混淆太多。它只是一个值的表示。如果你有 10 支笔，你可以说喜欢

*   我有`10` 十进制格式的笔
*   我有`0xA`十六进制格式的笔
*   我有`12` 八进制格式的笔

# mongodb - 如何使用 @Query 注释在 mongodb 中查找所有文档（在集合中）

> ID：14344493
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:16.630
> 
> 标签：mongodb, spring-annotations, spring-data-mongodb

`@Query`注释可以为特定方法指定 MongoDB 查询。一个例子可能是`@Query("{ 'firstname' : ?0 }")`。但是，`@Query`如果我只想查找所有文档而不指定“where”子句，那么参数应该是什么？下面的代码说明了我想要实现的目标，但问题可能很简单：获取所有文档的 JSON/BSON 查询是什么？

```
@NoRepositoryBean
public interface QuoteRepository {

    public QuoteProvider findByName(String name);

    public List<QuoteProvider> findAllQuoteProviders();

}

@Repository
public interface MongoQuoteRepository extends QuoteRepository, MongoRepository<QuoteProvider, String> {

    @Query("findAll") // What should this be?
    @Override
    public List<QuoteProvider> findAllQuoteProviders();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:06:21.990

我目前无法测试，但据我所知，它具有与 相同的查询语法`find()`，这应该可以在没有条件的情况下获取所有条目；

```
@Query("{}") 
```

# php - 用php动态设置选择选项索引

> ID：14344503
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:35.763
> 
> 标签：php, javascript, option

我今天正在处理一个 PHP 表单，我需要一些关于`<select> & <option>`标签的帮助。我想要做的是从中获取一个`$_GET`已经在`<option>`列表中的值并将其显示为索引。我的表单的工作方式是用户选择一个位置并点击更新按钮。当页面提交时，它会发送该值`$_GET`，然后使用它从数据库中获取正确的信息。在查看上述信息后，他们可以选择删除它，这是我需要的地方。问题是他们必须重新选择位置才能删除它。我需要保持选中的值。

例如，假设用户在选择框中单击 NJ 并单击更新。该页面将提交并显示餐厅评论。我希望选择框保持 NJ 的值，直到用户更改它。

我的快速解决方法是在列表的开头使用以下代码`<option>`：

```
<?php
    if($_GET['chooseLocation'])
        echo "<option>$_GET['chooseLocation']</option>";
?> 
```

唯一的缺点是它会显示 NJ 两次。

1）我在正确的轨道上吗？

2) 由于我`$_GET`在 URL 中使用和存储信息，我应该使用 javascript 来代替吗？

我浏览了大约 15 个问题，但没有一个回答我的问题。如果您认为这是转发或复制，请在评论中发布原件，以便我看到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:43:26.033

我不知道你的整个代码，只知道那一小部分。我通常这样做的方式是通过`selected`属性和我的项目的某种 ID。我猜您正在从数据库中读取信息，而您从一页到另一页维护的信息就是该选项的值。我做这样的事情：

```
<?php
for( $i = 0; $i < count($options); ++$i ) {
    echo "<option";
    if( $_GET['chooseLocation'] && $_GET['chooseLocation'] == $options[$i] ) {
        echo "selected";
    }
    echo ">{$options[$i]}</option>";
}
?> 
```

或者，您可以假设现在几乎每个用户都有 JavaScript。`selected`因此，您实际上可以通过在 DOM 就绪或页面加载时（例如使用 jQuery）“附加”属性来对 JavaScript 做同样的事情。当然仍然有少数人拒绝使用 JavaScript，但我现在没有统计数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:44:34.190

您可以像现在一样正常提交表单，但附加一个功能：

```
<form obsubmit="return stay_freeze()" .. > 
```

并为您的选择提供 id

```
function stay_freeze(){
    var opt = $("option[val=ID]");
    opt.attr('selected','selected');​​ 
} 
```

就是这样！

或捕捉选择的内容并执行以下操作：

```
function stay_freeze() {
  var catched_value = $('#your_select_id').val();
  $('#your_select_id').val(catched_value);
} 
```

# sql-server-2008 - 从 2 个表中选择并获得 table_2 的 1 个结果

> ID：14344504
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:35.877
> 
> 标签：sql-server-2008

我有 2 个表，表 2 包含许多商店地址。表 2 按 Shop_ID 引用表 1 我想像那样选择 [见图] 请帮帮我！

![在此处输入图像描述](../Images/f88fc0ab07ba34a719d661daba830aed.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:40:12.903

你可以使用`row_number()`：

```
select shop_id, 
  shop_name,
  shop_address
from
(
  select t1.shop_id,
    t1.shop_name,
    t2.shop_address,
    row_number() over(partition by t1.shop_id
                      order by t1.shop_name, t2.shop_address) rn
  from table_1 t1
  inner join table_2 t2
    on t1.shop_id = t2.shop_id
) src
where rn = 1 
```

查看[关于 SQL Fiddle 的演示](http://sqlfiddle.com/#!3/32a6e/2)

您还可以使用聚合函数：

```
select t1.shop_id, 
  t1.shop_name,
  max(t2.shop_address) shop_address
from Table1 t1
inner join table2 t2
  on t1.shop_id = t2.shop_id
group by t1.shop_id, t1.shop_name 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/32a6e/6)

# mysql - Mysql根据列计算排名并排序

> ID：14344505
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:36.560
> 
> 标签：mysql

这个查询没有给出预期的结果，

我想做的是：

我正在尝试根据两个不同的列/字段和值对用户进行排名。并希望在顶部显示排名最高的用户。

我在选择查询中创建虚拟列作为 RANK 并使用两个 CASE ... AS RANK。

这是好习惯吗？还是有更好的出路？

PS：我真的不想保留 RANK 所以不存储它们，因为它将是来自各个字段的动态（这只是两个字段的示例）

```
SELECT *, 

CASE EMPLOYEEOF
WHEN 'ASDF' THEN @RANK := @RANK+1 
END AS RANK,

CASE VENDOROF 
WHEN 'WXYZ' THEN @RANK := @RANK+1
END AS RANK

from USERMASTER, (SELECT @RANK := 0) r ORDER BY RANK DESC; 
```

编辑：不给！在第 1 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:13:58.630

如果您想从表 (USERMASTER) 中进行选择，生成一个计算排名，然后按该给定排名进行排序，以下是您如何有效地做到这一点。

1)**确定你的排名标准**——弄清楚什么对你的排名很重要，无论是花钱、学生成绩等，知道你的指标是什么会有所帮助。

2)**编写你的逻辑**- 当包含多个条件时，CASE 语句非常有用。例如，如果您想为 GPA 高于 3.0 且班级成绩等于“A”的学生提供较高的排名，但您想为较低的 GPA 提供较低的排名，您可能会说：

```
SELECT CASE WHEN student_grade = 'A'
            AND student_gpa > 3.0
            THEN 4
       ELSE 3
END rank
FROM students
ORDER BY rank DESC 
```

这将根据 student_grade 和 student_gpa 逻辑创建一个排名列，然后根据这个计算出的排名按照最高排名的顺序对学生进行排序。

3)**测试您的案例**- 通过查看一些示例数据来验证您的逻辑是否为您提供了您正在寻找的结果。对于我的例子（因为我不知道你的标准：

```
student student_grade   student_gpa
John    A           3.5
Mike    B           2.9 
```

我运行上述结果的结果（按学生姓名分组）：

```
student_name rank
John     4
Mike     3 
```

我的结果与我的预期结果一致（John 的排名更高，为 4，并且由于 order by 也显示在我的列表顶部），我们完成了！

# c# - 递归？或者如何让父母成为父母？

> ID：14344508
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:42.460
> 
> 标签：c#, winforms, recursion

我之前发布过这个问题，但不得不删除这个问题，因为我解释得太可怕了，对那些可能以前读过它的人感到抱歉。让我更清楚。我必须创建一个 winform 应用程序，允许通过指定三件事将文件从一个目录复制到另一个目录：

1.  从哪里复制`(txtPath)`
2.  要复制的文件扩展名（您指定的是被复制的文件扩展名）`(txtExtensions)`
3.  复制到哪里`(txtArchiveTo)`

在视觉上它看起来像这样：

![在此处输入图像描述](../Images/2d525c36aedcd76fa753fae3ed1e39d3.png)

从 txtPath 到 txtArchiveTo 的副本必须与它的复制方式相匹配。也就是说，如果`txtPath`看起来如下所示：

```
c:\temp
  |
   -drivers.exe (file)
   -log.txt (file)
   -\Test1 (directory)
   -\Test2 (directory) 
```

然后，如果我选择`txtArchiveTo`一个文件夹，例如`c:\backup`结果应该是在我的程序运行之后，它应该如下所示：

```
c:\backup
  |
   -\temp
      |
       -drivers.exe (file)
       -log.txt (file)
       -\Test1 (directory)
       -\Test2 (directory) 
```

那就是复制的任何内容都需要遵循相同的结构...但是我很难对此进行编码，因为它看起来好像我一直在引用`root.Parent.Parent`等等。让我发布一些代码：

该`Go`按钮非常基本：

```
private void btnGo_Click(object sender, EventArgs e)
{
    DirectoryInfo di = new DirectoryInfo(txtPath.Text);
    WalkDirectoryTree(di);
} 
```

这只是创建了一个 directoryinfo 对象，所以我有一个`txtPath`目录句柄并调用一个函数`WalkDirectoryTree`。该函数如下所示：

```
 private void WalkDirectoryTree(DirectoryInfo root)
        {
            System.IO.FileInfo[] files = null;
            System.IO.DirectoryInfo[] subDirs = null;

            string[] extArray = txtExtensions.Text.Split(' '); //to hold the txtExtensions as an array string { "txt" "tar" "zip" etc.. }
            string ext; //to hold the extension

            // First, process all the files directly under this folder
            try
            {
                files = root.GetFiles("*.*");
            }
            catch (UnauthorizedAccessException e)
            {
                throw; //todo: log this later on...
            }
            catch (System.IO.DirectoryNotFoundException e)
            {
                Console.WriteLine(e.Message);
            }

            if (files != null)
            {
                foreach (System.IO.FileInfo fi in files)
                {
                    string extension = fi.Extension.ToString();
                    if (extension.IndexOf(".") > -1)
                        ext = extension.Substring(1, extension.Length-1);
                    else
                        ext = extension;

                    if (extArray.Any(s => ext.Contains(s)))
                    {    
                        //copy the file
                        if (Directory.Exists(txtArchiveTo.Text + "\\" + fi.Directory.Name))
                            {
                                //directory exists copy the files
                            }
                            else
                            {
                                Directory.CreateDirectory(txtArchiveTo.Text + "\\" + fi.Directory.Name);
                            }

                            File.Copy(fi.FullName, txtArchiveTo.Text + "\\" + fi.Directory.Name + "\\" + fi.Name);                    

                        //create a shortcut pointing back to the file...
                        using (ShellLink shortcut = new ShellLink())
                        {
                            shortcut.Target = fi.FullName;
                            //shortcut.Description = "MY SHORTCUT";
                            shortcut.DisplayMode = ShellLink.LinkDisplayMode.edmNormal;
                            shortcut.ShortCutFile = fi.DirectoryName + "\\" + fi.Name + ".lnk";
                            shortcut.Save();
                        }
                    }

                }

                // Now find all the subdirectories under this directory.
                subDirs = root.GetDirectories();

                foreach (System.IO.DirectoryInfo dirInfo in subDirs)
                {
                    // Resursive call for each subdirectory.
                    WalkDirectoryTree(dirInfo);
                }
            }            
        } 
```

请不要太注意我创建快捷方式的代码等。那部分不是问题。我遇到的困难是当我遇到这些代码行时：

```
 if (extArray.Any(s => ext.Contains(s)))
                        {    
                            //copy the file
                            if (Directory.Exists(txtArchiveTo.Text + "\\" + fi.Directory.Name))
                                {
                                    //directory exists copy the files
                                }
                                else
                                {
                                    Directory.CreateDirectory(txtArchiveTo.Text + "\\" + fi.Directory.Name);
                                } 
```

只需检查文件的`if`扩展名是否与用户在其中键入的扩展名匹配，以`txtExtensions`确保我们仅在找到的文件夹中复制具有这些扩展名的文件。我的问题是在那之后，如果......我不能只说：

`Directory.CreateDirectory(txtArchiveTo.Text + "\\" + fi.Directory.Name);`

原因是存档文件夹必须与正在复制的文件夹路径匹配。因此，例如，如果有人选择 c:\temp 来搜索和查找要复制的 txt 文件，他们选择了一个文件夹 c:\backup 来复制到并且 c:\temp 有 3 个子文件夹（一、二和三），其中还包含文本文件。结果是，在我的程序运行（“Go”完成）之后，存档文件夹 c:\backup 将包含文件夹（一、二和三），其中包含 txt 文件，此外, c:\backup\One\mytest.txt 等。

我想将它合并到我当前的代码中，并且觉得我真的很接近，但我认为我需要想出一些递归来获得正确的目录结构。请不要向我发布有关如何使用 Directory.CreateDirectory 或 FileInfo 类的 MSDN 链接，我已阅读并理解它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:51:29.273

将目标文件夹作为参数传递给您的步行功能：

```
 private void WalkDirectoryTree(DirectoryInfo root, string DestinationFolder) 
```

然后当你复制文件时，你可以只使用 fileInfo 的 CopyTo 方法：

```
 fi.CopyTo(DestinationFolder) 
```

递归调用下一个方法时，您只需添加到目标路径：

```
 foreach (System.IO.DirectoryInfo dirInfo in subDirs)
    {
        // Resursive call for each subdirectory.
        WalkDirectoryTree(dirInfo, System.IO.Path.Combine(DestinationFolder, dirInfo.Name));
    } 
```

进行初始调用时，您需要计算输出目录：

```
string path = txtPath.Text;
string outputDir = txtArchiveTo.Text
string finalDir = System.IO.Path.Combine(outputDir, path.Remove(0, System.IO.Path.GetPathRoot(path).Length));

DirectoryInfo di = new DirectoryInfo(txtPath.Text);
WalkDirectoryTree(di, finalDir); 
```

# data-structures - 清单实施

> ID：14344510
> 
> 赞同：0
> 
> 时间：2013-01-15T18:35:52.643
> 
> 标签：data-structures, complexity-theory, time-complexity

假设有一个**数字列表 -**存储在数组、队列、链表或任何支持列表数据结构的东西中（即**数字序列很重要**）。现在，假设我们想在将一个数字添加到现有列表后添加一个新对象（list.add()）。但是， list.add() 接受原始列表并返回一个新列表，其中包含原始列表中的数字和新数字。函数 add() 不会以任何方式更改原始列表对象。

因此，要实现这种**方式，**我们在函数中复制原始列表，将新数字添加到其中，然后返回它。这需要 O(n) 时间。

那么有没有其他方法可以在比 O(n) 更短的时间内完成这项工作。

**编辑 1：该元素将在最后添加。add() 返回的对象应该包含原始列表中的所有数字和新的数字。原始列表保持不变。**

**编辑 2：我认为，如果我们每次向列表中添加数字时不复制整个列表，这可能是可能的。在这方面有没有可能？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:39:18.820

不确定您需要支持哪些其他类型的功能，但如果`add`是您关心的唯一方法，您可以创建一个包装类，该类基本上维护一个新列表，该列表表示您要添加到原始列表中的部分。然后，`lookup`进入这个包装类会考虑原始列表和新列表的连接。

下面是一些示例伪 C# 代码：

```
public class ListWrapper
{
    private ArrayList<T> Original;
    private ArrayList<T> ConcatenatedPortion;

    public ImmutableList(ArrayList<T> original)
    {
        Original = original;
        ConcatenatedPortion = new ArrayList<T>();
    }

    public bool Add(<T> element)
    {
        return ConcatenpatedPortion.Add(element);
    }

    public <T> Get(int index)
    {
        if (index < 0) throw new IndexOutOfBoundsException();

        if (index < Original.Length)
            return Original.Get(index);

        int newIndex = index - Original.Length;

        if (newIndex < ConcatenatedPortion.Length)
            return ConcatenatedPortion.Get(newIndex);

        throw new IndexOutOfBoundsException();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:40:19.263

为什么要复制？

您可以在 O(1) 中添加到列表或数组的末尾

基本上只需添加后面的数字并使用相同的参数并将大小增加 1，然后创建一个列表对象，这就是 O(1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:38:15.187

附加到链表的头部将是 O(1)。

或者，支持随机插入是最近大量研究的主题。Clojure 和 Scala 使用类似于[Hash 数组映射的 trie](http://en.wikipedia.org/wiki/Hash_array_mapped_trie)的东西，除了一个不可变的变体，它允许通过仅复制受 O(logn) 中更新影响的分支来更快地更新。当分支因子很高（即 32）时，这也允许有效地进行持续查找。

# javascript - x 秒后执行 Javascript onclick

> ID：14344518
> 
> 赞同：0
> 
> 时间：2013-01-15T18:36:33.237
> 
> 标签：javascript, jquery, onclick

> **可能重复：**
> [有没有办法在javascript中引入延迟？](https://stackoverflow.com/questions/24849/is-there-some-way-to-introduce-a-delay-in-javascript)

在我的网站上，我使用模式弹出窗口让访问者在进入网站之前输入一些信息。我使用了一个在[这里](http://codeissue.com/articles/a04daf3210c8b0a/cross-browser-modal-popup-using-javascript-jquery)找到的脚本，我非常感谢它，因为它似乎适用于每个浏览器（也包括那些没有位置：固定支持的浏览器）。

因此，当您访问我的网站时，您会单击此链接，因为

```
onclick="ShowModalPopup('dvPopup'); return false;" 
```

窗口弹出 - 完美运行。

但是，我希望在网站加载后 3 秒自动弹出窗口。我想将此脚本用于弹出窗口，因此我正在寻找一种在 3 秒后执行 onclick 的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:41:40.637

```
$(document).ready(function() {
    setTimeout(function() {
        $('#myLink').click();
    }, 3000);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:46:24.917

```
window.onload = function() {
                  setTimeout(foo, 3000); 

                };

function foo()
{
 ShowModalPopup('dvPopup');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:42:12.753

你可以使用这个：

```
<script>
    $(document).ready(function () { 
        setTimeout(function () {
            ShowModalPopup('dvPopup');
        },3000);
    }); 
</script> 
```

该脚本将在页面呈现后 3 秒计数，并将运行 ShowModalPopup('dvPopup')

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T18:42:28.157

如果您使用的是 jQUery，您可以简单地触发对文档加载的调用，如下所示：

```
$(function () {
    setTimeout(function () {
        ShowModalPopup('dvPopup');
    }, 3000);
}); 
```

# java - 重新启动 Java 小程序

> ID：14344525
> 
> 赞同：0
> 
> 时间：2013-01-15T18:36:45.233
> 
> 标签：java, applet, japplet

我已经建立了一个计算事物的小程序，把它想象成一个计算器。现在就像计算器一样，我的小程序有一个清除按钮。清除按钮应该将所有变量设置为其默认值。现在的问题是小程序不像计算器那么简单，设置这么多变量变得乏味和不可能。我尝试了很多。此外，我已经实例化了其他类，我必须初始化它。事情变得复杂了。当我不是制作小程序而是制作 JFrame 时，我曾经做过的一件简单的事情是：

```
myFrameInstance.setVisible(false);      //hide the old frame and build a new one.
main(newInstance); 
```

但是小程序不能像那样实例化。它甚至没有 main 方法。浏览器会处理这个问题。所以我的问题是，是否有任何方法可以重新启动我的应用程序，比如隐藏旧的应用程序并重新开始？

# java - junit不尊重maven类路径

> ID：14344526
> 
> 赞同：1
> 
> 时间：2013-01-15T18:36:52.457
> 
> 标签：java, eclipse, maven, junit

环境：
Eclipse Juno
Junit 4.11
maven 3.0.4

问题：

我相信在eclipse的junit runner中运行单元测试时我遇到了类加载问题。我的具体问题源于此代码：

```
this.getClass().forName(type); 
```

上面的代码最终会以一个存在于 maven 依赖项中的类的名称被调用（该依赖项只是一个 java bean 的集合）。当我运行 mvn 测试时，此代码运行成功，但是如果我使用 eclipse 运行 junit 测试，我会收到一个找不到类的异常。

在运行配置的类路径选项卡中找到的类路径条目引用了 Maven 依赖项。所以我不确定为什么没有引入依赖项。

为什么会发生这种情况？我在 eclipse 中安装了 maven 插件，所以它应该使用相同的类路径。然而，似乎并非一切都是相同的。我尝试过清理、更新 Maven 项目配置并重新启动 Eclipse。

.classpath 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" output="target/classes" path="src/main/java">
        <attributes>
            <attribute name="optional" value="true"/>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry excluding="**" kind="src" output="target/classes" path="src/main/resources">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="src" output="target/test-classes" path="src/test/java">
        <attributes>
            <attribute name="optional" value="true"/>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry excluding="**" kind="src" output="target/test-classes" path="src/test/resources">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/J2SE-1.5">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.m2e.MAVEN2_CLASSPATH_CONTAINER">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="output" path="target/classes"/>
</classpath> 
```

.project 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>brokenClasspathproject</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.wst.common.project.facet.core.builder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jdt.core.javanature</nature>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
        <nature>org.eclipse.wst.common.project.facet.core.nature</nature>
    </natures>
</projectDescription> 
```

junit 配置

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<launchConfiguration type="org.eclipse.jdt.junit.launchconfig">
<stringAttribute key="bad_container_name" value="/brokenClasspathproject/junit"/>
<listAttribute key="org.eclipse.debug.core.MAPPED_RESOURCE_PATHS">
<listEntry value="/brokenClasspathproject"/>
</listAttribute>
<listAttribute key="org.eclipse.debug.core.MAPPED_RESOURCE_TYPES">
<listEntry value="4"/>
</listAttribute>
<stringAttribute key="org.eclipse.jdt.junit.CONTAINER" value="=brokenClasspathproject"/>
<booleanAttribute key="org.eclipse.jdt.junit.KEEPRUNNING_ATTR" value="false"/>
<stringAttribute key="org.eclipse.jdt.junit.TESTNAME" value=""/>
<stringAttribute key="org.eclipse.jdt.junit.TEST_KIND" value="org.eclipse.jdt.junit.loader.junit4"/>
<stringAttribute key="org.eclipse.jdt.launching.CLASSPATH_PROVIDER" value="org.eclipse.m2e.launchconfig.classpathProvider"/>
<stringAttribute key="org.eclipse.jdt.launching.MAIN_TYPE" value=""/>
<stringAttribute key="org.eclipse.jdt.launching.PROJECT_ATTR" value="brokenClasspathproject"/>
<stringAttribute key="org.eclipse.jdt.launching.SOURCE_PATH_PROVIDER" value="org.eclipse.m2e.launchconfig.sourcepathProvider"/>
</launchConfiguration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:32:08.157

我想我明白为什么会这样了！

我正在执行的代码很简单：

```
this.getClass().forName(name); 
```

哪个在 Maven 中工作，但不是在 Junit 中独立工作。但是，当我将我的财产更改为：

```
this.getClass().forName(com.packagename.name); 
```

代码开始工作。我假设带有surefire的maven正在做一些后端巫术来识别名称和com.packagename.name。如果我真的停下来阅读 javadocs，我会看到 class.forName 需要包名。

所以我想道德是实际阅读javadocs。我向所有对此发表评论的人道歉（并真诚地感谢！）！

# ios - iOS 将 CIImage 保存到相机胶卷

> ID：14344531
> 
> 赞同：1
> 
> 时间：2013-01-15T18:37:04.283
> 
> 标签：ios, image-processing, core-image

我正在对来自设备相机的图像运行几个 CoreImage 过滤器，并且在将结果保存到相机胶卷时遇到了意外的麻烦。我的图像处理的结果是 a `CIImage`，我可以保存到 ALAssetsLibrary 的数据类型是`CGImageRef`or `NSData`（分别通过`writeImageToSavedPhotosAlbum:metadata:completionBlock:`和`writeImageDataToSavedPhotosAlbum:metadata:completionBlock:`）。

似乎是一项微不足道的任务，但我找不到将我的数据类型转换`CIImage`为可写入照片库（使用 JPEG 压缩）的可用数据类型的工作方法。

编辑：我也想保存图像元数据，这样就排除了一些简单的 UIImage 保存技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:33:24.513

试试这个 ：

```
-(void)storeImage:(CIImage*)_image
  CGImageRef cgImg = [context createCGImage:_image fromRect:[_image extent]];
  ALAssetsLibrary* library = [[ALAssetsLibrary alloc] init];
  [library writeImageToSavedPhotosAlbum:cgImg 
                               metadata:[_image properties] 
                        completionBlock:^(NSURL *assetURL, NSError *error) {
                          CGImageRelease(cgImg);
                        }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:41:19.357

很简单，创建一个 UIImage 对象并使用`initWithCIImage:`. 然后，您可以将新的 UIImage 传递给`UIImageWriteToSavedPhotosAlbum()`.

```
UIImage *image = [[UIImage alloc] initWithCIImage:myCIImage];
UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil); 
```

# ios - 带有 Tableview 和静态单元格的空弹出框

> ID：14344534
> 
> 赞同：2
> 
> 时间：2013-01-15T18:37:15.430
> 
> 标签：ios, ipad, uipopovercontroller, popover

我有一个表格视图设置，其中包含一些在弹出窗口中显示的静态单元格。问题是弹出框总是空的，我似乎不知道为什么。我已经删除了 tableviewcontroller 中的所有数据方法，所以这不是问题。任何人都可以在下面的代码中看到任何问题或指出我可能缺少的东西吗？谢谢！

表视图控制器代码：

```
@implementation ICAMDisciplineTableViewController
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.clearsSelectionOnViewWillAppear = NO;
   self.contentSizeForViewInPopover = CGSizeMake(400.0, 400.0);
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self.delegate disciplineTableViewController:self
                           didSelectEnumItem:indexPath.row + 1];
}

@end 
```

显示弹出框的代码：

```
-(void)fireDisciplinePopOver
{
    ICAMDisciplineTableViewController *popoverTable = [[ICAMDisciplineTableViewController alloc] init];
    self.popOverController = [[UIPopoverController alloc]initWithContentViewController:popoverTable];
    self.popOverController.delegate = self;
    popoverTable.delegate = self;
    [self.popOverController presentPopoverFromRect:self.disciplineTextField.frame inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:34:30.790

在您的 fireDisciplinePopover 中执行此操作以`UIViewController`从您的 Storyboard 中获取您的信息：

```
 UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                                 bundle: nil];

  ICAMDisciplineTableViewController *popoverContent = (ICAMDisciplineTableViewController*)[mainStoryboard
                                                                             instantiateViewControllerWithIdentifier: @"ICAMDisciplineTableViewController"]; 
```

确保`UIViewController`在您的 Storyboard 中为其设置 Storyboard ID——我只是将其设置为上面的视图控制器名称。

# java - 等效于Java中的C++移位运算符<<？

> ID：14344546
> 
> 赞同：11
> 
> 时间：2013-01-15T18:38:07.817
> 
> 标签：java, c++, porting

C++ 移位运算符`<<`不循环。例如，如果您这样做：

```
// C++
int a = 1;
cout << (a<<38); 
```

你得到 0。但是，在 Java 中，你实际上循环并得到一个有效值 64。

我需要将一些 C++ 代码翻译成 Java，那么我应该使用什么作为等价物`<<`呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T18:44:34.780

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.19)指出：

> 如果左侧操作数的提升类型是 int，则只有右侧操作数的五个最低位用作移位距离。就好像右手操作数受到按位逻辑与运算符 & (§15.22.1) 的影响，掩码值为 0x1f (0b11111)。因此，实际使用的移位距离始终在 0 到 31 的范围内，包括 0 到 31。
> 
> 如果左手操作数的提升类型是长的，那么只有右手操作数的六个最低位被用作移位距离。就好像右手操作数经过位逻辑与运算符 & (§15.22.1) 与掩码值 0x3f (0b111111)。因此，实际使用的移位距离总是在 0 到 63 的范围内，包括 0 到 63。

所以，在你的例子中，`(int)(((long)a)<<38)`应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:51:42.620

> 如果左侧操作数的提升类型是 int，则只有右侧操作数的五个最低位用作移位距离。就好像右手操作数受到按位逻辑与运算符 & (§15.22.1) 的影响，掩码值为 0x1f (0b11111)。因此，实际使用的移位距离始终在 0 到 31 的范围内，包括 0 到 31。

请参考 Java 语言规范：[http ://docs.oracle.com/javase/specs/jls/se7/jls7-diffs.pdf](http://docs.oracle.com/javase/specs/jls/se7/jls7-diffs.pdf)

# php - 如何获取 PHP 生成图像的内容大小？

> ID：14344553
> 
> 赞同：1
> 
> 时间：2013-01-15T18:38:17.307
> 
> 标签：php, php-gd

嗨，我有一个网站，我在其中使用 php GD 库制作图像，我想知道如何获得这些随机大小图像的大小（以 KB 或 MB 为单位）。请任何人知道它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:39:06.837

您可以通过执行以下操作获取图像的文件大小：

```
$image_size_in_bytes = filesize($path_to_image); 
```

要使用 URL 获取图像的文件大小，请使用以下代码：（请注意，您必须安装 cURL 扩展）

```
<?php

    // URL to file (link)
    $file = 'http://example.com/file.zip';

    $ch = curl_init($file);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);

    $data = curl_exec($ch);
    curl_close($ch);

    if (preg_match('/Content-Length: (\d+)/', $data, $matches)) {
       // Contains file size in bytes
        $contentLength = (int)$matches[1];
    }
?> 
```

[在这里](http://php.net/filesize)阅读更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:01:20.597

PHP doesn't have a way to get information about the size of a variable, exactly. One way to get around this is by [checking memory usage](https://stackoverflow.com/questions/2192657/how-to-determine-the-memory-footprint-size-of-a-variable) before and after you generate the image for use as an approximation.

Another way would be to build the image, then set the JPEG/GIF/PNG/etc. data to a variable. Use [strlen](http://www.php.net/manual/en/function.strlen.php#72274) to get the size of that string in bytes, which will be your image size. I'm not sure how to get the string of data from GD without setting up an output buffer, echo-ing the GD variable, then closing and capturing the buffer; the only other output I know of would be to write it to disk. Which brings us to...

Save the image file to a temporary directory, then get the file size with the [filesize](http://php.net/manual/en/function.filesize.php) function. This will be the most accurate, because when you write the image you will also be setting the type of image file to write, which has an effect on the size. It's also going to involve a lot more disk activity on your server.

# java - 从 Spring jdbcTemplate 中的 RowMapper 获取预定义大小的列表

> ID：14344555
> 
> 赞同：1
> 
> 时间：2013-01-15T18:38:20.837
> 
> 标签：java, spring, jdbctemplate

我有以下代码，其中我根据 batchSize 创建了对象列表，
任何机构都可以建议如何实现这一点，我正在考虑检查 rowmapper 类中的 rownum 是否等于批量大小，然后问题是
如何从 rowmapper 实现返回和创建列表

```
public class TestAppDao {
public JdbcTemplate jdbcTemplate;

public JdbcTemplate getJdbcTemplate() {
    return jdbcTemplate ;
}

public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
    this.jdbcTemplate = jdbcTemplate;
}

public List<Circle> getAllCircle(int batchSize){
    String sql = "select * from circle";
    return jdbcTemplate.query(sql, new Object[]{}, new CircleMapper());
}

private static final class CircleMapper implements RowMapper<Circle>{

    @Override
    public Circle mapRow(ResultSet resultSet, int rowNum) throws SQLException {

        Circle circle = new Circle();
        circle.setId(resultSet.getInt(1));
        circle.setName(resultSet.getString(2));
        return circle;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:49:58.080

我认为您基本上有两种选择：

*   要么使用`LIMIT`（但是`SQL`您的`DB`服务器需要为其提供支持）（此处的示例：[Spring JdbcTemplate：如何限制选定的行？](https://stackoverflow.com/questions/9941488/spring-jdbctemplate-how-to-limit-selected-rows)）
*   或使用`jdbc` `setMaxRows`- [http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Statement.html#setMaxRows%28int%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Statement.html#setMaxRows%28int%29)

然而，第二个选项并不能保证从`DB`服务器只返回这么多的结果，因为额外的结果可能会被`JDBC`自己剪切 => 它可能会降低性能（对于 oracle 案例，请参阅：[如何限制从 Oracle 返回的行数在 JDBC 数据源级别？](https://stackoverflow.com/questions/320299/how-to-limit-number-of-rows-returned-from-oracle-at-the-jdbc-data-source-level)）

我认为在你的代码中剪切它是最糟糕的选择，因为你需要自己迭代它而且你没有性能提升（总是从 DB 中选择所有）。

# c# - 如何在 C# 中创建“变量”方法名称？

> ID：14344559
> 
> 赞同：1
> 
> 时间：2013-01-15T18:38:30.300
> 
> 标签：c#, wpf, visual-studio-2010, methods

我是 C# 编程新手，对 C/C++ 有一点背景。我正在尝试编写一个问题，几乎就像一个均衡器，只是在玩代码。想象一下 5 个彼此相邻的垂直滑块，当您上下移动中间滑块时，其他滑块会根据哈希函数对特定值做出反应，我稍后会弄清楚，目前我很简单方程。

但是，当我添加更多滑块时，我不想为每个滑块添加一个函数，所以有没有办法“检测”哪个滑块正在移动，并通过算法发送它来移动相邻的滑块？基本上，我想要一个功能来将相邻的滑块移动到我选择移动的任何滑块上。从逻辑上讲，这是有道理的，但是我不知道如何在代码中做到这一点。

我为特定滑块编写的函数如下。

```
private void slider3_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
    {
        double adjacentSliders = ((slider3.Value) / 4) * 3;
        double adjacentSliders2 = ((slider3.Value) / 2);
        slider2.Value = slider4.Value = adjacentSliders;
        slider1.Value = slider5.Value = adjacentSliders2;
    } 
```

可能我解释的不是很全，有问题可以追问！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:40:35.563

```
private void anySlider_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
{
   var thisSlider = sender as Slider;
   ...
} 
```

当您需要相邻的滑块时，在 FormLoad 中构建滑块列表。然后，您可以找到索引`thisSlider`并从那里开始工作。

编辑：我不确定 WPF 是否在更改代码中的值时触发事件。如果是这样，您可能需要这样做来防止它进入循环：

```
private static bool changingSlider = false;

private void anySlider_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
{
    if (! changingSlider)
    {
        changingSlider = true;      
        var thisSlider = sender as Slider;
        ...
        changingSlider = false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:54:34.427

我有一段时间没有使用 C# 和 Visual Studio，所以我不记得在窗口设计器中是否有直接使用数组的方法，有人应该在评论中清除它；）。

但是您可能想要的是，而不是声明slider1，slider2，slider3，...您应该使用一个数组，以便您可以访问slider[0]，slider[1]，...

为此，您首先必须更改表单的设计以使用数组，然后在处理程序中访问该数组。

没有数组：

```
 private System.Windows.Forms.TrackBar trackBar1;
        private System.Windows.Forms.TrackBar trackBar2;
        private System.Windows.Forms.TrackBar trackBar3;

        [...]

        this.trackBar1 = new System.Windows.Forms.TrackBar();
        this.trackBar2 = new System.Windows.Forms.TrackBar();
        this.trackBar3 = new System.Windows.Forms.TrackBar();
        ((System.ComponentModel.ISupportInitialize)(this.trackBar1)).BeginInit();
        ((System.ComponentModel.ISupportInitialize)(this.trackBar2)).BeginInit();
        ((System.ComponentModel.ISupportInitialize)(this.trackBar3)).BeginInit();
        this.SuspendLayout();
        // 
        // trackBar1
        // 
        this.trackBar1.Location = new System.Drawing.Point(154, 80);
        this.trackBar1.Name = "trackBar1";
        this.trackBar1.Size = new System.Drawing.Size(104, 45);
        this.trackBar1.TabIndex = 0;
        // 
        // trackBar2
        // 
        this.trackBar2.Location = new System.Drawing.Point(154, 132);
        this.trackBar2.Name = "trackBar2";
        this.trackBar2.Size = new System.Drawing.Size(104, 45);
        this.trackBar2.TabIndex = 1;
        // 
        // trackBar3
        // 
        this.trackBar3.Location = new System.Drawing.Point(154, 184);
        this.trackBar3.Name = "trackBar3";
        this.trackBar3.Size = new System.Drawing.Size(104, 45);
        this.trackBar3.TabIndex = 2; 
```

带数组：

```
 private System.Windows.Forms.TrackBar[] trackBar = new System.Windows.Forms.TrackBar[3];

        [...]
        this.SuspendLayout();

        for(int n = 0; n < 3; n++) {
            this.trackBar[n] = new System.Windows.Forms.TrackBar();
            ((System.ComponentModel.ISupportInitialize)(this.trackBar[n])).BeginInit();

            this.trackBar[n].Location = new System.Drawing.Point(154, 80 + n*52);
            this.trackBar[n].Name = "trackBar[" + n + "]";
            this.trackBar[n].Size = new System.Drawing.Size(104, 45);
            this.trackBar[n].TabIndex = 0;
        } 
```

然后您可以通过 trackBar[x] 访问所有轨迹栏。您可以将声明和 for 循环中的 3 更改为您想要的常量或变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T03:14:37.343

您也可以仅在 xaml 中执行此操作。你只需要一个`FormulaCalculationConverter`. 我试过了，效果很好。

```
<Window x:Class="WpfApplication2.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:WpfApplication2="clr-namespace:WpfApplication2"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <sys:Double x:Key="MyValueFour">4.0</sys:Double>
    <sys:Double x:Key="MyValueTwo">2.0</sys:Double>
    <WpfApplication2:FormulaCalculationConverter x:Key="FormulaCalculationConverter"/>
</Window.Resources>
<StackPanel>
    <Slider x:Name="BaseSlider" />
    <Slider>
        <Slider.Value>
            <MultiBinding Converter="{StaticResource FormulaCalculationConverter}">
                <Binding Path="Value" ElementName="BaseSlider" Mode="OneWay"  />
                <Binding Path="." Source="{StaticResource MyValueFour}" />
            </MultiBinding>
        </Slider.Value>
    </Slider>
    <Slider >
        <Slider.Value>
            <MultiBinding Converter="{StaticResource FormulaCalculationConverter}">
                <Binding Path="Value" ElementName="BaseSlider" Mode="OneWay"  />
                <Binding Path="." Source="{StaticResource MyValueTwo}" />
            </MultiBinding>
        </Slider.Value>
    </Slider>
    <Slider Value="{Binding Path=Value, ElementName=BaseSlider}"/>
</StackPanel>
</Window> 
```

我刚刚创建了一个转换器

```
public class FormulaCalculationConverter : IMultiValueConverter
{
   // this is incomplete formula converter...
   public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
   {
       // strictly assume for 1 + 1
       double retVal = 0;
       if (values[0] == DependencyProperty.UnsetValue || values[1] == DependencyProperty.UnsetValue
           || values[0] == null || values[1] == null)
       {
           return Binding.DoNothing;
       }
       // apply logic to split formula here
       retVal = System.Convert.ToDouble(values[0]) + System.Convert.ToDouble(values[1]);
       return retVal;
   }

   public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
   {
       throw new NotImplementedException();
   }
} 
```

但是您需要为此使用转换器。让我知道你的想法。

# twitter-bootstrap - 编辑引导轮播

> ID：14344560
> 
> 赞同：0
> 
> 时间：2013-01-15T18:38:39.757
> 
> 标签：twitter-bootstrap, carousel

我目前正在学习 Web 开发的技巧并开始使用 Bootstrap，我目前正在研究轮播。我不喜欢这个设计，我找到[了一个替代的旋转木马](http://www.pixedelic.com/plugins/camera/)

我尝试了多种方法，并且阅读了网站上的指南，但由于某种原因，我无法使其在我的网站上运行。有谁知道我将如何添加插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T20:20:53.030

这里有一些让你开始的东西：http:
[//jsfiddle.net/panchroma/hV3bT/](http://jsfiddle.net/panchroma/hV3bT/)

[我从http://www.pixedelic.com/plugins/camera/](http://www.pixedelic.com/plugins/camera/)下载了 zip 包，然后查看了 basic.htm 页面。

如果您查看引导示例的 HTML，它几乎与下载的示例页面完全相同，只是没有将内容放在

```
<div class="fluid_container"> ... </div> 
```

我把它放在等效的引导网格中

```
<div class="container">
<div class="row-fluid">
<div class="span12">

<!-- content here -->

</div>
</div>
</div> 
```

然后，我以与 basic.html 示例中相同的顺序加载 CSS 和 javascript 文件。

我认为唯一的另一件事是您会注意到示例页面的头部也有一些样式。可能您唯一需要的就是#back_to_camera div。

如果您需要有关此示例中的 CSS 和 javascript 的更多信息，请转到 jsFiddle 并检查结果窗格的源代码。您将看到正在使用哪些 CSS 和 javascript 文件、它们的加载顺序以及头部中的其他 CSS 和 javascript。

我的示例缺少一些图标...箭头等。一旦你在你的网站上安装了图片、javascript 和 CSS，我认为它们也应该很好。

希望这可以帮助！

编辑：我添加了这个额外的 CSS 来强制第二个轮播示例底部的缩略图水平显示

```
.camera_thumbs_cont ul{
width:100% !important;
}

.camera_thumbs_cont li
{
display: inline !important;
padding-right: 20px;
} 
```

# c# - C# 中的数值溢出换行

> ID：14344561
> 
> 赞同：0
> 
> 时间：2013-01-15T18:38:43.017
> 
> 标签：c#

我需要在 C# 中进行某种钳位。当一个数字达到最大值时，它会返回零，而当它达到最小值时，它会向后退到最大值。我需要这样做，因为我想平铺纹理。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T18:43:30.227

您需要的是 Modulus 运算符（稍作调整以按照您想要的方式处理负数）。

```
public static int Modulas(int input, int divisor)
{
    return (input % divisor + divisor) % divisor;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T18:45:41.227

模是你的朋友：

```
myVal = (myVal++) % (maxValue+1); 
```

例如，如果您的最大值为 4，则：

```
0 % 5 = 0
1 % 5 = 1
2 % 5 = 2
3 % 5 = 3
4 % 5 = 4
5 % 5 = 0
6 % 5 = 1
.... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T18:42:32.460

你到底哪里有问题？

这似乎很简单：

```
int number = 4; int maxNum = 20; int minNum = 5;
number = number > maxNum ? 0 : number < minNum ? maxNum : number;
// 20 
```

[**演示**](http://ideone.com/T3qLWj)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T19:58:54.733

**好的，找到解决方案**

```
private float Wrap(float val, float min, float max)
    {
        val = val - (float)Math.Round((val - min) / (max - min)) * (max - min);
        if (val < 0)
            val = val + max - min;
        return val;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T18:44:01.833

```
private const Int32 c_ClampMaximum = X;

private Int32 m_Clamp;

public Int32 Clamp
{
    get { return m_Clamp; }
    set
    {
        if (value >= c_ClampMaximum)
        {
            m_Clamp = 0;

            while (value > c_ClampMaximum)
               value -= c_ClampMaximum;
        }

        m_Clamp = value;
    }
} 
```

# wpf - 防止 RichTextBox 变高

> ID：14344564
> 
> 赞同：0
> 
> 时间：2013-01-15T18:38:52.137
> 
> 标签：wpf, richtextbox

当文本到达行尾时，如何防止 RichTextBox 的高度增加？

我有一个 RichTextBox 我在其中设置`AcceptsReturn=False`. 什么时候`AcceptsReturn=False`，我定了`Height=23.2766666666667`。当我没有在 XAML 或代码隐藏中设置宽度时，文本会在每个字符之后换行。我想要一个 RichTextBox，它可以随其包含的元素在宽度上增加或缩小，但当文本达到这个宽度时高度不会增加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:54:08.880

我在这里找到了答案： [https ://stackoverflow.com/a/607252/168117](https://stackoverflow.com/a/607252/168117)

> 尝试将 FlowDocument 的宽度（一种方式）绑定到容器 RichTextBox 的宽度。
> 
> 为我工作...

# sql - SQL中日期时间字段的校验和

> ID：14344565
> 
> 赞同：0
> 
> 时间：2013-01-15T18:38:53.307
> 
> 标签：sql, checksum

任务：我们正在验证 2 个不同表（具有相同结构）中的数据。为此，我们尝试在记录上使用校验和功能。

问题：表中的记录相同。但是当我们使用校验和（*）时，它会给出不同的校验和。

```
SELECT statusName,CheckSum(*) from OrderStatus 
```

如果我计算校验和，不包括 DateTime 列，它会在两个表中给出相同的值。

```
SELECT statusName,CheckSum(StatusName,CreatedByUser,ModifiedByUser) from OrderStatus 
```

表中的列：StatusName、CreatedByUser、ModifiedByUser、CreatedDateTime、LastModifiedTime

如何通过包含 datetime 列来解决此问题。

任何帮助表示赞赏！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:44:55.437

对于校验和，列的顺序会有所不同。

将第一个查询中的 * 替换为完全相同的列列表。 `CheckSum`应该在日期和日期时间上工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:45:17.147

它似乎对我有用。这是[SQL 小提琴](http://sqlfiddle.com/#!3/39c84/1)。

我怀疑您的 DateTime 列有问题 - 运行它以查看是否有任何不同：

```
SELECT *
FROM OrderStatus OS1
LEFT JOIN OrderStatus OS2 ON OS1.CreatedDateTime = OS2.CreatedDateTime AND OS1.LastModifiedTime=OS2.LastModifiedTime
WHERE OS2.LastModifiedTime IS NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:47:28.590

试试这个：

```
SELECT statusName,
CheckSum(CreatedByUser,ModifiedByUser,CreatedDateTime,LastModifiedTime) 
from OrderStatus 
```

# c - 将缓冲区指针作为值传递给函数时出现段错误，在该函数中重新分配发生在该缓冲区上

> ID：14344566
> 
> 赞同：3
> 
> 时间：2013-01-15T18:38:53.367
> 
> 标签：c, memory, segmentation-fault, malloc

如果我有以下代码，我在主函数中分配我的内存，然后将它传递给一个函数，它会像这样为我填充它：

```
main()
{
    char *bar = (char*) malloc(sizeof(char));

    while(1)
    {
        foo(bar);
        free(bar);
        bar = (char*) malloc(sizeof(char));
    }
}

foo(char *bar)
{
    int c;
    int i = 0;
    while((c = getchar()) != '\n' && c != EOF)
    {
        bar[i++] = c;
        bar = (char*) realloc(bar, sizeof(char) * (i+1));
    }
} 
```

几次输入后我得到一个段错误。但是，如果我这样做：

```
main()
{
    char *bar;

    while(1)
    {
        bar = foo();
        free(bar);
    }
}

char *foo()
{
    char *bar = (char*) malloc(sizeof(char));
    int c;
    int i = 0;
    while((c = getchar()) != '\n' && c != EOF)
    {
        bar[i++] = c;
        bar = (char*) realloc(bar, sizeof(char) * (i+1));
    }

    return bar;
} 
```

，即把内存分配给函数，一切似乎工作正常。这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:44:02.697

这是非常预期的行为。realloc() 可能会也可能不会将传递给它的指针“移动”到新地址。如果发生这种情况，它也是 free() 的原始地址。由于 C 是按值传递而不是按引用传递，因此`bar`main() 函数中的指针仍将引用旧地址，并且您将有效地执行双重释放（以及 realloc() 的指针会迷路）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:41:40.653

C 是一种按值传递的语言。您对`bar`内部的修改`foo()`不会影响该`bar`函数调用的外部。要执行您想要执行的操作，您需要将该参数更改为 be`char **bar`并将其`*bar`用作`foo()`.

一些编辑说明：

1.  您不需要在 C中转换`malloc()`or的返回值。`realloc()`

2.  不要分配给你传入的同一个指针`realloc()`。如果它失败了，你会得到一个内存泄漏。

3.  `sizeof(char)`是`1`，为什么要打扰额外的打字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:42:33.350

在第一种情况下，您可能会释放两次内存。该`realloc`调用可以将另一块内存交还给您，在这种情况下，第一个块（在 main 中分配的那个）被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T18:45:30.103

`realloc`不会总是扩展相同的内存。如果无法扩展，有时它会分配新的内存块。

```
main()
{
    char *bar = (char*) malloc(sizeof(char));

    while(1)
    {
        foo(&bar);
        free(bar);
        bar = (char*) malloc(sizeof(char));
    }
}

foo(char **dbar)
{
    char *bar = *dbar;
    int c;
    int i = 0;
    while((c = getchar()) != '\n' && c != EOF)
    {
        bar[i++] = c;
        bar = (char*) realloc(bar, sizeof(char) * (i+1));
    }
    *dbar = bar;
} 
```

# python - 在 Windows 7 上控制 Python 3.3 stdio 行终止

> ID：14344568
> 
> 赞同：8
> 
> 时间：2013-01-15T18:39:04.497
> 
> 标签：python, python-3.3

以下代码...

```
import sys

if sys.platform == "win32":
    import os, msvcrt
    msvcrt.setmode(sys.stdout.fileno(), os.O_BINARY)

sys.stdout.write("This is a sample line of text\n") 
```

...导致 stdio 输出以`0x0d`.结尾`0x0a`。stdio 设置为二进制模式。为什么`write()`呼叫仍然`\r\n`代替`\n`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:39:14.297

如果你在 Cygwin 下运行它，[`sys.platform`](http://docs.python.org/3/library/sys.html#sys.platform)将会是`'cygwin'`而不是`'win32'`，但你仍然会得到行尾转换。你确定`setmode`真的在运行吗？

# php - 安装后出错

> ID：14344571
> 
> 赞同：1
> 
> 时间：2013-01-15T18:39:18.157
> 
> 标签：php, laravel

创建 laravel 4 的全新安装后，安装所有作曲家依赖项并转到安装所在的 url，我收到此错误：

> ErrorException：警告：file_put_contents（/var/www/mysite/app/config/../storage/meta/services.json）：无法打开流：/var/www/mysite/vendor/laravel/framework/ 中的权限被拒绝src/Illuminate/Filesystem/Filesystem.php 第 77 行

任何想法是为什么或这个错误是什么，以及我该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:35:42.163

通过在存储目录上运行 chmod -R 775 解决。

# android - 在Android中，如何从按返回/主页按钮返回后恢复音乐

> ID：14344574
> 
> 赞同：0
> 
> 时间：2013-01-15T18:39:26.163
> 
> 标签：android, android-mediaplayer

在 Android 中，当我按下返回/主页按钮时，音乐停止（这很好），但是当我重新进入活动时，我想开始/恢复播放音乐。

当程序进入后台时，Android 如何管理音频的播放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:38:45.697

下面给出的代码仅在活动没有被破坏的情况下才有效。如果您想在用户按下后退按钮时生存，您必须将媒体播放器的当前状态写入文件，并在活动再次启动时重新加载。

我不确定这是正确的行为。按下后退按钮后，您的应用程序应该终止，并在下次重置状态下启动。我认为。如果后退按钮在您的应用程序中用于导航，解决方案是在终止应用程序的最后一个后退按钮上发出警告，询问用户真的很想退出。重写 Activity.onBackPressed 以自定义后退按钮的行为。

另请注意，即使在暂停状态下，如果系统正在寻找更多内存、屏幕翻转或其他几个高级系统状态发生变化，您的活动也可能被破坏。为了处理这种情况，您需要实现 savedInstanceState 处理。实现 Activity.onSaveInstanceState，然后在您的 onCreate 实现中查找非空的 savedInstanceState 参数。

在这两种情况下，您都必须实施某种方法来重新创建媒体播放器，再次准备音频，并在恢复的音频中寻找正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:48:49.260

通常，您应该包含更多关于您的问题的详细信息和代码，但我只是碰巧看到了您关于[相关问题](https://stackoverflow.com/q/14343834/1904517)的其他帖子。

您需要以下内容`onResume()`。请注意，如果您在`mp.start()`in 中进行操作，则可以在 after 调用`onCreate()`时删除该 start 。`onResume()``onCreate()`

```
@Override
protected void onResume() {
    if(mp != null && !mp.isPlaying())
        mp.start();
    super.onResume();
} 
```

`start()`如果停止或从不播放， from`MeidaPlayer`将重新开始，如果暂停，则从暂停的位置开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:10:50.000

添加此方法，

```
 @Override
    protected void onResume() {
        super.onResume();
if(mp != null)
   mp.start();
} 
```

# mvvmcross - MvvmCross 检测 RequestClose 或按下后退按钮

> ID：14344576
> 
> 赞同：3
> 
> 时间：2013-01-15T18:39:37.383
> 
> 标签：mvvmcross

我发现这个主题说 MvvmCross 无法检测 RequestClose 或使用按下后退按钮：[WP7 MVVMCross Detect RequestClose or BackKeyPressed inside ViewModels](https://stackoverflow.com/questions/10515990/wp7-mvvmcross-detect-requestclose-or-) backkeypressed-inside-viewmodels

自 2012 年 5 月以来有什么变化吗？为什么这个功能没有内置到 MvvmCross 中有什么原因？我不想重新设计轮子，看起来这可以非常简单地内置到 Android、WP7 和 iOS 中。如果我找不到解决方案，我将最终构建它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T19:55:06.573

之前的建议还是正确的。

> 似乎这可以非常简单地内置到 Android、WP7 和 iOS 中

**我可能错了或遗漏了一些东西**，但是过去我尝试构建它时，简单性似乎很快变得复杂了:(

* * *

虽然在一个特定情况下看起来很简单，但对于一个通用框架，还有许多其他情况需要考虑——例如，当使用枢轴、选项卡、弹出窗口、模式、拆分视图等时——在这些多种情况下，标准方法可能不是完全通用。

尤其是 iOS，有时会使这种检测变得更加困难（尤其是在 UIViewController 可能位于或不在 NavigationController 中的一般情况下）。

更简单的方法是检测视图是否可见的事件并发出信号 - 但即使这似乎并不完全简单 - 在 iOS 中存在不会调用 ViewDidDisappear 的情况 - 此外，这些事件可能只是简单的不是您的应用需要响应的...

虽然您可能觉得您只需要一个轮子，但显而易见的事实是没有一个万能轮子——轮子有许多不同的样式和尺寸。我现在已经看到了很多 MvvmCross 应用程序......而且我还没有弄清楚标准应用程序的外观。一个应用程序中“显然”正确的设计和架构，可能与其他应用程序所采用的方法完全不同。

![我只需要一个轮子](../Images/7201482da56ebcf135610bd9b17019b9.png)

* * *

一般来说，我怀疑单个应用程序需要这种功能的地方，那么这将是在定义非常明确的场景中——例如，在已知的表示框架内具有已知的视图类型。在这些情况下，我怀疑为那个应用程序场景实施一些东西对于当时的应用程序开发人员来说是非常简单的。我还怀疑其中一些场景可以在某些应用程序之间共享——但我不确定一种代码模式是否适合所有人——甚至很多。

我非常非常高兴看到用户在写博客、github-post 或论坛-谈论他们在这方面的经验。[像http://www.gregshackles.com/2012/11/returning-results-from-view-models-in-mvvmcross/](http://www.gregshackles.com/2012/11/returning-results-from-view-models-in-mvvmcross/)这样的博客文章展示了如何在 Mvvm 之上应用和重用模式。

甚至可能从这些博客文章中，我们找到了一种在核心 mvvmcross（和其他）库中获得更多功能的方法——但对我来说，保持核心库尽可能轻巧、灵活和可扩展也很重要。

作为像你一样的人，谈论他们的跨平台 mvvm 体验，我尽我所能保持链接页面是最新的 - [http://slodge.blogspot.co.uk/p/mvvmcross-quicklist.html](http://slodge.blogspot.co.uk/p/mvvmcross-quicklist.html) - 希望将帮助人们分享想法、概念和代码。

# php - 从 php 对象中检索数据

> ID：14344582
> 
> 赞同：0
> 
> 时间：2013-01-15T18:39:53.997
> 
> 标签：php

我正在尝试访问 php 对象中的数据。我对确切的 stynax 是什么感到困惑。这是对象的输出：

```
stdClass Object ( [vid] => 10 [uid] => 1 [title] => Beachhead Don [log] => 
[status] =>  1 [comment] => 1 [promote] => 0 [sticky] => 0 [ds_switch] => [nid] => 
10 [type] => product [language] => und [created] => 1357668665 [changed] => 1358198386 
[tnid] => 0 [translate] => 0 [revision_timestamp] => 1358198386 [revision_uid] => 1  
[model] => B 3000 [list_price] => 0.00000 [cost] => 0.00000 [sell_price] => 1.00000 
[weight] => 0 [weight_units] => lb [length] => 0 [width] => 0 [height] => 0 
[length_units] => in [pkg_qty] => 1 [default_qty] => 1 [unique_hash] => 
2eec0fcc8483f3a3541870fb24223296 [ordering] => 0 [shippable] => 0 [price] => 1.00000 
[body] => Array ( [und] => Array ( [0] => Array ( [value] => Description info 
))))))))))))))))))))))))))))))))))))))0 [summary] => [format] => filtered_html 
[safe_value] =>Description info ))))))))))))))))))))))))))))))))))))))0[safe_summary] 
=> ) ) ) [uc_product_image] => Array ( [und] => Array ( [0] => Array ( [fid] => 11 
[alt] => [title] => [width] => 90 [height] => 120 [uid] => 1 [filename] => 
beachhead_don.jpg [uri] => public://beachhead_don.jpg [filemime] => image/jpeg 
[filesize] => 14342 [status] => 1 [timestamp] => 1357668665 [rdf_mapping] => Array ( ) 
) ) ) [field_author] => Array ( [und] => Array ( [0] => Array ( [value] => John B. 
Romesier [format] => [safe_value] => John B. Romesier ) ) ) [field_publisher] => Array 
( [und] => Array ( [0] => Array ( [value] => Unknown [format] => [safe_value] => 
Unknown ) ) ) [field_release_date] => Array ( [und] => Array ( [0] => Array ( [value] 
=> Mar 2012 [format] => [safe_value] => Mar 2012 ) ) ) [field_number_of_pages] => Array 
( [und] => Array ( [0] => Array ( [value] => 123 ) ) ) [field_catagory] => Array ( 
[und] => Array ( [0] => Array ( [tid] => 4 ) ) ) [field_book_type] => Array ( [und] => Array ( [0] => Array ( [tid] => 1 ) ) ) [field_isbn] => Array ( ) [field_about_the_author] => Array ( [und] => Array ( [0] => Array ( [value] => Beachhed Don authoer............................ [format] => [safe_value] => Beachhed Don authoer............................ ) ) ) [rdf_mapping] => Array ( [rdftype] => Array ( [0] => sioc:Item [1] => foaf:Document ) [title] => Array ( [predicates] => Array ( [0] => dc:title ) ) [created] => Array ( [predicates] => Array ( [0] => dc:date [1] => dc:created ) [datatype] => xsd:dateTime [callback] => date_iso8601 ) [changed] => Array ( [predicates] => Array ( [0] => dc:modified ) [datatype] => xsd:dateTime [callback] => date_iso8601 ) [body] => Array ( [predicates] => Array ( [0] => content:encoded ) ) [uid] => Array ( [predicates] => Array ( [0] => sioc:has_creator ) [type] => rel ) [name] => Array ( [predicates] => Array ( [0] => foaf:name ) ) [comment_count] => Array ( [predicates] => Array ( [0] => sioc:num_replies ) [datatype] => xsd:integer ) [last_activity] => Array ( [predicates] => Array ( [0] => sioc:last_activity_date ) [datatype] => xsd:dateTime [callback] => date_iso8601 ) ) [cid] => 0 [last_comment_timestamp] => 1357668665 [last_comment_name] => [last_comment_uid] => 1 [comment_count] => 0 [name] => admin [picture] => 0 [data] => b:0; [entity_view_prepared] => 1 ) 
```

我正在尝试检索描述信息的[值] ))))))))))))))))))))))))))))))))))))))))))))))))))) 0

我试过这个

```
<?php
$node = menu_get_object();  //drupal code
if ( !empty($node) ) {
print $node ->body=>und=>0=>value;

}?> 
```

并收到有关“=”符号的错误。获取我的数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:43:48.123

`[body]`并且`[und]`是数组，所以像这样访问它们：

```
echo $node->body['und'][0]['value']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:45:25.717

应该是：$node->body['und'][0]['value']

'Body' 和 'und' 是数组，需要使用数组语法（[]）访问。

在 drupal 中，有时不赞成直接访问这些值。您可能想查看：[http ://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_render/7](http://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_render/7)

# c++ - c ++如何搜索向量中的结构元素是否相等？

> ID：14344583
> 
> 赞同：0
> 
> 时间：2013-01-15T18:40:04.737
> 
> 标签：c++, stl-algorithm

一个名为的类有一个s 结构`SparseMatrix`的向量。`Node`我想重载`+=`运算符，以便如果 Node 实例的`i`和`j`成员相同，则该节点的值将添加到`This`. 我如何使用算法库中的方法来实现这一点？

我尝试使用`find_if`传递给一个函数，但它只作用于一个迭代器：

```
class SparseMatrix
{
public:
    SparseMatrix(int numRow,int numCol, std::vector<double> fill);
    SparseMatrix(int numRow,int numCol);
    SparseMatrix();

    // assignment operations
    bool operator==(const SparseMatrix &other) const;
    bool operator!=(const SparseMatrix &other) const;
    void operator-() const;

    // compound operations
    SparseMatrix& operator+=(const SparseMatrix &other);
    SparseMatrix& operator*=(const SparseMatrix &other);

    // binary operations
    const SparseMatrix operator+(const SparseMatrix &other) const;
    const SparseMatrix operator*(const SparseMatrix &other) const;

    friend std::ostream& operator<<(std::ostream& output, const SparseMatrix sparseMatrix);

    bool trace(double& result) const;
    bool det(double& result) const;
    SparseMatrix transpose();

    ~SparseMatrix(){};

protected:
    vector<Node> _matrix;
    int _numCol, _numRow;
};

typedef struct Node {
    int i;
    int j;
    double value;
    static bool samePosition(const Node& other)
        {
            return ((i == other.i) && (j == other.j));
        }
} Node;

SparseMatrix& SparseMatrix::operator+=(const SparseMatrix &other)
{
    vector<Node>::iterator itThis;
    for (vector<Node>::iterator itOther = other._matrix.begin(); itOther != other._matrix.end(); ++itOther)
    {
            // find if already exists a value in the same matrix position
        itThis = find_if(_matrix.begin(), _matrix.end(), Node::samePosition);

            // if exists add value to position, else instantiate new Node with value &  position
    }

    return *this;
} 
```

基本上，我希望 Node::samePosition() 传递两个参数——传递的当前迭代器`find_if`，`itOther`因此它可以检查它们是否相等。

**编辑：**我已经分离了`samePosition`函数，现在想使用两个参数传递给它`find_if`：

```
typedef struct Node {
    int i;
    int j;
    double value;
} Node;

static bool SparseMatrix::samePosition(const Node& first, const Node& other)
{
    return ((first.i == other.i) && (first.j == other.j));
} 

SparseMatrix& SparseMatrix::operator+=(const SparseMatrix &other)
{
    vector<Node>::iterator itThis;
    for (vector<Node>::iterator itOther = other._matrix.begin(); itOther != other._matrix.end(); ++itOther)
    {
        itThis = find_if(_matrix.begin(), _matrix.end(), SparseMatrix::samePosition("call what here?",itOther));
    }

    return *this;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:19:52.527

您正在尝试使用

```
static bool SparseMatrix::samePosition(const Node& first, const Node& other)
{
    return ((first.i == other.i) && (first.j == other.j));
} 
```

这是一个独立的功能。它的所有数据都必须由调用者提供，但对要与整个列表进行比较的数据`find_if`一无所知。`Node`

相反，您应该使用仿函数，它是一个可以保存一些数据的对象，并且还实现`operator()()`了它以便可以像函数一样调用它。

```
struct position_finder
{
    const Node needle;
    position_finder( const Node& sought ) : needle(sought) {}
    bool operator()( const Node& haystack ) const
    {
        return ((needle.i == haystack.i) && (needle.j == haystack.j));
        // or return samePosition(needle, haystack)
    }
}; 
```

然后在构造函子时传递寻找的节点，以便将其存储以供以后使用：

```
itThis = find_if(_matrix.begin(), _matrix.end(), position_finder(*itOther)); 
```

C++11 使这一切变得容易得多，因为 lambda 将使编译器为您生成该结构：

```
itThis = find_if(_matrix.begin(), _matrix.end(), [itOther](Node& arg){ return ((itOther->i == arg.i) && (itOther->j == arg.j)); }); 
```

# c++ - 有没有办法在 C++/MFC 中使用 SHORT 系统时间图？

> ID：14344592
> 
> 赞同：1
> 
> 时间：2013-01-15T18:40:45.480
> 
> 标签：c++, time, mfc, system

我有一个带有时间控制的 MFC 对话框。目前，如果我在我的 PC 上更改“长时间”格式（例如在 Win7 -> 区域和语言 -> 长时间），对话框将跟随并以所选格式显示。但是，我不需要显示秒数。有没有办法可以代替“短时间”图片？

我知道我可以通过在控件上使用 .SetFormat 来删除秒数，但是这对我输入的任何格式都进行了硬编码，并且不允许用户在标准时间和军用时间之间切换（这是必需的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:27:12.330

使用[GetLocaleInfoEx](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd318103%28v=vs.85%29.aspx)获取用户区域设置的短日期格式字符串（即 LOCALE_SSHORTDATE）并将其传递给 SetFormat 方法。

# android - Android 为什么我的 FTP 文件传输在 Eclipse 的 USB 调试模式下成功，而在独立 wifi 时失败？

> ID：14344595
> 
> 赞同：0
> 
> 时间：2013-01-15T18:41:02.600
> 
> 标签：android, eclipse, ftp, usb

我正在开发一个应用程序，我需要使用 wifi 从/向 FTP 服务器传输文件。调试时，用 USB 电缆连接到 Eclipse，应用程序工作......但是，当我处于独立模式时，不使用 Eclipse IDE，传输不会发生。FTP 服务器是本地的，我可以看到正在建立的连接......并且卡在文件传输中

```
 (000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> Connected, sending welcome message...
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> 220-FileZilla Server version 0.9.41 beta
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> 220-written by Tim Kosse (Tim.Kosse@gmx.de)
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> 220 Please visit http://sourceforge.net/projects/filezilla/
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> PASV
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> 530 Please log in with USER and PASS first.
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> USER th38939
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> 331 Password required for th38939
(000056)15/01/2013 16:42:20 - (not logged in) (192.168.1.113)> PASS ***********
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 230 Logged on
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> TYPE I
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 200 Type set to I
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> CWD /public_ftp/cobradores/cobrador_01/remessa/
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 250 CWD successful. "/public_ftp/cobradores/cobrador_01/remessa" is current directory.
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> PWD
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 257 "/public_ftp/cobradores/cobrador_01/remessa" is current directory.
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> PORT 192,168,1,113,202,216
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 200 Port command successful
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> NLST
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 150 Opening data channel for directory list.
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 226 Transfer OK
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> PORT 192,168,1,113,133,181
(000056)15/01/2013 16:42:20 - th38939 (192.168.1.113)> 200 Port command successful
(000056)15/01/2013 16:42:21 - th38939 (192.168.1.113)> RETR ARQUIVO_TESTE.REM
(000056)15/01/2013 16:42:21 - th38939 (192.168.1.113)> 150 Opening data channel for file transfer.
(000056)15/01/2013 16:42:21 - th38939 (192.168.1.113)> 226 Transfer OK
(000056)15/01/2013 16:44:21 - th38939 (192.168.1.113)> 421 Connection timed out.
(000056)15/01/2013 16:44:21 - th38939 (192.168.1.113)> disconnected. 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:24:41.153

可能是因为 CPU 将进入睡眠状态（如果连接了调试器，它不会进入睡眠状态）。但是您还需要保持 wifi 连接处于活动状态。

您需要各种锁来保持设备处于活动状态。至少一个WifiLock。还有一个带有 CPU 锁的 WakeLock。WakeLock 应该通过 PowerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"tag") 获取。PARTIAL_WAKE_LOCK 是唯一阻止 CPU 进入睡眠模式的锁。

如果该进程要运行任意时间长度，您还需要在一个名为 Service.startForeground 的服务中运行。如果您没有调用 startForeground，Android 将每 30 分钟（有时比这更频繁）终止任何服务或后台应用程序。注意 Context.bindService 中的错误。绑定到服务时不要使用 Context.BIND_ABOVE_CLIENT 标志，因为这会触发 Android 4.x 中的错误，从而阻止为服务分配前台状态。

另一个可以发挥作用的有趣错误。某些 Android 设备错误地实现了低功耗模式。在省电模式下运行时，系统正常运行时间时钟的运行速度只是其应有的速度的一小部分。如果您使用睡眠或其他延迟机制，它们可能会花费比应有的时间长得多的时间。

# wpf - wnd.Show(Me) 在 WPF 中不起作用

> ID：14344596
> 
> 赞同：2
> 
> 时间：2013-01-15T18:41:05.240
> 
> 标签：wpf, windows, vb.net, .net-4.0

在我以前的多窗口程序中，我曾经使用过这个参数

```
wnd.Show(Me) 
```

此代码将 wnd 保持在第一个窗口之上。无论如何在WPF中它都会出错

“'公共子节目'的论点太多”

我怎样才能在 WPF 中具有相同的优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:42:58.530

您可以在 WPF 中设置[Window.Owner](http://msdn.microsoft.com/en-us/library/system.windows.window.owner.aspx)属性来完成此操作：

```
wnd.Owner = Me
wnd.Show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:45:33.567

您尝试使用的功能不存在。Window.Owner属性[就是](http://msdn.microsoft.com/en-us/library/system.windows.window.owner.aspx)您要寻找的。

```
wnd.Owner = Me
wnd.Show() 
```

[如果您试图将Window.ShowDialog](http://msdn.microsoft.com/en-us/library/system.windows.window.showdialog.aspx)保持在顶部和模态，您可能还想使用它 - “此代码将 wnd 保持在第一个窗口之上”听起来您可能会选择模态。

# performance - 为什么部署的 Meteor 站点需要这么长时间才能加载？

> ID：14344602
> 
> 赞同：6
> 
> 时间：2013-01-15T18:41:22.277
> 
> 标签：performance, optimization, meteor

对于一个非常简单的应用程序，我的 Meteor 站点需要 4.1 秒才能开始下载第一个字节的数据。这是一个非常基本的设置。相关时间等（取自[http://www.webpagetest.org](http://www.webpagetest.org)）是：

```
IP: 107.22.210.133
Location: Ashburn, VA
Error/Status Code: 200
Start Offset: 0.121 s
DNS Lookup: 64 ms
Initial Connection: 56 ms
Time to First Byte: 4164 ms
Content Download: 247 ms
Bytes In (downloaded): 0.9 KB
Bytes Out (uploaded): 0.4 KB 
```

这是因为 Meteor 速度慢，还是我的代码可能存在瓶颈？有没有办法确定这一点？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T20:54:17.440

该延迟是订阅从服务器获取数据所需时间的函数。如果客户端在页面加载时需要的任何文档数据是静态的，请将其存储在非托管（非同步）本地集合中，以便在初始页面加载时立即可用。有关存储在非托管与托管集合中的数据的加载时间比较，请参见[collections.meteor.com](http://collections.meteor.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T08:51:22.210

根据webpagetest，那是：

> DNS、套接字和 SSL 协商所需的时间 + 100 毫秒。

我喜欢@ram1 的回答，但我想补充一点，这也是因为您的服务器性能。这段时间在共享主机中很常见。有两种解决方法：更改您的主机或添加 CDN 服务。

此外，如果您的重定向较少，这将有所帮助。

您应该更好地利用缓存，对于 Chrome 用户，您可以应用[pre-party](https://docs.google.com/presentation/d/18zlAdKAxnc51y_kj-6sWLmnjl6TLnaru_WH0LJTjP-o/present?slide=id.p19)功能。

# jquery - 左侧带有固定菜单栏的网页内容滑块

> ID：14344604
> 
> 赞同：1
> 
> 时间：2013-01-15T18:41:27.987
> 
> 标签：jquery, html

您好我正在尝试创建一个幻灯片内容页面，左侧有一个固定菜单，中间有滑动内容。我正在使用 twitter bootstrap 并尝试将菜单放入类中。现在一切都在这个地方，我不知道如何让内容在中心和菜单固定在左侧，所以只有中间的东西移动。

这是代码，非常感谢任何帮助 [http://jsfiddle.net/4HBmV/](http://jsfiddle.net/4HBmV/)

```
<div id="wrapper">

<div class="well sidebar-nav">

    <div id="mask">

    <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Sidebar</li>
              <li class="active"><a href="#">Link</a></li>
              <li><div id="item1" class="item">
             <a href="#item2" class="panel">1</a>       

        </li>

            </ul>
          </div><!--/.well -->
        </div><!--/span-->
</div> 
```

这是实际的 jquery 滑块[http://www.queness.com/resources/html/scroll/vertical.html](http://www.queness.com/resources/html/scroll/vertical.html)

# angularjs - AngularJS - 没有嵌入的嵌套指令？

> ID：14344606
> 
> 赞同：2
> 
> 时间：2013-01-15T18:41:31.347
> 
> 标签：angularjs

伴随着[plunker](http://plnkr.co/edit/PSkGN5LMIwZbsSorw9ip?p=preview)。

我在 div 中有一个属性级自定义指令。该指令有一个孤立的范围。在我的 div 中，我有其他指令希望在父级的范围内。

问题是**我的 div 中的指令只能访问隔离范围，而不是父范围**。我明白为什么，但我不清楚如何干净地解决它。

我知道我可以使用 transclude 来解决这个问题（请参阅[plunker](http://plnkr.co/edit/XmxCAQGFNBZB0aMDFJzE?p=preview)），但这感觉很草率。我不需要模板，但我必须创建一个模板才能使 transclude 工作，并且 transclude 似乎是确保我的嵌套指令可以访问正确范围的唯一方法。

有没有另一种更清洁的方法来做到这一点？

为了避免一些可能的问题：

*   我正在使用属性级指令而不是元素级来使 IE 更容易
*   我正在使用隔离范围，因为它是一种最佳实践——我不想意外地占用我的父范围，并且我希望该指令是可移植的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:18:15.620

我真的不确定你*想做*什么。

但是您实际上正在做的是在一个孤立的范围内利用双向绑定来产生不良影响。这似乎与您的问题无关。

无论如何...[这是您的 plunker 的更新](http://plnkr.co/edit/IozEDGontIeprGTm1cMC)

基本上发生的事情是在您的隔离指令内部，您需要使用您在范围声明中分配的任何名称，在这种情况下是`toggleOn()`.

但是，如果您愿意，[可以这样做](http://plnkr.co/edit/QxxapMii9r3jP8lGDUiO)。基本上只要打电话`$parent.colorToggle()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:18:23.123

您可以决定这是否比嵌入“不那么草率”：

```
<button ng-click="$parent.colorToggle()">Inside</button> 
```

`$parent`隔离作用域可以通过属性访问父作用域。尽管隔离作用域在原型上并不从其父作用域继承，但 Angular 仍然通过 $parent 和 $$childHead 和 $$childTail 维护层次结构。

# iphone - 初始子视图控制器

> ID：14344619
> 
> 赞同：0
> 
> 时间：2013-01-15T18:42:06.327
> 
> 标签：iphone, ios, xcode

我有一个带有 4 个按钮的自定义容器视图控制器。我的目标是让这 4 个按钮加载 4 个子视图控制器中的每一个。我现在面临的问题是我不知道如何让这些按钮显示子视图控制器。我已经执行`addChildViewController`了必要的`didMoveToParentController`......但是当我无法使用该`transitionFromViewController:toViewController`功能时，因为我在父级中没有已经存在的子 VC。所以基本上问题是我如何使带有 4 个按钮（自定义容器）的导航屏幕最初导航到第一个子 VC？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:50:41.177

通过调用您提到的包含 API 并使用添加子视图来添加您的初始子控制器的视图`[self.view addSubview:childController.view]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:46:57.030

您可以调用 transitionFromViewController:toViewController 并在动画块中手动执行视图转换。您可以通过跟踪属性中的初始状态来以不同的方式处理初始情况。

# ocaml - 如何避免 Ocaml 的 Format 漂亮打印机中的可选换行符？

> ID：14344623
> 
> 赞同：2
> 
> 时间：2013-01-15T18:42:14.673
> 
> 标签：ocaml

是否有巧妙的技巧来避免 OCaml 的格式化程序（表单格式）插入换行符（特别是那些来自 的`print_break (@ )`）标签？

我有一个有点大的软件，它会发出很多消息，我想在它们上使用 Unix 工具，比如`grep`和`sed`. 但是当格式化程序拆分消息时，插入的换行符会阻止它们工作。代码中有太多的格式化程序，我无法单独跟踪所有这些格式化程序并通过`set_margin`.

这样一个聪明的技巧可能包括将 Format 包装在另一个模块中，或者最终重新编译 OCaml 本身，如果有一个可以将默认边距设置为 9999 之类的中心点。我尝试了一些实验，例如在调用`Format.set_margin`main 之后调用，但它似乎不适用于程序创建的格式化程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:55:13.797

你可以试试

```
let out,flush,_,spaces = get_all_formatter_output_functions ()
in set_all_formatter_output_functions out flush (fun () -> out " " 0 1) spaces 
```

如果成功，它将打印空格而不是换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T10:11:29.280

如果您不害怕残酷的解决方案：

```
find . -type f -regex ".+\\.ml" -exec sed -i 's/Format/MyFormat/g' {} \; 
```

和 myFormat 文件可以是

```
include Format
let formatter_of_out_channel c =
  let f = formatter_of_out_channel c in
  pp_set_margin f 9999;
  f 
```

`formatter_of_buffer`并且您为and添加相同的内容`make_formatter`。

# c - 显示字符 ASCII 码和出现次数

> ID：14344625
> 
> 赞同：-2
> 
> 时间：2013-01-15T18:42:17.137
> 
> 标签：c

我想制作一个程序，它从文件中读取文本并显示每个字符、每个字符的 ASCI 代码和出现次数。我写了这个，但它没有显示发生的情况。

```
#include <stdio.h>
#include <stdlib.h>

int main ()
{
     FILE * pFile;

     int i=0;
     int j=0;
     char text[j];
     int ascii[256];
     int occ[256];
     int occurance=0;
     int position;
     pFile = fopen ("c:/1.in","r");
     if (pFile==NULL) perror ("Error opening file");
     else
     {
         while (!feof(pFile)) { 
         j++;
         text[j]=getc (pFile);
         ascii[j]= (int) text[j];
         position=ascii[j];
         occ[position]++;
     }

     for (i=1;i<j;i++){
         occurance=position[i]

         printf ("Chracter %c  has  ascii %d and occurs  %d times \n",   text[i],ascii[i],occ[occurance]  );}
     }
     system("PAUSE");
     return 0;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:11:24.860

首先，我不明白这一点：

```
int j=0;
char text[j]; 
```

如果要将文件中的每个字符放入数组中，则读取文件的大小和`malloc()`指针的正确大小。但为什么要这样做呢？如果您想计算曾经出现的任何角色，那么只需跟踪可能性。

为了完整起见，您可以使用 256 个字符的数组，但实际上，如果您只是查看标准可打印字符，则应该只有大约 94 个。

这个：

```
int main ()
{
  int temp = 0, i;
  int occ[256] = {0};
  FILE * pFile = fopen("test.txt", "r");

  if (pFile == NULL) perror("Error opening file");
  else {
     while (!feof(pFile)) { 
       temp = getc(pFile);
       if((temp < 255) && (temp >= 0)) 
         occ[temp]++;
     }
  }
//reads every character in the file and stores it in the array, then:

  for(i = 0; i<sizeof(occ)/sizeof(int); i++){
      if(occ[i] > 0)
          printf(" Char %c (ASCII %#x) was seen %d times\n", i, i, occ[i]);
  }

  return 0;
} 
```

将打印每个字符、ASCII 码（十六进制）和它显示的次数。

一个示例输入文件：

> fdsafcesac3sea

产生以下输出：

```
Char 3 (ASCII 0x33) was seen 1 times
Char a (ASCII 0x61) was seen 3 times
Char c (ASCII 0x63) was seen 2 times
Char d (ASCII 0x64) was seen 1 times
Char e (ASCII 0x65) was seen 2 times
Char f (ASCII 0x66) was seen 2 times
Char s (ASCII 0x73) was seen 3 times 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:02:41.763

Below simple logic works fine for me. Add file operations to get the `buf`.

```
int main()
{
   char buf[] = "abcaabde";
   char val[256] = {0};
   int i = 0;
   for (i = 0; i < sizeof(buf); i++)
   {
       val[buf[i]]++;
   }

   for (i = 0; i < 256; i++)
   {
       if (val[i] != 0)
       {
           printf("%c occured %d times\n", i, val[i]); 
       }
   }

   return 0;  
} 
```

Output is

```
 occured 1 times
a occured 3 times
b occured 2 times
c occured 1 times
d occured 1 times
e occured 1 times 
```

# lambda - opa：高阶函数应用

> ID：14344626
> 
> 赞同：1
> 
> 时间：2013-01-15T18:42:18.523
> 
> 标签：lambda, arguments, opa, higher-order-functions, thunk

在 Opa 中，可以部分应用函数。但是，我想提供一个带有所有参数的函数，并返回一个不带参数的函数。例如：

```
function make-thunk(f, a) { function() { f(a) } } 
```

上面的代码运行良好，但有一个问题：它只适用于只接受一个参数的函数。我很好奇 Opa 是否可以使上述内容更通用，因此该函数可用于任意数量的函数。

我无法在 Opa API、论坛、IRC、Github 或 SO 上找到有关 apply- (scheme) 或 call- (prolog) 之类的函数的信息，所以在这里我希望我在某个地方错过了一些东西。;-)（有一些 @lazy 关键字的痕迹，但没有解释或文档，所以我没有保留参考，抱歉。）

为了进一步澄清/说明：如果 Opa 是方案，我将编写以下代码：

```
(define (make-thunk f . args)
  (lambda () (apply f args))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:56:35.517

如果你想传递任意数量的参数，`make-thunk`那么你必须使用一个元组：

```
function f((a,b,c)) {
   ...
}

args = ("a","b","c")
make-thunk(f, args) 
```

顺便说一句，你在哪里找到提到的`@lazy`？

# php - php切换使用字符串和foreach循环

> ID：14344631
> 
> 赞同：0
> 
> 时间：2013-01-15T18:42:33.970
> 
> 标签：php, mysql

下面的代码非常适合在行中列出每个类，我已经将它从日期和时间按 ASC 排序但现在我想重新排列它，以便星期一发生的类按开始时间 ASC 在第一列中再次按顺序显示然后继续循环，使周二发生的课程出现在第二列中，以此类推。我不确定最好的方法，或者即使我需要重写我的 foreach 语句。我尝试使用字符串进行切换，其中每种情况都等于“星期一”、“星期二”等天。

```
<table>
<tr>
<th width="80">Day</th>
<th width="80">Class</th>
<th width="80">Instructor</th>
<th width="80">Start</th>
<th width="80">End</th>
<th width="80">Studio</th>
</tr>
 <?php
 foreach ($data as $key => $row) 
 {
    $start_date[$key] = $row['Calendar']['start_date'];
    $start_time[$key] = $row['Calendar']['start_time']; 
 }
 array_multisort($start_date, $start_time, $data);

 foreach ($data as $row) {
  <tr>
  <td><?php $row['Calendar']['start_date']; ?></td>
  <td><?php $row['Calendar']['title']; ?></td>
  <td><?php $row['Calendar']['instructor']; ?></td>
  <td><?php $row['Calendar']['start_time']; ?></td>
  <td><?php $row['Calendar']['end_time']; ?></td>
  <td><?php $row['Calendar']['location']; ?></td>
  </tr>
  </table> 
```

![行列表图像](../Images/a7e2b2ea19644172ffa80d55dec1b6d5.png)

![列中的天数](../Images/f2f3c8253a2f2e5a354d6c1beddf42ea.png)

使用 Mike B 的 SQL 时，我的 $data 来自 mysql db。

```
 array(13) { 
    [0]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "2" } ["calendars"]=> array(4) { ["title"]=> string(19) "Breakaway (Erin K.)" ["start_time"]=> string(8) "12:15:00" ["end_time"]=> string(8) "13:00:00" 

["location"]=> string(28) "Studio 1" } } 
[1]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "2" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Cindy B.)" ["start_time"]=> string(8) "16:30:00" ["end_time"]=> string(8) "17:15:00" 

["location"]=> string(28) "Studio 1" } } 
[2]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "2" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Larry N.)" ["start_time"]=> string(8) "18:15:00" ["end_time"]=> string(8) "19:00:00" 

["location"]=> string(28) "Studio 1" } } 
[3]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "3" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Megan S.)" ["start_time"]=> string(8) "06:45:00" ["end_time"]=> string(8) "07:30:00" 

["location"]=> string(28) "Studio 1" } } 
[4]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "3" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Larry N.)" ["start_time"]=> string(8) "11:15:00" ["end_time"]=> string(8) "12:00:00" 

["location"]=> string(28) "Studio 1" } } 
[5]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "3" } ["calendars"]=> array(4) { ["title"]=> string(19) "Breakaway (Lisa G.)" ["start_time"]=> string(8) "17:30:00" ["end_time"]=> string(8) "18:15:00" 

["location"]=> string(28) "Studio 1" } } 
[6]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "4" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Megan S.)" ["start_time"]=> string(8) "16:30:00" ["end_time"]=> string(8) "17:15:00" 

["location"]=> string(28) "Studio 1" } } 
[7]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "4" } ["calendars"]=> array(4) { ["title"]=> string(19) "Breakaway (Lisa G.)" ["start_time"]=> string(8) "12:15:00" ["end_time"]=> string(8) "13:00:00" 

["location"]=> string(28) "Studio 1" } } 
[8]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "5" } ["calendars"]=> array(4) { ["title"]=> string(21) "Breakaway (Lauren M.)" ["start_time"]=> string(8) "06:45:00" ["end_time"]=> string(8) "07:30:00" 

["location"]=> string(28) "Studio 1" } } 
[9]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "5" } ["calendars"]=> array(4) { ["title"]=> string(19) "Breakaway (Adam A.)" ["start_time"]=> string(8) "11:15:00" ["end_time"]=> string(8) "12:00:00" 

["location"]=> string(28) "Studio 1" } } 
[10]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "5" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Cindy B.)" ["start_time"]=> string(8) "17:30:00" ["end_time"]=> string(8) "18:15:00" 

["location"]=> string(28) "Studio 1" } } 
[11]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "6" } ["calendars"]=> array(4) { ["title"]=> string(19) "Breakaway (Adam A.)" ["start_time"]=> string(8) "16:30:00" ["end_time"]=> string(8) "17:15:00" 

["location"]=> string(28) "Studio 1" } } 
[12]=> array(2) { [0]=> array(1) { ["day_index"]=> string(1) "7" } ["calendars"]=> array(4) { ["title"]=> string(20) "Breakaway (Rotation)" ["start_time"]=> string(8) "09:35:00" ["end_time"]=> string(8) "10:35:00" 

["location"]=> string(28) "Studio 1" } } } 
```

SQL

```
SELECT DAYOFWEEK(start_date) as day_index, title, start_time, end_time, location FROM calendars WHERE calendar_category_id = '3' AND location = 'Studio 1' ORDER BY day_index 
```

得到它：

```
$calendar = array(); 
foreach ($data as $row) { 
$calendar[$row[0]['day_index']][] = $row;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:14:09.620

您是从数据库中获取这些数据吗？如果是这样，您可能需要考虑更改您的查询以获得这种不同的分组。也许是这样的：

```
SELECT DAYOFWEEK(date_field) AS day_index, [... other class fields ...]
FROM table
ORDER BY day_index ASC; 
```

然后你可以将你的数据读入一个二维数组，如下所示：

```
$calendar = array();
while ($row = $db_result->fetch() ) { // or whatever you use to iterate through the result set.
    $calendar[$row['day_index']][] = $row;
} 
```

这会给你一个这样的数组：

```
Array(
    '1' => Array(
         0 =>  Array(
             'day_index' =>  '1',
             ... other class fields ...
         ),
         1 =>  Array(
              'day_index' => 1,
             ... other class fields ...
         ),
         ... other class arrays from the result set ...
         ),
    '2' => ... Another numerically indexed array of class arrays for Monday classes ...
    '3' => ... Another numerically indexed array of class arrays for Tuesday classes ...
    ... and so on
) 
```

然后归结为您如何显示数据。我认为，为了做你想做的事，你可能需要放弃你拥有的基于表格的布局，而是使用浮动列之类的东西。

这可能看起来像这样::

```
<?php
$days_of_week = array(
    '1' => 'Sunday',
    '2' => 'Monday',
    // etc.
);
?>
<div style="overflow: auto;">
<?php foreach ($calendar as $day_index => $classes) { ?>
    <div style="width: 150px; margin: 5px; float: left;">
        <div style="margin: auto;"><?php echo $days_of_week[$day_index]; ?></div>
        <?php foreach ($classes as $class) {?>
            <div style="width:150px">
            <!-- class info here -->
            </div>
        <?php } ?>
    </div>
<?php } ?>
</div> 
```

# python - 为什么我的 pygame 屏幕没有正确更新？

> ID：14344634
> 
> 赞同：3
> 
> 时间：2013-01-15T18:42:49.620
> 
> 标签：python, pygame

我有一个小动画，其中圆圈应该在消失并重新出现在其他地方之前增长。有点像池塘上的涟漪，但现在一次只有一个。我正在使用 pygame 库。

问题是，屏幕更新不够，而不是一个半径越来越大的空圆圈，我得到一个变大的实心圆圈。

有谁知道为什么？

```
import pygame
import random

pygame.init()

black=[0,0,0]
white=[255,255,255]

size_x=800
size_y=600

size=[size_x,size_y]
screen=pygame.display.set_mode(size)
pygame.display.set_caption("Circles")

point=[]

x=size_x/2
y=size_y/2

clock=pygame.time.Clock()

done =False
while done==False:

    for event in pygame.event.get():
        if event.type==pygame.QUIT:
            done=True

    screen.fill(black)

    x+=random.randint(-1,1)*20
    y+=random.randint(-1,1)*20

    if x>size_x:
        x-=size_x

    if y>size_y:
        y-=size_y

    if x<0:
        x+=size_x

    if y<0:
        y+=size_y

    point=[x,y]

    c_1=random.randint(0,255)
    c_2=random.randint(0,255)
    c_3=random.randint(0,255)

    color=[c_1,c_2,c_3]

    for i in range(2,15):

        radius=i
        pygame.draw.circle(screen,color,point,radius,1)

        pygame.display.update()
        clock.tick(15) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:51:34.097

这是因为你在画完每个圆圈后并没有清屏，所以它们“堆积”起来，形成了一个实心圆圈。

将最里面的循环更改为：

```
for i in range(2,15):

    screen.fill(black)
    radius=i
    pygame.draw.circle(screen,color,point,radius,1)

    pygame.display.update()
    clock.tick(15) 
```

将解决问题，为一个单一的圈子。对于多个圆圈，您将需要删除这个最里面的循环，并为 while 循环的每次迭代绘制一个圆圈。

If you are new to 2D graphics concepts, you may find it useful to read a basic [pygame tutorial about moving an image](http://www.pygame.org/docs/tut/MoveIt.html). Good Luck!

# java - Android的翻转板菜单样式

> ID：14344638
> 
> 赞同：2
> 
> 时间：2013-01-15T18:43:04.573
> 
> 标签：java, android, flipboard

在我的应用程序中，如果我们单击一个按钮，第一个活动应该只在最后某个部分打开透明的第二个活动。所以当我们在第二个活动中时，第一个活动的内容应该是可见的。它就像 android 中的 Flipboard 样式菜单一样，在 Flipboard 中，如果我们单击顶部红色按钮，我们将获得另一个屏幕，我们可以在底部看到之前的屏幕，就像我需要的那样。如果有人有想法，请与我分享如何做翻板式菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:46:38.230

使用[Fragments](http://developer.android.com/guide/components/fragments.html)来解决这个问题，这就是它们的用途。

如果你想使用 API 8，我仍然推荐 Fragments，但是你需要使用[ActionBarSherlock](http://actionbarsherlock.com/)，它为你提供了你需要的所有功能。

# symfony - 如何禁用表单选择类型中的特定项目？

> ID：14344639
> 
> 赞同：11
> 
> 时间：2013-01-15T18:43:06.323
> 
> 标签：symfony, symfony-forms

我有一个表格，其中包含数据库中实体的选择字段：

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder->add('categories', 'document', array(
        'class' => 'Acme\DemoBundle\Document\Category',
        'property' => 'name',
        'multiple' => true,
        'expanded' => true,
        'empty_value' => false
    ));
} 
```

此表单将生成复选框列表，并将呈现为：

```
[ ] Category 1
[ ] Category 2
[ ] Category 3 
```

我想按值禁用此列表中的某些项目，但我不知道我应该在哪里拦截选择字段项目来做到这一点。

有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T20:42:10.323

只需使用事件侦听`finishView`器处理它。`PRE_BIND`

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder->add('categories', 'document', array(
        'class' => 'Acme\DemoBundle\Document\Category',
        'property' => 'name',
        'multiple' => true,
        'expanded' => true,
        'empty_value' => false
    ));

    $builder->addEventListener(FormEvents::PRE_BIND, function (FormEvent $event) {
        if (!$ids = $this->getNonEmptyCategoryIds()) {
            return;
        }

        $data = $event->getData();

        if (!isset($data['categories'])) {
            $data['categories'] = $ids;
        } else {
            $data['categories'] = array_unique(array_merge($data['categories'], $ids));
        }

        $event->setData($data);
    });
}

...

public function finishView(FormView $view, FormInterface $form, array $options)
{
    if (!$ids = $this->getNonEmptyCategoryIds()) {
        return;
    }

    foreach ($view->children['categories']->children as $category) {
        if (in_array($category->vars['value'], $ids, true)) {
            $category->vars['attr']['disabled'] = 'disabled';
            $category->vars['checked'] = true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-12-30T09:42:59.313

您可以使用`'choice_attr'`in并传递一个函数，该函数将根据选择的值、键或索引来`$form->add()`决定是否添加 属性。`disabled`

```
...
    'choice_attr' => function($key, $val, $index) {
        $disabled = false;

        // set disabled to true based on the value, key or index of the choice...

        return $disabled ? ['disabled' => 'disabled'] : [];
    },
... 
```

# json - 不允许在 symfony2 中使用 json 对象？

> ID：14344647
> 
> 赞同：0
> 
> 时间：2013-01-15T18:43:26.733
> 
> 标签：json, symfony, twitter

我检索了一个 json 格式的 twitter 提要，当我在我的 apacheserver 上运行这个块时，它工作正常，并提供了一个带有 twitter 提要的漂亮表格。

但是，当放置在 symfony2 控制器中时，它会因以下错误消息而中断：

```
Notice: Undefined property: stdClass::$retweeted_status in /var/www/cloudsign_beta/src/BizTV/ArchiveBundle/Controller/DefaultController.php line 76 
```

编码：

```
public function TwitterAction($rts, $name, $count)
{

    if ($rts=='on') {
        $rts = 'true';
    }
    else {
        $rts = 'false';
    }

    if ($name=='') {
        //$name = 'warpnine'; 
        //Bazinga!
    }

    if ($count=='') {
        $count = 10;
    }

    $variable = file_get_contents('https://api.twitter.com/1/statuses/user_timeline.json?include_rts='.$rts.'&screen_name='.$name.'&count='.$count);
    $tws = json_decode($variable);

    if (isset($tws)) {
        $r = '<table>';
            foreach ($tws as $tw){
                if ($tw->retweeted_status->id > 0) {
                    $r .='<tr><td class="twitter_td"><img src="'.$tw->retweeted_status->user->profile_image_url.'" class="twitter_img"></td><td>'.
                                $tw->retweeted_status->user->name.
                                ' <i>@'.$tw->retweeted_status->user->screen_name.'</i><br>'.
                                $tw->text.'</td></tr>';
                } else {
                    $r .= '<tr><td class="twitter_td"><img src="'.$tw->user->profile_image_url.'" class="twitter_img"></td><td>'.
                                $tw->user->name.
                                ' <i>@'.$tw->user->screen_name.'</i><br>'.
                                $tw->text.'</td></tr>';
                }
            }
        $r .= '</table>';
    }
    else {
        $r = "Hittade ingen twitterfeed för <strong>$name</strong>";
    }

    return new Response($r);

} 
```

这是 $tw 第一次迭代的 var_dump

```
object(stdClass)#878 (19) { ["created_at"]=> string(30) "Tue Jan 15 15:48:55 +0000 2013" ["id"]=> int(291210363318435841) ["id_str"]=> string(18) "291210363318435841" ["text"]=> string(97) "Looking forward to speaking at Washington and Lee University in Lexington, Virginia, later today!" ["source"]=> string(63) "TweetDeck" ["truncated"]=> bool(false) ["in_reply_to_status_id"]=> NULL ["in_reply_to_status_id_str"]=> NULL ["in_reply_to_user_id"]=> NULL ["in_reply_to_user_id_str"]=> NULL ["in_reply_to_screen_name"]=> NULL ["user"]=> object(stdClass)#875 (38) { ["id"]=> int(287413569) ["id_str"]=> string(9) "287413569" ["name"]=> string(8) "Ron Paul" ["screen_name"]=> string(7) "RonPaul" ["location"]=> string(27) "Clute, TX / Washington D.C." ["url"]=> NULL ["description"]=> string(99) "Former Congressman from Texas, Chairman of Campaign for Liberty, and Champion of the Constitution. " ["protected"]=> bool(false) ["followers_count"]=> int(387763) ["friends_count"]=> int(159) ["listed_count"]=> int(4852) ["created_at"]=> string(30) "Sun Apr 24 23:20:55 +0000 2011" ["favourites_count"]=> int(1) ["utc_offset"]=> int(-18000) ["time_zone"]=> string(26) "Eastern Time (US & Canada)" ["geo_enabled"]=> bool(false) ["verified"]=> bool(true) ["statuses_count"]=> int(976) ["lang"]=> string(2) "en" ["contributors_enabled"]=> bool(false) ["is_translator"]=> bool(false) ["profile_background_color"]=> string(6) "ED1D24" ["profile_background_image_url"]=> string(93) "http://a0.twimg.com/profile_background_images/758570925/9c556d05e88c52861e85356d0cbf1a4c.jpeg" ["profile_background_image_url_https"]=> string(95) "https://si0.twimg.com/profile_background_images/758570925/9c556d05e88c52861e85356d0cbf1a4c.jpeg" ["profile_background_tile"]=> bool(false) ["profile_image_url"]=> string(90) "http://a0.twimg.com/profile_images/3066929869/81d574c68b91e40db69992c0afd34d29_normal.jpeg" ["profile_image_url_https"]=> string(92) "https://si0.twimg.com/profile_images/3066929869/81d574c68b91e40db69992c0afd34d29_normal.jpeg" ["profile_banner_url"]=> string(58) "https://si0.twimg.com/profile_banners/287413569/1357674836" ["profile_link_color"]=> string(6) "DE0A22" ["profile_sidebar_border_color"]=> string(6) "FFFFFF" ["profile_sidebar_fill_color"]=> string(6) "FFFFFF" ["profile_text_color"]=> string(6) "333333" ["profile_use_background_image"]=> bool(true) ["default_profile"]=> bool(false) ["default_profile_image"]=> bool(false) ["following"]=> NULL ["follow_request_sent"]=> NULL ["notifications"]=> NULL } ["geo"]=> NULL ["coordinates"]=> NULL ["place"]=> NULL ["contributors"]=> NULL ["retweet_count"]=> int(96) ["favorited"]=> bool(false) ["retweeted"]=> bool(false) } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:13:11.963

注意：未定义的属性意味着在这种情况下不存在“转推状态”（对于循环中的此项）。正如评论中提到的，sf2 默认情况下具有严格模式（改进代码的好东西）。

尝试添加类似

```
if(isset($tw->retweeted_status) { } 
```

所以你的代码看起来像

```
foreach ($tws as $tw){
    if(isset($tw->retweeted_status) {
            if ($tw->retweeted_status->id > 0) {
                $r .='<tr><td class="twitter_td"><img src="'.$tw->retweeted_status->user->profile_image_url.'" class="twitter_img"></td><td>'.
                            $tw->retweeted_status->user->name.
                            ' <i>@'.$tw->retweeted_status->user->screen_name.'</i><br>'.
                            $tw->text.'</td></tr>';
            } else {
                $r .= '<tr><td class="twitter_td"><img src="'.$tw->user->profile_image_url.'" class="twitter_img"></td><td>'.
                            $tw->user->name.
                            ' <i>@'.$tw->user->screen_name.'</i><br>'.
                            $tw->text.'</td></tr>';
            }
    }
} 
```

# debugging - 如何在 ubuntu 上使用调试库

> ID：14344654
> 
> 赞同：10
> 
> 时间：2013-01-15T18:43:45.047
> 
> 标签：debugging, ubuntu, webkit, gtk

我目前的问题是 libwebkitgtk-3.0-0，但我想这个问题足够通用。

我的应用程序在 webkit 代码的某处崩溃。我的假设是我们正在做一些愚蠢的事情，并想知道是什么。最简单的事情是设置断点或使用库的调试版本。

1.  如何获得构建哪个库的确切源代码？我在转储核心后得到堆栈跟踪，但行号 gdb 说与我在代码中看到的不匹配。换句话说，如果我安装 libwebkitgtk-3.0-0 我想获得它的确切源代码。

2.  我已经安装了 webkit 库的调试版本。这些调试版本是否具有与使用 --enable-debug 标志编译 webkit 相同的功能？调试版本的 webkit 启用基于 WEBKIT_DEBUG 环境变量的日志记录，但即使使用调试版本的库，我也无法获得相同的日志记录。

3.  如何使用我设法编译的调试版本？我设法在我的机器上编译 webkit 并尝试摆弄加载路径等。无论我做什么，我的应用程序都不会获取新的共享库 - 我可以根据用户代理签名来判断。有一次，我设法拿起图书馆，但随后 SSL 停止工作。GtkLauncher 确实会发生同样的 SSL 问题。所以我在某个地方犯了错误。

感谢您的指点。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-20T02:14:18.900

**TL;DR：**安装[libwebkitgtk-3.0-0-dbg![安装 libwebkitgtk-3.0-0-dbg](../Images/9c0ca64d07fa4569c5ceecf38294a9aa.png)](https://packages.ubuntu.com/search?keywords=libwebkitgtk-3.0-0)，然后你就有了必要的调试符号。

##对于调试符号，您通常不必从源代码安装。

如您所知，要为您自己构建的软件获取调试符号，您可以使用`-g`.

对于通过操作系统的包管理器安装的软件（包括`libwebkitgtk-3.0-0`, 这里），至少对于官方包，通常还有**提供调试符号**的包。

您实际上不需要对程序或库进行调试构建即可在`gdb`. `gdb`还支持在`/usr/lib/debug`.

*根据您问题上的标签，您使用 Ubuntu。*在 Ubuntu 上，调试符号包有两种可用：`-dbg`和`-dbgsym`. 位于 的程序或库在获取调试符号。`/***path***``/usr/lib/debug/***path***`

##`-dbg`包

这些包的命名通常与提供实际可执行文件或库文件的相应包不同。它们的命名通常类似于`-dev`包（提供头文件）和`-doc`包。一个`-dbg`包的名称中的库版本编号有时比实际的库包少，有时涵盖多个其他包中提供的二进制文件。

例如，[`libgtkmm-3.0-1`](http://packages.ubuntu.com/quantal/libgtkmm-3.0-1)的对应`-dbg`包是[`libgtkmm-3.0-dbg`](http://packages.ubuntu.com/quantal/libgtkmm-3.0-dbg)。

另一方面，有时`-dbg`包的名称与它提供符号的包相同（`-dbg`后缀除外）。例如，**[`libwebkitgtk-3.0-0`](http://packages.ubuntu.com/quantal/libwebkitgtk-3.0-0)的对应`-dbg`包是[`libwebkitgtk-3.0-0-dbg`](http://packages.ubuntu.com/quantal/libwebkitgtk-3.0-0-dbg)。** *那就是你想要的那个。*

您可以在软件中心安装它或通过运行：

```
sudo apt-get update && sudo apt-get install libwebkitgtk-3.0-0-dbg 
```

现在，当您调试链接到由 提供的库的程序时`libwebkitgtk-3.0-0`，`gdb`将自动从 提供的文件中加载符号`libwebkitgtk-3.0-0-dbg`。

##`-dbgsym`包

有时官方包提供的二进制可执行文件没有任何`-dbg`包中提供的符号。发生这种情况时，通常您可以安装该`-dbgsym`软件包。

与`-dbg`包不同，`-dbgsym`包：

*   几乎总是简单地（并且可以预见地）命名提供程序或库本身的包`***X***-dbgsym`在哪里。***`X`***
*   由特殊的软件源（存储库）提供，*与*提供相应程序/库包和`-dbg`包的软件源不同。

由于`-dbgsym`包位于单独的存储库中，因此您必须启用这些存储库。他们的 DEB 线路是：

```
deb http://ddebs.ubuntu.com **YOUR_RELEASE** main restricted universe multiverse
deb http://ddebs.ubuntu.com **YOUR_RELEASE**-updates main restricted universe multiverse
deb http://ddebs.ubuntu.com **YOUR_RELEASE**-security main restricted universe multiverse
deb http://ddebs.ubuntu.com **YOUR_RELEASE**-proposed main restricted universe multiverse
```

要启用它们，您可以运行以下命令（改编自[DebuggingProgramCrash](https://wiki.ubuntu.com/DebuggingProgramCrash)的[“Ubuntu 文档 wiki 贡献者”](https://help.ubuntu.com/community/License)，[第 2 节](https://wiki.ubuntu.com/DebuggingProgramCrash#Debug_Symbol_Packages)）：

```
echo "deb http://ddebs.ubuntu.com $(lsb_release -cs) main restricted universe multiverse
*deb http://ddebs.ubuntu.com $(lsb_release -cs)-updates main restricted universe multiverse
deb http://ddebs.ubuntu.com $(lsb_release -cs)-security main restricted universe multiverse
deb http://ddebs.ubuntu.com $(lsb_release -cs)-proposed main restricted universe multiverse*
" | sudo tee -a /etc/apt/sources.list.d/ddebs.list
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 428D7C01
sudo apt-get update
```

如果您使用的是开发版本（alpha 或 beta），请*忽略斜体行。*但是，如果您在稳定后继续使用该版本，请确保添加它们。

这些命令做了三件事：

1.  创建文件`/etc/apt/sources.list.d/ddebs.list`（其中包含 DEB 行）。
2.  导入这些存储库的签名密钥。
3.  更新您的系统信息，了解哪些软件包和版本可用于从何处安装。

因此，如果您想使用`-dbgsym`-provided 符号而不是`-dbg`提供的符号，则`-dbgsym`包`libwebkitgtk-3.0-0`是（根据上面的简单命名约定）`libwebkitgtk-3.0-0-dbgsym`。

您可以在同一系统上同时安装`-dbg`和包，*但如果它们为任何相同的文件提供符号，则不能*。所以又互相冲突；它们不能同时安装。`-dbgsym`*`libwebkitgtk-3.0-0-dbg``libwebkitgtk-3.0-0-dbgsym`*

 *##使用符号

在大多数类 Unix 操作系统上，调试器会自动查找已安装的符号。Ubuntu 也不例外——在 Ubuntu 中，会`gdb`自动在`/usr/lib/debug`. 所以你不需要做任何特别的事情。

但是，如果您确实需要告诉`gdb`加载特定的调试符号文件，您将使用该标志。有关详细信息，请参阅[GNU 手册](http://sourceware.org/gdb/current/onlinedocs/gdb/File-Options.html#File-Options)和[gdb(1)](http://manpages.ubuntu.com/manpages/precise/en/man1/gdb.1.html)。`-s *file*`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T19:43:05.990

1）当我需要挖掘通过包安装的库时，我要做的第一件事就是从源代码安装它。我的意思是配置/制作/制作安装。我通常将源代码放在 /usr/local/src 中并将其安装在 /usr/local 中。在我看来，这是运行您拥有源代码的确切代码的最可靠方法。

3)

> 如何使用我设法编译的调试版本？

这听起来像你做了我上面描述的事情。您需要做的是确保您的软件正在使用包含和链接目录，这些目录托管您的已编译、启用调试的库。这意味着确保设置了 -I/usr/local/include 和 -L /usr/local/lib 标志，并且它们位于 /usr/include 和 /usr/lib 之前。

通过从 ubuntu 安装中删除库的二进制版本，您可以更加确定，确保您构建和安装的版本是硬盘上唯一存在的版本。通过这种方式，您将确定您能够配置您的应用程序以使用该库。否则它只会失败，而不是你不断地想知道它是使用新库还是旧库。

2) 通常是的。但这取决于库是如何编写的，以及 ubuntu 打包器决定做什么。

使用本地构建的库编译程序后，请先查看是否遇到相同的错误。如果不是，那么这也是一个数据点。自从上次 ubuntu 打包库以来，问题可能已经解决了。也许库没有正确打包，这就是问题所在。您甚至可能会遇到新的错误，因为 ubuntu 打包程序以某种方式配置了库，以便它可以工作，而您没有做同样的事情。无论如何，你都会得到有趣的线索。

祝你好运

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-09T15:50:50.463

@Eliah 的回答告诉了如何以方便的方式获取符号。

问题仍然存在，*“我如何获得确切的源代码？”* .

我通常这样做`apt-get source <pkgname>`很好，除非我必须手动告诉 gdb`dir <path-to-wherever-I-put-the-source>`和 woe betide 如果它是像*eglibc*这样的包，必须弄清楚路径引用来自`nss`子目录，而不是根目录。

在 RHEL 上，例如`yum install --enable-repo rhel-debuginfo libX11-debuginfo`（仅`yum install libX11-debuginfo`在 CentOS 7 上），您可以立即在 gdb 中获得完整的符号和源代码，而无需额外的混乱。我仍在寻找 Ubuntu 上的便利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-09T11:53:15.343

为了针对动态库进行调试，您可以按照建议添加带有符号和源发行包的 dgb 齿轮。然后需要检查调试符号表的编译目录是否与安装源的路径匹配，如果不匹配，则应在gdb中映射路径。按照命令启用 glibc 的调试

```
$ objdump -g /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so | sed -n '/<.*>\s\+DW_AT_comp_dir/ {s/\s\+<.*>\s\+//; p;}' | sort | uniq
DW_AT_comp_dir : (indirect string, offset: 0x1127a): /build/glibc-OTsEL5/glibc-2.27/malloc
...
DW_AT_comp_dir : (indirect string, offset: 0xd139): /build/glibc-OTsEL5/glibc-2.27/stdio-common
DW_AT_comp_dir : (indirect string, offset: 0xef40): /build/glibc-OTsEL5/glibc-2.27/libio
$ ls -ld glibc-2.27/{stdio-common,libio}
drwxrwxr-x 3 fusillator fusillator 12288 feb 1 2018 glibc-2.27/libio
drwxrwxr-x 3 fusillator fusillator 4096 feb 1 2018 glibc-2.27/stdio-common
$ gdb ./hello
Reading symbols from ./hello...done.
(gdb) set substitute-path /build/glibc-OTsEL5/glibc-2.27 glibc-2.27
(gdb) b main
Breakpoint 1 at 0x63e: file hello.c, line 10.
(gdb) run
Starting program: hello
Breakpoint 1, main () at hello.c:10
10 printf("hello world\n");
(gdb) s
_IO_puts (str=0x5555555546e4 "hello world") at ioputs.c:33
33 {
(gdb) backtrace
#0 _IO_puts (str=0x5555555546e4 "hello world") at ioputs.c:33
#1 0x000055555555464a in main () at hello.c:10 
```*

# iphone - 支持 UIKit UIAppearance 协议的类的最终列表

> ID：14344660
> 
> 赞同：0
> 
> 时间：2013-01-15T18:43:48.450
> 
> 标签：iphone, ios, uikit, uiappearance

我正在寻找**支持该`UIAppearance`协议**的类的完整列表。我一直找不到。我愿意接受有关如何以编程方式生成这样一个列表的建议（我已经考虑过一点）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:59:33.393

这不是一个确定的或完整的列表，但当然在发布问题几分钟后（通过指向[此相关问题](https://stackoverflow.com/a/12742945/18961)的链接），我找到了这个网络链接：

[http://blog.mosheberman.com/list-of-classes-that-support-uiappearance-in-ios-5/](http://blog.mosheberman.com/list-of-classes-that-support-uiappearance-in-ios-5/)

海报使用 grep 命令 ( `grep -r UI_APPEARANCE_SELECTOR ./ > ~/Desktop/UI_APPEARANCE.txt`) 转储出方法原型中所有具有 UI_APPEARANCE_SELECTOR 的类。他们提出的清单如下：

*   UIActivityIndi​​catorView.h
*   UIBarButtonItem.h
*   UIBarItem.h
*   UINavigationBar.h
*   UIProgressView.h
*   UISearchBar.h
*   UISegmentedControl.h
*   UISlider.h
*   UISwitch.h
*   UITabBar.h
*   UITabBarItem.h
*   UIToolbar.h

当然，这不包括上面列出的那些子类的类。此外，海报提到`UIView`，它肯定实现了协议，但没有任何标有 的方法`UI_APPEARANCE_SELECTOR`。我想知道是否可以通过 grepping for 创建一个更完整的列表`UIAppearance`。

这是另一个相关问题：[iOS 5: Curious about UIAppearance](https://stackoverflow.com/questions/8257556/ios-5-curious-about-uiappearance/)

# word-wrap - gtkmm GtkTreeView 中的自动换行

> ID：14344666
> 
> 赞同：1
> 
> 时间：2013-01-15T18:44:15.003
> 
> 标签：word-wrap, gtkmm, gtktreeview

我正在`gtkmm-2.4`Linux 中使用 GUI 包编写程序。如何设置 TreeView 对象的文本列以在 C++ 中执行自动换行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:28:20.587

啊，GTK 的 CellRenderers 的奇怪而令人愉快的词。

```
#include <pangomm/layout.h>

// say we want to wrap the 3rd column in our treeview
int colNum = 3;
Gtk::CellRendererText* pCellRendererText = dynamic_cast<Gtk::CellRendererText*>(pTreeView->get_column_cell_renderer(colNum));
pCellRendererText->property_wrap_mode() = Pango::WRAP_WORD;
pCellRendererText->property_wrap_width() = 20; 
```

# c# - .NET Micro Framework 的扩展方法

> ID：14344668
> 
> 赞同：3
> 
> 时间：2013-01-15T18:44:22.363
> 
> 标签：c#, extension-methods, .net-micro-framework

.NET Micro Framework 似乎不支持/不支持扩展方法。

有没有办法让这个有用的语言功能发挥作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:44:22.363

当您将[`ExtensionAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.extensionattribute.aspx)类添加到您的项目时，您也可以在 .NET Micro Framework 中使用扩展方法。

```
namespace System.Runtime.CompilerServices
{
    [AttributeUsage(AttributeTargets.Assembly | AttributeTargets.Class | AttributeTargets.Method)]
    public sealed class ExtensionAttribute : Attribute { }
} 
```

# javascript - 用于媒体搜索的 Instagram API 意外令牌“：”

> ID：14344671
> 
> 赞同：1
> 
> 时间：2013-01-15T18:44:27.693
> 
> 标签：javascript, json, api, instagram

我试图显示一组在特定时间和给定纬度和经度内的图像。Instagram API 脚本在控制台日志中收到错误消息。这是错误：

> SyntaxError：意外的令牌'：'

这是代码：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

<script>

$(document).ready(function() {

      var count = "20";

      var access_token = "5567117.f59def8.65c6953a15e94932a44f9b4311aa8653";

      var access_parameters = {access_token:access_token};

      function grabImages(access_parameters) {

            var instagramUrl =  "https://api.instagram.com/v1/media/search?lat=54.963782&lng=-1.623423&max_timestamp=1354950000&min_timestamp=1354935600&distance=2000?callback=?&count=" + count;

            $.getJSON(instagramUrl, access_parameters, onDataLoaded);

            console.log(instagramUrl);

      }

      function onDataLoaded(instagram_data) {

          if(instagram_data.meta.code == 200) {

            var photos = instagram_data.data;

            if(photos.length > 0) {

              for (var key in photos) {
              var photo = photos[key];
              $("#target").append('<img src ="' + photo.images.thumbnail.url + '">');
              $("#target").append('<span>' + photo.user.username +'</span>');
              }

            } else {
              $("#target").append("Hmm.  I couldn’t find anything!");
            }

          } else {

              var error = data.meta.error_message;
              $("#target").append('Something happened, Instagram said: ' + error);
          }

          }

          grabImages(access_parameters);

  });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:49:59.187

`?`您的查询字符串在回调参数之前有一个额外的。

`"https://api.instagram.com/v1/media/search?lat=54.963782&lng=-1.623423&max_timestamp=1354950000&min_timestamp=1354935600&distance=2000?callback=?&count="`

应该

`"https://api.instagram.com/v1/media/search?lat=54.963782&lng=-1.623423&max_timestamp=1354950000&min_timestamp=1354935600&distance=2000&callback=?&count="`

# wpf - 是否有工具可以列出绑定到 XAML 文件中的属性？

> ID：14344674
> 
> 赞同：0
> 
> 时间：2013-01-15T18:44:39.213
> 
> 标签：wpf, xaml, data-binding, mvvm

我在 XAML 中创建了一个相当复杂的视图，并且正在使用该视图执行视图优先的 MVVM 实现。现在是时候开始着手处理 ViewModel 了。

是否有工具可以解析 XAML 并列出我需要实现的所有属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T21:58:59.610

可能是一个很长的镜头，但您可以运行该应用程序并从调试输出中获取绑定错误列表。

# javascript - 最终用户通过 javascript 扩展向网站提供网站图标

> ID：14344677
> 
> 赞同：2
> 
> 时间：2013-01-15T18:44:51.583
> 
> 标签：javascript, jquery, favicon, head

**想要：**一个我无法控制以显示图标的网站，以便我可以在我的书签工具栏中轻松找到它。

**问题：** Web 开发人员忘记在“elearning”子域上链接 favicon

**尝试和解：**创建了这个 javascript 扩展；在 Firefox Nightly 21.0a1 (2013-01-14) 上运行 Scriptish 0.1.8

```
// ==UserScript==
// @id             120398
// @name           AngelIco
// @version        1.0
// @namespace      
// @author         
// @description    
// @include        https://elearning.fgcu.edu/default.asp
// @run-at         document-start
// @require        http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js
// ==/UserScript==
$('head').append("<link rel=\"shortcut icon\" href=\"//fgcu.edu/favicon.ico\"/>");
$('head').append("<script>alert(\"Oh, it worked!!!!!\")</script>"); 
```

**脚本的预期行为：**将插入指向 favicon 的链接，并加载它。

**脚本的实际行为：** Firebug 表明指向 favicon 的链接已成功插入，并提示“哦，它成功了！！！！！”，但实际上并没有显示 favicon。

**尝试调试：**

1.  脚本加载时播放

    ```
    //@run-at document-start //document-idle //document-end 
    ```

2.  尝试从我的本地硬盘驱动器加载图标

    ```
    $('head').append("<link rel=\"shortcut icon\" href=\"file:///C:/Users/Tyler/Desktop/favicon.ico\"/>"); 
    ```

**请回复：（**按优先顺序）

1.  对我的用户脚本的修复。
2.  实现我想要的另一种方法。
3.  关于我必须做什么才能完成这项工作的模糊提示，然后是这个眨眼的脸“;-)”
4.  一种侮辱。
5.  没有反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:32:14.887

将运行线更改为

```
//@run-at document-end 
```

TryingToImprove 的建议奏效了。你可以在

```
//@include 
```

我在安全页面上运行脚本的行。我的链接必须指向“https://”而不是“http://”，并且那里不存在图标文件。不知道为什么我的本地参考不起作用；更改了 //@run-at 行后，我又回去测试了一遍，本地引用仍然不起作用。打败我。

# macos - R64/R GUI OS X 应用程序的 ctrl-r 历史搜索等效项

> ID：14344678
> 
> 赞同：0
> 
> 时间：2013-01-15T18:44:51.893
> 
> 标签：macos, r, bash

> **可能重复：**
> [检索变量声明](https://stackoverflow.com/questions/7352784/retrieving-variable-declaration)

我想要某种方法来搜索发送到 R 以进行运行会话的命令历史记录。这可以在 Bash 中使用 ctrl-r 历史搜索来完成，我发现它非常有用。

R GUI IDE 中是否有执行此操作的快捷键？我查看了更改日志并进行了一些谷歌搜索，但我找不到它。

如果没有，是否有在 R GUI IDE 之外提取此信息的方法？可能是通过搜索某种 .Rhistory 文件？

其他 R 用户如何访问命令历史记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:15:28.487

在 R GUI 中，有一个可发现的侧面板，它出现在屏幕空间最大的那一侧，并且历史条目以可点击的方式显示。该面板使用 shift-cmd-H 进行 kbd 切换，如果以这种方式打开，会将活动光标置于输入行中。该面板顶部的那一行接受正则表达式，它将显示的行限制为匹配的行。有单独的历史文件有点令人困惑（无论如何对我来说）。R.app 或 R64.app 等侧面板使用名为“.Rapp.history”的文件，而终端 R 会话将访问的常规历史文件具有其预期名称。

显示/隐藏切换的图标暴露在控制台的工具栏项目选择面板中，所以我怀疑它暴露给 AppleScript 命令。我不是 AppleScript 的大用户，最后一部分是预感而不是承诺。

MacOSX 常见问题解答说 R 将接受 Applescript 提供的 R 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T19:58:04.833

可用的快捷方式取决于您使用的界面。如果您在 Windows 上使用 r 终端（但不是 GUI），那么 ctrl-r 就像您描述的那样工作。

一种适用于所有界面的工具（虽然不是那么简单）是使用“历史”命令。Y 可以键入类似 history(pat='plot') 的内容，其中包含“plot”的最近命令将显示出来，您可以剪切和粘贴以重新运行感兴趣的命令。

# java - 从 ResultSet 中获取值挂起

> ID：14344683
> 
> 赞同：0
> 
> 时间：2013-01-15T18:45:09.400
> 
> 标签：java, sql, jdbc, odbc, resultset

我正在构建一个 Java 应用程序来查询远程 SQL 数据库。我可以阅读除其中一列之外的所有内容。当我尝试阅读该专栏时，我的应用程序会永远挂起，而不会引发任何异常或错误。有人知道为什么吗？这是所有细节：

*   我正在使用的驱动程序是`sun.jdbc.odbc.JdbcOdbcDriver`Java 版本 6 更新 35；
*   该列 (#214) 与其他列没有任何不同。为了确保，我做了以下 System.out：
    *   `System.out.println("\t" + resultset.getMetaData().getColumnName(i) + "\t" + resultset.getMetaData().getColumnDisplaySize(i) + "\t" + resultset.getMetaData().getColumnType(i) + "\t" + resultset.getMetaData().getColumnTypeName(214) + "\t" + resultset.getMetaData().getColumnClassName(i));`
    *   结果是：`214 WorkLog 65535 -1 LONGVARCHAR java.lang.String`
*   我尝试读取该值`resultset.getString(),resultset.getASCIIStream(),resultset.getCharacterStream()`但没有成功；

最后，这是代码：

```
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");  
con = DriverManager.getConnection("jdbc:odbc:AR");  
Statement stmt = con.createStatement();  
ResultSet rs = stmt.executeQuery("SELECT * FROM HPD:HelpDesk WHERE \"CaseID+\" = '000000008815267'");  
while (rs.next()) {  
    for (int i = 1;i<rs.getMetaData().getColumnCount();i++){  
        System.out.println(i + "\t" + rs.getMetaData().getColumnName(i) + "\t" + rs.getString(i));  
    }  
} 
```

编辑：尝试读取列时应用程序挂起。在这种情况下， rs.getString()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:58:02.243

longvarchar 基本上是一个 CLOB。据我了解，您需要使用流来阅读：

```
BufferedInputStream bufferedIn = new BufferedInputStream( rs.getBinaryStream( longvarcharColumnIndex ) );
ByteArrayOutputStream byteArrayOut = new ByteArrayOutputStream();

int index;
while ( ( int index = bufferedIn.read() ) != -1 )
{
    byteArrayOut.write( ( byte ) index );
}

bufferedIn.close();
byteArrayOut.close(); 
```

您没有说代码挂起的示例。它在 read() 上吗？它在可用（）上吗？您必须非常小心如何调用这些方法，否则当没有更多字节可供读取时，代码将冻结在 read() 状态。

# html - 为什么不是所有视频都在 Chrome 的页面上加载？

> ID：14344690
> 
> 赞同：-1
> 
> 时间：2013-01-15T18:45:31.873
> 
> 标签：html, video

[http://graysonearle.com/bluemen/](http://graysonearle.com/bluemen/) 使用 webkit 浏览器单击它。加载时应该会出现一个 4x4 的视频网格，但只有 1-3 个视频倾向于加载到 Chrome 上。在 Safari 上工作得很好，什么给了？它们是同一个视频。当我使用较小的视频进行此操作时，它运行良好，我想这可能与它有关。有什么方法可以强制加载页面上的多个视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:53:19.460

如果您为每个视频添加缓存破坏器后缀，它似乎可以正常工作。在 Chrome 上，它会做正确的事情并很快将第一帧加载为海报，但在 Safari 上，您需要明确选择海报

```
<!DOCTYPE html> 
<html> 
<head>
    <link rel="stylesheet" type="text/css" href="http://graysonearle.com/bluemen/css/reset.css">
    <link rel="stylesheet" type="text/css" href="http://graysonearle.com/bluemen/css/style.css">
</head>
<body> 
<script>
    for (var i=0;i<10;i++) {
        document.write('<div class="vidBox" id="box'+i+'">');
        document.write('    <video class="vid" preload="metadata" controls="true" id="vid'+i+'">');
        document.write('        <source src="http://graysonearle.com/bluemen/videos/fullvid.mp4?a='+i+'" type="video/mp4">');
        document.write('        <source src="http://graysonearle.com/bluemen/videos/red.webm" type="video/ogg">');
        document.write('    </video>');
        document.write('</div>');
    }
</script>
</body> 
</html> 
```

如果这不起作用（并且看起来浏览器缓冲区有时仍然会阻塞），那么您需要做的是一个一个加载视频源，触发 canplaythrough 事件的加载。

总而言之，它似乎不是很健壮，祝你好运

编辑

好的，这个版本更强大，但需要稍微整理一下......它通过异步 ajax 调用将视频作为 blob 抓取一次，然后将其作为源传递给每个视频元素......你会可能想要将海报加载到视频中并显示某种进度条，直到视频加载完毕。我不得不对我的测试视频做这个样本，因为我没有跨域权限，所以无法轻松地用你的大小视频进行测试......但试一试

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<link rel="stylesheet" type="text/css" href="http://graysonearle.com/bluemen/css/reset.css">
<link rel="stylesheet" type="text/css" href="http://graysonearle.com/bluemen/css/style.css">
<title></title>
</head>
<body>
<script type="text/javascript">
    for (var i=0;i<10;i++) {
        document.write('<div class="vidBox" id="box'+i+'">');
        document.write('    <video class="vid" preload="metadata" controls="true" id="vid'+i+'">');
        document.write('    <\/video>');
        document.write('<\/div>');
    }

var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://jcath-drg.s3.amazonaws.com/BigBuck.m4v', true);
xhr.responseType = 'blob';
xhr.onload = function(e) {
  if (this.status == 200) {
    console.log("got it");
    var myBlob = this.response;
    var vid = (window.webkitURL ? webkitURL : URL).createObjectURL(myBlob);
    // myBlob is now the blob that the object URL pointed to.
       for (var i=0;i<10;i++) {
        display(i,vid)
   }
  }
};
xhr.send();

       function display(i,vid){

    var video = document.getElementById("vid"+i);
    console.log(video);
    video.src = vid;

}
</script>
</body>
</html> 
```

# ios - 在 ios 中实现通过 twitter 登录

> ID：14344692
> 
> 赞同：0
> 
> 时间：2013-01-15T18:45:36.977
> 
> 标签：ios, objective-c

我想在我的应用程序中提供让用户通过 twitter 登录的功能。我花了 2 天时间阅读博客 dev.twitter.com .. 但我无处可去。任何人都可以帮助我..或者只是告诉我任何开源应用程序。那就是提供此功能..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:00:39.990

社交框架 (iOS6) 具有内置的 twitter 功能，可以为您节省一些时间。在 iOS5 中有一个（非常）类似的 Twitter 框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:11:44.590

如果您为 IOS 5 及更高版本开发，只需将 Twitter.framework 添加到您的目标。用户使用设置屏幕登录和注销 Twitter

`#import <Twitter/Twitter.h>`在你的类/视图控制器中。

然后在代码中的任何位置调用以下方法

```
if ([TWTweetComposeViewController canSendTweet])
    {
      //yes user is logged in
     }
else{
      //show tweeet login prompt to user to login
        TWTweetComposeViewController *viewController = [[TWTweetComposeViewController alloc] init];

        //hide the tweet screen
        viewController.view.hidden = YES;

        //fire tweetComposeView to show "No Twitter Accounts" alert view on iOS5.1
        viewController.completionHandler = ^(TWTweetComposeViewControllerResult result) {
            if (result == TWTweetComposeViewControllerResultCancelled) {
                [self dismissModalViewControllerAnimated:NO];
            }
        };
        [self presentModalViewController:viewController animated:NO];

        //hide the keyboard
        [viewController.view endEditing:YES];
} 
```

另请查看本教程：

[http://www.raywenderlich.com/21558/beginning-twitter-tutorial-updated-for-ios-6](http://www.raywenderlich.com/21558/beginning-twitter-tutorial-updated-for-ios-6)

[http://mobileorchard.com/ios-tutorial-twitter-integration-in-ios5/](http://mobileorchard.com/ios-tutorial-twitter-integration-in-ios5/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T18:47:51.620

您需要使用 OAuth。阅读 Ryan Boyd 的“OAuth 2.0 入门”

# c - 套接字错误：连接被拒绝 - 我做错了什么？

> ID：14344694
> 
> 赞同：11
> 
> 时间：2013-01-15T18:45:40.763
> 
> 标签：c, linux, sockets

我刚刚开始学习套接字（Linux）的基础知识。我尝试了一个小例子，但它不起作用，我不知道出了什么问题。

我收到“拒绝连接”错误消息。

* * *

这是我的代码：

```
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netinet/ip.h>
#include <stdio.h>
#include <string.h>
#include <errno.h>

int main() {
    int c;
    c = socket(AF_INET, SOCK_STREAM, 0);
    if (c < 0) {
        printf("Error in creating socket! %s\n", strerror(errno));
        return 1;
    }

    struct sockaddr_in server;
    memset(&server, 0, sizeof(server));
    server.sin_port = htons(1234);
    server.sin_family = AF_INET;
    server.sin_addr.s_addr = inet_addr("127.0.0.1"); //local host
    if (connect(c, (struct sockaddr *)&server, sizeof(server)) < 0) {
        // Here is my error
        printf("Error when connecting! %s\n",strerror(errno)); 
        return 1;
    }

    while(1) {
        char msg[100];
        printf("Give message: ");
        fgets(msg, sizeof(msg), stdin); 
        send(c, &msg, sizeof(msg), 0);
        char resp[100];
        recv(c, &resp, sizeof(resp), 0);
        printf("Received: %s\n", resp);
    }
close(c);
} 
```

**编辑**

当然 ！错误实际上是在服务器中。我只是觉得客户端发送消息很奇怪，所以我缩小了视野，甚至懒得回头看服务器。

**由于错误似乎也在我的服务器中，我最终可能会问另一个问题并将其链接到此处**

服务器正在监听 (12345) ...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-15T18:55:57.763

根据[手册页](http://linux.die.net/man/2/connect)：

> **ECONNREFUSED** 无人监听远程地址。

* * *

为了提供一个简单的远程端点来接受您的连接并发送回接收到的数据（回声服务器），您可以尝试类似这个[python 服务器](http://docs.python.org/2/library/socket.html#example)（或使用[netcat](http://linux.die.net/man/1/nc)）：

```
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind(("localhost", 1234))
s.listen(1)
conn, addr = s.accept()
print 'Connected by', addr
while 1:
    data = conn.recv(1024)
    if not data: break
    conn.sendall(data)
conn.close() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T19:02:49.383

你的答案是：你的程序是客户端，它需要一个服务器来连接。`nc`命令创建服务器，您的程序可以连接到它。

```
[root@mg0008 work]# nc -l 127.0.0.1 1234 &
[1] 25380
[root@mg0008 work]# ./socket
Give message: Hello
Hello 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T18:49:36.907

本地主机中可能没有服务器监听端口 1234

# java - Spring MVC @ExceptionHandler 未能捕获异常

> ID：14344698
> 
> 赞同：3
> 
> 时间：2013-01-15T18:45:46.577
> 
> 标签：java, spring-mvc, file-upload, exception-handling, multipartform-data

我正在使用*Spring MVC*接收与表单一起上传的文件。这是我的*控制器*，它接收请求并处理可​​能的异常：

```
@RequestMapping(method = RequestMethod.POST, 
                headers = {"content-type=multipart/form-data"}, 
                produces = "application/xml")
public @ResponseBody MyStuff processFormUpload( @RequestParam("file") CommonsMultipartFile file) throws 
    //return beautiful xml response generated from the input file;
}

@ExceptionHandler(Exception.class)
public ModelAndView exceptionHandler(Exception ex, HttpServletResponse response) {
    //return pretty exception page;
} 
```

这就是我初始化文件解析器的方式：

```
<bean id="multipartResolver"
      class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
    <property name="maxUploadSize" value="100000"/>
</bean> 
```

即使在生成响应时引发异常，一切都运行良好。唯一的问题是当有人尝试上传大于**maxUploadSize**的文件时。在这种情况下，exceptionHandler 不会捕获异常，并且服务返回一个丑陋的内部**错误 500**，由`MaxUploadSizeExceededException`.

如何配置我的 Web 应用程序以捕获这种异常？我想使用`@ExceptionHandlers`而不必过多地改变项目结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T21:37:54.240

据我了解，这些异常是在数据绑定期间引发的，在实际到达控制器之前，因此导致 500 并且没有调用异常处理程序方法。

到目前为止，我想出处理您提到的唯一方法是让控制器实现“HandlerExceptionResolver”并提供以下实现：

```
 public ModelAndView resolveException(HttpServletRequest request,
        HttpServletResponse response, Object handler, Exception exception) 
```

我同意，它不像@ExceptionHandler 那样优雅或灵活。希望这可以帮助。

# android - Android - Logcat 错误

> ID：14344699
> 
> 赞同：-2
> 
> 时间：2013-01-15T18:45:49.627
> 
> 标签：android, debugging, error-handling, android-logcat

我在应用程序的特定布局中遇到的这个错误是什么？

我有一个特定的布局（MonthlyComputation），当我进入这个布局时，它会导致应用程序崩溃..

```
11-15 21:39:03.105: ERROR/AndroidRuntime(1169): FATAL EXCEPTION: main
    java.lang.RuntimeException: Unable to start activity      ComponentInfo{com.ZecRepublic.ITax/com.ZecRepublic.ITax.MonthlyComputation}: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
    at android.app.ActivityThread.access$600(ActivityThread.java:130)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4745)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
    at dalvik.system.NativeStart.main(Native Method)
    Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
    at com.ZecRepublic.ITax.MonthlyComputation.onCreate(MonthlyComputation.java:49)
    at android.app.Activity.performCreate(Activity.java:5008)
    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
    ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:49:30.047

简单的。您正在尝试将 a`TextView`转换为`EditText`. 不要那样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T19:04:29.110

android.widget.TextView 无法转换为 android.widget.EditText

您正在尝试将 TextView 类型转换为 EditText。

```
 txtView = (EditText) findViewById(R.id.txtView1); 
```

改成

```
 txtView = (TextView) findViewById(R.id.txtView1); 
```

希望它清楚

# sql - 可序列化的隔离级别和未提交的插入

> ID：14344700
> 
> 赞同：1
> 
> 时间：2013-01-15T18:45:52.707
> 
> 标签：sql, sql-server-2008, concurrency, transactions, isolation-level

想象一下我有两笔交易

T1 - 以 READ_COMMITTED 隔离级别写入表的繁重数据处理作业，例如 Table1。T2 - 从具有 SERIALIZABLE 隔离级别的 Table1 读取数据的事务。

## 表 1 架构

autoincrement_id(INT) 数据(varchar)

## T1 (READ_COMMITTED)

插入表 1.. 插入表 1.. 插入表 1.. 插入表 1..

## T2（可序列化）

SELECT * FROM Table1 WHERE autoincrement_id > x; - 做一点事

如果 T2 在 T1 之前开始，它实际上会停止 T1（对吗？）

但是如果 T1 在 T2 之前开始并且在 T2 期间仍在进行中，那么 T2 是否会读取 T1 插入但未提交的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T08:50:57.857

> 如果 T2 在 T1 之前开始，它实际上会停止 T1（对吗？）

是，对的！

> 但是如果 T1 在 T2 之前开始并且在 T2 期间仍在进行中，那么 T2 是否会读取 T1 插入但未提交的数据？

不，T1 会真正停止 T2。所以 T2 等待 T1 要么被提交要么被回滚（至少在理论上......）。

# javascript - 在ajax事件之后查找元素

> ID：14344701
> 
> 赞同：0
> 
> 时间：2013-01-15T18:46:01.967
> 
> 标签：javascript, jquery, coffeescript

我正在开发一个允许用户喜欢一个项目（比如一个项目）的网站。该事件由 jQuery 和 AJAX 处理。item 数组包含相当多的项目，每个项目都有一个“爱”按钮。我决定通过将一个表单放在页面底部并远程提交来有效地减少页面上的表单数量。

所以每次用户点击love按钮时，保存item id的data属性就会被放入表单中，并提交表单。简单的东西。

但我发现数据响应有点复杂，因为我不知道如何找到要更新的项目的元素 ID。我不能只使用`this`或`event.target`因为它在不同的事件中。我也尝试将`event`参数携带到 中`submit event`，但没有奏效。

```
 $(".love_item").click (event) ->
    $(".love_item_item_id").val $(this).data 'id'
    $(".love_item_form").submit()
    $(this).hide(200)

  $("form.love_item_form").submit (evt) ->
     evt.preventDefault()
     $form = $ @
     $form.find(':submit').prop 'disabled', true
     $.post($form.attr('action'), $form.serializeArray(), type: 'json').done (data) ->
       $(event.target).parent().find(".item_info_box").html data 
```

最后一行，它说`event.target`的是据我所知。很明显，这个变量没有被携带，但我真的不知道该放什么来实现我的目标。另外，我知道我可以通过表单操作传递其他参数（换句话说，将它们发送到 rails 控制器并返回），但我宁愿不这样做。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:51:04.320

您根本不需要任意形式。像这样的东西会起作用：

示例标记（注意 data 属性）：

```
<a href="#" data-id="2" class="likeable">Item to like</a> 
```

jQuery：

```
$('a.likeable').on('click', function() {
    var $item = $(this);
    var id = $item.data('id');

    $.post('url/like/' + id, function() {
      // success
      // do something with $item here.
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:49:42.040

如果你有这样的元素：`<div id="foo" data-id="foo1234">Foo</div>`

您可以像这样在您的 ajax 帖子之后选择它，假设您仍然具有以下 ID `foo1234`：

```
$('[data-id="' + id  + '"]').doSomething(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:56:43.983

只需使用 jQuery 的 ajax 功能

```
$('.love_item').on('click', function(e) {

  $.ajax({
    type: 'POST',
    url: *insert url here*,
    data: 'id=' + e.currentTarget.data-id,
    success: function(response) {

      var element = e.currentTarget;

      // do whatever
    }
  })
}); 
```

# asp.net - PagedDataSource 未在后续页面中显示数据

> ID：14344705
> 
> 赞同：1
> 
> 时间：2013-01-15T18:46:25.353
> 
> 标签：asp.net, vb.net, datatable

它可能很小，但我还没有弄清楚为什么以下内容不能完全正常工作。用户第一次提交搜索时，搜索结果的第一页会正确显示。但是，当用户尝试使用“上一页”和“下一页”按钮进行导航时，中继器不会显示 DataTable 中的相应数据。

搜索.aspx

```
<asp:Repeater ID="rptSearchResults" runat="server" OnItemDataBound="rptSearchResults_ItemDataBound">
    <ItemTemplate>
        <div>
            <asp:Literal ID="ltlCustName" runat="server" />
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

搜索.aspx.vb

```
Public dtCustomers As DataTable = New DataTable()
Sub Page_Load(ByVal Sender As Object, ByVal E As EventArgs) Handles Me.Load
    ' Check to see if this is the first time postback-ing to itself.
    blnFirstPostBack = (Request.Form("firstpb") = "1")

    ' When the page first loads, show the search form with search options.
    If Not Page.IsPostBack Then
        Session("StoredDT") = Nothing
        ShowSearchForm()
    ' Once the form is submitted, show the search results.
    Else
        Response.Write("DEBUG: Get Data")
        If blnFirstPostBack Then
            GatherFormData()
            dtCustomers = BuildDT()
            Session("StoredDT") = dtCustomers
            BindData()
        ElseIf Not Session("StoredDT") Is Nothing Then
            dtCustomers = Session("StoredDT")
        End If
    End If
End Sub

Sub BindData()
    Response.Write("DEBUG: Bind Data")
    ' At this point, I've checked that the dtCustomers is showing the proper data (e.g., grabbing from session when appropriate).
    Dim objPDS As PagedDataSource = New PagedDataSource()
    objPDS.DataSource = dtCustomers.DefaultView
    objPDS.AllowPaging = True
    objPDS.PageSize = intNumPerPage
    ' I've checked that Me.ViewState("_CurrentPage") gets updated to the correct page.
    objPDS.CurrentPageIndex = Me.ViewState("_CurrentPage")
    rptSearchResults.DataSource = objPDS
    ' I'm not sure if the error is here but although the dtCustomers is the proper data, the PagedDataSource and the binding here doesn't seem to play nice.
    Call rptSearchResults.DataBind()
End Sub

' Subroutine called when the previous page button is pressed.
Sub GoToPrevPage()
    Response.Write("DEBUG: Prev Page")
    ' Set viewstate variable to the previous page.
    Me.ViewState("_CurrentPage") -= 1
    BindData()
End Sub

' Subroutine called when the next page button is pressed.
Sub GoToNextPage()
    Response.Write("DEBUG: Next Page")
    ' Set viewstate variable to the next page.
    Me.ViewState("_CurrentPage") += 1
    BindData()
End Sub

Protected Sub rptSearchResults_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rptSearchResults.ItemDataBound
    Dim item As RepeaterItem = e.Item
    Dim strCustName As String = ""
    If (item.ItemType = ListItemType.Item) Or (item.ItemType = ListItemType.AlternatingItem) Then
        strCustName = e.Item.DataItem("CustName")
        Dim ltlCustName As Literal = CType(e.Item.FindControl("ltlCustName"), Literal)
        ltlCustName.Text = strCustName
    End If
End Sub 
```

示例页面 1（显示正确的数据）：

```
DEBUG: Get Data
DEBUG: Bind Data
Laurence Clinton
John Doe
Sean King
Jane Smith 
```

示例页面 2（不显示正确的数据，但为缺失的数据显示了足够的空间）：

```
DEBUG: Get Data
DEBUG: Next Page
DEBUG: Bind Data
[no name showing here 5]
[no name showing here 6]
[no name showing here 7]
[no name showing here 8] 
```

请原谅缩写的代码，但实际代码很大，所以简化是为了更容易找到问题的核心。

如果其中有任何不清楚或是否需要更多代码，请告诉我。提前致谢！

**2013 年 2 月 19 日更新：**

所以在稍微摆弄一下代码之后，我认为错误发生在转发器子例程中。中继器内部的原始文字现在可以使用。出于某种原因，我认为它以前不起作用，但现在可以正常工作。问题是当我们在转发器子例程中使用自定义控件更进一步时。信息似乎没有传递到控件中。控件被正确调用是因为仅在控件中找到的支持 HTML 会正确输出，但我们尝试传递到控件中的客户信息不会进入控件内部。这是修改后的代码：

搜索.aspx

```
<asp:Repeater ID="rptSearchResults" runat="server" OnItemDataBound="rptSearchResults_ItemDataBound">
    <ItemTemplate>
        <div>
            <asp:Literal ID="ltlCustName" runat="server" />
            <Acme:CustInfo ID="AcmeCustInfo" runat="server" />
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

搜索.aspx.vb

```
Protected Sub rptSearchResults_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rptSearchResults.ItemDataBound
    Dim item As RepeaterItem = e.Item
    Dim strCustName As String = ""
    If (item.ItemType = ListItemType.Item) Or (item.ItemType = ListItemType.AlternatingItem) Then
        strCustName = e.Item.DataItem("CustName")

        ' This literal properly shows the customer name on subsequent pages so the customer name reaches this point properly.
        Dim ltlCustName As Literal = CType(e.Item.FindControl("ltlCustName"), Literal)
        ltlCustName.Text = strCustName

        ' This control gets called properly but strCustName doesn't 
        ' get passed into the control. The control works fine for the
        ' first page but subsequent pages do not work. Also, the 
        ' control works fine when PagedDataSource is not used.
        Dim AcmeCustInfo As CustInfo = CType(e.Item.FindControl("AcmeCustInfo"), CustInfo)
        AcmeCustInfo.CustName = strCustName
    End If
End Sub 
```

**根据安的要求**

这是 CustInfo 的代码。不用说，为了解决这个问题，已经去掉了很多绒毛，但是如果缺少任何有用的东西，请告诉我，我会相应地更新示例。

客户信息.ascx

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="CustInfo.ascx.vb" Inherits="CustInfo" %>

<div style="border: 1px solid black;">
    <asp:Literal ID="ltlCustName" runat="server" />
</div> 
```

客户信息.ascx.vb

```
Imports System
Imports System.Web
Imports System.Web.Security
Imports System.Web.UI
Imports System.Web.UI.WebControls
Imports System.Web.UI.HtmlControls
Imports System.Configuration
Imports System.Data
Imports System.Data.SqlClient
Imports System.IO
Imports System.Web.HttpUtility

Partial Class CustInfo
    Inherits System.Web.UI.UserControl

    Private _CustName As String = ""

    Public Property CustName() As String
        Get
            Return _CustName
        End Get
        Set(value As String)
            _CustName = value
        End Set
    End Property

    Public Sub Page_Load(ByVal Sender As Object, ByVal E As EventArgs) Handles Me.Load
        Dim ltlCustName As Literal = CType(FindControl("ltlCustName"), Literal)
        ltlCustName.Text = "<b>Name: " & CustName & "</b>"
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:12:31.130

我不是`PagedDataSource`专家，但我已经广泛使用了用户控件。

您正在子例程的`CustInfo`控件中设置文字的值。`Load`如果我没记错的话，那将在`CustInfo`创建控件时被调用。这会在`OnItemDataBound`被调用之前发生，所以 - 我*认为*- 在`Load`分配属性值之前，子例程将发生并且文字的值被设置（为空字符串）`CustName`。要解决此问题，请稍后尝试设置文字的值，例如在`PreRender`子例程中。

看起来您对每个回发都具有约束力，因此以下内容应该不是问题，但如果不是，这里有一些可能会影响您的事情：

1.  `ItemDataBound`仅当您重新绑定时才会运行。如果您为转发器打开了 ViewState，则控件将在回发时重新创建，并且`ItemCreated`会运行，但`ItemDataBound`不会。所以你永远不会重新设置你的`CustName`财产。这很重要，因为...
2.  ...您的`CustName`财产有一个变量作为后备存储：它没有保存在`ViewState`. 因此，当重新创建用户控件时，`CustName`您之前设置的属性将不再存在：您的文字内容将设置为空字符串，即该`CustName`属性的默认值。

这两个一起将给出您所描述的行为。但是，由于看起来您确实绑定了每个回发（最终），这可能不是问题。为了完整起见，我将其包括在内。

# .net - 调试修改程序集

> ID：14344707
> 
> 赞同：1
> 
> 时间：2013-01-15T18:46:36.510
> 
> 标签：.net, mono, mono.cecil

我使用 CECIL 修改了一个程序集，并将程序集及其 pdb 保存回磁盘。现在，有没有办法从这个修改后的程序集生成代码文件，即 c# 文件，并能够在运行时调试到该文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T04:03:57.913

将其加载到[ILSpy](http://ilspy.net/)中。从左侧面板中选择所需的组件。然后，从“文件”菜单中选择“保存代码”。这将导出 C# 源代码以及可在 Visual Studio 中打开以进行调试的 Visual Studio 项目。

# python - Python 启动应用程序在 1 个循环时暂停

> ID：14344710
> 
> 赞同：0
> 
> 时间：2013-01-15T18:46:56.913
> 
> 标签：python, subprocess, os.system

我的 Python 脚本中有以下 while 循环

```
while 1:   
    functionToGetXandY
    if x == z:
        os.system("google-chrome --start-maximized " + x)
        currentLink = latestLink

    if y == z:
         subprocess.call([vlc_path, "--fullscreen", z])

    time.sleep(1) 
```

每当通过脚本启动 Chrome 或 VLC 时，循环似乎都会停止 - 或者有时会等到打开的窗口关闭。我错过了什么？

注意：无限循环是故意的 - 脚本不断检查 XML 文件以执行命令（该部分有效）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:57:44.677

`subprocess.call`和都阻塞*调用*`os.system`。这意味着当您调用其中任何一个时，您的脚本会暂停，直到您调用的程序退出。

 *如果您希望您的 Python 脚本立即继续执行，您可能需要查看`subprocess.Popen`哪个是非阻塞的并且采用几乎相同的`subprocess.call`参数*

# c# - 在某些计算机上加载 SQLite 时出现 BadImageFormatException

> ID：14344717
> 
> 赞同：1
> 
> 时间：2013-01-15T18:47:09.623
> 
> 标签：c#, system.data.sqlite, badimageformatexception

我在 .NET 4.0 中创建了一个非常简单的控制台应用程序，它将作为计划任务运行。它查找在一定时间内未修改的本地文件，然后解析文件，将记录插入 MySQL 数据库，并将文件复制到网络。我正在使用本地 SQLite 数据库来跟踪哪些文件已被处理，但不幸的是，在第一次 SQLite 操作时，我在一个系统上遇到了问题：

```
System.BadImageFormatException: Could not load file or assembly 'System.Data.SQLite.dll' or one of its dependencies.  is not a valid Win32 application. (Exception from HRESULT: 0x800700C1) File name: 'System.Data.SQLite.dll'
at FileDatabase.CreateDatabaseAndTable()
at Program.Main(String[] args) 
```

此异常在一个系统上引发（Windows 7 x64 Home Premium 和 .NET 4.0 完整版），但不会在其他两个系统上引发（开发系统 + 另一个，都是 Windows 7 x64 Professional 和 .NET 4.0 完整版）。

通过浏览其他问题，我发现当程序以 64 位模式运行时可能会发生这种情况，因为 SQLite DLL 是 32 位版本。我检查的第一件事是 Visual Studio 配置管理器中的活动平台是 x86。我还使用 IL DASM 来验证输出 exe 是否为 32 位（.corflags 0x00000003 // ILONLY 32BITREQUIRED）。我更愿意将 32 位 SQLite DLL 和目标平台保留为 x86，这样我就不必为 32 位和 64 位计算机制作不同版本的应用程序。

我还读到，由于 DLL 文件损坏，可能会发生此异常，但由于它适用于某些计算机，我认为情况并非如此。

我在问题系统上尝试过的其他没有帮助的事情：

*   在 GAC 和 Windows 目录中搜索错误的 SQLite DLL，但没有找到。
*   关闭 AVG 防病毒软件。
*   直接运行 exe 而不是已发布的 ClickOnce 应用程序。
*   卸载并重新安装 ClickOnce 应用程序。

任何建议将不胜感激 - 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:09:20.150

从 system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki 安装完整的安装包似乎已经解决了这个问题 - 它一定是一些不存在的依赖项（可能在 Windows 7 Professional 中）但不是家？）。虽然这个解决方案对于大型部署来说并不完美，但我真的只需要在这台计算机上使用它。感谢 RoadBump 让我走上正确的道路。

# c++ - 从线程动态加载的 dll 调用类的成员函数

> ID：14344718
> 
> 赞同：0
> 
> 时间：2013-01-15T18:47:18.910
> 
> 标签：c++, visual-studio-2010, dll

我在 dll 中有一个类，它为它创建一个线程。从 dll 导出的函数应该调用类对象的成员函数。我将如何做到这一点？

我尝试将类的全局变量放在dll的.cpp文件中，然后使导出的函数调用该对象的成员函数，但没有用。

这是在 Visual Studio 2010 C++ 中，并且 dll 是显式链接的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:53:27.690

我阅读了[http://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL#CppMatureApproach](http://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL#CppMatureApproach)并想出了如何让它工作。

# c++ - 虚拟机中的视频？

> ID：14344732
> 
> 赞同：0
> 
> 时间：2013-01-15T18:47:59.813
> 
> 标签：c++, c, video, virtual-machine

我目前正在构建一个简单的虚拟机，我想知道如何使用视频。既然传统的控制台不能工作，那么 SDL 或 OpenGL 能工作吗？我如何能够控制每个像素的像素并围绕它创建视频内存？

# orm - 无法在 Ebean 中获取某些类型的嵌套对象

> ID：14344733
> 
> 赞同：3
> 
> 时间：2013-01-15T18:48:01.170
> 
> 标签：orm, playframework, nested, playframework-2.0, ebean

我正在尝试在 Ebean 中获取嵌套对象，但它不起作用。我得到`User`. 它有`Addresses`. 每个`Addresses`都有一个`House`. 但是`House`只有一个`id`。所有其他属性为空。我在[另一个论坛](https://groups.google.com/forum/#!msg/ebean/ImsaxdzJsDk/0mKpaExmxj4J)上读到，Ebean 中可能有一个错误，但它是从 2011 年开始的。有没有办法让它工作？

注意：地址和房屋有`OneToOne`关系。

注意：为简单起见，我省略了@Entity 和@Id。

```
public class User {
    @OneToMany
    public List<Address> addresses;

    public static Finder<String, User> find = new Finder(String.class, User.class);

    // This is my query
    public static Event find(Long id) {
        return find.fetch("addresses").fetch("addresses.house").where().eq("id", id).findUnique();
    }
}

public class Address {
    @OneToOne(cascade =  CascadeType.ALL, mappedBy = "address")
    public House house;
}

public class House {
    @OneToOne
    public Address address;
    public String somePropertyThatIsNullWhenIUseMyQuery;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T10:06:02.807

```
 Ebean.find(User.class).fetch("addresses.house", new FetchConfig().query()) 
```

为我工作。如果你仍然没有看到它，你可能想使用

```
 Address.getHouse().getSomeProperty() 
```

有时，当您只是将对象传递给 JSON fe 属性时，显示为 null :(

# reporting-services - 根据组的计数隐藏行

> ID：14344736
> 
> 赞同：1
> 
> 时间：2013-01-15T18:48:05.150
> 
> 标签：reporting-services, reportingservices-2005

我有一份年度报告（这是一个组），然后是其他一些字段和总计（还有其他不相关的组）。我在底部有一个 Grand Total Row。如果报告中有超过 1 年，我只想显示该行（否则它只会复制年份页脚）。

我不确定我可以用什么来做到这一点。我尝试了 CountDistinct，但这不在范围内。有没有办法计算组部分的数量（如 Group("Year").SectionCount) 之类的？

我正在使用 SSRS 2005。

# rally - Lookback API：查询空日期字段

> ID：14344739
> 
> 赞同：0
> 
> 时间：2013-01-15T18:48:15.783
> 
> 标签：rally, lookbackapi

我们的测试用例中有一个名为“退休日期”的日期字段，它允许我们在不删除测试用例的情况下退休。

我想知道有多少测试用例在特定日期没有退役。我如何参考没有条目的日期字段？我是否使用 null、空字符串或其他内容？我试过例如：

```
_Type: 'TestCase',
__At: '2012-11-01',
c_RetireDate: {$ne: null} 
```

但这似乎不起作用，也不是空字符串。我也对相反的情况感兴趣，但以下似乎不适用于所有未设置退休日期的情况：

```
_Type: 'TestCase',
__At: '2012-11-01',
c_RetireDate: null 
```

如何对空的自定义日期字段进行这些查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:01:55.247

好的，抱歉，上面的内容实际上工作正常——这是我程序中的一个错误。

# java - 间歇性丢失 Wicket 会话闪存消息

> ID：14344740
> 
> 赞同：0
> 
> 时间：2013-01-15T18:48:20.493
> 
> 标签：java, google-app-engine, wicket

我的 Apache Wicket Web 应用程序部署在 Google App Engine for Java (GAE/J) 上。

一个问题是，有时会话闪现消息在它应该出现的时候没有出现，或者它出现但为空。

例如，而不是预期的：

```
<ul class="feedbackPanel">
  <li class="feedbackPanelINFO">
    <span class="feedbackPanelINFO">Thanks for taking the trouble to log off.</span>
  </li>
</ul> 
```

我有时会得到

```
<ul class="feedbackPanel">
  <li class="feedbackPanelINFO">
    <span class="feedbackPanelINFO"></span>
  </li>
</ul> 
```

而是（当提交的信息性闪存消息字符串不为空时）。

此问题可能是由于未能正确解释用户的 Web 会话造成的。有没有其他人遇到过这个问题？

我的软件环境

*   阿帕奇检票口：6.5.0
*   GAE/J：1.7.4
*   爪哇：1.6.0_37

**更新**

我相信我已经隔离了这个问题的发生。仅当通过（自动）预热请求启动新的 GAE/J 实例以处理请求时，才会出现此问题，对此新预热的实例提供响应。

新预热的实例可能没有正确读取用户的 Wicket 会话对象，因此没有找到并呈现任何待处理的会话 flash 消息。

# c - 基于控制台时间的引擎

> ID：14344741
> 
> 赞同：0
> 
> 时间：2013-01-15T18:48:43.257
> 
> 标签：c, windows, function, console-application

我想为我的控制台应用程序制作“引擎”，它将计算经过的时间，并在经过一定时间后强制应用程序执行基于时间的事件。我考虑为教育目的创建一个简单的基于文本的策略游戏（不是为了家庭作业，只是为了我）。

我试图创建引擎，但我没有走得太远。我不知道如何应用基于时间的事件来中断应用程序中当前待处理的操作等，首先是我如何做到的：

```
#include <stdio.h>
#include <conio.h>
#include <Windows.h>
void _sleep(int t);
int main()
{
int seconds_passed = 0; //counts how much time passed since application started
while(1)
{
    //if(seconds_passed == 100) ... time based action
_sleep(1000);
printf("test");
seconds_passed += 1;
}

return 0;
}

void _sleep(int t) 
{ 
    int i;
    for (i = 0; i < (t/100); i++) 
    { 
        Sleep(100); 
    if (kbhit()!= 0)
        {
            getch();
            break; 
    }
    }
} 
```

我试图从 windows.h 中创建类似于 Sleep() 的功能，但能够在按下键时打破延迟（我不知道我是否走正确的方式） - 在循环中它将开始“时间流逝”，但我希望它独立于其余代码，因此它将静默工作并控制其余代码中的操作。我在以下任何事情上都需要帮助：

- 使用键盘中断 _sleep() 函数不应自动增加“经过的秒数”

-如何使计时器独立于代码中发生的动作？我考虑过创建一些可以每秒破坏整个 while(1) 循环的东西（可能是我修改后的 _sleep 函数），增加计数器并返回它破坏的代码部分（它会滥用 scanf() 应用程序中的操作但现在不是问题）

-我听说 select() 函数可能在这里有用，有人对此有任何经验，可以告诉我更多信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:01:41.593

不知道这是否是一个可用的答案，但是当我构建一个简单的游戏时，我以这种方式使其成为多线程：

1.  当用户做某事时，事件线程会将消息推送到线程安全的消息队列中。
2.  “游戏”线程读取消息队列，处理数据，将输出渲染到屏幕上，然后休眠一段时间。

通过这种方式，事件线程可以保持阻塞，直到用户输入发生，而游戏逻辑和输入/输出以简单的同步方式完成。Windows 有一个你可以使用的线程库（虽然我还没有使用过那个，因为我总是在 linux 上使用 boost 线程或 posix 线程。）

# django - 将模板标签与 Django 评分一起使用

> ID：14344747
> 
> 赞同：0
> 
> 时间：2013-01-15T18:49:07.143
> 
> 标签：django, rating-system, templatetags

我正在使用 dcramer 的[djangoratings](https://github.com/dcramer/django-ratings)尝试实施评级系统，但在使用他提到的一些模板标签时遇到问题。

我的模型是：

```
class Thing(models.Model):
    rating = RatingField(range=3) 
```

我正在尝试使用包中包含的模板标签来获得用户的投票，如下所述：

> **rating_by_request**
> 
> 检索用户对特定对象的投票并将其存储在上下文变量中。如果用户没有投票，上下文变量将为 0：
> 
> {% rating_by_request 对 instance.field 的请求作为投票 %}
> 
> **rating_by_user**
> 
> 检索用户对特定对象的投票并将其存储在上下文变量中。如果用户没有投票，上下文变量将为 0：
> 
> {% rating_by_user user on instance.field as vote %}

但可能使用不当，

```
{% rating_by_user user on Thing.rating as vote %}
{{ vote }}
{% rating_by_request request on Thing.rating as rate %}
{{ rate }} 
```

.. 因为`{{ vote }}`并且`{{ rate }}`不返回任何值。如何使用这些标签来获取所描述的对象？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:02:42.763

您是在视图上下文`thing`还是`Thing`变量中设置？如果在视野中`'thing': Thing.objects.get(...)`

```
{% rating_by_user user on thing.rating as vote %}
{{ vote }}
{% rating_by_request request on thing.rating as rate %}
{{ rate }} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T19:41:40.873

{{}} 此标签用于显示信息。如果您想从用户那里获取信息，您应该尝试类似 .html 文件中的内容

```
<form action="address of your view" method="get">
{%csrf_token%}
<input type="text" name="vote"/ >
<input type="submit" value="ok">
</form> 
```

在你看来

```
vote_val=request.GET.get('vote','default_value') 
```

现在投票存储在 vote_val

# git - 多个本地用户的 Github 帐户密钥

> ID：14344749
> 
> 赞同：0
> 
> 时间：2013-01-15T18:49:21.993
> 
> 标签：git, github

当我在不同的开发人员帐户下发布应用程序时，我在计算机上创建了第二个用户帐户，因为我知道这在证书密钥方面更可取。

但是，现在当我希望在我的第二个帐户的应用程序中使用 Github 实现源代码控制时，我遇到了困难，我怀疑是因为 SSH 密钥是使用我的普通帐户生成的。

有没有其他人遇到过这种情况，建议？我应该创建另一个 SSH 密钥还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:56:03.887

您应该为每台计算机的每个用户创建一个 ssh 密钥。您可以轻松地将多个密钥添加到您的 github 帐户。

只需`ssh-keygen`按照提示操作，然后`cat ~/.ssh/id_rsa.pub`在 SSH 密钥下的帐户首选项页面上将结果复制到 github。

如果您不知道文件的位置，请输入`~/.ssh/id_rsa`您的私钥和`~/.ssh/id_rsa.pub`公钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:56:12.820

您可以将多个密钥与您的 Github 帐户关联，如果我理解您的问题，这是一种方法（计算机上的每个用户一个密钥）。您还可以在两个帐户之间共享一个私钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:15:19.687

我认为最好将原始密钥对复制到第二个帐户，如果两个帐户都打算用作“单一身份”。如果您稍后开始将 ssh 密钥身份验证用于其他目的（其他主机，ssh 到您的其他工作机器），如果您不需要将多个不同的密钥导入所有机器而只需一个密钥，那么它会更简单。

请参阅[是否可以在 2 台机器上使用相同的 ssh 私钥/公钥对来访问 git 存储库？](https://stackoverflow.com/q/1162676/1967931)

# org-mode - 在非交互式 org-todo 中设置日志消息？

> ID：14344752
> 
> 赞同：0
> 
> 时间：2013-01-15T18:49:27.987
> 
> 标签：org-mode

在 Emacs 23.3.1 中，我有一个 org 文件，其中包含（除其他外） state `CANCELED(c@)`。我想遍历一个子树（可以正常工作`org-map-entries`），然后根据用户输入将状态设置`CANCELED`为记录的注释`Reason`。

如果我调用`(org-todo "CANCELED")`，则项目的状态设置正确，但我留下了一个`*Org Note*`缓冲区，因为我的循环继续进行，所以该缓冲区被忽略。

如何以非交互方式设置日志注释？如果不可能，是否有更好的替代方案`(progn (switch-to-buffer "*Org Note*") (insert "Reason") (org-ctrl-c-ctrl-c))`（这也不起作用:-)）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:38:21.170

我发现`advice`'ing`org-todo`工作量太大，因为笔记记录器非常集成到整体框架中，并且受[Worg](http://orgmode.org/worg/org-hacks.html#sec-1-6-2)的启发选择了更传统的键盘宏方法：

`(kmacro-exec-ring-item (quote ("\C-c\C-tcReason\C-c\C-c" 0 "%d")) nil)`

# python - Python 类变量

> ID：14344756
> 
> 赞同：0
> 
> 时间：2013-01-15T18:49:38.627
> 
> 标签：python

> **可能重复：**
> [Python 变量声明](https://stackoverflow.com/questions/11007627/python-variable-declaration)

我是 python 新手，我想知道如何将适当的“空”变量放入类中。

例如，在 C++ 中，我可以放置如下变量：

```
public class employee{
private:
int ID;
string name;
public:
.....
} 
```

在python中，如何设置名称和id而不给它们值？是不是像：

```
class employee:
__name__
__id__
... 
```

另外，是否可以为每个变量设置数据类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:55:34.813

确实，您不能真正做到这一点，但您可以这样做：

```
class FooBar:
    def __init__(self):
        self.whatever = None 
```

此外，无需在 Python 中声明数据类型。这就是动态语言的全部意义所在！

不要用 C++ 口音编写 python。按照设计的方式编写python，你会更快乐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:51:50.737

你不能。

> python中没有空变量的概念，它们必须初始化为某种东西。而且也没有数据类型的概念。在 python 中，变量名只是指向对象的符号（尽管对象有类型）。

```
In [37]: x=2      #x refers to an integer

In [38]: x="foo"  #now x refers to a string object 
```

最接近空变量的是使用`None`or `Ellipsis`（仅限 py 3x）

```
In [5]: x=None

In [6]: x

In [7]: x=...        # Ellipsis , py 3.x only

In [8]: x
Out[8]: Ellipsis 
```

但又`None`是`Ellipsis`对象本身。

# c# - 使用 foreach 对类中定义的每个字段（相同类型）执行操作？

> ID：14344761
> 
> 赞同：0
> 
> 时间：2013-01-15T18:49:53.150
> 
> 标签：c#, foreach

例如，是否可以使用 foreach 语句对类中的每个字符串执行操作？

```
foreach (string s in <class>) 
```

就像我可以将它与 AppSettings 一起使用？

```
foreach (string key in ConfigurationManager.AppSettings) 
```

如果不可能，还有其他类似的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:01:23.897

您可以使用命名空间`System.Reflection`和`System.Linq`

```
foreach (var pi in typeof(<YourClass>).GetProperties().Where(p => p.PropertyType.Equals(typeof(string))))
{
    pi.SetValue(targetObject, value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:53:51.987

[`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)将遍历任何实现`IEnumerable`或的类`IEnumerable<T>`。所以是的，如果你的类实现`IEnumerable`并且可以返回一个字符串集合，那么你可以使用`foreach`.

请记住，其中的字符串`ConfigurationManager.AppSettings`不是*属性*。没有内置的方法来枚举类的属性。[`Type.GetProperties`](http://msdn.microsoft.com/en-us/library/system.type.getproperties.aspx)一种方法是使用查找给定类型的任何属性（在您的示例中为“字符串”）来迭代类属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T18:54:13.377

如果给定的类实现`IEnumerable`或`IEnumerable<T>`(在您的情况下)`T`是可能的。`string`请参阅[如何：使用 foreach 访问集合类（C# 编程指南）](http://msdn.microsoft.com/en-us/library/9yb8xew9%28v=vs.80%29.aspx)和[如何：为通用列表创建迭代器块（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ee5kxzk0%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T18:55:34.620

[`foreach`](http://msdn.microsoft.com/en-us/library/vstudio/ttw7t8t6.aspx)迭代任何实现[`IEnumerable`](http://msdn.microsoft.com/en-us/library/vstudio/system.collections.ienumerable.aspx)或[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/vstudio/9eekhta0.aspx)接口。因此，如果您的类实现这些接口之一是可能的。

[`ConfigurationManager.AppSetting`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx)是一个属性。它重视类型是[`NameValueCollection`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection.aspx)类。它继承自[`NameObjectCollectionBase`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.nameobjectcollectionbase.aspx)类。并`NameObjectCollectionBase`实现`IEnumerable`接口。

看看这些；

*   [知道值时如何从应用程序设置文件中读取密钥？](https://stackoverflow.com/questions/6330570/how-to-read-a-key-from-app-setting-file-when-value-is-know)
*   [通过配置管理器从 AppSettings 中获取 StringCollection](https://stackoverflow.com/questions/1235784/getting-a-stringcollection-out-of-appsettings-through-the-configuration-manager)
*   [如何使 C# 类在 foreach 语句中可用](http://support.microsoft.com/kb/322022/en-us)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T19:15:07.953

```
 public  class TestClass {
        public string String1 { get; set; }
        public string String2 { get; set; }
        public int Int1 { get; set; }

        public TestClass() {
            String1 = "Frank";
            String2 = "Borland";
            foreach (var item in this.GetType().GetProperties().Where(p => p.PropertyType.Equals(typeof(string)))) {
                string value = item.GetValue(this, null) as string;
                Debug.WriteLine("String: {0} Value: {1}", item.Name, value);
            }
        }
    } 
```

打印出类实例字符串的名称和值。

# c# - ApplicationCommands.Delete.Execute()

> ID：14344769
> 
> 赞同：-2
> 
> 时间：2013-01-15T18:50:11.087
> 
> 标签：c#, .net, wpf

我想执行这样的删除命令：

```
ApplicationCommands.Delete.Execute(Keyboard.FocusedElement, Keyboard.FocusedElement); 
```

但：

```
ApplicationCommands.Delete.CanExecute(Keyboard.FocusedElement, Keyboard.FocusedElement) 
```

是假的，所以它不会被执行。

我怎样才能将其更改为真实？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:27:59.630

我相信您需要设置[`CommandBinding`](http://msdn.microsoft.com/en-us/library/system.windows.input.commandbinding)s 来指定调用 Execute 和 CanExecute 函数时会发生什么。

这是一个例子：

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.Delete"
                        Executed="DeleteCommandHandler"
                        CanExecute="DeleteCanExecuteHandler" />
    </Window.CommandBindings>
    <StackPanel Name="MainStackPanel">
        <Button Command="ApplicationCommands.Delete" 
                Content="Delete File" />
    </StackPanel>
</Window> 
```

该示例来自[CommandBinding](http://msdn.microsoft.com/en-us/library/system.windows.input.commandbinding)文档（稍作修改）。

# facebook - Facebook FQL 查询在某些情况下不返回结果

> ID：14344771
> 
> 赞同：1
> 
> 时间：2013-01-15T18:50:20.853
> 
> 标签：facebook, facebook-graph-api, facebook-fql, facebook-page

我正在尝试获取某些页面的总粉丝数。

为此，我使用以下 HTTP 获取例如页面 id:462790137094807 [https://graph.facebook.com/fql?q=select+fan_count+from+page+where+page_id%3D462790137094807](https://graph.facebook.com/fql?q=select+fan_count+from+page+where+page_id%3D462790137094807)

但是，对于某些页面 id，例如：378009835566560 虽然页面有一些粉丝，但我得到一个空结果。 [https://graph.facebook.com/fql?q=select+fan_count+from+page+where+page_id%3D378009835566560](https://graph.facebook.com/fql?q=select+fan_count+from+page+where+page_id%3D378009835566560) 或另一个例子： [https ://graph.facebook.com/fql?q=select+fan_count+from +page+where+page_id%3D149294551780718](https://graph.facebook.com/fql?q=select+fan_count+from+page+where+page_id%3D149294551780718)

为什么 Facebook 不返回正确的值？我有什么遗漏或做错了吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:48:36.313

该页面`378009835566560`具有对其施加的用户限制。它要么阻止来自某些国家或某些年龄的用户。我可以在美国看到，所以我猜这是年龄限制。

除非您使用符合页面所有者标准的用户访问令牌进行身份验证，否则您无法获取该页面的数据。

要对此进行测试，请尝试从您未登录 Facebook 的浏览器访问[http://facebook.com/378009835566560 。](http://facebook.com/378009835566560)您将收到“未找到”错误。从登录的浏览器访问，您将看到该页面（如果您符合条件）。

# javascript - 将所有输入字段更改为蓝色

> ID：14344772
> 
> 赞同：1
> 
> 时间：2013-01-15T18:50:24.390
> 
> 标签：javascript, jquery, jquery-selectors

我的 Jquery 代码应该将表单边框的所有输入字段转换为蓝色.. 但它没有这样做......我到底哪里出错了？

```
<html>

    <head>
        <title>Form</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script>
        <script type="text/javascript">
            $(function () {
                alert('Works !');
                $('#provision:text').css('border', '2px solid blue');
            });
        </script>
    </head>

    <body>
        <form id="provision">ESNList:
            <input type="text" id="ESNList" name="ESNList" size="30" />
            <br />ESN Start:
            <input type="text" id="ESNStart" name="ESNStart" size="10" />
            <br />ESN End:
            <input type="text" id="ESNStart" name="ESNStart" size="10" />
            <br />UnitName:
            <input type="text" id="STxName" name="STxName" size="30" />
            <br />Unit Model:
            <select name="STxName">
                <option value="stx2">STX2</option>
                <option value="protopak">Protopak</option>
                <option value="stm3" selected>STM3</option>
                <option value="acutec">Acutec</option>
                <option value="mmt">MMT</option>
                <option value="smartone">Trackpack</option>
                <option value="smartoneb">SmartOneB</option>
                <option value="audi">Acutec</option>
            </select>
            <br />RTU Model Type:
            <select name="rtumodel">
                <option value="globalstar">GlobalStar</option>
                <option value="both">Both</option>
                <option value="comtech">Comtech</option>
                <option value="stmcomtech">STMComtech</option>
            </select>
            <br />
            <input type="submit" value="submit" />
        </form>
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:51:37.967

您需要实际查询这些`<input>`节点：

```
$('#provision input:text').css('border','2px solid blue');}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:54:59.337

您只需要在选择器中有一个空格：

```
#provision :text 
```

正如所写，它要求元素本身是文本输入，而*不是*`#provision`搜索. 空格在选择器中很重要！*`#provision`*

 *但是，您应该注意这[`:text`是一个 jQuery 扩展](http://api.jquery.com/text-selector/)，因此不如原生选择器快。

因此，更好的选择器是：

```
$('#provision input[type="text"]') 
```

或者，为了确保您捕获没有显式`text`类型的节点（但默认为`text`）：

```
$('#provision input').filter(':text') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:52:29.637

```
$('#provision input:text').css('border', '2px solid blue'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T18:54:29.890

这应该工作 - 看到它工作 [http://jsfiddle.net/LumF3/](http://jsfiddle.net/LumF3/)

```
 <script type="text/javascript">
                $(function () {
                    alert('Works !');
                    $('#provision input:text').css('border', '2px solid blue');
                });
 </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T19:06:05.577

在您的情况下，这是正确的 JQuery 文本选择器：

`$('#provision input:text').css('border', '2px solid blue');`

文本选择器的官方 API 文档：http: [//api.jquery.com/text-selector/](http://api.jquery.com/text-selector/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-15T18:51:47.060

试试`$('#provision input')`吧。您正在尝试将边框样式应用于 #provisions 元素内的文本节点。*

# c# - 检查初始化的数组是否为空

> ID：14344775
> 
> 赞同：0
> 
> 时间：2013-01-15T18:50:35.783
> 
> 标签：c#, asp.net-mvc

我有一个控制器操作，我验证是否在字段中输入了任何值。这是我的做法：

```
[HttpPost]
        public ActionResult ValidateFields(string Desc, string Status, string Name )
        {
            string[] fields = new string[3];

            if (string.IsNullOrEmpty(Desc))
                fields[0] = "#Desc";

            if (string.IsNullOrEmpty(Status))
                fields[1] = "#Status";

            if (string.IsNullOrEmpty(Name))
                fields[2] = "#Name ";

// Check if the initialized array "fields" has any items in it.
            if (fields != null)
            { return content("Please enter valid values for " + fields); }

            return content("Validation Successful");
        } 
```

此处数组“字段”已初始化，因此其长度永远不会为 0。此外，检查 null 不起作用。我所能做的就是遍历数组并检查它是否有任何项目。

有没有更好的方法来检查数组中是否有任何项目或只有空值？

另外，如果有比我做的更好的验证字段的方法，请告诉我。我希望它是可维护的，如果明天我添加新字段，我想花尽可能少的时间来验证它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:52:31.857

你为什么不使用 a`List<string>`代替？这将允许您添加每个字段，然后您可以检查列表的长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:54:41.907

使用列表。

```
 [HttpPost]
    public ActionResult ValidateFields(string Desc, string Status, string Name )
    {
        List<string> fields = new List<string>();

        if (string.IsNullOrEmpty(Desc))
            fields.Add("#Desc");

        if (string.IsNullOrEmpty(Status))
            fields.Add("#Status");

        if (string.IsNullOrEmpty(Name))
            fields.Add("#Name");

        // Check if the list "fields" has any items in it.
        if (fields.Any()) {
             return content("Please enter valid values for " + string.Join(", ", fields)); 
        }

        return content("Validation Successful");
    } 
```

更新

另一种可能更好且更易于维护的验证方法是创建一个模型类，并添加验证属性。见[这里](http://www.asp.net/mvc/tutorials/older-versions/models-%28data%29/validation-with-the-data-annotation-validators-cs)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T18:57:48.560

我相信你可以做到：

```
if (fields.Any(f => !string.IsNullOrEmpty(f))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T18:55:35.330

您也可以为数组执行此操作。只需调用：

```
fields.Any(i => i != null) 
```

您还可以通过使用内置的 ASP.NET MVC 验证机制来改进您的验证。

# c# - Visifire 图表回调

> ID：14344776
> 
> 赞同：0
> 
> 时间：2013-01-15T18:50:37.450
> 
> 标签：c#, .net, prism, visifire

我想知道是否有办法在 visifire 图表完成渲染时获得回调。我一直在尝试创建一个图表并将其保存为图像。这适用于按下按钮，但如果我没有按钮则不起作用。我的猜测是因为图表没有完成加载，但我不太确定。当页面被加载时，我设置了在我的 XAML 中使用的 ObservableCollection 值。

我基本上有一些看起来像这样的数据系列：

```
<vc:Chart.Series>
            <vc:DataSeries RenderAs="StackedColumn" LegendText="Portion sequenced" LightingEnabled="False" AxisYType="Primary" Color="#4198AF" DataSource="{Binding SequencedValues}">
                <vc:DataSeries.DataMappings>
                    <vc:DataMapping  MemberName="AxisXLabel" Path="Key"></vc:DataMapping>
                    <vc:DataMapping MemberName="YValue" Path="Value"></vc:DataMapping>
                </vc:DataSeries.DataMappings> 
```

这些由 ObservableCollection 填充。所以我首先调用我的方法 DrawImage() 来设置 observablecollection 值，然后调用 Save()。就像我说的，Save() 方法可以通过按下按钮自行工作，但如果我在绘制图像后调用它，则不会。我认为它最初与尚未完成加载的页面有关。但是使用

```
<i:Interaction.Triggers>
    <i:EventTrigger EventName="Loaded">
        <i:InvokeCommandAction Command="{Binding PageLoadCommand}" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

我只在页面加载时调用 DrawImage() 和 Save()。我什至尝试在 DrawImage() 和 Save() 之间设置一个 5 秒的睡眠定时器，以查看是否存在计时问题，我仍然只能获得背景图像，但我的 DataSeries 没有。

所以我的问题是是否有办法在 Visifire 图表加载后被回调，或者我是否缺少另一个解决方案。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:49:00.373

水晶，

如果您正在使用 Silveright，那么您只能通过按下按钮等用户操作来保存图像，但如果您正在使用 WPF，则可以在图表完全呈现后立即保存图表。但是，如果您想在填充集合后立即保存图表，那么您可以在延迟一段时间后执行 Save() 方法（使用计时器）。请检查下面的代码。

```
MyChart.Series[0].DataSource = collection; //Populate Data 
timer.Tick += new EventHandler(timer_Tick);
timer.Interval = new TimeSpan(0, 0, 0, 0, 3000);// give some delay
timer.Start();

void timer_Tick1(object sender, EventArgs e)
{
  ExportToImage(new Uri("d:/visifire1.png"), MyChart);
} 
```

# java - Java 中引用的概念问题

> ID：14344779
> 
> 赞同：1
> 
> 时间：2013-01-15T18:50:51.423
> 
> 标签：java, reference

我在 java 中遇到了一个概念性的问题。这是我的基本实现`LinkedList`：

**节点：**

```
class Node {
  int data;
  Node next = null;

  public Node(int data) {
    this.data = data;   
  } 
} 
```

**名单：**

```
class LinkedList {  
  Node n = null;
  Node start = null;
  int flag = 0;

  void insertion(int x) {
    if(flag==0)
    {   
      Node newnode = new Node(x);
      n = newnode;
      start = newnode;
      flag = 1;
      return;
    }

    Node newnode = new Node(x);
    n.next = newnode;
    n = n.next;
  }

  void deletion() {
    Node str = start;
    while(str.next.next != null)
      str = str.next;
    str.next = null;        
  }

  void printlist() {
    Node str = start;
    while(str != null) {
      System.out.println(str.data);
      str = str.next;
    }
  }
} 
```

**测试类：**

```
public class Test31 {
  public static void main(String[] args){
    LinkedList ll = new LinkedList();
    ll.insertion(5); 
    ll.insertion(15);
    ll.insertion(25);
    ll.insertion(35);
    ll.insertion(45);
    ll.insertion(55);
    ll.deletion();ll.deletion();
    ll.printlist();
  }
} 
```

上面的程序工作得很好，没有任何问题，但是如果我`deletion()`用这段代码替换：

```
void deletion() {
  Node str = start;
  while(str.next != null)
    str = str.next;
  str = null;       
} 
```

然后不会删除元素。我有兴趣知道为什么会这样。使用`str.next.next`确实有诀窍，但如果我使用上面给出的删除方法，它不应该只用一次 while 循环迭代就能达到同样的效果吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:00:29.803

This is because one of the `str.next` objects still has a reference to it (or potentially `start` is referencing it). By setting `str` to null, you are simply setting the local variable in that method to `null`, but by setting `str.next` to null, you are deleting the reference in that `str` object.

Simple example:

```
Node start = new Node();
Node another = new Node();
start.next = another;
Node toDelete = another; 
```

If you do this:

```
toDelete = null; 
```

In this case, `toDelete` is now `null`. `start.next` and `another` still contain references to the object `another` was originally assigned to. Even if you append this:

```
another = null; 
```

In this case, there's still one reference left. `start.next` still points to the original object that `another` was initially assigned to.

I think the first deletion method is actually incorrect too, as it will never delete the starting node and will throw a `NullPointerException` if you only have one node in it since `start.next` is `null` and the while loop is attempting to get to `start.next.next`. I think this is more accurate:

```
void deletion() {
    Node parent = null;
    Node current = start;
    while (current.next != null) {
        parent = current;
        current = current.next;
    }
    if (parent == null) {
        start = null;
        flag = 0;
    } else {
        parent.next = null;
        n = parent;
    }    
} 
```

# javascript - 选择第一个元素

> ID：14344783
> 
> 赞同：0
> 
> 时间：2013-01-15T18:51:03.620
> 
> 标签：javascript, jquery

我正在尝试实现一个导航菜单，其中包含一个 UL > LI 块：

```
<aside id="nav-container" role="complementary" style="width: 232px;">
  <nav class="overview" id="primary-nav" role="nav" style="display: block;">
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>The Basics</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">Introduction</a></li>
      <li><a href="#" class="nav-link">A Chapter in the Zeitgeist Movement</a></li>
      <li><a href="#" class="nav-link">Getting Real with expectations</a></li>
      <li><a href="#" class="nav-link">Point of Focus in a chapter</a></li>
    </ul>
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>Setting up a National Chapter</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">Gathering Volunteers &amp; Social Media</a></li>
      <li><a href="#" class="nav-link">Establishing a Website &amp; Tools</a></li>
      <li><a href="#" class="nav-link">Organising a Core Group</a></li>
      <li><a href="#" class="nav-link">Expanding into Regional Chapters</a></li>
    </ul>
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>Setting up a city or local Chapter</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">Introduction</a></li>
      <li><a href="#" class="nav-link">Getting Started</a></li>
      <li><a href="#" class="nav-link">Raising Volunteers</a></li>
      <li><a href="#" class="nav-link">Organising a Core Group</a></li>
    </ul>
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>Organising Events</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">Types of Events</a></li>
      <li><a href="#" class="nav-link">Finding a Space</a></li>
      <li><a href="#" class="nav-link">Gathering Materials</a></li>
      <li><a href="#" class="nav-link">Promoting the Event</a></li>
      <li><a href="#" class="nav-link">Executing the Event</a></li>
    </ul>
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>Organising Project Teams</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">“Your idea, your project” concept</a></li>
      <li><a href="#" class="nav-link">Guidelines</a></li>
      <li><a href="#" class="nav-link">Project Methodology</a></li>
      <li><a href="#" class="nav-link">Devising a Project Structure</a></li>
      <li><a href="#" class="nav-link">Organising Volunteers </a></li>
    </ul>
    <h3 class="section">
      <span class="menu-toggle"></span>
      <span>Appendix</span>
    </h3>
    <ul class="depth-1 shortcuts" style="display: none;">
      <li><a href="#" class="nav-link">Tips from Coordinators</a></li>
      <li><a href="#" class="nav-link">Tips on DVDs</a></li>
    </ul>
  </nav>
</aside> 
```

最初所有的都是关闭的，当我点击一个h3时，ul列表变成了

我有这个 javascript 代码：

```
 // menu open close
  this.leftMenuToggle = function () {
    var leftMenuToggle = $( ".section" ).on( "click", function( event ) {
      event.preventDefault();
      leftMenuToggle.toggleClass("active");
      leftMenuToggle.next().css('display', 'block');
      console.log('we clicked this menu item');
    });
  } 
```

但它会打开所有 .section 项目，更改我的代码的正确方法是什么，以便如果我点击...它只打开子 ul 列表？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:53:53.930

“this”指的是 jQuery 处理程序中的单击/当前元素。

```
$( ".section" ).on( "click", function( event ) {
  event.preventDefault();
  $(this).toggleClass("active").next("ul").css('display', 'block');
  console.log('we clicked this menu item');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:54:28.273

通过以下方式，您可以从列表中删除硬编码样式，当您单击链接时，列表会切换。

Javascript

```
$('#nav-container').on('click', '.section', function(e) {
    e.preventDefault();

    var $shortcut = $(this).next();
    $('#nav-container ul.active').not($shortcut).removeClass('active');
    $shortcut.andSelf().toggleClass('active');
}); 
```

CSS

```
ul.active {
    display: block;
}

ul:not(.active) {
  display: none;
} 
```

[**演示**](http://jsfiddle.net/ricardolohmann/PzM4D/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:00:31.987

你可以这样做：

```
 $('#nav-container .overview h3.section').on("click", function(event){
      event.preventDefault();
      $(this).toggleClass("active");

      $(this).next('#nav-container .overview ul.depth-1 shortcuts')..css('display', 'block');
 } 
```

为什么起作用：因为 $(this) 引用当前单击的元素，而在您的代码中：

```
 var leftMenuToggle 
```

引用 jquery 选择器的结果，即所有部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:00:42.740

取而代之的是：

```
leftMenuToggle.toggleClass("active");
leftMenuToggle.next().css('display', 'block'); 
```

做这个：

```
$(this).toggleClass("active").next().css('display', 'block'); 
```

或者：

```
$(this).toggleClass("active");
$('.active').next().css('display', 'block'); 
```

# c - 链表-插入函数

> ID：14344787
> 
> 赞同：0
> 
> 时间：2013-01-15T18:51:10.313
> 
> 标签：c, linked-list

大家好，

我尝试用链表准备一个学生信息系统。我创建了一个名为 course 的 scturct。用于插入过程；我将在函数 main 中调用 void insertCourse(CourseNodePtr* cr, char* code)。当我编译时，我看到了这些错误；“insertCourse”的 arg 2 的类型不兼容。函数“insertCourse”的参数太少。有人评论这个问题吗？非常感谢..

```
/* Function Prototypes */
void insertCourse(CourseNodePtr* cr, char* code);

/* Main func starts here */

int main(void)
Course course_code; 

switch (choice) {
             case 1: 
                  insertCourse(&startPtr, course_code);
                  break;

/* Insert course function  */
void insertCourse(CourseNodePtr* cr, char* code)
{
CourseNodePtr newPtr;   /* New node pointer */
CourseNodePtr previousPtr;   /* previous node pointer in list */
CourseNodePtr currentPtr;    /* current node pointer in list */

newPtr = malloc( sizeof(Course) );   /* memory allocation for new node */

if (newPtr != NULL) {
           printf("Pls enter the code number of the course.\n");
           scanf("%s", &(newPtr->code));
           printf("Pls enter the course name.\n"); 
           scanf("%s", &(newPtr->name));
           printf("Pls enter the instructor name.\n"); 
           scanf("%s", &(newPtr->instructor));
           printf("Pls enter the term; Spring or Fall.\n"); 
           scanf("%s", &(newPtr->term));
           printf("Pls enter the year.\n"); 
           scanf("%s", &(newPtr->year));
           newPtr->coursePtr = NULL; 

           previousPtr = NULL; 
           currentPtr = *cr; 

           while ((currentPtr != NULL)  && ( code  > currentPtr->code)) {
                 previousPtr = currentPtr; 
                 currentPtr = currentPtr->coursePtr; 
           }  /* End While */

           if ( previousPtr == NULL ) {
                newPtr->coursePtr = *cr; 
                *cr = newPtr; 
           }   /* End if */
           else {
                previousPtr->coursePtr = newPtr; 
                newPtr->coursePtr = currentPtr; 
           }  /* End else */
    } /* End if */

    else {
         printf( " %c could not be inserted. Memory not enough...\n", code); 
    }  /* End else */
} /* End function insert */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:54:45.397

你定义`course_code`为`Course`

```
Course course_code; 
```

并调用`insertCourse()`

```
insertCourse(&startPtr, course_code); 
```

但它的论点必须是`CourseNodePtr*`和`char*`

```
void insertCourse(CourseNodePtr* cr, char* code) 
```

您传递的第二个参数类型不正确。肯定是`Course`

```
void insertCourse(CourseNodePtr* cr, Course code) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:55:50.893

insertCourse 的第二个参数需要类型`*char`并且您正在传递类型`Course`

```
insertCourse(&startPtr, course_code);
------------------------^ here 
```

# gis - 相交并包含空间数据库中所有内容的“无限大”几何

> ID：14344795
> 
> 赞同：0
> 
> 时间：2013-01-15T18:51:40.800
> 
> 标签：gis, postgis, oracle-spatial, jts

我有一个可以相互包含区域的数据库表，从而形成树/森林结构。每个区域都有一个父指针，顶层区域有一个父指针`null`。

我想改变这一点，所以有一个顶级区域，其中包含简化查询的所有内容。然后我不需要处理顶级区域的特殊情况，因为区域总是有父级。

有没有办法（在 PostGIS 和 Oracle Spatial 中）插入一个具有“无限大”几何形状的区域，以便始终通过相交查询找到它？

具体来说，我想要一个几何，无论 G 是什么，以下都是正确的：

```
ROOT contains G = true
ROOT intersects G = true
ROOT overlaps G = false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:07:05.910

我还没有遇到任何实现这个概念的东西，但你可以（粗略地）用触发器实现它；这样每次插入新行时，顶级父级都会将新形状合并到自身中。

这个（或任何类似的方法）的可能问题是你的表现不会很好。当然，Oracle 不能很好地处理复杂几何图形的操作，而且您可能会扭曲您的域索引。

您还会发现，在 Oracle 中，sdo_geometry 对象存在纵坐标限制。从 Oracle 文档（[http://docs.oracle.com/cd/B28359_01/appdev.111/b28400/sdo_objrelschema.htm#i1004087](http://docs.oracle.com/cd/B28359_01/appdev.111/b28400/sdo_objrelschema.htm#i1004087)）：

> 因为最大 SDO_ORDINATE_ARRAY 大小为 1,048,576 个数字，所以 SDO_GEOMETRY 对象中的最大顶点数取决于每个顶点的维数：二维为 524,288，三维为 349,525，四维为 262,144。

如果您稍微简化父形状，这应该不是问题。

我会说保留你的特殊外壳可能比走这条路更好。

# java - linux上的Java NIO“没有这样的设备”异常，但在使用FileUtils时有效

> ID：14344799
> 
> 赞同：0
> 
> 时间：2013-01-15T18:52:01.163
> 
> 标签：java, nio

我正进入（状态

```
java.io.IOException: No such device
    at sun.nio.ch.FileChannelImpl.map0(Native Method) 
```

在 linux 上使用它时（但在 windows 上可以正常工作）：

```
 destination.transferFrom(source, 0, source.size()); 
```

但如果我这样做，它会起作用：

```
FileUtils.copyFile(processedFile,outputFile); 
```

源是另一台 (Windows) 机器上的共享文件夹。当它在 Windows 机器上运行时也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:06:23.033

我假设它`FileUtils`来自 Jakarta Commons IO，在这种情况下，它是一个完全不同的实现，所以它们之间没有相关性。

`FileChannel.transferFrom()`尝试对指定文件的部分进行内存映射，并且根据错误消息，问题似乎是整个文件无法进行内存映射。我猜你的 Linux 机器运行 32 位，而 Windows 机器运行 64 位。

第二种选择：查看手册页`mmap`，当“指定文件的底层文件系统不支持内存映射”时抛出此异常。你是如何在 Linux 上挂载文件系统的？如果您要挂载 Samba 文件系统，我可以理解为什么它无法被映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T13:38:00.520

我刚刚看到完全相同的问题。检查您的共享是否在没有`directio`选项的情况下安装在 Linux 上。就我而言，重新安装而不`directio`立即解决此错误。此选项禁用缓存，但也禁用 mmap() 系统功能。

执行`mount`共享时，不要指定`-o directio`. 还要检查`/etc/fstab`文件是否未指定`directio`您的共享。

# haskell - 树的代数数据类型

> ID：14344803
> 
> 赞同：0
> 
> 时间：2013-01-15T18:52:11.493
> 
> 标签：haskell, tree, algebraic-data-types

我正在尝试构建一棵树，其子项在列表中表示。每个孩子自己都可能是子树等。所以我走这条路——

```
data Children a = NoChildren | Cons a (Children a) deriving (Show, Read, Ord, Eq)
data Tree a = EmptyTree | Node a (Children a) deriving (Show, Read, Ord, Eq) 
```

现在我尝试创建这样的树

```
let subtree1 = Node 67 NoChildren
let subtree2 = Node 86 NoChildren
let tree1 = Node 83 (subtree1 `Cons` (subtree2 `Cons` NoChildren)) 
```

它工作正常，直到 subtree2。未创建 tree1。抛出的错误是这样的 -

```
<interactive>:96:15:
    No instance for (Num (Tree Integer))
      arising from the literal `83'
    Possible fix: add an instance declaration for (Num (Tree Integer))
    In the first argument of `Node', namely `83'
    In the expression: Node 81 (subtree1 `Cons` (subtree2 `Cons` NoChildren))
    In an equation for `tree1':
      tree1 = Node 81 (subtree1 `Cons` (subtree2 `Cons` NoChildren)) 
```

我根本不明白这个错误错误。为什么抱怨 83 是文字。subtree1 和 subtree2 也有文字，它们很好......

**我通过执行以下操作解决了问题**

```
data Tree a = EmptyTree | Node a [Tree a] deriving (Show, Read, Ord, Eq)

flatten [] = []
flatten x:xs = x ++ flatten xs

preorder EmptyTree = []
preorder (Node a []) = [a]
preorder (Node a children) = [a] ++ flatten (map preorder children) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T18:58:05.253

```
data Children a = NoChildren | Cons a (Children a) 
```

表示您`Children a`与 同构`[a]`，因此您的

```
data Tree a = EmptyTree | Node a (Children a) 
```

同构于

```
data List a = Empty | Nonempty a [a] 
```

这又同构于`[a]`.

你想要的是孩子们自己是`Tree`s，所以你应该使用

```
data Children a = NoChildren | Cons (Tree a) (Children a) 
```

或平原

```
data Tree a = EmptyTree | Node a [Tree a] 
```

错误是因为某些属于（同上）的`subtree1`类型。然后当你写`Tree a``a``Num``subtree2`

```
tree1 = Node 83 (subtree1 `Cons` (subtree2 `Cons` NoChildren)) 
```

的推断类型`tree1`是`Tree (Tree a)`（对于某些`a`属于`Num`），因此

```
83 :: Tree a 
```

但是没有s 的`Num`实例`Tree`。

# sql-server - “WHERE x IN (SELECT value FROM table)”对于大表会不会低效？

> ID：14344804
> 
> 赞同：1
> 
> 时间：2013-01-15T18:52:16.477
> 
> 标签：sql-server, sql-server-2012, where-in

以下两个 SQL 查询返回相同的结果：

```
 SELECT * FROM Table1
    WHERE Table1.Value1 = 'something' OR Table1.Value2 IN (SELECT Value2 FROM Table2)

    SELECT * FROM Table1
    LEFT JOIN Table2 
    ON Table1.Value2 = Table2.Value2
    WHERE (Table1.Value1 = 'something' OR Table2.Value2 IS NOT NULL) 
```

同样，这两个查询返回相同的结果：

```
 SELECT * FROM Table1
    WHERE Table1.Value1 = 'something' AND Table1.Value2 NOT IN (SELECT Value2 FROM Table2)

    SELECT * FROM Table1
    LEFT JOIN Table2
    ON Table1.Value2 = Table2.Value2
    WHERE Table1.Value1 = 'something' AND Table2.Value2 IS NULL 
```

就个人而言，我发现使用“IN”或“NOT IN”的选项更容易阅读（特别是因为我的实际查询中已经有一堆连接）。但是，如果 Table2 中的值越来越多（目前只返回三个结果），这个查询会不会变得低效？或者查询优化器会在幕后把它找出来并把它变成一个连接吗？我正在使用 SQL Server 2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:07:19.030

第一个会更好：

```
SELECT <cols> 
  FROM dbo.Table1
  WHERE Value1 = 'something' 
  OR EXISTS (SELECT 1 FROM dbo.Table2 WHERE Value2 = Table1.Value2); 
```

尽管您的性能问题 - 假设 Value2 在两个位置都被索引并且您实际上只选择您需要的列而不是使用 * 强制扫描或查找 - 将是 OR。如果 Value1 被正确索引，您可能会考虑这种替代方案，至少可以测试性能差异（您需要查看计划，而不仅仅是测量时间，而您只有三行）：

```
SELECT <cols>
  FROM dbo.Table1 
  WHERE Value1 = 'something'
UNION ALL
SELECT <cols>
  FROM dbo.Table1
  WHERE Value1 <> 'something'
  AND EXISTS (SELECT 1 FROM dbo.Table2 WHERE Value2 = Table1.Value2); 
```

对于 NOT IN 查询，这将更可靠且至少与您提供的两个选项一样有效：

```
SELECT <cols>
  FROM dbo.Table1
  WHERE Value1 = 'something' 
  AND NOT EXISTS (SELECT 1 FROM dbo.Table2 WHERE Value2 = Table1.Value2); 
```

索引在这里将是关键，但重要的是要了解 NOT IN 和 LEFT OUTER JOIN 可能会让您陷入困境。请参阅以下文章：

[http://www.sqlperformance.com/2012/12/t-sql-queries/left-anti-semi-join](http://www.sqlperformance.com/2012/12/t-sql-queries/left-anti-semi-join)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:43:48.453

*   这 2 个查询不等效：当使用 IN（或 NOT IN）时，对于 Table1 中的每一行，您将获得 0 或 1 个结果行。使用 join 时，每一行可能出现 0 次、1 次或多次。所以，“两个 SQL 查询返回相同的结果”——只是因为特定的数据。或 Table2 在 Value2 上具有唯一索引/PK

*   使用 UNION 作为

> ```
> SELECT ... WHERE Table1.Value1 = 'something'
> UNION (ALL)
> SELECT ... WHERE Table1.Value2 = Table2.Value2 
> ```

也可能会给出不同的结果，因为 UNION 将删除重复项（这可能很有价值），如果 UNION ALL 与两个条件都匹配，它们可能会加倍一些结果行

*   如果您将在第一个查询中使用 EXISTS() 而不是 IN() ......很可能您将获得相同的执行计划，因为 sql 优化器将识别这些操作是相等的并且将选择相同的最佳方式。

*   即使您可以在语句中使用子查询，sql 优化器也可能会以不使用子查询的方式重建计划。换句话说，两个相同的查询，以不同的方式编写，很可能会针对相同的计划进行优化。

*   对于非常复杂的查询可能无法正常工作，因为 sql 可能没有足够的时间来完整地完成优化，并在它停止的地方停止。在这种情况下，这种不同但相似的查询可能会产生不同的结果。你需要尝试和测试。

计划和性能将取决于数据、参数类型（常量、变量、计算值）、统计数据、索引……对于这些标准的某些组合，Query-1 将比 Query-2 更优化，反之亦然其他。

要获得正确答案，您需要分析和比较执行计划

# c# - 菜单控件和 System.InvalidOperationException：集合已修改

> ID：14344805
> 
> 赞同：1
> 
> 时间：2013-01-15T18:52:17.277
> 
> 标签：c#, asp.net

一天几次，我的 Web 窗体应用程序会抛出以下异常。该应用程序有一个包含菜单的母版页。例外是：

```
01/10/13 23:57:10.481 ERROR 79 LonelyCache.Global - Exception occurred: 
System.Web.HttpUnhandledException (0x80004005): Exception of type 'System.Web.HttpUnhandledException' was thrown. ---> System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.Web.UI.WebControls.MenuItemCollection.MenuItemCollectionEnumerator.MoveNext()
   at System.Web.UI.WebControls.Menu.MenuRendererStandards.RenderItems(HtmlTextWriter writer, Boolean staticOnly, MenuItemCollection items, Int32 level, Boolean needsAccessKey)
   at System.Web.UI.WebControls.Menu.MenuRendererStandards.RenderContents(HtmlTextWriter writer, Boolean staticOnly)
   at System.Web.UI.WebControls.Menu.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.HtmlControls.HtmlForm.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.HtmlControls.HtmlContainerControl.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Page.Render(HtmlTextWriter writer)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.geocacherpage_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\9b853d2b\87164de6\App_Web_qxpnvss5.10.cs:line 0
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

母版页上的菜单是唯一的菜单，所以我认为异常必须与它相关联。

异常意味着菜单在迭代时被更改。我唯一更改菜单的代码是清除菜单，然后在加载母版页时构建它。至少这是我的理解。

这是一个间歇性问题。也就是说，它每天只在生产现场发生几次。我看到有时菜单没有正确显示（某些项目丢失）。我认为这是发生此异常的结果。

有没有人对可能导致这种情况发生的原因有任何想法？

以下是我拥有的与菜单关联的所有代码。

从 Site.Master 文件：

```
<div class="menuSide">
    <asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal" />
</div> 
```

从 Site.Master.cs 文件：

```
public partial class SiteMaster : System.Web.UI.MasterPage
{
    private static readonly ILog log = LogManager.GetLogger(typeof(SiteMaster));

    public class NavMenu
    {
        private readonly bool anonymous;
        private readonly string role;
        private readonly MenuItem menuItem;

        public NavMenu(bool anon, string rol, MenuItem item)
        {
            anonymous = anon; role = rol; menuItem = item;
        }

        public bool Anonymous { get { return anonymous; } }
        public string Role { get { return role; } }
        public MenuItem Item { get { return menuItem; } }
    }

    static readonly NavMenu[] menu =
    {
        new NavMenu(true, null, new MenuItem("HOME", "", "", "~/")),
        new NavMenu(false, null, new MenuItem("PROFILE", "", "", "~/Account/Profile.aspx")),
        new NavMenu(true, null, new MenuItem("FORUM", "", "", "~/forum")),
        new NavMenu(true, null, new MenuItem("ABOUT", "", "", "~/About.aspx")),
        new NavMenu(false, "Administrators", new MenuItem("ADMIN", "", "", "~/Admin/Admin.aspx")),
    };

    private void buildMenu()
    {
        NavigationMenu.Items.Clear();

        foreach (var item in menu)
        {
            if (item.Anonymous ||
                (HttpContext.Current.User.Identity.IsAuthenticated &&
                 (item.Role == null || HttpContext.Current.User.IsInRole(item.Role))))
            {
                NavigationMenu.Items.Add(item.Item);
            }
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        buildMenu();
        // More stuff follows...
    }
} 
```

# spring - 如何从 spring-data mongodb 扩展 SimpleMongoRepository？

> ID：14344809
> 
> 赞同：5
> 
> 时间：2013-01-15T18:52:29.617
> 
> 标签：spring, mongodb, static, spring-data, spring-data-mongodb

我正在尝试创建一个可以由所有 DAO 扩展的 BaseDAO 接口。该项目使用带有 mongodb 的 spring-data。问题是，如果我让所有单独的 DAO 扩展 MongoRepository 并且不编写实现类，那么一切正常。但是，如果我尝试使用泛型将 MongoRepository 添加到 BaseDAO 接口，该应用程序将不再工作，因为实例化 SimpleMongoRepository 所需的参数为空。这是我到目前为止的代码：

**BaseDAO.java**

```
import com.test.mongodb.BaseEntity;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.repository.NoRepositoryBean;

import java.io.Serializable;

@NoRepositoryBean
public interface BaseDAO<T extends BaseEntity, ID extends Serializable> extends         MongoRepository<T, ID> {
    public T getTestObject(ID id);
} 
```

**BaseDAOImpl.java**

```
import com.test.mongodb.BaseEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.repository.query.EntityInformationCreator;
import org.springframework.data.mongodb.repository.query.MongoEntityInformation;
import org.springframework.data.mongodb.repository.support.SimpleMongoRepository;
import org.springframework.data.repository.NoRepositoryBean;

import java.io.Serializable;

@NoRepositoryBean
public class BaseDAOImpl<T extends BaseEntity, ID extends Serializable> extends     SimpleMongoRepository<T,
        ID> implements BaseDAO<T, ID> {

    @Autowired
    private static MongoTemplate mongoTemplate;

    @Autowired
    private static EntityInformationCreator entityInformationCreator;

    public BaseDAOImpl(Class<T> type){
        super((MongoEntityInformation<T, ID>)     entityInformationCreator.getEntityInformation(type), mongoTemplate);
    }

    @Override
    public T getTestObject(ID id){
        return findOne(id);
    }
} 
```

**用户DAO.java**

```
import com.test.mongodb.User;
import org.springframework.stereotype.Repository;

@Repository
public interface UserDAO extends BaseDAO<User, String> {} 
```

**UserDAOImpl.java**

```
import com.test.mongodb.User;
import org.springframework.stereotype.Repository;

@Repository
public class UserDAOImpl extends BaseDAOImpl<User, String> implements UserDAO {

    public UserDAOImpl(){
        super(User.class);
    }
} 
```

**应用程序上下文.xml**

```
 <?xml version="1.0" encoding="UTF-8"?><beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xmlns:mongo="http://www.springframework.org/schema/data/mongo"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
    http://www.springframework.org/schema/data/mongo http://www.springframework.org/schema/data/mongo/spring-mongo-1.1.xsd">

    <!-- MongoFactoryBean instance -->
    <mongo:mongo host="localhost" port="27017" />

    <mongo:db-factory dbname="bank" mongo-ref="mongo" />

    <!-- MongoTemplate instance -->
    <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg name="mongoDbFactory" ref="mongoDbFactory" />
    </bean>

    <bean id="mappingContext" class="org.springframework.data.mongodb.core.mapping.MongoMappingContext" />

    <bean id="entityInformationCreator" class="org.springframework.data.mongodb.repository.support.DefaultEntityInformationCreator">
        <constructor-arg name="mappingContext" ref="mappingContext" />
    </bean>
    <mongo:repositories base-package="com.test.mongodb.repo"/>
</beans> 
```

**应用程序.java**

```
public class App {

    public static void main(String[] args) {
        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");

        UserRepository userRepository = context.getBean("userRepository", UserRepository.class);

        User user = new User("Test User");

        userRepository.save(user);

        String id = user.getId();
        System.out.println(id);

        System.out.println(userRepository.getTestObject(user.getId()));
    }
} 
```

所以当我运行它时，我在 BaseDAOImpl 中得到一个 NPE，因为 mongoTemplate 和 entityInformationCreator 都是空的。我如何加载它们？我还查看了 Spring MongoDB 参考文档，但它主要说要遵循其他类型存储库的文档。我在网上和其他地方唯一能找到的就是创建一个工厂 bean。所以我也尝试过：

**MongoRepoFactoryBean.java**

```
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.support.MongoRepositoryFactory;
import org.springframework.data.mongodb.repository.support.MongoRepositoryFactoryBean;
import org.springframework.data.repository.NoRepositoryBean;
import org.springframework.data.repository.core.support.RepositoryFactorySupport;

import java.io.Serializable;

@NoRepositoryBean
public class MongoRepoFactoryBean<T extends MongoRepository<?,?>, ID extends
    Serializable> extends MongoRepositoryFactoryBean {

    protected RepositoryFactorySupport createRepositoryFactory(Class<T> clazz, MongoTemplate mongoTemplate) {
        return new MongoRepoFactory(clazz, mongoTemplate);
    }

    private static class MongoRepoFactory extends MongoRepositoryFactory {
        private Class clazz;
        private MongoTemplate mongoTemplate;

        public MongoRepoFactory(Class clazz, MongoTemplate mongoTemplate) {
            super(mongoTemplate);
            this.mongoTemplate = mongoTemplate;
            this.clazz = clazz;
        }

        public Object getTargetRepository() {
            return new BaseDAOImpl(clazz);
        }

        public Class<?> getRepositoryBaseClass() {
            return BaseDAOImpl.class;
        }
    }
} 
```

并将 applicationContext.xml 更改为：

```
<mongo:repositories base-package="com.test.mongodb.repo"
                    factory-class="com.test.mongodb.repo.MongoRepoFactoryBean"/> 
```

但这也行不通。我也尝试过使用 JavaConfig，但是在使用注释进行配置时，我不知道如何设置工厂类。我究竟做错了什么？SimpleMongoRepository 没有默认构造函数。注入静态字段有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:17:42.787

参考文档已过时，不反映 spring-data-mongodb 1.1.1.RELEASE 上的更改。

我和你有同样的问题，这就是我如何解决它。

请注意，我同时使用了 MongoConfig 类和应用程序上下文 XML，但您真的不需要两者，我只是决定这样做以举例说明它们的用法。

**MongoConfig 类：（** 您也可以通过 spring 应用程序上下文 XML 执行此操作）

```
@Configuration
public class MongoConfig extends AbstractMongoConfiguration {
    @Override
    protected String getDatabaseName() {
        return "myDb";
    }

    @Override
    @Bean
    public Mongo mongo() throws Exception {
        return new Mongo("localhost");
    }
} 
```

**Spring App 上下文 XML：**

```
<!-- You can also expose the bean as a method in the MongoConfig class -->
<bean id="mongoRepositoryFactory" class="org.springframework.data.mongodb.repository.support.MongoRepositoryFactory">
    <!-- mongoTemplate comes from AbstractMongoConfiguration -->
    <constructor-arg ref="mongoTemplate" />
</bean>

<context:annotation-config />
<context:component-scan base-package="com.example.domain" />
<mongo:repositories base-package="com.example.domain.repository" mongo-template-ref="mongoTemplate" /> 
```

**我的存储库/ dao 类：**

```
@Repository
public class MyBeanDao extends SimpleMongoRepository<MyBean, String> {

    public MyBeanDao(MongoEntityInformation<MyBean, String> metadata, MongoOperations mongoOperations) {
        super(metadata, mongoOperations);
    }

    @Autowired
    public MyBeanDao(MongoRepositoryFactory factory, MongoOperations mongoOperations) {
        this(factory.<MyBean, String>getEntityInformation(MyBean.class), mongoOperations);
    }

    ... // more stuff
} 
```

我知道这真的很难看，只适用于 Java 6，但由于 getEntityInformation() 的返回类型是完全无界的，要么就是这样，要么让 ID 类型是 Serializable 而不是你的实际 ID 类型，并且每次你都做显式转换需要它。

我希望有一种更清洁的方法，但我已经通过 API 甚至源代码寻找了相当长的时间，并且没有找到更好的方法来做到这一点，而无需自己实现一些 spring-data -mongodb 类。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-27T23:29:06.137

我使用 MongoTemplate 为 Spring 和 MongoDB 为 Spring Web 应用程序 (MVC) 编写了一个可扩展的数据访问库，但完全避免了自动装配和存储库。它在控制器和数据层之间具有松散耦合（使用工厂）。您可以在其他域对象可以自动继承的基础实现中添加更多基础数据方法。见[https://github.com/rameshpa/spring-mongodb](https://github.com/rameshpa/spring-mongodb)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T20:45:18.047

通过使用修复它`<mongo:mapping-converter id="..." base-package="..." />`，并确保用`@Document`注释标记我所有的持久类，即使它们没有自己的集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T21:01:41.837

确保您遵循[参考文档](http://static.springsource.org/spring-data/data-mongodb/docs/current/reference/html/#repositories.custom-behaviour-for-all-repositories)中的说明。这里没有发生自动装配，因为您必须在 MongoRepositoryFactory 中创建存储库基类的实例（应该有另一种方法可以覆盖，我现在没有想到，我稍后会添加，但您可能会略过同时超级类的Javadoc）。一般来说，由于架构原因，字段注入不是一个好主意，注入静态字段更糟糕:)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-26T07:11:42.517

[这篇文章](https://stackoverflow.com/a/23027900/2338248)详细介绍了使用 spring-data mongodb 为所有存储库添加自定义行为的适当解决方案。

完成上述帖子中描述的步骤后，您可以使用任何存储库接口来扩展 custom-shared-repository-interface，如下所示

```
@Repository
public interface CustomerRepository extends MongoRepository<Customer, String>,
        WootideRepositoryCustom<Customer, String> {
} 
```

WootideRepositoryImpl 中提供的实现将在 CustomerRepository 中可用。

对我来说效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-06T22:09:11.590

有点旧的帖子，但最近我遇到了同样的问题。所以这是我的解决方案；我使用了问题中的类型并进行了相关更改。

注意：我使用的是**spring-data-mongodb 2.0.4.RELEASE**

**UserDAOImpl.java**

```
@Repository
public class UserDAOImpl extends SimpleMongoRepository<User, String> implements UserDAO  {
    static MongoEntityInformation<User, String> mongoEntityInformation;
    static
    {
        TypeInformation<User> typeInformation = ClassTypeInformation.from(User.class);
        MongoPersistentEntity<User> mongoPersistentEntity = new BasicMongoPersistentEntity<User>(typeInformation);
        mongoEntityInformation = new MappingMongoEntityInformation<User, String>(mongoPersistentEntity); 

    }
    public UserDAOImpl(MongoOperations mongoOperations)
    {
        super(mongoEntityInformation, mongoOperations);
    }
} 
```

**应用程序上下文.xml**

```
<bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
    <constructor-arg ref="mongo"/>
    <constructor-arg value="${mongo.db.name}"/>
</bean>

<mongo:repositories base-package="com.ohadr.mongodb_location.repository"/>

<bean class="com.ohadr.mongodb_location.repository.PlacesRepositoryImpl">
    <constructor-arg ref="mongoTemplate" />
</bean> 
```

...这应该可以解决问题。

# mysql - 带有计数和分组依据的 MySQL 查询

> ID：14344810
> 
> 赞同：31
> 
> 时间：2013-01-15T18:52:29.860
> 
> 标签：mysql, count, group-by

我已经为发布者准备了一个包含不同记录的表，每条记录在时间戳类型的列中都有一个日期。

```
id | id_publisher | date
1           1      11/2012 03:09:40 p.m.
2           1      12/2012 03:09:40 p.m.
3           2      01/2013 03:09:40 p.m.
4           3      01/2013 03:09:40 p.m.
5           4      11/2012 03:09:40 p.m.
6           4      02/2013 03:09:40 p.m.
7           4      02/2012 03:09:40 p.m. 
```

我需要计算每个出版商每个月发布的记录数。例如

```
Month    |  id_publisher         | num
11/2012  |          1            |   1
11/2012  |          2            |   0
11/2012  |          3            |   0
11/2012  |          4            |   1
.....
02/2013  |          4            |   2 
```

我试过了 `select count(id) from raw_occurrence_record group by month(date), id_publisher;`

但是，它没有用。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-15T18:56:31.803

假设您的日期是实际`datetime`列：

```
SELECT MONTH(date), YEAR(date), id_publisher, COUNT(*)
FROM raw_occurrence_record
GROUP BY MONTH(date), YEAR(date), id_publisher 
```

您可以像这样连接您的月份和年份：

```
SELECT CONCAT(MONTH(date), '/', YEAR(date)) AS Month, id_publisher, COUNT(*)
FROM raw_occurrence_record
GROUP BY MONTH(date), YEAR(date), id_publisher 
```

要查找没有记录的月份，您需要一个日期表。如果你不能创建一个，你可以`UNION ALL`像这样的日历表：

```
SELECT a.year, a.month, b.id_publisher, COUNT(b.id_publisher) AS num
FROM
  (SELECT 11 AS month, 2012 AS year
   UNION ALL
   SELECT 12, 2012
   UNION ALL
   SELECT 1, 2013
   UNION ALL
   SELECT 2, 2013) a
LEFT JOIN raw_occurence_record b
  ON YEAR(b.date) = a.year AND MONTH(b.date) = a.month
GROUP BY a.year, a.month, b.id_publisher 
```

## [查看演示](http://sqlfiddle.com/#!2/71d2d/1)

# javascript - JQuery 动画 Z 索引？

> ID：14344814
> 
> 赞同：0
> 
> 时间：2013-01-15T18:52:44.447
> 
> 标签：javascript, jquery, jquery-animate, z-index, animate.css

在我的页面中，我有不同的菜单项触发不同的相应图片。将`z-index`相应的图片切换到顶部。这是代码：

```
$(document).ready(function(){

var doorOpen = false;

$("a[href=#andrew]").click(function() {

    if (doorOpen) { // set animation duration for door close, based on actually needed to animate the door closed or not
        var duration = 1500;
    } else {
        var duration = 0;
    }

    $("#rightdoor,#leftdoor").animate(
        {"marginLeft":"0px"},
        {duration:duration,
            complete:function() {
                $('.pic2 .pic3 .pic4 .pic5').css('zIndex', 1);  //puts wrong pics in back
                $('.pic1').css('zIndex', 2);  //brings right pic into view
                $('#rightdoor').animate({  //opens doors again
                 marginLeft: "150px",
                }, 1500);
                $('#leftdoor').animate({
                 marginLeft: "-150px",
                }, 1500);
            }
        }
    );

    doorOpen = true;

});

$("a[href=#bugz]").click(function() {

    if (doorOpen) { // set animation duration for door close, based on actually needed to animate the door closed or not
        var duration = 1500;
    } else {
        var duration = 0;
    }

    $("#rightdoor,#leftdoor").animate(
        {"marginLeft":"0px"},
        {duration:duration,
            complete:function() {
                $('.pic1 .pic3 .pic4 .pic5').css('zIndex', 1);  //puts wrong pics in back
                $('.pic2').css('zIndex', 2);  //brings right pic into view
                $('#rightdoor').animate({  //opens doors again
                 marginLeft: "150px",
                }, 1500);
                $('#leftdoor').animate({
                 marginLeft: "-150px",
                }, 1500);
            }
        }
    );

    doorOpen = true;    
});
}); 
```

问题是，`z-index`每个菜单项似乎只有一次。如果您最初单击`#andrew`，它将 pic1 带到顶部，如果您单击`#bugz`它将 pic2 带到顶部。但是，如果`#andrew`再次单击，它会在更改前后对代码进行动画处理，`.css(z-index)`但不会更改`z-index`pic1 以返回顶部。

我是 Javascript/JQuery 的新手，所以如果我遗漏了一些明显的东西，请原谅我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:55:07.807

您的选择器错误：`$('.pic2 .pic3 .pic4 .pic5')`寻找`.pic2`.

您可以使用逗号而不是空格来分隔这些类，但使用该[`.siblings`](http://api.jquery.com/siblings)方法更简单：

```
$('.pic1').css('zindex',2).siblings().css('zindex',1); 
```

# tsql - 从选择语句创建一个视图，该语句使用 T-SQL 中的多个临时表来消除对临时表的需要

> ID：14344816
> 
> 赞同：1
> 
> 时间：2013-01-15T18:52:47.687
> 
> 标签：tsql, view, temp-tables

我们有一个非常规范化的 SQL 2005 数据库。问题是我需要一个对数据进行反规范化并将其放入视图的查询。目前，我有一个获取所需结果集的查询；但我正在使用三个临时表来执行此操作，并且需要切换到一个视图才能通过第三方报告软件运行 SQL，而我们不想让该软件能够创建临时表。由于视图需要是单个选择语句；我正在寻求帮助，将我的丑陋查询变成一个可以作为视图的选择语句。

涉及的表格有： `ModelResults [CustomerID,ModelID,RunDate,Score,ModelResultID(= modelresultsreviewid)]`

`Customers [CustomerID]`

`Models [ModelName,ModelID]`

涉及的视图是：（这是所有有评论的 ModelResults 的集合） `vw_exp_review [CustomerID,modelresultsreviewid]`

他们的关系如下：

每个客户都有一个 CustomerID；但不一定是 ModelResult 或 Review 或任何一个

每个模型都有一个 ModeID 和 ModelName

每个 ModelResult 都有 CustomerID、ModelID、RunDate 和 Score，但不一定是 Review

每个 Review(vw_exp_review) 都有一个 CustomerID 和 modelresultsreviewid

查询的目标是查找具有相同 CustomerID 和 ModelID 的 CustomerID、Scores、Models 和 RunDates，其中：

1.  没有模型结果或评论（在这种情况下，返回的只是一个 CustID）

2.  最近得分的模型 (Max(RunDate)) 与评论无关

3.  已审查的最近得分模型 (Max(RunDate))

一般有3种输出

1.  CustomerID、MostRecentScore、MostRecentReviewedScore、Model 和 MaxDate

2.  CustomerID、MostRecentScore、Model 和 MaxDate

3.  客户ID

到今天为止，我仍在使用以下内容：

```
DROP TABLE #_T1

-- MostRecentScore

SELECT CustomerID,ModelID,ModelResultID,RunDate,Min(Score) as MinScore

INTO #_T1

FROM ModelResults m1 WITH (NOLOCK)

WHERE RunDate IN (SELECT MAX(m.RunDate) FROM ModelResults m GROUP BY m.CustomerID)

GROUP BY

CustomerID,ModelID,ModelResultID,RunDate

DROP TABLE #_T2

--MostRecentReviewedScore

SELECT CustomerID,ModelID,RunDate,MIN(Score) AS MinScore

INTO #_T2

FROM ModelResults m1 WITH (NOLOCK)

WHERE RunDate IN (SELECT MAX(RunDate) 

                FROM ModelResults t JOIN vw_exp_review r ON 

                                    r.modelresultsreviewid = t.ModelResultID

                GROUP BY t.CustomerID)

GROUP BY CustomerID,ModelID,RunDate

DROP TABLE #_T3

--MostRecentModelResultDate

SELECT c.CustomerID,MAX(RunDATE) as MAXDate

INTO #_T3

FROM ModelResults mr WITH (NOLOCK)

RIGHT OUTER JOIN Customers C

ON mr.CustomerID = c.CustomerID

GROUP BY c.CustomerID

SELECT t3.CustomerID,t1.MinScore as MostRecentScore,

t2.MinScore as MostRecentReviewedScore,m.Model as ModelName,

t3.MaxDate

FROM #_T1 t1

LEFT OUTER JOIN #_T2 t2

ON t1.CustomerID = t2.CustomerID AND t1.ModelID = t2.ModelID

RIGHT OUTER JOIN #_T3 t3

ON t1.CustomerID = t3.CustomerID

LEFT OUTER JOIN Models m

ON t1.ModelID = m.ModelID

ORDER BY
t3.CustomerID 
```

样本输出：

`CustID,MostRecentScore,MostRecentReviewed,ModelName,MaxDate`

`8,2.36,4.59,Unrated Scorecard,2011-08-10 15:08:53.807`

`1361,2.76,NULL,SET Rated,2010-04-20 20:48:39.530`

`1362,NULL,NULL,NULL,NULL`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:54:37.260

您可以使用[CTE](http://msdn.microsoft.com/de-de/library/ms175972.aspx)代替临时表。这些可以很容易地用于将您的查询合并为一个，例如：

```
CREATE VIEW MYVIEW
AS
    WITH T1
    AS
    (
    -- MostRecentScore
      SELECT CustomerID,ModelID,ModelResultID,RunDate,Min(Score) as MinScore
      FROM ModelResults m1 WITH (NOLOCK)
      WHERE RunDate IN (SELECT MAX(m.RunDate) FROM ModelResults m GROUP BY m.CustomerID)
      GROUP BY
      CustomerID,ModelID,ModelResultID,RunDate
    )
    ,T2
    AS
    (
      --MostRecentReviewedScore
      SELECT CustomerID,ModelID,RunDate,MIN(Score) AS MinScore
      FROM ModelResults m1 WITH (NOLOCK)
      WHERE RunDate IN (SELECT MAX(RunDate) 
                        FROM ModelResults t JOIN vw_exp_review r ON 
                        r.modelresultsreviewid = t.ModelResultID
                        GROUP BY t.CustomerID)
      GROUP BY CustomerID,ModelID,RunDate
    )
    ,T3
    AS
    ( 
      SELECT c.CustomerID,MAX(RunDATE) as MAXDate
      FROM ModelResults mr WITH (NOLOCK)
      RIGHT OUTER JOIN Customers C
      ON mr.CustomerID = c.CustomerID
      GROUP BY c.CustomerID
    )
    SELECT 
      t3.CustomerID,t1.MinScore as MostRecentScore,
      t2.MinScore as MostRecentReviewedScore,m.Model as ModelName,
      t3.MaxDate
    FROM T1 t1
    LEFT OUTER JOIN T2 t2
      ON t1.CustomerID = t2.CustomerID AND t1.ModelID = t2.ModelID
    RIGHT OUTER JOIN T3 t3
      ON t1.CustomerID = t3.CustomerID
    LEFT OUTER JOIN Models m
      ON t1.ModelID = m.ModelID
    ORDER BY
    t3.CustomerID 
```

SQL-Fiddle 未附加，因此未测试，因为 OP 中没有演示数据。

请注意，CTE 每次都会执行，它会被访问。您还可以编写一个[UDF](http://msdn.microsoft.com/en-us/library/ms186755.aspx)，返回包含您的数据的表。在函数中，您仍然可以像在 OP 中一样使用临时表并创建一个视图`select * from myfunction()`

# c# - 调用 DbExtensions.Load 提前结束方法

> ID：14344818
> 
> 赞同：1
> 
> 时间：2013-01-15T18:52:55.303
> 
> 标签：c#, entity-framework

我正在使用带有 WinForms 的 Entity Framework 5.0，并且我只是按照 MSDN 的 Entity Framework 网站上的[Databinding with WinForms](http://msdn.microsoft.com/en-us/data/jj682076 "使用 WinForms 进行数据绑定")教程进行操作。我将 Category 类更改为具有 SortId 以便可以存储排序顺序：

```
public class Category
{
    private readonly ObservableListSource<Product> _products =
            new ObservableListSource<Product>();

    public Category(int pSortId = 0)
    {
        Name = "New Category";
        SortId = pSortId;
    }

    public int CategoryId { get; set; }
    public string Name { get; set; }
    public int SortId { get; set; }
    public virtual ObservableListSource<Product> Products { get { return _products; } }
} 
```

但是，添加 SortId 后，应用程序停止在 DataGridView 中显示类别。通过逐步调试调试器并在 OnLoad 方法中添加调试语句，我发现当调用 _context.Categories.Load() 时，该方法过早停止执行，这意味着 categoryBindingSource 永远不会分配数据源。

_context.Categories.Load() 在这里被调用（就像在上面提到[的教程](http://msdn.microsoft.com/en-us/data/jj682076 "使用 WinForms 进行数据绑定")中一样）

```
 protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);
        _context = new ProductContext();
        _context.Categories.Load();
        this.categoryBindingSource.DataSource =
            _context.Categories.Local.ToBindingList();
    } 
```

**问题：**有谁知道为什么 Load 方法会这样做？（这是[DbExtensions.Load](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28System.Data.Entity.DbExtensions.Load%29;k%28TargetFrameworkMoniker-.NETFramework,Version=v4.0%29;k%28DevLang-csharp%29&rd=true "DbExtensions.Load 方法")）

如果需要，ProductContext 类（也未从教程中修改）是：

```
 public class ProductContext : DbContext
    {
        public DbSet<Category> Categories { get; set; }
        public DbSet<Product> Products { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T18:08:16.513

这是我的解决方案，我不会将其标记为答案，因为如果有人可以详细说明幕后发生的事情，这将更有帮助

简而言之，我告诉 Visual Studio 中断任何异常（Debug > Exceptions > Check all under throwed），并在外部代码的某处发现了 InvalidOperationException，并显示消息“类 'EFWinForms.Category' 没有无参数构造函数”。

使用这个建议，我将 Category 类的构造函数拆分如下：

```
public Category() : this(0) { }

public Category(int pSortId)
{
    Name = "New Category";
    SortId = pSortId;
} 
```

我的假设是 DbExtensions.Load 方法捕获了该异常并杀死了看起来很奇怪的线程，但我无法证明它。

# ruby-on-rails-3 - Savon 使用“TypeError: can't convert String into Hash”开箱即用

> ID：14344821
> 
> 赞同：3
> 
> 时间：2013-01-15T18:53:19.043
> 
> 标签：ruby-on-rails-3, savon

我刚刚在 Rails 3.2.11 上安装了 Savon 2.0.2。当我尝试在控制台中创建新客户端时，我得到`TypeError: can't convert String into Hash`：

```
1.9.3-p362 :003 > client = Savon::Client.new("http://www.webservicex.net/uszip.asmx?WSDL")
TypeError: can't convert String into Hash
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/savon-2.0.2/lib/savon/options.rb:49:in `merge'
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/savon-2.0.2/lib/savon/options.rb:49:in `initialize'
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/savon-2.0.2/lib/savon/client.rb:10:in `new'
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/savon-2.0.2/lib/savon/client.rb:10:in `initialize'
    from (irb):3:in `new'
    from (irb):3
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
    from /Users/jasonswett/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

知道为什么会发生这种情况吗？这是一个全新的、几乎是普通的 Rails 应用程序，所以我不明白可能出了什么问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T18:57:22.040

尝试：

```
client = Savon::Client.new(wsdl: "http://www.webservicex.net/uszip.asmx?WSDL") 
```

或者

```
client = Savon.client(wsdl: "http://www.webservicex.net/uszip.asmx?WSDL") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T08:10:46.303

由于肥皂需要哈希而不是字符串，因此您可以在哈希键、值格式的参数中添加哈希

**Rails 中描述哈希键的旧方法**

```
client = Savon.client(:wsdl=> "http://www.webservicex.net/uszip.asmx?WSDL") 
```

**在 Rails 中描述哈希的新方法**

```
client = Savon.client(wsdl: "http://www.webservicex.net/uszip.asmx?WSDL") 
```

# android - BlackBerry 上不同屏幕尺寸的 Android 布局？

> ID：14344824
> 
> 赞同：0
> 
> 时间：2013-01-15T18:53:37.277
> 
> 标签：android, blackberry-playbook, blackberry-android

我将`layout`文件夹用于手机布局，将`layout-sw600dp`文件夹用于平板电脑布局。

Android 根据屏幕尺寸选择布局文件。`PlayBook`我使用 Android RunTime Environment安装了该应用程序。Playbook 仍然从`layout`文件夹中获取布局。

我需要为剧本做一些不同的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:10:22.950

`layout-sw600dp`是 Android 3.2 功能 (API 13)。Blackberry 的 Android 运行时仅支持 2.3.3 (API 10)。

[http://developer.blackberry.com/android/documentation/mastertopic_2016760_11.html](http://developer.blackberry.com/android/documentation/mastertopic_2016760_11.html)

# c# - 带有 TaskCompletionSource 的 TaskCreationOptions 的目的是什么？

> ID：14344825
> 
> 赞同：13
> 
> 时间：2013-01-15T18:53:46.910
> 
> 标签：c#, task-parallel-library, taskcompletionsource

我对`TaskCompletionSource<>`.

使用 创建简单`Task<>`时`Factory`，我希望此任务在线程池中排队，除非我指定`TaskCreationOptions.LongRunning`，否则它将在新线程中运行。

我对 的理解`TaskCompletionSource`是，我负责在任务结束或失败时触发，并且我可以完全控制如何管理线程。但是， ctor`TaskCompletionSource`允许我指定 a `TaskCreationOptions`，这让我感到困惑，因为我期待`Scheduler`无法处理任务本身。

`TaskCreationOptions`在 a 的上下文中的目的是`TaskCompletionSource<>`什么？

这是一个使用示例：

```
public Task<WebResponse> Download(string url)
{
    TaskCompletionSource<WebResponse> tcs = 
    new TaskCompletionSource<WebResponse>(TaskCreationOptions.LongRunning);

    var client = (HttpWebRequest)HttpWebRequest.Create(url);
    var async = client.BeginGetResponse(o =>
      {
          try
          {
              WebResponse resp = client.EndGetResponse(o);
              tcs.SetResult(resp);
          }
          catch (Exception ex)
          {
              tcs.SetException(ex);
          }
      }, null);

    return tcs.Task;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T12:52:12.753

答案是 TaskCreationOption 仅对其 AttachToParent 选项有用，因为 TaskCompletionSource 可以是任何其他任务的子项。与线程管理或执行顺序相关的选项与 TaskCompletionSource 的上下文无关。下面的代码实际上抛出了一个异常：

```
new TaskCompletionSource<WebResponse>(TaskCreationOptions.LongRunning); 
```

# java - 大文件的Spring集成

> ID：14344827
> 
> 赞同：1
> 
> 时间：2013-01-15T18:53:50.410
> 
> 标签：java, etl, batch-processing, large-files, spring-integration

我需要使用spring集成对大数据包执行ETL操作。例如，我有巨大的 xml 文件，如：

```
<school>
    <cource name="A">
        <class>
            <name>A1</name>
            <students>20</students>
        </class>
        ...
        <class>
            <name>A35</name>
            <students>19</students>
        </class>
    </cource>
    <cource>
    ...
    </cource>
</school> 
```

结果应该是 2 个 cvs 文件：

第一的：

```
A1;20
...
A35;35 
```

第二：

```
A; 754
..
C; 232 
```

那是简单的转换操作和容器上的一些聚合功能。“类”和“课程”记录的数量非常大，我无法解析内存中的输入数据（所以我需要按元素迭代），但我仍然不想使用集成模式来轻松修改 ETL 流。

有什么办法可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:42:12.940

您可以使用*Spring Integration*来检测文件的存在并启动*Spring Batch*作业（使用 中`JobLaunchingMessageHandler`提供的`spring-batch-integration`项目中提供的`spring-batch-admin`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:22:51.887

您可以创建一个与 ItemReader 和 ItemWriter 关联的步骤。大文件是流式传输的，而不是作为一个整体读取的。所以，这应该有魔力。

更多阅读[在这里](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDIQFjAA&url=http://static.springsource.org/spring-batch/reference/html/readersAndWriters.html&ei=BKz1UPOHFbK10QWo_4HICQ&usg=AFQjCNGM4VikwDrondxYSP2R-GEU_HlLXw&bvm=bv.41018144,d.d2k)。[这里](http://www.dineshonjava.com/2013/01/itemreaders-and-itemwriters-in-spring.html#.UPWs8OSsjTo)的例子。

# c++ - 在 C++ 中，如何在列表中的每次连续零运行中删除除 x 之外的所有零？

> ID：14344831
> 
> 赞同：3
> 
> 时间：2013-01-15T18:53:54.050
> 
> 标签：c++, algorithm, list, c++11, erase-remove-idiom

对于 C++ 列表中的每次运行`x`或多个连续零，我想删除运行中除`x`它们之外的所有零。如果`x = 0`，则删除所有零。

我在想一个 C++ 函数，它接受一个列表，`list<int> L`和一个数字`int x`，作为输入。

例如，让`L = {7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8}`.

*   如果`x = 0`，则返回`L = {7, 12, 2, 27, 10, 8}`
*   如果`x = 1`，则返回`L = {7, 0, 12, 0, 2, 0, 27, 10, 0, 8}`
*   如果`x = 2`，则返回`L = {7, 0, 12, 0, 0, 2, 0, 0, 27, 10, 0, 0, 8}`
*   如果`x = 3`，则返回`L = {7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 8}`
*   如果`x = 4`，则返回`L = {7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8}`（与原始相同`L`）
*   如果`x >= 5`，则返回原始`L`值，因为没有 5 个或更多连续零的运行。

几个月前，我使用 Python ( [stackoverflow.com/questions/11732554/...](https://stackoverflow.com/questions/11732554/how-can-i-delete-all-zeros-except-for-x-of-them-in-every-run-of-consecutive-zero) ) 提出了上述相同的问题，并得到了很好的答案。现在我想用 C++ 完成这个任务。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T19:08:22.830

这是一些应该完成这项工作的代码：

```
void DeleteAllZerosInARow(std::list<int>& theList, int x)
{
    if(x == 0)
    {
        theList.remove(0);
        return;
    }

    int streak = 0;
    std::list<int>::iterator itor = theList.begin();
    while(itor != theList.end())
    {
        if(*itor == 0)
            ++streak;
        else
            streak = 0;

        if(streak > x)
            itor = theList.erase(itor);
        else
            ++itor;
    }
} 
```

基本上，您计算一行中有多少个零，如果是 则删除它们`> x`，否则继续迭代列表。

给出以下输出：

*   0：`7,12,2,27,10,8`
*   1：`7,0,12,0,2,0,27,10,0,8`
*   2：`7,0,12,0,0,2,0,0,27,10,0,0,8`
*   3：`7,0,12,0,0,2,0,0,0,27,10,0,0,0,8`
*   4：`7,0,12,0,0,2,0,0,0,27,10,0,0,0,0,8`
*   5：`7,0,12,0,0,2,0,0,0,27,10,0,0,0,0,8`

这取决于您的风格，`remove_if`可能是更`C++`友好的方式，但我发现直接操作值更清晰，并且不涉及新的数据类型（`struct`用于跟踪`0`您遇到的数量）。

代码无法使用的原因很简单，因为,和大数`NTL::ZZ`之间没有隐式转换，因此不能。你可以做的事情可能是这样的：`int``0``NTL::ZZ``remove(0)`

```
if(x == 0)
{
    static ZZ zero; // default value is 0, static so that it is only constructed once
    theList.remove(zero); // remove all items who are equal to "zero"
    return;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T19:03:04.947

对于案例 0，您可以使用`std::remove`，对于案例 1，您可以使用`std::unique`仅适用于 的谓词`0`。对于更大的值，要么设计一个偷偷摸摸的有状态谓词来使用，`unique`要么借用它的逻辑来应用于更大的序列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T19:08:25.077

最简单的方法是返回 a`std::vector<int>`并使用`push_back`，这样您就不必担心分配正确大小的数组。

```
template<typename Iter>
std::vector<int> filter_zeroes(Iter start, Iter end, const size_t num_zeroes)
{
    std::vector<int> output;
    size_t zero_count = 0;
    while (start != end)
    {
        if (*start != 0)
        {
            output.push_back(*start);
            zero_count = 0;
        }
        else if (zero_count < num_zeroes)
        {
            output.push_back(*start);
            ++zero_count;
        }
        ++start;
    }
} 
```

你可以使这个方法更通用。更改`int`为`typename ValueType`和`0`，`ValueType value_to_remove`您正在`std::algorithm`达到通用水平...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T20:03:45.287

这是用于任意类型的 C++11 版本（使用`auto`、lambda 和移动语义）：`std::vector``value``T`

```
#include <algorithm>
#include <cstddef>
#include <iostream>
#include <iterator>
#include <vector>

template<std::size_t N, typename T>
std::vector<T> collapse_consecutive(std::vector<T> v, T const& value)
{
    if (v.size() <= N) return v;

    for (auto it = v.begin(); it != std::prev(v.end(), N); ++it) {
        if (*it == value) {
            // find first following mismatch
            auto jt = std::find_if(it, v.end(), [&](T const& elem) {               
               return elem != value;
            });
            // keep first N matches, remove rest of matches
            if (std::distance(std::next(it, N), jt) > 0)               
                v.erase(std::remove(std::next(it, N), jt, value), jt);
        }
    }
    std::for_each(v.begin(), v.end(), [](int const& elem) { std::cout << elem << ", "; });
    std::cout << "\n";
    return v;
}

int main()
{
   std::vector<int> v = {7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8};

  collapse_consecutive<0>(v, 0);
  collapse_consecutive<1>(v, 0);
  collapse_consecutive<2>(v, 0);
  collapse_consecutive<3>(v, 0);
  collapse_consecutive<4>(v, 0);
  collapse_consecutive<5>(v, 0);  
} 
```

[LiveWorkSpace](http://liveworkspace.org/code/4ue7Wg%2452)上的输出

```
stdout: 
7, 12, 2, 27, 10, 8, 
7, 0, 12, 0, 2, 0, 27, 10, 0, 8, 
7, 0, 12, 0, 0, 2, 0, 0, 27, 10, 0, 0, 8, 
7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 8, 
7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8, 
7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8, 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T19:12:19.567

您可以通过将仿函数传递给 list::remove_if 来实现。下面的例子。

```
#include <iostream>
#include <list>

std::list<int> origL{7, 0, 12, 0, 0, 2, 0, 0, 0, 27, 10, 0, 0, 0, 0, 8};

template <typename T>
struct remove_more_than_n_consecutive_zeros
{
    int n;
    int i;
    F(int n) : n(n), i(0) { }

    bool operator()(const T &element) {
        if (0 == element) {
            ++i;
            return i > n;
        }
        else 
        {
            i = 0;
            return false;
        }
    }
};

int main()
{
    for (int i = 0; i < 5; ++i) {
        std::list<int> L = origL;
        L.remove_if(remove_more_than_n_consecutive_zeros<int>(i));
        for (int x : L) { std::cout << x << " "; }
        std::cout << std::endl;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T19:20:37.380

它本质上是一个状态机，所以你可以用 std::regex 做一些聪明的事情，但这里有一个简单的实现。

```
void TrimConsecutiveValues(int value, int cKeep, std::list<int> &list) {
  int cSeen = 0;
  auto it = list.begin();
  while (it != list.end()) {
    if (*it == value) {
      if (cSeen < cKeep) {
        ++cSeen;
        ++it;
      } else {
        it = list.erase(it);
      }
    } else {
      cSeen = 0;
      ++it;
    }
  }
} 
```

# git - 从 git 克隆 repo 后要做什么

> ID：14344832
> 
> 赞同：9
> 
> 时间：2013-01-15T18:53:55.010
> 
> 标签：git, bitbucket, git-clone, git-commit

我只是一个**git starter**，基本上我克隆了一个 git 存储库，现在我想提交我在文件中所做的更改。当我运行`git commit`它说的命令时`not a git repository`，

因此，作为 git 的初学者，我只想问我是否需要先运行此命令 -`git init`然后再运行`git commit`？或者在这些提交文件的更多步骤之间？

我需要在 Bitbucket 上提交文件。

截屏-

![在此处输入图像描述](../Images/ac3f0aa0f38042e648eb205cfa86a8aa.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T19:17:18.380

正如*jeremyharris*所说，[git 文档站点](http://git-scm.com/documentation)，尤其是那里的[在线书籍](http://git-scm.com/book)，将使您快速了解基础知识。

一些快速说明可能会帮助您解决最初的问题。

`git clone`命令用于从现有的 git 存储库中提取副本（克隆）。默认情况下，它会在您执行它的文件夹中创建一个文件夹，其中包含一个`.git`文件夹。克隆创建的文件夹是您的工作副本，该`.git`文件夹是您的存储库的本地副本。

`git clone`与大多数其他 git 命令不同。所有（或大多数？）其他 git 命令都需要在克隆创建的工作副本文件夹中执行该命令。（裸存储库有点不同，因为它们没有工作副本，但这不应该在这里适用。）所以，在这样做之后：

```
$ git clone <remote repo> <repo name> 
```

做：

```
$ cd <repo name> 
```

在执行任何其他命令之前进入工作副本。在工作文件夹之外执行命令会给你`not a git repository`消息。

对文件进行更改后，`git add <filename>`将其添加到索引中（标记为表示准备好提交），`git commit -m '<commit message>'`然后将提交更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T18:56:26.150

您需要首先添加更改，使用`git add .`

您还可以在添加之前检查状态，使用`git status`

编辑

刚刚看到关于错误的评论。对，那是正确的。我忽略了这一点。

你的问题是你首先需要`cd`git 文件夹。

在那之后，你仍然需要`add`作为我上面的答案。

# c - 在C中将整数四舍五入到最接近的十或百

> ID：14344833
> 
> 赞同：9
> 
> 时间：2013-01-15T18:54:12.443
> 
> 标签：c, rounding

我试图在 C 中考虑一个满足以下条件的函数：

*   它接受大于 0 的整数作为参数；
*   它将整数向上舍入到最接近的值，以便只有第一个数字不是零

例如：

> 53出来是60..
> 
> 197出来是200..
> 
> 4937 出来是 5000..

有没有办法做到这一点，无论尾随零的数量如何都能满足要求？

例如，我了解如何在任何个别情况下做到这一点。`divide 53 by 10 then ceil(), multiply by 10,`但我想要一个可以处理任何价值的人。

意见？想法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-15T19:04:56.300

避免字符串转换和循环：

```
int num = ... // your number
int len = log10(num);
float div = pow(10, len);
int rounded = ceil(num / div) * div; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-15T19:01:07.947

It's unnecessary to convert the number to a string and back. You can do this using basic modulo arithmetic and multiplication and division.

Here's a pure numeric solution, hopefully somewhat more efficient in terms of running time:

```
int round_up_to_max_pow10(int n)
{
    int tmp = n;
    int i = 0;
    while ((tmp /= 10) >= 10) {
        i++;
    }

    if (n % (int)(pow(10, i + 1) + 0.5)) {
        tmp++;
    }

    for (; i >= 0; i--) {
        tmp *= 10;
    }

    return tmp;
}

printf("Original: %d; rounded: %d\n", 4937, round_up_to_max_pow10(4937)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T19:08:14.190

对数在这里非常有用，可以为“这有多少个零？”提供恒定时间的答案。

```
floor(log10(x))= z //the number of zeros 
```

将取对数以 10 为底，并给出 x 中零的数量。

然后你可以使用 C 偶尔的成语

(A+B-1)/B

快速找到 A/B 的上限，从而以这种方式得出正确的前导数字：

```
zeros = exp10(1,z);
((x+zeros-1)/zeros) * zeros 
```

这是伪代码，但你应该明白。关键的理解是对数是数学上确定一个数字有多少位数的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T19:07:45.940

我不确定你想要圆形还是天花板。但是您在问题中表现出的行为暗示了 ceil。所以我把它包括在内。

```
int my_ceil(int num)
{
    int den = 1;
    int inc = 0;

    while (num >= 10) {
        inc += num % 10;
        num /= 10;
        den *= 10;
    }

    return (num + (inc > 0)) * den;
} 
```

**编辑**

更改了代码以删除 ceil 和其他额外操作。

**编辑 2**

固定为 10 的倍数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T19:08:39.143

通过 Cocoa API：

```
int number=9435;
NSString *string=[NSString stringWithFormat:@"%d",number];
long length=[string length];    
NSString *roundedString=[NSString stringWithFormat:@"%d",([[string substringToIndex:1]intValue]+1)];
while (--length>0) {
    roundedString=[roundedString stringByAppendingString:@"0"];
}
int roundedNumber=[roundedString intValue];
NSLog(@"%d,   %d",number,roundedNumber); 
```

通过典型的 C 风格，数学上：

```
int i=8517;

int temp=i;
int len,msb;

for (len=0; temp>0; len++) {
    msb=temp;
    temp/=10;
}
msb++;
int multiplier=1;
for (int i=1; i<len; i++) {
    multiplier*=10;
}
 NSLog(@"Rounded : %d",msb*multiplier); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T19:41:39.230

这应该这样做：

```
static int
rnd_up(int val)
{
    double e, r;

    e = exp10(trunc(log10((double)val)));
    r = round(((double)val / e) + 0.5);

    return(r * e);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-15T19:02:18.863

Try taking the first character of the input number, add 1, then append zeros.

```
 Dim Input = "23568"
    Dim roundUp = Left(Input, 1) + 1

    For x = 1 To Len(Input) - 1
        roundUp &= "0"
    Next 
```

In VB, but hopefully you get the idea.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-15T18:58:57.560

我会将数字转换为字符串。获取字符串的长度。

然后：

```
// pseudo code:
divisor = pow(10, len of number string)
answer = ceil (number/divisor) * divisor; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-15T19:05:29.617

没有循环。

```
#include <math.h>
unsigned roundToNextExp10( unsigned a )
{
    int d = a ;
    if( a >= 10 )
    {
        int m ;
        d-- ;
        m = (int)pow( 10, ((int)log10(d)) ) ;
        d = (int)((d / m) + 1) * m ;
    }        
    return d ;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-15T19:07:15.907

您可以将数字除以十，直到只剩下一位数字，然后将其乘回大小：

```
int n = 4937;

int m = 1;
while (n >= 10) {
  n = (n + 9) / 10;
  m *= 10;
}
n *= m; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-27T07:28:03.587

```
/*-------------------------------------------------*/
/* Round up a number                               */
/* (Negative numbers go DOWN)                      */
/* 34 -> 40                                        */
/* -34 -> -40                                      */
/*-------------------------------------------------*/
int round_up_10(int num) 
{
    int sign = 1;
    int tens = 1;

    if (num < 0)
    {
        num = (-1) * num;
        sign = -1;
    }
    num = (num + 9) / 10;
    num = num * 10;

    return sign * num;
}
/*-------------------------------------------------*/
/* Round down a number                             */
/* (Negative numbers go UP)                        */
/* 34 -> 30                                        */
/* -34 -> -30                                      */
/*-------------------------------------------------*/
int round_down_10(int num)   
{
    int sign = 1;
    int tens = 1;

    if (num < 0)
    {
        num = (-1) * num;
        sign = -1;
    }
    num = num / 10;
    num = num * 10;

    return sign * num;
}

main()
{
    printf("round_down_10(25450)= %d\n", round_down_10(25450));
    printf("round_down_10(-25450)= %d\n", round_down_10(-25450));
    printf("round_up_10(25450)= %d\n", round_up_10(25450));
    printf("round_up_10(-25450)= %d\n", round_up_10(-25450));

    printf("round_down_10(1347)= %d\n", round_down_10(1347));
    printf("round_down_10(-1347)= %d\n", round_down_10(-1347));
    printf("round_up_10(1347)= %d\n", round_up_10(1347));
    printf("round_up_10(-1347)= %d\n", round_up_10(-1347));

    printf("round_down_10(34)= %d\n", round_down_10(34));
    printf("round_down_10(-34)= %d\n", round_down_10(-34));
    printf("round_up_10(34)= %d\n", round_up_10(34));
    printf("round_up_10(-34)= %d\n", round_up_10(-34));
}
    /*
    The outout:
    round_down_10(25450)= 25450
    round_down_10(-25450)= -25450
    round_up_10(25450)= 25450
    round_up_10(-25450)= -25450
    round_down_10(1347)= 1340
    round_down_10(-1347)= -1340
    round_up_10(1347)= 1350
    round_up_10(-1347)= -1350
    round_down_10(34)= 30
    round_down_10(-34)= -30
    round_up_10(34)= 40
    round_up_10(-34)= -40
    */ 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2016-11-13T17:32:31.860

你在这里得到的一些专家建议......将一个数字四舍五入*到*最接近的 10：

```
if (i%10)
   i += 10 - i%10; 
```

同样对于 100s、1000s 等。

# wordpress - Wordpress 前端“更新”按钮，其作用与后端更新按钮相同

> ID：14344836
> 
> 赞同：0
> 
> 时间：2013-01-15T18:54:20.410
> 
> 标签：wordpress

我必须从前端的 single.php 文件中更新很多自定义字段。这些字段之一是“价格”，并且价格**仅**在发布更新时通过 publish_post 函数添加到 sql。

目标是在前端有一个更新按钮，按下时与后端更新按钮相同。

原因是即使我从前端更新自定义字段，它确实会按预期写入后端。但是，帖子本身并没有通过我的functions.php文件中的函数触发所需的“更新”或发布过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:29:30.543

**AJAX**是您正在寻找的解决方案。[以下是](http://codex.wordpress.org/AJAX_in_Plugins)有关如何在**WordPress**中执行此操作的一些信息。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T02:29:59.860

除了 publish_post 钩子，还有一个 updated_post_meta 钩子，仅用于更新自定义字段时。

所以你可以这样做：

```
add_action('updated_post_meta', 'updated_post_meta_fn', 10, 4); 
```

和

```
function updated_post_meta_fn($meta_id, $post_id, $meta_key, $meta_value)
{

} 
```

# sql - MS Access 多用户同时选择不同的记录

> ID：14344839
> 
> 赞同：1
> 
> 时间：2013-01-15T18:54:29.250
> 
> 标签：sql, ms-access, concurrency

在我们的多用户访问环境中，有时需要对一组记录执行不同的操作。例如，在 Orders 表中，用户可能想要删除一组订单，或者打印出一组记录等。为此，在 Orders 表中，我创建了一个名为 aSelect 的布尔字段（“a " 是为了避免“Select” SQL 保留关键字）。在订单表单上，用户可以通过单击 aSelect 字段的复选框，然后单击“打印”、“删除”或任何其他操作来检查他们想要处理的订单。然后表单后面的代码说要处理所有订单的操作 WHERE ASELECT=TRUE

问题是，（虽然它还没有发生），aSelect 复选框绑定到表中的基础字段，并且两个用户可以同时更改 aSelect。因此，假设用户 A 选择要删除的两条记录，但在他点击删除按钮之前，另一个尝试打印 100 条记录的用户选择了 100 条记录。结果将是所有 100 条记录都将被删除——这不是预期的结果。

任何解决方案或替代方案？这种情况在整个数据库中多次出现。Orders 表只是一个例子。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T11:31:11.200

创建一个包含 username/userid 列和 OrderID 列的表。

当用户进行选择时，使用 OrderID 和用户名向该表添加一条记录，然后在运行查询时加入该选择表或使用 IN() 子句并按用户名过滤。

瞧——用户特定的选择，可以改进/扩展，但这是我的基本产品。

# sql - 如何重新键入表中的层次结构？

> ID：14344848
> 
> 赞同：3
> 
> 时间：2013-01-15T18:54:50.293
> 
> 标签：sql, sql-server, oracle, plsql, hierarchy

我有两张桌子

**汽车**：包含有关汽车的层次结构数据

```
+-----+-------------+-----------+
| id  | description | parent_id |
+-----+-------------+-----------+
|   1 | All cars    |         1 |
|  30 | Toyota      |         1 |
|  34 | Yaris       |        30 |
|  65 | Yaris       |        30 |
|  87 | Avensis     |        30 |
|  45 | Avensis     |        30 |
| 143 | Skoda       |         1 |
| 199 | Octavia     |       143 |
|  12 | Yeti        |       143 |
+-----+-------------+-----------+ 
```

**car_mapping**：包含映射数据，其中重复的汽车（具有不同的 id）被映射到一个 id。

```
+--------+----------+--------+
| car_id | car_name | map_id |
+--------+----------+--------+
|     34 | Yaris    |      1 |
|     65 | Yaris    |      1 |
|     87 | Avensis  |      2 |
|     45 | Avensis  |      2 |
|    199 | Octavia  |      3 |
|     12 | Yeti     |      4 |
|     30 | Toyota   |      5 |
|    143 | Skoda    |      6 |
|      1 | All cars |      0 |
+--------+----------+--------+ 
```

现在，我们的想法是创建第三个表**cars_new**，它基于**cars**和**car_mapping**删除重复项并根据**car_mapping**表中的字段重新键入**cars**表中的层次结构。这是生成的**cars_new**：`map_id`

 ****```
+--------+----------+---------------+
| map_id | car_name | parent_map_id |
+--------+----------+---------------+
|      0 | All      |             0 |
|      1 | Yaris    |             5 |
|      2 | Avensis  |             5 |
|      3 | Octavia  |             6 |
|      4 | Yeti     |             6 |
|      5 | Toyota   |             0 |
|      6 | Skoda    |             0 |
+--------+----------+---------------+ 
```

这是这个问题的[SQL Fiddle](http://sqlfiddle.com/#!4/80a4f/1)。任何想法如何重新设置这个层次结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:02:44.273

```
select distinct cm.map_id, cm.car_name, cm2.map_id parent_map_id
from cars c, car_mapping cm, car_mapping cm2
where c.id = cm.car_id
and c.parent_id = cm2.car_id(+)
order by cm.map_id; 
```

PS：在您的`car_mapping`表格中，您需要额外的一行（下面的第一行）才能获得您想要的结果：

```
+--------+----------+--------+
| car_id | car_name | map_id |
+--------+----------+--------+
|     1  | All      |      0 |
|     34 | Yaris    |      1 |
|     65 | Yaris    |      1 |
Etc.. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T19:47:46.193

根据@Majid LAISSI 接受的答案，这似乎适用于 Oracle 和 SQL Server：

```
select distinct cm.map_id, cm.car_name, cm2.map_id as parent_map_id
from cars c
left outer join car_mapping cm on c.id = cm.car_id
left outer join car_mapping cm2 on c.parent_id = cm2.car_id
order by cm.map_id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T05:32:46.680

您没有层次结构，最好不要创建层次结构。注意你的“汽车”表没有描述汽车；它只是将一个字符串分配给一个数字（并将另一个数字分配给该数字）。从一开始，“所有汽车”就不是汽车，“丰田”是汽车制造商，而不是汽车。

解决方案 - 有助于解决您的唯一性问题并简化您的查询 - 是为每个不同的事物使用一个表：

*   制造商 { mfg_id, name } -- 例如 GM、Ford
*   制造 { make_id, name, mfg_id } -- 例如雪佛兰、林肯；制造商链接
*   models { name, make_id } -- 例如 Yaris 等；链接到制造。

确保在每个表中使“名称”唯一，以防止创建虚假 ID。

这将让您在这些东西出现时为其分配新属性，例如它们的制造年限或售出数量，或每种型号的门数。它还可以让您防止福特与通用汽车或通用汽车的“关系”比如说，让 Yaris 成为“所有汽车”的父级。

（顺便说一句，我建议您避免在表名中使用“映射”或“映射”，因为它没有说明任何内容。每个表都将行中的元素相互关联。每个表都将键映射到其值。好的新闻是您的 car_mapping 表在新设计中消失了。）

至于如何转换现有的汽车表，那就麻烦了。 *假设*cars_mapping 是正确的，您将能够插入每个表，加入它并在按名称分组时获取 min(id)。您将需要三个这样的查询，然后仔细观察以检查，呃，错位。****

# php - PHP Simplexml_Load_File 失败

> ID：14344849
> 
> 赞同：1
> 
> 时间：2013-01-15T18:54:57.953
> 
> 标签：php, xml, simplexml, ncbi

我已经成功地获得了 xml 格式的 pubmed 结果页面并将内容写入本地文件“Publications.xml”。问题是当我使用 simplexml_load_file("Publications.xml") 时，它失败了。无法弄清楚为什么。

```
<?php
$feed = 'http://www.ncbi.nlm.nih.gov/pubmed?term=carl&sort=pubdate&report=xml';
$local = 'Publications.xml';
$curtime = time();
$filemodtime;
if( (!file_exists($local)) || (time() - filemtime($local)) > 86400 )
{
    $contents = file_get_contents($feed);
    $fp = fopen($local,"w");
    fwrite($fp, $contents);
    fclose($fp);
}
$xml = simplexml_load_file($local) or ("Can't");
?> 
```

在最后但第二行，解析器失败，我收到消息“不能”。我已经仔细检查了 xml 文件，它看起来状态良好。

如果有人可以让我知道这个的任何解决方法，我将非常感激。这是上面 PHP 脚本尝试读取的 xml 文件的副本 ( [http://pastebin.com/U0fEKmZL](http://pastebin.com/U0fEKmZL) )：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<pre>
&lt;PubmedArticle&gt;
    &lt;MedlineCitation Status="Publisher" Owner="NLM"&gt;
        &lt;PMID Version="1"&gt;23314841&lt;/PMID&gt;
        &lt;DateCreated&gt;
            &lt;Year&gt;2013&lt;/Year&gt;
            &lt;Month&gt;1&lt;/Month&gt;
            &lt;Day&gt;14&lt;/Day&gt;
        &lt;/DateCreated&gt;
        &lt;Article PubModel="Print-Electronic"&gt;
            &lt;Journal&gt;
                &lt;ISSN IssnType="Electronic"&gt;1432-0932&lt;/ISSN&gt;
                &lt;JournalIssue CitedMedium="Internet"&gt;
                    &lt;PubDate&gt;
                        &lt;Year&gt;2013&lt;/Year&gt;
                        &lt;Month&gt;Jan&lt;/Month&gt;
                        &lt;Day&gt;12&lt;/Day&gt;
                    &lt;/PubDate&gt;

 ... (too long, see link) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:35:40.843

出于某种原因，发布服务器将整个 XML 文件作为 HTML 文件返回，`<pre>`其中包含包含 XML 的单个标记。它还包含多个 XML 片段（有几个`<PubmedArticle>`元素，它们周围没有容器）。显然，这是打算由一些古怪的自定义代码处理的。

您可以通过调用 SimpleXML 两次来“解包”XML，如下所示：

```
$outer_xml = simplexml_load_file($local);
$inner_xml = simplexml_load_string('<dummyContainer>' . (string)$outer_xml . '</dummyContainer>');
foreach ( $inner_xml->PubmedArticle as $article )
{
    // etc
} 
```

解释：

*   外部“XML 文档”是 HTML，它有一个外部元素`<pre>`
*   将其转换为字符串（为了清晰和良好的习惯，我已经明确地这样做了`(string)`）将为您提供该`<pre>`标签的内容，即所有`<PubmedArticle>`元素
*   将该内容包装在`<dummyElement>`标签中将为您提供一个有效的 XML 文档，其中每个`<PubmedArticle>`元素都作为文档中的顶级子元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:04:23.633

试试 urlencoding。

> 笔记：
> 
> Libxml 2 对 URI 进行转义，所以如果你想传递例如**b&c**作为 URI 参数**a**，你必须调用 **simplexml_load_file(rawurlencode('http://example.com/?a=' . urlencode('b&c')))** . 从 PHP 5.1.0 开始，您不需要这样做，因为 PHP 会为您完成。

[simplexml_load_file](http://php.net/manual/en/function.simplexml-load-file.php)

# sql - 为嵌套表创建过程

> ID：14344856
> 
> 赞同：0
> 
> 时间：2013-01-15T18:55:14.680
> 
> 标签：sql, oracle, stored-procedures, plsql

以下代码使用 sql*plus 成功创建了一个过程

```
CREATE OR REPLACE PROCEDURE input_order (pat_id in char, vis_vdate in date, vis_act in number,  
 vac_vacc in char)
AS
BEGIN
DBMS_OUTPUT.PUT_LINE ('Insert attempted');
insert into vaccinations(pid,vdate,action,vaccinated) values(pat_id,vis_vdate,vis_act,vac_vacc);
DBMS_OUTPUT.PUT_LINE ('Insert succeeded');
EXCEPTION
WHEN others THEN DBMS_OUTPUT.PUT_LINE ('error');
DBMS_OUTPUT.PUT_LINE ('Insert rejected');
END;
/ 
```

但是我的意图是创建一个类似的过程，其中包括将嵌套表填充为表的属性

*   例如：假设 'vis_act' 是一个嵌套表
*   类型为 vis_set_t
*   和属性 visname 和 visurname

我用这种方式尝试过，但一直出错

```
CREATE OR REPLACE PROCEDURE input_order (pat_id in char, vis_vdate in date, vis_act in 
vis_set_t, vac_vacc in char)
AS
BEGIN
DBMS_OUTPUT.PUT_LINE ('Insert attempted');
insert into vaccinations(pid,vdate,vis_set_t(visname,visurname),vaccinated) values
(pat_id,vis_vdate,vis_act,vac_vacc);
DBMS_OUTPUT.PUT_LINE ('Insert succeeded');
EXCEPTION
WHEN others THEN DBMS_OUTPUT.PUT_LINE ('error');
DBMS_OUTPUT.PUT_LINE ('Insert rejected');
END;
/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:47:35.070

一般插入示例。正如我在评论中提到的，我不确定您要在程序中完成什么。这是一般插入示例。随时问更多问题...：

```
DECLARE
  TYPE EmpTabTyp IS TABLE OF scott.emp%ROWTYPE;
  emp_tab EmpTabTyp:= EmpTabTyp();
--
PROCEDURE insert_emp(p_col_typ IN EmpTabTyp) 
IS
BEGIN
  SELECT * BULK COLLECT INTO emp_tab FROM scott.emp;
--
  FOR i IN p_col_typ.first .. p_col_typ.last 
  LOOP
    -- Insert your values into your table --
    INSERT Into emp_test (empno, ename) VALUES (p_col_typ(i).empno, p_col_typ(i).ename);

  -- Optionally display values inserted - do not do this if table has many rows --
  --DBMS_OUTPUT.put_line('INSERTED :'|| p_col_typ(i).empno||chr(9)||p_col_typ(i).ename);
   END LOOP;

   DBMS_OUTPUT.put_line('Total rows inserted :'||p_col_typ.Count);
 END insert_emp;
BEGIN
  insert_emp(emp_tab);
END;
/ 
```

除了我上面的评论：

```
DECLARE
  TYPE EmpTabTyp IS TABLE OF scott.emp%ROWTYPE;
  emp_tab EmpTabTyp:= EmpTabTyp();
PROCEDURE display_emp (p_col_typ IN EmpTabTyp) 
IS
BEGIN
  SELECT * BULK COLLECT INTO emp_tab FROM scott.emp;
--
  FOR i IN p_col_typ.first .. p_col_typ.last LOOP
    DBMS_OUTPUT.put_line(p_col_typ(i).empno||chr(9)||p_col_typ(i).ename);
  END LOOP;
 END display_emp;
BEGIN
  display_emp(emp_tab);
END;
/

DECLARE
  l_names   DBMS_UTILITY.maxname_array; -- or DBMS_UTILITY.name_array
PROCEDURE show_contents (names_in IN DBMS_UTILITY.maxname_array)
IS
BEGIN
  FOR indx IN names_in.FIRST .. names_in.LAST
  LOOP
    DBMS_OUTPUT.put_line (names_in (indx));
  END LOOP;
END;
BEGIN
  l_names (1) := 'Picasso';
  l_names (2) := 'Keefe'; 
  l_names (3) := 'Dali';
  show_contents (l_names);
END;
/

-- returning collection type example:
DECLARE
  TYPE t_emptbl IS TABLE OF scott.emp%rowtype;
  v_emptbl t_emptbl; 
  ret_val  t_emptbl; 
Function getEmployeeList Return t_emptbl 
IS
BEGIN
  SELECT * bulk collect INTO v_emptbl FROM scott.emp;
  -- Print nested table of records:
  FOR i IN 1 .. v_emptbl.COUNT LOOP
    DBMS_OUTPUT.PUT_LINE (v_emptbl(i).empno);
  END LOOP;
 RETURN v_emptbl;
END;
BEGIN
  ret_val:= getEmployeeList;
END;
/ 
```

# facebook - 为什么此 FQL 不返回页面信息？

> ID：14344877
> 
> 赞同：0
> 
> 时间：2013-01-15T18:56:29.213
> 
> 标签：facebook, facebook-fql, social-networking

为什么这两个查询都不返回结果？

```
select page_id from page where username="coorslight"

select username from page where page_id=8310601338 
```

如果我将浏览器指向[http://www.facebook.com/coorslight](http://www.facebook.com/coorslight) ，我会看到他们的页面。我通过喜欢他们然后查询我的喜欢找到了他们的page_id（8310601338）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:13:54.253

这两个查询在[Graph API Explorer](https://developers.facebook.com/tools/explorer?fql=select%20username%20from%20page%20where%20page_id%3D%228310601338%22)中对我来说都很好- 检查您是否忘记为可以实际看到该页面的用户使用访问令牌 - 该页面来自酒精品牌，因此可能仅限于 >21 的用户在美国，用户 > 18 在英国等。您必须使用符合限制的用户的访问令牌才能看到该页面。

# inno-setup - 无法让 DelTree 删除 Inno Setup 中的文件夹

> ID：14344889
> 
> 赞同：3
> 
> 时间：2013-01-15T18:57:28.857
> 
> 标签：inno-setup

我有一个`DeleteTransferFolder`在安装过程中使用 Inno Setup 中的 BeforeInstall 调用的过程。

我知道该过程被调用，因为我有几个 MsgBox 消息显示。但是 DelTree 不会删除指定的文件夹和子文件夹。

有什么想法吗 ？

```
procedure DeleteTransferFolder();
begin
  MsgBox('DeleteTransferFolder 1', mbInformation, MB_OK);

  if (FileExists ('{userdesktop}\RemedyNotes 1.0\RemedyNotes Old.remno')) then
    DelTree(ExpandConstant('{userdesktop}\RemedyNotes 1.0'), True, True, True);

  MsgBox('DeleteTransferFolder 2', mbInformation, MB_OK);    
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T21:20:25.943

您缺少 FileExists 行中的 ExpandConstant 调用，因此它返回 false ，因此不调用 DelTree。

显示第二个 MsgBox 是因为它超出了条件 if（可能是由于缺少开始/结束对）。

因此，将您的代码更改为：

```
procedure DeleteTransferFolder();
begin
  MsgBox('DeleteTransferFolder 1', mbInformation, MB_OK);

  if (FileExists (ExpandConstant('{userdesktop}\RemedyNotes 1.0\RemedyNotes Old.remno'))) then
  begin
    DelTree(ExpandConstant('{userdesktop}\RemedyNotes 1.0'), True, True, True);
    MsgBox('DeleteTransferFolder 2', mbInformation, MB_OK);
  end;
end; 
```

# bash - 为什么要在脚本中设置环境变量？

> ID：14344890
> 
> 赞同：0
> 
> 时间：2013-01-15T18:57:31.227
> 
> 标签：bash

我看到许多添加`export JAVA_HOME=/usr/local/java/`到他们的 bash 脚本中。有人可以告诉我为什么这是必要的，如果我不这样做会发生什么？JAVA_HOME 已在我的 .bashrc 中设置。为什么我应该在我的脚本中再次指定这个？

感谢您对这个新手的任何帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:02:25.603

因为您可能正在启动一个新的 shell #!/bin/sh 可能是您脚本的第一行。检查您是否在脚本的第一行启动 bash。

# character-encoding - 一个二维码可以嵌入多少个字母数字字符？

> ID：14344892
> 
> 赞同：1
> 
> 时间：2013-01-15T18:57:39.873
> 
> 标签：character-encoding, qr-code, zxing, alphanumeric, zbar-sdk

根据下面的 Wiki

[QRC 存储数据](http://en.wikipedia.org/wiki/QR_code#Storage)

最多可存储 4,296 个字母数字字符。但是在尝试时，我无法以 L 的纠错级别继续超过大约 2220 个字符。

字母数字字符是否与数字字符不同。“123”、“XYZ”和“AB%”不都包含“三个”字符吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:18:30.377

如果您处于字母数字模式，则最大值为 4296。为此，您只能使用您发送的链接上列出的字符。您的示例肯定都是 3 个字符，并且适合字母数字字符集。

这可能是编码器的问题，或其他一些中间限制，例如您发送给编码器的 URL 的长度。

# javascript - 使 Sencha Touch 列表（或 ExtJS Grid）不观察存储和自动更新 UI？

> ID：14344897
> 
> 赞同：0
> 
> 时间：2013-01-15T18:57:58.173
> 
> 标签：javascript, extjs, sencha-touch-2

当我更新与 Sencha Touch 列表 (Ext.dataview.List) 关联的商店时，列表 UI 会自动更新（如在 MVVM 中）。

我正在创建一个移动应用程序，它有大量通过 websocket 传入的数据，并且商店经常更新。我相信即使只有一个字段发生更改，也会重新渲染整个列表项（使用 itemTpl）。正如您可能想象的那样，这非常慢，而且我的应用程序严重滞后。

我想通过列表禁用对商店的这种“观察”，并使用 innerHTML 自己更新列表项。有没有办法做到这一点？或者有没有办法在不更新 UI 的情况下更新商店？

我的另一个选择是限制数据，但这是最后的手段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:07:05.863

您想使用suspendEvents 和resumeEvents 方法。这些是通过 Observable mixin 提供的，可以在商店和列表中使用。使用 suspendEvents 停止任何事件（例如刷新列表）并使用 resumeEvents 重新开始监听。当恢复任何在暂停期间触发的事件时，将排队并再次触发，所以如果你想丢弃这些事件，那么你需要确保执行suspendEvents(false)。

通过innerHTML 手动更新将是一个巨大的痛苦，我建议您在加载商店时只执行suspendEvents，并且每当您想要更新列表时只需resumeEvents 并从商店手动刷新它。

请参阅[此链接](http://docs.sencha.com/touch/2-1/#!/api/Ext.mixin.Observable-method-suspendEvents)以进一步阅读。

# c++ - SwitchTothread Windows 的 Linux 选项

> ID：14344899
> 
> 赞同：2
> 
> 时间：2013-01-15T18:58:02.663
> 
> 标签：c++, linux, windows, linux-kernel

Windows 提供了一个函数 SwitchTothread，它提供了运行/调度较低优先级线程的机会。有人知道Linux中的选项吗？ [http://msdn.microsoft.com/en-us/library/windows/desktop/ms686352%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686352%28v=vs.85%29.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:02:18.987

That would be [pthread_yield()](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_yield.3.html).

The difference being that `SwitchToThread()` returns nonzero if a thread switch occurred and zero otherwise, whereas `pthread_yield()` returns zero on success and nonzero on error (and always succeeds on Linux for now).

# java - 当从可运行对象调用时，Java 断言不发送到控制台

> ID：14344901
> 
> 赞同：6
> 
> 时间：2013-01-15T18:58:08.730
> 
> 标签：java, assert, runnable

在我的程序中，我从一个可运行的程序中创建了一个断言（评估结果为假），但从未看到任何关于断言的控制台输出。我想知道我的断言是否为假，但似乎 runnable 正在捕获所有抛出的断言？

下面是我可以编写来演示的最简单的示例程序。（断言已启用。如果未启用，则程序的行为会有所不同，并打印两行而不是仅一行）。程序的输出是。

即将断言 False

而已。之后，断言语句抛出并被某些东西捕获，我永远不知道它。我想知道它，我做错了什么？

```
import java.nio.ByteBuffer;
import java.util.concurrent.*;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

import java.awt.FlowLayout;
import javax.swing.*;

class App
{
  private static final ScheduledExecutorService sExecutor =
    Executors.newSingleThreadScheduledExecutor();

  // Main
  public static void main(String[] args)
  {
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() { createAndShowGUI(); } });

  }

  // Swing GUI
  private static void createAndShowGUI()
  {
    // Just create a swing thing. Boring
    JFrame frame = new JFrame("Title String");
    JLabel label = new JLabel("Hello World");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().add(label);
    frame.getContentPane().setLayout(new FlowLayout());
    frame.pack();
    frame.setVisible(true);

    // ********************************************
    // INTERESTING CODE HERE. We schedule a runnable which assert's false
    // but we never see a console assert error!
    // ********************************************
    sExecutor.schedule(new Runnable()
      { @Override public void run() { doAssertFalse(); }}, 0, TimeUnit.SECONDS);

  }

  public static void doAssertFalse()
  {
    System.out.println("About to assert False");
    assert false;
    System.out.println("Done asserting False");
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:27:13.243

这将做到：

```
private static final ScheduledExecutorService sExecutor =
        Executors.newSingleThreadScheduledExecutor();

// Main
public static void main(String[] args)
{
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            try {
                createAndShowGUI();
            } catch (ExecutionException e) {
                e.printStackTrace();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        } });

}

// Swing GUI
private static void createAndShowGUI() throws ExecutionException, InterruptedException {
    // Just create a swing thing. Boring
    JFrame frame = new JFrame("Title String");
    JLabel label = new JLabel("Hello World");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().add(label);
    frame.getContentPane().setLayout(new FlowLayout());
    frame.pack();
    frame.setVisible(true);

    // ********************************************
    // INTERESTING CODE HERE. We schedule a runnable which assert's false
    // but we never see a console assert error!
    // ********************************************
    ScheduledFuture<?> future = sExecutor.schedule(new Runnable() {
        @Override
        public void run() {
            doAssertFalse();
        }
    }, 0, TimeUnit.SECONDS);
    future.get();

}

public static void doAssertFalse()
{
    System.out.println("About to assert False");
    assert false;
    System.out.println("Done asserting False");
} 
```

请注意，我将结果保存`schedule`到`ScheduledFuture`变量中。`get()`除非您在将来调用该方法，否则不会返回异常。所有异常都抛出包裹在一个`ExecutionException`.

不幸的是，这会阻塞，所以另一种获得异常的方法是这样的：

```
// Swing GUI
private static void createAndShowGUI() {
    // Just create a swing thing. Boring
    JFrame frame = new JFrame("Title String");
    JLabel label = new JLabel("Hello World");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().add(label);
    frame.getContentPane().setLayout(new FlowLayout());
    frame.pack();
    frame.setVisible(true);

    // ********************************************
    // INTERESTING CODE HERE. We schedule a runnable which assert's false
    // but we never see a console assert error!
    // ********************************************
    sExecutor.schedule(new Runnable() {
        @Override
        public void run() {
            try {
                doAssertFalse();
            } catch (Error e) {
                e.printStackTrace();
            }
        }
    }, 0, TimeUnit.SECONDS);

}

public static void doAssertFalse() {
    System.out.println("About to assert False");
    assert false;
    System.out.println("Done asserting False");
} 
```

请注意，我正在捕获错误，而不是异常。我这样做是因为断言抛出 java.lang.AssertionError，而不是 *Exception。

我在 Javadoc 中找不到任何文档说 ScheduledExecutorService 吞下异常，除非您执行这些操作，但通过我的测试似乎是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T21:20:42.433

线程对异常不做任何事情（他们怎么可能？如果您不使用 STDERR 或 STDOUT 但登录到数据库怎么办， Thread.run() 怎么知道在哪里记录异常或将异常重新抛出给谁？）

您可以使用一个 Thread.UncaughtExceptionHandler ，当您这样做时，您的 Asserts 应该可以通过它。

我想问题在于 Assert 的机制正在使用异常，因此必须遵循预先确定的异常规则。就我个人而言，我不介意 Assert 是否只是打印了一个堆栈转储并执行了一个 exit(0)，因为无论如何您都不应该捕获该异常——但它就是这样。

请注意，您也可以对应用程序中的所有线程只使用一次 Thread.setDefaultUncaughtExceptionHandler（注意“DEFAULT”）......这应该是一个非常好的通用解决方案。

```
导入java.lang.*；

公共类 ThreadDemo {

   公共静态无效主要（字符串[]参数）{

     线程 t = 新线程（新 adminThread（））；

     t.setUncaughtExceptionHandler（新线程。
     UncaughtExceptionHandler() {
        公共无效未捕获异常（线程 t2，可抛出 e）{
           System.out.println(t2 + " 抛出异常：" + e);
        }
     });
     // 这将调用 run() 函数
     t.start();

   }
}

类 adminThread 实现 Runnable {

   公共无效运行（）{
      断言（假）；
      抛出新的 RuntimeException();
   }
}

```

当我运行这个“正常”时，它显示 RuntimeException 被抛出。当我使用“-ea”选项运行时，它会显示 AssertException。试试看。

# bash - 为什么查找迭代中的这个变量不改变它的值

> ID：14344902
> 
> 赞同：2
> 
> 时间：2013-01-15T18:58:34.300
> 
> 标签：bash, sed, find

我试图重命名所有文件，`find`但在我运行这个之后......

```
find . -name '*tablet*' -exec sh -c "new=$(echo {} | sed 's/tablet/mobile/') && mv {} $new" \; 
```

我发现我的文件不见了，将其更改`echo`为 $new 的值，发现它始终保留第一个文件的名称，因此它基本上将所有文件重命名为具有相同的名称

```
$ find . -name '*tablet*' -exec sh -c "new=$(echo {} | sed 's/tablet/mobile/') && echo $new" \;
_prev_page.tablet.erb
_prev_page.tablet.erb
_prev_page.tablet.erb
_prev_page.tablet.erb
_prev_page.tablet.erb
_prev_page.tablet.erb
_prev_page.tablet.erb 
```

也尝试更改为`export new=...`，相同的结果

为什么价值没有`new`变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:14:47.607

我认为的问题是命令替换由 bash 扩展一次，然后 find 在每次调用中使用结果。我可能是错误的原因。

当我在写出 shell 脚本之前有类似的东西时，例如

```
#! /bin/bash
old="$1"
new="${1/tablet/mobile}"
if [[ "${old}" != "${new}" ]]; then
    mv "${old}" "${new}"
fi 
```

负责重命名文件，然后我可以从 find 命令调用该脚本

```
find . -name "*tablet*" -exec /path/to/script '{}' \; 
```

使事情变得更容易整理。

编辑：

哈哈，在搞砸了引用之后，您可以通过将双引号更改为封装命令的单引号来解决这个问题。就像 $() 由 shell 命令扩展一样。如果按照以下方式完成命令替换，则由 exec 调用的 shell 完成。

```
find . -name "*tablet*" -exec sh -c 'new=$( echo {} | sed "s/tablet/mobile/" ) && mv {} $new' \; 
```

所以问题与命令替换何时扩展有关，通过将其放在单引号中，我们强制在每次调用 sh 时进行扩展。

# mysql - 合并来自同一个表的两个查询？

> ID：14344903
> 
> 赞同：0
> 
> 时间：2013-01-15T18:58:36.367
> 
> 标签：mysql

我有一个 MySQL 表，其中记录了回答问题的用户以及试验次数。就像是：

```
username trials
-------- ------
user1    10
user2    7
user1    20 
```

等等。从中我可以计算出他们回答问题的次数（`COUNT`）。现在我想计算平均试验次数，即得到下表：

```
username avg
-------- ---
user1    15
user2    7 
```

我试过这个查询：

```
SELECT(a.totalguess/b.totalknow) as avg FROM( SELECT username, SUM(trials) AS totalguess FROM thetable GROUP BY username) a, (SELECT username, COUNT(*) as totalknow FROM thetable GROUP BY username)b WHERE a.username=b.username; 
```

它只给了

```
avg
---
15
7 
```

八九不离十！但没有知情者。我可能可以将它们与 php 结合起来，但我想要一个纯 MySQL 解决方案。所以我该怎么做？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:05:03.257

```
SELECT username as knower, AVG(trials) as theavg
FROM mytable
GROUP BY username 
```

会给你这个：

```
knower, theavg

user1, 15
user2, 7 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:01:37.593

```
SELECT a.knower, (a.totalguess/b.totalknow) as avg 
FROM (SELECT knower, SUM(trials) AS totalguess FROM thetable GROUP BY knower) a, 
     (SELECT knower, COUNT(*) as totalknow FROM thetable GROUP BY knower)b 
WHERE a.knower=b.knower; 
```

或者简单地说：

```
SELECT knower, SUM(trials)/COUNT(*) as avg -- or you can just use AVG(trials)
FROM thetable 
GROUP BY knower 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T19:04:15.680

您可以在一个查询中执行此操作：

```
 SELECT knower, SUM(trials)/count(*)
      from thetable
      group by knower 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:04:07.317

您的初始 SELECT 语句确定将返回哪些列。现在你有

```
SELECT(a.totalguess/b.totalknow) as avg FROM ... 
```

所以你只会得到一个名为“avg”的列。因此，将知道者添加到您的选择列表中。

```
SELECT a.knower as knower,
       (a.totalguess/b.totalknow) as avg
FROM
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T19:04:43.617

```
SELECT knower, AVG(trials) FROM thetable GROUP BY knower 
```

# domain-driven-design - 为什么允许在以后执行跨越聚合的一致性规则？

> ID：14344904
> 
> 赞同：2
> 
> 时间：2013-01-15T18:58:40.790
> 
> 标签：domain-driven-design, aggregateroot

从：

> 不变量是在数据更改时必须维护的一致性规则，将涉及 AGGREGATE 成员之间的关系。任何跨越 AGGREGATES 的规则都不会一直是最新的。通过事件处理、批处理或其他更新机制，可以在某个指定时间内解决其他依赖关系。但是在 AGGREGATE 中应用的不变量将随着每个事务的完成而强制执行。

a）我将其解释为，旨在保持多个聚合之间的一致性的规则不必在这些聚合之一将其更改保存到某些持久性存储时强制执行，而是可以在稍后的某个时间强制执行这个聚合已经用持久存储完成了它的事务？

b）但是为什么可以容忍这种行为，因为它会导致数据不一致/损坏？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:32:17.463

一种）。正确的。聚合可以定义为一致性边界。该边界之外的事物（例如其他聚合）是那些可以作为后续事务的一部分进行可接受更新的实体。这是[最终的一致性](http://en.wikipedia.org/wiki/Eventual_consistency)。

乙）。通常，从业务角度来看，暂时过时的数据是可以接受的，应该明确讨论。此外，不一致实际上表现在通常被认为是一致的地方。例如，一旦您从某个服务请求数据并接收它，除非有环境事务，否则数据可能会不一致。如果请求的资源是远程的，则事务将不得不被分发，因此受到[2PC](http://en.wikipedia.org/wiki/Two-phase_commit_protocol)的所有缺陷的影响。

查看 Udi Dahan[关于事件驱动架构的文章，](http://msdn.microsoft.com/en-us/architecture/aa699424.aspx)该文章从业务角度讨论了最终一致性。

# java - 如何从 Eclipse Juno 调用 lib.so

> ID：14344906
> 
> 赞同：2
> 
> 时间：2013-01-15T18:58:47.607
> 
> 标签：java, android, eclipse

java和我有自己的.so文件，我做了一个新的android项目，我导入了class.java和`lib\armeabi\lib.so`我试图编译它的so文件，但我得到了关于**找不到库的**错误。

我做了很多搜索，发现制作了一个新的so文件。我有头文件，然后我去了 androidtools 添加本机支持并创建了空 cpp。我将标头内容复制到 cpp 然后在 android.mk 中我匹配了 nessecary 然后我编译了我得到了一些错误

```
java.lang.UnsatisfiedLinkError: Couldn't load FXTEST from loader dalvik.system.PathClassLoader[dexPath=/data/app/com.example.fxtest-.apk,libraryPath=/data/app-lib/com.example.fxtest-2]: findLibrary returned null 
```

我创建了`jni_onload`方法，但仍然有错误任何想法？如果你想要一些照片，请告诉我，我会附上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:35:56.233

我想您可能会尝试使用以下 java 选项为 Java 提供本机库的路径：

```
-Djava.library.path=/Path/To/You/File 
```

我不是安卓开发者，所以我可能错了。

# orchardcms - Orchard CMS 预热授权异常

> ID：14344917
> 
> 赞同：2
> 
> 时间：2013-01-15T18:59:39.837
> 
> 标签：orchardcms

我有一个设置为定期生成热身页面的 Orchard 站点。

当后台进程试图删除旧的预热文件时，我看到了许多 UnauthorizedAccessExceptions。

有人能指导我在哪里可以在 IIS 中为此授予相关权限吗？该站点由我可以访问的共享托管环境托管，尽管不是管理员。

```
    2013-01-15 18:44:09,078 [18] Orchard.Tasks.BackgroundService - 处理后台任务时出错
Orchard.OrchardCoreException：无法为“App_Data”文件夹中的文件“d:\virtualservers\xxxxx\xxxxxx\wwwroot\App_Data\Sites\Default\warmup.txt.lock”腾出空间---> System.UnauthorizedAccessException：访问路径 'd:\virtualservers\xxxxx\xxxxxx\wwwroot\App_Data\Sites\Default\warmup.txt.lock' 被拒绝。
   在 System.IO.__Error.WinIOError（Int32 错误代码，字符串可能全路径）
   在 System.IO.File.InternalDelete（字符串路径，布尔检查主机）
   在 c:\Users\sebros\My Projects\Orchard\src\Orchard\FileSystems\AppData\AppDataFolder.cs:line 79 中的 Orchard.FileSystems.AppData.AppDataFolder.MakeDestinationFileNameAvailable(String destinationFileName)
   --- 内部异常堆栈跟踪结束 ---
   在 c:\Users\sebros\My Projects\Orchard\src\Orchard\FileSystems\AppData\AppDataFolder.cs:line 82 中的 Orchard.FileSystems.AppData.AppDataFolder.MakeDestinationFileNameAvailable(String destinationFileName)
   在 c:\Users\sebros\My Projects\Orchard\src\Orchard\FileSystems\LockFile\L 中的 Orchard.FileSystems.LockFile.LockFile.Release()
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T10:57:37.057

这是 IIS 中的权限问题。

由于该站点托管在共享托管服务提供商上，因此我不得不联系他们以解决权限问题。

如果他们在日志中看到这些错误，希望对其他人有用。

# java - 将 ListView 放入 Horizo ntalScrollView 的最佳方法是什么？

> ID：14344918
> 
> 赞同：2
> 
> 时间：2013-01-15T18:59:43.113
> 
> 标签：java, android, listview, horizontalscrollview

我正在尝试制作一个日历应用程序，并希望在 ListView 上列出一天中的所有事件并水平滚动这些天。当我向右滚动时，ListView 应该重新绘制明天的事件。我的所有事件都在 sqllite 数据库中。

这就是我的 XML 的样子：

```
<?xml version="1.0" encoding="UTF-8"?>       

<HorizontalScrollView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scrollview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" 
    android:scrollbars="none">

    <LinearLayout
        android:id="@+id/layout"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Medium Text"
            android:gravity="center"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <ListView android:id="@+id/list"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />

    </LinearLayout>

</HorizontalScrollView> 
```

如何填充 ListView 并在每次滚动时获取新数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:01:42.970

方法不对，不能将 ListView 嵌套在 ScrollView 中。使用 ViewPager 来分页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T01:44:24.630

我在 API 15 和 18 中的 Horizo​​ntalScrollView 中使用了 ListView。这两个视图似乎都能识别它们所需的手势，所以它可以工作。然而，我注意到的一件事是 ListView 的宽度仅与列表中的第一行一样宽。如果后续行更宽，则“额外”（超过第 1 行的长度）将不可见，但是您可以滚动查看剩余的文本等……我没有注意到任何其他不良影响。

# delphi - FM2 Object Repaint Issue

> ID：14344920
> 
> 赞同：1
> 
> 时间：2013-01-15T18:59:55.957
> 
> 标签：delphi, firemonkey, delphi-xe3, firemonkey-fm2

Good evening guys.

I'm currently designing a social networking client for Twitter and Facebook in `Firemonkey FM2` (delphi) and I'm experiencing a frustrating issue. At present, I've only got the Twitter code in process, but the issue is related to the [re]drawing of visual objects.

I've created a custom-styled `TListboxItem` layout in a stylebook consisting of multiple child components such as `TText`, `TButton`, and `TImage`. I've already dealt with connecting to Twitter and retrieving feed details. Each item retrieved is added to a `TListbox` and styled using my custom ListboxItem style layout.

Now, the issue is related to updating information on items in the list that aren't visible. For example, the items that are visible in the list without scrolling show their information correctly. Those that aren't visible **besides** the final item in the list have several of their details not set/visible. When I scroll the list downwards, and then back up, there's often 1 of the items that was originally visible will now be missing it's information.

To explain this a little more, i've got a TImage *(known as photo)* which is used to show the photo of the person who posted the 'tweet'. I've got the standard TText *(known as text)* used to show the contents/text of the tweet itself. I've got 2 buttons *(known as Like and Share)* used to perform their respective functions. I've then finally got another TText *(known as NameDate)* used to show the name of the tweeter and the date the tweet was posted.

I'm using this code to create the object and modify the data it shows;

```
 for i := 0 to TwitObj.Statuses.Count-1 do
  begin
    FeedItem := TListBoxItem.Create(LBFeed);
    FeedItem.Parent := LBFeed;
    FeedItem.StyleLookup := 'FeedItem';
    FeedItem.WordWrap := True;
    FeedItem.StyledSettings := [TStyledSetting.ssFamily, TStyledSetting.ssSize, TStyledSetting.ssStyle, TStyledSetting.ssFontColor, TStyledSetting.ssOther];
    NameDate := Feeditem.FindStyleResource('txtnamedate') as TText;
    Photo := FeedItem.FindStyleResource('photo') as TImage;
    Like := FeedItem.FindStyleResource('btnlike') as TButton;
    Share := FeedItem.FindStyleResource('btnshare') as TButton;
    Share.Text := 'Retweet';
    Like.Text := 'Favorite';
    NameDate.Text := Twitobj.Statuses.Items[i].User.Name +
                     '(@'+TwitObj.Statuses.Items[i].User.ScreenName+
                     ') - '+DateTimeToStr(TwitObj.Statuses.Items[i].CreatedAt);
    FeedItem.Text := TwitObj.Statuses.Items[i].Text;

    begin
      if DirectoryExists('imagecache\') = false then CreateDir('imagecache\');
      if FileExists('imagecache\'+TwitObj.Statuses.Items[i].User.ScreenName+'.jpg') = False then
      begin
        try
          rcv := TMemoryStream.Create;
          GtPhoto.URL := TwitObj.Statuses.Items[i].User.ImageURL;
          GtPhoto.RcvdStream := rcv;
          GtPhoto.Get;
          rcv.SaveToFile('imagecache\'+TwitObj.Statuses.Items[i].User.ScreenName+'.jpg');
        finally
          Rcv.Free;
        end;
      end;
    end;
    Photo.Bitmap.LoadFromFile('imagecache\'+TwitObj.Statuses.Items[i].User.ScreenName+'.jpg'); 
```

`GTPhoto` is a standard ICS HTTP Client component, while TwitObj is my Twitter component. You can see that I'm saving the photo to a directory instead of streaming it. This was merely to check whether it was an issue with streams, but it's probably advisable to used a cache of some sort anyway.

The images download correctly, and the information for the relevant StyleResources in the custom ListBoxItem layout is updated as expected, but only for items that are visible without scrolling. If I scroll down the list, only the `Text` of each item is correct, while the other resources which were set at runtime have returned to the way they're designed in the stylebook (i.e. blank text, image, etc).

Am I missing something here? I understand the design intents of Bitmaps were changed in XE3 for the sake of performance, but surely Embarcadero wouldn't have overlooked something like this. Surely it's not expected for us to create each item inside the parent at runtime (and thus dealing with alignments and such) instead of using a stylebook resource, is it?

Any assistance or insight would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:23:50.690

FireMonkey 可以随时加载和卸载控件的样式。这在 FM1 中相当松懈，但在 FM2 中，当控件不可见时会删除样式元素，并在控件再次可见时重新应用（为了节省内存，主要是为 Mobile Studio 做准备）。

您需要做的是覆盖 ApplyStyle 方法。在其中查找并设置样式元素中的数据。这可能意味着您的控件需要缓存将传递给样式的内容。

另请注意，如果您正在缓存对样式元素的引用（即您从 FindStyleResource 返回的内容），那么当样式被卸载并且您的指针将无效时，这些将被释放。如果是这样，您需要覆盖 FreeStyle 并清除您可能缓存的任何指针。

# wget - wget for windows 7? trusted source

> ID：14344921
> 
> 赞同：16
> 
> 时间：2013-01-15T19:00:02.340
> 
> 标签：wget, windows-7-x64

I am looking for wget for windows 7, 64 bit.

GNU wget has a package for for windows 32 bits, and it can be downloaded from sourceforge. But my computer does not meet the system requirements: [http://gnuwin32.sourceforge.net/install.html](http://gnuwin32.sourceforge.net/install.html)

Could you suggest a trusted source to download it from?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-04T05:54:01.180

您可以从**Cygwin 64 位**软件包安装程序下载**Wget 。**

 **[http://cygwin.com/install.html](http://cygwin.com/install.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T22:10:41.453

你在这里试过这个版本吗？ [http://www.alexlomas.com/blog/2005/08/64_bit_wget_for_windows/](http://www.alexlomas.com/blog/2005/08/64_bit_wget_for_windows/)

> 但是请注意，这不包含 SSL 库，因此不适用于 https 站点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-07T20:01:07.770

[您可以从https://eternallybored.org/misc/wget/](https://eternallybored.org/misc/wget/)获得 1.16 版（截至今天）32 位和 64 位二进制文​​件**

# php - How do I join a table to this result?

> ID：14344924
> 
> 赞同：0
> 
> 时间：2013-01-15T19:00:09.763
> 
> 标签：php, mysql

I have a table as T1 and table as T2 like the following:

T1

```
-------------------------------------------------------
id | price  | email
-------------------------------------------------------
1  | $1000  | jacky@domain.com
2  | $2000  | angle@domain.com
3  | $3000  | kevin@domain.com
------------------------------------------------------- 
```

T2

```
-------------------------------------------------------
id | master | country | key   | value
-------------------------------------------------------
1  | 1      | US      | price | $399 
2  | 1      | US      | email | jacky/domain.us 
3  | 1      | ES      | price | $550 
4  | 1      | ES      | email | jacky@domain.es 
5  | 1      | JP      | price | $820 
6  | 1      | JP      | email | jacky@domain.jp 
7  | 2      | US      | price | $360 
8  | 2      | US      | email | angle@domain.us 
------------------------------------------------------- 
```

How to get this result:

T3

```
----------------------------------------------------------------------------------------------------------------------------
id | price  | price_US  | price_ES  | price_JP  | email            | email_US        | email_ES        | email_JP
----------------------------------------------------------------------------------------------------------------------------
1  | $1000  | $399      | $550      | $820      | jacky@domain.com | jacky@domain.us | jacky@domain.es | jacky@domain.jp
1  | $2000  | $360      | NULL      | NULL      | angle@domain.com | angle@domain.us | NULL            | NULL
1  | $3000  | NULL      | NULL      | NULL      | NULL             | NULL            | NULL            | NULL
---------------------------------------------------------------------------------------------------------------------------- 
```

Or can I get this result in PHP?

T4

```
-------------------------------------------------------
id | price  | email             | more_info
-------------------------------------------------------
1  | $1000  | jacky@domain.com  | [array (rows...)]
2  | $2000  | angle@domain.com  | [array (rows...)]
3  | $3000  | kevin@domain.com  | [array (rows...)]
------------------------------------------------------- 
```

Any idea?

# EDIT 1

Or can I get the result as the following?

T5 (US of country's result)

```
-------------------------------------------------------
id | price  | email
-------------------------------------------------------
1  | $399   | jacky@domain.us
2  | $360   | angle@domain.us
3  | $3000  | kevin@domain.com
------------------------------------------------------- 
```

T6 (JP of country's result)

```
-------------------------------------------------------
id | price   | email
-------------------------------------------------------
1  | $820    | jacky@domain.jp
2  | $2000   | angle@domain.com
3  | $3000   | kevin@domain.com
------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:05:10.420

这种类型的数据转换是一个*枢纽*。MySQL 没有数据透视函数，但您可以使用带有`CASE`表达式的聚合函数来复制它：

```
select t1.id,
  t1.price,
  max(case when t2.country = 'US' and `key` = 'price' then t2.value end) Price_US,
  max(case when t2.country = 'ES' and `key` = 'price' then t2.value end) Price_ES,
  max(case when t2.country = 'JP' and `key` = 'price' then t2.value end) Price_JP,
  t1.email,
  max(case when t2.country = 'US' and `key` = 'email' then t2.value end) Email_US,
  max(case when t2.country = 'ES' and `key` = 'email' then t2.value end) Email_ES,
  max(case when t2.country = 'JP' and `key` = 'email' then t2.value end) Email_JP
from table1 t1
left join table2 t2
  on t1.id = t2.master
group by t1.id, t1.price, t1.email 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/457b0/3)

编辑 #1，如果您只想使用连接而不是聚合函数，那么您的查询将类似于：

```
select t1.id,
  t1.price,
  P_US.value Price_US,
  P_ES.value Price_ES,
  P_JP.value Price_JP,
  t1.email,
  E_US.value Email_US,
  E_ES.value Email_ES,
  E_JP.value Email_JP
from table1 t1
left join table2 P_US
  on t1.id = P_US.master
  and P_US.country = 'US'
  and P_US.`key` = 'price'
left join table2 P_ES
  on t1.id = P_ES.master
  and P_ES.country = 'ES'
  and P_ES.`key` = 'price'
left join table2 P_JP
  on t1.id = P_JP.master
  and P_JP.country = 'JP'
  and P_JP.`key` = 'price'
left join table2 E_US
  on t1.id = E_US.master
  and E_US.country = 'US'
  and E_US.`key` = 'email'
left join table2 E_ES
  on t1.id = E_ES.master
  and E_ES.country = 'ES'
  and E_ES.`key` = 'email'
left join table2 E_JP
  on t1.id = E_JP.master
  and E_JP.country = 'JP'
  and E_JP.`key` = 'email' 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/457b0/15)

结果：

```
| ID | PRICE | PRICE_US | PRICE_ES | PRICE_JP |            EMAIL |        EMAIL_US |        EMAIL_ES |        EMAIL_JP |
------------------------------------------------------------------------------------------------------------------------
|  1 |  1000 |      399 |      550 |      820 | jacky@domain.com | jacky/domain.us | jacky@domain.es | jacky@domain.jp |
|  2 |  2000 |      360 |   (null) |   (null) | angle@domain.com | angle@domain.us |          (null) |          (null) |
|  3 |  3000 |   (null) |   (null) |   (null) |     kevin@domain |          (null) |          (null) |          (null) | 
```

编辑#2：要获得类似于`T5`and的结果`T6`，您将使用以下内容。`T6`替换`US`为`JP`：_

```
select t1.id,
  max(case when `key` = 'price' then value end) price,
  max(case when `key` = 'email' then value end) email
from table1 t1
left join table2 t2
  on t1.id = t2.master
where t2.country = 'US'
group by t1.id
union all
select t1.id,
  t1.price,
  t1.email
from table1 t1
where not exists (select t.id
                  from table1 t
                  left join table2 t2
                    on t.id = t2.master
                  where t2.country = 'US'
                     and t1.id = t.id); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/457b0/41)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:15:59.643

我想尝试给出表格之间的关系，然后再试一次。

# checkbox - how to swap the image and back (right away) when checkbox checked?

> ID：14344930
> 
> 赞同：1
> 
> 时间：2013-01-15T19:00:39.713
> 
> 标签：checkbox

I am looking for the javascript that change (image1) to (image2) and then back to (image1) right away when checkbox checked.

I have a code that swap the image when i checked the checkbox and going back to original image when checkbox is unchecked. But I want to change image and going back to original image right way when it checked. Can anyone help?

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript">
function changePic(){
if (document.form1.check.checked){
document.picture.src="Images/industry_mrt.jpg";
document.picture.src="Images/industry_ps.jpg";
}

else{
document.picture.src="Images/industry_mrt.jpg";
}}
</script>
</head>

<body>
<img src="Images/industry_ps.jpg" id="picture" name="picture"> 
<form name="form1" method="post" action="">
<input type="checkbox" name="check" value="checkbox" onClick="changePic();">
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:13:19.980

目前我相信您的代码确实具有预期的效果 - 更改图像，然后在选中复选框时立即返回原始图像，但如果您想看到这一点，您需要延迟返回原始图像。

试试下面的：

```
<form action="#" method="post">
    <input type="checkbox" onchange="handleChange(this);" />
</form>
<script type="text/javascript">
function handleChange(checkbox)
{
    if(checkbox.checked){
        document.picture.src="Images/industry_mrt.jpg";
        setTimeout(function(){document.picture.src="Images/industry_ps.jpg";}, 2000); // 2 Seconds.

    } else{
        document.picture.src="Images/industry_mrt.jpg";
    }
}
</script> 
```

# visual-studio-2010 - Prevent Windows registry key from removing when upgrading application to newer version

> ID：14344934
> 
> 赞同：0
> 
> 时间：2013-01-15T19:00:50.130
> 
> 标签：visual-studio-2010, registry, windows-installer

I have a registry key (in HKEY_LOCAL_MACHINE hive) which must be keeped from older version of the application to the newer, but removed when user completely uninstalls my application. I'm using Visual Studio 2010 setup and deployment project.

I know about increasing build version of the installation package, build version of assemblies and upgrading 'ProductCode'(but keeping 'UpgradeCode' the same). 'RemovePreviousVersion' is set to true. The problem is that when user installs the new version, registry key from previous version is removed (with important data in it) and recreated again. It seems that MSI uninstalls my application before installing the new version. I was tried to set 'RemovePreviousVersion' to false but in this case new version installed independently and both versions of the application appear on the same machine. It seems to be very common scenario but I couldn't find how to keep registry keys between different versions. If you know how to make this modifying MSI package using Orca it is not a problem (as Visual Studio is very restricted in creating installation packages).

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T06:23:18.777

延迟安排 RemoveExistingProducts 操作将解决您的问题。

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa371197(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa371197(v=vs.85).aspx)

# php - Return the total records with mysqli::num_rows

> ID：14344935
> 
> 赞同：1
> 
> 时间：2013-01-15T19:01:03.890
> 
> 标签：php, mysqli

why always $stmt->num_rows returns 0(zero), Whereas exist 2 records in **users** table. code:

```
 public function fetch_users()
    {
        if (!($stmt = $this->mysqli->prepare("SELECT * FROM users"))){
            echo "prepare failed: (" . $this->mysql->errno . ") " . $this->mysqli->error;
        }

        if (!$stmt->execute()) {
            echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
        }

        echo $stmt->num_rows;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T18:10:30.273

解决了这个变化：

```
public function fetch_users()
{
    if (!($stmt = $this->mysqli->prepare("SELECT * FROM users"))){
        echo "prepare failed: (" . $this->mysql->errno . ") " . $this->mysqli->error;
    }

    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    }

    $stmt->store_result();

    echo $stmt->num_rows;
} 
```

# windows - Windiws 8 search for contact by phone number

> ID：14344944
> 
> 赞同：2
> 
> 时间：2013-01-15T19:01:49.130
> 
> 标签：windows, windows-8

I know how to use the ContactPicker to pick a contact from the people app and get the contact details, but I do not know how to search for a contact and get the contact details by a phone number for example.

Anybody has some sample JavaScript code?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:36:49.990

我认为没有任何方法可以搜索或遍历联系人。[您可以使用SearchPane.Show()](http://msdn.microsoft.com/en-us/library/windows/apps/br225096.aspx)打开“搜索”超级按钮并使用要搜索的电话号码为其播种，但“人脉”应用似乎不是按电话号码搜索的。您似乎也无法从 hotmail SDK 获取联系人的电话号码数据。

# ruby - 如何在Ruby中的函数调用期间将数组转换为字符串列表？

> ID：14344945
> 
> 赞同：0
> 
> 时间：2013-01-15T19:01:53.520
> 
> 标签：ruby, rrdtool, rrd

我正在尝试调用`RRD.create`Ruby。我的 RRD 变量存储在哈希中，我需要构造一个`RRD.create`调用。这是我的代码：

```
pool_map = {
  "cleanup"  => "Cleaning up",
  "leased" => "Leased",
  "ready"  => "Ready"
}

start = Time.now.to_i
ti = 60 # time interval, in seconds

RRD.create(
         rrdfile,
         "--start", "#{start - 1}",
         "--step",  ti, # seconds
         pool_map.keys.map{|val| "DS:#{val}:GAUGE:#{ti * 2}:0:U" }.collect,
         "RRA:LAST:0.5:1:#{86400 / ti}",         # detailed values for last 24 hours
         "RRA:AVERAGE:0.5:#{5*60 / ti}:#{7*24*60}", # 5 min averages for 7 days
         "RRA:MAX:0.5:#{5*60 / ti}:#{7*24*60}",     # 5 min maximums for 7 days
         "RRA:AVERAGE:0.5:#{60*60 / ti}:#{183*24}", # 1 hour averages for a half of the year
         "RRA:MAX:0.5:#{60*60 / ti}:#{183*24}"      # 1 hour maximums for a half of the year
        ) 
```

但是，我从 Ruby 收到以下错误：

```
in `create': invalid argument - Array, expected T_STRING or T_FIXNUM on index 5 (TypeError) 
```

我需要指定几个字符串`RRD.create`而不是传递数组。我怎样才能在 Ruby 中做到这一点？

PS [http://oss.oetiker.ch/rrdtool/prog/rrdruby.en.html](http://oss.oetiker.ch/rrdtool/prog/rrdruby.en.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:06:40.447

您想要“splat”运算符（一元星号）：

```
*pool_map.keys.map{|val| ...} 
```

请注意，您不需要`collect`在最后，它什么都不做！`collect`只是 的别名`map`，你没有用它做任何事情，因为你没有通过它一个块。

Splat 对于解构数组非常有用：

```
arr = [1, 2, 3]
a, b, c = *arr
# a = 1; b = 2; c = 3 
```

你可以经常使用它来为方法提供参数，就像你正在尝试做的那样

```
def sum_three_numbers(x, y, z)
  x + y + z
end

arr = [1, 2, 3]
sum_three_numbers(*arr)
# => 6

arr = [1, 2]
sum_three_numbers(100, *arr)
# => 103 
```

# c# - Socket.BeginSend does not complete synchronously despite plenty of buffer space

> ID：14344947
> 
> 赞同：1
> 
> 时间：2013-01-15T19:01:55.603
> 
> 标签：c#, sockets, asynchronous

Why does `Socket.BeginSend` go asynchronous so quickly and so unpredictably? I know it's supposed to be asynchronous, but it can also complete immediately, in which case `IAsyncResult.CompletedSynchronously` is set. I would expect `CompletedSynchronously` to be true until the 8KB send buffer is filled up. The test case below (cleanup code stripped for brevity) demonstrates that `BeginSend` goes asynchronous on (typically) 3rd iteration after buffering only 6 bytes of data:

```
TcpListener listener = new TcpListener(IPAddress.Any, 35001);
listener.Start();
Socket client = new Socket(AddressFamily.InterNetwork,
    SocketType.Stream, ProtocolType.Tcp))
client.Connect(new IPEndPoint(IPAddress.Loopback, 35001));
Socket server = listener.AcceptSocket())
for (int i = 1; i <= 10; ++i)
{
    bool sent = false;
    IAsyncResult result = client.BeginSend(new byte[] { 1, 2, 3 }, 0, 3,
        SocketFlags.None, r => sent = true, null);
    Assert.IsTrue(result.CompletedSynchronously, // fails typ. on 3rd iteration
        String.Format("Asynchronous on iteration {0}", i));
    Assert.IsTrue(sent);
    client.EndSend(result);
} 
```

The exact iteration when it goes asynchronous is somewhat random. When process starts, it's 3\. Afterwards it's 1 for all new sockets. I've seen other numbers sporadically. I know the 8KB socket send buffer is there, because `Socket.Send` (with `Socket.Blocking = false`) stops at about 8KB.

Method `Socket.SendAsync` behaves similarly except it always completes asynchronously (i.e. no attempt at direct buffer write). See my [related question about Socket.SendAsync](https://stackoverflow.com/questions/14345297/when-does-socket-sendasync-complete-synchronously).

I need `BeginSend` to be mostly synchronous for performance reasons (asynchronous callbacks are slower). Not to mention the unpredictability ruins unit tests and benchmarks for my low-level communication code.

# c# - 从流阅读器中删除格式 (\t\r)

> ID：14344951
> 
> 赞同：0
> 
> 时间：2013-01-15T19:02:06.873
> 
> 标签：c#, .net, sql

我正在使用 StreamReader 将使用 SQLExplorer 创建的 .sql 文件导入到我的 .NET 程序中（最终将通过 OdbcConnection，仅供参考。）问题是，当我使用该`ReadToEnd()`方法时，它不仅导入 SQL 本身，而且它导入所有格式。所以弦上到处都是`\r`和`\t`之类的东西。

我一直在研究使用拆分或可能的正则表达式来分解字符串并删除不需要的点点滴滴。但在投入大量精力之前，我想知道 StreamReader 类中是否缺少一些东西？有没有办法告诉它忽略格式化字符？

这是我现在拥有的代码：

```
public static Object SQLQueryFileCall(String SQLQueryFileName){

        string SQLQuery = "";
        string directory = System.IO.Path.GetDirectoryName( System.Reflection.Assembly.GetExecutingAssembly().Location);
        SQLQueryFileName = directory + "\\" + SQLQueryFileName;

        //read in the file and pass to ODBC, return a Object[] of whatever comes back...
        try{
            using (StreamReader myStreamReader = new StreamReader(SQLQueryFileName)) {

                SQLQuery = myStreamReader.ReadToEnd();
                Console.WriteLine(SQLQuery);
            }
        }
        catch (Exception e){
            //Find the error
            Console.WriteLine("File could not be read:");
            string error = e.Message;
            MessageBox.Show(error);
            return null;
        }
} 
```

随意提供您对代码可能有的任何建议，因为我很新。

但是，是的，大多数情况下我只是希望 StreamReader 类中有一个我不理解的方法。我去了微软的在线文档，我觉得我已经很好地看了它，但话说回来，我是新人，也许这个概念跳过了我的脑海？

有什么帮助吗？

注意：`\t`有些行的中间有多个，确实需要删除。因此，使用修剪会......至少会很棘手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:11:13.833

好吧，`myStreamReader.ReadToEnd();`会给你一切。摆脱大多数不需要的空格的最简单方法是逐行读取，然后逐行读取`.Trim()`。

```
 using (StreamReader myStreamReader = new StreamReader(SQLQueryFileName)) 
 {
    string line;
    List<string> lines = new List<string();

    while ((line = myStreamReader.ReadLine()) != null)
        lines.Add(line.Trim());

    SQLQuery = string.Join("\n", lines);
    Console.WriteLine(SQLQuery);
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:28:38.447

根据定义，SQL 不应该在整个代码中出现制表符和换行符之类的空格问题。首先验证您的实际 SQL 是否正确。

此外，盲目地去除空格可能会对脚本中包含的文本数据产生影响；如果您有一个包含制表符的字符串文字会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:10:03.640

```
SQLQuery = Regex.Replace(SQLQuery, @"\t|\n|\r", ""); 
```

更好地使用，因为您可以删除 SQL 插入的内容：

```
using (StreamReader reader = new StreamReader(fileName)) 
{
   String line;
   List<string> lines = new List<string();

   while ((line = myStreamReader.ReadLine()) != null)
       SQLQuery += line.Trim() + "\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:30:03.627

```
 using (StreamReader myStreamReader = new StreamReader(SQLQueryFileName)) 
 {  
    while ((line = myStreamReader.ReadLine()) != null)
    {
        Console.WriteLine(line.Trim().Replace(@"\t"," ")
    }
 } 
```

如果是显示问题而不是内容问题，我认为您可以使用 WPF 和 RichTextBox。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-05T11:38:26.063

这就是在 2020 年帮助我的原因，以防有人在寻找这个

```
using (StreamReader sr = new StreamReader(stream))
{
   return Regex.Replace(sr.ReadToEnd().Trim(), @"\s", "");
} 
```

# c# - 使用 LINQ SQL 确定更新是否成功？

> ID：14344953
> 
> 赞同：1
> 
> 时间：2013-01-15T19:02:12.420
> 
> 标签：c#, sql, linq

我从教程中找到了这段代码：

```
Product bev1 = beverages.ElementAtOrDefault(10);
if (bev1 != null)
{
    Console.WriteLine("The price of {0} is {1}. Update to 20.0", 
                      bev1.ProductName, bev1.UnitPrice);
    bev1.UnitPrice = (decimal)20.0;
}
// submit the change to database
db.SubmitChanges(); 
```

我们如何知道更新是否成功？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:03:30.407

如果更新不成功，将抛出异常。如果没有抛出异常，则成功。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:06:35.833

**知道的一种方法**是**没有抛出异常**。

**第二种**确保方法是使用[GetChangeSet](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getchangeset.aspx)方法来获取数据上下文跟踪的修改对象。

**示例表单 msdn**

```
Northwnd db = new Northwnd(@"c:\northwnd.mdf");

var custQuery =
    from cust in db.Customers
    where cust.City == "London" 
    select cust;

foreach (Customer custObj in custQuery)
{
    Console.WriteLine("CustomerID: {0}", custObj.CustomerID);
    Console.WriteLine("\tOriginal value: {0}", custObj.City);
    custObj.City = "Paris";
    Console.WriteLine("\tUpdated value: {0}", custObj.City);
}

//get object modified 
ChangeSet cs = db.GetChangeSet();
Console.Write("Total changes: {0}", cs);
// Freeze the console window.
Console.ReadLine();

db.SubmitChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:06:52.040

这取决于您所说的“成功”是什么意思。如果成功的意思是“没有发生错误”，那么缺少异常会告诉您这一点。如果您的意思是“按照我的预期在数据库中更新了数据”，那么您需要离线查询数据库或创建另一个上下文并通过它运行查询以验证更改是否发生。

您可以编写不会产生异常但不会按照您期望的方式更新数据库的代码。

# visual-studio-2010 - 在 Visual Studio 的 ASP.net MVC 3 中更改起始页

> ID：14344955
> 
> 赞同：9
> 
> 时间：2013-01-15T12:38:28.670
> 
> 标签：visual-studio-2010, visual-studio, asp.net

目前我正在研究asp.net mvc，我错误地右键单击了我的cshtml文件并将其设置为开始页面，现在每当我运行它根据目录而不是控制器方式运行的页面时，我已经设置了**视图/home/simple.cshtml**作为起始页现在我按`CTRL`+`F5`然后它在浏览器中作为 view/home/simple.cshtml **而不是 Home/simple 控制器方式运行**

如何在 Visual Studio 中**将此设置重置为起始页**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T12:49:26.133

打开项目的属性，然后单击 web 选项卡。选择特定页面单选按钮。只需输入您要使用的网址！

或者，创建一个新的 MVC 项目并查看属性以查看它是如何设置为默认值的！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-25T18:48:19.707

打开项目选项卡“ **Web** ”的属性，然后选择“ **Specific Page** ”，然后单击“SVG Image Maps”。

不要使用visual studio ex建议的路径：“ `Views/Account/Login.cshtml`”。使用控制器/动作例如：“ `Account/Login`”。

或者

在“ **Web** ”中选择“ **CurrentPage** ”。

# com-interop - QB add sales tax to item

> ID：14344962
> 
> 赞同：0
> 
> 时间：2013-01-15T19:02:38.953
> 
> 标签：com-interop, quickbooks

I am exporting invoices from my app to QB local version. I cannot find any way to add sales tax, which is calculated in my app, to the QB invoice.

I am exporting multiple items (in my case services), to a new QB invoice and nothing related to sales tax seems to work - like QBFC12.IInvoiceAdd SalesTaxLineAdd, etc. - all "not available in this edition of QB".

Does QB allow me to add the sales tax, or will it only use the tax that is set for each of my items in QB?

-Rick

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T04:04:24.597

你问的不是一个真正的编程问题......它更像是一个会计问题。

**QuickBooks API 完全反映了 QuickBooks GUI。因此，无论您在 GUI 中添加销售税做什么，都应该在 API 中执行。** *你如何在 GUI 中做到这一点*？

Soooo ...让我们谈谈 QuickBooks*通常*在 GUI 中征收销售税：

*   您使用 NON（非应税）或 TAX（应税）的销售税代码标记每个行项目
*   在发票底部，您选择特定的销售税项目（例如“加利福尼亚销售税”）
*   QuickBooks 然后使用销售税项目*（可征税行项目的总和）中的税率为您计算税款

当您查看[QuickBooks OSR API 文档](http://developer.intuit.com/qbsdk-current/common/newosr/index.html)时，您应该不会感到非常惊讶，您会看到如下行项目定义：

```
<InvoiceLineAdd>
  ...
  <Amount>29.95</Amount>
  <SalesTaxCodeRef>
    <FullName>Tax</FullName> <!-- valid values here are one of your Sales Tax Codes, usually "NON" or "TAX" -->
  </SalesTaxCodeRef>
</InvoiceLineAdd> 
```

并且，在 InvoiceAdd 规范的底部，有一个用于指定销售税项目的选项，如下所示：

```
<ItemSalesTaxRef>
  <FullName>California Sales Tax</FullName>  <!-- valid values are any of your existing Sale Tax Items in QuickBooks -->
</ItemSalesTaxRef> 
```

*综上所述*，我们必须特别注意您问题的这一部分：

> 我找不到任何方法将**在我的应用程序中计算的**销售税添加到 QB 发票中。

上面的答案让 QuickBooks 根据税率与您在应用程序中已经计算的值计算*税额。*太好了……规则仍然有效——QuickBooks API 反映了 GUI。那么，*您现在如何在 GUI 中执行此操作*？

正确答案是：**问问你的会计师他想让你怎么做**。

答案很可能是：

*   创建一个名为“参考发票”的税率为 0% 的新销售税项目
*   向使用 ItemRef/FullName 的发票添加一个新行项目以引用正确的销售税项目（例如“加利福尼亚州税”）
*   在该行项目上，指定在您的应用中计算的实际税额

如果这就是他想要的，那么您应该在 GUI 中完全做到这一点。像对待任何其他发票行项目一样对待它。

# php - PHP MySQL - 我做错什么了吗？

> ID：14344968
> 
> 赞同：0
> 
> 时间：2013-01-15T19:02:50.213
> 
> 标签：php, mysql

现在两个小时，我正在尝试将一个值插入到表中。我没有收到任何错误，也找不到问题所在！

**我试图插入的值：**

```
$query = "INSERT INTO banlist (banid, active, ip, by, date, reason) VALUES (NULL, 1, '10.25.47.88', 'AUTOBAN', '12-12-45', 'test')";
mysql_query($query); 
```

**一个完美运行的示例值：**

```
$query = "INSERT INTO accounts (username, password, email, regdate) VALUES ('test', 'test', 'test@test.test', 't-t-t t:t:t')";
mysql_query($query); 
```

我找不到问题！我错过了什么吗？两个表都存在。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T19:06:06.767

问题是您为字段“by”选择的名称是保留字。您必须将其更新为不在[此列表](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)中的单词。

`mysql_query()`此外，将来您可以通过检查是否返回 false，然后调用`mysql_error()`错误消息来轻松查看问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:41:58.957

尝试这个：

```
 CREATE TABLE ban (
    banid int auto_increment primary key, 
    active int,
    ip varchar (20), 
    `by` varchar (20),
    `date` varchar(8),
    reason varchar(20)                                             
        );                                         

    INSERT INTO ban (active, ip, `by`, `date`, reason)
    VALUES 
    (1, '10.25.47.88', 'AUTOBAN', '12-12-45', 'test')
    ;

    SELECT * FROM ban; 
```

[http://www.sqlfiddle.com/#!2/1959f/1](http://www.sqlfiddle.com/#!2/1959f/1)

一些备注：

像其他几个人一样（例如@wintercounter、@user1909426）已经指出您在MySQL 中使用了受限字词。如果您确实使用了受限词，则使用 ``（反引号）或仅在每一列上使用它们。

我认为在插入的第一部分中使用 null 会产生问题。此列可能是带有 auto_increment 的整数列。请参阅@wintercounter 答案。

幸运的是，日期不是一个受限制的名称。顺便说一句，您现在可以使用日期值而不是 varchar 值。

关于@tadman 的评论，不推荐使用 mysql 而不是 mysqli 或 PDO。mysql 库从 PHP 5.5 版本开始被贬低，请参阅 php 手册。您还需要包括错误处理。

为了完整起见，这是使用 MySQLi 时的 php 代码：

```
 $link = mysqli_connect($hostname, $username, $password, $database);
  if (!$link){ 
  echo('Unable to connect to database');
  }

  else{
  mysqli_query("INSERT INTO ban (active, ip, `by`, `date`, reason) VALUES (1,'10.25.47.88', 'AUTOBAN', '12-12-45', 'test'))", $link); 
  }

  mysqli_close($link); 
```

对于 mysql 版本：

```
 $hostname = "hostname";
  $username = "username";
  $username = "password";
  $database = "database";

  $link = mysql_connect($hostname, $username, $password);
  mysql_database ($database)
  if (!$link){ 
  echo('Unable to connect to database');
  }

  else{
  mysql_query("INSERT INTO ban (active, ip, `by`, `date`, reason) VALUES (1,'10.25.47.88', 'AUTOBAN', '12-12-45', 'test')"); 
  }

  mysql_close($link); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:09:34.530

在每个变量中使用 mysql 错误语句以了解您的错误发生在哪一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:09:42.730

该查询可能不会显示错误，因为在您的 php.ini 中关闭了 error_reporting：

尝试将 error_reporting 设置为 E_ALL。

此外，查询可能不起作用，因为您正在发送“NULL”作为 banid 的值，这可能是不允许 NULL 值的主键或外键/索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T19:13:43.350

尝试这个：

```
INSERT INTO `banlist` (`banid`, `active`, `ip`, `by`, `date`, `reason`) VALUES ('', 1, '10.25.47.88', 'AUTOBAN', '12-12-45', 'test') 
```

如前所述，'by' 是保留关键字，但您可以在解析中帮助 MySQL，以便它知道它是字段名称还是命令。

编辑：我已将 NULL 更改为 ''。我不确定，从未尝试过，但如果它是一个 AI 字段，也许你不能在那里使用 NULL，只需使用一个空的内容作为 ID 字段的占位符。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-01-15T19:07:11.660

试试这个：

```
INSERT INTO banlist VALUES (NULL, 1, '10.25.47.88', 'AUTOBAN', '12-12-45', 'test') 
```

# c - 动态分配和访问指针数组？

> ID：14344969
> 
> 赞同：0
> 
> 时间：2013-01-15T19:03:02.100
> 
> 标签：c, arrays, pointers

例如我有

```
*line[30]; 
```

我想为每个指针分配一个 81 个字符的字符串。我该怎么做？我可以通过哪种方式访问​​第二个字符串，例如在 printf 中使用它？

另外`**a`，它是等价的吗？

我是新手，这可能是一个简单的问题，但我渴望学习。非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:31:40.823

`I want to allocate a string 81 characters for each pointer`

由于您知道所需的确切尺寸，因此可以静态执行此操作：

```
char line[30][81]; 
```

这为您提供了 30 个 81 个字符的数组。

```
strcpy(line[0], "hello");
strcpy(line[1], "world");

printf("%s\n", line[1]);  // prints the second string 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T19:06:18.567

下面的代码片段将为您提供帮助。

```
#define MAX_LINES 30
#define MAX_CHARS 81
...
char * line[MAX_LINES];
int i;
for (i = 0; i < MAX_LINES; i++)
{
    line[i] = malloc(sizeof(char) * MAX_CHARS);
} 
```

使用相同的`for`循环访问每一行。`line[1]`将访问第二个字符串（即行）。

# cocoa - theEvent charactersIgnoringModifiers - 获取没有修饰符的字符

> ID：14344970
> 
> 赞同：5
> 
> 时间：2013-01-15T19:03:04.683
> 
> 标签：cocoa, keydown, shift, modifier-key

我试图在我的游戏中实现一个有两种模式的键盘类。游戏模式接受使用小写、未修改键的输入（未修改的意思是，如果我输入一个“0”，它仍然返回“0”而不是“）”）。`charactersIgnoringModifiers`就使用该类的方法而言，我已经对其进行了跟踪，`NSEvent`但是此方法排除了除 shift 键之外的所有修饰键。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T23:44:21.870

您可以使用`-[NSEvent keyCode]`键码，然后将其转换为字符，而无需使用任何修饰符。做后者说起来容易做起来难。 这是一个关于技术和陷阱[的长邮件列表线程。](http://lists.apple.com/archives/cocoa-dev/2008/Apr/msg01538.html)

# bash - Unix sed 命令查找和替换模式

> ID：14344972
> 
> 赞同：1
> 
> 时间：2013-01-15T19:03:08.490
> 
> 标签：bash, shell, unix, sed

我正在尝试匹配以下之间有空格的模式。

```
 -DsomeArg=some value 
```

并使用 sed 命令将其替换为以下模式。

```
 -DsomeArg="some value" 
```

中间可以有任意数量的空格。我尝试了以下命令，但它不起作用。

```
 sed 's/^\(-D.*\)=(.\+\s\+.\+)/\1="\2"/' test.dat 
```

其中 .* 代替 .+ 起作用，但我想匹配一个或多个模式。我无法找到我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:09:52.187

```
cat /tmp/test | sed -r 's/^(-D.*?)=(.+\s+.+)/\1="\2"/'
-DsomeArg="some value" 
```

希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T06:29:06.823

这可以满足您的要求：

```
sed 's/=\(.*\)/="\1"/' 
```

或更短一点：

```
sed 's/=/="/;s/$/"/' 
```

但我觉得这个故事比你说的要多。就像，您是否希望某些文本跟在您想要保留在引号之外的“某个值”之后？之前是否`-DsomeArg`有您不想匹配的内容？

使用正则表达式，上下文就是一切。

# c# - 以编程方式模拟 Web 服务的固定 Windows 身份

> ID：14344973
> 
> 赞同：1
> 
> 时间：2013-01-15T19:03:13.840
> 
> 标签：c#, web-services

我有一个 Web 服务（旧的 Web 服务，而不是 WCF），并且我正在使用 IIS 7.0 与该 Web 服务进行通信。IIS 7.0 中仅启用了 Windows 身份验证（甚至禁用了匿名）。在进行服务调用时，我需要能够在代码中指定特定的 Windows 身份。我发现很多地方表明这可以通过以下方式在配置文件中完成......

```
<authentication mode="Windows" />
<identity impersonate="true" userName="UserName" password="P@ssw0rd" /> 
```

但我需要在代码中做同样的事情。我相信很多人都在想“你为什么要那样做”。无需进行冗长的解释，最简单的答案是因为这些是我的要求。

这是我的代码的样子......

```
HttpTransportBindingElement transport = useHttps ? new HttpsTransportBindingElement() : new HttpTransportBindingElement();
transport.ManualAddressing = false;
transport.MaxBufferPoolSize = 134217728; // 128MB
transport.MaxReceivedMessageSize = 134217728; // 128MB
transport.AllowCookies = false;
transport.AuthenticationScheme = AuthenticationSchemes.Negotiate;
transport.BypassProxyOnLocal = false;
transport.DecompressionEnabled = true;
transport.HostNameComparisonMode = HostNameComparisonMode.StrongWildcard;
transport.KeepAliveEnabled = true;
transport.MaxBufferSize = 134217728; // 128MB,
transport.ProxyAuthenticationScheme = AuthenticationSchemes.Negotiate;
transport.Realm = "";
transport.TransferMode = TransferMode.Buffered;
transport.UnsafeConnectionNtlmAuthentication = false;
transport.UseDefaultWebProxy = false;

TextMessageEncodingBindingElement encoding = new TextMessageEncodingBindingElement
{
    MaxReadPoolSize = 64,
    MaxWritePoolSize = 16,
    MessageVersion = MessageVersion.Soap12,
    WriteEncoding = Encoding.UTF8,
    ReaderQuotas = new XmlDictionaryReaderQuotas
    {
        MaxDepth = 32,
        MaxStringContentLength = 134217728, // 128MB
        MaxArrayLength = 134217728, // 128MB
        MaxBytesPerRead = 4096,
        MaxNameTableCharCount = 16384
    }
};

CustomBinding binding = new CustomBinding();
binding.Elements.Add(encoding);
binding.Elements.Add(transport);

ServicePointManager.Expect100Continue = false;

generalSoapClient general = new generalSoapClient(binding, new EndpointAddress("http://localhost/site/ws/general.asmx"));
NetworkCredential iisCredentials = new NetworkCredential("UserName", "P@ssw0rd");
general.ClientCredentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Impersonation;
general.ClientCredentials.Windows.ClientCredential = iisCredentials;
string session = general.CreateDomainUserSessionFromInstance(); 
```

客户端的 .config 文件中没有定义任何内容。一切都在代码中配置。

我的 Web 服务方法如下所示（缺少一些与身份验证无关的代码）...

```
[WebMethod(EnableSession = true)]
[OperationBehavior(Impersonation = ImpersonationOption.Allowed)]
public string CreateDomainUserSessionFromInstance()
{
    if(HttpContext.Current.User != null && HttpContext.Current.User.Identity.IsAuthenticated)
    {
        WindowsIdentityRequest authenticationRequest = new WindowsIdentityRequest(instanceName, HttpContext.Current.User.Identity as WindowsIdentity);
        response = authManager.Login(authenticationRequest);
    }

    return response.SessionContext.SessionToken;
} 
```

我在服务器端的 web.config 看起来像这样......

```
<system.web>
    <authentication mode="Windows" />
    <identity impersonate="true" />
    <authorization>
        <!--<allow users="*" />-->
        <deny users="?" />
    </authorization>
</system.web>

<customBinding>
    <binding name="textHttpBinding" receiveTimeout="00:05:00" sendTimeout="00:05:00">
      <textMessageEncoding>
        <readerQuotas maxArrayLength="1024000000" maxStringContentLength="1024000000" />
      </textMessageEncoding>
      <httpTransport maxReceivedMessageSize="1024000000" maxBufferSize="1024000000" authenticationScheme="Negotiate" />
  </customBinding> 
```

当我`<deny users="?" />`遇到以下错误时...“ *HTTP请求未经授权，客户端身份验证方案'Negotiate'。从服务器收到的身份验证标头是''* ”有人告诉我应该是`<allow users="*" />`，但是当我这样做时，我可以进入网络服务，但它`HttpContext.Current.User.Identity.IsAuthenticated`是错误的并且`.Name`是空的，我在互联网上读到的是它需要`deny users="?" />`拒绝匿名访问。

我是 Web 服务的新手，所以不幸的是，大部分代码对我来说都是希腊语。我们的 Web 服务最初允许匿名身份验证，但要求已更改为需要 Windows 身份验证。

我花了几天时间阅读许多网站，试图正确配置所有内容，但似乎找不到正确的组合。
我究竟做错了什么？这是简单的事情还是我离谱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:25:19.010

这是我用来模拟的一个类：

```
public class Impersonator :
    IDisposable
{
    private const int LOGON32_LOGON_NEW_CREDENTIALS = 9;

    public Impersonator(
        string userName,
        string domainName,
        string password )
    {
        ImpersonateValidUser( userName, domainName, password );
    }

    public void Dispose()
    {
        UndoImpersonation();
    }

    #region P/Invoke.
    // ------------------------------------------------------------------

    [DllImport("advapi32.dll", SetLastError=true)]
    private static extern int LogonUser(
        string lpszUserName,
        string lpszDomain,
        string lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        ref IntPtr phToken);

    [DllImport("advapi32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern int DuplicateToken(
        IntPtr hToken,
        int impersonationLevel,
        ref IntPtr hNewToken);

    [DllImport("advapi32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern bool RevertToSelf();

    [DllImport("kernel32.dll", CharSet=CharSet.Auto)]
    private static extern  bool CloseHandle(
        IntPtr handle);

    private const int LOGON32_LOGON_INTERACTIVE = 2;
    private const int LOGON32_PROVIDER_DEFAULT = 0;

    #region Private member.
    // ------------------------------------------------------------------

    /// <summary>
    /// Does the actual impersonation.
    /// </summary>
    /// <param name="userName">The name of the user to act as.</param>
    /// <param name="domainName">The domain name of the user to act as.</param>
    /// <param name="password">The password of the user to act as.</param>
    private void ImpersonateValidUser(
        string userName, 
        string domain, 
        string password )
    {
        WindowsIdentity tempWindowsIdentity = null;
        IntPtr token = IntPtr.Zero;
        IntPtr tokenDuplicate = IntPtr.Zero;

        try
        {
            if ( RevertToSelf() )
            {
                if ( LogonUser(
                    userName, 
                    domain, 
                    password,
                    LOGON32_LOGON_NEW_CREDENTIALS,
                    LOGON32_PROVIDER_DEFAULT, 
                    ref token ) != 0 )
                {
                    if ( DuplicateToken( token, 2, ref tokenDuplicate ) != 0 )
                    {
                        tempWindowsIdentity = new WindowsIdentity( tokenDuplicate );
                        impersonationContext = tempWindowsIdentity.Impersonate();
                    }
                    else
                    {
                        throw new Win32Exception( Marshal.GetLastWin32Error() );
                    }
                }
                else
                {
                    throw new Win32Exception( Marshal.GetLastWin32Error() );
                }
            }
            else
            {
                throw new Win32Exception( Marshal.GetLastWin32Error() );
            }
        }
        finally
        {
            if ( token!= IntPtr.Zero )
            {
                CloseHandle( token );
            }
            if ( tokenDuplicate!=IntPtr.Zero )
            {
                CloseHandle( tokenDuplicate );
            }
        }
    }

    /// <summary>
    /// Reverts the impersonation.
    /// </summary>
    private void UndoImpersonation()
    {
        if ( impersonationContext.IsNotNull() )
        {
            impersonationContext.Undo();
        }   
    }

    private WindowsImpersonationContext impersonationContext = null;

    // ------------------------------------------------------------------
    #endregion
} 
```

# javascript - HTML5/Javascript - 试图将画布动画绑定到键盘事件

> ID：14344976
> 
> 赞同：1
> 
> 时间：2013-01-15T19:03:18.537
> 
> 标签：javascript, html5-canvas

这是我第一次在 javascript 中做键盘事件，但我知道动画确实有效。这个想法很简单：当用户按下回车时播放一个矩形移动的动画。下面是我的代码。

```
//Event listeners
window.addEventListener("keydown", onKeyDown, false);

function onKeyDown(event){
    var keyCode = event.keyCode;
    switch(keyCode){
        case 13  //enter
            drawStuff();
        break;
    }
}

//code to be executed onKeyDown
function drawStuff(){
var x = document.getElementById("myCanvas");
var canvas = x.getContext('2d');

var i = 0;

function animate(){
    if(i < 451){
        canvas.clearRect(0,0,500,500);
        canvas.fillStyle="red";
        canvas.fillRect(30,i,50,50);
        i++;
    }
    else{}
}

window.setInterval(animate, 1);
} 
```

任何建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:16:54.913

看看 Paul Irish 的[`requestAnimationFrame`垫片](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)；rAF 比 setInterval 方法有很多优点；主要是它是为做到这一点而构建的，而且它只在浏览器准备好时才请求帧，所以当你的网站在后台时它会暂停发生的事情。当我切换时，我还注意到性能更流畅。

我会说这样的事情应该有效：

```
var animationHasTriggered = false;
var x = document.getElementById("myCanvas");
var canvas = x.getContext('2d');
var keysDown = {};

var i = 0;

window.addEventListener('load', function()
{
    addEventListener("keydown", function(e)
    {
        keysDown[e.keyCode] = true;
    }, false);

    addEventListener("keyup", function(e)
    {
        delete keysDown[e.keyCode];
    }, false);

    updateAll();

}, false);

function updateAll()
{
    if (13 in keysDown || animationHasTriggered)
    {
        animationHasTriggered = true;
        animate();
    }
    requestAnimationFrame(updateAll);
}

function animate()
{
    if (i < 451)
    {
        canvas.clearRect(0,0,500,500);
        canvas.fillStyle="red";
        canvas.fillRect(30,i,50,50);
        i++;
    }
    else
    {
        animationHasTriggered = false;
    }
}
(function()
{
    // http://paulirish.com/2011/requestanimationframe-for-smart-animating/
    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x)
    {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
    }

    if (!window.requestAnimationFrame) window.requestAnimationFrame = function(callback, element)
    {
        var currTime = new Date().getTime();
        var timeToCall = Math.max(0, 16 - (currTime - lastTime));
        var id = window.setTimeout(function()
        {
            callback(currTime + timeToCall);
        }, timeToCall);
        lastTime = currTime + timeToCall;
        return id;
    };

    if (!window.cancelAnimationFrame) window.cancelAnimationFrame = function(id)
    {
        clearTimeout(id);
    };
}()); 
```

# php - 哪个 HTML Parser（最好是 PHP）支持获取输入字符串中当前节点的偏移量？

> ID：14344977
> 
> 赞同：4
> 
> 时间：2013-01-15T19:03:20.513
> 
> 标签：php, html-parsing

我正在寻找一种 HTML 或 XML 解析器，它可以让人们访问**输入字符串或文件*****中当前元素的偏移量/***位置。

 **例如，如果遍历此字符串：

```
<div>
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit</p>
    <p>sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
</div> 
```

我正在寻找一种方法来获取每个`<p>`标签的起始位置（包括空格），在这里：`7`和`72`.

如果 PHP 解析器本身支持它会很棒（我查看了[DOM](http://php.net/manual/en/book.dom.php)、[XMLReader](http://php.net/manual/en/book.xmlreader.php)和其他库在[这个 SO 问题](https://stackoverflow.com/questions/3577641/)中提到但还没有找到方法），但否则任何语言/框架都是美好的。

*注意：与[此问题](https://stackoverflow.com/q/2160533/593036)相关，但本地化程度较低。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T21:33:15.177

也许您可以使用[通用 XML 解析器类](http://www.phpclasses.org/package/4-PHP-Arbitrary-XML-parser-.html)（也在[github 上](https://github.com/manuellemos/xmlparser)）。
根据作者的描述：

*   解析任意 XML 输入并构建一个包含所有标签和数据元素结构的数组。
*   它只需一次调用即可验证和提取整个 XML 文档中的数据。它支持验证常见的标签值数据类型，并且可以使用子类执行自定义验证。
*   **可选地，跟踪每个元素的位置，以允许确定可能在上下文中出错的元素的确切位置。**
*   支持解析后的文件缓存，最大限度地减少重复解析同一个文件的开销。
*   忽略标签属性的简化 XML (SML) 格式的优化解析。
*   使用单个函数调用验证和提取整个 XML 文档中的数据

我已经使用以下代码对其进行了测试：

```
<?php

require('xml_parser.php');

$file_name = 'test.xml';
$error = XMLParseFile($parser, $file_name, 1, $file_name.'.cache');

foreach ($parser->structure as $key => $val) {
    if (is_array($val) && isset($val['Tag']) && !strcasecmp($val['Tag'], 'p')) {
        print_r($parser->positions[$key]);
    }
}

?> 
```

该`test.xml`文件包含您的示例 HTML 片段。
通过从命令行运行脚本，我得到以下输出：

```
Array
(
    [Line] => 2
    [Column] => 7
    [Byte] => 12
)
Array
(
    [Line] => 3
    [Column] => 7
    [Byte] => 80
) 
```

因此，该`Byte`字段可能是您正在寻找的。
为了更好地理解它的工作原理，还请查看它的[源代码](https://github.com/manuellemos/xmlparser/blob/master/xml_parser.php#L72)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T11:52:18.613

如果你不介意用 Java 编码（在 Java 编码之后，PHP 有一个解决方案），你可以`indexOf`在类中使用方法，`String`如果有这个标记则获取偏移量。

这是一个例子：

```
class Index {
    public static void main ( String [] args )
    {   
        String token = "<p>";
        String input = "<p> hola </p> <p> adios </a>";
        int beginIdx = -1; 
        while ( (beginIdx = input.indexOf( token, beginIdx + 1 )) != -1 ) {                                                                                                                                         
            System.out.println( "Token at: " + beginIdx );
        }   
    }   
} 
```

输出是：

```
Token at: 0
Token at: 14 
```

在 PHP 中有一个类似的函数：

```
int strrpos ( string $haystack , string $needle [, int $offset = 0 ] ) 
```

您可以快速查看有关它的“man”页面（它有一些示例）： http: [//php.net/manual/es/function.strrpos.php](http://php.net/manual/es/function.strrpos.php)**

# java - 哪些库可用于在表示层将对象表示转换为 JSON/XML？

> ID：14344978
> 
> 赞同：2
> 
> 时间：2013-01-15T19:03:28.390
> 
> 标签：java, json, web-applications, jboss, resteasy

我目前正在开发一个我`@Entity`看起来像 的网络项目

```
@Entity
@Table(name = "variable")
@XmlRootElement
public class Variable {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private long id;

    @Column(unique = true, nullable = false)
    private String name;

    @Column
    @Enumerated(EnumType.STRING)
    private VariableType type;

    @Column(nullable = false)
    private String units;

    @Column
    private String description;

    @Temporal(TemporalType.TIMESTAMP)
    @Column(name = "created_on", nullable = false)
    private Date createdOn;

    @Temporal(TemporalType.TIMESTAMP)
    @Column(name = "retired_on", nullable = true)
    private Date retiredOn;

    @Column(nullable = false)
    private boolean core;
} 
```

要将这个对象转换为 JSON，我正在连接我的实体，`@XmlRootElement`并将其绑定到`JAXB`

我的`REST`调用方法看起来像

```
 @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Response getVariables() {
        return Response.ok(variableManager.getVariables()).build();
    } 
```

这种方法存在一些问题：

1.  它将持久性与表示层紧密结合。如果后端发生变化，它将在表示层上导致/暴露相同的事情。不可取
2.  表示层上的返回数据可能比在这种情况下不可行的实体更少/更多（另一个对象的复合）数据

在一个典型的 Web 应用层中，通常有 3 层

```
presentation/
business/
persistence/ 
```

定义表示、将对象转换为 JSON/XML 的决定应该在表示层上。我正在寻找可以将我的对象转换为`XML/JSON`而不使用将它们绑定到持久层的方法`@XmlRootElement`

请分享你的想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:11:19.403

1.  在 Web 应用程序中，您指定的三个层，表示层、业务层和持久性层，都依赖于它下面的层。业务层类使用来自持久层的服务。演示服务使用业务服务。他们还可以访问持久性服务。如果您偶然发现您的业务对象，您将不得不更改演示文稿中使用它的任何服务。
2.  如果您想混合不同类型的对象，您很可能必须使用自己的序列化程序。

对于 XML，您有 JAXB。对于 JSON，您可以使用从[Jackson](https://github.com/FasterXML/jackson)到[Gson](https://github.com/google/gson)的任何内容。

我相信您使用的 JAX-RS 使用 Jackson 将您返回的对象序列化为 JSON。

如果您不想`Variable`使用仅在表示层中使用的 XML 和 JSON 注释来注释您的类，您可以提取您的类的接口，即。为 getter 方法创建一个接口`VariableInterface`。让您的`Variable`类实现它并仅使用 JPA 注释对其进行注释。这些进入您的业务层。在您的演示文稿中，创建一个`PresentationVariable`实现`VariableInterface`. 这种方式的依赖是从演示到业务。然后，您`PresentationVariable`使用 JSON/XML 映射注释来注释您的。您在演示文稿中的逻辑必须通过构造函数或实用程序方法将您转换`Variable`为`PresentationVariable`，然后您可以返回它。

```
package business;

public interface VariableInterface {
    long getId();
    String getName();
    //more
}

@Table
public class Variable implements VariableInterface {
    @Id
    private long id;
    @Column
    private String name; 
    public long getId() {
        return id;
    }
    public long getName() {
        return name
    }
}

package presentation;

import business.VariableInterface;

public class PresentationVariable implements VariableInterface {
    @XmlElement
    private long id;
    @XmlElement
    private String name;
    public long getId() {
        return id;
    }
    public long getName() {
        return name
    }
} 
```

# sharepoint - SharePoint Designer 2010 在创建页面时删除 Web 部件连接

> ID：14344983
> 
> 赞同：1
> 
> 时间：2013-01-15T19:03:42.747
> 
> 标签：sharepoint, sharepoint-2010, web-parts

我有一个托管在 SharePoint 2010 文档库中的自定义 ASPX 页面，该页面具有一个或多个从自定义 Web 部件到 SSRS ReportViewWebPart 的 Web 部件连接。

代码是根据页面的定义自动生成的（通过自定义管理界面完成）。它应该看起来像这样（并且在大多数环境中都是如此）：

```
<WebPartPages:SPProxyWebPartManager runat="server" ID="SPProxyWebPartManager1">
    <SPWebPartConnections>
        <WebPartPages:SPWebPartConnection 
            ConsumerID="g_d01bedc6_69b0_4c82_ac64_208be5668ec3"               
            ID="g_437d9428_bdb2_4d37_927c_6e1a984432f5" 
            ProviderConnectionPointID="ProviderValue"                   
            ProviderID="g_AE0B5082_A085_4ba8_AD73_A7AC41E71205">
        </WebPartPages:SPWebPartConnection>
    </SPWebPartConnections>
</WebPartPages:SPProxyWebPartManager> 
```

但是，我们看到了一些缺少连接的环境，如下所示：

```
<WebPartPages:SPProxyWebPartManager runat="server" ID="SPProxyWebPartManager1">
    <SPWebPartConnections>
    </SPWebPartConnections>
</WebPartPages:SPProxyWebPartManager> 
```

日志记录显示正确的代码被推送到文档库，因此当文件添加到文档库时，某些东西正在剥离 SPWebPartConnection 节点。这是添加文件的代码：

```
byte[ ] byteArray = Encoding.ASCII.GetBytes( page.Definition );
Hashtable properties = new Hashtable( );
properties.Add( "DashboardID", page.ID );
SPFile newFile = folder.Files.Add( String.Format( "{0}/{1}", folder, pageName ), byteArray, properties, true ); 
```

我已经在网上查看了有关将文件添加到文档库的示例，以确保我没有遗漏任何内容。对于 SPWeb，AllowUnsafeUpdates 设置为 true，并且它位于 using 语句中，因此应该正确处理它。

到目前为止，存在此问题的站点之间唯一的共同点是用于 SharePoint 的 SP1。我还在开发环境中检查和测试每个修补程序，但我没有找到导致连接被删除的部分。

任何帮助，将不胜感激。

# javascript - 如何在 javascript 函数中调试 ASP

> ID：14344991
> 
> 赞同：1
> 
> 时间：2013-01-15T19:04:15.443
> 
> 标签：javascript, asp-classic

我正在处理客户的经典 ASP 站点，并且一些应该显示在页脚中的图像没有显示出来。我也没有看到任何错误消息。有一些 javascript 应该从 SQL Server 数据库中读取图像文件名列表。这些图像根据数据库中的名称列表从本地文件夹中显示。这是在 javascript 中发生的，但看起来函数内部有一些 ASP。老实说，我不知道它应该如何工作或如何调试它（即，javascript 函数中的 ASP）。站点的其他部分依赖于 ADO 连接，所以我很确定它的创建是正确的。我该如何调试？我正在使用 Chrome，它似乎有一些很好的调试工具。这是我的功能 希望能够逐步完成并进行更多调查。我只是不确定如何。此外，当我在 Chrome 中查看这段 javascript 时，只有其中一部分存在！这是功能：

```
function declareLogos() {
    <%   ' get logos

    SQL = "SELECT l.LogoFileName, p.SortOrder FROM InrixCustomerLogo l join InrixCustomerLogoPage p on l.LogoCode = p.LogoCode WHERE p.PageFileName = '" & fn & "' AND SortOrder > 0 ORDER BY SortOrder"
    On Error Resume Next
    Set oLOGO = oConn.Execute(SQL)
    logoerror = Err.Number
    On Error Goto 0
    x = 1  ' array counter

    %>

    <% If NOT logoerror Then %>
    <% Do While NOT oLOGO.EOF %>
    i[<% =x %>] = '<% =oLOGO("LogoFileName") %>';
    <% oLOGO.MoveNext : x = x + 1 : Loop %>
    <% End If %>

    imax = <% =x-1 %>;
    ilast = <% =(((x-1)*4)/4) %>;  // <% =(((x-1)*4)/4) %>   this is imax - 1 that is divisible by four
} 
```

在实际网页上，以下是 Chrome 工具为此功能显示的内容：

```
function declareLogos() {

     imax = 0;
     ilast = 0;  // 0   this is imax - 1 that is divisible by four
} 
```

任何调试此问题的指导将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:20:23.680

请注意，ASP 代码不在您的 javascript 代码中。它是用于简单使用的内联 ASP 代码。如果可能，不建议使用内联代码。您可以改为在代码隐藏中编写代码。

这是您可以在内联代码中的特定点中断的方法

```
<%  System.Diagnostics.Debugger.Break();
   // Code will be present here
%> 
```

在你的情况下

```
<%   System.Diagnostics.Debugger.Break();
' get logos

    SQL = "SELECT l.LogoFileName, p.SortOrder FROM InrixCustomerLogo l join InrixCustomerLogoPage p on l.LogoCode = p.LogoCode WHERE p.PageFileName = '" & fn & "' AND SortOrder > 0 ORDER BY SortOrder"
    On Error Resume Next
    Set oLOGO = oConn.Execute(SQL)
    logoerror = Err.Number
    On Error Goto 0
    x = 1  ' array counter

    %> 
```

**更新：**

在经典的 ASP`System.Diagnostics.Debugger.Break();`中不可用（除非您围绕它编写 ComVisible 包装器）。感谢@Frédéric Hamidi 指出这一点。

# jquery - jQuery Cycle 2 响应式 w/ 居中幻灯片

> ID：14344999
> 
> 赞同：6
> 
> 时间：2013-01-15T19:04:41.497
> 
> 标签：jquery, responsive-design, jquery-cycle, landscape-portrait

我正在尝试使用出色的 Cycle 2 jQuery 插件来设置响应式图片库。画廊将展示纵向和横向图像。

我正在使用居中幻灯片选项（Cycle2 的中心插件： http: [//jquery.malsup.com/cycle2/demo/center.php](http://jquery.malsup.com/cycle2/demo/center.php)），这似乎会导致 Webkit 浏览器出现问题（如果不是，请尝试调整浏览器窗口的大小）一开始不明显！）

[http://goo.gl/NFFZk](http://goo.gl/NFFZk)

绿色背景代表循环容器。

如果没有添加中心选项（ data-cycle-center-horz=true data-cycle-center-vert=true ），整个事情运行良好，请参阅：

[http://goo.gl/p76wi](http://goo.gl/p76wi)

我无法弄清楚导致居中版本出现问题的原因。

图像上的 CSS 代码非常少：

```
.cycle-slideshow img {
    max-height: 100%;
    max-width: 100%;
} 
```

包含元素的 CSS 在这里

```
.cycle-slideshow {
    background: green;
    display: block;
    position:absolute;
    height:auto;
    bottom:0;
    top:0;
    left:0;
    right:0;
    margin:20px auto;
    padding:0;
    width:80%;
    } 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-14T14:59:54.917

这是另一种选择。

```
$('.cycle-slideshow').on('cycle-initialized', function( event, opts ) {                
    $(window).trigger('resize');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T21:36:51.093

获取循环插件的未压缩版本：http: [//malsup.github.io/jquery.cycle2.center.js](http://malsup.github.io/jquery.cycle2.center.js)

更改第 17 行（将**负载**添加到触发调整大小的事件列表）：

```
$(window).on( 'resize orientationchange load', resize ); 
```

这将解决 webkit 浏览器上奇怪的随机居中问题。

我在 malsup github 上为此打开[了一个问题。](https://github.com/malsup/cycle2/issues/414)希望这将很快进入已发布的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T19:53:35.757

在查看了您不合作的示例之后，似乎内联样式可能会导致您有些头疼。这是第二张图片（鲤鱼）引用的 HTML：

```
<img src="http://www.freeimageslive.com/galleries/nature/animals/pics/nishikigoi.jpg" style="position: absolute; top: 0px; left: 0px; z-index: 99; display: block; margin-left: 205px; opacity: 1;" class="cycle-slide cycle-slide-active"> 
```

这里要注意的`margin-left`是设置为 的属性`205px`。要显示居中的动态或响应式图像，需要进行一些数学运算。您将需要使用*偏移量*来完成此操作。将图像设置为`left: 50%`将图像的左侧与容器的中间对齐。到达那里后，您将使用`margin-left`一半宽度的负值将图像放入真正的中心。（例如，如果图像的宽度是`80px`，那么您将使用 CSS `left: 50%; margin-left: -40px;`。