# StackOverflow 问答 13593000-13593999

# forms - 在提交时验证单选按钮

> ID：13593000
> 
> 赞同：0
> 
> 时间：2012-11-27T21:03:42.300
> 
> 标签：forms, javascript-events

我正在尝试验证比赛中的单选按钮，它是多步骤的，因此单选按钮将选择发布到参赛表格页面。

如果没有选择任何内容，目前无法阻止提交，将脚本放在一起但无法正常工作。

HTML：

```
<form name="radioOptions" method="post" action="#" onsubmit="return validateForm()">
<ul>
  <li><input type="radio" name="question" id="question1" value="questionL1">Miami</li>
  <li><input type="radio" name="question" id="question2" value="questionL2">Washington</li>
  <li><input type="radio" name="question" id="question3" value="questionL3">Rome</li>
  <li><button class="enterButton" name='submit' type='submit' /></button></li>
</ul>
</form>​ 
```

脚本：

```
function validateForm() {
    var radios = document.getElementsByName("question");
    var formValid = false;

    var i = 0;
    while (!formValid && i < radios.length) {
        if (radios[i].checked) formValid = true;
        i++;        
    }

    if (!formValid) alert("Must check some option!");
    return formValid;
}​ 
```

也可以在[这里摆弄一下](http://jsfiddle.net/X8mHg/1/)

对此的一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:22:41.193

不完全确定我是否做了任何事情，但是我的确切代码突然起作用了。

@Pow-Lan，使用“javascript:”代替 return 不会阻止页面运行 post 函数。

感谢所有同样的人。

# oracle - 如果Oracle中不存在记录，如何插入？

> ID：13593001
> 
> 赞同：3
> 
> 时间：2012-11-27T21:03:54.157
> 
> 标签：oracle, oracle10g

如果 Oracle 中不存在记录，如何插入？这是我正在尝试做的事情：

```
IF NOT EXISTS (SELECT * FROM AROH_FAA_AIRPORT WHERE AIRPORT_ABBREVIATION = '0D7') 
BEGIN 
  insert into AROH_FAA_AIRPORT 
  (FAA_AIRPORT_OID,CITY,FAA_LISTED_AIRPORT_NAME,AIRPORT_ABBREVIATION) 
  values(AROH_FAA_AIRPORT_SEQ.nextval,'ADA','ADA','0D7') 
END 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:42:38.187

```
insert into AROH_FAA_AIRPORT 
   (FAA_AIRPORT_OID,CITY,FAA_LISTED_AIRPORT_NAME,AIRPORT_ABBREVIATION) 
select AROH_FAA_AIRPORT_SEQ.nextval,'ADA','ADA','0D7') 
from dual 
where not exists (select 42
                  from AROH_FAA_AIRPORT 
                  WHERE AIRPORT_ABBREVIATION = '0D7'); 
```

或者，您可以使用 MERGE 语句：

```
merge into AROH_FAA_AIRPORT a
using (
    select 'ADA' city, 
           'ADA' as faa_listed_airport_name, 
           '0D7' as as airport_abbreviation 
    from dual 
) t ON (t.city = a.city)
when not matched then 
  insert 
     (FAA_AIRPORT_OID,
      CITY,
      FAA_LISTED_AIRPORT_NAME,
      AIRPORT_ABBREVIATION)
  values 
     (AROH_FAA_AIRPORT_SEQ.nextval, 
      t.city, 
      t.faa_listed_airport_name, 
      t.airport_abbreviation); 
```

# c# - 使用 while 或 for 查找数组中的最高数字？

> ID：13593006
> 
> 赞同：1
> 
> 时间：2012-11-27T21:04:03.650
> 
> 标签：c#, arrays

请ai有一个问题，我需要找到数组中的最大值。人们将向数组写入姓名（textbox1）和金钱（texbox2）。我有 2 个按钮，第一个按钮保存到数组中，第二个按钮用最大的钱写名字。

**保存代码：**

```
 string[] name = new string[50];
    int items = 0;
    int[] money = new int[50];

    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        try
        {
            Convert.ToInt32(textBox2.Text);
        }
        catch
        {
            name[items] = textBox1.Text;
            money[items] = Int32.Parse(textBox2.Text);
            items++;        
        }
    } 
```

**而button2需要搜索最大值并写上名字！请帮我**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:08:51.373

```
 private void button2_Click(object sender, EventArgs e)
 {
    int maxIndex = 0;

    for(int i = 0; i < 50; i++)
    {
        if (money[i] > money[maxIndex])            
            maxIndex = i;            
    }

    MessageBox.Show(name[maxIndex] + " has biggest value " + money[maxIndex]);
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:08:06.727

要从数组中获取 Max int，您可以使用[IEnumerable.Max](http://msdn.microsoft.com/en-us/library/bb535031.aspx)：

```
money.Max(); 
```

但是可能有不止一个名字具有相同的高价值，也许你也需要处理这个，我认为字典是你最好的选择

```
private Dictionary<string, int> Names = new Dictionary<string, int>();

private void button1_Click(object sender, EventArgs e)
{
    int value = 0;
    if (int.TryParse(textBox2.Text, out value))
    {
        if (!Names.ContainsKey(textBox1.Text))
        {
            Names.Add(textBox1.Text, value);
        }
    }
}

private void button2_Click(object sender, EventArgs e)
{
    if (Names.Any())
    {
        int maxMoney = Names.Max(v => v.Value);
        var names = Names.Where(k => k.Value.Equals(maxMoney));
        foreach (var name in names)
        {
            // Names with the highest money value
        }
    }
} 
```

# python - 如何定义一个引用自身的 Django 模型？

> ID：13593010
> 
> 赞同：1
> 
> 时间：2012-11-27T21:04:16.803
> 
> 标签：python, django, django-models, python-2.5

我是 Django 新手，目前正在编写一个应用程序，用户可以在其中输入他们对某个主题的意见。

每个意见 A 可能有零个或多个支持 A 的意见和多个（零个或多个）反对 A 的意见。

我试图为此创建一个模型并编写了一个`models.py`像这样的文件：

```
from django.db import models

# Create your models here.
class Opinion(models.Model):
    id = models.AutoField(primary_key=True)
    contents = models.CharField(max_length=256)
    source = models.CharField(max_length=256)
    proArguments = models.ManyToManyField(Opinion, verbose_name="Pro arguments")
    contraArguments = models.ManyToManyField(Opinion, verbose_name="Contra arguments") 
```

当我运行时`python manage sqlall`，我收到以下错误：

```
 File "D:\dev\history-site\history_site\opinions\models.py", line 4, in <module>
    class Opinion(models.Model):
  File "D:\dev\history-site\history_site\opinions\models.py", line 8, in Opinion
    proArguments = models.ManyToManyField(Opinion, verbose_name="Pro arguments")

NameError: name 'Opinion' is not defined 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:09:24.223

来自[文档`ManyToManyField`](https://docs.djangoproject.com/en/dev/ref/models/fields/#ref-manytomany)：

> 需要一个位置参数：模型相关的类。这与它的工作原理完全相同`ForeignKey`，包括有关递归和惰性关系的所有选项。

其中[说](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey)：

> 要创建递归关系（与自身具有多对一关系的对象），请使用`models.ForeignKey('self')`.

所以：

```
proArguments = models.ManyToManyField("self", verbose_name="Pro arguments")
contraArguments = models.ManyToManyField("self", verbose_name="Contra arguments") 
```

如果参数也被视为意见，我有点想知道您的数据模型，但这是另一回事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:15:57.010

你将不得不使用自我。因为，你有两个 m2m 自我关系，你需要添加一个 related_name 参数或提供symmetric=False

```
class Opinion(models.Model):
    id = models.AutoField(primary_key=True)
    contents = models.CharField(max_length=256)
    source = models.CharField(max_length=256)
    proArguments = models.ManyToManyField('self', verbose_name="Pro arguments", related_name='my_proargs')
    contraArguments = models.ManyToManyField('self', verbose_name="Contra arguments", related_name='my_contraarg') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:09:01.663

做到这一点的方法是使用“自我”

```
proArguments = models.ManyToManyField('self', verbose_name="Pro arguments")
contraArguments = models.ManyToManyField('self', verbose_name="Contra arguments") 
```

来自 django 文档：

> 要创建递归关系（与自身具有多对一关系的对象），请使用 models.ForeignKey('self')。

# php - Codeigniter 2.1，PHP - 将两个函数合二为一

> ID：13593014
> 
> 赞同：0
> 
> 时间：2012-11-27T21:04:36.633
> 
> 标签：php, codeigniter, codeigniter-2

我有以下两个功能，我想知道，有什么方法可以将它们组合成一个。

```
function galerija_get_all(){
$q = $this->db->get('galerija');
return $q = $q->result_array();
}

function galerija_get_all_slike(){
$q = $this->db->get('slike');
return $q = $q->result_array();
} 
```

在我的视图文件中，我有以下代码：

```
<?php foreach ($galerija as $gal): ?>
<figure>
<?php foreach ($galerija_slike as $img): ?>
<?php if ($gal['id_galerija'] == $img['galerija_id']): ?>

<?php endif ?>
<?php endforeach ?>
<img src="" >
<figcaption></figcaption>
</figure>
<?php endforeach ?> 
```

这两个代码是否可能（如果是，如何）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:12:48.567

你总是可以这样做..

```
function galerija_get_all($type){
    $q = $this->db->get($type);
    return $q->result_array();
} 
```

然后你可以像这样使用它：

```
falerija_get_all('slike'); 
```

或者

```
falerija_get_all('galerija'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:31:20.977

您可以将两个结果存储在一个数组中，然后将该数组作为单个结果返回。

```
function get_all(){
   $galerija = $this->db->get('galerija')->result_array();
   $slike = $this->db->get('slike')->result_array();

   $result = array('galerija'=> $galerija,
                   'slike'   => $slike);
   return $result;
} 
```

然后在视图中你可以这样做

```
<?php foreach ($result['galerija'] as $gal): ?>
<figure>
<?php foreach ($result['slike'] as $img): ?>
<?php if ($gal['id_galerija'] == $img['galerija_id']): ?>

<?php endif ?>
<?php endforeach ?>
<img src="" >
<figcaption></figcaption>
</figure>
<?php endforeach ?> 
```

# eclipse-plugin - 重写节点后注释行消失

> ID：13593015
> 
> 赞同：2
> 
> 时间：2012-11-27T21:04:38.003
> 
> 标签：eclipse-plugin, eclipse-jdt, automated-refactoring

我正在编写简单的重构，并注意到一件奇怪的事情。我正在重写的节点之前的注释行在重构后消失了。有问题的节点之后的注释也会在节点内部传输并在新位置打破缩进。这很奇怪，我想问一下这是jdt中的错误还是我做错了什么并且忘记了。

例如，我的代码假设以最短分支首先出现的方式重构 if-else 语句。当我尝试重构这个时：

```
 // pre
    if(a==6) { 
        a = 5;
        return false;
    } else { 
        a++;
    }
    //post 
```

我明白了：

```
 if (!(a==6)) { 
        a++;
    }
    //post 
else { 
        a = 5;
        return false;
    } 
```

重构完成的相关片段：

```
protected ASTRewrite createRewrite(CompilationUnit cu, SubProgressMonitor pm) {
    pm.beginTask("Creating rewrite operation...", 1);

    final AST ast = cu.getAST();
    final ASTRewrite rewrite = ASTRewrite.create(ast);

    cu.accept(new ASTVisitor() {
        public boolean visit(IfStatement node) {
            if (node.getStartPosition() > selection.getOffset() + selection.getLength() || node.getStartPosition() < selection.getOffset())
                return true;

            if (node.getElseStatement() == null)
                return true;

            int thenCount = countNodes(node.getThenStatement());
            int elseCount = countNodes(node.getElseStatement());

            if(thenCount <= elseCount)
                return true;

            IfStatement newnode = ast.newIfStatement(); 
            PrefixExpression neg = negateExpression(ast, rewrite, node.getExpression());    
            newnode.setExpression(neg);

            newnode.setThenStatement((org.eclipse.jdt.core.dom.Statement) rewrite.createMoveTarget(node.getElseStatement()));
            newnode.setElseStatement((org.eclipse.jdt.core.dom.Statement) rewrite.createMoveTarget(node.getThenStatement()));   

            rewrite.replace(node, newnode, null);                       
            return true;
        }
    });
    pm.done();
    return rewrite;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T03:28:34.880

`// pre`注释消失了，因为解析器认为它是下一条语句（由 表示）的一部分`node`，您将其替换为`newNode`。当`node`消失时，附加的评论也会消失。

仍在思考为什么`// post`最终会出现在它的位置...尝试在设置其 then 和 else 语句之前替换 newNode

# ios - UITableViewCell 动画错误

> ID：13593018
> 
> 赞同：0
> 
> 时间：2012-11-27T21:04:43.493
> 
> 标签：ios, uitableview, animation, cell

我编写了一个自定义 UITableViewCell - 图像视图、按钮和三个标签，现在我正在尝试向它添加一些动画。因此，一旦我点击按钮，它就会消失，并且微调器会替换按钮。两秒钟后，单元格被红色覆盖，随着单元格的子视图淡入，然后指示器被移除，红色覆盖层开始淡出。我之前删除的按钮也会淡入。

（我无法用更好的方式表达它：P）

方法是：

```
-(void)rentButtonPressed:(id)sender
{

    UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
    [indicator startAnimating];
    indicator.center = self.rentButton.center;

    [UIView animateWithDuration:0.2
                     animations:^{self.rentButton.alpha = 0.0;}
                     completion:^(BOOL finished){
                         [self.rentButton removeFromSuperview];
                         [self addSubview:indicator];
                     }
     ];

    UIView *overlay = [[UIView alloc] initWithFrame:self.backgroundImage.frame];
    overlay.alpha = 0.0;
    overlay.backgroundColor = [UIColor redColor];
    [self.contentView addSubview:overlay];

    [UIView animateWithDuration:0.4
                          delay:2.0
                        options:UIViewAnimationCurveEaseInOut
                     animations:^{
                             [indicator removeFromSuperview];
                             overlay.alpha = 0.4;
                         }
                    completion:^(BOOL finished){
                        [UIView animateWithDuration:0.4
                                        animations:^{ overlay.alpha = 0.0; }
                                        completion:^(BOOL finished)
                                        {
                                            [overlay removeFromSuperview];
                                        }
                        ];

                        [self.contentView addSubview:self.rentButton];
                        [UIView animateWithDuration:0.4 animations:^{ self.rentButton.alpha = 1.0;}];
                        [self.delegate didTryToRentMovieAtCell:self];
                    }
    ];

} 
```

所以代码确实淡出按钮，用微调器替换它并淡入红色覆盖层。问题是，红色覆盖层并没有消失，而是与按钮一样消失，而不是淡入，它只是出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:45:46.503

在动画期间，您正在通过添加和删除子视图来更改视图层次结构。UIView 类方法 animateWithDuration:animations:completion 仅用于动画视图中的属性更改，而不用于更改视图层次结构。

尝试使用 UIView 类方法 transitionWithView:duration:options:animations:completion: 代替，并将单元格的内容视图用作“容器”。

本文档有助于区分动画视图属性更改和动画视图转换，特别是“更改视图的子视图”部分：http: [//developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos /animatingviews/animatingviews.html](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/animatingviews/animatingviews.html)

# amazon-s3 - 亚马逊存储无限桶

> ID：13593019
> 
> 赞同：1
> 
> 时间：2012-11-27T21:04:46.707
> 
> 标签：amazon-s3, amazon-web-services, amazon-ec2, amazon-cloudfront

嗨，有没有任何版本的亚马逊网络服务提供无限的存储桶？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:41:17.900

不，来自[S3 文档](http://docs.amazonwebservices.com/AmazonS3/latest/dev/BucketRestrictions.html)：

> 每个 AWS 账户一次最多可以拥有 100 个存储桶。

S3 存储桶的创建和销毁成本很高（就资源而言）：

> Amazon S3 的高可用性工程专注于获取、放置、列出和删除操作。由于存储桶操作针对集中的全局资源空间，因此不适合在应用程序的高可用性代码路径上进行存储桶创建或删除调用。最好在您不经常运行的单独初始化或设置例程中创建或删除存储桶。

也没有充分的理由使用大量的桶：

> 可以存储在存储桶中的对象数量没有限制，无论您使用多个存储桶还是仅使用几个存储桶，性能都没有变化。您可以将所有对象存储在一个存储桶中，也可以将它们组织到多个存储桶中。

您希望每个用户都有一个单独的空间来放置东西。很好：创建一个存储桶并为您的用户特定信息`<user_id>/`添加前缀。更好的是，将其放入 中`users/<user_id>/`，这样您以后就可以将同一个存储桶用于其他非用户特定的事情，或者更改命名方案，或者您可能想要的任何其他内容。

`ListObjects`接受一个`prefix`参数 ( `users/<user_id>/`)，并且对可能相关的分层键有[特殊规定。](http://docs.amazonwebservices.com/AmazonS3/latest/dev/ListingKeysHierarchy.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:43:23.283

威尔是正确的。对于您确实可以证明一个不错的用例的情况，我想 AWS 会考虑增加您的配额（就像他们对大多数服务所做的那样）。如果特定用户拥有 200-300 个或更多存储桶，我不会感到惊讶，但并非没有充分理由向 AWS 证明它是合理的。

话虽如此，我在其他配额增加表格旁边找不到任何 S3 配额增加表格。

# tfs - 将我的项目恢复到以前的状态

> ID：13593021
> 
> 赞同：0
> 
> 时间：2012-11-27T21:04:59.217
> 
> 标签：tfs

我已将一个项目添加到我的 Team Foundation Server 2010 安装中，并且我已经完成了一些代码签入。

我需要将项目恢复到上次签入时的状态，但是，当我尝试获取最新版本或特定版本时，我修改的文件（File1.cs）之一未签出。

我意识到 File1.cs 上次没有签入，但我想将项目回滚到上次签入时的位置。

“获取最新版本”和“获取特定版本”到底是什么？

我对这两个选项感到非常困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:31:35.663

获取特定将获取给定变更集的文件。但是，如果该文件在您所在的变更集和您正在获取的变更集之间没有更改，那么这是一个无操作。

查找要获取的文件版本的最简单方法是通过查看历史记录。找到您想要获取的变更集，然后选择“获取此版本”。这将*仅*获得该版本的相关文件。

# php - 通过 PHP 将多维数组发布到服务器

> ID：13593025
> 
> 赞同：0
> 
> 时间：2012-11-27T21:05:12.560
> 
> 标签：php, javascript, jquery, ajax, post

> **可能重复：**
> [表单中的多维数组发布](https://stackoverflow.com/questions/1719087/multi-dimensional-array-post-from-form)

我想使用 jQuery 将一些数据从客户端发送到 PHP 服务器`$.post()`。当它到达服务器时，我想`$_POST['myList']`等于以下任何一个（最简单的）。我应该将数据对象设置在什么范围内`$.post()`？

```
array (
  0=>array('id'=>123,'d1'=>'aaa','d2'=>'xxx'),
  1=>array('id'=>234,'d1'=>'bbb','d2'=>'yyy'),
  2=>array('id'=>345,'d1'=>'ccc','d2'=>'zzz')
)

array (
  123=>array('d1'=>'aaa','d2'=>'xxx'),
  234=>array('d1'=>'bbb','d2'=>'yyy'),
  345=>array('d1'=>'ccc','d2'=>'zzz')
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:11:32.097

**编辑**：第一个看起来像一个简单的对象数组，但似乎 jQuery 需要这是一个键控对象：

```
var send_this = {
  0: { id: 123, d1: 'aaa', d2: 'xxx' },
  1: { id: 234, d1: 'bbb', d2: 'yyy' },
  2: { id: 345, d1: 'ccc', d2: 'zzz' }
}; 
```

对于包含对象的对象，第二个外观只是具有不同的外观键：

```
var send_this = {
  '123': { d1: 'aaa', d2: 'xxx' },
  '234': { d1: 'bbb', d2: 'yyy' },
  '345': { d1: 'ccc', d2: 'zzz' }
}; 
```

在 jQuery 1.7.1 中测试的实现：

```
$.post( '/herp.php', send_this, function(d) {
    console.info( d );
}); 
```

PHP 程序在 $_POST 中完全按照您的需要接收数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:12:41.373

您应该使用 JSON strong 来发送数据：这是一个示例：

```
var pushData = {
        id: "blalal",
        id: "blalal",
        id: "blalal",
    };
JSON.stringify(pushData) 
```

然后你可以发布它或其他任何东西

```
$.ajax({
    url : "http://blalallalalal="+JSON.stringify(pushData),
    type : "POST",
    dataType: "text",
    success: function (data) {

    },
    error: function() {
        // alert("fsdf");
    }
}); 
```

然后从php端使用

```
$data = get_object_vars(json_decode($dataJSON)); 
```

完毕

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:19:32.180

选项1

```
var data = [
  { id: 123, d1: 'aaa', d2: 'xxx' },
  { id: 234, d1: 'bbb', d2: 'yyy' },
  { id: 345, d1: 'ccc', d2: 'zzz' }
]; 
```

选项 2

```
var data = {
  '123': { d1: 'aaa', d2: 'xxx' },
  '234': { d1: 'bbb', d2: 'yyy' },
  '345': { d1: 'ccc', d2: 'zzz' }
}; 
```

然后

```
$.post(url, {mylist: data}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:11:22.217

您可以将它们作为三个数组发送，每个属性一个。

```
myList_id[]=123&myList_d1[]=aaa&myList_d2[]=xxx&myList_id[]=234&... 
```

在 PHP 中，您将以`$_POST['myList_id']`、`$_POST['myList_d1']`和的形式接收它们`$_POST['myList_d2']`，您可以将它们组合成您想要的数组。

或者，如果您包含索引，您可以更进一步：

```
myList[0][id]=123&myList[0][d1]=aaa&myList[0][d2]=xxx&myList[1][id]=234&... 
```

这将直接为您提供数组：`$_POST['myList']`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:16:25.483

如果您使用 jQuerys`$.post`或`$.get`，***则不需要***编码/解码，只需传递一个 JS 对象作为数据参数...

```
var data = {
  "myList" : {
    0 : {"id":1,...etc},
    1 : {"id":2,...etc},
    2 : {"id":3,...etc},
    etc...
  }
};

// post or get
$.post(
  url2post,
  data,
  callbackFunc
); 
```

# java - 拆分字符串两次

> ID：13593030
> 
> 赞同：1
> 
> 时间：2012-11-27T21:05:32.573
> 
> 标签：java, multidimensional-array, split

不确定我的大脑是麻木还是愚蠢，但出于某种原因，这背后的逻辑让我无法理解。基本上在一个 android 应用程序中，我通过 PHP 脚本提取 CSV 信息。该信息显示为

```
value00,value01,value02,value03,value04;value10,value11,value12,value13,value14;value20, etc... 
```

现在我想设置一个二维数组，其中 thisArray[0][0] = value00、thisArray[1][1] = value11、thisArray[1][4] = value14 等。我的代码将由这 ”;” 但我不知道如何将该数组拆分为按我想要的方式设置的二维数组。这就是我所拥有的：（httpMessage 是包含上述信息的字符串）

```
 String[][] secondSplit;//
             String[] firstSplit;//
             String currvalue;//

             firstSplit = httpMessage.split(";");
             for(int i=0; i<firstSplit.length; i++) {
                 Log.d("EFFs" + Integer.toString(i),firstSplit[i]);
             } 
```

LogCat 显示所需的行为，EFFs0 = 第 1 行，EFFs1 = 第 2 行，正是我想要的方式。但是现在，我如何获得第二个维度？另外，由于我 100% 确定这是一个愚蠢的问题，但我会提出一个简单的答案，是否有一种简单的方法可以判断字符串是否为数字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:08:02.573

您可以执行以下操作：

```
secondSplit = new String[firstSplit.length][];
for(int i=0; i<firstSplit.length; i++){
 secondSplit[i] = firstSplit[i].split(",");
} 
```

很确定这会奏效。如果没有，请告诉我！希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:15:47.827

如果您知道有多少行和列，您可以像这样使用[Scanner](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)类（最近从[这个答案](https://stackoverflow.com/a/2786823/16959)中学到了这一点）：

```
Scanner sc = new Scanner(input).useDelimiter("[,;]");
final int M = 5;
final int N = 2;
String[][] matrix = new String[M][N];
for (int r = 0; r < M; r++) {
  for (int c = 0; c < N; c++) {
    matrix[r][c] = sc.next();
  }
}

//Just to see that it worked    
for(String[] row : matrix) {
  for(String col : row) {
    System.out.print(col+",");
  }
  System.out.println();
} 
```

# ruby-on-rails-3 - Rails - 使用面向对象的“高级”

> ID：13593032
> 
> 赞同：0
> 
> 时间：2012-11-27T21:05:36.240
> 
> 标签：ruby-on-rails-3, oop

我想保持我的代码干燥，然后我想转换这个伪代码：

```
def aMethod
  a = aModel.find(2)
  b = a.getVariable
  a.setVariable = c
end 
```

在这样的事情

```
def aMethod
  anotherMethod(aModel, getVariable)
end

def anotherMethod(model, var)
  a = model.find(2)
  b = a.var
  a.var = c
end 
```

在我的测试中，模型似乎没有问题，但是对于`getVariable`（即访问模型的变量）它不起作用：`undefined local variable or method`

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:07:24.550

`send`如果我了解您要执行的操作，您可能想使用，例如，

```
def anotherMethod(model, var_sym)
  a = model.find(2)
  b = a.send(var_sym)
  a.send("#{var_sym}=", c)
end

anotherMethod(aModel, :getVariable) 
```

^(*（需要注意的是，我不知道`a`, `b`, or`c`是什么，或者应该做什么，因为他们是 OP 中的本地人。）*)

# bash - 2 if 语句中的 grep

> ID：13593033
> 
> 赞同：2
> 
> 时间：2012-11-27T21:05:39.140
> 
> 标签：bash, shell, unix

任何人都可以告诉我会出现什么问题？我知道这是一个半秒的问题，但请帮助:)`egrep "first" a.sh && egrep "second" a.sh`有效，a.sh 包含第一、第二、第三等。谢谢！

```
 if [[ egrep "first" a.sh && egrep "second" a.sh ]]; then
 echo "success"
 fi 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T21:14:07.943

您的问题是您正在使用该`[[`命令。只使用 greps。

```
if egrep ... && egrep ... ; then 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:18:50.647

我认为这可能是你想要做的：

```
found_1=$(egrep "first" a.sh)
found_2=$(egrep "second" a.sh)

if [[ -n "$found_1" ]] && [[ -n "$found_2" ]]; then
    echo "success"
fi 
```

# c# - 如何处理任务中的 lambda 表达式中的异常？

> ID：13593037
> 
> 赞同：2
> 
> 时间：2012-11-27T21:05:53.240
> 
> 标签：c#, exception-handling, task, lambda, c#-5.0

我正在尝试将应用程序转换为使用任务而不是 Microsoft 的多线程框架，但我在错误处理方面遇到了问题。从微软的文档（[http://msdn.microsoft.com/en-us/library/vstudio/0yd65esw.aspx](http://msdn.microsoft.com/en-us/library/vstudio/0yd65esw.aspx)）中，我希望下面的 try-catch 能够捕获异常：

```
private async void Button1_Click()
{
    try
    {
        object obj = await TaskFunctionAsync()
    }
    catch(Exception ex)
    {}
}

public Task<object> TaskFunctionAsync()
{
    return Task.Run<object>(() =>
    {
        throw new Exception("foo");
        return new object();
    });
} 
```

但是当 Button1_Click 被触发时，我在 lambda 表达式中得到一个未处理的异常。有没有办法让异常进入try-catch？我认为这种错误处理（所以你不需要从任务工作线程编组）是任务框架的主要好处之一。

我也试过：

```
public async Task<object> TaskFunctionAsync()
{
    return await Task.Run<object>(() =>
        {
            throw new Exception("foo");
            return new object();
        });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:09:56.933

> 但是当 Button1_Click 被触发时，我在 lambda 表达式中得到一个未处理的异常

That's not true. It is unhandled **by user-code** because the framework catches it, but not completely unhandled. Continue running the application to see that the exception will be caught by the catch in Button1_Click.

# matlab - Matlab：在一帧音频数据中查找主要频率

> ID：13593040
> 
> 赞同：2
> 
> 时间：2012-11-27T21:05:55.723
> 
> 标签：matlab, speech, frequency-analysis, audio-analysis

我对 Matlab 很陌生，我正在尝试编写一个简单的基于频率的语音检测算法。最终目标是在 wav 文件上运行脚本，并让它输出每个语音片段的开始/结束时间。如果使用代码：

```
fr = 128;
[ audio, fs, nbits ] = wavread(audioPath);
spectrogram(audio,fr,120,fr,fs,'yaxis') 
```

我得到了一个有用的频率强度与时间图，如下所示：

![在此处输入图像描述](../Images/4b49a2da040f1666dd1e0ee67f5a0d56.png)

通过观察它，很容易看出语音何时发生。我可以编写一个算法来自动化检测过程，方法是查看每个 x 轴帧，找出哪些频率占主导地位（具有最高强度），测试主导频率以查看它们中是否有足够的频率高于某个强度阈值（图上黄色和红色之间的差异），然后将该帧标记为语音或非语音。一旦标记了帧，就很容易获得每个语音片段的开始/结束时间。

我的问题是我不知道如何访问这些数据。我可以使用以下代码：

```
[S,F,T,P] = spectrogram(audio,fr,120,fr,fs); 
```

获取频谱图的所有功能，但该代码的结果对我来说没有任何意义。S、F、T、P 数组和矩阵的边界与我在图表上看到的任何内容都不相关。我已经查看了帮助文件和 API，但是当他们开始抛出算法名称和首字母缩略词时，我感到很困惑——我的 DSP 背景非常有限。

我怎样才能得到这个频谱图分析的每一帧的频率强度值数组？我可以从那里弄清楚其余的，我只需要知道如何获取适当的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-09T09:08:15.757

您正在尝试做的事情称为**语音活动检测**。有很多方法可以解决这个问题，最简单的可能是一个简单的带通滤波器，它通过语音最强的频率，即 1kHz 和 8kHz 之间。然后，您可以将总信号能量与带通限制进行比较，如果大部分能量都在语音频带中，则将帧分类为语音。这是一种选择，但也有其他选择。

要获得峰值频率，您可以使用 FFT 获取频谱，然后使用[peakdetect.m](http://www.mathworks.com/matlabcentral/fileexchange/72-peakdetect-m)。但这是一种非常幼稚的方法，因为您会得到很多峰值，属于基本正弦的谐波频率。

从理论上讲，您应该使用某种倒谱（也称为频谱频谱），它将频谱中谐波的周期性降低到基频，然后将其与峰值检测一起使用。或者，您可以使用执行此操作的现有工具，例如[praat](http://www.fon.hum.uva.nl/praat/)。

请注意，语音分析通常在大约 30 毫秒的帧上完成，步长为 10 毫秒。您可以通过确保在 N 个连续帧中检测到共振峰来进一步过滤掉错误检测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T13:27:57.370

看看 STFT（短时傅立叶变换）或（甚至更好）DWT（离散小波变换），它们都将估计数据块（窗口）中的频率内容，如果你想检测，这就是你所需要的某些（“语音”）频率的幅度突然变化。

**不要使用 FFT**，因为它会计算整个信号持续时间内的相对频率内容，因此无法确定信号中**何时**出现某个频率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:15:13.467

[为什么不使用`fft``fftshift](http://www.mathworks.com/matlabcentral/answers/36430)：

```
 %% Time specifications:
   Fs = 100;                      % samples per second
   dt = 1/Fs;                     % seconds per sample
   StopTime = 1;                  % seconds
   t = (0:dt:StopTime-dt)';
   N = size(t,1);
   %% Sine wave:
   Fc = 12;                       % hertz
   x = cos(2*pi*Fc*t);
   %% Fourier Transform:
   X = fftshift(fft(x));
   %% Frequency specifications:
   dF = Fs/N;                      % hertz
   f = -Fs/2:dF:Fs/2-dF;           % hertz
   %% Plot the spectrum:
   figure;
   plot(f,abs(X)/N);
   xlabel('Frequency (in hertz)');
   title('Magnitude Response'); 
```

为什么要使用复杂的东西？

[在https://dsp.stackexchange.com/questions/1522/simplest-way-of-detecting-where-audio-envelopes-start-and-stop](https://dsp.stackexchange.com/questions/1522/simplest-way-of-detecting-where-audio-envelopes-start-and-stop)中可以找到一个不错的完整解决方案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-14T23:07:25.827

如果您仍然使用内置的 STFT 函数，那么要绘制最大值，您可以使用以下命令

> ```
> plot(T,(floor(abs(max(S,[],1))))) 
> ```

# java - 如何为我的 REST Web 服务创建 SOAP 前端

> ID：13593043
> 
> 赞同：1
> 
> 时间：2012-11-27T21:05:57.000
> 
> 标签：java, web-services, rest, soap, apache-camel

由于内部原因，我不想进入，我必须为我的项目构建 REST Web 服务。由于外部原因，我还需要构建 SOAP Web 服务。由于我们的架构，我的 SOAP Web 服务将不得不调用 REST Web 服务来执行这些功能。

所以，让我们跳过您告诉我通过我们的 REST Web 服务运行 SOAP Web 服务很愚蠢的部分，并讨论如何完成它。

有人说我可以为此使用 Apache Camel，但我想先把它弹起来，如果有的话，看看其他建议。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T16:12:38.750

如果你使用 cxfrs 构建了你的 rest 服务，你应该能够使用 cxf 添加一个soap端点。

您的 cxfrs 端点

```
public class PlanningRestEndpoint implements PlanningEndpoint {
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("plannings/before")
    @Override
    public List<Planning> findPlannings() {
        return null;
    }
} 
```

和你的 cxf 端点

```
@WebService
public interface PlanningEndpoint {
    @WebMethod
    @WebResult(name = "planning")
    List<Planning> findPlannings();
} 
```

并将此端点添加到您的路线

```
from("cxf:bean:planningIn", "cxfrs:bean:planningRestIn")//
  .to(...) 
```

骆驼会为您完成这项工作。

# c# - 检索一些电子邮件信息

> ID：13593044
> 
> 赞同：1
> 
> 时间：2012-11-27T21:05:59.247
> 
> 标签：c#, exchange-server, exchangewebservices

我正在尝试从发送到 Outlook 电子邮件的电子邮件中获取一些信息。我已成功连接到 Exchange Server，并且能够从带有附件的电子邮件中检索一些信息（我正在跳过不带附件的电子邮件）。

**我有什么：**我可以检索附件文件名、电子邮件日期和电子邮件主题。

**我需要什么：**我还需要检索发件人姓名和电子邮件。根据我所做的，我可以检索电子邮件的正文（以 HTML 格式），但不能仅检索正文（需要 Exchange 2013 - Hello MS 广告）。

我是 C# 新手，今天是我第一次连接到 Exchange Server。我从阅读中注意到，“查找”在它可以获得的内容方面是有限的，并且我需要绑定消息才能从电子邮件中获取更多信息。

到目前为止的代码：

```
foreach (Item item in findResults.Items)

                if (item.HasAttachments) // && item.Attachments[0] is FileAttachment)
                {
                    item.Load();
                    FileAttachment fileAttachment = item.Attachments[0] as FileAttachment;
                    date = Convert.ToString(item.DateTimeCreated);
                    name = Convert.ToString(fileAttachment.Name);
                    fileAttachment.Load("C:\\test\\" + fileAttachment.Name);
                    Console.WriteLine(name);
                    Console.WriteLine(item.Subject);
                    Console.WriteLine(date);
                } 
```

我的问题是，如果我执行 EmailMessage msg = EmailMessage.Bind ... 我需要什么信息才能获取更多信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T16:33:45.063

已解决 - 用于获取发件人电子邮件和姓名以及加载附件。

我使用了 EmailMessage 类（只是在上面的循环中添加了它，并将变量添加到开头）：

```
 EmailMessage msg = (EmailMessage)item;
                    senderemail = Convert.ToString(msg.Sender.Address);
                    sendername = Convert.ToString(msg.Sender.Name); 
```

然后我可以在控制台上重现这些：

```
 Console.WriteLine(senderemail);
                    Console.WriteLine(sendername); 
```

此外，为了加载电子邮件的附件，我在开头声明了一个 byte[] 变量，加载了附件，对其进行了转换，并将其内容写入控制台：

```
 fileAttachment.Load();
                    filecontent = fileAttachment.Content;
                    System.Text.Encoding enc = System.Text.Encoding.ASCII;
                    string strFileContent = enc.GetString(filecontent);
                    Console.WriteLine(strFileContent); 
```

# android - 在 AppWidgetProvider 中实现 CountDownTimer

> ID：13593046
> 
> 赞同：2
> 
> 时间：2012-11-27T21:06:08.883
> 
> 标签：android, android-widget, widget, countdown

我想在小部件中实现一个 CountDownTimer。我想出的是：

```
import android.content.Intent;
import android.os.CountDownTimer;
import android.widget.RemoteViews;
import android.widget.TextView;

public class CountDown extends CountDownTimer {
    private RemoteViews views;

    public CountDown(long millisInFuture, int countDownInterval, RemoteViews views) {
        super(millisInFuture, countDownInterval);

        this.views = views;
    }

    @Override
    public void onFinish() {
    }

    @Override
    public void onTick(long millisUntilFinished) {
        int days = (int) (millisUntilFinished / (1000 * 60 * 60 * 24));

            views.setTextViewText(R.id.countWidget, days);
    }
} 
```

和 AppWidgetProvider 类

```
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.Context;
import android.content.Intent;
import android.widget.RemoteViews;
import android.widget.TextView;

public class CountDownWidgetProvider extends AppWidgetProvider {
    private Calendar currentDate = Calendar.getInstance();
    private Calendar firstDecember = Calendar.getInstance();

    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        Date date = new Date();

        this.firstDecember.setTimeZone(TimeZone.getTimeZone("Europe/Berlin"));
        this.currentDate.setTimeZone(TimeZone.getTimeZone("Europe/Berlin"));
        this.firstDecember.set(2012, 11, 1, 0, 0, 0); // TODO: Set to December
        this.currentDate.setTime(date);

        final int N = appWidgetIds.length;

        // Perform this loop procedure for each App Widget that belongs to this provider
        for (int i=0; i<N; i++) {
            int appWidgetId = appWidgetIds[i];

            // Create an Intent to launch MainActivity
            Intent intent = new Intent(context, MainActivity.class);
            PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);

            // Get the layout for the App Widget and attach an on-click listener
            // to the button
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.count_down_app_widget);
            views.setOnClickPendingIntent(R.id.countWidget, pendingIntent);

            long millis = this.firstDecember.getTimeInMillis() - this.currentDate.getTimeInMillis();

            CountDown countDown = new CountDown(millis, 1000, views);
            countDown.start();

            // Tell the AppWidgetManager to perform an update on the current app widget
            appWidgetManager.updateAppWidget(appWidgetId, views);
        }
    }
} 
```

但它不是那样工作的。小部件 TextView 不会刷新甚至更改。倒计时似乎没有开始。

也许我在某个地方犯了一个错误，但我是android开发的新手，所以我想你可以帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:08:07.870

```
you have to update widget after setting the text
use 
 appWidgetManager.updateAppWidget(appWidgetId, views);

 after
  views.setTextViewText(R.id.countWidget, days); 
```

# java - 为什么 Android 会更改我的 JSON 字符串的顺序？

> ID：13593048
> 
> 赞同：1
> 
> 时间：2012-11-27T21:06:14.733
> 
> 标签：java, android, json

我有一个非常简单的问题...在我的 Android 应用程序中，我正在形成一个 JSON 字符串以发送到我的服务器...我的代码中没有错误，但是 Java（或 Android）将值以不同的顺序排列我的，我不知道为什么...

我想解决这个问题，因为我需要在服务器中处理该 JSON 字符串以更新我的数据库的某些表......我在服务器中的 PHP 代码使用我在我的应用程序中使用的相同顺序来解码 JSON 字符串，但是由于Android（或Java）改变了顺序，我在更新表格时遇到了麻烦......

有任何想法吗？提前致谢！

我说的是这个：

在我的应用程序中：

```
json_data.put("id_visit", visits.getString(visits.getColumnIndexOrThrow("id_visit")));
json_data.put("id_form", visits.getString(visits.getColumnIndexOrThrow("id_form")));
json_data.put("id_establishment", visits.getString(visits.getColumnIndexOrThrow("id_establishment")));
json_data.put("id_promoter", visits.getString(visits.getColumnIndexOrThrow("id_promoter")));
json_data.put("actual_date", visits.getString(visits.getColumnIndexOrThrow("actual_date")));
json_data.put("receiver", visits.getString(visits.getColumnIndexOrThrow("receiver")));
json_data.put("observations", visits.getString(visits.getColumnIndexOrThrow("observations")));
json_data.put("gps_coordinates", visits.getString(visits.getColumnIndexOrThrow("gps_coordinates"))); 
```

在 LogCat 中：

```
{
"id_promoter":"1",
"id_establishment":"5",
"id_visit":"1",
"receiver":"brenda lopez",
"gps_coordinates":"10.4905567 -66.8710966",
"actual_date":"2012-11-27",
"id_form":"1",
"observations":"observaciones"
} 
```

如您所见，它的顺序不同！为什么是这样？

我很抱歉没有花时间检查其他人是否已经问过这个问题，但我有点着急，所以......对不起！xD

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:09:16.870

对象键在 JSON 中没有排序。如果你需要一个特定的顺序，我建议你使用一个数组：

```
[
    {"id_promoter":"1"},
    {"id_establishment":"5"},
    {"id_visit":"1"},
    {"receiver":"brenda lopez"},
    {"gps_coordinates":"10.4905567 -66.8710966"},
    {"actual_date":"2012-11-27"},
    {"id_formu":"1"},
    {"observations":"observaciones"}
] 
```

这很糟糕，但顺序是数组的用途。

另一种方法是用所需顺序的键名定义一个数组。然后，您可以使用原始对象结构，但通过数组定义的键访问它。显然，这需要更多的编码，但它也可以解决您的问题。

# android - 持久化动态复选框状态 flash builder android app

> ID：13593049
> 
> 赞同：0
> 
> 时间：2012-11-27T21:06:19.347
> 
> 标签：android, dynamic, checkbox, flash-builder

任何人都可以帮助我使用 Flash Builder 在 android 应用程序中的视图之间检查动态复选框值吗

```
 for(var i:int=0 ; i<data.PromptText.length; i++)
                {
                 chk = new CheckBox();
                 chk.label= data.PromptText.getItemAt(i);
                 chk.name=data.ResponsePromptID.getItemAt(i);

                 chk.addEventListener(MouseEvent.CLICK,ClickEvent);
                 chk.width = 1000;
                 chk.height = 50;
                 addElement(chk);} 
```

在我的 OnClick 事件中，我将复选框数据发送到数据库。但是，当我更改视图时，我无法保存复选框值。我尝试使用 Persistence Manager，但无法保留复选框值。我想知道是否有类似的东西

```
chk.name.selected = SavedState //SavedState = true from my Persistence Manager 
```

请帮助我，如果我让您感到困惑，我深表歉意。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T15:14:43.613

这是我从其他论坛之一获得的答案的链接。这可能对其他人有帮助

[http://forums.adobe.com/message/4887907#4887907](http://forums.adobe.com/message/4887907#4887907)

# c++ - BM_GETCHECK 不工作

> ID：13593051
> 
> 赞同：1
> 
> 时间：2012-11-27T21:06:30.323
> 
> 标签：c++, winapi

我有这样的代码：

```
In WM_CREATE

    hCheckBox = CreateWindowEx(0,"Button","Random text", WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS| BS_AUTOCHECKBOX | BS_TEXT | WS_GROUP | WS_TABSTOP,150,323,300,20,hwnd,0,hInstance,0) ;

In WM_COMMAND

    if ( SendMessage( hCheckBox , BM_GETCHECK, (WPARAM) NULL, (LPARAM) NULL ) == BST_CHECKED )
        MessageBox( 0, "Working", "Msg", 0 ); 
```

不管复选框是否被选中，它永远不会返回 BST_CHECKED。试图让它在最后 2 小时内工作:(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:52:17.473

是否`hCheckBox`是局部自动变量并不完全清楚。`CreateWindow`如果是这样，我可以向您保证，从触发到收到 WM_COMMAND 消息，它不会保持其值。改用这个：

```
LRESULT chk = SendDlgItemMessage(hDlg, IDC_CHECKBOX_CTRL_ID, BM_GETCHECK, 0, 0); 
```

`hDlg`您的对话框或主窗口句柄在哪里，并且`IDC_CHECKBOX_CTRL_ID`是控件 ID。为此，您需要将控件 ID 指定为创建调用的 HMENU 参数的非零值：

```
hCheckBox = CreateWindowEx(0,"Button","Random text", WS_CHILD | WS_VISIBLE | 
    WS_CLIPSIBLINGS| BS_AUTOCHECKBOX | BS_TEXT | WS_GROUP |
    WS_TABSTOP,150,323,300,20,hwnd, IDC_CHECKBOX_CTRL_ID, hInstance,0); 
```

如果它不明显。将 IDC_CHECKBOX_CTRL_ID 定义为非零整数。

* * *

**编辑**

假设控件设置正确，您应该能够在 WndProc 中为该复选框处理 WM_COMMAND，如下所示

```
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    int wmId, wmEvent;
    switch (message)
    {
    case WM_CREATE:
        CreateWindowExA(0,"Button","Random text", WS_CHILD | WS_VISIBLE | 
            WS_CLIPSIBLINGS| BS_AUTOCHECKBOX | BS_TEXT | WS_GROUP |
            WS_TABSTOP,100,100,300,48, hWnd, (HMENU)IDC_CHECKBOX_CTRL_ID, hInst, 0);
        break;

    case WM_COMMAND:
        wmId = LOWORD(wParam);
        wmEvent = HIWORD(wParam);

        // Parse the menu selections:
        if (wmId == IDC_CHECKBOX_CTRL_ID)
        {
            if (wmEvent == BN_CLICKED)
            {
                LRESULT chkState = SendMessage((HWND)lParam, BM_GETCHECK, 0, 0);
                if (chkState == BST_CHECKED)
                    MessageBoxA(hWnd, "Checkbox is checked!", "CheckBox", MB_OK);
            }
            break;
        };
        // fall-thru intentional

    default:
        return DefWindowProc(hWnd, message, wParam, lParam);
    };

    return 0;
} 
```

我只是把它撞到一个带有空白窗口的普通 WIN32 应用程序中。结果如下图所示：

![勾选复选框的结果](../Images/10fc1f9e031381e8018198f875dbfcbc.png)

# c# - 如何使用 Linq 查询存储过程对象

> ID：13593068
> 
> 赞同：2
> 
> 时间：2012-11-27T21:07:34.353
> 
> 标签：c#, linq, entity-framework

假设我遇到了这种情况：我必须使用从存储过程中获得的数据过滤我的一个实体：

```
var results = from c in db.Customer
join p in db.GetSPResults() on c.Id equals p.Id
select c; 
```

在我的 Context 课上，我得到了这个：

```
public ObjectResult<Example> GetSPResults()
{
    return (this as IObjectContextAdapter).ObjectContext.ExecuteFunction<Example>("Proc_Example");
} 
```

到目前为止，我遇到了两个问题：

1.  当代码到达 ExcecuteFunction 行时，我得到一个 InvalidOperationException：

    > *在容器 'xxx' 中找不到 FunctionImport 'xxx'*。

2.  假设你们可以帮助我解决这个问题，是否可以这样查询？像上下文实体一样使用那些存储过程结果？我认为 EF 不允许这样做，因为它不是实体，也不是“常量值”。

我正在使用 EF 4.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:28:40.073

而不是通过名称作为字符串调用您的过程，您可以将其导入实体模型中，然后您可以直接在 DbContext 上调用类型安全/强类型的方法。

基本上你需要执行一个函数导入，见这里的例子：[Using stored procedures with Entity Framework](http://weblogs.asp.net/dotnetstories/archive/2011/03/01/using-stored-procedures-with-entity-framework-in-an-asp-net-application.aspx)

更新：对于 POCO / Code first，请参见此处：[EF Code-First - 映射存储过程](https://stackoverflow.com/questions/7664449/ef-code-first-mapping-stored-procedures)

# java - Android：单击按钮后隐藏键盘

> ID：13593069
> 
> 赞同：35
> 
> 时间：2012-11-27T21:07:35.163
> 
> 标签：java, android, keyboard, hide

单击按钮后，我需要隐藏 android 键盘。

我已经看到了很多如何做到这一点的例子，但是，它们似乎都使用了特定的 editText 对象。

例如

```
InputMethodManager imm = (InputMethodManager)getSystemService(
      Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow(myEditText.getWindowToken(), 0); 
```

我的问题是我正在动态构建屏幕，因此可能有鬃毛编辑文本字段。有没有一种方法可以隐藏键盘，而无需我指定要隐藏它的 editText 对象。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-27T21:17:25.223

您可以改为将其设置为您的布局，即：

```
LinearLayout mainLayout;

// Get your layout set up, this is just an example
mainLayout = (LinearLayout)findViewById(R.id.myLinearLayout);

// Then just use the following:
InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow(mainLayout.getWindowToken(), 0); 
```

这是一个假设无论放置多少`EditText`对象（或其他对象）都将创建您的布局的示例。

编辑：另外，我发现非常有用的是确保在活动首次启动时隐藏键盘（即：如果 an`EditText`是第一个关注的对象）。为此，我将其放入`onCreate()`Activity 方法中：

```
 this.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN); 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2014-12-01T12:36:47.667

**不要忘记使用 try catch 博客，因为如果您的键盘未打开并且如果您使用键盘隐藏代码应用程序将崩溃**

```
try {
    InputMethodManager imm = (InputMethodManager)getSystemService(INPUT_METHOD_SERVICE);
    imm.hideSoftInputFromWindow(getCurrentFocus().getWindowToken(), 0);
} catch (Exception e) {
    // TODO: handle exception
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-07-24T08:25:41.017

您可以使用以下代码隐藏键盘，可能在**Button click Event 上：**

```
//================ Hide Virtual Key Board When  Clicking==================//

InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow("Your Button/EditText Object".getWindowToken(), InputMethodManager.RESULT_UNCHANGED_SHOWN);

//======== Hide Virtual Keyboard =====================// 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-02-10T09:29:25.760

如果问题出在一项活动上，那么以下操作将起作用：

```
 try {
        InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(getCurrentFocus().getWindowToken(), 0);
    } catch (Exception e) {
        // TODO: handle exception
    } 
```

否则，如果片段中需要代码，请执行以下操作

```
 try {
        InputMethodManager imm = (InputMethodManager)getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(getActivity().getCurrentFocus().getWindowToken(), 0);
    } catch (Exception e) {
        // TODO: handle exception
    } 
```

这将处理在按钮单击或任何其他在事件块中写入时被视为特定事件时隐藏的键盘。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-11-09T09:53:48.323

```
edittext.onEditorAction(EditorInfo.IME_ACTION_DONE); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-02-07T22:36:58.853

记录在案并基于@burmat 和@Prashant Maheshwari Andro 的回答

假设您按如下方式调用单击按钮。其中 buttonAndroidLogin_button 是 Button 对象。

```
protected void onCreate(Bundle savedInstanceState) {
    // your code...
    buttonAndroidLogin_button.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            hideKeyboard((Button)v);
            // ....
} // end onCreate 
```

在活动上，您必须设置下一个方法

```
public void hideKeyboard(View view) {
    try {
        InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(view.getWindowToken(), 0);
    } catch(Exception ignored) {
    }
} 
```

**它使用相同的按钮隐藏输入**，因此我们不需要任何线性布局、文本视图或任何其他任意控件。此外，代码可重复用于更多按钮。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-10-26T05:44:32.037

您使用此代码

```
// Check if no view has focus:
View view = this.getCurrentFocus();
if (view != null) {  
    InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.hideSoftInputFromWindow(view.getWindowToken(), 0);
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-09-23T06:26:31.717

**在科特林：**

**在你的`fragment`：**

**像这样创建扩展：**

```
fun Fragment.hideKeyboard() {
    val imm = context?.getSystemService(Context.INPUT_METHOD_SERVICE) as InputMethodManager
    imm.hideSoftInputFromWindow(requireView().windowToken, 0)
} 
```

然后像这样使用它：

```
hideKeyboard() 
```

**在你的`activity`：**

**像这样创建扩展：**

```
fun AppCompatActivity.hideKeyboard() {
    val imm = this.getSystemService(Context.INPUT_METHOD_SERVICE) as InputMethodManager
    imm.hideSoftInputFromWindow(this.window.attributes.token, 0)
} 
```

然后像这样使用它：

```
 hideKeyboard() 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-11T17:08:32.427

```
InputMethodManager inputManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
inputManager.hideSoftInputFromWindow(rootView.getWindowToken(), 0); 
```

# android - 有效地将 5 个大于全屏的位图加载到我的 Android 动态壁纸中并滚动它们

> ID：13593071
> 
> 赞同：3
> 
> 时间：2012-11-27T21:07:40.517
> 
> 标签：android, bitmap, wallpaper, parallax, bitmapfactory

所以我是 Java 和这种编码的新手。

我正在尝试制作视差滚动动态壁纸。但我有记忆问题。

好吧，我已经成功了，它可以在我拥有的手机上运行。但我认为我这样做的方式根本不是很有效。因为当我在其他手机上尝试时，它不起作用。它打破了我的内存不足捕手。我添加了另一层，现在它也在我的手机上做同样的事情。所以我可以调试它。基本上我想我正在使用高达或超过 16 兆的内存。

如果有人可以查看我的代码并帮助我更有效地加载位图，将不胜感激。

这是我目前的做法：

```
static class Layer {
    public Bitmap bitmap;
    private float scale = 1.0f;
    private Matrix matrix = new Matrix();
    public Layer(Bitmap b) {
        this.bitmap = b;
    }
    public void setScale(float factor) {
        scale = factor;
    }
    public Matrix getMatrix(float x, float y) {
        if (scale == 1) {
            matrix.reset();
        } else {
            matrix.setScale(scale, scale);
        }
        matrix.postTranslate(x, y);
        return matrix;
    }
}

public static List<Integer> findLayers(Integer path) {

    List<Integer> files = new ArrayList<Integer>();

    files.add(R.drawable.planet_layer4);
    files.add(R.drawable.planet_layer3);
    files.add(R.drawable.planet_layer2);
    files.add(R.drawable.planet_layer1);    
    files.add(R.drawable.planet_layer0);

    return files;
}   

    private void loadLayers() {
        try {
            clearLayers();
            for (Integer file: layerFiles) {
                addLayer(file);
            }
            recalibrateLayers();
        } catch (IOException e) {
            layers.clear();
            Toast.makeText(LiveWallpaper.this, "There was a problem loading the wallpaper. Please contact the developer.", Toast.LENGTH_LONG).show();
        } catch (OutOfMemoryError oom) {
            layers.clear();
            Toast.makeText(LiveWallpaper.this, "Whoops, we ran out of memory trying to load the images. ", Toast.LENGTH_LONG).show();
        }
    }

    private void addLayer(int name) throws IOException {
        Bitmap layer = BitmapFactory.decodeResource(getResources(), name);
        if (layer == null) {
            throw new IOException("BitmapFactory couldn't decode asset " + name);
        }
        synchronized(layers) {
            layers.add(new Layer(layer));
        }
    }

    private void clearLayers() {
        synchronized(layers) {
            layers.clear();
        }
    }

    private void recalibrateLayers() {
        for (Layer layer : layers) {
            final int bitmapHeight = layer.bitmap.getHeight();
            layer.setScale((float)mHeight / (float)bitmapHeight);
        }
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        mHandler.removeCallbacks(mDrawParallax);
    }

    @Override
    public void onSurfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        super.onSurfaceChanged(holder, format, width, height);

        mHeight = height;

        recalibrateLayers();

        drawBackgrounds();

    } 
```

这是我画它们的地方。

```
/*
     * Draw one frame of the animation. This method gets called repeatedly
     * by posting a delayed Runnable. You can do any drawing you want in
     * here.
     */
    void drawBackgrounds() {
        final SurfaceHolder holder = getSurfaceHolder();
        final Rect frame = holder.getSurfaceFrame();

        mFrame = frame;

        Canvas c = null;
        try {
            c = holder.lockCanvas();
            if (c != null) {
                // draw something
                drawParallax(c);
            }
        } finally {
            if (c != null) holder.unlockCanvasAndPost(c);
        }

    }

    void drawParallax(Canvas c) {
        int frameWidth = mFrame.width();

        for (int i=layers.size()-1; i>=0; i--) {
            Layer layer = layers.get(i);
            Bitmap bitmap = layer.bitmap;
            float bitmapWidth = bitmap.getWidth() * layer.scale;
            float max = frameWidth - bitmapWidth;
            float offset = mOffset * max;

            final Matrix m = layer.getMatrix(offset, 0);

            c.drawBitmap(bitmap, m, null);
        }

    } 
```

# c# - 将 XML 元素和子元素放入列表

> ID：13593073
> 
> 赞同：0
> 
> 时间：2012-11-27T21:07:49.330
> 
> 标签：c#, xml, linq

给定以下 XML，我如何使用以下实现将每条记录读入对象列表（记录列表）？

```
class Record
{
   public string Name {get; set;}
   public List<Skill> Skills {get; set;}
}

class Skill
{
   public string SkillName {get; set;}
   public string SkillType {get; set;}
} 
```

xml

```
<records>
   <record>
      <name>John</name>
      <skills>
         <skill>
            <skillname>Tennis</skillname>
            <skilltype>Sport</skilltype>
         </skill>
         <skill>
            <skillname>Violin</skillname>
            <skilltype>Music</skilltype>
         </skill>
      </skills>
   </record>
   <record>
      <name>Juanita</name>
      <skills>
         <skill>
            <skillname>Football</skillname>
            <skilltype>Sport</skilltype>
         </skill>
         <skill>
            <skillname>Pottery</skillname>
            <skilltype>Craft</skilltype>
         </skill>
      </skills>
   </record>
</records> 
```

我尝试获取子元素（技能）没有成功。

```
List<Records> records;
DataSet dstRecords = new DataSet();
dstRecords.ReadXml(file);

foreach (DataRow row in dstRecords.Tables[0].Rows)
            {

                Record record = new Record
                {
                    Name = Convert.ToString(row["name"]),
                    Skills = skills
                };
                records.Add(records);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:13:39.600

```
XDocument xDoc = XDocument.Parse(xmlstring); //or XDocument.Load(filename);
var list = xDoc.Descendants("record")
            .Select(r => new Record
            {
                Name = (string)r.Element("name"),
                Skills = r.Descendants("skill")
                           .Select(s=>new Skill{
                               SkillName = (string)s.Element("skillname"),
                               SkillType = (string)s.Element("skilltype"),
                           })
                           .ToList()
            })
            .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:10:50.250

假设您想要 Linq-to-XML，您只需“链接”对`Element`和`Elements`（或`Descendants`）的必要调用：

```
// assuming XDocument xdoc = ...
var records = from r in xdoc.Root.Elements("record")
              select new Record
              {
                  Name = (string)r.Element("name"),
                  Skills = (from s in r.Element("skills").Elements("skill")
                            select new Skill
                            {
                                SkillName = (string)s.Element("skillname"),
                                SkillType = (string)s.Element("skilltype")
                            }).ToList()
              }; 
```

# java - Java - 制作绘图点，接近线性 - 完全线性

> ID：13593082
> 
> 赞同：0
> 
> 时间：2012-11-27T21:08:19.017
> 
> 标签：java, math, coordinates, point, threshold

我将如何改变“接近”线性（在阈值内）实际上是线性的点？

我有一些代码可以检查 3 个点是否彼此线性（给予或接受），我想用 100% 内联的新坐标替换这些坐标。

```
 double distance = (x1 - x2) * (y1 - y3) - (y1 - y2) * (x1 - x3);

        double threshold = 4;

        if (Math.abs(distance) <= threshold) {
            // is Near line
            return true;
        }
        else
            return false; 
```

这是我的另一篇文章的扩展......这不是转发，只是一个相关主题：

[Java - 平均线性图](https://stackoverflow.com/questions/13591837/java-average-linear-graph-plots/13591977#comment18631319_13591977)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:38:02.313

将点捕捉到线的技术术语是将点投影到线（-段）

剩下的唯一问题是：点应该投影到线还是线段？（一条线段只在两点之间，这条线的长度是无穷大并且穿过两点）

下面的代码解决了这两个问题：为了还允许将点投影到点 A->B 之外的线的一部分，代码会简单得多，但这也包含在下面的链接中。

见[http://forums.codeguru.com/showthread.php?194400-Distance-between-point-and-line-segment](http://forums.codeguru.com/showthread.php?194400-Distance-between-point-and-line-segment)

投影点在变量 (xx,yy) 中： (xx,yy) 是 lineSegment 上最接近 (cx,cy) 的点

# mysql - 查询今年购买了多少，对于每个艺术家

> ID：13593083
> 
> 赞同：2
> 
> 时间：2012-11-27T21:08:21.380
> 
> 标签：mysql, database

我需要列出艺术家的 Id_no、姓氏 (lname) 以及今年在他们的发行版中是如何购买的。有关购买的唯一信息是不同的购买日期。

到目前为止我的代码：

```
SELECT id_no, lname, purchasedate AS num_ops
FROM Artist JOIN Sales ON Artist.id_no = Sales.artist
WHERE DATE_SUB(CURDATE(),INTERVAL 1 YEAR) <= purchasedate 
```

但是，这只会返回已经进行销售的 Id_no，即使它是 0，我也需要全部。 On `distrinctl name`，并且`num_ops`是他们的第一个日期`purchasedate`。我需要更改此代码以列出他们在今年内参与的购买次数。我试过使用，`COUNT(purchasedate)`但是这只返回一行。我希望返回表返回：

第 1 列：艺术家的 ID 第
2 列：艺术家的姓氏
第 3 列：购买了他们的 CD 的人数（这是购买的数量）

我主要在第 3 栏上苦苦挣扎，任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:54:03.360

你需要：

*   *左*连接_
*   将日期条件移动到`ON`JOIN 的子句中
*   使用`count(*)`聚合函数

像这样：

```
SELECT id_no, lname, count(purchasedate) as num_ops
FROM Artist
LEFT JOIN Sales ON Artist.id_no = Sales.artist
    AND DATE_SUB(CURDATE(),INTERVAL 1 YEAR) <= purchasedate
GROUP BY id_no, lname 
```

*   `LEFT JOIN`即使没有销售，这将确保为每位艺术家返回一行
*   通过将日期条件移动到连接中，即使该年没有销售，仍将为每位艺术家返回一行。如果条件保留在`WHERE`子句中，则会过滤掉去年没有销售的艺术家。

这里的一个关键点是连接条件可能包含与所涉及的键无关的条件 - 这就是您获得*条件*连接的方式，这就是您想要让左连接仍然正常工作的方式

# mysql - 基于位置的慢速搜索结果查询

> ID：13593087
> 
> 赞同：1
> 
> 时间：2012-11-27T21:08:26.683
> 
> 标签：mysql, sql

我有一个查询，用于查找按位置排序的结果。结果还必须考虑增值税，因此这也在查询中。不幸的是，如果没有缓存，查询可能需要 4 秒以上的时间才能运行。任何人都可以发现任何明显的问题或建议我可以做些什么来改进它吗？

只是为了澄清查询中发生的事情：

*   距离是使用纬度/经度计算欧几里得距离
*   incvat 字段用于显示包含增值税时的价格
*   WHEN / THEN 语句用于将 0 的价格放在最底部

查询：

```
SELECT * , ROUND( SQRT( POW( ( 69.1 * ( company_branch_lat - 52.4862 ) ) , 2 ) + POW( ( 53 * ( company_branch_lng - - 1.8905 ) ) , 2 ) ) , 1 ) AS distance, 
    hire_car_day + ( hire_car_day * 0.2 * ! hire_car_incvat ) AS hire_car_day_incvat, 
    hire_car_addday + ( hire_car_addday * 0.2 * ! hire_car_incvat ) AS hire_car_addday_incvat, 
    hire_car_week + ( hire_car_week * 0.2 * ! hire_car_incvat ) AS hire_car_week_incvat, 
    hire_car_weekend + ( hire_car_weekend * 0.2 * ! hire_car_incvat ) AS hire_car_weekend_incvat
FROM hire_car
LEFT JOIN company_branch ON company_branch_id = hire_car_branchid
LEFT JOIN hire_cartypelink ON hire_cartypelink_carhireid = hire_car_id
LEFT JOIN users ON company_branch_userid = user_id
WHERE 1 
GROUP BY hire_car_id
HAVING distance <=30
ORDER BY CASE hire_car_day_incvat
WHEN 0 
THEN 40000 
ELSE hire_car_day_incvat
END , distance ASC 
LIMIT 0 , 30 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:25:23.983

您可以使用mysql空间扩展并将纬度和经度保存为点数据类型并使其成为空间索引。这样，您可以沿曲线重新排列坐标并减少维度并保留空间信息。您可以使用空间索引作为边界框来过滤查询，然后使用 harvesine 公式选择最佳结果。您的边界框应该大于大圆的半径。Mysql 使用带有一些空间索引的 rtree，我的示例是关于 az 曲线或希尔伯特曲线：[https ://softwareengineering.stackexchange.com/questions/113256/what-is-the-difference-between-btree-and-rtree-索引](https://softwareengineering.stackexchange.com/questions/113256/what-is-the-difference-between-btree-and-rtree-indexing)。然后您可以将地理坐标直接插入点列：[http ://dev.mysql.com/doc/refman/5.0/en/creating-spatial-values.html](http://dev.mysql.com/doc/refman/5.0/en/creating-spatial-values.html). 或者您可以使用几何数据类型： http: [//markmaunder.com/2009/10/10/mysql-gis-extensions-quick-start/](http://markmaunder.com/2009/10/10/mysql-gis-extensions-quick-start/)。然后你可以像这样使用 MBRcontains 函数：http://dev.mysql.com/doc/refman/4.1/en/relations-on-geometry-mbr.html[或](http://dev.mysql.com/doc/refman/4.1/en/relations-on-geometry-mbr.html)任何其他函数：[http ://dev.mysql.com /doc/refman/5.5/en/functions-for-testing-spatial-relations-between-geometric-objects.html](http://dev.mysql.com/doc/refman/5.5/en/functions-for-testing-spatial-relations-between-geometric-objects.html)。因此，您需要一个边界框。这里有些例子：

*   [使用空间点类型在 MySQL 中存储 Lat Lng 值](https://stackoverflow.com/questions/4995428/storing-lat-lng-values-in-mysql-using-spatial-point-type)
*   [https://gis.stackexchange.com/questions/28333/how-to-speed-up-this-simple-mysql-points-in-the-box-query](https://gis.stackexchange.com/questions/28333/how-to-speed-up-this-simple-mysql-points-in-the-box-query)

这是一个带有点数据类型的简单示例：

```
 CREATE SPATIAL INDEX sx_place_location ON place (location)

    SELECT  * FROM    mytable
    WHERE   MBRContains
           (
           LineString
                   (
                   Point($x - $radius, $y - $radius),
                   Point($x + $radius, $y + $radius)
                   )
           location
           )
    AND Distance(Point($x, $y), location) <= $radius 
```

*   [MySQL 纬度和经度表设置](https://stackoverflow.com/questions/4726031/mysql-latitude-and-longitude-table-setup)。

我不确定它是否有效，因为它使用带有边界框函数的半径变量。在我看来 MBRwithin 有点简单，因为它不需要任何参数：[Mysql: Optimizing find super node in nested set tree](https://stackoverflow.com/questions/1743894/mysql-optimizing-finding-super-node-in-nested-set-tree)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:07:09.623

您将 GROUP BY 语句与 HAVING 一起使用，尽管我在查询中没有看到任何聚合函数。我建议您像这样重新编写查询，看看它是否有任何不同

```
SELECT * , ROUND( SQRT( POW( ( 69.1 * ( company_branch_lat - 52.4862 ) ) , 2 ) + POW( ( 53 * ( company_branch_lng - - 1.8905 ) ) , 2 ) ) , 1 ) AS distance, 
hire_car_day + ( hire_car_day * 0.2 * ! hire_car_incvat ) AS hire_car_day_incvat, 
hire_car_addday + ( hire_car_addday * 0.2 * ! hire_car_incvat ) AS hire_car_addday_incvat, 
hire_car_week + ( hire_car_week * 0.2 * ! hire_car_incvat ) AS hire_car_week_incvat, 
hire_car_weekend + ( hire_car_weekend * 0.2 * ! hire_car_incvat ) AS hire_car_weekend_incvat
FROM hire_car
LEFT JOIN company_branch ON company_branch_id = hire_car_branchid
LEFT JOIN hire_cartypelink ON hire_cartypelink_carhireid = hire_car_id
LEFT JOIN users ON company_branch_userid = user_id
WHERE ROUND( SQRT( POW( ( 69.1 * ( company_branch_lat - 52.4862 ) ) , 2 ) + POW( ( 53 * ( company_branch_lng - - 1.8905 ) ) , 2 ) ) , 1 ) <= 30
ORDER BY CASE hire_car_day_incvat
WHEN 0 
THEN 40000 
ELSE hire_car_day_incvat
END , distance ASC 
LIMIT 0 , 30 
```

# java - 在java中将字符串转换为浮点数

> ID：13593093
> 
> 赞同：-4
> 
> 时间：2012-11-27T21:08:46.617
> 
> 标签：java, string, floating-point

> **可能重复：**
> [java：将浮点数转换为字符串，将字符串转换为浮点数](https://stackoverflow.com/questions/7552660/java-convert-float-to-string-and-string-to-float)

我正在从字符串中提取一些数字，这些数字被存储为另一个字符串。有没有办法将这些字符串转换为浮点数？

我试过 float f = "string"; 但这没有用。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:09:25.710

你正在寻找[`Float.parseFloat()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Float.html#parseFloat%28java.lang.String%29).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:09:54.913

这样---: Float.parseFloat("0.4");

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:14:35.013

尝试[Float.parseFloat](http://docs.oracle.com/javase/7/docs/api/java/lang/Float.html)，但如果失败，它会抛出[RuntimeException](http://docs.oracle.com/javase/7/docs/api/java/lang/RuntimeException.html)，所以这是我建议抓住它的一次。

```
try {
    Float.parseFloat("0.4")
} catch (NumberFormatException e){ 
  //input is not a float
} 
```

如果您想要更精确，请查看[Double.parseDouble()](http://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#parseDouble%28java.lang.String%29)甚至[BigDecimal 字符串构造函数](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html#BigDecimal%28java.lang.String%29)

# google-apps-script - Google 电子表格脚本：工作表是隐藏的还是可见的？

> ID：13593097
> 
> 赞同：1
> 
> 时间：2012-11-27T21:08:52.417
> 
> 标签：google-apps-script, google-sheets

在自定义 Google 电子表格功能中，有没有办法确定`sheet`（选项卡）是隐藏还是可见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T07:06:40.873

谷歌最近添加了[隐藏](https://developers.google.com/apps-script/reference/spreadsheet/sheet#hideSheet%28%29)和[显示](https://developers.google.com/apps-script/reference/spreadsheet/sheet#showSheet%28%29)工作表的功能。要知道工作表是否隐藏，添加了一个新函数[isSheetHidden()](https://developers.google.com/apps-script/reference/spreadsheet/sheet#isSheetHidden%28%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T08:49:09.433

不幸的是，不支持电子表格的隐藏/取消隐藏类。有一个[开放的增强请求](http://code.google.com/p/google-apps-script-issues/issues/detail?id=995&q=hide%20sheet&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)。用于隐藏/显示工作表；您可能想给它加星标/评论以保持更新。

# eclipse - Maven 和 M2Eclipse 共存

> ID：13593098
> 
> 赞同：0
> 
> 时间：2012-11-27T21:08:58.047
> 
> 标签：eclipse, maven, m2eclipse

首先，我已经安装`maven 3`到 /path/to/maven 并在下面配置了 /path/to/maven/conf/setting.xml，

```
<localRepository>/path/to/repository</localRepository> 
```

然后`m2eclipse`在 Eclipse 3.7.2 for Java EE 上安装并在下面进行配置，

```
preferences->maven->
 installation->"/path/to/maven"
 userSettings->"/path/to/maven/conf/setting.xml"
 localRepository->"/path/to/repository" 
```

通过 完成索引构建后，在下面的 /path/to/repository 和 /path/to/home/.m2/repository 下都生成`m2eclipse`了一个重复的目录，`.cache`

```
.cache/
└── [4.0K]  m2e
    └── [4.0K]  1.2.0
        └── ....
            ├── [ 64M]  nexus-maven-repository-index.gz
            └── [1.1K]  nexus-maven-repository-index.properties 
```

*   什么可能导致索引重复？这只是正常的吗？

*   `mvn CLI`如果我同时使用两者并`m2eclispe`交替使用（不是并行），对上面的索引会有什么副作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T02:44:08.263

拥有两个存储库并不常见。m2e 和 cli 都应该指向同一个 repo。验证 Maven 的 Eclipse 设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:57:54.517

有重复的存储库可能是由格式错误的 settings.xml 引起的。例如，如果它包含错误（如一些未关闭的标签），m2eclipse 将忽略它并使用默认值生成一个新的内存设置模型。

在命令行中，检查是否`mvn help:effective-settings`正确执行。

缓存索引仅供 m2e 使用，因此在同时使用 m2e 和 maven CLI 时不会损坏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T02:54:16.557

Sachin 是对的——你可能配置错误。也就是说，我会考虑在我的主目录中删除一个符号链接，而不是配置不同的路径。这样就不需要确保任何工具配置正确，因为默认位置只是指向其他地方。

# jquery-ui - jQueryUI 自动完成仅绑定到第一个元素

> ID：13593107
> 
> 赞同：2
> 
> 时间：2012-11-27T21:09:19.223
> 
> 标签：jquery-ui, jquery-ui-autocomplete

我有一个包含一行输入的表单。其中一个输入是 jQueryUI 自动完成，每行旁边都有一个按钮，用于克隆该行，以便可以创建其他记录。我有自动完成设置来识别并绑定到新创建的输入：

```
$( '.input .my-field' ).on( 'focus', function() {
  var $this = $( this );

  $this.autocomplete({ ... });
}); 
```

我发现的是：

1.  第一行中的自动完成字段工作正常。
2.  *如果我没有在第一行中为该字段输入值，*则第二行中的自动完成字段可以正常工作。
3.  *如果我确实*在第一行中输入了一个值，那么第二行中的自动完成字段根本不起作用。

底线是，如果我首先创建所有行，一切都会按预期工作，但这不是预期的用例。大多数人会输入第一条记录，单击添加另一个，输入这些值，单击添加另一个，冲洗，重复。

我仍然在运行它，但我正在浪费时间，所以我希望有人会知道发生了什么，并且能够加入一个不需要我自己工作几个小时的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:53:32.470

`autocomplete`在克隆输入之后，在重新创建输入之前，您必须执行两个额外的步骤：

1.  移除`aria-haspopup`属性；
2.  删除`autocomplete`数据。

只是调用`autocomplete("destroy")`是行不通的，由于某种原因，它会破坏原始输入而不是克隆。[jsFiddle](http://jsfiddle.net/tZ92F/1/)的工作示例。相关代码如下：

```
var clone = $(...)
    .clone(true)
    .removeAttr("aria-haspopup")
    .data("autocomplete",null); 
```

# c - GTK3 在重复太快时有时会忽略 gtk_widget_queue_draw？

> ID：13593113
> 
> 赞同：3
> 
> 时间：2012-11-27T21:09:34.120
> 
> 标签：c, gtk, gtk3

我有一个应用程序可以进行一些模拟并呈现结果。因为渲染有时会很慢，所以我将它分离到另一个线程中，`gtk_widget_queue_draw`一旦准备好，主线程就会调用。如果还没有完成绘制，额外的请求将被丢弃（因为`queue_draw`只会使其无效，并且不可能“更多”无效）。

结果是，对于大型复杂系统，模拟最大化一个线程，渲染最大化另一个线程，一切正常。

我刚刚遇到了一个不同的问题，我不明白为什么会这样：足够简单的模拟和渲染（6 条 5 点线）会导致它中断。

前几个步骤（我在任何地方都看到了大约 60 到 400 个）渲染良好（在几分之一秒内），直到一个步骤渲染两次。之后，它会忽略`queue_draw`, 直到我在渲染窗口上拖动一个窗口，然后它重新启动（直到它再次中断）。

如果我人为地减慢请求（`usleep(10000)`足够），这不会发生。

然而，这是一个完全不可接受的解决方案，因为不允许显示的过程干扰正常的模拟线程（无延迟，无互斥体等）。我需要一个使渲染线程“尽可能好”的解决方案，因为它正在处理易失性数据。它不必非常准确——我真的不在乎帧渲染是否有一点错误（帧 i 的一半，i+1 的一半很好），只要它确实渲染。

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-30T10:11:52.357

你有一个竞争条件。

**从 GTK3.6 开始**，您需要这样调用`gtk_widget_queue_draw`：

```
g_idle_add((GSourceFunc)gtk_widget_queue_draw,(void*)window); 
```

或像这样：

```
gdk_threads_add_idle((GSourceFunc)gtk_widget_queue_draw,(void*)window); 
```

其中 window 是`GtkWidget*`您要绘制的。

`gdk_threads_add_idle`如果您不确定应用程序使用的库或代码是否使用已弃用（自 3.6 起）和`gdk_threads_enter`函数`gdk_threads_leave`，请使用。

请参阅：[https ://developer.gnome.org/gdk3/stable/gdk3-Threads.html#gdk3-Threads.description](https://developer.gnome.org/gdk3/stable/gdk3-Threads.html#gdk3-Threads.description)

**在 GTK3.6 之前**`gdk_threads_enter`，必须`gdk_threads_leave`用于获取 GTK 调用的锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:41:56.850

您是否使用 gdk_threads_enter/gdk_threads_leave 锁定了线程中的 UI 调用？也许添加代码示例也会有所帮助......

# c# - 使用 ASPNET MVC 4 和 webapi 自定义 httphandler 和 routehandler

> ID：13593114
> 
> 赞同：11
> 
> 时间：2012-11-27T21:09:38.177
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, asp.net-web-api, asp.net-web-api-routing

我正在研究 ASPNET MVC 4 和 WebApi。webapi 方法将被移动设备使用。我们需要保护服务，我们使用的是以某种特定方式加密数据。

现在，我需要在到达控制器之前解密调用。如果解密的信息是有效的，它应该像往常一样继续到控制器，如果不是，我会将用户路由到一些错误方法。

要做到这一点，我认为最好的选择是自定义 HttpHandler 和自定义 RouteHandler。我在[这里按照教程](http://geekswithblogs.net/sankarsan/archive/2009/01/18/developing-custom-routehandler.aspx)

```
 public class MvcSecurityRouteHandler:IRouteHandler 
   { 
       public System.Web.IHttpHandler GetHttpHandler(RequestContext requestContext) 
       { 
          return new MvcSecurityHttpHandler(requestContext); 
       }
   }

public class MvcSecurityHttpHandler : IHttpHandler, System.Web.SessionState.IRequiresSessionState, IRouteHandler
    {
        public RequestContext RequestContext { get; set; }

        public MvcSecurityHttpHandler(RequestContext requestContext)
        {
            this.RequestContext = requestContext;
        }

        public bool IsReusable
        {
            get { return true; }
        }

        public void ProcessRequest(HttpContext httpContext)
        {
            var controllerId = RequestContext.RouteData.GetRequiredString("controllerId");
            IController controller = null;
            IControllerFactory factory = null;
            try
            {
                factory = ControllerBuilder.Current.GetControllerFactory();
                controller = factory.CreateController(RequestContext, controllerId);
                if (controller != null)
                {
                    controller.Execute(RequestContext);
                }
            }
            finally
            {
                factory.ReleaseController(controller);
            }

            //string originalPath = httpContext.Request.Path;
            //HttpContext.Current.RewritePath(httpContext.Request.ApplicationPath, false);
            //IHttpHandler httpHandler = new MvcHttpHandler();
            //httpHandler.ProcessRequest(HttpContext.Current);
            //HttpContext.Current.RewritePath(originalPath, false);
        }

        public IHttpHandler GetHttpHandler(RequestContext requestContext)
        {
            throw new NotImplementedException();
        }
    }

public class RouteConfig
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            var defaults = new RouteValueDictionary
                {{"controllerId", "Home"},{"action", "Index"},{"id", string.Empty}};

            var customRoute = new Route("{controllerId}/{action}/{id}", defaults, new MvcSecurityRouteHandler());
            routes.Add(customRoute);

            routes.MapRoute(
                name: "DefaultWebApi",
                url: "{controller}/{action}/{id}",
                defaults: new
                    {
                        controller = "Home",
                        action = "Index",
                        id = UrlParameter.Optional
                    });
        }
    } 
```

全球.asax.cs

```
 public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            var defaults = new RouteValueDictionary
                {{"controllerId", "Home"},{"action", "Index"},{"id", string.Empty}};

            var customRoute = new Route("{controllerId}/{action}/{id}", defaults, new MvcSecurityRouteHandler());
            routes.Add(customRoute);
        } 
```

并在 Application_Start

```
RegisterRoutes(RouteTable.Routes); 
```

服务启动后，我在 ProcessRequest 中创建了一个断点，它没有被命中。可能缺少什么？这是正确的做法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:14:14.040

如果您还没有，您需要先在 global.asax 或您的 web.config 文件中注册处理程序。

[http://msdn.microsoft.com/en-us/library/46c5ddfy(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/46c5ddfy(v=vs.100).aspx)

# mysql - 用 JOIN 做一个 sql 查询

> ID：13593118
> 
> 赞同：-1
> 
> 时间：2012-11-27T21:09:55.570
> 
> 标签：mysql, join

有三张表

帖子表

```
id          username
1           ahmed 
```

用户表

```
id          title
1           test post 
```

post_users

```
user_id     post_id
1           1 
```

post_users（有两个字段 user_id 和 post_id）多对多

当我想发送帖子 id=1 时，我想从用户表中选择在 post_users 表中没有一行的用户（在一个查询中）。如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:17:42.753

我认为您正在寻找的是这些方面的东西。内部联接：

```
SELECT DISTINCT USERS.ID
FROM USERS
INNER JOIN POST_USERS
ON USERS.ID=POST_USERS.ID
WHERE POST_USERS.POST_ID <> your_input_value 
```

我做了一些假设，如果这不起作用，请提供更多详细信息。

# multithreading - 詹金斯一次运行多个批处理文件

> ID：13593124
> 
> 赞同：4
> 
> 时间：2012-11-27T21:10:08.723
> 
> 标签：multithreading, batch-file, jenkins

我正在寻找一种方法来暂停詹金斯或让詹金斯在开始另一个批处理之前从批处理文件完成任务。基本上我想要的是类似于运行的东西：

```
start /wait batchfile.bat 
```

但是当我运行这个詹金斯只是挂起，这个过程从未真正完成。当我运行这样的事情时：

```
run %startpath%\firstbatch.bat

run %startpath%\secondbatch.bat 
```

Jenkins 在不同的线程中运行这两个批处理文件，这对我来说是个大问题。我需要完成批处理，因为它们会烹饪和复制资产。触发的最后一批压缩资产并在途中发送它们，但如果资产未完成复制，则压缩开始时目录中没有所有文件。我能想到的唯一另一种方法是将每个批次放在不同的构建中，并为 Jenkins 添加一个安静期，但这只是对批次脚本实际运行时间的猜测。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:49:34.387

尝试使用“call batchfile.bat”，这应该会阻塞，直到批处理文件完成运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:17:11.140

如果您希望它们按顺序运行，您应该为每个批处理文件创建一个单独的构建作业，但您不需要猜测它们需要多长时间才能运行。在运行 firstbatch.bat 的作业的配置中，在 Post Build Actions 部分中选择“Build other projects”并指定运行 secondbatch.bat 的作业。在第一个作业完成之前，该作业不会开始。

# mysql - 更新字段的 SQL 查询

> ID：13593133
> 
> 赞同：0
> 
> 时间：2012-11-27T21:10:52.247
> 
> 标签：mysql

我需要以编程方式更新 mySQL 数据库表中的 3 个字段。我需要更新`label_id, label & company_id`

我需要的是一个 SQL 查询，它允许我指出是什么`company_id`和“标签”字段，然后让它自动生成标签 ID。

例如，创建`label="test"`，`company_id="17"`......并让它自动生成label_id。关于 sql 查询的任何想法可以做到这一点？表结构示例：

```
label_id      label       company_id  
1             Cook        8  
2             Chef        8  
3             Driver      9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:15:46.630

如果您需要`label_id`自动生成，听起来您是在谈论`INSERT`而不是实际`UPDATE`

`INSERT INTO table_name(label, company_id) VALUES ("Company", 5)`

这将需要创建您的表，例如：

```
CREATE table_name (label_id int PRIMARY KEY AUTO_INCREMENT, label VARCHAR(255), company_id INT) 
```

# java - 将游戏保存到文件

> ID：13593135
> 
> 赞同：1
> 
> 时间：2012-11-27T21:11:02.700
> 
> 标签：java, file, serialization

我正在开发一个原始 RPG，这个类（据说）包含所有必要的数据：

```
public class CPU implements Serializable{

private Map<String, Location> locations;
private Map<String, Location> places;
private Map<String, NPC> npcs;
private Game game;
private Player player;
private NPC currentNPC;

public CPU(){

} 
```

（我没有包括这些方法，但我认为这些现在无关紧要......）

“Game”类还包含作为变量的 Player 和 CPU，但它的构造函数并不是实际创建它们的构造函数（它们是在 main() 方法中创建的，然后添加到类中）。该方法应该将 CPU 类保存到文件中，以便以后可以从中读取所有数据：

```
public void SaveGame(String s){
    String sav = s;
    sav.concat(".dat");
    try {
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(sav));
        oos.writeObject(cpu);
        oos.close();
    } catch(Exception ex) {
        ex.printStackTrace();
    }
} 
```

这是从文件中加载它的方法：

```
public void Load(String s){
    if(s.contains(".dat")){
        try {
            ObjectInputStream ois = new ObjectInputStream(new FileInputStream(s));
            cpu = (CPU)ois.readObject();
            ois.close();
        } catch(Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

我的问题基本上是：这行得通吗？我是否能够简单地序列化 CPU 类并将其保存到文件中，然后将其读回并能够从中恢复所有数据（即播放器数据）？

如果我没记错的话，在Java中“=”并不意味着右侧的对象将被复制，所以我的另一个问题是：当“Load”方法完成时，“cpu”（“Game”的变量"-class) 仍然包含我从文件中加载的 CPU，我可以从中读取数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:20:35.893

实际上，只有当您传递给该`SaveGame()`方法的原始文件名包含`".dat"`.

实际上，读取方法会检查该条件，并且该`SaveGame()`方法（应该命名`saveGame()`以尊重 Java 命名约定）不会像您想象的那样将 .dat 附加到文件名。实际上，字符串是不可变的，并且该`concat()`方法返回一个新字符串，但不会修改调用它的字符串。代码应该是

```
String sav = s.concat(".dat"); 
```

您还应该停止像您正在做的那样忽略异常，并且您应该始终在 finally 块中关闭流。如果您使用的是 Java 7，请使用[try-with-resources](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)构造。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:15:58.790

如果您的程序具有写入文件的权限，并且所有字段类（NPC、Game、Player.Location）也是可序列化的，那么**它将工作**。

*如果*在读取对象时没有抛出异常`cpu`，Game 类的字段*将*包含从文件加载的 CPU 。

# jsp - 将arraylist导入jsp，结果为空

> ID：13593137
> 
> 赞同：0
> 
> 时间：2012-11-27T21:11:06.010
> 
> 标签：jsp, arraylist

我有对象的arraylist。从servlet，我把它放到会话中，像这样：

```
session.setAttribute("registrations", rayList); 
```

这是jsp页面：

```
<%@page import="java.util.ArrayList" %>
...     
<c:forEach var="book" items="${registrations}"> 
                                <tr> 
                                    <td>${book.bookName}</td> 
                                    <td>${book.bookAmount}</td> 
                                    <td>${book.BookName}</td> 
                                    <td>${book.bookYear}</td> 
                                     </tr> 
                            </c:forEach> 
```

但是有空，没有错误，什么也没有发生。

但如果我对简单的变量做同样的事情，一切都很好。

也许我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:08:21.477

问题在于 JSTL 核心 taglib 声明。

要声明 JSTL 核心，只需在 JSP 页面顶部添加：

```
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T21:16:21.177

也许 getBookName 不是 Book 类中定义的变量？

确保 Book 类具有为 bookName、bookAmount、getBookName 和 bookYear 定义的所有字段以及 setter 和 getter。

# regex - PCRE - perl 正则表达式

> ID：13593139
> 
> 赞同：-2
> 
> 时间：2012-11-27T21:11:11.623
> 
> 标签：regex, perl, pcre

我正在尝试在 PCRE 中创建一个正则表达式以进行字符串检测。我想检测的字符串类型是 abcdef001、zxyabc003。前 6 个字符的单词是 a-zA-Z，后两个或三个字符是数字 0-9；这个字符串可以在整个文本中的任何位置。

例如 - “来自 server1 的用户活动、用户 ID `abcdef009`、时间 10.20am”。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:12:25.273

试试这个：

```
/[a-zA-Z]{6}[0-9]{2,3}/ 
```

如果您想将其限制为整个单词，请尝试：

```
/\b[a-zA-Z]{6}[0-9]{2,3}\b/ 
```

*   `\b`- 字边界
*   `[a-zA-Z]{6}`- 六个字母
*   `[0-9]{2,3}`- 2 个或 3 个数字
*   `\b`- 字边界

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:05:58.093

使用正则表达式模式

```
/[a-z]{6}\d{2,3}/i 
```

# android - 如何将首选项屏幕添加到 Viewpager？

> ID：13593141
> 
> 赞同：1
> 
> 时间：2012-11-27T21:11:22.320
> 
> 标签：android, exception, view, sharedpreferences, android-viewpager

我是 Android 开发的新手，在 viewpager 中显示首选项屏幕时遇到了一些问题。目前，我的应用程序将 viewpager 的所有页面显示为一个页面，并将首选项屏幕作为背景。然后，当我做手势时，应用程序由于 InflateException 而崩溃。[我已经在这里](https://stackoverflow.com/questions/6025349/preferencescreen-class-not-found)和[这里](https://stackoverflow.com/questions/5765412/android-app-crashes-immediately-when-preferences-screen-is-started)研究了 SO 问题的潜在原因，但没有一个提供解决我的问题的解决方案。我只会使用 Preference 片段，但我正在为 min 8 API 开发。任何帮助是极大的赞赏。

我的代码

```
public class Options extends PreferenceActivity implements OnClickListener   ,SharedPreferences.OnSharedPreferenceChangeListener{

ActionBarSherlock mSherlock = ActionBarSherlock.wrap(this);
View view;

@Override
public void onCreate(Bundle savedInstanceState) {
    setTheme(R.style.Theme_Sherlock);
    super.onCreate(savedInstanceState);

   addPreferencesFromResource(R.xml.prefs);
   PreferenceManager.getDefaultSharedPreferences(this).registerOnSharedPreferenceChangeListener(this);

    mSherlock.setContentView(R.layout.options);

MyPagerAdapter adapter = new MyPagerAdapter(this);
ViewPager myPager = (ViewPager) findViewById(R.id.viewpager);
myPager.setAdapter(adapter);
myPager.setCurrentItem(2);
TitlePageIndicator indicator = (TitlePageIndicator)findViewById( R.id.indicator ); 
indicator.setViewPager( myPager );
indicator.setOnPageChangeListener(new ViewPager.OnPageChangeListener() {
    @Override
    public void onPageSelected(int position) {

          if(position == 0 ||position == 1||position == 2||position == 4){

          }
    }

    @Override
    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
    }

    @Override
    public void onPageScrollStateChanged(int state) {
    }
});  
}

private class MyPagerAdapter extends PagerAdapter {

    private String[] titles = new String[] {"HELP",  "PREFERENCES", "ABOUT" };
private final Context context;
private int[] scrollPosition = new int[titles.length];

public MyPagerAdapter( Context context )
{
    this.context = context;
    for ( int i = 0; i < titles.length; i++ )
    {
        scrollPosition[i] = 0;
    }
}

@Override
public String getPageTitle( int position )
{
    return titles[position];
}

@Override
public int getCount()
{
    return titles.length;
}

    public Object instantiateItem(View collection, int position) {

        LayoutInflater inflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        int resId = 0;
        switch (position) {
        case 2:
            resId = R.layout.help;              
            view = inflater.inflate(resId, null);
            LinearLayout layout0=(LinearLayout)view.findViewById(R.id.helplayout);
            ((ViewPager) collection).addView(view, 0);
            return view;

        case 0:
            resId = R.xml.prefs;
            view = inflater.inflate(resId, null);
            LinearLayout layout1=(LinearLayout)view.findViewById(R.id.RLcoins);

            ((ViewPager) collection).addView(view, 0);
            return view;

        case 1:
            resId = R.layout.about;
            view = inflater.inflate(resId, null);
            LinearLayout layout2=(LinearLayout)view.findViewById(R.id.LLtwitter);

            ((ViewPager) collection).addView(view, 0);
            return view;

        }
        return resId;

    } 
```

我的日志猫

```
11-27 16:00:50.039: E/AndroidRuntime(3993): FATAL EXCEPTION: main
11-27 16:00:50.039: E/AndroidRuntime(3993): android.view.InflateException: Binary XML file line #2: Error inflating class PreferenceScreen
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:581)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.inflate(LayoutInflater.java:386)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at com.bryanjrichardson.GSCC.Options$MyPagerAdapter.instantiateItem(Options.java:130)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.PagerAdapter.instantiateItem(PagerAdapter.java:110)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.ViewPager.addNewItem(ViewPager.java:692)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.ViewPager.populate(ViewPager.java:849)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.ViewPager.populate(ViewPager.java:772)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.ViewPager.completeScroll(ViewPager.java:1539)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.support.v4.view.ViewPager.computeScroll(ViewPager.java:1422)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.drawChild(ViewGroup.java:1562)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.View.draw(View.java:6883)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:2116)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewRoot.draw(ViewRoot.java:1565)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1301)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1914)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.os.Looper.loop(Looper.java:130)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.app.ActivityThread.main(ActivityThread.java:3859)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at java.lang.reflect.Method.invokeNative(Native Method)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at java.lang.reflect.Method.invoke(Method.java:507)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at dalvik.system.NativeStart.main(Native Method)
11-27 16:00:50.039: E/AndroidRuntime(3993): Caused by: java.lang.ClassNotFoundException: android.view.PreferenceScreen in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/com.bryan.GSCC-1.apk]
11-27 16:00:50.039: E/AndroidRuntime(3993):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.createView(LayoutInflater.java:471)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.onCreateView(LayoutInflater.java:549)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:66)
11-27 16:00:50.039: E/AndroidRuntime(3993):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:19:22.917

您应该使用片段作为帮助/关于，并使用[PreferenceFragment](http://developer.android.com/reference/android/preference/PreferenceFragment.html)作为首选项。

这是 PreferenceFragment 的教程 [http://android-er.blogspot.com.ar/2012/07/example-of-using-preferencefragment.html](http://android-er.blogspot.com.ar/2012/07/example-of-using-preferencefragment.html)

# mysql - mysql dump - 排除一些表数据

> ID：13593148
> 
> 赞同：62
> 
> 时间：2012-11-27T21:12:07.023
> 
> 标签：mysql

是否可以，使用 mysql dump 导出整个数据库结构，但从导出中排除某些表数据。

假设数据库有 200 个表，我希望导出所有 200 个表的结构，但我想忽略 5 个特定表的数据。

如果这是可能的，它是如何完成的？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2015-04-07T15:10:05.327

这将生成export.sql，其结构来自所有表和所有表中的数据，不包括table_name

```
mysqldump --ignore-table=db_name.table_name db_name > export.sql
mysqldump --no-data db_name table_name >> export.sql 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2015-11-18T12:56:06.723

我认为 AmitP 的解决方案已经很棒了——为了进一步改进它，我认为首先创建所有表（结构）然后用数据填充它是有意义的，除了“排除”的那些

```
mysqldump --no-data db_name > export.sql
mysqldump --no-create-info --ignore-table=db_name.table_name db_name >> export.sql 
```

如果要排除超过 1 个表，只需`--ignore-table`更频繁地使用该指令（在 2nc 命令中） - 请参阅 mysqldump 帮助：

```
--ignore-table=name   Do not dump the specified table. To specify more than one
                      table to ignore, use the directive multiple times, once
                      for each table.  Each table must be specified with both
                      database and table names, e.g.,
                     --ignore-table=database.table 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-03-31T04:24:10.290

我是新用户，没有足够的声誉来投票或评论答案，所以我只是将其作为答案分享。

@kantholy 显然有最好的答案。

@AmitP 的方法将所有结构转储`data`到 a `file`，然后是最后的`drop/create table` **语句**。生成的文件仍然需要您`import`在简单地销毁它之前处理所有不需要的数据。

@kantholy 的方法首先转储所有**结构**，然后仅`data`用于`table`您不忽略的结构。这意味着您的后续`import`将不必花时间处理`import`所有`data`您不想要的事情 - 如果您有大量的`data`内容要忽略以节省时间，则尤其重要。

回顾一下，最有效的答案是：

```
mysqldump --no-data db_name > export.sql
mysqldump --no-create-info --ignore-table=db_name.table_name1 [--ignore-table=db_name.table_name2, ...] db_name >> export.sql 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-11-27T21:17:31.183

根据[mysqldump 文档](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)：

```
mysqldump name_of_db --ignore-table=name_of_db.name_of_table 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-07-07T10:25:47.277

在`mysqldump`MariaDB 10.1 或更高版本中，您可以使用`--ignore-table-data`：

```
mysqldump --ignore-table-data="db_name.table" db_name > export.sql 
```

对于多个表重复该`--ignore-table-data`选项：

```
mysqldump --ignore-table-data="db_name.table_1" --ignore-table-data="db_name.table_2" db_name > export.sql 
```

* * *

来自[MariaDB`mysqldump`文档](https://mariadb.com/kb/en/mysqldump/)：

> --忽略表数据=名称
> 
> 不要转储指定的表数据（仅转储结构）。要指定要忽略的多个表，请多次使用该指令，每个表一次。每个表都必须指定数据库和表名。从 MariaDB 10.1.46、MariaDB 10.2.33、MariaDB 10.3.24、MariaDB 10.4.14 和 MariaDB 10.5.3。另请参见 --no-data。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-04-30T08:39:57.117

以前的答案没有解决`AUTO_INCREMENT`我们导出结构时的问题，也没有显示如何导出表中的某些特定数据。

为了更进一步，我们必须做到：

**1/ 导出结构**

```
mysqldump --no-data db_name | sed 's/ AUTO_INCREMENT=[0-9]*\b//g' > export-structure.sql 
```

**2/ 只导出数据并忽略一些表**

```
mysqldump --no-create-info --ignore-table=db_name.table_name1 [--ignore-table=db_name.table_name2, ...] db_name >> export-data.sql 
```

**3/ 在一张表中导出特定数据**

```
mysqldump --no-create-info --tables table_name --where="id not in ('1', '2', ...)" > export-table_name-data.sql 
```

* * *

我尝试使用`--skip-opt`重置选项，`AUTO_INCREMENT`但这也删除`AUTO_INCREMENT`了字段上的定义，`CHARSET`以及[其他内容](https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html#option_mysqldump_opt)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-22T08:14:17.283

我使用的另一种可能性是避免将数据插入所需表的行。

*原理是使用grep -v*过滤掉*INSERT INTO*行

 *```
mysqldump name_of_db | grep -v 'INSERT INTO \`name_of_table\` VALUES' 
```

或者

```
mysqldump name_of_db | grep -v 'INSERT INTO \`name_of_db\`.\`name_of_table\` VALUES' 
```

您可以轻松进入 gzip 文件和单独的错误文件

```
mysqldump name_of_db | grep -v 'INSERT INTO \`name_of_db\`.\`name_of_table\`' | gzip > /path/dumpfile.sql.gz 2> /path/name_of_db.err 
```

因此可以很好地备份您想要的内容，并知道失败的原因（如果有的话）:-)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-11-16T14:17:30.000

为了进一步改进[kantholy 的答案](https://stackoverflow.com/a/33780685/854477)，添加压缩并通过不写入未压缩的数据来删除大部分磁盘写入：

```
#!/bin/bash
echo -n "db name:"
read -r db_name
echo -n "username:"
read -r username
echo -n "Exclude data from table:"
read -r exclude_table_data

{
 mysqldump "$db_name" --user="$username" --password --no-tablespaces --no-data \
 && \
 mysqldump "$db_name" --user="$username" --password --no-tablespaces --no-create-info \
 --ignore-table="${db_name}.${exclude_table_data}";
} \
| bzip2 -c9 \
> "${db_name}_$(date +%y%m%d_%H%M).sql.bz2" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-13T15:53:45.547

在我看来，最好的答案来自 Steak，这是唯一真正适用于任何情况的答案。

所有暗示两个转储的答案都是错误的，或者至少它们可以在某些前提下工作。

正如许多人在上面指出的那样，您可能会遇到序列问题。

但我发现更**关键**的是，数据库可以具有验证或处理信息的触发器（假设在表 A 上插入记录时在表 B 上插入记录的触发器）——在这种情况下，创建完整模式（包括触发器）的顺序，然后插入数据将创建一组不同的结果。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-24T06:23:03.690

以下命令将导出数据库结构并忽略数据

**mysqldump --no-data --databases -u[db_user] -p[db_password] [schema] > File.sql**

然后导出忽略表格的数据

**mysqldump --ignore-table=[schema.table_name] --databases -u[db_user] -p[db_password] [schema] >> File.sql***

# java - ISO-8859-1 在 Java 中将字符串从 /into JSON 编码出来

> ID：13593157
> 
> 赞同：1
> 
> 时间：2012-11-27T21:12:52.140
> 
> 标签：java, json, iso-8859-1

我的应用程序有一个 Java servlet，它从请求中读取一个 JSONObject 并构造一些在其他地方使用的 Java 对象。我遇到了一个问题，因为 JSON 中有以 ISO-8859-1 编码的字符串。当我将它们提取到 Java 字符串中时，编码似乎被解释为 UTF-16。我需要能够在某个时候取回正确编码的字符串以放入另一个 JSON 对象。

我尝试过使用 ByteBuffers 和 CharBuffers，但我根本没有得到任何字符。我无法更改编码，因为我必须与使用 ISO-8859-1 的其他应用程序很好地配合使用。

任何提示将非常感谢。

这是一个使用 Struts 1.3.8 的遗留应用程序。我将 net.sf.json 2.2.4 用于 JSONObject 和 JSONArray。

解析代码的片段是：

```
final JSONObject a = (JSONObject) i;
final JSONObject attr = a.getJSONObject("attribute");
final String category = attr.getString("category");

final String value = attr.getString("value"); 
```

然后，我使用该信息创建 POJO，这些信息由另一个操作类检索以创建 JSON 以传递给客户端进行显示，或传递给其他应用程序。

所以澄清一下，如果 JSON 包含字符串“Juan Guzmán”，Java 字符串包含类似 Juan Guzm?_An 的内容（我面前没有确切的内容）。我不确定如何获得正确的变音符号。我相信，如果我能获得一个包含正确表示的 Java 字符串，那么 Mezzie 的解决方案（如下）将允许我创建具有正确编码的字符串以放回 JSON 中以返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:36:02.267

我有同样的问题，我使用的技术和你一样。在我们的例子中，它是 UTF 8。所以只需将其更改为 UTF-16

```
 public static String UTF8toISO( String str )
    {
        try
        {
            return new String( str.getBytes( "ISO-8859-1" ), "UTF-8" );
        }
        catch ( UnsupportedEncodingException e )
        {
            e.printStackTrace();
        }
        return str;
    } 
```

# php - 用于浏览器语言检测的 Javascript？

> ID：13593158
> 
> 赞同：0
> 
> 时间：2012-11-27T21:12:53.357
> 
> 标签：php, javascript, browser, wordpress

> **可能重复：**
> [用于检测浏览器语言偏好的 JavaScript](https://stackoverflow.com/questions/1043339/javascript-for-detecting-browser-language-preference)
> [如何使用 javascript 获取浏览器当前区域设置首选项？](https://stackoverflow.com/questions/2678230/how-to-getting-browser-current-locale-preference-using-javascript)

我有一个正在本地化的 wordpress 网站。我真的没有太多的 php 或 javascript 知识，也不知道我在寻找什么。

我有一个支持选项卡，用户可以单击它转到我的帮助台。我可以为不同的语言创建多个选项卡并获取代码来显示它。

所以我的问题是：它们是否是 javascript 中的 if then 语句，我可以使用它来帮助检测浏览器的语言并显示正确的选项卡？还是他们这样做的更好方法？由于我的本地化域格式是“ru.domain.com”，我什至可以让 if then 语句检查当前页面 url 中的语言代码。任何帮助，将不胜感激。

# uibutton - 视图的双重状态栏问题

> ID：13593160
> 
> 赞同：0
> 
> 时间：2012-11-27T21:12:59.440
> 
> 标签：uibutton, uilabel, statusbar

我即将完成我的应用程序，现在我正在做一些设计。我一直在关注 iOS 人机界面指南，其中一品脱是：“确保您的 UI 可以处理双高状态栏”。大多数应用程序在双状态栏下运行良好，但有两件事运行不佳：

*   一个标签，当有双状态栏时从屏幕上消失。当有双状态栏时，有什么办法可以重新定位标签？
*   一个按钮：这是一个带有图像的按钮，它不会消失，但会以错误的比例出现（举个例子：原始尺寸：44x44；双状态栏：44x20）。有什么办法可以解决吗？

基于导航控制器的应用程序的其余部分与双状态栏配合得很好。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:19:46.330

您可以设置方法的框架以及`UILabel`何时`UIButton`被调用。 或者，如果您使用的是 Autolayout，则可以将其设置为让 UIView（在本例中为 an和 an ）正确移动和调整大小，而无需任何额外代码。`application:willChangeStatusBarFrame:``application:didChangeStatusBarFrame:`
`UILabel``UIButton`

# android - 有新数据库版本时从资产中复制数据库

> ID：13593162
> 
> 赞同：1
> 
> 时间：2012-11-27T21:13:04.570
> 
> 标签：android, database, android-assets

我正在尝试解决以下问题。我有一个使用预先创建的数据库的应用程序。我将此数据库放在资产文件夹中。然后我在内部复制数据库。

我希望能够检查我的数据库的版本，所以当有新版本时，我删除旧数据库并从资产文件夹中复制新数据库。我将数据库版本存储为共享偏好数据。

运行以下代码时出现错误，应用程序停止运行（意外停止）。你能帮我找出问题所在吗？

```
 public class DatabaseConnector
     {
// database name
   private static final String DATABASE_NAME = "Recipes";
   private SQLiteDatabase database; // database object
   private DatabaseOpenHelper databaseOpenHelper; // database helper

   String selection;       

   // public constructor for DatabaseConnector
   public DatabaseConnector(Context context) 
   {
      // create a new DatabaseOpenHelper
      databaseOpenHelper = 
         new DatabaseOpenHelper(context, DATABASE_NAME, null, 1);
   } // end DatabaseConnector constructor

   // open the database connection
   // attempts to establish a connection to the db
   // and throws an exception if it fails
   public void open() throws SQLException 
   {
      // create or open a database for reading/writing
      database = databaseOpenHelper.getWritableDatabase();
   } // end method open

   // close the database connection
   public void close() 
   {
      if (database != null)
         database.close(); // close the database connection
   } // end method close

   // inserts a new esoda in the database
   public void insertEsoda(String title, String category, String ingredients, String process, 
      String notes, String image, String time, String calories, String difficulty) 
   {
....
   } // end method insertEsoda

   // updates a esoda in the database
   public void updateEsoda(long id, String title, String category, String ingredients, 
      String process, String notes, String image, String time, String calories, String difficulty) 
   {
      ....
   } // end method updateEsoda

// updates favorites in the database
   public Boolean updateFavorite(long id) 
   {
....
   } // end method update favorites

   // return a Cursor with all esoda information in the database
   public Cursor getAllEsoda() 
   {
     ....
   } // end method getAllEsoda

   // return a Cursor with all esoda information in the database
   public Cursor getRecipeCategory(int position) 
   {
      ....
   } // end method getAllEsoda

   // get a Cursor containing all information about the esoda specified
   // by the given id
   public Cursor getOneEsoda(long id) 
   {
     ....
   } // end method getOneEsoda

   // delete the contact specified by the given String name
   public void deleteEsoda(long id) 
   {
     ....
   } // end method deleteEsoda

   private class DatabaseOpenHelper extends SQLiteOpenHelper {
       public Context mContext;
       private static final int DATABASE_VERSION = 1;
       private static final String SP_KEY_DB_VER = "db_ver";

      // public constructor
      public DatabaseOpenHelper(Context context, String title,
         CursorFactory factory, int version) 
      {
         super(context, title, factory, version);
         mContext=context;
         initialize();
      } // end DatabaseOpenHelper constructor

      private void initialize() {

          if (databaseExists()) {
              SharedPreferences prefs = PreferenceManager
                      .getDefaultSharedPreferences(mContext);
              int dbVersion = prefs.getInt(SP_KEY_DB_VER, 1);
              if (DATABASE_VERSION != dbVersion) {
                  File dbFile = mContext.getDatabasePath(DATABASE_NAME);
                  if (!dbFile.delete()) {
                      Log.w("TAG", "Unable to update database");
                  }
              }
          }
          if (!databaseExists()) {
              createDatabase();
          }
      }

      private boolean databaseExists() {
          File dbFile = mContext.getDatabasePath(DATABASE_NAME);
          return dbFile.exists();
      }

      private void createDatabase() {
          String parentPath = mContext.getDatabasePath(DATABASE_NAME).getParent();
          String path = mContext.getDatabasePath(DATABASE_NAME).getPath();

          File file = new File(parentPath);
          if (!file.exists()) {
              if (!file.mkdir()) {
                  Log.w("TAG", "Unable to create database directory");
                  return;
              }
          }

          InputStream is = null;
          OutputStream os = null;
          try {
              is = mContext.getAssets().open(DATABASE_NAME);
              os = new FileOutputStream(path);

              byte[] buffer = new byte[1024];
              int length;
              while ((length = is.read(buffer)) > 0) {
                  os.write(buffer, 0, length);
              }
              os.flush();
              SharedPreferences prefs = PreferenceManager
                      .getDefaultSharedPreferences(mContext);
              SharedPreferences.Editor editor = prefs.edit();
              editor.putInt(SP_KEY_DB_VER, DATABASE_VERSION);
              editor.commit();
          } catch (IOException e) {
              e.printStackTrace();
          } finally {
              if (is != null) {
                  try {
                      is.close();
                  } catch (IOException e) {
                      e.printStackTrace();
                  }
              }
              if (os != null) {
                  try {
                      os.close();
                  } catch (IOException e) {
                      e.printStackTrace();
                  }
              }
          }
      }

      // creates the contacts table when the database is created
      @Override
      public void onCreate(SQLiteDatabase db) 
      {
         // query to create a new table named contacts
         String createQuery = "CREATE TABLE recipes" +
            "(_id integer primary key autoincrement," +
            "title TEXT, category TEXT, ingredients TEXT, process TEXT, notes TEXT, image TEXT, " +
            "time TEXT, calories TEXT, difficulty TEXT);";

         db.execSQL(createQuery); // execute the query
      } // end method onCreate

      @Override
      public void onUpgrade(SQLiteDatabase db, int oldVersion, 
          int newVersion) 
      {
      } // end method onUpgrade
   } // end class DatabaseOpenHelper
} 
```

这是我的 LogCat 文本：

```
11-27 23:19:41.643: D/AndroidRuntime(297): Shutting down VM
11-27 23:19:41.643: W/dalvikvm(297): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
11-27 23:19:41.673: E/AndroidRuntime(297): FATAL EXCEPTION: main
11-27 23:19:41.673: E/AndroidRuntime(297): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{development.nk.cretanrecipes/development.nk.cretanrecipes.RecipesMainActivity}: java.lang.NullPointerException
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.os.Looper.loop(Looper.java:123)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-27 23:19:41.673: E/AndroidRuntime(297):  at java.lang.reflect.Method.invokeNative(Native Method)
11-27 23:19:41.673: E/AndroidRuntime(297):  at java.lang.reflect.Method.invoke(Method.java:521)
11-27 23:19:41.673: E/AndroidRuntime(297):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-27 23:19:41.673: E/AndroidRuntime(297):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-27 23:19:41.673: E/AndroidRuntime(297):  at dalvik.system.NativeStart.main(Native Method)
11-27 23:19:41.673: E/AndroidRuntime(297): Caused by: java.lang.NullPointerException
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.content.ContextWrapper.getResources(ContextWrapper.java:80)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.widget.Toast.<init>(Toast.java:89)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.widget.Toast.makeText(Toast.java:231)
11-27 23:19:41.673: E/AndroidRuntime(297):  at development.nk.cretanrecipes.DatabaseConnector$DatabaseOpenHelper.initialize(DatabaseConnector.java:191)
11-27 23:19:41.673: E/AndroidRuntime(297):  at development.nk.cretanrecipes.DatabaseConnector$DatabaseOpenHelper.<init>(DatabaseConnector.java:186)
11-27 23:19:41.673: E/AndroidRuntime(297):  at development.nk.cretanrecipes.DatabaseConnector.<init>(DatabaseConnector.java:35)
11-27 23:19:41.673: E/AndroidRuntime(297):  at development.nk.cretanrecipes.RecipesMainActivity.<init>(RecipesMainActivity.java:32)
11-27 23:19:41.673: E/AndroidRuntime(297):  at java.lang.Class.newInstanceImpl(Native Method)
11-27 23:19:41.673: E/AndroidRuntime(297):  at java.lang.Class.newInstance(Class.java:1429)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
11-27 23:19:41.673: E/AndroidRuntime(297):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
11-27 23:19:41.673: E/AndroidRuntime(297):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:20:18.180

堆栈跟踪中的错误似乎与您粘贴的代码中没有出现的 toast 有关。

但是，这个库[sqllite 资产助手](https://github.com/jgilfelt/android-sqlite-asset-helper)似乎可以解决您要解决的相同问题。

“使用应用程序的原始资产文件管理数据库创建和版本管理的 Android 帮助程序类。”

希望能帮助到你

# asp.net-mvc - 将 App_Start 更改为 AppStart

> ID：13593164
> 
> 赞同：4
> 
> 时间：2012-11-27T21:13:23.723
> 
> 标签：asp.net-mvc, asp.net-mvc-4, fxcop, stylecop

我已经设置了一个新的 MVC 4 Web 应用程序。我目前正在对项目运行源代码分析并收到以下错误：

```
CA1707  Identifiers should not contain underscores 
```

其原因是由于 App_Start 文件夹名称的命名空间“App_Start”。将文件夹重命名为“AppStart”是否有任何问题？这将意味着我的所有规则都通过了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:21:11.170

我会为该特定命名空间禁止该规则，而不是重命名它。`GlobalSuppressions.cs`在您的 Web 项目根目录中创建一个文件，并添加以下内容：

```
using System.Diagnostics.CodeAnalysis;

[assembly: SuppressMessage("Microsoft.Naming",
                           "CA1707:IdentifiersShouldNotContainUnderscores",
                           Scope = "namespace",
                           Target = "<namespace>.App_Start",
                           Justification = "This is an infrastructure namespace")] 
```

# c++ - 分配的数组已经归零

> ID：13593165
> 
> 赞同：4
> 
> 时间：2012-11-27T21:13:26.743
> 
> 标签：c++, memory-management, c++11

在 C++11 中，当我使用它分配动态数组时，`T *array = new T[n];`它**已经归零**（使用 gcc 4.7.2，Ubuntu 12.10 64 位）。

1.  这是 C++11 规范强制要求的吗？
2.  如何在不将其项归零的情况下分配一个数组？这应该会快一点。

**编辑：**我已经检查了`T = int`.

**gcc cxx 标志**：`-std=gnu++11 -O3 -ffast-math -fno-rtti`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:36:05.010

§ 5.3.4

> 如果省略 new-initializer，则默认初始化对象 (8.5)；如果不执行初始化，则对象具有不确定的值。

new-initializer 是`()`in `new T[] ()`，您已将其省略。

§ 8.5 / 6

> 默认初始化 T 类型的对象意味着：
> 
> — 如果 T 是（可能是 cv 限定的）类类型（第 9 条），则调用 T 的默认构造函数（如果 T 没有可访问的默认构造函数，则初始化是非良构的）；
> 
> — 如果 T 是数组类型，则每个元素都是默认初始化的；
> 
> — 否则，不执行初始化。

int[] 是默认初始化的 -> 每个元素都是默认初始化的。

“这是由 C++11 规范强制执行的吗？”：“不执行初始化”，所以不，如果 T 没有归零构造函数（即 T 是 POD），则不强制归零。对于 T=int，不必执行归零。

为什么它仍然是零？如果您的程序从操作系统分配新内存，操作系统会为您清零新内存。如果您可以读取另一个可能存储敏感数据的程序的内存，那将是非常危险的。但是，如果您写入该内存，释放它并再次分配一些内存，则不应将其归零。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T21:45:52.517

它不会被初始化（当然，如果 T 是一个类，仍然会调用构造函数）。要强制值初始化（这对新手来说可能会产生误导 - 我们称之为零初始化，它适用于原始类型，如`int`），请执行

```
new T[N]() 
```

也就是说，只需放一对括号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T21:20:45.800

取决于你的实际类型`T`。在某些条件下，它可能会被初始化为零。请参见此处：[C++ 中的默认初始化](https://stackoverflow.com/questions/6251707/default-initialization-in-c)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T21:39:00.567

即使您可以使用 C++ 功能来动态分配未初始化的内存 ( `std::get_temporary_buffer`?)，操作系统的 libc 的底层实现`malloc()`和在您的操作系统的 libc 中也是对*大型*分配块（其中*large*是一个可调参数）`::new`使用匿名。并且匿名总是零初始化。`mmap()`**`mmap()`**

# linux - perl 加密脚本 IDEA

> ID：13593171
> 
> 赞同：0
> 
> 时间：2012-11-27T21:13:45.227
> 
> 标签：linux, perl, encryption, encryption-symmetric

大家好，我正在制作一个 perl 脚本来加密和解密文本，我刚开始我有这个：

```
#!/usr/bin/perl

use Crypt::IDEA;

my $key = pack("H32", "0123456789ABCDEF0123456789ABCDEF");
my $cipher = new IDEA $key;
my $palabra= "plaintex";
my $ciphertext = $cipher->encrypt($palabra);  # NB - 8 bytes

print unpack("H16", $ciphertext), "\n";

my $plaintext = $cipher->decrypt($ciphertext);

print $plaintext , "\n"; 
```

问题是要加密的文本必须是 8 个字节的长度。为什么？如果我用“plaintext”代替“plaintex”会给我错误。

```
input must be 8 bytes long at /usr/lib/perl5/site_perl/Crypt/IDEA.pm line 62. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:24:28.633

用**Crypt::CBC**包裹**Crypt::IDEA** - 它将允许使用非对齐的数据长度。请参阅[Crypt::CBC 的文档](http://search.cpan.org/~lds/Crypt-CBC-2.31/CBC.pm)。

 **这是因为 IDEA 和许多其他加密算法都是块加密算法。这意味着它们使用指定大小的数据块进行操作，因此必须准备好您加密的数据（用零或其他填充）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:23:40.620

尝试[Crypt::CBCeasy](http://search.cpan.org/perldoc/Crypt%3a%3aCBCeasy)

```
#!/usr/bin/perl --
use strict; use warnings;
use Crypt::CBCeasy qw/ IDEA /;

my $key     = 'shabba';
my $text    = "plaintex"; ## not a file, not -f -r $text
my $crypted = IDEA::encipher( $key, $text );
my $detext  = IDEA::decipher( $key, $crypted );
print join "\n", $key, $text, unpack( 'H*', $crypted ), $detext, '';

__END__
shabba
plaintex
53616c7465645f5fb5ec01275eb466c4b9b69f3edb7568b42c1713416d33b7aa
plaintex 
```**

# c++ - C++ 一个参数布尔构造函数和“new”关键字：逻辑错误

> ID：13593173
> 
> 赞同：3
> 
> 时间：2012-11-27T21:13:50.580
> 
> 标签：c++, constructor, arguments

我在 C++ 中有以下课程

```
class MyClass {

public:
  bool flag;

  MyClass (bool flag = false) {
    this->flag = flag;
  }
...
}; 
```

在我的主要（用于测试）中，我有类似的东西

```
int main() {
 MyClass number1 = MyClass(true);
 MyClass number2 = MyClass(false);
 MyClass number3 = new MyClass(false);
 MyClass number4 = new MyClass(true);
 MyClass number5 = new MyClass();
 std::cout << number1.flag << number2.flag << std::endl;
 std::cout << number3.flag << number4\. flag << number5.flag << std::endl;
} 
```

我的输出（想象布尔输出真或假，输出格式更好）

```
true, false 
true, true, true 
```

问题是当我使用“new”关键字创建“MyClass”对象时，无论我在参数构造函数中做什么或不做什么，它都会始终将标志变量设置为 true。

它适用于不使用“new”的构造函数，但不适用于使用它的构造函数。我知道使用和不使用关键字 new 之间的唯一真正区别是，如果不使用它，则在堆栈上创建变量，否则在堆上创建变量。我看不出有什么办法会一直出错。

如果我希望它正常工作，需要改变什么？我在类中确实有其他方法可以成功修改标志变量，但初始化它不起作用。我也尝试使用成员初始化列表来构造变量，但这也不起作用。

谢谢你的帮助！

编辑：这是编译的代码。我有两个文件，Test.c++ 和 AbstractCell.h。AbstractCell 是 MyClass，当此代码运行时，它会输出“isAlive：1”

```
 void test_abstract_2(){
   AbstractCell one = new AbstractCell();

      std::cout << std::endl <<  "isAlive:  " << one.alive << std::endl;

  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:17:44.953

**返回的指针`new`被隐式转换为`bool`，然后传递给`MyClass(bool)`。**

换句话说，如下：

```
MyClass number3 = new MyClass(false); 
```

相当于：

```
MyClass number3(bool(new MyClass(false))); 
```

由于返回的指针`new`永远不会为空，因此转换总是产生`true`，这是传递给`number3`的构造函数的内容。新分配的指针被泄露。

你可能是想说：

```
 MyClass* number3 = new MyClass(false);
 MyClass* number4 = new MyClass(true);
 MyClass* number5 = new MyClass(); 
```

（注意星号。）

如果你声明了构造函数，你就不会遇到这个问题`explicit`：

```
 explicit MyClass (bool flag = false) {
    this->flag = flag;
  } 
```

代码将无法编译，它会立即告诉您有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:22:41.240

你有两个问题：

第一个是`new`返回指针，而不是静态对象。你通常这样使用它：

```
MyClass* number3 = new MyClass(false);
std::cout<<std::boolalpha<<number3->flag<<std::endl;  //outputs 'false'
...  //do more stuff with number3
delete number3; 
```

第二个问题是代码按照编写的方式编译。编辑：我认为代码通常不应该按照编写的方式编译，但我认为我错了。似乎有太多东西可以在 C++ 中隐式转换为 bool。

所以我会修改它并说第二个问题是代码通过构造不会被破坏的匿名临时动态对象来泄漏内存:)

# oracle - 使用 PLSQL 创建过程

> ID：13593175
> 
> 赞同：1
> 
> 时间：2012-11-27T21:14:00.257
> 
> 标签：oracle, plsql, sqlplus

我正在尝试编写一个 PLSQL 函数来实现一个约束，即员工不能同时是司机和机械师，换句话说，来自 TRKEMPLOYEE 的相同 E# 不能同时在 TRKDRIVER 和 TRKMECHANIC 中。如果数据库的内容违反了该约束，请列出所有既是机械师又是司机的员工的 E# 和 NAME。上述表格如下所示：

```
TRKEMPLOYEE(E#              NUMBER(12)      NOT NULL
    NAME            VARCHAR(50)     NOT NULL,
    DOB             DATE                    ,
    ADDRESS         VARCHAR(300)    NOT NULL,
    HIREDATE        DATE            NOT NULL,
CONSTRAINT TRKEMPLOYEE_PKEY PRIMARY KEY(E#))

TRKDRIVER(E#              NUMBER(12)      NOT NULL
L#              NUMBER(8)       NOT NULL,
STATUS          VARCHAR(10)     NOT NULL,
CONSTRAINT TRKDRIVER_PKEY PRIMARY KEY(E#),
CONSTRAINT TRKDRIVER_FKEY FOREIGN KEY(E#) REFERENCES TRKEMPLOYEE(E#))

TRKMECHANIC(E#              NUMBER(12)      NOT NULL
L#              NUMBER(8)       NOT NULL,
STATUS          VARCHAR(10)     NOT NULL,
EXPERIENCE      VARCHAR(10)     NOT NULL,
CONSTRAINT TRKMECHANIC_PKEY PRIMARY KEY(E#),
CONSTRAINT TRKMECHANIC_FKEY FOREIGN KEY(E#) REFERENCES TRKEMPLOYEE(E#)) 
```

我试图编写一个函数，但在第 1 行第 7 列中不断出现编译错误。有人能告诉我为什么我的代码不起作用吗？我的代码如下

```
CREATE OR REPLACE FUNCTION Verify()
IS DECLARE
  E# TRKEMPLOYEE.E#%TYPE;
  CURSOR C1 IS SELECT E# FROM TRKEMPLOYEE;
BEGIN
  OPEN C1;
  LOOP
   FETCH C1 INTO EMPNUM;
   IF(EMPNUM IN(SELECT E# FROM TRKMECHANIC )AND EMPNUM IN(SELECT E# FROM TRKDRIVER))
     SELECT E#, NAME FROM TRKEMPLOYEE WHERE E#=EMPNUM;
   ELSE
     dbms_output.put_line(“OK”);
   ENDIF
   EXIT WHEN C1%NOTFOUND;
  END LOOP;
  CLOSE C1;
END;
/ 
```

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:55:54.423

好吧，这个功能有很多问题。

正如 a_horse_with_no_name 所指出的，如果您没有参数，则删除`()`并且根据定义，函数需要 RETURN 语句。

然而，这还不是全部：

1.  不能在 IF 语句中使用 SELECT。
2.  您必须将结果放入变量中或将其作为游标的一部分引用。
3.  函数或过程中不需要 DECLARE 块。
4.  您的 IF 语句需要一个 THEN ...但是，我认为您不需要这个，因为您只是在 ELSE 中做某事。
5.  您正在将游标的结果提取到一个不存在的变量中。

我会冒险猜测您想要一个程序，因为我看不到您可以返回什么。我还猜想，如果您不想对第一个 IF 做任何事情，那么您可以将其他选择放入光标中。

最后，我将假设您将其传递给`e#`您要检查的员工。

由于所有 3 个表都是唯一的，因此`e#`您可以使用 LEFT OUTER JOINS 将所有 SQL 放在一个游标中

```
create or replace function verify ( Pemployee trkemployee.e#%type 
            ) return varchar2 is

   l_mechanic trkemployee.e#%type;
   l_driver  trkemployee.e#%type;

begin

   -- Doing things in SQL is more efficient.
    select m.e#, d.e#
      into l_mechanic, l_driver
      from trkemployee e
      left outer join trkmechanic m
        on e.e# = m.e#
      left outer join trkdriver d
        on e.e# = d.e#
           ;

   if l_driver is not null and l_mechanic is not null then
      return 'BAD';
   else
      return 'OK';
   end if;

end;
/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:34:26.053

您正在创建一个函数但缺少`RETURN`声明。如果您不想返回结果，请使用`create or replace procedure`.

此外，如果您没有任何参数，请删除括号`()`，`DECLARE`关键字也不正确。

* * *

您检查表格的方式并不是很有效。您可以通过单个查询获取违反业务约束的所有员工的数量：

```
select emp.e#, 
       emp.name,
       count(drv.e#) + count(mec.e#) as cnt
from trkemployee emp
   left join trkdriver drv on drv.e# = emp.e#
   left join trkmechanic mec on mec.e# = emp.e#
group by emp.e#, emp.name
having count(drv.e#) + count(mec.e#) > 1; 
```

此外，应该在`EXIT WHEN C1%NOTFOUND;`声明**之后**`FETCH`。否则，即使游标没有获取任何内容，您也会停留在循环中。

如果您采用我的简化语句，您可以遍历所有员工并打印 OK，也不是 Not OK，具体取决于计数：

```
CREATE OR REPLACE procedure Verify
IS 
  empnum number(12);
  cnt    integer;
  empname varchar(50);

  CURSOR C1 IS 
      select emp.e#,
             emp.name,
             count(drv.e#) + count(mec.e#) as cnt  
      from trkemployee emp
         left join trkdriver drv on drv.e# = emp.e#
         left join trkmechanic mec on mec.e# = emp.e#
      group by emp.e#, emp.name;
BEGIN
  OPEN C1;
  LOOP
    FETCH C1 INTO empnum, empname, cnt;
    EXIT WHEN C1%NOTFOUND;

    if cnt > 1 then 
       dbms_output.put_line(to_char(empnum)||' NOK');
    else
       dbms_output.put_line(to_char(empnum)||' OK');
    end if;

  END LOOP;
CLOSE C1;
END;
/ 
```

* * *

### 不使用存储过程解决问题

我正在考虑一种方法，如何仅通过数据库中的约束来强制执行此业务规则：

```
create table trkemployee
(
    E#              NUMBER(12)      NOT NULL,
    NAME            VARCHAR(50)     NOT NULL,
    DOB             DATE                    ,
    ADDRESS         VARCHAR(300)    NOT NULL,
    HIREDATE        DATE            NOT NULL,
    emp_type        char(1)         NOT NULL,
    constraint trkemployee_pkey primary key(e#, emp_type),
    constraint chk_emp_type check (emp_type in ('d','m'))
);

create table TRKDRIVER
(
  e#              number(12)      not null,
  emp_type        char(1)         default 'd' not null,
  l#              number(8)       not null,
  status          varchar(10)     not null,
  constraint trkdriver_pkey primary key(e#),
  constraint trkdriver_fkey foreign key(e#,emp_type) references trkemployee(e#, emp_type),
  constraint check_drv_type check (emp_type = 'd')
);

create table trkmechanic
(
  e#              number(12)      not null,
  emp_type        char(1)         default 'm' not null,
  l#              number(8)       not null,
  status          varchar(10)     not null,
  experience      varchar(10)     not null,
  constraint trkmechanic_pkey primary key(e#),
  constraint trkmechanic_fkey foreign key(e#,emp_type) references trkemployee(e#, emp_type),
  constraint check_mec_type check (emp_type = 'm')
); 
```

这个想法是在其外键中包含员工类型，并确保从属表不能使用错误的类型。插入新的 trkemployee 时，必须指定类型。明细表上的检查约束将拒绝任何类型错误的行。

要将员工从一种类型“移动”到另一种类型（如果可能的话），必须首先删除旧的明细行。只有这样员工的类型才能更改为其他类型。最后可以插入新的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:03:15.123

`a_horse_with_no_name`将and给出的答案混合起来`Ben`，然后“简化”一点给出-

```
CREATE OR REPLACE FUNCTION Verify
 return varchar2 IS                
BEGIN       
  FOR c_rec in (select emp.e#,
                      count(drv.e#) + count(mec.e#) as cnt  
                 from trkemployee emp
                 left join trkdriver drv on drv.e# = emp.e#
                 left join trkmechanic mec on mec.e# = emp.e#
                 group by emp.e#)
   LOOP
    if c_rec.cnt > 1 then 
       return ('BAD '||c_rec.e#);
    else
       return ('OK '||c_rec.e#);
    end if;    
  END LOOP;
EXCEPTION
  WHEN ....THEN
  --as the wise man once said "Do some meaningful exception handling here"...
END;
/ 
```

看起来有点过分了 to `DECLARE`, `OPEN`,`FETCH`和`CLOSE`cursor 。

或`PROCEDURE`类似

```
CREATE OR REPLACE PROCEDURE Verify
IS                
BEGIN       
  FOR c_rec in (select emp.e#,
                      count(drv.e#) + count(mec.e#) as cnt  
                 from trkemployee emp
                 left join trkdriver drv on drv.e# = emp.e#
                 left join trkmechanic mec on mec.e# = emp.e#
                 group by emp.e#)
   LOOP
    if c_rec.cnt > 1 then 
       dbms_output.put_line('BAD '||c_rec.e#);
    else
       dbms_output.put_line('OK '||c_rec.e#);
    end if;    
  END LOOP;
EXCEPTION
  WHEN ....THEN
  --as the wise man once said "Do some meaningful exception handling here"...
END;
/ 
```

# php - 从下拉列表中捕获多个选项

> ID：13593187
> 
> 赞同：1
> 
> 时间：2012-11-27T21:14:50.123
> 
> 标签：php, html, arrays, drop-down-menu

我正在尝试从下拉列表中捕获多个选项并通过邮件发送。我已经尝试了以下代码。

HTML：

```
<select name="thelist[]" multiple="multiple">
<option value="Value 1">Value 1</option>
<option value="Value 2">Value 2</option>
</select> 
```

PHP

```
if( is_array($thelist))
    {
        while (list ($thelist) = each ($thelist)) 
            {
                echo "$thelist <br>";
            }
    }
    else{echo "not working";} 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:22:37.987

更改`thelist[]`为`thelist`，因为您的命名不同并且使用不同的名称捕获，请执行以下操作：

```
<select name="thelist" multiple="multiple">
<option value="Value 1">Value 1</option>
<option value="Value 2">Value 2</option>
</select> 
```

正如塞缪尔所说：

```
$thelist = $_POST['thelist'];
if(is_array($thelist)){
  foreach($thelist as $item){
    echo $item.'<br>';
  }
}else{
  echo 'thelist is not an array';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:18:09.587

```
$thelist = $_POST['thelist'];
if(is_array($thelist)){
    foreach($thelist as $item){
        echo $item.'<br>';
    }
}else{
    echo 'thelist is not an array';
} 
```

# c# - 编辑列表包含本身包含对象的对象，依此类推

> ID：13593188
> 
> 赞同：3
> 
> 时间：2012-11-27T21:14:52.597
> 
> 标签：c#, linq, list

我对对象列表有疑问...

此列表包含本身包含对象的对象，依此类推...（所有对象都属于同一类型）

我的对象看起来像这样：

```
 public class MyObject (...)
  {
    ...
    public MyObject[] Object;
    ...
  } 
```

我想更改这些对象的一些变量（根据某些参数），并且我认为使用 LINQ 来做到这一点。

我的问题是我真的不知道如何做一些会通过我所有递归列表的事情，无论它们的级别如何。

我希望我尽可能清楚。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:20:04.580

您可以编写一个简单的递归方法来轻松完成您想做的事情：

```
public static void Touch(MyObject obj, string otherParameter)
{
    obj.Value = otherParameter;
    foreach (var child in obj.Object)
    {
        Touch(child, otherParameter);
    }
} 
```

如果你真的，真的想要一个更 LINQ 式的方法，或者你经常这样做以至于需要更通用的方法，你可以使用这样的东西：

```
public static IEnumerable<T> FlattenTree<T>(IEnumerable<T> source, Func<T, IEnumerable<T>> selector)
{
    //you could change this to a Queue or any other data structure 
    //to change the type of traversal from depth first to breath first or whatever
    var stack = new Stack<T>(); 
    while (stack.Any())
    {
        T next = stack.Pop();
        yield return next;
        foreach (T child in selector(next))
            stack.Push(child);
    }
} 
```

然后你可以像这样使用它：

```
MyObject root = new MyObject();

var allNodes = FlattenTree(new[] { root }, node => node.Object);
foreach (var node in allNodes)
{
    node.Value = "value";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:24:59.700

您可以使用这种递归扩展方法：

```
public static IEnumerable<T> Traverse<T>(this IEnumerable<T> source, Func<T, IEnumerable<T>> fnRecurse)
{
    foreach (T item in source)
    {
        yield return item;

        IEnumerable<T> seqRecurse = fnRecurse(item);
        if (seqRecurse != null)
        {
            foreach (T itemRecurse in Traverse(seqRecurse, fnRecurse))
            {
                yield return itemRecurse;
            }
        }
    }
} 
```

你可以这样使用它：

```
var allObj = list.Traverse(o => o.Object);
foreach (MyObject o in allObj)
{ 
    // do something
} 
```

它很方便，因为它是通用的并且适用于任何类型，还因为它使用延迟执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:28:58.407

也许只是这样的事情：

```
static void AddRecursively(MyObject obj, List<MyObject> listToAddTo)
{
  listToAddTo.Add(obj);
  foreach (var o in obj.Object)
    AddRecursively(o, listToAddTo);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:36:52.450

我建议使用此扩展方法，递归地将操作应用于所有项目

```
public static void ForEach<T>(this IEnumerable<T> source,
                              Func<T, IEnumerable<T>> getChildren,
                              Action<T> action)
{
    if (source == null) {
        return;
    }
    foreach (T item in source) {
        action(item);
        IEnumerable<T> children = getChildren(item);
        children.ForEach(getChildren, action);
    }
} 
```

你会像这样将它应用到你的列表中

```
myObjectList.ForEach(x => x.Object, x => x.Value = "new value"); 
```

第一个参数告诉`ForEach`如何访问嵌套对象。第二个参数告诉如何处理每个项目。

# python - 更好地理解 __str__ 的用法

> ID：13593191
> 
> 赞同：5
> 
> 时间：2012-11-27T21:15:06.597
> 
> 标签：python, function, methods, python-3.x

我试图更好地理解该`__str__`功能的正确用法。假设我有一个名为 Character 的非常简单的类，用于游戏中，如下所示：

```
class Character(object):
""" A game character. """
def __init__(self, name):
    self.name = name
    self.poisoned = False
    self.strength = random.randrange(10, 20)
    self.max_strength = self.strength
    self.dexterity = random.randrange(10, 20)
    self.max_dexterity = self.dexterity
    self.hit_points = 100
    self.spell_points = 100
    self.weapon = []
    self.spell = []
    self.items = []
    self.aura = []
    self.xp = 0 
```

在了解该`__str__`函数之前，我会定义一个名为的类的方法，该方法`print_stats(self)`将通过`Character.print_stats()`. 在了解了`__str__`这似乎是一个用于定义和显示对象统计信息的函数之后，类似于我会做的事情`print_stats(self)`......但在玩它并了解到返回的值必须是一个字符串并且不包含整数，看来我的假设是错误的。

所以现在我的问题是有哪些很好使用的例子`__str__`？我提供的示例是否会从使用该功能中受益？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T21:17:18.640

打印统计数据是`__str__()`. 只需使用字符串格式来返回单个字符串值：

```
def __str__(self):
    return ('Name: {name}\n'
        'Poisoned: {poisoned}\n'
        # etc.
    ).format(**self.__dict__) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:18:01.633

`__str__`存在，以便您可以获得对象的字符串表示形式。请注意，内置`print`函数/语句`str`隐式调用：

```
print 1 
```

与以下内容完全相同：

```
print str(1) 
```

这与以下内容相同：

```
print (1).__str__() 
```

因为 print`__str__`隐式调用。

* * *

现在到你的班级——最自然的事情是你会写：

```
print self.foo,self.bar,self.baz 
```

你可以定义`__str__`为：

```
def __str__(self):
    return " ".join(str(x) for x in (self.foo,self.bar,self.baz)) 
```

现在要打印角色的统计数据，您只需执行以下操作：

```
print character  #same as `print str(character)` :) 
```

通常这有点有限，因此存在字符串格式`.format`（或使用运算符的旧“sprintf”样式格式`%`）。

```
def __str__(self):
    return "my {foo} went to the {baz} to buy a {bar}".format(foo=self.foo,
                                                              baz=self.baz,
                                                              bar=self.bar) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:16:54.593

```
def __str__(self):
  return 'Name: %s, Hit points: %d' % (self.name, self.hit_points) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:17:02.533

返回值必须是字符串，但它可以是任何字符串，包括包含整数字符串表示的字符串。一个简单的例子：

```
def __str__(self):
  return "%s (strength: %i)" % (self.name, self.strength) 
```

这可能会返回类似`"Arthur (strength: 42)"`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T21:22:51.747

在基本用例中，`__str__()`类似的方法`print_stats()`可以非常安全地互换。但是，特别是对于游戏中的角色之类的东西，您可能想要使用`print_stats()`，因为您将无法进行重构`__str__()`以执行诸如将数据打印到屏幕上的操作（在图形桌面或 Web 应用程序的上下文中） , 或采取论点，这可能对这样的事情有用。

# mysql - dump.sql 包含事件

> ID：13593194
> 
> 赞同：1
> 
> 时间：2012-11-27T21:15:17.667
> 
> 标签：mysql, mysqldump

我只想知道，当我创建我的 mysql 数据库的备份 (dump.sql) 时，它是否还会包含我创建的事件以及例如每天在我的数据库中执行更改的事件。事件将存储在数据库 information_schema 中，所以我不确定是否通过备份我的数据库我也保存事件......提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:16:40.237

它可以，但前提是您包含该`--events`选项。

或者，在 MySQL 管理员中：

![转储事件](../Images/a48186bd2b2047ea635891cddd14d3bc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-12T13:06:05.017

从命令行，使用 --noevents 标志运行 mysqldump 命令

```
mysqldump -u username -p --events dbname > anyfilename.sql 
```

# javascript - javascript键值对象中的排序顺序差异

> ID：13593195
> 
> 赞同：0
> 
> 时间：2012-11-27T21:15:17.627
> 
> 标签：javascript, jquery

我已经为我的问题设置了一个 jsFiddle 示例：[示例](http://jsfiddle.net/3s6Qf/1/)

鉴于此html：

```
<select id="drop1" data-jsdrop-data="countries"></select>
<select id="drop2" data-jsdrop-data="countries2"></select>​ 
```

以及以下 javascript：

```
var countries = {"1" : "Albania", "5" : "Australia","2": "United Arab Emerates"};
var countries2 = {"AL" : "Albania", "AU" : "Australia", "AE" : "United Arab Emerates"};

function loadJSOptions(selector, list) {
    $.each(list, function (key, value) {
        $(selector).append($("<option></option>").val(key).html(value));
    }
});

$(document).ready(function() { 
    $('select[data-jsdrop-data]').each(function() {
       var selector = $(this);
       var listname = selector.attr("data-jsdrop-data");
       var listvalue = null;
       eval("listvalue = " + listname + ";");
       loadJSOptions(selector, listvalue);
    });
}); 
```

谁能向我解释为什么带有字母键的列表是根据输入的顺序列出的，而带有数字键的列表是根据键排序的？如果您查看 jsFiddle 结果，您会看到 drop1 显示 Albania, United Arab Emerates, Australia 而 drop2 显示 Albania, Australia, United Arab Emerates。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:30:35.797

对象属性没有顺序，如果您枚举它们，顺序是实现定义的。它们通常按照解析对象文字的顺序存储，但您不能依赖它。例如，数字键（如`countries1`）似乎在您的浏览器中进行了排序。

如果您想要明确的顺序，请使用数组（带有数字键的对象）并迭代它们：

```
var lists = {
    countries1: [
        {key:"1", val:"Albania"},
        {key:"5", val:"Australia"},
        {key:"2", val:"United Arab Emerates"}
    ],
    countries2: [
        {key:"AL", val:"Albania"},
        {key:"AU", val:"Australia"}, 
        {key:"AE", val:"United Arab Emerates"}
    ]
};

$(document).ready(function() { 
    $('select[data-jsdrop-data]').each(function() {
        var $this = $(this),
            listname = $this.attr("data-jsdrop-data"),
            list = lists[listname]; // don't use eval!
        for (var i=0; i<list.length; i++) {
            var item = list[i];
            $this.append($("<option>").val(item.key).text(item.value));
        }
    });
}); 
```

for 循环比`$.each`. 当您不确切知道它的作用以及何时需要它时，请不要使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:22:52.007

我相信如果您在对象上有一个数字属性，`jQuery.each()`则需要使用数组类型访问该属性（即`countries[1]`, `countries[2]`, `countries[5]`）。因此，它将按数字索引顺序迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:29:02.693

使用 jQuery 的`$.each`默认值`for( a in b )`不能*保证 order*。这就是为什么您看到订单似乎不连续或出乎意料的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T23:09:50.400

您可以使用以下方法更有效地构建选项：

```
$('select[data-jsdrop-data]').each(function() {
    var list = window[this.getAttribute('data-jsdrop-data')];
    var i = 0;
    for (var p in list) {
        this.options[i++] = new Option(p, list[p]);
    }
}); 
```

# r - 组合数据的标准差

> ID：13593196
> 
> 赞同：0
> 
> 时间：2012-11-27T21:15:21.403
> 
> 标签：r, variance, propagation, standard-deviation

我有一个包含平均值、标准差和 n 的数据集。其中一个变量的样本量相等，而另一个变量的样本量不同。

```
dat <- data.frame(variable = c(rep("x", 2), rep("y", 3)), replicate = c(1,2,1,2,3),
mean = c(3.4, 2.5, 6.5, 5.7, 5.1), sd = c(1.2, 0.7, 2.4, 4.0, 3.5),
n = c(3,3,5,4,6)) 
```

我需要组合`x`和`y`变量，并试图找到一种节省代码的方法来计算组合标准偏差，例如使用`aggregate`函数。[组合标准差的公式](http://www.talkstats.com/showthread.php/14523-An-average-of-standard-deviations)如下：

![在此处输入图像描述](../Images/7d88fdbb508009644ae1ba5ab77d7e29.png)

对于不等的样本量（[相同的来源](http://www.talkstats.com/showthread.php/14523-An-average-of-standard-deviations)）：

![在此处输入图像描述](../Images/b1520bca224f4410bf8aa1342607088b.png)

我的组合数据框应如下所示：

```
variable    mean    sd
x           2.95    sd_x
y           5.76    sd_y 
```

**如何在 R 中创建一个计算组合标准差的函数？**或者，如果有为此设计的包，它也算作答案=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:16:20.083

[Rudmin (2010)](http://arxiv.org/ftp/arxiv/papers/1007/1007.1012.pdf)指出，合并数据集的精确方差是方差的均值加上均值的方差。[flodel 已经提供了一个答案和函数](https://stackoverflow.com/questions/9222056/existing-function-to-combine-standard-deviations-in-r?rq=1)，它给出了与 Rudmin 的声明相似的值。使用基于[Wikipedia](http://en.wikipedia.org/wiki/Standard_deviation#Combining_standard_deviations)的Rudmin 的数据集和[flodel 的函数](https://stackoverflow.com/questions/9222056/existing-function-to-combine-standard-deviations-in-r?rq=1)：

```
df <- data.frame(mean = c(30.66667, 31.14286, 40.33333), variance = c(8.555555, 13.26531, 1.555555), n = c(6,7,3))

grand.sd   <- function(S, M, N) {sqrt(weighted.mean(S^2 + M^2, N) -
                                      weighted.mean(M, N)^2)}

grand.sd(sqrt(df$variance), df$mean, df$n)^2 

#[1] 22.83983 = Dp variance in Rudmin (2010). 
```

[然而，与 Headrick (2010)](http://www.talkstats.com/showthread.php/14523-An-average-of-standard-deviations)中的函数 5.38 相比，此解决方案给出的值略有不同（除非某处有错误）：

```
dat <- data.frame(variable = c(rep("x", 2), rep("y", 3)), replicate = c(1,2,1,2,3),
mean = c(3.4, 2.5, 6.5, 5.7, 5.1), sd = c(1.2, 0.7, 2.4, 4.0, 3.5),
n = c(3,3,5,4,6))

x <- subset(dat, variable == "x")

((x$n[1]^2)*(x$sd[1]^2)+
(x$n[2]^2)*(x$sd[2]^2)-
(x$n[2])*(x$sd[1]^2) -
(x$n[2])*(x$sd[2]^2) -
(x$n[1])*(x$sd[1]^2) -
(x$n[1])*(x$sd[2]^2) +
(x$n[1])*(x$n[2])*(x$sd[1]^2) +
(x$n[1])*(x$n[2])*(x$sd[2]^2) +
(x$n[1])*(x$n[2])*(x$mean[1] - x$mean[2])^2)/
((x$n[1] + x$n[2] - 1)*(x$n[1] + x$n[2]))

#[1] 1.015

grand.sd(x$sd, x$mean, x$n)^2

#[1] 1.1675 
```

为了回答我自己的问题，`data.frame`将获得以下所需的内容：

```
library(plyr)
ddply(dat, c("variable"), function(dat) c(mean=with(dat,weighted.mean(mean, n)),  sd = with(dat, grand.sd(sd, mean, n))))   

  variable     mean       sd
1        x 2.950000 1.080509
2        y 5.726667 3.382793 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-06T04:42:28.443

## 使用包`sample.decomp`中的函数`utilities`

这类统计问题在[包](https://CRAN.R-project.org/package=utilities)`sample.decomp`中的函数中是自动化的。此函数可以从子组矩计算池样本矩，或从其他子组矩和池矩计算缺失的子组矩。它适用于高达四阶的分解——即样本大小、样本均值、样本方差/标准偏差、样本偏度和样本峰度的分解。[`utilities`](https://CRAN.R-project.org/package=utilities)

* * *

**如何使用该函数：**这里我们展示了如何为您的数据集实现该函数。

```
#Input sample statistics for subgroups
SIZE <- c(3, 3, 5, 4, 6)
MEAN <- c(3.4, 2.5, 6.5, 5.7, 5.1)
SD   <- c(1.2, 0.7, 2.4, 4.0, 3.5)

#Compute sample decomposition
library(utilities)
sample.decomp(n = SIZE, sample.mean = MEAN, sample.sd = SD, include.sd = TRUE)

            n sample.mean sample.sd sample.var
1           3    3.400000  1.200000   1.440000
2           3    2.500000  0.700000   0.490000
3           5    6.500000  2.400000   5.760000
4           4    5.700000  4.000000  16.000000
5           6    5.100000  3.500000  12.250000
--pooled-- 21    4.933333  2.964428   8.787833 
```

此输出为您提供合并样本量、样本均值和样本标准差（或等效的样本方差）。

# asp.net-mvc - 处理行动咨询和行动结果的模式或方式

> ID：13593198
> 
> 赞同：1
> 
> 时间：2012-11-27T21:15:28.157
> 
> 标签：asp.net-mvc

我有一个用户输入各种值的表单，然后用户发送查询并处理搜索结果。

这很简单，但问题是这样的。

在 MVC 中，如果表单有错误，要在服务器上进行验证，应该再次显示错误的表单。但是如果我将请求发送到数据搜索操作，我应该返回一个重定向到咨询操作表单，这将丢失验证消息。

目前我们所做的是将数据请求到咨询表单的操作，然后如果一切正常，我们将操作结果重定向到使用 tempdata 发送请求数据。

这种情况有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:47:06.640

如果我理解正确，PRG 模式应该适用于您的情况。在后期操作中，如果模型状态无效，则重定向回咨询表，否则继续搜索操作。过滤器将内部保存临时数据中的错误。

[发布/状态更改后的 MVC3 模型验证最佳实践重定向](https://stackoverflow.com/questions/7940939/mvc3-model-validation-best-practice-redirect-after-post-state-change)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:27:20.080

返回`View(model)`验证错误或`RedirectToAction()`取决于 ModelState：

```
ActionResult Consult(@params) {
    if (ModelState.IsValid) {
        //validation succeeded.
        return RedirectToAction("SearchResults", {searchParams = @params});
    }

    return View(@params);
} 
```

重点是，您可以在重定向时传递参数。

# ruby-on-rails - 通过多态关联查询

> ID：13593200
> 
> 赞同：0
> 
> 时间：2012-11-27T21:15:41.730
> 
> 标签：ruby-on-rails, polymorphic-associations

只是在 RoR 周围玩耍，试图通过一些建模找到方法。请注意以下代码：

```
 class Picture < ActiveRecord::Base
      belongs_to :imageable, :polymorphic => true
 end

 class Employee < ActiveRecord::Base
      has_many :pictures, :as => :imageable
 end

 class Product < ActiveRecord::Base
      has_many :pictures, :as => :imageable
 end 
```

*有没有办法通过特定图片获取产品？* 我正在尝试这个，但它不起作用：

```
picure = Picture.last
product = Product.where(picture: picure) 
```

它失败了：

```
SQLite3::SQLException: no such column: products.picture: SELECT "products".*
FROM "products" WHERE "products"."picture" IS NULL LIMIT 1``` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:22:28.910

如果您有 的实例`Picture` `@picture`，则可以使用`belongs_to`来获取它的关联`Product`（假设它`Picture`实际上属于`Product`and的实例`Employee`）

```
product = @picture.imageable 
```

# vb.net - 在 VB.NET 中动态声明第三方 DLL

> ID：13593206
> 
> 赞同：3
> 
> 时间：2012-11-27T21:16:01.293
> 
> 标签：vb.net, dll, import

我在不同环境中导入 DLL 时遇到问题。`C:\Program Files\`我必须检查 Windows 平台并导入将放置在(for `32-bit`) 或`C:Program Files (x86)\`(for )中的第三方 DLL `64-bit`。

在代码写成这样之前：

```
Declare Function RDRCConnect Lib "c:\program files\TP-DLL\RDRCAP32.DLL" (ByVal lpszServerName As String, ByVal lNetConnType As Integer, ByVal lpszParam1 As String, ByVal lpszParam2 As String, ByVal lpszParam3 As String, ByRef lNetConn As Integer, ByRef lNetErr As Integer) As Integer  
Declare Function RDRCDisconnect Lib "c:\program files\TP-DLL\RDRCAP32.DLL" (ByVal lNetConn As Integer, ByRef lNetErr As Integer) As Integer 
```

...我改为使用属性：

```
Private Const CheminDLL As String = "C:\Program Files\TP-DLL\RDRCAP32.DLL"

<System.Runtime.InteropServices.DllImport(CheminDLL)>
Private Shared Function RDRCConnect(ByVal lpszServerName As String, ByVal lNetConnType As Integer, ByVal lpszParam1 As String, ByVal lpszParam2 As String, ByVal lpszParam3 As String, ByRef lNetConn As Integer, ByRef lNetErr As Integer) As Integer
End Function 
```

一旦 DLLImport 需要一个常量作为参数，如何在这种情况下动态更改 DLL 路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:31:24.667

没有办法将除常量之外的任何东西传递给属性，因为根据定义，属性是在编译时评估的，而不是在运行时评估的。可能有更好的选择，但我可以给你的一个选择是为每个版本创建单独的导入：

```
<DllImport("C:\Program Files\TP-DLL\RDRCAP32.DLL", EntryPoint := "RDRCConnect")>
Private Shared Function RDRCConnect32(ByVal lpszServerName As String, ByVal lNetConnType As Integer, ByVal lpszParam1 As String, ByVal lpszParam2 As String, ByVal lpszParam3 As String, ByRef lNetConn As Integer, ByRef lNetErr As Integer) As Integer
End Function

<DllImport("C:\Program Files (x86)\TP-DLL\RDRCAP32.DLL", EntryPoint := "RDRCConnect")>
Private Shared Function RDRCConnect64(ByVal lpszServerName As String, ByVal lNetConnType As Integer, ByVal lpszParam1 As String, ByVal lpszParam2 As String, ByVal lpszParam3 As String, ByRef lNetConn As Integer, ByRef lNetErr As Integer) As Integer
End Function 
```

然后，您需要在每次调用该方法时选择适当调用哪一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:30:09.940

几天前，当我遇到与您类似的问题时，我偶然发现了这一点，这使我走上了正确的道路。[在这里](https://stackoverflow.com/questions/8641321/dynamic-invocation-of-methods-in-dlls-how-to-change-method-signature)寻找它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:51:47.563

如果 dll 相同（相同的名称和签名）但只是在不同的位置，那么您可以使用在运行时确定的 dll 的完整路径显式地p/invoke [LoadLibrary 。](http://www.pinvoke.net/default.aspx/kernel32.loadlibrary)只要在调用任何导出的 API**之前**执行此操作，只要导入中的 dll 名称相同，它将使用已加载的 API。

# javascript - 在 Ext.window.MessageBox 中的按钮上添加单击侦听器

> ID：13593209
> 
> 赞同：5
> 
> 时间：2012-11-27T21:16:16.940
> 
> 标签：javascript, jquery, html, extjs

我正在动态创建一个消息框（Ext.window.MessageBox）

```
var msgBox = Ext.create('Ext.window.MessageBox', {
       title: '',
       //message in window
       msg: 'message text',
       icon: 'WARNING',
       //buttons
       buttons: 'OKCANCEL',
       //onclick funciton
       fn: myfunc
 }); 
```

我正在添加确定和取消按钮。是否可以在“确定”按钮上添加点击监听器，以便只有在按下“确定”按钮时我才能做我的事情？

是否可以将特定的 id 添加到 OK 和 Cancel 按钮，以便我可以更轻松地区分它们，而不是使用来自 ExtJS 的预生成 id？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T21:18:46.343

您可以改用以下结构：

```
Ext.MessageBox.show({
    title: "",
    msg: "message text",
    icon: Ext.MessageBox.WARNING,
    buttons: Ext.MessageBox.OKCANCEL,
    fn: function(buttonId) {
        if (buttonId === "ok") {
            // do on OK pressed
        }
    }
}); 
```

这里`fn`处理程序中的第一个参数是按下按钮的字符串值。

**演示：http:** [//jsfiddle.net/xj9qY/](http://jsfiddle.net/xj9qY/)

# php - 如何检查两个条件/规则是否匹配？

> ID：13593211
> 
> 赞同：1
> 
> 时间：2012-11-27T21:16:23.910
> 
> 标签：php, match, conditional-statements, logical-operators

我有一些项目，每个项目都有一个规则，我想知道哪个项目与另一个项目匹配。

假设项目 1 具有规则 1，项目 2 具有规则 2：

规则1：

```
z and d and (y or u) and j 
```

规则 2：

```
u or ((e or z) and (d or y)) 
```

如何检查这些项目是否匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:25:06.363

这是我从你的问题中得到的：

```
<?php
$rule1 = false;
$rule2 = false;

if($z && $d && ($y || $u) && $j){
    $rule1 = true;
}

if($u || (($e || $z) && ($d || $y))){
    $rule2 = true;
}

if($rule1==$rule2){
    echo 'These rules match.';
}else{
    echo 'These rules do not match.';
}?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T05:52:28.953

您创建一个真值表：对于输入变量的每个可能组合，计算两个规则的结果。如果它们为每个组合提供相同的值，则规则是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:37:44.303

您可以将每个规则的结果分配给变量：

```
$rule1 = $z and $d and ($y or $u) and $j;
$rule2 = $u or (($e or $z) and ($d or $y)); 
```

两个`$rule`变量现在都是`true`或`false`。

```
$itemsMatch = $rule1 === $rule2; 
```

# regex - Apache htaccess rewrite rule not matching

> ID：13593213
> 
> 赞同：0
> 
> 时间：2012-11-27T21:16:30.910
> 
> 标签：regex, apache, .htaccess, mod-rewrite

I am attempting to match a URL like

```
http://www.example.org/?h=b1c60d1bf7c7119fef9fc726068e1418166.xml 
```

or

```
?h=b1c60d1bf7c7119fef9fc726068e1418166.jsonp&callback=testing 
```

and re-write it like this:

```
?h=b1c60d1bf7c7119fef9fc726068e1418166&output=true&format=true&data_type=xml 
```

or

```
?h=b1c60d1bf7c7119fef9fc726068e1418166&output=true&format=true&data_type=jsonp&callback=testing 
```

Here is the .htaccess file with the regex I came up with.

```
RewriteEngine On

RewriteBase /
RewriteRule ^/?\?h=([a-z0-9]+)\.(xml|json|jsonp|rss)(\&callback=[a-z_0-9]+)?$ ?h=$1&output=true&format=true&data_type=$2&callback=$3 [L,NC,QSA] 
```

Any ideas why this isn't matching? I've tested this in the server environment and on [http://htaccess.madewithlove.be/](http://htaccess.madewithlove.be/) with no luck.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:32:09.313

`RewriteRule`不匹配查询，只是路径文件/目录名称。

用于`RewriteCond %{QUERY_STRING}`处理查询。

# mysql - Merging two table entries with unique columns (MySQL)

> ID：13593217
> 
> 赞同：3
> 
> 时间：2012-11-27T21:16:43.737
> 
> 标签：mysql

I know full well this should never happen. Ever. However, I started working at a company recently that hasn't had the greatest database design or input validation and this situation has come up.

There is a table which we'll call 'jobs'*. Jobs has a primary key, 'ID'. The job with the ID of 1 has loads of data associated with it; However, stupidly someone has duplicated that job as id 2 (this has happened around ~500 times so far). All of the information for both needs to be merged as id 1 (or 2, it doesn't matter).

The columns ARE linked by Foreign Key with UPDATE: CASCADE and DELETE: RESTRICT. They are not all called jobs_id.

Is my only (seemingly sensible) option here to:

1.  Change id 1 to something I can guarantee is not used (2,147,483,647)
2.  Temporarily remove the Foreign Key DELETE: RESTRICT
3.  Delete the entry with id 1
4.  Update id 2 to 2,147,483,647 (to link it with all the other entries)
5.  Change id 2,147,483,647 to id 2
6.  Reinstate DELETE: RESTRICT

As none of the code actually performs a delete (the restriction is there just as a fail-safe (someone editing direct in DB)), and the update: cascade is left in, data shouldn't get out of sync. This does seem messy though.

This will be wrapped in a transaction.

I could write something to iterate through each table (~180) and each column to find certain names / conditions, then update from 1 to 2, but that would need maintenance when a new table / column came along.

As this has happened a lot, and I don't see a re-write to prevent it happening any time soon, the 'solution' (sticking plaster) needs to be semi-automatic.

*   not the table's real name. His (or her) identity has been disguised so he (or she) doesn't get bullied.

Appreciate any input.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:03:48.943

假设您知道如何识别重复记录，为什么不创建具有相同结构的新表（可能没有 FK），然后在将值复制到新表时遍历原始表。当您遇到重复时，在写入新表时修复该值。然后删除原始文件并将临时重命名为原始文件。

这将清理表格，但如果进程仍在制作重复条目，您可以使用唯一键来限制未来的损坏。

# xcode - sqlite错误解析查询

> ID：13593222
> 
> 赞同：1
> 
> 时间：2012-11-27T21:17:04.123
> 
> 标签：xcode, cocoa, sqlite, parsing

我在使用 sqlite 查询数据库时收到一个奇怪的错误： `SQLlite error: near "SE": syntax error` 我真的不明白为什么他不喜欢我发送给它的查询字符串。这是我的代码：

```
-(Wallet*)loadDataFromSQL{
    sqlite3 *database;
    NSLog(@"opening..");
    if (sqlite3_open([[NSString stringWithFormat:@"mywallet.sqlite3"] UTF8String], &database) == SQLITE_OK) {
        NSLog(@"opened..");
        const char *query = [[NSString stringWithFormat:@"SELECT * FROM 'Transaction';"] UTF8String]; // "insert into \"Transaction\" values (\"2013-01-01\",\"tipo\",\"cat\",1)";
        sqlite3_stmt *selectstmt;
        NSLog(@"preparing stmnt..");
        if(sqlite3_prepare_v2(database, query, SQLITE_OPEN_READWRITE, &selectstmt, nil) == SQLITE_OK) {
            NSLog(@"Prepared..");
            while(sqlite3_step(selectstmt) == SQLITE_ROW) {
                NSLog(@"row..");
                NSString *data = [NSString stringWithUTF8String: (char*)sqlite3_column_text(selectstmt, 0)];
                NSString *type = [NSString stringWithUTF8String: (char*)sqlite3_column_text(selectstmt, 1)];
                NSString *category = [NSString stringWithUTF8String: (char*)sqlite3_column_text(selectstmt, 2)];
                float amount = (float)sqlite3_column_double(selectstmt, 0);

                Transaction *t = [[Transaction alloc]init:data transactionType:type transactionCategory:category transactionAmount:[NSString stringWithFormat:@"%f",amount]];
                NSLog(@"%@",t);
            }
        }else{
            NSLog([NSString stringWithFormat:@"SQLlite error: %s\n", sqlite3_errmsg(database)]);
        }
    }
    sqlite3_close(database); //Even though the open call failed, close the database connection to release all the memory.
    return nil;
} 
```

没什么太花哨的..有什么问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T07:51:34.253

[sqlite3_prepare_v2](http://www.sqlite.org/c3ref/prepare.html)的第三个参数必须是查询字符串的长度，或者只是`-1`.

```
sqlite3_prepare_v2(database, query, SQLITE_OPEN_READWRITE, &selectstmt, nil) 
```

由于 SQLite 抱怨“ `SE`”，我猜想 的值`SQLITE_OPEN_READWRITE`是`2`。`:-)`

# python - 确保带有子进程的 Python 脚本在 SIGINT 上死掉

> ID：13593223
> 
> 赞同：41
> 
> 时间：2012-11-27T21:17:04.127
> 
> 标签：python, signals

我有一个命令，我`script`使用`subprocess.Popen`. 如果用户发出`SIGINT`.

我可以确定该过程是否以至少两种方式被中断：

A. 如果被包装的命令具有非零退出状态，则死亡（不起作用，因为`script`似乎总是返回 0）

B.`SIGINT`在父 Python 脚本中做一些特别的事情，而不是简单地中断子进程。我尝试了以下方法：

```
import sys
import signal
import subprocess

def interrupt_handler(signum, frame):
    print "While there is a 'script' subprocess alive, this handler won't executes"
    sys.exit(1)
signal.signal(signal.SIGINT, interrupt_handler)

for n in range( 10 ):
    print "Going to sleep for 2 second...Ctrl-C to exit the sleep cycles"

    # exit 1 if we make it to the end of our sleep
    cmd = [ 'script', '-q', '-c', "sleep 2 && (exit 1)", '/dev/null']
    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

    while True:
        if p.poll() != None :
            break
        else :
            pass

    # Exiting on non-zero exit status would suffice
    print "Exit status (script always exits zero, despite what happened to the wrapped command):", p.returncode 
```

我想按 Ctrl-C 退出 python 脚本。相反，发生的是子进程死亡并且脚本继续。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-06T05:23:30.243

子进程默认属于同一个进程组，只有一个可以控制和接收来自终端的信号，所以有几种不同的解决方案。

**将 stdin 设置为 PIPE**（与从父进程继承相反），这将阻止子进程接收与其关联的信号。

```
subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) 
```

**与父进程组分离，子进程**将不再接收信号

```
def preexec_function():
    os.setpgrp()

subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, preexec_fn=preexec_function) 
```

**显式忽略子进程中的信号**

```
def preexec_function():
    signal.signal(signal.SIGINT, signal.SIG_IGN)

subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, preexec_fn=preexec_function) 
```

然而，这可能会被子进程覆盖。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-09T16:26:52.277

拳头东西；对象上有一个`send_signal()`方法`Popen`。如果您想向已启动的信号发送信号，请使用此方法发送信号。

第二件事；您与子进程建立通信的方式存在更深层次的问题，然后，嗯，不与它通信。您不能安全地告诉子进程将其输出发送到`subprocess.PIPE`管道然后不从管道中读取。UNIX管道被缓冲（通常是4K缓冲区？），如果子进程填满缓冲区并且管道另一端的进程没有读取缓冲数据，则子进程将挂起（从观察者的角度来看，锁定) 在下一次写入管道时。因此，使用时通常的模式是`subprocess.PIPE`调用对象。`communicate()``Popen`

`subprocess.PIPE`如果您想从子流程返回数据，则不必使用它。一个很酷的技巧是使用`tempfile.TemporaryFile`该类创建一个未命名的临时文件（实际上它会打开一个文件并立即从文件系统中删除 inode，因此您可以访问该文件但没有其他人可以打开一个。您可以做一些事情像：

```
with tempfile.TemporaryFile() as iofile:
    p = Popen(cmd, stdout=iofile, stderr=iofile)
    while True:
        if p.poll() is not None:
            break
        else:
            time.sleep(0.1) # without some sleep, this polling is VERY busy... 
```

然后，当您知道子进程已退出而不是使用管道时，您可以读取临时文件的内容（在执行之前先查找它的开头，以确保您在开头）。如果子进程的输出将发送到文件（临时或非临时），则管道缓冲问题不会成为问题。

这是您的代码示例的即兴演奏，我认为它可以满足您的需求。信号处理程序只是将父进程捕获的信号（在本例中为 SIGINT 和 SIGTERM）重复到所有当前子进程（该程序中应该只有一个），并设置一个模块级标志，表示在下一次关闭机会。因为我使用的是`subprocess.PIPE`I/O，所以我调用`communicate()`了`Popen`对象。

```
#!/usr/bin/env python

from subprocess import Popen, PIPE
import signal
import sys

current_subprocs = set()
shutdown = False

def handle_signal(signum, frame):
    # send signal recieved to subprocesses
    global shutdown
    shutdown = True
    for proc in current_subprocs:
        if proc.poll() is None:
            proc.send_signal(signum)

signal.signal(signal.SIGINT, handle_signal)
signal.signal(signal.SIGTERM, handle_signal)

for _ in range(10):
    if shutdown:
        break
    cmd = ["sleep", "2"]
    p = Popen(cmd, stdout=PIPE, stderr=PIPE)
    current_subprocs.add(p)
    out, err = p.communicate()
    current_subprocs.remove(p)
    print "subproc returncode", p.returncode 
```

并调用它（`Ctrl-C`在第三个 2 秒间隔内使用 a ）：

```
% python /tmp/proctest.py 
subproc returncode 0
subproc returncode 0
^Csubproc returncode -2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T21:38:55.207

这个hack会起作用，但它很难看......

将命令更改为：

```
success_flag = '/tmp/success.flag'
cmd = [ 'script', '-q', '-c', "sleep 2 && touch " + success_flag, '/dev/null'] 
```

并放

```
if os.path.isfile( success_flag ) :
    os.remove( success_flag )
else :
    return 
```

在 for 循环结束时

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T15:29:05.303

如果您在生成进程后没有要执行的 python 处理（如在您的示例中），那么最简单的方法是使用 os.execvp 而不是 subprocess 模块。您的子进程将完全取代您的 python 进程，并将成为直接捕获 SIGINT 的进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T20:36:46.563

我在脚本手册页中找到了一个 -e 开关：

```
-e      Return the exit code of the child process. Uses the same format
         as bash termination on signal termination exit code is 128+n. 
```

不太确定 128+n 是什么意思，但 ctrl-c 似乎返回 130。所以修改你的 cmd 是

```
cmd = [ 'script', '-e', '-q', '-c', "sleep 2 && (exit 1)", '/dev/null'] 
```

并把

```
if p.returncode == 130:
    break 
```

在 for 循环结束时似乎做你想做的事。

# mysql - 如何从单个表中计算百分比

> ID：13593225
> 
> 赞同：1
> 
> 时间：2012-11-27T21:17:04.943
> 
> 标签：mysql

我正在尝试计算交易表上的百分比。如果我使用视图，我可以达到我想要的效果，但是对于我正在处理的数字，更快的东西会更受欢迎。

表（betID 是唯一的）：

```
投注ID | 用户名 | 成功  
 1 | 1 | -1
 2 | 1 | 1
 3 | 2 | -1
 4 | 3 | 1

```

我想找到每个用户的获胜百分比。我有一种强烈的感觉，我错过了一些小东西，并且会为答案而踢自己，但是我看过的所有示例都无法开始工作。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:35:25.867

百分比是成功次数除以投注次数。

困难的部分是在不执行额外选择语句的情况下计算成功次数。

答案是将 -1 值转换为 0 值，以便成功的总和为您提供成功的次数（我假设 -1 是损失）：

```
select userID, sum(if(success = 1, 1, 0)) / count(*) * 100 as pct  from bets group by userID; 
```

# javascript - onResize 在 iPad 上陷入无限循环

> ID：13593229
> 
> 赞同：2
> 
> 时间：2012-11-27T21:17:16.433
> 
> 标签：javascript

我对javascript有点陌生，所以如果这是一个愚蠢的问题，请原谅。

我有一个显示几个图表的网站。问题是这些图表是在页面加载时绘制的，这意味着即使屏幕的宽度/高度发生变化，它们也会保持原始大小。这在桌面版本上不是问题，但现在我想让它也能在我的 iPhone 和 iPad 上运行。这意味着当我从纵向切换到横向时，需要重新加载图表，反之亦然。

我试图通过在 body-tag 中添加“onResize”来解决这个问题。当我在桌面模式下调整浏览器窗口的大小时，这非常有效，并且在我的 iPhone 上也可以正常工作。但是 iPad 陷入了无限循环！为什么？

请帮我解决这个问题，我现在已经花了好几个小时了......

这是我使用的代码：

在标题中：

```
<script type="text/javascript">
function myfunction(){window.location.href = window.location.href;}
</script> 
```

在正文中：

```
<body onresize="myfunction()"> 
```

# php - 验证组中特定且唯一的一组值

> ID：13593234
> 
> 赞同：2
> 
> 时间：2012-11-27T21:17:30.007
> 
> 标签：php, mysql, database, mysqli

我有一个具有以下结构的 MySQL 表：

![在此处输入图像描述](../Images/ff9e7d3700dcd22f50f1f1d6b8c8055e.png)

我想要一个接收一组`uid`s （或单个 s `uid`）的查询，然后检查它们是否存在于特定 mid 下的封闭组中。如果它们存在，则查询应返回`mid`它们存在的位置。例如在上表中：

```
('chuks.obima', 'crackhead') should return '2
('vweetah','crackhead') should return '1'
('vweetah','crackhead','chuks.obima') should return 3
('crackhead') should return an empty result 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:39:52.723

I think you need something like this:

```
SELECT mid
FROM your_table
WHERE uid in ('favour','crackhead','charisma')
GROUP BY mid
HAVING COUNT(*)=3 
```

**EDIT:** based on your second example, this is what you are looking for:

```
SELECT mid
FROM your_table
WHERE uid in ('vweetah', 'crackhead')
GROUP BY mid
HAVING
  COUNT(distinct uid)=
  (select count(*)
   from (select 'vweetah' union select 'crackhead') s) 
```

or you can just substitute last subquery with the number of elements you are looking for, e.g. `HAVING COUNT(distinct uid) = 2`

**EDIT2**: now i understand exactly what you are looking for. This should give you the correct results:

```
SELECT your_table.mid, s.tot_count, count(distinct uid)
FROM
  your_table inner join
  (select mid, seq, count(distinct uid) tot_count from your_table group by mid, seq) s
  on your_table.mid = s.mid and your_table.seq=s.seq
WHERE your_table.uid in ('crackhead')
GROUP BY your_table.mid
HAVING COUNT(distinct uid)=s.tot_count AND COUNT(distinct uid)=1 
```

where the last count is equal to the number of elements you are looking for. This could be simplified like this:

```
SELECT your_table.mid
FROM your_table
GROUP BY your_table.mid
HAVING
  count(distinct uid)=
  count(distinct case when your_table.uid in ('vweetah','crackhead','chuks.obima') then your_table.uid end)
  and count(distinct uid)=3 
```

如果如果所有 uid 都在同一组下，则认为该组已关闭`seq`，您还必须修改 group by with:`group by your_table.mid, your_table.seq`和您的 select with`SELECT distinct your_table.mid`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:25:45.787

要验证它是否是一个封闭组，您可以获取该组`COUNT()`的总成员总数`mid`，并将其与列表中的人数进行比较。如果它们相等，则它是封闭的。

如果所有 3 人都在组中，则以下将返回 a `1`，并且组中的总人数也是 3。

```
SELECT
  (((SELECT COUNT(*) FROM yourtable WHERE `uid` IN ('favour','crackhead','charisma') AND `mid` = 2) 
  =
  (SELECT COUNT(*) FROM yourtable WHERE `mid` = 2)) 
  AND (SELECT COUNT(*) FROM yourtable WHERE `mid` = 2) = 3) AS group_is_closed 
```

将其包装在子查询中以避免计算`mid`两次。

```
SELECT
  /* 3 is the number of uid you are looking for */
  (mid_count = 3 AND mid_count = member_count) AS group_is_closed
FROM (
  SELECT
   /* Find how many of your uids are in the `mid` */
   (SELECT COUNT(*) FROM yourtable WHERE `uid` IN ('favour','crackhead','charisma') AND `mid` = 2) AS member_count,
   /* Find the total number of uids in the `mid` */
   (SELECT COUNT(*) FROM yourtable WHERE `mid` = 2) AS mid_count
) subq 
```

### SQLFiddle demos (*aka wow, it actually works*):

*   [Positive result](http://sqlfiddle.com/#!2/5a058/1) (Only the 3 selected are in the `mid`, returns 1)
*   [Negative result](http://sqlfiddle.com/#!2/ae4ec/1) (A user not among the 3 is also in the `mid`, returns 0)
*   [Negative result 2](http://sqlfiddle.com/#!2/e142b/1) (One of the 3 users is *not* in the `mid`, returns 0)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-09T07:24:30.990

试试这个：

```
SELECT mid
FROM your_table
WHERE uid in ('favour','crackhead','charisma')
GROUP BY mid
HAVING COUNT(DISTINCT uid) = 3 
```

# jquery - 带有 Touch Punch 的 jQuery UI 滑块：手柄锁定

> ID：13593242
> 
> 赞同：1
> 
> 时间：2012-11-27T21:18:04.113
> 
> 标签：jquery, jquery-ui, jquery-ui-touch-punch

我正在使用带有 Touch Punch (http://touchpunch.furf.com) 的 jQuery UI 滑块，因此它适用于触摸移动设备。滑块位于位置：固定到顶部的标题中。标题下方的内容不固定，并在您向上滚动时滚动到标题下方。它在桌面上运行良好，但是当我在 iPhone 上对其进行测试时，一旦开始向上滚动，滑块手柄就无法拖动。

我认为它正在执行滚动事件而不是句柄的单击/触摸事件。

```
<div id="top">
  <div id="slider"></div>
</div>

<div class="pics">CONTENT</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="js/jquery-ui-1.9.1.custom.min.js"></script>
<script src="js/jquery.ui.touch-punch.min.js"></script>
<script type="text/javascript">    
$('document').ready(function() {

$(function() {
    $( "#slider" ).slider({
        value:250,
        min: 50,
        max: 1000,
        range: "min",
        step: 50,
        slide: function( event, ui ) {
        $( "#amount" ).html( ui.value );
        }
    });
});
});
</script>

//css//

#top {
width: 100%;
position: fixed;
top:0; }

.pics {
margin: 0 auto;
width: 100%;
max-width: 1280px;
padding-top: 86px;} 
```

环顾四周后，我尝试添加它以禁用在#top div上的滚动：

```
$("#top").bind("touchstart", function(e) { e.preventDefault(); }); 
```

但我认为这不起作用，因为它仍在使用下面的类 .pics 获取 div？

感谢您提供的任何帮助并道歉，如果我没有意义或遗漏了明显的东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T21:14:49.750

好的，我想我已经找到了解决办法。可能不是最有效的方法，到目前为止我只能在 iPhone 和 iPad 上检查它。

```
var divTop = $("#top").height();

$(document).bind("touchmove", function(e) { 
if (e.originalEvent.touches[0].clientY < divTop) {
    e.preventDefault();     
}
}); 
```

因此，如果在 div #top 覆盖的同一区域中触发了 touchmove 事件，则会阻止默认操作（即滚动），但滑块句柄可以工作。

# delphi - 最长算术和几何级数序列误差

> ID：13593245
> 
> 赞同：3
> 
> 时间：2012-11-27T21:18:10.103
> 
> 标签：delphi, delphi-7

我需要输入整数序列并找到最长的算术和几何级数序列。我写了这段代码（我必须使用 Delphi 7）

```
program arithmeticAndGeometricProgression;
{ 203\. In specifeied sequence of integer numbers find the longest sequence, which is
  arithmetic or geometric progression. }

{$APPTYPE CONSOLE}

uses
  SysUtils;

var
  sequence, longArithmSequ, longGeomSequ: Array of Integer;
  curArithmSequ, curGeomSequ: Array of Integer; // Current progress
  q, q1: Double;
  d1, d: Double;
  i, k: Integer;

begin
  i := 0;
  d := 0;
  k := 0;
  d1 := 0;

  Repeat
    SetLength(sequence, i + 1);
    // Make room for another item in the array
    try
      read(sequence[i]);
    except // If the input character is not an integer interrupt cycle
      Break;
    end;
    inc(i);
  Until False;

  k := 0;
  curArithmSequ := NIL;
  curGeomSequ := NIL;
  longArithmSequ := NIL;
  longGeomSequ := NIL;
  d1 := sequence[1] - sequence[0];
  q1 := sequence[1] / sequence[0];

  i := 1;

  repeat
    d := d1;
    q := q1;
    d1 := sequence[i] - sequence[i - 1];
    q1 := sequence[i] / sequence[i - 1];

    if d = d1 then
    begin
      SetLength(curArithmSequ, Length(curArithmSequ) + 1);
      curArithmSequ[Length(curArithmSequ) - 1] := sequence[i];
    end;

    if q = q1 then
    begin
      SetLength(curGeomSequ, Length(curGeomSequ) + 1);
      curGeomSequ[Length(curGeomSequ) - 1] := sequence[i];
    end;

    if Length(curArithmSequ) > Length(longArithmSequ) then
    begin
      longArithmSequ := NIL;
      SetLength(longArithmSequ, Length(curArithmSequ));
      for k := 0 to Length(curArithmSequ) - 1 do
        longArithmSequ[k] := curArithmSequ[k];
    end;

    if Length(curGeomSequ) > Length(longGeomSequ) then
    begin
      longGeomSequ := NIL;
      SetLength(longGeomSequ, Length(curGeomSequ));
      for k := 0 to Length(curGeomSequ) - 1 do
        longGeomSequ[k] := curGeomSequ[k];
    end;

    if d <> d1 then
      curArithmSequ := NIL;
    if q <> q1 then
      curGeomSequ := NIL;

    inc(i);
  Until i >= Length(sequence) - 1;

  writeLn('The Longest Arithmetic Progression');

  for k := 0 to Length(longArithmSequ) - 1 do
    Write(longArithmSequ[k], ' ');

  writeLn('The Longest Geometric Progression');
  for k := 0 to Length(longGeomSequ) - 1 do
    Write(longGeomSequ[k], ' ');
  Readln(k);

end. 
```

我有这样的问题：

1.  为什么它不能打印算术级数的前 1-2 个成员
2.  为什么它总是将“2”打印为几何级数
3.  我的程序中有猴子风格的代码吗？

请告诉我我的错误在哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:44:08.473

更新：

您需要以这种方式更改重复循环内的逻辑：

```
if d = d1 then
begin
  if (Length(curArithmSequ) = 0) then
  begin
    if (i > 1) then
      SetLength(curArithmSequ,3)
    else
      SetLength(curArithmSequ,2);
  end
  else
    SetLength(curArithmSequ,Length(curArithmSequ)+1);
  for k := 0 to Length(curArithmSequ) - 1 do
    curArithmSequ[k] := sequence[i - (Length(curArithmSequ) - k - 1)];
end
else
  SetLength(curArithmSequ,0);

if q = q1 then
begin
  if (Length(curGeomSequ) = 0) then
  begin
    if (i > 1) then
      SetLength(curGeomSequ,3)
    else
      SetLength(curGeomSequ,2);
  end
  else
    SetLength(curGeomSequ,Length(curGeomSequ)+1);
  for k := 0 to Length(curGeomSequ) - 1 do
    curGeomSequ[k] := sequence[i - (Length(curGeomSequ) - k - 1)];
end
else
  SetLength(curGeomSequ,0); 
```

输入序列：

```
2,6,18,54 gives LAP=2,6 and LGP=2,6,18,54 
```

而输入序列：

```
1,3,5,7,9 gives: LAP=1,3,5,7,9 and LGP=1,3 
```

以及一系列

```
5,4,78,2,3,4,5,6,18,54,16 gives LAP=2,3,4,5,6 and LGP=6,18,54 
```

这是我的完整测试（见下面的评论）：

```
program arithmeticAndGeometricProgression;
{ 203\. In specified sequence of integer numbers find the longest sequence, which is
  arithmetic or geometric progression. }

{$APPTYPE CONSOLE}

uses
  SysUtils;

Type
  TIntArr = array of integer;
  TValidationProc = function( const sequence : array of integer) : Boolean;

function IsValidArithmeticSequence( const sequence : array of integer) : Boolean;
begin
  Result :=
    (Length(sequence) = 2) // Always true for a sequence of 2 values
    or
    // An arithmetic sequence is defined by: a,a+n,a+2*n, ...
    // This gives: a+n - a = a+2*n - (a+n)
    // s[1] - s[0] = s[2] - s[1] <=> 2*s[1] = s[2] + s[0]
    (2*sequence[1] = (Sequence[2] + sequence[0]));
end;

function IsValidGeometricSequence( const sequence : array of integer) : Boolean;
var
  i,zeroCnt : Integer;
begin
  // If a zero exists in a sequence all members must be zero
  zeroCnt := 0;
  for i := 0 to High(sequence) do
    if (sequence[i] = 0) then
      Inc(zeroCnt);
  if (Length(sequence) = 2) then
    Result := (zeroCnt in [0,2])
  else
    // A geometric sequence is defined by: a*r^0,a*r^1,a*r^2 + ... ; r <> 0
    // By comparing sequence[i]*sequence[i-2] with Sqr(sequence[i-1])
    // i.e. a*(a*r^2) with Sqr(a*r) we can establish a valid geometric sequence
    Result := (zeroCnt in [0,3]) and (Sqr(sequence[1]) = sequence[0]*Sequence[2]);            
end;

procedure AddSequence( var arr : TIntArr; sequence : array of Integer);
var
  i,len : Integer;
begin
  len := Length(arr);
  SetLength(arr,len + Length(sequence));
  for i := 0 to High(sequence) do
    arr[len+i] := sequence[i];
end;

function GetLongestSequence( IsValidSequence : TValidationProc;
  const inputArr : array of integer) : TIntArr;
var
  i : Integer;
  currentSequence : TIntArr;
begin
  SetLength(Result,0);
  SetLength(currentSequence,0);
  if (Length(inputArr) <= 1)
    then Exit;
  for i := 1 to Length(inputArr)-1 do begin
    if (Length(Result) = 0) then // no valid sequence found so far
    begin
      if IsValidSequence([inputArr[i-1],inputArr[i]])
        then AddSequence(currentSequence,[inputArr[i-1],inputArr[i]]);
    end
    else
    begin
      if IsValidSequence([inputArr[i-2],inputArr[i-1],inputArr[i]]) then
      begin
        if (Length(currentSequence) = 0) then
          AddSequence(currentSequence,[inputArr[i-2],inputArr[i-1],inputArr[i]])
        else
          AddSequence(currentSequence,inputArr[i]);
      end
      else // Reset currentSequence
        SetLength(currentSequence,0);
    end;
    // Longer sequence ?
    if (Length(currentSequence) > Length(Result)) then
    begin
      SetLength(Result,0);
      AddSequence(Result,currentSequence);
    end;
  end;
end;

procedure OutputSequence( const arr : TIntArr);
var
  i : Integer;
begin
  for i := 0 to High(arr) do begin
    if i <> High(arr)
      then Write(arr[i],',')
      else WriteLn(arr[i]);
  end;
end;

begin
  WriteLn('Longest Arithmetic Sequence:');
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[0,1,2,3,4,5,6]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[1,0,1,2,3,4,5,6]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[0,0,0,0,0,0]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[0,0,1,2,4,8,16]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[0,0,6,9,12,4,8,16]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[9,12,16]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[1,0,1,-1,-3]));
  OutputSequence(GetLongestSequence(IsValidArithmeticSequence,[5,4,78,2,3,4,5,6,18,54,16]));

  WriteLn('Longest Geometric Sequence:');
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[0,1,2,3,4,5,6]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[1,0,1,2,3,4,5,6]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[0,0,0,0,0,0]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[0,0,1,2,4,8,16]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[0,0,6,9,12,4,8,16]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[9,12,16]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[1,0,9,-12,16]));
  OutputSequence(GetLongestSequence(IsValidGeometricSequence,[5,4,78,2,3,4,5,6,18,54,16]));
  ReadLn;
end. 
```

正如 David 所评论的，将浮点计算与整数混合会导致不需要的行为。例如。几何因子为 4/3 的输入序列 9,12,16 将在这里工作，但其他类似的非整数几何因子可能会失败。需要更广泛的测试来验证这一点。

* * *

为了消除浮点运算的依赖性，可以对循环进行以下更改：

```
// A geometric function is defined by a + n*a + n^2*a + ...
// By comparing sequence[i]*sequence[i-2] with Sqr(sequence[i-1])
// i.e. n^2*a*a with Sqr(n*a) we can establish a valid geometric sequence
q := Sqr(sequence[i-1]);
if (i < 2)
  then q1 := q // Special case, always true
  else q1 := sequence[i] * sequence[i - 2]; 
```

将 d,d1,q,q1 的声明更改为`Integer`并删除循环前 q1 的赋值。

更新测试代码以反映这些更改。

* * *

当一个序列有一个或多个用于几何序列计算的零时，就会出现问题。如果所有值都为零，则仅将零视为几何序列的成员。

> 几何序列：a*r^0、a*r^1、a*r^2等；r <> 0。当 a = 0 时，级数仅由零组成。这也意味着一个有效的几何序列不能同时保存非零和零值。

为了用当前的结构纠正这一点，它变得一团糟。所以我用一个更好的结构化程序来更新我上面的测试，这个程序可以处理所有的输入序列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T10:52:12.737

这是一个相当有趣的问题。LU RD 为您提供了修复代码的答案。作为替代方案，我提供了解决问题的方法：

```
program LongestSubsequence;

{$APPTYPE CONSOLE}

type
  TSubsequence = record
    Start: Integer;
    Length: Integer;
  end;

function Subsequence(Start, Length: Integer): TSubsequence;
begin
  Result.Start := Start;
  Result.Length := Length;
end;

type
  TTestSubsequenceRule = function(a, b, c: Integer): Boolean;

function FindLongestSubsequence(
  const seq: array of Integer;
  const TestSubsequenceRule: TTestSubsequenceRule
): TSubsequence;
var
  StartIndex, Index: Integer;
  CurrentSubsequence, LongestSubsequence: TSubsequence;
begin
  LongestSubsequence := Subsequence(-1, 0);
  for StartIndex := low(seq) to high(seq) do
  begin
    CurrentSubsequence := Subsequence(StartIndex, 0);
    for Index := CurrentSubsequence.Start to high(seq) do
    begin
      if (CurrentSubsequence.Length<2)
      or TestSubsequenceRule(seq[Index-2], seq[Index-1], seq[Index]) then
      begin
        inc(CurrentSubsequence.Length);
        if CurrentSubsequence.Length>LongestSubsequence.Length then
          LongestSubsequence := CurrentSubsequence;
      end
      else
        break;
    end;
  end;

  Result := LongestSubsequence;
end;

function TestArithmeticSubsequence(a, b, c: Integer): Boolean;
begin
  Result := (b-a)=(c-b);
end;

function FindLongestArithmeticSubsequence(const seq: array of Integer): TSubsequence;
begin
  Result := FindLongestSubsequence(seq, TestArithmeticSubsequence);
end;

function TestGeometricSubsequence(a, b, c: Integer): Boolean;
begin
  Result := (b*b)=(a*c);
end;

function FindLongestGeometricSubsequence(const seq: array of Integer): TSubsequence;
begin
  Result := FindLongestSubsequence(seq, TestGeometricSubsequence);
end;

procedure OutputSubsequence(const seq: array of Integer; const Subsequence: TSubsequence);
var
  Index: Integer;
begin
  for Index := 0 to Subsequence.Length-1 do
  begin
    Write(seq[Subsequence.Start + Index]);
    if Index<Subsequence.Length-1 then
      Write(',');
  end;
  Writeln;
end;

procedure OutputLongestArithmeticSubsequence(const seq: array of Integer);
begin
  OutputSubsequence(seq, FindLongestArithmeticSubsequence(seq));
end;

procedure OutputLongestGeometricSubsequence(const seq: array of Integer);
begin
  OutputSubsequence(seq, FindLongestGeometricSubsequence(seq));
end;

begin
  Writeln('Testing arithmetic sequences:');
  OutputLongestArithmeticSubsequence([]);
  OutputLongestArithmeticSubsequence([1]);
  OutputLongestArithmeticSubsequence([1,2]);
  OutputLongestArithmeticSubsequence([1,2,3]);
  OutputLongestArithmeticSubsequence([1,2,4]);
  OutputLongestArithmeticSubsequence([6,1,2,4,7]);
  OutputLongestArithmeticSubsequence([6,1,2,4,6,7]);

  Writeln('Testing geometric sequences:');
  OutputLongestGeometricSubsequence([]);
  OutputLongestGeometricSubsequence([1]);
  OutputLongestGeometricSubsequence([1,2]);
  OutputLongestGeometricSubsequence([1,2,4]);
  OutputLongestGeometricSubsequence([7,1,2,4,-12]);
  OutputLongestGeometricSubsequence([-16,-12,-9]);
  OutputLongestGeometricSubsequence([4,-16,-12,-9]);

  Readln;
end. 
```

需要强调的关键点是你的代码很难理解，因为所有不同的方面都相互混合。我在这里尝试将算法分解为可以单独理解的较小部分。

# ruby-on-rails - 在 Rails Observer 中使用线程

> ID：13593246
> 
> 赞同：0
> 
> 时间：2012-11-27T21:18:21.743
> 
> 标签：ruby-on-rails, multithreading, thread-safety, observer-pattern

据我所知，Ruby on Rails 中的观察者模式并不是异步的，这意味着观察者的执行将阻止正在处理的动作。

我知道delayed_job gem，我真的很喜欢它，但有时对于某些用途来说它看起来有点太重了。

在 Observer 的回调中启动一个新线程怎么样？

我花了一些时间试图找出这种方法的利弊，但失败了。

那么问题来了：Observer 的线程有什么严重的缺陷吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:29:52.810

你听说过[sidekiq](https://github.com/mperham/sidekiq)吗？这是进行后台处理的新“热门”宝石（相对于 resque 或延迟作业）。

从[常见问题解答](https://github.com/mperham/sidekiq/wiki/FAQ)：

> sidekiq使用redis进行存储，多线程处理消息。它与 resque 一样容易设置，但在原始处理速度方面更有效。您的工作代码确实需要是线程安全的。

这里还有一个关于它的[railscast](http://railscasts.com/episodes/366-sidekiq)。

与创建自己的线程相比，我建议使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-10T19:31:00.493

DelayedJob 和 Sidekiq 都提供了不错的选择，Rails 现在提供完整的 ActiveJob 支持，这里是官方文档 - [https://guides.rubyonrails.org/v4.2/active_job_basics.html](https://guides.rubyonrails.org/v4.2/active_job_basics.html)

DelayedJob 我*认为*是最长的，由构建 Shopify.com 的工作人员创建。它会在您的 Rails 应用程序和队列中创建一个表并以此为基础。对我来说，它提供了最简单的选项，因为它除了你的 rails 应用程序之外没有其他依赖项。

Sidekiq 也提供了一个很好的选择。它也非常简单且维护良好，但它不使用您的数据库，而是使用 redis 服务器来管理作业。这使得开发有点棘手，因为您必须安装 redis 并记住在运行应用程序时启动它。不难，只是有点额外的东西。

这是比较两者的快速指南 - [DelayedJob 与 Sidekiq](https://www.sqlbot.co/blog/delayed-job-vs-sidekiq-which-one-should-you-choose)，希望对您有所帮助。

# algorithm - 使用 HMM 前向算法处理下溢

> ID：13593249
> 
> 赞同：4
> 
> 时间：2012-11-27T21:18:38.670
> 
> 标签：algorithm, probability, forward, hidden-markov-models, underflow

我正在尝试为隐马尔可夫模型（HMM）实现前向算法，并且在填充 alpha 表时遇到了下溢问题。[我使用此处](http://digital.cs.usu.edu/~cyan/CS7960/hmm-tutorial.pdf)第 6 节中描述的方法对 alpha 值进行了归一化，但现在最终 alpha 值（观察序列的概率）的总和始终等于 1。如何“撤消”归一化以获得实际概率？[我的实现与此处](http://www.cs.sjsu.edu/~stamp/RUA/HMM.pdf)的第 7.2 节非常相似。

最近对这个问题有一个[答案](https://stackoverflow.com/questions/13391625/underflow-in-forward-algorithm-for-hmms)，但我无法理解最后几个步骤，希望得到更详细的解释。谢谢！

更新：我想我终于理解了最近的答案，但希望能确认我的理解是正确的。这是我所做的（c[k] 是系数）：

```
 double sum = 0.0;
    for (i = 0; i < 4; i ++) { // only 4 hidden states
        sum += alpha[l-1][i]; // sum last column of alpha table (normalized)
    }

    double sumLogC = 0.0;
    for (k = 0; k < l; k++) {
        sumLogC += Math.log(c[k]);
    }

    probability = Math.log(sum) - sumLogC;

    return probability; 
```

# mysql - MySQL 解释 - 需要索引建议/反馈

> ID：13593256
> 
> 赞同：3
> 
> 时间：2012-11-27T21:18:57.820
> 
> 标签：mysql, sql, innodb, indexing, vtiger

我有一个包含大约 500 万行的数据库，并且在查询需要很长时间（超过一分钟）时遇到问题。我希望这些信息足以让有人给我一些建议，如果我需要发布更多信息，请告诉我。

提前感谢您的任何建议

```
EXPLAIN SELECT count( * ) AS count
FROM vtiger_time
INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = vtiger_time.timeid
INNER JOIN vtiger_crmentityrel ON ( vtiger_crmentityrel.relcrmid = vtiger_crmentity.crmid
OR vtiger_crmentityrel.crmid = vtiger_crmentity.crmid )
LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid
LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid
WHERE vtiger_crmentity.deleted =0
AND (
    vtiger_crmentityrel.crmid =211294
    OR vtiger_crmentityrel.relcrmid =211294
)

+----+-------------+---------------------+-------------+-------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+
| id | select_type | table               | type        | possible_keys                                   | key            | key_len | ref                            | rows  | Extra                                    |
+----+-------------+---------------------+-------------+-------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+
|  1 | SIMPLE      | vtiger_crmentityrel | index_merge | crmid,relcrmid                                  | crmid,relcrmid | 4,4     | NULL                           |  5881 | Using union(crmid,relcrmid); Using where | 
|  1 | SIMPLE      | vtiger_crmentity    | ref         | PRIMARY,deleted,deleted_2,crmentity_multi_index | deleted_2      | 4       | const                          | 84424 | Using where; Using index                 | 
|  1 | SIMPLE      | vtiger_users        | eq_ref      | PRIMARY                                         | PRIMARY        | 4       | crm.vtiger_crmentity.smownerid |     1 | Using index                              | 
|  1 | SIMPLE      | vtiger_groups       | eq_ref      | PRIMARY                                         | PRIMARY        | 4       | crm.vtiger_crmentity.smownerid |     1 | Using index                              | 
|  1 | SIMPLE      | vtiger_time      | eq_ref      | PRIMARY,timeid                               | PRIMARY        | 4       | crm.vtiger_crmentity.crmid     |     1 | Using index                              | 
+----+-------------+---------------------+-------------+-------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+ 
```

此外，这些是我当前设置的索引

```
+------------------+------------+----------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table            | Non_unique | Key_name                   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+------------------+------------+----------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_crmentity |          0 | PRIMARY                    |            1 | crmid       | A         |      755968 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          0 | crmid                      |            1 | crmid       | A         |      755968 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_IDX0             |            1 | smcreatorid | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_IDX1             |            1 | smownerid   | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_IDX2             |            1 | modifiedby  | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | deleted                    |            1 | deleted     | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | deleted                    |            2 | smownerid   | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | smownerid                  |            1 | smownerid   | A         |         199 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | smownerid                  |            2 | deleted     | A         |         199 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | deleted_2                  |            1 | deleted     | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | deleted_2                  |            2 | smownerid   | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | smownerid_2                |            1 | smownerid   | A         |         385 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | smownerid_2                |            2 | deleted     | A         |         758 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crm_ownerid_del_setype_idx |            1 | smownerid   | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crm_ownerid_del_setype_idx |            2 | deleted     | A         |          15 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crm_ownerid_del_setype_idx |            3 | setype      | A         |         613 |     NULL | NULL   | YES  | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_multi_index      |            1 | crmid       | A         |      755968 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_multi_index      |            2 | smownerid   | A         |      755968 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentity |          1 | crmentity_multi_index      |            3 | deleted     | A         |      755968 |     NULL | NULL   |      | BTREE      |         | 
+------------------+------------+----------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table               | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_crmentityrel |          1 | crmid    |            1 | crmid       | A         |      223960 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_crmentityrel |          1 | relcrmid |            1 | relcrmid    | A         |       12442 |     NULL | NULL   |      | BTREE      |         | 
+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

+--------------+------------+---------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+
| Table        | Non_unique | Key_name      | Seq_in_index | Column_name   | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+--------------+------------+---------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_users |          0 | PRIMARY       |            1 | id            | A         |          39 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_users |          1 | idx_user_name |            1 | user_name     | A         |          39 |     NULL | NULL   | YES  | BTREE      |         | 
| vtiger_users |          1 | user_password |            1 | user_password | A         |          39 |     NULL | NULL   | YES  | BTREE      |         | 
+--------------+------------+---------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+

+---------------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table         | Non_unique | Key_name            | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+---------------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_groups |          0 | PRIMARY             |            1 | groupid     | A         |           5 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_groups |          1 | groupname           |            1 | groupname   | A         |           5 |     NULL | NULL   | YES  | BTREE      |         | 
| vtiger_groups |          1 | idx_groups_123group |            1 | groupname   | A         |           5 |     NULL | NULL   | YES  | BTREE      |         | 
+---------------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

+----------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table          | Non_unique | Key_name    | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+----------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_time |          0 | PRIMARY     |            1 | timeid   | A         |      591772 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_time |          0 | timeid   |            1 | timeid   | A         |      591772 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_time |          1 | relatedto   |            1 | relatedto   | A         |        1405 |     NULL | NULL   | YES  | BTREE      |         | 
| vtiger_time |          1 | date_start  |            1 | date_start  | A         |        7129 |     NULL | NULL   | YES  | BTREE      |         | 
| vtiger_time |          1 | relatedto_2 |            1 | relatedto   | A         |        3269 |     NULL | NULL   | YES  | BTREE      |         | 
+----------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

+------------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table            | Non_unique | Key_name    | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+------------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| vtiger_timecf |          0 | PRIMARY     |            1 | timeid   | A         |      591324 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_timecf |          0 | timeid   |            1 | timeid   | A         |      591324 |     NULL | NULL   |      | BTREE      |         | 
| vtiger_timecf |          1 | timeid_2 |            1 | timeid   | A         |      591324 |     NULL | NULL   |      | BTREE      |         | 
+------------------+------------+-------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+ 
```

添加以下索引后

```
ALTER TABLE vtiger_crmentity ADD INDEX TMP_deletion_smownerid_crmid (smownerid, deleted,crmid); 
```

新解释：

```
+----+-------------+---------------------+-------------+--------------------------------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+
| id | select_type | table               | type        | possible_keys                                                            | key            | key_len | ref                            | rows  | Extra                                    |
+----+-------------+---------------------+-------------+--------------------------------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+
|  1 | SIMPLE      | vtiger_crmentityrel | index_merge | crmid,relcrmid                                                           | crmid,relcrmid | 4,4     | NULL                           |  5891 | Using union(crmid,relcrmid); Using where | 
|  1 | SIMPLE      | vtiger_crmentity    | ref         | PRIMARY,crmid,deleted,deleted_2,crmentity_multi_index,_deletion_crmid | deleted        | 4       | const                          | 84424 | Using where; Using index                 | 
|  1 | SIMPLE      | vtiger_users        | eq_ref      | PRIMARY                                                                  | PRIMARY        | 4       | crm.vtiger_crmentity.smownerid |     1 | Using index                              | 
|  1 | SIMPLE      | vtiger_groups       | eq_ref      | PRIMARY                                                                  | PRIMARY        | 4       | crm.vtiger_crmentity.smownerid |     1 | Using index                              | 
|  1 | SIMPLE      | vtiger_time      | eq_ref      | PRIMARY,timeid                                                        | PRIMARY        | 4       | crm.vtiger_crmentity.crmid     |     1 | Using index                              | 
+----+-------------+---------------------+-------------+--------------------------------------------------------------------------+----------------+---------+--------------------------------+-------+------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:35:41.653

重写查询会有所帮助，但由于您不能这样做，您可能会从 and 上的复合索引中`vtiger_crmentity.crmid`受益`vtiger_crmentity.deleted`。但由于它没有使用您当前拥有的索引之一`vtiger_crmentity.crmid`，它可能不会使用新的索引。如果没有，请尝试添加`vtiger_crmentity.crmid`到`vtiger_crmentity.deleted`索引中。由于它已经在使用索引`vtiger_crmentity.deleted`，这将使索引成为覆盖索引，因此查询不需要从表中读取。

正如我在评论中提到的，有很多重复的索引。不会影响对这个问题的查询，但它们会减慢插入速度并增加表大小。以下索引是多余的：

```
vtiger_crmentity.crmid
vtiger_crmentity.smownerid
vtiger_crmentity.smownerid_2
vtiger_crmentity.deleted_2

vtiger_groups.idx_groups_123group

vtiger_time.timeid
vtiger_time.relatedto_2

vtiger_timecf.timeid
vtiger_timcfe.timeid_2 
```

您也不应该需要用户密码列上的索引，因为您不应该通过密码查找用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T02:09:57.027

尝试添加此索引：

```
ALTER TABLE vtiger_crmentityrel ADD INDEX ix_crmentityrel_crmid_relcrmid (crmid,relcrmid); 
```

这应该允许 crmentityrel 表上的两个索引完全满足说明中的第一行，并且应该为您节省数千次查找。

执行计划的所有其他部分都在使用覆盖索引，所以如果这没有帮助，我不确定在不重组数据或查询的情况下你可以做更多的事情。

# powershell - -eq 和 -ne 给我相同的结果

> ID：13593264
> 
> 赞同：0
> 
> 时间：2012-11-27T21:19:40.127
> 
> 标签：powershell, active-directory, powershell-2.0, domaincontroller

为什么以下两个命令，唯一的区别是 -eq 和 -ne 运算符给我我的 DC 列表？

```
Get-ADComputer -Filter {(operatingsystem -like "*server*") -AND 
(PrimaryGroup -eq "CN=Domain Controllers,CN=Users,DC=domain,DC=com") } 
-Property Name,PrimaryGroup 
```

我希望这个拥有一切，但域控制器。

```
Get-ADComputer -Filter {(operatingsystem -like "*server*") -AND 
(PrimaryGroup -ne "CN=Domain Controllers,CN=Users,DC=domain,DC=com") } 
-Property Name,PrimaryGroup 
```

如果我对 PrimaryGroupID 而不是 PrimaryGroup 运行等效项，它会按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:15:26.703

I actually get an error when trying both commands. Did a little digging and the filter was causing the problem. Had a quick look in ADSIEdit at a server object. It doesn't appear to have a attribute called "PrimaryGroup".

This was in a 2008 R2 AD running in 2008 R2 forest and domain functional levels.

As an aside, if you want a list of DC in a domain get-ADDomainController will do the job.

regards Arcass

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-29T18:16:59.050

如果要将一个语句放在不同的行上，则需要将反引号 (`) 放在行尾，以告诉 PowerShell 该语句在下一行继续。但是，即使那样，您也不能在两条不同的行上拆分过滤器。所以它应该看起来像这样：

```
Get-ADComputer -Filter {(operatingsystem -like "*server*") -AND (PrimaryGroup -eq "CN=Domain Controllers,CN=Users,DC=example,DC=com") } `
    -Property Name,PrimaryGroup 
```

正如您所发现的，AD 实际上并没有一个名为`PrimaryGroup`. 这是 PowerShell 向您公开的属性，它为您解释属性中的值`primaryGroupId`。

任何对象的[`primaryGroupId`](https://docs.microsoft.com/en-us/windows/win32/adschema/a-primarygroupid)属性都具有组的相对标识符 (RID)。RID 是 SID 中数字的最后一部分，但组也在其[`primaryGroupToken`](https://docs.microsoft.com/en-us/windows/win32/adschema/a-primarygrouptoken)属性中存储此值。所以你可以像这样得到这个值：

```
$primaryGroupToken = (Get-ADGroup "Domain Controllers" -Properties primaryGroupToken).primaryGroupToken 
```

PowerShell 必须将您传递给`-Filter`参数的内容转换为正确的 LDAP 查询，因此当您`PrimaryGroup`在过滤器中使用时，PowerShell 会为您执行此操作。

但是，在这种情况下，执行该查找并不是必需的，因为[Domain Controllers 组](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-domaincontrollers)是一个内置组，并且始终具有`516`. 所以你可以像这样做你想做的事情：

```
Get-ADComputer -Filter "operatingsystem -like '*server*' -AND PrimaryGroupId -eq 516" `
    -Property Name,PrimaryGroup 
```

# python - 快速使用在家中创建一个配置文件夹

> ID：13593267
> 
> 赞同：0
> 
> 时间：2012-11-27T21:19:54.807
> 
> 标签：python, canonical-quickly

我需要制作一个 ~/folder/configFile 来与我的应用程序一起使用。当“快速”创建 deb 包时，应使用此文件创建此文件夹。有人可以教我做吗？顺便说一句，还可以告诉我应该将我的腋窝文件“.py”放在项目文件夹中的哪个位置（如类和东西）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:48:17.700

请参阅[文档](http://docs.python.org/2/library/os.path.html?highlight=homepath)中的主路径。您可以将您的腋窝文件放在与您的应用程序相同的文件夹或子目录中，并使它们成为[packages](http://docs.python.org/2/distutils/setupscript.html#distutils-installing-package-data)的一部分。

# javascript - 当 keydown 打开警报时，Keyup 未触发

> ID：13593270
> 
> 赞同：7
> 
> 时间：2012-11-27T21:20:05.207
> 
> 标签：javascript, onkeydown, onkeyup

我有两个事件处理程序，一个用于 keydown，一个用于 keyup。keydown 事件处理程序触发警报消息，但这会阻止 keyup 事件触发。

您可以在这里看到一个非常简单的示例：http: [//jsfiddle.net/boblauer/jaGwT/](http://jsfiddle.net/boblauer/jaGwT/) 当 keydown 打开警报时，不会触发 keyup，但是当未打开警报时，会触发 keyup。这是来自 jsfiddle 的代码：

```
var i = 0;
window.addEventListener('keydown', function(e) {
    if (i++ % 2) alert('down');
    console.log('down');
});

window.addEventListener('keyup', function(e) {
    alert('up');
    console.log('up');
}); 
```

我有一个库，支持监听多个组合键（例如'd + f'），所以当一个键被按下时，我需要将它添加到当前按下的键列表中，当一个键被释放时，我需要将其从所述列表中删除。我遇到的问题是，如果我想在同时按下 d + f 时显示警报，我从“当前按下”列表中删除这些键的代码永远不会触发，因为我的 keyup 处理程序永远不会被调用.

我想不出解决这个问题的好方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:23:13.400

警报可防止事件发生。您可以做的是手动触发此功能，因为它无论如何都会发生。

```
var keyupfunction = function(e){
    alert('up');
    console.log('up');
}

window.addEventListener('keyup', keyupfunction);

window.addEventListener('keydown', function(e) {
    if (i++ % 2) alert('down');
    console.log('down');
    keyupfunction(e);
}); 
```

但实际上，您不应该使用警报。它可以防止这些事件，但谁知道它还会破坏什么。改用自定义的东西。

# html - Web site does not allow zooming out or scrolling on iOS

> ID：13593271
> 
> 赞同：1
> 
> 时间：2012-11-27T21:20:05.673
> 
> 标签：html, safari, ios6, mobile-safari, viewport

Part of our web site has a mobile version, but for the Blogs section (all our PHP content) we decided to just offer mobile users the desktop site (for now).

This works fine on iPad, but on iPhone (iPhone 4S/iOS6 tested) the page loads zoomed into the top left corner and you can't zoom out or even scroll sideways to the content that's cut off.

I have tried playing with the meta viewport tags, but no combination of parameters seems to fix this. I have tried `<meta name="viewport" content="width=device-width, target-densitydpi=device-dpi, initial-scale=.75, user-scalable=yes" />`

Please view this URL on an iPhone : [http://www.finecooking.com/blogs](http://www.finecooking.com/blogs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T03:10:56.437

Try searching on your css if you set an specific height or an `overflow: hidden` to the body or html or maybe a wrapper.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-01T14:28:55.073

First of all thank you Craig for the [answer](//stackoverflow.com/questions/13593271/web-site-does-not-allow-zooming-out-or-scrolling-on-ios/23980880#answer-17204675), as it turns out you can have `overflow:hidden` on `body`, but not on `html`.

In my case this broke also the scroll in an embedded `iframe`, which is weird, but the css down below fixed it.

## Scroll won't work:

```
html, body {
    /*common stuff */
    overflow: hidden;
} 
```

## Scroll will work:

```
html, body {
    /* common stuff */
}
body {
    overflow: hidden;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T21:22:59.247

This works for me in iPad, and iPhone:

```
 <meta name="viewport" content="width=device-width;initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" /> 
```

# perl - 使用草莓 perl 安装 PAR::Packer 时出现问题

> ID：13593275
> 
> 赞同：1
> 
> 时间：2012-11-27T21:20:26.363
> 
> 标签：perl, strawberry-perl, par, packer

我现在正在努力安装 PAR::Packer 模块两天。我是 CPAN 的新手，这是我要安装的第一个模块，所以我首先认为是我。但我现在重新安装了几次草莓 Perl，并且还使用了旧版本。安装总是失败：

windres：意外版本字符串长度 68 ！= 32 + 8

我在这个字符串上发现了一些命中，这似乎是 MingW 的一个问题（不管这是什么）：

[http://mingw.5.n7.nabble.com/Wine-crosstest-build-fails-with-quot-unexpected-version-string-length-68-32-8-quot-td29953.html#a29975](http://mingw.5.n7.nabble.com/Wine-crosstest-build-fails-with-quot-unexpected-version-string-length-68-32-8-quot-td29953.html#a29975)

但我不知道如何获得这个补丁以及如何安装它。

任何人都可以帮忙吗？

问候齐格弗里德

安装孔捕获下方：

在这里输入代码 ：

块引用

> C:\Documents and Settings\shepp>cpan PAR::Packer CPAN: CPAN::SQLite 加载正常 (v0.202) 数据库于 2012 年 11 月 27 日星期二 20:58:53 GMT 生成 运行安装模块 'PAR:: Packer' Running make for R/RS/RSCHUPP/PAR-Packer-1.013.tar.gz CPAN: LWP::UserAgent 加载正常 (v6.04) CPAN: Time::HiRes 加载正常 (v1.9725) 使用 LWP 获取： [http://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/PAR-Packer-1.013.tar.gz](http://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/PAR-Packer-1.013.tar.gz) CPAN: YAML::XS 加载正常 (v0.38) CPAN: Digest::SHA 加载正常(v5.72) 使用 LWP 获取： [http ://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/CHECKSUMS](http://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/CHECKSUMS)CPAN: Compress::Zlib 加载正常 (v2.055) C:\strawberry\cpan\sources\authors\id\R\RS\RSCHUPP\PAR-Packer-1.013 .tar.gz 的校验和 ok CPAN: Archive::Tar加载正常 (v1.90) CPAN: File::Temp 加载正常 (v0.22) CPAN: Parse::CPAN::Meta 加载正常 (v1.4404) CPAN: CPAN::Meta 加载正常 (v2.120921) CPAN : Module::CoreList 加载正常 (v2.74)
> 
> CPAN.pm：构建 R/RS/RSHUPP/PAR-Packer-1.013.tar.gz
> 
> 检查您的工具包是否完整...看起来不错警告：未找到先决条件 Getopt::ArgvFile 1.07。警告：未找到必备模块::ScanDeps 1.05。原型不匹配：sub main::prompt: none vs ($;$) at C:/strawberry/perl/lib/Ex tUtils/MakeMaker.pm 第 219 行。为 par.exe 编写 Makefile 编写 MYMETA.yml 和 MYMETA.json 编写Makefile for PAR::Packer Writing MYMETA.yml 和 MYMETA.json ---- 在 ---- ---- RSCHUPP/PAR-Packer-1.013.tar.gz ---- Getopt::ArgvFile [需要] Module::ScanDeps [需要] 运行 make test 延迟到先决条件之后 运行 make install 延迟到先决条件之后 为模块“Getopt::ArgvFile”运行安装 为 J/JS/JSTENZEL/Getopt-ArgvFile-1.11.tar 运行 make。 gz 使用 LWP 获取： [http://cpan.strawberryperl.com/authors/id/J/JS/JSTENZEL/Getopt-ArgvFile-1.11.tar](http://cpan.strawberryperl.com/authors/id/J/JS/JSTENZEL/Getopt-ArgvFile-1.11.tar) .gz 使用 LWP 获取： [http ://cpan.strawberryperl.com/authors/id/J/JS /JSTENZEL/CHECKSUMS](http://cpan.strawberryperl.com/authors/id/J/JS/JSTENZEL/CHECKSUMS) C:\strawberry\cpan\sources\authors\id\J\JS\JSTENZEL\Getopt-ArgvFile -1.11.tar.gz 的校验和
> 
> CPAN.pm：构建 J/JS/JSTENZEL/Getopt-ArgvFile-1.11.tar.gz
> 
> 检查您的工具包是否完整...看起来不错为 Getopt::ArgvFile 编写 Makefile 编写 MYMETA.yml 和 MYMETA.json cp ArgvFile.pm blib\lib\Getopt\ArgvFile.pm JSTENZEL/Getopt-ArgvFile-1.11.tar.gz
> C:\strawberry\c\bin\dmake.exe -- OK 运行 make test C:\strawberry\perl\bin\perl.exe "-MExtUtils::Command::MM" "-e" "test_harness(0, ' blib\lib', 'blib\arch')" t/*.tt/base.t ...... ok t/expandenv.t ...... ok t/fileopt.t ........ 好的 t/noHOMEvar.t ...... 好的 t/pod-coverage.t ... 跳过：测试 POD 覆盖率 t/pod 所需的 Test::Pod::Coverage 1.00。 t .......... 已跳过：测试 POD 所需的 Test::Pod 1.00 t/prefix.t ......... ok t/resolvepathes.t .. ok t/use1 .t ...... ok t/use2.t ...... ok 所有测试成功。Files=10, Tests=43, 3 wallclock secs (0.08 usr + 0.09 sys = 0.17 CPU) 结果：PASS
> JSTENZEL/Getopt-ArgvFile-1.11.tar.gz C:\strawberry\c\bin\dmake.exe test -- OK Running make install 安装 C:\strawberry\perl\site\lib\Getopt\ArgvFile.pm 附加安装信息到 C:\strawberry\perl\lib/perllocal.pod
> JSTENZEL/Getopt-ArgvFile-1.11.tar.gz C:\strawberry\c\bin\dmake.exe install UNINST=1 -- OK Running install for module 'Module: :ScanDeps 为 R/RS/RSCHUPP/Module-ScanDeps-1.10.tar.gz 运行 make 使用 LWP 获取： [http ://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/Module-ScanDeps-1.10 .tar](http://cpan.strawberryperl.com/authors/id/R/RS/RSCHUPP/Module-ScanDeps-1.10.tar)。C:\strawberry\cpan\sources\authors\id\R\RS\RSCHUPP\Module-ScanDeps- 1.10.tar.gz 的 gz 校验和
> 
> CPAN.pm：构建 R/RS/RSHUPP/Module-ScanDeps-1.10.tar.gz
> 
> 检查您的工具包是否完整...看起来不错为 Module::ScanDeps 编写 Makefile 编写 MYMETA.yml 和 MYMETA.json cp lib/Module/ScanDeps/Cache.pm blib\lib\Module\ScanDeps\Cache.pm cp lib/模块/ScanDeps/DataFeed.pm blib\lib\Module\ScanDeps\DataFeed.pm cp lib/Module/ScanDeps.pm blib\lib\Module\ScanDeps.pm C:\strawberry\perl\bin\perl.exe "-Iinc " -MExtUtils::Command -e cp -- script/scan deps.pl blib\script\scandeps.pl pl2bat.bat blib\script\scandeps.pl RSCHUPP/Module-ScanDeps-1.10.tar.gz
> C:\strawberry\c\bin\dmake.exe -- OK 运行 make test C:\strawberry\perl\bin\perl.exe "-MExtUtils::Command::MM" "-e" "test_harness(0, ' inc'、'blib\lib'、'blib\arch')" t/*.tt/0-pod.t ...................... ................ 跳过：测试 POD 需要 Test::Pod 1.00 t/1-static_functional_interface_real.t .......... ok t/10-不区分大小写的keys.t ....................确定t/12​​-ScanFileRE.t .... ................ 好的 t/13-static_prefork_test.t ...................... 跳过：这个测试需要未安装的 pr efork.pm。跳过。t/14-scan_chunk.t .... 好 t/14-static_functional_cached.t .... ............. 1/？0 无法从文件 deps_cache.dat 中检索数据。建立新的缓存。t/14-static_functional_cached.t ......... \DOCUME~1\shepp\LOCALS~1\Temp\vHQnTPJrl3 语法 OK t/7-check-dynaloader.t ......................... . 21/36 C:\DOCUME~1\shepp\LOCALS ~1\Temp\4nv64Rabo3 语法 OK t/7-check-dynaloader.t ................... ....... 29/36 C:\DOCUME~1\shepp\LOCALS ~1\Temp\tX8ukeJjGy 语法 OK t/7-check-dynaloader.t ...... ............. 好的 t/8-check_duplicated_entries.t .................. 好的 t/9-check_path_to_inc_name.t ... ................. ok 所有测试成功。Files=17, Tests=17352, 67 wallclock secs (1.89 usr + 0.22 sys = 2.11 CPU) 结果: PASS RSCHUPP/Module-ScanDeps-1.10.tar.gz C:\strawberry\c\bin\dmake.exe test -- OK 运行 make install 安装 C:\strawberry\perl\site\lib\Module\ScanDeps.pm 安装 C:\strawberry\perl\site\lib\Module\ScanDeps\Cache.pm 安装 C:\strawberry\perl\site\库\模块\ScanDeps\DataFeed。
> RSCHUPP/Module-ScanDeps-1.10.tar.gz C:\strawberry\c\bin\dmake.exe install UNINST=1 -- OK Running make for R/RS/RSCHUPP/PAR-Packer-1.013.tar.gz 已经已解包到目录 C:\strawberry\cpan\build\PAR-Packer-1.013-PEitq2
> 
> CPAN.pm：构建 R/RS/RSHUPP/PAR-Packer-1.013.tar.gz
> 
> cp lib/App/Packer/PAR.pm blib\lib\App\Packer\PAR.pm cp lib/PAR/Packer.pm blib\lib\PAR\Packer.pm cp lib/PAR/Filter/Obfuscate.pm blib\ lib\PAR\Filter\Obfuscate.pm cp lib/PAR/Filter/PodStrip.pm blib\lib\PAR\Filter\PodStrip.pm cp lib/PAR/StrippedPARL/Base.pm blib\lib\PAR\StrippedPARL\Base。 pm cp lib/PAR/Filter.pm blib\lib\PAR\Filter.pm cp lib/PAR/Filter/PatchContent.pm blib\lib\PAR\Filter\PatchContent.pm cp lib/PAR/Filter/Bytecode.pm blib \lib\PAR\Filter\Bytecode.pm cp lib/pp.pm blib\lib\pp.pm cp lib/PAR/Filter/Bleach.pm blib\lib\PAR\Filter\Bleach.pm C:\strawberry\perl \bin\perl.exe file2c.pl -s ..\script\par.pl my_par_pl.c load_m y_par_pl C:\strawberry\perl\bin\perl.exe sha1.c.PL gcc -c -s -O2 -DWIN32 -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IM PLICIT_SYS -fno-strict-aliasing -mms-bitfields -I"C:\strawberry\perl\lib\CORE" -DLOAD_MY_LIBGCC -DPARL_EXE=\"parl.exe\" -s -O2 main.c windres -F pei-i386 -i winres\pp.rc -o winres\pp.res windres - o ppresource.coff winres\pp.res windres: 意外版本字符串长度 68 != 32 + 8 dmake: 错误代码 129，同时制作 'ppresource.coff' dmake.exe: 错误代码 255，同时制作 'subdirs'
> RSCHUPP/PAR-Packer-1.013.tar.gz C:\strawberry\c\bin\dmake.exe -- 不正常 运行 make test 没有成功就无法测试 运行 make install Make 已返回错误状态，安装似乎不可能 停止：“R/RS/RSHUPP/PAR-Packer-1.013.tar.gz”的“安装”失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:03:31.787

[PAR-Packer 的错误 #77408：无法在 Win64/Perl64 上构建](https://rt.cpan.org/Public/Bug/Display.html?id=77408)

更新：Strawberryperl/Dwimperl 使用 MinGW 编译器，上面的 bug 报告包含了针对这个问题的补丁

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T01:06:38.297

我终于使用 PAR:Packer 的修补版本让它工作了：

[http://strawberryperl.com/package/kmx/perl-modules-patched/PAR-Packer-1.013_patched.tar.gz](http://strawberryperl.com/package/kmx/perl-modules-patched/PAR-Packer-1.013_patched.tar.gz)

谢谢齐格弗里德

# .net - 如何扩展 WinForms ListView 项的可点击区域？

> ID：13593280
> 
> 赞同：1
> 
> 时间：2012-11-27T21:20:41.960
> 
> 标签：.net, winforms, listview

我在 WinForms 应用程序中使用 ListView 控件，我注意到我必须非常精确地单击以选择一个项目 - 如果我不单击文本或图标，则不会选择任何内容！有什么方法可以扩展可点击区域，以便我可以在文本或图标附近单击（例如，在带有短文本字符串的项目的右侧）并实际选择一些东西？还是我必须使用 ListBox、TreeView 或 GridView 控件才能做到这一点？我喜欢 ListView 的分组功能，但这个问题让我抓狂！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:01:37.057

ListView 是一个底层的 Win32 控件，它禁止此类自定义。

您可以尝试[Better ListView Express](http://www.componentowl.com/better-listview-express)，它是免费的并且是完全托管的。它支持高级命中测试，以便您可以检测对项目空间的点击并相应地更新选择。它还允许扩展文本区域（但这仅在[完整版](http://www.componentowl.com/better-listview)中才有可能）。

[在此处输入链接描述](http://www.componentowl.com/documentation/better-listview/data/chapter-hit-test.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-10-18T10:15:11.113

`ListView.FullRowSelect = true;`

# jquery - 使用 jQuery 将标签标签复制到页面的另一部分

> ID：13593283
> 
> 赞同：0
> 
> 时间：2012-11-27T21:20:51.977
> 
> 标签：jquery, forms, radio-button

我有一个表单，允许用户过滤一组产品。当他们单击单选按钮时，它会自动通过 ajax 将表单提交到页面的另一个部分，这意味着页面和表单永远不会刷新。我有 3 组收音机选项。我想在另一个 div 中显示每个当前选择的标签，以便他们可以一目了然地看到当前应用的过滤器。这是我现在所拥有的：

```
<form id="myform" action="blah.php">
  <label for="allprice">
    <input type="radio" name="cat[price]" id="allprice" value="1" />
    All Price Ranges</label>
  <label for="m-150-300">
    <input type="radio" name="cat[price]" id="m-150-300" value="2" />
    $150 - $300</label>
  <label for="m-300-700">
    <input type="radio" name="cat[price]" id="m-300-700" value="3" />
    $300 - $700</label>
  <br />
  <br />
  <label for="allmaterial">
    <input type="radio" name="cat[material]" id="allmaterial" value="4" />
    All Materials</label>
  <label for="straw">
    <input type="radio" name="cat[material]" id="straw" value="5" />
    Straw</label>
  <label for="felt">
    <input type="radio" name="cat[material]" id="felt" value="6" />
    Felt</label>
  <br />
  <br />
  <label for="allcolor">
    <input type="radio" name="cat[color]" id="allcolor" value="4" />
    All Colors</label>
  <label for="blue">
    <input type="radio" name="cat[color]" id="blue" value="5" />
    Blue</label>
  <label for="green">
    <input type="radio" name="cat[color]" id="green" value="6" />
    Green</label>
</form>

<div class="filters">
Current Filters: <span class="current-filters">Straw, Green</span>
</div> 
```

它说“当前过滤器”的地方是我要列出当前选中的单选框的地方。此外，如果选择“全部”任何内容，我希望它被忽略。

如何获取选定单选框的标签并在逻辑意义上将它们显示在其他地方以逗号分隔，除了最后一个，如果选择“全部”则忽略？此外，如果为所有这些都选择了“全部”，我怎么能设置它说“没有应用过滤器”这可能与 jQuery 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:01:42.227

我建议以下

1.  用一个类将每个部分包装成一个包装器（下面的例子有`div.control-group`）
2.  对于您的“所有”单选按钮，添加一个数据属性以区别于非所有项目（下面的示例使用`data-all="all"`）

HTML：

```
<form id="myform" action="blah.php">
    <div class="control-group">
        <label for="allprice">
            <input type="radio" name="cat[price]" id="allprice" value="1" data-all="all" />
            All Price Ranges</label>
        <label for="m-150-300">
            <input type="radio" name="cat[price]" id="m-150-300" value="2" />
            $150 - $300</label>
        <label for="m-300-700">
            <input type="radio" name="cat[price]" id="m-300-700" value="3" />
            $300 - $700</label>
    </div>
    <br />
    <br />
    <div class="control-group">
        <label for="allmaterial">
            <input type="radio" name="cat[material]" id="allmaterial" value="4" data-all="all"/>
            All Materials</label>
        <label for="straw">
            <input type="radio" name="cat[material]" id="straw" value="5" />
            Straw</label>
        <label for="felt">
            <input type="radio" name="cat[material]" id="felt" value="6" />
            Felt</label>

    </div>
    <br />
    <br />
    <div class="control-group">
        <label for="allcolor">
            <input type="radio" name="cat[color]" id="allcolor" value="4" data-all="all"/>
            All Colors</label>
        <label for="blue">
            <input type="radio" name="cat[color]" id="blue" value="5" />
            Blue</label>
        <label for="green">
            <input type="radio" name="cat[color]" id="green" value="6" />
            Green</label>

    </div>
</form>

<div class="filters">
Current Filters: <span class="current-filters"></span>
</div>

<button id="filter-me">Filter</button> 
```

Javascript（`#filter-me`点击按钮触发）：

```
<script language="JavaScript">
    $('#filter-me').click(function(){
        var newarr = [];
        $('#myform .control-group input:checked').each(function(){
            if ($(this).attr('data-all') !== 'all') {
                newarr.push($(this).closest('label').text());
            };
        });
        $('.current-filters').text(newarr.join(', '));
    });
</script> 
```

# android - 导致 IllegalStateException 的 SherlockListFragment 必须附加到 SherlockListActivity

> ID：13593285
> 
> 赞同：0
> 
> 时间：2012-11-27T21:20:58.733
> 
> 标签：android, actionbarsherlock, android-listfragment

我有一个类为滑动菜单创建一个 behindMenu，如下所示：

```
public class BehindMenuFragment extends ListFragment {

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    String[] categories = getResources().getStringArray(R.array.categories);
    CategoryAdapter adapter = new CategoryAdapter(getActivity());
    int cats = categories.length;
    for (int i = 0; i < cats; i++) {
        adapter.add(new CategoryItem(categories[i], getIcon(categories[i])));
        }
    setListAdapter(adapter);
} 
```

它使用以下代码从另一个活动 MainActivity 调用：

```
getSupportFragmentManager()
    .beginTransaction()
    .replace(R.id.menu_frame, new BehindMenuFragment ())
    .commit(); 
```

上面的代码可以正常工作，没有问题，我想使用 ActionBarSherlock 将操作栏插入到后面的菜单中，我已经尝试了各种可能的方法，但无济于事。

将BehindMenuFragment 扩展为SherlockListFragment 会给我以下错误：

IllegalStateException：BehindMenuFragment 必须附加到 SherlockFragmentActivity

我很茫然，不知道如何解决这个问题，请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:22:30.173

看来您还没有完成[第四步](https://github.com/jfeinstein10/SlidingMenu#setup-with-actionbarsherlock)：

> ## 使用 ActionBarSherlock 进行设置
> 
> 1.  设置如上。
> 2.  签出 ActionBarSherlock 的干净副本并导入到您的 Eclipse 工作区。
> 3.  将 ActionBarSherlock 添加为 SlidingMenu 的依赖项
> 4.  进入您计划使用的 SlidingActivity，使它们扩展`Sherlock___Activity`而不是`___Activity`.

从来没有使用过这个库，我*猜*你应该将 MainActivity 更改为：

```
public class MainActivity extends SherlockSlidingFragmentActivity { 
```

现在您可以使用 SherlockListFragment：

```
public class BehindMenuFragment extends SherlockListFragment { 
```

并添加 Sherlock 的 ActionBar。

# java - 将数字转换为带 2 位小数的浮点数

> ID：13593287
> 
> 赞同：0
> 
> 时间：2012-11-27T21:21:04.363
> 
> 标签：java, decimal

```
float f = 0.00f;
System.out.println(f); 
```

给出输出：

```
0.00 
```

我想将一个以百分比表示的数字格式化为小数点后 2 位。但结果***应该是浮点数***而**不是**字符串。

例如

```
10.001 needs to be converted to 10.00
0.0 needs to be converted to 0.00
78.8  needs to be converted to 78.80 
```

如此格式化的值将被分配给一个浮点数..如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:27:16.623

```
private float parse(float val){       
     DecimalFormat twoDForm = new DecimalFormat("#.##");
     return Float.valueOf(twoDForm.format(val));
} 
```

只要你调用它传递一个有效的浮点数，你的结果就是一个浮点数。但是如果它不是字符串，则不能显示最右边的零。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:24:12.160

在一般情况下，您不能这样做。不能保证一个特定的十进制值可以用一个只有小数点右边两位数的浮点数来表示。

对于这种精度，浮点数是错误的数据类型。您需要改用十进制类型或缩放整数。

分配的工作方式相同。如果将值 133.47 分配给浮点变量，您的环境会将*最接近的有效浮点数*分配给变量。最接近的有效浮点数*可能*不是 133.47。

您可以在 C 中编译和执行该程序。

```
#include <stdio.h>

int main (void) {
  float r;
  r = 133.47;
  printf("%.2f, %f\n", r, r);
  return 0;
} 
```

它在我的系统上打印这些值

```
$ ./a.out
133.47, 133.470001 
```

格式化到小数点后两位改变了 'r' 的外观，但它并没有改变它的值。您的系统将根据实际值而不是格式化值进行浮点运算。（除非您还更改了数据类型。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:24:15.743

浮点数没有小数位。他们有二进制的地方。因此，唯一可以用浮点数精确表示到小数点后两位的分数是 0、0.25、0.5、0.75。在所有其他情况下，您所要求的都是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-01T13:08:02.307

```
import java.text.DecimalFormat;

public class Padding {
    public static void main(String[] args) {
        float value = 10.001f;
        DecimalFormat decimal = new DecimalFormat("0.00");

        String formattedValue = decimal.format(value);
        System.out.println(formattedValue);
    }

} 
```

输出：10.00

# drupal - drupal 7：自定义设计主题使用 Views 模块创建的块

> ID：13593290
> 
> 赞同：0
> 
> 时间：2012-11-27T21:21:24.230
> 
> 标签：drupal, drupal-7, drupal-views, drupal-theming

我创建带有视图模块的块，用于将打印提升到首页，这有效，我在首页中看到了结果。此视图适用于字段，我打印标题、拇指、内容。现在我需要自定义此主题视图以在 jquery 内容滑块中显示。

我点击高级->主题->信息我看到了这个：

`field content revision: views-view-field.tpl.php, views-view-field--title.tpl.php, views-view-field--frontpage.tpl.php, views-view-field--frontpage--title.tpl.php, views-view-field--block.tpl.php, views-view-field--block--title.tpl.php, views-view-field--frontpage--block.tpl.php, views-view-field--frontpage--block--title.tpl.php, views-view-field--block-1.tpl.php, views-view-field--block-1--title.tpl.php, views-view-field--frontpage--block-1.tpl.php, views-view-field--frontpage--block-1--title.tpl.php`

但我没有找到任何`.tpl.php`使用 html 和 css 编辑主题设计的主题文件。如何创建自定义设计主题以使用以下格式打印我的结果：

```
<div id="content">
   <ul>
     <li>
        <div class="title">title1</div>
        <div class="thumbs"><img 1 ......></div>
        <div class="content">content1</div>
     </li>
     <li>
        <div class="title">title2</div>
        <div class="thumbs"><img 2 ......></div>
        <div class="content">content2</div>
     </li>
   </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:34:39.833

我认为[Views 2 主题](http://drupal.org/node/352970)指南已经清楚地解释了一切。只需按照那里的步骤操作，只需几分钟。

# c# - 流利的 nhibernate 查询，其中可为空的 int

> ID：13593292
> 
> 赞同：1
> 
> 时间：2012-11-27T21:21:28.890
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent

我有一个类似这样的类：

```
public class WorkEntity
{
    ... // other stuff here
    public virtual int? WorkTypeID { get; set; }
} 
```

在我加入的查询中，我需要按 WorkTypeID 过滤我的结果

```
query.Where(() => workEntity.WorkTypeID == filter.WorkTypeID.Value); 
```

它不起作用，因为类型可以为空，我怎样才能使它起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:24:08.057

```
query.Where(() => workEntity.WorkTypeID != null && workEntity.WorkTypeID.Value == filter.WorkTypeID.Value); 
```

# excel - Excel 宏复制粘贴到第一个空行中的另一个 xls 文件中

> ID：13593293
> 
> 赞同：1
> 
> 时间：2012-11-27T21:21:35.217
> 
> 标签：excel, vba, copy, paste

我目前正在从事一个数字项目，我必须分析来自 100 多个 FB excel 文件的数据。

我的部分分析过程包括从始终相同的特定单元格中提取数据。

如您所知，我想制作一个宏以避免无用的时间浪费。

我知道如何在文件中提取它，但我想调整我的宏以便将它复制到另一个文件中。

我的代码如下：

***范围（“A9：D9”）。选择

选择.复制

Windows("test2.xlsx").激活

ActiveSheet.Paste***

现在，我想将数据粘贴到一个空行中，以便将数百行彼此重叠（每个 FB 提取一个）。

有人会给我正确的代码以避免浪费大量时间吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:38:18.767

如果宏位于“摘要”工作簿中并且 FB 文件已打开且处于活动状态：

```
ActiveSheet.Range("A9:D9")Copy _
   ThisWorkbook.Sheets("Data").Cells(Rows.Count,1).End(xlup).offset(1,0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:40:55.113

这是我用于类似操作以选择下一个可用单元格的代码片段。

```
'Insert after Your Windows("test2.xlsx").Activate in place of your paste Code.....
'This gives you the variable for the last cell with a value
lastRow = ActiveSheet.Cells(Rows.Count, "A").End(xlUp).Row
'This section selects the next cell below your last used cell and pastes the information.
ActiveSheet.Range("A" & lastRow + 1).Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
:=False, Transpose:=False
Application.CutCopyMode = False
Rest of Code.... 
```

我希望这就是你要找的。

# ruby - Ruby Sequel 模块中的事务：如何获取 DB 对象？

> ID：13593295
> 
> 赞同：1
> 
> 时间：2012-11-27T21:21:39.563
> 
> 标签：ruby, sinatra, sequel

我正在使用 Sequel 在 Sinatra 应用程序中工作。

我想进行交易，根据[手册](http://sequel.rubyforge.org/rdoc/files/doc/transactions_rdoc.html)我必须使用数据库对象，我怎样才能从我的代码的任何部分获取这个对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:43:50.130

您可以在基本 app.rb（或等效项）中定义它，或者根据需要包含一个单独的文件，您可以在其中配置 DB 对象。

例如，在我的一个 Sinatra 应用程序中，我有一个 app.rb，其中包含一个

```
class App < Sinatra::Application
  #lots of stuff here...
end

require_relative 'models/init' 
```

在我的 models/init.rb 我配置 DB

```
require 'sequel'

conf = YAML.load(File.open(File.expand_path('./config/dbconn.yml')))
env = ENV['RACK_ENV'] || 'development'
DB = Sequel.connect(host:conf['database'][env]['host'],
                    port:conf['database'][env]['port'],
                    database:conf['database'][env]['schema'],
                    username:conf['database'][env]['username'],
                    password:conf['database'][env]['password'],
                    adapter:conf['database'][env]['adapter'],
                    encoding:conf['database'][env]['encoding'])
raise "Unable to connect to #{conf['database'][env]['host']}" unless DB.test_connection

... 
```

这是一种方式。希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-28T18:04:56.923

您提到要从代码的任何部分引用；但是我发现封装在模型中是我倾向于包装事务的地方；从那里开始相对容易：

```
class X < Sequel::Model
  def self.y
    self.db.transaction {
    ...
    end
  end
  def z
    db.transaction {
    ...
    }
  end
end 
```

# .net - Windows API 返回代码值

> ID：13593296
> 
> 赞同：0
> 
> 时间：2012-11-27T21:21:46.483
> 
> 标签：.net, winapi

我正在开发一个基于 .Net framework 4 并使用 C# 语言的小程序。
我正在使用一个 .Net 库，它本身使用来自 AVIFile Windows API 的函数。

使用 AVIStreamRead 函数时出现错误。
这是 AVIStreamRead 函数的 MSDN 文档：http:
[//msdn.microsoft.com/en-us/library/windows/desktop/dd756849 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd756849(v=vs.85).aspx)

我想从结果整数值中获取有关我的错误的更多信息。
文档页面列出了以下三个返回码：

*   AVIERR_BUFFERTOOSMALL
*   AVIERR_MEMORY
*   AVIERR_FILEREAD

但是我从哪里得到相应的整数值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:30:28.573

哟可以从 Vfw.h 得到它们。

```
#define AVIERR_UNSUPPORTED      MAKE_AVIERR(101)
#define AVIERR_BADFORMAT        MAKE_AVIERR(102)
#define AVIERR_MEMORY           MAKE_AVIERR(103)
#define AVIERR_INTERNAL         MAKE_AVIERR(104)
... 
```

要将 SCODE 转换为错误代码，您可以使用

```
WORD SCODE_CODE(SCODE sc); 
```

# ontology - CLIPS 应用程序的本体编辑器

> ID：13593301
> 
> 赞同：1
> 
> 时间：2012-11-27T21:22:19.520
> 
> 标签：ontology, expert-system, clips

有哪些基于 GUI 的本体编辑器可以将本体导出为 CLIPS 格式？我知道[Protege](http://protege.stanford.edu/)但不支持某些 CLIPS 语言功能，并且相关的 CLIPSTab 插件似乎停滞不前（大约 9 年内没有更新）。是否有其他与 CLIPS 集成良好的本体编辑器？我正在专门寻找用于创建/编辑类层次结构、插槽、实例等的图形工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T23:42:03.450

我很遗憾地说，真的没有任何“开箱即用”的东西。

因为专家系统（以及一般的人工智能）被学术界（没有钱可赚）所主导，所以很少有人（公司）花费资源来制造好的工具。

# c# - 反应式扩展：缓冲直到订阅者空闲

> ID：13593306
> 
> 赞同：10
> 
> 时间：2012-11-27T21:22:32.343
> 
> 标签：c#, system.reactive

我有一个程序，我正在接收事件并希望分批处理它们，以便在我处理当前批次时进入的所有项目都将出现在下一个批次中。

Rx 中简单的 TimeSpan 和基于计数的 Buffer 方法将给我多批项目，而不是给我一大批已经进来的所有东西（如果订阅者花费的时间超过指定的 TimeSpan 或超过 N 个项目进来并且N 大于计数）。

我研究了使用更复杂的缓冲区重载，它们采用[Func<IObservable<TBufferClosing>>](http://msdn.microsoft.com/en-us/library/hh229432%28v=vs.103%29.aspx)或[IObservable<TBufferOpening> 和 Func<TBufferOpening, IObservable<TBufferClosing>>](http://msdn.microsoft.com/en-us/library/hh229621%28v=vs.103%29.aspx)，但我找不到如何使用这些的示例，更不用说数字了了解如何将它们应用于我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:38:50.233

这是做你想做的吗？

```
var xs = new Subject<int>();
var ys = new Subject<Unit>();

var zss =
    xs.Buffer(ys);

zss
    .ObserveOn(Scheduler.Default)
    .Subscribe(zs =>
    {
        Thread.Sleep(1000);
        Console.WriteLine(String.Join("-", zs));
        ys.OnNext(Unit.Default);
    });

ys.OnNext(Unit.Default);
xs.OnNext(1);
Thread.Sleep(200);
xs.OnNext(2);
Thread.Sleep(600);
xs.OnNext(3);
Thread.Sleep(400);
xs.OnNext(4);
Thread.Sleep(300);
xs.OnNext(5);
Thread.Sleep(900);
xs.OnNext(6);
Thread.Sleep(100);
xs.OnNext(7);
Thread.Sleep(1000); 
```

我的结果：

```
1-2-3
4-5
6-7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T07:54:04.877

我之前这样做的方法是在 DotPeek/Reflector 中提取 ObserveOn 方法，并采用它所具有的排队概念并使其适应我们的要求。例如，在具有快速计时数据的 UI 应用程序（如金融）中，UI 线程可能会被事件淹没，有时它不能足够快地更新。在这些情况下，我们希望删除除最后一个事件之外的所有事件（对于特定工具）。在这种情况下，我们将 ObserveOn 的内部队列更改为单个值 T（查找 ObserveLatestOn(IScheduler)）。在您的情况下，您想要队列，但是您想要推送整个队列而不仅仅是第一个值。这应该让你开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T09:04:26.200

您需要的是缓冲值的东西，然后当工作人员准备好时，它会请求当前缓冲区，然后将其重置。这可以通过 RX 和 Task 的组合来完成

```
class TicTac<Stuff> {

    private TaskCompletionSource<List<Stuff>> Items = new TaskCompletionSource<List<Stuff>>();

    List<Stuff> in = new List<Stuff>();

    public void push(Stuff stuff){
        lock(this){
            if(in == null){
                in = new List<Stuff>();
                Items.SetResult(in);
            }
            in.Add(stuff);
        }
    }

    private void reset(){
        lock(this){
            Items = new TaskCompletionSource<List<Stuff>>();
            in = null;
        }
    }

    public async Task<List<Stuff>> Items(){
        List<Stuff> list = await Items.Task;
        reset();
        return list;
    }
} 
```

然后

```
var tictac = new TicTac<double>();

IObservable<double> source = ....

source.Subscribe(x=>tictac.Push(x)); 
```

然后在你的工人

```
while(true){

    var items = await tictac.Items();

    Thread.Sleep(100);

    for each (item in items){
        Console.WriteLine(item);
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-11T19:37:01.000

@Enigmativity 的答案的一种扩展。我用它来解决问题：

```
public static IObservable<(Action ready, IReadOnlyList<T> values)> BufferUntilReady<T>(this IObservable<T> stream)
{
    var gate = new BehaviorSubject<Guid>(Guid.NewGuid());

    void Ready() => gate.OnNext(Guid.NewGuid());

    return stream.Publish(shared => shared
        .Buffer(gate.CombineLatest(shared, ValueTuple.Create)
            .DistinctUntilChanged(new AnyEqualityComparer<Guid, T>()))
        .Where(x => x.Any())
        .Select(x => ((Action) Ready, (IReadOnlyList<T>) x)));
}

public class AnyEqualityComparer<T1, T2> : IEqualityComparer<(T1 a, T2 b)>
{
    public bool Equals((T1 a, T2 b) x, (T1 a, T2 b) y) => Equals(x.a, y.a) || Equals(x.b, y.b);
    public int GetHashCode((T1 a, T2 b) obj) => throw new NotSupportedException();
} 
```

订阅者接收到准备好接收下一个缓冲区时调用的 Ready() 函数。我没有在同一个线程上观察每个缓冲区以避免循环，但我想你可以在其他地方打破它，如果你需要在同一个线程上处理每个缓冲区。

# javascript - JavaScript 最大表大小

> ID：13593307
> 
> 赞同：0
> 
> 时间：2012-11-27T21:22:32.557
> 
> 标签：javascript, jquery, html, css

我正在开发的网页遇到了一些问题。这是我遇到一些背景问题的页面的一般结构：

*   有一个表单，用户可以从四个复选框和一个下拉菜单中进行选择。当至少选择了一个复选框并从中选择了下拉菜单时，我使用 jQuery 生成一个“弹出窗口”，它实际上只是一个 iframe，我最初设置为隐藏但一旦输入变为可见有效的。这一切都很好。
*   在 iframe 中，我有一个交互式表格，其行由用户的表单输入动态确定。这是我遇到问题的表。

我希望桌子有一个“最大高度”，可以这么说。换句话说，我希望表格的行能够正常打印出来，直到表格的总高度达到某个点。那时，我希望表格可以滚动，如果你愿意的话，就像文本区域在放入足够的文本后变得可滚动一样（它的整体高度不会改变，但你可以滚动它）。

我愿意接受任何建议，只要它们只涉及 HTML、CSS、PHP、JavaScript 和/或 jQuery。如果您需要任何澄清，请不要犹豫，将所有这些都用语言表达出来并不容易，所以如果我不够清楚，我会理解的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:26:58.030

在您的 CSS 中，将`height: YOUR_MAX_HEIGHT`和`overflow-y: scroll`应用于您的表格。这应该是您想要实现的目标的良好开端。

# php - 在 .php 页面中包含 .shtml 文件？

> ID：13593308
> 
> 赞同：0
> 
> 时间：2012-11-27T21:22:36.900
> 
> 标签：php, html, shtml

我想在 .php 页面中包含一个 .shtml 文件。我知道这是可能的，因为我以前做过（尽管我忘记了代码）。请问有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-21T13:11:17.350

我建议使用：

```
include_once('/includes/header.shtml'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:36:47.360

你试过了吗 ：

```
 echo file_get_contents('/includes/header.shtml');
 // or
 echo file_get_contents('includes/header.shtml'); 
```

它可能会起作用。

但我会开始将所有模板转换为任何可用的 php 模板引擎。

# matlab - 查找满足条件的模拟的累积比例

> ID：13593310
> 
> 赞同：0
> 
> 时间：2012-11-27T21:22:40.333
> 
> 标签：matlab, matrix, octave, cumulative-sum

我有一个矩阵*A* (100,5)，其中每一行都是模拟的结果 (n=100)。

我想绘制/“记录” *A*中的最大值小于 0.40 的模拟的累积比例。我设想的图有纵轴，其中值范围从 0 到 100%，横轴是模拟次数。

最终，我在同一张图上绘制了几个场景，其中至少有一个场景将在 100 次模拟标记处达到 100% 的累积比例。

下面的代码是我已经走了多远，但我无法降低累积比例。我不认为我的矩阵*C*是我正在寻找的。

干杯。

```
ts=1:1:100;
% Create A where all rows sum to 1
A = rand(100, 5); % @Nzbuu http://stackoverflow.com/q/9312850/1670053 for this ex 
rowsum = sum(A,2);
A = bsxfun(@rdivide, A, rowsum);

% Create a vector from A where each elements records whether the max value was less 
% than 0.40 (value = 0) or greater than 0.40 (value = 1)
counts = zeros(100,1);
for i = 1:100
    if max(A(i,:)) < 0.40
        counts(i) = 0;
    else
        counts(i) = 1;
    end;
end;

B = cumsum(counts); % Get the cumulative sum of counts
C = B/100
plot(ts, C) 
```

# sql-server - 选择并覆盖

> ID：13593316
> 
> 赞同：2
> 
> 时间：2012-11-27T21:22:59.443
> 
> 标签：sql-server, select-into

我有这个 SQL Server 代理，它创建一个备份表，这样做：

```
DECLARE @date datetime, @insert_cmd varchar(1000)
SET @date =GETDATE()
set @insert_cmd = 'select * into [tablename_'+CONVERT(varchar(100), @date, 112 )+'] from tableA'
exec (@insert_cmd) 
```

麻烦的是， select * into table 仅在 table 不存在时才有效。有没有办法将其更改为插入 tablename_.... 而无需关心，并在必要时覆盖？

我尝试过使用 sql 检查表是否存在，例如：

```
IF OBJECT_ID ('tablename', 'U') IS NOT NULL DROP tablename; 
```

问题在于我如何定位这些引号，以便它们可以构建添加到表名的日期/时间？我尝试了一些变体，但没有一个成功：

```
/* errors with quotations: */
set @del_cmd = 'IF OBJECT_ID ('[tablename_'+CONVERT(varchar(100), @date, 112 )+']', 'U') IS NOT NULL DROP [tablename_'+CONVERT(varchar(100), @date, 112 )+']'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:56:32.130

完全归功于@aaronBertrand，这是我最终得到的代码：

```
DECLARE @insert_cmd varchar(MAX), @del_cmd NVARCHAR(MAX), @date datetime
SET @date =GETDATE()
  IF OBJECT_ID('tablename_' + CONVERT(varchar(100), @date, 112 ) ) IS NOT NULL 
   BEGIN 
SET @del_cmd = N'DROP TABLE tablename_' + CONVERT(varchar(100), @date, 112 ); 
EXEC sp_executesql @del_cmd; 
   END
SET @insert_cmd = 'select * into tablename_'+CONVERT(varchar(100), @date, 112 )+'] from TableA'
EXEC (@insert_cmd) 
```

非常感谢！

# sql-server - 数据库创建期间的身份问题

> ID：13593317
> 
> 赞同：2
> 
> 时间：2012-11-27T21:23:04.640
> 
> 标签：sql-server, identity, database-create

使用 SQL Server Management Studio，我的问题源于数据库创建脚本。编写该脚本是为了创建一个数据库，其中许多表都有一个标识列：

```
CREATE TABLE Workshop
(
    WorkshopID int IDENTITY,
    WorkshopName varchar(40) NOT NULL,
    Description varchar(800),
    CONSTRAINT PK_Workshop PRIMARY KEY (WorkshopID)
); 
```

我的问题是，即使脚本明确地将列创建为标识列，在脚本运行后，应该是标识列的列实际上都没有将该列设置为标识。

澄清一下：运行上述代码将创建指定的表，但 WorkshopID 将不是标识列。

需要更改哪些内容才能使脚本按原样工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:28:17.700

仅供参考，如果您使用 SQL Management Studio 的设计器为此生成脚本，则生成的脚本如下：

```
/* To prevent any potential data loss issues, you should review this script in detail before running it outside the context of the database designer.*/
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.Table_1
    (
    WorkshopID int NOT NULL IDENTITY (1, 1),
    WorkshopName varchar(40) NOT NULL,
    Description varchar(800) NULL
    )  ON [PRIMARY]
GO
ALTER TABLE dbo.Table_1 ADD CONSTRAINT
    PK_Table_1 PRIMARY KEY CLUSTERED 
    (
    WorkshopID
    ) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON,   ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.Table_1 SET (LOCK_ESCALATION = TABLE)
GO
COMMIT 
```

如果您创建表，然后使用 Create To... 菜单选项编写脚本，您将获得完全不同的脚本：

```
USE [MyDatabase]
GO

/****** Object:  Table [dbo].[Workshop]    Script Date: 11/27/2012 14:05:33 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[Workshop](
    [WorkshopID] [int] IDENTITY(1,1) NOT NULL,
    [WorkshopName] [varchar](40) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
    [Description] [varchar](800) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
 CONSTRAINT [PK_Workshop] PRIMARY KEY CLUSTERED 
(
    [WorkshopID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON,    ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO 
```

# emacs - 正确处理失败的片段完成

> ID：13593328
> 
> 赞同：2
> 
> 时间：2012-11-27T21:23:48.233
> 
> 标签：emacs, elisp, yasnippet, advising-functions, defadvice

我使用 TAB 从 yasnippet 扩展片段，当它不扩展片段时，它通常会退回到缩进（绑定到 TAB 的默认命令），这由 yasnippets 自定义变量引用，`yas-fallback-behavior`它只能是`call-other-command`or `return-nil`。

我想要的功能是在点击 TAB 时：

1.  尝试完成片段、成功或静默失败。
2.  检查我们是否处于 PHP 模式，并`php-complete-function`静默调用、成功或失败。
3.  默认为其当前的缩进命令 ( `indent-for-tab-command`)。

它目前完美地执行 1，然后是 3。`yas--fallback`但是，通过使用这段代码提供建议，我能够使其大部分工作：

```
(defadvice yas--fallback (before try-php-expand (&optional arg from-trigger-key-p) activate)
  (when (string-equal mode-name "PHP")
    (php-complete-function))) 
```

剩下的唯一**主要问题**是，当尝试使用 TAB 缩进任何内容时，`php-complete-function`不会静默**失败**，而是会向 minibuffer 发送垃圾邮件，其中包含来自 PHP 完成的多次检查的消息。

那么有没有办法在这种情况下禁止来自该函数的消息传递，而无需进行所有相同的检查，它实际上是在我的建议中重新编程该函数？或者，有没有更好的方法来使用 yasnippet 来开始我所缺少的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:01:10.737

`message-log-max`您可以通过设置来关闭任何表达式的登录`nil`。

```
(defadvice yas--fallback (before try-php-expand (&optional arg from-trigger-key-p) activate)
  (when (string-equal mode-name "PHP")
    (let (message-log-max)
      (php-complete-function)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T19:32:49.807

You could try something like (guaranteed 100% untested):

```
(defvar my-inhibit-messages nil)
(defadvice message (around my-inhibit activate)
  (unless my-inhibit-messages ad-do-it))

(defadvice php-complete-function (around my-silence-php-messages activate)
  (let ((my-inhibit-messages t))
    ad-do-it)) 
```

# java - 为包含整数数组的对象声明构造函数

> ID：13593329
> 
> 赞同：0
> 
> 时间：2012-11-27T21:23:49.797
> 
> 标签：java, arrays, class, constructor, int

这是我的构造函数的定义方式

```
 public One (int [] a, int [] b)
{
    A = a;
    B = b;
    C = new int [a.length + b.length];
} 
```

这就是我为此创建对象的方式：

```
 One A = new One ([1,3,5], [1,5,3]); 
```

我为此收到多个错误，例如`(int,int,int,int,int,int)`未定义构造函数和标记上的语法错误，请删除这些标记。

有人可以告诉我我哪里出错了吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:25:05.450

这不是在 java 中创建数组的方式。你需要像这样使用它： -

```
One A = new One (new int[] {1,3,5}, new int[] {1,5,3}); 
```

`new int[]`创建一个整数数组对象。

`{1, 3, 5}`内联初始化数组。

* * *

作为旁注，您应该声明以小写字母开头的变量。在您的代码中，您的实例数组引用应该是`a`而不是`A`. 并使用`this.a`它来访问它以避免局部变量和实例变量之间的名称冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:25:45.943

您创建**任意数组**的语法是错误的。你创建一个这样的**任意数组**。

```
One A = new One (new int []{1,3,5}, new int[]{1,5,3}); 
```

# javascript - 从数组中删除特定值

> ID：13593331
> 
> 赞同：0
> 
> 时间：2012-11-27T21:23:56.027
> 
> 标签：javascript, d3.js

我有一个不同学校成绩的数组。此数据是从 json 文件中收集的。在这个数组中，还有 0 的成绩。这些是未完成课程的学生的成绩。我想删除数组中的所有 0，但我不知道如何开始。

数组示例：

```
var grades = [7,6,4,0,4,8,9,6,6,10,0,7,8,6,7] 
```

ps我正在使用d3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:26:47.517

你可以试试[`Array.filter`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)：

```
var nonzero = grades.filter(function(v) {
    return v !== 0;
}); 
```

正如评论者正确指出的那样，`.filter`并非在所有浏览器中都可用。您可以使用 MDN 上提供的 shim（参见上面的链接），或者将您的代码重新编写为如下所示：

```
var i=0, len = grades.length, nonzero = [];
for(;i<len;i++) {
    grades[i] !== 0 && nonzero.push(grades[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:30:39.650

不是最优雅的代码，但它可以工作。

```
 var grades = [7,6,4,0,4,8,9,6,6,10,0,7,8,6,7],
      newGrades = [],
      grade;

  while (grades.length) {
    grade = grades.pop();

    if (grade != 0)
        newGrades.push(grade);
  }

  grades = newGrades; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:31:55.477

原始但仍然有效：

```
 var grades = [7,6,4,0,4,8,9,6,6,10,0,7,8,6,7];
    var j=0;
    var newgrades=[];
    for (var i=0; i < grades.length; i++) {
      if (grades[i]) {
        newgrades[j++] = grades[i]; 
        } 
    } 
```

等级=新等级；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:33:27.500

尝试`.splice()`方法

```
var grades = [7, 6, 4, 0, 4, 8, 9, 6, 6, 10, 0, 7, 8, 6, 7];

while (true) {
    var index = grades.indexOf(0);
    console.log(index);
    if (index > 0) {
        grades.splice(index, 1);
    }
    else {
        break;
    }
}
console.log(grades);
​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/wdy5P/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:34:00.637

```
for(var i=0; i<=grades.length; i++){
    if(grades[i]==0){
        grades.splice(i,1);
        i--;
    }
} 
```

# c# - linq 的 InvalidCastException 错误

> ID：13593341
> 
> 赞同：0
> 
> 时间：2012-11-27T21:24:34.787
> 
> 标签：c#, linq

在我的代码下面。它返回异常“InvalidCastException”。主要问题是 - 为什么？
怎么了？

错误文字：

> 无法将“WhereSelectListIterator`2[Monopolowy_beta.Gracz,Monopolowy_beta.Gracz]”类型的对象转换为“Monopolowy_beta.Gracz”类型。

```
namespace Monopolowy_beta
{
    class Program
    {
        static void Main(string[] args)
        {
            List<Gracz> lista = new List<Gracz> { };
            Gracz g1 = new Gracz();
            Gracz g2 = new Gracz();
            Gracz g3 = new Gracz();
            g2.Id = 3;

            lista.Add(g1);
            lista.Add(g2);
            lista.Add(g3);

            g1 = GraczeTools.UstawAktywnegoGracza(lista, 3);

            Console.ReadKey();
        }
    }
} 
```

这些行中的错误：
`var docelowy = from item in listagraczy where (item.Id==ID && item.czyAktywny == true) select listagraczy[listagraczy.IndexOf(item) + 1]; gracz = (Gracz)docelowy;`

```
namespace Monopolowy_beta
{
    static class GraczeTools
    {

        public static Gracz UstawAktywnegoGracza(List<Gracz> listagraczy, int ID)
        { 
            Gracz gracz = new Gracz();
            if (ID == 4){
                var docelowy = from item in listagraczy where (item.czyAktywny == true && item.Id == 3) select listagraczy[1];
                gracz = (Gracz)docelowy;
            }

            if (ID != 4){
                var docelowy = from item in listagraczy where (item.Id==ID && item.czyAktywny == true) select listagraczy[listagraczy.IndexOf(item) + 1];
                gracz = (Gracz)docelowy;
            }

            return gracz;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:30:48.970

```
var docelowy = from item in listagraczy 
               where (item.czyAktywny == true && item.Id == 3) 
               select listagraczy[1]; 
```

让我们检查一下这个查询。它找到满足条件的所有项目（是的，它将返回序列，而不是单个项目），并且对于每个这样的项目，它返回......`listagraczy`列表的第二个元素。是的，您没有符合您条件的物品。

我认为您应该选择`item`（这是您查询的范围变量），并应用于`FirstOrDefault`结果，因为默认情况下查询将返回`IEnumerable<Gracz>`结果。

```
var docelowy = (from item in listagraczy 
                where (item.czyAktywny == true && item.Id == 3) 
                select item).FirstOrDefault(); 
```

使用流畅的 API 编写哪个更好：

```
var docelowy = listagraczy.FirstOrDefault(item => item.czyAktywny && item.Id == 3); 
```

您也可以在条件中直接使用布尔值（即`item.czyAktywny`代替`item.czyAktywny == true`）。

* * *

经过一点重构，您的方法应该看起来像

```
public static Gracz UstawAktywnegoGracza(List<Gracz> listagraczy, int ID)
{ 
   return listagraczy
           .FirstOrDefault(item => item.Id == 3 && (ID != 4 || item.czyAktywny));
} 
```

这个怎么运作：

您的方法中有两个条件块，`if (ID == 4)`并且`if (ID != 4)`（实际上是`if ... else`。不同之处在于，您在第一种情况下通过一个条件过滤序列 -`item.czyAktywny`应该为真。在第二种情况下，此属性无关紧要。因此，您可以添加一个过滤条件相反`(ID != 4 || item.czyAktywny)`- 只有当 ID 等于 4 时才会验证 czyAktywny。此外，您不需要`Gracz`在方法中创建新对象，因为无论如何您都会从传递的列表中返回一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:30:00.463

而不是`gracz = (Gracz)docelowy;`，使用`gracz = docelowy.FirstOrDefault();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:36:16.867

您的 select 语句返回一个`IEnumerable<Gracz>`. 因此，当您尝试将其`Gracz`直接转换为时，计算机不知道如何执行此操作并抛出您看到的错误。

有很多方法可以处理这种情况，但最简单的方法是简单地添加`FirstOrDefault`到你的调用中，给你

```
gracz = docelowy.FirstOrDefault(); 
```

而不是你目前拥有的。顺便说一句，您也需要将此添加到您的其他`if`语句中 - 它也有同样的问题。

# .net - 在 .net 4.5 中使用步进并行化 for 循环

> ID：13593342
> 
> 赞同：3
> 
> 时间：2012-11-27T21:24:37.157
> 
> 标签：.net, vb.net, task-parallel-library, .net-4.5, async-await

我有一个类似于下面代码的函数。它的目的是从一组点中一次取一个三角形面，其中每三个点都是一个面，并将它们细分，用边长不超过 nodeSize 的较小面的列表替换面。

当然，对于任何真实的刻面网格来说，这个函数都是很耗时的。我想重构它以使用一些粗略的并行化。但是，Parallel.For 似乎没有办法在保留索引号的同时每隔一段时间遍历数组中的索引。

记住`SplitTriangle`循环内的函数在计算上不利于并行化，我该如何重构这个函数？

```
Protected Shared Function SplitTriangles(Points As IEnumerable(Of Point3D), nodeSize As Single) As List(Of Point3D)
    Dim resultList As New List(Of Point3D)

        For i As Integer = 0 To Points.Count - 1 Step 3
            resultList.AddRange(SplitTriangle(Points(i), Points(i + 1), Points(i + 2), nodeSize * 4))
        Next

    Return resultList
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:26:51.810

我认为这里最简单的解决方案是首先检查这些点并将它们分成一组 3 点组。然后你可以`Parallel.For`在那个数组上使用。

编辑：既然你有数百万分并且一直这样做，你应该做点别的。

首先，确保您的`Points`容器允许轻松随机访问（使用数组或 a `List`）。然后这样做：

*   分配`resultList`适当的大小。
*   分成`Points`几个部分（“几个”可能很难估计，你应该稍微玩一下）。假设您的列表有 12,000,000 个点，那么`resultList`4,000,000 个元素的长度也是如此。并假设您决定 4 个部分是最佳拆分。
    *   每个部分必须是连续的（0-3M、3M-6M、6M-9M、9M-12M）。
    *   找到最佳分割并不容易，但微不足道的分割可能证明足够好，所以现在不要担心。
*   有 4 个线程，每个线程处理一个部分（您可以使用[Task API](http://msdn.microsoft.com/en-us/library/dd537609.aspx)，在我看来，它会使代码比`Parallel.For`在这种情况下更清晰。

关于线程安全的注意事项：

`List<Point>`当您将 a 用作固定大小的数组时，我不是 100% 相信它是线程安全的。应该是，但如果你想 100% 确定使用数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T12:03:04.537

如果不是传递按惯例视为三角形的 IEnumerable 点，而是直接传递三角形，那么您的代码将简单得多。

如果将点转换为三角形，则可以使用 PLINQ 编写以下内容：

```
 Function SplitTriangles(triangles As IEnumerable(Of Triangle3D), nodeSize As Single) As List(Of Triangle3D)
    Dim resultList As New List(Of Point3D)

    Dim results = (From triangle In triangles.AsParallel()
                   From newTriangle In SplitTriangle(triangle.A, triangle.B, triangle.C)
                   Select newTriangle).ToList()

    Return results
End Function 
```

AsParallel 不保留排序，但您可以通过在 AsParallel 之后添加 .AsOrdered 来强制执行此操作

使用 Parallel.For 需要使用接受[本地初始化器和终结器](http://msdn.microsoft.com/en-us/library/dd460703.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)的重载来收集每个计算的结果。最终的代码要复杂得多，在这种情况下没有任何好处。

IEnumerable(Of Point3) 的问题在于每个三元组的点之间存在非常强的关系。Parallel.For/Foreach 适用于每个项目独立于其他项目的列表。

[您可以使用此处](https://stackoverflow.com/questions/410717/f-seq-module-implemented-in-c-sharp-for-ienumerable#410759)改编的 Marc Gravell 的 Partition 方法将初始点列表转换为三角形列表，以将点分组为三元组并返回三角形而不是 IEnumerable。

一个更简单但不太通用的解决方案是创建一个从点返回三角形的迭代器：

```
 Iterator Function Triangulize(points As IEnumerable(Of Point3D)) As IEnumerable(Of Triangle3D)

    Dim count As Integer = 0

    Dim buffer(3) As Point3D

    For Each point As Point3D In points
        buffer(count) = point
        count += 1
        If count = 3 Then
            Yield New Triangle3D(buffer(0), buffer(1), buffer(2))
            count = 0
        End If
    Next

End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:31:40.163

您可以使用该`Enumerable.Range()`函数为您生成索引。我对 VB.NET 不太熟悉，所以我打算用 C# 来编写它。

```
Enumerable.Range(0, Points.Count / 3).AsParallel().ForAll( loopVar => {
    var i = loopVar * 3;
    resultList.AddRange(SplitTriangle(Points(i), Points(i + 1), Points(i + 2), nodeSize * 4))
}); 
```

* * *

***更新*** 我认为这个版本是线程安全的，但您应该检查以确保它是线程安全的并且结果的顺序正确。

```
resultList = Enumerable.Range(0, Points.Count / 3).AsParallel().SelectMany( loopVar => {
    var i = loopVar * 3;
    return SplitTriangle(Points(i), Points(i + 1), Points(i + 2), nodeSize * 4);
}); 
```

# c# - 如何根据当前对象的 bool 属性隐藏 RadGridView 中的单元格？

> ID：13593344
> 
> 赞同：3
> 
> 时间：2012-11-27T21:24:50.353
> 
> 标签：c#, wpf, xaml, data-binding, radgridview

我目前有一个对象列表，其中我的 RadGridView 的 ItemsSource 设置为。当列表中对象的属性“DoNotContact”设置为 True 时，我想在 RadGridView 中隐藏包含电话号码的单元格中的信息。正如您在我的 XAML 中看到的，我在 TextBlock 中设置 Visibility 属性，如下所示：

```
 <telerik:GridViewDataColumn Header="Evening" DataMemberBinding="{Binding Path=EveningPhone}" Width="75" SortMemberPath="EveningPhone">
                 <telerik:GridViewColumn.CellTemplate>
                    <DataTemplate>
                       <TextBlock Visibility="{Binding Path=DoNotContact, Converter={StaticResource BoolToVisibilityConverter}}">
                          <Hyperlink Click="MakeEveningCallHandler">
                             <TextBlock Text="{Binding Path=EveningPhone}" />
                          </Hyperlink>
                       </TextBlock>
                    </DataTemplate>
                 </telerik:GridViewColumn.CellTemplate>
              </telerik:GridViewDataColumn> 
```

尝试调试它时，转换器永远不会被击中，虽然我可以看到属性“DoNotContact”已设置，但电话号码仍然显示。转换器本身工作正常，因为我在其他场合使用过它。同样，我只想隐藏“晚上”属性的单元格内的信息，而不是实际的列本身。任何想法这里出了什么问题？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-23T15:56:26.677

您提供的代码对我有用！

# c++ - 包括本征

> ID：13593350
> 
> 赞同：0
> 
> 时间：2012-11-27T21:25:13.237
> 
> 标签：c++, eclipse, eigen

我已将[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page)标头包含在 Eclipse 的 C++ 项目中。当我尝试构建时，出现此错误：

```
Symbol 'Eigen' could not be resolved    Semantic Error 
```

据我了解，这是一个链接器错误，但 Eigen 是一个仅标头项目，因此没有可链接的库。引发错误的代码遵循他们提供的基本教程，有问题的代码段如下所示：

```
#include <Eigen/Dense>

using namespace Eigen; 
```

我究竟做错了什么？如果有帮助，我将在 Linux 上运行它。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:38:37.640

Eigen 通常被大多数发行版安装到`/usr/include/eigen2`和/`/usr/include/eigen3`或类似的地方。验证头文件的安装位置，因为您需要将该路径添加为项目中的附加包含路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:38:48.500

检查编译器是否获得正确的包含路径。例如，Eigen 库头文件可能安装在 中`/usr/include/eigen3`，所以在编译时你必须给编译器 flag `-I /usr/include/eigen3`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T22:16:38.707

我在摆弄，发现告诉索引器索引未使用的标题解决了我的问题。

![在此处输入图像描述](../Images/fdbf3b6f395b40643cd285c4373ff91d.png)

谢谢你们在球上。有点抱歉，我自己偶然发现了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-17T23:37:55.773

您不应该将标题直接放在您的项目中，它会使 eclipse 非常缓慢，有时甚至会显示警告甚至（错误）错误。相反，您应该将库放在磁盘上的某个位置并通过项目属性 -> c/c++ General -> GNU C++ -> Add -> File system -> Eigen 根文件夹（您提取的位置）链接到它（设置 propper 包含目录）它到）

# android - 如何获取通知ID？

> ID：13593351
> 
> 赞同：1
> 
> 时间：2012-11-27T21:25:19.463
> 
> 标签：android, android-notifications

我开发了一个基本的通知示例，并试图捕捉点击了哪个通知。但我不能。

我在我的通知中放置了一个数组列表，并通过添加额外内容将其传递给接收者活动，然后尝试捕捉但没有办法！

反正有没有抓住哪一个？

![在此处输入图像描述](../Images/8fc87e576cf48e889952098f2c77dfbc.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:31:18.943

您可以将 a`Bundle`与 PendingIntent 一起传递给下一个 Activity。

```
Bundle bundle = new Bundle();
bundle.putString("Any String");
NotificationManager notifManager = (NotificationManager) this.getSystemService(this.NOTIFICATION_SERVICE);
int uniqueInteger = //create a unique Integer        
int icon = R.drawable.ic_launcher;
NotificationCompat2.Builder mNotification = new NotificationCompat2.Builder(this).setSmallIcon(icon)
                .setContentTitle(contentTitle).setContentIntent(getPendingIntent(bundle, uniqueInteger));

mNotification.setDefaults(Notification.DEFAULT_LIGHTS | Notification.DEFAULT_SOUND | Notification.DEFAULT_VIBRATE);
mNotification.setAutoCancel(true);
notifManager.notify(uniqueInteger, mNotification.build()); 
```

和方法`getPendingIntent()`

```
private PendingIntent getPendingIntent(Bunble bundle, int rc) { 
Intent notificationIntent = new Intent(this, YourNextActivity.class);
notificationIntent.putExtras(bundle);
return PendingIntent.getActivity(this, rc, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);
} 
```

我在这里使用Jake Wharton 的[NotificationCompat2](https://github.com/JakeWharton/NotificationCompat2)，但答案并不依赖于此。

# bash - 递归地使文件中的所有文本小写的 Bash 脚本

> ID：13593352
> 
> 赞同：3
> 
> 时间：2012-11-27T21:25:21.277
> 
> 标签：bash

我正在尝试编写一个 shell 脚本，它递归地遍历一个目录，然后在每个文件中将所有 **大写**字母转换为**小写字母**。需要明确的是，我不是要更改文件名，而是要更改文件中的文本。

注意事项：

1.  这是一个旧的 Fortran 项目，我正在努力使其更易于访问
2.  我不想创建一个新文件，而是用更改覆盖旧文件
3.  此目录中有几个不同的文件扩展名，包括 .par .f .txt 等

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:07:00.203

要将文件从小写转换为大写，您可以使用`ex`（标准编辑器的好朋友`ed`）：

```
ex -s file <<EOF
%s/[[:upper:]]\+/\L&/g
wq
EOF 
```

或者，如果您喜欢一行内容：

```
ex -s file <<< $'%s/[[:upper:]]\+/\L&/g\nwq' 
```

结合`find`，您可以执行以下操作：

```
find . -type f -exec bash -c "ex -s -- \"\$0\" <<< $'%s/[[:upper:]]\+/\L&/g\nwq'" {} \; 
```

这种方法对于文件名中的空格和有趣符号是 100% 安全的。不创建、复制或移动辅助文件；文件只被编辑。

### 编辑。

使用[glenn jackmann](https://stackoverflow.com/users/7552/glenn-jackman)的建议，您还可以编写：

```
find . -type f -exec bash -c 'printf "%s\n" "%s/[[:upper:]]\+/\L&/g" "wq" | ex -- -s "$0"' {} \; 
```

（优点是它避免了尴尬的逃跑；缺点是它更长）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:28:09.877

`tr`您可以使用命令并指定字符范围将所有大写字符 (A–Z) 转换为小写字符 (a–z) ，如下所示：

`$ tr 'A-Z' 'a-z' <be.fore >af.ter`

`tr`在为大写和小写转换指定这种范围时，还有一些特殊的语法：

`$ tr '[:upper:]' '[:lower:]' <be.fore >af.ter`

该`tr`实用程序复制给定的输入以生成输出，并替换或删除选定的字符。tr 缩写为 translate 或 transliterate。它将两组字符作为参数，并将*第一组中出现的字符替换为另一**组*中的相应元素，即用于翻译字符。

`tr "set1" "set2" < input.txt > output.txt`

虽然`tr`不支持正则表达式，嗯，它确实支持一系列字符。

只需确保两个参数以相同数量的字符结束即可。如果第二个参数较短，则将重复其最后一个字符以匹配第一个参数的长度。如果第一个参数较短，则第二个参数将被截断以匹配第一个参数的长度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T22:47:17.900

`sed -e 's/\(.*\)/\L\1/g' *`

或者您可以通过管道将文件从 find

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T23:52:29.693

扩展@nullrevolution 的解决方案：

```
find /path_to_files -type f -exec sed --in-place -e 's/\(.*\)/\L\1/g' '{}' \; 
```

这一行将查找以 /path_to_files 作为基本目录的所有子目录中的所有文件。

**警告**：这将更改 */path_to_file* 下每个目录中所有文件的大小写**，****因此**请确保在执行此脚本之前要执行此操作。您可以使用以下方法根据文件扩展名限制查找范围：

 **```
find /path_to_files -type f -name \*.txt -exec sed --in-place -e 's/\(.*\)/\L\1/g' '{}' \; 
```

您可能还想在修改原始文件之前备份原始文件：

find /path_to_files -type f -name *.txt -exec sed --in-place=-orig -e 's/(.*)/\L\1/g' '{}' \;

这将保留原始文件名，同时制作未修改的副本，并在文件名后附加“_orig”（即*file.txt*将变为*file.txt-orig*）。

每件作品的解释：

`find /path_to_file` 这会将基本目录设置为提供的路径。

`-type f`这将仅在目录层次结构中搜索文件。

`-exec COMMAND '{}' \;` 这将为每个匹配的文件执行一次提供的命令。`'{}'`替换为当前文件名。表示命令的`\;`结束。

`sed --in-place -e 's/\(.*\)/\L\1/g'` 这`--in-place`将在不备份文件的情况下对文件进行 cnages。正则表达式使用反向引用`\1`来引用整行并`\L`转换为小写。

**可选的**

（对于更古老的解决方案。）

```
find /path_to_files -type f -exec dd if='{}' of='{}'-lc conv=lcase \; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:45:28.493

在类 Unix 环境中识别文本文件可能有点棘手。你可以这样做：

```
set -e -o noclobber
while read f; do
   tr 'A-Z' 'a-z' <"$f" >"f.$$"
   mv "$f.$$" "$f"
done < <(find "$start_directory" -type f -exec file {} + | cut -d: -f1) 
```

这将在带有嵌入冒号或换行符的文件名上失败，但应该适用于其他文件名，包括带有空格的文件名。**

# c# - 在使用线程特定变量的 C# 4.0 Parallel.For 循环中找不到错误

> ID：13593353
> 
> 赞同：1
> 
> 时间：2012-11-27T21:25:24.640
> 
> 标签：c#, c#-4.0, parallel-processing, task-parallel-library

我正在尝试使用一个基类 (SlotBase) 对老虎机行为进行并行编程建模，该基类将被代表每台机器的类覆盖。

在基类中，我有一个方法（尝试）调用后代类的方法（在基类中标记为抽象），该方法播放样本并通过使用输出参数返回结果，然后使用互斥锁更新基类的求和变量。

相关代码示例如下： *来自 SlotBase.cs：*

```
#region Member Variables
protected long m_CoinIn;
protected long[] m_CoinOut;
protected string[] m_FeatureList;
protected long[] m_HitCount;
// .. and many more, but redacted for length
#endregion

protected abstract void PlaySample(long sampleSize, out long coinIn, out long[] coinOut, out long[] hitCount);

protected override void DoSimulation() {
    // No need to intialize these, as the calling routine will, and only it knows how big the arrays need to be, and so forth.
    object mutex = new object();

    if (ParallelMode) {
        int periodCount = (int)(BatchSize / PeriodSize);
        Parallel.For(0, periodCount, delegate(int i) {
            long coinIn;
            long[] coinOut;
            long[] hitCount;

            PlaySample(PeriodSize, out coinIn, out coinOut, out hitCount);
            lock (mutex) {
                Console.WriteLine("Coin in this batch: {0}", coinIn);
                m_CoinIn += coinIn;

                for (int j = 0; j < m_FeatureList.Length; ++j) {
                    m_CoinOut[j] += coinOut[j];
                    m_HitCount[j] += hitCount[j];
                }
            }
        });
    }
} 
```

..并来自典型的子类实现：

```
protected override void PlaySample(long sampleSize, out long coinIn, out long[] coinOut, out long[] hitCount) {
    switch (WagerIndex) {
        case (int)WagerType.Main: {
            RNG localRNG = SpawnRNG();
            coinIn = 0;
            coinOut = new long[m_FeatureList.Length];
            hitCount = new long[m_FeatureList.Length];

            for (long iter = 0; iter < sampleSize; ++iter) {
                coinIn += m_LinesPlayed;
                double[] output = GetSpinResults(ref localRNG, (int)SpinMode.MainSpin);

                for (int i = 0; i < m_FeatureList.Length; ++i) {
                    coinOut[i] += (long)output[i];
                    if (output[i] > 0) ++hitCount[i];
                }
            }                   
            break;
        }
        default: {
            throw new Exception(string.Format("Wager Type index {0} not supported", WagerIndex));
        }
    }
} 
```

*.. 这实际上对SampleSize*和*PeriodSize*的小值非常有效，但随着值的增加，它很快就会挂起（或实际上挂起）。

我已经尝试注释掉变量更新并且挂起继续认真，这表明问题实际上与我实现*Parallel.For*循环的方式有关。

我几乎没有问题从头开始拆除它并重建以使其正常工作。我唯一真正重要的设计目标是我拥有相同的范例（一个基类，多个子类用于实现不同的插槽）。

我哪里错了？

# jquery - jQuery UI 可拖动设置句柄取决于位置范围

> ID：13593359
> 
> 赞同：0
> 
> 时间：2012-11-27T21:26:00.527
> 
> 标签：jquery, css, jquery-ui, jquery-animate

下面的代码引用了一个用作句柄（this）的块元素。此元素可通过 jQuery UI 拖动。我想要做的是确定手柄被放下的位置，并根据它被放入的范围“类别”，我将它动画到屏幕上的一个点。代码有效，我只是觉得我在重复自己，但我不知道如何总结。

```
 stop: function( event, ui ) {

            var left = ui.position.left,

                position = "";

            if (left >= 0 && left <= 80) {
                $(this).animate({left: 20}, 200);
                position = 1;
            }

            if (left >= 81 && left <= 198) {
                $(this).animate({left: 137}, 200);
                position = 2;
            }

            if (left >= 199 && left <= 315) {
                $(this).animate({left: 254}, 200);
                position = 3;
            }

            if (left >= 316 && left <= 430) {
                $(this).animate({left: 371}, 200);
                position = 4;
            }

            if (left >= 431 && left <= 548) {
                $(this).animate({left: 488}, 200);
                position = 5;
            }

            if (left >= 549) {
                $(this).animate({left: 605}, 200);
                position = 6;
            }

            $(content).children().fadeOut(300, "linear");
            $(content).children(':nth-child('+ position +')').delay(299).fadeIn(600, "linear");
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:42:10.823

```
//maybe something like this?

stop: function( event, ui ) {

    var left = ui.position.left, position = [];

    if (left >= 0 && left <= 80)
        position = [20, 1];

    if (left >= 81 && left <= 198)
        position = [137, 2];

    if (left >= 199 && left <= 315)
        position = [254, 3];

    if (left >= 316 && left <= 430)
        position = [371, 4];

    if (left >= 431 && left <= 548)
        position = [488, 5];

    if (left >= 549)
        position = [605, 6];

    // OR
    /*
     var position = ((left >= 0 && left <= 80) ? [20, 1] :
     ((left >= 81 && left <= 198) ? [137, 1] :
     ((left >= 199 && left <= 315) ? [254, 3] :
     ((left >= 316 && left <= 430) ? [371, 4] :
     ((left >= 431 && left <= 548) ? [488, 5] :
     ((left >= 549) ? [605, 6] : [] ) ) ) ) ) );
     */
    if (position.length) {
        $(this).animate({
            left : position[0]
        }, 200);
        $(content).children().fadeOut(300, "linear", function() {
            $(content).children(':nth-child(' + position[1] + ')').delay(299).fadeIn(600, "linear");
        });

    }
} 
```

# matlab - 如何在 matlab 中使用 dct2()？

> ID：13593360
> 
> 赞同：0
> 
> 时间：2012-11-27T21:26:00.587
> 
> 标签：matlab, matrix

我正在尝试将矩阵传递给 dct2 函数，但它显示错误。我正在使用 matlab 版本 R2012a。我有一个矩阵 B，它只是用作如下参数

```
B = dct2(A);

disp(B); 
```

错误是这样显示的

```
Undefined function 'dct2' for input arguments of type 'uint8'.

Error in image_dct (line 24)
B = dct2(A); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:41:14.517

You have to have the image processing toolkit in order to use that. Assuming you have that, then it should be just as simple as you listed.

# eclipse - 通过 eclipse 运行 junit 测试，给出与 maven 测试不同的结果；怀疑Websphere

> ID：13593364
> 
> 赞同：2
> 
> 时间：2012-11-27T21:26:32.857
> 
> 标签：eclipse, maven, junit, websphere, websphere-7

我正在使用Websphere 7开发一个mavenized java项目。当单元测试从命令行运行时，使用“mvn test”，它们都运行正常。但是，当它们从 Eclipse 运行时，通过右键单击作为 junit 测试运行，它们中的一部分在 Web 服务调用中失败，因为“javax.xml.ws.WebServiceException: org.w3c.dom.DOMException: HIERARCHY_REQUEST_ERR: 尝试是在不允许的地方插入一个节点。”

原因：org.w3c.dom.DOMException：HIERARCHY_REQUEST_ERR：试图插入不允许的节点。

```
at org.apache.xerces.dom.CoreDocumentImpl.insertBefore(Unknown Source)
at org.apache.xerces.dom.NodeImpl.appendChild(Unknown Source)
at com.ibm.ws.webservices.engine.xmlsoap.SOAPPart.appendChild(SOAPPart.java:282)
at com.sun.xml.internal.bind.marshaller.SAX2DOMEx.startElement(SAX2DOMEx.java:165)
at com.sun.xml.internal.ws.message.AbstractMessageImpl.writeTo(AbstractMessageImpl.java:147)
at com.sun.xml.internal.ws.message.AbstractMessageImpl.readAsSOAPMessage(AbstractMessageImpl.java:182)
at com.sun.xml.internal.ws.handler.SOAPMessageContextImpl.getMessage(SOAPMessageContextImpl.java:68) 
```

我查看了 eclipse 中的运行配置，我确信它们使用相同的（sun 1.6）JDK 来运行。

在这两种情况下，我都打印了我的类路径，我发现唯一的区别是，当我从 Eclipse 运行时，我有 46 个 ibm jar，而当我从命令行运行时，这些 jar 不存在。这是一个示例：'C:\Program Files (x86)\IBM\WebSphere\AppServer\plugins\com.ibm.ws.ejbportable.jar'、'C:\Program Files (x86)\IBM\WebSphere\AppServer\ plugins\com.ibm.ws.jpa.jar', 'C:\Program Files (x86)\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\dhbcore.jar', 'C:\Program Files (x86 )\IBM\WebSphere\AppServer\plugins\com.ibm.ws.admin.core.jar', 'C:\Program Files (x86)\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm .mq.headers.jar' 等（如果有人觉得有帮助，我可以打印完整列表）。

只是我怀疑这些 jar 是破坏单元测试的罪魁祸首，我对其他建议持开放态度，可以根据要求发布更多信息。我需要能够从 Eclipse 运行它们以使调试它们易于管理。

# c# - 在 Microsoft Pubcenter 中切换广告

> ID：13593366
> 
> 赞同：0
> 
> 时间：2012-11-27T21:26:34.767
> 
> 标签：c#, windows-phone-7, xaml

我在每个 Windows Phone 页面上都有许多 PubCenter 广告。默认情况下，它们都被禁用。

我使用一个随机发生器和一个开关来选择一个打开。这适用于 AdDuplex，但当我使用 Pubcenter 时，我只会在广告应该出现的地方得到一个空白空间。有谁知道我必须做什么才能让这些广告开始工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:10:33.123

Various reasons may cause the PubCenter control to be hidden.

The simplest thing you can do to determine why is to subscribe to the `AdControlError` event in the code-behind of the page, like this:

```
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
    base.OnNavigatedTo(e);
    myAdControl.AdControlError += AdControlError;
}

private void AdControlError(object sender, ErrorEventArgs e)
{
    string error = e.ErrorDescription;
    MessageBox.Show(error);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:49:45.223

我假设您已经在 pubcenter 注册，并且正在设置 AdControl.ApplicationId 和 AdControl.AdUnitId 属性？如果你已经这样做了，那么一切都应该很好。

这些是您设计/开发应用程序时的设置：

```
adControl1.ApplicationId = "test_client";
adControl1.AdUnitId = "Image480_80"; 
```

# sql - SQL 仅选择每个 id 一次，由最早的日期时间选择

> ID：13593373
> 
> 赞同：0
> 
> 时间：2012-11-27T21:27:02.030
> 
> 标签：sql, sybase

我目前必须为工作中的一次性报告流程运行如下查询。

但是，对于表中的每个项目，都保存了多个关联的“消息”，这意味着每个项目都会被多次返回。根据下面的示例和进一步的解释，我只想将每个项目显示一次。

我意识到这是（至少在我看来）一个糟糕的结构，但需要完成报告，这就是数据的存储方式:-(

**SQL小提琴：** [http ://sqlfiddle.com/#!6/76fce/8](http://sqlfiddle.com/#!6/76fce/8)

**询问：**

```
SELECT messageId, receiver, createdDate, itemId from messages_0,items WHERE
    itemId IN (1, 2, 3)
    AND (receiver = '100' OR receiver = '200')
    AND messages_0.description LIKE '%'+items.name+'%'
union all
SELECT messageId, receiver, createdDate, itemId  from messages_1,items WHERE
    itemId IN (1, 2, 3)
    AND (receiver = '100' OR receiver = '200')
    AND messages_1.description LIKE '%'+items.name+'%' 
```

*注意：有两个消息表，因此联合所有*

**示例消息：**

```
messageId | receiver | createdDate       | description
--------------
1         | 100      | 2012/11/27 12:00  | The Dog is awesome
2         | 100      | 2012/11/27 13:00  | Now the Dog is boring
4         | 200      | 2012/11/27 11:30  | I have Wood :-) 
```

**示例项目：**

```
itemID | name 
--------------
1      | Dave
2      | Dog
3      | Wood 
```

**结果：**

```
messageId | receiver | createdDate      | itemId 
1         | 100      | 2012/11/27 12:00 | 2
2         | 100      | 2012/11/27 13:00 | 2
4         | 200      | 2012/11/27 11:00 | 3 
```

但是，我只需要显示每个项目一次。仅显示**最旧的行**（按 createdDate）。

**目标结果：**

```
messageId | receiver | createdDate      | itemId 
1         | 100      | 2012/11/27 12:00 | 2
4         | 200      | 2012/11/27 11:00 | 3 
```

如何在 SQL (Sybase) 中执行此操作？到目前为止，我一直在查看 group by（它只会返回一个 id）和某种子查询，但一直无法让任何工作！

**SQL小提琴：** [http ://sqlfiddle.com/#!6/76fce/8](http://sqlfiddle.com/#!6/76fce/8)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:44:58.510

如果我理解正确的话，这样的事情可能是一个开始。

```
SELECT
  t, messageId, receiver, createdDate, itemId 
FROM
  (
    SELECT 
      m.messageId, m.receiver, m.createdDate, m.t,
      i.itemId 
    FROM
      items i
      INNER JOIN (
        SELECT description, messageId, receiver, createdDate, 0 t FROM messages_0 
        UNION 
        SELECT description, messageId, receiver, createdDate, 1 t FROM messages_1
      ) m ON m.description LIKE '%' + i.name + '%' 
             AND m.receiver IN ('100', '200')
    WHERE
      i.itemId IN (1, 2, 3)
  ) data
WHERE
  createdDate = (
    SELECT MIN(createdDate) FROM (
      SELECT createdDate FROM messages_0 WHERE messageId = data.messageId AND data.t = 0
      UNION
      SELECT createdDate FROM messages_1 WHERE messageId = data.messageId AND data.t = 1
    )
  ) 
```

我会把索引放在

*   消息_0 / 消息_1
    *   (messageId, createdDate)
    *   （接收者、messageId、createdDate、描述）
*   项目
    *   （项目 ID，名称）

# javascript - 如何将onkeypress事件添加到IE中动态创建的输入框？

> ID：13593374
> 
> 赞同：0
> 
> 时间：2012-11-27T21:27:02.430
> 
> 标签：javascript, html

全部，我在 onclick 功能上添加输入框，如下所示

```
 HtmlContent =HtmlContent+  "<input id = '" + uid + "' onkeypress='DefaultEnterButton(event,&apos;imgGo&apos;)' class='jobCenterArea' type='text'   onkeydown='IsNumeric(" + uid + ")'  onclick ='getActiveElementId();' name='txtBoxSch_" + txtBoxCnt + "' />&nbsp;" +
            "<img src='/COSimages/BusPortal/custom-x.png'  alt='Close Icon' height='14' width ='14' onclick=' Remove_TextBox(" + uid + ")'/>&nbsp;"+htmllabel; 
```

上面的代码在 FF、chrome 和 safari 中运行良好，但在 IE [7 & 8] 中运行良好

我试过下面的代码，但不能在 IE 中工作

```
document.getElementById(uid).onkeypress = function(event){return DefaultEnterButton(event,'imgGo')}; 
```

[我想要实现的功能是，在用户输入关键字后，当他们按下回车键时，它不仅应该通过单击搜索按钮进入下一页] 有什么建议吗？

**更新** 解决方案正在替换`&apos;`为`&#39;`.

[http://www.digimantra.com/tips/how-to-display-apos-in-internet-explorer-ie/](http://www.digimantra.com/tips/how-to-display-apos-in-internet-explorer-ie/)

感谢大家的投入。

# c# - 没有字典的快速多键查找？

> ID：13593375
> 
> 赞同：1
> 
> 时间：2012-11-27T21:27:05.947
> 
> 标签：c#, linq, search, .net-4.0, lookup

我有一个 Id 映射缓存，它占用了太多内存。它用于容纳对象的 3 种不同类型的 Id 的组合，并且它们的映射从表中读取，并缓存在 6 个不同的字典中，以便从任何一种 Id 类型快速查找/翻译到另一种（性能是对我的申请很重要）。

我想将它重写为内存占用更小的东西，所以我确实实现了 Id 的合并列表，并使用 linq/lambda 表达式来提取我想要的值。现在看起来像这样。

```
public struct IdMappings
{
     public int Id1;
     public int Id2;
     public int Id3;
}

//new cache    
private static List<IdMappings> AllIdMappings = null;

//current cache implementation
private static Dictionary<int, int> Id1ToId2 = null;
private static Dictionary<int, int> Id1ToId3 = null;
//etc.

public static void FillCache(DataSet data)
{
     foreach (DataRow r in data.Tables[0].Rows)
     {
          //fill list and/or dictionaries with id's
     }
} 
```

示例查找将是：

```
public static int GetId2FromId1(int id1)
{
    return AllIdMappings.FirstOrDefault(m => m.Id1 == id1).Id2;
    //or
    return Id1ToId2[id1];
} 
```

这在减少内存使用方面满足了我的需求，但是查找的性能因此受到影响，所以我正在研究如何实现不同的东西。有没有办法进行多索引键或多键查找比遍历列表相对更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:37:40.067

是的，对列表进行排序并使用二分搜索（List<> 已经在 Find 方法中为您实现了这一点） 维护排序列表并在 O(logn) 中完成查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:39:10.737

一个潜在的性能改进可能是使用 a`Hashset<IdMappings>`而不是 a `List<IdMappings>`，但这主要有助于直接查找，而不是`FirstOrDefault`或多或少地按顺序迭代列表。

如果您的查找全部来自 ID1 -> ID2 和 ID3 方向，则可以使用 a`Dictionary<int, Tuple<int, int>>`作为键，这将从当前字典中消除 ID1 的额外值。

无论如何，缓存顾名思义就是用内存换取查找速度，所以我认为你不能大幅提高内存消耗。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:39:31.210

如果添加这三个字典：

```
private static Dictionary<int, IdMappings> Id1Lookup = null;
private static Dictionary<int, IdMappings> Id2Lookup = null;
private static Dictionary<int, IdMappings> Id3Lookup = null; 
```

并且字典值是相同的引用，它应该使用最少的内存，但保持与原始实现相同的查找速度。

如果我正在考虑这一点，这应该使用您的 6 字典解决方案的一半内存，但`List<IdMappings>`类型解决方案的两倍。

正如@SWeko 指出的那样，`IdMappings`需要`class`不是 a`struct`以确保使用引用指针而不是它的副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:41:23.440

可能你最好的选择是创建一个映射结构：

```
struct Mapping: IComparable<Mapping>
{
    private readonly int FromId;
    private readonly int ToId;
    public Mapping(int fid, int tid);
    // implement the IComparable.Compare method to compare FromId
} 
```

然后，为每个索引创建一个`List<Mapping>`，并对列表进行排序。然后，您可以使用`List.Find`来查找您想要的项目。

# coldfusion - cfscript 中的转储函数在哪里？

> ID：13593376
> 
> 赞同：2
> 
> 时间：2012-11-27T21:27:11.297
> 
> 标签：coldfusion, coldfusion-9

> **可能重复：**
> [如何在 cfscript 标签内执行 cfdump？](https://stackoverflow.com/questions/883585/how-to-do-a-cfdump-inside-a-cfscript-tag)

我是 Coldfusion 的新手，想知道是否有人知道在脚本块内访问函数的方法。我找不到从那里调用它的方法。

Adobe 为什么要删除它？还是他们现在只是将其称为其他名称？

抱歉 - 我知道这可能是非常基本的问题，但就像我说的我是新手。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T22:42:40.270

[cfdump](http://cfdocs.org/cfdump)的等效脚本是**[writeDump](http://cfdocs.org/writeDump) ()**。

cfoutput 和 cflog 使用了相同的模式，带有[writeOutput](http://cfdocs.org/writeOutput) () 和[writeLog](http://cfdocs.org/writeLog) () 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:45:02.187

**写转储（）**

**显然，在 ColdFusion 9 中，它已作为 writeDump() 添加，因此您应该能够从 cfscript 块中使用它。**

所以如果你有CF9，那你就没事了。

**如果您像我们一样使用不支持这个新引入的 writeDump() 函数的旧旧系统**，您可以为它编写一个包装器并将其放在所有文件都可以访问的地方。

这是我写的包装器，用于短期调试可以放在你正在处理的 cfc 文件上（尽管在你提交代码之前删除它 - 否则它只是一团糟），或者你可以把它放在全局的地方所以您可以从共享范围调用它。

这是您可以使用的包装函数的示例：

```
<cffunction name="dump" access="private" returntype="void" hint="dump wrapper">
    <cfargument name="stuffToDump" type="any" required="true" hint="what you want to dump">
    <cfargument name="abort" type="any" default="false" hint="abort after dump">
    <cfargument name="expand" type="any" default="false" hint="expand output">
    <cfdump var="#arguments.stuffToDump#" expand="#arguments.expand#">
    <cfif #arguments.abort# EQ 1>
        <cfabort>
    </cfif>
</cffunction> 
```

解决这个问题可能有更好的方法，但这是我目前使用的。

您可以将它（临时）放在您当前正在处理的 cfc 文件中，但显然不要将它提交到您的代码库，因为您不希望所有文件都具有转储功能。

或者，您可以将其永久放入 cfinclude 文件中，然后将其（再次 - 临时）包含到您正在调试的文件中。

我猜另一种选择是将它放在 Application.cfc 上。该文件有许多标准方法，但您也可以定义自己的附加方法以包含在其中。然后你的 dump() 函数在 APPLICATION 范围内可用。

Application.cfc 文件在这里有一个很好的信息页面。[http://www.bennadel.com/blog/726-ColdFusion-Application-cfc-Tutorial-And-Application-cfc-Reference.htm](http://www.bennadel.com/blog/726-ColdFusion-Application-cfc-Tutorial-And-Application-cfc-Reference.htm)

我什至看到它在服务器范围内使用，但绝不应该在生产代码上这样做。可以调试我想作为最后的手段，只要确保你记得删除它。

就我个人而言，我认为这两个选项可能都远非理想，而且很遗憾 Adob​​e 花了这么长时间才提供该功能的脚本替代方案。本来可以减轻很多痛苦。

但希望如果您使用的是 CF9，那么所有这些对您来说都无关紧要，您可以使用新的 writedump() 函数，现在他们终于添加了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:22:09.407

为了更清楚一点并提供一个例子：

```
<cfscript>
   SomeString = 'ABC';
   writeDump(SomeString);
</cfscript> 
```

彼得的回答是 100% 正确的。

# c# - 寻找 HttpUtility.ParseQueryString 替代品

> ID：13593377
> 
> 赞同：0
> 
> 时间：2012-11-27T21:27:12.653
> 
> 标签：c#, parsing, windows-runtime, query-string

Windows 运行时中是否有此方法的替代方法？

如果没有，是否有任何优雅的方法可以从 URL 解析查询字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:43:30.847

对于这个任务，Windows RT 中有一个 `WwwFormUrlDecoder.GetFirstValueByName()`方法。

[MSDN：WwwFormUrlDecoder](http://msdn.microsoft.com/en-us/library/windows/apps/windows.foundation.wwwformurldecoder)

# ruby-on-rails - 在 Ruby On Rails / PostgreSQL 中按日期对时间戳字段进行分组

> ID：13593381
> 
> 赞同：1
> 
> 时间：2012-11-27T21:27:32.177
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, activerecord, rails-postgresql

我正在尝试将以下代码转换为与 PostgreSQL 一起使用。

在进行了一些挖掘之后，我意识到 PostgreSQL 的 GROUP BY 比 MySQL 更严格（以一种好的方式），但是对于我的生活，我无法弄清楚如何重写这个语句来满足 Postgres。

```
def show
  show! do
    @recent_tasks = resource.jobs.group(:task).order(:created_at).limit(5)
  end
end

PG::Error: ERROR:  column "jobs.created_at" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...ND "jobs"."project_id" = 1 GROUP BY task ORDER BY created_at...
                                                         ^
: SELECT  COUNT(*) AS count_all, task AS task FROM "jobs"  WHERE "jobs"."deleted_at" IS NULL AND "jobs"."project_id" = 1 GROUP BY task ORDER BY created_at DESC, created_at LIMIT 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:03:19.937

您不能按顺序使用不在分组依据中的列。
你可以做类似的事情

```
@recent_tasks = resource.jobs.group(:task, :created_at).order(:created_at).limit(5) 
```

但它会改变结果

你也可以

```
@recent_tasks = resource.jobs.group(:task).order(:task).limit(5) 
```

或者

```
@recent_tasks = resource.jobs.group(:task).order('count(*) desc').limit(5) 
```

# cron - 安排一个 cron 作业在每个月的第一个、第二个和第三个星期二运行

> ID：13593382
> 
> 赞同：1
> 
> 时间：2012-11-27T21:27:40.540
> 
> 标签：cron, crontab

在为我拥有的三个脚本设置 cron 计划时，我希望得到一些帮助。我需要安排第一个脚本在每个月的第一个星期二运行，第二个脚本在每个月的第二个星期二运行，第三个脚本在每个月的第三个星期二运行。这是我到目前为止所拥有的。

```
# Run first script on the 1st Tuesday of every month at 9:00 AM
0 9 1,2,3,4,5,6,7 * 2 wget -q -O /dev/null http://site.com/first-script

# Run second script on the 2nd Tuesday of every month at 9:00 AM
0 9 8,9,10,11,12,13,14 * 2 wget -q -O /dev/null http://site.com/second-script

# Run third script on the 3rd Tuesday of every month at 7:00 AM
0 7 15,16,17,18,19,20,21 * 2 wget -q -O /dev/null http://site.com/third-script 
```

我相信这些脚本将在每个月的第一个、第二个和第三个星期二以及每个月的 1-21 日运行。看起来从我读到的星期几和天是一个 AND，是真的吗？

希望这可以通过 cron 实现，否则我将不得不改变是否在脚本本身内部运行脚本的决定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-07-25T13:36:36.063

如果您不想将日期检查逻辑直接放入脚本中，则可以让 cron 作业*shell 命令*部分在执行脚本之前检查星期几。

```
# Run first script on the 1st Tuesday of every month at 9:00 AM
0  9  1-7    *  *  [ "$(date '+\%a')" = "Tue" ] && wget -q -O /dev/null http://example.com/first-script

# Run second script on the 2nd Tuesday of every month at 9:00 AM
0  9  8-14   *  *  [ "$(date '+\%a')" = "Tue" ] && wget -q -O /dev/null http://example.com/second-script

# Run third script on the 3rd Tuesday of every month at 7:00 AM
0  7  15-21  *  *  [ "$(date '+\%a')" = "Tue" ] && wget -q -O /dev/null http://example.com/third-script 
```

如果*[ $(date '+\%a')" = "Tue" ]*条件成功，脚本将执行。% 符号必须用反斜杠转义，因为 cron 将 % 视为特殊字符。

因为一周有 7 天，所以每月的第一个星期二保证在 1-7 范围内，第二个在 8-14 范围内，第三个在 15-21 范围内。

要捕获第一个星期二，您**不能**这样做：

```
0  9  1-7  *  2 && wget -q -O /dev/null http://example.com/some-script 
```

...因为*1-7* (Day of Month) 和*2* (Day of Week) 实际上是**OR'd**。由于某种原因，Cron 对这两个字段的处理方式与其他字段不同。在上面的示例中，您的脚本最终将在 1-7 范围内每天运行，**并且**每周二运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-30T06:48:22.213

您可以将 cron 设置为：

00 09 1-7,8-14,15-21 * 2 /path/myscript

这将在第一个、第二个和第三个星期二的上午 9 点运行脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-26T09:12:05.350

他们是一个或。

它将在每个星期二*和*列出的日期运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-28T20:34:04.857

另一种方法是创建每周二运行**的主脚本**，验证周二是，那个小时相应地调用适当的辅助脚本。

```
0 7,9 * * 2 wget -q -O /dev/null http://site.com/main-script 
```

我希望这会有所帮助。

问候。

# actionscript-3 - AS3 - 如何将流视频保存到图像序列？

> ID：13593383
> 
> 赞同：0
> 
> 时间：2012-11-27T21:27:40.820
> 
> 标签：actionscript-3, flash, streaming

当我在我的 Flash 播放器 (AS3) 中流式传输视频（使用 RTMP）时 - 我看到的帧的颜色 [b] 有点 [/b] 与原始视频中的帧不同！

我想以某种方式将我在播放器中显示的帧保存到图像序列中，

这样我就可以检查它并了解我从流中显示的每一帧与原始视频中的原始帧之间的区别。

如何实现？（视频长 5 分钟，每秒 25 帧）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-08T06:32:40.037

首先，您应该在 fms 脚本上设置以下标志，它允许您访问流式视频或音频。

```
application.onConnect = function(client,....)
{
...
    client.audioSampleAccess = "/";
    client.videoSampleAccess = "/";

} 
```

其次在客户端，您可以使用 BitMapData.draw 方法从 VideoDisplayObject 捕获视频

```
 var snapshot:BitmapData = new BitmapData(video.width, video.height); 
    snapshot.draw(videoDisplay); 
```

# tsql - 试图逃跑！在 t-sql 字符串中

> ID：13593386
> 
> 赞同：0
> 
> 时间：2012-11-27T21:27:57.177
> 
> 标签：tsql

我怎么能逃脱呢？我收到一个解析错误，因为它正在读取 ! 从字面上看或某事

```
select [text] from someDB
where contains([text], '<![CDATA[') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:43:50.350

CONTAINS 旨在搜索单词。为此，您最好使用 LIKE ( `LIKE '%<![[]CDATA[[]%'`) 匹配。

# java - 等到线程优雅地结束

> ID：13593390
> 
> 赞同：0
> 
> 时间：2012-11-27T21:28:12.100
> 
> 标签：java, multithreading, runnable

我有这个代码：

```
public class JsoupParser {      
    ArrayList<CompanyInfo> arr = new ArrayList<CompanyInfo>();

    public JsoupParser() {}

    public ArrayList<CompanyInfo> parse(final String link) throws IOException {
        Runnable runnable = new Runnable() {
            public void run() {
                // Here I do some operations and then assign some value
                // to my `arr` ArrayList
            }
        };
        new Thread(runnable).start();

        return arr; // error here, as expected      
    }
} 
```

系统立即返回`arr`，此时是`null`。

我怎样才能`arr`只有在`Thread`完成后才能返回？我怎样才能知道，`Thread`已经完成了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:37:46.380

> 如何仅在 Thread 完成后返回 arr ？如何通知我，该线程已完成？

```
Thread parseThread = new Thread(runnable).start();

parseThread.join();

return arr; 
```

你的问题有字面上的答案，但 zmbq 的答案更适合你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:31:27.250

使用另一个线程的全部意义在于让它在您的主线程执行其他操作时运行。如果您希望您的`parse`方法在完成后返回数组，则不应启动另一个线程。

但是，由于我想您*确实*希望在后台进行计算，因此您需要做其他事情。你为什么不看看[AsyncTask](http://www.vogella.com/articles/AndroidPerformance/article.html)？这可能是您需要的。

# objective-c - 在 initWithNibName:bundle 期间创建一次性变量时未设置 IBOutlets：

> ID：13593395
> 
> 赞同：0
> 
> 时间：2012-11-27T21:28:36.837
> 
> 标签：objective-c, ios, xcode, xib, iboutlet

首先让我说我已经搜索过谷歌，虽然很多人都有类似的问题，但我没有看到任何与以下奇怪的行为和补救措施有关的东西。

我创建了一个 UIViewController 并将 nib 与几个 IBOutlets 关联。在尝试从另一个类中使用这个 nib 时，我发现在使用 initWithNibName:bundle: 实例化它之后，IBOutlets 仍然为零。

我确认它们已正确连接，是的，它们正在合成，但仍然没有。在进一步调查时，我将 initWithNibName 方法更改如下：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

        UIView *view = self.view;
        NSArray *subviews = self.view.subviews;
        NSLog(@"Loaded view containing %d subviews.", [subviews count]);

    }
    return self;
} 
```

令人难以置信的是，这里添加了三行，创建一次性变量和日志记录，使得 IBOutlets 正确连接并从外部工作。

我已经清理并重建并重新启动了我的机器，但是如果我删除这些行，它仍然会停止工作。我在这里真的很困惑，并担心我有某种伏都教工作，这会在我发货的那一刻破坏。关于可能发生什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:37:53.717

您误解了`initWithNibName:bundle:`它的作用以及何时`UIViewController`加载其笔尖。

该`initWithNibName:bundle:`方法记录要加载的 nib 的名称。它不会立即加载笔尖。

该`-[UIViewController view]`方法按需加载笔尖，`[self loadView]`必要时通过发送。的实现`-[UIViewController view]`基本上是这样的：

```
- (UIView *)view {
    if (_view == nil) {
        [self loadView];
        [self viewDidLoad];
    }
    return _view;
} 
```

所以如果你调用`self.view`你的`initWithNibName:bundle:`覆盖，那*将*导致视图控制器加载它的 nib。

但是，`self.view`从调用通常是不合适的`initWithNibName:bundle:`。视图控制器应该能够在没有其视图层次结构的情况下存在。

例如，假设用户正在运行您的应用程序并在多个视图控制器中导航，您通过将视图控制器推送到导航控制器来实现。然后用户切换到另一个应用程序一段时间。现在系统内存不足，因此它会杀死后台应用程序 - 包括您的应用程序。

当用户再次启动您的应用程序时，您的应用程序（如果做得好）应该尝试恢复用户的状态。这意味着使用推送视图控制器堆栈重新加载导航控制器。但只有顶视图控制器的视图在屏幕上可见。立即为所有隐藏的视图控制器重新加载视图会浪费时间、内存和电池。这就是每个视图控制器按需加载其 nib 的原因。

# html - Twitter Bootstrap：嵌套行 - 边框向下推动跨列

> ID：13593398
> 
> 赞同：0
> 
> 时间：2012-11-27T21:28:54.430
> 
> 标签：html, css, twitter-bootstrap

在下面的代码中，**跨度 #2 出现在跨度 #1 下方**，尽管列数与父跨度 (10) 中的相同。这是**因为嵌套行 ( `class="row well"`)**上的边框。

有没有一种优雅的方法可以在不向下推内容的情况下将边框应用于嵌套行。

我想根据嵌套跨度的位置和应用在嵌套跨度上应用上/左/下/右边框`box-sizing: border-box`会有所帮助，但是在减小浏览器的宽度时会出现问题，这也是一个丑陋的解决方案。

```
<div class="row">
  <div class="span2"> left menu </div>
  <div class="span10">
    <div class="row well">
      <div class="span5" style="background-color: #aca">
        #1
      </div>
      <div class="span5" style="background-color: #aac">
        #2
      </div>
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:39:02.460

不要把井放在行上，让它自己的容器..

```
<div class="row">
  <div class="span2"> left menu </div>
  <div class="span10">     
    <div class="well">
      <div class="row-fluid">
        <div class="span6" style="background-color: #aca">
          #1
        </div>
        <div class="span6" style="background-color: #aac">
          #2
        </div>
      </div>
    </div>
  </div>
</div> 
```

我用 class="row-fluid" 替换了 class="row" 因为 "row" 类使用严格的宽度，而 "row-fluid" 类使用百分比并且将保持 "span6" 类并排，即使有添加到其父级的额外填充和边框。

# android - 适用于 Android 的自定义相机应用程序：实时调整颜色

> ID：13593404
> 
> 赞同：3
> 
> 时间：2012-11-27T21:29:06.670
> 
> 标签：android, colors, camera

我正在考虑一个应用程序，它可以实时调整相机输入的色调/饱和度（整体色谱）。当前的手机（例如 Galaxy S3）是否足够强大，可以对实时摄像头图像进行实时颜色过滤/调整，还是我必须像我看到的大多数应用程序一样应用颜色偏移/图像处理后处理？

本质上，我需要将实时图像馈送转换为不同的色谱，并在“拍照”之前实时显示更新的图像。任何关于如何在“快照”之前实时执行此操作的反馈将不胜感激。

# asp.net - 如何在 ASP.NET 向导控件中显示多个下一个/上一个链接？

> ID：13593408
> 
> 赞同：1
> 
> 时间：2012-11-27T21:29:21.410
> 
> 标签：asp.net, .net, wizard

我正在使用 ASP.NET 向导控件的布局模板：

```
 <LayoutTemplate>
     <div style="position: relative; padding: 10px 10px 10px 10px; overflow: auto">
        <div class="wizsidebar">          
           <asp:PlaceHolder ID="sideBarPlaceHolder" runat="server" />
           <div style="clear: both">             
              <asp:PlaceHolder ID="navigationPlaceHolder" runat="server" />
           </div>
        </div>
        <div class="wizstep">
           <!-- Want navigation here... -->
           <asp:PlaceHolder ID="WizardStepPlaceHolder" runat="server" />
           <!-- ...and here -->

        </div>
     </div>
  </LayoutTemplate> 
```

我想让导航（下一个/上一个按钮）显示在每个步骤的顶部和底部，以及侧边栏中。向导控件可以做到这一点，还是我必须用自己的按钮模仿行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:09:40.917

只要您的按钮有 CommandName="MovePrevious" 和 CommandName="MoveNext" 它们就会导致导航

# ios-simulator - 使用仪器 uiautomation recorder 时是否可以关闭模 拟器？

> ID：13593409
> 
> 赞同：1
> 
> 时间：2012-11-27T21:29:35.720
> 
> 标签：ios-simulator, instruments, ui-automation, recorder

我目前正在使用 Xcode Instruments UIAutomation 为我的应用程序录制大量测试，我目前面临的问题是，如果我当时运行多个脚本甚至 1 个脚本但当前正在运行的模拟器只是崩溃。

每次测试脚本完成时是否有命令或任何其他方式关闭模拟器？

# windows-8 - 自动重复一个 MediaElement

> ID：13593411
> 
> 赞同：0
> 
> 时间：2012-11-27T21:29:47.540
> 
> 标签：windows-8, microsoft-metro

我正在尝试自动重复一个`MediaElement`. 我使用以下代码做到了这一点：

```
 <MediaElement Name="MainMedia" MediaEnded="MainMedia_MediaEnded_1" />

    private void MainMedia_MediaEnded_1(object sender, RoutedEventArgs e)
    {
        MainMedia.Position = TimeSpan.FromSeconds(0);
        MainMedia.Play();
    } 
```

但我想知道是否有更好的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T03:42:58.623

有一个属性叫做`IsLooping`。如果您将其设置为`true`它将自动重复媒体。

# sockets - 电子邮件中的倒数计时器图像 GIF

> ID：13593420
> 
> 赞同：38
> 
> 时间：2012-11-27T21:30:13.600
> 
> 标签：sockets, email, timer, gif, countdown

我最近收到了来自 Onnit Labs 的电子邮件，其中包含使用 gif 图像的电子邮件内的倒计时模块计时器。可以在此处查看电子邮件：[https ://www.onnit.com/emails/lastchance-historic/](https://www.onnit.com/emails/lastchance-historic/)

图片可以在这里看到：

[![在此处输入图像描述](../Images/38262766ce34e0e987e6d7bbbfd4d88c.png)](https://www.onnit.com/emails/_modules/timer/?end=2014-11-27+00:00:00&dark=1)

我调查了一下，似乎您可以使用 gifsockets 继续向动画 GIF 发送新帧，因为 GIF 没有指定在浏览器中加载时它有多少帧。它在 github 上：http: [//github.com/videlalvaro/gifsockets](http://github.com/videlalvaro/gifsockets)

我认为这很有趣，而且效果确实很酷。有没有人对如何实现这一点有任何其他见解？似乎他们在 Onnit 使用的那个似乎根据 URL 或图像末尾附加的日期更改了倒计时。

`onnit.com/emails/_modules/timer/?end=2012-12-27+00:00:00&dark=1`

我正在尝试完成相同的事情以发送电子邮件，但我有点难过。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-28T03:25:39.590

虽然可能`gifsockets`会起作用（我之前没有尝试过......），但在我查看图像时没有网络流量，而不是初始图像加载。我也看到它再次从 41 跳到 42。重新加载将其降至 39。

它似乎只是一个脚本，可以生成 60 帧动画并将它们发送给用户。这可能可以用任何语言完成。

以下是它在 php 中的实现方式：

[http://seanja.com/secret/countdown/](http://seanja.com/secret/countdown/)

![在此处输入图像描述](../Images/8860166710bb326c78f82deae278fbd3.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-11T12:56:55.867

我发现[http://sendtric.com/](http://sendtric.com/)是免费的，而且很容易集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-03T09:32:56.990

你可以试试[http://makedreamprofits.com/pt/](https://makedreamprofits.com/pt/)。这个倒计时不是为 gif 提供额外的内容，而是分成单独的图像，并且可以计数长达 20 分钟而不会增加太多流量。

PS Gmail 正在预缓存图像，因此无法无休止地为其提供新帧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-05T17:06:22.040

**我非常感谢 Sean Ja 的回答。（他应该得到更多的支持。）然后我想让代码更具可读性和可配置性（并支持透明 gif 上的文本并自动居中文本）：**

```
use Carbon\Carbon;
class CountdownGifHelper {

    const DELAY = 100; /* Why was this labeled as 'milliseconds' when it seems like a value of 100 here causes 1 frame to be shown per second? */
    const MAX_FRAMES = 120;

    /**
     * 
     * @param string $bgImg
     * @param \DateInterval $interval
     * @param array $fontArr
     * @param array $frames
     * @param array $delays
     * @param string $format
     */
    public function addFrame($bgImg, $interval, $fontArr, &$frames, &$delays, $format) {
        $image = imagecreatefrompng($bgImg); //Each frame needs to start by creating a new image because otherwise the new numbers would draw on top of old ones. Here, it doesn't really matter what the PNG is (other than for size) because it's about to get filled with a new color.
        $text = $interval->format($format);
        ob_start();
        imageSaveAlpha($image, true);
        $backgroundColor = $fontArr['backgroundColor'];
        imagefill($image, 0, 0, $backgroundColor); //https://stackoverflow.com/a/17016252/470749 was a helpful hint
        imagecolortransparent($image, $backgroundColor);
        $this->insertCenteredText($image, $fontArr, $text);
        //imagettftext($image, $font['size'], $font['angle'], $font['x-offset'], $font['y-offset'], $font['color'], $font['file'], $text);//this was the old way
        imagegif($image); //The image format will be GIF87a unless the image has been made transparent with imagecolortransparent(), in which case the image format will be GIF89a.
        $frames[] = ob_get_contents();
        ob_end_clean();
        $delays[] = self::DELAY;
    }

    /**
     * 
     * @param resource $image
     * @param array $fontArray
     * @param string $text
     */
    public function insertCenteredText(&$image, $fontArray, $text) {
        $image_width = imagesx($image);
        $image_height = imagesy($image);
        $text_box = imagettfbbox($fontArray['size'], $fontArray['angle'], $fontArray['file'], $text); // Get Bounding Box Size
        $text_width = $text_box[2] - $text_box[0];
        $text_height = $text_box[7] - $text_box[1];
        // Calculate coordinates of the text https://stackoverflow.com/a/14517450/470749
        $x = ($image_width / 2) - ($text_width / 2);
        $y = ($image_height / 2) - ($text_height / 2);
        imagettftext($image, $fontArray['size'], $fontArray['angle'], $x, $y, $fontArray['color'], $fontArray['file'], $text);
    }

    /**
     * 
     * @param int $timestamp
     * @param string $bgImg
     * @param array $fontArray
     * @return string [can be used by Laravel response()->make($gifString, 200, $headers)]
     */
    public function getAnimatedGif($timestamp, $bgImg, $fontArray) {
        $future_date = Carbon::createFromTimestamp($timestamp);
        $time_now = time();
        $moment = new \DateTime(date('r', $time_now));
        $frames = [];
        $delays = [];
        for ($i = 0; $i <= self::MAX_FRAMES; $i++) {
            $interval = date_diff($future_date, $moment);
            if ($future_date < $moment) {
                $this->addFrame($bgImg, $interval, $fontArray, $frames, $delays, '00 : 00 : 00');
                $loops = 1; //stay stuck on this frame
                break;
            } else {
                $this->addFrame($bgImg, $interval, $fontArray, $frames, $delays, '%H : %I : %S');
                $loops = 0; //infinite loop
            }
            $moment->modify('+1 second');
        }
        $animatedGif = new \App\Helpers\AnimatedGif($frames, $delays, $loops, 0, 0, 0);
        return $animatedGif->getAnimation();
    }

    /**
     * ONEDAY allow config via params
     * @param resource $image
     * @return array
     */
    public function getFontArray($image) {
        $fontArr = [
            'file' => resource_path('assets/fonts/Kanit-Regular.ttf'),
            'size' => 30,
            //'x-offset' => 5,
            //'y-offset' => 30,
            'color' => imagecolorallocate($image, 90, 90, 90), //gray
            'backgroundColor' => imagecolorallocate($image, 0, 0, 0), //white. Must match the arguments provided to AnimatedGif (such as 0,0,0).
            'angle' => 0,
        ];
        return $fontArr;
    }

} 
```

# jquery - 为用户 ID 添加规则

> ID：13593428
> 
> 赞同：0
> 
> 时间：2012-11-27T21:30:33.067
> 
> 标签：jquery

我有 1 个用于创建用户和更新用户的表单。他们还使用相同的 jQuery 验证代码，我想在某处添加一个 if 语句，以便如果设置了 ID 为 user_id 的隐藏字段，那么它会添加一个规则来验证该值是否为数字。我显然已经只需要在执行用户更新时才需要这样做。有任何想法吗？

# mysql - Tomcat中的context.xml没有数据库密码

> ID：13593431
> 
> 赞同：0
> 
> 时间：2012-11-27T21:30:37.863
> 
> 标签：mysql, tomcat, meta-inf

我有一个在 Tomcat 7 上运行的 servlet 应用程序，并希望在本地连接到 MySQL。

我的本地 MySQL 用户没有密码，为了方便起见，我希望保持这种密码。

但是，如果我不使用 in 下的属性`password`，它会尝试在没有用户名的情况下连接到数据库，即使我已经设置了它。`Resource``context.xml`

**没有密码如何连接？**

下面是我的 context.xml 文件，如果重要的话。

```
<?xml version="1.0" encoding="UTF-8"?>
<Context>
    <Resource
        name="jdbc/mysql"
        auth="Container"
        type="javax.sql.DataSource"
        maxActive="100"
        maxIdle="30"
        maxWait="10000"
        username="whirlwin"
        password="removeMe"
        driverClassName="com.mysql.jdbc.Driver"
        url="jdbc:mysql://localhost:3306/theDB?autoReconnect=true"/>
</Context> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:27:30.537

您是否尝试过为密码留下空字符串？

如果这没有帮助，请发布您`mysql -uwhirlwin -hlocalhost`从命令行运行的内容。

# r - stargazer() 用于具有奇点的模型

> ID：13593433
> 
> 赞同：1
> 
> 时间：2012-11-27T21:30:44.177
> 
> 标签：r, regression, sweave, knitr

我尝试使用`stargazer`包创建一个回归结果表。不幸的是`stargazer`，由于奇点而拒绝创建表。由于这些奇点来自具有多个层次的重叠因素，因此不容易避免。这就是为什么我正在寻找替代解决方案这是一个[改编自相关线程](https://stackoverflow.com/questions/9335621/r-calculate-robust-standard-errors-vcovhc-for-lm-model-with-singularities)
的工作示例 ：

```
library(sandwich)
library(stargazer)
set.seed(101)
dat<-data.frame(one=c(sample(1000:1239)),
            two=c(sample(200:439)),
            three=c(sample(600:839)),
            Jan=c(rep(1,20),rep(0,220)),
            Feb=c(rep(0,20),rep(1,20),rep(0,200)),
            Mar=c(rep(0,40),rep(1,20),rep(0,180)),
            Apr=c(rep(0,60),rep(1,20),rep(0,160)),
            May=c(rep(0,80),rep(1,20),rep(0,140)),
            Jun=c(rep(0,100),rep(1,20),rep(0,120)),
            Jul=c(rep(0,120),rep(1,20),rep(0,100)),
            Aug=c(rep(0,140),rep(1,20),rep(0,80)),
            Sep=c(rep(0,160),rep(1,20),rep(0,60)),
            Oct=c(rep(0,180),rep(1,20),rep(0,40)),
            Nov=c(rep(0,200),rep(1,20),rep(0,20)),
            Dec=c(rep(0,220),rep(1,20))) 
model <- lm(one ~ two + three + Jan + Feb + Mar + Apr + May + Jun + Jul + Aug + Sep + Oct + Nov +    Dec, data=dat)
summary(model)
stargazer(model) 
```

由于奇异点，我得到错误：下标越界。您对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T19:28:34.727

此问题已得到解决。较新版本的 stargazer（从 3.0 开始）对您的示例应该没有问题。

# networking - Visual Studio 2012 服务器资源管理器中的 SQL Server 2012 连接问题

> ID：13593437
> 
> 赞同：0
> 
> 时间：2012-11-27T18:35:53.983
> 
> 标签：networking, windows-8, sql-server, visual-studio-2012, sql-server-2012

我正在尝试通过 Visual Studio 2012 连接到安装在 Windows Server 2012 上的 SQL Server 2012，但在尝试通过服务器资源管理器连接时不断收到错误 25 connection string is not valid 消息。

我没有连接到域，但检查了远程连接是否已启用和端口 1433。我也可以通过远程桌面应用程序连接到主服务器。

我是 SQL Server 的新手，因此非常感谢任何建议。谢谢

前段时间我发布了关于堆栈溢出的问题，我在其中添加了一张图片：[Visual Studio 2012 Server Explorer 中的 SQL Server 2012 连接问题](https://stackoverflow.com/questions/13112497/sql-server-2012-connection-issues-in-visual-studio-2012-server-explorer)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T19:19:12.400

最常见的问题是在尝试连接到 SQL Express 安装时，除了服务器名称之外没有提供数据库实例名称。对于其他版本，您可以只提供服务器名称。

![在此处输入图像描述](../Images/af3f82908e1bdc89176304df215646e3.png)

# testing - 以任何定义的文件格式生成样本数据

> ID：13593439
> 
> 赞同：1
> 
> 时间：2012-11-27T21:31:14.770
> 
> 标签：testing

我们从客户那里收到特定文件格式的样本数据，以及我们的软件需要处理的一组数据规范。但提供的样本数据并未涵盖规范中提到的所有场景。这给测试带来了麻烦，并且很多时候该软件无法按照规范按预期工作。我们需要创建包含所有基于规范的数据组合的测试文件。

客户不会提供数据的所有组合，所以请不要去那里。

**我们正在寻找的是一种实用程序或一种方法来定义我们需要创建哪些数据以及该数据的格式。**

我已经四处搜索，唯一可用的实用程序（Spawner、forSQL、Red-Gate 等）仅针对生成数据的数据库，但生成分隔文件的 spawner 除外。

如果有人可以指导我正确的方向或提供具体的解决方案，可能是我没有搜索正确的术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:43:42.983

首先，排列可能是一个错误的问题。你可能想要组合测试之类的东西，除非你有一个非常小的数据集或者你有能力运行无数的测试用例。

尝试使用这些搜索短语（优先/排序）：

*   成对测试（请注意，大多数工具不仅仅是数据*对*）。
*   全对测试
*   组合测试生成
*   组合测试数据
*   测试数据生成器

或尝试查看这些工具（和类似工具）

*   [http://hexawise.com/?page_id=805/](http://hexawise.com/?page_id=805/)
*   [http://www.satisfice.com/tools.shtml](http://www.satisfice.com/tools.shtml)
*   [http://www.satisfice.com/blog/archives/53](http://www.satisfice.com/blog/archives/53)

其次，听起来您在这里遇到的问题不止一个：

*   客户没有提供您需要的东西。要么你责备他们没有做好你的工作（测试涉及创造性工作），要么他们是一个有风险的客户。不管怎样，这是你的问题。
*   您是否在进行严格的基于规范的测试？因为坦率地说，有时规范并不是为您的测试提供信息的最重要的、最终的规则。阅读： http: [//www.developsense.com/blog/2012/07/few-hiccupps/](http://www.developsense.com/blog/2012/07/few-hiccupps/)（请注意，规范仅属于“声明”启发式）

最后，应该警告您，针对成对覆盖（或任何特定类型的覆盖）可能会分散您对测试重要内容的注意力。为了完整起见，我建议阅读以下内容：

*   [成对测试（developsense 博客）- 关注“Postscript 2007”部分](http://www.developsense.com/pairwiseTesting.html "重点部分 后记 2007")
*   [成对测试：不是的最佳实践](http://www.testingeducation.org/wtst5/PairwisePNSQC2004.pdf "成对测试：不是的最佳实践")

# uml - 如何从代码生成 VP UML 10 中的 UML 用例图

> ID：13593440
> 
> 赞同：0
> 
> 时间：2012-11-27T21:31:16.960
> 
> 标签：uml

如何在 Visual Paradigm UML version10 中从代码生成逆向工程 UML 用例图？我已经能够使用即时反向功能生成序列图。我想以相同的方式生成用例诊断。任何帮助或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:31:47.503

用例图为您的系统提供了一个纯概念的、非常高级的视图。由于它们与代码处于完全不同的抽象级别，因此对用例进行自动逆向工程显然是不可能的。

# entity-framework - 使用 SaveChanges 的相同事务从 EF 调用 SP

> ID：13593450
> 
> 赞同：4
> 
> 时间：2012-11-27T21:31:43.863
> 
> 标签：entity-framework, stored-procedures, objectcontext

有人知道如何使用 objectContext SaveChanges 方法（EntityFramework 5）的相同事务调用 StoredProc 吗？

目标是应用对象更改并调用存储的 Proc，该 Proc 在 DB 上执行一些“魔术”，但是，如果出现问题（使用 SaveChanges 或 SP 执行），则根本不会提交任何更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T03:56:18.217

脚步：

1.  创建上下文
2.  从上下文中获取连接
3.  创建事务（TransactionScope）
4.  打开连接（将连接登记到在 3 中创建的环境事务中，并防止上下文关闭连接）
5.  做 SaveChanges()
6.  执行你的存储过程
7.  提交交易
8.  关闭连接

一些代码（MyContext 派生自 DbContext）：

```
using (var ctx = new MyContext())
{
    using (var trx = new TransactionScope())
    {
        var connection = ((IObjectContextAdapter)ctx).ObjectContext.Connection;
        try
        {
            ctx.Entities.Add(new MyEntity() { Number = 123 });
            ctx.SaveChanges();

            ctx.Database.ExecuteSqlCommand("INSERT INTO MyEntities VALUES(300)");
            trx.Complete();
        }
        finally
        {
            connection.Close();
        }
    }
} 
```

# java - 在迭代简单的二维数组时提高缓存性能？

> ID：13593453
> 
> 赞同：4
> 
> 时间：2012-11-27T21:32:03.707
> 
> 标签：java, c, caching

我一直在想一种方法来重写下面的代码以提高数组中的缓存性能（通过减少缓存中的未命中）。

我知道数组逐行（按顺序）存储在内存中，所以 ary[0][0], ary[0][1], ary[0][2],....ary[1] [0]、ary[1][1]、ary[1][2]...ary[50][0]、ary[50][1]...ary[50][50]。但是，我不确定如何使用此信息来帮助我弄清楚如何修改循环以提高缓存性能。

```
for (c = 0; c < 50; c++)
    for (d = 0; d < 50; d++)
        ary[d][c] = ary[d][c] + 1; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:35:05.693

如果要一次访问一行的所有单元格，只需反转两个循环：

```
for (d = 0; d < 50; d++)
    for (c = 0; c < 50; c++)
        ary[d][c] = ary[d][c] + 1; 
```

甚至

```
for (d = 0; d < 50; d++)
    int[] array = ary[d];
    for (c = 0; c < 50; c++)
        array[c] = array[c] + 1; 
```

但我怀疑它会产生任何重大影响，甚至根本不会产生任何影响，尤其是在如此小的阵列上。使您的代码简单易读。不要预先优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T21:36:38.047

交换循环顺序。您正在访问`arr[1][0]`之后`arr[0][0]`。`arr[1][0]`远得多，而`arr[0][1]`在下一个地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:45:10.167

您希望最大限度地减少缓存未命中的数量以提高性能。每次缓存未命中都会导致内存访问并将新块加载到缓存中。此块不仅包含您需要的值，还包含内存中的其他相邻值。您需要利用局部性原则，即尽可能多地使用来自每个内存访问的值。就像您在观察中提到的那样，数组在内存中逐行存储，因此以顺序方式遍历数组将最大限度地减少缓存未命中的数量。回到你的代码，或者交换循环顺序：

```
for (d = 0; d < 50; d++)
    for (c = 0; c < 50; c++)
        ary[d][c] = ary[d][c] + 1; 
```

或交换计算中的指数：

```
for (c = 0; c < 50; c++)
    for (d = 0; d < 50; d++)
        ary[c][d] = ary[c][d] + 1; 
```

您甚至可以将 2D 数组视为 50*50 大小的 1D 数组，只需使用单个 for 循环从头到尾扫描它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:57:08.370

除了交换循环之外，您可能不需要做任何事情，因为缓存旨在自行利用代码中的引用局部性，这意味着它将缓存第一个元素以及随后的几个元素（空间局部性）从数组中提取并将它们保留在缓存中一段时间​​（时间局部性）。

然而，一些编译器允许你控制缓存，例如 gcc 有 [__builtin_prefetch](http://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html) 可以让你控制哪些数据应该被预取以及是否应该留在缓存中。

> — 内置函数：void __builtin_prefetch (const void *addr, rw, locality)
> 
> 此功能用于通过在访问数据之前将数据移动到缓存中来最小化缓存未命中延迟。您可以将对 __builtin_prefetch 的调用插入到您知道内存中可能很快会被访问的数据地址的代码中。如果目标支持它们，则会生成数据预取指令。如果预取在访问之前足够早地完成，那么数据将在访问时位于缓存中。

手册给出了这个例子：

```
for (i = 0; i < n; i++)
{
  a[i] = a[i] + b[i];
  __builtin_prefetch (&a[i+j], 1, 1);
  __builtin_prefetch (&b[i+j], 0, 1);
  /* ... */
} 
```

# apache - 为什么 mod_spdy 需要 Apache 2.2.4+？

> ID：13593454
> 
> 赞同：2
> 
> 时间：2012-11-27T21:32:06.250
> 
> 标签：apache, spdy

系统要求

*   **阿帕奇 2.2 (≥2.2.4)**
*   启用 mod_ssl

请参阅[https://developers.google.com/speed/spdy/mod_spdy/](https://developers.google.com/speed/spdy/mod_spdy/)

# c++ - std::bind 不适用于 1 个参数

> ID：13593457
> 
> 赞同：-1
> 
> 时间：2012-11-27T21:32:26.003
> 
> 标签：c++, c++11, std

添加占位符时遇到了一些问题`std::bind`我的代码有点大，所以我会坚持要领

```
#define GETFUNC(a) (std::bind(&app::a, this, std::placeholders::_1))
class button{
button(<other parameters here>, std::function<void(int)>) { ... }
..
std::function<void(int)> onhover;
..
};

class app{
app(){
elements.push_back(buttonPtr( new button(<other parameters>, GETFUNC(onHover) );
..
typedef std::unique_ptr<button> buttonPtr;
std::vector<buttonPtr> elements;
..
void onHover(int i) {}
} 
```

那段代码失败了`std::bind`（我从[错误日志](http://pastebin.com/htD8CTKW)中得到了这么多），但如果我改变它就可以工作：

*   全部`std::function<void(int)>`到`std::function<void()>`
*   `onHover(int i)`到`onHover()`
*   `std::bind(&app::a, this, std::placeholders::_1)`到`std::bind(&app::a, this)`

关于为什么会发生这种情况以及如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:59:02.603

它工作正常。检查此项并查找与您的代码的差异。

```
#include <functional>
#include <iostream>

struct app
{
  std::function<void (int)>
  get_func ()
  {
    return std::bind (&app::on_hover, this, std::placeholders::_1);
  }

  void on_hover (int v)
  {
    std::cout << "it works: " << v << std::endl;
  }
};

int
main ()
{
  app a;

  auto f = a.get_func ();
  f (5);
} 
```

# namespaces - 响应状态 xmlns d2p1

> ID：13593459
> 
> 赞同：5
> 
> 时间：2012-11-27T21:32:39.567
> 
> 标签：namespaces, servicestack, response, xml-namespaces

问题是：如何使用一个命名空间进行响应，在使用`IHasResponseStatus`和`public ResponseStatus ResponseStatus { get; set; }`属性时，并删除前缀 d2p1 on `ResponseStatus`。

`http://schemas.tagway.com.ua/types`我为所有 Web 服务模型使用一个命名空间；响应看起来不错，除了节点 ResponseStatus，因为 ServiceStack：它会自动为 ResponseStatus 添加自己的命名空间`xmlns:d2p1="http://schemas.servicestack.net/types"`。

服务模式：

```
namespace NTPCore.ServiceModel.Operations.Balance
{
    public class Balance
    {
        public Auth auth { get; set; }    
    }

    public class BalanceResponse : IHasResponseStatus
    {
        public ResponseStatus ResponseStatus { get; set; }
        public int balance { get; set; }
        public int limit { get; set; }
    }
} 
```

NTPCore.ServiceModel 项目中的 AssemblyInfo.cs：

```
[assembly: ContractNamespace("http://schemas.tagway.com.ua/types",    ClrNamespace = "NTPCore.ServiceModel.Operations.Balance")]
[assembly: ContractNamespace("http://schemas.tagway.com.ua/types",    ClrNamespace = "ServiceStack.ServiceInterface.ServiceModel")]             //may be this not need...experimenting, nothing happance for me 
```

示例响应：

```
<BalanceResponse xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.tagway.com.ua/types">
  <ResponseStatus xmlns:d2p1="http://schemas.servicestack.net/types">
    <d2p1:ErrorCode>String</d2p1:ErrorCode>
    <d2p1:Errors>
      <d2p1:ResponseError>
        <d2p1:ErrorCode>String</d2p1:ErrorCode>
        <d2p1:FieldName>String</d2p1:FieldName>
        <d2p1:Message>String</d2p1:Message>
      </d2p1:ResponseError>
    </d2p1:Errors>
    <d2p1:Message>String</d2p1:Message>
    <d2p1:StackTrace>String</d2p1:StackTrace>
  </ResponseStatus>
  <balance>0</balance>
  <limit>0</limit>
</BalanceResponse> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:39:05.537

[ServiceStack](http://www.servicestack.net/)利用 .NET 的内置 XML DataContractSerializer 进行 XML 序列化。不幸的是，`[assembly: ContractNamespace ..]`要产生效果，您需要使用`[DataContract]`和`[DataMember]`属性来装饰您的 DTO。例如：

```
[DataContract]
public class Balance
{
    [DataMember]
    public Auth auth { get; set; }    
}

[DataContract]
public class BalanceResponse : IHasResponseStatus
{
    [DataMember]
    public ResponseStatus ResponseStatus { get; set; }

    [DataMember]
    public int balance { get; set; }

    [DataMember]
    public int limit { get; set; }
} 
```

这很丑，但这是为漂亮的 XML 付出的代价，另一种选择是用您自己的自定义序列化/反序列化例程[覆盖内置的 XML Content-Type](http://www.servicestack.net/ServiceStack.Northwind/vcard-format.htm) - 但这需要更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-14T09:18:12.793

```
[CollectionDataContract(Name = "root", ItemName = "row")] 
```

# c++ - 将整数转换为 char* c++

> ID：13593461
> 
> 赞同：0
> 
> 时间：2012-11-27T21:32:42.653
> 
> 标签：c++, string, char

这是我拥有的函数，“Sprite”是程序中的一个对象，“GetSpriteAtPosition”只是返回一个指向坐标处正确精灵的指针。

我的问题是我在每个精灵中存储了一个字母，以整数的形式。0 是 a，25 是 z，分别介于两者之间。我需要我的函数返回一个 char*，它给我一行精灵的字母，所以如果在程序中精灵拼出“abcdefgh”，那么这就是我需要这个函数打印出来的。有一个 8x8 的精灵网格，我得到了正确的坐标，但是我得到一个错误，我无法在标记的行中将 int 转换为 char*。我该怎么做才能让它发挥作用？

提前致谢！

```
char* RowLetters(int row)
{
    char* pointer;
    for( int i = 0; i < 8; i++)
    {
        Sprite* selectedSprite = SpriteAtPosition(row*50, i * 50);
        if(selectedSprite != NULL)
        {
            char* temp = (char)(selectedSprite->Frame() + 97); //error here
            pointer = strcat(pointer, temp);
        }
        else
        {
            pointer = strcat(pointer, "test");
        }
    }
    return pointer;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:34:24.883

试试这个：

```
 char temp = (char)(selectedSprite->Frame() + 97);
        pointer = strcat(pointer, &temp); 
```

我已将变量更改为标准`char`而不是指针，然后将引用传递给`strcat()`运算`&`符。

**编辑：**

正如评论中指出的那样，这不起作用，因为`&temp`不是 NULL 终止的。当我通过执行以下操作编写更多 C 语言时，我曾经解决过这个问题。

```
 char temp[2];
        temp[0] = (char)(selectedSprite->Frame() + 97);
        temp[1] = '\0';
        pointer = strcat(pointer, temp); 
```

当然，`temp`可以在`for()`循环之外声明数组以获得更好的性能（理论上）。

这些都没有解决代码的其他问题，比如`pointer`从未被声明过。我认为对调用函数的更广泛理解是为了确定是`pointer`应该在这个函数中分配还是由调用者传入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:41:06.857

您编写的代码将具有未定义的行为，因为`pointer`未初始化，并且未指向您分配的任何有效内存（以保存行中适当长度的字母。

如果这确实是 C++，正如您所说，那么您不想`char*`从该函数返回 a，因为这意味着您已经在该函数中分配了一个静态字符串（yuck），或者您将动态分配字符串该函数和调用者必须释放它（恶心）。

这些选项都不是理想的。

我建议一个非常简单的更改来返回 a `std::string`，如下所示：

```
std::string RowLetters(int row)
{
    std::string pointer;
    for( int i = 0; i < 8; i++)
    {
        Sprite* selectedSprite = SpriteAtPosition(row*50, i * 50);
        if(selectedSprite != NULL)
        {
            pointer.push_back((char)(selectedSprite->Frame() + 97));
        }
        else
        {
            // ???
            // pointer = strcat(pointer, "test");
        }
    }

    return pointer;
} 
```

# php - Mysqli, fetch->fileld 类型为 bind_param 类型

> ID：13593462
> 
> 赞同：0
> 
> 时间：2012-11-27T21:32:42.913
> 
> 标签：php, mysqli, sqldatatypes

我正在使用一个 php 类生成器。基本上它在mysql中获取指定的表并相应地生成类。你会明白的：

```
....
$sql_r = mysqli_query($sql_conn, "select * from $sql_table;");
$sql_Fs = $sql_r->fetch_fields();
?>
<pre class="php">
    &lt;?php
    class <?php echo $sql_table; ?>{
        <?php foreach($sql_Fs as $sql_f) echo "var ".$sql_f->name."; "; ?>

        function sql_insert(){
            $sql_conn = sql_conn();
            $sql_stmt =$sql_conn->prepare("INSERT INTO <?php echo $sql_table; ?> (<?php foreach($sql_Fs as $K=>$sql_f){ if($K>1){ echo ", ";} if($K>0){ echo $sql_f->name; }} ?>) VALUES (<?php foreach($sql_Fs as $K=>$sql_f){ if($K>1){ echo ", "; } if($K>0) {echo "?"; }} ?>)");

            $sql_stmt->bind_param('', <?php foreach($sql_Fs as $K=>$sql_f){ if($K>1){ echo ", "; } if($K>0){ echo "\$this->".$sql_f->name; }} ?>);
                                 //^^^^ Need data type

            if(!$sql_stmt->execute()){ error_log($sql_stmt->error); $R = false; }else{ $R = true; }
            $sql_stmt->close(); $sql_conn->close(); return $R;
        }
        ..... 
```

我卡住的地方是设置 bind_param 数据类型。我发现你可以得到`fetch_field->type`它，它会给你一个类型的数值（参见[http://php.net/manual/en/mysqli-result.fetch-field.php](http://php.net/manual/en/mysqli-result.fetch-field.php)）。

有没有办法直接获取数据类型对应的字母？(s,i,d,b) 还是我真的需要创建一个函数来从数字 (fetch_field->type) 转换为相应的字母？

仅供参考：目前它输出如下内容：

```
function sql_insert(){
    $sql_conn = sql_conn();
    $sql_stmt =$sql_conn->prepare("INSERT INTO user (flag, name, mail, pass) VALUES (?, ?, ?, ?)");
    $sql_stmt->bind_param('', $this->flag, $this->name, $this->mail, $this->pass);
    if(!$sql_stmt->execute()){ error_log($sql_stmt->error); $R = false; }else{ $R = true; }
    $sql_stmt->close(); $sql_conn->close(); return $R;
} 
```

我知道它不完整，但这是另一个问题；）干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:31:07.857

我在这里发布我的解决方案，以防它可以帮助某人。

您可以通过查询您的数据库的示意图来获取 clomun y 的数据类型，如下所示：

```
SELECT
    COLUMN_NAME,
    DATA_TYPE,
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE table_name = '$sql_table' 
AND table_schema = '$sql_database'; 
```

您可以从此查询中获得一些其他有趣的信息：

```
IS_NULLABLE
CHARACTER_MAXIMUM_LENGTH
COLUMN_KEY 
```

官方文档：[http ://dev.mysql.com/doc/refman/5.0/en/columns-table.html](http://dev.mysql.com/doc/refman/5.0/en/columns-table.html)

# prototypejs - 带有 cookie 和 Prototype.js 的跨站点 Ajax.Request

> ID：13593464
> 
> 赞同：2
> 
> 时间：2012-11-27T21:32:51.657
> 
> 标签：prototypejs, cross-site

我需要告诉`Ajax.Request`（从`Prototype.js`）设置`xhr.transport.withCredentials`为`true`（在我的跨站点请求标头中启用 cookie）。我尝试失败：

```
Ajax.Request('http://otherSubdomain.host:port/', {
    onCreate: function(request){
        request.transport.withCredentials = true;
    }
}); 
```

`Access-Control-Allow-Origin`已设置且`request`成功，但未**发送任何 cookie**。

我不想指出，但使用`jquery` here is an似乎要容易得多`**[example solution](https://stackoverflow.com/questions/2054316/jquery-sending-credentials-with-cross-domain-posts)**`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T08:05:06.817

尝试`Ajax.Request`像这样修补：

```
Ajax.Request.prototype.request = Ajax.Request.prototype.request.wrap(function(request, url) {
  if (this.options.withCredentials) {
    this.transport.withCredentials = true;
  }
  request(url);
}); 
```

然后你会有额外的选择`withCredentials`：

```
new Ajax.Request('example.com', {
    withCredentials: true
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-21T09:06:55.297

稍微改进了维克多的答案。

修复了 IE 中需要在“打开”和“发送”之间设置 withCredentials 并使其与 jQuery ajax 选项一致的问题。

```
Ajax.Request.prototype.setRequestHeaders = Ajax.Request.prototype.setRequestHeaders.wrap(function(setHeaders) {
  setHeaders();
  if (this.options.xhrFields) Object.extend(this.transport, this.options.xhrFields);
}); 
```

然后使用它：

```
new Ajax.Request('example.com', {
  xhrFields: {
    withCredentials: true
  }
}); 
```

# javascript - jQuery - 如果禁用 Javascript 怎么办？

> ID：13593468
> 
> 赞同：1
> 
> 时间：2012-11-27T21:33:10.387
> 
> 标签：javascript, jquery

我在 CSS 和一些 jQuery 中有一些元素，`display:none;`它们会延迟淡入淡出。

如何处理关闭了 javascript 的浏览器？有没有办法`<noscript>`改变这些元素的显示值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:34:42.120

没有脚本就无法设置 CSS 值，但可以将默认值设置为可见状态，并且在脚本中执行的第一件事是立即将元素设置为不可见状态，然后再将其淡化。

您还可以查看不需要 JavaScript的 CSS 动画[http://www.w3.org/TR/css3-animations/ ，但它们确实需要现代风格的浏览器](http://www.w3.org/TR/css3-animations/)[http://caniuse.com/css-animation](http://caniuse.com/css-animation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:40:50.850

如果您使用modernizr，它会将类插入`js`到您的`<html>`标签中（当然，如果Javascript正在运行），并且具有HTML5样板文件提出的html结构：

```
<!--[if lt IE 7 ]> <html class="no-js ie6 ie"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7 ie"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8 ie"> <![endif]-->
<!--[if IE 9 ]>    <html class="no-js ie9 ie"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html class="no-js">
<!--<![endif]--> 
```

默认情况下，您将拥有`<html class="no-js">`，并且您可能会在您的 css 中包含某些东西（您担心被暴露，通常 JS 隐藏）默认使用它作为父选择器来隐藏它。

```
.no-js .whatever, .no-js .someOtherStuff { display: none; } <!-- just an example --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:46:00.650

设置 css 属性以显示元素，然后如果启用了 javascript，则使用 javascript 关闭/隐藏元素。但是，我不喜欢这样做，因为启用了 javascript 的用户数量远远超过了没有 javascript 的用户。您不想强迫大部分用户等待页面加载所有元素，然后在他们已经在内容达到峰值时隐藏它们。

您希望以您设计的方式实际使用您的网页的用户能够获得最佳体验。Web 的 javascript、jquery 和其他库功能如此丰富，以至于没有 javascript 的用户习惯于无法获得 Web 开发人员想要的体验。如果我觉得我真的对没有 javascript 的用户情有独钟，我会将他们重定向到静态页面。他们和网络爬虫将一起玩得开心。

# php - 42000 执行准备好的语句时查询中的语法错误

> ID：13593471
> 
> 赞同：3
> 
> 时间：2012-11-27T21:33:27.783
> 
> 标签：php, mysql, pdo, prepared-statement

我一直在努力将我当前的脚本换成 PDO。我已经简化了这个例子的 MySQL 查询，但即使是这个版本，错误仍然存​​在。

```
$sql = 'SELECT * FROM :table WHERE lastUpdate > :appDate';

try{
    $db = connect();
    $stmt = $db->prepare($sql);
    $stmt->bindParam(':table', $table);
    $stmt->bindParam(':appDate', $appDate);

    foreach($tablesToCheck as $table){
        $stmt->execute();
        $resultset[] = $stmt->fetchAll();
    }
} catch(PDOException $e){
    print 'Error!: '.$e->getMessage().'<br/>';
}//End try catch 
```

$stmt->errorInfo() 返回：

```
( [0] => 42000 [1] => 1064 [2] => You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the 
right syntax to use near ''GroupName' WHERE lastUpdate > NULL' at line 1 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:02:27.417

这是在迈克尔的帮助下修改后的代码：

```
foreach($tablesToCheck as $table){
    $sql = 'SELECT *, \''.$table.'\' AS tableName FROM '.$table.' WHERE lastUpdate > :appDate';

    try{
        $db = connect();
        $stmt = $db->prepare($sql);
        $stmt->bindParam(':appDate', $appDate);
        $stmt->execute();

        while($row = $stmt->fetch(PDO::FETCH_ASSOC))
            $resultset[] = $row;

    } catch(PDOException $e){
        print 'Error!: '.$e->getMessage().'<br/>';
    }//End try catch
}//End foreach 
```

# javascript - 如何在使用相同 ID 的 5 个跨度上添加文本

> ID：13593473
> 
> 赞同：0
> 
> 时间：2012-11-27T21:33:31.780
> 
> 标签：javascript, jquery

如何向共享相同 ID 的所有 5 个跨度添加文本。

html去：

```
<div class="body">
<form>
<span id = "test" ></span>
<span id = "test" ></span>
<span id = "test" ></span>
<span id = "test" ></span>
<span id = "test" ></span>
</form>
</div> 
```

js：

```
function check_aff_payment(elem){

        $(elem).find('#test').each(function(){
            $("#test").text("*");
        });

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:37:05.137

**页面上的**ID**`HTML`必须是唯一的。**

 **尝试`class`改用

```
<div class="body">
   <form>
      <span class="test"></span>
      <span class="test"></span>
      <span class="test"></span>
      <span class="test"></span>
      <span class="test"></span>
   </form>
</div>

function check_aff_payment(elem){
    $(elem).find('.test').each(function(){
       $(this).text("*");
    });
} 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/wdy5P/1/)****

# sql-server - Sql Server 类似命令

> ID：13593477
> 
> 赞同：-3
> 
> 时间：2012-11-27T21:33:54.377
> 
> 标签：sql-server

我是 sql server 的新手，我想知道是否有一种方法可以使用 like 命令从第一个字母以 A 到 C 开头的字段中获取信息。例如说我有一个列 FIRST_NAME 和几个值：安东尼、比尔、查德、迈克、威尔。像我下面的代码这样的东西会拉回 ANTHONY、BILL、CHAD 还是这可能？

```
 SELECT *
 FROM TABLE_NAME
 WHERE FIRST_NAME LIKE '[A-D%]' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:37:37.797

```
WHERE FIRST_NAME LIKE '[A-L]%' 
```

# java - 让 Java 应用程序作为 Applet 或独立运行

> ID：13593478
> 
> 赞同：2
> 
> 时间：2012-11-27T21:33:56.363
> 
> 标签：java, swing, applet, compiler-errors

我编写了代码来驱动差动驱动机器人通过我选择的固定路径。我试图让代码从命令行运行：java StartRobot 或者能够在浏览器中运行应用程序和 Applet。我的代码如下：

```
import java.awt.*;
import javax.swing.*;
import java.util.ArrayList;
import java.util.List;

class DifferentialDriveRobot {

public static void main(String[] args) {
    new DifferentialDriveRobot();
}

public DifferentialDriveRobot() {
    EventQueue.invokeLater(new Runnable() {
        @Override
        public void run() {
            createAndShowGUI();
        }
    });
}

public void createAndShowGUI() {
    JFrame frame = new JFrame("Differential Drive Robot");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setLayout(new BorderLayout());
    Robots robots = new Robots();
    frame.add(robots);
    frame.setSize(400,400);
    frame.setVisible(true);

    new Thread(new Drive(robots)).start();
}

public static int random(int maxRange) {
    return (int) Math.round((Math.random() * maxRange));
}

public class Robots extends JPanel {
    private List<Bot> robots;

    public Robots() {
        robots = new ArrayList<Bot>(1);
        robots.add(new Bot(Color.red));
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D) g.create();
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        for(Bot robot : robots) {
            robot.paint(g2d);
        }
        g2d.dispose();
    }

    public List<Bot> getRobots() {
        return robots;
    }
}

public class Drive implements Runnable {
    private Robots parent;

    public Drive(Robots parent) {
        this.parent = parent;
    }

    @Override
    public void run() {
        int width = getParent().getWidth();
        int height = getParent().getHeight();
        for(Bot robot : getParent().getRobots()) {
            int x = 5;
            int y = 5;
            int diameter = robot.getDiameter();
            if(x + diameter > width) {
                x = width - diameter;
            }
            if(y + diameter > height) {
                y = height - diameter;
            }
            robot.setX(x);
            robot.setY(y);
        }

        while(getParent().isVisible()) {
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    getParent().repaint();
                }
            });
            for(Bot robot : getParent().getRobots()) {
                move(robot);
            }

            try {
                Thread.sleep(100);
            } catch(InterruptedException ex) {}
        }
    }

    public Robots getParent() {
        return parent;
    }

    public void move(Bot robot) {
        int diameter = robot.getDiameter();
        double v1 = robot.getV1();
        double v2 = robot.getV2();
        double x = robot.getX();
        double y = robot.getY();
        double theta = robot.getTheta();
        double dx, dy, dtheta;
        int time = robot.getTime();

        dx = 0.5*(Math.cos(Math.toRadians(theta)))*(v1+v2);
        dy = 0.5*(Math.sin(Math.toRadians(theta)))*(v1+v2);
        dtheta = (-1)*(0.5*(v2-v1));

        if((x + dx < 0 || x + diameter + dx > getParent().getWidth()) || (y + dy < 0 || y + diameter + dy > getParent().getHeight())) {
            v1 = 0;
            v2 = 0;
        } else {
            if(time == 50) {
                v2 = 0;
            } else if(time > 50 && time < 300 && theta == 89.5) {
                v1 = v2 = 1;
            } else if(time > 300 && time < 450) {
                v1 = 1;
                v2 = 3;
            }
            if(time > 400 && theta == -89.0 && time < 500) {
                v1 = 5;
                v2 = 5;
            }
            if(time > 500 && time < 550) {
                v1 = v2 = 0;
            } else if(time > 550 && time < 600) {
                v1 = v2 = -2;   
            } else if(time > 600) {
                v1 = v2 = 0;
            }
        }

        x = x + dx;
        y = y + dy;
        theta = theta + dtheta;
        time = time + 1;
        robot.setTheta(theta);
        robot.setV1(v1);
        robot.setV2(v2);
        robot.setX(x);
        robot.setY(y);
        robot.setTime(time);
    }
}

public class Bot {
    private Color color;
    private double x, y;
    private int diameter;
    private double v1, v2;
    private double theta;
    private int time;

    public Bot(Color color) {
        setColor(color);
        v1 = 1;
        v2 = 1;
        diameter = 30;
        theta = 0;
        time = 0;
    }

    public int getTime() {
        return time;
    }

    public void setTime(int time) {
        this.time = time;
    }

    public int getDiameter() {
        return diameter;
    }

    public void setColor(Color color) {
        this.color = color;
    }

    public void setX(double x) {
        this.x = x;
    }

    public void setY(double y) {
        this.y = y;
    }

    public void setTheta(double theta) {
        this.theta = theta;
    }

    public Color getColor() {
        return color;
    }

    public double getX() {
        return x;
    }

    public double getY() { 
        return y;
    }

    public double getV1() {
        return v1;
    }

    public double getV2() {
        return v2;
    }

    public double getTheta() {
        return theta;
    }

    public void setV1(double v1) {
        this.v1 = v1;
    }

    public void setV2(double v2) {
        this.v2 = v2;
    }

    protected void paint(Graphics2D g2d) {
        double x = getX();
        double y = getY();
        double v1 = getV1();
        double v2 = getV2();
        g2d.rotate(Math.toRadians(theta),x,y);
        g2d.setColor(getColor());
        g2d.fillRect((int)x, (int)y, getDiameter(), getDiameter());
        g2d.setColor(Color.black);
        g2d.fillOval((int)x+9,(int)y-5,15,15);
        g2d.fillOval((int)x+9,(int)y+20,15,15);
    }
}
} 
```

在过去，我可以通过将以下内容添加到我的 .java 文件中来完成此操作：

```
public class StartRobot extends JApplet {

public void init() {
EventQueue.invokeLater(new Runnable() {
    public void run() {
        DifferentialDriveRobot panel = new DifferentialDriveRobot();
        getContentPane.add(panel);
    }
});
}

public static void main(String[] args) {
    //Schedule a job for the event-dispatching thread:
    //creating and showing this application's GUI.
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {
    DifferentialDriveRobot panel = new DifferentialDriveRobot();
            panel.createAndShowGUI();
        }
    });
}
} 
```

但是，这会在编译时引发错误。我认为这是因为我的主类DifferentialDriveRobot 没有扩展JPanel，而是我完成此操作的子类。有没有快速解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:18:25.083

该类`DifferentialDriveRobot`是不能添加到小程序的非组件类。它是一个导致`JFrame`创建并添加您的`Robot`面板类的类。如果您在浏览器中运行小程序，这将导致`JFrame`出现 ，这通常是不可取的。

您可以将类定义`Robot`为您的小程序：

```
public class Robot extends JApplet {

  public void init() {
     ...
  } 
```

然后将小程序添加到您的`main`方法中：

```
public static void main(String[] args) {
   JFrame frame = new JFrame("Applet Demo");
   frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
   frame.setSize(500, 400);
   JApplet applet = new Robot();
   applet.init();
   applet.start();
   frame.add(applet);
   frame.setVisible(true);
} 
```

如果您希望小程序作为应用程序运行，一个不错的选择是将其完全转换为`JFrame`基于应用程序的应用程序并使用[Java Web Start](http://docs.oracle.com/javase/tutorial/deployment/webstart/index.html)进行部署。

# php - 在 PHP 网站应用程序中设置环境变量的“正确”方法？

> ID：13593482
> 
> 赞同：4
> 
> 时间：2012-11-27T21:34:17.487
> 
> 标签：php, environment-variables, lamp

我已经看到很多关于将硬编码的敏感信息（API 密钥字符串、数据库密码）作为安全环境变量保存的文章。我对这个概念有点陌生，虽然我已经看到了很多关于 rails 的内容，但在 PHP 方面并没有那么多。

甚至[PHP FOG](http://docs.phpfog.com/getting-started/env-vars)在为用户创建初始 mysql DB 信息时也使用这种类型的设置。

我真的不明白这是在哪里*设置*的，以及如何使用任何特定的 php 网页/应用程序检索它。我真的从诸如保持我的交易电子邮件 API 密钥和其他信息在多个页面中安全和可用的角度来看待这个问题。

例如，如果我只是创建一个 config.php 文件并将其放在我的站点根目录中，这与直接在我的代码中调用密钥有什么不同吗？应该在哪里设置环境变量以及调用它们的最有效方法是什么？我也很好奇这与 SESSION 变量有何不同？

注意：我正在运行一个与 Nginx 配对的 LAMP 堆栈。

更新 1： [其中一位用户](https://stackoverflow.com/questions/6554583/how-secure-is-storing-db-variables-with-setenv-or-in-php-ini)倾向于反对使用环境变量而只在“非公共”文件中使用，但我真的看不出这有什么不同。

更新 2：也发现了这篇文章，从 Windows 的角度来看，这似乎具有一般意义（假设 *nix 需要更改 php 包含路径？）。同样，这样做有什么好处，而不是直接将 API 密钥硬编码到 PHP 脚本中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:11:39.777

我想说这更像是一种系统集成，而不是与具体安全性相关。

环境变量可用于创建脚本运行的上下文。然后脚本本身将这些作为（隐藏的）依赖项。

因此，您可以在不同的环境（环境设置）中执行相同的脚本，而无需更改任何一行代码（包括但不限于）基于 php 的配置文件。

例如，当您自动部署脚本时，部署系统通常能够设置环境变量，因为原理是通用的。您不需要修改部署脚本，以便他们知道您的特定配置文件，以便他们可以更改它们。

从安全的角度来看，没有太大的区别。环境变量可以公开访问，也可以访问脚本内的全局变量。

# javascript - Javascript将文本插入div

> ID：13593483
> 
> 赞同：0
> 
> 时间：2012-11-27T21:34:19.190
> 
> 标签：javascript, dom, highlighting

这是[Removing <span> 标签的后续问题，同时保持内容完整，仅使用 javascript](https://stackoverflow.com/questions/7947763/removing-span-tag-while-leaving-content-intact-with-just-javascript)

如果我使用 span 突出显示页面中的文本，它会将内容分解为新节点。然后，当我使用 删除突出显示跨度时`replaceChild`，节点保持分离。我希望将原始文本合并回单个文本节点，而不是三个文本节点 - 突出显示开始之前的文本、之前突出显示的文本以及突出显示结束后的文本。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:38:48.110

你可以尝试类似的东西

```
 containerElement.innerHTML = containerElement.textContent; 
```

由于 textContent，不确定是否可以在 9 之前的 IE 上运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:49:36.357

类似于 Jim 的建议，但适用于 IE：

```
containerElement.innerHTML = containerElement.textContent || containerElement.innerText; 
```

或者更长的版本：

```
var text = containerElement.textContent || containerElement.innerText;

while (containerElement.firstChild) {
    containerElement.removeChild(containerElement.firstChild);
}
containerElement.appendChild(document.createTextNode(text)); 
```

我认为第一个更简单。

# mysql - 如果第一个和第二个字段匹配，则选择语句以输出值第二个表

> ID：13593484
> 
> 赞同：0
> 
> 时间：2012-11-27T21:34:20.967
> 
> 标签：mysql, sql

我不是世界上最伟大的 SQL 人，这个问题已经让我发疯了大约一个星期。

我有 3 张桌子。第一个是包含以下数据的属性表：

```
attr_group_table
attr_id   group    price  prefix   id
     4      2       20.00   +      5000
     1      2       30.00   +      5000

attr_table
attr_id   id    value_id   price   prefix
     1    5000        2     10.00    -
     4    5000        3     10.00    +
    13    5000        9     50.00    +

name_table
     id   name
     2    widget1
     3    widget2
     9    widget3 
```

所以基本上，我需要 attr_table 中与 ID 为 5000 匹配的所有项目。但是，如果这些项目存在于 attr_group_table 中且 group=2，则使用 attr_group_table 中的价格和前缀。然后只是吸一下名称表的名称。我需要返回的唯一数据是 attr_id、名称、价格和前缀。

我一直在处理连接、联合、if 的问题，只是无法获得我想要的数据。任何帮助/建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:50:55.360

```
SELECT
  attr_table.attr_id,
  name_table.name,
  case when attr_group_table.group=2
       then attr_group_table.price
       else attr_table.price end as price,
  case when attr_group_table.group=2
       then attr_group_table.prefix
       else attr_table.prefix end as prefix
FROM
  attr_table left join attr_group_table
  on attr.table.attr_id = attr_group_table.attr_id
  left join name_table on attr_table.attr_id = name_table.id
WHERE
  attr_table.id = 5000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:53:22.953

使用功能[COALESCE](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)：

```
SELECT 
  attr_table.attr_id, attr_table.id, attr_table.value_id, 
  COALESCE(attr_group_table.prefix, attr_table.prefix) prefix, 
  COALESCE(attr_group_table.price, attr_table.price) price,
  name_table.name
FROM attr_table 
  LEFT JOIN attr_group_table ON attr_table.attr_id=attr_group_table.attr_id
  LEFT JOIN name_table ON attr_table.value_id=name_table.id 
```

它将返回其参数的第一个非空值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:48:18.670

```
Select attr_table.attr_id,name,attr_group_table.price, attr_group_table.prefix
From attr_table join attr_group_table
On attr_table.attr_id = attr_group_table.attr_id
join name_table on name._table.id = attr_table.attr_id
Where attr_table.attr_id = 5000 and group = 2
Union
Select attr_table.attr_id,name,attr_table.price, attr_table.prefix
From attr_table join attr_group_table
On attr_table.attr_id = attr_group_table.attr_id
join name_table on name_table.id = attr_table.attr_id
Where attr_table.attr_id = 5000 and group <> 2 
```

# ios - Facebook iOS SDK 3.1 如何“点赞”一个事件？

> ID：13593489
> 
> 赞同：0
> 
> 时间：2012-11-27T21:34:33.477
> 
> 标签：ios, facebook, facebook-graph-api, facebook-like, facebook-ios-sdk

我正在尝试为 iPhone 制作一个应用程序，并且我正在使用[Facebook SDK 3.1](https://developers.facebook.com/docs/reference/ios/3.1/)来点赞一个我有 ID 的事件。

我正在查看 FB SDK 参考，唯一有意义的方法是使用[FBRequestConnection](https://developers.facebook.com/docs/reference/ios/3.1/class/FBRequestConnection)向 .../eventID/likes 发出 POST 请求，*如果我理解正确*的话，但我认为我遗漏了一些东西。我本来希望，因为“Like”是一个非常流行的操作，SDK 会以更容易的方式公开。

关于对 Graph API 的 POST 请求到 Like an Event，我的理解是否正确？还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:22:08.987

Facebook 上没有“喜欢”事件对象的概念。您需要喜欢有关创建事件的提要故事，您可以通过`POST`post_id/likes 连接来完成。

# php - 这个 PHP 进程是什么？它使我的服务器瘫痪

> ID：13593491
> 
> 赞同：1
> 
> 时间：2012-11-27T21:34:53.073
> 
> 标签：php, mysql

这个进程已经使用了我站点 CPU 的 65%，现在已经持续了大约 10 分钟（进程不应该只运行几秒钟吗？）

这显然与mysql有关。这是有道理的，因为我有很多查询，但有些东西似乎还是有点奇怪......

这可能与我在上一个问题中提到的不良 PDO 连接有关。也许我打开了太多的连接或类似的东西？

这是它的统计数据：

```
Owner: mysql
Priority: 0
CPU %: 61.1
Memory %: 0.4
Command:/usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --user=mysql --log-error=/var/lib/mysql/cvps54834319.myhost.com.err --pid-file=/var/lib/mysql/cvps54834319.myhost.com.pid 
```

感谢您对此的任何帮助。我的服务器上有超过 10GHZ，所以这对我来说非常令人担忧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:38:01.697

看看这个文件

```
/var/lib/mysql/cvps54834319.myhost.com.err 
```

你会看到发生了什么，什么不工作，是什么导致了这个问题

# python - 使用 haystack/elasticsearch 进行部分词搜索

> ID：13593492
> 
> 赞同：4
> 
> 时间：2012-11-27T21:34:56.020
> 
> 标签：python, elasticsearch, django-haystack

我们目前正在使用弹性搜索后端运行 haystack。我们无法正确运行部分单词搜索。

我们目前有一个具有 EdgeNgramField 的索引。我曾尝试在此字段上进行搜索，但除非完全匹配，否则我找不到任何结果。我正在尝试使用它来查找产品，例如：我输入“sun”，我不会得到“sunglasses”的结果。

我开始直接在 elasticsearch 上使用 curl 命令，看看我是否能弄清楚发生了什么。我什至直接使用 curl 以及 ngram 分析器创建了自己的索引，并且我使用部分单词搜索获得了正确的结果。

另一个有趣的事情是：如果我直接在我直接用 curl 创建的 elasticsearch 上使用 curl 在我的测试索引上运行 _mapping 命令，我会得到以下内容：“testfield”：{“type”：“string”，“analyzer”： “test_analyzer”}，但是，如果我在 haystack 创建的索引上运行映射命令，它只有“type”：“string”。它没有说明它应该使用的 edgengram_analyzer。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T01:59:18.123

我认为在 elasticsearch_backend.py 的 haystack 中有一个错误，它没有正确使用 pyelasticsearch 第 868 行看起来像：

```
self.conn.put_mapping('modelresult', current_mapping, index=self.index_name) 
```

如果您将其替换为：

```
self.conn.put_mapping(doc_type='modelresult', mapping=current_mapping, index=self.index_name) 
```

这就是 pyelasticsearch 所期望的，然后您将看到 edgengram_analyzer 已添加到您的 EdgeNgramField 字段中。至少它对我有用。

# java - IllegalAddException：使用 SAX 添加节点时没有这样的命名空间前缀

> ID：13593493
> 
> 赞同：2
> 
> 时间：2012-11-27T21:34:57.157
> 
> 标签：java, xml-parsing, sax

我想创建一个名称空间前缀未声明但 SAX 拒绝添加它的节点。

有问题的行它：

```
contentItem = content.addElement( "d:" + columnNames[i][0] ); 
```

我试图告诉 SAX 它不应该介意：

```
 SAXReader reader = new SAXReader();
  reader.setFeature( "http://xml.org/sax/features/namespaces", false );
  reader.setFeature( "http://xml.org/sax/features/namespace-prefixes", false );
  reader.setFeature( "http://xml.org/sax/features/validation", false ); 
```

但这无济于事。

我还尝试声明一个 XMLReader 在其上设置功能，然后将 XMLReader 分配给 SAXReader。但无济于事。这是代码，以防万一：

```
 SAXReader reader = new SAXReader();
  XMLReader xmlReader = SAXParserFactory.newInstance().newSAXParser().getXMLReader();
  xmlReader.setFeature( "http://xml.org/sax/features/namespaces", false );
  xmlReader.setFeature( "http://xml.org/sax/features/namespace-prefixes", false );
  xmlReader.setFeature( "http://xml.org/sax/features/validation", false );
  reader.setXMLReader( xmlReader ); 
```

我想要的只是 SAX 停止检查我的 XML 的有效性。

非常感谢您的帮助

# c# - List<> 优化，有哪些可能？

> ID：13593494
> 
> 赞同：0
> 
> 时间：2012-11-27T21:35:04.197
> 
> 标签：c#, .net, list

我已经在我的通用 EF 存储库的 Add() 方法中实现了检查我要插入的行是否已经存在于表中，如果存在，则使用当前可用的信息对其进行更新。

```
private List<T> _previousEntries;

//Try and find one with same PK in the temporary tables...
var previousRow = _previousEntries.Single(n => (int)n.GetType().GetProperty(_PKName).GetValue(n, null) == entPKValue);

//If we did find one...
if (previousRow != null)
{
   //Update the row...
   return;
}

//Add it... 
```

所以我知道，我正在使用反射，这很慢，但我还没有找到另一种方法，因为不同的实体有不同的 SQL PK 名称。

但我不确定反射是这里最大的问题，有时，**_previousEntries**最多可以容纳 800,000 个项目。

**_previousEntries**在存储库类的类构造函数中为其分配了项目。_PKName 也根据 T 的类型在类构造函数中分配一个值。

如果我只是在 Single() 语句上设置断点，它肯定会处理 2-3 秒，所以我不知道如何确定这里的瓶颈是什么：反射或 Single() 对 800,000 个项目.. . 它在 5,000 项列表上的速度肯定更快。

有什么意见吗？我可以做些什么来优化我的 List 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:42:08.570

You could move the reflection out of the LINQ statement to avoid it being evaluated repeatedly:

```
var property = typeof(T).GetProperty(_PKName);
var previousRow = _previousEntries.Single(n => (int)property.GetValue(n, null) == entPKValue); 
```

Or perhaps pass a `Func<T, int>` to your class constructor and avoid the need for reflection altogether.

```
private Func<T, int> _getKeyForItem; // Set by constructor
...
var previousRow = _previousEntries.Single(n => _getkeyForItem(n) == entPKValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:49:29.870

提供主键访问器作为委托

```
public class Repository<T>
{
    private Funct<T,int> _getPK;
    private Dictionary<int,T> _previousEntries;

    public Repository(Funct<T,int> getPK)
    {
        _getPK = getPK;
        _previousEntries = new Dictionary<int,T>();
    }

    public void Add(T item) {
        ...
        int pk = _getPK(item);
        T previousEntry;
        if (_previousEntries.TryGetValue(pk, out previousEntry) {
            // Update
        } else {
            // Add
            _previousEntries.Add(pk, item);
        }
    }
} 
```

您将创建一个这样的存储库

```
var clientRepository = new Repositiory<Client>(c => c.ClientID); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:42:55.497

没有办法快速搜索未排序的列表。它将是 O（项目数）。

您需要使用其他一些数据结构来加快查找速度 - 字典或按 PK 排序的列表是可能的选项。

# python - 如何在 Python 中保存和检索文件中的列表？

> ID：13593496
> 
> 赞同：2
> 
> 时间：2012-11-27T21:35:21.747
> 
> 标签：python, list, data-persistence

我寻找一种将变量保存到文件中的方法（使它们持久用于其他计算）。

我找到了一些解决方案，例如：[https](https://stackoverflow.com/a/899199/1846113) ://stackoverflow.com/a/899199/1846113 但是当我在如下列表中实现它时：

```
import pickle

list = [['cccc',['asd','sdad','sdadas']],['cscc',['asd','sdad','sdadas']]]
pickle.dump(list, outfile) 
```

它给了我这个错误

```
 File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 1370, in dump
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 224, in dump
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 600, in save_list
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 615, in _batch_appends
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 600, in save_list
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 615, in _batch_appends
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 739, in save_global
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 811, in whichmodule
TypeError: unhashable type: 'list' 
```

有谁知道问题是什么？还是其他解决方案？

* * *

**编辑：有解决方案**

问题是我在创建列表时出错。我会发布它（这样你就可以笑了）并避免这个愚蠢的错误：我通过使用（丑陋的）函数处理列表的一些元素来创建列表：

```
def process_element(doc):
    processed_value = do_something(doc.pop())
    return [doc.pop, processed_value] 
```

正如你们中的一些人已经注意到的那样，我在返回输出时出错：

```
[doc.pop, processed_value] 
```

我在列表中添加了一个不可散列的方法，给了我错误。正确的版本是：

```
def process_element(doc):
    processed_value = do_something(doc.pop())
    return [doc.pop(), processed_value] 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-22T12:55:58.573

一个更简单的方法是使用`with`，像这样`for`：`enumerate`

```
with open('input.txt', 'r') as f, open('output.txt', 'w') as o:
    for numline, line in enumerate((line.split() for line in f), start=1):
        # process line elements by using line[0] line[1]...

    # When you're done, you can write results in an output file like this
    # (add a loop if needed):
    o.write("%s %s\n" % (results[0], results[1])) 
```

等等瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-22T13:07:43.907

对于您的示例列表和大多数其他示例，我将使用 JSON 文件格式：

导入json

```
lst = [['cccc',['asd','sdad','sdadas']],['cscc',['asd','sdad','sdadas']]]
with open('list.json', w) as jsonout:
    json.dump(lst, jsonout)

# and then
with (open('list.json') as jsonin:
    lst = json.load(jsonin) 
```

# sql - 您如何将记录与多个可能的匹配项一对一地连接起来......？

> ID：13593498
> 
> 赞同：1
> 
> 时间：2012-11-27T21:35:28.000
> 
> 标签：sql, tsql, sql-server-2008-r2

我有一个如下的交易表

```
| ID | Trans Type | Date       | Qty | Total | Item Number | Work Order |
-------------------------------------------------------------------------
|  1 | Issue      | 11/27/2012 |   3 |  3.50 |        NULL |         10 |
|  2 | Issue      | 11/27/2012 |   3 |  3.50 |        NULL |         11 |
|  3 | Issue      | 11/25/2012 |   1 |  1.25 |        NULL |         12 |
|  4 | ID Issue   | 11/27/2012 |  -3 | -3.50 |         100 |       NULL |
|  5 | ID Issue   | 11/27/2012 |  -3 | -3.50 |         102 |       NULL |
|  6 | ID Issue   | 11/25/2012 |  -1 | -1.25 |         104 |       NULL | 
```

这些事务是重复的，其中“问题”具有工作订单 ID，而“ID 问题”事务具有项目编号。我想更新“问题”交易的 [项目编号] 字段以包含项目编号。当我在日期、数量和总计上进行连接时，我会得到类似这样的信息

```
| ID | Trans Type | Date       | Qty | Total | Item Number | Work Order |
-------------------------------------------------------------------------
|  1 | Issue      | 11/27/2012 |   3 |  3.50 |         100 |         10 |
|  1 | Issue      | 11/27/2012 |   3 |  3.50 |         102 |         10 |
|  2 | Issue      | 11/27/2012 |   3 |  3.50 |         100 |         11 |
|  2 | Issue      | 11/27/2012 |   3 |  3.50 |         102 |         11 |
|  3 | Issue      | 11/25/2012 |   1 |  1.25 |         104 |         12 | 
```

重复项成倍增加！我想要这个

```
| ID | Trans Type | Date       | Qty | Total | Item Number | Work Order |
-------------------------------------------------------------------------
|  1 | Issue      | 11/27/2012 |   3 |  3.50 |         100 |         10 |
|  2 | Issue      | 11/27/2012 |   3 |  3.50 |         102 |         11 |
|  3 | Issue      | 11/25/2012 |   1 |  1.25 |         104 |         12 | 
```

或者这个（项目编号为两场比赛切换）

```
| ID | Trans Type | Date       | Qty | Total | Item Number | Work Order |
-------------------------------------------------------------------------
|  1 | Issue      | 11/27/2012 |   3 |  3.50 |         102 |         10 |
|  2 | Issue      | 11/27/2012 |   3 |  3.50 |         100 |         11 |
|  3 | Issue      | 11/25/2012 |   1 |  1.25 |         104 |         12 | 
```

两者都可以。什么是简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:36:57.117

用于`SELECT DISTINCT`过滤掉相同的结果，或者您可以对结果进行分区以获取每个分组中的第一项。

**更新**

这是说明分区方法的代码。

```
SELECT ID, [Trans Type], [Date], [Qty], [Total], [Item Number], [Work Order]
FROM
(
    SELECT 
        ID, [Trans Type], [Date], [Qty], [Total], [Item Number], [Work Order], ROW_NUMBER() OVER 
            (PARTITION BY ID, [Trans Type], [Date], [Qty], [Total]
             ORDER BY [Item Number]) AS ItemRank
    FROM YourTable
) AS SubQuery
WHERE ItemRank = 1 
```

# python - 使用 Python 3.3 访问被阻止的网页

> ID：13593500
> 
> 赞同：0
> 
> 时间：2012-11-27T21:35:33.353
> 
> 标签：python, python-3.x, urllib

我正在尝试从互联网上下载网页。我能够窃取 HTML（使用 URLlib），但我无法正确下载图像。不过，已经有一个问题了。我的问题是，**有什么方法可以使用 python 绕过防火墙来访问“被阻止”的网页？**

理想情况下，它会使用一些晦涩的代码或模块，但如果不可能，有人可以告诉我使用不同方法（如代理）的好解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:16:16.670

如果要从 HTML 页面中提取图像，则需要使用**re**模块对其进行解析

```
import re 
```

使用正则表达式仅提取*img src*标签。您还可以使用已经编写的解析器。例如 BeautifulSoup > [http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)

防火墙是计算机网络外围防御的被动组件，它也可以作为网络的两个或多个部分之间的接触点，确保网络本身的安全性。所以你必须直接在网络中工作，而不是通过代码语言。

# c# - 检查窗口是否包含表单

> ID：13593502
> 
> 赞同：0
> 
> 时间：2012-11-27T21:35:59.373
> 
> 标签：c#, winforms

我遇到了一个问题，我必须检查具有位置 X 和 Y 以及宽度和高度的表单是否包含在从具有矩形 X、Y、宽度和高度的窗口中检索到的矩形对象中。我在使用 winforms 时有以下代码。如果您在窗口边界之外，这段代码应该返回 false！

```
if (!(this.Location.Y > rect.Y && this.Location.Y < ((rect.Y + rect.Height) - this.Height)) || !(this.Location.X > rect.X && rect.X < ((this.Location.X + rect.Width) - this.Width))) 
```

我通过使用以下代码得到矩形：

```
IntPtr hWnd = FindWindow(null, this.windowTitle);
            RECT rect;
            GetWindowRect(hWnd, out rect); 
```

这是表单，rect 是从窗口创建的矩形对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:42:08.507

What about:

```
if(!(this.Location.Y > rect.Y && this.Location.X > rect.X && 
   this.Location.X < rect.X + rect.Width && this.Location.Y < rect.Y + rect.Height)){
   //...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:57:21.977

出于某种原因，您想编写一些半优化的代码 -

```
if (!
  (this.Location.Y > rect.Y && 
   this.Location.Y < ((rect.Y + rect.Height) - this.Height))
 || 
  !
  (this.Location.X > rect.X && 
  rect.X < ((this.Location.X + rect.Width) - this.Width))) 
```

不幸的是，大多数人无法推理否定和或是相同的陈述。您还决定，与其比较每个角，不如将顶部/左侧与其他矩形的对角和第一个矩形的大小的一些奇怪组合进行比较，以使条件更加复杂。

用单个否定和 AND 重写所有子条件的相同条件可能是正确的并且更具可读性（注意之前有奇怪的非对称条件，现在都非常相似）：

```
if (!
  (this.Location.Y > rect.Y && 
   this.Location.Y + this.Height < rect.Y + rect.Height &&
   this.Location.X > rect.X && 
   this.Location.X + this.Width < rect.X + rect.Width) 
) {} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:42:27.307

`System.Drawing.Rectangle`类有很好的方法。您可以使用`rectangle1.Contains(rectangle2)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:47:33.113

您的问题基本上只是坐标参考的问题。

不太复杂的想法是使用相同的函数来使用 Form.Handle 属性获取两个矩形，该属性基本上是一个句柄，就像 FindWindow 返回的句柄一样：

```
 IntPtr hWnd = FindWindow(null, this.windowTitle);
 RECT rect1;
 GetWindowRect(hWnd, out rect);
 RECT rect2;
 GetWindowRect(form.handle, out rect);
 return rect2.Y >= rect1.Y && rect2.Y + rect2.Height <= rect1.Y + rect1.Height && rect2.X >= rect1.X && rect2.X + rect2.Width <= rect1.X + rect1.Width 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:46:41.007

不知道你到底在问什么，但如果我理解正确，这应该可以

```
 Rectangle rect = new Rectangle(-100,-100, 10, 10);
    if (this.ClientRectangle.IntersectsWith(rect))
    {
        // do stuff
    } 
```

# javascript - Backbone.js 模型删除失败

> ID：13593508
> 
> 赞同：6
> 
> 时间：2012-11-27T21:36:09.063
> 
> 标签：javascript, backbone.js

所以现在当我销毁模型并且服务器返回错误时，销毁事件无论如何都会被触发并且模型数据被重置..

有没有办法防止这种情况发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T22:00:45.957

您可以`{wait: true}`作为选项传递给`destroy()`，这会导致它在从集合中删除模型之前等待来自服务器的响应。

在将视图绑定到事件方面，您应该分别处理`remove`和`destroy`事件，因为`remove`事件将在服务器成功返回时触发，但在服务器返回错误时不会触发。

或者，您可以将`error`处理程序传递给`model.destroy`，然后如果服务器因任何原因失败，您可以使用该处理程序将模型放回原处。要么简单地将模型添加回您的集合中（如果有的话），要么使数据从服务器重新加载（这可能是更安全的选择）。

请注意，使用此方法时，`remove`事件仍会触发，并且`add`在您放回模型时会触发一个事件。

```
thing.destroy({error: function(model, response) {
  // put the thing back in the collection, or cause the collection to reload
}}); 
```

您提到正在重置模型数据；我相信`model`上面错误处理程序中的参数接收原始模型，因此您仍然可以访问其数据。

有关更多信息，请参阅主干文档 - [http://backbonejs.org/#Model-destroy](http://backbonejs.org/#Model-destroy)

# c - 没有 PThread 的同步

> ID：13593513
> 
> 赞同：-2
> 
> 时间：2012-11-27T21:36:17.473
> 
> 标签：c, multithreading

在 C 编程中……</p>

是否有任何库可以在不使用 POSIX 线程的情况下并行化和同步代码？

我听说过 OpenMP。但是在检查了一个 hello world 实现的符号表之后，我发现 OpenMP 只是一个基于 PThreads 构建的库。

**编辑**
在@tmyklebu 的回答下查看我的评论

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:43:00.270

我想我的问题是“为什么要避免使用 pthreads？” pthreads 为您提供了对内核线程和同步原语的合理且可移植的接口。

话虽如此，直接使用您平台的本机原子内置函数（cmpxchg 或 LL/SC 或您有什么）通常很有用，因为有时没有理由让内核参与您的同步。

在 Linux 上，检查`futex`系统调用。

英特尔发布了这个“线程构建块”的东西。AMD也有类似的东西。我几乎没有使用过，所以我不会尝试对它们发表评论。

MPI 也是一回事。

# python - 在 numpy 数组中赋值

> ID：13593514
> 
> 赞同：4
> 
> 时间：2012-11-27T21:36:16.973
> 
> 标签：python, arrays, numpy, variable-assignment

我有一个 numpy 零数组。具体来说，假设它是 2x3x4：

```
x = np.zeros((2,3,4)) 
```

并假设我有一个 2x3 的随机整数数组，从 0 到 3（x 的第三维的索引）。

```
>>> y = sp.stats.distributions.randint.rvs(0, 4, size=(2,3))
>>> y
[[2 1 0]
 [3 2 0]] 
```

我如何有效地执行以下分配（编辑：不使用 for 循环并且适用于 x 具有任意数量的维度和每个维度中任意数量的元素的东西）？

```
>>> x[0,0,y[0,0]]=1
>>> x[0,1,y[0,1]]=1
>>> x[0,2,y[0,2]]=1
>>> x[1,0,y[1,0]]=1
>>> x[1,1,y[1,1]]=1
>>> x[1,2,y[1,2]]=1
>>> x
array([[[ 0.,  0.,  1.,  0.],
        [ 0.,  1.,  0.,  0.],
        [ 1.,  0.,  0.,  0.]],

       [[ 0.,  0.,  0.,  1.],
        [ 0.,  0.,  1.,  0.],
        [ 1.,  0.,  0.,  0.]]]) 
```

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:14:39.760

目前，我只能想到“简单”版本，它涉及沿前两个维度进行展平。此代码应该可以工作：

```
shape_last = x.shape[-1]
x.reshape((-1, shape_last))[np.arange(y.size), y.flatten()] = 1 
```

这产生（我随机生成的`y`）：

```
array([[[ 0.,  0.,  0.,  1.],
        [ 0.,  0.,  1.,  0.],
        [ 0.,  1.,  0.,  0.]],

       [[ 0.,  1.,  0.,  0.],
        [ 0.,  0.,  0.,  1.],
        [ 0.,  1.,  0.,  0.]]]) 
```

关键是，如果您使用多个 numpy 数组（[高级索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)）进行索引，numpy 将使用索引对来索引数组。

当然，请确保`x`and`y`都是 C-order 或 F-order - 否则，对`reshape`and的调用`flatten`可能会给出不同的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:33:59.467

使用[numpy.meshgrid](http://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html) () 创建索引数组，您可以使用这些索引数组来索引原始数组和第三维的值数组。

```
import numpy as np
import scipy as sp
import scipy.stats.distributions

a = np.zeros((2,3,4))
z = sp.stats.distributions.randint.rvs(0, 4, size=(2,3))

xx, yy = np.meshgrid( np.arange(2), np.arange(3) )
a[ xx, yy, z[xx, yy] ] = 1
print a 
```

为了清楚起见，我已将您的数组从 x 重命名为 a，并将索引数组从 y 重命名为 z。

**编辑：** 4D 示例：

```
a = np.zeros((2,3,4,5))
z = sp.stats.distributions.randint.rvs(0, 4, size=(2,3))
w = sp.stats.distributions.randint.rvs(0, 5, size=(2,3))

xx, yy = np.meshgrid( np.arange(2), np.arange(3) )
a[ xx, yy, z[xx, yy], w[xx, yy] ] = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:56:38.180

```
x = np.zeros((2,3,4))
y=np.array([[2, 1, 0],[3, 2, 0]]) # or y=sp.stats...
for i in range(2):
    for j in range(3):
        x[i,j,y[i,j]]=1 
```

将产生预期的结果，IIRC。如果数组维度从未改变，请考虑将两个 for 循环及其负担替换为

```
for j in range(3):
    x[0,j,y[0,j]] = x[1,j,y[1,j]] = 1 
```

# python - 如何以编程方式删除 python 启动可执行文件？

> ID：13593515
> 
> 赞同：0
> 
> 时间：2012-11-27T21:36:20.320
> 
> 标签：python, python-2.7

> **可能重复：**
> [程序可以删除自己的可执行文件吗](https://stackoverflow.com/questions/1606140/can-a-program-delete-its-own-executable)

我的应用程序是在 Py2exe 中编译的。但是，执行完成后，将加载另一个应用程序。不再需要主可执行文件，那么如何让 Python 应用程序自行删除呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:48:32.657

如果您控制第二个可执行文件的源代码，则可以从第二个可执行文件中删除第一个可执行文件。除此之外，我想不出一种方法来实现这一点。

# json - 如何解析嵌套 JSON 对象中的内部字段

> ID：13593519
> 
> 赞同：41
> 
> 时间：2012-11-27T21:36:38.737
> 
> 标签：json, go

我有一个类似于这个的 JSON 对象：

```
{
  "name": "Cain",
  "parents": {
    "mother" : "Eve",
    "father" : "Adam"
  }
} 
```

现在我想将“name”和“mother”解析到这个结构中：

```
struct {
  Name String
  Mother String `json:"???"`
} 
```

我想用`json:...`struct 标签指定 JSON 字段名称，但是我不知道用什么作为标签，因为它不是我感兴趣的顶级对象。我在[`encoding/json`](http://blog.golang.org/2011/01/json-and-go.html)包文档和流行的博客文章[JSON 和 Go](http://golang.org/pkg/encoding/json/)。我也测试过`mother`，`parents/mother`和`parents.mother`。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-27T22:04:02.737

只要您的传入数据不是太动态，您就可以使用结构。

[http://play.golang.org/p/bUZ8l6WgvL](http://play.golang.org/p/bUZ8l6WgvL)

```
package main

import (
    "fmt"
    "encoding/json"
    )

type User struct {
    Name string
    Parents struct {
        Mother string
        Father string
    }
}

func main() {
    encoded := `{
        "name": "Cain",
        "parents": {
            "mother": "Eve",
            "father": "Adam"
        }
    }`

    // Decode the json object
    u := &User{}
    err := json.Unmarshal([]byte(encoded), &u)
    if err != nil {
        panic(err)
    }

    // Print out mother and father
    fmt.Printf("Mother: %s\n", u.Parents.Mother)
    fmt.Printf("Father: %s\n", u.Parents.Father)
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-11-27T22:41:24.147

不幸的是，与 不同的是`encoding/xml`，该`json`包不提供访问嵌套值的方法。您需要创建一个单独的父母结构或将类型分配为`map[string]string`. 例如：

```
type Person struct {
    Name string
    Parents map[string]string
} 
```

然后，您可以像这样为母亲提供吸气剂：

```
func (p *Person) Mother() string {
    return p.Parents["mother"]
} 
```

这可能会或可能不会影响您当前的代码库，并且如果将`Mother`字段重构为方法调用不在菜单上，那么您可能需要创建一个单独的方法来解码并符合您当前的结构。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-27T21:50:21.553

这是我在 Go Playground 中快速编写的一些代码

[http://play.golang.org/p/PiWwpUbBqt](http://play.golang.org/p/PiWwpUbBqt)

```
package main

import (
    "fmt"
    "encoding/json"
    )

func main() {
    encoded := `{
        "name": "Cain",
        "parents": {
            "mother": "Eve"
            "father": "Adam"
        }
    }`

    // Decode the json object
    var j map[string]interface{}
    err := json.Unmarshal([]byte(encoded), &j)
    if err != nil {
        panic(err)
    }

    // pull out the parents object
    parents := j["parents"].(map[string]interface{})

    // Print out mother and father
    fmt.Printf("Mother: %s\n", parents["mother"].(string))
    fmt.Printf("Father: %s\n", parents["father"].(string))
} 
```

可能有更好的方法。我期待看到其他答案。:-)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-27T11:41:53.873

最近，[gjson](https://github.com/tidwall/gjson)支持选择嵌套的 JSON 属性。

```
name := gjson.Get(json, "name")
mother := gjson.Get(json, "parents.mother") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-27T09:03:41.480

如何使用上面建议的中间结构进行解析，然后将相关值放入“真实”结构中？

```
import (
    "fmt"
    "encoding/json"
    )

type MyObject struct{
  Name string
  Mother string
}

type MyParseObj struct{
   Name string
   Parents struct {
         Mother string
         Father string
   } 
}

func main() {
    encoded := `{
         "name": "Cain",
         "parents": {
             "mother": "Eve",
             "father": "Adam"
         }
    }`

    pj := &MyParseObj{}
    if err := json.Unmarshal([]byte(encoded), pj); err != nil {
        return
    }
    final := &MyObject{Name: pj.Name, Mother: pj.Parents.Mother}
    fmt.Println(final)  
} 
```

# java - 比较两个 Java 日历时如何标准化时区？

> ID：13593522
> 
> 赞同：1
> 
> 时间：2012-11-27T21:36:53.743
> 
> 标签：java, calendar

我对 11 月 7 日感到愤怒。

我编写了一个方法来计算两个 Java Date 对象之间的天数（在它被提及之前，JodaTime 不是一个选项）——该方法在大多数情况下都有效，但是当开始 xor 结束日期发生在白天时节省时间，输出减少了一天。

日历是否有某种方式可以覆盖日期的时区？我不在乎日期实际在哪个时区，但它们必须是同一个时区！

下面的代码：

```
public int getDayRange() {

        //startDate = "Sat Nov 06 00:00:00 EDT 2010";
        //endDate = "Sun Nov 07 23:59:59 EST 2010";

    TimeZone tz = TimeZone.getTimeZone("UTC");

    GregorianCalendar cal1 = new GregorianCalendar(tz); 
    GregorianCalendar cal2 = new GregorianCalendar(tz); 

    cal1.setTime(startDate);
    cal2.setTime(endDate);

    long ms1 = cal1.getTime().getTime(); 
    long ms2 = cal2.getTime().getTime(); 
    long difMs = ms2-ms1; 
    long msPerDay = 1000*60*60*24; 

    double days = difMs / msPerDay;

    return (int) Math.floor(days)+1;
        //returns 3(!!!) days (wrong)
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:43:41.370

永远不要尝试使用 1000*60*60*24 作为一天来计算天数。这完全是错误的。如果您出于某种原因确实需要自己实现计算，请使用日历上的 YEAR 和 DAY_OF_YEAR 字段来计算实际天数的差异。

您不能简单地“覆盖” a 的时区，`java.util.Date`因为它没有与之关联的时区信息。您需要知道它打算在哪个时区进行解释，并在将其转换为人类表示时使用该时区。正如您所发现的，任意使用 UTC 来解释它不会提供一致的结果！

```
 public int getDayRange() {

        //startDate = "Sat Nov 06 00:00:00 EDT 2010";
        //endDate = "Sun Nov 07 23:59:59 EST 2010";

    TimeZone tz1 = TimeZone.getTimeZone("EDT");
    TimeZone tz2 = TimeZone.getTimeZone("EST");

    GregorianCalendar cal1 = new GregorianCalendar(tz1); 
    GregorianCalendar cal2 = new GregorianCalendar(tz2); 

    cal1.setTime(startDate);
    cal2.setTime(endDate);

    if (cal1.get(Calendar.YEAR) == cal2.get(Calendar.YEAR)) {
        return cal2.get(Calendar.DAY_OF_YEAR) - cal1.get(Calendar.DAY_OF_YEAR) + 1;
    } else {
        //this gets complicated, but you can see what to do, plenty of examples online
    }

  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:06:29.907

您的系统应该以 UTC 格式存储所有时间戳！
如果没有，您将永远无法正常工作！
那么差值计算就很简单了。

如果还需要显示 localTime，则必须将 TimeZone 与日期成对存储：示例：(long timeUtc, int timezoneOffSetToUtc)。timezoneOffSetToUtc 是在该对的创建日期有效的偏移量。

TimeZone 只能从 String 实例化，例如 ("Austria / Vienna")。

# mysql - MYSQL - 子查询问题

> ID：13593525
> 
> 赞同：0
> 
> 时间：2012-11-27T21:37:04.263
> 
> 标签：mysql, database, subquery

```
SELECT DISTINCT(id_no), lastname,
    (SELECT COUNT(purchasedate)  num_of_purch
    FROM sales JOIN Artist ON
        sales.id = Artist.id_no
        WHERE  DATE_SUB(CURDATE(),INTERVAL 1
                          YEAR) <= purchasedate 
              ) AS num_of_purch

FROM Artist 
```

此查询返回所有艺术家的 ID_no，以及他们的姓氏和购买总数，尽管我想指定哪些购买是给哪个艺术家的。帮助解决这个问题将不胜感激。

编辑 - DISTINCT(id_no) 是多余的，因为它是主键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:45:05.740

这显示了每个艺术家 ID 的销售数量：

```
SELECT artist.id_no, count(sales.id) as num_of_purch
FROM artist left join sales on sales.id = artist.id_no
WHERE DATE_SUB(CURDATE(), INTERVAL 1 YEAR) <= purchasedate
GROUP BY artist.id 
```

要返回姓氏和所有详细信息：

```
SELECT art_tot.id_no, art_tot.lastname, art_tot.num_of_purch, sales.*
FROM (SELECT artist.id_no, artist.lastname, count(sales.id) as num_of_purch
      FROM artist left join sales on sales.id = artist.id_no
      WHERE DATE_SUB(CURDATE(), INTERVAL 1 YEAR) <= purchasedate
      GOUP BY artist.id, artist.lastname) art_tot
      left join sales on art_tot.id_no = sales.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:47:33.550

这应该为您提供艺术家和每位艺术家的购买次数

```
select a.id_no, a.lastname, count(s.purchasedate) num_of_purch
from artists a
join sales s on a.id_no = s.id
where date_sub(curdate(), interval 1 year) <= s.purchasedate
group by a.id_no, a.lastname 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:54:05.280

您应该使用 GROUP BY 来获取每个艺术家的计数。

并且您应该使用外部联接来包括去年没有销售的艺术家。

```
SELECT a.id_no, a.lastname, COUNT(s.purchasedate) AS num_of_purch
FROM Artist a
LEFT OUTER JOIN sales s ON s.id = a.id_no
  AND s.purchasedate => CURDATE() - INTERVAL 1 YEAR
GROUP BY a.id_no; 
```

PS：使用`DISTINCT(id_no)`是没有意义的，不仅因为 id_no 已经是唯一键，而且因为 DISTINCT 始终适用于选择列表中的*所有*列，即使您添加括号使其看起来像只适用于一列的函数。

# javascript - 帆布使线条更粗

> ID：13593527
> 
> 赞同：2
> 
> 时间：2012-11-27T21:37:12.217
> 
> 标签：javascript, canvas

假设我有下一个使用画布绘制网格的代码：

```
var canvas = document.getElementById('canvas'),
    ctx = canvas.getContext('2d'),
    rows = 10,
    cols = 10,
    size = canvas.getAttribute("width") / rows;

drawGrid();

function drawGrid() {
    for (var i = 0; i < rows; i++) {
        for (var j = 0; j < cols; j++) {
            ctx.strokeStyle ='rgba(242, 198, 65, 0.1)'; 
            ctx.strokeRect(i * size, j * size, size, size);
            ctx.fillStyle = 'rgb(38,38,38)';
            ctx.fillRect(i * size, j * size, size, size);
       }
   }
} 
```

你可以在[这里查看结果](http://jsfiddle.net/tZqZv/1/)

我的问题是，如果我评论这条线，为什么网格会显得更厚`ctx.fillRect(i * size, j * size, size, size);`

**编辑**

我怎样才能在不使用的情况下获得相同的结果`fillRect`？

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T03:00:22.420

您的笔画在半像素上渲染，这会导致它们在两个像素上模糊。您的填充覆盖了其中的一部分，使它们再次看起来像半像素。

简单的解决方案是将绘图偏移`0.5, 0.5`以绘制整个像素。有关这方面的更多信息，请参阅[http://diveintohtml5.info/canvas.html](http://diveintohtml5.info/canvas.html)的开头部分：

> 问：为什么 x 和 y 从 0.5 开始？为什么不是0？

* * *

无论如何，你不应该使用矩形来制作网格，你应该只使用线条，并且你应该只需要在网格完成后在最后描边一次。这样做可确保您的半透明网格在网格线的交点处没有较粗的点。

这是一个例子：

```
var canvas = document.getElementById('canvas'),
    ctx = canvas.getContext('2d'),
    rows = 10,
    cols = 10,
    size = canvas.width / rows,
    width = canvas.width,
    height = canvas.height;
drawGrid();

function drawGrid() {
    // An odd-sized lineWidth means we should translate to draw on whole pixels
    ctx.translate(0.5, 0.5);
    for (var i = 1; i < rows; i++) {
        ctx.moveTo(0, i * size);
        ctx.lineTo(width, i * size);
    }
    for (var j = 1; j < cols; j++) {
        ctx.moveTo(j * size, 0);
        ctx.lineTo(j * size, height);
    }
    // translate back:
    ctx.translate(-0.5, -0.5);
    // setting stroke style and stroking just once
    ctx.strokeStyle = 'rgba(242, 198, 65, 0.1)';
    ctx.stroke();
} 
```

​</p>

小提琴：http: [//jsfiddle.net/tZqZv/4/](http://jsfiddle.net/tZqZv/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:58:05.500

渲染的笔画跨越像素边界。这在看起来像抗锯齿效果的外观中很明显，因此当不应用填充并且不与像素边界重叠时，线条看起来更粗。如果我们平移 0.5，那么我们不会跨越像素边界，并且无论是否应用填充，都不会观察到线条粗细的差异。[这是一个例子。](http://jsfiddle.net/au6WW/)

```
var canvas = document.getElementById('canvas'),
    ctx = canvas.getContext('2d'),
    rows = 10,
    cols = 10,
    size = canvas.getAttribute("width") / rows - 5;
drawGrid();

function drawGrid() {
    for (var i = 0; i < rows; i++) {
        for (var j = 0; j < cols; j++) {
            ctx.strokeStyle ='rgba(0, 0, 0, 1)';
            ctx.strokeRect(i * size + 0.5, j * size + 0.5, size, size);
            ctx.fillStyle = 'rgb(38,128,128)';
            //ctx.fillRect(i * size + 0.5, j * size + 0.5, size, size);
        }
    }
} 
```

[这是对效果的一个不错的参考](https://developer.mozilla.org/en-US/docs/Canvas_tutorial/Applying_styles_and_colors#A_lineWidth_example)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:46:32.583

因为您`fillRect`与 . 绘制的边框重叠`strokeRect`。

# linux - 使用 shell 脚本查找文件大小

> ID：13593528
> 
> 赞同：1
> 
> 时间：2012-11-27T21:37:13.977
> 
> 标签：linux, shell

我正在做一个作业，要求我在目录下找到最小的文件和最大的文件，我已经做到了。但是我的输出类似于“最小的文件是 xxx (xxxx -'filename' bytes) 我希望我可以打印没有文件名部分的东西。我正在使用 du -b $filename 来获取大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:39:55.063

`du -b | sort -rh | head -n 1 | awk '{print "The smallest file is " $1 " bytes"}'`

# jquery - JQuery Slider随机化特定幻灯片

> ID：13593531
> 
> 赞同：1
> 
> 时间：2012-11-27T21:37:36.837
> 
> 标签：jquery, random, slider

我需要第 1 个插槽和第 5 个插槽图像始终保持不变。然后插槽 2、3 和 4 为每个插槽旋转 3 个图像。

5 个插槽和 11 个图像：

1.  仅图像1
2.  image2, image 3, imag4（这三个图像中的一个将随机显示）
3.  image5, image 6, imag7（这三个图像中的一个将随机显示）
4.  image8, image 9, imag10（这三个图像之一将随机显示）
5.  仅 image11

这接近我所需要的，但我还需要最后一张图像保持不变而不是随机化： [jQuery Slideshow - 想要随机但需要从相同的图像开始](https://stackoverflow.com/questions/11945992/jquery-slideshow-want-random-but-need-to-start-with-same-image)

我只是不知道如何让第五个插槽最后。

# java - 正则表达式匹配器上的奇怪行为

> ID：13593539
> 
> 赞同：0
> 
> 时间：2012-11-27T21:37:51.230
> 
> 标签：java, regex

我下面的正则表达式应该过滤掉长度为 8-10 的大写单词，其中可能出现 0-2 个数字。它一直适用于我的所有测试，但由于某种原因，它卡在了下面的字符串上。并且`n.group(0)`只包含一个空字符串而不是匹配的“单词”。

```
static final Pattern PATTERN = 
    Pattern.compile("\\b(?=[A-Z\\d]{9,10}\\b)(?:[A-Z]*\\d){0,2}[A-Z]*\\b");

Matcher n = LONG_PASSWORD.matcher("foo ID:636152727 bar");

while (n.find()) {
    String s = n.group(0);                  
    resultArrayList.add(s);
} 
```

为什么我的模式匹配`ID:636152727`？

我想过滤掉的一些例子（这是有效的）：

*   啊啊啊啊啊
*   1啊啊啊啊
*   1AAAAAAA1

ETC...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:41:34.437

我没有比 Ωmega 的答案更好的解决方案，但我想我可以解释发生了什么。它归结为第一个`\b`和最后一个`\b`匹配相同的位置：就在冒号之后。

这是先行可以匹配的第一个位置，因为它后面跟着九位数字和一个单词边界。然后正则表达式的下一部分尝试匹配两个数字（穿插任意数量的大写字母），然后是单词边界，但失败了。所以它试图只匹配一个数字（同上），然后又失败了。然后它尝试匹配*零*位数字（穿插*零*个字母），它成功了，没有推进匹配位置。该位置仍然是单词边界，因此 final`\b`也成功。

字边界只是另一个零宽度断言，如前瞻和后瞻。没有理由不能在同一个地方应用两个或多个；您故意使用第一个单词边界和前瞻来做到这一点。*如果您将量词*应用于断言（如），某些正则表达式风格会将其视为错误`\b+`，但我认为它们中的任何一个都不会发现这个问题。这是单独的词开始和词尾断言（如 GNU`\<`和`\>`或 TCL 的`\y`and `\Y`）会产生影响的罕见实例之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:50:54.017

~~您需要使用锚点`^`和`$`»~~

 ~~```
Pattern.compile("^(?=[A-Z\\d]{9,10}$)(?:[A-Z]*\\d){0,2}[A-Z]*$"); 
```~~  ~~使用此模式：

```
"(?:^|(?<=\\s))(?=[A-Z\\d]{9,10}(?:\\s|$))(?:[A-Z]*\\d){0,2}[A-Z]*(?=\\s|$)" 
```~~

# algorithm - 偶数#of coefs的多项式乘法。在 n 个不同的乘法中

> ID：13593544
> 
> 赞同：0
> 
> 时间：2012-11-27T21:38:11.050
> 
> 标签：algorithm, polynomial-math

在即将到来的考试中寻求一些帮助，这是来自评论的一个问题。看看是否有人可以重述 a) 以便我能够更好地理解它的要求。

所以它希望我通过减去和添加已经相乘的项来获得答案（PQ）中的一些项，而不是使用额外的乘法。就像 Strassen 在他的算法中所做的那样，用 7 次乘法而不是 8 次计算 2x2 矩阵的乘积。

a) 假设 P(x) 和 Q(x) 是（偶数）大小为 n 的两个多项式。
令 P1(x) 和 P2(x) 表示由 P(x) 的前 n/2 和后 n/2 系数确定的大小为 n/2 的多项式。类似地定义Q1(x)和Q2(x)，即P = P1 + x^(n/2)P2。Q = Q1 + x^(n/2) Q2。
展示如何仅使用大小为 n/2 的多项式的 3 个不同乘法来计算乘积 PQ。

b) 简要解释 a) 中的结果如何用于设计一个分治算法，用于将两个大小为 n 的多项式相乘（解释递归调用是什么以及引导条件是什么）。

c) 分析你在 b) 部分给出的算法的最坏情况复杂度。特别是推导出 W(n) 的递推公式并求解。像往常一样，为了简化数学，您可以假设 n 是 2 的幂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:55:45.430

这是我找到的进行多项式乘法的链接。

[http://algorithm.cs.nthu.edu.tw/~course/Extra_Info/Divide%20and%20Conquer_supplement.pdf](http://algorithm.cs.nthu.edu.tw/~course/Extra_Info/Divide%20and%20Conquer_supplement.pdf)

请注意，如果我们按照高中学习的方式进行多项式乘法，则需要大欧米伽（n^2）时间。这个问题想让你看到有一个更有效的算法，首先预处理多项式，把它分成两部分。本讲座对如何执行此操作进行了非常详细的解释。特别是，请查看链接的第 12 页。它明确地向您展示了在多项式相乘时如何在 3 中完成 4 乘法过程。

# asp.net-mvc - 我试图在 MVC3 视图中显示缩进的 XML，但我无法让它工作，它只是看起来没有缩进？

> ID：13593545
> 
> 赞同：0
> 
> 时间：2012-11-27T21:38:13.217
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

按照 John Saunders 的建议，我一直在尝试使用 XElement。但是，我的 XML 在 Razor 视图中没有缩进。我一定是在做一些傻事，但我看不到。

控制器代码：

```
XElement myXElement = XElement.Load(strMapPath + strFileName);
ViewBag.MyOrigDocXML = myXElement;
return View(); 
```

视图中的剃刀代码：

```
@if(ViewBag.MyOrigDocXML != null)
{
@ViewBag.MyOrigDocXML.ToString();
} 
```

非常感谢任何帮助，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T22:16:24.713

我会将您的代码嵌套在 pre html 标签中，例如

```
<link href="~/Content/Prettify/prettify.css" rel="stylesheet" />
<script src="~/Scripts/Prettify/prettify.js"></script>

<body onload="prettyPrint()">
    <pre class="prettyprint lang-xml">@ViewBag.MyOrigDocXML;</pre>
</body> 
```

然后，这将为您提供缩进布局中的 xml，然后添加 prettify 以突出显示 xml 文本

# java - 错误：非静态变量 this 不能从静态上下文中引用

> ID：13593548
> 
> 赞同：1
> 
> 时间：2012-11-27T21:38:17.393
> 
> 标签：java, static

我对这段代码有疑问：

```
package javaapplication16;
import java.io.InputStream;
import javax.swing.JOptionPane;
import sun.audio.AudioPlayer;
import sun.audio.AudioStream;
public class JavaApplication16 {
    public static void main(String[] args) {
        NewJFrame n = new NewJFrame();
        n.setVisible(true);
        InputStream is;
        is = this.getClass().getClassLoader().getResourceAsStream("samp.wav");
        try {
            AudioStream audioStream;
            audioStream = new AudioStream(is);
            AudioPlayer.player.start(audioStream);
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e);
        }
    }
} 
```

它是说

```
error: non-static variable this cannot be referenced from a static context
        is = this.getClass().getClassLoader().getResourceAsStream("samp.wav"); 
```

如果我将 InputStream 变量设为静态，那么它会告诉我表达式的非法开始。我也删除了`this`关键字。问题仍然没有解决。如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:40:46.313

Just avoid the problem, like so:

```
JavaApplication16.class.getClassLoader().getResourceAsStream("samp.wav"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:39:38.663

你不能`this keyword`在静态方法中使用。`this`关键字只能在实例方法或构造函数中使用。`this`是对当前对象的引用。

尝试：

```
 is = YourClassName.class.getClassLoader().getResourceAsStream("samp.wav"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:42:23.157

为此，请改用类文字：

```
 is = JavaApplication16.class.getClassLoader().getResourceAsStream("samp.wav"); 
```

# javascript - JavaScript 变量和传递数据问题

> ID：13593551
> 
> 赞同：0
> 
> 时间：2012-11-27T21:38:34.210
> 
> 标签：javascript, javascript-events

我有一个问题，即 $.getJSON 代码段可以正常工作并生成一个名为“zippy”的变量。我需要在代码中进一步访问“系列：数据”下的“zippy”。

不幸的是，我尝试了很多事情，但无法使其正常工作。最简单的方法是从 funcation(zippy) 调用中“返回数据” $.getJSON(jsonUrl,function(zippy) ，但我不知道如何使该数据可用。

```
$(function() {
    $(document).ready(function() {
        Highcharts.setOptions({
            global: {
                useUTC: false
            }
        });

        console.log("+++++++++++++++++++++++++++++++++++++");
        var jsonUrl = "http://www.someurl.com/thing.php?callback=?";

        $.getJSON(jsonUrl, function(zippy) {
            for(i = 0; i < zippy.cpmdata.length; i++) {
                console.log("TIMESTAMP: " + zippy.cpmdata[i].timestamp + " AFTER: ");

                zippy.cpmdata[i].timestamp = Date.parse(zippy.cpmdata[i].timestamp).getTime() / 1000;
                //var unixtime  Date.parse(temptime).getTime()/1000

                console.log(" TESST " + zippy.cpmdata[i].timestamp + " \r\n");

            }
        });
        console.log("+++++++++++++++++++++++++++++++++++++");

        var chart;
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'spline',
                marginRight: 10,
                events: {
                    load: function() {

                        // set up the updating of the chart each second
                        var series = this.series[0];
                        setInterval(function() {
                            var x = (new Date()).getTime(), // current time
                                y = Math.random();
                            series.addPoint([x, y], true, true);
                        }, 1000);
                    }
                }
            },
            series: [{
                name: 'Random data',
                data: (function() {
                    // generate an array of random data
                    var data = [],
                        time = (new Date()).getTime(),
                        i;

                    console.log("++NEED ACCESS HERE FOR ZIPPY++");
                    console.log(" =============== \r\n");
                    console.log(" FINAL " + zippy.cpmdata[5].timestamp + " \r\n");
                    return data;
                })()
            }]

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:49:26.720

您的问题是 getJSON 是异步的。您的代码中发生的情况是这样的：

1.  document.ready 被触发
2.  调用getJSON并注册一个回调“function(zippy)”注意getJSON立即返回而不执行回调
3.  您尝试使用 HighCharts 绘制图表

    ... 几百毫秒后

4.  浏览器发出 JSON 请求

    ... 几百毫秒后

5.  JSON 请求返回数据并触发对“function(zippy)”的回调

6.  “函数（zippy）”被执行

所以你看。问题不在于“function(zippy)”**如何执行，而是****何时**执行。因此，您无法执行想要在回调函数之外使用 JSON 请求的返回值的代码。（实际上你可以，但我们暂时忽略使用 setTimeout 或使用同步 ajax 进行轮询）

解决方案是将您想要稍后在回调函数中运行的所有代码移动：

```
$.getJSON(jsonUrl, function(zippy) {
        for(i = 0; i < zippy.cpmdata.length; i++) {
            console.log("TIMESTAMP: " + zippy.cpmdata[i].timestamp + " AFTER: ");

            zippy.cpmdata[i].timestamp = Date.parse(zippy.cpmdata[i].timestamp).getTime() / 1000;
            //var unixtime  Date.parse(temptime).getTime()/1000

            console.log(" TESST " + zippy.cpmdata[i].timestamp + " \r\n");

        }

        var chart;
        chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'spline',
            marginRight: 10,
            events: {
                load: function() {

                    // set up the updating of the chart each second
                    var series = this.series[0];
                    setInterval(function() {
                        var x = (new Date()).getTime(), // current time
                            y = Math.random();
                        series.addPoint([x, y], true, true);
                    }, 1000);
                }
            }
        },
        series: [{
            name: 'Random data',
            data: (function() {
                // generate an array of random data
                var data = [],
                    time = (new Date()).getTime(),
                    i;

                console.log(" FINAL " + zippy.cpmdata[5].timestamp + " \r\n");
                return data;
            })()
        }]
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:45:43.793

您需要将所有`new Highcharts.Chart({...})`内容放入`getJSON`回调中，因为您需要等到 json 请求完成后再创建图表。请参阅我的代码注释`CUT AND PASTE chart = new Highcharts.Chart({...}) STUFF HERE!!!`。

```
$(document).ready(function() {
    Highcharts.setOptions({
        global: {
            useUTC: false
        }
    });

    console.log("+++++++++++++++++++++++++++++++++++++");
    var jsonUrl = "http://www.someurl.com/thing.php?callback=?";

    $.getJSON(jsonUrl, function(zippy) {
        for(i = 0; i < zippy.cpmdata.length; i++) {
            console.log("TIMESTAMP: " + zippy.cpmdata[i].timestamp + " AFTER: ");

            zippy.cpmdata[i].timestamp = Date.parse(zippy.cpmdata[i].timestamp).getTime() / 1000;
            //var unixtime  Date.parse(temptime).getTime()/1000

            console.log(" TESST " + zippy.cpmdata[i].timestamp + " \r\n");

            // CUT AND PASTE chart = new Highcharts.Chart({...}) STUFF HERE!!!

        }
    });
    console.log("+++++++++++++++++++++++++++++++++++++");

}); 
```

# ruby-on-rails - rails 有一个关联问题

> ID：13593554
> 
> 赞同：0
> 
> 时间：2012-11-27T21:38:43.110
> 
> 标签：ruby-on-rails, ruby, associations, has-one

我有模型生产者、公司和用户

我希望生产者和公司同时拥有用户。属于某公司的用户只属于该公司。属于某个生产者的用户只属于该生产者。

所以我想要这样的桌子

```
productor           company                user
---------           --------               ------
id                  id                     id
name                name                   email
user_id             user_id                password 
```

我尝试使用 has_one 关联来执行此操作，但出现此错误

```
no such column: users.produtor_id: SELECT  "users".* FROM "users"  WHERE "users"."produtor_id" = 1 LIMIT 1 
```

我的模型如下

```
class Produtor < ActiveRecord::Base

  attr_accessible :borndate, :cpf_cnpj, :is_company, :name, :rg
  has_one :user
  ...

class User < ActiveRecord::Base
  attr_accessible :email, :password
  ...
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:44:10.307

我认为您将 has_one 和 belongs_to 混淆了。

看看**Is it a belongs to or has_one 关联** [here](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Is+it+a+belongs_to+or+has_one+association?)

使用您拥有的列：

```
class Productor < ActiveRecord::Base
  belongs_to :user, :inverse_of => :productor
end

class Company < ActiveRecord::Base
  belongs_to :user, :inverse_of => :company
end

class User < ActiveRecord::Base
  has_one :productor, :inverse_of => :user
  has_one :company, :inverse_of => :user
end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T21:44:01.820

您是否在您的用户模型中建立了关联？

```
class User < ActiveRecord::Base
  attr_accessible :email, :password
  belongs_to :productor
  ...
 end 
```

# java - 使用正则表达式在双换行符之前删除字符串

> ID：13593564
> 
> 赞同：2
> 
> 时间：2012-11-27T21:39:17.390
> 
> 标签：java, regex

我有一个这样的字符串：

```
this is my text
more text
more text

text I want
is below 
```

我只想要双换行符下方的文本，而不是之前的内容。

这是我认为应该起作用的：

```
myString.replaceFirst(".+?(\n\n)",""); 
```

但是它不起作用。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:46:07.297

您应该为您的目的使用以下**正则表达式**：-

```
str = str.replaceFirst("(?s).+?(\n\n)", ""); 
```

因为，您想要匹配任何内容，包括该`newline`字符，然后再连续遇到两个换行符。

* * *

请注意，`dot(.)`不匹配 a `newline`，因此它会在遇到 时停止匹配`first newline character`。

If you want your `dot(.)` to match newline, you can use `Pattern.DOTALL`, which in case of `str.replaceFirst`, is achieved by using `(?s)` expression.

From the documentation of [`Pattern.DOTALL`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#DOTALL): -

> In dotall mode, the expression . matches any character, including a line terminator. By default this expression does not match line terminators.
> 
> Dotall mode can also be enabled via the embedded flag expression (?s).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:42:02.803

为什么不：

`s = s.substring(s.indexOf("\n\n") + 2);`

请注意，它可能是 +1、+2 或 +3。我现在不想拆开我的电脑来测试它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:43:16.097

您可以使用 split 这里是一个例子

```
String newString = string.split("\n\n")[1]; 
```

# android - 可以以某种方式将 Drawable 用作着色器吗？

> ID：13593571
> 
> 赞同：3
> 
> 时间：2012-11-27T21:39:48.183
> 
> 标签：android

我的目标是更新我编写的 SVG 库以支持使用模式填充。在我正在查看的一个使用图案填充的特定 SVG 文件中，图案本身是根据形状定义的（与外部或嵌入式位图相反）。

为了能够处理这个问题，我考虑做的是让解析器创建一个`Drawable`绘制由模式定义的形状，然后以某种方式将它`Drawable`用作`Shader`.`Paint`

不幸的是，似乎不`DrawableShader`存在 a 这样的东西，并且我自己实现这样的东西意味着从我从现有`Shader`类的源代码中可以看到的内容中深入研究本机代码。

我认为对我来说唯一的解决方案是将模式图块渲染为 a`Bitmap`然后使用`BitmapShader`. 这没关系，但为了避免缩放`Bitmap`s 的潜在质量问题，我更喜欢将所有内容都保留为一组向量。

在我沿着这条路线走之前`Bitmap`，`BitmapShader`还有其他我忽略的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:13:07.003

答案似乎是“不”。为此，我用`BitmapShader`了到底。

# linux - 如何删除不同文件夹中的一组相同扩展名文件

> ID：13593576
> 
> 赞同：0
> 
> 时间：2012-11-27T21:40:01.930
> 
> 标签：linux, shell, command-line, terminal

我想从笔式驱动器的不同文件夹中删除一组具有不同文件名的相同扩展文件，我尝试了以下推荐，但它不起作用。

```
$sudo find /media/<Pendrive> *.jpg | rm -rf * 
```

有人可以让我知道从我的 Pendrive 中删除文件的确切命令吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:42:22.157

你可以写：

```
sudo find '/media/<Pendrive>' -name '*.jpg' -exec rm -f '{}' ';' 
```

* * *

> 好的，如果我将所有文件路径导出到文本文件，现在我想使用 awk 推荐删除文件，在这种情况下是否有可能。

如果文本文件名为`all_file_paths.txt`，那么您可以编写：

```
while IFS= read -r file_to_delete ; do
  if [[ "$file_to_delete" == *.jpg ]] ; then
    sudo rm -f "$file_to_delete"
  fi
done < all_file_paths.txt 
```

（命令`IFS= read -r file_to_delete`从标准输入中读取一行——在这种情况下来自标准输入——`all_file_paths.txt`并将该行存储在变量中`$file_to_delete`）。

请注意，如果任何文件路径包含换行符，此方法将出现异常。没有可靠的解决方法，因为您在创建`all_file_paths.txt`.

# php - Execute Link without page refresh

> ID：13593582
> 
> 赞同：-3
> 
> 时间：2012-11-27T21:40:25.013
> 
> 标签：php, javascript, jquery, ajax

> **Possible Duplicate:**
> [using jquery $.ajax to call a PHP function](https://stackoverflow.com/questions/2269307/using-jquery-ajax-to-call-a-php-function)

I have a couple of links (all different) that I want to execute without linking anywhere. Unlike other questions I don't want to send any data using a form, nor do I want to like to the same page everytime the link is clicked, I simply want to run the php script associated with the link but stay on the page the user is currently on. Ajax? jQuery?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:42:34.240

```
<a class="ajaxLink" href="myScript.php">Ajaxed link</a> 
```

[http://api.jquery.com/jQuery.ajax](http://api.jquery.com/jQuery.ajax)

```
$('.ajaxLink').click(function(e){
  e.preventDefault(); // Prevents default link action
  $.ajax({
     url: $(this).attr('href'),
     success: function(data){
       // Do something
     }
  });
}); 
```

jQuery ajax 的默认方法是 GET，但您可以更改它。阅读上述链接中可用的选项。

# python - Dictionary changes size during iteration

> ID：13593585
> 
> 赞同：1
> 
> 时间：2012-11-27T21:40:32.910
> 
> 标签：python, dictionary, python-3.x, iteration

I looked through the database of answers pertaining to this topic and couldn't find an answer, essentially I'm looping through a dictionary, I'm getting the, "dictionary changes size," runtime error yet I'm popping out one key and value and inserting another before the iteration resumes.

```
 for patterns in dict_copy.keys():
            new_tuple = ()
            for items in range(len(patterns)):
                if patters[items] not in exclusion:
                    new_tuple += (patterns[items],)
            dict_copy[new_tuple] = dict_copy.get(patterns)
            dict_copy.pop(patterns) 
```

The dictionaries I'm working with are in the form: {("A","B","C","D"):4, ("B","A","C","D") "2...} I'm pretty much just confused over the fact that it thinks I'm chaning the dictionary size

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:41:38.897

The error is slightly misleading. What it's trying to tell you is that you're not supposed to make any structural changes (insertions/deletions) while iterating over the dict.

An easy way to fix this is by placing the result into a separate dictionary:

```
 new_dict = {}
   for patterns in dict_copy.keys():
        new_tuple = ()
        for items in range(len(patterns)):
            if patters[items] not in exclusion:
                new_tuple += (patterns[items],)
        new_dict[new_tuple] = dict_copy.get(patterns)
   dict_copy = new_dict 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:44:04.097

> 我在迭代恢复之前弹出一个键和值并插入另一个。

那不重要。迭代时不能更改数据结构。Python 的迭代器变得混乱（-：这与字典的大小无关，而是它的内容。（在其他编程语言中也是如此......）

# php - submitting a form that has a picture into a mysql server using php

> ID：13593588
> 
> 赞同：1
> 
> 时间：2012-11-27T21:40:35.917
> 
> 标签：php, forms

I am making a form that allows a user to create a page that has a qr code to link it to the page. I am only having one problem, I cant get the picture to upload to the database and display after the form has been submitted. it displays the file name of the photo just not the photo.

here is my form code

```
<?php
ob_start();
session_start();

<html>
<head>

</head>

<title>create </title>
<center> <font size="+5"> Create </center>
<body background="">
<p

<table align="center" cellpadding="0" border="0" cellspacing="1">
<form name="createTeaOffer" action="submit.php" method="get">

<tr> <td> <font size="+3"> Headline:</td> <td> <input type="text" name="hea"> </td> </tr>
<br />
<tr> <td> <font size="+3"> Photo:  </td> <td> <input type="file" name="pho"> </td> </tr>
<br /> 
<tr> <td><font size="+3">Description: </td> <td><input name="des" type="textarea"> </td>   </tr>
<br />
<tr> <td><font size="+3">Contact Method: </td> <td> <input name="con" type="radio" value="email" name="email" >Email <input type="radio" value="phone"   method="get" name="phone"> Phone </td> </tr>
<br />
<tr> <td><font size="+3">Email or Phone: </td> <td> <input name="ema" type="text"> </td> </tr>
<br />
<tr> <td><font size="+3">Location: </td> <td> <input name="loc" type="text"> </td> </tr>
<br />
<tr> <td><font size="+3">Expiration (yyyy-mm-dd): </td> <td> <input name="exp" type="date"> </td> </tr>
<br />
<tr> <td><font size="+3">Distance: </td> <td> <input name="dis" type="text"> </td></tr>
<br />
</font></table>
<input type="submit"> 
</form>
</body>
</html> 
```

and here is my submit code

```
<?php
ob_start();
session_start();
$template = <<<EOD
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title><!--TITLE--></title>

</head>

<body>
This page belongs to user $myusername<p><p>
QR Code: <img src="https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=http%3A%2F%2Fwww.url....%2F"<!--PAGENAME-->"&choe=UTF-8" title="Link to Google.com"><p> 
Headline: <!--COMMENT--><p>
Photo: <!--PHOTO--><p>
Description: <!--DESC--><p>
Contact By: <!--CONBY--><p>
Contact information: <!--EMP--><p>
Location: <!--LOC--><p>
page expires on: <!--EXP--><p>
Distance: <!--DIS--><p>
<p>
Webpage URL: <!--PAGENAME-->
<p>
Please click <a href="/">Here</a> to go back to the homepage.

</body>
</html>

EOD;

//handle the posted form
if(isset($_POST['hea1'])&&isset($_POST['pho1'])){
//replace the areas of the template with the posted values
$page = str_replace('<!--TITLE-->',htmlentities($_POST['hea1']),$template);
$page = str_replace('<!--COMMENT-->',htmlentities($_POST['hea1']),$page);
$page = str_replace('<!--PHOTO-->',htmlentities($_POST['pho1']),$page); 
$page = str_replace('<!--PAGENAME-->',htmlentities($_POST['wp1']),$page);

    $page = str_replace('<!--DESC-->',htmlentities($_POST['des1']),$page);
        $page = str_replace('<!--CONBY-->',htmlentities($_POST['con1']),$page);
            $page =   
str_replace('<!--EMP-->',htmlentities($_POST['ema1']),$page);
   $page =  str_replace('<!--LOC-->',htmlentities($_POST['loc1']),$page);               
$page = str_replace('<!--EXP-->',htmlentities($_POST['exp1']),$page);   
$page = str_replace('<!--DIS-->',htmlentities($_POST['dis1']),$page);   

//create a name for the new page
$pagename = md5($_POST['hea1']).'.html';

//db connect & select
$db=mysql_connect('localhost','streich','U4iwcjn3Hi&d');
mysql_select_db('streich_users');

//check if page already exists
//    $result = mysql_query('SELECT page_url from pages WHERE url="'.mysql_real_escape_string($pagename).'"');
//    if(mysql_num_rows($result)>=1){
//        $notice = '<p>Page already created <b>./pages/'.$pagename.'</b></p>';
//    }else{
    //inset new page into db
    mysql_query('INSERT into pages  (`page_name`,`disc`,`page_url`,`username`,
    `start_date`,`end_date`,`location`,`email`,`phone`,`photo`)VALUES(
    "'.mysql_real_escape_string(htmlentities($_POST['hea1'])).'",
    "'.mysql_real_escape_string(htmlentities($_POST['dis1'])).'",
    "'.$pagename.'","'.$myusername.'","'.mysql_real_escape_string(htmlentities($_POST['crd1'])).'",
    "'.mysql_real_escape_string(htmlentities($_POST['exp1'])).'",
    "'.mysql_real_escape_string(htmlentities($_POST['loc1'])).'",
    "'.mysql_real_escape_string(htmlentities($_POST['ema1'])).'",
    "'.mysql_real_escape_string(htmlentities($_POST['pho1'])).'")');
    //put the created content to file
    file_put_contents('./tearoffer/'.$pagename,$page);
    //make a notice to show the user
    $notice = '<p>New Page created <b>./page/'.$pagename.'</b></p>';
    $fulllink = 'url/'.$pagename.'';
    //header("location:/tearoffer/$pagename"); 
    echo $fulllink;
    ?>
    <img src="https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=http%3A%2F%2Fwww.url......%2Fpages%2F<? echo $pagename ?>&choe=UTF-8" title="Link"><p> 
    <?
  //  }
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Language" content="en-gb">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Make page example</title>
<style type="text/css">
.prevpage {
font-family: Arial, Helvetica, sans-serif;
font-size: 20px;
color: #093;
background-color: #333;
}
body {

}
</style>
</head>

<body>
<?php
//if the notice is set then display it
if(isset($notice)){echo $notice;} ?>
<ul><li class="prevpage"><b>Headline:</b> <?php echo $_GET['hea']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Photo:</b> <?php echo $_GET['pho']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Description:</b> <?php echo $_GET['des']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Contact by:</b> <?php echo $_GET['con']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>E-Mail or Phone:</b> <?php echo $_GET['ema']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Location:</b> <?php echo $_GET['loc']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Expiration (yyyy-mm-dd):</b> <?php echo $_GET['exp']; ?></li>
<li class="prevpage"></li>
<li class="prevpage"><b>Distance:</b> <?php echo $_GET['dis']; ?></li>
</ul>/
<form method="POST" action="">
<input name="hea1" type="hidden" value="<?php echo $_GET['hea']; ?>"> 
<input name="pho1" type="hidden" value="<?php echo $_GET['pho']; ?>">  
<input name="des1" type="hidden" value="<?php echo $_GET['des']; ?>"> 
<input name="crd1" type="hidden" value="<?php echo date("Y-m-d"); ?>">   
<input name="con1" type="hidden" value=<?php echo $_GET['con']; ?>> 
<input name="ema1" type="hidden" value=<?php echo $_GET['ema']; ?>> 
<input name="loc1" type="hidden" value=<?php echo $_GET['loc']; ?>> 
<input name="exp1" type="hidden" value=<?php echo $_GET['exp']; ?>>
<input name="dis1" type="hidden" value=<?php echo $_GET['dis']; ?>>
<input name="tst1" type="hidden" value="Thank you for using pages.">
<?php
    echo '<input type="hidden" name="wp1" value="' . htmlspecialchars($pagename) . '" />'."\n";
?>

<input type="submit" value="submit preview">
</form>

</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T00:13:20.117

这是一个普遍的答案，我无法真正解释实际代码，但您不能将图像上传到“数据库”，因为数据库（通常）是基于文本的，除非您使用图像编码。如果您的意思是上传到您网站的文件系统，请参阅本教程[http://www.w3schools.com/php/php_file_upload.asp](http://www.w3schools.com/php/php_file_upload.asp)并将图像 URL 添加到您的数据库。然后，您可以使用`<?php echo '<img src="' . $imageURL . '">' ?>`在用户个人资料上回显图像。

也像 dagon 说的那样，你的 html 有一些问题，例如你把标题放在正文部分，而它应该放在标题部分。我还建议使用 $_POST 请求，而不是 $_GET 请求，因为它更安全。更好地了解 html 的基础知识，有大量可用资源。字体标签的使用会让普通的 Web 开发人员痛苦地哭泣，因为它甚至不应该再使用了。学习 CSS，伙计（放在`<style>td { font-size:15px }</style>`head 部分）。

最后，调用表单字段名称，如“loc”和“con”是命名字段的糟糕方式。如果你是唯一一个编写代码的人，那你为什么要把名字弄得如此混乱呢？

# sql-server - 如果远程存储过程失败则返回

> ID：13593591
> 
> 赞同：2
> 
> 时间：2012-11-27T21:40:43.597
> 
> 标签：sql-server, sql-server-2008, stored-procedures, remote-server

我正在创建存储过程。此存储过程运行本地以及外部存储过程。为简单起见，我将调用本地服务器`[LOCAL]`和远程服务器`[REMOTE]`。

这是一个简单的拓扑：

![](../Images/d88f7f947d8bafd94da19c80ac2a80e0.png)

**步骤**

```
USE [LOCAL]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[monthlyRollUp] 
AS
SET NOCOUNT, XACT_ABORT ON
BEGIN TRY
    EXEC [REOMTE].[DB].[table].[sp]

    --This transaction should only begin if the remote procedure does not fail
    BEGIN TRAN
        EXEC [LOCAL].[DB].[table].[sp1]
    COMMIT

    BEGIN TRAN
        EXEC [LOCAL].[DB].[table].[sp2]
    COMMIT

    BEGIN TRAN
        EXEC [LOCAL].[DB].[table].[sp3]
    COMMIT

    BEGIN TRAN
        EXEC [LOCAL].[DB].[table].[sp4]
    COMMIT
END TRY
BEGIN CATCH
    -- Insert error into log table
    INSERT INTO [dbo].[log_table] (stamp, errorNumber, 
        errorSeverity, errorState, errorProcedure, errorLine, errorMessage)
    SELECT GETDATE(), ERROR_NUMBER(), ERROR_SEVERITY(), ERROR_STATE(), ERROR_PROCEDURE(),
        ERROR_LINE(), ERROR_MESSAGE()
END CATCH
GO 
```

在远程过程上使用事务时，会引发以下错误：

> OLE DB 提供程序...返回消息“合作伙伴事务管理器已禁用其对远程/网络事务的支持。”。

我知道我无法在本地为远程过程运行事务。

如果过程的任何部分失败，我如何确保此过程将退出并回滚？

**笔记**

*   关于组合简单的程序，其中一些是单独使用的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T11:02:07.407

IMO 最简单的方法是

*   将返回值添加到远程过程。
*   将远程 proc 包装到事务中并尝试 catch（在远程 proc 内）。如果发生错误，则返回 false。
*   在本地存储过程中，如果为 false，则根本不继续。

我也无法理解本地 proc 中多个 BEGIN TRANS / COMMIT 背后的原因。我的意思是，如果这是月末汇总，这不应该是一笔大交易而不是一堆小交易吗？否则你的 trans 1 和 2 可能会成功提交，但 3 会失败，就是这样。

名称由以下组成：

```
 CREATE PROC [remote].db.REMOTE_PROC ( 
      @return_value int output
 ) 
 AS 
 BEGIN 
      SET XACT_ABORT ON; 
      BEGIN TRY      
           BEGIN TRANS 
           ... do stuff ... 

                set @return_value = 1;
           COMMIT; 
      END TRY 
      BEGIN CATCH 
           set @return_value = 0; 
      END CATCH
 END 
```

和本地proc

```
 CREATE PROC [local].db.[monthlyRollUp] AS
 BEGIN 
      SET XACT_ABORT ON; 

      declare @ret int; 

      EXECUTE [remote].dbo.REMOTE_PROC @return_value = @ret OUTPUT; 

      IF @ret = 0 
           PRINT 'ERROR :(' 
           RETURN
      END IF 

      BEGIN TRANS 
           -- one big transaction here 
           EXEC [LOCAL].[DB].[table].[sp1]; 

           EXEC [LOCAL].[DB].[table].[sp2]; 

           EXEC [LOCAL].[DB].[table].[sp3]; 

           EXEC [LOCAL].[DB].[table].[sp4]; 

      COMMIT; 

 END; 
```

afair [remote].dbo.REMOTE_PROC 运行自己的事务空间，如果成功则返回 1。本地过程，检查返回值并决定是否继续。

sp1 sp2 sp3 和 sp4 都在一个事务中运行，因为每个事务都有多个事务对我来说并没有多大意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T09:37:29.263

您可以尝试将两个存储过程都执行到单独`TRY CATCH`的块中并检查`ERROR_NUMBER`CATCH 块中的对应关系。如果 ERROR_NUMBER 与您得到的错误相同，您可以简单地`return`或`raiseerror`根据您的要求。

是否会导致致命错误。请检查异常中的[错误严重程度](http://msdn.microsoft.com/en-us/library/aa937483%28v=sql.80%29.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:03:01.333

我可能有点不清楚你想要什么。如果您需要整个monthlyRollUp SP 在远程或本地过程失败时回滚，那么您将需要一个分布式事务协调器。这将允许服务器传达有关事务的信息并协调提交。即，两台服务器都必须表明所有必要的锁都已获得，然后协调两台服务器上的提交，以便操作是自动的。以下是设置 DTC 的一个示例：http: [//social.msdn.microsoft.com/forums/en-US/adodotnetdataproviders/thread/7172223f-acbe-4472-8cdf-feec80fd2e64/](http://social.msdn.microsoft.com/forums/en-US/adodotnetdataproviders/thread/7172223f-acbe-4472-8cdf-feec80fd2e64/)

如果您不希望远程程序参与/影响事务，您可以尝试设置：

```
SET REMOTE_PROC_TRANSACTIONS OFF; 
```

[http://msdn.microsoft.com/en-us/library/ms178549%28SQL.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms178549%28SQL.90%29.aspx)

我之前没有使用过这个设置，所以我不确定它是否能满足你的需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T17:22:12.927

如果您不能或不想使用 DTC，并且不想使用 CLR，那么您需要最后调用远程 sp，因为您将无法回滚远程 sp 调用。

```
SET NOCOUNT, XACT_ABORT ON
SET REMOTE_PROC_TRANSACTIONS OFF;
BEGIN TRY
    DECLARE @ret INT
    BEGIN TRAN
        --Perform these in a transaction, so they all rollback together
        EXEC [LOCAL].[DB].[table].[sp1]
        EXEC [LOCAL].[DB].[table].[sp2]
        EXEC [LOCAL].[DB].[table].[sp3]
        EXEC [LOCAL].[DB].[table].[sp4]
    --We call remote sp last so that if it fails we rollback the above transactions
    --We'll have to assume that remote sp takes care of itself on error.
    EXEC [REMOTE].[DB].[table].[sp] 

    COMMIT
END TRY
BEGIN CATCH
    --We rollback
    ROLLBACK       
    -- Insert error into log table
    INSERT INTO [dbo].[log_table] (stamp, errorNumber, 
        errorSeverity, errorState, errorProcedure, errorLine, errorMessage)
    SELECT GETDATE(), ERROR_NUMBER(), ERROR_SEVERITY(), ERROR_STATE(),ERROR_PROCEDURE(),
    ERROR_LINE(), ERROR_MESSAGE()

END CATCH 
```

如果本地 sp 依赖于远程存储过程的结果，那么您可以使用 CLR sp（将需要 EXTERNAL_ACCESS 权限）并显式管理事务（基本上，滚动您自己的 DTC，但没有两阶段提交。您是有效地延迟远程提交。）

```
//C# fragment to roll your own "DTC"  This is not true two-phase commit, but 
//may be sufficient to meet your needs.  The edge case is that if you get an error
//while trying to commit the remote transaction, you cannot roll back the local tran.
using(SqlConnection cnRemote = new SqlConnection("<cnstring to remote>")) 
{
  try {

    cnRemote.Open();
    //Start remote transaction and call remote stored proc
    SqlTransaction trnRemote = cnRemote.BeginTransaction("RemoteTran");
    SqlCommand cmdRemote = cnRemote.CreateCommand();
    cmdRemote.Connection = cnRemote;
    cmdRemote.Transaction = trnRemote;
    cmdRemote.CommandType = CommandType.StoredProcedure;
    cmdRemote.CommandText = '[dbo].[sp1]';
    cmdRemote.ExecuteNonQuery();

        using(SqlConnection cnLocal = new SqlConnection("context connection=true")) 
        {
            cnLocal.Open();
            SqlTransaction trnLocal = cnLocal.BeginTransaction("LocalTran");
            SqlCommand cmdLocal = cnLocal.CreateCommand();
            cmdLocal.Connection = cnLocal;
            cmdLocal.Transaction = trnLocal;

            cmdLocal.CommandType = CommandType.StoredProcedure;
            cmdLocal.CommandText = '[dbo].[sp1]';
            cmdLocal.ExecuteNonQuery();
            cmdLocal.CommandText = '[dbo].[sp2]';
            cmdLocal.ExecuteNonQuery();
            cmdLocal.CommandText = '[dbo].[sp3]';
            cmdLocal.ExecuteNonQuery();
            cmdLocal.CommandText = '[dbo].[sp4]';
            cmdLocal.ExecuteNonQuery();

            //Commit local transaction
            trnLocal.Commit();

        }
        //Commit remote transction
        trnRemote.Commit();
    } // try
    catch (Exception ex)
    {
        //Cleanup stuff goes here.  rollback remote tran if needed, log error, etc.
    }
} 
```

# python - How to distribute and deploy Python 3 code with dependency isolation

> ID：13593594
> 
> 赞同：5
> 
> 时间：2012-11-27T21:40:53.040
> 
> 标签：python, deployment, python-3.2

I'm not happy with the way that I currently deploy Python code and I was wondering if there is a better way. First I'll explain what I'm doing, then the drawbacks:

*   When I develop, I use virtualenv to do dependancy isolation and install all libraries using pip. Python itself comes from my OS (Ubuntu)
*   Then I build my code into a ".deb" debian package consisting of my source tree and a pip bundle of my dependancies
*   Then when I deploy, I rebuild the virtualenv environment, source foo/bin/activate and then run my program (under Ubuntu's upstart)

Here are the problems:

1.  The pip bundle is pretty big and increases the size of the debian package significantly. This is not too big a deal, but it's annoying.
2.  I have to build all the C libraries (PyMongo, BCrypt, etc) every time I deploy. This takes a little while (a few minutes) and it's a bit lame to do this CPU bound job on production

Here are my constraints:

1.  Must work on Python 3\. Preferably 3.2
2.  Must have dependency isolation
3.  Must work with libraries that use C (like PyMongo)

I've heard things about freezing, but I haven't been able to get this to work. cx_freeze out of Pypi doesn't seem to compile (on my Python, at least). The other freeze utilities don't seem to work with Python 3\. How can I do this better?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T22:49:20.100

[Wheel](https://pypi.python.org/pypi/wheel)可能是目前最好的方法。

在部署机器上创建一个虚拟环境，并将一个轮子连同任何依赖项（也构建为轮子）部署到该虚拟环境。

这解决了以下问题：

1.  为依赖项使用单独的轮子意味着您不必重新部署未更改的依赖项，从而减少部署工件的大小
2.  可以在本地构建大包（例如lxml或scipy），然后将编译好的轮子推送到生产中

此外，它适用于使用 C 的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T17:47:20.913

你看过buildout（zc.buildout）吗？使用自定义配方，您可以自动完成大部分操作。

# javascript - Javascript selectedIndex is returning undefined on a HTML drop-down menu

> ID：13593599
> 
> 赞同：2
> 
> 时间：2012-11-27T21:41:07.127
> 
> 标签：javascript, drop-down-menu, selectedindex

Currently I am trying to write a method that appends the value of a dropdown menu to an html link. However I an having trouble retrieving the text of the selection from the menu. I narrowed the problem down to the selectedIndex method in Javascript. It returns undefined. I've included my method below.

```
function getSize(productID){
    var sizeBox = document.getElementsByName(productID);
    alert(document.getElementsByName(productID).selectedIndex);
    var sizeSelected = sizeBox.options[sizeBox.selectedIndex].text;
    alert(sizeSelected);
    var link = document.getElementById(productID).getAttribute("href");
    link = link + "&size=" + sizeSelected;
    document.getElementById(productID).setAttribute("href",link);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:42:47.220

`getElementsByName`返回一个[HTMLCollection](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-75708506)。你应该说：`getElementsByName[0]`

# android - setText() displaying address instead of a value in Android

> ID：13593601
> 
> 赞同：0
> 
> 时间：2012-11-27T21:41:11.693
> 
> 标签：android, settext

I have just started to program in Android and I am still learning. I wanted to check if a year changes automatically when a nextMonth() method is used in case of December and January or whether I should change it with a few if statements. However, I canot display the value of that, instead I get an address. Here is my code:

```
TextView checkMonValue;

MonthDisplayHelper currentMonth = new MonthDisplayHelper(2012, 11);
MonthDisplayHelper nextMon = currentMonth;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    checkMonValue = (TextView)findViewById(R.id.monthValue);

    checkMonValue.setText(String.valueOf(changeOfYear()));

}

public String changeOfYear(){

    nextMon.nextMonth();
    return nextMon + "" + nextMon.getYear();
} 
```

And that is what get's displayed: Android.util.MonthDisplayHelper@44ee34e02013

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:45:27.737

`nextMon`正如您的回报所表明的那样，是一个对象。当您打电话时，`nextMonth()`您发出的命令是增加月份，但实际上并未检索任何内容。

而是这样做：

```
public String changeOfYear(){
    nextMon.nextMonth();
    return nextMon.getMonth() + " " + nextMon.getYear();
} 
```

请注意，我在那里放了一个空间，你只有`""`. 您甚至可以在返回时看到：Android.util.MonthDisplayHelper@44ee34e0`2013`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:45:30.867

发生这种情况是因为`nextMon`您定义了某种类型`MonthDisplayHelper`，并且您没有覆盖该`toString()`方法。

您可以实现该方法以返回一些有意义的东西，或者，也许您打算在这一行中连接一些不同的东西：

```
return nextMon + "" + nextMon.getYear(); 
```

可能像这样的东西就是你想要的，`nextMon.getMonth()`或者是`nextMon`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:45:44.310

您将`nextMon`自己附加到方法的返回值中`changeOfYear()`。这样，它返回的限定名称和地址`nextMon`as`Android.util.MonthDisplayHelper@44ee34e0`附加 year as `2013`。

请更正以附加`nextMon.getMonth()`和`nextMon.getYear()`

```
 public String changeOfYear(){
   nextMon.nextMonth();
   return nextMon.getMonth() + "" + nextMon.getYear();
 } 
```

# television - Subtitles 3 lines to 2 lines

> ID：13593608
> 
> 赞同：0
> 
> 时间：2012-11-27T21:41:23.283
> 
> 标签：television, subtitle

I've got subtitles that are 3 lines long.
The third line falls off when I'm watching it on tv.
Is there some tool that can fix 3 lined subtitles to all 2 lines?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:02:00.950

不确定您是否在正确的论坛中提问，但请尝试字幕研讨会：

[http://www.urusoft.net/products.php?cat=sw](http://www.urusoft.net/products.php?cat=sw)

# javascript - 如何将这个使用 CDATA 的 Greasemonkey 脚本导入 Chrome？

> ID：13593610
> 
> 赞同：2
> 
> 时间：2012-11-27T21:41:30.007
> 
> 标签：javascript, google-chrome, greasemonkey, userscripts, e4x

我有以下代码在 Greasemonkey 上运行良好，但在 Chrome 中运行良好：

```
// ==UserScript==
// @name        SO
// @namespace   stackoverflow.com
// @include     *stackoverflow.com/*
// @version     1
// ==/UserScript==

changeHeaderColor();

function changeHeaderColor()
{
GM_addStyle((<><![CDATA[
   //body { color: white; background-color: black }
   #custom-header       {background-color: rgb(251,122,35)}

   #nav-questions       {background-color: rgb(251,122,35)}
   #nav-tags            {background-color: rgb(251,122,35)}
   #nav-users           {background-color: rgb(251,122,35)}
   #nav-badges          {background-color: rgb(251,122,35)}
   #nav-unanswered      {background-color: rgb(251,122,35)}
   #nav-askquestion     {background-color: rgb(251,122,35)}
   //Blau: rgb(0,160,160) rgb(0,200,200)
    ]]></>).toString());
} 
```

我必须进行哪些更改才能使其在 Chrome 上运行，甚至两者都运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:48:31.603

该`<><![CDATA[ ... ]]></>`代码使用[“EX4”](http://en.wikipedia.org/wiki/ECMAScript_for_XML)，Chrome 从未支持过[，Firefox 也将很快不再支持](https://developer.mozilla.org/en-US/docs/E4X)。

[因此，要使该脚本正常工作，您需要对javascript 中的多行字符串](https://stackoverflow.com/q/805107/331508)使用不同的方法。此外，对于 Greasemonkey，您应该提供一个`@grant`值，从 GM 1.0 开始。

User the `\` escape character and be very careful with `"` and `'` quotes.
Also, do not use `//` comments in such strings, as they will stop *everything* after them, even if it *looks* like it's on a new line.

It ain't pretty, but this will do it:

```
// ==UserScript==
// @name        SO
// @namespace   stackoverflow.com
// @include     *stackoverflow.com/*
// @version     1
// @grant       GM_addStyle
// ==/UserScript==

changeHeaderColor ();

function changeHeaderColor () {
    GM_addStyle ( "                                                 \
        /*body { color: white; background-color: black }            \
        */                                                          \
        #custom-header       {background-color: rgb(251,122,35)}    \
                                                                    \
        #nav-questions       {background-color: rgb(251,122,35)}    \
        #nav-tags            {background-color: rgb(251,122,35)}    \
        #nav-users           {background-color: rgb(251,122,35)}    \
        #nav-badges          {background-color: rgb(251,122,35)}    \
        #nav-unanswered      {background-color: rgb(251,122,35)}    \
        #nav-askquestion     {background-color: rgb(251,122,35)}    \
        /*Blau: rgb(0,160,160) rgb(0,200,200)                       \
        */                                                          \
    " );
} 
```

# javascript - $_GET 在javascript文件中？

> ID：13593613
> 
> 赞同：0
> 
> 时间：2012-11-27T21:41:40.193
> 
> 标签：javascript

例如，我有一个这样的脚本：`<script src="myjs.js?lol=asd"></script>`.

有没有办法让`lol`js 文件内部来提醒它，例如，就像我们可以在 PHP 中做的那样？像：

```
var lol = $_GET['lol'];
alert(lol); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:43:27.233

使用[如何引用加载当前执行脚本的脚本标签中的代码？](https://stackoverflow.com/questions/403967/how-may-i-reference-the-script-tag-that-loaded-the-currently-executing-script)获取对脚本标签的引用：

```
var scripts = document.getElementsByTagName('script');
var thisScriptTag = scripts[scripts.length - 1]; 
```

然后您可以使用`thisScriptTag.src`访问其`src`属性并对其进行解析以获取您要查找的变量

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T13:33:24.003

你不能用 javascript 做到这一点。

# java - MongoDB, java.lang.NoSuchFieldError

> ID：13593614
> 
> 赞同：2
> 
> 时间：2012-11-27T21:41:42.347
> 
> 标签：java, mongodb

Program is failing on line 1

```
 MongoClient mongoClient = new MongoClient("localhost", 27017); 
```

With

```
java.lang.NoSuchFieldError: ACKNOWLEDGED
    at com.mongodb.MongoClientOptions$Builder.<init>(MongoClientOptions.java:54)
    at com.mongodb.MongoClient.<init>(MongoClient.java:126)
    at com.mongodb.MongoClient.<init>(MongoClient.java:115) 
```

While mongo is,

```
Tue Nov 27 15:40:13 [initandlisten] waiting for connections on port 27017 
```

What am i doing wrong please?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T14:03:10.920

我怀疑您的类路径中有多个版本的 mongo-java-driver jar。尝试使用 -verbose:class 运行以查看从何处加载 WriteConcern 类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T13:35:20.227

使用这条线。

Mongo mongo= new Mongo("localhost", 27017);

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-15T23:29:21.177

我遇到了同样的问题，我意识到我有两个用于读取 Mongo DB 的 java 库。当我删除其中一个（com.mongodb-xx.jar）时，错误消失了。

# ruby-on-rails - 为什么验证失败后 URL 会丢失“/edit”后缀？

> ID：13593616
> 
> 赞同：0
> 
> 时间：2012-11-27T21:41:46.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我终于来问这个问题，因为我没有找到答案，它一直困扰着我。这种行为背后的原因是什么？它是 REST 驱动的 :) 吗？

我找到了这个“解决方法”，但没有解释：[如何进行渲染：编辑调用在地址栏中显示 /edit](https://stackoverflow.com/questions/3348920/how-to-make-a-render-edit-call-show-the-edit-in-the-address-bar)

谢谢

* * *

**编辑**

我的问题写得不是很好，对不起。**为什么默认的 Rails 行为不是重定向到编辑模板？**至少对我来说，这会感觉更合乎逻辑:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:45:58.237

`render`不重定向，因此 URL 栏地址没有理由改变。

默认`update`方法如下所示：

```
 # PUT /posts/1
  # PUT /posts/1.json
  def update
    @post = Post.find(params[:id])

    respond_to do |format|
      if @post.update_attributes(params[:post])
        format.html { redirect_to @post, notice: 'Post was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end 
```

URL 是`/posts/1`，即显示在 URL 栏中的内容。如果[update_attributes 失败，例如，验证错误](http://apidock.com/rails/ActiveRecord/Persistence/update_attributes)，它会呈现`"edit"`模板，没有重定向。

# sqlite - 关闭 jpa entitymanager 与保持开放的价值

> ID：13593623
> 
> 赞同：1
> 
> 时间：2012-11-27T21:42:18.780
> 
> 标签：sqlite, jpa, entitymanager

我遇到了一个问题，如果我尝试关闭实体管理器，然后再次打开它，我的 sqlite 数据库被锁定：

```
Caused by: java.sql.SQLException: database is locked
        at org.sqlite.DB.throwex(DB.java:370)
        at org.sqlite.DB.exec(DB.java:76) 
```

但是如果我只是让实体管理器保持打开状态，我看不到错误。所以我的问题是，我真的需要关闭它吗？如果这是唯一将使用此数据库的应用程序，是否需要关闭它会有所不同吗？

这是我创建的两种方法。我正在调用 initTransaction()，然后持久化我的对象并提交，然后调用 endTransaction()。我第二次尝试在 tx.commit() 上执行此操作时会发生该错误。

```
 private EntityManagerFactory emf;
    private EntityManager em;
    private EntityTransaction tx; 

    //in my Java backing bean, multiple methods
        initTransaction();
        em.persist(someObject);
        tx.commit(); //Exception thrown here, but OK first time thru
        endTransaction();        

    private synchronized void initTransaction() {
      if (emf == null || !emf.isOpen()) { emf = Persistence.createEntityManagerFactory("persistenceUnitSqlite"); };   
      if (em == null || !em.isOpen()) { em = emf.createEntityManager(); }
      tx = em.getTransaction();
      if (!tx.isActive()) { tx.begin(); }
    }        

    private synchronized void endTransaction() {
      if (em != null) { em.clear(); em.close(); }
      if (emf != null) { emf.close(); }
      tx = null;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T14:52:55.397

是的，您需要关闭 EntityManager。EntityManagerFactory 通常不应该关闭，它应该作为单例保存在静态变量中。

# bash - FTP bash 脚本

> ID：13593637
> 
> 赞同：0
> 
> 时间：2012-11-27T21:42:57.183
> 
> 标签：bash, shell, unix

我想创建一个脚本来上传文件，直到上传成功。该脚本将监视日志文件。如果“未连接”到服务器，我想重复上传操作，直到“连接”和“文件成功传输”任何人都可以帮助我构建正确的请求。如果 egrep “不是...？

```
 LOGFILE=/home/transfer_logs/$a.log
 First=$(egrep "Connected" $LOGFILE)
 Second=$(egrep "File successfully transferred" $LOGFILE)

  ftp -p -v -i 192.163.3.3 < ../../example.script > ../../$LOGFILE 2>&1

  if
  egrep "Not connected" $LOGFILE; then

  ftp -p -v -i 192.163.3.3 < ../../example.script > ../../$LOGFILE 2>&1

  until
  [[ -n "$first" ]] && [[ -n "$second" ]]; 
  done
  fi 
```

示例包含：

```
 binary
  mput a.txt
  quit 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:35:15.477

```
while :; do
    ftp ... > $LOGFILE
    grep -qF Connected $LOGFILE && 
    grep -qF "File successfully transferred" $LOGFILE && break
done 
```

# javascript - 触发 window.print() 两次或更多次

> ID：13593640
> 
> 赞同：-1
> 
> 时间：2012-11-27T21:43:05.200
> 
> 标签：javascript, jquery

我有一个页面，其中包含我想单独打印的 3 个 div - 我可以手动完成。但是，该 web 应用程序正在运行带有静默打印的 Chrome，我需要在 3 个单独的打印作业中打印这 3 个 div。打印样式表不是我需要的 - 需要 3 个单独的打印作业...

所以我需要多次触发 window.print() 。我想出的最好也是唯一的解决方案是触发我的打印功能 3 次，如下所示：

```
setTimeout(function() { printContent('print1', 'letter'); }, 0);

setTimeout(function() { printContent('print2', 'letter'); }, 1);

setTimeout(function() { printContent('print3', 'letter'); }, 2); 
```

但是，有时 Chrome 无法运行该功能 3 次。如何确保该功能连续 3 次正确触发？

如果有人觉得这很有趣，我的 printContent() 函数是这样的：

```
function printContent(divContent, divClass) {
    var divContent = $('#' + divContent).html();
    $('#print-spooler-box').html('').addClass(divClass).html(divContent);
    window.print();
    $('#print-spooler-box').removeClass(divClass);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:51:51.707

您可以通过编辑打印 CSS 来避免多次打印。

您可以使用媒体查询或`media`属性（在`<link>`元素中）来定位打印样式。

```
<div class="new-page">
  <p>page one</p>
</div>
<div class="new-page">
  <p>page two</p>
</div> 
```

然后在你的 CSS 中：

```
.new-page{
  page-break-before: always;
} 
```

# php - 注意：未定义的索引，php

> ID：13593655
> 
> 赞同：1
> 
> 时间：2012-11-27T21:43:54.800
> 
> 标签：php, mysql, sql

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:47:01.983

代替

```
if( $_POST["add"] ) { 
```

和

```
if( isset($_POST["add"]) /* and other condition on $_POSt["add"] if necessary */) { 
```

问题是您正在访问您的帖子数组中的“添加”键并且它不存在。

# css - Twitter bootstrap 导航 - 响应问题

> ID：13593663
> 
> 赞同：0
> 
> 时间：2012-11-27T21:44:13.720
> 
> 标签：css, twitter-bootstrap, nav

所以我在堆栈上看到了无数这样的东西。人们一直在说，你错过了什么等等。我如何进行三次检查，我很确定我没有遗漏任何东西：

这是页面缩小后的样子：

![twitter Boot Strap Nav 的响应问题](../Images/ab6836ccb76460dc90b81abc11a884da.png)

这就是我的导航源的样子：

```
<div class="navbar">
  <div class="navbar-inner">
    <div class="container">

      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <!-- Be sure to leave the brand out there if you want it shown -->
      <a class="brand" href="#">Project name</a>

      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="nav-collapse collapse">
        <ul class="nav">
            <li><a href="#">Test Link</a></li>
            <li><a href="#">Test Link</a></li>
            <li><a href="#">Test Link</a></li>
            <li><a href="#">Test Link</a></li>
        </ul>
      </div>

    </div>
  </div>
</div> 
```

关于为什么它不会缩小并给我触摸设备按钮的任何想法？那个小下拉的东西？

**注意：**我确实有视图端口元标记和响应式 css，以及页面上的所有 javascript 和 jquery（据我所知，我需要的只是响应式 css）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:56:34.453

我看到的一个错误`data-target=".navbar-responsive-collapse"`应该是`data-target=".nav-collapse"`

否则它似乎在小提琴中工作正常 - [http://jsfiddle.net/eNF97/](http://jsfiddle.net/eNF97/)所以必须缺少其他东西。检查以确保响应文件的正确路径..

# java - 计算用户输入的数量

> ID：13593669
> 
> 赞同：4
> 
> 时间：2012-11-27T21:44:31.940
> 
> 标签：java, input, numbers, counting

我搜索了我的查询，但找不到任何有用的东西。我刚开始学习Java，我做了一个基本的猜谜游戏程序。我的问题是我需要计算用户所做的猜测次数，但我不确定如何执行此操作。我真的很感激你们能给我的任何帮助。到目前为止，这是我的代码：

```
double ran;
ran = Math.random();
int r = (int)(ran*100);

Scanner in = new Scanner (System.in);
int g = 0;

System.out.print("Please make a guess between 1 and 100: ");
g = in.nextInt();

while (g!=r){

  if (g<=0){
    System.out.print("Game over.");
    System.exit(0); 
  }

  else if (g>r){
    System.out.print("Too high. Please guess again: ");
    g = in.nextInt();
  }

  else if (g<r){
    System.out.print("Too low. Please guess again: ");
    g = in.nextInt();                               
  }
}

System.out.print("Correct!"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:48:24.500

您需要一个变量来跟踪您的猜测计数。在每场比赛只能运行一次的地方声明它，a la

```
int guessCount = 0 
```

然后，在您的猜测循环中，递增`guessCount`.

```
guessCount++ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:48:34.123

有一个计数变量，并在每次迭代时在 while 内递增它。

```
 int count=0;
     while(g!=r) {

        count++;
        //rest of your logic goes here
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:57:21.333

所以你会想要维护一个计数器，即一个变量，它将保持猜测次数的计数，并且每次你要求用户进行猜测时，你会希望将计数增加**一。**所以基本上，你应该在每次调用时递增计数器`g = in.nextInt();`

所以这就是你的代码应该做的事情......

```
double ran;
ran = Math.random();
int r = (int)(ran*100);
Scanner in = new Scanner (System.in);
int g = 0;
System.out.print("Please make a guess between 1 and 100: ");
int counter = 0;
g = in.nextInt();
counter++;
while (g!=r) {
    if (g<=0) {
        System.out.print("Game over.");
        System.exit(0);
    }
    else if (g>r) {
        System.out.print("Too high. Please guess again: ");
        g = in.nextInt();
        counter++;
    }
    else if (g<r) {
        System.out.print("Too low. Please guess again: ");
        g = in.nextInt();
        counter++;
    }
}
System.out.print("Correct!"); 
```

# ruby-on-rails - 如何包含所有 lib 文件夹？

> ID：13593670
> 
> 赞同：0
> 
> 时间：2012-11-27T21:44:32.483
> 
> 标签：ruby-on-rails, ruby, require, environment, class-extensions

我想用简单的方法扩展核心 Array 类：

```
class Array
  def to_hash
    result = Hash.new
    self.each { |a| result[a] = '' }
    result
  end
end 
```

我将 array.rb 放入 lib/core_ext 并尝试在 application.rb 中通过

```
config.autoload_paths += %W(#{config.root}/lib)
config.autoload_paths += Dir["#{config.root}/lib/**/"] 
```

但是`undefined method 'to_hash' for ["var1", "var2", "var3"]:Array`如果尝试在模型方法中使用它仍然会得到。当然，我在代码更改后重新启动了服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:49:56.033

一次可以做到这一点的方法是将以下内容添加到其中的一个文件中`config/initializers`

```
require 'core_ext/array` 
```

您所做的所有`autoload_paths`配置值都是在请求类/文件时使路径可用。在我的应用程序中，我可能有一些文件结构如下

```
- lib/
  |
  |- deefour.rb
  |- deefour/
     |
     |- core_ext.rb 
```

在我的`deefour.rb`我有

```
require 'deefour/core_ext' 
```

在里面`config/initializers`我有一个`deefour.rb`简单的文件

```
require 'deefour' 
```

您设置的自动加载配置值将使 Rails 看起来自动加载的唯一方法是，如果您对该文件中存在`lib/deefour/core_ext.rb`的类进行了一些调用。`Deefour::CoreExt`这就是为什么我`require 'deefour'`在初始化程序中的行知道自动加载`lib/deefour.rb`文件的原因。

显式`require 'deefour/core_ext'`in`lib/deefour.rb`用于相同目的，因为它也不遵循 Ruby/Rails 期望的标准类名到目录映射。

# c# - 使datagridview中的列可排序？

> ID：13593671
> 
> 赞同：1
> 
> 时间：2012-11-27T21:44:33.550
> 
> 标签：c#, winforms, datagridview

我使用填充我的datagridview

```
dataGridView1.DataSource = ListOfClasses 
```

这会正确填写所有内容。现在我喜欢使列可排序。即使我尝试的两列是长字符串和字符串，它们似乎也没有排序。我尝试在数据源之后运行它（之前给了我一个异常，因为列不存在）

```
foreach (DataGridViewColumn column in dataGridView1.Columns)
            {
                dataGridView1.Columns[column.Name].SortMode = DataGridViewColumnSortMode.Automatic;
            } 
```

我最初可以使用 sql 中的 order by 对它们进行排序，但是我仍然喜欢使用列选择的灵活性。我如何启用它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-30T13:43:24.070

```
 void dataGridView1_ColumnHeaderMouseClick(object sender, DataGridViewCellMouseEventArgs e)
    {

        if (dataGridView1.SortOrder.ToString() == "Ascending") // Check if sorting is Ascending
        {
            dataGridView1.Sort(dataGridView1.Columns[dataGridView1.SortedColumn.Name], ListSortDirection.Descending);
        }
        else
        {
            dataGridView1.Sort(dataGridView1.Columns[dataGridView1.SortedColumn.Name], ListSortDirection.Ascending);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:50:52.090

您是否尝试过类似实现可排序的 BindingLis 的想法

这是有关如何执行此操作的教程

[http://www.codeproject.com/Articles/31418/Implementing-a-Sortable-BindingList-Very-Very-Quic](http://www.codeproject.com/Articles/31418/Implementing-a-Sortable-BindingList-Very-Very-Quic)

[http://www.timvw.be/2007/02/22/presenting-the-sortablebindinglistt/](http://www.timvw.be/2007/02/22/presenting-the-sortablebindinglistt/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-16T12:24:58.633

您的数据源应该是一个 IBindingList。

如果你使用 VS 2010 及更高版本和 EF，你有方法“.ToBindingList();” 哪个为你做。

前任：

```
dbContext.YourEntitycollection.Load();
yourBindingSource.DataSource = dbContext.YourEntitycollection.Local.ToBindingList(); 
```

像这样，您的 DataGrid 中的排序会自动启用。

有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/data/jj682076.aspx](http://msdn.microsoft.com/en-us/data/jj682076.aspx)

# python - 子文档选择

> ID：13593674
> 
> 赞同：0
> 
> 时间：2012-11-27T21:44:54.097
> 
> 标签：python, mongodb, tuples

```
{"classes":3,
"people" : [

    {name:John,
    age:20,
    city:London}

    {name:Alice,
    age:56,
    city:Dublin}

           ]
} 
```

我的数据库中有很多这样的文件。我只想选择数组中的**第一**个子文档（这里是 John），然后创建一个只有第一个子文档的年龄的有序元组。（我也只想要类数大于 0 的总文档）

我正在尝试这样做：

```
list = db.people.find({"classes": {'$gt': 0}})
records = sorted([(p["people"][0]["age"], p) for p in list]) 
```

但是此代码返回

```
IndexError: list index out of range 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:33:26.207

我相信这里发生的事情是您的查询返回的某些文档有一个空的“人”数组，因此当您尝试访问时，`p[people][0]`您会收到有关列表索引超出范围的错误，因为在索引 0。

如果您希望集合中的所有元素都应该始终有一个非空的 people 数组，那么您应该找出这些对象存在的原因。另一种选择是将您的查询更新为更具选择性，并且不返回对象

```
db.people.find({"classes": {'$gt': 0}, 'people.0' : { '$exists' : True}}) 
```

根据您对数据的建模方式，可能会有更合适的查询，这将允许您排除具有空人员数组的对象。您还应该考虑如果您的对象完全缺少人员数组会发生什么。

# java - 使数组/矩阵可用于程序中的其他方法。

> ID：13593677
> 
> 赞同：0
> 
> 时间：2012-11-27T21:45:03.967
> 
> 标签：java, multidimensional-array, processing

我有一些正在处理的代码，它读入一个 CSV 文件并将其转储到一个数组中。然后我需要以各种方法使用这些数据来绘制一些令人兴奋的图形。

然而，在下面的代码中，当我尝试运行 glyph 方法时，我得到一个异常，即程序找不到任何称为 DSA 的东西。谁能指出我正确的方向？有人告诉我我应该在定义字符串之前输入“public”，但这只会导致另一个错误（意外的令牌）。

```
 void setup() {

  cp5 = new ControlP5(this);  
  cp5.addButton("Overview")
  .setValue(0)
  .setPosition(840, 10)
  .setSize(100, 19);

  cp5.addButton("Quadrant")
  .setValue(0)
  .setPosition(840, 30)
  .setSize(100, 19);

  cp5.addButton("Location Map")
  .setValue(0)
  .setPosition(840, 50)
  .setSize(100, 19);

String [][] DSA = readFile("DSA.csv");
String [][] NC = readFile("NC.csv");
String [][] IW = readFile("IW.csv");

  size(950, 600);
  smooth();
  //noStroke();
  //Use system font 'Arial' as the header font with 12 point type
  h1 = createFont("Arial", 12, false);
  //Use system font 'Arial' as the label font with 9 point type
  l1 = createFont("Arial", 9, false);

}
String [][] readFile(String fileName) {
  //for importing csv files into a 2d array
  //by che-wei wang

  String lines[] = loadStrings(fileName);
  String [][] csv;
  int csvWidth=0;

  //calculate max width of csv file
  for (int i=0; i < lines.length; i++) {
    String [] chars=split(lines[i], ',');
    if (chars.length>csvWidth) {
      csvWidth=chars.length;
    }
  }

  //create csv array based on # of rows and columns in csv file
  csv = new String [lines.length][csvWidth];

  //parse values into 2d array
  for (int i=0; i < lines.length; i++) {
    String [] temp = new String [lines.length];
    temp= split(lines[i], ',');
    for (int j=0; j < temp.length; j++) {
      csv[i][j]=temp[j];
    }
  }
  return csv;
}

void Gluph() {
    println(DSA[1][3])
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:14:00.277

这是一个范围界定问题。阅读有关变量范围的信息。

一种解决方案是您可以在全局空间中声明变量。现在它们在你的 setup() 函数中声明，一旦 setup() 退出，这些变量不再可用于其他函数，因为它们是在 setup() 范围内声明的。如果您在 setup() 之前声明它们，在程序的第一行，您将可以在全局范围内访问它们。

如果您仍需要在 setup 中读取 File()，则只需在全局范围内声明变量并在 setup() 中赋值。由于变量是在全局范围内声明的，因此无论您从何处访问它们，setup() 范围内的更改仍会反映出来。

```
String [][] DSA;
String [][] NC;
String [][] IW;   

void setup() {

  cp5 = new ControlP5(this);  
  cp5.addButton("Overview")
  .setValue(0)
  .setPosition(840, 10)
  .setSize(100, 19);

  cp5.addButton("Quadrant")
  .setValue(0)
  .setPosition(840, 30)
  .setSize(100, 19);

  cp5.addButton("Location Map")
  .setValue(0)
  .setPosition(840, 50)
  .setSize(100, 19);

  DSA = readFile("DSA.csv");
  NC = readFile("NC.csv");
  IW = readFile("IW.csv");

  size(950, 600);
  smooth();
  //noStroke();
  //Use system font 'Arial' as the header font with 12 point type
  h1 = createFont("Arial", 12, false);
  //Use system font 'Arial' as the label font with 9 point type
  l1 = createFont("Arial", 9, false);

}
String [][] readFile(String fileName) {
  //for importing csv files into a 2d array
  //by che-wei wang

  String lines[] = loadStrings(fileName);
  String [][] csv;
  int csvWidth=0;

  //calculate max width of csv file
  for (int i=0; i < lines.length; i++) {
    String [] chars=split(lines[i], ',');
    if (chars.length>csvWidth) {
      csvWidth=chars.length;
    }
  }

  //create csv array based on # of rows and columns in csv file
  csv = new String [lines.length][csvWidth];

  //parse values into 2d array
  for (int i=0; i < lines.length; i++) {
    String [] temp = new String [lines.length];
    temp= split(lines[i], ',');
    for (int j=0; j < temp.length; j++) {
      csv[i][j]=temp[j];
    }
  }
  return csv;
}

void Gluph() {
    println(DSA[1][3])
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:48:45.667

您想让 DSA 成为类变量。我在这里看不到类定义，但它会是这样的：

```
class blah{
  String [][] DSA;

  void setup() {

  cp5 = new ControlP5(this);  
  cp5.addButton("Overview")
  .setValue(0)
  .setPosition(840, 10)
  .setSize(100, 19);

  cp5.addButton("Quadrant")
  .setValue(0)
  .setPosition(840, 30)
  .setSize(100, 19);

  cp5.addButton("Location Map")
  .setValue(0)
  .setPosition(840, 50)
  .setSize(100, 19);

  DSA = readFile("DSA.csv");
String [][] NC = readFile("NC.csv");
String [][] IW = readFile("IW.csv");

  size(950, 600);
  smooth();
  //noStroke();
  //Use system font 'Arial' as the header font with 12 point type
  h1 = createFont("Arial", 12, false);
  //Use system font 'Arial' as the label font with 9 point type
  l1 = createFont("Arial", 9, false);

}

} 
```

# knockout.js - 将 observableArrays 的元素创建为可观察对象（深度映射）

> ID：13593680
> 
> 赞同：0
> 
> 时间：2012-11-27T21:45:18.560
> 
> 标签：knockout.js, knockout-mapping-plugin

我是映射插件的新手，我认为我遗漏了一些明显的东西。

我怎样才能让 ko.mapping '深度'创建可观察数组的成员作为可观察对象本身？我在文档中查看了“创建回调”和“选项”，但没有看到任何明显的东西。

我有一个相当大的对象模型，因此不希望手动绑定 viewModel。此外，作为一个附带问题，可能还需要动态添加元素作为可观察对象。

**html**

```
<p>
    here, ko.mapping succesfully creates an observable...<br/>
    <input data-bind="value:someText, valueUpdate:'afterkeydown'"></input>
</p>

<p>
    however, here, the contents of the observable array are not observables...</br>    
    <span data-bind="foreach: { data: years, as: 'year' }">

   <input data-bind="value:year, valueUpdate:'afterkeydown'"></input>

    <br />
    </span>
    <button data-bind="click:function(){addYear();}">add</button>
</p>

<p><br /><br /><div data-bind="text: ko.toJSON($root)"></div></p> 
```

​</p>

**javascript**

```
var model={    
    someText: 'Hello',        
    years:[2000,2001,2002]
};

var viewModel = ko.mapping.fromJS(model);
viewModel.addYear=function(){viewModel.years.push(ko.observable(""));}
ko.applyBindings(viewModel); 
```

​</p>

[这是](http://jsfiddle.net/damiensawyer/Sfg4K/)一个 jsFiddle 链接

非常感谢您的帮助，

DS

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:44:17.637

我不得不将您的数组更改为属性数组，而不仅仅是数字。如果您只有一个数组编号，则映射插件不会将它们转换为可观察对象。

```
var model={    
    someText: 'Hello',        
    years:[{item:2000},{item:2001},{item:2002}]
    }; 
```

查看[更新的小提琴](http://jsfiddle.net/photo_tom/Sfg4K/16/)

# mono - 有没有办法阻止 MonoDevelop 更新删除 beta Mono 库？

> ID：13593681
> 
> 赞同：0
> 
> 时间：2012-11-27T21:45:22.643
> 
> 标签：mono, monodevelop

我正在尝试将 MonoDevelop 3.0.5 与最新的 Mono .NET 运行时 (3.0.1) 一起使用。但是，每次我对 MonoDevelop 应用更新时，它都会从我的系统中完全删除新的单声道运行时。

是否有某个设置会阻止 MonoDevelop 删除较新的框架版本？

# php - 下载 .docx 文件

> ID：13593693
> 
> 赞同：1
> 
> 时间：2012-11-27T21:45:45.843
> 
> 标签：php, download

我正在使用 phpdocx 创建一个 word 文档。当我在服务器上查看它时，它是一个有效的 Word 文档。但是，当我尝试下载它时，它说文件无法打开，因为文件存在问题。Word 能够恢复文档，但它的客户会抱怨 Word 文档无效。这是我用来下载文件的代码：

```
function readfile_chunked_remote($filename, $seek = 0, $retbytes = true, $timeout = 3) {
    set_time_limit(0); 
    $defaultchunksize = 1024*1024; 
    $chunksize = $defaultchunksize; 
    $buffer = ''; 
    $cnt = 0; 
    $remotereadfile = false; 

if (preg_match('/[a-zA-Z]+:\/\//', $filename)) 
$remotereadfile = true; 

$handle = @fopen($filename, 'rb'); 

if ($handle === false) { 
return false; 
} 

stream_set_timeout($handle, $timeout); 

if ($seek != 0 && !$remotereadfile) 
fseek($handle, $seek); 

while (!feof($handle)) { 

if ($remotereadfile && $seek != 0 && $cnt+$chunksize > $seek) 
    $chunksize = $seek-$cnt; 
else 
    $chunksize = $defaultchunksize; 

$buffer = @fread($handle, $chunksize); 

if ($retbytes || ($remotereadfile && $seek != 0)) { 
    $cnt += strlen($buffer); 
} 

if (!$remotereadfile || ($remotereadfile && $cnt > $seek)) 
    echo $buffer; 

ob_flush(); 
flush(); 
} 

$info = stream_get_meta_data($handle); 

$status = fclose($handle); 

if ($info['timed_out']) 
return false; 

if ($retbytes && $status) { 
return $cnt; 
} 

return $status; 
```

}

谢谢！

# castle-windsor - 您将如何解决一次并能够在您的应用程序中访问您的记录器？

> ID：13593700
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:05.693
> 
> 标签：castle-windsor, castle

使用城堡温莎和 LoggingFacility，您将如何解决一次并能够在您的应用程序中使用您的记录器？我知道引导/安装是在 global.asax 中完成的，这就是应该完成解析的地方，但我对如何在 global.asax 之外访问记录器感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:14:37.937

使用 Castle Windsor 的目的是遵循控制反转模式，从而允许容器将依赖项（如 ILogger）注入到需要它们的类中。您可以通过让控制器（或任何需要进行日志记录的类）依赖 ILogger 来“访问记录器”，或者将其作为构造函数参数，或者公开 ILogger 类型的可设置属性。

# r - 用另一个因素替换一个因素（在数据框内）

> ID：13593703
> 
> 赞同：2
> 
> 时间：2012-11-27T21:46:14.243
> 
> 标签：r, vector, replace

我有两个因子，它们的级别数不同，但我想根据因子的名称和顺序，使用一个因子替换数据框中另一个因子中的值。

我的数据看起来像这样

```
x <- factor(c("one", "two", "three", "two", "three"))
y <- factor(c(NA, "foo", NA, "bar", NA))

(df <- data.frame(x, y))

      x    y
1   one <NA>
2   two  foo
3 three <NA>
4   two  bar
5 three <NA> 
```

这就是我想要结束的地方，

```
 x    y     z
1   one <NA>   one
2   two  foo   foo
3 three <NA> three
4   two  bar   bar
5 three <NA> three 
```

我应该将因子转换为字符向量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:51:46.193

您可以使用`levels(z) <- c(levels(y), levels(x))`使 z 具有所需的级别，但是基础整数值可能无法正确关联。您最好分配给 z 使用`as.character`然后转换为因子。

例如

```
df$z <- as.factor( ifelse(is.na(df$y), as.character(df$x), as.character(df$y)) ) 
```

# javascript - 将语言声明提取到 JavaScript 变量中

> ID：13593704
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:14.923
> 
> 标签：javascript

所以我有一个 HTML5 网站设置，我一直在为语言切换编程

该网站总是这样开始......

```
<!DOCTYPE html>
<!--[if IE 7]><html lang="fr" class="no-js ie7"><![endif]-->
<!--[if IE 8]><html lang="fr" class="no-js ie8"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="fr" class="no-js"> 
```

我正在构建一个语言检测脚本，我正在尝试缓存

```
<html lang="fr" class="no-js"> 
```

或者更具体地说，在我的脚本激活时将“fr”和“en”转换为变量......

我将如何将语言声明获取到变量中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:51:54.157

```
var lang = document.documentElement.getAttribute("lang"); 
```

要不就

```
var lang = document.documentElement.lang; 
```

# java - Spring Batch 在运行步骤之前解析步骤的资源

> ID：13593706
> 
> 赞同：4
> 
> 时间：2012-11-27T21:46:23.597
> 
> 标签：java, spring, batch-processing, spring-batch

我有一个由两个步骤组成的 Spring Batch 作业（到目前为止）。

作业的**第一步**是在 tasklet 中实现的。它获取需要处理的逗号分隔值 (CSV) 文件（使用大量业务逻辑来确定哪些是），并将它们复制到“放置区”目录中。

**第二步**配置为面向块的处理，具有读取器和写入器。阅读器是一个`MultiResourceItemReader`...，它在放置区目录中查找所有 CSV 文件，并将每个文件委托给“真正的”阅读器（解析 CSV）。

**我的问题**是，即使第一步成功，第二步也无法在放置区目录中找到任何 CSV 文件。有趣的是，如果我立即再次运行批处理作业……那么第二步*确实会*找到并处理文件！

我在推测，但看起来 Spring Batch 在一开始就解决了第二步的通配符模式......而不是等到第二步运行的时候。即使第一步复制了它应该复制的文件，第二步已经确定那里没有文件。

我对 Spring Batch 相当陌生，并且仍在学习我的方式。我在这里遗漏了一些明显的上下文或范围吗？我的工作定义的相关部分如下。谢谢！

```
...
<!-- JOB DEFINITION -->
<job id="notificationJob" xmlns="http://www.springframework.org/schema/batch">
    <step id="copyFilesToLocal">
        <tasklet transaction-manager="jobRepositoryTransactionManager" ref="getFilesTasklet" />
        <next on="COMPLETED" to="processFiles"/>
    </step>
    <step id="processFiles">
        <tasklet transaction-manager="ecommerceTransactionManager">
            <chunk reader="multiFileReader" writer="notificationEmailWriter" commit-interval="1" />
        </tasklet>
    </step>
</job>

<!-- FIRST STEP -->
<bean id="getFilesTasklet" class="com.mypackage.FileMovingTasklet">
    <property name="localDao">
        <bean class="com.mypackage.BatchLocalDao">
            <property name="dataSource" ref="jobRepositoryDataSource" />
        </bean>
    </property>
    <property name="sourceDirectory">
        <bean id="sourceDirectory" class="org.springframework.core.io.FileSystemResource">
            <constructor-arg value="/mnt/source-directory" />
        </bean>
    </property>
    <property name="destinationDirectory">
        <bean id="destinationDirectory" class="org.springframework.core.io.FileSystemResource">
            <constructor-arg value="/home/myuser/drop-zone" />
        </bean>
    </property>
</bean>

<!-- SECOND STEP -->
<bean id="multiFileReader" class="org.springframework.batch.item.file.MultiResourceItemReader">
    <property name="resources" value="file://home/myuser/drop-zone/*.csv" />
    <property name="delegate" ref="myFileReader" />
</bean>
... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:07:55.413

您的“multiFileReader”需要为 scope="step"，因此它将模式扩展（bean 属性的初始化）推迟到执行该步骤。

# android - Android 警报管理器和广播接收器

> ID：13593708
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:30.633
> 
> 标签：android, broadcastreceiver, alarmmanager

我试图设置一个将向广播接收器发送意图的警报。然后接收者应该在 logcat 中打印一行，说明它已经工作了。但是我没有得到任何迹象表明接收者正在接收任何东西。我已经检查了所有我能想到的东西。有人可以给我一些指导，因为我不知所措吗？

报警方式

```
public void scheduleNextUpdate()
      {

        Intent intent = new Intent(MainActivity.this,AlarmReceiver.class);
        PendingIntent pendingIntent =
            PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);

        long currentTimeMillis = System.currentTimeMillis();
        long nextUpdateTimeMillis = currentTimeMillis * DateUtils.MINUTE_IN_MILLIS;
        Time nextUpdateTime = new Time();
        nextUpdateTime.set(nextUpdateTimeMillis);

        if (nextUpdateTime.hour < 8 || nextUpdateTime.hour >= 22)
        {
          nextUpdateTime.hour = 8;
          nextUpdateTime.minute = 0;
          nextUpdateTime.second = 0;
          nextUpdateTimeMillis = nextUpdateTime.toMillis(false) + DateUtils.DAY_IN_MILLIS;
        }
        AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
        alarmManager.set(AlarmManager.RTC, nextUpdateTimeMillis, pendingIntent);
        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, nextUpdateTimeMillis,nextUpdateTimeMillis,pendingIntent);

        boolean alarmUp = (PendingIntent.getBroadcast(this, 0, 
                new Intent(MainActivity.this,AlarmReceiver.class), 
                PendingIntent.FLAG_NO_CREATE) != null);

        if (alarmUp)
        {
            Log.d("myTag", "Alarm is already active");
        }
} 
```

接收者等级

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
     public void onReceive(Context context, Intent intent) {  
         System.out.println("Alarm Received");
    intent = new Intent(context, MainActivity.class);
    PendingIntent pendingIntent = PendingIntent.getService(context, 0, intent, 0);
     System.out.println("Alarm Received");
} 
```

清单

```
<receiver android:name=".AlarmReceiver"></receiver> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:00:47.907

这个数学似乎是错误的。我相信您正在尝试设置几代人都不会响起的警报：

```
long currentTimeMillis = System.currentTimeMillis();
long nextUpdateTimeMillis = currentTimeMillis * DateUtils.MINUTE_IN_MILLIS; 
```

也许您的意思是让闹钟在一分钟内响起：

```
long nextUpdateTimeMillis = currentTimeMillis + DateUtils.MINUTE_IN_MILLIS; 
```

无论如何首先使用：

```
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, 
                          System.currentTimeMillis() + 10000, 
                          5000,
                          pendingIntent); 
```

要确认您的设置是正确的，如果是这样，您需要重新计算您的`nextUpdateTimeMillis`.

# jquery - 展开/折叠 使用 toggleclass().next.toggle()

> ID：13593709
> 
> 赞同：1
> 
> 时间：2012-11-27T21:46:31.627
> 
> 标签：jquery, html-lists, next, toggleclass

以下按我想要的方式工作。第一个列表项是带有加号图像的标题。当您单击图像/列表项时，第二个列表项会展开，并且标题旁边的图像会变为减号图像。但是，我想先扩展一些列表项，并显示减号图像。当我从列表中删除 style="diplay:none" 时，它会正确显示展开但图像不会改变。如何让图像正确显示。

```
$(function(){
    $('li.plus-image').click(function() {
        $(this).toggleClass("minus-image").next().toggle("fast");
     });     
});

<ul>
    <li class="plus-image">Display title</li>
    <li style="display: none;">
        <ul id="list-filter-items">     
            <li>bullet points</li>
            <li>bullet points</li>
        </ul>
    </li>
</ul> 
```

# javascript - jquery在一段时间后淡入屏幕

> ID：13593711
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:36.903
> 
> 标签：javascript, jquery, jquery-animate

嗨，伙计们，我想弄清楚如何在动画开始后经过一定时间后让图像出现在屏幕上。

所以我得到了一张图片，我用 css 把它放在我想要的地方。

```
#laser
{
   position: absolute;
   left: 650px;
} 
```

任何人都知道我怎么可能让该图像在动画开始时不出现，而是在 3 秒后出现在我使用 css 放置它的某个地方？

编辑：这是我到目前为止得到的代码。

```
<div id="laser">
  <img src="images/laser.png" alt="laser">
</div>

#laser
{
   position: absolute;
   left: 650px;
   display: none;
} 
```

然后我就使用了你给我的代码。但它只是阻止其他一切工作。

```
$('#laser').animate({
    width: '100px',
    height: '100px'
}, 3000, function() {
    $(this).show('slow');
});​ 
```

如果您想查看它，请链接到我的代码：http: [//jsfiddle.net/wdy5P/5/](http://jsfiddle.net/wdy5P/5/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:47:43.690

使用`.animate()`方法..在指定的持续时间后，回调中的代码将被执行..

```
$('#laser').animate({
    width: '100px',
    height: '100px'
}, 3000, function() {
    $(this).show('slow');
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/wdy5P/2/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:49:00.230

添加一毫秒`show()`使其成为动画（肉眼不可见，但添加到 FX 队列中），然后您可以使用该`delay()`函数将显示的图像延迟 3000 毫秒（3 秒）：

```
$('#laser').delay(3000).show(1); 
```

图像当然必须是最初的`display: none;`

# c# - 在 serialize() 之前将形式中的所有 & 符号更改为波浪号

> ID：13593712
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:41.220
> 
> 标签：c#, jquery, asp.net, forms

我正在尝试找到一种有效的方法，在表单输入之前将表单输入中的所有 & 符号转换为其他内容（可能是 ~ 或其他内容）`$("#myForm").serialize()`。这样做的原因是我在字符上拆分结果字符串`&`，然后是`=`字符，以获得名称和值的列表。

该系统工作正常，但很明显，当其中一个值包含 & 符号时除外。

我一直在尝试想办法`&`在一个表单中全局替换所有 s ，但我想不出任何看起来很有效的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:06:07.623

也许这个？

```
var foo = $("#myForm").serializeArray().map(function(el) {
    return el.name + "=" + el.value.replace(/&/g, "~");
}).join("&"); 
```

[例子](http://jsfiddle.net/BMvka/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T03:37:16.737

```
$("#myForm").serialize().split('%26').join('~') 
```

[http://jsfiddle.net/evWkT/2/](http://jsfiddle.net/evWkT/2/)

# php - 使用自定义模板引擎如何用 php 替换内容

> ID：13593714
> 
> 赞同：2
> 
> 时间：2012-11-27T21:46:46.920
> 
> 标签：php, html

因此，我制作了一个模板引擎，我想用 PHP 文件中的内容替换 {pageBody}，当我使用模板引擎执行此操作时，它不会执行 PHP，而是在查看源选项中显示它。

模板.PHP

```
<?php
class TemplateLibrary {
    public $output;
    public $file;
    public $values = array();

    public function __construct($file) {
        $this->file = $file;
        $this->file .= '.tpl';
        $this->output = file_get_contents('templates/'.$this->file);
    }

    public function replace($key, $value)
    {
        $this->values[$key] = $value;
    }

    public function output() {
        foreach($this->values as $key => $value)
        {
            $ttr = "{$key}";
            $this->output = str_replace($ttr, $value, $this->output);
        }
        return $this->output;
    }
}

index.tpl
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>{page_title}</title>
{page_style}
</head>

<body>
{page_header}
{page_body}
{page_footer}
</body>
</html> 
```

HTML 替换工作正常，但 PHP 不行。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:19:14.077

您的文件相当分散，并且列表不完整。我在下面列出了您迄今为止提供的所有文件。

上面的@Jonathon 是正确的，您将需要使用输出缓冲来捕获 PHP 文件和`include()`文件的输出（以便执行）而不是使用`file_get_contents()`（不执行文件）。

[编辑] 我在本地环境中重新创建了所有这些文件，并确认 @Jonathon 的建议非常有效。我已经更新了**dev/replacements.php**以包含建议的代码。

此外，我在您的类中添加了另外两个函数`TemplateLibrary`：`replaceFile($key, $filename)`这样`file_get_contents($filename)`您就不必经常重复它，并且`replacePhp($key, $filename)`执行一段`include()`时间来捕获输出，因此您可以封装包含 PHP 文件的复杂性。

祝你好运！

**主文件**

```
<?php
require_once 'dev/dev.class.php';
require_once 'dev/templatelibrary.php';
$dev = new dev('netnoobz-billing');
$dev->loadLib('JS', 'js', 'jquery');

// template library and required files
$template = new TemplateLibrary('index');
require_once 'dev/replacements.php';

echo $template->output(); 
```

**开发/模板库.php**

```
<?php
class TemplateLibrary {
    public $output;
    public $file;
    public $values = array();

    public function __construct($file) {
        $this->file = $file;
        $this->file .= '.tpl';
        $this->output = file_get_contents('templates/'.$this->file);
    }

    public function replace($key, $value)
    {
        $this->values[$key] = $value;
    }

    public function replaceFile($key, $filename)
    {
        $this->values[$key] = file_get_contents($filename);
    }

    public function replacePhp($key, $filename)
    {
ob_start();
include($filename);
$data = ob_get_clean();
        $this->values[$key] = $data;
    }

    public function output() {
        foreach($this->values as $key => $value)
        {
            $ttr = "{$key}";
            $this->output = str_replace($ttr, $value, $this->output);
        }
        return $this->output;
    }
} 
```

**索引.tpl**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>{page_title}</title>
{page_style}
</head>

<body>
{page_header}
{page_body}
{page_footer}
</body>
</html> 
```

**替代品.php**

```
<?php
$configStyleSheet = '<style type="text/css">'
                  . file_get_contents('styles/default/main.css')
                  . '</style>';
$pageHeader = file_get_contents('templates/header.tpl');
$pageFooter = file_get_contents('templates/footer.tpl');

#$pageBody   = file_get_contents('loaders/pageBody.php');
ob_start();
include('loaders/pageBody.php');
$pageBody = ob_get_clean();

$template->replace('{page_style}' , $configStyleSheet);
$template->replace('{page_title}' , 'NetBilling');
$template->replace('{page_header}', $pageHeader);
$template->replace('{page_footer}', $pageFooter);
$template->replace('{page_body}'  , $pageBody); 
```

**装载机/pageBody.php**

```
<?php echo 'test'; ?> 
```

[编辑]从 OP 的评论中添加了**loaders/pageBody.php 。**

[编辑] 更新了**dev/replacements.php**以捕获输出缓冲区并在 .php 上使用包含

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:33:00.173

您在 pastebin 代码中使用了 file_get_contents，但您应该使用模板处理器或 PHP 的 include()。如果您执行 $template->replace('{page_header}', $pageHeader)，$pageHeader 只是 tpl 的来源，而您的模板处理器不知道这一点，因此它只会用该来源替换标签。使固定：

```
$pageHeader = new TemplateLibrary('header');
// ...
$template->replace('{page_header}', $pageHeader->output()); 
```

对于 PHP 文件，您应该调用包含在输出缓冲中的文件的 include()，这样您就可以将 PHP 执行的输出作为模板变量传递，而不是 PHP 源代码本身：

```
ob_start();
include('loaders/pageBody.php');
$pageBody = ob_get_clean();
/// ...
$template->replace('{page_body}', $pageBody); 
```

# flash - Flash Player 找不到 XML 配置文件

> ID：13593716
> 
> 赞同：0
> 
> 时间：2012-11-27T21:46:55.363
> 
> 标签：flash, configuration, iis-7.5, access-denied

我们有一个网站，客户在不久前决定将其外包给印度后，将其带回我们的服务器。

他们的一个页面使用 SWF 播放器播放一些视频。页面中的 SWF 对象显然是使用 XML 文件配置的。这是 ASPX 页面中的 SWF 代码：

```
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
    codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"
    width="900" height="600" id="tech" align="middle">
    <param name="allowFullScreen" value="true" />
    <param name="allowScriptAccess" value="sameDomain" />
    <param name="movie" value="/Images/flv/simple.swf?xml_path=/Client/XML/NFLNews.xml" />
    <param name="quality" value="high" />
    <param name="wmode" value="transparent">
    <embed src="/Images/flv/simple.swf?xml_path=/Client/XML/NFLNews.xml" quality="high"
        wmode="transparent" width="900" height="600" name="tech" align="middle" 
        allowscriptaccess="sameDomain" allowfullscreen="true" 
        type="application/x-shockwave-flash" 
        pluginspage="http://www.macromedia.com/go/getflashplayer" />
</object> 
```

请注意，该`embed`标签的 src 属性为：
`src="/Images/flv/simple.swf?xml_path=/Client/XML/NFLNews.xml"`

单击此页面时，它会在文件上引发“拒绝访问”错误`/Client/XML/NFLNews.xml`。但是，如果我直接浏览到 XML 文件，IIS 会毫无错误地提供它。

以下是 IIS 日志显示的请求内容：
`#Fields: date time cs-uri-stem cs-uri-query s-contentpath sc-status`
`2012-11-28 16:09:33.482 /Videodisplay.aspx VID=22 "X:\inetpub\wwwroot\sitename\Videodisplay.aspx" 500`

请注意，Videodisplay.aspx 是承载 SWF 对象的页面。XML 文件根本不显示在 IIS 日志中。

IIS 抛出的确切错误是：

```
Server Error in '/' Application.
Access to the path 'F:\inetpub\wwwroot\lijsoccer.com\Client\XML\NFLNews.xml' is denied.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.UnauthorizedAccessException: Access to the path 'F:\inetpub\wwwroot\lijsoccer.com\Client\XML\NFLNews.xml' is denied.

ASP.NET is not authorized to access the requested resource. Consider granting access rights to the resource to the ASP.NET request identity. ASP.NET has a base process identity (typically {MACHINE}\ASPNET on IIS 5 or Network Service on IIS 6 and IIS 7, and the configured application pool identity on IIS 7.5) that is used if the application is not impersonating. If the application is impersonating via <identity impersonate="true"/>, the identity will be the anonymous user (typically IUSR_MACHINENAME) or the authenticated request user.

To grant ASP.NET access to a file, right-click the file in File Explorer, choose "Properties" and select the Security tab. Click "Add" to add the appropriate user or group. Highlight the ASP.NET account, and check the boxes for the desired access. 
```

我假设 SWF 对象必须在与 IIS 不同的安全上下文下运行？还是这里发生了其他事情？我们在这里从来没有真正处理过 Flash 的东西，所以我对此很陌生。

Windows 2008 R2、ASP.NET 4、IIS 7.5

**更新：**我已经确定`Everyone`了SWF**实际上正在****修改**XML 文件。显然，我不想让每个人都可以访问这个文件，所以我在文件中添加了一个审核条目，以显示“每个人都失败了”，以尝试找出 SWF 文件在哪个用户下运行......但即使删除了每个人的写权限确实导致它再次失败，它没有写入安全审计事件。所以我想现在我坚持让每个人都拥有对该文件的写入权限，除非有人能告诉我如何确定 SWF 在哪个用户下运行。

# iphone - 带有 AND 和 OR 问题的 NSPredicate

> ID：13593721
> 
> 赞同：0
> 
> 时间：2012-11-27T21:47:07.450
> 
> 标签：iphone, objective-c, ios, ipad, core-data

我有以下 NSPredicate：

```
 fetchRequest.predicate = [NSPredicate predicateWithFormat:@"url = %@ AND type = %@ OR type = %@", newsStory.url, [NSNumber numberWithInt:StoryHighlighted], [NSNumber numberWithInt:StorySavedAndHighlighted]]; 
```

我想用这个特定的 URL 和类型（突出显示或突出显示并保存）获取故事。但是上面的查询似乎不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:48:33.973

就像将您的 OR 括在括号中以节省任何混淆一样简单？

```
fetchRequest.predicate = [NSPredicate predicateWithFormat:@"url = %@ AND (type = %@ OR type = %@)", newsStory.url, [NSNumber numberWithInt:StoryHighlighted], [NSNumber numberWithInt:StorySavedAndHighlighted]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T01:53:00.313

您可以尝试这样做：

```
fetchRequest.predicate = [NSPredicate predicateWithFormat:@"url = '%@' AND( type = %@ OR type = %@"), newsStory.url, [NSNumber numberWithInt:StoryHighlighted], [NSNumber numberWithInt:StorySavedAndHighlighted]]; 
```

# css - 如何在共享主机上运行 SASS 或 LESS？

> ID：13593722
> 
> 赞同：17
> 
> 时间：2012-11-27T21:47:17.920
> 
> 标签：css, sass, less

我想在 CSS 中使用变量，因此我正在考虑为此使用[SASS](http://sass-lang.com)或[LESS 。](http://lesscss.org)

但是，我的问题是我将在共享主机上部署项目，*而不是*在具有命令行访问权限的专用主机上。

我也不喜欢我的用户必须在他们的浏览器中使用 Javascript 编译 CSS 文件的想法。（如果他们禁用了 Javascript 怎么办？）

处理这种情况的最佳方法是什么？最后我是否必须求助于普通的旧 CSS？我希望不是...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T22:42:45.900

在您的开发机器上编译 Sass 或 Less，并将编译后的缩小 CSS 推送到您的服务器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-30T14:19:39.633

你有一个矛盾。

如果您想完全控制您的站点，您应该拥有自己的服务器，无论是专用的还是虚拟的。这将让你安装和运行任何你想要的东西。

如果您不允许在共享主机上安装和运行自定义软件，那么您将无法即时编译 SASS。在将代码上传到服务器之前，您必须编译 SASS。

如果您对本地编译 SASS 的必要性不满意，您可以使用[Capistrano](https://help.github.com/articles/deploying-with-capistrano)之类的部署技术或可能是您的 IDE 将其自动化。部署工具的选择很大程度上取决于您的开发和托管环境。

另一种选择是在客户端的浏览器中本地编译 LESS。请参阅[http://lesscss.org/#usage](http://lesscss.org/#usage)。但我不建议这样做，原因有两个：

1.  这会使您的网站更难访问（真是讽刺！）。您不应该依赖繁重的 JS 将基本样式应用到您的网站。
2.  SASS 优于 LESS 有几个原因，其中主要是很棒的 Compass 工具包。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T22:47:34.567

首先，CSS 预处理器是一种开发工具，可让您轻松管理 CSS 文件——它们不在浏览器中运行。

其次，在共享或专用主机上运行预处理器的唯一区别是您是否能够首先安装预处理器。

* * *

修改我的旧答案：一些 CSS 预处理确实可以在浏览器中运行。例如，[Lesscss](http://lesscss.org/)将请求和编译更少的工作表到 CSS 并实时更新它们。这是一个非常宝贵的开发助手，但绝对不是您想要在生产环境中做的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T06:04:04.503

大多数共享主机不允许您将自定义 gem 安装到默认目录，因为它通常存在于用户的主文件夹之外，因此位于用户的可写目录之外。

我必须在我的共享主机（1and1 主机）上执行 -[这些说明]- 在共享主机上安装自定义 gem。您需要对共享托管服务器进行 shell 访问才能执行必要的步骤。您还需要确保更新您正在运行的命令以处理最新版本的 RubyGems（在本文发布时为 2.0.3）。

完成初始设置后，只需运行`gem install sass`命令即可。然后切换到存储 CSS 文件的目录并运行`sass --watch`以开始使用 SASS 生成 CSS 文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-04T12:47:07.080

两个选项：

**1) LESS/SASS 预处理器**（推荐）

OP 没有提到可用的服务器端处理能力，这可能会缩小此处的选择范围，但您想要的是服务器端 LESS/SASS，理想情况下它还可以缩小和缓存生成的 CSS。

如果你有可用的 PHP，你可以使用 lessphp；较旧的项目是 github.com/Incenteev/lessphp，但不要使用该项目已停止的情况，而是使用[github.com/oyejorge/less.php](https://github.com/oyejorge/less.php)，它有很多东西可以提供并且有很好的文档记录。

对于 SASS，有[github.com/richthegeek/phpsass](https://github.com/richthegeek/phpsass)

**2) LESS.js SASS.js (+)**

看看[客户端使用](http://lesscss.org/#client-side-usage)部分中的less.js页面，简单但不是生产解决方案。

SASS JS 实现更棘手，似乎已经进行了多次尝试，我不能保证，但这个项目看起来很活跃：[medialize/sass.js](https://github.com/medialize/sass.js/)

+ 注意：这对于实时环境来说是一个糟糕的解决方案，因为浏览器必须下载完整的 LESS/SASS 文件、编译和渲染；大多数现代浏览器都可以处理它，但效率很低。仅在您的开发环境或模型中使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-09T07:17:27.313

尽管它不是 SASS 或 LESS，但[CSS-Crush](http://the-echoplex.net/csscrush/)具有所有标准的预处理器功能。我在自己的共享主机项目中广泛使用了它，没有任何服务器端安装。

唯一的要求是 PHP，任何体面的主机都需要它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-03T07:39:15.143

Tintin81，只需在 google 中输入 php sass/less compiler 并使用第一个结果，如 scssphp 或 lessphp

[http://leafo.net/scssphp/](http://leafo.net/scssphp/)

[http://leafo.net/lessphp/](http://leafo.net/lessphp/)

它会在旅途中将你的 scss 文件编译成 css，并带有缓存等等。易于实现，源 scss 文件保留在项目中。它将在线或在您的本地环境中工作。

我不敢相信这里给出了多少愚蠢无用的答案，而不是对问题的简单答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-27T13:14:19.737

这可能会有所帮助 - 我出于同样的目的正在探索它 [http://www.dev-metal.com/compile-sass-to-css-with-pure-php-automatically/](http://www.dev-metal.com/compile-sass-to-css-with-pure-php-automatically/)

这是您通过网络启动的脚本，然后继续无限期地运行以查找过期的 scss 文件。

更新：效果很好，但主机似乎将脚本视为失控并杀死它。所以我编辑了 php-sass-watcher.php 以注释掉循环，并添加了`echo "Finished compiling " . date(DateTime::RSS);`. 然后在我的 Eclipse 中，我打开一个 Web 浏览器视图并在每次更改时运行 URL，类似于在命令行上运行编译器。

# javascript - Input type="submit" Button onClick：jQuery replaceWith 阻止表单提交

> ID：13593731
> 
> 赞同：3
> 
> 时间：2012-11-27T21:47:53.410
> 
> 标签：javascript, jquery, html, forms, submit

我有以下 HTML：

```
<input class="button" name="save" onclick="$(this).replaceWith('<img src=http://www.example.com/images/ajax-loader.gif />');" type="submit" value="SUBMIT"> 
```

单击按钮时，表单不再尝试提交，而是将自身替换为旋转的 AJAX 加载 gif 并且什么也不做。如果我删除 onclick 部分，它会提交。

长话短说，这是给客户的，但我不能以相同的形式给他们

```
$(function() { $(input[name=save]).on({click:function() { $(this).replaceWith(...); } }); }); 
```

为什么替换后仍然不能提交？我哪儿也不`e.preventDefault()`去。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:17:37.023

根据[**replaceWith()**](http://api.jquery.com/replacewith/)文档：

> .replaceWith() 方法从 DOM**中删除**内容，并通过一次调用在其位置插入新内容。

当一个元素被删除时，根据[**remove()**](http://api.jquery.com/remove/)文档：

> 除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。

我假设这就是提交未执行的原因。

如果您希望表单仍然提交，您可以在替换元素后手动触发提交。

### [DEMO](http://jsfiddle.net/FranWahl/qaRRT/) - 在替换按钮元素时提交表单

为了便于阅读，为了演示，我将 click 事件的绑定移到了脚本中，而不是元素的内联。我还在多个表单的情况下添加了一个 id，如果您只有一个表单，则不需要这样做，因为您可以简单地绑定`$("form").on("submit")`到

```
$("input[name='save']").on("click", function(){
    $(this).replaceWith('<img class="submit-form" src=http://www.example.com/images/ajax-loader.gif />');
    $("form").submit();
});

$("#myForm").on("submit", function(){
    alert("form has been submitted.");
    return false;
}); 
```

### ​编辑 - 使用内联的相同代码`onclick`

将代码移入内联`onClick`仍然有效。

关于表单提交，`$(this)`将是被替换之前的按钮并被删除，因此`$(this).closest("form").submit()`或任何其他形式的选择器使用`$(this)`都不起作用。

您必须将您的表单定位为中性提交，而不使用`$(this)`using`$("form").submit()`或者如果您有多个表单，请使用 id ，如`$("#myForm").submit()`.

```
<form id="myForm" action="http://jsfiddle.net/">
    <input class="button" name="save" type="submit" onclick="$(this).replaceWith('<img src=http://www.example.com/images/ajax-loader.gif />'); console.log(this); $('#myForm').submit();" value="SUBMIT">
</form> 
```

### [演示](http://jsfiddle.net/FranWahl/NWvkP/)- 使用内联 onclick 替换按钮后手动提交表单

作为旁注，如果您希望在触发提交事件之前显示图像，您可以应用如下小技巧：

```
$("input[name='save']").on("click", function(){
    $(this).replaceWith('<img class="submit-form" src=http://www.example.com/images/ajax-loader.gif />');

    // Makes sure the image is rendered before the submit executes.
    window.setTimeout(function(){
        $("form").submit();
    }, 300);
}); 
```

您可以在您的在线 onClick 中应用相同的课程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:51:58.993

假设您的表单有`id="myForm"`，那么您可以执行以下操作：

```
<input class="button" name="save" onclick="$(this).replaceWith('<img src=http://www.example.com/images/ajax-loader.gif />');$('#myForm').submit();" type="submit" value="SUBMIT"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T07:30:21.580

改变你的方法。尝试隐藏它并附加一个新的 html 元素，而不是删除按钮。

```
<input class="button" name="save" 
 onclick="$(this).hide(); $('<img src=http://www.example.com/images/ajax-loader.gif />').insertBefore(this);" type="submit" value="SUBMIT"> 
```

# triangulation - 如何使用 cgal triangulation_3 定位？

> ID：13593732
> 
> 赞同：0
> 
> 时间：2012-11-27T21:47:58.777
> 
> 标签：triangulation, cgal, locate

嗨，我正在使用 Delaunay_triangulation_2 和 Delaunay_triangulation_3 来寻找插值点。我找到了如何为 Delaunay_triangulation_2 使用定位：

```
Locate_type loc;
int li;
CgalPoint point(_params[0], _params[1]);
Face_handle handle = delaunay.locate(point, loc, li);

if(loc == Delaunay::VERTEX)
{
    MyData data = _handle->vertex(_li)->info();
}
else if(loc == Delaunay::EDGE)
{
    MyData data1 = handle->vertex(handle->cw(li))->info();
    MyData data2 = handle->vertex(handle->ccw(li))->info();
}
else if(loc == Delaunay::FACE)
{
    MyData data1 = handle->vertex(0)->info();
    MyData data2 = handle->vertex(1)->info();
    MyData data3 = handle->vertex(2)->info();
} 
```

那些 cw 和 ccw 的技巧对我来说并不直观。

在使用 Triangulation_3 时，我在实施 EDGE、FACET 和 VEREX 案例时遇到了问题

```
 Locate_type loc;
int li,lj;
Cell_handle handle = delaunay.locate(point, loc, li, lj);

switch(loc)
{
    case Delaunay::CELL:
    {
        for(int i = 0; i < 4 ; ++i)
            MyData data = handle->vertex(i)->info();
        break;
    }
    case Delaunay::EDGE:
    case Delaunay::FACET:
    case Delaunay::VERTEX:
        assert(false);
} 
```

我的测试表明案例 Delaunay::VERTEX 的行为与 Triangulation_2 中的相同。

Triangulation_3 提供了与 Triangulation_2 不同的句柄类型。我必须在这里使用一些 cw 和 ccw 技巧吗？

文件：

> 如果查询位于小平面、边或顶点上，则返回在其边界上具有查询的单元之一。 [http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Triangulation_3_ref/Class_Triangulation_3.html](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Triangulation_3_ref/Class_Triangulation_3.html)

我想获得两个具有我的查询的边缘点和三个面点（如果返回其他内容，则返回 Delaunay::CELL）。如何从“其中一个在其边界上有查询的单元格”中获取它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T07:18:57.000

什么是刻面和边的文档位于三角剖分的[组合部分](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/TriangulationDS_3_ref/Concept_TriangulationDataStructure_3.html) 内。

```
 if(loc == Delaunay::VERTEX)
    {
        MyData data = handle->vertex(li)->info();
    }
    else if(loc == Delaunay::EDGE)
    {
        MyData data1 = handle->vertex(handle->vertex(li))->info();
        MyData data2 = handle->vertex(handle->vertex(lj))->info();
    }
    else if(loc == Delaunay::FACET)
    {
        MyData data1 = handle->vertex( (li+1)%4 )->info();
        MyData data2 = handle->vertex( (li+2)%4 )->info();
        MyData data3 = handle->vertex( (li+3)%4 )->info();
    } 
```

# c# - 如何在Listbox中显示选定的数据并在Textbox中显示？

> ID：13593733
> 
> 赞同：0
> 
> 时间：2012-11-27T21:48:05.270
> 
> 标签：c#, winforms, textbox, listbox

我有两种形式 - 一种是主要形式，它有一个列表框，其中包含从文本文件加载的数据。另一种是交货单。当用户在列表框中选择一个项目并单击编辑按钮时，应出现交付表单，其中所选数据显示在交付表单的文本框中。目前我有这样的事情：

```
private Visit theVisit = new Visit();
private List<Delivery> deliveries = new List<Delivery>();
private FrmDelivery deliveryForm = new FrmDelivery();

private void updateDelivery()
{
    lstDeliveries.Items.Clear();            
    List<String> listOfD = theVisit.listDeliveries();
    lstDeliveries.Items.AddRange(listOfD.ToArray());            
}

private void btnEditDelivery_Click(object sender, EventArgs e)
{
    deliveryForm.ShowDialog();
    updateDelivery();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:06:38.650

表单与其他任何类一样：您可以添加属性，也可以设置访问器。

使用交付表单上的属性，该属性在更改时填充文本框。

您现在所要做的就是从主表单设置此值并显示交付表单。

交付形式：

```
class FrmDelivery: Form
{
    TextBox text1; // Initialize this as usual
    public string DisplayText
    {
       get { return text1.Text; }
       set { text1.Text = Value; }
    }
} 
```

主要形式：

```
private void btnEditDelivery_Click(object sender, EventArgs e)
{
    FrmDelivery frm = new FrmDelivery();
    frm.DisplayText = "Whatever Value you want";
    frm.ShowDialog();
} 
```

您也可以将 text1 声明为 public，但我不喜欢给予超出需要的控制权。始终选择最严格的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:52:41.193

有一些方法可以做到这一点，一种是您可以使用静态字段将列表框的选定项的值传递给交付表单

像这样 ：

form1（在列表框的 selectedindexchanged 事件中）：

```
public static string listboxselecteditem=listbox1.selecteditem;//here you add selected item of listbox 
```

然后在交付表格中执行：

```
textbox1.Text=form1.listboxselecteditem;//add value of selected item in listbox to textbox in Delivery form 
```

# c#-4.0 - 允许 Windows 8 应用程序和 Windows Phone 8 应用程序使用相同数据集的首选方法是什么？

> ID：13593737
> 
> 赞同：0
> 
> 时间：2012-11-27T21:48:13.973
> 
> 标签：c#-4.0, windows-8, winrt-xaml, windows-phone-8

我正在开发两个应用程序：一个 Windows 8 应用程序和一个 Windows Phone 8 应用程序。两个应用程序应使用相同的数据集。我希望多个用户能够访问和使用来自任一类型应用程序的数据（读取和写入）。

除了 Azure，还有什么推荐的方法来完成它？数据集会随着时间的推移而增长。

谢谢， 艾坦 B

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:42:47.420

如果数据因用户而异，那么您应该使用`SkyDrive`将每个用户的数据存储在他们的数据中`SkyDrive`，否则您必须使用自己的服务器来存储所有数据。即使您使用自己的服务器，您也可以使用`Live SDK`，以便用户可以使用他们的`Microsoft Account`.

# apache-flex - Flex 4.6 一切可拖动

> ID：13593741
> 
> 赞同：1
> 
> 时间：2012-11-27T21:48:26.500
> 
> 标签：apache-flex, adobe, flash-builder, rich-media

我刚刚使我的 itemrenderer（它在视图堆栈中）可拖动，但现在我遇到了以下问题，即我可以在我的视图堆栈中拖动所有东西。我只想拖动整个 itemrenderer 或它的一部分（封面）。此时我还可以拖动整个导航器内容和滚动条（！）。有人可以解决我的问题吗？提前谢谢！

（故障示例及其方式-> [http://d.pr/i/hjti](http://d.pr/i/hjti)）

```
<fx:Script>
    <![CDATA[
        // imports
        import mx.collections.ArrayCollection;
        import mx.controls.Alert;
        import mx.controls.Alert;
        import mx.core.DragSource;
        import mx.managers.DragManager;
        import mx.events.DragEvent;
        [Bindable]
        private var quantity : int = 0;
        private function initiateDrag(event:MouseEvent):void {
            var dragInitiator:List = event.currentTarget as List;
            var source:DragSource = new DragSource();
            source.addData(dragInitiator,"cart");
            var proxy:Image = new Image();
            proxy.source = event.target;
            proxy.width = 120;
            proxy.height = 150;
            proxy.x = (mouseX - (proxy.width * 3.25));
            proxy.y = (mouseY - (proxy.height * 3.25));
            DragManager.doDrag(dragInitiator, source, event, proxy);
        }
        private function dragEnterHandler(event:DragEvent):void {
            if (event.dragSource.hasFormat("cart")){
                DragManager.acceptDragDrop(event.currentTarget as Image);
            }
        }
        private function dragDropHandler(event:DragEvent):void{

            Alert.show("Gift added to your favorites");
        }
    ]]>
</fx:Script>

<mx:ViewStack id="myStack" width="100%" height="241"  change="doFilter();" creationComplete="doFilter()">

        <s:NavigatorContent label="Shooter"   >

            <!-- hier zet je een tussenruimte van 5-->
            <s:List left="10" top="7" width="100%" height="237" borderColor="#CC0000"
                    borderVisible="false" contentBackgroundAlpha="0.0"
                    dataProvider="{GamesLijst}" itemRenderer="itemrenderers.GameRenderer"
                    rollOverColor="#0492B1" dragMoveEnabled="true" dropEnabled="true" mouseDown="initiateDrag(event)">
                <s:layout >
                    <s:TileLayout horizontalGap="10" verticalGap="10" horizontalAlign="left" verticalAlign="top"/>
                </s:layout>
            </s:List>
        </s:NavigatorContent>
        <s:NavigatorContent label="Sport">
            <!-- hier zet je een tussenruimte van 5-->
            <s:List left="10" top="7" width="100%" height="231" borderColor="#CC0000"
                    borderVisible="false" contentBackgroundAlpha="0.0"
                    dataProvider="{GamesLijst}" itemRenderer="itemrenderers.GameRenderer"
                    rollOverColor="#0492B1"  dragMoveEnabled="true" dropEnabled="true" mouseDown="initiateDrag(event)">
                <s:layout >
                    <s:TileLayout horizontalGap="10" verticalGap="10" horizontalAlign="left" verticalAlign="top"/>
                </s:layout>
            </s:List>
        </s:NavigatorContent> 
```

我想将图像从视图堆栈中拖到图像中，这是代码：

```
<s:HGroup includeIn="Home" x="225" width="310" height="90" gap="30" textAlign="left" verticalAlign="middle"> <s:Image width="100" height="100" source="menu/home.png" click.Home="home_clickHandler(event)"/> <s:Image width="100" height="100" source="menu/fav.png" click.Home="favorites_clickHandler(event)" dragEnter="dragEnterHandler(event)" dragDrop="dragDropHandler(event)"/> <s:Image width="100" height="100" source="menu/cart.png" click.Home="cart_clickHandler(event)"/> </s:HGroup> 
```

# java - match() 匹配 Java 中必须以大写字母开头的单词

> ID：13593742
> 
> 赞同：1
> 
> 时间：2012-11-27T21:48:28.760
> 
> 标签：java, regex, string

所以，我一直在使用 Java 中的“matches()”方法。如：

```
Str1 = 'Jane';
Str1.matches("[A-Z][a-zA-Z]*"); 
```

查找字符串是否以大写字母开头，后跟任意数量的大/小字母。我似乎可以弄清楚所有配置，除非我尝试匹配未知数量的单词。例如，如果我想确认一个字符串仅由字母和空格组成，其中每个单词都以大写字母开头。我在想可以做

```
Str2 = 'Jane Marie Doe';
Str2.matches("[A-Z][a-zA-Z\\s]*"); 
```

就像在大写字母后跟任意数量的空格、大写字母和小写字母一样，但这不会强制执行每个空格都必须跟大写字母的规则。我是否需要标记（不确定这是否是正确的单词）或使用空格作为分隔符拆分我的字符串，然后评估每个单词？或者有没有办法将它输入到类似 ([AZ][a-zA-Z]\\s)* 的匹配方法中，其中星号表示括号中整个条目的任意数量？虽然当我输入这个时，我认为这甚至在概念上都行不通，因为最后一个单词后面没有空格。也许 ([AZ][a-zA-Z]\\s?)* 会起作用吗？但是，事实并非如此。有什么会吗？

我确实看到还有其他一些问题可以解决这个问题，但我似乎找不到明确的工作答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:52:20.020

试试这个：

```
([A-Z][a-zA-Z]*\s*)+ 
```

单个大写字母，后跟任意数量的其他字母，后跟任意数量的空格，重复任意次数。

根据您的情况，您可能还需要添加合法标点符号，例如连字符等。

所以，像：

```
([A-Z][a-zA-Z\-\']*\s*)* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:51:13.813

这应该有效：

```
"([A-Z][a-zA-Z]*\\s*)*" 
```

我只是更改`\\s?`为`\\s*`允许单词之间匹配多个空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:51:33.353

尝试以下正则表达式：

```
"[A-Z][a-zA-Z]*(\\s+[A-Z][a-zA-Z]*)*$" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-15T07:23:25.603

这将起作用

```
^([A-Z][a-zA-Z]*\s*)+$ 
```

# java - JTextPane 和 HTML

> ID：13593747
> 
> 赞同：-1
> 
> 时间：2012-11-27T21:48:43.533
> 
> 标签：java, html, swing, jtextpane

我正在制作一个大致类似于 microsoft word 的文本编辑器，并且我正在使用带有 HTML 的文本窗格。在做了一些研究之后，我找到了一种将 html 应用到使用 StyleConstants 的突出显示部分的方法，然后是 JTextPane.getStyledDocument().setCharacterAttributes(); 的方法。问题是当我使用文本窗格中的 getText() 方法时，缺少样式文本。例如，我在文本窗格中输入了一个普通字符串，getText() 返回 html 代码和文本。当我为文本设置样式并使用 getText() 时，所有样式化的单词都被删除并保留了普通单词。

我想要完成的是，将整个纯文本（包括 html）保存在文本文件中，当我将其加载备份并将其设置在 JTextPane 上时，它会保持其样式，但由于某种原因，样式文本是在“getText()”方法上删除，正常文本正常保留。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T06:38:04.553

[您可以按照此处http://java-sl.com/editor_kit_tutorial_reader_writer.html](http://java-sl.com/editor_kit_tutorial_reader_writer.html)的描述实现自己的自定义阅读器/编写器

当您使用 setCharacterAttributes 时，存储在 Elements 中的内容会留下属性，因此您可以根据需要访问和存储它们。

# r - gtext：指定行数

> ID：13593753
> 
> 赞同：1
> 
> 时间：2012-11-27T21:49:16.640
> 
> 标签：r, gwidgets

我在 R 中使用 gWidgets GUI 前端包。我可以`gtext()`以像素为单位指定高度，但是......如何以文本行数指定 gtext 的高度（如 html 中的 textarea ...）？

特别是，我只需要一行文本输入字段。就像`<input type="text">`在 html 中一样，但`gtext()`更像`<textarea>`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:36:17.423

一种解决方案（有点棘手），您可以使用**字体**度量来设置它。

```
library(gWidgets)
options(guiToolkit="RGtk2") 
w <- gwindow("brush example", visible=FALSE)

font.height <- 6   ## I don't know to get x-large metrics, so I fix it here
font.width  <- 50
obj <- gtext(container=w,height=5*font.height, width=5*font.width,
             font.attr=c(
  style="monospace", 
  color="blue", 
  size="x-large"))
add(obj,"mono blue large")
visible(w) <-  TRUE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T16:57:53.467

基于@jverzani 的评论 - 解决方案是`gedit`用于单行输入，如：

```
xyear <- gedit("1980", height = 1, horizontal = F) 
```

# c# - iTextSharp Html to Pdf image src

> ID：13593758
> 
> 赞同：6
> 
> 时间：2012-11-27T21:49:32.880
> 
> 标签：c#, itextsharp

使用 iTextSharp 将 html 转换为 pdf

```
public static MemoryStream CreatePdfFromHtml(
        string html, List<Attachment> attachments)
    {
        MemoryStream msOutput = new MemoryStream();

        using (TextReader reader = new StringReader(html))
        using (Document document = new Document())
        {
            PdfWriter writer = PdfWriter.GetInstance(document, msOutput);
            document.Open();

            foreach (var a in attachments)
            {
                var image = iTextSharp.text.Image.GetInstance(a.File);
                document.Add(image);
            }

            XMLWorkerHelper.GetInstance().ParseXHtml(writer, document, reader);

            writer.CloseStream = false;
            document.Close();
            msOutput.Position = 0;
            return msOutput;
        }
    } 
```

html以这种方式包含几个嵌入的图像。首选此方法，因为相同的 HTML 是`LinkedResources`使用`AlternateView`.

```
foreach (var a in attachments)
{
    //not production code
    html += string.Format("<img src=\"cid:{0}\"></img>", a.Id.ToString());
} 
```

但是，当生成 pdf 时，无法将图像 id 与html 标签的`src`一部分链接起来。`img`最终，pdf 包含顶部的所有图像，然后是`<img src...`被忽略的 HTML。

我已经使用 Paragraphs 或 ImageAbsolutePosition 阅读了几种可能的解决方案，但它们似乎不适合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-01T07:00:55.210

Look at [this site](http://www.draggerco.com/node/2), looks like this can work.

**EDIT:**

Here is the code and text from the Referenced Site

The people which have been working with iTextSharp and its HTMLWorker class for rendering one HTML page to PDF knows what I'm talking about: if the HTML contains images with relative path you'll probably get the "friendly" yellow screen!

![enter image description here](../Images/e0c8cf35bb1a78d78f06741c25815f36.png)

It means that iTextShap tried to get one image with the relative path "images/screenshot.3.jpg" as the local file "C:\images\screenshot.3.jpg", so, that image doesn't exist. After doing a lot of research about how to provide to iTextSharp the correct image I found that one guy mentioned the "IImageProvider" interface that gives to iTextSharp the ability of find the image using custom methods. Well, I have done one example using iTextSharp 5.0.2.0\. you can download it here.

First at all you have to create one class that implements the IImageProvider Interface:

```
public class CustomItextImageProvider : IImageProvider
{
    #region IImageProvider Members
    public iTextSharp.text.Image GetImage(string src, Dictionary<string,string> imageProperties, ChainedProperties cprops, IDocListener doc)
    {
        string imageLocation = imageProperties["src"].ToString();
        string siteUrl = HttpContext.Current.Request.Url.AbsoluteUri.Replace(HttpContext.Current.Request.Url.AbsolutePath, "");

        if (siteUrl.EndsWith("/"))
            siteUrl = siteUrl.Substring(0, siteUrl.LastIndexOf("/"));

        iTextSharp.text.Image image = null;

        if (!imageLocation.StartsWith("http:") && !imageLocation.StartsWith("file:") && !imageLocation.StartsWith("https:") && !imageLocation.StartsWith("ftp:"))
            imageLocation = siteUrl + (imageLocation.StartsWith("/") ? "" : "/") + imageLocation; 

        return iTextSharp.text.Image.GetInstance(imageLocation);
    }
    #endregion
} 
```

After it, you have to assign this image provider as the "img_provider" interface property of the HTMLWorker class before rendering the HTML Content:

```
HTMLWorker worker = new HTMLWorker(document);
Dictionary<string, object> interfaceProps = new Dictionary<string, object>() { 
    {"img_provider", new CustomItextImageProvider()}
};
worker.InterfaceProps = interfaceProps; 
```

Now, when you render your HTML it should work with relative images.

Althought this is one example made for ASP.Net, the main idea is how to create one custom Image Provider for iTextSharp when rendering HTML and it could be used on any application, also, this could help you not only for getting images from a relative location, I have used it (with more code, obviously) for getting images from SharePoint or Sites that require authentication.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:22:38.157

试试这个方法：

```
 PdfWriter writer = PdfWriter.GetInstance(document, msOutput);
            document.Open();
            HTMLWorker worker = new HTMLWorker(document);

            Dictionary<string, object> providers = new Dictionary<string, object>();
            //Get url of the application
            string url = "http://www.url.com/" //url from which images are loaded
            //Bind image providers for the application
            providers.Add(HTMLWorker.IMG_BASEURL, url);
            //Bind the providers to the worker
            worker.SetProviders(providers);

            document.Open();
            worker.StartDocument();

            // Parse the html into the document

            worker.Parse(reader);
            worker.EndDocument();
            worker.Close();
            document.Close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:08:13.230

我之前发现，当您在 Itextsharp html pdf 生成中使用相对路径时存在问题，正如您提到的，您可以使用 ImageAbsolutePosition 这将要求您使用段落来正确定位您的图像，或者如果您仍想使用 html，您将不得不给直接路径类似

```
 html += string.Format("<img src=https://www.mysite.com/"+a.Id.ToString()+".imageext"></img>"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T12:11:43.313

或者您可以使用 Server.MapPath 将虚拟路径转换为物理路径，如下所示：

```
imgPhoto.ImageUrl = Server.MapPath(imgPhoto.ImageUrl); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-09-09T05:03:03.907

```
var logo = iTextSharp.text.Image.GetInstance(Server.MapPath("../Images/mevantage-logo.jpg")); 
```

# java - 如何在 Java 中使用 JMF 包获取 CaptureDevices？

> ID：13593760
> 
> 赞同：1
> 
> 时间：2012-11-27T21:49:32.473
> 
> 标签：java, audio, capture, jmf

我刚开始在java中使用JMF包，当我用来获取我电脑的捕获设备时，它为我返回null。我不知道是什么原因以及我的代码是否错误！

对不起，如果我的问题很简单，但我很快就需要答案，所以我问了。

下面是代码：

```
 CaptureDeviceInfo di = new CaptureDeviceInfo();
 Vector deviceList = CaptureDeviceManager.getDeviceList(null); 
 if (deviceList.size() > 0)
         di = (CaptureDeviceInfo)deviceList.firstElement();
 else
     System.out.println("Not get"); 
```

# git - 如何让 GitHub 正确反映我在本地更改了分支名称？

> ID：13593761
> 
> 赞同：1
> 
> 时间：2012-11-27T21:49:39.590
> 
> 标签：git, github

我创建了一个名为“javascript-checkpoint”的分支。然后我将该分支推送到 GitHub。

然后我在本地将“javascript-checkpoint”的名称更改为“explore-checkpoints”。

然后我做了 git push，认为这样可以让 GitHub 显示 explore-checkpoints 来代替 javascript-checkpoint。但是 GitHub 没有显示名为 explore-checkpoints 的分支，只有 javascript-checkpoint。然后我做了'git push origin explore-checkpoints'，git 告诉我： * [新分支] explore-checkpoints -> explore-checkpoints 所以在我将它作为新分支推送之前，该分支不在 GitHub 上。现在 GitHub 将 javascript-checkpoint 和 explore-checkpoints 显示为两个独立的分支。在本地，我只有探索检查点。如何使 GitHub 显示相同？

我发现了一个类似的问题（[重命名远程分支](https://stackoverflow.com/questions/3981889/rename-remote-branch)），但是那个问题的提出者比我更关心它，所以其他人仍然可以从他的存储库中提取。我只关心制作它以便其他人可以*查看*我的代码。我是唯一在此存储库中*编辑*代码的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:53:52.113

有什么特别的原因为什么不能简单地删除“javascript-checkpoint”分支吗？

如果您只想删除额外的分支，只需运行`git push origin :javascript-checkpoint`以删除远程分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:54:09.163

您可以简单地删除以前的远程分支

```
git push :javascript-checkpoint 
```

您的第一次推送仍在使用第一次使用的远程跟踪分支：

```
git push  explore-checkpoint:javascript-checkpoint 
```

这就是为什么您没有立即看到第二个分支的原因。

# sql - 开发递归/层次结构查询

> ID：13593763
> 
> 赞同：4
> 
> 时间：2012-11-27T21:49:48.180
> 
> 标签：sql, sql-server

对于我无法解决的这个查询，我需要您的帮助。事情是这样的，假设我有一张这样的桌子：

```
Father | Son
1      |   2
1      |   3
1      |   4
3      |   5
3      |   6
2      |   7
4      |   8
5      |   9
6      |   10 
```

所以你可以看到表格代表父子关系，我需要找到一个父亲的所有儿子（以及儿子的儿子），例如，如果我要寻找 1 号的儿子，我们会得到一个像这样的表格这

```
Father | son
1      |   2
1      |   3
1      |   4
1      |   5
1      |   6
1      |   7
1      |   8
1      |   9
1      |   10 
```

如果我正在寻找 3 号的儿子，我们将得到：

```
Father | son
3      |   5
3      |   6
3      |   9
3      |   10 
```

好吧，我想你明白我的意思了。下一个问题是我必须为表中的每个父亲都这样做。所以最后，表格如下：

```
Father | son
1      |   2
1      |   3
1      |   4
1      |   5
1      |   6
1      |   7
1      |   8
1      |   9
1      |   10
3      |   5
3      |   6
3      |   9
3      |   10
2      |   7
4      |   8
5      |   9
6      |   10 
```

和翻过一棵树非常相似。我一直试图弄清楚这个查询一段时间但没有成功。我做了这样的代码

```
WITH  son
        AS (
              -- in 
            SELECT  FK_CC_B
            FROM    PG_Rols_CC  
            WHERE   FK_CC_A = @idCC
            UNION ALL
              --recur
            SELECT  t.FK_CC_B
            FROM     PG_Rols_CC AS t
                    JOIN hijos AS a
                      ON t.FK_CC_A = a.FK_CC_B
           )
insert into @TableSons (idSon) SELECT * FROM son 
```

但它不能同时适用于每个父亲，结果表有点不同，它只有儿子 ID。例子

```
son
3
4
5
6
7 
```

希望您能够帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:16:57.593

如果要获取所有父亲的后代，则需要去掉`WHERE`公用表表达式 (CTE) 第一部分中的子句。

如果要输出两列（Father 和 Descendent），则需要将这些列添加到 CTE 的两个部分。

像这样：

```
WITH Son
AS
(
    SELECT
        FK_CC_A AS Father,
        FK_CC_B AS Son
    FROM
        PG_Rols_CC
    UNION ALL
    SELECT
        f.Father,
        s.FK_CC_B AS Son
    FROM
        Son f
        INNER JOIN PG_Rols_CC s ON f.Son = s.FK_CC_A
)

SELECT * FROM Son 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:01:04.083

您需要从“递归”成员中引用“锚”部分......

做这样的事情：

```
WITH  son
        AS (
              -- in 
            SELECT  @Father, Son
            FROM    PG_Rols_CC  
            WHERE   FK_CC_A = @Father
            UNION ALL
              --recur
            SELECT  @Father, Son
            FROM     PG_Rols_CC AS t
                    JOIN son AS s
                      ON s.FK_CC_A = t.FK_CC_B
           )
SELECT * FROM son 
```

# java - 如何输出与输出平行的行号？

> ID：13593764
> 
> 赞同：0
> 
> 时间：2012-11-27T21:49:49.197
> 
> 标签：java, eclipse

下面是我的代码，它将从 URL 读取行并输出它。我想知道如何在 excel 中输出行号，例如行号。

```
import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URL;
import java.util.Scanner;

public class helloworld {

    public static void main(String[] args) throws IOException {
        URL yahh = new URL("https://docs.google.com/spreadsheet/pub?key=0AqSBI1OogE84dDJyN0tyNHJENkNyYUgyczVLX0RMY3c&single=true&gid=0&range=A2%3AA200&output=txt");
        BufferedReader in = new BufferedReader(
                    new InputStreamReader(
                    yahh.openStream()));

        String inputLine;

        while ((inputLine = in.readLine()) != null)

            System.out.println(inputLine);

        in.close();

    }
} 
```

**当前输出为：**

```
11111
22222
33333
44444
55555
66666
77777
88888
99999
100000 
```

**我希望它是**

```
1   11111
2   22222
3   33333
4   44444
5   55555
6   66666
7   77777
8   88888
9   99999
10  100000 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:51:35.950

在每次迭代时在循环中声明一个`line number`变量和它：`increment`

```
 int line=0;
 while((inputLine = in.readLine()) != null){
       line++;
       System.out.println(line + "\t" + inputLine); 
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:51:55.170

使用变量作为输出中的行数，由制表符分隔：

```
 int rowCount = 1;
    while ((inputLine = in.readLine()) != null){
        System.out.println(rowCount +"\t" + inputLine);
        rowCount ++;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:52:09.857

你应该使用标签

```
int i = 1;
while ((inputLine = in.readLine()) != null)
  System.out.println(i++ + "\t" + inputLine); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:52:16.323

如果您确定永远不会有大量数字，则可以使用选项卡，如下所示：

```
 int line=0;
 while ((inputLine = in.readLine()) != null){
       line++;
            System.out.println(line + "\t" + inputLine); 
    } 
```

如果你想确保防止非常大的数字，你可以做一些更花哨的事情，比如：

```
 int line=0;
 while ((inputLine = in.readLine()) != null){
       line++;
            System.out.println(String.format("%8s%s",line,inputLine)); 
    } 
```

其中数字`8-1=7`是您期望拥有的最多位数。

除此之外，您必须想出一个非常复杂的答案，基本上循环一次以检测最大尺寸数，然后从那里开始。但我会把它作为练习留给读者；-)

# image - Foxpro-添加具有动态路径的图像

> ID：13593767
> 
> 赞同：0
> 
> 时间：2012-11-27T21:50:00.540
> 
> 标签：image, ole, foxpro

在 FoxPro 报表编写器中，如何添加动态生成图像路径的图像？例如，图像将是：“C:\images\”+ 客户 + “.bmp”。

我尝试将它添加到一个变量中，然后将该变量引用为 OLE 对象文件路径，但它在运行报告时要求提供图像。

我发现了过去编写的其他报告，它们引用了一个名为“cBitamp”的变量。我在报告中的任何地方都找不到该变量。如果我在记事本中打开 FRX 文件，我可以看到变量甚至列出的路径（该文件不可读，但出现了一些文本）——所以我不确定他们以前是如何做到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:49:22.510

好的，我解决了。你实际上可以输入一个表达式作为文件路径，所以在我的例子中，我有类似的东西：

```
"D:\Images\" + ALLTR(customer) + ".BMP" 
```

# youtube-api - 检索“Vanity”频道的 Youtube 频道信息

> ID：13593769
> 
> 赞同：10
> 
> 时间：2012-11-27T21:50:09.617
> 
> 标签：youtube-api

给定一个频道的“虚名 url”（例如 youtube.com/wheelockcollege，它指向 youtube.com/wheelockmarketing1），有没有办法检索频道详细信息？

我正在使用 API 的新版本 3，以及最新的 Python 包。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-28T00:09:25.910

可能首先使用搜索：

```
GET https://www.googleapis.com/youtube/v3/search?part=snippet&q=wheelockcollege&type=channel&key={YOUR_API_KEY} 
```

然后使用频道 ID，您可以获得频道详细信息：

```
GET https://www.googleapis.com/youtube/v3/channels?part=snippet%2CcontentDetails%2Cstatistics&id=UC6ltI41W4P14NShIBHU8z1Q&key={YOUR_API_KEY} 
```

在这种情况下，结果是：

```
{
 "kind": "youtube#channelListResponse",
 "etag": "\"PsChdkLfsD-u3yuH7KChIH1CRFg/fl8vHBnZ66nKyI7QvfTRQchTAAA\"",
 "pageInfo": {
  "totalResults": 1,
  "resultsPerPage": 1
 },
 "items": [
  {
   "id": "UC6ltI41W4P14NShIBHU8z1Q",
   "kind": "youtube#channel",
   "etag": "\"PsChdkLfsD-u3yuH7KChIH1CRFg/zyApGa6dWMliWq5iBE5SL4ewNaQ\"",
   "snippet": {
    "channelId": "UC6ltI41W4P14NShIBHU8z1Q",
    "title": "wheelockmarketing1",
    "description": "Since 1888, Wheelock College has been providing a transformational education to students passionate about making the world a better place—especially for children and families.\n\nWhile most of our students elect to work in the helping professions of education, social work, child life, and juvenile justice and youth advocacy, many pursue—and make exceptional contributions to—a wide variety of professions.\n\nAs a highly respected advocate for social policy, Wheelock also helps to shape and strengthen the social systems that positively impact children and families around the globe.",
    "thumbnails": {
     "default": {
      "url": "https://i3.ytimg.com/i/6ltI41W4P14NShIBHU8z1Q/1.jpg?v=4fdf2807"
     }
    }
   },
   "contentDetails": {
    "relatedPlaylists": {
     "likes": "LL6ltI41W4P14NShIBHU8z1Q",
     "favorites": "FL6ltI41W4P14NShIBHU8z1Q",
     "uploads": "UU6ltI41W4P14NShIBHU8z1Q"
    }
   },
   "statistics": {
    "viewCount": "10354",
    "commentCount": "1",
    "subscriberCount": "43",
    "videoCount": "91"
   }
  }
 ]
} 
```

如果初始搜索返回多个结果，我们就会遇到问题，但我相信这是一个很好的策略 :)

# linux - 在 Linux 中自动重复命令

> ID：13593771
> 
> 赞同：320
> 
> 时间：2012-11-27T21:50:24.497
> 
> 标签：linux, bash, ubuntu

Linux命令行中是否可以每*n*秒重复一次命令？

说，我有一个导入正在运行，我正在做

```
ls -l 
```

检查文件大小是否在增加。我想要一个命令让这个自动重复。

* * *

## 回答 #1

> 赞同：567
> 
> 时间：2012-11-27T21:51:47.167

每 5 秒观看一次...

`watch -n 5 ls -l`

如果您希望直观地确认更改，`--differences`请在命令之前附加`ls`。

根据 OSX 手册页，还有

> --cumulative 选项使突出显示“粘性”，呈现所有已更改位置的运行显示。-t 或 --no-title 选项关闭在显示屏顶部显示时间间隔、命令和当前时间的标题，以及以下空白行。

Linux/Unix 手册页可以在[这里找到](http://linux.die.net/man/1/watch)

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2012-11-27T21:52:31.593

```
while true; do
    sleep 5
    ls -l
done 
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2012-11-27T23:26:01.267

在 Busybox 中，“watch”不允许分秒，而“sleep”则允许。如果这对你很重要，试试这个：

```
while true; do ls -l; sleep .5; done 
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2017-03-12T18:46:07.443

`sleep`已经回来了`0`。因此，我正在使用：

```
while sleep 3 ; do ls -l ; done 
```

这比米哈伊尔的解决方案短一点。一个小缺点是它在第一次运行目标命令之前休眠。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-12-16T16:04:11.903

如果命令包含一些特殊字符，例如管道和引号，则需要在命令中添加引号。例如，要重复`ls -l | grep "txt"`，watch 命令应该是：

`watch -n 5 'ls -l | grep "txt"'`

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-10-13T07:41:10.720

当我们使用`while`.

作为命令：

```
while true ; do command ; sleep 100 ; done &
[ ex: # while true;  do echo `date` ; sleep 2 ; done & ] 
```

例子：

```
while true
do echo "Hello World"
sleep 100
done & 
```

不要忘记最后一个`&`，因为它会将您的循环置于后台。但是您需要使用命令“ps -ef | grep your_script”找到进程 ID，然后您需要将其杀死。因此，请在运行脚本时添加“&”。

```
# ./while_check.sh & 
```

这是与脚本相同的循环。创建文件“while_check.sh”并将其放入其中：

```
#!/bin/bash
while true; do 
    echo "Hello World" # Substitute this line for whatever command you want.
    sleep 100
done 
```

然后通过键入运行它`bash ./while_check.sh &`

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-03-31T02:02:33.137

手表很好，但会清洁屏幕。

```
watch -n 1 'ps aux | grep php' 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-11-04T14:45:04.683

如果您想避免“漂移”，这意味着您希望命令每 N 秒执行一次，而不管命令需要多长时间（假设它花费的时间少于 N 秒），这里有一些 bash，它将每 5 秒重复一次命令，其中一个 -秒精度（如果跟不上会打印出警告）：

```
PERIOD=5

while [ 1 ]
do
    let lastup=`date +%s`
    # do command
    let diff=`date +%s`-$lastup
    if [ "$diff" -lt "$PERIOD" ]
    then
        sleep $(($PERIOD-$diff))
    elif [ "$diff" -gt "$PERIOD" ]
    then
        echo "Command took longer than iteration period of $PERIOD seconds!"
    fi
done 
```

由于睡眠仅精确到一秒，它可能仍会漂移一点。您可以通过创造性地使用 date 命令来提高这种准确性。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-06-27T18:05:10.440

如果您想执行特定次数的操作，您可以随时执行以下操作：

```
repeat 300 do my first command here && sleep 1.5 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-11-27T22:14:23.227

您可以运行以下命令并仅过滤大小。如果您的文件被调用 `somefilename`，您可以执行以下操作

`while :; do ls -lh | awk '/some*/{print $5}'; sleep 5; done`

众多想法之一。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-09-14T13:47:45.267

要更轻松地减少漂移，请使用：

```
while :; do sleep 1m & some-command; wait; done 
```

由于 bash 运行循环结构和实际执行 sleep 命令的时间，仍然会有少量漂移。

提示：':' 评估为 0，即为真。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-08-02T08:22:37.860

一个简洁的解决方案，如果您想重复运行命令直到它失败，它特别有用，并且可以让您查看所有输出。

```
while ls -l; do
    sleep 5
done 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-11-17T10:59:12.123

```
watch -n 5 'ls -l 
```

`ls -l`每 5 秒运行一次命令

# 输出 ：-

```
Every 5.0s: ls -l                                                                                                      Fri Nov 17 16:28:25 2017

total 169548
-rw-rw-r--  1 sachin sachin     4292 Oct 18 12:16 About_us_Admission.doc
-rw-rw-r--  1 sachin sachin      865 Oct 13 15:26 About_us_At_glance.doc
-rw-rw-r--  1 sachin sachin     1816 Oct 13 16:11 About_us_Principle.doc
-rw-rw-r--  1 sachin sachin     1775 Oct 13 15:59 About_us_Vission_mission.doc
-rw-rw-r--  1 sachin sachin     1970 Oct 13 16:41 Academic_Middle_school.doc
-rw-rw-r--  1 sachin sachin      772 Oct 16 16:07 academics_High_School.doc
-rw-rw-r--  1 sachin sachin      648 Oct 16 13:34 academics_pre_primary.doc
-rw-rw-r--  1 sachin sachin      708 Oct 16 13:39 academics_primary.doc
-rwxrwxr-x  1 sachin sachin     8816 Nov  1 12:10 a.out
-rw-rw-r--  1 sachin sachin    23956 Oct 23 18:14 Ass1.c++
-rw-rw-r--  1 sachin sachin      342 Oct 23 22:13 Ass2.doc
drwxrwxr-x  2 sachin sachin     4096 Oct 19 10:45 Backtracking
drwxrwxr-x  3 sachin sachin     4096 Sep 23 20:09 BeautifulSoup
drwxrwxr-x  2 sachin sachin     4096 Nov  2 00:18 CL_1
drwxrwxr-x  2 sachin sachin     4096 Oct 23 20:16 Code
drwxr-xr-x  2 sachin sachin     4096 Nov 15 12:05 Desktop
-rw-rw-r--  1 sachin sachin        0 Oct 13 23:12 doc
drwxr-xr-x  4 sachin sachin     4096 Nov  6 21:18 Documents
drwxr-xr-x 27 sachin sachin    12288 Nov 17 13:23 Downloads
-rw-r--r--  1 sachin sachin     8980 Sep 19 23:58 examples.desktop 
```

# python - Tweepy：[Errno 8] 节点名或服务名提供，或未知

> ID：13593773
> 
> 赞同：3
> 
> 时间：2012-11-27T21:50:33.050
> 
> 标签：python, twitter, tweepy

我正在使用 Tweepy 下载约 27,000 名用户的推文。我在 3 天前运行了脚本，它运行了好几个小时都没有问题。我停止运行它 2 天，然后当我去重新启动它时，我不得不添加一小部分，因为我忘记在对用户时间线的调用中包含转发。

然而，现在，当我运行它时，它会随机运行一段时间（有时它会运行 3 个用户，有时会运行 100 个用户，不止于此，介于两者之间）。每次，在某些时候它会说：

```
[Errno 8] nodename nor servname provided, or not known 
```

我不知道这是什么原因造成的。谷歌搜索它会从其他库中找到大量内容，但与 Tweepy 无关。这只是网络问题（连接断开）还是 Tweepy 有问题？

```
CONSUMER_KEY = '**'
CONSUMER_SECRET = '**'
ACCESS_KEY = '**'
ACCESS_SECRET = '**'

auth = tweepy.OAuthHandler(CONSUMER_KEY, CONSUMER_SECRET)
auth.set_access_token(ACCESS_KEY, ACCESS_SECRET)
api = tweepy.API(auth)

bill_authors = [id1, id2, id3, ...]

for author in bill_authors:
    try:
        for status in tweepy.Cursor(api.user_timeline, id=author, include_rts=True).items():
            lowerb = datetime.datetime(2012, 8, 26, 0, 1)
            upperb = datetime.datetime(2012, 8, 30, 0, 1)
            if status.created_at >= lowerb and status.created_at <= upperb:
                print '%s - %s - %s - %s' % (status.id, status.created_at, author, status.text)
            if status.created_at < lowerb:
                break
    except tweepy.TweepError, e:
        print 'Error! %s' % (e) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-13T19:15:17.293

This is definitely nothing to do with your code. The error suggests it might be a DNS problem, or some other network issue. I doubt this has anything to do with Tweepy, so I would recommend retrying your script.

# java - 更改上游项目中的速度日志文件位置

> ID：13593775
> 
> 赞同：1
> 
> 时间：2012-11-27T21:50:42.363
> 
> 标签：java, logging, velocity

我有一个 Java Web 应用程序，它使用一个初始化/配置 Velocity 的库。

我们正在将此项目从 WebLogic 迁移到 Tomcat。

应用程序现在抛出错误，追踪到 Velocity。初始化 Velocity 时，日志文件的默认位置是应用程序无权写入的目录，因此永远不会初始化 Velocity。

我试图`velocity.properties`在我的目录中的上游项目中创建一个文件`WEB-INF/classes`（镜像 Velocity jar 文件本身的文件夹结构），但这似乎没有改变任何东西。Velocity 仍然无法初始化。

有谁知道一种方法来完成我所描述的？我不想接触正在初始化 Velocity 的库——我宁愿只覆盖上游项目中的日志文件位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:36:47.957

在您的 WEB-INF 目录中查看 web.xml 并寻找`<param-name>configURI</param-name>`它，它`<param-value>`就是下面的内容。

例如我的 web.xml 有这个

```
<init-param>
    <param-name>configURI</param-name>
    <param-value>WEB-INF/scripts</param-value>
</init-param> 
```

在我的 WEB-INF/scripts 中是我的 velocity.properties 文件所在的位置

这是 velocity.properties 中控制日志文件位置的属性

```
runtime.log = 
```

它指定了我的 velocity.log 的完整路径

我的看起来像这样

```
runtime.log =/var/log/velocity.log 
```

# javascript - 如果 html 页面没有特殊链接，则使用 Javascript 发出警报

> ID：13593777
> 
> 赞同：-4
> 
> 时间：2012-11-27T21:50:51.193
> 
> 标签：javascript, html, web

javascript 函数必须搜索网页（html 正文）中的特殊链接（版权网址）。
如果它没有找到特殊的 url，则必须发出警报。

**JavaScript 文件示例：**

```
if () {

//If function find the copyright links, then null - don't make anything
}
else
//If function doesn't find copyright links, then give an alert
alert("Please protect original copyright links.") 
```

**html页面示例：**

```
<html>
<head>
<script type='text/javascript' src='http:// ... file.js'></script>
</head>

<body>

  <!-- Start Copyrigt Area -->
  <div id="footer">
    <a href="http://example1.com">example1.com</a>
    <a href="http://example2.com">example2.com</a>
  </div>
  <!-- End Copyrigt Area -->

</body>
</html> 
```

> **为什么？**
> 
> 我为特殊的博客社区网站制作了一些主题。有时，我们的主题用户会删除或更改页脚区域中的版权链接。
> 
> 博客社区网站不支持像php这样的动态内容，我们只能在一个页面中使用html和一些特殊的内容标签。
> 
> 另一方面，该站点不允许JS托管等。因此，由第三方托管服务提供商提供的JS文件。
> 
> 我不想加密代码。所以我认为我们使用 JavaScript 函数检查链接。如果我们的链接被删除或更改，则用户必须收到警报。
> 
> 也许，一些主题用户发现这些 javascript 函数并将它们删除并重新托管代码。但我想他们中的大多数人会什么都做不了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:57:10.877

这取决于您如何编写html。假设页脚元素始终存在：

```
if (document.getElementById('footer').childNodes.length == 0) {

//If function find the copyright links, then null - don't make anything
}
else
//If function doesn't find copyright links, then give an alert
alert("Please protect original copyright links.") 
```

但请记住，这只是计算你放在那里的东西。

如果您没有放入版权，而您的页脚不存在，请查看 peehaa 的评论。

但是，应该注意的是，您似乎只是在引用版权区域中的链接。就像说 - 我知道这项措施对安全没有任何作用，但如果您关心，这里有指向权利所有者的链接。如果这是真的，那就太好了。干得好。如果您确实需要安全措施来保护页面上的内容，这不会保护任何东西。

# django - Django View 返回 JSON 失败，CSRF

> ID：13593782
> 
> 赞同：0
> 
> 时间：2012-11-27T21:51:10.507
> 
> 标签：django, csrf

我写了一个简单的 Django 视图：

```
from django.http import HttpResponse
from django.utils import simplejson
from django.views.decorators.csrf import csrf_exempt  # just add

@csrf_exempt
def handleRequest(request, intervention_code):
    result = {}
    norm_str = ''
    ........
    return HttpResponse(simplejson.dumps(result), mimetype='application/json') 
```

该视图不使用模板，仅查询数据库并以 JSON 格式返回数据。我可以轻松地检索 JSON 对象`http://myserver/myurl`

不幸的是，我必须使用 javascript 库来发出 POST AJAX 请求以获取相同的 JSON 对象，并且我遇到了典型的 Django CSRF 失败。

当我这样做时：`curl -d "sometext=foobar" http://myserver/myurl/`我得到了相同的结果。我从 Django 文档中实现了所有推荐的 CSRF 中间件，但仍然出现错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:38:45.413

Django 的文档[描述](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax)了如何让 CSRF 与 Ajax 一起工作。

# c# - 如何减少此代码中的耦合

> ID：13593784
> 
> 赞同：4
> 
> 时间：2012-11-27T21:51:26.597
> 
> 标签：c#

在工作中，我正在做这个应用程序，它从外部文件（Excel 工作表、文本文件……）中获取值，并将这些值转换为复杂的指令，然后输入另一个系统。

下面的代码有点简化（没有指令和非常简单的逻辑），但想法保持不变。我有大约 60 名不同的翻译器，它们背后运行着不同类型的业务逻辑。有些只需要一个参数即可运行。其他人则采用多个论点。

我有一个抽象翻译类。该类的用户将使用 2 个公共方法：Translate 运行翻译逻辑，CanTranslate 允许查看翻译器是否准备好启动。

使用此抽象类的开发人员需要实现包含实际业务逻辑的 DoTranslate 方法。默认情况下，CanTranslate 始终返回 true，但如果需要验证，则可以覆盖它。

这是抽象翻译器基类：

```
// Contains some base logic which is the same for all translators
public abstract class BaseTranslator
{
    // Public translate method
    public void Translate()
    {
        if (CanTranslate())
            DoTranslate();
    }

    // Checks if we are ready to translate
    // True by default
    public virtual bool CanTranslate()
    {
        return true;
    }

    // This method is used to implement business logic
    public abstract void DoTranslate();
} 
```

这是一个具体的翻译类的实现：

```
// Translates beer names
public class ReverseTranslator : BaseTranslator
{
    // Use of properties to allow strongly typed arguments
    // which can be seen by the developer at design time
    public string BeerName { get; set; }

    // Validation
    public override bool CanTranslate()
    {
        if (BeerName.Equals("Budweiser") || BeerName.Equals("Stella"))
            return true;
        else
            return false;
    }

    // Implementation of the business logic
    public override void DoTranslate()
    {
        char[] letters = BeerName.ToCharArray();
        Array.Reverse(letters);
        Console.WriteLine(new string(letters));
    }
} 
```

这是使用时的样子：

```
class Program
{
    public static void Main(string[] args)
    {
        var translator = new ReverseTranslator();

        translator.BeerName = "Stella";
        translator.Translate();

        translator.BeerName = "I'm not a beer";
        // This line will not translate since it's not a valid beer name.
        translator.Translate();

        Console.ReadLine();
    }
} 
```

专业人士：

*   在小的可维护单元中分离特定的业务逻辑
*   翻译器很容易在应用程序的其他部分重用
*   翻译器可以很容易地进行单元测试
*   属性允许翻译器的用户查看需要哪些参数

我的问题：

*   不同的控制器类正在使用许多翻译器。我有太多的耦合。

我曾想过使用工厂模式来创建翻译器，但后来我不能在设计时使用属性作为参数提示。

所以我基本上是在寻找一种解决方案，在设计期间你可以很容易地看到需要哪些参数。同时我希望通过不让每个控制器都有 30 个新的 xTranslator 语句来减少耦合。

PS：我仅限于此代码使用 .NET 3.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:54:25.543

```
different controller classes are using many translators. I have too much coupling 
```

控制器类应该只依赖于抽象，即`BaseTranslator`. 因此你不会有太多的耦合，实际上它会是松耦合的代码。通过依赖注入（例如通过构造函数参数）将依赖注入到您的控制器中。

使您的代码仅依赖于基类型的一种选择 -`Text`在基类中创建字符串属性：

```
BaseTranslator translator = new ReverseTranslator(); // inject implementation
translator.Text = "Stella";
translator.Translate();
translator.Text = "I'm not a beer";
translator.Translate(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:17:07.833

我突然想到有一些矛盾的地方：

*   一方面，翻译作者可以定义自己的具体类（并添加新的“强制”属性，这些属性必须具有值才能使具体类正常工作）
*   另一方面，您依赖于其他人在代码中定义的新具体类，因为您是实例化类并向它们传递正确参数的人

如果这是正确的，我相信您还没有为您的模型找到合适的抽象级别。换句话说，您当前的抽象对您根本没有帮助（或多或少），因为它在每个具体类中都得到了扩展。所以我的建议是先看看模型本身（但这只是一个猜测，因为我不知道你的模型:-)）。

如果您能够提供一个包含 7-10 个具有代表性的具体类名的列表以及他们希望我们更好地了解您的域的输入值，那么这里的某个人可能会更好地指导您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:09:44.740

**要获得具体类的特定参数的设计时信息：** *您需要使用具体类的实例*。
**为了减少控制器中的耦合：** *您需要限制自己的抽象类实例*。
*你不能同时在同一个地方。*

重新设计您的整体设计，您可以消除耦合并消除对设计时间信息的需求。

将转换器的创建和初始化从控制器移到工厂或 IoC 容器中，该容器将外部文件中的一行数据作为输入（如果需要，将其按摩成可以使用的格式）。

让翻译人员需要一个带有参数集合的构造函数。
好处：

*   只有具体类本身需要知道它自己或其参数的细节。
*   工厂需要有关在哪种情况下使用哪个翻译器的信息。

.

```
class TranslatorFactory
{
    //translator lookup table
    private Dictionary<string, Func<List<string>,BaseTranslator>> Translators = 
        new Dictionary<string,Func<List<string>,BaseTranslator>>{
            {"Reverse", (args)=>new ReverseTranslator(args)},
            {"Explode", (args)=>new ExplodeTranslator(args)}        };

    public BaseTranslator GetTranslatorForRow(string command, List<string> arguments)
    {
        if(Translators.ContainsKey(command) )
        {
             return Translators[command](arguments);
        }
        return null; //or default, or throw exception
    }
}

abstract class BaseTranslator
{
    ...
    public BaseTranslator(List<string> args)
    {
    }
}

class ReverseTranslator: BaseTranslator
{
    public string BeerName {get;set;}
    public ReverseTranslator(List<string> args)
    {
        BeerName = args[0];
    }
} 
```

您可以更进一步，使用属性和反射来消除工厂和具体类之间的耦合，以动态构建查找表。

```
[TranslatorFor("Reverse")]
class ReverseTranslator: BaseTranslator
{
    ...
} 
```

# javascript - Javascript 错误，文件管理器无法使用带有撇号的名称

> ID：13593788
> 
> 赞同：1
> 
> 时间：2012-11-27T21:51:44.577
> 
> 标签：javascript, apostrophe

所以我有一个文件管理器（如果你们中的任何人使用过它，类似于 HFS）......无论如何，当为各种文件操作提交 ajax 函数时，如果文件名中有撇号 (')，它就不起作用。它提交名称的整个部分，直到出现撇号为止。

通常提交一个ajax函数它只是运行类似

```
$.post("?mode=section&id=ajax.delete", {
    filename: selectedFilesAsStr(),
}); 
```

这是javascript...

```
function selectedItems() { return $('#files .selector:checked') }

function selectedFilesAsStr() {
var a = [];
selectedItems().each(function(){
    a.push(getItemName(this));
});
return a.join(":");
}

function getItemName(el) {
if (typeof el == 'undefined')
    return false;
// we handle elements, not jquery sets  
if (el.jquery)
    if (el.size())
        el = el[0];
    else
        return false;
// take the url, and ignore any #anchor part
var s = el.getAttribute('href') || el.getAttribute('value');
s = s.split('#')[0];
// remove protocol and hostname
var i = s.indexOf('://');
if (i > 0)
    s = s.slice(s.indexOf('/',i+3));
// current folder is specified. Remove it.
if (s.indexOf(HFS.folder) == 0)
    s = s.slice(HFS.folder.length);
// folders have a trailing slash that's not truly part of the name
if (s.slice(-1) == '/')
    s = s.slice(0,-1);
// it is encoded
s = (decodeURIComponent || unescape)(s);        
return s;
} // getItemName 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T07:52:49.507

将撇号替换为

*`($("#text).val()).replace("'",'&apos;');`*

# java - If-Modified-Since 日期格式

> ID：13593796
> 
> 赞同：11
> 
> 时间：2012-11-27T21:51:55.217
> 
> 标签：java, date, date-format

我正在编写一个服务器，我想检查“If-Modified-Since:”标头。
既然有这么多日期方法，我应该考虑检查哪些方法，就像通常的方法（浏览器中使用毫秒）......

以下是我对毫秒格式的处理方式：

```
 Date date;

 //dateS is a substring of If-Modified-Since: header
 try{
  long mills = Long.parseLong(dateS);
  } catch (NumberFormatException e)
   {e.printStackTrace();
  }
  date = new Date(mills); 
```

我还想检查“2005 年 10 月 19 日星期三 10:50:00 GMT”格式。如何将该日期更改为毫秒？

```
 SimpleDateFormat dateFormat = new SimpleDateFormat(
                "EEE, dd MMM yyyy HH:mm:ss z");

        // to check if-modified-since time is in the above format
        try {

            ifModifiedSince = dateFormat.parse(date);
            ?????????????????????
        } catch (ParseException e1) {
        } 
```

请帮我修改上述内容，并告诉我是否有任何日期格式需要检查……</p>

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-27T22:11:10.227

HTTP 应用程序历来允许三种不同的日期/时间戳表示格式：

```
Sun, 06 Nov 1994 08:49:37 GMT  ; RFC 822, updated by RFC 1123
Sunday, 06-Nov-94 08:49:37 GMT ; RFC 850, obsoleted by RFC 1036
Sun Nov  6 08:49:37 1994       ; ANSI C's asctime() format 
```

[HTTP/1.1 RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html)中的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:57:41.923

As you already have the `Date` object, you can use:

```
long timeInMillis = ifModifiedSince.getTime(); 
```

# java - LinkedList的实现方式，Java

> ID：13593808
> 
> 赞同：1
> 
> 时间：2012-11-27T21:52:31.250
> 
> 标签：java, data-structures, linked-list, append, nodes

我正在读这本书，在喜欢的列表上有这一章，它从单个链表的实现开始，它是这样的：

创建链接列表：

```
class Node {
    Node next = null;
    int data;

    public Node(int d) {
        data = d;
    }

    void appendToTail(int d) {
        Node end = new Node(d);
        Node n = this;
        while (n.next != null) {
            n = n.next;
        }
        n.next = end;
    }
} 
```

我的问题：

首先：我无法理解这是如何工作的。理解它真的那么复杂还是我错过了什么？

第二：这个“节点”类可以被认为是一个链表吗？我知道它缺少一些功能，但这是一个独立的链接列表吗？

第三：我用谷歌搜索了 java 中的 LinkedList 实现，并查看了 java api 中的原始类，这是一种完全不同的方法。我应该坚持什么方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:12:55.807

这段代码的问题在于，`Node`类同时是一个*节点*和一个*链表*，比较混乱。除此之外，它应该非常简单。

```
class Node {
    Node next = null;
    int data; 
```

保存列表中的`next`下一个节点。如果是最后一个节点，则持有`null`. 是与此节点关联的`data`数据，在这种情况下是类型`int`（顺便说一句，它应该是`final`）。

```
public Node(int d) {
    data = d;
} 
```

这是一个简单的`constructor`方法，它只是将参数复制到它的字段。它代表列表的头部和列表本身。

```
void appendToTail(int d) {        
    Node n = this;
    while (n.next != null) {
        n = n.next;
    } 
```

这是找到见面的地方。我重新排列了代码以使其更易于理解。该`appendToTail`方法在列表的和处添加一个节点。在上面的代码中，它遍历列表（从列表`this`的头部开始）以找到*最后一个*节点（`next`字段设置为的那个`null`）。

```
 Node end = new Node(d);
    n.next = end;
} 
```

这里创建了一个新节点并将其作为下一个节点添加到当前*最后*一个节点，从而使其成为列表的最后一个节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:15:04.003

接下来是下一条数据的链接。

[数据|next->][数据|next->] .... [ ]

next 就像一个指针，它指向下一个 Node。

appendToTail 创建一个节点和链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-12T22:26:32.253

一般来说，**Node**类应该尽可能小。节点的主要功能是；

*   存储节点的值
*   存储对**下一个 Node**实例的引用（或指针）

最简单的 Node 类的写法应该和上面类似；

```
public class Node<E> {
    protected E value;
    protected Node<E> next;

    public Node(E value) {
        this.value = value;
    }
} 
```

然后，您可以使用此通用**Node**类编写自定义**LinkedList实现。**

 **在您问题中的特定示例代码中，他们已经在**Node类中实现了****append**方法，我认为这不是一个好习惯。相反，追加应该在**LinkedList**类中，因为该方法不属于**Node**类的职责。

 ******### LinkedList 中的追加方法

在不同来源上实施的方法可能会有所不同。但是 append 方法本身看起来基本相同。在实现之前，您必须了解 append 方法的逻辑。

当链表为空时，head 指向一个空值。Head 是字段，LinkedList 类的成员，用于存储 Linked List 的起始节点。

当您将值附加到链接列表时，首先，head 与第一个附加值一起存储，然后，第二个值将是一个新节点，head 的下一个引用或指针指向该节点。等等。您可以在下面查看状态；

```
// Initial state of the Linked List
// Head is null

HEAD = NULL

// Append 40 to the Linked List 
// Head stores value 40, but next reference is null.

HEAD(40) --> NULL

// Append 10

HEAD(40) --> (10) --> NULL

// Append 20

HEAD(40) --> (10) --> (20) --> NULL

// Append 50

HEAD(40) --> (10) --> (20) --> (50) --> NULL

// Append 100

HEAD(40) --> (10) --> (20) --> (50) --> (100) --> NULL 
```

很明显，Linked List 总是以 NULL 引用结束，这在遍历列表时非常有用。必须有一个点，一个暗示“这是路的尽头，终止穿越这条路”的标记

您还可以查看我为下面的示例编写的简约简单的链表实现；

# LinkedList 的极简实现

```
public class CustomLinkedList<E> {

    private Node<E> head;

    public CustomLinkedList() {
        this.head = null;
    }

    public void appendToList(E value) {
        if(head == null)
            head = new Node<E>(value);
        else {
            Node<E> temp = head;

            // get the end node into the temp
            while(temp.next != null)
                temp = temp.next;

            // temp is the tail now
            // append new Node next to the tail
            temp.next = new Node<E>(value);
        }
    }

    public void printList() {
        if(head == null)
            return;

        System.out.print("List: ");

        Node<E> temp = head;
        while( temp != null ) {
            System.out.print(temp.value.toString() + " ");
            temp = temp.next;
        }

        System.out.println();
    }

} 
```

# 演示代码

```
public class DemoCustomLinkedList {

    public static void main(String[] args) {
        CustomLinkedList<Integer> linkedList = new CustomLinkedList<>();

        linkedList.appendToList(40);
        linkedList.appendToList(10);
        linkedList.appendToList(20);
        linkedList.appendToList(50);
        linkedList.appendToList(100);

        linkedList.printList();
    }

} 
```

演示输出

```
List: 40 10 20 50 100 
```********

# facebook - 登录后 Facebook 重定向到非安全版本的页面选项卡

> ID：13593809
> 
> 赞同：0
> 
> 时间：2012-11-27T21:52:33.967
> 
> 标签：facebook, http, redirect, https

我正在开发一个托管在安全服务器上的 Facebook 应用程序，但是由于该应用程序请求权限，因此用户必须登录才能访问，但是当用户登录 facebook 时，url 会从这里重定向：

```
https://www.facebook.com/mypage/app_xxxxxxxx 
```

对此：

```
http://www.facebook.com/mypage/app_xxxxxxxx 
```

他们我得到一个 404 错误。我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:55:01.240

这实际上是一种用户设置，Facebook 很快就会强制进行更改。

[http://techcrunch.com/2012/11/18/facebook-https/](http://techcrunch.com/2012/11/18/facebook-https/)

# sql - 使用 Embarcadero DBArtison 9.0 处理 SQL 错误并输出到 csv/txt

> ID：13593813
> 
> 赞同：0
> 
> 时间：2012-11-27T21:52:47.710
> 
> 标签：sql

我正在创建一个脚本，它允许我提取一些关于数据库中表的数据质量的基本指标。我们这样做的方法是计算每列中存在的空白字段、空值等。我有两个明显的问题。第一个处理错误处理，第二个处理 SQL I/O。

**错误处理：** 我创建了一个光标，它将遍历提供的所有表和列。对于 90% 的列，我需要将其转换为 LONG，但是其他一些列有字母，所以我得到一个无效的转换错误。如何设置一个 if 语句，在转换之前将列的数据类型与 Varchar/Text 进行比较，以免出现错误？

**SQL 输出：**运行光标后，我需要将数据移动到 csv 或 txt 文件。我只有对数据库的读取权限，所以我不能编写程序或做 BCP。有没有办法解决这个问题？

```
--Declare a table variable to hold your table names (and column names in case needed) 
```

声明 @listOfTablesToUpdate 表 (tableName varchar(100), columnNameToUpdate varchar(50))

谢谢你的帮助，

反相

```
--insert the tables that you want to work with.
--insert into @listOfTablesToUpdate values ('customer_ref', 'aml_rec_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'customer_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'bank_num')
insert into @listOfTablesToUpdate values ('customer_ref', 'peer_grp_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_crd_rating')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_income')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_net_worth')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_invest_obj')
insert into @listOfTablesToUpdate values ('customer_ref', 'last_ofac_scan')
insert into @listOfTablesToUpdate values ('customer_ref', 'relationship_mgr_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'relationship_typ_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'tss_kyc_risk_rating')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_addr_link_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'customer_parent_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'status_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_description_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'fin_entity')
insert into @listOfTablesToUpdate values ('customer_ref', 'ultimate_parent_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'cust_create_date')
insert into @listOfTablesToUpdate values ('customer_ref', 'si_lob_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'ges_ucn_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'employee_ind')
insert into @listOfTablesToUpdate values ('customer_ref', 'nds_lob_cd')
insert into @listOfTablesToUpdate values ('customer_ref', 'lcl_fin_entity')
insert into @listOfTablesToUpdate values ('customer_ref', 'business_line')
insert into @listOfTablesToUpdate values ('customer_ref', 'system_feeder_id')
insert into @listOfTablesToUpdate values ('customer_ref', 'last_update_date')

--Cursor for iterating
declare @tableCursor cursor,
        @tableName varchar(100),
        @tableName_ret varchar(100),
        @columnName varchar(50)

set @tableCursor = cursor for select tableName,columnNameToUpdate from @listOfTablesToUpdate

open @tableCursor
fetch next from @tableCursor into @tableName, @columnName
while(@@fetch_status = 0)

begin
    --dynamic sql
   declare @sqlCommand varchar(1000)
   declare @sqlCommand2 varchar(1000)

    --Your logic here...this is just an example
Set @sqlCommand = 'Select
max(' +@columnName + ') as Max_Value_' +@columnName +', ' +
'
min(' + @columnName + ') as Min_Value_' +@columnName + ', ' +
'
Cast(sum (case when Cast(' + @columnName + ' as FLOAT) =0 then 1.0 else 0 end) as FLOAT) as ZeroCount, ' +
'
Count(Distinct(' + @columnName + ')) as DistinctCount

 from AML.dbo.' + @tableName
Exec(@sqlCommand)

 Set @sqlCommand2 = 'Select
 count(*) as Null_SpaceCount
 from AML.dbo.' + @tableName + '
 where (' + @columnName + ' is null) or (len(ltrim(' + @columnName + '))=0 or len(rtrim(' + @columnName + '))=0)'

 Exec(@sqlCommand2)

  fetch next from @tableCursor into @tableName, @columnName
end

close @tableCursor
deallocate @tableCursor

-- max(' +@columnName + ') as Max_Value`` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:00:30.790

If you're using `SQLCMD` to run the script, you can use `-o output_file` option.

# android - HttpResponse 响应 = httpclient.execute(httppost); 即使使用 ASYNCTASK 也无法在 Android 4 中工作

> ID：13593818
> 
> 赞同：1
> 
> 时间：2012-11-27T21:53:09.990
> 
> 标签：android, android-asynctask, http-post, runtime-error

我知道我不应该在 UI 线程上运行与网络相关的东西，因此我使用 asynctask 通过远程服务器上的 php 从数据库中读取一些东西。但是，当代码到达 --HttpResponse response = httpclient.execute(httppost);-- 我收到错误 -- java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0 -- 因此代码不起作用。

请注意，我这样调用 asyncTask —— new dataRetrievalViaAsyncTask().execute(url,url,url); （第二个和第三个“url”是虚拟的，因为它们没有被使用）——在 oncreate() 中。

那里有什么问题？

```
class dataRetrievalViaAsyncTask extends AsyncTask<String, String, String>
{
    @Override
    protected void onPreExecute()
    {
        super.onPreExecute();
    }

    @Override
    protected String doInBackground(String... f_url)
    {
        Log.i("tag", "inside doInBackground");
        String url2 = f_url[0];
        Log.i("tag", url2);

        HttpClient httpclient = new DefaultHttpClient();
        Log.i("tag",    "done : HttpClient httpclient = new DefaultHttpClient();");

        HttpPost httppost = new HttpPost(url2);
        Log.i("tag", "done : HttpPost httppost = new HttpPost(url);");

        try
        {

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            Log.i("tag",    "done : httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));");
            HttpResponse response = httpclient.execute(httppost);
            Log.i("tag",    "done : HttpResponse response = httpclient.execute(httppost);");
            HttpEntity entity = response.getEntity();
            Log.i("tag",    "done : HttpEntity entity = response.getEntity();");
            is = entity.getContent();
            Log.i("tag", "after : is = entity.getContent();");

        } catch (Exception e)
        {
            Log.e("log_tag", "Error in http connection" + e.toString());
        }
        // convert response to string
        return "a";

    }

    @Override
    protected void onPostExecute(String result)
    {
               // enter code here

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:09:05.663

为了避免进一步混淆，请执行以下操作：

```
class dataRetrievalViaAsyncTask extends AsyncTask<String, Void, Void>
{ 
```

显示您不使用其他变量。

所以你会这样做：

```
 dataRetrievalViaAsyncTask().execute(url, null, null); 
```

然后在您的 catch 块中将其更改为：

```
 catch (Exception e)
    {
        Log.e("log_tag", "Error in http connection", e);
    } 
```

然后您将获得正确的堆栈跟踪，希望能够使用类/方法名称和行号进行调试。

我假设您的清单中有 INTERNET 权限。

唯一可以拥有 ArrayIndexOutOfBounds 的地方是：

```
 String url2 = f_url[0]; 
```

这意味着您没有将字符串 URL 正确发送到 ASyncTask。

另一个问题是您正在使用一个`nameValuePairs`变量，但不要向我们展示它是如何实例化的。我会赌**这**是你的问题。

# c++ - C++，重载运算符 + 用于 Matrix

> ID：13593819
> 
> 赞同：-2
> 
> 时间：2012-11-27T21:53:19.550
> 
> 标签：c++, matrix, operators, operator-overloading

是否可以重载运算符 +

```
template <typename U>
Mat <T> operator + ( const Mat <U> &A ); 
```

对于以下矩阵运算

```
Matrix (1,1) + scalar      = scalar
scalar + Matrix (1,1)      = scalar
Matrix(1,1) + Matrix(1,1)  = scalar 
```

和语法（或类似的）？

```
template <typename T, typename U>
T operator + ( const Mat <U> &M ) const; 
```

更新的问题：

作为模板参数的维度：

```
template <typename T, typename U, const unsigned int TDim>
T operator + ( const Mat <U> &M, TDim <dim> ) const; 
```

专业化为 dim=1

```
template <typename T, typename U>
T operator + ( const Mat <U> &M, TDim <1> ) const; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:54:54.313

除非矩阵的维度被制成 的模板参数`Mat`，并且您部分地专门化了矩阵的`Mat`模板。`1x1`

或者，您可以返回`Matrix(1,1)`然后转换为标量。如果您这样做，您将不得不接受转换在运行时失败的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:59:20.617

你*可以*超载`operator +`做任何你喜欢的事情。主要问题是，您如何定义矩阵和标量的相加？即使您向 1x1 矩阵添加标量，传统数学仍然无法定义操作，因为 1x1 矩阵仍然是向量，而不是标量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:37:26.940

如果我想这样做（并且像这样的自动转换可能既危险又烦人），我会专门`Matrix<1,1,T>`使用一个`operator T()`（或使用`enable_if`类型 mojo，这样我就不必做样板）。

然后标量加法将通过将`Matrix`a转换`T`为 a来工作`T`，而不是显式覆盖 in `Matrix`。此外，您的 1x1`Matrix`可以直接`T`隐式转换为您似乎也想要的。

顺便说一句，另一个真正自然的对应关系是从标量到标量乘以任何大小的单位矩阵，反之亦然。1x1 矩阵情况是这种情况的一个特例，因为所有 1x1 矩阵都是单位矩阵乘以标量。

因此，转换（从标量到单位矩阵乘以标量）可能有意义并且需要一些覆盖。相反的转换更危险，因为在编译时做检查是不合理的，所以它可能会失败。

# c - Segmentation Fault C语言读一个简单的单词

> ID：13593822
> 
> 赞同：0
> 
> 时间：2012-11-27T21:53:28.087
> 
> 标签：c, gcc, segmentation-fault, feof

我正在使用 CodeBlocks、GCC 和 C 语言编写。我的代码如下：

```
char word[50];
FILE *fn;
fn = open("word.txt", "rb");
if(fn == NULL) perror("File not opened");
while(!feof(fn))
{
    fscanf(fn, "%s", word);
} 
```

文本文件中只有一个单词（目前是“batman”）。我尝试了此代码的各种版本，包括以下内容：

```
char* word;
char = malloc(50);
FILE *fn;
fn = open("word.txt", "rb");
if(fn == NULL) perror("File not opened");
while(!feof(fn))
{
    fscanf(fn, "%s", &word);
} 
```

老实说，我不知道为什么（以及为什么这应该如此困难），但 CodeBlocks 给我的错误是 feof 行中可怕的 SIGSEV 分段错误。当我没有执行 while 循环时， fscanf 会引发分段错误。请帮忙！我不经常使用 C 语言工作，现在我记得为什么了。即使是最简单的事情也可能如此困难。提前致谢。

更新：我实际上已经通过将开放行更改为：

```
fn = fopen("C://Temp//word.txt", "rb"); 
```

这如何与相对路径一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:10:26.417

改变

```
fn = open("word.txt", "rb"); 
```

到

```
fn = fopen("word.txt", "rb"); 
```

[`open`](http://linux.die.net/man/2/open)返回一个`int`，它*不是*一个`FILE*`。[`feof`](http://linux.die.net/man/3/feof)并[`fscanf`](http://linux.die.net/man/3/scanf)期望一个`FILE*`不是 int 作为它的第一个参数，这就是为什么`feof()`并且如果你删除它，`fscanf()`segfaults 的原因。

正如其他人已经指出的那样，更改`fscanf(fn, "%s", &word)`为`fscanf(fn, "%s", word)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:58:13.530

假设这个词是一个 char * （你的代码不清楚），这个指令会给你带来问题：

```
fscanf(fn, "%s", &word); 
```

只需通过以下方式更改它：

```
fscanf(fn, "%s", word); 
```

另外，我建议您使用 fopen 函数而不是 open，因为 fscanf 使用 fopen 提供的描述符。

# perl - 在文件中使用 perl 单行搜索

> ID：13593825
> 
> 赞同：-6
> 
> 时间：2012-11-27T21:53:37.150
> 
> 标签：perl

我有一个看起来像这样的文件：

```
dee    123    
bee    555    
dee    56    
cee    29    
dee    30    
cee     13 
```

我需要这样的输出：

```
dee  123,56,30    
bee  555    
cee   29,13 
```

如何使用 perl one-liners 执行此任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:43:59.940

```
perl -alnwe '
    push @{$a{$F[0]}}, $F[1]; 
    }{ 
    for (keys %a) { print $_, "  ", join ",",@{$a{$_}} } ;' 
```

**输出：**

```
cee  29,13
dee  123,56,30
bee  555 
```

**解释：**

*   `-a`空格上的自动拆分输入行
*   `-l`处理换行符
*   `-n`假设`while(<>)`循环程序
*   `@F`数组来自自动拆分，`$F[0]`是`$F[1]`数组元素。
*   `%a`是我们存储结果的地方，第一列作为键，第二列作为数组
*   `}{`爱斯基摩操作员，用`-n`开关做的和`END`块一样

在最后一节中，我们只打印键和值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:22:23.980

这将使您大部分时间到达那里（“x”是文件名）：

```
perl -ane 'm/^([^ ]+) +(\d+)/; if ($name{$1} ne "") { $name{$1} .= ","; }; $name{$1} .= $2; END { foreach (sort(keys(%name))) { print $_ . "    " . $name{$_} . "\n"; } }' x 
```

这个单线的输出：

```
bee    555
cee    29,13
dee    123,56,30 
```

# jsf - JSF 如何从支持 bean 重定向到支持 bean 中动态构建的 URL？

> ID：13593832
> 
> 赞同：11
> 
> 时间：2012-11-27T21:54:13.940
> 
> 标签：jsf, primefaces

一个例子应该有望证明这个问题。我在页面上显示了 10 个文档，其中 3 个包含在 zip 包中的附加信息。在初始页面加载期间，我只知道哪些文档有这些附加信息，我*不*知道这些 zip 文件的 URL。然后，我显示一个链接（“获取 Zip 包”）指向包含附加 zip 文件的 3 个文档。当用户单击“获取 Zip 包”时，它会调用支持 bean 中的一个方法，该方法会进入数据库以找出 zip 包的 URL。完成后，我想将 zip 包提供给浏览器，然后浏览器会弹出另存为...对话框，用户可以保存 zip 包。

我尝试了两种方法，但它们都不起作用。

**方法一**

```
<p:commandLink actionListener="#{myBackingBean.zipPackage(aDocument)}"
               value="Get Zip Package"
               ajax="false"
               rendered="#{aDocument.packageAvailable}"/> 
```

```
public String zipPackage(DocItem item){
  //logic here to figure out the URL for this item's zip package
  return packageLink;
} 
```

**方法二**

```
<h:outputLink onclick="getPackageLink([{name:'product', value: '#{aResult.product}'}, {name:'version',value:'#{aResult.version}'}])"
   <h:outputText value="Get Documentation Package"/>
</h:outputLink>
<p:remoteCommand name="getPackageLink" actionListener="#{kbBackingBean.zipPackage()}"/> 
```

```
public String zipPackage() {
  Map map = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap();
  String product = (String) map.get("product");
  String version = (String) map.get("version");
  //logic here to figure out the URL for this item's zip package
  return packageLink;
} 
```

当页面加载并显示 10 个文档时，“获取 Zip 包”链接（用于 3 个文档）指向任何内容，基本上与页面具有相同的 URL。当我单击它时，它会向服务器发送一个 GET 请求并调用支持 bean 函数。使用方法 1，浏览器在开始呈现响应之前似乎确实在等待支持 bean 方法完成。使用方法 2，无需等待，浏览器会立即重新加载页面。我怀疑由于“获取 Zip 包”链接指向页面本身，浏览器的 GET 请求首先得到处理，而支持 bean 方法的响应只是丢失了。

我怀疑可以正常工作的第三种方法（我还没有尝试过）是调用一个 Servlet，然后它会提供 zip 包。但是看到我有一个指向 zip 包的直接 URL，我希望有一种方法可以在不涉及 Servlet 的情况下将其提供给浏览器。

任何允许我在不调用 Servlet 的情况下使用 URL 的建议或方法都非常受欢迎。当然，如果 Servlet 是这样做的唯一“正确”方式，我肯定会这样做。

谢谢你。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-27T22:26:38.927

您可以尝试使用这种逻辑：

```
ExternalContext context = FacesContext.getCurrentInstance().getExternalContext();
context.redirect(context.getRequestContextPath() + "download-page.jsf?product=" + product + "&version=" + version); 
```

# android - “隐形”将视图添加到 FrameLayout

> ID：13593834
> 
> 赞同：0
> 
> 时间：2012-11-27T21:54:31.847
> 
> 标签：android, android-layout, android-camera

我正在设置一个有两个视图的框架布局——一个是 ImageView，另一个是相机预览。这是代码：

```
public void setUpCamera(){
    //Set cameraView as the camera preview class
    cameraView = new CameraPreview(getApplicationContext());
    //Set imageResult as an image
    imageResult = new ImageView(getApplicationContext());

    imageResult.setBackgroundColor(Color.GRAY);

    //Prime the frame and buttons from the xml file
    frameLayout = (FrameLayout) findViewById(R.id.camera_preview);
    snapPhoto = (Button) findViewById(R.id.button_capture);

    //Add both camera preview and the snapped picture to the FrameLayout in the xml file 
    frameLayout.addView(imageResult);
    frameLayout.addView(cameraView);

    frameLayout.bringChildToFront(imageResult); 
```

现在我的问题是是否可以将cameraView“隐形”添加到FrameLayout中？这是一件小事，但是在设置相机时，您会在通过bringChildToFront 方法将图像带到前台之前获得相机预览模式的闪光。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:58:02.320

你是追求`setVisibility(View.GONE)`还是`setVisibility(View.INVISIBLE)`？

GONE 调整您的布局，就好像视图没有完全丢失一样，INVISIBLE 保持任何间距。

# xcode - iPad 4 宽度/高度混淆？

> ID：13593835
> 
> 赞同：1
> 
> 时间：2012-11-27T21:54:43.330
> 
> 标签：xcode, ipad, height, width

我一直致力于使 iPhone 应用程序适应 iPad。由于必须以不同方式缩放和放置许多资产，因此在重新定位所有内容方面需要做一些工作。

我注意到的一件事是，在 iPad mini 上，如果我们使用以下代码：

```
CGFloat height = [UIScreen mainScreen].currentMode.size.height;
CGFloat width = [UIScreen mainScreen].currentMode.size.width; 
```

返回的高度是 1024。这是 iPad 的长边。但是，如果我使用 iPad 4 并询问高度，我会得到 1536 - 这是 iPad 4 的较短边缘。我尝试在启动时翻转 iPad 等等，但似乎没有任何结果想要（iPad 4 的高度 = 2048）。还有其他人有这个问题吗？这似乎是苹果方面的一个错误......除非我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:18:33.997

这听起来确实像一个错误，但您可以通过使用`bounds`而不是`currentMode`. 后一个属性是物理屏幕的测量值，以像素为单位——显然可以有任意方向——而前者是逻辑屏幕区域，以点为单位（你更有可能在其中布置 UI） ，并且应该在所有现有 iPad 上保持一致。

# jquery - 寻找一种更优雅的方式来写这个

> ID：13593842
> 
> 赞同：0
> 
> 时间：2012-11-27T21:55:06.760
> 
> 标签：jquery

我有一个基本上看起来像这样的表：

```
​&lt;table id="mytable">
   <tbody>
       <tr id="tempRowID">
           <td class="delete"> <img src="myImage.png" /> </td>
       </tr>
   </tbody>
</table>​​​​​​​​​​​​​​​​​​​ 
```

单击 img 时，我需要将表 ID 放入变量中。这个函数正在工作，但在所有 parent() 跳转时看起来都很丑：

```
$(document).on('click', 'table td', function () {

    var currentTable = $(this).parent().parent().parent().attr("id");

}); 
```

我试过了：

```
 var currentTable = $(this).eq(3).attr("id");
    var currentTable = $(this).find("table").attr("id"); 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:57:17.670

用于[`.closest`](http://api.jquery.com/closest/)获取最近的祖先是`table`.

```
var currentTable = $(this).closest("table").attr("id"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:56:51.737

怎么用[`.closest()`](http://api.jquery.com/closest/)

```
var currentTable = $(this).closest('table').attr("id"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:56:58.717

使用`.closest()`方法

```
var currentTable = $(this).closest('table').attr("id"); 
```

# mingw - 使用mingw进行交叉编译

> ID：13593844
> 
> 赞同：0
> 
> 时间：2012-11-27T21:55:15.547
> 
> 标签：mingw, cross-compiling

我有需要在 64 位 Intel 机器（Windows 7）上通过 mingw 编译的代码。然后它必须在 64 位 AMD 虚拟机（Windows 7）上运行。目前它适用于英特尔，但不适用于 AMD 虚拟机。我需要交叉编译它以使其工作吗？如果是这样，我会怎么做？我对mingw不是很熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T20:47:02.510

我已经通过运行标志解决了我的`./configure`问题`--enable-runtime-cpudetect`。

# c# - 如何使用 EF 代码优先 POCO 创建视图

> ID：13593845
> 
> 赞同：48
> 
> 时间：2012-11-27T21:55:17.183
> 
> 标签：c#, linq, entity-framework, ef-code-first

就这么简单。我需要使用 Code First创建一个**视图。**我在谷歌和 SO 上都没有发现任何关于这个的信息。有没有办法做到这一点？

我需要使用 linq 创建和查询该视图，因此它不是使用数据库创建脚本创建它的解决方案，例如：

```
var results = from c in db.Customer
join v in db.MyView on c.Id equals v.Id
select c; 
```

解决方法也是可以接受的。我需要一种针对非常量/非实体值查询实体的方法。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-09-09T21:35:46.943

您必须手动创建视图，就像 AnatoliiG 所说的那样。（[向表中添加索引](https://stackoverflow.com/questions/5040795/adding-index-to-a-table/5041221#5041221)）。

您将视图的名称作为属性添加到您的类

```
[Table("UserDTO")]
    public class UserDTO
{
    /* Class code here */
} 
```

您可以通过在末尾指定 -IgnoreChanges 属性来创建空迁移

```
Add-Migration MigrationName -IgnoreChanges 
```

这为您提供了一个可以手动修改的空迁移脚本。

您可以使用您的数据库上下文在迁移脚本中执行您的代码

```
public partial class editUserDTO : DbMigration
{
    public override void Up()
    {
        string script =
        @"
        CREATE VIEW dbo.UserDTO
        AS SELECT p.PersonId AS UserId, p.FirstName, p.LastName, u.UserName
        FROM dbo.Users u
        INNER JOIN dbo.People p ON u.PersonId = p.PersonId";
        BloggingContext ctx = new BloggingContext();
        ctx.Database.ExecuteSqlCommand(script);
    }

    public override void Down()
    {
        BloggingContext ctx = new BloggingContext();
        ctx.Database.ExecuteSqlCommand("DROP VIEW dbo.UserDTO");
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-08-04T16:15:01.303

只是提醒一下，在 EF 6.1 中（不确定是否更早）现在有一个`Code First from Database`选项可供您使用，它也将映射到视图。

我个人在一个单独的垃圾项目中拥有我的，所以我可以从中取出我想要的代码，而不会影响我实际使用数据库的项目。使用它`Add a New file to your project -> Data -> ADO.NET Entity Data Model`

然后选择该`Code First From Database`选项并选择您的视图（如果需要，还可以选择其他表格）

它将像 Fred 在他的回答中所说的那样将其创建为表映射，但会为您完成所有代码，这很好。不过，您可能希望更改索引和排序。

然后只需打电话给`Sql(@"YOUR VIEW CREATE SQL HERE")`你`Up`并`Sql(@"DROP STATEMENT HERE")`在你的`Down`

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-03-30T05:17:34.297

[来自EF7](https://github.com/aspnet/EntityFramework/issues/4561)的官方问题线程的很多很好的见解：

1)**没有 DbSet，而是有一个属性或扩展方法**

A) 财产

```
class YourContext
{
    public IQueryable<YourView> YourView 
    {
        get
        {
            return this.Database.SqlQuery<YourView>("select * from dbo.YourView");
        }
    }
} 
```

B) 扩展方法

```
static class YourContextExtensions
{
    public static IQueryable<YourView>(this YourContext context)
    {
        return context.Database.SqlQuery<YourView>("select * from dbo.YourView");
    } 
```

2)**显然，您可以让迁移过程忽略某些数据库集**

```
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
  if (IsMigration)
    modelBuilder.Ignore<YourViewTable>();
 ...
} 
```

（以上都是未经测试的）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-11-27T22:22:54.500

您无法使用 EF Code First 方法创建视图。如果要创建视图，请在`Seed`方法中执行创建 sql 脚本。但是您仍然无法将实体映射到此视图，除非通过创建和删除与您的视图具有相同名称的表来破解模型。

一些有用的链接：

*   [如何首先使用 EF 4 代码将对象映射到视图？](https://stackoverflow.com/questions/3595786/how-map-objects-to-a-view-with-ef-4-code-first)
*   [如何使用 Entity Framework 4 Code-First 定义数据库视图？](https://stackoverflow.com/questions/5889905/how-do-i-define-a-database-view-using-entity-framework-4-code-first)

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2017-05-23T11:56:25.627

您不能从 EF Code First 创建视图，您应该在“种子”脚本中添加脚本以预填充视图。

# java - android 数组列表排序

> ID：13593847
> 
> 赞同：0
> 
> 时间：2012-11-27T21:55:20.957
> 
> 标签：java, android, sorting

我有一个字符串数组列表，其值如下

```
2.25mm
2.75mm
5mm
5.5mm 
```

对没有小数位的值进行排序时，排序不正确。5.5mm 前进 5mm，其中 2.25mm 正确前进 2.75mm

我对比较器没有任何经验，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:58:54.967

您将这些排序为字符串，并且字符`m`出现在字符之前`.`。

`mm`仅删除和对解析`BigDecimal`值进行排序可能会更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:00:59.373

由于您将条目排序为`String`，因此它的行为不像字符表示法中的数字排序那样，`.`(ASCII 46)位于`m`(ASCII 109) 之前，因此`5.5mm`比`5mm`.

通过剥离创建另一个小数点列表`mm`，对新的小数点列表进行如下排序：

```
 List<BigDecimal> decimalList = new ArrayList<BigDecimal>();
      for(String elem: myList){
         decimalList.add(new BigDecimal(elem.substring(0, elem.length()-2)));
      }
      Collections.sort(decimalList); 
```

如果需要，可以将排序后的**字符串**列表重新创建为：

```
 myList.clear();
      for(BigDecimal elem: decimalList){
          myList.add(elem.doubleValue()+"mm");
      } 
```

# c# - 字段中的多个单词搜索

> ID：13593850
> 
> 赞同：1
> 
> 时间：2012-11-27T21:55:25.763
> 
> 标签：c#, lucene.net

我最近开始在工作中使用 lucene.net 进行内部项目。我正在寻找使用 lucene.net 创建一种自动完成功能。我的索引存储显示名称，当我进行通配符搜索时，即 James*，它工作正常。

问题似乎是当空格出现在单词之间时，即 James Bon* 它似乎忘记了第一个单词并开始尝试匹配 Bon。

不确定我是否做错了什么，但尝试使用一些不同的分析器但没有运气。

有人有任何想法可以让我走上正轨吗？

**28/11/2012**

再次查看我的项目后，我意识到我正在使用 MultiFieldQueryParser 来尝试搜索多个字段。尝试了更改 DefaultOperator 的建议，但没有运气。

```
var analyzer = new StandardAnalyzer(Lucene.Net.Util.Version.LUCENE_30);
var mparser = new MultiFieldQueryParser(Lucene.Net.Util.Version.LUCENE_30, new string[] { "displayname", "company", "email" }, analyzer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:03:54.870

默认情况下，Lucene.net`OR`对提供的术语进行搜索，而不是`AND`搜索。使用此代码更改它：

```
parser.SetOperator(QueryParser.DEFAULT_OPERATOR_AND); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-15T11:41:30.140

如果您只是在单个字段上执行多词查询，那么您希望多词表现得像“喜欢”运算符，然后使用下面的行。

```
parser.DefaultOperator = QueryParser.Operator.AND; 
```

# c# - 如何在 OnLaunched() 事件中导航回上一页？

> ID：13593851
> 
> 赞同：0
> 
> 时间：2012-11-27T21:55:27.760
> 
> 标签：c#, windows-8, lifecycle, windows-store-apps, terminate

如果我的应用程序被 Windows 终止（例如，如果它已暂停，但 Windows 需要释放内存以便抢占我的应用程序），当它重新启动时，会发生 OnLaunched() 事件，我可以测试它是否已终止（或者用户只是关闭它）：

```
 . . .
        if ((args.PreviousExecutionState == ApplicationExecutionState.Terminated) ||
            (args.PreviousExecutionState == ApplicationExecutionState.ClosedByUser))
        {
        }
    . . . 
```

如果终止，我想在上一个位置/页面恢复，而不是在初始页面（如果不同）。我怎样才能做到这一点？伪代码可能是：

```
if (CurrentPage != LastSavedPage)
{
    CurrentPage = LastSavedPage;
    // or: Frame.Navigate(typeof(LastSavedPage)
} 
```

## 更新

所以这是我对我应该做的事情的看法，但我仍然“对此有疑问”（参见评论和代码）

```
// OnNavigateTo in each page:
Settings.Values["CurrentPageType"] = this.GetType();
Settings.Values["CurrentPageParam"] = args.Parameter; 
//Will the line directly above work even if args.Parameter is empty, or must I do something like:
if (null != args.Parameters)
{
     Settings.Values["CurrentPageParam"] = args.Parameter; 
}

//OnLaunched in app.xaml.cs
                if (args.PreviousExecutionState == ApplicationExecutionState.Terminated)
                {
                    if ((localSettings.Values.ContainsKey("CurrentPageType")) &&
                        (localSettings.Values.ContainsKey("CurrentPageParam")))
                    {
                        rootFrame.Navigate((Type)localSettings.Values["CurrentPageType"],
                                                                     localSettings.Values["CurrentPageParam"]);
                    }
                } 
```

## 更新 2

我收到此代码的异常：

```
 ApplicationData.Current.LocalSettings.Values["CurrentPageType"] = this.GetType();
    ApplicationData.Current.LocalSettings.Values["CurrentPageParam"] = args.Parameter; 
```

*mscorlib.dll 中出现“System.Exception”类型的异常，但未在用户代码中处理 WinRT 信息：尝试序列化要写入应用程序数据存储的值时出错附加信息：不支持此类型的数据。如果有这个异常的处理程序，程序可以安全地继续。*

如果我将“.ToString()”附加到对 GetType() 的调用中，它不会爆炸......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:26:24.957

只需记住您的应用程序在暂停时所在的最后一页的类型，并在新开始后导航到您的 App 类中的正确页面。这应该不难实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:49:40.430

当然！当您覆盖 OnNavigatedTo 时，您需要坚持两件事：

1）当前类的类型，例如：

```
Settings.Values["CurrentPageType"] = this.GetType(); 
```

2）传递给当前页面的参数，例如：

```
Settings.Values["CurrentPageParams"] = e.Parameters; 
```

第一个警告是您的参数必须是可序列化的。随你（由你决定。

第二个考虑因素是您的应用程序是否依赖于后台堆栈进行导航。如果是这样，那么您不仅需要坚持当前页面的类型，还需要坚持其背后的面包屑。这也取决于你。

然后就是这样：

```
Frame.Navigate(
    (Type)Settings.Values["CurrentPageType"], 
    Settings.Values["CurrentPageParams"]); 
```

请检查空值和类似的东西。但是，简而言之，就是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T01:58:21.197

要添加到其他答案（TL 跳到底部；DR 版本）...

如果您使用 C#/XAML Grid 或 Split 模板，或者向项目添加除空白页以外的任何内容，您将引入[SuspensionManager](http://msdn.microsoft.com/en-us/library/windows/apps/Hh986968.aspx)的“帮助器”类，它为您设置了大部分管道。

每个非空白页面都 extends `LayoutAwarePage`，它提供了`OnNavigatedTo`Jerry 提到的实现。但是，在每个页面中，您只需要填写 a`LoadState`和`SaveState`方法的主体 - 将您想要保留的任何内容放入`pageState`参数中。**它会保留用户所在的页面，而无需您执行任何操作**- 您只需添加任何要保存（和恢复）的其他数据。

`pageState`存储在应用程序目录中的文件中（与使用设置相比）。如果您手动设置设置，则必须确保所有内容都是 Windows 运行时类型（主要只是简单类型和数组），但使用 pageState 它也可以序列化对象。

> 查看示例演练[管理应用程序生命周期和状态](http://msdn.microsoft.com/en-us/library/windows/apps/Hh986968.aspx)以获取一些真实代码和进一步解释。

# ole - OLE 结构化存储等效项

> ID：13593857
> 
> 赞同：2
> 
> 时间：2012-11-27T21:55:57.803
> 
> 标签：ole, structured-storage

我想将一些带有一些文本和 nuber 文件的大量数据存储到一个文件中。我过去使用过结构化 OLE，我很喜欢它。但现在它似乎是一项相当古老的技术。我也考虑过使用 HDF 文件格式 [http://www.hdfgroup.org/HDF5/](http://www.hdfgroup.org/HDF5/)

但它不支持来自不同机器的单写多读。需要可扩展的存储，即基于文件的存储。

是否有任何其他我可以使用的简单文件格式，与此相同，但快速且易于实现？

沙市

# ruby-on-rails - Bundler、ExecJS、Mac OS X 和 Debian

> ID：13593866
> 
> 赞同：0
> 
> 时间：2012-11-27T21:56:57.730
> 
> 标签：ruby-on-rails, node.js, bundler

我正在 Mac OS X 10.8 上开发 Rails 并尝试使用*Capistrano*部署到**Debian Squeeze**。

部署给了我这个错误：

```
Could not find libv8-3.3.10.4 in any of the sources 
```

似乎我有`bundle package`-da Mac OS X binary gem：

```
Updating files in vendor/cache
...
* libv8-3.3.10.4-x86_64-darwin-12.gem 
```

有`Gemfile`：

```
gem 'therubyracer' 
```

我想使用二进制 gem，因为 Squeeze 不从包管理器中提供 Node.js，而且我想保持源代码在生产服务器之外编译。

有没有办法告诉 Bundler 打包**Linux**和 Darwin 二进制文件？

`therubyracer`顺便说一句，当它也[使用 Bundler](https://github.com/cowboyd/therubyracer/blob/master/Gemfile)时如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:06:44.917

安装`libv8`在你的 Debian 盒子上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:05:28.143

一种解决方案是跳过`bundle package`它将从源代码下载所有软件包，但他的部署对我**来说太慢**了（可能是 b/c 出于某种原因它仍然没有下载二进制 gem 并每次都重新编译 libv8）。

所以我最终`Node.js`从源代码安装到 Debian 盒子，并将其记录为项目的先决条件。然后我注释掉了这部分`Gemfile`：

```
group :assets do
  ...
  # gem 'therubyracer'
  ...
end 
```

现在我可以再次`bundle package`快速部署。

# python - 使用 IMAP 的唯一电子邮件标识符

> ID：13593869
> 
> 赞同：1
> 
> 时间：2012-11-27T21:57:07.560
> 
> 标签：python, django, gmail, imaplib

我正在 Django/Python 中创建一个 GMail 电子邮件界面。我想创建所有电子邮件的骨架，包含主题和日期，一种概览级别的索引，这样即使删除了一封电子邮件，我也有一个指示它存在以及何时发送。

我的问题是，考虑到 IMAP UID 发生了变化，我可以使用什么作为唯一的电子邮件标识符？即使我在我的数据库中使用唯一 ID 创建每封电子邮件的骨架，如果我将电子邮件 UID 和 IMAP 文件夹名称关联到它，当其他电子邮件被删除时，UID 可能会更改。

为电子邮件创建唯一标识符的最佳解决方案是什么？我正在考虑使用（发送日期，主题）组合，但我正在寻找更简单的东西。

有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:48:23.550

我的理解是 UID 不会改变......所以应该可以将它用作 IMAP/您的数据库之间的链接。

来自 RFC3501（更新 RFC822）- [http://www.limilabs.com/mail/rfc/3501](http://www.limilabs.com/mail/rfc/3501)

> 2.3.1.1。唯一标识符 (UID) 消息属性
> 
> 分配给每条消息的 32 位值，当与
> 唯一标识符有效性值（见下文）一起使用时，形成一个 64 位值
> ，该值不得
> 永远引用邮箱中的任何其他消息或任何具有相同名称的后续邮箱。唯一标识符
> 在邮箱中以严格的升序方式分配；当每条
> 消息被添加到邮箱时，它被分配一个比
> 之前添加的消息更高的 UID。与消息序列
> 号不同，唯一标识符不一定是连续的。
> 
> 消息的唯一标识符在
> 会话期间不得更改，并且不应在会话之间更改。
> 会话之间唯一标识符的任何更改都必须使用
> 下面讨论的 UIDVALIDITY 机制来检测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-28T10:39:55.883

我发现每个文件夹都有自己的 UID 种子，这意味着您将在不同文件夹中为不同的邮件拥有重复的 UID。RFC822 指定了另一个标识符，邮件的 Message-ID 标头，通常是自动生成的（例如 Gmail），您可以在邮件移动后使用它来修复您的 UID。IMAP 支持查询特定字段，如 UID、MessageID。

使用此组合键，您始终可以跟踪系统中的每条消息。

如果您自己进行发送，您可以生成自己的 MessageID。以下是如何生成它：

[http://www.jwz.org/doc/mid.html](http://www.jwz.org/doc/mid.html)

更多阅读：

[http://en.wikipedia.org/wiki/Message-ID](http://en.wikipedia.org/wiki/Message-ID)

# php - 如何使用 php 从 HTML 创建 pdf 文件，然后将其保存在服务器上

> ID：13593870
> 
> 赞同：3
> 
> 时间：2012-11-27T21:57:06.453
> 
> 标签：php, fpdf, dompdf

我有一个项目来保存用 php 动态创建的页面并将它们存储在服务器上。

我打算将页面的副本存储为 pdf；他们所有的图像、表格和布局。

我尝试使用这些工具：

*   [DOMPDF](http://eclecticgeek.com/dompdf/docs/index.php)
*   [FPDF](http://www.fpdf.org/?lang=en)

但老实说，我认为它不会走上正轨

有什么解决方案或者这些工具可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:07:56.147

我最近遇到了同样的问题，当您的 HTML 包含格式化的文本和图像时，我发现 fpdf 太复杂了。我让我的服务器管理员将 Webkit HTML 安装为 PDF。它工作得很好。

这个包将解析 HTML 文档中的样式表、图像、表格和任何其他元素，就像您使用 webkit 打开 Web 浏览器并将网页保存为 PDF 一样。

[http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)

```
/**
* Use wkhtmltopdf to convert an HTML file to PDF
*
* @param    string          URL to web page
* @param    string          Path to PDF file to be written
*
* @return   boolean         True if the command succeeded; false otherwise
*/
function htmlToPdf($source, $dest)
{
    // Build command
    $command = "/usr/bin/wkhtmltopdf $source $dest 2>&1";
    exec($command, $output);

    $s = sizeof($output) - 1;

    if (substr($output[$s], -4, 4) == 'Done')
    {
        return true;
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T20:30:21.263

来自[forosdelweb](http://www.forosdelweb.com/f18/aporte-ejemplo-crear-pdf-haciendo-clic-con-dompdf-919465/)

我们将创建一个类来在 convertToPDF.php 中进行转换

```
<?php 
/*----------------------------------------------------------/* 

$path     : name of the file pdf (without the extension) 
                i.e.: --> 'ejemplo' , 'pdfs/nuevo-ejemplo' 
                if empty --> it will be random 

$content  : content of the pdf 

$body     : true or false. 
                true  --> add; <doctype>, <body>, <head> to $content 
                false --> do not alter the $content 

$style    : the path of the CSS. It could be empty 
                 To load the css --> needs $body = true; 

$mode     : true or false. 
                true  --> save the file on the server and then show it  
                false --> ask where to save it  

$paper_1  : size of the paper[*] 
$paper_2  : style of the paper[*] 

    [*] To see more options:  
        --> http://code.google.com/p/dompdf/wiki/Usage#Invoking_dompdf_via_the_command_line 

/*----------------------------------------------------------*/  

require_once("dompdf/dompdf_config.inc.php"); 

function doPDF($path='',$content='',$body=false,$style='',$mode=false,$paper_1='a4',$paper_2='portrait') 
{     
    if( $body!=true and $body!=false ) $body=false; 
    if( $mode!=true and $mode!=false ) $mode=false; 

    if( $body == true ) 
    { 
        $content=' 
        <!doctype html> 
        <html> 
        <head> 
            <link rel="stylesheet" href="'.$style.'" type="text/css" /> 
        </head> 
        <body>' 
            .$content. 
        '</body> 
        </html>'; 
    } 

    if( $content!='' ) 
    {         
        //Añadimos la extensión del archivo. Si está vacío el nombre lo creamos 
        $path!='' ? $path .='.pdf' : $path = crearNombre(10);   

        //Las opciones del papel del PDF. Si no existen se asignan las siguientes:[*] 
        if( $paper_1=='' ) $paper_1='a4'; 
        if( $paper_2=='' ) $paper_2='portrait'; 

        $dompdf =  new DOMPDF(); 
        $dompdf -> set_paper($paper_1,$paper_2); 
        $dompdf -> load_html(utf8_encode($content)); 
        //ini_set("memory_limit","32M"); //opcional  
        $dompdf -> render(); 

        //Creamos el pdf 
        if($mode==false) 
            $dompdf->stream($path); 

        //Lo guardamos en un directorio y lo mostramos 
        if($mode==true) 
            if( file_put_contents($path, $dompdf->output()) ) header('Location: '.$path); 
    } 
} 

function crearNombre($length) 
{ 
    if( ! isset($length) or ! is_numeric($length) ) $length=6; 

    $str  = "0123456789abcdefghijklmnopqrstuvwxyz"; 
    $path = ''; 

    for($i=1 ; $i<$length ; $i++) 
      $path .= $str{rand(0,strlen($str)-1)}; 

    return $path.'_'.date("d-m-Y_H-i-s").'.pdf';     
} 
```

下一步是在这种情况下创建一个页面 index.php

```
<?php 

include('convertToPDF.php'); 

//$html= --> Aquí pondriamos por ejemplo la consulta 
$html=' 
<img src="http://pxd.me/dompdf/www/images/title.gif"/> 

<table> 
    <tr> 
        <th>Nombre</th> 
        <th>Tipo</th> 
        <th>Imagen</th> 
        <th>Comentario</th> 
        <th>Unidades</th> 
        <th>Precio unidad</th>     
    </tr>     
    <tr> 
        <td>pensandoo</td> 
        <td>icono</td> 
        <td><img src="http://static.forosdelweb.com/fdwtheme/images/smilies/scratchchin.gif"/></td> 
        <td>iconito pensativo</td> 
        <td>3</td> 
        <td>10</td> 
    </tr> 
    <tr> 
        <td>fiesta</td> 
        <td>icono 3</td> 
        <td><img src="http://static.forosdelweb.com/fdwtheme/images/smilies/porra.gif"/></td> 
        <td>iconito festejando</td> 
        <td>1</td> 
        <td>24</td> 
    </tr> 
    <tr> 
        <td>silbando</td> 
        <td>icono</td> 
        <td><img src="http://static.forosdelweb.com/fdwtheme/images/smilies/silbar.gif"/></td> 
        <td>bombilla silbando</td> 
        <td>19</td> 
        <td>50</td> 
    </tr> 
    <tr> 
        <td>no no no</td> 
        <td>icono 2</td> 
        <td><img src="http://static.forosdelweb.com/fdwtheme/images/smilies/negar.gif"/></td> 
        <td>negacion</td> 
        <td>5</td> 
        <td>1</td> 
    </tr> 
</table> 
' 

?> 

<?php 

if ( isset($_POST['PDF_1']) ) 
    doPDF('ejemplo',$html,false); 

if ( isset($_POST['PDF_2']) ) 
    doPDF('ejemplo',$html,true,'style.css'); 

if ( isset($_POST['PDF_3']) ) 
    doPDF('',$html,true,'style.css'); 

if ( isset($_POST['PDF_4']) ) 
    doPDF('ejemplo',$html,true,'style.css',false,'letter','landscape');  

if ( isset($_POST['PDF_5']) ) 
    doPDF('ejemplo',$html,true,'',true); //asignamos los tags <html><head>... pero no tiene css 

if ( isset($_POST['PDF_6']) ) 
    doPDF('',$html,true,'style.css',true); 

if ( isset($_POST['PDF_7']) ) 
    doPDF('pdfs/nuevo-ejemplo',$html,true,'style.css',true); //lo guardamos en la carpeta pdfs     
?> 

<!doctype html> 
<html> 

<head> 
    <link rel="stylesheet" href="style.css" type="text/css" /> 
</head> 

<table class="header"> 
    <tr> 
        <td><a href="http://www.forosdelweb.com/f18/" target="_blank"><h1>PHP</h1></a></td> 
        <td><a href="http://www.forosdelweb.com/" target="_blank"><h2>FOROSDELWEB</h2></a></td> 
    </tr> 
</table> 

<table class="menu"> 
    <tr> 
        <td>Ejemplos para: <strong>dompdf</strong></td> 
        <td><a href="http://code.google.com/p/dompdf/wiki/Usage" target="_blank">Documentaci&oacute;n</a></td> 
        <td><a href="http://code.google.com/p/dompdf/source/browse/trunk/dompdf/dompdf_config.custom.inc.php?r=399" target="_blank">Define()</a></td> 
        <td><a href="http://pxd.me/dompdf/www/examples.php#samples" target="_blank">Ejemplos de dompdf</a></td> 
    </tr> 
</table> 

<body> 

<?php echo $html ?> 

<form  action="<?php echo $_SERVER['PHP_SELF'] ?>" method="POST"> 
<table> 
  <tr> 
    <td>Mostrar PDF sin CSS</td> 
    <td><input name="PDF_1" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Mostrar PDF con CSS</td> 
    <td><input name="PDF_2" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Mostrar PDF con CSS sin definir el nombre</td> 
    <td><input name="PDF_3" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Mostrar PDF con CSS y cambiando el formato de la hoja</td> 
    <td><input name="PDF_4" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Guardar y abrir PDF sin CSS</td> 
    <td><input name="PDF_5" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Guardar y abrir PDF con CSS sin definir el nombre</td> 
    <td><input name="PDF_6" type="submit" value="CREAR" /></td> 
  </tr> 
  <tr> 
    <td>Guardar en otro directorio y abrir PDF con CSS</td> 
    <td><input name="PDF_7" type="submit" value="CREAR" /></td> 
  </tr>   

</table> 

</form> 

</body> 
</html> 
```

最后你可以拥有你的风格 style.css 的文件

```
body{
font:12px Arial, Tahoma, Verdana, Helvetica, sans-serif;
background-color:#BECEDC;
color:#000;
}

a h1{
font-size:35px; 
color:#FFF;
}

h2{
color:#FC0;
font-size:15px; 
}

table{
width:100%;
height:auto;
margin:10px 0 10px 0;
border-collapse:collapse;
text-align:center;
background-color:#365985;
color:#FFF;
}

table td,th{
border:1px solid black;
}

table th{
color:#FC0; 
}

.menu{
background-color:#69C;
color:#FFF;
}

.menu a{
color:#FFF; 
} 
```

# c# - 使用对象数组获取 ArrayTypeMismatchException

> ID：13593877
> 
> 赞同：2
> 
> 时间：2012-11-27T21:57:31.360
> 
> 标签：c#, .net, exception

我正在编写一个*非常简单*的方法来将 csv 转换为数据表，以便可以将其插入 SQL 数据库。它完全按照它应该的方式工作，除非我尝试用 DBNull.Value 替换空字符串，否则它会引发 ArrayTypeMismatchException。传入的流是带有数据的简单逗号分隔文件。

问题代码：

```
public static DataTable StreamToTable(Stream stream, bool headersAvailable, bool convertBlankToDBNull)
    {

        DataTable data = new DataTable();
        StreamReader reader = new StreamReader(stream);

        if (!reader.EndOfStream)
        {
            if (headersAvailable)
            {
                try
                {
                    //get headers from first line
                    string[] headers = reader.ReadLine().Split(',');

                    //construct headers
                    for (int i = 0; i < headers.Length; i++)
                    {
                        data.Columns.Add(headers[i]);
                    }
                }
                catch (IOException ioEx)
                {
                    return null;
                }
            }

            while (!reader.EndOfStream)
            {
                object[] row = reader.ReadLine().Split(',');

                if (convertBlankToDBNull)
                {
                    for (int i = 0; i < row.Length; i++)
                    {
                        if (row[i].ToString().Equals(""))
                        {
                            row[i] = DBNull.Value; //this is where I get the exception
                        }
                    }
                }
                data.Rows.Add(row);
            }

            return data;
        }
        else return null;
    } 
```

我不知道我做错了什么......我应该能够为数组分配任何东西，因为它是一个对象数组，那么怎么会有类型不匹配呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:00:21.247

您已经发现了[不安全数组协方差](http://blogs.msdn.com/b/ericlippert/archive/2007/10/17/covariance-and-contravariance-in-c-part-two-array-covariance.aspx)的可怕之处。

`row`是一个`string[]`被不安全地强制转换为`object[]`. 即使该转换成功，该数组仍然是 a `string[]`（因为这就是返回的内容） ，`Split()`并且不能*用作*. 特别是，它仍然无法容纳不是s 的东西。`object[]`
`string`

相反，您可以创建一个新的并用这些s`object[]`填充它：`string`

```
object[] row = Array.ConvertAll(
    reader.ReadLine().Split(','),
    s => (object)s
); 
```

# c++ - QT QVBoxLayout Determine/Set Visible Area of Scrolling

> ID：13593880
> 
> 赞同：1
> 
> 时间：2012-11-27T21:57:42.600
> 
> 标签：c++, qt, user-interface, scrollbar, boxlayout

I have a QVBoxLayout which contains content wide enough to require a horizontal scrollbar. I want to be able to set the viewable area (effectively the equivalent of scrolling via the scrollbar) with code.

Nothing within the [documentation](http://doc.qt.digia.com/qt/qvboxlayout-members.html) strikes me as able to do this - and I have not been able to easily find ways to retrieve the scrollbar and modify it directly, either.

How can I modify the viewed area of a QVBoxLayout with content larger than the size of the layout?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T06:16:31.713

`QVBoxLayout`不提供任何滚动功能，因此`QScrollArea`可能是最简单的解决方案（如建议的那样）。它可能没有你想象的那么困难。

幸运的是，滚动区域相当容易使用。这是一个简单的示例，它使用水平滚动条将另一个小部件包装在滚动区域中：

```
#include <QApplication>
#include <QLabel>
#include <QScrollArea>
#include <QVBoxLayout>
#include <QWidget>

int main(int argc, char** argv)
{
    QApplication app(argc, argv);

    // Force the label to be wide
    QLabel* label = new QLabel("this is a very long label");
    label->setMinimumWidth(300);

    QWidget* widget = new QWidget();
    QVBoxLayout* layout = new QVBoxLayout(widget);
    layout->addWidget(label);

    QScrollArea* scrollArea = new QScrollArea();
    scrollArea->setWidget(widget);

    // Force the scroll area to be smaller
    scrollArea->resize(200, 100);
    scrollArea->show();

    app.exec();
    return 0;
} 
```

关于滚动区域的一件棘手的事情是控制它们的大小（而不是其内容的大小）。它们定义了固定大小的提示，因此默认情况下，它们可能不会根据需要调整大小。请记住，外部滚动区域的大小提示和/或大小策略将决定它在布局中调整大小的方式。

# php - 将 JSON 列表转换为 php 数组

> ID：13593881
> 
> 赞同：0
> 
> 时间：2012-11-27T21:57:43.997
> 
> 标签：php, json

我正在将页面中的数字列表传递给以 JSON 序列化的 PHP

```
{"items":"[1,2,3,4]"} 
```

在我的网址中

```
...&items={"items":[1,2,3,4]} 
```

我用 PHP 解码

```
$json = $_GET["items"];
$arr = json_decode($json, true); 
```

我得到一个数组

```
Array ( [items] => [1,2,4] ) 
```

但是当我试穿`foreach`并`arr["items"]`打印出每个值时，我得到的只是一个值

```
[1,2,4] 
```

这是我用来迭代的代码

```
foreach($res["items"] as $value)
    echo $value; 
```

为什么我没有得到类似的东西

```
1
2
4 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:01:45.963

仔细查看您的 json 字符串：

```
{"items":"[1,2,3,4]"} 
```

仔细看：

“[1,2,3,4]”

您是说 items 是一个字符串，其中包含：

“[1,2,3,4]”

删除“，你会没事的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:05:41.757

你的序列化是错误的。应该：

```
{"items":[1,2,3]} 
```

为了摆脱类似`JSON.stringify`在 JS 中使用的问题：

```
var myData = {"items" : [1,2,3]},
    queryString = 'data='+encodeURIComponent(JSON.stringify(myData)); 
```

对于 IE < 8，它必须包含在外部脚本中（请参见[此处](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)）：

```
<!--[if lt IE 8]><script src="/js/json2.js"></script><![endif]--> 
```

无论如何，将它作为数组发送会更容易：

```
items[0]=1&items[1]=2&items[2]=3 
```

这样您还可以发送更复杂的结构：

```
data[items][0]=1&data[items][1]=2
// on PHP side will become
$_GET['data'] = array('items' => array(1,2)) 
```

# php - session_name 是否创建 cookie

> ID：13593889
> 
> 赞同：0
> 
> 时间：2012-11-27T21:58:38.867
> 
> 标签：php, session, session-cookies

session_name 是否也设置了 cookie？

```
session_name("sess");
session_start(); 
```

如果我添加这行代码“sess”会出现在cookies中。这是为什么？

我可以在不使用 setcookie 函数的情况下使其安全吗？

注意：“sess”没有在任何地方设置为 cookie。所以我的问题是为什么它在萤火虫中显示为 cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:05:14.430

根据 PHP 的手册， session_name() 函数返回会话的当前名称。如果您提供一个名称（就像您所做的那样，“sess”），它将更改会话的名称，同时将先前的会话名称返回到您的变量。

鉴于它们的描述，会话名称用于命名 cookie 文件以识别您的 cookie。这就是为什么 PHP 手册建议只使用字母和数字，同时保持名称非常短。

# mongodb - Mongodb: Perform a Date range query from the ObjectId in the mongo shell

> ID：13593896
> 
> 赞同：28
> 
> 时间：2012-11-27T21:58:59.837
> 
> 标签：mongodb, mongodb-shell

I have a collection that looks like this:

```
{
  _id: ObjectId("50a68673476427844b000001"),
  other fields
} 
```

I want to do a range query to find records between two dates. I know that I can get the date from the ObjectId in the mongo shell var doing this:

```
var aDate = ObjectId().getTimestamp() 
```

but there isn't a way (as far as I can figure out at the moment) to create an ObjectId consisting of just the timestamp portion - I think my ideal solution is non-functioning mongo shell code would be:

```
var minDate = ObjectId(new Date("2012-11-10"));
var maxDate = ObjectId(new Date("2012-11-17")); 
```

Use the find with the minDate and MaxDate as the range values.

Is there a way to do this in the SHELL - I'm not interested in some of the driver products.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-27T22:33:49.637

您可以分两步完成：

```
 var objIdMin = ObjectId(Math.floor((new Date('1990/10/10'))/1000).toString(16) + "000
0000000000000")
 var objIdMax = ObjectId(Math.floor((new Date('2011/10/22'))/1000).toString(16) + "000
    0000000000000")
 db.myCollection.find({_id:{$gt: objIdMin, $lt: objIdMax}}) 
```

或一步（可读性较差）：

```
db.myCollection.find({_id:{$gt: ObjectId(Math.floor((new Date('1990/10/10'))/1000).toString(16) + "000
    0000000000000"), $lt: ObjectId(Math.floor((new Date('2011/10/10'))/1000).toString(16) + "000
    0000000000000")}}) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-09-23T10:41:08.897

**使用 mongo 外壳：**

您可以使用 ObjectId.fromDate 内置方法：

```
db.mycollection.find({_id: {$gt: ObjectId.fromDate( new Date('2017-09-23') ) } }); 
```

**从 Node.js 驱动程序：**

[您可以在此处](https://stackoverflow.com/a/19138789/7435863)使用@jksdua 提供的解决方案，如下所示：

```
db.mycollection.find({_id: {$gt: ObjectID.createFromTime( Date.now()/1000 ) } }); 
```

# php - 使用 COALESCE 返回 META 标题值和导航数组的页面信息

> ID：13593897
> 
> 赞同：1
> 
> 时间：2012-11-27T21:59:01.883
> 
> 标签：php, mysql, codeigniter-2

我正在使用 codeigniter 创建一个多站点 CMS，并且在查询导航链接时遇到问题。`(location_id = 0)`每个页面都可以具有元值，如果设置了特定于站点的元值，则这些元值会覆盖默认值。我有两个表`cms_pages`并`cms_page_meta`存储信息。下面是相关数据

```
Table cms_pages
    page_id

Table cms_page_meta
    meta_id
    location_id
    page_id
    tag_name
    tag_value 
```

如果可行，我想一次性完成。

这是我正在使用的调用，如果所有位置的标题值都存在，它会导致页面被列出两次，如果存在我只想要`(location_id = 0)`特定`(location_id = x)`位置的特定位置，否则它是通用的，否则为 NULL

```
SELECT cms_page.*, cms_page_meta.tag_value
FROM cms_pages
LEFT JOIN cms_page_meta ON cms_page_meta.page_id = cms_pages.page_id
WHERE cms_page_meta.location_id IN (0, x)
ORDER BY cms_pages.page_order` 
```

我很确定我应该使用 coalesce 但只是不知道如何实现它。我是否试图一次做太多事情？我应该使用 PHP array_merge 拆分调用和处理吗？我想避免这种情况，因为每当我对页面或元数据进行更改时，我都可以缓存调用并删除/重新生成缓存。服务器每天获得约 10,000 次点击，因此速度很有帮助，但还没有必要......

我更改了上面的查询，所以它现在只获取通用数据。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:11:34.787

我认为你应该使用这样的东西：

```
SELECT
  cms_page.*,
  COALESCE(cms_pm2.meta_id, cms_pm1.meta_id) as meta_id,
  COALESCE(cms_pm2.tag_name, cms_pm1.tag_name) as tag_name,
  COALESCE(cms_pm2.tag_value, cms_pm1.tag_value) as tag_value
FROM
  cms_pages LEFT JOIN cms_page_meta cms_pm1
  ON cms_pm1.page_id = cms_pages.page_id
     AND cms_pm1.location_id = 0
  LEFT JOIN cms_page_meta cms_pm2
  ON cms_pm2.page_id = cms_pages.page_id
     AND cms_pm2.location_id = x      
ORDER BY cms_pages.page_order 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:12:10.983

我想我找到了解决方案

```
SELECT cms_pages.*, coalesce(s.tag_value, g.tag_value, 'Coming Soon!') as tag_value
from cms_pages
left join cms_page_meta s on ad_pages.page_id = s.page_id and s.tag_name = "title" and s.location_id = 255
left join cms_page_meta g on ad_pages.page_id = g.page_id and g.tag_name = "title" and g.location_id = 0
WHERE `cms_pages`.`page_group_id` =  '5'
AND `page_type` =  1
ORDER BY `cms_pages`.`page_order` 
```

这在性能方面是否良好？

# c# - 如何解决 IReadOnlyDictionary 缺乏协方差的问题？

> ID：13593900
> 
> 赞同：30
> 
> 时间：2012-11-27T21:59:17.617
> 
> 标签：c#, .net, dictionary, readonly, covariance

我正在尝试公开一个只读字典，该字典包含具有只读接口的对象。在内部，字典是可写的，其中的对象也是可写的（参见下面的示例代码）。我的问题是 IReadOnlyDictionary 不支持协变转换，因为[这里](https://stackoverflow.com/questions/2149589/idictionarytkey-tvalue-in-net-4-not-covariant)的问题中列出了原因。这意味着我不能将我的内部字典公开为只读字典。

所以我的问题是，有没有一种有效的方法可以将我的内部字典转换为 IReadOnlyDictionary，或者其他方式来处理这个问题？我能想到的选项是：

1.  持有两个内部词典并保持同步。
2.  访问属性时创建一个新字典并转换其中的所有对象。
3.  在内部使用时将 IReadOnly 转换回 NotReadOnly。

1似乎很痛苦，2似乎效率很低。3 听起来是目前最有前途的，但仍然很难看。我还有其他选择吗？

```
public class ExposesReadOnly
{
    private Dictionary<int, NotReadOnly> InternalDict { get; set; }
    public IReadOnlyDictionary<int, IReadOnly> PublicList
    {
        get
        {
            // This doesn't work...
            return this.InternalDict;
        }
    }

    // This class can be modified internally, but I don't want
    // to expose this functionality.
    private class NotReadOnly : IReadOnly
    {
        public string Name { get; set; }
    }
}

public interface IReadOnly
{
    string Name { get; }
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-28T10:29:08.753

您可以为字典编写自己的只读包装器，例如：

```
public class ReadOnlyDictionaryWrapper<TKey, TValue, TReadOnlyValue> : IReadOnlyDictionary<TKey, TReadOnlyValue> where TValue : TReadOnlyValue
{
    private IDictionary<TKey, TValue> _dictionary;

    public ReadOnlyDictionaryWrapper(IDictionary<TKey, TValue> dictionary)
    {
        if (dictionary == null) throw new ArgumentNullException("dictionary");
        _dictionary = dictionary;
    }
    public bool ContainsKey(TKey key) { return _dictionary.ContainsKey(key); }

    public IEnumerable<TKey> Keys { get { return _dictionary.Keys; } }

    public bool TryGetValue(TKey key, out TReadOnlyValue value)
    {
        TValue v;
        var result = _dictionary.TryGetValue(key, out v);
        value = v;
        return result;
    }

    public IEnumerable<TReadOnlyValue> Values { get { return _dictionary.Values.Cast<TReadOnlyValue>(); } }

    public TReadOnlyValue this[TKey key] { get { return _dictionary[key]; } }

    public int Count { get { return _dictionary.Count; } }

    public IEnumerator<KeyValuePair<TKey, TReadOnlyValue>> GetEnumerator()
    {
        return _dictionary
                    .Select(x => new KeyValuePair<TKey, TReadOnlyValue>(x.Key, x.Value))
                    .GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:51:47.097

我建议您可能想要定义自己的协变接口，并包括协变访问方法以及创建只读包装器对象的方法，该包装器对象实现`IDictionary`或`IReadonlyDictionary`使用所需的类型。`IEnumerable<KeyValuePair<TKey,TValue>>`只需在您的界面中忽略。

根据您正在做的事情，定义`IFetchByKey<out TValue>`由 继承的可能会有所帮助`IFetchByKey<in TKey, out TValue>`，前者接受对任何类型对象的查询（给定对象实例， 的集合`Cat`应该能够说明它是否包含该实例，即使它是一个类型`Dog`或`ToyotaPrius`; 集合将不包含后一种类型的任何实例，并且应该能够这样说）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:28:30.190

也许这个解决方案适合你：

```
public class ExposesReadOnly
{
    private IDictionary<int, IReadOnly> InternalDict { get; set; }
    public IReadOnlyDictionary<int, IReadOnly> PublicList
    {
        get
        {
            IReadOnlyDictionary<int, IReadOnly> dictionary = new ReadOnlyDictionary<int, IReadOnly>(InternalDict);

            return dictionary;
        }
    }

    private class NotReadOnly : IReadOnly
    {
        public string Name { get; set; }
    }

    public void AddSomeValue()
    {
        InternalDict = new Dictionary<int, NotReadOnly>();
        InternalDict.Add(1, new NotReadOnly() { Name = "SomeValue" });
    }
}

public interface IReadOnly
{
    string Name { get; }
}

class Program
{
    static void Main(string[] args)
    {
        ExposesReadOnly exposesReadOnly = new ExposesReadOnly();
        exposesReadOnly.AddSomeValue();

        Console.WriteLine(exposesReadOnly.PublicList[1].Name);
        Console.ReadLine();

        exposesReadOnly.PublicList[1].Name = "This is not possible!";
    }
} 
```

希望这可以帮助！

问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-02T15:23:14.263

另一种特定缺乏协方差的方法：

一种针对特定类型的有用协方差的变通方法

```
public static class DictionaryExtensions
    {
        public static IReadOnlyDictionary<TKey, IEnumerable<TValue>> ToReadOnlyDictionary<TKey, TValue>(
            this IDictionary<TKey, List<TValue>> toWrap)
        {
            var intermediate = toWrap.ToDictionary(a => a.Key, a =>a.Value!=null? a.Value.ToArray().AsEnumerable():null);
            var wrapper = new ReadOnlyDictionary<TKey, IEnumerable<TValue>>(intermediate);
            return wrapper;
        }   
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-15T04:39:59.937

根据您的用例，您可能能够摆脱暴露`Func<int,IReadOnly>`.

```
public class ExposesReadOnly
{
    private Dictionary<int, NotReadOnly> InternalDict { get; set; }
    public Func<int,IReadOnly> PublicDictionaryAccess
    {
        get
        {
            return (x)=>this.InternalDict[x];
        }
    }

    // This class can be modified internally, but I don't want
    // to expose this functionality.
    private class NotReadOnly : IReadOnly
    {
        public string Name { get; set; }
    }
}

public interface IReadOnly
{
    string Name { get; }
} 
```

# node.js - node: command not found

> ID：13593902
> 
> 赞同：48
> 
> 时间：2012-11-27T21:59:24.770
> 
> 标签：node.js

I am in the process of setting up node.js in order to work with a framework like Meteor, Derby, or Ember, but am running into some problems early on. Following these instructions (http://www.nodebeginner.org), I installed node, created a simple helloworld.js file, then ran this command in the terminal:

```
node path/to/file/helloworld.js 
```

but I get the following error:

```
-bash: node: command not found 
```

I've tried navigating to the directory, then simply running:

```
node helloworld.js 
```

but get the same error. I am completely new to node.js and am at a loss.

Running OS X 10.7.5 and the latest version of node.

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-11-27T22:04:58.927

问题是您的 PATH 不包括节点可执行文件的位置。

您可以将节点运行为“ `/usr/local/bin/node`”。

您可以通过运行以下命令将单行添加到 bashrc 文件来将该位置添加到路径中：

```
echo 'export PATH=$PATH:/usr/local/bin' >> $HOME/.bashrc
source $HOME/.bashrc 
```

# vb.net - 打开/读取二进制文件 - 访问权限

> ID：13593903
> 
> 赞同：1
> 
> 时间：2012-11-27T21:59:24.650
> 
> 标签：vb.net

我正在尝试将 VB5 转换为 .NET，但无法进行二进制读取。我的 VB.NET 解码只能正确读取前两个字符。(VB5->VB.NET) 编码是

```
 ' Open file
    x = Rnd(-mKeyValue)
    filenum = FreeFile()
    Try
        FileOpen(filenum, Filename, OpenMode.Binary)
    Catch ex As IO.IOException
        MsgBox(ex.ToString, MsgBoxStyle.Critical, "File opening error")
        Exit Sub
    End Try
    ' write data
    filecontents = ""       

    For i = 1 To Len(stringdate)
        charnum = Asc(Mid(stringdate, i, 1))
        randomint = Int(256 * Rnd())
        charnum = charnum Xor randomint
        singlechar = Chr(charnum)
        FilePut(filenum, singlechar, i)
        filecontents = filecontents & singlechar
    Next i 
```

并且 (VB5->VB.NET) 解码是

```
 x = Rnd(-mKeyValue)
    filenum = FreeFile()
    FileOpen(filenum, Filename, OpenMode.Binary)
    For i = 1 To LOF(filenum)

        'To VB.NET
        FileGet(filenum, singlechar, i)
        charnum = Asc(singlechar)
        Debug.Print("VB5 singlechar = " & singlechar)
        randomint = Int(256 * Rnd())
        charnum = charnum Xor randomint
        singlechar = Chr(charnum)
     Next i 
```

我的 VB.NET 代码失败（无法正确读取文件）是；

```
 Using reader As New BinaryReader(File.Open(Filename, FileMode.Open))
        ' Loop through length of file.
        Dim pos As Integer = 0
        Dim length As Integer = reader.BaseStream.Length

        While pos < length
            ' Read the integer.
            singlechar = reader.ReadChar()
            charnum = Asc(singlechar)    'singlechar is type Char
            randomint = Int(256 * Rnd())
            charnum = charnum Xor randomint
            singlechar = Chr(charnum)

            i += 1
        End While
    End Using 
```

谁能帮我从 VB5 翻译成 .NET？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:47:39.823

在 VB.Net 中，一切都短了**一点；）**

```
 ' get a string from an encrypted file file:
    Dim b() As Byte = IO.File.ReadAllBytes("path")
    For i = 0 To b.Length - 1
        b(i) = b(i) Xor (256 * Rnd())
    Next
    Dim s As String = System.Text.Encoding.ASCII.GetString(b) 
```

当.Net可以一次读取它时，为什么要逐字节读取（无论如何读取'char'没有意义，因为您只需要8位ASCII码）？我假设您的文件不大于 100 MB？然后在获得数组后，您只需将每个元素与您的“随机”值进行异或。如果不需要兼容旧版本，最好使用`Random`. 或者甚至更好......使用真正的加密（在.Net中它是内置的！）

```
' put a string into a file
    Dim c() As Byte = System.Text.Encoding.ASCII.GetBytes("The String you want to store encrypted")
    For i = 0 To c.Length - 1
        c(i) = c(i) Xor (256 * Rnd())
    Next
    IO.File.WriteAllBytes("another path", c) 
```

“加密”也是如此。将字符串转换为字节数组（=ASCII 值），对其进行异或，然后在 ONE 操作中将其写回。

查看 Unicode 的危险：

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

    ' Beware of UNICODE ... !!!
    Using sw As New FileStream("foo.foo", FileMode.OpenOrCreate, FileAccess.Write)
        ' with old VB you effectively wrote BYTE data
        sw.Write({65, 192}, 0, 2)
    End Using

    Using br As New BinaryReader(File.Open("foo.foo", FileMode.Open, FileAccess.Read))
        ' You are telling. Net that you expect a CHAR, which is not ASCII, but UNICODE
        Dim c As Char = br.ReadChar
        Dim d As Char = br.ReadChar
        Dim cc = Asc(c)
        Dim dd = Asc(d)
        Debug.Print("65 -> {0}, 192 -> {1}", cc, dd)
    End Using

End Sub 
```

输出是`65 -> 65, 192 -> 63`

# matlab - 在 MATLAB 中更改等高线图中零的默认白色

> ID：13593907
> 
> 赞同：0
> 
> 时间：2012-11-27T21:59:39.340
> 
> 标签：matlab, contour

如何在 MATLAB 中将等高线图输出的默认白色为零更改为不同的颜色？

```
longitude = [80 82 95]
latitude = [30 32 35]
temp = [0 0 0; 0 0 0; 0 0 0]
contourf(longitude,latitude,temp) 
```

谢谢，

阿曼达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T10:51:38.897

关键似乎是图形属性中的“渲染器/渲染”模式。它必须设置为“painters”或“zbuffer”。我不是专家，我不明白如何默认设置它。我通过图形编辑器手动更改它（单击外部图形框架->更多属性->渲染器）然后我从菜单栏中单击“生成代码”以创建一个以相同方式自动创建所有图的功能.

# lua - 如何迭代文本框的字典/表？

> ID：13593909
> 
> 赞同：1
> 
> 时间：2012-11-27T21:59:42.213
> 
> 标签：lua, moai

我有一个文本框表，其中键是位置的名称（topRight，topLeft ...）。

一次创建和配置一个工作正常：

```
kanaAt = {}
function startKanas ()
    kanaAt.topLeft = MOAITextBox.new()  
    kanaAt.topLeft:setFont(font)
    ...
    kanaAt.topLeft:setString("か")
    layer:insertProp (kanaAt.topLeft)

    kanaAt.topRight = MOAITextBox.new()
    kanaAt.topRight:setFont(font)
    ...
    kanaAt.topRight:setString("た")
    layer:insertProp (kanaAt.topRight)
end 
```

但不是当我尝试迭代它时：

```
kanaAt = {}
function startKanas ()
    kanaAt.topLeft = MOAITextBox.new()
    kanaAt.topRight = MOAITextBox.new() 
    kanaAt.bottomLeft = MOAITextBox.new()
    kanaAt.bottomRight = MOAITextBox.new()          

    for name, text in ipairs(kanaAt) do
        text:setFont(font)
        text:setTextSize(90,60)
        text:setYFlip(true)
        text:setRect(-50,-50,50,50)
        layer:insertProp (text)
    end

    kanaAt.topLeft:setString("か")
    kanaAt.topLeft:setLoc(-325, 225)
    kanaAt.topRight:setString("た")
    kanaAt.topRight:setLoc(325, 225)
    kanaAt.bottomLeft:setString("ち")
    kanaAt.bottomLeft:setLoc(-325, -225)
    kanaAt.bottomRight:setString("つ")
    kanaAt.bottomRight:setLoc(325, -225)

end 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:20:02.063

使用pairs() 而不是ipairs()。

# python - 在 numpy 数组中快速替换

> ID：13593911
> 
> 赞同：2
> 
> 时间：2012-11-27T21:59:46.893
> 
> 标签：python, arrays, performance, numpy, replace

我一直在尝试进行一些修改以加快此伪代码的速度：

```
>>> A=np.array([1,1,1,2,2,2,3,3,3])
>>> B=np.array([np.power(A,n) for n in [3,4,5]])
>>> B
array([[  1,   1,   1,   8,   8,   8,  27,  27,  27],
       [  1,   1,   1,  16,  16,  16,  81,  81,  81],
       [  1,   1,   1,  32,  32,  32, 243, 243, 243]]) 
```

其中 A 的元素经常重复 10-20 次，需要保留 B 的形状，因为它稍后会乘以另一个相同形状的数组。

我的第一个想法是使用以下代码：

```
uA=np.unique(A)
uB=np.array([np.power(uA,n) for n in [3,4,5]])
B=[]
for num in range(uB.shape[0]):
    Temp=np.copy(A)
    for k,v in zip(uA,uB[num]): Temp[A==k] = v
    B.append(Temp)
B=np.array(B)
### Also any better way to create the numpy array B? 
```

这似乎相当可怕，并且可能有更好的方法。任何关于如何加快速度的想法将不胜感激。

感谢您的时间。

这是一个更新。我意识到我的函数编码很糟糕。非常感谢大家的建议。将来我会尝试更好地改写我的问题，以便它们显示所需的一切。

```
Normal='''
import numpy as np
import scipy
def func(value,n):
    if n==0: return 1
    else: return np.power(value,n)/scipy.factorial(n,exact=0)+func(value,n-1)
A=np.random.randint(10,size=250)
A=np.unique(A)
B=np.array([func(A,n) for n in [6,8,10]])
'''

Me='''
import numpy as np
import scipy
def func(value,n):
    if n==0: return 1
    else: return np.power(value,n)/scipy.factorial(n,exact=0)+func(value,n-1)
A=np.random.randint(10,size=250)
uA=np.unique(A)
uB=np.array([func(A,n) for n in [6,8,10]])
B=[]
for num in range(uB.shape[0]):
    Temp=np.copy(A)
    for k,v in zip(uA,uB[num]): Temp[A==k] = v
    B.append(Temp)
B=np.array(B)
'''

Alex='''
import numpy as np
import scipy
A=np.random.randint(10,size=250)
power=np.arange(11)
fact=scipy.factorial(np.arange(11),exact=0).reshape(-1,1)
power=np.power(A,np.arange(11).reshape(-1,1))
value=power/fact
six=np.sum(value[:6],axis=0)
eight=six+np.sum(value[6:8],axis=0)
ten=eight+np.sum(value[8:],axis=0)
B=np.vstack((six,eight,ten))
'''
Alex='''
import numpy as np
import scipy
A=np.random.randint(10,size=250)
power=np.arange(11)
fact=scipy.factorial(np.arange(11),exact=0).reshape(-1,1)
power=np.power(A,np.arange(11).reshape(-1,1))
value=power/fact
six=np.sum(value[:6],axis=0)
eight=six+np.sum(value[6:8],axis=0)
ten=eight+np.sum(value[8:],axis=0)
B=np.vstack((six,eight,ten))
'''

Alex2='''
import numpy as np
import scipy
def find_count(the_list):
    count = list(the_list).count
    result = [count(item) for item in set(the_list)]
    return result
A=np.random.randint(10,size=250)
A_unique=np.unique(A)
A_counts = np.array(find_count(A_unique))
fact=scipy.factorial(np.arange(11),exact=0).reshape(-1,1)
power=np.power(A_unique,np.arange(11).reshape(-1,1))
value=power/fact
six=np.sum(value[:6],axis=0)
eight=six+np.sum(value[6:8],axis=0)
ten=eight+np.sum(value[8:],axis=0)
B_nodup=np.vstack((six,eight,ten))
B_list = [ np.transpose( np.tile( B_nodup[:,i], (A_counts[i], 1) ) ) for i in range(A_unique.shape[0]) ]
B = np.hstack( B_list )
'''

print timeit.timeit(Normal, number=10000)
print timeit.timeit(Me, number=10000)
print timeit.timeit(Alex, number=10000)
print timeit.timeit(Alex2, number=10000)

Normal: 10.7544178963
Me:     23.2039361
Alex:    4.85648703575
Alex2:   4.18024992943 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:21:27.320

如果将其形状更改为列向量的形状，则`np.power`可以广播。`A`

```
>>> np.power(A.reshape(-1,1), [3,4,5]).T
array([[  1,   1,   1,   8,   8,   8,  27,  27,  27],
       [  1,   1,   1,  16,  16,  16,  81,  81,  81],
       [  1,   1,   1,  32,  32,  32, 243, 243, 243]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:43:16.020

使用 numpy.tile() 和 numpy.hstack() 的组合，如下：

```
A = np.array([1,2,3])
A_counts = np.array([3,3,3])
A_powers = np.array([[3],[4],[5]])
B_nodup = np.power(A, A_powers)
B_list = [ np.transpose( np.tile( B_nodup[:,i], (A_counts[i], 1) ) ) for i in range(A.shape[0]) ]
B = np.hstack( B_list ) 
```

转置和堆栈可能会颠倒，这可能会更快：

```
B_list = [ np.tile( B_nodup[:,i], (A_counts[i], 1) ) for i in range(A.shape[0]) ]
B = np.transpose( np.vstack( B_list ) ) 
```

这可能只有在您计算的函数非常昂贵，或者重复很多次（超过 10 次）时才值得这样做；做一个平铺和堆叠以防止额外计算 10 次幂函数可能不值得。请进行基准测试并让我们知道。

**编辑：**或者，您可以只使用广播来摆脱列表理解：

```
>>> A=np.array([1,1,1,2,2,2,3,3,3])
>>> B = np.power(A,[[3],[4],[5]])
>>> B
array([[  1,   1,   1,   8,   8,   8,  27,  27,  27],
       [  1,   1,   1,  16,  16,  16,  81,  81,  81],
       [  1,   1,   1,  32,  32,  32, 243, 243, 243]]) 
```

这可能非常快，但实际上并没有按照您的要求进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:09:21.557

我进行了 200k 次迭代，第一种方法是我的。

```
import numpy as np
import time

N = 200000
start = time.time()
for j in range(N):

    x = np.array([1,1,1,2,2,2,3,3,3])
    powers = np.array([3,4,5])
    result = np.zeros((powers.size,x.size)).astype(np.int32)
    for i in range(powers.size):
        result[i,:] = x**powers[i]
print time.time()-start, "seconds"

start = time.time()
for j in range(N):
    A=np.array([1,1,1,2,2,2,3,3,3])
    B = np.power(A,[[3],[4],[5]])
print time.time()-start, "seconds"

start = time.time()
for j in range(N):
    np.power(A.reshape(-1,1), [3,4,5]).T
print time.time()-start, "seconds"

start = time.time()
for j in range(N):
    A=np.array([1,1,1,2,2,2,3,3,3])
    B=np.array([np.power(x,n) for n in [3,4,5]])
print time.time()-start, "seconds" 
```

生产

```
8.88000011444 seconds
9.25099992752 seconds
3.95399999619 seconds
7.43799996376 seconds 
```

larsmans 方法显然是最快的。

（ps如何在没有明确网址的情况下链接到此处的答案或用户 @larsman 不起作用）

# php - Symfony 1.4 - Doctrine - Custom Plugin - How do I get plugin model files to reside in plugin directory?

> ID：13593913
> 
> 赞同：1
> 
> 时间：2012-11-27T21:59:59.247
> 
> 标签：php, symfony1, symfony-1.4

I am creating a custom plugin, and am trying to keep all related model files contained within the plugin directory structure. However, when I build the model, some files get dropped into lib/model/doctrine/... and others in plugins/userPlugin/lib/model/... . According to [Doctrine docs](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/yaml-schema-files.html#packages) I can add a "package" option to the schema.yml file, and generated model files will be created in the location as defined by my dot-notation entry, for example:

```
# plugins/userPlugin/config/doctrine/schema.yml

connection: store-rw-user

options:
  # Fully expect resulting model files to be dropped in this directory (vs the main model dir)
  package: userPlugin.lib.model.doctrine

.... 
```

As mentioned, this config setup still results in model files being dropped into the main lib/model/doctrine directory. I even tried this, to no avail:

```
# plugins/userPlugin/config/doctrine/schema.yml

connection: store-rw-user

options:
  package: userPlugin
  package_custom_path: /tmp/userPlugin

.... 
```

Just wanted to see if the files were dropped in the /tmp directory, but they were not.

Before I start tearing apart the source code, I figured I would ask first, to see if there is something I am missing.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:30:25.287

构建后在项目目录中获取模型文件是完全正常的。这样做的目的是让您在每个项目的基础上自定义插件模型，因为这些文件中的类继承自插件文件中定义的类。我也使用插件，而且大多数时候，我编写的所有代码都驻留在插件的模型文件中。

# objective-c - objective-c 检查 float 和 int 的相等性 -- 2.0000 == 2

> ID：13593915
> 
> 赞同：1
> 
> 时间：2012-11-27T22:00:11.993
> 
> 标签：objective-c, ios, c

简单的问题，我知道必须有正确的方法来做到这一点。我有一个以 1/16 为增量增加的 CGFloat。我想确定这个值何时变为整数。

由于不知道正确的方法，我想出了一些想法，比如有另一个变量来跟踪迭代次数和`mod 16`它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:27:44.270

虽然您通常不能依靠小数浮点数来求和整数，但您的情况是规则的例外，因为`1/16`is`2^(-4)`并且这个数字可以用浮点数精确表示：

```
- (void)testFloat
{
    float a = 0.0f;

    while (a != 2.0f) {
        a += 0.0625f;
    }

    NSLog(@"OK!");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:02:45.960

最好反过来做，即使用整数循环计数器并将其转换为浮点数：

```
for (int i = 0; i < 100; ++i)
{
    float x = (float)i / 16.0f;

    if (i % 16 == 0)
    {
        // if x is whole number...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:01:50.080

浮点运算是不精确的，所以你不能指望你的变量的值是精确的`2.0000`。

“由于不知道正确的方法，我想出了一些想法，比如使用另一个变量来跟踪迭代次数并对其进行修改 16。”

这是一个绝妙的主意。

# ios - Add custom settings bundle to jailbroken iOS settings.app?

> ID：13593919
> 
> 赞同：0
> 
> 时间：2012-11-27T22:00:24.583
> 
> 标签：ios, jailbreak, settings.bundle

I was looking into making a custom toggle switch option in the iOS settings.app menu to turn a home cooked function on and off. I was wondering if it's possible to do such a thing. If so, how?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:45:59.220

`/Applications`是的，这是可能的，但它对于安装在 中的越狱应用程序的工作方式与普通 App Store 应用程序的工作方式略有不同。

[在此处查看此文档。](http://iphonedevwiki.net/index.php/PreferenceLoader) 我有一段时间没有使用它了，所以如果有一些过时的东西，请在此处发表评论，我会尝试使用我的一个工作越狱应用程序中的代码等更新我的答案这个。

请注意，如果您希望设置开关*执行您的自定义代码*，而不仅仅是*存储*首选项值，您将需要使用上面链接中描述的**PreferenceBundle 方法**。

您还需要确保手机上`PreferenceLoader`安装了由 Dustin Howett 设计的 ，才能正常工作。如果您将您的应用程序分发给用户（通过 Cydia 或类似的方式），您可以确保它`PreferenceLoader`与您的应用程序一起自动安装。为此，请将此行添加到您的应用程序`DEBIAN/control`文件中：

```
Depends: preferenceloader 
```

`PreferenceLoader`是免费的，已经存在了一段时间，而且看起来很稳定，所以它并不是一个糟糕的依赖。大多数越狱用户可能已经拥有它。

# python - 命令提示符：默认设置为 Python 2.7

> ID：13593922
> 
> 赞同：2
> 
> 时间：2012-11-27T22:00:30.547
> 
> 标签：python, windows, command-prompt

我的命令提示符当前默认运行 Python 3.2 如何将其设置为默认运行 Python 2.7，我已将 PATH 变量更改为指向 Python 2.7，但这不起作用。

* * *

更新：

它仍然不起作用。:(

仍在运行 python3 - 具体来说，当我尝试安装烧瓶时它运行 python3 - 这是我想要做的。

更一般地说，当我在命令行中简单地键入 python 时，它什么也不做。

我得到一个“python”不是内部或外部命令、可运行程序或批处理文件错误。

不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:16:18.917

更改您的 PATH 环境变量应该可以解决问题。一些故障排除提示：

*   确保您不仅更改了本地变量，还更改了系统变量以反映新位置
*   确保您重新启动了 CL 窗口（也就是关闭“cmd”或命令提示符并重新打开它）。这将刷新您刚刚更新的系统变量。
*   确保删除对 C:\Python32\ 或任何旧路径的所有引用（再次检查本地和系统 PATH - 它们都在同一个环境变量窗口中找到）。
*   检查 Python3.2 是否安装在您认为的位置...（只需将目录重命名为 OLD_Python3.2 并转到您的 CLI 并输入“python” - 它是否启动？如果是它是 2.7 ? 或 3.2? 如果不是，您的 PATH 变量有问题。
*   其他一切都失败了 - 重新启动并重试（您可能有一些持久的环境变量 - 我不明白这是怎么回事 - 但是，嘿，我们在这里集思广益！ - 重新启动会给你一个新的开始。

如果这不起作用，那么我认为您做错了其他事情（也就是用户错误）。CMD 必须知道在哪里可以找到 python 才能执行。它从您的 PATH 变量中知道这一点……现在，我几乎只在 2.6/2.7 中工作，所以如果他们对注册表做了什么（我怀疑），那么我就不会知道了。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:49:58.323

如果您直接使用调用 Python 脚本，`python script.py`那么首先将 PATH 设置为 2.7 目录就足够了。

如果您想通过 shell 间接调用 Python 脚本，即仅通过编写`script.py` *或*从资源管理器执行文件，您需要将 2.7 安装设置为`.py`扩展的默认程序处理程序。最简单的方法是再次运行 Python 安装程序并选择“将此安装设为默认”选项。

请注意，对于 3.3+ 附带的新[启动器](http://docs.python.org/3/using/windows.html#launcher)，您不需要它，因为您可以使用 shebang 行指定版本号，启动器将自动选择适当的解释器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T09:20:24.780

将两条 las 行更改为当前 python 所需的构建路径：

```
Windows Registry Editor Version 5.00

' Extracted from Python 2.7 silent installation By Elektro H@cker

[HKEY_CLASSES_ROOT\.py]
@="Python.File"

[HKEY_CLASSES_ROOT\.pyc]
@="Python.CompiledFile"

[HKEY_CLASSES_ROOT\.pyo]
@="Python.CompiledFile"

[HKEY_CLASSES_ROOT\.pyw]
@="Python.NoConFile"

[HKEY_CLASSES_ROOT\Python.File\Shell\Open\Command]
@="CMD /K \"\"C:\\Program Files (x86)\\Python\\Python.exe\" \"%1\" %*\""

[HKEY_CLASSES_ROOT\Python.NoConFile\Shell\open\command]
@="CMD /K \"\"C:\\Program Files (x86)\\Python\\Pythonw.exe\" \"%1\" %*\"" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T09:13:50.193

你能以root身份试试这个吗：

```
$ ln -s python2.7 /usr/local/bin/python 
```

以 root 身份注销并再次登录：

```
$ python -V 
```

它对我有用，希望对你也一样。

干杯，

# javascript - Converting site to wordpress?

> ID：13593923
> 
> 赞同：0
> 
> 时间：2012-11-27T22:00:35.720
> 
> 标签：javascript, html, css, wordpress

I have been looking for tutorials on how to convert my site into wordpress. Right now I have a site created using html/css/javascript and it is not yet uploaded to the web. I am a beginner and someone told me to learning how to convert it to wordpress was good practice. But the tutorials I found only showed how to convert css and html. But none mention javascript, can I convert this as well as the others? And do I have to publish my site first or can I make it for wordpress locally, and then put it on the web? Thanks folks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:08:38.873

要制作一个运行良好的 Wordpress 主题，您应该更好地了解 Wordpress 项目。

基本上，您的目标是创建一个坚实的主题。可以将主题导入 wordpress 项目，它应该包含以下文件：

*   索引.php
*   评论.php
*   页脚.php
*   头文件.php
*   边栏.php
*   样式.css

    ```
    Location: wp-content/themes/your_theme 
    ```

您可以使用更少甚至更多的文件。这些是主要文件，但包含 javascrpt/jquery 也没有问题。

[请在这里](http://codex.wordpress.org/Theme_Development)阅读更多

# javascript - Mootools is adding unwanted function calls to JSON results

> ID：13593924
> 
> 赞同：0
> 
> 时间：2012-11-27T22:00:42.687
> 
> 标签：javascript, jquery, asp.net, ajax, mootools

I have a function that gets a list of vehicles in an asp.net page

```
 function GetVehicleCounts(totalVehicles, vehiclesInDepot, vehiclesInFilter,         vehiclesInKnownLocations, vehiclesInUnknownLocations, vehiclesNotInDepot)
{
vehiclesInDepot.value = 0;
vehiclesInFilter.value = 0;
vehiclesInKnownLocations.value = 0;
vehiclesInUnknownLocations.value = 0;
vehiclesNotInDepot.value = 0;
var listofVehicles;
var count = 0;

for (var k in vehicles_dm) {
    vehiclesInDepot.value++;

    if (vehicles_dm[k].IsInFilter) {
        vehiclesInFilter.value++;
    }

    if (vehicles_dm[k].CurrentFeatureType == 11) {
        vehiclesInUnknownLocations.value++;            
    }
    else {
        vehiclesInKnownLocations.value++;
    }
}

if (vehicles_dm != null) {
    vehiclesNotInDepot.value = totalVehicles - vehicles_dm.length;
}
} 
```

However, when I add Mootools to the page I run into the problem of Mootools adding all the function calls to the results. This ends up getting repeated for any function that is similar. Any ideas for correcting?

I don't have a choice about using Mootools and the existing page is done in jQuery.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T18:32:53.253

我找到了答案！

'for..in 不适用于数组迭代。它遍历对象的所有非内置属性。由于 MooTools 为 Array 原型添加了更多功能，因此它们现在也是数组属性。请参阅此[https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Statements/For...in](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Statements/For...in)

只需使用基本的 for 循环进行数组迭代。

[使用包含 MooTools 的 for..in 的 Javascript 数组迭代](https://stackoverflow.com/questions/2040042/javascript-array-iteration-using-for-in-with-mootools-included)

# ios - how to make ruby on rails database api available for a data driven ios app

> ID：13593927
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:00:47.733
> 
> 标签：ios, ruby-on-rails, web-applications, geolocation

Well , I have just started coding in general. I am trying to make an ios social app with basic picture information taking data from a website ( some what of a flickr-clone)

So , the main website will be built on Ruby on rails.

**EDIT :**

ok so , i want to know when a person uploads a picture , it will have the following entries: * name * who took * location

I was researching about the gem logtrend (https://github.com/gorsuch/logtrend) , i was wondering if I can make a trending feed of sorts using location?

eg: the user selects a tab which shows them the trending pic ( near them (based on his core location) ?? Can we do something like that ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:37:39.153

我对 Ruby on Rails 一无所知，但我知道要做你想做的事情（让用户将带有姓名和 GPS 位置的照片上传到服务器，然后允许其他用户通过下载来查看该照片到他们的应用程序）。

构建服务器的一种方法是使用 Ruby on Rails 构建 Web 服务。

## 网络服务

Web 服务（您的服务器）做两件事：

**1) 接受请求**

**2) 返回响应**

使用 Web 服务，您接受 HTTP POST 或 GET 请求，然后您的服务器的逻辑代码将解析 POST 或 GET 中的“参数”或“变量”。

一旦您的服务器拥有这些变量，它就可以将它们保存到数据库中（ORM 确实会更容易）。

然后，您的 Web 服务可以使用**HTTP 状态代码**或**JSON**格式的响应返回响应。

## 示例场景

1) iPhone 应用程序拍摄照片，然后使用 ASIHttpRequest 或 AFNetworking 向您的 Ruby 服务器发出**HTTP** POST**请求**。

```
// ASIExample
-(void)uploadPhotoToServer
{
    NSURL *url = [NSURL urlWithString:myUploadWebServiceURL];

    __block ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

    // ---------------------------------------------------------------
    // setting the POST parameters below
    // note: you will need to get the NSData from a UIImage object
    // ---------------------------------------------------------------
    [request setData:imageData withFileName:@"myphoto.jpg" andContentType:@"image/jpeg" forKey:@"photo"];
    [request setPostValue:fldName.text forKey:@"name"];
    [request setPostValue:[NSNumber numberWithDouble:myLatitude] forKey:@"latitude"];
    [request setPostValue:[NSNumber numberWithDouble:myLongitude] forKey:@"longitude"];

    [request setCompletionBlock:^{
        int statusCode = [request responseStatusCode];

        if(statusCode == 200)
        {
            [self alertUploadComplete];
        }
    }];

    [request setFailBlock:^{
        NSLog(@"Server error: %@", [[request error] localizedDescription]);
        [self alertConnectionProblem];
    }];

    [request startAsynchronous];
} 
```

2）服务器接收请求，解析数据并返回响应

```
// Symfony Web Framework example (PHP based web framework)
public function uploadPhotoAction()
{
    // --------------------------------------------------
    // check to make sure all POST parameters are sent 
    // in the POST request by iPhone app.
    // --------------------------------------------------
    if(
        !isset($_REQUEST['name'] 
        || !isset($_REQUEST['latitude']
        || !isset($_REQUEST['longitude']
        || !isset($_REQUEST['photo']
    )
    {
        return new Response($this->sendResponse(406, 'Missing POST parameters');
    }
    else // assumes safe to continue
    {
        /* 
            write code to save the your name, latitude, longitude to your database here 
        */

        /* 
            save your photo to your server's dedicated photo folder, then store
            the file path to the file in your database entry in the above step
        */

        return new Response($this->sendResponse(200, 'Photo uploaded'));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:10:44.717

您可以使用的几个 gem 是[Devise](https://github.com/plataformatec/devise)和[OmniAuth](https://github.com/intridea/omniauth)用于社交登录/身份验证。

有关按类别划分的更多宝石，请查看[Ruby 工具箱](https://www.ruby-toolbox.com/)。

希望你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:11:03.913

*这可以通过 ruby​​ on rails 实现吗？*

是的，是的。

*我应该使用什么宝石？*

取决于您的方法和功能集。

*另外，哪些 gem 可以用来制作 API 来支持 IOS 应用程序？*

我认为您误解了 API 是什么。API 是**客户**端与主机交互的方式。

我建议您调查使用 JSON 在您的 IOS 应用程序和您的 Web 应用程序之间进行通信。IOS 和 Ruby/Rails 都非常有能力支持 JSON，并且相对轻量级。

此外，您需要**详细**定义IOS 应用程序在需要与 Web 应用程序交互的地方要做什么。

## 例子

*   IOS App (IA) 将图片保存到 Web App (WA)。
*   IA 可能会将同一张图片保存到 WA（覆盖）
*   IA 会被告知 WA 是否已满
*   IA 将登录 WA
*   IA 可以从 WA 注销
*   IA可以在WA上更改密码
*   WA 将拒绝来自未登录 IA 的命令
*   IA 可以从 WA 中检索用户的图片
*   IA 可以从 WA 中检索任何其他用户的图片

等等

现在，对于每一个，您都需要设计 API 来支持该功能。

# javascript - trigger.io hangs on splash screen in iOS

> ID：13593928
> 
> 赞同：4
> 
> 时间：2012-11-27T22:00:49.170
> 
> 标签：javascript, trigger.io

Oftentimes my app will hang on the "trigger.io FORGE" splash screen and never display my UI.

I have this happening both in the simulator and on a real device. It's intermittent which leads me to think maybe it's a race condition somewhere (do I need to be waiting for forge to initialize?).

I have no idea how to debug this as the trigger console isn't spitting out an error even when showing the debug output.

Anything I should check? It's weird because if I put in a call like this:

```
setInterval(function() {
    forge.logging.log('hi');
}, 1000);` 
```

I can see that my JavaScript code is being executed (and continues to execute as this is successfully logged until I kill the app).. but it's still hung on the splash screen. Oftentimes hitting the home button and re-entering the app will work. But sometimes it takes a few rebuilds before it will get past the splash screen.

I've now seen this on 2 different dev environments, 2 different physical devices, and the iOS simulator.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:30:52.230

这听起来像是 iOS 上的一个罕见问题，它会导致 Forge 侦听的 DOM 事件隐藏启动屏幕而不触发。

`forge.launchimage.hide()`解决此问题的最简单方法是通过在代码准备好时调用来确保隐藏启动画面。有关详细信息，请参阅[http://docs.trigger.io/en/v1.4/modules/launchimage.html#hide 。](http://docs.trigger.io/en/v1.4/modules/launchimage.html#hide)

如果这没有帮助，那么让我们知道，我们可以尝试找出它可能是什么。

# python - Python 2.6 Scapy rdpcap error

> ID：13593930
> 
> 赞同：1
> 
> 时间：2012-11-27T22:00:58.917
> 
> 标签：python, scapy

I'm new to the forum and new to Python programming in general and I have a question regarding the scapy module.

I'm trying to open a TCP dump file, and whenever I try to open the file using the command:

```
a=rdpcap("/directories/filename.pcap") 
```

I get the following warnings:

```
WARNING: DNS RR premature end (ofs=46, len=44)

WARNING: more DNS RR premature end (ofs=12, len=2)

WARNING: DNS incomplete jump token at (ofs=78) 
```

*the ofs and len value varies of course

eventually scapy and python would just crash. Just wondering if this is a problem with the file or something wrong with my scapy.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-01T19:42:12.237

我知道......自从这个问题上传以来已经有一段时间了，但我遇到了同样的警告，但方式略有不同。我想使用 scrappy`sniff`函数读取数据包，几乎每次处理 DNS 响应时，我都会收到警告“ `WARNING: DNS RR premature end`”，其效果是 DNS 响应到达目的地时不可读。过了一会儿，我发现 DNS 响应分为 Raw 和 Padding。我猜是由于使用 scapy 解码 DNS 数据包，它“增长”了。因此属性`ip.len`和`udp.len`不再正确。

在我的情况下，我能够在再次发送响应之前更正它。之后，该程序开始工作，不再有警告。我猜是由于使用 scapy 解码 DNS 数据包，它“增长”了。因此属性`IP.length`和`UDP.length`不再正确。

在我的情况下，我能够在再次发送响应之前更正它。之后，该程序开始工作，不再有警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-10T09:53:15.077

FTR 这是 Scapy 的一个错误。它得到了修复

# python - Cron python script not executing

> ID：13593935
> 
> 赞同：4
> 
> 时间：2012-11-27T22:01:21.403
> 
> 标签：python, cron, crontab, smtplib

I have read a few posts on this but I could not find help in them.

I have a python script that sends mail using smtplib. It works when invoked from the command line.

I have `#!/usr/bin/python` as the first row and can run it both using `/home/pi/ipsender.py` and `python /home/pi/ipsender.py`.

My crontab is `*/1 * * * * /home/pi/ipsender.py` but I have also tried `*/1 * * * * python /home/pi/ipsender.py` and `*/1 * * * * /usr/bin/python /home/pi/ipsender.py`.

Doing `which python` I get `/usr/bin/pyhton` and running python from the command line I can import and use smtplib just fine.

In `/var/log/syslog` I get:

```
Nov 27 22:57:01 raspberrypi /USR/SBIN/CRON[3764]: (pi) CMD (python /home/pi/ipsender.py)
Nov 27 22:57:01 raspberrypi /USR/SBIN/CRON[3763]: (CRON) info (No MTA installed, discarding output) 
```

And I'm guessing the No MTA... is just about Cron not sending emails about what it's doing, or isn't it?

How do I run this script.

[Edit]

The permission of the script is

```
-rwxr-xr-x 1 pi   pi       551 Nov 27 22:37 ipsender.py 
```

[Edit2] Using the tip from D Read I'm getting the following log

```
starting
Traceback (most recent call last):
  File "/home/pi/ipsender.py", line 7, in <module>
    ifconfig_output = sp.check_output(["ifconfig", "wwan0"])
  File "/usr/lib/python2.7/subprocess.py", line 537, in check_output
    process = Popen(stdout=PIPE, *popenargs, **kwargs)
  File "/usr/lib/python2.7/subprocess.py", line 679, in __init__
    errread, errwrite)
  File "/usr/lib/python2.7/subprocess.py", line 1249, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

Suggesting to me that there is something with the path. Although in `/etc/crontab` I have `PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin` and `which ifconfig` gives `/sbin/ifconfig`. So that should not be a problem right?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:50:04.643

crons 有很多陷阱......在没有 MTA 的情况下，以更简单的方式查看输出 - 尝试将其通过管道传输到文件：

```
*/1 * * * * /home/pi/ipsender.py > /home/pi/ipsender.log 2>&1 
```

用 a 启动你的 python 文件`print 'starting'`，看看 python 文件是否开始执行正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:50:38.463

尝试保存脚本的 STDOUT 和 STDERR：

```
*/1 * * * * /home/pi/ipsender.py &> /tmp/ipsender.log 
```

# c++ - 服务器/客户端聊天

> ID：13593936
> 
> 赞同：1
> 
> 时间：2012-11-27T22:01:23.223
> 
> 标签：c++, sockets, network-programming

我的想法是客户端可以连接到服务器上的聊天室并相互通信。在聊天室中，您还应该能够定位另一个用户，并且他们应该能够相互交谈。

现在来解决问题。我不确定哪种方式是实现这一点的最简单/最佳方式。对于我想到的聊天室，当用户写东西时，消息被发送到服务器，然后服务器将该消息回显给其他客户端。不知道我还有什么其他选择。

我最困惑的是我如何才能让只有 2 个客户互相交谈。服务器充当代理并将消息转发给另一个客户端，但这似乎效率低下。我能想到的唯一替代方法是 2 个客户端在彼此之间建立连接。为了实现这一目标，哪种实现最常见？

我正在使用带有 C++ 的 unix 套接字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T07:42:26.453

多对多聊天和一对一聊天有几个选项。但是，多对多聊天的唯一合理选择是按照您所说的那样做：向集中式服务器发送消息，服务器将消息中继给所有其他连接的客户端（或者，在同一个“房间”中） / “渠道”）。

对于一对一聊天，我建议您遵循相同的确切模型：这只是多对多聊天中继的一种特殊情况，其中消息由服务器作为代理仅发送给另一个连接的客户端. 这很简单，它隐藏了每个客户端的 IP 地址。

然而，如果一对一通信变得比聊天（例如，文件传输）更多，则直接的一对一通信可能是合适的。在这种情况下，服务器应该将直接的点对点通信通道的启动中继给远程用户，可能会在设置时交换 IP 地址，然后客户端将直接相互连接以进行特殊目的的直接通信（虽然通常（尽管可选）保持与服务器的连接）。

因此，一对一的通信通常由服务器代理，就像在多对多的一般情况下一样，这种做法效率低下的程度是肤浅的。特殊用途的一对一通信（文件传输、VoIP 等）是通过通常首先由服务器编排的直接客户端到客户端连接完成的（即，为直接通信的每一方做好准备）。

实现提示：服务器全部为TCP。阅读有关非阻塞套接字、POSIX 系统调用`poll`的信息，并让基于 TCP 的消息成帧的想法在您的脑海中盘旋。然后，您可以跳过服务器代码中的多线程 [和可伸缩性] 问题。除了与您的服务器使用相同的自定义 TCP 协议外，客户端由您决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:09:18.100

那么你可以实现一个多线程的客户端/服务器。中继消息的单个“服务器”是正确的方法（保持消息的全局顺序）。还要考虑领导选举算法（http://en.wikipedia.org/wiki/Bully_algorithm），例如，以防您的“服务器”出现故障。查看

另一种方法是使用信号和事件驱动编程。

# ruby-on-rails - 如何使用自定义 Sprockets 处理器将 rails 3.X 应用程序（无 stub_asset）中的资产列入黑名单？

> ID：13593938
> 
> 赞同：3
> 
> 时间：2012-11-27T22:01:36.623
> 
> 标签：ruby-on-rails, asset-pipeline, sprockets

我正在创建一个自定义处理器，它需要在加载某些文件时将它们动态列入黑名单。特别是，我添加了两个指令“允许”和“限制”。以下是设置示例：

./manifest.js

```
#= allow Group1
#= require_tree . 
```

./some_included_file.js

```
#= restrict Group1 
```

./some_other_file.js

```
#= restrict Group2 
```

在上述情况下，manifest.js 被加载，并尝试加载 some_included_file 和 some_other_file。然而，由于“允许 Group1”指令，只有第一个文件应该被捆绑，另一个不应该因为 Group2 限制（不允许）。

以下是我到目前为止的内容：

```
class CustomProcessor < Sprockets::DirectiveProcessor

  def process_allow_directive group

    unless defined? self.context.environment.custom_allow_list
      self.context.environment.class.module_eval { attr_accessor :custom_allow_list }
    end

    self.context.environment.custom_allow_list ||= []
    unless self.context.environment.custom_allow_list.include? group
      self.context.environment.custom_allow_list += [group]
    end
  end

  def process_restricted_directive *groups

    groups.each do |group|
      if defined? self.context.environment.custom_allow_list
        if self.context.environment.custom_allow_list.include? group

          # Allow the file to be included
          # Don't intervene
          return
        end
      end
    end

    # File is restricted, prevent loading, but....
    # ....HOW ??

  end
end

Rails.application.assets.register_preprocessor('application/javascript', CustomProcessor) 
```

# file - 节点 js 将文件发布到远程服务器上的 php api

> ID：13593940
> 
> 赞同：3
> 
> 时间：2012-11-27T22:01:44.227
> 
> 标签：file, node.js, post

我必须将文件发布到远程服务器上的 php api url。我正在创建一个 http.request，然后尝试通过从文件流中通过管道将文件数据写入该请求，如下所示：

```
var req = http.request( options, function(response) {
  response.on('data', function (chunk) {
console.log('BODY: ' + chunk);
 });
});
var fs = require('fs');
var boundaryKey = "5JtsIWpXzRoEIdPqkQiSWv4Tl8Bmq";//Math.random().toString(16); //     random string
var filelen = filelen; \\Already calculated before
req.setHeader('Content-Type', 'multipart/form-data;boundary='+boundaryKey);
req.setHeader('Content-Length', filelen);
// the header for the one and only part (need to use CRLF here)

req.write('--' + boundaryKey + '\r\n'
      // "name" is the name of the form field
      // "filename" is the name of the original file
  + 'Content-Disposition: form-data; name="gamefile"; filename="image.jpg"\r\n'
  // use your file's mime type here, if known
  + 'Content-Type: image/jpeg\r\n' 
  + 'Content-Transfer-Encoding: binary_file_data\r\n\r\n' 
);

var fileStream = fs.createReadStream('/image.jpg');
     fileStream.pipe(req, { end: false }); // maybe write directly to the socket here?
 fileStream.on('end', function() {
 console.log("File Streamed");
 // mark the end of the one and only part
 req.end('--' + boundaryKey + '--\r\n\r\n'); 
 }); 
```

在我的 php 服务器上，我在 files 数组中得到了什么：

```
Array                                                                                                                    
(                                                                                                                        
    [gamefile] => Array                                                                                                  
        (                                                                                                                
            [name] => image.jpg                                                                                          
            [type] =>                                                                                                    
            [tmp_name] =>                                                                                                
            [error] => 3                                                                                                 
            [size] => 0                                                                                                  
        )                                                                                                                

) 
```

这意味着我的文件没有到达服务器。请建议我是否做错了什么或确实需要做其他事情。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-27T22:23:25.390

看一下[请求](https://github.com/mikeal/request)模块。它使执行 REST 请求变得非常容易，包括执行包含文件的 POST 请求。查看[表单文档](https://github.com/mikeal/request#forms)以获取更多信息。基本上它是这样的：

```
var request = require('request');

var r = request.post('http://service.com/upload')
var form = r.form()
form.append('my_field', 'my_value')
form.append('my_buffer', new Buffer([1, 2, 3]))
form.append('my_file', fs.createReadStream(path.join(__dirname, 'doodle.png'))
form.append('remote_file', request('http://google.com/doodle.png')) 
```

# c# - C# 枚举的奇怪行为

> ID：13593944
> 
> 赞同：5
> 
> 时间：2012-11-27T22:01:50.540
> 
> 标签：c#, class, enums

我正在这里开发一款游戏，并发现了这个相当有趣的错误。假设你有这个枚举：

```
public enum ItemType 
{
    Food,
    Weapon,
    Tools,
    Written,
    Misc
}; 
```

一个基类

```
public class BaseItem
{
    public string Name = "Default Name";

    public ItemType Type = ItemType.Misc;
} 
```

和它的两个实例：

```
Ins1 = new BaseItem
{
   Name = "Something",
   Type = ItemType.Food
};

Ins2 = new BaseItem
{
   Name = "Something too",
   Type = ItemType.Tools
} 
```

这就是发生在我身上的事情：第一个实例的类型将保持在基类中预初始化的状态，即使我在其构造函数中指定我希望类型为 Food。第二个实例的类型将正确设置为工具。

如果，我在食物之前添加了一个新的枚举值，例如：

```
public enum ItemType 
{
    Nothing,
    Food,
    Weapon,
    Tools,
    Written,
    Misc
}; 
```

那么第一个实例的类型将是，正如预期的那样，食物。第二个实例的类型也是正确的。

是什么导致了这种行为？简而言之，在构造函数中将类型设置为枚举的第一个值的所有实例实际上将返回到它们在 BaseItem 定义中的值。在第一个枚举值之前添加一个额外的值显然可以解决问题；但这是错误的，所以我想知道是什么导致了这个问题。

谢谢！

--- 稍后编辑 --- 如果这有帮助：不对 BaseItem 内的“Type”字段进行任何初始化，只留下大括号构造函数进行初始化，一切正常，无需向枚举添加“Nothing”值.

为此事道歉; 经过更多的挖掘，这似乎是一个仅限 Unity 的错误。其他一些人也遇到过。我已经解决了这个问题；每个人都得到我的投票，我会添加我自己的答案；也许其他一些 Unity 用户会找到它。非常感谢您的帮助和兴趣！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:11:14.287

如果有其他 Unity 用户在此处搜索信息，认为这是一些 .NET 行为问题：这似乎是 Unity 独有的错误。其他人也遇到过。只需避免在类本身中为此类东西进行任何类型的初始化，或使用属性。

这绝对不是 Microsoft .NET 问题，也不是 Mono .NET 问题（您可以随时使用相同的代码启动 Mono 项目，它会正常工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:15:30.417

如果声明枚举的代码`ItemType`位于另一个程序集（项目）中，而不是声明`BaseItem`类的代码或引入`Ins1`和变量的代码，那么在更改枚举的定义时重新编译*所有*`Ins2`程序集至关重要.*`ItemType`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:08:10.287

只是有一个想法。不确定它是否会起作用。似乎 BaseItem 的构造函数在您初始化后被调用。尝试放置一个断点并查看何时调用 BaseItem 的构造函数。或者您可以尝试在设置名称和类型之前显式调用 BaseItem 的构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T22:16:05.117

这只是一个猜测，但是，由于 Enum 的第一个值等于 0，可能是在定义中设置默认值（ItemType.Misc 或 5）加上使用将值设置回的类型初始值设定项的组合如果您没有默认值（ItemType.Food 或 0）会导致您指定的默认值（ItemType.Misc）被保留。

顺便说一句，这很重要，您实际上并没有定义构造函数。语法

```
Ins1 = new BaseItem
{
   Name = "Something",
   Type = ItemType.Food
}; 
```

... 不是对构造函数的调用，而是对类型初始化程序的调用。是的，默认构造函数被调用，但该构造函数中没有任何反应。

我敢打赌，如果您实际使用构造函数并在那里设置 ItemType 的默认值，您会看到这个问题消失了。就像是：

```
public BaseItem()
{
    this.Type = ItemType.Misc;
} 
```

虽然我不记得阅读过任何明确说明这一点的内容，但我认为您不应该使用您使用的语法为公共属性或字段设置默认值。如果需要设置，请在构造函数中设置，以便轻松覆盖。您使用的语法更适合私有支持字段，而不是可以从类外部设置的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T00:20:55.053

这段代码应该可以正常工作。也许您应该尝试发布一个重现您的问题的最小程序，因为它必须是由其他原因引起的。

您应该注意一件事。您使用的不是构造函数，而是对象初始化。主要区别在于，当您使用对象初始值设定项时，生成的代码首先调用对象的默认构造函数，然后设置属性/字段。

所以这段代码：

```
var myItem = new BaseItem
{
    Name = "something",
    Type = ItemType.Misc
} 
```

实际上等价于这个：

```
var myItem = new BaseItem();
myItem.Name = "something";
myItem.Type = ItemType.Misc; 
```

您可能想要的是定义一个构造函数，如下所示：

```
class BaseItem
{
    public BaseItem(string name, ItemType type)
    {
        this.Name = name;
        this.Type = type;
    }

    // ...
} 
```

然后像这样使用它：

```
var myItem = new BaseItem("something", ItemType.Misc); 
```

我猜想使用这种更明确的方法可能会间接解决您的错误，并且至少可能会使您的代码不易出错。*

# javascript - 使用没有“返回”功能的 History.js

> ID：13593946
> 
> 赞同：0
> 
> 时间：2012-11-27T22:02:02.120
> 
> 标签：javascript, history.js

我正在使用 History.js，并在“下一页”点击中添加状态。我需要在每个页面更改（下一个，上一个）上更改 url，但是当在浏览器中单击“返回”时，我需要在开始分页之前访问该页面。

明确一点：我在某个全球页面中，我想搜索一些东西；我进入搜索结果页面；当我更改结果页面时，我将 url 更改为更加用户友好；当我在浏览器中单击“返回”时，我想进入“全局页面”，所以就像我驻留在搜索页面中一样，之前的页面是全局页面。

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:06:45.913

对于那些遇到这种情况的人。你应该使用replaceState。它将替换浏览器中的 url 但不会在历史记录中添加新项目！

# regex - 任何类型的字符的 php 正则表达式

> ID：13593948
> 
> 赞同：0
> 
> 时间：2012-11-27T22:02:19.017
> 
> 标签：regex

我使用这种模式：

```
'/({for) (\d+) (times})([\w+\d+{}]{0,})({endfor})/i' 
```

转换

```
{for 3 times}App2{endfor} 
```

在

```
App2  App2  App2 
```

但这不适用于：

```
{for 7 times}
    App2
{endfor} 
```

* * *

**这是我很小的模板引擎的一小部分。**

*这只是为了好玩*

```
$mactos = Array(
    '/({for) (\d+) (times})([\w+\d+{}]{0,})({endfor})/i' => '<?php for($i=0;$i<${2};$i++) : ?> ${4} <?php endfor; ?' . '>',
    '/({{)(\w+)(}})/i' => '<?php echo $${2}; ?' . '>'
);
$php = file_get_contents('teamplate.php');
foreach ($this->getPatternAndReplacement() as $pattern => $replacement) {
    $php = preg_replace($pattern, $replacement, $php);
} 
```

* * *

我已经读过（...）除了用

```
'/({for) (\d+) (times})(...)({endfor})/i' 
```

不工作=(。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:06:59.313

如果您的字面意思是`(...)`，那是一个与三个字符完全匹配的组。`(.+)`将匹配一个或多个任何字符，除了...

* * *

默认情况下，`.`匹配*除*换行符以外的任何内容。

> **s (PCRE_DOTALL)**
> 如果设置了此修饰符，则模式中的点元字符匹配所有字符，包括换行符。没有它，换行符被排除在外。

使用[`s`修饰符](http://us1.php.net/manual/en/reference.pcre.pattern.modifiers.php)允许`.`匹配换行符。

```
/your pattern/s 
```

* * *

*示例（也在[这里](http://codepad.viper-7.com/aHyru2)）*：

```
$str = <<<STR
{for 7 times}
    App2
{endfor}
STR;

preg_match('/({for) (\d+) (times})(.+)({endfor})/s', $str, $matchParts);

print_r($matchParts); 
```

```
OUTPUT:

Array
(
    [0] => {for 7 times}
    App2
{endfor}
    [1] => {for
    [2] => 7
    [3] => times}
    [4] => 
    App2

    [5] => {endfor}
) 
```

# r - 使用knitr时如何从多个图中旋转一个图？

> ID：13593949
> 
> 赞同：12
> 
> 时间：2012-11-27T22:02:21.870
> 
> 标签：r, knitr

我正在使用带有情节的knitr。我想将其中一个旋转 90 度。例如：

```
\documentclass{article}

\begin{document}

<<cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE, comment=NA, eval=TRUE, results=asis>>=

library("ggplot2")
library("gridExtra")

func <- function(data,x,y) {

  p1 <- ggplot(data.frame(data), aes(x = x, y = y)) + geom_point()
  p2 <- ggplot(data.frame(data), aes(x = x, y = y)) + geom_point()
  p3 <- ggplot(data.frame(data), aes(x = x, y = y)) + geom_point()
  p4 <- ggplot(data.frame(data), aes(x = x, y = y)) + geom_point()

  grid.newpage() 
    pushViewport(viewport(width = .9, height = .9,layout = grid.layout(nrow=2, ncol=2)))
    print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
    print(p2,vp = viewport(layout.pos.row = 2, layout.pos.col = 1))
    print(p3,vp = viewport(layout.pos.row = 1, layout.pos.col = 2))
    print(p4,vp = viewport(layout.pos.row = 2, layout.pos.col = 2))

  grid.newpage() 
    pushViewport(viewport(width = .8, height = .5,layout = grid.layout(nrow=1, ncol=2)))
    print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
    print(p2,vp = viewport(layout.pos.row = 1, layout.pos.col = 2))

}

x <- runif(20,0,1)
y <- rnorm(20)
test <- cbind(x,y)
func(test,x=test$x,y=test$y)

@    

\end{document} 
```

我想将第二页和图表都旋转 90 度。我知道我可以将它用于一页：

```
\usepackage{pdflscape}
\begin{landscape}
....
\end{landscape} 
```

但是这两个图是由 grid.newpage() 在一个函数中排列的。我怎样才能做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-27T22:11:11.737

我认为您可以`out.extra`在块选项中使用：

来自 knitr 文档：http: [//yihui.name/knitr/options](http://yihui.name/knitr/options)

> out.extra: (NULL; character) 图形的额外选项，例如 LaTeX 输出中的 out.extra='angle=90' 会将图形旋转 90 度；它可以是任意字符串，例如，您可以在此选项中编写多个图形选项；它也适用于 HTML 图像（额外的选项将被写入标签，例如 out.extra='style="display:block;"'）

```
<<out.extra='angle=90', cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE, comment=NA, eval=TRUE, results='asis'>>=
# ... 
@ 
```

# python - Suds 写入请求缺少数据类型？

> ID：13593950
> 
> 赞同：0
> 
> 时间：2012-11-27T22:02:32.253
> 
> 标签：python, soap, suds

我正在尝试使用 Suds 与 Web 服务通信，从服务中读取工作正常，但是写入会引发错误。

> suds.WebFault：服务器引发错误：'格式化程序在尝试反序列化消息时抛出异常：尝试反序列化参数[http://tempuri.org/:tagValues](http://tempuri.org/:tagValues)时出错。InnerException 消息是“来自命名空间 [http://schemas.datacontract.org/2004/07/NOV.Api.Messages](http://schemas.datacontract.org/2004/07/NOV.Api.Messages)的元素值不能将子内容反序列化为对象。请使用 XmlNode[] 反序列化这种 XML 模式。'。有关更多详细信息，请参阅 InnerException。

XML 生成的似乎没有添加必要的 xsi:type="xsd:int"

出品：

```
<ns1:TagValue>
   <ns1:Quality>
      <ns1:Id>1</ns1:Id>
      <ns1:QualityData>Quality</ns1:QualityData>
   </ns1:Quality>
   <ns1:TagID>
      <ns1:Id>0</ns1:Id>
      <ns1:TagID>BitDepth</ns1:TagID>
   </ns1:TagID>
   <ns1:Value>23</ns1:Value>
</ns1:TagValue> 
```

预期的：

```
<ns1:TagValue>
   <ns1:Quality>
      <ns1:Id>1</ns1:Id>
      <ns1:QualityData>Quality</ns1:QualityData>
   </ns1:Quality>
   <ns1:TagID>
      <ns1:Id>0</ns1:Id>
      <ns1:TagID>BitDepth</ns1:TagID>
   </ns1:TagID>
   <ns1:Value xsi:type="xsd:int">23</ns1:Value>
</ns1:TagValue> 
```

在四处搜索后，我想尝试 ImportDoctor 看看我是否可以进入 xsi:type

我添加了

```
schema_url = 'http://schemas.xmlsoap.org/soap/encoding/'
schema_import = Import(schema_url)
schema_doctor = ImportDoctor(schema_import) 
```

和客户端ctor中的医生=模式医生

这现在给了我一个额外的前缀和一个扩展得多的类型列表

```
Prefixes (4)
   ns0 = "http://schemas.datacontract.org/2004/07/NOV.Api.Messages"
   ns1 = "http://schemas.microsoft.com/2003/10/Serialization/"
   ns2 = "http://schemas.xmlsoap.org/soap/encoding/"
   ns3 = "http://tempuri.org/" 
```

我现在有一个 ns2:int

我使用工厂创建了一个 ns2:int 类型的对象，将其值设置为 23

发送时，我得到以下 XML：

```
<ns1:TagValue>
   <ns1:Quality>
      <ns1:Id>1</ns1:Id>
      <ns1:QualityData>Quality</ns1:QualityData>
   </ns1:Quality>
   <ns1:TagID>
      <ns1:Id>0</ns1:Id>
      <ns1:TagID>BitDepth</ns1:TagID>
   </ns1:TagID>
   <ns1:Value xsi:type="ns2:int">23</ns1:Value>
</ns1:TagValue> 
```

现在尝试发送时出现以下异常：

> suds.WebFault：服务器引发错误：'格式化程序在尝试反序列化消息时抛出异常：尝试反序列化参数[http://tempuri.org/:tagValues](http://tempuri.org/:tagValues)时出错。InnerException 消息是“第 1 行位置 651 中的错误。元素“http://schemas.datacontract.org/2004/07/NOV.Api.Messages:Value”包含映射到名称“http:/”的类型的数据/schemas.xm lsoap.org/soap/encoding/:int'。反序列化器不知道映射到此名称的任何类型。考虑使用 DataContractResolver 或将与“int”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将其添加到传递给 DataContractSerializer 的已知类型列表中。

似乎稍微接近一点，但似乎命名空间有些混乱？

生成的完整 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:ns3="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns0="http://tempuri.org/" xmlns:ns1="http://schemas.datacontract.org/2004/07/NOV.Api.Messages" xmlns:ns2="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
   <SOAP-ENV:Header/>
   <ns3:Body>
      <ns0:WriteRealtimeValues>
         <ns0:tagValues>
            <ns1:TagValue>
               <ns1:Quality>
                  <ns1:Id>1</ns1:Id>
                  <ns1:QualityData>Quality</ns1:QualityData>
               </ns1:Quality>
               <ns1:TagID>
                  <ns1:Id>0</ns1:Id>
                  <ns1:TagID>BitDepth</ns1:TagID>
               </ns1:TagID>
               <ns1:Value xsi:type="ns2:int">23</ns1:Value>
            </ns1:TagValue>
         </ns0:tagValues>
      </ns0:WriteRealtimeValues>
   </ns3:Body>
</SOAP-ENV:Envelope> 
```

作为参考，我使用以下代码创建客户端

```
credentials = dict(username='%s' % (username), password='%s' % password)
url=   "http://%s:%s/TagValueWriteService?wsdl" % (ip,port)
self.transport  = HttpAuthenticated(**credentials)
suds.client.Client.__init__(self,url, transport=self.transport, cache=None,doctor=schema_doctor) 
```

stackoverflow 上似乎有几个类似的问题，其中大多数以与我尝试类似的方式提到 ImportDoctor。我怀疑我缺乏对 SOAP 的一些基本理解......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T20:05:41.810

我设法解决了这个问题，[使用 SUDS 时添加 xsi:type 和信封命名空间](https://stackoverflow.com/questions/10916433/adding-xsitype-and-envelope-namespace-when-using-suds)（[https://stackoverflow.com/a/10977734/696768](https://stackoverflow.com/a/10977734/696768)）

我不确定这是唯一可能的解决方案，对我来说，这似乎更像是一种黑客攻击，但它适用于我目前的情况。

我使用的解决方案是为客户端制作一个插件，寻找我需要成为 xsi:type="xsd:int" 的特定元素，然后将这些属性添加到这些元素中。

我最终用作参考的代码（来自上述stackoverflow问题，稍作调整）：

```
from suds.plugin import MessagePlugin
from suds.sax.attribute import Attribute

class SoapFixer(MessagePlugin):
    def marshalled(self, context):
        # Alter the envelope so that the xsd namespace is allowed
        context.envelope.nsprefixes['xsd'] = 'http://www.w3.org/2001/XMLSchema'
        # Go through every node in the document and apply the fix function to patch up incompatible XML. 
        context.envelope.walk(self.fix_any_type_string)
    def fix_any_type_string(self, element):
        """Used as a filter function with walk in order to fix errors.
        If the element has a certain name, give it a xsi:type=xsd:int. Note that the nsprefix xsd must also
         be added in to make this work."""

        # Fix elements which have these names
        fix_names = ['Value', 'anotherelementname']
        if element.name in fix_names:
            element.attributes.append(Attribute('xsi:type', 'xsd:int'))

plugin=SoapFixer() 
```

然后我将 plugins=[plugin] 添加到客户端ctor。

例子：

```
client = suds.client.Client("http://127.0.0.1:8099/TagValueWriteService?wsdl",plugins=[plugin]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T02:57:49.780

这不是一个“答案”，因为这个问题是客户端的。但我现在把它放在这里是为了搜索引擎。

问题是请求消息是一种复杂类型。

我的解决方案是在服务器端。我的服务现在接受请求中的无类型元素。请求正文的服务器端解析必须知道请求模式。一旦发生这种情况，服务器就可以对请求进行类型检查和解析，而无需客户端键入元素。

具体来说，我的错误来自使用 Python ZSI 模块和 Zope 实现的服务。

> 任何无法解析无类型元素

在这里，我得到了关于复杂请求对象的提示：http:
[//pypi.python.org/pypi/z3c.soap/](http://pypi.python.org/pypi/z3c.soap/) （参见 ValidateEmailRequest）

在这里，我参加了 ZSI 速成课程： [Zolera SOAP Infrastructure (ZSI) 是否有任何工作示例？](https://stackoverflow.com/questions/7796440/are-there-any-working-examples-of-zolera-soap-infrastructure-zsi)

这里还有不错的 ZSI 文档：http: [//pywebsvcs.sourceforge.net/zsi.html#SECTION0071100000000000000000](http://pywebsvcs.sourceforge.net/zsi.html#SECTION0071100000000000000000)

为了让 ZSI 满意，您只需创建一个表示请求消息的类，并为其添加一个类型代码。这就是为什么你会看到很多服务对“操作 foo”、“fooRequest”和“fooResponse”，所以它们可以将请求和响应对象作为 xml 复杂类型来键入。

对于上面的示例，我会将类似这样的内容导入到正在解析soap请求主体的命名空间中。你可以变得更复杂，但这确实是所有必要的：

```
import ZSI

class WriteRealTimeValuesRequest(object):
   tagValues = array() #of TagValue

WriteRealTimeValuesRequest.typecode = ZSI.TC.Struct(WriteRealTimeValuesRequest,
                                                    (ZSI.TC.Array("TagValue",
                                                                 TagValue.typecode,
                                                                 "tagValues"
                                                                ),
                                                     ),
                                                    "WriteRealTimeValuesRequest") 
```

“什么是标签值？”

```
class TagValue(object):
   Quality = Quality
   TagId = TagId
   Value = Value

TagValue.typecode = ZSI.TC.Struct(TagValue,
                                  (Quality.typecode,
                                   TagId.typecode,
                                   Value.typecode),
                                  "TagValue") 
```

什么是质量？

```
class Quality(object):
   Id = 0
   QualityData = "I'm a string"

Quality.typecode = ZSI.TC.Struct(Quality,
                                 (ZSI.TC.Integer("Id"),  #this is the secret sauce 
                                  ZSI.TC.String("QualityData")  #and here
                                 ),
                                 "Quality") 
```

依此类推，直到您一直深入到所有原始类型。

# wpf - WPF ListItem 模板 - 淡入的按钮

> ID：13593951
> 
> 赞同：1
> 
> 时间：2012-11-27T22:02:32.497
> 
> 标签：wpf, listbox, datatemplate, listboxitem

我有一个带有 ItemTemplate 的 ListBox（如下所示），当鼠标悬停在某个项目上时，会显示一个按钮，该按钮将触发删除命令。

这可行，但我想要的是在鼠标在列表项上停留几秒钟后按钮“淡入”。我怎样才能做到这一点？

```
 <ListBox.ItemTemplate>
            <DataTemplate d:DesignSource="{d:DesignInstance quizCompanion:Question}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40"></ColumnDefinition>
                        <ColumnDefinition Width="16"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding Path=Number}"></TextBlock>
                    <Button 
                        Content="x" Grid.Column="1"
                        Command=MyDeleteCommand>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Visibility" Value="Hidden"></Setter>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ListBoxItem}},Path=IsMouseOver}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:46:58.357

尝试使用带有 RelativeSource 的 DataTrigger 进行绑定。

这是一个示例... 将鼠标悬停在 StackPanel 上的任何位置 2 秒或更长时间，隐藏的按钮将淡入。当鼠标移开时它会消失。希望它可以在您的 ListBox ItemTemplate 中工作：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
   <Grid>
      <StackPanel Height="100" Background="Yellow">
         <TextBlock Text="Mouse over the yellow area to see the button"/>
         <Button Width="250" Height="50" HorizontalAlignment="Left" Opacity="0">
            <Button.Style>
               <Style>
                  <Style.Triggers>
                     <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type StackPanel}}}" Value="True">
                        <DataTrigger.EnterActions>
                           <BeginStoryboard Name="Fade">
                              <Storyboard>
                                 <DoubleAnimationUsingKeyFrames Duration="0:0:3" Storyboard.TargetProperty="Opacity">
                                    <LinearDoubleKeyFrame KeyTime="0:0:2" Value="0"/>
                                    <LinearDoubleKeyFrame KeyTime="0:0:3" Value="1"/>
                                 </DoubleAnimationUsingKeyFrames>
                              </Storyboard>
                           </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                           <StopStoryboard BeginStoryboardName="Fade"/>
                        </DataTrigger.ExitActions>
                     </DataTrigger>
                  </Style.Triggers>
               </Style>
            </Button.Style>
         </Button>
      </StackPanel>
   </Grid>
</Page> 
```

# transactions - EJB 3 事务服务外观

> ID：13593955
> 
> 赞同：3
> 
> 时间：2012-11-27T22:02:49.023
> 
> 标签：transactions, ejb, rollback

我正在尝试实现服务外观模式，

我有一些 jars 部署在不同的 OAS 容器中，在 jars 中有 Stateless EJB 3.0，它们有一些通过 RMI 使用的方法，这些方法是通过 Wars 应用程序中的 RMI 调用的

但是现在我们有了一个新的要求，从一次战争中，我必须从一个事务内不同容器中的不同 jars 文件中调用 3 个方法，如果某个 jar 中的某些方法失败，我必须对所有方法进行回滚。

例子：

JAR A，具有部署在 OAS 容器“OAS A”中的 EJB“A”，并具有方法“A()”

JAR B，具有部署在 OAS 容器“OAS B”中的 EJB“B”，并具有方法“B()”

JAR C，具有部署在 OAS 容器“OAS C”中的 EJB“C”，并具有方法“C()”

WAR Z，部署在 OAS 容器中“OAS Z”必须在事务中调用方法 A() B() y C()。

由于在 War 文件中我们无法管理事务，因此我们在名为 ServiceFacade.jar 的 jar 文件中创建了一个新应用程序，并部署在 OAS 容器“OAS SF”中，并有一个调用 A() B 的 EJB“SF” () C() 通过 RMI 的其他 Ejb。

所以WAR Z通过RMI调用调用这3个方法的serviceFacade方法，一切正常。

问题？

在 EJB SF 内部，我们使用 UserTransaction 对象以这种方式管理事务：

```
 @Stateless(name="SF")
   @TransactionManagement(TransactionManagementType.BEAN)
   @ApplicationException(rollback = true)
   public class ServiceFacade ...
   @Resource private UserTransaction userTx;
    public void test() {
        try {
            userTx.begin();
            getEJBA().A();
            getEJBB().B();
            getEJBC().C();
            userTx.commit();
        } catch (Exception e) {

            try {
                if (userTx != null && 
                    (userTx.getStatus() == Status.STATUS_ACTIVE || 
                     userTx.getStatus() == Status.STATUS_MARKED_ROLLBACK)) {
                    System.out.println("Rollback!!");
                    userTx.rollback();
                }
            } catch (SystemException ex) {
                throw new SIGNOSException(SIGNOSException.DEFAULT_EXCEPTION, 
                                          ex.getMessage());
            }
            throw (SIGNOSException)e;
        }
    } 
```

但是当从战争 Z 调用 test() 方法和事务中的一些方法时，可以说 getEJBB().B(); 失败，方法 getEJBA().A(); 不回滚！！

我们能做什么？我们还尝试了 TransactionManagementType.Container 和 @TransactionAttribute(TransactionAttributeType.REQUIRED) 但回滚都没有，甚至没有消息“回滚！！” 在控制台中打印。

希望各位高手能帮帮我。

谢谢！！！

# php - 添加几个规格而不先保存

> ID：13593957
> 
> 赞同：1
> 
> 时间：2012-11-27T22:03:08.043
> 
> 标签：php, jquery, mysql

我正在为产品目录使用 PHP/MySQL 中的编辑工具（简单 CMS 的类型）。我已经在互联网上搜索解决方案，但我什至不知道要搜索什么。所以现在我的希望寄托在你们身上。

我有一个表格，您可以在其中放置各种数据，例如 part.no、description 等。所有这些数据都保存到 MySql 表（项目）中。我还有一张带有预定义规格的表格。

我想要做的，但我找不到解决方案，是有一个下拉菜单（或类似的）和一个添加按钮来为每个相关规范添加一行，而不是每次都保存整个表单。选择所有规格时，我想先保存。

那么，我可以为此使用 PHP，还是需要 jQuery/Javascript 或类似的？我知道这是可能的，在 OpenCart 中看到过 :-)

我希望有人能理解我的问题。很难解释我没有完全掌握的语言。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:44:52.027

**客户端与服务器端**

Javascript：它位于用户的浏览器中。因此，您想在用户浏览器中移动的任何内容都将使用 JavaScript 完成。这是“客户端”

PHP：服务器上的这个站点，因此从用户的浏览器中获取输入并返回响应（通常是 HTML，但也可以是 JSON 或 Javascript 读取的 XML。）。这是“服务器端”。

**图书馆**

jQuery：这是一组为 Javascript 编写的函数，以使其更容易。因此，它在用户的浏览器中运行，让您更轻松地编写在屏幕上移动的位。

您会获得类似的库来帮助您编写 PHP（通常称为“框架”），并且还有许多其他用于 javascript 的库。

**从哪儿开始**

1.  编写您想要的 HTML 页面。第一次保持简单。
2.  然后编写一些javascript（可能使用jQuery）来移动菜单。谷歌“jquery menu dropdown”或类似的，你会找到一个你可以定制的解决方案。
3.  然后编写一些 PHP，为您提供您在“1”中编写的 HTML。
4.  然后决定当您单击 HTML 中的链接时会发生什么，并重复该过程（编写 HTML，合并 Javascript 以使其移动，编写 PHP 以提供 HTML）
5.  然后找出 HTML 的哪些部分是常见的或结构化的，并且应该来自数据库。

如果不为您编写它（在这种情况下您将永远无法学习），最好一次开始一点，并随着您知识的增长而构建。当您遇到需要解决的特定问题时，会在网络上存储大量示例。

* * *

在评论“[how to] 可以选择和添加单个/多个规范（来自另一个表）而无需在每次添加规范时保存整个表单”：

**与 AJAX 一起成长**

您要问的是 AJAX - 这是您让 Javascript 与服务器对话的地方，并让 javascript 根据结果在页面上移动位。jQuery 可能是最简单的（并且可能有最好的 ajax[文档/示例](http://api.jquery.com/jQuery.ajax/)，以及[移动 DOM](http://api.jquery.com/category/manipulation/)）。

基本上：您有一个在 JavaScript 中捕获的“事件”，例如

```
/// Using jQuery to trap a button click
$().ready( function() {
   $("#ButtonID").click( function(e) {
      e.preventDefault();
      alert('Button Clicked');
   });
}); 
```

然后您在该事件中构建一个 AJAX 调用（还可以查看[get](http://api.jquery.com/jQuery.get/)或[post](http://api.jquery.com/jQuery.post/)，因为语法更简单，您只需获得更少的控制权）。AJAX 将向您的 PHP 服务器发送一个请求，您可以让 PHP 返回 HTML，您可以使用下面链接的 DOM 操作函数（例如之前、html 等）替换/插入 HTML，或者，当您变得更高级时，您将发回 JSON，这是一种您可以更轻松地在 JavaScript 中操作的数据结构，以规定所需的操作。

如上所述，无需实际为您编写它，最好的起点是阅读文档并尝试一下。谷歌“jquery AJAX PHP table example”或类似的，你会在某处找到一个例子。

# matlab - Matlab 将 PDF 作为图像数组访问

> ID：13593961
> 
> 赞同：2
> 
> 时间：2012-11-27T22:03:36.227
> 
> 标签：matlab, pdf

建立一个系统，在图片中搜索特定区域，并保存它。一切正常。大多数情况下，我将从 pdf 书籍中提取这些区域。

因此，我正在寻找一种解决方案，将 matlab 中的 PDF 文件视为图像数组（每页都是图像）。到目前为止，我唯一发现的是如何在 matlab 中打开 pdf 文件。

我想出的最佳解决方案是将 PDF 导出为尽可能多的 PNG 图像并遍历它们。这些想法没有什么不好，但我想知道我错过了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:20:04.470

从[这个页面](http://www.mathworks.nl/matlabcentral/newsreader/view_thread/281736)来看，将pdf直接导入matlab似乎是不可能的：

对“pdf 导入”的快速[文件交换](http://www.mathworks.com/matlabcentral/fileexchange/19798-extract-text-from-a-pdf-document)搜索只提供了提取文本的尝试，而不是图像。

因此，总而言之，您将 pdf 保存为图像然后导入它们的方法似乎是可行的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-30T07:39:27.860

我同意萨尔瓦多·达利和丹尼斯的观点。要将 PDF 的每一页转换为 png 图像，我下载了 imagemagick 并按照此处的命令进行操作：

[https://aleksandarjakovljevic.com/convert-pdf-images-using-imagemagick/](https://aleksandarjakovljevic.com/convert-pdf-images-using-imagemagick/) 具体：convert -density 150 -antialias "input_file_name.pdf" -resize 1024x -quality 100 "output_file_name-%03d.png"

当然，还有其他关于为此目的使用 ImageMagick 的讨论： [Converting a PDF to PNG](https://stackoverflow.com/questions/653380/converting-a-pdf-to-png) and [Convert PDF to PNG using ImageMagick](https://stackoverflow.com/questions/2869908/convert-pdf-to-png-using-imagemagick)

这是一个旧线程，但它是我在问同样问题时发现的，所以我想我会详细说明，以防它对也登陆该线程的未来用户有所帮助。

# python - Django模板语法中的Python for循环，迭代5

> ID：13593962
> 
> 赞同：0
> 
> 时间：2012-11-27T22:03:41.310
> 
> 标签：python, django-templates

我知道这是一个令人难以置信的菜鸟问题，但我似乎找不到我需要的示例（这里有一些 for 循环示例[，](https://docs.djangoproject.com/en/dev/ref/templates/builtins/)但不是我需要的..

我可以使用一个简单的脚本来完成这项工作，但模板语法真的让我很吃惊。

我只需要在每次迭代中简单地添加 10，并且只需选择一个包含 10 的倍数的列表。但是，我什至无法使用以下简单示例：

```
<select id="multiples">
{% for num in range(5,100) %}
<option value="{{ num }}">{{ num }}</option>
{% endfor %} 
```

有没有人可以帮忙，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:10:16.133

模板不适用于任意代码。Django 的内置`for`循环不支持这种事情。

[这](https://stackoverflow.com/questions/1107737/numeric-for-loop-in-django-templates)是先前的讨论，其中包含一些关于如何获得所需行为的好选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:05:28.177

使用 Python 的范围第三个参数（偏移量或增量）。您可以将其设置为跳过某些元素：

```
 >>> range(0, 10, 3)
 [0, 3, 6, 9] 
```

编辑 - - -

如您所知，Django 模板不理解范围。因此，可以选择从后端传递范围或列表本身。通过范围将类似于：

```
render_to_response('template.html', {..., 'range': range(0, 10, 3), ...}, ...) 
```

# python - 尝试使用 ftplib 上传图像但只是得到一个空白文件有什么想法吗？

> ID：13593963
> 
> 赞同：0
> 
> 时间：2012-11-27T22:03:41.920
> 
> 标签：python, image, upload, ftp, ftplib

所以这是我的代码

```
import ftplib

s = ftplib.FTP("Host", "Username", "Password")
s.cwd("public_html/test")
image = open("test.jpg", "rb")
s.storbinary('STOR test.jpg', image) 
image.close()
s.quit() 
```

当我检查它时，我只是得到一个损坏的图像......我已经到了我将base64图像并上传的地步......

如果有人可以提供帮助，请让我知道我做错了什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T15:31:04.213

我不完全确定出了什么问题，但这最终对我有用

```
import ftplib
import traceback

n="name of upload"
ftp = ftplib.FTP()
ftp.connect("website.com", "21")
print ftp.getwelcome()
try:
    try:
    ftp.login("user", "password")
    ftp.cwd("public_html/test")
    f = open("test.JPG", "rb")
    name= str(n)+".jpg"
    ftp.storbinary('STOR ' + name, f)
    f.close()
finally:
    ftp.quit()
except:
    traceback.print_exc() 
```

希望这可以帮助其他处于同样困境的人

# c++ - 我该如何处理“未解决的外部符号”错误？

> ID：13593964
> 
> 赞同：0
> 
> 时间：2012-11-27T22:03:50.840
> 
> 标签：c++

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我正在尝试制作指向子类的指针列表，并尝试使用其他类查找/删除对象

```
//class product
public:
    static vector<Product*> plist;
    static vector<Product*>::iterator tT;

//class book:public Product 
book::book(string a,double b, string c,string d,string e):Product(a,b,c),
    author(d),publisher(e)
{
    Product *k=this;
    plist.push_back(k);
}

class ProductCatalog:public Product // i really dont know how to implement this friend maybe
{
public:
    ProductCatalog();
    void findproduct(string);
    void deleteproduct();
    void addproduct();
    void listcatalog();

};

void ProductCatalog::findproduct(string temp){

    cin>>temp;
    tT=plist.begin();
    for (tT=plist.begin();tT!=plist.end();tT++){
        if((*tT)->getID()==temp)
            (*tT)->getSummery();
    }
}

void ProductCatalog::deleteproduct(){
    cout<<"enter id to delete"<<endl;
    string dd;
    cin>>dd;
    tT=plist.begin();
    for (tT=plist.begin();tT!=plist.end();tT++){
        if((*tT)->getID()==dd)
            plist.erase(tT);
    }
} 
```

错误

> 1>book.obj：错误 LNK2001：无法解析的外部符号“ `public: static class std::vector<class Product *,class std::allocator<class Product *> > Product::plist`”
> 
> 1>cd.obj：错误 LNK2001：无法解析的外部符号“ `public: static class std::vector<class Product *,class std::allocator<class Product *> > Product::plist`”
> 
> 1>ProductCatalog.obj：错误 LNK2001：未解析的外部符号“ `public: static class std::vector<class Product *,class std::allocator<class Product *> > Product::plist`”
> 
> 1>ProductCatalog.obj：错误LNK2019：函数“ ”`public: __thiscall Product::Product(void)`中引用了无法解析的外部符号“”(??0Product@@QAE@XZ)`public: __thiscall ProductCatalog::ProductCatalog(void)`
> 
> 1>ProductCatalog.obj：错误 LNK2001：未解析的外部符号“ `public: static class std::_Vector_iterator<class std::_Vector_val<struct std::_Simple_types<class Product *> > > Product::tT`”

# javascript - 尝试使用shake.js创建多个奶昔

> ID：13593965
> 
> 赞同：0
> 
> 时间：2012-11-27T22:03:52.137
> 
> 标签：javascript, android, iphone, dom-events

我在这里想要完成的是每次摇晃手机时都会发出警报。但我不断收到错误消息：

> 未捕获的类型错误：无法调用未定义的方法“addEventListener”

是因为它不知道“摇”是什么吗？不止一次摇晃的原因是因为我将根据摇晃的方式添加不同的动画。

```
 <!DOCTYPE html>
 <html>
 <head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="initial-scale=1.0, width=device-width, user-scalable=no" />
 <meta name="apple-mobile-web-app-capable" content="yes" />
 <title>Shake animation</title>
 <style type="text/css">
 body {
background: #E9E9E9; 
color: #333; 
font: 1em/1.3em "Helvetica Neue", Helvetica, Arial, Verdana, sans-serif; /* 16px /    21px */
text-shadow: rgba(255,255,255,0.8) 0 1px 0;
text-align: center;
    }
    </style>
    <script type="text/javascript" src="shake.js"></script>
    </head>
    <body>
       <div class="answerListener" id="answer1"></div>
       <div class="answerListener" id="answer2"></div>
       <div class="answerListener" id="answer3"></div>
       <div class="answerListener" id="answer4"></div>

    <script type="text/javascript">
    window.onload = function() {

   var answer = document.getElementsByClassName('answerListener');
   var current = 1;

   for (i = 0; answer.length; i++) {
   answer[i].addEventListener('shake', function() {

   if (current == 1) {
      alert('shake1');
   }
   if (current == 2) {
      alert('shake2');
   }
   if (current == 3) {
      alert('shake3');
   }
   if (current == 4) {
      alert('shake4');
   }
   current = current + 1;
   }, false);
}   
};

</script>
 </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T04:51:57.480

您的代码看起来不错，除了一个小问题：您的`for`循环不会终止：

```
for (i = 0; answer.length; i++) { 
```

应该

```
for (i = 0; i < answer.length; i++) { 
```

您收到错误是因为一旦`i`超过`answer.length`,`answer[i]`是未定义的，因此`answer[i].addEventListener`正在尝试调用不存在元素的方法。

祝你好运。

# ruby - Ruby 中的 URI.escape 和 URI.encode 有什么区别？

> ID：13593970
> 
> 赞同：14
> 
> 时间：2012-11-27T22:04:16.190
> 
> 标签：ruby

我试图找出Ruby 中的 a**`URI.escape`**和之间的区别。**`URI.encode`**

也没有做我希望他们做的事情，即完全编码 URL。

例如我想`http://my.web.com`成为`http%3A%2F%2Fmy%2Eweb%2Ecom`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T22:06:58.020

没有区别。在 Ruby 1.9.3[`encode`中只是`escape`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI/Escape.html#method-i-encode).

**[编辑]**请注意，这些方法允许对字符的“不安全”描述符进行编码：

```
URI.encode('http://my.web.com', /\W/) # => "http%3A%2F%2Fmy%2Eweb%2Ecom" 
```

谢谢@muistooshort！=)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:07:30.363

`CGI.escape`几乎可以满足您的要求：

```
1.9.3p0 :005 > require 'cgi'
 => true 
1.9.3p0 :006 > CGI.escape 'http://my.web.com'
 => "http%3A%2F%2Fmy.web.com" 
```

不过，通常没有必要逃避这些点。

# matlab - 如何访问矩阵的对角线并更改值？

> ID：13593971
> 
> 赞同：0
> 
> 时间：2012-11-27T22:04:16.090
> 
> 标签：matlab, matrix, octave

我有 8x8 矩阵，其中有 15 条对角线。左上角“对角线 1”和右下角“对角线 15”。我想将特定的对角线集归零，例如 {9, 10, 11, 12, 13, 14, 15} 或 {5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15} . 有人请给我解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:54:12.830

我相信你可以使用：

```
M = M - diag(diag(M,k),k); 
```

其中 k 对于主对角线为 0，对于下对角线为负（最多 -7），对于上对角线为正（最多 7 个）。

编辑：我的错，这只会将您选择的对角线之一归零。您可以对要归零的所有对角线重复该过程，但这可能不是最佳的：

```
for k=[9 10 11 12 13 14 15]
    M = M - diag(diag(M,k-length(M)),k-length(M));
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T15:15:27.920

另一种方法是直接使用索引。

对于 8x8 矩阵，如果要将主对角线处或下方的对角线之一中的条目归零，请使用以下命令：

```
M((n+1):9:(64-8*n))=0; 
```

这将沿着对角线运行，当它到达最低行时停止。对于对角线以上的条目，您必须在 64-n 处结束，而不是从 n+1 开始，如下所示：

```
M((8*n+1):9:(64-n))=0; 
```

在这两种情况下，n 是您离主对角线的距离 - 所以 n=0 是主对角线。这可以用一点逻辑概括：

```
idx=1:9:64;
M(idx((idx+8*n)<65&(idx+8*n)>0)+8*n)=0; 
```

对于 n>=0，这将选择主对角线上方的第 n 个对角线。负值将选择主对角线下方的对角线。进一步推广，对于 NxN 矩阵，

```
idx=1:(N+1):N^2;
M(idx((idx+N*n)<=N^2&(idx+N*n)>0)+N*n)=0; 
```

通过广播或适当使用 repmat（或乘以一个向量），这可以适应一次处理多个对角线，尽管它变得更加混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:51:01.393

我不确定我是否正确理解了您的问题。您是想将主对角线上的某些元素子集归零，还是试图将整个对角线归零？无论哪种方式，您都可以考虑使用 Matlab 的“诊断”功能。

如果你只想将主对角线上的一些元素归零，你可以使用类似的东西：

```
% A is a 15 x 15 matrix, want to zero out {1,2,3,8}th elements on the diagonal
d = diag(A); % diagonal elements of A
d([4:7 9:15]) = 0; % zero out the elements you want to KEEP
A = A - diag(d); % diag d is a diagonal matrix with d on the main diagonal 
```

但是使用 for 循环会更容易：

```
for i=[1,2,3,8]
A(i,i) = 0;
end 
```

将 A 的第 n 个对角线归零实际上更容易：

假设你想将第三条对角线归零，你会这样做： A = A - diag(diag(A,3),3);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-22T22:45:34.750

假设您有一个方阵 M。如果您只想将整个对角线设置为零，您可以这样做：

```
M(sub2ind(size(M), [1:length(M)]',[1:length(M)]')) = 0; 
```

如果您想将某些对角线设置为零，例如 1:5、8:11，您可以简单地修改为：

```
M(sub2ind(size(M), [1:5, 8:11]',[1:5, 8:11]')) = 0; 
```

其他人建议使用 for 循环。除非绝对必要，否则永远不要在 Matlab 中使用 for 循环。原生 Matlab 函数要快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T00:36:13.993

如果我跟着你，这里有一个简单的方法：

```
a       = rand(8,8);
indx    = logical( diag(ones(1,8),0) ); 
a(indx) = 0; 
```

或者如果您愿意，可以在 1 行中，

```
a(logical(diag(ones(1,8),0))) = 0; 
```

请注意，当使用 diag(v,k) 设置 k=1 时，将 v 放置在主对角线上，k=1 将 v 放置在对角线上，主对角线上方一个位置，依此类推。

然后通过相应地改变 k 和 v 的大小来重复非主对角线。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T23:50:26.433

我认为我的对角线是相反的，但你应该明白这一点。

Python代码：

```
import numpy as np

matrix = np.ones((8,8))

print "matrix = \n", matrix

# Need to map "diagnals" to starting row & offset, this is for 8x8

start_map = {}

start_map[ 0] = (0, 7)
start_map[ 1] = (0, 6)
start_map[ 2] = (0, 5)
start_map[ 3] = (0, 4)
start_map[ 4] = (0, 3)
start_map[ 5] = (0, 2)
start_map[ 6] = (0, 1)
start_map[ 7] = (0, 0)
start_map[ 8] = (1, 0)
start_map[ 9] = (2, 0)
start_map[10] = (3, 0)
start_map[11] = (4, 0)
start_map[12] = (5, 0)
start_map[13] = (6, 0)
start_map[14] = (7, 0)

# Zero out selected "diagnal"

M, N = matrix.shape

for i in xrange(15):

    new_matrix = np.array(matrix)

    m, n = start_map[i]

    while m < M and n < N:

        new_matrix[m, n] = 0.0

        m += 1
        n += 1

    print "'diag' = %d\n" % i, new_matrix 
```

这是截断的输出：

```
matrix = 
[[ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]]
'diag' = 0
[[ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  0.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]]
'diag' = 3
[[ 1\.  1\.  1\.  1\.  0\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  0\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  0\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  0.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]]
'diag' = 7
[[ 0\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  0\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  0\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  0\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  0\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  0\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  0\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  0.]]
'diag' = 8
[[ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 0\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  0\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  0\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  0\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  0\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  0\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  0\.  1.]]
'diag' = 9
[[ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 0\.  1\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  0\.  1\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  0\.  1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  0\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  0\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1\.  0\.  1\.  1.]] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-18T06:28:22.680

另一种基于[Glen O's answer 的](https://stackoverflow.com/a/15450926/3372061)解决方案也适用于非方阵，如下所示：

```
%% // Example inputs
N_ROWS = 6;
N_COLS = 4;
A = randi(20,N_ROWS,N_COLS);
DIAG_TO_MODIFY = -1;
REPLACE_VEC = rand(size(diag(A,DIAG_TO_MODIFY))); %// Will error if diagonal # is invalid.

%% // Processing; can be made a function
if  -DIAG_TO_MODIFY > N_ROWS-1 || ... 
     DIAG_TO_MODIFY > N_COLS-1
    error('Invalid diagonal number.');
end

if DIAG_TO_MODIFY < 0
    firstInd = 1 - DIAG_TO_MODIFY;
elseif DIAG_TO_MODIFY > 0
    firstInd = 1 + DIAG_TO_MODIFY*N_ROWS;
else %// DIAG_TO_MODIFY == 0 
    firstInd = 1;
end
A(firstInd:N_ROWS+1:end) = REPLACE_VEC; 
```

# ios - 未为子视图控制器调用 viewWillAppear

> ID：13593972
> 
> 赞同：8
> 
> 时间：2012-11-27T22:04:28.240
> 
> 标签：ios, cocoa-touch, uiviewcontroller

我有一个奇怪的案例——一个视图控制器，它在其中创建自己的视图，`loadView`然后将其添加到现有视图中。

以下是创建和添加 VC 的代码：

```
self.doneButtonViewController = [[DoneButtonViewController alloc] init];
[self.view addSubview:self.doneButtonViewController.view]; 
```

此代码`viewDidLoad`在“父”VC 中执行。

奇怪的是，`viewWillAppear`添加的 VC 的方法从未被调用（也不是`viewDidAppear`），但`viewWillDisappear`添加的 VC 的方法*被*调用（在适当的时间），正如人们所期望的那样。

`viewWillAppear`关于为什么没有被调用的任何线索？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T22:21:59.783

如果您这样做，应用程序不知道子视图的视图控制器，您需要引入视图控制器包含以使根视图控制器知道。这样做将处理这样的任何事件。

因为`loadView`在 iOS 6 之前可以多次调用，所以我建议在 中创建视图控制器`init`，然后在`loadView`. 它应该是这样的：

```
- (id)init {
    ...
    self.doneButtonViewController = [[DoneButtonViewController alloc] init];
    [self addChildViewController:self.doneButtonViewController];
    [self.doneButtonViewController didMoveToParentViewController:self];
    ...
}

- (void)loadView {
    ...
    [self.view addSubview:self.doneButtonViewController.view];
    ...
} 
```

[请参阅http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)上的“实现容器视图控制器”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-08T08:20:46.443

对我来说，在父视图控制器中添加子视图控制器可以解决子视图控制器的“viewWillAppear”没有被调用的问题。

# twitter-bootstrap - Twitter Bootstrap Carousel 添加了一个空图像

> ID：13593975
> 
> 赞同：2
> 
> 时间：2012-11-27T22:04:37.050
> 
> 标签：twitter-bootstrap

我已经在我的页面中实现了一个 twitter 引导轮播，但遇到了问题。它将浏览我添加到其中的三个图像，但是在加载最后一个图像而不是循环回到第一个图像之后，它似乎在轮播中创建并清空项目，并暂停几秒钟，然后返回到第一个图片。使用“左”箭头时它可以正确滚动，但使用“右”箭头时会添加一个空图像。任何帮助，将不胜感激。我已经在我的 .js 文件中初始化了轮播。

```
<div id="myCarousel" class="carousel slide">        
  <div class="carousel-inner">            
  <!-- Carousel items -->            
  <div class="active item" style="background: none repeat scroll 0% 0% #000000">
    <img width="1700" height="500" alt="" src="/cmsimages/0/globe---Copy.png" style="margin: auto" />
  </div>

  <!--2nd carousel item-->            
  <div class="item" style="background: none repeat scroll 0% 0% #000000">
    <img width="1716" height="530" alt="" src="/cmsimages/0/devwordcloud.jpg" />
  </div>

  <div class="item" style="background: none repeat scroll 0% 0% #000000">
    <img width="1716" height="530" alt="" src="/cmsimages/0/Clouds.png" />   
  </div>            
  <!-- Carousel nav -->
  <a data-slide="prev" href="#myCarousel" class="left carousel-control">‹&lt;/a>
  <a data-slide="next" href="#myCarousel" class="right carousel-control">›&lt;/a>
  <!-- End Carousel --> 
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:32:21.613

在编辑您发布的代码并更清楚地看到它之后，我能够看到您在 carousel-inner 块中包含了 carousel nav，它应该在它之外。

```
<div id="myCarousel" class="carousel slide">        
  <div class="carousel-inner">            
    <!-- Carousel items -->            
    <div class="active item" style="background: none repeat scroll 0% 0% #000000">
      <img width="1700" height="500" alt="" src="/cmsimages/0/globe---Copy.png" style="margin: auto" />
   </div>

    <!--2nd carousel item-->            
    <div class="item" style="background: none repeat scroll 0% 0% #000000">
      <img width="1716" height="530" alt="" src="/cmsimages/0/devwordcloud.jpg" />
    </div>

    <div class="item" style="background: none repeat scroll 0% 0% #000000">
      <img width="1716" height="530" alt="" src="/cmsimages/0/Clouds.png" />   
    </div>
  </div> <!-- / carousel-inner -->

  <!-- Carousel nav -->
  <a data-slide="prev" href="#myCarousel" class="left carousel-control">‹&lt;/a>
  <a data-slide="next" href="#myCarousel" class="right carousel-control">›&lt;/a>
  <!-- End Carousel --> 
</div> 
```

# php - 批量PHP图片上传慢，架构变化？

> ID：13593976
> 
> 赞同：2
> 
> 时间：2012-11-27T22:04:36.607
> 
> 标签：php, jquery, image-processing

我已经建立了一个带有相册的 CMS。很简单，大部分都是静态的、静态的 HTML 页面，没有数据库，只是（尽可能少）包含一些 JSON 内容的文本文件。管理面板的 Web 界面全部使用 jQuery，并带有基于 PHP（Zend 框架）的后端。尽可能多地在浏览器中完成，因此后端非常裸露。现在相册目前的工作方式是这样的：

*   点击链接“媒体”
*   从后端获取一个 JSON 字符串，该字符串包含一个包含所有相册的对象以及每个相册的所有照片
*   渲染包含所有专辑的无序列表
*   在每个相册列表项中使用所有图片呈现无序列表

上传：

*   将一个或多个 jpeg/png 文件拖放到浏览器中以创建新相册
*   将一个或多个 jpeg/png 文件拖放到相册中，以将这些文件附加到光标下的相册中
*   将所有拖放的文件（使用[这个](https://github.com/blueimp/jQuery-File-Upload)jQuery 拖放上传插件）发送到后端
*   后端接收所有文件（同时显示一个漂亮的进度条）
*   后端循环所有上传的文件，而网络界面显示一个漂亮的微调器
*   每个文件都调整为指定的最大尺寸，并以最大 133x133 像素呈现缩略图
*   每个文件都附加到具有服务器端文件名和缩略图名称的数组
*   [尚未实现：为专辑概览和每张图片呈现（更新的）静态 html 页面]
*   包含所有新上传文件的数组被转换为 JSON 并发送到客户端
*   Web 界面将所有新文件附加为列表项（显示缩略图）
*   上传完成

这一切进展顺利，最多 +- 600 张图像或 +- 900MB。这对我来说很好，如果用户想一次上传更多文件，那么分两个阶段进行。问题是，后端处理是个婊子。将 100 多张大小合适的图像（每张 1.5MB）转换为最大尺寸并生成缩略图需要很长时间。我正在用 PHP GD 做这个。没有花费我太多时间（或根本没有时间）来发现问题所在。我的猜测是我无法在 PHP 中加快速度。

所以这里有几个问题：

1.  ImageMagick 会更快吗？我不是粉丝，所以请不要，我也不想把它安装在我的服务器上那么糟糕..
2.  是否有一个非常非常轻量级的命令行程序，只需要几个命令（我知道我不是在暗示 ImageMagick）？
3.  如果上一个问题的答案是否定的：最好的方法是什么？不要说Java，我也不是Java的忠实粉丝。一些C（-方言）？最好具有用于最近邻、双线性和双三次插值算法的强大而轻量级的图像库。
4.  我的架构可以改变吗？此时，一旦插入缩略图，图像就开始出现在浏览器中，因此在接收到整个 JSON 数组之后，导致整个动作必须完成并生成所有图像数据，然后才能在浏览器中接收到任何类型的反馈。这意味着微调器（没有任何指示该过程将花费多长时间或已完成多少图像）将显示很长时间。使用 Javascripts FileReader 从用户系统预加载图像，在浏览器中生成缩略图并在上传完成后立即显示它们是一个想法吗？而在后端：只是接收文件，将它们写入磁盘，执行命令行命令，立即向浏览器发送响应并在后台转换？
5.  如何防止 AJAX 请求的客户端中止事件？上传和转换时，当用户想要关闭页面或尝试更改#hash 时，应显示警告。

谢谢。希望你们能帮助我。正如你所知道的：客户端非常复杂，有很多代码。我宁愿改变后端。

# viewstate - SignalR 集线器连接在几次回发后损坏视图状态

> ID：13593977
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:04:38.853
> 
> 标签：viewstate, signalr

我使用 signalR 编写了一个聊天应用程序。它是一个包含标记和运行聊天的 javascript 的 ASCX 控件。包含用户控件的页面有一个更新面板，它呈现异步并允许用户刷新某些特定于输入代码的内容。问题是，我可以多次单击刷新按钮，页面的行为没有任何问题。当我单击以连接聊天（全部在 JavaScript 中构建）并单击几次刷新按钮时，它似乎表现良好，但突然页面刹车并记录了一些视图状态错误，说：状态信息对此无效页面，可能已损坏。无效的视图状态..等等等等......这是一个丑陋的错误。

这只发生在我连接到集线器时。如果我不启动连接，这永远不会发生。

不过要提一提的是，控件背后的代码将一些值存储在引用视图状态的属性中（不将其存储在视图状态中，页面在每次回发时都会停止），稍后将其写入标记中，因此启动聊天知道谁应该成为对话的一部分。

请帮忙。

这里有一些代码：

StandAlonePanel.aspx -> 包含带有刷新按钮的更新面板。ChatControl.ascx ->

```
public int userId{
        get
        {
            if (ViewState["UserID"] == null)
                ViewState["UserID"] = 0;
            return Convert.ToInt32(ViewState["UserID"]);
        }
        set
        {
            ViewState["UserID"] = value;
        }
    }
//--- Same for userName

if (userId == 0 && CurrentUserSession.User != null)
{
   this.userId = CurrentUserSession.User.Id;
   this.userName = CurrentUserSession.User.Name;
} 
```

在标记中

```
var userInfo = {
    userId : "<%= userId %>",
    userName : "<%= userName %>",        
    IsAnonymized: "<%= IsAnonymized %>",
    enableLogging: "<%= enableLogging %>"
}

if (chat != null) {
      chat.Disconnect();   
   }

chat = new Chat(userInfo);
   chat.Connect(); 
```

//-- 脚本连接

```
var hubConn = $.hubConnection(url);

hubConn.logging = self.enableLogging
hubConn.qs = { 'u': userInfo.userId, 'tc': '0', 'oo': userInfo.showOnlineOnly, 'ach': self.IsAnonymized, 'lgch': self.enableLogging }; /* Initiating queryString */

hubConn.error(function (error) {
    logMe(error);
});

var hubProxy = new ChatProxy(hubConn);

/* hook up callbacks to hubProxy */

self.Connect = function () {
    if (self.longpolling == true) {
        hubConn.start({ transport: 'longPolling' }).done(function (result) {
            ///--            
        }).fail(function (error) {
            ///--
            alert("error" + error);
        });
    }
    else {
        hubConn.start().done(function (result) {
            ///--            
        }).fail(function (error) {
            ///--
            alert("error" + error);
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-28T18:40:52.503

我想我要结束这个问题了，因为它只发生在我的 asp 开发环境中。当我将应用程序部署到 iis 时，它不会出现同样的问题

# r - 找出 R 表中的列是否包含重复值？

> ID：13593982
> 
> 赞同：11
> 
> 时间：2012-11-27T22:05:03.860
> 
> 标签：r, duplicates

我有一个可爱的数据框，我的第一个，我开始掌握 R 的窍门。我无法找到的一件事是对重复值的测试。我有一列我很确定是所有唯一值，但我不知道。

有什么办法可以问吗？为简单起见，让我们假设这是我的数据：

```
 var1 var2 var3
1    1    A    1
2    2    B    3
3    3    C   NA
4    4    D   NA
5    5    E    4 
```

我想知道是否`var1`曾经重复。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T22:07:44.350

查看`duplicated`功能：

```
duplicated(dat$var1) # the rows of dat var1 duplicated 
```

文档在[这里](http://stat.ethz.ch/R-manual/R-devel/library/base/html/duplicated.html)。

您还应该查看该`unique`功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-10T12:56:40.440

根据列删除重复项：

```
my_data[!duplicated(my_data$Col_id), ]  # Where ! is a logical negation: 
```

# jquery - 在选择选项中的数组中回显 json 数据

> ID：13593985
> 
> 赞同：0
> 
> 时间：2012-11-27T22:05:11.257
> 
> 标签：jquery, json, codeigniter, codeigniter-2

我正在尝试使用 Json 在我的代码点火器视图上显示数据。它返回

[{"id":"5","cityname":"Manegerial Estate"},{"id":"6","cityname":"Kilimani"},{"id":"12","cityname" ：“工匠”}]

部分代码。如何在选项选择中回显返回的值。它与上面的选择中的返回值相呼应

```
 var post_url = "control_form/get_cities_by_state/"+ state_id;
        $.ajax({
            url: post_url,
            type: "POST",

            // dataType: 'json',
             success: function(cities) //we're calling the response json array 'cities'
              {
                alert(cities);
                $('#f_city').empty();
                $('#f_city, #f_city_label').show();
                   $.each(cities,function(id,city) 
                   {
                    var items=cities['id'];
                    alert(items);
                    var opt = $('<option />'); // here we're creating a new select option for each group
                      opt.val(id);
                      opt.text(city);
                      $('#f_city').append(opt); 
                   });
           }); //end AJAX
       } else {
        $('#f_city').empty();
        $('#f_city, #f_city_label').hide();
    }//end if
}); //end change
});
    </script>
 </head>
<body>
    <p>
<?php echo form_open('control_form/add_all'); ?>
        <label for="f_state">State<span class="red">*</span></label>

        <select id="f_state" name="f_state" required>
            <option value="" selected=selected>--Select state--</option>
            <?php
            foreach($statename as $state):
                echo '<option value="' . $state->id . '">' . $state->statename . '</option>';
            endforeach;
            ?>

        </select>
        <label for="f_city"  id="f_city_label">City<span class="red" >*</span></label>
        <!--this will be filled based on the tree selection above-->
        <select id="f_city" name="f_city" id="f_city_label"> 
            <option value=""></option>
        </select>
        <label for="f_membername">Member Name<span class="red">*</span></label>
      <input type="text" name="f_membername"/>
<?php echo form_close(); ?>

    </p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:11:27.920

您需要指定 json 数据类型...

```
$.ajax({
        url: post_url,
        type: "POST",
        dataType: "json", 
```

然后在您的成功功能中：

```
$.each(cities,function(i, city) {

    var opt = $('<option />'); // here we're creating a new select option for each group
    opt.val(city.id);
    opt.text(city.cityname);
    $('#f_city').append(opt); 

}); 
```

# msbuild - NuGet 不会复制版本高于指定版本的依赖项

> ID：13593987
> 
> 赞同：0
> 
> 时间：2012-11-27T22:05:14.620
> 
> 标签：msbuild, visual-studio-2012, nuget

我有一个 Web 项目（**W**），它引用了一个类库项目（**C**）：

```
W --> C 
```

**C**引用**N1**：

```
C --> N1 
```

**N1**是一个自定义 NuGet 包，它有两个依赖项（两者也是自定义 NuGet 包）：**N2** e **N3**，分别针对版本 2.1 或更高版本和 3.4 或更高版本。

```
N1 ---> N2 (>= 2.1)
   `--> N3 (>= 3.4) 
```

当我将**N1**包添加到**C**时，**N2**有一个可用的 2.2 版本，因此 NuGet 得到了那个版本，而不是预期的 2.1。

问题从这里开始：当我构建**W**时，**N2**没有复制到**W**的`bin`文件夹中。我用谷歌搜索了一下，发现 Visual Studio 不会将不是“第一类依赖项”的依赖项（即**C**不直接使用的依赖项）复制到**W**的输出文件夹。我可以确认，因为当我将下面的方法添加到**C**中的任何类时，**N2**会被复制。

```
private void ForceCopyOfN2()
{
    var someObject = new N2.SomeClass();
} 
```

此外，如果没有上述 hack，如果我将**N2**的版本降级到**N1**包依赖项指定*的相同*版本（即从 2.2 到 2.1），**N2**也会被复制。

 ****所以我猜这是 NuGet 的一个问题。有没有人经历过这样的事情？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-01T01:39:47.573

I was not able to repro this with VS 2012 targeting 4.5, here is what I tried
1\. Create new web application project
2\. Create new class library
3\. Add reference from web application to the class library
4\. in class library PM> install-package windowsAzure.servicebus

Attempting to resolve dependency 'Microsoft.WindowsAzure.ConfigurationManager (≥ 1.7.0.0)'. You are downloading Microsoft.WindowsAzure.ConfigurationManager from Microsoft, the license agreement to which is available at [http://go.microsoft.com/fwlink/?LinkID=235167](http://go.microsoft.com/fwlink/?LinkID=235167). Check the package for additional dependencies, which may come with their own license agreement(s). Your use of the package and dependencies constitutes your acceptance of their license agreements. If you do not accept the license agreement(s), then delete the relevant components from your device.

Successfully installed 'Microsoft.WindowsAzure.ConfigurationManager 1.7.0.3'. You are downloading WindowsAzure.ServiceBus from Microsoft, the license agreement to which is available at [http://go.microsoft.com/fwlink/?LinkId=218949](http://go.microsoft.com/fwlink/?LinkId=218949). Check the package for additional dependencies, which may come with their own license agreement(s). Your use of the package and dependencies constitutes your acceptance of their license agreements. If you do not accept the license agreement(s), then delete the relevant components from your device. Successfully installed 'WindowsAzure.ServiceBus 1.8.0.0'.

Successfully added 'Microsoft.WindowsAzure.ConfigurationManager 1.7.0.3' to ClassLibrary1.
Successfully added 'WindowsAzure.ServiceBus 1.8.0.0' to ClassLibrary1.
5\. where service bus is dependent on configuration with >=1.7 and 1.8 version of configurationmanage is installed
6\. build the classlibrary and then webapplication solution, refresh the solution explorer. For my solution I saw classlibrary, servicebus and configurationmanager are dropped in the bin folder. (not sure why but i saw the files dropped after I tried building classlibrary once again after adding the reference)

Is there something I am missing here?****

# php - 在 PDO::bindValue() 中使用显式数据类型有什么意义？

> ID：13593989
> 
> 赞同：6
> 
> 时间：2012-11-27T22:05:28.990
> 
> 标签：php, mysql, pdo, placeholder, bindvalue

在中使用显式数据类型有什么意义`PDO::bindValue()`？

例如，在以下任何一种形式中，都会有一个`SQLSTATE[HY000]: General error: 1366 Incorrect integer value: 'a'`

```
$pdos->bindValue(':Value_For_An_Int_Col', 'a');//default arg for the third and opt par is  PDO::PARAM_INT

$pdos->bindValue(':Value_For_An_Int_Col', 'a', PDO::PARAM_INT); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:12:30.153

当你需要类似的东西时

```
SELECT * FROM ... LIMIT :intValues 
```

这样可以避免将值括在引号内，从而引发 SQL 语法错误

# java - 在 Hibernate 中设置属性的默认值不起作用

> ID：13593990
> 
> 赞同：18
> 
> 时间：2012-11-27T22:05:30.033
> 
> 标签：java, hibernate, jpa, hibernate-mapping, hibernate-annotations

我的实体中有一个布尔属性。这是我的注释：

```
@Column(name = "IS_ACTIVE", nullable = false, columnDefinition="BIT DEFAULT 1", length = 1)
public Boolean getActive() {
    return isActive;
} 
```

但`columnDefinition="BIT DEFAULT 1"`不能完美运行。这是我作为生成表的结果得到的 SQL 代码：

```
IS_ACTIVE BIT(1) NOT NULL, 
```

我究竟做错了什么？

因此，当我尝试将此类的实例保存到数据库时，我得到了异常：

```
`com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Column 'IS_ACTIVE' cannot be null` 
```

如果我删除`nullable = false`财产：

```
@Column(name = "IS_ACTIVE", columnDefinition="BIT DEFAULT 1", length = 1)
public Boolean getActive() {
    return isActive;
} 
```

所以在这种情况下我可以保存一个创建的对象。但它仍然**没有设置默认值**，我在数据库中这个字段的值中得到 NULL。

请问有什么想法吗？如果它很重要，我会使用 MySQL Server 5.1。如果有任何帮助，我将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-27T22:13:39.933

Try using `BOOLEAN` data type, define your `@Column` annotation like that:

```
@Column(name = "IS_ACTIVE", columnDefinition = "boolean default true", nullable = false)
private Boolean active = true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-30T10:12:36.033

参考此链接中的正确答案[How to set default value in Hibernate](https://stackoverflow.com/questions/3110266/how-to-set-default-value-in-hibernate)

如果您想要一个真正的数据库默认值，请使用 columnDefinition - @Column(name = “myColumn”, nullable = false, columnDefinition = “int default 100”)。请注意，columnDefinition 中的字符串取决于数据库。此外，如果您选择此选项,**你必须使用动态插入, 所以 Hibernate 不会在插入时包含具有空值的列。否则谈论默认是无关紧要的。**

解决方案的关键是动态插入注释。您可以将其添加到您的实体类中，如下例所示：`@org.hibernate.annotations.Entity(dynamicInsert = true)`

# javascript - 创建一个脉冲发光效果 HTML5 canvas kineticJS

> ID：13593991
> 
> 赞同：1
> 
> 时间：2012-11-27T22:05:32.890
> 
> 标签：javascript, html, canvas, kineticjs

我想在我的画布中有可放置的区域，人们可以在其中拖动图像，并且我想在可放置区域周围添加发光的脉冲效果，这样人们就可以很容易地找出可以拖动对象的位置。

我发现[HTML5 canvas 之类的东西可以创建形状的外发光效果，](https://stackoverflow.com/questions/5067368/html5-canvas-create-outer-glow-effect-of-shape)但它不像脉冲那样具有动画效果。

比如这个矩形：

```
 var stage = new Kinetic.Stage({
        container: 'container',
        width: 578,
        height: 200
      });

      var layer = new Kinetic.Layer();

      var rect = new Kinetic.Rect({
        x: 239,
        y: 75,
        width: 100,
        height: 50,
        fill: 'white',
        stroke: 'black',
        strokeWidth: 4
      });

      // add the shape to the layer
      layer.add(rect);

      // add the layer to the stage
      stage.add(layer); 
```

但不是那种黑色，我想要一个脉动的金色笔触。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:12:12.803

寻找这样的东西？[http://lamberta.github.com/html5-animation/examples/ch03/05-pulse.html](http://lamberta.github.com/html5-animation/examples/ch03/05-pulse.html)

本质上它是使用 sine 函数完成的（下面的代码取自 lamberta 项目）并且非常不言自明：

```
 var canvas = document.getElementById('canvas'),
      context = canvas.getContext('2d'),
      ball = new Ball(),
      angle = 0,
      centerScale = 1,
      range = 0.5,
      speed = 0.05;

  ball.x = canvas.width / 2;
  ball.y = canvas.height / 2;

  (function drawFrame () {
    window.requestAnimationFrame(drawFrame, canvas);
    context.clearRect(0, 0, canvas.width, canvas.height);

    ball.scaleX = ball.scaleY = centerScale + Math.sin(angle) * range;
    angle += speed;
    ball.draw(context);
  }()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T08:32:57.627

我不确定你的问题是什么，但很容易用 kineticjs 创建一个带有圆圈的脉冲。像这样的东西：

```
var pulserect= rect.clone();
pulserect.setFill('gold');
pulserect.setScale(2,2);
layer.draw();

pulse.transitionTo({
scale:{x:0.5,
       y:0.5},
opacity:0.5,
duration: 0.5
}); 
```

[jsfiddle](http://jsfiddle.net/cKqgz/11/)

# java - 布局之间的意图

> ID：13593992
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:05:38.910
> 
> 标签：java, android, android-layout, android-intent

我刚开始在android中开发，我正在尝试创建新布局并使用意图方法在旧布局和新布局之间连接，但我总是遇到错误，如果有人可以帮助我，我将不胜感激......

代码是：

```
package newapplication.com;

import org.w3c.dom.Text;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.graphics.Typeface;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

public class MainActivity extends Activity {
private Button b6;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    b6 = (Button) findViewById(R.id.button6);
        b6.setOnClickListener(next);

    //Call to the next activity
     OnClickListener next = new OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent myIntent = new Intent(MainActivity.this,       MainActivity2.class);
            startActivity(myIntent);
        }
    };
} 
```

它总是写信告诉我下一个无法解析为变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:12:51.650

一个更高效的处理*单击* `View`/`Button`单击，是如下图所示：

```
Button b6 = (Button)findViewById(R.id.button6);
b6.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        Intent myIntent = new Intent(MainActivity.this, MainActivity2.class);
        startActivity(myIntent);
    }
}); 
```

请注意，您本质上是在做同样的事情，但是您受到解释代码的顺序方式的限制。

我所做的只是将您的`OnClickListener`实例化并将其放入您的`setOnClickListener()`方法中。布局中的任何其他按钮都无法访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:12:06.000

你的代码几乎是正确的。您必须在将其设置为侦听器*之前*定义下一个，它将起作用。

# python - 为什么 Homebrew 不在 OS X 10.8 上创建 python 绑定文件？

> ID：13593995
> 
> 赞同：5
> 
> 时间：2012-11-27T22:05:44.753
> 
> 标签：python, opencv, homebrew

我正在尝试在带有 Mountain Lion 的 Mac 上使用 OpenCV 和 PySide。Homebrew 公式工作正常，但没有显示 python 绑定文件。

```
romaindeterre$ brew install opencv
==> Downloading http://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.3/Op
Already downloaded: /Library/Caches/Homebrew/opencv-2.4.3.tar.bz2
==> cmake -DCMAKE_INSTALL_PREFIX=/usr/local/Cellar/opencv/2.4.3 -DCMAKE_BUILD_TYPE=None 
==> make
==> make install
==> Caveats
The OpenCV Python module will not work until you edit your PYTHONPATH like so:
   export PYTHONPATH="/usr/local/lib/python2.7/site-packages:$PYTHONPATH"

To make this permanent, put it in your shell's profile (e.g. ~/.profile).
==> Summary
/usr/local/Cellar/opencv/2.4.3: 214 files, 51M, built in 108 seconds 
```

不包含`/usr/local/lib/python2.7/site-packages`任何名为.`cv.*`

我做到`brew update`了，输出`brew doctor`如下：

> 警告：“config”脚本存在于您的系统或 Homebrew 目录之外。`./configure`脚本经常查找 *-config 脚本以确定是否安装了软件包，以及在编译和链接时要使用哪些附加标志。
> 
> 如果配置脚本覆盖系统或 Homebrew 提供的同名脚本，则在路径中包含其他脚本可能会混淆通过 Homebrew 安装的软件。我们发现了以下“配置”脚本：
> 
> ```
> /Library/Frameworks/Python.framework/Versions/2.7/bin/python-config
> /Library/Frameworks/Python.framework/Versions/2.7/bin/python2-config
> /Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7-config 
> ```

正确安装 OpenCV 有什么遗漏吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T02:12:18.580

我真的建议使用 pip 和 virtualenv 进行 python 开发。在 Mac 上，这个搭便车指南是关于如何设置它的好读物。使用 virtualenv 将创建一个隔离的 python 路径，并使用 pip 在虚拟 env 中安装东西将在这里真正有帮助。

[https://python-guide.readthedocs.org/en/latest/starting/install/osx/](https://python-guide.readthedocs.org/en/latest/starting/install/osx/)

# knockout.js - 处理嵌套可观察对象中的空对象

> ID：13593997
> 
> 赞同：0
> 
> 时间：2012-11-27T22:05:50.263
> 
> 标签：knockout.js

我有一个包含多个可观察对象（预算、公司、成本中心）的视图模型。Budgets 有一个 CostcenterID 和一个计算出的 observable，它根据 costcenterid 从 costcenterlist 中返回该预算的成本中心。costCenter 有一个 companyID 和一个计算出的 observable，它根据 companyId 从公司列表中返回该成本中心的公司。

在我看来，我对预算有约束力，我有

```
<td>
    <select data-bind="options:$root.Costcenter,optionsCaption:'cost center', optionsText:'Title', optionsValue:'Id', value:CostCenterId "></select>                         
</td>
<td>
    <span data-bind="text:CostCenter().Company().Title"></span>
</td> 
```

如果预算有成本中心，它可以正常工作，但是当给定预算的成本中心不存在时，我会收到一个绑定错误

> 0x800a139e - Microsoft JScript 运行时错误：无法解析绑定。
> 
> 消息：TypeError：对象不支持此属性或方法；
> 
> 绑定值：文本：CostCenter().Company().Title

（如果根据 costcenterID 没有找到成本中心，我为 costCenter 计算的 observable 返回一个空的 Object {}）。

处理这个问题的最好方法是什么，而不用一堆 if 语句来检查对象是否为空？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T02:38:16.470

一个简单的解决方案是使用`with`绑定来包装您的`Title`跨度，并`CostCenter`在它为空时返回 null。

```
<td data-bind="with: CostCenter">
    <span data-bind="text: Company().Title"></span>
</td> 
```

当`CostCenter`为 null 时，它不会呈现内部内容，也不会尝试绑定不存在的属性/可观察对象。

或者，您可以创建一个计算的 observable 来表示`Title`具体的，例如：`<span data-bind="text: CostCenterCompanyTitle"></span>`。因此，在这种情况下，计算将处理检查成本中心是否已定义。但是，如果您有许多要绑定的属性，这可能会使您的视图模型复杂化和混乱。使用`with`绑定是一个更简单的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:16:49.777

我建议您使用 div（或相同的 td）来包装与 costCenter 相关的任何功能，例如，这将检查该对象是否未定义：比如

```
costCenterAccessible = ko.computed(
function()
{
   return self.CostCenter() != undefined;
}, this
);

<td data-bind="visible: costCenterAccessible>
    <span data-bind="text:CostCenter().Company().Title"></span>
</td> 
```

但是，如果不是所有字段都可以访问，您需要三思而后行，使用该表完成此任务是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T13:08:26.980

`<td> <div data-bind="if: CostCenter()"> <span data-bind="text:CostCenter().Company().Title"></span> </div> </td>`

这会在尝试打印标题之前检查 CostCenter。